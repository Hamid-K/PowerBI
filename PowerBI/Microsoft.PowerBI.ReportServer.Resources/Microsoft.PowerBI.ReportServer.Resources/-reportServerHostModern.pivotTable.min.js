"use strict";(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["pivotTable"],{52073:function(Ve,Fe,X){function W(ce,r){var w=r.getHierarchyDepth(),n=r.getChildren(ce);if(!_.isEmpty(n))for(var o=0,H=n;o<H.length;o++)w=Math.min(w,r.getLevel(H[o]));return w-r.getLevel(ce)}function fe(ce,r){return r.isLeaf(ce)?ce:fe(_.head(r.getChildren(ce)),r)}function ue(ce,r){return void 0!==r.getLeafIndex(ce)?ce:ue(_.head(r.getChildren(ce)),r)}function le(ce,r){return r.isLeaf(ce)?ce:le(_.last(r.getChildren(ce)),r)}function ie(ce,r){return void 0!==r.getLeafIndex(ce)?ce:ie(_.last(r.getChildren(ce)),r)}function te(ce,r){return r.getLeafIndex(fe(ce,r))}function Z(ce,r){return r.getLeafIndex(ue(ce,r))}function de(ce,r){return r.getLeafIndex(le(ce,r))}function K(ce,r){return r.getLeafIndex(ie(ce,r))}X.d(Fe,{LF:function(){return te},O3:function(){return K},hG:function(){return Z},oj:function(){return le},pA:function(){return de},zG:function(){return W}})},15366:function(Ve,Fe,X){X.d(Fe,{AV:function(){return I},DJ:function(){return k},DX:function(){return ne},EO:function(){return ce},FA:function(){return re},MN:function(){return te},Ms:function(){return Z},Sv:function(){return H},_E:function(){return n},hw:function(){return K},sB:function(){return q},sW:function(){return o},yl:function(){return w}});var W=X(81337),fe=X(62458),ue=X(52073),le=X(7911),ie=X(44404),te=10,Z=50,K=20,ce=20,w=function(){function E(){}return E.getAncestorsToMeasure=function(m,S){for(var d=[];;){var g=S.getParent(m);if(!g||!S.isLastItem(m,S.getChildren(g)))break;d.push({node:g,size:-1}),m=g}return d},E.getSizeDifference=function(m,S,d,g){for(var y=0,L=0,M=m;L<M.length;L++)y=Math.max(y,this.getItemSizeDifference(M[L],S,d,g));return y},E.getItemSizeDifference=function(m,S,d,g){for(var L=0,M=(0,ue.LF)(m.node,d);M<=S;M++)if((L+=g(M))>=m.size)return 0;return m.size-L},E.getPageIndex=function(m,S){return Math.floor(m/S)},E.itemRangeToPageRange=function(m,S,d){var g=this.getPageIndex(m,d),y=this.getPageIndex(S,d);if(g===y)return[{pageIndex:g,startIndex:m%d,endIndex:S%d}];var L=[];L.push({pageIndex:g,startIndex:m%d,endIndex:d-1});for(var M=g+1;M<y;M++)L.push({pageIndex:M,startIndex:0,endIndex:d-1});return L.push({pageIndex:y,startIndex:0,endIndex:S%d}),L},E}(),n=function(){function E(){}return E.linesOverlapVertically=function(m,S,d,g){return!(d>m+S||d+g<m)},E.isRowMeasured=function(m,S){return this.getMeasuredRowCount(S)>m},E.getMeasuredRowCount=function(m){var S=m.getPageRows();return _.isEmpty(S)?0:(S.length-1)*K+_.last(S).getRowHeights().length},E.remeasureRows=function(m,S,d,g,y,L,M){for(var c=0,e=w.itemRangeToPageRange(g,y,K);c<e.length;c++){var t=e[c];M.measurePage(M.getPageRows()[t.pageIndex],m,S,d,g,L,ce,t.startIndex,t.endIndex-t.startIndex+1)}},E.getVisibleRowStart=function(m,S,d){var g=d.getRowHeight(m.firstLeafIndex);return{rowIndex:m.firstLeafIndex,visibleHeight:g-S+m.firstLeafTop}},E.getVisibleRange=function(m,S,d,g,y){var L=this.getVisiblePageRange(m,S,d);if(!L)return null;var M=this.getFirstVisibleIndex(L.firstPageRow,L.firstPageIndex,L.firstPageTop,m,S);if(null!=M){var c,Y=this.getLastVisibleIndex(L.lastPageRow,L.lastPageIndex,L.lastPageTop,m,S);if(null!=Y)return null!=g&&g>=0&&null!=y&&y>=0&&(c=Math.max(Y,M.leafIndex+g-1),c=Math.min(c,y)),{firstLeafIndex:M.leafIndex,firstLeafTop:M.top,lastLeafIndex:c??Y}}},E.getVisiblePageRange=function(m,S,d){for(var g=0,y=0,L=null,Y=0,c=d.getPageRows();Y<c.length;Y++){var e=c[Y],t=e.getHeight();if(this.linesOverlapVertically(g,t,m,S))L?(L.lastPageRow=e,L.lastPageIndex=y,L.lastPageTop=g):L={firstPageRow:e,firstPageIndex:y,firstPageTop:g,lastPageRow:e,lastPageIndex:y,lastPageTop:g};else if(L)break;g+=t,y++}return L},E.getFirstVisibleIndex=function(m,S,d,g,y){for(var L=0,M=d,c=0,e=m.getRowHeights();c<e.length;c++){var t=e[c];if(this.linesOverlapVertically(M,t,g,y))return{leafIndex:S*K+L,top:M};M+=t,L++}},E.getLastVisibleIndex=function(m,S,d,g,y){for(var Y,L=0,M=d,c=0,e=m.getRowHeights();c<e.length;c++){var t=e[c];this.linesOverlapVertically(M,t,g,y)&&(Y=S*K+L),M+=t,L++}return Y},E.getBounds=function(m,S){var d=w.getPageIndex(m,K);if(!(d>=S.getPageRows().length)){for(var g=S.getPageRows()[d],y=S.getPageRowTop(g),L=m%K,M=0;M<L;M++)y+=g.getRowHeights()[M];return{top:y,height:g.getRowHeights()[L]}}},E.getOffset=function(m,S){var d=this.getBounds(m.rowIndex,S);return d?m.alignBottom?m.visibleHeight>=d.height?d.top+d.height:d.top+m.visibleHeight:m.visibleHeight>=d.height?d.top:d.top+d.height-m.visibleHeight:0},E}(),o=function(){function E(){}return E.linesOverlapHorizontally=function(m,S,d,g){return!(d>m+S||d+g<m)},E.isColumnMeasured=function(m,S){return this.getMeasuredColumnCount(S)>m},E.getMeasuredColumnCount=function(m){var S=m.getPageColumns();return _.isEmpty(S)?0:(S.length-1)*te+_.last(S).getColumnWidths().length},E.remeasureColumn=function(m,S,d,g,y,L){var M=L.getPageColumn(m,S,d,g,y);L.measurePage(M,S,d,g,y,Z,m%te,1)},E.getVisibleColumnStart=function(m,S,d){var g=d.getColumnWidth(m.firstLeafIndex);return{columnIndex:m.firstLeafIndex,visibleWidth:g-S+m.firstLeafLeft}},E.getVisibleRange=function(m,S,d,g,y){var L=this.getVisiblePageRange(m,S,d);if(!L)return null;var M=this.getFirstVisibleIndex(L.firstPageColumn,L.firstPageIndex,L.firstPageLeft,m,S);if(null!=M){var c,Y=this.getLastVisibleIndex(L.lastPageColumn,L.lastPageIndex,L.lastPageLeft,m,S);if(null!=Y)return null!=g&&g>=0&&null!=y&&y>=0&&(c=Math.max(Y,M.leafIndex+g-1),c=Math.min(c,y)),{firstLeafIndex:M.leafIndex,firstLeafLeft:M.left,lastLeafIndex:c??Y}}},E.getVisiblePageRange=function(m,S,d){for(var g=0,y=0,L=null,M=0,Y=d.getPageColumns();M<Y.length;M++){var c=Y[M],e=c.getWidth();if(this.linesOverlapHorizontally(g,e,m,S))L?(L.lastPageColumn=c,L.lastPageIndex=y,L.lastPageLeft=g):L={firstPageColumn:c,firstPageIndex:y,firstPageLeft:g,lastPageColumn:c,lastPageIndex:y,lastPageLeft:g};else if(L)break;g+=e,y++}return L},E.getFirstVisibleIndex=function(m,S,d,g,y){for(var L=0,M=d,c=0,e=m.getColumnWidths();c<e.length;c++){var t=e[c];if(this.linesOverlapHorizontally(M,t,g,y))return{leafIndex:S*te+L,left:M};M+=t,L++}return null},E.getLastVisibleIndex=function(m,S,d,g,y){for(var Y,L=0,M=d,c=0,e=m.getColumnWidths();c<e.length;c++){var t=e[c];this.linesOverlapHorizontally(M,t,g,y)&&(Y=S*te+L),M+=t,L++}return Y},E.getBounds=function(m,S){var d=w.getPageIndex(m,te);if(!(d>=S.getPageColumns().length)){for(var g=S.getPageColumns()[d],y=S.getPageColumnLeft(g),L=m%te,M=g.getColumnWidths(),Y=0;Y<L;Y++)y+=M[Y];return{left:y,width:M[L]}}},E.getOffset=function(m,S){var d=this.getBounds(m.columnIndex,S);return d?m.alignRight?m.visibleWidth>=d.width?d.left+d.width:d.left+m.visibleWidth:m.visibleWidth>=d.width?d.left:d.left+d.width-m.visibleWidth:0},E}(),H=function(){function E(m,S){this.pageColumns=[],this.measureElement=m,this.sizeManager=S}return E.prototype.canAddPageColumn=function(m){return this.pageColumns.length<this.getMaxPageColumnCount(m)},E.prototype.getMaxPageColumnCount=function(m){return Math.ceil(m.getHierarchyLeafCount()/te)},E.prototype.getPageColumns=function(){return this.pageColumns},E.prototype.getPageColumnStartIndex=function(m){var S=this.pageColumns.indexOf(m);return-1===S?-1:S*te},E.prototype.getPageColumnLeft=function(m){for(var S=0,d=0,g=this.pageColumns;d<g.length;d++){var y=g[d];if(m===y)break;S+=y.getWidth()}return S},E.prototype.getColumnsWidth=function(){for(var m=0,S=0,d=this.pageColumns;S<d.length;S++)m+=d[S].getWidth();return m},E.prototype.clear=function(){this.pageColumns=[]},E.prototype.measureNextPage=function(m,S,d,g){var y=new le.VG;this.getPageColumns().push(y),this.measurePage(y,m,S,d,g,Z)},E.prototype.getWidestCellBindingString=function(m,S,d,g,y,L,M){for(var Y={item:null,width:-1},c=0;c<L;c++)this.updateWidestItemFromBodyCell(g.getHierarchyLeafAt(c+M),m,d,g,Y);if(S){var e=g.getFloatingHierarchyLeafCount();for(c=0;c<e;c++)this.updateWidestItemFromBodyCell(g.getFloatingHierarchyLeafAt(c),m,d,g,Y)}var l,t=d.getApproximateColumnHeaderWidth(m);return t>Y.width&&(Y.item=m,Y.width=t),l=Y.item===m?d.getColumnHeaderBinding(Y.item,!0):d.getBodyCellBinding(Y.item,!0),le.bG.build(l,E.measureRequiredStyle)},E.prototype.measurePage=function(m,S,d,g,y,L,M,Y){var c=this.getPageColumnStartIndex(m);void 0===M&&(M=0),void 0===Y&&(Y=Math.min(g.getHierarchyLeafCount()-c,te)+M);for(var e=Math.min(d.getHierarchyLeafCount()-y,L),t="",l=d.getFloatingHierarchyItems(),s=0;s<Y;s++){var f=g.getHierarchyLeafAt(s+M+c);void 0===(m.getColumnWidths()[s+M]=this.sizeManager.getColumnWidth(f))&&(t+=this.getWidestCellBindingString(f,l,S,d,g,e,y))}if(t){this.measureElement.insertAdjacentHTML("beforeend",t);var i=this.measureElement.firstChild;for(s=0;s<Y;s++)void 0===m.getColumnWidths()[s+M]&&(m.getColumnWidths()[s+M]=i.offsetWidth+1,i=i.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(m,S,g,c,M,Y)}},E.prototype.updateWidestItemFromBodyCell=function(m,S,d,g,y){var L=g.getIntersection(m,S),M=d.getApproximateBodyCellWidth(L);M>y.width&&(y.item=L,y.width=M)},E.prototype.adjustItemsWidth=function(m,S,d,g,y,L){for(var M=0;M<L;M++){var Y=d.getHierarchyLeafAt(M+y+g);void 0===this.sizeManager.getColumnWidth(Y)&&this.adjustItemWidth(m,M+y,g,S,d,Y)}},E.prototype.adjustItemWidth=function(m,S,d,g,y,L){var M=this,Y=w.getAncestorsToMeasure(L,y);_.isEmpty(Y)||(this.measureAncestors(Y,g),m.getColumnWidths()[S]+=w.getSizeDifference(Y,S+d,y,function(c){return M.getColumnWidth(c)}))},E.prototype.measureAncestors=function(m,S){for(var d="",g=0,y=m;g<y.length;g++){var M=S.getColumnHeaderBinding(y[g].node,!0);d+=le.bG.build(M,E.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",d);for(var Y=this.measureElement.firstChild,c=0,e=m;c<e.length;c++)e[c].size=Y.offsetWidth+1,Y=Y.nextSibling;this.measureElement.innerHTML=""},E.prototype.getColumnWidth=function(m,S,d,g,y){return this.getPageColumn(m,S,d,g,y).getColumnWidths()[m%te]},E.prototype.setColumnWidth=function(m,S){this.getPageColumn(m).getColumnWidths()[m%te]=S},E.prototype.getPageColumn=function(m,S,d,g,y){var L=this.getPageIndex(m);if(S&&L>=this.pageColumns.length)for(var M=L-this.pageColumns.length+1,Y=0;Y<M;Y++)this.measureNextPage(S,d,g,y);return this.pageColumns[L]},E.prototype.getPageIndex=function(m){return w.getPageIndex(m,te)},E.prototype.getLastMeasuredIndex=function(){var m=this.pageColumns.length;if(0===m)return-1;var S=_.last(this.pageColumns);return(m-1)*te+(S.getColumnWidths().length-1)},E.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},E}(),B=function(){function E(m,S,d,g){this.pageRows=[],this.measureElement=m,this.columnWidthMeasureManager=S,this.rowLevelWidthMeasureManager=d,this.sizeManager=g}return E.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},E.prototype.clearFloatingRows=function(){this.floatingPageRow=new le.BJ},E.prototype.ensureLastPageComplete=function(m,S,d,g,y,L){if(0===this.pageRows.length)return-1;var Y=this.pageRows.length-1,c=this.pageRows[Y],e=c.getRowHeights().length;return e<K&&this.gotMoreRows(c,S)&&(this.measurePage(c,m,S,d,g,y,L,c.getRowHeights().length-1),c.getRowHeights().length>e)?Y:-1},E.prototype.measureNextPage=function(m,S,d,g,y){var L=new le.BJ;this.getPageRows().push(L),this.measurePage(L,m,S,d,g,y,ce)},E.prototype.measureFloatingRows=function(m,S,d,g,y,L,M){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var Y=S.getFloatingHierarchyItems();if(!_.isEmpty(Y)){for(var c=Math.min(d.getHierarchyLeafCount()-y,ce),e="",t=S.getFloatingHierarchyLeafCount(),l=0;l<t;l++){var s=S.getFloatingHierarchyLeafAt(l);this.floatingPageRow.getRowHeights()[l]=this.sizeManager.getRowHeight(s),void 0===this.floatingPageRow.getRowHeights()[l]&&(e+=this.getHeighestCellBindingString(s,m,S,d,c,y,g,L,M))}if(e){this.measureElement.insertAdjacentHTML("beforeend",e);var f=this.measureElement.firstChild;for(l=0;l<t;l++)void 0===this.floatingPageRow.getRowHeights()[l]&&(this.floatingPageRow.getRowHeights()[l]=f.offsetHeight,f=f.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,m,S,0,0,t)}}}},E.prototype.getPageIndex=function(m){return w.getPageIndex(m,K)},E.prototype.getMeasureRequiredStyle=function(m){return{"box-sizing":"border-box",width:(0,ie.S)(m)}},E.prototype.gotMoreRows=function(m,S){return S.getHierarchyLeafCount()-this.getPageRowStartIndex(m)-m.getRowHeights().length>0},E.prototype.measurePage=function(m,S,d,g,y,L,M,Y,c){var e=this.getPageRowStartIndex(m);void 0===Y&&(Y=0),void 0===c&&(c=Math.min(d.getHierarchyLeafCount()-e,K)-Y);for(var t=Math.min(g.getHierarchyLeafCount()-L,M),l="",s=0;s<c;s++){var f=d.getHierarchyLeafAt(s+Y+e);void 0===(m.getRowHeights()[s+Y]=this.sizeManager.getRowHeight(f))&&(l+=this.getHeighestCellBindingString(f,S,d,g,t,L,y))}if(l){this.measureElement.insertAdjacentHTML("beforeend",l);var i=this.measureElement.firstChild;for(s=0;s<c;s++)void 0===m.getRowHeights()[s+Y]&&(m.getRowHeights()[s+Y]=i.offsetHeight,i=i.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(m,S,d,e,Y,c)}},E.prototype.getHeighestCellBindingString=function(m,S,d,g,y,L,M,Y,c){for(var e={item:null,width:-1,height:-1},t=0;t<y;t++){var l=g.getHierarchyLeafAt(t+L),s=d.getIntersection(m,l),f=this.columnWidthMeasureManager.getColumnWidth(t+L,S,d,g,M),u=S.getApproximateBodyCellHeight(s,f);u>e.height&&(e.item=s,e.width=f,e.height=u)}var P,i=this.getItemWidth(m,d),h=S.getApproximateRowHeaderHeight(m,i);return h>e.height&&(e.item=m,e.height=h,e.width=i),P=e.item===m?S.getRowHeaderBinding(e.item,!0):S.getBodyCellBinding(e.item,!0,void 0,void 0,void 0,Y,void 0,c),le.bG.build(P,this.getMeasureRequiredStyle(e.width))},E.prototype.getItemWidth=function(m,S){return fe.fF.assertFail("abstract method"),0},E.prototype.adjustItemsHeight=function(m,S,d,g,y,L){fe.fF.assertFail("abstract method")},E.prototype.getMaxPageRowCount=function(m){return Math.ceil(m.getHierarchyLeafCount()/K)},E.prototype.getPageRows=function(){return this.pageRows},E.prototype.getFloatingPageRow=function(){return this.floatingPageRow},E.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},E.prototype.canAddPageRow=function(m){return this.pageRows.length<this.getMaxPageRowCount(m)},E.prototype.getPageRowStartIndex=function(m){if(m===this.floatingPageRow)return 0;var S=this.pageRows.indexOf(m);return-1===S?-1:S*K},E.prototype.getPageRowTop=function(m){if(m===this.floatingPageRow)return 0;for(var S=0,d=0,g=this.pageRows;d<g.length;d++){var y=g[d];if(m===y)break;S+=y.getHeight()}return S},E.prototype.getRowsHeight=function(){for(var m=0,S=0,d=this.pageRows;S<d.length;S++)m+=d[S].getHeight();return m},E.prototype.getRowHeight=function(m,S,d,g,y,L){return this.getPageRow(m,S,d,g,L).getRowHeights()[m%K]},E.prototype.getFloatingRowHeight=function(m){return this.floatingPageRow.getRowHeights()[m]},E.prototype.getPageRow=function(m,S,d,g,y,L){var M=this.getPageIndex(m);if(S&&M>this.pageRows.length)for(var Y=M-this.pageRows.length+1,c=0;c<Y;c++)this.measureNextPage(S,d,g,y,L);return this.pageRows[M]},E.prototype.getLastMeasuredIndex=function(){var m=this.pageRows.length;if(0===m)return-1;var S=_.last(this.pageRows);return(m-1)*K+(S.getRowHeights().length-1)},E}(),k=function(E){function m(){return null!==E&&E.apply(this,arguments)||this}return(0,W.ZT)(m,E),m.prototype.getItemWidth=function(S,d){return this.rowLevelWidthMeasureManager.getWidth(d.getLevel(S),(0,ue.zG)(S,d))},m.prototype.adjustItemsHeight=function(S,d,g,y,L,M){for(var Y=0;Y<M;Y++){var c=g.getHierarchyLeafAt(Y+L+y);void 0===this.sizeManager.getRowHeight(c)&&this.adjustItemHeight(S,Y+L,y,d,g,c)}},m.prototype.adjustItemHeight=function(S,d,g,y,L,M){var Y=this,c=w.getAncestorsToMeasure(M,L);_.isEmpty(c)||(this.measureAncestors(c,y,L),S.getRowHeights()[d]+=w.getSizeDifference(c,g+d,L,function(e){return S===Y.getFloatingPageRow()?Y.getFloatingRowHeight(e):Y.getRowHeight(e)}))},m.prototype.measureAncestors=function(S,d,g){for(var y="",L=0,M=S;L<M.length;L++){var c=d.getRowHeaderBinding((Y=M[L]).node,!0);y+=le.bG.build(c,this.getMeasureRequiredStyle(this.getItemWidth(Y.node,g)))}this.measureElement.insertAdjacentHTML("beforeend",y);for(var e=this.measureElement.firstChild,t=0,l=S;t<l.length;t++){var Y;(Y=l[t]).size=e.offsetHeight,e=e.nextSibling}this.measureElement.innerHTML=""},m}(B),I=function(E){function m(){return null!==E&&E.apply(this,arguments)||this}return(0,W.ZT)(m,E),m.prototype.getItemWidth=function(S,d){return this.rowLevelWidthMeasureManager.getLevelWidth(d.getLevel(S))},m.prototype.adjustItemsHeight=function(S,d,g,y,L,M){},m}(B),q=function(){function E(m,S,d,g){this.columnLevelHeights=[],this.measureElement=m,this.columnWidthMeasureManager=S,this.rowLevelWidthMeasureManager=d,this.sizeManager=g}return E.prototype.clear=function(){this.columnLevelHeights=[]},E.prototype.getMeasureRequiredStyle=function(m){return{"box-sizing":"border-box",width:(0,ie.S)(m)}},E.prototype.measure=function(m,S,d,g,y,L,M){if(0===this.columnLevelHeights.length){for(var Y={done:!1,levels:[],spanningHeaders:[],leafCount:0},c=d.getHierarchyDepth(),e=S.getHierarchyDepth(),t=0;t<c;t++)(void 0===M||M===t)&&(this.columnLevelHeights[t]=this.sizeManager.getColumnLevelHeight(S.getCorner(e-1,t))),Y.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var l=d.getHierarchyItems();l&&this.getHeighestColumnHeaders(l,Y,m,S,d,g,y,L);for(var s=0;s<e;s++)for(var f=0;f<c;f++)if(void 0===this.columnLevelHeights[f]){var u=S.getCorner(s,f),i=this.rowLevelWidthMeasureManager.getLevelWidth(s),h=m.getApproximateCornerCellHeight(u,i);h>Y.levels[f].largestItemHeight&&(Y.levels[f].isHeader=!1,Y.levels[f].largestItem=u,Y.levels[f].largestItemHeight=h,Y.levels[f].largestItemWidth=i)}for(var P="",p=0,v=Y.levels;p<v.length;p++)if((b=v[p]).largestItem){var T=this.getMeasureRequiredStyle(b.largestItemWidth);if(b.isHeader){var R=m.getColumnHeaderBinding(b.largestItem,!0);P+=le.bG.build(R,T)}else R=m.getCornerCellBinding(b.largestItem,!0),P+=le.bG.build(R,T)}if(P){this.measureElement.insertAdjacentHTML("beforeend",P);for(var z=this.measureElement.firstChild,N=0,J=0,oe=Y.levels;J<oe.length;J++){var b;(b=oe[J]).largestItem&&((void 0===M||M===N)&&(this.columnLevelHeights[N]=z.offsetHeight),z=z.nextSibling),N++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(Y,m,S,d,g)}}},E.prototype.adjustLevelHeightsFromSpanningHeaders=function(m,S,d,g,y){for(var L="",M=0,Y=m.spanningHeaders;M<Y.length;M++)if(m.levels[(c=Y[M]).levelToAdjust].largestItem){var e=this.getMeasureRequiredStyle(this.getHeaderWidth(c.item,S,d,g,y)),t=S.getColumnHeaderBinding(c.item,!0);L+=le.bG.build(t,e)}if(L){this.measureElement.insertAdjacentHTML("beforeend",L);for(var l=this.measureElement.firstChild,s=0,f=m.spanningHeaders;s<f.length;s++){var c;m.levels[(c=f[s]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(c.item,c.level,c.levelToAdjust,l.offsetHeight,g),l=l.nextSibling)}this.measureElement.innerHTML=""}},E.prototype.adjustLevelFromSpanningHeader=function(m,S,d,g,y){for(var L=0,M=S;M<=d;M++)L+=this.getLevelHeight(M);g>L&&(this.columnLevelHeights[d]+=g-L)},E.prototype.getHeighestColumnHeaders=function(m,S,d,g,y,L,M,Y){for(var c=0,e=m;c<e.length;c++){var t=e[c];if(S.done)return;var l=y.isLeaf(t),s=y.getLevel(t),f=(0,ue.zG)(t,y),u=(0,ue.pA)(t,y)>=M;if(u)if(1===f){if(void 0===this.columnLevelHeights[s]){var i=this.getHeaderWidth(t,d,g,y,L),h=d.getApproximateColumnHeaderHeight(t,i);h>S.levels[s].largestItemHeight&&(S.levels[s].largestItem=t,S.levels[s].largestItemHeight=h,S.levels[s].largestItemWidth=i)}}else S.spanningHeaders.push({item:t,level:s,levelToAdjust:f+s-1});var P=y.getChildren(t);P&&this.getHeighestColumnHeaders(P,S,d,g,y,L,M,Y),l&&u&&S.leafCount++,S.leafCount===Y&&(S.done=!0)}},E.prototype.getHeadersHeight=function(){for(var m=0,S=0,d=this.columnLevelHeights;S<d.length;S++)m+=d[S];return m},E.prototype.getLevelTop=function(m){for(var S=0,d=0;d<m;d++)S+=this.columnLevelHeights[d];return S},E.prototype.getLevelHeight=function(m){return this.columnLevelHeights[m]},E.prototype.getHeaderWidth=function(m,S,d,g,y){for(var L=(0,ue.LF)(m,g),M=(0,ue.pA)(m,g),Y=0,c=L;c<=M;c++)Y+=this.columnWidthMeasureManager.getColumnWidth(c,S,d,g,y);return Y},E}(),ne=function(){function E(m,S){this.rowLevelWidths=[],this.measureElement=m,this.sizeManager=S}return E.prototype.clear=function(){this.rowLevelWidths=[]},E.prototype.measure=function(m,S,d,g,y,L){if(0===this.rowLevelWidths.length||void 0!==L){for(var M={done:!1,levels:[],spanningHeaders:[],leafCount:0},Y=S.getHierarchyDepth(),c=d.getHierarchyDepth(),e=0;e<Y;e++)(void 0===L||L===e)&&(this.rowLevelWidths[e]=this.sizeManager.getRowLevelWidth(S.getCorner(e,c-1))),M.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(S.getHierarchyItems(),M,m,S,g,y);var t=S.getFloatingHierarchyItems();_.isEmpty(t)||(M.done=!1,M.leafCount=0,this.getWidestRowHeaders(t,M,m,S,-1,S.getFloatingHierarchyLeafCount()));for(var l=0;l<c;l++)for(var s=0;s<Y;s++)if(void 0===this.rowLevelWidths[s]){var f=S.getCorner(s,l),u=m.getApproximateCornerCellWidth(f);u>M.levels[s].largestItemWidth&&(M.levels[s].isHeader=!1,M.levels[s].largestItem=f,M.levels[s].largestItemWidth=u)}for(var i="",h=0,P=M.levels;h<P.length;h++)if((p=P[h]).largestItem)if(p.isHeader){var v=m.getRowHeaderBinding(p.largestItem,!0);i+=le.bG.build(v,E.measureRequiredStyles)}else v=m.getCornerCellBinding(p.largestItem,!0),i+=le.bG.build(v,E.measureRequiredStyles);if(i){this.measureElement.insertAdjacentHTML("beforeend",i);for(var b=this.measureElement.firstChild,T=0,R=0,z=M.levels;R<z.length;R++){var p;(p=z[R]).largestItem&&((void 0===L||L===T)&&(this.rowLevelWidths[T]=b.offsetWidth+1),b=b.nextSibling),T++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(M,m,S)}}},E.prototype.adjustLevelWidthsFromSpanningHeaders=function(m,S,d){for(var g="",y=0,L=m.spanningHeaders;y<L.length;y++)if(m.levels[(M=L[y]).levelToAdjust].largestItem){var Y=S.getRowHeaderBinding(M.item,!0);g+=le.bG.build(Y,E.measureRequiredStyles)}if(g){this.measureElement.insertAdjacentHTML("beforeend",g);for(var c=this.measureElement.firstChild,e=0,t=m.spanningHeaders;e<t.length;e++){var M;m.levels[(M=t[e]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(M.item,M.level,M.levelToAdjust,c.offsetWidth,d),c=c.nextSibling)}this.measureElement.innerHTML=""}},E.prototype.adjustLevelWidthFromSpanningHeader=function(m,S,d,g,y){for(var L=0,M=S;M<=d;M++)L+=this.getLevelWidth(M);g>L&&(this.rowLevelWidths[d]+=g-L)},E.prototype.getWidestRowHeaders=function(m,S,d,g,y,L){for(var M=0,Y=m;M<Y.length;M++){var c=Y[M];if(S.done)return;var e=g.isLeaf(c),t=g.getLevel(c),l=(0,ue.zG)(c,g),s=(0,ue.pA)(c,g)>=y;if(s)if(1===l){if(void 0===this.rowLevelWidths[t]){var f=d.getApproximateRowHeaderWidth(c);f>S.levels[t].largestItemWidth&&(S.levels[t].largestItem=c,S.levels[t].largestItemWidth=f)}}else S.spanningHeaders.push({item:c,level:t,levelToAdjust:l+t-1});var u=g.getChildren(c);u&&this.getWidestRowHeaders(u,S,d,g,y,L),e&&s&&S.leafCount++,S.leafCount===L&&(S.done=!0)}},E.prototype.getHeadersWidth=function(){for(var m=0,S=0,d=this.rowLevelWidths;S<d.length;S++)m+=d[S];return m},E.prototype.getLevelLeft=function(m){for(var S=0,d=0;d<m;d++)S+=this.rowLevelWidths[d];return S},E.prototype.getLevelWidth=function(m){return this.rowLevelWidths[m]},E.prototype.setLevelWidth=function(m,S){this.rowLevelWidths[m]=S},E.prototype.getWidth=function(m,S){for(var d=0,g=m;g<m+S;g++)d+=this.getLevelWidth(g);return d},E.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},E}(),re=function(){function E(m,S){this.measureElement=m,this.sizeManager=S}return E.prototype.clear=function(){this.width=void 0},E.prototype.getHeaderBindingString=function(m,S){var d=S.getRowHeaderBinding(m,!0);return le.bG.build(d,ne.measureRequiredStyles)},E.prototype.measure=function(m,S,d,g,y,L){if((void 0===this.width||void 0!==L)&&(this.width=this.sizeManager.getRowLevelWidth(S.getCorner(0,d.getHierarchyDepth()-1)),void 0===this.width)){for(var M="",Y=Math.min(S.getHierarchyLeafCount()-g,y),c=0;c<Y;c++)M+=this.getHeaderBindingString(S.getHierarchyLeafAt(c+g),m);var e=S.getFloatingHierarchyItems();if(!_.isEmpty(e)){var t=S.getFloatingHierarchyLeafCount();for(c=0;c<t;c++)M+=this.getHeaderBindingString(S.getFloatingHierarchyLeafAt(c),m)}if(S.getHierarchyDepth()>0)for(c=0;c<d.getHierarchyDepth();c++){var l=S.getCorner(0,c),s=m.getCornerCellBinding(l,!0);M+=le.bG.build(s,ne.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",M);for(var f=this.measureElement.firstChild,u=0;f;)u=Math.max(u,f.offsetWidth+1),f=f.nextSibling;this.measureElement.innerHTML="",this.width=u}},E.prototype.getHeadersWidth=function(){return this.width},E.prototype.getLevelWidth=function(m){return this.width},E.prototype.setLevelWidth=function(m,S){this.width=S},E.prototype.getLevelLeft=function(m){return 0},E}()},87914:function(Ve,Fe,X){X.d(Fe,{yv:function(){return ue},zf:function(){return W}});var W=9,ue=250},79465:function(Ve,Fe,X){X.d(Fe,{BM:function(){return W},aP:function(){return ie},p0:function(){return fe},xU:function(){return le},y2:function(){return ue}});var W=function(te){return te[te.Incremental=0]="Incremental",te[te.ClearRendering=1]="ClearRendering",te[te.ClearMeasurement=2]="ClearMeasurement",te[te.ClearMeasurementOnly=3]="ClearMeasurementOnly",te[te.ResizeColumn=4]="ResizeColumn",te}({}),fe=function(te){return te[te.Header=0]="Header",te[te.Body=1]="Body",te[te.Footer=2]="Footer",te[te.FooterHeader=3]="FooterHeader",te[te.MatrixRowHeader=4]="MatrixRowHeader",te[te.MatrixCorner=5]="MatrixCorner",te}({}),ue=function(te){return te[te.Table=0]="Table",te[te.Matrix=1]="Matrix",te}({}),le=function(te){return te[te.Blocked=0]="Blocked",te[te.Stepped=1]="Stepped",te}({}),ie=function(te){return te[te.Prefix=0]="Prefix",te[te.Main=1]="Main",te}({})},44404:function(Ve,Fe,X){X.d(Fe,{S:function(){return fe}});var W=X(62458);function fe(ue){return W.fF.assertValue(null!=ue,"value should be defined"),0===ue?ue.toString():ue+"px"}},7911:function(Ve,Fe,X){X.d(Fe,{BJ:function(){return ie},VG:function(){return le},bG:function(){return te}});var W=X(55007),fe=X(62458),ue=X(79602),le=function(){function Z(){this.columnWidths=[]}return Z.prototype.getColumnWidths=function(){return this.columnWidths},Z.prototype.getWidth=function(){return _.sum(this.columnWidths)},Z}(),ie=function(){function Z(){this.rowHeights=[]}return Z.prototype.getRowHeights=function(){return this.rowHeights},Z.prototype.getHeight=function(){return _.sum(this.rowHeights)},Z.prototype.clear=function(){this.rowHeights=[]},Z}(),te=function(){function Z(){}return Z.build=function(de,K){if(void 0===K&&(K={}),null===de.tagName)return de.content;var ce=de.tagName||"div",r="<"+ce+" "+this.buildAttributes(de.attributes)+this.buildClassNames(de.classNames)+this.buildStyles(de.styleProperties,K)+">";if(_.isEmpty(de.children))null!=de.content&&(r+=de.content);else for(var w=0,n=de.children;w<n.length;w++)r+=Z.build(n[w],null);return r+"</"+ce+">"},Z.buildMultiple=function(de){return _.map(de,function(K){return Z.build(K)}).join("")},Z.buildAttributes=function(de){var K="";if(de)for(var ce in de)K+=ce+"="+W.u3+de[ce]+W.u3;return K},Z.buildClassNames=function(de){if(!de||0===de.length)return"";for(var K='class="',ce=0,r=de;ce<r.length;ce++)K+=r[ce]+" ";return K+'"'},Z.buildStyles=function(de,K){var ce=!_.isEmpty(K),r=!_.isEmpty(de);if(!ce&&!r)return"";var w="style="+W.u3;if(r)for(var n in de)w+=n+":"+de[n]+";";if(ce)for(var o in K)w+=o+":"+K[o]+";";return w+W.u3},Z.attachEventHandlers=function(de,K){if(K.clickHandler&&de.addEventListener("click",function(r){return K.clickHandler(r)}),K.contextMenuHandler&&de.addEventListener("contextmenu",function(r){return K.contextMenuHandler(r)}),K.scrollHandler&&ue.l.runOutsideAngular(function(){de.addEventListener("scroll",function(r){return K.scrollHandler(r)})}),!_.isEmpty(K.children)){fe.fF.assert(function(){return K.children.length===de.childNodes.length},"Element children mismatch");for(var ce=0;ce<K.children.length;ce++)null!==K.children[ce].tagName&&Z.attachEventHandlers(de.childNodes[ce],K.children[ce])}},Z.attachEventHandlersMultiple=function(de,K){var ce=de;K.forEach(function(r){Z.attachEventHandlers(ce,r),ce=ce.nextElementSibling})},Z}()},24133:function(Ve,Fe,X){X.d(Fe,{d:function(){return Y}});var W=X(81337),fe=X(11034),ue=X(62458),le=X(59107),ie=X(98094),te=X(79602),Z=X(44102),de=X(93340),K=X(71090),ce=X(52073),r=X(15366),w=X(44404),n=X(87914),o=X(79465),H=X(11184),B=function(){function c(e,t,l){this.onFocusChangedHandler=e,this.isA11yTable=t,this.isA11yMatrix=l}return Object.defineProperty(c.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),c.prototype.updateMeasureManagers=function(e,t){this.rowHeightMeasureManager=e,this.columnWidthMeasureManager=t},c.prototype.setAsFocusTableEx=function(e,t,l,s){ue.fF.assert(function(){return null!=e||l!==o.p0.Body},"body cells need row index"),l===o.p0.Header?this.currentFocus=s?{columnHeader:s}:{columnHeader:[t]}:l===o.p0.Body?this.currentFocus={bodyCell:{rowIndex:e,columnIndex:t}}:l===o.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:e??0,columnIndex:t}}:l===o.p0.FooterHeader?this.currentFocus={floatingRowHeader:e}:l===o.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:t,columnLevel:e}}:l===o.p0.MatrixRowHeader?this.currentFocus=s?{rowHeader:s}:{rowHeader:[e]}:ue.fF.assertNever(l),this.updateFocusedItem()},c.prototype.updateFocusedItem=function(){if(ue.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var e=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);ue.fF.assertValue(e,"row leaf not found"),ue.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(e=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),ue.fF.assertValue(e,"row leaf not found"),ue.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):ue.fF.assertFail("unexpected focus state");ue.fF.assertValue(this.currentFocus,"Undefined focused item")}},c.prototype.moveFocus=function(e,t,l,s,f,u){ue.fF.assertValue(this.currentFocus,"No initial focus");var i=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(e,t,f,s):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(e,t,f,u):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(e,t,s):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(e,t):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(e,t):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(e,t)),ue.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=i},c.prototype.moveBodyCellFocusTableEx=function(e,t,l,s){var f=this.currentFocus.bodyCell.rowIndex,u=this.currentFocus.bodyCell.columnIndex,i=this.rowNavigator.getFloatingHierarchyLeafCount()>0,h=-1===u,P=this.rowHeightMeasureManager.getPageRows().length,p=_.last(this.rowHeightMeasureManager.getPageRows()),v=(P-1)*r.hw+(p.getRowHeights().length-1),b=this.columnWidthMeasureManager.getPageColumns().length,T=_.last(this.columnWidthMeasureManager.getPageColumns()),R=(b-1)*r.MN+(T.getColumnWidths().length-1);if(t){if("home"===e)return s?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return s?this.getBottomRightCell():i?{floatingBodyCell:{rowIndex:0,columnIndex:R}}:{bodyCell:{rowIndex:v,columnIndex:R}};if("up"===e)return s?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(u))[0]]}:h?{bodyCell:{rowIndex:0,columnIndex:u}}:{columnHeader:[u]};if("down"===e)return h||!i?{bodyCell:{rowIndex:v,columnIndex:u}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:u}};if("left"===e)return s?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))[0]]}:{bodyCell:{rowIndex:f,columnIndex:0}};if("right"===e)return{bodyCell:{rowIndex:f,columnIndex:R}}}else{if("home"===e){if(s){var z=this.rowNavigator.getHierarchyLeafAt(f),N=this.rowNavigator.getLeafAncestorAtLevel(z,0);return{rowHeader:this.rowNavigator.getPathIndices(N)}}return{bodyCell:{rowIndex:f,columnIndex:0}}}if("end"===e)return s?{bodyCell:{rowIndex:f,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:f,columnIndex:R}};if("pageup"===e&&l)return{bodyCell:{rowIndex:oe=Math.max(this.prevNonblankRowIndex(f-l+1),0),columnIndex:u}};if("pagedown"===e&&l){var pe=this.prevNonblankRowIndex(v+1);return{bodyCell:{rowIndex:oe=Math.min(this.nextNonblankRowIndex(f+l-1),pe),columnIndex:u}}}if("up"===e)return(oe=this.prevNonblankRowIndex(f))<0?h?{bodyCell:{rowIndex:0,columnIndex:u}}:s&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(u))}:{columnHeader:[u]}:{bodyCell:{rowIndex:oe,columnIndex:u}};if("down"===e){var oe;if(!((oe=this.nextNonblankRowIndex(f))>v))return{bodyCell:{rowIndex:oe,columnIndex:u}};if(h||!i&&!s)return{bodyCell:{rowIndex:v,columnIndex:u}};if(!s||i)return{floatingBodyCell:{rowIndex:0,columnIndex:u}}}if("left"===e)return s&&0===u?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))}:{rowHeader:[f]}:{bodyCell:{rowIndex:f,columnIndex:Math.max(u-1,-1)}};if("right"===e)return{bodyCell:{rowIndex:f,columnIndex:Math.min(u+1,R)}}}return this.currentFocus},c.prototype.moveRowHeaderFocusTableEx=function(e,t,l,s){var f,u=this.columnWidthMeasureManager.getLastMeasuredIndex(),i=this.columnNavigator.getHierarchyDepth(),h=this.currentFocus.rowHeader,P=this.rowNavigator.getNodeFromPath(h),p=this.rowNavigator instanceof H.S?0:this.rowNavigator.getLevel(P),v=this.rowNavigator.getItemsByLevel(p),b=v.indexOf(P),T=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:p,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(p)}else{if("left"===e&&h.length>1)return{rowHeader:_.dropRight(h,1)};if("right"===e){if(null!==(f=this.previousFocus)&&void 0!==f&&f.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var R=this.rowNavigator.getLeafIndex(P);if(void 0===R)return{rowHeader:(0,W.ev)((0,W.ev)([],h||[],!0),[0],!1)};if(u>-1)return{bodyCell:{rowIndex:R,columnIndex:0}}}if("up"===e)return(z=this.prevNonblankHeaderRowIndex(b,v))>=0?{rowHeader:this.rowNavigator.getPathIndices(v[z])}:{cornerCell:{rowLevel:p,columnLevel:i-1}};if("down"===e){if((z=this.nextNonblankHeaderRowIndex(b,v))<=v.length-1)return{rowHeader:this.rowNavigator.getPathIndices(v[z])};if(T)return{floatingRowHeader:0}}if("pagedown"===e){var N=this.rowHeightMeasureManager.getLastMeasuredIndex(),J=(0,ce.hG)(this.currentFocus.item,this.rowNavigator),oe=this.nextNonblankRowIndex(J+l-1),pe=this.prevNonblankRowIndex(N+1),se=Math.min(oe,pe),A=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(se));if(this.rowNavigator.isLeaf(P)||this.rowNavigator instanceof H.S)return{rowHeader:A};var ae=_.take(A,Math.min(this.currentFocus.rowHeader.length,A.length)),z=this.nextNonblankHeaderRowIndex(b,v);return _.isEqual(ae,this.currentFocus.rowHeader)&&z<=v.length-1?{rowHeader:this.rowNavigator.getPathIndices(v[z])}:{rowHeader:ae}}if("pageup"===e&&(J=(0,ce.hG)(this.currentFocus.item,this.rowNavigator),se=Math.max(this.prevNonblankRowIndex(J-l+1),0),A=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(se)),(ae=_.take(A,Math.min(this.currentFocus.rowHeader.length,A.length)))!==this.currentFocus.rowHeader))return{rowHeader:ae}}return h.length>1&&(t&&"left"===e||"home"===e)?{rowHeader:[h[0]]}:t&&"right"===e||"end"===e?{bodyCell:{rowIndex:(0,ce.hG)(P,this.rowNavigator),columnIndex:u}}:this.currentFocus},c.prototype.moveColumnHeaderFocusTableEx=function(e,t,l){var s,f=this.currentFocus.columnHeader[0],u=this.rowNavigator.getFloatingHierarchyLeafCount()>0,i=this.rowHeightMeasureManager.getPageRows().length,h=_.last(this.rowHeightMeasureManager.getPageRows()),P=h?(i-1)*r.hw+(h.getRowHeights().length-1):-1,p=this.columnWidthMeasureManager.getPageColumns().length,v=_.last(this.columnWidthMeasureManager.getPageColumns()),b=(p-1)*r.MN+(v.getColumnWidths().length-1),T=this.currentFocus.columnHeader,R=this.columnNavigator.getNodeFromPath(T),z=this.columnNavigator.getLevel(R),N=this.rowNavigator.getHierarchyDepth();if(t){if("home"===e)return l?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e){if(l)return this.getBottomRightCell();if(u)return{floatingBodyCell:{rowIndex:0,columnIndex:b}};if(-1!==P)return{bodyCell:{rowIndex:P,columnIndex:b}}}if("down"===e){var J=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(R):f;return this.getBottomFooterBodyCell(J,P)}if("up"===e)return{columnHeader:[T[0]]}}else{if("up"===e&&l&&this.columnNavigator.hasHierarchy()&&T.length>1)return{columnHeader:_.dropRight(T,1)};if("down"===e){if(l){if(null!==(s=this.previousFocus)&&void 0!==s&&s.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var oe=this.columnNavigator.getLeafIndex(R);if(!this.columnNavigator.isLeaf(R))return{columnHeader:(0,W.ev)((0,W.ev)([],this.currentFocus.columnHeader,!0),[0],!1)};if(P>=0)return{bodyCell:{rowIndex:0,columnIndex:oe}};if(u)return{floatingBodyCell:{rowIndex:0,columnIndex:oe}}}if(-1!==P)return{bodyCell:{rowIndex:0,columnIndex:f}}}var pe=this.columnNavigator.getItemsByLevel(z),se=pe.indexOf(R);if("left"===e)return l?se>0?{columnHeader:this.columnNavigator.getPathIndices(pe[se-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:N-1,columnLevel:z}}:{cornerCell:{rowLevel:0,columnLevel:z}}:{columnHeader:[Math.max(f-1,0)]};if("right"===e)return l&&-1!==se?{columnHeader:this.columnNavigator.getPathIndices(pe[Math.min(se+1,pe.length-1)])}:{columnHeader:[Math.min(f+1,b)]}}return"home"===e||t&&"left"===e?l?{cornerCell:{rowLevel:0,columnLevel:z}}:{columnHeader:[0]}:"end"===e||t&&"right"===e?l?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[b]}:this.currentFocus},c.prototype.moveCornerCellFocusTableEx=function(e,t){var l=this.currentFocus.cornerCell.rowLevel,s=this.currentFocus.cornerCell.columnLevel,f=this.rowNavigator.getItemsByLevel(l),u=this.columnNavigator.getItemsByLevel(s),i=this.rowNavigator.getHierarchyLeafCount(),h=this.rowNavigator.getHierarchyDepth(),P=this.columnNavigator.getHierarchyDepth(),p=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:l,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(l)}else{if("up"===e&&s>0)return{cornerCell:{rowLevel:l,columnLevel:s-1}};if("down"===e){if(s<P-1)return{cornerCell:{rowLevel:l,columnLevel:s+1}};if(i>0)return{rowHeader:this.rowNavigator.getPathIndices(f[0])};if(p)return{floatingRowHeader:0}}if("right"===e){if(l<h-1)return{cornerCell:{rowLevel:l+1,columnLevel:s}};if(!_.isEmpty(u))return{columnHeader:this.columnNavigator.getPathIndices(u[0])}}if("left"===e&&l>0)return{cornerCell:{rowLevel:l-1,columnLevel:s}}}return l>0&&("home"===e||t&&"left"===e)?{cornerCell:{rowLevel:0,columnLevel:s}}:"end"===e||t&&"right"===e?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},c.prototype.moveFloatingRowHeaderFocusTableEx=function(e,t){var l=this.rowNavigator.getHierarchyLeafCount(),s=this.columnWidthMeasureManager.getLastMeasuredIndex(),f=this.columnNavigator.getHierarchyDepth(),u=this.currentFocus.floatingRowHeader;if(ue.fF.assert(function(){return s>-1},"There can not be Floating rows without column headers"),t){if("home"===e||"up"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("down"===e&&u<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===e)return{floatingBodyCell:{rowIndex:u,columnIndex:0}};if("up"===e){if(u>0)return{floatingRowHeader:u-1};if(l>0){var i=this.rowNavigator.getItemsByLevel(0),h=this.prevNonblankHeaderRowIndex(i.length,i);return{rowHeader:this.rowNavigator.getPathIndices(i[h])}}return{cornerCell:{rowLevel:0,columnLevel:f-1}}}if("down"===e&&u<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:u+1}}return t&&"right"===e||"end"===e?{floatingBodyCell:{rowIndex:u,columnIndex:s}}:this.currentFocus},c.prototype.moveFloatingBodyCellFocusTableEx=function(e,t){var l=this.currentFocus.floatingBodyCell.columnIndex,s=this.currentFocus.floatingBodyCell.rowIndex,f=-1===l,u=this.rowHeightMeasureManager.getPageRows().length,i=_.last(this.rowHeightMeasureManager.getPageRows()),h=i?(u-1)*r.hw+(i.getRowHeights().length-1):-1,P=this.columnWidthMeasureManager.getPageColumns().length,p=_.last(this.columnWidthMeasureManager.getPageColumns()),v=(P-1)*r.MN+(p.getColumnWidths().length-1);if(t){if("home"===e)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:v}};if("up"===e){if(this.isA11yMatrix){var b=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0);return{columnHeader:[this.columnNavigator.getIndex(b)]}}return f?{bodyCell:{rowIndex:0,columnIndex:l}}:{columnHeader:[l]}}if("down"===e)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:l}};if("left"===e)return this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===e)return{floatingBodyCell:{rowIndex:s,columnIndex:v}}}else{if("home"===e)return this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===e)return{floatingBodyCell:{rowIndex:0,columnIndex:v}};if("up"===e)return 0===s?h>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(h+1),columnIndex:l}}:(b=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0),{columnHeader:[this.columnNavigator.getIndex(b)]}):{floatingBodyCell:{rowIndex:s-1,columnIndex:l}};if("down"===e&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:s+1,columnIndex:l}};if("left"===e)return 0===l&&this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:s,columnIndex:Math.max(l-1,0)}};if("right"===e)return{floatingBodyCell:{rowIndex:s,columnIndex:Math.min(l+1,v)}}}return this.currentFocus},c.prototype.getBottomRightCell=function(){var e=this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.columnWidthMeasureManager.getLastMeasuredIndex(),l=this.rowNavigator.getHierarchyLeafCount()-1;return e>0?{floatingBodyCell:{rowIndex:e-1,columnIndex:t}}:{bodyCell:{rowIndex:l,columnIndex:t}}},c.prototype.getLastMatrixColumnCell=function(e){var t=this.columnNavigator.getHierarchyLeafCount(),l=this.columnNavigator.getHierarchyLeafAt(t-1),s=this.columnNavigator.getPathIndices(l);return{columnHeader:_.dropRight(s,s.length-(e+1))}},c.prototype.getFirstColumnLeafFromAncestor=function(e){return this.columnNavigator.isLeaf(e)?this.columnNavigator.getLeafIndex(e):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(e)[0])},c.prototype.getBottomFooterBodyCell=function(e,t){var l=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==e&&l?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:e}}:-1===t?this.currentFocus:{bodyCell:{rowIndex:t,columnIndex:e}}},c.prototype.getBottomFooterHeaderCell=function(e){var t=this.rowNavigator.getItemsByLevel(e);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(t[t.length-1])}},c.prototype.prevNonblankRowIndex=function(e){for(var t=e-1;t>=0;t--)if(!this.rowNavigator.isBlankRow(t))return t;return-1},c.prototype.nextNonblankRowIndex=function(e){for(var t=this.rowNavigator.getHierarchyLeafCount(),l=e+1;l<t;l++)if(!this.rowNavigator.isBlankRow(l))return l;return t+1},c.prototype.prevNonblankHeaderRowIndex=function(e,t){for(var l=e-1;l>=0;l--)if(!this.rowNavigator.isBlank(t[l]))return l;return-1},c.prototype.nextNonblankHeaderRowIndex=function(e,t){for(var l=e+1;l<t.length;l++)if(!this.rowNavigator.isBlank(t[l]))return l;return t.length},c}(),k=X(52287),I=function(){function c(e,t,l,s,f,u){var i=this;this.isA11yMatrix=u,this.elementOriginalCursor=t?.style.cursor,this.verticalResizeHandler=l,this.horizontalResizeHandler=s,(l||s)&&(t.addEventListener("mousedown",function(h){return t.closest("[".concat(k.y3,"=true]"))?null:i.onMouseDown(e,t,h)}),t.addEventListener("mousemove",function(h){return t.closest("[".concat(k.y3,"=true]"))?null:i.onMouseMove(t,h)}),t.addEventListener("dblclick",function(h){return t.closest("[".concat(k.y3,"=true]"))?null:i.onDoubleClick(e,t,h)})),f&&t.addEventListener("click",function(h){return i.onClick(e,t,h,f)})}return c.prototype.onMouseDown=function(e,t,l){var s=this.getActiveHandler(t,l);if(s){this.resizing=!0,this.startMousePosition=c.getMouseCoordinates(l);var f=(0,de.df)(t);this.initializeDocumentEvents(t,s,f),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(t,l)),s.onStartResize(e)}else this.resizing=!1},c.prototype.onMouseMove=function(e,t){this.startMousePosition||(e.style.cursor=this.getCursor(e,t))},c.prototype.onDoubleClick=function(e,t,l){var s=this.getActiveHandler(t,l);s&&s.onReset(e)},c.prototype.onClick=function(e,t,l,s){this.isA11yMatrix&&!t.closest("[".concat(k.y3,"=true]"))&&l.stopPropagation(),!this.resizing&&s&&s(e,l)},c.prototype.getActiveHandler=function(e,t){return this.isMouseOnVerticalHandle(e,c.getMouseCoordinates(t))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(e,c.getMouseCoordinates(t))?this.horizontalResizeHandler:null},c.prototype.getCursor=function(e,t){return this.isMouseOnVerticalHandle(e,c.getMouseCoordinates(t))?"col-resize":this.isMouseOnHorizontalHandle(e,c.getMouseCoordinates(t))?"row-resize":this.elementOriginalCursor},c.prototype.initializeDocumentEvents=function(e,t,l){var s=this;this.documentMouseMoveListener=function(f){f.preventDefault(),t.onResize(c.getMouseCoordinatesDelta(s.startMousePosition,c.getMouseCoordinates(f),l))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(f){f.preventDefault(),document.removeEventListener("mousemove",s.documentMouseMoveListener),s.documentMouseMoveListener=null,document.removeEventListener("mouseup",s.documentMouseUpListener),s.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=s.documentOriginalCursor,s.documentOriginalCursor=void 0),s.startMousePosition=null,t.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},c.prototype.isMouseOnVerticalHandle=function(e,t){return!!this.verticalResizeHandler&&t.x>=e.getBoundingClientRect().right-c.HandleSize},c.prototype.isMouseOnHorizontalHandle=function(e,t){return!!this.horizontalResizeHandler&&t.y>=e.getBoundingClientRect().bottom-c.HandleSize},c.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},c.getMouseCoordinatesDelta=function(e,t,l){return t&&e?{x:(t.x-e.x)/l,y:(t.y-e.y)/l}:{x:0,y:0}},c.HandleSize=4,c}(),q=function(){function c(e,t,l){this.a11yTableFS=t,this.a11yMatrixFS=l,this.control=e}return c.prototype.onStartResize=function(e){var t=(0,ce.oj)(e,this.control.getColumnNavigator()),l=this.control.getColumnNavigator().getLeafIndex(t);this.resizeState={leafToResize:t,leafToResizeIndex:l,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(l)}},c.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),l=r._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),s=r.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(l&&s){var f=Math.max(this.resizeState.originalWidth+e.x,I.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,f),r._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,s.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ResizeColumn)}}},c.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.leafToResize,t=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),l=this.resizeState.originalWidth;this.resizeState=void 0;var s=this.control.getViewport(),f=r._E.getVisibleRange(s.top,s.height,this.control.getRowHeightMeasureManager());if(f&&t!==l){this.control.getSizeManager().setColumnWidth(e,t);var u=r._E.getVisibleRowStart(f,s.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}}},c.prototype.onReset=function(e){var t=this.control.getViewport(),l=r._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(l){var s=(0,ce.oj)(e,this.control.getColumnNavigator()),f=this.control.getColumnNavigator().getLeafIndex(s);this.control.getSizeManager().setColumnWidth(s,void 0),r.sW.remeasureColumn(f,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,this.control.getColumnWidthMeasureManager());var u=r._E.getVisibleRowStart(l,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}},c}(),E=function(){function c(e,t){this.a11yMatrixFS=t,this.control=e}return c.prototype.onStartResize=function(e){var t=this.getLevelToResize(e);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(t,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:t,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(t)}},c.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),l=r._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),s=r.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(l){var f=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+e.x,I.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,f),r._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,s?s.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ResizeColumn)}}},c.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.cornerCellToResize,t=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),l=this.resizeState.originalWidth;this.resizeState=void 0;var s=this.control.getViewport(),f=r._E.getVisibleRange(s.top,s.height,this.control.getRowHeightMeasureManager());if(f&&t!==l){this.control.getSizeManager().setRowLevelWidth(e,t);var u=r._E.getVisibleRowStart(f,s.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}}},c.prototype.onReset=function(e){var t=this.control.getViewport(),l=r._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(l){var s=this.getLevelToResize(e),f=this.control.getRowNavigator().getCorner(s,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(f,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,r.Ms,s);var u=r._E.getVisibleRowStart(l,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.Incremental,u)}},c.prototype.getLevelToResize=function(e){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(e)},c.prototype.getMaxWidth=function(e){for(var t=this.control.getClientWidth(),l=0;l<e;l++)t-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(l);return t},c}(),m=X(57470),S=X(7911),d=function(){function c(e,t,l,s,f,u,i,h,P,p,v,b,T){var z,R=this;this.element=e,this.prefixCellClickHandler=t,this.prefixCellContextMenuHandler=l,this.mainCellClickHandler=s,this.mainCellContextMenuHandler=f,this.interactionHandler=u,this.section=i,this.renderType=h,this.onObject=P,this.enableCalculationHighlight=p,this.isRenderStable=v,this.showTotalPlaceHolders=b,this.showAsTableNativeMenu=T,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(N){var J,oe,pe=N.target,se=R.getItemByElement(pe);se&&(R.isPrefixCell(pe)?null===(J=R.prefixCellClickHandler)||void 0===J||J.call(R,se,N,void 0,R.section):null===(oe=R.mainCellClickHandler)||void 0===oe||oe.call(R,se,N,void 0,R.section))}),this.element.addEventListener("contextmenu",function(N){var J,oe,pe=N.target,se=R.getItemByElement(pe);!se||T||(R.isPrefixCell(pe)?null===(J=R.prefixCellContextMenuHandler)||void 0===J||J.call(R,se,N):null===(oe=R.mainCellContextMenuHandler)||void 0===oe||oe.call(R,se,N))}),this.renderType===o.y2.Table&&this.element.addEventListener("change",function(N){var J,oe=d3.select(N.target).attr("checkbox-rowindex");null!=oe&&(null===(J=R.mainCellClickHandler)||void 0===J||J.call(R,void 0,void 0,+oe,R.section))}),null===(z=this.interactionHandler)||void 0===z||z.setTooltipDelegate(function(N){return R.getItemByElement(N.context)},this.element,this.getRegion.bind(this),!T,function(N){return R.shouldHideDefaultTooltip(N.context)})}return c.prototype.update=function(e,t,l,s){var f=this.rowHeightMeasureManager.getLastMeasuredIndex(),u=this.columnWidthMeasureManager.getLastMeasuredIndex(),i=r._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager,r.hw,f),h=r.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager,r.MN,u);if(this.section!==o.p0.Body||i){var P,p,v;switch(h||(h={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case o.p0.Header:P=[0,s.getHierarchyDepth()-1],p=this.rowHeightMeasureManager.getPageRows(),v=this.columnWidthMeasureManager.getPageColumns();break;case o.p0.Body:P=[i.firstLeafIndex,i.lastLeafIndex],p=this.rowHeightMeasureManager.getPageRows(),v=this.columnWidthMeasureManager.getPageColumns();break;case o.p0.Footer:P=[0,l.getFloatingHierarchyLeafCount()-1],p=[this.rowHeightMeasureManager.getFloatingPageRow()],v=this.columnWidthMeasureManager.getPageColumns();break;default:ue.fF.assertNever(this.section)}this.renderMeta={viewport:e,binder:t,rowNavigator:l,columnNavigator:s,visibleRowRange:P,visibleColumnRange:[h.firstLeafIndex,h.lastLeafIndex],pageRows:p,pageColumns:v},this.updateRendering()}},c.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e},c.prototype.setRepeatRowHeaders=function(e){this.repeatRowHeaders=e},c.prototype.setRowWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(t+=e),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",t+"px")},c.prototype.updateBodyLeft=function(){var e=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",e+"px")},c.prototype.shouldHideDefaultTooltip=function(e){var l=m.M.getFirstMatchingAncestor(e,function(i){return i.matches(".prefix-cell")||i.matches(".main-cell")},this.element,!0);if(!l)return!0;var f,s=d3.select(l);return!s.select(".tablixUrlIconGlyph").node()&&(!(f=s.classed("pivotTableCellWrap")||s.classed("pivotTableCellNoWrap")?s.node():s.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||f.scrollHeight===f.clientHeight&&f.scrollWidth===f.clientWidth)},c.prototype.updateMeasureManagers=function(e,t,l,s,f){this.rowHeaderType=e,this.rowHeightMeasureManager=t,this.columnWidthMeasureManager=l,this.rowLevelWidthMeasureManager=s,this.columnLevelHeightMeasureManager=f},c.prototype.scrollToX=function(e){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-e+"px"),this.xPosition=e},c.prototype.onColumnResize=function(){var e=this;d3.select(this.element).selectAll(".row").each(function(){var t=e.getRowIndex(this),l=e.getRowHeight(t),s=e.getRowTop(t);d3.select(this).style("height",l+"px").style("top",s+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),l=e.getColumnIndex(this),s=e.isFillerCell(this),f=s?0:e.getPrefixCellHeight(t,l),u=s?0:e.getPrefixCellWidth(t,l),i=e.getPrefixCellLeft(t,l),h=parseFloat(d3.select(this).style("--padding-left")),P=parseFloat(d3.select(this).style("--padding-right")),p=e.getAdjustedPaddings(u,h,P),v=p[0],b=p[1];d3.select(this).style("height",f+"px").style("width",u+"px").style("left",i+"px").style("padding-left",v+"px").style("padding-right",b+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),l=e.getColumnIndex(this),s=e.getMainCellHeight(t,l),f=e.getMainCellWidth(t,l),u=e.getMainCellLeft(t,l),i=parseFloat(d3.select(this).style("--padding-left")),h=parseFloat(d3.select(this).style("--padding-right")),P=e.getAdjustedPaddings(f,i,h),p=P[0],v=P[1];d3.select(this).style("height",s+"px").style("width",f+"px").style("left",u+"px").style("padding-left",p+"px").style("padding-right",v+"px")}),this.adjustHeaders()},c.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},c.prototype.getElementByIndex=function(e,t,l){var s=l===o.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(e,'"] ').concat(s,'[column-index="').concat(t,'"]')).node()},c.prototype.getItemByElement=function(e){if(this.isRenderStable()){var t=this.getRowIndex(e);if(null!=t){var l=this.getColumnIndex(e);if(null!=l){var s=this.isPrefixCell(e);return this.getCellItem(t,l,s)}}}},c.prototype.updateRendering=function(){var e=this,t=[],l=[];this.clearUnusedElements(),this.setGroupLocations(t,l),t.forEach(function(s){return e.insertRowGroup(s)}),l.forEach(function(s){return e.insertCellGroup(s)}),this.scrollToX(this.xPosition),this.adjustHeaders()},c.prototype.clearUnusedElements=function(){var e=this;for(var t in this.viewSync)if(+t<this.renderMeta.visibleRowRange[0]||+t>this.renderMeta.visibleRowRange[1])delete this.viewSync[t];else for(var l in this.viewSync[t])+l>=0&&(+l<this.renderMeta.visibleColumnRange[0]||+l>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[t][l];d3.select(this.element).selectAll(".row").filter(function(){var s=e.getRowIndex(this);return s<e.renderMeta.visibleRowRange[0]||s>e.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var s=e.getColumnIndex(this);return s<e.renderMeta.visibleColumnRange[0]||s>e.renderMeta.visibleColumnRange[1]}).remove()},c.prototype.setGroupLocations=function(e,t){for(var l,s=this.renderMeta.visibleRowRange[0];s<=this.renderMeta.visibleRowRange[1];s++)if(this.viewSync[s]){l=!1;var u=void 0;this.viewSync[s][-1]||t.push({rowIndex:s,columnStart:-1,columnEnd:-1});for(var f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[s][f]?u=!1:(u?_.last(t).columnEnd++:(t.push({rowIndex:s,columnStart:f,columnEnd:f}),u=!0),this.viewSync[s][f]=!0)}else for(l?_.last(e).rowEnd++:(e.push({rowStart:s,rowEnd:s}),l=!0),this.viewSync[s]={"-1":!0},f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[s][f]=!0},c.prototype.insertRowGroup=function(e){for(var l,t=this,s=d3.select(this.element).selectAll(".row").nodes(),f=s.length-1;f>=0;f--){ue.fF.assert(function(){return t.section===o.p0.Body},"header and footer should never insert additional row groups");var u=this.getRowIndex(s[f]);if(e.rowStart>u){l=s[f];break}}var h,i=this.getRowGroupBindings(e.rowStart,e.rowEnd);l?(l.insertAdjacentHTML("afterend",S.bG.buildMultiple(i)),h=l.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",S.bG.buildMultiple(i)),h=_.first(this.element.children)),S.bG.attachEventHandlersMultiple(h,i)},c.prototype.insertCellGroup=function(e){var t;ue.fF.assert(function(){return-1!==e.columnStart},"cell group insertion of prefix cells is not supported");for(var s=d3.select(this.element).select('[row-index="'.concat(e.rowIndex,'"]')).select(".scrollable-cells-container"),f=s.node(),u=s.selectAll(".prefix-cell").nodes(),i=s.selectAll(".main-cell").nodes(),h=i.length-1;h>=0;h--){var P=this.getColumnIndex(i[h]);if(e.columnStart>P){t=i[h];break}}!t&&!_.isEmpty(u)&&(t=_.last(u));var v,p=this.getMainBindings(e.rowIndex,e.columnStart,e.columnEnd);t?(t.insertAdjacentHTML("afterend",S.bG.buildMultiple(p)),v=t.nextElementSibling):(f.insertAdjacentHTML("afterbegin",S.bG.buildMultiple(p)),v=_.first(f.children)),S.bG.attachEventHandlersMultiple(v,p)},c.prototype.getRowGroupBindings=function(e,t){for(var l,s=[],f=e;f<=t;f++){var u=this.getRowHeight(f),i=this.getRowTop(f),h=!1,P=0;this.renderMeta.binder.blankRowsEnabled()&&(h=this.renderMeta.rowNavigator.isBlankRow(f),P=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(f));var p={classNames:["row"],attributes:{role:"row","row-index":f.toString()},styleProperties:{position:"absolute",height:u+"px",width:"100%",top:i+"px","pointer-events":"none"},children:[]};h?p.attributes["aria-hidden"]="true":p.attributes["aria-rowindex"]=(this.getAriaRowIndex(f)-P).toString();var v=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),b=this.columnWidthMeasureManager.getColumnsWidth(),T=this.getPrefixBindings(f),R=this.getMainBindings(f,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===o.y2.Matrix&&(l=p.children).push.apply(l,T);var N={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:v+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:b+"px"},children:this.unfrozenRowHeaders||this.renderType===o.y2.Table?(0,W.ev)((0,W.ev)([],T,!0),R,!0):R}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===o.y2.Matrix&&(N.attributes[k.oy]=(0).toString()),p.children.push(N),s.push(p)}return s},c.prototype.getPrefixBindings=function(e){for(var t=[],l=this.renderMeta.rowNavigator.getHierarchyDepth(),s=0;s<l;s++){var f=this.getPrefixCellBinding(e,s);t.push(f)}return t},c.prototype.getMainBindings=function(e,t,l){for(var s=[],f=t;f<=l;f++){var u=this.getMainCellBinding(e,f);s.push(u)}return s},c.prototype.adjustCellBindingPadding=function(e,t){var l=parseFloat(e.styleProperties["padding-left"]),s=parseFloat(e.styleProperties["padding-right"]);isNaN(l)&&(l=0),isNaN(s)&&(s=0);var f=this.getAdjustedPaddings(t,l,s),i=f[1];e.styleProperties["padding-left"]=f[0]+"px",e.styleProperties["padding-right"]=i+"px",e.styleProperties["--padding-left"]=l.toString(),e.styleProperties["--padding-right"]=s.toString()},c.prototype.getAdjustedPaddings=function(e,t,l){var s=Math.max(e-t,0),f=Math.min(l,s);return[Math.min(t,e),f]},c.prototype.getRowIndex=function(e){var l=m.M.getFirstMatchingAncestor(e,function(f){return f.matches("[row-index]")},this.element,!0);return l&&+l.getAttribute("row-index")},c.prototype.getColumnIndex=function(e){var l=m.M.getFirstMatchingAncestor(e,function(f){return f.matches("[column-index]")},this.element,!0);return l&&+l.getAttribute("column-index")},c.prototype.isPrefixCell=function(e){return!!m.M.getFirstMatchingAncestor(e,function(f){return f.matches(".prefix-cell")},this.element,!0)},c.prototype.getRegion=function(e){return this.isPrefixCell(e)?o.aP.Prefix:o.aP.Main},c.prototype.isFillerCell=function(e){return!!m.M.getFirstMatchingAncestor(e,function(f){return f.matches(".filler-cell")},this.element,!0)},c.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},c.prototype.getAriaColIndex=function(e,t){return t?e+1:e+1+this.renderMeta.rowNavigator.getHierarchyDepth()},c.prototype.getColumnWidth=function(e,t){return t?this.rowLevelWidthMeasureManager.getLevelWidth(e):this.columnWidthMeasureManager.getPageColumns()[r.yl.getPageIndex(e,r.MN)].getColumnWidths()[e%r.MN]},c.prototype.getColumnLeft=function(e,t){if(t)return this.rowLevelWidthMeasureManager.getLevelLeft(e);var s=this.columnWidthMeasureManager.getPageColumns()[r.yl.getPageIndex(e,r.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(s)+_.sum(s.getColumnWidths().slice(0,e%r.MN))},c}(),g=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,W.ZT)(e,c),e.prototype.setResizeHandlers=function(t,l){this.columnWidthResizeHandler=t,this.rowLevelWidthResizeHandler=l},e.prototype.adjustHeaders=function(){var t=this;for(var l in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var i=t.getRowIndex(this),h=t.getColumnIndex(this),P=t.getMainCellWidth(i,h),p=h===t.renderMeta.visibleColumnRange[0],v=d3.select(this).classed("secondary-columnheader")&&!p;if(d3.select(this).classed("visually-hidden",v),p&&!d3.select(this).classed("last-secondary-columnheader")){var b=t.getColumnHeaderOffset(h),T=P-b;d3.select(this).style("transform","translateX(".concat(b,"px)")),d3.select(this).style("width",T+"px")}else v||(d3.select(this).style("transform",null),d3.select(this).style("width",P+"px"))}),this.viewSync)for(var s in this.viewSync[l])if("resizable"!==this.viewSync[l][s]){if("-1"===s)d3.select(this.element).select('[row-index="'.concat(l,'"]')).selectAll(".prefix-cell").each(function(){if(!t.isFillerCell(this)){var i=t.getItemByElement(this);new I(i,this,t.rowLevelWidthResizeHandler,null,t.prefixCellClickHandler,!0)}});else{var f=this.getElementByIndex(l,s,o.aP.Main);if(!this.isFillerCell(f)){var u=this.getItemByElement(f);new I(u,f,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[l][s]="resizable"}},e.prototype.getPrefixCellBinding=function(t,l){var s=l,f=t,u=this.rowLevelWidthMeasureManager.getLevelLeft(s),i=this.columnLevelHeightMeasureManager.getLevelHeight(f),h=this.rowLevelWidthMeasureManager.getLevelWidth(s),P=this.renderMeta.rowNavigator.getCorner(s,f),p=this.renderMeta.binder.getCornerCellBinding(P,!1,!0,this.onObject,h);return p.classNames||(p.classNames=[]),p.attributes||(p.attributes={}),p.styleProperties||(p.styleProperties={}),p.classNames.push("prefix-cell"),p.attributes.role="columnheader",p.attributes["column-index"]=l.toString(),p.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),null==p.attributes.tabindex&&(p.attributes.tabindex="0"),p.styleProperties.position="absolute",p.styleProperties.left=u+"px",p.styleProperties.height=i+"px",p.styleProperties.width=h+"px",p.styleProperties["box-sizing"]="border-box",p.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(p,h),p},e.prototype.getMainCellBinding=function(t,l){var s=t,u=this.columnWidthMeasureManager.getPageColumns()[r.yl.getPageIndex(l,r.MN)],P=this.columnWidthMeasureManager.getPageColumnLeft(u)+_.sum(u.getColumnWidths().slice(0,l%r.MN));this.unfrozenRowHeaders&&(P+=this.rowLevelWidthMeasureManager.getHeadersWidth());var p=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),v=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(p,s,!0);if(!v)return{attributes:{role:"columnheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:P+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var R,T=this.renderMeta.columnNavigator.getHierarchyLeafAt(l+1);T&&(R=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(T,s,!0)),R===v&&(R=void 0);var z=this.getMainCellHeight(t,l),N=this.getMainCellWidth(t,l),J=this.renderMeta.binder.getColumnHeaderBinding(v,!1,!0,this.onObject,R,N),oe=this.renderMeta.columnNavigator.isLeaf(v),pe=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(v),se=this.renderMeta.columnNavigator.getNodeLeafCount(v)-(l-pe),A=!oe&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(v)===l,ae=!oe&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(v)!==l,ge=ae&&1===se;return J.classNames||(J.classNames=[]),J.attributes||(J.attributes={}),J.styleProperties||(J.styleProperties={}),J.classNames.push("main-cell"),A&&J.classNames.push("primary-columnheader"),ae&&J.classNames.push("secondary-columnheader"),ge&&J.classNames.push("last-secondary-columnheader"),J.attributes.role="columnheader",J.attributes["column-index"]=l.toString(),J.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),J.attributes.tabindex="0",J.styleProperties.position="absolute",J.styleProperties.left=P+"px",J.styleProperties.width=N+"px",J.styleProperties.height=z+"px",J.styleProperties["box-sizing"]="border-box",J.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(J,N),J},e.prototype.getAriaRowIndex=function(t){return t+1},e.prototype.getRowHeight=function(t){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getRowTop=function(t){return this.columnLevelHeightMeasureManager.getLevelTop(t)},e.prototype.getPrefixCellWidth=function(t,l){return this.rowLevelWidthMeasureManager.getLevelWidth(l)},e.prototype.getPrefixCellHeight=function(t,l){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getPrefixCellLeft=function(t,l){return this.rowLevelWidthMeasureManager.getLevelLeft(l)},e.prototype.getMainCellWidth=function(t,l){var s=this,f=t,u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),i=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(u,f),h=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(i),P=this.renderMeta.columnNavigator.getNodeLeafCount(i)-(l-h),p=this.columnWidthMeasureManager.getLastMeasuredIndex(),v=Math.min(l+P-1,p);return _.sum(_.range(l,v+1).map(function(b){return s.columnWidthMeasureManager.getColumnWidth(b)}))},e.prototype.getMainCellHeight=function(t,l){var s=this,f=t,u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),i=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(u,f),h=(0,ce.zG)(i,this.renderMeta.columnNavigator);return _.sum(_.range(t,f+h-1+1).map(function(p){return s.columnLevelHeightMeasureManager.getLevelHeight(p)}))},e.prototype.getMainCellLeft=function(t,l){var f=this.columnWidthMeasureManager.getPageColumns()[r.yl.getPageIndex(l,r.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(f)+_.sum(f.getColumnWidths().slice(0,l%r.MN))},e.prototype.getCellItem=function(t,l,s){if(s)return this.renderMeta.rowNavigator.getCorner(l,t);var i=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(i,t)},e.prototype.getColumnHeaderOffset=function(t){return this.renderMeta.viewport.left-this.getColumnLeft(t,!1)},e}(d),y=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,W.ZT)(e,c),e.prototype.scrollToY=function(t){this.element.style.top=-t+"px"},e.prototype.adjustHeaders=function(){if(this.rowHeaderType!==o.xU.Stepped&&!this.repeatRowHeaders){var t=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var l=t.getRowIndex(this),s=t.getColumnIndex(this),f=t.getPrefixCellHeight(l,s),u=l===t.renderMeta.visibleRowRange[0],i=d3.select(this).classed("secondary-rowheader")&&!u;if(d3.select(this).classed("visually-hidden",i),u&&!d3.select(this).classed("last-secondary-rowheader")){var h=t.getRowHeaderOffset(l),P=f-h;d3.select(this).style("transform","translateY(".concat(h,"px)")),d3.select(this).style("height",P+"px")}else i||(d3.select(this).style("transform",null),d3.select(this).style("height",f+"px"))})}},e.prototype.getPrefixCellBinding=function(t,l){var h,s=l,f=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),u=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(f,s,!0),i=this.rowLevelWidthMeasureManager.getLevelLeft(s);if(!u)return{attributes:{role:"rowheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:i+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===o.y2.Table){var P=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),p=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());h=p?this.renderMeta.rowNavigator.getIntersection(P,p):void 0}var b,v=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1);v&&(b=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(v,s,!0)),b===u&&(b=void 0);var T=this.getPrefixCellWidth(t,l),R=this.getPrefixCellHeight(t,l),z=this.renderMeta.rowNavigator.isLeaf(u),N=this.rowHeaderType===o.xU.Stepped,J=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u),oe=this.renderMeta.rowNavigator.getNodeLeafCount(u)-(t-J),pe=!z&&!N&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u)===t,se=!z&&!N&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u)!==t,A=se&&1===oe,ae=this.renderType===o.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():T,ge=ae+"px",ye=this.renderMeta.binder.getRowHeaderBinding(u,!1,this.onObject,!1,h,b,ae,this.repeatRowHeaders?f:void 0,se);if(ye.classNames||(ye.classNames=[]),ye.attributes||(ye.attributes={}),ye.styleProperties||(ye.styleProperties={}),ye.classNames.push("prefix-cell"),pe&&ye.classNames.push("primary-rowheader"),se&&ye.classNames.push("secondary-rowheader"),A&&ye.classNames.push("last-secondary-rowheader"),ye.attributes["column-index"]=l.toString(),ye.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),ye.attributes.tabindex="0",ye.styleProperties.position="absolute",ye.styleProperties.left=i+"px",ye.styleProperties.height=R+"px",ye.styleProperties.width=ge,ye.styleProperties["box-sizing"]="border-box",ye.styleProperties["pointer-events"]=this.renderType===o.y2.Table?"none":"auto",this.renderType===o.y2.Table){var me=u===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),we=this.renderMeta.rowNavigator.isLastItem(u,this.renderMeta.rowNavigator.getHierarchyItems()),Re=this.renderMeta.binder.getBorderInfo(me,we,!0,!0,!0,o.p0.Body);ye.styleProperties["--outline-top"]=Re.weightTop+1+"px",ye.styleProperties["--outline-right"]=Re.weightRight+1+"px",ye.styleProperties["--outline-bottom"]=Re.weightBottom+1+"px",ye.styleProperties["--outline-left"]=Re.weightLeft+1+"px",ye.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(ye,T),ye},e.prototype.getMainCellBinding=function(t,l){var s=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),u=this.renderMeta.rowNavigator.getIntersection(s,f),i=this.getRowHeight(t),h=this.getColumnWidth(l,!1),P=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(P+=this.rowLevelWidthMeasureManager.getHeadersWidth());var p=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1),v=p&&this.renderMeta.rowNavigator.getIntersection(p,f),b=this.renderMeta.binder.getBodyCellBinding(u,!1,i,h,!0,this.onObject,v,this.showTotalPlaceHolders);return b.classNames||(b.classNames=[]),b.attributes||(b.attributes={}),b.styleProperties||(b.styleProperties={}),b.classNames.push("main-cell"),b.attributes.role="gridcell",b.attributes["column-index"]=l.toString(),b.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),b.attributes.tabindex="0",b.styleProperties.position="absolute",b.styleProperties["box-sizing"]="border-box",b.styleProperties.height="100%",b.styleProperties.width=h+"px",b.styleProperties.left=P+"px",b.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(b,h),b},e.prototype.getAriaRowIndex=function(t){return t+1+this.renderMeta.columnNavigator.getHierarchyDepth()},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getPageRows()[r.yl.getPageIndex(t,r.hw)].getRowHeights()[t%r.hw]},e.prototype.getRowTop=function(t){var s=this.rowHeightMeasureManager.getPageRows()[r.yl.getPageIndex(t,r.hw)];return this.rowHeightMeasureManager.getPageRowTop(s)+_.sum(s.getRowHeights().slice(0,t%r.hw))},e.prototype.getPrefixCellWidth=function(t,l){var s=this;if(this.rowHeaderType===o.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var f=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),i=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,f),h=(0,ce.zG)(i,this.renderMeta.rowNavigator);return _.sum(_.range(f,f+h-1+1).map(function(p){return s.rowLevelWidthMeasureManager.getLevelWidth(p)}))},e.prototype.getPrefixCellHeight=function(t,l){var s=this;if(this.renderType===o.y2.Table||this.rowHeaderType===o.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(t);var f=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),i=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,f),h=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(i),P=this.renderMeta.rowNavigator.getNodeLeafCount(i)-(t-h),p=this.rowHeightMeasureManager.getLastMeasuredIndex(),v=Math.min(t+P-1,p);return _.sum(_.range(t,v+1).map(function(b){return s.rowHeightMeasureManager.getRowHeight(b)}))},e.prototype.getPrefixCellLeft=function(t,l){return this.getColumnLeft(l,!0)},e.prototype.getMainCellWidth=function(t,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(t,l){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(t,l,s){if(s){var f=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(t);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,f)}var i=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),h=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(i,h)},e.prototype.getRowHeaderOffset=function(t){return this.renderMeta.viewport.top-this.getRowTop(t)},e}(d),L=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,W.ZT)(e,c),e.prototype.adjustHeaders=function(){for(var s=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),f=0,u=d3.select(this.element).selectAll(".row").nodes().reverse();f<u.length;f++)d3.select(u[f]).attr("aria-rowindex",s--)},e.prototype.getPrefixCellBinding=function(t,l){var s=this.rowHeightMeasureManager.getFloatingRowHeight(t),f=this.rowLevelWidthMeasureManager.getHeadersWidth(),u=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),i=this.renderMeta.binder.getRowHeaderBinding(u,!1,this.onObject,!0,void 0,void 0,f);return i.classNames||(i.classNames=[]),i.attributes||(i.attributes={}),i.styleProperties||(i.styleProperties={}),i.classNames.push("prefix-cell"),i.attributes.role="rowheader",i.attributes["column-index"]=l.toString(),i.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),i.attributes.tabindex="0",i.styleProperties.position="absolute",i.styleProperties.left="0",i.styleProperties.height=s+"px",i.styleProperties.width=f+"px",i.styleProperties["box-sizing"]="border-box",i.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(i,f),i},e.prototype.getMainCellBinding=function(t,l){var s=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),u=this.renderMeta.rowNavigator.getIntersection(s,f),i=this.getRowHeight(t),h=this.getColumnWidth(l,!1),P=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(P+=this.rowLevelWidthMeasureManager.getHeadersWidth());var p=this.renderMeta.binder.getBodyCellBinding(u,!1,i,h,!0,this.onObject,void 0,this.showTotalPlaceHolders);return p.classNames||(p.classNames=[]),p.attributes||(p.attributes={}),p.styleProperties||(p.styleProperties={}),p.classNames.push("main-cell"),p.attributes.role="gridcell",p.attributes["column-index"]=l.toString(),p.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),p.attributes.tabindex="0",p.styleProperties.position="absolute",p.styleProperties["box-sizing"]="border-box",p.styleProperties.height="100%",p.styleProperties.width=h+"px",p.styleProperties.left=P+"px",p.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(p,h),p},e.prototype.getAriaRowIndex=function(t){return-1},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[t]},e.prototype.getRowTop=function(t){var l=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(l)+_.sum(l.getRowHeights().slice(0,t))},e.prototype.getPrefixCellWidth=function(t,l){return this.rowLevelWidthMeasureManager.getHeadersWidth()},e.prototype.getPrefixCellHeight=function(t,l){return this.rowHeightMeasureManager.getFloatingRowHeight(t)},e.prototype.getPrefixCellLeft=function(t,l){return 0},e.prototype.getMainCellWidth=function(t,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(t,l){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(t,l,s){if(s)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t);var f=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(f,u)},e}(d),M=function(c){return c[c.Default=0]="Default",c[c.ColumnResizing=1]="ColumnResizing",c[c.RowLevelResizing=2]="RowLevelResizing",c}({}),Y=function(){function c(e,t,l,s,f,u,i,h,P,p,v,b,T,R,z){var N=this;this.hostServices=h,this.visualStyle=P,this.showTotalPlaceHolders=T,this.subSelectionHelper=R,this.showAsTableNativeMenu=z,this.unfrozenRowHeaders=!1,this.isA11yTable=s,this.isA11yMatrix=f,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=u,this.enableCalculationHighlighting=i,this.sizeManager=t,this.scrollingEnabled=l.scrollingEnabled;var J=h.getLocalizedString(K.iC),oe=h.getLocalizedString(K.Hw),pe=h.getLocalizedString(K.dm),se=h.getLocalizedString(K.Ds),A=b?"interactive-grid":"",ae="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(J,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(oe,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(pe,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(se,"</button>\n                    <div role='grid' class='").concat(A," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");e.insertAdjacentHTML("beforeend",ae),this.element=e.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(k.oy,(0).toString()),this.midViewport.setAttribute(k.oy,(0).toString()),this.botViewport.setAttribute(k.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var ge,be;null===(ge=N.rowScrollbar)||void 0===ge||ge.scrollPageUp();var ye=N.getViewport(),me=r._E.getVisibleRange(ye.top,ye.height,N.rowHeightMeasureManager,r.hw,null===(be=N.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());p(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var ge,be;null===(ge=N.rowScrollbar)||void 0===ge||ge.scrollPageDown();var ye=N.getViewport(),me=r._E.getVisibleRange(ye.top,ye.height,N.rowHeightMeasureManager,r.hw,null===(be=N.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());p(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var ge,be;null===(ge=N.columnScrollbar)||void 0===ge||ge.scrollPageUp();var ye=N.getViewport(),me=r.sW.getVisibleRange(ye.left,ye.width,N.columnWidthMeasureManager,r.MN,null===(be=N.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());v(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var ge,be;null===(ge=N.columnScrollbar)||void 0===ge||ge.scrollPageDown();var ye=N.getViewport(),me=r.sW.getVisibleRange(ye.left,ye.width,N.columnWidthMeasureManager,r.MN,null===(be=N.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());v(me.firstLeafIndex,me.lastLeafIndex)}),this.options=l,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(ge){return N.onClick(ge)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new q(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new E(this,!0)),$(this.element).on(fe.BZ,function(){return N.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(ge){return N.onKeyDown(ge)}),this.keyUpState=M.Default,this.element.addEventListener("keyup",function(){return N.onKeyUp()}),this.focusManager=new B(function(){return N.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),l.scrollingEnabled&&this.attachScrollEventHandlers()}return c.prototype.onShowTotalPlaceHoldersChanged=function(e){e!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=e,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=e),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=e),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=e))},c.prototype.updateOptions=function(e){this.options=e},c.prototype.attachScrollEventHandlers=function(){var e=this;te.l.runOutsideAngular(function(){e.midViewport.style.overflowY="auto",e.midViewport.addEventListener("scroll",function(){return e.scrollTo(null,e.midViewport.scrollTop)}),e.innerContainer.addEventListener("wheel",function(t){var l;performance.now()-e.prevHorizontalWheelTime>100&&(e.propagateWheel=void 0),clearInterval(e.momentumScrollHandle);var s=!t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY);if(!e.propagateWheel&&!s){var f=t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY)?t.deltaY:t.deltaX,u=Math.max(Math.min(f,c.ScrollDeltaMax),-c.ScrollDeltaMax),i=e.scrollBy(u,0);null!==(l=e.propagateWheel)&&void 0!==l||(e.propagateWheel=!i),e.propagateWheel||(t.stopPropagation(),t.preventDefault()),e.prevHorizontalWheelTime=performance.now()}}),e.innerContainer.addEventListener("touchstart",function(t){clearInterval(e.momentumScrollHandle),e.propagateTouch=t.touches.length>1||void 0,e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY}),e.innerContainer.addEventListener("touchmove",function(t){var l,s;if(!e.propagateTouch){var f=e.touchPreviousX-t.touches[0].clientX,u=e.touchPreviousY-t.touches[0].clientY;if(null!==(l=e.propagateTouch)&&void 0!==l||(e.propagateTouch=0===f||Math.abs(f)<=Math.abs(u)||void 0),!e.propagateTouch){e.touchDeltaX=Math.max(Math.min(f,c.ScrollDeltaMax),-c.ScrollDeltaMax),e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY;var i=e.scrollBy(e.touchDeltaX,0);null!==(s=e.propagateTouch)&&void 0!==s||(e.propagateTouch=!i),e.propagateTouch||(t.stopPropagation(),t.preventDefault())}}}),e.innerContainer.addEventListener("touchend",function(){if(!e.propagateTouch){var t=e.renderIteration;e.momentumScrollHandle=setInterval(function(l){l[0]+=1/120;var s=e.touchDeltaX*(1-d3.easeCircleOut(l[0]));t!==e.renderIteration||l[0]>=120||Math.abs(s)<1?clearInterval(e.momentumScrollHandle):e.scrollBy(s,0)},1e3/60,[0])}})})},c.prototype.onFocusManagerEnter=function(){var e;null===(e=this.hostServices.telemetry())||void 0===e||e.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},c.prototype.onKeyUp=function(){switch(this.keyUpState){case M.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=M.Default;break;case M.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=M.Default;break;case M.Default:break;default:ue.fF.assertNever(this.keyUpState)}},c.prototype.onKeyDown=function(e){var t=this;if(this.renderLock||this.keyboardLock)return e.stopPropagation(),void e.preventDefault();this.updateFocus();var l=e.code||e.key,s=e.shiftKey,f=le.M.isCtrlOrMeta(e),u=e.altKey,i=this.isA11yTable,h=this.isA11yMatrix;if("Escape"!==l&&"Esc"!==l&&"Tab"!==l){if("ArrowRight"===l||"Right"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=M.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=M.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&1===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!1)}else t.focusManager.moveFocus("right",f,i,h)});if("ArrowLeft"===l||"Left"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=M.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=M.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&0===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!0)}else t.focusManager.moveFocus("left",f,i,h)});if("ArrowUp"===l||"Up"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s&&!f){if(i){var P=t.focusManager.CurrentFocus;t.focusManager.moveFocus("up",f,i,h);var p=t.focusManager.CurrentFocus;t.selectFocus(e,P),t.selectFocus(e,p)}}else t.focusManager.moveFocus("up",f,i,h)});if("ArrowDown"===l||"Down"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s&&!f){if(i){var P=t.focusManager.CurrentFocus;t.focusManager.moveFocus("down",f,i,h);var p=t.focusManager.CurrentFocus;t.selectFocus(e,P),t.selectFocus(e,p)}}else t.focusManager.moveFocus("down",f,i,h)});if("Home"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("home",f,i,h)});if("End"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("end",f,i,h)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pagedown",f,i,h,t.getNumberOfVisibleRows())});if("PageUp"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pageup",f,i,h,t.getNumberOfVisibleRows())})}if("F10"===l&&s)return f?void 0:(e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.showContextMenuForFocus(e)}));if("Enter"===l||"Space"===l||"Spacebar"===l||" "===l)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.selectFocus(e,t.focusManager.CurrentFocus)});if("KeyO"===l&&f&&u)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.activateCellContent()});if(("KeyC"===l||"c"===l)&&f&&s)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.options.whitespaceClickHandler(null,!0)})}},c.prototype.runIfFrameReady=function(e){return(0,W.mG)(this,void 0,void 0,function(){return(0,W.Jh)(this,function(t){switch(t.label){case 0:return this.keyboardLock=!0,e(),[4,this.requestAnimationFrameAsync()];case 1:return t.sent(),this.keyboardLock=!1,[2]}})})},c.prototype.notifyVisual=function(e){e.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item,e.bodyCell.rowIndex):e.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(e.item):e.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(e.item):e.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(e.item):e.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item):void 0!==e.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(e.item)},c.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e,this.topRenderer.setUnfrozenRowHeaders(e),this.midRenderer.setUnfrozenRowHeaders(e),this.botRenderer.setUnfrozenRowHeaders(e)},c.prototype.setRepeatRowHeaders=function(e){this.topRenderer.setRepeatRowHeaders(e),this.midRenderer.setRepeatRowHeaders(e),this.botRenderer.setRepeatRowHeaders(e)},c.prototype.onFocusChanged=function(){var e,t=this.focusManager.CurrentFocus;ue.fF.assertValue(t,"No current focus"),this.notifyVisual(t);var s,f,u,i,h,P,oe,pe,l=this.getViewport();if(t.bodyCell)t.bodyCell.columnIndex>=0&&(i=t.bodyCell.columnIndex),s=t.bodyCell.rowIndex;else if(t.rowHeader){var p=r._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager),v=(0,ce.hG)(t.item,this.rowNavigator),b=(0,ce.O3)(t.item,this.rowNavigator);v<=p.firstLeafIndex||b-v+1>=p.lastLeafIndex-p.firstLeafIndex+1?(s=v,f=!1):(s=Math.min(b,this.rowHeightMeasureManager.getLastMeasuredIndex()),f=!0)}else if(t.columnHeader){var z=r.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager);v=(0,ce.hG)(t.item,this.columnNavigator),b=(0,ce.O3)(t.item,this.columnNavigator),v<=z.firstLeafIndex||b-v+1>=z.lastLeafIndex-z.firstLeafIndex+1?(i=v,P=!1):(i=Math.min(b,this.columnWidthMeasureManager.getLastMeasuredIndex()),P=!0)}else t.floatingBodyCell&&(i=t.floatingBodyCell.columnIndex);if(void 0!==s&&this.rowScrollbar.visible&&(p=r._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager))&&(s<=p.firstLeafIndex?u={rowIndex:s,visibleHeight:Number.MAX_VALUE,alignBottom:f??!1}:s>=p.lastLeafIndex&&(u={rowIndex:s,visibleHeight:Number.MAX_VALUE,alignBottom:f??!0})),void 0!==i&&this.columnScrollbar.visible&&(z=r.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager))&&(i<=z.firstLeafIndex?h=this.unfrozenRowHeaders&&0===i&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:i,visibleWidth:Number.MAX_VALUE,alignRight:P??!1}:i>=z.lastLeafIndex&&(h={columnIndex:i,visibleWidth:Number.MAX_VALUE,alignRight:P??!0})),u&&(oe=r._E.getOffset(u,this.rowHeightMeasureManager),u.alignBottom&&(oe-=this.rowScrollbar.viewSize)),h&&(pe=r.sW.getOffset(h,this.columnWidthMeasureManager),h.alignRight&&(pe-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(pe+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(t.cornerCell||t.rowHeader||t.floatingRowHeader)){var se=this.getFocusedCell(t),A=se.offsetLeft,ae=se.offsetWidth;pe=A<this.columnScrollbar.viewMin||ae>this.columnScrollbar.viewSize?A:A+ae>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?A-this.columnScrollbar.viewSize:null}this.scrollTo(pe,oe),null===(e=this.getFocusedCell(t))||void 0===e||e.focus({preventScroll:!0})},c.prototype.getFocusedCell=function(e){var t,l;if(e.bodyCell)return-1===e.bodyCell.columnIndex?this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,0,o.aP.Prefix):this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,e.bodyCell.columnIndex,o.aP.Main);if(e.columnHeader){var s=e.item,f=this.columnNavigator.getLevel(s),u=void 0;return u=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(s):null!==(t=this.rowNavigator.getLeafIndex(s))&&void 0!==t?t:this.rowNavigator.getIndexOfFirstLeaf(s),this.topRenderer.getElementByIndex(f,u,o.aP.Main)}if(e.rowHeader){var i=e.item;return f=null!==(l=this.columnNavigator.getLeafIndex(i))&&void 0!==l?l:this.columnNavigator.getIndexOfFirstLeaf(i),u=this.steppedLayout?0:this.rowNavigator.getLevel(i),this.midRenderer.getElementByIndex(f,u,o.aP.Prefix)}return e.cornerCell?this.topRenderer.getElementByIndex(e.cornerCell.columnLevel,e.cornerCell.rowLevel,o.aP.Prefix):e.floatingBodyCell?this.botRenderer.getElementByIndex(e.floatingBodyCell.rowIndex,e.floatingBodyCell.columnIndex,o.aP.Main):null!=e.floatingRowHeader?this.botRenderer.getElementByIndex(e.floatingRowHeader,0,o.aP.Prefix):void ue.fF.assertFail("Unexpected focused item")},c.prototype.getCurrentFocusBoundingRect=function(){var e=document.activeElement;if(e){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:0,left:0,width:0,height:0}},c.prototype.selectFocus=function(e,t){var l=t.item,s=this.createMouseEvent(e);t.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,s,t.bodyCell.rowIndex,o.p0.Body):t.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,s,void 0,o.p0.Footer):t.rowHeader||void 0!==t.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(l,s):t.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(l,s):t.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(l,s):ue.fF.assertFail("Unexpected focused item")},c.prototype.activateCellContent=function(){var t=document.activeElement;if(t&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var l=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(t,l)}},c.prototype.createSimpleMouseClickEvent=function(){var e=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:e.left,clientY:e.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},c.prototype.createMouseEvent=function(e){var t=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:t.left,clientY:t.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey})},c.prototype.showContextMenuForFocus=function(e){var t,l=this.focusManager.CurrentFocus;if(-1!==(null===(t=l.bodyCell)||void 0===t?void 0:t.columnIndex)){ue.fF.assertValue(l&&l.item,"Keyboard Selection triggered with no focused cell");var s=l.item,f=this.getCurrentFocusBoundingRect(),u=new MouseEvent("contextmenu",{clientX:f.left,clientY:f.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey});l.bodyCell||l.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(s,u):l.rowHeader||void 0!==l.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(s,u):l.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(s,u):l.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(s,u):ue.fF.assertFail("Unexpected focused item")}},c.prototype.onClick=function(e){var t=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),l=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(t>=this.width&&l>=this.height)){var s=(0,de.ut)(this.element,e);(s.x>t||s.y>l)&&this.options.whitespaceClickHandler(e)}},c.prototype.initializeScrollbars=function(){var e=this;this.columnScrollbar=new Z.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,w.S)(n.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar=new Z.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,w.S)(n.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},c.prototype.setSteppedLayout=function(e){if(e!==this.steppedLayout){this.steppedLayout=e;var t=e?o.xU.Stepped:o.xU.Blocked;this.columnWidthMeasureManager=new r.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new r.FA(this.measureElement,this.sizeManager):new r.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new r.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new r.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new r.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},c.prototype.createRenderers=function(){var e=this,t=this.isA11yTable?o.y2.Table:o.y2.Matrix;this.topRenderer=new g(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,o.p0.Header,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new y(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,o.p0.Body,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new L(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,o.p0.Footer,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},c.prototype.setWidth=function(e){this.width=e,this.element.style.width=(0,w.S)(this.width),this.columnScrollbar.invalidateArrange()},c.prototype.setHeight=function(e){this.height=e,this.element.style.height=(0,w.S)(this.height),this.rowScrollbar.invalidateArrange()},c.prototype.getWidth=function(){return this.width},c.prototype.getHeight=function(){return this.height},c.prototype.setClassName=function(e){this.element.className=e},c.prototype.setColumnNavigator=function(e){this.columnNavigator=e,this.focusManager.columnNavigator=e},c.prototype.setRowNavigator=function(e){this.rowNavigator=e,this.focusManager.rowNavigator=e},c.prototype.setBinder=function(e){this.binder=e},c.prototype.getSteppedLayout=function(){return this.steppedLayout},c.prototype.getColumnNavigator=function(){return this.columnNavigator},c.prototype.getRowNavigator=function(){return this.rowNavigator},c.prototype.getSizeManager=function(){return this.sizeManager},c.prototype.getBinder=function(){return this.binder},c.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},c.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},c.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},c.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},c.prototype.getTopRenderer=function(){return this.topRenderer},c.prototype.getMidRenderer=function(){return this.midRenderer},c.prototype.getBotRenderer=function(){return this.botRenderer},c.prototype.getViewport=function(){var e=this.columnScrollbar.viewMin,t=this.rowScrollbar.viewMin,l=this.columnScrollbar.viewSize,s=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(e=Math.max(e-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),l-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:e,top:t,width:l=Math.max(l,0),height:s=Math.max(s,0)}},c.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?n.zf:0)},c.prototype.storeFocus=function(){var t,l,s,f,e=document.activeElement;if(this.topViewport.contains(e))this.topRenderer.isPrefixCell(e)?(t=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),s=o.p0.Header,f=o.aP.Prefix):(t=this.topRenderer.getRowIndex(e),l=this.topRenderer.getColumnIndex(e),s=o.p0.Header,f=o.aP.Main);else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?(t=this.midRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),s=o.p0.Body,f=o.aP.Prefix):(t=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),s=o.p0.Body,f=o.aP.Main);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?(t=this.botRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),s=o.p0.Footer,f=o.aP.Prefix):(t=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),s=o.p0.Footer,f=o.aP.Main);else if(this.isA11yTable){var i=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(i),l=this.topRenderer.getColumnIndex(i),s=o.p0.Header,f=o.aP.Main}else{var h=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(h),l=this.topRenderer.getColumnIndex(h),s=o.p0.Header,f=o.aP.Prefix}this.tempFocus={rowIndex:t,columnIndex:l,section:s,region:f}},c.prototype.restoreFocus=function(){var t,e=this;ue.fF.assert(function(){return!!e.tempFocus},"tempFocus must be defined"),this.tempFocus.section===o.p0.Header?t=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===o.p0.Body?t=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,o.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===o.p0.Footer&&(t=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),t||(this.updateFocus(),t=this.getFocusedCell(this.focusManager.CurrentFocus)),t.focus({preventScroll:!0})},c.prototype.updateFocus=function(){var t,l,s,f,e=document.activeElement;if(this.topViewport.contains(e))if(this.topRenderer.isPrefixCell(e))t=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),s=this.isA11yTable?o.p0.Header:o.p0.MatrixCorner;else{var i=this.topRenderer.getItemByElement(e);s=o.p0.Header,f=this.columnNavigator.getPathIndices(i)}else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.midRenderer.getRowIndex(e),l=-1,s=o.p0.Body):(i=this.midRenderer.getItemByElement(e),s=o.p0.MatrixRowHeader,f=this.rowNavigator.getPathIndices(i)):(t=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),s=o.p0.Body);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.botRenderer.getRowIndex(e),l=-1,s=o.p0.Footer):(t=this.botRenderer.getRowIndex(e),s=o.p0.FooterHeader):(t=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),s=o.p0.Footer);else if(this.isA11yTable){var h=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(h),l=this.topRenderer.getColumnIndex(h),s=o.p0.Header}else{var P=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(P),l=this.topRenderer.getColumnIndex(P),s=o.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(t,l,s,f)},c.prototype.scrollBy=function(e,t){if(this.renderLock)return!1;var l,s;if(e){var f=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(e,!0),this.columnScrollbar.refresh(),l=f!==this.columnScrollbar.viewMin}if(t){var i=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(t,!0),this.rowScrollbar.refresh(),s=i!==this.rowScrollbar.viewMin}return!(!l&&!s||(this.refresh(),0))},c.prototype.scrollTo=function(e,t){this.renderLock||(null!=e&&(this.columnScrollbar.scrollTo(e,!0),this.columnScrollbar.refresh()),null!=t&&(this.rowScrollbar.scrollTo(t,!0),this.rowScrollbar.refresh()),this.refresh())},c.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var e=this.getViewport(),t=this.columnScrollbar.viewMin,l=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(t),this.midRenderer.scrollToX(t),this.botRenderer.scrollToX(t),this.midViewport.scrollTop=l,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator)}},c.prototype.renderAsync=function(e,t,l){return(0,W.mG)(this,void 0,void 0,function(){var s,f,u,i,h;return(0,W.Jh)(this,function(P){switch(P.label){case 0:return s=++this.renderIteration,e===o.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(t,l,s)];case 1:return h=P.sent(),f=h[0],u=h[1],s!==this.renderIteration||(this.unlockRendering(),(i=this.element.contains(document.activeElement))&&this.storeFocus(),(e===o.BM.ClearRendering||e===o.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(f,u),e===o.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),i&&(e===o.BM.ClearRendering||e===o.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},c.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},c.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},c.prototype.measureAsync=function(e,t,l){return(0,W.mG)(this,void 0,void 0,function(){var s,f,u,i,h,P,p;return(0,W.Jh)(this,function(v){switch(v.label){case 0:if(h=this.getViewport(),e?i=e.rowIndex:(P=r._E.getVisibleRange(h.top,h.height,this.rowHeightMeasureManager),i=P?P.firstLeafIndex:0),t?u=t.columnIndex:(p=r.sW.getVisibleRange(h.left,h.width,this.columnWidthMeasureManager),u=p?p.firstLeafIndex:0),u=Math.max(0,Math.floor(u-r.EO/2)),!t)return[3,4];v.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&t.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,i),[4,this.setTimeoutAsync()]):[3,3];case 2:return v.sent(),l!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return s=r.sW.getOffset(t,this.columnWidthMeasureManager),t.alignRight&&(s-=this.columnScrollbar.viewSize),[3,5];case 4:s=this.columnScrollbar.viewMin,v.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-s<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,i),[4,this.setTimeoutAsync()]):[3,7];case 6:return v.sent(),l!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,i,r.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,i,u,r.EO),!e)return[3,11];v.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&e.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,i,u),[4,this.setTimeoutAsync()]):[3,10];case 9:return v.sent(),l!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return f=r._E.getOffset(e,this.rowHeightMeasureManager),e.alignBottom&&(f-=this.rowScrollbar.viewSize),[3,12];case 11:f=this.rowScrollbar.viewMin,v.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-f<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,i,u),[4,this.setTimeoutAsync()]):[3,14];case 13:return v.sent(),l!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,i,u,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,i,u,r.EO),this.measurePageColumnsAsync(i,l),this.measurePageRowsAsync(i,u,l),[2,[s,f]]}})})},c.prototype.updateAria=function(){var e=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",e),d3.select(this.innerContainer).attr("aria-colcount",t)},c.prototype.setTimeoutAsync=function(e){return void 0===e&&(e=0),(0,W.mG)(this,void 0,void 0,function(){return(0,W.Jh)(this,function(t){return[2,new ie.J(function(l){return te.l.setTimeout(function(){return l()},e)})]})})},c.prototype.requestAnimationFrameAsync=function(){return(0,W.mG)(this,void 0,void 0,function(){return(0,W.Jh)(this,function(e){return[2,new ie.J(function(t){return te.l.requestAnimationFrame(function(){return t()})})]})})},c.prototype.getVisibleRowStart=function(){var e=this.getViewport(),t=r._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);return t?r._E.getVisibleRowStart(t,e.top,this.rowHeightMeasureManager):null},c.prototype.getVisibleColumnStart=function(){var e=this.getViewport(),t=r.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager);return t?r.sW.getVisibleColumnStart(t,e.left,this.columnWidthMeasureManager):null},c.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},c.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},c.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},c.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,w.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var e=(0,w.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=e},c.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var e=this.rowHeightMeasureManager.getFloatingRowHeights(),t=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-e,l=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),s=this.rowHeightMeasureManager.getRowsHeight(),f=this.columnWidthMeasureManager.getColumnsWidth(),u=this.options.scrollingEnabled&&s>0&&s>t,i=this.options.scrollingEnabled&&f>0&&f>l;!u&&i&&s>0&&(u=s>t-n.zf),!i&&u&&f>0&&(i=f>l-n.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=u?this.rowScrollbar.width:(0,w.S)(0);var P,p,h=i?n.zf:0;s>t-h?(P=h+e,p=h):(P=t+e-s,p=t-s),this.midViewport.style.bottom=(0,w.S)(P),this.botViewport.style.bottom=(0,w.S)(p),this.rowScrollbar.show(u),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=i?n.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(i),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=u?n.zf+"px":"0",this.columnScrollbar.refresh()},c.prototype.getBodyCellWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-e,t)},c.prototype.measurePageColumnsAsync=function(e,t){return(0,W.mG)(this,void 0,void 0,function(){return(0,W.Jh)(this,function(l){switch(l.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(l.sent(),t!==this.renderIteration)return[2];l.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return l.sent(),t!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},c.prototype.measurePageRowsAsync=function(e,t,l){return(0,W.mG)(this,void 0,void 0,function(){return(0,W.Jh)(this,function(s){switch(s.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(s.sent(),l!==this.renderIteration)return[2];s.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e,t),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return s.sent(),l!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},c.prototype.updateScrollRegionWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth(),l=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?t+e:t,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?l:l-e,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},c.prototype.updateScrollRegionHeight=function(){var e=this.rowHeightMeasureManager.getRowsHeight(),t=this.midViewport.clientHeight,l=(0,w.S)(Math.max(e,t));this.innerBodyCellContainer.style.height=l,this.rowScrollbar.max=e,this.rowScrollbar.viewSize=t,this.rowScrollbar.refresh()},c.prototype.getNumberOfVisibleRows=function(){var e=this.getViewport(),t=r._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);if(t)return Math.max(0===t.firstLeafIndex?t.lastLeafIndex-t.firstLeafIndex:t.lastLeafIndex-t.firstLeafIndex-1,1)},c.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},c.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},c.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},c.prototype.destroy=function(){this.renderIteration=NaN},c.ScrollDeltaMax=200,c}()},44102:function(Ve,Fe,X){X.d(Fe,{AT:function(){return r},Xg:function(){return ce},fw:function(){return Z}});var W=X(81337),fe=X(66232),ue=X(62458),le=X(87914),ie=X(93340),te="unselectable";function Z(w,n){if(w)for(var o=0,H=w;o<H.length;o++)(0,H[o])(n)}var de=function(){function w(n,o){this._owner=n,this._direction=o,this._timerHandle=void 0,this.createView();var H=this;this._element.addEventListener("mousedown",function(B){H.onMouseDown(B)}),$(this._element).addClass(te),$(this._svg).addClass(te),$(this._polygon).addClass(te)}return Object.defineProperty(w.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),w.prototype.createView=function(){var n="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(n,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",w.ARROW_COLOR),this._svg=document.createElementNS(n,"svg");var o=this._svg.style;o.position="absolute",o.left="0px",o.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=K.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},w.prototype.onMouseDown=function(n){var o=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){n.cancelBubble=!0;var H=this;this._mouseUpWrapper=function(B){H.onMouseUp(B)},K.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){o.onMouseDown(n)},100),n.preventDefault&&n.preventDefault()},w.prototype.onMouseUp=function(n){clearTimeout(this._timerHandle),K.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},w.prototype.arrange=function(n,o,H){var B=Math.min(n,o);this._polygon.setAttributeNS(null,"transform","translate("+(n-B)/2+", "+(o-B)/2+") scale("+B/16+") rotate("+H+",8,8)"),this._svg.setAttributeNS(null,"width",n+"px"),this._svg.setAttributeNS(null,"height",o+"px"),(0,ie.Py)(this._element,n),(0,ie.Iw)(this._element,o)},w.MIN_WIDTH=26,w.ARROW_COLOR="#404040",w}(),K=function(){function w(n,o,H,B){this.isModern=H,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(n,o);var k=this;this._element.addEventListener("mousedown",function(I){k.onBackgroundMouseDown(I)}),this._element.addEventListener("pointerdown",function(I){(0,fe.n)(I)}),this._element.addEventListener("dblclick",function(I){(0,fe.n)(I)}),this._middleBar.addEventListener("mousedown",function(I){k.onMiddleBarMouseDown(I)}),this._middleBar.addEventListener("pointerdown",function(I){(0,fe.n)(I)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(te),this.onScrollBehavior=B}return w.prototype.scrollBy=function(n,o){this.scrollTo(this.viewMin+n,o)},w.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},w.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},w.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},w.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(w.prototype,"width",{get:function(){return this._width},set:function(o){this._width=o,this._element.style.width=o,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"height",{get:function(){return this._height},set:function(o){this._height=o,this._element.style.height=o,this.invalidateArrange()},enumerable:!1,configurable:!0}),w.prototype.refresh=function(){ue.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(w.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),w.prototype._scrollSmallIncrement=function(n){this.scrollBy(this.smallIncrement*n)},Object.defineProperty(w.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),w.prototype.show=function(n){this._visible=n,this.element.style.visibility=n?"visible":"hidden",this.invalidateArrange()},w.prototype._getMouseOffset=function(n){return void 0!==n.offsetX?{x:n.offsetX,y:n.offsetY}:void 0!==n.layerX?{x:n.layerX,y:n.layerY}:{x:n.screenX,y:n.screenY}},w.prototype._getOffsetXDelta=function(n){return(n.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},w.prototype._getOffsetYDelta=function(n){return(n.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},w.prototype._getOffsetXTouchDelta=function(n){return this._getMouseOffset(n).x-this._offsetTouchPrevPos.x},w.prototype._getOffsetYTouchDelta=function(n){return this._getMouseOffset(n).y-this._offsetTouchPrevPos.y},w.prototype.onTouchStart=function(n){1===n.touches.length&&this.onTouchMouseDown(n.touches[0])},w.prototype.onTouchMove=function(n){1===n.touches.length&&(n.preventDefault&&n.preventDefault(),this.onTouchMouseMove(n.touches[0]))},w.prototype.onTouchEnd=function(n){this.onTouchMouseUp(1===n.touches.length?n.touches[0]:n,!0)},w.prototype.onTouchMouseDown=function(n){!this._allowMouseDrag&&n.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},w.prototype._getOffsetTouchDelta=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},w.prototype.onTouchMouseMove=function(n){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(n));var o=this._getOffsetTouchDelta(n);0!==o&&(this.scrollBy(-o/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(n)),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0}},w.prototype.onTouchMouseUp=function(n,o){if(this._touchStarted&&this._offsetTouchStartPos){var H=this._getMouseOffset(n);!o&&(Math.abs(this._offsetTouchStartPos.x-H.x)>3||Math.abs(this._offsetTouchStartPos.y-H.y)>3)&&(n.preventDefault&&n.preventDefault(),n.cancelBubble=!0)}this._touchStarted=!1},w.prototype.createView=function(n,o){this._element=document.createElement("div"),this._element.className=w.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(le.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===o&&n.appendChild(this._element),this.isModern||(this._minButton=new de(this,-1),this._maxButton=new de(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=w.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(le.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},w.prototype.scrollTo=function(n,o){var H=Math.min(this.max-this.viewSize,Math.max(this.min,n));(H=Math.max(this.min,H))!==this.viewMin&&(this.viewMin=H,o||Z(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},w.prototype._scrollByPage=function(n){ue.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},w.prototype._getRunningSize=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},w.prototype._getOffsetDelta=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},w.prototype.scroll=function(n){var o=this._getOffsetDelta(n)/this._getRunningSize(!0)*(this.max-this.min);if(o<0){if(this._getScreenMousePos(n)>=this._screenMaxMousePos)return}else if(o>0&&this._getScreenMousePos(n)<=this._screenMinMousePos)return;this.scrollBy(o)},Object.defineProperty(w.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),w.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},w.prototype._calculateButtonWidth=function(){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},w.prototype._calculateButtonHeight=function(){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},w.prototype._getMinButtonAngle=function(){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},w.prototype._getMaxButtonAngle=function(){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},w.prototype._setMaxButtonPosition=function(){ue.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},w.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},w.prototype.onHoldBackgroundMouseDown=function(n){var o=this;this._timerHandle=setTimeout(function(){o.onBackgroundMouseDown(n)},this._timerHandle?w.ScrollbarBackgroundMousedownHoldDelay:w.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},w.prototype.onBackgroundMouseDown=function(n){var o=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(n.cancelBubble=!0,this._backgroundMouseUpWrapper=function(H){o.onBackgroundMouseUp(H)},w.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(n),this.refresh(),this.onHoldBackgroundMouseDown(n),n.preventDefault&&n.preventDefault()},w.prototype.onBackgroundMouseUp=function(n){clearTimeout(this._timerHandle),this._timerHandle=void 0,w.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},w.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},w.prototype.onMiddleBarMouseDown=function(n){n.cancelBubble=!0,this._screenPrevMousePos={x:n.screenX,y:n.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(n)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(n)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(n)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(n)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,ie.df)(this.element)*this.getPinchZoomY();var o=this;this._middleBarMouseMoveWrapper=function(H){o.onMiddleBarMouseMove(H)},w.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(H){o.onMiddleBarMouseUp(H)},w.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),n.preventDefault&&n.preventDefault()},w.prototype.onMiddleBarMouseMove=function(n){this._screenPrevMousePos&&(this.scroll(n),this.refresh(),this._screenPrevMousePos={x:n.screenX,y:n.screenY})},w.prototype.onMiddleBarMouseUp=function(n){this._screenPrevMousePos=void 0,w.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,w.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,n.preventDefault&&n.preventDefault()},w.prototype._getScreenContextualLeft=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},w.prototype._getScreenContextualRight=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},w.prototype.onMouseWheel=function(n){n&&this.mouseWheel(n)},w.prototype.mouseWheel=function(n){this.visible&&(n<0?n=Math.min(-w.MouseWheelRange,n):n>0&&(n=Math.max(w.MouseWheelRange,n)),this.scrollBy(-n/w.MouseWheelRange*this.smallIncrement))},w.prototype._getScreenMousePos=function(n){return ue.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},w.addDocumentMouseUpEvent=function(n){document.addEventListener("mouseup",n)},w.removeDocumentMouseUpEvent=function(n){document.removeEventListener("mouseup",n)},w.addDocumentMouseMoveEvent=function(n){document.addEventListener("mousemove",n)},w.removeDocumentMouseMoveEvent=function(n){document.removeEventListener("mousemove",n)},w.DefaultScrollbarWidth="15px",w.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,w.ScrollbarBackgroundMousedownHoldDelay=50,w.MouseWheelRange=120,w.className="scroll-bar-div",w.barClassName="scroll-bar-part-bar",w.arrowClassName="scroll-bar-part-arrow",w}(),ce=function(w){function n(o,H,B,k){var I=w.call(this,o,H,B,k)||this;return I.height=K.DefaultScrollbarWidth,I}return(0,W.ZT)(n,w),n.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,de.MIN_WIDTH))},n.prototype._calculateButtonHeight=function(){return this.actualHeight},n.prototype._getMinButtonAngle=function(){return-180},n.prototype._getMaxButtonAngle=function(){return 0},n.prototype._setMaxButtonPosition=function(){(0,ie.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},n.prototype.refresh=function(){this.arrange();var o=this.actualWidth-2*this.actualButtonWidth-2,H=this.viewSize/(this.max-this.min)*o;H<this.MIN_BAR_SIZE&&(o-=this.MIN_BAR_SIZE-H,H=this.MIN_BAR_SIZE),o<0&&(o=0,H=0),H=Math.min(H,o);var B=this.viewMin/(this.max-this.min)*o;(0,ie.Py)(this.middleBar,H),(0,ie.Iw)(this.middleBar,this.actualHeight);var k=this.actualButtonWidth+1+B;this.isModern?this.middleBar.style.transform="translateX(".concat(k,"px)"):(0,ie.hn)(this.middleBar,k)},n.prototype.show=function(o){o!==this.visible&&(w.prototype.show.call(this,o),o?this.element.style.height=this.height:(0,ie.Iw)(this.element,0))},n.prototype._scrollByPage=function(o){var H;if(this.isModern){var B=window.getComputedStyle(this.middleBar);H=new WebKitCSSMatrix(B.transform).m41}else H=this.middleBar.offsetLeft;var q=void 0===o.offsetX?o.layerX:o.offsetX;q>H+this.middleBar.offsetWidth?this.scrollPageDown():q<H&&this.scrollPageUp()},n.prototype._getRunningSize=function(o){var H=this.actualWidth;if(o){var k=(H-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));k<this.MIN_BAR_SIZE&&(H-=this.MIN_BAR_SIZE-k)}return H},n.prototype._getOffsetDelta=function(o){return this._getOffsetXDelta(o)},n.prototype._getOffsetTouchDelta=function(o){return this._getOffsetXTouchDelta(o)},n.prototype._getScreenContextualLeft=function(o){return o.getBoundingClientRect().left},n.prototype._getScreenContextualRight=function(o){return o.getBoundingClientRect().right},n.prototype._getScreenMousePos=function(o){return o.screenX},n}(K),r=function(w){function n(o,H,B,k){var I=w.call(this,o,H,B,k)||this;return I.width=K.DefaultScrollbarWidth,I}return(0,W.ZT)(n,w),n.prototype._calculateButtonWidth=function(){return this.actualWidth},n.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,de.MIN_WIDTH))},n.prototype._getMinButtonAngle=function(){return-90},n.prototype._getMaxButtonAngle=function(){return 90},n.prototype._setMaxButtonPosition=function(){(0,ie.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},n.prototype.refresh=function(){this.arrange();var o=this.actualHeight-2*this.actualButtonHeight-2,H=this.viewSize/(this.max-this.min)*o;H<this.MIN_BAR_SIZE&&(o-=this.MIN_BAR_SIZE-H,H=this.MIN_BAR_SIZE),o<0&&(o=0,H=0);var B=this.viewMin/(this.max-this.min)*o;(0,ie.Py)(this.middleBar,this.actualWidth),(0,ie.Iw)(this.middleBar,H);var k=this.actualButtonHeight+1+B;this.isModern?this.middleBar.style.transform="translateY(".concat(k,"px)"):(0,ie.FX)(this.middleBar,k)},n.prototype.show=function(o){o!==this.visible&&(w.prototype.show.call(this,o),o?this.element.style.width=this.width:(0,ie.Py)(this.element,0))},n.prototype._scrollByPage=function(o){var H;if(this.isModern){var B=window.getComputedStyle(this.middleBar);H=new WebKitCSSMatrix(B.transform).m42}else H=this.middleBar.offsetTop;var q=void 0===o.offsetY?o.layerY:o.offsetY;q>H+this.middleBar.offsetHeight?this.scrollPageDown():q<H&&this.scrollPageUp()},n.prototype._getRunningSize=function(o){var H=this.actualHeight;if(o){var k=(H-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));k<this.MIN_BAR_SIZE&&(H-=this.MIN_BAR_SIZE-k)}return H},n.prototype._getOffsetDelta=function(o){return this._getOffsetYDelta(o)},n.prototype._getOffsetTouchDelta=function(o){return this._getOffsetYTouchDelta(o)},n.prototype._getScreenContextualLeft=function(o){return o.getBoundingClientRect().top},n.prototype._getScreenContextualRight=function(o){return o.getBoundingClientRect().bottom},n.prototype._getScreenMousePos=function(o){return o.screenY},n}(K)},73889:function(Ve,Fe,X){X.d(Fe,{Y:function(){return W}});var W=function(fe){return fe[fe.Matrix=0]="Matrix",fe[fe.Table=1]="Table",fe[fe.PivotTable=2]="PivotTable",fe[fe.TableEx=3]="TableEx",fe}({})},71090:function(Ve,Fe,X){X.d(Fe,{Ds:function(){return o},Ed:function(){return d},Eo:function(){return g},F2:function(){return T},Hw:function(){return w},JM:function(){return M},LU:function(){return S},Mh:function(){return Z},NA:function(){return m},OM:function(){return l},P$:function(){return P},Pr:function(){return k},QM:function(){return t},R9:function(){return E},Sl:function(){return ce},TV:function(){return K},Vz:function(){return z},WA:function(){return I},YR:function(){return i},Yo:function(){return pe},Zk:function(){return R},b:function(){return de},bn:function(){return le},dG:function(){return b},dm:function(){return n},en:function(){return B},f:function(){return q},fG:function(){return p},iC:function(){return r},jv:function(){return s},lN:function(){return J},mQ:function(){return ne},qT:function(){return ue},rJ:function(){return h},rx:function(){return u},rz:function(){return H},s$:function(){return L},s0:function(){return re},sR:function(){return fe},uX:function(){return te},uZ:function(){return oe},wH:function(){return f},wd:function(){return v},yF:function(){return ie},ye:function(){return N},z7:function(){return e},zq:function(){return Y}});var W=X(38265),fe=.8,ue="TableTotalLabel",le="Format_AddTotalLabel",ie="Visual_LabelText_Value",te="Row_Selection",Z="SelectRow",de="Row_Selected",K="Row_Unselected",ce="Additional_Conditional_Formatting",r="DecompositionTree_ScrollLevelUp_Tooltip",w="DecompositionTree_ScrollLevelDown_Tooltip",n="Scroll_Left",o="Scroll_Right",H="tablixDiv",B="tablixCellContentElement",k="tablixCellContentHost",I="tablixWrappingContainer",q="tablixHeader",ne="tablixColumnHeaderLeaf",re="tablixValueNumeric",E="tablixValueTotal",m="powervisuals-glyph tablixUrlIconGlyph",S="tablixValueUrlIcon",d="tablixImageContainer",g="matrixRowHeaderLeaf",L="tableFooterCell",M="tableBodyCell",Y="tableBodyCellBottom",e="tablixAlignLeft",t="tablixAlignCenter",l="tablixAlignRight",s="&nbsp;",f="px",u="tablixSortIconContainer",i=10,h=5,P=5,p=5,v=1,b=W.Wn.regular.css,T=W.Wn.regular.css,R=W.Wn.bold.css,z=W.Wn.glyphs.css,N="#333",J="#666",oe=Number.POSITIVE_INFINITY,pe=.71},42737:function(Ve,Fe,X){X.d(Fe,{A:function(){return fe}});var W=X(62458),fe=function(){function ue(le,ie){this._element=le,this._handler=ie,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return ue.addDocumentMouseUpEvent=function(le){document.addEventListener("mouseup",le)},ue.removeDocumentMouseUpEvent=function(le){document.removeEventListener("mouseup",le)},ue.addDocumentMouseMoveEvent=function(le){document.addEventListener("mousemove",le)},ue.removeDocumentMouseMoveEvent=function(le){document.removeEventListener("mousemove",le)},ue.getMouseCoordinates=function(le){return{x:le.pageX,y:le.pageY}},ue.getMouseCoordinateDelta=function(le,ie){return{x:ie.x-le.x,y:ie.y-le.y}},ue.prototype.initialize=function(){var le=this;this._elementMouseDownWrapper=function(ie){return le.onElementMouseDown(ie)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(ie){return le.onElementMouseMove(ie)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(ie){return le.onElementMouseOut(ie)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(ie){return le.onElementMouseDoubleClick(ie)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},ue.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(ue.prototype,"cell",{get:function(){return W.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),ue.prototype._hotSpot=function(le){return W.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},ue.prototype.onElementMouseDown=function(le){var ie=this,te=ue.getMouseCoordinates(le);this._hotSpot(te)&&(le.cancelBubble=!0,this._startMousePosition=te,this._documentMouseMoveWrapper=function(Z){return ie.onDocumentMouseMove(Z)},ue.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(Z){return ie.onDocumentMouseUp(Z)},ue.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=ue.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},ue.prototype.onElementMouseMove=function(le){this._startMousePosition||(this._hotSpot(ue.getMouseCoordinates(le))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=ue.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},ue.prototype.onElementMouseOut=function(le){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},ue.prototype.onElementMouseDoubleClick=function(le){this._hotSpot(ue.getMouseCoordinates(le))&&this._handler.onReset(this.cell)},ue.prototype.onDocumentMouseMove=function(le){if(this._startMousePosition){var ie=ue.getMouseCoordinateDelta(this._startMousePosition,ue.getMouseCoordinates(le));this._handler.onResize(this.cell,ie.x,ie.y),le.preventDefault()}},ue.prototype.onDocumentMouseUp=function(le){this._startMousePosition=null,ue.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,ue.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),le.preventDefault&&le.preventDefault(),this._handler.onEndResize(this.cell)},ue.resizeHandleSize=4,ue.resizeCursor="e-resize",ue}()},93340:function(Ve,Fe,X){X.d(Fe,{AB:function(){return s},Av:function(){return N},Ch:function(){return u},D4:function(){return w},D6:function(){return oe},DM:function(){return l},FX:function(){return n},G9:function(){return e},Hd:function(){return we},Hx:function(){return P},Iw:function(){return H},MN:function(){return v},Or:function(){return R},Pb:function(){return E},Py:function(){return B},R5:function(){return c},RP:function(){return b},Uy:function(){return I},W_:function(){return L},Y1:function(){return z},Y4:function(){return A},aP:function(){return t},df:function(){return ne},ey:function(){return Y},hn:function(){return o},jG:function(){return y},jT:function(){return Re},mx:function(){return k},om:function(){return m},pW:function(){return ae},qZ:function(){return S},ri:function(){return g},ut:function(){return re},v4:function(){return f},vU:function(){return h},wC:function(){return M},wX:function(){return T},x7:function(){return J},xl:function(){return i}});var W=X(54522),fe=X(91358),ue=X(44977),le=X(38308),ie=X(62458),te=X(6444),Z=X(64329),de=X(48066),K=X(28326),ce=X(42737),r=X(71090);function w(C){if(C)for(;C.hasChildNodes();)C.removeChild(C.firstChild)}function n(C,F){C.style.top=F+"px"}function o(C,F){C.style.left=F+"px"}function H(C,F){C.style.height=q(F)?"":F+"px"}function B(C,F){C.style.width=q(F)?"":F+"px"}function k(C){return C.offsetWidth}function I(C){return C.offsetHeight}function q(C){return-1===C}function ne(C){var F=C.offsetWidth;return 0===F?1:C.getBoundingClientRect().width/F}function re(C,F){var O=C.getBoundingClientRect(),U=ne(C);return{x:(F.pageX-O.left)/U,y:(F.pageY-O.top)/U}}var E=function(C){return C[C.Outline=0]="Outline",C[C.Gridline=1]="Gridline",C}({}),m=function(){function C(F,O){this.applyParams(!0,F,O)}return C.prototype.applyParams=function(F,O,U,Q){F?(this.weight=O??0,this.color=U??"black",this.type=Q??E.Gridline):(this.weight=0,this.color="black",this.type=E.Gridline)},C.prototype.getCSS=function(){var F=[];return _.isNumber(this.weight)&&(F.push(this.weight+r.wH),this.color&&F.push(this.color),F.push("solid")),F.join(" ")},C.prototype.getPriority=function(F){return this===F.top||this===F.bottom?this.type===E.Outline?2:0:this===F.right||this===F.left?this.type===E.Outline?3:1:-1},C.prototype.getShadowCss=function(F,O){var Q=this.weight?this.weight+5:0,ve="inset ";if(this===F.left)ve+=Q+r.wH+" 0";else if(this===F.right)ve+="-"+Math.min(Q,O+5)+r.wH+" 0";else if(this===F.top)ve+="0 "+Q+r.wH;else{if(this!==F.bottom)return"";ve+="0 -"+Q+r.wH}return ve+" 0 -".concat(5,"px ")+this.color},C}(),S=function(){function C(F,O){void 0===F&&(F=r.YR),void 0===O&&(O=r.rJ),this.borders={},this.paddings={top:0,left:F,bottom:0,right:O},this.fontColor="",this.fontFamily="",this.backColor=""}return C.prototype.applyStyle=function(F){var U=F.extension.contentHost.style;U.fontFamily=this.fontFamily,U.fontSize=this.fontSize?Z.FP.toString(this.fontSize.px):void 0,U.fontWeight=this.fontWeight,U.fontStyle=this.fontStyle,U.textDecoration=this.textDecoration,U.color=this.fontColor,U.backgroundColor=this.backColor,U.boxShadow=this.getBoxShadow(),U.border="none",U.paddingTop=this.getPaddingTop(),U.paddingRight=this.getPaddingRight(),U.paddingBottom=this.getPaddingBottom(),U.paddingLeft=this.getPaddingLeft(),U.maxWidth=this.maxWidth},C.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+r.wH},C.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+r.wH},C.prototype.getPaddingRight=function(){return(this.paddings.right??r.rJ)+(null==this.borders.right?0:this.borders.right.weight)+r.wH},C.prototype.getPaddingLeft=function(){return(this.paddings.left??r.YR)+(null==this.borders.left?0:this.borders.left.weight)+r.wH},C.prototype.getBoxShadow=function(F){var O,U,Q,he,ve,Se,xe,Ce,Pe=[];return(null===(O=this.borders.left)||void 0===O?void 0:O.type)===E.Outline&&0!==this.borders.left.weight&&Pe.push(this.borders.left.getShadowCss(this.borders)),(null===(U=this.borders.right)||void 0===U?void 0:U.type)===E.Outline&&0!==this.borders.right.weight&&0!==F&&Pe.push(this.borders.right.getShadowCss(this.borders,F)),(null===(Q=this.borders.bottom)||void 0===Q?void 0:Q.type)===E.Outline&&0!==this.borders.bottom.weight&&Pe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(he=this.borders.top)||void 0===he?void 0:he.type)===E.Outline&&0!==this.borders.top.weight&&Pe.push(this.borders.top.getShadowCss(this.borders)),(null===(ve=this.borders.left)||void 0===ve?void 0:ve.type)===E.Gridline&&0!==this.borders.left.weight&&Pe.push(this.borders.left.getShadowCss(this.borders)),(null===(Se=this.borders.right)||void 0===Se?void 0:Se.type)===E.Gridline&&0!==this.borders.right.weight&&0!==F&&Pe.push(this.borders.right.getShadowCss(this.borders,F)),(null===(xe=this.borders.bottom)||void 0===xe?void 0:xe.type)===E.Gridline&&0!==this.borders.bottom.weight&&Pe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(Ce=this.borders.top)||void 0===Ce?void 0:Ce.type)===E.Gridline&&0!==this.borders.top.weight&&Pe.push(this.borders.top.getShadowCss(this.borders)),Pe.join(", ")},C.prototype.setAttributes=function(F,O,U,Q,he){if(F["padding-top"]=this.getPaddingTop(),F["padding-right"]=this.getPaddingRight(),F["padding-bottom"]=this.getPaddingBottom(),F["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(F["font-family"]=this.fontFamily),null!=this.fontSize&&(F["font-size"]=Z.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(F["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(F["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(F["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(F.color=this.fontColor),_.isEmpty(this.backColor)||(F["background-color"]=this.backColor),Q||!O&&!U){var ve=parseFloat(this.getPaddingLeft()),Se=parseFloat(this.getPaddingRight()),xe=this.getRightBorderMax(he,ve,Se),Ce=this.getBoxShadow(xe);_.isEmpty(Ce)||(F["box-shadow"]=Ce)}_.isEmpty(this.maxWidth)||(F["max-width"]=this.maxWidth),(O||U)&&(F["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",F["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",F["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",F["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},C.prototype.getRightBorderMax=function(F,O,U){if(null==F)return U;var Q=Math.max(F-O,0);return Math.min(U,Q)},C.prototype.getAttributes=function(F,O,U,Q){var he={};return this.setAttributes(he,F,O,U,Q),he},C.prototype.getExtraTop=function(){var F=0;return this.paddings.top&&(F+=this.paddings.top),this.borders.top&&(F+=this.borders.top.weight),F},C.prototype.getExtraBottom=function(){var F=0;return this.paddings.bottom&&(F+=this.paddings.bottom),this.borders.bottom&&(F+=this.borders.bottom.weight),F},C.prototype.getExtraRight=function(){var F=0;return this.paddings.right&&(F+=this.paddings.right),this.borders.right&&(F+=this.borders.right.weight),F},C.prototype.getExtraLeft=function(){var F=0;return this.paddings.left&&(F+=this.paddings.left),this.borders.left&&(F+=this.borders.left.weight),F},C}(),d=function(){return function(){}}(),g=function(){function C(){this.row=new d,this.column=new d}return C.prototype.isMatch=function(F){return this.column.index===F.column.index&&this.row.index===F.row.index},C}(),y=function(){function C(F,O,U,Q,he,ve,Se,xe,Ce,Pe,Le){this.dataPoint=F,this.objects=O,this.isRowSubTotal=U,this.isColumnSubTotal=Q,this.isRowGrandTotal=he,this.isColumnGrandTotal=ve,this.isBlankRow=Se,this.columnMetadata=xe,this.formatter=Ce,this.tooltipFormatter=Pe,this.type=Le,this.position=new g,this.cachedTextContent=Ce?this.formatter.format(F,O):null!=this.dataPoint?F:""}return Object.defineProperty(C.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isKpi",{get:function(){return this.columnMetadata&&z(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(C,F){ie.fF.assertValue(C,"kpi"),ie.fF.assertValue(F,"kpiValue");var O=(0,fe.sq)(C,F)||"";return(0,le.hi)().addClass(O).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,W.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,W.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isValidUrl",{get:function(){return v(this.columnMetadata,this.textContent)!==de.av.NONE},enumerable:!1,configurable:!0}),C.prototype.isMatch=function(F){return this.position.isMatch(F.position)&&this.backColor===F.backColor},C}();function L(){return document.createElement("table")}function M(){var C=document.createElement("div");return C.className=r.rz,C}function Y(C){C.extension.contentElement.className=r.rz+" "+r.en,C.extension.contentHost.className=r.rz+" "+r.Pr}function c(C,F){C.extension.contentHost.className+=" "+F}function e(C){C.extension.contentHost.className="",C.extension.contentHost.style.cssText=""}function t(C){C.extension.contentHost.textContent="",C.extension.contentHost.removeAttribute("title"),C.contentHeight=C.contentWidth=0,w(C.extension.contentHost)}function l(C,F,O){s(C,F),f(C,O||F)}function s(C,F){F.textContent=(0,ue.PC)(C)}function f(C,F){F.title=C}function u(C,F){var O=M();return C.appendChild(O),F&&(O.textContent=F),O}function i(C){var O=C.offsetX;return O>=0&&O<C.target.offsetWidth-ce.A.resizeHandleSize}function h(C,F,O){var U=null;0===F.childElementCount?(U=document.createElement("a"),F.appendChild(U)):U=F.children[0],U.href=C,U.target="_blank",U.rel="noopener noreferrer",U.title=C,null!=O?(U.className=r.NA+" "+O,$(F).addClass(r.LU)):U.innerText=C}function P(C,F,O){var U=M(),Q=document.createElement("img");U.style.height=O+"px",U.style.width="100%",U.style.textAlign="center",Q.src=C,Q.style.maxHeight="100%",Q.style.maxWidth="100%",U.appendChild(Q),F.appendChild(U),F.title=C}function v(C,F){return(0,W.cR)(C)?(0,de.MN)(F):de.av.NONE}function b(C){switch(C){case de.av.file:case de.av.ftp:return"page2";case de.av.mailto:return"mail";case de.av.news:return"link";case de.av.telnet:return"pc1";case de.av.http:case de.av.https:return"link";default:return null}}function T(C,F,O){return R(C,F)&&(0,de.gU)(O)}function R(C,F){return(0,W.pt)(F)&&!C.isSubtotal&&!!C.identity}function z(C,F){return!(!C||void 0===F||!(0,fe.sq)(C,F))}function N(C,F){return{sortDescriptors:[{queryName:C,sortDirection:F}]}}function J(C){return 2===C?1:2}function oe(C,F){var O=M();C?(O.appendChild(pe(C,!0)),O.appendChild(pe(J(C),!1))):O.appendChild(pe(2,!1));var U=M();return O.appendChild(U),F.appendChild(O),U}function pe(C,F){var O=document.createElement("i");return O.className=r.rx+" "+(F?"sorted":"future")+" "+(1===C?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),O}function A(C){(function(C){for(var F=0,O=C.extension.contentElement.childElementCount;F<O;F++)if(C.extension.contentElement.children.item(F).classList.contains(r.rx))return!0;return!1})(C)&&$(C.extension.contentElement).find("."+r.rx).remove()}function ae(C){return ie.fF.assert(function(){return!(C instanceof Date)||(0,te.M4)(C)},"dates should implement DateWithEpochValue"),(0,te.M4)(C)&&(C=K.y3.fromDateWithEpochValue(C).toString()),String(C)}function we(C){return C+2}function Re(C){return C+2}},74304:function(Ve,Fe,X){X.d(Fe,{U:function(){return l}});var W=X(81337),fe=X(67016),ue=X(2142),le=X(85196),ie=X(29324),te=X(54522),Z=X(56707),de=X(85028),K=X(32105),ce=X(33024),r=X(55007),w=X(85308),n=X(62458),o=X(56578),H=X(64329),B=X(82755),k=X(76045),I=X(91059),q=X(96915),ne=X(82386),re=X(86878),m=X(72489),S=X(71090),d=X(73889),g=X(66842),y=X(40845),L=10,l=function(){function f(u){this.tablixProperties=new r.FX(u)}return f.getMetadataObjects=function(u){return u&&u.metadata?u.metadata.objects:null},f.prototype.enumerateObjectRepetition=function(u,i,h,P){var p,v,b,T,R,z,N;n.fF.assertValue(u,"enumeration should be defined"),n.fF.assertValue(i,"dataView can't be undefined");var oe,J=this.getSelectorData(h);switch(h){case d.Y.Table:case d.Y.TableEx:oe=this.getTableColumnMetadata(i);break;case d.Y.Matrix:case d.Y.PivotTable:oe=this.getMatrixValuesColumnMetadata(i);break;default:return void n.fF.assertNever(h)}if(oe){oe=_.uniq(oe);for(var pe=h===d.Y.PivotTable||h===d.Y.TableEx,se=0,A=oe;se<A.length;se++){var ae=A[se],ge=null===(N=ae.type.misc)||void 0===N?void 0:N.sparkline;if(pe){var ye={containerName:ae.displayName,selector:this.getSelector(ae.queryName,J),allowOverrideSubtotalMatching:!0,objects:(v={},v[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},v)};if(u.push(ye),!ge){var me={containerName:ae.displayName,selector:this.getSelector(ae.queryName,J),allowOverrideSubtotalMatching:!0,objects:(b={},b[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},b)};u.push(me)}if(ae.type.numeric&&!ge){var we={containerName:ae.displayName,selector:this.getSelector(ae.queryName),objects:(T={},T[r.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[r.FX.PropColumnFormattingDataBars.propertyName]},T)};u.push(we)}var Re={containerName:ae.displayName,selector:this.getSelector(ae.queryName,J),altStaticSelector:this.getSelector(ae.queryName),allowOverrideSubtotalMatching:!0,objects:(R={},R[r.FX.PropValuesIcon.objectName]={formattingProperties:[r.FX.PropValuesIcon.propertyName]},R)};if(u.push(Re),pe&&P?.conditionalTablixWebURL&&!(0,te.cR)(ae)&&!ge){var ee={containerName:ae.displayName,selector:this.getSelector(ae.queryName,J),allowOverrideSubtotalMatching:!0,objects:(z={},z[r.FX.PropValuesWebURL.objectName]={formattingProperties:[r.FX.PropValuesWebURL.propertyName]},z)};u.push(ee)}}else{if(!ae.isMeasure||!ae.type.numeric)continue;var be={containerName:ae.displayName,selector:this.getSelector(ae.queryName,J),objects:(p={},p[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},p)};u.push(be)}}}},f.prototype.getSelectorData=function(u){switch(u){case d.Y.Table:return[(0,I.Yp)(["Values"])];case d.Y.TableEx:return[(0,q.Ue)(1)];case d.Y.Matrix:return[(0,I.Yp)(["Rows","Columns"])];case d.Y.PivotTable:return[(0,q.Ue)(1)];default:return void n.fF.assertNever(u)}},f.prototype.getConditionalFormattingSelector=function(u,i,h){void 0===h&&(h=!0);var P=h?this.getSelectorData(u):void 0;return this.getSelector(i,P)},f.prototype.getSelector=function(u,i){var h={metadata:u};return i&&(h.data=i),h},f.prototype.getFormattingModel=function(u,i,h,P,p,v,b){void 0===p&&(p=!1),n.fF.assertValue(h,"dataView can't be undefined");var N,T=f.getMetadataObjects(h),R=i,z=i,J=this.getColumnsMetadata(h,P);N=P===d.Y.Table?this.shouldShowTableTotalsOption(h)&&r.FX.PropGeneralTableTotals.getValue(T):this.shouldShowColumnSubtotalsOption(h)&&r.FX.PropGeneralMatrixColumnSubtotals.getValue(T)||this.shouldShowRowSubtotalsOption(h)&&r.FX.PropGeneralMatrixRowSubtotals.getValue(T);var oe=this.getTablixTextClassProperties(b),pe=new o.Nq(this.getStylePresetCard(u,R,P,v),this.getGridCard(u,i,P,T,oe,v),this.getBlankRowCard(u,R,P,v),this.getValueCard(u,i,P,T,v),this.getColumnHeadersCard(u,i,P,v),this.getRowHeadersCard(u,R,P,T,p,v),this.getTotalsCard(u,z,P,v),this.getColumnSubtotalCard(u,R,h,P,N,v),this.getRowSubTotalsCard(u,R,h,P,N,v),this.getColumnGrandTotalsCard(u,R,P),this.getRowGrandTotalsCard(u,R,P),this.getColumnFormattingCard(u,i,J,P),this.getCellColumnCard(u,P,h,v),this.getUrlIconCard(u,i,P),this.getImageSizeCard(u,i,P,v),this.getSparklinesCard(J,u,P)),se=this.getMatrixRowsColumnMetadata(h),A=this.getMatrixColumnsColumnMetadata(h),ae=v.a11yShowAsMatrix?this.getAccessibilityCardNew(se,A,J,u,z,P):this.getAccessibilityCard(J,u,z,P);return ae&&pe.addCards(ae),pe.build()},f.prototype.getLayoutSlice=function(u,i){return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new o.uY({descriptor:fe.t.general.layout,value:u.general.layout}).build(),localize:i}).build()},f.prototype.getIndentationSlice=function(u,i){if(u.general.layout===g.t.Compact){var h=u.rowHeaders;return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(h,i).build(),localize:i}).build()}},f.prototype.getRepeatRowHeadersSlice=function(u,i){if(u.general.layout!==g.t.Compact)return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new o.bd({descriptor:fe.t.rowHeaders.repeatRowHeaders,value:u.rowHeaders.repeatRowHeaders}).build(),localize:i}).build()},f.prototype.getStylePresetCard=function(u,i,h,P){var p=this,v="StylePresets";P.matrixLayouts&&h===d.Y.PivotTable&&(v="Layout_And_StylePresets");var b=function(z){return u.getLocalizedString(z)},T=new o.CQ(new o.lg("stylePreset"),v,[fe.t.general.layout,fe.t.rowHeaders.steppedLayoutIndentation,fe.t.rowHeaders.repeatRowHeaders],b);return T.addGroup(void 0,function(R){if(R.addSlicePlaceholder((0,o.E0)("stylePreset")),P.matrixLayouts&&h===d.Y.PivotTable){var z=p.getLayoutSlice(i,b),N=p.getIndentationSlice(i,b),J=p.getRepeatRowHeadersSlice(i,b);R.addSlice(z),N&&R.addSlice(N),J&&R.addSlice(J)}}),T.build()},f.prototype.getBlankRowCard=function(u,i,h,P){if(P.matrixLayouts&&h===d.Y.PivotTable){var p=function(R){return u.getLocalizedString(R)},v=fe.t.blankRows,b=new o.CQ(new o.lg("blankRows"),"Visual_Blank_Rows",v,p).addTopLevelToggle("blankRow",function(){return new o.bd({descriptor:v.showBlankRows,value:i.blankRows.showBlankRows}).build()});return b.addGroup("colors",function(T){T.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new o.BT({descriptor:v.blankRowColor,value:{value:i.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new o.JN({descriptor:v.blankRowTransparency,value:i.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ce.t2},localize:p}).build(),function(R){return R.withCustomDisplayName("Transparency")})}),b.addGroup("border",function(T){T.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new o.bd({descriptor:v.showBorder,value:i.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new o.uY({descriptor:v.borderPosition,value:i.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new o.BT({descriptor:v.borderColor,value:{value:i.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new o.JN({descriptor:v.borderTransparency,value:i.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ce.t2},localize:p}).build(),function(R){return R.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new o.mu({descriptor:v.borderWidth,value:i.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:L},unitSymbol:ce.e_}}).build(),function(R){return R.withCustomDisplayName("Visual_General_Properties_Width")})}),b.build()}},f.prototype.getGridCard=function(u,i,h,P,p,v){var b=function(O){return u.getLocalizedString(O)},T=h===d.Y.TableEx?ue.Z.grid:fe.t.grid,R=h===d.Y.TableEx?ue.Z.values:fe.t.values,z=R.outlineStyle,N=R.outlineWeight,J=R.outlineColor,oe=h===d.Y.TableEx?ue.Z.columnHeaders:fe.t.columnHeaders,pe=oe.outlineStyle,se=oe.outlineWeight,A=oe.outlineColor,ae=h===d.Y.TableEx?ue.Z.total:fe.t.total,ge=ae.outlineStyle,be=ae.outlineWeight,ye=ae.outlineColor,me=fe.t.rowHeaders,we=me.outlineStyle,Re=me.outlineWeight,ee=me.outlineColor,G=T.outlineStyle,D=(0,W._T)(T,["imageHeight","imageWidth","outline","outlineStyle"]);D=(0,W.pi)((0,W.pi)({},D),{outlineStyle:G,valuesOutlineStyle:z,valuesOutlineWeight:N,valuesOutlineColor:J,columnHeadersOutlineStyle:pe,columnHeadersOutlineWeight:se,columnHeadersOutlineColor:A}),h===d.Y.TableEx&&(D=(0,W.pi)((0,W.pi)({},D),{totalsOutlineStyle:ge,totalsOutlineColor:ye,totalsOutlineWeight:be})),h===d.Y.PivotTable&&(D=(0,W.pi)((0,W.pi)({},D),{rowHeaderOutlineStyle:we,rowHeaderOutlineWeight:Re,rowHeaderOutlineColor:ee}));var j=i.grid,C=new o.CQ(new o.lg("grid"),"Visual_Grid",D,b);return C.addGroup("gridHorizontal",function(F){F.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new o.bd({descriptor:D.gridHorizontal,value:j.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new o.BT({descriptor:D.gridHorizontalColor,value:{value:j.gridHorizontalColor}}).build()},function(O){return O.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new o.mu({descriptor:D.gridHorizontalWeight,value:j.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:L}}}).build(),function(O){return O.withCustomDisplayName("Visual_General_Properties_Width")})}),C.addGroup("gridVertical",function(F){F.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new o.bd({descriptor:D.gridVertical,value:j.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new o.BT({descriptor:D.gridVerticalColor,value:{value:j.gridVerticalColor}}).build()},function(O){return O.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new o.mu({descriptor:D.gridVerticalWeight,value:j.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:L}}}).build(),function(O){return O.withCustomDisplayName("Visual_General_Properties_Width")})}),C.addGroup("border",function(F){F.withDisplayName("Visual_Border").addContainer("outline",function(O){O.withDisplayName("Section"),O.addContainerItem("all",b("All"),function(U){U.addSimpleSlice("outlineStyle",function(){return new o.oM({descriptor:D.outlineStyle,value:j.outline}).build()},function(Q){return Q.withCustomDisplayName("Visual_Border_Position")}),U.addSimpleSlice("outlineColor",function(){return new o.BT({descriptor:D.outlineColor,value:{value:j.outlineColor}}).build()},function(Q){return Q.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new o.mu({descriptor:D.outlineWeight,value:j.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:L}}}).build(),function(Q){return Q.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",b("Visual_Tablix_ColumnHeader"),function(U){var Q=i.columnHeaders;U.addSimpleSlice("outlineStyleColumnHeaders",function(){return new o.oM({descriptor:pe,value:Q.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}),U.addSimpleSlice("outlineColorColumnHeaders",function(){return new o.BT({descriptor:A,value:{value:Q.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new o.mu({descriptor:se,value:Q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:L}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),h===d.Y.PivotTable&&O.addContainerItem("rowHeaders",b("Visual_Tablix_RowHeaders"),function(U){var Q=i.rowHeaders;U.addSimpleSlice("outlineStyleRowHeaders",function(){return new o.oM({descriptor:we,value:Q.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}),U.addSimpleSlice("outlineColorRowHeaders",function(){return new o.BT({descriptor:ee,value:{value:Q.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new o.mu({descriptor:Re,value:Q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:L}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),O.addContainerItem("values",b("Visual_Tablix_ValuesSection"),function(U){var Q=i.values;U.addSimpleSlice("outlineStyleValues",function(){return new o.oM({descriptor:z,value:Q.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new o.BT({descriptor:J,value:{value:Q.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new o.mu({descriptor:N,value:Q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:L}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),h===d.Y.TableEx&&O.addContainerItem("outline-totals",b("Visual_Tablix_TotalsSection"),function(U){var Q=i.total;U.addSimpleSlice("outlineStyleTotals",function(){return new o.oM({descriptor:ge,value:Q.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new o.BT({descriptor:ye,value:{value:Q.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new o.mu({descriptor:be,value:Q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:L}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})})})}),C.addGroup("options",function(F){F.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new o.mu({descriptor:D.rowPadding,value:j.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new o.mu({descriptor:D.textSize,value:r.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,P,p.fontSizeOverrideFn,p.labelFontProperties.size&&p.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(O){return O.withCustomDisplayName("Global_Font_Size")})}),C.build()},f.prototype.getValueCard=function(u,i,h,P,p){var se=(0,W._T)(h===d.Y.TableEx?ue.Z.values:fe.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),A=i.values,ae=new o.CQ(new o.lg("values"),"Visual_Tablix_Values",se,function(me){return u.getLocalizedString(me)}),be=(new o.UN).withFontFamily({descriptor:se.fontFamily,value:A.fontFamily}).withFontSizeProperties({descriptor:se.fontSize,value:A.fontSize.pt}).withBold({descriptor:se.bold,value:A.bold}).withItalic({descriptor:se.italic,value:A.italic}).withUnderline({descriptor:se.underline,value:A.underline}).build();return ae.addGroup("values",function(ye){ye.withDisplayName("Visual_Tablix_Values"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&ye.addCompositeSlice("font","Font",be),ye.addSimpleSlice("fontColorPrimary",function(){return new o.BT({descriptor:se.fontColorPrimary,value:{value:A.fontColorPrimary}}).build()},function(me){return me.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new o.BT({descriptor:se.backColorPrimary,value:{value:A.backColorPrimary}}).build()},function(me){return me.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new o.BT({descriptor:se.fontColorSecondary,value:{value:A.fontColorSecondary}}).build()},function(me){return me.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new o.BT({descriptor:se.backColorSecondary,value:{value:A.backColorSecondary}}).build()},function(me){return me.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new o.bd({descriptor:se.wordWrap,value:A.wordWrap}).build(),function(me){return me.withCustomDisplayName("TextWrap")})}),h===d.Y.PivotTable&&ae.addGroup("options",function(ye){ye.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new o.bd({descriptor:se.valuesOnRow,value:r.FX.PropValuesOnRow.setInstanceProperty(void 0,P)}).build(),function(me){return me.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),ae.build()},f.prototype.getColumnHeadersCard=function(u,i,h,P){var N=(0,W._T)(h===d.Y.TableEx?ue.Z.columnHeaders:fe.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),J=i.columnHeaders,oe=new o.CQ(new o.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",N,function(ae){return u.getLocalizedString(ae)}),se=(new o.UN).withFontFamily({descriptor:N.fontFamily,value:J.fontFamily}).withFontSizeProperties({descriptor:N.fontSize,value:J.fontSize.pt}).withBold({descriptor:N.bold,value:J.bold}).withItalic({descriptor:N.italic,value:J.italic}).withUnderline({descriptor:N.underline,value:J.underline}).build();return oe.addGroup("text",function(A){A.withDisplayName("Text"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&A.addCompositeSlice("font","Font",se),A.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:N.fontColor,value:{value:J.fontColor}}).build()},function(ge){return ge.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:N.backColor,value:{value:J.backColor}}).build()},function(ge){return ge.withCustomDisplayName("Background_Color")}),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&A.addSimpleSlice("alignment",new o.Gp({descriptor:N.alignment,value:J.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(ge){return ge.withCustomDisplayName("Visual_TextAlignment_Header")}),h===d.Y.PivotTable&&A.addSimpleSlice("titleAlignment",new o.Gp({descriptor:N.titleAlignment,value:i.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&A.addSimpleSlice("wordWrap",new o.bd({descriptor:N.wordWrap,value:J.wordWrap}).build(),function(ge){return ge.withCustomDisplayName("TextWrap")})}),(h===d.Y.PivotTable||h===d.Y.TableEx)&&oe.addGroup("options",function(A){A.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new o.bd({descriptor:N.autoSizeColumnWidth,value:i.general.autoSizeColumnWidth}).build(),function(ae){return ae.withCustomDisplayName("Visual_AutoSize_Width")})}),oe.build()},f.prototype.getRowHeadersCard=function(u,i,h,P,p,v){var b=this;if(void 0===p&&(p=!1),h===d.Y.PivotTable){var T=function(we){return u.getLocalizedString(we)},se=(0,W._T)(fe.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),A=fe.t.values.bandedRowHeaders;h===d.Y.PivotTable&&(se=(0,W.pi)((0,W.pi)({},se),{bandedRowHeaders:A}));var ae=i.rowHeaders,ge=new o.CQ(new o.lg("rowHeaders"),"Visual_Tablix_RowHeaders",se,T),ye=(new o.UN).withFontFamily({descriptor:se.fontFamily,value:ae.fontFamily}).withFontSizeProperties({descriptor:se.fontSize,value:ae.fontSize.pt}).withBold({descriptor:se.bold,value:ae.bold}).withItalic({descriptor:se.italic,value:ae.italic}).withUnderline({descriptor:se.underline,value:ae.underline}).build();return ge.addGroup("text",function(me){me.withDisplayName("Text"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&me.addCompositeSlice("font","Font",ye),me.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:se.fontColor,value:{value:ae.fontColor}}).build()},function(we){return we.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:se.backColor,value:{value:ae.backColor}}).build()},function(we){return we.withCustomDisplayName("Background_Color")}),h===d.Y.PivotTable&&me.addSimpleSlice("bandedRowHeaders",new o.bd({descriptor:se.bandedRowHeaders,value:r.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,P)}).build()),me.addSimpleSlice("alignment",new o.Gp({descriptor:se.alignment,value:ae.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new o.bd({descriptor:se.wordWrap,value:ae.wordWrap}).build(),function(we){return we.withCustomDisplayName("TextWrap")})}),h===d.Y.PivotTable&&p&&ge.addGroup("expandCollapseButtons",function(me){me.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),me.addTopLevelToggle("showExpandCollapseButtons",function(){return new o.bd({descriptor:se.showExpandCollapseButtons,value:ae.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new o.BT({descriptor:se.expandCollapseButtonsColor,value:{value:ae.expandCollapseButtonsColor}}).build()},function(we){return we.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new o.mu({descriptor:se.expandCollapseButtonsSize,value:ae.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(we){return we.withCustomDisplayName("Visual_BubbleSize")})}),v.matrixLayouts||ge.addGroup("options",function(me){me.withDisplayName("Desktop_FileMenu_Options"),me.addSimpleSlice("stepped",new o.bd({descriptor:se.stepped,value:ae.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",b.getIndentationSliderBuilder(ae,T).build())}),ge.build()}},f.prototype.getIndentationSliderBuilder=function(u,i){return new o.JN({descriptor:fe.t.rowHeaders.steppedLayoutIndentation,value:u.steppedLayoutIndentation,localize:i,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},f.prototype.getTotalsCard=function(u,i,h,P){if(h===d.Y.TableEx){var z=(0,W._T)(h===d.Y.TableEx?ue.Z.total:fe.t.total,["outlineStyle","outlineWeight","outlineColor"]),N=i.total,J=new o.CQ(new o.lg("totals"),"Visual_Totals",z,function(A){return u.getLocalizedString(A)}),pe=(new o.UN).withFontFamily({descriptor:z.fontFamily,value:N.fontFamily}).withFontSizeProperties({descriptor:z.fontSize,value:N.fontSize.pt}).withBold({descriptor:z.bold,value:N.bold}).withItalic({descriptor:z.italic,value:N.italic}).withUnderline({descriptor:z.underline,value:N.underline}).build();return J.addGroup("values",function(se){var A;se.withDisplayName("Visual_Tablix_Values"),h===d.Y.TableEx?(se.addTopLevelToggle("gridVertical",function(){return new o.bd({descriptor:z.totals,value:i.general.totals}).build()}),A=i.general.totals):A=!0,A&&se.addSimpleSlice("totalLabel",new o.fq({descriptor:z.label,value:N.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",pe),se.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:z.fontColor,value:{value:N.fontColor}}).build()},function(ae){return ae.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:z.backColor,value:{value:N.backColor}}).build()},function(ae){return ae.withCustomDisplayName("Background_Color")})}),J.build()}},f.prototype.getColumnGrandTotalsCard=function(u,i,h){if(h!==d.Y.TableEx){var T=(0,W._T)(fe.t.columnTotal,["outlineStyle","outline"]),R=i.columnGrandTotal,z=new o.CQ(new o.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",T,function(pe){return u.getLocalizedString(pe)}),J=(new o.UN).withFontFamily({descriptor:T.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:R.fontSize.pt}).withBold({descriptor:T.bold,value:R.bold}).withItalic({descriptor:T.italic,value:R.italic}).withUnderline({descriptor:T.underline,value:R.underline}).build();return z.addGroup("values",function(oe){oe.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",J).addSimpleSlice("fontColor",function(){return new o.BT({descriptor:T.fontColor,value:{value:R.fontColor}}).build()},function(pe){return pe.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:T.backColor,value:{value:R.backColor}}).build()},function(pe){return pe.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:T.applyToHeaders,value:R.applyToHeaders}).build())}),z.build()}},f.prototype.getRowGrandTotalsCard=function(u,i,h){if(h!==d.Y.TableEx){var T=(0,W._T)(fe.t.rowTotal,["outlineStyle","outline"]),R=i.rowGrandTotal,z=new o.CQ(new o.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",T,function(pe){return u.getLocalizedString(pe)}),J=(new o.UN).withFontFamily({descriptor:T.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:R.fontSize.pt}).withBold({descriptor:T.bold,value:R.bold}).withItalic({descriptor:T.italic,value:R.italic}).withUnderline({descriptor:T.underline,value:R.underline}).build();return z.addGroup("values",function(oe){oe.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",J).addSimpleSlice("fontColor",function(){return new o.BT({descriptor:T.fontColor,value:{value:R.fontColor}}).build()},function(pe){return pe.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:T.backColor,value:{value:R.backColor}}).build()},function(pe){return pe.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:T.applyToHeaders,value:R.applyToHeaders}).build())}),z.build()}},f.prototype.addAltTextGroup=function(u,i,h,P,p,v){_.isEmpty(P)||u.addGroup(i,function(b){b.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),b.addContainer("measure",function(T){T.withDisplayName(h);for(var R=function(pe){var se;v===le.r.rows||v===le.r.columns?se={data:[(0,I.Yp)([v])]}:v===le.r.values?se={data:[(0,q.Ue)(0)],metadata:pe.queryName}:n.fF.assertFail("unexpected role"),T.addContainerItem(pe.queryName,pe.displayName,function(A){return A.addSimpleSlice("altTextColumns",new o.k0({descriptor:(0,W.pi)((0,W.pi)({},p.altTextColumns),{selector:se,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},z=0,N=P;z<N.length;z++)R(N[z])})})},f.prototype.getAccessibilityCardNew=function(u,i,h,P,p,v){n.fF.assert(function(){return v===d.Y.TableEx||v===d.Y.PivotTable});var b=v===d.Y.TableEx?ue.Z.accessibility:fe.t.accessibility,T=_.filter(u,te.pt),R=_.filter(i,te.pt),z=_.filter(h,te.pt),N=_.filter(h,function(se){return se.type.text}).map(function(se){return{displayName:se.displayName,value:se.queryName}});if(!(_.isEmpty(T)&&_.isEmpty(R)&&_.isEmpty(z))||v!==d.Y.PivotTable&&!_.isEmpty(N)){var oe=new o.CQ(new o.lg("accessibility"),"Accessibility",v===d.Y.TableEx?[b.altTextColumns,b.rowWithReferenceText]:[b.altTextColumns],function(A){return P.getLocalizedString(A)});if(this.addAltTextGroup(oe,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",T,b,le.r.rows),this.addAltTextGroup(oe,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",R,b,le.r.columns),this.addAltTextGroup(oe,"AltTextValues","Image_Alt_Text_Values",z,b,le.r.values),v===d.Y.TableEx&&!_.isEmpty(N)){var pe={displayName:P.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};N.unshift(pe),oe.addGroup("rowWithReferenceText",function(se){var A;se.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),se.addSimpleSlice("rowWithReferenceText",new o.uY({descriptor:(0,W.pi)({},b.rowWithReferenceText),items:N,value:null!==(A=_.find(N,function(ae){return ae.value===p.rowWithReferenceText.rowWithReferenceText}))&&void 0!==A?A:N[0]}).build())})}return oe.build()}},f.prototype.getAccessibilityCard=function(u,i,h,P){if(P===d.Y.TableEx){var p=ue.Z.accessibility,v=_.filter(u,te.pt),b=_.filter(u,function(N){return N.type.text}).map(function(N){return{displayName:N.displayName,value:N.queryName}});if(!_.isEmpty(v)||!_.isEmpty(b)){var R=new o.CQ(new o.lg("accessibility"),"Accessibility",[p.altTextColumns,p.rowWithReferenceText],function(J){return i.getLocalizedString(J)});if(_.isEmpty(v)||R.addGroup("AltTextValues",function(N){N.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),N.addContainer("measure",function(J){J.withDisplayName("Image_Alt_Text_Values");for(var oe=function(ge){J.addContainerItem(ge.queryName,ge.displayName,function(be){return be.addSimpleSlice("altTextColumns",new o.k0({descriptor:(0,W.pi)((0,W.pi)({},p.altTextColumns),{selector:{data:[(0,q.Ue)(0)],metadata:ge.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},pe=0,se=v;pe<se.length;pe++)oe(se[pe])})}),!_.isEmpty(b)){var z={displayName:i.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};b.unshift(z),R.addGroup("rowWithReferenceText",function(N){var J;N.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),N.addSimpleSlice("rowWithReferenceText",new o.uY({descriptor:(0,W.pi)({},p.rowWithReferenceText),items:b,value:null!==(J=_.find(b,function(oe){return oe.value===h.rowWithReferenceText.rowWithReferenceText}))&&void 0!==J?J:b[0]}).build())})}return R.build()}}},f.prototype.getRowSubTotalsCard=function(u,i,h,P,p,v){var b=this;if(p||P===d.Y.PivotTable){var T=f.getMetadataObjects(h),R=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,T),z=function(A){return u.getLocalizedString(A)},N=fe.t.subTotals,J=(0,W.pi)((0,W.pi)({},i.subtotals),i.rowSubtotals),oe=new o.CQ(new o.lg("rowSubTotal"),"Visual_SubtotalRow",[N.rowSubtotalsLabel,N.rowSubtotals,N.rowSubtotalsPosition,N.perRowLevel,N.levelSubtotalEnabled,N.levelSubtotalLabel,N.fontColor,N.backColor,N.fontSize,N.fontFamily,N.bold,N.italic,N.underline,N.applyToHeaders],z);oe.addTopLevelToggle("rowSubtotals",function(){return new o.bd({descriptor:N.rowSubtotals,value:i.general.rowSubtotals}).build()});var pe=0;return oe.addGroup("applySettingsTo",function(se){se.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new o.bd({descriptor:N.perRowLevel,value:R}).build(),function(A){return A.withDisabled(!b.shouldShowRowSubtotalsOption(h)).withCustomDescriptionIf(function(){return!b.shouldShowRowSubtotalsOption(h)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(A){A.withDisplayName("Visual_Tablix_Row_Level"),A.addContainerItem("all",z("All"),function(ee){return b.getRowSubtotalContainers(i,ee,z,v,N,J,void 0,T)});for(var ae=0,ge=h.matrix.rows.levels;ae<ge.length;ae++)for(var ye=function(a){if(!a.isMeasure){var x={metadata:a.queryName};A.addContainerItem(a.displayName,a.displayName,function(V){return b.getRowSubtotalContainers(i,V,z,v,N,J,x,a.objects,pe)}),pe++}},me=0,we=ge[ae].sources;me<we.length;me++)ye(we[me])})}),oe.build()}},f.prototype.getRowSubtotalContainers=function(u,i,h,P,p,v,b,T,R){var z=b?r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(T,!0):r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(T,!0),N=b?"":h(S.qT),J=b?p.levelSubtotalLabel:p.rowSubtotalsLabel;i.addGroup("rows",function(oe){oe.withDisplayName("Role_DisplayName_Rows"),oe.addSimpleSlice("levelSubtotalEnabled",new o.bd({descriptor:(0,W.pi)((0,W.pi)({},p.levelSubtotalEnabled),{selector:b}),value:r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,T)}).build(),function(pe){return pe.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!b)}).addSimpleSlice("rowSubtotalsLabel",new o.fq({descriptor:(0,W.pi)((0,W.pi)({},J),{selector:b}),value:z||N,placeholder:""}).build(),function(pe){return pe.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(b?"rowSubtotalsPositionSeries".concat(R):"rowSubtotalsPositionAll",new o.uY({descriptor:p.rowSubtotalsPosition,value:u.subtotals.rowSubtotalsPosition}).build(),function(pe){return pe.withCustomDisplayName("Visual_Position").withDisabled(!!b||P.matrixLayouts&&u.general.layout===g.t.Tabular)})}),i.addGroup("values",function(oe){if(oe.withDisplayName("Visual_Tablix_Values"),b)oe.withDisabled(!0,"");else{var pe={id:"Row"},A=(new o.UN).withFontFamily({descriptor:(0,W.pi)((0,W.pi)({},p.fontFamily),{selector:pe}),value:v.fontFamily}).withFontSizeProperties({descriptor:(0,W.pi)((0,W.pi)({},p.fontSize),{selector:pe}),value:v.fontSize.pt}).withBold({descriptor:(0,W.pi)((0,W.pi)({},p.bold),{selector:pe}),value:v.bold}).withItalic({descriptor:(0,W.pi)((0,W.pi)({},p.italic),{selector:pe}),value:v.italic}).withUnderline({descriptor:(0,W.pi)((0,W.pi)({},p.underline),{selector:pe}),value:v.underline}).build();oe.addCompositeSlice("font","Font",A).addSimpleSlice("fontColor",function(){var ae={value:v.fontColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},p.fontColor),{selector:pe}),value:ae}).build()},function(ae){return ae.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var ae={value:v.backColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},p.backColor),{selector:pe}),value:ae}).build()},function(ae){return ae.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:(0,W.pi)((0,W.pi)({},p.applyToHeaders),{selector:pe}),value:v.applyToHeaders}).build())}})},f.prototype.getColumnSubtotalCard=function(u,i,h,P,p,v){var b=this;if(p||P===d.Y.PivotTable||this.shouldShowColumnSubtotalsOption(h)){var T=f.getMetadataObjects(h),R=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(T),z=function(se){return u.getLocalizedString(se)},N=fe.t.subTotals,J=(0,W.pi)((0,W.pi)({},i.subtotals),i.columnSubtotals),oe=new o.CQ(new o.lg("columnSubTotal"),"Visual_SubtotalColumn",[N.columnSubtotals,N.columnSubtotalsLabel,N.perColumnLevel,N.levelSubtotalEnabled,N.levelSubtotalLabel,N.fontColor,N.backColor,N.fontSize,N.fontFamily,N.bold,N.italic,N.underline,N.applyToHeaders],z);return oe.addTopLevelToggle("columnSubtotals",function(){return new o.bd({descriptor:N.columnSubtotals,value:i.general.columnSubtotals}).build()}),oe.addGroup("applySettingsTo",function(pe){pe.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new o.bd({descriptor:N.perColumnLevel,value:R}).build(),function(se){return se.withDisabled(!b.shouldShowColumnSubtotalsOption(h)).withCustomDescriptionIf(function(){return!b.shouldShowColumnSubtotalsOption(h)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(se){se.withDisplayName("Visual_Tablix_Column_Level"),se.addContainerItem("all",z("All"),function(Re){return b.getColumnSubtotalContainers(Re,z,v,N,J,void 0,T)});for(var A=0,ae=h.matrix.columns.levels;A<ae.length;A++)for(var be=function(ee){if(!ee.isMeasure){var a={metadata:ee.queryName};se.addContainerItem(ee.displayName,ee.displayName,function(x){return b.getColumnSubtotalContainers(x,z,v,N,J,a,ee.objects)})}},ye=0,me=ae[A].sources;ye<me.length;ye++)be(me[ye])})}),oe.build()}},f.prototype.getColumnSubtotalContainers=function(u,i,h,P,p,v,b){var T=i(S.qT),R=v?r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(b,!0):r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(b,!0),z=v?P.levelSubtotalLabel:P.columnSubtotalsLabel;u.addGroup("columns",function(N){N.withDisplayName("Role_DisplayName_Columns"),N.addSimpleSlice("levelSubtotalEnabled",new o.bd({descriptor:(0,W.pi)((0,W.pi)({},P.levelSubtotalEnabled),{selector:v}),value:r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,b)}).build(),function(J){return J.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!v)}).addSimpleSlice("columnSubtotalsLabel",new o.fq({descriptor:(0,W.pi)((0,W.pi)({},z),{selector:v}),value:R||T,placeholder:""}).build(),function(J){return J.withCustomDisplayName("Visual_Subtotal_Label")})}),u.addGroup("values",function(N){if(N.withDisplayName("Visual_Tablix_Values"),v)N.withDisabled(!0,"");else{var J={id:"Column"},pe=(new o.UN).withFontFamily({descriptor:(0,W.pi)((0,W.pi)({},P.fontFamily),{selector:J}),value:p.fontFamily}).withFontSizeProperties({descriptor:(0,W.pi)((0,W.pi)({},P.fontSize),{selector:J}),value:p.fontSize.pt}).withBold({descriptor:(0,W.pi)((0,W.pi)({},P.bold),{selector:J}),value:p.bold}).withItalic({descriptor:(0,W.pi)((0,W.pi)({},P.italic),{selector:J}),value:p.italic}).withUnderline({descriptor:(0,W.pi)((0,W.pi)({},P.underline),{selector:J}),value:p.underline}).build();N.addCompositeSlice("font","Font",pe).addSimpleSlice("fontColor",function(){var se={value:p.fontColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},P.fontColor),{selector:J}),value:se}).build()},function(se){return se.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var se={value:p.backColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},P.backColor),{selector:J}),value:se}).build()},function(se){return se.withCustomDisplayName("Background_Color")}),N.addSimpleSlice("applyToHeaders",new o.bd({descriptor:(0,W.pi)((0,W.pi)({},P.applyToHeaders),{selector:J}),value:p.applyToHeaders}).build())}})},f.prototype.getColumnFormattingCard=function(u,i,h,P){if(!_.isEmpty(h)){var T=(0,W._T)(P===d.Y.TableEx?ue.Z.columnFormatting:fe.t.columnFormatting,["dataBars"]),R=i.columnFormatting,z=new o.CQ(new o.lg("columnFormatting"),"Visual_Tablix_Specific_Column",T,function(J){return u.getLocalizedString(J)});return z.withDescription("Visual_Matrix_SpecificColumn_Description"),z.addGroup("columns",function(N){N.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(J){J.withDisplayName("Series");for(var oe=function(ge){var be=ge&&ge.objects;J.addContainerItem(ge.queryName,ge.displayName,function(ye){ye.addSimpleSlice(T.styleHeader,new o.bd({descriptor:(0,W.pi)((0,W.pi)({},T.styleHeader),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleHeader}).build()),P===d.Y.PivotTable&&ye.addSimpleSlice(T.styleSubtotals,new o.bd({descriptor:(0,W.pi)((0,W.pi)({},T.styleSubtotals),{selector:{metadata:ge.queryName}}),value:r.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,be)}).build()),ye.addSimpleSlice(T.styleTotal,new o.bd({descriptor:(0,W.pi)((0,W.pi)({},T.styleTotal),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleTotal}).build()).addSimpleSlice(T.styleValues,new o.bd({descriptor:(0,W.pi)((0,W.pi)({},T.styleValues),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleValues}).build()),ye.addGroup("values",function(me){if(me.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var Re={value:R[ge.queryName].fontColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},T.fontColor),{selector:{metadata:ge.queryName}}),value:Re}).build()},function(Re){return Re.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var Re={value:R[ge.queryName].backColor};return new o.BT({descriptor:(0,W.pi)((0,W.pi)({},T.backColor),{selector:{metadata:ge.queryName}}),value:Re}).build()},function(Re){return Re.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new o.Gp({descriptor:(0,W.pi)((0,W.pi)({},T.alignment),{selector:{metadata:ge.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:R[ge.queryName].alignment}).build()),ge.type.numeric&&(P===d.Y.PivotTable||P===d.Y.TableEx)){var we=ge&&ge.objects;me.addSimpleSlice("labelDisplayUnits",new o.uY({descriptor:(0,W.pi)((0,W.pi)({},T.labelDisplayUnits),{selector:{metadata:ge.queryName}}),value:r.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,we)}).build()).addSimpleSlice("labelPrecision",new o.mu({descriptor:(0,W.pi)((0,W.pi)({},T.labelPrecision),{selector:{metadata:ge.queryName}}),value:r.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,we),options:{minValue:{type:0,value:0},maxValue:{type:1,value:Z.vo}}}).build())}})})},pe=0,se=h;pe<se.length;pe++)oe(se[pe])})}),z.build()}},f.prototype.getCellColumnCard=function(u,i,h,P){var b=(0,ue.k)().objects,T=[];return this.enumerateObjectRepetition(T,h,i,P),(0,ie.Z)(T,function(z){return u.getLocalizedString(z)},b,"Cell_Elements","Visual_Matrix_CellElements_Description")},f.prototype.getUrlIconCard=function(u,i,h){var P=h===d.Y.TableEx?ue.Z.values.urlIcon:fe.t.values.urlIcon,p=i,v=fe.t.columnHeaders.urlIcon,b=fe.t.rowHeaders.urlIcon,R=new o.CQ(new o.lg("urlIcon"),"Visual_Tablix_UrlIcon",[P,v,b],function(N){return u.getLocalizedString(N)});return R.addGroup("urlIcon",function(z){(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&z.addSimpleSlice("values",new o.bd({descriptor:P,value:i.values.urlIcon}).build(),function(N){return N.withCustomDisplayName("Visual_Tablix_Values")}),h===d.Y.PivotTable&&z.addSimpleSlice("columnheaders",new o.bd({descriptor:v,value:p.columnHeaders.urlIcon}).build(),function(N){return N.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new o.bd({descriptor:b,value:p.rowHeaders.urlIcon}).build(),function(N){return N.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),R.build()},f.prototype.getImageSizeCard=function(u,i,h,P){var p=h===d.Y.TableEx?ue.Z.grid.imageHeight:fe.t.grid.imageHeight,v=h===d.Y.TableEx?ue.Z.grid.imageWidth:fe.t.grid.imageWidth,T=new o.CQ(new o.lg("imageHeight"),"Visual_Tablix_ImageSize",[p,v],function(z){return u.getLocalizedString(z)});return T.addGroup("imageHeight",function(R){R.addSimpleSlice("imageHeight",new o.mu({descriptor:p,value:i.grid.imageHeight,options:{minValue:{type:0,value:f.ImageSizeMin},maxValue:{type:1,value:f.ImageSizeMax},unitSymbol:ce.e_}}).build()),P.tablixImageWidth&&R.addSimpleSlice("imageWidth",new o.mu({descriptor:v,value:i.grid.imageWidth,options:{minValue:{type:0,value:f.ImageSizeMin},maxValue:{type:1,value:f.ImageSizeMax},unitSymbol:ce.e_}}).build())}),T.build()},f.prototype.getSparklinesCard=function(u,i,h){var P=this;if(!_.isEmpty(u)&&this.hasSparklines(u)){var p=function(T){return i.getLocalizedString(T)},v=h===d.Y.TableEx?ue.Z.sparklines:fe.t.sparklines;return new o.CQ(new o.lg("sparklines"),"Sparkline_Label",v,p).addGroup("columns",function(b){return b.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(T){var R;T.withDisplayName("Sparkline_Singular_Label");for(var z=function(se){if(!(null===(R=se.type.misc)||void 0===R?void 0:R.sparkline))return"continue";var ae=se?.objects,ge={metadata:se.queryName};T.addContainerItem(se.queryName,se.displayName,function(be){var ye=r.FX.PropSparklinesChartType.setInstanceProperty(void 0,ae);be.addGroup("sparklines",function(me){return me.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new o.uY({descriptor:(0,W.pi)((0,W.pi)({},v.chartType),{selector:ge}),value:ye}).build()).addSimpleSlice("dataColor",new o.BT({descriptor:(0,W.pi)((0,W.pi)({},v.dataColor),{selector:ge}),value:{value:P.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,ae).solid.color}}).build()).addSimpleSlice("strokeWidth",new o.JN({descriptor:(0,W.pi)((0,W.pi)({},v.strokeWidth),{selector:ge}),value:r.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,ae),localize:p,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(we){return we.withHidden(ye!==w.U.line)})}),ye===w.U.line&&be.addGroup("markers",function(me){var we=r.FX.PropSparklinesMarkerType.getValue(ae);me.withDisplayName("Marker").addSimpleSlice("markers",new o.oM({descriptor:(0,W.pi)((0,W.pi)({},v.markers),{selector:ge}),value:we}).build()),null!=we&&0!==we&&me.addSimpleSlice("markerColor",new o.BT({descriptor:(0,W.pi)((0,W.pi)({},v.markerColor),{selector:ge}),value:{value:P.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,ae).solid.color}}).build()).addSimpleSlice("markerShape",new o.uY({descriptor:(0,W.pi)((0,W.pi)({},v.markerShape),{selector:ge}),value:r.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,ae)}).build()).addSimpleSlice("markerSize",new o.JN({descriptor:(0,W.pi)((0,W.pi)({},v.markerSize),{selector:ge}),value:r.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,ae),localize:p,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},N=0,J=u;N<J.length;N++)z(J[N])})}).build()}},f.prototype.hasSparklines=function(u){for(var i,h=0,P=u;h<P.length;h++)if(null===(i=P[h].type.misc)||void 0===i?void 0:i.sparkline)return!0;return!1},f.prototype.enumerateObjectInstances=function(u,i,h,P,p,v,b,T){void 0===v&&(v={}),void 0===b&&(b=!1),n.fF.assertValue(h,"dataView can't be undefined");var N,R=f.getMetadataObjects(h),z=this.getTablixTextClassProperties(T);switch(N=P===d.Y.Table?this.shouldShowTableTotalsOption(h)&&r.FX.PropGeneralTableTotals.getValue(R):this.shouldShowColumnSubtotalsOption(h)&&r.FX.PropGeneralMatrixColumnSubtotals.getValue(R)||this.shouldShowRowSubtotalsOption(h)&&r.FX.PropGeneralMatrixRowSubtotals.getValue(R),u.objectName){case r.FX.ObjectGeneral:this.enumerateGeneralOptions(i,R,P,h);break;case r.FX.ObjectGrid:this.enumerateGridOptions(i,R,P,z,v);break;case r.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(i,R,P,z,v);break;case r.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(i,R,P,b,z,v);break;case r.FX.ObjectValues:this.enumerateValuesOptions(i,R,P,z,v);break;case r.FX.ObjectTotal:P===d.Y.TableEx?this.enumerateTotalOptions(i,R,d.Y.TableEx,p,v,z):N&&(P===d.Y.Table?this.enumerateTotalOptions(i,R,d.Y.TableEx,p,v,z):this.enumerateGrandTotalOptions(i,R,P,z));break;case r.FX.ObjectColumnTotal:P===d.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(i,R,z,v);break;case r.FX.ObjectRowTotal:P===d.Y.PivotTable&&this.enumerateRowGrandTotalOptions(i,R,z,v);break;case r.FX.ObjectSubTotals:(N||P===d.Y.PivotTable)&&this.enumerateSubTotalsOptions(i,R,P,h,p,v,z);break;case r.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(i,this.getColumnsMetadata(h,P),P);break;case r.FX.ObjectSparklines:this.enumerateSparklines(i,this.getColumnsMetadata(h,P))}},f.prototype.getColumnsMetadata=function(u,i){switch(i){case d.Y.Table:case d.Y.TableEx:return this.getTableColumnMetadata(u);case d.Y.Matrix:case d.Y.PivotTable:return this.getMatrixValuesColumnMetadata(u);default:return void n.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+i)}},f.prototype.getTableColumnMetadata=function(u){if(u&&u.table&&!_.isEmpty(u.table.columns))return u.table.columns},f.prototype.getMatrixRowsColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.rows)){for(var i=[],h=0,P=u.matrix.rows.levels;h<P.length;h++)for(var v=0,b=P[h].sources;v<b.length;v++)i.push(b[v]);return i}},f.prototype.getMatrixColumnsColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.columns)){for(var i=[],h=0,P=u.matrix.columns.levels;h<P.length;h++)for(var v=0,b=P[h].sources;v<b.length;v++)i.push(b[v]);return i}},f.prototype.getMatrixValuesColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.valueSources))return u.matrix.valueSources},f.prototype.createVisualObjectInstance=function(u,i,h){void 0===i&&(i=null);var P={selector:i,objectName:u,properties:{}};return null!=h&&(P.displayName=h),P},f.prototype.enumerateGeneralOptions=function(u,i,h,P){var p=this.createVisualObjectInstance(r.FX.ObjectGeneral);switch(h){case d.Y.Table:r.FX.PropGeneralAutoSizeColumns.setInstanceProperty(p,i),r.FX.PropGeneralTextSize.setInstanceProperty(p,i),this.shouldShowTableTotalsOption(P)&&r.FX.PropGeneralTableTotals.setInstanceProperty(p,i);break;case d.Y.Matrix:r.FX.PropGeneralAutoSizeColumns.setInstanceProperty(p,i),r.FX.PropGeneralTextSize.setInstanceProperty(p,i),this.shouldShowRowSubtotalsOption(P)&&r.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(p,i),this.shouldShowColumnSubtotalsOption(P)&&r.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(p,i)}u.pushInstance(p)},f.prototype.enumerateGridOptions=function(u,i,h,P,p){var v=this.createVisualObjectInstance(r.FX.ObjectGrid),b=P.labelFontProperties.size&&P.labelFontProperties.size.pt,T=r.FX.PropGridVertical.getValue(i);r.FX.PropGridVertical.setInstanceProperty(v,i),T&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(v,i),r.FX.PropGridVerticalWeight.setInstanceProperty(v,i));var R=h===d.Y.Table||h===d.Y.TableEx,z=(R?r.FX.PropGridHorizontalTable:r.FX.PropGridHorizontalMatrix).getValue(i);(R?r.FX.PropGridHorizontalTable:r.FX.PropGridHorizontalMatrix).setInstanceProperty(v,i),z&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(v,i),r.FX.PropGridHorizontalWeight.setInstanceProperty(v,i)),r.FX.PropGridRowPadding.setInstanceProperty(v,i),(h===d.Y.PivotTable||h===d.Y.TableEx)&&r.FX.PropGridOutlineStyle.setInstanceProperty(v,i,this.outlineOverrideFn,r.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(v,i),r.FX.PropGridOutlineWeight.setInstanceProperty(v,i),(h===d.Y.PivotTable||h===d.Y.TableEx)&&r.FX.PropGridPivotTableTextSize.setInstanceProperty(v,i,P.fontSizeOverrideFn,b),r.FX.PropGridImageHeight.setInstanceProperty(v,i),u.pushInstance(v)},f.prototype.enumerateColumnHeadersOptions=function(u,i,h,P,p){var v=this.createVisualObjectInstance(r.FX.ObjectColumnHeaders),b=P.labelFontProperties.size&&P.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(v,i,P.fontColorOverrideFn,P.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(v,i),h===d.Y.PivotTable||h===d.Y.TableEx){var R=this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(i),i,r.UR);r.FX.PropColumnsOutlineStyle.setInstanceProperty(v,i,this.outlineOverrideFn,R);var z=this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(i),i);r.FX.PropColumnsOutlineWeight.setInstanceProperty(v,i,this.outlineOverrideFn,z);var N=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(i),i);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(v,i,this.outlineOverrideFn,N),r.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(v,i),r.FX.PropColumnsFontFamily.setInstanceProperty(v,i,P.fontFamilyOverrideFn,P.labelFontProperties.family),r.FX.PropColumnsFontSize.setInstanceProperty(v,i,P.fontSizeOverrideFn,b),r.FX.PropColumnsBold.setInstanceProperty(v,i),r.FX.PropColumnsItalic.setInstanceProperty(v,i),r.FX.PropColumnsUnderline.setInstanceProperty(v,i),r.FX.PropColumnsAlignment.setInstanceProperty(v,i)}else r.FX.PropColumnsOutline.setInstanceProperty(v,i);h===d.Y.PivotTable&&(r.FX.PropColumnsAlignmentTitle.setInstanceProperty(v,i),r.FX.PropColumnsUrlIcon.setInstanceProperty(v,i)),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&r.FX.PropColumnsWordWrap.setInstanceProperty(v,i),u.pushInstance(v)},f.prototype.enumerateRowHeadersOptions=function(u,i,h,P,p,v){void 0===P&&(P=!1);var b=this.createVisualObjectInstance(r.FX.ObjectRowHeaders),T=p.labelFontProperties.size&&p.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(b,i,p.fontColorOverrideFn,p.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(b,i),h===d.Y.PivotTable||h===d.Y.TableEx){var z=this.ensureOutline(r.FX.PropRowsOutlineStyle.getValue(i),i,r.Pi);r.FX.PropRowsOutlineStyle.setInstanceProperty(b,i,this.outlineOverrideFn,z)}else r.FX.PropRowsOutline.setInstanceProperty(b,i);if(h===d.Y.PivotTable){var N=this.ensureOutlineWeight(r.FX.PropRowsOutlineWeight.getValue(i),i);r.FX.PropRowsOutlineWeight.setInstanceProperty(b,i,this.outlineOverrideFn,N);var J=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(i),i);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(b,i,this.outlineOverrideFn,J),r.FX.PropRowsSteppedLayout.setInstanceProperty(b,i)&&r.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(b,i),r.FX.PropRowsUrlIcon.setInstanceProperty(b,i),r.FX.PropGeneralMatrixLayout.setInstanceProperty(b,i)!==g.t.Compact&&r.FX.PropRowsRepeatRowHeaders.setInstanceProperty(b,i)}(h===d.Y.Matrix||h===d.Y.PivotTable)&&r.FX.PropRowsWordWrap.setInstanceProperty(b,i),(h===d.Y.PivotTable||h===d.Y.TableEx)&&(r.FX.PropRowsFontFamily.setInstanceProperty(b,i,p.fontFamilyOverrideFn,p.labelFontProperties.family),r.FX.PropRowsFontSize.setInstanceProperty(b,i,p.fontSizeOverrideFn,T),r.FX.PropRowsBold.setInstanceProperty(b,i),r.FX.PropRowsItalic.setInstanceProperty(b,i),r.FX.PropRowsUnderline.setInstanceProperty(b,i),r.FX.PropRowsAlignment.setInstanceProperty(b,i)),h===d.Y.PivotTable&&P&&(r.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(b,i),r.FX.PropRowsShowExpandCollapseButtons.getValue(i)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(b,i),r.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(b,i))),u.pushInstance(b)},f.prototype.enumerateValuesOptions=function(u,i,h,P,p){var v=this.createVisualObjectInstance(r.FX.ObjectValues),b=P.labelFontProperties.size&&P.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(v,i,P.fontColorOverrideFn,P.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(v,i),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(v,i),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(v,i),h===d.Y.PivotTable&&(r.FX.PropValuesBandedRowHeaders.setInstanceProperty(v,i),r.FX.PropValuesOnRow.setInstanceProperty(v,i)),h===d.Y.PivotTable||h===d.Y.TableEx){var R=this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(i),i,r.IC);r.FX.PropValuesOutlineStyle.setInstanceProperty(v,i,this.outlineOverrideFn,R);var z=this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(i),i);r.FX.PropValuesOutlineWeight.setInstanceProperty(v,i,this.outlineOverrideFn,z);var N=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(i),i);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(v,i,this.outlineOverrideFn,N)}else r.FX.PropValuesOutline.setInstanceProperty(v,i);(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&r.FX.PropValuesUrlIcon.setInstanceProperty(v,i),(h===d.Y.PivotTable||h===d.Y.TableEx)&&(r.FX.PropValuesWordWrap.setInstanceProperty(v,i),r.FX.PropValuesFontFamily.setInstanceProperty(v,i,P.fontFamilyOverrideFn,P.labelFontProperties.family),r.FX.PropValuesFontSize.setInstanceProperty(v,i,P.fontSizeOverrideFn,b),r.FX.PropValuesBold.setInstanceProperty(v,i),r.FX.PropValuesItalic.setInstanceProperty(v,i),r.FX.PropValuesUnderline.setInstanceProperty(v,i)),u.pushInstance(v)},f.prototype.enumerateTotalOptions=function(u,i,h,P,p,v){var b=this.createVisualObjectInstance(r.FX.ObjectTotal),T=v.boldLabelFontProperties.size&&v.boldLabelFontProperties.size.pt;if(h!==d.Y.TableEx||r.FX.PropTotalTableExTotals.setInstanceProperty(b,i)){if(h===d.Y.TableEx){var z=r.FX.PropTotalTableExTotalLabel.getValue(i,!0)||P(S.qT);b.properties[r.FX.PropTotalTableExTotalLabel.propertyName]=z}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(b,i,v.fontColorOverrideFn,v.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(b,i),h===d.Y.PivotTable||h===d.Y.TableEx){var J=this.ensureOutline(r.FX.PropTotalOutlineStyle.getValue(i),i,r.Sc);r.FX.PropTotalOutlineStyle.setInstanceProperty(b,i,this.outlineOverrideFn,J)}else r.FX.PropTotalOutline.setInstanceProperty(b,i);if(h===d.Y.TableEx){var oe=this.ensureOutlineWeight(r.FX.PropTotalOutlineWeight.getValue(i),i);r.FX.PropTotalOutlineWeight.setInstanceProperty(b,i,this.outlineOverrideFn,oe);var pe=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(i),i);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(b,i,this.outlineOverrideFn,pe)}(h===d.Y.PivotTable||h===d.Y.TableEx)&&(r.FX.PropTotalFontFamily.setInstanceProperty(b,i,v.fontFamilyOverrideFn,v.boldLabelFontProperties.family),r.FX.PropTotalFontSize.setInstanceProperty(b,i,v.fontSizeOverrideFn,T),r.FX.PropTotalBold.setInstanceProperty(b,i),r.FX.PropTotalItalic.setInstanceProperty(b,i),r.FX.PropTotalUnderline.setInstanceProperty(b,i))}u.pushInstance(b)},f.prototype.enumerateGrandTotalOptions=function(u,i,h,P){if(h!==d.Y.PivotTable){var p=this.createVisualObjectInstance(r.FX.ObjectTotal),v=P.boldLabelFontProperties.size&&P.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(p,i,P.fontColorOverrideFn,P.boldLabelFontProperties.color),r.FX.PropGrandTotalFontFamily.setInstanceProperty(p,i),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(p,i),r.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(p,i),h===d.Y.TableEx&&(r.FX.PropGrandTotalFontFamily.setInstanceProperty(p,i,P.fontFamilyOverrideFn,P.boldLabelFontProperties.family),r.FX.PropGrandTotalFontSize.setInstanceProperty(p,i,P.fontSizeOverrideFn,v),r.FX.PropGrandTotalBold.setInstanceProperty(p,i),r.FX.PropGrandTotalItalic.setInstanceProperty(p,i),r.FX.PropGrandTotalUnderline.setInstanceProperty(p,i)),u.pushInstance(p)}},f.prototype.enumerateColumnGrandTotalOptions=function(u,i,h,P){var p=this.createVisualObjectInstance(r.FX.ObjectColumnTotal),v=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(p,i,h.fontColorOverrideFn,h.boldLabelFontProperties.color),r.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(p,i),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(p,i),r.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(p,i),r.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(p,i,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family),r.FX.PropColumnGrandTotalFontSize.setInstanceProperty(p,i,h.fontSizeOverrideFn,v),r.FX.PropColumnGrandTotalBold.setInstanceProperty(p,i),r.FX.PropColumnGrandTotalItalic.setInstanceProperty(p,i),r.FX.PropColumnGrandTotalUnderline.setInstanceProperty(p,i),u.pushInstance(p)},f.prototype.enumerateRowGrandTotalOptions=function(u,i,h,P){var p=this.createVisualObjectInstance(r.FX.ObjectRowTotal),v=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(p,i,h.fontColorOverrideFn,h.boldLabelFontProperties.color),r.FX.PropRowGrandTotalFontFamily.setInstanceProperty(p,i),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(p,i),r.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(p,i),r.FX.PropRowGrandTotalFontFamily.setInstanceProperty(p,i,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family),r.FX.PropRowGrandTotalFontSize.setInstanceProperty(p,i,h.fontSizeOverrideFn,v),r.FX.PropRowGrandTotalBold.setInstanceProperty(p,i),r.FX.PropRowGrandTotalItalic.setInstanceProperty(p,i),r.FX.PropRowGrandTotalUnderline.setInstanceProperty(p,i),u.pushInstance(p)},f.prototype.enumerateSubTotalsOptions=function(u,i,h,P,p,v,b){var z,N,J,T=!1,R=!1;if(h===d.Y.PivotTable){n.fF.assertValue(p,"enumerateSubTotalsOptions - localizer"),z=p(S.qT);var oe=this.createVisualObjectInstance(r.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(P)&&(T=r.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(oe,i)),T&&(N=r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(i,!0)||z,oe.properties[r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=N),u.pushInstance(oe)}if(this.enumerateSubtotalsFontProperties(u,i,b,v,h,"Row"),T){oe=this.createVisualObjectInstance(r.FX.ObjectSubTotals),r.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(oe,i),u.pushInstance(oe),oe=this.createVisualObjectInstance(r.FX.ObjectSubTotals);var pe=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(oe,i);u.pushInstance(oe,!1),pe&&this.enumeratePerLevelSubtotals(u,P.matrix.rows.levels,N,p)}h===d.Y.PivotTable&&(oe=this.createVisualObjectInstance(r.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(P)&&(R=r.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(oe,i)),R&&(J=r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(i,!0)||z,oe.properties[r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=J),u.pushInstance(oe,!1)),this.enumerateSubtotalsFontProperties(u,i,b,v,h,"Column"),R&&(oe=this.createVisualObjectInstance(r.FX.ObjectSubTotals),pe=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(oe,i),u.pushInstance(oe,!1),n.fF.assert(function(){return!_.isEmpty(P.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),pe&&this.enumeratePerLevelSubtotals(u,P.matrix.columns.levels,J,p))},f.prototype.enumerateSubtotalsFontProperties=function(u,i,h,P,p,v){var T=this.createVisualObjectInstance(r.FX.ObjectSubTotals,v?{id:v}:void 0),R=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(T,i,h.fontColorOverrideFn,h.boldLabelFontProperties.color,v),r.FX.PropSubTotalsFontFamily.setInstanceProperty(T,i,void 0,void 0,v),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(T,i,void 0,void 0,v),p===d.Y.PivotTable&&(r.FX.PropSubTotalsFontFamily.setInstanceProperty(T,i,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family,v),r.FX.PropSubTotalsFontSize.setInstanceProperty(T,i,h.fontSizeOverrideFn,R,v),r.FX.PropSubTotalsBold.setInstanceProperty(T,i,void 0,void 0,v),r.FX.PropSubTotalsItalic.setInstanceProperty(T,i,void 0,void 0,v),r.FX.PropSubTotalsUnderline.setInstanceProperty(T,i,void 0,void 0,v),r.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(T,i,void 0,void 0,v)),u.pushInstance(T)},f.prototype.enumeratePerLevelSubtotals=function(u,i,h,P){n.fF.assert(function(){return!_.isEmpty(i)},"enumeratePerLevelSubtotals: Empty levels");for(var p=0,v=i;p<v.length;p++)for(var T=0,R=v[p].sources;T<R.length;T++){var z=R[T];if(!z.isMeasure){var N=this.createVisualObjectInstance(r.FX.ObjectSubTotals,{metadata:z.queryName},z.displayName);r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(N,z.objects),u.pushInstance(N,!1),N=this.createVisualObjectInstance(r.FX.ObjectSubTotals,{metadata:z.queryName},P("Visual_PivotTable_TotalLabel",z.displayName));var J=r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(z.objects,!0)||h;N.properties[r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=J,u.pushInstance(N,!1)}}},f.prototype.enumerateColumnFormattingOptions=function(u,i,h){if(!_.isEmpty(i))for(var P=0,p=i;P<p.length;P++){var v=p[P];u.pushContainer({displayName:v.displayName});var b=v&&v.objects,T=this.createVisualObjectInstance(r.FX.ObjectColumnFormatting,{metadata:v.queryName});v.type.numeric&&(h===d.Y.PivotTable||h===d.Y.TableEx)&&(r.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(T,b),r.FX.PropColumnFormattingPrecision.setInstanceProperty(T,b),r.FX.PropColumnFormattingPrecision.setInstanceValidValues(T,{numberRange:{min:0,max:Z.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(T,b),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(T,b),(h===d.Y.PivotTable||h===d.Y.TableEx)&&r.FX.PropColumnFormattingAlignment.setInstanceProperty(T,b),r.FX.PropColumnFormattingStyleHeader.setInstanceProperty(T,b),r.FX.PropColumnFormattingStyleValues.setInstanceProperty(T,b),(h===d.Y.Matrix||h===d.Y.PivotTable)&&r.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(T,b),r.FX.PropColumnFormattingStyleTotal.setInstanceProperty(T,b),u.pushInstance(T),u.popContainer()}},f.prototype.enumerateSparklines=function(u,i){var h;if(!_.isEmpty(i))for(var P=0,p=i;P<p.length;P++){var v=p[P];if(null===(h=v.type.misc)||void 0===h?void 0:h.sparkline){u.pushContainer({displayName:v.displayName});var T=v&&v.objects,R=this.createVisualObjectInstance(r.FX.ObjectSparklines,{metadata:v.queryName});if(r.FX.PropSparklinesChartType.setInstanceProperty(R,T),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(R,T),r.FX.PropSparklinesChartType.getValue(T)===w.U.line){r.FX.PropSparklinesStrokeWidth.setInstanceProperty(R,T),r.FX.PropSparklinesStrokeWidth.setInstanceValidValues(R,{numberRange:{min:1,max:4}}),r.FX.PropSparklinesMarkerType.setInstanceProperty(R,T);var z=r.FX.PropSparklinesMarkerType.getValue(T);null!=z&&0!==z&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(R,T),r.FX.PropSparklinesMarkerSize.setInstanceProperty(R,T),r.FX.PropSparklinesMarkerSize.setInstanceValidValues(R,{numberRange:{min:3,max:5}}),r.FX.PropSparklinesMarkerShape.setInstanceProperty(R,T))}u.pushInstance(R),u.popContainer()}}},f.prototype.getTableObjects=function(u){var i=f.getMetadataObjects(u),h=r.FX.PropGeneralTextSize.getValue(i),P=null!=h?K.B.createFromPt(+h):void 0,p={general:{autoSizeColumnWidth:r.FX.PropGeneralAutoSizeColumns.getValue(i),textSize:P,totals:r.FX.PropGeneralTableTotals.getValue(i)}};p.grid={gridVertical:r.FX.PropGridVertical.getValue(i),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(i),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(i),gridHorizontal:r.FX.PropGridHorizontalTable.getValue(i),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(i),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(i),outlineWeight:r.FX.PropGridOutlineWeight.getValue(i),rowPadding:r.FX.PropGridRowPadding.getValue(i),imageHeight:r.FX.PropGridImageHeight.getValue(i)},p.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(i),backColor:this.tablixProperties.PropColumnsBackColor.getValue(i),outline:r.FX.PropColumnsOutline.getValue(i),wordWrap:r.FX.PropColumnsWordWrap.getValue(i)},p.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(i),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(i),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(i),outline:r.FX.PropValuesOutline.getValue(i),urlIcon:r.FX.PropValuesUrlIcon.getValue(i)},p.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(i),backColor:this.tablixProperties.PropTotalBackColor.getValue(i),outline:r.FX.PropTotalOutline.getValue(i)},p.columnFormatting={},p.formatters={};var v=this.getTableColumnMetadata(u);if(v)for(var b=0,T=v;b<T.length;b++){var R=T[b],z=R&&R.objects;p.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(z),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(z),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(z),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(z),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(z)},p.formatters[R.queryName]=new m.g({column:R,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1})}return p},f.prototype.getMatrixObjects=function(u){var i=f.getMetadataObjects(u),h=r.FX.PropGeneralTextSize.getValue(i),P=null!=h?K.B.createFromPt(+h):void 0,p={general:{autoSizeColumnWidth:r.FX.PropGeneralAutoSizeColumns.getValue(i),textSize:P,rowSubtotals:r.FX.PropGeneralMatrixRowSubtotals.getValue(i),columnSubtotals:r.FX.PropGeneralMatrixColumnSubtotals.getValue(i),layout:r.FX.PropGeneralMatrixLayout.getValue(i)}};p.grid={gridVertical:r.FX.PropGridVertical.getValue(i),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(i),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(i),gridHorizontal:r.FX.PropGridHorizontalMatrix.getValue(i),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(i),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(i),outlineWeight:r.FX.PropGridOutlineWeight.getValue(i),rowPadding:r.FX.PropGridRowPadding.getValue(i),imageHeight:r.FX.PropGridImageHeight.getValue(i)},p.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(i),backColor:this.tablixProperties.PropColumnsBackColor.getValue(i),outline:r.FX.PropColumnsOutline.getValue(i)},p.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(i),backColor:this.tablixProperties.PropRowsBackColor.getValue(i),outline:r.FX.PropRowsOutline.getValue(i),wordWrap:r.FX.PropRowsWordWrap.getValue(i),repeatRowHeaders:r.FX.PropRowsRepeatRowHeaders.getValue(i)},p.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(i),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(i),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(i),outline:r.FX.PropValuesOutline.getValue(i)},p.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(i),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(i),applyToHeaders:r.FX.PropGrandTotalApplyToHeaders.getValue(i)},p.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(i),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(i)},p.columnFormatting={},p.formatters={};var v=this.getMatrixValuesColumnMetadata(u);if(v)for(var b=0,T=v;b<T.length;b++){var R=T[b],z=R&&R.objects;p.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(z),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(z),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(z),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(z),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(z),styleSubTotals:r.FX.PropColumnFormattingStyleSubtotals.getValue(z)},p.formatters[R.queryName]=new m.g({column:R,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(u.matrix.rows,p.formatters),this.addMatrixHierarchyColumnsFormatters(u.matrix.columns,p.formatters),p},f.prototype.addMatrixHierarchyColumnsFormatters=function(u,i,h){if(u){n.fF.assertValue(u.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var P=0,p=u.levels;P<p.length;P++){var v=p[P];n.fF.assertValue(v.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var b=0,T=v.sources;b<T.length;b++){var R=T[b];if(!R.isMeasure){var z=R.queryName;i[z]=new m.g({column:R,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1}),h&&(h[z]=new m.g({column:R,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},f.prototype.addMatrixHierarchySubtotalLabels=function(u,i,h,P){if(u){n.fF.assertValue(u.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var p=0,v=u.levels;p<v.length;p++){var b=v[p];n.fF.assertValue(b.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var T=void 0,R=0,z=b.sources;R<z.length;R++){var N=z[R];N.isMeasure||(P&&(T=r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(N.objects)),T||(T=h),i[N.queryName]={subtotalLabel:T})}}}},f.prototype.getPivotTableObjects=function(u,i,h,P,p,v){var b,T,R,z,N,J,oe,pe,se;void 0===v&&(v=!1);var A=f.getMetadataObjects(u),ae=this.getTablixTextClassProperties(P),ge=ae.labelFontProperties.size&&ae.labelFontProperties.size.pt,be=ae.boldLabelFontProperties.size&&ae.boldLabelFontProperties.size.pt,ye=r.FX.PropGridPivotTableTextSize.getValue(A,void 0,ae.fontSizeOverrideFn,ge),me=null!=ye?K.B.createFromPt(+ye):void 0,we=r.FX.PropColumnsFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,ge),Re=null!=we?K.B.createFromPt(+we):void 0,ee=r.FX.PropRowsFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,ge),a=null!=ee?K.B.createFromPt(+ee):void 0,x=r.FX.PropRowsExpandCollapseButtonsSize.getValue(A),V=null!=x?K.B.createFromPt(+x):void 0,G=r.FX.PropRowsExpandCompositeHierarchy.getValue(A),D=r.FX.PropValuesFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,ge),j=null!=D?K.B.createFromPt(+D):void 0,C=r.FX.PropGrandTotalFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be),O=(null!=C&&K.B.createFromPt(+C),r.FX.PropColumnGrandTotalFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be,void 0,["Column"])),U=null!=O?K.B.createFromPt(+O):void 0,Q=r.FX.PropRowGrandTotalFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be,void 0,["Row"]),he=null!=Q?K.B.createFromPt(+Q):void 0,ve=r.FX.PropSubTotalsFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be),xe=(null!=ve&&K.B.createFromPt(+ve),r.FX.PropSubTotalsFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be,"Row")),Ce=null!=xe?K.B.createFromPt(+xe):void 0,Pe=r.FX.PropSubTotalsFontSize.getValue(A,void 0,ae.fontSizeOverrideFn,be,"Column"),Le=null!=Pe?K.B.createFromPt(+Pe):void 0,Oe=i(S.qT),Ne=r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(A)||Oe,Me=r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(A)||Oe,He=r.FX.PropRowsSteppedLayout.getValue(A),Ie=r.FX.PropGeneralMatrixLayout.getValue(A)||(He?g.t.Compact:g.t.Outline);p.matrixLayouts&&(He=Ie===g.t.Compact);var Be={showBlankRows:r.FX.PropBlankRowsShowBlankRows.getValue(A),blankRowColor:null!==(b=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(A))&&void 0!==b?b:this.tablixProperties.PropValuesBackColorPrimary.getValue(A),blankRowTransparency:r.FX.PropBlankRowsTransparency.getValue(A),showBorder:r.FX.PropBlankRowsShowBorder.getValue(A),borderPosition:null!==(T=r.FX.PropBlankRowsBorderPosition.getValue(A))&&void 0!==T?T:"Top",borderColor:null!==(R=this.tablixProperties.PropBlankRowsBorderColor.getValue(A))&&void 0!==R?R:P.colorPalette.foregroundNeutralSecondary.value,borderTransparency:r.FX.PropBlankRowsBorderTransparency.getValue(A),borderWidth:r.FX.PropBlankRowsBorderWidth.getValue(A)},ze={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.boldLabelFontProperties.color,"Row"),fontFamily:r.FX.PropSubTotalsFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.boldLabelFontProperties.family,"Row"),fontSize:Ce,bold:r.FX.PropSubTotalsBold.getValue(A,void 0,void 0,void 0,"Row"),italic:r.FX.PropSubTotalsItalic.getValue(A,void 0,void 0,void 0,"Row"),underline:r.FX.PropSubTotalsUnderline.getValue(A,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(A,void 0,void 0,void 0,"Row"),applyToHeaders:r.FX.PropSubTotalsApplyToHeaders.getValue(A,void 0,void 0,void 0,"Row")},_e={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.boldLabelFontProperties.color,"Column"),fontFamily:r.FX.PropSubTotalsFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.boldLabelFontProperties.family,"Column"),fontSize:Le,bold:r.FX.PropSubTotalsBold.getValue(A,void 0,void 0,void 0,"Column"),italic:r.FX.PropSubTotalsItalic.getValue(A,void 0,void 0,void 0,"Column"),underline:r.FX.PropSubTotalsUnderline.getValue(A,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(A,void 0,void 0,void 0,"Column"),applyToHeaders:r.FX.PropSubTotalsApplyToHeaders.getValue(A,void 0,void 0,void 0,"Column")},De={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:r.FX.PropColumnGrandTotalFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.boldLabelFontProperties.family,void 0,["Column"]),fontSize:U,bold:r.FX.PropColumnGrandTotalBold.getValue(A),italic:r.FX.PropColumnGrandTotalItalic.getValue(A),underline:r.FX.PropColumnGrandTotalUnderline.getValue(A),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(A),applyToHeaders:r.FX.PropColumnGrandTotalApplyToHeaders.getValue(A)},Ae={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:r.FX.PropRowGrandTotalFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.boldLabelFontProperties.family,void 0,["Row"]),fontSize:he,bold:r.FX.PropRowGrandTotalBold.getValue(A),italic:r.FX.PropRowGrandTotalItalic.getValue(A),underline:r.FX.PropRowGrandTotalUnderline.getValue(A),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(A),applyToHeaders:r.FX.PropRowGrandTotalApplyToHeaders.getValue(A)},Te={general:{autoSizeColumnWidth:r.FX.PropColumnPivotTableAutoSizeColumns.getValue(A),textSize:me,rowSubtotals:r.FX.PropSubTotalsPivotTableRowSubtotals.getValue(A),columnSubtotals:r.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(A),layout:Ie},grid:{gridVertical:r.FX.PropGridVertical.getValue(A),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(A),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(A),gridHorizontal:r.FX.PropGridHorizontalMatrix.getValue(A),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(A),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(A),outline:r.FX.PropGridOutlineStyle.getValue(A)||r.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(A),outlineWeight:r.FX.PropGridOutlineWeight.getValue(A),rowPadding:r.FX.PropGridRowPadding.getValue(A),imageHeight:r.FX.PropGridImageHeight.getValue(A),imageWidth:r.FX.PropGridImageWidth.getValue(A)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.labelFontProperties.color),fontFamily:r.FX.PropColumnsFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.labelFontProperties.family),fontSize:Re,bold:r.FX.PropColumnsBold.getValue(A),italic:r.FX.PropColumnsItalic.getValue(A),underline:r.FX.PropColumnsUnderline.getValue(A),backColor:this.tablixProperties.PropColumnsBackColor.getValue(A),outline:this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(A),A,r.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(A),A),outlineWeight:this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(A),A),urlIcon:r.FX.PropColumnsUrlIcon.getValue(A),wordWrap:r.FX.PropColumnsWordWrap.getValue(A),alignment:r.FX.PropColumnsAlignment.getValue(A),titleAlignment:r.FX.PropColumnsAlignmentTitle.getValue(A)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(A,void 0,ae.fontColorOverrideFn,ae.labelFontProperties.color),fontFamily:r.FX.PropRowsFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.labelFontProperties.family),fontSize:a,bold:r.FX.PropRowsBold.getValue(A),italic:r.FX.PropRowsItalic.getValue(A),underline:r.FX.PropRowsUnderline.getValue(A),backColor:this.tablixProperties.PropRowsBackColor.getValue(A),outline:this.ensureOutline(r.FX.PropRowsOutlineStyle.getValue(A),A,r.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(A),A),outlineWeight:this.ensureOutlineWeight(r.FX.PropRowsOutlineWeight.getValue(A),A),steppedLayout:He,steppedLayoutIndentation:r.FX.PropRowsSteppedLayoutIndentation.getValue(A),urlIcon:r.FX.PropRowsUrlIcon.getValue(A),wordWrap:r.FX.PropRowsWordWrap.getValue(A),alignment:r.FX.PropRowsAlignment.getValue(A),showExpandCollapseButtons:!!h&&r.FX.PropRowsShowExpandCollapseButtons.getValue(A),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(A),expandCollapseButtonsSize:V,expandCompositeHierarchy:G,repeatRowHeaders:r.FX.PropRowsRepeatRowHeaders.getValue(A),legacyStyleDisabled:r.FX.PropRowsLegacyStyleDisabled.getValue(A)},values:{fontFamily:r.FX.PropValuesFontFamily.getValue(A,void 0,ae.fontFamilyOverrideFn,ae.labelFontProperties.family),fontSize:j,bold:r.FX.PropValuesBold.getValue(A),italic:r.FX.PropValuesItalic.getValue(A),underline:r.FX.PropValuesUnderline.getValue(A),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(A,void 0,ae.fontColorOverrideFn,ae.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(A),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(A),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(A),bandedRowHeaders:r.FX.PropValuesBandedRowHeaders.getValue(A),outline:this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(A),A,r.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(A),A),outlineWeight:this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(A),A),urlIcon:r.FX.PropValuesUrlIcon.getValue(A),wordWrap:r.FX.PropValuesWordWrap.getValue(A),valuesOnRow:r.FX.PropValuesOnRow.getValue(A)},columnGrandTotal:De,rowGrandTotal:Ae,subtotals:{rowSubtotalsPosition:Ie===g.t.Tabular?y.I:r.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(A),rowSubtotalsLabel:Ne,columnSubtotalsLabel:Me},rowSubtotals:ze,columnSubtotals:_e,blankRows:Be,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ge=this.getMatrixValuesColumnMetadata(u);if(Ge)for(var Xe=0,ke=Ge;Xe<ke.length;Xe++){var We=ke[Xe],Ee=We&&We.objects;Te.columnFormatting[We.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(Ee),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(Ee),alignment:r.FX.PropColumnFormattingAlignment.getValue(Ee),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(Ee),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(Ee),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(Ee),styleSubTotals:r.FX.PropColumnFormattingStyleSubtotals.getValue(Ee),dataBarsSettings:r.FX.PropColumnFormattingDataBars.getValue(Ee),icon:r.FX.PropValuesIcon.getValue(Ee)};var Ue=void 0,Ke=void 0;if(We.type.numeric&&(Ue=r.FX.PropColumnFormattingDisplayUnits.getValue(Ee),Ke=r.FX.PropColumnFormattingPrecision.getValue(Ee)),Te.formatters[We.queryName]=new m.g({column:We,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Ue,precision:Ke,trailingZeroes:!0}),Te.tooltipFormatters[We.queryName]=new m.g({column:We,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Ue,precision:Ke,trailingZeroes:!0}),null!==(z=We.type.misc)&&void 0!==z&&z.sparkline){var Je=r.FX.PropSparklinesChartType.getValue(Ee),Qe=new s(We.displayName,We.type,i);Te.formatters[We.queryName]=Qe,Te.tooltipFormatters[We.queryName]=Qe,Te.sparklines[We.queryName]={chartType:Je,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(Ee).solid.color,strokeWidth:r.FX.PropSparklinesStrokeWidth.getValue(Ee),marker:{show:!0,typeFlags:r.FX.PropSparklinesMarkerType.getValue(Ee),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(Ee).solid.color,size:r.FX.PropSparklinesMarkerSize.getValue(Ee),shape:r.FX.PropSparklinesMarkerShape.getValue(Ee)}}}}v&&(Te.annotationFormatting={columnHeaders:{}},_.forEach(null===(N=u.metadata)||void 0===N?void 0:N.columns,function(je){var Ze;if(null!==(Ze=je.objects)&&void 0!==Ze&&Ze.annotations){var Ye=(0,B.NA)(je.objects,fe.t.annotations.highlights);Ye&&(null!=Ye.backColor||!0===Ye.emphasizeText)&&(Te.annotationFormatting.columnHeaders[je.queryName]={backColor:Ye.backColor,bold:Ye.emphasizeText})}}),_.isEmpty(Te.annotationFormatting.columnHeaders)&&(Te.annotationFormatting=void 0));var $e=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(A),qe=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(A);return this.addMatrixHierarchySubtotalLabels(null===(J=u?.matrix)||void 0===J?void 0:J.rows,Te.columnFormatting,Ne,$e),this.addMatrixHierarchySubtotalLabels(null===(oe=u?.matrix)||void 0===oe?void 0:oe.columns,Te.columnFormatting,Me,qe),this.addMatrixHierarchyColumnsFormatters(null===(pe=u?.matrix)||void 0===pe?void 0:pe.rows,Te.formatters,Te.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(se=u?.matrix)||void 0===se?void 0:se.columns,Te.formatters,Te.tooltipFormatters),Te},f.prototype.getTableExObjects=function(u,i,h,P){var p,v=f.getMetadataObjects(u),b=this.getTablixTextClassProperties(h),T=b.labelFontProperties.size&&b.labelFontProperties.size.pt,R=b.boldLabelFontProperties.size&&b.boldLabelFontProperties.size.pt,z=r.FX.PropGridPivotTableTextSize.getValue(v),N=null!=z?K.B.createFromPt(+z):void 0,J=r.FX.PropColumnsFontSize.getValue(v,void 0,b.fontSizeOverrideFn,T),oe=null!=J?K.B.createFromPt(+J):void 0,pe=r.FX.PropValuesFontSize.getValue(v,void 0,b.fontSizeOverrideFn,T),se=null!=pe?K.B.createFromPt(+pe):void 0,A=r.FX.PropTotalFontSize.getValue(v,void 0,b.fontSizeOverrideFn,R),ae=null!=A?K.B.createFromPt(+A):void 0,ge=r.FX.ProprowWithReferenceText.getValue(v),be={general:{autoSizeColumnWidth:r.FX.PropColumnPivotTableAutoSizeColumns.getValue(v),textSize:N,totals:r.FX.PropTotalTableExTotals.getValue(v)}};be.grid={gridVertical:r.FX.PropGridVertical.getValue(v),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(v),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(v),gridHorizontal:r.FX.PropGridHorizontalTable.getValue(v),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(v),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(v),outline:r.FX.PropGridOutlineStyle.getValue(v)||r.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(v),outlineWeight:r.FX.PropGridOutlineWeight.getValue(v),rowPadding:r.FX.PropGridRowPadding.getValue(v),imageHeight:r.FX.PropGridImageHeight.getValue(v),imageWidth:r.FX.PropGridImageWidth.getValue(v)},be.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(v,void 0,b.fontColorOverrideFn,b.labelFontProperties.color),fontFamily:r.FX.PropColumnsFontFamily.getValue(v,void 0,b.fontFamilyOverrideFn,b.labelFontProperties.family),fontSize:oe,bold:r.FX.PropColumnsBold.getValue(v),italic:r.FX.PropColumnsItalic.getValue(v),underline:r.FX.PropColumnsUnderline.getValue(v),backColor:this.tablixProperties.PropColumnsBackColor.getValue(v),outline:this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(v),v,r.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(v),v),wordWrap:r.FX.PropColumnsWordWrap.getValue(v),alignment:r.FX.PropColumnsAlignment.getValue(v)},be.values={fontFamily:r.FX.PropValuesFontFamily.getValue(v,void 0,b.fontFamilyOverrideFn,b.labelFontProperties.family),fontSize:se,bold:r.FX.PropValuesBold.getValue(v),italic:r.FX.PropValuesItalic.getValue(v),underline:r.FX.PropValuesUnderline.getValue(v),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(v,void 0,b.fontColorOverrideFn,b.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(v),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(v),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(v),outline:this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(v),v,r.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(v),v),urlIcon:r.FX.PropValuesUrlIcon.getValue(v),wordWrap:r.FX.PropValuesWordWrap.getValue(v)};var ye=r.FX.PropTotalTableExTotalLabel.getValue(v);be.total={totalLabel:ye||i(S.qT),totalPlaceholderLabel:i(S.bn),isDefaultTotalLabel:!ye,fontFamily:r.FX.PropTotalFontFamily.getValue(v,void 0,b.fontFamilyOverrideFn,b.boldLabelFontProperties.family),fontSize:ae,bold:r.FX.PropTotalBold.getValue(v),italic:r.FX.PropTotalItalic.getValue(v),underline:r.FX.PropTotalUnderline.getValue(v),fontColor:this.tablixProperties.PropTotalFontColor.getValue(v,void 0,b.fontColorOverrideFn,b.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(v),outline:this.ensureOutline(r.FX.PropTotalOutlineStyle.getValue(v),v,r.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(r.FX.PropTotalOutlineWeight.getValue(v),v)},be.columnFormatting={},be.formatters={},be.tooltipFormatters={},be.sparklines={};var me=this.getTableColumnMetadata(u);if(me)for(var we=0,Re=me;we<Re.length;we++){var ee=Re[we];if(ee){var a=ee.objects,x=ee.queryName;be.columnFormatting[x]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(a),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(a),alignment:r.FX.PropColumnFormattingAlignment.getValue(a),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(a),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(a),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(a),dataBarsSettings:r.FX.PropColumnFormattingDataBars.getValue(a),icon:r.FX.PropValuesIcon.getValue(a)};var V=void 0,G=void 0;if(ee.type.numeric&&(V=r.FX.PropColumnFormattingDisplayUnits.getValue(a),G=r.FX.PropColumnFormattingPrecision.getValue(a)),be.formatters[x]=new m.g({column:ee,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:V,precision:G,trailingZeroes:!0}),be.tooltipFormatters[x]=new m.g({column:ee,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:V,precision:G,trailingZeroes:!0}),null!==(p=ee.type.misc)&&void 0!==p&&p.sparkline){var D=r.FX.PropSparklinesChartType.getValue(a),j=new s(ee.displayName,ee.type,i);be.formatters[x]=j,be.tooltipFormatters[x]=j,be.sparklines[x]={chartType:D,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(a).solid.color,strokeWidth:r.FX.PropSparklinesStrokeWidth.getValue(a),marker:{show:!0,typeFlags:r.FX.PropSparklinesMarkerType.getValue(a),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(a).solid.color,size:r.FX.PropSparklinesMarkerSize.getValue(a),shape:r.FX.PropSparklinesMarkerShape.getValue(a)}}}}}return be.rowWithReferenceText={rowWithReferenceText:ge},be},f.prototype.ensureOutline=function(u,i,h){var P;return null!==(P=u??r.FX.PropGridOutlineStyle.getValue(i))&&void 0!==P?P:h},f.prototype.ensureOutlineWeight=function(u,i){return u??r.FX.PropGridOutlineWeight.getValue(i)},f.prototype.outlineOverrideFn=function(u,i){return!!(0,B.NA)(u,i)},f.prototype.ensureOutlineColor=function(u,i){return u??this.tablixProperties.PropGridOutlineColor.getValue(i)},f.getTextSizeInPx=function(u){return H.FP.toString(u.px)},f.prototype.shouldShowTableTotalsOption=function(u){return!(u&&u.table&&!_.isEmpty(u.table.columns)&&_.some(u.table.columns,function(h){return h.discourageAggregationAcrossGroups}))},f.prototype.shouldShowRowSubtotalsOption=function(u){return!(!u||(0,ne.be)(u.matrix)<1||this.isDiscourageAggregationAcrossGroups(u.matrix.rows.levels))},f.prototype.shouldShowColumnSubtotalsOption=function(u){if(!u||!u.matrix||(0,ne.pr)(u.matrix.columns)<1)return!1;var i=u.matrix.columns.levels;return u.matrix.valueSources.length>1&&(i=_.initial(i)),!this.isDiscourageAggregationAcrossGroups(i)},f.prototype.isDiscourageAggregationAcrossGroups=function(u){var i=_.last(u);return i&&_.some(i.sources,function(h){return h.discourageAggregationAcrossGroups})},f.prototype.getTablixTextClassProperties=function(u){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,de.m)(u,"label"),boldLabelFontProperties:(0,de.m)(u,"boldLabel")}},f.prototype.fontSizeOverridePredicate=function(){var u=this;return function(i,h,P){var p=(0,B.RK)(i,h.objectName),v=(0,B.RK)(i,r.FX.ObjectGrid),b=(0,B.RK)(i,r.FX.ObjectValues),T=(0,B.RK)(i,r.FX.ObjectSubTotals),R=u.gridDependentObject(h.objectName),z=(0,k.N)(v,"textSize",void 0)&&!(0,k.N)(p,h.propertyName,void 0,P),N=u.valuesDependentObject(h.objectName),J=(0,k.N)(b,"fontSize",void 0)&&!(0,k.N)(p,h.propertyName,void 0,P),oe=u.subTotalsDependentObject(h.objectName),pe=u.getSubTotalsValue(h.objectName,T,"fontSize",void 0)&&!(0,k.N)(p,h.propertyName,void 0,P),A=!!(0,k.N)(p,h.objectName===r.FX.ObjectGrid?"textSize":"fontSize",void 0,P);return R&&z||N&&J||oe&&pe||A}},f.prototype.fontFamilyOverridePredicate=function(){var u=this;return function(i,h,P){var p=(0,B.RK)(i,h.objectName),v=(0,B.RK)(i,r.FX.ObjectValues),b=(0,B.RK)(i,r.FX.ObjectSubTotals),T=u.valuesDependentObject(h.objectName),R=(0,k.N)(v,"fontFamily",void 0)&&!(0,k.N)(p,h.propertyName,void 0),z=u.subTotalsDependentObject(h.objectName),N=u.getSubTotalsValue(h.objectName,b,"fontFamily",void 0)&&!(0,k.N)(p,h.propertyName,void 0,P),J=!!(0,k.N)(p,"fontFamily",void 0,P);return T&&R||z&&N||J}},f.prototype.fontColorOverridePredicate=function(){return function(u,i,h){var P=(0,B.RK)(u,i.objectName),p=i.objectName===r.FX.ObjectValues?"fontColorPrimary":"fontColor",v=(0,k.N)(P,p);return!!(0,k.N)(P,p,v,h)}},f.prototype.gridDependentObject=function(u){return this.valuesDependentObject(u)||u===r.FX.ObjectRowHeaders||u===r.FX.ObjectColumnHeaders||u===r.FX.ObjectValues},f.prototype.valuesDependentObject=function(u){return this.subTotalsDependentObject(u)||u===r.FX.ObjectSubTotals},f.prototype.subTotalsDependentObject=function(u){return u===r.FX.ObjectTotal||u===r.FX.ObjectRowTotal||u===r.FX.ObjectColumnTotal},f.prototype.getSubTotalsValue=function(u,i,h,P){var p=u===r.FX.ObjectRowTotal?"Row":u===r.FX.ObjectColumnTotal?"Column":void 0;return P=P??(0,k.N)(i,h),(0,k.N)(i,h,P,p)},f.ImageSizeMin=8,f.ImageSizeMax=512,f}(),s=function(){function f(u,i,h){this.displayName=u,this.sparklineType=i,this.localizer=h}return f.prototype.format=function(u,i){var h=function(f,u,i){if(i){var h=i.points;if(h=_.filter(h,function(oe){return null!=oe.x&&null!=oe.y}),!_.isEmpty(h)){var P=_.size(h);if(1===P)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[f,i.lowY]};var p=u.misc.sparkline.groupingType;if(p&&(p.numeric||p.dateTime||p.temporal)){var b=h[0].y,T=h[P-1].y;if(!_.some(h,function(oe){return oe.y!==b}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[f,b]};if((0,re.JM)(_.map(h,function(oe){return oe.x}),_.map(h,function(oe){return oe.y}),!0).rSquared>.5){var J,N="Sparkline_Tooltip_ScalarTrend";return N+=T>b?"Up":"Down",0!==b?(J=100*(T-b)/b,N+="Percent"):(J=T-b,N+="Value"),{key:N,parameters:[f,+Math.abs(J).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[f,i.lowY,i.highY]}}return i.lowY===i.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[f,i.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[f,i.lowY,i.highY]}}}}(this.displayName,this.sparklineType,u);if(h)return this.localizer.apply(this,(0,W.ev)([h.key],h.parameters,!1))},f}()},91468:function(Ve,Fe,X){X.d(Fe,{CQ:function(){return d},D2:function(){return y},JT:function(){return E},K2:function(){return k},Km:function(){return l},Kq:function(){return v},MO:function(){return q},Nk:function(){return P},Od:function(){return i},Ps:function(){return L},RD:function(){return e},RP:function(){return c},TQ:function(){return h},VM:function(){return o},X1:function(){return re},aY:function(){return p},do:function(){return m},jv:function(){return f},kJ:function(){return g},n2:function(){return B},qk:function(){return ne},rP:function(){return u},s$:function(){return I},tO:function(){return t},wV:function(){return H},x9:function(){return S}});var W=X(18664),fe=X(91358),ue=X(32105),le=X(19650),ie=X(62458),te=X(32041),Z=X(48066),de=X(38078),K=X(66001),ce=X(7911),r=X(93340),w=X(71090),n="0.3",o="cell-interactive",H="pivotTableCellNoWrap",B="pivotTableCellWrap",k=5,I=5,q=5;function ne(b){return b.insertAdjacentHTML("beforeend",ce.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),b.lastChild}function re(b,T){return _.isEmpty(b)?0:te.b.measureSvgTextWidth(T,b)}function E(b,T){if(_.isEmpty(b))return 0;var R=0;return b.split("\n").forEach(function(z){var N=re(z,T);N>R&&(R=N)}),R}function m(b,T,R){return _.isEmpty(b)?[b]:(b=b.trim(),(0,K.ql)(b,R,te.b.measureSvgTextWidth,T,w.uZ,void 0,!0,!0))}function S(b,T){return Math.max(0,b-(T.getExtraLeft()+T.getExtraRight()))}function d(b){b.opacity=n}function g(b,T){return ie.fF.assertValue(b,"kpi"),ie.fF.assertValue(T,"kpiValue"),ce.bG.build({content:"",classNames:[(0,fe.sq)(b,T)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function y(b,T,R,z){var N={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:b,referrerpolicy:"no-referrer"},contextMenuHandler:function(oe){oe.stopPropagation()}};return null!=z&&(N.attributes.alt=z),{children:[N],classNames:[w.Ed],styleProperties:{height:T+"px",width:R+"px"},attributes:null}}function L(b,T,R,z){ie.fF.assertValue(b,"undefined iconSettings");var N={attributes:{},styleProperties:{},classNames:["flex-container"]},J=function(b,T,R){ie.fF.assertValue(b,"undefined icon");var z=T+"px";return null===b.value?{tagName:"div",styleProperties:{height:z,width:z},attributes:{},classNames:null}:(ie.fF.assertValue(b.value,"Undefined icon value"),b.value.svgId?{tagName:"svg",attributes:{height:z,width:z,role:"img","aria-label":R.getLocalizedString(b.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+b.value.svgId},classNames:null,styleProperties:{}}]}:null!=b.value.url?{tagName:"img",classNames:null,styleProperties:{height:z,width:z},attributes:{src:(0,de.HZ)(b.value.url),referrerpolicy:"no-referrer"}}:void ie.fF.assertFail("Unrecognized icon value"))}(b,T,z);switch(R.classNames.push("stretching-content"),b.layout){case"IconOnly":R.children=[J],Y(b,R),N.children=[R];break;case"After":Y(b,J),N.children=[R,J];break;default:Y(b,J),N.children=[J,R]}return N}function Y(b,T){T.classNames||(T.classNames=[]);var R=T.classNames;switch(R.push("tablixIcon"),b.layout){case"IconOnly":break;case"Before":R.push("before");break;default:R.push("after")}switch(b.verticalAlignment){case"Bottom":R.push("bottom");break;case"Middle":R.push("middle");break;default:R.push("top")}}function c(b,T){return b?(0,r.RP)(T):null}function e(b,T,R,z,N,J){var oe={tagName:"a",classNames:[],styleProperties:{},attributes:{href:T,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(se){se.stopPropagation(),z(T,se)},contextMenuHandler:function(se){se.stopPropagation()}};return"string"==typeof b?oe.content=b:oe.children=[b],R&&(oe.content=void 0,oe.children=void 0,oe.classNames.push(w.NA,R),oe.attributes["aria-label"]=T),N&&(oe.styleProperties.color="inherit"),J&&(oe.attributes.title=T),oe}function t(b){return b-1}function l(b,T,R,z,N,J,oe){var pe,se={};return T&&(pe=b?["powervisuals-glyph","sort-icon",s(b)]:R?["powervisuals-glyph","sort-icon",s(z),"future"]:["sort-icon"]),!b&&R?se["aria-label"]=oe.getLocalizedString("Field_Sorting_Possible"):se["aria-hidden"]="true",{content:w.jv,attributes:se,styleProperties:{"font-size":J,bottom:N+"px"},classNames:pe}}function s(b){switch(b){case 1:return"caret-up";case 2:return"caret-down"}}function f(b,T){return(0,r.MN)(b,T)!==Z.av.NONE}function u(b){return b&&b.replace(/&#10;/g,"<BR />")}function i(b,T){b.size&&8.52===b.size.px&&(b=(0,W.ED)(b,{size:ue.B.createFromPx(8)}));var R={measuredFontHeight:null,textProperties:(0,W.qk)(b),fontProperties:b};return T.addItem(R),R}function h(b,T,R){return i((0,W.ED)(b.fontProperties,T),R)}function P(b,T,R){var z=b.fontProperties;z.family&&(T.fontFamily=z.family),z.size&&(T.fontSize=z.size),z.weight&&(T.fontWeight=z.weight),z.style&&(T.fontStyle=z.style),z.textDecoration&&R&&(T.textDecoration=z.textDecoration)}function p(b,T,R){if(ie.fF.assertValue(T,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==b||b===le.H.auto){if(!R)return;b=R}switch(b){case le.H.left:return void T.push(w.z7);case le.H.center:return void T.push(w.QM);case le.H.right:return void T.push(w.OM);default:return}}var v=function(){function b(){this.items=[]}return b.prototype.addItem=function(T){this.items.push(T)},b.prototype.measureAll=function(T){if(!_.isEmpty(this.items)){for(var R=[],z=0,N=this.items;z<N.length;z++){var oe={content:"a",classNames:null,styleProperties:(0,W.wB)(N[z].fontProperties),attributes:null};R.push(ce.bG.build(oe,null))}var pe=R.join("");T.insertAdjacentHTML("beforeend",pe);for(var A,se=!0,ae=0,ge=this.items;ae<ge.length;ae++)se?(se=!1,A=T.firstChild):A=A.nextSibling,ge[ae].measuredFontHeight=Math.ceil(A.offsetHeight);T.innerHTML=""}},b}()},59151:function(Ve,Fe,X){X.d(Fe,{P:function(){return fe}});var W=X(55007);function fe(ue,le,ie){for(var te={remove:[],merge:[]},Z=0,de=ue;Z<de.length;Z++){var K=de[Z],ce={selector:K.selector,objectName:W.FX.PropColumnWidthValue.objectName,properties:{}};ce.properties[W.FX.PropColumnWidthValue.propertyName]=K.value,null==K.value?te.remove.push(ce):te.merge.push(ce)}le.persistProperties(te,ie)}},93568:function(Ve,Fe,X){X.d(Fe,{$H:function(){return S},B0:function(){return H},aV:function(){return B},cP:function(){return k},qW:function(){return m}});var W=X(1521),fe=X(79154),ue=X(54522),le=X(55007),ie=X(40550),te=X(62458),Z=X(32041),de=X(64329),K=X(48066),ce=X(66001),r=X(93340),w=X(71090),n=X(13375),o=X(64067);function H(d,g,y,L,M,Y,c,e){var t,l,s,f,u;void 0===Y&&(Y=!1),void 0===c&&(c=!1);var i=M.grid,h=M.rowHeaders,P=M.values,p=M.columnHeaders,v=null!==(t=M.grandTotal)&&void 0!==t?t:M.rowGrandTotal,b=M.subtotals||{},T=M.rowSubtotals||{},R=null!==(l=h.outlineWeight)&&void 0!==l?l:i.outlineWeight,z=null!==(s=h.outlineColor)&&void 0!==s?s:i.outlineColor;y.paddings.top=y.paddings.bottom=i.rowPadding;var N=n.hc.isNodeGrandTotal(g);y.borders.top=new r.om,(d.row.isFirst&&!L||L&&0===g.leafIndex)&&(y.borders.top.applyParams((0,ie.yo)(h.outline),R,z,r.Pb.Outline),!(0,ie.yo)(h.outline)&&(0,ie.yo)(P.outline)&&(y.paddings.top+=R)),y.borders.bottom=new r.om,d.row.isLast&&(!L||L&&d.column.isLast&&!M.general.rowSubtotals)||L&&d.row.isFirst&&g.isSubtotal?(y.borders.bottom.applyParams((0,ie.mv)(h.outline),R,z,r.Pb.Outline),!(0,ie.mv)(h.outline)&&(0,ie.mv)(P.outline)&&(y.paddings.bottom+=R)):y.borders.bottom.applyParams(i.gridHorizontal,i.gridHorizontalWeight,i.gridHorizontalColor,r.Pb.Gridline),y.borders.left=new r.om,(L||d.column.isFirst)&&(y.borders.left.applyParams((0,ie.fs)(h.outline),R,z,r.Pb.Outline),!(0,ie.fs)(h.outline)&&(0,ie.fs)(p.outline)&&(y.paddings.left+=R)),y.borders.right=new r.om;var J=L||d.column.isLast;if(J?y.borders.right.applyParams((0,ie.BK)(h.outline),R,z,r.Pb.Outline):y.borders.right.applyParams(i.gridVertical,i.gridVerticalWeight,i.gridVerticalColor,r.Pb.Gridline),g.isBlankRow&&q(y,M),v.applyToHeaders&&N)y.fontColor=v.fontColor||h.fontColor,y.backColor=v.backColor||h.backColor;else{var pe=Y&&(P.fontColorPrimary!==P.fontColorSecondary||P.backColorPrimary!==P.backColorSecondary)&&(c||J),se=null!==(f=T.fontColor)&&void 0!==f?f:b.fontColor,ge=pe&&!(g.hasSubtotalStyle&&se)&&!(N&&v.fontColor),be=null!==(u=T.backColor)&&void 0!==u?u:b.backColor,we=pe&&!(g.hasSubtotalStyle&&be)&&!(N&&v.backColor),Re=void 0;(ge||we)&&(Re=e??ne(g.position,M.general,be)),y.fontColor=ge?re(Re,P):h.fontColor,y.backColor=g.isBlankRow?I(g.isBlankRow,M):we?E(Re,P):h.backColor}}function B(d,g,y,L){var M,Y,c,e,t,l=L.grid,s=L.columnHeaders,f=L.values,u=null!==(M=L.grandTotal)&&void 0!==M?M:L.columnGrandTotal,i=null!==(Y=s.outlineWeight)&&void 0!==Y?Y:l.outlineWeight,h=null!==(c=s.outlineColor)&&void 0!==c?c:l.outlineColor,P=L.columnFormatting[g.queryName],p=null===(t=null===(e=L.annotationFormatting)||void 0===e?void 0:e.columnHeaders)||void 0===t?void 0:t[g.queryName],v=n.hc.isNodeGrandTotal(g);y.fontColor=P&&P.styleHeader&&P.fontColor?P.fontColor:u.applyToHeaders&&v&&u.fontColor||s.fontColor,y.backColor=p&&p.backColor?p.backColor:P&&P.styleHeader&&P.backColor?P.backColor:u.applyToHeaders&&v&&u.backColor||s.backColor,p&&p.bold&&(y.fontWeight=fe.en),y.paddings.top=y.paddings.bottom=l.rowPadding,y.borders.top=new r.om,d.row.isFirst&&y.borders.top.applyParams((0,ie.yo)(s.outline),i,h,r.Pb.Outline),y.borders.bottom=new r.om,d.row.isLast?y.borders.bottom.applyParams((0,ie.mv)(s.outline),i,h,r.Pb.Outline):y.borders.bottom.applyParams(l.gridHorizontal,l.gridHorizontalWeight,l.gridHorizontalColor,r.Pb.Gridline),y.borders.left=new r.om,d.column.isFirst&&!(0,ie.fs)(s.outline)&&(0,ie.fs)(f.outline)&&(y.paddings.left+=i),y.borders.right=new r.om,d.column.isLast?(y.borders.right.applyParams((0,ie.BK)(s.outline),i,h,r.Pb.Outline),!(0,ie.BK)(s.outline)&&(0,ie.BK)(f.outline)&&(y.paddings.right+=i)):y.borders.right.applyParams(l.gridVertical,l.gridVerticalWeight,l.gridVerticalColor,r.Pb.Gridline)}function k(d,g,y,L,M,Y){var c,e,t,l,s,f,u,i,h,P=M.grid,p=M.values,v=M.rowHeaders,b=M.columnHeaders,T=M.rowSubtotals||{},R=M.columnSubtotals||{},z=M.subtotals||{},N=null!==(c=p.outlineWeight)&&void 0!==c?c:P.outlineWeight,J=null!==(e=p.outlineColor)&&void 0!==e?e:P.outlineColor;y.paddings.top=y.paddings.bottom=P.rowPadding,y.borders.top=new r.om,d.row.isFirst&&(y.borders.top.applyParams((0,ie.yo)(p.outline),N,J,r.Pb.Outline),!(0,ie.yo)(p.outline)&&(0,ie.yo)(v.outline)&&(y.paddings.top+=N)),y.borders.bottom=new r.om,d.row.isLast&&(!L||L&&!M.general.rowSubtotals)||L&&g.isRowGrandTotal?(y.borders.bottom.applyParams((0,ie.mv)(p.outline),N,J,r.Pb.Outline),!(0,ie.mv)(p.outline)&&(0,ie.mv)(v.outline)&&(y.paddings.bottom+=N)):y.borders.bottom.applyParams(P.gridHorizontal,P.gridHorizontalWeight,P.gridHorizontalColor),y.borders.left=new r.om,d.column.isFirst&&y.borders.left.applyParams((0,ie.fs)(p.outline),N,J,r.Pb.Outline),y.borders.right=new r.om,d.column.isLast?(y.borders.right.applyParams((0,ie.BK)(p.outline),N,J,r.Pb.Outline),!(0,ie.BK)(p.outline)&&(0,ie.BK)(b.outline)&&(y.paddings.right+=N)):y.borders.right.applyParams(P.gridVertical,P.gridVerticalWeight,P.gridVerticalColor,r.Pb.Gridline),null!==(t=g.rowItem)&&void 0!==t&&t.isBlankRow&&q(y,M);var pe,se,A,ae,oe=g.columnMetadata&&M.columnFormatting[g.columnMetadata.queryName];oe&&(g.isGrandTotal?(se=oe.styleTotal&&oe.fontColor,pe=oe.styleTotal&&oe.backColor):g.hasSubtotalStyle?(se=oe.styleSubTotals&&oe.fontColor,pe=oe.styleSubTotals&&oe.backColor):(se=oe.styleValues&&oe.fontColor,pe=oe.styleValues&&oe.backColor)),g.hasColumnSubtotalStyle?(A=null!==(l=R.fontColor)&&void 0!==l?l:z.fontColor,ae=null!==(s=R.backColor)&&void 0!==s?s:z.backColor):g.hasRowSubtotalStyle?(A=null!==(f=T.fontColor)&&void 0!==f?f:z.fontColor,ae=null!==(u=T.backColor)&&void 0!==u?u:z.backColor):(A=z.fontColor,ae=z.backColor);var ge=Y??ne(g.position,M.general,ae??T.backColor),be=re(ge,p),ye=E(ge,p),me=I(null===(i=g.rowItem)||void 0===i?void 0:i.isBlankRow,M);if(g.isGrandTotal){var we=null!==(h=M.grandTotal)&&void 0!==h?h:g.isColumnGrandTotal?M.columnGrandTotal:M.rowGrandTotal;y.fontColor=g.fontColor||se||we.fontColor||A||be,y.backColor=g.backColor||pe||we.backColor||ae||me||ye}else g.hasSubtotalStyle?(y.fontColor=g.fontColor||se||A||be,y.backColor=g.backColor||pe||ae||me||ye):(y.fontColor=g.fontColor||se||be,y.backColor=g.backColor||pe||me||ye)}function I(d,g){var y,L,M;if(d){var Y=null===(y=g.blankRows)||void 0===y?void 0:y.blankRowTransparency;M=null===(L=g.blankRows)||void 0===L?void 0:L.blankRowColor,null!=Y&&(M=(0,W.Et)(M,(0,o.TD)(Y)))}return M}function q(d,g){var y,L,M,Y,c;if(null!==(y=g?.blankRows)&&void 0!==y&&y.showBorder){var e=null===(L=g?.blankRows)||void 0===L?void 0:L.borderPosition,t=null===(M=g?.blankRows)||void 0===M?void 0:M.borderWidth,l=null===(Y=g?.blankRows)||void 0===Y?void 0:Y.borderTransparency,s=null===(c=g?.blankRows)||void 0===c?void 0:c.borderColor;null!=s&&null!=l&&(s=(0,W.Et)(s,(0,o.TD)(l))),("Top"===e||"TopAndBottom"===e)&&(d.borders.top.color=s,d.borders.top.weight=t),("Bottom"===e||"TopAndBottom"===e)&&(d.borders.bottom.color=s,d.borders.bottom.weight=t)}}function ne(d,g,y){var L;return(L=g.rowSubtotals&&y?d.row.indexInSiblings:d.row.index)<0||L%2==0}function re(d,g){return d?g.fontColorPrimary:g.fontColorSecondary}function E(d,g){return d?g.backColorPrimary:g.backColorSecondary}function m(d,g,y,L){var M,Y,c=L.grid,e=L.columnHeaders,t=L.rowHeaders,l=null!==(M=e.outlineWeight)&&void 0!==M?M:c.outlineWeight,s=null!==(Y=e.outlineColor)&&void 0!==Y?Y:c.outlineColor;g.fontColor=e.fontColor||t.fontColor,g.backColor=e.backColor||t.backColor,g.paddings.top=g.paddings.bottom=c.rowPadding,g.borders.top=new r.om,d.row.isFirst&&g.borders.top.applyParams((0,ie.yo)(e.outline),l,s,r.Pb.Outline),g.borders.bottom=new r.om,d.row.isLast?g.borders.bottom.applyParams((0,ie.mv)(e.outline),l,s,r.Pb.Outline):g.borders.bottom.applyParams(c.gridHorizontal,c.gridHorizontalWeight,c.gridHorizontalColor,r.Pb.Gridline),g.borders.left=new r.om,(d.column.isFirst||y)&&(g.borders.left.applyParams((0,ie.fs)(e.outline),l,s,r.Pb.Outline),!(0,ie.fs)(e.outline)&&(0,ie.fs)(t.outline)&&(g.paddings.left+=l)),g.borders.right=new r.om,g.borders.right.applyParams(c.gridVertical,c.gridVerticalWeight,c.gridVerticalColor,r.Pb.Gridline)}var S=function(){function d(g,y){this.hierarchyNavigator=g,this.options=y}return d.prototype.onDataViewChanged=function(g){this.formattingProperties=g,this.updateTextHeights()},d.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:w.F2,fontSize:de.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:w.dG,fontSize:de.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:w.Zk,fontSize:de.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsTotal,"a"))},d.prototype.onStartRenderingSession=function(){},d.prototype.onEndRenderingSession=function(){},d.prototype.bindRowHeader=function(g,y){(0,r.ey)(y);var L=this.options.tablixProperties,M=new r.qZ;this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(g)&&((0,r.R5)(y,w.Eo),M.borders.right=new r.om(le.FX.PropGridOutlineWeight.defaultValue,L.PropGridOutlineColor.getValue(null))),g.isSubtotal&&(M.paddings.left=w.P$),y.contentWidth=0,this.bindHeader(g,y,y.extension.contentHost,this.hierarchyNavigator.getRowHeaderMetadataColumn(g),M),y.contentWidth=Math.ceil(y.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(g),H(y.position,g,M,!1,this.formattingProperties),y.applyStyle(M)},d.prototype.unbindRowHeader=function(g,y){(0,r.G9)(y),(0,r.aP)(y)},d.prototype.bindColumnHeader=function(g,y){(0,r.ey)(y);var L=new r.qZ,M=this.options.tablixProperties,Y=!1,c=y.extension.contentHost;if((c=(0,r.Ch)(c)).classList.add(w.WA),y.contentWidth=0,this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(g)){if(L.borders.bottom=new r.om(le.FX.PropGridOutlineWeight.defaultValue,M.PropGridOutlineColor.getValue(null)),(0,r.R5)(y,w.mQ),(0,r.R5)(y,w.s0),this.options.showSortIcons){var t=this.getSortableHeaderColumnMetadata(g);t&&(this.registerColumnHeaderClickHandler(t,y),c=(0,r.D6)(t.sort,c),t.sort&&(y.contentWidth=this.fontSizeHeader+w.fG))}g.isSubtotal&&g.parent&&g.parent.children.length>1&&g.parent.children[0].isSubtotal&&(Y=!0)}y.extension.disableDragResize(),this.bindHeader(g,y,c,this.hierarchyNavigator.getColumnHeaderMetadataColumn(g),L,Y),y.contentWidth=Math.ceil(y.contentWidth),B(y.position,g,L,this.formattingProperties),y.applyStyle(L)},d.prototype.unbindColumnHeader=function(g,y){(0,r.G9)(y),(0,r.aP)(y),this.getSortableHeaderColumnMetadata(g)&&this.unregisterColumnHeaderClickHandler(y),this.options.showSortIcons&&(0,r.Y4)(y)},d.prototype.bindHeader=function(g,y,L,M,Y,c){(0,r.R5)(y,w.f),Y.fontFamily=w.F2,Y.fontColor=w.lN;var e=this.formattingProperties.grid.imageHeight;if(y.contentHeight=(0,ue.pt)(M)?e:g.hasSubtotalStyle?this.textHeightTotal:this.textHeightValue,g.hasSubtotalStyle&&((0,r.R5)(y,w.R9),Y.fontFamily=w.Zk),g.isSubtotal&&!c)return(0,r.DM)(this.options.totalLabel,L,y.extension.contentHost),void(y.contentWidth=Z.b.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var t=this.getHeaderLabel(g);if(t)return(0,r.MN)(M,t)!==K.av.NONE?((0,r.vU)(t,L),void(y.contentWidth+=Z.b.measureSvgTextWidth(this.textPropsHeader,t))):(0,ue.pt)(M)&&(0,K.gU)(t)?((0,r.Hx)(g.valueFormatted,L,e),void(y.contentWidth+=e*w.wd)):((0,r.DM)(t,L,y.extension.contentHost),void(y.contentWidth+=Z.b.measureSvgTextWidth(g.hasSubtotalStyle?this.textPropsTotal:this.textPropsHeader,t)));L.innerHTML=w.jv},d.prototype.applyWordWrapping=function(g,y){if(te.fF.assertValue(y,"applyWordWrapping - Undefined cell"),te.fF.assert(function(){return null!=y.containerWidth&&-1!==y.containerWidth},"applyWordWrapping - Undefined width"),te.fF.assert(function(){return null!=y.containerHeight&&-1!==y.containerHeight},"applyWordWrapping - Undefined height"),1===y.type){var L=this.hierarchyNavigator.getRowHeaderMetadataColumn(g);if(!(0,ue.cR)(L)&&!(0,ue.pt)(L)){var M=y.extension.contentHost;(0,r.D4)(M);var Y=g.valueFormatted,c=new r.qZ;H(g.position,g,c,!1,this.formattingProperties);for(var e=y.containerWidth-(c.getExtraRight()+c.getExtraLeft()),t=y.containerHeight-(c.getExtraTop()+c.getExtraBottom()),l=Math.floor(t/this.textHeightHeader),f=0,u=(0,ce.ql)(Y,this.textPropsHeader,Z.b.measureSvgTextWidth,e,l,null,!0);f<u.length;f++)(0,r.Ch)(M,u[f])}}},d.prototype.registerColumnHeaderClickHandler=function(g,y){var L=this;this.options.onColumnHeaderClick&&y.extension.registerClickHandler(function(c){if((0,r.xl)(c)){var e=(0,r.x7)(g.sort);L.options.onColumnHeaderClick(g.queryName?g.queryName:g.displayName,e)}})},d.prototype.unregisterColumnHeaderClickHandler=function(g){this.options.onColumnHeaderClick&&g.extension.unregisterClickHandler()},d.prototype.bindBodyCell=function(g,y){(0,r.ey)(y);var L=new r.qZ;y.contentHeight=this.textHeightValue;var M=g.kpiContent;if(M)$(y.extension.contentHost).append(M),y.contentWidth=this.fontSizeValue;else{var Y=this.textPropsValue;(0,r.R5)(y,w.s0),g.isTotal&&((0,r.R5)(y,w.R9),L.fontFamily=w.Zk,y.contentHeight=this.textHeightTotal,Y=this.textPropsTotal);var c=g.textContent;c&&((0,r.DM)(c,y.extension.contentHost),y.contentWidth=Z.b.measureSvgTextWidth(Y,c))}y.contentWidth=Math.ceil(y.contentWidth),k(y.position,g,L,!1,this.formattingProperties),y.applyStyle(L)},d.prototype.unbindBodyCell=function(g,y){(0,r.G9)(y),(0,r.aP)(y)},d.prototype.bindCornerCell=function(g,y){(0,r.ey)(y);var L=this.options.tablixProperties,M=new r.qZ;M.fontFamily=w.F2,M.fontColor=w.lN,y.contentHeight=this.textHeightHeader,y.contentWidth=0;var Y=y.extension.contentHost;if((Y=(0,r.Ch)(Y)).classList.add(w.WA),g.isColumnHeaderLeaf&&((0,r.R5)(y,w.mQ),M.borders.bottom=new r.om(le.FX.PropGridOutlineWeight.defaultValue,L.PropGridOutlineColor.getValue(null)),this.options.showSortIcons)){var c=this.getSortableCornerColumnMetadata(g);c&&(this.registerColumnHeaderClickHandler(c,y),Y=(0,r.D6)(c?c.sort:void 0,Y),c.sort&&(y.contentWidth=this.fontSizeHeader+w.fG))}(0,r.DM)(g.displayName,Y,y.extension.contentHost),y.contentWidth+=Z.b.measureSvgTextWidth(this.textPropsHeader,g.displayName),y.contentWidth=Math.ceil(y.contentWidth),g.isRowHeaderLeaf&&(0,r.R5)(y,w.Eo),(0,r.R5)(y,w.f),m(y.position,M,!1,this.formattingProperties),y.applyStyle(M),y.extension.disableDragResize()},d.prototype.unbindCornerCell=function(g,y){(0,r.G9)(y),(0,r.aP)(y),this.options.showSortIcons&&(0,r.Y4)(y),g.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(y)},d.prototype.bindEmptySpaceHeaderCell=function(g){},d.prototype.unbindEmptySpaceHeaderCell=function(g){},d.prototype.bindEmptySpaceFooterCell=function(g){},d.prototype.unbindEmptySpaceFooterCell=function(g){},d.prototype.getHeaderLabel=function(g){return g.valueFormatted},d.prototype.getCellContent=function(g){return g.textContent||""},d.prototype.hasRowGroups=function(){var g=this.hierarchyNavigator.getRowHierarchy();return!(!g||!g.levels||0===g.levels.length)},d.prototype.getSortableCornerColumnMetadata=function(g){if(g.isColumnHeaderLeaf)return g.metadata},d.prototype.getSortableHeaderColumnMetadata=function(g){var y=this.hierarchyNavigator.getRowHierarchy();if(!y||!y.levels||0===y.levels.length)return null;var L=this.hierarchyNavigator.getValueSources(),M=L&&L.length>1,Y=this.hierarchyNavigator.getColumnHierarchy(),c=Y?Y.levels.length:0;M?c--:1===c&&Y.levels[0]&&Y.levels[0].sources&&Y.levels[0].sources[0]&&Y.levels[0].sources[0].roles&&Y.levels[0].sources[0].roles.Values&&(c=0);var e=-1;return 0===c?e=g.levelSourceIndex:g.isSubtotal&&(M?g.parent&&0===g.parent.level&&(e=g.levelSourceIndex):0===g.level&&(e=g.levelSourceIndex)),-1!==e?L[e=e||0]:null},d}()},13375:function(Ve,Fe,X){X.d(Fe,{aD:function(){return ce},hc:function(){return r}});var W=X(81337),fe=X(62458),ue=X(39681),le=X(38078),ie=X(93340),te=X(29043),Z=X(66842),de=X(40845),K=function(w){function n(o,H,B,k,I,q,ne,re){var m,S,d,g,E=this;if(B)for(d=B;d.parent;)d=d.parent;if(k)for(g=k;g.parent;)g=g.parent;var y=g&&!!g.isSubtotal,L=!y&&k&&!!k.isSubtotal,M=d&&!!d.isSubtotal,Y=!M&&B&&!!B.isSubtotal,c=B.isBlankRow;return _.isString(o)&&!(null===(S=null===(m=I?.type)||void 0===m?void 0:m.misc)||void 0===S)&&S.sparkline&&(o=(0,te.th)(o,q)),(E=w.call(this,o,H,Y,L,M,y,c,I,ne,re,0)||this).rowItem=B,E.columnItem=k,E.hasRowSubtotalStyle=B&&B.hasSubtotalStyle,E.hasColumnSubtotalStyle=k&&k.hasSubtotalStyle,E.hasSubtotalStyle=E.hasRowSubtotalStyle||E.hasColumnSubtotalStyle,E}return(0,W.ZT)(n,w),Object.defineProperty(n.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),n}(ie.jG);function ce(w,n,o,H,B,k,I,q,ne,re){void 0===I&&(I=!0);var E=new r(H,B,k,re,!0);return I&&E.update(w,!1,!1,!1,n,!0,o,q,ne,void 0,void 0,!1),E}var r=function(){function w(n,o,H,B,k){this.tablixProperties=o,this.hostServices=H,this.expandCompositeHierarchy=B,this.modernRowHeaderStyle=k,this.compositeGroupSeparator=n}return w.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},w.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},w.prototype.getLeafCount=function(n){var o=this.getMatrixHierarchy(n);return o?o.leafNodes.length:0},w.prototype.getLeafAt=function(n,o){var H=this.getMatrixHierarchy(n);return H?H.leafNodes[o]:null},w.prototype.getLeafIndex=function(n){return fe.fF.assertValue(n,"item"),n.leafIndex},w.prototype.getParent=function(n){return fe.fF.assertValue(n,"item"),0===n.level?null:n.parent},w.prototype.getIndex=function(n){return fe.fF.assertValue(n,"item"),n?n.index:-1},w.prototype.isLeaf=function(n){return fe.fF.assertValue(n,"item"),!n.children||0===n.children.length},w.prototype.isRowHierarchyLeaf=function(n){return!0},w.prototype.isColumnHierarchyLeaf=function(n){return!1},w.prototype.isFirstItem=function(n,o){return n===_.head(o)},w.prototype.areAllParentsFirst=function(n,o){if(!n)return!1;var H=this.getParent(n);return H?this.isFirstItem(n,n.siblings)&&this.areAllParentsFirst(H,H.siblings):this.isFirstItem(n,n.siblings)},w.prototype.isLastItem=function(n,o){if(fe.fF.assertValue(n,"item"),n!==_.last(o))return!1;if(!this.isItemRow(n)||this.isDataComplete)return!0;for(var H=n.parent;H;){if(H!==_.last(H.siblings))return!0;H=H.parent}return!1},w.prototype.isItemRow=function(n){if(!n)return!1;for(var o=n;o.parent;)o=o.parent;return o.siblings===this.rowHierarchy.root.children},w.prototype.areAllParentsLast=function(n,o){if(!n)return!1;var H=this.getParent(n);return H?this.isLastItem(n,n.siblings)&&this.areAllParentsLast(H,H.siblings):this.isLastItem(n,n.siblings)},w.prototype.getChildren=function(n){return fe.fF.assertValue(n,"item"),n.children},w.prototype.getChildrenLevelDifference=function(n){var o=1/0,H=this.getChildren(n);if(!_.isEmpty(H))for(var B=0,k=H.length;B<k;B++)o=Math.min(o,H[B].level-n.level);return o},w.prototype.getCount=function(n){return fe.fF.assertValue(n,"items"),n.length},w.prototype.getAt=function(n,o){return fe.fF.assertValue(n,"items"),n[o]},w.prototype.getLevel=function(n){return fe.fF.assertValue(n,"item"),n.level},w.prototype.getRowLeafIndex=function(n){return this.isSteppedLayout&&n.isSubtotal?n.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?n.parent.leafIndex:n.leafIndex:this.valuesOnRow?n.levelSourceIndex:-1:n.leafIndex},w.prototype.getIntersection=function(n,o){fe.fF.assertValue(n,"rowItem"),fe.fF.assertValue(o,"columnItem");var H,k,B=o.leafIndex;if(H=n.values?n.values[o.leafIndex]:void 0){var I=this.valueSources[H.valueSourceIndex||0],q=I.queryName;k=new K(H.value,H.objects,n,o,I,this.hostServices,this.formatters[q],this.tooltipFormatters[q])}else k=new K(void 0,void 0,n,o,void 0,this.hostServices,void 0,void 0);var E=this.getRowLeafIndex(n);return k.position.row.index=E,k.position.row.indexInSiblings=n.siblings.indexOf(n),k.position.row.isFirst=0===E,k.position.row.isLast=this.isDataComplete&&E===this.rowHierarchy.leafNodes.length-1,k.position.column.index=B,k.position.column.indexInSiblings=o.siblings.indexOf(o),k.position.column.isFirst=0===B,k.position.column.isLast=B===this.columnHierarchy.leafNodes.length-1,H&&H.objects&&(k.backColor=(0,le.HZ)(this.tablixProperties.PropValuesBackColor.getValue(H.objects)),k.fontColor=(0,le.HZ)(this.tablixProperties.PropValuesFontColor.getValue(H.objects))),k},w.prototype.getCorner=function(n,o){fe.fF.assert(function(){return n>=0},"rowLevel"),fe.fF.assert(function(){return o>=0},"columnLevel");var k,H=this.columnHierarchy.levels,B=this.rowHierarchy.levels;if((o===H.length-1||0===H.length)&&(k=B[n])){var I=n===B.length-1,q=this.valuesOnRow&&I;return{metadata:1===k.sources.length||k.sources.length>1&&q?k.sources[0]:null,displayName:q?"":_.map(k.sources,function(E){return E.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:I,position:this.calculateCornerCellPosition(n,o),rowLevel:n,columnLevel:o}}if(n===B.length-1&&(k=H[o])){var re=k.sources.filter(function(m){return!m.isMeasure});return{metadata:1===k.sources.length?k.sources[0]:null,displayName:_.map(re,function(m){return m.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(n,o),rowLevel:n,columnLevel:o}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(n,o),rowLevel:n,columnLevel:o}},w.prototype.calculateCornerCellPosition=function(n,o){var H=new ie.ri,B=o;H.row.index=H.row.indexInSiblings=B,H.row.isFirst=0===B;var k=this.getColumnHierarchyDepth();H.row.isLast=o===k-1;var I=n;H.column.index=H.column.indexInSiblings=I,H.column.isFirst=0===I;var q=this.getRowHierarchyDepth();return H.column.isLast=I===q-1,H},w.prototype.headerItemEquals=function(n,o){return!(!n||!o)&&n===o},w.prototype.bodyCellItemEquals=function(n,o){return n.position.isMatch(o.position)},w.prototype.cornerCellItemEquals=function(n,o){return!(!n||!o)&&n.displayName===o.displayName&&n.isColumnHeaderLeaf===o.isColumnHeaderLeaf&&n.isRowHeaderLeaf===o.isRowHeaderLeaf&&n.metadata===o.metadata},w.prototype.getColumnHierarchy=function(){return this.columnHierarchy},w.prototype.getRowHierarchy=function(){return this.rowHierarchy},w.prototype.getValueSources=function(){return this.valueSources},w.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},w.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},w.prototype.update=function(n,o,H,B,k,I,q,ne,re,E,m,S){var d=this;fe.fF.assertValue(n,"matrix"),this.isSteppedLayout=o,this.valuesOnRow=H,this.areRowSubtotalsBefore=B,this.isDataComplete=k,this.valueSources=n.valueSources,this.formatters=q,this.tooltipFormatters=ne||{},this.subtotalByColumn=re||{},this.multipleValueSources=n.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(n.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,S,E,m),(I=I||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(n.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,m,this.areRowSubtotalsBefore,function(g,y){return d.calculateRowHeaderPosition(g,y)}),I&&(this.updateHierarchy(this.columnHierarchy,!1,m,!1,function(g,y){return d.calculateColumnHeaderPosition(g,y)}),this.updateStaticColumnHeaders(this.columnHierarchy))},w.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},w.prototype.removeValueNodesFromColumnHierarchy=function(n){fe.fF.assertValue(n,"nodes");for(var o=0,H=n;o<H.length;o++){var B=H[o];if(!B.parent&&this.isLeaf(B))return n.length=0,void n.push({level:0});this.isLeaf(B.children[0])?B.children=void 0:this.removeValueNodesFromColumnHierarchy(B.children)}},w.prototype.addValueNodesToRowHierarchy=function(n,o){for(var H=this.getRowHierarchyDepth(),B=this.valueSources.length,k=n.length,I=0;I<k;I++){var q=n[I];if(this.isLeaf(q)){var ne=void 0,re=void 0,E=void 0;if(this.isSteppedLayout&&q.isSubtotal||!o?(n.splice(I,1),ne=n,re=I,E=q.level,k=k-1+B,I=I-1+B):(q.children=[],ne=q.children,re=0,E=H),!q.isBlankRow)for(var m=0;m<B;m++){var S=this.createRowValueNode(m,B,q,E);ne.splice(re++,0,S)}q.values=null}else this.addValueNodesToRowHierarchy(q.children,o)}},w.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},w.prototype.createRowValueNode=function(n,o,H,B){var k={level:B,levelSourceIndex:n,isSubtotal:H.isSubtotal,hasSubtotalStyle:!!H.hasSubtotalStyle,values:{}},I=0,q=0;for(var ne in H.values)I%o===n&&(k.values[q++]=H.values[I]),I++;return k},w.prototype.createBlankRowValueNode=function(n){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(n),function(H){return H.valueSourceIndex}).map(function(H){return{value:"",valueSourceIndex:H,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},w.prototype.needsBlankRow=function(n,o,H){return!n.isSubtotal||o===de.we&&H!==Z.t.Compact},w.prototype.findValues=function(n){if(n.values)return n.values;var o=_.first(n.children);return o?this.findValues(o):void 0},w.prototype.wrapHierarchy=function(n,o,H,B,k,I){var ne,q=this;return ne={levels:this.wrapLevels(n.levels,o),root:{children:this.wrapNodes(n.root.children,n,o,H)}},B&&ne.root.children.length>0&&(ne.root.children=_.flatMap(ne.root.children,function(re){return q.needsBlankRow(re,k,I)?[re,q.createBlankRowValueNode(re)]:[re]})),ne.leafNodes=[],ne},w.prototype.wrapLevels=function(n,o){if(n){for(var H=[],B=0,k=n;B<k.length;B++){var I=k[B],q=(0,ue.ED)(I);if(H.push(q),I.sources.length>1&&o){for(var ne=1;ne<I.sources.length;ne++)H.push({sources:[I.sources[ne]]});q.sources.splice(1,q.sources.length-1)}}return H}},w.prototype.wrapNodes=function(n,o,H,B){if(n){for(var k=[],I=0,q=n;I<q.length;I++){var ne=q[I],re=(0,ue.ED)(ne);if(ne.isCollapsed&&!_.isEmpty(ne.children)){var E=_.find(ne.children,function(M){return M.isSubtotal});E&&(re.values=E.values),re.children=null,re.hasSubtotalStyle=!0}else{if(re.isSubtotal){var m=o.levels[re.level||0];if(1===m.sources.length&&!1===this.subtotalByColumn[m.sources[0].queryName])continue}re.hasSubtotalStyle=!!ne.isSubtotal||B&&!_.isEmpty(ne.children),re.children=this.wrapNodes(ne.children,o,H,B)}if(!_.isEmpty(re.levelValues)&&re.levelValues.length>1&&H){for(var S=re.children,d=re,g=1;g<re.levelValues.length;g++){var y=(0,ue.ED)(re),L=re.levelValues[g];L.levelSourceIndex=0,y.levelValues=[L],y.level+=g,y.isCollapsed=!0,y.children=void 0,d.isCollapsed=!1,d.children=[y],d=y}_.isEmpty(S)||(d.children=S,d.isCollapsed=!1),d.values=re.values,re.values=void 0,re.levelValues.splice(1,re.levelValues.length-1)}k.push(re)}return k}},w.prototype.updateHierarchy=function(n,o,H,B,k){n.leafNodes.length>0&&(n.leafNodes.length=0),n.root.children&&this.updateRecursive(n,n.root.children,null,n.leafNodes,o,H,B,k)},w.prototype.createEmptyNode=function(n){return void 0===n&&(n=0),{level:n,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},w.prototype.updateRecursive=function(n,o,H,B,k,I,q,ne){for(var re,E=function(y,L){var M=o[y];if(M.siblings=o,n===m.rowHierarchy&&!M.isCollapsed&&!_.isEmpty(M.children)&&I===Z.t.Outline&&!q&&M.children.unshift(m.createEmptyNode(M.children[0].level)),H&&(M.parent=H),re=n===m.rowHierarchy&&m.isSteppedLayout&&M.isSubtotal&&void 0!==M.levelSourceIndex?_.last(n.levels):n.levels[M.level],M.hierarchyLevel=re,re)if(M.levelValues){for(var Y=[],c=[],e=0,t=M.levelValues;e<t.length;e++){var l=t[e],u=l.value;Y.push(m.formatters[(s=re.sources[l.levelSourceIndex||0]).queryName].format(u,null));var i=m.tooltipFormatters[s.queryName];i&&c.push(i.format(u,null))}fe.fF.assert(function(){return Y.length===c.length||_.isEmpty(c)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),M.valueFormatted=Y.join(m.compositeGroupSeparator),M.tooltipValueFormatted=_.isEmpty(c)?void 0:c.join(m.compositeGroupSeparator),M.queryName=1!==re.sources.length?void 0:re.sources[0].queryName}else{var s;M.valueFormatted=(s=re.sources[M.levelSourceIndex||0]).displayName,M.tooltipValueFormatted=s.displayName,M.queryName=s.queryName}M.index=y,_.isEmpty(M.children)?(!k||!M.isSubtotal||!q&&M.parent&&!M.parent.isSubtotal||m.valuesOnRow&&M.parent)&&(M.leafIndex=B.length,B.push(M)):(k&&(M.leafIndex=B.length,B.push(M)),m.updateRecursive(n,M.children,M,B,k,I,q,ne),k&&(fe.fF.assertAnyValue(_.every(M.children,function(h){return _.isEqual(h.hierarchyLevel,M.children[0].hierarchyLevel)}),"Children may come from different levels"),(!m.hasMultipleValueSources()||_.some(M.children,function(h){return _.some(h.hierarchyLevel.sources,function(P){return!P.isMeasure})}))&&(M.hasSubtotalStyle=!0))),M.position=ne(M,o)},m=this,S=0,d=o.length;S<d;S++)E(S)},w.prototype.updateStaticColumnHeaders=function(n){var o=n.leafNodes;if(o&&o.length>0){if(!o[0].identity&&this.valuesOnRow&&1===o.length)return;for(var H=0,B=o.length;H<B;H++){var k=o[H];if(!k.identity&&_.isEmpty(k.levelValues)){var q=n.levels[k.level].sources[k.levelSourceIndex?k.levelSourceIndex:0];q&&(k.valueFormatted=q.displayName)}}}},w.prototype.getMatrixHierarchy=function(n){var o=this.rowHierarchy.root.children;if(o&&n===o)return this.rowHierarchy;var H=this.columnHierarchy.root.children;return H&&n===H?this.columnHierarchy:null},w.prototype.calculateRowHeaderPosition=function(n,o){var H=new ie.ri;H.row.index=this.getRowLeafIndex(n),H.row.indexInSiblings=this.getIndex(n),H.row.isFirst=this.areAllParentsFirst(n,o),H.row.isLast=this.areAllParentsLast(n,o);var B=this.getLevel(n);return H.column.index=H.column.indexInSiblings=B,H.column.isFirst=0===B,H.column.isLast=this.isLeaf(n),H},w.prototype.calculateColumnHeaderPosition=function(n,o){var H=new ie.ri,B=this.getLevel(n);H.row.index=H.row.indexInSiblings=B,H.row.isFirst=0===B,H.row.isLast=this.isLeaf(n);var k=this.getIndex(n);return H.column.index=H.column.indexInSiblings=k,H.column.isFirst=this.areAllParentsFirst(n,o),H.column.isLast=this.areAllParentsLast(n,o),H},w.prototype.getRowHeaderMetadataColumn=function(n){var o=this.getRowHeaderMetadataColumns(n);return o&&o[0]},w.prototype.getRowHeaderMetadataColumns=function(n){if(n&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,n.level)},w.prototype.getColumnHeaderMetadataColumn=function(n){var o=this.getColumnHeaderMetadataColumns(n);return o&&o[0]},w.prototype.getColumnHeaderMetadataColumns=function(n){if(n&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,n.level)},w.prototype.getHierarchyMetadataColumns=function(n,o){if(n&&n.levels&&!(n.levels.length<o)){var H=n.levels[o];if(H&&H.sources&&0!==H.sources.length)return H.sources}},w.isNodeGrandTotal=function(n){if(n){for(var o=n;o.parent;)o=o.parent;return o.isSubtotal}return!1},w}()},32771:function(Ve,Fe,X){X.d(Fe,{JF:function(){return de},az:function(){return Z}});var W=X(81337),fe=X(90120),ue=X(34021),le=X(44783),ie=X(62458),te=X(38078);function Z(ce,r,w){if(ie.fF.assertValue(ce,"getColumnDataBarsSettings: column"),r){var o,H,n=ce.aggregates;if(null!=r.minValue?o=r.minValue:n&&null!=n.min&&_.isNumber(n.min)&&(o=n.min),null!=r.maxValue?H=r.maxValue:n&&null!=n.max&&_.isNumber(n.max)&&(H=n.max),!(null==o||null==H||o>H)){var B=null!=r.minValue,k=null!=r.maxValue;return o>=0&&H>0&&!B&&(o=0),o<0&&H<0&&!k&&(H=0),{min:o,max:H,range:H-o,zeroPosition:0===o&&0===H?.5:o>=0&&H>0&&B?0:o<0&&H<=0&&k?1:(0-o)/(H-o),positiveColor:(0,te.HZ)(fe.v.getFillColor(w,r.positiveColor,le.U)),negativeColor:(0,te.HZ)(fe.v.getFillColor(w,r.negativeColor,le.U)),axisColor:(0,te.HZ)(fe.v.getFillColor(w,r.axisColor,le.fA)),hideText:!!r.hideText,reverseDirection:!!r.reverseDirection,strokeSettings:(0,W.pi)((0,W.pi)({},(0,ue.kG)(w)),{width:1}),totalMatching:r.totalMatchingOption}}}}function de(ce,r,w,n,o){var H,B=w.getExtraLeft()+"px",k=w.getExtraRight()+"px",I=w.getExtraTop()+"px",q=w.getExtraBottom()+"px",ne={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:B,right:k,top:I,bottom:q}},re=[],E=function(ce,r,w){if(null!=r&&_.isNumber(r)&&0!==r){var k,I,q,n=ce.min,o=ce.max,H=ce.range,B=ce.zeroPosition;if(r>=o){if(1===B)return;r=o}else if(r<=n){if(0===B)return;r=n}if(0===H?(k=I=B,q=ce.positiveColor):r>0?(k=B,I=(r-n)/H,q=ce.positiveColor):(k=(r-n)/H,I=B,q=ce.negativeColor),ce.reverseDirection){var ne=k;k=1-I,I=1-ne}var re=100*(I-k);w?.push((r>=0?"":"-")+Math.round(re)+"%");var E={left:100*k+"%",width:re+"%",background:q},m=ce.strokeSettings;return m&&m.visible&&(E.outline="".concat(m.width,"px solid ").concat(m.color),E["outline-offset"]="-".concat(m.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:E}}}(r,n,re);E&&ne.children.push(E);var d,m=r.zeroPosition;r.reverseDirection&&(m=1-m),ne.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+I,bottom:"-"+q,left:100*m+"%","border-left-color":r.axisColor}}),o&&(d={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:o.getLocalizedString("Data_Bar_Percentage",null!==(H=re[0])&&void 0!==H?H:"0%")});var g=ce.styleProperties;return g.position="absolute",g.left=B,g.right=k,g.top=I,g.bottom=q,d?{children:[ne,ce,d],classNames:[],attributes:{},styleProperties:{}}:{children:[ne,ce],classNames:[],attributes:{},styleProperties:{}}}},21242:function(Ve,Fe,X){X.d(Fe,{Ak:function(){return o},IP:function(){return k},JW:function(){return de},MX:function(){return w},d4:function(){return le},kH:function(){return ie},mM:function(){return n},p_:function(){return B},re:function(){return K}});var W=X(81337),fe=X(13375);function ue(I,q,ne,re){var E,m,S,d,g,y;void 0===ne&&(ne=!0);var L=I.columnItem,M=I.rowItem,Y=0,c={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},e=M&&!_.isEmpty(M.values),t=M&&r(M,q,ne,re);t&&((E=c.displayNameParts).push.apply(E,t.displayNameParts||[]),(m=c.valueParts).push.apply(m,t.valueParts||[]),(S=c.headerParts).push.apply(S,_.map(t.valueParts,function(){return!0})),c.concatenatedParts.push(_.map(t.displayNameParts,function(){return Y++})));var l=L&&r(L,q,ne,re);if(l&&((d=c.displayNameParts).push.apply(d,l.displayNameParts||[]),(g=c.valueParts).push.apply(g,l.valueParts||[]),(y=c.headerParts).push.apply(y,_.map(l.valueParts,function(){return!0})),c.concatenatedParts.push(_.map(l.displayNameParts,function(){return Y++}))),e)if(c.displayNameParts.push(I.columnMetadata.displayName),c.concatenatedParts.push([Y++]),c.headerParts.push(!1),I.isKpi){var s={metadata:I.columnMetadata.kpi,value:I.tooltipContent};(c.otherType[c.displayNameParts.length-1]={}).kpiValue=s,c.valueParts.push(I.tooltipContent)}else _.isEmpty(I.tooltipContent)||c.valueParts.push(I.tooltipContent);return c}function le(I,q,ne){if(I)return ne?[{displayName:"",value:I.tooltipContent}]:function(I){for(var q=[],ne=function(d){var g=_.filter(I.displayNameParts,function(Y,c){return-1!==d.indexOf(c)}),y=_.filter(I.valueParts,function(Y,c){return-1!==d.indexOf(c)});if((g.length>0||y.length>0)&&(q.push({displayName:g.join(" "),value:y.join(" ")}),I.otherType)){var L=_.first(d);if(_.has(I.otherType,String(L))){var M=q.length-1;delete q[M].value,q[M]=(0,W.pi)((0,W.pi)({},q[M]),I.otherType[L])}}},re=0,E=I.concatenatedParts;re<E.length;re++)ne(E[re]);return q}(ue(I,q))}function ie(I,q,ne,re){for(var E=[],m=0,S=I;m<S.length;m++)E.push(ue(S[m],re));var g=0,y=q.getHierarchyLeafCount()*ne.getHierarchyLeafCount();return 0!==y&&(g=Math.round(I.length/y*100)),(0,W.pi)({coveragePercentage:g},te(E))}function te(I){for(var q={headers:_.uniq(_.flatten(_.map(I,function(l){return l.displayNameParts}))),isHeader:{},values:[]},ne=q.values,re=q.headers,E=q.isHeader,m={},S=0;S<re.length;S++)m[re[S]]=S;for(var d=0,g=I;d<g.length;d++){var y=g[d],L=_.fill(new Array(re.length),"");for(S=0;S<y.displayNameParts.length;S++){var c=m[y.displayNameParts[S]];L[c]=y.valueParts[S],y.headerParts&&(q.isHeader[c]=y.headerParts[S])}ne.push(L)}if(!_.isEmpty(I)&&I[0].headerParts)for(var e=function(s){for(var f=ne[s],u=[],i=s+1;i<ne.length;i++)_.every(ne[i],function(se,A){return E[A]&&se===f[A]||!E[A]&&(""===se||""===f[A])})&&u.push(i);if(u.length>0)for(var p=_.reduce(f,function(se,A,ae){return""===A&&se.push(ae),se},[]),v=0,b=u;v<b.length;v++){var R=ne[b[v]];for(i=0;i<p.length;i++){var z=p[i],N=R[z];""!==N&&(f[z]=N,p.splice(i,1),i--)}}u.sort(function(se,A){return A-se});for(var J=0,oe=u;J<oe.length;J++)ne.splice(oe[J],1)},t=0;t<ne.length;t++)e(t);return q}function de(I,q){if(I)return q?[{displayName:"",value:I.displayName}]:[{displayName:I.displayName}]}function K(I,q,ne,re,E,m){if(I){if(m)return[{displayName:"",value:I.isSubtotal||fe.hc.isNodeGrandTotal(I)?re:I.tooltipValueFormatted}];if(fe.hc.isNodeGrandTotal(I))return ne(I)?[{displayName:I.tooltipValueFormatted}]:[{displayName:re}];var d=[],g=function(I,q){var ne=w(I,q),re=ne.displayNameParts,E=ne.valueParts;if(re.length>0||E.length>0)return{displayName:re.join(" "),value:E.join(" ")}}(I,E);return g&&d.push(g),q(I)&&d.push({displayName:E,value:I.valueFormatted}),d}}function r(I,q,ne,re){void 0===ne&&(ne=!0);var E=H(I),m=I.queryName,S=_.find(E,function(d){return d.queryName===m});return S&&S.isMeasure&&(I=I.parent),w(I,q,ne,re)}function w(I,q,ne,re){void 0===ne&&(ne=!0);for(var E=[],m=[];I;)if(ne&&I.isSubtotal)I=I.parent;else{var S=H(I);if(!_.isEmpty(S)){for(var d=[],g=0,y=S;g<y.length;g++){var L=y[g];d.push(L.isMeasure?q:L.displayName)}E.push(d.join(" ")),_.every(S,function(M){return M.isMeasure})?m.push(S[0].displayName):m.push(I.isSubtotal?re:I.tooltipValueFormatted)}I=I.parent}return{displayNameParts:E=E.reverse(),valueParts:m=m.reverse()}}function n(I,q,ne,re,E){var m=o(ne,re,I,q),S=0,d=ne.getHierarchyLeafCount()*re.getHierarchyLeafCount();0!==d&&(S=Math.round(m.length/d*100));for(var g=[],y=0,L=m;y<L.length;y++)g.push(ue(L[y],E));return(0,W.pi)({coveragePercentage:S},te(g))}function o(I,q,ne,re){_.isEmpty(ne)&&(ne=I.getHierarchyItems()),_.isEmpty(re)&&(re=q.getHierarchyItems());var E=[];I.getLeaves(ne,E),E=_.filter(E,function(c){return!c.isSubtotal});var m=[];q.getLeaves(re,m),m=_.filter(m,function(c){return!c.isSubtotal});for(var S=[],d=0,g=E;d<g.length;d++)for(var y=g[d],L=0,M=m;L<M.length;L++)S.push(I.getIntersection(y,M[L]));return S.filter(function(c){return!c.isSubtotal&&!c.isGrandTotal})}function H(I){var q=I.hierarchyLevel&&I.hierarchyLevel.sources;return _.isEmpty(q)?[]:_.every(q,function(ne){return ne.isMeasure})?[q[I.levelSourceIndex||0]]:q}function B(I){return{displayNameParts:[I.displayName],valueParts:[null]}}function k(I,q){for(var ne=[],re=0;re<I.displayNameParts.length;re++){var E=I.displayNameParts[re],m=I.valueParts[re];null!=m&&(E+=": "+m),ne.push(E)}if(!_.isEmpty(q))for(var S=0,d=q;S<d.length;S++)ne.push(d[S]);return ne.join(". ")}},29043:function(Ve,Fe,X){X.d(Fe,{MV:function(){return n},th:function(){return r},wJ:function(){return w}});var W=X(53197),fe=X(90120),ue=X(51995),le=X(85308),ie=X(58520),te=X(45296),Z=X(44783),de=X(62458),K=X(43286),ce=52;function r(I,q){var t,ne={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(I)){var re;try{re=JSON.parse(I)}catch{return}var E=+re.yl,m=+re.yh,d=+re.xl,g=+re.xh,y=null!=re.md?+re.md:void 0;_.size(re.p)>ce&&q.setWarnings([new te.El]);for(var L=0,M=re.p;L<M.length;L++){var Y=M[L];ne.points.push({x:null!=Y[0]?+Y[0]:void 0,y:null!=Y[1]?(t=+Y[1],t*(m-E)/100+E):void 0})}return{points:_.filter(ne.points,function(e){return _.isFinite(e.x)&&(null!=e.y||_.isFinite(e.y))}),lowX:d,highX:g,lowY:E,highY:m,minXDifference:y}}}function w(I,q,ne){var re;de.fF.assertValue(I,"sparkline"),de.fF.assertValue(null===(re=q?.misc)||void 0===re?void 0:re.sparkline,"invalid type for sparkline"),de.fF.assertValue(ne,"style");var E=q.misc.sparkline.groupingType;return{chartType:I.chartType,dataColor:ne.isHighContrast?fe.v.getThemeColor(ne,Z.fA):I.dataColor,strokeWidth:I.strokeWidth,marker:{show:!0,typeFlags:I.marker.typeFlags,color:ne.isHighContrast?fe.v.getThemeColor(ne,Z.fA):I.marker.color,size:I.marker.size,shape:I.marker.shape},isScalar:E&&!!(E.numeric||E.dateTime||E.temporal)}}function n(I,q,ne,re,E,m,S,d){var g;if(null!=re){var c=m-ne.getExtraLeft()-ne.getExtraRight()-(d?d+5:0),e=E-ne.getExtraTop()-ne.getExtraBottom();c-q.strokeWidth>1&&e-q.strokeWidth>1&&(g=q.chartType===le.U.line?function(I,q,ne,re){var s,m=I.dataColor,S=I.strokeWidth,d=I.marker,g=d.color,y=d.size,L=d.shape,M=d.typeFlags,Y=I.isScalar,c=(0,K.Js)(M),e=0===c||1===c&&(0,K.yE)(M,ie.qC),t=Math.max(S,2)+(e?0:Math.ceil(y/2)),l=re.points;s=Y?d3.scaleLinear().domain([re.lowX,re.highX]).range([t,q-t]):d3.scalePoint().domain(_.map(_.range(re.lowX,re.highX+1),function(z){return z.toString()})).range([t,q-t]);var p,v,f=d3.scaleLinear().domain(d3.extent(l,function(z){return z.y})).range([ne-t,t]),u=d3.line().x(function(z){return s(z.x)}).y(function(z){return f(z.y)}),i=_.filter(l,function(z){return null!=z.y}),P={tagName:"path",attributes:{d:u(i)},classNames:[],styleProperties:{stroke:m,"stroke-width":S.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},b=function(I,q){var ne=q.marker.typeFlags,re=d3.extent(I,function(S){return S.y}),E=re[0],m=re[1];return _.filter(I,function(S,d){var g,y;return null!=S.y&&(!!(0,K.yE)(ne,ie.$6)||(0,K.yE)(ne,ie.Ps)&&0===d||(0,K.yE)(ne,ie.Z$)&&d===I.length-1||(0,K.yE)(ne,ie.pd)&&S.y<0||(0,K.yE)(ne,ie.Zc)&&S.y===m||(0,K.yE)(ne,ie.O3)&&S.y===E||(0,K.yE)(ne,ie.qC)&&null==(null===(g=I[d-1])||void 0===g?void 0:g.y)&&null==(null===(y=I[d+1])||void 0===y?void 0:y.y))})}(i,I);if(!_.isEmpty(b)){var T="markerKey".concat(y).concat(g).concat(L);p={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:T,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:y.toString(),markerWidth:y.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,ue.F)(L).toString(),"stroke-opacity":"1",stroke:g,fill:g},attributes:{d:(0,ue.Ar)(L)}}]}]},v={tagName:"path",attributes:{d:u(b)},classNames:[],styleProperties:{stroke:m,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(T,")"),"marker-mid":"url(#".concat(T,")"),"marker-end":"url(#".concat(T,")")}}}return{tagName:"svg",children:v?[p,P,v]:[P],classNames:[],styleProperties:{},attributes:{height:ne+"px",width:q+"px"}}}(q,c,e,re):function(I,q,ne,re){var L,E=I.dataColor,m=I.isScalar,S=re.points,d=[re.lowX,re.highX],g=function(I,q,ne,re,E){if(_.isEmpty(I))return 0;var d,g=re[re.length-1]-re[0];return E&&re&&re.length>1?(0!==g?(de.fF.assert(function(){return null!=q},"minXDifference cannot be null for scalar plotted as columns"),d=ne*(q/(g+q))):d=ne,d=Math.max(d,2)):d=ne/(g+1),.8*d}(S,re.minXDifference,q,d,m),y=g/2;L=m?d3.scaleLinear().domain(d).range([y,q-y]):d3.scalePoint().domain(_.map(_.range(re.lowX,re.highX+1),function(t){return t.toString()})).range([y,q-y]);var M=d3.extent(S,function(t){return t.y});M[0]=Math.min(0,M[0]),M[1]=Math.max(0,M[1]);var Y=d3.scaleLinear().domain(M).range([ne,0]),c=Y(0),e=g.toString();return{tagName:"svg",children:_.chain(S).filter(function(t){return null!=t.y}).map(function(t){var l=(L(t.x)-y).toString(),s=(c+(0,W.sc)(Y,Math.max(0,t.y),0)).toString(),f=Math.abs((0,W.sc)(Y,0,t.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:E},attributes:{x:l,y:s,width:e,height:f}}}).value(),classNames:[],styleProperties:{},attributes:{height:ne+"px",width:q+"px"}}}(q,c,e,re))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(S&&"Before"!==S.layout?[g,I]:[I,g],function(s){return!!s})}}},74764:function(Ve,Fe,X){X.r(Fe),X.d(Fe,{PivotTable:function(){return me}});var W=X(81337),fe=X(80065),ue=X(82755),le=X(46135),ie=X(79465),te=X(57419),Z=X(59107),de=X(15366),K=X(32379),ce=X(31198),r=X(40739),w=X(62458),n=X(52287),o=X(21242),H=X(13375),B=X(85196),k=X(26543),I=function(){function ee(a,x,V,G){this.tooltipService=a,this.selectionManager=x,this.valueLabel=V,this.totalLabel=G,this.tooltipsEnabled=!0}return ee.prototype.getHandlerTop=function(){var a=this,x=function(j){return j.isSubtotal&&!a.rowHierarchyNavigator.valuesOnRowApplied()&&a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(j)},V=function(j){return a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(j)},G=B.r.columns;return{addTooltip:null,removeTooltip:function(j,C){return a.removeTooltip(C)},isTooltipEnabled:null,setTooltipDelegate:function(j,C,F,O,U){return a.setTooltipDelegateTop(j,C,F,x,V,G,O,U)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ee.prototype.getHandlerMidOrBot=function(){var a=this,x=function(j){return j.isSubtotal&&a.rowHierarchyNavigator.valuesOnRowApplied()&&a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(j)},V=function(j){return a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(j)},G=B.r.rows;return{addTooltip:null,removeTooltip:function(j,C){return a.removeTooltip(C)},isTooltipEnabled:null,setTooltipDelegate:function(j,C,F,O,U){return a.setTooltipDelegateMidOrBot(j,C,F,x,V,G,O,U)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ee.prototype.getRowHeaderHandler=function(){var a=this;return this.getHeaderHandler(function(x){return x.isSubtotal&&a.rowHierarchyNavigator.valuesOnRowApplied()&&a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(x)},function(x){return a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(x)},B.r.rows)},ee.prototype.getColumnHeaderHandler=function(){var a=this;return this.getHeaderHandler(function(x){return x.isSubtotal&&!a.rowHierarchyNavigator.valuesOnRowApplied()&&a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(x)},function(x){return a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(x)},B.r.columns)},ee.prototype.getBodyHandler=function(){var a=this;return{addTooltip:function(V,G){return a.addBodyTooltip(V,G)},removeTooltip:function(V,G){return a.removeTooltip(G)},isTooltipEnabled:function(V){return a.tooltipsEnabled},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ee.prototype.onDataViewChanged=function(a,x){this.rowHierarchyNavigator=a,this.columnHierarchyNavigator=x},ee.prototype.addBodyTooltip=function(a,x){var V=this,G=d3.select(x);this.tooltipService.addTooltip(G,function(){return(0,o.d4)(a,V.valueLabel,!V.tooltipsEnabled)},function(){var D=V.getItemSelectionId(a,B.r.values,void 0);return D&&[D]})},ee.prototype.getCornerHandler=function(){var a=this;return{addTooltip:function(V,G){return a.addCornerTooltip(V,G)},removeTooltip:function(V,G){return a.removeTooltip(G)},isTooltipEnabled:function(V){return a.tooltipsEnabled&&!_.isEmpty(V.displayName)},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ee.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},ee.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},ee.prototype.setTooltipsEnabled=function(a){this.tooltipsEnabled=a},ee.prototype.addHeaderTooltip=function(a,x,V,G,D){var j,F,O,C=this,U=d3.select(x),Q=null===(O=(F=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===O?void 0:O.call(F),he=((j={})[0]=!Q,j);this.tooltipService.addTooltip(U,function(){return(0,o.re)(a,V,G,C.totalLabel,C.valueLabel)},function(){var ve=C.getItemSelectionId(a,D,he);return ve&&[ve]})},ee.prototype.addCornerTooltip=function(a,x){var V=this,G=d3.select(x);this.tooltipService.addTooltip(G,function(){return(0,o.JW)(a)},function(){var D=V.getItemSelectionId(a,void 0,void 0);return D&&[D]})},ee.prototype.getHeaderHandler=function(a,x,V){var G=this;return{addTooltip:function(j,C){return G.addHeaderTooltip(j,C,a,x,V)},removeTooltip:function(j,C){return G.removeTooltip(C)},isTooltipEnabled:function(j){return G.tooltipsEnabled&&void 0!==j.valueFormatted},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return G.tooltipsEnabled}}},ee.prototype.removeTooltip=function(a){var x=d3.select(a);this.tooltipService.removeTooltips(x)},ee.prototype.getItemSelectionId=function(a,x,V){if(a){var G=this.selectionManager.createSelectorsByColumn(a),D=G&&k.l0.fromSelectorsByColumnAndRoles(G,x);return D&&V&&(D.exclude=(0,W.pi)((0,W.pi)({},D.exclude),V??{})),D}},ee.prototype.setTooltipDelegateTop=function(a,x,V,G,D,j,C,F){var O,Q,he,U=this,ve=d3.select(x),Se=null===(he=(Q=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===he?void 0:he.call(Q),xe=((O={})[0]=!Se,O);this.tooltipService.addTooltip(ve,function(Ce){return!U.tooltipsEnabled&&F(Ce)?null:V(Ce.context)===ie.aP.Prefix?(0,o.JW)(a(Ce),!U.tooltipsEnabled):(0,o.re)(a(Ce),G,D,U.totalLabel,U.valueLabel,!U.tooltipsEnabled)},function(Ce){return U.tooltipsEnabled?V(Ce.context)===ie.aP.Prefix?(Pe=U.getItemSelectionId(a(Ce),void 0,void 0))&&[Pe]:(Pe=U.getItemSelectionId(a(Ce),j,xe))&&[Pe]:null;var Pe},!0,!0,C)},ee.prototype.setTooltipDelegateMidOrBot=function(a,x,V,G,D,j,C,F){var O,Q,he,U=this,ve=d3.select(x),Se=null===(he=(Q=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===he?void 0:he.call(Q),xe=((O={})[0]=!Se,O);this.tooltipService.addTooltip(ve,function(Ce){return!U.tooltipsEnabled&&F(Ce)?null:V(Ce.context)===ie.aP.Prefix?(0,o.re)(a(Ce),G,D,U.totalLabel,U.valueLabel,!U.tooltipsEnabled):(0,o.d4)(a(Ce),U.valueLabel,!U.tooltipsEnabled)},function(Ce){return U.tooltipsEnabled?V(Ce.context)===ie.aP.Prefix?(Pe=U.getItemSelectionId(a(Ce),j,xe))&&[Pe]:(Pe=U.getItemSelectionId(a(Ce),B.r.values,void 0))&&[Pe]:null;var Pe},!0,!0,C)},ee}(),q=X(28579),ne=X(54522),re=X(44977),E=X(32105),m=X(55007),S=X(40550),d=X(19650),g=X(64067),y=X(79154),L=X(48066),M=X(38078),Y=X(58702),c=X(7911),e=X(93340),t=X(71090),l=X(93568),s=X(91468),f=X(32771),u=X(29043),i=X(76797),h=X(59784),P=X(66842),p=X(67016),v=function(){function ee(a,x,V,G,D,j){this.selectionManager=x,this.sortingManager=V,this.hostServices=G,this.isA11yMatrix=j,this.specificColumnHeaderFontInfo={},this.binderOptions=a,this.measureElement=(0,s.qk)(D),this.legacyTooltipsEnabled=!0}return ee.prototype.setFormatMode=function(a){this.formatMode=a},ee.prototype.setRowNavigator=function(a){this.rowNavigator=a},ee.prototype.setColumnNavigator=function(a){this.columnNavigator=a},ee.prototype.getRowHeaderBinding=function(a,x,V,G,D,j,C,F,O){var U=this;this.binderOptions.onBindRowHeader&&!x&&this.binderOptions.onBindRowHeader(a);var Se,xe,Q=a.hierarchyLevel&&a.hierarchyLevel.sources,he=Q&&Q.length>1,ve=(0,M.HZ)(this.getRowHeaderLabel(a));if(this.formattingProperties.rowHeaders.wordWrap&&(ve=(0,s.rP)(ve)),_.isEmpty(ve)&&(ve=t.jv),!he){var Ce=this.rowNavigator.getRowHeaderMetadataColumn(a),Pe=(0,e.MN)(Ce,ve);if(Pe!==L.av.NONE){var Le=(0,M.HZ)(a.valueFormatted);xe=(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,Pe),Se=(0,s.RD)(ve,Le,xe,function(Ee,Ue){return U.binderOptions.onHyperlinkClicked(Ee,Ue)})}else if((0,e.Or)(a,Ce)){var Oe=m.FX.PropAltTextValue.getValue(a.objects),Ne=this.formattingProperties.grid;Se=(0,s.D2)(ve,Ne.imageHeight,Ne.imageWidth,Oe)}}Se=Se?{children:[Se],classNames:[],styleProperties:{},attributes:{}}:{content:ve,classNames:[],styleProperties:{},attributes:{}};var Me,Ie,He=this.getExpandCollapseButtonBinding(a,O),Be=this.formattingProperties.rowHeaders.steppedLayout;if(!x&&this.selectionManager.isRowHeaderIndicatorOn(a,Be)){var Te=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,a.position.column.isFirst,a.position.column.isLast,!0,ie.p0.MatrixRowHeader),Ge=j&&this.selectionManager.isRowHeaderIndicatorOn(j,Be);Ie={attributes:{},classNames:[],styleProperties:{width:"100%",top:Te.weightTop+"px",bottom:Ge?"0":Te.weightBottom+"px",left:Te.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},this.selectionManager.getIndicatorStyle()===i.D.RowHeader?Ie.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):Ie.children[0].attributes["aria-hidden"]="true"}He||Ie?(Me={attributes:{},classNames:[],styleProperties:{},children:[Se]},He&&(Se.classNames.push("expandableContent"),Me.classNames.push("expandableCell"),Me.children.unshift(He)),Ie&&Me.children.push(Ie)):Me=Se;var We,ke=!_.isEmpty(ve?.trim());return F&&((We=new e.ri).row=F.position.row,We.column=a.position.column),_.assign(Me.styleProperties,this.getRowHeaderStyleAttributes(a,x,ke,C,F,We)),this.addRowHeaderClasses(a,!!xe,Se.classNames,Me.classNames),this.isA11yMatrix&&(Me.attributes||(Me.attributes={}),Me.attributes.role="rowheader"),V&&(null!=a.children?(Me.classNames.push(n.cy),Me.attributes[n.Ez]="".concat("rowHeaders"),Me.attributes[n.QZ]="".concat(1),Me.attributes[n.CK]="Visual_Tablix_RowHeaders"):a.isSubtotal&&(a.position.row.isFirst?(Me.classNames.push(n.cy),Me.attributes[n.Ez]="".concat("total-row"),Me.attributes[n.QZ]="".concat(1),Me.attributes[n.CK]="Visual_Tablix_Matrix_Row_TotalGrand"):(Me.classNames.push(n.cy),Me.attributes[n.Ez]="".concat("subtotal-row-labels"),Me.attributes[n.QZ]="".concat(1),Me.attributes[n.CK]="Visual_Subtotal_Label",Me.attributes[n.kv]=JSON.stringify({reference:p.t.subTotals.rowSubtotalsLabel,style:3}).replace(/\"/g,"&quot;")))),Me},ee.prototype.getExpandCollapseButtonBinding=function(a,x){var V=this,G=this.getRowsExpandCollapseButtonSize(a);if(0!==G){var D,j,C=["expandCollapseButton"];if(void 0===a.isCollapsed||x)D="";else{var F=a.isCollapsed?"pbi-glyph-explore-content-single":"pbi-glyph-collapse-content-single",O=this.hostServices.getLocalizedString(a.isCollapsed?"FieldListProperty_Collapsed":"FieldListProperty_Expanded");D='<i role="button" aria-label="'.concat(O,'" class="glyphicon ').concat(F,'"></i>'),this.isExpandCollapseEnabled?(C.push("clickable"),j=function(Q){V.binderOptions.onRowHeaderExpansionChange(a,!a.isCollapsed),Q.stopPropagation()}):C.push("disabled")}return{content:D,classNames:C,styleProperties:{width:G+t.wH,height:G+t.wH,color:this.formattingProperties.rowHeaders.expandCollapseButtonsColor,"font-size":this.expandCollapseButtonFontInfo.fontProperties.size.px+t.wH},attributes:{},clickHandler:j}}},ee.prototype.getRowsExpandCollapseButtonSize=function(a){return this.formattingProperties.rowHeaders.showExpandCollapseButtons&&a.hierarchyLevel&&(a.hierarchyLevel.canBeExpanded||a.level&&this.formattingProperties.rowHeaders.steppedLayout)?this.expandCollapseButtonFontInfo.measuredFontHeight:0},ee.prototype.getColumnHeaderBinding=function(a,x,V,G,D,j){var C=(0,M.HZ)(this.getColumnHeaderLabel(a));this.formattingProperties.columnHeaders.wordWrap&&(C=(0,s.rP)(C)),_.isEmpty(C)&&(C=t.jv);var F=!_.isEmpty(C?.trim()),O=this.getColumnHeaderStyle(a,this.getColumnHeaderFontInfo(a),x,F),U=O.getExtraBottom();a.position.row.isLast&&(O.paddings.bottom+=(0,s.tO)(this.glyphFontInfo.measuredFontHeight));var ve,Q=this.columnNavigator.getColumnHeaderMetadataColumn(a),he=(0,e.MN)(Q,C),xe={tagName:"div",content:C,attributes:{},classNames:[this.formattingProperties.columnHeaders.wordWrap?s.n2:s.wV],styleProperties:{}};if(he!==L.av.NONE){var Ce=(0,M.HZ)(a.valueFormatted);ve=(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,he),xe=(0,s.RD)(xe,Ce,ve,this.binderOptions.onHyperlinkClicked)}else if((0,e.Or)(a,Q)){var Pe=m.FX.PropAltTextValue.getValue(a.objects),Le=this.formattingProperties.grid;xe=(0,s.D2)(C,Le.imageHeight,Le.imageWidth,Pe)}var Oe=this.getColumnHeaderClasses(a,!!ve),Ne={};G&&(Oe.push(n.cy),Ne[n.QZ]="".concat(1),Ne[n.Ez]="".concat("columnHeaders"),Ne[n.CK]="Visual_Tablix_ColumnHeaders");var Me={tagName:"div",children:[xe],classNames:Oe,styleProperties:this.getColumnHeaderStyleAttributes(a,O,j),attributes:Ne};if(a.position.row.isLast){var He=this.binderOptions.sortingEnabled&&this.sortingManager.isColumnHeaderSortable(a),Ie=this.sortingManager.getColumnHeaderSortDirection(a),Be=(0,s.Km)(Ie,this.binderOptions.sortIconEnabled,He,h.S.getNextSortDirection(Ie,Q),U,this.glyphFontInfo.textProperties.fontSize,this.hostServices);Me.children.push(Be),1===Ie?Me.attributes["aria-sort"]="ascending":2===Ie&&(Me.attributes["aria-sort"]="descending")}if(!x&&this.selectionManager.isColumnHeaderIndicatorOn(a)){var Te=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,!1,a.position.column.isLast,!0,ie.p0.Header),Ge=D&&this.selectionManager.isColumnHeaderIndicatorOn(D),ke={attributes:{},classNames:[],styleProperties:{height:"5px",left:Te.weightLeft+"px",right:Ge?"0":Te.weightRight+"px",bottom:Te.weightBottom+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"0",y1:"2",x2:"100%",y2:"2",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"0",y1:"4",x2:"100%",y2:"4",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}}]}]};this.selectionManager.getIndicatorStyle()===i.D.ColumnHeader?ke.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):ke.children[0].attributes["aria-hidden"]="true",Me.children.push(ke)}return Me},ee.prototype.getBodyCellBinding=function(a,x,V,G,D,j,C){var O,F=(0,M.HZ)(this.getBodyCellContent(a)),U=!_.isEmpty(F?.trim()),Q=this.getBodyCellStyle(a,this.getBodyCellFontInfo(a),x,U);this.formattingProperties.values.underline&&U&&(Q.textDecoration=y.f0);var Le,he=a.columnMetadata,ve=he&&this.columnsDataBarsSettings[he.queryName],Se=this.shouldApplyDataBars(ve,a),xe=he&&this.formattingProperties.columnFormatting[he.queryName],Ce=(0,Y.TS)(xe&&xe.icon,a.icon),Pe=a.hyperlink;if(Ce&&"IconOnly"===Ce.layout)F="";else if(_.isEmpty(F)&&(F=t.jv),a.isKpi)F=(0,s.kJ)(a.columnMetadata.kpi,a.textContent);else if(Se&&ve.hideText)F=x?t.jv:"";else{this.formattingProperties.values.wordWrap&&(F=(0,s.rP)(F));var Oe=(0,e.MN)(a.columnMetadata,F);if(Oe!==L.av.NONE)O=(0,s.RP)(this.formattingProperties.values.urlIcon,Oe),Le=(0,s.RD)(F,(0,M.HZ)(a.textContent),O,this.binderOptions.onHyperlinkClicked),Pe=void 0;else if(this.isImage(a)){var Ne=M.b$.encodeUriForImageDataSvg(a.textContent),Me=this.formattingProperties.grid;Le=(0,s.D2)(Ne,Me.imageHeight,Me.imageWidth,(0,M.HZ)(a.altText))}else this.isSparkline(a)&&(F=x?t.jv:"")}this.binderOptions.hyperlinksEnabled&&(Le||""!==F&&F!==t.jv)&&Pe&&(0,L.MN)(Pe)!==L.av.NONE&&(Le=(0,s.RD)(Le||F,(0,M.HZ)(Pe),null,this.binderOptions.onHyperlinkClicked,!0,!0));var Ie,_e,He={tagName:"div",classNames:[],styleProperties:{},attributes:{}};if(Le?He.children=[Le]:He.content=F,Le=He,Ce&&(Ie=this.getBodyCellFontInfo(a).measuredFontHeight,He=(0,s.Ps)(Ce,Ie,Le,this.hostServices)),Se&&!x&&(He=(0,f.JF)(He,ve,Q,a.dataPoint,this.hostServices)),!x&&this.isSparkline(a)&&(w.fF.assert(function(){return null!=V&&null!=G},"height and width should be defined for sparkline rendering"),He=(0,u.MV)(He,this.sparklineSettings[a.columnMetadata.queryName],Q,a.dataPoint,V,G,Ce,Ie)),this.isA11yMatrix&&(a.fontColor||a.backColor)){var ze=this.hostServices.getLocalizedString(t.Sl);_.isEmpty(He.children)?He={attributes:{},classNames:[],styleProperties:{},children:[He,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:ze}]}:He.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:ze})}if(this.isA11yMatrix&&!x&&this.selectionManager.isBodyCellIndicatorOn(a)){var De=this.formattingProperties.rowHeaders.steppedLayout,ke=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast&&(!De||De&&!this.formattingProperties.general.rowSubtotals)||De&&a.isRowGrandTotal,a.position.column.isFirst,a.position.column.isLast,!0,ie.p0.Body),We=C&&this.selectionManager.isBodyCellIndicatorOn(C);_e={attributes:{},classNames:[],styleProperties:{width:"100%",top:ke.weightTop+"px",bottom:We?"0":ke.weightBottom+"px",left:ke.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},He.content?He={attributes:{},classNames:[],styleProperties:{},children:[He,_e]}:(He.children||(He.children=[]),He.children.push(_e))}return j&&(a.isGrandTotal?(He.classNames.push(n.cy),He.attributes[n.QZ]="".concat(1),a.isColumnGrandTotal?(He.attributes[n.Ez]="".concat("total-column"),He.attributes[n.CK]="Visual_TotalColumn"):(He.attributes[n.Ez]="".concat("total-row"),He.attributes[n.CK]="Visual_TotalRow")):(a.isRowSubTotal||a.isColumnSubTotal)&&(He.classNames.push(n.cy),He.attributes[n.QZ]="".concat(1),a.isColumnSubTotal?(He.attributes[n.Ez]="".concat("subtotal-column"),He.attributes[n.CK]="Visual_SubtotalColumn"):(He.classNames.push(n.cy),He.attributes[n.Ez]="".concat("subtotal-row"),He.attributes[n.CK]="Visual_SubtotalRow"))),this.addBodyCellClasses(a,!!O,Le.classNames,He.classNames),this.addBodyCellStyleAttributes(a,Q,Le.styleProperties,He.styleProperties,G),He},ee.prototype.getCornerCellBinding=function(a,x,V,G,D){var j=(0,M.HZ)(this.getCornerCellLabel(a)),C={},F=this.getCornerCellClasses(a);G&&(F.push(n.cy),C[n.Ez]="".concat("columnHeaders"),C[n.QZ]="".concat(1),C[n.CK]="Visual_Tablix_ColumnHeaders"),C.columnLevel=this.rowNavigator.getColumnLevel(a).toString(),C.rowLevel=this.rowNavigator.getRowLevel(a).toString(),this.formattingProperties.columnHeaders.wordWrap&&(j=(0,s.rP)(j)),_.isEmpty(j)&&(j=t.jv);var O=!_.isEmpty(j?.trim()),U=this.getCornerCellStyle(a,this.getCornerCellFontInfo(),x,O);if(a.position.row.isLast){var Q=this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(a),he=this.sortingManager.getCornerSortDirection(a),Se=(0,s.Km)(he,this.binderOptions.sortIconEnabled,Q,he??1,U.getExtraBottom(),this.glyphFontInfo.textProperties.fontSize,this.hostServices);j+=c.bG.build(Se),U.paddings.bottom+=(0,s.tO)(this.glyphFontInfo.measuredFontHeight),1===he?C["aria-sort"]="ascending":2===he&&(C["aria-sort"]="descending")}return{content:j,classNames:F,styleProperties:U.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,D),attributes:C}},ee.prototype.getApproximateRowHeaderWidth=function(a){var x,V,G,D,U,j=this.rowNavigator.getRowHeaderMetadataColumn(a),C=this.getRowHeaderLabel(a),F=(0,e.MN)(j,C),O=this.rowHeaderFontInfo.fontProperties.size.px;if(F!==L.av.NONE&&(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,F))U=O;else if((0,e.Or)(a,j))U=this.formattingProperties.grid.imageWidth;else{var Q=this.getRowHeaderFontInfo(a),he=this.getRowHeaderStyle(a,Q,!0,!0,void 0,void 0);U=(this.formattingProperties.rowHeaders.wordWrap?(0,s.JT)(C,Q.textProperties):(0,s.X1)(C,Q.textProperties))+(null!==(V=null===(x=he.borders.left)||void 0===x?void 0:x.weight)&&void 0!==V?V:0)+(null!==(D=null===(G=he.borders.right)||void 0===G?void 0:G.weight)&&void 0!==D?D:0)}var Ce=this.getRowsExpandCollapseButtonSize(a);return Ce>0&&(U+=Ce+s.s$),U},ee.prototype.getApproximateColumnHeaderWidth=function(a){var x,V,G,D,j=this.columnNavigator.getColumnHeaderMetadataColumn(a),C=this.getColumnHeaderLabel(a),F=(0,e.MN)(j,C);if(F!==L.av.NONE&&(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,F))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(a,j))return this.formattingProperties.grid.imageWidth;var O=this.getColumnHeaderFontInfo(a),U=this.getColumnHeaderStyle(a,O,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,s.JT)(C,O.textProperties):(0,s.X1)(C,O.textProperties))+(null!==(V=null===(x=U.borders.left)||void 0===x?void 0:x.weight)&&void 0!==V?V:0)+(null!==(D=null===(G=U.borders.right)||void 0===G?void 0:G.weight)&&void 0!==D?D:0)},ee.prototype.getApproximateBodyCellWidth=function(a){var x,V,G,D,j=0;if(a.icon){if(j=this.getBodyCellFontInfo(a).measuredFontHeight,"IconOnly"===a.icon.layout)return j;j+=s.MO}if(a.isKpi)return j+this.valueFontInfo.fontProperties.size.px;var C=a.columnMetadata&&this.columnsDataBarsSettings[a.columnMetadata.queryName];if(this.shouldApplyDataBars(C,a)&&C.hideText)return j;var F=this.getBodyCellContent(a);if(this.isUrlIcon(a,F))return j+this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return j+this.formattingProperties.grid.imageWidth;if(this.isSparkline(a))return j;var O=this.getBodyCellFontInfo(a),U=this.getBodyCellStyle(a,O,!0,!0);return j+(this.formattingProperties.values.wordWrap?(0,s.JT)(F,O.textProperties):(0,s.X1)(F,O.textProperties))+(null!==(V=null===(x=U.borders.left)||void 0===x?void 0:x.weight)&&void 0!==V?V:0)+(null!==(D=null===(G=U.borders.right)||void 0===G?void 0:G.weight)&&void 0!==D?D:0)},ee.prototype.getApproximateCornerCellWidth=function(a){var x,V,G,D,j=this.getCornerCellFontInfo(),C=this.getCornerCellStyle(a,j,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,s.JT)(this.getCornerCellLabel(a),j.textProperties):(0,s.X1)(this.getCornerCellLabel(a),j.textProperties))+(null!==(V=null===(x=C.borders.left)||void 0===x?void 0:x.weight)&&void 0!==V?V:0)+(null!==(D=null===(G=C.borders.right)||void 0===G?void 0:G.weight)&&void 0!==D?D:0)},ee.prototype.getApproximateRowHeaderHeight=function(a,x){var V,G,D,j,U,C=this.rowNavigator.getRowHeaderMetadataColumn(a),F=this.getRowHeaderLabel(a),O=(0,e.MN)(C,F),Q=this.getRowsExpandCollapseButtonSize(a);if(O!==L.av.NONE&&(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,O))U=this.rowHeaderFontInfo.fontProperties.size.px;else if((0,e.Or)(a,C))U=this.formattingProperties.grid.imageHeight;else{var he,ve=this.getRowHeaderFontInfo(a);x-=this.getRowsExpandCollapseButtonSize(a);var Se=this.getRowHeaderStyle(a,ve,!0,!0,void 0,void 0);he=this.formattingProperties.rowHeaders.wordWrap?(0,s.do)(F,(0,s.x9)(x,Se),ve.textProperties).length:1;var xe=null!==(G=null===(V=Se.borders.top)||void 0===V?void 0:V.weight)&&void 0!==G?G:0,Ce=null!==(j=null===(D=Se.borders.bottom)||void 0===D?void 0:D.weight)&&void 0!==j?j:0;U=ve.measuredFontHeight*he+xe+Ce}return void 0===a.isCollapsed?U:Math.max(Q,U)},ee.prototype.getApproximateColumnHeaderHeight=function(a,x){var V,G,D,j,C=this.columnNavigator.getColumnHeaderMetadataColumn(a),F=this.getColumnHeaderLabel(a),O=(0,e.MN)(C,F);if(O!==L.av.NONE&&(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,O))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(a,C))return this.formattingProperties.grid.imageHeight;var U,Q=this.getColumnHeaderFontInfo(a),he=this.getColumnHeaderStyle(a,Q,!0,!0);U=this.formattingProperties.columnHeaders.wordWrap?(0,s.do)(F,(0,s.x9)(x,he),Q.textProperties).length:1;var ve=null!==(G=null===(V=he.borders.top)||void 0===V?void 0:V.weight)&&void 0!==G?G:0,Se=null!==(j=null===(D=he.borders.bottom)||void 0===D?void 0:D.weight)&&void 0!==j?j:0;return Q.measuredFontHeight*U+ve+Se},ee.prototype.getApproximateBodyCellHeight=function(a,x){var V,G,D,j,C=this.getBodyCellFontInfo(a);if(a.icon&&"IconOnly"===a.icon.layout)return C.measuredFontHeight;if(a.isKpi)return this.valueFontInfo.fontProperties.size.px;var F=this.getBodyCellContent(a);if(this.isUrlIcon(a,F))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(a))return C.measuredFontHeight;var O,U=this.getBodyCellStyle(a,C,!0,!0);this.formattingProperties.values.wordWrap&&null!=x?(a.icon&&(x-=C.measuredFontHeight+s.MO),O=(0,s.do)(F,(0,s.x9)(x,U),C.textProperties).length):O=1;var Q=null!==(G=null===(V=U.borders.top)||void 0===V?void 0:V.weight)&&void 0!==G?G:0,he=null!==(j=null===(D=U.borders.bottom)||void 0===D?void 0:D.weight)&&void 0!==j?j:0;return C.measuredFontHeight*O+Q+he},ee.prototype.getApproximateCornerCellHeight=function(a,x){var V,G,D,j,C,F=this.getCornerCellFontInfo(),O=this.getCornerCellStyle(a,F,!0,!0);C=this.formattingProperties.columnHeaders.wordWrap?(0,s.do)(this.getCornerCellLabel(a),(0,s.x9)(x,O),F.textProperties).length:1;var U=null!==(G=null===(V=O.borders.top)||void 0===V?void 0:V.weight)&&void 0!==G?G:0,Q=null!==(j=null===(D=O.borders.bottom)||void 0===D?void 0:D.weight)&&void 0!==j?j:0;return F.measuredFontHeight*C+U+Q},ee.prototype.blankRowsEnabled=function(){return this.formattingProperties.blankRows.showBlankRows},ee.prototype.getSectionProperties=function(a){var x;switch(a){case ie.p0.Header:x=this.formattingProperties.columnHeaders;break;case ie.p0.Body:x=this.formattingProperties.values;break;case ie.p0.MatrixRowHeader:x=this.formattingProperties.rowHeaders;break;default:w.fF.assertNever(a)}return x},ee.prototype.getBorderInfo=function(a,x,V,G,D,j){var C,F,O,U,xe,Ce,Pe,Le,Oe,Ne,Me,He,Q=0,he=0,ve=0,Se=0,Ie=this.getSectionProperties(j),Be=null!==(C=Ie.outlineWeight)&&void 0!==C?C:this.formattingProperties.grid.outlineWeight,ze=null!==(F=Ie.outlineColor)&&void 0!==F?F:this.formattingProperties.grid.outlineColor,_e=null===(O=this.formattingProperties.grid)||void 0===O?void 0:O.gridHorizontalColor,De=null===(U=this.formattingProperties.grid)||void 0===U?void 0:U.gridVerticalColor,Ae=(0,g.ok)("#FFFFFF",.7,_e),Te=(0,g.ok)("#FFFFFF",.7,De);return a&&(0,S.yo)(Ie.outline)&&(Q=Be,xe=e.Pb.Outline,Oe=ze),G&&(0,S.BK)(Ie.outline)?(he=Be,Ce=e.Pb.Outline,Ne=ze):!G&&this.formattingProperties.grid.gridVertical&&(he=this.formattingProperties.grid.gridVerticalWeight,Ce=e.Pb.Gridline,Ne=this.selectionManager.isSelectionEmpty()?De:Te),x&&(0,S.mv)(Ie.outline)?(ve=Be,Pe=e.Pb.Outline,Me=ze):!x&&this.formattingProperties.grid.gridHorizontal&&(ve=this.formattingProperties.grid.gridHorizontalWeight,Pe=e.Pb.Gridline,Me=D?_e:Ae),V&&(0,S.fs)(Ie.outline)&&(Se=Be,Le=e.Pb.Outline,He=ze),{weightTop:Q,weightRight:he,weightBottom:ve,weightLeft:Se,typeTop:xe,typeRight:Ce,typeBottom:Pe,typeLeft:Le,colorTop:Oe,colorRight:Ne,colorBottom:Me,colorLeft:He}},ee.prototype.isUrlIcon=function(a,x){var V=(0,e.MN)(a.columnMetadata,x);return V!==L.av.NONE&&!!(0,s.RP)(this.formattingProperties.values.urlIcon,V)},ee.prototype.getColumnHeaderFontInfo=function(a){return H.hc.isNodeGrandTotal(a)?this.grandTotalColumnHeaderFontInfo:a.hasSubtotalStyle?this.subtotalColumnHeaderFontInfo:this.specificColumnHeaderFontInfo[a.queryName]||this.columnHeaderFontInfo},ee.prototype.getRowHeaderFontInfo=function(a){return H.hc.isNodeGrandTotal(a)?this.grandTotalRowHeaderFontInfo:a.hasSubtotalStyle?this.subtotalRowHeaderFontInfo:this.rowHeaderFontInfo},ee.prototype.getBodyCellFontInfo=function(a){return a.isColumnGrandTotal?this.columnGrandTotalFontInfo:a.isRowGrandTotal?this.rowGrandTotalFontInfo:a.isColumnSubTotal?this.columnSubtotalFontInfo:a.isRowSubTotal||a.hasSubtotalStyle?this.rowSubtotalFontInfo:this.valueFontInfo},ee.prototype.getCornerCellFontInfo=function(){return this.columnHeaderFontInfo},ee.prototype.addRowHeaderClasses=function(a,x,V,G){var j,D=this.formattingProperties.rowHeaders;if(V.push(D.wordWrap?s.n2:s.wV),x&&V.push(t.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&i.l.hasIdentity(a)&&G.push(s.VM),x&&(j=d.H.center),(0,s.aY)(D.alignment,V,j),this.isA11yMatrix){var C=this.formattingProperties.rowHeaders.steppedLayout;this.selectionManager.isRowHeaderHighlighted(a)?(this.selectionManager.isRowHeaderIndicatorOn(a,C)||this.selectionManager.isRowHeaderDarkened(a))&&G.push("cell-selected"):G.push("cell-unselected")}},ee.prototype.getColumnHeaderClasses=function(a,x){var V=[],G=this.formattingProperties.columnHeaders,D=this.formattingProperties.columnFormatting[a.queryName];x&&V.push(t.LU);var O,j=i.l.hasIdentity(a),C=this.sortingManager.isColumnHeaderSortable(a);return w.fF.assert(function(){return!(j&&C)},"getColumnHeaderClasses: header selectable and sortable"),this.binderOptions.interactivityIndicatorEnabled&&(this.binderOptions.selectionEnabled&&j&&!C||this.binderOptions.sortingEnabled&&C&&!j)&&V.push(s.VM),x&&(O=d.H.center),(0,s.aY)(D&&D.styleHeader&&D.alignment||G.alignment,V,O),this.isA11yMatrix&&(this.selectionManager.isColumnHeaderHighlighted(a)?(this.selectionManager.isColumnHeaderIndicatorOn(a)||this.selectionManager.isColumnHeaderDarkened(a))&&V.push("cell-selected"):V.push("cell-unselected")),V},ee.prototype.addBodyCellClasses=function(a,x,V,G){V.push(this.formattingProperties.values.wordWrap?s.n2:s.wV),x&&V.push(t.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&!a.isRowAndColumnGrandTotal&&!a.isBlankRow&&G.push(s.VM);var D,O,C=this.formattingProperties.columnFormatting[a.columnMetadata&&a.columnMetadata.queryName];C&&(a.isGrandTotal?C.styleTotal:a.hasSubtotalStyle?C.styleSubTotals:C.styleValues)&&(D=C.alignment),x?O=d.H.center:!a.isKpi&&a.isNumeric&&(O=d.H.right),(0,s.aY)(D,V,O),this.isA11yMatrix&&(this.selectionManager.isBodyCellHighlighted(a)?!this.selectionManager.isSelectionEmpty()&&this.selectionManager.isBodyCellHighlighted(a)&&G.push("cell-selected"):G.push("cell-unselected"))},ee.prototype.getCornerCellClasses=function(a){var x=[];x.push(this.formattingProperties.columnHeaders.wordWrap?s.n2:s.wV),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(a)&&x.push(s.VM);var V=this.formattingProperties.columnHeaders.titleAlignment;return V===d.H.auto&&(V=this.formattingProperties.columnHeaders.alignment),(0,s.aY)(V,x),x},ee.prototype.getSteppedLayoutIndentation=function(a){return this.rowNavigator.getLevel(a)*this.formattingProperties.rowHeaders.steppedLayoutIndentation},ee.prototype.getRowHeaderStyle=function(a,x,V,G,D,j){var U,C=j??a.position,F=new e.qZ(s.K2,s.K2);if(this.formattingProperties.rowHeaders.underline&&G&&(F.textDecoration=y.f0),C.column.isLast&&(F.borders.right=new e.om(m.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),F.fontColor=t.lN,this.formattingProperties.blankRows.showBlankRows){var Q=this.rowNavigator.getAncestor(a),he=this.formattingProperties.general.layout===P.t.Compact?this.rowNavigator.getLeafIndex(Q):this.rowNavigator.getIndexOfFirstLeaf(Q);U=(C.row.index-he)%2!=0}(0,l.B0)(C,D??a,F,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,this.formattingProperties.values.bandedRowHeaders,!!D,U),(0,s.Nk)(x,F,G);var ve=this.formattingProperties.columnFormatting[a.queryName],Se=ve&&ve.styleHeader,xe=H.hc.isNodeGrandTotal(a)&&this.formattingProperties.rowGrandTotal.applyToHeaders,Ce=a.hasSubtotalStyle&&this.formattingProperties.rowSubtotals.applyToHeaders;return Se&&ve.fontColor?F.fontColor=ve.fontColor:xe&&this.formattingProperties.rowGrandTotal.fontColor?F.fontColor=this.formattingProperties.rowGrandTotal.fontColor:Ce&&this.formattingProperties.rowSubtotals.fontColor&&(F.fontColor=this.formattingProperties.rowSubtotals.fontColor),Se&&ve.backColor?F.backColor=ve.backColor:xe&&this.formattingProperties.rowGrandTotal.backColor?F.backColor=this.formattingProperties.rowGrandTotal.backColor:Ce&&this.formattingProperties.rowSubtotals.backColor&&(F.backColor=this.formattingProperties.rowSubtotals.backColor),this.formattingProperties.rowHeaders.steppedLayout&&(F.paddings.left+=this.getSteppedLayoutIndentation(a)),F},ee.prototype.getRowHeaderStyleAttributes=function(a,x,V,G,D,j){return this.getRowHeaderStyle(a,this.getRowHeaderFontInfo(a),x,V,D,j).getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,G)},ee.prototype.getColumnHeaderStyle=function(a,x,V,G){var D=new e.qZ(s.K2,s.K2);a.position.row.isLast&&(D.borders.bottom=new e.om(m.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),D.fontColor=t.lN,(0,l.aV)(a.position,a,D,this.formattingProperties),(0,s.Nk)(x,D,G);var C=this.formattingProperties.columnFormatting[a.queryName],F=C&&C.styleHeader,O=H.hc.isNodeGrandTotal(a)&&this.formattingProperties.columnGrandTotal.applyToHeaders,U=a.hasSubtotalStyle&&this.formattingProperties.columnSubtotals.applyToHeaders;return F&&C.fontColor?D.fontColor=C.fontColor:O&&this.formattingProperties.columnGrandTotal.fontColor?D.fontColor=this.formattingProperties.columnGrandTotal.fontColor:U&&this.formattingProperties.columnSubtotals.fontColor&&(D.fontColor=this.formattingProperties.columnSubtotals.fontColor),F&&C.backColor?D.backColor=C.backColor:O&&this.formattingProperties.columnGrandTotal.backColor?D.backColor=this.formattingProperties.columnGrandTotal.backColor:U&&this.formattingProperties.columnSubtotals.backColor&&(D.backColor=this.formattingProperties.columnSubtotals.backColor),this.formattingProperties.columnHeaders.underline&&G&&(D.textDecoration=y.f0),D},ee.prototype.getColumnHeaderStyleAttributes=function(a,x,V){var G=x.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,V);return this.isA11yMatrix||this.selectionManager.isColumnHeaderHighlighted(a)||(0,s.CQ)(G),G},ee.prototype.getBodyCellStyle=function(a,x,V,G){var j,D=new e.qZ(s.K2,s.K2);if(this.formattingProperties.blankRows.showBlankRows){var C=this.rowNavigator.getAncestor(a.rowItem),F=this.formattingProperties.general.layout===P.t.Compact?this.rowNavigator.getLeafIndex(C):this.rowNavigator.getIndexOfFirstLeaf(C);j=(a.position.row.index-F)%2!=0}return(0,l.cP)(a.position,a,D,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,j),(0,s.Nk)(x,D,G),D},ee.prototype.addBodyCellStyleAttributes=function(a,x,V,G,D){x.setAttributes(G,!1,this.isA11yMatrix,this.isA11yMatrix,D),G.position="relative",this.isA11yMatrix||this.selectionManager.isBodyCellHighlighted(a)||(0,s.CQ)(G)},ee.prototype.getCornerCellStyle=function(a,x,V,G){var D=new e.qZ(s.K2,s.K2);return D.fontColor=t.lN,this.formattingProperties.columnHeaders.underline&&G&&(D.textDecoration=y.f0),a.position.row.isLast&&(D.borders.bottom=new e.om(m.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),(0,l.qW)(a.position,D,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties),(0,s.Nk)(x,D,G),D},ee.prototype.getColumnHeaderLabel=function(a){return this.getHeaderContent(a,this.columnNavigator.getColumnHeaderMetadataColumn(a),this.columnNavigator.isColumnHeaderMultiValueSubtotal(a),this.formattingProperties.columnHeaders.wordWrap)},ee.prototype.getRowHeaderLabel=function(a){return this.getHeaderContent(a,this.rowNavigator.getRowHeaderMetadataColumn(a),this.rowNavigator.isRowHeaderMultiValueSubtotal(a),this.formattingProperties.rowHeaders.wordWrap)},ee.prototype.getBodyCellContent=function(a){return this.formattingProperties.values.wordWrap?a.textContent:(0,re.PC)(a.textContent)},ee.prototype.getCornerCellLabel=function(a){return this.formattingProperties.columnHeaders.wordWrap?a.displayName:(0,re.PC)(a.displayName)},ee.prototype.getHeaderContent=function(a,x,V,G){if(a.isSubtotal&&!V){var D=this.formattingProperties.columnFormatting[x.queryName],j=D?D.subtotalLabel:this.binderOptions.defaultTotalLabel;return G?j:(0,re.PC)(j)}var C=a.valueFormatted;return(0,s.jv)(x,C)?C:C&&(0,e.wX)(a,x,C)?M.b$.encodeUriForImageDataSvg(C):G?C:(0,re.PC)(C)},ee.prototype.onDataViewChanged=function(a,x,V,G,D){var C,j=this;this.formattingProperties=x,this.legacyTooltipsEnabled=G,this.isExpandCollapseEnabled=!!D;var F=x.general.textSize,O=new s.Kq,U={},Q={},he={};U.family=x.columnHeaders.fontFamily||t.F2,U.size=x.columnHeaders.fontSize||F,x.columnHeaders.bold&&(U.weight=y.en),x.columnHeaders.italic&&(U.style=y.BF),x.columnHeaders.underline&&(U.textDecoration=y.f0),this.columnHeaderFontInfo=(0,s.Od)(U,O),this.specificColumnHeaderFontInfo={};var ve=null===(C=this.formattingProperties.annotationFormatting)||void 0===C?void 0:C.columnHeaders;ve&&_.forEach(ve,function(_e,De){var Ae=(0,W.pi)({},U);(_e.bold||x.columnHeaders.bold)&&(Ae.weight=y.en),j.specificColumnHeaderFontInfo[De]=(0,s.Od)(Ae,O)}),he.family=x.rowHeaders.fontFamily||t.F2,he.size=x.rowHeaders.fontSize||F,x.rowHeaders.bold&&(he.weight=y.en),x.rowHeaders.italic&&(he.style=y.BF),x.rowHeaders.underline&&(he.textDecoration=y.f0),this.rowHeaderFontInfo=(0,s.Od)(he,O),this.expandCollapseButtonFontInfo=(0,s.Od)({family:"PowrMDL2",size:x.rowHeaders.expandCollapseButtonsSize||this.rowHeaderFontInfo.fontProperties.size},O),Q.family=x.values.fontFamily||t.dG,Q.size=x.values.fontSize||F,x.values.bold&&(Q.weight=y.en),x.values.italic&&(Q.style=y.BF),x.values.underline&&(Q.textDecoration=y.f0),this.valueFontInfo=(0,s.Od)(Q,O),this.columnSubtotalFontInfo=this.getSubtotalFontInfo(x.columnSubtotals,O),this.rowSubtotalFontInfo=this.getSubtotalFontInfo(x.rowSubtotals,O),this.columnGrandTotalFontInfo=this.getGrandTotalFontInfo(x.columnGrandTotal,O,this.columnSubtotalFontInfo),this.rowGrandTotalFontInfo=this.getGrandTotalFontInfo(x.rowGrandTotal,O,this.rowSubtotalFontInfo);var xe=this.columnHeaderFontInfo.fontProperties.family===t.F2,Ce=this.rowHeaderFontInfo.fontProperties.family===t.F2;this.subtotalColumnHeaderFontInfo=x.columnSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,s.TQ)(this.columnSubtotalFontInfo,{},O):(0,s.TQ)(this.columnHeaderFontInfo,ee.applyBold(xe),O),this.subtotalRowHeaderFontInfo=x.rowSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,s.TQ)(this.rowSubtotalFontInfo,{},O):(0,s.TQ)(this.rowHeaderFontInfo,ee.applyBold(Ce),O),this.grandTotalColumnHeaderFontInfo=x.columnGrandTotal.applyToHeaders?(0,s.TQ)(this.columnGrandTotalFontInfo,{},O):(0,s.TQ)(this.columnHeaderFontInfo,ee.applyBold(xe),O),this.grandTotalRowHeaderFontInfo=x.rowGrandTotal.applyToHeaders?(0,s.TQ)(this.rowGrandTotalFontInfo,{},O):(0,s.TQ)(this.rowHeaderFontInfo,ee.applyBold(Ce),O),this.glyphFontInfo=(0,s.Od)({family:t.Vz,size:E.B.createFromPt((x.columnHeaders.fontSize||F).pt*t.Yo),lineHeight:"100%"},O),O.measureAll(this.measureElement),this.columnsDataBarsSettings={};var Pe=x.columnFormatting;if(Pe&&a&&a.matrix&&!_.isEmpty(a.matrix.valueSources))for(var Le=0,Oe=a.matrix.valueSources;Le<Oe.length;Le++)(Me=(Ne=Oe[Le]).queryName)&&Pe[Me]&&(this.columnsDataBarsSettings[Me]=(0,f.az)(Ne,Pe[Me].dataBarsSettings,V));this.sparklineSettings={};var He=x.sparklines;if(He&&a&&a.matrix&&!_.isEmpty(a.matrix.valueSources))for(var Ie=0,Be=a.matrix.valueSources;Ie<Be.length;Ie++){var Ne,Me;(Me=(Ne=Be[Ie]).queryName)&&He[Me]&&(this.sparklineSettings[Me]=(0,u.wJ)(He[Me],Ne.type,V))}},ee.prototype.getGrandTotalFontInfo=function(a,x,V){var G={},D=a.fontFamily;return G.family=D,G.size=a.fontSize,a.bold&&D&&(G.weight=y.en),a.italic&&(G.style=y.BF),a.underline&&(G.textDecoration=y.f0),(0,s.TQ)(V,G,x)},ee.prototype.shouldApplyDataBars=function(a,x){if(!a||!_.isNumber(x.dataPoint))return!1;var V=x.isTotal||x.hasSubtotalStyle;switch(a.totalMatching){case 0:return!0;case 1:case void 0:return!V;case 2:return V;default:return w.fF.assertNever(a.totalMatching),!V}},ee.prototype.isImage=function(a){return(0,ne.pt)(a.columnMetadata)},ee.prototype.isSparkline=function(a){var x,V=a.columnMetadata,G=null===(x=V?.type)||void 0===x?void 0:x.misc;return null!=G&&null!=G.sparkline},ee.applyBold=function(a){return{family:a?t.Zk:void 0,weight:a?void 0:y.en}},ee.prototype.getSubtotalFontInfo=function(a,x){var G,V=a.fontFamily;V||this.valueFontInfo.fontProperties.family!==t.dG?G=!0:this.valueFontInfo.fontProperties.family===t.dG&&(V=t.Zk);var D={};return D.family=V,D.size=a.fontSize,a.bold&&G&&(D.weight=y.en),a.italic&&(D.style=y.BF),a.underline&&(D.textDecoration=y.f0),(0,s.TQ)(this.valueFontInfo,D,x)},ee.prototype.setHorizontalBorderXPositions=function(a,x){var V="0",G="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[V,G];switch(x){case ie.p0.Header:V="0",G="100%";break;case ie.p0.Body:V=a.toString();break;case ie.p0.MatrixRowHeader:V="0",G=a.toString();break;default:w.fF.assertFail("this should never be the case")}return[V,G]},ee.prototype.setVerticalBorderYPositions=function(a,x){var V="0",G="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[V,G];switch(x){case ie.p0.Header:V="0",G="100%";break;case ie.p0.Body:break;case ie.p0.MatrixRowHeader:V="0",G=a.toString();break;default:w.fF.assertFail("this should never be the case")}return[V,G]},ee}(),b=X(31577),T=X(82386),R=X(59151),z=function(){function ee(a){this.hostServices=a}return ee.prototype.onDataViewChanged=function(a,x,V,G){this.columnHierarchy=a,this.valueSources=x,this.metatdataObjects=V,this.valuesOnRowApplied=G,this.hasColumnGrouping=(0,T.pr)(this.columnHierarchy)>0,this.hasMultiMeasureOnColumns=!_.isEmpty(this.valueSources)&&this.valueSources.length>1&&!this.valuesOnRowApplied,this.headerPendingChanges=[],this.cornerPendingChanges=[]},ee.prototype.getNodeSelector=function(a){if(w.fF.assertValue(a,"PivotTableSizeManager.getNodeSelector: header"),!this.hasColumnGrouping){if(a.queryName)return{metadata:a.queryName};if(this.valuesOnRowApplied)return null}for(var x={};a;){if(this.hasMultiMeasureOnColumns&&a.level===this.columnHierarchy.levels.length-1)x.metadata=a.queryName;else if(a.isSubtotal){for(var V=[],D=0,j=this.columnHierarchy.levels[a.level].sources;D<j.length;D++){var C=j[D];_.isEmpty(C.identityExprs)||V.push.apply(V,C.identityExprs||[])}_.isEmpty(V)||(x.data=[(0,b.ms)(V)])}else a.identity&&(x.data?x.data.splice(0,0,a.identity):x.data=[a.identity]);a=a.parent}return x},ee.prototype.getCornerSelector=function(a){if(w.fF.assertValue(a,"PivotTableSizeManager.getCornerSelector: corner"),a.metadata&&a.metadata.queryName)return{metadata:a.metadata.queryName}},ee.prototype.getHeaderPendingChange=function(a){return _.find(this.headerPendingChanges,function(x){return i.l.areHeadersEqual(x.cell,a)})},ee.prototype.getCornerPendingChange=function(a){return _.find(this.cornerPendingChanges,function(x){return i.l.areCornerItemsEqual(x.cell,a)})},ee.prototype.queueHeaderPendingChange=function(a,x){var V=this.getHeaderPendingChange(a);V?V.width=x:this.headerPendingChanges.push({cell:a,width:x})},ee.prototype.queueCornerPendingChange=function(a,x){var V=this.getCornerPendingChange(a);V?V.width=x:this.cornerPendingChanges.push({cell:a,width:x})},ee.prototype.getColumnWidth=function(a){w.fF.assertValue(a,"PivotTableSizeManager.getColumnWidth: header");var V,x=this.getHeaderPendingChange(a);return x?x.width:(this.hasColumnGrouping?V=a.objects:a.queryName?V=this.valueSources[a.levelSourceIndex||0].objects:this.valuesOnRowApplied&&(V=this.metatdataObjects),m.FX.PropColumnWidthValue.getValue(V))},ee.prototype.setColumnWidth=function(a,x){var V=this.getNodeSelector(a);this.queueHeaderPendingChange(a,x),(0,R.P)([{selector:V,value:x}],this.hostServices,!1)},ee.prototype.getRowHeight=function(a){},ee.prototype.setRowHeight=function(a,x){},ee.prototype.getRowLevelWidth=function(a){w.fF.assertValue(a,"PivotTableSizeManager.getRowLevelWidth: cornerCell");var x=this.getCornerPendingChange(a);return x?x.width:a.metadata&&a.metadata.objects?m.FX.PropColumnWidthValue.getValue(a.metadata.objects):void 0},ee.prototype.setRowLevelWidth=function(a,x){var V=this.getCornerSelector(a);V&&(this.queueCornerPendingChange(a,x),(0,R.P)([{selector:V,value:x}],this.hostServices,!1))},ee.prototype.getColumnLevelHeight=function(a){},ee.prototype.setColumnLevelHeight=function(a,x){},ee.prototype.setMissingWidths=function(a,x){for(var V=[],G=0,D=a;G<D.length;G++){var j=D[G],C=j.node,F=j.width;null==this.getColumnWidth(C)&&(this.queueHeaderPendingChange(C,F),V.push({selector:this.getNodeSelector(C),value:F}))}for(var O=0,U=x;O<U.length;O++){var Q=U[O],he=Q.corner,ve=(F=Q.width,this.getCornerSelector(he));ve&&null==this.getRowLevelWidth(he)&&(this.queueCornerPendingChange(he,F),V.push({selector:ve,value:F}))}_.isEmpty(V)||(0,R.P)(V,this.hostServices,!0)},ee.prototype.clearWidths=function(a,x){for(var V=[],G=0,D=a;G<D.length;G++){var j=D[G];null!=this.getColumnWidth(j)&&V.push({selector:this.getNodeSelector(j),value:void 0}),this.queueHeaderPendingChange(j,void 0)}for(var C=0,F=x;C<F.length;C++){var O=F[C];null!=this.getRowLevelWidth(O)&&V.push({selector:this.getCornerSelector(O),value:void 0}),this.queueCornerPendingChange(O,void 0)}_.isEmpty(V)||(0,R.P)(V,this.hostServices,!0)},ee}(),N=X(11184),J=X(98094),oe=X(48645),pe=X(86900),se=X(24133),A=X(73889),ae=X(74304),ge=X(40845),be=X(12913),me=function(){function ee(a,x){void 0===a&&(a=(0,ce.DH)()),this.options=a,this.annotationHighlightElementToRegionIdMap=new Map,this.featureSwitches=x||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.showAsTableNativeMenuEnabled=this.options.showAsTableNativeMenuEnabled,this.tooltipType=0,this.asyncSerializer=new te.W,this.supportsOnObject=!!this.featureSwitches.onObject,this.enableCalculationHighlighting=!!this.featureSwitches.enableCalculationHighlighting,this.numFontDelays=0}return ee.prototype.init=function(a){var V,x=this;this.currentViewport=a.viewport,this.element=a.element,this.hostServices=a.host,this.waitingForData=!1,this.style=a.style,this.tablixPropertyManager=new ae.U(this.style),this.selectionManager=new i.l(this.hostServices,this.featureSwitches),this.sortingManager=new h.S(this.hostServices),this.sizeManager=new z(this.hostServices),this.tooltipService=(0,r.r)(a.host),this.valueLabel=this.hostServices.getLocalizedString(t.yF),this.totalLabel=this.hostServices.getLocalizedString(t.qT);var D=(null===(V=this.hostServices)||void 0===V?void 0:V.getSubSelectionService())??pe.D.createWithDefaultHost(),j=new oe.y(D);this.enableCalculationHighlighting&&(this.annotationHelper=n.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:j,targetSource:"annotation",scale:function(){return x.currentViewport.scale},customElementRegionOutlineIdCallback:function(F){return x.getAnnotationHighlightElementSubSelectionOutlineRegionId(F)},customScrollCallbacks:{onScrollStart:function(){return x.annotationHighlightOnScrollStart()},onScrollEnd:function(){return x.annotationHighlightOnScrollEnd()}}})),this.supportsOnObject&&(this.subSelectionHelper=n.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:j,targetSource:"format",scale:function(){return x.currentViewport.scale}}))},ee.prototype.update=function(a){return(0,W.mG)(this,void 0,void 0,function(){var x=this;return(0,W.Jh)(this,function(V){switch(V.label){case 0:return[4,this.asyncSerializer.enqueue(function(){return(0,W.mG)(x,void 0,void 0,function(){var G,D,j,C,F,O,U;return(0,W.Jh)(this,function(Q){switch(Q.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new J.J(function(he){return setTimeout(he,500)})]:[3,2];case 1:return Q.sent(),this.numFontDelays++,[3,0];case 2:return a.type&le.EP.Data?[4,this.onDataViewChanged(a.dataViews,a.operationKind,a.viewport)]:[3,4];case 3:Q.sent(),Q.label=4;case 4:return this.pivotTableControl&&a.type&le.EP.Resize?(G=this.getVisibleRowStart(this.getPreviousVisibleRowStart(),!1),D=this.getVisibleColumnStart(this.getPreviousVisibleColumnStart()),this.pivotTableControl.setWidth(a.viewport.width),this.pivotTableControl.setHeight(a.viewport.height),[4,this.renderControl(ie.BM.Incremental,G,D)]):[3,6];case 5:Q.sent(),Q.label=6;case 6:return this.supportsOnObject?a.formatMode===this.formatMode?[3,8]:(this.formatMode=a.formatMode,this.subSelectionHelper.setFormatMode(a.formatMode),a.formatMode?(this.element.get(0).setAttribute(n.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(n.y3),this.pivotTableControl&&this.pivotTableControl instanceof se.d?(this.pivotTableControl.getBinder().setFormatMode(a.formatMode),[4,this.pivotTableControl.renderAsync(ie.BM.ClearRendering)]):[3,8]):[3,8];case 7:Q.sent(),Q.label=8;case 8:return this.enableCalculationHighlighting&&(this.allowAnnotationHighlights=a.allowAnnotationHighlights),j=a.type&le.EP.Data||a.type&le.EP.Resize||a.type&le.EP.FormattingSubSelectionChange,C=a.type&le.EP.FormattingSubSelectionChange,this.subSelectionHelper&&j&&(this.subSelectionHelper.updateOutlinesFromSubSelections(a.subSelections,!0),this.hostServices.alertScreenReader&&C&&(F=this.subSelectionHelper.getLabelsFromSubSelections(a.subSelections,["aria-label"]),(O=F?.length&&F.join(" "))&&this.hostServices.alertScreenReader(O))),U=a.type&le.EP.Data||a.type&le.EP.Resize,this.annotationHelper&&U&&this.allowAnnotationHighlights&&this.updateOutlinesFromAnnotations(),[2]}})})})];case 1:return V.sent(),[2]}})})},ee.prototype.hasNoColumnData=function(){var a,x,V,G,D=null===(G=null===(V=null===(x=null===(a=this.dataView)||void 0===a?void 0:a.matrix)||void 0===x?void 0:x.columns)||void 0===V?void 0:V.root)||void 0===G?void 0:G.children;return!D||!_.some(D,function(j){return!j?.isSubtotal})},ee.prototype.updatePersistedWidths=function(a){var x=m.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!x&&this.pivotTableControl){if(this.hasNoColumnData())return;for(var V=[],G=this.columnHierarchyNavigator.getHierarchyLeafNodes(),j=0,C=0,F=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();C<F.length;C++)for(var Q=0,he=F[C].getColumnWidths();Q<he.length;Q++)V.push({node:G[j],width:he[Q]}),j++;for(var Se=[],xe=this.rowHierarchyNavigator.getHierarchyDepth(),Ce=this.columnHierarchyNavigator.getHierarchyDepth(),Pe=0;Pe<xe;Pe++)Se.push({corner:this.rowHierarchyNavigator.getCorner(Pe,Ce-1),width:this.pivotTableControl.getRowLevelWidthMeasureManager().getLevelWidth(Pe)});this.sizeManager.setMissingWidths(V,Se)}else if(x&&a&&a.metadata&&a.metadata.objects&&!m.FX.PropColumnPivotTableAutoSizeColumns.getValue(a.metadata.objects)){G=this.columnHierarchyNavigator.getHierarchyLeafNodes();var Le=[];for(xe=this.rowHierarchyNavigator.getHierarchyDepth(),Ce=this.columnHierarchyNavigator.getHierarchyDepth(),Pe=0;Pe<xe;Pe++)Le.push(this.rowHierarchyNavigator.getCorner(Pe,Ce-1));this.sizeManager.clearWidths(G,Le)}},ee.prototype.onDataViewChanged=function(a,x,V){return(0,W.mG)(this,void 0,void 0,function(){var G,D,j,C=this;return(0,W.Jh)(this,function(F){switch(F.label){case 0:return this.setExpandCollapseEnabled(),_.isEmpty(a)?[3,5]:(G=this.dataView,this.dataView=a[0],D=!this.dataView.metadata.segment,this.formattingProperties=this.tablixPropertyManager.getPivotTableObjects(this.dataView,function(O){for(var U,Q=[],he=1;he<arguments.length;he++)Q[he-1]=arguments[he];return(U=C.hostServices).getLocalizedString.apply(U,(0,W.ev)([O],Q||[],!1))},this.expandCollapseEnabled,this.style,this.featureSwitches,this.featureSwitches.enableCalculationHighlighting),this.formatters=this.formattingProperties.formatters,this.tooltipFormatters=this.formattingProperties.tooltipFormatters,j=this.shouldApplyValuesOnRow(),x!==le.su.Append?[3,2]:[4,this.onAppendDataView(G,j,D)]);case 1:return F.sent(),[3,4];case 2:return[4,this.onNewDataView(G,V,j,D)];case 3:F.sent(),F.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),F.label=6;case 6:return this.waitingForData=!1,[2]}})})},ee.prototype.destroy=function(){var a;null===(a=this.pivotTableControl)||void 0===a||a.destroy()},ee.prototype.onAppendDataView=function(a,x,V){return(0,W.mG)(this,void 0,void 0,function(){var G,D,j,C,F,O;return(0,W.Jh)(this,function(U){switch(U.label){case 0:return this.pivotTableControl.setUnfrozenRowHeaders(m.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(m.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),G=this.rowHierarchyNavigator.getHierarchyLeafCount(),D=this.getPreviousVisibleRowStart(),j=this.getPreviousVisibleColumnStart(),this.updateHierarchyNavigators(this.formattingProperties.rowHeaders.steppedLayout,x,this.formattingProperties.subtotals.rowSubtotalsPosition===ge.we,V,a.matrix.rows.root!==this.dataView.matrix.rows.root),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),C=this.formattingProperties.rowHeaders.steppedLayout,F=this.matrixNavigator.getColumnHierarchy(),O=this.matrixNavigator.getValueSources(),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),F,O,C,x),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),G>this.rowHierarchyNavigator.getHierarchyLeafCount()||!_.isEqual(a.metadata.columns,this.dataView.metadata.columns)?[4,this.renderControl(ie.BM.ClearMeasurement,this.getVisibleRowStart(D,!1),this.getVisibleColumnStart(j))]:[3,2];case 1:return U.sent(),[3,4];case 2:return[4,this.renderControl(ie.BM.ClearRendering,null,null)];case 3:U.sent(),U.label=4;case 4:return[2]}})})},ee.prototype.onNewDataView=function(a,x,V,G){return(0,W.mG)(this,void 0,void 0,function(){var D,j,C,F,O,U;return(0,W.Jh)(this,function(he){switch(he.label){case 0:return D=this.formattingProperties.rowHeaders.steppedLayout,j=this.getPreviousVisibleRowStart(),C=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(D,V,this.formattingProperties.subtotals.rowSubtotalsPosition===ge.we,G,this.formattingProperties.rowHeaders.expandCompositeHierarchy),this.pivotTableControl.setUnfrozenRowHeaders(m.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(m.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),F=this.matrixNavigator.getColumnHierarchy(),O=this.matrixNavigator.getValueSources(),this.sizeManager.onDataViewChanged(F,O,this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,V),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),F,O,D,V),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(x.width),this.pivotTableControl.setHeight(x.height),U=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&U&&U.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.onDataViewChanged(this.dataView,this.formattingProperties,this.style,0===this.tooltipType,this.expandCollapseEnabled&&"interactive"===this.options.expandCollapse.buttonsOption),[4,this.renderControl(ie.BM.ClearMeasurement,this.getVisibleRowStart(j,h.S.hasSortingChanged(a,this.dataView)),this.getVisibleColumnStart(C))];case 1:return he.sent(),this.updatePersistedWidths(a),[2]}})})},ee.prototype.onVerticalScrollButtonClick=function(a,x){var V=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(a),this.getScrollRowIndex(x));this.hostServices.alertScreenReader(V)},ee.prototype.onHorizontalScrollButtonClick=function(a,x){var V=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(a),this.getScrollColumnIndex(x));this.hostServices.alertScreenReader(V)},ee.prototype.getScrollRowIndex=function(a){return 0===a?1:this.pivotTableControl.getMidRenderer().getAriaRowIndex(a)},ee.prototype.getScrollColumnIndex=function(a){return 0===a?1:this.pivotTableControl.getMidRenderer().getAriaColIndex(a,!1)},ee.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},ee.prototype.onRestoreSelection=function(a){var x=this.selectionManager.restoreSelectionState(a.selection,this.matrixNavigator);return this.renderSelection(),x},ee.prototype.shouldApplyValuesOnRow=function(){var a=this.dataView.matrix,x=a.valueSources,V=a.columns.levels;if(_.isEmpty(V))return!1;var G=V[0].sources;return this.formattingProperties.values.valuesOnRow&&x.length>1&&!(_.find(G,function(D){return D.isMeasure})&&_.find(G,function(D){return!D.isMeasure}))},ee.prototype.updateHierarchyNavigators=function(a,x,V,G,D){this.matrixNavigator.update(this.dataView.matrix,a,x,V,G,D,this.formatters,this.tooltipFormatters,this.getSubtotalByColumn(),this.formattingProperties.subtotals.rowSubtotalsPosition,this.featureSwitches.matrixLayouts?this.formattingProperties.general.layout:void 0,this.formattingProperties.blankRows.showBlankRows),this.rowHierarchyNavigator.setHierarchy(this.matrixNavigator.getRowHierarchy()),this.columnHierarchyNavigator.setHierarchy(this.matrixNavigator.getColumnHierarchy())},ee.prototype.getSubtotalByColumn=function(){for(var a={},x=this.dataView.metadata.objects,V=m.FX.PropSubTotalsPivotTableRowSubtotals.getValue(x),G=m.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(x),D=m.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(x),j=m.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(x),C=0,F=this.dataView.metadata.columns;C<F.length;C++){var O=F[C],U=void 0,Q=void 0;if(O.roles){if(O.roles[B.r.rows])U=V,Q=G;else{if(!O.roles[B.r.columns])continue;U=D,Q=j}a[O.queryName]=U&&(!Q||m.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.getValue(O.objects))}}return a},ee.prototype.renderControl=function(a,x,V){return this.pivotTableControl.renderAsync(a,x,V)},ee.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleRowStart();if(!a)return null;var x=this.rowHierarchyNavigator.getHierarchyLeafAt(a.rowIndex);return x?{item:x,offset:a.visibleHeight}:null}},ee.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleColumnStart();if(!a)return null;var x=this.columnHierarchyNavigator.getHierarchyLeafAt(a.columnIndex);return x?{item:x,offset:a.visibleWidth}:null}},ee.prototype.getSubSelectionShortcuts=function(a){if(this.supportsOnObject)for(var D=0,j=_.first(a).visualObjects;D<j.length;D++){var C=j[D];switch(_.isEmpty(C.selectorsByColumn)||(0,K.tV)(C.selectorsByColumn),C.objectName){case"columnHeaders":return[{type:0},(0,W.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Column_Subtotals")},p.t.subTotals.columnSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"rowHeaders":return[{type:0,excludedResetFormattingIds:[p.t.rowHeaders.showExpandCollapseButtons,p.t.subTotals.rowSubtotals]},(0,W.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_ExpandCollapse")},p.t.rowHeaders.showExpandCollapseButtons),(0,W.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Row_Subtotals")},p.t.subTotals.rowSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowHeaders"),groupUid:"".concat("rowHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Row_Headers")}];case"subtotal-row":return[{type:0},(0,W.pi)({type:3,label:this.hostServices.getLocalizedString("Visual_Position")},p.t.subTotals.rowSubtotalsPosition),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotals")}];case"subtotal-row-labels":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotal_Label")}];case"subtotal-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnSubTotal")},label:this.hostServices.getLocalizedString("Format_Column_Subtotals")}];case"total-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnTotal"),groupUid:"".concat("columnTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}];case"total-row":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowTotal"),groupUid:"".concat("rowTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}]}}},ee.prototype.getSubSelectionStyles=function(a){if(this.supportsOnObject){var G,D,V=_.first(a).visualObjects;if(!(V.length>0))return;switch(G=V[0],_.isEmpty(G.selectorsByColumn)||(D=(0,K.tV)(G.selectorsByColumn)),G.objectName){case"columnHeaders":var j=(0,fe.RM)(this.hostServices,{boldReference:p.t.columnHeaders.bold,italicReference:p.t.columnHeaders.italic,underlineReference:p.t.columnHeaders.underline,fontColorReference:p.t.columnHeaders.fontColor,fontFamilyReference:p.t.columnHeaders.fontFamily,fontSizeReference:p.t.columnHeaders.fontSize,backgroundReference:p.t.columnHeaders.backColor,horizontalAlignmentReference:p.t.columnHeaders.alignment,wordWrapReference:p.t.columnHeaders.wordWrap});return(0,W.pi)({type:1},j);case"rowHeaders":var C=(0,fe.RM)(this.hostServices,{boldReference:p.t.rowHeaders.bold,italicReference:p.t.rowHeaders.italic,underlineReference:p.t.rowHeaders.underline,fontColorReference:p.t.rowHeaders.fontColor,fontFamilyReference:p.t.rowHeaders.fontFamily,fontSizeReference:p.t.rowHeaders.fontSize,backgroundReference:p.t.rowHeaders.backColor,horizontalAlignmentReference:p.t.rowHeaders.alignment,wordWrapReference:p.t.rowHeaders.wordWrap});return(0,W.pi)({type:1},C);case"subtotal-row":D={id:"Row"};var F=(0,fe.RM)(this.hostServices,{boldReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.bold),{selector:D}),italicReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.italic),{selector:D}),underlineReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.underline),{selector:D}),fontColorReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontColor),{selector:D}),fontFamilyReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontFamily),{selector:D}),fontSizeReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontSize),{selector:D}),backgroundReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.backColor),{selector:D})});return(0,W.pi)({type:1},F);case"subtotal-column":D={id:"Column"};var O=(0,fe.RM)(this.hostServices,{boldReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.bold),{selector:D}),italicReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.italic),{selector:D}),underlineReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.underline),{selector:D}),fontColorReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontColor),{selector:D}),fontFamilyReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontFamily),{selector:D}),fontSizeReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.fontSize),{selector:D}),backgroundReference:(0,W.pi)((0,W.pi)({},p.t.subTotals.backColor),{selector:D})});return(0,W.pi)({type:1},O);case"total-column":var U=(0,fe.RM)(this.hostServices,{boldReference:p.t.columnTotal.bold,italicReference:p.t.columnTotal.italic,underlineReference:p.t.columnTotal.underline,fontColorReference:p.t.columnTotal.fontColor,fontFamilyReference:p.t.columnTotal.fontFamily,fontSizeReference:p.t.columnTotal.fontSize,backgroundReference:p.t.columnTotal.backColor});return(0,W.pi)({type:1},U);case"total-row":var Q=(0,fe.RM)(this.hostServices,{boldReference:p.t.rowTotal.bold,italicReference:p.t.rowTotal.italic,underlineReference:p.t.rowTotal.underline,fontColorReference:p.t.rowTotal.fontColor,fontFamilyReference:p.t.rowTotal.fontFamily,fontSizeReference:p.t.rowTotal.fontSize,backgroundReference:p.t.rowTotal.backColor});return(0,W.pi)({type:1},Q)}}},ee.prototype.getVisibleRowStart=function(a,x){if(!a||0===this.pivotTableControl.getViewport().top)return null;if(x)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var V=i.l.getMatchingHeader(a.item,this.rowHierarchyNavigator.getHierarchyItems());if(!V)return null;var G=this.rowHierarchyNavigator.getLeafIndex(V);return void 0===G?null:{rowIndex:G,visibleHeight:a.offset}},ee.prototype.getVisibleColumnStart=function(a){if(!a||0===this.pivotTableControl.getViewport().left)return null;var x=i.l.getMatchingHeader(a.item,this.columnHierarchyNavigator.getHierarchyItems());return x&&this.columnHierarchyNavigator.isLeaf(x)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(x),visibleWidth:a.offset}:null},ee.prototype.renderSelection=function(){this.pivotTableControl.renderAsync(ie.BM.ClearRendering).catch(function(a){return be.f.error(a)})},ee.prototype.createOrUpdateControlAndNavigators=function(a,x,V,G,D){var j=this,C=this.hostServices.getLocalizedString("ListJoin_Separator");if(this.matrixNavigator||(this.matrixNavigator=new H.hc(C,this.tablixPropertyManager.tablixProperties,this.hostServices,D,this.isModernRowHeaderStyle())),this.rowHierarchyNavigator?a?this.rowHierarchyNavigator instanceof N.S||(this.rowHierarchyNavigator=new N.S(this.matrixNavigator)):this.rowHierarchyNavigator instanceof N.S&&(this.rowHierarchyNavigator=new N.Q(this.matrixNavigator)):(this.rowHierarchyNavigator=a?new N.S(this.matrixNavigator):new N.Q(this.matrixNavigator),this.columnHierarchyNavigator=new N.Q(this.matrixNavigator)),this.updateHierarchyNavigators(a,x,V,G,!0),this.pivotTableControl)this.pivotTableControl.getSteppedLayout()!==a&&this.switchRowHeadersLayout(a);else{var F={onBindRowHeader:function(he){j.onBindRowHeader(he)},onHyperlinkClicked:function(he,ve){return j.onHyperlinkClicked(he,ve)},onRowHeaderExpansionChange:function(he,ve){return j.onHeaderExpansionChange(he,[B.r.rows],ve)},defaultTotalLabel:this.totalLabel,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties},O=document.createElement("div");O.className="pivotTableContainer",this.element.append(O),this.binder=new v(F,this.selectionManager,this.sortingManager,this.hostServices,O,!0);var U=this.supportsOnObject;this.pivotTableControl=new se.d(O,this.sizeManager,this.createControlOptions(),!1,!0,U,this.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,void 0,void 0,this.showAsTableNativeMenuEnabled),this.pivotTableControl.setClassName("pivotTable"),this.switchRowHeadersLayout(a),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.binder.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},ee.prototype.isModernRowHeaderStyle=function(){var a;return!(!this.featureSwitches.matrixLayouts||null===(a=this.formattingProperties.rowHeaders)||void 0===a||!a.legacyStyleDisabled)},ee.prototype.createControlOptions=function(){var a=this,x=this.options.scrolling.enabled,V=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=new I(this.tooltipService,this.selectionManager,this.valueLabel,this.totalLabel));var G=this.interactionManager,D="interactive"===this.options.expandCollapse.buttonsOption,C=null;G&&(C=G.getHandlerTop());var F=null;return G&&(F=G.getHandlerMidOrBot()),this.options.selection.enabled?{rowHeaderClickHandler:function(Q,he){return!a.formatMode&&a.onItemClick(Q,he,i.D.RowHeader)},rowHeaderContextMenuHandler:function(Q,he){return!a.formatMode&&a.onItemContextMenu(Q,i.D.RowHeader,he,B.r.rows)},rowHeaderInteractionHandler:null,rowHeaderFocusHandler:function(Q){return a.onRowHeaderFocus(Q)},rowHeaderExpandCollapseHandler:D?function(U,Q){return a.onHeaderExpansionChange(U,[B.r.rows],Q)}:null,columnHeaderClickHandler:function(Q,he){return!a.formatMode&&a.onItemClick(Q,he,i.D.ColumnHeader)},columnHeaderContextMenuHandler:function(Q,he){return!a.formatMode&&a.onItemContextMenu(Q,i.D.ColumnHeader,he,B.r.columns)},columnHeaderInteractionHandler:this.formatMode?null:C,columnHeaderFocusHandler:function(Q){return a.onColumnHeaderFocus(Q)},bodyCellClickHandler:function(Q,he){return!a.formatMode&&a.onItemClick(Q,he,i.D.BodyCell)},bodyCellContextMenuHandler:function(Q,he){return!a.formatMode&&a.onItemContextMenu(Q,i.D.BodyCell,he,B.r.values)},bodyCellInteractionHandler:this.formatMode?null:F,bodyCellFocusHandler:function(Q){return null},cornerCellClickHandler:function(Q,he){return!a.formatMode&&a.onCornerCellClick(Q,he)},cornerCellContextMenuHandler:function(Q,he){return!a.formatMode&&a.onCornerCellContextMenu(Q,he)},cornerCellInteractionHandler:null,cornerCellFocusHandler:function(Q){return a.onCornerCellFocus(Q)},cellContentActivationHandler:function(Q,he){return!a.formatMode&&a.onContentActivation(Q,he)},whitespaceClickHandler:function(Q,he){return!a.formatMode&&a.onWhitespaceClick(he)},scrollingEnabled:x,columnResizingEnabled:V,rowLevelResizingEnabled:V,onScroll:function(){return a.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:D?function(U,Q){return a.onHeaderExpansionChange(U,[B.r.rows],Q)}:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:C,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:F,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:x,columnResizingEnabled:V,rowLevelResizingEnabled:V,onScroll:function(){return a.onScroll()}}},ee.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip(),this.supportsOnObject&&this.subSelectionHelper&&this.formatMode&&(this.subSelectionHelper.onVisualScroll(),this.subSelectionHelper.clearHoveredOutline()),this.enableCalculationHighlighting&&this.annotationHelper&&this.allowAnnotationHighlights&&this.annotationHelper.onVisualScroll()},ee.prototype.onWhitespaceClick=function(a){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),a){var x=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(x)}},ee.prototype.onHyperlinkClicked=function(a,x){this.hostServices.onHyperlinkClick(a,x)},ee.prototype.onItemClick=function(a,x,V){if(!this.selectionManager.isDrillingEnabled(a,x,V))if(V===i.D.ColumnHeader&&this.sortingManager.isColumnHeaderSortable(a))this.options.sorting.enabled&&this.sortingManager.sortColumnHeader(a);else{var G=i.l.getMatchingItem(a,V,this.rowHierarchyNavigator.getHierarchyItems(),this.columnHierarchyNavigator.getHierarchyItems(),this.rowHierarchyNavigator),D=Z.M.isCtrlOrMeta(x)||1===this.hostServices.dataMultiSelectMode()?3:0;G&&(this.selectionManager.select(G,V,D),this.renderSelection())}},ee.prototype.onRowHeaderFocus=function(a){(0,o.MX)(a,this.valueLabel,!1,this.totalLabel);var V=[],G=this.rowHierarchyNavigator.getExpansionState(a);if(!this.pivotTableControl.getSteppedLayout()&&1!==G){var D=this.rowHierarchyNavigator.getNodeLeafCount(a);D>1&&V.push(this.hostServices.getLocalizedString("SpansXRows",D))}if(this.rowHierarchyNavigator.isMultiLevelHierarchy()){var j=this.getHierarchyLevelInfo(a);V.push(j)}if(this.rowHierarchyNavigator.getLevel(a)>0){var C=this.rowHierarchyNavigator.getParent(a).children.length,F=this.rowHierarchyNavigator.getIndex(a)+1;this.pivotTableControl.getSteppedLayout()&&(C-=1,F-=1),V.push(this.hostServices.getLocalizedString("Generic_ListPosition",F,C))}this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]},V))},ee.prototype.onColumnHeaderFocus=function(a){(0,o.MX)(a,this.valueLabel,!1,this.totalLabel);var V=[],G=this.columnHierarchyNavigator.getNodeLeafCount(a);if(G>1&&V.push(this.hostServices.getLocalizedString("SpansXColumns",G)),this.columnHierarchyNavigator.isMultiLevelHierarchy()){var D=this.getHierarchyLevelInfo(a);V.push(D)}if(this.columnHierarchyNavigator.getLevel(a)>0){var j=this.columnHierarchyNavigator.getParent(a).children.length,C=this.columnHierarchyNavigator.getIndex(a)+1;V.push(this.hostServices.getLocalizedString("Generic_ListPosition",C,j))}this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]},V))},ee.prototype.onHeaderExpansionChange=function(a,x,V){var G=this.selectionManager.createSelectorsByColumn(a),D=this.selectionManager.getHierarchyNodeIndex(a);this.hostServices.setNodeExpansionState({dataRoles:x,data:G,isCollapse:V,nodeIndex:D})},ee.prototype.onItemContextMenu=function(a,x,V,G){var D;V.stopPropagation(),V.preventDefault(),this.selectionManager.onItemContextMenu(a,x,V,[G],m.FX.PropUnfrozenRowHeaders.getValue(null===(D=this.dataView)||void 0===D?void 0:D.metadata.objects))},ee.prototype.onCornerCellClick=function(a,x){this.options.sorting.enabled&&this.sortingManager.isCornerSortable(a)&&this.sortingManager.sortCorner(a)},ee.prototype.onCornerCellContextMenu=function(a,x){},ee.prototype.onCornerCellFocus=function(a){(0,o.p_)(a),this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]}))},ee.prototype.onContentActivation=function(a,x){w.fF.assertValue(a,"onContentActivated - null cellElement");var V=a.querySelector("a");V&&V.dispatchEvent(x)},ee.prototype.switchRowHeadersLayout=function(a){this.pivotTableControl.setSteppedLayout(a),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.binder.setRowNavigator(this.rowHierarchyNavigator)},ee.prototype.onBindRowHeader=function(a){this.needsMoreData(a)&&(setTimeout(this.hostServices.loadMoreData),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},ee.prototype.needsMoreData=function(a){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var V=this.rowHierarchyNavigator.getHierarchyLeafCount()*ee.preferredLoadMoreThreshold;return this.rowHierarchyNavigator.getLeafIndex(a)>=V},ee.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,A.Y.PivotTable,this.expandCollapseEnabled,this.featureSwitches,this.style)},ee.prototype.enumerateObjectInstances=function(a){var x=this,V=new q.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(a,V,this.dataView,A.Y.PivotTable,function(G){for(var D,j=[],C=1;C<arguments.length;C++)j[C-1]=arguments[C];return(D=x.hostServices).getLocalizedString.apply(D,(0,W.ev)([G],j||[],!1))},this.featureSwitches,this.expandCollapseEnabled,this.style),V.complete()},ee.prototype.enumerateObjectRepetition=function(){var a=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(a,this.dataView,A.Y.PivotTable,this.featureSwitches),a},ee.prototype.getHierarchyLevelInfo=function(a){return"".concat(this.hostServices.getLocalizedString("Level")," ").concat(this.rowHierarchyNavigator.getLevel(a)+1)},ee.prototype.setExpandCollapseEnabled=function(){this.expandCollapseEnabled=this.hostServices.canExpandCollapse([B.r.rows])&&"hidden"!==this.options.expandCollapse.buttonsOption},ee.prototype.getSubSelectables=function(a){return this.subSelectionHelper.getAllSubSelectables(a)},ee.prototype.updateOutlinesFromAnnotations=function(){var a=this;this.annotationHighlightElementToRegionIdMap.clear(),this.annotationHelper.hideAllOutlines(!0);var x=function(ee){var a;if(ee){var x={};return _.forEach(null===(a=ee.metadata)||void 0===a?void 0:a.columns,function(V){var G;if(null!==(G=V.objects)&&void 0!==G&&G.annotations){var D=V.queryName,j=(0,ue.NA)(V.objects,p.t.annotations.highlights);D&&j&&(x[D]=j)}}),x}}(this.dataView);if(_.isEmpty(x))this.annotationHelper.renderOutlines();else{var V=this.pivotTableControl,G=V.getViewport(),D=de.sW.getVisibleRange(G.left,G.width,V.getColumnWidthMeasureManager());if(D){var j=de._E.getVisibleRange(G.top,G.height,V.getRowHeightMeasureManager());if(j){var C=V.getMidRenderer(),O=function(ee,a,x,V){for(var G,D=new Set(ee),j={},C=a.firstLeafIndex;C<=a.lastLeafIndex;C++)for(var F=x.firstLeafIndex;F<=x.lastLeafIndex;F++){var O=V.getElementByIndex(F,C,ie.aP.Main);if(O){var U=V.getItemByElement(O),Q=null===(G=U?.columnMetadata)||void 0===G?void 0:G.queryName;if(Q&&D.has(Q)){var he=j[Q];null==he&&(j[Q]=he=[]),he.push(O)}}}return j}(_.keys(x),D,j,C);_.forEach(O,function(U,Q){_.forEach(U,function(Se){a.annotationHighlightElementToRegionIdMap.set(Se,"".concat("fullColumn","_").concat(Q))});var he={showHandles:!1,thickness:2},ve=x[Q].color;ve&&(he.color=ve),a.annotationHelper.updateOutlinesFromSubSelectionElements(U,2,he)}),this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}},ee.prototype.getAnnotationHighlightElementSubSelectionOutlineRegionId=function(a){var x=this.annotationHighlightElementToRegionIdMap.get(a);return w.fF.assert(function(){return null!=x},"the given element should have an entry in this.annotationHighlightElementToRegionIdMap"),x},ee.prototype.annotationHighlightOnScrollStart=function(){this.annotationHelper.hideAllOutlines()},ee.prototype.annotationHighlightOnScrollEnd=function(){this.updateOutlinesFromAnnotations()},ee.preferredLoadMoreThreshold=.8,ee}()},11184:function(Ve,Fe,X){X.d(Fe,{Q:function(){return le},S:function(){return ie}});var W=X(81337),fe=X(55007),ue=X(62458),le=function(){function te(Z){this.matrixNavigator=Z}return te.prototype.setHierarchy=function(Z){this.hierarchy=Z,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},te.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},te.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},te.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},te.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},te.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},te.prototype.getHierarchyLeafAt=function(Z){return this.hierarchy.leafNodes[Z]},te.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},te.prototype.getFloatingHierarchyLeafAt=function(Z){return this.floatingLeaves[Z]},te.prototype.isBlank=function(Z){return Z.isBlankRow},te.prototype.isBlankRow=function(Z){return this.getHierarchyLeafAt(Z).isBlankRow},te.prototype.numberOfBlankRowsBefore=function(Z){var de=this.getHierarchyLeafAt(Z),K=this.getAncestor(de);return Math.floor(K.index/2)},te.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},te.prototype.getFloatingHierarchyItems=function(){return null},te.prototype.getLeafIndex=function(Z){return this.matrixNavigator.getLeafIndex(Z)},te.prototype.isLeaf=function(Z){return this.matrixNavigator.isLeaf(Z)},te.prototype.isLastItem=function(Z,de){return this.matrixNavigator.isLastItem(Z,de)},te.prototype.getAncestor=function(Z){for(;Z.parent;)Z=Z.parent;return Z},te.prototype.getParent=function(Z){return this.matrixNavigator.getParent(Z)},te.prototype.getIndex=function(Z){return this.matrixNavigator.getIndex(Z)},te.prototype.getNodeLeafCount=function(Z){var de=this;return this.isLeaf(Z)?1:_.sum(_.map(Z.children,function(K){return de.getNodeLeafCount(K)}))},te.prototype.getIndexOfFirstLeaf=function(Z){for(;!_.isEmpty(Z.children);)Z=Z.children[0];return this.getLeafIndex(Z)},te.prototype.getPathIndices=function(Z){for(var de=[this.getIndex(Z)],K=this.getParent(Z);K;)de=(0,W.ev)([this.getIndex(K)],de||[],!0),K=this.getParent(K);return de},te.prototype.getNodeFromPath=function(Z){var de=this.hierarchy.levels.length||1;if(!(_.isEmpty(Z)||Z.length>de)){for(var K=this.hierarchy.root,ce=0,r=Z;ce<r.length;ce++)if(!(K=K.children[r[ce]]))return;return K}},te.prototype.getLeafAncestorAtLevel=function(Z,de,K){if(ue.fF.assertValue(Z,"Undefined leaf node"),ue.fF.assert(function(){return de>=0},"Invalid target level"),!(de>this.getLevel(Z))){for(var ce=Z;this.getLevel(ce)>de;){if(ce=this.getParent(ce),K&&this.getLevel(ce)<de)return;ue.fF.assertValue(ce,"reached root without finding a matching ancestor")}return ce}},te.prototype.getItemsByLevel=function(Z){var de=[];return this.findLevelItems(Z,this.hierarchy.root,-1,de),de},te.prototype.findLevelItems=function(Z,de,K,ce){if(!_.isEmpty(de.children))for(var r=K+1,w=0,n=de.children;w<n.length;w++){var o=n[w];r===Z||r+this.matrixNavigator.getChildrenLevelDifference(o)>Z?ce.push(o):r<Z&&this.findLevelItems(Z,o,r,ce)}},te.prototype.getExpansionState=function(Z){return Z.isCollapsed?1:!1===Z.isCollapsed?0:2},te.prototype.getChildren=function(Z){return this.matrixNavigator.getChildren(Z)},te.prototype.getLevel=function(Z){return this.matrixNavigator.getLevel(Z)},te.prototype.getIntersection=function(Z,de){var K=this.matrixNavigator.getIntersection(Z,de);return K&&K.objects&&(K.icon=fe.FX.PropValuesIcon.getValue(K.objects),K.hyperlink=fe.FX.PropValuesWebURL.getValue(K.objects),K.altText=fe.FX.PropAltTextValue.getValue(K.objects)),K},te.prototype.getCorner=function(Z,de){return this.matrixNavigator.getCorner(Z,de)},te.prototype.getRowLevel=function(Z){return Z.rowLevel},te.prototype.getColumnLevel=function(Z){return Z.columnLevel},te.prototype.getRowHeaderMetadataColumn=function(Z){return this.matrixNavigator.getRowHeaderMetadataColumn(Z)},te.prototype.getRowHeaderMetadataColumns=function(Z){return this.matrixNavigator.getRowHeaderMetadataColumns(Z)},te.prototype.getColumnHeaderMetadataColumn=function(Z){return this.matrixNavigator.getColumnHeaderMetadataColumn(Z)},te.prototype.getColumnHeaderMetadataColumns=function(Z){return this.matrixNavigator.getColumnHeaderMetadataColumns(Z)},te.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},te.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},te.prototype.isColumnHeaderMultiValueSubtotal=function(Z){return Z.isSubtotal&&Z.parent&&Z.parent.isSubtotal},te.prototype.isRowHeaderMultiValueSubtotal=function(Z){return this.valuesOnRowApplied()&&Z.parent&&Z.parent.isSubtotal},te.prototype.getLeaves=function(Z,de){if(!_.isEmpty(Z))for(var K=0,ce=Z;K<ce.length;K++){var r=ce[K];this.isLeaf(r)?de.push(r):this.getLeaves(this.getChildren(r),de)}},te.prototype.getColumnIndexFromQueryName=function(Z){return null},te}(),ie=function(te){function Z(){return null!==te&&te.apply(this,arguments)||this}return(0,W.ZT)(Z,te),Z.prototype.getIntersection=function(de,K){return this.isLeaf(de)||_.isEmpty(de.children)||!de.children[0].isSubtotal||this.valuesOnRowApplied()?te.prototype.getIntersection.call(this,de,K):te.prototype.getIntersection.call(this,de.children[0],K)},Z.prototype.getChildren=function(de){return ue.fF.assertValue(de,"item"),!_.isEmpty(de.children)&&de.children[0].isSubtotal?de.children.slice(1):de.children},Z.prototype.getHierarchyDepth=function(){return te.prototype.getHierarchyDepth.call(this)>0?1:0},Z.prototype.getCorner=function(de,K){var ce=K===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return te.prototype.getCorner.call(this,ce,K)},Z.prototype.getFloatingHierarchyItems=function(){var de=this.getHierarchyItems();if(_.isEmpty(de))return null;for(var K=0,ce=[];;){var r=de[K];if(!r||!r.isSubtotal)break;ce.push(r),K++}return _.isEmpty(ce)?null:ce},Z.prototype.isRowHeaderMultiValueSubtotal=function(de){return this.valuesOnRowApplied()&&de.isSubtotal},Z.prototype.getLeaves=function(de,K){if(!_.isEmpty(de))for(var ce=0,r=de;ce<r.length;ce++){var w=r[ce];K.push(w),this.getLeaves(this.getChildren(w),K)}},Z.prototype.getPathIndices=function(de){return[this.getLeafIndex(de)]},Z.prototype.getNodeFromPath=function(de){if(1===de.length)return this.getHierarchyLeafAt(de[0])},Z.prototype.getItemsByLevel=function(de){return ue.fF.assert(function(){return 0===de},"Stepped PivotTable rows hierarchy has 1 level"),(0,W.ev)([],this.getHierarchyLeafNodes()||[],!0)},Z.prototype.getLeafAncestorAtLevel=function(de,K){return ue.fF.assert(function(){return 0===K},"Stepped PivotTable rows hierarchy has 1 level"),ue.fF.assertValue(de,"Undefined leaf node"),de},Z}(le)},76797:function(Ve,Fe,X){X.d(Fe,{D:function(){return K},l:function(){return r}});var W=X(81337),fe=X(85196),ue=X(66232),le=X(62458),ie=X(78843),te=X(93340),Z=X(71090),de=X(21242),K=function(w){return w[w.RowHeader=0]="RowHeader",w[w.ColumnHeader=1]="ColumnHeader",w[w.BodyCell=2]="BodyCell",w}({});function ce(w){return 0===w.type}var r=function(){function w(n,o){this.hostServices=n,this.featureSwitches=o,this.clearLocal()}return w.prototype.onItemContextMenu=function(n,o,H,B,k){var I;(0,ue.n)(H),!this.isEmpty()&&this.isItemSelected(n,!0)?(I=this.selectedItems,o=this.selectionMode):I=[n];var q=this.createContextMenuArgs(n,o,I,H,B,k);q&&this.hostServices.onContextMenu(q)},w.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},w.prototype.isDrillingEnabled=function(n,o,H){var B=this.createSelectingArgs(n,H,o);return this.hostServices.onSelecting(B),1===B.action},w.prototype.select=function(n,o,H){this.updateSelection(n,o,H,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(n)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,H))},w.prototype.getSelectionScreenReaderMessage=function(n){var o,H,B;switch(this.indicatorStyle){case K.RowHeader:H=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n));var k=1===this.rowHierarchyNavigator.getExpansionState(n);o=_.isEmpty(this.selectedItems)?!H||n.isSubtotal||k?"Row_Group_Unselected":"Row_Unselected":!H||n.isSubtotal||k?"Row_Group_Selected":"Row_Selected";break;case K.ColumnHeader:B=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n)),o=_.isEmpty(this.selectedItems)?B&&!n.isSubtotal?"Column_Unselected":"Column_Group_Unselected":B&&!n.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case K.BodyCell:H=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.rowItem)),B=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.columnItem)),o=_.isEmpty(this.selectedItems)?H&&B&&!n.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":H&&B&&!n.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:o="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(o)},w.prototype.getIndicatorStyle=function(){return this.indicatorStyle},w.prototype.updateSelection=function(n,o,H,B){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in n&&(n.isRowAndColumnGrandTotal||n.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!B&&o!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(n))if(this.isItemSelected(n,B)){if(B)return!1;1===this.selectedItems.length&&1!==H?this.clearLocal():3===H?this.unselectItem(n):0===H&&(this.selectedItems=[n])}else(0===H||o!==this.selectionMode)&&this.clearLocal(),this.selectionMode=o,this.indicatorStyle=o,this.selectedItems.push(n),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[n]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return n.isRowGrandTotal?this.indicatorStyle=K.ColumnHeader:n.isColumnGrandTotal&&(this.indicatorStyle=K.RowHeader),!0},w.prototype.isRowHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var o=0,H=this.selectedItems;o<H.length;o++)if(this.isRowHeaderOnSelectedPath(H[o],n))return!0;return!1},w.prototype.isColumnHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var o=0,H=this.selectedItems;o<H.length;o++)if(this.isColumnHeaderOnSelectedPath(H[o],n))return!0;return!1},w.prototype.isRowHeaderIndicatorOn=function(n,o){var H=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(I){return H.isRowHeaderOnSelectedPath(I,n,!0,!o)})&&!(this.indicatorStyle===K.ColumnHeader)},w.prototype.isRowHeaderDarkened=function(n){var o=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(k){return o.isRowHeaderOnSelectedPath(k,n,!0,!1)})&&this.indicatorStyle===K.RowHeader},w.prototype.isColumnHeaderIndicatorOn=function(n){var o=this;if(!this.featureSwitches.a11yMatrix)return!1;var H=this.columnHierarchyNavigator.isLeaf(n),B=_.some(this.selectedItems,function(I){return o.isColumnHeaderOnSelectedPath(I,n)});return H&&B&&!(this.indicatorStyle===K.RowHeader)},w.prototype.isColumnHeaderDarkened=function(n){var o=this;return _.some(this.selectedItems,function(k){return o.isColumnHeaderOnSelectedPath(k,n)})&&!(this.indicatorStyle===K.RowHeader)},w.prototype.isBodyCellHighlighted=function(n){if(this.isEmpty())return!0;for(var o=0,H=this.selectedItems;o<H.length;o++)if(this.isBodyCellOnSelectedPath(H[o],n))return!0;return!1},w.prototype.isBodyCellIndicatorOn=function(n){if(this.isEmpty())return!1;for(var o=0,H=this.selectedItems;o<H.length;o++)if(this.isBodyCellOnSelectedPath(H[o],n)&&this.indicatorStyle===K.BodyCell)return!0;return!1},w.prototype.isRowHeaderOnSelectedPath=function(n,o,H,B){return this.indicatorStyle===K.ColumnHeader||(k=ce(n)?n.rowItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(k),o,H,B));var k},w.prototype.isColumnHeaderOnSelectedPath=function(n,o){return this.indicatorStyle===K.RowHeader||(H=ce(n)?n.columnItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(H),o));var H},w.prototype.isBodyCellOnSelectedPath=function(n,o){return this.isRowHeaderOnSelectedPath(n,o.rowItem)&&this.isColumnHeaderOnSelectedPath(n,o.columnItem)},w.prototype.isOnSelectedPath=function(n,o,H,B){if(!n||n===o)return!0;var k=n;if(!H)for(;k;){if(k===o)return!0;k=k.parent}if(k=o,!B)for(;k;){if(k===n)return!0;k=k.parent}return!1},w.prototype.onDataViewChanged=function(n,o){this.rowHierarchyNavigator=n,this.columnHierarchyNavigator=o;var H=n&&n.getHierarchyItems(),B=o&&o.getHierarchyItems();if(!this.isEmpty()){for(var k=[],I=0,q=this.selectedItems;I<q.length;I++){var ne=q[I],re=w.getMatchingItem(ne,this.selectionMode,H,B,n);k.push(re||ne)}this.selectedItems=k}},w.getMatchingItem=function(n,o,H,B,k){if(n.isBlankRow)return null;switch(o){case K.RowHeader:return this.getMatchingHeader(n,H);case K.ColumnHeader:return this.getMatchingHeader(n,B);case K.BodyCell:var I=n,q=this.getMatchingHeader(I.rowItem,H),ne=this.getMatchingHeader(I.columnItem,B);return q&&ne?k.getIntersection(q,ne):null}},w.getMatchingHeader=function(n,o){if(o)for(var H=0,B=o;H<B.length;H++){var k=B[H];if(this.areHeadersEqual(n,k))return k;var I=this.getMatchingHeader(n,k.children);if(I)return I}return null},w.areHeadersEqual=function(n,o){if(le.fF.assert(function(){return!!n&&!!o},"items cannot be null"),(0,ie.fS)(n.identity,o.identity)&&n.queryName===o.queryName){if(!n.parent&&!o.parent)return!0;if(n.parent&&o.parent)return this.areHeadersEqual(n.parent,o.parent)}return!1},w.getMatchingItemById=function(n,o,H,B,k){var I=_.keys(n.dataMap),q=_.chain(k.getColumnHierarchy().levels).filter(function(m){return!m.sources[0].isMeasure}).map(function(m){return m.sources[0].queryName}).filter(function(m){return _.includes(I,m)}).value(),ne=_.chain(k.getRowHierarchy().levels).map(function(m){return m.sources[0].queryName}).filter(function(m){return _.includes(I,m)}).value();switch(o){case K.RowHeader:return this.getMatchingHeaderById(n,ne,H);case K.ColumnHeader:return this.getMatchingHeaderById(n,q,B);case K.BodyCell:var re=this.getMatchingHeaderById(n,ne,H),E=this.getMatchingHeaderById(n,q,B);return re&&E?k.getIntersection(re,E):null}},w.getMatchingHeaderById=function(n,o,H){if(H)for(var B=0,k=H;B<k.length;B++)for(var I=k[B],q=function(d,g){var y=o[d];if(ne.headerMatchesId(n,y,I)){if(1===g)return{value:I};le.fF.assertAnyValue(I.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var L=ne.getMatchingHeaderById(n,_.filter(o,function(M){return M!==y}),I.children);if(L)return{value:L}}},ne=this,re=0,E=o.length;re<E;re++){var m=q(re,E);if("object"==typeof m)return m.value}return null},w.headerMatchesId=function(n,o,H){return le.fF.assert(function(){return!!n&&!!H},"items cannot be null"),!!(o===H.queryName&&n.dataMap&&n.dataMap[o]&&(0,ie.fS)(_.head(n.dataMap[o]),H.identity))},w.areCornerItemsEqual=function(n,o){return!(!n.metadata||!o.metadata)&&n.metadata.queryName===o.metadata.queryName},w.prototype.clearLocal=function(){this.selectedItems=[]},w.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},w.prototype.restoreSelectionState=function(n,o){if(this.clearLocal(),_.isEmpty(n))return!0;for(var H=!1,B=this.selectedItems,k=0,I=n;k<I.length;k++){var q=I[k],ne=this.determineSelectionModeFromIds(q,o);if(null!=ne){this.selectionMode=ne,this.indicatorStyle=ne;var re=w.getMatchingItemById(q,ne,o.getRowHierarchy().root.children,o.getColumnHierarchy().root.children,o);re&&(B.push(re),H=!0,re.isRowGrandTotal?this.indicatorStyle=K.ColumnHeader:re.isColumnGrandTotal&&(this.indicatorStyle=K.RowHeader))}}return H},w.prototype.determineSelectionModeFromIds=function(n,o){if(!n)return this.selectionMode;var H=_.map(o.getColumnHierarchy().levels,function(ne){return ne.sources[0].queryName}),B=!1,k=_.map(o.getRowHierarchy().levels,function(ne){return ne.sources[0].queryName}),I=!1;for(var q in n.dataMap)if(_.includes(H,q))B=!0;else{if(!_.includes(k,q))return;I=!0}return B&&I?K.BodyCell:B?K.ColumnHeader:I?K.RowHeader:void 0},w.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},w.prototype.isItemSelected=function(n,o){void 0===o&&(o=!1);for(var H=ce(n)?n:void 0,B=0,k=this.selectedItems;B<k.length;B++){var I=k[B];if(ce(I)&&H){if(this.areBodyCellsEqual(I,H))return!0}else if(I===n)return!0}return!(!o||this.isEmpty()||!H)&&this.isBodyCellHighlighted(H)},w.prototype.unselectItem=function(n){var o=this;ce(n)?_.remove(this.selectedItems,function(H){return o.areBodyCellsEqual(H,n)}):_.pull(this.selectedItems,n)},w.prototype.areBodyCellsEqual=function(n,o){return n.rowItem===o.rowItem&&n.columnItem===o.columnItem},w.prototype.getEffectiveSelectedHeader=function(n){return n&&!n.identity&&n.parent?this.getEffectiveSelectedHeader(n.parent):n},w.prototype.getEffectiveSelectedNodes=function(n){return n.parent?[this.getEffectiveSelectedHeader(n)]:n.identity?[n]:n.siblings},w.getRoleNames=function(n){switch(n){case K.ColumnHeader:return[fe.r.columns];case K.RowHeader:return[fe.r.rows];case K.BodyCell:return[fe.r.values];default:le.fF.assertFail("unexpected PivotTableSelectionMode")}},w.prototype.createSelectingArgs=function(n,o,H){return{type:0,visualObjects:this.getVisualObjects([n]),position:w.getMouseEventPosition(H),dataRoles:w.getRoleNames(o)}},w.prototype.createSelectArgs=function(n,o){for(var H=[],B=0,k=n;B<k.length;B++){var q=this.createSelectorsByColumn(k[B]);q&&H.push({objectName:"",selectorsByColumn:q})}return{type:0,visualObjects:this.getVisualObjects(n),selectionMode:o}},w.prototype.getVisualObjects=function(n){for(var o=[],H=0,B=n;H<B.length;H++){var I=this.createSelectorsByColumn(B[H]);I&&o.push({objectName:"",selectorsByColumn:I})}return o},w.prototype.createContextMenuArgs=function(n,o,H,B,k,I){for(var ne,re,E,m,S,d,q=this,g=[],y=0,L=H;y<L.length;y++){var Y=this.createSelectorsByColumn(L[y]);Y&&g.push(Y)}var t,c={dataRoles:k,data:g,position:w.getMouseEventPosition(B)};if(ce(n)||(c.nodeIndex=this.getHierarchyNodeIndex(n)),(_.isEmpty(g)||g.every(function(f){return _.isEmpty(f.dataMap)}))&&ce(n)&&n.isRowAndColumnGrandTotal){var e=null===(E=null===(re=null===(ne=n.columnMetadata)||void 0===ne?void 0:ne.type)||void 0===re?void 0:re.misc)||void 0===E?void 0:E.sparkline;return c.copyArgs={singleValue:function(){return e?n.textContent:String(n.dataPoint)}},c}if(ce(n))if(null===(d=null===(S=null===(m=n.columnMetadata)||void 0===m?void 0:m.type)||void 0===S?void 0:S.misc)||void 0===d?void 0:d.sparkline)t=n.textContent;else{var s=n.dataPoint;null!=s&&(t=(0,te.pW)(s))}else t=n.tooltipValueFormatted;return c.copyArgs={grid:function(){return q.generateGridCopyCallback(H,o)}},void 0!==t&&(c.copyArgs.singleValue=function(){return String(t)}),this.featureSwitches.a11yShowAsMatrix&&(c.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,W.mG)(q,void 0,void 0,function(){return(0,W.Jh)(this,function(u){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,W.mG)(q,void 0,void 0,function(){return(0,W.Jh)(this,function(u){return[2,!I]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,W.mG)(q,void 0,void 0,function(){return(0,W.Jh)(this,function(u){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,W.mG)(q,void 0,void 0,function(){return(0,W.Jh)(this,function(u){return[2,I]})})}}]),c},w.prototype.generateGridCopyCallback=function(n,o){var k,H=n.slice(),B=[];switch(o){case K.BodyCell:H=this.collectSelectedBodyNodes(H),k=(0,de.kH)(H,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(Z.yF)),B.push.apply(B,(0,W.ev)([k.headers],k.values||[],!1));break;case K.ColumnHeader:for(var I=[],q=0,ne=H;q<ne.length;q++){var re=ne[q];this.columnHierarchyNavigator.isLeaf(re)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(re).isMeasure?I.push.apply(I,re.siblings||[]):I.push(re)}k=(0,de.mM)([],H=I,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(Z.yF)),B.push.apply(B,(0,W.ev)([k.headers],k.values||[],!1));break;case K.RowHeader:k=(0,de.mM)(H,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(Z.yF)),B.push.apply(B,(0,W.ev)([k.headers],k.values||[],!1));break;default:le.fF.assertNever(o)}return{grid:B,coveragePercentage:k?k.coveragePercentage:void 0}},w.prototype.getHierarchyNodeIndex=function(n){for(var o=[];n&&null!=n.index;)o.splice(0,0,n.index),n=n.parent;return o},w.prototype.collectSelectedBodyNodes=function(n){for(var o=[],H=0,B=n;H<B.length;H++){var k=B[H];if(!k.isSubtotal&&k.columnItem.identity&&k.rowItem.identity)o.push(k);else{var I=[],q=[];k.isRowGrandTotal||(I=this.getEffectiveSelectedNodes(k.rowItem)),k.isColumnGrandTotal||(q=this.getEffectiveSelectedNodes(k.columnItem));var ne=(0,de.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,I,q);o.push.apply(o,ne||[])}}for(var re=0;re<o.length;re++)for(var E=o[re],m=re+1;m<o.length;m++)_.isEqual(E,o[m])&&(o.splice(m,1),m--);return o},w.prototype.createSelectorsByColumn=function(n){return ce(n)?this.createSelectorsByColumnForBodyCell(n):this.createSelectorsByColumnForHeader(n)},w.prototype.createSelectorsByColumnForHeader=function(n){var o=n.queryName,H={};return w.addHeaderIdentities(n,H)?{dataMap:H,metadata:[o]}:void 0},w.prototype.createSelectorsByColumnForBodyCell=function(n){var o,H={},B=w.addHeaderIdentities(n.rowItem,H),k=w.addHeaderIdentities(n.columnItem,H),I=null===(o=n.columnMetadata)||void 0===o?void 0:o.queryName;return le.fF.assert(function(){return B||k||!!I},"Must have a row or column identity or column metadata"),{dataMap:H,metadata:I?[I]:void 0}},w.addHeaderIdentities=function(n,o){for(var H=[];n;)n.identity&&H.splice(0,0,n),n=n.parent;for(var B=0,k=H;B<k.length;B++){var I=k[B];o[I.queryName]=[I.identity]}return H.length>0},w.hasIdentity=function(n){return w.addHeaderIdentities(n,{})},w.getMouseEventPosition=function(n){return{x:n.clientX,y:n.clientY}},w}()},59784:function(Ve,Fe,X){X.d(Fe,{S:function(){return fe}});var W=X(76797),fe=function(){function ue(le){this.hostServices=le}return ue.prototype.onDataViewChanged=function(le,ie,te,Z,de){this.isSteppedLayout=Z,this.valuesOnRowApplied=de,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(le),this.valueSources=te,this.hasRows=le&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=ie&&!_.isEmpty(ie.levels),this.measureCount=te?te.length:0},ue.hasSortingChanged=function(le,ie){if(!le||!ie)return!1;var te=le.metadata.columns;if(_.isEmpty(te))return!1;var Z=ie.metadata.columns;if(_.isEmpty(Z))return!1;for(var de=function(o){var H=_.find(te,function(B){return o.queryName===B.queryName});if(H&&o.sort!==H.sort)return{value:!0}},K=0,ce=Z;K<ce.length;K++){var w=de(ce[K]);if("object"==typeof w)return w.value}return!1},ue.prototype.isCornerSortable=function(le){return this.hasRows&&null!=le.metadata&&le.position.row.isLast&&(!this.valuesOnRowApplied||!le.position.column.isLast)},ue.prototype.getNonMeasureRowLevels=function(le){if(this.valuesOnRowApplied){var ie=[];return ie.push.apply(ie,le.levels||[]),ie.pop(),ie}return le.levels},ue.prototype.isColumnHeaderSortable=function(le){var ie=W.l.hasIdentity(le);return this.hasRows&&this.measureCount>0&&!ie&&le.position.row.isLast&&!this.valuesOnRowApplied},ue.prototype.getCornerSortDirection=function(le){if(!this.isCornerSortable(le))return null;if(this.isSteppedLayout){for(var ie=null,te=0,Z=this.nonMeasureRowLevels;te<Z.length;te++){var de=Z[te];if(1!==de.sources.length)return null;var K=de.sources[0].sort;if(null==K)return null;if(null!==ie){if(K!==ie)return null}else ie=K}return ie}return this.nonMeasureRowLevels[le.position.column.index].sources[0].sort},ue.prototype.getColumnHeaderSortDirection=function(le){return this.isColumnHeaderSortable(le)?this.getMeasureSortDirection(this.getMeasureQueryName(le)):null},ue.prototype.getMeasureQueryName=function(le){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:le.queryName},ue.prototype.sortCorner=function(le){var Z,ie=this.getCornerSortDirection(le),te=ue.getNextSortDirection(ie);if(this.isSteppedLayout){Z=[];for(var de=0,K=this.nonMeasureRowLevels;de<K.length;de++)Z.push({queryName:K[de].sources[0].queryName,sortDirection:te})}else Z=[{queryName:le.metadata.queryName,sortDirection:te}];this.hostServices.onCustomSort({sortDescriptors:Z,suppressAnnouncements:!0})},ue.prototype.sortColumnHeader=function(le){var ie=this.getColumnHeaderSortDirection(le),te=this.getMeasureColumn(this.getMeasureQueryName(le));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(le),sortDirection:ue.getNextSortDirection(ie,te)}],suppressAnnouncements:!0})},ue.getNextSortDirection=function(le,ie){return void 0===le?ue.getDefaultSortDirection(ie):1===le?2:1},ue.getDefaultSortDirection=function(le){return le&&le.isMeasure&&le.type&&le.type.numeric&&!le.type.temporal?2:1},ue.prototype.getMeasureSortDirection=function(le){var ie=this.getMeasureColumn(le);if(null!=ie)return ie.sort},ue.prototype.getMeasureColumn=function(le){return _.find(this.valueSources,function(ie){return ie.queryName===le})},ue}()}}]);