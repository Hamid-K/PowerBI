(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["export-data-dialog"],{77489:function(se){se.exports=function(H,fe){(null==fe||fe>H.length)&&(fe=H.length);for(var S=0,$=new Array(fe);S<fe;S++)$[S]=H[S];return $},se.exports.default=se.exports,se.exports.__esModule=!0},32878:function(se){function We(fe,S){for(var $=0;$<S.length;$++){var z=S[$];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(fe,z.key,z)}}se.exports=function(fe,S,$){return S&&We(fe.prototype,S),$&&We(fe,$),fe},se.exports.default=se.exports,se.exports.__esModule=!0},34850:function(se,We,H){var fe=H(91052);se.exports=function($,z){var ue=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(ue)return(ue=ue.call($)).next.bind(ue);if(Array.isArray($)||(ue=fe($))||z&&$&&"number"==typeof $.length){ue&&($=ue);var h=0;return function(){return h>=$.length?{done:!0}:{done:!1,value:$[h++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},se.exports.default=se.exports,se.exports.__esModule=!0},12864:function(se,We,H){var fe=H(74);se.exports=function($,z){$.prototype=Object.create(z.prototype),$.prototype.constructor=$,fe($,z)},se.exports.default=se.exports,se.exports.__esModule=!0},74:function(se){function We(H,fe){return se.exports=We=Object.setPrototypeOf||function($,z){return $.__proto__=z,$},se.exports.default=se.exports,se.exports.__esModule=!0,We(H,fe)}se.exports=We,se.exports.default=se.exports,se.exports.__esModule=!0},91052:function(se,We,H){var fe=H(77489);se.exports=function($,z){if($){if("string"==typeof $)return fe($,z);var ue=Object.prototype.toString.call($).slice(8,-1);if("Object"===ue&&$.constructor&&(ue=$.constructor.name),"Map"===ue||"Set"===ue)return Array.from($);if("Arguments"===ue||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ue))return fe($,z)}},se.exports.default=se.exports,se.exports.__esModule=!0},36444:function(se,We,H){var fe=H(32878).default,S=H(12864).default,$=H(34850).default;function z(){"use strict";z=function(){return h};var ue,h={},Re=Object.prototype,Le=Re.hasOwnProperty,ge=Object.defineProperty||function(V,R,P){V[R]=P.value},ee="function"==typeof Symbol?Symbol:{},b=ee.iterator||"@@iterator",pe=ee.asyncIterator||"@@asyncIterator",Q=ee.toStringTag||"@@toStringTag";function m(V,R,P){return Object.defineProperty(V,R,{value:P,enumerable:!0,configurable:!0,writable:!0}),V[R]}try{m({},"")}catch{m=function(P,y,w){return P[y]=w}}function Ie(V,R,P,y){var T=Object.create((R&&R.prototype instanceof De?R:De).prototype),I=new ht(y||[]);return ge(T,"_invoke",{value:ot(V,P,I)}),T}function ke(V,R,P){try{return{type:"normal",arg:V.call(R,P)}}catch(y){return{type:"throw",arg:y}}}h.wrap=Ie;var Z="suspendedStart",X="suspendedYield",q="executing",te="completed",le={};function De(){}function xe(){}function he(){}var $e={};m($e,b,function(){return this});var ze=Object.getPrototypeOf,Ze=ze&&ze(ze(lt([])));Ze&&Ze!==Re&&Le.call(Ze,b)&&($e=Ze);var U=he.prototype=De.prototype=Object.create($e);function et(V){["next","throw","return"].forEach(function(R){m(V,R,function(P){return this._invoke(R,P)})})}function Ae(V,R){function P(w,T,I,x){var s=ke(V[w],V,T);if("throw"!==s.type){var J=s.arg,Oe=J.value;return Oe&&"object"==typeof Oe&&Le.call(Oe,"__await")?R.resolve(Oe.__await).then(function(Me){P("next",Me,I,x)},function(Me){P("throw",Me,I,x)}):R.resolve(Oe).then(function(Me){J.value=Me,I(J)},function(Me){return P("throw",Me,I,x)})}x(s.arg)}var y;ge(this,"_invoke",{value:function(T,I){function x(){return new R(function(s,J){P(T,I,s,J)})}return y=y?y.then(x,x):x()}})}function ot(V,R,P){var y=Z;return function(w,T){if(y===q)throw new Error("Generator is already running");if(y===te){if("throw"===w)throw T;return{value:ue,done:!0}}for(P.method=w,P.arg=T;;){var I=P.delegate;if(I){var x=Je(I,P);if(x){if(x===le)continue;return x}}if("next"===P.method)P.sent=P._sent=P.arg;else if("throw"===P.method){if(y===Z)throw y=te,P.arg;P.dispatchException(P.arg)}else"return"===P.method&&P.abrupt("return",P.arg);y=q;var s=ke(V,R,P);if("normal"===s.type){if(y=P.done?te:X,s.arg===le)continue;return{value:s.arg,done:P.done}}"throw"===s.type&&(y=te,P.method="throw",P.arg=s.arg)}}}function Je(V,R){var P=R.method,y=V.iterator[P];if(y===ue)return R.delegate=null,"throw"===P&&V.iterator.return&&(R.method="return",R.arg=ue,Je(V,R),"throw"===R.method)||"return"!==P&&(R.method="throw",R.arg=new TypeError("The iterator does not provide a '"+P+"' method")),le;var w=ke(y,V.iterator,R.arg);if("throw"===w.type)return R.method="throw",R.arg=w.arg,R.delegate=null,le;var T=w.arg;return T?T.done?(R[V.resultName]=T.value,R.next=V.nextLoc,"return"!==R.method&&(R.method="next",R.arg=ue),R.delegate=null,le):T:(R.method="throw",R.arg=new TypeError("iterator result is not an object"),R.delegate=null,le)}function Pe(V){var R={tryLoc:V[0]};1 in V&&(R.catchLoc=V[1]),2 in V&&(R.finallyLoc=V[2],R.afterLoc=V[3]),this.tryEntries.push(R)}function dt(V){var R=V.completion||{};R.type="normal",delete R.arg,V.completion=R}function ht(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(Pe,this),this.reset(!0)}function lt(V){if(V||""===V){var R=V[b];if(R)return R.call(V);if("function"==typeof V.next)return V;if(!isNaN(V.length)){var P=-1,y=function w(){for(;++P<V.length;)if(Le.call(V,P))return w.value=V[P],w.done=!1,w;return w.value=ue,w.done=!0,w};return y.next=y}}throw new TypeError(typeof V+" is not iterable")}return xe.prototype=he,ge(U,"constructor",{value:he,configurable:!0}),ge(he,"constructor",{value:xe,configurable:!0}),xe.displayName=m(he,Q,"GeneratorFunction"),h.isGeneratorFunction=function(V){var R="function"==typeof V&&V.constructor;return!!R&&(R===xe||"GeneratorFunction"===(R.displayName||R.name))},h.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,he):(V.__proto__=he,m(V,Q,"GeneratorFunction")),V.prototype=Object.create(U),V},h.awrap=function(V){return{__await:V}},et(Ae.prototype),m(Ae.prototype,pe,function(){return this}),h.AsyncIterator=Ae,h.async=function(V,R,P,y,w){void 0===w&&(w=Promise);var T=new Ae(Ie(V,R,P,y),w);return h.isGeneratorFunction(R)?T:T.next().then(function(I){return I.done?I.value:T.next()})},et(U),m(U,Q,"Generator"),m(U,b,function(){return this}),m(U,"toString",function(){return"[object Generator]"}),h.keys=function(V){var R=Object(V),P=[];for(var y in R)P.push(y);return P.reverse(),function w(){for(;P.length;){var T=P.pop();if(T in R)return w.value=T,w.done=!1,w}return w.done=!0,w}},h.values=lt,ht.prototype={constructor:ht,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=ue,this.done=!1,this.delegate=null,this.method="next",this.arg=ue,this.tryEntries.forEach(dt),!R)for(var P in this)"t"===P.charAt(0)&&Le.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=ue)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if("throw"===R.type)throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var P=this;function y(J,Oe){return I.type="throw",I.arg=R,P.next=J,Oe&&(P.method="next",P.arg=ue),!!Oe}for(var w=this.tryEntries.length-1;w>=0;--w){var T=this.tryEntries[w],I=T.completion;if("root"===T.tryLoc)return y("end");if(T.tryLoc<=this.prev){var x=Le.call(T,"catchLoc"),s=Le.call(T,"finallyLoc");if(x&&s){if(this.prev<T.catchLoc)return y(T.catchLoc,!0);if(this.prev<T.finallyLoc)return y(T.finallyLoc)}else if(x){if(this.prev<T.catchLoc)return y(T.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<T.finallyLoc)return y(T.finallyLoc)}}}},abrupt:function(R,P){for(var y=this.tryEntries.length-1;y>=0;--y){var w=this.tryEntries[y];if(w.tryLoc<=this.prev&&Le.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var T=w;break}}T&&("break"===R||"continue"===R)&&T.tryLoc<=P&&P<=T.finallyLoc&&(T=null);var I=T?T.completion:{};return I.type=R,I.arg=P,T?(this.method="next",this.next=T.finallyLoc,le):this.complete(I)},complete:function(R,P){if("throw"===R.type)throw R.arg;return"break"===R.type||"continue"===R.type?this.next=R.arg:"return"===R.type?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):"normal"===R.type&&P&&(this.next=P),le},finish:function(R){for(var P=this.tryEntries.length-1;P>=0;--P){var y=this.tryEntries[P];if(y.finallyLoc===R)return this.complete(y.completion,y.afterLoc),dt(y),le}},catch:function(R){for(var P=this.tryEntries.length-1;P>=0;--P){var y=this.tryEntries[P];if(y.tryLoc===R){var w=y.completion;if("throw"===w.type){var T=w.arg;dt(y)}return T}}throw new Error("illegal catch attempt")},delegateYield:function(R,P,y){return this.delegate={iterator:lt(R),resultName:P,nextLoc:y},"next"===this.method&&(this.arg=ue),le}},h}typeof self<"u"&&self,se.exports=function(){var ge,ee,ue={302:function(ee,b,pe){var m;b.formatArgs=function(m){if(m[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+m[0]+(this.useColors?"%c ":" ")+"+"+ee.exports.humanize(this.diff),this.useColors){var Ie="color: "+this.color;m.splice(1,0,Ie,"color: inherit");var ke=0,Z=0;m[0].replace(/%[a-zA-Z%]/g,function(X){"%%"!==X&&(ke++,"%c"===X&&(Z=ke))}),m.splice(Z,0,Ie)}},b.save=function(m){try{m?b.storage.setItem("debug",m):b.storage.removeItem("debug")}catch{}},b.load=function(){var m;try{m=b.storage.getItem("debug")}catch{}return!m&&typeof process<"u"&&"env"in process&&(m=process.env.DEBUG),m},b.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage=function(){try{return localStorage}catch{}}(),b.destroy=(m=!1,function(){m||(m=!0)}),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||function(){},ee.exports=pe(65)(b),ee.exports.formatters.j=function(m){try{return JSON.stringify(m)}catch(Ie){return"[UnexpectedJSONParseError]: "+Ie.message}}},65:function(ee,b,pe){ee.exports=function(Q){function m(Z){var X,q,te,le=null;function De(){for(var xe=arguments.length,he=new Array(xe),$e=0;$e<xe;$e++)he[$e]=arguments[$e];if(De.enabled){var ze=De,Ze=Number(new Date);ze.diff=Ze-(X||Ze),ze.prev=X,ze.curr=Ze,X=Ze,he[0]=m.coerce(he[0]),"string"!=typeof he[0]&&he.unshift("%O");var et=0;he[0]=he[0].replace(/%([a-zA-Z%])/g,function(Ae,ot){if("%%"===Ae)return"%";et++;var Je=m.formatters[ot];return"function"==typeof Je&&(Ae=Je.call(ze,he[et]),he.splice(et,1),et--),Ae}),m.formatArgs.call(ze,he),(ze.log||m.log).apply(ze,he)}}return De.namespace=Z,De.useColors=m.useColors(),De.color=m.selectColor(Z),De.extend=Ie,De.destroy=m.destroy,Object.defineProperty(De,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==le?le:(q!==m.namespaces&&(q=m.namespaces,te=m.enabled(Z)),te)},set:function(he){le=he}}),"function"==typeof m.init&&m.init(De),De}function Ie(Z,X){var q=m(this.namespace+(void 0===X?":":X)+Z);return q.log=this.log,q}function ke(Z){return Z.toString().substring(2,Z.toString().length-2).replace(/\.\*\?$/,"*")}return m.debug=m,m.default=m,m.coerce=function(Z){return Z instanceof Error?Z.stack||Z.message:Z},m.disable=function(){var Z=[].concat(m.names.map(ke),m.skips.map(ke).map(function(X){return"-"+X})).join(",");return m.enable(""),Z},m.enable=function(Z){var X;m.save(Z),m.namespaces=Z,m.names=[],m.skips=[];var q=("string"==typeof Z?Z:"").split(/[\s,]+/),te=q.length;for(X=0;X<te;X++)q[X]&&("-"===(Z=q[X].replace(/\*/g,".*?"))[0]?m.skips.push(new RegExp("^"+Z.slice(1)+"$")):m.names.push(new RegExp("^"+Z+"$")))},m.enabled=function(Z){if("*"===Z[Z.length-1])return!0;var X,q;for(X=0,q=m.skips.length;X<q;X++)if(m.skips[X].test(Z))return!1;for(X=0,q=m.names.length;X<q;X++)if(m.names[X].test(Z))return!0;return!1},m.humanize=pe(247),m.destroy=function(){},Object.keys(Q).forEach(function(Z){m[Z]=Q[Z]}),m.names=[],m.skips=[],m.formatters={},m.selectColor=function(Z){for(var X=0,q=0;q<Z.length;q++)X=(X<<5)-X+Z.charCodeAt(q),X|=0;return m.colors[Math.abs(X)%m.colors.length]},m.enable(m.load()),m}},247:function(ee){var b=1e3,pe=60*b,Q=60*pe,m=24*Q;function X(q,te,le,De){var xe=te>=1.5*le;return Math.round(q/le)+" "+De+(xe?"s":"")}ee.exports=function(q,te){te=te||{};var le=typeof q;if("string"===le&&q.length>0)return function(q){if(!((q=String(q)).length>100)){var te=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(q);if(te){var le=parseFloat(te[1]);switch((te[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*le;case"weeks":case"week":case"w":return 6048e5*le;case"days":case"day":case"d":return le*m;case"hours":case"hour":case"hrs":case"hr":case"h":return le*Q;case"minutes":case"minute":case"mins":case"min":case"m":return le*pe;case"seconds":case"second":case"secs":case"sec":case"s":return le*b;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return le;default:return}}}}(q);if("number"===le&&isFinite(q))return te.long?function(q){var te=Math.abs(q);return te>=m?X(q,te,m,"day"):te>=Q?X(q,te,Q,"hour"):te>=pe?X(q,te,pe,"minute"):te>=b?X(q,te,b,"second"):q+" ms"}(q):function(q){var te=Math.abs(q);return te>=m?Math.round(q/m)+"d":te>=Q?Math.round(q/Q)+"h":te>=pe?Math.round(q/pe)+"m":te>=b?Math.round(q/b)+"s":q+"ms"}(q);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(q))}}},h={};function Re(ge){var ee=h[ge];if(void 0!==ee)return ee.exports;var b=h[ge]={exports:{}};return ue[ge](b,b.exports,Re),b.exports}ee=Object.getPrototypeOf?function(b){return Object.getPrototypeOf(b)}:function(b){return b.__proto__},Re.t=function(b,pe){if(1&pe&&(b=this(b)),8&pe||"object"==typeof b&&b&&(4&pe&&b.__esModule||16&pe&&"function"==typeof b.then))return b;var Q=Object.create(null);Re.r(Q);var m={};ge=ge||[null,ee({}),ee([]),ee(ee)];for(var Ie=2&pe&&b;"object"==typeof Ie&&!~ge.indexOf(Ie);Ie=ee(Ie))Object.getOwnPropertyNames(Ie).forEach(function(ke){return m[ke]=function(){return b[ke]}});return m.default=function(){return b},Re.d(Q,m),Q},Re.d=function(ge,ee){for(var b in ee)Re.o(ee,b)&&!Re.o(ge,b)&&Object.defineProperty(ge,b,{enumerable:!0,get:ee[b]})},Re.o=function(ge,ee){return Object.prototype.hasOwnProperty.call(ge,ee)},Re.r=function(ge){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ge,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ge,"__esModule",{value:!0})};var Le={};return function(){"use strict";Re.r(Le),Re.d(Le,{ActionObjectType:function(){return R},ChannelType:function(){return ut},ChildAppWindow:function(){return Vr},DialogDimension:function(){return Me},ErrorCode:function(){return y},FileOpenPreference:function(){return V},FrameContexts:function(){return s},HostClientType:function(){return I},HostName:function(){return x},LiveShareHost:function(){return Bi},NotificationTypes:function(){return _n},ParentAppWindow:function(){return ri},SecondaryM365ContentIdName:function(){return P},TaskModuleDimension:function(){return we},TeamType:function(){return J},UserSettingTypes:function(){return In},UserTeamRole:function(){return Oe},ViewerActionTypes:function(){return Sn},app:function(){return pt},appEntity:function(){return sr},appInitialization:function(){return Qn},appInstallDialog:function(){return En},authentication:function(){return Zt},barCode:function(){return Mn},calendar:function(){return Un},call:function(){return Kn},chat:function(){return Rn},clipboard:function(){return An},conversations:function(){return Pn},dialog:function(){return mt},enablePrintCapability:function(){return gi},executeDeepLink:function(){return Ri},externalAppAuthentication:function(){return tr},externalAppCardActions:function(){return nr},files:function(){return rr},geoLocation:function(){return Fn},getAdaptiveCardSchemaVersion:function(){return ni},getContext:function(){return vi},getMruTabInstances:function(){return Oi},getTabInstances:function(){return ki},initialize:function(){return mi},initializeWithFrameContext:function(){return Fi},liveShare:function(){return rn},location:function(){return xn},logs:function(){return Cn},mail:function(){return Bn},marketplace:function(){return sn},media:function(){return It},meeting:function(){return Ln},meetingRoom:function(){return or},menus:function(){return Jt},monetization:function(){return Nn},navigateBack:function(){return Ni},navigateCrossDomain:function(){return Li},navigateToTab:function(){return xi},notifications:function(){return ir},openFilePreview:function(){return Vo},pages:function(){return Ve},people:function(){return Hn},print:function(){return hi},profile:function(){return zn},registerAppButtonClickHandler:function(){return wi},registerAppButtonHoverEnterHandler:function(){return Ci},registerAppButtonHoverLeaveHandler:function(){return _i},registerBackButtonHandler:function(){return Si},registerBeforeUnloadHandler:function(){return Pi},registerChangeSettingsHandler:function(){return Ti},registerCustomHandler:function(){return Ho},registerFocusEnterHandler:function(){return Ei},registerFullScreenHandler:function(){return yi},registerOnLoadHandler:function(){return Ii},registerOnThemeChangeHandler:function(){return bi},registerUserSettingsChangeHandler:function(){return zo},remoteCamera:function(){return ar},returnFocus:function(){return Di},search:function(){return jn},secondaryBrowser:function(){return Dn},sendCustomEvent:function(){return Bo},sendCustomMessage:function(){return Uo},setFrameContext:function(){return Ai},settings:function(){return Jn},shareDeepLink:function(){return Mi},sharing:function(){return Gn},stageView:function(){return Wn},tasks:function(){return Xn},teams:function(){return cr},teamsCore:function(){return kt},thirdPartyCloudStorage:function(){return Zn},uploadCustomApp:function(){return No},version:function(){return ve},videoEffects:function(){return Pt},videoEffectsEx:function(){return dr},visualMedia:function(){return $n},webStorage:function(){return qn}});var Q,m,e,ge=(0,Re(302).debug)("teamsJs");function ee(e){return ge.extend(e)}function b(e,t){return e+"_"+t}function pe(e){return/^v\d+_[\w.]+$/.test(e)}(e=Q||(Q={})).V_0="v0",e.V_1="v1",e.V_2="v2",e.V_3="v3",function(e){e.App_GetContext="app.getContext",e.App_Initialize="app.initialize",e.App_NotifyAppLoaded="app.notifyAppLoaded",e.App_NotifyExpectedFailure="app.notifyExpectedFailure",e.App_NotifyFailure="app.notifyFailure",e.App_NotifySuccess="app.notifySuccess",e.App_OpenLink="app.openLink",e.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",e.AppEntity_SelectAppEntity="appEntity.selectAppEntity",e.BarCode_HasPermission="barCode.hasPermission",e.BarCode_RequestPermission="barCode.requestPermission",e.BarCode_ScanBarCode="barCode.scanBarCode",e.Calendar_ComposeMeeting="calendar.composeMeeting",e.Calendar_OpenCalendarItem="calendar.openCalendarItem",e.Call_StartCall="call.startCall",e.Clipboard_Read="clipboard.read",e.Clipboard_Write="clipboard.write",e.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",e.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",e.Dialog_Update_Resize="dialog.update.resize",e.Dialog_Url_Bot_Open="dialog.url.bot.open",e.Dialog_Url_Open="dialog.url.open",e.Dialog_Url_Submit="dialog.url.submit",e.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",e.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",e.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",e.GeoLocation_HasPermission="geoLocation.hasPermission",e.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",e.GeoLocation_RequestPermission="geoLocation.hasPermission",e.GeoLocation_ShowLocation="geoLocation.showLocation",e.Location_GetLocation="location.getLocation",e.Location_ShowLocation="location.showLocation",e.Mail_ComposeMail="mail.composeMail",e.Mail_OpenMailItem="mail.openMailItem",e.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",e.Marketplace_GetCart="marketplace.getCart",e.Marketplace_RemoveCardItems="marketplace.removeCartItems",e.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",e.Media_CaptureImage="media.captureImage",e.Media_Controller="media.controller",e.Media_GetMedia="media.getMedia",e.Media_HasPermission="media.hasPermission",e.Media_RequestPermission="media.requestPermission",e.Media_ScanBarCode="media.scanBarCode",e.Media_SelectMedia="media.selectMedia",e.Media_ViewImages="media.viewImages",e.Navigation_NavigateBack="navigation.navigateBack",e.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",e.Navigation_NavigateToTab="navigation.navigateToTab",e.Navigation_ReturnFocus="navigation.returnFocus",e.Pages_AppButton_OnClick="pages.appButton.onClick",e.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",e.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",e.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",e.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",e.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",e.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",e.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",e.Pages_Config_SetConfig="pages.config.setConfig",e.Pages_Config_SetValidityState="pages.config.setValidityState",e.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",e.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",e.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",e.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",e.Pages_GetConfig="pages.getConfig.",e.Pages_NavigateCrossDomain="pages.navigateCrossDomain",e.Pages_NavigateToApp="pages.navigateToApp",e.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",e.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",e.Pages_ReturnFocus="pages.returnFocus",e.Pages_SetCurrentFrame="pages.setCurrentFrame",e.Pages_ShareDeepLink="pages.shareDeepLink",e.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",e.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",e.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",e.PublicAPIs_ExecuteDeepLink="executeDeepLink",e.PublicAPIs_GetContext="getContext",e.PublicAPIs_GetMruTabInstances="getMruTabInstances",e.PublicAPIs_GetTabInstances="getTabInstances",e.PublicAPIs_Initialize="initialize",e.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",e.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",e.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",e.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",e.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",e.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",e.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",e.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",e.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",e.PublicAPIs_SetFrameContext="setFrameContext",e.PublicAPIs_ShareDeepLink="shareDeepLink",e.RegisterHandler="registerHandler",e.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",e.Settings_Remove_Failure="settings.remove.failure",e.Settings_Remove_Success="settings.remove.success",e.Settings_Save_Failure="settings.save.failure",e.Settings_Save_Success="settings.save.success",e.Tasks_StartTask="tasks.startTask",e.Tasks_SubmitTask="tasks.submitTask",e.Tasks_UpdateTask="tasks.updateTask"}(m||(m={}));var Ie=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),ke="2.0.1",Z="2.0.3",X="1.9.0",q="1.8.0",te=Re.t(Ie,2).validOrigins,le=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),De=/^https:\/\//,xe="https",he="teams.microsoft.com",$e="The library has not yet been initialized",ze="The runtime has not yet been initialized",Ze="The runtime version is not supported",U=function(){};U.initializeCalled=!1,U.initializeCompleted=!1,U.additionalValidOrigins=[],U.initializePromise=void 0,U.isFramelessWindow=!1,U.frameContext=void 0,U.hostClientType=void 0,U.printCapabilityEnabled=!1;var Ae,et={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},ot=new Uint8Array(16);function Je(){if(!Ae&&!(Ae=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ae(ot)}for(var Pe=[],dt=0;dt<256;++dt)Pe.push((dt+256).toString(16).slice(1));var V,R,P,y,w,T,I,x,s,J,Oe,Me,lt=function(t,r,o){if(et.randomUUID&&!r&&!t)return et.randomUUID();var n=(t=t||{}).random||(t.rng||Je)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){o=o||0;for(var a=0;a<16;++a)r[o+a]=n[a];return r}return function(e,t){return void 0===t&&(t=0),(Pe[e[t+0]]+Pe[e[t+1]]+Pe[e[t+2]]+Pe[e[t+3]]+"-"+Pe[e[t+4]]+Pe[e[t+5]]+"-"+Pe[e[t+6]]+Pe[e[t+7]]+"-"+Pe[e[t+8]]+Pe[e[t+9]]+"-"+Pe[e[t+10]]+Pe[e[t+11]]+Pe[e[t+12]]+Pe[e[t+13]]+Pe[e[t+14]]+Pe[e[t+15]]).toLowerCase()}(n)};(function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"})(V||(V={})),function(e){e.M365Content="m365content"}(R||(R={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(P||(P={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(y||(y={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(w||(w={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(T||(T={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(I||(I={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(x||(x={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(s||(s={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(J||(J={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(Oe||(Oe={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(Me||(Me={}));var ut,we=Me;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(ut||(ut={}));var k={errorCode:y.NOT_SUPPORTED_ON_PLATFORM},Se={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},Ee=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),Vt=new Error("Invalid response: Received more images than the specified max limit in the response.");function Be(e){return function(t,r){if(!t)throw new Error(e||r)}}function tt(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var r=e.split("."),o=t.split(".");function n(d){return/^\d+$/.test(d)}if(!r.every(n)||!o.every(n))return NaN;for(;r.length<o.length;)r.push("0");for(;o.length<r.length;)o.push("0");for(var a=0;a<r.length;++a)if(Number(r[a])!=Number(o[a]))return Number(r[a])>Number(o[a])?1:-1;return 0}function it(){return lt()}function nt(e){return Object.keys(e).forEach(function(t){"object"==typeof e[t]&&nt(e[t])}),Object.freeze(e)}function Dt(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];var a=e.apply(void 0,o);return a.then(function(){t&&t(null)}).catch(function(d){t&&t(d)}),a}function Wt(e){return!(tt(e.majorVersion+"."+e.minorVersion,"1.5")>=0)}function $t(e){return"https:"===e.protocol}function ln(e,t){return new Promise(function(r,o){e||o("MimeType cannot be null or empty."),t||o("Base64 string cannot be null or empty.");var n=atob(t);if(e.startsWith("image/")){for(var a=new Uint8Array(n.length),d=0;d<n.length;d++)a[d]=n.charCodeAt(d);r(new Blob([a],{type:e}))}r(new Blob([n],{type:e}))})}function un(e){return new Promise(function(t,r){0===e.size&&r(new Error("Blob cannot be empty."));var o=new FileReader;o.onloadend=function(){o.result?t(o.result.toString().split(",")[1]):r(new Error("Failed to read the blob"))},o.onerror=function(){r(o.error)},o.readAsDataURL(e)})}function yt(){if(at())throw new Error("window object undefined at SSR check");return window}function at(){return typeof window>"u"}var pn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Et(e){if(!pn.test(e))throw new Error("App ID is not valid. Must be GUID format. App ID: "+e)}var qt=ee("runtime"),Ot=3;function mn(e){return e.apiVersion===Ot}var i={apiVersion:-1,supports:{}},O={apiVersion:3,hostVersionsInfo:Se,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},N=[I.desktop,I.web,I.rigel,I.surfaceHub,I.teamsRoomsWindows,I.teamsRoomsAndroid,I.teamsPhones,I.teamsDisplays],de=[].concat(N,[I.android,I.ios,I.ipados]);var G=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(t){var r;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:t.isLegacyTeams,supports:Object.assign(Object.assign({},t.supports),{dialog:t.supports.dialog?{card:void 0,url:t.supports.dialog,update:null===(r=t.supports.dialog)||void 0===r?void 0:r.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(t){var n=function(t,r){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(o[n[a]]=t[n[a]])}return o}(t.supports,["appNotification"]);return Object.assign(Object.assign({},t),{apiVersion:3,supports:n})}}],M={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:N}],"1.9.0":[{capability:{location:{}},hostClientTypes:de}],"2.0.0":[{capability:{people:{}},hostClientTypes:de},{capability:{sharing:{}},hostClientTypes:[I.desktop,I.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[I.android,I.desktop,I.ios,I.teamsRoomsAndroid,I.teamsPhones,I.teamsDisplays,I.web]},{capability:{webStorage:{}},hostClientTypes:[I.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[I.android,I.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[I.android,I.ios]}]},K=qt.extend("generateBackCompatRuntimeConfig");function re(e,t){var r=Object.assign({},e);for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&("object"!=typeof t[o]||Array.isArray(t[o])?o in e||(r[o]=t[o]):r[o]=re(e[o]||{},t[o]));return r}function _e(e,t,r){K("generating back compat runtime config for %s",e);var o=Object.assign({},t.supports);K("Supported capabilities in config before updating based on highestSupportedVersion: %o",o),Object.keys(r).forEach(function(a){tt(e,a)>=0&&r[a].forEach(function(d){void 0!==U.hostClientType&&d.hostClientTypes.includes(U.hostClientType)&&(o=re(o,d.capability))})});var n={apiVersion:Ot,hostVersionsInfo:Se,isLegacyTeams:!0,supports:o};return K("Runtime config after updating based on highestSupportedVersion: %o",n),n}var be=qt.extend("applyRuntimeConfig");function ae(e){"string"==typeof e.apiVersion&&(be("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),be("Fast-forwarding runtime %o",e);var t=function(e){var t=e;if(t.apiVersion<Ot&&G.forEach(function(r){t.apiVersion===r.versionToUpgradeFrom&&(t=r.upgradeToNextVersion(t))}),mn(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}(e);be("Applying runtime %o",t),i=nt(t)}var ve="2.19.0",je=ee("internal"),Ye=je.extend("ensureInitializeCalled"),st=je.extend("ensureInitialized");function He(){if(!U.initializeCalled)throw Ye($e),new Error($e)}function f(e){if(!U.initializeCompleted)throw st("%s. initializeCalled: %s",$e,U.initializeCalled.toString()),new Error($e);for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(r&&r.length>0){for(var n=!1,a=0;a<r.length;a++)if(r[a]===U.frameContext){n=!0;break}if(!n)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(r)+'. Current context: "'+U.frameContext+'".')}return function(e){if(mn(e))return!0;throw-1===e.apiVersion?new Error(ze):new Error(Ze)}(e)}function qe(e){void 0===e&&(e=ke);var t=tt(U.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function Mt(){return U.hostClientType==I.android||U.hostClientType==I.ios||U.hostClientType==I.ipados}function Kt(e){if(void 0===e&&(e=ke),!Mt())throw{errorCode:y.NOT_SUPPORTED_ON_PLATFORM};if(!qe(e))throw{errorCode:y.OLD_PLATFORM}}function Te(e){return null==e}var Zt,lr=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})},Tt=[],Qt=ee("validateOrigin");function ur(){return lr(this,void 0,void 0,z().mark(function e(){return z().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",0!==Tt.length?Tt:at()?(Tt=te,te):fetch(le).then(function(o){if(!o.ok)throw new Error("Invalid Response from Fetch Call");return o.json().then(function(n){if(so(JSON.stringify(n)))return Tt=n.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(o){return Qt("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",o),Tt=te}));case 1:case"end":return r.stop()}},e)}))}function so(e){var t=JSON.parse(e);try{t=JSON.parse(e)}catch{return!1}if(!t.validOrigins)return!1;for(var o,r=$(t.validOrigins);!(o=r()).done;){var n=o.value;try{new URL("https://"+n)}catch{return Qt("isValidOriginsFromCDN call failed to validate origin: %s",n),!1}}return!0}function pr(e,t){if("*."===e.substring(0,2)){var r=e.substring(1);if(t.length>r.length&&t.split(".").length===r.split(".").length&&t.substring(t.length-r.length)===r)return!0}else if(e===t)return!0;return!1}function co(e){return ur().then(function(t){if(!$t(e))return Qt("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;var r=e.host;if(t.some(function(d){return pr(d,r)}))return!0;for(var n,o=$(U.additionalValidOrigins);!(n=o()).done;){var a=n.value;if(pr("https://"===a.substring(0,8)?a.substring(8):a,r))return!0}return Qt("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,U.additionalValidOrigins),!1})}!function(e){var t,r,o,C;function a(C){return new Promise(function(B,W){if(U.hostClientType===I.desktop||U.hostClientType===I.android||U.hostClientType===I.ios||U.hostClientType===I.ipados||U.hostClientType===I.macos||U.hostClientType===I.rigel||U.hostClientType===I.teamsRoomsWindows||U.hostClientType===I.teamsRoomsAndroid||U.hostClientType===I.teamsPhones||U.hostClientType===I.teamsDisplays||U.hostClientType===I.surfaceHub){var F=document.createElement("a");F.href=C.url,B(ft("authentication.authenticate",[F.href,C.width,C.height,C.isExternal]).then(function(oe){var rt=oe[1];if(oe[0])return rt;throw new Error(rt)}))}else t={success:B,fail:W},function(C){p();var B=C.width||600,W=C.height||400;B=Math.min(B,A.currentWindow.outerWidth-400),W=Math.min(W,A.currentWindow.outerHeight-200);var F=document.createElement("a");F.href=C.url.replace("{oauthRedirectMethod}","web");var oe=void 0!==A.currentWindow.screenLeft?A.currentWindow.screenLeft:A.currentWindow.screenX,me=void 0!==A.currentWindow.screenTop?A.currentWindow.screenTop:A.currentWindow.screenY;A.childWindow=A.currentWindow.open(F.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(me+=A.currentWindow.outerHeight/2-W/2)+", left="+(oe+=A.currentWindow.outerWidth/2-B/2)+", width="+B+", height="+W),A.childWindow?(c(),r=A.currentWindow.setInterval(function(){if(!A.childWindow||A.childWindow.closed)D("CancelledByUser");else{var C=A.childOrigin;try{A.childOrigin="*",gt("ping")}finally{A.childOrigin=C}}},100),Y("initialize",function(){return[s.authentication,U.hostClientType]}),Y("navigateCrossDomain",function(){return!1})):D("FailedToOpenWindow")}(C)})}function p(){c();try{A.childWindow&&A.childWindow.close()}finally{A.childWindow=null,A.childOrigin=null}}function c(){r&&(clearInterval(r),r=0),Ke("initialize"),Ke("navigateCrossDomain")}function v(C){try{t&&t.success(C)}finally{t=void 0,p()}}function D(C){try{t&&t.fail(new Error(C))}finally{t=void 0,p()}}function ne(C,B,W){if(C){var F=document.createElement("a");F.href=decodeURIComponent(C),F.host&&F.host!==yt().location.host&&"outlook.office.com"===F.host&&F.search.indexOf("client_type=Win32_Outlook")>-1&&(B&&"result"===B&&(W&&(F.href=L(F.href,"result",W)),A.currentWindow.location.assign(L(F.href,"authSuccess",""))),B&&"reason"===B&&(W&&(F.href=L(F.href,"reason",W)),A.currentWindow.location.assign(L(F.href,"authFailure",""))))}}function L(C,B,W){var F=C.indexOf("#"),oe=-1===F?"#":C.substr(F);return oe=oe+"&"+B+(""!==W?"="+W:""),(C=-1===F?C:C.substr(0,F))+oe}e.initialize=function(){Y("authentication.authenticate.success",v,!1),Y("authentication.authenticate.failure",D,!1)},e.registerAuthenticationHandlers=function(C){o=C},e.authenticate=function(C){var B=void 0!==C,W=B?C:o;if(!W)throw new Error("No parameters are provided for authentication");return f(i,s.content,s.sidePanel,s.settings,s.remove,s.task,s.stage,s.meetingStage),a(W).then(function(F){try{return W&&W.successCallback?(W.successCallback(F),""):F}finally{B||(o=void 0)}}).catch(function(F){try{if(W&&W.failureCallback)return W.failureCallback(F.message),"";throw F}finally{B||(o=void 0)}})},e.getAuthToken=function(C){return He(),function(C){return new Promise(function(B){B(ft("authentication.getAuthToken",[C?.resources,C?.claims,C?.silent]))}).then(function(B){var F=B[1];if(B[0])return F;throw new Error(F)})}(C).then(function(B){return C&&C.successCallback?(C.successCallback(B),""):B}).catch(function(B){if(C&&C.failureCallback)return C.failureCallback(B.message),"";throw B})},e.getUser=function(C){return He(),new Promise(function(C){C(ft("authentication.getUser"))}).then(function(C){var W=C[1];if(C[0])return W;throw new Error(W)}).then(function(B){return C&&C.successCallback?(C.successCallback(B),null):B}).catch(function(B){if(C&&C.failureCallback)return C.failureCallback(B.message),null;throw B})},e.notifySuccess=function(C,B){ne(B,"result",C),f(i,s.authentication),j("authentication.authenticate.success",[C]),xr(A.parentWindow,function(){return setTimeout(function(){return A.currentWindow.close()},200)})},e.notifyFailure=function(C,B){ne(B,"reason",C),f(i,s.authentication),j("authentication.authenticate.failure",[C]),xr(A.parentWindow,function(){return setTimeout(function(){return A.currentWindow.close()},200)})},(C=e.DataResidency||(e.DataResidency={})).Public="public",C.EUDB="eudb",C.Other="other"}(Zt||(Zt={}));var mt,Jt,wt=Q.V_2;function fr(e,t){if(f(i,s.content,s.sidePanel,s.task,s.meetingStage),!mt.update.isSupported())throw k;ie(e,"tasks.updateTask",[t])}function mr(e,t,r,o){if(f(i,s.content,s.sidePanel,s.meetingStage),!mt.url.isSupported())throw k;o&&Y("messageForParent",o),ie(e,"tasks.startTask",[mt.url.getDialogInfoFromUrlDialogInfo(t)],function(n,a){r?.({err:n,result:a}),Ke("messageForParent")})}function gr(e,t,r,o){if(f(i,s.content,s.sidePanel,s.meetingStage),!mt.url.bot.isSupported())throw k;o&&Y("messageForParent",o),ie(e,"tasks.startTask",[mt.url.getDialogInfoFromBotUrlDialogInfo(t)],function(n,a){r?.({err:n,result:a}),Ke("messageForParent")})}function hr(e,t,r){if(f(i,s.content,s.task),!mt.url.isSupported())throw k;ie(e,"tasks.completeTask",[t,r?Array.isArray(r)?r:[r]:[]])}(function(e){var d,t=[];function r(d){U.frameContext&&(U.frameContext===s.task?t.push(d):Ke("messageForChild"))}e.initialize=function(){Y("messageForChild",r,!1)},function(d){function u(){return f(i)&&void 0!==(i.supports.dialog&&i.supports.dialog.url)}var c;function l(c){return{url:c.url,height:c.size?c.size.height:Me.Small,width:c.size?c.size.width:Me.Small,title:c.title,fallbackUrl:c.fallbackUrl}}d.open=function(c,g,v){mr(b(wt,m.Dialog_Url_Open),c,g,v)},d.submit=function(c,g){hr(b(wt,m.Dialog_Url_Submit),c,g)},d.sendMessageToParentFromDialog=function(c){if(f(i,s.task),!u())throw k;ie(b(wt,m.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[c])},d.sendMessageToDialog=function(c){if(f(i,s.content,s.sidePanel,s.meetingStage),!u())throw k;ie(b(wt,m.Dialog_Url_SendMessageToDialog),"messageForChild",[c])},d.registerOnMessageFromParent=function(c){if(f(i,s.task),!u())throw k;for(Ke("messageForChild"),Y("messageForChild",c),t.reverse();t.length>0;)c(t.pop())},d.isSupported=u,(c=d.bot||(d.bot={})).open=function(g,v,D){gr(b(wt,m.Dialog_Url_Bot_Open),g,v,D)},c.isSupported=function(){return f(i)&&void 0!==(i.supports.dialog&&i.supports.dialog.url&&i.supports.dialog.url.bot)},d.getDialogInfoFromUrlDialogInfo=l,d.getDialogInfoFromBotUrlDialogInfo=function(c){var g=l(c);return g.completionBotId=c.completionBotId,g}}(e.url||(e.url={})),e.isSupported=function(){return!(!f(i)||!i.supports.dialog)},(d=e.update||(e.update={})).resize=function(u){fr(b(wt,m.Dialog_Update_Resize),u)},d.isSupported=function(){return!(!f(i)||!i.supports.dialog||!i.supports.dialog.update)},function(d){function u(){var g=i.hostVersionsInfo&&i.hostVersionsInfo.adaptiveCardSchemaVersion&&!Wt(i.hostVersionsInfo.adaptiveCardSchemaVersion);return f(i)&&void 0!==(g&&i.supports.dialog&&i.supports.dialog.card)}function l(g){return{card:g.card,height:g.size?g.size.height:Me.Small,width:g.size?g.size.width:Me.Small,title:g.title}}d.open=function(g,v){if(f(i,s.content,s.sidePanel,s.meetingStage),!u())throw k;var D=l(g);ie(b(wt,m.Dialog_AdaptiveCard_Open),"tasks.startTask",[D],function(ne,L){v?.({err:ne,result:L})})},d.isSupported=u,function(g){function v(){var D=i.hostVersionsInfo&&i.hostVersionsInfo.adaptiveCardSchemaVersion&&!Wt(i.hostVersionsInfo.adaptiveCardSchemaVersion);return f(i)&&void 0!==(D&&i.supports.dialog&&i.supports.dialog.card&&i.supports.dialog.card.bot)}g.open=function(D,ne){if(f(i,s.content,s.sidePanel,s.meetingStage),!v())throw k;var L=function(g){var v=l(g);return v.completionBotId=g.completionBotId,v}(D);ie(b(wt,m.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[L],function(C,B){ne?.({err:C,result:B})})},g.isSupported=v}(d.bot||(d.bot={}))}(e.adaptiveCard||(e.adaptiveCard={}))})(mt||(mt={})),function(e){var o,n,a,c;function d(c){a&&a(c)||(f(i),j("viewConfigItemPress",[c]))}function u(c){o&&o(c)||(f(i),j("handleNavBarMenuItemPress",[c]))}function p(c){n&&n(c)||(f(i),j("handleActionMenuItemPress",[c]))}function l(){return!(!f(i)||!i.supports.menus)}(c=e.DisplayMode||(e.DisplayMode={}))[c.ifRoom=0]="ifRoom",c[c.overflowOnly=1]="overflowOnly",e.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(c){c.dropDown="dropDown",c.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){Y("navBarMenuItemPress",u,!1),Y("actionMenuItemPress",p,!1),Y("setModuleView",d,!1)},e.setUpViews=function(c,g){if(f(i),!l())throw k;a=g,j("setUpViews",[c])},e.setNavBarMenu=function(c,g){if(f(i),!l())throw k;o=g,j("setNavBarMenu",[c])},e.showActionMenu=function(c,g){if(f(i),!l())throw k;n=g,j("showActionMenu",[c])},e.isSupported=l}(Jt||(Jt={}));var Ct=Q.V_2,lo=5e3,vr=ee("app");function hn(e,t){return at()?(vr.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(e,t,r){return new Promise(function(o,n){var a=setTimeout(n,t,r);e().then(function(d){clearTimeout(a),o(d)}).catch(function(d){clearTimeout(a),n(d)})})}(function(){return function(e,t){return new Promise(function(r){U.initializeCalled||(U.initializeCalled=!0,Ce.initializeHandlers(),U.initializePromise=function(e,t){var r=this;if(Fe.messageListener=function(n){return bn(r,void 0,void 0,z().mark(function a(){return z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,To(n);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},a)}))},A.currentWindow=A.currentWindow||yt(),A.parentWindow=A.currentWindow.parent!==A.currentWindow.self?A.currentWindow.parent:A.currentWindow.opener,(A.parentWindow||e)&&A.currentWindow.addEventListener("message",Fe.messageListener,!1),!A.parentWindow){var o=A.currentWindow;if(!o.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));U.isFramelessWindow=!0,o.onNativeMessage=Fr}try{return A.parentOrigin="*",Ut(t,"initialize",[ve,Ot]).then(function(n){return{context:n[0],clientType:n[1],runtimeConfig:n[2],clientSupportedSDKVersion:n[3]}})}finally{A.parentOrigin=null}}(t,e).then(function(o){var a=o.clientType,d=o.runtimeConfig,u=o.clientSupportedSDKVersion,p=void 0===u?ke:u;U.frameContext=o.context,U.hostClientType=a,U.clientSupportedSDKVersion=p;try{xt("Parsing %s",d);var l=JSON.parse(d);if(xt("Checking if %o is a valid runtime object",l??"null"),!l||!l.apiVersion)throw new Error("Received runtime config is invalid");d&&ae(l)}catch(g){if(!(g instanceof SyntaxError))throw g;try{xt("Attempting to parse %s as an SDK version",d),isNaN(tt(d,ke))||(U.clientSupportedSDKVersion=d);var c=JSON.parse(p);if(xt("givenRuntimeConfig parsed to %o",c??"null"),!c)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");ae(c)}catch(v){if(!(v instanceof SyntaxError))throw v;ae(_e(U.clientSupportedSDKVersion,O,M))}}U.initializeCompleted=!0}),Zt.initialize(),Jt.initialize(),Ve.config.initialize(),mt.initialize()),Array.isArray(t)&&function(e){var t=U.additionalValidOrigins.concat(e.filter(function(o){return"string"==typeof o&&De.test(o)})),r={};t=t.filter(function(o){return!r[o]&&(r[o]=!0,!0)}),U.additionalValidOrigins=t}(t),void 0!==U.initializePromise?r(U.initializePromise):xt("GlobalVars.initializePromise is unexpectedly undefined")})}(e,t)},lo,new Error("SDK initialization timed out."))}var pt,xt=vr.extend("initializeHelper");function br(e,t){!Te(t)&&He(),function(e,t){Ce.themeChangeHandler=t,!Te(t)&&ie(e,"registerHandler",["themeChange"])}(e,t)}function yr(e,t){return new Promise(function(r){f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage),r(_t(e,"executeDeepLink",t))})}!function(e){var a,t=ee("app");e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(a=e.FailedReason||(e.FailedReason={})).AuthFailed="AuthFailed",a.Timeout="Timeout",a.Other="Other",function(a){a.PermissionError="PermissionError",a.NotFound="NotFound",a.Throttling="Throttling",a.Offline="Offline",a.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return U.initializeCompleted},e.getFrameContext=function(){return U.frameContext},function(){if(!at()){var a=document.getElementsByTagName("script"),d=a&&a[a.length-1]&&a[a.length-1].src,u="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";d&&0!==d.length?t("teamsjs is being used from %s. %s",d,u):t("teamsjs is being used from a script tag embedded directly in your html. %s",u)}}(),e.initialize=function(a){return function(){lr(this,void 0,void 0,z().mark(function e(){return z().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ur();case 2:case"end":return r.stop()}},e)}))}(),hn(b(Ct,m.App_Initialize),a)},e._initialize=function(a){A.currentWindow=a},e._uninitialize=function(){U.initializeCalled&&(Ce.uninitializeHandlers(),U.initializeCalled=!1,U.initializeCompleted=!1,U.initializePromise=void 0,U.additionalValidOrigins=[],U.frameContext=void 0,U.hostClientType=void 0,U.isFramelessWindow=!1,A.currentWindow&&A.currentWindow.removeEventListener("message",Fe.messageListener,!1),A.currentWindow=null,A.parentWindow=null,A.parentOrigin=null,A.childWindow=null,A.childOrigin=null,Fe.parentMessageQueue=[],Fe.childMessageQueue=[],Fe.nextMessageId=0,Fe.callbacks={},Fe.promiseCallbacks={})},e.getContext=function(){return new Promise(function(a){He(),a(Nt(b(Ct,m.App_GetContext),"getContext"))}).then(function(a){return function(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:x.teams,clientType:e.hostClientType?e.hostClientType:I.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:U.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}(a)})},e.notifyAppLoaded=function(){He(),ie(b(Ct,m.App_NotifyAppLoaded),e.Messages.AppLoaded,[ve])},e.notifySuccess=function(){He(),ie(b(Ct,m.App_NotifySuccess),e.Messages.Success,[ve])},e.notifyFailure=function(a){He(),ie(b(Ct,m.App_NotifyFailure),e.Messages.Failure,[a.reason,a.message])},e.notifyExpectedFailure=function(a){He(),ie(b(Ct,m.App_NotifyExpectedFailure),e.Messages.ExpectedFailure,[a.reason,a.message])},e.registerOnThemeChangeHandler=function(a){br(b(Ct,m.App_RegisterOnThemeChangeHandler),a)},e.openLink=function(a){return yr(b(Ct,m.App_OpenLink),a)},function(a){a.registerBeforeSuspendOrTerminateHandler=function(d){if(!d)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");f(i),function(e){Ce.beforeSuspendOrTerminateHandler=e,!Te(e)&&j("registerHandler",["beforeUnload"])}(d)},a.registerOnResumeHandler=function(d){if(!d)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");f(i),function(e){Ce.resumeHandler=e,!Te(e)&&j("registerHandler",["load"])}(d)}}(e.lifecycle||(e.lifecycle={}))}(pt||(pt={}));var Ve,ye=Q.V_2;function wr(e,t){return new Promise(function(r){if(f(i,s.content,s.sidePanel,s.settings,s.remove,s.task,s.stage,s.meetingStage),!Ve.isSupported())throw k;r(wn(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))})}function Cr(e){return new Promise(function(t){if(f(i),!Ve.backStack.isSupported())throw k;t(wn(e,"navigateBack","Back navigation is not supported in the current client or context."))})}function _r(e,t){return new Promise(function(r){if(f(i),!Ve.tabs.isSupported())throw k;r(wn(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))})}function Sr(e,t){if(f(i),!Ve.isSupported())throw k;ie(e,"returnFocus",[t])}function Ir(e,t){return new Promise(function(r){if(f(i),!Ve.tabs.isSupported())throw k;r(Nt(e,"getTabInstances",t))})}function Pr(e,t){return new Promise(function(r){if(f(i),!Ve.tabs.isSupported())throw k;r(Nt(e,"getMruTabInstances",t))})}function Er(e,t){if(f(i,s.content,s.sidePanel,s.meetingStage),!Ve.isSupported())throw k;ie(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function vn(e,t){if(f(i,s.content),!Ve.isSupported())throw k;ie(e,"setFrameContext",[t])}!function(e){function t(l){vn(b(ye,m.Pages_SetCurrentFrame),l)}function r(){return!(!f(i)||!i.supports.pages)}var l;e.returnFocus=function(l){Sr(b(ye,m.Pages_ReturnFocus),l)},e.registerFocusEnterHandler=function(l){ct(b(ye,m.Pages_RegisterFocusEnterHandler),"focusEnter",l,[],function(){if(!r())throw k})},e.setCurrentFrame=t,e.initializeWithFrameContext=function(l,c,g){pt.initialize(g).then(function(){return c&&c()}),t(l)},e.getConfig=function(){return new Promise(function(l){if(f(i,s.content,s.settings,s.remove,s.sidePanel),!r())throw k;l(Nt(b(ye,m.Pages_GetConfig),"settings.getSettings"))})},e.navigateCrossDomain=function(l){return wr(b(ye,m.Pages_NavigateCrossDomain),l)},e.navigateToApp=function(l){return new Promise(function(c){if(f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage),!r())throw k;var g=b(ye,m.Pages_NavigateCrossDomain);c(i.isLegacyTeams?_t(g,"executeDeepLink",function(e){var t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}(l)):_t(g,"pages.navigateToApp",l))})},e.shareDeepLink=function(l){return Er(b(ye,m.Pages_ShareDeepLink),l)},e.registerFullScreenHandler=function(l){ct(b(ye,m.Pages_RegisterFullScreenHandler),"fullScreenChange",l,[],function(){if(!Te(l)&&!r())throw k})},e.isSupported=r,(l=e.tabs||(e.tabs={})).navigateToTab=function(c){return _r(b(ye,m.Pages_Tabs_NavigateToTab),c)},l.getTabInstances=function(c){return Ir(b(ye,m.Pages_Tabs_GetTabInstances),c)},l.getMruTabInstances=function(c){return Pr(b(ye,m.Pages_Tabs_GetMruTabInstances),c)},l.isSupported=function(){return!(!f(i)||!i.supports.pages||!i.supports.pages.tabs)},function(l){var c,g;function v(F,oe){!Te(F)&&f(i,s.settings),oe&&oe(),c=F,!Te(F)&&ie(b(ye,m.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function D(F,oe){!Te(F)&&f(i,s.remove,s.settings),oe&&oe(),g=F,!Te(F)&&ie(b(ye,m.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function ne(F){var oe=new L(F);c?c(oe):A.childWindow?gt("settings.save",[F]):oe.notifySuccess()}l.initialize=function(){Y("settings.save",ne,!1),Y("settings.remove",C,!1)},l.setValidityState=function(F){if(f(i,s.settings,s.remove),!W())throw k;ie(b(ye,m.Pages_Config_SetValidityState),"settings.setValidityState",[F])},l.setConfig=function(F){return new Promise(function(oe){if(f(i,s.content,s.settings,s.sidePanel),!W())throw k;oe(_t(b(ye,m.Pages_Config_SetConfig),"settings.setSettings",F))})},l.registerOnSaveHandler=function(F){v(F,function(){if(!Te(F)&&!W())throw k})},l.registerOnSaveHandlerHelper=v,l.registerOnRemoveHandler=function(F){D(F,function(){if(!Te(F)&&!W())throw k})},l.registerOnRemoveHandlerHelper=D,l.registerChangeConfigHandler=function(F){ct(b(ye,m.Pages_Config_RegisterChangeConfigHandler),"changeSettings",F,[s.content],function(){if(!W())throw k})};var L=function(){function F(me){this.notified=!1,this.result=me||{}}var oe=F.prototype;return oe.notifySuccess=function(){this.ensureNotNotified(),ie(b(ye,m.Settings_Save_Success),"settings.save.success"),this.notified=!0},oe.notifyFailure=function(rt){this.ensureNotNotified(),ie(b(ye,m.Settings_Save_Failure),"settings.save.failure",[rt]),this.notified=!0},oe.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},F}();function C(){var F=new B;g?g(F):A.childWindow?gt("settings.remove",[]):F.notifySuccess()}var B=function(){function F(){this.notified=!1}var oe=F.prototype;return oe.notifySuccess=function(){this.ensureNotNotified(),ie(b(ye,m.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},oe.notifyFailure=function(rt){this.ensureNotNotified(),ie(b(ye,m.Settings_Remove_Failure),"settings.remove.failure",[rt]),this.notified=!0},oe.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},F}();function W(){return!(!f(i)||!i.supports.pages||!i.supports.pages.config)}l.isSupported=W}(e.config||(e.config={})),function(l){var c;function g(){return Cr(b(ye,m.Pages_BackStack_NavigateBack))}function v(L,C,B){!Te(C)&&f(i),B&&B(),c=C,!Te(C)&&ie(L,"registerHandler",["backButton"])}function D(){c&&c()||(A.childWindow?gt("backButtonPress",[]):g())}function ne(){return!(!f(i)||!i.supports.pages||!i.supports.pages.backStack)}l._initialize=function(){Y("backButtonPress",D,!1)},l.navigateBack=g,l.registerBackButtonHandler=function(L){v(b(ye,m.Pages_BackStack_RegisterBackButtonHandler),L,function(){if(!Te(L)&&!ne())throw k})},l.registerBackButtonHandlerHelper=v,l.isSupported=ne}(e.backStack||(e.backStack={})),function(l){function c(){return!(!f(i)||!i.supports.pages||!i.supports.pages.fullTrust)}l.enterFullscreen=function(){if(f(i,s.content),!c())throw k;ie(b(ye,m.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},l.exitFullscreen=function(){if(f(i,s.content),!c())throw k;ie(b(ye,m.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},l.isSupported=c}(e.fullTrust||(e.fullTrust={})),function(l){function c(){return!(!f(i)||!i.supports.pages||!i.supports.pages.appButton)}l.onClick=function(g){ct(b(ye,m.Pages_AppButton_OnClick),"appButtonClick",g,[s.content],function(){if(!c())throw k})},l.onHoverEnter=function(g){ct(b(ye,m.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",g,[s.content],function(){if(!c())throw k})},l.onHoverLeave=function(g){ct(b(ye,m.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",g,[s.content],function(){if(!c())throw k})},l.isSupported=c}(e.appButton||(e.appButton={})),function(l){function c(){return!(!f(i)||!i.supports.pages||!i.supports.pages.currentApp)}l.navigateTo=function(g){return new Promise(function(v){if(f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage),!c())throw k;v(Ge(b(ye,m.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",g))})},l.navigateToDefaultPage=function(){return new Promise(function(g){if(f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage),!c())throw k;g(Ge(b(ye,m.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},l.isSupported=c}(e.currentApp||(e.currentApp={}))}(Ve||(Ve={}));var fo=ee("handlers"),Ce=function(){function e(){}return e.initializeHandlers=function(){e.handlers.themeChange=vo,e.handlers.load=yo,e.handlers.beforeUnload=Co,Ve.backStack._initialize()},e.uninitializeHandlers=function(){e.handlers={},e.themeChangeHandler=null,e.loadHandler=null,e.beforeUnloadHandler=null,e.beforeSuspendOrTerminateHandler=null,e.resumeHandler=null},e}();Ce.handlers={},Ce.themeChangeHandler=null,Ce.loadHandler=null,Ce.beforeUnloadHandler=null,Ce.beforeSuspendOrTerminateHandler=null,Ce.resumeHandler=null;var Tr=fo.extend("callHandler");function kr(e,t){var r=Ce.handlers[e];return r?(Tr("Invoking the registered handler for message %s with arguments %o",e,t),[!0,r.apply(this,t)]):A.childWindow?(gt(e,t),[!1,void 0]):(Tr("Handler for action message %s not found.",e),[!1,void 0])}function Y(e,t,r,o){void 0===r&&(r=!0),void 0===o&&(o=[]),t?(Ce.handlers[e]=t,r&&ie(b(Q.V_0,m.RegisterHandler),"registerHandler",[e].concat(o))):delete Ce.handlers[e]}function Ke(e){delete Ce.handlers[e]}function Or(e){return null!=Ce.handlers[e]}function ct(e,t,r,o,n){r&&f.apply(void 0,[i].concat(o)),n&&n(),Y(t,r)}function vo(e){Ce.themeChangeHandler&&Ce.themeChangeHandler(e),A.childWindow&&gt("themeChange",[e])}function yo(e){Ce.resumeHandler?Ce.resumeHandler(e):Ce.loadHandler&&Ce.loadHandler(e),A.childWindow&&gt("load",[e])}function Co(){var e=function(){j("readyToUnload",[])};Ce.beforeSuspendOrTerminateHandler?(Ce.beforeSuspendOrTerminateHandler(),A.childWindow?gt("beforeUnload"):e()):Ce.beforeUnloadHandler&&Ce.beforeUnloadHandler(e)||(A.childWindow?gt("beforeUnload"):e())}var bn=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})},Lt=ee("communication"),A=function(){},Fe=function(){};function Nt(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];return Ut(e,t,o).then(function(a){return a[0]})}function yn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return ft(e,r).then(function(n){return n[0]})}function _t(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];return Ut(e,t,o).then(function(a){if(!a[0])throw new Error(a[1])})}function St(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return ft(e,r).then(function(n){if(!n[0])throw new Error(n[1])})}function wn(e,t,r){for(var o=arguments.length,n=new Array(o>3?o-3:0),a=3;a<o;a++)n[a-3]=arguments[a];return Ut(e,t,n).then(function(d){if(!d[0])throw new Error(d[1]||r)})}function Ge(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];return Ut(e,t,o).then(function(a){var d=a[0];if(d)throw d;return a[1]})}function Ue(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return ft(e,r).then(function(n){var a=n[0];if(a)throw a;return n[1]})}function Ut(e,t,r){if(void 0===r&&(r=void 0),!pe(e))throw Error("apiVersionTag: "+e+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(o){o(Mr(Yt(e,t,r).id))})}function ft(e,t){return void 0===t&&(t=void 0),new Promise(function(r){r(Mr(Yt(b(Q.V_0,"testing"),e,t).id))})}function Mr(e){return new Promise(function(t){Fe.promiseCallbacks[e]=t})}function ie(e,t,r,o){var n;if(r instanceof Function?o=r:r instanceof Array&&(n=r),!pe(e))throw Error("apiVersionTag: "+e+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var a=Yt(e,t,n);o&&(Fe.callbacks[a.id]=o)}function j(e,t,r){var o;t instanceof Function?r=t:t instanceof Array&&(o=t);var n=Yt(b(Q.V_0,"testing"),e,o);r&&(Fe.callbacks[n.id]=r)}Fe.parentMessageQueue=[],Fe.childMessageQueue=[],Fe.nextMessageId=0,Fe.callbacks={},Fe.promiseCallbacks={};var Eo=Lt.extend("sendMessageToParentHelper");function Yt(e,t,r){var o=Eo,n=A.parentWindow,a=function(e,t,r){return{id:Fe.nextMessageId++,func:t,timestamp:Date.now(),args:r||[],apiversiontag:e}}(e,t,r);if(o("Message %i information: %o",a.id,{actionName:t,args:r}),U.isFramelessWindow)A.currentWindow&&A.currentWindow.nativeInterface&&(o("Sending message %i to parent via framelessPostMessage interface",a.id),A.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(a)));else{var d=en(n);n&&d?(o("Sending message %i to parent via postMessage",a.id),n.postMessage(a,d)):(o("Adding message %i to parent message queue",a.id),Xt(n).push(a))}return a}var Rr=Lt.extend("processMessage");function To(e){return bn(this,void 0,void 0,z().mark(function t(){var r,o;return z().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e&&e.data&&"object"==typeof e.data){a.next=2;break}return a.abrupt("return",void Rr("Unrecognized message format received by app, message being ignored. Message: %o",e));case 2:return a.abrupt("return",ko(r=e.source||e.originalEvent&&e.originalEvent.source,o=e.origin||e.originalEvent&&e.originalEvent.origin).then(function(d){d?(Oo(r,o),r===A.parentWindow?Fr(e):r===A.childWindow&&Ao(e)):Rr("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return a.stop()}},t)}))}var Ar=Lt.extend("shouldProcessMessage");function ko(e,t){return bn(this,void 0,void 0,z().mark(function r(){var o;return z().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!A.currentWindow||e!==A.currentWindow){a.next=2;break}return a.abrupt("return",(Ar("Should not process message because it is coming from the current window"),!1));case 2:if(!(A.currentWindow&&A.currentWindow.location&&t&&t===A.currentWindow.location.origin)){a.next=4;break}return a.abrupt("return",!0);case 4:return a.next=6,co(new URL(t));case 6:return a.abrupt("return",((o=a.sent)||Ar("Message has an invalid origin of %s",t),o));case 8:case"end":return a.stop()}},r)}))}function Oo(e,t){U.isFramelessWindow||A.parentWindow&&!A.parentWindow.closed&&e!==A.parentWindow?A.childWindow&&!A.childWindow.closed&&e!==A.childWindow||(A.childWindow=e,A.childOrigin=t):(A.parentWindow=e,A.parentOrigin=t),A.parentWindow&&A.parentWindow.closed&&(A.parentWindow=null,A.parentOrigin=null),A.childWindow&&A.childWindow.closed&&(A.childWindow=null,A.childOrigin=null),Dr(A.parentWindow),Dr(A.childWindow)}var Mo=Lt.extend("handleParentMessage");function Fr(e){var t=Mo;if("id"in e.data&&"number"==typeof e.data.id){var r=e.data,o=Fe.callbacks[r.id];t("Received a response from parent for message %i",r.id),o&&(t("Invoking the registered callback for message %i with arguments %o",r.id,r.args),o.apply(null,[].concat(r.args,[r.isPartialResponse])),function(e){return!0===e.data.isPartialResponse}(e)||(t("Removing registered callback for message %i",r.id),delete Fe.callbacks[r.id]));var n=Fe.promiseCallbacks[r.id];n&&(t("Invoking the registered promise callback for message %i with arguments %o",r.id,r.args),n(r.args),t("Removing registered promise callback for message %i",r.id),delete Fe.promiseCallbacks[r.id])}else if("func"in e.data&&"string"==typeof e.data.func){var a=e.data;t("Received an action message %s from parent",a.func),kr(a.func,a.args)}else t("Received an unknown message: %O",e)}function Ao(e){if("id"in e.data&&"func"in e.data){var t=e.data,r=kr(t.func,t.args),n=r[1];r[0]&&void 0!==n?Lr(t.id,Array.isArray(n)?n:[n]):j(t.func,t.args,function(){if(A.childWindow){for(var a=arguments.length,d=new Array(a),u=0;u<a;u++)d[u]=arguments[u];var p=d.pop();Lr(t.id,d,p)}})}}function Xt(e){return e===A.parentWindow?Fe.parentMessageQueue:e===A.childWindow?Fe.childMessageQueue:[]}function en(e){return e===A.parentWindow?A.parentOrigin:e===A.childWindow?A.childOrigin:null}var Cn,_n,Sn,In,Pn,Fo=Lt.extend("flushMessageQueue");function Dr(e){for(var t=en(e),r=Xt(e),o=e==A.parentWindow?"parent":"child";e&&t&&r.length>0;){var n=r.shift();Fo("Flushing message %i from "+o+" message queue via postMessage.",n?.id),e.postMessage(n,t)}}function xr(e,t){var r;r=A.currentWindow.setInterval(function(){0===Xt(e).length&&(clearInterval(r),t())},100)}function Lr(e,t,r){var o=A.childWindow,n=function(e,t,r){return{id:e,args:t||[],isPartialResponse:r}}(e,t,r),a=en(o);o&&a&&o.postMessage(n,a)}function gt(e,t){var r=A.childWindow,o=function(e,t){return{func:e,args:t||[]}}(e,t),n=en(r);r&&n?r.postMessage(o,n):Xt(r).push(o)}function No(e,t){f(i),j("uploadCustomApp",[e],t||Be())}function Uo(e,t,r){f(i),j(e,t,r)}function Bo(e,t){if(f(i),!A.childWindow)throw new Error("The child window has not yet been initialized or is not present");gt(e,t)}function Ho(e,t){var r=this;f(i),Y(e,function(){for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return t.apply(r,n)})}function zo(e,t){f(i),Y("userSettingsChange",t,!0,[e])}function Vo(e){f(i,s.content,s.task),j("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes])}(function(e){function t(){return!(!f(i)||!i.supports.logs)}e.registerGetLogHandler=function(r){if(!Te(r)&&f(i),!Te(r)&&!t())throw k;r?Y("log.request",function(){j("log.receive",[r()])}):Ke("log.request")},e.isSupported=t})(Cn||(Cn={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(_n||(_n={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Sn||(Sn={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(In||(In={})),function(e){function t(){return!(!f(i)||!i.supports.conversations)}e.openConversation=function(r){return new Promise(function(o){if(f(i,s.content),!t())throw k;var n=St("conversations.openConversation",{title:r.title,subEntityId:r.subEntityId,conversationId:r.conversationId,channelId:r.channelId,entityId:r.entityId});r.onStartConversation&&Y("startConversation",function(a,d,u,p){var l;return null===(l=r.onStartConversation)||void 0===l?void 0:l.call(r,{subEntityId:a,conversationId:d,channelId:u,entityId:p})}),r.onCloseConversation&&Y("closeConversation",function(a,d,u,p){var l;return null===(l=r.onCloseConversation)||void 0===l?void 0:l.call(r,{subEntityId:a,conversationId:d,channelId:u,entityId:p})}),o(n)})},e.closeConversation=function(){if(f(i,s.content),!t())throw k;j("conversations.closeConversation"),Ke("startConversation"),Ke("closeConversation")},e.getChatMembers=function(){return new Promise(function(r){if(f(i),!t())throw k;r(yn("getChatMembers"))})},e.isSupported=t}(Pn||(Pn={}));var En;function Ur(e,t,r){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");var o="users="+e.map(function(d){return encodeURIComponent(d)}).join(","),n=void 0===t?"":"&topicName="+encodeURIComponent(t),a=void 0===r?"":"&message="+encodeURIComponent(r);return xe+"://"+he+"/l/chat/0/0?"+o+n+a}!function(e){function t(){return!(!f(i)||!i.supports.appInstallDialog)}e.openAppInstallDialog=function(r){return new Promise(function(o){if(f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage),!t())throw new Error("Not supported");i.isLegacyTeams?o(St("executeDeepLink",function(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return xe+"://"+he+"/l/app/"+encodeURIComponent(e)}(r.appId))):(j("appInstallDialog.openAppInstallDialog",[r]),o())})},e.isSupported=t}(En||(En={}));var It,vt=Q.V_1,$o=ee("media");function Tn(e,t){if(null==e||null==t||e.length<=0)return null;var r=null,o=1;return e.sort(function(n,a){return n.sequence>a.sequence?1:-1}),e.forEach(function(n){n.sequence==o&&(r=r?new Blob([r,n.file],{type:t}):new Blob([n.file],{type:t}),o++)}),r}function kn(e,t){if(null==e||null==t)return null;for(var r=atob(e.chunk),o=new Array(r.length),n=0;n<r.length;n++)o[n]=r.charCodeAt(n);var a=new Uint8Array(o),d=new Blob([a],{type:t});return{sequence:e.chunkSequence,file:d}}function qo(e){!function(e){return!(!e||e.mediaType!=It.MediaType.VideoAndImage&&!e.videoAndImageProps)}(e)?function(e){return!(!e||e.mediaType!=It.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}(e)?Kt(Z):function(e){var t;return!(e?.mediaType!=It.MediaType.Image||null===(t=e?.imageProps)||void 0===t||!t.imageOutputFormats)}(e)&&Kt("2.0.4"):Kt("2.0.2")}function Br(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}!function(e){var r,a,v;(v=e.FileFormat||(e.FileFormat={})).Base64="base64",v.ID="id";var p=function(){};function l(){return!(!f(i)||!i.supports.permissions)}e.File=p,e.captureImage=function(v){if(!v)throw new Error("[captureImage] Callback cannot be null");f(i,s.content,s.task),U.isFramelessWindow?qe("1.7.0")?ie(b(vt,m.Media_CaptureImage),"captureImage",v):v({errorCode:y.OLD_PLATFORM},[]):v({errorCode:y.NOT_SUPPORTED_ON_PLATFORM},[])},e.hasPermission=function(){if(f(i,s.content,s.task),!l())throw k;var v=w.Media;return new Promise(function(D){D(Ge(b(vt,m.Media_HasPermission),"permissions.has",v))})},e.requestPermission=function(){if(f(i,s.content,s.task),!l())throw k;var v=w.Media;return new Promise(function(D){D(Ge(b(vt,m.Media_RequestPermission),"permissions.request",v))})};var c=function(v){function D(L){var C;return C=v.call(this)||this,L&&(C.content=L.content,C.format=L.format,C.mimeType=L.mimeType,C.name=L.name,C.preview=L.preview,C.size=L.size),C}S(D,v);var ne=D.prototype;return ne.getMedia=function(C){if(!C)throw new Error("[get Media] Callback cannot be null");f(i,s.content,s.task),qe(q)?function(e,t,r){return null!=e&&null!=t&&t==It.FileFormat.ID&&null!=r}(this.mimeType,this.format,this.content)?qe("2.0.0")?this.getMediaViaCallback(C):this.getMediaViaHandler(C):C({errorCode:y.INVALID_ARGUMENTS},new Blob):C({errorCode:y.OLD_PLATFORM},new Blob)},ne.getMediaViaCallback=function(C){var B={mediaMimeType:this.mimeType,assembleAttachment:[]},W=[this.content];ie(b(vt,m.Media_GetMedia),"getMedia",W,function(F){if(C)if(F&&F.error)C(F.error,new Blob);else if(F&&F.mediaChunk)if(F.mediaChunk.chunkSequence<=0){var oe=Tn(B.assembleAttachment,B.mediaMimeType);C(F.error,oe??new Blob)}else{var me=kn(F.mediaChunk,B.mediaMimeType);me?B.assembleAttachment.push(me):$o("Received a null assemble attachment for when decoding chunk sequence "+F.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else C({errorCode:y.INTERNAL_ERROR,message:"data received is null"},new Blob)})},ne.getMediaViaHandler=function(C){var B=it(),W={mediaMimeType:this.mimeType,assembleAttachment:[]},F=[B,this.content];this.content&&!Te(C)&&ie(b(vt,m.Media_GetMedia),"getMedia",F),Y("getMedia"+B,function(oe){if(C){var me=JSON.parse(oe);if(me.error)C(me.error,new Blob),Ke("getMedia"+B);else if(me.mediaChunk)if(me.mediaChunk.chunkSequence<=0){var rt=Tn(W.assembleAttachment,W.mediaMimeType);C(me.error,rt??new Blob),Ke("getMedia"+B)}else{var Xe=kn(me.mediaChunk,W.mediaMimeType);Xe&&W.assembleAttachment.push(Xe)}else C({errorCode:y.INTERNAL_ERROR,message:"data received is null"},new Blob),Ke("getMedia"+B)}})},D}(p);e.Media=c;var g=function(){function v(ne){this.controllerCallback=ne}var D=v.prototype;return D.notifyEventToHost=function(L,C){f(i,s.content,s.task);try{Kt(Z)}catch(W){return void(C&&C(W))}var B={mediaType:this.getMediaType(),mediaControllerEvent:L};ie(b(vt,m.Media_Controller),"media.controller",[B],function(W){C&&C(W)})},D.stop=function(L){this.notifyEventToHost(r.StopRecording,L)},v}();e.VideoController=function(v){function D(){return v.apply(this,arguments)||this}S(D,v);var ne=D.prototype;return ne.getMediaType=function(){return a.Video},ne.notifyEventToApp=function(C){if(this.controllerCallback)switch(C){case r.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},D}(g),function(v){v[v.StartRecording=1]="StartRecording",v[v.StopRecording=2]="StopRecording"}(r=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(v){v[v.Photo=1]="Photo",v[v.Document=2]="Document",v[v.Whiteboard=3]="Whiteboard",v[v.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(v){v[v.Camera=1]="Camera",v[v.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(v){v[v.Image=1]="Image",v[v.Video=2]="Video",v[v.VideoAndImage=3]="VideoAndImage",v[v.Audio=4]="Audio"}(a=e.MediaType||(e.MediaType={})),function(v){v[v.ID=1]="ID",v[v.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(v){v[v.IMAGE=1]="IMAGE",v[v.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(v,D){if(!D)throw new Error("[select Media] Callback cannot be null");if(f(i,s.content,s.task),qe(q)){try{qo(v)}catch(B){return void D(B,[])}if(function(e){return!(null==e||e.maxMediaCount>10)}(v)){var C=[v];ie(b(vt,m.Media_SelectMedia),"selectMedia",C,function(B,W,F){var oe,me;if(F)(function(e){return!(e.mediaType!=It.MediaType.Video||!e.videoProps||!e.videoProps.videoController)})(v)&&(null===(me=null===(oe=v?.videoProps)||void 0===oe?void 0:oe.videoController)||void 0===me||me.notifyEventToApp(F));else if(W){for(var ro,rt=[],Xe=$(W);!(ro=Xe()).done;)rt.push(new c(ro.value));D(B,rt)}else D(B,[])})}else D({errorCode:y.INVALID_ARGUMENTS},[])}else D({errorCode:y.OLD_PLATFORM},[])},e.viewImages=function(v,D){if(!D)throw new Error("[view images] Callback cannot be null");if(f(i,s.content,s.task),qe(q))if(function(e){return!(null==e||e.length<=0||e.length>10)}(v)){var ne=[v];ie(b(vt,m.Media_ViewImages),"viewImages",ne,D)}else D({errorCode:y.INVALID_ARGUMENTS});else D({errorCode:y.OLD_PLATFORM})},e.scanBarCode=function(v,D){if(!v)throw new Error("[media.scanBarCode] Callback cannot be null");f(i,s.content,s.task),U.hostClientType!==I.desktop&&U.hostClientType!==I.web&&U.hostClientType!==I.rigel&&U.hostClientType!==I.teamsRoomsWindows&&U.hostClientType!==I.teamsRoomsAndroid&&U.hostClientType!==I.teamsPhones&&U.hostClientType!==I.teamsDisplays?qe("1.9.0")?Br(D)?ie(b(vt,m.Media_ScanBarCode),"media.scanBarCode",[D],v):v({errorCode:y.INVALID_ARGUMENTS},""):v({errorCode:y.OLD_PLATFORM},""):v({errorCode:y.NOT_SUPPORTED_ON_PLATFORM},"")}}(It||(It={}));var Mn,Rn,On=Q.V_2;(function(e){function t(){return!!(f(i)&&i.supports.barCode&&i.supports.permissions)}e.scanBarCode=function(r){return new Promise(function(o){if(f(i,s.content,s.task),!t())throw k;if(!Br(r))throw{errorCode:y.INVALID_ARGUMENTS};o(Ge(b(On,m.BarCode_ScanBarCode),"media.scanBarCode",r))})},e.hasPermission=function(){if(f(i,s.content,s.task),!t())throw k;var r=w.Media;return new Promise(function(o){o(Ge(b(On,m.BarCode_HasPermission),"permissions.has",r))})},e.requestPermission=function(){if(f(i,s.content,s.task),!t())throw k;var r=w.Media;return new Promise(function(o){o(Ge(b(On,m.BarCode_RequestPermission),"permissions.request",r))})},e.isSupported=t})(Mn||(Mn={})),function(e){function t(o){return new Promise(function(n){if(f(i,s.content,s.task),!r())throw k;n(i.isLegacyTeams?St("executeDeepLink",Ur([o.user],void 0,o.message)):St("chat.openChat",{members:[o.user],message:o.message}))})}function r(){return!(!f(i)||!i.supports.chat)}e.openChat=t,e.openGroupChat=function(o){return new Promise(function(n){if(o.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===o.users.length)n(t({user:o.users[0],message:o.message}));else{if(f(i,s.content,s.task),!r())throw k;n(i.isLegacyTeams?St("executeDeepLink",Ur(o.users,o.topic,o.message)):St("chat.openChat",{members:o.users,message:o.message,topic:o.topic}))}})},e.isSupported=r}(Rn||(Rn={}));var An,Hr=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})},zr=Q.V_2;!function(e){function t(){return!!(f(i)&&navigator&&navigator.clipboard&&i.supports.clipboard)}e.write=function(r){return Hr(this,void 0,void 0,z().mark(function o(){var a;return z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(f(i,s.content,s.meetingStage,s.task,s.settings,s.stage,s.sidePanel),t()){u.next=2;break}throw k;case 2:if(r.type&&Object.values(T).includes(r.type)){u.next=4;break}throw new Error("Blob type "+r.type+" is not supported. Supported blob types are "+Object.values(T));case 4:return u.next=6,un(r);case 6:return a={mimeType:r.type,content:u.sent},u.abrupt("return",Ge(b(zr,m.Clipboard_Write),"clipboard.writeToClipboard",a));case 9:case"end":return u.stop()}},o)}))},e.read=function(){return Hr(this,void 0,void 0,z().mark(function r(){var o;return z().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(f(i,s.content,s.meetingStage,s.task,s.settings,s.stage,s.sidePanel),t()){a.next=2;break}throw k;case 2:if(!Mt()&&U.hostClientType!==I.macos){a.next=9;break}return a.t0=JSON,a.next=6,Ue("clipboard.readFromClipboard");case 6:return a.t1=a.sent,o=a.t0.parse.call(a.t0,a.t1),a.abrupt("return",ln(o.mimeType,o.content));case 9:return a.abrupt("return",Ge(b(zr,m.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return a.stop()}},r)}))},e.isSupported=t}(An||(An={}));var Fn,Dn,Bt=Q.V_2;function ni(){return i.hostVersionsInfo?i.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function t(){return!!(f(i)&&i.supports.geoLocation&&i.supports.permissions)}e.getCurrentLocation=function(){if(f(i,s.content,s.task),!t())throw k;return Ge(b(Bt,m.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(f(i,s.content,s.task),!t())throw k;var o=w.GeoLocation;return new Promise(function(n){n(Ge(b(Bt,m.GeoLocation_HasPermission),"permissions.has",o))})},e.requestPermission=function(){if(f(i,s.content,s.task),!t())throw k;var o=w.GeoLocation;return new Promise(function(n){n(Ge(b(Bt,m.GeoLocation_RequestPermission),"permissions.request",o))})},e.isSupported=t,function(o){function n(){return!!(f(i)&&i.supports.geoLocation&&i.supports.geoLocation.map&&i.supports.permissions)}o.chooseLocation=function(){if(f(i,s.content,s.task),!n())throw k;return Ge(b(Bt,m.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},o.showLocation=function(a){if(f(i,s.content,s.task),!n())throw k;if(!a)throw{errorCode:y.INVALID_ARGUMENTS};return Ge(b(Bt,m.GeoLocation_ShowLocation),"location.showLocation",a)},o.isSupported=n}(e.map||(e.map={}))}(Fn||(Fn={}));var Vr=function(){function e(){}var t=e.prototype;return t.postMessage=function(o,n){f(i),j("messageForChild",[o],n||Be())},t.addEventListener=function(o,n){f(i),"message"===o&&Y("messageForParent",n)},e}(),ri=function(){function e(){}var t=e.prototype;return t.postMessage=function(o,n){f(i,s.task),j("messageForParent",[o],n||Be())},t.addEventListener=function(o,n){f(i,s.task),"message"===o&&Y("messageForChild",n)},fe(e,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();!function(e){function t(){return!(!f(i)||!i.supports.secondaryBrowser)}e.open=function(r){if(f(i,s.content),!t())throw k;if(!r||!$t(r))throw{errorCode:y.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Ue("secondaryBrowser.open",r.toString())},e.isSupported=t}(Dn||(Dn={}));var xn,jr=Q.V_1;!function(e){function t(){return!(!f(i)||!i.supports.location)}e.getLocation=function(r,o){if(!o)throw new Error("[location.getLocation] Callback cannot be null");if(f(i,s.content,s.task),!qe(X))throw{errorCode:y.OLD_PLATFORM};if(!r)throw{errorCode:y.INVALID_ARGUMENTS};if(!t())throw k;ie(b(jr,m.Location_GetLocation),"location.getLocation",[r],o)},e.showLocation=function(r,o){if(!o)throw new Error("[location.showLocation] Callback cannot be null");if(f(i,s.content,s.task),!qe(X))throw{errorCode:y.OLD_PLATFORM};if(!r)throw{errorCode:y.INVALID_ARGUMENTS};if(!t())throw k;ie(b(jr,m.Location_ShowLocation),"location.showLocation",[r],o)},e.isSupported=t}(xn||(xn={}));var Ln,Nn,oi=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})};(function(e){var t,a,c;function l(c,g){f(i,s.sidePanel,s.meetingStage),j("meeting.updateMicState",[c,g])}(c=t||(t={}))[c.HostInitiated=0]="HostInitiated",c[c.AppInitiated=1]="AppInitiated",c[c.AppDeclinedToChange=2]="AppDeclinedToChange",c[c.AppFailedToChange=3]="AppFailedToChange",function(c){c.like="like",c.heart="heart",c.laugh="laugh",c.surprised="surprised",c.applause="applause"}(e.MeetingReactionType||(e.MeetingReactionType={})),function(c){c.Unknown="Unknown",c.Adhoc="Adhoc",c.Scheduled="Scheduled",c.Recurring="Recurring",c.Broadcast="Broadcast",c.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(c){c.OneOnOneCall="oneOnOneCall",c.GroupCall="groupCall"}(e.CallType||(e.CallType={})),function(c){c.Collaborative="Collaborative",c.ScreenShare="ScreenShare"}(a=e.SharingProtocol||(e.SharingProtocol={})),e.getIncomingClientAudioState=function(c){if(!c)throw new Error("[get incoming client audio state] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("getIncomingClientAudioState",c)},e.toggleIncomingClientAudio=function(c){if(!c)throw new Error("[toggle incoming client audio] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("toggleIncomingClientAudio",c)},e.getMeetingDetails=function(c){if(!c)throw new Error("[get meeting details] Callback cannot be null");f(i,s.sidePanel,s.meetingStage,s.settings,s.content),j("meeting.getMeetingDetails",c)},e.getAuthenticationTokenForAnonymousUser=function(c){if(!c)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");f(i,s.sidePanel,s.meetingStage,s.task),j("meeting.getAuthenticationTokenForAnonymousUser",c)},e.getLiveStreamState=function(c){if(!c)throw new Error("[get live stream state] Callback cannot be null");f(i,s.sidePanel),j("meeting.getLiveStreamState",c)},e.requestStartLiveStreaming=function(c,g,v){if(!c)throw new Error("[request start live streaming] Callback cannot be null");f(i,s.sidePanel),j("meeting.requestStartLiveStreaming",[g,v],c)},e.requestStopLiveStreaming=function(c){if(!c)throw new Error("[request stop live streaming] Callback cannot be null");f(i,s.sidePanel),j("meeting.requestStopLiveStreaming",c)},e.registerLiveStreamChangedHandler=function(c){if(!c)throw new Error("[register live stream changed handler] Handler cannot be null");f(i,s.sidePanel),Y("meeting.liveStreamChanged",c)},e.shareAppContentToStage=function(c,g,v){if(void 0===v&&(v={sharingProtocol:a.Collaborative}),!c)throw new Error("[share app content to stage] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("meeting.shareAppContentToStage",[g,v],c)},e.getAppContentStageSharingCapabilities=function(c){if(!c)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("meeting.getAppContentStageSharingCapabilities",c)},e.stopSharingAppContentToStage=function(c){if(!c)throw new Error("[stop sharing app content to stage] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("meeting.stopSharingAppContentToStage",c)},e.getAppContentStageSharingState=function(c){if(!c)throw new Error("[get app content stage sharing state] Callback cannot be null");f(i,s.sidePanel,s.meetingStage),j("meeting.getAppContentStageSharingState",c)},e.registerSpeakingStateChangeHandler=function(c){if(!c)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");f(i,s.sidePanel,s.meetingStage),Y("meeting.speakingStateChanged",c)},e.registerRaiseHandStateChangedHandler=function(c){if(!c)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");f(i,s.sidePanel,s.meetingStage),Y("meeting.raiseHandStateChanged",c)},e.registerMeetingReactionReceivedHandler=function(c){if(!c)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");f(i,s.sidePanel,s.meetingStage),Y("meeting.meetingReactionReceived",c)},function(c){c.setOptions=function(g){f(i,s.sidePanel),g.contentUrl&&new URL(g.contentUrl),j("meeting.appShareButton.setOptions",[g])}}(e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(c,g){if(!g)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!c.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");f(i,s.sidePanel,s.meetingStage),c.isAppHandlingAudio?function(c,g){var v=this;j("meeting.requestAppAudioHandling",[c.isAppHandlingAudio],function(D,ne){if(D&&null!=ne)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(D)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+D.errorCode+" "+D.message);if("boolean"!=typeof ne)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Y("meeting.micStateChanged",function(L){return oi(v,void 0,void 0,z().mark(function C(){var B;return z().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,F.next=3,c.micMuteStateChangedCallback(L);case 3:l(B=F.sent,B.isMicMuted===L.isMicMuted?t.HostInitiated:t.AppDeclinedToChange),F.next=10;break;case 7:F.prev=7,F.t0=F.catch(0),l(L,t.AppFailedToChange);case 10:case"end":return F.stop()}},C,null,[[0,7]])}))}),Y("meeting.audioDeviceSelectionChanged",function(L){var C;null===(C=c.audioDeviceSelectionChangedCallback)||void 0===C||C.call(c,L)}),g(ne)})}(c,g):function(c,g){j("meeting.requestAppAudioHandling",[c.isAppHandlingAudio],function(v,D){if(v&&null!=D)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(v)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+v.errorCode+" "+v.message);if("boolean"!=typeof D)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Or("meeting.micStateChanged")&&Ke("meeting.micStateChanged"),Or("meeting.audioDeviceSelectionChanged")&&Ke("meeting.audioDeviceSelectionChanged"),g(D)})}(c,g)},e.updateMicState=function(c){l(c,t.AppInitiated)}})(Ln||(Ln={})),function(e){function t(){return!(!f(i)||!i.supports.monetization)}e.openPurchaseExperience=function(r,o){var n,a;return"function"==typeof r?(n=r,a=o):a=r,f(i,s.content),function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];var a=e.apply(void 0,o);return a.then(function(d){t&&t(null,d)}).catch(function(d){t&&t(d,null)}),a}(function(){return new Promise(function(d){if(!t())throw k;d(Ue("monetization.openPurchaseExperience",a))})},n)},e.isSupported=t}(Nn||(Nn={}));var Un,Gr=Q.V_2;!function(e){function t(){return!(!f(i)||!i.supports.calendar)}e.openCalendarItem=function(r){return new Promise(function(o){if(f(i,s.content),!t())throw new Error("Not supported");if(!r.itemId||!r.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");o(_t(b(Gr,m.Calendar_OpenCalendarItem),"calendar.openCalendarItem",r))})},e.composeMeeting=function(r){return new Promise(function(o){if(f(i,s.content),!t())throw new Error("Not supported");o(i.isLegacyTeams?St("executeDeepLink",function(e,t,r,o,n){var a=void 0===e?"":"attendees="+e.map(function(c){return encodeURIComponent(c)}).join(","),d=void 0===t?"":"&startTime="+encodeURIComponent(t),u=void 0===r?"":"&endTime="+encodeURIComponent(r),p=void 0===o?"":"&subject="+encodeURIComponent(o),l=void 0===n?"":"&content="+encodeURIComponent(n);return xe+"://"+he+"/l/meeting/new?"+a+d+u+p+l}(r.attendees,r.startTime,r.endTime,r.subject,r.content)):_t(b(Gr,m.Calendar_ComposeMeeting),"calendar.composeMeeting",r))})},e.isSupported=t}(Un||(Un={}));var Bn,kt,Hn,zn,Wr=Q.V_2;(function(e){function t(){return!(!f(i)||!i.supports.mail)}var o;e.openMailItem=function(o){return new Promise(function(n){if(f(i,s.content),!t())throw new Error("Not supported");if(!o.itemId||!o.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(_t(b(Wr,m.Mail_OpenMailItem),"mail.openMailItem",o))})},e.composeMail=function(o){return new Promise(function(n){if(f(i,s.content),!t())throw new Error("Not supported");n(_t(b(Wr,m.Mail_ComposeMail),"mail.composeMail",o))})},e.isSupported=t,(o=e.ComposeMailType||(e.ComposeMailType={})).New="new",o.Reply="reply",o.ReplyAll="replyAll",o.Forward="forward"})(Bn||(Bn={})),function(e){function t(){yt().print()}function r(a,d){!Te(a)&&f(i),!Te(a)&&d&&d(),function(e){Ce.loadHandler=e,!Te(e)&&ie(b(Q.V_2,m.RegisterHandler),"registerHandler",["load"])}(a)}function o(a,d){!Te(a)&&f(i),!Te(a)&&d&&d(),function(e){Ce.beforeUnloadHandler=e,!Te(e)&&ie(b(Q.V_2,m.RegisterHandler),"registerHandler",["beforeUnload"])}(a)}function n(){return!(!f(i)||!i.supports.teamsCore)}e.enablePrintCapability=function(){if(!U.printCapabilityEnabled){if(f(i),!n())throw k;U.printCapabilityEnabled=!0,document.addEventListener("keydown",function(a){(a.ctrlKey||a.metaKey)&&80===a.keyCode&&(t(),a.cancelBubble=!0,a.preventDefault(),a.stopImmediatePropagation())})}},e.print=t,e.registerOnLoadHandler=function(a){r(a,function(){if(!Te(a)&&!n())throw k})},e.registerOnLoadHandlerHelper=r,e.registerBeforeUnloadHandler=function(a){o(a,function(){if(!Te(a)&&!n())throw k})},e.registerBeforeUnloadHandlerHelper=o,e.isSupported=n}(kt||(kt={})),function(e){function t(o){return new Promise(function(n){if(!qe("2.0.0"))throw{errorCode:y.OLD_PLATFORM};if(!function(e){return!(e&&(e.title&&"string"!=typeof e.title||e.setSelected&&"object"!=typeof e.setSelected||e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel||e.singleSelect&&"boolean"!=typeof e.singleSelect))}(o))throw{errorCode:y.INVALID_ARGUMENTS};if(!r())throw k;n(Ue("people.selectPeople",o))})}function r(){return!(!f(i)||!i.supports.people)}e.selectPeople=function(o,n){var a,d,u;return f(i,s.content,s.task,s.settings),"function"==typeof o?(d=(a=[o,n])[0],u=a[1]):u=o,function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];var a=e.apply(void 0,o);return a.then(function(d){t&&t(void 0,d)}).catch(function(d){t&&t(d)}),a}(t,d,u)},e.isSupported=r}(Hn||(Hn={})),function(e){e.showProfile=function(t){return f(i,s.content),new Promise(function(r){var o=function(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?function(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(t);if(!o[0])throw{errorCode:y.INVALID_ARGUMENTS,message:o[1]};r(Ue("profile.showProfile",{modality:t.modality,persona:t.persona,triggerType:t.triggerType,targetRectangle:{x:t.targetElementBoundingRect.x,y:t.targetElementBoundingRect.y,width:t.targetElementBoundingRect.width,height:t.targetElementBoundingRect.height}}))})},e.isSupported=function(){return!(!f(i)||!i.supports.profile)}}(zn||(zn={}));var Rt,At=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})};function $r(e,t,r,o){var n,a;return At(this,void 0,void 0,z().mark(function d(){var u;return z().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u=Kr(),!at()&&(null===(a=null===(n=window.chrome)||void 0===n?void 0:n.webview)||void 0===a||a.registerTextureStream(e,u)),l.t0=Qr,l.next=5,qr(e,r,o);case 5:l.t1=l.sent,l.t2=new ci(r,t),l.t3=u.writable,(0,l.t0)(l.t1,l.t2,l.t3);case 9:case"end":return l.stop()}},d)}))}function si(e,t,r,o){var n,a;return At(this,void 0,void 0,z().mark(function d(){var u;return z().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return u=Kr(),!at()&&(null===(a=null===(n=window.chrome)||void 0===n?void 0:n.webview)||void 0===a||a.registerTextureStream(e,u)),l.t0=Qr,l.next=5,qr(e,r,o);case 5:l.t1=l.sent,l.t2=new ui(r,t),l.t3=u.writable,(0,l.t0)(l.t1,l.t2,l.t3);case 9:case"end":return l.stop()}},d)}))}function qr(e,t,r){return At(this,void 0,void 0,z().mark(function o(){var n,a;return z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!at()){u.next=2;break}throw k;case 2:return n=yt().chrome,u.prev=3,r?.reportGettingTextureStream(e),u.next=7,n.webview.getTextureStream(e);case 7:if(0!==(a=u.sent.getVideoTracks()).length){u.next=10;break}throw new Error("No video track in stream "+e);case 10:return u.abrupt("return",(r?.reportTextureStreamAcquired(),a[0]));case 13:throw u.prev=13,u.t0=u.catch(3),t("Failed to get video track from stream "+e+", error: "+u.t0),new Error("Internal error: can't get video track from stream "+e);case 16:case"end":return u.stop()}},o,null,[[3,13]])}))}function Kr(){if(at())throw k;var e=window.MediaStreamTrackGenerator;if(!e)throw k;return new e({kind:"video"})}function Qr(e,t,r){new(yt().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(r)}!function(e){e.TimestampIsNull="timestamp of the original video frame is null",e.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Rt||(Rt={}));var ci=function(t,r){var o=this;this.notifyError=t,this.videoFrameHandler=r,this.transform=function(n,a){return At(o,void 0,void 0,z().mark(function d(){var u,p,l;return z().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(null===(u=n.timestamp)){g.next=15;break}return g.prev=2,g.next=5,this.videoFrameHandler({videoFrame:n});case 5:p=g.sent,l=new VideoFrame(p,{timestamp:u}),a.enqueue(l),n.close(),p.close(),g.next=13;break;case 10:g.prev=10,g.t0=g.catch(2),n.close(),this.notifyError(g.t0);case 13:g.next=16;break;case 15:this.notifyError(Rt.TimestampIsNull);case 16:case"end":return g.stop()}},d,this,[[2,10]])}))}},di=function(){function e(t,r){if(this.headerBuffer=t,this.notifyError=r,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(t),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return fe(e,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),e}(),li=function(){function e(t,r){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var o=new Uint32Array(t),n=0,a=0;n<r;n++){var d=o[a++],u=o[a++],p=o[a++],l=new Uint8Array(t,u,p);this.metadataMap.set(d,l)}}return fe(e,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),e}(),ui=function(t,r){var o=this;this.notifyError=t,this.videoFrameHandler=r,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(n,a){return At(o,void 0,void 0,z().mark(function d(){var u,p,l,c,v,D,ne;return z().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(null===(u=n.timestamp)){C.next=22;break}return C.prev=2,C.next=5,this.extractVideoFrameAndMetadata(n);case 5:return l=(p=C.sent).videoFrame,v=(void 0===(c=p.metadata)?{}:c).audioInferenceResult,C.next=12,this.videoFrameHandler({videoFrame:l,audioInferenceResult:v});case 12:D=C.sent,ne=new VideoFrame(D,{timestamp:u}),a.enqueue(ne),l.close(),n.close(),D.close(),C.next=20;break;case 17:C.prev=17,C.t0=C.catch(2),n.close(),this.notifyError(C.t0);case 20:C.next=23;break;case 22:this.notifyError(Rt.TimestampIsNull);case 23:case"end":return C.stop()}},d,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(n){return At(o,void 0,void 0,z().mark(function a(){var d,u,p,l,c,g;return z().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!at()){D.next=2;break}throw k;case 2:if("NV12"===n.format){D.next=4;break}throw this.notifyError(Rt.UnsupportedVideoFramePixelFormat),new Error(Rt.UnsupportedVideoFramePixelFormat);case 4:return d={x:0,y:0,width:n.codedWidth,height:2},u=new ArrayBuffer(d.width*d.height*3/2),D.next=7,n.copyTo(u,{rect:d});case 7:return p=new di(u,this.notifyError),l={x:0,y:p.multiStreamHeaderRowOffset,width:n.codedWidth,height:n.codedHeight-p.multiStreamHeaderRowOffset},c=new ArrayBuffer(l.width*l.height*3/2),D.next=10,n.copyTo(c,{rect:l});case 10:return g=new li(c,p.multiStreamCount),D.abrupt("return",{videoFrame:new VideoFrame(n,{timestamp:n.timestamp,visibleRect:{x:0,y:p.frameRowOffset,width:p.frameWidth,height:p.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:g.audioInferenceResult}});case 12:case"end":return D.stop()}},a,this)}))},Y("video.mediaStream.audioInferenceDiscardStatusChange",function(n){o.shouldDiscardAudioInferenceResult=n.discardAudioInferenceResult})};function Zr(e,t){return function(r,o){t?.reportApplyingVideoEffect(r||"",o),e(r,o).then(function(){t?.reportVideoEffectChanged(r||"",o),j("video.videoEffectReadiness",[!0,r,void 0,o])}).catch(function(n){j("video.videoEffectReadiness",[!1,r,n in Pt.EffectFailureReason?n:Pt.EffectFailureReason.InitializationFailure,o])})}}var Ft=function(){function e(){}return e.setTimeout=function(r,o){var n=performance.now(),a=it();return e.setTimeoutCallbacks[a]={callback:r,timeoutInMs:o,startedAtInMs:n},a},e.clearTimeout=function(r){delete e.setTimeoutCallbacks[r]},e.setInterval=function(r,o){e.setTimeout(function n(){r(),e.setTimeout(n,o)},o)},e.tick=function(){var r=performance.now(),o=[];for(var n in e.setTimeoutCallbacks){var a=e.setTimeoutCallbacks[n];r-a.startedAtInMs>=a.timeoutInMs&&o.push(n)}for(var d=0,u=o;d<u.length;d++){var p=u[d];e.setTimeoutCallbacks[p].callback(),delete e.setTimeoutCallbacks[p]}},e}();Ft.setTimeoutCallbacks={};var Vn=function(){function e(r,o){this.reportStatisticsResult=o,this.sampleCount=0,this.distributionBins=new Uint32Array(r)}var t=e.prototype;return t.processStarts=function(o,n,a,d){Ft.tick(),this.suitableForThisSession(o,n,a,d)||this.reportAndResetSession(this.getStatistics(),o,d,n,a),this.start()},t.processEnds=function(){var o=performance.now()-this.frameProcessingStartedAt,n=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,o)));this.distributionBins[n]+=1,this.sampleCount+=1},t.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},t.start=function(){this.frameProcessingStartedAt=performance.now()},t.suitableForThisSession=function(o,n,a,d){return this.currentSession&&this.currentSession.effectId===o&&this.currentSession.effectParam===d&&this.currentSession.frameWidth===n&&this.currentSession.frameHeight===a},t.reportAndResetSession=function(o,n,a,d,u){var p=this;o&&this.reportStatisticsResult(o),this.resetCurrentSession(this.getNextTimeout(n,this.currentSession),n,a,d,u),this.timeoutId&&Ft.clearTimeout(this.timeoutId),this.timeoutId=Ft.setTimeout(function(){return p.reportAndResetSession(p.getStatistics(),n,a,d,u)}.bind(this),this.currentSession.timeoutInMs)},t.resetCurrentSession=function(o,n,a,d,u){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:o,effectId:n,effectParam:a,frameWidth:d,frameHeight:u},this.sampleCount=0,this.distributionBins.fill(0)},t.getNextTimeout=function(o,n){return n&&n.effectId===o?Math.min(e.maxSessionTimeoutInMs,2*n.timeoutInMs):e.initialSessionTimeoutInMs},e}();Vn.initialSessionTimeoutInMs=1e3,Vn.maxSessionTimeoutInMs=3e4;var tn=function(){function e(r){var o=this;this.reportPerformanceEvent=r,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Vn(e.distributionBinSize,function(n){return o.reportPerformanceEvent("video.performance.performanceDataGenerated",[n])})}var t=e.prototype;return t.startMonitorSlowFrameProcessing=function(){var o=this;Ft.setInterval(function(){if(0!==o.processedFrameCount){var n=o.frameProcessingTimeCost/o.processedFrameCount;n>o.frameProcessTimeLimit&&o.reportPerformanceEvent("video.performance.frameProcessingSlow",[n]),o.frameProcessingTimeCost=0,o.processedFrameCount=0}},e.calculateFPSInterval)},t.setFrameProcessTimeLimit=function(o){this.frameProcessTimeLimit=o},t.reportApplyingVideoEffect=function(o,n){var a,d;(null===(a=this.applyingEffect)||void 0===a?void 0:a.effectId)===o&&(null===(d=this.applyingEffect)||void 0===d?void 0:d.effectParam)===n||(this.applyingEffect={effectId:o,effectParam:n},this.appliedEffect=void 0)},t.reportVideoEffectChanged=function(o,n){void 0===this.applyingEffect||this.applyingEffect.effectId!==o&&this.applyingEffect.effectParam!==n||(this.appliedEffect={effectId:o,effectParam:n},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},t.reportStartFrameProcessing=function(o,n){Ft.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,o,n,this.appliedEffect.effectParam))},t.reportFrameProcessed=function(){var o;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(o=this.appliedEffect)||void 0===o?void 0:o.effectParam])))},t.reportGettingTextureStream=function(o){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=o},t.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var o=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,o])}},e}();tn.distributionBinSize=1e3,tn.calculateFPSInterval=1e3;var Pt,jn,Gn,Wn,Jr=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})};(function(e){var L,t=at()?void 0:new tn(j);function d(L){j("video.notifyError",[L])}function u(){return f(i)&&!!i.supports.video&&(!!i.supports.video.mediaStream||!!i.supports.video.sharedFrame)}function l(L,C){var B=this;return function(W){return Jr(B,void 0,void 0,z().mark(function F(){var oe,me;return z().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return oe=W.videoFrame,C?.reportStartFrameProcessing(oe.codedWidth,oe.codedHeight),Xe.next=4,L(W);case 4:return me=Xe.sent,Xe.abrupt("return",(C?.reportFrameProcessed(),me));case 6:case"end":return Xe.stop()}},F)}))}}function c(L,C){if(f(i,s.sidePanel),!u()||!ne())throw k;Y("video.newVideoFrame",function(B){if(B){var W=B.timestamp;t?.reportStartFrameProcessing(B.width,B.height),L(function(L){if("videoFrameBuffer"in L)return L;var C=L.data,B=function(t,r){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(o[n[a]]=t[n[a]])}return o}(L,["data"]);return Object.assign(Object.assign({},B),{videoFrameBuffer:C})}(B),function(){t?.reportFrameProcessed(),function(L){j("video.videoFrameProcessed",[L])}(W)},d)}},!1),j("video.registerForVideoFrame",[C])}function v(){var L;return f(i,s.sidePanel)&&function(){var L,C,B,W;return!(null===(C=null===(L=yt().chrome)||void 0===L?void 0:L.webview)||void 0===C||!C.getTextureStream||null===(W=null===(B=yt().chrome)||void 0===B?void 0:B.webview)||void 0===W||!W.registerTextureStream)}()&&!(null===(L=i.supports.video)||void 0===L||!L.mediaStream)}function ne(){var L;return f(i,s.sidePanel)&&!(null===(L=i.supports.video)||void 0===L||!L.sharedFrame)}(e.VideoFrameFormat||(e.VideoFrameFormat={})).NV12="NV12",(L=e.EffectChangeType||(e.EffectChangeType={})).EffectChanged="EffectChanged",L.EffectDisabled="EffectDisabled",function(L){L.InvalidEffectId="InvalidEffectId",L.InitializationFailure="InitializationFailure"}(e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(L){if(f(i,s.sidePanel),!u())throw k;if(!L.videoFrameHandler||!L.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Y("video.setFrameProcessTimeLimit",function(C){return t?.setFrameProcessTimeLimit(C.timeLimit)},!1),v())!function(L,C){var B=this;if(f(i,s.sidePanel),!u()||!v())throw k;Y("video.startVideoExtensibilityVideoStream",function(W){return Jr(B,void 0,void 0,z().mark(function F(){var oe,me;return z().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return oe=W.streamId,me=l(L,t),Xe.next=3,$r(oe,me,d,t);case 3:case"end":return Xe.stop()}},F)}))},!1),j("video.mediaStream.registerForVideoFrame",[C])}(L.videoFrameHandler,L.config);else{if(!ne())throw k;c(L.videoBufferHandler,L.config)}t?.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(L,C){if(f(i,s.sidePanel),!u())throw k;j("video.videoEffectChanged",[L,C])},e.registerForVideoEffect=function(L){if(f(i,s.sidePanel),!u())throw k;Y("video.effectParameterChange",Zr(L,t),!1),j("video.registerForVideoEffect")},e.isSupported=u})(Pt||(Pt={})),function(e){var t="search.queryChange",r="search.queryClose",o="search.queryExecute";function n(){return!(!f(i)||!i.supports.search)}e.registerHandlers=function(a,d,u){if(f(i,s.content),!n())throw k;Y(r,a),Y(o,d),u&&Y(t,u)},e.unregisterHandlers=function(){if(f(i,s.content),!n())throw k;j("search.unregister"),Ke(t),Ke(r),Ke(o)},e.isSupported=n,e.closeSearch=function(){return new Promise(function(a){if(f(i,s.content),!n())throw new Error("Not supported");a(St("search.closeSearch"))})}}(jn||(jn={})),function(e){function t(d){return new Promise(function(u){if(!a())throw k;u(Ue(e.SharingAPIMessages.shareWebContent,d))})}function a(){return!(!f(i)||!i.supports.sharing)}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(d,u){try{(function(d){if(!(d&&d.content&&d.content.length))throw{errorCode:y.INVALID_ARGUMENTS,message:"Shared content is missing"}})(d),function(d){if(d.content.some(function(p){return!p.type}))throw{errorCode:y.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(d.content.some(function(p){return p.type!==d.content[0].type}))throw{errorCode:y.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(d),function(d){if("URL"!==d.content[0].type)throw{errorCode:y.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(d.content.some(function(p){return!p.url}))throw{errorCode:y.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(d)}catch(p){return Dt(function(){return Promise.reject(p)},u)}return f(i,s.content,s.sidePanel,s.task,s.stage,s.meetingStage),Dt(t,u,d)},e.isSupported=a}(Gn||(Gn={})),function(e){var o;function r(){return!(!f(i)||!i.supports.stageView)}(o=e.StageViewOpenMode||(e.StageViewOpenMode={})).modal="modal",o.popout="popout",o.popoutWithChat="popoutWithChat",e.open=function(o){return new Promise(function(n){if(f(i,s.content),!r())throw k;if(!o)throw new Error("[stageView.open] Stage view params cannot be null");n(Ue("stageView.open",o))})},e.isSupported=r}(Wn||(Wn={}));var $n,qn,Yr=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})};(function(e){var o,n;(n=e.CameraRestriction||(e.CameraRestriction={}))[n.FrontOrRear=1]="FrontOrRear",n[n.FrontOnly=2]="FrontOnly",n[n.RearOnly=3]="RearOnly",function(n){n[n.Camera=1]="Camera",n[n.Gallery=2]="Gallery"}(e.Source||(e.Source={})),e.hasPermission=function(){if(f(i,s.content,s.task),!o.isSupported())throw k;return Ue("permissions.has",w.Media)},e.requestPermission=function(){if(f(i,s.content,s.task),!o.isSupported())throw k;return Ue("permissions.request",w.Media)},function(n){function a(){return!!(f(i)&&i.supports.visualMedia&&i.supports.visualMedia.image&&i.supports.permissions)}function d(){if(!a())throw k}function u(l){if(!l||l.maxVisualMediaCount>10||l.maxVisualMediaCount<1)throw Ee}function p(l,c){if(c.length>l)throw Vt}n.captureImages=function(l){return Yr(this,void 0,void 0,z().mark(function c(){var g;return z().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return f(i,s.content,s.task),d(),u(l),D.next=3,Ue("visualMedia.image.captureImages",l);case 3:return D.abrupt("return",(p(l.maxVisualMediaCount,g=D.sent),g));case 5:case"end":return D.stop()}},c)}))},n.retrieveImages=function(l){return Yr(this,void 0,void 0,z().mark(function c(){var g;return z().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return f(i,s.content,s.task),d(),u(l),D.next=3,Ue("visualMedia.image.retrieveImages",l);case 3:return D.abrupt("return",(p(l.maxVisualMediaCount,g=D.sent),g));case 5:case"end":return D.stop()}},c)}))},n.isSupported=a}(o=e.image||(e.image={}))})($n||($n={})),function(e){function t(){return!(!f(i)||!i.supports.webStorage)}e.isWebStorageClearedOnUserLogOut=function(){return f(i),t()},e.isSupported=t}(qn||(qn={}));var Kn,Qn,fi=Q.V_2;(function(e){var t,o;function r(){return!(!f(i)||!i.supports.call)}(o=t=e.CallModalities||(e.CallModalities={})).Unknown="unknown",o.Audio="audio",o.Video="video",o.VideoBasedScreenSharing="videoBasedScreenSharing",o.Data="data",e.startCall=function(o){var n=b(fi,m.Call_StartCall);return new Promise(function(a){var d;if(f(i,s.content,s.task),!r())throw k;if(!i.isLegacyTeams)return ie(n,"call.startCall",[o],a);a(Nt(n,"executeDeepLink",function(e,t,r){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");var o="users="+e.map(function(d){return encodeURIComponent(d)}).join(","),n=void 0===t?"":"&withVideo="+encodeURIComponent(t),a=void 0===r?"":"&source="+encodeURIComponent(r);return xe+"://"+he+"/l/call/0/0?"+o+n+a}(o.targets,null===(d=o.requestedModalities)||void 0===d?void 0:d.includes(t.Video),o.source)).then(function(u){if(!u)throw new Error("The call was not properly started");return u}))})},e.isSupported=r})(Kn||(Kn={})),function(e){e.Messages=pt.Messages,e.FailedReason=pt.FailedReason,e.ExpectedFailureReason=pt.ExpectedFailureReason,e.notifyAppLoaded=function(){pt.notifyAppLoaded()},e.notifySuccess=function(){pt.notifySuccess()},e.notifyFailure=function(t){pt.notifyFailure(t)},e.notifyExpectedFailure=function(t){pt.notifyExpectedFailure(t)}}(Qn||(Qn={}));var Zn,Xr=ee("thirdPartyCloudStorage");!function(e){var t=[],r={fileType:"",assembleAttachment:[]},o=!0,n=null;function a(u){if(n)if(u&&u.error)n([],u.error),n=null;else if(u&&u.fileChunk)try{o||0!==u.fileChunk.chunkSequence||(Xr("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),o=!0,n([],{errorCode:y.INTERNAL_ERROR,message:"error occurred while receiving data"}),t=[],n=null);var p=kn(u.fileChunk,u.fileType);if(p?r.assembleAttachment.push(p):(Xr("Received a null assemble attachment for when decoding chunk sequence "+u.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),n?n([],{errorCode:y.INTERNAL_ERROR,message:"error occurred while receiving data"}):n=null,t=[],n=null,o=!0),o=u.fileChunk.endOfFile,u.fileChunk.endOfFile){var l=Tn(r.assembleAttachment,r.fileType);if(l){var c=new File([l],u.fileName,{type:l.type});t.push(c)}u.isLastFile&&n&&(n(t,u.error),t=[],n=null,o=!0),r={fileType:"",assembleAttachment:[]}}}catch(g){n&&(n([],{errorCode:y.INTERNAL_ERROR,message:g}),t=[],n=null,o=!0)}else n([],{errorCode:y.INTERNAL_ERROR,message:"data received is null"}),t=[],n=null,o=!0}function d(){return!(!f(i)||!i.supports.thirdPartyCloudStorage)}e.getDragAndDropFiles=function(u,p){if(!p)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(u&&""!==u){if(f(i,s.content,s.task),!d())throw k;if(n)throw n=null,new Error("getDragAndDropFiles cannot be called twice");n=p,o=!0,j("thirdPartyCloudStorage.getDragAndDropFiles",[u],a)}else p([],{errorCode:y.INVALID_ARGUMENTS})},e.isSupported=d}(Zn||(Zn={}));var Qe=Q.V_1;function mi(e,t){hn(b(Qe,m.PublicAPIs_Initialize),t).then(function(){e&&e()})}function gi(){kt.enablePrintCapability()}function hi(){kt.print()}function vi(e){He(),ie(b(Qe,m.PublicAPIs_GetContext),"getContext",function(t){t.frameContext||(t.frameContext=U.frameContext),e(t)})}function bi(e){br(b(Qe,m.PublicAPIs_RegisterOnThemeChangeHandlerHelper),e)}function yi(e){ct(b(Qe,m.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",e,[])}function wi(e){ct(b(Qe,m.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",e,[s.content])}function Ci(e){ct(b(Qe,m.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",e,[s.content])}function _i(e){ct(b(Qe,m.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",e,[s.content])}function Si(e){Ve.backStack.registerBackButtonHandlerHelper(b(Qe,m.PublicAPIs_RegisterBackButtonHandler),e)}function Ii(e){kt.registerOnLoadHandlerHelper(e)}function Pi(e){kt.registerBeforeUnloadHandlerHelper(e)}function Ei(e){ct(b(Qe,m.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",e,[])}function Ti(e){ct(b(Qe,m.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",e,[s.content])}function ki(e,t){f(i),Ir(b(Qe,m.PublicAPIs_GetTabInstances),t).then(function(r){e(r)})}function Oi(e,t){f(i),Pr(b(Qe,m.PublicAPIs_GetMruTabInstances),t).then(function(r){e(r)})}function Mi(e){Er(b(Qe,m.PublicAPIs_ShareDeepLink),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function Ri(e,t){f(i,s.content,s.sidePanel,s.settings,s.task,s.stage,s.meetingStage);var r=t??Be();yr(b(Qe,m.PublicAPIs_ExecuteDeepLink),e).then(function(){r(!0)}).catch(function(o){r(!1,o.message)})}function Ai(e){vn(b(Qe,m.PublicAPIs_SetFrameContext),e)}function Fi(e,t,r){hn(b(Qe,m.PublicAPIs_Initialize),r).then(function(){return t&&t()}),vn(b(Qe,m.PublicAPIs_SetFrameContext),e)}var Jn,nn=Q.V_1;function Di(e){Sr(b(nn,m.Navigation_ReturnFocus),e)}function xi(e,t){f(i);var r=t??Be();_r(b(nn,m.Navigation_NavigateToTab),e).then(function(){r(!0)}).catch(function(o){r(!1,o.message)})}function Li(e,t){f(i,s.content,s.sidePanel,s.settings,s.remove,s.task,s.stage,s.meetingStage);var r=t??Be();wr(b(nn,m.Navigation_NavigateCrossDomain),e).then(function(){r(!0)}).catch(function(o){r(!1,o.message)})}function Ni(e){f(i);var t=e??Be();Cr(b(nn,m.Navigation_NavigateBack)).then(function(){t(!0)}).catch(function(r){t(!1,r.message)})}!function(e){e.setValidityState=function(t){Ve.config.setValidityState(t)},e.getSettings=function(t){f(i,s.content,s.settings,s.remove,s.sidePanel),Ve.getConfig().then(function(r){t(r)})},e.setSettings=function(t,r){f(i,s.content,s.settings,s.sidePanel);var o=r??Be();Ve.config.setConfig(t).then(function(){o(!0)}).catch(function(n){o(!1,n.message)})},e.registerOnSaveHandler=function(t){Ve.config.registerOnSaveHandlerHelper(t)},e.registerOnRemoveHandler=function(t){Ve.config.registerOnRemoveHandlerHelper(t)}}(Jn||(Jn={}));var Xn,rn,Yn=Q.V_1;(function(e){function o(n){return n.height=n.height?n.height:we.Small,n.width=n.width?n.width:we.Small,n}e.startTask=function(n,a){var d=b(Yn,m.Tasks_StartTask),u=a?function(p){var l,c;return a(null!==(l=p.err)&&void 0!==l?l:"",null!==(c=p.result)&&void 0!==c?c:"")}:void 0;return void 0===n.card&&void 0===n.url||n.card?(f(i,s.content,s.sidePanel,s.meetingStage),ie(d,"tasks.startTask",[n],a)):void 0!==n.completionBotId?gr(d,function(n){if(void 0===n.url||void 0===n.completionBotId)throw new Error("Both url "+n.url+" and completionBotId "+n.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:n.url,size:{height:n.height?n.height:we.Small,width:n.width?n.width:we.Small},title:n.title,fallbackUrl:n.fallbackUrl,completionBotId:n.completionBotId}}(n),u):mr(d,function(n){if(void 0===n.url)throw new Error("url property of taskInfo object can't be undefined");return{url:n.url,size:{height:n.height?n.height:we.Small,width:n.width?n.width:we.Small},title:n.title,fallbackUrl:n.fallbackUrl}}(n),u),new Vr},e.updateTask=function(n){var p=function(t,r){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(o[n[a]]=t[n[a]])}return o}(n=o(n),["width","height"]);if(Object.keys(p).length)throw new Error("resize requires a TaskInfo argument containing only width and height");fr(b(Yn,m.Tasks_UpdateTask),n)},e.submitTask=function(n,a){hr(b(Yn,m.Tasks_SubmitTask),n,a)},e.getDefaultSizeIfNotProvided=o})(Xn||(Xn={})),function(e){var o;(o=e.UserMeetingRole||(e.UserMeetingRole={})).guest="Guest",o.attendee="Attendee",o.presenter="Presenter",o.organizer="Organizer",function(o){o.added="Added",o.alreadyExists="AlreadyExists",o.conflict="Conflict",o.notFound="NotFound"}(e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!f(i,s.meetingStage,s.sidePanel)||!i.supports.interactive)}}(rn||(rn={}));var Bi=function(){function e(){}var t=e.prototype;return t.getFluidTenantInfo=function(){return bt(),new Promise(function(o){o(Ue("interactive.getFluidTenantInfo"))})},t.getFluidToken=function(o){return bt(),new Promise(function(n){n(Ue("interactive.getFluidToken",o))})},t.getFluidContainerId=function(){return bt(),new Promise(function(o){o(Ue("interactive.getFluidContainerId"))})},t.setFluidContainerId=function(o){return bt(),new Promise(function(n){n(Ue("interactive.setFluidContainerId",o))})},t.getNtpTime=function(){return bt(),new Promise(function(o){o(Ue("interactive.getNtpTime"))})},t.registerClientId=function(o){return bt(),new Promise(function(n){n(Ue("interactive.registerClientId",o))})},t.getClientRoles=function(o){return bt(),new Promise(function(n){n(Ue("interactive.getClientRoles",o))})},t.getClientInfo=function(o){return bt(),new Promise(function(n){n(Ue("interactive.getClientInfo",o))})},e.create=function(){return bt(),new e},e}();function bt(){if(!rn.isSupported())throw new Error("LiveShareHost Not supported")}var Hi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function on(e){try{return e.cartItems=eo(e.cartItems),e}catch{throw new Error("Error deserializing cart")}}function eo(e){return e.map(function(t){if(t.imageURL){var r=new URL(t.imageURL);t.imageURL=r}return t.accessories&&(t.accessories=eo(t.accessories)),t})}var ji=function e(t){try{return t.map(function(r){var o=r.imageURL,n=r.accessories,a=function(t,r){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(o[n[a]]=t[n[a]])}return o}(r,["imageURL","accessories"]),d=Object.assign({},a);return o&&(d.imageURL=o.href),n&&(d.accessories=e(n)),d})}catch{throw new Error("Error serializing cart items")}};function Wi(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(var r,t=$(e);!(r=t()).done;){var o=r.value;if(o.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");to(o)}}}function to(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");(function(e){if("number"!=typeof e||e<0)throw new Error("price "+e+" must be a number not less than 0");if(parseFloat(e.toFixed(3))!==e)throw new Error("price "+e+" must have at most 3 decimal places")})(e.price),function(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error("quantity "+e+" must be an integer greater than 0")}(e.quantity)}function er(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===("string"==typeof(t=e)&&Hi.test(t)))throw new Error("id must be a valid UUID")}var t}var sn,tr,nr,rr,or,ir,ar,an=Q.V_2;(function(e){var n;function o(){return!(!f(i)||!i.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},(n=e.Intent||(e.Intent={})).TACAdminUser="TACAdminUser",n.TeamsAdminUser="TeamsAdminUser",n.TeamsEndUser="TeamsEndUser",function(n){n.Open="Open",n.Processing="Processing",n.Processed="Processed",n.Closed="Closed",n.Error="Error"}(e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(f(i,s.content,s.task),!o())throw k;return Ge(b(an,m.Marketplace_GetCart),"marketplace.getCart",e.cartVersion).then(on)},e.addOrUpdateCartItems=function(n){if(f(i,s.content,s.task),!o())throw k;if(!n)throw new Error("addOrUpdateCartItemsParams must be provided");return er(n?.cartId),function(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(var r,t=$(e);!(r=t()).done;){var o=r.value;to(o),Wi(o.accessories)}}(n?.cartItems),Ge(b(an,m.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},n),{cartItems:ji(n.cartItems),cartVersion:e.cartVersion})).then(on)},e.removeCartItems=function(n){if(f(i,s.content,s.task),!o())throw k;if(!n)throw new Error("removeCartItemsParams must be provided");if(er(n?.cartId),!Array.isArray(n?.cartItemIds)||0===n?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return Ge(b(an,m.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},n),{cartVersion:e.cartVersion})).then(on)},e.updateCartStatus=function(n){if(f(i,s.content,s.task),!o())throw k;if(!n)throw new Error("updateCartStatusParams must be provided");return er(n?.cartId),function(e){if(!Object.values(sn.CartStatus).includes(e))throw new Error("cartStatus "+e+" is not valid")}(n?.cartStatus),Ge(b(an,m.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},n),{cartVersion:e.cartVersion})).then(on)},e.isSupported=o})(sn||(sn={})),function(e){var r,n,u,t="Action.Execute";function a(u){if(u.requestType===r.ActionExecuteInvokeRequest){if(u.type!==t)throw{errorCode:n.INTERNAL_ERROR,message:"Invalid action type "+u.type+'. Action type must be "'+t+'"'}}else if(u.requestType===r.QueryMessageExtensionRequest){if(u.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(u.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var c,l=$(u.parameters);!(c=l()).done;){var g=c.value;if(g.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(g.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function d(){return!(!f(i)||!i.supports.externalAppAuthentication)}(u=r=e.OriginalRequestType||(e.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",u.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(u){u.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",u.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(e.InvokeResponseType||(e.InvokeResponseType={})),function(u){u.INTERNAL_ERROR="INTERNAL_ERROR"}(n=e.InvokeErrorCode||(e.InvokeErrorCode={})),e.authenticateAndResendRequest=function(u,p,l){if(f(i,s.content),!d())throw k;return Et(u),a(l),ft("externalAppAuthentication.authenticateAndResendRequest",[u,l,p.url.href,p.width,p.height,p.isExternal]).then(function(c){var v=c[1];if(c[0]&&null!=v.responseType)return v;throw v})},e.authenticateWithSSO=function(u,p){if(f(i,s.content),!d())throw k;return Et(u),ft("externalAppAuthentication.authenticateWithSSO",[u,p.claims,p.silent]).then(function(l){if(!l[0])throw l[1]})},e.authenticateWithSSOAndResendRequest=function(u,p,l){if(f(i,s.content),!d())throw k;return Et(u),a(l),ft("externalAppAuthentication.authenticateWithSSOAndResendRequest",[u,l,p.claims,p.silent]).then(function(c){var v=c[1];if(c[0]&&null!=v.responseType)return v;throw v})},e.isSupported=d}(tr||(tr={})),function(e){var a;function n(){return!(!f(i)||!i.supports.externalAppCardActions)}(a=e.ActionOpenUrlType||(e.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",a.DeepLinkOther="DeepLinkOther",a.DeepLinkStageView="DeepLinkStageView",a.GenericUrl="GenericUrl",function(a){a.INTERNAL_ERROR="INTERNAL_ERROR",a.INVALID_LINK="INVALID_LINK",a.NOT_SUPPORTED="NOT_SUPPORTED"}(e.ActionOpenUrlErrorCode||(e.ActionOpenUrlErrorCode={})),function(a){a.INTERNAL_ERROR="INTERNAL_ERROR"}(e.ActionSubmitErrorCode||(e.ActionSubmitErrorCode={})),e.processActionSubmit=function(a,d){if(f(i,s.content),!n())throw k;return Et(a),ft("externalAppCardActions.processActionSubmit",[a,d]).then(function(u){if(!u[0])throw u[1]})},e.processActionOpenUrl=function(a,d){if(f(i,s.content),!n())throw k;return Et(a),ft("externalAppCardActions.processActionOpenUrl",[a,d.href]).then(function(u){var p=u[0];if(p)throw p;return u[1]})},e.isSupported=n}(nr||(nr={})),function(e){var p;function u(p,l){return{errorCode:p,message:l}}(p=e.CloudStorageProvider||(e.CloudStorageProvider={})).Dropbox="DROPBOX",p.Box="BOX",p.Sharefile="SHAREFILE",p.GoogleDrive="GOOGLEDRIVE",p.Egnyte="EGNYTE",p.SharePoint="SharePoint",function(p){p[p.Sharepoint=0]="Sharepoint",p[p.WopiIntegration=1]="WopiIntegration",p[p.Google=2]="Google",p[p.OneDrive=3]="OneDrive",p[p.Recent=4]="Recent",p[p.Aggregate=5]="Aggregate",p[p.FileSystem=6]="FileSystem",p[p.Search=7]="Search",p[p.AllFiles=8]="AllFiles",p[p.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(p){p.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(p){p.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(p){p.Downloaded="Downloaded",p.Downloading="Downloading",p.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(p){p.Download="DOWNLOAD",p.Upload="UPLOAD",p.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(p,l){if(f(i,s.content),!p||0===p.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!l)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");j("files.getCloudStorageFolders",[p],l)},e.addCloudStorageFolder=function(p,l){if(f(i,s.content),!p||0===p.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!l)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");j("files.addCloudStorageFolder",[p],l)},e.deleteCloudStorageFolder=function(p,l,c){if(f(i,s.content),!p)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!l)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!c)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");j("files.deleteCloudStorageFolder",[p,l],c)},e.getCloudStorageFolderContents=function(p,l,c){if(f(i,s.content),!p||!l)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!c)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in p&&!p.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");j("files.getCloudStorageFolderContents",[p,l],c)},e.openCloudStorageFile=function(p,l,c){if(f(i,s.content),!p||!l)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(p.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");j("files.openCloudStorageFile",[p,l,c])},e.getExternalProviders=function(p,l){if(void 0===p&&(p=!1),f(i,s.content),!l)throw new Error("[files.getExternalProviders] Callback cannot be null");j("files.getExternalProviders",[p],l)},e.copyMoveFiles=function(p,l,c,g,v,D){if(void 0===v&&(v=!1),f(i,s.content),!p||0===p.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!l)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!c)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!g)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!D)throw new Error("[files.copyMoveFiles] callback cannot be null");j("files.copyMoveFiles",[p,l,c,g,v],D)},e.getFileDownloads=function(p){if(f(i,s.content),!p)throw new Error("[files.getFileDownloads] Callback cannot be null");j("files.getFileDownloads",[],p)},e.openDownloadFolder=function(p,l){if(void 0===p&&(p=void 0),f(i,s.content),!l)throw new Error("[files.openDownloadFolder] Callback cannot be null");j("files.openDownloadFolder",[p],l)},e.addCloudStorageProvider=function(p){if(f(i,s.content),!p)throw u(y.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");j("files.addCloudStorageProvider",[],p)},e.removeCloudStorageProvider=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!p||!p.content)throw u(y.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");j("files.removeCloudStorageProvider",[p],l)},e.addCloudStorageProviderFile=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!p||!p.content)throw u(y.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");j("files.addCloudStorageProviderFile",[p],l)},e.renameCloudStorageProviderFile=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!p||!p.content)throw u(y.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");j("files.renameCloudStorageProviderFile",[p],l)},e.deleteCloudStorageProviderFile=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(p&&p.content&&p.content.itemList&&p.content.itemList.length>0))throw u(y.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");j("files.deleteCloudStorageProviderFile",[p],l)},e.downloadCloudStorageProviderFile=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(p&&p.content&&p.content.itemList&&p.content.itemList.length>0))throw u(y.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");j("files.downloadCloudStorageProviderFile",[p],l)},e.uploadCloudStorageProviderFile=function(p,l){if(f(i,s.content),!l)throw u(y.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(p&&p.content&&p.content.itemList&&p.content.itemList.length>0))throw u(y.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!p.content.destinationFolder)throw u(y.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");j("files.uploadCloudStorageProviderFile",[p],l)},e.registerCloudStorageProviderListChangeHandler=function(p){if(f(i),!p)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Y("files.cloudStorageProviderListChange",p)},e.registerCloudStorageProviderContentChangeHandler=function(p){if(f(i),!p)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Y("files.cloudStorageProviderContentChange",p)}}(rr||(rr={})),function(e){function t(){return!(!f(i)||!i.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise(function(r){if(f(i),!t())throw k;r(Ue("meetingRoom.getPairedMeetingRoomInfo"))})},e.sendCommandToPairedMeetingRoom=function(r){return new Promise(function(o){if(!r||0==r.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(f(i),!t())throw k;o(Ue("meetingRoom.sendCommandToPairedMeetingRoom",r))})},e.registerMeetingRoomCapabilitiesUpdateHandler=function(r){if(!r)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(f(i),!t())throw k;Y("meetingRoom.meetingRoomCapabilitiesUpdate",function(o){f(i),r(o)})},e.registerMeetingRoomStatesUpdateHandler=function(r){if(!r)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(f(i),!t())throw k;Y("meetingRoom.meetingRoomStatesUpdate",function(o){f(i),r(o)})},e.isSupported=t}(or||(or={})),function(e){function t(){return!(!f(i)||!i.supports.notifications)}e.showNotification=function(r){if(f(i,s.content),!t())throw k;j("notifications.showNotification",[r])},e.isSupported=t}(ir||(ir={})),function(e){var a;function n(){return!(!f(i)||!i.supports.remoteCamera)}(a=e.ControlCommand||(e.ControlCommand={})).Reset="Reset",a.ZoomIn="ZoomIn",a.ZoomOut="ZoomOut",a.PanLeft="PanLeft",a.PanRight="PanRight",a.TiltUp="TiltUp",a.TiltDown="TiltDown",function(a){a[a.CommandResetError=0]="CommandResetError",a[a.CommandZoomInError=1]="CommandZoomInError",a[a.CommandZoomOutError=2]="CommandZoomOutError",a[a.CommandPanLeftError=3]="CommandPanLeftError",a[a.CommandPanRightError=4]="CommandPanRightError",a[a.CommandTiltUpError=5]="CommandTiltUpError",a[a.CommandTiltDownError=6]="CommandTiltDownError",a[a.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(a){a[a.None=0]="None",a[a.ControlDenied=1]="ControlDenied",a[a.ControlNoResponse=2]="ControlNoResponse",a[a.ControlBusy=3]="ControlBusy",a[a.AckTimeout=4]="AckTimeout",a[a.ControlTerminated=5]="ControlTerminated",a[a.ControllerTerminated=6]="ControllerTerminated",a[a.DataChannelError=7]="DataChannelError",a[a.ControllerCancelled=8]="ControllerCancelled",a[a.ControlDisabled=9]="ControlDisabled",a[a.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(a){if(!a)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(f(i,s.sidePanel),!n())throw k;j("remoteCamera.getCapableParticipants",a)},e.requestControl=function(a,d){if(!a)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!d)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(f(i,s.sidePanel),!n())throw k;j("remoteCamera.requestControl",[a],d)},e.sendControlCommand=function(a,d){if(!a)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!d)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(f(i,s.sidePanel),!n())throw k;j("remoteCamera.sendControlCommand",[a],d)},e.terminateSession=function(a){if(!a)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(f(i,s.sidePanel),!n())throw k;j("remoteCamera.terminateSession",a)},e.registerOnCapableParticipantsChangeHandler=function(a){if(!a)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(f(i,s.sidePanel),!n())throw k;Y("remoteCamera.capableParticipantsChange",a)},e.registerOnErrorHandler=function(a){if(!a)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(f(i,s.sidePanel),!n())throw k;Y("remoteCamera.handlerError",a)},e.registerOnDeviceStateChangeHandler=function(a){if(!a)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(f(i,s.sidePanel),!n())throw k;Y("remoteCamera.deviceStateChange",a)},e.registerOnSessionStatusChangeHandler=function(a){if(!a)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(f(i,s.sidePanel),!n())throw k;Y("remoteCamera.sessionStatusChange",a)},e.isSupported=n}(ar||(ar={}));var sr,cr,Qi=Q.V_1;(function(e){function t(){return!(!f(i)||!i.supports.appEntity)}e.selectAppEntity=function(r,o,n,a){if(f(i,s.content),!t())throw k;if(!r||0==r.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!a)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");ie(b(Qi,m.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[r,o,n],a)},e.isSupported=t})(sr||(sr={})),function(e){var n;function o(){return!(!f(i)||!i.supports.teams)}(n=e.ChannelType||(e.ChannelType={}))[n.Regular=0]="Regular",n[n.Private=1]="Private",n[n.Shared=2]="Shared",e.getTeamChannels=function(n,a){if(f(i,s.content),!o())throw k;if(!n)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!a)throw new Error("[teams.getTeamChannels] Callback cannot be null");j("teams.getTeamChannels",[n],a)},e.refreshSiteUrl=function(n,a){if(f(i),!o())throw k;if(!n)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!a)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");j("teams.refreshSiteUrl",[n],a)},e.isSupported=o,function(n){function d(){return!(!f(i)||!i.supports.teams||!i.supports.teams.fullTrust)}(function(u){function p(){return!!(f(i)&&i.supports.teams&&i.supports.teams.fullTrust&&i.supports.teams.fullTrust.joinedTeams)}u.getUserJoinedTeams=function(l){return new Promise(function(c){if(f(i),!p())throw k;if((U.hostClientType===I.android||U.hostClientType===I.teamsRoomsAndroid||U.hostClientType===I.teamsPhones||U.hostClientType===I.teamsDisplays)&&!qe("2.0.1"))throw new Error(JSON.stringify({errorCode:y.OLD_PLATFORM}));c(yn("getUserJoinedTeams",l))})},u.isSupported=p})(n.joinedTeams||(n.joinedTeams={})),n.getConfigSetting=function(u){return new Promise(function(p){if(f(i),!d())throw k;p(yn("getConfigSetting",u))})},n.isSupported=d}(e.fullTrust||(e.fullTrust={}))}(cr||(cr={}));var dr,no=function(t,r,o,n){return new(o||(o=Promise))(function(d,u){function p(g){try{c(n.next(g))}catch(v){u(v)}}function l(g){try{c(n.throw(g))}catch(v){u(v)}}function c(g){g.done?d(g.value):function(d){return d instanceof o?d:new o(function(u){u(d)})}(g.value).then(p,l)}c((n=n.apply(t,r||[])).next())})};!function(e){e.frameProcessingTimeoutInMs=2e3;var r,l,t=at()?void 0:new tn(j);function o(){var l=setTimeout(function(){p("Frame not processed in "+e.frameProcessingTimeoutInMs+"ms",r.Warn)},e.frameProcessingTimeoutInMs);return function(){clearTimeout(l)}}function n(l,c){var g=this;return function(v){return no(g,void 0,void 0,z().mark(function D(){var ne,L,C;return z().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return c.reportStartFrameProcessing((ne=v.videoFrame).codedWidth,ne.codedHeight),L=o(),W.next=5,l(v);case 5:return C=W.sent,W.abrupt("return",(L(),c.reportFrameProcessed(),C));case 7:case"end":return W.stop()}},D)}))}}function d(){return f(i),Pt.isSupported()}function p(l,c){void 0===c&&(c=r.Warn),j("video.notifyError",[l,c])}(l=r=e.ErrorLevel||(e.ErrorLevel={})).Fatal="fatal",l.Warn="warn",e.registerForVideoFrame=function(l){var g,v,c=this;if(!d())throw k;if(!l.videoFrameHandler||!l.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(f(i,s.sidePanel)){if(Y("video.setFrameProcessTimeLimit",function(D){return t?.setFrameProcessTimeLimit(D)},!1),null===(g=i.supports.video)||void 0===g?void 0:g.mediaStream)Y("video.startVideoExtensibilityVideoStream",function(D){return no(c,void 0,void 0,z().mark(function ne(){var L,C,B;return z().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(L=D.streamId,C=D.metadataInTexture,B=t?n(l.videoFrameHandler,t):l.videoFrameHandler,!C){F.next=6;break}return F.next=4,si(L,B,p,t);case 4:F.next=8;break;case 6:return F.next=8,$r(L,B,p,t);case 8:case"end":return F.stop()}},ne)}))},!1),j("video.mediaStream.registerForVideoFrame",[l.config]);else{if(null===(v=i.supports.video)||void 0===v||!v.sharedFrame)throw k;Y("video.newVideoFrame",function(D){if(D){t?.reportStartFrameProcessing(D.width,D.height);var ne=o(),L=D.timestamp;l.videoBufferHandler(function(l){return l.videoFrameBuffer=l.videoFrameBuffer||l.data,delete l.data,l}(D),function(){ne(),t?.reportFrameProcessed(),function(l){j("video.videoFrameProcessed",[l])}(L)},p)}},!1),j("video.registerForVideoFrame",[l.config])}t?.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(l,c,g){if(f(i,s.sidePanel),!d())throw k;j("video.videoEffectChanged",[l,c,g])},e.registerForVideoEffect=function(l){if(f(i,s.sidePanel),!d())throw k;Y("video.effectParameterChange",Zr(l,t),!1),j("video.registerForVideoEffect")},e.updatePersonalizedEffects=function(l){if(f(i,s.sidePanel),!Pt.isSupported())throw k;j("video.personalizedEffectsChanged",[l])},e.isSupported=d,e.notifyFatalError=function(l){if(f(i),!Pt.isSupported())throw k;p(l,r.Fatal)}}(dr||(dr={}))}(),Le}()},87575:function(se,We,H){"use strict";H.r(We),H.d(We,{ExportDataDialogModule:function(){return gn}});var S=H(32293),$=H(36444),z=H(50600),ue=H(8902),h=H(50423),Re=H(77326),Le=H(9380),ge=H(65181),ee=H(81213),b=H(77476),pe=H(17174),Q=H(59968),m=H(22844),Ie=H(50057),ke=H(70410),Z=H(44408),X=H(11941),q=H(39686),te=H(76492),le=H(42189),De=H(9529),xe=H(85102);function he(E,i){1&E&&h.\u0275\u0275element(0,"span",30)}function $e(E,i){1&E&&(h.\u0275\u0275elementStart(0,"span",31),h.\u0275\u0275element(1,"mat-icon",32)(2,"span",33),h.\u0275\u0275elementEnd())}var ze=function(i,O,N){return{"exportTypeRadioButton-selected":i,"exportTypeRadioButton-disabled":O,exportTypeRadioButton:N}};function Ze(E,i){if(1&E&&(h.\u0275\u0275elementStart(0,"span",9)(1,"pbi-radio-button",15)(2,"span",11),h.\u0275\u0275element(3,"mat-icon",27),h.\u0275\u0275elementEnd(),h.\u0275\u0275element(4,"span",28),h.\u0275\u0275template(5,he,1,0,"span",29),h.\u0275\u0275template(6,$e,3,0,"span",19),h.\u0275\u0275elementEnd()()),2&E){var O=h.\u0275\u0275nextContext();h.\u0275\u0275advance(1),h.\u0275\u0275propertyInterpolate("aria-label",O.localizedExportDataMatrixVisualLabel),h.\u0275\u0275property("ngClass",h.\u0275\u0275pureFunction3(7,ze,2===O.selectedOutputFormat&&!0===O.isExportDataWithCurrentLayoutEnabled,!1===O.isExportDataWithCurrentLayoutEnabled,2!==O.selectedOutputFormat&&!0===O.isExportDataWithCurrentLayoutEnabled))("checked",2===O.selectedOutputFormat)("value",2)("disabled",!1===O.isExportDataWithCurrentLayoutEnabled),h.\u0275\u0275advance(4),h.\u0275\u0275property("ngIf",!0===O.isExportDataWithCurrentLayoutEnabled),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",!1===O.isExportDataWithCurrentLayoutEnabled)}}function U(E,i){1&E&&h.\u0275\u0275element(0,"span",34)}function et(E,i){if(1&E&&(h.\u0275\u0275elementStart(0,"span",31),h.\u0275\u0275element(1,"mat-icon",32)(2,"span",35),h.\u0275\u0275elementEnd()),2&E){var O=h.\u0275\u0275nextContext();h.\u0275\u0275advance(2),h.\u0275\u0275propertyInterpolate("localize",O.exportDialogUnderlyingDisabledReason)}}function Ae(E,i){if(1&E&&(h.\u0275\u0275elementStart(0,"div",38),h.\u0275\u0275text(1),h.\u0275\u0275elementEnd()),2&E){var O=h.\u0275\u0275nextContext().$implicit,N=h.\u0275\u0275nextContext();h.\u0275\u0275advance(1),h.\u0275\u0275textInterpolate(N.getExportConnectedDataTooltipValue(O.tooltipKey))}}function ot(E,i){if(1&E&&(h.\u0275\u0275elementStart(0,"pbi-dropdown-item",36),h.\u0275\u0275text(1),h.\u0275\u0275template(2,Ae,2,1,"div",37),h.\u0275\u0275elementEnd()),2&E){var O=i.$implicit;h.\u0275\u0275property("value",O)("disabled",O.disabled)("localizeTooltip",O.tooltipKey),h.\u0275\u0275advance(1),h.\u0275\u0275textInterpolate1(" ",O.displayName," "),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",O.tooltipKey)}}function Je(E,i){1&E&&(h.\u0275\u0275elementStart(0,"div",31),h.\u0275\u0275element(1,"mat-icon",32)(2,"span",39),h.\u0275\u0275elementEnd())}var Pe=function(){return{"aria-label":"Close"}},dt=function(){return{"aria-label":"ModalDialog_ExportDataTextDialogThree"}},ht=function(i,O){return{"exportTypeRadioButton-selected":i,exportTypeRadioButton:O}},lt=function(i,O,N){return{"exportTypeRadioButton-disabled":i,"exportTypeRadioButton-selected":O,exportTypeRadioButton:N}},V=function(){return{"aria-label":"ModalDialog_ExportDataFormatTypeText"}},R=window,P=function(){function E(i,O,N,ce,de,Ne,G){var M=this;this.matDialogRef=i,this.informationProtectionService=O,this.featureSwitchService=N,this.localizationService=ce,this.errorService=Ne,this.highContrastCssGenerationService=G,this.reportHasSensitivityLabel=!1,this.exportDataWithCurrentLayoutStatus=E.computeExportDataWithCurrentLayoutStatus(this.featureSwitchService,de.viewModel),this.exportDataMode=de.viewModel.exportDataMode,this.isCsvFormatDisabled=de.viewModel.isCsvFormatDisabled,this.isExlFormatDisabled=de.viewModel.isExlFormatDisabled,this.isExploreAuthorized=de.viewModel.isExploreAuthorized,this.exportConnectedSummarizedDataOption=de.viewModel.exportConnectedSummarizedDataOption,this.hasMeasuresForUnderlyingData=de.viewModel.hasMeasuresForUnderlyingData,this.model=de.viewModel.model,this.exportDataDialogTitle=this.localizationService.get("ModalDialog_ExportDataTitleTwo"),this.initializeHighContrastRules(),this.informationProtectionService.isInformationProtectionFeatureEnabled()&&(this.informationProtectionSubscription=de.viewModel.artifactId?this.informationProtectionService.isArtifactLabeled(z.B.Report,de.viewModel.artifactId).subscribe(function(K){M.reportHasSensitivityLabel=K}):this.informationProtectionService.isArtifactLabeled(z.B.Model,this.model.id).subscribe(function(K){M.reportHasSensitivityLabel=K}))}return E.prototype.ngOnInit=function(){var i;this.selectedOutputFormat=this.isExportDataWithCurrentLayoutEnabled?2:0,i=this.isUnderlyingDataDisabled(),this.exportDialogUnderlyingDisabled=i[0],this.exportDialogUnderlyingDisabledReason=i[1],this.populateFileFormatOptionItems(this.selectedOutputFormat)},E.prototype.ngOnDestroy=function(){this.informationProtectionSubscription&&this.informationProtectionSubscription.unsubscribe()},Object.defineProperty(E.prototype,"isExportDataWithCurrentLayoutEnabled",{get:function(){return 0===this.exportDataWithCurrentLayoutStatus},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"isExportDataWithCurrentLayoutShown",{get:function(){return 5!==this.exportDataWithCurrentLayoutStatus},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"localizedExportDataMatrixVisualLabel",{get:function(){return this.localizationService.get("ModalDialog_ExportDataMatrixVisual")},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"localizedSummarizedLabel",{get:function(){return this.localizationService.get("ModalDialog_ExportDataSummarized")},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"localizedUnderlyingLabel",{get:function(){return this.localizationService.get("ModalDialog_ExportDataUnderlying")},enumerable:!1,configurable:!0}),E.prototype.cancel=function(){this.matDialogRef.close()},Object.defineProperty(E.prototype,"isDownloadFilesInMetaOSEnabled",{get:function(){return R.hostPlatformName===$.HostName.office?this.featureSwitchService.featureSwitches.isDownloadFilesInOfficeEnabled:R.hostPlatformName!==$.HostName.outlook||this.featureSwitchService.featureSwitches.isDownloadFilesInOutlookEnabled},enumerable:!1,configurable:!0}),E.prototype.showFeatureComingSoonDialog=function(){var i={title:this.localizationService.get("MetaOS_ComingSoon_Title"),showAdditionalErrorInfo:!1,hideGetHelpLink:!0};this.errorService.error("","MetaOS_File_Downloads_Deactivated",i)},E.prototype.export=function(){if(this.isDownloadFilesInMetaOSEnabled){var i=this.convertDialogueOptionsToExportType(this.selectedOutputFormat,this.fileFormatSelectedItem.name);this.matDialogRef.close({dataType:i,format:this.fileFormatSelectedItem.name})}else this.showFeatureComingSoonDialog()},E.prototype.onExportTypeChange=function(i){var O=parseInt(String(i),10);this.updateDialogSettings(0===O?0:1===O?1:2)},E.prototype.updateDialogSettings=function(i){this.selectedOutputFormat=i,this.populateFileFormatOptionItems(i)},E.prototype.checkFileFormatDisable=function(){return 0!==this.selectedOutputFormat},E.computeExportDataWithCurrentLayoutStatus=function(i,O){return!0!==i.featureSwitches.ExportToExcelMatrixVisualData?5:O.isExportMatrixVisualDataSupported?0:4},E.prototype.convertDialogueOptionsToExportType=function(i,O){var N;if(3===O)N=3;else switch(i){case 0:N=0;break;case 1:N=1;break;case 2:N=2}return N},E.prototype.isUnderlyingDataDisabled=function(){return this.hasMeasuresForUnderlyingData?void 0===this.exportDataMode||0===this.exportDataMode?this.isExploreAuthorized?this.featureSwitchService.featureSwitches.exportUnderlyingDataEnabled?[!1,void 0]:[!0,"ExportData_Underlying_TenantSettingDisabled"]:[!0,"ExportData_Underlying_NoPermission"]:[!0,"ExportData_WarningDialog_Disabled"]:[!0,"ExportData_Underlying_NoAggregatesOrMeasures"]},E.prototype.checkExportDisable=function(){return 0===this.fileFormatSelectedItem.name&&this.isCsvFormatDisabled||1===this.fileFormatSelectedItem.name&&this.isExlFormatDisabled},E.prototype.checkInformationProtectionWarningRequired=function(){return 0===this.fileFormatSelectedItem.name&&0===this.selectedOutputFormat&&!0===this.reportHasSensitivityLabel},E.prototype.populateFileFormatOptionItems=function(i){var O={name:0,displayName:this.localizationService.get("ModalDialog_ExportDataFormatCsv")},N={name:1,displayName:this.localizationService.get("ModalDialog_ExportDataFormatXL")},ce={name:3,displayName:this.localizationService.get("ModalDialog_ExportConnectedData"),disabled:0!==this.exportConnectedSummarizedDataOption,tooltipKey:this.getExportConnectedDataTooltipKey()};this.fileFormatItems=0===i?0===this.exportConnectedSummarizedDataOption?[ce,N,O]:5===this.exportConnectedSummarizedDataOption?[N,O]:[N,O,ce]:[N],this.fileFormatSelectedItem=this.fileFormatItems[0]},E.prototype.getExportConnectedDataTooltipKey=function(){if(0===this.exportConnectedSummarizedDataOption)return null;switch(this.exportConnectedSummarizedDataOption){case 1:return"ExportDataOption_NotAllowedByAdmin";case 2:default:return"ExportDataOption_NotAuthorized";case 3:return"ExportDataOption_InsufficientLicense";case 4:return"ExportDataOption_UnsupportedScenario"}},E.prototype.getExportConnectedDataTooltipValue=function(i){return this.localizationService.get(i)},E.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".fileFormatSelector .themeableElement.popout-button:focus","{ outline-color: unset !important; }")},E.\u0275fac=function(O){return new(O||E)(h.\u0275\u0275directiveInject(S.so),h.\u0275\u0275directiveInject(Re.u),h.\u0275\u0275directiveInject(Le.vZ),h.\u0275\u0275directiveInject(ge.o),h.\u0275\u0275directiveInject(S.WI),h.\u0275\u0275directiveInject(ee.T),h.\u0275\u0275directiveInject(ue.Mi))},E.\u0275cmp=h.\u0275\u0275defineComponent({type:E,selectors:[["export-data-dialog"]],decls:39,vars:40,consts:[["data-testid","export-dialog-title",1,"exportDialogTitle"],[1,"fluentTheme-xlg-semibold","exportDialogTitleText"],["mat-icon-button","","localizeTooltip","Close","data-testid","close-btn",1,"fluentTheme-lg-reg","closeExportDataIcon",3,"localizeAttr","accessible-click","click"],["fontIcon","pbi-glyph-close",1,"glyph-small"],[1,"fluentTheme-md-reg","exportDescription"],["localize","ModalDialog_ExportDataTextDialogThree",3,"localizeAttr"],["localize","ExportData_LearnMore","localize-tooltip","ExportData_LearnMore","href","https://go.microsoft.com/fwlink/?linkid=874053","target","_blank",1,"exportDescriptionLink"],[1,"exportTypeRadioGroup",3,"ngModel","ngModelChange"],["class","exportTypeRadioButtonBlock",4,"ngIf"],[1,"exportTypeRadioButtonBlock"],[3,"ngClass","aria-label","checked","value"],[1,"exportTypeRadioButtonIcon"],["fontIcon","pbi-glyph-databaseactivity",1,"glyph-medium"],["localize","ModalDialog_ExportDataSummarized",1,"fluentTheme-md-semiBold","exportTypeRadioButtonTitle"],["localize","ModalDialog_ExportDataSummarizedDescription",1,"fluentTheme-sm-reg","exportTypeRadioButtonDescription"],[3,"ngClass","aria-label","checked","value","disabled"],["fontIcon","pbi-glyph-databaseswap",1,"glyph-medium"],["localize","ModalDialog_ExportDataUnderlying",1,"fluentTheme-md-semiBold","exportTypeRadioButtonTitle"],["class","fluentTheme-sm-reg exportTypeRadioButtonDescription","localize","ModalDialog_ExportDataUnderlyingDescription",4,"ngIf"],["class","fluentTheme-sm-reg exportDialogWarning",4,"ngIf"],[1,"fluentTheme-md-reg","fileFormatSelector"],["id","fileFormatLabelText","localize","ModalDialog_ExportDataFormatTypeText",1,"fileFormatLabel"],[3,"ngModel","disabled","aria-labelledby","localizeAttr","ngModelChange"],[3,"value","disabled","localizeTooltip",4,"ngFor","ngForOf"],["data-testid","mat-dialog-actions"],["mat-button","","autofocus","","data-testid","export-btn","localize","ModalDialogButtonText_Export",1,"pbi-modern-button","primaryBtn","exportButton",3,"disabled","click"],["mat-button","","autofocus","","data-testid","cancel-btn","localize","ModalDialog_Cancel",1,"pbi-modern-button","secondaryBtn","cancelBtn","exportButton",3,"click"],["fontIcon","pbi-glyph-table",1,"glyph-medium"],["localize","ModalDialog_ExportDataMatrixVisual",1,"fluentTheme-md-semiBold","exportTypeRadioButtonTitle"],["class","fluentTheme-sm-reg exportTypeRadioButtonDescription","localize","ModalDialog_ExportDataMatrixVisualDescription",4,"ngIf"],["localize","ModalDialog_ExportDataMatrixVisualDescription",1,"fluentTheme-sm-reg","exportTypeRadioButtonDescription"],[1,"fluentTheme-sm-reg","exportDialogWarning"],["fontIcon","pbi-glyph-info",1,"glyph-small"],["localize","ExportData_WarningDialog_Unavailable"],["localize","ModalDialog_ExportDataUnderlyingDescription",1,"fluentTheme-sm-reg","exportTypeRadioButtonDescription"],[3,"localize"],[3,"value","disabled","localizeTooltip"],["aria-live","polite","class","screen-reader-only",4,"ngIf"],["aria-live","polite",1,"screen-reader-only"],["localize","EimInformationProtection_WarningBanner_ExportDataToCsv"]],template:function(O,N){1&O&&(h.\u0275\u0275elementStart(0,"mat-dialog-content")(1,"div",0)(2,"h2",1),h.\u0275\u0275text(3),h.\u0275\u0275elementEnd(),h.\u0275\u0275elementStart(4,"button",2),h.\u0275\u0275listener("accessible-click",function(){return N.cancel()})("click",function(){return N.cancel()}),h.\u0275\u0275element(5,"mat-icon",3),h.\u0275\u0275elementEnd()(),h.\u0275\u0275elementStart(6,"div",4)(7,"p"),h.\u0275\u0275element(8,"span",5)(9,"a",6),h.\u0275\u0275elementEnd()(),h.\u0275\u0275elementStart(10,"pbi-radio-group",7),h.\u0275\u0275listener("ngModelChange",function(de){return N.selectedOutputFormat=de})("ngModelChange",function(de){return N.onExportTypeChange(de)}),h.\u0275\u0275template(11,Ze,7,11,"span",8),h.\u0275\u0275elementStart(12,"span",9)(13,"pbi-radio-button",10)(14,"span",11),h.\u0275\u0275element(15,"mat-icon",12),h.\u0275\u0275elementEnd(),h.\u0275\u0275element(16,"span",13)(17,"span",14),h.\u0275\u0275elementEnd()(),h.\u0275\u0275elementStart(18,"span",9)(19,"pbi-radio-button",15)(20,"span",11),h.\u0275\u0275element(21,"mat-icon",16),h.\u0275\u0275elementEnd(),h.\u0275\u0275element(22,"span",17),h.\u0275\u0275template(23,U,1,0,"span",18),h.\u0275\u0275template(24,et,3,1,"span",19),h.\u0275\u0275elementEnd()()(),h.\u0275\u0275elementStart(25,"div",20),h.\u0275\u0275element(26,"label",21),h.\u0275\u0275elementStart(27,"pbi-dropdown",22),h.\u0275\u0275listener("ngModelChange",function(de){return N.fileFormatSelectedItem=de}),h.\u0275\u0275elementStart(28,"pbi-dropdown-trigger")(29,"p"),h.\u0275\u0275text(30),h.\u0275\u0275elementEnd()(),h.\u0275\u0275template(31,ot,3,5,"pbi-dropdown-item",23),h.\u0275\u0275elementEnd()(),h.\u0275\u0275template(32,Je,3,0,"div",19),h.\u0275\u0275elementEnd(),h.\u0275\u0275elementStart(33,"mat-dialog-actions",24)(34,"button",25),h.\u0275\u0275listener("click",function(){return N.export()}),h.\u0275\u0275pipe(35,"localize"),h.\u0275\u0275elementEnd(),h.\u0275\u0275elementStart(36,"button",26),h.\u0275\u0275listener("click",function(){return N.cancel()}),h.\u0275\u0275pipe(37,"localize"),h.\u0275\u0275elementEnd()(),h.\u0275\u0275element(38,"span")),2&O&&(h.\u0275\u0275advance(3),h.\u0275\u0275textInterpolate(N.exportDataDialogTitle),h.\u0275\u0275advance(1),h.\u0275\u0275property("localizeAttr",h.\u0275\u0275pureFunction0(30,Pe)),h.\u0275\u0275advance(4),h.\u0275\u0275property("localizeAttr",h.\u0275\u0275pureFunction0(31,dt)),h.\u0275\u0275advance(2),h.\u0275\u0275property("ngModel",N.selectedOutputFormat),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",!0===N.isExportDataWithCurrentLayoutShown),h.\u0275\u0275advance(2),h.\u0275\u0275propertyInterpolate("aria-label",N.localizedSummarizedLabel),h.\u0275\u0275property("ngClass",h.\u0275\u0275pureFunction2(32,ht,0===N.selectedOutputFormat,0!==N.selectedOutputFormat))("checked",0===N.selectedOutputFormat)("value",0),h.\u0275\u0275advance(6),h.\u0275\u0275propertyInterpolate("aria-label",N.localizedUnderlyingLabel),h.\u0275\u0275property("ngClass",h.\u0275\u0275pureFunction3(35,lt,!0===N.exportDialogUnderlyingDisabled,!1===N.exportDialogUnderlyingDisabled&&1===N.selectedOutputFormat,!1===N.exportDialogUnderlyingDisabled&&1!==N.selectedOutputFormat))("checked",!1)("value",1)("disabled",!0===N.exportDialogUnderlyingDisabled),h.\u0275\u0275advance(4),h.\u0275\u0275property("ngIf",!1===N.exportDialogUnderlyingDisabled),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",!0===N.exportDialogUnderlyingDisabled),h.\u0275\u0275advance(3),h.\u0275\u0275property("ngModel",N.fileFormatSelectedItem)("disabled",N.checkFileFormatDisable())("aria-labelledby","fileFormatLabelText")("localizeAttr",h.\u0275\u0275pureFunction0(39,V)),h.\u0275\u0275advance(3),h.\u0275\u0275textInterpolate(N.fileFormatSelectedItem.displayName),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngForOf",N.fileFormatItems),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",N.checkInformationProtectionWarningRequired()),h.\u0275\u0275advance(2),h.\u0275\u0275property("disabled",N.checkExportDisable()),h.\u0275\u0275attribute("aria-label",h.\u0275\u0275pipeBind1(35,26,"ModalDialogButtonText_Export")),h.\u0275\u0275advance(2),h.\u0275\u0275attribute("aria-label",h.\u0275\u0275pipeBind1(37,28,"ModalDialog_Cancel")))},dependencies:[b.NgClass,b.NgForOf,b.NgIf,pe.JJ,pe.On,Q.X,m.b,Ie.r,ke.eB,Z.Hw,X.o,q.d,te.H,le.r,De._,te.T,S.xY,S.H8,xe.F],styles:['mat-dialog-content[_ngcontent-%COMP%]{overflow:auto;margin:unset}mat-dialog-content[_ngcontent-%COMP%]   .exportDialogTitle[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}mat-dialog-content[_ngcontent-%COMP%]   .exportDialogTitle[_ngcontent-%COMP%]   .exportDialogTitleText[_ngcontent-%COMP%]{line-height:28px;color:var(--fluent-theme-neutral-primary-color, #323130);margin-bottom:0}mat-dialog-content[_ngcontent-%COMP%]   .exportDialogTitle[_ngcontent-%COMP%]   .closeExportDataIcon[_ngcontent-%COMP%]{width:32px;height:32px;line-height:19px}mat-dialog-content[_ngcontent-%COMP%]   .exportDialogTitle[_ngcontent-%COMP%]   .closeExportDataIcon[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}mat-dialog-content[_ngcontent-%COMP%]   .exportDescription[_ngcontent-%COMP%]{margin-top:16px;line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130)}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescription[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescription[_ngcontent-%COMP%]{margin-right:8px}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescription[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescription[_ngcontent-%COMP%]{margin-left:8px}mat-dialog-content[_ngcontent-%COMP%]   .glyph-small[_ngcontent-%COMP%]{padding-right:6px}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescriptionLink[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescriptionLink[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescriptionLink[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDescriptionLink[_ngcontent-%COMP%]{margin-right:8px}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]{display:flex;position:relative;flex-flow:row wrap;list-style:none;margin-top:32px;justify-content:flex-start;grid-gap:18px}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]     .pbi-radio-button-internal section{flex-direction:column;display:block;position:relative;width:180px;height:216px;box-sizing:border-box}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]     .pbi-radio-button-internal section, html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]     .pbi-radio-button-internal section{padding:8px}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]     .pbi-radio-button-internal section, html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioGroup[_ngcontent-%COMP%]     .pbi-radio-button-internal section{padding:8px}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonBlock[_ngcontent-%COMP%]{display:flex;width:180px;height:216px}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonBlock[_ngcontent-%COMP%]     .pbi-radio-button-circle{border:2px solid var(--black-color, #000)}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButton[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;width:180px;height:216px;background:var(--fluent-theme-white-color, #FFF);border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12)}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButton-disabled[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;visibility:visible;width:180px;height:216px;color:var(--fluent-theme-light-gray-color, #c8c8c8);border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12)}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButton-selected[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;visibility:visible;width:180px;height:216px;background:var(--fluent-theme-white-color, #FFF);border-radius:4px;border:2px solid var(--black-color, #000)}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonIcon[_ngcontent-%COMP%]{display:flex;position:relative;bottom:16px;width:100%;justify-content:center}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonIcon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonTitle[_ngcontent-%COMP%]{display:inline-flex;justify-content:flex-start;width:172px;line-height:20px}mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%]{display:inline-flex;width:164px;line-height:16px}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:0}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:0}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%]{text-align:left}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportTypeRadioButtonDescription[_ngcontent-%COMP%]{text-align:right}mat-dialog-content[_ngcontent-%COMP%]   .fileFormatLabel[_ngcontent-%COMP%]{display:inline-block;margin-top:24px;margin-bottom:12px}mat-dialog-content[_ngcontent-%COMP%]   .fileFormatSelector[_ngcontent-%COMP%]{display:block;margin-bottom:12px;line-height:20px}mat-dialog-content[_ngcontent-%COMP%]   .fileFormatSelector[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}mat-dialog-content[_ngcontent-%COMP%]   .exportDialogWarning[_ngcontent-%COMP%]{display:flex;padding:6px;background:var(--gray-20, #F3F2F1);line-height:18px;position:relative}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDialogWarning[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDialogWarning[_ngcontent-%COMP%]{margin:8px 12px 0 2px}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDialogWarning[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]   .exportDialogWarning[_ngcontent-%COMP%]{margin:8px 2px 0 12px}mat-dialog-actions[_ngcontent-%COMP%]{flex:0 0 auto;height:32px;width:100%;box-sizing:border-box;display:flex;justify-content:flex-end;margin-bottom:16px}mat-dialog-actions[_ngcontent-%COMP%]   button.exportButton[_ngcontent-%COMP%]{border-radius:2px;line-height:unset}@media (forced-colors: active){mat-dialog-actions[_ngcontent-%COMP%]   button.exportButton[_ngcontent-%COMP%]{border:1px solid}}html:not([dir="rtl"])[_nghost-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button.cancelBtn[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button.cancelBtn[_ngcontent-%COMP%]{margin:0 24px 0 16px}html[dir="rtl"][_nghost-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button.cancelBtn[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button.cancelBtn[_ngcontent-%COMP%]{margin:0 16px 0 24px}.screen-reader-only[_ngcontent-%COMP%]{height:0;width:0}@media (forced-colors: active){.exportTypeRadioButton-disabled[_ngcontent-%COMP%]{forced-color-adjust:none}.exportDialogWarning[_ngcontent-%COMP%]{background:none!important}}']}),E}(),y=H(2467),w=H(87650),T=H(89847),I=H(81337),x=H(22249),s=H(91897),J=H(60756),Oe=H(94853),Me=H(53497),ut=H(62458),we=H(45034),k=H(98873),Ht=H(25082),zt=H(71477),Se=H(11547),Ee=H(37272),Vt=H(59017),Be=H(42195),tt=H(24874),it=H(59822),nt=H(14172),jt=H(17653),Dt=H(41198),Gt=H(85732),cn=function(){function E(i,O,N,ce,de,Ne){var G=this;this.action$=i,this.injector=O,this.featureSwitchService=N,this.errorService=ce,this.localizationService=de,this.store=Ne,this.getLabelsList$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.PC),(0,Be.zg)(function(){return G.getLabelsList().pipe((0,tt.b)(function(M){return(0,Se.of)(new x.vE({iplsList:M.data}))}),(0,it.K)(function(M){return(0,Se.of)(new x.LO)}))}))}),this.getUserPolicy$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.pY),(0,Be.zg)(function(){return G.getUserPolicy().pipe((0,tt.b)(function(M){return(0,Se.of)(new x.km({informationProtectionUserPolicy:M.data}))}),(0,it.K)(function(){return(0,Se.of)(new x.xd)}))}))}),this.getLabelsUsageRights$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.zV,x.qO),(0,Be.zg)(function(){return G.featureSwitchService.featureSwitches.eimInformationProtectionUsageRightsUI?G.getLabelsUsageRights().pipe((0,tt.b)(function(M){return(0,Se.of)(new x.xT({labelsUsageRights:M.data}))}),(0,it.K)(function(){return Ee.E})):Ee.E}))}),this.addDefaultLabelToArtifact$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(Ht.j$.updateArtifactSuccess,Ht.j$.optimisticallyUpdateArtifactSuccess,zt.lK),(0,nt.U)(function(M){return M.artifact}),(0,J.IC)(function(M){return[G.informationProtectionService.hasArtifactInformationProtection(M.objectId),G.informationProtectionService.getUserPolicySettings()]}),(0,jt.b)(function(M){var K=M[0],re=K.objectId,_e=K.displayName,be=K.folderObjectId,ve=M[2];if(!M[1]&&null!=ve&&!_.isNil(ve.defaultLabelId)){var je=G.folderService.getFolder(be);G.informationProtectionService.upsertArtifactInformationProtection(ve.defaultLabelId,void 0,_e,je.displayName,z.B.Artifact,void 0,re,!0,!0)}}))},{dispatch:!1}),this.addDefaultLabelOnRenamePbiArtifactSuccessFromFlyout$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.m),(0,nt.U)(function(M){return M.payload}),(0,J.IC)(function(M){return[G.informationProtectionService.isArtifactLabeled(M.artifactType,M.artifactId,M.artifactObjectId),G.informationProtectionService.getUserPolicySettings()]}),(0,jt.b)(function(M){var K=M[0],re=K.workspaceId,_e=K.artifactId,be=K.name,ae=K.artifactType,ve=K.artifactObjectId,Ye=M[2];if(G.shouldDeafaultLabelToBeAppliedOnPbiArtifact(M[1],Ye?.defaultLabelId)){var st=G.folderService.getFolderByFolderId(re);G.informationProtectionService.upsertArtifactInformationProtection(Ye.defaultLabelId,_e,be,st.displayName,ae,!1,ve,!0,!0)}}))},{dispatch:!1}),this.upsertArtifactLabel$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.GW),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.labelId,re=M.artifactId,_e=M.artifactName,be=M.artifactWorkspace,ae=M.artifactType,ve=M.triggerUserDownstreamInheritance,je=M.telemetryEvent,Ye=M.artifactObjectId,st=M.isLabelAssignedByDefaultPolicy,He=M.updateUIFirst;if(!G.informationProtectionService.isInformationProtectionEditEnabled())return Ee.E;var f=G.isInformationProtectionSupportedForTridentEnabled();return G.store.dispatch(new x.jh({labelId:K,artifactObjectId:Ye,artifactId:re,updateUIFirst:He,artifactType:ae,isInformationProtectionSupportedForTrident:f})),G.upsertArtifactLabel(K,re,ae,ve,Ye,st).pipe((0,tt.b)(function(qe){return je&&je.resolve(),(0,Se.of)(new x.x1(qe.data))}),(0,it.K)(function(qe){var Mt;return je&&je.reject((0,Oe.GB)(qe.error)),G.artifactInformationProtectionSaveFailed(ae,_e,be,qe.requestId,null===(Mt=qe.status)||void 0===Mt?void 0:Mt.toString()),(0,Se.of)(new x.ur({upsertInformationProtectionResponse:null,artifactObjectId:Ye,updateUIFirst:He,artifactType:ae,artifactId:re,isInformationProtectionSupportedForTrident:f}))}))}))}),this.deleteArtifactLabel$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.LT),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.artifactId,re=M.artifactType,_e=M.artifactName,be=M.artifactWorkspace,ae=M.telemetryEvent,ve=M.artifactObjectId,je=M.updateUIFirst;if(!G.informationProtectionService.isInformationProtectionEditEnabled())return Ee.E;var Ye=G.isInformationProtectionSupportedForTridentEnabled();return G.store.dispatch(new x.oi({artifactId:K,artifactType:re,artifactObjectId:ve,isInformationProtectionSupportedForTrident:Ye,updateUIFirst:je})),G.deleteArtifactLabel(K,re,ve).pipe((0,tt.b)(function(st){return ae&&ae.resolve(),(0,Se.of)(new x.hW({artifactId:K,artifactType:re,artifactObjectId:ve,isInformationProtectionSupportedForTrident:Ye,deletedArtifactsInformationProtection:st.data}))}),(0,it.K)(function(st){var He;return ae&&ae.reject((0,Oe.GB)(st.error)),G.artifactInformationProtectionSaveFailed(re,_e,be,st.requestId,null===(He=st.status)||void 0===He?void 0:He.toString()),(0,Se.of)(new x.B5({updateUIFirst:je,artifactType:re,artifactObjectId:ve,artifactId:K,isInformationProtectionSupportedForTrident:Ye}))}))}))}),this.loadCrossWorkspaceArtifactLabels$=(0,J.GW)(function(){return(0,Vt.aj)([G.action$,G.featureSwitchService.featureSwitches$]).pipe((0,Dt.n)(function(M){return!M[1]}),(0,nt.U)(function(M){return M[0]}),(0,J.l4)(x.W7),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.artifactsDetails,re=M.logDownstreamUsageInEmbedFlowsDetails,_e=M.telemetryEvent;return G.isInformationProtectionEnabled()&&G.isCrossArtifactsSizeValid(K,_e)?G.getCrossWorkspaceLabels(K).pipe((0,tt.b)(function(be){_e&&_e.resolve();var ae=be&&be.data,ve=G.featureSwitchService.featureSwitches.eimInformationProtectionStoreOptimization;if(!ae)return Ee.E;G.informationProtectionService.logArtifactsCrossWorkspaceListViewedTelemetry(ae,K),1===K.workloadType&&!_.isEmpty(re)&&G.logDownstreamUsageIfNeeded(K,ae,re);var je=G.getDeletedLabels(K,ae);return(0,Se.of)(new x.lE({workspaceInformationProtection:ae,ipStoreOptimizationEnabled:ve,deletedLabels:je,isInformationProtectionSupportedForTrident:G.isInformationProtectionSupportedForTridentEnabled()}))}),(0,it.K)(function(be){return _e&&_e.reject((0,Oe.GB)(be.error)),(0,Se.of)(new x.GH)})):Ee.E}))}),this.fetchInformationProtectionLabelsForArtifacts$=(0,J.GW)(function(){return(0,Vt.aj)([G.action$,G.featureSwitchService.featureSwitches$]).pipe((0,Dt.n)(function(M){return!M[1]}),(0,nt.U)(function(M){return M[0]}),(0,J.l4)(x.i2),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.artifactsDetails,re=M.artifactsType,_e=M.telemetryEvent;return G.isInformationProtectionEnabled()?G.getArtifactsLabels(K,re).pipe((0,tt.b)(function(be){_e&&_e.resolve();var ae=be&&be.data;if(!ae)return Ee.E;var ve=G.featureSwitchService.featureSwitches.eimInformationProtectionStoreOptimization;switch(re){case z.B.Report:return _.isEmpty(ae.reportInformationProtections)?Ee.E:(0,Se.of)(new x.ob({artifactsInformationProtection:ae.reportInformationProtections,artifactsType:re,ipStoreOptimizationEnabled:ve}));case z.B.Dashboard:return _.isEmpty(ae.dashboardInformationProtections)?Ee.E:(0,Se.of)(new x.ob({artifactsInformationProtection:ae.dashboardInformationProtections,artifactsType:re,ipStoreOptimizationEnabled:ve}));case z.B.Model:return _.isEmpty(ae.datasetInformationProtections)?Ee.E:(0,Se.of)(new x.ob({artifactsInformationProtection:ae.datasetInformationProtections,artifactsType:re,ipStoreOptimizationEnabled:ve}));case z.B.Datamart:return _.isEmpty(ae.datamartInformationProtections)?Ee.E:(0,Se.of)(new x.ob({artifactsInformationProtection:ae.datamartInformationProtections,artifactsType:re,ipStoreOptimizationEnabled:ve}));case z.B.Artifact:return _.isEmpty(ae.artifactInformationProtections)||!G.isInformationProtectionSupportedForTridentEnabled()?Ee.E:(0,Se.of)(new x.ob({artifactsInformationProtection:ae.artifactInformationProtections,artifactsType:re,ipStoreOptimizationEnabled:ve,isInformationProtectionSupportedForTrident:!0}));default:return ut.fF.assertFail("informationProtectionActions.LoadInformationProtectionLabelForArtifact is triggered for report,dashboard and dataset"),Ee.E}}),(0,it.K)(function(be){return _e&&_e.reject((0,Oe.GB)(be.error)),(0,Se.of)(new x.nV)})):Ee.E}))}),this.getInformationProtectionLabelForArtifact$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.$Q),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.artifactObjectId,re=M.artifactType,_e=M.telemetryEvent;return G.isInformationProtectionEnabled()?G.getArtifactLabel(K,re).pipe((0,tt.b)(function(be){if(_e&&_e.resolve(),!be||!be.data)return Ee.E;var ve=G.extractArtifactInformationProtection(be.data,re);return _.isNil(ve)?Ee.E:(0,Se.of)(new x.eT({aip:ve,isInformationProtectionSupportedForTrident:G.isInformationProtectionSupportedForTridentEnabled()}))}),(0,it.K)(function(be){return _e&&_e.reject((0,Oe.GB)(be.error)),(0,Se.of)(new x.vc)})):Ee.E}))}),this.loadArtifactInformationProtection$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(zt.W2),(0,nt.U)(function(M){return M.artifact}),(0,Be.zg)(function(M){var K=M.objectId;return G.isInformationProtectionSupportedForTridentEnabled()?G.informationProtectionService.hasArtifactInformationProtection(K).pipe((0,Be.zg)(function(re){return re?Ee.E:(0,Se.of)(new x.Ai({artifactsDetails:[{artifactId:K}],artifactsType:z.B.Artifact}))}),(0,it.K)(function(){return Ee.E})):Ee.E}))}),this.upsertBulkLabelAsAdmin$=(0,J.GW)(function(){return G.action$.pipe((0,J.l4)(x.J7),(0,nt.U)(function(M){return M.payload}),(0,Be.zg)(function(M){var K=M.labelId,re=M.assignmentMethod,_e=M.datasetIds,be=M.reportIds,ae=M.dataflowIds,ve=M.dashboardIds,je=M.datamartIds,Ye=M.artifactIds;return G.informationProtectionService.isInformationProtectionEditEnabled()?G.upsertBulkLabel(K,re,_e,be,ae,ve,je,Ye).pipe((0,tt.b)(function(st){return(0,Se.of)(new x.aF({labelId:K,assignmentMethod:re,response:st.data}))}),(0,it.K)(function(){return(0,Se.of)(new x.XU)})):Ee.E}))}),this._informationProtectionHttpService=new we.o(function(){return G.injector.get(s.X)}),this._informationProtectionService=new we.o(function(){return G.injector.get(Re.u)}),this._folderService=new we.o(function(){return G.injector.get(k.s)})}return E.prototype.artifactInformationProtectionSaveFailed=function(i,O,N,ce,de){var Ne="CannotSaveLabelForArtifact_ErrorMessage_".concat(z.B[i].toLowerCase()),G=this.localizationService.format(Ne,[O,N]);this.errorService.error(G??this.localizationService.get(Ne),Ne,{requestId:ce,statusCode:de,title:this.localizationService.get("CannotSaveLabelForArtifact_ErrorTitle"),showAdditionalErrorInfo:!0,displayLearnMoreHelpLink:!0,helpLink:"https://go.microsoft.com/fwlink/?linkid=2134671"})},Object.defineProperty(E.prototype,"informationProtectionHttpService",{get:function(){return this._informationProtectionHttpService.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"informationProtectionService",{get:function(){return this._informationProtectionService.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"folderService",{get:function(){return this._folderService.getValue()},enumerable:!1,configurable:!0}),E.prototype.getLabelsList=function(){return this.informationProtectionHttpService.getLabelsList()},E.prototype.getUserPolicy=function(){return this.informationProtectionHttpService.getUserPolicy()},E.prototype.getLabelsUsageRights=function(){return this.informationProtectionHttpService.getLabelsUsageRights()},E.prototype.upsertArtifactLabel=function(i,O,N,ce,de,Ne){return void 0===Ne&&(Ne=!1),this.informationProtectionHttpService.upsertArtifactLabel(i,O,N,ce,void 0,de,Ne)},E.prototype.upsertBulkLabel=function(i,O,N,ce,de,Ne,G,M){return this.informationProtectionHttpService.upsertBulkLabelAsAdmin(i,O,N,ce,de,Ne,G,M)},E.prototype.deleteArtifactLabel=function(i,O,N){return this.informationProtectionHttpService.deleteArtifactLabel(i,O,void 0,N)},E.prototype.getCrossWorkspaceLabels=function(i){return this.informationProtectionHttpService.getArtifactsLabels(i)},E.prototype.isInformationProtectionEnabled=function(){return this.informationProtectionService.isInformationProtectionFeatureEnabled()},E.prototype.getArtifactsLabels=function(i,O){switch(O){case z.B.Report:return this.informationProtectionHttpService.getArtifactsLabels({reports:i});case z.B.Dashboard:return this.informationProtectionHttpService.getArtifactsLabels({dashboards:i});case z.B.Model:return this.informationProtectionHttpService.getArtifactsLabels({datasets:i});case z.B.Datamart:return this.informationProtectionHttpService.getArtifactsLabels({datamarts:i});case z.B.Artifact:return this.isInformationProtectionSupportedForTridentEnabled()?this.informationProtectionHttpService.getArtifactsLabels({artifacts:i}):Ee.E;default:return ut.fF.assertFail("getArtifactsLabels is called for report, dashboard, dataset and datamart"),(0,Se.of)({data:null})}},E.prototype.isCrossArtifactsSizeValid=function(i,O){var K=_.size(i.dashboards)+_.size(i.reports)+_.size(i.datasets)+_.size(i.dataflows)+_.size(i.datamarts)+_.size(i.artifacts);return 0!==K&&!(K>2e3&&(O&&O.reject({errorMessage:"#artifacts ".concat(K," is above limit (").concat(2e3,")"),httpStatusCode:413,errorCode:Me.td}),1))},E.prototype.extractArtifactInformationProtection=function(i,O){var N=null;switch(O){case z.B.Dashboard:N=this.getSingleArtifactInformationProtection(i.dashboardInformationProtections);break;case z.B.Report:N=this.getSingleArtifactInformationProtection(i.reportInformationProtections);break;case z.B.Model:N=this.getSingleArtifactInformationProtection(i.datasetInformationProtections);break;case z.B.Datamart:N=this.getSingleArtifactInformationProtection(i.datamartInformationProtections);break;case z.B.Artifact:this.isInformationProtectionSupportedForTridentEnabled()&&(N=this.getSingleArtifactInformationProtection(i.artifactInformationProtections));break;default:ut.fF.assertValue(O,"artifactType")}return N},E.prototype.getSingleArtifactInformationProtection=function(i){return _.isNil(i)||1!==_.size(i)?null:i[0]},E.prototype.getArtifactLabel=function(i,O){return this.informationProtectionHttpService.getArtifactLabel(i,O)},E.prototype.logDownstreamUsageIfNeeded=function(i,O,N){return(0,I.__awaiter)(this,void 0,void 0,function(){var ce;return(0,I.__generator)(this,function(de){return N.downstreamArtifactType===z.B.Report?1===_.size(i.reports)&&1===_.size(i.datasets)&&_.isEmpty(i.dashboards)&&_.isEmpty(i.dataflows)&&_.isEmpty(O.reportInformationProtections)&&!_.isEmpty(O.datasetInformationProtections)&&this.informationProtectionService.logDownstreamUsageDatasetInEmbedFlow(N.artifactId,(ce=O.datasetInformationProtections[0]).artifactId,ce):N.downstreamArtifactType===z.B.Dashboard?1===_.size(i.dashboards)&&_.isEmpty(i.dataflows)&&(_.size(i.datasets)>0||_.size(i.reports)>0)&&_.isEmpty(O.dashboardInformationProtections)&&(!_.isEmpty(O.datasetInformationProtections)||!_.isEmpty(O.reportInformationProtections))&&this.informationProtectionService.logDownstreamUsageInOpenDashboardEmbedFlow(N.artifactId):ut.fF.assertFail("Logging downstream usage only in opening report/dashobard embed flow"),[2]})})},E.prototype.getDeletedLabels=function(i,O){return _.isEmpty(i)||_.isEmpty(O)?i:{reports:this.getDeletedArtifactInformationProtection(i.reports,O.reportInformationProtections),dashboards:this.getDeletedArtifactInformationProtection(i.dashboards,O.dashboardInformationProtections),dataflows:this.getDeletedArtifactInformationProtection(i.dataflows,O.dataflowInformationProtections),datasets:this.getDeletedArtifactInformationProtection(i.datasets,O.datasetInformationProtections),datamarts:this.getDeletedArtifactInformationProtection(i.datamarts,O.datamartInformationProtections),artifacts:this.isInformationProtectionSupportedForTridentEnabled()?this.getDeletedArtifactInformationProtection(i.artifacts,O.artifactInformationProtections):[]}},E.prototype.getDeletedArtifactInformationProtection=function(i,O){if(_.isEmpty(i)||_.isEmpty(O))return i;var N=[];return _.find(i,function(ce){_.some(O,function(de){return ce.artifactId===de.artifactObjectId})||N.push(ce)}),N},E.prototype.isInformationProtectionSupportedForTridentEnabled=function(){return this.informationProtectionService.isInformationProtectionSupportedForTridentEnabled()},E.prototype.shouldDeafaultLabelToBeAppliedOnPbiArtifact=function(i,O){return!i&&!_.isNil(O)},E.\u0275fac=function(O){return new(O||E)(h.\u0275\u0275inject(J.eX),h.\u0275\u0275inject(h.Injector),h.\u0275\u0275inject(Le.vZ),h.\u0275\u0275inject(ee.T),h.\u0275\u0275inject(ge.o),h.\u0275\u0275inject(Gt.yh))},E.\u0275prov=h.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac}),E}(),dn=H(84836),Wt=function(){function E(i){this.impl=i}return E.prototype.isInformationProtectionEditEnabled=function(){return this.impl.isInformationProtectionEditEnabled()},E.prototype.getFlattenLabelList=function(){return this.impl.getFlattenLabelList()},E.prototype.getEmptyLabel=function(){return this.impl.getEmptyLabel()},E.prototype.getOrLoadArtifactInformationProtection=function(i,O,N,ce){return this.impl.getOrLoadArtifactInformationProtection(i,O,N,ce)},E.prototype.getUserCustomMoreInfoUrl=function(){return this.impl.getUserCustomMoreInfoUrl()},E.prototype.getLabelsUsageRightsEntities=function(){return this.impl.getLabelsUsageRightsEntities()},E.prototype.isLabelsListLoadingFailed=function(){return this.impl.isLabelsListLoadingFailed()},E.prototype.isUserAllowedToChangeLabel=function(i){return this.impl.isUserAllowedToChangeLabel(i)},E.prototype.deleteArtifactInformationProtection=function(i,O,N,ce,de,Ne){return this.impl.deleteArtifactInformationProtection(i,O,N,ce,de,Ne)},E.prototype.upsertArtifactInformationProtection=function(i,O,N,ce,de,Ne,G,M){return this.impl.upsertArtifactInformationProtection(i,O,N,ce,de,Ne,G,!1,M)},E.prototype.isInformationProtectionSupportedForTridentEnabled=function(){return this.impl.isInformationProtectionSupportedForTridentEnabled()},E.prototype.getDefaultLabelId=function(i,O){return void 0===O&&(O=!0),this.impl.getDefaultLabelId(i,O)},E.prototype.getLabelsList=function(){return this.impl.getLabelsList()},E.prototype.getUserPolicySettings=function(){return this.impl.getUserPolicySettings()},E.prototype.isMandatoryLabelEnabled=function(i,O){return void 0===O&&(O=!0),this.impl.isMandatoryLabelEnabled(i,O)},E.prototype.isInformationProtectionUserDownstreamInheritanceEnabled=function(){return this.impl.isInformationProtectionUserDownstreamInheritanceEnabled()},E.prototype.isInformationProtectionTridentDownstreamInheritanceUIEnabled=function(){return this.impl.isInformationProtectionTridentDownstreamInheritanceUIEnabled()},E.prototype.isInformationProtectionSystemDownstreamInheritanceEnabled=function(){return this.impl.isInformationProtectionSystemDownstreamInheritanceEnabled()},E.prototype.setDownstreamInheritanceTrigger=function(i){return this.impl.setDownstreamInheritanceTrigger(i)},E.prototype.deleteDownstreamInheritanceTrigger=function(i){return this.impl.deleteDownstreamInheritanceTrigger(i)},E.prototype.getDownstreamInheritanceTriggerArtifacts=function(){return this.impl.getDownstreamInheritanceTriggerArtifacts()},E.prototype.getArtifactsInformationProtections=function(i){return this.impl.getArtifactsInformationProtections(i)},E.prototype.isArtifactInformationProtectionInSavingProcess=function(i,O,N){return this.impl.isArtifactInformationProtectionInSavingProcess(i,O,N)},E.prototype.logArtifactViewedTelemetry=function(i,O,N){return this.impl.logArtifactViewedTelemetry(null,O,N,i)},E.\u0275fac=function(O){return new(O||E)(h.\u0275\u0275inject(Re.u))},E.\u0275prov=h.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac,providedIn:"root"}),E}(),$t=H(82156),ln=function(){function E(){}return E.\u0275fac=function(O){return new(O||E)},E.\u0275mod=h.\u0275\u0275defineNgModule({type:E}),E.\u0275inj=h.\u0275\u0275defineInjector({imports:[b.CommonModule,$t.N]}),E}(),un=H(69388),at=(H(64777),function(){function E(){}return E.\u0275fac=function(O){return new(O||E)},E.\u0275mod=h.\u0275\u0275defineNgModule({type:E}),E.\u0275inj=h.\u0275\u0275defineInjector({imports:[Gt.Aw.forFeature("informationprotectionstate",dn.ll),J.sQ.forFeature([cn,ln]),un.o_.forRoot({informationProtectionService:Wt})]}),E}()),pn=H(79061),Et=H(42729),fn=H(6015),qt=H(93367),Ot=H(59951),gn=function(){function E(){}return E.\u0275fac=function(O){return new(O||E)},E.\u0275mod=h.\u0275\u0275defineNgModule({type:E}),E.\u0275inj=h.\u0275\u0275defineInjector({imports:[b.CommonModule,pe.u5,pn.v,ke.yu,y.Zh,w.wp,Z.Ps,T.Xo,Ot.v,qt.U,fn.C,Et.c.withManifest([{componentIdentifier:"ExportDataDialogComponent",componentType:P}]),at]}),E}()},89847:function(se,We,H){"use strict";H.d(We,{vy:function(){return V},OY:function(){return lt},Xo:function(){return R}});var ee,b,pe,Q,m,fe=H(37419),S=H(50423),$=H(48138),z=H(51193),ue=H(77445),h=H(17174),Re=H(90341),Le=H(4437),ge=H(77476),Ie=["input"],Z=0,X=function(y,w){this.source=y,this.value=w},q={provide:h.JU,useExisting:(0,S.forwardRef)(function(){return Ze}),multi:!0},te=new S.InjectionToken("MatRadioGroup"),le=new S.InjectionToken("mat-radio-default-options",{providedIn:"root",factory:function(){return{color:"accent"}}}),xe=function(){var P=y.prototype;function y(w){this._changeDetector=w,this._value=null,this._name="mat-radio-group-"+Z++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=function(){},this.onTouched=function(){},this.change=new S.EventEmitter}return P._checkSelectedRadioButton=function(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)},P.ngAfterContentInit=function(){var T=this;this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(function(){T.selected&&!T._radios.find(function(I){return I===T.selected})&&(T._selected=null)})},P.ngOnDestroy=function(){var T;null==(T=this._buttonChanges)||T.unsubscribe()},P._touch=function(){this.onTouched&&this.onTouched()},P._updateRadioButtonNames=function(){var T=this;this._radios&&this._radios.forEach(function(I){I.name=T.name,I._markForCheck()})},P._updateSelectedRadioFromValue=function(){var T=this;this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(function(x){x.checked=T.value===x.value,x.checked&&(T._selected=x)}))},P._emitChangeEvent=function(){this._isInitialized&&this.change.emit(new X(this._selected,this._value))},P._markRadiosForCheck=function(){this._radios&&this._radios.forEach(function(T){return T._markForCheck()})},P.writeValue=function(T){this.value=T,this._changeDetector.markForCheck()},P.registerOnChange=function(T){this._controlValueAccessorChangeFn=T},P.registerOnTouched=function(T){this.onTouched=T},P.setDisabledState=function(T){this.disabled=T,this._changeDetector.markForCheck()},(0,Re.Z)(y,[{key:"name",get:function(){return this._name},set:function(T){this._name=T,this._updateRadioButtonNames()}},{key:"labelPosition",get:function(){return this._labelPosition},set:function(T){this._labelPosition="before"===T?"before":"after",this._markRadiosForCheck()}},{key:"value",get:function(){return this._value},set:function(T){this._value!==T&&(this._value=T,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}},{key:"selected",get:function(){return this._selected},set:function(T){this._selected=T,this.value=T?T.value:null,this._checkSelectedRadioButton()}},{key:"disabled",get:function(){return this._disabled},set:function(T){this._disabled=(0,Le.Ig)(T),this._markRadiosForCheck()}},{key:"required",get:function(){return this._required},set:function(T){this._required=(0,Le.Ig)(T),this._markRadiosForCheck()}}]),y}();(ee=xe).\u0275fac=function(y){return new(y||ee)(S.\u0275\u0275directiveInject(S.ChangeDetectorRef))},ee.\u0275dir=S.\u0275\u0275defineDirective({type:ee,inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required"},outputs:{change:"change"}});var ze=function(P){function y(T,I,x,s,J,Oe,Me,ut){var we;return(we=P.call(this,I)||this)._changeDetector=x,we._focusMonitor=s,we._radioDispatcher=J,we._providerOverride=Me,we._uniqueId="mat-radio-"+ ++Z,we.id=we._uniqueId,we.change=new S.EventEmitter,we._checked=!1,we._value=null,we._removeUniqueSelectionListener=function(){},we.radioGroup=T,we._noopAnimations="NoopAnimations"===Oe,ut&&(we.tabIndex=(0,Le.su)(ut,0)),we}(0,fe.Z)(y,P);var w=y.prototype;return w.focus=function(I,x){x?this._focusMonitor.focusVia(this._inputElement,x,I):this._inputElement.nativeElement.focus(I)},w._markForCheck=function(){this._changeDetector.markForCheck()},w.ngOnInit=function(){var I=this;this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen(function(x,s){x!==I.id&&s===I.name&&(I.checked=!1)})},w.ngDoCheck=function(){this._updateTabIndex()},w.ngAfterViewInit=function(){var I=this;this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(function(x){!x&&I.radioGroup&&I.radioGroup._touch()})},w.ngOnDestroy=function(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()},w._emitChangeEvent=function(){this.change.emit(new X(this,this._value))},w._isRippleDisabled=function(){return this.disableRipple||this.disabled},w._onInputClick=function(I){I.stopPropagation()},w._onInputInteraction=function(I){if(I.stopPropagation(),!this.checked&&!this.disabled){var x=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),x&&this.radioGroup._emitChangeEvent())}},w._onTouchTargetClick=function(I){this._onInputInteraction(I),this.disabled||this._inputElement.nativeElement.focus()},w._setDisabled=function(I){this._disabled!==I&&(this._disabled=I,this._changeDetector.markForCheck())},w._updateTabIndex=function(){var x,I=this.radioGroup;if((x=I&&I.selected&&!this.disabled?I.selected===this?this.tabIndex:-1:this.tabIndex)!==this._previousTabIndex){var s,J=null==(s=this._inputElement)?void 0:s.nativeElement;J&&(J.setAttribute("tabindex",x+""),this._previousTabIndex=x)}},(0,Re.Z)(y,[{key:"checked",get:function(){return this._checked},set:function(I){var x=(0,Le.Ig)(I);this._checked!==x&&(this._checked=x,x&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!x&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),x&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}},{key:"value",get:function(){return this._value},set:function(I){this._value!==I&&(this._value=I,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===I),this.checked&&(this.radioGroup.selected=this)))}},{key:"labelPosition",get:function(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"},set:function(I){this._labelPosition=I}},{key:"disabled",get:function(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled},set:function(I){this._setDisabled((0,Le.Ig)(I))}},{key:"required",get:function(){return this._required||this.radioGroup&&this.radioGroup.required},set:function(I){this._required=(0,Le.Ig)(I)}},{key:"color",get:function(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"},set:function(I){this._color=I}},{key:"inputId",get:function(){return(this.id||this._uniqueId)+"-input"}}]),y}((0,$.Kr)((0,$.sb)(function(y){this._elementRef=y})));(b=ze).\u0275fac=function(y){S.\u0275\u0275invalidFactory()},b.\u0275dir=S.\u0275\u0275defineDirective({type:b,viewQuery:function(y,w){var T;1&y&&S.\u0275\u0275viewQuery(Ie,5),2&y&&S.\u0275\u0275queryRefresh(T=S.\u0275\u0275loadQuery())&&(w._inputElement=T.first)},inputs:{id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"},features:[S.\u0275\u0275InheritDefinitionFeature]});var Ze=function(P){function y(){return P.apply(this,arguments)||this}return(0,fe.Z)(y,P),y}(xe);(pe=Ze).\u0275fac=function(){var P;return function(w){return(P||(P=S.\u0275\u0275getInheritedFactory(pe)))(w||pe)}}(),pe.\u0275dir=S.\u0275\u0275defineDirective({type:pe,selectors:[["mat-radio-group"]],contentQueries:function(y,w,T){var I;1&y&&S.\u0275\u0275contentQuery(T,U,5),2&y&&S.\u0275\u0275queryRefresh(I=S.\u0275\u0275loadQuery())&&(w._radios=I)},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],exportAs:["matRadioGroup"],features:[S.\u0275\u0275ProvidersFeature([q,{provide:te,useExisting:pe}]),S.\u0275\u0275InheritDefinitionFeature]});var U=function(P){function y(w,T,I,x,s,J,Oe,Me){return P.call(this,w,T,I,x,s,J,Oe,Me)||this}return(0,fe.Z)(y,P),y}(ze);(Q=U).\u0275fac=function(y){return new(y||Q)(S.\u0275\u0275directiveInject(te,8),S.\u0275\u0275directiveInject(S.ElementRef),S.\u0275\u0275directiveInject(S.ChangeDetectorRef),S.\u0275\u0275directiveInject(z.tE),S.\u0275\u0275directiveInject(ue.A8),S.\u0275\u0275directiveInject(S.ANIMATION_MODULE_TYPE,8),S.\u0275\u0275directiveInject(le,8),S.\u0275\u0275injectAttribute("tabindex"))},Q.\u0275cmp=S.\u0275\u0275defineComponent({type:Q,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(y,w){1&y&&S.\u0275\u0275listener("focus",function(){return w._inputElement.nativeElement.focus()}),2&y&&(S.\u0275\u0275attribute("id",w.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),S.\u0275\u0275classProp("mat-primary","primary"===w.color)("mat-accent","accent"===w.color)("mat-warn","warn"===w.color)("mat-mdc-radio-checked",w.checked)("_mat-animation-noopable",w._noopAnimations))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[S.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:13,vars:17,consts:[[1,"mdc-form-field"],["formField",""],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"id","checked","disabled","required","change"],["input",""],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(y,w){if(1&y&&(S.\u0275\u0275projectionDef(),S.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2)(3,"div",3),S.\u0275\u0275listener("click",function(x){return w._onTouchTargetClick(x)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"input",4,5),S.\u0275\u0275listener("change",function(x){return w._onInputInteraction(x)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"div",6),S.\u0275\u0275element(7,"div",7)(8,"div",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"div",9),S.\u0275\u0275element(10,"div",10),S.\u0275\u0275elementEnd()(),S.\u0275\u0275elementStart(11,"label",11),S.\u0275\u0275projection(12),S.\u0275\u0275elementEnd()()),2&y){var T=S.\u0275\u0275reference(1);S.\u0275\u0275classProp("mdc-form-field--align-end","before"==w.labelPosition),S.\u0275\u0275advance(2),S.\u0275\u0275classProp("mdc-radio--disabled",w.disabled),S.\u0275\u0275advance(2),S.\u0275\u0275property("id",w.inputId)("checked",w.checked)("disabled",w.disabled)("required",w.required),S.\u0275\u0275attribute("name",w.name)("value",w.value)("aria-label",w.ariaLabel)("aria-labelledby",w.ariaLabelledby)("aria-describedby",w.ariaDescribedby),S.\u0275\u0275advance(5),S.\u0275\u0275property("matRippleTrigger",T)("matRippleDisabled",w._isRippleDisabled())("matRippleCentered",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("for",w.inputId)}},dependencies:[$.wG],styles:['.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio[hidden]{display:none}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mat-mdc-radio-button{--mdc-radio-disabled-selected-icon-opacity:0.38;--mdc-radio-disabled-unselected-icon-opacity:0.38;--mdc-radio-state-layer-size:40px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{padding:calc((var(--mdc-radio-state-layer-size) - 20px) / 2)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{top:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);left:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control{top:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);right:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);left:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}[dir=rtl] .mat-mdc-radio-touch-target{left:0;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0}),(m=function(){}).\u0275fac=function(y){return new(y||m)},m.\u0275mod=S.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=S.\u0275\u0275defineInjector({imports:[$.BQ,ge.CommonModule,$.si,$.BQ]});var Ae,ot,Je,Pe=function(y){return{enterDuration:y}},ht={provide:h.JU,useExisting:(0,S.forwardRef)(function(){return lt}),multi:!0},lt=function(P){function y(){return P.apply(this,arguments)||this}return(0,fe.Z)(y,P),y}(xe);(Ae=lt).\u0275fac=function(){var P;return function(w){return(P||(P=S.\u0275\u0275getInheritedFactory(Ae)))(w||Ae)}}(),Ae.\u0275dir=S.\u0275\u0275defineDirective({type:Ae,selectors:[["mat-radio-group"]],contentQueries:function(y,w,T){var I;1&y&&S.\u0275\u0275contentQuery(T,V,5),2&y&&S.\u0275\u0275queryRefresh(I=S.\u0275\u0275loadQuery())&&(w._radios=I)},hostAttrs:["role","radiogroup",1,"mat-radio-group"],exportAs:["matRadioGroup"],features:[S.\u0275\u0275ProvidersFeature([ht,{provide:te,useExisting:Ae}]),S.\u0275\u0275InheritDefinitionFeature]});var V=function(P){function y(w,T,I,x,s,J,Oe,Me){return P.call(this,w,T,I,x,s,J,Oe,Me)||this}return(0,fe.Z)(y,P),y}(ze);(ot=V).\u0275fac=function(y){return new(y||ot)(S.\u0275\u0275directiveInject(te,8),S.\u0275\u0275directiveInject(S.ElementRef),S.\u0275\u0275directiveInject(S.ChangeDetectorRef),S.\u0275\u0275directiveInject(z.tE),S.\u0275\u0275directiveInject(ue.A8),S.\u0275\u0275directiveInject(S.ANIMATION_MODULE_TYPE,8),S.\u0275\u0275directiveInject(le,8),S.\u0275\u0275injectAttribute("tabindex"))},ot.\u0275cmp=S.\u0275\u0275defineComponent({type:ot,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-radio-button"],hostVars:17,hostBindings:function(y,w){1&y&&S.\u0275\u0275listener("focus",function(){return w._inputElement.nativeElement.focus()}),2&y&&(S.\u0275\u0275attribute("tabindex",null)("id",w.id)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),S.\u0275\u0275classProp("mat-radio-checked",w.checked)("mat-radio-disabled",w.disabled)("_mat-animation-noopable",w._noopAnimations)("mat-primary","primary"===w.color)("mat-accent","accent"===w.color)("mat-warn","warn"===w.color))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[S.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:13,vars:19,consts:[[1,"mat-radio-label"],["label",""],[1,"mat-radio-container"],[1,"mat-radio-outer-circle"],[1,"mat-radio-inner-circle"],["type","radio",1,"mat-radio-input",3,"id","checked","disabled","required","change","click"],["input",""],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mat-radio-label-content"],[2,"display","none"]],template:function(y,w){if(1&y&&(S.\u0275\u0275projectionDef(),S.\u0275\u0275elementStart(0,"label",0,1)(2,"span",2),S.\u0275\u0275element(3,"span",3)(4,"span",4),S.\u0275\u0275elementStart(5,"input",5,6),S.\u0275\u0275listener("change",function(x){return w._onInputInteraction(x)})("click",function(x){return w._onInputClick(x)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"span",7),S.\u0275\u0275element(8,"span",8),S.\u0275\u0275elementEnd()(),S.\u0275\u0275elementStart(9,"span",9)(10,"span",10),S.\u0275\u0275text(11,"\xa0"),S.\u0275\u0275elementEnd(),S.\u0275\u0275projection(12),S.\u0275\u0275elementEnd()()),2&y){var T=S.\u0275\u0275reference(1);S.\u0275\u0275attribute("for",w.inputId),S.\u0275\u0275advance(5),S.\u0275\u0275property("id",w.inputId)("checked",w.checked)("disabled",w.disabled)("required",w.required),S.\u0275\u0275attribute("name",w.name)("value",w.value)("aria-label",w.ariaLabel)("aria-labelledby",w.ariaLabelledby)("aria-describedby",w.ariaDescribedby),S.\u0275\u0275advance(2),S.\u0275\u0275property("matRippleTrigger",T)("matRippleDisabled",w._isRippleDisabled())("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",S.\u0275\u0275pureFunction1(17,Pe,w._noopAnimations?0:150)),S.\u0275\u0275advance(2),S.\u0275\u0275classProp("mat-radio-label-before","before"==w.labelPosition)}},dependencies:[$.wG],styles:['.mat-radio-button{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-radio-label{-webkit-user-select:none;user-select:none;cursor:pointer;display:inline-flex;align-items:center;white-space:nowrap;vertical-align:middle;width:100%}.mat-radio-container{box-sizing:border-box;display:inline-block;position:relative;width:20px;height:20px;flex-shrink:0}.mat-radio-outer-circle{box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;transition:border-color ease 280ms;width:20px;border-width:2px;border-style:solid;border-radius:50%}._mat-animation-noopable .mat-radio-outer-circle{transition:none}.mat-radio-inner-circle{border-radius:50%;box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;opacity:0;transition:transform ease 280ms,background-color ease 280ms,opacity linear 1ms 280ms;width:20px;transform:scale(0.001);-webkit-print-color-adjust:exact;color-adjust:exact}.mat-radio-checked .mat-radio-inner-circle{transform:scale(0.5);opacity:1;transition:transform ease 280ms,background-color ease 280ms}.cdk-high-contrast-active .mat-radio-checked .mat-radio-inner-circle{border:solid 10px}._mat-animation-noopable .mat-radio-inner-circle{transition:none}.mat-radio-label-content{-webkit-user-select:auto;user-select:auto;display:inline-block;order:0;line-height:inherit;padding-left:8px;padding-right:0}[dir=rtl] .mat-radio-label-content{padding-right:8px;padding-left:0}.mat-radio-label-content.mat-radio-label-before{order:-1;padding-left:0;padding-right:8px}[dir=rtl] .mat-radio-label-content.mat-radio-label-before{padding-right:0;padding-left:8px}.mat-radio-disabled,.mat-radio-disabled .mat-radio-label{cursor:default}.mat-radio-button .mat-radio-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-radio-button .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple){opacity:.16}.mat-radio-persistent-ripple{width:100%;height:100%;transform:none;top:0;left:0}.mat-radio-container:hover .mat-radio-persistent-ripple{opacity:.04}.mat-radio-button:not(.mat-radio-disabled).cdk-keyboard-focused .mat-radio-persistent-ripple,.mat-radio-button:not(.mat-radio-disabled).cdk-program-focused .mat-radio-persistent-ripple{opacity:.12}.mat-radio-persistent-ripple,.mat-radio-disabled .mat-radio-container:hover .mat-radio-persistent-ripple{opacity:0}@media(hover: none){.mat-radio-container:hover .mat-radio-persistent-ripple{display:none}}.mat-radio-input{opacity:0;position:absolute;top:0;left:0;margin:0;width:100%;height:100%;cursor:inherit;z-index:-1}.mat-radio-input:focus~.mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-radio-disabled{opacity:.5}'],encapsulation:2,changeDetection:0});var R=function(){};(Je=R).\u0275fac=function(y){return new(y||Je)},Je.\u0275mod=S.\u0275\u0275defineNgModule({type:Je}),Je.\u0275inj=S.\u0275\u0275defineInjector({imports:[$.si,$.BQ,$.BQ]})}}]);