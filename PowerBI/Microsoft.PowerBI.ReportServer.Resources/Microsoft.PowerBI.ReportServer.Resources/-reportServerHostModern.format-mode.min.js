"use strict";(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["format-mode"],{87644:function(ve,W,u){u.d(W,{VO:function(){return A},Vj:function(){return F},ub:function(){return l}});var l="formattingService",A="formattingUIService",F=A},21302:function(ve,W,u){u.d(W,{Ol:function(){return F},mF:function(){return A},sn:function(){return l}});var B=u(50423),l={type:3,name:"showFormatPane"},A={type:3,name:"showPageFormatPane"},F=new B.InjectionToken("PropertyChangeIndicatorService")},92755:function(ve,W,u){u.d(W,{cY:function(){return ce},ks:function(){return U}});var B=u(81337),l=u(11547),A=u(59017),F=u(14172),j=u(32379),e=u(61617);function U(ne,J,q,le,Q,Y,ee){return{objectName:J.objectName,uid:q,formattingSource:le,hasDynamicExpressionSupport:ee?.isSet,canvasItems:Q,propertySlice:{name:J.propertyName,value:ne,type:J.type,selector:J.selector,altConstantValueSelector:J.altConstantValueSelector},conditionalFormatting:!!ee,visualUpdateSource:Y}}function ce(ne,J,q){void 0===q&&(q=[]);for(var le=[],Q=function(de){var he=(0,l.of)([]),ie=(0,l.of)([]),oe=de;oe&&q.some(function(E){return E.objectName===oe.objectName&&(0,j.fS)(E.selector,oe.selector)&&E.propertyName===oe.propertyName})||!oe||(he=ne.selectTopLevelToggle(de).pipe((0,F.U)(function(E){return E?[(0,B.pi)((0,B.pi)({},E.control.properties.descriptor),{originSource:E.originSource})]:[]})),ie=ne.selectSlice(de).pipe((0,F.U)(function(E){return E?(0,e.i6)(E).map(function(re){return(0,B.pi)((0,B.pi)({},re),{originSource:E.originSource})}):[]}))),le.push((0,A.aj)([he,ie]).pipe((0,F.U)(function(E){var R;return null!==(R=_.find(E,function(z){return!_.isEmpty(z)}))&&void 0!==R?R:[]})))},Y=0,ee=J;Y<ee.length;Y++)Q(ee[Y]);return(0,A.aj)(le).pipe((0,F.U)(function(ue){return _.flatten(ue)}))}},89535:function(ve,W,u){u.d(W,{Kj:function(){return F},YR:function(){return e},lD:function(){return A},r4:function(){return j},y5:function(){return U}});var B=u(19650),l=u(50423),A=function(){return function(J,q){this.value=J,this.equals=q}}(),F=new l.InjectionToken("SliceCustomizationService"),j=6,e=60,U={left:B.H.left,center:B.H.center,right:B.H.right,Auto:B.H.auto}},63205:function(ve,W,u){u.r(W),u.d(W,{FormatModeModule:function(){return mi}});var B=u(43626),l=u(81337),A=u(73221),F=u(59017),j=u(14172),e=u(50423),U=u(77476),se=u(69437);function ce(a,o){if(1&a&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"stop")),2&a){var t=o.$implicit,n=o.index,i=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275attribute("stop-color",t)("offset",n*(100/(i.colors.length-1))+"%")}}function ne(a,o){if(1&a&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",3)(1,"defs")(2,"linearGradient",4),e.\u0275\u0275template(3,ce,1,2,"stop",5),e.\u0275\u0275elementEnd()()()),2&a){var t=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(2),e.\u0275\u0275property("id",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.colors)}}var J=function(o){return{fill:o}},q=function(o,t){return{full:o,compact:t}};function le(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,ne,4,2,"svg",1),e.\u0275\u0275element(2,"pbi-office-icon",2),e.\u0275\u0275elementEnd()),2&a){var t=o.ngIf,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.colors.length>1),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",n.iconName)("disabled",n.disabled)("ngStyle",e.\u0275\u0275pureFunction1(5,J,t.reference))("ngClass",e.\u0275\u0275pureFunction2(7,q,n.iconMode===n.iconModeEnum.Full,n.iconMode===n.iconModeEnum.Compact))}}var Q=function(a){return a[a.Full=0]="Full",a[a.Compact=1]="Compact",a}({}),Y=function(a){function o(){var t=null!==a&&a.apply(this,arguments)||this;return t.iconModeEnum=Q,t}return(0,l.ZT)(o,a),o.prototype.ngOnInit=function(){this.gradientId$=this.changes$("iconColors").pipe((0,j.U)(function(t){return function(a){if(a&&!_.isEmpty(a)){if(a.length>1){for(var o="",t=0;t<a.length;t++){var n=a[t];/#/g.test(n)?o+=n.replace(/#/g,""):/^rgb/gi.test(n)&&(o+=ge(n)),t<a.length-1&&(o+="-")}return o}if(o=_.first(a))return/^rgb/gi.test(o)&&(o="#".concat(ge(o))),o}return""}(t)})),this.fillColorProperties$=(0,F.aj)([this.gradientId$,this.changes$("iconColors")]).pipe((0,j.U)(function(t){var n=t[0],i=t[1];return{id:n,colors:i??[],reference:i&&i.length>1?"url(#".concat(n,")"):"".concat(n)}}))},o.\u0275fac=function(){var t;return function(i){return(t||(t=e.\u0275\u0275getInheritedFactory(o)))(i||o)}}(),o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar-cf-gradient-icon"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",iconMode:"iconMode"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],["class","cf-gradient-container",4,"ngIf"],[3,"name","disabled","ngStyle","ngClass"],[1,"cf-gradient-container"],[3,"id"],[4,"ngFor","ngForOf"]],template:function(n,i){1&n&&(e.\u0275\u0275template(0,le,3,10,"div",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.fillColorProperties$))},dependencies:[U.NgClass,U.NgForOf,U.NgIf,U.NgStyle,se.m,U.AsyncPipe],styles:[".cf-gradient-container[_ngcontent-%COMP%]{height:0;width:0}pbi-office-icon.full[_ngcontent-%COMP%]{padding-right:1px;width:24px;height:20px}pbi-office-icon.compact[_ngcontent-%COMP%]{width:20px;height:20px}"],changeDetection:0}),o}(A.w);function ge(a){var t="",n=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/.exec(a);return n&&(t=(16777216+(ue(n[1],!!n[2])<<16)+(ue(n[3],!!n[4])<<8)+ue(n[5],!!n[6])).toString(16).slice(1)),t}function ue(a,o){var t=Math.max(0,parseInt(a,10));return o?Math.floor(255*Math.min(100,t)/100):Math.min(255,t)}var de=u(36858),he=function(a){function o(){var t=null!==a&&a.apply(this,arguments)||this;return t.clicked=new e.EventEmitter,t.ready=new e.EventEmitter,t.iconModeEnum=Q,t}return(0,l.ZT)(o,a),o.prototype.ngAfterViewInit=function(){this.ready.emit()},o.\u0275fac=function(){var t;return function(i){return(t||(t=e.\u0275\u0275getInheritedFactory(o)))(i||o)}}(),o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar-large-button"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",label:"label",title:"title",ariaHasPopup:"ariaHasPopup"},outputs:{clicked:"clicked",ready:"ready"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:6,vars:10,consts:[["data-automation-type","mini-toolbar-button",1,"mini-toolbar-button","mini-toolbar-large-button",3,"disabled","pbiTooltip","click"],[1,"icon-container"],[3,"disabled","iconName","iconColors","iconMode"],["name","CommonControlChevronDown_12",1,"chevron",3,"disabled"],[1,"label"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(s){return i.clicked.emit(s)}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275element(2,"mini-toolbar-cf-gradient-icon",2)(3,"pbi-office-icon",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("disabled",i.disabled)("pbiTooltip",i.title),e.\u0275\u0275attribute("aria-label",i.label)("aria-haspopup",i.ariaHasPopup),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",i.disabled)("iconName",i.iconName)("iconColors",i.iconColors)("iconMode",i.iconModeEnum.Full),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",i.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.label))},dependencies:[se.m,de.V,Y],styles:['.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]{background:none;border:none;box-sizing:border-box;--buttonBackgroundSelected: var(--gray-40);--buttonColorSelected: var(--gray-180);flex:none;--buttonBackgroundHover: var(--gray-30);--buttonBackgroundSelectedHover: var(--gray-50);--buttonColorHover: var(--gray-180);display:flex;flex-direction:column;align-items:center;width:58px;height:60px;padding:5px 10px 8px}[data-legacy-theming=false][_ngcontent-%COMP%]   .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]{--buttonBackgroundSelected: var(--colorNeutralBackground1Selected);--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorSelected: var(--colorNeutralForeground1Selected);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:not(:focus-visible), .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active:not(:focus-visible){border:none}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active:not(:disabled):not([disabled]):not(.disabled), .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:active:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundSelectedHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button.ql-active[_ngcontent-%COMP%]:not(:hover):not(:active), .mini-toolbar-button.mini-toolbar-large-button.selected[_ngcontent-%COMP%]:not(:hover):not(:active){background-color:var(--buttonBackgroundSelected);color:var(--buttonColorSelected)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:focus-visible{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:disabled, .mini-toolbar-button.mini-toolbar-large-button[disabled][_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button.disabled[_ngcontent-%COMP%]{background:none;color:var(--gray-90)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:disabled   .icon[_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button[disabled][_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button.disabled[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:40%}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}  [data-legacy-theming=false] .mini-toolbar-button.mini-toolbar-large-button{--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover, .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active, .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:active{background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;align-self:flex-start;flex-grow:1}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{padding-left:1px;width:12px}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;flex:none;width:inherit}'],changeDetection:0}),o}(A.w),ie=u(17174),oe=u(81905),D=u(22318),C=u(83317),M=u(6181),E=u(57243),R=u(87644),z=u(64560),re=u(86286),ae=u(9215),pe=u(21728),Pe=u(71286),St=u(52083),Ct=u(19650),V=u(62458),xt=u(5265),Mt=u(94419),be=u(74082),_t=u(58702),We=u(80777),ye=u(89535),It=u(58609),Je=u(29748),xe=u(28894),wt=u(84281),Tt=u(38561);function Et(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-menu-container",2),e.\u0275\u0275listener("menuButtonClick",function(r){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.executeMenuItem(r))}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("menu",n.menuFactoryObservable)("menuMode",n.menuMode)}}function Ot(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Et,1,2,"pbi-menu-container",1),e.\u0275\u0275elementContainerEnd()),2&a){var t=o.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.items&&t.items.length>0)}}function Pt(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ot,2,1,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,t.menu$))}}var De=function(a){function o(t,n,i,r){var s=a.call(this)||this;return s.changeDetectorRef=t,s.contextActivityService=n,s.lazyScoped=i,s.undoRedo=r,s.onExecuteContextMenuAction=new e.EventEmitter,s.menuMode=z.Kb.Full,s.menuFactoryObservable=function(){return s.menu$},s}return(0,l.ZT)(o,a),o.prototype.ngOnInit=function(){var t=this;Promise.all([this.lazyScoped.get(R.ub),this.lazyScoped.get(R.Vj)]).then(function(n){var r=n[1];t.formattingService=n[0];var c=t.changes$("subSelectionUpdateArgs").pipe((0,M.j)("canvasItem"),(0,j.U)(function(d){return d?[d]:void 0})).pipe((0,oe.w)(function(d){return d?r.getSubSelectionStyleShortcutsForCanvasItems$(d):r.getSubSelectionStyleShortcutsForNonCanvasItems$(t.subSelectionShortcuts)}));t.menu$=t.changes$("menuInput$",!0).pipe((0,oe.w)(function(d){return d||c})),t.changeDetectorRef.detectChanges()})},o.prototype.executeMenuItem=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:switch((n=t.data).type){case 0:return[3,1];case 1:return[3,3];case 2:return[3,5];case 3:return[3,7];case 4:return[3,9];case 6:return[3,11];case 5:return[3,13];case 9:return[3,14]}return[3,16];case 1:return[4,this.executeResetShortcut(n)];case 2:case 4:case 6:case 8:case 10:case 12:case 15:return r.sent(),[3,16];case 3:return[4,this.executeNavigateShortcut(n)];case 5:return[4,this.executeToggleShortcut(n)];case 7:return[4,this.executePickerShortcut(n)];case 9:return[4,this.executeSortShortcut(n,t.checked)];case 11:return[4,this.executeConditionalFormattingShortcut(n)];case 13:return this.executeCustomActionShortcut(n),[3,16];case 14:return[4,this.executeSetValueShortcut(n)];case 16:return this.onExecuteContextMenuAction.emit(),[2]}})})},o.prototype.executeResetShortcut=function(t){var n,r,s,i=this;V.fF.assert(function(){return!!i.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executePickerShortcut");var v,c=(n=this.subSelectionUpdateArgs).canvasItem,p=null===(s=null===(r=n.subSelections[0])||void 0===r?void 0:r.visualSubSelection.visualObjects[0])||void 0===s?void 0:s.objectName,m=(0,It.hF)(this.contextActivityService,{name:"Revert To Default",visualName:c.name,data:{objectName:p,source:"ContextMenu",contextMenuType:"Visual"}}),h=this.subSelectionShortcuts.find(function(I){return 4===I.type}),f={type:0,revertToDefaultDescriptors:t.revertToDefaultDescriptors,resetSortRoleKey:h?.key,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}};return this.undoRedo.register("reset shortcuts",function(){v=i.getFormatModeService().then(function(I){return I.executeShortcut([{canvasItem:c,shortcut:f}],m)}).then(function(){return m.resolve()}).catch(function(I){throw m.reject(I),I})}),v},o.prototype.executeNavigateShortcut=function(t){var n;return(0,l.mG)(this,void 0,void 0,function(){var i,r;return(0,l.Jh)(this,function(s){switch(s.label){case 0:return(i=t.shortcut).togglePaneVisibility=!0,[4,this.getFormatModeService()];case 1:return r=s.sent(),this.contextActivityService.createActivity({name:"ExecuteNavigateShortcut",data:{source:"ContextMenu",contextMenuType:"Visual"}}).resolve(),[2,r.executeShortcut([{canvasItem:null===(n=this.subSelectionUpdateArgs)||void 0===n?void 0:n.canvasItem,shortcut:i}])]}})})},o.prototype.executeToggleShortcut=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,s=this;return(0,l.Jh)(this,function(c){switch(c.label){case 0:return n=t.shortcut,V.fF.assert(function(){return!!s.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeToggleShortcut"),i=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,c.sent().executeShortcut([{canvasItem:i,shortcut:n}])]}})})},o.prototype.executeConditionalFormattingShortcut=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,s=this;return(0,l.Jh)(this,function(c){switch(c.label){case 0:return n=t.shortcut,V.fF.assert(function(){return!!s.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeConditionalFormattingShortcut"),i=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,c.sent().executeShortcut([{canvasItem:i,shortcut:n}])]}})})},o.prototype.executePickerShortcut=function(t){return(0,l.mG)(this,void 0,void 0,function(){var c,d,m,h=this;return(0,l.Jh)(this,function(f){switch(f.label){case 0:return V.fF.assert(function(){return!!h.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executePickerShortcut"),c={type:3,index:t.index,objectName:(m=t.shortcut).objectName,propertyName:m.propertyName,selector:m.selector,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},d=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,f.sent().executeShortcut([{canvasItem:d,shortcut:c}])]}})})},o.prototype.executeSortShortcut=function(t,n){return(0,l.mG)(this,void 0,void 0,function(){var i,r,c=this;return(0,l.Jh)(this,function(d){switch(d.label){case 0:return V.fF.assert(function(){return!!c.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeSortShortcut"),i=this.subSelectionUpdateArgs.canvasItem,r=t.isSortField&&n?{type:0,resetSortRoleKey:t.sortGroup.key,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}}:{type:4,sortableField:{queryName:t.sortField.exprs[0].name,sortDirection:t.sortDirection},key:t.sortGroup.key},[4,this.getFormatModeService()];case 1:return[2,d.sent().executeShortcut([{canvasItem:i,shortcut:r}])]}})})},o.prototype.executeCustomActionShortcut=function(t){t.shortcut.customAction()},o.prototype.executeSetValueShortcut=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i;return(0,l.Jh)(this,function(s){switch(s.label){case 0:return n=this.subSelectionUpdateArgs.canvasItem,i={type:9,referencesAndValues:t.shortcut.referencesAndValues,icon:t.shortcut.icon,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},[4,this.getFormatModeService()];case 1:return[2,s.sent().executeShortcut([{canvasItem:n,shortcut:i}])]}})})},o.prototype.getFormatModeService=function(){return this.formatModeServicePromise||(this.formatModeServicePromise=this.lazyScoped.get("formatModeService")),this.formatModeServicePromise},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Je.r),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(wt.z))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["on-object-context-menu"]],hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","on-object-context-menu")},inputs:{subSelectionUpdateArgs:"subSelectionUpdateArgs",subSelectionStyles:"subSelectionStyles",subSelectionShortcuts:"subSelectionShortcuts",menuInput$:"menuInput$"},outputs:{onExecuteContextMenuAction:"onExecuteContextMenuAction"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],["class","menu-container",3,"menu","menuMode","menuButtonClick",4,"ngIf"],[1,"menu-container",3,"menu","menuMode","menuButtonClick"]],template:function(n,i){1&n&&e.\u0275\u0275template(0,Pt,3,3,"ng-container",0),2&n&&e.\u0275\u0275property("ngIf",i.formattingService)},dependencies:[U.NgIf,Tt.m,U.AsyncPipe],encapsulation:2,changeDetection:0}),o}(A.w),Dt=function(){function a(o){this.overlayData=o}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(re.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-context-menu"]],decls:1,vars:4,consts:[[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","menuInput$","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"on-object-context-menu",0),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){return n.overlayData.closeOverlays()}),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("subSelectionUpdateArgs",n.overlayData.subSelectionUpdateArgs)("subSelectionStyles",n.overlayData.subSelectionStyles)("subSelectionShortcuts",n.overlayData.subSelectionShortcuts)("menuInput$",n.overlayData.menuInput$)},dependencies:[De],encapsulation:2,changeDetection:0}),a}(),Ft=u(14335),Ut=function(){function a(o){this.data=o,this.warning=this.data}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(Ft.HK))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-warning"]],decls:2,vars:2,consts:[[1,"warning-tooltip-title",3,"textContent"],[3,"textContent"]],template:function(t,n){1&t&&e.\u0275\u0275element(0,"div",0)(1,"div",1),2&t&&(e.\u0275\u0275property("textContent",n.warning.title),e.\u0275\u0275advance(1),e.\u0275\u0275property("textContent",n.warning.detail))},styles:[".warning-tooltip-title[_ngcontent-%COMP%]{font-weight:var(--font-weight-bold)}"],changeDetection:0}),a}(),Vt=function(o){return{fill:o}};function jt(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(1,"svg",2),e.\u0275\u0275element(2,"path",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(1,Vt,t.iconColor))}}var kt=function(o,t,n){return{toggled:o,narrow:t,disabled:n}},At=function(){function a(){}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-icon"]],inputs:{iconType:"iconType",iconColor:"iconColor",iconToggled:"iconToggled",iconNarrow:"iconNarrow",iconDisabled:"iconDisabled"},decls:2,vars:6,consts:[[1,"container",3,"ngClass"],[4,"ngIf"],["height","100%","width","100%","viewBox","0,0,2048,2048","focusable","false",3,"ngStyle"],["d","M1472 0l576 576L576 2048 0 1472 1472 0zM181 1472l395 395L1867 576l-395-395-88 88 115 115-91 91-115-115-165 165 197 198-90 90-198-197-165 165 115 116-90 90-116-115-165 165 197 198-90 90-198-197-165 165 115 115-91 91-115-115-88 88z"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,jt,3,3,"ng-container",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,kt,n.iconToggled,n.iconNarrow,n.iconDisabled)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","DisplayUnits"===n.iconType))},dependencies:[U.NgClass,U.NgIf,U.NgStyle],styles:["svg[_ngcontent-%COMP%]   path.iconFillTransparent[_ngcontent-%COMP%]{fill:transparent}svg[_ngcontent-%COMP%]   path.iconFillInherit[_ngcontent-%COMP%]{fill:inherit}svg[_ngcontent-%COMP%]   path.iconFill1[_ngcontent-%COMP%]{fill:#fafafa}svg[_ngcontent-%COMP%]   path.iconFill2[_ngcontent-%COMP%]{fill:#c8c6c4}svg[_ngcontent-%COMP%]   path.iconFill3[_ngcontent-%COMP%]{fill:#3a3a38}svg[_ngcontent-%COMP%]   path.iconFill4[_ngcontent-%COMP%]{fill:#1e8bcd}svg[_ngcontent-%COMP%]   path.iconFill5[_ngcontent-%COMP%]{fill:#0063b1}svg[_ngcontent-%COMP%]   path.iconFill6[_ngcontent-%COMP%]{fill:#83beec}svg[_ngcontent-%COMP%]   path.iconFill7[_ngcontent-%COMP%]{fill:#252423}svg[_ngcontent-%COMP%]   path.iconFillWhite[_ngcontent-%COMP%]{fill:#fff}.toggled[_ngcontent-%COMP%]{background-color:#d3d3d3}.container[_ngcontent-%COMP%]{width:20px;height:20px;display:inline-block}.container.narrow[_ngcontent-%COMP%]{width:10px}.container.disabled[_ngcontent-%COMP%]{opacity:.2}"],changeDetection:0}),a}();function Nt(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar-icon",4),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("iconType",t.iconName)}}function Bt(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar-cf-gradient-icon",5),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",t.disabled)("iconName",t.iconName)("iconColors",t.iconColors)("iconMode",t.iconModeEnum.Compact)}}function Rt(a,o){1&a&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275element(1,"pbi-office-icon",7),e.\u0275\u0275elementEnd())}var Qe=function(){function a(){this.customIcon=!1,this.showChevron=!1,this.clicked=new e.EventEmitter,this.iconModeEnum=Q}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-button"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",selected:"selected",customIcon:"customIcon",showChevron:"showChevron",ariaLabel:"ariaLabel",ariaHasPopup:"ariaHasPopup"},outputs:{clicked:"clicked"},decls:5,vars:11,consts:[["data-automation-type","mini-toolbar-button",1,"mini-toolbar-button",3,"disabled","click"],["class","icon",3,"iconType",4,"ngIf","ngIfElse"],["officeIconBlock",""],["class","chevron-container",4,"ngIf"],[1,"icon",3,"iconType"],[3,"disabled","iconName","iconColors","iconMode"],[1,"chevron-container"],["name","CommonControlChevronDown_12",1,"icon"]],template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(s){return!n.disabled&&n.clicked.emit(s)}),e.\u0275\u0275template(1,Nt,1,1,"mini-toolbar-icon",1),e.\u0275\u0275template(2,Bt,1,4,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,Rt,2,0,"div",3),e.\u0275\u0275elementEnd()),2&t){var i=e.\u0275\u0275reference(3);e.\u0275\u0275classProp("selected",n.selected)("show-chevron",n.showChevron),e.\u0275\u0275property("disabled",n.disabled),e.\u0275\u0275attribute("aria-haspopup",n.ariaHasPopup)("aria-label",n.ariaLabel)("aria-pressed",n.selected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.customIcon)("ngIfElse",i),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.showChevron)}},dependencies:[U.NgIf,se.m,Y,At],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row}.mini-toolbar-button[_ngcontent-%COMP%]{background:none;border:none;box-sizing:border-box;--buttonBackgroundSelected: var(--gray-40);--buttonBackgroundHover: var(--gray-30);--buttonBackgroundSelectedHover: var(--gray-50);--buttonColorSelected: var(--gray-180);--buttonColorHover: var(--gray-180);flex:none}[data-legacy-theming=false][_ngcontent-%COMP%]   .mini-toolbar-button[_ngcontent-%COMP%]{--buttonBackgroundSelected: var(--colorNeutralBackground1Selected);--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorSelected: var(--colorNeutralForeground1Selected);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button[_ngcontent-%COMP%]:hover:not(:focus-visible), .mini-toolbar-button[_ngcontent-%COMP%]:active:not(:focus-visible){border:none}.mini-toolbar-button[_ngcontent-%COMP%]:hover:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button[_ngcontent-%COMP%]:active:not(:disabled):not([disabled]):not(.disabled), .mini-toolbar-button[_ngcontent-%COMP%]:hover:active:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundSelectedHover);color:var(--buttonColorHover)}.mini-toolbar-button.ql-active[_ngcontent-%COMP%]:not(:hover):not(:active), .mini-toolbar-button.selected[_ngcontent-%COMP%]:not(:hover):not(:active){background-color:var(--buttonBackgroundSelected);color:var(--buttonColorSelected)}.mini-toolbar-button[_ngcontent-%COMP%]:focus-visible{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.mini-toolbar-button[_ngcontent-%COMP%]:disabled, .mini-toolbar-button[disabled][_ngcontent-%COMP%], .mini-toolbar-button.disabled[_ngcontent-%COMP%]{background:none;color:var(--gray-90)}.mini-toolbar-button[_ngcontent-%COMP%]:disabled   .icon[_ngcontent-%COMP%], .mini-toolbar-button[disabled][_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .mini-toolbar-button.disabled[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:40%}.mini-toolbar-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}.mini-toolbar-button[_ngcontent-%COMP%]{width:28px;height:28px;padding:4px;display:flex;align-items:center;justify-content:center}.mini-toolbar-button.show-chevron[_ngcontent-%COMP%]{width:48px}.chevron-container[_ngcontent-%COMP%]{width:20px;padding:0 0 0 4px;display:flex;align-items:center;justify-content:center}.chevron-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:12px;height:12px}"],changeDetection:0}),a}(),Ke=u(10342),Ye=u(14463),Xe=u(30794),Se=u(33554),Me=u(72262),me=function(){function a(o){this.selectionService=o,this.contextMenuActionExecuted$=new Xe.xQ,this.miniToolbarActionTouched$=new Xe.xQ,this.formatPaneRegistered$=new Se.t(1),this.formatPaneCardExpansion$=new Se.t(1)}return a.prototype.executeContextMenuAction=function(){this.contextMenuActionExecuted$.next()},a.prototype.onMiniToolbarTouched=function(){this.miniToolbarActionTouched$.next()},a.prototype.registerFormatPane=function(){this.formatPaneRegistered$.next(!0)},a.prototype.deregisterFormatPane=function(){this.formatPaneRegistered$.next(!1)},a.prototype.getFormatPaneRegistered$=function(){return this.formatPaneRegistered$},a.prototype.getFormatPaneCardExpansion$=function(){return this.formatPaneCardExpansion$},a.prototype.setFormatPaneCardExpansion=function(o){this.formatPaneCardExpansion$.next(o)},a.prototype.markCardNavigationAsHandled=function(){this.formatPaneCardExpansion$.next(void 0)},a.prototype.handleFormatPaneInteraction=function(){pe.UP.clearSubSelections(this.selectionService)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(Me.z))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),zt={provide:Ke.a,useFactory:function(a,o){return a.resolve(o)},deps:[Ye.t,me]},Lt=u(4877),Ht=u(65181),Gt=u(5467),Fe=u(86940),we=u(8082),Wt=u(36861),Ze=u(42189),Jt=u(45924),fe=u(59973),te=u(48787),Te=u(23558),qe=u(84354),et=function(){function a(o){var t=this;this.pbiDropdownService=o,this.autocompleteElementRef$=this.pbiDropdownService.select$("autocompleteElementRef"),this.compact$=this.pbiDropdownService.select$("compact"),this.disabled$=this.pbiDropdownService.select$("disabled"),this.dropdownItems$=this.pbiDropdownService.select$("dropdownItems"),this.elementRef$=this.pbiDropdownService.select$("elementRef"),this.isInputFocused$=this.pbiDropdownService.select$("containerFocused"),this.isOpen$=this.pbiDropdownService.select$("open"),this.overlayRef$=this.pbiDropdownService.select$("overlayRef");var n=this.pbiDropdownService.onDestroy$;this.dropdownItems$.pipe((0,fe.h)(function(i){return!!i}),(0,te.q)(1)).subscribe(function(i){i.changes.pipe((0,C.R)(n),(0,j.U)(function(r){return r.length}),(0,D.O)(i.length),(0,Te.M)(t.overlayRef$,t.compact$,t.elementRef$)).subscribe(function(r){var s=r[0],c=r[1],d=r[2];if(c){var m=r[3].nativeElement.getBoundingClientRect(),h=t.getDropdownHeight(m,s,d);c.overlayRef.updateSize({minHeight:h})}t.pbiDropdownService.updateState({totalItems:s,overlayRef:c})})}),this.isInputFocused$.pipe((0,C.R)(n),(0,Te.M)(this.autocompleteElementRef$,this.isOpen$),(0,fe.h)(function(i){return!!i[1]})).subscribe(function(i){var s=i[1],c=i[2];i[0]&&(s.nativeElement.focus(),s.nativeElement.select(),c||t.pbiDropdownService.toggleOpenState())}),(0,F.aj)([this.autocompleteElementRef$,this.disabled$,this.isOpen$]).pipe((0,C.R)(n),(0,fe.h)(function(i){return!!i[0]})).subscribe(function(i){return t.updateAttributes(i[0],i[1],i[2])})}return a.prototype.getDropdownHeight=function(o,t,n){return(0,Jt.z)(o,t,n)},a.prototype.buttonKeydown=function(o){var t=this;(0,F.aj)([this.dropdownItems$,this.isOpen$]).pipe((0,fe.h)(function(n){return!!n[0]}),(0,Te.M)(this.overlayRef$,this.isInputFocused$),(0,te.q)(1)).subscribe(function(n){var i=n[0],r=i[0],c=n[1],d=n[2];if(i[1])switch(o.keyCode){case 40:if(!d)break;o.stopPropagation();case 36:case 33:r.first.focus(),o.preventDefault();break;case 38:if(!d)break;o.stopPropagation();case 35:case 34:r.last.focus(),o.preventDefault();break;case 27:t.closeDropdown(c),o.preventDefault(),o.stopPropagation();break;case 9:d&&t.closeDropdown(c);break;case 32:o.stopPropagation();break;default:t.autoSelect(o.key,r)}else switch(o.keyCode){case 13:case 38:case 40:t.pbiDropdownService.toggleOpenState(),o.preventDefault();break;case 36:case 33:t.pbiDropdownService.onSelectionChange({value:r.first.value}),o.preventDefault();break;case 35:case 34:t.pbiDropdownService.onSelectionChange({value:r.last.value}),o.preventDefault();break;case 32:o.stopPropagation()}})},a.prototype.containerFocused=function(o){this.pbiDropdownService.updateState({containerFocused:o})},a.prototype.closeDropdown=function(o){o.close(),this.pbiDropdownService.updateState({overlayRef:o=void 0,open:!1})},a.prototype.autoSelect=function(o,t){var n=t.find(function(i){return i.item.nativeElement.textContent.toLocaleLowerCase().startsWith(o.toLocaleLowerCase())});n&&n.focus()},a.prototype.updateAttributes=function(o,t,n){var i=o.nativeElement;i.setAttribute("role","combobox"),i.setAttribute("aria-haspopup","listbox"),i.setAttribute("aria-autocomplete","list"),i.setAttribute("aria-expanded",n),i.style.cursor="text",i.style.border="none",i.style.outline="none",i.style.flexGrow=1,t?(i.setAttribute("disabled",!0),i.style.backgroundColor="var(--gray-20, @gray-20)",i.style.color="var(--gray-90, @gray-90)",i.style.pointerEvents="none"):(i.removeAttribute("disabled"),i.style.backgroundColor=null,i.style.color=null,i.style.pointerEvents=null)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(qe.S))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Qt=u(26333),Kt=u(31343),tt=u(59787),Yt=["autocompleteInput"],Xt=function(){function a(o,t,n){this.elementRef=o,this.pbiDropdownService=t,this.strategy=n,this.onDestroy$=this.pbiDropdownService.onDestroy$}return a.prototype.ngAfterViewInit=function(){var o=this;(0,Qt.x)([{autocompleteElementRef:this.autocompleteInput,dropdownItems:this.dropdownItems,strategy:this.strategy}],Kt.N).subscribe(function(t){o.pbiDropdownService.updateState(t)}),(0,tt.R)(this.elementRef.nativeElement.children[0],"focus").pipe((0,C.R)(this.onDestroy$)).subscribe(function(){o.strategy.containerFocused&&o.strategy.containerFocused(!0)}),(0,tt.R)(this.autocompleteInput.nativeElement,"blur").pipe((0,C.R)(this.onDestroy$)).subscribe(function(){o.strategy.containerFocused&&o.strategy.containerFocused(!1)})},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(qe.S),e.\u0275\u0275directiveInject(et))},a.\u0275dir=e.\u0275\u0275defineDirective({type:a,selectors:[["pbi-dropdown","dropdown-type","autocomplete"]],contentQueries:function(t,n,i){if(1&t&&(e.\u0275\u0275contentQuery(i,Yt,5),e.\u0275\u0275contentQuery(i,Ze.r,5)),2&t){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.autocompleteInput=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.dropdownItems=r)}},features:[e.\u0275\u0275ProvidersFeature([et])]}),a}(),nt=u(76492),Zt=u(78173),qt=u(85102);function en(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mini-toolbar-button",2),e.\u0275\u0275listener("clicked",function(){var s=e.\u0275\u0275restoreView(t).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.clicked(s.value))}),e.\u0275\u0275elementEnd()}if(2&a){var n=o.$implicit;e.\u0275\u0275property("iconName",n.icon),e.\u0275\u0275attribute("data-automation-id",n.icon)}}var tn=["backgroundColorDropdown"],nn=["fillColorDropdown"],on=["fontColorDropdown"],rn=["lineColorDropdown"],an=["alignDropdown"],sn=["displayUnitsDropdown"],ln=["largeBorderDropdown"],cn=["largeGridDropdown"],un=["self"];function dn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",13,14),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(2).ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.displayUnitsClicked(r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("ariaLabel",e.\u0275\u0275pipeBind1(3,5,"Visual_Forecast_Parameter_Units"))("disabled",n.disabled.displayUnits)("customIcon",!0)("showChevron",!0)}}var pn=function(o){return{warning:o}};function mn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"font-picker",9),e.\u0275\u0275listener("onFontFamilyChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext().ngIf,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.fontFamilyChanged(s,c.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"pbi-spin-button",10),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext().ngIf,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.fontSizeChanged(s,c.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mini-toolbar-button",11),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext().ngIf,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.adjustFontSize("increaseFontSize",s.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mini-toolbar-button",12),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext().ngIf,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.adjustFontSize("decreaseFontSize",s.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,dn,4,7,"ng-container",0),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,18,"Font"))("showFullContent",!0)("fontFamily",n.values.fontProperties.fontFamily)("isDisabled",n.disabled.fontProperties)("size",i.fontFamilyPickerSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(26,pn,!!n.warnings.fontSize))("ariaLabel",e.\u0275\u0275pipeBind1(4,20,"FontSize"))("ngModel",n.values.fontProperties.fontSize)("options",i.fontSizeSpinButtonOptions)("disabled",n.disabled.fontProperties||n.disabled.fontSize)("size",i.fontSizePickerSize)("pbiTooltip",n.warnings.fontSize?i.MiniToolbarWarningComponent:void 0)("pbiTooltipComponentData",n.warnings.fontSize||void 0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,22,"Visual_IncreaseFontSize"))("disabled",n.disabled.increaseFontSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(8,24,"Visual_DecreaseFontSize"))("disabled",n.disabled.decreaseFontSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","NumericText"===n.mode)}}function fn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",15),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.biuChanged("bold",!r.values.bold,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-button",16),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.biuChanged("italic",!r.values.italic,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mini-toolbar-button",17),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.biuChanged("underline",!r.values.underline,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,9,"Bold"))("selected",n.values.bold)("disabled",n.disabled.bold),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(4,11,"Italic"))("selected",n.values.italic)("disabled",n.disabled.italic),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,13,"Underline"))("selected",n.values.underline)("disabled",n.disabled.underline)}}function vn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mini-toolbar-button",18,19),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.backgroundColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("iconColors",n.values.backgroundColors)("disabled",n.disabled.background)("showChevron",!0)("ariaHasPopup","menu")}}function hn(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",29),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){var t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.visualSubSelection.displayName," ")}}function gn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-dropdown",25),e.\u0275\u0275listener("valueChange",function(r){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2).ngIf,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onDisambiguationValueChange(r,s.subSelectionPosition))}),e.\u0275\u0275elementStart(1,"pbi-dropdown-trigger"),e.\u0275\u0275element(2,"input",26,27),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,hn,2,2,"pbi-dropdown-item",28),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("maxHeight",324)("value",n.subSelectedItem),e.\u0275\u0275advance(2),e.\u0275\u0275property("formControl",n.autocompleteControl),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(5,4,n.filteredSubselectables$))}}function bn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-large-button",20,21),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.fillColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-large-button",22,23),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.strokeColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,gn,6,6,"pbi-dropdown",24),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("iconColors",n.values.fillColors)("disabled",n.disabled.fill)("label",n.labels.fill),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaHasPopup","menu")("iconColors",n.values.strokeColors)("disabled",n.disabled.stroke)("label",n.labels.stroke),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.subSelectables.length>1)}}function yn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",30,31),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.fontColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mini-toolbar-button",32,33),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.alignClicked(r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mini-toolbar-button",34),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.wordWrapChanged(!r.values.wordWrap,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("ariaLabel",e.\u0275\u0275pipeBind1(3,11,"Visual_FontColor"))("iconColors",n.values.fontColors)("disabled",n.disabled.fontColor)("showChevron",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,13,"Visual_TextAlignment"))("iconName",n.values.alignIconType||"Centered_20")("disabled",n.disabled.horizontalAlignment),e.\u0275\u0275advance(3),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(8,15,"Visual_WordWrap"))("selected",n.values.wordWrap)("disabled",n.disabled.wordWrap)}}function Sn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",35),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.adjustDecimal("increaseDecimal",r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-button",36),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.adjustDecimal("decreaseDecimal",r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,4,"Visual_IncreaseDecimal"))("disabled",n.disabled.increaseDecimal),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(4,6,"Visual_DecreaseDecimal"))("disabled",n.disabled.decreaseDecimal)}}function Cn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",4)(2,"div",6)(3,"mini-toolbar-large-button",38,39),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.borderStyleClicked(i.boundContainer))}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}2&a&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(5,1,"Visual_Border")))}function xn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",4)(2,"div",6)(3,"mini-toolbar-large-button",40,41),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.gridStyleClicked(i.boundContainer))}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}2&a&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(5,1,"Visual_Grid")))}function Mn(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,Cn,6,3,"ng-container",0),e.\u0275\u0275template(2,xn,6,3,"ng-container",0),e.\u0275\u0275elementEnd()),2&a){var t=e.\u0275\u0275nextContext().ngIf,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",("Text"===t.mode||"NumericText"===t.mode)&&!!n.subSelectionStyles.border),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!n.subSelectionStyles.grid)}}var _n=function(o){return{hidden:o}};function In(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",1,2),e.\u0275\u0275listener("pointerdown",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onPointerDown())}),e.\u0275\u0275elementStart(3,"div",3)(4,"div",4),e.\u0275\u0275template(5,mn,10,28,"div",5),e.\u0275\u0275elementStart(6,"div",6),e.\u0275\u0275template(7,fn,7,15,"ng-container",0),e.\u0275\u0275template(8,vn,2,4,"mini-toolbar-button",7),e.\u0275\u0275template(9,bn,6,9,"ng-container",0),e.\u0275\u0275template(10,yn,9,17,"ng-container",0),e.\u0275\u0275template(11,Sn,5,8,"ng-container",0),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(12,Mn,3,2,"div",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=o.ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(8,_n,!n.mode)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Shape"!==n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Shape"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!i.subSelectionStyles.border||!!i.subSelectionStyles.grid)}}var it=".container[_ngcontent-%COMP%]{border-radius:2px;background-color:var(--white-color);box-shadow:var(--fluent-shadow-depth8);padding:4px;width:fit-content}.container.hidden[_ngcontent-%COMP%]{display:none}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding-bottom:4px}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:last-child{padding-bottom:0}.container[_ngcontent-%COMP%]   .colContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row}.container[_ngcontent-%COMP%]   .extraItemsContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;border-left:1px solid var(--fluent-theme-neutral-light-color)}.container[_ngcontent-%COMP%]   .colItem[_ngcontent-%COMP%]{display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   .font-family[_ngcontent-%COMP%]{width:128px;margin-right:4px}.container[_ngcontent-%COMP%]   .font-size[_ngcontent-%COMP%]{width:52px}.container[_ngcontent-%COMP%]   .disambiguation-menu[_ngcontent-%COMP%]{padding:14px 8px;width:180px}",Ue={left:"LeftAlign_20",center:"Centered_20",right:"RightAlign_20",Auto:void 0},wn={Left:"left",Center:"center",Right:"right",Auto:"Auto"},Tn=function(){function a(o){this.picked=o,this.alignments=Object.keys(Ue).filter(function(t){return"Auto"!==t}).map(function(t){return{value:t,icon:Ue[t]}})}return a.prototype.clicked=function(o){this.picked(o)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(re.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-alignment"]],decls:2,vars:1,consts:[[1,"alignment-container","container","row"],[3,"iconName","clicked",4,"ngFor","ngForOf"],[3,"iconName","clicked"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,en,1,2,"mini-toolbar-button",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.alignments))},dependencies:[U.NgForOf,Qe],styles:[it],changeDetection:0}),a}(),ot=function(a){function o(t,n,i,r,s,c,d,p,m,h,f){var v=a.call(this)||this;return v.changeDetector=t,v.componentFactoryResolver=n,v.formattingUIManager=i,v.injector=r,v.itemPickerService=s,v.lazyScoped=c,v.localizationService=d,v.menuService=p,v.overlay=m,v.runningVisuals=h,v.selectionService=f,v.fontSizeSpinButtonOptions={minValue:ye.r4,maxValue:ye.YR,stepAmount:1},v.fontFamilyPickerSize="sm",v.fontSizePickerSize="sm",v.MiniToolbarWarningComponent=Ut,v.rainbowColorValues=["#Ff0000","#ff0","#0f0","#00BCE3","#0000ff","#f0f"],v.autocompleteControl=new ie.p4,v.overlays={alignOverlayRef:void 0,borderOverlayRef:void 0,colorOverlayRef:void 0,displayUnitsMenuRef:void 0,gridOverlayRef:void 0},v}return(0,l.ZT)(o,a),o.prototype.ngOnInit=function(){var t=this;Promise.all([this.lazyScoped.get(R.ub),this.lazyScoped.get(R.Vj)]).then(function(n){var i=n[0],r=n[1];t.formattingService=i,t.formattingUIService=r,V.fF.assert(function(){return 1===t.subSelectionUpdateArgs.subSelections.length},"expected subselections of length 1"),V.fF.assert(function(){return!!t.subSelectedItem},"expected subSelectedItem"),V.fF.assert(function(){return!!t.subSelectedItem.visualSubSelection.selectionOrigin},"miniToolbar - subSelectedItem should not have an empty selectionOrigin, onDisambiguationValueChange should have been handled and added selectionOrigin");var s=t.changes$("subSelectedItem").pipe((0,j.U)(function(g){return g.visualSubSelection})),c=s.pipe((0,j.U)(function(g){return{x:g.selectionOrigin.x,y:g.selectionOrigin.y}})),d=(0,F.aj)([t.changes$("subSelectionUpdateArgs"),s]).pipe((0,oe.w)(function(g){var y=g[1];return i.getFor({type:0,canvasItem:g[0].canvasItem}).getSubSelectables$().pipe((0,j.U)(function(T){return _.isEmpty(T)?[]:T.filter(function(P){return P.subSelectionType===y.subSelectionType}).map(function(P){return{visualSubSelection:P,source:"disambiguationMenu",triggerAction:0}})}))}));t.autocompleteControl.setValue(t.subSelectedItem.visualSubSelection.displayName,{emitEvent:!1}),t.filteredSubselectables$=(0,F.aj)([t.autocompleteControl.valueChanges.pipe((0,D.O)("")),d]).pipe((0,C.R)(t.onDestroy$),(0,j.U)(function(g){return t.getFilteredSubselectables(g[0],g[1])}));var p=t.changes$("subSelectionStyles").pipe((0,j.U)(function(g){return 1===g.type?"Text":2===g.type?"NumericText":"Shape"})),m=t.changes$("subSelectionUpdateArgs").pipe((0,M.j)("canvasItem")),h=t.formattingUIService.getSubSelectionStylesSlices$(m.pipe((0,j.U)(function(g){return[g]}))),f=(0,F.aj)([p,h,m]).pipe((0,j.U)(function(g){var b=g[0],y=g[1],S=g[2];return"Text"===b||"NumericText"===b?t.bindToText(y,S):"Shape"===b?t.bindToShape(y,S):{disabled:{},values:{fontProperties:{fontFamily:"",fontSize:0}},lables:{},warnings:{}}}),(0,E.d)({bufferSize:1,refCount:!0})),v=f.pipe((0,M.j)("disabled")),I=f.pipe((0,M.j)("values")),O=f.pipe((0,M.j)("labels")),x=f.pipe((0,M.j)("warnings"));t.viewModel$=(0,F.aj)([m,h,v,O,p,d,c,I,x]).pipe((0,j.U)(function(g){return{boundContainer:g[0],boundSubSelectionStylesSlices:g[1],disabled:g[2],labels:g[3],mode:g[4],subSelectables:g[5],subSelectionPosition:g[6],values:g[7],warnings:g[8]}})),t.onDestroy$.subscribe(function(){return t.closeOverlays()}),t.changeDetector.detectChanges()})},o.prototype.onDisambiguationValueChange=function(t,n){return(0,l.mG)(this,void 0,void 0,function(){var i,r,s;return(0,l.Jh)(this,function(d){switch(d.label){case 0:return i=pe.UP.getSelectedCanvasItem(this.selectionService),r=(0,l.pi)((0,l.pi)({},t),{visualSubSelection:(0,l.pi)((0,l.pi)({},t.visualSubSelection),{showUI:!0})}),this.autocompleteControl.setValue((s=r.visualSubSelection).displayName,{emitEvent:!1}),n||V.fF.assertFail("Disambiguation menu should not be able to be called without a position set"),s.selectionOrigin={x:n.x,y:n.y},pe.UP.selectSubSelection(this.selectionService,i,[r],0),[4,this.lazyScoped.get("formatModeService")];case 1:return[4,d.sent().triggerShowUI({canvasItem:i,subSelections:[r]})];case 2:return d.sent(),[2]}})})},o.prototype.onPointerDown=function(){this.formattingUIManager.onMiniToolbarTouched()},o.prototype.getConditionalFormattingGradient=function(t,n){var i,r,s,d,c=(0,xt.my)(t,n.objectName,n.selector);if(c&&(d=c.properties[n.propertyName]),d&&(0,_t.X2)(d)){var m=d&&d.solid&&d.solid.color;if(m&&!(0,be.VC)(m)&&!(0,be.wt)(m)){if((0,be.Tu)(m)){var h=(0,St.qG)(m.rule),f=this.itemPickerService.getDataColors().getGradientColors(),v=[];return v.push(null!==(i=h.minColor)&&void 0!==i?i:f.minColor.value),h.diverging&&v.push(null!==(r=h.midColor)&&void 0!==r?r:f.midColor.value),v.push(null!==(s=h.maxColor)&&void 0!==s?s:f.maxColor.value),v}if((0,be.Gs)(m))return m.cases.reverse().map(function(I){return Mt.jz.getTextValue(I.value)});if((0,be.kb)(m)||(0,be.iV)(m))return this.rainbowColorValues}}},o.prototype.getColorProperties=function(t,n){var i,r,s,c;if(!n)return{disabled:!0};var h,d=n.properties,m=null===(i=d.conditionalFormattingObjects)||void 0===i?void 0:i.isSet;if(!d)return{disabled:!0};if(d.disabled)h=[Pe.UD];else if(m){var f;f=(0,ae.Vz)(t)?_.merge({},t.config.singleVisual.vcObjects,t.config.singleVisual.objects):null!==(r=t.objects)&&void 0!==r?r:{},h=n.instances.length>1?[Pe.UD]:this.getConditionalFormattingGradient(f,n.instances[0].descriptor)}return h||(h=[null!==(c=null===(s=n.resolvedValue)||void 0===s?void 0:s.value)&&void 0!==c?c:Pe.UD]),{disabled:!1,value:h,label:d.label}},o.prototype.bindToText=function(t,n){var i={},r={fontProperties:void 0},c={};r.fontProperties={fontFamily:"",fontSize:0};var d=t.fontFamily;d&&d.properties?(i.fontProperties=!1,r.fontProperties.fontFamily=d.resolvedValue):i.fontProperties=!0;var m=t.fontSize,h=m&&m.properties;h?(i.increaseFontSize=!1,i.decreaseFontSize=!1,i.fontSize=!1,r.fontProperties.fontSize=m.resolvedValue,h.options&&(this.fontSizeSpinButtonOptions.minValue=null==h.options.minValue?ye.r4:h.options.minValue.value,this.fontSizeSpinButtonOptions.maxValue=null==h.options.maxValue?ye.YR:h.options.maxValue.value),c.fontSize=h.warning):(i.increaseFontSize=!0,i.decreaseFontSize=!0,i.fontSize=!0,c.fontSize=void 0,this.fontSizeSpinButtonOptions.minValue=ye.r4,this.fontSizeSpinButtonOptions.maxValue=ye.YR);var f=t.bold;f?(i.bold=!1,r.bold=f.resolvedValue):i.bold=!0;var v=t.italic;v?(i.italic=!1,r.italic=v.resolvedValue):i.italic=!0;var I=t.underline;I?(i.underline=!1,r.underline=I.resolvedValue):i.underline=!0;var x=this.getColorProperties(n,t.background);i.background=!x||x.disabled,r.backgroundColors=x?.value||[""];var b=this.getColorProperties(n,t.fontColor);i.fontColor=!b||b.disabled,r.fontColors=b?.value||[""];var y=t.horizontalAlignment;if(y&&y.properties){i.horizontalAlignment=!1;var w=this.getAlignmentFromControl(y.resolvedValue,y.instances);r.alignIconType=Ue[w],r.alignIconType||(i.horizontalAlignment="Auto"!==w,r.alignIconType="")}else i.horizontalAlignment=!0,r.alignIconType="";var T=t.wordWrap;T&&T.properties?(i.wordWrap=!1,r.wordWrap=T.resolvedValue):(i.wordWrap=!0,r.wordWrap=!1);var k=t.precision;return k&&k.properties?(i.increaseDecimal=!1,i.decreaseDecimal=!1):(i.increaseDecimal=!0,i.decreaseDecimal=!0),i.displayUnits=!t.displayUnits,{disabled:i,values:r,labels:{},warnings:c}},o.prototype.bindToShape=function(t,n){var i={},r={fontProperties:void 0},s={},p=this.getColorProperties(n,t.fill);i.fill=p.disabled,r.fillColors=p.value||[""],s.fill=p.label||this.localizationService.get("Visual_Fill");var h=this.getColorProperties(n,t.stroke);return i.stroke=h.disabled,r.strokeColors=h.value||[""],s.stroke=h.label||this.localizationService.get("Visual_Border"),{disabled:i,values:r,labels:s,warnings:{}}},o.prototype.fontFamilyChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"fontFamily",value:t},{source:"MiniToolbar"})},o.prototype.fontSizeChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"fontSize",value:t},{source:"MiniToolbar"})},o.prototype.adjustFontSize=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:t},{source:"MiniToolbar"})},o.prototype.biuChanged=function(t,n,i){this.closeOverlays(),this.formattingUIService.onControlClicked(i,{key:t,value:n},{source:"MiniToolbar"})},o.prototype.colorClicked=function(t,n,i){var r=this;this.closeOverlays(this.overlays.colorOverlayRef)||t&&(this.overlays.colorOverlayRef=this.formattingUIService.openColorPicker(t,this.minitoolbar.nativeElement,function(){return r.closeOverlays()},{source:"MiniToolbar"}))},o.prototype.fontColorClicked=function(t,n){this.colorClicked(n.fontColor,"fontColor",t)},o.prototype.fillColorClicked=function(t,n){this.colorClicked(n.fill,"fill",t)},o.prototype.backgroundColorClicked=function(t,n){this.colorClicked(n.background,"background",t)},o.prototype.strokeColorClicked=function(t,n){this.closeOverlays(),this.colorClicked(n.stroke,"stroke",t)},o.prototype.wordWrapChanged=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:"wordWrap",value:t},{source:"MiniToolbar"})},o.prototype.adjustDecimal=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:t},{source:"MiniToolbar"})},o.prototype.alignClicked=function(t){var n=this;if(t.horizontalAlignment&&!this.closeOverlays(this.overlays.alignOverlayRef)){var r=this.overlay.position().flexibleConnectedTo(this.alignDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:10}]);this.overlays.alignOverlayRef=this.overlay.open({component:Tn,data:function(c){n.closeOverlays(),n.alignChanged(c,t)},closeOnBackdropClick:!0,options:{positionStrategy:r,hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver}),this.overlays.alignOverlayRef.onClose.subscribe(function(){n.overlays.alignOverlayRef=void 0})}},o.prototype.alignChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"horizontalAlignment",value:t},{source:"MiniToolbar"})},o.prototype.displayUnitsClicked=function(t){var n=this;if(!this.closeOverlays(this.overlays.displayUnitsMenuRef)){var i=t.displayUnits;if(i){var c=i.resolvedValue,d={menu:{items:_.map(i.properties.items,function(p){return{type:z.iB.Button,text:p.displayName,data:p,checked:p.value===c.value,checkable:!0}})},origin:this.displayUnitsDropdown.nativeElement};this.overlays.displayUnitsMenuRef=this.menuService.open(d),this.overlays.displayUnitsMenuRef.onClose$.subscribe(function(){n.overlays.displayUnitsMenuRef=void 0}),this.overlays.displayUnitsMenuRef.onButtonClick$.subscribe(function(p){n.displayUnitsChanged(p.data.value,t),n.closeOverlays()})}}},o.prototype.displayUnitsChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"displayUnits",value:t},{source:"MiniToolbar"})},o.prototype.borderStyleClicked=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,r,s,c,d=this;return(0,l.Jh)(this,function(p){switch(p.label){case 0:return this.closeOverlays(this.overlays.borderOverlayRef)?[2]:(0,ae.Vz)(t)?(n=this.overlay.position().flexibleConnectedTo(this.largeBorderDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:0}]),i=this.runningVisuals.getVisual(t),[4,i?.getSubSelectionShortcuts([this.subSelectedItem.visualSubSelection],"border")]):[2];case 1:return r=p.sent(),[4,i?.getSubSelectionStyles([this.subSelectedItem.visualSubSelection])];case 2:return s=p.sent(),c=this.formattingUIService.getMenuItems$(r,t,[s],i).pipe((0,j.U)(function(m){return{items:_.flatten(m)}})),this.overlays.borderOverlayRef=this.openMiniToolbarContextMenu(t,r,n,c),this.overlays.borderOverlayRef.onClose.subscribe(function(){d.overlays.borderOverlayRef=void 0}),[2]}})})},o.prototype.gridStyleClicked=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,r,s,c,d=this;return(0,l.Jh)(this,function(p){switch(p.label){case 0:return this.closeOverlays(this.overlays.gridOverlayRef)?[2]:(0,ae.Vz)(t)?(n=this.overlay.position().flexibleConnectedTo(this.largeGridDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:0}]),i=this.runningVisuals.getVisual(t),[4,i?.getSubSelectionShortcuts([this.subSelectedItem.visualSubSelection],"grid")]):[2];case 1:return r=p.sent(),[4,i?.getSubSelectionStyles([this.subSelectedItem.visualSubSelection])];case 2:return s=p.sent(),c=this.formattingUIService.getMenuItems$(r,t,[s],i).pipe((0,j.U)(function(m){return{items:_.flatten(m)}})),this.overlays.gridOverlayRef=this.openMiniToolbarContextMenu(t,r,n,c),this.overlays.gridOverlayRef.onClose.subscribe(function(){d.overlays.gridOverlayRef=void 0}),[2]}})})},o.prototype.openMiniToolbarContextMenu=function(t,n,i,r){var s=this;return this.overlay.open({component:Dt,data:{subSelectionUpdateArgs:{canvasItem:t,subSelections:[this.subSelectedItem.visualSubSelection]},subSelectionStyles:void 0,subSelectionShortcuts:n,menuInput$:r,closeOverlays:function(){return s.closeOverlays()}},closeOnBackdropClick:!0,options:{positionStrategy:i,hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver})},o.prototype.closeOverlays=function(t){var n=!1;for(var i in this.overlays){var r=this.overlays[i];r&&(this.overlays[i]=void 0,n=n||t===r,r.close())}return n},o.prototype.getFilteredSubselectables=function(t,n){var i=t.toLocaleLowerCase();return n.filter(function(s){return s.visualSubSelection.displayName.toLocaleLowerCase().includes(i)})},o.prototype.getAlignmentFromControl=function(t,n){var i,r=n[0].descriptor.type;if(V.fF.assert(function(){return _.every(n,function(c){return c.descriptor.type===r})},"MiniToolbar alignment - expected all the descriptors to have same property type"),We.Ge.isValueTypeDescriptor(r)){var s=We.Ge.fromDescriptor(r);if(s.enum===Ct.K)return wn[t];if(null!==(i=s.formatting)&&void 0!==i&&i.alignment)return t;V.fF.assertFail("MiniToolbar alignment - unexpected descriptor property type")}else V.fF.assertFail("MiniToolbar alignment - not a value type descriptor")},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(me),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Lt.a),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(Ht.o),e.\u0275\u0275directiveInject(Gt.o),e.\u0275\u0275directiveInject(Fe._),e.\u0275\u0275directiveInject(we.s),e.\u0275\u0275directiveInject(Me.z))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(tn,5,e.ElementRef),e.\u0275\u0275viewQuery(nn,5,e.ElementRef),e.\u0275\u0275viewQuery(on,5,e.ElementRef),e.\u0275\u0275viewQuery(rn,5,e.ElementRef),e.\u0275\u0275viewQuery(an,5,e.ElementRef),e.\u0275\u0275viewQuery(sn,5,e.ElementRef),e.\u0275\u0275viewQuery(ln,5,e.ElementRef),e.\u0275\u0275viewQuery(cn,5,e.ElementRef),e.\u0275\u0275viewQuery(un,5,e.ElementRef)),2&n){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.backgroundColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.fillColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.fontColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.strokeDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.alignDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.displayUnitsDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.largeBorderDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.largeGridDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.minitoolbar=r.first)}},hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","mini-toolbar")},inputs:{subSelectionUpdateArgs:"subSelectionUpdateArgs",subSelectionStyles:"subSelectionStyles",subSelectedItem:"subSelectedItem"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],[1,"container","smallFontSize",3,"ngClass","pointerdown"],["self",""],[1,"colContainer"],[1,"colItem"],["class","row",4,"ngIf"],[1,"row"],["iconName","FillColorSplitDropdown_20","data-automation-id","mini-toolbar-fill-color",3,"iconColors","disabled","showChevron","ariaHasPopup","clicked",4,"ngIf"],["class","extraItemsContainer",4,"ngIf"],["data-automation-id","mini-toolbar-font-picker",1,"font-family",3,"ariaLabel","showFullContent","fontFamily","isDisabled","size","onFontFamilyChange"],["data-automation-id","mini-toolbar-font-size",1,"font-size",3,"ngClass","ariaLabel","ngModel","options","disabled","size","pbiTooltip","pbiTooltipComponentData","ngModelChange"],["iconName","GrowFont_20","data-automation-id","mini-toolbar-increase-font-size",3,"ariaLabel","disabled","clicked"],["iconName","ShrinkFont_20","data-automation-id","mini-toolbar-decrease-font-size",3,"ariaLabel","disabled","clicked"],["iconName","DisplayUnits","data-automation-id","mini-toolbar-display-units",3,"ariaHasPopup","ariaLabel","disabled","customIcon","showChevron","clicked"],["displayUnitsDropdown",""],["iconName","Bold_20","data-automation-id","mini-toolbar-bold",3,"ariaLabel","selected","disabled","clicked"],["iconName","Italic_20","data-automation-id","mini-toolbar-italic",3,"ariaLabel","selected","disabled","clicked"],["iconName","Underline_20","data-automation-id","mini-toolbar-underline",3,"ariaLabel","selected","disabled","clicked"],["iconName","FillColorSplitDropdown_20","data-automation-id","mini-toolbar-fill-color",3,"iconColors","disabled","showChevron","ariaHasPopup","clicked"],["backgroundColorDropdown",""],["iconName","FillColorSplitDropdown_24","data-automation-id","mini-toolbar-shape-fill-color",3,"ariaHasPopup","iconColors","disabled","label","clicked"],["fillColorDropdown",""],["iconName","TableBorderColorSplitDropdown_24","data-automation-id","mini-toolbar-line-color",3,"ariaHasPopup","iconColors","disabled","label","clicked"],["lineColorDropdown",""],["class","disambiguation-menu","dropdown-type","autocomplete","data-automation-id","mini-toolbar-disambiguration-menu",3,"maxHeight","value","valueChange",4,"ngIf"],["dropdown-type","autocomplete","data-automation-id","mini-toolbar-disambiguration-menu",1,"disambiguation-menu",3,"maxHeight","value","valueChange"],["type","text",1,"auto-input",3,"formControl"],["autocompleteInput",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["iconName","FontColorNoPreview_20","data-automation-id","font-color",3,"ariaHasPopup","ariaLabel","iconColors","disabled","showChevron","clicked"],["fontColorDropdown",""],["data-automation-id","mini-toolbar-alignment",3,"ariaLabel","iconName","disabled","clicked"],["alignDropdown",""],["iconName","WrapText_20","data-automation-id","mini-toolbar-word-wrap",3,"ariaLabel","selected","disabled","clicked"],["iconName","IncreaseDecimal_20","data-automation-id","mini-toolbar-increase-decimal",3,"ariaLabel","disabled","clicked"],["iconName","DecreaseDecimal_20","data-automation-id","mini-toolbar-decrease-decimal",3,"ariaLabel","disabled","clicked"],[1,"extraItemsContainer"],["iconName","BorderDrawToolGrid_20","data-automation-id","mini-toolbar-border",3,"label","clicked"],["largeBorderDropdown",""],["iconName","GridCard_24","data-automation-id","mini-toolbar-grid",3,"label","clicked"],["largeGridDropdown",""]],template:function(n,i){1&n&&(e.\u0275\u0275template(0,In,13,10,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",i.formattingService&&e.\u0275\u0275pipeBind1(1,1,i.viewModel$))},dependencies:[U.NgClass,U.NgForOf,U.NgIf,Wt.w,ie.Fj,ie.JJ,ie.On,Xt,nt.H,Ze.r,nt.T,Zt.a,de.V,ie.oH,Qe,he,U.AsyncPipe,qt.F],styles:[it],changeDetection:0}),o}(A.w),rt=u(64548);function En(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar",4),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",t.data.subSelectionUpdateArgs)("subSelectionStyles",t.data.subSelectionStyles)("subSelectedItem",(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections)&&(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections[0])),e.\u0275\u0275attribute("aria-labelledby",t.ariaLabelledby)}}function On(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"on-object-context-menu",5),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.executeContextMenuAction())}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",n.data.subSelectionUpdateArgs)("subSelectionStyles",n.data.subSelectionStyles)("subSelectionShortcuts",n.data.subSelectionShortcuts)}}var Pn=function(){function a(o,t){var i,r,n=this;this.onObjectUIData=o,this.formattingUIManager=t,this.hideContextMenu=!1,this.data=this.onObjectUIData;var s=null===(i=this.data.subSelectionUpdateArgs)||void 0===i?void 0:i.subSelections;s&&(this.hideContextMenu=s.some(function(c){return"disambiguationMenu"===c.source})),this.ariaLabelledby=(0,rt.u)(null===(r=this.data.subSelectionUpdateArgs)||void 0===r?void 0:r.canvasItem.name),this.subscription=this.formattingUIManager.miniToolbarActionTouched$.pipe((0,te.q)(1)).subscribe(function(){n.hideContextMenu=!0})}return a.prototype.executeContextMenuAction=function(){this.formattingUIManager.executeContextMenuAction()},a.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(re.M),e.\u0275\u0275directiveInject(me))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["on-object-container"]],decls:4,vars:4,consts:[[1,"on-object-container"],["class","mini-toolbar","role","toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem",4,"ngIf"],[1,"context-menu"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction",4,"ngIf"],["role","toolbar",1,"mini-toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,En,1,4,"mini-toolbar",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275template(3,On,1,3,"on-object-context-menu",3),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275classProp("flip",null==n.data?null:n.data.flip),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionStyles)&&(null==n.data?null:n.data.subSelectionUpdateArgs)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionShortcuts)&&!n.hideContextMenu))},styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column}.on-object-container.flip[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{order:1;margin-top:8px}.on-object-container.flip[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{order:0;margin-top:0}.on-object-container[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{pointer-events:auto;max-width:fit-content;order:0}.on-object-container[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{margin-top:8px;min-width:180px;max-width:fit-content;height:auto;pointer-events:auto;order:1}"],changeDetection:0}),a}(),Ce=u(61617),Dn=u(57419),Fn=u(70604),at=u(56578),Un=u(86900),Ve=u(32041),Vn=["outlineContainer"],jn=["directEditTextBox"];function kn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"textarea",1,2),e.\u0275\u0275listener("click",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("mousedown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("pointerdown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("input",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.directEditTextBoxChange())})("blur",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.directEditTextBoxBlur())})("keydown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditKeyDown(i))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"div",3,4),e.\u0275\u0275elementContainerEnd()}}var je,ke,Ee,Rn=function(){function a(o){this.textbox=o}return Object.defineProperty(a.prototype,"left",{get:function(){return this._left},set:function(t){t!==this._left&&(this._left=t,this.textbox.style.left="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._top},set:function(t){t!==this._top&&(this._top=t,this.textbox.style.top="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this._width},set:function(t){t!==this._width&&(this._width=t,this.textbox.style.width="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(t){t!==this._height&&(this._height=t,this.textbox.style.height="".concat(t,"px"))},enumerable:!1,configurable:!0}),a}(),zn=function(a){function o(t,n,i,r,s){var c=a.call(this)||this;return c.element=t,c.lazyScoped=n,c.selection=i,c.changeDetector=r,c.contextActivityService=s,c.directEditTextBoxVisible=!1,c.asyncSerializer=new Dn.W,c}return(0,l.ZT)(o,a),o.prototype.directEditKeyDown=function(t){var n=this;("Enter"===t.key||"Escape"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.asyncSerializer.enqueue(function(){return(0,l.mG)(n,void 0,void 0,function(){return(0,l.Jh)(this,function(i){return"Escape"===t.key?this.directEditState&&this.directEditState.changed&&(this.directEditState.dirty=!0,this.directEditState.value=this.directEditState.originalValueUndefined?void 0:this.directEditState.originalValue,this.flushUpdate()):this.flushUpdate(),this.endDirectEdit(),this.queueRender(),[2]})})}))},o.prototype.maintainTextboxHeight=function(t){if(this.directEditState&&this.directEditTextBoxVisible){var i=this.directEditTextBox.nativeElement,s=i.scrollHeight+2;if(null!=t&&s<t&&(s=t),s>Ee&&(s=Ee),s>i.clientHeight+2){this.directEditTextBoxDimensions.height=s;var d=this.outlineContainer.nativeElement.getBoundingClientRect();this.directEditTextBoxDimensions.top+this.directEditTextBoxDimensions.height>d.height&&(this.directEditTextBoxDimensions.top=d.height-this.directEditTextBoxDimensions.height)}}},o.prototype.directEditTextBoxMouseEvent=function(t){t.stopImmediatePropagation()},o.prototype.directEditTextBoxChange=function(){this.directEditState&&(this.maintainTextboxHeight(),this.directEditState.value=this.directEditTextBox.nativeElement.value,this.directEditState.dirty=!0,this.queueUpdate())},o.prototype.directEditTextBoxBlur=function(){this.flushUpdate()},o.prototype.queueUpdate=function(){var t=this;this.directEditUpdateTimeout&&(clearTimeout(this.directEditUpdateTimeout),this.directEditUpdateTimeout=void 0),this.directEditUpdateTimeout=setTimeout(function(){t.directEditUpdateTimeout=void 0,t.directEditState&&null!=t.directEditState.value&&t.directEditState.value.trim()&&t.sendUpdate()},500)},o.prototype.flushUpdate=function(){this.directEditUpdateTimeout&&(clearTimeout(this.directEditUpdateTimeout),this.directEditUpdateTimeout=void 0),this.sendUpdate()},o.prototype.sendUpdate=function(){this.directEditState&&this.directEditState.dirty&&(this.directEditState.dirty=!1,this.directEditState.changed=!0,this.updateDirectEditValue())},o.prototype.ngAfterViewInit=function(){var t=this;this.lazyScoped.get("formatModeService").then(function(n){n.immediateDirectEdit$.pipe((0,C.R)(t.onDestroy$)).subscribe(function(i){return t.asyncSerializer.enqueue(function(){return t.immediateDirectEdit(i)})})}),this.lazyScoped.get("formattingService").then(function(n){t.formattingService=n,t.changeDetector.detectChanges(),t.renderer=Un.D.create(t.outlineContainer.nativeElement,{startEdit:function(s){return t.asyncSerializer.enqueue(function(){return t.startDirectEdit(s)})},showUI:function(s,c){return t.asyncSerializer.enqueue(function(){return t.showUI(s,c)})}}),t.changes$("regionOutlines").pipe((0,C.R)(t.onDestroy$)).subscribe(function(r){t.asyncSerializer.enqueue(function(){return t.updateOutlines(r)})})})},o.prototype.queueRender=function(){this.render()},o.prototype.render=function(t){var n=this,i=this.renderOutlines,r=this.directEditTextBox.nativeElement;if(this.directEditTextBoxDimensions||(this.directEditTextBoxDimensions=new Rn(r)),this.directEditState){i=_.filter(i,function(v){return 2!==v.visibility});var c=this.directEditState.directEdit.style,d=this.getTextBoxSizingFont();if(!t&&!Ve.b.isFontLoaded(d))return void document.fonts.load("16px "+d.fontFamily).then(function(v){},function(v){throw v}).finally(function(){return n.render(!0)});var h=this.calcTextBoxDimensions(d,{width:this.directEditTextBoxVisible&&!!this.directEditTextBoxDimensions.width&&0!==c,height:this.directEditTextBoxVisible&&!!this.directEditTextBoxDimensions.height});this.directEditTextBoxDimensions.left=h.left,this.directEditTextBoxDimensions.top=h.top,this.directEditTextBoxDimensions.width=h.width,(!this.directEditTextBoxVisible||0!==c)&&(this.directEditTextBoxDimensions.height=h.height),this.directEditTextBoxVisible||(this.directEditTextBoxVisible=!0,r.value=this.directEditState.value??"",r.style.display="block",0===c&&(this.directEditTextBoxDimensions.height=Math.min(Ee,r.scrollHeight+2)),r.focus(),r.select(),this.directEditState.bodyClickDismissListener=function(v){r.contains(v.target)||(r.style.display="none",n.asyncSerializer.enqueue(function(){return(0,l.mG)(n,void 0,void 0,function(){return(0,l.Jh)(this,function(I){return this.directEditState&&(this.flushUpdate(),this.endDirectEdit(),this.queueRender()),[2]})})}))},document.body.addEventListener("pointerdown",this.directEditState.bodyClickDismissListener,!0)),this.maintainTextboxHeight(h.height)}else this.directEditTextBoxVisible&&(this.directEditTextBoxVisible=!1,r.style.display="none");this.sendOutlinesToRenderer(i)},o.prototype.sendStartDirectEditEvent=function(){this.contextActivityService.createActivity({name:"StartDirectEdit",visualName:this.directEditState.visualName,data:{formattingId:this.directEditState.directEdit.reference,source:"DirectEdit"}}).resolve()},o.prototype.sendEndDirectEditEvent=function(){this.contextActivityService.createActivity({name:"EndDirectEdit",visualName:this.directEditState.visualName,data:{formattingId:this.directEditState.directEdit.reference,changed:this.directEditState.changed,source:"DirectEdit"}}).resolve()},o.prototype.getTextBoxSizingFont=function(){var t=window.getComputedStyle(this.directEditTextBox.nativeElement);return{fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,text:(this.directEditState.value||"")+"MMMMMMMMMMMMMMMMMMMM"}},o.prototype.calcTextBoxDimensions=function(t,n){var i=Ve.b.measureSvgTextRect(t);if(void 0===je){var r=Ve.b.measureSvgTextRect((0,l.pi)((0,l.pi)({},t),{text:"M"}));ke=r.width,Ee=4*(je=r.height)+6}var s=this.directEditState.directEditOutline.directEdit().reference,d=this.directEditState.directEdit.style,p=ct(this.directEditState.directEditOutlineRegion,function(w){return 1===w.type&&w.directEdit&&(0,Ce.cd)(w.directEdit().reference,s)}),m=this.outlineContainer.nativeElement,h=m.getBoundingClientRect(),f={left:p.x-h.x,top:p.y-h.y,width:p.width,height:p.height},v=n&&n.width&&this.directEditTextBoxDimensions.width&&this.directEditTextBoxDimensions.width-6,I=n&&n.height&&this.directEditTextBoxDimensions.height&&this.directEditTextBoxDimensions.height-6;switch(d){case 1:case 2:var O=f.left+f.width/2,x=f.top+f.height/2,g=Math.min(v||i.width,30*ke),b=I||i.height;f.left=O-g/2,f.top=x-b/2,f.width=g,f.height=b;break;case 3:x=f.top+f.height/2,g=Math.min(v||i.width,30*ke),f.top=x-(b=I||i.height)/2,f.width=g,f.height=b;break;case 0:v&&(f.width=v),I&&I>f.height&&(f.height=I),f.height<i.height&&(f.height=i.height)}f.left-=3,f.top-=3,f.width+=6,f.height+=6;var y=$(m).width(),S=$(m).height();return f.width>y&&(f.width=y),f.height>S&&(f.height=S),f.left<0&&(f.left=0),f.left+f.width>y&&(f.left=Math.max(0,y-f.width)),f.top<0&&(f.top=0),f.top+f.height>S&&(f.top=Math.max(0,S-f.height)),f},o.prototype.immediateDirectEdit=function(t){var n;return(0,l.mG)(this,void 0,void 0,function(){var i,r,s,c;return(0,l.Jh)(this,function(d){if(this.pendingImmediateDirectEdit=void 0,this.directEditState){if(t.outlineId===(null===(n=this.directEditState.directEditOutlineRegion)||void 0===n?void 0:n.id))return[2];this.endDirectEdit()}if(this.renderOutlines)for(i=0,r=this.renderOutlines;i<r.length;i++)if((s=r[i]).id===t.outlineId&&2===s.visibility&&(c=Be(s.outline)))return this.startDirectEdit(c),[2];return this.pendingImmediateDirectEdit=t,[2]})})},o.prototype.updateOutlines=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,r=this;return(0,l.Jh)(this,function(s){return this.renderOutlines=t,this.directEditState&&(n=this.directEditState.directEdit.reference,i=!1,_.forEach(t,function(c){if(2===c.visibility){var d=ct(c,function(p){return 1===p.type&&p.directEdit&&(0,Ce.cd)(p.directEdit().reference,n)});d&&(i=!0,r.directEditState.directEditOutlineRegion=c,r.directEditState.directEditOutline=d,r.directEditState.directEdit=d.directEdit())}}),i||this.endDirectEdit()),this.queueRender(),[2]})})},o.prototype.endDirectEdit=function(){this.sendEndDirectEditEvent(),this.directEditState.bodyClickDismissListener&&document.body.removeEventListener("pointerdown",this.directEditState.bodyClickDismissListener,!0),this.directEditState=void 0,this.changeDetector.markForCheck()},o.prototype.showUI=function(t,n){return(0,l.mG)(this,void 0,void 0,function(){var i,r,s=this;return(0,l.Jh)(this,function(c){switch(c.label){case 0:return(i=_.first(this.selection.getSelectedElements()))&&!_.isEmpty(i.subSelections)?[4,this.lazyScoped.get("formatModeService")]:[3,3];case 1:return(r=c.sent()).updateSubSelection({canvasItem:i.canvasItem,subSelections:_.map(i.subSelections,function(d){return{source:"external",triggerAction:0,visualSubSelection:{displayName:d.visualSubSelection.displayName,subSelectionType:1,selectionOrigin:s.getSelectionOrigin(n),showUI:!0,visualObjects:d.visualSubSelection.visualObjects,target:n.target}}})}),[4,r.triggerShowUI(void 0)];case 2:c.sent(),c.label=3;case 3:return[2]}})})},o.prototype.getSelectionOrigin=function(t){var n=t.target.getBoundingClientRect().top,i=-1*Math.abs(n-t.clientY);return{x:t.clientX,y:t.clientY,offset:{x:0,y:i}}},o.prototype.startDirectEdit=function(t){return(0,l.mG)(this,void 0,void 0,function(){var n,i;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return this.pendingImmediateDirectEdit=void 0,[4,this.lazyScoped.get("formatModeService")];case 1:return n=r.sent(),i=this,[4,this.getDirectEditContext(t)];case 2:return i.directEditState=r.sent(),this.directEditState?(n.hideAllUI(),this.changeDetector.markForCheck(),this.queueRender(),this.sendStartDirectEditEvent(),[2]):[2]}})})},o.prototype.updateDirectEditValue=function(){return(0,l.mG)(this,void 0,void 0,function(){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return t=this.directEditState,(n=_.first(this.selection.getSelectedElements()))&&!_.isEmpty(n.subSelections)&&n.canvasItem?t.value?[4,this.formattingService.saveValues({changes:[{objectName:t.descriptor.objectName,uid:t.uid,formattingSource:t.source,propertySlice:{name:t.descriptor.propertyName,value:t.value,type:t.descriptor.type},hasDynamicExpressionSupport:!1,canvasItems:[n.canvasItem],visualUpdateSource:1}]},{source:"DirectEdit"})]:[3,2]:[2];case 1:return r.sent(),[3,4];case 2:return[4,this.formattingService.revertToDefault([(0,l.pi)((0,l.pi)({},t.descriptor),{originSource:t.source,canvasItems:[n.canvasItem]})])];case 3:r.sent(),r.label=4;case 4:return[2]}})})},o.prototype.getDirectEditContext=function(t){var p,m,n=this,i=new Fn.B,r=t.directEdit(),s=r.reference,c=this.renderOutlines,d=_.first(this.selection.getSelectedElements());d?(p=this.formattingService.getFor({type:0,canvasItem:d.canvasItem}),m=d.canvasItem.name):p=this.formattingService.getFor({type:1});var h=0,v=p.selectSlice(s).pipe((0,te.q)(2)).subscribe(function(x){if(x&&x.control&&x.control.properties&&x.control.properties.descriptor){if((0,at.IW)(x))return V.fF.assertFail("Unexpected composite slice"),void O(void 0);var g=_.first(n.selection.getSelectedElements());if(g&&!_.isEmpty(g.subSelections)&&g.canvasItem){var b=x.originSource,y=x.pivotSource,S=x.control.properties,w=S.descriptor,T=S.value,P=x.uid,k=null==T?void 0:"".concat(T),N=!0,H=g.canvasItem;if((0,ae.Vz)(H)){N=!function(a,o,t){var n=a.vcObjects,i=n&&n[o];if(i)return null!=i[0].properties[t];var r=a.objects,s=r&&r[o];return!!s&&null!=s[0].properties[t]}(H.config.singleVisual,w.objectName,w.propertyName);var L=_.find(c,function(G){return G.visualContainerName===m&&X(G.outline)});O(L?{regionOutlines:c,directEditOutlineRegion:L,directEditOutline:t,directEdit:r,source:b,pivot:y,descriptor:w,value:N&&void 0!==r.displayValue?r.displayValue:k,originalValue:k,originalValueUndefined:N,dirty:!1,visualName:g&&g.canvasItem.name,bodyClickDismissListener:void 0,uid:P}:void 0)}else O(void 0)}else O(void 0)}else 2==++h&&O(void 0);function X(G){var Ie;if(G===t)return!0;if(1===G.type&&G.directEdit){var He=null===(Ie=G.directEdit())||void 0===Ie?void 0:Ie.reference;if((0,Ce.cd)(He,s))return!0}return!(0!==G.type||!_.some(G.outlines,function(Ge){return X(Ge)}))}}),I=!1;function O(x){I=!0,i.resolve(x),v&&v.unsubscribe()}return I&&v.unsubscribe(),i.promise},o.prototype.sendOutlinesToRenderer=function(t){var n=this.element.nativeElement.getBoundingClientRect();if(this.renderer.updateRegionOutlines(t,n),this.pendingImmediateDirectEdit)for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.id===this.pendingImmediateDirectEdit.outlineId&&2===s.visibility){var c=Be(s.outline);c&&this.startDirectEdit(c)}}},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(Me.z),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Je.r))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["outline-overlay"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(Vn,5),e.\u0275\u0275viewQuery(jn,5)),2&n){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.outlineContainer=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.directEditTextBox=r.first)}},hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","outline-overlay")},inputs:{regionOutlines:"regionOutlines"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],["data-testid","directEditTextBox",1,"directEditTextBox",3,"click","mousedown","pointerdown","input","blur","keydown"],["directEditTextBox",""],[1,"outlineContainer"],["outlineContainer",""]],template:function(n,i){1&n&&e.\u0275\u0275template(0,kn,5,0,"ng-container",0),2&n&&e.\u0275\u0275property("ngIf",i.formattingService)},dependencies:[U.NgIf],styles:["[_nghost-%COMP%]{display:block}.directEditTextBox[_ngcontent-%COMP%]{position:absolute;display:none;pointer-events:auto;resize:none;box-sizing:border-box;padding:2px;border-width:1px}.outlineContainer[_ngcontent-%COMP%]{pointer-events:none;position:absolute;height:100%;width:100%;overflow:hidden;top:0;left:0}"],changeDetection:0}),o}(A.w);function ct(a,o){for(var t=[a.outline];!_.isEmpty(t);){var n=t.shift();if(0===n.type)t.push.apply(t,n.outlines);else if(o(n))return n}}function Be(a){if(1===a.type)return a;if(0===a.type)for(var o=0,t=a.outlines;o<t.length;o++){var i=Be(t[o]);if(i)return i}}var Ln=u(35510),Hn=u(77526),ut=u(26898),dt=u(83008),pt=u(11494),mt=u(53081),ft=u(21024),vt=u(77200),ht=u(27980),Oe=u(92755),K=u(25512),Gn=u(64466);function Wn(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar",2),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",t.data.subSelectionUpdateArgs)("subSelectionStyles",t.data.subSelectionStyles)("subSelectedItem",(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections)&&(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections[0])),e.\u0275\u0275attribute("aria-labelledby",t.ariaLabelledby)}}var gt=function(){function a(o){var t;this.onObjectUIData=o,this.data=this.onObjectUIData,this.ariaLabelledby=(0,rt.u)(null===(t=this.data.subSelectionUpdateArgs)||void 0===t?void 0:t.canvasItem.name)}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(re.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-component-wrapper"]],decls:2,vars:1,consts:[[1,"on-object-container"],["class","mini-toolbar","role","toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem",4,"ngIf"],["role","toolbar",1,"mini-toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Wn,1,4,"mini-toolbar",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionStyles)&&(null==n.data?null:n.data.subSelectionUpdateArgs)))},dependencies:[U.NgIf,ot],styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none}.on-object-container[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{pointer-events:auto;max-width:fit-content}"],changeDetection:0}),a}();function Jn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"on-object-context-menu",3),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.executeContextMenuAction())}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",n.data.subSelectionUpdateArgs)("subSelectionStyles",n.data.subSelectionStyles)("subSelectionShortcuts",n.data.subSelectionShortcuts)}}var Re=function(){function a(o,t){var n;this.onObjectUIData=o,this.formattingUIManager=t,this.hideContextMenu=!1,this.data=this.onObjectUIData;var i=null===(n=this.data.subSelectionUpdateArgs)||void 0===n?void 0:n.subSelections;i&&(this.hideContextMenu=i.some(function(r){return"disambiguationMenu"===r.source}))}return a.prototype.executeContextMenuAction=function(){this.formattingUIManager.executeContextMenuAction()},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(re.M),e.\u0275\u0275directiveInject(me))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["on-object-context-menu-wrapper"]],decls:3,vars:1,consts:[[1,"on-object-container"],[1,"context-menu"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction",4,"ngIf"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Jn,1,3,"on-object-context-menu",2),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionShortcuts)&&!n.hideContextMenu))},dependencies:[U.NgIf,De],styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none}.on-object-container[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{min-width:180px;max-width:fit-content;height:auto;pointer-events:auto}"],changeDetection:0}),a}(),bt=u(52287),Qn=u(26691),yt="pbi-pointer-events-none",Kn=Gn.s.DisplayAreaNameSelector.selector,$e=function(){function a(o,t,n,i,r,s){var c=this;this.componentFactoryResolver=o,this.formattingUIManager=t,this.injector=n,this.pbiOverlay=i,this.runningVisuals=r,this.visualOverlayPositionService=s,this.formattingUIManager.contextMenuActionExecuted$.subscribe(function(){c.hide()})}return a.prototype.show=function(o){return(0,l.mG)(this,void 0,void 0,function(){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return(0,mt.A)(o)?[4,this.showForVisual(o)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.showForNonVisual(o),t.label=3;case 3:return[2]}})})},a.prototype.showForVisual=function(o){var t,n,i,r,s,c;return(0,l.mG)(this,void 0,void 0,function(){var d,p,m,h,f,v,I,O,x,g,b,y,S,w,T,P;return(0,l.Jh)(this,function(k){switch(k.label){case 0:return p=o.subSelections,(0,ae.Vz)(d=o.canvasItem)?(V.fF.assert(function(){return 1===p.length},"Expected 1 sub-selection"),(m=this.runningVisuals.getVisual(d))?(v=p.map(function(N){return N.visualSubSelection}),[4,m.getSubSelectionShortcuts(v,void 0)]):[3,3]):(V.fF.assertFail("Groups are not supported"),[2]);case 1:return h=k.sent(),[4,m.getSubSelectionStyles(v)];case 2:f=k.sent(),k.label=3;case 3:return h||f?(I=_.first(p).visualSubSelection.selectionOrigin,O=null===(t=_.first(p).visualSubSelection)||void 0===t?void 0:t.target,x=null===(n=this.visualOverlayPositionService.getElement(d))||void 0===n?void 0:n.get(0),(g=(null!==(r=null===(i=$(O).closest("[".concat(bt.CP,"]")))||void 0===i?void 0:i.get(0))&&void 0!==r?r:O)||x).classList.contains(bt.cy)||(g=x),S=this.createPositions(b=!!f,y=!!h,g,I),w=this.pbiOverlay.position().flexibleConnectedTo(g).withPositions(S),T={subSelectionShortcuts:h,subSelectionStyles:f,subSelectionUpdateArgs:o},this.hide(),b&&y?(this.minitoolbarRef=this.openOverlay(T,w,gt),P=this.pbiOverlay.position().flexibleConnectedTo(null===(c=null===(s=this.minitoolbarRef)||void 0===s?void 0:s.overlayRef)||void 0===c?void 0:c.overlayElement).withPositions([(0,K.Oq)(0,8),(0,K.w3)(0,-8)]),this.contextMenuRef=this.openOverlay(T,P,Re),[2]):b?(this.minitoolbarRef=this.openOverlay(T,w,gt),[2]):y?(this.contextMenuRef=this.openOverlay(T,w,Re),[2]):[2]):[2]}})})},a.prototype.showForNonVisual=function(o){var t=o.customShortcuts,n=o.sourceEvent;if(t){var i={subSelectionShortcuts:t},r={x:n.clientX,y:n.clientY},s=this.pbiOverlay.position().flexibleConnectedTo(r).withPositions(this.createNonVisualPositions());this.contextMenuRef=this.openOverlay(i,s,Re)}},a.prototype.openOverlay=function(o,t,n){return this.pbiOverlay.open({component:n,data:o,options:{positionStrategy:t,hasBackdrop:!0,backdropClass:[Fe.L,yt],panelClass:yt},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver,closeOnBackdropClick:!0})},a.prototype.hide=function(){this.minitoolbarRef&&(this.minitoolbarRef.close(),this.minitoolbarRef=void 0),this.contextMenuRef&&(this.contextMenuRef.close(),this.contextMenuRef=void 0)},a.prototype.createPositions=function(o,t,n,i){var r,s=(r=this.visualOverlayPositionService.getRelativeOffsets(n,i)).endX,c=r.startX,d=r.startY,p=r.endY;if(o){var m=[(0,K.Zz)(s,d-68),(0,K.Iz)(c,d-68),(0,K.J7)(s,p),(0,K.Kb)(c,p)],h=document.querySelector(Kn).getBoundingClientRect().top;return i.y-h<68&&m.unshift((0,K.Oq)(d,p)),m}if(t)return[(0,K.Zz)(s,d),(0,K.Iz)(c,d),(0,K.J7)(s,p),(0,K.Kb)(c,p)]},a.prototype.createNonVisualPositions=function(){return[(0,K.Zz)(),(0,K.Iz)(),(0,K.J7)(),(0,K.Kb)()]},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(e.ComponentFactoryResolver),e.\u0275\u0275inject(me),e.\u0275\u0275inject(e.Injector),e.\u0275\u0275inject(Fe._),e.\u0275\u0275inject(we.s),e.\u0275\u0275inject(Qn.z))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Le=u(21302),Yn=function(){function a(o,t,n,i,r,s,c,d,p,m,h){var f=this;this.conceptualSchemaProxy=o,this.dataSourcesService=t,this.eventBridge=n,this.formattingUIManager=i,this.lazyScoped=r,this.onObjectOverlayService=s,this.paneVisibility=c,this.runningVisuals=d,this.selection=p,this.viewModeState=m,this.visualAuthoringOperationsService=h,this.requestedSubSelection$=new Se.t(1),this.triggerShowUIWithSubSelection$=new Ln.X(void 0),this.navigateShortcut$=new Se.t(1),this.onDestroy$=new Se.t(1),this.navigateId=0,this.immediateDirectEdit$=new Se.t(1),(0,F.aj)([this.formattingUIManager.getFormatPaneRegistered$(),this.navigateShortcut$]).pipe((0,C.R)(this.onDestroy$)).subscribe(function(v){var I=v[0],O=v[1];return(0,l.mG)(f,void 0,void 0,function(){var x,g,b,y,S,w,T,P,k,N,H,X;return(0,l.Jh)(this,function(L){switch(L.label){case 0:return this.navigateId++,x=this.navigateId,I&&O?(b=O.canvasItem,y=(g=O.shortcut).destinationInfo,S=void 0,P=void 0,this.eventBridge.publishToChannel(g.destinationPivot&&"Page"===(S=g.destinationPivot)?Le.mF:Le.sn),k=this.formattingService.getFor(b?{type:0,canvasItem:b}:{type:1}),(0,Ce.LI)(y)?[4,k.selectSlice(y).pipe((0,C.R)(this.onDestroy$),(0,fe.h)(function(Z){return!!Z}),(0,te.q)(1)).toPromise()]:[3,3]):[3,6];case 1:return(N=L.sent())&&x===this.navigateId?(S=N.pivotSource,[4,k.selectGroup(T=N.groupUid).pipe((0,C.R)(this.onDestroy$),(0,fe.h)(function(Z){return!!Z}),(0,te.q)(1)).toPromise()]):[2];case 2:return(H=L.sent())&&x===this.navigateId?(w=H.cardUid,P=H.parentContainers,[3,5]):[2];case 3:return T=y.groupUid,[4,k.selectCard(w=y.cardUid).pipe((0,C.R)(this.onDestroy$),(0,fe.h)(function(Z){return!!Z}),(0,j.U)(function(Z){return Z.pivotSource}),(0,te.q)(1)).toPromise()];case 4:if(!(X=L.sent())||x!==this.navigateId)return[2];S=S??X,L.label=5;case 5:this.formattingUIManager.setFormatPaneCardExpansion({selectedPivot:S,isCardExpanded:function(G){return w===G},isGroupExpanded:function(G,Ie){if(w===G&&null!=T)return(0,Ce.Ko)(T)===(0,Ce.Ko)(Ie)},formattingContainersNavigationInfo:P,canvasItems:[b],scrollToOpenCard:!0}),g.doNotDismissUI||this.hideAllUI(),this.navigateShortcut$.next(void 0),L.label=6;case 6:return[2]}})})})}return a.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0)},a.prototype.monitor=function(){return(0,l.mG)(this,void 0,void 0,function(){var o,t,n,i=this;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return this.monitoring?[2]:(this.monitoring=!0,[4,this.ensureStoreInitialized()]);case 1:return r.sent(),o=this.viewModeState.formatMode$,t=pe.UP.getSelectedVisualContainer$(this.selection),n=t.pipe((0,j.U)(function(s){return s?.name}),(0,Hn.x)()),o.pipe((0,fe.h)(function(s){return s}),(0,C.R)(this.onDestroy$)).subscribe(function(){return i.showFormatPane(!0)}),(0,F.aj)([o,n,this.triggerShowUIWithSubSelection$]).pipe((0,Te.M)(this.requestedSubSelection$),(0,C.R)(this.onDestroy$)).subscribe(function(s){var c,d,p=s[0],m=p[0],h=p[1],v=s[1];i.hideUI(null===(c=v.canvasItem)||void 0===c?void 0:c.name),m&&h===(null===(d=v.canvasItem)||void 0===d?void 0:d.name)&&_.some(v.subSelections,function(I){return I.visualSubSelection.showUI})&&i.showUI(v)}),[2]}})})},a.prototype.updateSubSelection=function(o){this.requestedSubSelection$.next(o)},a.prototype.triggerShowUI=function(o){return(0,l.mG)(this,void 0,void 0,function(){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return o?[4,this.showUI(o)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.triggerShowUIWithSubSelection$.next(),t.label=3;case 3:return[2]}})})},a.prototype.triggerImmediateDirectEdit=function(o){this.immediateDirectEdit$.next({outlineId:o,timestamp:performance.now()})},a.prototype.ensureStoreInitialized=function(){return(0,l.mG)(this,void 0,void 0,function(){var o;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return this.formattingService?[3,2]:(o=this,[4,this.lazyScoped.get("formattingService")]);case 1:o.formattingService=t.sent(),t.label=2;case 2:return[2]}})})},a.prototype.showUI=function(o){var t;return(0,l.mG)(this,void 0,void 0,function(){var n;return(0,l.Jh)(this,function(i){switch(i.label){case 0:return n=!this.activeContainerName,(0,mt.A)(o)&&(n=n||this.activeContainerName===o.canvasItem.name,this.activeContainerName=null!==(t=this.activeContainerName)&&void 0!==t?t:o.canvasItem.name),n?[4,this.onObjectOverlayService.show(o)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},a.prototype.showFormatPane=function(o){var t=this.paneVisibility.isPaneVisible("format"),n=this.paneVisibility.isPaneExpanded("format");return!!(o||t&&n)&&(t||(this.paneVisibility.togglePaneVisibility("format"),t=!0),(n=this.paneVisibility.isPaneExpanded("format"))||(n=this.paneVisibility.togglePaneExpansion("format")),t&&n)},a.prototype.hideUI=function(o){(!this.activeContainerName||this.activeContainerName&&o===this.activeContainerName)&&this.hideAllUI()},a.prototype.hideAllUI=function(){this.activeContainerName=void 0,this.onObjectOverlayService.hide()},a.prototype.executeShortcut=function(o,t){return(0,l.mG)(this,void 0,void 0,function(){var n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(_.isEmpty(o))return[2];switch(n=o[0].shortcut.type){case 0:return[3,1];case 1:return[3,3];case 2:return[3,5];case 3:return[3,7];case 4:return[3,9];case 5:return[3,10];case 6:return[3,11];case 9:return[3,13]}return[3,15];case 1:return[4,this.executeResetShortcut(o,t)];case 2:return r.sent(),[2];case 3:return[4,this.executeNavigateShortcut(o)];case 4:return r.sent(),[2];case 5:return[4,this.executeToggleShortcut(o)];case 6:return r.sent(),[2];case 7:return[4,this.executePickerShortcut(o)];case 8:return r.sent(),[2];case 9:return this.executeSortShortcut(o),[2];case 10:return this.executeCustomActionShortcut(o),[2];case 11:return[4,this.executeConditionalFormattingShortcut(o)];case 12:return r.sent(),[2];case 13:return[4,this.executeSetValueShortcut(o)];case 14:return r.sent(),[2];case 15:V.fF.assertNever(n),r.label=16;case 16:return[2]}})})},a.prototype.executeResetShortcut=function(o,t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,r,s,c;return(0,l.Jh)(this,function(p){switch(p.label){case 0:return[4,this.ensureStoreInitialized()];case 1:p.sent(),n=[],i=function(h){var f,v,I,O;return(0,l.Jh)(this,function(x){switch(x.label){case 0:if(f=h.canvasItem,(v=h.shortcut).revertToDefaultDescriptors)for(O in I=_.groupBy(v.revertToDefaultDescriptors,function(g){return g.originSource}))n.push.apply(n,_.map(I[O],function(g){return(0,l.pi)((0,l.pi)({},g),{canvasItems:[f]})}));return v.resetSortRoleKey?[4,r.resetSortShortcut(f,v.resetSortRoleKey)]:[3,2];case 1:x.sent(),x.label=2;case 2:return[2]}})},r=this,s=0,c=o,p.label=2;case 2:return s<c.length?[5,i(c[s])]:[3,5];case 3:p.sent(),p.label=4;case 4:return s++,[3,2];case 5:return this.formattingService.revertToDefault(n,void 0,t),[2]}})})},a.prototype.executeToggleShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n,i,r,s,c,d,p,h;return(0,l.Jh)(this,function(f){for(t=[],n=0,i=o;n<i.length;n++){if(s=(r=i[n]).shortcut,c=r.canvasItem,!_.isEmpty(s.relatedToggledFormattingIds))for(d=0,p=s.relatedToggledFormattingIds;d<p.length;d++)h=(0,l.pi)((0,l.pi)({type:2},p[d]),{telemetrySource:s.telemetrySource}),t.push({shortcut:h,canvasItem:c});t.push(r)}return[2,this.setToggleValue(t)]})})},a.prototype.setToggleValue=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n,i,r,s,c,d;return(0,l.Jh)(this,function(m){switch(m.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(m.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,V.fF.assert(function(){return _.every(o,function(h){return h.shortcut.telemetrySource===t})},"expected only one telemetry source for all the toggle shortcuts"),n=[],i=[],r=function(f){var v,I,O,g,b,y,S,w,T,P,k,N,H,X;return(0,l.Jh)(this,function(L){switch(L.label){case 0:return v=f.shortcut,O=s.formattingService.getFor({type:0,canvasItem:I=f.canvasItem}),g=v.nextValue,y=void 0,s.isToggleShortcut(v)?[4,O.selectTopLevelToggle(v).pipe((0,te.q)(1)).toPromise()]:[3,5];case 1:return(S=L.sent())?(y=S.uid,b={toggleSwitch:S.control.properties,togglePivot:S.originSource},[3,4]):[3,2];case 2:return[4,O.selectSlice(v).pipe((0,te.q)(1)).toPromise()];case 3:(w=L.sent())&&(V.fF.assert(function(){return"ToggleSwitch"===w.control.type},"expected slice to be a toggle switch"),y=w.uid,b={toggleSwitch:w.control.properties,togglePivot:w.originSource,conditionalFormattingObjects:w.conditionalFormattingObjects}),L.label=4;case 4:return[3,7];case 5:return[4,O.selectSlice(v).pipe((0,te.q)(1)).toPromise()];case 6:(T=L.sent())&&(V.fF.assert(function(){return"ToggleSwitch"===T.control.type},"expected slice to be a toggle switch"),y=T.uid,b={toggleSwitch:T.control.properties,togglePivot:T.originSource,conditionalFormattingObjects:T.conditionalFormattingObjects}),L.label=7;case 7:return b?(k=b.togglePivot,N=b.conditionalFormattingObjects,(P=b.toggleSwitch)&&(H=P.descriptor,void 0!==g?(X=(0,Oe.ks)(g,H,y,k,[I],1,N),i.push(X)):n.push((0,l.pi)((0,l.pi)({},H),{originSource:k,canvasItems:[I]})))):V.fF.assert(function(){return!!b},"toggle should be present in the store"),[2]}})},s=this,c=0,d=o,m.label=2;case 2:return c<d.length?[5,r(d[c])]:[3,5];case 3:m.sent(),m.label=4;case 4:return c++,[3,2];case 5:return _.isEmpty(i)?[3,7]:[4,this.formattingService.saveValues({changes:i},t)];case 6:m.sent(),m.label=7;case 7:return _.isEmpty(n)?[3,9]:[4,this.formattingService.revertToDefault(n)];case 8:m.sent(),m.label=9;case 9:return[2]}})})},a.prototype.isToggleShortcut=function(o){return 2===o.type},a.prototype.executeNavigateShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n;return(0,l.Jh)(this,function(s){switch(s.label){case 0:return[4,this.ensureStoreInitialized()];case 1:return s.sent(),V.fF.assert(function(){return 1===o.length},"only one navigate shortcut should be executed at a time"),n=o[0].canvasItem,(t=o[0].shortcut).destinationInfo&&this.showFormatPane(t.togglePaneVisibility)?(this.navigateShortcut$.next({shortcut:t,canvasItem:n}),[2]):[2]}})})},a.prototype.executePickerShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n,i,r,s,c,d,p,m,h,x,g=this;return(0,l.Jh)(this,function(b){switch(b.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(b.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,V.fF.assert(function(){return _.every(o,function(y){return y.shortcut.telemetrySource===t})},"expected only one telemetry source for all the picker shortcuts"),n=[],i=[],r=function(S,w,T,P,k){return(0,l.mG)(g,void 0,void 0,function(){var N,H,X,L,Z;return(0,l.Jh)(this,function(G){switch(G.label){case 0:return N=w,S&&!_.isEmpty(S.items)?(H=void 0,void 0!==P&&(X=S.items[P])&&(S.value=X,H=X.value),L=S.descriptor,void 0===H?[3,1]:(Z=(0,Oe.ks)(H,L,k,N,[T],1),i.push(Z),[3,3])):[3,3];case 1:return n.push((0,l.pi)((0,l.pi)({},L),{originSource:N,canvasItems:[T]})),[4,this.formattingService.revertToDefault([(0,l.pi)((0,l.pi)({},L),{originSource:N,canvasItems:[T]})])];case 2:G.sent(),G.label=3;case 3:return[2]}})})},s=0,c=o,b.label=2;case 2:return s<c.length?(h=(p=(d=c[s]).shortcut).index,[4,this.formattingService.getFor({type:0,canvasItem:m=d.canvasItem}).selectSlice(p).pipe((0,j.U)(function(y){return{dropdown:y?.control.properties,dropdownPivot:y?.pivotSource,uid:y?.uid}}),(0,te.q)(1)).toPromise()]):[3,6];case 3:return x=b.sent(),[4,r(x.dropdown,x.dropdownPivot,m,h,x.uid)];case 4:b.sent(),b.label=5;case 5:return s++,[3,2];case 6:return _.isEmpty(i)?[3,8]:[4,this.formattingService.saveValues({changes:i},t)];case 7:b.sent(),b.label=8;case 8:return _.isEmpty(n)?[3,10]:[4,this.formattingService.revertToDefault(n)];case 9:b.sent(),b.label=10;case 10:return[2]}})})},a.prototype.executeSortShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n,i,r,s,c;return(0,l.Jh)(this,function(d){switch(d.label){case 0:return V.fF.assert(function(){return 1===o.length},"only one sort shortcut supported at a time"),n=o[0].shortcut,(0,ae.Vz)(t=o[0].canvasItem)?(i=this.runningVisuals.getVisual(t))&&i.sortServices?(r=[n.sortableField],[4,i.sortServices.getSortableGroups()]):[3,2]:[2];case 1:s=d.sent(),c=s.filter(function(p){return p.key!==n.key}).flatMap(function(p){return p.fields.filter(function(m){return void 0!==m.sortDirection}).map(function(m){return{queryName:m.exprs[0].name,sortDirection:m.sortDirection}})}),r.push.apply(r,c),i.sortServices.sort(r),d.label=2;case 2:return[2]}})})},a.prototype.resetSortShortcut=function(o,t){return(0,l.mG)(this,void 0,void 0,function(){var n,i,r,s,c,d;return(0,l.Jh)(this,function(p){switch(p.label){case 0:return(0,ae.Vz)(o)?(n=this.runningVisuals.getVisual(o))&&n.sortServices?[4,n.sortServices.getSortableGroups()]:[3,3]:[2];case 1:return i=p.sent(),(r=i.find(function(m){return m.key===t}))?(s=_.flatten(r.fields.map(function(m){return m.exprs[0].expr})),c=this.dataSourcesService.get(),[4,this.conceptualSchemaProxy.get(c)]):[3,3];case 2:d=p.sent(),this.visualAuthoringOperationsService.removeOrderBy(o,s,d),p.label=3;case 3:return[2]}})})},a.prototype.executeCustomActionShortcut=function(o){for(var t=0,n=o;t<n.length;t++)n[t].shortcut.customAction()},a.prototype.executeConditionalFormattingShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,this.setToggleValue(o)];case 1:return t.sent(),[2]}})})},a.prototype.executeSetValueShortcut=function(o){return(0,l.mG)(this,void 0,void 0,function(){var t,n,i,r,s,c,p,m,h,f,v,I,O,x,g,b,S,w,T;return(0,l.Jh)(this,function(P){switch(P.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(P.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,V.fF.assert(function(){return _.every(o,function(k){return k.shortcut.telemetrySource===t})},"expected only one telemetry source for all the picker shortcuts"),n=[],i=[],r=0,s=o,P.label=2;case 2:if(!(r<s.length))return[3,9];if(p=(c=s[r]).canvasItem,!(m=c.shortcut.referencesAndValues))return[3,8];h=0,f=m,P.label=3;case 3:return h<f.length?(I=(v=f[h]).isTopLevelToggle,O=v.value,x=this.formattingService.getFor({type:0,canvasItem:p}),g=void 0,b=v,I?[4,x.selectTopLevelToggle(b).pipe((0,te.q)(1)).toPromise()]:[3,5]):[3,8];case 4:return(S=P.sent())?(T=(0,Oe.ks)(O,w=S.control.properties.descriptor,g=S.uid,S.originSource,[p],1),n.push(T),[3,7]):(V.fF.assertFail("no top level toggle was found from the reference - setValueShortcut"),[2]);case 5:return[4,x.selectSlice(b).pipe((0,te.q)(1)).toPromise()];case 6:if(!(S=P.sent()))return V.fF.assertFail("no slice was found from the reference - setValueShortcut"),[2];if(g=S.uid,(0,at.IW)(S))return V.fF.assertFail("No support for setting values for composite slices yet"),[2];w=(0,l.pi)((0,l.pi)({},S.control.properties.descriptor),{originSource:S.originSource,canvasItems:[p]}),null!=O?(T=(0,Oe.ks)(O,w,g,S.originSource,[p],1),n.push(T)):i.push(w),P.label=7;case 7:return h++,[3,3];case 8:return r++,[3,2];case 9:return _.isEmpty(n)?[3,11]:[4,this.formattingService.saveValues({changes:n},t)];case 10:P.sent(),P.label=11;case 11:return _.isEmpty(i)?[3,13]:[4,this.formattingService.revertToDefault(i)];case 12:P.sent(),P.label=13;case 13:return[2]}})})},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(ut.i),e.\u0275\u0275inject(dt.D),e.\u0275\u0275inject(pt.J),e.\u0275\u0275inject(me),e.\u0275\u0275inject(xe.H),e.\u0275\u0275inject($e),e.\u0275\u0275inject(ft.r),e.\u0275\u0275inject(we.s),e.\u0275\u0275inject(Me.z),e.\u0275\u0275inject(vt.kc),e.\u0275\u0275inject(ht.Q))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Xn={provide:Ke.e,useFactory:function(a,o,t,n,i,r,s,c,d,p,m,h){var f=new Yn(a,o,t,n,i,r,s,d,p,m,h);return c.resolve(f)},deps:[ut.i,dt.D,pt.J,me,xe.H,$e,ft.r,Ye.t,we.s,Me.z,vt.kc,ht.Q]},qn=u(9398),ei=u(82156),ti=u(79061),ni=u(45925),ii=u(53935),oi=u(6015),ri=u(94841),ai=u(45411),si=u(66972),li=u(55533),ci=u(16095),ui=u(27037),di=u(54485),pi=[{type:he,componentId:"MiniToolbarLargeButtonComponentId"},{type:zn,componentId:"OutlineOverlayComponentId"}],mi=function(){function a(o){u.e("on-object").then(u.bind(u,39875)).then(function(t){o.registerIcons(t.iconSpriteSheet.sprite)})}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(di.u))},a.\u0275mod=e.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=e.\u0275\u0275defineInjector({providers:[$e,Xn,zt,me],imports:[U.CommonModule,ni.e,ie.u5,ei.N.withManifests(pi),ti.v,ii.e,oi.C,ri.b,ai.m,si.N,li.q,ci.Z,ie.UX,qn.Bz.forChild(B.Vc),ui.b]}),a}();e.\u0275\u0275setComponentScope(Pn,function(){return[U.NgIf,ot,De]},[])},36861:function(ve,W,u){u.d(W,{w:function(){return oe}});var B=u(81337),l=u(50423),A=u(17174),F=u(62458);function j(D){F.fF.assert(function(){return!_.isEmpty(D)},"Font family should exist");var C=D.match(/^(?:\s)*('|")?((?:\w|\s|-|\\.)+)(?:\1(?=,|$))/);return C&&C[2]||D}var e=u(72065),U=u(11547),se=u(59017),ce=u(14172),ne=u(83317),J=u(77526),q=u(39681),le=function(){function D(){}return D.prototype.getAllFonts=function(){return _.map(D.StandardFonts,function(C){return(0,q.ED)(C)})},D.getFamilyCSS=function(C){return C?C.map(function(M){return M.indexOf(" ")>-1?"'".concat(M,"'"):M}).join(", "):null},D.StandardFonts=_.map([{families:["Arial"],displayName:"Arial"},{families:["Arial Black"],displayName:"Arial Black"},{families:["Arial Unicode MS"],displayName:"Arial Unicode MS"},{families:["Calibri"],displayName:"Calibri"},{families:["Cambria"],displayName:"Cambria"},{families:["Cambria Math"],displayName:"Cambria Math"},{families:["Candara"],displayName:"Candara"},{families:["Comic Sans MS"],displayName:"Comic Sans MS"},{families:["Consolas"],displayName:"Consolas"},{families:["Constantia"],displayName:"Constantia"},{families:["Corbel"],displayName:"Corbel"},{families:["Courier New"],displayName:"Courier New"},{families:["wf_standard-font","helvetica","arial","sans-serif"],displayName:"DIN"},{families:["wf_standard-font_light","helvetica","arial","sans-serif"],displayName:"DIN Light"},{families:["Georgia"],displayName:"Georgia"},{families:["Lucida Sans Unicode"],displayName:"Lucida Sans Unicode"},{families:["Segoe UI","wf_segoe-ui_normal","helvetica","arial","sans-serif"],displayName:"Segoe UI"},{families:["Segoe UI Light","wf_segoe-ui_light","helvetica","arial","sans-serif"],displayName:"Segoe UI Light"},{families:["Segoe UI Semibold","wf_segoe-ui_semibold","helvetica","arial","sans-serif"],displayName:"Segoe UI Semibold"},{families:["Segoe UI Bold","wf_segoe-ui_bold","helvetica","arial","sans-serif"],displayName:"Segoe UI Bold"},{families:["Symbol"],displayName:"Symbol",suppressStyle:!0},{families:["Tahoma"],displayName:"Tahoma"},{families:["Times New Roman"],displayName:"Times New Roman"},{families:["Trebuchet MS"],displayName:"Trebuchet MS"},{families:["Verdana"],displayName:"Verdana"},{families:["Wingdings"],displayName:"Wingdings",suppressStyle:!0}],function(C){return{family:D.getFamilyCSS(C.families),displayName:C.displayName,suppressStyle:C.suppressStyle}}),D.\u0275prov=l.\u0275\u0275defineInjectable({token:D,factory:D.\u0275fac=function(M){return new(M||D)},providedIn:"root"}),D}(),Q=u(77476),Y=u(76492),ee=u(42189),ge=u(9529);function ue(D,C){if(1&D&&(l.\u0275\u0275elementStart(0,"pbi-dropdown-item",5)(1,"p",3),l.\u0275\u0275text(2),l.\u0275\u0275elementEnd()()),2&D){var M=C.$implicit;l.\u0275\u0275property("value",M),l.\u0275\u0275advance(1),l.\u0275\u0275property("ngStyle",M.style),l.\u0275\u0275advance(1),l.\u0275\u0275textInterpolate(M.displayName)}}var de=function(C){return{showFullContent:C}};function he(D,C){if(1&D){var M=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementStart(0,"pbi-dropdown",2),l.\u0275\u0275listener("valueChange",function(ae){l.\u0275\u0275restoreView(M);var pe=l.\u0275\u0275nextContext(2);return l.\u0275\u0275resetView(pe.setFontFamily(ae))}),l.\u0275\u0275pipe(1,"async"),l.\u0275\u0275elementStart(2,"pbi-dropdown-trigger")(3,"p",3),l.\u0275\u0275text(4),l.\u0275\u0275elementEnd()(),l.\u0275\u0275template(5,ue,3,3,"pbi-dropdown-item",4),l.\u0275\u0275elementEnd()}if(2&D){var E=C.ngIf,R=l.\u0275\u0275nextContext().ngIf,z=l.\u0275\u0275nextContext();l.\u0275\u0275property("aria-label",z.ariaLabel)("aria-labelledby",z.ariaLabelledby)("aria-describedby",z.ariaDescribedby)("compact",z.compact)("size",z.size)("maxHeight",z.maxHeight)("options",l.\u0275\u0275pureFunction1(14,de,z.showFullContent))("value",E)("isDisabled",l.\u0275\u0275pipeBind1(1,12,z.isDisabled$)),l.\u0275\u0275advance(3),l.\u0275\u0275property("ngStyle",E.style),l.\u0275\u0275advance(1),l.\u0275\u0275textInterpolate(E.displayName),l.\u0275\u0275advance(1),l.\u0275\u0275property("ngForOf",R)}}function ie(D,C){if(1&D&&(l.\u0275\u0275elementContainerStart(0),l.\u0275\u0275template(1,he,6,16,"pbi-dropdown",1),l.\u0275\u0275pipe(2,"async"),l.\u0275\u0275elementContainerEnd()),2&D){var M=l.\u0275\u0275nextContext();l.\u0275\u0275advance(1),l.\u0275\u0275property("ngIf",l.\u0275\u0275pipeBind1(2,1,M.selectedItem$))}}var oe=function(D){function C(M){var E=D.call(this)||this;return E.fontService=M,E.onFontFamilyChange=new l.EventEmitter,E.maxHeight=324,E}return(0,B.ZT)(C,D),C.prototype.ngOnInit=function(){this.isDisabled$=this.mergePropertyInputsAndFormControl(this.changes$("isDisabled"),this.disabled$,"isDisabled",this.onDestroy$),this.populateFontPickerItems()},C.prototype.populateFontPickerItems=function(){var M=this,E=this.mergePropertyInputsAndFormControl(this.changes$("fontFamily"),this.value$,"fontFamily",this.onDestroy$).pipe((0,ce.U)(function(R){return M.normalizeFontFamily(R)}),(0,ne.R)(this.onDestroy$),(0,J.x)());this.fontPickerItems$=(0,U.of)(this.fontService.getAllFonts()).pipe((0,ce.U)(function(R){return R.map(function(z){return M.getFontPickerItem(z)})})),this.selectedItem$=(0,se.aj)([E,this.fontPickerItems$]).pipe((0,ce.U)(function(R){var z,re=R[0];return null!==(z=_.find(R[1],function(pe){return pe.family===re}))&&void 0!==z?z:M.getCustomFontPickerInfo(re)}))},C.prototype.normalizeFontFamily=function(M){return(M??"").split(", ").map(function(E){return E.indexOf(" ")>0&&!E.startsWith("'")?"'".concat(E,"'"):E}).join(", ")},C.prototype.getFontPickerItem=function(M){return{displayName:M.displayName,family:M.family,style:{fontFamily:M.suppressStyle?void 0:M.family}}},C.prototype.setFontFamily=function(M){var E=M.family;this.onFontFamilyChange.emit(E),this.onValueChange(E),this.onTouched()},C.prototype.getCustomFontPickerInfo=function(M){return{displayName:M?j(M):"",family:M,style:{fontFamily:M}}},C.\u0275fac=function(E){return new(E||C)(l.\u0275\u0275directiveInject(le))},C.\u0275cmp=l.\u0275\u0275defineComponent({type:C,selectors:[["font-picker"]],inputs:{fontFamily:"fontFamily",ariaLabel:"ariaLabel",ariaDescribedby:"ariaDescribedby",ariaLabelledby:"ariaLabelledby",compact:"compact",isDisabled:"isDisabled",showFullContent:"showFullContent",size:"size"},outputs:{onFontFamilyChange:"onFontFamilyChange"},features:[l.\u0275\u0275ProvidersFeature([{provide:A.JU,useExisting:(0,l.forwardRef)(function(){return C}),multi:!0}]),l.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],[3,"aria-label","aria-labelledby","aria-describedby","compact","size","maxHeight","options","value","isDisabled","valueChange",4,"ngIf"],[3,"aria-label","aria-labelledby","aria-describedby","compact","size","maxHeight","options","value","isDisabled","valueChange"],[3,"ngStyle"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(E,R){1&E&&(l.\u0275\u0275template(0,ie,3,3,"ng-container",0),l.\u0275\u0275pipe(1,"async")),2&E&&l.\u0275\u0275property("ngIf",l.\u0275\u0275pipeBind1(1,1,R.fontPickerItems$))},dependencies:[Q.NgForOf,Q.NgIf,Q.NgStyle,Y.H,ee.r,ge._,Y.T,Q.AsyncPipe],styles:["pbi-dropdown[_ngcontent-%COMP%]{width:100%}pbi-dropdown-trigger[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}pbi-dropdown-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:auto}"],changeDetection:0}),C}(e.N)},45925:function(ve,W,u){u.d(W,{e:function(){return j}});var B=u(6015),l=u(77476),A=u(17174),F=u(50423),j=function(){function e(){}return e.\u0275fac=function(se){return new(se||e)},e.\u0275mod=F.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=F.\u0275\u0275defineInjector({imports:[l.CommonModule,A.u5,B.C,A.UX]}),e}()},53935:function(ve,W,u){u.d(W,{e:function(){return A}});var B=u(77476),l=u(50423),A=function(){function F(){}return F.\u0275fac=function(e){return new(e||F)},F.\u0275mod=l.\u0275\u0275defineNgModule({type:F}),F.\u0275inj=l.\u0275\u0275defineInjector({imports:[B.CommonModule]}),F}()}}]);