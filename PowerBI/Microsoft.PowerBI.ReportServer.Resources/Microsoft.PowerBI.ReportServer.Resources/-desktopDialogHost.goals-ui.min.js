(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["goals-ui"],{77489:function(Pt){Pt.exports=function(m,M){(null==M||M>m.length)&&(M=m.length);for(var u=0,e=new Array(M);u<M;u++)e[u]=m[u];return e},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},32878:function(Pt){function vt(M,u){for(var e=0;e<u.length;e++){var F=u[e];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(M,F.key,F)}}Pt.exports=function(M,u,e){return u&&vt(M.prototype,u),e&&vt(M,e),M},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},34850:function(Pt,vt,m){var M=m(91052);Pt.exports=function(e,F){var oe=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(oe)return(oe=oe.call(e)).next.bind(oe);if(Array.isArray(e)||(oe=M(e))||F&&e&&"number"==typeof e.length){oe&&(e=oe);var D=0;return function(){return D>=e.length?{done:!0}:{done:!1,value:e[D++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},12864:function(Pt,vt,m){var M=m(74);Pt.exports=function(e,F){e.prototype=Object.create(F.prototype),e.prototype.constructor=e,M(e,F)},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},74:function(Pt){function vt(m,M){return Pt.exports=vt=Object.setPrototypeOf||function(e,F){return e.__proto__=F,e},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0,vt(m,M)}Pt.exports=vt,Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},91052:function(Pt,vt,m){var M=m(77489);Pt.exports=function(e,F){if(e){if("string"==typeof e)return M(e,F);var oe=Object.prototype.toString.call(e).slice(8,-1);if("Object"===oe&&e.constructor&&(oe=e.constructor.name),"Map"===oe||"Set"===oe)return Array.from(e);if("Arguments"===oe||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(oe))return M(e,F)}},Pt.exports.default=Pt.exports,Pt.exports.__esModule=!0},36444:function(Pt,vt,m){var M=m(32878).default,u=m(12864).default,e=m(34850).default;function F(){"use strict";F=function(){return D};var oe,D={},Re=Object.prototype,Be=Re.hasOwnProperty,Ee=Object.defineProperty||function(Me,Ge,Te){Me[Ge]=Te.value},pe="function"==typeof Symbol?Symbol:{},R=pe.iterator||"@@iterator",Fe=pe.asyncIterator||"@@asyncIterator",De=pe.toStringTag||"@@toStringTag";function G(Me,Ge,Te){return Object.defineProperty(Me,Ge,{value:Te,enumerable:!0,configurable:!0,writable:!0}),Me[Ge]}try{G({},"")}catch{G=function(Te,Ve,_t){return Te[Ve]=_t}}function We(Me,Ge,Te,Ve){var yt=Object.create((Ge&&Ge.prototype instanceof He?Ge:He).prototype),tt=new ct(Ve||[]);return Ee(yt,"_invoke",{value:ae(Me,Te,tt)}),yt}function Ue(Me,Ge,Te){try{return{type:"normal",arg:Me.call(Ge,Te)}}catch(Ve){return{type:"throw",arg:Ve}}}D.wrap=We;var ne="suspendedStart",se="suspendedYield",ve="executing",Se="completed",W={};function He(){}function he(){}function ye(){}var je={};G(je,R,function(){return this});var rt=Object.getPrototypeOf,Ke=rt&&rt(rt(Ct([])));Ke&&Ke!==Re&&Be.call(Ke,R)&&(je=Ke);var Q=ye.prototype=He.prototype=Object.create(je);function K(Me){["next","throw","return"].forEach(function(Ge){G(Me,Ge,function(Te){return this._invoke(Ge,Te)})})}function ee(Me,Ge){function Te(_t,yt,tt,zt){var k=Ue(Me[_t],Me,yt);if("throw"!==k.type){var Cn=k.arg,It=Cn.value;return It&&"object"==typeof It&&Be.call(It,"__await")?Ge.resolve(It.__await).then(function(nt){Te("next",nt,tt,zt)},function(nt){Te("throw",nt,tt,zt)}):Ge.resolve(It).then(function(nt){Cn.value=nt,tt(Cn)},function(nt){return Te("throw",nt,tt,zt)})}zt(k.arg)}var Ve;Ee(this,"_invoke",{value:function(yt,tt){function zt(){return new Ge(function(k,Cn){Te(yt,tt,k,Cn)})}return Ve=Ve?Ve.then(zt,zt):zt()}})}function ae(Me,Ge,Te){var Ve=ne;return function(_t,yt){if(Ve===ve)throw new Error("Generator is already running");if(Ve===Se){if("throw"===_t)throw yt;return{value:oe,done:!0}}for(Te.method=_t,Te.arg=yt;;){var tt=Te.delegate;if(tt){var zt=fe(tt,Te);if(zt){if(zt===W)continue;return zt}}if("next"===Te.method)Te.sent=Te._sent=Te.arg;else if("throw"===Te.method){if(Ve===ne)throw Ve=Se,Te.arg;Te.dispatchException(Te.arg)}else"return"===Te.method&&Te.abrupt("return",Te.arg);Ve=ve;var k=Ue(Me,Ge,Te);if("normal"===k.type){if(Ve=Te.done?Se:se,k.arg===W)continue;return{value:k.arg,done:Te.done}}"throw"===k.type&&(Ve=Se,Te.method="throw",Te.arg=k.arg)}}}function fe(Me,Ge){var Te=Ge.method,Ve=Me.iterator[Te];if(Ve===oe)return Ge.delegate=null,"throw"===Te&&Me.iterator.return&&(Ge.method="return",Ge.arg=oe,fe(Me,Ge),"throw"===Ge.method)||"return"!==Te&&(Ge.method="throw",Ge.arg=new TypeError("The iterator does not provide a '"+Te+"' method")),W;var _t=Ue(Ve,Me.iterator,Ge.arg);if("throw"===_t.type)return Ge.method="throw",Ge.arg=_t.arg,Ge.delegate=null,W;var yt=_t.arg;return yt?yt.done?(Ge[Me.resultName]=yt.value,Ge.next=Me.nextLoc,"return"!==Ge.method&&(Ge.method="next",Ge.arg=oe),Ge.delegate=null,W):yt:(Ge.method="throw",Ge.arg=new TypeError("iterator result is not an object"),Ge.delegate=null,W)}function me(Me){var Ge={tryLoc:Me[0]};1 in Me&&(Ge.catchLoc=Me[1]),2 in Me&&(Ge.finallyLoc=Me[2],Ge.afterLoc=Me[3]),this.tryEntries.push(Ge)}function $e(Me){var Ge=Me.completion||{};Ge.type="normal",delete Ge.arg,Me.completion=Ge}function ct(Me){this.tryEntries=[{tryLoc:"root"}],Me.forEach(me,this),this.reset(!0)}function Ct(Me){if(Me||""===Me){var Ge=Me[R];if(Ge)return Ge.call(Me);if("function"==typeof Me.next)return Me;if(!isNaN(Me.length)){var Te=-1,Ve=function _t(){for(;++Te<Me.length;)if(Be.call(Me,Te))return _t.value=Me[Te],_t.done=!1,_t;return _t.value=oe,_t.done=!0,_t};return Ve.next=Ve}}throw new TypeError(typeof Me+" is not iterable")}return he.prototype=ye,Ee(Q,"constructor",{value:ye,configurable:!0}),Ee(ye,"constructor",{value:he,configurable:!0}),he.displayName=G(ye,De,"GeneratorFunction"),D.isGeneratorFunction=function(Me){var Ge="function"==typeof Me&&Me.constructor;return!!Ge&&(Ge===he||"GeneratorFunction"===(Ge.displayName||Ge.name))},D.mark=function(Me){return Object.setPrototypeOf?Object.setPrototypeOf(Me,ye):(Me.__proto__=ye,G(Me,De,"GeneratorFunction")),Me.prototype=Object.create(Q),Me},D.awrap=function(Me){return{__await:Me}},K(ee.prototype),G(ee.prototype,Fe,function(){return this}),D.AsyncIterator=ee,D.async=function(Me,Ge,Te,Ve,_t){void 0===_t&&(_t=Promise);var yt=new ee(We(Me,Ge,Te,Ve),_t);return D.isGeneratorFunction(Ge)?yt:yt.next().then(function(tt){return tt.done?tt.value:yt.next()})},K(Q),G(Q,De,"Generator"),G(Q,R,function(){return this}),G(Q,"toString",function(){return"[object Generator]"}),D.keys=function(Me){var Ge=Object(Me),Te=[];for(var Ve in Ge)Te.push(Ve);return Te.reverse(),function _t(){for(;Te.length;){var yt=Te.pop();if(yt in Ge)return _t.value=yt,_t.done=!1,_t}return _t.done=!0,_t}},D.values=Ct,ct.prototype={constructor:ct,reset:function(Ge){if(this.prev=0,this.next=0,this.sent=this._sent=oe,this.done=!1,this.delegate=null,this.method="next",this.arg=oe,this.tryEntries.forEach($e),!Ge)for(var Te in this)"t"===Te.charAt(0)&&Be.call(this,Te)&&!isNaN(+Te.slice(1))&&(this[Te]=oe)},stop:function(){this.done=!0;var Ge=this.tryEntries[0].completion;if("throw"===Ge.type)throw Ge.arg;return this.rval},dispatchException:function(Ge){if(this.done)throw Ge;var Te=this;function Ve(Cn,It){return tt.type="throw",tt.arg=Ge,Te.next=Cn,It&&(Te.method="next",Te.arg=oe),!!It}for(var _t=this.tryEntries.length-1;_t>=0;--_t){var yt=this.tryEntries[_t],tt=yt.completion;if("root"===yt.tryLoc)return Ve("end");if(yt.tryLoc<=this.prev){var zt=Be.call(yt,"catchLoc"),k=Be.call(yt,"finallyLoc");if(zt&&k){if(this.prev<yt.catchLoc)return Ve(yt.catchLoc,!0);if(this.prev<yt.finallyLoc)return Ve(yt.finallyLoc)}else if(zt){if(this.prev<yt.catchLoc)return Ve(yt.catchLoc,!0)}else{if(!k)throw new Error("try statement without catch or finally");if(this.prev<yt.finallyLoc)return Ve(yt.finallyLoc)}}}},abrupt:function(Ge,Te){for(var Ve=this.tryEntries.length-1;Ve>=0;--Ve){var _t=this.tryEntries[Ve];if(_t.tryLoc<=this.prev&&Be.call(_t,"finallyLoc")&&this.prev<_t.finallyLoc){var yt=_t;break}}yt&&("break"===Ge||"continue"===Ge)&&yt.tryLoc<=Te&&Te<=yt.finallyLoc&&(yt=null);var tt=yt?yt.completion:{};return tt.type=Ge,tt.arg=Te,yt?(this.method="next",this.next=yt.finallyLoc,W):this.complete(tt)},complete:function(Ge,Te){if("throw"===Ge.type)throw Ge.arg;return"break"===Ge.type||"continue"===Ge.type?this.next=Ge.arg:"return"===Ge.type?(this.rval=this.arg=Ge.arg,this.method="return",this.next="end"):"normal"===Ge.type&&Te&&(this.next=Te),W},finish:function(Ge){for(var Te=this.tryEntries.length-1;Te>=0;--Te){var Ve=this.tryEntries[Te];if(Ve.finallyLoc===Ge)return this.complete(Ve.completion,Ve.afterLoc),$e(Ve),W}},catch:function(Ge){for(var Te=this.tryEntries.length-1;Te>=0;--Te){var Ve=this.tryEntries[Te];if(Ve.tryLoc===Ge){var _t=Ve.completion;if("throw"===_t.type){var yt=_t.arg;$e(Ve)}return yt}}throw new Error("illegal catch attempt")},delegateYield:function(Ge,Te,Ve){return this.delegate={iterator:Ct(Ge),resultName:Te,nextLoc:Ve},"next"===this.method&&(this.arg=oe),W}},D}typeof self<"u"&&self,Pt.exports=function(){var Ee,pe,oe={302:function(pe,R,Fe){var G;R.formatArgs=function(G){if(G[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+G[0]+(this.useColors?"%c ":" ")+"+"+pe.exports.humanize(this.diff),this.useColors){var We="color: "+this.color;G.splice(1,0,We,"color: inherit");var Ue=0,ne=0;G[0].replace(/%[a-zA-Z%]/g,function(se){"%%"!==se&&(Ue++,"%c"===se&&(ne=Ue))}),G.splice(ne,0,We)}},R.save=function(G){try{G?R.storage.setItem("debug",G):R.storage.removeItem("debug")}catch{}},R.load=function(){var G;try{G=R.storage.getItem("debug")}catch{}return!G&&typeof process<"u"&&"env"in process&&(G=process.env.DEBUG),G},R.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},R.storage=function(){try{return localStorage}catch{}}(),R.destroy=(G=!1,function(){G||(G=!0)}),R.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],R.log=console.debug||console.log||function(){},pe.exports=Fe(65)(R),pe.exports.formatters.j=function(G){try{return JSON.stringify(G)}catch(We){return"[UnexpectedJSONParseError]: "+We.message}}},65:function(pe,R,Fe){pe.exports=function(De){function G(ne){var se,ve,Se,W=null;function He(){for(var he=arguments.length,ye=new Array(he),je=0;je<he;je++)ye[je]=arguments[je];if(He.enabled){var rt=He,Ke=Number(new Date);rt.diff=Ke-(se||Ke),rt.prev=se,rt.curr=Ke,se=Ke,ye[0]=G.coerce(ye[0]),"string"!=typeof ye[0]&&ye.unshift("%O");var K=0;ye[0]=ye[0].replace(/%([a-zA-Z%])/g,function(ee,ae){if("%%"===ee)return"%";K++;var fe=G.formatters[ae];return"function"==typeof fe&&(ee=fe.call(rt,ye[K]),ye.splice(K,1),K--),ee}),G.formatArgs.call(rt,ye),(rt.log||G.log).apply(rt,ye)}}return He.namespace=ne,He.useColors=G.useColors(),He.color=G.selectColor(ne),He.extend=We,He.destroy=G.destroy,Object.defineProperty(He,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==W?W:(ve!==G.namespaces&&(ve=G.namespaces,Se=G.enabled(ne)),Se)},set:function(ye){W=ye}}),"function"==typeof G.init&&G.init(He),He}function We(ne,se){var ve=G(this.namespace+(void 0===se?":":se)+ne);return ve.log=this.log,ve}function Ue(ne){return ne.toString().substring(2,ne.toString().length-2).replace(/\.\*\?$/,"*")}return G.debug=G,G.default=G,G.coerce=function(ne){return ne instanceof Error?ne.stack||ne.message:ne},G.disable=function(){var ne=[].concat(G.names.map(Ue),G.skips.map(Ue).map(function(se){return"-"+se})).join(",");return G.enable(""),ne},G.enable=function(ne){var se;G.save(ne),G.namespaces=ne,G.names=[],G.skips=[];var ve=("string"==typeof ne?ne:"").split(/[\s,]+/),Se=ve.length;for(se=0;se<Se;se++)ve[se]&&("-"===(ne=ve[se].replace(/\*/g,".*?"))[0]?G.skips.push(new RegExp("^"+ne.slice(1)+"$")):G.names.push(new RegExp("^"+ne+"$")))},G.enabled=function(ne){if("*"===ne[ne.length-1])return!0;var se,ve;for(se=0,ve=G.skips.length;se<ve;se++)if(G.skips[se].test(ne))return!1;for(se=0,ve=G.names.length;se<ve;se++)if(G.names[se].test(ne))return!0;return!1},G.humanize=Fe(247),G.destroy=function(){},Object.keys(De).forEach(function(ne){G[ne]=De[ne]}),G.names=[],G.skips=[],G.formatters={},G.selectColor=function(ne){for(var se=0,ve=0;ve<ne.length;ve++)se=(se<<5)-se+ne.charCodeAt(ve),se|=0;return G.colors[Math.abs(se)%G.colors.length]},G.enable(G.load()),G}},247:function(pe){var R=1e3,Fe=60*R,De=60*Fe,G=24*De;function se(ve,Se,W,He){var he=Se>=1.5*W;return Math.round(ve/W)+" "+He+(he?"s":"")}pe.exports=function(ve,Se){Se=Se||{};var W=typeof ve;if("string"===W&&ve.length>0)return function(ve){if(!((ve=String(ve)).length>100)){var Se=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ve);if(Se){var W=parseFloat(Se[1]);switch((Se[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*W;case"weeks":case"week":case"w":return 6048e5*W;case"days":case"day":case"d":return W*G;case"hours":case"hour":case"hrs":case"hr":case"h":return W*De;case"minutes":case"minute":case"mins":case"min":case"m":return W*Fe;case"seconds":case"second":case"secs":case"sec":case"s":return W*R;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return W;default:return}}}}(ve);if("number"===W&&isFinite(ve))return Se.long?function(ve){var Se=Math.abs(ve);return Se>=G?se(ve,Se,G,"day"):Se>=De?se(ve,Se,De,"hour"):Se>=Fe?se(ve,Se,Fe,"minute"):Se>=R?se(ve,Se,R,"second"):ve+" ms"}(ve):function(ve){var Se=Math.abs(ve);return Se>=G?Math.round(ve/G)+"d":Se>=De?Math.round(ve/De)+"h":Se>=Fe?Math.round(ve/Fe)+"m":Se>=R?Math.round(ve/R)+"s":ve+"ms"}(ve);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ve))}}},D={};function Re(Ee){var pe=D[Ee];if(void 0!==pe)return pe.exports;var R=D[Ee]={exports:{}};return oe[Ee](R,R.exports,Re),R.exports}pe=Object.getPrototypeOf?function(R){return Object.getPrototypeOf(R)}:function(R){return R.__proto__},Re.t=function(R,Fe){if(1&Fe&&(R=this(R)),8&Fe||"object"==typeof R&&R&&(4&Fe&&R.__esModule||16&Fe&&"function"==typeof R.then))return R;var De=Object.create(null);Re.r(De);var G={};Ee=Ee||[null,pe({}),pe([]),pe(pe)];for(var We=2&Fe&&R;"object"==typeof We&&!~Ee.indexOf(We);We=pe(We))Object.getOwnPropertyNames(We).forEach(function(Ue){return G[Ue]=function(){return R[Ue]}});return G.default=function(){return R},Re.d(De,G),De},Re.d=function(Ee,pe){for(var R in pe)Re.o(pe,R)&&!Re.o(Ee,R)&&Object.defineProperty(Ee,R,{enumerable:!0,get:pe[R]})},Re.o=function(Ee,pe){return Object.prototype.hasOwnProperty.call(Ee,pe)},Re.r=function(Ee){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Ee,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ee,"__esModule",{value:!0})};var Be={};return function(){"use strict";Re.r(Be),Re.d(Be,{ActionObjectType:function(){return Ge},ChannelType:function(){return be},ChildAppWindow:function(){return Lo},DialogDimension:function(){return nt},ErrorCode:function(){return Ve},FileOpenPreference:function(){return Me},FrameContexts:function(){return k},HostClientType:function(){return tt},HostName:function(){return zt},LiveShareHost:function(){return Zo},NotificationTypes:function(){return Do},ParentAppWindow:function(){return no},SecondaryM365ContentIdName:function(){return Te},TaskModuleDimension:function(){return de},TeamType:function(){return Cn},UserSettingTypes:function(){return Zi},UserTeamRole:function(){return It},ViewerActionTypes:function(){return ko},app:function(){return Yn},appEntity:function(){return Qn},appInitialization:function(){return Fr},appInstallDialog:function(){return Ji},authentication:function(){return Ui},barCode:function(){return Hr},calendar:function(){return Mi},call:function(){return uo},chat:function(){return Ao},clipboard:function(){return oi},conversations:function(){return ri},dialog:function(){return mr},enablePrintCapability:function(){return Ha},executeDeepLink:function(){return yr},externalAppAuthentication:function(){return Xr},externalAppCardActions:function(){return ki},files:function(){return qt},geoLocation:function(){return Ci},getAdaptiveCardSchemaVersion:function(){return Ro},getContext:function(){return za},getMruTabInstances:function(){return mo},getTabInstances:function(){return fo},initialize:function(){return Na},initializeWithFrameContext:function(){return Ei},liveShare:function(){return ui},location:function(){return wi},logs:function(){return Io},mail:function(){return Pi},marketplace:function(){return fi},media:function(){return $n},meeting:function(){return ai},meetingRoom:function(){return Zr},menus:function(){return qi},monetization:function(){return Si},navigateBack:function(){return Ko},navigateCrossDomain:function(){return Qo},navigateToTab:function(){return Ti},notifications:function(){return Ar},openFilePreview:function(){return Yi},pages:function(){return hn},people:function(){return io},print:function(){return qo},profile:function(){return si},registerAppButtonClickHandler:function(){return Ba},registerAppButtonHoverEnterHandler:function(){return Wo},registerAppButtonHoverLeaveHandler:function(){return ho},registerBackButtonHandler:function(){return li},registerBeforeUnloadHandler:function(){return ci},registerChangeSettingsHandler:function(){return go},registerCustomHandler:function(){return Oa},registerFocusEnterHandler:function(){return jo},registerFullScreenHandler:function(){return Oi},registerOnLoadHandler:function(){return Sn},registerOnThemeChangeHandler:function(){return pr},registerUserSettingsChangeHandler:function(){return Ps},remoteCamera:function(){return Vi},returnFocus:function(){return $o},search:function(){return No},secondaryBrowser:function(){return yi},sendCustomEvent:function(){return Ms},sendCustomMessage:function(){return Ss},setFrameContext:function(){return Kr},settings:function(){return xi},shareDeepLink:function(){return Qr},sharing:function(){return Jn},stageView:function(){return cr},tasks:function(){return Di},teams:function(){return br},teamsCore:function(){return Br},thirdPartyCloudStorage:function(){return po},uploadCustomApp:function(){return ws},version:function(){return zi},videoEffects:function(){return lr},videoEffectsEx:function(){return Yr},visualMedia:function(){return lo},webStorage:function(){return co}});var De,G,s,Ee=(0,Re(302).debug)("teamsJs");function pe(s){return Ee.extend(s)}function R(s,h){return s+"_"+h}function Fe(s){return/^v\d+_[\w.]+$/.test(s)}(s=De||(De={})).V_0="v0",s.V_1="v1",s.V_2="v2",s.V_3="v3",function(s){s.App_GetContext="app.getContext",s.App_Initialize="app.initialize",s.App_NotifyAppLoaded="app.notifyAppLoaded",s.App_NotifyExpectedFailure="app.notifyExpectedFailure",s.App_NotifyFailure="app.notifyFailure",s.App_NotifySuccess="app.notifySuccess",s.App_OpenLink="app.openLink",s.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",s.AppEntity_SelectAppEntity="appEntity.selectAppEntity",s.BarCode_HasPermission="barCode.hasPermission",s.BarCode_RequestPermission="barCode.requestPermission",s.BarCode_ScanBarCode="barCode.scanBarCode",s.Calendar_ComposeMeeting="calendar.composeMeeting",s.Calendar_OpenCalendarItem="calendar.openCalendarItem",s.Call_StartCall="call.startCall",s.Clipboard_Read="clipboard.read",s.Clipboard_Write="clipboard.write",s.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",s.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",s.Dialog_Update_Resize="dialog.update.resize",s.Dialog_Url_Bot_Open="dialog.url.bot.open",s.Dialog_Url_Open="dialog.url.open",s.Dialog_Url_Submit="dialog.url.submit",s.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",s.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",s.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",s.GeoLocation_HasPermission="geoLocation.hasPermission",s.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",s.GeoLocation_RequestPermission="geoLocation.hasPermission",s.GeoLocation_ShowLocation="geoLocation.showLocation",s.Location_GetLocation="location.getLocation",s.Location_ShowLocation="location.showLocation",s.Mail_ComposeMail="mail.composeMail",s.Mail_OpenMailItem="mail.openMailItem",s.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",s.Marketplace_GetCart="marketplace.getCart",s.Marketplace_RemoveCardItems="marketplace.removeCartItems",s.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",s.Media_CaptureImage="media.captureImage",s.Media_Controller="media.controller",s.Media_GetMedia="media.getMedia",s.Media_HasPermission="media.hasPermission",s.Media_RequestPermission="media.requestPermission",s.Media_ScanBarCode="media.scanBarCode",s.Media_SelectMedia="media.selectMedia",s.Media_ViewImages="media.viewImages",s.Navigation_NavigateBack="navigation.navigateBack",s.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",s.Navigation_NavigateToTab="navigation.navigateToTab",s.Navigation_ReturnFocus="navigation.returnFocus",s.Pages_AppButton_OnClick="pages.appButton.onClick",s.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",s.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",s.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",s.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",s.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",s.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",s.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",s.Pages_Config_SetConfig="pages.config.setConfig",s.Pages_Config_SetValidityState="pages.config.setValidityState",s.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",s.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",s.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",s.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",s.Pages_GetConfig="pages.getConfig.",s.Pages_NavigateCrossDomain="pages.navigateCrossDomain",s.Pages_NavigateToApp="pages.navigateToApp",s.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",s.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",s.Pages_ReturnFocus="pages.returnFocus",s.Pages_SetCurrentFrame="pages.setCurrentFrame",s.Pages_ShareDeepLink="pages.shareDeepLink",s.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",s.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",s.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",s.PublicAPIs_ExecuteDeepLink="executeDeepLink",s.PublicAPIs_GetContext="getContext",s.PublicAPIs_GetMruTabInstances="getMruTabInstances",s.PublicAPIs_GetTabInstances="getTabInstances",s.PublicAPIs_Initialize="initialize",s.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",s.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",s.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",s.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",s.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",s.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",s.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",s.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",s.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",s.PublicAPIs_SetFrameContext="setFrameContext",s.PublicAPIs_ShareDeepLink="shareDeepLink",s.RegisterHandler="registerHandler",s.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",s.Settings_Remove_Failure="settings.remove.failure",s.Settings_Remove_Success="settings.remove.success",s.Settings_Save_Failure="settings.save.failure",s.Settings_Save_Success="settings.save.success",s.Tasks_StartTask="tasks.startTask",s.Tasks_SubmitTask="tasks.submitTask",s.Tasks_UpdateTask="tasks.updateTask"}(G||(G={}));var We=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),Ue="2.0.1",ve="1.8.0",Se=Re.t(We,2).validOrigins,W=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),He=/^https:\/\//,he="https",ye="teams.microsoft.com",je="The library has not yet been initialized",rt="The runtime has not yet been initialized",Ke="The runtime version is not supported",Q=function(){};Q.initializeCalled=!1,Q.initializeCompleted=!1,Q.additionalValidOrigins=[],Q.initializePromise=void 0,Q.isFramelessWindow=!1,Q.frameContext=void 0,Q.hostClientType=void 0,Q.printCapabilityEnabled=!1;var ee,K={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},ae=new Uint8Array(16);function fe(){if(!ee&&!(ee=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ee(ae)}for(var me=[],$e=0;$e<256;++$e)me.push(($e+256).toString(16).slice(1));var Me,Ge,Te,Ve,_t,yt,tt,zt,k,Cn,It,nt,Ct=function(h,b,w){if(K.randomUUID&&!b&&!h)return K.randomUUID();var C=(h=h||{}).random||(h.rng||fe)();if(C[6]=15&C[6]|64,C[8]=63&C[8]|128,b){w=w||0;for(var P=0;P<16;++P)b[w+P]=C[P];return b}return function(s,h){return void 0===h&&(h=0),(me[s[h+0]]+me[s[h+1]]+me[s[h+2]]+me[s[h+3]]+"-"+me[s[h+4]]+me[s[h+5]]+"-"+me[s[h+6]]+me[s[h+7]]+"-"+me[s[h+8]]+me[s[h+9]]+"-"+me[s[h+10]]+me[s[h+11]]+me[s[h+12]]+me[s[h+13]]+me[s[h+14]]+me[s[h+15]]).toLowerCase()}(C)};(function(s){s.Inline="inline",s.Desktop="desktop",s.Web="web"})(Me||(Me={})),function(s){s.M365Content="m365content"}(Ge||(Ge={})),function(s){s.DriveId="driveId",s.GroupId="groupId",s.SiteId="siteId",s.UserId="userId"}(Te||(Te={})),function(s){s[s.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",s[s.INTERNAL_ERROR=500]="INTERNAL_ERROR",s[s.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",s[s.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",s[s.NETWORK_ERROR=2e3]="NETWORK_ERROR",s[s.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",s[s.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",s[s.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",s[s.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",s[s.THROTTLE=7e3]="THROTTLE",s[s.USER_ABORT=8e3]="USER_ABORT",s[s.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",s[s.OLD_PLATFORM=9e3]="OLD_PLATFORM",s[s.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",s[s.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(Ve||(Ve={})),function(s){s.GeoLocation="geolocation",s.Media="media"}(_t||(_t={})),function(s){s.TextPlain="text/plain",s.TextHtml="text/html",s.ImagePNG="image/png",s.ImageJPEG="image/jpeg"}(yt||(yt={})),function(s){s.desktop="desktop",s.web="web",s.android="android",s.ios="ios",s.ipados="ipados",s.macos="macos",s.rigel="rigel",s.surfaceHub="surfaceHub",s.teamsRoomsWindows="teamsRoomsWindows",s.teamsRoomsAndroid="teamsRoomsAndroid",s.teamsPhones="teamsPhones",s.teamsDisplays="teamsDisplays"}(tt||(tt={})),function(s){s.office="Office",s.outlook="Outlook",s.outlookWin32="OutlookWin32",s.orange="Orange",s.places="Places",s.teams="Teams",s.teamsModern="TeamsModern"}(zt||(zt={})),function(s){s.settings="settings",s.content="content",s.authentication="authentication",s.remove="remove",s.task="task",s.sidePanel="sidePanel",s.stage="stage",s.meetingStage="meetingStage"}(k||(k={})),function(s){s[s.Standard=0]="Standard",s[s.Edu=1]="Edu",s[s.Class=2]="Class",s[s.Plc=3]="Plc",s[s.Staff=4]="Staff"}(Cn||(Cn={})),function(s){s[s.Admin=0]="Admin",s[s.User=1]="User",s[s.Guest=2]="Guest"}(It||(It={})),function(s){s.Large="large",s.Medium="medium",s.Small="small"}(nt||(nt={}));var be,de=nt;!function(s){s.Regular="Regular",s.Private="Private",s.Shared="Shared"}(be||(be={}));var V={errorCode:Ve.NOT_SUPPORTED_ON_PLATFORM},sn={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},Mn=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),fn=new Error("Invalid response: Received more images than the specified max limit in the response.");function jt(s){return function(h,b){if(!h)throw new Error(s||b)}}function Tt(s,h){if("string"!=typeof s||"string"!=typeof h)return NaN;var b=s.split("."),w=h.split(".");function C(z){return/^\d+$/.test(z)}if(!b.every(C)||!w.every(C))return NaN;for(;b.length<w.length;)b.push("0");for(;w.length<b.length;)w.push("0");for(var P=0;P<b.length;++P)if(Number(b[P])!=Number(w[P]))return Number(b[P])>Number(w[P])?1:-1;return 0}function Dt(){return Ct()}function ke(s){return Object.keys(s).forEach(function(h){"object"==typeof s[h]&&ke(s[h])}),Object.freeze(s)}function S(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];var P=s.apply(void 0,w);return P.then(function(){h&&h(null)}).catch(function(z){h&&h(z)}),P}function U(s){return!(Tt(s.majorVersion+"."+s.minorVersion,"1.5")>=0)}function le(s){return"https:"===s.protocol}function Pe(s,h){return new Promise(function(b,w){s||w("MimeType cannot be null or empty."),h||w("Base64 string cannot be null or empty.");var C=atob(h);if(s.startsWith("image/")){for(var P=new Uint8Array(C.length),z=0;z<C.length;z++)P[z]=C.charCodeAt(z);b(new Blob([P],{type:s}))}b(new Blob([C],{type:s}))})}function qe(s){return new Promise(function(h,b){0===s.size&&b(new Error("Blob cannot be empty."));var w=new FileReader;w.onloadend=function(){w.result?h(w.result.toString().split(",")[1]):b(new Error("Failed to read the blob"))},w.onerror=function(){b(w.error)},w.readAsDataURL(s)})}function St(){if(Et())throw new Error("window object undefined at SSR check");return window}function Et(){return typeof window>"u"}var at=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Lt(s){if(!at.test(s))throw new Error("App ID is not valid. Must be GUID format. App ID: "+s)}var on=pe("runtime"),An=3;function er(s){return s.apiVersion===An}var T={apiVersion:-1,supports:{}},Za={apiVersion:3,hostVersionsInfo:sn,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},da=[tt.desktop,tt.web,tt.rigel,tt.surfaceHub,tt.teamsRoomsWindows,tt.teamsRoomsAndroid,tt.teamsPhones,tt.teamsDisplays],Li=[].concat(da,[tt.android,tt.ios,tt.ipados]);var Ya=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(h){var b;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:h.isLegacyTeams,supports:Object.assign(Object.assign({},h.supports),{dialog:h.supports.dialog?{card:void 0,url:h.supports.dialog,update:null===(b=h.supports.dialog)||void 0===b?void 0:b.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(h){var C=function(h,b){var w={};for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&b.indexOf(C)<0&&(w[C]=h[C]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var P=0;for(C=Object.getOwnPropertySymbols(h);P<C.length;P++)b.indexOf(C[P])<0&&Object.prototype.propertyIsEnumerable.call(h,C[P])&&(w[C[P]]=h[C[P]])}return w}(h.supports,["appNotification"]);return Object.assign(Object.assign({},h),{apiVersion:3,supports:C})}}],bo={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:da}],"1.9.0":[{capability:{location:{}},hostClientTypes:Li}],"2.0.0":[{capability:{people:{}},hostClientTypes:Li},{capability:{sharing:{}},hostClientTypes:[tt.desktop,tt.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[tt.android,tt.desktop,tt.ios,tt.teamsRoomsAndroid,tt.teamsPhones,tt.teamsDisplays,tt.web]},{capability:{webStorage:{}},hostClientTypes:[tt.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[tt.android,tt.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[tt.android,tt.ios]}]},Jr=on.extend("generateBackCompatRuntimeConfig");function ha(s,h){var b=Object.assign({},s);for(var w in h)Object.prototype.hasOwnProperty.call(h,w)&&("object"!=typeof h[w]||Array.isArray(h[w])?w in s||(b[w]=h[w]):b[w]=ha(s[w]||{},h[w]));return b}function Gi(s,h,b){Jr("generating back compat runtime config for %s",s);var w=Object.assign({},h.supports);Jr("Supported capabilities in config before updating based on highestSupportedVersion: %o",w),Object.keys(b).forEach(function(P){Tt(s,P)>=0&&b[P].forEach(function(z){void 0!==Q.hostClientType&&z.hostClientTypes.includes(Q.hostClientType)&&(w=ha(w,z.capability))})});var C={apiVersion:An,hostVersionsInfo:sn,isLegacyTeams:!0,supports:w};return Jr("Runtime config after updating based on highestSupportedVersion: %o",C),C}var Ni=on.extend("applyRuntimeConfig");function Hi(s){"string"==typeof s.apiVersion&&(Ni("Trying to apply runtime with string apiVersion, processing as v1: %o",s),s=Object.assign(Object.assign({},s),{apiVersion:1})),Ni("Fast-forwarding runtime %o",s);var h=function(s){var h=s;if(h.apiVersion<An&&Ya.forEach(function(b){h.apiVersion===b.versionToUpgradeFrom&&(h=b.upgradeToNextVersion(h))}),er(h))return h;throw new Error("Received a runtime that could not be upgraded to the latest version")}(s);Ni("Applying runtime %o",h),T=ke(h)}var zi="2.19.0",Ja=pe("internal"),_l=Ja.extend("ensureInitializeCalled"),es=Ja.extend("ensureInitialized");function fr(){if(!Q.initializeCalled)throw _l(je),new Error(je)}function J(s){if(!Q.initializeCompleted)throw es("%s. initializeCalled: %s",je,Q.initializeCalled.toString()),new Error(je);for(var h=arguments.length,b=new Array(h>1?h-1:0),w=1;w<h;w++)b[w-1]=arguments[w];if(b&&b.length>0){for(var C=!1,P=0;P<b.length;P++)if(b[P]===Q.frameContext){C=!0;break}if(!C)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(b)+'. Current context: "'+Q.frameContext+'".')}return function(s){if(er(s))return!0;throw-1===s.apiVersion?new Error(rt):new Error(Ke)}(s)}function ir(s){void 0===s&&(s=Ue);var h=Tt(Q.clientSupportedSDKVersion,s);return!isNaN(h)&&h>=0}function wo(){return Q.hostClientType==tt.android||Q.hostClientType==tt.ios||Q.hostClientType==tt.ipados}function Bi(s){if(void 0===s&&(s=Ue),!wo())throw{errorCode:Ve.NOT_SUPPORTED_ON_PLATFORM};if(!ir(s))throw{errorCode:Ve.OLD_PLATFORM}}function cn(s){return null==s}var Ui,ga=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})},wn=[],wr=pe("validateOrigin");function rs(){return ga(this,void 0,void 0,F().mark(function s(){return F().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",0!==wn.length?wn:Et()?(wn=Se,Se):fetch(W).then(function(w){if(!w.ok)throw new Error("Invalid Response from Fetch Call");return w.json().then(function(C){if(is(JSON.stringify(C)))return wn=C.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(w){return wr("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",w),wn=Se}));case 1:case"end":return b.stop()}},s)}))}function is(s){var h=JSON.parse(s);try{h=JSON.parse(s)}catch{return!1}if(!h.validOrigins)return!1;for(var w,b=e(h.validOrigins);!(w=b()).done;){var C=w.value;try{new URL("https://"+C)}catch{return wr("isValidOriginsFromCDN call failed to validate origin: %s",C),!1}}return!0}function Sr(s,h){if("*."===s.substring(0,2)){var b=s.substring(1);if(h.length>b.length&&h.split(".").length===b.split(".").length&&h.substring(h.length-b.length)===b)return!0}else if(s===h)return!0;return!1}function yl(s){return rs().then(function(h){if(!le(s))return wr("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",s,s.protocol),!1;var b=s.host;if(h.some(function(z){return Sr(z,b)}))return!0;for(var C,w=e(Q.additionalValidOrigins);!(C=w()).done;){var P=C.value;if(Sr("https://"===P.substring(0,8)?P.substring(8):P,b))return!0}return wr("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",s,h,Q.additionalValidOrigins),!1})}!function(s){var h,b,w,ge;function P(ge){return new Promise(function(et,pt){if(Q.hostClientType===tt.desktop||Q.hostClientType===tt.android||Q.hostClientType===tt.ios||Q.hostClientType===tt.ipados||Q.hostClientType===tt.macos||Q.hostClientType===tt.rigel||Q.hostClientType===tt.teamsRoomsWindows||Q.hostClientType===tt.teamsRoomsAndroid||Q.hostClientType===tt.teamsPhones||Q.hostClientType===tt.teamsDisplays||Q.hostClientType===tt.surfaceHub){var Qe=document.createElement("a");Qe.href=ge.url,et(or("authentication.authenticate",[Qe.href,ge.width,ge.height,ge.isExternal]).then(function(Ut){var Gn=Ut[1];if(Ut[0])return Gn;throw new Error(Gn)}))}else h={success:et,fail:pt},function(ge){j();var et=ge.width||600,pt=ge.height||400;et=Math.min(et,Ye.currentWindow.outerWidth-400),pt=Math.min(pt,Ye.currentWindow.outerHeight-200);var Qe=document.createElement("a");Qe.href=ge.url.replace("{oauthRedirectMethod}","web");var Ut=void 0!==Ye.currentWindow.screenLeft?Ye.currentWindow.screenLeft:Ye.currentWindow.screenX,Yt=void 0!==Ye.currentWindow.screenTop?Ye.currentWindow.screenTop:Ye.currentWindow.screenY;Ye.childWindow=Ye.currentWindow.open(Qe.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(Yt+=Ye.currentWindow.outerHeight/2-pt/2)+", left="+(Ut+=Ye.currentWindow.outerWidth/2-et/2)+", width="+et+", height="+pt),Ye.childWindow?(N(),b=Ye.currentWindow.setInterval(function(){if(!Ye.childWindow||Ye.childWindow.closed)Xe("CancelledByUser");else{var ge=Ye.childOrigin;try{Ye.childOrigin="*",ar("ping")}finally{Ye.childOrigin=ge}}},100),gt("initialize",function(){return[k.authentication,Q.hostClientType]}),gt("navigateCrossDomain",function(){return!1})):Xe("FailedToOpenWindow")}(ge)})}function j(){N();try{Ye.childWindow&&Ye.childWindow.close()}finally{Ye.childWindow=null,Ye.childOrigin=null}}function N(){b&&(clearInterval(b),b=0),In("initialize"),In("navigateCrossDomain")}function ce(ge){try{h&&h.success(ge)}finally{h=void 0,j()}}function Xe(ge){try{h&&h.fail(new Error(ge))}finally{h=void 0,j()}}function Nt(ge,et,pt){if(ge){var Qe=document.createElement("a");Qe.href=decodeURIComponent(ge),Qe.host&&Qe.host!==St().location.host&&"outlook.office.com"===Qe.host&&Qe.search.indexOf("client_type=Win32_Outlook")>-1&&(et&&"result"===et&&(pt&&(Qe.href=Ze(Qe.href,"result",pt)),Ye.currentWindow.location.assign(Ze(Qe.href,"authSuccess",""))),et&&"reason"===et&&(pt&&(Qe.href=Ze(Qe.href,"reason",pt)),Ye.currentWindow.location.assign(Ze(Qe.href,"authFailure",""))))}}function Ze(ge,et,pt){var Qe=ge.indexOf("#"),Ut=-1===Qe?"#":ge.substr(Qe);return Ut=Ut+"&"+et+(""!==pt?"="+pt:""),(ge=-1===Qe?ge:ge.substr(0,Qe))+Ut}s.initialize=function(){gt("authentication.authenticate.success",ce,!1),gt("authentication.authenticate.failure",Xe,!1)},s.registerAuthenticationHandlers=function(ge){w=ge},s.authenticate=function(ge){var et=void 0!==ge,pt=et?ge:w;if(!pt)throw new Error("No parameters are provided for authentication");return J(T,k.content,k.sidePanel,k.settings,k.remove,k.task,k.stage,k.meetingStage),P(pt).then(function(Qe){try{return pt&&pt.successCallback?(pt.successCallback(Qe),""):Qe}finally{et||(w=void 0)}}).catch(function(Qe){try{if(pt&&pt.failureCallback)return pt.failureCallback(Qe.message),"";throw Qe}finally{et||(w=void 0)}})},s.getAuthToken=function(ge){return fr(),function(ge){return new Promise(function(et){et(or("authentication.getAuthToken",[ge?.resources,ge?.claims,ge?.silent]))}).then(function(et){var Qe=et[1];if(et[0])return Qe;throw new Error(Qe)})}(ge).then(function(et){return ge&&ge.successCallback?(ge.successCallback(et),""):et}).catch(function(et){if(ge&&ge.failureCallback)return ge.failureCallback(et.message),"";throw et})},s.getUser=function(ge){return fr(),new Promise(function(ge){ge(or("authentication.getUser"))}).then(function(ge){var pt=ge[1];if(ge[0])return pt;throw new Error(pt)}).then(function(et){return ge&&ge.successCallback?(ge.successCallback(et),null):et}).catch(function(et){if(ge&&ge.failureCallback)return ge.failureCallback(et.message),null;throw et})},s.notifySuccess=function(ge,et){Nt(et,"result",ge),J(T,k.authentication),st("authentication.authenticate.success",[ge]),Nr(Ye.parentWindow,function(){return setTimeout(function(){return Ye.currentWindow.close()},200)})},s.notifyFailure=function(ge,et){Nt(et,"reason",ge),J(T,k.authentication),st("authentication.authenticate.failure",[ge]),Nr(Ye.parentWindow,function(){return setTimeout(function(){return Ye.currentWindow.close()},200)})},(ge=s.DataResidency||(s.DataResidency={})).Public="public",ge.EUDB="eudb",ge.Other="other"}(Ui||(Ui={}));var mr,qi,Rr=De.V_2;function os(s,h){if(J(T,k.content,k.sidePanel,k.task,k.meetingStage),!mr.update.isSupported())throw V;$t(s,"tasks.updateTask",[h])}function fa(s,h,b,w){if(J(T,k.content,k.sidePanel,k.meetingStage),!mr.url.isSupported())throw V;w&&gt("messageForParent",w),$t(s,"tasks.startTask",[mr.url.getDialogInfoFromUrlDialogInfo(h)],function(C,P){b?.({err:C,result:P}),In("messageForParent")})}function as(s,h,b,w){if(J(T,k.content,k.sidePanel,k.meetingStage),!mr.url.bot.isSupported())throw V;w&&gt("messageForParent",w),$t(s,"tasks.startTask",[mr.url.getDialogInfoFromBotUrlDialogInfo(h)],function(C,P){b?.({err:C,result:P}),In("messageForParent")})}function ss(s,h,b){if(J(T,k.content,k.task),!mr.url.isSupported())throw V;$t(s,"tasks.completeTask",[h,b?Array.isArray(b)?b:[b]:[]])}(function(s){var z,h=[];function b(z){Q.frameContext&&(Q.frameContext===k.task?h.push(z):In("messageForChild"))}s.initialize=function(){gt("messageForChild",b,!1)},function(z){function q(){return J(T)&&void 0!==(T.supports.dialog&&T.supports.dialog.url)}var N;function B(N){return{url:N.url,height:N.size?N.size.height:nt.Small,width:N.size?N.size.width:nt.Small,title:N.title,fallbackUrl:N.fallbackUrl}}z.open=function(N,ie,ce){fa(R(Rr,G.Dialog_Url_Open),N,ie,ce)},z.submit=function(N,ie){ss(R(Rr,G.Dialog_Url_Submit),N,ie)},z.sendMessageToParentFromDialog=function(N){if(J(T,k.task),!q())throw V;$t(R(Rr,G.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[N])},z.sendMessageToDialog=function(N){if(J(T,k.content,k.sidePanel,k.meetingStage),!q())throw V;$t(R(Rr,G.Dialog_Url_SendMessageToDialog),"messageForChild",[N])},z.registerOnMessageFromParent=function(N){if(J(T,k.task),!q())throw V;for(In("messageForChild"),gt("messageForChild",N),h.reverse();h.length>0;)N(h.pop())},z.isSupported=q,(N=z.bot||(z.bot={})).open=function(ie,ce,Xe){as(R(Rr,G.Dialog_Url_Bot_Open),ie,ce,Xe)},N.isSupported=function(){return J(T)&&void 0!==(T.supports.dialog&&T.supports.dialog.url&&T.supports.dialog.url.bot)},z.getDialogInfoFromUrlDialogInfo=B,z.getDialogInfoFromBotUrlDialogInfo=function(N){var ie=B(N);return ie.completionBotId=N.completionBotId,ie}}(s.url||(s.url={})),s.isSupported=function(){return!(!J(T)||!T.supports.dialog)},(z=s.update||(s.update={})).resize=function(q){os(R(Rr,G.Dialog_Update_Resize),q)},z.isSupported=function(){return!(!J(T)||!T.supports.dialog||!T.supports.dialog.update)},function(z){function q(){var ie=T.hostVersionsInfo&&T.hostVersionsInfo.adaptiveCardSchemaVersion&&!U(T.hostVersionsInfo.adaptiveCardSchemaVersion);return J(T)&&void 0!==(ie&&T.supports.dialog&&T.supports.dialog.card)}function B(ie){return{card:ie.card,height:ie.size?ie.size.height:nt.Small,width:ie.size?ie.size.width:nt.Small,title:ie.title}}z.open=function(ie,ce){if(J(T,k.content,k.sidePanel,k.meetingStage),!q())throw V;var Xe=B(ie);$t(R(Rr,G.Dialog_AdaptiveCard_Open),"tasks.startTask",[Xe],function(Nt,Ze){ce?.({err:Nt,result:Ze})})},z.isSupported=q,function(ie){function ce(){var Xe=T.hostVersionsInfo&&T.hostVersionsInfo.adaptiveCardSchemaVersion&&!U(T.hostVersionsInfo.adaptiveCardSchemaVersion);return J(T)&&void 0!==(Xe&&T.supports.dialog&&T.supports.dialog.card&&T.supports.dialog.card.bot)}ie.open=function(Xe,Nt){if(J(T,k.content,k.sidePanel,k.meetingStage),!ce())throw V;var Ze=function(ie){var ce=B(ie);return ce.completionBotId=ie.completionBotId,ce}(Xe);$t(R(Rr,G.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[Ze],function(ge,et){Nt?.({err:ge,result:et})})},ie.isSupported=ce}(z.bot||(z.bot={}))}(s.adaptiveCard||(s.adaptiveCard={}))})(mr||(mr={})),function(s){var w,C,P,N;function z(N){P&&P(N)||(J(T),st("viewConfigItemPress",[N]))}function q(N){w&&w(N)||(J(T),st("handleNavBarMenuItemPress",[N]))}function j(N){C&&C(N)||(J(T),st("handleActionMenuItemPress",[N]))}function B(){return!(!J(T)||!T.supports.menus)}(N=s.DisplayMode||(s.DisplayMode={}))[N.ifRoom=0]="ifRoom",N[N.overflowOnly=1]="overflowOnly",s.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(N){N.dropDown="dropDown",N.popOver="popOver"}(s.MenuListType||(s.MenuListType={})),s.initialize=function(){gt("navBarMenuItemPress",q,!1),gt("actionMenuItemPress",j,!1),gt("setModuleView",z,!1)},s.setUpViews=function(N,ie){if(J(T),!B())throw V;P=ie,st("setUpViews",[N])},s.setNavBarMenu=function(N,ie){if(J(T),!B())throw V;w=ie,st("setNavBarMenu",[N])},s.showActionMenu=function(N,ie){if(J(T),!B())throw V;C=ie,st("showActionMenu",[N])},s.isSupported=B}(qi||(qi={}));var Lr=De.V_2,bl=5e3,ls=pe("app");function ma(s,h){return Et()?(ls.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(s,h,b){return new Promise(function(w,C){var P=setTimeout(C,h,b);s().then(function(z){clearTimeout(P),w(z)}).catch(function(z){clearTimeout(P),C(z)})})}(function(){return function(s,h){return new Promise(function(b){Q.initializeCalled||(Q.initializeCalled=!0,Vt.initializeHandlers(),Q.initializePromise=function(s,h){var b=this;if(mn.messageListener=function(C){return On(b,void 0,void 0,F().mark(function P(){return F().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,ba(C);case 2:return q.abrupt("return",q.sent);case 3:case"end":return q.stop()}},P)}))},Ye.currentWindow=Ye.currentWindow||St(),Ye.parentWindow=Ye.currentWindow.parent!==Ye.currentWindow.self?Ye.currentWindow.parent:Ye.currentWindow.opener,(Ye.parentWindow||s)&&Ye.currentWindow.addEventListener("message",mn.messageListener,!1),!Ye.parentWindow){var w=Ye.currentWindow;if(!w.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));Q.isFramelessWindow=!0,w.onNativeMessage=Qi}try{return Ye.parentOrigin="*",Tr(h,"initialize",[zi,An]).then(function(C){return{context:C[0],clientType:C[1],runtimeConfig:C[2],clientSupportedSDKVersion:C[3]}})}finally{Ye.parentOrigin=null}}(h,s).then(function(w){var P=w.clientType,z=w.runtimeConfig,q=w.clientSupportedSDKVersion,j=void 0===q?Ue:q;Q.frameContext=w.context,Q.hostClientType=P,Q.clientSupportedSDKVersion=j;try{ei("Parsing %s",z);var B=JSON.parse(z);if(ei("Checking if %o is a valid runtime object",B??"null"),!B||!B.apiVersion)throw new Error("Received runtime config is invalid");z&&Hi(B)}catch(ie){if(!(ie instanceof SyntaxError))throw ie;try{ei("Attempting to parse %s as an SDK version",z),isNaN(Tt(z,Ue))||(Q.clientSupportedSDKVersion=z);var N=JSON.parse(j);if(ei("givenRuntimeConfig parsed to %o",N??"null"),!N)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Hi(N)}catch(ce){if(!(ce instanceof SyntaxError))throw ce;Hi(Gi(Q.clientSupportedSDKVersion,Za,bo))}}Q.initializeCompleted=!0}),Ui.initialize(),qi.initialize(),hn.config.initialize(),mr.initialize()),Array.isArray(h)&&function(s){var h=Q.additionalValidOrigins.concat(s.filter(function(w){return"string"==typeof w&&He.test(w)})),b={};h=h.filter(function(w){return!b[w]&&(b[w]=!0,!0)}),Q.additionalValidOrigins=h}(h),void 0!==Q.initializePromise?b(Q.initializePromise):ei("GlobalVars.initializePromise is unexpectedly undefined")})}(s,h)},bl,new Error("SDK initialization timed out."))}var Yn,ei=ls.extend("initializeHelper");function Wi(s,h){!cn(h)&&fr(),function(s,h){Vt.themeChangeHandler=h,!cn(h)&&$t(s,"registerHandler",["themeChange"])}(s,h)}function va(s,h){return new Promise(function(b){J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage),b(vn(s,"executeDeepLink",h))})}!function(s){var P,h=pe("app");s.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(P=s.FailedReason||(s.FailedReason={})).AuthFailed="AuthFailed",P.Timeout="Timeout",P.Other="Other",function(P){P.PermissionError="PermissionError",P.NotFound="NotFound",P.Throttling="Throttling",P.Offline="Offline",P.Other="Other"}(s.ExpectedFailureReason||(s.ExpectedFailureReason={})),s.isInitialized=function(){return Q.initializeCompleted},s.getFrameContext=function(){return Q.frameContext},function(){if(!Et()){var P=document.getElementsByTagName("script"),z=P&&P[P.length-1]&&P[P.length-1].src,q="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";z&&0!==z.length?h("teamsjs is being used from %s. %s",z,q):h("teamsjs is being used from a script tag embedded directly in your html. %s",q)}}(),s.initialize=function(P){return function(){ga(this,void 0,void 0,F().mark(function s(){return F().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,rs();case 2:case"end":return b.stop()}},s)}))}(),ma(R(Lr,G.App_Initialize),P)},s._initialize=function(P){Ye.currentWindow=P},s._uninitialize=function(){Q.initializeCalled&&(Vt.uninitializeHandlers(),Q.initializeCalled=!1,Q.initializeCompleted=!1,Q.initializePromise=void 0,Q.additionalValidOrigins=[],Q.frameContext=void 0,Q.hostClientType=void 0,Q.isFramelessWindow=!1,Ye.currentWindow&&Ye.currentWindow.removeEventListener("message",mn.messageListener,!1),Ye.currentWindow=null,Ye.parentWindow=null,Ye.parentOrigin=null,Ye.childWindow=null,Ye.childOrigin=null,mn.parentMessageQueue=[],mn.childMessageQueue=[],mn.nextMessageId=0,mn.callbacks={},mn.promiseCallbacks={})},s.getContext=function(){return new Promise(function(P){fr(),P(Or(R(Lr,G.App_GetContext),"getContext"))}).then(function(P){return function(s){var h;return{actionInfo:s.actionInfo,app:{locale:s.locale,sessionId:s.appSessionId?s.appSessionId:"",theme:s.theme?s.theme:"default",iconPositionVertical:s.appIconPosition,osLocaleInfo:s.osLocaleInfo,parentMessageId:s.parentMessageId,userClickTime:s.userClickTime,userFileOpenPreference:s.userFileOpenPreference,host:{name:s.hostName?s.hostName:zt.teams,clientType:s.hostClientType?s.hostClientType:tt.web,sessionId:s.sessionId?s.sessionId:"",ringId:s.ringId},appLaunchId:s.appLaunchId},page:{id:s.entityId,frameContext:s.frameContext?s.frameContext:Q.frameContext,subPageId:s.subEntityId,isFullScreen:s.isFullScreen,isMultiWindow:s.isMultiWindow,sourceOrigin:s.sourceOrigin},user:{id:null!==(h=s.userObjectId)&&void 0!==h?h:"",displayName:s.userDisplayName,isCallingAllowed:s.isCallingAllowed,isPSTNCallingAllowed:s.isPSTNCallingAllowed,licenseType:s.userLicenseType,loginHint:s.loginHint,userPrincipalName:s.userPrincipalName,tenant:s.tid?{id:s.tid,teamsSku:s.tenantSKU}:void 0},channel:s.channelId?{id:s.channelId,displayName:s.channelName,relativeUrl:s.channelRelativeUrl,membershipType:s.channelType,defaultOneNoteSectionId:s.defaultOneNoteSectionId,ownerGroupId:s.hostTeamGroupId,ownerTenantId:s.hostTeamTenantId}:void 0,chat:s.chatId?{id:s.chatId}:void 0,meeting:s.meetingId?{id:s.meetingId}:void 0,sharepoint:s.sharepoint,team:s.teamId?{internalId:s.teamId,displayName:s.teamName,type:s.teamType,groupId:s.groupId,templateId:s.teamTemplateId,isArchived:s.isTeamArchived,userRole:s.userTeamRole}:void 0,sharePointSite:s.teamSiteUrl||s.teamSiteDomain||s.teamSitePath||s.mySitePath||s.mySiteDomain?{teamSiteUrl:s.teamSiteUrl,teamSiteDomain:s.teamSiteDomain,teamSitePath:s.teamSitePath,teamSiteId:s.teamSiteId,mySitePath:s.mySitePath,mySiteDomain:s.mySiteDomain}:void 0}}(P)})},s.notifyAppLoaded=function(){fr(),$t(R(Lr,G.App_NotifyAppLoaded),s.Messages.AppLoaded,[zi])},s.notifySuccess=function(){fr(),$t(R(Lr,G.App_NotifySuccess),s.Messages.Success,[zi])},s.notifyFailure=function(P){fr(),$t(R(Lr,G.App_NotifyFailure),s.Messages.Failure,[P.reason,P.message])},s.notifyExpectedFailure=function(P){fr(),$t(R(Lr,G.App_NotifyExpectedFailure),s.Messages.ExpectedFailure,[P.reason,P.message])},s.registerOnThemeChangeHandler=function(P){Wi(R(Lr,G.App_RegisterOnThemeChangeHandler),P)},s.openLink=function(P){return va(R(Lr,G.App_OpenLink),P)},function(P){P.registerBeforeSuspendOrTerminateHandler=function(z){if(!z)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");J(T),function(s){Vt.beforeSuspendOrTerminateHandler=s,!cn(s)&&st("registerHandler",["beforeUnload"])}(z)},P.registerOnResumeHandler=function(z){if(!z)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");J(T),function(s){Vt.resumeHandler=s,!cn(s)&&st("registerHandler",["load"])}(z)}}(s.lifecycle||(s.lifecycle={}))}(Yn||(Yn={}));var hn,ln=De.V_2;function So(s,h){return new Promise(function(b){if(J(T,k.content,k.sidePanel,k.settings,k.remove,k.task,k.stage,k.meetingStage),!hn.isSupported())throw V;b(Er(s,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",h))})}function us(s){return new Promise(function(h){if(J(T),!hn.backStack.isSupported())throw V;h(Er(s,"navigateBack","Back navigation is not supported in the current client or context."))})}function bt(s,h){return new Promise(function(b){if(J(T),!hn.tabs.isSupported())throw V;b(Er(s,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",h))})}function Gr(s,h){if(J(T),!hn.isSupported())throw V;$t(s,"returnFocus",[h])}function zn(s,h){return new Promise(function(b){if(J(T),!hn.tabs.isSupported())throw V;b(Or(s,"getTabInstances",h))})}function dt(s,h){return new Promise(function(b){if(J(T),!hn.tabs.isSupported())throw V;b(Or(s,"getMruTabInstances",h))})}function Mo(s,h){if(J(T,k.content,k.sidePanel,k.meetingStage),!hn.isSupported())throw V;$t(s,"shareDeepLink",[h.subPageId,h.subPageLabel,h.subPageWebUrl])}function Rn(s,h){if(J(T,k.content),!hn.isSupported())throw V;$t(s,"setFrameContext",[h])}!function(s){function h(B){Rn(R(ln,G.Pages_SetCurrentFrame),B)}function b(){return!(!J(T)||!T.supports.pages)}var B;s.returnFocus=function(B){Gr(R(ln,G.Pages_ReturnFocus),B)},s.registerFocusEnterHandler=function(B){jn(R(ln,G.Pages_RegisterFocusEnterHandler),"focusEnter",B,[],function(){if(!b())throw V})},s.setCurrentFrame=h,s.initializeWithFrameContext=function(B,N,ie){Yn.initialize(ie).then(function(){return N&&N()}),h(B)},s.getConfig=function(){return new Promise(function(B){if(J(T,k.content,k.settings,k.remove,k.sidePanel),!b())throw V;B(Or(R(ln,G.Pages_GetConfig),"settings.getSettings"))})},s.navigateCrossDomain=function(B){return So(R(ln,G.Pages_NavigateCrossDomain),B)},s.navigateToApp=function(B){return new Promise(function(N){if(J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage),!b())throw V;var ie=R(ln,G.Pages_NavigateCrossDomain);N(T.isLegacyTeams?vn(ie,"executeDeepLink",function(s){var h=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(s.appId)+"/"+encodeURIComponent(s.pageId));return s.webUrl&&h.searchParams.append("webUrl",s.webUrl),(s.channelId||s.subPageId)&&h.searchParams.append("context",JSON.stringify({channelId:s.channelId,subEntityId:s.subPageId})),h.toString()}(B)):vn(ie,"pages.navigateToApp",B))})},s.shareDeepLink=function(B){return Mo(R(ln,G.Pages_ShareDeepLink),B)},s.registerFullScreenHandler=function(B){jn(R(ln,G.Pages_RegisterFullScreenHandler),"fullScreenChange",B,[],function(){if(!cn(B)&&!b())throw V})},s.isSupported=b,(B=s.tabs||(s.tabs={})).navigateToTab=function(N){return bt(R(ln,G.Pages_Tabs_NavigateToTab),N)},B.getTabInstances=function(N){return zn(R(ln,G.Pages_Tabs_GetTabInstances),N)},B.getMruTabInstances=function(N){return dt(R(ln,G.Pages_Tabs_GetMruTabInstances),N)},B.isSupported=function(){return!(!J(T)||!T.supports.pages||!T.supports.pages.tabs)},function(B){var N,ie;function ce(Qe,Ut){!cn(Qe)&&J(T,k.settings),Ut&&Ut(),N=Qe,!cn(Qe)&&$t(R(ln,G.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function Xe(Qe,Ut){!cn(Qe)&&J(T,k.remove,k.settings),Ut&&Ut(),ie=Qe,!cn(Qe)&&$t(R(ln,G.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function Nt(Qe){var Ut=new Ze(Qe);N?N(Ut):Ye.childWindow?ar("settings.save",[Qe]):Ut.notifySuccess()}B.initialize=function(){gt("settings.save",Nt,!1),gt("settings.remove",ge,!1)},B.setValidityState=function(Qe){if(J(T,k.settings,k.remove),!pt())throw V;$t(R(ln,G.Pages_Config_SetValidityState),"settings.setValidityState",[Qe])},B.setConfig=function(Qe){return new Promise(function(Ut){if(J(T,k.content,k.settings,k.sidePanel),!pt())throw V;Ut(vn(R(ln,G.Pages_Config_SetConfig),"settings.setSettings",Qe))})},B.registerOnSaveHandler=function(Qe){ce(Qe,function(){if(!cn(Qe)&&!pt())throw V})},B.registerOnSaveHandlerHelper=ce,B.registerOnRemoveHandler=function(Qe){Xe(Qe,function(){if(!cn(Qe)&&!pt())throw V})},B.registerOnRemoveHandlerHelper=Xe,B.registerChangeConfigHandler=function(Qe){jn(R(ln,G.Pages_Config_RegisterChangeConfigHandler),"changeSettings",Qe,[k.content],function(){if(!pt())throw V})};var Ze=function(){function Qe(Yt){this.notified=!1,this.result=Yt||{}}var Ut=Qe.prototype;return Ut.notifySuccess=function(){this.ensureNotNotified(),$t(R(ln,G.Settings_Save_Success),"settings.save.success"),this.notified=!0},Ut.notifyFailure=function(Gn){this.ensureNotNotified(),$t(R(ln,G.Settings_Save_Failure),"settings.save.failure",[Gn]),this.notified=!0},Ut.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},Qe}();function ge(){var Qe=new et;ie?ie(Qe):Ye.childWindow?ar("settings.remove",[]):Qe.notifySuccess()}var et=function(){function Qe(){this.notified=!1}var Ut=Qe.prototype;return Ut.notifySuccess=function(){this.ensureNotNotified(),$t(R(ln,G.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},Ut.notifyFailure=function(Gn){this.ensureNotNotified(),$t(R(ln,G.Settings_Remove_Failure),"settings.remove.failure",[Gn]),this.notified=!0},Ut.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},Qe}();function pt(){return!(!J(T)||!T.supports.pages||!T.supports.pages.config)}B.isSupported=pt}(s.config||(s.config={})),function(B){var N;function ie(){return us(R(ln,G.Pages_BackStack_NavigateBack))}function ce(Ze,ge,et){!cn(ge)&&J(T),et&&et(),N=ge,!cn(ge)&&$t(Ze,"registerHandler",["backButton"])}function Xe(){N&&N()||(Ye.childWindow?ar("backButtonPress",[]):ie())}function Nt(){return!(!J(T)||!T.supports.pages||!T.supports.pages.backStack)}B._initialize=function(){gt("backButtonPress",Xe,!1)},B.navigateBack=ie,B.registerBackButtonHandler=function(Ze){ce(R(ln,G.Pages_BackStack_RegisterBackButtonHandler),Ze,function(){if(!cn(Ze)&&!Nt())throw V})},B.registerBackButtonHandlerHelper=ce,B.isSupported=Nt}(s.backStack||(s.backStack={})),function(B){function N(){return!(!J(T)||!T.supports.pages||!T.supports.pages.fullTrust)}B.enterFullscreen=function(){if(J(T,k.content),!N())throw V;$t(R(ln,G.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},B.exitFullscreen=function(){if(J(T,k.content),!N())throw V;$t(R(ln,G.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},B.isSupported=N}(s.fullTrust||(s.fullTrust={})),function(B){function N(){return!(!J(T)||!T.supports.pages||!T.supports.pages.appButton)}B.onClick=function(ie){jn(R(ln,G.Pages_AppButton_OnClick),"appButtonClick",ie,[k.content],function(){if(!N())throw V})},B.onHoverEnter=function(ie){jn(R(ln,G.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",ie,[k.content],function(){if(!N())throw V})},B.onHoverLeave=function(ie){jn(R(ln,G.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",ie,[k.content],function(){if(!N())throw V})},B.isSupported=N}(s.appButton||(s.appButton={})),function(B){function N(){return!(!J(T)||!T.supports.pages||!T.supports.pages.currentApp)}B.navigateTo=function(ie){return new Promise(function(ce){if(J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage),!N())throw V;ce(Bt(R(ln,G.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",ie))})},B.navigateToDefaultPage=function(){return new Promise(function(ie){if(J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage),!N())throw V;ie(Bt(R(ln,G.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},B.isSupported=N}(s.currentApp||(s.currentApp={}))}(hn||(hn={}));var Po=pe("handlers"),Vt=function(){function s(){}return s.initializeHandlers=function(){s.handlers.themeChange=Mr,s.handlers.load=Pr,s.handlers.beforeUnload=ps,hn.backStack._initialize()},s.uninitializeHandlers=function(){s.handlers={},s.themeChangeHandler=null,s.loadHandler=null,s.beforeUnloadHandler=null,s.beforeSuspendOrTerminateHandler=null,s.resumeHandler=null},s}();Vt.handlers={},Vt.themeChangeHandler=null,Vt.loadHandler=null,Vt.beforeUnloadHandler=null,Vt.beforeSuspendOrTerminateHandler=null,Vt.resumeHandler=null;var Oo=Po.extend("callHandler");function ji(s,h){var b=Vt.handlers[s];return b?(Oo("Invoking the registered handler for message %s with arguments %o",s,h),[!0,b.apply(this,h)]):Ye.childWindow?(ar(s,h),[!1,void 0]):(Oo("Handler for action message %s not found.",s),[!1,void 0])}function gt(s,h,b,w){void 0===b&&(b=!0),void 0===w&&(w=[]),h?(Vt.handlers[s]=h,b&&$t(R(De.V_0,G.RegisterHandler),"registerHandler",[s].concat(w))):delete Vt.handlers[s]}function In(s){delete Vt.handlers[s]}function dr(s){return null!=Vt.handlers[s]}function jn(s,h,b,w,C){b&&J.apply(void 0,[T].concat(w)),C&&C(),gt(h,b)}function Mr(s){Vt.themeChangeHandler&&Vt.themeChangeHandler(s),Ye.childWindow&&ar("themeChange",[s])}function Pr(s){Vt.resumeHandler?Vt.resumeHandler(s):Vt.loadHandler&&Vt.loadHandler(s),Ye.childWindow&&ar("load",[s])}function ps(){var s=function(){st("readyToUnload",[])};Vt.beforeSuspendOrTerminateHandler?(Vt.beforeSuspendOrTerminateHandler(),Ye.childWindow?ar("beforeUnload"):s()):Vt.beforeUnloadHandler&&Vt.beforeUnloadHandler(s)||(Ye.childWindow?ar("beforeUnload"):s())}var On=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})},_i=pe("communication"),Ye=function(){},mn=function(){};function Or(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];return Tr(s,h,w).then(function(P){return P[0]})}function ni(s){for(var h=arguments.length,b=new Array(h>1?h-1:0),w=1;w<h;w++)b[w-1]=arguments[w];return or(s,b).then(function(C){return C[0]})}function vn(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];return Tr(s,h,w).then(function(P){if(!P[0])throw new Error(P[1])})}function Dn(s){for(var h=arguments.length,b=new Array(h>1?h-1:0),w=1;w<h;w++)b[w-1]=arguments[w];return or(s,b).then(function(C){if(!C[0])throw new Error(C[1])})}function Er(s,h,b){for(var w=arguments.length,C=new Array(w>3?w-3:0),P=3;P<w;P++)C[P-3]=arguments[P];return Tr(s,h,C).then(function(z){if(!z[0])throw new Error(z[1]||b)})}function Bt(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];return Tr(s,h,w).then(function(P){var z=P[0];if(z)throw z;return P[1]})}function yn(s){for(var h=arguments.length,b=new Array(h>1?h-1:0),w=1;w<h;w++)b[w-1]=arguments[w];return or(s,b).then(function(C){var P=C[0];if(P)throw P;return C[1]})}function Tr(s,h,b){if(void 0===b&&(b=void 0),!Fe(s))throw Error("apiVersionTag: "+s+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(w){w(Ca($i(s,h,b).id))})}function or(s,h){return void 0===h&&(h=void 0),new Promise(function(b){b(Ca($i(R(De.V_0,"testing"),s,h).id))})}function Ca(s){return new Promise(function(h){mn.promiseCallbacks[s]=h})}function $t(s,h,b,w){var C;if(b instanceof Function?w=b:b instanceof Array&&(C=b),!Fe(s))throw Error("apiVersionTag: "+s+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var P=$i(s,h,C);w&&(mn.callbacks[P.id]=w)}function st(s,h,b){var w;h instanceof Function?b=h:h instanceof Array&&(w=h);var C=$i(R(De.V_0,"testing"),s,w);b&&(mn.callbacks[C.id]=b)}mn.parentMessageQueue=[],mn.childMessageQueue=[],mn.nextMessageId=0,mn.callbacks={},mn.promiseCallbacks={};var ms=_i.extend("sendMessageToParentHelper");function $i(s,h,b){var w=ms,C=Ye.parentWindow,P=function(s,h,b){return{id:mn.nextMessageId++,func:h,timestamp:Date.now(),args:b||[],apiversiontag:s}}(s,h,b);if(w("Message %i information: %o",P.id,{actionName:h,args:b}),Q.isFramelessWindow)Ye.currentWindow&&Ye.currentWindow.nativeInterface&&(w("Sending message %i to parent via framelessPostMessage interface",P.id),Ye.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(P)));else{var z=Xi(C);C&&z?(w("Sending message %i to parent via postMessage",P.id),C.postMessage(P,z)):(w("Adding message %i to parent message queue",P.id),Ki(C).push(P))}return P}var ya=_i.extend("processMessage");function ba(s){return On(this,void 0,void 0,F().mark(function h(){var b,w;return F().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(s&&s.data&&"object"==typeof s.data){P.next=2;break}return P.abrupt("return",void ya("Unrecognized message format received by app, message being ignored. Message: %o",s));case 2:return P.abrupt("return",vs(b=s.source||s.originalEvent&&s.originalEvent.source,w=s.origin||s.originalEvent&&s.originalEvent.origin).then(function(z){z?(_s(b,w),b===Ye.parentWindow?Qi(s):b===Ye.childWindow&&To(s)):ya("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return P.stop()}},h)}))}var wa=_i.extend("shouldProcessMessage");function vs(s,h){return On(this,void 0,void 0,F().mark(function b(){var w;return F().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!Ye.currentWindow||s!==Ye.currentWindow){P.next=2;break}return P.abrupt("return",(wa("Should not process message because it is coming from the current window"),!1));case 2:if(!(Ye.currentWindow&&Ye.currentWindow.location&&h&&h===Ye.currentWindow.location.origin)){P.next=4;break}return P.abrupt("return",!0);case 4:return P.next=6,yl(new URL(h));case 6:return P.abrupt("return",((w=P.sent)||wa("Message has an invalid origin of %s",h),w));case 8:case"end":return P.stop()}},b)}))}function _s(s,h){Q.isFramelessWindow||Ye.parentWindow&&!Ye.parentWindow.closed&&s!==Ye.parentWindow?Ye.childWindow&&!Ye.childWindow.closed&&s!==Ye.childWindow||(Ye.childWindow=s,Ye.childOrigin=h):(Ye.parentWindow=s,Ye.parentOrigin=h),Ye.parentWindow&&Ye.parentWindow.closed&&(Ye.parentWindow=null,Ye.parentOrigin=null),Ye.childWindow&&Ye.childWindow.closed&&(Ye.childWindow=null,Ye.childOrigin=null),Ma(Ye.parentWindow),Ma(Ye.childWindow)}var Sa=_i.extend("handleParentMessage");function Qi(s){var h=Sa;if("id"in s.data&&"number"==typeof s.data.id){var b=s.data,w=mn.callbacks[b.id];h("Received a response from parent for message %i",b.id),w&&(h("Invoking the registered callback for message %i with arguments %o",b.id,b.args),w.apply(null,[].concat(b.args,[b.isPartialResponse])),function(s){return!0===s.data.isPartialResponse}(s)||(h("Removing registered callback for message %i",b.id),delete mn.callbacks[b.id]));var C=mn.promiseCallbacks[b.id];C&&(h("Invoking the registered promise callback for message %i with arguments %o",b.id,b.args),C(b.args),h("Removing registered promise callback for message %i",b.id),delete mn.promiseCallbacks[b.id])}else if("func"in s.data&&"string"==typeof s.data.func){var P=s.data;h("Received an action message %s from parent",P.func),ji(P.func,P.args)}else h("Received an unknown message: %O",s)}function To(s){if("id"in s.data&&"func"in s.data){var h=s.data,b=ji(h.func,h.args),C=b[1];b[0]&&void 0!==C?Pa(h.id,Array.isArray(C)?C:[C]):st(h.func,h.args,function(){if(Ye.childWindow){for(var P=arguments.length,z=new Array(P),q=0;q<P;q++)z[q]=arguments[q];var j=z.pop();Pa(h.id,z,j)}})}}function Ki(s){return s===Ye.parentWindow?mn.parentMessageQueue:s===Ye.childWindow?mn.childMessageQueue:[]}function Xi(s){return s===Ye.parentWindow?Ye.parentOrigin:s===Ye.childWindow?Ye.childOrigin:null}var Io,Do,ko,Zi,ri,Cs=_i.extend("flushMessageQueue");function Ma(s){for(var h=Xi(s),b=Ki(s),w=s==Ye.parentWindow?"parent":"child";s&&h&&b.length>0;){var C=b.shift();Cs("Flushing message %i from "+w+" message queue via postMessage.",C?.id),s.postMessage(C,h)}}function Nr(s,h){var b;b=Ye.currentWindow.setInterval(function(){0===Ki(s).length&&(clearInterval(b),h())},100)}function Pa(s,h,b){var w=Ye.childWindow,C=function(s,h,b){return{id:s,args:h||[],isPartialResponse:b}}(s,h,b),P=Xi(w);w&&P&&w.postMessage(C,P)}function ar(s,h){var b=Ye.childWindow,w=function(s,h){return{func:s,args:h||[]}}(s,h),C=Xi(b);b&&C?b.postMessage(w,C):Ki(b).push(w)}function ws(s,h){J(T),st("uploadCustomApp",[s],h||jt())}function Ss(s,h,b){J(T),st(s,h,b)}function Ms(s,h){if(J(T),!Ye.childWindow)throw new Error("The child window has not yet been initialized or is not present");ar(s,h)}function Oa(s,h){var b=this;J(T),gt(s,function(){for(var w=arguments.length,C=new Array(w),P=0;P<w;P++)C[P]=arguments[P];return h.apply(b,C)})}function Ps(s,h){J(T),gt("userSettingsChange",h,!0,[s])}function Yi(s){J(T,k.content,k.task),st("openFilePreview",[s.entityId,s.title,s.description,s.type,s.objectUrl,s.downloadUrl,s.webPreviewUrl,s.webEditUrl,s.baseUrl,s.editFile,s.subEntityId,s.viewerAction,s.fileOpenPreference,s.conversationId,s.sizeInBytes])}(function(s){function h(){return!(!J(T)||!T.supports.logs)}s.registerGetLogHandler=function(b){if(!cn(b)&&J(T),!cn(b)&&!h())throw V;b?gt("log.request",function(){st("log.receive",[b()])}):In("log.request")},s.isSupported=h})(Io||(Io={})),function(s){s.fileDownloadStart="fileDownloadStart",s.fileDownloadComplete="fileDownloadComplete"}(Do||(Do={})),function(s){s.view="view",s.edit="edit",s.editNew="editNew"}(ko||(ko={})),function(s){s.fileOpenPreference="fileOpenPreference",s.theme="theme"}(Zi||(Zi={})),function(s){function h(){return!(!J(T)||!T.supports.conversations)}s.openConversation=function(b){return new Promise(function(w){if(J(T,k.content),!h())throw V;var C=Dn("conversations.openConversation",{title:b.title,subEntityId:b.subEntityId,conversationId:b.conversationId,channelId:b.channelId,entityId:b.entityId});b.onStartConversation&&gt("startConversation",function(P,z,q,j){var B;return null===(B=b.onStartConversation)||void 0===B?void 0:B.call(b,{subEntityId:P,conversationId:z,channelId:q,entityId:j})}),b.onCloseConversation&&gt("closeConversation",function(P,z,q,j){var B;return null===(B=b.onCloseConversation)||void 0===B?void 0:B.call(b,{subEntityId:P,conversationId:z,channelId:q,entityId:j})}),w(C)})},s.closeConversation=function(){if(J(T,k.content),!h())throw V;st("conversations.closeConversation"),In("startConversation"),In("closeConversation")},s.getChatMembers=function(){return new Promise(function(b){if(J(T),!h())throw V;b(ni("getChatMembers"))})},s.isSupported=h}(ri||(ri={}));var Ji;function Vo(s,h,b){if(0===s.length)throw new Error("Must have at least one user when creating a chat deep link");var w="users="+s.map(function(z){return encodeURIComponent(z)}).join(","),C=void 0===h?"":"&topicName="+encodeURIComponent(h),P=void 0===b?"":"&message="+encodeURIComponent(b);return he+"://"+ye+"/l/chat/0/0?"+w+C+P}!function(s){function h(){return!(!J(T)||!T.supports.appInstallDialog)}s.openAppInstallDialog=function(b){return new Promise(function(w){if(J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage),!h())throw new Error("Not supported");T.isLegacyTeams?w(Dn("executeDeepLink",function(s){if(!s)throw new Error("App ID must be set when creating an app install dialog deep link");return he+"://"+ye+"/l/app/"+encodeURIComponent(s)}(b.appId))):(st("appInstallDialog.openAppInstallDialog",[b]),w())})},s.isSupported=h}(Ji||(Ji={}));var $n,tr=De.V_1,sr=pe("media");function ii(s,h){if(null==s||null==h||s.length<=0)return null;var b=null,w=1;return s.sort(function(C,P){return C.sequence>P.sequence?1:-1}),s.forEach(function(C){C.sequence==w&&(b=b?new Blob([b,C.file],{type:h}):new Blob([C.file],{type:h}),w++)}),b}function eo(s,h){if(null==s||null==h)return null;for(var b=atob(s.chunk),w=new Array(b.length),C=0;C<b.length;C++)w[C]=b.charCodeAt(C);var P=new Uint8Array(w),z=new Blob([P],{type:h});return{sequence:s.chunkSequence,file:z}}function Es(s){!function(s){return!(!s||s.mediaType!=$n.MediaType.VideoAndImage&&!s.videoAndImageProps)}(s)?function(s){return!(!s||s.mediaType!=$n.MediaType.Video||!s.videoProps||s.videoProps.isFullScreenMode)}(s)?Bi("2.0.3"):function(s){var h;return!(s?.mediaType!=$n.MediaType.Image||null===(h=s?.imageProps)||void 0===h||!h.imageOutputFormats)}(s)&&Bi("2.0.4"):Bi("2.0.2")}function Fo(s){return!s||!(null===s.timeOutIntervalInSec||null!=s.timeOutIntervalInSec&&s.timeOutIntervalInSec<=0||null!=s.timeOutIntervalInSec&&s.timeOutIntervalInSec>60)}!function(s){var b,P,ce;(ce=s.FileFormat||(s.FileFormat={})).Base64="base64",ce.ID="id";var j=function(){};function B(){return!(!J(T)||!T.supports.permissions)}s.File=j,s.captureImage=function(ce){if(!ce)throw new Error("[captureImage] Callback cannot be null");J(T,k.content,k.task),Q.isFramelessWindow?ir("1.7.0")?$t(R(tr,G.Media_CaptureImage),"captureImage",ce):ce({errorCode:Ve.OLD_PLATFORM},[]):ce({errorCode:Ve.NOT_SUPPORTED_ON_PLATFORM},[])},s.hasPermission=function(){if(J(T,k.content,k.task),!B())throw V;var ce=_t.Media;return new Promise(function(Xe){Xe(Bt(R(tr,G.Media_HasPermission),"permissions.has",ce))})},s.requestPermission=function(){if(J(T,k.content,k.task),!B())throw V;var ce=_t.Media;return new Promise(function(Xe){Xe(Bt(R(tr,G.Media_RequestPermission),"permissions.request",ce))})};var N=function(ce){function Xe(Ze){var ge;return ge=ce.call(this)||this,Ze&&(ge.content=Ze.content,ge.format=Ze.format,ge.mimeType=Ze.mimeType,ge.name=Ze.name,ge.preview=Ze.preview,ge.size=Ze.size),ge}u(Xe,ce);var Nt=Xe.prototype;return Nt.getMedia=function(ge){if(!ge)throw new Error("[get Media] Callback cannot be null");J(T,k.content,k.task),ir(ve)?function(s,h,b){return null!=s&&null!=h&&h==$n.FileFormat.ID&&null!=b}(this.mimeType,this.format,this.content)?ir("2.0.0")?this.getMediaViaCallback(ge):this.getMediaViaHandler(ge):ge({errorCode:Ve.INVALID_ARGUMENTS},new Blob):ge({errorCode:Ve.OLD_PLATFORM},new Blob)},Nt.getMediaViaCallback=function(ge){var et={mediaMimeType:this.mimeType,assembleAttachment:[]},pt=[this.content];$t(R(tr,G.Media_GetMedia),"getMedia",pt,function(Qe){if(ge)if(Qe&&Qe.error)ge(Qe.error,new Blob);else if(Qe&&Qe.mediaChunk)if(Qe.mediaChunk.chunkSequence<=0){var Ut=ii(et.assembleAttachment,et.mediaMimeType);ge(Qe.error,Ut??new Blob)}else{var Yt=eo(Qe.mediaChunk,et.mediaMimeType);Yt?et.assembleAttachment.push(Yt):sr("Received a null assemble attachment for when decoding chunk sequence "+Qe.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else ge({errorCode:Ve.INTERNAL_ERROR,message:"data received is null"},new Blob)})},Nt.getMediaViaHandler=function(ge){var et=Dt(),pt={mediaMimeType:this.mimeType,assembleAttachment:[]},Qe=[et,this.content];this.content&&!cn(ge)&&$t(R(tr,G.Media_GetMedia),"getMedia",Qe),gt("getMedia"+et,function(Ut){if(ge){var Yt=JSON.parse(Ut);if(Yt.error)ge(Yt.error,new Blob),In("getMedia"+et);else if(Yt.mediaChunk)if(Yt.mediaChunk.chunkSequence<=0){var Gn=ii(pt.assembleAttachment,pt.mediaMimeType);ge(Yt.error,Gn??new Blob),In("getMedia"+et)}else{var En=eo(Yt.mediaChunk,pt.mediaMimeType);En&&pt.assembleAttachment.push(En)}else ge({errorCode:Ve.INTERNAL_ERROR,message:"data received is null"},new Blob),In("getMedia"+et)}})},Xe}(j);s.Media=N;var ie=function(){function ce(Nt){this.controllerCallback=Nt}var Xe=ce.prototype;return Xe.notifyEventToHost=function(Ze,ge){J(T,k.content,k.task);try{Bi("2.0.3")}catch(pt){return void(ge&&ge(pt))}var et={mediaType:this.getMediaType(),mediaControllerEvent:Ze};$t(R(tr,G.Media_Controller),"media.controller",[et],function(pt){ge&&ge(pt)})},Xe.stop=function(Ze){this.notifyEventToHost(b.StopRecording,Ze)},ce}();s.VideoController=function(ce){function Xe(){return ce.apply(this,arguments)||this}u(Xe,ce);var Nt=Xe.prototype;return Nt.getMediaType=function(){return P.Video},Nt.notifyEventToApp=function(ge){if(this.controllerCallback)switch(ge){case b.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},Xe}(ie),function(ce){ce[ce.StartRecording=1]="StartRecording",ce[ce.StopRecording=2]="StopRecording"}(b=s.MediaControllerEvent||(s.MediaControllerEvent={})),function(ce){ce[ce.Photo=1]="Photo",ce[ce.Document=2]="Document",ce[ce.Whiteboard=3]="Whiteboard",ce[ce.BusinessCard=4]="BusinessCard"}(s.CameraStartMode||(s.CameraStartMode={})),function(ce){ce[ce.Camera=1]="Camera",ce[ce.Gallery=2]="Gallery"}(s.Source||(s.Source={})),function(ce){ce[ce.Image=1]="Image",ce[ce.Video=2]="Video",ce[ce.VideoAndImage=3]="VideoAndImage",ce[ce.Audio=4]="Audio"}(P=s.MediaType||(s.MediaType={})),function(ce){ce[ce.ID=1]="ID",ce[ce.URL=2]="URL"}(s.ImageUriType||(s.ImageUriType={})),function(ce){ce[ce.IMAGE=1]="IMAGE",ce[ce.PDF=2]="PDF"}(s.ImageOutputFormats||(s.ImageOutputFormats={})),s.selectMedia=function(ce,Xe){if(!Xe)throw new Error("[select Media] Callback cannot be null");if(J(T,k.content,k.task),ir(ve)){try{Es(ce)}catch(et){return void Xe(et,[])}if(function(s){return!(null==s||s.maxMediaCount>10)}(ce)){var ge=[ce];$t(R(tr,G.Media_SelectMedia),"selectMedia",ge,function(et,pt,Qe){var Ut,Yt;if(Qe)(function(s){return!(s.mediaType!=$n.MediaType.Video||!s.videoProps||!s.videoProps.videoController)})(ce)&&(null===(Yt=null===(Ut=ce?.videoProps)||void 0===Ut?void 0:Ut.videoController)||void 0===Yt||Yt.notifyEventToApp(Qe));else if(pt){for(var Co,Gn=[],En=e(pt);!(Co=En()).done;)Gn.push(new N(Co.value));Xe(et,Gn)}else Xe(et,[])})}else Xe({errorCode:Ve.INVALID_ARGUMENTS},[])}else Xe({errorCode:Ve.OLD_PLATFORM},[])},s.viewImages=function(ce,Xe){if(!Xe)throw new Error("[view images] Callback cannot be null");if(J(T,k.content,k.task),ir(ve))if(function(s){return!(null==s||s.length<=0||s.length>10)}(ce)){var Nt=[ce];$t(R(tr,G.Media_ViewImages),"viewImages",Nt,Xe)}else Xe({errorCode:Ve.INVALID_ARGUMENTS});else Xe({errorCode:Ve.OLD_PLATFORM})},s.scanBarCode=function(ce,Xe){if(!ce)throw new Error("[media.scanBarCode] Callback cannot be null");J(T,k.content,k.task),Q.hostClientType!==tt.desktop&&Q.hostClientType!==tt.web&&Q.hostClientType!==tt.rigel&&Q.hostClientType!==tt.teamsRoomsWindows&&Q.hostClientType!==tt.teamsRoomsAndroid&&Q.hostClientType!==tt.teamsPhones&&Q.hostClientType!==tt.teamsDisplays?ir("1.9.0")?Fo(Xe)?$t(R(tr,G.Media_ScanBarCode),"media.scanBarCode",[Xe],ce):ce({errorCode:Ve.INVALID_ARGUMENTS},""):ce({errorCode:Ve.OLD_PLATFORM},""):ce({errorCode:Ve.NOT_SUPPORTED_ON_PLATFORM},"")}}($n||($n={}));var Hr,Ao,to=De.V_2;(function(s){function h(){return!!(J(T)&&T.supports.barCode&&T.supports.permissions)}s.scanBarCode=function(b){return new Promise(function(w){if(J(T,k.content,k.task),!h())throw V;if(!Fo(b))throw{errorCode:Ve.INVALID_ARGUMENTS};w(Bt(R(to,G.BarCode_ScanBarCode),"media.scanBarCode",b))})},s.hasPermission=function(){if(J(T,k.content,k.task),!h())throw V;var b=_t.Media;return new Promise(function(w){w(Bt(R(to,G.BarCode_HasPermission),"permissions.has",b))})},s.requestPermission=function(){if(J(T,k.content,k.task),!h())throw V;var b=_t.Media;return new Promise(function(w){w(Bt(R(to,G.BarCode_RequestPermission),"permissions.request",b))})},s.isSupported=h})(Hr||(Hr={})),function(s){function h(w){return new Promise(function(C){if(J(T,k.content,k.task),!b())throw V;C(T.isLegacyTeams?Dn("executeDeepLink",Vo([w.user],void 0,w.message)):Dn("chat.openChat",{members:[w.user],message:w.message}))})}function b(){return!(!J(T)||!T.supports.chat)}s.openChat=h,s.openGroupChat=function(w){return new Promise(function(C){if(w.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===w.users.length)C(h({user:w.users[0],message:w.message}));else{if(J(T,k.content,k.task),!b())throw V;C(T.isLegacyTeams?Dn("executeDeepLink",Vo(w.users,w.topic,w.message)):Dn("chat.openChat",{members:w.users,message:w.message,topic:w.topic}))}})},s.isSupported=b}(Ao||(Ao={}));var oi,Fa=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})},Aa=De.V_2;!function(s){function h(){return!!(J(T)&&navigator&&navigator.clipboard&&T.supports.clipboard)}s.write=function(b){return Fa(this,void 0,void 0,F().mark(function w(){var P;return F().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(J(T,k.content,k.meetingStage,k.task,k.settings,k.stage,k.sidePanel),h()){q.next=2;break}throw V;case 2:if(b.type&&Object.values(yt).includes(b.type)){q.next=4;break}throw new Error("Blob type "+b.type+" is not supported. Supported blob types are "+Object.values(yt));case 4:return q.next=6,qe(b);case 6:return P={mimeType:b.type,content:q.sent},q.abrupt("return",Bt(R(Aa,G.Clipboard_Write),"clipboard.writeToClipboard",P));case 9:case"end":return q.stop()}},w)}))},s.read=function(){return Fa(this,void 0,void 0,F().mark(function b(){var w;return F().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(J(T,k.content,k.meetingStage,k.task,k.settings,k.stage,k.sidePanel),h()){P.next=2;break}throw V;case 2:if(!wo()&&Q.hostClientType!==tt.macos){P.next=9;break}return P.t0=JSON,P.next=6,yn("clipboard.readFromClipboard");case 6:return P.t1=P.sent,w=P.t0.parse.call(P.t0,P.t1),P.abrupt("return",Pe(w.mimeType,w.content));case 9:return P.abrupt("return",Bt(R(Aa,G.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return P.stop()}},b)}))},s.isSupported=h}(oi||(oi={}));var Ci,yi,kr=De.V_2;function Ro(){return T.hostVersionsInfo?T.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(s){function h(){return!!(J(T)&&T.supports.geoLocation&&T.supports.permissions)}s.getCurrentLocation=function(){if(J(T,k.content,k.task),!h())throw V;return Bt(R(kr,G.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},s.hasPermission=function(){if(J(T,k.content,k.task),!h())throw V;var w=_t.GeoLocation;return new Promise(function(C){C(Bt(R(kr,G.GeoLocation_HasPermission),"permissions.has",w))})},s.requestPermission=function(){if(J(T,k.content,k.task),!h())throw V;var w=_t.GeoLocation;return new Promise(function(C){C(Bt(R(kr,G.GeoLocation_RequestPermission),"permissions.request",w))})},s.isSupported=h,function(w){function C(){return!!(J(T)&&T.supports.geoLocation&&T.supports.geoLocation.map&&T.supports.permissions)}w.chooseLocation=function(){if(J(T,k.content,k.task),!C())throw V;return Bt(R(kr,G.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},w.showLocation=function(P){if(J(T,k.content,k.task),!C())throw V;if(!P)throw{errorCode:Ve.INVALID_ARGUMENTS};return Bt(R(kr,G.GeoLocation_ShowLocation),"location.showLocation",P)},w.isSupported=C}(s.map||(s.map={}))}(Ci||(Ci={}));var Lo=function(){function s(){}var h=s.prototype;return h.postMessage=function(w,C){J(T),st("messageForChild",[w],C||jt())},h.addEventListener=function(w,C){J(T),"message"===w&&gt("messageForParent",C)},s}(),no=function(){function s(){}var h=s.prototype;return h.postMessage=function(w,C){J(T,k.task),st("messageForParent",[w],C||jt())},h.addEventListener=function(w,C){J(T,k.task),"message"===w&&gt("messageForChild",C)},M(s,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),s}();!function(s){function h(){return!(!J(T)||!T.supports.secondaryBrowser)}s.open=function(b){if(J(T,k.content),!h())throw V;if(!b||!le(b))throw{errorCode:Ve.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return yn("secondaryBrowser.open",b.toString())},s.isSupported=h}(yi||(yi={}));var wi,bi=De.V_1;!function(s){function h(){return!(!J(T)||!T.supports.location)}s.getLocation=function(b,w){if(!w)throw new Error("[location.getLocation] Callback cannot be null");if(J(T,k.content,k.task),!ir("1.9.0"))throw{errorCode:Ve.OLD_PLATFORM};if(!b)throw{errorCode:Ve.INVALID_ARGUMENTS};if(!h())throw V;$t(R(bi,G.Location_GetLocation),"location.getLocation",[b],w)},s.showLocation=function(b,w){if(!w)throw new Error("[location.showLocation] Callback cannot be null");if(J(T,k.content,k.task),!ir("1.9.0"))throw{errorCode:Ve.OLD_PLATFORM};if(!b)throw{errorCode:Ve.INVALID_ARGUMENTS};if(!h())throw V;$t(R(bi,G.Location_ShowLocation),"location.showLocation",[b],w)},s.isSupported=h}(wi||(wi={}));var ai,Si,zr=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})};(function(s){var h,P,N;function B(N,ie){J(T,k.sidePanel,k.meetingStage),st("meeting.updateMicState",[N,ie])}(N=h||(h={}))[N.HostInitiated=0]="HostInitiated",N[N.AppInitiated=1]="AppInitiated",N[N.AppDeclinedToChange=2]="AppDeclinedToChange",N[N.AppFailedToChange=3]="AppFailedToChange",function(N){N.like="like",N.heart="heart",N.laugh="laugh",N.surprised="surprised",N.applause="applause"}(s.MeetingReactionType||(s.MeetingReactionType={})),function(N){N.Unknown="Unknown",N.Adhoc="Adhoc",N.Scheduled="Scheduled",N.Recurring="Recurring",N.Broadcast="Broadcast",N.MeetNow="MeetNow"}(s.MeetingType||(s.MeetingType={})),function(N){N.OneOnOneCall="oneOnOneCall",N.GroupCall="groupCall"}(s.CallType||(s.CallType={})),function(N){N.Collaborative="Collaborative",N.ScreenShare="ScreenShare"}(P=s.SharingProtocol||(s.SharingProtocol={})),s.getIncomingClientAudioState=function(N){if(!N)throw new Error("[get incoming client audio state] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("getIncomingClientAudioState",N)},s.toggleIncomingClientAudio=function(N){if(!N)throw new Error("[toggle incoming client audio] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("toggleIncomingClientAudio",N)},s.getMeetingDetails=function(N){if(!N)throw new Error("[get meeting details] Callback cannot be null");J(T,k.sidePanel,k.meetingStage,k.settings,k.content),st("meeting.getMeetingDetails",N)},s.getAuthenticationTokenForAnonymousUser=function(N){if(!N)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");J(T,k.sidePanel,k.meetingStage,k.task),st("meeting.getAuthenticationTokenForAnonymousUser",N)},s.getLiveStreamState=function(N){if(!N)throw new Error("[get live stream state] Callback cannot be null");J(T,k.sidePanel),st("meeting.getLiveStreamState",N)},s.requestStartLiveStreaming=function(N,ie,ce){if(!N)throw new Error("[request start live streaming] Callback cannot be null");J(T,k.sidePanel),st("meeting.requestStartLiveStreaming",[ie,ce],N)},s.requestStopLiveStreaming=function(N){if(!N)throw new Error("[request stop live streaming] Callback cannot be null");J(T,k.sidePanel),st("meeting.requestStopLiveStreaming",N)},s.registerLiveStreamChangedHandler=function(N){if(!N)throw new Error("[register live stream changed handler] Handler cannot be null");J(T,k.sidePanel),gt("meeting.liveStreamChanged",N)},s.shareAppContentToStage=function(N,ie,ce){if(void 0===ce&&(ce={sharingProtocol:P.Collaborative}),!N)throw new Error("[share app content to stage] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("meeting.shareAppContentToStage",[ie,ce],N)},s.getAppContentStageSharingCapabilities=function(N){if(!N)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("meeting.getAppContentStageSharingCapabilities",N)},s.stopSharingAppContentToStage=function(N){if(!N)throw new Error("[stop sharing app content to stage] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("meeting.stopSharingAppContentToStage",N)},s.getAppContentStageSharingState=function(N){if(!N)throw new Error("[get app content stage sharing state] Callback cannot be null");J(T,k.sidePanel,k.meetingStage),st("meeting.getAppContentStageSharingState",N)},s.registerSpeakingStateChangeHandler=function(N){if(!N)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");J(T,k.sidePanel,k.meetingStage),gt("meeting.speakingStateChanged",N)},s.registerRaiseHandStateChangedHandler=function(N){if(!N)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");J(T,k.sidePanel,k.meetingStage),gt("meeting.raiseHandStateChanged",N)},s.registerMeetingReactionReceivedHandler=function(N){if(!N)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");J(T,k.sidePanel,k.meetingStage),gt("meeting.meetingReactionReceived",N)},function(N){N.setOptions=function(ie){J(T,k.sidePanel),ie.contentUrl&&new URL(ie.contentUrl),st("meeting.appShareButton.setOptions",[ie])}}(s.appShareButton||(s.appShareButton={})),s.requestAppAudioHandling=function(N,ie){if(!ie)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!N.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");J(T,k.sidePanel,k.meetingStage),N.isAppHandlingAudio?function(N,ie){var ce=this;st("meeting.requestAppAudioHandling",[N.isAppHandlingAudio],function(Xe,Nt){if(Xe&&null!=Nt)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(Xe)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+Xe.errorCode+" "+Xe.message);if("boolean"!=typeof Nt)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");gt("meeting.micStateChanged",function(Ze){return zr(ce,void 0,void 0,F().mark(function ge(){var et;return F().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return Qe.prev=0,Qe.next=3,N.micMuteStateChangedCallback(Ze);case 3:B(et=Qe.sent,et.isMicMuted===Ze.isMicMuted?h.HostInitiated:h.AppDeclinedToChange),Qe.next=10;break;case 7:Qe.prev=7,Qe.t0=Qe.catch(0),B(Ze,h.AppFailedToChange);case 10:case"end":return Qe.stop()}},ge,null,[[0,7]])}))}),gt("meeting.audioDeviceSelectionChanged",function(Ze){var ge;null===(ge=N.audioDeviceSelectionChangedCallback)||void 0===ge||ge.call(N,Ze)}),ie(Nt)})}(N,ie):function(N,ie){st("meeting.requestAppAudioHandling",[N.isAppHandlingAudio],function(ce,Xe){if(ce&&null!=Xe)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(ce)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+ce.errorCode+" "+ce.message);if("boolean"!=typeof Xe)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");dr("meeting.micStateChanged")&&In("meeting.micStateChanged"),dr("meeting.audioDeviceSelectionChanged")&&In("meeting.audioDeviceSelectionChanged"),ie(Xe)})}(N,ie)},s.updateMicState=function(N){B(N,h.AppInitiated)}})(ai||(ai={})),function(s){function h(){return!(!J(T)||!T.supports.monetization)}s.openPurchaseExperience=function(b,w){var C,P;return"function"==typeof b?(C=b,P=w):P=b,J(T,k.content),function(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];var P=s.apply(void 0,w);return P.then(function(z){h&&h(null,z)}).catch(function(z){h&&h(z,null)}),P}(function(){return new Promise(function(z){if(!h())throw V;z(yn("monetization.openPurchaseExperience",P))})},C)},s.isSupported=h}(Si||(Si={}));var Mi,ro=De.V_2;!function(s){function h(){return!(!J(T)||!T.supports.calendar)}s.openCalendarItem=function(b){return new Promise(function(w){if(J(T,k.content),!h())throw new Error("Not supported");if(!b.itemId||!b.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");w(vn(R(ro,G.Calendar_OpenCalendarItem),"calendar.openCalendarItem",b))})},s.composeMeeting=function(b){return new Promise(function(w){if(J(T,k.content),!h())throw new Error("Not supported");w(T.isLegacyTeams?Dn("executeDeepLink",function(s,h,b,w,C){var P=void 0===s?"":"attendees="+s.map(function(N){return encodeURIComponent(N)}).join(","),z=void 0===h?"":"&startTime="+encodeURIComponent(h),q=void 0===b?"":"&endTime="+encodeURIComponent(b),j=void 0===w?"":"&subject="+encodeURIComponent(w),B=void 0===C?"":"&content="+encodeURIComponent(C);return he+"://"+ye+"/l/meeting/new?"+P+z+q+j+B}(b.attendees,b.startTime,b.endTime,b.subject,b.content)):vn(R(ro,G.Calendar_ComposeMeeting),"calendar.composeMeeting",b))})},s.isSupported=h}(Mi||(Mi={}));var Pi,Br,io,si,Go=De.V_2;(function(s){function h(){return!(!J(T)||!T.supports.mail)}var w;s.openMailItem=function(w){return new Promise(function(C){if(J(T,k.content),!h())throw new Error("Not supported");if(!w.itemId||!w.itemId.trim())throw new Error("Must supply an itemId to openMailItem");C(vn(R(Go,G.Mail_OpenMailItem),"mail.openMailItem",w))})},s.composeMail=function(w){return new Promise(function(C){if(J(T,k.content),!h())throw new Error("Not supported");C(vn(R(Go,G.Mail_ComposeMail),"mail.composeMail",w))})},s.isSupported=h,(w=s.ComposeMailType||(s.ComposeMailType={})).New="new",w.Reply="reply",w.ReplyAll="replyAll",w.Forward="forward"})(Pi||(Pi={})),function(s){function h(){St().print()}function b(P,z){!cn(P)&&J(T),!cn(P)&&z&&z(),function(s){Vt.loadHandler=s,!cn(s)&&$t(R(De.V_2,G.RegisterHandler),"registerHandler",["load"])}(P)}function w(P,z){!cn(P)&&J(T),!cn(P)&&z&&z(),function(s){Vt.beforeUnloadHandler=s,!cn(s)&&$t(R(De.V_2,G.RegisterHandler),"registerHandler",["beforeUnload"])}(P)}function C(){return!(!J(T)||!T.supports.teamsCore)}s.enablePrintCapability=function(){if(!Q.printCapabilityEnabled){if(J(T),!C())throw V;Q.printCapabilityEnabled=!0,document.addEventListener("keydown",function(P){(P.ctrlKey||P.metaKey)&&80===P.keyCode&&(h(),P.cancelBubble=!0,P.preventDefault(),P.stopImmediatePropagation())})}},s.print=h,s.registerOnLoadHandler=function(P){b(P,function(){if(!cn(P)&&!C())throw V})},s.registerOnLoadHandlerHelper=b,s.registerBeforeUnloadHandler=function(P){w(P,function(){if(!cn(P)&&!C())throw V})},s.registerBeforeUnloadHandlerHelper=w,s.isSupported=C}(Br||(Br={})),function(s){function h(w){return new Promise(function(C){if(!ir("2.0.0"))throw{errorCode:Ve.OLD_PLATFORM};if(!function(s){return!(s&&(s.title&&"string"!=typeof s.title||s.setSelected&&"object"!=typeof s.setSelected||s.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof s.openOrgWideSearchInChatOrChannel||s.singleSelect&&"boolean"!=typeof s.singleSelect))}(w))throw{errorCode:Ve.INVALID_ARGUMENTS};if(!b())throw V;C(yn("people.selectPeople",w))})}function b(){return!(!J(T)||!T.supports.people)}s.selectPeople=function(w,C){var P,z,q;return J(T,k.content,k.task,k.settings),"function"==typeof w?(z=(P=[w,C])[0],q=P[1]):q=w,function(s,h){for(var b=arguments.length,w=new Array(b>2?b-2:0),C=2;C<b;C++)w[C-2]=arguments[C];var P=s.apply(void 0,w);return P.then(function(z){h&&h(void 0,z)}).catch(function(z){h&&h(z)}),P}(h,z,q)},s.isSupported=b}(io||(io={})),function(s){s.showProfile=function(h){return J(T,k.content),new Promise(function(b){var w=function(s){return s?s.modality&&"string"!=typeof s.modality?[!1,"modality must be a string"]:s.targetElementBoundingRect&&"object"==typeof s.targetElementBoundingRect?s.triggerType&&"string"==typeof s.triggerType?function(s){return s?s.displayName&&"string"!=typeof s.displayName?[!1,"displayName must be a string"]:s.identifiers&&"object"==typeof s.identifiers?s.identifiers.AadObjectId||s.identifiers.Smtp||s.identifiers.Upn?s.identifiers.AadObjectId&&"string"!=typeof s.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:s.identifiers.Smtp&&"string"!=typeof s.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:s.identifiers.Upn&&"string"!=typeof s.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(s.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(h);if(!w[0])throw{errorCode:Ve.INVALID_ARGUMENTS,message:w[1]};b(yn("profile.showProfile",{modality:h.modality,persona:h.persona,triggerType:h.triggerType,targetRectangle:{x:h.targetElementBoundingRect.x,y:h.targetElementBoundingRect.y,width:h.targetElementBoundingRect.width,height:h.targetElementBoundingRect.height}}))})},s.isSupported=function(){return!(!J(T)||!T.supports.profile)}}(si||(si={}));var Vr,Ur=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})};function La(s,h,b,w){var C,P;return Ur(this,void 0,void 0,F().mark(function z(){var q;return F().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return q=Ga(),!Et()&&(null===(P=null===(C=window.chrome)||void 0===C?void 0:C.webview)||void 0===P||P.registerTextureStream(s,q)),B.t0=Wr,B.next=5,xs(s,b,w);case 5:B.t1=B.sent,B.t2=new jr(b,h),B.t3=q.writable,(0,B.t0)(B.t1,B.t2,B.t3);case 9:case"end":return B.stop()}},z)}))}function qr(s,h,b,w){var C,P;return Ur(this,void 0,void 0,F().mark(function z(){var q;return F().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return q=Ga(),!Et()&&(null===(P=null===(C=window.chrome)||void 0===C?void 0:C.webview)||void 0===P||P.registerTextureStream(s,q)),B.t0=Wr,B.next=5,xs(s,b,w);case 5:B.t1=B.sent,B.t2=new ks(b,h),B.t3=q.writable,(0,B.t0)(B.t1,B.t2,B.t3);case 9:case"end":return B.stop()}},z)}))}function xs(s,h,b){return Ur(this,void 0,void 0,F().mark(function w(){var C,P;return F().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(!Et()){q.next=2;break}throw V;case 2:return C=St().chrome,q.prev=3,b?.reportGettingTextureStream(s),q.next=7,C.webview.getTextureStream(s);case 7:if(0!==(P=q.sent.getVideoTracks()).length){q.next=10;break}throw new Error("No video track in stream "+s);case 10:return q.abrupt("return",(b?.reportTextureStreamAcquired(),P[0]));case 13:throw q.prev=13,q.t0=q.catch(3),h("Failed to get video track from stream "+s+", error: "+q.t0),new Error("Internal error: can't get video track from stream "+s);case 16:case"end":return q.stop()}},w,null,[[3,13]])}))}function Ga(){if(Et())throw V;var s=window.MediaStreamTrackGenerator;if(!s)throw V;return new s({kind:"video"})}function Wr(s,h,b){new(St().MediaStreamTrackProcessor)({track:s}).readable.pipeThrough(new TransformStream(h)).pipeTo(b)}!function(s){s.TimestampIsNull="timestamp of the original video frame is null",s.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Vr||(Vr={}));var jr=function(h,b){var w=this;this.notifyError=h,this.videoFrameHandler=b,this.transform=function(C,P){return Ur(w,void 0,void 0,F().mark(function z(){var q,j,B;return F().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(null===(q=C.timestamp)){ie.next=15;break}return ie.prev=2,ie.next=5,this.videoFrameHandler({videoFrame:C});case 5:j=ie.sent,B=new VideoFrame(j,{timestamp:q}),P.enqueue(B),C.close(),j.close(),ie.next=13;break;case 10:ie.prev=10,ie.t0=ie.catch(2),C.close(),this.notifyError(ie.t0);case 13:ie.next=16;break;case 15:this.notifyError(Vr.TimestampIsNull);case 16:case"end":return ie.stop()}},z,this,[[2,10]])}))}},Is=function(){function s(h,b){if(this.headerBuffer=h,this.notifyError=b,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(h),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return M(s,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),s}(),Ds=function(){function s(h,b){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var w=new Uint32Array(h),C=0,P=0;C<b;C++){var z=w[P++],q=w[P++],j=w[P++],B=new Uint8Array(h,q,j);this.metadataMap.set(z,B)}}return M(s,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),s}(),ks=function(h,b){var w=this;this.notifyError=h,this.videoFrameHandler=b,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(C,P){return Ur(w,void 0,void 0,F().mark(function z(){var q,j,B,N,ce,Xe,Nt;return F().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(null===(q=C.timestamp)){ge.next=22;break}return ge.prev=2,ge.next=5,this.extractVideoFrameAndMetadata(C);case 5:return B=(j=ge.sent).videoFrame,ce=(void 0===(N=j.metadata)?{}:N).audioInferenceResult,ge.next=12,this.videoFrameHandler({videoFrame:B,audioInferenceResult:ce});case 12:Xe=ge.sent,Nt=new VideoFrame(Xe,{timestamp:q}),P.enqueue(Nt),B.close(),C.close(),Xe.close(),ge.next=20;break;case 17:ge.prev=17,ge.t0=ge.catch(2),C.close(),this.notifyError(ge.t0);case 20:ge.next=23;break;case 22:this.notifyError(Vr.TimestampIsNull);case 23:case"end":return ge.stop()}},z,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(C){return Ur(w,void 0,void 0,F().mark(function P(){var z,q,j,B,N,ie;return F().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(!Et()){Xe.next=2;break}throw V;case 2:if("NV12"===C.format){Xe.next=4;break}throw this.notifyError(Vr.UnsupportedVideoFramePixelFormat),new Error(Vr.UnsupportedVideoFramePixelFormat);case 4:return z={x:0,y:0,width:C.codedWidth,height:2},q=new ArrayBuffer(z.width*z.height*3/2),Xe.next=7,C.copyTo(q,{rect:z});case 7:return j=new Is(q,this.notifyError),B={x:0,y:j.multiStreamHeaderRowOffset,width:C.codedWidth,height:C.codedHeight-j.multiStreamHeaderRowOffset},N=new ArrayBuffer(B.width*B.height*3/2),Xe.next=10,C.copyTo(N,{rect:B});case 10:return ie=new Ds(N,j.multiStreamCount),Xe.abrupt("return",{videoFrame:new VideoFrame(C,{timestamp:C.timestamp,visibleRect:{x:0,y:j.frameRowOffset,width:j.frameWidth,height:j.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:ie.audioInferenceResult}});case 12:case"end":return Xe.stop()}},P,this)}))},gt("video.mediaStream.audioInferenceDiscardStatusChange",function(C){w.shouldDiscardAudioInferenceResult=C.discardAudioInferenceResult})};function _r(s,h){return function(b,w){h?.reportApplyingVideoEffect(b||"",w),s(b,w).then(function(){h?.reportVideoEffectChanged(b||"",w),st("video.videoEffectReadiness",[!0,b,void 0,w])}).catch(function(C){st("video.videoEffectReadiness",[!1,b,C in lr.EffectFailureReason?C:lr.EffectFailureReason.InitializationFailure,w])})}}var Cr=function(){function s(){}return s.setTimeout=function(b,w){var C=performance.now(),P=Dt();return s.setTimeoutCallbacks[P]={callback:b,timeoutInMs:w,startedAtInMs:C},P},s.clearTimeout=function(b){delete s.setTimeoutCallbacks[b]},s.setInterval=function(b,w){s.setTimeout(function C(){b(),s.setTimeout(C,w)},w)},s.tick=function(){var b=performance.now(),w=[];for(var C in s.setTimeoutCallbacks){var P=s.setTimeoutCallbacks[C];b-P.startedAtInMs>=P.timeoutInMs&&w.push(C)}for(var z=0,q=w;z<q.length;z++){var j=q[z];s.setTimeoutCallbacks[j].callback(),delete s.setTimeoutCallbacks[j]}},s}();Cr.setTimeoutCallbacks={};var ao=function(){function s(b,w){this.reportStatisticsResult=w,this.sampleCount=0,this.distributionBins=new Uint32Array(b)}var h=s.prototype;return h.processStarts=function(w,C,P,z){Cr.tick(),this.suitableForThisSession(w,C,P,z)||this.reportAndResetSession(this.getStatistics(),w,z,C,P),this.start()},h.processEnds=function(){var w=performance.now()-this.frameProcessingStartedAt,C=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,w)));this.distributionBins[C]+=1,this.sampleCount+=1},h.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},h.start=function(){this.frameProcessingStartedAt=performance.now()},h.suitableForThisSession=function(w,C,P,z){return this.currentSession&&this.currentSession.effectId===w&&this.currentSession.effectParam===z&&this.currentSession.frameWidth===C&&this.currentSession.frameHeight===P},h.reportAndResetSession=function(w,C,P,z,q){var j=this;w&&this.reportStatisticsResult(w),this.resetCurrentSession(this.getNextTimeout(C,this.currentSession),C,P,z,q),this.timeoutId&&Cr.clearTimeout(this.timeoutId),this.timeoutId=Cr.setTimeout(function(){return j.reportAndResetSession(j.getStatistics(),C,P,z,q)}.bind(this),this.currentSession.timeoutInMs)},h.resetCurrentSession=function(w,C,P,z,q){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:w,effectId:C,effectParam:P,frameWidth:z,frameHeight:q},this.sampleCount=0,this.distributionBins.fill(0)},h.getNextTimeout=function(w,C){return C&&C.effectId===w?Math.min(s.maxSessionTimeoutInMs,2*C.timeoutInMs):s.initialSessionTimeoutInMs},s}();ao.initialSessionTimeoutInMs=1e3,ao.maxSessionTimeoutInMs=3e4;var so=function(){function s(b){var w=this;this.reportPerformanceEvent=b,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new ao(s.distributionBinSize,function(C){return w.reportPerformanceEvent("video.performance.performanceDataGenerated",[C])})}var h=s.prototype;return h.startMonitorSlowFrameProcessing=function(){var w=this;Cr.setInterval(function(){if(0!==w.processedFrameCount){var C=w.frameProcessingTimeCost/w.processedFrameCount;C>w.frameProcessTimeLimit&&w.reportPerformanceEvent("video.performance.frameProcessingSlow",[C]),w.frameProcessingTimeCost=0,w.processedFrameCount=0}},s.calculateFPSInterval)},h.setFrameProcessTimeLimit=function(w){this.frameProcessTimeLimit=w},h.reportApplyingVideoEffect=function(w,C){var P,z;(null===(P=this.applyingEffect)||void 0===P?void 0:P.effectId)===w&&(null===(z=this.applyingEffect)||void 0===z?void 0:z.effectParam)===C||(this.applyingEffect={effectId:w,effectParam:C},this.appliedEffect=void 0)},h.reportVideoEffectChanged=function(w,C){void 0===this.applyingEffect||this.applyingEffect.effectId!==w&&this.applyingEffect.effectParam!==C||(this.appliedEffect={effectId:w,effectParam:C},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},h.reportStartFrameProcessing=function(w,C){Cr.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,w,C,this.appliedEffect.effectParam))},h.reportFrameProcessed=function(){var w;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(w=this.appliedEffect)||void 0===w?void 0:w.effectParam])))},h.reportGettingTextureStream=function(w){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=w},h.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var w=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,w])}},s}();so.distributionBinSize=1e3,so.calculateFPSInterval=1e3;var lr,No,Jn,cr,$r=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})};(function(s){var Ze,h=Et()?void 0:new so(st);function z(Ze){st("video.notifyError",[Ze])}function q(){return J(T)&&!!T.supports.video&&(!!T.supports.video.mediaStream||!!T.supports.video.sharedFrame)}function B(Ze,ge){var et=this;return function(pt){return $r(et,void 0,void 0,F().mark(function Qe(){var Ut,Yt;return F().wrap(function(En){for(;;)switch(En.prev=En.next){case 0:return Ut=pt.videoFrame,ge?.reportStartFrameProcessing(Ut.codedWidth,Ut.codedHeight),En.next=4,Ze(pt);case 4:return Yt=En.sent,En.abrupt("return",(ge?.reportFrameProcessed(),Yt));case 6:case"end":return En.stop()}},Qe)}))}}function N(Ze,ge){if(J(T,k.sidePanel),!q()||!Nt())throw V;gt("video.newVideoFrame",function(et){if(et){var pt=et.timestamp;h?.reportStartFrameProcessing(et.width,et.height),Ze(function(Ze){if("videoFrameBuffer"in Ze)return Ze;var ge=Ze.data,et=function(h,b){var w={};for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&b.indexOf(C)<0&&(w[C]=h[C]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var P=0;for(C=Object.getOwnPropertySymbols(h);P<C.length;P++)b.indexOf(C[P])<0&&Object.prototype.propertyIsEnumerable.call(h,C[P])&&(w[C[P]]=h[C[P]])}return w}(Ze,["data"]);return Object.assign(Object.assign({},et),{videoFrameBuffer:ge})}(et),function(){h?.reportFrameProcessed(),function(Ze){st("video.videoFrameProcessed",[Ze])}(pt)},z)}},!1),st("video.registerForVideoFrame",[ge])}function ce(){var Ze;return J(T,k.sidePanel)&&function(){var Ze,ge,et,pt;return!(null===(ge=null===(Ze=St().chrome)||void 0===Ze?void 0:Ze.webview)||void 0===ge||!ge.getTextureStream||null===(pt=null===(et=St().chrome)||void 0===et?void 0:et.webview)||void 0===pt||!pt.registerTextureStream)}()&&!(null===(Ze=T.supports.video)||void 0===Ze||!Ze.mediaStream)}function Nt(){var Ze;return J(T,k.sidePanel)&&!(null===(Ze=T.supports.video)||void 0===Ze||!Ze.sharedFrame)}(s.VideoFrameFormat||(s.VideoFrameFormat={})).NV12="NV12",(Ze=s.EffectChangeType||(s.EffectChangeType={})).EffectChanged="EffectChanged",Ze.EffectDisabled="EffectDisabled",function(Ze){Ze.InvalidEffectId="InvalidEffectId",Ze.InitializationFailure="InitializationFailure"}(s.EffectFailureReason||(s.EffectFailureReason={})),s.registerForVideoFrame=function(Ze){if(J(T,k.sidePanel),!q())throw V;if(!Ze.videoFrameHandler||!Ze.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(gt("video.setFrameProcessTimeLimit",function(ge){return h?.setFrameProcessTimeLimit(ge.timeLimit)},!1),ce())!function(Ze,ge){var et=this;if(J(T,k.sidePanel),!q()||!ce())throw V;gt("video.startVideoExtensibilityVideoStream",function(pt){return $r(et,void 0,void 0,F().mark(function Qe(){var Ut,Yt;return F().wrap(function(En){for(;;)switch(En.prev=En.next){case 0:return Ut=pt.streamId,Yt=B(Ze,h),En.next=3,La(Ut,Yt,z,h);case 3:case"end":return En.stop()}},Qe)}))},!1),st("video.mediaStream.registerForVideoFrame",[ge])}(Ze.videoFrameHandler,Ze.config);else{if(!Nt())throw V;N(Ze.videoBufferHandler,Ze.config)}h?.startMonitorSlowFrameProcessing()},s.notifySelectedVideoEffectChanged=function(Ze,ge){if(J(T,k.sidePanel),!q())throw V;st("video.videoEffectChanged",[Ze,ge])},s.registerForVideoEffect=function(Ze){if(J(T,k.sidePanel),!q())throw V;gt("video.effectParameterChange",_r(Ze,h),!1),st("video.registerForVideoEffect")},s.isSupported=q})(lr||(lr={})),function(s){var h="search.queryChange",b="search.queryClose",w="search.queryExecute";function C(){return!(!J(T)||!T.supports.search)}s.registerHandlers=function(P,z,q){if(J(T,k.content),!C())throw V;gt(b,P),gt(w,z),q&&gt(h,q)},s.unregisterHandlers=function(){if(J(T,k.content),!C())throw V;st("search.unregister"),In(h),In(b),In(w)},s.isSupported=C,s.closeSearch=function(){return new Promise(function(P){if(J(T,k.content),!C())throw new Error("Not supported");P(Dn("search.closeSearch"))})}}(No||(No={})),function(s){function h(z){return new Promise(function(q){if(!P())throw V;q(yn(s.SharingAPIMessages.shareWebContent,z))})}function P(){return!(!J(T)||!T.supports.sharing)}s.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},s.shareWebContent=function(z,q){try{(function(z){if(!(z&&z.content&&z.content.length))throw{errorCode:Ve.INVALID_ARGUMENTS,message:"Shared content is missing"}})(z),function(z){if(z.content.some(function(j){return!j.type}))throw{errorCode:Ve.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(z.content.some(function(j){return j.type!==z.content[0].type}))throw{errorCode:Ve.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(z),function(z){if("URL"!==z.content[0].type)throw{errorCode:Ve.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(z.content.some(function(j){return!j.url}))throw{errorCode:Ve.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(z)}catch(j){return S(function(){return Promise.reject(j)},q)}return J(T,k.content,k.sidePanel,k.task,k.stage,k.meetingStage),S(h,q,z)},s.isSupported=P}(Jn||(Jn={})),function(s){var w;function b(){return!(!J(T)||!T.supports.stageView)}(w=s.StageViewOpenMode||(s.StageViewOpenMode={})).modal="modal",w.popout="popout",w.popoutWithChat="popoutWithChat",s.open=function(w){return new Promise(function(C){if(J(T,k.content),!b())throw V;if(!w)throw new Error("[stageView.open] Stage view params cannot be null");C(yn("stageView.open",w))})},s.isSupported=b}(cr||(cr={}));var lo,co,zo=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})};(function(s){var w,C;(C=s.CameraRestriction||(s.CameraRestriction={}))[C.FrontOrRear=1]="FrontOrRear",C[C.FrontOnly=2]="FrontOnly",C[C.RearOnly=3]="RearOnly",function(C){C[C.Camera=1]="Camera",C[C.Gallery=2]="Gallery"}(s.Source||(s.Source={})),s.hasPermission=function(){if(J(T,k.content,k.task),!w.isSupported())throw V;return yn("permissions.has",_t.Media)},s.requestPermission=function(){if(J(T,k.content,k.task),!w.isSupported())throw V;return yn("permissions.request",_t.Media)},function(C){function P(){return!!(J(T)&&T.supports.visualMedia&&T.supports.visualMedia.image&&T.supports.permissions)}function z(){if(!P())throw V}function q(B){if(!B||B.maxVisualMediaCount>10||B.maxVisualMediaCount<1)throw Mn}function j(B,N){if(N.length>B)throw fn}C.captureImages=function(B){return zo(this,void 0,void 0,F().mark(function N(){var ie;return F().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return J(T,k.content,k.task),z(),q(B),Xe.next=3,yn("visualMedia.image.captureImages",B);case 3:return Xe.abrupt("return",(j(B.maxVisualMediaCount,ie=Xe.sent),ie));case 5:case"end":return Xe.stop()}},N)}))},C.retrieveImages=function(B){return zo(this,void 0,void 0,F().mark(function N(){var ie;return F().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return J(T,k.content,k.task),z(),q(B),Xe.next=3,yn("visualMedia.image.retrieveImages",B);case 3:return Xe.abrupt("return",(j(B.maxVisualMediaCount,ie=Xe.sent),ie));case 5:case"end":return Xe.stop()}},N)}))},C.isSupported=P}(w=s.image||(s.image={}))})(lo||(lo={})),function(s){function h(){return!(!J(T)||!T.supports.webStorage)}s.isWebStorageClearedOnUserLogOut=function(){return J(T),h()},s.isSupported=h}(co||(co={}));var uo,Fr,Bo=De.V_2;(function(s){var h,w;function b(){return!(!J(T)||!T.supports.call)}(w=h=s.CallModalities||(s.CallModalities={})).Unknown="unknown",w.Audio="audio",w.Video="video",w.VideoBasedScreenSharing="videoBasedScreenSharing",w.Data="data",s.startCall=function(w){var C=R(Bo,G.Call_StartCall);return new Promise(function(P){var z;if(J(T,k.content,k.task),!b())throw V;if(!T.isLegacyTeams)return $t(C,"call.startCall",[w],P);P(Or(C,"executeDeepLink",function(s,h,b){if(0===s.length)throw new Error("Must have at least one target when creating a call deep link");var w="users="+s.map(function(z){return encodeURIComponent(z)}).join(","),C=void 0===h?"":"&withVideo="+encodeURIComponent(h),P=void 0===b?"":"&source="+encodeURIComponent(b);return he+"://"+ye+"/l/call/0/0?"+w+C+P}(w.targets,null===(z=w.requestedModalities)||void 0===z?void 0:z.includes(h.Video),w.source)).then(function(q){if(!q)throw new Error("The call was not properly started");return q}))})},s.isSupported=b})(uo||(uo={})),function(s){s.Messages=Yn.Messages,s.FailedReason=Yn.FailedReason,s.ExpectedFailureReason=Yn.ExpectedFailureReason,s.notifyAppLoaded=function(){Yn.notifyAppLoaded()},s.notifySuccess=function(){Yn.notifySuccess()},s.notifyFailure=function(h){Yn.notifyFailure(h)},s.notifyExpectedFailure=function(h){Yn.notifyExpectedFailure(h)}}(Fr||(Fr={}));var po,Uo=pe("thirdPartyCloudStorage");!function(s){var h=[],b={fileType:"",assembleAttachment:[]},w=!0,C=null;function P(q){if(C)if(q&&q.error)C([],q.error),C=null;else if(q&&q.fileChunk)try{w||0!==q.fileChunk.chunkSequence||(Uo("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),w=!0,C([],{errorCode:Ve.INTERNAL_ERROR,message:"error occurred while receiving data"}),h=[],C=null);var j=eo(q.fileChunk,q.fileType);if(j?b.assembleAttachment.push(j):(Uo("Received a null assemble attachment for when decoding chunk sequence "+q.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),C?C([],{errorCode:Ve.INTERNAL_ERROR,message:"error occurred while receiving data"}):C=null,h=[],C=null,w=!0),w=q.fileChunk.endOfFile,q.fileChunk.endOfFile){var B=ii(b.assembleAttachment,b.fileType);if(B){var N=new File([B],q.fileName,{type:B.type});h.push(N)}q.isLastFile&&C&&(C(h,q.error),h=[],C=null,w=!0),b={fileType:"",assembleAttachment:[]}}}catch(ie){C&&(C([],{errorCode:Ve.INTERNAL_ERROR,message:ie}),h=[],C=null,w=!0)}else C([],{errorCode:Ve.INTERNAL_ERROR,message:"data received is null"}),h=[],C=null,w=!0}function z(){return!(!J(T)||!T.supports.thirdPartyCloudStorage)}s.getDragAndDropFiles=function(q,j){if(!j)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(q&&""!==q){if(J(T,k.content,k.task),!z())throw V;if(C)throw C=null,new Error("getDragAndDropFiles cannot be called twice");C=j,w=!0,st("thirdPartyCloudStorage.getDragAndDropFiles",[q],P)}else j([],{errorCode:Ve.INVALID_ARGUMENTS})},s.isSupported=z}(po||(po={}));var Pn=De.V_1;function Na(s,h){ma(R(Pn,G.PublicAPIs_Initialize),h).then(function(){s&&s()})}function Ha(){Br.enablePrintCapability()}function qo(){Br.print()}function za(s){fr(),$t(R(Pn,G.PublicAPIs_GetContext),"getContext",function(h){h.frameContext||(h.frameContext=Q.frameContext),s(h)})}function pr(s){Wi(R(Pn,G.PublicAPIs_RegisterOnThemeChangeHandlerHelper),s)}function Oi(s){jn(R(Pn,G.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",s,[])}function Ba(s){jn(R(Pn,G.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",s,[k.content])}function Wo(s){jn(R(Pn,G.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",s,[k.content])}function ho(s){jn(R(Pn,G.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",s,[k.content])}function li(s){hn.backStack.registerBackButtonHandlerHelper(R(Pn,G.PublicAPIs_RegisterBackButtonHandler),s)}function Sn(s){Br.registerOnLoadHandlerHelper(s)}function ci(s){Br.registerBeforeUnloadHandlerHelper(s)}function jo(s){jn(R(Pn,G.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",s,[])}function go(s){jn(R(Pn,G.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",s,[k.content])}function fo(s,h){J(T),zn(R(Pn,G.PublicAPIs_GetTabInstances),h).then(function(b){s(b)})}function mo(s,h){J(T),dt(R(Pn,G.PublicAPIs_GetMruTabInstances),h).then(function(b){s(b)})}function Qr(s){Mo(R(Pn,G.PublicAPIs_ShareDeepLink),{subPageId:s.subEntityId,subPageLabel:s.subEntityLabel,subPageWebUrl:s.subEntityWebUrl})}function yr(s,h){J(T,k.content,k.sidePanel,k.settings,k.task,k.stage,k.meetingStage);var b=h??jt();va(R(Pn,G.PublicAPIs_ExecuteDeepLink),s).then(function(){b(!0)}).catch(function(w){b(!1,w.message)})}function Kr(s){Rn(R(Pn,G.PublicAPIs_SetFrameContext),s)}function Ei(s,h,b){ma(R(Pn,G.PublicAPIs_Initialize),b).then(function(){return h&&h()}),Rn(R(Pn,G.PublicAPIs_SetFrameContext),s)}var xi,Jt=De.V_1;function $o(s){Gr(R(Jt,G.Navigation_ReturnFocus),s)}function Ti(s,h){J(T);var b=h??jt();bt(R(Jt,G.Navigation_NavigateToTab),s).then(function(){b(!0)}).catch(function(w){b(!1,w.message)})}function Qo(s,h){J(T,k.content,k.sidePanel,k.settings,k.remove,k.task,k.stage,k.meetingStage);var b=h??jt();So(R(Jt,G.Navigation_NavigateCrossDomain),s).then(function(){b(!0)}).catch(function(w){b(!1,w.message)})}function Ko(s){J(T);var h=s??jt();us(R(Jt,G.Navigation_NavigateBack)).then(function(){h(!0)}).catch(function(b){h(!1,b.message)})}!function(s){s.setValidityState=function(h){hn.config.setValidityState(h)},s.getSettings=function(h){J(T,k.content,k.settings,k.remove,k.sidePanel),hn.getConfig().then(function(b){h(b)})},s.setSettings=function(h,b){J(T,k.content,k.settings,k.sidePanel);var w=b??jt();hn.config.setConfig(h).then(function(){w(!0)}).catch(function(C){w(!1,C.message)})},s.registerOnSaveHandler=function(h){hn.config.registerOnSaveHandlerHelper(h)},s.registerOnRemoveHandler=function(h){hn.config.registerOnRemoveHandlerHelper(h)}}(xi||(xi={}));var Di,ui,Ii=De.V_1;(function(s){function w(C){return C.height=C.height?C.height:de.Small,C.width=C.width?C.width:de.Small,C}s.startTask=function(C,P){var z=R(Ii,G.Tasks_StartTask),q=P?function(j){var B,N;return P(null!==(B=j.err)&&void 0!==B?B:"",null!==(N=j.result)&&void 0!==N?N:"")}:void 0;return void 0===C.card&&void 0===C.url||C.card?(J(T,k.content,k.sidePanel,k.meetingStage),$t(z,"tasks.startTask",[C],P)):void 0!==C.completionBotId?as(z,function(C){if(void 0===C.url||void 0===C.completionBotId)throw new Error("Both url "+C.url+" and completionBotId "+C.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:C.url,size:{height:C.height?C.height:de.Small,width:C.width?C.width:de.Small},title:C.title,fallbackUrl:C.fallbackUrl,completionBotId:C.completionBotId}}(C),q):fa(z,function(C){if(void 0===C.url)throw new Error("url property of taskInfo object can't be undefined");return{url:C.url,size:{height:C.height?C.height:de.Small,width:C.width?C.width:de.Small},title:C.title,fallbackUrl:C.fallbackUrl}}(C),q),new Lo},s.updateTask=function(C){var j=function(h,b){var w={};for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&b.indexOf(C)<0&&(w[C]=h[C]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var P=0;for(C=Object.getOwnPropertySymbols(h);P<C.length;P++)b.indexOf(C[P])<0&&Object.prototype.propertyIsEnumerable.call(h,C[P])&&(w[C[P]]=h[C[P]])}return w}(C=w(C),["width","height"]);if(Object.keys(j).length)throw new Error("resize requires a TaskInfo argument containing only width and height");os(R(Ii,G.Tasks_UpdateTask),C)},s.submitTask=function(C,P){ss(R(Ii,G.Tasks_SubmitTask),C,P)},s.getDefaultSizeIfNotProvided=w})(Di||(Di={})),function(s){var w;(w=s.UserMeetingRole||(s.UserMeetingRole={})).guest="Guest",w.attendee="Attendee",w.presenter="Presenter",w.organizer="Organizer",function(w){w.added="Added",w.alreadyExists="AlreadyExists",w.conflict="Conflict",w.notFound="NotFound"}(s.ContainerState||(s.ContainerState={})),s.isSupported=function(){return!(!J(T,k.meetingStage,k.sidePanel)||!T.supports.interactive)}}(ui||(ui={}));var Zo=function(){function s(){}var h=s.prototype;return h.getFluidTenantInfo=function(){return ur(),new Promise(function(w){w(yn("interactive.getFluidTenantInfo"))})},h.getFluidToken=function(w){return ur(),new Promise(function(C){C(yn("interactive.getFluidToken",w))})},h.getFluidContainerId=function(){return ur(),new Promise(function(w){w(yn("interactive.getFluidContainerId"))})},h.setFluidContainerId=function(w){return ur(),new Promise(function(C){C(yn("interactive.setFluidContainerId",w))})},h.getNtpTime=function(){return ur(),new Promise(function(w){w(yn("interactive.getNtpTime"))})},h.registerClientId=function(w){return ur(),new Promise(function(C){C(yn("interactive.registerClientId",w))})},h.getClientRoles=function(w){return ur(),new Promise(function(C){C(yn("interactive.getClientRoles",w))})},h.getClientInfo=function(w){return ur(),new Promise(function(C){C(yn("interactive.getClientInfo",w))})},s.create=function(){return ur(),new s},s}();function ur(){if(!ui.isSupported())throw new Error("LiveShareHost Not supported")}var Yo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function di(s){try{return s.cartItems=vo(s.cartItems),s}catch{throw new Error("Error deserializing cart")}}function vo(s){return s.map(function(h){if(h.imageURL){var b=new URL(h.imageURL);h.imageURL=b}return h.accessories&&(h.accessories=vo(h.accessories)),h})}var ta=function s(h){try{return h.map(function(b){var w=b.imageURL,C=b.accessories,P=function(h,b){var w={};for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&b.indexOf(C)<0&&(w[C]=h[C]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var P=0;for(C=Object.getOwnPropertySymbols(h);P<C.length;P++)b.indexOf(C[P])<0&&Object.prototype.propertyIsEnumerable.call(h,C[P])&&(w[C[P]]=h[C[P]])}return w}(b,["imageURL","accessories"]),z=Object.assign({},P);return w&&(z.imageURL=w.href),C&&(z.accessories=s(C)),z})}catch{throw new Error("Error serializing cart items")}};function ra(s){if(null!=s){if(!Array.isArray(s)||0===s.length)throw new Error("CartItem.accessories must be a non-empty array");for(var b,h=e(s);!(b=h()).done;){var w=b.value;if(w.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");_o(w)}}}function _o(s){if(!s.id)throw new Error("cartItem.id must not be empty");if(!s.name)throw new Error("cartItem.name must not be empty");(function(s){if("number"!=typeof s||s<0)throw new Error("price "+s+" must be a number not less than 0");if(parseFloat(s.toFixed(3))!==s)throw new Error("price "+s+" must have at most 3 decimal places")})(s.price),function(s){if("number"!=typeof s||s<=0||parseInt(s.toString())!==s)throw new Error("quantity "+s+" must be an integer greater than 0")}(s.quantity)}function pi(s){if(null!=s){if(!s)throw new Error("id must not be empty");if(!1===("string"==typeof(h=s)&&Yo.test(h)))throw new Error("id must be a valid UUID")}var h}var fi,Xr,ki,qt,Zr,Ar,Vi,gi=De.V_2;(function(s){var C;function w(){return!(!J(T)||!T.supports.marketplace)}s.cartVersion={majorVersion:1,minorVersion:1},(C=s.Intent||(s.Intent={})).TACAdminUser="TACAdminUser",C.TeamsAdminUser="TeamsAdminUser",C.TeamsEndUser="TeamsEndUser",function(C){C.Open="Open",C.Processing="Processing",C.Processed="Processed",C.Closed="Closed",C.Error="Error"}(s.CartStatus||(s.CartStatus={})),s.getCart=function(){if(J(T,k.content,k.task),!w())throw V;return Bt(R(gi,G.Marketplace_GetCart),"marketplace.getCart",s.cartVersion).then(di)},s.addOrUpdateCartItems=function(C){if(J(T,k.content,k.task),!w())throw V;if(!C)throw new Error("addOrUpdateCartItemsParams must be provided");return pi(C?.cartId),function(s){if(!Array.isArray(s)||0===s.length)throw new Error("cartItems must be a non-empty array");for(var b,h=e(s);!(b=h()).done;){var w=b.value;_o(w),ra(w.accessories)}}(C?.cartItems),Bt(R(gi,G.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},C),{cartItems:ta(C.cartItems),cartVersion:s.cartVersion})).then(di)},s.removeCartItems=function(C){if(J(T,k.content,k.task),!w())throw V;if(!C)throw new Error("removeCartItemsParams must be provided");if(pi(C?.cartId),!Array.isArray(C?.cartItemIds)||0===C?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return Bt(R(gi,G.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},C),{cartVersion:s.cartVersion})).then(di)},s.updateCartStatus=function(C){if(J(T,k.content,k.task),!w())throw V;if(!C)throw new Error("updateCartStatusParams must be provided");return pi(C?.cartId),function(s){if(!Object.values(fi.CartStatus).includes(s))throw new Error("cartStatus "+s+" is not valid")}(C?.cartStatus),Bt(R(gi,G.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},C),{cartVersion:s.cartVersion})).then(di)},s.isSupported=w})(fi||(fi={})),function(s){var b,C,q,h="Action.Execute";function P(q){if(q.requestType===b.ActionExecuteInvokeRequest){if(q.type!==h)throw{errorCode:C.INTERNAL_ERROR,message:"Invalid action type "+q.type+'. Action type must be "'+h+'"'}}else if(q.requestType===b.QueryMessageExtensionRequest){if(q.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(q.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var N,B=e(q.parameters);!(N=B()).done;){var ie=N.value;if(ie.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(ie.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function z(){return!(!J(T)||!T.supports.externalAppAuthentication)}(q=b=s.OriginalRequestType||(s.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",q.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(q){q.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",q.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(s.InvokeResponseType||(s.InvokeResponseType={})),function(q){q.INTERNAL_ERROR="INTERNAL_ERROR"}(C=s.InvokeErrorCode||(s.InvokeErrorCode={})),s.authenticateAndResendRequest=function(q,j,B){if(J(T,k.content),!z())throw V;return Lt(q),P(B),or("externalAppAuthentication.authenticateAndResendRequest",[q,B,j.url.href,j.width,j.height,j.isExternal]).then(function(N){var ce=N[1];if(N[0]&&null!=ce.responseType)return ce;throw ce})},s.authenticateWithSSO=function(q,j){if(J(T,k.content),!z())throw V;return Lt(q),or("externalAppAuthentication.authenticateWithSSO",[q,j.claims,j.silent]).then(function(B){if(!B[0])throw B[1]})},s.authenticateWithSSOAndResendRequest=function(q,j,B){if(J(T,k.content),!z())throw V;return Lt(q),P(B),or("externalAppAuthentication.authenticateWithSSOAndResendRequest",[q,B,j.claims,j.silent]).then(function(N){var ce=N[1];if(N[0]&&null!=ce.responseType)return ce;throw ce})},s.isSupported=z}(Xr||(Xr={})),function(s){var P;function C(){return!(!J(T)||!T.supports.externalAppCardActions)}(P=s.ActionOpenUrlType||(s.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",P.DeepLinkOther="DeepLinkOther",P.DeepLinkStageView="DeepLinkStageView",P.GenericUrl="GenericUrl",function(P){P.INTERNAL_ERROR="INTERNAL_ERROR",P.INVALID_LINK="INVALID_LINK",P.NOT_SUPPORTED="NOT_SUPPORTED"}(s.ActionOpenUrlErrorCode||(s.ActionOpenUrlErrorCode={})),function(P){P.INTERNAL_ERROR="INTERNAL_ERROR"}(s.ActionSubmitErrorCode||(s.ActionSubmitErrorCode={})),s.processActionSubmit=function(P,z){if(J(T,k.content),!C())throw V;return Lt(P),or("externalAppCardActions.processActionSubmit",[P,z]).then(function(q){if(!q[0])throw q[1]})},s.processActionOpenUrl=function(P,z){if(J(T,k.content),!C())throw V;return Lt(P),or("externalAppCardActions.processActionOpenUrl",[P,z.href]).then(function(q){var j=q[0];if(j)throw j;return q[1]})},s.isSupported=C}(ki||(ki={})),function(s){var j;function q(j,B){return{errorCode:j,message:B}}(j=s.CloudStorageProvider||(s.CloudStorageProvider={})).Dropbox="DROPBOX",j.Box="BOX",j.Sharefile="SHAREFILE",j.GoogleDrive="GOOGLEDRIVE",j.Egnyte="EGNYTE",j.SharePoint="SharePoint",function(j){j[j.Sharepoint=0]="Sharepoint",j[j.WopiIntegration=1]="WopiIntegration",j[j.Google=2]="Google",j[j.OneDrive=3]="OneDrive",j[j.Recent=4]="Recent",j[j.Aggregate=5]="Aggregate",j[j.FileSystem=6]="FileSystem",j[j.Search=7]="Search",j[j.AllFiles=8]="AllFiles",j[j.SharedWithMe=9]="SharedWithMe"}(s.CloudStorageProviderType||(s.CloudStorageProviderType={})),function(j){j.ClassMaterials="classMaterials"}(s.SpecialDocumentLibraryType||(s.SpecialDocumentLibraryType={})),function(j){j.Readonly="readonly"}(s.DocumentLibraryAccessType||(s.DocumentLibraryAccessType={})),function(j){j.Downloaded="Downloaded",j.Downloading="Downloading",j.Failed="Failed"}(s.FileDownloadStatus||(s.FileDownloadStatus={})),function(j){j.Download="DOWNLOAD",j.Upload="UPLOAD",j.Delete="DELETE"}(s.CloudStorageProviderFileAction||(s.CloudStorageProviderFileAction={})),s.getCloudStorageFolders=function(j,B){if(J(T,k.content),!j||0===j.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!B)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");st("files.getCloudStorageFolders",[j],B)},s.addCloudStorageFolder=function(j,B){if(J(T,k.content),!j||0===j.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!B)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");st("files.addCloudStorageFolder",[j],B)},s.deleteCloudStorageFolder=function(j,B,N){if(J(T,k.content),!j)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!B)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!N)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");st("files.deleteCloudStorageFolder",[j,B],N)},s.getCloudStorageFolderContents=function(j,B,N){if(J(T,k.content),!j||!B)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!N)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in j&&!j.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");st("files.getCloudStorageFolderContents",[j,B],N)},s.openCloudStorageFile=function(j,B,N){if(J(T,k.content),!j||!B)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(j.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");st("files.openCloudStorageFile",[j,B,N])},s.getExternalProviders=function(j,B){if(void 0===j&&(j=!1),J(T,k.content),!B)throw new Error("[files.getExternalProviders] Callback cannot be null");st("files.getExternalProviders",[j],B)},s.copyMoveFiles=function(j,B,N,ie,ce,Xe){if(void 0===ce&&(ce=!1),J(T,k.content),!j||0===j.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!B)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!N)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!ie)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!Xe)throw new Error("[files.copyMoveFiles] callback cannot be null");st("files.copyMoveFiles",[j,B,N,ie,ce],Xe)},s.getFileDownloads=function(j){if(J(T,k.content),!j)throw new Error("[files.getFileDownloads] Callback cannot be null");st("files.getFileDownloads",[],j)},s.openDownloadFolder=function(j,B){if(void 0===j&&(j=void 0),J(T,k.content),!B)throw new Error("[files.openDownloadFolder] Callback cannot be null");st("files.openDownloadFolder",[j],B)},s.addCloudStorageProvider=function(j){if(J(T,k.content),!j)throw q(Ve.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");st("files.addCloudStorageProvider",[],j)},s.removeCloudStorageProvider=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!j||!j.content)throw q(Ve.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");st("files.removeCloudStorageProvider",[j],B)},s.addCloudStorageProviderFile=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!j||!j.content)throw q(Ve.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");st("files.addCloudStorageProviderFile",[j],B)},s.renameCloudStorageProviderFile=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!j||!j.content)throw q(Ve.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");st("files.renameCloudStorageProviderFile",[j],B)},s.deleteCloudStorageProviderFile=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(j&&j.content&&j.content.itemList&&j.content.itemList.length>0))throw q(Ve.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");st("files.deleteCloudStorageProviderFile",[j],B)},s.downloadCloudStorageProviderFile=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(j&&j.content&&j.content.itemList&&j.content.itemList.length>0))throw q(Ve.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");st("files.downloadCloudStorageProviderFile",[j],B)},s.uploadCloudStorageProviderFile=function(j,B){if(J(T,k.content),!B)throw q(Ve.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(j&&j.content&&j.content.itemList&&j.content.itemList.length>0))throw q(Ve.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!j.content.destinationFolder)throw q(Ve.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");st("files.uploadCloudStorageProviderFile",[j],B)},s.registerCloudStorageProviderListChangeHandler=function(j){if(J(T),!j)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");gt("files.cloudStorageProviderListChange",j)},s.registerCloudStorageProviderContentChangeHandler=function(j){if(J(T),!j)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");gt("files.cloudStorageProviderContentChange",j)}}(qt||(qt={})),function(s){function h(){return!(!J(T)||!T.supports.meetingRoom)}s.getPairedMeetingRoomInfo=function(){return new Promise(function(b){if(J(T),!h())throw V;b(yn("meetingRoom.getPairedMeetingRoomInfo"))})},s.sendCommandToPairedMeetingRoom=function(b){return new Promise(function(w){if(!b||0==b.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(J(T),!h())throw V;w(yn("meetingRoom.sendCommandToPairedMeetingRoom",b))})},s.registerMeetingRoomCapabilitiesUpdateHandler=function(b){if(!b)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(J(T),!h())throw V;gt("meetingRoom.meetingRoomCapabilitiesUpdate",function(w){J(T),b(w)})},s.registerMeetingRoomStatesUpdateHandler=function(b){if(!b)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(J(T),!h())throw V;gt("meetingRoom.meetingRoomStatesUpdate",function(w){J(T),b(w)})},s.isSupported=h}(Zr||(Zr={})),function(s){function h(){return!(!J(T)||!T.supports.notifications)}s.showNotification=function(b){if(J(T,k.content),!h())throw V;st("notifications.showNotification",[b])},s.isSupported=h}(Ar||(Ar={})),function(s){var P;function C(){return!(!J(T)||!T.supports.remoteCamera)}(P=s.ControlCommand||(s.ControlCommand={})).Reset="Reset",P.ZoomIn="ZoomIn",P.ZoomOut="ZoomOut",P.PanLeft="PanLeft",P.PanRight="PanRight",P.TiltUp="TiltUp",P.TiltDown="TiltDown",function(P){P[P.CommandResetError=0]="CommandResetError",P[P.CommandZoomInError=1]="CommandZoomInError",P[P.CommandZoomOutError=2]="CommandZoomOutError",P[P.CommandPanLeftError=3]="CommandPanLeftError",P[P.CommandPanRightError=4]="CommandPanRightError",P[P.CommandTiltUpError=5]="CommandTiltUpError",P[P.CommandTiltDownError=6]="CommandTiltDownError",P[P.SendDataError=7]="SendDataError"}(s.ErrorReason||(s.ErrorReason={})),function(P){P[P.None=0]="None",P[P.ControlDenied=1]="ControlDenied",P[P.ControlNoResponse=2]="ControlNoResponse",P[P.ControlBusy=3]="ControlBusy",P[P.AckTimeout=4]="AckTimeout",P[P.ControlTerminated=5]="ControlTerminated",P[P.ControllerTerminated=6]="ControllerTerminated",P[P.DataChannelError=7]="DataChannelError",P[P.ControllerCancelled=8]="ControllerCancelled",P[P.ControlDisabled=9]="ControlDisabled",P[P.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(s.SessionTerminatedReason||(s.SessionTerminatedReason={})),s.getCapableParticipants=function(P){if(!P)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(J(T,k.sidePanel),!C())throw V;st("remoteCamera.getCapableParticipants",P)},s.requestControl=function(P,z){if(!P)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!z)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(J(T,k.sidePanel),!C())throw V;st("remoteCamera.requestControl",[P],z)},s.sendControlCommand=function(P,z){if(!P)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!z)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(J(T,k.sidePanel),!C())throw V;st("remoteCamera.sendControlCommand",[P],z)},s.terminateSession=function(P){if(!P)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(J(T,k.sidePanel),!C())throw V;st("remoteCamera.terminateSession",P)},s.registerOnCapableParticipantsChangeHandler=function(P){if(!P)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(J(T,k.sidePanel),!C())throw V;gt("remoteCamera.capableParticipantsChange",P)},s.registerOnErrorHandler=function(P){if(!P)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(J(T,k.sidePanel),!C())throw V;gt("remoteCamera.handlerError",P)},s.registerOnDeviceStateChangeHandler=function(P){if(!P)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(J(T,k.sidePanel),!C())throw V;gt("remoteCamera.deviceStateChange",P)},s.registerOnSessionStatusChangeHandler=function(P){if(!P)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(J(T,k.sidePanel),!C())throw V;gt("remoteCamera.sessionStatusChange",P)},s.isSupported=C}(Vi||(Vi={}));var Qn,br,Bn=De.V_1;(function(s){function h(){return!(!J(T)||!T.supports.appEntity)}s.selectAppEntity=function(b,w,C,P){if(J(T,k.content),!h())throw V;if(!b||0==b.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!P)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");$t(R(Bn,G.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[b,w,C],P)},s.isSupported=h})(Qn||(Qn={})),function(s){var C;function w(){return!(!J(T)||!T.supports.teams)}(C=s.ChannelType||(s.ChannelType={}))[C.Regular=0]="Regular",C[C.Private=1]="Private",C[C.Shared=2]="Shared",s.getTeamChannels=function(C,P){if(J(T,k.content),!w())throw V;if(!C)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!P)throw new Error("[teams.getTeamChannels] Callback cannot be null");st("teams.getTeamChannels",[C],P)},s.refreshSiteUrl=function(C,P){if(J(T),!w())throw V;if(!C)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!P)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");st("teams.refreshSiteUrl",[C],P)},s.isSupported=w,function(C){function z(){return!(!J(T)||!T.supports.teams||!T.supports.teams.fullTrust)}(function(q){function j(){return!!(J(T)&&T.supports.teams&&T.supports.teams.fullTrust&&T.supports.teams.fullTrust.joinedTeams)}q.getUserJoinedTeams=function(B){return new Promise(function(N){if(J(T),!j())throw V;if((Q.hostClientType===tt.android||Q.hostClientType===tt.teamsRoomsAndroid||Q.hostClientType===tt.teamsPhones||Q.hostClientType===tt.teamsDisplays)&&!ir("2.0.1"))throw new Error(JSON.stringify({errorCode:Ve.OLD_PLATFORM}));N(ni("getUserJoinedTeams",B))})},q.isSupported=j})(C.joinedTeams||(C.joinedTeams={})),C.getConfigSetting=function(q){return new Promise(function(j){if(J(T),!z())throw V;j(ni("getConfigSetting",q))})},C.isSupported=z}(s.fullTrust||(s.fullTrust={}))}(br||(br={}));var Yr,mi=function(h,b,w,C){return new(w||(w=Promise))(function(z,q){function j(ie){try{N(C.next(ie))}catch(ce){q(ce)}}function B(ie){try{N(C.throw(ie))}catch(ce){q(ce)}}function N(ie){ie.done?z(ie.value):function(z){return z instanceof w?z:new w(function(q){q(z)})}(ie.value).then(j,B)}N((C=C.apply(h,b||[])).next())})};!function(s){s.frameProcessingTimeoutInMs=2e3;var b,B,h=Et()?void 0:new so(st);function w(){var B=setTimeout(function(){j("Frame not processed in "+s.frameProcessingTimeoutInMs+"ms",b.Warn)},s.frameProcessingTimeoutInMs);return function(){clearTimeout(B)}}function C(B,N){var ie=this;return function(ce){return mi(ie,void 0,void 0,F().mark(function Xe(){var Nt,Ze,ge;return F().wrap(function(pt){for(;;)switch(pt.prev=pt.next){case 0:return N.reportStartFrameProcessing((Nt=ce.videoFrame).codedWidth,Nt.codedHeight),Ze=w(),pt.next=5,B(ce);case 5:return ge=pt.sent,pt.abrupt("return",(Ze(),N.reportFrameProcessed(),ge));case 7:case"end":return pt.stop()}},Xe)}))}}function z(){return J(T),lr.isSupported()}function j(B,N){void 0===N&&(N=b.Warn),st("video.notifyError",[B,N])}(B=b=s.ErrorLevel||(s.ErrorLevel={})).Fatal="fatal",B.Warn="warn",s.registerForVideoFrame=function(B){var ie,ce,N=this;if(!z())throw V;if(!B.videoFrameHandler||!B.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(J(T,k.sidePanel)){if(gt("video.setFrameProcessTimeLimit",function(Xe){return h?.setFrameProcessTimeLimit(Xe)},!1),null===(ie=T.supports.video)||void 0===ie?void 0:ie.mediaStream)gt("video.startVideoExtensibilityVideoStream",function(Xe){return mi(N,void 0,void 0,F().mark(function Nt(){var Ze,ge,et;return F().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:if(Ze=Xe.streamId,ge=Xe.metadataInTexture,et=h?C(B.videoFrameHandler,h):B.videoFrameHandler,!ge){Qe.next=6;break}return Qe.next=4,qr(Ze,et,j,h);case 4:Qe.next=8;break;case 6:return Qe.next=8,La(Ze,et,j,h);case 8:case"end":return Qe.stop()}},Nt)}))},!1),st("video.mediaStream.registerForVideoFrame",[B.config]);else{if(null===(ce=T.supports.video)||void 0===ce||!ce.sharedFrame)throw V;gt("video.newVideoFrame",function(Xe){if(Xe){h?.reportStartFrameProcessing(Xe.width,Xe.height);var Nt=w(),Ze=Xe.timestamp;B.videoBufferHandler(function(B){return B.videoFrameBuffer=B.videoFrameBuffer||B.data,delete B.data,B}(Xe),function(){Nt(),h?.reportFrameProcessed(),function(B){st("video.videoFrameProcessed",[B])}(Ze)},j)}},!1),st("video.registerForVideoFrame",[B.config])}h?.startMonitorSlowFrameProcessing()}},s.notifySelectedVideoEffectChanged=function(B,N,ie){if(J(T,k.sidePanel),!z())throw V;st("video.videoEffectChanged",[B,N,ie])},s.registerForVideoEffect=function(B){if(J(T,k.sidePanel),!z())throw V;gt("video.effectParameterChange",_r(B,h),!1),st("video.registerForVideoEffect")},s.updatePersonalizedEffects=function(B){if(J(T,k.sidePanel),!lr.isSupported())throw V;st("video.personalizedEffectsChanged",[B])},s.isSupported=z,s.notifyFatalError=function(B){if(J(T),!lr.isSupported())throw V;j(B,b.Fatal)}}(Yr||(Yr={}))}(),Be}()},78590:function(Pt,vt,m){"use strict";m.d(vt,{w9:function(){return ho},rP:function(){return Ua},Qo:function(){return u},Cq:function(){return Ba},Mw:function(){return e}});var u,r,e,F,oe,D,Re,Be,Ee,pe,R,Fe,M={};m.r(M),m.d(M,{addQueryParameters:function(){return qo},getOrigin:function(){return za},removeQueryAndFragment:function(){return Ha}}),(r=u||(u={}))[r.ExistingPersistedMashup=0]="ExistingPersistedMashup",r[r.TransientMashup=1]="TransientMashup",r[r.TransientEmptyMashup=2]="TransientEmptyMashup",function(r){r.AddQueries="addQueries",r.BrowseMashup="BrowseMashup",r.ConnectToDataSource="ConnectToDataSource",r.CreateConnection="CreateConnection",r.DataPreview="DataPreview",r.DiagramView="DiagramView",r.EditConnection="EditConnection",r.EditDataflowComputeEngineSettings="EditDataflowComputeEngineSettings",r.EditCubeVariables="editCubeVariables",r.EditQuery="editQuery",r.EditQuickCreate="EditQuickCreate",r.ImportMashupTemplate="importMashupTemplate",r.IncrementalRefreshSettings="incrementalRefreshSettings",r.ManageConnections="manageConnections",r.ManageDataflowComputeEngine="manageDataflowComputeEngine",r.Navigate="navigate",r.QuickCreate="QuickCreate",r.RefreshSettings="refreshSettings",r.ResolveResourceChallenge="ResolveResourceChallenge",r.ShowRefreshHistory="showRefreshHistory"}(e||(e={})),function(r){r.Cancelled="Cancelled",r.CombineFiles="CombineFiles",r.CsvTextSettings="CsvTextSettings",r.DataDiscovery="DataDiscovery",r.DataSources="DataSources",r.DataSourceSettings="DataSourceSettings",r.FolderPreview="FolderPreview",r.IncrementalRefreshSettings="IncrementalRefreshSettings",r.Loading="Loading",r.MappingEditor="MappingEditor",r.Navigator="Navigator",r.QueryEditor="QueryEditor",r.QuickCreate="QuickCreate",r.RecentDataPreview="RecentDataPreview",r.RefreshSettings="RefreshSettings",r.TemplateCredentials="TemplateCredentials",r.TemplateParameters="TemplateParameters",r.TextByExample="TextByExample"}(F||(F={})),function(r){r.Attach="Attach"}(oe||(oe={})),function(r){r.Busy="Busy",r.Error="Error",r.Ready="Ready",r.Unknown="Unknown"}(D||(D={})),function(r){r.Editable="Editable",r.Hidden="Hidden",r.Readonly="Readonly"}(Re||(Re={})),function(r){r.Dataflow="Dataflow",r.Project="Project"}(Be||(Be={})),function(r){r.Definition="Definition",r.Instance="Instance"}(Ee||(Ee={})),function(r){r.DataSourceTemplateKind="DataSourceTemplateKind"}(pe||(pe={})),function(r){r.DataSourceTemplateKind="DataSourceTemplateKind",r.Navigation="Navigation"}(R||(R={})),function(r){r.Busy="Busy",r.Error="Error",r.Ready="Ready",r.Unknown="Unknown"}(Fe||(Fe={}));var Xt,sn,De=m(90341);function W(r){throw new Error("Unexpected value: "+r)}function ee(r){switch(r.kind){case e.BrowseMashup:case e.ConnectToDataSource:case e.DataPreview:case e.DiagramView:case e.EditConnection:case e.EditCubeVariables:case e.EditDataflowComputeEngineSettings:case e.EditQuickCreate:case e.ImportMashupTemplate:case e.IncrementalRefreshSettings:case e.ManageConnections:case e.ManageDataflowComputeEngine:case e.Navigate:case e.QuickCreate:case e.RefreshSettings:case e.ShowRefreshHistory:return!0;case e.AddQueries:case e.CreateConnection:case e.EditQuery:case e.ResolveResourceChallenge:return!r.keepFlowRunningOnCommit;default:W(r)}}function ae(r){switch(r.kind){case e.AddQueries:case e.BrowseMashup:case e.ConnectToDataSource:case e.CreateConnection:case e.DataPreview:case e.DiagramView:case e.EditConnection:case e.EditCubeVariables:case e.EditDataflowComputeEngineSettings:case e.EditQuery:case e.EditQuickCreate:case e.ImportMashupTemplate:case e.IncrementalRefreshSettings:case e.ManageConnections:case e.ManageDataflowComputeEngine:case e.Navigate:case e.QuickCreate:case e.RefreshSettings:case e.ShowRefreshHistory:return!0;case e.ResolveResourceChallenge:return!r.keepFlowRunningOnCancel;default:W(r)}}function V(r,d){return r.kind===d.kind}function fn(r){Tt(r)}function Tt(r,d){if(null==r)throw new Error(d?d():"Value should be defined");return r}!function(r){r.ClientInstanceId="clientInstanceId",r.ProtocolId="protocolId"}(Xt||(Xt={})),function(r){r.DataAutomationId="data-automation-id",r.DataIsAutoFocusable="data-is-autofocusable",r.DataIsFocusable="data-is-focusable"}(sn||(sn={}));var _e,S,f,E,x,U,le,Pe,qe,St,Et,at,Lt,en,on,An,er,ke=function(){function r(g,v,I){this.iFrameElement=document.createElement("iframe"),this.iFrameElementOriginalDisplayValue=this.iFrameElement.style.display,this.iFrameElement.src=g,this.iFrameElement.title="Power Query",this.iFrameElement.allow="clipboard-read; clipboard-write",this.iFrameElement.setAttribute(sn.DataIsFocusable,"true"),fn(v),this.container=v,I&&(this.iFrameElement.className=I),this.hide(),this.container.appendChild(this.iFrameElement),this.isDisposed=!1}var d=r.prototype;return d.addEventListener=function(v,I,X){this.isDisposed||(fn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.addEventListener(v,I,X))},d.removeEventListener=function(v,I,X){this.isDisposed||(fn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.removeEventListener(v,I,X))},d.postMessage=function(v,I,X){this.isDisposed||(fn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.postMessage(v,I,X))},d.hide=function(){if(!this.isDisposed){var v=this.iFrameElement.style.display;"none"!==v&&(this.iFrameElementOriginalDisplayValue=v,this.iFrameElement.style.display="none")}},d.show=function(){this.isDisposed||(this.iFrameElement.style.display=this.iFrameElementOriginalDisplayValue)},d.dispose=function(){this.container.removeChild(this.iFrameElement),this.isDisposed=!0},r}();!function(r){r.GetEntityQueryScript="browseMashupCallbacks.getEntityQueryScript"}(_e||(_e={})),function(r){r.GetInitialComputeEngineSettings="computeEngineCallbacks.getInitialComputeEngineSettings"}(S||(S={})),function(r){r.OnStateChanged="createConnectionFlowClientCallbacks.onStateChanged"}(f||(f={})),function(r){r.OnSampleDataItemClick="dataDiscoveryFormCallbacks.onSampleDataItemClick"}(E||(E={})),function(r){r.OnEvaluationEnded="dataPreview.onEvaluationEnded",r.OnEvaluationStarted="dataPreview.onEvaluationStarted",r.OnQueryScriptChange="dataPreview.onQueryScriptChange",r.OnTableSelectionChanged="dataPreview.onTableSelectionChanged"}(x||(x={})),function(r){r.OnControlStateChanged="flowControlRpcMethodNames.onControlStateChanged"}(U||(U={})),function(r){r.OnCommandExecuted="hostCommandsCallbacks.onCommandExecuted"}(le||(le={})),function(r){r.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",r.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(Pe||(Pe={})),function(r){r.OnUnlinkConnection="manageConnectionsFlowCallbacks.onUnlinkConnection"}(qe||(qe={})),function(r){r.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",r.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",r.GetEntities="mappingEditorCallbacks.getEntities",r.GetEntityFields="mappingEditorCallbacks.getEntityFields",r.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",r.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(St||(St={})),function(r){r.GetEntityTypeFields="mappingCallbacks.getEntityTypeFields",r.GetEntityTypes="mappingCallbacks.getEntityTypes"}(Et||(Et={})),function(r){r.GetEntityDefinitionFromEntityPath="mappingCallbacksV2.getEntityDefinitionFromEntityPath",r.GetManifestDefinitionFromManifestPath="mappingCallbacksV2.getManifestDefinitionFromManifestPath",r.GetRootManifestDefinition="mappingCallbacksV2.getRootManifestDefinition"}(at||(at={})),function(r){r.GetMashupSensitivityLabel="mashupEditorClientCallbacks.getMashupSensitivityLabel",r.OnComputeEngineSettingsChanged="mashupEditorClientCallbacks.onComputeEngineSettingsChanged",r.OnEditingSessionMashupChanged="mashupEditorClientCallbacks.onEditingSessionMashupChanged",r.OnEditingSessionMashupInitialized="mashupEditorClientCallbacks.onEditingSessionMashupInitialized",r.OnMashupEditorClick="mashupEditorClientCallbacks.onMashupEditorClick",r.RenameMashup="mashupEditorClientCallbacks.renameMashup"}(Lt||(Lt={})),function(r){r.OnNewSqlQueryButtonClicked="powerBIDataMart.onNewSqlQueryButtonClicked",r.OnNewVisualQueryButtonClicked="powerBIDataMart.onNewVisualQueryButtonClicked",r.OnSaveAsViewButtonClicked="powerBIDataMart.onSaveAsViewButtonClicked",r.OnViewSqlButtonClicked="powerBIDataMart.onViewSqlButtonClicked",r.OnVisualizeResultButtonClicked="powerBIDataMart.onVisualizeResultButtonClicked"}(en||(en={})),function(r){r.OnDownloadExcelFileButtonClick="queryEditorPreviewButtonsCallbacks.onDownloadExcelFileButtonClick",r.OnSaveAsTableButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsTableButtonClick",r.OnSaveAsViewButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsViewButtonClick",r.OnVisualizeResultsButtonClick="queryEditorPreviewButtonsCallbacks.onVisualizeResultsButtonClick"}(on||(on={})),function(r){r.OnCommandBarPopupButtonClick="queryEditorCallbacks.onCommandBarPopupButtonClick",r.OnDiagramViewCommandBarPopupButtonClick="queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick",r.OnOpenInExcelButtonClick="queryEditorCallbacks.onOpenInExcelButtonClick",r.ValidateQuery="queryEditorCallbacks.validateQuery",r.ValidateQueryNameInteractive="queryEditorCallbacks.validateQueryNameInteractive"}(An||(An={})),function(r){r.GetUserSettings="userSettings.getUserSettings",r.SetUserSettings="userSettings.setUserSettings"}(er||(er={}));var T,Ft=function(){function r(g,v,I,X,Oe){this.clientRpcChannel=g,this.clientRpcEndpointHost=v,this.client=I,this.configuration=X,this.clientStartTime=Oe,this.registerRpcMethods()}var d=r.prototype;return d.dispose=function(){this.unregisterRpcMethods()},d.registerRpcMethods=function(){var I,X,Oe,wt,ht,ut,Ot,it,_n,bn,Un,Zt,Ht,Tn,kn,un,Kn,qn,xn,gn,nr,Vn,Nn,Hn,hr,Fn,Xn,Zn,re,H,Z,Ce,xe,we,mt,At,Gt,dn,an,pn,qa,Wa,la,ja,$a,Qa,Ka,Xa,ca,v=this;this.register("acquireToken",function(tn){return v.configuration.acquireToken(tn)}),this.register("getClientStartTime",function(){return v.clientStartTime}),this.register("getSettings",function(){return v.configuration.editorSettings}),this.register("getVersion",function(){return"22.28.0"}),this.register("hasMappingCallbacks",function(){return null!=v.configuration.mappingCallbacks}),this.register("hasMappingCallbacksV2",function(){return null!=v.configuration.mappingCallbacksV2}),this.register("onAppReady",function(){return v.clientRpcEndpointHost.onAppReady()}),this.register("onCancel",function(){return v.clientRpcEndpointHost.onCancelCurrentFlow()}),this.register("onCommit",function(){}),this.register("onCommit2",function(tn){return v.clientRpcEndpointHost.onCommitCurrentFlow(tn)}),this.register("onFlowReady",function(){return v.clientRpcEndpointHost.onCurrentFlowReady()}),!(null===(I=this.configuration.browseMashupCallbacks)||void 0===I)&&I.getEntityQueryScript&&this.register(_e.GetEntityQueryScript,this.configuration.browseMashupCallbacks.getEntityQueryScript),!(null===(X=this.configuration.computeEngineCallbacks)||void 0===X)&&X.getInitialComputeEngineSettings&&this.register(S.GetInitialComputeEngineSettings,this.configuration.computeEngineCallbacks.getInitialComputeEngineSettings),!(null===(Oe=this.configuration.createConnectionFlowClientCallbacks)||void 0===Oe)&&Oe.onStateChanged&&this.register(f.OnStateChanged,this.configuration.createConnectionFlowClientCallbacks.onStateChanged),!(null===(wt=this.configuration.dataPreviewCallbacks)||void 0===wt)&&wt.onEvaluationEnded&&this.register(x.OnEvaluationEnded,this.configuration.dataPreviewCallbacks.onEvaluationEnded),!(null===(ht=this.configuration.dataPreviewCallbacks)||void 0===ht)&&ht.onEvaluationStarted&&this.register(x.OnEvaluationStarted,this.configuration.dataPreviewCallbacks.onEvaluationStarted),!(null===(ut=this.configuration.dataPreviewCallbacks)||void 0===ut)&&ut.onQueryScriptChange&&this.register(x.OnQueryScriptChange,this.configuration.dataPreviewCallbacks.onQueryScriptChange),!(null===(Ot=this.configuration.dataPreviewCallbacks)||void 0===Ot)&&Ot.onTableSelectionChanged&&this.register(x.OnTableSelectionChanged,this.configuration.dataPreviewCallbacks.onTableSelectionChanged),!(null===(it=this.configuration.flowControlCallbacks)||void 0===it)&&it.onControlStateChanged&&this.register(U.OnControlStateChanged,function(){var tn;return null===(tn=v.configuration.flowControlCallbacks)||void 0===tn?void 0:tn.onControlStateChanged(v.client)}),!(null===(_n=this.configuration.hostPopupsCallbacks)||void 0===_n)&&_n.getLoginSuccessRedirectUri&&this.register(Pe.GetLoginSuccessRedirectUri,this.configuration.hostPopupsCallbacks.getLoginSuccessRedirectUri),!(null===(bn=this.configuration.hostPopupsCallbacks)||void 0===bn)&&bn.openHostPopup&&this.register(Pe.OpenHostPopup,this.configuration.hostPopupsCallbacks.openHostPopup),!(null===(Un=this.configuration.hostCommandsCallbacks)||void 0===Un)&&Un.onCommandExecuted&&this.register(le.OnCommandExecuted,this.configuration.hostCommandsCallbacks.onCommandExecuted),!(null===(Zt=this.configuration.manageConnectionsFlowCallbacks)||void 0===Zt)&&Zt.onUnlinkConnection&&this.register(qe.OnUnlinkConnection,this.configuration.manageConnectionsFlowCallbacks.onUnlinkConnection),!(null===(Ht=this.configuration.mappingEditorCallbacks)||void 0===Ht)&&Ht.generateNewEntityFieldNames&&this.register(St.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(Tn=this.configuration.mappingEditorCallbacks)||void 0===Tn)&&Tn.generateNewEntityNames&&this.register(St.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(kn=this.configuration.mappingEditorCallbacks)||void 0===kn)&&kn.getEntities&&this.register(St.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===(un=this.configuration.mappingEditorCallbacks)||void 0===un)&&un.getEntityFields&&this.register(St.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(Kn=this.configuration.mappingEditorCallbacks)||void 0===Kn)&&Kn.getEntityKeys&&this.register(St.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(qn=this.configuration.mappingEditorCallbacks)||void 0===qn)&&qn.validateMappingEditorResult&&this.register(St.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(xn=this.configuration.mappingCallbacks)||void 0===xn)&&xn.getEntityTypeFields&&this.register(Et.GetEntityTypeFields,this.configuration.mappingCallbacks.getEntityTypeFields),!(null===(gn=this.configuration.mappingCallbacks)||void 0===gn)&&gn.getEntityTypes&&this.register(Et.GetEntityTypes,null===(nr=this.configuration.mappingCallbacks)||void 0===nr?void 0:nr.getEntityTypes),!(null===(Vn=this.configuration.mappingCallbacksV2)||void 0===Vn)&&Vn.getEntityDefinitionFromEntityPath&&this.register(at.GetEntityDefinitionFromEntityPath,this.configuration.mappingCallbacksV2.getEntityDefinitionFromEntityPath),!(null===(Nn=this.configuration.mappingCallbacksV2)||void 0===Nn)&&Nn.getManifestDefinitionFromManifestPath&&this.register(at.GetManifestDefinitionFromManifestPath,this.configuration.mappingCallbacksV2.getManifestDefinitionFromManifestPath),!(null===(Hn=this.configuration.mappingCallbacksV2)||void 0===Hn)&&Hn.getRootManifestDefinition&&this.register(at.GetRootManifestDefinition,null===(hr=this.configuration.mappingCallbacksV2)||void 0===hr?void 0:hr.getRootManifestDefinition),!(null===(Fn=this.configuration.mashupEditorClientCallbacks)||void 0===Fn)&&Fn.getMashupSensitivityLabel&&this.register(Lt.GetMashupSensitivityLabel,this.configuration.mashupEditorClientCallbacks.getMashupSensitivityLabel),!(null===(Xn=this.configuration.mashupEditorClientCallbacks)||void 0===Xn)&&Xn.onComputeEngineSettingsChanged&&this.register(Lt.OnComputeEngineSettingsChanged,this.configuration.mashupEditorClientCallbacks.onComputeEngineSettingsChanged),!(null===(Zn=this.configuration.mashupEditorClientCallbacks)||void 0===Zn)&&Zn.onEditingSessionMashupChanged&&this.register(Lt.OnEditingSessionMashupChanged,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupChanged),!(null===(re=this.configuration.mashupEditorClientCallbacks)||void 0===re)&&re.onEditingSessionMashupInitialized&&this.register(Lt.OnEditingSessionMashupInitialized,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupInitialized),!(null===(H=this.configuration.mashupEditorClientCallbacks)||void 0===H)&&H.onMashupEditorClick&&this.register(Lt.OnMashupEditorClick,null===(Z=this.configuration.mashupEditorClientCallbacks)||void 0===Z?void 0:Z.onMashupEditorClick),!(null===(Ce=this.configuration.mashupEditorClientCallbacks)||void 0===Ce)&&Ce.renameMashup&&this.register(Lt.RenameMashup,this.configuration.mashupEditorClientCallbacks.renameMashup),!(null===(xe=this.configuration.powerBIDataMartCallbacks)||void 0===xe)&&xe.onNewSqlQueryButtonClicked&&this.register(en.OnNewSqlQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewSqlQueryButtonClicked),!(null===(we=this.configuration.powerBIDataMartCallbacks)||void 0===we)&&we.onNewVisualQueryButtonClicked&&this.register(en.OnNewVisualQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewVisualQueryButtonClicked),!(null===(mt=this.configuration.powerBIDataMartCallbacks)||void 0===mt)&&mt.onSaveAsViewButtonClicked&&this.register(en.OnSaveAsViewButtonClicked,this.configuration.powerBIDataMartCallbacks.onSaveAsViewButtonClicked),!(null===(At=this.configuration.powerBIDataMartCallbacks)||void 0===At)&&At.onViewSqlButtonClicked&&this.register(en.OnViewSqlButtonClicked,this.configuration.powerBIDataMartCallbacks.onViewSqlButtonClicked),!(null===(Gt=this.configuration.powerBIDataMartCallbacks)||void 0===Gt)&&Gt.onVisualizeResultButtonClicked&&this.register(en.OnVisualizeResultButtonClicked,this.configuration.powerBIDataMartCallbacks.onVisualizeResultButtonClicked),!(null===(dn=this.configuration.queryEditorCallbacks)||void 0===dn)&&dn.onCommandBarPopupButtonClick&&this.register(An.OnCommandBarPopupButtonClick,function(){var tn;return Tt(null===(tn=v.configuration.queryEditorCallbacks)||void 0===tn?void 0:tn.onCommandBarPopupButtonClick)(v.client)}),!(null===(an=this.configuration.queryEditorCallbacks)||void 0===an)&&an.onDiagramViewCommandBarPopupButtonClick&&this.register(An.OnDiagramViewCommandBarPopupButtonClick,function(){var tn;return Tt(null===(tn=v.configuration.queryEditorCallbacks)||void 0===tn?void 0:tn.onDiagramViewCommandBarPopupButtonClick)(v.client)}),!(null===(pn=this.configuration.queryEditorCallbacks)||void 0===pn)&&pn.onOpenInExcelButtonClick&&this.register(An.OnOpenInExcelButtonClick,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorCallbacks)||void 0===rn?void 0:rn.onOpenInExcelButtonClick)(v.client,tn)}),!(null===(qa=this.configuration.queryEditorCallbacks)||void 0===qa)&&qa.validateQuery&&this.register(An.ValidateQuery,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorCallbacks)||void 0===rn?void 0:rn.validateQuery)(v.client,tn)}),!(null===(Wa=this.configuration.queryEditorCallbacks)||void 0===Wa)&&Wa.validateQueryNameInteractive&&this.register(An.ValidateQueryNameInteractive,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorCallbacks)||void 0===rn?void 0:rn.validateQueryNameInteractive)(v.client,tn)}),!(null===(la=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===la)&&la.onDownloadExcelFileButtonClick&&this.register(on.OnDownloadExcelFileButtonClick,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorPreviewButtonsCallbacks)||void 0===rn?void 0:rn.onDownloadExcelFileButtonClick)(tn)}),!(null===(ja=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===ja)&&ja.onSaveAsTableButtonClick&&this.register(on.OnSaveAsTableButtonClick,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorPreviewButtonsCallbacks)||void 0===rn?void 0:rn.onSaveAsTableButtonClick)(tn)}),!(null===($a=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===$a)&&$a.onSaveAsViewButtonClick&&this.register(on.OnSaveAsViewButtonClick,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorPreviewButtonsCallbacks)||void 0===rn?void 0:rn.onSaveAsViewButtonClick)(tn)}),!(null===(Qa=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Qa)&&Qa.onVisualizeResultsButtonClick&&this.register(on.OnVisualizeResultsButtonClick,function(tn){var rn;return Tt(null===(rn=v.configuration.queryEditorPreviewButtonsCallbacks)||void 0===rn?void 0:rn.onVisualizeResultsButtonClick)(tn)}),!(null===(Ka=this.configuration.userSettingsStorageCallbacks)||void 0===Ka)&&Ka.getUserSettings&&this.register(er.GetUserSettings,this.configuration.userSettingsStorageCallbacks.getUserSettings),!(null===(Xa=this.configuration.userSettingsStorageCallbacks)||void 0===Xa)&&Xa.setUserSettings&&this.register(er.SetUserSettings,this.configuration.userSettingsStorageCallbacks.setUserSettings),null!==(ca=this.configuration.dataDiscoveryFormCallbacks)&&void 0!==ca&&ca.onSampleDataItemClick&&this.register(E.OnSampleDataItemClick,function(tn){var rn;return Tt(null===(rn=v.configuration.dataDiscoveryFormCallbacks)||void 0===rn?void 0:rn.onSampleDataItemClick)(tn)})},d.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("getClientStartTime"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onAppReady"),this.unregister("onCancel"),this.unregister("onCommit"),this.unregister("onFlowReady"),this.unregister(_e.GetEntityQueryScript),this.unregister(S.GetInitialComputeEngineSettings),this.unregister(f.OnStateChanged),this.unregister(x.OnEvaluationEnded),this.unregister(x.OnEvaluationStarted),this.unregister(x.OnQueryScriptChange),this.unregister(x.OnTableSelectionChanged),this.unregister(Pe.GetLoginSuccessRedirectUri),this.unregister(Pe.OpenHostPopup),this.unregister(le.OnCommandExecuted),this.unregister(qe.OnUnlinkConnection),this.unregister(St.GenerateNewEntityFieldNames),this.unregister(St.GenerateNewEntityNames),this.unregister(St.GetEntities),this.unregister(St.GetEntityFields),this.unregister(St.GetEntityKeys),this.unregister(St.ValidateMappingEditorResult),this.unregister(Et.GetEntityTypeFields),this.unregister(Et.GetEntityTypes),this.unregister(at.GetEntityDefinitionFromEntityPath),this.unregister(at.GetManifestDefinitionFromManifestPath),this.unregister(at.GetRootManifestDefinition),this.unregister(Lt.GetMashupSensitivityLabel),this.unregister(Lt.OnComputeEngineSettingsChanged),this.unregister(Lt.OnEditingSessionMashupChanged),this.unregister(Lt.OnEditingSessionMashupInitialized),this.unregister(Lt.OnMashupEditorClick),this.unregister(Lt.RenameMashup),this.unregister(en.OnNewSqlQueryButtonClicked),this.unregister(en.OnNewVisualQueryButtonClicked),this.unregister(en.OnSaveAsViewButtonClicked),this.unregister(en.OnViewSqlButtonClicked),this.unregister(en.OnVisualizeResultButtonClicked),this.unregister(An.OnCommandBarPopupButtonClick),this.unregister(An.OnDiagramViewCommandBarPopupButtonClick),this.unregister(An.OnOpenInExcelButtonClick),this.unregister(An.ValidateQuery),this.unregister(An.ValidateQueryNameInteractive),this.unregister(on.OnDownloadExcelFileButtonClick),this.unregister(on.OnSaveAsTableButtonClick),this.unregister(on.OnSaveAsViewButtonClick),this.unregister(on.OnVisualizeResultsButtonClick),this.unregister(er.GetUserSettings),this.unregister(er.SetUserSettings),this.unregister(E.OnSampleDataItemClick)},d.register=function(v,I){this.clientRpcChannel.register(v,I)},d.unregister=function(v){this.clientRpcChannel.unregister(v)},r}();!function(r){r.ActivateQuery="activateQuery",r.AddQuery="addQuery",r.CancelAddQueriesFlow="cancelAddQueriesFlow",r.ClickCancelButton="clickCancelButton",r.ClickCommitButton="clickCommitButton",r.ClickCustomButton="clickCustomButton",r.ClickNextStageButton="clickNextStageButton",r.ClickPreviousStageButton="clickPreviousStageButton",r.CreateConnectionFlow_Commit="createConnectionFlow_commit",r.DataPreview_CancelCurrentQueryEvaluation="dataPreview_cancelCurrentQueryEvaluation",r.DataPreview_SelectColumns="dataPreview_selectColumns",r.DeleteAllQueries="deleteAllQueries",r.DisposeService="disposeService",r.EndFlow="endFlow",r.GetActiveQueryName="getActiveQueryName",r.GetCancelButtonLabel="getCancelButtonLabel",r.GetCommitButtonLabel="getCommitButtonLabel",r.GetCommitResult="getCommitResult",r.GetComputeEngineSettings="getComputeEngineSettings",r.GetCurrentFlow="getCurrentFlow",r.GetCustomButtonLabel="getCustomButtonLabel",r.GetDataSourceQueryScript="getDataSourceQueryScript",r.GetDataWizardFooter_ClickCancelButton="getDataWizardFooter_clickCancelButton",r.GetDataWizardFooter_ClickCommitButton="getDataWizardFooter_clickCommitButton",r.GetDataWizardFooter_ClickCustomButton="getDataWizardFooter_clickCustomButton",r.GetDataWizardFooter_ClickNextStageButton="getDataWizardFooter_clickNextStageButton",r.GetDataWizardFooter_ClickPreviousStageButton="getDataWizardFooter_clickPreviousStageButton",r.GetEditingSessionId="getEditingSessionId",r.GetEditingSessionMashup="getEditingSessionMashup",r.GetFooterMessage="getFooterMessage",r.GetGetDataWizardFlowStage="getGetDataWizardFlowStage",r.GetIncrementalRefreshSettings="getIncrementalRefreshSettings",r.GetMashupGatewayVersion="getMashupGatewayVersion",r.GetNextStageButtonLabel="getNextStageButtonLabel",r.GetPreviousStageButtonLabel="getPreviousStageButtonLabel",r.GetQueriesInfo="getQueriesInfo",r.GetQueryEditorState="getQueryEditorState",r.GetQueryEditorStateOrThrow="getQueryEditorStateOrThrow",r.GetQueryNames="getQueryNames",r.GetQueryScript="getQueryScript",r.GetReadyState="getReadyState",r.GetRefreshSettings="getRefreshSettings",r.GetSelectedStepName="getSelectedStepName",r.GetUserSettings="getUserSettings",r.IsCancelButtonEnabled="isCancelButtonEnabled",r.IsCancelButtonVisible="isCancelButtonVisible",r.IsCommitButtonEnabled="isCommitButtonEnabled",r.IsCommitButtonVisible="isCommitButtonVisible",r.IsCustomButtonEnabled="isCustomButtonEnabled",r.IsCustomButtonVisible="isCustomButtonVisible",r.IsDialogVisible="isDialogVisible",r.IsFeatureSupported="isFeatureSupported",r.IsFooterOverlayVisible="isFooterOverlayVisible",r.IsNextStageButtonEnabled="isNextStageButtonEnabled",r.IsNextStageButtonVisible="isNextStageButtonVisible",r.IsPreviousStageButtonEnabled="isPreviousStageButtonEnabled",r.IsPreviousStageButtonVisible="isPreviousStageButtonVisible",r.LogXFramePerformanceMarks="logXFramePerformanceMarks",r.OnHostPopupCancelled="onHostPopupCancelled",r.RefreshActiveQueryResult="refreshActiveQueryResult",r.SetCommitButtonEnabledStatePolicy="setCommitButtonEnabledStatePolicy",r.SetUserSettings="setUserSettings",r.StartFlow="startFlow",r.TrySetQueryScript="trySetQueryScript"}(T||(T={}));var Za=function(){function r(g){this.clientRpcChannel=g}var d=r.prototype;return d.activateQuery=function(v){return this.clientRpcChannel.call(T.ActivateQuery,[v])},d.addQuery=function(v,I,X){return this.clientRpcChannel.call(T.AddQuery,[v,I,X])},d.endFlow=function(){return this.clientRpcChannel.callIfSupported(T.EndFlow)},d.cancelAddQueriesFlow=function(){return this.clientRpcChannel.call(T.CancelAddQueriesFlow)},d.clickCancelButton=function(){return this.clientRpcChannel.call(T.ClickCancelButton)},d.clickCommitButton=function(){return this.clientRpcChannel.call(T.ClickCommitButton)},d.clickCustomButton=function(){return this.clientRpcChannel.call(T.ClickCustomButton)},d.clickNextStageButton=function(){return this.clientRpcChannel.call(T.ClickNextStageButton)},d.clickPreviousStageButton=function(){return this.clientRpcChannel.call(T.ClickPreviousStageButton)},d.createConnectionFlow_commit=function(v){return this.clientRpcChannel.call(T.CreateConnectionFlow_Commit,[v])},d.dataPreview_cancelCurrentQueryEvaluation=function(){return this.clientRpcChannel.call(T.DataPreview_CancelCurrentQueryEvaluation)},d.dataPreview_selectColumns=function(v){return this.clientRpcChannel.callIfSupported(T.DataPreview_SelectColumns,[v])},d.deleteAllQueries=function(){return this.clientRpcChannel.callIfSupported(T.DeleteAllQueries)},d.disposeService=function(){return this.clientRpcChannel.callIfSupported(T.DisposeService)},d.getActiveQueryName=function(){return this.clientRpcChannel.call(T.GetActiveQueryName)},d.getCancelButtonLabel=function(){return this.clientRpcChannel.call(T.GetCancelButtonLabel)},d.getCommitButtonLabel=function(){return this.clientRpcChannel.call(T.GetCommitButtonLabel)},d.getCustomButtonLabel=function(){return this.clientRpcChannel.call(T.GetCustomButtonLabel)},d.getCommitResult=function(){return this.clientRpcChannel.call(T.GetCommitResult)},d.getComputeEngineSettings=function(){return this.clientRpcChannel.call(T.GetComputeEngineSettings)},d.getCurrentFlow=function(){return this.clientRpcChannel.callIfSupported(T.GetCurrentFlow)},d.getDataSourceQueryScript=function(v,I){return this.clientRpcChannel.call(T.GetDataSourceQueryScript,[v,I])},d.getDataWizardFooter_clickCancelButton=function(){return this.clientRpcChannel.call(T.GetDataWizardFooter_ClickCancelButton)},d.getDataWizardFooter_clickCommitButton=function(){return this.clientRpcChannel.call(T.GetDataWizardFooter_ClickCommitButton)},d.getDataWizardFooter_clickCustomButton=function(){return this.clientRpcChannel.call(T.GetDataWizardFooter_ClickCustomButton)},d.getDataWizardFooter_clickNextStageButton=function(){return this.clientRpcChannel.call(T.GetDataWizardFooter_ClickNextStageButton)},d.getDataWizardFooter_clickPreviousStageButton=function(){return this.clientRpcChannel.call(T.GetDataWizardFooter_ClickPreviousStageButton)},d.getEditingSessionId=function(){return this.clientRpcChannel.call(T.GetEditingSessionId)},d.getEditingSessionMashup=function(v){return this.clientRpcChannel.call(T.GetEditingSessionMashup,[v])},d.getFooterMessage=function(){return this.clientRpcChannel.call(T.GetFooterMessage)},d.getGetDataWizardFlowStage=function(){return this.clientRpcChannel.callIfSupported(T.GetGetDataWizardFlowStage)},d.getIncrementalRefreshSettings=function(){return this.clientRpcChannel.call(T.GetIncrementalRefreshSettings)},d.getMashupGatewayVersion=function(){return this.clientRpcChannel.call(T.GetMashupGatewayVersion)},d.getNextStageButtonLabel=function(){return this.clientRpcChannel.call(T.GetNextStageButtonLabel)},d.getPreviousStageButtonLabel=function(){return this.clientRpcChannel.call(T.GetPreviousStageButtonLabel)},d.getQueriesInfo=function(){return this.clientRpcChannel.call(T.GetQueriesInfo)},d.getQueryEditorState=function(){return this.clientRpcChannel.call(T.GetQueryEditorState)},d.getQueryEditorStateOrThrow=function(){return this.clientRpcChannel.call(T.GetQueryEditorStateOrThrow)},d.getQueryNames=function(){return this.clientRpcChannel.call(T.GetQueryNames)},d.getQueryScript=function(v){return this.clientRpcChannel.call(T.GetQueryScript,[v])},d.getReadyState=function(){return this.clientRpcChannel.call(T.GetReadyState)},d.getRefreshSettings=function(){return this.clientRpcChannel.callIfSupported(T.GetRefreshSettings)},d.getSelectedStepName=function(){return this.clientRpcChannel.call(T.GetSelectedStepName)},d.getUserSettings=function(){return this.clientRpcChannel.call(T.GetUserSettings)},d.isCancelButtonEnabled=function(){return this.clientRpcChannel.call(T.IsCancelButtonEnabled)},d.isCancelButtonVisible=function(){return this.clientRpcChannel.call(T.IsCancelButtonVisible)},d.isCommitButtonEnabled=function(){return this.clientRpcChannel.call(T.IsCommitButtonEnabled)},d.isCommitButtonVisible=function(){return this.clientRpcChannel.call(T.IsCommitButtonVisible)},d.isCustomButtonEnabled=function(){return this.clientRpcChannel.call(T.IsCustomButtonEnabled)},d.isCustomButtonVisible=function(){return this.clientRpcChannel.call(T.IsCustomButtonVisible)},d.isDialogVisible=function(){return this.clientRpcChannel.call(T.IsDialogVisible)},d.isFeatureSupported=function(v){return this.clientRpcChannel.call(T.IsFeatureSupported,[v])},d.isFooterOverlayVisible=function(){return this.clientRpcChannel.call(T.IsFooterOverlayVisible)},d.isNextStageButtonEnabled=function(){return this.clientRpcChannel.call(T.IsNextStageButtonEnabled)},d.isNextStageButtonVisible=function(){return this.clientRpcChannel.call(T.IsNextStageButtonVisible)},d.isPreviousStageButtonEnabled=function(){return this.clientRpcChannel.call(T.IsPreviousStageButtonEnabled)},d.isPreviousStageButtonVisible=function(){return this.clientRpcChannel.call(T.IsPreviousStageButtonVisible)},d.logXFramePerformanceMarks=function(v){return this.clientRpcChannel.call(T.LogXFramePerformanceMarks,[v])},d.onHostPopupCancelled=function(v){return this.clientRpcChannel.callIfSupported(T.OnHostPopupCancelled,[v])},d.refreshActiveQueryResult=function(){return this.clientRpcChannel.callIfSupported(T.RefreshActiveQueryResult)},d.setCommitButtonEnabledStatePolicy=function(v){return this.clientRpcChannel.call(T.SetCommitButtonEnabledStatePolicy,[v])},d.setUserSettings=function(v){return this.clientRpcChannel.callIfSupported(T.SetUserSettings,[v])},d.startFlow=function(v,I){return this.clientRpcChannel.callIfSupported(T.StartFlow,[v,I])},d.trySetQueryScript=function(v,I){return this.clientRpcChannel.call(T.TrySetQueryScript,[v,I])},r}(),da=m(37419),Ri=function(){function r(){var g=this;this.resolveMethod=function(v){},this.rejectMethod=function(v){},this.promise=new Promise(function(v,I){g.resolveMethod=v,g.rejectMethod=I})}r.createResolvedDeferred=function(){var v=new r;return v.resolve(),v};var d=r.prototype;return d.resolve=function(v){this.resolveMethod(v)},d.reject=function(v){this.rejectMethod(v)},r}(),pa=m(11105);function bo(){return pa.Z()}function Jr(){Jr=function(){return d};var r,d={},g=Object.prototype,v=g.hasOwnProperty,I=Object.defineProperty||function(re,H,Z){re[H]=Z.value},X="function"==typeof Symbol?Symbol:{},Oe=X.iterator||"@@iterator",wt=X.asyncIterator||"@@asyncIterator",ht=X.toStringTag||"@@toStringTag";function ut(re,H,Z){return Object.defineProperty(re,H,{value:Z,enumerable:!0,configurable:!0,writable:!0}),re[H]}try{ut({},"")}catch{ut=function(Z,Ce,xe){return Z[Ce]=xe}}function Ot(re,H,Z,Ce){var we=Object.create((H&&H.prototype instanceof Tn?H:Tn).prototype),mt=new Xn(Ce||[]);return I(we,"_invoke",{value:Nn(re,Z,mt)}),we}function it(re,H,Z){try{return{type:"normal",arg:re.call(H,Z)}}catch(Ce){return{type:"throw",arg:Ce}}}d.wrap=Ot;var _n="suspendedStart",bn="suspendedYield",Un="executing",Zt="completed",Ht={};function Tn(){}function kn(){}function un(){}var Kn={};ut(Kn,Oe,function(){return this});var qn=Object.getPrototypeOf,xn=qn&&qn(qn(Zn([])));xn&&xn!==g&&v.call(xn,Oe)&&(Kn=xn);var gn=un.prototype=Tn.prototype=Object.create(Kn);function nr(re){["next","throw","return"].forEach(function(H){ut(re,H,function(Z){return this._invoke(H,Z)})})}function Vn(re,H){function Z(xe,we,mt,At){var Gt=it(re[xe],re,we);if("throw"!==Gt.type){var dn=Gt.arg,an=dn.value;return an&&"object"==typeof an&&v.call(an,"__await")?H.resolve(an.__await).then(function(pn){Z("next",pn,mt,At)},function(pn){Z("throw",pn,mt,At)}):H.resolve(an).then(function(pn){dn.value=pn,mt(dn)},function(pn){return Z("throw",pn,mt,At)})}At(Gt.arg)}var Ce;I(this,"_invoke",{value:function(we,mt){function At(){return new H(function(Gt,dn){Z(we,mt,Gt,dn)})}return Ce=Ce?Ce.then(At,At):At()}})}function Nn(re,H,Z){var Ce=_n;return function(xe,we){if(Ce===Un)throw new Error("Generator is already running");if(Ce===Zt){if("throw"===xe)throw we;return{value:r,done:!0}}for(Z.method=xe,Z.arg=we;;){var mt=Z.delegate;if(mt){var At=Hn(mt,Z);if(At){if(At===Ht)continue;return At}}if("next"===Z.method)Z.sent=Z._sent=Z.arg;else if("throw"===Z.method){if(Ce===_n)throw Ce=Zt,Z.arg;Z.dispatchException(Z.arg)}else"return"===Z.method&&Z.abrupt("return",Z.arg);Ce=Un;var Gt=it(re,H,Z);if("normal"===Gt.type){if(Ce=Z.done?Zt:bn,Gt.arg===Ht)continue;return{value:Gt.arg,done:Z.done}}"throw"===Gt.type&&(Ce=Zt,Z.method="throw",Z.arg=Gt.arg)}}}function Hn(re,H){var Z=H.method,Ce=re.iterator[Z];if(Ce===r)return H.delegate=null,"throw"===Z&&re.iterator.return&&(H.method="return",H.arg=r,Hn(re,H),"throw"===H.method)||"return"!==Z&&(H.method="throw",H.arg=new TypeError("The iterator does not provide a '"+Z+"' method")),Ht;var xe=it(Ce,re.iterator,H.arg);if("throw"===xe.type)return H.method="throw",H.arg=xe.arg,H.delegate=null,Ht;var we=xe.arg;return we?we.done?(H[re.resultName]=we.value,H.next=re.nextLoc,"return"!==H.method&&(H.method="next",H.arg=r),H.delegate=null,Ht):we:(H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,Ht)}function hr(re){var H={tryLoc:re[0]};1 in re&&(H.catchLoc=re[1]),2 in re&&(H.finallyLoc=re[2],H.afterLoc=re[3]),this.tryEntries.push(H)}function Fn(re){var H=re.completion||{};H.type="normal",delete H.arg,re.completion=H}function Xn(re){this.tryEntries=[{tryLoc:"root"}],re.forEach(hr,this),this.reset(!0)}function Zn(re){if(re||""===re){var H=re[Oe];if(H)return H.call(re);if("function"==typeof re.next)return re;if(!isNaN(re.length)){var Z=-1,Ce=function xe(){for(;++Z<re.length;)if(v.call(re,Z))return xe.value=re[Z],xe.done=!1,xe;return xe.value=r,xe.done=!0,xe};return Ce.next=Ce}}throw new TypeError(typeof re+" is not iterable")}return kn.prototype=un,I(gn,"constructor",{value:un,configurable:!0}),I(un,"constructor",{value:kn,configurable:!0}),kn.displayName=ut(un,ht,"GeneratorFunction"),d.isGeneratorFunction=function(re){var H="function"==typeof re&&re.constructor;return!!H&&(H===kn||"GeneratorFunction"===(H.displayName||H.name))},d.mark=function(re){return Object.setPrototypeOf?Object.setPrototypeOf(re,un):(re.__proto__=un,ut(re,ht,"GeneratorFunction")),re.prototype=Object.create(gn),re},d.awrap=function(re){return{__await:re}},nr(Vn.prototype),ut(Vn.prototype,wt,function(){return this}),d.AsyncIterator=Vn,d.async=function(re,H,Z,Ce,xe){void 0===xe&&(xe=Promise);var we=new Vn(Ot(re,H,Z,Ce),xe);return d.isGeneratorFunction(H)?we:we.next().then(function(mt){return mt.done?mt.value:we.next()})},nr(gn),ut(gn,ht,"Generator"),ut(gn,Oe,function(){return this}),ut(gn,"toString",function(){return"[object Generator]"}),d.keys=function(re){var H=Object(re),Z=[];for(var Ce in H)Z.push(Ce);return Z.reverse(),function xe(){for(;Z.length;){var we=Z.pop();if(we in H)return xe.value=we,xe.done=!1,xe}return xe.done=!0,xe}},d.values=Zn,Xn.prototype={constructor:Xn,reset:function(H){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Fn),!H)for(var Z in this)"t"===Z.charAt(0)&&v.call(this,Z)&&!isNaN(+Z.slice(1))&&(this[Z]=r)},stop:function(){this.done=!0;var H=this.tryEntries[0].completion;if("throw"===H.type)throw H.arg;return this.rval},dispatchException:function(H){if(this.done)throw H;var Z=this;function Ce(dn,an){return mt.type="throw",mt.arg=H,Z.next=dn,an&&(Z.method="next",Z.arg=r),!!an}for(var xe=this.tryEntries.length-1;xe>=0;--xe){var we=this.tryEntries[xe],mt=we.completion;if("root"===we.tryLoc)return Ce("end");if(we.tryLoc<=this.prev){var At=v.call(we,"catchLoc"),Gt=v.call(we,"finallyLoc");if(At&&Gt){if(this.prev<we.catchLoc)return Ce(we.catchLoc,!0);if(this.prev<we.finallyLoc)return Ce(we.finallyLoc)}else if(At){if(this.prev<we.catchLoc)return Ce(we.catchLoc,!0)}else{if(!Gt)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return Ce(we.finallyLoc)}}}},abrupt:function(H,Z){for(var Ce=this.tryEntries.length-1;Ce>=0;--Ce){var xe=this.tryEntries[Ce];if(xe.tryLoc<=this.prev&&v.call(xe,"finallyLoc")&&this.prev<xe.finallyLoc){var we=xe;break}}we&&("break"===H||"continue"===H)&&we.tryLoc<=Z&&Z<=we.finallyLoc&&(we=null);var mt=we?we.completion:{};return mt.type=H,mt.arg=Z,we?(this.method="next",this.next=we.finallyLoc,Ht):this.complete(mt)},complete:function(H,Z){if("throw"===H.type)throw H.arg;return"break"===H.type||"continue"===H.type?this.next=H.arg:"return"===H.type?(this.rval=this.arg=H.arg,this.method="return",this.next="end"):"normal"===H.type&&Z&&(this.next=Z),Ht},finish:function(H){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var Ce=this.tryEntries[Z];if(Ce.finallyLoc===H)return this.complete(Ce.completion,Ce.afterLoc),Fn(Ce),Ht}},catch:function(H){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var Ce=this.tryEntries[Z];if(Ce.tryLoc===H){var xe=Ce.completion;if("throw"===xe.type){var we=xe.arg;Fn(Ce)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(H,Z,Ce){return this.delegate={iterator:Zn(H),resultName:Z,nextLoc:Ce},"next"===this.method&&(this.arg=r),Ht}},d}var Gi="__SUPPORTS_METHOD__",Ni=function(){function r(g){var v=this;this.onMessageReceived=function(I){I.method?v.handleRequestMessageReceived(I):v.handleResponseMessageReceived(I)},this.options=g,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(Gi,function(I){return v.handleSupportsMethodMessage(I)})}var d=r.prototype;return d.call=function(v,I){return this.internalCall(r.normalizeMethodName(v),I)},d.callIfSupported=function(v,I){return function(r,d,g,v){return new(g||(g=Promise))(function(X,Oe){function wt(Ot){try{ut(v.next(Ot))}catch(it){Oe(it)}}function ht(Ot){try{ut(v.throw(Ot))}catch(it){Oe(it)}}function ut(Ot){Ot.done?X(Ot.value):function(X){return X instanceof g?X:new g(function(Oe){Oe(X)})}(Ot.value).then(wt,ht)}ut((v=v.apply(r,d||[])).next())})}(this,void 0,void 0,Jr().mark(function X(){return Jr().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return ht.next=2,this.supportsMethod(v);case 2:if(!ht.sent){ht.next=5;break}return ht.abrupt("return",this.call(v,I));case 5:return ht.abrupt("return",void 0);case 6:case"end":return ht.stop()}},X,this)}))},d.dispose=function(){this.internalUnregister(Gi),this.requestDeferredByMessageId.forEach(function(v){return v.reject(function(r){var d=new Error("Rpc disposed");if(null!=d.stack)return d;try{throw d}catch(g){return g}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},d.register=function(v,I){var X=this,Oe=r.normalizeMethodName(v);this.internalRegister(Oe,function(){for(var wt,ht,ut=arguments.length,Ot=new Array(ut),it=0;it<ut;it++)Ot[it]=arguments[it];return null===(ht=(wt=X.options).onMethodInvoked)||void 0===ht||ht.call(wt,v,Ot),I.apply(void 0,Ot)})},d.supportsMethod=function(v){return this.internalCall(Gi,[v])},d.unregister=function(v){var I=r.normalizeMethodName(v);this.internalUnregister(I)},d.canPostMessage=function(v){return this.ready},d.internalCall=function(v,I){void 0===I&&(I=void 0);var X=bo(),Oe={id:X,method:v,params:I},wt=new Ri;return this.requestDeferredByMessageId.set(X,wt),this.canPostMessage(Oe)?this.tryPostMessage(Oe):this.queuedRequestMessages.push(Oe),wt.promise},d.internalRegister=function(v,I){if(this.methodCallbackMap.has(v))throw new Error("Rpc method with name '"+v+"' already registered.");this.methodCallbackMap.set(v,I)},d.internalUnregister=function(v){this.methodCallbackMap.delete(v)},d.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},r.getResponseMessageError=function(v){return v instanceof Error?{message:v.message,name:v.name,stack:v.stack}:v},r.normalizeMethodName=function(v){return v.toUpperCase()},d.flushRequestMessageQueue=function(){var v=this;this.queuedRequestMessages.forEach(function(I){return v.tryPostMessage(I)}),this.queuedRequestMessages=[]},d.handleRequestMessageReceived=function(v){var I=this,X=this.methodCallbackMap.get(v.method);if(X){var Oe={signature:v.signature,id:v.id};try{var wt=X.apply(this,v.params);Promise.resolve(wt).then(function(ht){Oe.result=ht,I.postMessage(Oe)}).catch(function(ht){Oe.error=r.getResponseMessageError(ht),I.postMessage(Oe)})}catch(ht){Oe.error=r.getResponseMessageError(ht),this.postMessage(Oe)}}},d.handleResponseMessageReceived=function(v){var I=v.id,X=this.requestDeferredByMessageId.get(I);X&&(v.error?X.reject(v.error):X.resolve(v.result),this.requestDeferredByMessageId.delete(I))},d.handleSupportsMethodMessage=function(v){return this.methodCallbackMap.has(r.normalizeMethodName(v))},d.postMessage=function(v){this.options.rpcWindow.postMessage(v)},d.tryPostMessage=function(v){try{this.postMessage(v)}catch(Oe){if(Oe instanceof Error){var I=v.id,X=this.requestDeferredByMessageId.get(I);X&&(X.reject(Oe),this.requestDeferredByMessageId.delete(I))}}},(0,De.Z)(r,[{key:"rpcHandshakeHandler",get:function(){return this.options.rpcHandshakeHandler}}]),r}(),Hi=function(r){function d(v){var I;return(I=r.call(this,v)||this).clientOptions=v,I.internalRegister(v.rpcHandshakeHandler.getReadyMessageMethod(),function(){return I.handleReadyMessage()}),I}return(0,da.Z)(d,r),d.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},d}(Ni);function jr(r,d,g){var v;return r&&Cr(r)&&r.hasOwnProperty(d)&&null!==(v=r[d])&&void 0!==v?v:g}function Cr(r){return function(r){return null!==r&&"object"==typeof r}(r)&&!Array.isArray(r)&&r.constructor===Object}var cr=function(){function r(g){this.signature=g}var d=r.prototype;return d.deserialize=function(v){var I=v.data;return Cr(I)?jr(I,"data",I):I},d.serialize=function(v){return v.signature=this.signature,{id:v.id,kind:jr(v,"method",r.emptyValue),signature:r.frameSignature,data:v}},r}();cr.emptyValue="",cr.frameSignature="FxFrameControl";var Fr,lo=function(){function r(){}var d=r.prototype;return d.createAckResponse=function(){return"start"},d.getReadyMessageMethod=function(){return"ready"},d.isAckResponse=function(v){return"start"===v},r}(),co=function(){function r(g){this.signature=g}var d=r.prototype;return d.deserialize=function(v){return v.data},d.serialize=function(v){return v.signature=this.signature,v},r}(),Bo="__PONG__",uo=function(){function r(){}var d=r.prototype;return d.createAckResponse=function(){return Bo},d.getReadyMessageMethod=function(){return"__PING__"},d.isAckResponse=function(v){return v===Bo},r}();!function(r){r.Default="default",r.AzurePortal_v1_0_0="azureportal-v1.0.0"}(Fr||(Fr={}));var Pn=function(){function r(g){fn(g.targetWindow),fn(g.sourceWindow),this.options=g,this.eventListeners=new Map}var d=r.prototype;return d.addListener=function(v){var I=this;if(this.eventListeners.has(v))throw new Error("Duplicate rpc listener added.");var X=function(wt){return I.handleMessageReceived(wt,v)};this.eventListeners.set(v,X),this.options.sourceWindow.addEventListener(r.eventTypeName,X)},d.postMessage=function(v){var I=this.options.targetOriginProvider.getTargetOrigin(v);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(v),I)},d.removeListener=function(v){var I=this.eventListeners.get(v);I&&(this.options.sourceWindow.removeEventListener(r.eventTypeName,I),this.eventListeners.delete(v))},r.isMessageEvent=function(v){return!function(r){return null==r}(v.data)},d.canProcessMessage=function(v){return!!v&&v.signature===this.options.rpcMessageConverter.signature},d.handleMessageReceived=function(v,I){if(r.isMessageEvent(v)){var X=this.options.rpcMessageConverter.deserialize(v);this.canProcessMessage(X)&&this.options.allowedOrigins.some(function(Oe){return function(r,d){if("*"===d)return!0;if(d.startsWith("https://*.")&&r.startsWith("https://")){var v=d.substring(9);return r.substring(8).endsWith(v)}return r===d}(v.origin,Oe)})&&(this.options.targetOriginProvider.onMessageReceived(v.origin),I(X))}},r}();Pn.eventTypeName="message";var Na=function(){function r(g){this.explicitTargetOrigin=g}var d=r.prototype;return d.getTargetOrigin=function(v){return this.explicitTargetOrigin},d.onMessageReceived=function(v){},r}();function Ha(r){var d=r.indexOf("#"),g=d>=0?r.substring(0,d):r,v=r.indexOf("?");return v>=0?g.substring(0,v):g}function qo(r){for(var g=r.indexOf("?")>-1?"&":"?",v=arguments.length,I=new Array(v>1?v-1:0),X=1;X<v;X++)I[X-1]=arguments[X];return""+r+g+I.map(function(wt){return encodeURIComponent(wt.name)+"="+encodeURIComponent(wt.value)}).join("&")}function za(r){var d=r.indexOf("//");if(d>=0){var g=r.indexOf("/",d+=2);if(g>=0)return r.substring(0,g)}return r}function pr(){pr=function(){return d};var r,d={},g=Object.prototype,v=g.hasOwnProperty,I=Object.defineProperty||function(re,H,Z){re[H]=Z.value},X="function"==typeof Symbol?Symbol:{},Oe=X.iterator||"@@iterator",wt=X.asyncIterator||"@@asyncIterator",ht=X.toStringTag||"@@toStringTag";function ut(re,H,Z){return Object.defineProperty(re,H,{value:Z,enumerable:!0,configurable:!0,writable:!0}),re[H]}try{ut({},"")}catch{ut=function(Z,Ce,xe){return Z[Ce]=xe}}function Ot(re,H,Z,Ce){var we=Object.create((H&&H.prototype instanceof Tn?H:Tn).prototype),mt=new Xn(Ce||[]);return I(we,"_invoke",{value:Nn(re,Z,mt)}),we}function it(re,H,Z){try{return{type:"normal",arg:re.call(H,Z)}}catch(Ce){return{type:"throw",arg:Ce}}}d.wrap=Ot;var _n="suspendedStart",bn="suspendedYield",Un="executing",Zt="completed",Ht={};function Tn(){}function kn(){}function un(){}var Kn={};ut(Kn,Oe,function(){return this});var qn=Object.getPrototypeOf,xn=qn&&qn(qn(Zn([])));xn&&xn!==g&&v.call(xn,Oe)&&(Kn=xn);var gn=un.prototype=Tn.prototype=Object.create(Kn);function nr(re){["next","throw","return"].forEach(function(H){ut(re,H,function(Z){return this._invoke(H,Z)})})}function Vn(re,H){function Z(xe,we,mt,At){var Gt=it(re[xe],re,we);if("throw"!==Gt.type){var dn=Gt.arg,an=dn.value;return an&&"object"==typeof an&&v.call(an,"__await")?H.resolve(an.__await).then(function(pn){Z("next",pn,mt,At)},function(pn){Z("throw",pn,mt,At)}):H.resolve(an).then(function(pn){dn.value=pn,mt(dn)},function(pn){return Z("throw",pn,mt,At)})}At(Gt.arg)}var Ce;I(this,"_invoke",{value:function(we,mt){function At(){return new H(function(Gt,dn){Z(we,mt,Gt,dn)})}return Ce=Ce?Ce.then(At,At):At()}})}function Nn(re,H,Z){var Ce=_n;return function(xe,we){if(Ce===Un)throw new Error("Generator is already running");if(Ce===Zt){if("throw"===xe)throw we;return{value:r,done:!0}}for(Z.method=xe,Z.arg=we;;){var mt=Z.delegate;if(mt){var At=Hn(mt,Z);if(At){if(At===Ht)continue;return At}}if("next"===Z.method)Z.sent=Z._sent=Z.arg;else if("throw"===Z.method){if(Ce===_n)throw Ce=Zt,Z.arg;Z.dispatchException(Z.arg)}else"return"===Z.method&&Z.abrupt("return",Z.arg);Ce=Un;var Gt=it(re,H,Z);if("normal"===Gt.type){if(Ce=Z.done?Zt:bn,Gt.arg===Ht)continue;return{value:Gt.arg,done:Z.done}}"throw"===Gt.type&&(Ce=Zt,Z.method="throw",Z.arg=Gt.arg)}}}function Hn(re,H){var Z=H.method,Ce=re.iterator[Z];if(Ce===r)return H.delegate=null,"throw"===Z&&re.iterator.return&&(H.method="return",H.arg=r,Hn(re,H),"throw"===H.method)||"return"!==Z&&(H.method="throw",H.arg=new TypeError("The iterator does not provide a '"+Z+"' method")),Ht;var xe=it(Ce,re.iterator,H.arg);if("throw"===xe.type)return H.method="throw",H.arg=xe.arg,H.delegate=null,Ht;var we=xe.arg;return we?we.done?(H[re.resultName]=we.value,H.next=re.nextLoc,"return"!==H.method&&(H.method="next",H.arg=r),H.delegate=null,Ht):we:(H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,Ht)}function hr(re){var H={tryLoc:re[0]};1 in re&&(H.catchLoc=re[1]),2 in re&&(H.finallyLoc=re[2],H.afterLoc=re[3]),this.tryEntries.push(H)}function Fn(re){var H=re.completion||{};H.type="normal",delete H.arg,re.completion=H}function Xn(re){this.tryEntries=[{tryLoc:"root"}],re.forEach(hr,this),this.reset(!0)}function Zn(re){if(re||""===re){var H=re[Oe];if(H)return H.call(re);if("function"==typeof re.next)return re;if(!isNaN(re.length)){var Z=-1,Ce=function xe(){for(;++Z<re.length;)if(v.call(re,Z))return xe.value=re[Z],xe.done=!1,xe;return xe.value=r,xe.done=!0,xe};return Ce.next=Ce}}throw new TypeError(typeof re+" is not iterable")}return kn.prototype=un,I(gn,"constructor",{value:un,configurable:!0}),I(un,"constructor",{value:kn,configurable:!0}),kn.displayName=ut(un,ht,"GeneratorFunction"),d.isGeneratorFunction=function(re){var H="function"==typeof re&&re.constructor;return!!H&&(H===kn||"GeneratorFunction"===(H.displayName||H.name))},d.mark=function(re){return Object.setPrototypeOf?Object.setPrototypeOf(re,un):(re.__proto__=un,ut(re,ht,"GeneratorFunction")),re.prototype=Object.create(gn),re},d.awrap=function(re){return{__await:re}},nr(Vn.prototype),ut(Vn.prototype,wt,function(){return this}),d.AsyncIterator=Vn,d.async=function(re,H,Z,Ce,xe){void 0===xe&&(xe=Promise);var we=new Vn(Ot(re,H,Z,Ce),xe);return d.isGeneratorFunction(H)?we:we.next().then(function(mt){return mt.done?mt.value:we.next()})},nr(gn),ut(gn,ht,"Generator"),ut(gn,Oe,function(){return this}),ut(gn,"toString",function(){return"[object Generator]"}),d.keys=function(re){var H=Object(re),Z=[];for(var Ce in H)Z.push(Ce);return Z.reverse(),function xe(){for(;Z.length;){var we=Z.pop();if(we in H)return xe.value=we,xe.done=!1,xe}return xe.done=!0,xe}},d.values=Zn,Xn.prototype={constructor:Xn,reset:function(H){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Fn),!H)for(var Z in this)"t"===Z.charAt(0)&&v.call(this,Z)&&!isNaN(+Z.slice(1))&&(this[Z]=r)},stop:function(){this.done=!0;var H=this.tryEntries[0].completion;if("throw"===H.type)throw H.arg;return this.rval},dispatchException:function(H){if(this.done)throw H;var Z=this;function Ce(dn,an){return mt.type="throw",mt.arg=H,Z.next=dn,an&&(Z.method="next",Z.arg=r),!!an}for(var xe=this.tryEntries.length-1;xe>=0;--xe){var we=this.tryEntries[xe],mt=we.completion;if("root"===we.tryLoc)return Ce("end");if(we.tryLoc<=this.prev){var At=v.call(we,"catchLoc"),Gt=v.call(we,"finallyLoc");if(At&&Gt){if(this.prev<we.catchLoc)return Ce(we.catchLoc,!0);if(this.prev<we.finallyLoc)return Ce(we.finallyLoc)}else if(At){if(this.prev<we.catchLoc)return Ce(we.catchLoc,!0)}else{if(!Gt)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return Ce(we.finallyLoc)}}}},abrupt:function(H,Z){for(var Ce=this.tryEntries.length-1;Ce>=0;--Ce){var xe=this.tryEntries[Ce];if(xe.tryLoc<=this.prev&&v.call(xe,"finallyLoc")&&this.prev<xe.finallyLoc){var we=xe;break}}we&&("break"===H||"continue"===H)&&we.tryLoc<=Z&&Z<=we.finallyLoc&&(we=null);var mt=we?we.completion:{};return mt.type=H,mt.arg=Z,we?(this.method="next",this.next=we.finallyLoc,Ht):this.complete(mt)},complete:function(H,Z){if("throw"===H.type)throw H.arg;return"break"===H.type||"continue"===H.type?this.next=H.arg:"return"===H.type?(this.rval=this.arg=H.arg,this.method="return",this.next="end"):"normal"===H.type&&Z&&(this.next=Z),Ht},finish:function(H){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var Ce=this.tryEntries[Z];if(Ce.finallyLoc===H)return this.complete(Ce.completion,Ce.afterLoc),Fn(Ce),Ht}},catch:function(H){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var Ce=this.tryEntries[Z];if(Ce.tryLoc===H){var xe=Ce.completion;if("throw"===xe.type){var we=xe.arg;Fn(Ce)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(H,Z,Ce){return this.delegate={iterator:Zn(H),resultName:Z,nextLoc:Ce},"next"===this.method&&(this.arg=r),Ht}},d}var Wo,ho,li,Sn,ci,jo,go,fo,mo,Qr,yr,Kr,Ei,Jt,$o,Ti,Qo,Ko,xi,Xo,Ii,Di,ui,Zo,ur,Yo,Jo,ea,di,vo,ta,na,ra,_o,pi,ia,hi,oa,gi,fi,Xr,ki,qt,Zr,Ar,Vi,Bn,Qn,br,Yr,mi,s,h,b,w,C,P,z,q,j,B,N,ie,ce,Xe,Nt,Ze,ge,et,pt,Qe,Ut,Yt,Gn,En,Co,aa,Ua,Vs,Fs,As,Rs,Ls,Gs,Ns,Hs,zs,sa,Bs,Us,qs,Ws,js,$s,Qs,Ks,Xs,Zs,Ys,Js,el,tl,nl,rl,il,ol,al,sl,ll,cl,ul,Oi=function(r,d,g,v){return new(g||(g=Promise))(function(X,Oe){function wt(Ot){try{ut(v.next(Ot))}catch(it){Oe(it)}}function ht(Ot){try{ut(v.throw(Ot))}catch(it){Oe(it)}}function ut(Ot){Ot.done?X(Ot.value):function(X){return X instanceof g?X:new g(function(Oe){Oe(X)})}(Ot.value).then(wt,ht)}ut((v=v.apply(r,d||[])).next())})},Ba=function(){function r(g){var I,X,Oe,v=this,wt=new Date;this.instanceId=bo(),this.configuration=g;var ht=null!==(I=this.configuration.clientSettings.clientEnvironment)&&void 0!==I?I:this.createDefaultClientEnvironment(this.configuration.clientSettings.container,this.configuration.clientSettings.className),ut=[{name:Xt.ClientInstanceId,value:this.instanceId}];this.configuration.clientSettings.protocolId&&ut.push({name:Xt.ProtocolId,value:this.configuration.clientSettings.protocolId});var Ot=qo.apply(M,[this.configuration.clientSettings.url].concat(ut));this.appWindow=ht.appWindowFactory(Ot);var it=void 0!==this.configuration.clientSettings.allowedOrigin?this.configuration.clientSettings.allowedOrigin:"*",_n=function(r,d){return d===Fr.AzurePortal_v1_0_0?{rpcMessageConverter:new cr(r),rpcHandshakeHandler:new lo}:{rpcMessageConverter:new co(r),rpcHandshakeHandler:new uo}}(function(r){return null==r?"mspq":"mspq-"+r}(this.instanceId),null!==(X=this.configuration.clientSettings.protocolId)&&void 0!==X?X:Fr.Default);this.clientRpcChannel=new Hi({debugName:"MashupEditorClient.clientRpcChannel",enableDebugLogging:null!==(Oe=this.configuration.clientSettings.enableDebugLogging)&&void 0!==Oe&&Oe,rpcHandshakeHandler:_n.rpcHandshakeHandler,rpcWindow:new Pn({allowedOrigins:[it],rpcMessageConverter:_n.rpcMessageConverter,sourceWindow:ht.clientWindow,targetOriginProvider:new Na(it),targetWindow:this.appWindow})}),this.clientRpcEndpoint=new Ft(this.clientRpcChannel,{onCancelCurrentFlow:function(){return v.onCancelCurrentFlow()},onCommitCurrentFlow:function(Un){return v.onCommitCurrentFlow(Un)},onCurrentFlowReady:function(){return v.onCurrentFlowReady()},onAppReady:function(){return v.appReady.resolve()}},this,g,wt),this.serviceProxy=new Za(this.clientRpcChannel),this.appReady=new Ri}var d=r.prototype;return d.activateQuery=function(v){return this.serviceProxy.activateQuery(v)},d.addQuery=function(v,I,X){return this.serviceProxy.addQuery(v,I,X)},d.deleteAllQueries=function(){return this.serviceProxy.deleteAllQueries()},d.onHostPopupCancelled=function(v){return this.serviceProxy.onHostPopupCancelled(v)},d.cancelAddQueriesFlow=function(){return this.serviceProxy.cancelAddQueriesFlow()},d.endFlow=function(){return this.appWindow.hide(),this.serviceProxy.endFlow()},d.getActiveQueryName=function(){return this.serviceProxy.getActiveQueryName()},d.getCommitResult=function(){return this.serviceProxy.getCommitResult()},d.getComputeEngineSettings=function(){return this.serviceProxy.getComputeEngineSettings()},d.getCurrentFlow=function(){return this.serviceProxy.getCurrentFlow()},d.getDataSourceQueryScript=function(v,I){return this.serviceProxy.getDataSourceQueryScript(v,I)},d.getEditingSessionId=function(){return this.serviceProxy.getEditingSessionId()},d.getEditingSessionMashup=function(v){return this.serviceProxy.getEditingSessionMashup(v)},d.getMashupGatewayVersion=function(){return this.serviceProxy.getMashupGatewayVersion()},d.getGetDataWizardFlowStage=function(){return this.serviceProxy.getGetDataWizardFlowStage()},d.getFooterMessage=function(){return this.serviceProxy.getFooterMessage()},d.getIncrementalRefreshSettings=function(){return this.serviceProxy.getIncrementalRefreshSettings()},d.getQueriesInfo=function(){return this.serviceProxy.getQueriesInfo()},d.getQueryEditorState=function(){return this.serviceProxy.getQueryEditorState()},d.getQueryEditorStateOrThrow=function(){return this.serviceProxy.getQueryEditorStateOrThrow()},d.getQueryNames=function(){return this.serviceProxy.getQueryNames()},d.getQueryScript=function(v){return this.serviceProxy.getQueryScript(v)},d.getReadyState=function(){return this.serviceProxy.getReadyState()},d.getRefreshSettings=function(){return this.serviceProxy.getRefreshSettings()},d.getSelectedStepName=function(){return this.serviceProxy.getSelectedStepName()},d.getUserSettings=function(){return this.serviceProxy.getUserSettings()},d.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},d.isFeatureSupported=function(v){return this.serviceProxy.isFeatureSupported(v)},d.isFooterOverlayVisible=function(){return this.serviceProxy.isFooterOverlayVisible()},d.logXFramePerformanceMarks=function(v){return this.serviceProxy.logXFramePerformanceMarks(v)},d.refreshActiveQueryResult=function(){return this.serviceProxy.refreshActiveQueryResult()},d.setCommitButtonEnabledStatePolicy=function(v){return this.serviceProxy.setCommitButtonEnabledStatePolicy(v)},d.setUserSettings=function(v){return this.serviceProxy.setUserSettings(v)},d.startFlow=function(v,I,X,Oe){return Oi(this,void 0,void 0,pr().mark(function wt(){return pr().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return Ot.next=2,this.ready;case 2:return Ot.next=4,this.getCurrentFlow();case 4:if(null==Ot.sent){Ot.next=7;break}throw Error("cannot start a new flow when an existing flow is running");case 7:return this.currentFlowConfiguration={flowReady:new Ri,shouldEndFlowOnCommit:ee(v),shouldEndFlowOnCancel:ae(v),onCommit:function(_n,bn){if(V(bn,v))return I(_n,bn);throw new Error("The flow "+v.kind+" returned the wrong type of result: "+bn.kind)},onCancel:X},this.appWindow.show(),this.serviceProxy.startFlow(v,Oe),Ot.abrupt("return",this.currentFlowConfiguration.flowReady.promise);case 11:case"end":return Ot.stop()}},wt,this)}))},d.dispose=function(){return Oi(this,void 0,void 0,pr().mark(function v(){return pr().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return this.appWindow.hide(),X.prev=1,X.next=4,this.serviceProxy.disposeService();case 4:return X.prev=4,this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.appWindow.dispose(),X.finish(4);case 9:case"end":return X.stop()}},v,this,[[1,,4,9]])}))},d.trySetQueryScript=function(v,I){return this.serviceProxy.trySetQueryScript(v,I)},d.createDefaultClientEnvironment=function(v,I){return{clientWindow:window,appWindowFactory:function(Oe){return new ke(Oe,v,I)}}},d.onCancelCurrentFlow=function(){return Oi(this,void 0,void 0,pr().mark(function v(){return pr().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(!this.configuration.onCancel){X.next=2;break}return X.abrupt("return",this.configuration.onCancel(this));case 2:return fn(this.currentFlowConfiguration),X.next=5,this.currentFlowConfiguration.onCancel(this);case 5:this.currentFlowConfiguration.shouldEndFlowOnCancel&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return X.stop()}},v,this)}))},d.onCommitCurrentFlow=function(v){return Oi(this,void 0,void 0,pr().mark(function I(){return pr().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:if(!this.configuration.onCommit){Oe.next=2;break}return Oe.abrupt("return",this.configuration.onCommit(this));case 2:return fn(this.currentFlowConfiguration),Oe.next=5,this.currentFlowConfiguration.onCommit(this,v);case 5:this.currentFlowConfiguration.shouldEndFlowOnCommit&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return Oe.stop()}},I,this)}))},d.onCurrentFlowReady=function(){fn(this.currentFlowConfiguration),this.currentFlowConfiguration.flowReady.resolve()},(0,De.Z)(r,[{key:"dataPreview",get:function(){var v=this;return{cancelCurrentEvaluation:function(){return v.serviceProxy.dataPreview_cancelCurrentQueryEvaluation()},selectColumns:function(X){return v.serviceProxy.dataPreview_selectColumns(X)}}}},{key:"getDataWizardFooterCallbacks",get:function(){var v=this;return{clickCancelButton:function(){return v.serviceProxy.getDataWizardFooter_clickCancelButton()},clickCommitButton:function(){return v.serviceProxy.getDataWizardFooter_clickCommitButton()},clickCustomButton:function(){return v.serviceProxy.getDataWizardFooter_clickCustomButton()},clickNextStageButton:function(){return v.serviceProxy.getDataWizardFooter_clickNextStageButton()},clickPreviousStageButton:function(){return v.serviceProxy.getDataWizardFooter_clickPreviousStageButton()}}}},{key:"cancelButton",get:function(){var v=this;return{click:function(){return v.serviceProxy.clickCancelButton()},getLabel:function(){return v.serviceProxy.getCancelButtonLabel()},isEnabled:function(){return v.serviceProxy.isCancelButtonEnabled()},isVisible:function(){return v.serviceProxy.isCancelButtonVisible()}}}},{key:"commitButton",get:function(){var v=this;return{click:function(){return v.serviceProxy.clickCommitButton()},getLabel:function(){return v.serviceProxy.getCommitButtonLabel()},isEnabled:function(){return v.serviceProxy.isCommitButtonEnabled()},isVisible:function(){return v.serviceProxy.isCommitButtonVisible()}}}},{key:"customButton",get:function(){var v=this;return{click:function(){return v.serviceProxy.clickCustomButton()},getLabel:function(){return v.serviceProxy.getCustomButtonLabel()},isEnabled:function(){return v.serviceProxy.isCustomButtonEnabled()},isVisible:function(){return v.serviceProxy.isCustomButtonVisible()}}}},{key:"nextStageButton",get:function(){var v=this;return{click:function(){return v.serviceProxy.clickNextStageButton()},getLabel:function(){return v.serviceProxy.getNextStageButtonLabel()},isEnabled:function(){return v.serviceProxy.isNextStageButtonEnabled()},isVisible:function(){return v.serviceProxy.isNextStageButtonVisible()}}}},{key:"createConnectionFlowCallbacks",get:function(){var v=this;return{commit:function(X){return v.serviceProxy.createConnectionFlow_commit(X)}}}},{key:"previousStageButton",get:function(){var v=this;return{click:function(){return v.serviceProxy.clickPreviousStageButton()},getLabel:function(){return v.serviceProxy.getPreviousStageButtonLabel()},isEnabled:function(){return v.serviceProxy.isPreviousStageButtonEnabled()},isVisible:function(){return v.serviceProxy.isPreviousStageButtonVisible()}}}},{key:"ready",get:function(){return this.appReady.promise}}]),r}();!function(r){r.Success="Success",r.Error_EmptyName="Error_EmptyName",r.Error_InvalidCharacters="Error_InvalidCharacters",r.Error_NameAlreadyExists="Error_NameAlreadyExists",r.Error_NameTooLong="Error_NameTooLong"}(Wo||(Wo={})),function(r){r.Cancel="Cancel",r.Commit="Commit"}(ho||(ho={})),function(r){r.AlwaysCancel="AlwaysCancel",r.AlwaysCommit="AlwaysCommit",r.Ask="Ask"}(li||(li={})),function(r){r.BuiltInCommand="BuiltInCommand",r.HostCommand="HostCommand"}(Sn||(Sn={})),function(r){r.Kusto="kusto",r.Sql="sql"}(ci||(ci={})),function(r){r.StepLabel="StepLabel",r.StepName="StepName"}(jo||(jo={})),function(r){r.CalculatedEntity="CalculatedEntity",r.Default="Default",r.LinkedEntity="LinkedEntity",r.Parameter="Parameter",r.Visual="Visual"}(go||(go={})),function(r){r.Data="Data",r.Schema="Schema"}(fo||(fo={})),function(r){r.None="None",r.Query="Query",r.Step="Step"}(mo||(mo={})),function(r){r.Critical="Critical",r.Error="Error"}(Qr||(Qr={})),function(r){r.AlwaysDisabled="AlwaysDisabled",r.Default="Default"}(yr||(yr={})),function(r){r.Cancelled="Cancelled",r.Completed="Completed",r.Failed="Failed",r.NotStarted="NotStarted",r.Running="Running"}(Kr||(Kr={})),function(r){r.Access="Access",r.Access_Monocolor="Access_Monocolor",r.ActiveDirectory="ActiveDirectory",r.AddFuzzyClusterColumn="AddFuzzyClusterColumn",r.AddRankColumn="AddRankColumn",r.AdobeAnalytics="AdobeAnalytics",r.AIInsights="AIInsights",r.AllFilled="AllFilled",r.AllRegular="AllRegular",r.Alternates="Alternates",r.AnyType="AnyType",r.AppendQueries="AppendQueries",r.AppendQueriesAsNew="AppendQueriesAsNew",r.AzureAnalysisServices="AzureAnalysisServices",r.AzureBlobs="AzureBlobs",r.AzureFilled="AzureFilled",r.AzureHdInsightClusters="AzureHdInsightClusters",r.AzureRegular="AzureRegular",r.AzureSql="AzureSql",r.AzureSynapse="AzureSynapse",r.AzureTables="AzureTables",r.Binary="Binary",r.Blog="Blog",r.BlueLink="BlueLink",r.CalculatedEntity="CalculatedEntity",r.Calculator="Calculator",r.Cancel="Cancel",r.CancelRefresh="CancelRefresh",r.Cds="Cds",r.ChartClusteredBar="ChartClusteredBar",r.ChartClusteredColumn="ChartClusteredColumn",r.ChartLine="ChartLine",r.ChartPercentageStackedArea="ChartPercentageStackedArea",r.ChartPercentageStackedBar="ChartPercentageStackedBar",r.ChartPercentageStackedColumn="ChartPercentageStackedColumn",r.ChartStackedArea="ChartStackedArea",r.ChartStackedBar="ChartStackedBar",r.ChartStackedColumn="ChartStackedColumn",r.Checkmark="Checkmark",r.ChooseColumns="ChooseColumns",r.ClearFilter="ClearFilter",r.Close="Close",r.CloseAndLoad="CloseAndLoad",r.CloseAndLoadTo="CloseAndLoadTo",r.CloseRed="CloseRed",r.Column="Column",r.ColumnByExample="ColumnByExample",r.CombineFiles="CombineFiles",r.Community="Community",r.ConditionalColumn="ConditionalColumn",r.ConnectDatabase="ConnectDatabase",r.Copilot="Copilot",r.Copy="Copy",r.CountRows="CountRows",r.Cube="Cube",r.CubeAddAndExpandDimensionColumn="CubeAddAndExpandDimensionColumn",r.CubeCollapseAndRemoveColumns="CubeCollapseAndRemoveColumns",r.CubeDimension="CubeDimension",r.CubeDimensionAttribute="CubeDimensionAttribute",r.CubeDimensionHierarchy="CubeDimensionHierarchy",r.CubeMeasure="CubeMeasure",r.CubeServer="CubeServer",r.Currency="Currency",r.CustomColumn="CustomColumn",r.Cut="Cut",r.Database="Database",r.DatabaseClock="DatabaseClock",r.DatabaseDynamic="DatabaseDynamic",r.DatabaseFilled="DatabaseFilled",r.DatabaseLightning="DatabaseLightning",r.DatabaseOpaque="DatabaseOpaque",r.DatabaseRefresh="DatabaseRefresh",r.DatabaseRegular="DatabaseRegular",r.Databases="Databases",r.DatabaseUnknown="DatabaseUnknown",r.Dataflows="Dataflows",r.Dataverse="Dataverse",r.Date="Date",r.DateTime="DateTime",r.DateTimeZone="DateTimeZone",r.Delete="Delete",r.DeleteFile="DeleteFile",r.DemoteHeaders="DemoteHeaders",r.DetectDataType="DetectDataType",r.Diagram="Diagram",r.Documentation="Documentation",r.DragQueries="DragQueries",r.DragQueryGroups="DragQueryGroups",r.DuplicateColumn="DuplicateColumn",r.Duration="Duration",r.Dynamics365="Dynamics365",r.Empty="Empty",r.Entity="Entity",r.Error="Error",r.Excel="Excel",r.Excel_Monocolor="Excel_Monocolor",r.Exchange="Exchange",r.Exchange_Monocolor="Exchange_Monocolor",r.Expand="Expand",r.ExpandColumn="ExpandColumn",r.Fabric="Fabric",r.FabricFilled="FabricFilled",r.FabricRegular="FabricRegular",r.FastCopy="FastCopy",r.Feedback="Feedback",r.FeedbackExtremelyDissatisfied="FeedbackExtremelyDissatisfied",r.FeedbackExtremelySatisfied="FeedbackExtremelySatisfied",r.FeedbackSomewhatDissatisfied="FeedbackSomewhatDissatisfied",r.FeedbackSomewhatSatisfied="FeedbackSomewhatSatisfied",r.Fhir="Fhir",r.FileFilled="FileFilled",r.FileRegular="FileRegular",r.FillDown="FillDown",r.FillUp="FillUp",r.Filter="Filter",r.FitToView="FitToView",r.FluentView="FluentView",r.Folder="Folder",r.FormatText="FormatText",r.FullScreen="FullScreen",r.Function="Function",r.Gear="Gear",r.GetData="GetData",r.GoogleAnalytics="GoogleAnalytics",r.GoToColumn="GoToColumn",r.GridAutoFilter="GridAutoFilter",r.GridCombineFiles="GridCombineFiles",r.GridEditFilter="GridEditFilter",r.GridExpandColumn="GridExpandColumn",r.GridSortedAscending="GridSortedAscending",r.GridSortedDescending="GridSortedDescending",r.GroupBy="GroupBy",r.HorizontalLayout="HorizontalLayout",r.IndexColumn="IndexColumn",r.Info="Info",r.InsertColumnsLeft="InsertColumnsLeft",r.InsertColumnsRight="InsertColumnsRight",r.InsertRowsAbove="InsertRowsAbove",r.InsertRowsBelow="InsertRowsBelow",r.InvokeCustomFunction="InvokeCustomFunction",r.JoinKindFullOuter="JoinKindFullOuter",r.JoinKindInner="JoinKindInner",r.JoinKindLeftAnti="JoinKindLeftAnti",r.JoinKindLeftOuter="JoinKindLeftOuter",r.JoinKindRightAnti="JoinKindRightAnti",r.JoinKindRightOuter="JoinKindRightOuter",r.KeepBottomRows="KeepBottomRows",r.KeepDuplicates="KeepDuplicates",r.KeepErrors="KeepErrors",r.KeepRange="KeepRange",r.KeepTopRows="KeepTopRows",r.Key="Key",r.KeyboardShortcuts="KeyboardShortcuts",r.Kusto="Kusto",r.LightBulb="LightBulb",r.LinkedEntity="LinkedEntity",r.List="List",r.ListToTable="ListToTable",r.Load="Load",r.Logical="Logical",r.ManageConnections="ManageConnections",r.ManageDataSources="ManageDataSources",r.Map="Map",r.MapToEntity="MapToEntity",r.MashupGraphCollapse="MashupGraphCollapse",r.MashupGraphExpand="MashupGraphExpand",r.MashupGraphRelated="MashupGraphRelated",r.MathInfo="MathInfo",r.MergeColumns="MergeColumns",r.MergeQueries="MergeQueries",r.MergeQueriesAsNew="MergeQueriesAsNew",r.More="More",r.MoveColumns="MoveColumns",r.MoveColumnsLeft="MoveColumnsLeft",r.MoveColumnsRight="MoveColumnsRight",r.MoveColumnsToBeginning="MoveColumnsToBeginning",r.MoveColumnsToEnd="MoveColumnsToEnd",r.MoveDown="MoveDown",r.MoveLeft="MoveLeft",r.MoveRight="MoveRight",r.MoveUp="MoveUp",r.Neutral="Neutral",r.Number="Number",r.OData="OData",r.Odbc="Odbc",r.OnlineServicesFilled="OnlineServicesFilled",r.OnlineServicesRegular="OnlineServicesRegular",r.OtherFilled="OtherFilled",r.OtherRegular="OtherRegular",r.Parameter="Parameter",r.Parquet="Parquet",r.Parse="Parse",r.Paste="Paste",r.Pdf="Pdf",r.Pencil="Pencil",r.Percentage="Percentage",r.PivotColumn="PivotColumn",r.Plus="Plus",r.PowerBI="PowerBI",r.PowerBIReport="PowerBIReport",r.PowerPlatformFilled="PowerPlatformFilled",r.PowerPlatformRegular="PowerPlatformRegular",r.PowerQuery="PowerQuery",r.PrimitiveToList="PrimitiveToList",r.PrivacyBuffering="PrivacyBuffering",r.PromoteHeaders="PromoteHeaders",r.Properties="Properties",r.QuerySettings="QuerySettings",r.QuestionMark="QuestionMark",r.Record="Record",r.Reference="Reference",r.Refresh="Refresh",r.RemoveAlternateRows="RemoveAlternateRows",r.RemoveBlankRows="RemoveBlankRows",r.RemoveBottomRows="RemoveBottomRows",r.RemoveColumns="RemoveColumns",r.RemoveDuplicates="RemoveDuplicates",r.RemoveErrors="RemoveErrors",r.RemoveOtherColumns="RemoveOtherColumns",r.RemoveRows="RemoveRows",r.RemoveTopRows="RemoveTopRows",r.Rename="Rename",r.ReplaceErrors="ReplaceErrors",r.ReplaceValues="ReplaceValues",r.Reset="Reset",r.ReverseRows="ReverseRows",r.Rounding="Rounding",r.Salesforce="Salesforce",r.Save="Save",r.Scientific="Scientific",r.Script="Script",r.Sensitivity="Sensitivity",r.Settings="Settings",r.Share="Share",r.SharePoint="SharePoint",r.Sheet="Sheet",r.SheetAccess="SheetAccess",r.SheetCsv="SheetCsv",r.SheetDataflow="SheetDataflow",r.SheetExcel="SheetExcel",r.SheetHtml="SheetHtml",r.SheetJson="SheetJson",r.SheetSql="SheetSql",r.SheetText="SheetText",r.SheetXml="SheetXml",r.SortAscending="SortAscending",r.SortDescending="SortDescending",r.Spark="Spark",r.Sparkle="Sparkle",r.Sparkle_Monocolor="Sparkle_Monocolor",r.SplitColumn="SplitColumn",r.Standard="Standard",r.Statistics="Statistics",r.Success="Success",r.Suggestion="Suggestion",r.Support="Support",r.Table="Table",r.TableSchema="TableSchema",r.Template="Template",r.Text="Text",r.TextFile="TextFile",r.Time="Time",r.ToTable="ToTable",r.Transpose="Transpose",r.Trigonometry="Trigonometry",r.UnknownType="UnknownType",r.Unlink="Unlink",r.UnpivotColumns="UnpivotColumns",r.Vertica="Vertica",r.VerticalLayout="VerticalLayout",r.View="View",r.Visual="Visual",r.Wand="Wand",r.Warning="Warning",r.Web="Web",r.Website="Website",r.WholeNumber="WholeNumber",r.Worksheet="Worksheet"}(Ei||(Ei={})),function(r){r.FullRefresh="FullRefresh",r.IncrementalRefresh="IncrementalRefresh"}(Jt||(Jt={})),function(r){r.Days="Days",r.Months="Months",r.Quarters="Quarters",r.Years="Years"}($o||($o={})),function(r){r.Custom="Custom",r.Standard="Standard",r.System="System"}(Ti||(Ti={})),function(r){r.EvaluateTop1000Rows="EvaluateTop1000Rows",r.EvaluateEntireDataset="EvaluateEntireDataset"}(Qo||(Qo={})),function(r){r.Action="Action.Type",r.Any="Any.Type",r.Binary="Binary.Type",r.Byte="Byte.Type",r.Character="Character.Type",r.Currency="Currency.Type",r.Date="Date.Type",r.DateTime="DateTime.Type",r.DateTimeZone="DateTimeZone.Type",r.Decimal="Decimal.Type",r.Double="Double.Type",r.Duration="Duration.Type",r.Function="Function.Type",r.Int16="Int16.Type",r.Int32="Int32.Type",r.Int64="Int64.Type",r.Int8="Int8.Type",r.List="List.Type",r.Logical="Logical.Type",r.None="None.Type",r.Null="Null.Type",r.Number="Number.Type",r.Percentage="Percentage.Type",r.Record="Record.Type",r.Single="Single.Type",r.Table="Table.Type",r.Text="Text.Type",r.Time="Time.Type",r.Type="Type.Type"}(Ko||(Ko={})),function(r){r.MultiLine="MultiLine",r.SingleLine="SingleLine"}(xi||(xi={})),function(r){r.Always="Always",r.BasedOnProjectSettings="BasedOnProjectSettings",r.Never="Never"}(Xo||(Xo={})),function(r){r.Collapsed="Collapsed",r.Expanded="Expanded",r.Maximized="Maximized"}(Ii||(Ii={})),function(r){r.Host="Host",r.Initialization="Initialization",r.UserInteraction="UserInteraction"}(Di||(Di={})),function(r){r.Action="action",r.Any="any",r.AnyNonNull="anynonnull",r.Binary="binary",r.Currency="currency",r.Date="date",r.DateTime="datetime",r.DateTimeZone="datetimezone",r.Duration="duration",r.Exception="exception",r.Function="function",r.List="list",r.Logical="logical",r.None="none",r.Null="null",r.Number="number",r.Percentage="percentage",r.Record="record",r.Table="table",r.Text="text",r.Time="time",r.Type="type",r.WholeNumber="wholenumber"}(ui||(ui={})),function(r){r.Auto="Auto",r.Percent="Percent",r.Pixels="Pixels"}(Zo||(Zo={})),function(r){r.Cells="Cells",r.Columns="Columns",r.Rows="Rows"}(ur||(ur={})),function(r){r.Access="access",r.ActiveDirectory="activeDirectory",r.AdobeAnalytics="adobeAnalytics",r.AnalysisServices="analysisServices",r.AzureAnalysisServices="azureAnalysisServices",r.AzureBlobs="azureBlobs",r.AzureDataLake="azureDataLake",r.AzureHdInsightHdfs="azureHdInsightHdfs",r.AzureSql="azureSql",r.AzureSqlDw="azureSqlDW",r.AzureTables="azureTables",r.Blank="blank",r.Db2="db2",r.Dynamics365="dynamics365",r.EnterData="enterData",r.Excel="excel",r.ExchangeOnline="exchangeOnline",r.FolderContents="folderContents",r.FolderFiles="folderFiles",r.GoogleAnalytics="googleAnalytics",r.Json="json",r.MySql="mySql",r.Odata="odata",r.Odbc="odbc",r.Oracle="oracle",r.Parquet="parquet",r.Pdf="pdf",r.PostgreSql="postgreSql",r.SharepointFolder="sharepointFolder",r.SharepointList="sharepointList",r.SharepointOnlineList="sharepointOnlineList",r.SalesforceObjects="salesforceObjects",r.SalesforceReports="salesforceReports",r.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",r.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",r.SapHanaDatabase="SapHanaDatabase",r.Sql="sql",r.Sybase="sybase",r.Teradata="teradata",r.TextCsv="textCsv",r.Web="web",r.WebApi="webApi",r.Xml="xml"}(Yo||(Yo={})),function(r){r.Extension="extension"}(Jo||(Jo={})),function(r){r.Failed="Failed",r.Idle="Idle",r.InProgress="InProgress",r.Success="Success"}(ea||(ea={})),function(r){r.WaitingToStart="WaitingToStart",r.EvaluatingRelationships="EvaluatingRelationships",r.WaitingForOtherEntities="WaitingForOtherEntities",r.EvaluatingSchema="EvaluatingSchema",r.DeletingEntity="DeletingEntity",r.CreatingEntity="CreatingEntity",r.DeletingExistingData="DeletingExistingData",r.EvaluatingData="EvaluatingData",r.ProvisioningTempStorage="ProvisioningTempStorage",r.UploadingDataToTempStorage="UploadingDataToTempStorage",r.InitializingLoadSession="InitializingLoadSession",r.WaitingForLoadSessionToInitialize="WaitingForLoadSessionToInitialize",r.CreatingDefinitionGroup="CreatingDefinitionGroup",r.CreatingDefinitionGroupDetails="CreatingDefinitionGroupDetails",r.UploadingData="UploadingData",r.GeneratingFieldMapping="GeneratingFieldMapping",r.AutoSequencing="AutoSequencing",r.ExecutingLoad="ExecutingLoad",r.WaitingForLoadToComplete="WaitingForLoadToComplete",r.GeneratingExecutionErrors="GeneratingExecutionErrors",r.Success="Success",r.SignInRequired="SignInRequired",r.DeletingExistingDataFailed="DeletingExistingDataFailed",r.EvaluationFailed="EvaluationFailed",r.CreatingEntityFailed="CreatingEntityFailed",r.DeletingEntityFailed="DeletingEntityFailed",r.RetrievingEntityMetadataFailed="RetrievingEntityMetadataFailed",r.Canceled="Canceled",r.LoadToCdsPartiallySucceeded="LoadToCdsPartiallySucceeded",r.LoadToCdsFailed="LoadToCdsFailed",r.LoadFailedDueToErrorInOtherEntity="LoadFailedDueToErrorInOtherEntity",r.Unknown="Unknown"}(di||(di={})),function(r){r.Composition="Composition",r.Conditional="Conditional",r.CountDistinctValues="CountDistinctValues",r.CountValues="CountValues",r.Date_Age="Date_Age",r.Date_CombineWithTime="Date_CombineWithTime",r.Date_Day="Date_Day",r.Date_DayOfWeek="Date_DayOfWeek",r.Date_DayOfWeekName="Date_DayOfWeekName",r.Date_DayOfYear="Date_DayOfYear",r.Date_DaysInMonth="Date_DaysInMonth",r.Date_Earliest="Date_Earliest",r.Date_EndOfDay="Date_EndOfDay",r.Date_EndOfMonth="Date_EndOfMonth",r.Date_EndOfQuarter="Date_EndOfQuarter",r.Date_EndOfWeek="Date_EndOfWeek",r.Date_EndOfYear="Date_EndOfYear",r.Date_From="Date_From",r.Date_Latest="Date_Latest",r.Date_Month="Date_Month",r.Date_MonthName="Date_MonthName",r.Date_QuarterOfYear="Date_QuarterOfYear",r.Date_StartOfDay="Date_StartOfDay",r.Date_StartOfMonth="Date_StartOfMonth",r.Date_StartOfQuarter="Date_StartOfQuarter",r.Date_StartOfWeek="Date_StartOfWeek",r.Date_StartOfYear="Date_StartOfYear",r.Date_SubtractDays="Date_SubtractDays",r.Date_WeekOfMonth="Date_WeekOfMonth",r.Date_WeekOfYear="Date_WeekOfYear",r.Date_Year="Date_Year",r.DateTime_Earliest="DateTime_Earliest",r.DateTime_From="DateTime_From",r.DateTime_Latest="DateTime_Latest",r.DateTime_Subtract="DateTime_Subtract",r.DateTime_SubtractDays="DateTime_SubtractDays",r.DateTimeZone_Earliest="DateTimeZone_Earliest",r.DateTimeZone_From="DateTimeZone_From",r.DateTimeZone_Latest="DateTimeZone_Latest",r.DateTimeZone_Subtract="DateTimeZone_Subtract",r.DateTimeZone_SubtractDays="DateTimeZone_SubtractDays",r.DateTimeZone_ToLocal="DateTimeZone_ToLocal",r.Number_Abs="Number_Abs",r.Number_Acos="Number_Acos",r.Number_Asin="Number_Asin",r.Number_Atan="Number_Atan",r.Number_Average="Number_Average",r.Number_Cos="Number_Cos",r.Number_Cube="Number_Cube",r.Number_Divide="Number_Divide",r.Number_Exp="Number_Exp",r.Number_Factorial="Number_Factorial",r.Number_From="Number_From",r.Number_IntegerDivide="Number_IntegerDivide",r.Number_IsEven="Number_IsEven",r.Number_IsOdd="Number_IsOdd",r.Number_Ln="Number_Ln",r.Number_Log10="Number_Log10",r.Number_Maximum="Number_Maximum",r.Number_Median="Number_Median",r.Number_Minimum="Number_Minimum",r.Number_Modulo="Number_Modulo",r.Number_MultiplyColumnAndConstant="Number_MultiplyColumnAndConstant",r.Number_MultiplyColumns="Number_MultiplyColumns",r.Number_PercentOf="Number_PercentOf",r.Number_Power="Number_Power",r.Number_Range="Number_Range",r.Number_Round="Number_Round",r.Number_RoundDown="Number_RoundDown",r.Number_RoundUp="Number_RoundUp",r.Number_Sign="Number_Sign",r.Number_Sin="Number_Sin",r.Number_Sqrt="Number_Sqrt",r.Number_Square="Number_Square",r.Number_StandardDeviation="Number_StandardDeviation",r.Number_Subtract="Number_Subtract",r.Number_SumColumnAndConstant="Number_SumColumnAndConstant",r.Number_SumColumns="Number_SumColumns",r.Number_Tan="Number_Tan",r.Reference="Reference",r.Text_AfterDelimiter="Text_AfterDelimiter",r.Text_BeforeDelimiter="Text_BeforeDelimiter",r.Text_BetweenDelimiters="Text_BetweenDelimiters",r.Text_Combine="Text_Combine",r.Text_End="Text_End",r.Text_Length="Text_Length",r.Text_Literal="Text_Literal",r.Text_Middle="Text_Middle",r.Text_Reference="Text_Reference",r.Text_Remove="Text_Remove",r.Text_Replace="Text_Replace",r.Text_Select="Text_Select",r.Text_Start="Text_Start",r.Time_Earliest="Time_Earliest",r.Time_EndOfHour="Time_EndOfHour",r.Time_From="Time_From",r.Time_Hour="Time_Hour",r.Time_Latest="Time_Latest",r.Time_Minute="Time_Minute",r.Time_Second="Time_Second",r.Time_StartOfHour="Time_StartOfHour",r.Time_Subtract="Time_Subtract"}(vo||(vo={})),function(r){r.UnknownError="UnknownError",r.InvalidConnectionProvider="InvalidConnectionProvider"}(ta||(ta={})),function(r){r.Adf="Adf",r.CdsA="CdsA",r.Desktop="Desktop",r.DmtsPowerBi="DmtsPowerBi",r.DmtsSa="DmtsSa",r.None="None",r.PowerApps="PowerApps",r.SelfHosted="SelfHosted"}(na||(na={})),function(r){r.SqlDw="SqlDw",r.SynapseOnDemand="SynapseOnDemand"}(ra||(ra={})),function(r){r.Error="Error",r.Warning="Warning"}(_o||(_o={})),function(r){r[r.sunday=0]="sunday",r[r.monday=1]="monday",r[r.tuesday=2]="tuesday",r[r.wednesday=3]="wednesday",r[r.thursday=4]="thursday",r[r.friday=5]="friday",r[r.saturday=6]="saturday"}(pi||(pi={})),function(r){r.Boolean="Boolean",r.DateAndTime="DateAndTime",r.DateOnly="DateOnly",r.Decimal="Decimal",r.Double="Double",r.Integer="Integer",r.Lookup="Lookup",r.Memo="Memo",r.Money="Money",r.String="String"}(ia||(ia={})),function(r){r.Resource="Resource",r.Personal="Personal",r.VirtualNetwork="VirtualNetwork"}(hi||(hi={})),function(r){r[r.none=0]="none",r[r.fetchDataSourceDetails=1]="fetchDataSourceDetails",r[r.schemaRowsets=2]="schemaRowsets",r[r.mdDataset=4]="mdDataset",r[r.columnOrdinals=8]="columnOrdinals",r[r.statefulSessions=16]="statefulSessions",r[r.directQuerySingleSignOn_Kerberos=32]="directQuerySingleSignOn_Kerberos",r[r.mashupCustomConnectors=64]="mashupCustomConnectors",r[r.mashupCustomConnectorsForODG=128]="mashupCustomConnectorsForODG",r[r.sapHanaSSOManagedProvider=256]="sapHanaSSOManagedProvider",r[r.filteringMashupExtensionsOnODG=512]="filteringMashupExtensionsOnODG",r[r.certifiedConnectors=1024]="certifiedConnectors",r[r.mashupAzureConnectorsCachingPool=2048]="mashupAzureConnectorsCachingPool",r[r.skipTestConnection=4096]="skipTestConnection",r[r.encryptedConnectionOptionOverride=8192]="encryptedConnectionOptionOverride",r[r.mashupADONetProviderSSO=16384]="mashupADONetProviderSSO",r[r.authTypeSAS=32768]="authTypeSAS",r[r.powerQueryOnlineCachingPool=65536]="powerQueryOnlineCachingPool",r[r.ssoTestConnection=131072]="ssoTestConnection",r[r.mashupIgnorePreviouslyCachedData=262144]="mashupIgnorePreviouslyCachedData",r[r.mashupQueryStatus=524288]="mashupQueryStatus",r[r.multipleResults=1048576]="multipleResults",r[r.renewDiagnosticsStorageAccess=2097152]="renewDiagnosticsStorageAccess",r[r.oAuthResource=4194304]="oAuthResource",r[r.statefulDbConnection=8388608]="statefulDbConnection",r[r.discoverDatasourcesUsingMashupDSR=16777216]="discoverDatasourcesUsingMashupDSR"}(oa||(oa={})),function(r){r.Critical="Critical",r.Error="Error",r.Warning="Warning",r.Informational="Informational",r.Verbose="Verbose"}(gi||(gi={})),function(r){r[r.connectionNotFound=0]="connectionNotFound",r[r.failedToRefreshConnection=1]="failedToRefreshConnection",r[r.unauthorizedConnection=2]="unauthorizedConnection"}(fi||(fi={})),function(r){r.DifferentUser="DifferentUser",r.NoMatchingConnection="NoMatchingConnection",r.NonOAuthConnection="NonOAuthConnection ",r.NoToken="NoToken"}(Xr||(Xr={})),function(r){r.Active="ActivePowerAppsEnvironment",r.HardDeleted="HardDeletedPowerAppsEnvironment",r.SoftDeleted="SoftDeletedPowerAppsEnvironment",r.Unknown="UnknownPowerAppsEnvironment"}(ki||(ki={})),function(r){r.MappingEditorProperties="MappingEditorProperties"}(qt||(qt={})),function(r){r[r.day=0]="day",r[r.month=1]="month",r[r.quarter=2]="quarter",r[r.year=3]="year"}(Zr||(Zr={})),function(r){r.Minutes="Minutes",r.Hours="Hours",r.Days="Days",r.Weeks="Weeks",r.Months="Months"}(Ar||(Ar={})),function(r){r[r.uploadFileMalformedMultipartContent=1]="uploadFileMalformedMultipartContent",r[r.uploadFileUnsupportedFileExtension=2]="uploadFileUnsupportedFileExtension",r[r.oAuthStartLoginFailed=3]="oAuthStartLoginFailed",r[r.oAuthFinishLoginFailed=4]="oAuthFinishLoginFailed",r[r.normalizeResourceFailed=8]="normalizeResourceFailed",r[r.editVersionMismatch=9]="editVersionMismatch",r[r.updateGatewayVersion=10]="updateGatewayVersion",r[r.mashupTooLong=11]="mashupTooLong",r[r.gatewayBindingMultipleMatchingGatewayError=12]="gatewayBindingMultipleMatchingGatewayError",r[r.gatewayBindingNoMatchingDataSourceError=13]="gatewayBindingNoMatchingDataSourceError",r[r.gatewayBindingNoMatchingGatewayError=14]="gatewayBindingNoMatchingGatewayError"}(Vi||(Vi={})),function(r){r.NoTextExampleFound="NoTextExampleFound",r.NoTextProgramFound="NoTextProgramFound",r.NoTextProgramFoundBeforeCancellation="NoTextProgramFoundBeforeCancellation",r.NoTextProgramFoundBeforeTimeout="NoTextProgramFoundBeforeTimeout"}(Bn||(Bn={})),function(r){r.Successful="Successful",r.Failed="Failed",r.SessionExpired="SessionExpired"}(Qn||(Qn={})),function(r){r.AM="AM",r.PM="PM"}(br||(br={})),function(r){r[r.anonymous=1]="anonymous",r[r.basic=2]="basic",r[r.oAuth2=3]="oAuth2",r[r.windows=4]="windows",r[r.key=5]="key",r[r.sas=6]="sas",r[r.servicePrincipal=7]="servicePrincipal"}(Yr||(Yr={})),function(r){r.Access="access",r.ActiveDirectory="activeDirectory",r.AdobeAnalytics="adobeAnalytics",r.AnalysisServices="analysisServices",r.AzureAnalysisServices="azureAnalysisServices",r.AzureBlobs="azureBlobs",r.AzureDataLake="azureDataLake",r.AzureHdInsightHdfs="azureHdInsightHdfs",r.AzureSql="azureSql",r.AzureSqlDw="azureSqlDW",r.AzureTables="azureTables",r.Blank="blank",r.Db2="db2",r.Dynamics365="dynamics365",r.EnterData="enterData",r.Excel="excel",r.ExchangeOnline="exchangeOnline",r.FolderContents="folderContents",r.FolderFiles="folderFiles",r.GoogleAnalytics="googleAnalytics",r.Json="json",r.MySql="mySql",r.Odata="odata",r.Odbc="odbc",r.Oracle="oracle",r.Parquet="parquet",r.Pdf="pdf",r.PostgreSql="postgreSql",r.SharepointFolder="sharepointFolder",r.SharepointList="sharepointList",r.SharepointOnlineList="sharepointOnlineList",r.SalesforceObjects="salesforceObjects",r.SalesforceReports="salesforceReports",r.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",r.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",r.SapHanaDatabase="SapHanaDatabase",r.Sql="sql",r.Sybase="sybase",r.Teradata="teradata",r.TextCsv="textCsv",r.Web="web",r.WebApi="webApi",r.Xml="xml"}(mi||(mi={})),function(r){r.Automatic="Automatic",r.Explicit="Explicit",r.Fixed="Fixed"}(s||(s={})),function(r){r.Count="Count",r.ErrorCount="ErrorCount",r.NullCount="NullCount",r.DistinctCount="DistinctCount",r.UniqueCount="UniqueCount",r.Min="Min",r.Max="Max",r.ValueDistribution="ValueDistribution",r.Average="Average",r.EmptyStringCount="EmptyStringCount",r.TextLengthDistribution="TextLengthDistribution",r.NaNCount="NaNCount",r.ZeroCount="ZeroCount",r.EvenCount="EvenCount",r.OddCount="OddCount",r.StandardDeviation="StandardDeviation",r.SignDistribution="SignDistribution",r.ParityDistribution="ParityDistribution",r.TrueCount="TrueCount",r.FalseCount="FalseCount",r.YearDistribution="YearDistribution",r.MonthDistribution="MonthDistribution",r.DayDistribution="DayDistribution",r.WeekOfYearDistribution="WeekOfYearDistribution",r.DayOfWeekDistribution="DayOfWeekDistribution",r.AmPmDistribution="AmPmDistribution",r.HourDistribution="HourDistribution"}(h||(h={})),function(r){r.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",r.AdfConnectionEvaluationError="AdfConnectionEvaluationError",r.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",r.ConnectionApiPolicyViolation="ConnectionApiPolicyViolation",r.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",r.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",r.ConnectionKindNotSupported="ConnectionKindNotSupported",r.ConnectionNotFound="ConnectionNotFound",r.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",r.DataAccessError="DataAccessError",r.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",r.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",r.DuplicateDataSourceNameError="DuplicateDataSourceNameError",r.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",r.ExceededLimit="ExceededLimit",r.GatewayDetailsNotFound="GatewayDetailsNotFound",r.GatewayNotAuthorized="GatewayNotAuthorized",r.GatewayUnreachable="GatewayUnreachable",r.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",r.InvalidCredentials="InvalidCredentials",r.InvalidPath="InvalidPath",r.OAuthLoginFailed="OAuthLoginFailed",r.OboSignInError="OboSignInError",r.OboTokenAcquisitionFailed="OboTokenAcquisitionFailed",r.TooManyConnections="TooManyConnections",r.UnknownDmtsError="UnknownDmtsError",r.UnknownError="UnknownError",r.UnknownGatewayError="UnknownGatewayError",r.Unsupported="Unsupported"}(b||(b={})),function(r){r.AddStep="AddStep",r.CreateQuery="CreateQuery",r.DeleteQuery="DeleteQuery",r.ExplainQuery="ExplainQuery",r.ExplainStep="ExplainStep"}(w||(w={})),function(r){r.CouldNotExplainQuery="CouldNotExplainQuery",r.CouldNotGenerateQuery="CouldNotGenerateQuery",r.CouldNotGenerateStep="CouldNotGenerateStep",r.DataItemsMissing="DataItemsMissing",r.LanguageNotSupported="LanguageNotSupported",r.OutOfScope="OutOfScope",r.QueryNotFound="QueryNotFound",r.SkillNotFound="SkillNotFound",r.TableNotFound="TableNotFound",r.Unknown="Unknown"}(C||(C={})),function(r){r.Action="Action",r.Error="Error"}(P||(P={})),function(r){r.Automatic="Automatic",r.Explicit="Explicit",r.Fixed="Fixed"}(z||(z={})),function(r){r.Singleton="Singleton",r.Database="Database",r.Uri="Uri",r.Custom="Custom"}(q||(q={})),function(r){r.BuiltIn="BuiltIn",r.Extension="Extension"}(j||(j={})),function(r){r.JsonDsr="JsonDsr",r.MScript="MScript",r.QueryModel="QueryModel"}(B||(B={})),function(r){r.DSR="DSR",r.Reference="Reference",r.Script="Script"}(N||(N={})),function(r){r.Cluster="Cluster",r.Database="Database",r.Lakehouse="Lakehouse",r.Object="Object",r.Schema="Schema",r.Server="Server",r.Table="Table",r.Warehouse="Warehouse",r.Workspace="Workspace"}(ie||(ie={})),function(r){r.Constant="Constant",r.Duplicate="Duplicate",r.Empty="Empty",r.Index="Index"}(ce||(ce={})),function(r){r[r.false=0]="false",r[r.true=1]="true",r[r.notApplicable=2]="notApplicable",r[r.existingConnection=3]="existingConnection"}(Xe||(Xe={})),function(r){r.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",r.Cancelled="Cancelled",r.DuplicateEvaluationId="DuplicateEvaluationId",r.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",r.EvaluationAgentNotFound="EvaluationAgentNotFound",r.EvaluationQuotaReached="EvaluationQuotaReached",r.ExternalServiceError="ExternalServiceError",r.GatewayDetailsNotFound="GatewayDetailsNotFound",r.GatewayNeeded="GatewayNeeded",r.GatewayNotAuthorized="GatewayNotAuthorized",r.GatewayNotFound="GatewayNotFound",r.GatewayUnknownError="GatewayUnknownError",r.GatewayUnreachable="GatewayUnreachable",r.GatewayUpgradeRequired="GatewayUpgradeRequired",r.GatewayUserError="GatewayUserError",r.MashupEntityNotFound="MashupEntityNotFound",r.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",r.NetworkAccessDenied="NetworkAccessDenied",r.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",r.ParameterNotFound="ParameterNotFound",r.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",r.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",r.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",r.QueryNotFound="QueryNotFound",r.StepNotFound="StepNotFound",r.UnableToContactBackend="UnableToContactBackend",r.Unknown="Unknown",r.UnsupportedKind="UnsupportedKind",r.ValueTooComplex="ValueTooComplex"}(Nt||(Nt={})),function(r){r.Path="Path",r.QueryScript="QueryScript"}(Ze||(Ze={})),function(r){r.AutoFilterColumnValues="AutoFilterColumnValues",r.BinaryMetadata="BinaryMetadata",r.ConnectorRows="ConnectorRows",r.ConnectorSchema="ConnectorSchema",r.CubeAllowedValues="CubeAllowedValues",r.CubeDisplayFolders="CubeDisplayFolders",r.CubeParameters="CubeParameters",r.DataSourceQuery="DataSourceQuery",r.DetailsPreview="DetailsPreview",r.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",r.DsrDetailsFetching="DsrDetailsFetching",r.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",r.ExpandColumnNames="ExpandColumnNames",r.FunctionBrowser="FunctionBrowser",r.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",r.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",r.LoadToCdsRelationships="LoadToCdsRelationships",r.LoadToCdsSchema="LoadToCdsSchema",r.MappingEditorQueryProfiling="MappingEditorQueryProfiling",r.MappingEditorSchemaResult="MappingEditorSchemaResult",r.MappingEditorTypeMetadata="MappingEditorTypeMetadata",r.MashupLoad="MashupLoad",r.MergeMatchAnalysis="MergeMatchAnalysis",r.MergeQueriesPreview="MergeQueriesPreview",r.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",r.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",r.NaturalLanguageValidation="NaturalLanguageValidation",r.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",r.NavigatorCubeParameters="NavigatorCubeParameters",r.NavigatorCubePreview="NavigatorCubePreview",r.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",r.NavigatorPreview="NavigatorPreview",r.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",r.Preview="Preview",r.QueryAnalysis="QueryAnalysis",r.QueryPlan="QueryPlan",r.QuerySanitizer="QuerySanitizer",r.QuerySanitizerAnalysis="QuerySanitizerAnalysis",r.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",r.QueryScriptPreview="QueryScriptPreview",r.SemanticEntitySets="SemanticEntitySets",r.SemanticDataGetData="SemanticDataGetData",r.SemanticDataList="SemanticDataList",r.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",r.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",r.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",r.StepAnalysis="StepAnalysis",r.TableProfiler="TableProfiler",r.TextByExampleGetText="TextByExampleGetText",r.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",r.WebByExampleGetHtml="WebByExampleGetHtml"}(ge||(ge={})),function(r){r.None="None",r.Any="Any",r.Access="Access",r.Excel="Excel",r.Json="Json",r.TextCsv="TextCsv",r.Pdf="Pdf",r.Xml="Xml"}(et||(et={})),function(r){r.List="List"}(pt||(pt={})),function(r){r.MenuItem="MenuItem",r.Separator="Separator"}(Qe||(Qe={})),function(r){r.Max="Max",r.Mean="Mean",r.Min="Min",r.Mode="Mode",r.RoundedMean="RoundedMean"}(Ut||(Ut={})),function(r){r.Cancelled="Cancelled",r.CombineFiles="CombineFiles",r.CsvTextSettings="CsvTextSettings",r.DataDiscovery="DataDiscovery",r.DataSources="DataSources",r.DataSourceSettings="DataSourceSettings",r.FolderPreview="FolderPreview",r.IncrementalRefreshSettings="IncrementalRefreshSettings",r.Loading="Loading",r.MappingEditor="MappingEditor",r.Navigator="Navigator",r.QueryEditor="QueryEditor",r.QuickCreate="QuickCreate",r.RecentDataPreview="RecentDataPreview",r.RefreshSettings="RefreshSettings",r.TemplateCredentials="TemplateCredentials",r.TemplateParameters="TemplateParameters",r.TextByExample="TextByExample"}(Yt||(Yt={})),function(r){r.Database="Database",r.File="File"}(Gn||(Gn={})),function(r){r.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",r.BasedOnMetadata="BasedOnMetadata",r.Never="Never"}(En||(En={})),function(r){r.Always="Always",r.Never="Never",r.HasNewLoadableQueries="HasNewLoadableQueries",r.NumberOfQueries="NumberOfQueries"}(Co||(Co={})),function(r){r.Equals="Equals",r.GreaterThan="GreaterThan",r.GreaterThanOrEqual="GreaterThanOrEqual",r.LessThan="LessThan",r.LessThanOrEqual="LessThanOrEqual"}(aa||(aa={})),function(r){r.Adf="Adf",r.Athena="Athena",r.CdsA="CdsA",r.CdsLite="CdsLite",r.CdsT="CdsT",r.CdsV1="CdsAdHoc",r.CustomerInsights="CustomerInsights",r.CustomerInsightsPPDF="CustomerInsightsPPDF",r.D365TalentInsights="D365TalentInsights",r.DataIntegration="DataIntegration",r.DesktopBootstrap="DesktopBootstrap",r.DesktopUITester="DesktopUITester",r.DmtsPowerBiExperimental="DmtsPowerBiExperimental",r.DmtsSaExperimental="DmtsSaExperimental",r.ExcelDesktop="ExcelDesktop",r.ExcelOnline="ExcelOnline",r.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",r.Experimental="Experimental",r.Flow="Flow",r.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",r.IntelligentOrderManagement="IntelligentOrderManagement",r.InternalPortal="InternalPortal",r.KustoViewDesigner="KustoViewDesigner",r.MashupEditorBootstrap="MashupEditorBootstrap",r.PowerAppsTeams="PowerAppsTeams",r.PowerBIDataMart="PowerBIDataMart",r.PowerBIModeling="PowerBIModeling",r.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",r.PowerBIPaginatedReports="PowerBIPaginatedReports",r.PowerBIPPDF="PowerBIPPDF",r.PowerBIReportView="PowerBIReportView",r.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",r.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",r.PowerPlatformExperimental="PowerPlatformExperimental",r.PowerQueryDesktop="PowerQueryDesktop",r.ProcessAdvisor="ProcessAdvisor",r.SupplyChainVisibility="SupplyChainVisibility",r.SustainabilityCloud="SustainabilityCloud",r.Synapse="Synapse",r.TridentDataflow="TridentDataflow",r.TridentDataPipeline="TridentDataPipeline",r.TridentDataverseOneLake="TridentDataverseOneLake",r.TridentDataWarehouse="TridentDataWarehouse",r.TridentEventStream="TridentEventStream",r.TridentKusto="TridentKusto",r.TridentLakehouse="TridentLakehouse",r.TridentLakeWarehouse="TridentLakeWarehouse",r.TridentMountedDataWarehouse="TridentMountedDataWarehouse",r.TridentOneLake="TridentOneLake",r.TridentReplicator="TridentReplicator",r.TridentSynapseLink="TridentSynapseLink"}(Ua||(Ua={})),function(r){r.Boolean="Boolean"}(Vs||(Vs={})),function(r){r.NaN="NaN",r.NegativeInfinity="NegativeInfinity",r.PositiveInfinity="PositiveInfinity",r.FormattedNumber="FormattedNumber",r.Number="Number"}(Fs||(Fs={})),function(r){r.Access="Access",r.ActiveDirectory="ActiveDirectory",r.AdoDotNet="AdoDotNet",r.AdobeAnalytics="AdobeAnalytics",r.AnalysisServices="AnalysisServices",r.AzureBlobs="AzureBlobs",r.AzureDataLakeStorage="AzureDataLakeStorage",r.AzureTables="AzureTables",r.Cdpa="CDPA",r.CurrentWorkbook="CurrentWorkbook",r.DB2="DB2",r.Environment="Environment",r.Essbase="Essbase",r.Exchange="Exchange",r.File="File",r.Folder="Folder",r.Ftp="Ftp",r.GoogleAnalytics="GoogleAnalytics",r.HDInsight="HDInsight",r.Hdfs="Hdfs",r.Informix="Informix",r.MQ="MQ",r.MicrosoftInformationProtection="MicrosoftInformationProtection",r.MySql="MySql",r.OData="OData",r.Odbc="Odbc",r.OleDb="OleDb",r.Oracle="Oracle",r.PostgreSQL="PostgreSQL",r.PowerBIDataflow="PowerBI",r.Python="Python",r.R="R",r.Salesforce="Salesforce",r.SapBusinessWarehouse="SapBusinessWarehouse",r.SapHana="SapHana",r.SharePoint="SharePoint",r.Spark="Spark",r.Sql="SQL",r.Staging="Staging",r.Sybase="Sybase",r.Teradata="Teradata",r.Web="Web"}(As||(As={})),function(r){r.TemplateMetadata="Metadata.json",r.MashupDocument="MashupDocument.pq",r.MashupMetadata="MashupMetadata.json"}(Rs||(Rs={})),function(r){r.GroupNestingLimitReached="GroupNestingLimitReached",r.NullMashupXml="NullMashupXml",r.Unknown="Unknown"}(Ls||(Ls={})),function(r){r.CompletedSuccessfully="CompletedSuccessfully",r.CompletedWithExpectedError="CompletedWithExpectedError",r.CompletedWithUnexpectedError="CompletedWithUnexpectedError",r.Started="Started"}(Gs||(Gs={})),function(r){r.Above="Above",r.Below="Below"}(Ns||(Ns={})),function(r){r.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",r.NoProgramFound="NoProgramFound",r.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",r.RequestCanceled="RequestCanceled"}(Hs||(Hs={})),function(r){r.Ascii="Ascii",r.Utf8="Utf8",r.Utf16="Utf16",r.Windows="Windows"}(zs||(zs={})),function(r){r.Excel="Excel",r.Json="Json",r.Parquet="Parquet",r.Text="Text"}(sa||(sa={})),function(r){r.Colon="Colon",r.Comma="Comma",r.None="None",r.Semicolon="Semicolon",r.Space="Space",r.Tab="Tab"}(Bs||(Bs={})),function(r){r.Even="Even",r.Odd="Odd"}(Us||(Us={})),function(r){r.None="None",r.Private="Private",r.Organizational="Organizational",r.Public="Public"}(qs||(qs={})),function(r){r.ChangeModes="ChangeModes"}(Ws||(Ws={})),function(r){r.QueryNeedsToFold="QueryNeedsToFold"}(js||(js={})),function(r){r.AzureBlob="AzureBlob",r.Database="Database"}($s||($s={})),function(r){r.DynamicPlanFolded="DynamicPlanFolded",r.DynamicPlanMightFold="DynamicPlanMightFold",r.DynamicPlanNotFolded="DynamicPlanNotFolded",r.DynamicPlanOpaque="DynamicPlanOpaque",r.ErrorRetrievingPlan="ErrorRetrievingPlan",r.FoldedQueryNotImplemented="FoldedQueryNotImplemented",r.FoldedQueryNull="FoldedQueryNull",r.FoldedWithQuery="FoldedWithQuery",r.NotFolded="NotFolded",r.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",r.NotTable="NotTable",r.OpaqueConstant="OpaqueConstant",r.UnexpectedPlanKind="UnexpectedPlanKind"}(Qs||(Qs={})),function(r){r.ActiveDirectory="ActiveDirectory",r.AdobeAnalytics="AdobeAnalytics",r.AmazonRedshift="AmazonRedshift",r.AnalysisServices="AnalysisServices",r.AzureAnalysisServices="AzureAnalysisServices",r.AzureBlobs="AzureBlobs",r.AzureDataExplorer="AzureDataExplorer",r.AzureDataLakeStorage="AzureDataLakeStorage",r.AzureTables="AzureTables",r.AIFunctions="AIFunctions",r.AIInsights="AIInsights",r.AzureMLFunctions="AzureMLFunctions",r.AIInsightsInProc="AIInsightsInProc",r.Cds="Cds",r.CommonDataService="CommonDataService",r.DataLake="DataLake",r.Dataverse="Dataverse",r.DB2="DB2",r.ElasticSearch="ElasticSearch",r.Exchange="Exchange",r.Fhir="Fhir",r.File="File",r.Folder="Folder",r.GoogleAnalytics="GoogleAnalytics",r.GoogleBigQuery="GoogleBigQuery",r.HDInsight="HDInsight",r.Impala="Impala",r.Kusto="Kusto",r.Lakehouse="Lakehouse",r.MySql="MySql",r.OData="OData",r.Odbc="Odbc",r.Oracle="Oracle",r.OracleERP="OracleERP",r.PostgreSQL="PostgreSQL",r.PowerBI="PowerBI",r.PowerBIDatamarts="PowerBIDatamarts",r.PowerPlatformDataflows="PowerPlatformDataflows",r.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",r.Salesforce="Salesforce",r.SapBusinessWarehouse="SapBusinessWarehouse",r.SAPERP="SAPERP",r.SapHana="SapHana",r.SharePoint="SharePoint",r.Snowflake="Snowflake",r.Spark="Spark",r.SQL="SQL",r.Sybase="Sybase",r.Teradata="Teradata",r.Vertica="Vertica",r.Warehouse="Warehouse",r.Web="Web"}(Ks||(Ks={})),function(r){r.CompilationError="CompilationError",r.InvalidQueryName="InvalidQueryName",r.ParsingError="ParsingError",r.Success="Success",r.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Xs||(Xs={})),function(r){r.Failure="Failure",r.Success="Success"}(Zs||(Zs={})),function(r){r[r.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",r[r.httpError=1]="httpError",r[r.invalidInput=2]="invalidInput",r[r.maxRetriesReached=3]="maxRetriesReached",r[r.modelError=4]="modelError"}(Ys||(Ys={})),function(r){r.Error="Error",r.Ok="Ok"}(Js||(Js={})),function(r){r.Default="Default",r.FastCopy="FastCopy"}(el||(el={})),function(r){r.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",r.DuplicateQueryId="DuplicateQueryId",r.DuplicateQueryName="DuplicateQueryName",r.DuplicateStepName="DuplicateStepName",r.InvalidQueryName="InvalidQueryName",r.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",r.ParsingError="ParsingError",r.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(tl||(tl={})),function(r){r.Custom="Custom",r.DropColumn="DropColumn",r.DropBlankRows="DropBlankRows",r.DropDuplicates="DropDuplicates",r.FillColumn="FillColumn",r.SplitColumn="SplitColumn",r.UnpivotColumns="UnpivotColumns",r.UnpivotOtherColumns="UnpivotOtherColumns"}(nl||(nl={})),function(r){r.Column="Column",r.ColumnType="ColumnType",r.Count="Count",r.ErrorCount="ErrorCount",r.NullCount="NullCount",r.DistinctCount="DistinctCount",r.UniqueCount="UniqueCount",r.Min="Min",r.Max="Max",r.ValueDistribution="ValueDistribution",r.Average="Average",r.EmptyStringCount="EmptyStringCount",r.TextLengthDistribution="TextLengthDistribution",r.NaNCount="NaNCount",r.ZeroCount="ZeroCount",r.EvenCount="EvenCount",r.OddCount="OddCount",r.StandardDeviation="StandardDeviation",r.SignDistribution="SignDistribution",r.ParityDistribution="ParityDistribution",r.TrueCount="TrueCount",r.FalseCount="FalseCount",r.YearDistribution="YearDistribution",r.MonthDistribution="MonthDistribution",r.DayDistribution="DayDistribution",r.WeekOfYearDistribution="WeekOfYearDistribution",r.DayOfWeekDistribution="DayOfWeekDistribution",r.AmPmDistribution="AmPmDistribution",r.HourDistribution="HourDistribution"}(rl||(rl={})),function(r){r.AppendRows="AppendRows",r.ReplaceRows="ReplaceRows",r.UpsertRows="UpsertRows"}(il||(il={})),function(r){r.SelectRows="SelectRows",r.Sort="Sort",r.SelectColumns="SelectColumns",r.RenameColumns="RenameColumns",r.AddColumn="AddColumn",r.ReplaceColumns="ReplaceColumns",r.ReplaceRows="ReplaceRows",r.AddRows="AddRows",r.SplitColumn="SplitColumn",r.ReplaceTable="ReplaceTable"}(ol||(ol={})),function(r){r.InvocationPattern="InvocationPattern",r.Script="Script"}(al||(al={})),function(r){r.DataSourceTag="DataSourceTag",r.QueryEditorMessageBar="QueryEditorMessageBar",r.QuickCreateForm="QuickCreateForm",r.WebByExampleForm="WebByExampleForm"}(sl||(sl={})),function(r){r.Append="Append",r.Replace="Replace"}(ll||(ll={})),function(r){r.CompilationError="CompilationError",r.ParsingError="ParsingError",r.Success="Success",r.UnexpectedDocumentKind="UnexpectedDocumentKind"}(cl||(cl={})),function(r){r.Link="Link",r.Text="Text"}(ul||(ul={}))},70049:function(Pt,vt,m){"use strict";m.d(vt,{P:function(){return F},d:function(){return e}});var M=m(37419),u=m(73449),e={leading:!0,trailing:!1};function F(Re,Be){return void 0===Be&&(Be=e),function(Ee){return Ee.lift(new oe(Re,!!Be.leading,!!Be.trailing))}}var oe=function(){function Re(Ee,pe,R){this.durationSelector=Ee,this.leading=pe,this.trailing=R}return Re.prototype.call=function(pe,R){return R.subscribe(new D(pe,this.durationSelector,this.leading,this.trailing))},Re}(),D=function(Re){function Be(pe,R,Fe,De){var G;return(G=Re.call(this,pe)||this).destination=pe,G.durationSelector=R,G._leading=Fe,G._trailing=De,G._hasValue=!1,G}(0,M.Z)(Be,Re);var Ee=Be.prototype;return Ee._next=function(R){this._hasValue=!0,this._sendValue=R,this._throttled||(this._leading?this.send():this.throttle(R))},Ee.send=function(){var Fe=this._sendValue;this._hasValue&&(this.destination.next(Fe),this.throttle(Fe)),this._hasValue=!1,this._sendValue=void 0},Ee.throttle=function(R){var Fe=this.tryDurationSelector(R);Fe&&this.add(this._throttled=(0,u.ft)(Fe,new u.IY(this)))},Ee.tryDurationSelector=function(R){try{return this.durationSelector(R)}catch(Fe){return this.destination.error(Fe),null}},Ee.throttlingDone=function(){var R=this._throttled,Fe=this._trailing;R&&R.unsubscribe(),this._throttled=void 0,Fe&&this.send()},Ee.notifyNext=function(){this.throttlingDone()},Ee.notifyComplete=function(){this.throttlingDone()},Be}(u.Ds)},55862:function(Pt,vt,m){"use strict";m.d(vt,{p:function(){return oe}});var M=m(37419),u=m(47875),e=m(96721),F=m(70049);function oe(Ee,pe,R){return void 0===pe&&(pe=e.P),void 0===R&&(R=F.d),function(Fe){return Fe.lift(new D(Ee,pe,R.leading,R.trailing))}}var D=function(){function Ee(R,Fe,De,G){this.duration=R,this.scheduler=Fe,this.leading=De,this.trailing=G}return Ee.prototype.call=function(Fe,De){return De.subscribe(new Re(Fe,this.duration,this.scheduler,this.leading,this.trailing))},Ee}(),Re=function(Ee){function pe(Fe,De,G,We,Ue){var ne;return(ne=Ee.call(this,Fe)||this).duration=De,ne.scheduler=G,ne.leading=We,ne.trailing=Ue,ne._hasTrailingValue=!1,ne._trailingValue=null,ne}(0,M.Z)(pe,Ee);var R=pe.prototype;return R._next=function(De){this.throttled?this.trailing&&(this._trailingValue=De,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Be,this.duration,{subscriber:this})),this.leading?this.destination.next(De):this.trailing&&(this._trailingValue=De,this._hasTrailingValue=!0))},R._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},R.clearThrottle=function(){var De=this.throttled;De&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),De.unsubscribe(),this.remove(De),this.throttled=null)},pe}(u.L);function Be(Ee){Ee.subscriber.clearThrottle()}},73088:function(Pt,vt,m){"use strict";m.d(vt,{F:function(){return u}});var u=new(m(50423).InjectionToken)("ScorecardActionsService")},62113:function(Pt,vt,m){"use strict";m.d(vt,{Q:function(){return Ke}});var R,Q,M=m(81337),u=m(29019),e=m(66422),F=m(37241),oe=m(41170),D_clientInfoDecodingError_code="client_info_decoding_error",D_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",D_clientInfoEmptyError_code="client_info_empty_error",D_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",D_tokenParsingError_code="token_parsing_error",D_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",D_nullOrEmptyToken_code="null_or_empty_token",D_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",D_endpointResolutionError_code="endpoints_resolution_error",D_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",D_networkError_code="network_error",D_networkError_desc="Network request failed. Please check network trace to determine root cause.",D_unableToGetOpenidConfigError_code="openid_config_error",D_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",D_hashNotDeserialized_code="hash_not_deserialized",D_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",D_invalidStateError_code="invalid_state",D_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",D_stateMismatchError_code="state_mismatch",D_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",D_stateNotFoundError_code="state_not_found",D_stateNotFoundError_desc="State not found",D_nonceMismatchError_code="nonce_mismatch",D_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",D_nonceNotFoundError_code="nonce_not_found",D_nonceNotFoundError_desc="nonce not found",D_multipleMatchingTokens_code="multiple_matching_tokens",D_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",D_multipleMatchingAccounts_code="multiple_matching_accounts",D_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",D_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",D_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",D_tokenRequestCannotBeMade_code="request_cannot_be_made",D_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",D_appendEmptyScopeError_code="cannot_append_empty_scope",D_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",D_removeEmptyScopeError_code="cannot_remove_empty_scope",D_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",D_appendScopeSetError_code="cannot_append_scopeset",D_appendScopeSetError_desc="Cannot append ScopeSet due to error.",D_emptyInputScopeSetError_code="empty_input_scopeset",D_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",D_DeviceCodePollingCancelled_code="device_code_polling_cancelled",D_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",D_DeviceCodeExpired_code="device_code_expired",D_DeviceCodeExpired_desc="Device code is expired.",D_DeviceCodeUnknownError_code="device_code_unknown_error",D_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",D_NoAccountInSilentRequest_code="no_account_in_silent_request",D_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",D_invalidCacheRecord_code="invalid_cache_record",D_invalidCacheRecord_desc="Cache record object was null or undefined.",D_invalidCacheEnvironment_code="invalid_cache_environment",D_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",D_noAccountFound_code="no_account_found",D_noAccountFound_desc="No account found in cache for given key.",D_CachePluginError_code="no cache plugin set on CacheManager",D_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",D_noCryptoObj_code="no_crypto_object",D_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",D_invalidCacheType_code="invalid_cache_type",D_invalidCacheType_desc="Invalid cache type",D_unexpectedAccountType_code="unexpected_account_type",D_unexpectedAccountType_desc="Unexpected account type.",D_unexpectedCredentialType_code="unexpected_credential_type",D_unexpectedCredentialType_desc="Unexpected credential type.",D_invalidAssertion_code="invalid_assertion",D_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",D_invalidClientCredential_code="invalid_client_credential",D_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",D_tokenRefreshRequired_code="token_refresh_required",D_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",D_userTimeoutReached_code="user_timeout_reached",D_userTimeoutReached_desc="User defined timeout for device code polling reached",D_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",D_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",D_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",D_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",D_bindingKeyNotRemovedError_code="binding_key_not_removed",D_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",D_logoutNotSupported_code="end_session_endpoint_not_supported",D_logoutNotSupported_desc="Provided authority does not support logout.",D_keyIdMissing_code="key_id_missing",D_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",Re=function(Q){function K(ee,ae){var fe=Q.call(this,ee,ae)||this;return fe.name="ClientAuthError",Object.setPrototypeOf(fe,K.prototype),fe}return(0,F.ZT)(K,Q),K.createClientInfoDecodingError=function(ee){return new K(D_clientInfoDecodingError_code,D_clientInfoDecodingError_desc+" Failed with error: "+ee)},K.createClientInfoEmptyError=function(){return new K(D_clientInfoEmptyError_code,""+D_clientInfoEmptyError_desc)},K.createTokenParsingError=function(ee){return new K(D_tokenParsingError_code,D_tokenParsingError_desc+" Failed with error: "+ee)},K.createTokenNullOrEmptyError=function(ee){return new K(D_nullOrEmptyToken_code,D_nullOrEmptyToken_desc+" Raw Token Value: "+ee)},K.createEndpointDiscoveryIncompleteError=function(ee){return new K(D_endpointResolutionError_code,D_endpointResolutionError_desc+" Detail: "+ee)},K.createNetworkError=function(ee,ae){return new K(D_networkError_code,D_networkError_desc+" | Fetch client threw: "+ae+" | Attempted to reach: "+ee.split("?")[0])},K.createUnableToGetOpenidConfigError=function(ee){return new K(D_unableToGetOpenidConfigError_code,D_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+ee)},K.createHashNotDeserializedError=function(ee){return new K(D_hashNotDeserialized_code,D_hashNotDeserialized_desc+" Given Object: "+ee)},K.createInvalidStateError=function(ee,ae){return new K(D_invalidStateError_code,D_invalidStateError_desc+" Invalid State: "+ee+", Root Err: "+ae)},K.createStateMismatchError=function(){return new K(D_stateMismatchError_code,D_stateMismatchError_desc)},K.createStateNotFoundError=function(ee){return new K(D_stateNotFoundError_code,D_stateNotFoundError_desc+":  "+ee)},K.createNonceMismatchError=function(){return new K(D_nonceMismatchError_code,D_nonceMismatchError_desc)},K.createNonceNotFoundError=function(ee){return new K(D_nonceNotFoundError_code,D_nonceNotFoundError_desc+":  "+ee)},K.createMultipleMatchingTokensInCacheError=function(){return new K(D_multipleMatchingTokens_code,D_multipleMatchingTokens_desc+".")},K.createMultipleMatchingAccountsInCacheError=function(){return new K(D_multipleMatchingAccounts_code,D_multipleMatchingAccounts_desc)},K.createMultipleMatchingAppMetadataInCacheError=function(){return new K(D_multipleMatchingAppMetadata_code,D_multipleMatchingAppMetadata_desc)},K.createTokenRequestCannotBeMadeError=function(){return new K(D_tokenRequestCannotBeMade_code,D_tokenRequestCannotBeMade_desc)},K.createAppendEmptyScopeToSetError=function(ee){return new K(D_appendEmptyScopeError_code,D_appendEmptyScopeError_desc+" Given Scope: "+ee)},K.createRemoveEmptyScopeFromSetError=function(ee){return new K(D_removeEmptyScopeError_code,D_removeEmptyScopeError_desc+" Given Scope: "+ee)},K.createAppendScopeSetError=function(ee){return new K(D_appendScopeSetError_code,D_appendScopeSetError_desc+" Detail Error: "+ee)},K.createEmptyInputScopeSetError=function(){return new K(D_emptyInputScopeSetError_code,""+D_emptyInputScopeSetError_desc)},K.createDeviceCodeCancelledError=function(){return new K(D_DeviceCodePollingCancelled_code,""+D_DeviceCodePollingCancelled_desc)},K.createDeviceCodeExpiredError=function(){return new K(D_DeviceCodeExpired_code,""+D_DeviceCodeExpired_desc)},K.createDeviceCodeUnknownError=function(){return new K(D_DeviceCodeUnknownError_code,""+D_DeviceCodeUnknownError_desc)},K.createNoAccountInSilentRequestError=function(){return new K(D_NoAccountInSilentRequest_code,""+D_NoAccountInSilentRequest_desc)},K.createNullOrUndefinedCacheRecord=function(){return new K(D_invalidCacheRecord_code,D_invalidCacheRecord_desc)},K.createInvalidCacheEnvironmentError=function(){return new K(D_invalidCacheEnvironment_code,D_invalidCacheEnvironment_desc)},K.createNoAccountFoundError=function(){return new K(D_noAccountFound_code,D_noAccountFound_desc)},K.createCachePluginError=function(){return new K(D_CachePluginError_code,""+D_CachePluginError_desc)},K.createNoCryptoObjectError=function(ee){return new K(D_noCryptoObj_code,""+D_noCryptoObj_desc+ee)},K.createInvalidCacheTypeError=function(){return new K(D_invalidCacheType_code,""+D_invalidCacheType_desc)},K.createUnexpectedAccountTypeError=function(){return new K(D_unexpectedAccountType_code,""+D_unexpectedAccountType_desc)},K.createUnexpectedCredentialTypeError=function(){return new K(D_unexpectedCredentialType_code,""+D_unexpectedCredentialType_desc)},K.createInvalidAssertionError=function(){return new K(D_invalidAssertion_code,""+D_invalidAssertion_desc)},K.createInvalidCredentialError=function(){return new K(D_invalidClientCredential_code,""+D_invalidClientCredential_desc)},K.createRefreshRequiredError=function(){return new K(D_tokenRefreshRequired_code,D_tokenRefreshRequired_desc)},K.createUserTimeoutReachedError=function(){return new K(D_userTimeoutReached_code,D_userTimeoutReached_desc)},K.createTokenClaimsRequiredError=function(){return new K(D_tokenClaimsRequired_code,D_tokenClaimsRequired_desc)},K.createNoAuthCodeInServerResponseError=function(){return new K(D_noAuthorizationCodeFromServer_code,D_noAuthorizationCodeFromServer_desc)},K.createBindingKeyNotRemovedError=function(){return new K(D_bindingKeyNotRemovedError_code,D_bindingKeyNotRemovedError_desc)},K.createLogoutNotSupportedError=function(){return new K(D_logoutNotSupported_code,D_logoutNotSupported_desc)},K.createKeyIdMissingError=function(){return new K(D_keyIdMissing_code,D_keyIdMissing_desc)},K}(oe.l),Be=function(){function Q(){}return Q.decodeAuthToken=function(K){if(Q.isEmpty(K))throw Re.createTokenNullOrEmptyError(K);var ae=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(K);if(!ae||ae.length<4)throw Re.createTokenParsingError("Given token is malformed: "+JSON.stringify(K));return{header:ae[1],JWSPayload:ae[2],JWSSig:ae[3]}},Q.isEmpty=function(K){return typeof K>"u"||!K||0===K.length},Q.isEmptyObj=function(K){if(K&&!Q.isEmpty(K))try{var ee=JSON.parse(K);return 0===Object.keys(ee).length}catch{}return!0},Q.startsWith=function(K,ee){return 0===K.indexOf(ee)},Q.endsWith=function(K,ee){return K.length>=ee.length&&K.lastIndexOf(ee)===K.length-ee.length},Q.queryStringToObject=function(K){var ee={},ae=K.split("&"),fe=function($e){return decodeURIComponent($e.replace(/\+/g," "))};return ae.forEach(function(me){if(me.trim()){var $e=me.split(/=(.+)/g,2),ct=$e[0],Ct=$e[1];ct&&Ct&&(ee[fe(ct)]=fe(Ct))}}),ee},Q.trimArrayEntries=function(K){return K.map(function(ee){return ee.trim()})},Q.removeEmptyStringsFromArray=function(K){return K.filter(function(ee){return!Q.isEmpty(ee)})},Q.jsonParseHelper=function(K){try{return JSON.parse(K)}catch{return null}},Q.matchPattern=function(K,ee){return new RegExp(K.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(ee)},Q}();(Q=R||(R={}))[Q.Default=0]="Default",Q[Q.Adfs=1]="Adfs";var Fe=function(){function Q(){}return Q.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(e.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},Q.prototype.generateAccountKey=function(){return Q.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},Q.prototype.generateType=function(){switch(this.authorityType){case e.iR.ADFS_ACCOUNT_TYPE:return e.LL.ADFS;case e.iR.MSAV1_ACCOUNT_TYPE:return e.LL.MSA;case e.iR.MSSTS_ACCOUNT_TYPE:return e.LL.MSSTS;case e.iR.GENERIC_ACCOUNT_TYPE:return e.LL.GENERIC;default:throw Re.createUnexpectedAccountTypeError()}},Q.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},Q.generateAccountCacheKey=function(K){return[K.homeAccountId,K.environment||e.gT.EMPTY_STRING,K.tenantId||e.gT.EMPTY_STRING].join(e.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},Q.createAccount=function(K,ee,ae,fe,me,$e,ct,Ct,Me){var Ge,Te,Ve,_t,yt,tt,zt=new Q;zt.authorityType=e.iR.MSSTS_ACCOUNT_TYPE,zt.clientInfo=K,zt.homeAccountId=ee,zt.nativeAccountId=Me;var k=Ct||fe&&fe.getPreferredCache();if(!k)throw Re.createInvalidCacheEnvironmentError();return zt.environment=k,zt.realm=(null===(Ge=ae?.claims)||void 0===Ge?void 0:Ge.tid)||e.gT.EMPTY_STRING,zt.oboAssertion=me,ae&&(zt.idTokenClaims=ae.claims,zt.localAccountId=(null===(Te=ae?.claims)||void 0===Te?void 0:Te.oid)||(null===(Ve=ae?.claims)||void 0===Ve?void 0:Ve.sub)||e.gT.EMPTY_STRING,zt.username=(null===(_t=ae?.claims)||void 0===_t?void 0:_t.preferred_username)||(null!==(yt=ae?.claims)&&void 0!==yt&&yt.emails?ae.claims.emails[0]:e.gT.EMPTY_STRING),zt.name=null===(tt=ae?.claims)||void 0===tt?void 0:tt.name),zt.cloudGraphHostName=$e,zt.msGraphHost=ct,zt},Q.createGenericAccount=function(K,ee,ae,fe,me,$e,ct){var Ct,Me,Ge,Te,Ve=new Q;Ve.authorityType=ae&&ae.authorityType===R.Adfs?e.iR.ADFS_ACCOUNT_TYPE:e.iR.GENERIC_ACCOUNT_TYPE,Ve.homeAccountId=K,Ve.realm=e.gT.EMPTY_STRING,Ve.oboAssertion=fe;var _t=ct||ae&&ae.getPreferredCache();if(!_t)throw Re.createInvalidCacheEnvironmentError();return ee&&(Ve.localAccountId=(null===(Ct=ee?.claims)||void 0===Ct?void 0:Ct.oid)||(null===(Me=ee?.claims)||void 0===Me?void 0:Me.sub)||e.gT.EMPTY_STRING,Ve.username=(null===(Ge=ee?.claims)||void 0===Ge?void 0:Ge.upn)||e.gT.EMPTY_STRING,Ve.name=(null===(Te=ee?.claims)||void 0===Te?void 0:Te.name)||e.gT.EMPTY_STRING,Ve.idTokenClaims=ee?.claims),Ve.environment=_t,Ve.cloudGraphHostName=me,Ve.msGraphHost=$e,Ve},Q.generateHomeAccountId=function(K,ee,ae,fe,me){var $e,ct=null!==($e=me?.claims)&&void 0!==$e&&$e.sub?me.claims.sub:e.gT.EMPTY_STRING;if(ee===R.Adfs)return ct;if(K)try{var Ct=function(Q,K){if(Be.isEmpty(Q))throw Re.createClientInfoEmptyError();try{var ee=K.base64Decode(Q);return JSON.parse(ee)}catch(ae){throw Re.createClientInfoDecodingError(ae)}}(K,fe);if(!Be.isEmpty(Ct.uid)&&!Be.isEmpty(Ct.utid))return""+Ct.uid+e.Bv.CLIENT_INFO_SEPARATOR+Ct.utid}catch{}return ae.verbose("No client info in response"),ct},Q.isAccountEntity=function(K){return!!K&&K.hasOwnProperty("homeAccountId")&&K.hasOwnProperty("environment")&&K.hasOwnProperty("realm")&&K.hasOwnProperty("localAccountId")&&K.hasOwnProperty("username")&&K.hasOwnProperty("authorityType")},Q.accountInfoIsEqual=function(K,ee,ae){if(!K||!ee)return!1;var fe=!0;if(ae){var me=K.idTokenClaims||{},$e=ee.idTokenClaims||{};fe=me.iat===$e.iat&&me.nonce===$e.nonce}return K.homeAccountId===ee.homeAccountId&&K.localAccountId===ee.localAccountId&&K.username===ee.username&&K.tenantId===ee.tenantId&&K.environment===ee.environment&&K.nativeAccountId===ee.nativeAccountId&&fe},Q}(),De=m(98665),G=m(98049),We=m(19270),Ue=m(66070),ne=function(Q){function K(ee,ae){var fe=Q.call(this,ee)||this;return fe.message=ee,fe.msalError=ae,fe}return(0,M.__extends)(K,Q),K}(Error),se=m(41114),ve="PBI.App.AdHocTokenAcquisition",Se=se.cx[ve]=(0,se.b1)(ve),W="PBI.App.AdHocTokenAcquisition.UserConfirmation",He=se.cx[W]=(0,se.b1)(W),he=m(50423),ye=m(58938),je=m(65181),rt=window,Ke=function(){function Q(K,ee,ae){this.dialogService=K,this.localizationService=ee,this.telemetryService=ae,this.msalClientApplication=rt.msalClientApplication}return Q.prototype.acquireToken=function(K,ee,ae){var fe;return void 0===ae&&(ae=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var me,$e,ct,Ct,Me;return(0,M.__generator)(this,function(Ge){switch(Ge.label){case 0:if(me=this.retrieveSignedInAccount(),$e=this.telemetryService.startActivity(null,Se,{scenarioName:K,authMethod:"Silent"}),!me)return[3,5];Ge.label=1;case 1:return Ge.trys.push([1,3,,4]),[4,this.msalClientApplication.acquireTokenSilent({scopes:ee,account:me,forceRefresh:ae})];case 2:return ct=Ge.sent(),$e.resolve(),[2,{token:ct.accessToken,expiry:ct.expiresOn}];case 3:throw(Ct=Ge.sent()).constructor.name===u.Yo.name?($e.reject({errorSource:"External",errorMessage:Me=We.fW.UserInteractionRequired,errorCode:"UserInteractionRequired"}),new ne(Me,Ct)):(Me=null!==(fe=Ct.message)&&void 0!==fe?fe:Ct,$e.reject({errorSource:"External",errorMessage:Me,errorCode:Ct.code}),new ne("Error code: ".concat(Ct.code,", error message: ").concat(Me),Ct));case 4:return[3,6];case 5:throw $e.reject({errorSource:"PowerBI",errorMessage:Me=We.fW.UserNotSignedIn,errorCode:"UserNotSignedIn"}),Error(Me);case 6:return[2]}})})},Q.prototype.acquireTokenPopup=function(K,ee){return(0,M.__awaiter)(this,void 0,void 0,function(){var ae=this;return(0,M.__generator)(this,function(fe){return[2,Ue.kB.retryOnInteractionInProgressError(function(){return ae.acquireTokenPopupInternal(K,ee)})]})})},Q.prototype.acquireTokenPopupInternal=function(K,ee){var ae;return(0,M.__awaiter)(this,void 0,void 0,function(){var me,$e,ct,Ct,Me,Ge;return(0,M.__generator)(this,function(Te){switch(Te.label){case 0:return[4,this.dialogService.open(G.J,{data:{title:this.localizationService.get("AcquireToken_Dialog_VerifyIdentity"),ariaLabel:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),message:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),cancelButtonText:this.localizationService.get("ModalDialog_Cancel")},autoFocus:!0}).afterClosed().toPromise()];case 1:if(me=Te.sent(),this.telemetryService.logEvent(He,{scenarioName:K,authMethod:"Popup",result:1===me}),1!==me)throw Error(We.fW.UserInteractionDeclined);$e=this.retrieveSignedInAccount(),ct=this.telemetryService.startActivity(null,Se,{scenarioName:K,authMethod:"Popup"}),Te.label=2;case 2:return Te.trys.push([2,4,,5]),[4,this.msalClientApplication.acquireTokenPopup({scopes:ee,account:$e})];case 3:return Ct=Te.sent(),this.msalClientApplication.setActiveAccount(Ct.account),[3,5];case 4:throw Me=Te.sent(),Ge=null!==(ae=Me.message)&&void 0!==ae?ae:Me,ct.reject({errorSource:"External",errorMessage:Ge,errorCode:Me.code}),new ne("Error code: ".concat(Me.code,", error message: ").concat(Ge),Me);case 5:if(!Fe.accountInfoIsEqual($e??null,Ct.account))throw ct.reject({errorSource:"External",errorMessage:We.fW.UserAccountChanged,errorCode:"UserAccountChanged"}),this.reloadPage(),Error(We.fW.UserAccountChanged);return ct.resolve(),[2,{token:Ct.accessToken,expiry:Ct.expiresOn}]}})})},Q.prototype.reloadPage=function(){window.location.reload()},Q.prototype.retrieveSignedInAccount=function(){return rt.signInProviderService.retrieveSignedInAccount()},Q.\u0275fac=function(ee){return new(ee||Q)(he.\u0275\u0275inject(ye.x),he.\u0275\u0275inject(je.o),he.\u0275\u0275inject(De.y0))},Q.\u0275prov=he.\u0275\u0275defineInjectable({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q}()},19178:function(Pt,vt,m){"use strict";m.d(vt,{Y:function(){return We}});var M=m(81337),u=m(82515),e=m(74076),F=m(40898),oe=m(82762),D=m(11547),Re=m(59017),Be=m(81905),Ee=m(14172),pe=m(48787),R=m(41198),Fe=m(23558),De=m(50423),G=m(85732),We=function(){function Ue(ne){this.store=ne}return Object.defineProperty(Ue.prototype,"selectedGroup$",{get:function(){return this.store.select(e.S6)},enumerable:!1,configurable:!0}),Object.defineProperty(Ue.prototype,"selectedFolderId$",{get:function(){return this.store.select(e.CW)},enumerable:!1,configurable:!0}),Object.defineProperty(Ue.prototype,"myFolderObjectId$",{get:function(){return this.store.select(e.iF)},enumerable:!1,configurable:!0}),Object.defineProperty(Ue.prototype,"nonMyWorkspaces$",{get:function(){return this.store.select(e.c_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ue.prototype,"myWorkspace$",{get:function(){return this.store.select(e.Au)},enumerable:!1,configurable:!0}),Ue.prototype.foldersWithEditPermissions=function(ne){var se=this;return(0,oe.D)(this.ensureWorkspacesLoaded()).pipe((0,Be.w)(function(){return(0,Re.aj)([se.store.select(F.Ou),ne?se.store.select(e.Ze):(0,D.of)(null)])}),(0,Ee.U)(function(ve){var W=ve[1],He=_(ve[0]).filter(function(he){return!W||!_.isEqual(he,W)}).sortBy(function(he){return he.displayName.toLocaleLowerCase()}).value();return W?(0,M.__spreadArray)([W],He,!0):He}))},Ue.prototype.add=function(ne,se){this.store.dispatch(new u.mm({group:ne,isFolder:se}))},Object.defineProperty(Ue.prototype,"folders",{get:function(){return this.store.select(F.xh).pipe((0,Ee.U)(function(se){return _.map(Object.keys(se),function(ve){return se[ve]})}))},enumerable:!1,configurable:!0}),Ue.prototype.remove=function(ne){this.store.dispatch(new u.JW(ne))},Ue.prototype.update=function(ne){this.store.dispatch(new u.BN(ne))},Ue.prototype.updateGroup=function(ne){this.store.dispatch(new u.bn(ne))},Ue.prototype.updatePartialWorkspaces=function(ne){this.store.dispatch(new u.ZG(ne))},Ue.prototype.load=function(ne){this.store.dispatch(new u.q5({groupId:ne}))},Ue.prototype.getGroupById=function(ne){return this.store.select(e.VL,{id:ne})},Ue.prototype.getAllNonEmptyDomains=function(){return this.store.select(e.vL)},Ue.prototype.addDomainFilters=function(ne){this.store.dispatch(new u.qC({domainObjectIds:ne}))},Ue.prototype.deleteDomainFilters=function(ne){this.store.dispatch(new u.tk({domainObjectIds:ne}))},Ue.prototype.getGroupObjectId=function(ne){return this.store.select(e.cM).pipe((0,Be.w)(function(se){for(var ve in se){var Se=se[ve];if(Se.id===ne)return(0,D.of)(Se?.objectId)}return(0,D.of)(void 0)}),(0,pe.q)(1))},Ue.prototype.loadSuccess=function(ne,se,ve,Se){this.store.dispatch(new u.Xt({id:ne,group:se,folderId:ve,permissions:Se}))},Ue.prototype.loadSuccessBasedOnWorkspaceContext=function(ne,se){var ve=this;this.store.select(e.ve).pipe((0,pe.q)(1)).subscribe(function(Se){ve.store.dispatch(new u.Xt(Se?{id:ne,group:se,folderId:void 0,permissions:void 0,currentWorkspaceType:"folder"}:{id:ne,group:se,folderId:void 0,permissions:void 0,currentWorkspaceType:"group"}))})},Ue.prototype.select=function(ne){this.store.dispatch(new u.Ph({id:ne}))},Ue.prototype.switch=function(ne,se){this.store.dispatch(new u.q_({groupId:ne,groupSwitchOptions:se}))},Ue.prototype.ensureGroupArtifactsLoaded=function(ne,se){var ve=this;return this.store.select(e.s4).pipe((0,R.n)(function(Se){return!Se}),(0,pe.q)(1)).subscribe(function(){ve.store.dispatch(new u._S({groupObjectId:ne,refreshIfStale:!1,addArtifacts:se}))}),this.store.select(e.VL,{id:ne}).pipe((0,Fe.M)(this.store.select(e.Uy)),(0,R.n)(function(Se){var W=Se[0];return!W||!(W.loaded&&(!se||!0===Se[1]))}),(0,pe.q)(1),(0,Ee.U)(function(){return!0})).toPromise()},Ue.prototype.ensureGroupArtifactsLoadedOrError=function(ne){var se=this;return this.store.select(e.s4).pipe((0,R.n)(function(ve){return!ve}),(0,pe.q)(1)).subscribe(function(){se.store.dispatch(new u._S({groupObjectId:ne,refreshIfStale:!1}))}),this.store.select(e.VL,{id:ne}).pipe((0,R.n)(function(ve){return!ve||!ve.loaded&&!ve.loadedWithError}),(0,pe.q)(1),(0,Ee.U)(function(){return!0})).toPromise()},Ue.prototype.ensureGroupSelectedAndLoaded=function(ne){return this.store.select(e.S6).pipe((0,R.n)(function(se){return!se||!se.loaded||se.objectId!==ne}),(0,pe.q)(1),(0,Ee.U)(function(){return!0})).toPromise()},Ue.prototype.ensureWorkspacesLoaded=function(){var ne=this;return this.store.select(e.LD).pipe((0,R.n)(function(se){return!se||se.loading}),(0,pe.q)(1)).subscribe(function(se){se.loaded||ne.store.dispatch(new u.Us)}),this.store.select(e.LD).pipe((0,R.n)(function(se){return!se||!se.loaded}),(0,pe.q)(1),(0,Ee.U)(function(){return!0})).toPromise()},Ue.prototype.forceReloadWorkspaces=function(){return this.store.dispatch(new u.Us),this.store.select(e.LD).pipe((0,R.n)(function(ne){return!ne||!ne.loaded}),(0,pe.q)(1),(0,Ee.U)(function(){return!0})).toPromise()},Ue.prototype.updateMyWorkSpaceCapacity=function(ne){this.store.dispatch(new u.Vd(ne))},Ue.prototype.loadFoldersSuccess=function(ne){this.store.dispatch(new u.uw(ne))},Ue.prototype.hide=function(ne){this.store.dispatch(new u.c({group:ne}))},Ue.prototype.unhide=function(ne){this.store.dispatch(new u.yO({group:ne}))},Ue.\u0275fac=function(se){return new(se||Ue)(De.\u0275\u0275inject(G.yh))},Ue.\u0275prov=De.\u0275\u0275defineInjectable({token:Ue,factory:Ue.\u0275fac,providedIn:"root"}),Ue}()},98187:function(Pt,vt,m){"use strict";m.d(vt,{z:function(){return Re}});var M=m(81337),u=m(14463),e=m(59055),F=m(98665),oe=m(50423),D=m(629),Re=function(){function Be(Ee,pe,R){this.promiseFactory=Ee,this.telemetryService=pe,this.httpService=R}return Be.prototype.emailIsInVerifiedDomain=function(Ee){return(0,M.__awaiter)(this,void 0,void 0,function(){var pe,R;return(0,M.__generator)(this,function(De){switch(De.label){case 0:pe=this.promiseFactory.defer(),De.label=1;case 1:return De.trys.push([1,3,,4]),[4,this.getVerifiedDomains()];case 2:return R=De.sent(),pe.resolve(this.verifyEmailInGivenVerifiedDomains(Ee,R)),[3,4];case 3:return De.sent(),pe.reject(),[3,4];case 4:return[2,pe.promise]}})})},Be.prototype.getVerifiedDomains=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var Ee,pe,R,Fe,De,G;return(0,M.__generator)(this,function(Ue){switch(Ue.label){case 0:return this.verifiedDomainsPromise?[2,this.verifiedDomainsPromise]:[3,1];case 1:Ee=this.promiseFactory.defer(),pe=this.telemetryService.startEvent(e.f8),R=this.httpService.powerbiRequestOptions(pe.event,"TenantVerifiedDomains"),Ue.label=2;case 2:return Ue.trys.push([2,4,,5]),[4,this.httpService.get("powerbi/invitation/verifiedDomains",R)];case 3:return Fe=Ue.sent(),De={verifiedDomains:{},blockedDomains:{}},(G=Fe.data).verifiedDomains&&G.verifiedDomains.map(function(ne){var se=ne.toUpperCase();return De.verifiedDomains[se]=se,se}),G.blockedDomains&&G.blockedDomains.map(function(ne){var se=ne.toUpperCase();return De.blockedDomains[se]=se,se}),Ee.resolve(De),pe.resolve(),[3,5];case 4:return Ue.sent(),Ee.reject(),[3,5];case 5:return this.verifiedDomainsPromise=Ee.promise,[2,this.verifiedDomainsPromise]}})})},Be.prototype.verifyEmailInGivenVerifiedDomains=function(Ee,pe){var R=Ee.split("@");return!(!pe||!_.isEmpty(pe.verifiedDomains))||R.length>1&&pe&&!!pe.verifiedDomains[R[1].toUpperCase()]},Be.\u0275fac=function(pe){return new(pe||Be)(oe.\u0275\u0275inject(u.t),oe.\u0275\u0275inject(F.y0),oe.\u0275\u0275inject(D.M))},Be.\u0275prov=oe.\u0275\u0275defineInjectable({token:Be,factory:Be.\u0275fac,providedIn:"root"}),Be}()},93864:function(Pt,vt,m){"use strict";m.d(vt,{t:function(){return Dt}});var M=m(81337),u=m(41114),e="PBI.EmailsList.PasteInfo",F=u.cx[e]=(0,u.b1)(e),oe=m(93247),D=m(50423),Re=m(17174),Be=m(89075),Ee=m(35911),pe=m(2142),R=m(73221),Fe=m(98665),De=m(35510),G=m(30794),We=m(40133),Ue=m(11547),ne=m(58417),se=m(82762),ve=m(37272),W=m(14172),He=m(77526),he=m(57243),ye=m(55862),je=m(81905),rt=m(22318),Ke=m(6663),Q=m(59973),K=m(83317),ee=m(17653),ae=m(42195),fe=m(59822),me=m(48787),$e=m(15910),ct=m(65181),Ct=m(98187),Me=m(77476),Ge=m(34895),Te=m(21661),Ve=m(33846),_t=m(87650),yt=m(86663),tt=m(73425),zt=m(44641),k=m(223),Cn=["emailsInput"],It=["emailsList"];function nt(ke,_e){if(1&ke&&(D.\u0275\u0275elementStart(0,"div",14),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&ke){var S=_e.ngIf,f=D.\u0275\u0275nextContext();D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",f.getSuggestionsText(S)," ")}}function be(ke,_e){if(1&ke&&D.\u0275\u0275text(0),2&ke){var S=D.\u0275\u0275nextContext();D.\u0275\u0275textInterpolate(S.inputLabel)}}function de(ke,_e){if(1&ke&&D.\u0275\u0275element(0,"pbi-icon",15),2&ke){var S=D.\u0275\u0275nextContext();D.\u0275\u0275property("name",S.inputIcon)}}function V(ke,_e){1&ke&&D.\u0275\u0275element(0,"pbi-icon",21)}var lt=function(_e,S){return{userEmail:_e,displayName:S}};function Xt(ke,_e){if(1&ke){var S=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"mat-chip",18),D.\u0275\u0275listener("removed",function(){var le=D.\u0275\u0275restoreView(S).$implicit,Pe=D.\u0275\u0275nextContext(2);return D.\u0275\u0275resetView(Pe.remove(le))}),D.\u0275\u0275element(1,"user-details-host",19),D.\u0275\u0275template(2,V,1,0,"pbi-icon",20),D.\u0275\u0275elementEnd()}if(2&ke){var f=_e.$implicit,E=D.\u0275\u0275nextContext(2);D.\u0275\u0275property("disabled",E.disabled),D.\u0275\u0275advance(1),D.\u0275\u0275property("details",D.\u0275\u0275pureFunction2(5,lt,null==f?null:f.userPrincipalName,null==f?null:f.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",E.coloredDefaultUserPhoto),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",!(null!=E.ngControl&&E.ngControl.disabled))}}function sn(ke,_e){if(1&ke&&(D.\u0275\u0275elementStart(0,"div",16),D.\u0275\u0275template(1,Xt,3,8,"mat-chip",17),D.\u0275\u0275pipe(2,"async"),D.\u0275\u0275elementEnd()),2&ke){var S=D.\u0275\u0275nextContext();D.\u0275\u0275advance(1),D.\u0275\u0275property("ngForOf",D.\u0275\u0275pipeBind1(2,1,S.selectedUsers$))}}function Mn(ke,_e){1&ke&&(D.\u0275\u0275elementStart(0,"div",22),D.\u0275\u0275element(1,"spinner"),D.\u0275\u0275elementEnd())}function fn(ke,_e){if(1&ke){var S=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"input",23,24),D.\u0275\u0275listener("matChipInputTokenEnd",function(le){D.\u0275\u0275restoreView(S);var Pe=D.\u0275\u0275nextContext();return D.\u0275\u0275resetView(Pe.add(le,2))})("paste",function(le){D.\u0275\u0275restoreView(S);var Pe=D.\u0275\u0275reference(2);return D.\u0275\u0275nextContext().onPaste(le),D.\u0275\u0275resetView(Pe.closePanel())})("blur",function(le){D.\u0275\u0275restoreView(S);var Pe=D.\u0275\u0275nextContext();return D.\u0275\u0275resetView(Pe.onBlur(le))})("focus",function(le){D.\u0275\u0275restoreView(S);var Pe=D.\u0275\u0275nextContext();return D.\u0275\u0275resetView(Pe.onFocus(le))})("keydown.escape",function(le){D.\u0275\u0275restoreView(S);var Pe=D.\u0275\u0275reference(2),qe=D.\u0275\u0275nextContext();return D.\u0275\u0275resetView(qe.onEscape(le,Pe))}),D.\u0275\u0275pipe(3,"async"),D.\u0275\u0275elementEnd()}if(2&ke){var f=D.\u0275\u0275nextContext(),E=D.\u0275\u0275reference(13),x=D.\u0275\u0275reference(6);D.\u0275\u0275property("placeholder",D.\u0275\u0275pipeBind1(3,9,f.selectedUsers$).length>0?void 0:f.inputPlaceholder)("disabled",f.disabled)("formControl",f.emailsListControl)("matAutocomplete",E)("matChipInputFor",x)("matChipInputSeparatorKeyCodes",f.separatorKeysCodes),D.\u0275\u0275attribute("title",f.inputPlaceholder)("aria-label",f.inputAriaLabelledBy?void 0:f.inputPlaceholder)("aria-labelledby",f.inputAriaLabelledBy)}}function jt(ke,_e){if(1&ke&&(D.\u0275\u0275elementStart(0,"mat-option",25),D.\u0275\u0275element(1,"user-details-host",26),D.\u0275\u0275elementEnd()),2&ke){var S=_e.$implicit,f=D.\u0275\u0275nextContext();D.\u0275\u0275property("value",S),D.\u0275\u0275advance(1),D.\u0275\u0275property("showOneLine",!1)("details",D.\u0275\u0275pureFunction2(6,lt,f.getUserEmail(S),S.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",f.coloredDefaultUserPhoto),D.\u0275\u0275attribute("data-testid",f.getUserEmail(S))}}function Tt(ke,_e){if(1&ke&&(D.\u0275\u0275elementContainerStart(0),D.\u0275\u0275elementStart(1,"div",27),D.\u0275\u0275element(2,"message-banner",28),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementContainerEnd()),2&ke){var S=D.\u0275\u0275nextContext();D.\u0275\u0275advance(2),D.\u0275\u0275property("viewModel",S.messageBannerViewModel)}}var Dt=function(ke){function _e(S,f,E,x,U,le){var Pe=ke.call(this)||this;return Pe.userDirectoryHttpService=S,Pe.localizationService=f,Pe.domainHelperService=E,Pe.telemetryService=x,Pe.cdr=U,Pe.ngControl=le,Pe.showRelevantUsers=!0,Pe.defaultSelectedUsers=[],Pe.coloredDefaultUserPhoto=!1,Pe.onInputFocus=new D.EventEmitter,Pe.awaitingRequestsCount=new De.X(0),Pe.isBusy$=Pe.awaitingRequestsCount.pipe((0,W.U)(function(qe){return _.gt(qe,0)}),(0,He.x)(),(0,he.d)(1)),Pe.separatorKeysCodes=[oe.K5],Pe.emailsListControl=new Re.p4("",null,Pe.findUserValidator()),Pe.emailSuggestionResults=new De.X([]),Pe.selectedUsers$=new De.X([]),Pe.onSelectedUsersChange=function(){},Pe.onComponentBlur=function(){},Pe.ngControl&&(Pe.ngControl.valueAccessor=Pe),Pe}return(0,M.__extends)(_e,ke),_e.prototype.ngOnInit=function(){var S=this;this.pasteHandler=new G.xQ,this.lifecycleSubscriptions.add(this.pasteHandler.pipe((0,ye.p)(1e3),(0,je.w)(function(f){return(0,M.__awaiter)(S,void 0,void 0,function(){var E,x,U,le,Pe,qe;return(0,M.__generator)(this,function(St){switch(St.label){case 0:return this.emailsListControl.markAsPending(),E=f.clipboardData.getData("Text").split(/;|,|\n/).filter(function(Et){return _.trim(Et).length>0}),x=_.size(E)<=100,U=this.telemetryService.startEvent(F,{inputCount:_.size(E)}),[4,this.addUser(E,x,3)];case 1:return le=St.sent(),Pe=0===_.size(le),this.propagateSelectedUsersChange(Pe),this.emailsInput.nativeElement.value=_.join(le,","),(qe=_.size(E)>100)&&this.emailsListControl.setErrors({TooManyUsers:_.size(E)}),(Pe||qe)&&this.cdr.markForCheck(),U.resolve(),[2]}})})})).subscribe()),this.lifecycleSubscriptions.add(this.emailsListControl.statusChanges.pipe((0,rt.O)(this.emailsListControl.status),(0,He.x)(),(0,Ke.G)(),(0,Q.h)(function(f){return"PENDING"===f[0]})).subscribe(function(){return S.cdr.markForCheck()})),this.actions&&this.actions.pipe((0,K.R)(this.onDestroy$)).subscribe(function(f){0===f&&S.reset()}),this.applyDefaultSelectedUsers(),this.onChanges$.subscribe(function(f){S.onChanges(f)})},_e.prototype.ngAfterViewInit=function(){this.notUseUnallowedAttributes()},_e.prototype.onChanges=function(S){S.defaultSelectedUsers&&this.applyDefaultSelectedUsers()},_e.prototype.applyDefaultSelectedUsers=function(){this.defaultSelectedUsers&&this.defaultSelectedUsers.length>0&&this.selectedUsers$.value&&0===this.selectedUsers$.value.length&&this.selectedUsers$.next(this.defaultSelectedUsers)},_e.prototype.reset=function(){this.selectedUsers$.next([]),this.emailsListControl.setValue(null),this.emailsInput&&(this.emailsInput.nativeElement.value=""),this.propagateSelectedUsersChange(!0)},_e.prototype.propagateSelectedUsersChange=function(S){S&&this.emailsListControl.setErrors(null),this.onSelectedUsersChange(this.selectedUsers$.value)},_e.prototype.add=function(S,f){var E;return(0,M.__awaiter)(this,void 0,void 0,function(){var x;return(0,M.__generator)(this,function(Pe){switch(Pe.label){case 0:return this.emailsListControl.invalid||this.emailsListControl.pending?[2]:(x=null===(E=S.chipInput)||void 0===E?void 0:E.inputElement,[4,this.addUser([S.value],!0,f)]);case 1:return 0===Pe.sent().length&&(x&&(x.value=""),this.propagateSelectedUsersChange(!0),this.emailsListControl.setValue(null)),[2]}})})},Object.defineProperty(_e.prototype,"hasValidPendingInput",{get:function(){var f=this.emailsInput.nativeElement.value;return!!f&&Ee.JJ.test(f)},enumerable:!1,configurable:!0}),_e.prototype.addUser=function(S,f,E){return(0,M.__awaiter)(this,void 0,void 0,function(){var x,U,le,Pe,qe,St;return(0,M.__generator)(this,function(Et){switch(Et.label){case 0:x=[],U=0,le=S,Et.label=1;case 1:return U<le.length?(Pe=le[U],(Pe=_.trim(Pe))?(qe=void 0,f?[4,this.findUsers(Pe).pipe((0,W.U)(function(at){return 1===at.length?at[0]:null})).toPromise()]:[3,3]):[3,6]):[3,7];case 2:qe=Et.sent(),Et.label=3;case 3:return this.emailsListControl.value||1!==E?(St=void 0,qe?[3,5]:[4,this.validateEmail(Pe,f&&this.checkValidOrgUser,!f||this.allowExternalUsers)]):[3,6];case 4:St=Et.sent(),Et.label=5;case 5:St?(this.emailsListControl.setErrors(St),x.push(Pe),this.cdr.markForCheck()):this.selectedUsers$.next(this.selectedUsers$.value.concat([qe??this.getADUserMetadataFromEmail(Pe)])),Et.label=6;case 6:return U++,[3,1];case 7:return[2,x]}})})},_e.prototype.getADUserMetadataFromEmail=function(S){return{displayName:void 0,userPrincipalName:S,objectId:void 0,emailAddress:S,objectType:1,isSecurityGroup:!1}},_e.prototype.remove=function(S){this.selectedUsers$.next(this.selectedUsers$.value.filter(function(f){return f!==S})),this.propagateSelectedUsersChange(!0)},_e.prototype.select=function(S){this.selectedUsers$.next(this.selectedUsers$.value.concat([S.option.value])),this.propagateSelectedUsersChange(!0),this.emailsInput.nativeElement.value="",this.emailsListControl.setValue(null)},_e.prototype.findUserValidator=function(){var S=this;return function(f){return(0,We.H)(500).pipe((0,je.w)(function(){var E=_.trim(f.value);return _.isString(f.value)&&E?S.findUsers(f.value).pipe((0,ee.b)(function(U){return S.emailSuggestionResults.next(U)}),(0,ae.zg)(function(U){return _.isEmpty(U)?S.validateEmail(f.value,S.checkValidOrgUser,S.allowExternalUsers):(0,Ue.of)(null)})):(S.emailSuggestionResults.next([]),(0,Ue.of)(null))}))}},_e.prototype.sendFindUsersRequest=function(S){var f=this;return function(ke,_e){return new ne.y(function(S){var f,E;try{f=ke()}catch(le){return void S.error(le)}try{E=_e()}catch(le){return void S.error(le)}var U=(E?(0,se.D)(E):ve.E).subscribe(S);return function(){U.unsubscribe(),f&&f.unsubscribe()}})}(function(){return{unsubscribe:function(){return f.awaitingRequestsCount.next(f.awaitingRequestsCount.value-1)}}},function(){var x=f.allowAnyGroup||f.allowSecurityGroups||f.allowUnifiedGroups||f.allowEmailEnabledSecurityGroups?f.blockUsers?2:3:1;return f.awaitingRequestsCount.next(f.awaitingRequestsCount.value+1),f.userDirectoryHttpService.findUsers(S,x,pe.OsI,!!f.includeGuests,f.showRelevantUsers,f.allowAnyGroup,!0)})},_e.prototype.findUsers=function(S){var f=this;return this.sendFindUsersRequest(S).pipe((0,W.U)(function(E){return _.reduce(E.data,function(x,U){var le;if(f.isValidObjectType(U)&&-1===_.findIndex(f.selectedUsers$.value,function(at){return f.compareADEntities(U,at)})){var qe=U.displayName&&U.displayName.toLocaleLowerCase()===S.toLocaleLowerCase(),St=null===(le=U.userPrincipalName)||void 0===le?void 0:le.split("@")[0],Et=St&&St.toLocaleLowerCase()===S.toLocaleLowerCase();qe||Et?x.unshift(U):x.push(U)}return x},[])}),(0,fe.K)(function(){return(0,Ue.of)([])}))},_e.prototype.compareADEntities=function(S,f){return S.userPrincipalName&&f.userPrincipalName?S.userPrincipalName===f.userPrincipalName:!(!S.objectId||!f.objectId)&&S.objectId===f.objectId},_e.prototype.writeValue=function(S){S&&this.selectedUsers$.next(S)},_e.prototype.registerOnChange=function(S){this.onSelectedUsersChange=S},_e.prototype.registerOnTouched=function(S){this.onComponentBlur=S},_e.prototype.onPaste=function(S){S.preventDefault(),this.pasteHandler.next(S)},Object.defineProperty(_e.prototype,"messageBannerViewModel",{get:function(){var f=this.localizationService.get("ClientError_UnknownClientErrorValue"),E=1;return this.emailsListControl.hasError("DuplicateEmail")||this.emailsListControl.hasError("InvalidEmail")?f=this.localizationService.get("Sharing_InvalidEmail"):this.emailsListControl.hasError("ExternalUser")?(f=this.localizationService.format("Sharing_ExternalOrganization",this.emailsListControl.getError("ExternalUser")),E=1):this.emailsListControl.hasError("InvalidOrgUser")?(f=this.localizationService.format("GrantAccessPane_InvalidEmails",this.emailsListControl.getError("InvalidOrgUser")),E=1):this.emailsListControl.hasError("TooManyUsers")&&(f=this.localizationService.format("TooManyUsers_BlockedEmails",this.emailsListControl.getError("TooManyUsers")),E=1),{bannerType:E,iconName:1===E?"pbi-glyph-error-circle-exclamation":"pbi-glyph-warning",message:f}},enumerable:!1,configurable:!0}),_e.prototype.onBlur=function(S){return(0,M.__awaiter)(this,void 0,void 0,function(){var f,E;return(0,M.__generator)(this,function(x){switch(x.label){case 0:return S.relatedTarget&&"MAT-OPTION"===S.relatedTarget.tagName?[2]:(this.onComponentBlur(this.selectedUsers$.value),this.addUserOnBlur?(f=this.emailsInput.nativeElement,this.emailsListControl.pending?[4,this.emailsListControl.statusChanges.pipe((0,Q.h)(function(U){return"PENDING"!==U}),(0,me.q)(1)).toPromise()]:[3,2]):[3,3]);case 1:x.sent(),x.label=2;case 2:return(E=_.trim(f.value))?[2,this.add({input:f,value:E,chipInput:new Be.IP(this.emailsInput,{separatorKeyCodes:[]})},1)]:[2];case 3:return[2]}})})},_e.prototype.onEscape=function(S,f){var E;null!==(E=f?.autocomplete)&&void 0!==E&&E.isOpen&&(S?.stopPropagation(),f.closePanel())},_e.prototype.onFocus=function(S){this.onInputFocus.emit(S)},_e.prototype.validateEmail=function(S,f,E){return void 0===E&&(E=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var U;return(0,M.__generator)(this,function(le){switch(le.label){case 0:return Ee.JJ.test(S)?-1!==_.findIndex(this.selectedUsers$.value,function(Pe){return Pe.userPrincipalName===S})?[2,{DuplicateEmail:!0}]:[4,this.domainHelperService.emailIsInVerifiedDomain(S)]:[3,2];case 1:return(U=le.sent())||E?U&&f?[2,{InvalidOrgUser:S}]:[2,null]:[2,{ExternalUser:S}];case 2:return[2,{InvalidEmail:!0}]}})})},_e.prototype.isValidObjectType=function(S){return 2===S.objectType?!!this.allowAnyGroup||(S.isSecurityGroup?this.allowSecurityGroups||this.allowEmailEnabledSecurityGroups&&3===S.groupType:2===S.groupType?this.allowDistributionLists:this.allowUnifiedGroups):1===S.objectType&&S.aadAppId?this.allowServicePrincipals:(1===S.objectType||3===S.objectType)&&!this.blockUsers},_e.prototype.getUserEmail=function(S){return S.userPrincipalName||S.emailAddress||(S.aadAppId?"AppID: "+S.aadAppId:null)},_e.prototype.notUseUnallowedAttributes=function(){this.emailsList._multiple=void 0,this.emailsList.ariaOrientation=void 0},_e.prototype.getSuggestionsText=function(S){return S>0?this.localizationService.format("Email_Address_Suggestion_Count_Text",[S]):""},_e.\u0275fac=function(f){return new(f||_e)(D.\u0275\u0275directiveInject($e.W),D.\u0275\u0275directiveInject(ct.o),D.\u0275\u0275directiveInject(Ct.z),D.\u0275\u0275directiveInject(Fe.y0),D.\u0275\u0275directiveInject(D.ChangeDetectorRef),D.\u0275\u0275directiveInject(Re.a5,10))},_e.\u0275cmp=D.\u0275\u0275defineComponent({type:_e,selectors:[["emails-list-modern"]],viewQuery:function(f,E){if(1&f&&(D.\u0275\u0275viewQuery(Cn,5),D.\u0275\u0275viewQuery(It,5)),2&f){var x=void 0;D.\u0275\u0275queryRefresh(x=D.\u0275\u0275loadQuery())&&(E.emailsInput=x.first),D.\u0275\u0275queryRefresh(x=D.\u0275\u0275loadQuery())&&(E.emailsList=x.first)}},hostVars:4,hostBindings:function(f,E){2&f&&D.\u0275\u0275classProp("disabled",(null==E.ngControl?null:E.ngControl.disabled)||E.disabled)("invalid",(null==E.ngControl?null:E.ngControl.invalid)||E.emailsListControl.invalid)},inputs:{allowAnyGroup:"allowAnyGroup",allowSecurityGroups:"allowSecurityGroups",allowUnifiedGroups:"allowUnifiedGroups",allowEmailEnabledSecurityGroups:"allowEmailEnabledSecurityGroups",allowObjectIds:"allowObjectIds",blockUsers:"blockUsers",isRequired:"isRequired",includeGuests:"includeGuests",allowExternalUsers:"allowExternalUsers",allowDistributionLists:"allowDistributionLists",allowServicePrincipals:"allowServicePrincipals",inputLabel:"inputLabel",inputPlaceholder:"inputPlaceholder",inputIcon:"inputIcon",inputAriaLabelledBy:"inputAriaLabelledBy",disabled:"disabled",maxSelectableUsers:"maxSelectableUsers",hideChips:"hideChips",hideError:"hideError",hideInput:"hideInput",addUserOnBlur:"addUserOnBlur",checkValidOrgUser:"checkValidOrgUser",showRelevantUsers:"showRelevantUsers",actions:"actions",defaultSelectedUsers:"defaultSelectedUsers",coloredDefaultUserPhoto:"coloredDefaultUserPhoto"},outputs:{onInputFocus:"onInputFocus"},features:[D.\u0275\u0275InheritDefinitionFeature],decls:17,vars:17,consts:[["id","emailsList","appearance","none","cdkScrollable","",1,"emails-list"],["class","x-screen-reader","aria-live","assertive",4,"ngIf"],[1,"email-list-input-wrapper"],[3,"ngIf"],["role","listbox",1,"chip-list",3,"required"],["emailsList",""],["class","inputIcon","size","small",3,"name",4,"ngIf"],["class","chips-wrapper",4,"ngIf"],["class","autoCompleteSpinner",4,"ngIf"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape",4,"ngIf"],["id","email-list-modern-suggestions","data-testid","email-sugessions-dropdown",3,"optionSelected"],["auto","matAutocomplete"],["data-automation-type","Suggestion",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["aria-live","assertive",1,"x-screen-reader"],["size","small",1,"inputIcon",3,"name"],[1,"chips-wrapper"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed",4,"ngFor","ngForOf"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed"],[3,"details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["name","close","size","mini","matChipRemove","",4,"ngIf"],["name","close","size","mini","matChipRemove",""],[1,"autoCompleteSpinner"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape"],["emailsInput","","trigger","matAutocompleteTrigger"],["data-automation-type","Suggestion",3,"value"],[3,"showOneLine","details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["role","alert","aria-atomic","true"],[3,"viewModel"]],template:function(f,E){var x;(1&f&&(D.\u0275\u0275elementStart(0,"mat-form-field",0),D.\u0275\u0275template(1,nt,2,1,"div",1),D.\u0275\u0275pipe(2,"async"),D.\u0275\u0275elementStart(3,"label",2),D.\u0275\u0275template(4,be,1,1,"ng-template",3),D.\u0275\u0275elementStart(5,"mat-chip-list",4,5),D.\u0275\u0275template(7,de,1,1,"pbi-icon",6),D.\u0275\u0275template(8,sn,3,3,"div",7),D.\u0275\u0275template(9,Mn,2,0,"div",8),D.\u0275\u0275elementEnd(),D.\u0275\u0275template(10,fn,4,11,"input",9),D.\u0275\u0275pipe(11,"async"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(12,"mat-autocomplete",10,11),D.\u0275\u0275listener("optionSelected",function(le){return E.select(le)}),D.\u0275\u0275template(14,jt,2,9,"mat-option",12),D.\u0275\u0275pipe(15,"async"),D.\u0275\u0275elementEnd()(),D.\u0275\u0275template(16,Tt,3,1,"ng-container",13)),2&f)&&(D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",null==(x=D.\u0275\u0275pipeBind1(2,11,E.emailSuggestionResults))?null:x.length),D.\u0275\u0275advance(3),D.\u0275\u0275property("ngIf",E.inputLabel),D.\u0275\u0275advance(1),D.\u0275\u0275property("required",E.isRequired),D.\u0275\u0275attribute("aria-label",E.inputAriaLabelledBy?void 0:E.inputPlaceholder)("aria-labelledby",E.inputAriaLabelledBy),D.\u0275\u0275advance(2),D.\u0275\u0275property("ngIf",!!E.inputIcon),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",!E.hideChips),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",E.emailsListControl.pending),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",!E.hideInput&&(!E.maxSelectableUsers||D.\u0275\u0275pipeBind1(11,13,E.selectedUsers$).length<E.maxSelectableUsers)),D.\u0275\u0275advance(4),D.\u0275\u0275property("ngForOf",D.\u0275\u0275pipeBind1(15,15,E.emailSuggestionResults)),D.\u0275\u0275advance(2),D.\u0275\u0275property("ngIf",E.emailsListControl.invalid&&!E.hideError))},dependencies:[Me.NgForOf,Me.NgIf,Ge.VN,Ge.QJ,Te.PQ,Ve.CK,Be.ir,Be.lw,Be.IP,Be.Y6,_t.v_,Re.Fj,Re.JJ,Re.oH,yt._,tt.O,zt.A,k.s,Me.AsyncPipe],styles:['[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{border:0px solid;width:min-content;min-height:32px;padding:6px 8px!important;margin:0!important;box-sizing:border-box;caret-color:auto;line-height:1.4}[_nghost-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{display:block;line-height:1.125}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]{max-width:100%;display:flex}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]     .mat-chip-list-wrapper{max-width:100%;margin:0}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]   .chips-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-height:190px;overflow:auto}[_nghost-%COMP%]   .inputIcon[_ngcontent-%COMP%]{padding:0 8px}[_nghost-%COMP%]     .mat-chip{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);font-weight:400;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]     .mat-standard-chip{min-height:24px!important}[_nghost-%COMP%]     .mat-standard-chip.mat-chip-with-trailing-icon{padding:0 2px 0 0!important}[_nghost-%COMP%]     .mat-standard-chip .mat-chip-remove{height:12px!important}[_nghost-%COMP%]     .mat-form-field-appearance-standard, [_nghost-%COMP%]     .mat-form-field-wrapper, [_nghost-%COMP%]     .mat-form-field-flex{padding:0}[_nghost-%COMP%]     .mat-form-field-infix{border:0px;padding:0;width:min-content;min-height:32px}[_nghost-%COMP%]     .mat-form-field-appearance-standard .mat-form-field-flex, [_nghost-%COMP%]     .mat-chip-list-wrapper{padding-top:0!important;padding-bottom:0!important}[_nghost-%COMP%]     user-details-host{width:calc(100% - 24px)}[_nghost-%COMP%]     user-details{width:100%}[_nghost-%COMP%]     .user-info{width:calc(100% - 29px)}[_nghost-%COMP%]     .user-name, [_nghost-%COMP%]     .user-email{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]{display:flex;flex-flow:wrap}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{opacity:1;color:var(--colorNeutralForeground4, #707070)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border:1px solid var(--fluent-theme-neutral-tertia-color, #A19F9D);border-radius:2px;background-color:var(--fluent-theme-white-color, #FFF)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:hover{border-color:var(--fluent-theme-black-color, #000)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:focus-within{border:2px solid var(--colorNeutralStrokeFocus2)}[_nghost-%COMP%]   .autoCompleteSpinner[_ngcontent-%COMP%]{position:absolute;top:4px;right:6px;overflow:auto}.invalid[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border-color:var(--fluent-theme-error-dark-color, #A80000)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-light-color, #EDEBE9)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:none}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{width:100%}html:not([dir="rtl"])   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-right:12px}html[dir="rtl"]   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-left:12px}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--colorNeutralForegroundDisabled, #bdbdbd)}user-details-host[_ngcontent-%COMP%]     .user-email, user-details-host[_ngcontent-%COMP%]     .user-name{line-height:16px}.mat-option.mat-active[_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.x-screen-reader[_ngcontent-%COMP%]{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:0!important;padding:0!important;margin:0!important}'],changeDetection:0}),_e}(R.w)},50932:function(Pt,vt,m){"use strict";m.d(vt,{F:function(){return he}}),m(93864),m(94120),m(82775);var F=m(59051),oe=m(21661),D=m(77476),Re=m(17174),Be=m(94908),Ee=m(34895),pe=m(89075),R=m(87650),Fe=m(56545),De=m(52040),G=m(93367),We=m(16095),Ue=m(70137),ne=m(88717),se=m(68264),ve=m(6342),Se=m(50423);function W(ye){return function(){return ye.scrollStrategies.close()}}var he=function(){function ye(){}return ye.\u0275fac=function(rt){return new(rt||ye)},ye.\u0275mod=Se.\u0275\u0275defineNgModule({type:ye}),ye.\u0275inj=Se.\u0275\u0275defineInjector({providers:[{provide:Be.g8,deps:[F.aV],useFactory:W}],imports:[D.CommonModule,Ee.D8,pe.yD,R.wp,Re.UX,oe.Cl,se.z,G.U,Ue.F,Fe.g,ve.N,ne.R,De.x,We.Z]}),ye}()},71166:function(Pt,vt,m){"use strict";m.r(vt),m.d(vt,{GoalsUIModule:function(){return Jh}});var M=m(81337),u=m(62458),e=m(50423),F=m(77476),oe=m(36858),D=m(223),Re=function(n){return{userEmail:n}};function Be(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"user-details-host",4),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Re,t))("photoSize",i.photoSize)("showUserInfo",!1)("showTooltip",!0)}}function Ee(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",5)(1,"div",6),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(5);e.\u0275\u0275styleProp("width",t.photoSize,"px")("height",t.photoSize,"px"),e.\u0275\u0275property("pbiTooltip",i)("pbiTooltipCaretSize","small")("pbiTooltipPosition","below"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" +",t.emails.length-t.numUsersToShow," ")}}function pe(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275listener("click",function(a){return a.stopPropagation()}),e.\u0275\u0275element(1,"user-details-host",10),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Re,t))("showUserInfo",!0)("showOneLine",!1)("showTooltip",!1)}}function R(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,pe,2,6,"div",8),e.\u0275\u0275pipe(2,"slice"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind2(2,1,t.emails,t.numUsersToShow))}}var Fe=function(){function o(){this.emails=[],this.numAvatarsToShow=5,this.avatarSize="medium",this.rowStyle="spread",this.AvatarSizeMap={smallest:{photoSize:16,spreadSpacing:8,stackOverlap:2,stackOutline:2},small:{photoSize:20,spreadSpacing:10,stackOverlap:2,stackOutline:2},medium:{photoSize:24,spreadSpacing:10,stackOverlap:4,stackOutline:2}}}return o.prototype.ngOnInit=function(){this.setSize()},o.prototype.ngOnChanges=function(n){(n.emails||n.numAvatarsToShow)&&this.setUserCount(),(n.avatarSize||n.rowStyle)&&this.setSize()},o.prototype.setUserCount=function(){this.numUsersToShow=this.emails.length>this.numAvatarsToShow?this.numAvatarsToShow-1:this.numAvatarsToShow},o.prototype.setSize=function(){var n=this.AvatarSizeMap[this.avatarSize];u.fF.assertValue(n,"Invalid size ".concat(this.avatarSize," for AvatarRow.")),this.photoSize=n.photoSize;var t=0,i=0,a=0;"spread"===this.rowStyle?a=n.spreadSpacing:"stack"===this.rowStyle?(t=n.stackOutline,i=-n.stackOutline,a=-n.stackOutline-n.stackOverlap):u.fF.assertFail("Invalid style ".concat(this.rowStyle," for AvatarRow.")),this.styleVariables={"--avatar-left-margin":i+"px","--avatar-right-margin":a+"px","--avatar-outline":t+"px"}},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["avatar-row"]],inputs:{emails:"emails",numAvatarsToShow:"numAvatarsToShow",avatarSize:"avatarSize",rowStyle:"rowStyle"},features:[e.\u0275\u0275NgOnChangesFeature],decls:6,vars:8,consts:[[1,"avatar-row-container"],[4,"ngFor","ngForOf"],["class","plus-number-container",3,"width","height","pbiTooltip","pbiTooltipCaretSize","pbiTooltipPosition",4,"ngIf"],["collapsedAvatars",""],[1,"user-details-host",3,"details","photoSize","showUserInfo","showTooltip"],[1,"plus-number-container",3,"pbiTooltip","pbiTooltipCaretSize","pbiTooltipPosition"],[1,"plus-number"],[1,"collapsed-avatar-list"],["class","collapsed-avatar",3,"click",4,"ngFor","ngForOf"],[1,"collapsed-avatar",3,"click"],[3,"details","showUserInfo","showOneLine","showTooltip"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Be,2,6,"div",1),e.\u0275\u0275pipe(2,"slice"),e.\u0275\u0275template(3,Ee,3,8,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,R,3,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275styleMap(i.styleVariables),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind3(2,4,i.emails,0,i.numUsersToShow)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.emails.length>i.numUsersToShow))},dependencies:[F.NgForOf,F.NgIf,oe.V,D.s,F.SlicePipe],styles:['.avatar-row-container[_ngcontent-%COMP%]{display:inline-flex;--avatar-outline-color: var(--fluent-theme-white-color)}.avatar-row-container[_ngcontent-%COMP%]   .user-details-host[_ngcontent-%COMP%]     .user-image{margin-left:var(--avatar-left-margin);margin-right:var(--avatar-right-margin)}.avatar-row-container[_ngcontent-%COMP%]   .user-details-host[_ngcontent-%COMP%]     .user-image>*{border:var(--avatar-outline) solid var(--avatar-outline-color)}.avatar-row-container[_ngcontent-%COMP%]   .plus-number-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border-radius:50%;border:var(--avatar-outline) solid var(--avatar-outline-color)}.avatar-row-container[_ngcontent-%COMP%]   .plus-number-container[_ngcontent-%COMP%]   .plus-number[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xs-font-size, 10px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}.collapsed-avatar-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0 16px}.collapsed-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;height:48px;white-space:nowrap;overflow:hidden}'],changeDetection:0}),o}(),De=m(73221),G=m(77526),We=m(83317),Ue=m(8297),ne=m(60042),se=m(44603),ve=m(4444),Se=m(38078),W=function(){function o(){}return o.isSampleScorecard=function(n){return"00000000-0000-0000-0000-000000000000"===n.id},o.getGoalCreateRequest=function(n){var t;return u.fF.assertValue(n,"goal"),{name:n.name,completionDate:n.completionDate,owner:n.owner,additionalOwners:n.additionalOwners,parentId:null!==(t=n.parentId)&&void 0!==t?t:null,startDate:n.startDate,unit:n.unit,datesFormatString:n.datesFormatString,valuesFormatString:n.valuesFormatString,valuesCategoryId:n.valuesCategoryId}},o.getGoalUpdateRequest=function(n){var t;return u.fF.assertValue(n,"goal"),{name:n.name,completionDate:n.completionDate,owner:n.owner,additionalOwners:n.additionalOwners,parentId:null!==(t=n.parentId)&&void 0!==t?t:null,startDate:n.startDate,unit:n.unit,datesFormatString:n.datesFormatString,valuesFormatString:n.valuesFormatString,description:n.description,cycle:n.cycle,cyclePeriod:n.cyclePeriod,valuesCategoryId:n.valuesCategoryId,metadata:n.metadata,cycleMetadata:n.cycleMetadata}},o.getGoalValueCreateRequest=function(n){return u.fF.assertValue(n,"goalValue"),{timestamp:n.timestamp,value:n.value,target:n.target,trend:n.trend,forecast:n.forecast,status:n.status}},o.getGoalValueUpdateRequest=function(n){return u.fF.assertValue(n,"goalValue"),{value:n.value,target:n.target,trend:n.trend,forecast:n.forecast,status:n.status}},o.getGoalStatusRulesUpdateRequest=function(n){u.fF.assertValue(n,"statusRules");var t=function(y){return{dateTime:y.dateTime,field:y.field,number:y.number,percentOf:y.percentOf?{field:y.percentOf.field,percent:y.percentOf.percent}:void 0}},i=function(y){return{field:y.field,operator:y.operator,value:t(y.value)}};return{rules:_.map(n.rules,function(p){return y=p,{conditions:_.map(y.conditions,function(O){return function(y){return{fieldComparison:i(y.fieldComparison),expression:y.expression}}(O)}),output:y.output};var y}),defaultOutput:n.defaultOutput}},o.isGoalMetadataUpdated=function(n,t){return!_.isEqual(o.getGoalUpdateRequest(n),o.getGoalUpdateRequest(t))},o.createNewGoal=function(n,t,i){u.fF.assertValue(n,"owner"),u.fF.assertValue(t,"scorecardId");var a=new Date,l=se.E.getCurrentUTCDay().toISOString(),c=se.E.getCurrentLocalDay();c.setMonth(c.getMonth()+1);var p=se.E.treatAsUTCDate(c).toISOString();return{name:null,id:"new-".concat(Se.b$.generateGuid()),scorecardId:t,createdTime:a.toISOString(),lastModifiedBy:n,lastModifiedTime:a.toISOString(),owner:n,additionalOwners:[],startDate:l,completionDate:p,unit:0,parentId:i??null,goalValues:[],subGoals:[],isNew:!0,state:"Editing",valuesCategoryId:null,isExpanded:!0}},o.getGoal=function(n,t){return this.findGoal(n,function(i){return i.id===t})},o.buildGoalTree=function(n){for(var t={},i=0,a=n;i<a.length;i++)t[(l=a[i]).id]=l;for(var c=[],p=0,y=n;p<y.length;p++){var l;if((l=y[p]).parentId&&t[l.parentId]){var O=t[l.parentId];O.subGoals?O.subGoals.push(l):O.subGoals=[l]}else c.push(l)}return c},o.findGoal=function(n,t){if(_.some(n)){var i=_.find(n,function(p){return t(p)});if(i)return i;for(var a=0,l=n;a<l.length;a++)if(i=this.findGoal(l[a].subGoals,t))return i}return null},o.forEachGoal=function(n,t){if(_.some(n))for(var i=0,a=n;i<a.length;i++){var l=a[i];t(l),this.forEachGoal(l?.subGoals,t)}},o.countSubGoals=function(n,t){var i=this;return void 0===t&&(t=function(){return!0}),_.isEmpty(n?.subGoals)?0:n.subGoals.filter(t).length+n.subGoals.reduce(function(l,c){return l+i.countSubGoals(c,t)},0)},o.flattenGoals=function(n){return function i(a){return _.flatMap(a,function(l){return(0,M.__spreadArray)([l],i(l.subGoals),!0)})}(n)},o.filterGoals=function(n,t){return _.filter(this.flattenGoals(n),t)},o.mapGoals=function(n,t){return _.map(this.flattenGoals(n),t)},o.anyGoals=function(n,t){var i;if(_.some(n))for(var a=0,l=n;a<l.length;a++){var c=l[a];if(t(c)||this.anyGoals(null!==(i=c.subGoals)&&void 0!==i?i:[],t))return!0}return!1},o.computeGoalHeight=function(n){return _.isEmpty(n?.subGoals)?0:Math.max.apply(Math,n.subGoals.map(function(t){return 1+o.computeGoalHeight(t)}))},o.computeGoalLevel=function(n,t){for(var i=0,a=t;a;)i++,a=a.parentId?o.getGoal(n,a.parentId):void 0;return i-1},o.filterGoalsAndReassignParents=function(n,t){var i=function a(l,c){var p=[],y=c;return t(l)&&(p.push((0,M.__assign)((0,M.__assign)({},l),{parentId:c})),y=l.id),_.concat(p,_.flatMap(l.subGoals,function(O){return a(O,y)}))};return _.flatMap(n,function(a){return i(a)})},o.isEditing=function(n){return!!o.findGoal(n?.goals,function(t){return!!t.isNew||"Editing"===t.state})},o.isDarkMode=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},o.getCurrentUser=function(){var n;return null===(n=(0,ve.bG)())||void 0===n?void 0:n.name},o.isCurrentUser=function(n){var t=o.getCurrentUser();return t&&n&&(0,Se.vr)(t,n)},o.compareGoalQueryConnections=function(n,t){return _.isEqual(n?.query,t?.query)&&_.isEqual(n?.datasetId,t?.datasetId)&&_.isEqual(n?.reportUrl,t?.reportUrl)},o.getGoalValueCategoriesCreateRequest=function(n){return u.fF.assertValue(!_.isEmpty(n),"getGoalValueCategoriesCreateRequest categoricalValues"),{name:"",categories:_.map(n,function(t,i){return{id:i,displayName:t}})}},o.getGoalValueCategoriesUpdateRequest=function(n){return u.fF.assertValue(n,"getGoalValueCategoriesUpdateRequest categoryList"),{name:n.name,categories:n.categories}},o.getGoalOwners=function(n){if(_.some(n)){var i={};return function a(l,c){if(_.some(l))for(var p=0,y=l;p<y.length;p++){var O=y[p];if(O.owner&&(c[O.owner]={displayName:void 0,userPrincipalName:O.owner,objectId:void 0,objectType:3,isSecurityGroup:void 0}),_.some(O.additionalOwners))for(var A=0,L=O.additionalOwners;A<L.length;A++){var te=L[A];te.userPrincipalName&&(c[te.userPrincipalName]={displayName:void 0,userPrincipalName:te.userPrincipalName,objectId:void 0,objectType:3,isSecurityGroup:void 0})}a(O.subGoals,c)}}(n,i),_.values(i)}return[]},o.observeAndRemoveFocusableAttributes=function(n){if(n){var t=new MutationObserver(function(i){_.some(i,function(l){var c;return(null===(c=l.addedNodes)||void 0===c?void 0:c.length)>0})&&function l(c){c&&(c.removeAttribute("tabindex"),c.removeAttribute("focusable"),_.forEach(c.children,l))}(n)});return t.observe(n,{attributeFilter:["tabindex","focusable"],characterData:!1,childList:!0,subtree:!0}),t}return null},o.getGoalsWithRollups=function(n,t,i){for(var l,a=[];t&&null!=(l=o.getGoal(n,t))&&!0!==l.isLinked&&(t=l.parentId,1===i&&null!=l.valueRollup||2===i&&null!=l.targetRollup);)a.push(l);return a},o}(),He=m(86940),he=m(25512),ye=m(35510),je=m(30794);function rt(o){if(null==o)return 0;if("number"==typeof o)return o;if("string"==typeof o)switch(o.toString().trim().toLowerCase()){case"none":return 0;case"read":default:return 1;case"write":return 2;case"readwrite":return 3}return 0}var Ke=m(125),Q=m(57535),K=function(){function o(){}return o.sortAndFilter=function(n,t,i,a){if(_.isEmpty(n))return n;var l=t.sortAscending?"asc":"desc",c=[this.sortingFunctions[t.sortBy]];return"Rank"===t.sortBy&&c.push(this.sortingFunctions.CreatedTime),c.push("Name"===t.sortBy?this.sortingFunctions.CreatedTime:this.sortingFunctions.Name),this.sortRecursive(n,l,c,i,a)},o.sort=function(n,t){return this.sortAndFilter(n,t,{},{})},o.toggleSort=function(n,t){return t?n.sortBy===t?n.sortAscending?{sortBy:n.sortBy,sortAscending:!1}:ne.Ij:{sortBy:t,sortAscending:!0}:n},o.sortRecursive=function(n,t,i,a,l){for(var c=0,p=n=_.orderBy(n,i,[t,"asc"]);c<p.length;c++){var y=p[c];_.isEmpty(y.subGoals)||(y.subGoals=this.sortRecursive(y.subGoals,t,i,a,l)),_.isNil(l)?(delete y.isFilterMatch,delete y.isHidden):(y.isFilterMatch=o.matchesFilter(y,a,l),y.isHidden=!y.isFilterMatch&&!_.some(y.subGoals,function(O){return!O.isHidden}))}return n},o.matchesFilter=function(n,t,i){var a,l,c,p,y;if(_.isNil(i)||n.isNew||"Editing"===n.state||"Saving"===n.state)return!0;var O=null!==(a=Ke.r.buildCurrentGoalValue(n).status)&&void 0!==a?a:0,A=Q.p.getGoalStatusForScorecardId(O,n.scorecardId,t),L=!1,te=null===(l=i?.keyword)||void 0===l?void 0:l.toLocaleLowerCase();if(!_.isString(te)||_.isEmpty(te))L=!0;else if(!(null===(c=n.name)||void 0===c)&&c.toLocaleLowerCase().includes(te)&&(L=!0),i?.matchOwner&&!L&&((null===(p=n.ownerDisplayNames)||void 0===p?void 0:p.length)>=1?L=_.some(n.ownerDisplayNames,function(Ne){return Ne?.toLocaleLowerCase().includes(te)}):(L=null===(y=n.owner)||void 0===y?void 0:y.toLocaleLowerCase().includes(te))||(L=_.some(n.additionalOwners,function(Ne){var Je,ze=null!==(Je=Ne.userPrincipalName)&&void 0!==Je?Je:Ne.aadAppId;return ze?.toLocaleLowerCase().includes(te)}))),i?.matchStatus&&!L){var ue=A.displayName;ue?.toLocaleLowerCase().includes(te)&&(L=!0)}var Ae=!1;return(_.isNil(i?.statuses)||_.isEmpty(i?.statuses)||Q.p.listIncludesMatchingStatus(i.statuses,A))&&(Ae=!0),L&&Ae},o.sortingFunctions={Rank:function(t){return t.rank},CreatedTime:function(t){return t.createdTime},Name:function(t){var i;return null===(i=t.name)||void 0===i?void 0:i.trim().toLocaleLowerCase()},Owner:function(t){var i,a,l;return null===(l=null!==(a=null===(i=t.ownerDisplayNames)||void 0===i?void 0:i[0])&&void 0!==a?a:t.owner)||void 0===l?void 0:l.trim().toLocaleLowerCase()},Status:function(t){return(Ke.r.buildCurrentGoalValue(t).status+1)%6},Value:function(t){return Ke.r.buildCurrentGoalValue(t).value},Change:function(t){return Ke.r.calculateValueChange(t,!0).changeAmount},Milestone:function(t){return Ke.r.buildCurrentGoalValue(t).nextTarget},Target:function(t){return Ke.r.buildCurrentGoalValue(t).finalTarget},DueDate:function(t){return t.completionDate}},o}(),ee=m(558),ae=function(){function o(){}return o.moveColumnSettingUp=function(n,t){if(!(_.size(n)<=1||0===t)){var i=n;return(0,M.__spreadArray)((0,M.__spreadArray)((0,M.__spreadArray)([],_.slice(i,0,t-1),!0),[i[t],i[t-1]],!1),_.slice(i,t+1),!0)}},o.moveColumnSettingDown=function(n,t){if(!(_.size(n)<=1||t===_.size(n)-1)){var i=n;return(0,M.__spreadArray)((0,M.__spreadArray)((0,M.__spreadArray)([],_.slice(i,0,t),!0),[i[t+1],i[t]],!1),_.slice(i,t+2),!0)}},o.canMoveLeft=function(n,t){if(t<=1)return!1;var i=_.slice(n,0,t);return _.findLastIndex(i,function(l){return l.show})>0},o.canMoveRight=function(n,t){return!(0===t||t>=n.length-1)&&_.findIndex(n,function(a){return a.show},t+1)>t},o.moveColumnLeft=function(n,t){var i=_.findIndex(n,function(c){return c.columnId===t}),a=_.slice(n,0,i),l=_.findLastIndex(a,function(c){return c.show});(0,ee.bA)(n,i,l)},o.moveColumnRight=function(n,t){var i=_.findIndex(n,function(l){return l.columnId===t}),a=_.findIndex(n,function(l){return l.show},i+1);(0,ee.bA)(n,i,a)},o.hideColumn=function(n,t){var i=_.findIndex(n,function(a){return a.columnId===t});i>=0&&(n[i].show=!1)},o.showColumn=function(n,t){var i=_.findIndex(n,function(a){return a.columnId===t});i>=0&&(n[i].show=!0)},o.isColumnVisible=function(n,t){var i=_.find(n,function(a){return a.columnId===t});return!!_.isUndefined(i?.show)||i.show},o.mergeColumns=function(n,t){for(var i=new Array,a=new Set(t.map(function(te){return te.columnId})),l=new Set,c=0,p=n;c<p.length;c++){var y=p[c];a.has(y.columnId)&&!l.has(y.columnId)&&(i.push(y),l.add(y.columnId))}for(var O=0,A=t;O<A.length;O++){var L=A[O];l.has(L.columnId)||i.push(L)}return i},o.removeColumnSettings=function(n,t){var i=new Set(t);_.remove(n,function(a){return i.has(a.columnId)})},o.adjustColumnSettings=function(n,t){n.featureSwitches.scorecardSplitColumns||(o.removeColumnSettings(t,[7,8,9]),o.isColumnVisible(t,3)||o.showColumn(t,3)),n.featureSwitches.scorecardCompactView||o.removeColumnSettings(t,[10])},o}(),fe=function(){function o(){}return o.ManuallyUpdatingConnectedGoalValueNotAllowed="ManuallyUpdatingConnectedGoalValueNotAllowed",o.ManuallyUpdatingConnectedMetricValueNotAllowed="ManuallyUpdatingConnectedMetricValueNotAllowed",o.MultiGeoNotSupported="MultiGeoNotSupported",o.InvalidScorecardColumnSetting="InvalidScorecardColumnSetting",o.CircularRelationshipsNotAllowed="CircularRelationshipsNotAllowed",o}(),me=m(11547),$e=m(18353),ct=m(42195),Ct=m(70032),Me=m(48787),Ge=function(){function o(n){var t,i=this;this.scorecardService=n,this.MinPollingInterval=200,this.MaxPollingInterval=4e3,this.MaxPollingRequests=40,this.PollingDelay=function(a){return i.MinPollingInterval+(i.MaxPollingInterval-i.MinPollingInterval)*a/i.MaxPollingRequests},this.ConnectionTypeAsText=((t={})[1]="Current",t[2]="Target",t)}return o.prototype.startPollingAsync=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,c=this;return(0,M.__generator)(this,function(p){switch(p.label){case 0:if(this.setGoalRefreshState(n.id,t,!0),a=i?.lastRefreshTimestamp,null!=a)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.getLastRefreshTimestamp(n.id,t)];case 2:return a=p.sent(),[3,4];case 3:return p.sent(),this.setGoalRefreshState(n.id,t,!1),[2];case 4:return(0,M.__awaiter)(c,void 0,void 0,function(){var y,O,A,te,L=this;return(0,M.__generator)(this,function(ue){switch(ue.label){case 0:return ue.trys.push([0,,9,10]),y=new je.xQ,(O=y.pipe((0,$e.R)(function(Ae){return Ae+1},-1),(0,ct.zg)(function(Ae){return(0,me.of)(void 0).pipe((0,Ct.g)(L.PollingDelay(Ae)))}),(0,Me.q)(this.MaxPollingRequests))).subscribe(function(){return(0,M.__awaiter)(L,void 0,void 0,function(){return(0,M.__generator)(this,function(Ae){switch(Ae.label){case 0:return[4,this.getLastRefreshTimestamp(n.id,t)];case 1:return A=Ae.sent(),a===A?y.next():(u.fF.assertValue(A>a,"Expected new refresh history count to be higher"),y.complete()),[2]}})})}),y.next(),[4,O.toPromise()];case 1:return ue.sent(),i?.refreshGoal?[4,this.scorecardService.refreshGoal(n.id)]:[3,3];case 2:ue.sent(),ue.label=3;case 3:return i?.refreshGoalValues?[4,this.scorecardService.expandGoalValues(n.id,!0)]:[3,5];case 4:ue.sent(),ue.label=5;case 5:return i?.refreshRollups&&n.parentId?[4,this.startRollupPolling(n.parentId,t,A)]:[3,7];case 6:ue.sent(),ue.label=7;case 7:return[4,null===(te=i?.onComplete)||void 0===te?void 0:te.call(i,A)];case 8:return ue.sent(),[3,10];case 9:return this.setGoalRefreshState(n.id,t,!1),[7];case 10:return[2]}})}),[2]}})})},o.prototype.refreshRollups=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l,c,p,y,O,A,L;return(0,M.__generator)(this,function(Ae){switch(Ae.label){case 0:if(!n.parentId||null!=n.valuesCategoryId)return[3,2];if(i=[],a=this.scorecardService.getCurrentScorecard(),!(l=W.getGoal(a.goals,n.parentId)))return[3,2];for(c=!1,p=!1,y=function(Je){var ze=new Date(Je.timestamp).getTime(),ot=_.find(n.goalValues,function(ft){return new Date(ft.timestamp).getTime()===ze});if(O.isPartOfParentGoalRollup(l.valueRollup,Je)&&(c||(c=ot?.value!==Je.value)),O.isPartOfParentGoalRollup(l.targetRollup,Je)&&(p||(p=ot?.target!==Je.target)),c&&p)return"break"},O=this,A=0,L=t;A<L.length&&"break"!==y(L[A]);A++);return c&&i.push(this.startRollupPolling(n.parentId,1)),p&&i.push(this.startRollupPolling(n.parentId,2)),_.some(i)?[4,Promise.all(i)]:[3,2];case 1:Ae.sent(),Ae.label=2;case 2:return[2]}})})},o.prototype.refreshRollupsAfterMove=function(n){var t;return(0,M.__awaiter)(this,void 0,void 0,function(){var i,l,c,p,y,O,A;return(0,M.__generator)(this,function(L){switch(L.label){case 0:return i=this.scorecardService.getCurrentScorecard(),null!=W.getGoal(i.goals,n.goalToMove.goalId).valuesCategoryId?[2]:(l=[],c=[],null!=n.goalToMove.currentParentId&&(l.push.apply(l,W.getGoalsWithRollups(i.goals,p=n.goalToMove.currentParentId,1)),c.push.apply(c,W.getGoalsWithRollups(i.goals,p,2))),null!=(null===(t=n.newParent)||void 0===t?void 0:t.goalId)&&(O=W.getGoalsWithRollups(i.goals,y=n.newParent.goalId,1),A=W.getGoalsWithRollups(i.goals,y,2),l=this.mergeParents(l,O),c=this.mergeParents(c,A)),[4,Promise.all([this.startRollupPollingForGoals(l,1),this.startRollupPollingForGoals(c,2)])]);case 1:return L.sent(),[2]}})})},o.prototype.refreshRollupsAfterGoalDelete=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l,y=this;return(0,M.__generator)(this,function(O){switch(O.label){case 0:return n.parentId&&null==n.valuesCategoryId?(t=this.scorecardService.getCurrentScorecard(),(i=W.getGoal(t.goals,n.parentId))?(a=[],l=[],_.isNil(i.valueRollup)||_.some(n.goalValues,function(A){return!_.isNil(A.value)&&y.isPartOfParentGoalRollup(i.valueRollup,A)})&&a.push.apply(a,W.getGoalsWithRollups(t.goals,i.id,1)),_.isNil(i.targetRollup)||_.some(n.goalValues,function(A){return!_.isNil(A.target)&&y.isPartOfParentGoalRollup(i.targetRollup,A)})&&l.push.apply(l,W.getGoalsWithRollups(t.goals,i.id,2)),[4,Promise.all([this.startRollupPollingForGoals(a,1),this.startRollupPollingForGoals(l,2)])]):[3,2]):[3,2];case 1:O.sent(),O.label=2;case 2:return[2]}})})},o.prototype.refreshRollupsAfterGoalValueDelete=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l,c;return(0,M.__generator)(this,function(O){switch(O.label){case 0:return n.parentId&&null==n.valuesCategoryId?(i=this.scorecardService.getCurrentScorecard(),(a=W.getGoal(i.goals,n.parentId))?(l=[],c=[],_.isNil(a.valueRollup)||!_.isNil(t.value)&&this.isPartOfParentGoalRollup(a.valueRollup,t)&&l.push.apply(l,W.getGoalsWithRollups(i.goals,a.id,1)),_.isNil(a.targetRollup)||!_.isNil(t.target)&&this.isPartOfParentGoalRollup(a.targetRollup,t)&&c.push.apply(c,W.getGoalsWithRollups(i.goals,a.id,2)),[4,Promise.all([this.startRollupPollingForGoals(l,1),this.startRollupPollingForGoals(c,2)])]):[3,2]):[3,2];case 1:O.sent(),O.label=2;case 2:return[2]}})})},o.prototype.isPartOfParentGoalRollup=function(n,t){return n&&(_.isNil(n.startDate)||new Date(t.timestamp).getTime()>=new Date(n.startDate).getTime())},o.prototype.startRollupPolling=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l;return(0,M.__generator)(this,function(c){switch(c.label){case 0:return a=this.scorecardService.getCurrentScorecard(),l=W.getGoalsWithRollups(a.goals,n,t),[4,this.startRollupPollingForGoals(l,t,i)];case 1:return c.sent(),[2]}})})},o.prototype.startRollupPollingForGoals=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l=this;return(0,M.__generator)(this,function(c){switch(c.label){case 0:return _.some(n)?(a=n.shift(),[4,this.startPollingAsync(a,t,{lastRefreshTimestamp:i,refreshGoal:!0,refreshGoalValues:!0,onComplete:function(y){return l.startRollupPollingForGoals(n,t,y)}})]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})},o.prototype.getLastRefreshTimestamp=function(n,t){var i;return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l,c;return(0,M.__generator)(this,function(y){switch(y.label){case 0:return a=this.ConnectionTypeAsText[t],[4,this.scorecardService.getRefreshHistory(n)];case 1:return l=y.sent(),c=_.filter(l,function(O){return O.connectionType===t||O.connectionType===a}),[2,null===(i=_.maxBy(c,function(O){return O.timestamp}))||void 0===i?void 0:i.timestamp]}})})},o.prototype.mergeParents=function(n,t){if(!_.some(n))return t;var i=_.intersectionBy(n,t,function(p){return p.id});if(_.isEmpty(i))return(0,M.__spreadArray)((0,M.__spreadArray)([],n,!0),t,!0);for(var a=_.findIndex(t,function(p){return p.id===i[0].id}),l=[],c=0;c<a;c++)l.push(t[c]);return l.push.apply(l,n),l},o.prototype.setGoalRefreshState=function(n,t,i){this.scorecardService.setGoalRefreshState(n,t,i)},o}(),Te=m(41114),Ve="PBI.Goal.ContextMenu.CreateAPowerAutomateFlow",yt=(Te.cx[Ve]=(0,Te.b1)(Ve),"PBI.Goal.TargetsEditor.Action.Opened"),tt=Te.cx[yt]=(0,Te.b1)(yt),zt="PBI.Goal.TargetsEditor.Action.Canceled",k=Te.cx[zt]=(0,Te.b1)(zt),Cn="PBI.Goal.TargetsEditor.Action.Done",It=Te.cx[Cn]=(0,Te.b1)(Cn),nt="PBI.Goal.ValuesEditor.Action.Opened",be=Te.cx[nt]=(0,Te.b1)(nt),de="PBI.Goal.ValuesEditor.Action.Canceled",V=Te.cx[de]=(0,Te.b1)(de),lt="PBI.Goal.ValuesEditor.Action.Done",Xt=Te.cx[lt]=(0,Te.b1)(lt),sn="PBI.ScorecardHeader.LabelInlineEdit",Mn=Te.cx[sn]=(0,Te.b1)(sn),fn="PBI.ScorecardHeader.DescriptionInlineEdit",jt=Te.cx[fn]=(0,Te.b1)(fn),Tt=function(o){return o.Manual="Manual",o.Connect="Connect",o.Rollup="Rollup",o}({}),Dt="PBI.WebScorecard.SaveCurrentValueSelection",ke=Te.cx[Dt]=(0,Te.b1)(Dt),_e="PBI.WebScorecard.SaveTargetValueSelection",S=Te.cx[_e]=(0,Te.b1)(_e),f="PBI.DatasetDetailsPage.GoalRollupsCoachmarkTriggered",E=Te.cx[f]=(0,Te.b1)(f),x="PBI.DatasetDetailsPage.GoalRollupsDetailsPaneCoachmarkTriggered",U=Te.cx[x]=(0,Te.b1)(x),le="PBI.Scorecard.ChangeViewType",Pe=Te.cx[le]=(0,Te.b1)(le),qe="PBI.Scorecard.Hierarchies.Builder.Open",St=Te.cx[qe]=(0,Te.b1)(qe),Et=function(){function o(){}return o.getGoalValueMap=function(n){var t=new Map;if(_.isEmpty(n))return t;for(var i=0,a=n;i<a.length;i++){var l=a[i];t.set(new Date(l.timestamp).getTime(),l)}return t},o.areGoalValuesEqual=function(n,t,i,a){return u.fF.assertValue(n,"goalValueOne"),u.fF.assertValue(t,"goalValueTwo"),!(!i&&n.value!==t.value||!a&&n.target!==t.target||n.trend!==t.trend||n.forecast!==t.forecast||n.status!==t.status)},o.diffGoalValues=function(n,t){u.fF.assertValue(n,"goalValueOne"),u.fF.assertValue(t,"goalValueTwo");var i={timestamp:n.timestamp,goalId:n.goalId,scorecardId:n.scorecardId,createdTime:n.createdTime,lastModifiedTime:n.lastModifiedTime};return n.value!==t.value&&(i.value=n.value),n.target!==t.target&&(i.target=n.target),n.trend!==t.trend&&(i.trend=n.trend),n.forecast!==t.forecast&&(i.forecast=n.forecast),n.status!==t.status&&(i.status=n.status),i},o.calculateGoalValueChanges=function(n,t){for(var i=[],a=new Map,l=0,c=n;l<c.length;l++){var p=c[l],y=new Date(p.timestamp).getTime();a.set(y,p.value)}for(var O=0,A=t;O<A.length;O++)p=A[O],y=new Date(p.timestamp).getTime(),a.has(y)?p.value!==a.get(y)&&i.push(p):i.push(p);for(var L=new Set,te=0,ue=t;te<ue.length;te++)p=ue[te],y=new Date(p.timestamp).getTime(),L.add(y);for(var Ae=0,Ne=n;Ae<Ne.length;Ae++)p=Ne[Ae],y=new Date(p.timestamp).getTime(),L.has(y)||i.push({timestamp:p.timestamp,value:null});return i},o}(),at=m(74076),Lt=new e.InjectionToken("GoalsHttpService"),en=new e.InjectionToken("ScorecardHostService"),on=new e.InjectionToken("ScorecardSettingsService"),An=m(10723),er=m(50547),gr=m(43286),Ft=m(85732),Ri=((0,Ft.PH)("[Tab] Init"),(0,Ft.PH)("[Tab] Noop"),(0,Ft.PH)("[Tab] Setup Router Hook"),(0,Ft.PH)("[Tab] Select Tab",(0,Ft.Ky)())),Li=(0,Ft.PH)("[Tab] Update Tab",(0,Ft.Ky)()),pa=(0,Ft.PH)("[Tab] Add Tabs After Refresh",(0,Ft.Ky)()),Ya=(0,Ft.PH)("[Tab] Update Tab After Open",(0,Ft.Ky)()),bo=(0,Ft.PH)("[Tab] Remove Tab",(0,Ft.Ky)()),Jr=(0,Ft.PH)("[Tab] Delete PBI Artifact In Tab",(0,Ft.Ky)()),Gi=((0,Ft.PH)("[Tab] Delete Trident Artifact In Tab",(0,Ft.Ky)()),(0,Ft.PH)("[Tab] Init Tab",(0,Ft.Ky)())),Ni=(0,Ft.PH)("[Tab] Init Tab Success",(0,Ft.Ky)()),Hi=(0,Ft.PH)("[Tab] Init Tab Failure",(0,Ft.Ky)()),zi=(0,Ft.PH)("[Tab] Close Tab",(0,Ft.Ky)()),es=((0,Ft.PH)("[Tab] Close Foreground Tab"),(0,Ft.PH)("[Tab] Close Background Tab",(0,Ft.Ky)()),(0,Ft.PH)("[Tab] Destroy Tab",(0,Ft.Ky)())),fr=(0,Ft.PH)("[Tab] Destroy Tab Success",(0,Ft.Ky)()),J=(0,Ft.PH)("[Tab] Destroy Tab Failure",(0,Ft.Ky)()),ir=(0,Ft.PH)("[Tab] Delete",(0,Ft.Ky)()),wo=(0,Ft.PH)("[Tab] Move Tab To Top",(0,Ft.Ky)()),Bi=(0,Ft.PH)("[Tab] Open Tab In Background",(0,Ft.Ky)()),ts=(0,Ft.PH)("[Tab] Execute Open Tab In Background",(0,Ft.Ky)()),wn=(0,m(8894).H)({selectId:function(n){return n.id}}),wr=(0,Ft.ZF)("tab"),ns=(0,Ft.P1)(wr,function(o){return wn.getSelectors().selectAll(o.tabs).filter(function(n){return"destroying"!==n.status})}),is=((0,Ft.P1)(wr,function(o){return o.selectedTabId?wn.getSelectors().selectEntities(o.tabs)[o.selectedTabId]:void 0}),function(){function o(n){this.store=n,this.tabs$=this.store.select(ns)}return o.prototype.closeTab=function(n){this.store.dispatch(zi({id:n}))},o.prototype.updateTab=function(n){var t=n.id,i=(0,M.__rest)(n,["id"]);this.store.dispatch(Li({id:t,changes:i}))},o.prototype.deletePBIArtifactInTab=function(n){this.store.dispatch(Jr({id:n.id}))},o.prototype.moveTabToTop=function(n){this.store.dispatch(wo({id:n}))},o.prototype.openInBackground=function(n,t){this.store.dispatch(Bi({urlPath:n,displayName:t}))},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Ft.yh))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"}),o}()),Wn=(m(94771),m(16559),m(35030),m(86668),m(73471),m(89082),m(41838),m(36012)),Wi=m(71477),va=m(33827),Yn=m(25082),cs={tabs:wn.getInitialState(),selectedTabId:void 0};function So(o,n){for(var t=0,i=Object.values(o.tabs.entities);t<i.length;t++){var a=i[t];a&&a.associatedArtifactObjectId===n.objectId&&a.title!==n.displayName&&(o.tabs=wn.updateOne({id:a.id,changes:{title:n.displayName}},o.tabs))}}(0,Ft.Lq)(cs,(0,Wn.P)(Ri,function(o,n){var t=n.id;t?o.tabs.entities[t]&&(o.selectedTabId=t):o.selectedTabId=void 0}),(0,Wn.P)(Li,function(o,n){var i=(0,M.__rest)(n,["type"]);o.tabs=wn.updateOne(i,o.tabs)}),(0,Wn.P)(Gi,function(o,n){var i=(0,M.__rest)(n,["type"]);o.tabs=wn.upsertOne((0,M.__assign)((0,M.__assign)({},i),{status:"initializing"}),o.tabs)}),(0,Wn.P)(Ni,function(o,n){o.tabs=wn.updateOne({id:n.id,changes:{status:"initialized",title:n.title,associatedArtifactObjectId:n.associatedArtifactObjectId}},o.tabs)}),(0,Wn.P)(Hi,function(o,n){o.tabs=wn.removeOne(n.id,o.tabs)}),(0,Wn.P)(es,function(o,n){o.tabs=wn.updateOne({id:n.id,changes:{status:"destroying"}},o.tabs)}),(0,Wn.P)(fr,J,bo,function(o,n){o.tabs=wn.removeOne(n.id,o.tabs)}),(0,Wn.P)(va._t,function(o,n){for(var i=0,a=n.artifacts;i<a.length;i++)So(o,a[i])}),(0,Wn.P)(Yn.j$.loadArtifactSuccess,Yn.j$.updateArtifactSuccess,Yn.j$.optimisticallyUpdateArtifactSuccess,Wi.W2,Wi.C2,Wi.lK,function(o,n){So(o,n.artifact)}),(0,Wn.P)(wo,function(o,n){for(var t=n.id,i=o.tabs.ids.slice(0),a=0;a<i.length;a++)if(i[a]===t){i.splice(a,1),i.push(t),o.tabs.ids=i;break}}),(0,Wn.P)(ir,function(o,n){o.tabs=wn.removeOne(n.id,o.tabs)}),(0,Wn.P)(pa,function(o,n){var i=n.tabs.filter(function(a){return!o.tabs.ids.includes(a.id)}).map(function(a){return a.status="refreshed",a.dirty=!1,a});i.length>0&&(o.tabs=wn.addMany(i,o.tabs))}),(0,Wn.P)(ts,function(o,n){o.tabs.ids.includes(n.id)||(o.tabs=wn.addOne(n,o.tabs))}),(0,Wn.P)(Ya,function(o,n){var i=(0,M.__rest)(n,["type"]);o.tabs=wn.updateOne(i,o.tabs)}));var bt=m(74466),Gr=m(33554),zn=m(59017),dt=m(14172),Mo=m(68549),Rn=m(81905),hn=m(58938),Po=m(81213),Vt=m(65181),_a=m(32140),Ln=m(9380),Oo=function(){function o(n,t){this.errorService=n,this.localizationService=t}return o.prototype.showUserError=function(n,t,i){var a;void 0===i&&(i="GenericErrorDescription"),this.errorService.error(this.localizationService.get(i),t,{requestId:n?.requestId,statusCode:null===(a=n?.status)||void 0===a?void 0:a.toString()})},o.prototype.showThrottlingError=function(){this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("You_Have_Exceeded_Limit_Try_Again_Later"),"throttling",{title:this.localizationService.get("Rate_Limit_Is_Exceeded"),level:er.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Po.T),e.\u0275\u0275inject(Vt.o))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),ji=m(96608),gt=function(){function o(n,t,i,a,l,c,p,y,O,A,L,te,ue){var Ne,Je,Ae=this;this.goalsHttpService=n,this.userDetailsService=t,this.dialogService=i,this.errorService=a,this.localizationService=l,this.userInfo=c,this.featureSwitches=p,this.goalsErrorService=y,this.telemetryService=O,this.tabFacade=A,this.store=L,this.scorecardHost=te,this.scorecardSettings=ue,this.scorecard=void 0,this._scorecard$=new Gr.t(1),this._selectedGoalIds$=this._scorecard$.pipe((0,dt.U)(function(ze){return ze?.selectedGoalIds}),(0,G.x)(_.isEqual)),this._activeGoalId$=this._scorecard$.pipe((0,dt.U)(function(ze){return ze?.activeGoalId}),(0,G.x)()),this.isEditMode$=new ye.X(!1),this.loading$=new ye.X(0),this._viewType$=new ye.X("List"),this._scorecardSelectionMode$=new ye.X(null),this.switchingHierarchyPath$=new ye.X(!1),this.linkedScorecardsById={},this._goalStatusesByScorecardId$=new ye.X({}),this.onHierarchyNotFound$=new je.xQ,this.onDestroy$=new je.xQ,this.requestId=0,this.pollingService=new Ge(this),this.scorecardHost&&(this.getSelectedGoalsObservable().pipe((0,We.R)(this.onDestroy$)).subscribe(function(ze){Ae.scorecardHost.onSelectGoals(ze)}),this._scorecard$.pipe((0,dt.U)(function(ze){return ze.hierarchyPaths}),(0,G.x)(),(0,We.R)(this.onDestroy$)).subscribe(function(ze){Ae.scorecardHost.onChangeHierarchyPath(ze)})),this._scorecard$.pipe((0,G.x)(function(ze,ot){var ft,xt;return _.isEqual(null===(ft=ze?.goalStatuses)||void 0===ft?void 0:ft.statuses,null===(xt=ot?.goalStatuses)||void 0===xt?void 0:xt.statuses)&&ze?.linkedScorecards===ot?.linkedScorecards}),(0,dt.U)(function(ze){return Q.p.getGoalStatusesByScorecardId(ze)}),(0,We.R)(this.onDestroy$)).subscribe(this._goalStatusesByScorecardId$),(0,zn.aj)([this.isEditMode$,this.viewType$,null!==(Je=null===(Ne=this.scorecardSettings)||void 0===Ne?void 0:Ne.settings)&&void 0!==Je?Je:(0,me.of)({})]).pipe((0,dt.U)(function(ze){var ot=ze[0],ft=ze[1],xt=ze[2];return"tile"===xt?.displayMode?Ae.featureSwitches.featureSwitches.multipleGoalTilesVisual?"multiple":"single":xt?.useMultiselectMode?"multiple":"List"===ft&&ot?"ctrl":null}),(0,G.x)(),(0,We.R)(this.onDestroy$)).subscribe(this._scorecardSelectionMode$)}return o.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},o.prototype.loadScorecard=function(n,t,i,a){var l=this;if(W.isEditing(this.scorecard)&&!i)this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription"),okButtonText:this.localizationService.get("Refresh"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(l,void 0,void 0,function(){return(0,M.__generator)(this,function(y){return[2,this.loadScorecard(n,t,!0,a)]})})}});else{this.loading$.next(this.loading$.value+1),this.requestId++;var c=this.requestId;this.goalsHttpService.getScorecard(n,t,!0,a).toPromise().then(function(p){l.loading$.next(l.loading$.value-1),!(c<l.requestId)&&(l.switchingHierarchyPath$.next(!1),l.setScorecardWithGoals(p))}).catch(function(p){if(l.loading$.next(l.loading$.value-1),!(c<l.requestId)){if(l.switchingHierarchyPath$.next(!1),_.isEmpty(a))l.scorecard=null;else if(l.goalsErrorService.showUserError(p,"LoadHierarchy","MetricsHierarchy_Loading_Error"),404===p?.status&&(l.setActiveHierarchy(void 0,!0),l.onHierarchyNotFound$.next(a),!l.scorecard))return;l.commit()}})}return this._scorecard$.asObservable()},o.prototype.setActiveHierarchy=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a=this;return(0,M.__generator)(this,function(l){switch(l.label){case 0:return i=function(p,y){return _.isEmpty(p)&&_.isEmpty(y)||_.isEqual(p,y)},this.scorecard&&!i(this.scorecard.hierarchyPaths,n)?W.isEditing(this.scorecard)&&!t?[2,this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(a,void 0,void 0,function(){return(0,M.__generator)(this,function(p){return[2,this.setActiveHierarchy(n,!0)]})})}})]:[3,1]:[3,3];case 1:return this.switchingHierarchyPath$.next(!0),[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0,n).pipe((0,Mo.o)(function(c){return!i(c.hierarchyPaths,n)},!0)).toPromise()];case 2:return[2,l.sent()];case 3:return[2]}})})},Object.defineProperty(o.prototype,"onHierarchyNotFound",{get:function(){return this.onHierarchyNotFound$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isHierarchicalScorecard",{get:function(){var t;return!_.isEmpty(null===(t=this.scorecard)||void 0===t?void 0:t.hierarchyPaths)},enumerable:!1,configurable:!0}),o.prototype.assertNoActivehierarchy=function(n){return void 0===n&&(n=!1),!this.isHierarchicalScorecard||(n?this.dialogService.showSimpleDialog(this.localizationService.get("Coming_Soon"),this.localizationService.get("MetricsHierarchy_ComingSoon")):u.fF.assertFail("Cannot perform this operation on a hierarchical scorecard. ".concat((new Error).stack)),!1)},Object.defineProperty(o.prototype,"hierarchyPaths$",{get:function(){return this._scorecard$.pipe((0,dt.U)(function(t){return t?.hierarchyPaths}),(0,G.x)())},enumerable:!1,configurable:!0}),o.prototype.assertScorecardLoaded=function(n){return!(n.id!==this.scorecard.id||!_.isEqual(n.hierarchyPaths,this.scorecard.hierarchyPaths))||(u.fF.assertFail("Scorecard has changed. Active scorecard: ".concat(JSON.stringify(this.scorecard.hierarchyPaths),". Previous scorecard ").concat(JSON.stringify(n.hierarchyPaths))),!1)},o.prototype.isSwitchingHierarchyPath=function(){return this.switchingHierarchyPath$.asObservable()},o.prototype.saveGoal=function(n,t){var i,a,l,c,p,y;return(0,M.__awaiter)(this,void 0,void 0,function(){var O,A,L,te,ue,Ae,Ne,Je=this;return(0,M.__generator)(this,function(ze){switch(ze.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),O=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(O,"goal"),A=W.isGoalMetadataUpdated(O,t),!O.isNew&&!A)return[2,n];if(L=(null===(i=t.metadata)||void 0===i?void 0:i.showFinalTarget)!==(null===(a=O.metadata)||void 0===a?void 0:a.showFinalTarget)||(null===(l=t.metadata)||void 0===l?void 0:l.showPercentChange)!==(null===(c=O.metadata)||void 0===c?void 0:c.showPercentChange)||!_.isEqual(null!==(p=O.cycleMetadata)&&void 0!==p?p:{},null!==(y=t.cycleMetadata)&&void 0!==y?y:{}),!this.assertNoActivehierarchy(!0))return[2,n];ze.label=1;case 1:return ze.trys.push([1,9,,10]),te=this.scorecard,O.isNew?[4,this.goalsHttpService.createGoal(this.scorecard.groupId,this.scorecard.id,W.getGoalCreateRequest(t)).toPromise()]:[3,5];case 2:return ue=ze.sent(),t.metadata?[4,this.goalsHttpService.updateGoal(this.scorecard.groupId,this.scorecard.id,ue.id,{metadata:t.metadata}).toPromise()]:[3,4];case 3:ue=ze.sent(),ze.label=4;case 4:return[3,7];case 5:return A?[4,this.goalsHttpService.updateGoal(this.scorecard.groupId,this.scorecard.id,O.id,W.getGoalUpdateRequest(t)).toPromise()]:[3,7];case 6:ue=ze.sent(),ze.label=7;case 7:return this.assertScorecardLoaded(te)?[4,this.getOwnerDisplayNames(O)]:[2];case 8:return Ae=ze.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(ot){var ft=W.getGoal(ot.goals,n);Je.assignGoal(ft,ue),ft.isNew=!1,ft.ownerDisplayNames=Ae}),n=ue.id,[3,10];case 9:throw Ne=ze.sent(),this.goalsErrorService.showUserError(Ne,"SaveGoalError"),Ne;case 10:return L?[4,this.refreshGoal(n)]:[3,12];case 11:return ze.sent(),[3,13];case 12:this.commit(),ze.label=13;case 13:return[2,n]}})})},o.prototype.moveGoal=function(n,t,i){var a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y,L,te;return(0,M.__generator)(this,function(ue){switch(ue.label){case 0:return u.fF.assertValue(this.scorecard,"No scorecard loaded"),u.fF.assertValue(this.scorecard.goals,"Scorecard should have at least one goal to move"),this.assertNoActivehierarchy()?(l=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(l,"Source goal does not exist"),c=W.computeGoalHeight(l),p=i?W.getGoal(this.scorecard.goals,i):void 0,u.fF.assertValue(!i||p,"Destination parent goal does not exist"),y=p?W.computeGoalLevel(this.scorecard.goals,p):void 0,(_.isNil(y)?c:c+y+1)>ne.gT.MaxSubGoals?[4,this.dialogService.showSimpleInfoDialog({title:this.localizationService.get("MetricCannotBeMovedTitle"),message:this.localizationService.format("MetricCannotBeMovedMessage",ne.gT.MaxSubGoals)},{autoFocus:!0}).afterClosed().toPromise()]:[3,2]):[2];case 1:return ue.sent(),[2];case 2:L={goalToMove:{goalId:n}},this.scorecard=(0,bt.Uy)(this.scorecard,function(Ae){var Ne,Je,ze,ot,ft=W.getGoal(Ae.goals,n);L.goalToMove.currentParentId=null!==(Ne=ft.parentId)&&void 0!==Ne?Ne:void 0;var xt=ft.parentId?W.getGoal(Ae.goals,ft.parentId):void 0;ft.parentId&&!xt||_.remove(ft.parentId?xt.subGoals:Ae.goals,function(Wt){return Wt.id===ft.id});var kt=i?W.getGoal(Ae.goals,i):void 0;kt&&(L.newParent={goalId:kt.id,currentParentId:null!==(Je=kt.parentId)&&void 0!==Je?Je:void 0});var Rt=kt?kt.subGoals:Ae.goals;if(Rt){var Y=t?Rt.findIndex(function(Wt){return Wt.id===t}):Rt.length;u.fF.assertValue(-1!==Y,"Destination next goal does not exist");var Ie=Y-1>=0?Rt[Y-1]:void 0;Ie&&(L.newPrevious={goalId:Ie.id,currentParentId:null!==(ze=Ie.parentId)&&void 0!==ze?ze:void 0});var Le=Y<Rt.length?Rt[Y]:void 0;u.fF.assertValue(!Le||Le.parentId===i,"Destination next goal parent should be the same as the destination parent goal"),Le&&(L.newNext={goalId:Le.id,currentParentId:null!==(ot=Le.parentId)&&void 0!==ot?ot:void 0}),Rt.splice(Y,0,ft);var Mt=0;Rt.forEach(function(Wt){Wt.rank=Mt,Mt++})}else ft.rank=0,kt.subGoals=[ft];return ft.parentId=i,ft.state="Saving",Ae}),this.loading$.next(this.loading$.value+1),this.commit(),ue.label=3;case 3:return ue.trys.push([3,6,10,11]),[4,this.pollingService.refreshRollupsAfterMove(L)];case 4:return ue.sent(),[4,this.goalsHttpService.moveGoal(this.scorecard.groupId,this.scorecard.id,L).toPromise()];case 5:return ue.sent(),this.setGoalState(n,"Consumption"),[3,11];case 6:return te=ue.sent(),(null===(a=te?.error)||void 0===a?void 0:a.code)!==fe.CircularRelationshipsNotAllowed?[3,8]:[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0)];case 7:return ue.sent(),this.dialogService.showSimpleDialog(this.localizationService.get("Unable_to_move_metric"),this.localizationService.get("Metrics_Circular_Relationships_Not_Allowed")),[3,9];case 8:throw this.goalsErrorService.showUserError(te,"MoveGoalError"),te;case 9:return[3,11];case 10:return this.loading$.next(this.loading$.value-1),[7];case 11:return[2]}})})},o.prototype.refreshGoal=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l,c=this;return(0,M.__generator)(this,function(p){switch(p.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),p.label=1;case 1:return p.trys.push([1,4,,5]),t=this.scorecard,[4,this.goalsHttpService.getGoal(this.scorecard.groupId,this.scorecard.id,n,!1,this.scorecard.hierarchyPaths).toPromise()];case 2:return i=p.sent(),this.assertScorecardLoaded(t)?[4,this.getOwnerDisplayNames(i)]:[2];case 3:return a=p.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(y){var O=W.getGoal(y.goals,n);c.assignGoal(O,i),O.ownerDisplayNames=a}),[3,5];case 4:throw l=p.sent(),this.goalsErrorService.showUserError(l,"RefreshGoalError"),l;case 5:return this.commit(),[2]}})})},o.prototype.saveGoalValue=function(n,t){var i,a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y,O,A;return(0,M.__generator)(this,function(L){switch(L.label){case 0:return u.fF.assertValue(this.scorecard,"No scorecard loaded"),[4,this.expandGoalValues(n)];case 1:L.sent(),l=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(l,"goal"),c=_.find(l.goalValues,function(te){return new Date(te.timestamp).getTime()===new Date(t.timestamp).getTime()}),u.fF.assert(function(){return!l.valueConnection||_.isNil(t.value)},"Value cannot be updated when it is connected to data"),u.fF.assert(function(){return!l.targetConnection||_.isNil(t.target)},"Target cannot be updated when it is connected to data"),l.hasStatusRules&&(t.status=null),L.label=2;case 2:return L.trys.push([2,9,15,16]),this.loading$.next(this.loading$.value+1),[4,this.pollingService.refreshRollups(l,[t])];case 3:return L.sent(),p=this.scorecard,c?[4,this.goalsHttpService.updateGoalValue(this.scorecard.groupId,this.scorecard.id,n,new Date(t.timestamp).toISOString(),W.getGoalValueUpdateRequest(t),this.scorecard.hierarchyPaths).toPromise()]:[3,5];case 4:return y=L.sent(),this.assertScorecardLoaded(p)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(te){var ue=W.getGoal(te.goals,n);u.fF.assertValue(ue,"Goal not found");var Ae=_.find(ue.goalValues,function(Ne){return new Date(Ne.timestamp).getTime()===new Date(y.timestamp).getTime()});u.fF.assertValue(Ae,"Goal value not found"),Object.assign(Ae,y)}),[3,7]):[2];case 5:return[4,this.goalsHttpService.createGoalValue(this.scorecard.groupId,this.scorecard.id,n,W.getGoalValueCreateRequest(t),this.scorecard.hierarchyPaths).toPromise()];case 6:if(O=L.sent(),!this.assertScorecardLoaded(p))return[2];this.scorecard=(0,bt.Uy)(this.scorecard,function(te){var ue=W.getGoal(te.goals,n);u.fF.assertValue(ue,"Goal not found"),ue.goalValues?ue.goalValues.push(O):ue.goalValues=[O]}),L.label=7;case 7:return[4,this.refreshGoal(n)];case 8:return L.sent(),[3,16];case 9:if(A=L.sent(),(null===(i=A?.error)||void 0===i?void 0:i.code)!==fe.ManuallyUpdatingConnectedGoalValueNotAllowed&&(null===(a=A?.error)||void 0===a?void 0:a.code)!==fe.ManuallyUpdatingConnectedMetricValueNotAllowed)return[3,10];throw this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("Updating_Connected_MetricValue_Not_Allowed"),"Not_Allowed",{title:this.localizationService.get("Operation_Not_Allowed"),level:er.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1}),A;case 10:return c||409!==A?.status?[3,13]:(this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("Metrics_Existing_Checkin_Found"),"Checkin_Exists",{title:this.localizationService.get("Metrics_Existing_Checkin_Found_Title"),level:er.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1,hideGetHelpLink:!0}),[4,this.refreshGoal(n)]);case 11:return L.sent(),[4,this.expandGoalValues(n,!0)];case 12:return L.sent(),[3,14];case 13:throw this.goalsErrorService.showUserError(A,"SaveGoalValueError"),A;case 14:return[3,16];case 15:return this.loading$.next(this.loading$.value-1),[7];case 16:return this.commit(),[2]}})})},o.prototype.expandGoalValues=function(n,t){return void 0===t&&(t=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l,c;return(0,M.__generator)(this,function(p){switch(p.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2];if(i=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(i,"goal"),!i||i.isExpanded&&!t)return[2];p.label=1;case 1:return p.trys.push([1,3,4,5]),this.loading$.next(this.loading$.value+1),a=this.scorecard,[4,this.goalsHttpService.getGoalValues(this.scorecard.groupId,this.scorecard.id,i.id,!0,this.scorecard.hierarchyPaths).toPromise()];case 2:return l=p.sent(),this.assertScorecardLoaded(a)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(y){var O=W.getGoal(y.goals,n);u.fF.assertValue(O,"goal"),O.goalValues=l,O.isExpanded=!0}),this.commit(),[3,5]):[2];case 3:throw c=p.sent(),this.goalsErrorService.showUserError(c,"ExpandGoalValues"),c;case 4:return this.loading$.next(this.loading$.value-1),[7];case 5:return[2]}})})},o.prototype.upsertGoalValues=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l;return(0,M.__generator)(this,function(c){switch(c.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];i=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(i,"goal"),c.label=1;case 1:return c.trys.push([1,5,6,7]),this.loading$.next(this.loading$.value+1),[4,this.pollingService.refreshRollups(i,t)];case 2:return c.sent(),[4,this.goalsHttpService.upsertGoalValues(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return a=c.sent(),[4,this.refreshGoal(n)];case 4:return c.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(p){var y=W.getGoal(p.goals,n);y.goalValues=a,y.isExpanded=!0}),this.commit(),[3,7];case 5:throw l=c.sent(),this.goalsErrorService.showUserError(l,"UpsertGoalValues"),l;case 6:return this.loading$.next(this.loading$.value-1),[7];case 7:return[2]}})})},o.prototype.overwriteMultipleGoalValues=function(n,t){var i,a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y,O;return(0,M.__generator)(this,function(A){switch(A.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.expandGoalValues(n)]:[2];case 1:return A.sent(),c=W.getGoal(this.scorecard.goals,n),p=null!==(a=null===(i=c.goalValues)||void 0===i?void 0:i.filter(function(L){return!_.isNil(L.value)}).map(function(L){return{timestamp:L.timestamp,value:L.value}}))&&void 0!==a?a:[],y=t.map(function(L){return{timestamp:L.timestamp,value:L.value}}),(l=Et.calculateGoalValueChanges(p,y)).length>0?(O=l.map(function(L){return{timestamp:L.timestamp,value:L.value}}),[4,this.upsertGoalValues(n,O)]):[3,3];case 2:A.sent(),A.label=3;case 3:return[2]}})})},o.prototype.overwriteGoalTargets=function(n,t){var i,a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y,O;return(0,M.__generator)(this,function(A){switch(A.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.expandGoalValues(n)]:[2];case 1:return A.sent(),l=W.getGoal(this.scorecard.goals,n),c=null!==(a=null===(i=l.goalValues)||void 0===i?void 0:i.filter(function(L){return!_.isNil(L.target)}).map(function(L){return{timestamp:L.timestamp,value:L.target}}))&&void 0!==a?a:[],p=t.map(function(L){return{timestamp:L.timestamp,value:L.target}}),(y=Et.calculateGoalValueChanges(c,p)).length>0?(O=y.map(function(L){return{timestamp:L.timestamp,target:L.value}}),[4,this.upsertGoalValues(n,O)]):[3,3];case 2:A.sent(),A.label=3;case 3:return[2]}})})},o.prototype.followGoal=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(W.isSampleScorecard(this.scorecard))return[2];u.fF.assertValue(this.scorecard,"No scorecard loaded"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.goalsHttpService.followGoal(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return i.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(a){var l=W.getGoal(a.goals,n);u.fF.assertValue(l,"Goal not found"),l.isFollowed=!0}),this.commit(),[3,4];case 3:throw t=i.sent(),this.goalsErrorService.showUserError(t,"Follow Metric Error"),t;case 4:return[2]}})})},o.prototype.unfollowGoal=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(W.isSampleScorecard(this.scorecard))return[2];u.fF.assertValue(this.scorecard,"No scorecard loaded"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.goalsHttpService.unfollowGoal(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return i.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(a){var l=W.getGoal(a.goals,n);u.fF.assertValue(l,"Goal not found"),l.isFollowed=!1}),this.commit(),[3,4];case 3:throw t=i.sent(),this.goalsErrorService.showUserError(t,"Unfollow Metric Error"),t;case 4:return[2]}})})},o.prototype.editNote=function(n,t,i,a){return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p;return(0,M.__generator)(this,function(y){switch(y.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),y.label=1;case 1:return y.trys.push([1,3,,4]),l=this.scorecard,[4,this.goalsHttpService.editNote(this.scorecard.groupId,this.scorecard.id,n,i,t,a,this.scorecard.hierarchyPaths).toPromise()];case 2:return c=y.sent(),this.assertScorecardLoaded(l)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(O){var A=W.getGoal(O.goals,n);u.fF.assertValue(A,"Goal not found");var L=_.find(A.goalValues,function(ue){return new Date(ue.timestamp).getTime()===new Date(t).getTime()});if(u.fF.assertValue(L,"Goal value not found"),!_.isEmpty(L)){var te=L.notes.findIndex(function(ue){return ue.id===i});u.fF.assertValue(L.notes,"Goal note not found"),L.notes[te]=c}}),this.commit(),[3,4]):[2];case 3:throw p=y.sent(),this.goalsErrorService.showUserError(p,"EditGoalNoteError"),p;case 4:return[2]}})})},o.prototype.insertNote=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l,c;return(0,M.__generator)(this,function(p){switch(p.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),p.label=1;case 1:return p.trys.push([1,3,,4]),a=this.scorecard,[4,this.goalsHttpService.insertNote(this.scorecard.groupId,this.scorecard.id,n,t,i,this.scorecard.hierarchyPaths).toPromise()];case 2:return l=p.sent(),this.assertScorecardLoaded(a)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(y){var O=W.getGoal(y.goals,n);u.fF.assertValue(O,"Goal not found");var A=_.find(O.goalValues,function(L){return new Date(L.timestamp).getTime()===new Date(t).getTime()});u.fF.assertValue(A,"Goal value not found"),O.notesCount=_.isFinite(O.notesCount)?O.notesCount+1:1,A.notes=(0,M.__spreadArray)((0,M.__spreadArray)([],A.notes||[],!0),[l],!1)}),this.commit(),[3,4]):[2];case 3:throw c=p.sent(),this.goalsErrorService.showUserError(c,"InsertGoalNoteError"),c;case 4:return[2]}})})},o.prototype.getGoal=function(n){return u.fF.assertValue(this.scorecard,"No scorecard loaded"),this._scorecard$.pipe((0,dt.U)(function(t){return W.getGoal(t.goals,n)}),(0,G.x)())},o.prototype.getGoals=function(){return u.fF.assertValue(this.scorecard,"No scorecard loaded"),this._scorecard$.pipe((0,dt.U)(function(n){return n.goals}))},o.prototype.getActiveGoal=function(){var n=this;return this._activeGoalId$.pipe((0,Rn.w)(function(t){return t?n.getGoal(t):(0,me.of)(void 0)}))},o.prototype.getActiveGoalId=function(){return this._activeGoalId$},o.prototype.deleteNote=function(n){var t=this;return this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Note_Title"),message:this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone"),panelClass:["updateDeleteNoteConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(t,void 0,void 0,function(){return(0,M.__generator)(this,function(a){switch(a.label){case 0:return[4,this.deleteNoteRequest(n)];case 1:return a.sent(),[2,!0]}})})}})},o.prototype.deleteNoteRequest=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),t=this.scorecard,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteNote(this.scorecard.groupId,this.scorecard.id,n.goalId,n.id,n.valueTimestamp,this.scorecard.hierarchyPaths).toPromise()];case 2:return a.sent(),[3,4];case 3:if(i=a.sent(),404!==i?.status)throw this.goalsErrorService.showUserError(i,"DeleteGoalNoteError"),i;return[3,4];case 4:return this.assertScorecardLoaded(t)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(l){var c=W.getGoal(l.goals,n.goalId);if(u.fF.assertValue(c,"Goal not found"),!_.isEmpty(c.goalValues)){var p=_.find(c.goalValues,function(y){return new Date(y.timestamp).getTime()===new Date(n.valueTimestamp).getTime()});p.notes=_.filter(p.notes,function(y){return y.id!==n.id})}c.notesCount=null==c.notesCount?0:c.notesCount-1}),this.commit(),[2]):[2]}})})},o.prototype.deleteGoal=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l,c=this;return(0,M.__generator)(this,function(p){switch(p.label){case 0:return this.assertNoActivehierarchy()?[4,this.getGoal(n).pipe((0,Me.q)(1)).toPromise()]:[2];case 1:return t=p.sent(),i=!_.isEmpty(t.subGoals),a=this.localizationService.get(t.isLinked?i?"ScorecardDialog_Delete_Metric_Title_Linked":"ScorecardDialog_Delete_Metric_Title_Linked_Submetrics":i?"ScorecardDialog_Delete_Metric_Title":"ScorecardDialog_Delete_Metric_Title_Submetrics"),l=t.isLinked?this.localizationService.get("ScorecardDialog_Delete_Metric_Message_Linked")+(i?this.localizationService.get("ScorecardDialog_Delete_Metric_Message_Linked_Submetrics"):""):this.localizationService.get("ScorecardDialog_Delete_Metric_Message_First_Line"),[2,this.promptUserConfirmation({title:a,message:l,panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(c,void 0,void 0,function(){return(0,M.__generator)(this,function(O){switch(O.label){case 0:return[4,this.pollingService.refreshRollupsAfterGoalDelete(t)];case 1:return O.sent(),[4,this.deleteGoalRequest(n)];case 2:return O.sent(),[2,!0]}})})}})]}})})},o.prototype.applySortAndFilter=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return this.scorecard?[4,this.ensureUsersLoaded()]:[2];case 1:return a.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(l){l.goals=K.sortAndFilter(l.goals,n,i._goalStatusesByScorecardId$.value,t)}),this.commit(),[2]}})})},o.prototype.deleteGoalRequest=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:if(!this.assertNoActivehierarchy())return[2];if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),t=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(t,"Goal not found"),t.isNew)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),this.setGoalState(n,"Deleting"),[4,this.goalsHttpService.deleteGoal(this.scorecard.groupId,this.scorecard.id,t.id).toPromise()];case 2:return a.sent(),[3,4];case 3:if(i=a.sent(),404!==i?.status)throw this.goalsErrorService.showUserError(i,"DeleteGoalError"),this.setGoalState(n,"Consumption"),i;return[3,4];case 4:return this.scorecard=(0,bt.Uy)(this.scorecard,function(l){var c=W.getGoal(l.goals,t.parentId);c?.subGoals?c.subGoals=c.subGoals.filter(function(p){return p.id!==n}):l.goals&&(l.goals=l.goals.filter(function(p){return p.id!==n}))}),this.commit(),[2]}})})},o.prototype.deleteGoalValue=function(n){var t=this;return this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_CheckIn_Message_title"),message:"".concat(this.localizationService.get("ScorecardDialog_Delete_CheckIn_Message_First_Line"),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),panelClass:["updateDeleteCheckInConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(t,void 0,void 0,function(){var a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:return[4,this.getGoal(n.goalId).pipe((0,Me.q)(1)).toPromise()];case 1:return a=l.sent(),[4,this.pollingService.refreshRollupsAfterGoalValueDelete(a,n)];case 2:return l.sent(),[4,this.deleteGoalValueRequest(n)];case 3:return l.sent(),[2,!0]}})})}})},o.prototype.deleteGoalValueRequest=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),t=this.scorecard,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteGoalValue(this.scorecard.groupId,this.scorecard.id,n.goalId,n.timestamp,this.scorecard.hierarchyPaths).toPromise()];case 2:return a.sent(),[3,4];case 3:if(i=a.sent(),404!==i?.status)throw this.goalsErrorService.showUserError(i,"DeleteGoalValueError"),i;return[3,4];case 4:return this.assertScorecardLoaded(t)?(this.scorecard=(0,bt.Uy)(this.scorecard,function(l){var c=W.getGoal(l.goals,n.goalId);u.fF.assertValue(c,"Goal not found"),c.goalValues=_.filter(c.goalValues,function(p){return p.timestamp!==n.timestamp})}),[4,this.refreshGoal(n.goalId)]):[2];case 5:return a.sent(),this.commit(),[2]}})})},o.prototype.updateGoalQueryConnection=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,c,p,y=this;return(0,M.__generator)(this,function(O){switch(O.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),a=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(a,"goal"),W.compareGoalQueryConnections(1===t?a.valueConnection:a.targetConnection,i))return[2];if(!this.assertNoActivehierarchy())return[2];O.label=1;case 1:return O.trys.push([1,4,,5]),[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:return O.sent(),[4,this.goalsHttpService.updateGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t,(0,M.__assign)((0,M.__assign)({},i),{userId:this.userInfo.uoid})).toPromise()];case 3:return c=O.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(A){a=W.getGoal(A.goals,n),y.assignGoal(a,c)}),this.commit(),[3,5];case 4:throw p=O.sent(),this.goalsErrorService.showUserError(p,"UpdateGoalQueryConnectionError"),p;case 5:return[2]}})})},o.prototype.deleteGoalQueryConnection=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,M.__generator)(this,function(a){return this.assertNoActivehierarchy()?[2,this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Metric_Query_Connection_Title"),message:"".concat(this.localizationService.format("ScorecardDialog_Delete_Metric_Query_Connection_Message_Line_1",[this.localizationService.get(1===t?"CurrentValue":"Target")]),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),onConfirmation:function(){return(0,M.__awaiter)(i,void 0,void 0,function(){var c,p,y=this;return(0,M.__generator)(this,function(O){switch(O.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),O.label=1;case 1:return O.trys.push([1,5,,6]),[4,this.goalsHttpService.deleteGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return c=O.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(A){var L=W.getGoal(A.goals,n);if(!L)throw"Goal not found";L.valueConnection=c.valueConnection,L.targetConnection=c.targetConnection,y.assignGoal(L,c)}),[4,this.refreshGoal(n)];case 3:return O.sent(),[4,this.expandGoalValues(n)];case 4:return O.sent(),this.commit(),[3,6];case 5:throw p=O.sent(),this.goalsErrorService.showUserError(p,"DeleteGoalQueryConnectionError"),p;case 6:return[2,!0]}})})}})]:[2]})})},o.prototype.takeOverGoalQueryConnection=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,M.__generator)(this,function(a){return this.assertNoActivehierarchy()?[2,this.promptUserConfirmation({title:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Confirmation_Title"),message:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Confirmation"),okButtonText:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver"),onConfirmation:function(){return(0,M.__awaiter)(i,void 0,void 0,function(){var c,p,y=this;return(0,M.__generator)(this,function(O){switch(O.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),O.label=1;case 1:return O.trys.push([1,3,,4]),[4,this.goalsHttpService.takeOverGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return c=O.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(A){var L=W.getGoal(A.goals,n);y.assignGoal(L,c)}),this.commit(),[3,4];case 3:if(p=O.sent(),400!==p?.status)throw this.goalsErrorService.showUserError(p,"TakeOverGoalQueryConnectionError"),p;return this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Error"),"TakeOverGoalQueryConnectionError",{title:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Error_Title"),level:er.U.Information}),[3,4];case 4:return[2]}})})}})]:[2]})})},o.prototype.getRefreshHistory=function(n){var t;return(0,M.__awaiter)(this,void 0,void 0,function(){var a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2,[]];if(!W.getGoal(null===(t=this.scorecard)||void 0===t?void 0:t.goals,n))return u.fF.assertFail("goal"),[2];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.goalsHttpService.getRefreshHistory(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return[2,l.sent()];case 3:throw a=l.sent(),this.goalsErrorService.showUserError(a,"GetRefreshHistoryError"),a;case 4:return[2]}})})},o.prototype.refreshGoalValue=function(n,t){var i;return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l;return(0,M.__generator)(this,function(c){switch(c.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),!(a=W.getGoal(null===(i=this.scorecard)||void 0===i?void 0:i.goals,n)))return u.fF.assertFail("goal"),[2];if(1===t&&!a.valueConnection||2===t&&!a.targetConnection)return[2];c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:return c.sent(),[4,this.goalsHttpService.refreshGoalValue(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return c.sent(),this.showRefreshConfirmation(),[3,5];case 4:if(l=c.sent(),429===l?.status)return this.goalsErrorService.showThrottlingError(),this.setGoalRefreshState(n,t,!1),[2];throw this.goalsErrorService.showUserError(l,"RefreshGoalValue"),l;case 5:return[2]}})})},o.prototype.upsertGoalValueRollup=function(n,t,i){return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l,c,p,O,A=this;return(0,M.__generator)(this,function(L){switch(L.label){case 0:if(!this.assertNoActivehierarchy())return[2];u.fF.assertValue(this.scorecard,"No scorecard loaded"),a=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(a,"goal"),L.label=1;case 1:return L.trys.push([1,10,,11]),c=void 0,p=se.E.getCurrentLocalDay(),_.isEmpty(a.subGoals)?[3,3]:[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:L.sent(),L.label=3;case 3:switch(c=Ke.r.hasHistoricalGoalValue(a.goalValues,t)?{rollupType:i,startDate:p.toISOString()}:{rollupType:i},t){case 1:return[3,4];case 2:return[3,6]}return[3,8];case 4:return[4,this.goalsHttpService.upsertGoalCurrentValueRollup(this.scorecard.groupId,this.scorecard.id,n,c).toPromise()];case 5:return l=L.sent(),[3,9];case 6:return[4,this.goalsHttpService.upsertGoalTargetValueRollup(this.scorecard.groupId,this.scorecard.id,n,c).toPromise()];case 7:return l=L.sent(),[3,9];case 8:u.fF.assertNever(t),L.label=9;case 9:return this.scorecard=(0,bt.Uy)(this.scorecard,function(te){a=W.getGoal(te.goals,n),A.assignGoal(a,l)}),this.commit(),[3,11];case 10:throw O=L.sent(),this.goalsErrorService.showUserError(O,"upsertGoalValueRollupError"),O;case 11:return[2]}})})},o.prototype.deleteGoalValueRollup=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,c,p=this;return(0,M.__generator)(this,function(y){switch(y.label){case 0:if(!this.assertNoActivehierarchy())return[2];u.fF.assertValue(this.scorecard,"No scorecard loaded"),i=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(i,"goal"),y.label=1;case 1:switch(y.trys.push([1,8,,9]),t){case 1:return[3,2];case 2:return[3,4]}return[3,6];case 2:return[4,this.goalsHttpService.deleteGoalCurrentValueRollup(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 3:return a=y.sent(),[3,7];case 4:return[4,this.goalsHttpService.deleteGoalTargetValueRollup(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 5:return a=y.sent(),[3,7];case 6:u.fF.assertNever(t),y.label=7;case 7:return this.scorecard=(0,bt.Uy)(this.scorecard,function(O){(i=W.getGoal(O.goals,n)).valueRollup=a.valueRollup,i.targetRollup=a.targetRollup,p.assignGoal(i,a)}),this.commit(),[3,9];case 8:throw c=y.sent(),this.goalsErrorService.showUserError(c,"deleteGoalValueRollupError"),c;case 9:return[2]}})})},o.prototype.getStatusRules=function(n){var t;return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2,null];if(!(i=W.getGoal(null===(t=this.scorecard)||void 0===t?void 0:t.goals,n)))return u.fF.assertFail("goal"),[2];if(!i.hasStatusRules)return[2,null];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.goalsHttpService.getGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return[2,l.sent()];case 3:throw a=l.sent(),this.goalsErrorService.showUserError(a,"GetStatusRulesError"),a;case 4:return[2]}})})},o.prototype.saveStatusRules=function(n,t){var i,a,l,c;return(0,M.__awaiter)(this,void 0,void 0,function(){var p,y,O,A;return(0,M.__generator)(this,function(L){switch(L.label){case 0:return this.assertNoActivehierarchy()?(u.fF.assertValue(this.scorecard,"No scorecard loaded"),(p=W.getGoal(null===(i=this.scorecard)||void 0===i?void 0:i.goals,n))?!t||_.isEmpty(t.rules)?p.hasStatusRules?[4,this.goalsHttpService.deleteGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n).toPromise()]:[3,4]:[3,5]:(u.fF.assertFail("goal"),[2])):[2,t];case 1:return L.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(te){(p=W.getGoal(te.goals,n)).hasStatusRules=!1}),this.commit(),[4,this.refreshGoal(n)];case 2:return L.sent(),[4,this.expandGoalValues(n,!0)];case 3:L.sent(),L.label=4;case 4:return[2];case 5:return L.trys.push([5,9,,10]),y=W.getGoalStatusRulesUpdateRequest(t),[4,this.goalsHttpService.upsertGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n,y).toPromise()];case 6:return O=L.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(te){(p=W.getGoal(te.goals,n)).hasStatusRules=!0}),this.commit(),[4,this.refreshGoal(n)];case 7:return L.sent(),[4,this.expandGoalValues(n,!0)];case 8:return L.sent(),[2,O];case 9:throw A=L.sent(),400===A?.status?this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("MetricsDetailsPane_StatusRulesTab_SaveRulesError_Description"),"GetStatusRulesError",{title:this.localizationService.get("MetricsDetailsPane_StatusRulesTab_SaveRulesError"),level:er.U.Information,isDismissable:!0,showAdditionalErrorInfo:!0,errorDetails:null===(c=null===(l=null===(a=A?.error)||void 0===a?void 0:a.details)||void 0===l?void 0:l[0])||void 0===c?void 0:c.message}):this.goalsErrorService.showUserError(A,"GetStatusRulesError"),A;case 10:return[2]}})})},o.prototype.loadPrefetchedScorecard=function(n){return this.setScorecardWithGoals(n),this._scorecard$.asObservable()},o.prototype.addGoal=function(){var n=this;if(this.assertNoActivehierarchy()){u.fF.assertValue(this.scorecard,"No scorecard loaded"),u.fF.assert(function(){return n.userHasWritePermissions()},"has write permissions");var t=W.getCurrentUser(),i=W.createNewGoal(t,this.scorecard.id);return this.scorecard=(0,bt.Uy)(this.scorecard,function(a){if(a.goals?a.goals.push(i):a.goals=[i],-1!==a.goals.findIndex(function(p){return!_.isNil(p.rank)})){var c=0;a.goals.forEach(function(p){p.rank=c,c++})}}),this.commit(),i.id}},o.prototype.addSubGoal=function(n,t){var i=this;void 0===t&&(t=!0),this.assertNoActivehierarchy()&&(u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(a){var l=W.getGoal(a.goals,n);u.fF.assertValue(l,"Parent goal not found");var c=W.getCurrentUser(),p=W.createNewGoal(c,i.scorecard.id,l.id);if(l.subGoals?l.subGoals.push(p):l.subGoals=[p],t&&(a.activeGoalId=void 0,a.selectedGoalIds={}),!_.isNil(l.rank)||-1!==l.subGoals.findIndex(function(A){return!_.isNil(A.rank)})){var O=0;l.subGoals.forEach(function(A){A.rank=O,O++})}}),this.commit())},o.prototype.updateScorecard=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l=this;return(0,M.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),t=void 0!==n.localTimeZoneId&&n.localTimeZoneId!==this.scorecard.localTimeZoneId,[4,this.goalsHttpService.updateScorecard(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 1:return i=c.sent(),n.name&&this.store.select(at.iF).pipe((0,Me.q)(1)).subscribe(function(p){l.tabFacade.updateTab(p===l.scorecard.groupId?{id:"me##"+l.scorecard.id,title:n.name}:{id:l.scorecard.groupId+"##"+l.scorecard.id,title:n.name})}),this.scorecard=(0,bt.Uy)(this.scorecard,function(p){for(var O=0,A=_.keys(n);O<A.length;O++){var L=A[O];p[L]=i[L]}}),this.commit(),t?[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!1,this.scorecard.hierarchyPaths)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[3,5];case 4:throw a=c.sent(),this.goalsErrorService.showUserError(a,"UpdateScorecardError"),a;case 5:return[2]}})})},o.prototype.setGoalState=function(n,t){u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(i){var a=W.getGoal(i.goals,n);u.fF.assertValue(a,"Goal not found"),a.state=t,("Editing"===a.state||"Deleting"===a.state)&&(i.selectedGoalIds[a.id]||i.activeGoalId===a.id)&&(i.activeGoalId=void 0,"Deleting"===a.state&&delete i.selectedGoalIds[a.id])}),this.commit()},o.prototype.cancelEditing=function(n){u.fF.assertValue(this.scorecard,"No scorecard loaded");var t=W.getGoal(this.scorecard.goals,n);u.fF.assertValue(t,"Goal not found"),t.isNew?this.deleteGoalRequest(n):this.setGoalState(n,"Consumption")},o.prototype.setViewType=function(n,t){var i=this;n!==this.viewType&&(W.isEditing(this.scorecard)&&!t?this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription_SwitchView"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(i,void 0,void 0,function(){var c=this;return(0,M.__generator)(this,function(p){return W.filterGoals(this.scorecard.goals,function(y){return!!y.isNew||"Editing"===y.state}).forEach(function(y){return c.cancelEditing(y.id)}),this.setViewType(n,!0),[2]})})}}):(this.telemetryService.logEvent(Pe,{viewType:n}),"Heatmap"===n&&this.setActiveHierarchy(void 0),this._viewType$.next(n)))},Object.defineProperty(o.prototype,"viewType",{get:function(){return this._viewType$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"viewType$",{get:function(){return this._viewType$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scorecardSelectionMode",{get:function(){return this._scorecardSelectionMode$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scorecardSelectionMode$",{get:function(){return this._scorecardSelectionMode$},enumerable:!1,configurable:!0}),o.prototype.setEditMode=function(n){this.isEditMode$.next(n),!n&&this.scorecard&&_.some(this.scorecard.goals)&&(this.scorecard=(0,bt.Uy)(this.scorecard,function(t){(function a(l,c){for(var p,y=function(ue){ue.isNew&&(l?l.subGoals=l.subGoals.filter(function(Ae){return Ae.id!==ue.id}):t.goals=t.goals.filter(function(Ae){return Ae.id!==ue.id})),ue.state="Consumption",(null===(p=ue.subGoals)||void 0===p?void 0:p.length)>0&&a(ue,ue.subGoals)},O=0,A=c;O<A.length;O++)y(A[O])})(null,t.goals),t.activeGoalId=void 0,t.selectedGoalIds={}}),this.commit())},o.prototype.isEditMode=function(){return this.isEditMode$.asObservable()},o.prototype.isLoading=function(){return this.loading$.pipe((0,dt.U)(function(n){return n>0}))},o.prototype.getColumnSettings=function(){return this._scorecard$.pipe((0,dt.U)(function(n){return n.columnSettings}))},o.prototype.setGoalRefreshState=function(n,t,i){this.scorecard=(0,bt.Uy)(this.scorecard,function(a){var l=W.getGoal(a.goals,n);switch(t){case 1:l.currentRefreshInProgress=i;break;case 2:l.targetRefreshInProgress=i;break;default:u.fF.assertNever(t)}}),this.commit()},o.prototype.fetchUserDetails=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){return t=_.chain(n).map(function(a){return _.concat(_.map(a.additionalOwners,function(l){var c;return null!==(c=l?.userPrincipalName)&&void 0!==c?c:l?.aadAppId}),a.owner)}).flattenDeep().filter(function(a){return!!a}).uniq().value(),[2,this.userDetailsService.getUserDetails(t).toPromise()]})})},o.prototype.populateUserDisplayNames=function(n,t){if(!_.isEmpty(n)&&!_.isEmpty(t)){for(var i={},a=0,l=n;a<l.length;a++){var c=l[a];i[c.userPrincipalName]=c,i[c.aadAppId]=c}for(var p=0,y=t;p<y.length;p++){var O=y[p],A=_.concat([O.owner],_.map(O.additionalOwners,function(L){var te;return null!==(te=L?.userPrincipalName)&&void 0!==te?te:L?.aadAppId}));O.ownerDisplayNames=_.map(A,function(L){return i[L]?i[L].displayName:L})}}},o.prototype.toggleSelectedGoal=function(n,t,i){var a=this;return void 0===t&&(t=!0),void 0===i&&(i=!1),u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(l){var c,p=W.getGoal(l.goals,n);u.fF.assertValue(p,"Goal not found"),!p.isNew&&(l.activeGoalId=void 0,a.numberOfSelectedGoals()>1||i?(i||(t&&(l.activeGoalId=n),l.selectedGoalIds={}),l.selectedGoalIds[n]||"Deleting"===p.state?delete l.selectedGoalIds[n]:l.selectedGoalIds[n]=!0):l.selectedGoalIds[n]||"Deleting"===p.state?l.selectedGoalIds={}:(t&&(l.activeGoalId=n),l.selectedGoalIds=((c={})[n]=!0,c)))}),this.commit(),this.scorecard.selectedGoalIds[n]},o.prototype.setActiveGoal=function(n){u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(t){t.activeGoalId=n}),this.commit()},o.prototype.selectGoal=function(n,t){void 0===t&&(t=!0),u.fF.assertValue(this.scorecard,"No scorecard loaded");var i=W.getGoal(this.scorecard.goals,n);u.fF.assertValue(i,"Goal not found"),!i.isNew&&!this.scorecard.selectedGoalIds[n]&&"Deleting"!==i.state&&(this.scorecard=(0,bt.Uy)(this.scorecard,function(a){var l;t&&(a.activeGoalId=n),a.selectedGoalIds=((l={})[n]=!0,l)}),this.commit())},o.prototype.multiSelectGoal=function(n){u.fF.assertValue(this.scorecard,"No scorecard loaded");var t=W.getGoal(this.scorecard.goals,n);u.fF.assertValue(t,"Goal not found"),!t.isNew&&this.scorecard.selectedGoalIds[n]&&"Deleting"!==t.state&&(this.scorecard=(0,bt.Uy)(this.scorecard,function(i){i.selectedGoalIds[n]=!0}),this.commit())},o.prototype.toggleSelectAllGoals=function(){var n=this;u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(t){t.selectedGoalIds={};var i=W.filterGoals(t.goals,function(p){return!p.isNew&&(!n.scorecardHost||n.scorecardHost.canSelectGoal(p).enabled)});if(i.length!==n.numberOfSelectedGoals())for(var a=0,l=i;a<l.length;a++)t.selectedGoalIds[l[a].id]=!0}),this.commit()},o.prototype.unselectAllGoals=function(){u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,bt.Uy)(this.scorecard,function(n){n.activeGoalId=void 0,n.selectedGoalIds={}}),this.commit()},o.prototype.getSelectedGoalIdsObservable=function(){return this._selectedGoalIds$},o.prototype.getSelectedGoalsObservable=function(){var n=this;return this._selectedGoalIds$.pipe((0,dt.U)(function(t){return W.filterGoals(n.scorecard.goals,function(a){return t[a.id]&&!a.isNew})}))},o.prototype.getFirstSelectedGoalId=function(){if(this.numberOfSelectedGoals()>0)return Object.keys(this.scorecard.selectedGoalIds)[0]},o.prototype.numberOfSelectedGoals=function(){return _.isNil(this.scorecard.selectedGoalIds)?0:Object.keys(this.scorecard.selectedGoalIds).length},o.prototype.isCurrentlyInEditMode=function(){return this.isEditMode$.value},o.prototype.getCurrentScorecard=function(){return this.scorecard},o.prototype.getScorecard=function(){return this._scorecard$.asObservable()},o.prototype.flatten=function(){return W.flattenGoals(this.scorecard.goals)},o.prototype.getBoard=function(){return this._scorecard$.pipe((0,dt.U)(function(n){return n.board}))},o.prototype.addGroupToBoard=function(n,t){var i={id:n,name:t,goals:[]};this.scorecard=(0,bt.Uy)(this.scorecard,function(a){_.isUndefined(a.board)&&(a.board={id:"",groups:[]}),a.board.id="boardVisual",a.board.groups.push(i)}),this.commit()},o.prototype.deleteGroupFromBoard=function(n){this.scorecard=(0,bt.Uy)(this.scorecard,function(t){t.board.groups=t.board.groups.filter(function(i){return i.id!==n})}),this.commit()},o.prototype.isEditing=function(){return this._scorecard$.pipe((0,dt.U)(function(n){return W.isEditing(n)}))},o.prototype.ensureRolesLoaded=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),!_.isEmpty(this.scorecard.roles))return[2];i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.goalsHttpService.getRoles(this.scorecard.groupId,this.scorecard.id).toPromise()];case 2:return n=i.sent(),_.isEmpty(n)?[4,this.initStartingRoles()]:[3,4];case 3:return i.sent(),[3,5];case 4:this.scorecard=(0,bt.Uy)(this.scorecard,function(a){a.roles=n}),this.commit(),i.label=5;case 5:return[3,7];case 6:throw t=i.sent(),this.goalsErrorService.showUserError(t,"LoadRoles"),t;case 7:return[2]}})})},o.prototype.initStartingRoles=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,i,a=this;return(0,M.__generator)(this,function(l){switch(l.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),l.label=1;case 1:return l.trys.push([1,3,,4]),n=[{name:this.localizationService.get("EditScorecardSettings_Role_Card_Default_Role_View_All"),isDefaultRole:!0,permissions:[{goalId:void 0,permissions:1,applyToChildGoals:!0}]},{name:this.localizationService.get("EditScorecardSettings_Role_Card_Default_Role_View_And_Update_All"),isDefaultRole:!1,permissions:[{goalId:void 0,permissions:27,applyToChildGoals:!0}]}],[4,Promise.all(n.map(function(c){return a.goalsHttpService.createRole(a.scorecard.groupId,a.scorecard.id,c).toPromise()}))];case 2:return t=l.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(c){var p;_.isEmpty(c.roles)?c.roles=t:(p=c.roles).push.apply(p,t)}),this.commit(),[2,t];case 3:throw i=l.sent(),this.goalsErrorService.showUserError(i,"InitStartingRolesError"),i;case 4:return[2]}})})},o.prototype.deleteRole=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return[4,this.ensureRolesLoaded()];case 1:return i.sent(),[2,this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Role_Title"),message:"".concat(this.localizationService.get("ScorecardDialog_Delete_Role_Message_First_Line"),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(t,void 0,void 0,function(){var l,c,p;return(0,M.__generator)(this,function(y){switch(y.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),l=null===(p=this.scorecard.roles)||void 0===p?void 0:p.find(function(O){return O.id===n}),u.fF.assertValue(l,"Role not found"),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteRole(this.scorecard.groupId,this.scorecard.id,l.id).toPromise()];case 2:return y.sent(),[3,4];case 3:throw c=y.sent(),this.goalsErrorService.showUserError(c,"DeleteRoleError"),c;case 4:return this.scorecard=(0,bt.Uy)(this.scorecard,function(O){O.roles=O.roles.filter(function(A){return A.id!==n})}),this.commit(),[2,!0]}})})}})]}})})},o.prototype.setAsDefaultRole=function(n){var t,i,a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y=this;return(0,M.__generator)(this,function(O){switch(O.label){case 0:return[4,this.ensureRolesLoaded()];case 1:return O.sent(),u.fF.assertValue(this.scorecard,"No scorecard loaded"),l=null===(t=this.scorecard.roles)||void 0===t?void 0:t.find(function(A){return A.id===n}),u.fF.assertValue(l,"Role not found"),c=null===(a=null===(i=this.scorecard.roles)||void 0===i?void 0:i.find(function(A){return A.isDefaultRole}))||void 0===a?void 0:a.name,p=l.name,[2,this.promptUserConfirmation({title:this.localizationService.get("EditScorecardSettings_Permission_Pane_Change_Default_Role_title"),message:_.isNil(c)?this.localizationService.format("EditScorecardSettings_Permission_Pane_Set_Default_Role_Message",[p]):this.localizationService.format("EditScorecardSettings_Permission_Pane_Change_Default_Role_Message",[c,p]),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateRoleConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(y,void 0,void 0,function(){var L;return(0,M.__generator)(this,function(te){switch(te.label){case 0:return te.trys.push([0,2,,3]),[4,this.goalsHttpService.updateRole(this.scorecard.groupId,this.scorecard.id,l.id,{isDefaultRole:!0}).toPromise()];case 1:return te.sent(),[3,3];case 2:throw L=te.sent(),this.goalsErrorService.showUserError(L,"UpdateRoleError"),L;case 3:return this.scorecard=(0,bt.Uy)(this.scorecard,function(ue){ue.roles.forEach(function(Ae){Ae.isDefaultRole=Ae.id===n})}),this.commit(),[2,!0]}})})}})]}})})},o.prototype.createRole=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.createRole(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return t=a.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(l){_.isEmpty(l.roles)?l.roles=[t]:l.roles.push(t)}),this.commit(),[2,t];case 3:throw i=a.sent(),this.goalsErrorService.showUserError(i,"UpdateRoleError"),i;case 4:return[2]}})})},o.prototype.updateRole=function(n,t){var i;return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l,c;return(0,M.__generator)(this,function(p){switch(p.label){case 0:return[4,this.ensureRolesLoaded()];case 1:p.sent(),u.fF.assertValue(this.scorecard,"No scorecard loaded"),a=null===(i=this.scorecard.roles)||void 0===i?void 0:i.find(function(y){return y.id===n}),u.fF.assertValue(a,"Role not found"),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.goalsHttpService.updateRole(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return l=p.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(y){y.roles=y.roles.map(function(O){return O.id===n?l:O})}),this.commit(),[2,l];case 4:throw c=p.sent(),this.goalsErrorService.showUserError(c,"UpdateRoleError"),c;case 5:return[2]}})})},o.prototype.updateGoalValueConnectionSettings=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:u.fF.assertValue(this.scorecard,"No scorecard loaded"),i=W.getGoal(this.scorecard.goals,n),u.fF.assertValue(i,"Goal not found"),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.goalsHttpService.updateConnectionSettings(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return l.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(c){var p=W.getGoal(c.goals,n);p.valueConnection&&1===t.connectionType?p.valueConnection=(0,M.__assign)((0,M.__assign)({},p.valueConnection),{shouldClearGoalValues:t.shouldClearGoalValues}):p.targetConnection&&2===t.connectionType&&(p.targetConnection=(0,M.__assign)((0,M.__assign)({},p.targetConnection),{shouldClearGoalValues:t.shouldClearGoalValues}))}),this.commit(),[3,4];case 3:throw a=l.sent(),this.goalsErrorService.showUserError(a,"UpdateGoalValueConnectionSettingsError"),a;case 4:return[2]}})})},o.prototype.setScorecardWithGoals=function(n){var t=this;this.linkedScorecardsById=_.keyBy(n.linkedScorecards,"id"),this.scorecard=(0,bt.Uy)(n,function(i){var a,l;i.columnSettings=_.isEmpty(i.columnSettings)?ne.om:ae.mergeColumns(i.columnSettings,ne.om),ae.adjustColumnSettings(t.featureSwitches,i.columnSettings),t.featureSwitches.featureSwitches.goalsLinkedGoals?null===(a=i.goals)||void 0===a||a.forEach(function(c){return c.isLinked=Ke.r.isLinked(c,i)}):i.goals=_.filter(i.goals,function(c){return c.scorecardId===i.id}),i.isSample=W.isSampleScorecard(n),_.some(i?.goals)&&(i.goals=K.sort(W.buildGoalTree(i.goals),ne.Ij)),(null===(l=t.scorecard)||void 0===l?void 0:l.id)===n.id?(i.activeGoalId=t.scorecard.activeGoalId,i.selectedGoalIds=t.scorecard.selectedGoalIds):i.selectedGoalIds={},i.showGoalTargetsInChart=!1}),this.commit()},o.prototype.commit=function(){this._scorecard$.next(this.scorecard)},o.prototype.ensureUsersLoaded=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t=this;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return u.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.usersLoaded?[2]:[4,this.fetchUserDetails(W.flattenGoals(this.scorecard.goals))];case 1:return n=i.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(a){t.populateUserDisplayNames(n,W.flattenGoals(a.goals)),a.usersLoaded=!0}),this.commit(),[2]}})})},o.prototype.showRefreshConfirmation=function(){this.dialogService.showSimpleDialog(this.localizationService.get("Refresh_Scheduled"),this.localizationService.get("Refresh_Scheduled_Data_Will_Be_Updated"))},o.prototype.promptUserConfirmation=function(n){var t,i;return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(c){switch(c.label){case 0:return u.fF.assertValue(n,"args"),u.fF.assertValue(n.title,"args.title"),u.fF.assertValue(n.message,"args.message"),[4,this.dialogService.showConfirmationDialog({title:n.title,message:n.message,okButtonText:null!==(t=n.okButtonText)&&void 0!==t?t:this.localizationService.get("Delete"),cancelButtonText:null!==(i=n.cancelButtonText)&&void 0!==i?i:this.localizationService.get("Cancel_ButtonText")},{autoFocus:!0,panelClass:n.panelClass}).afterClosed().toPromise()];case 1:return 1===c.sent()&&n.onConfirmation?[4,n.onConfirmation()]:[3,3];case 2:return[2,c.sent()];case 3:return[2,void 0]}})})},o.prototype.assignGoal=function(n,t){var i=n.rank;u.fF.assertValue(n,"existingGoal"),u.fF.assertValue(t,"newGoal"),Object.assign(n,t),n.cycle=t.cycle,n.cyclePeriod=t.cyclePeriod,n.rank=i,n.valuesCategoryId=t.valuesCategoryId},o.prototype.createCategoryList=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:u.fF.assertValue(this.scorecard,"createCategoryList No scorecard loaded"),u.fF.assert(function(){return!_.isEmpty(n)},"createCategoryList Categorical values are empty"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.createGoalValueCategories(this.scorecard.groupId,this.scorecard.id,W.getGoalValueCategoriesCreateRequest(n)).toPromise()];case 2:return t=a.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(l){_.isUndefined(l.goalValueCategories)&&(l.goalValueCategories=[]),l.goalValueCategories.push(t)}),[3,4];case 3:throw i=a.sent(),this.goalsErrorService.showUserError(i,"SaveGoalError"),i;case 4:return this.commit(),[2,t]}})})},o.prototype.updateCategoryList=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a=this;return(0,M.__generator)(this,function(l){switch(l.label){case 0:u.fF.assertValue(this.scorecard,"updateCategoryList No scorecard loaded"),u.fF.assertValue(n,"updateCategoryList categoryList"),u.fF.assertValue(_.find(this.scorecard.goalValueCategories,function(c){return c.id===n.id}),"updateCategoryList No category list found to update"),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.goalsHttpService.updateGoalValueCategories(this.scorecard.groupId,this.scorecard.id,n.id,W.getGoalValueCategoriesUpdateRequest(n)).toPromise()];case 2:return t=l.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(c){var p=_.findIndex(a.scorecard.goalValueCategories,function(y){return y.id===t.id});c.goalValueCategories[p]=t}),[3,4];case 3:throw i=l.sent(),this.goalsErrorService.showUserError(i,"SaveGoalError"),i;case 4:return this.commit(),[2,t]}})})},o.prototype.deleteCategoryList=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:u.fF.assertValue(this.scorecard,"deleteCategoryList No scorecard loaded"),u.fF.assertValue(_.find(this.scorecard.goalValueCategories,function(a){return a.id===n}),"deleteCategoryList No category list found to delete."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteGoalValueCategories(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return i.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(a){_.remove(a.goalValueCategories,function(l){return l.id===n})}),[3,4];case 3:throw t=i.sent(),this.goalsErrorService.showUserError(t,"SaveGoalError"),t;case 4:return this.commit(),[2]}})})},o.prototype.getGoalValueCategoryLists=function(n){var t,i;return u.fF.assertValue(this.scorecard,"No scorecard loaded"),n?null!==(t=this.getSourceScorecard(n).goalValueCategories)&&void 0!==t?t:[]:null!==(i=this.scorecard.goalValueCategories)&&void 0!==i?i:[]},o.prototype.getGoalValueCategories=function(n){var t,i;if(n.valuesCategoryId){var a=this.getGoalValueCategoryLists(n);return null!==(i=null===(t=_.find(a,function(l){return l.id===n.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==i?i:[]}},Object.defineProperty(o.prototype,"goalStatusesByScorecardId$",{get:function(){return this._goalStatusesByScorecardId$},enumerable:!1,configurable:!0}),o.prototype.getGoalStatuses=function(n){var t,i,a,l;return u.fF.assertValue(this.scorecard,"No scorecard loaded"),n?null!==(i=null===(t=this.getSourceScorecard(n).goalStatuses)||void 0===t?void 0:t.statuses)&&void 0!==i?i:[]:null!==(l=null===(a=this.scorecard.goalStatuses)||void 0===a?void 0:a.statuses)&&void 0!==l?l:[]},o.prototype.userHasWritePermissions=function(){var n,t=rt(null===(n=this.scorecard)||void 0===n?void 0:n.permissions);return(0,gr.yE)(t,2)},o.prototype.bulkDeleteGoalsPrompt=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,i=this;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.getSelectedGoalsObservable().pipe((0,Me.q)(1)).toPromise()]:[2];case 1:return n=a.sent(),t=_.some(n,function(l){return l.isLinked}),[2,this.promptUserConfirmation({title:this.localizationService.format("ScorecardDialog_BulkDelete_Metric_Title",[this.numberOfSelectedGoals()]),message:this.localizationService.get(t?"ScorecardDialog_BulkDelete_Metric_Message_Linked":"ScorecardDialog_BulkDelete_Metric_Message_First_Line"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,M.__awaiter)(i,void 0,void 0,function(){return(0,M.__generator)(this,function(c){switch(c.label){case 0:return[4,this.bulkDeleteGoals()];case 1:return c.sent(),[2,!0]}})})}})]}})})},o.prototype.bulkDeleteGoals=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t=this;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return this.assertNoActivehierarchy(!0)?(u.fF.assertValue(this.scorecard,"No scorecard loaded"),n=W.filterGoals(this.scorecard.goals,function(a){return t.scorecard.selectedGoalIds[a.id]&&!a.isNew}),[4,this.bulkDeleteGoalsRequest(n)]):[2];case 1:return i.sent(),[2]}})})},o.prototype.bulkDeleteGoalsRequest=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,l,c;return(0,M.__generator)(this,function(p){switch(p.label){case 0:for(t=0,i=n;t<i.length;t++)this.setGoalState(i[t].id,"Deleting");p.label=1;case 1:return p.trys.push([1,4,,5]),l=_.map(n,"id"),_.isEmpty(l)?[3,3]:[4,this.goalsHttpService.bulkDeleteGoals(this.scorecard.groupId,this.scorecard.id,{goalIds:l}).toPromise()];case 2:p.sent(),p.label=3;case 3:return[3,5];case 4:if(c=p.sent(),404!==c?.status)throw this.goalsErrorService.showUserError(c,"BulkDeleteGoalError"),c;return[3,5];case 5:return this.scorecard=(0,bt.Uy)(this.scorecard,function(y){for(var O=function(Ae){var Ne=W.getGoal(y.goals,Ae.parentId);Ne?.subGoals?Ne.subGoals=Ne.subGoals.filter(function(Je){return Je.id!==Ae.id}):y.goals&&(y.goals=y.goals.filter(function(Je){return Je.id!==Ae.id}))},A=0,L=n;A<L.length;A++)O(L[A])}),this.commit(),[2]}})})},o.prototype.bulkUpdateGoals=function(n){var t,i,a;return(0,M.__awaiter)(this,void 0,void 0,function(){var l,c,p,y,A,L,te,ue,Ae,Ne,Je,ze,ot,ft,xt,Kt,kt=this;return(0,M.__generator)(this,function(Rt){switch(Rt.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(u.fF.assertValue(this.scorecard,"No scorecard loaded"),u.fF.assertValue(n,"No bulk request"),(null===(t=n.goalIds)||void 0===t?void 0:t.length)<=0)return[2];for(l=n.target,delete n.target,c=0,p=n.goalIds;c<p.length;c++)this.setGoalState(ze=p[c],"Saving");return y=_.map(n.owners,function(Y){var Ie;return null!==(Ie=Y.userPrincipalName)&&void 0!==Ie?Ie:Y.aadAppId}),_.isEmpty(n.owners)?[3,2]:[4,this.userDetailsService.getUserDetails(y).toPromise()];case 1:return A=Rt.sent(),[3,3];case 2:A=[],Rt.label=3;case 3:for(L={},te=0,ue=A;te<ue.length;te++)L[(Ae=ue[te]).userPrincipalName]=Ae,L[Ae.aadAppId]=Ae;Rt.label=4;case 4:if(Rt.trys.push([4,10,,11]),_.isNil(l))return[3,8];Ne=0,Je=n.goalIds,Rt.label=5;case 5:return Ne<Je.length?(ot=W.getGoal(this.scorecard.goals,ze=Je[Ne]),ft=null!==(a=null===(i=_.find(ot.aggregations,function(Y){return"Target"===Y.type}))||void 0===i?void 0:i.timestamp)&&void 0!==a?a:n.timestamp,[4,this.upsertGoalValues(ze,[{timestamp:ft,target:l}])]):[3,8];case 6:Rt.sent(),Rt.label=7;case 7:return Ne++,[3,5];case 8:return[4,this.goalsHttpService.bulkUpdateGoals(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 9:return xt=Rt.sent(),this.scorecard=(0,bt.Uy)(this.scorecard,function(Y){for(var Ie=0,Le=xt;Ie<Le.length;Ie++){var Mt=Le[Ie],Wt=W.getGoal(Y.goals,Mt.id),nn=Wt.additionalOwners;kt.assignGoal(Wt,Mt),_.isEmpty(n.owners)?Wt.additionalOwners=nn:Wt.ownerDisplayNames=_.map(y,function(yo){var Fi,Ai;return null!==(Ai=null===(Fi=L[yo])||void 0===Fi?void 0:Fi.displayName)&&void 0!==Ai?Ai:yo}),Wt.state="Consumption"}}),[3,11];case 10:throw Kt=Rt.sent(),this.goalsErrorService.showUserError(Kt,"BulkUpdateGoalError"),Kt;case 11:return this.commit(),[2]}})})},o.prototype.toggleShowGoalTargetsInChart=function(n){this.scorecard=(0,bt.Uy)(this.scorecard,function(t){t.showGoalTargetsInChart=n}),this.commit()},o.prototype.createLinkedGoals=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l,c,p,y,O,A;return(0,M.__generator)(this,function(L){switch(L.label){case 0:if(_.isEmpty(n))return[2];i=new Set(W.mapGoals(this.scorecard.goals,function(te){return te.id})),a=new Set,(l=n.length)>1&&(c=this.dialogService.showSimpleWaitDialog(this.localizationService.format("Metrics_LinkedMetrics_Linking",l),l>100?this.localizationService.get("This_Might_Take_A_Moment"):"")),p=0,L.label=1;case 1:if(!(p<l))return[3,9];if(i.has((y=n[p]).id))return u.fF.assertFail("Selected goal to link already exists on this scorecard."),[3,8];(O=y.parentId)&&!a.has(O)&&(u.fF.assertFail("Attempting to link goal with parentId ".concat(O," without having linked parent.")),O=void 0),L.label=2;case 2:return L.trys.push([2,4,,8]),[4,this.goalsHttpService.createLinkedGoals(this.scorecard.groupId,this.scorecard.id,{goalIds:[y.id],scorecardId:y.scorecardId,parentGoalId:O??t}).toPromise()];case 3:return L.sent(),a.add(y.id),[3,8];case 4:return 429!==(A=L.sent()).status?[3,6]:[4,new Promise(function(te){return setTimeout(te,5e3)})];case 5:return L.sent(),p--,[3,7];case 6:return this.goalsErrorService.showUserError(A,"CreateLinkedGoalsError","Metrics_LinkedMetrics_Error"),[3,9];case 7:return[3,8];case 8:return p++,[3,1];case 9:return this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0,this.scorecard.hierarchyPaths),c?.close(),[2]}})})},o.prototype.getSourceScorecard=function(n){if(n.isLinked){var t=this.linkedScorecardsById[n.scorecardId];if(t)return t;u.fF.assertFail("No linked scorecard with id "+n.scorecardId)}return this.scorecard},o.prototype.openLinkedSourceScorecard=function(n){u.fF.assert(function(){return n.isLinked},"Goal is not linked");var t=this.getSourceScorecard(n);this.scorecardHost.openScorecard(t,n)},o.prototype.getOwnerDisplayNames=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:return t=_.concat([n.owner],_.map(n.additionalOwners,function(c){var p;return null!==(p=c?.userPrincipalName)&&void 0!==p?p:c?.aadAppId})),[4,this.userDetailsService.getUserDetails(t).toPromise()];case 1:return i=l.sent(),a=_.map(i,function(c){return c?.displayName}),[2,_.isEmpty(a)?t:a]}})})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Lt),e.\u0275\u0275inject(An.K),e.\u0275\u0275inject(hn.x),e.\u0275\u0275inject(Po.T),e.\u0275\u0275inject(Vt.o),e.\u0275\u0275inject(_a.a),e.\u0275\u0275inject(Ln.vZ),e.\u0275\u0275inject(Oo),e.\u0275\u0275inject(ji.y0),e.\u0275\u0275inject(is),e.\u0275\u0275inject(Ft.yh),e.\u0275\u0275inject(en,8),e.\u0275\u0275inject(on,8))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),dr=m(57243),jn=m(19178),Mr=function(){function o(n){this.capability=n,this.capability||(this.capability={enabled:!0,disabledReasons:new Set})}return o.clone=function(n){return new o(_.cloneDeep(n))},o.prototype.disableIf=function(n,t,i){return n&&(this.capability.enabled=!1,this.capability.disabledReasons.add(t),i&&!this.capability.disabledMessageKey&&(this.capability.disabledMessageKey=i)),new o(this.capability)},o.prototype.disableWithMultiple=function(n){var t=this;return this.capability.enabled=!1,n.forEach(function(i){return t.capability.disabledReasons.add(i)}),new o(this.capability)},o.prototype.build=function(){return this.capability},o}();function ti(o,n){return(0,gr.yE)(o,n)}var Pr=["id","permissions","hierarchyPaths"],vr=function(){function o(n,t,i,a){var l=this;this.featureSwitchService=n,this.scorecardService=t,this.groupStore=i,this.scorecardHost=a,this.capabilityInputs$=new ye.X([void 0,"List",!1]);var c=this.scorecardService.getScorecard().pipe((0,G.x)(function(y,O){return!y&&!O||!!y&&!!O&&_.every(Pr,function(A){return _.isEqual(y[A],O[A])})})),p=c.pipe((0,dt.U)(function(y){return y.groupId}),(0,G.x)(),(0,Rn.w)(function(y){return l.groupStore.getGroupById(y||"me")}),(0,dt.U)(function(y){return void 0!==y?.capacitySkuTier&&6!==y.capacitySkuTier}));this.inputSub=(0,zn.aj)([c,this.scorecardService.viewType$,p]).subscribe(this.capabilityInputs$),this.scorecardCapabilities$=this.capabilityInputs$.pipe((0,dt.U)(function(y){return l.calculateScorecardCapabilities(y)}),(0,dr.d)(1))}return o.prototype.ngOnDestroy=function(){this.inputSub.unsubscribe()},o.prototype.getCurrentScorecardCapabilities=function(){return this.calculateScorecardCapabilities(this.capabilityInputs$.value)},o.prototype.getScorecardCapabilities=function(){return this.scorecardCapabilities$},o.prototype.getCurrentGoalCapabilities=function(n){return _.isNil(n)?{}:this.calculateGoalCapabilities(n,this.capabilityInputs$.value)},o.prototype.getGoalCapabilities=function(n){var t=this;return _.isNil(n)?(0,me.of)({}):this.capabilityInputs$.pipe((0,dt.U)(function(i){return t.calculateGoalCapabilities(n,i)}),(0,dr.d)(1))},o.prototype.getMultipleGoalCapabilities=function(n){var t=this;return _.isEmpty(n)?(0,me.of)({}):this.capabilityInputs$.pipe((0,dt.U)(function(i){for(var a=_.map(n,function(L){return t.calculateGoalCapabilities(L,i)}),l=a[0],c={},p=function(te){var ue=te,Ae=l[ue];if("scorecardCapabilities"===ue)c[ue]=l.scorecardCapabilities;else if("boolean"==typeof Ae)c[ue]=_.every(a,function(xt){return xt[ue]});else if(function(o){return"enabled"in o}(Ae)){for(var Ne=new Mr,Je=0,ze=a;Je<ze.length;Je++){var ft=ze[Je][ue];ft.enabled||Ne.disableWithMultiple(ft.disabledReasons)}c[ue]=Ne.build()}else u.fF.assertFail("Unexpected type for key ".concat(ue," when getting multiple goal capabilities"))},y=0,O=_.keys(l);y<O.length;y++)p(O[y]);return c}),(0,dr.d)(1))},o.prototype.calculateScorecardCapabilities=function(n){var t=n[0],i=n[1],a=n[2],l={},c=ti(rt(t?.permissions),2),p=!_.isEmpty(t?.hierarchyPaths),y="List"===i;return l.customizeStatus=this.featureSwitchService.featureSwitches.goalsCustomizeStatus&&c,l.createGoal=(new Mr).disableIf(!c,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(p,"Hierarchical","Metrics_Tooltip_Create_Metric_Disabled_Hierarchical").disableIf(!y,"UnsupportedView","Metrics_Tooltip_Create_Metric_Disabled_UnsupportedView").build(),l.createLinkedGoal=(new Mr).disableIf(!c,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(p,"Hierarchical","Metrics_Tooltip_Create_Metric_Disabled_Hierarchical").disableIf("Heatmap"===i,"UnsupportedView","Metrics_Tooltip_Create_Metric_Disabled_UnsupportedView").build(),l.deleteGoal=c&&!p,l.reorderGoal=this.featureSwitchService.featureSwitches.powerBIGoalsDragAndDrop&&c&&!p&&y,l.editHierarchies=(new Mr).disableIf(!c,"NoWritePermission","MetricsHierarchy_NoPermission").disableIf(!a&&this.featureSwitchService.featureSwitches.scorecardHierarchiesPremium,"NoPremiumWorkspace","MetricsHierarchy_NotAllowedInShared").build(),l.editHeatmap=c,l},o.prototype.calculateGoalCapabilities=function(n,t){var i,a,l={scorecardCapabilities:this.calculateScorecardCapabilities(t)},c=t[0],p=t[1],y=n.isNew?31:function(o){if(_.isNil(o))return 0;if(!isNaN(o))return Number(o);switch(o.toString().trim().toLowerCase()){case"none":return 0;case"view":return 1;case"updatecurrentvalue":return 3;case"updatetargetvalue":return 5;case"updatenotes":return 9;case"updatestatus":return 17;case"updatevalues":return 7;case"all":return 31;default:u.fF.assertValue(o,"can't cast GoalPermission value")}}(n.permissions),O=ti(rt(c?.permissions),2),A=!!n.valuesCategoryId,L=(null===(a=null===(i=n.aggregations)||void 0===i?void 0:i.find(function(ft){return"NumberOfTargets"===ft.type}))||void 0===a?void 0:a.value)>1,te=!_.isEmpty(c?.hierarchyPaths),ue=W.isSampleScorecard(c),Ae=te&&n.isLinked,Ne="List"===p;l.selectGoal=this.scorecardHost?this.scorecardHost.canSelectGoal(n):{enabled:!0},l.editGoal=(new Mr).disableIf(!O,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(n.isLinked,"LinkedMetric","Metrics_Tooltip_Edit_Metric_Disabled_Linked").disableIf(!Ne,"UnsupportedView","Metrics_Tooltip_Edit_Metric_Disabled_UnsupportedView").build();var Je=O&&!n.isLinked&&!te;l.editName=Je,l.editStartDate=Je,l.editDueDate=Je,l.editStatusRules=Je,l.editPeriodicity=Je,l.connectCurrentValueToData=Je,l.connectTargetValueToData=Je,l.changeValueFormat=Je,l.editOwners=Je,l.deleteGoal=l.scorecardCapabilities.deleteGoal,l.createSubgoal=l.scorecardCapabilities.createGoal,l.editStatus=ti(y,17)&&!Ae&&!n.hasStatusRules,l.addNotes=ti(y,9)&&!Ae;var ze=ti(y,3)&&!Ae&&!n.valueConnection&&!n.valueRollup;l.editCurrentValue=ze,l.editMultipleValues=ze&&!A&&!te&&!n.isLinked;var ot=ti(y,5)&&!n.isLinked;return l.editTargetValue=ot&&!n.targetConnection&&!n.targetRollup&&!L,l.editMultipleTargets=ot&&(!!this.featureSwitchService.featureSwitches.goalsRollups||!n.targetConnection&&!n.targetRollup)&&(!A||L)&&!te,l.deleteCheckIn=O,l.followGoal=this.featureSwitchService.featureSwitches.goalsFavoriteGoals&&!ue&&!te,l.useCategoricalValues=!!this.featureSwitchService.featureSwitches.goalsCategoricalValues&&(!L||A)&&!n.valueRollup&&!n.targetRollup&&!n.valueConnection&&!n.targetConnection,l.supportMultipleTargetsEditing=!!this.featureSwitchService.featureSwitches.powerBIGoalsMultipleTargets,l.supportMultipleValuesEditing=!!this.featureSwitchService.featureSwitches.goalsMultipleValuesEditor,l.supportsRollup=!!this.featureSwitchService.featureSwitches.goalsRollups,l.editCalculationType=Je,l.usePickerRollup=l.editCalculationType&&!A,l},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Ln.vZ),e.\u0275\u0275inject(gt),e.\u0275\u0275inject(jn.Y),e.\u0275\u0275inject(en,8))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),ps=m(34071),hs=m(98632),gs=m(43633),On=m(59973),_i=m(50911),Ye=m(94420),mn=m(18942),Eo=m(76746),fs=function(){function o(n,t,i,a,l,c,p){this.store=n,this.datasetStore=t,this.domSanitizer=i,this.groupStoreService=a,this.reportStore=l,this.appSettings=c,this.scorecardHost=p}return o.prototype.getConnectedReport=function(n){var t,i;u.fF.assertValue(n.reportUrl,"No connected report url");var a=null===(t=n.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1],l=null===(i=n.reportUrl.match(/\/groups\/([a-zA-Z0-9\-]+)/))||void 0===i?void 0:i[1];return this.getReport(a,l)},o.prototype.getConnectedReportDisplayName=function(n){var t,i=null===(t=n.reportUrl.match(/\/apps\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1];return this.getConnectedReport(n).pipe((0,dt.U)(function(a){return i?a.ownerFullname:a.displayName}))},o.prototype.goToConnectedReport=function(n){u.fF.assertValue(n.reportUrl,"No connected report url");var i,t=n.reportUrl.indexOf("?")>=0?"&":"?";if(i=this.appSettings.tenantId?"".concat(n.reportUrl).concat(t,"ctid=").concat(this.appSettings.tenantId):n.reportUrl,this.scorecardHost)this.scorecardHost.openReport(i);else{var a=new URL(i,window.location.origin).href;window.open(this.domSanitizer.sanitize(e.SecurityContext.URL,a),"_blank")}},o.prototype.getReport=function(n,t){return this.store.dispatch(new hs.yi({reportObjectId:n,workspaceObjectId:t})),this.store.select(gs.W4,{id:n}).pipe((0,On.h)(function(i){return!!i&&!i.loading}))},o.prototype.getConnectedGoalsWithoutBuildPermissions=function(n){var t,i;return(0,M.__awaiter)(this,void 0,void 0,function(){var a,l,c,p,y,O,A;return(0,M.__generator)(this,function(L){switch(L.label){case 0:return a=[],[4,this.groupStoreService.ensureGroupArtifactsLoaded(ps.fm,!0)];case 1:L.sent(),l=0,c=n,L.label=2;case 2:return l<c.length?(p=c[l]).valueConnection?[4,this.datasetStore.findDatasetByObjectId(p.valueConnection.datasetId)]:[3,5]:[3,9];case 3:return(!(y=L.sent())||!this.hasDatasetBuildPermission(y))&&a.push(p.name),u.fF.assertValue(p.valueConnection.reportUrl,"No value connected report url"),O=null===(t=p.valueConnection.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1],[4,this.reportStore.findByObjectId(O)];case 4:(!(A=L.sent())||!this.hasReportReadPermission(A))&&a.push(p.name),L.label=5;case 5:return p.targetConnection?[4,this.datasetStore.findDatasetByObjectId(p.targetConnection.datasetId)]:[3,8];case 6:return(!(y=L.sent())||!this.hasDatasetBuildPermission(y))&&a.push(p.name),u.fF.assertValue(p.targetConnection.reportUrl,"No target connected report url"),O=null===(i=p.targetConnection.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===i?void 0:i[1],[4,this.reportStore.findByObjectId(O)];case 7:(!(A=L.sent())||!this.hasReportReadPermission(A))&&a.push(p.name),L.label=8;case 8:return l++,[3,2];case 9:return[2,_.uniq(a)]}})})},o.prototype.hasReportReadPermission=function(n){return(0,gr.yE)(n.permissions,1)},o.prototype.hasDatasetBuildPermission=function(n){return(0,gr.yE)(n?.permissions,3)||(0,gr.yE)(n?.permissions,9)||(0,gr.yE)(n?.userPermissions,9)||(0,gr.yE)(n?.userPermissions,3)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Ft.yh),e.\u0275\u0275inject(_i.s),e.\u0275\u0275inject(mn.H7),e.\u0275\u0275inject(jn.Y),e.\u0275\u0275inject(Ye.R),e.\u0275\u0275inject(Eo.de),e.\u0275\u0275inject(en,8))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Or=function(){function o(n,t){var i=this;this.scorecardService=n,this.featureSwitches=t,this._expansionMap$=new ye.X({}),this._expandableGoals$=new ye.X([]),this._showAllExpanded$=new ye.X(!1),this.onDestroy$=new je.xQ,this.expandByDefault=!this.featureSwitches.featureSwitches.collapseGoalsByDefault,this.scorecardService.getScorecard().pipe((0,dt.U)(function(a){return _.map(W.filterGoals(a.goals,function(l){return!_.isEmpty(l.subGoals)}),function(l){return l.id})}),(0,G.x)(_.isEqual),(0,We.R)(this.onDestroy$)).subscribe(this._expandableGoals$),this._expandableGoals$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(a){var l=new Set(a),c=_.pickBy(i.expansionMap,function(y,O){return l.has(O)});if(i._expansionMap$.next(c),i.expandByDefault){var p=_.filter(a,function(y){return _.isNil(i.expansionMap[y])});i.setExpansion(p,!0)}}),this._expansionMap$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(){var a=i.expandedGoalIds.length;0===a?i._showAllExpanded$.next(!1):a===i._expandableGoals$.value.length&&i._showAllExpanded$.next(!0)})}return Object.defineProperty(o.prototype,"expansionMap$",{get:function(){return this._expansionMap$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"expansionMap",{get:function(){return this._expansionMap$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"expandedGoalIds",{get:function(){return _.keys(_.pickBy(this.expansionMap,function(t){return t}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"showAllExpanded$",{get:function(){return this._showAllExpanded$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"showAllExpanded",{get:function(){return this._showAllExpanded$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasExpandableGoals$",{get:function(){return this._expandableGoals$.pipe((0,dt.U)(function(t){return!_.isEmpty(t)}))},enumerable:!1,configurable:!0}),o.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},o.prototype.isExpanded=function(n){var t;return null!==(t=this.expansionMap[n])&&void 0!==t?t:this.expandByDefault},o.prototype.expandGoal=function(n){this.setExpansion([n],!0)},o.prototype.collapseGoal=function(n){this.setExpansion([n],!1)},o.prototype.expandGoals=function(n){this.setExpansion(n,!0)},o.prototype.collapseGoals=function(n){this.setExpansion(n,!1)},o.prototype.expandAllGoals=function(){this.setExpansion(this._expandableGoals$.value,!0)},o.prototype.collapseAllGoals=function(){this.setExpansion(this._expandableGoals$.value,!1)},o.prototype.toggleExpandAll=function(){this.showAllExpanded?this.collapseAllGoals():this.expandAllGoals()},o.prototype.setExpansion=function(n,t){var i=this;if(_.some(n,function(l){return i.expansionMap[l]!==t})){var a=(0,M.__assign)({},this.expansionMap);_.forEach(n,function(l){a[l]=t}),this._expansionMap$.next(a)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(gt),e.\u0275\u0275inject(Ln.vZ))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),ni=function(){function o(n,t,i,a,l,c){this.scorecardService=n,this.capabilityService=t,this.overlay=i,this.goalConnectionService=a,this.expansionService=l,this.featureSwitches=c,this.contextMenuOpenGoalId$=new ye.X(void 0),this.onDestroy$=new je.xQ}return o.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Object.defineProperty(o.prototype,"scorecardSelectionMode",{get:function(){return this.scorecardService.scorecardSelectionMode},enumerable:!1,configurable:!0}),o.prototype.capabilities=function(n){return this.capabilityService.getCurrentGoalCapabilities(n)},o.prototype.canSelectGoal=function(n){var t,i;return null===(i=null===(t=this.capabilities(n).selectGoal)||void 0===t?void 0:t.enabled)||void 0===i||i},o.prototype.isSelected=function(n){var t,i;return null===(i=null===(t=this.scorecardService.getCurrentScorecard())||void 0===t?void 0:t.selectedGoalIds)||void 0===i?void 0:i[n.id]},o.prototype.onRowClick=function(n,t){this.canSelectGoal(n)&&this.scorecardService.toggleSelectedGoal(n.id,!1,this.isClickMultiselect(t))},o.prototype.onNameClick=function(n,t){if(this.canSelectGoal(n))if((_.isNil(this.scorecardSelectionMode)||"ctrl"===this.scorecardSelectionMode)&&1===this.scorecardService.numberOfSelectedGoals()&&this.isSelected(n)&&_.isNil(this.scorecardService.getCurrentScorecard().activeGoalId))this.scorecardService.setActiveGoal(n.id);else{var i=this.isClickMultiselect(t);this.scorecardService.toggleSelectedGoal(n.id,!(i||"single"===this.scorecardSelectionMode),i)}t?.stopPropagation()},o.prototype.onCheckboxClick=function(n,t){this.canSelectGoal(n)&&this.scorecardService.toggleSelectedGoal(n.id,!1,"single"!==this.scorecardSelectionMode),t?.stopPropagation()},o.prototype.getGoalActionIcons=function(n,t,i){var a=this.getGoalActions(n);return _.map(_.filter(i?t?this.featureSwitches.featureSwitches.scorecardCompactView?[a.editGoal,a.openNotes,a.openContextMenu]:[a.openNotes,a.editGoal,a.openContextMenu]:this.featureSwitches.featureSwitches.scorecardCompactView?[a.goToReport,a.toggleFollow,a.openNotes]:[a.goToReport,a.openNotes,a.toggleFollow]:[a.openContextMenu],function(c){return!c.hidden}),function(c){return(0,M.__assign)((0,M.__assign)({},c),{onClick:function(y){c.onClick(),y.stopPropagation()}})})},o.prototype.getGoalMenuOptions=function(n,t,i){var a=this,l=this.getGoalActions(n),c=[];return t?(c=[l.goToReport,l.seeDetails,l.addSubGoal,l.toggleFollow,l.goToLinkedSource,l.deleteGoal],i||c.unshift(l.editGoal)):i?u.fF.assertFail("When action icons are shown, read mode has no context menu"):c=[l.goToReport,l.openNotes,l.toggleFollow],_.map(_.filter(c,function(p){return!p.hidden}),function(p){return(0,M.__assign)((0,M.__assign)({},p),{onClick:function(){p.onClick(),a.overlay.closeAll()}})})},o.prototype.onContextMenuClick=function(n,t,i,a,l){var c=this;this.overlay.isOverlayOpen&&this.overlay.closeAll();var p=this.getGoalMenuOptions(n,a,l),O=t.pointerType?{x:t.x,y:t.y}:i,A=this.overlay.open({component:Ue.H,data:{goalActions:p},closeOnBackdropClick:!0,disableForwardClickOnBackdropClick:!0,hasCaret:!1,options:{hasBackdrop:!0,backdropClass:He.L,positionStrategy:this.overlay.position().flexibleConnectedTo(O).withPositions([(0,he.Iz)(),(0,he.Kb)(),(0,he.Zz)(),(0,he.J7)()]).withPush(!0).withGrowAfterOpen(!0)}});return this.contextMenuOpenGoalId$.next(n.id),A.onClose.subscribe(function(L){return c.contextMenuOpenGoalId$.next(void 0)}),t.stopPropagation(),A},o.prototype.getGoalActions=function(n){var i,a,l,c,t=this,p=this.capabilities(n);return{goToReport:{id:"goToReport",onClick:function(){return t.goalConnectionService.goToConnectedReport(n.valueConnection)},labelKey:"TileMenuOption_GoToReport",iconTooltipKey:"Metrics_Tooltip_Open_Report",iconName:"barchart",iconType:"pbi",hidden:_.isNil(n.valueConnection)},openNotes:{id:"openNotes",onClick:function(){t.canSelectGoal(n)&&t.scorecardService.setActiveGoal(n.id)},labelKey:"OpenNotes",iconTooltipKey:"Notes",iconName:"comment_16_regular",iconType:"tri"},seeDetails:{id:"seeDetails",onClick:function(){return t.scorecardService.setActiveGoal(n.id)},labelKey:"VisualContainer_ShowErrorDetails",iconName:"list",iconType:"pbi"},editGoal:{id:"editGoal",onClick:function(){return t.scorecardService.setGoalState(n.id,"Editing")},labelKey:"Metrics_Tooltip_Edit_Metric",iconName:"edit",iconType:"pbi",disabled:!(null!==(i=p?.editGoal)&&void 0!==i&&i.enabled),disabledTooltipKey:null===(a=p?.editGoal)||void 0===a?void 0:a.disabledMessageKey},toggleFollow:{id:"toggleFollow",onClick:function(){n.isFollowed?t.scorecardService.unfollowGoal(n.id):t.scorecardService.followGoal(n.id)},labelKey:n.isFollowed?"Metrics_Follow_Goals_Unfollow_This_Metric":"Metrics_Follow_Goals_Follow_This_Metric",iconName:n.isFollowed?"alert_16_filled":"alert_16_regular",iconType:"tri",hidden:!p.followGoal},addSubGoal:{id:"addSubGoal",onClick:function(){t.scorecardService.addSubGoal(n.id),t.expansionService.expandGoal(n.id)},labelKey:"NewSubmetric",iconName:"add-multiple",iconType:"pbi",hidden:W.computeGoalLevel(this.scorecardService.getCurrentScorecard().goals,n)>=ne.gT.MaxSubGoals,disabled:!(null!==(l=p.createSubgoal)&&void 0!==l&&l.enabled),disabledTooltipKey:null===(c=p.createSubgoal)||void 0===c?void 0:c.disabledMessageKey},deleteGoal:{id:"deleteGoal",onClick:function(){return t.scorecardService.deleteGoal(n.id)},labelKey:n.isLinked?"Metrics_LinkedMetrics_RemoveLinkedMetric":"Metrics_Tooltip_Delete_Metric",iconName:"delete",iconType:"pbi",hidden:!p.deleteGoal},goToLinkedSource:{id:"goToLinkedSource",onClick:function(){return t.scorecardService.openLinkedSourceScorecard(n)},labelKey:"Metrics_LinkedMetrics_GoToSource",iconName:"open_16_regular",iconType:"tri",hidden:!n.isLinked},openContextMenu:{id:"openContextMenu",onClick:function(){return u.fF.assertFail("OpenContextMenu must be set up in template")},labelKey:"Options_Menu",iconName:"pbi-glyph-more-vertical",iconType:"mat"}}},o.prototype.isClickMultiselect=function(n){switch(this.scorecardSelectionMode){case"multiple":return!0;case"ctrl":return n?.ctrlKey;default:return!1}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(gt),e.\u0275\u0275inject(vr),e.\u0275\u0275inject(He._),e.\u0275\u0275inject(fs),e.\u0275\u0275inject(Or),e.\u0275\u0275inject(Ln.vZ))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),vn=m(44408),Dn=m(86663),Er=m(74913),Bt=m(85102),yn=["*"],Tr=function(){function o(){this.disableTooltip=!1}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["tooltip-wrapper"]],inputs:{tooltipKey:"tooltipKey",disableTooltip:"disableTooltip"},ngContentSelectors:yn,decls:3,vars:4,consts:[[1,"tooltip-wrapper",3,"pbiTooltipDisabled","pbiTooltip"]],template:function(t,i){1&t&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("pbiTooltipDisabled",i.disableTooltip)("pbiTooltip",i.tooltipKey?e.\u0275\u0275pipeBind1(1,2,i.tooltipKey):void 0)},dependencies:[oe.V,Bt.F],styles:["[_nghost-%COMP%], .tooltip-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex}"],changeDetection:0}),o}();function or(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",11),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.goal.notesCount," ")}}function Ca(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",8),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var y=e.\u0275\u0275nextContext().$implicit;return e.\u0275\u0275resetView(y.onClick(p))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",9),e.\u0275\u0275template(3,or,2,1,"span",10),e.\u0275\u0275elementEnd()}if(2&o){var l,i=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("show-btn",a.goal.notesCount>0),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,6,null!==(l=i.iconTooltipKey)&&void 0!==l?l:i.labelKey))("disabled",i.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("name",i.iconName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.goal.notesCount>0)}}function $t(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12,13),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var y=e.\u0275\u0275reference(1),O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onContextMenuClick(p,y))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"mat-icon",14),e.\u0275\u0275elementEnd()}if(2&o){var l,i=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("space-btn",a.goal.notesCount>0),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,4,null!==(l=i.iconTooltipKey)&&void 0!==l?l:i.labelKey))("disabled",i.disabled)}}var st=function(n){return{action:n}};function ms(o,n){if(1&o&&e.\u0275\u0275elementContainer(0,15),2&o){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275nextContext(2);var i=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngTemplateOutlet",i)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,st,t))}}function $i(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275template(1,Ca,4,8,"button",5),e.\u0275\u0275template(2,$t,4,6,"button",6),e.\u0275\u0275template(3,ms,1,4,"ng-container",7),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275property("ngSwitch",n.$implicit.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","openNotes"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","openContextMenu"))}function ya(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,$i,4,3,"ng-container",3),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.actions)}}function ba(o,n){if(1&o&&e.\u0275\u0275element(0,"mat-icon",21),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("fontIcon",t.iconName)}}function wa(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-icon",22),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function vs(o,n){if(1&o&&e.\u0275\u0275element(0,"tri-svg-icon",9),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function _s(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",17)(1,"button",8),e.\u0275\u0275listener("click",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext().action;return e.\u0275\u0275resetView(p.onClick(c))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275template(3,ba,1,1,"mat-icon",18),e.\u0275\u0275template(4,wa,1,1,"pbi-icon",19),e.\u0275\u0275template(5,vs,1,1,"tri-svg-icon",20),e.\u0275\u0275elementEnd()()}if(2&o){var a,i=e.\u0275\u0275nextContext().action;e.\u0275\u0275property("tooltipKey",null==i?null:i.disabledTooltipKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,6,null!==(a=i.iconTooltipKey)&&void 0!==a?a:i.labelKey))("disabled",i.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","mat"===i.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pbi"===i.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","tri"===i.iconType)}}function Sa(o,n){1&o&&e.\u0275\u0275template(0,_s,6,8,"tooltip-wrapper",16),2&o&&e.\u0275\u0275property("ngIf",n.action)}var Qi=function(o){function n(t,i){var a=o.call(this)||this;return a.goalRowService=t,a.changeDetector=i,a.showActionIcons=!0,a.goalRowService.contextMenuOpenGoalId$.pipe((0,G.x)(),(0,We.R)(a.onDestroy$)).subscribe(function(l){a.contextMenuOpen=a.goal&&l===a.goal.id,a.changeDetector.markForCheck()}),a}return(0,M.__extends)(n,o),n.prototype.ngOnChanges=function(t){(t.goal||t.isEditMode||t.showActionIcons)&&(this.actions=this.goalRowService.getGoalActionIcons(this.goal,this.isEditMode,this.showActionIcons)),o.prototype.ngOnChanges.call(this,t)},n.prototype.onContextMenuClick=function(t,i){this.goalRowService.onContextMenuClick(this.goal,t,i,this.isEditMode,this.showActionIcons)},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(ni),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["goal-actions-cell"]],hostVars:2,hostBindings:function(i,a){2&i&&e.\u0275\u0275classProp("context-menu-open",a.contextMenuOpen)},inputs:{goal:"goal",isEditMode:"isEditMode",showActionIcons:"showActionIcons"},features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275NgOnChangesFeature],decls:3,vars:1,consts:[["class","goal-actions",4,"ngIf"],["actionIcon",""],[1,"goal-actions"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["class","action-btn","mat-icon-button","",3,"show-btn","pbiTooltip","disabled","click",4,"ngSwitchCase"],["class","action-btn context-menu-btn","mat-icon-button","",3,"space-btn","pbiTooltip","disabled","click",4,"ngSwitchCase"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngSwitchDefault"],["mat-icon-button","",1,"action-btn",3,"pbiTooltip","disabled","click"],["tri-svg-icon-16","",1,"tri-svg",3,"name"],["class","notes-count",4,"ngIf"],[1,"notes-count"],["mat-icon-button","",1,"action-btn","context-menu-btn",3,"pbiTooltip","disabled","click"],["contextMenuBtn",""],["fontIcon","pbi-glyph-more-vertical",1,"glyph-small"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"tooltipKey",4,"ngIf"],[3,"tooltipKey"],["class","glyphicon glyph-small",3,"fontIcon",4,"ngIf"],["size","small","class","icon",3,"name",4,"ngIf"],["tri-svg-icon-16","","class","tri-svg",3,"name",4,"ngIf"],[1,"glyphicon","glyph-small",3,"fontIcon"],["size","small",1,"icon",3,"name"]],template:function(i,a){1&i&&(e.\u0275\u0275template(0,ya,2,1,"div",0),e.\u0275\u0275template(1,Sa,1,1,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&i&&e.\u0275\u0275property("ngIf","Saving"!==a.goal.state&&"Deleting"!==a.goal.state)},dependencies:[F.NgForOf,F.NgIf,F.NgTemplateOutlet,F.NgSwitch,F.NgSwitchCase,F.NgSwitchDefault,vn.Hw,Dn._,oe.V,Er.M,Tr,Bt.F],styles:["[_nghost-%COMP%]{display:flex}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{position:relative;padding:0;border:none;background:none;height:100%;width:32px}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:rgba(0,0,0,.05);color:inherit}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:before{vertical-align:middle}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{margin-top:-5px}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .notes-count[_ngcontent-%COMP%]{position:absolute;top:12px;right:0;border-radius:30px;padding:2px 4px;min-width:8px;min-height:8px;font-size:var(--xs-font-size);font-family:var(--fluent-font-family);font-weight:var(--font-weight-regular);background:var(--fluent-theme-primary-color);color:var(--text-primary-content-color-hc)}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.show-btn[_ngcontent-%COMP%]{display:block;visibility:visible}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.space-btn[_ngcontent-%COMP%]{display:block}.context-menu-open[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{display:block!important;visibility:visible!important}.context-menu-open[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.context-menu-btn[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.05);color:inherit}"],changeDetection:0}),n}(De.w),xr=m(82621);function To(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-icon",6),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("rotate180",!t.valueChange.isIncrease),e.\u0275\u0275property("size",t.arrowSize)}}var Ki=function(){return{rounded:!0}};function Xi(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,To,1,3,"pbi-icon",3),e.\u0275\u0275elementStart(2,"div",4),e.\u0275\u0275elementContainer(3,5),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.valueChange),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",i),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",i)("ngTemplateOutletContext",e.\u0275\u0275pureFunction0(4,Ki))}}function Cs(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.isCyclePeriodLabelLocalizable?e.\u0275\u0275pipeBind1(2,1,null==t.valueChange?null:t.valueChange.period):null==t.valueChange?null:t.valueChange.period," ")}}function Ma(o,n){if(1&o&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,Cs,3,3,"span",7)),2&o){var t=n.rounded,i=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t?i.formattedChangeValue:i.formattedTooltipValue," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==i.valueChange?null:i.valueChange.period)}}var Nr=function(){function o(n,t){this.featureSwitches=n,this.formatValuePipe=t,this.arrowSize="micro",this.nilDisplayString=""}return o.prototype.ngOnChanges=function(n){var t,i,a,l,c,p;if(n.goal){this.valueChange=Ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations);var y=null!==(t=this.valueChange)&&void 0!==t&&t.isPercentage?void 0:this.goal.valuesFormatString;this.formattedChangeValue=this.formatValuePipe.transform(null===(i=this.valueChange)||void 0===i?void 0:i.changeAmount,y,!0,this.nilDisplayString),this.formattedChangeValue=null!==(a=this.valueChange)&&void 0!==a&&a.isPercentage?this.formattedChangeValue+"%":this.formattedChangeValue,this.formattedTooltipValue=this.formatValuePipe.transform(null===(l=this.valueChange)||void 0===l?void 0:l.changeAmount,y,!1,this.nilDisplayString),this.formattedTooltipValue=null!==(c=this.valueChange)&&void 0!==c&&c.isPercentage?this.formattedTooltipValue+"%":this.formattedTooltipValue,this.isCyclePeriodLabelLocalizable=Ke.r.isCyclePeriodLabelLocalizable(null===(p=this.valueChange)||void 0===p?void 0:p.period)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(xr.c))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-change-cell"]],inputs:{goal:"goal",arrowSize:"arrowSize",nilDisplayString:"nilDisplayString"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:1,consts:[["class","delta",4,"ngIf"],["valueAndPeriod",""],[1,"delta"],["name","arrow",3,"size","rotate180",4,"ngIf"],[1,"change",3,"pbiTooltip"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["name","arrow",3,"size"],[4,"ngIf"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Xi,4,5,"div",0),e.\u0275\u0275template(1,Ma,2,2,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t&&e.\u0275\u0275property("ngIf",!1!==(null==i.goal||null==i.goal.metadata?null:i.goal.metadata.showPercentChange)&&!(null!=i.goal&&i.goal.valuesCategoryId))},dependencies:[F.NgIf,F.NgTemplateOutlet,Dn._,oe.V,Bt.F],styles:["[_nghost-%COMP%]{--container-align-items: center;--arrow-margin: none;--arrow-font-weight: var(--font-weight-regular);--change-font-size: var(--sm-font-size);--change-font-weight: var(--font-weight-regular)}.delta[_ngcontent-%COMP%]{display:flex;align-items:var(--container-align-items);font-size:var(--change-font-size);font-weight:var(--change-font-weight);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.delta[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin:var(--arrow-margin);font-weight:var(--arrow-font-weight)}.delta[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.change[_ngcontent-%COMP%]{margin-left:4px;overflow:hidden;text-overflow:ellipsis}"],changeDetection:0}),o}();function Pa(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",t.completionDate),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.completionDate,"\n")}}function ar(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275text(1,"\u2014"),e.\u0275\u0275elementEnd())}var xo=function(){function o(n){this.localizationService=n,this.formatOptions={day:"numeric",month:"short",year:"numeric"}}return o.prototype.ngOnChanges=function(){if(this.goal.completionDate){var n=this.localizationService.currentLanguageLocale;this.completionDate=se.E.treatAsLocalDate(new Date(this.goal.completionDate)).toLocaleDateString(n,this.formatOptions)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-due-date-cell"]],inputs:{goal:"goal",formatOptions:"formatOptions"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","completion-date",3,"pbiTooltip",4,"ngIf","ngIfElse"],["noValueDash",""],[1,"completion-date",3,"pbiTooltip"],[1,"no-value-dash"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,Pa,2,2,"div",0),e.\u0275\u0275template(1,ar,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",i.completionDate)("ngIfElse",a)}},dependencies:[F.NgIf,oe.V],styles:["[_nghost-%COMP%]   .completion-date[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .no-value-dash[_ngcontent-%COMP%]{font-size:var(--lg-font-size);font-weight:var(--font-weight-regular);overflow:hidden}"],changeDetection:0}),o}();function ys(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-icon",4),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(6);e.\u0275\u0275property("pbiTooltip",t)}}function bs(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Metrics_Tooltip_LinkedHierarchical")," "))}function Io(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",9),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function Do(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",9),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"Role_DisplayName_TargetValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function ko(o,n){if(1&o&&(e.\u0275\u0275template(0,Io,6,6,"div",8),e.\u0275\u0275template(1,Do,6,6,"div",8)),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",!t.goal.valueConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.goal.targetConnection)}}function Zi(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275template(1,bs,3,3,"div",6),e.\u0275\u0275template(2,ko,2,2,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.goal.isLinked)("ngIfElse",t)}}var ri=function(){function o(n,t){this.goalRowService=n,this.featureSwitches=t,this.boldName=!1,this.innerIndent=0}return o.prototype.ngOnChanges=function(n){var t;n.scorecard&&(this.showHierarchyTooltips=!_.isEmpty(null===(t=this.scorecard)||void 0===t?void 0:t.hierarchyPaths)&&!this.featureSwitches.featureSwitches.goalsHierarchiesHideInfoTooltips)},o.prototype.onNameClick=function(n){this.goalRowService.onNameClick(this.goal,n)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(ni),e.\u0275\u0275directiveInject(Ln.vZ))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-name-cell"]],inputs:{goal:"goal",scorecard:"scorecard",boldName:"boldName",innerIndent:"innerIndent"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:7,consts:[["data-testid","goal-name-box",1,"name-box",3,"pbiTooltip","click"],[1,"inner-indent"],["class","name-info","name","info","size","mini",3,"pbiTooltip",4,"ngIf"],["infoTooltip",""],["name","info","size","mini",1,"name-info",3,"pbiTooltip"],[1,"goal-info-tooltip"],[4,"ngIf","ngIfElse"],["manualTooltip",""],[4,"ngIf"],[1,"tooltip-value-label"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(l){return i.onNameClick(l)}),e.\u0275\u0275element(1,"div",1),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,ys,1,1,"pbi-icon",2),e.\u0275\u0275template(5,Zi,4,2,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275classProp("bold-name",i.boldName),e.\u0275\u0275property("pbiTooltip",i.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("width",i.innerIndent+"px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.showHierarchyTooltips&&(i.goal.isLinked||!i.goal.valueConnection||!i.goal.targetConnection)))},dependencies:[F.NgIf,Dn._,oe.V,Bt.F],styles:["[_nghost-%COMP%]{display:flex;flex:1;height:100%;overflow:hidden}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]{flex:1;border:none;padding:0;background-color:transparent;overflow:hidden;white-space:break-spaces;text-overflow:ellipsis;text-align:left}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]   .name-box.bold-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]   .name-info[_ngcontent-%COMP%]{margin:0 6px}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]   .inner-indent[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0}),o}(),ws=function(n){return{userEmail:n}};function Ss(o,n){if(1&o&&e.\u0275\u0275element(0,"user-details-host",5),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(3,ws,t.owners[0]))("showUserInfo",!0)("showTooltip",!0)}}function Ms(o,n){if(1&o&&e.\u0275\u0275element(0,"avatar-row",6),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("emails",t.owners)("numAvatarsToShow",t.avatarRowCount)("rowStyle",t.rowStyle)("avatarSize",t.avatarSize)}}function Oa(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,Ss,1,5,"user-details-host",3),e.\u0275\u0275template(2,Ms,1,4,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===i.owners.length&&!i.alwaysShowAvatarRow)("ngIfElse",t)}}function Ps(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275text(1,"\u2014"),e.\u0275\u0275elementEnd())}var Yi=function(){function o(){this.rowStyle="spread",this.avatarSize="medium",this.avatarRowCount=4}return o.prototype.ngOnChanges=function(n){var t;n.goal&&(this.owners=this.goal.owner?[this.goal.owner]:[],this.goal.additionalOwners&&(t=this.owners).push.apply(t,this.goal.additionalOwners.map(function(i){return i.userPrincipalName})))},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-owners-cell"]],inputs:{goal:"goal",alwaysShowAvatarRow:"alwaysShowAvatarRow",rowStyle:"rowStyle",avatarSize:"avatarSize",avatarRowCount:"avatarRowCount"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","content",4,"ngIf","ngIfElse"],["emptyOwner",""],[1,"content"],[3,"details","showUserInfo","showTooltip",4,"ngIf","ngIfElse"],["hasMultipleOwners",""],[3,"details","showUserInfo","showTooltip"],[3,"emails","numAvatarsToShow","rowStyle","avatarSize"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,Oa,4,2,"div",0),e.\u0275\u0275template(1,Ps,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",(null==i.owners?null:i.owners.length)>0)("ngIfElse",a)}},dependencies:[F.NgIf,D.s,Fe],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow:hidden}[_nghost-%COMP%]     .user-info{color:var(--scorecard-tableRowForegroundColor)!important;font-family:var(--scorecard-fontFamily)}"],changeDetection:0}),o}(),Ir=function(){function o(){}return o.buildSparklineValues=function(n,t,i){if(void 0===i&&(i=7),t&&n.aggregations)return _.chain(n.aggregations).filter(function(l){return"Sparkline"===l.type}).sortBy(function(l){return new Date(l.timestamp)}).takeRight(i).map(function(l){return{scorecardId:n.scorecardId,goalId:n.id,lastModifiedTime:l.maxLastModifiedTime,timestamp:l.timestamp,value:l.value,valueDisplayString:l.valueDisplayString,createdTime:l.calculationTime,lastModifiedBy:null}}).value();var a=_.sortBy(n.goalValues,function(l){return new Date(l.timestamp)});return _.takeRight(a.filter(function(l){return null!=l.value&&null!=l.timestamp}),i)},o.getSparklineOptions=function(n,t,i){var a,l,c,p,y,O,A,L=W.isDarkMode(),te=Ke.r.buildCurrentGoalValue(n),ue=Q.p.getGoalStatus(te?.status,t),Ae=Q.p.getGoalSparklineColor(ue.color,null===(a=i?.scorecardDisplayOptions)||void 0===a?void 0:a.isMobileLayout,L);return{height:null!==(p=null===(c=null===(l=i?.scorecardDisplayOptions)||void 0===l?void 0:l.sparklineOptions)||void 0===c?void 0:c.height)&&void 0!==p?p:48,width:null!==(A=null===(O=null===(y=i?.scorecardDisplayOptions)||void 0===y?void 0:y.sparklineOptions)||void 0===O?void 0:O.width)&&void 0!==A?A:120,lineColor:Ae,dotColor:Ae,showMin:!1,showMax:!1}},o}(),Vo=m(35911),Ea=m(27531),Ta=m(14463),Os=m(66794),Ji=m(47245),tr=m(61036),sr=m(29589),$n=m(47508),ii=m(79154),eo=m(39681),Es=m(32379),xa=m(78843),Ia=m(61289),Ts=m(26743),Qt=m(94419),Dr=m(80777),Da=m(40956),ka=m(2330),Fo=m(29866),Va=m(98136),to=m(232),Hr=m(698),Ao=function(n){return{"hide-legend":n}};function Fa(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",3)(1,"div",4),e.\u0275\u0275element(2,"div",5),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",4),e.\u0275\u0275element(7,"div",6),e.\u0275\u0275elementStart(8,"span"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"div",4)(12,"div",7),e.\u0275\u0275element(13,"div",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"span"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(12,Ao,"Hidden"==t.legend)),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",t.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,6,"Progress")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,8,"Milestones")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,10,"Target_Final"))}}function Aa(o,n){if(1&o&&e.\u0275\u0275element(0,"visual-modern",9),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.visualDefinition)("useOnPushChangeDetection",!0)}}var oi="Time",kr="Value",Ci="Targets",yi="Milestones",Ro="FinalTarget",Lo={xAxis:{show:!1},yAxis:{show:!1}},no=function(){function o(n,t,i,a,l,c,p,y){this.geocoder=n,this.geolocation=t,this.localizationService=i,this.moduleLoader=a,this.promiseFactory=l,this.visualPlugin=c,this.visualHostTooltipServiceFactory=p,this.changeDetector=y,this.showGoalTargets=!1,this.axesOptions={xAxis:{show:!0},yAxis:{show:!0}},this.legend="None",this.showZoom=!1,this.type="LineChart",this.targetLineColor=ne.gT.GoalTargetsLineColor,this.onSelected=new e.EventEmitter}return Object.defineProperty(o.prototype,"isComboChart",{get:function(){return"ComboChart"===this.type},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){var t,n=this;this.shadeCurrentArea=null!==(t=this.shadeCurrentArea)&&void 0!==t?t:this.isComboChart,this.visualPlugin.ensureBuiltInPlugins().then(function(){n.initializeVisual(),n.isLoaded=!0,n.changeDetector.detectChanges()})},o.prototype.ngOnChanges=function(n){(n.values||n.color||n.showGoalTargets||n.showAxis||n.targetLineColor||n.axesOptions||n.shadeCurrentArea)&&(this.generateDataView(),this.update())},o.prototype.initializeVisual=function(){var t,n=this,i=(0,eo.ED)((0,Ji.q)({geocoder:this.geocoder,geolocation:this.geolocation,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.create(),getAzureMapToken:void 0,azureMapsEndpoint:void 0,geocoderIndexedDB:void 0}),function(l){l.persistProperties=function(c,p){return n.persistProperties(c)},l.getLocalizedString=function(c){for(var p,y=[],O=1;O<arguments.length;O++)y[O-1]=arguments[O];return(p=n.localizationService).format.apply(p,(0,M.__spreadArray)([c],y||[],!1))},l.getViewMode=function(){return 0},l.locale=function(){return(0,tr.uD)()},l.promiseFactory=function(){return n.promiseFactory},l.onSelect=function(c){var p;if(!_.isEmpty(c?.visualObjects)){var y=null===(p=_.first(c.visualObjects))||void 0===p?void 0:p.selectorsByColumn;if(y){var O=_.first(y.dataMap[oi]);if((0,Es.yN)(O)){var A=(0,Ts.KX)(O.expr),L=_.first(A);L&&L.value&&n.onSelected.emit(L.value)}else u.fF.assertFail("Unexpected selector")}}}}),a=$n.L.lineChart.name;"AreaChart"===this.type?a=$n.L.areaChart.name:"ColumnChart"===this.type?a=$n.L.columnChart.name:"ComboChart"===this.type&&(a=$n.L.lineClusteredColumnComboChart.name),this.visualDefinition={interactivityOptions:{},type:a,allowInvalidDataView:!0,themeCollection:void 0,viewport:null!==(t=this.viewportSize)&&void 0!==t?t:{height:100,width:100,scale:1},dataTransforms:void 0,hostServices:i,visualAdapterHostServices:{startProgressBar:_.noop,stopProgressBar:_.noop,getNextDataSegment:function(){return(0,M.__awaiter)(n,void 0,void 0,function(){return(0,M.__generator)(this,function(c){return[2,{}]})})}},stylePresetName:void 0,additionalObjectUpdates:_.noop,visualPlugin:this.visualPlugin},this.update()},o.prototype.update=function(){var n,t;if(this.visualDefinition){var i={categoryAxis:[{properties:{show:(0,Qt.O7)(this.axesOptions.xAxis.show)}}],valueAxis:[{properties:{show:(0,Qt.O7)(this.axesOptions.yAxis.show)}}],dataPoint:[{selector:{metadata:kr},properties:{fill:{solid:{color:(0,Qt.fL)(this.color)}}}},{selector:{metadata:Ci},properties:{fill:{solid:{color:(0,Qt.fL)(this.targetLineColor)}}}},{selector:{metadata:yi},properties:{fill:{solid:{color:(0,Qt.fL)(this.targetLineColor)}}}},{selector:{metadata:Ro},properties:{fill:{solid:{color:(0,Qt.fL)(this.targetLineColor)}}}}],lineStyles:[{selector:{metadata:Ci},properties:{lineStyle:(0,Qt.fL)("dashed"),strokeWidth:(0,Qt.cA)(1.5),showMarker:(0,Qt.O7)(!1)}},{selector:{metadata:yi},properties:{showMarker:(0,Qt.O7)(!0),markerSize:(0,Qt.cA)(5),markerShape:(0,Qt.fL)("circle"),strokeWidth:(0,Qt.cA)(0)}},{selector:{metadata:Ro},properties:{showMarker:(0,Qt.O7)(!0),markerSize:(0,Qt.cA)(8),markerShape:(0,Qt.fL)("diamond"),strokeWidth:(0,Qt.cA)(0)}}],legend:[{properties:{show:(0,Qt.O7)(!1)}}],zoom:[{properties:{show:(0,Qt.O7)(this.showZoom),showOnValueAxis:(0,Qt.O7)(!1)}}]};if(this.isComboChart){for(var a=0,l=i.lineStyles;a<l.length;a++){var c=l[a];!_.isUndefined(c.selector)&&c.selector.metadata!==kr&&(c.properties.areaShow=(0,Qt.O7)(!1))}i.lineStyles.push({properties:{areaShow:(0,Qt.O7)(this.shadeCurrentArea)}})}this.setAxisFontProperties(i.categoryAxis[0].properties,null===(n=this.axesOptions)||void 0===n?void 0:n.xAxis.fontProperties),this.setAxisFontProperties(i.valueAxis[0].properties,null===(t=this.axesOptions)||void 0===t?void 0:t.yAxis.fontProperties),this.visualDefinition.dataTransforms={objects:i},this.applyDataTransformsForComboIfNeeded(),this.visualDefinition.data={dataView:this.dataView}}},o.prototype.setAxisFontProperties=function(n,t){t&&(t.color&&(n.labelColor={solid:{color:(0,Qt.fL)(t.color)}}),t.family&&(n.fontFamily=(0,Qt.fL)(t.family)),t.size&&(n.fontSize=(0,Qt.gH)(t.size.pt)),t.weight&&(n.bold=(0,Qt.O7)(t.weight===ii.en)),t.style&&(n.italic=(0,Qt.O7)(t.style===ii.BF)),t.textDecoration&&(n.underline=(0,Qt.O7)(t.textDecoration===ii.f0)))},o.prototype.persistProperties=function(n){var t=_.isArray(n)?{merge:n}:n;this.visualDefinition&&this.checkAndApplyDataTransformPropertyChanges(t)},o.prototype.checkAndApplyDataTransformPropertyChanges=function(n){var t;if(t=this.isComboChart?$n.L.lineClusteredColumnComboChart.capabilities:$n.L.lineChart.capabilities,!_.isEmpty(n.merge)||!_.isEmpty(n.remove)){var a=t.objects;this.update(),(0,Os._6)(n,a,this.visualDefinition.dataTransforms.objects),this.changeDetector.detectChanges()}},o.prototype.onResize=function(n){this.viewportSize={width:n.width,height:n.height,scale:1},this.visualDefinition&&(this.visualDefinition.viewport=this.viewportSize)},o.prototype.generateDataView=function(){var n,t,i,a,l,c,p,y,O,A,L=[{displayName:this.localizationService.get("Date"),queryName:oi,type:Dr.Ge.fromPrimitiveTypeAndCategory(6),roles:{Category:!0}},{displayName:this.localizationService.get("Role_DisplayName_Value"),queryName:kr,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:0,objects:(n={},n[sr.iu.objectName]=(t={},t[sr.iu.propertyName]=this.formatString,t),n)}];this.showGoalTargets&&(L.push({displayName:this.localizationService.get("Target"),queryName:Ci,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:1,objects:(i={},i[sr.iu.objectName]=(a={},a[sr.iu.propertyName]=this.formatString,a),i)}),L.push({displayName:this.localizationService.get("Target_Milestone_Due"),queryName:yi,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:2,objects:(l={},l[sr.iu.objectName]=(c={},c[sr.iu.propertyName]=this.formatString,c),l)}),L.push({displayName:this.localizationService.get("Target_Final_Due"),queryName:Ro,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:3,objects:(p={},p[sr.iu.objectName]=(y={},y[sr.iu.propertyName]=this.formatString,y),p)})),this.updateColumnsForComboIfNeeded(L);var te=(0,Qt.Oh)((0,Qt.fL)("Date"),"Date"),ue=null!==(A=this.values)&&void 0!==A?A:[];ue=ue.filter(function(Mt){return!_.isNil(Mt.value)||!_.isNil(Mt.target)}),ue=_.sortBy(ue,function(Mt){return new Date(Mt.timestamp)});var Ae,Ne,Je=[],ze=[],ot=[];if(this.showGoalTargets){Ae=[],Ne=[];for(var ft=(O=function(){for(var Mt=ue.length-1;Mt>=0;Mt--)if(!_.isNil(ue[Mt].target))return[ue[Mt].target,ue[Mt].timestamp];return[void 0,void 0]}())[0],xt=O[1],Kt=function(Wt){for(var nn=Wt+1;nn<ue.length&&_.isNil(ue[nn].target);)nn++;return nn<ue.length?ue[nn].target:void 0},kt=0;kt<ue.length;kt++){var Rt=ue[kt],Y=Kt(kt);Ae.push(Rt.timestamp),Ne.push(Rt.value),Je.push(Rt.target!==Y&&Rt.timestamp!==xt?Rt.target:void 0),ze.push(Rt.timestamp===xt?Rt.target:void 0),_.isNil(Rt.target)?ot.push(0===kt?Y:kt===ue.length-1?ft:void 0):(ot.push(Rt.target),_.isNil(Y)||(Ae.push(Rt.timestamp),ot.push(Y),Ne.push(void 0),Je.push(void 0),ze.push(void 0)))}}else Ae=ue.map(function(Mt){return Mt.timestamp}),Ne=ue.map(function(Mt){return Mt.value});var Ie=[];Ie.push({source:L[1],values:Ne}),this.showGoalTargets&&(Ie.push({source:L[3],values:Je}),Ie.push({source:L[4],values:ze}),Ie.push({source:L[2],values:ot}));var Le={metadata:{columns:L},categorical:{categories:[{source:L[0],values:_.map(Ae,function(Mt){var Wt=new Date(Mt),nn=se.E.treatAsLocalDate(Wt);return nn.epochTimeStamp=Wt.getTime(),nn}),identity:_.map(Ae,function(Mt){return(0,xa.TZ)((0,Qt.Dg)(te,(0,Qt.fL)(Mt)))})}],values:(0,Ia.Yv)(Ie)}};this.dataView=Le},o.prototype.updateColumnsForComboIfNeeded=function(n){if(this.isComboChart)for(var t=0,i=0,a=n;i<a.length;i++){var l=a[i];l.queryName!==oi&&(l.roles={Y2:!0}),l.index=t,t++}},o.prototype.applyDataTransformsForComboIfNeeded=function(){if(this.isComboChart){var n=this.dataView.metadata.columns.map(function(a){return{displayName:a.displayName,queryName:a.queryName,roles:a.roles}});this.visualDefinition.dataTransforms.selects=n;var t={};for(var i in n)t[i]=!0;this.visualDefinition.dataTransforms.splits=[{selects:void 0},{selects:t}]}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Da.i),e.\u0275\u0275directiveInject(Vo._1),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(ka.m),e.\u0275\u0275directiveInject(Ta.t),e.\u0275\u0275directiveInject(Fo.D),e.\u0275\u0275directiveInject(Va.q),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-history-chart"]],inputs:{values:"values",formatString:"formatString",color:"color",showGoalTargets:"showGoalTargets",axesOptions:"axesOptions",legend:"legend",showZoom:"showZoom",type:"type",shadeCurrentArea:"shadeCurrentArea",targetLineColor:"targetLineColor"},outputs:{onSelected:"onSelected"},features:[e.\u0275\u0275ProvidersFeature((0,M.__spreadArray)([],Ea.H,!0)),e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","legend",3,"ngClass",4,"ngIf"],[1,"linechart-wrapper",3,"on-resize"],["class","linechart",3,"viewModel","useOnPushChangeDetection",4,"ngIf"],[1,"legend",3,"ngClass"],[1,"label"],[1,"square"],[1,"circle","filled"],[1,"square","center-diamond"],[1,"diamond","filled"],[1,"linechart",3,"viewModel","useOnPushChangeDetection"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Fa,17,14,"div",0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275listener("on-resize",function(l){return i.onResize(l)}),e.\u0275\u0275template(2,Aa,1,2,"visual-modern",2),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("ngIf","None"!=i.legend),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.isLoaded&&!!i.viewportSize))},dependencies:[F.NgClass,F.NgIf,to.y,Hr.O,Bt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .linechart-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}[_nghost-%COMP%]   .linechart-wrapper[_ngcontent-%COMP%]   .linechart[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;border-radius:4px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:8px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%], [_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{width:12px;height:12px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{border-radius:50%}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .center-diamond[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .diamond[_ngcontent-%COMP%]{width:10px;height:10px;transform:rotate(45deg)}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .filled[_ngcontent-%COMP%]{background-color:#8a8886}[_nghost-%COMP%]   .hide-legend[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),o}(),bi=m(64929);function wi(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-history-chart",1),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.options.width+"px")("height",t.options.height+"px"),e.\u0275\u0275property("width",t.options.width)("height",t.options.height)("values",t.values)("formatString",t.goal.valuesFormatString)("color",t.options.lineColor)("showGoalTargets",!1)("axesOptions",t.axesOptions)("legend","None")}}var ai=function(){function o(n,t){this.scorecardService=n,this.scorecardConfigurationService=t,this.axesOptions=Lo}return o.prototype.ngOnChanges=function(n){var i,a,l,t=this;if((n.goal||n.sparklineValues)&&(this.isCategorical=!_.isEmpty(this.scorecardService.getGoalValueCategories(this.goal)),this.values=null!==(i=this.sparklineValues)&&void 0!==i?i:Ir.buildSparklineValues(this.goal,!0).map(function(y){return{value:y.value,timestamp:y.timestamp}})),n.goal||n.height||n.width){var c=null!==(l=null===(a=this.scorecardConfigurationService)||void 0===a?void 0:a.getConfiguration())&&void 0!==l?l:{scorecardDisplayOptions:{isMobileLayout:!1}},p=(0,bt.ZP)(c,function(y){y.scorecardDisplayOptions.sparklineOptions||(y.scorecardDisplayOptions.sparklineOptions={}),t.height&&(y.scorecardDisplayOptions.sparklineOptions.height=t.height),t.width&&(y.scorecardDisplayOptions.sparklineOptions.width=t.width)});this.options=Ir.getSparklineOptions(this.goal,this.scorecardService.getGoalStatuses(this.goal),p)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(bi.V,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-sparkline-cell"]],inputs:{goal:"goal",sparklineValues:"sparklineValues",height:"height",width:"width"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[3,"width","height","values","formatString","color","showGoalTargets","axesOptions","legend",4,"ngIf"],[3,"width","height","values","formatString","color","showGoalTargets","axesOptions","legend"]],template:function(t,i){1&t&&e.\u0275\u0275template(0,wi,1,12,"goal-history-chart",0),2&t&&e.\u0275\u0275property("ngIf",!i.isCategorical&&!i.goal.currentRefreshInProgress&&(null==i.values?null:i.values.length)>1&&i.options)},dependencies:[F.NgIf,no],changeDetection:0}),o}();function Si(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",1)(1,"span",2),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(t.style),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",t.text),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.text)}}var zr=function(){function o(n){this.localizationService=n,this.goalStatusHelper=new Q.p(this.localizationService)}return o.prototype.ngOnChanges=function(){this.configText(),this.configStyle()},o.prototype.configStyle=function(){if(this.outlineOnly){var n=Q.p.getGoalStatus(this.status,this.goalStatuses).color,t=Q.p.getGoalSparklineColor(n,this.isMobile,this.isDarkMode);this.style={color:void 0,"background-color":void 0,border:"1px solid ".concat(t)}}else{n=Q.p.getGoalStatus(this.status,this.goalStatuses).color;var i=Q.p.getGoalStatusTextColor(n,this.isMobile,this.isDarkMode),a=Q.p.getGoalStatusColor(n,this.isMobile,this.isDarkMode);this.style={color:i,"background-color":a,border:"none"},this.isMobile&&!this.text.trim().length&&(this.style.visibility="hidden")}},o.prototype.configText=function(){var n,t=null===(n=Q.p.getGoalStatus(this.status,this.goalStatuses))||void 0===n?void 0:n.displayName;this.text=this.goalStatusHelper.tryLocalizeDisplayName(t)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["status-icon"]],inputs:{goalStatuses:"goalStatuses",isDarkMode:"isDarkMode",isMobile:"isMobile",outlineOnly:"outlineOnly",status:"status"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","status",3,"style",4,"ngIf"],[1,"status"],[3,"pbiTooltip"]],template:function(t,i){1&t&&e.\u0275\u0275template(0,Si,3,4,"div",0),2&t&&e.\u0275\u0275property("ngIf",i.text)},dependencies:[F.NgIf,oe.V],styles:[".status[_ngcontent-%COMP%]{height:24px;line-height:24px;padding-left:10px;padding-right:10px;border-radius:12px;white-space:nowrap;text-align:center;font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:-webkit-fill-available;display:inline-block}",'mobile-scorecard-container[_nghost-%COMP%]   .status[_ngcontent-%COMP%], mobile-scorecard-container   [_nghost-%COMP%]   .status[_ngcontent-%COMP%]{height:18px;line-height:18px;padding-left:10px;padding-right:10px;border-radius:12px;white-space:nowrap;text-align:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);font-weight:500;text-overflow:ellipsis;overflow:hidden;min-width:35px}'],changeDetection:0}),o}(),ro=function(){function o(n){this.scorecardService=n}return o.prototype.ngOnChanges=function(n){n.goal&&(this.status=Ke.r.buildCurrentGoalValue(this.goal).status,this.goalStatuses=this.scorecardService.getGoalStatuses(this.goal))},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-status-cell"]],inputs:{goal:"goal"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:2,consts:[[3,"status","goalStatuses"]],template:function(t,i){1&t&&e.\u0275\u0275element(0,"status-icon",0),2&t&&e.\u0275\u0275property("status",i.status)("goalStatuses",i.goalStatuses)},dependencies:[zr],styles:["[_nghost-%COMP%]{display:flex;flex:1;height:100%;overflow:hidden;align-items:center;justify-content:center}"],changeDetection:0}),o}();function Mi(o){if("number"==typeof o)return o;switch(o.toString().trim().toLowerCase()){case"sum":return 1;case"average":return 2;case"min":return 3;case"max":return 4;default:return void u.fF.assertNever(o)}}function Go(o){var n;return(n={})[1]=o.get("Rollups_Submetrics_Sum"),n[2]=o.get("Rollups_Submetrics_Average"),n[3]=o.get("Rollups_Submetrics_Min"),n[4]=o.get("Rollups_Submetrics_Max"),n}function Pi(o){if(o?.id){for(var n=[],t={hierarchyId:o.hierarchyId,levels:n};o;)n.push(o.value),o=o.parent;return n.reverse(),t}u.fF.assertFail("Invalid item")}function Br(o,n){for(var i,t=n,a=function(A){if(!(i=_.find(t,function(L){return L.value===A})))return u.fF.assertFail("Item not found for path"),{value:void 0};t=i.children},l=0,c=o;l<c.length;l++){var y=a(c[l]);if("object"==typeof y)return y.value}return i}function io(o,n){for(var t=[],i=0,a=o;i<a.length;i++){var l=a[i],c=Br(l.levels,n[l.hierarchyId]);c&&t.push(c)}return t}function si(o){return _.map(_.filter(o,function(n){return!!n.id}),function(n){return Pi(n)})}var qr=m(54834);function Wr(o){return(0,M.__assign)((0,M.__assign)({},o),{connections:_.map(o.connections,function(n){return function(o,n){var t={datasetId:o.datasetId,levels:_.map(n,function(i){return function(o){return{levelId:o.levelId,fieldExpr:o.field?qr.ib.deserializeExpr(JSON.parse(o.field)):void 0,filter:o.fieldFilter?qr.ib.deserializeFilter(JSON.parse(o.fieldFilter)):void 0}}(_.find(o.levels,function(l){return l.levelId===i.id})??{levelId:i.id,field:void 0})})};return o.ownerField&&(t.ownerFieldExpr=qr.ib.deserializeExpr(JSON.parse(o.ownerField))),t}(n,o.levels)})})}function jr(o){return{id:o.id,levels:o.levels,name:o.name,scorecardId:o.scorecardId,owner:o.owner,connections:_.map(o.connections,function(n){return function(o){var n={datasetId:o.datasetId,levels:_.map(o.levels,function(t){return function(o){return{levelId:o.levelId,field:o.fieldExpr?JSON.stringify(qr.ib.serializeExpr(o.fieldExpr)):void 0,fieldFilter:o.filter?JSON.stringify(qr.ib.serializeFilter(o.filter)):void 0}}(t)})};return o.ownerFieldExpr&&(n.ownerField=JSON.stringify(qr.ib.serializeExpr(o.ownerFieldExpr))),n}(n)})}}var lr=m(72489),No=m(9936),Jn=function(){function o(n,t,i){this.goalsHttpService=n,this.errorService=t,this.localization=i,this._hierarchies$=new ye.X(null),this._hierarchyItems$=new ye.X({}),this._hierarchyErrors$=new ye.X({}),this._isSaving$=new ye.X(!1),this.loadingHierarchyItems=new Set,this.isLoadingHierarchies=!1,this.isSaving$=this._isSaving$,this.hierarchies$=this._hierarchies$.pipe((0,G.x)()),this.hierarchyItems$=this._hierarchyItems$.pipe((0,On.h)(function(a){return!_.isEmpty(a)}),(0,G.x)()),this.hierarchyErrors$=this._hierarchyErrors$.pipe((0,G.x)()),this.hasHierarchies$=this.hierarchies$.pipe((0,On.h)(function(a){return!!a}),(0,dt.U)(function(a){return!_.isEmpty(a)}),(0,G.x)())}return Object.defineProperty(o.prototype,"hierarchies",{get:function(){return this._hierarchies$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hierarchyItems",{get:function(){return this._hierarchyItems$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hierarchyErrors",{get:function(){return this._hierarchyErrors$.value},enumerable:!1,configurable:!0}),o.prototype.setHierarchies=function(n){this._hierarchies$.next(n)},o.prototype.setHierarchyItems=function(n,t){var i=_.find(this.hierarchies,function(a){return a.id===n});u.fF.assertValue(i,"No hierarchies with id ".concat(n)),this._hierarchyItems$.next((0,bt.Uy)(this.hierarchyItems,function(a){a[n]=t}))},o.prototype.setHierarchyErrors=function(n){this._hierarchyErrors$.next(n)},o.prototype.saveHierarchies=function(){var n;return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l,c,p,y,O,L,te,ue,Ae,Ne,Je,ot,ft=this;return(0,M.__generator)(this,function(xt){switch(xt.label){case 0:if(!this.hierarchies||!this.scorecardId||this.isLoadingHierarchies)return u.fF.assertFail("Hierarchies not loaded"),[2];if(this._isSaving$.value)return u.fF.assertFail("Save already in progress"),[2];if(_.some(this.hierarchyErrors,function(Kt){return _.some(Kt,function(kt){return"Error"===kt.severity})}))return u.fF.assertFail("Save blocked by error"),[2];this._isSaving$.next(!0),xt.label=1;case 1:return xt.trys.push([1,11,12,13]),[4,this.goalsHttpService.getScorecardHierarchies(this.groupId,this.scorecardId).toPromise()];case 2:for(t=xt.sent(),i=_.filter(t,function(Kt){return!_.some(ft.hierarchies,function(kt){return Kt.id===kt.id})}),a=[],l=_.filter(_.flatten(_.values(this.hierarchyErrors)),function(Kt){return"MetricsHierarchy_NoDatasetAccess"===Kt.code}),c=function(kt){var Rt=_.find(p.hierarchies,function(Ie){return Ie.id===kt.hierarchyId});u.fF.assertValue(Rt,"Hierarchy with id ".concat(kt.hierarchyId," not found to clear invalid mapping"));var Y=_.find(Rt.connections,function(Ie){return Ie.datasetId===kt.datasetId});u.fF.assertValue(Y,"Connection with id ".concat(kt.datasetId," not found to clear invalid mapping")),Y.levels.forEach(function(Ie){Ie.fieldExpr=void 0,Ie.filter=void 0})},p=this,y=0,O=l;y<O.length;y++)c(O[y]);L=function(kt){var Rt,Y,Ie,Le;return(0,M.__generator)(this,function(Mt){switch(Mt.label){case 0:return kt.isNew?_.some(kt.connections,function(Wt){return _.some(Wt?.levels,function(nn){return!!nn?.fieldExpr})})?(Y=function(o){var n=jr(o);return{name:n.name,levels:n.levels,connections:n.connections}}(kt),[4,te.goalsHttpService.createScorecardHierarchy(te.groupId,te.scorecardId,Y).toPromise()]):[3,2]:[3,3];case 1:Ie=Mt.sent(),Le=Wr(Ie),a.push(Le),Mt.label=2;case 2:return[3,7];case 3:return(Rt=_.find(t,function(Wt){return Wt.id===kt.id}))?[3,4]:(u.fF.assertFail("Cannot updated a deleted hierarchy"),[3,7]);case 4:return _.isEqual(jr(Wr(Rt)),jr(kt))?[3,6]:(Y=function(o){return{hierarchy:jr(o)}}(kt),[4,te.goalsHttpService.updateScorecardHierarchy(te.groupId,te.scorecardId,kt.id,Y).toPromise()]);case 5:return Ie=Mt.sent(),Le=Wr(Ie),a.push(Le),[3,7];case 6:a.push(kt),Mt.label=7;case 7:return[2]}})},te=this,ue=0,Ae=this.hierarchies,xt.label=3;case 3:return ue<Ae.length?[5,L(Ae[ue])]:[3,6];case 4:xt.sent(),xt.label=5;case 5:return ue++,[3,3];case 6:Ne=0,Je=i,xt.label=7;case 7:return Ne<Je.length?[4,this.goalsHttpService.deleteScorecardHierarchy(this.groupId,this.scorecardId,Je[Ne].id).toPromise()]:[3,10];case 8:xt.sent(),xt.label=9;case 9:return Ne++,[3,7];case 10:return this.setHierarchies(a),[3,13];case 11:throw ot=xt.sent(),this.errorService.error(this.localization.get("MetricsHierarchy_Cannot_Save_Hierarchies"),"GoalsCannotSaveHierarchies",{requestId:ot?.requestId,statusCode:null===(n=ot?.status)||void 0===n?void 0:n.toString()}),ot;case 12:return this._isSaving$.next(!1),[7];case 13:return[2]}})})},o.prototype.loadHierarchies=function(n,t,i){var a=this;return void 0===i&&(i=!0),this.scorecardId===t&&i&&this.hierarchies||this.scorecardId===t&&this.isLoadingHierarchies||(this.scorecardId=t,this.groupId=n,this.isLoadingHierarchies=!0,this.goalsHttpService.getScorecardHierarchies(n,this.scorecardId).toPromise().then(function(l){if(a.setHierarchies(function(o){return _.map(o,function(n){return Wr(n)})}(l)),!i&&!_.isEmpty(a.hierarchyItems))for(var c in a.hierarchyItems)a.loadHierarchyItems(c,!1)}).catch(function(l){throw a.setHierarchies([]),l}).finally(function(){a.isLoadingHierarchies=!1,a.gc()})),this.hierarchies$},o.prototype.loadHierarchyItems=function(n,t){var i=this;return void 0===t&&(t=!0),u.fF.assertValue(this.scorecardId,"No scorecard loaded"),(!t||_.isEmpty(this.hierarchyItems[n])&&!this.loadingHierarchyItems.has(n))&&(this.loadingHierarchyItems.add(n),this.goalsHttpService.getScorecardHierarchyItems(this.groupId,this.scorecardId,n).toPromise().then(function(a){return i.setHierarchyItems(n,function(o){for(var n=_.cloneDeep(o),t=_.groupBy(n,function(y){return y.id}),i=[],a=0,l=n;a<l.length;a++){var c=l[a];if(c.parentHierarchyItemId){var p=_.first(t[c.parentHierarchyItemId]);c.parent=p,p?p.children?p.children.push(c):p.children=[c]:u.fF.assertFail("Parent item missing")}else i.push(c)}return i}(a))}).catch(function(a){var l;u.fF.assertFail("Error loading hierarchy items. "+(null===(l=a?.error)||void 0===l?void 0:l.message)),i.setHierarchyItems(n,[])}).finally(function(){return i.loadingHierarchyItems.delete(n)})),this.hierarchyItems$.pipe((0,dt.U)(function(a){return a[n]}),(0,G.x)())},o.prototype.getHierarchyItemsForPath=function(n){var t=this;return _.isEmpty(n)?(0,me.of)(null):(0,No.D)(_.map(n,function(i){return t.loadHierarchyItems(i.hierarchyId).pipe((0,On.h)(function(a){return!!a}),(0,Me.q)(1))})).pipe((0,dt.U)(function(){return io(n,t.hierarchyItems)}))},o.prototype.getHierarchyDisplayInfoObservable=function(n){var t=this;return(0,zn.aj)([n,this.hierarchies$]).pipe((0,dt.U)(function(i){return t.getHierarchyDisplayInfo(i[1],i[0])}),(0,dr.d)({bufferSize:1,refCount:!0}))},o.prototype.getHierarchyDisplayInfo=function(n,t){var a,i=this.localization.get("All"),l=_.map(t,function(O){return(0,M.__assign)((0,M.__assign)({},O),{levels:O.levels.map(function(A){return(0,lr.WU)(A)})})}),c=_.keyBy(l,function(O){return O.hierarchyId});if(!_.isEmpty(t)){var p=_.map(n,function(O){var A;return _.last(null===(A=c[O.id])||void 0===A?void 0:A.levels)});a=_.join(_.compact(p),", ")}var y=_.map(n,function(O){return _.has(c,O.id)?(0,M.__assign)((0,M.__assign)({},c[O.id]),{hierarchyName:O.name}):{hierarchyId:O.id,hierarchyName:O.name,levels:[i]}});return{showingAll:_.isEmpty(t),displayLabel:a,displayPaths:y}},o.prototype.formatHierarchyItemPath=function(n){var t;return(0,M.__assign)((0,M.__assign)({},n),{levels:n.levels.map(function(i){return(0,lr.WU)(i)}),hierarchyName:null===(t=this.hierarchies.find(function(i){return i.id===n.hierarchyId}))||void 0===t?void 0:t.name})},o.prototype.getActiveHierarchies=function(n){return _.intersectionWith(this.hierarchies,n,function(t,i){return t.id===i.hierarchyId})},o.prototype.isDatasetMappedToHierarchyPath=function(n,t){if(_.isNil(n)||_.isEmpty(t))return u.fF.assertFail("Expected datasetId and hierarchyPaths to be defined"),!1;var i=this.getActiveHierarchies(t);return _.some(i,function(a){return _.some(a.connections,function(l){return l.datasetId===n&&_.some(l.levels,function(c){return!!c.fieldExpr})})})},o.prototype.isGoalOwnerMappedToHierarchy=function(n,t){if(!n.valueConnection&&!n.targetConnection||_.isEmpty(t))return!1;var i=this.getActiveHierarchies(t);return _.some(i,function(a){var l=_.find(a.connections,function(c){var p,y;return c.datasetId===(null===(p=n.valueConnection)||void 0===p?void 0:p.datasetId)||c.datasetId===(null===(y=n.targetConnection)||void 0===y?void 0:y.datasetId)});return!!l?.ownerFieldExpr})},o.prototype.gc=function(){var n=this,t=new Set(_.map(this.hierarchies,function(a){return a.id})),i=(0,bt.Uy)(this.hierarchyItems,function(a){for(var l=0,c=Object.keys(n.hierarchyItems);l<c.length;l++){var p=c[l];t.has(p)||delete a[p]}});i!==this.hierarchyItems&&this._hierarchyItems$.next(i)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Lt),e.\u0275\u0275inject(Po.T),e.\u0275\u0275inject(Vt.o))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),cr=m(24326),$r=m(90127);function Ho(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",4)}function lo(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2),i=e.\u0275\u0275reference(4);e.\u0275\u0275property("pbiTooltip",i),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind3(2,2,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString)," ")}}function co(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1,"/"),e.\u0275\u0275elementContainerEnd())}var zo=function(n){return{"combined-target":n}};function Bo(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275template(1,co,2,0,"ng-container",10),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2),i=e.\u0275\u0275reference(6);e.\u0275\u0275property("pbiTooltip",i)("ngClass",e.\u0275\u0275pureFunction1(8,zo,t.showValueAndTargetCombined)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showValueAndTargetCombined),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(4,4,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString))}}var uo=function(n,t){return{categories:n,compact:t}};function Fr(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275template(1,lo,3,6,"div",6),e.\u0275\u0275template(2,Bo,5,10,"div",7),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(3,uo,!!t.categories,t.compact)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showCurrent&&t.hasValueOrConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(t.showTarget||t.showMilestone)&&t.hasTargetOrConnection)}}function Uo(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueNotConnected")," "))}function po(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Rollups_Submetrics_Tooltip_Footer")))}function Pn(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"div",16),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,po,3,3,"div",10),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",e.\u0275\u0275pipeBind4(3,3,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString,!1)," ",t.valueRollupsString,""),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.canViewAllGoals)}}function Na(o,n){if(1&o&&e.\u0275\u0275template(0,Pn,5,8,"div",12),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",(null==i.goal?null:i.goal.valueRollup)&&!(null!=i.goal&&i.goal.isLinked))("ngIfElse",t)}}function Ha(o,n){if(1&o&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"formatGoalValue")),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(1,1,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString,!1)," ")}}function qo(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,Uo,6,6,"div",12),e.\u0275\u0275template(2,Na,1,2,"ng-template",null,13,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,Ha,2,6,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isCurrentValueNotConnectedToHierarchy)("ngIfElse",t)}}function za(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,2,t.showTarget?"Role_DisplayName_TargetValue":"Role_DisplayName_MilestoneValue")," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueNotConnected")," ")}}function pr(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Rollups_Submetrics_Tooltip_Footer")))}function Oi(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"div",16),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,pr,3,3,"div",10),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",e.\u0275\u0275pipeBind4(3,3,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString,!1)," ",t.targetRollupsString," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.canViewAllGoals)}}function Ba(o,n){if(1&o&&e.\u0275\u0275template(0,Oi,5,8,"div",12),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",(null==i.goal?null:i.goal.targetRollup)&&!(null!=i.goal&&i.goal.isLinked))("ngIfElse",t)}}function Wo(o,n){if(1&o&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementStart(2,"div",20),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(1,2,t.showTarget?"Target_Final":"Target_Next")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(4,4,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString,!1)," ")}}function ho(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275template(1,za,6,6,"div",12),e.\u0275\u0275template(2,Ba,1,2,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,Wo,5,9,"ng-template",null,19,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isTargetValueNotConnectedToHierarchy)("ngIfElse",t)}}var li=function(){function o(n,t,i,a){var l=this;this.hierarchyService=n,this.localizationService=t,this.scorecardService=i,this.changeDetector=a,this.currentValue=null,this.canViewAllGoals=!0,this.metricRollups=Go(this.localizationService),this.scorecardSubscription=this.scorecardService.getScorecard().subscribe(function(c){var p;l.scorecard=c,l.canViewAllGoals=3===rt(null===(p=l.scorecard)||void 0===p?void 0:p.permissions),l.goal&&(l.setHierarchyTooltips(),l.categories=l.scorecardService.getGoalValueCategories(l.goal)),l.changeDetector.markForCheck()})}return o.prototype.ngOnChanges=function(n){var t=this;n.goal&&(this.formatString=this.goal.valuesFormatString,this.currentValue=Ke.r.buildCurrentGoalValue(this.goal),this.hasValueOrConnection=!_.isNil(this.currentValue.value)||!_.isNil(this.goal.valueConnection),this.hasTargetOrConnection=!_.isNil(this.currentValue.finalTarget)||!_.isNil(this.currentValue.nextTarget)||!_.isNil(this.goal.targetConnection),_.isNil(this.goal.valueRollup)||(this.valueRollupsString=this.localizationService.format("Rollups_Submetrics_Tooltip_Header",[this.metricRollups[Mi(this.goal.valueRollup.rollupType)]])),_.isNil(this.goal.targetRollup)||(this.targetRollupsString=this.localizationService.format("Rollups_Submetrics_Tooltip_Header",[this.metricRollups[Mi(this.goal.targetRollup.rollupType)]])),this.categories=this.scorecardService.getGoalValueCategories(this.goal),this.setHierarchyTooltips()),(n.showCurrent||n.showTarget||n.showMilestone)&&(u.fF.assert(function(){return!(t.showTarget&&t.showMilestone)},"GoalValueCell can't show both target and milestone."),this.showValueAndTargetCombined=this.showCurrent&&(this.showTarget||this.showMilestone))},o.prototype.ngOnDestroy=function(){this.scorecardSubscription.unsubscribe()},o.prototype.setHierarchyTooltips=function(){var n,t=!_.isEmpty(null===(n=this.scorecard)||void 0===n?void 0:n.hierarchyPaths);this.isCurrentValueNotConnectedToHierarchy=t&&this.goal.valueConnection&&!this.hierarchyService.isDatasetMappedToHierarchyPath(this.goal.valueConnection.datasetId,this.scorecard.hierarchyPaths),this.isTargetValueNotConnectedToHierarchy=t&&this.goal.targetConnection&&!this.hierarchyService.isDatasetMappedToHierarchyPath(this.goal.targetConnection.datasetId,this.scorecard.hierarchyPaths)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-value-cell"]],inputs:{goal:"goal",showCurrent:"showCurrent",showTarget:"showTarget",showMilestone:"showMilestone",compact:"compact"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:2,consts:[["class","pbi-spinner-medium",4,"ngIf","ngIfElse"],["noRefresh",""],["valueTooltip",""],["targetTooltip",""],[1,"pbi-spinner-medium"],[1,"content",3,"ngClass"],["class","value",3,"pbiTooltip",4,"ngIf"],["class","target",3,"pbiTooltip","ngClass",4,"ngIf"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip","ngClass"],[4,"ngIf"],[1,"goal-current-tooltip"],[4,"ngIf","ngIfElse"],["rollupsValueTooltip",""],["currentValueTooltip",""],[1,"no-hierarchy-label"],[1,"rollups"],[1,"goal-target-tooltip"],["rollupsTargetTooltip",""],["targetValueTooltip",""],[1,"target-value"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,Ho,1,0,"pbi-spinner",0),e.\u0275\u0275template(1,Fr,3,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,qo,6,2,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,ho,6,2,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",!(null==i.goal||!i.goal.currentRefreshInProgress)||!(null==i.goal||!i.goal.targetRefreshInProgress))("ngIfElse",a)}},dependencies:[F.NgClass,F.NgIf,cr.k,oe.V,Bt.F,$r.D],styles:["pbi-spinner[_ngcontent-%COMP%]{display:flex;position:relative;top:3px;left:10px}.content[_ngcontent-%COMP%]{display:flex;overflow:hidden;white-space:nowrap;align-items:baseline;font-size:var(--lg-font-size);font-weight:var(--font-weight-regular)}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--xxlg-font-size);font-weight:var(--font-weight-semi-bold)}.content[_ngcontent-%COMP%]   .combined-target[_ngcontent-%COMP%]{font-size:var(--md-font-size)}.content.categories[_ngcontent-%COMP%]{white-space:nowrap}.content.categories[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--vlg-font-size)}.content.compact[_ngcontent-%COMP%], .content.compact[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--md-font-size)}.no-hierarchy-label[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}.rollups[_ngcontent-%COMP%]{font-weight:var(--font-weight-regular)}.goal-target-tooltip[_ngcontent-%COMP%]{margin-left:4px;margin-right:4px}.goal-target-tooltip[_ngcontent-%COMP%]   .target-value[_ngcontent-%COMP%]{margin-top:4px;text-align:center}"],changeDetection:0}),o}(),Sn=m(59968),ci=m(17653),jo=m(87088);function go(o,n,t,i){t&&"function"!=typeof t&&(i=t);var a="function"==typeof t?t:void 0,l=new Gr.t(o,n,i);return function(c){return(0,jo.O)(function(){return l},a)(c)}}var fo=m(46266),mo=m(41819),Qr=function(o){return o[o.Default=0]="Default",o[o.ShowCheckin=1]="ShowCheckin",o[o.ShowStatusRules=2]="ShowStatusRules",o}({}),yr=function(){function o(n,t,i){this.sideFlyoutService=n,this.scorecardHost=t,this.hierarchyService=i,this.destroy$=new Gr.t(1)}return o.prototype.openGoalDetails=function(n,t,i,a){var l=this;n.selectGoal(t);var c=n.getCurrentScorecard(),p=W.getGoal(c.goals,t),y=n.getGoalValueCategoryLists(p),O=n.getGoalStatuses(p),A=this.traverse(n.getActiveGoal(),n).pipe((0,dt.U)(function(L){var te,ue=null===(te=c.goals)||void 0===te?void 0:te.findIndex(function(Ae){return Ae.id===L});return ne.gT.ColorPalette[ue>0?ue%ne.gT.ColorPalette.length:0]}));this.destroy$&&(this.destroy$.next(!0),this.destroy$.complete()),this.destroy$=new Gr.t(1),this.sideFlyoutService.show({componentManifest:{componentId:"GoalsDetailsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goal$:n.getActiveGoal().pipe((0,ci.b)(function(L){L&&n.expandGoalValues(L.id)}),go(1),(0,fo.x)(),(0,We.R)(this.destroy$)),scorecardHierarchyInfo$:this.hierarchyService?this.hierarchyService.getHierarchyDisplayInfoObservable(n.hierarchyPaths$):(0,me.of)({showingAll:!0}),openAction:i,scorecardConfiguration:a,goalPreviewColor$:A,goalValueCategories:y,goalStatuses:O,showGoalTargetsInChart$:n.getScorecard().pipe((0,dt.U)(function(L){return L.showGoalTargetsInChart})),close:function(){l.sideFlyoutService.hide(),n.unselectAllGoals()},saveGoalValue:function(te,ue){return(0,M.__awaiter)(l,void 0,void 0,function(){var Ae,Ne,Je,ze;return(0,M.__generator)(this,function(ot){switch(ot.label){case 0:return[4,n.saveGoalValue(te,ue)];case 1:return ot.sent(),Ae=n.getCurrentScorecard(),Ne=W.getGoal(Ae.goals,te),null===(Je=this.scorecardHost)||void 0===Je||Je.onUpdateScorecard(Ae),null===(ze=this.scorecardHost)||void 0===ze||ze.updateCachedGoal(Ne),[2]}})})},insertNote:function(te,ue,Ae){return n.insertNote(te,ue,Ae)},deleteNote:function(te){return n.deleteNote(te)},editNote:function(te,ue,Ae,Ne){return n.editNote(te,ue,Ae,Ne)},deleteGoalValue:function(te){return n.deleteGoalValue(te)},saveGoal:function(te){return n.saveGoal(te.id,te)},deleteGoalQueryConnection:function(te,ue){return n.deleteGoalQueryConnection(te,ue)},getRefreshHistory:function(te){return n.getRefreshHistory(te)},refreshGoalValue:function(te,ue){return n.refreshGoalValue(te,ue)},isEditMode$:n.isEditMode(),columnSettings$:n.getColumnSettings(),saveStatusRules:function(te,ue){return n.saveStatusRules(te,ue)},getStatusRules:function(te){return n.getStatusRules(te)},updateGoalValueConnectionSettings:function(te,ue){return n.updateGoalValueConnectionSettings(te,ue)},takeOverConnection:function(te,ue){return n.takeOverGoalQueryConnection(te,ue)},toggleShowGoalTargets:function(te){return n.toggleShowGoalTargetsInChart(te)},followGoal:function(te){return n.followGoal(te)},unfollowGoal:function(te){return n.unfollowGoal(te)}}}})},o.prototype.openGoalStatusRulesPane=function(n,t,i,a){var l=this;this.sideFlyoutService.show({componentManifest:{componentId:"StatusRulesPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goal:t,goalStatuses:n,statusRules:i,close:function(){return l.sideFlyoutService.hide()},saveStatusRules:function(p){return(0,M.__awaiter)(l,void 0,void 0,function(){return(0,M.__generator)(this,function(y){switch(y.label){case 0:return[4,a(p)];case 1:return y.sent(),this.sideFlyoutService.hide(),[2]}})})}}}})},o.prototype.openEditStatusesPane=function(n,t,i){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"EditStatusesPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goalStatuses$:n.getScorecard().pipe((0,dt.U)(function(l){return l.goalStatuses}),(0,G.x)()),onSave:t,close:function(){return a.sideFlyoutService.hide()},isReadOnly:i}}})},o.prototype.openScorecardSettingsPane=function(n,t,i){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"ScorecardSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecard$:n.getScorecard(),roles$:n.getScorecard().pipe((0,ci.b)(function(l){n.ensureRolesLoaded()}),(0,dt.U)(function(l){return l.roles}),go(1),(0,fo.x)()),scorecardSettingsPaneTabIndex:i,onSave:t,close:function(){return a.sideFlyoutService.hide()},setAsDefaultRole:function(c){return n.setAsDefaultRole(c)},editRole:function(c){return a.openRoleSettingsPane(n,!1,c)},deleteRole:function(c){return n.deleteRole(c)},openRoleSettingsPaneWithNewRole:function(){return a.openRoleSettingsPane(n,!0)}}}})},o.prototype.openScorecardColumnSettingsPane=function(n){var t=this;this.sideFlyoutService.show({componentManifest:{componentId:"ScorecardColumnSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecardService:n,close:function(){return t.sideFlyoutService.hide()}}}})},o.prototype.openCategoryListsEditPane=function(n,t,i){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"CategoryListsEditPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecardService:n,creatingNewList:t,applyChanges:i,close:function(){return a.sideFlyoutService.hide()}}}})},o.prototype.openCategoricalValuesEditPane=function(n){this.sideFlyoutService.show({componentManifest:{componentId:"CategoricalValuesEditPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goalValueCategoryListsService:n}}})},o.prototype.openRoleSettingsPane=function(n,t,i){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"RoleSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecard$:n.getScorecard(),goals$:n.getGoals(),roles$:n.getScorecard().pipe((0,ci.b)(function(l){n.ensureRolesLoaded()}),(0,dt.U)(function(l){return l.roles})),close:function(){return a.sideFlyoutService.hide()},cancel:function(){return a.openScorecardSettingsPane(n,function(c){return n.updateScorecard(c)},1)},createRole:function(c){return n.createRole(c)},updateRole:function(c,p){return n.updateRole(c,p)},setAsDefaultRole:function(c){return n.setAsDefaultRole(c)},deleteRole:function(c){return n.deleteRole(c)},addNewRole:t,selectedRoleId:i}},paneClass:"role-settings"})},o.prototype.openBulkEditingPane=function(n,t){var i=this,a=n.getGoalStatuses(),l=n.getGoalValueCategoryLists();this.sideFlyoutService.show({componentManifest:{componentId:"BulkEditingPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{selectedGoalIds$:n.getSelectedGoalIdsObservable(),selectedGoals$:n.getSelectedGoalsObservable(),goalStatuses:a,goalValueCategories:l,onSave:t,close:function(){return i.sideFlyoutService.hide()}}}})},o.prototype.closeGoalDetails=function(){this.destroy$&&(this.destroy$.next(!0),this.destroy$.complete()),this.sideFlyoutService.hide()},o.prototype.traverse=function(n,t){var i=this;return n.pipe((0,ct.zg)(function(a){return a.parentId?i.traverse(t.getGoal(a.parentId),t):(0,me.of)(a.id)}))},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(mo.p),e.\u0275\u0275inject(en,8),e.\u0275\u0275inject(Jn,8))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Kr=m(50057),Ei=m(57746),Jt=m(55710),$o=function(n,t,i){return{hide:n,rotate180:t,"reserve-space":i}},Ti=function(){function o(){this.reserveSpaceWhenHidden=!0}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["sort-icon"]],inputs:{hidden:"hidden",upArrow:"upArrow",reserveSpaceWhenHidden:"reserveSpaceWhenHidden"},decls:1,vars:5,consts:[["fontIcon","pbi-glyph-sortup",1,"glyphicon","glyph-mini","sort-icon",3,"ngClass"]],template:function(t,i){1&t&&e.\u0275\u0275element(0,"mat-icon",0),2&t&&e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(1,$o,i.hidden,i.upArrow,i.reserveSpaceWhenHidden))},dependencies:[F.NgClass,vn.Hw],styles:[".sort-icon[_ngcontent-%COMP%]{height:12px;width:12px;margin-left:12px}.sort-icon.rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.sort-icon.hide[_ngcontent-%COMP%]{display:none}.sort-icon.hide.reserve-space[_ngcontent-%COMP%]{display:inline;visibility:hidden}"],changeDetection:0}),o}();function Qo(o,n){if(1&o&&e.\u0275\u0275element(0,"sort-icon",24),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("upArrow",!t.sortType.sortAscending)}}function Ko(o,n){1&o&&e.\u0275\u0275element(0,"pbi-icon",25)}function xi(o,n){1&o&&e.\u0275\u0275element(0,"span",26)}function Xo(o,n){1&o&&e.\u0275\u0275element(0,"span",27)}function Ii(o,n){1&o&&e.\u0275\u0275element(0,"span",28)}function Di(o,n){1&o&&e.\u0275\u0275element(0,"span",29)}function ui(o,n){1&o&&e.\u0275\u0275element(0,"span")}function Zo(o,n){1&o&&e.\u0275\u0275element(0,"span",30)}function ur(o,n){1&o&&e.\u0275\u0275element(0,"span",31)}function Yo(o,n){1&o&&e.\u0275\u0275element(0,"span",32)}function Jo(o,n){1&o&&e.\u0275\u0275element(0,"span",33)}function ea(o,n){1&o&&e.\u0275\u0275element(0,"span")}function di(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"button",34),e.\u0275\u0275element(1,"span",35)(2,"pbi-icon",36),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(27);e.\u0275\u0275property("matMenuTriggerFor",t)}}function vo(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeColumnSettings(l.moveColumnLeft,a))}),e.\u0275\u0275element(1,"span",38),e.\u0275\u0275elementEnd()}}function ta(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeColumnSettings(l.moveColumnRight,a))}),e.\u0275\u0275element(1,"span",39),e.\u0275\u0275elementEnd()}}function na(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeColumnSettings(l.hideColumn,a))}),e.\u0275\u0275element(1,"span",40),e.\u0275\u0275elementEnd()}}function ra(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function _o(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",41),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.showHideColumns())}),e.\u0275\u0275element(1,"span",42),e.\u0275\u0275elementEnd()}}var pi=function(n){return{hidden:n}};function ia(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,Qo,1,1,"sort-icon",3),e.\u0275\u0275template(6,Ko,1,0,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-menu",5,6)(10,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var A=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(A.sort(!0))}),e.\u0275\u0275element(11,"pbi-icon",8),e.\u0275\u0275template(12,xi,1,0,"span",9),e.\u0275\u0275template(13,Xo,1,0,"span",10),e.\u0275\u0275template(14,Ii,1,0,"span",11),e.\u0275\u0275template(15,Di,1,0,"span",12),e.\u0275\u0275template(16,ui,1,0,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var A=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(A.sort(!1))}),e.\u0275\u0275element(18,"pbi-icon",8),e.\u0275\u0275template(19,Zo,1,0,"span",14),e.\u0275\u0275template(20,ur,1,0,"span",15),e.\u0275\u0275template(21,Yo,1,0,"span",16),e.\u0275\u0275template(22,Jo,1,0,"span",17),e.\u0275\u0275template(23,ea,1,0,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"mat-divider"),e.\u0275\u0275template(25,di,3,1,"button",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"mat-menu",19,20),e.\u0275\u0275template(28,vo,2,0,"button",21),e.\u0275\u0275template(29,ta,2,0,"button",21),e.\u0275\u0275template(30,na,2,0,"button",21),e.\u0275\u0275element(31,"mat-divider"),e.\u0275\u0275template(32,ra,1,0,"ng-container",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(33,_o,2,0,"ng-template",null,23,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=n.ngIf,a=e.\u0275\u0275reference(7),l=e.\u0275\u0275reference(9),c=e.\u0275\u0275reference(27),p=e.\u0275\u0275reference(34),y=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",y.column.canSort?l:c),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,26,y.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("localize",y.column.name),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(4,28,y.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",y.column.canSort&&y.sortType.sortBy===y.column.sortBy)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitch",y.column.dataType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(30,pi,y.sortType.sortBy!==y.column.sortBy||!y.sortType.sortAscending)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","String"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Status"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitch",y.column.dataType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(32,pi,y.sortType.sortBy!==y.column.sortBy||y.sortType.sortAscending)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","String"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Status"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",y.canMoveLeft(i)||y.canMoveRight(i)||y.column.canHide)("ngIfElse",p),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",y.canMoveLeft(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",y.canMoveRight(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",y.column.canHide),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",p)}}var hi=function(){function o(n,t){var i=this;this.detailsPaneLauncher=n,this.scorecardService=t,this.onSortColumn=new e.EventEmitter,this.moveColumnLeft=function(a){ae.moveColumnLeft(a,i.column.id)},this.moveColumnRight=function(a){ae.moveColumnRight(a,i.column.id)},this.hideColumn=function(a){ae.hideColumn(a,i.column.id)}}return o.prototype.ngOnInit=function(){this.columnSettings$=this.scorecardService.getColumnSettings()},o.prototype.showHideColumns=function(){this.detailsPaneLauncher.openScorecardColumnSettingsPane(this.scorecardService)},o.prototype.changeColumnSettings=function(n,t){u.fF.assertValue(t,"columnSettingsAction columnSettings");var i=_.cloneDeep(t);n(i),this.scorecardService.updateScorecard({columnSettings:i})},o.prototype.canMoveLeft=function(n){return ae.canMoveLeft(n,this.columnIndex)},o.prototype.canMoveRight=function(n){return ae.canMoveRight(n,this.columnIndex)},o.prototype.sort=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,M.__generator)(this,function(i){return u.fF.assert(function(){return t.column.canSort},"Cannot sort this column."),this.onSortColumn.emit(this.sortType.sortBy!==this.column.sortBy||this.sortType.sortAscending!==n?{sortBy:this.column.sortBy,sortAscending:n}:ne.Ij),[2]})})},o.componentId="ScorecardColumnContextMenuComponentId",o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-column-context-menu"]],inputs:{column:"column",columnIndex:"columnIndex",sortType:"sortType"},outputs:{onSortColumn:"onSortColumn"},decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","cdkMonitorElementFocus","",1,"scorecard-column-menu-trigger",3,"matMenuTriggerFor"],[1,"column-name",3,"localize","pbiTooltip"],["class","sort-icon",3,"upArrow",4,"ngIf","ngIfElse"],["chevron",""],["xPosition","after",1,"scorecard-column-menu",3,"overlapTrigger"],["scorecardColumnMenu","matMenu"],["mat-menu-item","",3,"ngSwitch","click"],["size","small","name","checkmark",3,"ngClass"],["localize","Menu_OldestToNewest",4,"ngSwitchCase"],["localize","Menu_Ascending",4,"ngSwitchCase"],["localize","Menu_Sort_AZ",4,"ngSwitchCase"],["localize","Menu_Sort_FromLowPriority",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["localize","Menu_NewestToOldest",4,"ngSwitchCase"],["localize","Menu_Descending",4,"ngSwitchCase"],["localize","Menu_Sort_ZA",4,"ngSwitchCase"],["localize","Menu_Sort_FromHighPriority",4,"ngSwitchCase"],["mat-menu-item","","class","customize-column-button","localizeTooltip","Scorecard_Column_Settings_CustomizeColumn",3,"matMenuTriggerFor",4,"ngIf","ngIfElse"],[1,"scorecard-column-settings-menu",3,"overlapTrigger"],["scorecardColumnSettingsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngTemplateOutlet"],["columnSettingsButton",""],[1,"sort-icon",3,"upArrow"],["name","chevrondownsmall","size","small",1,"chevrondown"],["localize","Menu_OldestToNewest"],["localize","Menu_Ascending"],["localize","Menu_Sort_AZ"],["localize","Menu_Sort_FromLowPriority"],["localize","Menu_NewestToOldest"],["localize","Menu_Descending"],["localize","Menu_Sort_ZA"],["localize","Menu_Sort_FromHighPriority"],["mat-menu-item","","localizeTooltip","Scorecard_Column_Settings_CustomizeColumn",1,"customize-column-button",3,"matMenuTriggerFor"],["localize","Scorecard_Column_Settings_CustomizeColumn"],["name","chevronrightmedium","size","mini",1,"chevron-right"],["mat-menu-item","",3,"click"],["localize","Menu_MoveLeft","localizeTooltip","Menu_MoveLeft"],["localize","Menu_MoveRight","localizeTooltip","Menu_MoveRight"],["localize","Menu_HideThisColumn","localizeTooltip","Menu_HideThisColumn"],["mat-menu-item","",1,"column-settings-button",3,"click"],["localize","Scorecard_Column_Settings","localizeTooltip","Scorecard_Column_Settings"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,ia,35,34,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.columnSettings$))},dependencies:[F.NgClass,F.NgIf,F.NgTemplateOutlet,F.NgSwitch,F.NgSwitchCase,F.NgSwitchDefault,Sn.X,Kr.r,Ei.d,Jt.W0,Jt.tN,Jt.D8,Dn._,oe.V,Ti,F.AsyncPipe,Bt.F],styles:[".scorecard-column-menu-trigger[_ngcontent-%COMP%]{padding-left:0;width:100%;border:none;background:none;color:inherit;display:flex;flex-direction:row}.scorecard-column-menu-trigger[_ngcontent-%COMP%]   .column-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.scorecard-column-menu-trigger[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}  .scorecard-column-menu-trigger .sort-icon .mat-icon{margin:0 4px}  .mat-menu-panel.scorecard-column-settings-menu{min-height:fit-content}  .scorecard-column-menu .mat-menu-item{padding-left:8px}  .scorecard-column-menu .mat-menu-item.column-settings-button{padding-left:32px}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}.mat-menu-item[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex;padding-right:8px}.mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}.mat-menu-item.customize-column-button[_ngcontent-%COMP%]{justify-content:space-between;padding-left:32px}.mat-menu-item.customize-column-button[_ngcontent-%COMP%]   .chevron-right[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}"],changeDetection:0}),o}();function oa(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",2)(2,"scorecard-column-context-menu",3),e.\u0275\u0275listener("onSortColumn",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.sortColumn(l))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("column",i.column)("columnIndex",i.index)("sortType",i.sort)}}function gi(o,n){if(1&o&&e.\u0275\u0275element(0,"sort-icon",7),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("reserveSpaceWhenHidden",t.reserveSpaceForSortIcon)("hidden",t.sort.sortBy!==t.column.sortBy)("upArrow",!t.sort.sortAscending)}}function fi(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",4),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.toggleSort(l.sort,l.column.sortBy))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"span",5),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,gi,1,3,"sort-icon",6),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("sort-col",i.column.canSort),e.\u0275\u0275attributeInterpolate2("aria-label","",e.\u0275\u0275pipeBind1(1,7,i.column.name)," ",e.\u0275\u0275pipeBind1(2,9,"Sort"),""),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("localize",i.column.name),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(4,11,i.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.column.canSort)}}var Xr=function(){function o(){this.onSortColumn=new e.EventEmitter,this.reserveSpaceForSortIcon=!0}return o.prototype.sortColumn=function(n){this.onSortColumn.emit(n)},o.prototype.toggleSort=function(n,t){var i=K.toggleSort(n,t);this.onSortColumn.emit(i)},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-column-header"]],inputs:{column:"column",index:"index",sort:"sort",isEditMode:"isEditMode",reserveSpaceForSortIcon:"reserveSpaceForSortIcon"},outputs:{onSortColumn:"onSortColumn"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["columnNameWithSortIcon",""],[1,"column-menu-sort"],[1,"scorecard-column-context-menu",3,"column","columnIndex","sortType","onSortColumn"],[1,"column-sort",3,"click"],[1,"column-name",3,"localize","pbiTooltip"],[3,"reserveSpaceWhenHidden","hidden","upArrow",4,"ngIf"],[3,"reserveSpaceWhenHidden","hidden","upArrow"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,oa,3,3,"ng-container",0),e.\u0275\u0275template(1,fi,6,13,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",i.isEditMode)("ngIfElse",a)}},dependencies:[F.NgIf,Sn.X,oe.V,hi,Ti,Bt.F],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .column-sort[_ngcontent-%COMP%]{padding-left:0;width:100%;border:none;background:none;color:inherit;display:flex;flex-direction:row;align-items:center;cursor:default}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]     sort-icon mat-icon.sort-icon{font-weight:var(--font-weight-semi-bold)}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:hover     sort-icon mat-icon.sort-icon.hide{display:inline;visibility:visible;color:var(--fluent-theme-neutral-tertia-color)}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   .column-sort[_ngcontent-%COMP%]   .column-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]   .scorecard-column-context-menu[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]     sort-icon mat-icon.sort-icon.hide{color:transparent}"],changeDetection:0}),o}(),ki=m(68233),qt=(0,M.__assign)((0,M.__assign)({},ki._),{Default:0,XXXXMidLarge:1736}),Zr=(0,M.__spreadArray)([],Object.values(qt).sort(function(o,n){return n-o}),!0);function Ar(o,n){for(var t=0,i=Zr;t<i.length;t++){var a=i[t];if(!_.isNil(o[a])&&n>=a)return o[a]}return o[qt.Default]}var Bn,Qn,br,Yr,mi,s,h,b,w,C,P,z,q,j,B,N=((Bn={})[0]=((Qn={})[qt.XXXXXLarge]=584,Qn[qt.XXXXMidLarge]=562,Qn[qt.XXXXLarge]=516,Qn[qt.XXLarge]=438,Qn[qt.XLarge]=298,Qn[qt.Large]=292,Qn[qt.Medium]=258,Qn[qt.Default]=184,Qn),Bn[1]=((br={})[qt.XXXXLarge]=98,br[qt.XXLarge]=74,br[qt.Default]=40,br),Bn[2]=((Yr={})[qt.Default]=76,Yr),Bn[3]=((mi={})[qt.Default]=128,mi),Bn[10]=((s={})[qt.Default]=106,s),Bn[7]=((h={})[qt.Default]=64,h),Bn[8]=((b={})[qt.Default]=64,b),Bn[9]=((w={})[qt.Default]=64,w),Bn[4]=((C={})[qt.XXXXXLarge]=156,C[qt.XXXXLarge]=132,C[qt.XXLarge]=100,C[qt.Default]=60,C),Bn[5]=((P={})[qt.Default]=62,P),Bn[6]={},Bn),ie=((z={})[qt.XXXXXLarge]=32,z[qt.XXLarge]=24,z[qt.Default]=16,z),ce=((q={})[qt.XXXXXLarge]=80,q[qt.XXXXMidLarge]=58,q[qt.XXXXLarge]=48,q[qt.XXLarge]=30,q[qt.XLarge]=26,q[qt.Default]=20,q),Xe=((j={})[qt.XXXXLarge]={avatarRowSize:"medium",avatarRowCount:4},j[qt.XXLarge]={avatarRowSize:"small",avatarRowCount:4},j[qt.Default]={avatarRowSize:"small",avatarRowCount:2},j),Nt=((B={})[qt.XXLarge]=!0,B[qt.Default]=!1,B),Ze=m(21661),ge=m(94585),et=m(15015),pt=m(22318),Qe=function(){function o(){this.columnResized=new e.EventEmitter}return o.prototype.onMouseDown=function(n){return this.isResizing=!0,this.pageX=n.pageX,this.initialWidth=n.target.parentElement.offsetWidth,document.body.style.cursor="col-resize",n.stopPropagation(),!1},o.prototype.onDragStart=function(){return!1},o.prototype.onMouseMove=function(n){return!this.isResizing||(this.columnResized.emit(Math.max(0,this.initialWidth+n.pageX-this.pageX)),n.stopPropagation(),!1)},o.prototype.onMouseLeave=function(n){return!this.isResizing||(this.isResizing=!1,document.body.style.cursor="",n.stopPropagation(),!1)},o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.\u0275\u0275defineDirective({type:o,selectors:[["","resize-column",""]],hostBindings:function(t,i){1&t&&e.\u0275\u0275listener("mousedown",function(l){return i.onMouseDown(l)})("touchstart",function(l){return i.onMouseDown(l)})("dragstart",function(){return i.onDragStart()})("mousemove",function(l){return i.onMouseMove(l)},!1,e.\u0275\u0275resolveWindow)("touchmove",function(l){return i.onMouseMove(l)},!1,e.\u0275\u0275resolveWindow)("mouseup",function(l){return i.onMouseLeave(l)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(l){return i.onMouseLeave(l)},!1,e.\u0275\u0275resolveWindow)("touchend",function(l){return i.onMouseLeave(l)},!1,e.\u0275\u0275resolveWindow)},outputs:{columnResized:"columnResized"}}),o}(),Ut=["headers"];function Yt(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",14),e.\u0275\u0275listener("click",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onToggleExpandAll(l))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",15),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("expanded",i.showAllExpanded),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,i.showAllExpanded?"FieldListMenuItem_CollapseAll":"FieldListMenuItem_ExpandAll"))}}function Gn(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,Yt,3,5,"button",13),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2),i=e.\u0275\u0275reference(9);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,t.canExpandAll$))("ngIfElse",i)}}var En=function(n){return{column:n}};function Co(o,n){if(1&o&&e.\u0275\u0275elementContainer(0,16),2&o){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,En,t))}}function aa(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.name)}}function Ua(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",18),e.\u0275\u0275listener("columnResized",function(a){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext().index,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onColumnResized(a,l))}),e.\u0275\u0275elementEnd()}}function Vs(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,Gn,3,4,"div",9),e.\u0275\u0275template(2,Co,1,4,"ng-container",10),e.\u0275\u0275template(3,aa,2,1,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,Ua,1,0,"div",12),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit,i=n.index,a=e.\u0275\u0275reference(4),l=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.width,"px"),e.\u0275\u0275classProp("sticky-left",l.stickyFirstColumn&&0===i),e.\u0275\u0275property("ngClass",t.class)("ngStyle",t.style),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===i),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.headerTemplate)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!1!==t.resizable)}}function Fs(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function As(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("dblclick",function(c){return c.stopPropagation()})("click",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3).$implicit,y=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(y.onExpandNode(p,c))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3).$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("expanded",a.treeControl.isExpanded(i))}}function Rs(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",22),e.\u0275\u0275template(2,As,1,2,"button",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(2).$implicit,i=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(9);e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkTreeNodePaddingIndent",i.paddingIndent),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.expandable)("ngIfElse",a)}}var Ls=function(n,t){return{column:n,data:t}};function Gs(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275template(1,Rs,3,3,"ng-container",9),e.\u0275\u0275elementContainer(2,16),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit,i=n.index,a=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.width,"px"),e.\u0275\u0275classProp("sticky-left",l.stickyFirstColumn&&0===i),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===i),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t.cellTemplate)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(7,Ls,t,a))}}function Ns(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cdk-tree-node",19),e.\u0275\u0275listener("click",function(c){var y=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(y.onClick?y.onClick(c):void 0)}),e.\u0275\u0275template(1,Gs,3,10,"div",20),e.\u0275\u0275elementEnd()}if(2&o){var i=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(i.style),e.\u0275\u0275classMap(i.class),e.\u0275\u0275styleProp("height",a.rowHeight,"px")("margin-bottom",a.rowSpacing,"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.columns)("ngForTrackBy",a.trackByColumn)}}function Hs(o,n){1&o&&e.\u0275\u0275element(0,"div",25)}var sa=function(){function o(){var n=this;this.minBufferPx=400,this.maxBufferPx=1e3,this.enableRowVirtualization=!0,this.onResizeTreeList=new e.EventEmitter,this.onResizeColumn=new e.EventEmitter,this.onExpansionChange=new e.EventEmitter,this.columns=[],this.expandedNodeIds=[],this.rowHeight=50,this.rowSpacing=10,this.paddingIndent=15,this.getChildren=function(t){return t.children},this.rowHash=function(t,i){return i.id},this.treeControl=new ge.C2(function(t){return t.level},function(t){return t.expandable},{trackBy:function(i){return i.id}}),this.nodeFlatMapper=function(t,i){return(0,M.__assign)((0,M.__assign)({},t),{level:i,expandable:_.size(n.getChildren(t))>0})}}return o.prototype.ngAfterViewInit=function(){var n,t=this;this.treeFlattener=new et.JZ(this.nodeFlatMapper,function(i){return i.level},function(i){return i.expandable},this.getChildren),this.dataSource=new et.kc(this.treeControl,this.treeFlattener),this.allRows$=this.dataSource.connect(this.cdkTree).pipe((0,dr.d)(1)),this.visibleItems$=this.allRows$.pipe((0,Rn.w)(function(i){return t.enableRowVirtualization?t.viewport.renderedRangeStream.pipe((0,pt.O)(t.viewport.getRenderedRange()),(0,dt.U)(function(a){return i.slice(a.start,a.end)})):(0,me.of)(i)})),this.dataSource.data=this.data,(n=this.treeControl.expansionModel).select.apply(n,this.expandedNodeIds),this.setShowExpandAll(),this.canExpandAll$=this.allRows$.pipe((0,dt.U)(function(i){return _.some(i,function(a){return a.expandable})})),this.expansionSub=this.treeControl.expansionModel.changed.subscribe(function(i){t.setShowExpandAll(),t.onExpansionChange.emit(i)})},o.prototype.ngOnChanges=function(n){n.data&&this.dataSource&&(this.dataSource.data=this.data,this.setShowExpandAll()),(n.rowHeight||n.rowSpacing)&&(this.totalRowHeight=this.rowHeight+this.rowSpacing)},o.prototype.ngOnDestroy=function(){var n;null===(n=this.expansionSub)||void 0===n||n.unsubscribe()},o.prototype.onExpandNode=function(n,t){this.treeControl.toggle(n),t.stopPropagation()},o.prototype.onToggleExpandAll=function(){var n;this.showAllExpanded?this.treeControl.collapseAll():(n=this.treeControl.expansionModel).select.apply(n,this.getExpandableNodeIds())},o.prototype.trackByColumn=function(n,t){return t.key},o.prototype.trackById=function(n,t){return t.id},o.prototype.scroll=function(){this.headers.nativeElement.scrollLeft=this.viewport.measureScrollOffset("left")},o.prototype.onTreeListResized=function(n){var t=this;requestAnimationFrame(function(){t.onResizeTreeList.emit(n)})},o.prototype.onColumnResized=function(n,t){var i=this;requestAnimationFrame(function(){i.onResizeColumn.emit({column:t,width:Math.max(60,n)})})},o.prototype.setShowExpandAll=function(){var n=this,t=_.filter(this.treeControl.dataNodes,function(a){return a.expandable&&n.treeControl.isExpanded(a)}).length,i=this.getExpandableNodeIds().length;0===t?this.showAllExpanded=!1:t===i&&(this.showAllExpanded=!0)},o.prototype.getExpandableNodeIds=function(){return _.map(_.filter(this.treeControl.dataNodes,function(n){return n.expandable}),function(n){return n.id})},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["tree-list"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(ge._0,7),e.\u0275\u0275viewQuery(Ze.N7,7),e.\u0275\u0275viewQuery(Ut,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.cdkTree=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.viewport=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.headers=a.first)}},inputs:{columns:"columns",data:"data",expandedNodeIds:"expandedNodeIds",rowHeight:"rowHeight",rowSpacing:"rowSpacing",paddingIndent:"paddingIndent",getChildren:"getChildren",rowHash:"rowHash",stickyFirstColumn:"stickyFirstColumn"},outputs:{onResizeTreeList:"onResizeTreeList",onResizeColumn:"onResizeColumn",onExpansionChange:"onExpansionChange"},features:[e.\u0275\u0275NgOnChangesFeature],decls:10,vars:12,consts:[[1,"column-headers"],["headers",""],["class","header",3,"ngClass","ngStyle","sticky-left","width",4,"ngFor","ngForOf","ngForTrackBy"],["tabindex","-1",3,"itemSize","minBufferPx","maxBufferPx","scroll","on-resize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[3,"dataSource","treeControl","trackBy"],["class","row",3,"class","style","height","margin-bottom","click",4,"cdkTreeNodeDef"],["expanderPlaceholder",""],[1,"header",3,"ngClass","ngStyle"],[4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["name",""],["class","resize-handle","resize-column","",3,"columnResized",4,"ngIf"],["tabindex","-1","class","expander expander-all",3,"pbiTooltip","expanded","click",4,"ngIf","ngIfElse"],["tabindex","-1",1,"expander","expander-all",3,"pbiTooltip","click"],["fontIcon","pbi-glyph-doublechevrondown",1,"glyphicon","glyph-mini"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"name"],["resize-column","",1,"resize-handle",3,"columnResized"],[1,"row",3,"click"],["class","cell","role","cell",3,"sticky-left","width",4,"ngFor","ngForOf","ngForTrackBy"],["role","cell",1,"cell"],["cdkTreeNodePadding","",1,"tree-node-padding",3,"cdkTreeNodePaddingIndent"],["tabindex","-1","class","glyphicon expander",3,"expanded","dblclick","click",4,"ngIf","ngIfElse"],["tabindex","-1",1,"glyphicon","expander",3,"dblclick","click"],[1,"expander-placeholder"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275template(2,Vs,6,10,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"cdk-virtual-scroll-viewport",3),e.\u0275\u0275listener("scroll",function(){return i.scroll()})("on-resize",function(l){return i.onTreeListResized(l)}),e.\u0275\u0275template(4,Fs,1,0,"ng-container",4),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementStart(6,"cdk-tree",5),e.\u0275\u0275template(7,Ns,2,10,"cdk-tree-node",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(8,Hs,1,0,"ng-template",null,7,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.columns)("ngForTrackBy",i.trackByColumn),e.\u0275\u0275advance(1),e.\u0275\u0275property("itemSize",i.totalRowHeight)("minBufferPx",i.minBufferPx)("maxBufferPx",i.maxBufferPx),e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkVirtualForOf",e.\u0275\u0275pipeBind1(5,10,i.allRows$))("cdkVirtualForTrackBy",i.trackById),e.\u0275\u0275advance(2),e.\u0275\u0275property("dataSource",i.visibleItems$)("treeControl",i.treeControl)("trackBy",i.rowHash))},dependencies:[F.NgClass,F.NgForOf,F.NgIf,F.NgTemplateOutlet,F.NgStyle,ge.rO,ge.XJ,ge._0,ge.Hs,Hr.O,vn.Hw,oe.V,Ze.xd,Ze.x0,Ze.N7,Qe,F.AsyncPipe,Bt.F],styles:['[_nghost-%COMP%]{--headerHeight: 40px;--expanderWidth: 48px;--column-headers-backgroundColor: var(--fluent-theme-white-color);--column-headers-foregroundColor: var(--fluent-theme-neutral-primary-color);--row-backgroundColor: var(--fluent-theme-white-color);--row-foregroundColor: var(--fluent-theme-neutral-primary-color);display:flex;flex-direction:column}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{flex:1;width:100%;max-width:100%;display:block}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]:focus{outline:none}cdk-tree-node[_ngcontent-%COMP%]{display:block}.column-headers[_ngcontent-%COMP%]{margin:0;display:flex;padding:8px 0;height:var(--headerHeight);box-sizing:border-box;align-items:center;background-color:var(--column-headers-backgroundColor);color:var(--column-headers-foregroundColor);width:100%;overflow:hidden;z-index:2}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);font-weight:550;position:relative;border-right:solid 1px var(--gray-70, #BEBBB8);box-sizing:border-box;display:flex;flex-grow:0;flex-shrink:0;overflow:hidden}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;opacity:0;width:10px;cursor:col-resize}.sticky-left[_ngcontent-%COMP%]{position:sticky!important;left:0;z-index:1!important}.sticky-left.cell[_ngcontent-%COMP%]{background-color:var(--row-backgroundColor)}.sticky-left.header[_ngcontent-%COMP%]{background-color:var(--column-headers-backgroundColor)}.row[_ngcontent-%COMP%], .cell[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-grow:0;flex-shrink:0;z-index:0;box-sizing:border-box}.row[_ngcontent-%COMP%]{background-color:var(--row-backgroundColor);color:var(--row-foregroundColor);width:fit-content}.cell[_ngcontent-%COMP%]{overflow:hidden;height:100%}.tree-node-padding[_ngcontent-%COMP%]{height:100%}.expander-placeholder[_ngcontent-%COMP%]{width:var(--expanderWidth);flex-shrink:0}.expander[_ngcontent-%COMP%]{color:var(--gray-180, #252423);transition:transform ease .15s;transform:rotate(-90deg);font-size:var(--sm-font-size, 12px);width:var(--expanderWidth);padding:0 16px;background:transparent;outline:none;display:inline-flex;align-items:center;justify-content:center;height:100%;border:none}.expander.glyphicon[_ngcontent-%COMP%]:before{content:"\\e70d"}.expander.expanded[_ngcontent-%COMP%]{transform:none}.expander[_ngcontent-%COMP%]:focus, .expander[_ngcontent-%COMP%]:hover, .expander[_ngcontent-%COMP%]:focus:hover{background:transparent}.expander[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{padding:2px;font-size:12px;height:unset}'],changeDetection:0}),o}(),Bs=["columnHeader"],Us=["nameCell"],qs=["ownersCell"],Ws=["statusCell"],js=["combinedValueTargetCell"],$s=["changeCell"],Qs=["currentCell"],Ks=["targetCell"],Xs=["milestoneCell"],Zs=["sparklineCell"],Ys=["dueDateCell"],Js=["blank"],el=function(n,t){return{"--column-spacing":n,"--border-left-width":t}};function tl(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tree-list",12),e.\u0275\u0275listener("onResizeColumn",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeColumn(l))})("onExpansionChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onExpansionChange(l))})("onResizeTreeList",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeScorecard(l))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction2(12,el,i.columnSpacing+"px",i.colorBorderWidth+"px")),e.\u0275\u0275classProp("hidden",!i.scorecardWidth),e.\u0275\u0275property("columns",i.columns)("data",i.goals)("expandedNodeIds",i.expandedGoalIds)("getChildren",i.getSubgoals)("rowHash",i.rowHash)("rowHeight",i.rowHeight)("rowSpacing",i.rowSpacing)("paddingIndent",0)}}function nl(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-column-header",14),e.\u0275\u0275listener("onSortColumn",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.onSortColumn.emit(c))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext().column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("column",i)("index",i.index)("sort",a.sort)("isEditMode",a.isEditMode)("reserveSpaceForSortIcon",!1)}}function rl(o,n){if(1&o&&(e.\u0275\u0275template(0,nl,1,5,"scorecard-column-header",13),e.\u0275\u0275pipe(1,"async")),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(1,1,t.hideColumnHeaders$))}}function il(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275element(1,"goal-name-cell",16)(2,"div",17)(3,"goal-actions-cell",18),e.\u0275\u0275elementEnd()),2&o){var t=n.data,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t)("scorecard",i.scorecard)("boldName",0===t.level)("innerIndent",t.innerIndent*i.innerIndentSpacing),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("width",i.columnSpacing,"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t)("isEditMode",i.isEditMode)("showActionIcons",i.showActionIcons)}}function ol(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-owners-cell",19),2&o){var t=n.data,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("alwaysShowAvatarRow",!0)("rowStyle","stack")("avatarSize",i.avatarRowSize)("avatarRowCount",i.avatarRowCount)}}function al(o,n){1&o&&e.\u0275\u0275element(0,"goal-status-cell",20),2&o&&e.\u0275\u0275property("goal",n.data)}function sl(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-value-cell",21),2&o){var i,a,t=n.data;e.\u0275\u0275property("goal",t)("showCurrent",!0)("showTarget",null!==(i=null==t.metadata?null:t.metadata.showFinalTarget)&&void 0!==i?i:!t.targetConnection)("showMilestone",!(null!==(a=null==t.metadata?null:t.metadata.showFinalTarget)&&void 0!==a?a:!t.targetConnection))("compact",!0)}}function ll(o,n){1&o&&e.\u0275\u0275element(0,"goal-change-cell",20),2&o&&e.\u0275\u0275property("goal",n.data)}function cl(o,n){1&o&&e.\u0275\u0275element(0,"goal-value-cell",22),2&o&&e.\u0275\u0275property("goal",n.data)("showCurrent",!0)("compact",!0)}function ul(o,n){1&o&&e.\u0275\u0275element(0,"goal-value-cell",23),2&o&&e.\u0275\u0275property("goal",n.data)("showTarget",!0)("compact",!0)}function r(o,n){1&o&&e.\u0275\u0275element(0,"goal-value-cell",24),2&o&&e.\u0275\u0275property("goal",n.data)("showMilestone",!0)("compact",!0)}function d(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-sparkline-cell",25),2&o){var t=n.data,i=n.column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("height",a.rowHeight-10)("width",i.width-a.columnSpacing)}}function g(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-due-date-cell",26),2&o){var t=n.data,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("formatOptions",i.dateFormatOptions)}}var v=function(o){function n(t,i,a,l){var p,y,c=this;return(c=o.call(this)||this).goalRowService=t,c.expansionService=i,c.changeDetector=a,c.scorecardSettings=l,c.onSortColumn=new e.EventEmitter,c.getSubgoals=function(O){return c.getGoalNodes(O.subGoals,O)},c.rowHash=function(O,A){return JSON.stringify(A)},c.rowHeight=42,c.rowSpacing=0,c.dateFormatOptions={day:"numeric",month:"numeric",year:"2-digit"},c.colorBorderWidth=4,c.resizedColumns={},c.innerIndentSpacing=16,c.columnSpacing=20,c.showActionIcons=!1,c.avatarRowSize="smallest",c.avatarRowCount=2,c.hideColumnHeaders$=null===(y=null===(p=c.scorecardSettings)||void 0===p?void 0:p.settings)||void 0===y?void 0:y.pipe((0,dt.U)(function(O){return O?.hideColumnHeaders})),c}return(0,M.__extends)(n,o),n.prototype.ngAfterViewInit=function(){var t;this.columnTemplates=((t={})[0]=this.nameCell,t[1]=this.ownersCell,t[2]=this.statusCell,t[3]=this.combinedValueTargetCell,t[10]=this.changeCell,t[7]=this.currentCell,t[4]=this.sparklineCell,t[8]=this.targetCell,t[9]=this.milestoneCell,t[5]=this.dueDateCell,t[6]=null,t)},n.prototype.ngOnChanges=function(t){t.scorecard&&(this.goals=this.getGoalNodes(this.scorecard.goals),this.expandedGoalIds=this.expansionService.expandedGoalIds),(t.scorecard||t.viewSettings)&&this.columnTemplates&&this.recalculateColumnLayout(),o.prototype.ngOnChanges.call(this,t)},n.prototype.onGoalRowClick=function(t,i){this.goalRowService.onRowClick(t,i)},n.prototype.onExpansionChange=function(t){this.expansionService.expandGoals(t.added),this.expansionService.collapseGoals(t.removed)},n.prototype.onResizeScorecard=function(t){this.scorecardWidth=t.width,this.recalculateColumnLayout(),this.changeDetector.markForCheck()},n.prototype.onResizeColumn=function(t){var i=t.width,a=t.column;this.columns[a]&&(this.columns[a].width=i,this.resizedColumns[this.columns[a].id]=i-this.columnSpacing,this.recalculateColumnLayout(),this.changeDetector.markForCheck())},n.prototype.recalculateColumnLayout=function(){this.effectiveBreakpoint=this.getEffectiveBreakpoint(this.scorecardWidth);var t=this.calculateCutoffIndex(),i=this.calculateTotalWidth(this.effectiveBreakpoint,t);this.columns=this.getColumns(t,i),this.setResponsiveSettings()},n.prototype.getEffectiveBreakpoint=function(t){for(var i=0,a=Zr;i<a.length;i++){var l=a[i];if(this.calculateTotalWidth(l)<t)return l}return qt.Default},n.prototype.calculateCutoffIndex=function(){var t,i=this.scorecard.columnSettings.length;if(null!==(t=this.viewSettings)&&void 0!==t&&t.dropColumns&&this.effectiveBreakpoint===qt.Default)for(var a=this.colorBorderWidth,l=0;l<this.scorecard.columnSettings.length;l++)if(this.scorecard.columnSettings[l].show&&(a+=this.getBaseColumnWidth(this.scorecard.columnSettings[l].columnId,this.effectiveBreakpoint))>this.scorecardWidth){i=l||1;break}return i},n.prototype.calculateTotalWidth=function(t,i){var l,a=this;return this.colorBorderWidth+_.sumBy(_.filter(null===(l=this.scorecard)||void 0===l?void 0:l.columnSettings.slice(0,i),function(c){return c.show}),function(c){return a.getBaseColumnWidth(c.columnId,t)})},n.prototype.getBaseColumnWidth=function(t,i){var a;return(null!==(a=this.resizedColumns[t])&&void 0!==a?a:Ar(N[t],i))+Ar(ce,i)},n.prototype.getColumns=function(t,i){var l,a=this,c=function(y){var O=a.getBaseColumnWidth(y,a.effectiveBreakpoint);return Math.max(Math.floor(O/i*a.scorecardWidth),O)};return _.map(_.filter(null===(l=this.scorecard)||void 0===l?void 0:l.columnSettings.slice(0,t),function(p){return p.show}),function(p,y){return(0,M.__assign)((0,M.__assign)({},ne.Ml[p.columnId]),{cellTemplate:a.columnTemplates[p.columnId],key:p.columnId.toString(),index:y,width:c(p.columnId),headerTemplate:a.columnHeader,resizable:!0})})},n.prototype.setResponsiveSettings=function(){var t=this;this.innerIndentSpacing=Ar(ie,this.effectiveBreakpoint),this.columnSpacing=Ar(ce,this.effectiveBreakpoint),this.columns&&this.columns.forEach(function(i){return t.updateSettingsForColumn(i)})},n.prototype.getSettingsForColumn=function(t,i){return function(o,n,t){for(var i=function(O){if(u.fF.assert(function(){return!(!_.isNil(o[O])&&_.isNil(n[O]))},"Associated settings at ".concat(O," have no matching breakpoint in base settings and will not be triggered.")),n[O]<=t&&!_.isNil(o[O]))return{value:o[O]}},a=0,l=Zr;a<l.length;a++){var p=i(l[a]);if("object"==typeof p)return p.value}return o[qt.Default]}(i,N[t.id],t.width-this.columnSpacing)},n.prototype.updateSettingsForColumn=function(t){var i;switch(t.id){case 0:this.showActionIcons=this.getSettingsForColumn(t,Nt);break;case 1:i=this.getSettingsForColumn(t,Xe),this.avatarRowSize=i.avatarRowSize,this.avatarRowCount=i.avatarRowCount}},n.prototype.getGoalNodes=function(t,i){var a=this;return _.map(_.filter(t,function(l){return!l.isNew&&!l.isHidden}),function(l,c){var p=i?i.level+1:0,y=i?i.color:ne.gT.ColorPalette[c%ne.gT.ColorPalette.length],O=a.goalRowService.isSelected(l),A=[!1===l.isFilterMatch?"goal-not-match":"",O?"selected-goal":""].join(" ");return(0,M.__assign)((0,M.__assign)({},l),{level:p,color:y,innerIndent:p,style:{"border-left-color":y,"border-color":O?y:""},class:A,onClick:function(te){return a.goalRowService.onRowClick(l,te)}})})},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(ni),e.\u0275\u0275directiveInject(Or),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(on,8))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["compact-scorecard"]],viewQuery:function(i,a){if(1&i&&(e.\u0275\u0275viewQuery(Bs,5),e.\u0275\u0275viewQuery(Us,5),e.\u0275\u0275viewQuery(qs,5),e.\u0275\u0275viewQuery(Ws,5),e.\u0275\u0275viewQuery(js,5),e.\u0275\u0275viewQuery($s,5),e.\u0275\u0275viewQuery(Qs,5),e.\u0275\u0275viewQuery(Ks,5),e.\u0275\u0275viewQuery(Xs,5),e.\u0275\u0275viewQuery(Zs,5),e.\u0275\u0275viewQuery(Ys,5),e.\u0275\u0275viewQuery(Js,5)),2&i){var l=void 0;e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.columnHeader=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.nameCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.ownersCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.statusCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.combinedValueTargetCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.changeCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.currentCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.targetCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.milestoneCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.sparklineCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.dueDateCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.blankCell=l.first)}},inputs:{scorecard:"scorecard",isEditMode:"isEditMode",viewSettings:"viewSettings",sort:"sort"},outputs:{onSortColumn:"onSortColumn"},features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275NgOnChangesFeature],decls:23,vars:1,consts:[[3,"style","hidden","columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","paddingIndent","onResizeColumn","onExpansionChange","onResizeTreeList",4,"ngIf"],["columnHeader",""],["nameCell",""],["ownersCell",""],["statusCell",""],["combinedValueTargetCell",""],["changeCell",""],["currentCell",""],["targetCell",""],["milestoneCell",""],["sparklineCell",""],["dueDateCell",""],[3,"columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","paddingIndent","onResizeColumn","onExpansionChange","onResizeTreeList"],[3,"column","index","sort","isEditMode","reserveSpaceForSortIcon","onSortColumn",4,"ngIf"],[3,"column","index","sort","isEditMode","reserveSpaceForSortIcon","onSortColumn"],[1,"displayed-name-and-action-wrapper","compact-cell"],[3,"goal","scorecard","boldName","innerIndent"],[1,"actions-spacer"],[3,"goal","isEditMode","showActionIcons"],[1,"compact-cell",3,"goal","alwaysShowAvatarRow","rowStyle","avatarSize","avatarRowCount"],[1,"compact-cell",3,"goal"],[1,"compact-cell",3,"goal","showCurrent","showTarget","showMilestone","compact"],[1,"compact-cell",3,"goal","showCurrent","compact"],[1,"compact-cell",3,"goal","showTarget","compact"],[1,"compact-cell",3,"goal","showMilestone","compact"],[1,"compact-cell",3,"goal","height","width"],[1,"compact-cell",3,"goal","formatOptions"]],template:function(i,a){1&i&&(e.\u0275\u0275template(0,tl,1,15,"tree-list",0),e.\u0275\u0275template(1,rl,2,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,il,4,9,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,ol,1,5,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,al,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(9,sl,1,5,"ng-template",null,5,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(11,ll,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(13,cl,1,3,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(15,ul,1,3,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(17,r,1,3,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(19,d,1,3,"ng-template",null,10,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(21,g,1,2,"ng-template",null,11,e.\u0275\u0275templateRefExtractor)),2&i&&e.\u0275\u0275property("ngIf",a.scorecard)},dependencies:[F.NgIf,Nr,sa,Qi,xo,ri,Yi,ai,ro,li,Xr,F.AsyncPipe],styles:["[_nghost-%COMP%]{display:flex;flex:1}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]{flex:1;overflow:hidden;--column-headers-backgroundColor: var(--scorecard-tableHeaderBackgroundColor);--column-headers-foregroundColor: var(--scorecard-tableHeaderForegroundColor);--row-backgroundColor: var(--scorecard-tableRowBackgroundColor);--row-foregroundColor: var(--scorecard-tableRowForegroundColor);--border-left-width: 4px;--expanderWidth: 44px}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row{width:100%;border:1px solid var(--fluent-theme-neutral-lighter-color);border-left-width:var(--border-left-width);border-right:none}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row.goal-not-match{opacity:50%}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row.selected-goal{border-right:1px solid}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row .actions-spacer{display:none;visibility:hidden}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:hover goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:focus-within goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:hover .actions-spacer, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:focus-within .actions-spacer{display:block;visibility:visible}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers{border-left:var(--border-left-width) solid var(--column-headers-backgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers .header{border-right:none!important}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers .column-name{font-size:var(--md-font-size)}.compact-cell[_ngcontent-%COMP%]{width:100%;padding-right:var(--column-spacing);overflow:hidden}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;height:100%}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex:1}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]     .name-box{white-space:nowrap}goal-status-cell[_ngcontent-%COMP%]     status-icon{width:100%}goal-status-cell[_ngcontent-%COMP%]     status-icon .status{border-radius:4px;padding:0 2px}goal-due-date-cell[_ngcontent-%COMP%]{font-size:var(--md-font-size)}goal-change-cell[_ngcontent-%COMP%]{--change-font-size: var(--md-font-size)}"],changeDetection:0}),n}(De.w),I=m(50264);function X(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.onLinkToGoalClick())}),e.\u0275\u0275elementEnd()}}function Oe(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,X,1,0,"button",11),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.canEdit)}}function wt(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"div",4)(2,"div",5)(3,"div",6),e.\u0275\u0275elementStart(4,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onNewGoalClick())}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275element(6,"mat-icon",8)(7,"span",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Oe,2,1,"ng-container",10),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",!i.canEdit),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(5,3,"NewMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiFeatureSwitch","goalsLinkedGoals")}}function ht(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.onCancelScorecard())}),e.\u0275\u0275element(1,"mat-icon",16),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}2&o&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,1,"Metrics_LinkedMetrics_CancelSelectedScorecard")))}function ut(o,n){if(1&o&&(e.\u0275\u0275element(0,"div",13),e.\u0275\u0275template(1,ht,5,3,"button",14)),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.onCancelScorecard)}}var Ot=function(){function o(n){this.onNewGoal=new e.EventEmitter,this.onLinkToGoal=new e.EventEmitter,this.onCancelScorecard=n?.onCancelSelectedScorecard?function(){return n.onCancelSelectedScorecard()}:void 0}return o.prototype.onNewGoalClick=function(){this.onNewGoal.emit()},o.prototype.onLinkToGoalClick=function(){this.onLinkToGoal.emit()},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(en,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["empty-scorecard"]],inputs:{canEdit:"canEdit",isMetricsPicker:"isMetricsPicker"},outputs:{onNewGoal:"onNewGoal",onLinkToGoal:"onLinkToGoal"},decls:5,vars:2,consts:[[1,"empty-scorecard"],[1,"content"],[4,"ngIf","ngIfElse"],["metricsPickerView",""],[1,"icon"],["localize","ScorecardNoMetricsTitle",1,"title"],["localize","ScorecardNoMetricsDescription",1,"description"],[1,"pbi-fluent-button","primary","new-goal",3,"disabled","click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-small"],["localize","NewMetric"],[4,"pbiFeatureSwitch"],["class","link-to-goal","localize","Metrics_LinkedMetrics_Button_Preview",3,"click",4,"ngIf"],["localize","Metrics_LinkedMetrics_Button_Preview",1,"link-to-goal",3,"click"],["localize","ScorecardNoMetricsInfo",1,"title"],["class","cancel-scorecard-button pbi-fluent-button",3,"click",4,"ngIf"],[1,"cancel-scorecard-button","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-chevronleftmedium",1,"glyphicon","glyph-mini"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,wt,9,5,"ng-container",2),e.\u0275\u0275template(3,ut,2,1,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(4);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.isMetricsPicker)("ngIfElse",a)}},dependencies:[F.NgIf,Sn.X,vn.Hw,I.P,Bt.F],styles:["[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]{width:100%;height:100%;overflow:auto;display:flex}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:auto;max-width:350px;text-align:center;display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQkAAADwCAMAAAAkXGEzAAADAFBMVEUAAAD50Rr2yhLzyhLzyhLzyRLzyRLzyRHzyBLzyRHzyRLyyRHzyRLzyRHyyRLzyRHyyBH/0hTzyhPyyRHzyRLyyBL0yRPzyRH0yxLzyRLyyRH1yxXzyRH4zRf/3CXzyRH0yhP/+UP0yhP0yRHzyRHzyhHzyRH0yRLyyRHxxxHwxhHvxRHtwxHswhHrwRHpwBHowBHvz0n777v99NDkuxHguBD99dPetRD89dT58tLcsxDnvhH89df2yhL99tn999v88cX55Y3555r44oH99939+OD66Zz444f9+OPzyxz22Fb56Z/++eT++eX9+ef56aL++un8+On9+uv78MD666v66qX+++3+++/+/PH666j99tf888z+++v+/PT+/Pb+/ff+/Pn//vr//vz+/f3u2X3asg/Sqg/Kow/huRDWrxDTrA/11UjyyRf0yxL00DP43m/333hZQD345pZPOxzzzSNWQiX////00j769Nn88sjzyRL++efz1FL222W6lA9FKwv///9PNBHwxhL////9/Pzuyzb04Y3x2G3tyCny1V7qwxv////atBb99dX///7kxELp0Gj67bTsxiDivzHny1jCvbLSy8DfuR7x4JbsxBj79dr58tb16r389+X////79d3279Tz7NT49OX69un////07tj28uT28dr18N/7+Ov//fjv6tr48MvX0Mj48936+O/s5tbz7uD++eT8/Pz29fP89+H69eHm4dPw7OH7+vb////5+Pjw7erby6D8+u/9/fvr59zm4c718+78+/j//Oz////6+fjz7+be2M739fH6+PL9+/Pu7Onr6OHz8u75+PX39evv7ej49vPr5dD+++n7+vnt6uT////8+/r////////////y7+ro49aNgWj9/Pvk3MX//O/////////WzsZPMxP////o5d/o49z////X0cXm4tv////9/f3h0ZX///7////6+ffx7+zn497t6eX39fTm4t3m493j39nz8e77+/r29fTm4dzz8e/5+Pfh3dfkktj7AAABAHRSTlMAEzZVa3yUprnN2d3n7PL7/w08s9XzTYEoYp8vxSAHikIDXHPiZr6b8P//////////////////////////HP//////////////////////////////////////////////////////////////RP///wT/CP8Pzv/+//X///+FFv83/8W3////////0f//1v///////xRA/////////9L//////9T/////////iSj/////6adb///////JlUxS////////48F///7///9z//7//////+3//9r/2dfc//8o5f/w391vIeH//+P9/ubq/+3p8+vx7ubq7fvz+PDaofzxuSMzYQAAH99JREFUeAHs04VhhTAQANCL4nC4u+4/YSeot0DyeTs8eDwet0Io40IapmU7rucHGPie69iWaUjBGSXwAsKIyzhJ8WNpEksehaApkuWxg9/hxHlGQC9FWdn4M3ZVFqAHwioXf8etGAHF1aIJ8C8EjagVPpHb+JfsXMknrUjw7yWiBaV0zMT/YrJOnRW9h//J69VYMsT4/+IBbm6cLDyHNY1wX9284HmWuYN76riL53J5d8cX64LnW9bbHWEOXsNhcCf1htfZargLsuO1dgJ3MPIDr3bw8Y26urqRIIihKLqqBMrLzGgoGGjOP66l72ay5sgRXOnJR+qu7qAJ9gaT3V1pf85LW9+AiHgAIprYw16qflRzBnXwL4M46c3JXwyESc6MXohX2xCCxfsQYm8heC88NYV91XoZp9AYYrPdDbTdTE8BpypPxLxBUwkJ291g2yCTS8CbUVlGA2K/342w90wwlX1VWEZziZCkIyRhagmFhZy8QTOSmOV5Wgy7PM+iEMzg7UR/Gf+QXSzzEcroGAHgcBbyfANtkKUaV6ISxh/u62A3bSAI47hAuaL9FBuCkMUh+NBzKkU9EAgJJG4CxLjN2nn/Fykbf6vS1lLxesct+YsDO8ffYeSBl0atfHyPA/z3EgjGLezKCEdITB3yKYFIfG/ehDgJCYQ3wpdnjBORQDyUhOj2cJzEzCHPEuh15SAGfZyQBPoDKYhLhWMl5ux2YbqaV3a1MN3ap3cJqEshCKC2xB1M99US9zDdiUgwEYqBqiGxZJRYVkYJ+5SQUAOBZdnHCUqg731tDnuoI7FilFhVRgn7FJFAb+j5gyrGiUog9vqJ1QnhJvEA02O1xCNMD8ISCDsej64INSWS1XsJJZJVYtv/3c/f35TgXEwC0djbGR6gtgSzEsn1V9NTYjuUYGISCHwd6SM4Szxbic8wVUk8y0tg5AdigsYS6+T6F4l1st7/KGFnghKY+IA4Vw4SG0aJzeZLKbE5jBL2KSmhzptDdGI4SGwZJbZbSmwPo4R9Skog7jSWCPAhJBBILIkaEi9/l3gRkBBYFV3lJpGm6S7d7VJKpOm0lODclO4okZr/+7mwhOq2uiSsRMYokWWUMLNv302bLKNExgQlmq+KAAISTzBN5SQEVsUETSVeYVpUSMzal8CkxSVhJbTWmf4pobMZJfZzK6EXML2amRaUaL4qxiHcJZiV0PNSwsxKibm2EprJSyB0u8UuICCR539I5FrnZt6CBC5cIIaqgUTOKJHnlDAzSuS5lWBtSKihwykewafE8neJ5T+RQFT/QD9DE4mCvZUSRUEJM6NEUZQSbwVrRQJndSE6n7xI/GDuPNjTRrYw7N7AlwMh7uVyl4V4+6Z3F8JiuT/YuLftBUxLYc1u2j+/YggayRmfkXQ0it/0Ht4HSTOfPh3v/9DgYHf3kH3nZuPnbrLvHu7uHrDv7Ptr4ka7QxNJIJk4coE/JiDpTMQ4fHoTqorf445MJD6xCZXF74QTEZ1ANHF8cnJ8cnx88uHbBifin9P58PPchOLid6eDK2iAauLEBdyE4uJ3wP6V9HP4pCaUF78/t73hiHtl4vTkVP98wkF+/pSbUF38jk+pXlRxE6fO4SbUF7+7bL4lgnQTP7qAm1Be/A5OqctnrG1lVyZYW5la/PYys4nFgQR7IT+5gL0Qn4rf8Zh3dSr0qYZ7Rz875ugee3NT684eFrD66Sa+ufPLsVMRx7/c+cZHE/02BmkAlZkvvr7962+/O+S3X29//cWMrOQ7l7t/PzfnRclXPsqjj25CPzz++PXPvxzx569/6AcHauIgk9cAbt0C0PKZA6qJPmlmB1TYyuib23/88ccd2+i/+fY3rXWR2MTcUgF0mAmdwtIczQTIcrxp8ETFF/qm6JuvbfONvtkyNlCiuvP9lAZN7t6FJlrqPqnuPC1ZVQ0CHeKmWmDiIA8t7t+HFvkDionBKUXb8fhZ+CwO9KCF1505c0UQmYCi0fl2U3fuVHS+PNP/9BmWH+LBKGbiVhHEJqB4i2ACPWdOgmsacz3DcDmTk+Cs7szJg4nHj8FE3vz7HJqAScRENyh7T7S1uTWRgstNQIpgohsxEQXaecI7E2mDAw3M7O+DGe0gbeDURJSwmBgEHBUmSmDh6VOwUHJvAkbc3xPuBSfMmGlrm7kcxMStApgoltPpchFMFG6JTdDuFw8ATv+Q+/VEpeJgPcGL3+kqcLRcs/id04BTXXRd/B5wfbvnv/htY3Q6y/PndkJ6bqLFEhi8mGv95NwLMFhadF93Hnd55ejRL7PXQY4wpH/50m5IbzWhgcHCosECGGhiE6SrxwSgJBvL08gAyBCH9K9e2QzprSZugUFthZtYqYHBLffF7wmxiPYQIETPWnOb4oDAQ3rEBBrSW4vfN8GgvGqiDAY33Re/Q+2O9xzBMeOQiiSjgMBDesQEFtJbS75bYLCwZmIBDLYIJd9ON49xjDF/4STIEIf0f/8tD+kFJvbAYNm+CeKDH0HACU7qIgYAhYf0D+5aP9/Xv2CfeUhvMbEJBmWziTIYbBJMBN2lVRMx2fuGHtJfLH7fB4PaBqNZ/K6BwX1B8Zu0zBwFKV1nIIMeTVtLvmsaGOSyBuar6Aal5Dvq7mmviV7fTWSXTAurbItz88oqKzdRH3ByohgAKfUAgPpJHFYTVZOI2a0sw7LaXrBhYmLMwYK7Heh4ZoIXv7NPC4aIZzWopbLZCzuw2W158Xvo8gr6xyuKoStmwqD0QcS2LkJndRUslPjvFJgwYuyuy1QMkVvaCmaSiE08LjREnG+nmQj45x8wo83ubOPF7/oEe7HjvVGbO/NrV8vEDifTELGjixCZyOxwxCaivWx5PDRRt/n4S9xTE7MuEJlg/KuLWKxBk40NMLG0g5tghLqQO1rxiyLCcLVM7JpIn+8aIqwmiov8dyF151DHEBbKW4l4a+KZC8QmGKZN+OGhScT+ri0TMIYEDhF6y0ypiSML6bzIRH7VbvF7oG6/fdbjrYk0ytNUmYfzN1vfEZjgZAoXTWjzO55U4HvIlw6CiSWAFy0BT4uYCc5sqeliexsaFF4/w4rfhGcnoz6amAcdbSvNeA0WE0jxO73wb6FpQsv/sIEXvwn3f64DGWFIb0xjMUifa9CgsP4hmrWG9Hjdefbm0dFmGq07O+U6fdeBmkDIm+5UzGkA1miaXvzGkO88OvwzwY6NIjTIzBZBYIJW/HZMh+00l2iCT2Nh32XHRnH59Ywh5GJITy9+U1LdLo9NrF5KHgAK88vLpQI0qVlDenrxm/a0YLfHJtYuIwM6r5d1yho0eLFgDWTpxW+UoOxGWI9PJs4LAFBbZmQaKgqZZasJevEb48Y12dKqV6WJar78bK1JjS0Ol5vMv2BvD6sJevEbo0/w5u8lN83k01lY+L6RYsfARoMM6JTWWyyUUvrX1pCeXvzG6ByRNc/6PTaR5WwBo7aZzc6xY2P9AtZAll78RojG2nolZfYBZSZ4Ter1fXZsVOUmRMXvN29sFr8RQuNs9A4abwdUmUgXQacABqV1qQlh8fvtW3vFb4T6kHBkeMDOPVHadBbjxs3rqpG01HLruXX9c67xLUM0nUVQ/H7+3F7xW/4Rkdp7sXujg96bYKRAJ5/L5VIvANixkfuI1u/Fn6auVEhPUwf7THH+SHdfEAwG6VtRuYktYEvrnM76aw0AyrmPQKazyLp7HJAw0NvNh8jGRvvql25GQx6b2Gmimd8GC0vFUk6AJZom9Dm7w92AEEq2iz+IWchiAtSYAJ1UTgJu4rPP7JoIywL6wAjbbIbgAkrfE7tNAOB1TgYSTXMDhPcEJx4WDekKqTxPcBP5PSl0E7bpbYtF4SL/UXrtOGoCxXW5CR7IKjcBk6PAEV47gmpMaNW9q2ViuE/WtYqDUxIhGyZSe65NDA2pMHGtLjiREvcdgS4b01m27CAM6bkBT02I3vsD1L1opIcJSWCTODa35GyeNKGZINBPzSeSseGJZKQrpGBOjb8m+oiZFWt/x3pUTGfx2UQvNcccFleS6CG93yZ6iC2rnpjoOQhKSC82EQ6rNjFMut8R6ookJ4ZjSY+nswhMJBKqTXSR7oElAqDTE3E+neXnn+2F9PyVqzbxPy/ui3YFnE9neYeH9P6biHhxrzyUcDyd5d07PKT33wSLcDh18Aw8pH//Hg/pfTcRihE6NZTpLO/f4yG97yYCynpW4pAeT+t5SO+/iQShe0eazvL8ORLSC1759LRiE0nCIEjSdJZKBQnpBSZiMcUmuukdXbkPMzduIGk9cHxfbQ8p623jM0lkr8h/E5OKuvzIK6OYYCaVcJ38fAfdBJ7Q89+PTfyhM0F+5oduAr9rw3+/34PIh67ue8Lnj/PSfpXPE/TIXb7/4gxcVRPEyB0nNEX8iJHqTYyM8N9PitxxJvBx4/ShVnQT9Tr//aTIHacHnzVAH3RGN8H/nJvInTaKIw4I5OF34TDFBD1yl8c0nKTS98TEBMEEIXLHiRNmYxKG3xFMECN3fF3l+4pCsYmPI3f300L71XuYman8n7azem5ch+LwZWZmJo3AjangLbezzOw8Xlpm5lUpUAos7x97dax4E9XXWo2n+p5D+ub8ZEUP55zlHCFkyZzmyt2s54LkVeseOMfQ9Q1jzsGHLRPvFz9NSL6wLgITcXvHGKVEgLn0UdyEveF5n1gXwTbOzJ47c2POYdIHBh/auFg18ZG+P6Y9E8QpdXqdlffNL5QqDqOgQxsXmybe+VHTFtIinNDor1CakIztnKzO1Zg2LjZNvPZCLm/ZNcGCrWG9HgJeFzcbF4Tsm9BPKXjVajho1L83NaHqUOIiw4Lsm3j3x3wTwzZNYOovxkvLy0tLoYKXjQslmCPrJn7X92C3GY4jK3G8YUMcx0tAng+Iy3FCOLJt4qS+L79VE6txL6oO1cdGgrllE+/8aGVWA8oizwmox0T//IhAsZFXHmUG+bBgwnhsxWvGK+dZsEJ6TkCpib6hxkiCgQ+3jxiYSH0XMvHFusx0QbBs0gvN0nkQcJRumEPhaIKBj4lIawIcSPdSdwEX36zLAH/ECaFM4HSATtEJtVqtWRHMCUpAhcolgYmWFGGi46+IpibyHaT+pe0CnTG1/GAmgl7eeO7cxNatO/fv29doNNy9e8eulr3/oXyZJnsfx/RIe0owqpLjo6rWhCqBYHDAGJu7ceace3UjK6DiU7WjV8G/YRyTStkzZN4hHMkT5l9Tz3iejlbXhFIIqYNKaWF+X/obSkIFKnLS1vOliQlW8hTCfM75FCcm+vr3TydodUgfS0cckj5F1TCw2lx1cueY8t0iSpgX3y+LTxdFnESl0JStRxjh8qx9VZow8OEGsDYohLNn14Qh619+RdEuVhpeWU8TS+HOgMGiMI0WoZfTtEJeXCZ8SqASYLJBJwzj+8p5Nbh3KKLZeCCg+Ig4WRT6D4VVrSzpgYdAnHA4YITDNuGvpI31Mz4yOkS9E0gEZffuZ8LQi/yuB36mKFASqbzTxpvFZs4iLkFdE/5KbMo+aQKzYGH7NiCrI+ujLUwQclyE4dIljQOQDaz4DPPMBVnzeEXeemRd/FRo6CznhBB5RCpiohE4siaCh9slGh+pjpZDCdko+/nnFEIvq2B77XO+JraUfTeblBAojGLTqX9dI5fOnan2MZqoSNMhNvgRIxIT8JYh9/r162BCrwOIA0YpK0sTOXWQAt8x3++oJrj4vgV5njl345EsDKQpiTx+fFORy6riN00eiVIV0oQJoyOjo25/xOBE6v/9WHSqETKyPjJC3COMUccNBfW6XgIw2lC3TPjV7Egj/W87tvEyJbhHxlvmA8s/6kkGrY0n5dkOYBd7ZmLUjMdX3CHfYdSJgge7d+xK0fgAHRM+ozSa6JjQOBCmgXDIV0xwQv1W7x9990yFysqQJWHO6917+bmGzGm5FTgU846JlomFx1euPHny9O8jflSpVv+j7D6Cm8jyOI5vjufd4942B5KM4uRxFRlkk4py6G4yN68LlzaizcGsYYpYkmVhtRVaXhyGccuaoDYSM0L2MJJzJme4n/f312vJHYRgv+QMH73/635NOnk24HYzh5dyHHDiHspygAy6uowGegTWGf3Fg5bEAZxeNBaaLQP/bs+r99r3tJMBCCzP907iBgao+PwVCdrq361Q0AcHv//Spe7Oo6cOEObFAyFRL2H2QEWPs07Mk/Nf+1BPT1UD9C46q5Ogl8paj+u4HqO0ZXz11R3Q19XJ+HvJAevz7w4LUTCJd19cMBj0eRhDdzgU+M06ym7fGQEFqttRIT3HhVW4XDnP7EMdHdUNWAd0Fw9cstnFzYDBtowftaBXl/jBdzWTAYjii3LWSlsFJDCFtS9IdYhCoTsmNcbjzXY7fR92e7g3EgqJCBgN6MXLw3XkV5BYZbW5XC6fD2/R66/jvQoItcV2WfFkR/tbTDUXcXwxYKhPSf97ubW19f/A+L5uMtjqXH+mZjW2CrrbfoEEGPr6otEwLYb+eLEmu339epvNZu8fGIxFEDiYhZbD7ca/9xZQ68SOhB3T2ulfCYuM3vN5fEEdAutN7cWDhuPCOu3RVrsw3m9ru/LBOWC8mkVLS+u3tJOBaG2uLW4Vf4bEhVpNG+jtkCyXGWJiY7yc3W5Dfh+X6B1Ock3iIDBEUarb3VAOEAAIIZm6WOPEQyCn9eIlU9AAhZ6ffuSTR1b98s/aZ8fsNGdeGLb2NvThRx8ff6WFAYjWT97TQqgz+mtsFbg0Q2KDriH8bPoYQzSUivOaVAlXQBm5ms5wPM/1Dw7CQpKk3RRJ1ImhUCRW7rT1iNPptDhOd7PCVBT19cnRqCdYNlj5oU/RNf6npeFYXbNTc7LVYVwjCerTz86/3AIOxz/+y/u6yXidTedpB50IILGlHH4uQ0WGcJh2Bt5Q3O/fh3n3pJTs9VySEwSB50azZQuqThJD4hhqbGyi3lSfgQXjFeqLBoMMAbEfG0QXzxxhz4DZzcQF/FTfqIThaUdtan/9/HJVixaC+Axf0WOGqH2dtgqa4a1qGzbIKkOYLQZTfhflH1NGE0wC8ckIs0il8M9ZSVIowmuyr2P5K0lI4T55iDHQiyDTjy3F3fazR1ZjCyvdTNRqj7YrFq6Orq52LQa2DB2FEeLylTbUYSMHVHKg+XwTE/krHCJUiEAAEGAwLAajhM/n57jMjS/yGUVQayqoFnv2psRIRD9PbKbtlST6B/rkDeptGBxi0ZiEF2Cvvf6kBbt56WaCHeZMC+NaT09Plx7jr+daqk1GG2pvv6ZbEIBAG7Y7LKtXWRy/K7aNIGLiWDP/4jx0DfR5lAyfHp9gEiy+P5sNFSSpXxIHs/xKY3YbOeBys1ePwFP9k1F5Q/E1YA79qp7ttIPmgz0JqWUZMYI9LJ3Fx60t1SaDILq6pnSTQWFJ/sNhcVoObt1BQSIyxlfPQ/cBnoAy7Z2e0UnAYpQsCoXQ8DA+UarOZiMKvL9bQ8BiEoHiWpRjMeZA+e2dR4/Q3Q4Nx0WMjgkDzXZ0dJgwsFdUm4x2gujp8BgWBCC21p6yWo4c3MBuA0IRkX9JQUj4+iRO8XpvpPNzgr5kIRvJZkducIyIPAJ+238om20bEIyNTsZkowMa8rtO0+0VnccdNkyO3oIw3p2an19YgIUO48oJJmGejE9LED1o0QSBdbnupLXm6JCbScQKL5eg+62xOcHrXVrKZwRjXGF4eHkkmYEFK+hyse3NJfPmINHHHFK8JrffVY9Fgd8H+KXlLI4vsDAuDECgBQ0GbRmfQ6LaZDCIjoUp/WQA4ne/27Hz6MGjfSLdJoqhWG8VBIGSg1Ryzuv15scnphXBFJdOLOfyyUyGExDvAQSj8FSSuNobQ8ah3ONxYVGswsltVc3OrciEMbS4ODs7a8Rov3kcElUmo4dBzM/LhgXxux3owLFDUdENCbcYG2iqosAkcBaRM/shodzIYTzMKcmldJpZKEKcdlgKp1nTcHDcxNXe8CAcDMX9Pl/9UTzX+BXuf7GXMwstxq1FilnQlDCMKydIovpkdBDE/KIJAm07dag7RPdFkhgZKFRjQIEgIGQsCTTzRX5O2Y/0EEom453LpXMTwODGyEGlaDQ4ZDL59O3JQTiYgsQb2ClWrT7yjx0IFiUMZnHn7r17zEKHcf+EEaJFe81gCwIQs7OLt/STQTXU+Q5NRkTcCuBOoHfYqKCLV3C1ww0x56VyNB4koRRjW6QCiWlaMROwSE5LnvKZ05cyOkzklhKjHMebk/GtsFM4Ldb68tFWMyV37iIDBqak7YFhSRiuGWwyAIFvde9OeUGUIBrqdnfe7gXFnj2SOJygNYufY5KDgiEFBQhCjgsC5mNuBuOhmMsk93vR/iQsIpc8JYmgW++Qz6UnuCQHCTO+Gxvzu2cdlpozbu0xX8W48xAxi3vaKfnoxPGWFv2KME5GGeLu3Tu6yQDE7t2pPZHEcEhK7e0vDCfSuaWZR48fPxpPmiAE1DiGmgXWI1xH93vNTe8X2Ecyue5L/tLJOxjQOCTJQYCWRkJDnwpCov6Y1fF3t/bZB7NwPwFEJYxPThiXRMXJYBB3H97ZsgLRQBD4Z2+FkYFsoQCI5afXH6OZmUfPbuSNEl7E45/tKhl5l7I5rB18xJCilH2ksN9DEpTMfrGqQ774zSDBEPQ1FQ9mZ48dtUsNSIfhfv7kSclCNyUf6ocDEB8YIOYZxD1A4Bs/cZODDmKvMJdIjIwsJxLXnz5dmpjzovyjcU7QxyTiTVzpE/mZ9Giymf7nHk7ReijllSLEG7shoT754cmTYw70NZiEokJDCFOZYRuSPFQ7VNt5+FSITrg6DPf/2jMP57SRL47//rtf90x6x0L7D1ydcvVdmXZtypVpxxV7gguTAGmgKyxIk2BBBBYeaTRzIj0B93o2Tn+r1RqMzFjp9ZO4t9Vnvu9p92l2BlUEZKCNcx+/3WXiXK/KQBFoYmaHEME95EbGK2ZzamosU8+qCggcQ9nKBHYRGXzkPDMx6rnox7eYD9+ELAsTo0eH+AgCW20Er9fzoBDw4XswpodXZdOuembO4An9X6e/m4sPisEHIkQgW8n4IVAcx37rCES3CPz5GRGInXiEjqcxC81GI1NXHeiAgK7KnUSj3ES/BBvYbkmJ9I8y+hn4NiJFqSQaBUYo9+vQz6f5AOJ0mYvwPYhMaFqtYhpNholvjZqMDDIT//rxUpbd1Pa1ZeycX1iY8elycTZw53jz3VOdIriHq20PMzOzOJHeuWPHYDydyjAM3QrUOgEwadAElaSOb9VNXeEn104XkZKXeQDAH0r/yiYQnL3YI6oKbECoU1NZFBCjUqWAWIbtsJbJfiaWy6fiI8n9+/dxGRhiFMGY2SIYbKfdZeLtj3/vVRkoAllYjOHGmlvIqhqBrSBQsTaZoL4JaCMZuiJ2pSIZ+KqMmR+NeneFyMTR46f/5c/D+mRHUTYsUFYQ00jT1i0CAtlmoYgwEbGIlsmOJ/ftR3K5EWR+ViBUeHgmLgTOHLituvD5RiC2EnFxabmA1LO6Bj0hUBXlQau1WtVyKGEmZOjAaxTRLhfMBLMQxZf0xNDxM2IOFKMSmmBRcFhBNJBps+Z0/1kXnUdjMZyOy3I+H0/mUEQynkjV6ys+S4K/BRcvfu5tJgI7zB++7NhNXd3sYeHiyuracjEpQW9EeQDDMnHJzYbhqlXLUgh0UHE9EwI/FdwEc9E/gcURYx7e///7fX2SVK04FuuNDFtVZNgCE93Isb6+WBnAC0X5SDKB8W0tI2uc1QCBnTbfY358vmdlLMwura07sD0EXMcTYWMRV+zmNF9+pWZRSsRN0GY7im6OaBInOs7mD+JZcl+spJvT/NeIKAQhoNYACJroi7LU5dFEOZspKoSwMFk3PRaRW7fWEUwGpmT19ifX32UmgiruBCpjhotYuLh8F8JAQK+xN25DAQa1dLPhXYdhurrioA8ghloNmohozAIjlRjeEBEbnqhPt1pjojf2gAB1KUix2I4RAC8UyVKyXoJtmL8WMCFaxVkUEagMZP5WBUKaIKxiHUODNkSruUbDw8ZqcQy3pnWrkJgJfziXjsd2+CIShUKGHV+3/7umUmaPGSMAfijcMEu+c52bCLaKb1gggiLmbxEgIVXk8bSeLga/3alWbK5juoWp2OxCkkaFiURieMAXsSNRSChyuD9bTAzuQGTgoSjqJoRZ8rU3ewy1z28tYn4RLAohlxQfGUnQHqugiorVMjXWmsaq3+Ri1FdTnhgeYNMwxmBGhXAQ0AppzESOgEejUVkHZ1sTFD4PmBCt4iTzgHR6YEDVCrkkJYEHdSAEeiKrLvbSZtPtVNGvSd64opgYHtyxlxMvQlgI5AupVKKoVy3qUHK3NW0Che1NzAsTwVbxWXcgPBWLQB0IAxpIDMSL26+CVI2m2qFC4iZG6+kBfmxABghQCEs0VcCm0mS3bts0p6Z0ICFMADPRo1X8tVkEZz30mggUC5lqqK7i2lq0DZ/mjie8URgnCZYF4YmUdHfd5r251YIAoU2IVjF50WNWML+4uL5MgEBItHoewiEmOzwTrDZoKhvH8Y9PDqo6gQeGUMui8CgmRKtYFawhyx7rQOBxQ8DiJhCmgpnQ8/FBfE4qAKISeHIIEz1bxe1uESu3nsR6LAKa3MbLRB73ybkjgpwCNQJPlu97mkAV8FQgugOS3Ia9r+SL7MTgUx5XwYEnzOSpY+La4RlBKgBylwk7K0SUS6XxYlMFAk+NZ2mCbjJBiVZnkSiXxt2ika/X63kC8CqYqIEit6Ga49j5bNYw8s1pD6NC4NUwYUHFAcQ7ON/VXdOYGrvXaqEDu3LXEhZeARNAwXQtx/IcsHNZc2yqhQ4cAs+Gf7zmNa95zTbcB561bL3JySyTAAAAAElFTkSuQmCC);background-position:center;background-repeat:no-repeat;background-size:contain;height:200px;width:220.83px;margin:0 auto}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600);margin-top:28px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);margin-top:20px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .new-goal[_ngcontent-%COMP%]{margin-top:28px;display:inline-flex;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .new-goal[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;color:var(--text-primary-content-color-hc)}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link-to-goal[_ngcontent-%COMP%]{background:transparent;border:none;text-decoration:underline;color:var(--fluent-theme-link-darker-color);font-size:var(--sm-font-size);font-weight:var(--font-weight-regular);margin-top:12px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]{margin-top:28px;padding:6px;font-size:var(--md-font-size);font-weight:var(--font-weight-regular);display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-left:-12px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:6px}[_nghost-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0}),o}(),it=m(17174),_n=m(87650),bn=m(48205),Un=m(33846),Zt=["input"];function Ht(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",2,3),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onInputFocus())})("blur",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onInputBlur())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.keyupEnter())})("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onInputChanged(l))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("type",i.inputType),e.\u0275\u0275property("disabled",i.isReadOnly)("placeholder",i.placeholder)("ngModel","text"==i.inputType?i.formattedValue:i.value),e.\u0275\u0275attribute("aria-label",i.placeholder)}}function Tn(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"mat-option",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("value",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function kn(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-select",5),e.\u0275\u0275listener("selectionChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onSelectChanged(l))})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.keyupEnter())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275template(3,Tn,2,2,"mat-option",6),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",i.isReadOnly)("value",i.value)("placeholder",e.\u0275\u0275pipeBind1(2,4,"Generic_Select_Value")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.categories)}}var un=function(){function o(n,t){this.formatValuePipe=n,this.localizationService=t,this.placeholder="",this.type="number",this.onValueChanged=new e.EventEmitter,this.onInputKeyEnter=new e.EventEmitter,this.inputType="text",this.defaultDateFormat={day:"numeric",month:"short",year:"numeric"}}return o.prototype.ngOnInit=function(){this.categories||this.showFormattedValue()},o.prototype.onInputFocus=function(){this.inputType=this.type},o.prototype.onInputBlur=function(){this.showFormattedValue()},o.prototype.onInputChanged=function(n){this.value=n,this.formattedValue=this.formatValue(n),this.onValueChanged.emit(this.value)},o.prototype.onSelectChanged=function(n){this.value=n.value,this.onValueChanged.emit(this.value)},o.prototype.keyupEnter=function(){this.onInputKeyEnter&&this.onInputKeyEnter.emit()},o.prototype.focus=function(){var n,t;null===(t=null===(n=this.inputElement)||void 0===n?void 0:n.nativeElement)||void 0===t||t.focus()},o.prototype.showFormattedValue=function(){this.inputType="text",this.formattedValue=this.formatValue(this.value),"date"===this.type&&!this.formattedValue&&(this.inputType="date")},o.prototype.formatValue=function(n){var t;if("number"===this.type)return this.formatValuePipe.transform(n,this.formatString,!0,"");if(!n)return"";var i=this.localizationService.currentLanguageLocale;return se.E.treatAsLocalDate(new Date(n)).toLocaleDateString(i,null!==(t=this.dateFormat)&&void 0!==t?t:this.defaultDateFormat)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(xr.c),e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["formatted-input"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Zt,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.inputElement=a.first))},inputs:{placeholder:"placeholder",value:"value",formatString:"formatString",isReadOnly:"isReadOnly",type:"type",dateFormat:"dateFormat",categories:"categories"},outputs:{onValueChanged:"onValueChanged",onInputKeyEnter:"onInputKeyEnter"},decls:3,vars:2,consts:[["class","input-value","step","any",3,"disabled","placeholder","type","ngModel","focus","blur","keyup.enter","ngModelChange",4,"ngIf","ngIfElse"],["categoricalTarget",""],["step","any",1,"input-value",3,"disabled","placeholder","type","ngModel","focus","blur","keyup.enter","ngModelChange"],["input",""],["appearance","none",1,"select-category"],["panelClass","goals-categorical-value-select",1,"number-select",3,"disabled","value","placeholder","selectionChange","keyup.enter"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,Ht,2,5,"input",0),e.\u0275\u0275template(1,kn,4,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",!i.categories)("ngIfElse",a)}},dependencies:[F.NgForOf,F.NgIf,it.Fj,it.JJ,it.On,_n.v_,bn.x8,Un.CK,Bt.F],styles:["[_ngcontent-%COMP%]::-webkit-outer-spin-button, [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"],changeDetection:0}),o}(),Kn=["goal-edit-buttons-row",""],qn=function(){function o(){this.onSave=new e.EventEmitter,this.onCancel=new e.EventEmitter,this.COLSPAN=ne.gT.TotalNumberOfColumns}return o.prototype.onSaveClick=function(){this.onSave.emit()},o.prototype.onCancelClick=function(){this.onCancel.emit()},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["","goal-edit-buttons-row",""]],inputs:{disableSave:"disableSave"},outputs:{onSave:"onSave",onCancel:"onCancel"},attrs:Kn,decls:6,vars:8,consts:[[1,"button-box"],["data-testid","button-save","localize","PBI_Button_Label_Save",1,"button-save","pbi-fluent-button","primary",3,"disabled","click"],["data-testid","button-cancel","localize","PBI_Button_Label_Cancel",1,"button-cancel","pbi-fluent-button",3,"click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"td")(1,"div",0)(2,"button",1),e.\u0275\u0275listener("click",function(){return i.onSaveClick()}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",2),e.\u0275\u0275listener("click",function(){return i.onCancelClick()}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275attribute("colspan",i.COLSPAN),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",i.disableSave),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,4,"PBI_Button_Label_Save")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(5,6,"PBI_Button_Label_Cancel")))},dependencies:[Sn.X,Bt.F],styles:["[_nghost-%COMP%]   .button-box[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .button-save[_ngcontent-%COMP%]{margin-right:8px}"],changeDetection:0}),o}(),xn=function(){function o(){}return o.GoalNameMaxLength=256,o.MaxGoalOwnerCount=5,o.ScorecardNameMaxCharacterLimit=250,o.ScorecardDescriptionMaxCharacterLimit=120,o.RoleDescriptionMaxCharacterLimit=512,o.RoleNameMaxCharacterLimit=128,o.ActiveStatusMaxCountLimit=12,o.HistoricalStatusMaxCountLimit=12,o.MaxStatusId=255,o.StatusMaxCharacterLimit=50,o.MaxNumberOfCategories=10,o.GoalValueCategoryMaxLength=40,o.GoalValueCategoryNameMaxLength=256,o.CycleCustomLabelMaxLength=32,o.CycleCustomDescriptionMaxLength=128,o.CycleMaxCustomDurationInDays=1e3,o}(),gn=function(){function o(){}return o.getPreviewValue=function(n){var t,i,a,l;if(null!==(t=n?.result)&&void 0!==t&&t[0]){var c=n.result[0],p=_.filter(n.columns,function(L){return L.isMeasure}),y=_.first(p),O=c[y.index],A=_.find(n.columns,function(L){return!!L.type&&!!L.type.dateTime});A&&(a=new Date(c[A.index])),l=(0,lr.EO)(y,sr.iu),_.isFinite(O)&&(i=O)}return{timestamp:a,value:i,formatString:l}},o}(),nr=m(17085),Vn=new e.InjectionToken("ConnectToDataDialogService"),Nn=m(5432),Hn=m(32293),hr=m(11962),Fn=m(98665),Xn=["formatSwitchCell"];function Zn(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatValue"),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(),i=t.data,a=t.column;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(2,1,i,a.formatString))}}function re(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"date"),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(),i=t.data,a=t.column;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(2,1,i,a.formatString||"shortDate","UTC"))}}function H(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Z(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Ce(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0,1),e.\u0275\u0275template(1,Zn,3,4,"ng-container",2),e.\u0275\u0275template(2,re,3,5,"ng-container",2),e.\u0275\u0275template(3,H,2,1,"ng-container",2),e.\u0275\u0275template(4,Z,2,1,"ng-container",3),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.column;e.\u0275\u0275property("ngSwitch",null==t?null:t.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Text")}}var xe=function(){function o(){}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["format-switch-cell-template"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Xn,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.formatSwitchCell=a.first))},decls:2,vars:0,consts:[["formatSwitchCell",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(t,i){1&t&&e.\u0275\u0275template(0,Ce,5,4,"ng-template",null,0,e.\u0275\u0275templateRefExtractor)},dependencies:[F.NgSwitch,F.NgSwitchCase,F.NgSwitchDefault,F.DatePipe,xr.c],changeDetection:0}),o}(),we=m(44641),mt=m(11941),At=m(39686),Gt=m(23873);function dn(o,n){if(1&o&&e.\u0275\u0275element(0,"message-banner",12),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBanner)}}function an(o,n){1&o&&e.\u0275\u0275element(0,"mat-icon",13)}function pn(o,n){1&o&&e.\u0275\u0275element(0,"mat-icon",14)}function qa(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",15)}function Wa(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"tri-grid",17,18),e.\u0275\u0275listener("rowsChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onRowUpdate(l))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(3,"section")(4,"div",19),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"pbi-radio-group",20),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.showFinalTarget=l)}),e.\u0275\u0275elementStart(8,"pbi-radio-button",21),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"pbi-radio-button",21),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275elementEnd()()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("rows",i.gridData)("columns",i.columnsConfig),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,8,"Metrics_Targets_Editor_Select_Target")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",i.showFinalTarget),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,10,"Target_Next")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(13,12,"Target_Final"))}}var la=function(){function o(n,t,i,a,l){this.dialogRef=n,this.localizationService=i,this.telemetryService=a,this.changeDetector=l,this.isFullScreen=!1,this.onDestroy$=new je.xQ,this.resultType=2,this.TargetColumnIndex=0,this.DueDateColumnIndex=1,this.telemetryService.logEvent(tt),this.goal$=t.goal$,this.goalTargets$=t.goalTargets$,this.onDoneCallback=t.onDoneCallback,this.columnsConfig=[{name:this.localizationService.get("Target"),type:"Number",width:o.GridColumnWidthInPx},{name:this.localizationService.get("DueDate"),type:"Date",width:o.GridColumnWidthInPx}],this.DuplicateTargetDates={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Duplicate_Target_Dates")},this.MissingTargetDate={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Missing_Target_Date")},this.MissingTargetValue={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Missing_Target_Value")}}return o.prototype.ngOnInit=function(){var n=this;this.goal$.pipe((0,Me.q)(1)).subscribe(function(t){var i,a;n.columnsConfig=[(0,M.__assign)((0,M.__assign)({},n.columnsConfig[n.TargetColumnIndex]),{formatString:t.valuesFormatString}),(0,M.__assign)((0,M.__assign)({},n.columnsConfig[n.DueDateColumnIndex]),{formatString:t.datesFormatString})],n.showFinalTarget=null!==(a=null===(i=t.metadata)||void 0===i?void 0:i.showFinalTarget)&&void 0!==a?a:!t.targetConnection}),this.goalTargets$.pipe((0,Me.q)(1)).subscribe(function(t){n.gridData=t.map(function(i){return[i.target,new Date(i.timestamp)]}),n.changeDetector.markForCheck()})},o.prototype.ngAfterViewInit=function(){var n=this;this.columnsConfig=_.map(this.columnsConfig,function(t){return t.template=n.formatSwitchCellTemplate.formatSwitchCell,t})},o.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},o.prototype.onRowUpdate=function(n){this.gridData=n},o.prototype.toggleFullScreen=function(){this.isFullScreen?(this.dialogRef.updateSize("70%","80%"),this.isFullScreen=!1):(this.dialogRef.updateSize("100%","100%"),this.isFullScreen=!0)},o.prototype.close=function(){this.telemetryService.logEvent(k),this.dialogRef.close()},o.prototype.onDone=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,i,a,l;return(0,M.__generator)(this,function(c){if(this.gridData=this.gridEditor.flushPendingChanges(),(n=this.gridData.filter(function(p){return!(_.isNil(p[0])&&_.isNil(p[1]))}).map(function(p){return{timestamp:_.isNil(p[1])?void 0:p[1],target:_.isNil(p[0])?void 0:p[0]}})).find(function(p){return _.isNil(p.timestamp)&&!_.isNil(p.target)}))return this.messageBanner=this.MissingTargetDate,[2];if(n.find(function(p){return!_.isNil(p.timestamp)&&_.isNil(p.target)}))return this.messageBanner=this.MissingTargetValue,[2];for(t=new Set,i=0,a=n;i<a.length;i++){if(t.has((l=a[i].timestamp).getTime()))return this.messageBanner=this.DuplicateTargetDates,[2];t.add(l.getTime())}return this.onDoneCallback(n.map(function(p){return{timestamp:p.timestamp.toISOString(),target:p.target}}),this.showFinalTarget,this.columnsConfig[this.TargetColumnIndex].formatString),this.telemetryService.logEvent(It),this.dialogRef.close(),[2]})})},o.prototype.valueFormatStringChanged=function(n){this.columnsConfig=[(0,M.__assign)((0,M.__assign)({},this.columnsConfig[this.TargetColumnIndex]),{formatString:n}),this.columnsConfig[1]]},o.ErrorIcon="pbi-glyph-blocked2",o.GridColumnWidthInPx=200,o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Hn.so),e.\u0275\u0275directiveInject(Hn.WI),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(Fn.y0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-targets-editor"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(hr.oY,5),e.\u0275\u0275viewQuery(xe,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.gridEditor=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.formatSwitchCellTemplate=a.first)}},decls:27,vars:29,consts:[[3,"viewModel",4,"ngIf"],[1,"title"],["mat-icon-button","",1,"pbi-icon-button",3,"click"],["class","glyph-small","fontIcon","pbi-glyph-fullscreen",4,"ngIf"],["class","glyph-small","fontIcon","pbi-glyph-fullscreenexit",4,"ngIf"],[1,"targets-editor-value-formatting-box"],[1,"goals-value-formatting",3,"formatString","dataType","formatStringChange"],["class","pbi-spinner-large",4,"ngIf","ngIfElse"],["showGrid",""],[1,"actions"],[1,"pbi-fluent-button","primary",3,"disabled","click"],[1,"pbi-fluent-button","secondary",3,"click"],[3,"viewModel"],["fontIcon","pbi-glyph-fullscreen",1,"glyph-small"],["fontIcon","pbi-glyph-fullscreenexit",1,"glyph-small"],[1,"pbi-spinner-large"],[1,"grid-container"],[3,"rows","columns","rowsChange"],["gridEditor",""],[1,"displayed-target-title"],[1,"displayed-target-options",3,"ngModel","ngModelChange"],[3,"value"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,dn,1,1,"message-banner",0),e.\u0275\u0275elementStart(1,"header")(2,"div",1),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(){return i.toggleFullScreen()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,an,1,0,"mat-icon",3),e.\u0275\u0275template(8,pn,1,0,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"section"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",5)(13,"value-formatting",6),e.\u0275\u0275listener("formatStringChange",function(c){return i.valueFormatStringChanged(c)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,qa,1,0,"pbi-spinner",7),e.\u0275\u0275template(15,Wa,14,14,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(17,"format-switch-cell-template"),e.\u0275\u0275elementStart(18,"div",9)(19,"button",10),e.\u0275\u0275listener("click",function(){return i.onDone()}),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"button",11),e.\u0275\u0275listener("click",function(){return i.close()}),e.\u0275\u0275pipe(24,"localize"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(16);e.\u0275\u0275property("ngIf",i.messageBanner),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,15,"Metrics_Targets_Editor_Title")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,17,"Fullscreen_Toggle")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.isFullScreen),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isFullScreen),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,19,"Metrics_Targets_Editor_Description"),"\n"),e.\u0275\u0275advance(3),e.\u0275\u0275property("formatString",i.columnsConfig[0].formatString)("dataType",i.resultType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.gridData)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",!i.gridData),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(20,21,"Done_ButtonText")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,23,"Done_ButtonText")," "),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(24,25,"PBI_Button_Label_Cancel")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,27,"PBI_Button_Label_Cancel")," ")}},dependencies:[F.NgIf,it.JJ,it.On,vn.Hw,we.A,mt.o,At.d,cr.k,Nn.d,Gt.o,xe,Bt.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}[_nghost-%COMP%]     .targets-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}header[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-dark-color, #201F1E);display:flex;flex-direction:row;align-items:center;justify-content:space-between}header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}header[_ngcontent-%COMP%], section[_ngcontent-%COMP%], tri-grid[_ngcontent-%COMP%], .targets-editor-value-formatting-box[_ngcontent-%COMP%], .displayed-target-title[_ngcontent-%COMP%]{margin-bottom:16px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:end;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin:5px 5px 0 0}.pbi-spinner-large[_ngcontent-%COMP%]{height:100%}.displayed-target-title[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px)}.displayed-target-options[_ngcontent-%COMP%]{display:flex;gap:36px}.grid-container[_ngcontent-%COMP%]{flex-grow:1}'],changeDetection:0}),o}();function ja(o,n){if(1&o&&e.\u0275\u0275element(0,"message-banner",12),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBanner)}}function $a(o,n){1&o&&e.\u0275\u0275element(0,"mat-icon",13)}function Qa(o,n){1&o&&e.\u0275\u0275element(0,"mat-icon",14)}function Ka(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",15)}function Xa(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"tri-grid",17,18),e.\u0275\u0275listener("rowsChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onRowUpdate(l))}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("rows",i.gridData)("columns",i.columnsConfig)}}var ca=function(){function o(n,t,i,a,l){this.dialogRef=n,this.localizationService=i,this.telemetryService=a,this.changeDetector=l,this.isFullScreen=!1,this.onDestroy$=new je.xQ,this.resultType=2,this.ValueColumnIndex=0,this.DateAddedColumnIndex=1,this.telemetryService.logEvent(be),this.goal$=t.goal$,this.goalValues$=t.goalValues$,this.onDoneCallback=t.onDoneCallback,this.columnsConfig=[{name:this.localizationService.get("Visual_Tablix_Values"),type:"Number",width:o.GridColumnWidthInPx},{name:this.localizationService.get("Date"),type:"Date",width:o.GridColumnWidthInPx}],this.DuplicateCurrentValueDates={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Duplicate_Current_Value_Dates")},this.MissingCurrentValueDate={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Missing_Current_Value_Date")},this.MissingCurrentValue={bannerType:1,iconName:o.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Missing_Current_Value")}}return o.prototype.ngOnInit=function(){var n=this;this.goal$.pipe((0,Me.q)(1)).subscribe(function(t){n.columnsConfig=[(0,M.__assign)((0,M.__assign)({},n.columnsConfig[n.ValueColumnIndex]),{formatString:t.valuesFormatString}),(0,M.__assign)((0,M.__assign)({},n.columnsConfig[n.DateAddedColumnIndex]),{formatString:t.datesFormatString})]}),this.goalValues$.pipe((0,Me.q)(1)).subscribe(function(t){n.gridData=t.map(function(i){return[i.value,new Date(i.timestamp)]}),n.changeDetector.markForCheck()})},o.prototype.ngAfterViewInit=function(){var n=this;this.columnsConfig=_.map(this.columnsConfig,function(t){return t.template=n.formatSwitchCellTemplate.formatSwitchCell,t})},o.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},o.prototype.onRowUpdate=function(n){this.gridData=n},o.prototype.toggleFullScreen=function(){this.isFullScreen?(this.dialogRef.updateSize("70%","80%"),this.isFullScreen=!1):(this.dialogRef.updateSize("100%","100%"),this.isFullScreen=!0)},o.prototype.close=function(){this.telemetryService.logEvent(V),this.dialogRef.close()},o.prototype.onDone=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,i,a,l;return(0,M.__generator)(this,function(c){if(this.gridData=this.gridEditor.flushPendingChanges(),(n=this.gridData.filter(function(p){return!(_.isNil(p[0])&&_.isNil(p[1]))}).map(function(p){return{timestamp:_.isNil(p[1])?void 0:p[1],value:_.isNil(p[0])?void 0:p[0]}})).find(function(p){return _.isNil(p.timestamp)&&!_.isNil(p.value)}))return this.messageBanner=this.MissingCurrentValueDate,[2];if(n.find(function(p){return!_.isNil(p.timestamp)&&_.isNil(p.value)}))return this.messageBanner=this.MissingCurrentValue,[2];for(t=new Set,i=0,a=n;i<a.length;i++){if(t.has((l=a[i].timestamp).getTime()))return this.messageBanner=this.DuplicateCurrentValueDates,[2];t.add(l.getTime())}return this.onDoneCallback(n.map(function(p){return{timestamp:p.timestamp.toISOString(),value:p.value}}),this.columnsConfig[this.ValueColumnIndex].formatString),this.telemetryService.logEvent(Xt),this.dialogRef.close(),[2]})})},o.prototype.valueFormatStringChanged=function(n){this.columnsConfig=[(0,M.__assign)((0,M.__assign)({},this.columnsConfig[this.ValueColumnIndex]),{formatString:n}),this.columnsConfig[1]]},o.ErrorIcon="pbi-glyph-blocked2",o.GridColumnWidthInPx=200,o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Hn.so),e.\u0275\u0275directiveInject(Hn.WI),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(Fn.y0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-values-editor"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(hr.oY,5),e.\u0275\u0275viewQuery(xe,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.gridEditor=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.formatSwitchCellTemplate=a.first)}},decls:27,vars:29,consts:[[3,"viewModel",4,"ngIf"],[1,"title"],["mat-icon-button","",1,"pbi-icon-button",3,"click"],["class","glyph-small","fontIcon","pbi-glyph-fullscreen",4,"ngIf"],["class","glyph-small","fontIcon","pbi-glyph-fullscreenexit",4,"ngIf"],[1,"values-editor-value-formatting-box"],[1,"goals-value-formatting",3,"formatString","dataType","formatStringChange"],["class","pbi-spinner-large",4,"ngIf","ngIfElse"],["showGrid",""],[1,"actions"],[1,"pbi-fluent-button","primary",3,"disabled","click"],[1,"pbi-fluent-button","secondary",3,"click"],[3,"viewModel"],["fontIcon","pbi-glyph-fullscreen",1,"glyph-small"],["fontIcon","pbi-glyph-fullscreenexit",1,"glyph-small"],[1,"pbi-spinner-large"],[1,"grid-container"],[3,"rows","columns","rowsChange"],["gridEditor",""]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,ja,1,1,"message-banner",0),e.\u0275\u0275elementStart(1,"header")(2,"div",1),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(){return i.toggleFullScreen()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,$a,1,0,"mat-icon",3),e.\u0275\u0275template(8,Qa,1,0,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"section"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",5)(13,"value-formatting",6),e.\u0275\u0275listener("formatStringChange",function(c){return i.valueFormatStringChanged(c)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,Ka,1,0,"pbi-spinner",7),e.\u0275\u0275template(15,Xa,3,2,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(17,"format-switch-cell-template"),e.\u0275\u0275elementStart(18,"div",9)(19,"button",10),e.\u0275\u0275listener("click",function(){return i.onDone()}),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"button",11),e.\u0275\u0275listener("click",function(){return i.close()}),e.\u0275\u0275pipe(24,"localize"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(16);e.\u0275\u0275property("ngIf",i.messageBanner),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,15,"Metrics_Values_Editor_Title")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,17,"Fullscreen_Toggle")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.isFullScreen),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isFullScreen),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,19,"Metrics_Values_Editor_Description"),"\n"),e.\u0275\u0275advance(3),e.\u0275\u0275property("formatString",i.columnsConfig[0].formatString)("dataType",i.resultType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.gridData)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",!i.gridData),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(20,21,"Done_ButtonText")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,23,"Done_ButtonText")," "),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(24,25,"PBI_Button_Label_Cancel")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,27,"PBI_Button_Label_Cancel")," ")}},dependencies:[F.NgIf,vn.Hw,we.A,cr.k,Nn.d,Gt.o,xe,Bt.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}[_nghost-%COMP%]     .values-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}header[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-dark-color, #201F1E);display:flex;flex-direction:row;align-items:center;justify-content:space-between}header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}header[_ngcontent-%COMP%], section[_ngcontent-%COMP%], tri-grid[_ngcontent-%COMP%], .values-editor-value-formatting-box[_ngcontent-%COMP%]{margin-bottom:16px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:end;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin:5px 5px 0 0}.pbi-spinner-large[_ngcontent-%COMP%]{height:100%}.grid-container[_ngcontent-%COMP%]{flex-grow:1}'],changeDetection:0}),o}(),tn=function(){function o(n){this.dialogService=n}return o.prototype.launchTargetsEditor=function(n,t,i){this.dialogService.open(la,{width:"70%",height:"80%",maxWidth:"100%",maxHeight:"100%",autoFocus:!1,data:{goal$:(0,me.of)(n),goalTargets$:t,onDoneCallback:i}})},o.prototype.launchValuesEditor=function(n,t,i){this.dialogService.open(ca,{width:"70%",height:"80%",maxWidth:"100%",maxHeight:"100%",autoFocus:!1,data:{goal$:(0,me.of)(n),goalValues$:t,onDoneCallback:i}})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(hn.x))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),rn=m(56083),Al=function(){function o(n,t){this.localizationService=n,this.tutorialPopupService=t}return o.prototype.startFirstGoalTutorial=function(){this.tutorialPopupService.startTutorial(this.createFirstGoalTutorialModel())},o.prototype.createFirstGoalTutorialModel=function(){var n,t="ScorecardTutorialFirstGoalName",i="ScorecardTutorialFirstGoalCurrent",a="ScorecardTutorialFirstGoalTarget";return{isSequentialTutorial:!0,itemKeys:[t,i,a],items:(n={},n[t]={title:this.localizationService.get("ScorecardTutorial_MetricName_Title"),text:this.localizationService.get("ScorecardTutorial_MetricName_Text"),buttonLabel:this.localizationService.get("TutorialPopup_Next"),dataStoreKey:t,canShow:function(){return $(ne.gT.ScorecardTutorial_FirstGoalNameSelector).length>0},attachTo:function(){return $(ne.gT.ScorecardTutorial_FirstGoalNameSelector)},offset:{top:0,left:-10}},n[i]={title:this.localizationService.get("ScorecardTutorial_MetricCurrent_Title"),text:this.localizationService.get("ScorecardTutorial_MetricCurrent_Text"),buttonLabel:this.localizationService.get("TutorialPopup_Next"),dataStoreKey:i,canShow:function(){return $(ne.gT.ScorecardTutorial_FirstGoalCurrentSelector).length>0},attachTo:function(){return $(ne.gT.ScorecardTutorial_FirstGoalCurrentSelector)},offset:{top:0,left:-10}},n[a]={title:this.localizationService.get("ScorecardTutorial_MetricTarget_Title"),text:this.localizationService.get("ScorecardTutorial_MetricTarget_Text"),buttonLabel:this.localizationService.get("Done_ButtonText"),dataStoreKey:a,canShow:function(){return $(ne.gT.ScorecardTutorial_FirstGoalTargetSelector).length>0},attachTo:function(){return $(ne.gT.ScorecardTutorial_FirstGoalTargetSelector)},offset:{top:0,left:-10}},n)}},o.prototype.startGoalRollupsTutorial=function(){this.tutorialPopupService.startTutorial(this.createGoalRollupsTutorialModel())},o.prototype.createGoalRollupsTutorialModel=function(){var n,t="GoalRollupsTutorial",i=ne.gT.ScorecardTutorial_GoalRollupSelector;return{itemKeys:[t],items:(n={},n[t]={title:this.localizationService.get("TutorialPopup_MetricsRollupsTitle"),text:this.localizationService.get("TutorialPopup_MetricsRollupsContent"),buttonLabel:this.localizationService.get("TutorialPopup_GotIt"),dataStoreKey:t,canShow:function(){return!!$(i)},attachTo:function(){return $(i)},preferredOrientation:"bottom",telemetryEventArgs:[E],customClass:"goal-rollups-tutorial"},n)}},o.prototype.startGoalRollupsDetailsPaneTutorial=function(){this.tutorialPopupService.startTutorial(this.createGoalRollupsDetailsPaneTutorialModel())},o.prototype.createGoalRollupsDetailsPaneTutorialModel=function(){var n,t="GoalRollupsDetailsPaneTutorial",i=ne.gT.ScorecardTutorial_GoalRollupDetailsPaneSelector;return{itemKeys:[t],items:(n={},n[t]={title:this.localizationService.get("TutorialPopup_MetricsRollupsTitle_DetailsPane"),text:this.localizationService.get("TutorialPopup_MetricsRollupsContent_DetailsPane"),buttonLabel:this.localizationService.get("TutorialPopup_GotIt"),dataStoreKey:t,canShow:function(){return!!$(i)},attachTo:function(){return $(i)},learnMoreText:this.localizationService.get("LearnMore"),learnMoreUrl:"https://learn.microsoft.com/en-us/power-bi/create-reports/service-metrics-submetrics#get-started-creating-rollups",preferredOrientation:"right",telemetryEventArgs:[U],customClass:"show-goal-rollups-coachmark"},n)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Vt.o),e.\u0275\u0275inject(rn.yU))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),ac=function(n){return{isNew:n}};function sc(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(2,ac,t.goal.isNew&&!t.selectedValue)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.currentStatus)}}function lc(o,n){1&o&&e.\u0275\u0275element(0,"tri-svg-icon",16),2&o&&e.\u0275\u0275property("name","link_20_regular")}var wl=function(n){return{selected:n}};function cc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onValueSelect(l.allGoalValueOptions[2].value))}),e.\u0275\u0275element(1,"tri-svg-icon",7),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!i.capabilities.selectMultiple)("ngClass",e.\u0275\u0275pureFunction1(5,wl,(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[2].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[2].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.allGoalValueOptions[2].displayName," ")}}function uc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onValueSelect(l.allGoalValueOptions[1].value))}),e.\u0275\u0275element(1,"tri-svg-icon",18),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!i.capabilities.selectConnect),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,3,"Rollups_Connect_Edit")," ")}}function dc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onValueSelect(l.allGoalValueOptions[2].value))}),e.\u0275\u0275element(1,"tri-svg-icon",18),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!i.capabilities.selectMultiple),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,3,i.isGoalCurrentValuePicker?"Rollups_Multiple_Values_Edit":"Rollups_Multiple_Targets_Edit")," ")}}function pc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",17),e.\u0275\u0275listener("click",function(){var p=e.\u0275\u0275restoreView(t).$implicit,y=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(y.onSelectRollup(p))}),e.\u0275\u0275element(2,"tri-svg-icon",19),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!a.capabilities.selectRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==a.selectedValue?null:a.selectedValue.rollupType)===i?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.metricRollupDisplayNames[i]," ")}}var Rl=function(){function o(n,t,i){this.localizationService=n,this.changeDetector=t,this.goalsTutorialService=i,this.onCurrentSelection=new e.EventEmitter,this.MetricRollupOptions=[1,2,4,3],this.isSelected=!1,this.isSubmetricSelected=!1,this.capabilities={},this.allGoalValueOptions=[],this.metricRollupDisplayNames={},this.setOptions()}return o.prototype.ngOnInit=function(){this.isGoalCurrentValuePicker=1===this.goalValueType},o.prototype.ngOnChanges=function(n){var t,i;if(n.goal&&(this.isCategorical=!!this.goal.valuesCategoryId,this.showGoalRollupsCoachmark&&this.goalsTutorialService.startGoalRollupsTutorial()),n.goalCapabilities&&(this.capabilities={editCalculation:this.goalCapabilities.editCalculationType,selectManual:!0,selectRollup:this.goalCapabilities.usePickerRollup,selectConnect:this.isGoalCurrentValuePicker?this.goalCapabilities.connectCurrentValueToData:this.goalCapabilities.connectTargetValueToData,selectMultiple:this.isGoalCurrentValuePicker?this.goalCapabilities.editMultipleValues:this.goalCapabilities.editMultipleTargets}),n.currentGoalValueTypeSelection){if(_.isUndefined(null===(i=null===(t=n.currentGoalValueTypeSelection)||void 0===t?void 0:t.currentValue)||void 0===i?void 0:i.rollupType))this.isSubmetricSelected=!1,this.selectedValue=n.currentGoalValueTypeSelection.currentValue,this.currentStatus=void 0===this.selectedValue?this.localizationService.get("Set_Up"):this.allGoalValueOptions[n.currentGoalValueTypeSelection.currentValue.type].buttonText;else{this.isSubmetricSelected=!0,this.selectedValue=n.currentGoalValueTypeSelection.currentValue;var a=Mi(n.currentGoalValueTypeSelection.currentValue.rollupType);this.selectedValue.rollupType=a,this.currentStatus=void 0===this.selectedValue?this.localizationService.get("Set_Up"):this.metricRollupDisplayNames[a]}this.changeDetector.markForCheck()}},o.prototype.setOptions=function(){this.metricRollupDisplayNames=Go(this.localizationService),this.allGoalValueOptions=[{displayName:this.localizationService.get("Rollups_Manual_Metric"),value:{type:0},buttonText:this.localizationService.get("Rollups_Manual")},{displayName:this.localizationService.get("Rollups_Connect_To_Data"),value:{type:1},buttonText:""},{displayName:this.localizationService.get("Rollups_Multiple_Targets"),value:{type:2},buttonText:this.localizationService.get("Rollups_Multiple")}]},o.prototype.onValueSelect=function(n){this.onCurrentSelection.emit(n)},o.prototype.onSelectRollup=function(n){this.onCurrentSelection.emit({type:4,rollupType:n})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Al))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-value-type-picker"]],inputs:{goal:"goal",hasMultipleTargets:"hasMultipleTargets",goalValueType:"goalValueType",currentGoalValueTypeSelection:"currentGoalValueTypeSelection",goalCapabilities:"goalCapabilities",showGoalRollupsCoachmark:"showGoalRollupsCoachmark"},outputs:{onCurrentSelection:"onCurrentSelection"},features:[e.\u0275\u0275NgOnChangesFeature],decls:26,vars:35,consts:[["mat-button","","cdkMonitorElementFocus","","data-testid","goal-value-input-menu-btn",1,"goal-value-input-menu-trigger",3,"matMenuTriggerFor","disabled"],[3,"ngClass",4,"ngIf"],[3,"name",4,"ngIf"],[1,"chevron-down",3,"name"],["xPosition","before",1,"goal-value-input-menu",3,"overlapTrigger"],["goalValueInputMenu","matMenu"],["mat-menu-item","",3,"disabled","ngClass","click"],[1,"margin-right",3,"ngClass","name"],["mat-menu-item","",1,"goal-value-input-sub-menu-button","submetrics-menu-trigger",3,"disabled","matMenuTriggerFor"],["name","chevronrightmedium","size","mini"],["mat-menu-item","",3,"disabled","ngClass","click",4,"ngIf"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],[1,"goal-value-input-sub-menu",3,"overlapTrigger"],["goalValueInputRollupsMenu","matMenu"],[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"name"],["mat-menu-item","",3,"disabled","click"],[1,"margin-right",3,"name"],[1,"margin-right-sub-menu",3,"ngClass","name"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275template(2,sc,2,4,"span",1),e.\u0275\u0275template(3,lc,1,1,"tri-svg-icon",2),e.\u0275\u0275element(4,"tri-svg-icon",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-menu",4,5)(7,"button",6),e.\u0275\u0275listener("click",function(){return i.onValueSelect(i.allGoalValueOptions[0].value)}),e.\u0275\u0275element(8,"tri-svg-icon",7),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"button",8)(11,"div"),e.\u0275\u0275element(12,"tri-svg-icon",7),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(15,"pbi-icon",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"button",6),e.\u0275\u0275listener("click",function(){return i.onValueSelect(i.allGoalValueOptions[1].value)}),e.\u0275\u0275element(17,"tri-svg-icon",7),e.\u0275\u0275text(18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,cc,3,7,"button",10),e.\u0275\u0275element(20,"mat-divider"),e.\u0275\u0275template(21,uc,4,5,"button",11),e.\u0275\u0275template(22,dc,4,5,"button",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-menu",12,13),e.\u0275\u0275template(25,pc,4,4,"ng-container",14),e.\u0275\u0275elementEnd()),2&t){var c,a=e.\u0275\u0275reference(6),l=e.\u0275\u0275reference(24);e.\u0275\u0275property("matMenuTriggerFor",a)("disabled",!i.capabilities.editCalculation),e.\u0275\u0275attribute("aria-label",null!==(c=i.currentStatus)&&void 0!==c?c:e.\u0275\u0275pipeBind1(1,27,"Set_Up")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==i.selectedValue?null:i.selectedValue.type)!==i.allGoalValueOptions[1].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[1].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","chevron_down_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",!i.capabilities.selectManual||!i.isGoalCurrentValuePicker&&i.hasMultipleTargets)("ngClass",e.\u0275\u0275pureFunction1(31,wl,(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[0].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[0].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.allGoalValueOptions[0].displayName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!i.capabilities.selectRollup)("matMenuTriggerFor",l),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",i.isSubmetricSelected?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,29,"Rollups_Use_Submetrics")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",!i.capabilities.selectConnect)("ngClass",e.\u0275\u0275pureFunction1(33,wl,(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[1].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[1].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.allGoalValueOptions[1].displayName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.isGoalCurrentValuePicker),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!i.goal.valueConnection&&i.isGoalCurrentValuePicker||!!i.goal.targetConnection&&!i.isGoalCurrentValuePicker),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.isCategorical&&i.isGoalCurrentValuePicker&&(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[0].value.type||!i.isGoalCurrentValuePicker&&(null==i.selectedValue?null:i.selectedValue.type)===i.allGoalValueOptions[2].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.MetricRollupOptions)}},dependencies:[F.NgClass,F.NgForOf,F.NgIf,Ei.d,Jt.W0,Jt.tN,Jt.D8,Dn._,Er.M,Bt.F],styles:['.goal-value-input-menu-trigger[_ngcontent-%COMP%]{padding:6px 8px;width:100%;background:none;border:1px solid var(--gray-110, #8A8886);border-radius:2px;display:flex;flex-direction:row}.goal-value-input-menu-trigger[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}.goal-value-input-menu-trigger[_ngcontent-%COMP%]:active, .goal-value-input-menu-trigger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--gray-88, #E0E0E0)}.goal-value-input-menu-trigger[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D);background-color:var(--gray-20, #F3F2F1);border-color:var(--gray-20, #F3F2F1)}button[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);color:var(--fluent-theme-neutral-primary-color, #323130);padding:6px 12px;height:32px}button[_ngcontent-%COMP%]   .isNew[_ngcontent-%COMP%]{color:var(--fluent-theme-link-darker-color, #005A9E)}button[_ngcontent-%COMP%]   tri-svg-icon.chevron-down[_ngcontent-%COMP%]{height:16px;width:16px;margin:2px;padding-left:4px}button[_ngcontent-%COMP%]   tri-svg-icon.margin-right[_ngcontent-%COMP%]{margin-right:8px}button[_ngcontent-%COMP%]   tri-svg-icon.margin-right-sub-menu[_ngcontent-%COMP%]{margin-right:6px}button[_ngcontent-%COMP%]   .show-checkmark[_ngcontent-%COMP%]{visibility:visible}button[_ngcontent-%COMP%]   .hide-checkmark[_ngcontent-%COMP%]{visibility:hidden}button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--gray-96, #F5F5F5)}button[_ngcontent-%COMP%]:disabled   tri-svg-icon[_ngcontent-%COMP%]{opacity:50%}  .goal-value-input-menu-trigger .sort-icon .mat-icon{margin:0 4px}  .mat-menu-panel.goal-value-input-sub-menu{min-height:fit-content;transform:translateY(8px);width:100px;min-width:100px}  .goal-value-input-menu .mat-menu-item{padding-left:8px}  .goal-value-input-menu .mat-menu-content{width:190px;min-width:190px}  .goal-value-input-sub-menu .mat-menu-content{width:100px;min-width:100px}  .goal-value-input-sub-menu .mat-menu-content button{width:100px;min-width:100px}  .goal-rollups-tutorial.tutorial-popup .box{background-color:var(--gray-130, #605E5C)}  .goal-rollups-tutorial.tutorial-popup .box .arrow{background-color:var(--gray-130, #605E5C)}  .goal-rollups-tutorial.tutorial-popup .box .title{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}  .goal-rollups-tutorial.tutorial-popup .box .text{margin:10px 10px 0;line-height:22px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center}.mat-menu-item[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex}.mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}.mat-menu-item.goal-value-input-sub-menu-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.mat-menu-item[_ngcontent-%COMP%]:active, .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:var(--gray-96, #F5F5F5)}.mat-menu-item[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D)}.selected[_ngcontent-%COMP%]{pointer-events:none;user-select:none;-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}'],changeDetection:0}),o}(),hc=["valueInput"],gc=["valueSelect"],fc=["targetInput"],mc=["targetSelect"],vc=["valueFormattingTmpl"],_c=["valueFormatting"];function Cc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.openGoalValuesEditor())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"Edit")))}function yc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15)(1,"input",16,17),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onCurrentValueFocus())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.save())})("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentValueChange(l))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("type",i.valueInputType),e.\u0275\u0275property("readonly",!i.capabilities.editCurrentValue||i.isValueSubmetricsSelected)("ngModel",i.valueInputValue),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,5,"CurrentValue"))("placeholder",i.displayedGoal.valueConnection||i.displayedGoal.valueRollup||i.isValueSubmetricsSelected?"-":e.\u0275\u0275pipeBind1(4,7,"Enter_Value"))}}function bc(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"option",22),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("ngValue",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function wc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",18,19),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.valueSelected=l)}),e.\u0275\u0275element(2,"option",20),e.\u0275\u0275template(3,bc,2,2,"option",21),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!i.capabilities.editCurrentValue)("ngModel",i.valueSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",null==i.goalValueCategoryLists[i.selectedCategoryListIndex]?null:i.goalValueCategoryLists[i.selectedCategoryListIndex].categories)}}function Sc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"goal-value-type-picker",23),e.\u0275\u0275listener("onCurrentSelection",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentSelectionCurrentValueChange(l))}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("canCustomizeStatus",null==i.capabilities.scorecardCapabilities?null:i.capabilities.scorecardCapabilities.customizeStatus)("goal",i.displayedGoal)("currentGoalValueTypeSelection",i.currentGoalValueTypeSelection)("goalValueType",1)("goalCapabilities",i.capabilities)("showGoalRollupsCoachmark",(null==i.displayedGoal.subGoals?null:i.displayedGoal.subGoals.length)>0&&i.capabilities.usePickerRollup)}}function Mc(o,n){1&o&&e.\u0275\u0275element(0,"span",26)}function Pc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,Mc,1,0,"span",24),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onConnectCurrentToDataClick())}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.displayedGoal.valueConnection),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",i.displayedGoal.valueConnection?"UpdateConnection":"ConnectToData")}}function Oc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.openGoalTargetsEditor())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"Edit")))}function Ec(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15)(1,"input",27,28),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onTargetValueFocus())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.save())})("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onTargetValueChange(l))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("type",i.targetInputType),e.\u0275\u0275property("readonly",!i.capabilities.editTargetValue||i.isTargetSubmetricsSelected)("ngModel",i.targetInputValue)("pbiTooltipDisabled",!(i.capabilities.supportMultipleTargetsEditing&&i.targetCount>1&&!i.displayedGoal.targetConnection&&!i.isTargetSubmetricsSelected))("pbiTooltipPosition","below"),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,7,"Target"))("placeholder",i.displayedGoal.targetConnection||i.displayedGoal.targetRollup||i.isTargetSubmetricsSelected?"-":e.\u0275\u0275pipeBind1(4,9,"Enter_A_Value"))}}function Tc(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"option",22),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("ngValue",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function xc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",29,30),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.targetSelected=l)}),e.\u0275\u0275element(2,"option",31),e.\u0275\u0275template(3,Tc,2,2,"option",21),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!i.capabilities.editTargetValue)("ngModel",i.targetSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",null==i.goalValueCategoryLists[i.selectedCategoryListIndex]?null:i.goalValueCategoryLists[i.selectedCategoryListIndex].categories)}}function Ic(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"goal-value-type-picker",32),e.\u0275\u0275listener("onCurrentSelection",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentSelectionTargetChange(l))}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("canCustomizeStatus",null==i.capabilities.scorecardCapabilities?null:i.capabilities.scorecardCapabilities.customizeStatus)("goal",i.displayedGoal)("hasMultipleTargets",i.targetCount>1)("currentGoalValueTypeSelection",i.targetGoalValueTypeSelection)("goalValueType",2)("goalCapabilities",i.capabilities)}}function Dc(o,n){1&o&&e.\u0275\u0275element(0,"span",26)}function kc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,Dc,1,0,"span",24),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onConnectTargetToDataClick())}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.displayedGoal.targetConnection),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",i.displayedGoal.targetConnection?"UpdateConnection":"ConnectToData")}}function Vc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",33,34)(2,"div",35),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"value-formatting",36),e.\u0275\u0275listener("formatStringChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.valueFormatStringChanged(l))})("onSelectedCategoryListChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.selectCategoryList(l))}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.formattedValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("formatString",i.formatString)("dataType",i.resultType)("supportCategoricalValues",i.capabilities.useCategoricalValues&&!i.isValueSubmetricsSelected&&!i.isTargetSubmetricsSelected)("goalValueCategoryLists",i.goalValueCategoryLists)("selectedCategoryListIndex",i.selectedCategoryListIndex)("launchCategoryListsEditPane",i.launchCategoryListsEditPane)}}var rr=function(o){return o[o.None=0]="None",o[o.Value=1]="Value",o[o.Target=2]="Target",o}({}),Sl=function(){function o(n,t,i,a,l,c,p,y,O,A,L){var te=this;this.elementRef=n,this.pbiOverlay=t,this.changeDetector=i,this.formatValuePipe=a,this.localizationService=l,this.detailsPaneLauncher=c,this.goalValuesEditorLauncher=p,this.dialogService=y,this.scorecardService=O,this.connectToDataDialog=A,this.scorecardSettings=L,this.currentTargetChange=new e.EventEmitter,this.currentValueChange=new e.EventEmitter,this.targetsChange=new e.EventEmitter,this.valuesChange=new e.EventEmitter,this.valueRollupsChange=new e.EventEmitter,this.targetRollupsChange=new e.EventEmitter,this.onCategoryListIdChanged=new e.EventEmitter,this.onSave=new e.EventEmitter,this.onConnectionChanged=new e.EventEmitter,this.PaddingFromComponentToEditor=4,this.GoalEditValueTooltipId="goal-edit-value-formatting",this.resultType=2,this.formatNilReturn="",this.focusedInput=rr.None,this.goalValueCategoryLists=[],this.isValueSubmetricsSelected=!1,this.isTargetSubmetricsSelected=!1,this.currentGoalValueTypeSelection=void 0,this.targetGoalValueTypeSelection=void 0,this.launchCategoryListsEditPane=function(ue){te.overlayRef&&(te.overlayRef.close(),te.overlayRef=null),te.detailsPaneLauncher.openCategoryListsEditPane(te.scorecardService,ue,function(Je){_.isEmpty(te.goalValueCategoryLists)&&(te.formatString="");var ze=te.displayedGoal.valuesCategoryId;if(ze){var ot=_.findIndex(te.goalValueCategoryLists,function(ft){return ft.id===ze});Je&&1===te.goalValueCategoryLists.length&&(ot=0),ot<0?(te.selectedCategoryListIndex=ot,te.onCategoryListIdChanged.emit(ze),te.formatGoalValues()):te.selectCategoryList(ot)}else te.selectCategoryList(ot=Je&&1===te.goalValueCategoryLists.length?0:-1)})}}return o.prototype.ngOnInit=function(){var t,i,a,l,n=this;if(this.formatString=this.displayedGoal.valuesCategoryId?Nn.d.CategoricalFormatString:this.displayedGoal.valuesFormatString,this.originalCurrentValue=this.currentValue.value,this.capabilities.useCategoricalValues&&(this.categoryListsSubscribe=this.scorecardService.getScorecard().pipe((0,G.x)(function(y,O){return _.isEqual(y.goalValueCategories,O.goalValueCategories)})).subscribe(function(){var y;n.goalValueCategoryLists=n.scorecardService.getGoalValueCategoryLists(n.displayedGoal),n.selectedCategoryListIndex=null!==(y=_.findIndex(n.goalValueCategoryLists,function(O){return O.id===n.displayedGoal.valuesCategoryId}))&&void 0!==y?y:-1})),this.capabilities.supportMultipleTargetsEditing&&!this.displayedGoal.targetConnection){var c;c=this.displayedGoal.isNew?0:null!==(a=null===(i=null===(t=this.displayedGoal.aggregations)||void 0===t?void 0:t.find(function(y){return"NumberOfTargets"===y.type}))||void 0===i?void 0:i.value)&&void 0!==a?a:0,this.targetCount=Math.max(c,1)}if(_.isUndefined(null===(l=this.displayedGoal.metadata)||void 0===l?void 0:l.showFinalTarget)&&this.capabilities.supportMultipleTargetsEditing){var p=!this.displayedGoal.targetConnection;this.displayedGoal.metadata?this.displayedGoal.metadata.showFinalTarget=p:this.displayedGoal.metadata={showFinalTarget:p}}this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection(void 0,1),this.updateCurrentGoalValueTypeSelection(void 0,2)},o.prototype.save=function(){this.onSave.emit()},o.prototype.onCurrentSelectionCurrentValueChange=function(n){var t;return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(i){return this.isValueSubmetricsSelected=null!==(t=!_.isUndefined(n.rollupType))&&void 0!==t&&t,1!==n.type&&this.displayedGoal.valueConnection&&(this.displayedGoal.valueConnection=void 0,this.onConnectionChanged.emit()),_.isUndefined(n.rollupType)?2===n.type?(this.displayedGoal.valueRollup=void 0,this.openGoalValuesEditor()):1===n.type?this.onConnectCurrentToDataClick():this.displayedGoal.valueRollup=void 0:(this.currentValue=(0,M.__assign)((0,M.__assign)({},this.currentValue),{value:null}),this.currentValueChange.emit(this.currentValue),this.formatGoalValues()),this.changeDetector.detectChanges(),this.valueRollupsChange.emit({rollupType:n.rollupType,type:n.type}),this.updateCurrentGoalValueTypeSelection(n,1),[2]})})},o.prototype.onCurrentSelectionTargetChange=function(n){var t;return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(i){return this.isTargetSubmetricsSelected=null!==(t=!_.isUndefined(n.rollupType))&&void 0!==t&&t,1!==n.type&&this.displayedGoal.targetConnection&&(this.displayedGoal.targetConnection=void 0,this.onConnectionChanged.emit()),_.isUndefined(n.rollupType)?2===n.type?this.openGoalTargetsEditor():1===n.type?this.onConnectTargetToDataClick():this.displayedGoal.targetRollup=void 0:(this.currentTarget=(0,M.__assign)((0,M.__assign)({},this.currentTarget),{target:null}),this.currentTargetChange.emit(this.currentTarget),this.formatGoalValues()),this.changeDetector.detectChanges(),this.targetRollupsChange.emit({rollupType:n.rollupType,type:n.type}),this.updateCurrentGoalValueTypeSelection(n,2),[2]})})},o.prototype.updateCurrentGoalValueTypeSelection=function(n,t){var i,a,l,c,p,y;2===t?this.targetGoalValueTypeSelection=this.displayedGoal.targetConnection?{type:1}:this.isTargetSubmetricsSelected||_.isNil(n)&&!_.isNil(null===(i=this.displayedGoal)||void 0===i?void 0:i.targetRollup)?{type:4,rollupType:null!==(a=n?.rollupType)&&void 0!==a?a:null===(l=this.displayedGoal.targetRollup)||void 0===l?void 0:l.rollupType}:this.targetCount>1?{type:2}:this.displayedGoal.isNew&&void 0===n?void 0:{type:0}:this.currentGoalValueTypeSelection=this.displayedGoal.valueConnection?{type:1}:this.isValueSubmetricsSelected||_.isNil(n)&&!_.isNil(null===(c=this.displayedGoal)||void 0===c?void 0:c.valueRollup)?{type:4,rollupType:null!==(p=n?.rollupType)&&void 0!==p?p:null===(y=this.displayedGoal.valueRollup)||void 0===y?void 0:y.rollupType}:this.displayedGoal.isNew&&void 0===n?void 0:{type:0}},o.prototype.ngOnDestroy=function(){this.overlayRef&&(this.overlayRef.close(),this.overlayRef=null),this.connectToDataDialog.close(),this.categoryListsSubscribe&&this.categoryListsSubscribe.unsubscribe()},o.prototype.onConnectCurrentToDataClick=function(){var n=this;this.detailsPaneLauncher.closeGoalDetails(),this.getDialogConfig(1).then(function(t){n.connectToDataDialog.open(t).pipe((0,Me.q)(1)).subscribe(function(i){var a;if(i){var c=(0,M.__rest)(i,["previewResult"]);n.displayedGoal.valueConnection=c;var p=(a=gn.getPreviewValue(i.previewResult)).value;n.valueFormatStringChanged(a.formatString),n.currentValue=(0,M.__assign)((0,M.__assign)({},n.currentValue),{value:p}),n.currentValueChange.emit(n.currentValue),n.capabilities.supportMultipleValuesEditing&&(n.values=void 0,n.valuesChange.emit(n.values)),n.formatGoalValues(),n.updateCurrentGoalValueTypeSelection({type:1},1),n.onConnectionChanged.emit(),n.changeDetector.detectChanges()}})})},o.prototype.onConnectTargetToDataClick=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return this.detailsPaneLauncher.closeGoalDetails(),this.capabilities.supportMultipleTargetsEditing&&!this.displayedGoal.targetConnection&&(this.targetCount>1||null!=this.currentTarget.target)?[4,this.dialogService.showConfirmationDialog({title:this.localizationService.get("Metrics_Switch_To_Connected_Data"),message:this.localizationService.get("Metrics_Switch_To_Connected_Data_Multiple_Goal_Targets"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue")}).afterClosed().toPromise()]:[3,2];case 1:if(1!==a.sent())return[2];a.label=2;case 2:return this.getDialogConfig(2).then(function(l){i.connectToDataDialog.open(l).pipe((0,Me.q)(1)).subscribe(function(c){var p,y;if(c){var A=(0,M.__rest)(c,["previewResult"]);i.displayedGoal.targetConnection=A;var L=(p=gn.getPreviewValue(c.previewResult)).value;i.valueFormatStringChanged(p.formatString),i.currentTarget=(0,M.__assign)((0,M.__assign)({},i.currentTarget),{target:L}),i.currentTargetChange.emit(i.currentTarget),i.capabilities.supportMultipleTargetsEditing&&(i.targets=void 0,i.targetsChange.emit(i.targets),i.targetCount=void 0,null!==(y=i.displayedGoal)&&void 0!==y&&y.metadata?i.displayedGoal.metadata.showFinalTarget=!1:i.displayedGoal.metadata={showFinalTarget:!1}),i.formatGoalValues(),i.updateCurrentGoalValueTypeSelection({type:1},2),i.onConnectionChanged.emit(),i.changeDetector.detectChanges()}})}),[2]}})})},o.prototype.onCurrentValueFocus=function(){this.focusedInput!==rr.Value&&(this.focusedInput=rr.Value,this.formatGoalValues(),this.valueInput.nativeElement.click()),this.capabilities.changeValueFormat&&null==this.overlayRef&&this.openValueFormattingPane()},o.prototype.onTargetValueFocus=function(){this.focusedInput!==rr.Target&&(this.focusedInput=rr.Target,this.formatGoalValues(),this.targetInput.nativeElement.click()),this.capabilities.changeValueFormat&&null==this.overlayRef&&this.openValueFormattingPane()},o.prototype.valueFormatStringChanged=function(n){var t=this.formatString===Nn.d.CategoricalFormatString;this.formatString=n,this.displayedGoal.valuesFormatString=n===Nn.d.CategoricalFormatString?"":n??"",t&&this.formatString!==Nn.d.CategoricalFormatString&&this.onCategoryListIdChanged.emit(null),this.formatGoalValues()},o.prototype.isCategoricalValue=function(n){var t,i;return this.isCategoricalFormat&&this.selectedCategoryListIndex>=0&&this.selectedCategoryListIndex<(null===(t=this.goalValueCategoryLists)||void 0===t?void 0:t.length)&&(null===(i=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===i?void 0:i.categories.length)>n},o.prototype.onCurrentValueChange=function(n){var t=this,i=_.isNil(n)||""===n?null:+n;this.currentValue=(0,M.__assign)((0,M.__assign)({},this.currentValue),{value:i}),this.currentValueChange.emit(this.currentValue),this.currentGoalValueTypeSelection={type:0},this.capabilities.supportMultipleValuesEditing&&this.values&&(this.values=(0,bt.ZP)(this.values,function(a){var l=a.find(function(c){return new Date(c.timestamp).getTime()===new Date(t.currentValue.timestamp).getTime()});l?l.value=t.currentValue.value:a.push(t.currentValue)}),this.valuesChange.emit(this.values)),this.formatGoalValues()},o.prototype.onTargetValueChange=function(n){var t=this,i=_.isNil(n)||""===n?null:+n;this.currentTarget=(0,M.__assign)((0,M.__assign)({},this.currentTarget),{target:i}),this.currentTargetChange.emit(this.currentTarget),this.targetGoalValueTypeSelection={type:0},this.capabilities.supportMultipleTargetsEditing&&this.targets&&(u.fF.assert(function(){return t.targetCount<=1&&t.targets.length<=1},"Inline target editor should only be enabled if there's at most one target!"),this.targets=[this.currentTarget],this.targetsChange.emit(this.targets)),this.formatGoalValues()},o.prototype.openGoalTargetsEditor=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,i=this;return(0,M.__generator)(this,function(a){return u.fF.assertValue(_.isNil(this.displayedGoal.targetConnection),"Targets can only be edited if there is no target connection"),n=this.getGoalTargets(),this.goalValuesEditorLauncher.launchTargetsEditor(this.displayedGoal,n,function(c,p,y){return(0,M.__awaiter)(i,void 0,void 0,function(){var O,A;return(0,M.__generator)(this,function(L){return c.length>0?(c.sort(function(te,ue){return new Date(te.timestamp).getTime()-new Date(ue.timestamp).getTime()}),this.currentTarget=p?Ke.r.calculateFinalTarget(c):Ke.r.calculateNextTarget(c),this.targets=c):((O=se.E.getCurrentLocalDay()).setMonth(O.getMonth()+1),this.currentTarget={timestamp:O.toISOString(),target:null},this.targets=[this.currentTarget]),this.currentTargetChange.emit(this.currentTarget),this.targetsChange.emit(this.targets),null!==(A=this.displayedGoal)&&void 0!==A&&A.metadata?this.displayedGoal.metadata.showFinalTarget=p:this.displayedGoal.metadata={showFinalTarget:p},this.targetCount=c.length,this.formatString=y,this.displayedGoal.valuesFormatString=y,this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection({type:2},2),[2]})})}),[2]})})},o.prototype.openGoalValuesEditor=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,i=this;return(0,M.__generator)(this,function(a){return u.fF.assertValue(_.isNil(this.displayedGoal.valueConnection),"Values can only be edited if there is no value connection"),n=this.getGoalValues(),this.goalValuesEditorLauncher.launchValuesEditor(this.displayedGoal,n,function(c,p){return(0,M.__awaiter)(i,void 0,void 0,function(){return(0,M.__generator)(this,function(y){return c.length>0?(c.sort(function(O,A){return new Date(O.timestamp).getTime()-new Date(A.timestamp).getTime()}),this.currentValue=(0,M.__assign)((0,M.__assign)({},this.currentValue),{value:Ke.r.calculateCurrentValue(c)}),this.values=c):(this.currentValue=(0,M.__assign)((0,M.__assign)({},this.currentValue),{value:null}),this.values=[this.currentValue]),this.currentValueChange.emit(this.currentValue),this.valuesChange.emit(this.values),this.formatString=p,this.displayedGoal.valuesFormatString=p,this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection({type:0},1),[2]})})}),[2]})})},o.prototype.getGoalTargets=function(){var t,i,n=this;return this.displayedGoal.isNew||this.targets?i=(0,me.of)(null!==(t=this.targets)&&void 0!==t?t:[]):(this.scorecardService.expandGoalValues(this.displayedGoal.id,!1),i=this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,On.h)(function(a){return a.isExpanded}),(0,dt.U)(function(a){var l;return null!==(l=a.goalValues)&&void 0!==l?l:[]}),(0,dt.U)(function(a){return a.filter(function(l){return!_.isNil(l.target)})}))),i.pipe((0,dt.U)(function(a){return(0,bt.ZP)(a,function(l){if(!_.isNil(n.targetCount)&&n.targetCount<=1){u.fF.assert(function(){return l.length<=1},"Inline target editor should only be enabled if there's at most one target!");var c=l.find(function(p){return new Date(p.timestamp).getTime()===new Date(n.currentTarget.timestamp).getTime()});c?c.target=n.currentTarget.target:l.push(n.currentTarget)}})}),(0,dt.U)(function(a){return(0,bt.ZP)(a,function(l){l.sort(function(c,p){return new Date(c.timestamp).getTime()-new Date(p.timestamp).getTime()})})}))},o.prototype.getGoalValues=function(){var t,i,n=this;return this.displayedGoal.isNew||this.values?i=(0,me.of)(null!==(t=this.values)&&void 0!==t?t:[]):(this.scorecardService.expandGoalValues(this.displayedGoal.id,!1),i=this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,On.h)(function(a){return a.isExpanded}),(0,dt.U)(function(a){var l;return null!==(l=a.goalValues)&&void 0!==l?l:[]}),(0,dt.U)(function(a){return a.filter(function(l){return!_.isNil(l.value)})}))),i.pipe((0,dt.U)(function(a){return(0,bt.ZP)(a,function(l){var c=l.find(function(p){return new Date(p.timestamp).getTime()===new Date(n.currentValue.timestamp).getTime()});c?c.value=n.currentValue.value:n.originalCurrentValue!==n.currentValue.value&&l.push(n.currentValue)})}),(0,dt.U)(function(a){return(0,bt.ZP)(a,function(l){l.sort(function(c,p){return new Date(c.timestamp).getTime()-new Date(p.timestamp).getTime()})})}))},o.prototype.onMouseClick=function(n){var t,i,a,l,c,p,y,O,A=n?.target;return null!==(t=this.valueSelect)&&void 0!==t&&t.nativeElement.contains(A)?(this.focusedInput!==rr.Value&&(this.focusedInput=rr.Value,this.formatGoalValues()),void(this.overlayRef||this.openValueFormattingPane())):null!==(i=this.targetSelect)&&void 0!==i&&i.nativeElement.contains(A)?(this.focusedInput!==rr.Target&&(this.focusedInput=rr.Target,this.formatGoalValues()),void(this.overlayRef||this.openValueFormattingPane())):void(null!==(a=this.valueInput)&&void 0!==a&&a.nativeElement.contains(A)||null!==(l=this.targetInput)&&void 0!==l&&l.nativeElement.contains(A)||null!==(p=null===(c=this.valueFormatting)||void 0===c?void 0:c.nativeElement)&&void 0!==p&&p.contains(A)||A.classList.contains("mat-option-text")||A.classList.contains("pbi-menu-item")||null!==(y=this.valueInput)&&void 0!==y&&y.nativeElement.contains(document.activeElement)||null!==(O=this.targetInput)&&void 0!==O&&O.nativeElement.contains(document.activeElement)||(this.focusedInput!==rr.None&&(this.focusedInput=rr.None,this.formatGoalValues()),this.overlayRef&&(this.overlayRef.close(),this.overlayRef=null)))},o.prototype.selectCategoryList=function(n){var t;this.selectedCategoryListIndex=n,this.onCategoryListIdChanged.emit(null===(t=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===t?void 0:t.id),this.formatGoalValues()},Object.defineProperty(o.prototype,"valueSelected",{get:function(){return this.isCategoricalValue(this.currentValue.value)?this.currentValue.value:void 0},set:function(t){var i=this;this.currentValue=(0,M.__assign)((0,M.__assign)({},this.currentValue),{value:t}),this.currentValueChange.emit(this.currentValue),this.capabilities.supportMultipleValuesEditing&&this.values&&(this.values=(0,bt.ZP)(this.values,function(a){var l=a.find(function(c){return new Date(c.timestamp).getTime()===new Date(i.currentValue.timestamp).getTime()});l?l.value=i.currentValue.value:a.push(i.currentValue)}),this.valuesChange.emit(this.values)),this.formatGoalValues()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"targetSelected",{get:function(){return this.isCategoricalValue(this.currentTarget.target)?this.currentTarget.target:void 0},set:function(t){var i=this,a=t;this.currentTarget=(0,M.__assign)((0,M.__assign)({},this.currentTarget),{target:a}),this.currentTargetChange.emit(this.currentTarget),this.capabilities.supportMultipleTargetsEditing&&this.targets&&(u.fF.assert(function(){return i.targetCount<=1&&i.targets.length<=1},"Inline target editor should only be enabled if there's at most one target!"),this.targets=[this.currentTarget],this.targetsChange.emit(this.targets)),this.formatGoalValues()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isCategoricalFormat",{get:function(){return this.formatString===Nn.d.CategoricalFormatString},enumerable:!1,configurable:!0}),o.prototype.openValueFormattingPane=function(){var n=this.pbiOverlay.position().flexibleConnectedTo(this.elementRef.nativeElement).withPositions([(0,he.xe)(0,-this.PaddingFromComponentToEditor)]).withPush(!0).withGrowAfterOpen(!0);this.overlayRef=this.pbiOverlay.open({component:nr.i,data:{id:this.GoalEditValueTooltipId,templateRef:this.valueFormattingTmpl},options:{positionStrategy:n,hasBackdrop:!1,disposeOnNavigation:!0},hasCaret:!1,focusElementOnClose:null,disableCloseOnEsc:!0,disableFocusTrapSetting:{disable:!0}}),this.overlayRef.componentRef.changeDetectorRef.detectChanges()},o.prototype.formatValue=function(n){var t,i;return this.formatString!==Nn.d.CategoricalFormatString?this.formatValuePipe.transform(n,this.formatString,!0,this.formatNilReturn):this.isCategoricalValue(n)?null===(i=null===(t=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===t?void 0:t.categories[n])||void 0===i?void 0:i.displayName:void 0},o.prototype.formatGoalValues=function(){var n,t,i,a,l=this.focusedInput===rr.Value&&this.capabilities.editCurrentValue,c=this.focusedInput===rr.Target&&this.capabilities.editTargetValue;this.valueInputType=l?"number":"text",this.targetInputType=c?"number":"text",this.valueInputValue=l?null!==(t=null===(n=this.currentValue.value)||void 0===n?void 0:n.toString())&&void 0!==t?t:"":this.formatValue(this.currentValue.value),this.targetInputValue=c?null!==(a=null===(i=this.currentTarget.target)||void 0===i?void 0:i.toString())&&void 0!==a?a:"":this.formatValue(this.currentTarget.target),this.formattedValue="",this.focusedInput===rr.Value&&(this.formattedValue=this.formatValue(this.currentValue.value)),this.focusedInput===rr.Target&&(this.formattedValue=this.formatValue(this.currentTarget.target))},o.prototype.getDialogConfig=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,M.__generator)(this,function(c){switch(c.label){case 0:return i={data:{}},(a=1===n?this.displayedGoal.valueConnection:this.displayedGoal.targetConnection)&&(i.data.reportUrl=a.reportUrl,a.shouldClearGoalValues&&(i.data.banner={bannerType:2,iconName:"pbi-glyph-info",message:this.localizationService.get("Metric_Clear_Values_On_New_Connection_Warning")})),this.scorecardSettings?[4,this.scorecardSettings.settings.pipe((0,Me.q)(1)).toPromise()]:[2,i];case 1:return c.sent().alwaysMaximize&&(i.height="100%",i.width="100%",i.hideFullscreenToggle=!0),[2,i]}})})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(He._),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(xr.c),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(tn),e.\u0275\u0275directiveInject(hn.x),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(Vn),e.\u0275\u0275directiveInject(on,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-value-input"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(hc,5),e.\u0275\u0275viewQuery(gc,5),e.\u0275\u0275viewQuery(fc,5),e.\u0275\u0275viewQuery(mc,5),e.\u0275\u0275viewQuery(vc,5,e.TemplateRef),e.\u0275\u0275viewQuery(_c,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.valueInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.valueSelect=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.targetInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.targetSelect=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.valueFormattingTmpl=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.valueFormatting=a.first)}},hostBindings:function(t,i){1&t&&e.\u0275\u0275listener("click",function(l){return i.onMouseClick(l)},!1,e.\u0275\u0275resolveDocument)},inputs:{displayedGoal:"displayedGoal",currentValue:"currentValue",capabilities:"capabilities",currentTarget:"currentTarget",targets:"targets",values:"values",goalStatuses:"goalStatuses"},outputs:{currentTargetChange:"currentTargetChange",currentValueChange:"currentValueChange",targetsChange:"targetsChange",valuesChange:"valuesChange",valueRollupsChange:"valueRollupsChange",targetRollupsChange:"targetRollupsChange",onCategoryListIdChanged:"onCategoryListIdChanged",onSave:"onSave",onConnectionChanged:"onConnectionChanged"},decls:24,vars:17,consts:[[1,"input-box-sm","right-padding","current"],[1,"value-input-title"],["localize","CurrentValue",1,"input-title"],["class","input-action-txt",4,"ngIf"],[1,"input"],["class","input-box right-margin",4,"ngIf","ngIfElse"],["selectCategoricalValue",""],[4,"ngIf"],[1,"input-box-sm","target"],[1,"target-input-title"],[1,"input-title"],["selectCategoricalTarget",""],["valueFormattingTmpl",""],[1,"input-action-txt"],[1,"link",3,"click"],[1,"input-box","right-margin"],["data-testid","current-value-input-box","step","any",3,"readonly","type","ngModel","focus","keyup.enter","ngModelChange"],["valueInput",""],["data-testid","select-categorical-value",1,"select-categorical-value",3,"disabled","ngModel","ngModelChange"],["valueSelect",""],["value","","selected","!valueSelected","hidden","!!valueSelected}}"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"canCustomizeStatus","goal","currentGoalValueTypeSelection","goalValueType","goalCapabilities","showGoalRollupsCoachmark","onCurrentSelection"],["localize","Logical_Or_Operator",4,"ngIf"],[1,"link",3,"localize","click"],["localize","Logical_Or_Operator"],["data-testid","target-value-input-box","step","any",3,"readonly","type","ngModel","pbiTooltipDisabled","pbiTooltipPosition","focus","keyup.enter","ngModelChange"],["targetInput",""],[1,"select-categorical-target",3,"disabled","ngModel","ngModelChange"],["targetSelect",""],["value","","selected","!targetSelected","hidden","!!targetSelected"],[3,"canCustomizeStatus","goal","hasMultipleTargets","currentGoalValueTypeSelection","goalValueType","goalCapabilities","onCurrentSelection"],["data-testid","value-formatting-box",1,"value-formatting-box"],["valueFormatting",""],[1,"result"],[1,"goals-value-formatting",3,"formatString","dataType","supportCategoricalValues","goalValueCategoryLists","selectedCategoryListIndex","launchCategoryListsEditPane","formatStringChange","onSelectedCategoryListChange"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"div",2),e.\u0275\u0275template(3,Cc,4,3,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275template(5,yc,5,9,"div",5),e.\u0275\u0275template(6,wc,4,3,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,Sc,2,6,"div",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,Pc,5,2,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",8)(11,"div",9)(12,"div",10),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,Oc,4,3,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",4),e.\u0275\u0275template(17,Ec,5,11,"div",5),e.\u0275\u0275template(18,xc,4,3,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(20,Ic,2,6,"div",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,kc,5,2,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(22,Vc,5,7,"ng-template",null,12,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(7),l=e.\u0275\u0275reference(19);e.\u0275\u0275classProp("inner-input-box-with-rollups",i.capabilities.supportsRollup),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.capabilities.supportMultipleValuesEditing&&i.capabilities.editMultipleValues&&!i.capabilities.supportsRollup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.isCategoricalFormat)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.capabilities.connectCurrentValueToData&&!i.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("inner-input-box-with-rollups",i.capabilities.supportsRollup),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(14,15,i.capabilities.supportMultipleTargetsEditing?null!=i.displayedGoal.metadata&&i.displayedGoal.metadata.showFinalTarget?"Target_Final":"Target_Next":"Target")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.capabilities.supportMultipleTargetsEditing&&i.capabilities.editMultipleTargets&&!i.capabilities.supportsRollup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.isCategoricalFormat)("ngIfElse",l),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.capabilities.connectTargetValueToData&&!i.capabilities.supportsRollup)}},dependencies:[F.NgForOf,F.NgIf,it.YN,it.Kr,it.Fj,it.EJ,it.JJ,it.On,Sn.X,Nn.d,Rl,Bt.F],styles:["[_nghost-%COMP%]{display:inline-flex}.inner-input-box-with-rollups[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center}.right-padding[_ngcontent-%COMP%]{padding-right:8px}.right-margin[_ngcontent-%COMP%]{margin-right:4px}.select-categorical-value[_ngcontent-%COMP%], .select-categorical-target[_ngcontent-%COMP%]{width:100%;height:32px}.value-input-title[_ngcontent-%COMP%], .target-input-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.edit-targets-title[_ngcontent-%COMP%]{padding-top:9px;padding-bottom:4px}.pbi-text-field-error-message[_ngcontent-%COMP%]{fill:var(--fluent-theme-error-dark-color, #A80000);color:var(--fluent-theme-error-dark-color, #A80000)}  #goal-edit-value-formatting{background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}  #goal-edit-value-formatting .value-formatting-box .result{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--gray-180, #252423);line-height:20px;height:20px;padding:12px 12px 8px;border-bottom:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}  #goal-edit-value-formatting .value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}  #goal-edit-value-formatting .value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}  #goal-edit-value-formatting .value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}  #goal-edit-value-formatting .value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}  #goal-edit-value-formatting .value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}  #goal-edit-value-formatting .value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}  #goal-edit-value-formatting .value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}  #goal-edit-value-formatting .value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}",".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:100px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background-color:var(--scorecard-tableEditRowBackgroundColor);color:var(--scorecard-tableEditRowForegroundColor);border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell.cell-right-edge[_ngcontent-%COMP%]{border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:none;max-width:none;min-width:392px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .inner-input-box-with-rollups[_ngcontent-%COMP%]{max-width:none}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]{width:104px;max-width:104px;min-width:auto}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px 6px}[_nghost-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td.bulk-editing-off[_ngcontent-%COMP%]{width:0px;max-width:0px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden;margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);padding-top:9px;padding-bottom:4px}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{vertical-align:middle;padding:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{display:flex;flex:1;padding-left:20px;padding-right:20px;width:1000px;min-width:1000px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);height:32px;padding:6px 8px;box-sizing:border-box;color:var(--scorecard-tableInputForegroundColor);background:var(--scorecard-tableInputBackgroundColor);border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{border:2px solid var(--fluent-theme-error-dark-alt-color, #D83B01);outline-color:var(--fluent-theme-error-dark-alt-color, #D83B01)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableInputForegroundColor)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{padding:0;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-outer-spin-button, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}[_nghost-%COMP%]   .right-padding[_ngcontent-%COMP%]{padding-right:8px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableEditRowForegroundColor);padding-top:4px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--scorecard-tableRowLinkColor);cursor:pointer;text-decoration:none;background-color:transparent;border:none;padding:0}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link.inactive[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertia-color, #A19F9D);pointer-events:none}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:1px;height:100%;background-color:var(--gray-80, #B3B0AD);margin:0 12px}[_nghost-%COMP%]   .width-override[_ngcontent-%COMP%]{width:24px}[_nghost-%COMP%]     .mat-form-field{background:var(--scorecard-tableInputBackgroundColor)!important}[_nghost-%COMP%]     emails-list-modern.disabled .mat-form-field{filter:brightness(95%)}[_nghost-%COMP%]   .goal-owners-input[_ngcontent-%COMP%]{padding-bottom:9px}[_nghost-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:1 0 260px;max-width:400px}[_nghost-%COMP%]   .input-box-xs[_ngcontent-%COMP%]{flex:1 1 100px;max-width:140px;min-width:110px}[_nghost-%COMP%]   .input-box-sm[_ngcontent-%COMP%]{flex:1 1 100px;max-width:200px;min-width:140px}[_nghost-%COMP%]   .input-box-md[_ngcontent-%COMP%]{flex:1 1 200px;max-width:300px;min-width:130px}[_nghost-%COMP%]   .input-box-lg[_ngcontent-%COMP%]{flex:1 1 250px;min-width:150px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),o}(),Fc=m(93864),Ml=m(56011),Ac=function(){function o(n){this.scorecardService=n}return Object.defineProperty(o.prototype,"scorecard",{get:function(){return this.scorecardService.getCurrentScorecard()},enumerable:!1,configurable:!0}),o.prototype.updateScorecardStatuses=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(t){switch(t.label){case 0:return o.isLocalScorecard?(this.scorecard.goalStatuses=n.goalStatuses,this.scorecard.goalStatuses.nextId=this.scorecard.goalStatuses.statuses.length,this.commit(),[3,3]):[3,1];case 1:return[4,this.scorecardService.updateScorecard(n)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},o.prototype.createCategoryListHandler=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return o.isLocalScorecard?(_.isUndefined(this.scorecard.goalValueCategories)&&(this.scorecard.goalValueCategories=[]),t=W.getGoalValueCategoriesCreateRequest(n),i={id:this.scorecard.goalValueCategories.length.toString(),scorecardId:"",name:"",categories:t.categories},this.scorecard.goalValueCategories.push(i),this.commit(),[2,i]):[3,1];case 1:return[4,this.scorecardService.createCategoryList(n)];case 2:return[2,a.sent()]}})})},o.prototype.updateCategoryListHandler=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return o.isLocalScorecard?(t=_.findIndex(this.scorecard.goalValueCategories,function(a){return a.id===n.id}),this.scorecard.goalValueCategories[t]=n,this.commit(),[2,n]):[3,1];case 1:return[4,this.scorecardService.updateCategoryList(n)];case 2:return[2,i.sent()]}})})},o.prototype.deleteCategoryListHandler=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return o.isLocalScorecard?(_.remove(this.scorecard.goalValueCategories,function(a){return a.id===n}),t=0,this.scorecard.goalValueCategories.forEach(function(a){a.id=t.toString(),t+=1}),this.commit(),[3,3]):[3,1];case 1:return[4,this.scorecardService.deleteCategoryList(n)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},o.prototype.commit=function(){this.scorecardService.loadPrefetchedScorecard(this.scorecard)},o.isLocalScorecard=!1,o}(),Rc=["matSelect"];function Lc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-option",6),e.\u0275\u0275listener("onSelectionChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onValueSelect(l))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&o){var i=n.$implicit;e.\u0275\u0275styleProp("background-color",i.color),e.\u0275\u0275property("value",i),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.displayName," ")}}function Gc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.onEdit())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"EditStatusRules_Button_Text")," "))}var Ll=function(){function o(n,t,i){this.detailsPaneLauncher=n,this.localizationService=t,this.scorecardService=i,this.canCustomizeStatus=!1,this.onSelect=new e.EventEmitter,this.createGoalHelper=new Ac(i),this.goalStatusHelper=new Q.p(this.localizationService),this.defaultColor=ne.xt.defaultColorPalette[0].backgroundColor,this.statusForm=new it.nJ({statusPicker:new it.p4(null)})}return o.prototype.focus=function(){this.matSelect._elementRef.nativeElement.focus()},o.prototype.onEdit=function(){var n=this;this.detailsPaneLauncher.openEditStatusesPane(this.scorecardService,function(t){return n.createGoalHelper.updateScorecardStatuses(t)},!this.canCustomizeStatus),this.matSelect.close()},o.prototype.ngOnInit=function(){this.displayGoalStatuses=this.configStatus(this.goalStatuses)},o.prototype.ngOnChanges=function(n){var t,i,a;n.goalStatuses&&(this.displayGoalStatuses=this.configStatus(this.goalStatuses)),n.isReadOnly&&(this.isReadOnly?null===(t=this.statusForm)||void 0===t||t.get("statusPicker").disable():null===(i=this.statusForm)||void 0===i||i.get("statusPicker").enable()),n.status&&(this.currentStatus=Q.p.getGoalStatus(this.status,this.goalStatuses),_.isNil(this.status)&&this.showUndefinedAsEmpty&&(this.currentStatus=void 0),null===(a=this.statusForm.get("statusPicker"))||void 0===a||a.setValue(this.currentStatus)),n.showUndefinedAsEmpty&&(this.defaultColor=this.showUndefinedAsEmpty?"transparent":ne.xt.defaultColorPalette[0].backgroundColor)},o.prototype.compareOptions=function(n,t){return n.id===t.id},o.prototype.onValueSelect=function(n){n.isUserInput&&(this.currentStatus=n.source.value,this.onSelect.emit(n.source.value))},o.prototype.configStatus=function(n){var t=[];if(!_.isEmpty(n))for(var i=0,a=n;i<a.length;i++){var l=a[i];if(!l.historical){var c={id:l.id,displayName:this.goalStatusHelper.tryLocalizeDisplayName(l.displayName),color:l.color,historical:l.historical,labelColor:l.labelColor};t.push(c)}}return t},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["status-picker"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Rc,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.matSelect=a.first))},inputs:{canCustomizeStatus:"canCustomizeStatus",goalStatuses:"goalStatuses",status:"status",isReadOnly:"isReadOnly",onSave:"onSave",showUndefinedAsEmpty:"showUndefinedAsEmpty"},outputs:{onSelect:"onSelect"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:10,consts:[[3,"formGroup"],["appearance","none"],["pbiInput","","pbiMatSelect","","disableOptionCentering","","data-testid","goal-status-picker","panelClass","goal-status-panel","formControlName","statusPicker",1,"custom-mat-select",3,"placeholder","aria-label","compareWith"],["matSelect",""],["class","custom-mat-option",3,"background-color","value","onSelectionChange",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"custom-mat-option",3,"value","onSelectionChange"],[1,"editStatus",3,"click"]],template:function(t,i){var a;(1&t&&(e.\u0275\u0275elementStart(0,"form",0)(1,"mat-form-field",1)(2,"mat-select",2,3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,Lc,2,4,"mat-option",4),e.\u0275\u0275template(6,Gc,4,3,"div",5),e.\u0275\u0275elementEnd()()()),2&t)&&(e.\u0275\u0275property("formGroup",i.statusForm),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",null!==(a=null==i.currentStatus?null:i.currentStatus.color)&&void 0!==a?a:i.defaultColor),e.\u0275\u0275propertyInterpolate("aria-label",e.\u0275\u0275pipeBind1(4,8,"SelectStatus")),e.\u0275\u0275property("placeholder",null==i.currentStatus?null:i.currentStatus.displayName)("compareWith",i.compareOptions),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",i.displayGoalStatuses),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.canCustomizeStatus))},dependencies:[F.NgForOf,F.NgIf,it._Y,it.JJ,it.JL,_n.v_,bn.x8,Un.CK,it.sg,it.u,Bt.F],styles:['.custom-mat-option{height:24px!important;line-height:24px!important;margin:6px 32px 6px 8px;border-radius:12px}  .custom-mat-option span{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);text-align:center}  .mat-option.mat-active{outline:2px solid var(--fluent-theme-neutral-dark-color, #201F1E)}  .editStatus{width:100%;background-color:transparent!important;border:none;border-top:1px solid var(--gray-60, #C8C6C4);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}  .editStatus:hover,   .editStatus:active{background-color:transparent!important;border-top:1px solid var(--gray-60, #C8C6C4)!important}  .goal-status-panel{margin-top:42px;margin-bottom:42px;width:100%;max-width:100%!important;min-width:100%!important;margin-left:16px;box-shadow:var(--fluent-shadow-depth8, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 4px 8px var(--colorNeutralShadowKey))!important;border-radius:2px!important;position:relative;top:-12px}[_nghost-%COMP%]     mat-form-field{width:100%!important;border:1px solid var(--gray-110, #8A8886);box-sizing:border-box;border-radius:2px;height:32px;padding:2px}[_nghost-%COMP%]     mat-form-field mat-select{border-radius:24px}[_nghost-%COMP%]     .mat-select-trigger{height:24px!important;width:100%;display:flex;align-items:center}[_nghost-%COMP%]     .custom-mat-select .mat-select-value{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);text-align:center;border-radius:12px;margin-left:8px;margin-right:8px;line-height:24px!important;height:24px!important}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper{font-family:PowrMDL2;font-style:normal;font-size:32px;display:inline-block;font-size:12px;margin-right:8px;color:var(--gray-140, #484644)}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper:before{content:"\\e70d"}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper .mat-select-arrow{display:none}[_nghost-%COMP%]     .custom-mat-select.mat-select-disabled .mat-select-arrow-wrapper{display:none}[_nghost-%COMP%]     .custom-mat-select:focus{outline:2px solid var(--fluent-theme-neutral-dark-color, #201F1E)}[_nghost-%COMP%]     .mat-select-value{width:100%;max-width:100%}[_nghost-%COMP%]     .mat-select-placeholder{color:unset}[_nghost-%COMP%]     .mat-select-value-text{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}[_nghost-%COMP%]     .mat-form-field-wrapper{padding:0!important}[_nghost-%COMP%]     .mat-form-field-wrapper .mat-form-field-flex{height:unset!important}[_nghost-%COMP%]     .mat-form-field-wrapper .mat-form-field-infix{padding:0!important;border:none!important;top:1px}'],changeDetection:0}),o}(),Nc=["nameInput"],Hc=["goal-edit-row",""];function zc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"pbi-checkbox",17),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()()}if(2&o){var a,l,i=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("box-checked",null==(a=e.\u0275\u0275pipeBind1(1,4,i.selectedGoalIds$))?null:a[i.displayedGoal.id]),e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",null==(l=e.\u0275\u0275pipeBind1(3,6,i.selectedGoalIds$))?null:l[i.displayedGoal.id])("disabled",null==i.displayedGoal?null:i.displayedGoal.isNew)}}function Bc(o,n){1&o&&e.\u0275\u0275element(0,"td",18)}function Uc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",19),e.\u0275\u0275element(4,"div",20),e.\u0275\u0275elementStart(5,"div",21)(6,"emails-list-modern",22),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.selectedUsers=l)}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("allowAnyGroup",!0)("maxSelectableUsers",i.maxGoalOwnerCount)("ngModel",i.selectedUsers)("addUserOnBlur",!0)("inputPlaceholder",e.\u0275\u0275pipeBind1(7,7,"Enter_Name"))("disabled",!i.capabilities.editOwners)("hideInput",!i.capabilities.editOwners)}}function qc(o,n){1&o&&e.\u0275\u0275element(0,"span",31)}function Wc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275template(1,qc,1,0,"span",29),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onUpdateStatusRules())}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.displayedGoal.hasStatusRules),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",i.displayedGoal.hasStatusRules?"UpdateMetricStatusRules":"SetupMetricStatusRules")}}function jc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",23),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",24),e.\u0275\u0275element(4,"div",25),e.\u0275\u0275elementStart(5,"status-picker",26),e.\u0275\u0275listener("onSelect",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onStatusChange(l))}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Wc,5,2,"div",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("canCustomizeStatus",null==i.capabilities.scorecardCapabilities?null:i.capabilities.scorecardCapabilities.customizeStatus)("status",null==i.currentValue?null:i.currentValue.status)("goalStatuses",e.\u0275\u0275pipeBind1(6,7,i.goalStatuses$))("pbiTooltip",e.\u0275\u0275pipeBind1(7,9,"MetricStatus_ReadOnly"))("pbiTooltipDisabled",!i.displayedGoal.hasStatusRules)("isReadOnly",!i.capabilities.editStatus),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.showUpdateRules&&i.capabilities.editStatusRules)}}function $c(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",32),e.\u0275\u0275element(4,"div",33),e.\u0275\u0275elementStart(5,"div",9)(6,"input",34),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onStartDateChange(l))}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"div",35)(9,"div",36),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275element(12,"i",37),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",9)(15,"input",38),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onDueDateChange(l))}),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("min",i.SqlDateTimeMinValue)("max",i.SqlDateTimeMaxValue)("ngModel",i.startDateShort)("disabled",!i.capabilities.editStartDate),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(7,12,"Start_Date")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,14,"DueDate")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(13,16,"Metrics_Due_Date_Tooltip")),e.\u0275\u0275advance(3),e.\u0275\u0275property("min",i.SqlDateTimeMinValue)("max",i.SqlDateTimeMaxValue)("ngModel",i.completionDateShort)("disabled",!i.capabilities.editDueDate),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,18,"DueDate"))}}var Qc=function(){return[]},Gl=function(){function o(n,t,i,a,l,c,p,y){this.featureSwitches=n,this.scorecardService=t,this.scorecardConfigurationService=i,this.detailsPaneLauncher=a,this.capabilityService=l,this.telemetryService=c,this.scorecardHost=p,this.settingsService=y,this.TotalNumberOfColumns=ne.gT.TotalNumberOfColumns,this.GoalNameMaxLength=xn.GoalNameMaxLength,this.maxGoalOwnerCount=1,this.currentValue={},this.supportMultipleTargets=!1,this.supportMultipleValuesEditing=!1,this.indentation=0,this.selectedUsers=[],this.showUpdateRules=!1,this.goalCurrentValueSelection=void 0,this.goalTargetValueSelection=void 0,this.SqlDateTimeMinValue=ne.gT.SqlDateTimeMinValue,this.SqlDateTimeMaxValue=ne.gT.SqlDateTimeMaxValue,this.isSingleGoalVisual=!1}return Object.defineProperty(o.prototype,"indent",{set:function(t){this.indentation=Ke.r.getSafeIndentation(t)},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){var n,i,a,l,c,p,y,t=this;u.fF.assertValue(this.goal,"No goal to edit"),this.displayedGoal=_.cloneDeep(this.goal),this.startDateShort=null===(a=null===(i=this.displayedGoal)||void 0===i?void 0:i.startDate)||void 0===a?void 0:a.slice(0,10),this.completionDateShort=null===(c=null===(l=this.displayedGoal)||void 0===l?void 0:l.completionDate)||void 0===c?void 0:c.slice(0,10);var O=Ke.r.buildCurrentGoalValue(this.goal);if(this.currentTarget={timestamp:O.timestamp,target:O.target},O.target=void 0,this.currentValue=O,this.supportMultipleValuesEditing=this.featureSwitches.featureSwitches.goalsMultipleValuesEditor,this.supportMultipleTargets=this.featureSwitches.featureSwitches.powerBIGoalsMultipleTargets,this.supportMultipleTargets&&(this.currentTarget=Ke.r.getCurrentGoalTarget(this.displayedGoal),!this.currentTarget)){var A=se.E.getCurrentUTCDay();A.setMonth(A.getMonth()+1),this.currentTarget={timestamp:A.toISOString()}}var L=this.displayedGoal.owner;this.selectedUsers=L?[{displayName:"",userPrincipalName:L,objectId:"",objectType:1,isSecurityGroup:!1}]:[];var te=this.displayedGoal.additionalOwners;_.isEmpty(te)||(n=this.selectedUsers).push.apply(n,te.filter(function(Ae){return Ae.userPrincipalName}).map(function(Ae){return{displayName:"",userPrincipalName:Ae.userPrincipalName,objectId:"",objectType:1,isSecurityGroup:!1}})),this.showUpdateRules=this.featureSwitches.featureSwitches.powerBIGoalsStatusRules,this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete,this.selectedGoalIds$=this.scorecardService.getSelectedGoalIdsObservable();var ue=this.scorecardService.getColumnSettings();this.showDueDate$=ue.pipe((0,G.x)(),(0,dt.U)(function(Ae){return ae.isColumnVisible(Ae,5)})),this.showOwner$=ue.pipe((0,G.x)(),(0,dt.U)(function(Ae){return ae.isColumnVisible(Ae,1)})),this.showStatus$=ue.pipe((0,G.x)(),(0,dt.U)(function(Ae){return ae.isColumnVisible(Ae,2)})),this.maxGoalOwnerCount=this.featureSwitches.featureSwitches.powerBIGoalsMultipleGoalOwners?xn.MaxGoalOwnerCount:1,null===(y=null===(p=this.settingsService)||void 0===p?void 0:p.settings)||void 0===y||y.pipe((0,Me.q)(1)).subscribe(function(Ae){var Ne;t.isSingleGoalVisual=!_.isNil(null===(Ne=_.first(Ae.filters))||void 0===Ne?void 0:Ne.goalId)}),this.goalStatuses$=this.scorecardService.goalStatusesByScorecardId$.pipe((0,dt.U)(function(Ae){return Ae[t.goal.scorecardId]})),this.updateCapabilities()},o.prototype.ngAfterViewInit=function(){this.displayedGoal.isNew&&this.nameInput.nativeElement.focus()},o.prototype.ngOnChanges=function(n){n.goal&&this.displayedGoal&&!this.goal.isNew&&(this.displayedGoal.hasStatusRules=this.goal.hasStatusRules,this.updateCapabilities(),this.displayedGoal.cycleMetadata=(0,M.__assign)({},this.goal.cycleMetadata),this.displayedGoal.metadata=(0,M.__assign)({},this.goal.metadata),this.displayedGoal.cycle=this.goal.cycle,this.displayedGoal.cyclePeriod=this.goal.cyclePeriod,this.displayedGoal.cycleRollingInterval=this.goal.cycleRollingInterval)},o.prototype.onSelectGoalCheckbox=function(){this.scorecardService.toggleSelectedGoal(this.displayedGoal.id,!1,!0)},o.prototype.onSave=function(){var n,t,i,a,l,c,p,y,O,A,L,te,ue,Ae;return(0,M.__awaiter)(this,void 0,void 0,function(){var ze,ot,ft,xt,Kt,kt,Rt,Y;return(0,M.__generator)(this,function(Le){switch(Le.label){case 0:return _.isNil(this.goal.valueRollup)||_.isUndefined(this.goalCurrentValueSelection)||4===(null===(n=this.goalCurrentValueSelection)||void 0===n?void 0:n.type)?[3,2]:[4,this.scorecardService.deleteGoalValueRollup(this.displayedGoal.id,1)];case 1:Le.sent(),Le.label=2;case 2:return _.isNil(this.goal.targetRollup)||_.isUndefined(this.goalTargetValueSelection)||4===(null===(t=this.goalTargetValueSelection)||void 0===t?void 0:t.type)?[3,4]:[4,this.scorecardService.deleteGoalValueRollup(this.displayedGoal.id,2)];case 3:Le.sent(),Le.label=4;case 4:return!_.isUndefined(this.goalCurrentValueSelection)&&1!==(null===(i=this.goalCurrentValueSelection)||void 0===i?void 0:i.type)&&this.goal.valueConnection?[4,this.scorecardService.deleteGoalQueryConnection(this.displayedGoal.id,1)]:[3,6];case 5:if(!1===(null!==(a=Le.sent())&&void 0!==a&&a))return[2];Le.label=6;case 6:return!_.isUndefined(this.goalTargetValueSelection)&&1!==(null===(l=this.goalTargetValueSelection)||void 0===l?void 0:l.type)&&this.goal.targetConnection?[4,this.scorecardService.deleteGoalQueryConnection(this.displayedGoal.id,2)]:[3,8];case 7:if(!1===(null!==(c=Le.sent())&&void 0!==c&&c))return[2];Le.label=8;case 8:if(!Ke.r.allGoalInputsValid(this.displayedGoal))return[2];_.isEmpty(this.selectedUsers)?(this.displayedGoal.owner="",this.displayedGoal.additionalOwners=[]):(this.displayedGoal.owner=this.selectedUsers[0].userPrincipalName||this.selectedUsers[0].emailAddress,ze=this.selectedUsers.slice(1).map(function(Mt){return{userPrincipalName:Mt.userPrincipalName||Mt.emailAddress}}),this.displayedGoal.additionalOwners=ze),Le.label=9;case 9:return Le.trys.push([9,31,,32]),this.scorecardService.setGoalState(this.displayedGoal.id,"Saving"),[4,this.scorecardService.saveGoal(this.displayedGoal.id,this.displayedGoal)];case 10:return ot=Le.sent(),this.displayedGoal.id=ot,ft=_.cloneDeep(this.currentValue),xt=_.cloneDeep(this.currentTarget),(this.displayedGoal.valueConnection||!_.isNil(null===(p=this.displayedGoal)||void 0===p?void 0:p.valueRollup)||!_.isUndefined(null===(y=this.goalCurrentValueSelection)||void 0===y?void 0:y.rollupType))&&(ft.value=void 0,this.values=void 0),(this.displayedGoal.targetConnection||!_.isNil(null===(O=this.displayedGoal)||void 0===O?void 0:O.targetRollup)||!_.isUndefined(null===(A=this.goalTargetValueSelection)||void 0===A?void 0:A.rollupType))&&(xt.target=void 0,this.targets=void 0),this.supportMultipleTargets||(ft.target=xt.target),_.isEmpty(this.displayedGoal.goalValues)?[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,ft)]:[3,12];case 11:return Le.sent(),[3,14];case 12:return kt=Ke.r.buildCurrentGoalValue(this.displayedGoal,!0),Et.areGoalValuesEqual(ft,kt,!_.isNil(this.displayedGoal.valueConnection),this.supportMultipleTargets||!_.isNil(this.displayedGoal.targetConnection))?[3,14]:(Kt=Et.diffGoalValues(ft,kt),[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,Kt)]);case 13:Le.sent(),Le.label=14;case 14:return this.supportMultipleValuesEditing&&this.values?[4,this.scorecardService.overwriteMultipleGoalValues(this.displayedGoal.id,this.values)]:[3,16];case 15:Le.sent(),Le.label=16;case 16:return this.supportMultipleTargets?this.targets?[4,this.scorecardService.overwriteGoalTargets(this.displayedGoal.id,this.targets)]:[3,18]:[3,20];case 17:return Le.sent(),[3,20];case 18:return void 0===xt.target||(kt=Ke.r.buildCurrentGoalValue(this.displayedGoal)).target===xt.target?[3,20]:[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,xt)];case 19:Le.sent(),Le.label=20;case 20:return _.isUndefined(null===(L=this.goalCurrentValueSelection)||void 0===L?void 0:L.rollupType)?[3,22]:[4,this.scorecardService.upsertGoalValueRollup(this.displayedGoal.id,1,this.goalCurrentValueSelection.rollupType)];case 21:Le.sent(),Le.label=22;case 22:return _.isUndefined(null===(te=this.goalTargetValueSelection)||void 0===te?void 0:te.rollupType)?[3,24]:[4,this.scorecardService.upsertGoalValueRollup(this.displayedGoal.id,2,this.goalTargetValueSelection.rollupType)];case 23:Le.sent(),Le.label=24;case 24:return[4,this.scorecardService.updateGoalQueryConnection(this.displayedGoal.id,1,this.displayedGoal.valueConnection)];case 25:return Le.sent(),[4,this.scorecardService.updateGoalQueryConnection(this.displayedGoal.id,2,this.displayedGoal.targetConnection)];case 26:return Le.sent(),this.displayedGoal.isNew&&this.newGoalRules?[4,this.scorecardService.saveStatusRules(this.displayedGoal.id,this.newGoalRules)]:[3,28];case 27:Le.sent(),Le.label=28;case 28:return this.scorecardService.setGoalState(this.displayedGoal.id,"Consumption"),this.isSingleGoalVisual?(Rt=this.scorecardService.getCurrentScorecard(),Y=this,[4,this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,On.h)(function(Mt){return!Mt.currentRefreshInProgress&&!Mt.targetRefreshInProgress}),(0,Me.q)(1)).toPromise()]):[3,30];case 29:Y.displayedGoal=Le.sent(),this.scorecardHost.onUpdateScorecard(Rt),this.scorecardHost.onSelectGoals([this.displayedGoal]),this.scorecardHost.showGoals(!1,Rt,[this.displayedGoal]),Le.label=30;case 30:return _.isNil(null===(ue=this.goalCurrentValueSelection)||void 0===ue?void 0:ue.type)||this.telemetryService.logEvent(ke,{calculationType:this.getMetricCalculationType(this.goalCurrentValueSelection.type)}),_.isNil(null===(Ae=this.goalTargetValueSelection)||void 0===Ae?void 0:Ae.type)||this.telemetryService.logEvent(S,{calculationType:this.getMetricCalculationType(this.goalTargetValueSelection.type)}),[3,32];case 31:return Le.sent(),u.fF.assertFail("Could not save goal"),this.scorecardService.setGoalState(this.displayedGoal.id,"Editing"),[3,32];case 32:return[2]}})})},o.prototype.onUpdateStatusRules=function(){var n=this;this.displayedGoal.isNew?this.detailsPaneLauncher.openGoalStatusRulesPane(this.scorecardService.getGoalStatuses(this.displayedGoal),this.displayedGoal,this.newGoalRules,function(t){return(0,M.__awaiter)(n,void 0,void 0,function(){return(0,M.__generator)(this,function(i){return t=_.some(t?.rules)?t:void 0,this.newGoalRules=t,this.displayedGoal.hasStatusRules=!!t,this.updateCapabilities(),[2,t]})})}):this.detailsPaneLauncher.openGoalDetails(this.scorecardService,this.goal.id,Qr.ShowStatusRules,this.scorecardConfigurationService.getConfiguration())},o.prototype.onCancel=function(){this.scorecardService.cancelEditing(this.displayedGoal.id)},o.prototype.onStartDateChange=function(n){var t=new Date(n);_.isEmpty(n)||!_.isFinite(t.getTime())||(this.displayedGoal.startDate=t.toISOString(),this.startDateShort=n)},o.prototype.onDueDateChange=function(n){var t=new Date(n);_.isEmpty(n)||!_.isFinite(t.getTime())||(this.displayedGoal.completionDate=t.toISOString(),this.completionDateShort=n)},o.prototype.onSetCustomStatusesClick=function(){},o.prototype.onStatusChange=function(n){u.fF.assert(function(){return!!n},"status should not be null"),this.currentValue.status=n.id},o.prototype.allValid=function(){return Ke.r.allGoalInputsValid(this.displayedGoal)},o.prototype.onCategoryListIdChanged=function(n){this.displayedGoal.valuesCategoryId=n,this.updateCapabilities()},o.prototype.onConnectionChanged=function(){this.updateCapabilities()},o.prototype.onTargetsChanged=function(n){this.updateCapabilities(n)},o.prototype.onValueRollupChanged=function(n){4!==n.type&&this.updateCapabilities(),this.goalCurrentValueSelection=n},o.prototype.onTargetRollupChanged=function(n){4!==n.type&&this.updateCapabilities(),this.goalTargetValueSelection=n},o.prototype.updateCapabilities=function(n){var t=this.displayedGoal;n&&(t=(0,M.__assign)((0,M.__assign)({},t),{aggregations:(0,M.__spreadArray)((0,M.__spreadArray)([],_.filter(t.aggregations,function(i){return"NumberOfTargets"!==i.type}),!0),[{type:"NumberOfTargets",value:n.length}],!1)})),this.capabilities=this.capabilityService.getCurrentGoalCapabilities(t),this.capabilities.useCategoricalValues=this.capabilities.useCategoricalValues&&!this.isSingleGoalVisual},o.prototype.getMetricCalculationType=function(n){switch(n){case 1:return Tt.Connect;case 4:return Tt.Rollup;case 0:case 2:return Tt.Manual;default:return void u.fF.assertNever(n)}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(bi.V),e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Fn.y0),e.\u0275\u0275directiveInject(en,8),e.\u0275\u0275directiveInject(on,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["","goal-edit-row",""]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(Nc,5),e.\u0275\u0275viewQuery(Sl,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.nameInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.valueInput=a.first)}},inputs:{color:"color",goal:"goal",indent:"indent"},features:[e.\u0275\u0275NgOnChangesFeature],attrs:Hc,decls:26,vars:42,consts:[[1,"checkmark-td"],["class","select-checkmark",3,"box-checked",4,"ngIf"],["class","cell cell-indent",4,"ngFor","ngForOf"],[1,"cell","cell-left-edge","cell-right-edge"],[1,"cell-box"],[1,"color-box"],[1,"edit-row-content"],[1,"input-box-lg","goal-name"],[1,"input-title",3,"localize"],[1,"input-box"],["data-testid","goal-name-input-box","type","text",3,"maxlength","ngModel","disabled","keyup.enter","ngModelChange"],["nameInput",""],[4,"ngIf"],[1,"divider"],[1,"inner-input-box-with-rollups",3,"displayedGoal","currentValue","currentTarget","values","targets","goalStatuses","capabilities","displayedGoalChange","currentValueChange","currentTargetChange","valuesChange","targetsChange","onCategoryListIdChanged","onConnectionChanged","valueRollupsChange","targetRollupsChange","onSave"],["valueInput",""],[1,"select-checkmark"],[3,"checked","disabled","onChange"],[1,"cell","cell-indent"],[1,"input-box-md"],["localize","Owners_Lowercase",1,"input-title"],["data-testid","goal-owners-input",1,"input-box","goal-owners-input"],[3,"allowAnyGroup","maxSelectableUsers","ngModel","addUserOnBlur","inputPlaceholder","disabled","hideInput","ngModelChange"],[1,"divider","width-override"],[1,"input-box-sm"],["localize","Status",1,"input-title"],[3,"canCustomizeStatus","status","goalStatuses","pbiTooltip","pbiTooltipDisabled","isReadOnly","onSelect"],["class","input-action-txt",4,"ngIf"],[1,"input-action-txt"],["localize","Logical_Or_Operator",4,"ngIf"],[1,"link",3,"localize","click"],["localize","Logical_Or_Operator"],[1,"input-box-xs","right-padding","input-box-with-rollups"],["localize","Start_Date",1,"input-title"],["data-testid","start-date-input","type","date",3,"min","max","ngModel","disabled","ngModelChange"],[1,"input-box-xs","input-box-with-rollups"],[1,"input-title"],[1,"glyphicon","glyph-small","pbi-glyph-info","icon",3,"pbiTooltip"],["data-testid","due-date-input","type","date",3,"min","max","ngModel","disabled","ngModelChange"]],template:function(t,i){var a;(1&t&&(e.\u0275\u0275elementStart(0,"td",0),e.\u0275\u0275template(1,zc,4,8,"div",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,Bc,1,0,"td",2),e.\u0275\u0275elementStart(3,"td",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275element(6,"div",5),e.\u0275\u0275elementStart(7,"div",6)(8,"div",7),e.\u0275\u0275element(9,"div",8),e.\u0275\u0275elementStart(10,"div",9)(11,"input",10,11),e.\u0275\u0275listener("keyup.enter",function(){return i.onSave()})("ngModelChange",function(c){return i.displayedGoal.name=c}),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(15,Uc,8,9,"ng-container",12),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275elementStart(17,"div",13),e.\u0275\u0275element(18,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"goal-value-input",14,15),e.\u0275\u0275listener("displayedGoalChange",function(c){return i.displayedGoal=c})("currentValueChange",function(c){return i.currentValue=c})("currentTargetChange",function(c){return i.currentTarget=c})("valuesChange",function(c){return i.values=c})("targetsChange",function(c){return i.targets=c})("onCategoryListIdChanged",function(c){return i.onCategoryListIdChanged(c)})("onConnectionChanged",function(){return i.onConnectionChanged()})("targetsChange",function(c){return i.onTargetsChanged(c)})("valueRollupsChange",function(c){return i.onValueRollupChanged(c)})("targetRollupsChange",function(c){return i.onTargetRollupChanged(c)})("onSave",function(){return i.onSave()}),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(22,jc,9,11,"ng-container",12),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275template(24,$c,17,20,"ng-container",12),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275elementEnd()()()),2&t)&&(e.\u0275\u0275classProp("bulk-editing-off",!i.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(41,Qc).constructor(i.indentation)),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("selected-goal",null==(a=e.\u0275\u0275pipeBind1(4,27,i.selectedGoalIds$))?null:a[i.displayedGoal.id]),e.\u0275\u0275attribute("colspan",i.TotalNumberOfColumns-i.indentation-1),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("cell-box-with-rollups",i.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("background-color",i.color),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("localize",0===i.indentation?"MetricName":"SubmetricName"),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxlength",i.GoalNameMaxLength)("ngModel",i.displayedGoal.name)("disabled",!i.capabilities.editName),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(13,29,0===i.indentation?"MetricName":"SubmetricName"))("placeholder",e.\u0275\u0275pipeBind1(14,31,"NameYourMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(16,33,i.showOwner$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("displayedGoal",i.displayedGoal)("currentValue",i.currentValue)("currentTarget",i.currentTarget)("values",i.values)("targets",i.targets)("goalStatuses",e.\u0275\u0275pipeBind1(21,35,i.goalStatuses$))("capabilities",i.capabilities),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(23,37,i.showStatus$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(25,39,i.showDueDate$)))},dependencies:[F.NgForOf,F.NgIf,Fc.t,it.Fj,it.JJ,it.nD,it.On,Sn.X,Ml.v,oe.V,Sl,Ll,F.AsyncPipe,Bt.F],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:100px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background-color:var(--scorecard-tableEditRowBackgroundColor);color:var(--scorecard-tableEditRowForegroundColor);border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell.cell-right-edge[_ngcontent-%COMP%]{border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:none;max-width:none;min-width:392px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .inner-input-box-with-rollups[_ngcontent-%COMP%]{max-width:none}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]{width:104px;max-width:104px;min-width:auto}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px 6px}[_nghost-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td.bulk-editing-off[_ngcontent-%COMP%]{width:0px;max-width:0px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden;margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);padding-top:9px;padding-bottom:4px}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{vertical-align:middle;padding:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{display:flex;flex:1;padding-left:20px;padding-right:20px;width:1000px;min-width:1000px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);height:32px;padding:6px 8px;box-sizing:border-box;color:var(--scorecard-tableInputForegroundColor);background:var(--scorecard-tableInputBackgroundColor);border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{border:2px solid var(--fluent-theme-error-dark-alt-color, #D83B01);outline-color:var(--fluent-theme-error-dark-alt-color, #D83B01)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableInputForegroundColor)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{padding:0;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-outer-spin-button, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}[_nghost-%COMP%]   .right-padding[_ngcontent-%COMP%]{padding-right:8px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableEditRowForegroundColor);padding-top:4px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--scorecard-tableRowLinkColor);cursor:pointer;text-decoration:none;background-color:transparent;border:none;padding:0}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link.inactive[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertia-color, #A19F9D);pointer-events:none}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:1px;height:100%;background-color:var(--gray-80, #B3B0AD);margin:0 12px}[_nghost-%COMP%]   .width-override[_ngcontent-%COMP%]{width:24px}[_nghost-%COMP%]     .mat-form-field{background:var(--scorecard-tableInputBackgroundColor)!important}[_nghost-%COMP%]     emails-list-modern.disabled .mat-form-field{filter:brightness(95%)}[_nghost-%COMP%]   .goal-owners-input[_ngcontent-%COMP%]{padding-bottom:9px}[_nghost-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:1 0 260px;max-width:400px}[_nghost-%COMP%]   .input-box-xs[_ngcontent-%COMP%]{flex:1 1 100px;max-width:140px;min-width:110px}[_nghost-%COMP%]   .input-box-sm[_ngcontent-%COMP%]{flex:1 1 100px;max-width:200px;min-width:140px}[_nghost-%COMP%]   .input-box-md[_ngcontent-%COMP%]{flex:1 1 200px;max-width:300px;min-width:130px}[_nghost-%COMP%]   .input-box-lg[_ngcontent-%COMP%]{flex:1 1 250px;min-width:150px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),o}(),Kc=["chart"],Xc=["goal-row",""];function Zc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-checkbox",6),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onSelectGoalCheckbox())}),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("box-checked",null==i.scorecard||null==i.scorecard.selectedGoalIds?null:i.scorecard.selectedGoalIds[i.displayedGoal.id]),e.\u0275\u0275advance(1),e.\u0275\u0275property("checked",i.isChecked)}}function Yc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-radio-button",7),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!i.canSelectGoal)("pbiTooltip",i.selectGoalDisabledTooltip?e.\u0275\u0275pipeBind1(2,5,i.selectGoalDisabledTooltip):"")("pbiTooltipDisabled",i.canSelectGoal)("isCompact",!0)("checked",i.isChecked)}}function Jc(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-checkbox",8),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!i.canSelectGoal)("pbiTooltip",i.selectGoalDisabledTooltip?e.\u0275\u0275pipeBind1(2,4,i.selectGoalDisabledTooltip):"")("pbiTooltipDisabled",i.canSelectGoal)("checked",i.isChecked)}}function eu(o,n){1&o&&e.\u0275\u0275element(0,"td",9)}function tu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onShowChildrenChange())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("rotate90",!i.showChildren),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(3,6,i.showChildren?"Collapse_Expand_Submetrics_Button_Functional_Description_Hide_Submetrics":"Collapse_Expand_Submetrics_Button_Functional_Description_Show_Submetrics")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,4,i.showChildren?"Collapse_Expand_Submetrics_Button_Functional_Description_Hide_Submetrics":"Collapse_Expand_Submetrics_Button_Functional_Description_Show_Submetrics"))}}function nu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",30),e.\u0275\u0275listener("click",function(a){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onGoalRowClick(a))}),e.\u0275\u0275elementEnd()}}function ru(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",21)(1,"div",22)(2,"div",23),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var y=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(y.onGoalRowClick(p))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,tu,4,8,"ng-container",24),e.\u0275\u0275template(4,nu,1,0,"ng-template",null,25,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"div",26),e.\u0275\u0275element(7,"goal-name-cell",27)(8,"goal-actions-cell",28),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()()()}if(2&o){var i=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext(2).$implicit,l=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("--borderColor",l.color)("max-width",l.forceColumnMinWidths?l.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",l.ListViewCellMinWidths[a.columnId],"px"),e.\u0275\u0275classProp("selected-goal",(null==l.scorecard||null==l.scorecard.selectedGoalIds?null:l.scorecard.selectedGoalIds[l.displayedGoal.id])||l.highlightRow),e.\u0275\u0275attribute("colspan",l.MAX_COLSPAN-l.indentation),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",l.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",l.hasVisibleChildren)("ngIfElse",i),e.\u0275\u0275advance(4),e.\u0275\u0275property("goal",l.displayedGoal)("scorecard",l.scorecard),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",l.displayedGoal)("isEditMode",e.\u0275\u0275pipeBind1(9,17,l.isEditMode$))}}function iu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",31),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"goal-owners-cell",32),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)}}function ou(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",33),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"status-icon",34),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("status",null==c.currentValue?null:c.currentValue.status)("goalStatuses",c.goalStatuses)}}function au(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-change-cell",32),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("goal",t.displayedGoal)}}function su(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",35),e.\u0275\u0275listener("click",function(A){e.\u0275\u0275restoreView(t);var L=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(L.onGoalRowClick(A))}),e.\u0275\u0275element(1,"goal-value-cell",36),e.\u0275\u0275template(2,au,1,1,"goal-change-cell",37),e.\u0275\u0275elementEnd()}if(2&o){var p,y,i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showCurrent",!0)("showTarget",null!==(p=null==c.displayedGoal.metadata?null:c.displayedGoal.metadata.showFinalTarget)&&void 0!==p?p:!c.displayedGoal.targetConnection)("showMilestone",!(null!==(y=null==c.displayedGoal.metadata?null:c.displayedGoal.metadata.showFinalTarget)&&void 0!==y?y:!c.displayedGoal.targetConnection)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.isChangeVisible)}}function lu(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-change-cell",32),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("goal",t.displayedGoal)}}function cu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",38),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"goal-value-cell",39),e.\u0275\u0275template(2,lu,1,1,"goal-change-cell",37),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showCurrent",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.isChangeVisible)}}function uu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",40),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"goal-value-cell",41),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showTarget",!0)}}function du(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",42),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"goal-value-cell",43),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showMilestone",!0)}}function pu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",44,45),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(2,"goal-sparkline-cell",46),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(2),e.\u0275\u0275property("goal",c.displayedGoal)("sparklineValues",c.sparklineValues)}}function hu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",47),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(O.onGoalRowClick(y))}),e.\u0275\u0275element(1,"goal-due-date-cell",32),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",l),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)}}function gu(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,ru,10,19,"td",12),e.\u0275\u0275template(2,iu,2,11,"td",13),e.\u0275\u0275template(3,ou,2,12,"td",14),e.\u0275\u0275template(4,su,3,15,"td",15),e.\u0275\u0275template(5,cu,3,13,"td",16),e.\u0275\u0275template(6,uu,2,12,"td",17),e.\u0275\u0275template(7,du,2,12,"td",18),e.\u0275\u0275template(8,pu,3,12,"td",19),e.\u0275\u0275template(9,hu,2,11,"td",20),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",2),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",3),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",7),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",8),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",9),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",4),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",5))}function fu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0,10),e.\u0275\u0275template(1,gu,10,9,"ng-container",11),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("ngSwitch",t.columnId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.show)}}var mu=function(){return[]},Nl=function(){function o(n,t,i,a,l,c,p,y){this.elementRef=n,this.scorecardService=t,this.featureSwitches=i,this.localizationService=a,this.scorecardConfigurationService=l,this.capabilityService=c,this.hierarchyService=p,this.goalRowService=y,this.showChildren=!0,this.highlightRow=!1,this.showChildrenChange=new e.EventEmitter,this.tabIndex=0,this.MAX_COLSPAN=ne.gT.MaxSubGoals+1,this.ListViewCellMinWidths=ne.gT.ListViewCellMinWidths,this.currentValue=null,this.displayedGoal=null,this.indentation=0,this.canSelectGoal=!0,u.fF.assertValue(this.hierarchyService,"No hierarchy service")}return Object.defineProperty(o.prototype,"goal",{set:function(t){var i,a,l,c,p;if(this.displayedGoal=t,this.capabilities=this.capabilityService.getCurrentGoalCapabilities(t),this.sparklineValues=Ir.buildSparklineValues(t,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations).map(function(O){return{value:O.value,timestamp:O.timestamp}}),this.sparklineOptions=Ir.getSparklineOptions(t,this.scorecardService.getGoalStatuses(t),this.scorecardConfigurationService.getConfiguration()),this.currentValue=Ke.r.buildCurrentGoalValue(t),this.valueChange=Ke.r.calculateValueChange(t,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasValueOrTarget=!_.isNil(this.currentValue.value)||!_.isNil(this.currentValue.finalTarget)||!_.isNil(this.currentValue.nextTarget),this.displayedGoal.completionDate){var y=this.localizationService.currentLanguageLocale;this.completionDate=se.E.treatAsLocalDate(new Date(this.displayedGoal.completionDate)).toLocaleDateString(y,{day:"numeric",month:"short",year:"numeric"})}this.hasVisibleChildren=_.some(t.subGoals,function(O){return!O.isHidden}),this.canSelectGoal=null===(a=null===(i=this.capabilities.selectGoal)||void 0===i?void 0:i.enabled)||void 0===a||a,this.selectGoalDisabledTooltip=null===(l=this.capabilities.selectGoal)||void 0===l?void 0:l.disabledMessageKey,this.showDisabledGoalSelected=null===(p=null===(c=this.capabilities.selectGoal)||void 0===c?void 0:c.disabledReasons)||void 0===p?void 0:p.has("AlreadyLinked")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"indent",{set:function(t){this.indentation=Ke.r.getSafeIndentation(t)},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){this.isEditMode$=this.scorecardService.isEditMode(),this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete},o.prototype.ngOnChanges=function(n){var t,i,a,l;if(n.scorecard){var c=this.scorecardConfigurationService.getConfiguration();!(null===(t=c?.scorecardDisplayOptions)||void 0===t)&&t.isMobileLayout||this.scorecard.activeGoalId===this.displayedGoal.id&&this.focus(),this.isChangeVisible=ae.isColumnVisible(this.scorecard.columnSettings,10)}n.goal&&(this.formatString=n.goal.currentValue.valuesFormatString,this.isCyclePeriodLabelLocalizable=Ke.r.isCyclePeriodLabelLocalizable(null===(i=this.valueChange)||void 0===i?void 0:i.period)),(n.scorecard||n.goal)&&(this.goalStatuses=this.scorecardService.getGoalStatuses(this.displayedGoal),this.categories=this.scorecardService.getGoalValueCategories(this.displayedGoal),this.isChecked=this.canSelectGoal?null===(l=null===(a=this.scorecard)||void 0===a?void 0:a.selectedGoalIds)||void 0===l?void 0:l[this.displayedGoal.id]:this.showDisabledGoalSelected)},o.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=W.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},o.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},o.prototype.onShowChildrenChange=function(){this.showChildrenChange&&this.showChildrenChange.emit(!this.showChildren)},o.prototype.onGoalRowClick=function(n){this.goalRowService.onRowClick(this.displayedGoal,n)},o.prototype.onSelectGoalCheckbox=function(){this.goalRowService.onCheckboxClick(this.displayedGoal)},o.prototype.focus=function(){var n;null===(n=this.elementRef)||void 0===n||n.nativeElement.focus()},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(bi.V),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(ni))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["","goal-row",""]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Kc,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.chart=a.first))},hostVars:1,hostBindings:function(t,i){2&t&&e.\u0275\u0275attribute("tabindex",i.tabIndex)},inputs:{color:"color",showChildren:"showChildren",scorecard:"scorecard",columnSettings:"columnSettings",highlightRow:"highlightRow",scorecardSelectionMode:"scorecardSelectionMode",goal:"goal",indent:"indent",forceColumnMinWidths:"forceColumnMinWidths"},outputs:{showChildrenChange:"showChildrenChange"},features:[e.\u0275\u0275NgOnChangesFeature],attrs:Xc,decls:6,vars:10,consts:[[1,"checkmark-td"],["class","select-checkmark",3,"box-checked",4,"ngIf"],["class","select-checkmark",4,"ngIf"],["class","cell cell-indent",4,"ngFor","ngForOf"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"select-checkmark"],[3,"checked","onChange"],["name","selectGoalInVisual",1,"select-goal-in-visual-radio",3,"disabled","pbiTooltip","pbiTooltipDisabled","isCompact","checked","change"],[3,"disabled","pbiTooltip","pbiTooltipDisabled","checked","onChange"],[1,"cell","cell-indent"],[3,"ngSwitch"],[4,"ngIf"],["class","cell cell-left-edge",3,"selected-goal","--borderColor","max-width","min-width",4,"ngSwitchCase"],["class","cell cell-owner",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-progress-icon",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-value-combined",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-value",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-target",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-milestone",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-sparkline",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-due-date",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],[1,"cell","cell-left-edge"],[1,"cell-box"],[1,"color-box",3,"click"],[4,"ngIf","ngIfElse"],["noChildren",""],[1,"displayed-name-and-action-wrapper"],[3,"goal","scorecard"],[3,"goal","isEditMode"],[1,"collapse-box","powervisuals-glyph","chevron-down",3,"pbiTooltip","click"],[1,"collapse-box",3,"click"],[1,"cell","cell-owner",3,"click"],[3,"goal"],[1,"cell","cell-progress-icon",3,"click"],[3,"status","goalStatuses"],[1,"cell","cell-value-combined",3,"click"],[3,"goal","showCurrent","showTarget","showMilestone"],[3,"goal",4,"ngIf"],[1,"cell","cell-value",3,"click"],[3,"goal","showCurrent"],[1,"cell","cell-target",3,"click"],[3,"goal","showTarget"],[1,"cell","cell-milestone",3,"click"],[3,"goal","showMilestone"],[1,"cell","cell-sparkline",3,"click"],["chart",""],[3,"goal","sparklineValues"],[1,"cell","cell-due-date",3,"click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"td",0),e.\u0275\u0275template(1,Zc,2,3,"div",1),e.\u0275\u0275template(2,Yc,3,7,"div",2),e.\u0275\u0275template(3,Jc,3,6,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,eu,1,0,"td",3),e.\u0275\u0275template(5,fu,2,2,"ng-container",4)),2&t&&(e.\u0275\u0275classProp("show-checkmark",!!i.scorecardSelectionMode)("show-on-hover-only","ctrl"===i.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","ctrl"===i.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","single"===i.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","multiple"===i.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(9,mu).constructor(i.indentation)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.columnSettings))},dependencies:[F.NgForOf,F.NgIf,F.NgSwitch,F.NgSwitchCase,Ml.v,mt.o,oe.V,Nr,zr,Qi,xo,ri,Yi,ai,li,F.AsyncPipe,Bt.F],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background:var(--scorecard-tableRowBackgroundColor);padding-right:10px;border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .rotate90[_ngcontent-%COMP%]{transform:rotate(-90deg)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .collapse-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:48px;min-width:48px;background-color:transparent;border:none}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex-grow:1;max-height:3.6em;line-height:1.8em}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .cell-owner[_ngcontent-%COMP%]{width:250px;max-width:300px}[_nghost-%COMP%]   .cell-progress-icon[_ngcontent-%COMP%]{width:220px;max-width:250px;text-align:center;padding-right:20px}[_nghost-%COMP%]   .cell-sparkline[_ngcontent-%COMP%]{width:150px;overflow:hidden}[_nghost-%COMP%]   .cell-due-date[_ngcontent-%COMP%]{width:150px}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]{width:51px;text-align:center}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]   .context-menu-icon[_ngcontent-%COMP%]{color:var(--gray-140, #484644);font-size:16px;cursor:pointer}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]{width:220px}[_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]{width:92px}[_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]{width:72px}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   goal-actions-cell[_ngcontent-%COMP%], [_nghost-%COMP%]:focus-within   goal-actions-cell[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .selected-goal.cell[_ngcontent-%COMP%]{border-top:2px solid var(--borderColor);border-bottom:2px solid var(--borderColor)}[_nghost-%COMP%]   .selected-goal.cell-right-edge[_ngcontent-%COMP%]{border-right:2px solid var(--borderColor)}[_nghost-%COMP%]   .cell-right-edge[_ngcontent-%COMP%]{width:2px;border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}  .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}"],changeDetection:0}),o}(),vu=["goal-group",""];function _u(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function Cu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"td",9),e.\u0275\u0275element(1,"div"),e.\u0275\u0275elementEnd()),2&o){var t=n.index,i=e.\u0275\u0275nextContext(4);e.\u0275\u0275classProp("goal-drag-placeholder-line",i.goalDragInfo&&t>=i.goalDragInfo.destGoalDropLevel)}}var yu=function(){return[]};function bu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"tr"),e.\u0275\u0275element(1,"td",6),e.\u0275\u0275template(2,Cu,2,2,"td",7),e.\u0275\u0275elementStart(3,"td",8),e.\u0275\u0275element(4,"div"),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("bulk-editing-off",!t.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(4,yu).constructor(t.MaxSubGoals)),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("colspan",50)}}function wu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"div",10),e.\u0275\u0275elementStart(2,"div",11),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(2).goal,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("background-color",i.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.name)}}var Su=function(n,t){return{goal:n,level:t}};function Mu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"tr",3),e.\u0275\u0275listener("showChildrenChange",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext().goal,A=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(A.onShowChildrenChange(O.id,y))})("cdkDragStarted",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(O.onDragStart(y))})("cdkDragMoved",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(O.onDragMove(y))}),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275template(3,bu,5,5,"tr",4),e.\u0275\u0275template(4,wu,4,3,"div",5),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(),a=i.goal,l=i.i,c=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled","Saving"===a.state||"Deleting"===a.state)("goal-not-match",!1===a.isFilterMatch),e.\u0275\u0275property("scorecard",c.scorecard)("columnSettings",c.columnSettings)("goal",a)("indent",l)("color",c.color)("highlightRow",c.goalDragInfo&&a.id===c.goalDragInfo.destParentGoalId)("scorecardSelectionMode",c.scorecardSelectionMode)("showChildren",c.showChildren[a.id])("forceColumnMinWidths",c.forceColumnMinWidths)("cdkDragData",e.\u0275\u0275pureFunction2(16,Su,a,l))("cdkDragDisabled","Saving"===a.state||"Deleting"===a.state)("cdkDragStartDelay",c.goalDragStartDelayInMs)}}function Pu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"tr",12,13),e.\u0275\u0275elementStart(3,"tr",14),e.\u0275\u0275listener("onSave",function(){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275reference(2);return e.\u0275\u0275resetView(O.onSave())})("onCancel",function(){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275reference(2);return e.\u0275\u0275resetView(O.onCancel())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275reference(2),a=e.\u0275\u0275nextContext(),l=a.goal,c=a.i,p=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275classProp("goal-not-match",!1===l.isFilterMatch),e.\u0275\u0275property("goal",l)("indent",c)("color",p.color),e.\u0275\u0275advance(2),e.\u0275\u0275property("id",l.id)("disableSave",!i.allValid())}}function Ou(o,n){1&o&&e.\u0275\u0275elementContainer(0)}var Eu=function(n,t){return{goal:n,i:t}};function Tu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ou,1,0,"ng-container",0),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(2).i;e.\u0275\u0275nextContext();var a=e.\u0275\u0275reference(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(2,Eu,t,i+1))}}function xu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Tu,2,5,"ng-container",2),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isHidden)}}function Iu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,xu,2,1,"ng-container",15),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext().goal,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.subGoals)("ngForTrackBy",i.goalId)}}function Du(o,n){if(1&o&&(e.\u0275\u0275template(0,Mu,5,19,"ng-container",2),e.\u0275\u0275template(1,Pu,4,7,"ng-container",2),e.\u0275\u0275template(2,Iu,2,2,"ng-container",2)),2&o){var t=n.goal,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",null==t.state||"Consumption"===t.state||"Saving"===t.state||"Deleting"===t.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Editing"===t.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==t.subGoals?null:t.subGoals.length)>0&&i.showChildren[t.id]&&(null==i.goalDragInfo?null:i.goalDragInfo.sourceGoalId)!==t.id)}}var ku=function(n){return{goal:n,i:0}},Vu=function(n){return{dragStartThreshold:n.featureSwitches.goalsDelayDragAndDrop?ne.gT.GoalDragStartThresholdInPx:ne.gT.DefaultDragThresholdInPx,pointerDirectionChangeThreshold:ne.gT.DefaultDragThresholdInPx}},Hl=function(){function o(n){this.featureSwitches=n,this.showChildren={},this.goalDragInfo={},this.showChildrenChange=new e.EventEmitter,this.dragMoved=new e.EventEmitter,this.dragStarted=new e.EventEmitter,this.MaxSubGoals=ne.gT.MaxSubGoals,this.goalDragStartDelayInMs=0}return o.prototype.ngOnInit=function(){this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete,this.goalDragStartDelayInMs=this.featureSwitches.featureSwitches.goalsDelayDragAndDrop?ne.gT.GoalDragStartDelayInMs:0},o.prototype.goalId=function(n,t){return t.id},o.prototype.onShowChildrenChange=function(n,t){this.showChildrenChange.emit({id:n,value:t})},o.prototype.onDragMove=function(n){this.dragMoved.emit(n)},o.prototype.onDragStart=function(n){this.dragStarted.emit(n)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Ln.vZ))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["","goal-group",""]],inputs:{scorecard:"scorecard",columnSettings:"columnSettings",goal:"goal",color:"color",showChildren:"showChildren",goalDragInfo:"goalDragInfo",scorecardSelectionMode:"scorecardSelectionMode",forceColumnMinWidths:"forceColumnMinWidths"},outputs:{showChildrenChange:"showChildrenChange",dragMoved:"dragMoved",dragStarted:"dragStarted"},features:[e.\u0275\u0275ProvidersFeature([{provide:ee.ni,useFactory:Vu,deps:[Ln.vZ]}])],attrs:vu,decls:3,vars:4,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],["goalWithChildrenTmpl",""],[4,"ngIf"],["goal-row","","cdkDrag","",1,"goal-row",3,"scorecard","columnSettings","goal","indent","color","highlightRow","scorecardSelectionMode","showChildren","forceColumnMinWidths","cdkDragData","cdkDragDisabled","cdkDragStartDelay","showChildrenChange","cdkDragStarted","cdkDragMoved"],[4,"cdkDragPlaceholder"],[4,"cdkDragPreview"],["colspan","1",1,"goal-placeholder-checkbox"],["class","cell cell-indent",3,"goal-drag-placeholder-line",4,"ngFor","ngForOf"],[1,"goal-drag-placeholder-line"],[1,"cell","cell-indent"],[1,"goal-drag-preview-accent"],[1,"goal-drag-preview-content"],["goal-edit-row","","data-testid","goal-edit-row",1,"goal-edit-row",3,"goal","indent","color"],["editRow",""],["goal-edit-buttons-row","",1,"button-row",3,"id","disableSave","onSave","onCancel"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,_u,1,0,"ng-container",0),e.\u0275\u0275template(1,Du,3,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,ku,i.goal))}},dependencies:[F.NgForOf,F.NgIf,F.NgTemplateOutlet,ee.Zt,ee.pV,ee.Hk,Nl,qn,Gl],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   .goal-edit-row[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:96px}[_nghost-%COMP%]   .goal-not-match[_ngcontent-%COMP%]{opacity:50%}[_nghost-%COMP%]   .button-row[_ngcontent-%COMP%]{height:32px;box-sizing:border-box;border:none}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.4}.row[_ngcontent-%COMP%]{box-sizing:border-box;border:none}.goal-row[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:60px}.cdk-drag-placeholder[_ngcontent-%COMP%]{height:2px}.goal-drag-placeholder-line[_ngcontent-%COMP%]{background-color:var(--fluent-theme-black-color, #000)}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:60px;display:flex;width:25%;opacity:.7;background-color:var(--scorecard-tableBackgroundColor);font-family:var(--scorecard-fontFamily)}.goal-drag-preview-accent[_ngcontent-%COMP%]{width:6px;border-radius:4px;margin-right:12px}.goal-drag-preview-content[_ngcontent-%COMP%]{display:inline-flex;align-items:center;min-width:fit-content;overflow:hidden;text-overflow:ellipsis}.goal-placeholder-checkbox[_ngcontent-%COMP%]{width:35px}.goal-placeholder-checkbox.bulk-editing-off[_ngcontent-%COMP%]{width:0px}"],changeDetection:0}),o}();function Fu(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"visual-modern",2),e.\u0275\u0275listener("on-resize",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResize(l))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",i.visualDefinition)("useOnPushChangeDetection",!0)}}var zl=function(){function o(n,t,i,a,l,c,p,y){this.geocoder=n,this.geolocation=t,this.localizationService=i,this.moduleLoader=a,this.promiseFactory=l,this.visualPlugin=c,this.visualHostTooltipServiceFactory=p,this.changeDetector=y,this.initialVisualWidth=360,this.initialVisualHeight=172}return o.prototype.ngOnInit=function(){var n=this;this.visualPlugin.ensureBuiltInPlugins().then(function(){n.initializeVisual(),n.isLoaded=!0,n.changeDetector.detectChanges()})},o.prototype.ngOnChanges=function(n){n.values&&(this.generateDataView(),this.update())},o.prototype.initializeVisual=function(){var n=this,t=(0,eo.ED)((0,Ji.q)({geocoder:this.geocoder,geolocation:this.geolocation,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.create(),getAzureMapToken:void 0,azureMapsEndpoint:void 0,geocoderIndexedDB:void 0}),function(i){i.getLocalizedString=function(a){for(var l,c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return(l=n.localizationService).format.apply(l,(0,M.__spreadArray)([a],c||[],!1))},i.getViewMode=function(){return 0},i.locale=function(){return(0,tr.uD)()},i.promiseFactory=function(){return n.promiseFactory}});this.visualDefinition={interactivityOptions:{},type:$n.L.kpi.name,allowInvalidDataView:!0,themeCollection:void 0,viewport:{height:this.initialVisualHeight,width:this.initialVisualWidth,scale:1},dataTransforms:void 0,hostServices:t,visualAdapterHostServices:{startProgressBar:_.noop,stopProgressBar:_.noop,getNextDataSegment:function(){return(0,M.__awaiter)(n,void 0,void 0,function(){return(0,M.__generator)(this,function(a){return[2,{}]})})}},stylePresetName:void 0,additionalObjectUpdates:_.noop,visualPlugin:this.visualPlugin},this.generateDataView(),this.update()},o.prototype.update=function(){this.visualDefinition&&(this.visualDefinition.data={dataView:this.dataView})},o.prototype.onResize=function(n){this.visualDefinition&&(this.visualDefinition.viewport={width:n.width,height:n.height,scale:1})},o.prototype.generateDataView=function(){var n,t,i=((n={})[sr.iu.objectName]=((t={})[sr.iu.propertyName]=this.formatString,t),n),a=[{displayName:this.localizationService.get("Date"),type:Dr.Ge.fromPrimitiveTypeAndCategory(6),roles:{TrendLine:!0}},{displayName:this.localizationService.get("Value"),type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Indicator:!0},index:0,objects:i},{displayName:this.localizationService.get("MetricsName_New_Singular"),type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Goal:!0},index:0,objects:i}],c=(0,Qt.Oh)((0,Qt.fL)("Date"),"Date"),p=_.sortBy(this.values,function(O){return new Date(O.timestamp)}),y=_.findLast(p,function(O){return _.isFinite(O.target)});p=_.filter(p,function(O){return _.isFinite(O.value)}),y&&(_.some(p)?_.last(p).target=y.target:p=[y]),this.dataView={metadata:{columns:a,objects:{indicator:{showIcon:!1}}},categorical:{categories:[{source:a[0],values:_.map(p,function(O){return se.E.treatAsLocalDate(new Date(O.timestamp))}),identity:_.map(p,function(O){return(0,xa.TZ)((0,Qt.Dg)(c,(0,Qt.fL)(O.timestamp)))})}],values:(0,Ia.Yv)([{source:a[1],values:_.map(p,function(O){return O.value})},{source:a[2],values:_.map(p,function(O){return O.target})}])}}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Da.i),e.\u0275\u0275directiveInject(Vo._1),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(ka.m),e.\u0275\u0275directiveInject(Ta.t),e.\u0275\u0275directiveInject(Fo.D),e.\u0275\u0275directiveInject(Va.q),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-kpi"]],inputs:{values:"values",formatString:"formatString"},features:[e.\u0275\u0275ProvidersFeature((0,M.__spreadArray)([],Ea.H,!0)),e.\u0275\u0275NgOnChangesFeature],decls:2,vars:1,consts:[[1,"kpi-wrapper"],["class","kpi",3,"viewModel","useOnPushChangeDetection","on-resize",4,"ngIf"],[1,"kpi",3,"viewModel","useOnPushChangeDetection","on-resize"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Fu,1,2,"visual-modern",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isLoaded))},dependencies:[F.NgIf,to.y,Hr.O],styles:["[_nghost-%COMP%]{min-height:150px;display:flex;height:100%;width:100%}.kpi-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}.kpi-wrapper[_ngcontent-%COMP%]   .kpi[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}"],changeDetection:0}),o}();function Au(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"table",1)(1,"tbody")(2,"tr")(3,"td",2)(4,"div",3),e.\u0275\u0275element(5,"div",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"td",5),e.\u0275\u0275element(7,"goal-value-cell",6)(8,"goal-change-cell",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td",8),e.\u0275\u0275element(10,"goal-sparkline-cell",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"td",9),e.\u0275\u0275elementEnd()()()),2&o){var i,a,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal)("showCurrent",!0)("showTarget",null!==(i=null==t.goal.metadata?null:t.goal.metadata.showFinalTarget)&&void 0!==i?i:!t.goal.targetConnection)("showMilestone",!(null!==(a=null==t.goal.metadata?null:t.goal.metadata.showFinalTarget)&&void 0!==a?a:!t.goal.targetConnection)),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color)}}var Ru=function(){function o(){this.color=ne.gT.ColorPalette[0]}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-row-preview"]],inputs:{goal:"goal",color:"color"},decls:1,vars:1,consts:[["class","scorecard-table2","width","100%",4,"ngIf"],["width","100%",1,"scorecard-table2"],[1,"cell","cell-left-edge"],[1,"cell-box"],[1,"color-box"],["colspan","2",1,"cell","cell-value"],[3,"goal","showCurrent","showTarget","showMilestone"],[3,"goal"],["colspan","2",1,"cell","cell-sparkline"],[1,"cell","cell-value","cell-right-edge"]],template:function(t,i){1&t&&e.\u0275\u0275template(0,Au,12,16,"table",0),2&t&&e.\u0275\u0275property("ngIf",i.goal)},dependencies:[F.NgIf,Nr,ai,li],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background:var(--scorecard-tableRowBackgroundColor);padding-right:10px;border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .rotate90[_ngcontent-%COMP%]{transform:rotate(-90deg)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .collapse-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:48px;min-width:48px;background-color:transparent;border:none}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex-grow:1;max-height:3.6em;line-height:1.8em}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .cell-owner[_ngcontent-%COMP%]{width:250px;max-width:300px}[_nghost-%COMP%]   .cell-progress-icon[_ngcontent-%COMP%]{width:220px;max-width:250px;text-align:center;padding-right:20px}[_nghost-%COMP%]   .cell-sparkline[_ngcontent-%COMP%]{width:150px;overflow:hidden}[_nghost-%COMP%]   .cell-due-date[_ngcontent-%COMP%]{width:150px}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]{width:51px;text-align:center}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]   .context-menu-icon[_ngcontent-%COMP%]{color:var(--gray-140, #484644);font-size:16px;cursor:pointer}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]{width:220px}[_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]{width:92px}[_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]{width:72px}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   goal-actions-cell[_ngcontent-%COMP%], [_nghost-%COMP%]:focus-within   goal-actions-cell[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .selected-goal.cell[_ngcontent-%COMP%]{border-top:2px solid var(--borderColor);border-bottom:2px solid var(--borderColor)}[_nghost-%COMP%]   .selected-goal.cell-right-edge[_ngcontent-%COMP%]{border-right:2px solid var(--borderColor)}[_nghost-%COMP%]   .cell-right-edge[_ngcontent-%COMP%]{width:2px;border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}  .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}"],changeDetection:0}),o}(),Lu={day:"numeric",month:"numeric",year:"2-digit"},Bl=function(){function o(){}return o.prototype.transform=function(n,t){return new Date(n).toLocaleDateString(t,Lu)},o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.\u0275\u0275definePipe({name:"formatDate",type:o,pure:!0}),o}(),Gu=["chart"];function Nu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",null==t.goal?null:t.goal.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",null==t.goal?null:t.goal.scorecardName," ")}}function Hu(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function zu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",31)(1,"span",32),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,2,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString))}}function Bu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",31)(1,"span",32),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",33),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,3,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.valueChange.period)}}function Uu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",28)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,zu,4,6,"span",29),e.\u0275\u0275template(4,Bu,6,7,"ng-template",null,30,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"span"),e.\u0275\u0275text(7,")"),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("(",i.valueChange.isIncrease?"\u2191":"\u2193",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.periodLocalizeString&&!i.periodLocalizeString.endsWith("Custom"))("ngIfElse",t)}}function qu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Hu,1,0,"ng-container",26),e.\u0275\u0275template(2,Uu,8,3,"div",27),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(22);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",i),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.settings.showGoalVisualGrowth&&!(t.supportCategoricalValues&&null!=t.goal&&t.goal.valuesCategoryId)&&t.hasData&&t.valueChange)}}var Wu=function(n){return{userEmail:n}};function ju(o,n){if(1&o&&e.\u0275\u0275element(0,"user-details-host",37),2&o){var i,t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Wu,t.owners[0]))("photoSize",null!==(i=t.settings.goalVisualOwnerPhotoSize)&&void 0!==i?i:20)("showUserInfo",t.showOwnerName)("showTooltip",!0)}}function $u(o,n){if(1&o&&e.\u0275\u0275element(0,"avatar-row",38),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("emails",t.owners)("numAvatarsToShow",t.OwnersToShow)}}function Qu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",34),e.\u0275\u0275template(1,ju,1,6,"user-details-host",35),e.\u0275\u0275template(2,$u,1,2,"ng-template",null,36,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===i.owners.length)("ngIfElse",t)}}function Ku(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"h1",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",null==t.goal?null:t.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",null==t.goal?null:t.goal.name," ")}}function Xu(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"section",41)(1,"div",42,43),e.\u0275\u0275element(3,"goal-history-chart",44),e.\u0275\u0275elementEnd()()),2&o){var i,t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("values",t.goal.goalValues)("formatString",t.goal.valuesFormatString)("color",null!==(i=null==t.settings.theme?null:t.settings.theme.goalVisualCurrentLineColor)&&void 0!==i?i:t.statusColor)("targetLineColor",null==t.settings.theme?null:t.settings.theme.goalVisualTargetLineColor)("showGoalTargets",t.supportMultipleTargets&&t.settings.showGoalVisualTargetLine)("legend",t.supportMultipleTargets&&t.settings.showGoalVisualLegends?"Visible":"None")("showZoom",!1)("shadeCurrentArea",t.shadeCurrentArea)("type","ComboChart")("axesOptions",t.axesOptions)}}function Zu(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Xu,4,10,"section",40),e.\u0275\u0275elementContainerEnd()),2&o){var i,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null===(i=t.settings.showVisualization)||void 0===i||i)}}function Yu(o,n){if(1&o&&e.\u0275\u0275element(0,"status-icon",45),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("status",null==t.currentValue?null:t.currentValue.status)("goalStatuses",t.goal.goalStatuses)}}function Ju(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"label",46),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatDate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,1,t.goal.completionDate,t.locale),"")}}function ed(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",50),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.goal.notesCount," ")}}function td(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",47),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.openNotes())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",48),e.\u0275\u0275template(3,ed,2,1,"span",49),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,2,"Notes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.goal.notesCount>0)}}function nd(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function rd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",51),e.\u0275\u0275template(1,nd,1,0,"ng-container",26),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(22);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function id(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",52)(1,"div",53)(2,"div",54),e.\u0275\u0275pipe(3,"formatValue"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"formatValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",55),e.\u0275\u0275pipe(7,"formatValue"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"formatValue"),e.\u0275\u0275elementEnd()()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(3,4,t.currentValue.value,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(5,8,t.currentValue.value,t.goal.valuesFormatString)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(7,11,t.currentValue.target,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" /",e.\u0275\u0275pipeBind2(9,15,t.currentValue.target,t.goal.valuesFormatString)," ")}}function od(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.onEdit())}),e.\u0275\u0275element(2,"tri-svg-icon",22)(3,"span",56),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("name","edit_20_regular"))}var dl=function(){function o(n,t,i,a,l){this.appSettings=n,this.featureSwitches=t,this.localizationService=i,this.cd=a,this.scorecardHost=l,this.currentValue=null,this.showGrowth=!1,this.showOwnerName=!1,this.shadeCurrentArea=!0,this.owners=[],this.OwnersToShow=4,this.supportCategoricalValues=this.featureSwitches.featureSwitches.goalsCategoricalValues,this.supportMultipleTargets=this.featureSwitches.featureSwitches.powerBIGoalsMultipleTargets}return Object.defineProperty(o.prototype,"scorecardRoutePath",{get:function(){return"/groups/".concat(this.goal.groupId||"me","/scorecards/").concat(this.goal.scorecardId).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"inServiceUrl",{get:function(){return"".concat(this.appSettings.baseUrl).concat(this.scorecardRoutePath,"?goal=").concat(this.goal.id)},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){var t,i,a,n=this;u.fF.assertValue(this.goal,"Missing goal"),this.setDisplayedVals(),this.locale=this.localizationService.currentLanguageLocale,this.supportCategoricalValues&&null!==(t=this.goal)&&void 0!==t&&t.valuesCategoryId&&(this.categories=null!==(a=null===(i=_.find(this.goal.goalValueCategories,function(l){return l.id===n.goal.valuesCategoryId}))||void 0===i?void 0:i.categories)&&void 0!==a?a:[])},o.prototype.ngOnChanges=function(n){var t,i,a,l,c,p,y,O;if(n.goal&&(this.setDisplayedVals(),this.supportCategoricalValues&&n.goal.currentValue.valuesCategoryId&&(this.categories=null!==(a=null===(i=_.find(this.goal.goalValueCategories,function(L){return L.id===n.goal.currentValue.valuesCategoryId}))||void 0===i?void 0:i.categories)&&void 0!==a?a:[]),this.owners=this.goal.owner?[this.goal.owner]:[],this.goal.additionalOwners&&(t=this.owners).push.apply(t,this.goal.additionalOwners.map(function(L){return L.userPrincipalName}))),n.settings){this.cd.markForCheck();var A=n.settings.currentValue;this.isEditMode=!A?.disableEdit,this.axesOptions={xAxis:{show:null===(l=A?.showGoalVisualXAxis)||void 0===l||l,fontProperties:null===(c=A?.theme)||void 0===c?void 0:c.goalVisualXAxis},yAxis:{show:null===(p=A?.showGoalVisualYAxis)||void 0===p||p,fontProperties:null===(y=A?.theme)||void 0===y?void 0:y.goalVisualYAxis}},this.shadeCurrentArea=null===(O=A?.currentAreaShaded)||void 0===O||O}},o.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=W.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},o.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},o.prototype.openNotes=function(){this.scorecardHost.openNotes(this.goal)},o.prototype.onEdit=function(){this.scorecardHost.editGoal()},o.prototype.onOpenInService=function(){this.scorecardHost.openLink(this.inServiceUrl)},o.prototype.setDisplayedVals=function(){var n;this.currentValue=Ke.r.buildCurrentGoalValue(this.goal),this.valueChange=Ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.periodLocalizeString=_.isNil(null===(n=this.valueChange)||void 0===n?void 0:n.period)?void 0:"PercentGrowth_"+this.getPeriodSuffix(this.valueChange.period);var i=Q.p.getGoalStatus(this.currentValue.status,this.goal.goalStatuses);this.statusColor=Q.p.getGoalSparklineColor(i.color),this.sparklineValues=Ir.buildSparklineValues(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasData=_.some(this.sparklineValues)},o.prototype.getPeriodSuffix=function(n){switch(n){case"Period_DoD":case"Period_MoM":case"Period_QoQ":case"Period_WoW":case"Period_YoY":return n;default:return"Period_Custom"}},o.componentId="GoalTileComponentId",o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Eo.de),e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(en,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goal-tile"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Gu,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.chart=a.first))},inputs:{goal:"goal",settings:"settings"},features:[e.\u0275\u0275NgOnChangesFeature],decls:32,vars:17,consts:[[1,"goal-tile"],[1,"header-container"],["class","scorecard-name",3,"pbiTooltip",4,"ngIf"],[1,"details"],[1,"value-and-growth"],[4,"ngIf"],["class","owners",4,"ngIf"],["class","goal-name",3,"pbiTooltip",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"footer-container"],[1,"status-and-date"],[3,"status","goalStatuses",4,"ngIf"],[1,"target-date"],[1,"notes-and-menu"],["mat-icon-button","",3,"pbiTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["fontIcon","pbi-glyph-more",1,"glyph-small"],["noChart",""],["valueAndTarget",""],[1,"context-menu-dropdown",3,"xPosition"],["contextMenu","matMenu"],["mat-menu-item","",1,"goal-tile-context-menu-item",3,"click"],["tri-svg-icon-16","",3,"name"],["localize","OpenScorecard"],["localize","OpenNotes"],[1,"scorecard-name",3,"pbiTooltip"],[4,"ngTemplateOutlet"],["class","growth",4,"ngIf"],[1,"growth"],["class","period","localize-fragments","",3,"localize",4,"ngIf","ngIfElse"],["customPeriod",""],["localize-fragments","",1,"period",3,"localize"],["fragment-index","0"],["fragment-index","1"],[1,"owners"],[3,"details","photoSize","showUserInfo","showTooltip",4,"ngIf","ngIfElse"],["hasMultipleOwners",""],[3,"details","photoSize","showUserInfo","showTooltip"],[3,"emails","numAvatarsToShow"],[1,"goal-name",3,"pbiTooltip"],["class","visual-container",4,"ngIf"],[1,"visual-container"],[1,"visual"],["chart",""],[3,"values","formatString","color","targetLineColor","showGoalTargets","legend","showZoom","shadeCurrentArea","type","axesOptions"],[3,"status","goalStatuses"],["localize","Due"],["mat-icon-button","",3,"pbiTooltip","click"],["tri-svg-icon-16","","name","comment_16_regular",1,"tri-svg"],["class","notes-count",4,"ngIf"],[1,"notes-count"],[1,"no-chart"],[1,"value-wrapper"],[1,"value-target"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip"],["localize","Edit_Metric"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"section",1),e.\u0275\u0275template(2,Nu,2,2,"div",2),e.\u0275\u0275elementStart(3,"div",3)(4,"div",4),e.\u0275\u0275template(5,qu,3,2,"ng-container",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,Qu,4,2,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Ku,2,2,"h1",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Zu,2,1,"ng-container",8),e.\u0275\u0275elementStart(9,"section",9)(10,"div",10),e.\u0275\u0275template(11,Yu,1,2,"status-icon",11),e.\u0275\u0275elementStart(12,"div",12),e.\u0275\u0275template(13,Ju,5,4,"ng-container",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"div",13),e.\u0275\u0275template(15,td,4,4,"button",14),e.\u0275\u0275elementStart(16,"button",15),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275element(18,"mat-icon",16),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(19,rd,2,1,"ng-template",null,17,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(21,id,10,18,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-menu",19,20),e.\u0275\u0275template(25,od,4,1,"ng-container",5),e.\u0275\u0275elementStart(26,"button",21),e.\u0275\u0275listener("click",function(){return i.onOpenInService()}),e.\u0275\u0275element(27,"tri-svg-icon",22)(28,"span",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"button",21),e.\u0275\u0275listener("click",function(){return i.openNotes()}),e.\u0275\u0275element(30,"tri-svg-icon",22)(31,"span",24),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(20),l=e.\u0275\u0275reference(24);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualScorecardName),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.hasData),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualOwner&&i.owners.length>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualGoalName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.hasData)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualStatus),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualDueDate&&(null==i.goal?null:i.goal.completionDate)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.settings.showGoalVisualNotes),e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",l),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(17,15,"HotkeyDialog_Open_Context_Menu")),e.\u0275\u0275advance(7),e.\u0275\u0275property("xPosition","after"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.isEditMode),e.\u0275\u0275advance(2),e.\u0275\u0275property("name","open_20_regular"),e.\u0275\u0275advance(3),e.\u0275\u0275property("name","note_20_regular")}},dependencies:[F.NgIf,F.NgTemplateOutlet,Sn.X,vn.Hw,Jt.W0,Jt.tN,Jt.D8,oe.V,Er.M,D.s,Fe,no,zr,Bt.F,$r.D,xr.c,Bl],styles:['.goal-tile[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;width:100%;height:100%;color:var(--fluent-theme-neutral-primary-alt-color, #3B3A39);background-color:var(--scorecard-goalVisualBackgroundColor);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);white-space:nowrap}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:4px 7px;color:var(--fluent-theme-black-color, #000)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .scorecard-name[_ngcontent-%COMP%]{margin:0 0 4px;color:var(--scorecard-goalVisualScorecardName-color);font-size:var(--scorecard-goalVisualScorecardName-size);font-family:var(--scorecard-goalVisualScorecardName-family);font-weight:var(--scorecard-goalVisualScorecardName-weight);font-style:var(--scorecard-goalVisualScorecardName-style);text-decoration:var(--scorecard-goalVisualScorecardName-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualCurrentValue-color);font-size:var(--scorecard-goalVisualCurrentValue-size);font-family:var(--scorecard-goalVisualCurrentValue-family);font-weight:var(--scorecard-goalVisualCurrentValue-weight);font-style:var(--scorecard-goalVisualCurrentValue-style);text-decoration:var(--scorecard-goalVisualCurrentValue-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualTargetValue-color);font-size:var(--scorecard-goalVisualTargetValue-size);font-family:var(--scorecard-goalVisualTargetValue-family);font-weight:var(--scorecard-goalVisualTargetValue-weight);font-style:var(--scorecard-goalVisualTargetValue-style);text-decoration:var(--scorecard-goalVisualTargetValue-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:6px;color:var(--scorecard-goalVisualGrowth-color);font-size:var(--scorecard-goalVisualGrowth-size);font-family:var(--scorecard-goalVisualGrowth-family);font-weight:var(--scorecard-goalVisualGrowth-weight);font-style:var(--scorecard-goalVisualGrowth-style);text-decoration:var(--scorecard-goalVisualGrowth-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:8px;width:8px}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{padding-left:4px}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]{display:flex;align-items:center}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]     .user-info{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]     .user-image{margin:0}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .goal-name[_ngcontent-%COMP%]{margin:4px 0;color:var(--scorecard-goalVisualGoalName-color);font-size:var(--scorecard-goalVisualGoalName-size);font-family:var(--scorecard-goalVisualGoalName-family);font-weight:var(--scorecard-goalVisualGoalName-weight);font-style:var(--scorecard-goalVisualGoalName-style);text-decoration:var(--scorecard-goalVisualGoalName-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]{flex:1;display:flex}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]   goal-history-chart[_ngcontent-%COMP%]{width:100%;flex:1}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{margin:auto}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:34px}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:22px}.goal-tile[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{display:flex;align-items:baseline}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%], .goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .notes-and-menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:var(--scorecard-goalVisualDueDate-color);font-size:var(--scorecard-goalVisualDueDate-size);font-family:var(--scorecard-goalVisualDueDate-family);font-weight:var(--scorecard-goalVisualDueDate-weight);font-style:var(--scorecard-goalVisualDueDate-style);text-decoration:var(--scorecard-goalVisualDueDate-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]{padding-right:10px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]     .status{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;height:14px;line-height:14px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;padding:0;border:none;background:none;height:100%;width:32px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:before{vertical-align:middle}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualNotes-color);font-size:var(--scorecard-goalVisualNotes-size)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .notes-count[_ngcontent-%COMP%]{position:absolute;font-size:9px;font-weight:600;top:-1px;right:3px;border-radius:30px;padding:1px 4px;background:var(--fluent-theme-primary-color, #F2C811);color:var(--text-primary-content-color-hc, #000)}  .context-menu-dropdown{min-height:unset}  .context-menu-dropdown .mat-menu-content{padding:4px!important}  .context-menu-dropdown .mat-menu-content .goal-tile-context-menu-item{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;padding:0 8px!important;max-height:32px}  .context-menu-dropdown .mat-menu-content .goal-tile-context-menu-item tri-svg-icon{margin-right:4px}'],changeDetection:0}),o}();function ad(o,n){1&o&&e.\u0275\u0275elementContainer(0)}var Ul=function(){function o(){}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["goals-tooltip"]],inputs:{args:"args"},decls:2,vars:2,consts:[["role","tooltip",1,"pbi-goals-tooltip-content","themeableElement",3,"id"],[4,"ngTemplateOutlet"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,ad,1,0,"ng-container",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("id",i.args.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",i.args.templateRef))},dependencies:[F.NgTemplateOutlet],styles:["@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0}to{opacity:1}}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;overflow:auto;border-radius:2px;border:1px solid var(--scorecard-backgroundColor);background-color:var(--scorecard-backgroundColor);color:var(--scorecard-neutralPrimaryColor);box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 8px 16px var(--colorNeutralShadowKey);animation:_ngcontent-%COMP%_fade-in .15s ease;font-size:var(--sm-font-size, 12px);word-break:break-word}.pbi-goals-tooltip-content[_ngcontent-%COMP%]{background-color:var(--scorecard-backgroundColor);z-index:1;padding:7px}"],changeDetection:0}),o}(),pl=function(){function o(n,t,i,a){this.sideFlyoutService=n,this.scorecardService=t,this.hierarchyService=i,this.telemetryService=a,this._showHierarchiesPane$=new ye.X(!1),this._showHeatmapConfigurationPane$=new ye.X(!1),this._showHeatmapDisplaySettingsPane$=new ye.X(!1),this.showHierarchiesPane$=this._showHierarchiesPane$.asObservable(),this.showHeatmapConfigurationPane$=this._showHeatmapConfigurationPane$.asObservable(),this.showHeatmapDisplaySettingsPane$=this._showHeatmapDisplaySettingsPane$.asObservable()}return o.prototype.openHierarchiesBuilder=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,a,l=this;return(0,M.__generator)(this,function(c){switch(c.label){case 0:return this.telemetryService.logEvent(St,{entryPoint:n}),t=new Gr.t(1),this.sideFlyoutService.show({componentManifest:{componentId:"HierarchyBuilderPaneComponentId",modulePath:"@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule",inputArgs:{scorecard$:this.scorecardService.getScorecard(),close:function(y){l.sideFlyoutService.hide(),t.next(y),t.complete()},saveQueryHierarchyAsUser:function(y){l.scorecardService.updateScorecard({queryHierarchyAsUser:y})}}},paneClass:"hierarchy-builder"}),[4,t.toPromise()];case 1:return c.sent()&&(a=this.scorecardService.getCurrentScorecard(),this.scorecardService.setActiveHierarchy(void 0),this.hierarchyService.loadHierarchies(a.groupId,a.id,!1)),[2]}})})},o.prototype.showHierarchiesPane=function(){this._showHierarchiesPane$.next(!0)},o.prototype.hideHierarchiesPane=function(){this._showHierarchiesPane$.next(!1)},o.prototype.showHeatmapConfigurationPane=function(){this.hideHeatmapDisplaySettingsPane(),this._showHeatmapConfigurationPane$.next(!0)},o.prototype.hideHeatmapConfigurationPane=function(){this._showHeatmapConfigurationPane$.next(!1)},o.prototype.showHeatmapDisplaySettingsPane=function(){this.hideHeatmapConfigurationPane(),this._showHeatmapDisplaySettingsPane$.next(!0)},o.prototype.hideHeatmapDisplaySettingsPane=function(){this._showHeatmapDisplaySettingsPane$.next(!1)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(mo.p),e.\u0275\u0275inject(gt),e.\u0275\u0275inject(Jn),e.\u0275\u0275inject(ji.y0))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),ql=function(){function o(n,t,i){this.goalsHttpService=n,this.scorecardService=t,this.goalsErrorService=i,this._viewsById$=new ye.X(null),this._isSaving$=new ye.X(!1),this._isLoading$=new ye.X(!1),this.isLoading$=this._isLoading$,this.isSaving$=this._isSaving$,this.views$=this._viewsById$.pipe((0,On.h)(function(a){return!!a}),(0,G.x)(),(0,dt.U)(function(a){return _.values(a)}),(0,dr.d)({bufferSize:1,refCount:!0}))}return Object.defineProperty(o.prototype,"defaultListView",{get:function(){return _.find(this._viewsById$.value,function(t){return t.isDefault&&"List"===t.viewType})},enumerable:!1,configurable:!0}),o.prototype.getDefaultView=function(n){return this.views$.pipe((0,dt.U)(function(t){return _.find(t,function(i){return i.isDefault&&i.viewType===n})}))},o.prototype.loadViews=function(n){return void 0===n&&(n=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:if(t=this.scorecardService.getCurrentScorecard(),!n&&null!==this._viewsById$.value||this._isLoading$.value)return[2];this._isLoading$.next(!0),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.goalsHttpService.getScorecardViews(t.groupId,t.id).toPromise()];case 2:return i=a.sent(),this._viewsById$.next(_.keyBy(i,function(l){return l.id})),[3,4];case 3:return this._isLoading$.next(!1),[7];case 4:return[2]}})})},o.prototype.saveView=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return t=this.scorecardService.getCurrentScorecard(),[4,this.loadViews()];case 1:a.sent(),this._isSaving$.next(!0),a.label=2;case 2:return a.trys.push([2,8,9,10]),this._viewsById$.value[n.id]?[4,this.goalsHttpService.updateScorecardView(t.groupId,t.id,n).toPromise()]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,this.goalsHttpService.createScorecardView(t.groupId,t.id,n).toPromise()];case 5:a.sent(),a.label=6;case 6:return[4,this.loadViews(!0)];case 7:return a.sent(),[3,10];case 8:return i=a.sent(),this.goalsErrorService.showUserError(i,"SaveViewError"),[3,10];case 9:return this._isSaving$.next(!1),[7];case 10:return[2]}})})},o.prototype.clearCache=function(){this._viewsById$.next(null)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Lt),e.\u0275\u0275inject(gt),e.\u0275\u0275inject(Oo))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Pl=function(){function o(n,t,i,a,l){var c=this;this.scorecardService=n,this.hierarchyService=t,this.localizationService=i,this.viewsService=a,this.goalsHttpService=l,this._goalsByHierarchyItemId$=new ye.X({}),this._selectedHierarchyItems$=new ye.X([]),this._displaySettings$=new ye.X({}),this.onDestroy$=new je.xQ,this._isLoadingView$=new ye.X(!1),this.hierarchyService.hierarchyItems$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(p){var y;if(c._selectedHierarchyItems$.value.length>1){for(var O=[],A=(0,M.__assign)({},c._goalsByHierarchyItemId$.value),L=0,te=c._selectedHierarchyItems$.value;L<te.length;L++){var ue=te[L];if(ue.id){var Ne=null===(y=io([Pi(ue)],p))||void 0===y?void 0:y[0];if(Ne?.id&&Ne.id!==ue.id){O.push(Ne),A[Ne.id]=A[ue.id],delete A[ue.id];continue}}O.push(ue)}c._selectedHierarchyItems$.next(O),c._goalsByHierarchyItemId$.next(A)}}),this.totalItem={id:void 0,value:this.localizationService.get("Visual_Totals"),parent:void 0,parentHierarchyItemId:void 0,level:0},this._hasViewChanges$=(0,zn.aj)([this.selectedHierarchyItems$,this.viewsService.getDefaultView("Heatmap")]).pipe((0,dt.U)(function(p){var y=p[0],O=p[1];return O?!_.isEqual(si(y),O.heatmapViewDetails.hierarchyItemPaths):_.size(y)>1}),(0,dr.d)({bufferSize:1,refCount:!0})),this._hasSettingsChanges$=(0,zn.aj)([this._displaySettings$,this.viewsService.getDefaultView("Heatmap")]).pipe((0,dt.U)(function(p){var y,O=p[0],A=p[1],L=null!==(y=A?.heatmapViewDetails.heatmapDisplaySettings)&&void 0!==y?y:ne.rl;return!_.isEqual(O,L)}),(0,dr.d)({bufferSize:1,refCount:!0}))}return o.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Object.defineProperty(o.prototype,"goalsByHierarchyItemId$",{get:function(){return this._goalsByHierarchyItemId$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selectedHierarchyItems$",{get:function(){return this._selectedHierarchyItems$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selectedHierarchyItems",{get:function(){return this._selectedHierarchyItems$.value},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"displaySettings$",{get:function(){return this._displaySettings$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasViewChanges$",{get:function(){return this._hasViewChanges$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasSettingsChanges$",{get:function(){return this._hasSettingsChanges$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isSaving$",{get:function(){return this.viewsService.isSaving$},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isLoading$",{get:function(){return this._isLoadingView$},enumerable:!1,configurable:!0}),o.prototype.addHierarchyItem=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t;return(0,M.__generator)(this,function(i){switch(i.label){case 0:return t=_.uniqBy((0,M.__spreadArray)((0,M.__spreadArray)([],this._selectedHierarchyItems$.value,!0),[n],!1),function(a){return a.id}),this._selectedHierarchyItems$.next(t),[4,this.loadGoalsForHierarchyItem(n)];case 1:return i.sent(),[2]}})})},o.prototype.removeHierarchyItem=function(n){n.id?this._selectedHierarchyItems$.next(_.filter(this._selectedHierarchyItems$.value,function(t){return t.id!==n.id})):u.fF.assertFail("Cannot remove totals")},o.prototype.setHierarchyItems=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a,l;return(0,M.__generator)(this,function(p){switch(p.label){case 0:for(t=_.uniqBy((0,M.__spreadArray)([this.totalItem],n,!0),function(y){return y.id}),this._selectedHierarchyItems$.next(t),i=[],a=0,l=t;a<l.length;a++)i.push(this.loadGoalsForHierarchyItem(l[a]));return[4,Promise.all(i)];case 1:return p.sent(),[2]}})})},o.prototype.reset=function(n){void 0===n&&(n=!1),this._selectedHierarchyItems$.next([this.totalItem]),n&&this.clearCache()},o.prototype.refreshAll=function(){for(var n=0,t=this._selectedHierarchyItems$.value;n<t.length;n++)this.loadGoalsForHierarchyItem(t[n],!0)},o.prototype.clearCache=function(){this._goalsByHierarchyItemId$.next({})},o.prototype.loadDefaultView=function(n,t,i){var a,l;return(0,M.__awaiter)(this,void 0,void 0,function(){var c,p,y;return(0,M.__generator)(this,function(O){switch(O.label){case 0:if(!n&&!t)return u.fF.assertFail("loadDefaultView called without restoring items or settings"),[2];this._isLoadingView$.next(!0),O.label=1;case 1:return O.trys.push([1,,8,9]),[4,this.viewsService.loadViews(!1)];case 2:return O.sent(),[4,this.viewsService.getDefaultView("Heatmap").pipe((0,Me.q)(1)).toPromise()];case 3:return c=O.sent(),t&&(p=null===(a=c?.heatmapViewDetails)||void 0===a?void 0:a.heatmapDisplaySettings,this.setDisplaySettings((0,M.__assign)((0,M.__assign)({},ne.rl),p))),n?(y=void 0,c?[4,this.hierarchyService.getHierarchyItemsForPath(null===(l=c?.heatmapViewDetails)||void 0===l?void 0:l.hierarchyItemPaths).pipe((0,Me.q)(1)).toPromise()]:[3,5]):[3,7];case 4:y=O.sent(),O.label=5;case 5:return[4,this.setHierarchyItems(y=y||i||[])];case 6:O.sent(),O.label=7;case 7:return[3,9];case 8:return this._isLoadingView$.next(!1),[7];case 9:return[2]}})})},o.prototype.saveView=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){var i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return n||t?[4,this.viewsService.getDefaultView("Heatmap").pipe((0,Me.q)(1)).toPromise()]:(u.fF.assertFail("saveView called without saving items or settings"),[2]);case 1:return i=a.sent(),i=_.cloneDeep(i)||{isDefault:!0,name:"",viewType:"Heatmap",id:void 0,scorecardId:this.scorecardId,heatmapViewDetails:{heatmapDisplaySettings:void 0,hierarchyItemPaths:void 0}},n&&(i.heatmapViewDetails.hierarchyItemPaths=si(this.selectedHierarchyItems)),t&&(i.heatmapViewDetails.heatmapDisplaySettings=this._displaySettings$.value),[4,this.viewsService.saveView(i)];case 2:return a.sent(),[2]}})})},o.prototype.loadGoalsForHierarchyItem=function(n,t){return void 0===t&&(t=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var i,a,l,c=this;return(0,M.__generator)(this,function(p){switch(p.label){case 0:return i=this.scorecardService.getCurrentScorecard(),u.fF.assertValue(i,"scorecard not loaded"),this.scorecardId!==i.id&&(this._goalsByHierarchyItemId$.next({}),this.scorecardId=i.id,t=!0),!t&&this._goalsByHierarchyItemId$.value[n?.id]?[2]:(this._goalsByHierarchyItemId$.next((0,M.__assign)((0,M.__assign)({},this._goalsByHierarchyItemId$.value),((l={})[n?.id]={},l))),a=n?.id?si([n]):void 0,[4,this.goalsHttpService.getScorecard(i.groupId,i.id,!0,a).toPromise().then(function(y){var O,A=c.checkGoalsConnectedToHierarchy(a,y.goals),L=_.keyBy(A,"id");c._goalsByHierarchyItemId$.next((0,M.__assign)((0,M.__assign)({},c._goalsByHierarchyItemId$.value),((O={})[n?.id]=L,O)))}).catch(function(y){var O;u.fF.assertFail(y),c._goalsByHierarchyItemId$.next((0,M.__assign)((0,M.__assign)({},c._goalsByHierarchyItemId$.value),((O={})[n?.id]=null,O)))})]);case 1:return p.sent(),[2]}})})},o.prototype.setDisplaySettings=function(n){this._displaySettings$.next(n)},o.prototype.checkGoalsConnectedToHierarchy=function(n,t){var i=this;return _.map(t,function(a){var l,c,p=!_.isEmpty(n),y=p&&a.valueConnection&&!i.hierarchyService.isDatasetMappedToHierarchyPath(null===(l=a.valueConnection)||void 0===l?void 0:l.datasetId,n),O=p&&a.targetConnection&&!i.hierarchyService.isDatasetMappedToHierarchyPath(null===(c=a.targetConnection)||void 0===c?void 0:c.datasetId,n);return(0,M.__assign)((0,M.__assign)({},a),{isCurrentValueNotConnectedToHierarchy:y,isTargetValueNotConnectedToHierarchy:O})})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(gt),e.\u0275\u0275inject(Jn),e.\u0275\u0275inject(Vt.o),e.\u0275\u0275inject(ql),e.\u0275\u0275inject(Lt))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Wl=m(18460);function sd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("title",t.valueTooltip),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind3(2,2,t.currentValue.value,t.categories,t.formatString)," ")}}function ld(o,n){if(1&o&&e.\u0275\u0275element(0,"goal-change-cell",10),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("goal",t.goal)("arrowSize",t.changeArrowSize)("nilDisplayString","\u2014")}}function cd(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,sd,3,6,"div",7),e.\u0275\u0275template(2,ld,1,3,"goal-change-cell",8),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.displaySettings.showValueChange),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showValueChange)}}function ud(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",11)(1,"span",12),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("targetOnly",!t.displaySettings.showCurrentValue),e.\u0275\u0275property("title",t.targetTooltip),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.displaySettings.showValueChange?"|":"/"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind3(4,5,t.currentValue.target,t.categories,t.formatString)," ")}}function dd(o,n){if(1&o&&e.\u0275\u0275element(0,"status-icon",13,14),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("status",null==t.currentValue?null:t.currentValue.status)("goalStatuses",t.goalStatuses)}}function pd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",2)(1,"div",3),e.\u0275\u0275template(2,cd,3,2,"ng-container",4),e.\u0275\u0275template(3,ud,5,9,"div",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,dd,2,2,"status-icon",6),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("background",t.backgroundColor),e.\u0275\u0275classProp("isSelected",t.isSelected),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.displaySettings.showCurrentValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showTargetValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showStatus)}}function hd(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",15)}var jl=function(){function o(n,t,i,a){this.localizationService=n,this.formatGoalValuePipe=t,this.featureSwitches=i,this.scorecardService=a,this.currentValue=null,this.changeArrowSize="mini"}return o.prototype.ngOnChanges=function(n){var t;if((n.goal||n.displaySettings)&&this.goal){this.currentValue=Ke.r.buildCurrentGoalValue(this.goal),this.categories=this.scorecardService.getGoalValueCategories(this.goal),this.goalStatuses=this.scorecardService.getGoalStatuses(this.goal);var i=Q.p.getGoalStatus(this.currentValue.status,this.goalStatuses).color;this.backgroundColor=this.displaySettings.showStatusColor?Q.p.getGoalStatusColor(i,!1,!1):void 0,this.formatString=this.goal.valuesFormatString,this.valueTooltip=this.goal.isCurrentValueNotConnectedToHierarchy?"".concat(this.localizationService.get("CurrentValue")," ").concat(this.localizationService.get("Metrics_Tooltip_ValueNotConnected")):this.formatGoalValuePipe.transform(this.currentValue.value,this.categories,this.goal.valuesFormatString,!1),this.targetTooltip=this.goal.isTargetValueNotConnectedToHierarchy?"".concat(this.localizationService.get("Role_DisplayName_TargetValue")," ").concat(this.localizationService.get("Metrics_Tooltip_ValueNotConnected")):this.formatGoalValuePipe.transform(this.currentValue.target,this.categories,this.goal.valuesFormatString,!1),this.displaySettings.showValueChange&&(this.valueChange=Ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.isCyclePeriodLabelLocalizable=Ke.r.isCyclePeriodLabelLocalizable(null===(t=this.valueChange)||void 0===t?void 0:t.period))}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject($r.D),e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["hierarchy-goal-cell"]],inputs:{goal:"goal",scorecard:"scorecard",displaySettings:"displaySettings",isSelected:"isSelected"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","cell",3,"background","isSelected",4,"ngIf","ngIfElse"],["loading",""],[1,"cell"],[1,"content"],[4,"ngIf"],["class","target",3,"title","targetOnly",4,"ngIf"],[3,"status","goalStatuses",4,"ngIf"],["class","value",3,"title",4,"ngIf"],[3,"goal","arrowSize","nilDisplayString",4,"ngIf"],[1,"value",3,"title"],[3,"goal","arrowSize","nilDisplayString"],[1,"target",3,"title"],[1,"slash"],[3,"status","goalStatuses"],["statusCell",""],[1,"pbi-spinner-small"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,pd,5,7,"div",0),e.\u0275\u0275template(1,hd,1,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",i.goal)("ngIfElse",a)}},dependencies:[F.NgIf,cr.k,Nr,zr,$r.D],styles:["[_nghost-%COMP%]{flex:1;height:100%;display:flex;flex-direction:column;justify-content:center}.cell[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;border-bottom:4px solid transparent}.content[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:flex-start;box-sizing:border-box;white-space:nowrap;width:100%;padding:0 6px}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]   .slash[_ngcontent-%COMP%]{margin:0 1px}.content[_ngcontent-%COMP%]   .target.targetOnly[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.content[_ngcontent-%COMP%]   .target.targetOnly[_ngcontent-%COMP%]   .slash[_ngcontent-%COMP%]{display:none}.content[_ngcontent-%COMP%]   goal-change-cell[_ngcontent-%COMP%]{display:flex;overflow:hidden;--container-align-items: baseline;--arrow-margin: 0 4px;--change-font-size: var(--vlg-font-size);--change-font-weight: var(--font-weight-semi-bold)}status-icon[_ngcontent-%COMP%]{display:flex;justify-content:center}status-icon[_ngcontent-%COMP%]     .status{font-size:var(--sm-font-size, 12px);line-height:16px;height:16px;width:fit-content}.isSelected[_ngcontent-%COMP%]{border-color:var(--fluent-theme-neutral-secondary-color, #605E5C)}"],changeDetection:0}),o}(),gd=["nameCell"],fd=["hierarchyGoalCell"],md=["columnHeader"];function vd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tree-list",6),e.\u0275\u0275listener("onResizeColumn",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeColumn(l))})("onExpansionChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onExpansionChange(l))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275classMap(i.heatmapClassname),e.\u0275\u0275property("columns",i.columns)("data",i.goals)("expandedNodeIds",i.expandedGoalIds)("getChildren",i.getSubgoals)("rowHash",i.rowHash)("rowHeight",i.rowHeight)("rowSpacing",i.rowSpacing)("stickyFirstColumn",!0)}}function _d(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-icon",10),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5);e.\u0275\u0275property("pbiTooltip",t)}}function Cd(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Metrics_Tooltip_LinkedHierarchical")," "))}function yd(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function bd(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"Role_DisplayName_TargetValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function wd(o,n){if(1&o&&(e.\u0275\u0275template(0,yd,6,6,"div",14),e.\u0275\u0275template(1,bd,6,6,"div",14)),2&o){var t=e.\u0275\u0275nextContext(2).data;e.\u0275\u0275property("ngIf",!t.valueConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.targetConnection)}}function Sd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,Cd,3,3,"div",12),e.\u0275\u0275template(2,wd,2,2,"ng-template",null,13,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isLinked)("ngIfElse",t)}}function Md(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){var c=e.\u0275\u0275restoreView(t).data,p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onGoalNameClicked(c))}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,_d,1,1,"pbi-icon",8),e.\u0275\u0275template(4,Sd,4,2,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()}if(2&o){var i=n.data;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isLinked||!i.valueConnection||!i.targetConnection)}}function Pd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"hierarchy-goal-cell",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var y=e.\u0275\u0275nextContext(),O=y.data,A=y.column,L=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(L.openGoalDetails(O,A.data))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(),a=i.column,l=i.data,c=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",null==c.goalsByHierarchyItemIds[a.data.id]?null:c.goalsByHierarchyItemIds[a.data.id][l.id])("scorecard",c.scorecard)("displaySettings",c.displaySettings)("isSelected",a.data.id===c.activeItemId&&l.id===c.scorecard.activeGoalId)}}function Od(o,n){1&o&&e.\u0275\u0275template(0,Pd,1,4,"hierarchy-goal-cell",16),2&o&&e.\u0275\u0275property("ngIf",!n.data.isLinked||!n.column.data.id)}function Ed(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div")(2,"span",29),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.hierarchyName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(": ",t.levels.join(" > "),"")}}function Td(o,n){1&o&&(e.\u0275\u0275elementStart(0,"span",29),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Visual_Totals")))}function xd(o,n){if(1&o&&(e.\u0275\u0275template(0,Ed,6,2,"ng-container",12),e.\u0275\u0275template(1,Td,3,3,"ng-template",null,28,e.\u0275\u0275templateRefExtractor)),2&o){var t=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext().column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",a.hierarchyPathsByKey[i.key])("ngIfElse",t)}}function Id(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().column,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.removeColumn(a.data))}),e.\u0275\u0275element(1,"pbi-icon",31)(2,"span",32),e.\u0275\u0275elementEnd()}}function Dd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.hierarchyPane.showHeatmapDisplaySettingsPane())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275element(2,"pbi-icon",33)(3,"span",34),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,i.hierarchyPane.showHeatmapDisplaySettingsPane$))}}function kd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",18)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"pbi-icon",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,xd,3,2,"ng-template",null,20,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"mat-menu",21,22),e.\u0275\u0275template(8,Id,3,0,"button",23),e.\u0275\u0275elementStart(9,"button",24),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var y=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(y.hierarchyPane.showHeatmapConfigurationPane())}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275element(11,"pbi-icon",25)(12,"span",26),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,Dd,4,3,"button",27),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=n.column,a=e.\u0275\u0275reference(5),l=e.\u0275\u0275reference(7),c=e.\u0275\u0275nextContext();e.\u0275\u0275property("matMenuTriggerFor",l)("pbiTooltip",a),e.\u0275\u0275attribute("aria-label",i.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.name),e.\u0275\u0275advance(4),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!i.data.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,8,c.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(14,10,c.canEditHeatmap$))}}function Vd(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-lazy-load",35),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.hierarchyModulePath)("componentId",t.heatmapConfigurationComponentId)}}function Fd(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-lazy-load",36),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.hierarchyModulePath)("componentId",t.heatmapDisplaySettingsComponentId)}}var $l=function(o){return o.Name="name",o}({}),hl="TOTAL";function Ql(o,n,t,i){void 0===i&&(i=0);for(var a=0,l=o;a<l.length;a++){var c=l[a];if(_.isEmpty(c.children)||Ql(c.children,n,t,i+1),n[c.id]&&(delete n[c.id],t.push((0,M.__assign)((0,M.__assign)({},c),{level:i}))),_.isEmpty(n))return}}var Kl=function(o){function n(t,i,a,l,c,p,y,O,A,L){var te=o.call(this)||this;return te.hierarchyPane=t,te.hierarchyService=i,te.detailsPaneLauncher=a,te.changeDetector=l,te.localization=c,te.heatmapService=p,te.scorecardService=y,te.scorecardConfigurationService=O,te.capabilityService=A,te.expansionService=L,te.columnsByKey={},te.hierarchyPathsByKey={},te.hierarchyModulePath="@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule",te.heatmapConfigurationComponentId="HeatmapConfigurationPaneComponentId",te.heatmapDisplaySettingsComponentId="HeatmapDisplaySettingsPaneComponentId",te.getSubgoals=function(ue){return te.getGoalNodes(ue.subGoals,ue)},te.rowHash=function(ue,Ae){return JSON.stringify(Ae)},te.rowHeight=50,te.rowSpacing=8,te.canEditHeatmap$=te.capabilityService.getScorecardCapabilities().pipe((0,dt.U)(function(ue){return ue.editHeatmap})),te}return(0,M.__extends)(n,o),n.prototype.ngOnInit=function(){var t=this;this.hierarchyPane.showHeatmapConfigurationPane();var i=this.scorecardService.getCurrentScorecard().hierarchyPaths;this.hierarchyService.getHierarchyItemsForPath(i).pipe((0,Me.q)(1)).subscribe(function(a){return t.heatmapService.loadDefaultView(!0,!0,a)}),this.scorecardService.setActiveHierarchy(void 0),this.scorecardService.getScorecard().pipe((0,ci.b)(function(a){t.scorecard=a,t.goals=t.getGoalNodes(a.goals),t.expandedGoalIds=t.expansionService.expandedGoalIds,t.changeDetector.markForCheck()}),(0,Rn.w)(function(a){return t.hierarchyService.getHierarchyItemsForPath(a.hierarchyPaths)}),(0,We.R)(this.onDestroy$)).subscribe(function(a){t.activeItemId=1===_.size(a)?a[0].id:void 0}),this.heatmapService.goalsByHierarchyItemId$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(a){t.goalsByHierarchyItemIds=a,t.changeDetector.markForCheck()}),this.heatmapService.displaySettings$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(a){t.displaySettings=a;var l="show-value-only";t.displaySettings.showCurrentValue&&t.displaySettings.showValueChange?l=t.displaySettings.showTargetValue?"show-change-target":"show-change-only":t.displaySettings.showCurrentValue&&t.displaySettings.showTargetValue&&(l="show-value-target"),t.heatmapClassname="heat-map "+l,t.changeDetector.markForCheck()})},n.prototype.ngAfterViewInit=function(){var t=this;this.updateColumns([]),this.heatmapService.selectedHierarchyItems$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(i){t.updateColumns(i),t.changeDetector.markForCheck()})},n.prototype.getCachedColumn=function(t,i){return this.columnsByKey[t]||(this.columnsByKey[t]=i()),this.columnsByKey[t]},n.prototype.updateColumns=function(t){var i=this,a=_.flatMap(Object.values(this.hierarchyService.hierarchyItems)),l=_.keyBy(t,function(p){var y;return null!==(y=p.id)&&void 0!==y?y:hl}),c=[];Ql(a,l,c,0),l[hl]&&(c.unshift(l[hl]),delete l[hl]),c.push.apply(c,Object.values(l)),t=c,this.columns=(0,M.__spreadArray)([this.getCachedColumn($l.Name,function(){return{key:$l.Name,name:i.localization.get("Name"),width:400,cellTemplate:i.nameCell}})],_.map(t,function(p){return i.getCachedColumn(p.id,function(){return{key:p.id,name:(0,lr.WU)(p.value),class:"column-center-name",resizable:!1,headerTemplate:i.columnHeader,cellTemplate:i.hierarchyGoalCell,data:p}})}),!0),t.forEach(function(p){if(p.id&&!i.hierarchyPathsByKey[p.id]){var y=Pi(p);i.hierarchyPathsByKey[p.id]=i.hierarchyService.formatHierarchyItemPath(y)}})},n.prototype.onGoalNameClicked=function(t){this.detailsPaneLauncher.openGoalDetails(this.scorecardService,t.id,Qr.Default,this.scorecardConfigurationService.getConfiguration()),this.changeDetector.markForCheck()},n.prototype.openGoalDetails=function(t,i){var a;return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(l){switch(l.label){case 0:return null!==(a=this.goalsByHierarchyItemIds[i?.id])&&void 0!==a&&a[t.id]?[4,this.scorecardService.setActiveHierarchy(i?.id?si([i]):void 0)]:[3,2];case 1:l.sent(),this.detailsPaneLauncher.openGoalDetails(this.scorecardService,t.id,Qr.Default,this.scorecardConfigurationService.getConfiguration()),this.changeDetector.markForCheck(),l.label=2;case 2:return[2]}})})},n.prototype.removeColumn=function(t){this.heatmapService.removeHierarchyItem(t)},n.prototype.onResizeColumn=function(t){this.columns[t.column].width=t.width},n.prototype.onExpansionChange=function(t){this.expansionService.expandGoals(t.added),this.expansionService.collapseGoals(t.removed)},n.prototype.getGoalNodes=function(t,i){return _.map(_.filter(t,function(a){return!a.isNew&&!a.isHidden}),function(a,l){return(0,M.__assign)((0,M.__assign)({},a),{style:i?i.style:{"border-color":ne.gT.ColorPalette[l%ne.gT.ColorPalette.length]},class:!1===a.isFilterMatch?"goal-not-match":""})})},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(pl),e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(Pl),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(bi.V),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Or))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["heat-map"]],viewQuery:function(i,a){if(1&i&&(e.\u0275\u0275viewQuery(gd,5),e.\u0275\u0275viewQuery(fd,5),e.\u0275\u0275viewQuery(md,5)),2&i){var l=void 0;e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.nameCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.hierarchyGoalCell=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(a.columnHeader=l.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:11,vars:7,consts:[[3,"class","columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","stickyFirstColumn","onResizeColumn","onExpansionChange",4,"ngIf"],["nameCell",""],["hierarchyGoalCell",""],["columnHeader",""],["class","configuration-pane",3,"modulePath","componentId",4,"ngIf"],["class","display-settings-pane",3,"modulePath","componentId",4,"ngIf"],[3,"columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","stickyFirstColumn","onResizeColumn","onExpansionChange"],[1,"name",3,"click"],["class","name-info","name","info","size","mini",3,"pbiTooltip",4,"ngIf"],["infoTooltip",""],["name","info","size","mini",1,"name-info",3,"pbiTooltip"],[1,"goal-info-tooltip"],[4,"ngIf","ngIfElse"],["manualTooltip",""],[4,"ngIf"],[1,"tooltip-value-label"],[3,"goal","scorecard","displaySettings","isSelected","click",4,"ngIf"],[3,"goal","scorecard","displaySettings","isSelected","click"],["mat-button","","cdkMonitorElementFocus","",1,"heatmap-column-header",3,"matMenuTriggerFor","pbiTooltip"],["name","chevrondownsmall","size","mini",1,"chevrondown"],["hierarchyPathTooltip",""],["xPosition","after",1,"heatmap-column-menu",3,"overlapTrigger"],["heatmapColumnMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"disabled","click"],["name","edit","size","small",1,"icon"],["localize","MetricsCustomizeHeatmap"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["total",""],[1,"tooltip-hierarchy-name"],["mat-menu-item","",3,"click"],["name","delete","size","small",1,"icon"],["localize","MetricsHierarchy_Builder_Remove_Level"],["name","settings","size","small",1,"icon"],["localize","DisplaySettings_Open"],[1,"configuration-pane",3,"modulePath","componentId"],[1,"display-settings-pane",3,"modulePath","componentId"]],template:function(i,a){1&i&&(e.\u0275\u0275template(0,vd,1,10,"tree-list",0),e.\u0275\u0275template(1,Md,6,2,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,Od,1,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,kd,15,12,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,Vd,1,2,"pbi-lazy-load",4),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,Fd,1,2,"pbi-lazy-load",5),e.\u0275\u0275pipe(10,"async")),2&i&&(e.\u0275\u0275property("ngIf",a.scorecard),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,3,a.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(10,5,a.hierarchyPane.showHeatmapDisplaySettingsPane$)))},dependencies:[F.NgIf,Wl.R,Sn.X,Jt.W0,Jt.tN,Jt.D8,Dn._,oe.V,jl,sa,F.AsyncPipe,Bt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .heat-map[_ngcontent-%COMP%]{flex:1;overflow:hidden;padding-left:30px;--column-headers-backgroundColor: var(--scorecard-tableBackgroundColor);--row-backgroundColor: var(--scorecard-tableRowBackgroundColor)}[_nghost-%COMP%]   .heat-map.show-value-only[_ngcontent-%COMP%]{--cell-width: 88px}[_nghost-%COMP%]   .heat-map.show-value-target[_ngcontent-%COMP%]{--cell-width: 152px}[_nghost-%COMP%]   .heat-map.show-change-only[_ngcontent-%COMP%]{--cell-width: 132px}[_nghost-%COMP%]   .heat-map.show-change-target[_ngcontent-%COMP%]{--cell-width: 208px}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap;overflow:hidden;height:100%;display:flex;align-items:center;flex:1}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]   .name-info[_ngcontent-%COMP%]{margin:0 6px}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:flex-start;justify-content:flex-start;padding:0;background:none;border:none}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:6px;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding:6px}[_nghost-%COMP%]   .configuration-pane[_ngcontent-%COMP%]{border-left:1px solid var(--gray-50, #D2D0CE)}[_nghost-%COMP%]   .configuration-pane[_ngcontent-%COMP%]     pbi-side-pane{width:450px}[_nghost-%COMP%]     .column-center-name{justify-content:center}[_nghost-%COMP%]     .heat-map .column-headers{padding-left:6px}[_nghost-%COMP%]     .heat-map .column-headers .header{width:var(--cell-width)}[_nghost-%COMP%]     .row{border-left:6px solid transparent;border-radius:4px 8px 8px 4px;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 2px 4px var(--colorNeutralShadowKey)}[_nghost-%COMP%]     .row.goal-not-match{opacity:50%}[_nghost-%COMP%]     .cell{width:var(--cell-width)}[_nghost-%COMP%]   hierarchy-goal-cell[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .name[_ngcontent-%COMP%]:hover{cursor:pointer;opacity:.7}.goal-info-tooltip[_ngcontent-%COMP%]   .tooltip-value-label[_ngcontent-%COMP%], .tooltip-hierarchy-name[_ngcontent-%COMP%]{font-weight:600}  .mat-menu-panel.heatmap-column-menu{min-height:fit-content;margin-top:4px}  .mat-menu-panel.heatmap-column-menu .mat-menu-content{padding:0}  .mat-menu-panel.heatmap-column-menu .mat-menu-item{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}  .mat-menu-panel.heatmap-column-menu .mat-menu-item:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}  .mat-menu-panel.heatmap-column-menu .mat-menu-item pbi-icon{display:flex;padding-right:8px}"],changeDetection:0}),n}(De.w),Ad=["chart"];function Rd(o,n){1&o&&e.\u0275\u0275elementContainer(0)}function Ld(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Rd,1,0,"ng-container",8),e.\u0275\u0275elementContainerEnd()),2&o){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(11);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function Gd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",20)(1,"span",21),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,2,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString))}}function Nd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",22)(1,"span",23),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",24),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,3,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.valueChange.period)}}function Hd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275element(1,"mat-icon",16),e.\u0275\u0275elementStart(2,"div",17),e.\u0275\u0275template(3,Gd,4,6,"span",18),e.\u0275\u0275template(4,Nd,6,7,"ng-template",null,19,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("rotate180",!i.valueChange.isIncrease),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.periodLocalizeString&&!i.periodLocalizeString.endsWith("Custom"))("ngIfElse",t)}}function zd(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Hd,6,4,"div",11),e.\u0275\u0275elementStart(2,"div",12,13),e.\u0275\u0275element(4,"goal-history-chart",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.valueChange),e.\u0275\u0275advance(3),e.\u0275\u0275property("values",t.sparklineValues)("formatString",t.goal.valuesFormatString)("color",t.statusColor)("showGoalTargets",!1)("axesOptions",t.axesOptions)("legend","None")}}function Bd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275template(1,zd,5,7,"ng-container",10),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(11);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.hasData)("ngIfElse",i)}}function Ud(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(2,1,t.currentValue.value,t.categories,t.goal.valuesFormatString))}}function qd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",26)(1,"div",27)(2,"div",28),e.\u0275\u0275pipe(3,"formatValue"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"formatValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",29),e.\u0275\u0275pipe(7,"formatValue"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"formatValue"),e.\u0275\u0275elementEnd()()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(3,4,t.currentValue.value,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(5,8,t.currentValue.value,t.goal.valuesFormatString)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(7,11,t.currentValue.target,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" /",e.\u0275\u0275pipeBind2(9,15,t.currentValue.target,t.goal.valuesFormatString)," ")}}var Ol=function(){function o(n,t){this.featureSwitches=n,this.localizationService=t,this.axesOptions=Lo,this.currentValue=null,this.supportCategoricalValues=this.featureSwitches.featureSwitches.goalsCategoricalValues}return o.prototype.ngOnInit=function(){var t,i,n=this;u.fF.assertValue(this.goal,"Missing goal"),this.setDisplayedVals(),this.locale=this.localizationService.currentLanguageLocale,this.supportCategoricalValues&&this.goal.valuesCategoryId&&(this.categories=null!==(i=null===(t=_.find(this.goal.goalValueCategories,function(a){return a.id===n.goal.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==i?i:[])},o.prototype.ngOnChanges=function(n){var t,i;n.goal&&(this.setDisplayedVals(),this.supportCategoricalValues&&n.goal.currentValue.valuesCategoryId&&(this.categories=null!==(i=null===(t=_.find(this.goal.goalValueCategories,function(a){return a.id===n.goal.currentValue.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==i?i:[]))},o.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=W.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},o.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},o.prototype.setDisplayedVals=function(){var n;this.currentValue=Ke.r.buildCurrentGoalValue(this.goal),this.valueChange=Ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.periodLocalizeString=_.isNil(null===(n=this.valueChange)||void 0===n?void 0:n.period)?void 0:this.getPeriodSuffix(this.valueChange.period);var i=Q.p.getGoalStatus(this.currentValue.status,this.goalStatuses);this.statusColor=Q.p.getGoalSparklineColor(i.color),this.sparklineValues=Ir.buildSparklineValues(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasData=_.some(this.sparklineValues)},o.prototype.getPeriodSuffix=function(n){switch(n){case"Period_DoD":case"Period_MoM":case"Period_QoQ":case"Period_WoW":case"Period_YoY":return n;default:return"PercentGrowth_Period_Custom"}},o.componentId="RelevantGoalChartComponentId",o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["relevant-goal-chart"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Ad,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.chart=a.first))},inputs:{goal:"goal",goalStatuses:"goalStatuses"},features:[e.\u0275\u0275NgOnChangesFeature],decls:12,vars:7,consts:[[1,"relevant-goal"],[1,"title-and-value"],[4,"ngIf"],[1,"title",3,"pbiTooltip"],[3,"pbiTooltip"],["class","growth-and-visual",4,"ngIf","ngIfElse"],["useCategories",""],["valueAndTarget",""],[4,"ngTemplateOutlet"],[1,"growth-and-visual"],[4,"ngIf","ngIfElse"],["class","growth",4,"ngIf"],[1,"visual"],["chart",""],["type","AreaChart",3,"values","formatString","color","showGoalTargets","axesOptions","legend"],[1,"growth"],["fontIcon","pbi-glyph-arrow",1,"glyphicon","glyph-micro"],[1,"change"],["class","period","localize-fragments","",3,"localize",4,"ngIf","ngIfElse"],["customPeriod",""],["localize-fragments","",1,"period",3,"localize"],["fragment-index","0",1,"valueChangePeriod"],["localize-fragments","",3,"localize"],["fragment-index","0"],["fragment-index","1"],[1,"current-value"],[1,"value-wrapper"],[1,"value-target"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Ld,2,1,"ng-container",2),e.\u0275\u0275elementStart(3,"span",3),e.\u0275\u0275text(4),e.\u0275\u0275elementStart(5,"span",4),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,Bd,2,2,"div",5),e.\u0275\u0275template(8,Ud,3,5,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,qd,10,18,"ng-template",null,7,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(9);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.hasData&&!(i.supportCategoricalValues&&i.goal.valuesCategoryId)),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",i.goal.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",i.goal.scorecardName," > "),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",i.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.goal.name,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(i.supportCategoricalValues&&i.goal.valuesCategoryId))("ngIfElse",a)}},dependencies:[F.NgIf,F.NgTemplateOutlet,Sn.X,vn.Hw,oe.V,no,$r.D,xr.c],styles:['.relevant-goal[_ngcontent-%COMP%]{flex:1;width:284px;background-color:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-goal[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg);-webkit-transform:rotate(180deg)}.relevant-goal[_ngcontent-%COMP%]:hover, .relevant-goal[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:66px;padding:0 16px}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:18px}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:14px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:168px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:1px;padding:7px 16px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:8px!important;width:8px!important}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .change[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin-left:4px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .change[_ngcontent-%COMP%]   .valueChangePeriod[_ngcontent-%COMP%]{margin-right:4px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]{flex:1;display:flex;padding:7px 10px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]   goal-history-chart[_ngcontent-%COMP%]{width:100%;flex:1}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{margin:auto}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:34px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:22px}.relevant-goal[_ngcontent-%COMP%]   .current-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:168px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--pbi-font-32, 32px);font-weight:var(--font-weight-semi-bold, 600)}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{display:flex;align-items:baseline}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-primary-color, #323130);font-weight:var(--font-weight-semi-bold, 600)}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-primary-alt-color, #3B3A39)}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;height:44px;padding:0 16px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);font-size:14px;line-height:18px;color:var(--fluent-theme-neutral-secondary-color, #605E5C);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:4px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]{width:95px;margin-right:7px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]     .status{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}'],changeDetection:0}),o}();function Wd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"goal-kpi",5),e.\u0275\u0275listener("onSelected",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onPointSelected(l))}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("values",i.goal.goalValues)("formatString",i.goal.valuesFormatString)}}function jd(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",6),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",7),e.\u0275\u0275element(4,"label",8),e.\u0275\u0275elementStart(5,"span"),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.goal.name),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" : ",t.completionDate,"")}}var El=function(){function o(n){this.localizationService=n}return o.prototype.ngOnInit=function(){if(this.goal.completionDate){var n=this.localizationService.currentLanguageLocale;this.completionDate=new Date(this.goal.completionDate).toLocaleDateString(n,{day:"numeric",month:"short",year:"numeric"})}},o.componentId="RelevantGoalKpiComponentId",o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["relevant-goal-kpi"]],inputs:{goal:"goal"},decls:5,vars:2,consts:[[1,"relevant-goal","pbi-depth-1","pbi-depth-interactive"],[1,"relevant-goal-kpi"],[3,"values","formatString","onSelected",4,"ngIf"],[1,"relevant-goal-details"],[4,"ngIf"],[3,"values","formatString","onSelected"],[1,"title"],[1,"target-date"],["localize","KpiTargetDateFieldListDisplayName"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Wd,1,2,"goal-kpi",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",3),e.\u0275\u0275template(4,jd,7,2,"ng-container",4),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.goal),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.goal))},dependencies:[F.NgIf,Sn.X,zl],styles:['.relevant-goal[_ngcontent-%COMP%]{flex:1;height:262px;width:285px;background:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-goal[_ngcontent-%COMP%]:hover, .relevant-goal[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]{border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);padding:16px}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);line-height:16px;color:var(--fluent-theme-neutral-secondary-color, #605E5C);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-kpi[_ngcontent-%COMP%]{height:194px}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-kpi[_ngcontent-%COMP%]   visual-modern[_ngcontent-%COMP%]{border:none!important;padding:0!important}'],changeDetection:0}),o}(),vi=function(o){return o[o.None=0]="None",o[o.View=1]="View",o[o.TenantView=2]="TenantView",o[o.Favorite=3]="Favorite",o[o.Frequent=4]="Frequent",o[o.Promoted=5]="Promoted",o[o.Learning=6]="Learning",o[o.Discover=7]="Discover",o[o.Teams=8]="Teams",o[o.TeamAnalytics=9]="TeamAnalytics",o[o.PromotedSample=10]="PromotedSample",o}({});function Qd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",7),e.\u0275\u0275element(1,"tri-svg-icon",8),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",t.recommendationReason),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.recommendationReason,"")}}var Tl=function(){function o(n){this.localizationService=n}return o.prototype.ngOnChanges=function(n){var t;(this.relevantMeasure||n.relevantMeasure)&&(this.recommendationReason=function(o,n){var t="";switch(o){case vi.View:t=n.format("Recommended_Reason_View");break;case vi.Favorite:t=n.get("Recommended_Reason_Favorite");break;case vi.Frequent:t=n.get("Recommended_Reason_Frequent");break;case vi.Promoted:t=n.format("Recommended_Reason_Featured");break;case vi.Learning:t=n.get("TopNav_HelpMenu_GettingStarted");break;case vi.Discover:t=n.get("Recommended_Reason_Discover");break;case vi.TeamAnalytics:t=n.get("Teams_Analyze_Usage");break;default:t=n.get("Recommended_Reason_None")}return t}(null===(t=this.relevantMeasure)||void 0===t?void 0:t.recommendationReason,this.localizationService))},o.componentId="RelevantMeasureComponentId",o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["relevant-measure"]],inputs:{relevantMeasure:"relevantMeasure"},features:[e.\u0275\u0275NgOnChangesFeature],decls:11,vars:4,consts:[[1,"relevant-measure"],[1,"measure"],[1,"title-and-value"],["class","title",3,"pbiTooltip",4,"ngIf"],[3,"pbiTooltip"],[1,"measure-report"],["fontIcon","pbi-glyph-barchart",1,"glyph-small"],[1,"title",3,"pbiTooltip"],["name","folder_open_20_regular","tri-svg-icon-16",""]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275template(3,Qd,3,2,"span",3),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",5)(7,"div"),e.\u0275\u0275element(8,"mat-icon",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div"),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd()()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!(null==i.relevantMeasure||!i.relevantMeasure.recommendationReason)),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",null==i.relevantMeasure?null:i.relevantMeasure.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(null==i.relevantMeasure?null:i.relevantMeasure.name),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==i.relevantMeasure?null:i.relevantMeasure.value))},dependencies:[F.NgIf,vn.Hw,oe.V,Er.M],styles:['.relevant-measure[_ngcontent-%COMP%]{flex:1;width:284px;background-color:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-measure[_ngcontent-%COMP%]:hover, .relevant-measure[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-measure[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:66px;padding:0 16px}.relevant-measure[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]{height:100%}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   .measure-report[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:168px}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   .measure-report[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:48px!important;width:48px!important}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}'],changeDetection:0}),o}(),Kd=m(73088),Xd=m(74199);function Zd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"label"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,t.labels[0]))}}function Yd(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"label"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localizeFormat"),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2).ngIf,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(2,1,i.labels[1],t))}}function Jd(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(a.onDissmis())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"pbi-icon",10),e.\u0275\u0275elementEnd()}2&o&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"Dismiss"))}function ep(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275element(1,"i",3),e.\u0275\u0275elementStart(2,"div",4),e.\u0275\u0275template(3,Zd,3,3,"label",5),e.\u0275\u0275template(4,Yd,3,4,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.openSharingDialog())}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,Jd,3,3,"button",8),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",1===a)("ngIfElse",i),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(7,5,l.labels[2])),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,7,l.labels[2])),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",l.showDismiss)}}function tp(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,ep,11,9,"div",1),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t>0)}}function np(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,tp,2,1,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&o){var i,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(i=e.\u0275\u0275pipeBind1(2,1,t.noAccessUsers$))?null:i.length)}}var Xl=function(){function o(n,t){var i;this.goalsHttpService=n,this.scorecardActions=t,this.labels=["Member_No_Scorecard_Access","Members_No_Scorecard_Access","Manage_Scorecard_Access"],this.showDismiss=!0,this.userAccess={userPrincipalNames:{},aadAppIds:{},groupIds:{}},this.noAccessUsers$=new ye.X([]),this.show=!0,u.fF.assertValue(3===(null===(i=this.labels)||void 0===i?void 0:i.length),"Should only contain 3 labels")}return o.prototype.ngOnChanges=function(n){var t,i;(n.scorecard&&this.scorecard.reportId&&_.isNil(null===(t=n.scorecard.previousValue)||void 0===t?void 0:t.reportId)&&this.users||n.users&&null!==(i=this.scorecard)&&void 0!==i&&i.reportId)&&this.updateUserAccessInfo()},o.prototype.onDissmis=function(){this.show=!1},o.prototype.openSharingDialog=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(n){switch(n.label){case 0:return[4,this.scorecardActions.share(this.scorecard,this.noAccessUsers$.value)];case 1:return n.sent(),[2]}})})},o.prototype.updateUserAccessInfo=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t;return(0,M.__generator)(this,function(a){switch(a.label){case 0:if(!_.some(this.users))return[3,5];if(n=this.getCheckScorecardAccessRequest(this.users),!(_.some(n.userPrincipalNames)||_.some(n.aadAppIds)||_.some(n.groupIds)))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.checkAccess(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return t=a.sent(),this.updateAcessInfo(t),[3,4];case 3:return a.sent(),this.noAccessUsers$.next([]),[3,4];case 4:return this.noAccessUsers$.next(this.countUsersWithNoAccess(this.users)),[3,6];case 5:this.noAccessUsers$.next([]),a.label=6;case 6:return[2]}})})},o.prototype.getCheckScorecardAccessRequest=function(n){for(var t={userPrincipalNames:[],aadAppIds:[],groupIds:[]},i=0,a=n;i<a.length;i++){var l=a[i];2===l.objectType?void 0===this.userAccess.groupIds[l.objectId]&&t.groupIds.push(l.objectId):l.userPrincipalName?void 0===this.userAccess.userPrincipalNames[l.userPrincipalName]&&t.userPrincipalNames.push(l.userPrincipalName):void 0===this.userAccess.aadAppIds[l.aadAppId]&&t.aadAppIds.push(l.aadAppId)}return t},o.prototype.countUsersWithNoAccess=function(n){for(var t=[],i=0,a=n;i<a.length;i++){var l=a[i];2===l.objectType?!0!==this.userAccess.groupIds[l.objectId]&&t.push(l):l.userPrincipalName?!0!==this.userAccess.userPrincipalNames[l.userPrincipalName]&&t.push(l):!0!==this.userAccess.aadAppIds[l.aadAppId]&&t.push(l)}return t},o.prototype.updateAcessInfo=function(n){for(var t=0,i=_.keys(n?.userPrincipalNames);t<i.length;t++)this.userAccess.userPrincipalNames[a=i[t]]=n.userPrincipalNames[a];for(var l=0,c=_.keys(n?.aadAppIds);l<c.length;l++)this.userAccess.aadAppIds[a=c[l]]=n.aadAppIds[a];for(var p=0,y=_.keys(n?.groupIds);p<y.length;p++){var a;this.userAccess.groupIds[a=y[p]]=n.groupIds[a]}},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Lt),e.\u0275\u0275directiveInject(Kd.F))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-access-banner"]],inputs:{scorecard:"scorecard",users:"users",labels:"labels",showDismiss:"showDismiss"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[4,"ngIf"],["class","message-banner",4,"ngIf"],[1,"message-banner"],["aria-hidden","true",1,"glyphicon","pbi-glyph-info","glyph-small","message-banner-icon"],[1,"message-banner-text-container"],[4,"ngIf","ngIfElse"],["multiple",""],[3,"click"],["class","close",3,"click",4,"ngIf"],[1,"close",3,"click"],["name","close","size","mini"]],template:function(t,i){1&t&&e.\u0275\u0275template(0,np,3,3,"ng-container",0),2&t&&e.\u0275\u0275property("ngIf",i.show&&(null==i.scorecard?null:i.scorecard.reportId))},dependencies:[F.NgIf,Dn._,F.AsyncPipe,Bt.F,Xd.j],styles:['[_nghost-%COMP%]{display:block;font-size:12px}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;padding:10px 12px;background-color:var(--gray-20, #F3F2F1);margin-bottom:10px}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{margin:0 0 0 auto;border:0;padding:0;background-color:transparent;color:inherit;display:flex;align-items:center}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]{display:block;line-height:16px;-webkit-user-select:text;-ms-user-select:text;user-select:text}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background-color:transparent;margin:0;padding:0;align-self:flex-end;text-decoration:underline;color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{color:var(--fluent-theme-link-alt-color, #004578)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:1px solid var(--gray-140, #484644)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D)}html:not([dir="rtl"])   [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-icon[_ngcontent-%COMP%]{margin-right:8px}html[dir="rtl"]   [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-icon[_ngcontent-%COMP%]{margin-left:8px}'],changeDetection:0}),o}();function rp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"input",7),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.bucketId=l)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"input",8),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.bucketName=l)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.addBucket())}),e.\u0275\u0275element(4,"mat-icon",10)(5,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.deleteBucket())}),e.\u0275\u0275element(7,"mat-icon",12)(8,"span",13),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",i.bucketId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",i.bucketName)}}function ip(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275listener("cdkDragEntered",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.dragEnteredGroup(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"label",15),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()}if(2&o){var i=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("cdkDragDisabled",!e.\u0275\u0275pipeBind1(1,2,a.isEditMode$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.name)}}function op(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"goal-tile",17),e.\u0275\u0275listener("cdkDropListDropped",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.drop(c))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()()}if(2&o){var i=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",i)("goalStatuses",a.metricsGoalStatuses)("settings",a.boardSettings)("cdkDragDisabled",!e.\u0275\u0275pipeBind1(2,4,a.isEditMode$))}}var Zl=function(){function o(n){var t=this;this.scorecardService=n,this.bucketArr=[],this.bucketName="",this.bucketId="",this.boardGoals=[],this.boardGroups=[],this.isEditMode$=this.scorecardService.isEditMode(),this.scorecardBoard$=this.scorecardService.getBoard(),this.scorecardBoard$.pipe().subscribe(function(i){t.boardGroups=i?.groups}),this.boardGoals=this.scorecardService.flatten()}return o.prototype.addBucket=function(){""!==this.bucketName&&this.scorecardService.addGroupToBoard(this.bucketId,this.bucketName)},o.prototype.deleteBucket=function(){this.scorecardService.deleteGroupFromBoard(this.bucketId)},o.prototype.drop=function(n){n.previousContainer===n.container?(0,ee.bA)(n.container.data,n.previousIndex,n.currentIndex):(0,ee.EA)(n.previousContainer.data,n.container.data,n.previousIndex,n.currentIndex)},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-board-view"]],inputs:{boardSettings:"boardSettings",metricsGoalStatuses:"metricsGoalStatuses"},decls:8,vars:6,consts:[[4,"ngIf"],["cdkDropListGroup","",1,"group-container"],["cdkDropList","",1,"group-list",3,"cdkDropListData","cdkDropListDropped"],["cdkDropList","","class","group-box","cdkDrag","",3,"cdkDragDisabled","cdkDragEntered",4,"ngFor","ngForOf"],["cdkDropListGroup",""],[1,"metric-container"],["cdkDropList","",4,"ngFor","ngForOf"],["type","text","placeholder","id",3,"ngModel","ngModelChange"],["type","text","placeholder","name",3,"ngModel","ngModelChange"],[3,"click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-mini"],["localize","Add_Group_To_Board_Visual"],["fontIcon","pbi-glyph-delete",1,"glyphicon","glyph-mini"],["localize","Delete_Group_From_Board_Visual"],["cdkDropList","","cdkDrag","",1,"group-box",3,"cdkDragDisabled","cdkDragEntered"],[1,"group-name"],["cdkDropList",""],["cdkDrag","",1,"metric-tile",3,"goal","goalStatuses","settings","cdkDragDisabled","cdkDropListDropped"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,rp,9,2,"div",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"div",1)(3,"div",2),e.\u0275\u0275listener("cdkDropListDropped",function(l){return i.drop(l)}),e.\u0275\u0275template(4,ip,4,4,"div",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",4)(6,"div",5),e.\u0275\u0275template(7,op,3,6,"div",6),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,4,i.isEditMode$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("cdkDropListData",i.boardGroups),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.boardGroups),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",i.boardGoals))},dependencies:[F.NgForOf,F.NgIf,ee.Wj,ee.Fd,ee.Zt,it.Fj,it.JJ,it.On,Sn.X,vn.Hw,dl,F.AsyncPipe],styles:[".metric-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;gap:20px;margin:30px}.metric-container[_ngcontent-%COMP%]   .metric-tile[_ngcontent-%COMP%]{width:250px;height:180px;display:flex}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.group-container[_ngcontent-%COMP%]{max-width:100%;margin:0 25px 25px 0;vertical-align:top}.group-container[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{overflow:hidden;display:block}.group-container[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   .group-box[_ngcontent-%COMP%]{padding:20px;margin:20px;background-color:#d3d3d3;border-radius:20px;min-height:250px;display:flex;flex-wrap:wrap;flex-direction:row;gap:20px}.delete-group-button[_ngcontent-%COMP%]{font-size:medium;margin-left:auto;padding:0;border:none;background:none}.group-name[_ngcontent-%COMP%]{font-weight:700}"]}),o}(),ap=function(n){return{action:n}};function sp(o,n){if(1&o&&e.\u0275\u0275elementContainer(0,5),2&o){var t=n.$implicit;e.\u0275\u0275nextContext(3);var i=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngTemplateOutlet",i)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,ap,t))}}function lp(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,sp,1,4,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function cp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onAddNote())}),e.\u0275\u0275element(1,"pbi-icon",7)(2,"div",8),e.\u0275\u0275elementEnd()}}function up(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onEditCheckIn())}),e.\u0275\u0275element(1,"pbi-icon",9)(2,"div",10),e.\u0275\u0275elementEnd()}}function dp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onDeleteCheckIn())}),e.\u0275\u0275element(1,"pbi-icon",11)(2,"div",12),e.\u0275\u0275elementEnd()}}function pp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onEditNote())}),e.\u0275\u0275element(1,"pbi-icon",9)(2,"div",13),e.\u0275\u0275elementEnd()}}function hp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onDeleteNote())}),e.\u0275\u0275element(1,"pbi-icon",11)(2,"div",14),e.\u0275\u0275elementEnd()}}function gp(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,lp,2,1,"ng-container",1),e.\u0275\u0275template(2,cp,3,0,"button",3),e.\u0275\u0275template(3,up,3,0,"button",3),e.\u0275\u0275template(4,dp,3,0,"button",3),e.\u0275\u0275template(5,pp,3,0,"button",3),e.\u0275\u0275template(6,hp,3,0,"button",3),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.goalActions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onAddNote),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onEditCheckIn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onDeleteCheckIn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onEditNote),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onDeleteNote)}}function fp(o,n){if(1&o&&e.\u0275\u0275element(0,"mat-icon",22),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("fontIcon",t.iconName)}}function mp(o,n){if(1&o&&e.\u0275\u0275element(0,"pbi-icon",23),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function vp(o,n){if(1&o&&e.\u0275\u0275element(0,"tri-svg-icon",24),2&o){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function _p(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",16)(1,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext().action;return e.\u0275\u0275resetView(l.onClick())}),e.\u0275\u0275template(2,fp,1,1,"mat-icon",18),e.\u0275\u0275template(3,mp,1,1,"pbi-icon",19),e.\u0275\u0275template(4,vp,1,1,"tri-svg-icon",20),e.\u0275\u0275element(5,"div",21),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext().action;e.\u0275\u0275property("tooltipKey",null==i?null:i.disabledTooltipKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",i.disabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","mat"===i.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pbi"===i.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","tri"===i.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",i.labelKey)}}function Cp(o,n){1&o&&e.\u0275\u0275template(0,_p,6,6,"tooltip-wrapper",15),2&o&&e.\u0275\u0275property("ngIf",n.action)}var Yl=function(){function o(){}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-context-menu"]],inputs:{args:"args"},decls:4,vars:1,consts:[[1,"context-menu"],[4,"ngIf"],["actionOption",""],["class","option",3,"click",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"option",3,"click"],["name","add","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Add_Note",1,"text"],["name","edit","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Edit_Check_In",1,"text"],["name","delete","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Delete_Check_In",1,"text"],["localize","MetricsDetailsPane_DetailsTab_Edit_Note",1,"text"],["localize","MetricsDetailsPane_DetailsTab_Delete_Note",1,"text"],[3,"tooltipKey",4,"ngIf"],[3,"tooltipKey"],["mat-icon-button","",1,"option",3,"disabled","click"],["class","glyphicon glyph-small icon",3,"fontIcon",4,"ngIf"],["size","small","class","icon",3,"name",4,"ngIf"],["tri-svg-icon-16","","class","tri-svg icon",3,"name",4,"ngIf"],[1,"text",3,"localize"],[1,"glyphicon","glyph-small","icon",3,"fontIcon"],["size","small",1,"icon",3,"name"],["tri-svg-icon-16","",1,"tri-svg","icon",3,"name"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,gp,7,6,"ng-container",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,Cp,1,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.args))},dependencies:[F.NgForOf,F.NgIf,F.NgTemplateOutlet,Sn.X,vn.Hw,Dn._,Er.M,Tr],styles:['[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{width:fit-content;padding:2px 0;background-color:#fff;border-radius:2px;box-sizing:border-box;box-shadow:0 3.2px 7.2px rgba(0,0,0,.13),0 .6px 1.8px rgba(0,0,0,.11)}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]{height:36px;display:flex;align-items:center;cursor:pointer;background-color:transparent;border:none;min-width:-webkit-fill-available}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:disabled{cursor:default}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:disabled   .text[_ngcontent-%COMP%]{color:var(--gray-80)}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:hover{background:var(--gray-20, #F3F2F1)}[_nghost-%COMP%]   .icon[_ngcontent-%COMP%]{height:16px;width:16px;font-size:16px;display:inline-block;padding-left:8px;padding-right:8px}[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--gray-180, #252423);text-align:left;display:inline-block}'],changeDetection:0}),o}(),gl=function(){function o(){this.filterBy=new e.EventEmitter}return o.prototype.onFilterBy=function(n){this.filterBy.emit(n)},o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-filter"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},decls:5,vars:7,consts:[[1,"toolbar-filter-glyph"],["fontIcon","pbi-glyph-search",1,"glyphicon","glyph-mini"],[3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"mat-icon",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"input",2),e.\u0275\u0275listener("ngModelChange",function(l){return i.onFilterBy(l)}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",i.filterText),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,3,"Filter_By_Keyword"))("placeholder",e.\u0275\u0275pipeBind1(4,5,"Filter_By_Keyword")))},dependencies:[it.Fj,it.JJ,it.On,vn.Hw,Bt.F],styles:["[_nghost-%COMP%]{display:inline-block;margin-right:8px;align-items:center;vertical-align:top;height:32px;width:230px}[_nghost-%COMP%]   .toolbar-filter-glyph[_ngcontent-%COMP%]{display:inline-block;margin:0;padding:0;border:none;outline:none;height:32px;width:32px;color:var(--gray-180, #252423);background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   .toolbar-filter-glyph[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-top:10px;margin-left:10px;height:12px;width:12px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;margin:0;padding:0;height:32px;width:198px;color:var(--gray-180, #252423);font-weight:400;font-size:14px;line-height:20px;border:0px;border-top-right-radius:4px;border-bottom-right-radius:4px;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border:0px;outline:none}"],changeDetection:0}),o}(),yp=function(n){return{active:n}};function bp(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275element(2,"mat-icon",6)(3,"span",7),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(1),i=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(2);e.\u0275\u0275property("matMenuTriggerFor",a)("ngClass",e.\u0275\u0275pureFunction1(4,yp,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275property("fontIcon",i.selectedOption.icon),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",i.selectedOption.label)}}function wp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",8),e.\u0275\u0275listener("click",function(){var p=e.\u0275\u0275restoreView(t).$implicit,y=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(y.onSwitchView(p.value))}),e.\u0275\u0275element(1,"mat-icon",6)(2,"span",9),e.\u0275\u0275elementEnd()}if(2&o){var i=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",a.viewType===i.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("fontIcon",i.icon),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",i.label)("localizeTooltip",i.label)}}var xl=function(o){function n(t,i,a,l){var c=o.call(this)||this;c.scorecardService=t,c.hierarchyService=i,c.featureSwitches=a,c.changeDetector=l;var p=c.featureSwitches.featureSwitches.scorecardCompactView,y=c.featureSwitches.featureSwitches.metricsBoardView,O=c.hierarchyService.hasHierarchies$.pipe((0,dt.U)(function(A){return c.featureSwitches.featureSwitches.goalsHierarchies&&c.featureSwitches.featureSwitches.goalsHierarchiesHeatmap&&A}),(0,We.R)(c.onDestroy$));return(0,zn.aj)([c.scorecardService.viewType$,O]).pipe((0,We.R)(c.onDestroy$)).subscribe(function(A){c.updateViewOptions(A[0],p,A[1],y)}),c}return(0,M.__extends)(n,o),n.prototype.onSwitchView=function(t){this.scorecardService.setViewType(t)},n.prototype.updateViewOptions=function(t,i,a,l){var c=[{value:"List",label:"ListView",icon:"pbi-glyph-allapps"}];i&&c.push({value:"Compact",label:"Scorecard_CompactView_Preview",icon:"pbi-glyph-allapps"}),l&&c.push({value:"Board",label:"Display_Mode_Board_View",icon:"pbi-glyph-table"}),a&&c.push({value:"Heatmap",label:"MetricsHeatmap_Preview",icon:"pbi-glyph-table"}),this.options=c,this.showViewSwitcher=c.length>1,this.viewType=t,this.selectedOption=c.find(function(p){return p.value===t}),this.changeDetector.markForCheck()},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["view-switcher"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:3,consts:[["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true","class","view-mode-picker pbi-fluent-button",3,"matMenuTriggerFor","ngClass",4,"ngIf"],[1,"view-mode-picker-menu",3,"overlapTrigger"],["viewSwitcherMenu","matMenu"],["mat-menu-item","","class","pbi-fluent-button",3,"disabled","click",4,"ngFor","ngForOf"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true",1,"view-mode-picker","pbi-fluent-button",3,"matMenuTriggerFor","ngClass"],["viewSwitcherMenuTrigger","matMenuTrigger"],[1,"glyphicon","glyph-small",3,"fontIcon"],[3,"localize"],["mat-menu-item","",1,"pbi-fluent-button",3,"disabled","click"],[3,"localize","localizeTooltip"]],template:function(i,a){1&i&&(e.\u0275\u0275template(0,bp,4,6,"button",0),e.\u0275\u0275elementStart(1,"mat-menu",1,2),e.\u0275\u0275template(3,wp,3,4,"button",3),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275property("ngIf",a.showViewSwitcher&&a.selectedOption),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",a.options))},dependencies:[F.NgClass,F.NgForOf,F.NgIf,Sn.X,Kr.r,vn.Hw,Jt.W0,Jt.tN,Jt.D8],styles:[".view-mode-picker[_ngcontent-%COMP%]{border:none;display:inline-flex;align-items:center;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}.view-mode-picker[_ngcontent-%COMP%]:hover{background-color:var(--gray-20, #F3F2F1)}.view-mode-picker[_ngcontent-%COMP%]:active{background-color:var(--gray-30, #EDEBE9)}.view-mode-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-weight:400;margin-right:8px;color:var(--fluent-theme-black-color, #000)}  .mat-menu-panel.view-mode-picker-menu .mat-menu-content{padding:0}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}.mat-menu-item[_ngcontent-%COMP%]:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}"],changeDetection:0}),n}(De.w);function Sp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",6)(1,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onLinkedMetricInit.emit())}),e.\u0275\u0275element(2,"span",11),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("tooltipKey",null==i.capabilities||null==i.capabilities.createLinkedGoal?null:i.capabilities.createLinkedGoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=i.capabilities&&null!=i.capabilities.createLinkedGoal&&i.capabilities.createLinkedGoal.enabled))}}function Mp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",6)(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.hierarchyPane.openHierarchiesBuilder("ScorecardNewButton"))}),e.\u0275\u0275element(2,"span",13),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("tooltipKey",null==i.capabilities||null==i.capabilities.editHierarchies?null:i.capabilities.editHierarchies.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=i.capabilities&&null!=i.capabilities.editHierarchies&&i.capabilities.editHierarchies.enabled)),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",i.hasHierarchies?"MetricsManageHierarchies_Preview":"MetricsHierarchy_SetupHierarchy_Preview")}}var Il=function(){function o(n,t){var i=this;this.hierarchyPane=n,this.scorecardService=t,this.onNewGoal=new e.EventEmitter,this.onNewSubGoal=new e.EventEmitter,this.onLinkedMetricInit=new e.EventEmitter,this.connectedGoalSubscrition=this.scorecardService.getScorecard().pipe((0,dt.U)(function(a){return W.anyGoals(a.goals,function(l){return!!l.valueConnection||!!l.targetConnection})}),(0,G.x)()).subscribe(function(a){i.anyConnectedGoals=a,i.updateCapabilities()})}return o.prototype.ngOnChanges=function(n){(n.scorecardCapabilities||n.hasHierarchies||n.numberOfSelectedGoals)&&this.updateCapabilities()},o.prototype.ngOnDestroy=function(){this.connectedGoalSubscrition.unsubscribe()},o.prototype.updateCapabilities=function(){this.scorecardCapabilities&&(this.capabilities=(0,M.__assign)({},this.scorecardCapabilities),this.capabilities.editHierarchies=Mr.clone(this.scorecardCapabilities.editHierarchies).disableIf(!this.anyConnectedGoals&&!this.hasHierarchies,"NoConnections","MetricsHierarchy_No_Connections_Tooltip").build(),this.capabilities.createSubgoal=Mr.clone(this.scorecardCapabilities.createGoal).disableIf(1!==this.numberOfSelectedGoals,"InvalidSelection").build())},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(pl),e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-new-button"]],inputs:{isEditMode:"isEditMode",scorecardCapabilities:"scorecardCapabilities",numberOfSelectedGoals:"numberOfSelectedGoals",hasHierarchies:"hasHierarchies"},outputs:{onNewGoal:"onNewGoal",onNewSubGoal:"onNewSubGoal",onLinkedMetricInit:"onLinkedMetricInit"},features:[e.\u0275\u0275NgOnChangesFeature],decls:15,vars:13,consts:[["mat-button-toggle","",1,"new-btn","pbi-fluent-button","pbi-focus-outline","primary",3,"matMenuTriggerFor","disabled"],[1,"glyphicon","pbi-glyph-add","glyph-small","icon"],["localize","New",1,"label"],[1,"glyphicon","pbi-glyph-chevrondownsmall","glyph-small","icon"],[1,"new-menu",3,"overlapTrigger"],["newBtnDropdownMenu","matMenu"],[3,"tooltipKey"],["mat-menu-item","",1,"pbi-fluent-button",3,"disabled","click"],["localize","NewMetric"],[3,"tooltipKey",4,"pbiFeatureSwitch"],["localize","AddSubmetric"],["localize","Metrics_LinkedMetrics_Button_Preview"],["mat-menu-item","",1,"pbi-fluent-button","manage-hierarchies-btn",3,"disabled","click"],[3,"localize"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"i",1)(3,"span",2)(4,"i",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-menu",4,5)(7,"tooltip-wrapper",6)(8,"button",7),e.\u0275\u0275listener("click",function(){return i.onNewGoal.emit()}),e.\u0275\u0275element(9,"span",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,Sp,3,2,"tooltip-wrapper",9),e.\u0275\u0275elementStart(11,"tooltip-wrapper",6)(12,"button",7),e.\u0275\u0275listener("click",function(){return i.onNewSubGoal.emit()}),e.\u0275\u0275element(13,"span",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,Mp,3,3,"tooltip-wrapper",9),e.\u0275\u0275elementEnd()),2&t){var a=e.\u0275\u0275reference(6);e.\u0275\u0275property("matMenuTriggerFor",a)("disabled",!i.isEditMode),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,11,"New"))("aria-expanded",!0===a.menuOpen),e.\u0275\u0275advance(5),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("tooltipKey",null==i.capabilities||null==i.capabilities.createGoal?null:i.capabilities.createGoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=i.capabilities&&null!=i.capabilities.createGoal&&i.capabilities.createGoal.enabled)),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiFeatureSwitch","goalsLinkedGoals"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tooltipKey",null==i.capabilities||null==i.capabilities.createSubgoal?null:i.capabilities.createSubgoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=i.capabilities&&null!=i.capabilities.createSubgoal&&i.capabilities.createSubgoal.enabled)),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies")}},dependencies:[Sn.X,Jt.W0,Jt.tN,Jt.D8,I.P,Tr,Bt.F],styles:[".new-btn[_ngcontent-%COMP%]{display:flex;align-items:center;padding:6px 10px}.new-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0 4px}.new-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding:0 4px}.manage-hierarchies-btn[_ngcontent-%COMP%]{border-top:1px solid var(--gray-40, #E1DFDD)}.manage-hierarchies-btn[_ngcontent-%COMP%]:active, .manage-hierarchies-btn[_ngcontent-%COMP%]:focus{border-top:1px solid var(--gray-40, #E1DFDD)}  .mat-menu-panel.new-menu .mat-menu-content{padding:0}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}.mat-menu-item[_ngcontent-%COMP%]:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}"],changeDetection:0}),o}();function Pp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.hierarchyPane.showHeatmapDisplaySettingsPane())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275element(2,"pbi-icon",13)(3,"span",14),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,i.hierarchyPane.showHeatmapDisplaySettingsPane$))}}var Jl=function(o){function n(t,i,a,l,c,p,y){var O=o.call(this)||this;return O.hierarchyPane=t,O.capabilityService=i,O.heatmapService=a,O.hierarchyService=l,O.localizationService=c,O.scorecardService=p,O.changeDetector=y,O.filterBy=new e.EventEmitter,O.isEditMode$=O.scorecardService.isEditMode(),O.scorecardCapabilities$=O.capabilityService.getScorecardCapabilities(),O.canEditHeatmap$=O.scorecardCapabilities$.pipe((0,dt.U)(function(A){return A.editHeatmap})),O.hasHierarchies$=O.hierarchyService.hasHierarchies$,O.heatmapService.selectedHierarchyItems$.subscribe(function(A){var L=A.length-1;O.dropdownLabel=L>0?O.localizationService.format("MetricsHeatmap_ComparingItems",L):O.localizationService.get("Add_Columns"),O.changeDetector.markForCheck()}),O}return(0,M.__extends)(n,o),n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(pl),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Pl),e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["scorecard-heatmap-toolbar"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:22,vars:22,consts:[[1,"scorecard-heatmap-toolbar"],[1,"left-actions"],["mat-button","","cdkMonitorElementFocus","",1,"heatmap-menu-button","pbi-fluent-button","pbi-icon-button","pbi-with-text",3,"matMenuTriggerFor"],["name","chevrondownsmall","size","mini",1,"chevrondown"],[1,"right-actions"],[3,"filterText","filterBy"],[3,"isEditMode","scorecardCapabilities","hasHierarchies"],["xPosition","after",1,"heatmap-menu",3,"overlapTrigger"],["heatmapMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["name","edit","size","small",1,"icon"],["localize","MetricsCustomizeHeatmap"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["name","settings","size","small",1,"icon"],["localize","DisplaySettings_Open"]],template:function(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"section",0)(1,"div",1)(2,"button",2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"pbi-icon",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",4)(8,"scorecard-filter",5),e.\u0275\u0275listener("filterBy",function(p){return a.filterBy.emit(p)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"view-switcher")(10,"scorecard-new-button",6),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"mat-menu",7,8)(16,"button",9),e.\u0275\u0275listener("click",function(){return a.hierarchyPane.showHeatmapConfigurationPane()}),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275element(18,"pbi-icon",10)(19,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,Pp,4,3,"button",12),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275elementEnd()),2&i){var l=e.\u0275\u0275reference(15);e.\u0275\u0275advance(2),e.\u0275\u0275property("matMenuTriggerFor",l),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,10,"Add_Columns")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a.dropdownLabel),e.\u0275\u0275advance(3),e.\u0275\u0275property("filterText",a.filterText),e.\u0275\u0275advance(2),e.\u0275\u0275property("isEditMode",e.\u0275\u0275pipeBind1(11,12,a.isEditMode$))("scorecardCapabilities",e.\u0275\u0275pipeBind1(12,14,a.scorecardCapabilities$))("hasHierarchies",e.\u0275\u0275pipeBind1(13,16,a.hasHierarchies$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(17,18,a.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(21,20,a.canEditHeatmap$))}},dependencies:[F.NgIf,Sn.X,Jt.W0,Jt.tN,Jt.D8,Dn._,xl,gl,Il,F.AsyncPipe,Bt.F],styles:[".scorecard-heatmap-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;box-sizing:border-box;padding:0 30px 12px;width:100%;font-family:var(--scorecard-fontFamily);color:var(--scorecard-headerForegroundColor);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid rgba(0,0,0,.05);vertical-align:top}.scorecard-heatmap-toolbar[_ngcontent-%COMP%]   .right-actions[_ngcontent-%COMP%]{display:inline-flex}.scorecard-heatmap-toolbar[_ngcontent-%COMP%]   .right-actions[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.pbi-fluent-button[_ngcontent-%COMP%]{border:none;display:inline-flex;align-items:center}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}.pbi-fluent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .pbi-fluent-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin:0 8px}.heatmap-menu-button[_ngcontent-%COMP%]{padding:0 8px}  .mat-menu-panel.heatmap-menu{min-height:fit-content;margin-top:4px}  .mat-menu-panel.heatmap-menu .mat-menu-content{padding:0}  .mat-menu-panel.heatmap-menu .mat-menu-item{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}  .mat-menu-panel.heatmap-menu .mat-menu-item:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}  .mat-menu-panel.heatmap-menu .mat-menu-item pbi-icon{display:flex;padding-right:8px}"],changeDetection:0}),n}(De.w);function Op(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"span",13),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&o){var t=n.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.hierarchyName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(": ",t.levels.join(" > "),"")}}function Ep(o,n){if(1&o&&e.\u0275\u0275template(0,Op,5,2,"div",12),2&o){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngForOf",t.displayPaths)}}function Tp(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",10),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Ep,1,1,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit,i=e.\u0275\u0275reference(5);e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",i)("pbiTooltipDisabled",t.showingAll),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.showingAll?e.\u0275\u0275pipeBind1(3,3,"MetricsHierarchy_SelectHierarchy"):t.displayLabel," ")}}function xp(o,n){1&o&&e.\u0275\u0275element(0,"span",14)}function Ip(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",15)}var Dp=function(n){return{active:n}};function kp(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275template(2,Tp,6,5,"ng-container",6),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,xp,1,0,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,Ip,1,0,"pbi-spinner",8),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275element(8,"pbi-icon",9),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(1),i=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext(),l=e.\u0275\u0275reference(3);e.\u0275\u0275property("matMenuTriggerFor",l)("ngClass",e.\u0275\u0275pureFunction1(9,Dp,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,5,a.hierarchyDisplayInfo$))("ngIfElse",i),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,7,a.isSwitchingPath$))}}function Vp(o,n){1&o&&e.\u0275\u0275element(0,"pbi-lazy-load",16)}var Dl=function(){function o(n,t){this.hierarchyService=n,this.scorecardService=t,this.showButton$=this.hierarchyService.hasHierarchies$,this.hierarchyDisplayInfo$=this.hierarchyService.getHierarchyDisplayInfoObservable(this.scorecardService.hierarchyPaths$),this.isSwitchingPath$=this.scorecardService.isSwitchingHierarchyPath()}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(gt))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-hierarchy-button"]],decls:5,vars:3,consts:[["cdkMonitorElementFocus","","mat-button","","aria-expanded","hierarchySlicerMenuTrigger.menuOpen === true","class","hierarchy-btn pbi-fluent-button pbi-icon-button pbi-with-text",3,"matMenuTriggerFor","ngClass",4,"ngIf"],["xPosition","after","yPosition","below",1,"hierarchy-slicer-menu"],["hierarchySlicerMenu","matMenu"],["matMenuContent",""],["cdkMonitorElementFocus","","mat-button","","aria-expanded","hierarchySlicerMenuTrigger.menuOpen === true",1,"hierarchy-btn","pbi-fluent-button","pbi-icon-button","pbi-with-text",3,"matMenuTriggerFor","ngClass"],["hierarchySlicerMenuTrigger","matMenuTrigger"],[4,"ngIf","ngIfElse"],["loadingHierarchies",""],["class","pbi-spinner-small",4,"ngIf"],["size","mini","name","chevrondownsmall","localizeTooltip","View_Options",1,"icon"],[3,"pbiTooltip","pbiTooltipDisabled"],["hierarchySlicerTooltip",""],[4,"ngFor","ngForOf"],[1,"hierarchy-name"],["localize","All"],[1,"pbi-spinner-small"],["modulePath","@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule","componentId","HierarchySlicerComponentId"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,kp,9,11,"button",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"mat-menu",1,2),e.\u0275\u0275template(4,Vp,1,0,"ng-template",3),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.showButton$))},dependencies:[F.NgClass,F.NgForOf,F.NgIf,Wl.R,Sn.X,Kr.r,Jt.W0,Jt.D8,Jt.hd,Dn._,cr.k,oe.V,F.AsyncPipe,Bt.F],styles:['.hierarchy-btn[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{height:20px}html:not([dir="rtl"])[_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin-right:8px}html:not([dir="rtl"])[_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:8px}.hierarchy-name[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}'],changeDetection:0}),o}(),Fp=m(24150);function Ap(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",7),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.scorecardName=l)}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngModel",i.scorecardName)}}function Rp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-svg-icon",8),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onScorecardNameEdit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("can-display",e.\u0275\u0275pipeBind1(1,3,i.isEditMode$)),e.\u0275\u0275property("name","edit_20_regular")}}function Lp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",7),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.scorecardDescription=l)}),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngModel",i.scorecardDescription)}}function Gp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-svg-icon",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.onDescriptionEdit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("can-display",e.\u0275\u0275pipeBind1(1,3,i.isEditMode$)),e.\u0275\u0275property("name","edit_20_regular")}}function Np(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275template(1,Lp,1,1,"input",4),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Gp,2,5,"tri-svg-icon",10),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiEditableLabel",t.pbiEditableDescriptionOptions)("pbiEditableLabelValue",t.scorecardDescription)("pbiEditableLabelMode",e.\u0275\u0275pipeBind1(2,5,t.isEditMode$))("pbiEditableLabelEditable",t.isScorecardDescriptionEditable),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isScorecardDescriptionEditable)}}function Hp(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",3),e.\u0275\u0275template(2,Ap,1,1,"input",4),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,Rp,2,5,"tri-svg-icon",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Np,4,7,"span",6),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiEditableLabel",t.pbiEditableNameOptions)("pbiEditableLabelValue",t.scorecardName)("pbiEditableLabelMode",e.\u0275\u0275pipeBind1(3,6,t.isEditMode$))("pbiEditableLabelEditable",t.isScorecardNameEditable),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isScorecardNameEditable),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.scorecardDescription)}}function zp(o,n){1&o&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1,"-"),e.\u0275\u0275elementEnd())}function Bp(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",12),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,zp,2,0,"div",13),e.\u0275\u0275elementStart(3,"div",14),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("title",t.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showTitleDash),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("title",t.scorecardDescription),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.scorecardDescription)}}var fl=function(){function o(n,t,i){this.changeDetector=n,this.scorecardService=t,this.telemetryService=i,this.isNewHeader=!0,this.isScorecardNameEditable=!1,this.isScorecardDescriptionEditable=!1,this.isEditMode$=this.scorecardService.isEditMode()}return o.prototype.ngOnInit=function(){var n=this;this.showTitleDash=void 0!==this.scorecardDescription&&""!==this.scorecardDescription&&this.isNewHeader;var t=this.scorecardName,i=this.scorecardDescription;this.pbiEditableNameOptions={disableClick:!0,customTooltip:!1,inputMatchLabelWidth:!1,onEdit:this.onScorecardNameEdit.bind(this),onBlur:function(){return(0,M.__awaiter)(n,void 0,void 0,function(){return(0,M.__generator)(this,function(l){switch(l.label){case 0:return this.isScorecardNameEditable=!1,t===this.scorecardName?[2]:(this.telemetryService.logEvent(Mn),[4,this.updateScorecardDetails()]);case 1:return l.sent(),t=this.scorecardName,[2]}})})}},this.pbiEditableDescriptionOptions={disableClick:!0,customTooltip:!1,inputMatchLabelWidth:!1,onEdit:this.onDescriptionEdit.bind(this),onBlur:function(){return(0,M.__awaiter)(n,void 0,void 0,function(){return(0,M.__generator)(this,function(l){switch(l.label){case 0:return this.isScorecardDescriptionEditable=!1,i===this.scorecardDescription?[2]:(this.telemetryService.logEvent(jt),[4,this.updateScorecardDetails()]);case 1:return l.sent(),i=this.scorecardDescription,[2]}})})}}},o.prototype.ngOnChanges=function(n){n.scorecardDescription&&(this.showTitleDash=void 0!==this.scorecardDescription&&""!==this.scorecardDescription)},o.prototype.onScorecardNameEdit=function(){this.isScorecardNameEditable=!0,this.changeDetector.markForCheck()},o.prototype.onDescriptionEdit=function(){this.isScorecardDescriptionEditable=!0,this.changeDetector.markForCheck()},o.prototype.updateScorecardDetails=function(){return this.scorecardService.updateScorecard({name:this.scorecardName,description:this.scorecardDescription})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(Fn.y0))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-title"]],inputs:{scorecardName:"scorecardName",scorecardDescription:"scorecardDescription",isTitleEditable:"isTitleEditable",isNewHeader:"isNewHeader"},features:[e.\u0275\u0275NgOnChangesFeature],decls:4,vars:4,consts:[["data-testid","scorecard-title",1,"scorecard-title"],[4,"ngIf","ngIfElse"],["staticTitle",""],[1,"editableLabel"],[3,"ngModel","ngModelChange",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable"],["tri-svg-icon-16","","class","tri-svg","data-testid","edit-scorecard-title",3,"name","can-display","click",4,"ngIf"],["class","editableDescription",4,"ngIf"],[3,"ngModel","ngModelChange"],["tri-svg-icon-16","","data-testid","edit-scorecard-title",1,"tri-svg",3,"name","click"],[1,"editableDescription"],["tri-svg-icon-16","","class","tri-svg",3,"name","can-display","click",4,"ngIf"],["tri-svg-icon-16","",1,"tri-svg",3,"name","click"],[1,"title",3,"title"],["class","dash",4,"ngIf"],[1,"subtitle",3,"title"],[1,"dash"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275template(1,Hp,6,8,"ng-container",1),e.\u0275\u0275template(2,Bp,5,5,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t){var a=e.\u0275\u0275reference(3);e.\u0275\u0275classProp("old-header",!i.isNewHeader),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isTitleEditable)("ngIfElse",a)}},dependencies:[F.NgIf,it.Fj,it.JJ,it.On,Fp.D,Er.M,F.AsyncPipe],styles:[".scorecard-title.old-header[_ngcontent-%COMP%]{display:block}.scorecard-title.old-header[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]     pbi-text-label{max-width:90%}.scorecard-title.old-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:10px}.scorecard-title.old-header[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]     pbi-text-label{max-width:90%}.scorecard-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;box-sizing:border-box;padding:12px 30px 6px;width:100%;background-color:var(--scorecard-headerBackgroundColor)}.scorecard-title[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--scorecard-headerForegroundColor);font-family:var(--scorecard-fontFamily);font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.scorecard-title[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]{height:40px;display:flex;align-items:center;padding-bottom:0;margin-right:10px;color:var(--scorecard-headerForegroundColor);font-family:var(--scorecard-fontFamily);font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.scorecard-title[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]:hover   .tri-svg.can-display[_ngcontent-%COMP%]{visibility:visible}.scorecard-title[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]{flex-grow:100;display:flex;align-items:center;color:var(--scorecard-headerForegroundColor);opacity:.9;font-family:var(--scorecard-fontFamily);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}.scorecard-title[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]:hover   .tri-svg.can-display[_ngcontent-%COMP%]{visibility:visible}.scorecard-title[_ngcontent-%COMP%]   .tri-svg[_ngcontent-%COMP%]{height:16px;width:16px;margin-left:6px;margin-right:4px;visibility:hidden}.scorecard-title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 12px 6px 16px;box-sizing:border-box;border:2px solid #0F6CBD;border-radius:4px}.scorecard-title[_ngcontent-%COMP%]   .dash[_ngcontent-%COMP%]{padding:0 8px}.scorecard-title[_ngcontent-%COMP%]   .dash[_ngcontent-%COMP%], .scorecard-title[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:var(--scorecard-headerForegroundColor);opacity:.9;font-family:var(--scorecard-fontFamily);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}"],changeDetection:0}),o}();function Up(o,n){if(1&o&&e.\u0275\u0275element(0,"scorecard-title",7),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecardName",t.scorecard.name)("isTitleEditable",t.isTitleEditable)}}function qp(o,n){1&o&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function Wp(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,qp,1,0,"scorecard-hierarchy-button",8),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies"))}function jp(o,n){1&o&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function $p(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,jp,1,0,"scorecard-hierarchy-button",8),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies"))}var ec=function(){function o(n,t){this.hierarchyService=n,this.featureSwitchService=t,this.filterBy=new e.EventEmitter,this.onLinkedMetricInit=new e.EventEmitter,this.onNewGoal=new e.EventEmitter,this.onNewSubGoal=new e.EventEmitter,this.isTitleEditable=this.featureSwitchService.featureSwitches.goalsSkipScorecardCreationPane}return o.prototype.ngOnInit=function(){this.hasHierarchies$=this.hierarchyService.hasHierarchies$},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(Ln.vZ))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-list-toolbar"]],inputs:{isEditMode:"isEditMode",scorecard:"scorecard",scorecardCapabilities:"scorecardCapabilities",numberOfSelectedGoals:"numberOfSelectedGoals",filterText:"filterText",showTitle:"showTitle"},outputs:{filterBy:"filterBy",onLinkedMetricInit:"onLinkedMetricInit",onNewGoal:"onNewGoal",onNewSubGoal:"onNewSubGoal"},decls:10,vars:10,consts:[["data-testid","scorecard-list-toolbar",1,"scorecard-list-toolbar"],[1,"left-actions","actions-container"],[3,"scorecardName","isTitleEditable",4,"ngIf"],[4,"ngIf"],[1,"right-actions","actions-container"],[3,"filterText","filterBy"],[3,"isEditMode","scorecardCapabilities","numberOfSelectedGoals","hasHierarchies","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"scorecardName","isTitleEditable"],[4,"pbiFeatureSwitch"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"div",1),e.\u0275\u0275template(2,Up,1,2,"scorecard-title",2),e.\u0275\u0275template(3,Wp,2,1,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275template(5,$p,2,1,"ng-container",3),e.\u0275\u0275elementStart(6,"scorecard-filter",5),e.\u0275\u0275listener("filterBy",function(l){return i.filterBy.emit(l)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"view-switcher"),e.\u0275\u0275elementStart(8,"scorecard-new-button",6),e.\u0275\u0275listener("onNewGoal",function(){return i.onNewGoal.emit()})("onNewSubGoal",function(){return i.onNewSubGoal.emit()})("onLinkedMetricInit",function(){return i.onLinkedMetricInit.emit()}),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.showTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.showTitle),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.showTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("filterText",i.filterText),e.\u0275\u0275advance(2),e.\u0275\u0275property("isEditMode",i.isEditMode)("scorecardCapabilities",i.scorecardCapabilities)("numberOfSelectedGoals",i.numberOfSelectedGoals)("hasHierarchies",e.\u0275\u0275pipeBind1(9,8,i.hasHierarchies$)))},dependencies:[F.NgIf,I.P,xl,fl,gl,Dl,Il,F.AsyncPipe],styles:["[_nghost-%COMP%]{--toolbar-padding: 0px 30px 12px 30px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap;box-sizing:border-box;padding:var(--toolbar-padding);width:100%;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);vertical-align:top}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .no-line .mat-form-field-underline{display:none}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{border-top:0px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .scorecard-title{padding:0}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .scorecard-title .editableLabel{font-size:var(--lg-font-size)}"],changeDetection:0}),o}(),tc=function(){function o(){this.filterBy=new e.EventEmitter}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-metric-picker-toolbar"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},decls:4,vars:1,consts:[[1,"scorecard-picker-toolbar"],[1,"left-actions"],[1,"right-actions"],[3,"filterText","filterBy"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275element(1,"div",1),e.\u0275\u0275elementStart(2,"div",2)(3,"scorecard-filter",3),e.\u0275\u0275listener("filterBy",function(l){return i.filterBy.emit(l)}),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("filterText",i.filterText))},dependencies:[gl],styles:[".scorecard-picker-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;box-sizing:border-box;padding:0 30px 12px;width:100%;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);vertical-align:top}"],changeDetection:0}),o}(),kl=m(78181),Qp=m(69437),Kp=["scorecardStatusTiles"];function Xp(o,n){1&o&&e.\u0275\u0275element(0,"pbi-office-icon",11)}var Zp=function(n){return{"background-color":n}};function Yp(o,n){if(1&o&&e.\u0275\u0275element(0,"div",12),2&o){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(2,Zp,t.color))}}function Jp(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-button-toggle",5),e.\u0275\u0275listener("click",function(){var c=e.\u0275\u0275restoreView(t).$implicit,p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onStatusTileClicked(c))}),e.\u0275\u0275elementStart(1,"span",6),e.\u0275\u0275template(2,Xp,1,0,"pbi-office-icon",7),e.\u0275\u0275template(3,Yp,1,4,"div",8),e.\u0275\u0275elementStart(4,"div",9),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"span",10),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()}if(2&o){var i=n.$implicit;e.\u0275\u0275classProp("filtered-on",i.filteredOn)("hide",i.collapsed),e.\u0275\u0275property("checked",i.filteredOn),e.\u0275\u0275attribute("aria-label",i.displayName),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.filteredOn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.filteredOn),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.displayName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.count)}}function e0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onCollapse())}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("expanded",!i.collapsed),e.\u0275\u0275attribute("aria-label",i.collapseButtonAriaLabel),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.collapseButtonLabel)}}var nc=function(){function o(n,t){this.changeDetectorRef=n,this.localizationService=t,this.onStatusSelected=new e.EventEmitter,this.collapsed=!0,this.columnGap=8,this.enableCollapse=!1,this.tileMinWidth=140,this.tileMaxWidth=210,this.goalStatusHelper=new Q.p(this.localizationService)}return o.prototype.onResize=function(){this.updateGoalStatusTiles()},o.prototype.ngAfterViewInit=function(){this.updateGoalStatusTiles()},o.prototype.ngOnChanges=function(){this.updateGoalStatusTiles()},o.prototype.onStatusTileClicked=function(n){if(_.isNil(this.selectedStatuses)&&(this.selectedStatuses=[]),n.status){var t=_.find(this.selectedStatuses,function(i){return Q.p.statusesMatch(i,n.status)});t?this.selectedStatuses=_.without(this.selectedStatuses,t):this.selectedStatuses.push(n.status)}else this.selectedStatuses=[];this.updateGoalStatusTiles(),this.onStatusSelected.emit(this.selectedStatuses)},o.prototype.onCollapse=function(){this.collapsed=!this.collapsed,this.updateGoalStatusTiles()},o.prototype.updateGoalStatusTiles=function(){this.createStatusTiles(),this.calculateGrid(),this.collapseGrid(),this.changeDetectorRef.markForCheck()},o.prototype.createStatusTiles=function(){var n;if(this.goals&&0!==(null===(n=this.goals)||void 0===n?void 0:n.length)&&(1!==this.goals.length||!_.isNil(this.goals[0].name))){var t=W.flattenGoals(this.goals);this.statusTiles=[];var i=_.isEmpty(this.selectedStatuses);this.statusTiles.push({displayName:this.localizationService.get("MetricsName_New"),count:_.size(t),collapsed:!1,filteredOn:i});for(var a=_.filter(this.goalStatusList,function(te){return!te.historical}),c=0,p=Q.p.getDistinctStatuses(t,this.goalStatusesByScorecardId,a);c<p.length;c++){var y=p[c],O=this.goalStatusHelper.tryLocalizeDisplayName(y.displayName)||this.localizationService.get("NullValue"),A=Q.p.listIncludesMatchingStatus(this.selectedStatuses,y),L=Q.p.getGoalStatusIconColor(y.color);this.statusTiles.push({status:y,displayName:O,color:L,count:y.count,collapsed:!1,filteredOn:A})}}},o.prototype.calculateGrid=function(){var n,t;if(this.statusTiles&&0!==(null===(n=this.statusTiles)||void 0===n?void 0:n.length)&&null!==(t=this.scorecardStatusTiles)&&void 0!==t&&t.nativeElement){var i=this.statusTiles.length;if(this.availableSpace=this.scorecardStatusTiles.nativeElement.clientWidth,this.availableSpace<this.tileMinWidth)return this.gridLayout={numberOfRows:i,numberOfColumns:1},this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(".concat(this.gridLayout.numberOfColumns,", 1fr)")},void(this.enableCollapse=!0);if(this.availableSpace>i*this.tileMaxWidth+(i-1)*this.columnGap)return this.gridLayout={numberOfRows:1,numberOfColumns:i},this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(auto-fill, ".concat(this.tileMaxWidth,"px)")},void(this.enableCollapse=!1);for(var a=Math.floor((this.availableSpace-this.tileMinWidth)/(this.tileMinWidth+this.columnGap)+1),c=[];a>0&&(this.availableSpace-(a-1)*this.columnGap)/a<=this.tileMaxWidth;)c.push({numberOfRows:Math.ceil(this.statusTiles.length/a),numberOfColumns:a}),a-=1;switch(c.length){case 0:a=Math.floor((this.availableSpace-this.tileMinWidth)/(this.tileMinWidth+this.columnGap)+1),this.gridLayout={numberOfRows:Math.ceil(this.statusTiles.length/a),numberOfColumns:a};break;case 1:this.gridLayout=c[0];break;default:if(this.availableSpace>=768){this.gridLayout=c[c.length-1];break}if(this.availableSpace<=767&&this.availableSpace>480){this.gridLayout=c[Math.ceil(c.length/2)-1];break}if(this.availableSpace<=480){this.gridLayout=c[0];break}}this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(".concat(this.gridLayout.numberOfColumns,", 1fr)")},this.enableCollapse=this.gridLayout.numberOfRows>1}},o.prototype.collapseGrid=function(){if(this.enableCollapse){if(!this.collapsed)return this.collapseButtonLabel=this.localizationService.get("Collapse"),void(this.collapseButtonAriaLabel=this.localizationService.get("CollapseStatuses"));for(var n=!0,t=this.gridLayout.numberOfColumns-1;t<this.statusTiles.length;t++)this.statusTiles[t].filteredOn&&(n=!1);n?this.standardCollapse():this.rearrangeCollapse(),this.collapseButtonLabel=this.localizationService.format("ShowXMore",[this.collapsedStatuses]),this.collapseButtonAriaLabel=this.localizationService.format("ShowMoreStatuses",[this.collapsedStatuses])}},o.prototype.standardCollapse=function(){for(var n=this.gridLayout.numberOfColumns-1;n<this.statusTiles.length;n++)this.statusTiles[n].collapsed=!0;this.collapsedStatuses=this.statusTiles.length-(this.gridLayout.numberOfColumns-1)},o.prototype.rearrangeCollapse=function(){var n=[this.statusTiles[0]],t=this.statusTiles.filter(function(l){return l.filteredOn&&l.status}),i=this.statusTiles.filter(function(l){return!l.filteredOn&&l.status});n=(n=n.concat(t)).concat(i),this.collapsedStatuses=0;for(var a=0;a<n.length;a++)!n[a].filteredOn&&a>this.gridLayout.numberOfColumns-2&&(n[a].collapsed=!0,this.collapsedStatuses+=1);this.statusTiles=n},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard-status-tiles"]],viewQuery:function(t,i){var a;(1&t&&e.\u0275\u0275viewQuery(Kp,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.scorecardStatusTiles=a.first))},hostBindings:function(t,i){1&t&&e.\u0275\u0275listener("resize",function(l){return i.onResize(l)},!1,e.\u0275\u0275resolveWindow)},inputs:{goals:"goals",goalStatusesByScorecardId:"goalStatusesByScorecardId",goalStatusList:"goalStatusList",selectedStatuses:"selectedStatuses"},outputs:{onStatusSelected:"onStatusSelected"},features:[e.\u0275\u0275NgOnChangesFeature],decls:5,vars:4,consts:[[1,"scorecard-status-tiles"],["multiple","",1,"status-tiles-btn-group"],["scorecardStatusTiles",""],["class","status-tile",3,"checked","filtered-on","hide","click",4,"ngFor","ngForOf"],["class","status-tiles-collapse-btn",3,"expanded","click",4,"ngIf"],[1,"status-tile",3,"checked","click"],[1,"status-tile-flex-container"],["class","status-tile-icon","name","CheckmarkWithDynamicColor_16",4,"ngIf"],["class","status-tile-dot",3,"style",4,"ngIf"],[1,"status-tile-name"],[1,"status-tile-count"],["name","CheckmarkWithDynamicColor_16",1,"status-tile-icon"],[1,"status-tile-dot"],[1,"status-tiles-collapse-btn",3,"click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"mat-button-toggle-group",1,2),e.\u0275\u0275template(3,Jp,8,10,"mat-button-toggle",3),e.\u0275\u0275template(4,e0,3,4,"button",4),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275styleMap(i.gridStyle),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.statusTiles),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.enableCollapse))},dependencies:[F.NgForOf,F.NgIf,kl.A9,kl.Yi,Qp.m],styles:[".scorecard-status-tiles[_ngcontent-%COMP%]{box-sizing:border-box;padding:0 30px;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);width:100%}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]{display:grid;row-gap:12px;grid-template-rows:repeat(auto-fill,40px);column-gap:8px;grid-template-columns:repeat(auto-fill,140px);padding:12px 0;width:100%;border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;justify-content:space-between;min-width:140px;max-width:210px;padding:0;box-shadow:none;border:1px solid var(--gray-30, #EDEBE9);border-radius:2px;background-color:var(--fluent-theme-white-color, #FFF)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile.hide[_ngcontent-%COMP%]{display:none}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]:hover{background-color:var(--gray-20, #F3F2F1)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]:active{background-color:var(--gray-30, #EDEBE9)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile.filtered-on[_ngcontent-%COMP%]{border:1px solid var(--gray-140, #484644)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button{width:100%;padding:10px 12px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content{display:flex;box-sizing:border-box;justify-content:space-between;max-height:20px;padding:0;line-height:20px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container{text-align:left;max-width:80%}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-dot{display:inline-block;height:8px;width:8px;margin:6px 8px 6px 0;border-radius:50%;background-color:var(--fluent-theme-black-color, #000)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-icon{display:inline-block;vertical-align:top;height:16px;width:16px;margin:1px 4px 2px 0}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-name{display:inline-block;width:100%;line-height:20px;font-family:var(--scorecard-fontFamily);font-size:var(--md-font-size, 14px);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-count{max-width:20%;font-family:var(--scorecard-fontFamily);font-size:var(--md-font-size, 14px);text-align:right;line-height:20px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin:auto 0 auto auto;padding:0;color:var(--fluent-theme-link-darker-alt-color, #106EBE);background:transparent;border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:hover, .scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:active{border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:hover, .scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:active{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn.expanded[_ngcontent-%COMP%]{flex-direction:row;margin:auto auto auto 12px}"],changeDetection:0}),o}(),t0=m(87582),n0=m(85928),r0=m(48741),Vl=function(){function o(n,t,i,a){this.appSettings=n,this.mashupService=t,this.httpClient=i,this.goalsHttpService=a}return o.prototype.evaluateQuery=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a;return(0,M.__generator)(this,function(p){switch(p.label){case 0:return[4,this.mashupService.getPQEndpoint().pipe((0,Me.q)(1)).toPromise()];case 1:return t=p.sent(),[4,this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).pipe((0,Me.q)(1)).toPromise()];case 2:return i=p.sent(),a="".concat(t,"/api/evaluator/evaluate"),[4,this.httpClient.post(a,{mashupDocument:n,queryName:"Query",fastCombine:!0},{headers:{"x-ms-api-version":"2.0",authorization:"Bearer ".concat(i)}}).pipe((0,Me.q)(1)).toPromise()];case 3:return[2,p.sent()]}})})},o.prototype.importGoal=function(n,t,i,a,l){return(0,M.__awaiter)(this,void 0,void 0,function(){var c,p,y,O,A,L,te,ue,Ae,Ne,Je,ze,ft,xt;return(0,M.__generator)(this,function(Kt){switch(Kt.label){case 0:c=[],p=_.indexOf(a,"Name"),y=_.indexOf(a,"Owner"),O=_.indexOf(a,"Status"),A=_.indexOf(a,"Value"),L=_.indexOf(a,"Due Date"),te=_.indexOf(a,"Notes"),c.push(p,y,O,A,L,te),-1!==O&&(ue=this.getStatus(i,O,l)),Ae=0,Ne=0,Je=i.rows,Kt.label=1;case 1:return Ne<Je.length?[4,this.goalsHttpService.createGoal(n,t,{name:(ze=Je[Ne])[p],owner:ze[y],completionDate:ze[L]}).pipe().toPromise()]:[3,5];case 2:return ft=Kt.sent(),xt={timestamp:"2:00",status:ue[Ae]},Ae+=1,[4,this.goalsHttpService.createGoalValue(n,t,ft.id,xt)];case 3:Kt.sent(),Kt.label=4;case 4:return Ne++,[3,1];case 5:return[2]}})})},o.prototype.getStatus=function(n,t,i){for(var l=[],c=0,p=n.rows;c<p.length;c++){var O=p[c][t].replace(/\s/g,"");l.push(O)}for(var A=[],L=0,te=l;L<te.length;L++){var Ae=Q.p.getGoalStatusId(te[L],i);A.push(Ae)}return A},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Eo.de),e.\u0275\u0275inject(n0.M),e.\u0275\u0275inject(r0.eN),e.\u0275\u0275inject(Lt))},o.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}();function o0(o,n){if(1&o&&e.\u0275\u0275element(0,"message-banner",10),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBannerModelColumn)}}function a0(o,n){if(1&o&&e.\u0275\u0275element(0,"message-banner",10),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBannerModelEmpty)}}function s0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("value",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.sheetName)}}function l0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275element(1,"p",12),e.\u0275\u0275elementStart(2,"select",13),e.\u0275\u0275listener("change",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onSelectTable(l.target.value))}),e.\u0275\u0275template(3,s0,2,2,"option",14),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",i.goalPreviewData)}}function c0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"option",24),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function u0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th")(1,"div",19)(2,"div",20)(3,"select",21),e.\u0275\u0275listener("ngModelChange",function(p){var O=e.\u0275\u0275restoreView(t).index,A=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(A.matchedHeaderName[O]=p)}),e.\u0275\u0275text(4),e.\u0275\u0275template(5,c0,2,2,"option",22),e.\u0275\u0275element(6,"option"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",23),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()()}if(2&o){var i=n.index,a=n.$implicit,l=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",l.matchedHeaderName[i]),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",l.matchedHeaderName[i]," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",l.scorecardAttributes),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a)}}function d0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"td"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function p0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"tr"),e.\u0275\u0275template(1,d0,2,1,"td",18),e.\u0275\u0275elementEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function h0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",16)(1,"table",17)(2,"tr"),e.\u0275\u0275template(3,u0,9,4,"th",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,p0,2,1,"tr",18),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.matchedHeaderName)("ngForOf",t.goalImportFileMetadata.tables[t.selectTable].column),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.goalImportFileMetadata.tables[t.selectTable].rows)}}function g0(o,n){1&o&&e.\u0275\u0275element(0,"pbi-spinner",25)}function f0(o,n){1&o&&e.\u0275\u0275element(0,"span",32)}function m0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.numGoals,"")}}function v0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",26)(1,"div",27)(2,"button",28),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.importFromFile())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.close())}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(4,f0,1,0,"span",30),e.\u0275\u0275template(5,m0,2,1,"span",31),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",i.hasDataLoaded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.hasDataLoaded)}}var _0=function(){function o(n,t,i,a){this.data=n,this.mashupEvaluationService=t,this.localizationService=i,this.dialogService=a,this.selectTable=0,this.maxPercent=0,this.numGoals=0,this.emptyFile=!1,this.exceedsColumns=!1,this.hasDataLoaded=!1,this.messageBannerModelColumn={bannerType:0,iconName:"pbi-glyph-warning",message:this.localizationService.get("MetricsScorecard_Import_Error_Column_Num")},this.messageBannerModelEmpty={bannerType:0,iconName:"pbi-glyph-error",message:this.localizationService.get("MetricsScorecard_Import_Error_Empty_File")}}return o.prototype.ngOnInit=function(){var n=this;this.goalImportFileMetadata={file_name:"ExampleFile",tables:[]},this.goalPreviewData=this.goalImportFileMetadata.tables,this.scorecardAttributes=["Name","Owner","Status","Value","Progress","Due Date","Notes"],this.getAllTables().then(function(t){if(_.isEmpty(t))n.emptyFile=!0;else{for(var i=0,a=t;i<a.length;i++){var l=a[i];n.goalPreviewData.push({sheetName:l.sheetName,tableName:l.tableName,column:[],rows:[]})}n.onSelectTable(0)}})},o.prototype.onSelectTable=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return this.selectTable=n,t=this.goalImportFileMetadata.tables[n],_.isEmpty(t.column)?(this.hasDataLoaded=!1,[4,this.evaluatePreviewTable(t.sheetName,t.tableName)]):[3,2];case 1:i=a.sent(),this.goalImportFileMetadata.tables[this.selectTable].column=i.columns,this.goalImportFileMetadata.tables[this.selectTable].rows=i.rows,a.label=2;case 2:return this.setHeaders(),this.numGoals=this.goalImportFileMetadata.tables[this.selectTable].rows.length,this.exceedsColumns=this.goalImportFileMetadata.tables[this.selectTable].column.length>=7,[2]}})})},o.prototype.setHeaders=function(){this.excelHeaders=this.goalImportFileMetadata.tables[this.selectTable].column;for(var n=[],t=0,i=this.excelHeaders;t<i.length;t++)this.stringSimilarity(i[t],this.scorecardAttributes),n.push(this.maxPercentHeader);this.matchedHeaderName=n,this.hasDataLoaded=!0},o.prototype.getAllTables=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,i,a,l,c,p,y;return(0,M.__generator)(this,function(O){switch(O.label){case 0:return n=this.data.fileData,u.fF.assertValue(this.data.fileData,"Missing file data"),[4,this.mashupEvaluationService.evaluateQuery('section Section1; shared Query = let source = Excel.Workbook(Binary.FromText("'.concat(n,'")) in source;'))];case 1:for(t=O.sent(),i=[],a=_.indexOf(t.columns,"Name"),l=_.indexOf(t.columns,"Kind"),c=0,p=t.rows;c<p.length;c++)"Table"===(y=p[c])[l]&&i.push({sheetName:y[a],tableName:y[l],column:[],rows:[]});return[2,i]}})})},o.prototype.importFromFile=function(){var n;return(0,M.__awaiter)(this,void 0,void 0,function(){var i;return(0,M.__generator)(this,function(a){switch(a.label){case 0:return[4,this.mashupEvaluationService.importGoal((i=this.data.scorecard).groupId,i.id,this.goalImportFileMetadata.tables[this.selectTable],this.matchedHeaderName,null===(n=i.goalStatuses)||void 0===n?void 0:n.statuses)];case 1:return a.sent(),this.close(),[2]}})})},o.prototype.evaluatePreviewTable=function(n,t){return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(a){return[2,this.mashupEvaluationService.evaluateQuery('section Section1; shared Query = let source = Excel.Workbook(Binary.FromText("'.concat(this.data.fileData,'")){[Item="').concat(n,'",Kind="').concat(t,'"]}[Data] in source;'))]})})},o.prototype.stringSimilarity=function(n,t,i){function a(ft,xt){ft=" ".repeat(xt-1)+ft.toLowerCase()+" ".repeat(xt-1);for(var Kt=new Array(ft.length-xt+1),kt=0;kt<Kt.length;kt++)Kt[kt]=ft.slice(kt,kt+xt);return Kt}void 0===i&&(i=2),this.maxPercent=0;for(var l=0,c=0,p=t;c<p.length;c++){var y=p[c];if(!n?.length||!y?.length)return 0;for(var A=n.length<y.length?y:n,L=a(n.length<y.length?n:y,i),te=a(A,i),ue=new Set(L),Ae=te.length,Ne=0,Je=0,ze=te;Je<ze.length;Je++)ue.delete(ze[Je])&&Ne++;(l=Ne/Ae)>this.maxPercent&&(this.maxPercent=l,this.maxPercentHeader=y)}},o.prototype.close=function(){this.dialogService.closeAll()},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Hn.WI),e.\u0275\u0275directiveInject(Vl),e.\u0275\u0275directiveInject(Vt.o),e.\u0275\u0275directiveInject(hn.x))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["import-dialog"]],features:[e.\u0275\u0275ProvidersFeature([Vl])],decls:13,vars:9,consts:[[1,"header"],["mat-dialog-title","","localize","MetricsScorecard_Import_Dialog_Header"],[1,"title"],["mat-icon-button","",1,"close",3,"click"],["fontIcon","pbi-glyph-close",1,"glyph-mini"],["class","impact-margin",3,"viewModel",4,"ngIf"],["class","select",4,"ngIf"],["class","scroll",4,"ngIf"],["class","pbi-spinner-large",4,"ngIf"],["class","import",4,"ngIf"],[1,"impact-margin",3,"viewModel"],[1,"select"],["localize","MetricsScorecard_Import_Dialog_Description",1,"description"],[1,"select-table",3,"change"],["class","table-select",3,"value",4,"ngFor","ngForOf"],[1,"table-select",3,"value"],[1,"scroll"],["id","preview-table"],[4,"ngFor","ngForOf"],[1,"table-headers"],["id","left"],[1,"col-headers",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"right"],[3,"value"],[1,"pbi-spinner-large"],[1,"import"],[1,"dialog-buttons"],["localize","Import","localizeTooltip","Import",1,"pbi-fluent-button","primary",3,"click"],["localize","PBI_Button_Label_Cancel","localizeTooltip","PBI_Button_Label_Cancel",1,"pbi-fluent-button",3,"click"],["class","num-goals","localize","MetricsScorecard_Import_Dialog_Number_Metrics",4,"ngIf"],["class","number",4,"ngIf"],["localize","MetricsScorecard_Import_Dialog_Number_Metrics",1,"num-goals"],[1,"number"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275element(1,"h1",1)(2,"div",2),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275listener("click",function(){return i.close()}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275element(5,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,o0,1,1,"message-banner",5),e.\u0275\u0275template(7,a0,1,1,"message-banner",5),e.\u0275\u0275elementStart(8,"div"),e.\u0275\u0275template(9,l0,4,1,"div",6),e.\u0275\u0275template(10,h0,5,3,"div",7),e.\u0275\u0275template(11,g0,1,0,"pbi-spinner",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,v0,6,2,"section",9)),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,7,"Close")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.exceedsColumns),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.emptyFile),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==i.goalPreviewData?null:i.goalPreviewData.length)>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.hasDataLoaded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.hasDataLoaded&&!i.emptyFile),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==i.goalPreviewData?null:i.goalPreviewData.length)>0))},dependencies:[F.NgForOf,F.NgIf,Hn.uh,it.YN,it.Kr,it.EJ,it.JJ,it.On,Sn.X,Kr.r,vn.Hw,we.A,cr.k,Bt.F],styles:[".header[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;flex-direction:row;align-items:center}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:none;margin:0;background-color:transparent;border:0;padding:0}.header[_ngcontent-%COMP%]   button.close[_ngcontent-%COMP%]{flex:0 0 20px;align-self:flex-start}.select-table[_ngcontent-%COMP%]{border-bottom:revert;width:10%;margin-left:10px;height:32px;cursor:pointer;padding:0 8px;border-width:1px}div.scroll[_ngcontent-%COMP%]{height:55vh;overflow-y:scroll}.description[_ngcontent-%COMP%]{display:inline}.select[_ngcontent-%COMP%]{padding-bottom:15px}#preview-table[_ngcontent-%COMP%]{padding-top:15px;border-collapse:collapse;width:100%}#preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], #preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #bebebe;padding:4px}#preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px;font-size:12px;text-align:left;background-color:#ccc}.col-headers[_ngcontent-%COMP%]{border-color:transparent;background-color:transparent;border-bottom:black;font-size:14px;text-overflow:ellipsis}.table-headers[_ngcontent-%COMP%]{display:flex;padding-left:10px;padding-right:8px}.right[_ngcontent-%COMP%]{font-weight:400;text-align:center;padding-left:4vh}.pbi-fluent-button[_ngcontent-%COMP%]{margin-left:8px}.pbi-spinner-large[_ngcontent-%COMP%]{top:50%;left:50%;position:absolute}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;opacity:0;animation-name:fade-in;animation-duration:.5s;animation-iteration-count:1;animation-timing-function:linear;animation-delay:1s;animation-fill-mode:forwards}.import[_ngcontent-%COMP%]{flex:0 0 55px;display:flex;bottom:13%;flex-direction:inherit;align-items:flex-end;padding-right:1%;position:fixed;display:-webkit-inline-box}.number[_ngcontent-%COMP%]{padding-left:1%;display:contents}.num-goals[_ngcontent-%COMP%]{margin-left:25px}"]}),o}(),C0=new e.InjectionToken("LinkedMetricsLauncherService"),Fl=m(23558),y0=["inputFile"],b0=["columnTable"],w0=function(){return["Metric_Owner_No_Scorecard_Access","Metric_Owners_No_Scorecard_Access","Share_Now"]};function S0(o,n){if(1&o&&(e.\u0275\u0275element(0,"scorecard-access-banner",8),e.\u0275\u0275pipe(1,"async")),2&o){var t=e.\u0275\u0275nextContext(2).ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",t)("users",e.\u0275\u0275pipeBind1(1,3,i.goalOwners$))("labels",e.\u0275\u0275pureFunction0(5,w0))}}function M0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"label",18)(1,"input",19,20),e.\u0275\u0275listener("change",function(a){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(l.onImportClick(a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",21),e.\u0275\u0275elementEnd()}}function P0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onNewGoalClick())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"mat-icon",13)(4,"span",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onNewSubGoalClick())}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275element(8,"span",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,M0,4,0,"label",17),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("primary",!i.toolbarNewLook),e.\u0275\u0275property("disabled",!i.scorecardCapabilities.createGoal.enabled),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,7,"NewMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",!i.scorecardCapabilities.createGoal.enabled||1!==e.\u0275\u0275pipeBind1(7,11,i.numberOfSelectedGoals$)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,9,"AddSubmetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",i.showImportButton)}}var O0=function(n){return{active:n}};function E0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"button",32,33),e.\u0275\u0275element(2,"mat-icon",34)(3,"span",35)(4,"mat-icon",36),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(1);e.\u0275\u0275nextContext();var i=e.\u0275\u0275reference(4),a=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("matMenuTriggerFor",i)("ngClass",e.\u0275\u0275pureFunction1(5,O0,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("fontIcon","List"===a.viewType?"pbi-glyph-list":"pbi-glyph-table"),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","View")("localizeTooltip","View")}}function T0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(a.openHeatmapConfigurationPane())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",38)(3,"span",39),e.\u0275\u0275elementEnd()}2&o&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"MetricsCustomizeHeatmap"))}function x0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(a.openHierarchiesBuilder())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",41)(3,"span",42),e.\u0275\u0275elementEnd()}2&o&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"MetricsManageHierarchies"))}function I0(o,n){1&o&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function D0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,E0,5,7,"button",22),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"mat-menu",23,24)(5,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onScorecardViewClick())}),e.\u0275\u0275element(6,"mat-icon",26)(7,"span",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.onHeatmapViewClick())}),e.\u0275\u0275element(9,"mat-icon",28)(10,"span",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(11,T0,4,3,"button",30),e.\u0275\u0275template(12,x0,4,3,"button",31),e.\u0275\u0275template(13,I0,1,0,"scorecard-hierarchy-button",7),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,5,i.hasHierarchies$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf","Heatmap"===i.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isEditMode&&"Heatmap"===i.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","List"===i.viewType)}}function k0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",9)(1,"div",10),e.\u0275\u0275template(2,P0,10,13,"ng-container",7),e.\u0275\u0275element(3,"div",11),e.\u0275\u0275template(4,D0,14,7,"ng-container",7),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("new-look",t.toolbarNewLook),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",("List"===t.viewType||"Compact"===t.viewType)&&t.isEditMode),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.showHierarchies)}}function V0(o,n){if(1&o&&e.\u0275\u0275element(0,"scorecard-title",43),2&o){var t=e.\u0275\u0275nextContext(2).ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecardName",t.name)("scorecardDescription",t.description)("isTitleEditable",i.isTitleEditable)}}function F0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-metric-picker-toolbar",50),e.\u0275\u0275listener("filterBy",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onFilterKeywordChange(l))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(5);e.\u0275\u0275property("filterText",e.\u0275\u0275pipeBind1(1,1,i.filterBy$).keyword)}}function A0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-list-toolbar",51),e.\u0275\u0275listener("filterBy",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(p.onFilterKeywordChange(c))})("onNewGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onNewGoalClick(!1))})("onNewSubGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onNewSubGoalClick())})("onLinkedMetricInit",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onLinkedMetricInit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("isEditMode",a.isEditMode)("scorecard",i)("scorecardCapabilities",a.scorecardCapabilities)("numberOfSelectedGoals",e.\u0275\u0275pipeBind1(1,6,a.numberOfSelectedGoals$))("filterText",e.\u0275\u0275pipeBind1(2,8,a.filterBy$).keyword)("showTitle","Compact"===a.viewType)}}function R0(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,F0,2,3,"scorecard-metric-picker-toolbar",48),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,A0,3,10,"ng-template",null,49,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275reference(4),i=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,i.showPickerToolbar$))("ngIfElse",t)}}function L0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-status-tiles",52),e.\u0275\u0275listener("onStatusSelected",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(p.onGoalsStatusTileSelectionChange(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("goals",i.goals)("goalStatusesByScorecardId",e.\u0275\u0275pipeBind1(1,4,a.goalStatusesByScorecardId$))("goalStatusList",null==i.goalStatuses?null:i.goalStatuses.statuses)("selectedStatuses",e.\u0275\u0275pipeBind1(2,6,a.filterBy$).statuses)}}function G0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",53)(1,"div"),e.\u0275\u0275element(2,"mat-icon",54),e.\u0275\u0275elementStart(3,"input",55),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onFilterKeywordChange(l))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-icon",56),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.toggleFilterRow())}),e.\u0275\u0275elementEnd()()()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275classProp("toolbar-visible",i.isEditMode),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",e.\u0275\u0275pipeBind1(6,9,i.filterBy$).keyword),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,5,"Filter_By_Keyword"))("placeholder",e.\u0275\u0275pipeBind1(5,7,"Filter_By_Keyword"))}}function N0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",63),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"pbi-checkbox",64),e.\u0275\u0275listener("onChange",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(c.onSelectAllGoals(l))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext(6);e.\u0275\u0275classProp("box-checked",e.\u0275\u0275pipeBind1(1,5,i.allGoalsSelected$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",e.\u0275\u0275pipeBind1(3,7,i.allGoalsSelected$))("pbiTooltip",e.\u0275\u0275pipeBind1(5,11,"Metrics_BulkEditing_SelectAllMetrics")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,9,"Metrics_BulkEditing_SelectAllMetrics"))}}function H0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",73),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(l.onToggleExpandAllMetrics())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275element(3,"mat-icon",74),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(9);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,2,e.\u0275\u0275pipeBind1(2,4,i.showAllChildren$)?"FieldListMenuItem_CollapseAll":"FieldListMenuItem_ExpandAll")),e.\u0275\u0275advance(3),e.\u0275\u0275property("fontIcon",e.\u0275\u0275pipeBind1(4,6,i.showAllChildren$)?"pbi-glyph-doublechevrondown":"pbi-glyph-doublechevronright")}}function z0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",75),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(l.toggleFilterRow())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275element(5,"mat-icon",76),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(9);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(3,6,e.\u0275\u0275pipeBind1(4,8,i.filterRowVisible$)?"Filters_Hide":"Filters_Show")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,2,e.\u0275\u0275pipeBind1(2,4,i.filterRowVisible$)?"Filters_Hide":"Filters_Show"))}}function B0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th",67)(1,"div",68),e.\u0275\u0275template(2,H0,5,8,"button",69),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,z0,6,10,"button",70),e.\u0275\u0275elementStart(5,"div",71)(6,"scorecard-column-header",72),e.\u0275\u0275listener("onSortColumn",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(8);return e.\u0275\u0275resetView(O.sortColumn(y))}),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementEnd()()()()}if(2&o){var i=e.\u0275\u0275nextContext(2),a=i.$implicit,l=i.index,c=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",c.collapseGoalsByDefault&&e.\u0275\u0275pipeBind1(3,6,c.hasExpandableGoals$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!c.goalsNewHeaderEnabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("column",c.ScorecardColumnConfigs[a.columnId])("index",l)("sort",e.\u0275\u0275pipeBind1(7,8,c.sort$))("isEditMode",c.isEditMode)}}function U0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th",78)(1,"scorecard-column-header",72),e.\u0275\u0275listener("onSortColumn",function(y){e.\u0275\u0275restoreView(t);var O=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(O.sortColumn(y))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()()}if(2&o){var i=e.\u0275\u0275nextContext(3),a=i.$implicit,l=i.index,c=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(1),e.\u0275\u0275property("column",c.ScorecardColumnConfigs[a.columnId])("index",l)("sort",e.\u0275\u0275pipeBind1(2,4,c.sort$))("isEditMode",c.isEditMode)}}function q0(o,n){if(1&o&&e.\u0275\u0275template(0,U0,3,6,"th",77),2&o){var t=e.\u0275\u0275nextContext(2).$implicit,i=e.\u0275\u0275nextContext(6);e.\u0275\u0275property("ngIf",!i.ScorecardColumnConfigs[t.columnId].hideHeaderInListView)}}function W0(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,B0,8,10,"th",65),e.\u0275\u0275template(2,q0,1,1,"ng-template",null,66,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0==i.columnId)("ngIfElse",t)}}function j0(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,W0,4,2,"ng-container",7),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.show)}}function $0(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"thead")(1,"tr",60)(2,"th",61),e.\u0275\u0275template(3,N0,6,13,"div",62),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,j0,2,1,"ng-container",59),e.\u0275\u0275elementEnd()()),2&o){var t=e.\u0275\u0275nextContext(5);e.\u0275\u0275advance(2),e.\u0275\u0275classProp("show-checkmark",!!t.scorecardSelectionMode)("show-on-hover-only","ctrl"===t.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","single"!==t.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.columnSettings)("ngForTrackBy",t.columnSettingId)}}function Q0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tbody",80),e.\u0275\u0275listener("showChildrenChange",function(O){e.\u0275\u0275restoreView(t);var A=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(A.onShowChildrenChange(O))})("dragStarted",function(O){e.\u0275\u0275restoreView(t);var A=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(A.onGoalDragStart(O))})("dragMoved",function(O){e.\u0275\u0275restoreView(t);var A=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(A.onGoalDragMove(O))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(),a=i.$implicit,l=i.index,c=e.\u0275\u0275nextContext(4).ngIf,p=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",c)("columnSettings",p.columnSettings)("goal",a)("color",p.colorPalette[l%p.colorPalette.length])("showChildren",e.\u0275\u0275pipeBind1(1,8,p.showChildren$))("goalDragInfo",p.goalDragInfo)("scorecardSelectionMode",p.scorecardSelectionMode)("forceColumnMinWidths",p.forceColumnMinWidths)}}function K0(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Q0,2,10,"tbody",79),e.\u0275\u0275elementContainerEnd()),2&o){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isHidden)}}function X0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"table",57,58),e.\u0275\u0275listener("cdkDropListDropped",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onDropGoal(l))})("cdkDropListSorted",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onGoalDropListSorted(l))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,$0,5,7,"thead",7),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,K0,2,1,"ng-container",59),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275styleProp("padding-left",i.scorecardTablePadding.left,"px")("padding-right",i.scorecardTablePadding.right,"px"),e.\u0275\u0275property("cdkDropListDisabled",!e.\u0275\u0275pipeBind1(2,8,i.canDragAndDrop$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(4,10,i.showHeaders$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(6,12,i.goals$))("ngForTrackBy",i.goalId)}}function Z0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"compact-scorecard",81),e.\u0275\u0275listener("onSortColumn",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(p.sortColumn(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(3).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",i)("isEditMode",a.isEditMode)("viewSettings",a.viewSettings)("sort",e.\u0275\u0275pipeBind1(1,4,a.sort$))}}function Y0(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,R0,5,4,"ng-container",7),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,L0,3,8,"scorecard-status-tiles",44),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,G0,8,11,"div",45),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,X0,7,14,"table",46),e.\u0275\u0275template(11,Z0,2,6,"compact-scorecard",47),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled&&!(e.\u0275\u0275pipeBind1(2,5,t.hideToolbar$)||e.\u0275\u0275pipeBind1(3,7,t.hideHeader$))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled&&e.\u0275\u0275pipeBind1(5,9,t.showStatus$)&&!(e.\u0275\u0275pipeBind1(6,11,t.hideCards$)||e.\u0275\u0275pipeBind1(7,13,t.hideHeader$))),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,15,t.filterRowVisible$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","List"===t.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Compact"===t.viewType)}}function J0(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-heatmap-toolbar",50),e.\u0275\u0275listener("filterBy",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onFilterKeywordChange(l))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("filterText",e.\u0275\u0275pipeBind1(1,1,i.filterBy$).keyword)}}function eh(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,J0,2,3,"scorecard-heatmap-toolbar",82),e.\u0275\u0275element(2,"heat-map",83),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled)}}function th(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"scorecard-list-toolbar",84),e.\u0275\u0275listener("filterBy",function(c){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.onFilterKeywordChange(c))})("onNewGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onNewGoalClick(!1))})("onNewSubGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onNewSubGoalClick())})("onLinkedMetricInit",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onLinkedMetricInit())}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"scorecard-board-view",85),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("isEditMode",a.isEditMode)("scorecardCapabilities",a.scorecardCapabilities)("numberOfSelectedGoals",e.\u0275\u0275pipeBind1(2,6,a.numberOfSelectedGoals$))("filterText",e.\u0275\u0275pipeBind1(3,8,a.filterBy$).keyword),e.\u0275\u0275advance(3),e.\u0275\u0275property("boardSettings",a.boardSettings)("metricsGoalStatuses",null==i.goalStatuses?null:i.goalStatuses.statuses)}}function nh(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",3),e.\u0275\u0275listener("on-resize",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.setVisibleColumns())}),e.\u0275\u0275template(2,S0,2,6,"scorecard-access-banner",4),e.\u0275\u0275template(3,k0,5,4,"div",5),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275template(6,V0,1,3,"scorecard-title",6),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,Y0,12,17,"ng-container",7),e.\u0275\u0275template(10,eh,3,1,"ng-container",7),e.\u0275\u0275template(11,th,5,10,"ng-container",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("overflow-x",null!=i.viewSettings&&i.viewSettings.dropColumns?"hidden":"auto"),e.\u0275\u0275classProp("heat-map-scroll","Heatmap"===i.viewType)("new-header",i.goalsNewHeaderEnabled)("compact","Compact"===i.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.showScorecardAccessBanner&&i.isEditMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.goalsNewHeaderEnabled&&(i.isEditMode||i.toolbarNewLook)&&!(e.\u0275\u0275pipeBind1(4,14,i.hideToolbar$)||e.\u0275\u0275pipeBind1(5,16,i.hideHeader$))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.goalsNewHeaderEnabled&&!(e.\u0275\u0275pipeBind1(7,18,i.hideTitle$)||e.\u0275\u0275pipeBind1(8,20,i.hideHeader$))&&"Compact"!==i.viewType),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf","List"===i.viewType||"Compact"===i.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Heatmap"===i.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Board"===i.viewType)}}function rh(o,n){if(1&o){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"empty-scorecard",86),e.\u0275\u0275listener("onNewGoal",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onNewGoalClick(!0))})("onLinkToGoal",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onLinkedMetricInit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&o){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("isMetricsPicker",e.\u0275\u0275pipeBind1(1,2,i.showPickerToolbar$))("canEdit",i.isEditMode&&e.\u0275\u0275pipeBind1(2,4,i.userHasEditPermissions$))}}function ih(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,nh,12,22,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,rh,3,6,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&o){var t=e.\u0275\u0275reference(4),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,i.hasGoals$))("ngIfElse",t)}}function oh(o,n){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"span",89),e.\u0275\u0275elementContainerEnd())}function ah(o,n){1&o&&e.\u0275\u0275element(0,"span",90)}function sh(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"div",87),e.\u0275\u0275template(1,oh,2,0,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,ah,1,0,"ng-template",null,88,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){var t=e.\u0275\u0275reference(4),i=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("border-top",i.toolbarNewLook),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null===e.\u0275\u0275pipeBind1(2,4,i.scorecard$))("ngIfElse",t)}}var rc=function(){function o(n,t,i,a,l,c,p,y,O,A,L,te,ue,Ae,Ne,Je){var ze=this;this.scorecardService=n,this.heatmapService=t,this.detailsPaneLauncher=i,this.hierarchyPane=a,this.changeDetectorRef=l,this.featureSwitchService=c,this.goalsTutorialService=p,this.hierarchyService=y,this.capabilityService=O,this.expansionService=A,this.scorecardElement=L,this.linkedMetricsLauncher=te,this.dialogService=ue,this.viewsService=Ae,this.scorecardSettings=Ne,this.scorecardHost=Je,this.colorPalette=ne.gT.ColorPalette,this.viewType="List",this.sort$=new ye.X((0,M.__assign)({},ne.Ij)),this.filterRowVisible$=new ye.X(!1),this.filterBy$=new ye.X({}),this.onDestroy$=new Gr.t(1),this.boardSettings={showGoalVisualGoalName:!0,showGoalVisualOwner:!0,showGoalVisualGrowth:!0,showGoalVisualScorecardName:!0,showVisualization:!0},this.goalDragInfo={},this.ScorecardColumnConfigs=ne.Ml,this.forceColumnMinWidths=!1,this.scorecardTablePadding=ne.gT.ScorecardTablePadding,this.sortColumn=function(ot){return ze.sort$.next(ot)},this.isExcelFile=!1}return o.prototype.goalId=function(n,t){return t.id},o.prototype.columnSettingId=function(n,t){return t.columnId},o.prototype.ngOnInit=function(){var t,i,a,l,c,p,y,O,A,L,te,ue,Ae,Ne,Je,ze,n=this;u.fF.assertValue(this.scorecardDetails$,"Scorecard details should be set at initialization time"),this.showImportButton=!!this.featureSwitchService.featureSwitches.goalsShowImportFromFileUI&&!!this.dialogService,this.showColumnSettingsMenu=!!this.featureSwitchService.featureSwitches.goalsColumnSettings,this.showHierarchies=!!this.featureSwitchService.featureSwitches.goalsHierarchies,this.toolbarNewLook=!!this.featureSwitchService.featureSwitches.goalsHierarchies,this.showScorecardAccessBanner=!!this.featureSwitchService.featureSwitches.goalsScorecardAccessBanner,this.bulkDeleteEnabled=!!this.featureSwitchService.featureSwitches.goalsBulkDelete,this.goalsNewHeaderEnabled=this.featureSwitchService.featureSwitches.goalsNewHeader,this.isTitleEditable=this.featureSwitchService.featureSwitches.goalsSkipScorecardCreationPane,this.collapseGoalsByDefault=!!this.featureSwitchService.featureSwitches.collapseGoalsByDefault,this.scorecard$=this.scorecardDetails$.pipe((0,G.x)(function(Y,Ie){return!Ie.reload&&_.isEqual(Y,Ie)}),(0,Rn.w)(function(Y){if(!Y)return(0,me.of)(void 0);if(!(Y.groupId&&Y.scorecardId||Y.prefetchedScorecard))return(0,me.of)(null);var Ie;if(Y.prefetchedScorecard)Ie=n.scorecardService.loadPrefetchedScorecard(Y.prefetchedScorecard);else{var Le=n.showHierarchies?function(o){if(!_.isEmpty(o)){for(var t=[],i=0,a=_.split(o,";");i<a.length;i++){var l=a[i];if(!l.includes(":"))return;var c=_.split(l,":"),p=c[0],O=_.map(_.split(c[1],","),function(A){return decodeURIComponent(A)});t.push({hierarchyId:p,levels:O})}return _.isEmpty(t)?void 0:t}}(Y.initialHierarchyPath):void 0;Ie=n.scorecardService.loadScorecard(Y.groupId,Y.scorecardId,!0,Le)}return Y.reload?Ie:Ie.pipe((0,Ct.g)(0),(0,pt.O)(void 0))}),(0,dr.d)(1)),(0,zn.aj)([this.scorecardDetails$,this.scorecard$]).pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){var Ie=Y[0],Le=Y[1];if(Ie&&Ie.onScorecardUpdated&&Le){var Mt=_.filter(Le.goals,function(nn){return!nn.isNew}),Wt=W.flattenGoals(Mt);Ie.onScorecardUpdated((0,M.__assign)((0,M.__assign)({},Le),{goals:Wt}))}}),(0,zn.aj)([this.scorecardDetails$,this.scorecard$]).pipe((0,G.x)(function(Y,Ie){var Le=Y[0],Mt=Y[1],Wt=Ie[0],nn=Ie[1];return Mt?.id===nn?.id&&Le?.initialSelectedGoalId===Wt?.initialSelectedGoalId})).pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){var Ie=Y[0],Le=Y[1];!_.isNil(Ie?.initialSelectedGoalId)&&!_.isNil(Le)&&n.detailsPaneLauncher.openGoalDetails(n.scorecardService,Ie?.initialSelectedGoalId,Qr.Default)}),(0,zn.aj)([this.scorecardDetails$,this.scorecardService.isLoading()]).pipe((0,We.R)(this.onDestroy$),(0,On.h)(function(Y){var Ie=Y[0];return!!Ie?.onLoading})).subscribe(function(Y){return Y[0].onLoading(Y[1])}),this.hasGoals$=this.scorecard$.pipe((0,dt.U)(function(Y){var Ie;return(null===(Ie=Y?.goals)||void 0===Ie?void 0:Ie.length)>0})),this.goals$=this.scorecard$.pipe((0,dt.U)(function(Y){return Y?.goals})),this.hasSavedGoals$=this.goals$.pipe((0,dt.U)(function(Y){var Ie;return(null===(Ie=Y?.filter(function(Le){return!Le?.isNew}))||void 0===Ie?void 0:Ie.length)>0})),null===(i=null===(t=this.scorecardSettings)||void 0===t?void 0:t.settings)||void 0===i||i.pipe().subscribe(function(Y){n.boardSettings=Y}),this.columnSettings$=this.scorecard$.pipe((0,G.x)(function(Y,Ie){return _.isEqual(Y?.columnSettings,Ie?.columnSettings)}),(0,dt.U)(function(Y){return Y?.columnSettings})),this.showStatus$=this.columnSettings$.pipe((0,dt.U)(function(Y){return ae.isColumnVisible(Y,2)})),this.userHasEditPermissions$=this.scorecard$.pipe((0,dt.U)(function(Y){return(0,gr.yE)(rt(Y?.permissions),2)}));var ot=this.scorecardDetails$.pipe((0,On.h)(function(Y){return!!Y?.settings$}),(0,Rn.w)(function(Y){return Y?.settings$}),(0,pt.O)(void 0));this.showHeaders$=(0,zn.aj)([this.scorecard$,ot]).pipe((0,dt.U)(function(Y){var Ie=Y[0],Le=Y[1];return!Le?.hideColumnHeaders&&_.some(Ie?.goals,function(Mt){return null==Mt.state||"Consumption"===Mt.state})}));var ft=this.scorecardService.isEditMode();ft.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){n.isEditMode=Y,n.changeDetectorRef.markForCheck()}),this.scorecardDetails$.pipe((0,Rn.w)(function(Y){var Ie;return null!==(Ie=Y?.isEditMode$)&&void 0!==Ie?Ie:(0,me.of)(!1)}),(0,We.R)(this.onDestroy$)).subscribe(function(Y){return n.scorecardService.setEditMode(Y)}),this.scorecardDetails$.pipe((0,On.h)(function(Y){return!!Y?.refresh$}),(0,Rn.w)(function(Y){return Y?.refresh$}),(0,Fl.M)(this.scorecard$.pipe((0,On.h)(function(Y){return!!Y}))),(0,We.R)(this.onDestroy$)).subscribe(function(Y){var Le=Y[1];"Heatmap"===n.scorecardService.viewType?n.heatmapService.refreshAll():n.heatmapService.clearCache(),n.hierarchyService.loadHierarchies(Le.groupId,Le.id,!1),n.scorecardService.loadScorecard(Le.groupId,Le.id,!1,Le.hierarchyPaths)}),this.scorecardDetails$.pipe((0,On.h)(function(Y){return!!Y?.bulkEditingClearSelection$}),(0,Rn.w)(function(Y){return Y?.bulkEditingClearSelection$}),(0,We.R)(this.onDestroy$)).subscribe(function(){return n.scorecardService.unselectAllGoals()}),this.scorecardDetails$.pipe((0,On.h)(function(Y){return!!Y?.bulkEditingDelete$}),(0,Rn.w)(function(Y){return Y?.bulkEditingDelete$}),(0,We.R)(this.onDestroy$)).subscribe(function(){return n.scorecardService.bulkDeleteGoalsPrompt()}),this.scorecardDetails$.pipe((0,On.h)(function(Y){return!!Y?.bulkEditingUpdate$}),(0,Rn.w)(function(Y){return Y?.bulkEditingUpdate$}),(0,We.R)(this.onDestroy$)).subscribe(function(){return n.openBulkUpdatePane()}),this.selectedGoalIds$=this.scorecardService.getSelectedGoalIdsObservable(),this.numberOfSelectedGoals$=this.selectedGoalIds$.pipe((0,dt.U)(function(Y){return _.isNil(Y)?0:Object.keys(Y).length})),this.numberOfSelectedGoals$.pipe((0,Fl.M)(this.scorecardDetails$),(0,G.x)(function(Y,Ie){return Y[0]===Ie[0]})).subscribe(function(Y){var Ie=Y[0],Le=Y[1];_.isFunction(Le?.onNumberOfSelectedGoalsChange)&&!_.isNil(Ie)&&Le.onNumberOfSelectedGoalsChange(Ie)});var xt=this.goals$.pipe((0,dt.U)(function(Y){return W.flattenGoals(Y)}));this.allGoalsSelected$=(0,zn.aj)([xt,this.selectedGoalIds$]).pipe((0,G.x)(function(Y,Ie){var nn=Ie[1];return Y[0].length===Ie[0].length&&Object.keys(Y[1]).length===Object.keys(nn).length}),(0,dt.U)(function(Y){var Le=Y[1];return _.filter(Y[0],function(Wt){return!Wt.isNew&&(!n.scorecardHost||n.scorecardHost.canSelectGoal(Wt).enabled)}).length===Object.keys(Le).length})),this.scorecard$.pipe((0,Mo.o)(function(Y){return _.isNil(Y)},!0)).subscribe(function(Y){var Ie;!_.isNil(Y)&&(_.isNil(Y?.goals)||0===(null===(Ie=Y?.goals)||void 0===Ie?void 0:Ie.length))&&n.scorecardService.userHasWritePermissions()&&n.onNewGoalClick(!0)});var Kt=this.scorecardService.isLoading(),kt=this.scorecardService.isEditing();this.showChildren$=this.expansionService.expansionMap$,this.showAllChildren$=this.expansionService.showAllExpanded$,this.hasExpandableGoals$=this.expansionService.hasExpandableGoals$;var Rt=this.capabilityService.getScorecardCapabilities();Rt.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){n.scorecardCapabilities=Y,n.changeDetectorRef.markForCheck()}),this.canDragAndDrop$=(0,zn.aj)([ft,this.filterBy$,this.sort$,Kt,kt,this.numberOfSelectedGoals$,Rt]).pipe((0,dt.U)(function(Y){var Ie,Le=(Ie=Y)[0],Mt=Ie[1],Wt=Ie[2],nn=Ie[3],yo=Ie[4],Fi=Ie[5];return Ie[6].reorderGoal&&Le&&_.isEmpty(Mt.keyword)&&_.isEmpty(Mt.statuses)&&"Rank"===Wt.sortBy&&!nn&&!yo&&Fi<=1})),this.scorecardDetails$.pipe((0,Rn.w)(function(Y){return Y.filterBy$})).pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){n.filterBy$.next(Y)}),(0,zn.aj)([this.scorecardDetails$,this.filterBy$]).pipe((0,G.x)(function(Y,Ie){var Le=Y[1],Mt=Ie[1];return _.isEqual(Le?.keyword,Mt?.keyword)&&_.isEqual(Le?.statuses,Mt?.statuses)})).pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){var Ie=Y[0],Le=Y[1];_.isFunction(Ie?.onFiltersUpdated)&&!_.isNil(Le)&&Ie.onFiltersUpdated(Le)}),(0,zn.aj)([this.sort$,this.filterBy$,this.filterRowVisible$,this.columnSettings$,this.scorecardService.viewType$]).pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){var Ie=Y[0],Le=Y[1],Mt=Y[2],Wt=Y[3],nn=Y[4];Le.matchStatus=ae.isColumnVisible(Wt,2),Le.matchOwner=ae.isColumnVisible(Wt,1),"Heatmap"===nn?n.scorecardService.applySortAndFilter((0,M.__assign)({},ne.Ij),n.goalsNewHeaderEnabled?{keyword:Le?.keyword}:{}):("List"===nn||"Compact"===nn)&&n.scorecardService.applySortAndFilter(Ie,n.goalsNewHeaderEnabled||Mt?Le:{statuses:Le?.statuses})}),this.goalOwners$=this.goals$.pipe((0,dt.U)(W.getGoalOwners)),this.scorecard$.pipe((0,On.h)(function(Y){return!!Y}),(0,G.x)(function(Y,Ie){return Y.id===Ie.id}),(0,We.R)(this.onDestroy$)).subscribe(function(Y){n.hierarchyService.loadHierarchies(Y.groupId,Y.id)}),this.scorecardService.getActiveGoalId().pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){_.isNil(Y)?n.detailsPaneLauncher.closeGoalDetails():(n.detailsPaneLauncher.openGoalDetails(n.scorecardService,Y,Qr.Default),n.showChildrenForSelectedMetrics(Y))}),this.goalStatusesByScorecardId$=this.scorecardService.goalStatusesByScorecardId$,this.hasHierarchies$=this.hierarchyService.hasHierarchies$,this.displayMode$=null===(l=null===(a=this.scorecardSettings)||void 0===a?void 0:a.settings)||void 0===l?void 0:l.pipe((0,dt.U)(function(Y){return Y?.displayMode})),this.hideHeader$=null===(p=null===(c=this.scorecardSettings)||void 0===c?void 0:c.settings)||void 0===p?void 0:p.pipe((0,dt.U)(function(Y){return Y?.hideScorecardHeader})),this.hideTitle$=null===(O=null===(y=this.scorecardSettings)||void 0===y?void 0:y.settings)||void 0===O?void 0:O.pipe((0,dt.U)(function(Y){return Y?.hideScorecardTitle})),this.hideToolbar$=null===(L=null===(A=this.scorecardSettings)||void 0===A?void 0:A.settings)||void 0===L?void 0:L.pipe((0,dt.U)(function(Y){return Y?.hideScorecardToolbar})),this.hideCards$=null===(ue=null===(te=this.scorecardSettings)||void 0===te?void 0:te.settings)||void 0===ue?void 0:ue.pipe((0,dt.U)(function(Y){return Y?.hideGoalCards})),this.showPickerToolbar$=null===(Ne=null===(Ae=this.scorecardSettings)||void 0===Ae?void 0:Ae.settings)||void 0===Ne?void 0:Ne.pipe((0,dt.U)(function(Y){return Y?.showPickerToolbar})),this.scorecardService.scorecardSelectionMode$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){return n.scorecardSelectionMode=Y}),this.scorecardService.viewType$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){return n.viewType=Y}),null===(ze=null===(Je=this.scorecardSettings)||void 0===Je?void 0:Je.settings)||void 0===ze||ze.pipe((0,Me.q)(1)).subscribe(function(Y){var Ie,Le=null===(Ie=_.first(Y.filters))||void 0===Ie?void 0:Ie.goalId;Le&&Y.isEditingGoal&&n.scorecardService.setGoalState(Le,"Editing")}),this.columnSettings$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){return n.columnSettings=Y}),this.scorecard$.pipe((0,We.R)(this.onDestroy$)).subscribe(function(Y){return n.visualScorecard=Y}),this.featureSwitchService.featureSwitches.scorecardListViewSettings&&this.viewsService&&(this.viewsService.loadViews(!1),this.viewsService.getDefaultView("List").pipe((0,We.R)(this.onDestroy$)).subscribe(function(){n.viewSettings=n.viewsService.defaultListView?n.viewsService.defaultListView.listViewDetails:ne.lb,n.setVisibleColumns()}))},o.prototype.ngOnDestroy=function(){this.detailsPaneLauncher.closeGoalDetails(),this.onDestroy$.next(!0),this.onDestroy$.complete()},o.prototype.showChildrenForSelectedMetrics=function(n){var t=this.scorecardService.getCurrentScorecard(),i=W.getGoal(t?.goals,n);for(n=i.parentId;n&&null!=(i=W.getGoal(t?.goals,n));)this.expansionService.expandGoal(n),n=i.parentId},o.prototype.onShowChildrenChange=function(n){n.value?this.expansionService.expandGoal(n.id):this.expansionService.collapseGoal(n.id)},o.prototype.onToggleExpandAllMetrics=function(){this.expansionService.toggleExpandAll()},o.prototype.onNewGoalClick=function(n){this.scorecardService.setViewType("List"),this.scorecardService.addGoal(),n&&this.goalsTutorialService.startFirstGoalTutorial()},o.prototype.openHierarchiesBuilder=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(n){switch(n.label){case 0:return[4,this.hierarchyPane.openHierarchiesBuilder("HeatmapHeader")];case 1:return n.sent(),[2]}})})},o.prototype.openHeatmapConfigurationPane=function(){this.hierarchyPane.showHeatmapConfigurationPane()},o.prototype.onScorecardViewClick=function(){this.scorecardService.setViewType("List")},o.prototype.onHeatmapViewClick=function(){this.scorecardService.setViewType("Heatmap")},o.prototype.onSelectAllGoals=function(){this.scorecardService.toggleSelectAllGoals()},o.prototype.openBulkUpdatePane=function(){var n=this;this.detailsPaneLauncher.openBulkEditingPane(this.scorecardService,function(t){return n.scorecardService.bulkUpdateGoals(t)})},o.prototype.onNewSubGoalClick=function(){if(1===this.scorecardService.numberOfSelectedGoals()){var n=this.scorecardService.getFirstSelectedGoalId();this.expansionService.expandGoal(n),this.scorecardService.addSubGoal(n)}},o.prototype.onImportClick=function(n){var t=this,i=n.target;if(this.isExcelFile=!!i.files[0].name.match(/(.xls|.xlsx)/),this.isExcelFile){var a=new FileReader;a.onload=function(l){var p=a.result.toString().replace(/^data:(.*,)?/,"");p.length%4>0&&(p+="=".repeat(4-p.length%4)),t.inputFile.nativeElement.value="",t.dialogService.open(_0,{width:"70%",height:"80%",data:{fileData:p,scorecard:t.visualScorecard}}).afterClosed().pipe((0,Fl.M)(t.scorecard$)).subscribe(function(O){var L=O[1];t.scorecardService.loadScorecard(L.groupId,L.id)})},a.readAsDataURL(i.files[0])}},o.prototype.updateSorting=function(n,t){var i=K.toggleSort(n,t);this.sort$.next(i)},o.prototype.toggleFilterRow=function(){var n=!this.filterRowVisible$.value;this.filterRowVisible$.next(n),n||this.onFilterKeywordChange("")},o.prototype.onFilterKeywordChange=function(n){var t=(0,M.__assign)((0,M.__assign)({},this.filterBy$.value),{keyword:n});this.filterBy$.next(t)},o.prototype.onGoalsStatusTileSelectionChange=function(n){var t,i={keyword:null===(t=this.filterBy$.value)||void 0===t?void 0:t.keyword,statuses:n};this.filterBy$.next(i)},o.prototype.onGoalDragStart=function(n){var t=n.source.data.goal,i=n.source.data.level,a=n.source.dropContainer.getSortedItems(),l=a.findIndex(function(c){return c.data.goal.id===t.id});u.fF.assertValue(-1!==l,"Goal should exist in the drop list"),this.goalDragInfo=(0,bt.ZP)(this.goalDragInfo,function(c){return c.sourceGoalId=t.id,c.rankOrderedPrevGoal=l>0?a[l-1].data:void 0,c.rankOrderedNextGoal=l<a.length-1?a[l+1].data:void 0,c.destParentGoalId=t.parentId,c.destGoalDropLevel=i,c}),this.changeDetectorRef.detectChanges()},o.prototype.onGoalDragMove=function(n){var t,i,a,l;if(this.goalDragInfo.rankOrderedPrevGoal||this.goalDragInfo.rankOrderedNextGoal){if(!this.goalDragInfo.rankOrderedPrevGoal)return void(this.goalDragInfo=(0,bt.ZP)(this.goalDragInfo,function(Le){return Le.destParentGoalId=void 0,Le.destGoalDropLevel=0,Le}));var y,O,c=this.goalDragInfo.rankOrderedPrevGoal,p=c.level<ne.gT.MaxSubGoals;if(this.featureSwitchService.featureSwitches.goalsXAxisDragAndDrop){var L=n.source.getPlaceholderElement(),Kt=Array.from(L.querySelectorAll(".cell-indent")).map(function(Wt){return Wt.getBoundingClientRect().right});for(O=0;O<Kt.length&&Kt[O]<=n.pointerPosition.x;)O++;var Je=null!==(l=null===(a=this.goalDragInfo.rankOrderedNextGoal)||void 0===a?void 0:a.level)&&void 0!==l?l:0,kt=c.level+(p?1:0);O=_.clamp(O,Je,kt),y=kt}else{var te=(L=n.source.getPlaceholderElement()).getBoundingClientRect(),Ae=20+te.height,Ne=_.clamp(n.pointerPosition.y-(te.top-10),0,Ae-1),ze=(Je=null!==(i=null===(t=this.goalDragInfo.rankOrderedNextGoal)||void 0===t?void 0:t.level)&&void 0!==i?i:0,c.level-Je+1);p&&ze++;var ft=Math.floor(Ne/(Ae/ze));O=(y=c.level+(p?1:0))-ft}var Y=this.scorecardService.getCurrentScorecard(),Ie=c.goal;for(p||(Ie=Ie.parentId?W.getGoal(Y.goals,Ie.parentId):void 0);y>O;)Ie=Ie.parentId?W.getGoal(Y.goals,Ie.parentId):void 0,y--;this.goalDragInfo=(0,bt.ZP)(this.goalDragInfo,function(Le){return Le.destParentGoalId=Ie?.id,Le.destGoalDropLevel=O,Le})}},o.prototype.setVisibleColumns=function(){var n,t,i;if(this.columnSettings=this.visualScorecard.columnSettings,null!==(n=this.viewSettings)&&void 0!==n&&n.dropColumns){var a=(null===(t=this.scorecardElement)||void 0===t?void 0:t.nativeElement.offsetWidth)||0;((null===(i=this.columnTableElement)||void 0===i?void 0:i.nativeElement.offsetWidth)||0)>a&&(!1===this.forceColumnMinWidths&&(this.cutoffWidth=a),this.forceColumnMinWidths=!0);for(var c=ne.gT.ScorecardTablePadding.left+ne.gT.ScorecardTablePadding.right,p=0;p<this.visualScorecard.columnSettings.length;p++)if(this.visualScorecard.columnSettings[p].show&&(c+=ne.gT.ListViewCellMinWidths[this.visualScorecard.columnSettings[p].columnId]||0)>a){this.columnSettings=this.visualScorecard.columnSettings.slice(0,p||1);break}a>this.cutoffWidth&&(this.forceColumnMinWidths=!1)}else this.forceColumnMinWidths=!1;this.changeDetectorRef.markForCheck()},o.prototype.onGoalDropListSorted=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a;return(0,M.__generator)(this,function(l){return u.fF.assertValue((t=n.item.data.goal.id)===this.goalDragInfo.sourceGoalId,"Dragged goal does not match."),i=n.container.getSortedItems(),a=i.map(function(c){return c.data}).filter(function(c){return c.goal.id!==t}),this.goalDragInfo=(0,bt.ZP)(this.goalDragInfo,function(c){return c.rankOrderedNextGoal=n.currentIndex<a.length?a[n.currentIndex]:void 0,c.rankOrderedPrevGoal=n.currentIndex-1>=0?a[n.currentIndex-1]:void 0,c}),[2]})})},o.prototype.onDropGoal=function(n){return(0,M.__awaiter)(this,void 0,void 0,function(){var t,i,a;return(0,M.__generator)(this,function(l){switch(l.label){case 0:return u.fF.assertValue((t=n.item.data.goal).id===this.goalDragInfo.sourceGoalId,"Dragged goal does not match."),this.goalDragInfo.rankOrderedNextGoal&&(a=this.goalDragInfo.rankOrderedNextGoal.goal,(this.goalDragInfo.destParentGoalId&&a.parentId===this.goalDragInfo.destParentGoalId||!a.parentId&&!this.goalDragInfo.destParentGoalId)&&(i=this.goalDragInfo.rankOrderedNextGoal.goal)),[4,this.scorecardService.moveGoal(t.id,i?.id,this.goalDragInfo.destParentGoalId)];case 1:return l.sent(),this.goalDragInfo=(0,bt.ZP)(this.goalDragInfo,function(){return{}}),[2]}})})},o.prototype.onLinkedMetricInit=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var n,t,a=this;return(0,M.__generator)(this,function(l){return this.linkedMetricsLauncher&&(n=_.map(W.flattenGoals(this.scorecardService.getCurrentScorecard().goals),"id"),t=this.scorecardDetails$.pipe((0,Rn.w)(function(c){var p;return null!==(p=c?.reportId$)&&void 0!==p?p:a.scorecard$.pipe((0,dt.U)(function(y){return y.reportId}))}),(0,G.x)()),this.linkedMetricsLauncher.launchLinkedMetrics(n,t).pipe((0,Me.q)(1)).subscribe(function(c){c?.length>=1&&a.scorecardService.createLinkedGoals(c)})),[2]})})},o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(gt),e.\u0275\u0275directiveInject(Pl),e.\u0275\u0275directiveInject(yr),e.\u0275\u0275directiveInject(pl),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Ln.vZ),e.\u0275\u0275directiveInject(Al),e.\u0275\u0275directiveInject(Jn),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Or),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(C0,8),e.\u0275\u0275directiveInject(hn.x),e.\u0275\u0275directiveInject(ql),e.\u0275\u0275directiveInject(on,8),e.\u0275\u0275directiveInject(en,8))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["scorecard"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(y0,5),e.\u0275\u0275viewQuery(b0,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.inputFile=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(i.columnTableElement=a.first)}},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noScorecard",""],["noGoals",""],[1,"scorecard",3,"on-resize"],[3,"scorecard","users","labels",4,"ngIf"],["class","toolbar",3,"new-look",4,"ngIf"],[3,"scorecardName","scorecardDescription","isTitleEditable",4,"ngIf"],[4,"ngIf"],[3,"scorecard","users","labels"],[1,"toolbar"],[1,"toolbar-btns"],[1,"spacer"],[1,"add-goal-btn","pbi-fluent-button",3,"disabled","click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-small"],["localize","NewMetric"],[1,"add-subgoal-btn","pbi-fluent-button",3,"disabled","click"],["localize","AddSubmetric"],["class","label pbi-fluent-button primary",4,"ngIf"],[1,"label","pbi-fluent-button","primary"],["type","file",3,"change"],["inputFile",""],["localize","Import"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true","class","view-mode-picker-btn pbi-fluent-button",3,"matMenuTriggerFor","ngClass",4,"ngIf"],[1,"view-mode-picker-menu",3,"overlapTrigger"],["viewSwitcherMenu","matMenu"],["mat-menu-item","",1,"pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-list",1,"glyphicon","glyph-small"],["localize","Scorecard","localizeTooltip","Scorecard"],["fontIcon","pbi-glyph-table",1,"glyphicon","glyph-small"],["localize","MetricsHeatmap","localizeTooltip","MetricsHeatmap"],["class","customize-heatmap-btn pbi-fluent-button",3,"click",4,"ngIf"],["class","hierarchies-btn pbi-fluent-button",3,"click",4,"ngIf"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true",1,"view-mode-picker-btn","pbi-fluent-button",3,"matMenuTriggerFor","ngClass"],["viewSwitcherMenuTrigger","matMenuTrigger"],[1,"glyph-small",3,"fontIcon"],[3,"localize","localizeTooltip"],["fontIcon","pbi-glyph-chevrondownsmall","localizeTooltip","View_Options",1,"glyph-mini","chevron-down"],[1,"customize-heatmap-btn","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-barchartverticaledit",1,"glyphicon","glyph-small"],["localize","MetricsCustomizeHeatmap"],[1,"hierarchies-btn","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-inline-drill-nocircle",1,"glyphicon","glyph-small"],["localize","MetricsManageHierarchies"],[3,"scorecardName","scorecardDescription","isTitleEditable"],[3,"goals","goalStatusesByScorecardId","goalStatusList","selectedStatuses","onStatusSelected",4,"ngIf"],["class","filter-row",3,"toolbar-visible",4,"ngIf"],["class","scorecard-table","cdkDropList","",3,"padding-left","padding-right","cdkDropListDisabled","cdkDropListDropped","cdkDropListSorted",4,"ngIf"],[3,"scorecard","isEditMode","viewSettings","sort","onSortColumn",4,"ngIf"],[3,"filterText","filterBy",4,"ngIf","ngIfElse"],["listToolbar",""],[3,"filterText","filterBy"],[3,"isEditMode","scorecard","scorecardCapabilities","numberOfSelectedGoals","filterText","showTitle","filterBy","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"goals","goalStatusesByScorecardId","goalStatusList","selectedStatuses","onStatusSelected"],[1,"filter-row"],["fontIcon","pbi-glyph-filter",1,"filter-icon","glyphicon","glyph-small"],[3,"ngModel","ngModelChange"],["fontIcon","pbi-glyph-close",1,"close-icon","glyphicon","glyph-small",3,"click"],["cdkDropList","",1,"scorecard-table",3,"cdkDropListDisabled","cdkDropListDropped","cdkDropListSorted"],["columnTable",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"scorecard-header"],["colspan","1",1,"checkmark-th"],["class","select-checkmark",3,"box-checked",4,"ngIf"],[1,"select-checkmark"],[3,"checked","pbiTooltip","onChange"],["colspan","5",4,"ngIf","ngIfElse"],["columnHeader",""],["colspan","5"],[1,"filter-btn-and-name"],["class","collapse-btn",3,"pbiTooltip","click",4,"ngIf"],["class","filter-btn",3,"pbiTooltip","click",4,"ngIf"],[1,"name-col","sort-col"],[3,"column","index","sort","isEditMode","onSortColumn"],[1,"collapse-btn",3,"pbiTooltip","click"],[1,"glyphicon","glyph-mini",3,"fontIcon"],[1,"filter-btn",3,"pbiTooltip","click"],["fontIcon","pbi-glyph-filter",1,"glyphicon","glyph-small"],["colspan","1","class","sort-col",4,"ngIf"],["colspan","1",1,"sort-col"],["goal-group","",3,"scorecard","columnSettings","goal","color","showChildren","goalDragInfo","scorecardSelectionMode","forceColumnMinWidths","showChildrenChange","dragStarted","dragMoved",4,"ngIf"],["goal-group","",3,"scorecard","columnSettings","goal","color","showChildren","goalDragInfo","scorecardSelectionMode","forceColumnMinWidths","showChildrenChange","dragStarted","dragMoved"],[3,"scorecard","isEditMode","viewSettings","sort","onSortColumn"],[3,"filterText","filterBy",4,"ngIf"],[1,"heat-map"],[3,"isEditMode","scorecardCapabilities","numberOfSelectedGoals","filterText","filterBy","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"boardSettings","metricsGoalStatuses"],[3,"isMetricsPicker","canEdit","onNewGoal","onLinkToGoal"],[1,"no-goals","center-text"],["loading",""],["localize","Scorecard_DoesNotExist"],["localize","Scorecard_Loading"]],template:function(t,i){if(1&t&&(e.\u0275\u0275template(0,ih,5,4,"ng-container",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275template(2,sh,5,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,2,i.scorecard$))("ngIfElse",a)}},dependencies:[F.NgClass,F.NgForOf,F.NgIf,ee.Wj,Hr.O,it.Fj,it.JJ,it.On,Sn.X,Kr.r,vn.Hw,Jt.W0,Jt.tN,Jt.D8,Ml.v,oe.V,Ot,Hl,Kl,Xl,Zl,fl,v,Xr,ec,tc,nc,Jl,Dl,F.AsyncPipe,Bt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;height:100%}[_nghost-%COMP%]    {color:var(--scorecard-neutralPrimaryColor)}[_nghost-%COMP%]   .scorecard[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;flex:1}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]{padding:20px 50px 0;width:100%;box-sizing:border-box}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]{padding:0 30px 4px;background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--gray-50, #D2D0CE);display:flex;flex-direction:column}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%]{border:none}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%]:disabled{background:transparent}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]{display:inline-flex;width:100%}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-flex;align-items:center}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   span[_ngcontent-%COMP%]{color:var(--gray-90, #A19F9D)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .customize-heatmap-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;color:var(--fluent-theme-black-color, #000)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0 8px}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-subgoal-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .customize-heatmap-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]{margin-right:8px;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}[_nghost-%COMP%]   pbi-dropdown-trigger[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]{color:var(--scorecard-tableHeaderForegroundColor);background-color:rgba(0,0,0,.05);border-radius:4px;margin:10px 30px 0}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:var(--scorecard-tableHeaderForegroundColor)}[_nghost-%COMP%]   .filter-row.toolbar-visible[_ngcontent-%COMP%]{margin-top:20px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;height:45px;outline:none}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{font-size:20px;margin-top:4px;margin-right:12px;padding-left:15px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;font-size:16px;margin-top:8px;margin-right:10px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:none;flex:1;font-size:var(--md-font-size, 14px);outline:none;padding-left:0}[_nghost-%COMP%]   .scorecard-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0px 10px;empty-cells:hide;padding-top:0;padding-bottom:0;color:var(--scorecard-tableRowForegroundColor)}[_nghost-%COMP%]   .scorecard-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1;background:var(--scorecard-tableBackgroundColor);height:40px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]{text-align:left}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableHeaderForegroundColor);font-weight:500}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.dueDate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .sort-col[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .collapse-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;margin-left:6px;min-width:48px;width:48px;background-color:transparent;border:none;padding:2px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .collapse-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:unset}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{background-color:transparent;border:none;font-size:20px;padding:0 12px;color:inherit}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;height:unset}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:focus:hover{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn.active[_ngcontent-%COMP%], [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:active:focus:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}[_nghost-%COMP%]   .add-goal-btn-box[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .add-goal-btn-box[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);color:var(--gray-180, #252423);padding:6px 18px;box-sizing:border-box;border-radius:2px;height:32px;display:inline-block;cursor:pointer;background-color:var(--fluent-theme-primary-color, #F2C811)}[_nghost-%COMP%]   .center-text[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);text-align:center}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{overflow:hidden;padding:0 20px}@media screen and (min-width: 1024px){[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{padding:0 26px}}@media screen and (min-width: 1366px){[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{padding:0 60px}}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]   compact-scorecard[_ngcontent-%COMP%]{overflow:hidden}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]   scorecard-list-toolbar[_ngcontent-%COMP%]{--toolbar-padding: 12px 0 12px 0}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]     .scorecard-status-tiles{padding:0}label.label[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:-100%}.label[_ngcontent-%COMP%]{cursor:pointer;padding:5px 15px;display:inline-block}.no-goals[_ngcontent-%COMP%], empty-scorecard[_ngcontent-%COMP%]{color:var(--scorecard-tableHeaderForegroundColor);padding:20px;flex:1}.no-goals.border-top[_ngcontent-%COMP%], empty-scorecard.border-top[_ngcontent-%COMP%]{border-top:1px solid var(--gray-50, #D2D0CE)}.heat-map-scroll[_ngcontent-%COMP%]{overflow:hidden}.heat-map[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}  .view-mode-picker-menu mat-icon{display:flex;align-items:center}  .view-mode-picker-menu .mat-icon{overflow:visible}  .view-mode-picker-menu .mat-icon.glyph-small{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}  .view-mode-picker-menu .mat-icon.glyph-mini{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}  .view-mode-picker-menu .mat-icon.mat-ligature-font[fontIcon]{overflow:auto}.new-header   scorecard[_nghost-%COMP%], scorecard   [_nghost-%COMP%]{display:block}  .hierarchy-slicer-menu .mat-menu-content{padding:0!important}"],changeDetection:0}),o}();function lh(o,n){if(1&o&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"path",4)),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("d",t.path)("stroke",t.settings.lineColor)("stroke-width",t.settings.lineWidth)}}function ch(o,n){if(1&o&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"circle")),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("cx",t.min.x)("cy",t.min.y)("r",t.settings.dotRadius)("fill",t.settings.dotFillColor)("stroke",t.settings.dotColor)("stroke-width",t.settings.dotStrokeWidth)}}function uh(o,n){if(1&o&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"circle")),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("cx",t.max.x)("cy",t.max.y)("r",t.settings.dotRadius)("fill",t.settings.dotFillColor)("stroke",t.settings.dotColor)("stroke-width",t.settings.dotStrokeWidth)}}function dh(o,n){if(1&o&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275elementStart(0,"div",5)(1,"table")(2,"tr")(3,"th",6),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th",7),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"formatValue"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"tr")(10,"th",6),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"th",7),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"formatValue"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"tr")(17,"th",6),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th",7),e.\u0275\u0275text(21),e.\u0275\u0275elementEnd()()()()),2&o){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,6,"High")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(8,8,t.tooltip.high,t.formatString)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,11,"Low")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(15,13,t.tooltip.low,t.formatString)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(19,16,"Cycle")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.tooltip.cycle)}}var ph=function(){function o(n){this.localizationService=n,this.DefaultOptions={height:48,width:120,lineColor:"#5BD667",lineWidth:2,dotRadius:2,dotStrokeWidth:1,dotFillColor:"#161514",dotColor:"#5BD667",showMax:!0,showMin:!0,tension:.5},this.settings=Object.assign({},this.DefaultOptions)}return Object.defineProperty(o.prototype,"values",{set:function(t){this.sparklinePoints=t?.filter(function(i){return null!=i.value&&null!=i.timestamp}),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"options",{set:function(t){this.settings=Object.assign({},this.DefaultOptions,t),this.sparklinePoints&&this.update()},enumerable:!1,configurable:!0}),o.prototype.ngOnChanges=function(n){n.cycle&&(this.tooltip=Object.assign({},this.tooltip,{cycle:this.getCycleText()})),n.formatString&&this.update()},o.prototype.update=function(){var n;this.viewBox="0 0 ".concat(this.settings.width," ").concat(this.settings.height),(null===(n=this.sparklinePoints)||void 0===n?void 0:n.length)>=2?(this.points=o.calculatePoints(this.sparklinePoints,this.settings),this.path=o.calculatePath(this.points,this.settings),this.min=this.points.reduce(function(t,i){return t?.y<i.y?t:i}),this.max=this.points.reduce(function(t,i){return t?.y>i.y?t:i}),this.tooltip=this.getTooltipData(this.sparklinePoints)):(this.points=null,this.path=null,this.min=null,this.max=null)},o.calculatePoints=function(n,t){var i=n.map(function(Ne){return{value:Ne.value,timestamp:new Date(Ne.timestamp)}}),a=_.map(i,function(Ne){return Ne.value}),l=_.min(a),c=_.max(a),p=_.map(i,function(Ne){return Ne.timestamp.getTime()}),y=_.min(p),O=_.max(p),A=this.calculateSafeRange(c,l),L=this.calculateSafeRange(O,y),te=t.dotRadius+t.dotStrokeWidth+this.PaddingOnEdges,ue=t.width-2*te,Ae=t.height-2*te;return i.map(function(Ne){return{x:(Ne.timestamp.getTime()-y)/L*ue+te,y:(1-(Ne.value-l)/A)*Ae+te}})},o.calculatePath=function(n,t){for(var i="M ".concat(n[0].x,", ").concat(n[0].y),a=[],l=0;l<n.length;l++)if(0===l||l===n.length-1)a.push({x:0,y:0});else{var c=this.calculateDerivative(n[l-1],n[l+1]),p=Math.sqrt(1+c*c);a.push({x:1/p,y:c/p})}for(l=0;l<n.length-1;l++){var y=n[l],O=n[l+1],A=Math.abs(O.x-y.x),L=Math.abs(O.y-y.y),te=Math.min(A,L)*t.tension,Ae=y.y+te*a[l].y,Ne=O.x-te*a[l+1].x,Je=O.y-te*a[l+1].y,ze="C ".concat(y.x+te*a[l].x,", ").concat(Ae," ").concat(Ne,", ").concat(Je," ").concat(O.x,", ").concat(O.y);i+=" ".concat(ze)}return i},o.calculateDerivative=function(n,t){return t.x===n.x?0:(t.y-n.y)/(t.x-n.x)},o.calculateSafeRange=function(n,t){var i=n-t;return 0===i?1:i},o.prototype.getTooltipData=function(n){var t=_.map(n,function(l){return l.value}),i=_.min(t);return{high:_.max(t),low:i,cycle:this.getCycleText()}},o.prototype.getCycleText=function(){switch(this.cycle){case 1:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Daily");case 2:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Weekly");case 3:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Monthly");case 4:return this.localizationService.get("MetricsDetailsPane_TimePeriodTab_RadioButton_Quarterly");case 5:return this.localizationService.get("MetricsDetailsPane_TimePeriodTab_RadioButton_Yearly");default:return"-"}},o.PaddingOnEdges=1.5,o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(Vt.o))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["sparkline"]],inputs:{values:"values",options:"options",formatString:"formatString",cycle:"cycle"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:11,consts:[["role","img",3,"aria-label","pbiTooltip","pbiTooltipDisabled"],["fill","transparent",4,"ngIf"],[4,"ngIf"],["tooltipTmpl",""],["fill","transparent"],[1,"sparkline-tooltip"],[1,"text"],[1,"value"]],template:function(t,i){if(1&t&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275template(2,lh,1,3,"path",1),e.\u0275\u0275template(3,ch,1,6,"circle",2),e.\u0275\u0275template(4,uh,1,6,"circle",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,dh,22,18,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(6);e.\u0275\u0275property("aria-label",e.\u0275\u0275pipeBind1(1,9,"Metrics_Sparkline_AltText"))("pbiTooltip",a)("pbiTooltipDisabled",!i.tooltip),e.\u0275\u0275attribute("width",i.settings.width)("height",i.settings.height)("viewBox",i.viewBox),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.path),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.settings.showMin&&i.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.settings.showMax&&i.max)}},dependencies:[F.NgIf,oe.V,Bt.F,xr.c],styles:['[_nghost-%COMP%]   .sparkline[_ngcontent-%COMP%]{height:100%;width:100%}  .sparkline-tooltip{padding:5px 15px}  .sparkline-tooltip .text{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);text-align:right;padding-right:8px}  .sparkline-tooltip .value{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);text-align:left}'],changeDetection:0}),o}(),hh=function(){function o(){this.mappings=[{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:Math.pow(10,3)}]}return o.prototype.transform=function(n,t){if(void 0===t&&(t=2),null==n||isNaN(n))return"\u2014";if(0===n)return"0";(null==t||t<0||isNaN(t))&&(t=2);for(var i=Math.pow(10,t),a=n<0?"-":"",l="",c=n=Math.abs(n),p=0,y=this.mappings;p<y.length;p++){var O=y[p],A=_.round(n*i/O.value)/i;if(A>=1){c=A,l=O.key;break}}return"".concat(a).concat(c).concat(l)},o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.\u0275\u0275definePipe({name:"shortNumber",type:o,pure:!0}),o}(),gh=m(52910),fh=m(50932),mh=m(32208),vh=m(82156),_h=m(79061),Ch=m(75266),yh=m(42729),bh=m(52040),wh=m(47913),Sh=m(6015),Mh=m(94770),Ph=m(23612),Oh=m(93367),Eh=m(45411),Th=(m(5209),m(52601),m(25834)),xh=m.n(Th),Ih=m(59215),Dh=m.n(Ih),kh=m(51269),Vh=m.n(kh),Fh=m(53581),Ah=m.n(Fh),Rh=m(76902),Lh=m.n(Rh),Gh=m(9382),Nh=m.n(Gh),Hh=m(87491),ml=m.n(Hh),ua={};ua.styleTagTransform=Nh(),ua.setAttributes=Ah(),ua.insert=Vh().bind(null,"head"),ua.domAPI=Dh(),ua.insertStyleElement=Lh(),xh()(ml(),ua),ml()&&ml().locals&&ml(),m(45690);var ic="appBarSprite",zh={name:ic,sprite:window[ic]},Bh=m(59951),Uh=m(16748),qh=m(16095),Wh=m(6342),jh=m(76777),$h=m(44913),Qh=m(33161),Kh=m(17177),Xh=m(54485),Zh=[{componentId:Ol.componentId,type:Ol},{componentId:El.componentId,type:El},{componentId:Tl.componentId,type:Tl},{componentId:t0.a.componentId,type:rc},{componentId:Ue.H.componentId,type:Yl},{componentId:nr.i.componentId,type:Ul},{componentId:hi.componentId,type:hi},{componentId:dl.componentId,type:dl}],Jh=((0,M.__spreadArray)((0,M.__spreadArray)([],[Fe,Ot,un,Nr,dl,Hl,no,zl,Nl,Ru,Ul,la,ca,Sl,Rl,Kl,jl,Ol,El,Tl,Xl,Zl,hi,rc,Yl,Ti,ph,zr,Ll,sa,xl,fl,xe],!0),[v,qn,Gl,Qi,xo,ri,Yi,ai,ro,li,Xr,gl,ec,tc,nc,fl,Jl,Dl,Il,hh,Qe,Bl,Tr],!1),function(){function o(n){n.registerIcons(zh.sprite)}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275inject(Xh.u))},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({providers:[yr,tn,Vl],imports:[F.CommonModule,ge.nZ,yh.c,gh.O,ee._t,mh.J,fh.F,it.u5,vh.N.withManifests(Zh),_h.v,Ch.G,kl.vV,Ei.t,vn.Ps,Jt.jT,bn.uw,bh.x,wh.V,Sh.C,Mh.f,Ph.N,Oh.U,Eh.m,Bh.v,Uh.H,qh.Z,it.UX,Ze.Cl,$h.lK,Qh.R,Kh.T6,Wh.N,jh.H,hr.V7]}),o}())},8748:function(Pt,vt,m){"use strict";m.d(vt,{o:function(){return je}});var M=m(81337),u=m(12966),e=m(41114),F="PBI.MashupEditor.OnReadyError",oe=e.cx[F]=(0,e.b1)(F),D="PBI.MashupEditor.OnTokenError",Re=e.cx[D]=(0,e.b1)(D),Be=m(48741),Ee=m(50423),pe=m(95281),R=m(35911),Fe=m(73221),De=m(98665),G=m(78590),We=m(59017),Ue=m(23558),ne=m(59973),se=m(83317),ve=m(76746),Se=m(85928),W=m(65181),He=["mashupIframe"],ye={readyState:0},je=function(rt){function Ke(Q,K,ee,ae,fe,me){var $e=rt.call(this)||this;return $e.appSettings=Q,$e.ref=K,$e.mashupService=ee,$e.localizationService=ae,$e.telemetryService=fe,$e.componentStore=me,$e.onError=new Ee.EventEmitter,$e.onReady=new Ee.EventEmitter,$e.readyState$=$e.componentStore.select(function(ct){return ct.readyState}),$e.updateState=$e.componentStore.updater(function(ct,Ct){return(0,M.__assign)((0,M.__assign)({},ct),{readyState:Ct})}),$e}return(0,M.__extends)(Ke,rt),Ke.prototype.ngOnInit=function(){var K,ee,ae,fe,Q=this;!this.theme&&!(null===(ee=null===(K=this.clientConfiguration)||void 0===K?void 0:K.editorSettings)||void 0===ee)&&ee.themeOverride&&(this.theme=null===(fe=null===(ae=this.clientConfiguration)||void 0===ae?void 0:ae.editorSettings)||void 0===fe?void 0:fe.themeOverride),this.componentStore.setState(ye),this.changes$("flow").pipe((0,Ue.M)(this.readyState$),(0,ne.h)(function(me){return!!me[0]&&1!==me[1]}),(0,se.R)(this.onDestroy$)).subscribe(function(me){var ct=me[1];return(0,M.__awaiter)(Q,void 0,void 0,function(){return(0,M.__generator)(this,function(Ct){switch(Ct.label){case 0:return this.updateState(1),0===ct?[3,2]:[4,this.endFlow()];case 1:Ct.sent(),Ct.label=2;case 2:return this.startFlow(),[2]}})})})},Ke.prototype.ngAfterViewInit=function(){var Q=this;(0,R.mv)(this.clientConfiguration,"clientConfiguration is required"),this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).toPromise().catch(function(){}),this.mashupDataSubscription=(0,We.aj)([this.mashupService.getPQEndpoint()]).pipe((0,ne.h)(function(K){return!!K[0]})).subscribe(function(K){Q.initMashupeditor(K[0])},function(K){Q.onError.emit(K)})},Ke.prototype.ngOnDestroy=function(){return this.mashupEditorClient&&this.mashupEditorClient.dispose(),this.mashupDataSubscription&&this.mashupDataSubscription.unsubscribe(),rt.prototype.ngOnDestroy.call(this)},Ke.prototype.setFocus=function(){var Q=this.mashupIframe.nativeElement.contentDocument||this.mashupIframe.nativeElement.contentWindow;Q?.focus()},Ke.prototype.activateQuery=function(Q){return this.mashupEditorClient.activateQuery(Q)},Ke.prototype.addQuery=function(Q,K){return this.mashupEditorClient.addQuery(Q,K)},Ke.prototype.cancelCurrentEvaluation=function(){return this.mashupEditorClient.dataPreview.cancelCurrentEvaluation()},Ke.prototype.getEditingSessionMashup=function(){return this.mashupEditorClient.getEditingSessionMashup()},Ke.prototype.getQueriesInfo=function(){return this.mashupEditorClient.getQueriesInfo()},Ke.prototype.getQueryScript=function(Q){return this.mashupEditorClient.getQueryScript(Q)},Ke.prototype.getDataSourceQueryScript=function(Q,K){return this.mashupEditorClient.getDataSourceQueryScript(Q,K)},Ke.prototype.setUserSettings=function(Q){return this.mashupEditorClient.setUserSettings(Q)},Ke.prototype.refreshActiveQueryResult=function(){return this.mashupEditorClient.refreshActiveQueryResult()},Ke.prototype.getSelectedStepName=function(){return this.mashupEditorClient.getSelectedStepName()},Ke.prototype.getActiveQueryName=function(){return this.mashupEditorClient.getActiveQueryName()},Ke.prototype.getClientSettings=function(Q){return{allowedOrigin:Q,container:this.mashupIframe.nativeElement,url:this.createMashupEditorUrl(Q),className:"mashup-editor-client-iframe"}},Ke.prototype.createMashupEditorUrl=function(Q){var K="".concat(Q,"/MashupEditor");if(this.mashupEditorFeatureFlags&&this.mashupEditorFeatureFlags.size>0){var ee=new Be.LE;this.mashupEditorFeatureFlags.forEach(function(ae,fe){ee=ee.set(fe,ae)}),K=K+"?"+ee.toString()}return K},Ke.prototype.getEditorSettings=function(){var Q={cancelButtonLabel:this.localizationService.get("Cancel_ButtonText"),closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:G.w9.Cancel},commitButtonLabel:this.localizationService.get("ModalDialog_Save"),enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,showCancelButton:!0,useHostConnectionProvider:!1};return{addFocusTrapZone:!1,locale:this.localizationService.currentLanguageLocale,sessionId:this.telemetryService.sessionId,queryEditorSettings:Q,showCloseButton:!0,showHeader:!1,themeOverride:this.theme||u.C8}},Ke.prototype.endFlow=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var Q;return(0,M.__generator)(this,function(K){switch(K.label){case 0:if(!this.mashupEditorClient)return[2];K.label=1;case 1:return K.trys.push([1,3,,4]),[4,this.mashupEditorClient.endFlow()];case 2:return K.sent(),this.updateState(3),[3,4];case 3:return Q=K.sent(),this.onError.emit(Q),this.updateState(4),[3,4];case 4:return[2]}})})},Ke.prototype.startFlow=function(){var Q=this;!this.flow||!this.mashupEditorClient||this.mashupEditorClient.ready.then(function(){Q.mashupEditorClient.startFlow(Q.flow,Q.editorOnCommit,Q.editorOnCancel).then(function(){Q.updateState(2),Q.onReady.emit(),Q.ref.detectChanges()},function(K){Q.updateState(4)})},function(K){Q.onError.emit(K),Q.updateState(4),Q.telemetryService.logEvent(oe,{reason:K?K+"":void 0})})},Ke.prototype.initMashupeditor=function(Q){var K=this,ee=this.getClientSettings(Q),ae=this.getEditorSettings();this.mashupEditorClient=function(Ke){return new G.Cq(Ke)}(_.merge({clientSettings:ee,editorSettings:ae,acquireToken:function(me){return K.mashupService.getPQToken("".concat(me,"/.default")).toPromise().catch(function($e){K.onError.emit($e),K.telemetryService.logEvent(Re,{reason:$e?$e.status+"":void 0})})}},this.clientConfiguration)),this.startFlow()},Ke.\u0275fac=function(K){return new(K||Ke)(Ee.\u0275\u0275directiveInject(ve.de),Ee.\u0275\u0275directiveInject(Ee.ChangeDetectorRef),Ee.\u0275\u0275directiveInject(Se.M),Ee.\u0275\u0275directiveInject(W.o),Ee.\u0275\u0275directiveInject(De.y0),Ee.\u0275\u0275directiveInject(pe.m1))},Ke.\u0275cmp=Ee.\u0275\u0275defineComponent({type:Ke,selectors:[["mashup-editor"]],viewQuery:function(K,ee){var ae;(1&K&&Ee.\u0275\u0275viewQuery(He,5),2&K)&&(Ee.\u0275\u0275queryRefresh(ae=Ee.\u0275\u0275loadQuery())&&(ee.mashupIframe=ae.first))},inputs:{clientConfiguration:"clientConfiguration",mashupEditorFeatureFlags:"mashupEditorFeatureFlags",flow:"flow",editorOnCommit:"editorOnCommit",editorOnCancel:"editorOnCancel",theme:"theme"},outputs:{onError:"onError",onReady:"onReady"},features:[Ee.\u0275\u0275ProvidersFeature([pe.m1]),Ee.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["id","mashupIframe","pbi-auto-focus","","data-testid","mashup-iframe"],["mashupIframe",""]],template:function(K,ee){1&K&&Ee.\u0275\u0275element(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:flex}#mashupIframe[_ngcontent-%COMP%]{background:var(--white-color, #FFF);display:flex;flex:1 1 auto;align-items:stretch;justify-content:center}#mashupIframe[_ngcontent-%COMP%]     .mashup-editor-client-iframe{border:none;width:100%;height:100%;display:block!important}"],changeDetection:0}),Ke}(Fe.w)},12966:function(Pt,vt,m){"use strict";m.d(vt,{C8:function(){return M},z6:function(){return u}});var M={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},u={palette:{themePrimary:"#117865",themeLighterAlt:"#f1faf8",themeLighter:"#c9e9e3",themeLight:"#9fd6cc",themeTertiary:"#54ae9d",themeSecondary:"#218875",themeDarkAlt:"#0f6c5b",themeDark:"#0d5b4d",themeDarker:"#094339",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},semanticColors:{}}},75266:function(Pt,vt,m){"use strict";m.d(vt,{G:function(){return He}});var M=m(32293),u=m(50423),e=m(77476),F=m(8748);function oe(he,ye){if(1&he){var je=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"mashup-editor",1),u.\u0275\u0275listener("onError",function(){u.\u0275\u0275restoreView(je);var Q=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(Q.onError)}),u.\u0275\u0275elementEnd()}if(2&he){var rt=u.\u0275\u0275nextContext();u.\u0275\u0275property("clientConfiguration",rt.mashUpEditorInput.clientConfiguration)("editorOnCommit",rt.onCommit)("editorOnCancel",rt.onCancel)("flow",rt.mashUpEditorInput.flow)}}var D=function(){function he(ye,je){var rt=this;this.dialogRef=ye,this.onCommit=function(Ke,Q){rt.mashUpEditorInput.editorOnCommit(Ke,Q),rt.dialogRef.close(Q)},this.onCancel=function(Ke){rt.mashUpEditorInput.editorOnCancel(Ke),rt.dialogRef.close()},this.onError=function(Ke){rt.mashUpEditorInput.onError(Ke)},this.mashUpEditorInput=je.input}return he.\u0275fac=function(je){return new(je||he)(u.\u0275\u0275directiveInject(M.so),u.\u0275\u0275directiveInject(M.WI))},he.\u0275cmp=u.\u0275\u0275defineComponent({type:he,selectors:[["mashup-editor-dialog"]],decls:1,vars:1,consts:[["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError",4,"ngIf"],["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError"]],template:function(je,rt){1&je&&u.\u0275\u0275template(0,oe,1,4,"mashup-editor",0),2&je&&u.\u0275\u0275property("ngIf",!!rt.mashUpEditorInput.clientConfiguration)},dependencies:[e.NgIf,F.o],styles:["[_nghost-%COMP%]     mashup-editor{display:flex;width:80vw;height:80vh}[_nghost-%COMP%]{display:flex}"]}),he}(),Be=new u.InjectionToken("MashUpEditorErrorHandler"),Ee=new u.InjectionToken("MashUpEditorLauncher"),pe=m(78590),R=m(33554),Fe=m(82762),De=m(48787),G=m(42195),We=m(58938),Ue=function(he){return he.OnCommit="OnCommit",he.OnCancel="OnCancel",he}({}),se={provide:Ee,useClass:function(){function he(ye,je){this.dialogService=ye,this.errorHandler=je,this.lifeCycleEvent$=new R.t(1)}return he.prototype.editQueries=function(ye,je){return this.launchMashUpEditor(je.clientConfiguration,{kind:pe.Mw.EditQuery,hostContext:je.hostContext||ye.hostContext,mashupDefinition:{editingSessionMashup:ye,kind:pe.Qo.TransientMashup}})},he.prototype.addQueries=function(ye,je){var rt=this.buildFlowForAddQueries(ye,je);return this.launchMashUpEditor(je.clientConfiguration,rt)},he.prototype.manageDataSources=function(ye,je){return this.launchMashUpEditor(je.clientConfiguration,{kind:pe.Mw.ManageConnections,hostContext:je.hostContext,connectionOverrides:ye.connectionOverrides})},he.prototype.buildFlowForAddQueries=function(ye,je){var rt={kind:pe.Mw.AddQueries,hostContext:je.hostContext||ye.hostContext};return function(he){return!_.has(he,"mashupDocument")||_.isNil(he.mashupDocument)}(ye)?(rt.mashupTemplateImportAllowed=!0,rt.mashupDefinition={editingSessionEmptyMashup:ye,kind:pe.Qo.TransientEmptyMashup}):(rt.mashupTemplateImportAllowed=!1,rt.mashupDefinition={editingSessionMashup:ye,kind:pe.Qo.TransientMashup}),rt},he.prototype.launchMashUpEditor=function(ye,je){var rt=this;return(0,Fe.D)(this.dialogService.showTemplateDialog("MashUpEditorDialogComponentId",{title:"Mash Up Editor Dialog",input:{clientConfiguration:ye,flow:je,editorOnCommit:function(K,ee){return rt.onCommit(K,ee)},editorOnCancel:function(K){return rt.onCancel(K)},onError:function(K){var ee;return null===(ee=rt.errorHandler)||void 0===ee?void 0:ee.handleError(K)}}})).pipe((0,De.q)(1),(0,G.zg)(function(Q){return Q.afterClosed()})).toPromise()},he.prototype.onCommit=function(ye,je){this.lifeCycleEvent$.next({type:Ue.OnCommit,payload:je})},he.prototype.onCancel=function(ye){this.lifeCycleEvent$.next({type:Ue.OnCancel,payload:void 0})},he.\u0275fac=function(je){return new(je||he)(u.\u0275\u0275inject(We.x),u.\u0275\u0275inject(Be,8))},he.\u0275prov=u.\u0275\u0275defineInjectable({token:he,factory:he.\u0275fac}),he}()},ve=m(79061),Se=m(24495),He=function(){function he(){}return he.\u0275fac=function(je){return new(je||he)},he.\u0275mod=u.\u0275\u0275defineNgModule({type:he}),he.\u0275inj=u.\u0275\u0275defineInjector({providers:[se],imports:[e.CommonModule,ve.v,Se.z.withManifest([{componentIdentifier:"MashUpEditorDialogComponentId",componentType:D}])]}),he}()},85928:function(Pt,vt,m){"use strict";m.d(vt,{M:function(){return ve}});var M=m(36444),u=m(35911),e=m(85732),F=(0,e.ZF)("urlConfiguration"),oe=(0,e.P1)(F,function(Se){return Se.powerQueryHostUrl}),D=m(37263),Re=m(59694),Be=m(11547),Ee=m(82762),pe=m(35510),R=m(42195),Fe=m(14172),De=m(17653),G=m(88255),We=m(50423),Ue=m(62113),ne=m(73875),se=window,ve=function(){function Se(W,He,he,ye){var je=this;this.store=W,this.accessTokenProviderService=He,this.httpService=he,this.inTeams=ye,this.getAADToken$=function(rt){return(0,Be.of)(null).pipe((0,R.zg)(function(){if(se.clientAuthEnabled)return(0,Ee.D)(je.accessTokenProviderService.acquireToken("MashupService",[rt],!1)).pipe((0,Fe.U)(function(ee){return ee.token}));if(je.inTeams){var Ke=rt.substring(0,rt.lastIndexOf("/"));return M.authentication.initialize(),(0,Ee.D)(M.authentication.getAuthToken({resources:[Ke],silent:!0}))}var Q=(0,Re.W)("{0}/msal",se.baseUrl||window.location.origin),K=je.httpService.powerbiRequestOptions();return K.params={scopes:rt},je.httpService.get(Q,K).pipe((0,Fe.U)(function(ee){return ee.data.AccessToken}))}),(0,De.b)(function(Ke){var K=1e3*(0,u.oG)(Ke).exp;je.AADTokenCache$.next(new Map(je.AADTokenCache$.getValue()).set(rt,{token:Ke,expiration:K}))}))},this.AADTokenCache$=new pe.X(new Map)}return Se.prototype.getPQEndpoint=function(){return this.store.select(oe).pipe((0,Fe.U)(function(W){return(0,Re.g)(W)?null:W.replace(/\/$/,"")}))},Se.prototype.getPQToken=function(W){var He=this;return this.AADTokenCache$.pipe((0,G.P)(),(0,R.zg)(function(he){return!he.has(W)||Date.now()+3e5>he.get(W).expiration?He.getAADToken$(W):(0,Be.of)(he.get(W).token)}))},Se.\u0275fac=function(He){return new(He||Se)(We.\u0275\u0275inject(e.yh),We.\u0275\u0275inject(Ue.Q),We.\u0275\u0275inject(ne.O),We.\u0275\u0275inject(D.$,8))},Se.\u0275prov=We.\u0275\u0275defineInjectable({token:Se,factory:Se.\u0275fac,providedIn:"root"}),Se}()},47754:function(Pt,vt,m){"use strict";m.d(vt,{L:function(){return Ue}});var M=m(82515),u=m(14463),e=m(34410),F=m(59055),oe=m(38078),D=m(98665),Re=m(76609),Be=m(50423),Ee=m(27887),pe=m(32140),R=m(18942),Fe=m(85732),Ue=function(){function ne(se,ve,Se,W,He,he,ye,je){this.applicationOptions=se,this.userInfo=ve,this.userProfileImageService=Se,this.telemetryService=W,this.sanitizer=He,this.store=he,this.groupPhotos=[],this.userPhotos=[],this.findGroupIconPromises=[],this.getOtherUserPhotoPromises=[],this.getGroupIconPromises=[],this.userMetadataHttpService=ye,this.promiseFactory=je}return ne.prototype.getGroupIcons=function(se){var ve=this;if(void 0===se&&(se=4900),this.groupIconsPromise)return this.groupIconsPromise;var Se=this.promiseFactory.defer();return setTimeout(function(){var W=ve.telemetryService.startEvent(F.Sj);ve.userMetadataHttpService.getUserGroupIcons(W.event).toPromise().then(function(He){He.data&&(Se.resolve(He.data),ve.store.dispatch(new M.YI({groupIcons:He.data})))},function(){Se.reject()})},se),this.groupIconsPromise=Se.promise,Se.promise},ne.prototype.getGroupIcon=function(se,ve){var Se=this;void 0===ve&&(ve=4900);var W=_.find(this.getGroupIconPromises,function(ye){return ye.groupObjectId===se});if(W)return W.promise;var He=this.promiseFactory.defer(),he=this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getGroupIcon(se).toPromise();return setTimeout(function(){he.then(function(ye){if(ye.data){var je=Se.base64Enconding(ye.data.groupIcon);He.resolve(je),Se.groupPhotos.push({groupObjectId:se,groupIcon:je})}else He.reject()},function(ye){Se.resultHasStatusEquivalentOfNotFound(ye.status)?(He.resolve(""),Se.groupPhotos.push({groupObjectId:se,groupIcon:""})):He.reject()})},ve),this.getGroupIconPromises.push({groupObjectId:se,promise:He.promise}),He.promise},ne.prototype.getUserPhoto=function(){var se=this;if(this._userPhotoPromise)return this._userPhotoPromise;var ve=this.userProfileImageService.getUserPhoto();return this._userPhotoPromise=ve,ve.then(function(Se){se.userPhotos.push({userObjectId:se.userInfo.puid,userIcon:Se});var W=Se.substring(4,Se.length-1),He=se.sanitizer.bypassSecurityTrustUrl(W);se.store.dispatch(new M.Ar(He))},function(Se){if(Se.name!==Re.SJ)throw Se}),ve},ne.prototype.getOtherUserPhoto=function(se){var ve=this,Se=_.find(this.getOtherUserPhotoPromises,function(he){return he.userObjectId===se});if(Se)return Se.promise;var W=this.promiseFactory.defer();return(this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getOtherUserPhoto(se).toPromise()).then(function(he){if(he.data.type===oe.JA){var ye=URL.createObjectURL(he.data);return W.resolve(ye),void ve.userPhotos.push({userObjectId:se,userIcon:ye})}W.reject()},function(he){ve.resultHasStatusEquivalentOfNotFound(he.status)?(W.resolve(""),ve.userPhotos.push({userObjectId:se,userIcon:""})):W.reject()}),this.getOtherUserPhotoPromises.push({userObjectId:se,promise:W.promise}),W.promise},ne.prototype.findGroupIcon=function(se,ve){var Se=this,W=_.find(this.findGroupIconPromises,function(he){return he.groupObjectId===se});if(W)return W.promise;var He=this.promiseFactory.defer();return this.getGroupIcons(ve).then(function(he){var ye=_.find(he,function(rt){return rt.groupObjectId===se});if(ye){var je=Se.base64Enconding(ye.groupIcon);He.resolve(je),Se.groupPhotos.push({groupObjectId:se,groupIcon:je})}else He.reject("Group with objectid "+se+" has no icon")},function(){He.reject()}),this.findGroupIconPromises.push({groupObjectId:se,promise:He.promise}),He.promise},ne.prototype.findOrGetGroupPhoto=function(se){var ve=this,Se=this.promiseFactory.defer(),W=_.find(this.groupPhotos,function(He){return He.groupObjectId===se});return W?""!==W.groupIcon?Se.resolve(W.groupIcon):Se.reject():this.findGroupIcon(se).then(function(He){Se.resolve(He)},function(){ve.getGroupIcon(se).then(function(He){Se.resolve(He)},function(He){Se.reject()})}),Se.promise},ne.prototype.findOrGetUserPhoto=function(se){var ve=this.promiseFactory.defer(),Se=_.find(this.userPhotos,function(W){return W.userObjectId===se});return Se?""!==Se.userIcon?ve.resolve(Se.userIcon):ve.reject():se===this.userInfo.puid?this._userPhotoPromise&&this._userPhotoPromise.then(function(W){ve.resolve(W)}):this.getOtherUserPhoto(se).then(function(W){W?ve.resolve(W):ve.reject()}),ve.promise},ne.prototype.base64Enconding=function(se){return"data:image/jpeg;base64,"+se},ne.prototype.resultHasStatusEquivalentOfNotFound=function(se){return 404===se||400===se||500===se},ne.prototype.getRejectedHttpResultPromiseWithNotFound=function(){return this.promiseFactory.reject({data:{},status:404,headers:function(){return""}})},ne.\u0275fac=function(ve){return new(ve||ne)(Be.\u0275\u0275inject(Ee.V),Be.\u0275\u0275inject(pe.a),Be.\u0275\u0275inject(Re.lH),Be.\u0275\u0275inject(D.y0),Be.\u0275\u0275inject(R.H7),Be.\u0275\u0275inject(Fe.yh),Be.\u0275\u0275inject(e.y),Be.\u0275\u0275inject(u.t))},ne.\u0275prov=Be.\u0275\u0275defineInjectable({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne}()},45690:function(Pt){Pt.exports={ApplyAllSlicersWeb_15x17:"ApplyAllSlicersWeb_15x17",ClearAllSlicersWeb_16:"ClearAllSlicersWeb_16",ArrowRightWeb_16:"ArrowRightWeb_16",LineWeb_16:"LineWeb_16",Oval_16:"Oval_16",Rectangle_16:"Rectangle_16",TriangleIsoc_16:"TriangleIsoc_16",ActualSizePBI_16:"ActualSizePBI_16",BookmarkPBI_16:"BookmarkPBI_16",BookmarkedPBI_16:"BookmarkedPBI_16",Color_16:"Color_16",Comment_16:"Comment_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",DownloadPBI_16:"DownloadPBI_16",EditPBI_16:"EditPBI_16",EditPBI2_16:"EditPBI2_16",HtmlEmbed_16:"HtmlEmbed_16",ExcelPBI_16:"ExcelPBI_16",ExportPBI_16:"ExportPBI_16",file_16:"file_16",FitPage_16:"FitPage_16",FitWidth_16:"FitWidth_16",FullScreenSizeIcon_16:"FullScreenSizeIcon_16",Lightbulb_16:"Lightbulb_16",LineageView_16:"LineageView_16",MobilePhone_16:"MobilePhone_16",MorePBI_16:"MorePBI_16",MultipleUnreadMail_16:"MultipleUnreadMail_16",NoEditPBI_16x17:"NoEditPBI_16x17",PBIModelingView_16:"PBIModelingView_16",PdfPBI_16:"PdfPBI_16",PinToDashboard_16:"PinToDashboard_16",PowerAutomate_16:"PowerAutomate_16",PowerPointMonoline_16:"PowerPointMonoline_16",PrintPBI_16:"PrintPBI_16",QRCode_16:"QRCode_16",Save_16:"Save_16",SaveACopy_16:"SaveACopy_16",SeeRelatedContent_16:"SeeRelatedContent_16",SettingsPBI_16:"SettingsPBI_16",ShareasLink_16:"ShareasLink_16",SharePBI_16:"SharePBI_16",SharePointMonoline_16:"SharePointMonoline_16",ShareReport_16:"ShareReport_16",TeamsMonoline_16:"TeamsMonoline_16",UsageMetrics_16:"UsageMetrics_16",ViewPBI_16:"ViewPBI_16",WebPublish_16:"WebPublish_16",CodeEdit_16:"CodeEdit_16",AddAPlace_16:"AddAPlace_16",AccessNewTable_16:"AccessNewTable_16",BarChart4_16:"BarChart4_16",PBIReportTemplate_16:"PBIReportTemplate_16",RefreshNow_16:"RefreshNow_16",RefreshCancel_16:"RefreshCancel_16",DateTime_16:"DateTime_16",PeopleSettings_16:"PeopleSettings_16",Database_16:"Database_16",ImpactAnalysis_16:"ImpactAnalysis_16",AutoCreateReport_16:"AutoCreateReport_16",PaginatedReport_16:"PaginatedReport_16",CloudImportExport_16:"CloudImportExport_16",GenericScan_16:"GenericScan_16",Key_16:"Key_16",Repair_16:"Repair_16",Unknown_16:"Unknown_16",RefreshHistory_16:"RefreshHistory_16",BackChevron_16:"BackChevron_16",Medical_16:"Medical_16",QueryList_16:"QueryList_16",PermissionsKey_16:"PermissionsKey_16"}},5209:function(){window.appBarSprite={icons:[{type:"svg",id:"ApplyAllSlicersWeb_15x17",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.001 7V4H1.00098V11C1.00098 12.1046 1.89641 13 3.00098 13H11.001V14H3.00098C1.34412 14 0.000976562 12.6569 0.000976562 11V3C0.000976562 1.34315 1.34412 0 3.00098 0H11.001C12.6578 0 14.001 1.34315 14.001 3V7H13.001Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M2.50102 6.49993C2.4998 6.36593 2.52636 6.23314 2.57902 6.10993C2.62949 5.99438 2.70104 5.88926 2.79002 5.79993C2.88313 5.70886 2.99142 5.63475 3.11002 5.58093C3.23214 5.52348 3.36612 5.49573 3.50102 5.49993C3.6327 5.49921 3.7631 5.52577 3.88402 5.57793C4.00189 5.62958 4.11011 5.70093 4.20402 5.78893C4.2989 5.87923 4.37354 5.98864 4.42302 6.10993C4.47471 6.23344 4.50123 6.36603 4.50102 6.49993C4.50231 6.63425 4.47576 6.76738 4.42302 6.89093C4.37308 7.00735 4.30148 7.11323 4.21202 7.20293C4.11942 7.29462 4.01101 7.36881 3.89202 7.42193C3.76994 7.47927 3.63575 7.50604 3.50102 7.49993C3.36669 7.50122 3.23356 7.47466 3.11002 7.42193C2.99187 7.37077 2.88358 7.29937 2.79002 7.21093C2.69715 7.12448 2.62502 7.01817 2.57902 6.89993C2.5304 6.77202 2.50402 6.63673 2.50102 6.49993Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M2.50102 10.4999C2.4998 10.3659 2.52636 10.2331 2.57902 10.1099C2.62916 9.99332 2.70073 9.88715 2.79002 9.79693C2.88295 9.70591 2.9913 9.6321 3.11002 9.57893C3.23217 9.52173 3.36624 9.49464 3.50102 9.49993C3.63282 9.49906 3.76332 9.52598 3.88402 9.57893C4.00205 9.62985 4.11033 9.70091 4.20402 9.78893C4.2989 9.87923 4.37354 9.98864 4.42302 10.1099C4.47471 10.2334 4.50123 10.366 4.50102 10.4999C4.50231 10.6342 4.47576 10.7674 4.42302 10.8909C4.37287 11.0075 4.3013 11.1137 4.21202 11.2039C4.11908 11.2949 4.01073 11.3688 3.89202 11.4219C3.76994 11.4793 3.63575 11.506 3.50102 11.4999C3.36669 11.5012 3.23356 11.4747 3.11002 11.4219C2.99187 11.3708 2.88358 11.2994 2.79002 11.2109C2.69703 11.1242 2.62489 11.0175 2.57902 10.8989C2.53051 10.7713 2.50413 10.6364 2.50102 10.4999Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M6.55036 7.00008C6.40711 7.00245 6.26847 6.94943 6.16336 6.85208V6.84808C6.11302 6.8047 6.07263 6.75099 6.04495 6.69058C6.01726 6.63018 6.00293 6.56452 6.00293 6.49808C6.00293 6.43163 6.01726 6.36597 6.04495 6.30557C6.07263 6.24517 6.11302 6.19145 6.16336 6.14808C6.26847 6.05072 6.40711 5.99771 6.55036 6.00008H10.9504C11.0942 5.99879 11.2329 6.05327 11.3374 6.15208C11.3877 6.19545 11.4281 6.24917 11.4558 6.30957C11.4835 6.36997 11.4978 6.43563 11.4978 6.50208C11.4978 6.56852 11.4835 6.63418 11.4558 6.69458C11.4281 6.75499 11.3877 6.80871 11.3374 6.85208C11.2377 6.94438 11.1079 6.99683 10.9726 7H9.74193L9.72696 7.00008H6.55036Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M9.56658 11L8.54198 10H6.55036C6.4072 9.99819 6.26875 10.0511 6.16336 10.148C6.11302 10.1914 6.07263 10.2451 6.04495 10.3055C6.01726 10.3659 6.00293 10.4316 6.00293 10.498C6.00293 10.5645 6.01726 10.6302 6.04495 10.6906C6.07263 10.751 6.11302 10.8047 6.16336 10.848V10.852C6.26875 10.949 6.4072 11.0019 6.55036 11H9.56658Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M9.28074 9.28033L10.1949 10.1945L10.207 10.2069L12 11.9999V13.9999C12 14.0462 12.0129 14.0916 12.0373 14.131C12.0616 14.1704 12.0965 14.2022 12.138 14.2229L13.638 14.9729C13.6726 14.9907 13.711 15 13.75 14.9999C13.8163 14.9999 13.8799 14.9735 13.9268 14.9267C13.9737 14.8798 14 14.8162 14 14.7499V12.0004L16.7201 9.28033C17.1926 8.80786 16.8579 8 16.1898 8H9.81107C9.14289 8 8.80827 8.80786 9.28074 9.28033Z"}],viewBox:"0 0 17 15"},{type:"svg",id:"ClearAllSlicersWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M734 2048q-38 0-73-14t-62-42L56 1449q-26-26-41-62t-15-74q0-38 15-74t41-62L1177 56q27-27 62-41t74-15q80 0 136 56l543 543q56 56 56 136 0 38-14 73t-42 63L943 1920h657q26 0 45 19t19 45q0 26-19 45t-45 19H734zM1920 735q0-26-19-45l-543-543q-19-19-45-19t-45 19L453 962l633 633 815-815q19-19 19-45zM735 1921q26 0 45-19l216-216-634-634-216 216q-18 18-18 45 0 12 4 24t14 21l544 544q19 19 45 19z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"ArrowRightWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16 7L9 14V11H0V3H9V0L16 7ZM1 10H10V11.5859L14.5859 7L10 2.41406V4H1V10Z"}],viewBox:"0 0 15 14"},{type:"svg",id:"LineWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1.52606 0.89759L0.897522 1.52612L14.4738 15.1024L15.1024 14.4739L1.52606 0.89759Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Oval_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8 0C3.6 0 0 2.7 0 6C0 9.3 3.6 12 8 12C12.4 12 16 9.3 16 6C16 2.7 12.4 0 8 0ZM8 11C4.1 11 1 8.8 1 6C1 3.2 4.1 1 8 1C11.9 1 15 3.2 15 6C15 8.8 11.9 11 8 11Z"}],viewBox:"0 0 16 12"},{type:"svg",id:"Rectangle_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0 0V12H16V0H0ZM15 11H1V1H15V11Z"}],viewBox:"0 0 16 12"},{type:"svg",id:"TriangleIsoc_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8 0L0 16H16L8 0ZM8 2.2L14.4 15H1.6L8 2.2Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ActualSizePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M9.516,6.93C9.349,6.977,9.177,7,9,7V6c0.141,0,0.271-0.026,0.391-0.078\r\n\ts0.224-0.122,0.312-0.211C9.797,5.617,9.87,5.51,9.922,5.391S10,5.141,10,5h1v5h-1V6.719C9.849,6.807,9.688,6.878,9.516,6.93z\r\n\t M7.148,6.852C7.049,6.753,7,6.635,7,6.5s0.049-0.253,0.148-0.352S7.365,6,7.5,6s0.253,0.049,0.352,0.148S8,6.365,8,6.5\r\n\tS7.951,6.753,7.852,6.852S7.635,7,7.5,7S7.247,6.951,7.148,6.852z M7.148,8.852C7.049,8.753,7,8.635,7,8.5s0.049-0.253,0.148-0.352\r\n\tS7.365,8,7.5,8s0.253,0.049,0.352,0.148S8,8.365,8,8.5S7.951,8.753,7.852,8.852S7.635,9,7.5,9S7.247,8.951,7.148,8.852z M4.516,6.93\r\n\tC4.349,6.977,4.177,7,4,7V6c0.141,0,0.271-0.026,0.391-0.078s0.224-0.122,0.312-0.211C4.797,5.617,4.87,5.51,4.922,5.391\r\n\tS5,5.141,5,5h1v5H5V6.719C4.849,6.807,4.688,6.878,4.516,6.93z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m23",d:"M5,10V6.719C4.849,6.807,4.688,6.878,4.516,6.93C4.349,6.977,4.177,7,4,7V6c0.141,0,0.271-0.026,0.391-0.078\r\n\tC4.51,5.87,4.615,5.799,4.703,5.711C4.797,5.617,4.87,5.51,4.922,5.391C4.974,5.271,5,5.141,5,5h1v5H5z M10,10V6.719\r\n\tC9.849,6.807,9.688,6.878,9.516,6.93C9.349,6.977,9.177,7,9,7V6c0.141,0,0.271-0.026,0.391-0.078C9.51,5.87,9.615,5.799,9.703,5.711\r\n\tC9.797,5.617,9.87,5.51,9.922,5.391C9.974,5.271,10,5.141,10,5h1v5H10z M7.5,7C7.365,7,7.247,6.951,7.148,6.852S7,6.635,7,6.5\r\n\ts0.049-0.253,0.148-0.352S7.365,6,7.5,6s0.253,0.049,0.352,0.148S8,6.365,8,6.5S7.951,6.753,7.852,6.852S7.635,7,7.5,7z M7.5,9\r\n\tC7.365,9,7.247,8.951,7.148,8.852S7,8.635,7,8.5s0.049-0.253,0.148-0.352S7.365,8,7.5,8s0.253,0.049,0.352,0.148S8,8.365,8,8.5\r\n\tS7.951,8.753,7.852,8.852S7.635,9,7.5,9z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BookmarkPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m20",d:"M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023c0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BookmarkedPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,0v16l-5-2.523L3,16V0H13z"},{type:"path",className:"OfficeIconColors_m218",d:"M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023c0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Color_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1536 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -384 -128 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -384 128 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m 896 384 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -128 384 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -538 -1408 q 139 0 272 36 q 132 37 249 103 q 116 67 214 160 q 97 94 167 208 q 70 114 109 245 q 39 131 39 272 q 0 120 -38 242 q -39 122 -106 236 q -68 114 -161 213 q -93 100 -201 174 q -109 74 -229 116 q -120 43 -242 43 q -72 0 -128 -37 q -56 -37 -95 -94 q -39 -56 -59 -124 q -21 -67 -21 -129 q 0 -49 15 -92 q 14 -43 36 -82 q 22 -39 47 -75 q 25 -36 47 -70 q 22 -33 37 -65 q 14 -32 14 -64 q 0 -25 -21 -59 q -22 -33 -52 -63 q -31 -29 -65 -50 q -34 -20 -58 -20 q -38 0 -72 19 q -35 19 -71 47 q -36 29 -74 62 q -39 33 -83 61 q -45 29 -97 48 q -52 19 -115 19 q -50 0 -96 -21 q -47 -21 -82 -57 q -36 -35 -57 -82 q -21 -46 -21 -96 q 0 -133 37 -261 q 36 -127 102 -241 q 66 -113 158 -209 q 92 -96 203 -166 q 111 -69 238 -108 q 126 -39 260 -39 m 922 1024 q 0 -124 -34 -239 q -35 -114 -96 -214 q -62 -99 -148 -181 q -86 -81 -188 -140 q -103 -58 -218 -90 q -116 -32 -238 -32 q -116 0 -226 34 q -110 35 -206 96 q -97 61 -177 145 q -81 85 -139 184 q -58 100 -90 211 q -32 111 -32 226 q 0 24 11 47 q 11 23 29 41 q 18 18 41 29 q 23 11 47 11 q 50 0 93 -19 q 43 -19 82 -48 q 39 -28 77 -61 q 37 -33 77 -62 q 40 -28 85 -47 q 45 -19 98 -19 q 34 0 71 13 q 37 14 73 38 q 36 24 69 55 q 33 31 58 66 q 24 35 39 72 q 14 37 14 71 q 0 46 -14 86 q -15 41 -37 78 q -22 37 -47 72 q -25 35 -47 70 q -22 36 -36 72 q -15 36 -15 75 q 0 33 12 77 q 11 44 33 84 q 22 40 55 67 q 32 28 74 28 q 106 0 210 -37 q 104 -37 199 -101 q 94 -64 175 -151 q 81 -86 140 -186 q 59 -99 93 -207 q 33 -108 33 -214 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1070 1984 q -11 0 -16 -1 q -6 -1 -8 -2 q -57 -24 -97 -54 q -41 -29 -67 -68 q -26 -38 -38 -86 q -12 -48 -12 -109 q 0 -34 9 -66 q 9 -32 24 -62 q 15 -30 34 -58 q 18 -28 38 -56 q 15 -22 32 -47 q 16 -24 29 -51 q 13 -26 22 -54 q 9 -27 9 -56 q 0 -27 -7 -51 q -7 -24 -23 -48 q -17 -23 -43 -48 q -27 -24 -67 -53 q -12 -9 -25 -19 q -13 -9 -27 -17 q -14 -8 -31 -13 q -17 -5 -38 -5 q -41 0 -77 15 q -37 15 -71 39 q -34 24 -66 52 q -33 29 -66 56 q -33 27 -68 49 q -36 23 -75 33 q -24 7 -46 9 q -23 3 -43 3 q -37 0 -71 -16 q -35 -16 -62 -43 q -27 -27 -43 -62 q -16 -34 -16 -71 q 0 -113 31 -229 q 31 -115 89 -222 q 58 -106 141 -199 q 83 -93 187 -162 q 103 -69 226 -109 q 122 -39 260 -39 q 134 0 259 35 q 125 35 235 98 q 109 64 200 152 q 90 88 155 195 q 65 107 101 228 q 36 122 36 252 q 0 114 -38 229 q -39 115 -103 221 q -65 106 -150 198 q -86 92 -180 160 q -94 69 -190 108 q -97 40 -184 41 q -17 0 -35 1 q -18 2 -34 2 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 998 0 q 139 0 272 36 q 132 37 249 103 q 116 67 214 160 q 97 94 167 208 q 70 114 109 245 q 39 131 39 272 q 0 120 -38 242 q -39 122 -106 236 q -68 114 -161 213 q -93 100 -201 174 q -109 74 -229 116 q -120 43 -242 43 q -72 0 -128 -37 q -56 -37 -95 -94 q -39 -56 -59 -124 q -21 -67 -21 -129 q 0 -49 15 -92 q 14 -43 36 -82 q 22 -39 47 -75 q 25 -36 47 -70 q 22 -33 37 -65 q 14 -32 14 -64 q 0 -25 -21 -59 q -22 -33 -52 -63 q -31 -29 -65 -50 q -34 -20 -58 -20 q -38 0 -72 19 q -35 19 -71 47 q -36 29 -74 62 q -39 33 -83 61 q -45 29 -97 48 q -52 19 -115 19 q -50 0 -96 -21 q -47 -21 -82 -57 q -36 -35 -57 -82 q -21 -46 -21 -96 q 0 -133 37 -261 q 36 -127 102 -241 q 66 -113 158 -209 q 92 -96 203 -166 q 111 -69 238 -108 q 126 -39 260 -39 m 922 1024 q 0 -124 -34 -239 q -35 -114 -96 -214 q -62 -99 -148 -181 q -86 -81 -188 -140 q -103 -58 -218 -90 q -116 -32 -238 -32 q -116 0 -226 34 q -110 35 -206 96 q -97 61 -177 145 q -81 85 -139 184 q -58 100 -90 211 q -32 111 -32 226 q 0 24 11 47 q 11 23 29 41 q 18 18 41 29 q 23 11 47 11 q 50 0 93 -19 q 43 -19 82 -48 q 39 -28 77 -61 q 37 -33 77 -62 q 40 -28 85 -47 q 45 -19 98 -19 q 34 0 71 13 q 37 14 73 38 q 36 24 69 55 q 33 31 58 66 q 24 35 39 72 q 14 37 14 71 q 0 46 -14 86 q -15 41 -37 78 q -22 37 -47 72 q -25 35 -47 70 q -22 36 -36 72 q -15 36 -15 75 q 0 33 12 77 q 11 44 33 84 q 22 40 55 67 q 32 28 74 28 q 106 0 210 -37 q 104 -37 199 -101 q 94 -64 175 -151 q 81 -86 140 -186 q 59 -99 93 -207 q 33 -108 33 -214 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 768 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1152 512 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m210",d:"M 1536 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m213",d:"M 1664 1024 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m219",d:"M 1536 1408 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Comment_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 m 1664 128 h -1536 v 1024 h 256 v 331 l 331 -331 h 949 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 448 1344 h -256 v -1152 h 1664 v 1152 h -986 l -422 422 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 m 1664 128 h -1536 v 1024 h 256 v 331 l 331 -331 h 949 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CheckmarkWithDynamicColor_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 704 1562 l -474 -474 l 90 -90 l 384 384 l 896 -896 l 90 90 z"},{type:"path",className:"OfficeIconColors_m22 OfficeIconColors_DynamicColor",d:"M 704 1562 l -474 -474 l 90 -90 l 384 384 l 896 -896 l 90 90 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"DownloadPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M3,15h9v1H3V15z M12.352,8.352l-0.703-0.703L8,11.32V0H7v11.32L3.352,7.648L2.648,8.352L7.5,13.242\r\n\tL12.352,8.352z"},{type:"path",className:"OfficeIconColors_m22",d:"M3,16v-1h9v1H3z"},{type:"path",className:"OfficeIconColors_m24",d:"M12.352,8.352L7.5,13.242L2.648,8.352l0.703-0.703L7,11.32V0h1v11.32l3.648-3.672L12.352,8.352z"}],viewBox:"0 0 16 16"},{type:"svg",id:"EditPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,2.617c0,0.344-0.065,0.677-0.195,1s-0.32,0.609-0.57,0.859l-10.29,10.29L0,16l1.234-4.945L11.523,0.766\r\n\tc0.25-0.25,0.536-0.44,0.859-0.57s0.656-0.195,1-0.195c0.359,0,0.698,0.07,1.016,0.211c0.318,0.135,0.594,0.323,0.828,0.562\r\n\tc0.24,0.234,0.427,0.51,0.562,0.828C15.93,1.919,16,2.258,16,2.617z M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875\r\n\tc0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711L2.547,11.156z M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68\r\n\tc-0.115-0.214-0.255-0.404-0.422-0.57c-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z\r\n\t M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359c0.094-0.13,0.167-0.268,0.219-0.414\r\n\tC14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2c-0.083-0.198-0.2-0.37-0.352-0.516\r\n\tC14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1c-0.198,0-0.372,0.029-0.523,0.086\r\n\tc-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2L14,4.289z"},{type:"path",className:"OfficeIconColors_m20",d:"M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68c-0.115-0.214-0.255-0.404-0.422-0.57\r\n\tc-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z"},{type:"path",className:"OfficeIconColors_m212",d:"M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875c0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711\r\n\tL2.547,11.156z"},{type:"path",className:"OfficeIconColors_m221",d:"M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359\r\n\tc0.094-0.13,0.167-0.268,0.219-0.414C14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2\r\n\tc-0.083-0.198-0.2-0.37-0.352-0.516C14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1\r\n\tc-0.198,0-0.372,0.029-0.523,0.086c-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2\r\n\tL14,4.289z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,2.617c0,0.344-0.065,0.677-0.195,1s-0.32,0.609-0.57,0.859l-10.29,10.29L0,16l1.234-4.945L11.523,0.766\r\n\tc0.25-0.25,0.536-0.44,0.859-0.57s0.656-0.195,1-0.195c0.359,0,0.698,0.07,1.016,0.211c0.318,0.135,0.594,0.323,0.828,0.562\r\n\tc0.24,0.234,0.427,0.51,0.562,0.828C15.93,1.919,16,2.258,16,2.617z M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875\r\n\tc0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711L2.547,11.156z M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68\r\n\tc-0.115-0.214-0.255-0.404-0.422-0.57c-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z\r\n\t M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359c0.094-0.13,0.167-0.268,0.219-0.414\r\n\tC14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2c-0.083-0.198-0.2-0.37-0.352-0.516\r\n\tC14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1c-0.198,0-0.372,0.029-0.523,0.086\r\n\tc-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2L14,4.289z"}],viewBox:"0 0 16 16"},{type:"svg",id:"EditPBI2_16",children:[{type:"path",d:"M15.1813 0.926893C14.0291 -0.284951 12.1047 -0.309226 10.9222 0.873168L1.54741 10.2475C1.21958 10.5754 0.992038 10.9899 \r\n0.891482 11.4424L0.0138652 15.3923C-0.0232157 15.5592 0.0275431 15.7335 0.148442 15.8544C0.26934 15.9753 0.443618 16.026 0.610502 \r\n15.9889L4.53689 15.1157C5.00432 15.0118 5.43243 14.7767 5.77103 14.4381L15.129 5.08003C16.27 3.939 16.2933 2.09631 15.1813 \r\n0.926893ZM11.6293 1.58029C12.4143 0.795384 13.6917 0.811498 14.4566 1.61596C15.1948 2.39225 15.1793 3.61548 14.4219 4.37293L13.7507 \r\n5.04418L10.958 2.25155L11.6293 1.58029ZM10.2509 2.95864L13.0436 5.7513L5.06391 13.731C4.85976 13.9352 4.60164 14.0769 4.31982 \r\n14.1396L1.1605 14.8421L1.86768 11.6593C1.92698 11.3924 2.06117 11.148 2.2545 10.9547L10.2509 2.95864Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"HtmlEmbed_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 530 1403 l -530 -379 l 530 -379 l 62 87 l -408 292 l 412 292 m 922 -671 l 530 379 l -530 379 l -62 -87 l 408 -292 l -412 -292 m -731 845 l 510 -1149 l 96 43 l -510 1149 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 530 1403 l -530 -379 l 530 -379 l 62 87 l -408 292 l 412 292 m 922 -671 l 530 379 l -530 379 l -62 -87 l 408 -292 l -412 -292 m -731 845 l 510 -1149 l 96 43 l -510 1149 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ExcelPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,0c0.135,0,0.264,0.026,0.387,0.078c0.122,0.052,0.229,0.124,0.32,0.215\r\n\tc0.091,0.091,0.162,0.198,0.215,0.32C15.974,0.736,16,0.865,16,1v14c0,0.136-0.026,0.265-0.078,0.387\r\n\tc-0.053,0.122-0.124,0.229-0.215,0.32c-0.092,0.091-0.198,0.163-0.32,0.215C15.264,15.974,15.135,16,15,16H4\r\n\tc-0.136,0-0.265-0.026-0.387-0.078c-0.123-0.052-0.229-0.124-0.32-0.215c-0.092-0.091-0.163-0.198-0.215-0.32\r\n\tC3.025,15.265,3,15.136,3,15v-2H1c-0.136,0-0.265-0.025-0.387-0.078c-0.123-0.052-0.229-0.123-0.32-0.215\r\n\tc-0.092-0.091-0.163-0.197-0.215-0.32C0.025,12.265,0,12.136,0,12V4c0-0.135,0.025-0.264,0.078-0.387\r\n\tc0.052-0.122,0.123-0.229,0.215-0.32C0.384,3.202,0.49,3.13,0.613,3.078C0.735,3.026,0.864,3,1,3h2V1\r\n\tc0-0.135,0.025-0.264,0.078-0.387c0.052-0.122,0.123-0.229,0.215-0.32C3.384,0.202,3.49,0.13,3.613,0.078C3.735,0.026,3.864,0,4,0\r\n\tH15z M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047l1.922,3.234\r\n\tL1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5v3H15z"},{type:"path",className:"OfficeIconColors_m20",d:"M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047\r\n\tl1.922,3.234L1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5\r\n\tv3H15z"},{type:"path",className:"OfficeIconColors_m2194",d:"M15,0c0.135,0,0.264,0.026,0.387,0.078c0.122,0.052,0.229,0.124,0.32,0.215\r\n\tc0.091,0.091,0.162,0.198,0.215,0.32C15.974,0.736,16,0.865,16,1v14c0,0.136-0.026,0.265-0.078,0.387\r\n\tc-0.053,0.122-0.124,0.229-0.215,0.32c-0.092,0.091-0.198,0.163-0.32,0.215C15.264,15.974,15.135,16,15,16H4\r\n\tc-0.136,0-0.265-0.026-0.387-0.078c-0.123-0.052-0.229-0.124-0.32-0.215c-0.092-0.091-0.163-0.198-0.215-0.32\r\n\tC3.025,15.265,3,15.136,3,15v-2H1c-0.136,0-0.265-0.025-0.387-0.078c-0.123-0.052-0.229-0.123-0.32-0.215\r\n\tc-0.092-0.091-0.163-0.197-0.215-0.32C0.025,12.265,0,12.136,0,12V4c0-0.135,0.025-0.264,0.078-0.387\r\n\tc0.052-0.122,0.123-0.229,0.215-0.32C0.384,3.202,0.49,3.13,0.613,3.078C0.735,3.026,0.864,3,1,3h2V1\r\n\tc0-0.135,0.025-0.264,0.078-0.387c0.052-0.122,0.123-0.229,0.215-0.32C3.384,0.202,3.49,0.13,3.613,0.078C3.735,0.026,3.864,0,4,0\r\n\tH15z M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047l1.922,3.234\r\n\tL1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5v3H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ExportPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.953,8.5l-3.602,3.602l-0.703-0.703l2.406-2.414H2v-1h12.031l-2.383-2.383l0.703-0.703L15.953,8.5z M0,12\r\n\th1V5H0V12z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.648,11.398l2.406-2.414L2,8.984v-1l12.031,0l-2.383-2.383l0.703-0.703L15.953,8.5l-3.602,3.602\r\n\tL11.648,11.398z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,12h1V5H0V12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"file_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 0 l 640 640 v 1408 h -1536 v -2048 m 1344 640 l -448 -448 v 448 m 512 1280 v -1152 h -640 v -640 h -640 v 1792 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1088 64 l 640 640 v 1280 h -1408 v -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 0 l 640 640 v 1408 h -1536 v -2048 m 1344 640 l -448 -448 v 448 m 512 1280 v -1152 h -640 v -640 h -640 v 1792 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FitPage_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M14,12h-3v-1h2V9h1V12z M13,5h-2V4h3v3h-1V5z M3,7H2V4h3v1H3V7z M5,12H2\r\n\tV9h1v2h2V12z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m24",d:"M13,7V5h-2V4h3v3H13z M3,5v2H2V4h3v1H3z M14,9v3h-3v-1h2V9H14z M5,11v1H2V9h1v2H5z"}],viewBox:"0 0 16 16"},{type:"svg",id:"FitWidth_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M12.328,8H9V7h3.328l-0.664-0.664l0.672-0.672L14.18,7.5l-1.844,1.836\r\n\tl-0.672-0.672L12.328,8z M3.664,9.336L1.82,7.5l1.844-1.836l0.672,0.672L3.672,7H7v1H3.672l0.664,0.664L3.664,9.336z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m24",d:"M4.336,8.664L3.664,9.336L1.82,7.5l1.844-1.836l0.672,0.672L3.672,7H7v1H3.672L4.336,8.664z M11.664,8.664\r\n\tL12.328,8H9V7h3.328l-0.664-0.664l0.672-0.672L14.18,7.5l-1.844,1.836L11.664,8.664z"}],viewBox:"0 0 16 16"},{type:"svg",id:"FullScreenSizeIcon_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,1v5h-1V2.711L2.711,14H6v1H1v-5h1v3.289L13.289,2H10V1H15z"},{type:"path",className:"OfficeIconColors_m22",d:"M15,1v5h-1V2.711L2.711,14H6v1H1v-5h1v3.289L13.289,2H10V1H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Lightbulb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 2048 h -384 v -128 h 384 m -128 -1918 q 88 6 170 33 q 81 28 152 73 q 71 46 130 106 q 59 61 101 134 q 41 73 64 156 q 23 83 23 172 q 0 70 -10 131 q -11 61 -34 115 q -23 55 -58 105 q -36 50 -86 98 q -39 38 -74 84 q -36 47 -63 100 q -27 53 -43 110 q -16 58 -16 117 v 256 h -640 v -256 q 0 -59 -16 -117 q -16 -57 -43 -110 q -27 -53 -62 -100 q -36 -46 -75 -84 q -50 -48 -85 -98 q -36 -50 -59 -105 q -23 -54 -33 -115 q -11 -61 -11 -131 q 0 -90 25 -176 q 24 -85 68 -160 q 44 -75 106 -138 q 62 -62 137 -107 q 75 -45 161 -70 q 85 -25 177 -25 h 37 q 14 0 29 0 q 14 0 28 2 m 128 1534 h -384 v 128 h 384 m 235 -631 q 40 -38 68 -77 q 28 -39 46 -83 q 18 -43 27 -92 q 8 -48 8 -105 q 0 -112 -45 -212 q -45 -100 -122 -175 q -77 -74 -179 -118 q -103 -43 -217 -43 h -26 q -114 0 -216 43 q -103 44 -180 118 q -77 75 -122 175 q -45 100 -45 212 q 0 57 9 105 q 8 49 26 92 q 18 44 46 83 q 28 39 68 77 q 85 81 141 178 q 55 97 78 197 h 416 q 23 -100 79 -197 q 55 -97 140 -178 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 971 65 q 86 0 167 22 q 80 23 150 63 q 69 41 127 97 q 57 56 99 124 q 41 68 64 145 q 22 78 22 160 q 0 63 -9 118 q -10 55 -30 104 q -21 50 -53 94 q -32 45 -76 88 q -78 75 -127 162 q -49 88 -75 181 l -14 49 v 256 h -514 v -256 l -12 -49 q -23 -94 -74 -181 q -51 -87 -128 -162 q -44 -43 -76 -88 q -32 -44 -52 -94 q -21 -49 -30 -104 q -10 -55 -10 -118 q 0 -120 47 -231 q 47 -110 128 -195 q 80 -85 188 -136 q 107 -50 229 -50 q 8 0 11 1 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 2048 h -384 v -128 h 384 m -128 -1918 q 88 6 170 33 q 81 28 152 73 q 71 46 130 106 q 59 61 101 134 q 41 73 64 156 q 23 83 23 172 q 0 70 -10 131 q -11 61 -34 115 q -23 55 -58 105 q -36 50 -86 98 q -39 38 -74 84 q -36 47 -63 100 q -27 53 -43 110 q -16 58 -16 117 v 256 h -640 v -256 q 0 -59 -16 -117 q -16 -57 -43 -110 q -27 -53 -62 -100 q -36 -46 -75 -84 q -50 -48 -85 -98 q -36 -50 -59 -105 q -23 -54 -33 -115 q -11 -61 -11 -131 q 0 -90 25 -176 q 24 -85 68 -160 q 44 -75 106 -138 q 62 -62 137 -107 q 75 -45 161 -70 q 85 -25 177 -25 h 37 q 14 0 29 0 q 14 0 28 2 m 128 1534 h -384 v 128 h 384 m 235 -631 q 40 -38 68 -77 q 28 -39 46 -83 q 18 -43 27 -92 q 8 -48 8 -105 q 0 -112 -45 -212 q -45 -100 -122 -175 q -77 -74 -179 -118 q -103 -43 -217 -43 h -26 q -114 0 -216 43 q -103 44 -180 118 q -77 75 -122 175 q -45 100 -45 212 q 0 57 9 105 q 8 49 26 92 q 18 44 46 83 q 28 39 68 77 q 85 81 141 178 q 55 97 78 197 h 416 q 23 -100 79 -197 q 55 -97 140 -178 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LineageView_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,10V7H8V5h2V0H5v5h2v2H2v3H0v5h5v-5H3V8h9v2h-2v5h5v-5H13z M6,4V1h3v3H6z M4,11v3H1v-3H4z M14,14h-3v-3h3\r\n\tV14z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,11h3v3H1V11z M11,11v3h3v-3H11z"},{type:"path",className:"OfficeIconColors_m26",d:"M9,4H6V1h3V4z"},{type:"path",className:"OfficeIconColors_m25",d:"M9,1v3H6V1H9 M10,0H5v5h5V0L10,0z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,10V7H8V5H7v2H2v3H0v5h5v-5H3V8h9v2h-2v5h5v-5H13z M4,11v3H1v-3H4z M14,14h-3v-3h3V14z"}],viewBox:"0 0 16 16"},{type:"svg",id:"MobilePhone_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 1792 h -256 v -128 h 256 m 384 -1664 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 1792 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -1024 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1792 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 m 1024 1920 v -1792 h -1024 v 1792 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 516 1988 q -26 0 -45 -19 q -19 -19 -19 -45 v -1792 q 0 -26 19 -45 q 19 -19 45 -19 h 1024 q 26 0 45 19 q 19 19 19 45 v 1792 q 0 26 -19 45 q -19 19 -45 19 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 1792 h -256 v -128 h 256 m 384 -1664 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 1792 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -1024 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1792 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 m 1024 1920 v -1792 h -1024 v 1792 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"MorePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M2,7c0.141,0,0.271,0.026,0.391,0.078C2.51,7.13,2.615,7.203,2.703,7.297C2.797,7.385,2.87,7.49,2.922,7.609\r\n\tC2.974,7.729,3,7.859,3,8S2.974,8.271,2.922,8.391C2.87,8.51,2.797,8.617,2.703,8.711C2.615,8.799,2.51,8.87,2.391,8.922\r\n\tC2.271,8.974,2.141,9,2,9S1.729,8.974,1.609,8.922C1.49,8.87,1.383,8.799,1.289,8.711C1.201,8.617,1.13,8.51,1.078,8.391\r\n\tC1.026,8.271,1,8.141,1,8s0.026-0.271,0.078-0.391C1.13,7.49,1.201,7.385,1.289,7.297C1.383,7.203,1.49,7.13,1.609,7.078\r\n\tC1.729,7.026,1.859,7,2,7z M8,7c0.141,0,0.271,0.026,0.391,0.078C8.51,7.13,8.615,7.203,8.703,7.297\r\n\tC8.797,7.385,8.87,7.49,8.922,7.609C8.974,7.729,9,7.859,9,8S8.974,8.271,8.922,8.391C8.87,8.51,8.797,8.617,8.703,8.711\r\n\tC8.615,8.799,8.51,8.87,8.391,8.922C8.271,8.974,8.141,9,8,9S7.729,8.974,7.609,8.922C7.49,8.87,7.383,8.799,7.289,8.711\r\n\tC7.201,8.617,7.13,8.51,7.078,8.391C7.026,8.271,7,8.141,7,8s0.026-0.271,0.078-0.391C7.13,7.49,7.201,7.385,7.289,7.297\r\n\tC7.383,7.203,7.49,7.13,7.609,7.078C7.729,7.026,7.859,7,8,7z M14,7c0.141,0,0.271,0.026,0.391,0.078\r\n\tc0.12,0.052,0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312C14.974,7.729,15,7.859,15,8s-0.026,0.271-0.078,0.391\r\n\tc-0.052,0.12-0.125,0.227-0.219,0.32c-0.089,0.089-0.193,0.159-0.312,0.211C14.271,8.974,14.141,9,14,9s-0.271-0.026-0.391-0.078\r\n\tc-0.12-0.052-0.227-0.122-0.32-0.211C13.2,8.617,13.13,8.51,13.078,8.391C13.026,8.271,13,8.141,13,8s0.026-0.271,0.078-0.391\r\n\tc0.052-0.12,0.122-0.224,0.211-0.312c0.094-0.094,0.201-0.167,0.32-0.219C13.729,7.026,13.859,7,14,7z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,7c0.141,0,0.271,0.026,0.391,0.078C2.51,7.13,2.615,7.203,2.703,7.297C2.797,7.385,2.87,7.49,2.922,7.609\r\n\tC2.974,7.729,3,7.859,3,8S2.974,8.271,2.922,8.391C2.87,8.51,2.797,8.617,2.703,8.711C2.615,8.799,2.51,8.87,2.391,8.922\r\n\tC2.271,8.974,2.141,9,2,9S1.729,8.974,1.609,8.922C1.49,8.87,1.383,8.799,1.289,8.711C1.201,8.617,1.13,8.51,1.078,8.391\r\n\tC1.026,8.271,1,8.141,1,8s0.026-0.271,0.078-0.391C1.13,7.49,1.201,7.385,1.289,7.297C1.383,7.203,1.49,7.13,1.609,7.078\r\n\tC1.729,7.026,1.859,7,2,7z M8,7c0.141,0,0.271,0.026,0.391,0.078C8.51,7.13,8.615,7.203,8.703,7.297\r\n\tC8.797,7.385,8.87,7.49,8.922,7.609C8.974,7.729,9,7.859,9,8S8.974,8.271,8.922,8.391C8.87,8.51,8.797,8.617,8.703,8.711\r\n\tC8.615,8.799,8.51,8.87,8.391,8.922C8.271,8.974,8.141,9,8,9S7.729,8.974,7.609,8.922C7.49,8.87,7.383,8.799,7.289,8.711\r\n\tC7.201,8.617,7.13,8.51,7.078,8.391C7.026,8.271,7,8.141,7,8s0.026-0.271,0.078-0.391C7.13,7.49,7.201,7.385,7.289,7.297\r\n\tC7.383,7.203,7.49,7.13,7.609,7.078C7.729,7.026,7.859,7,8,7z M14,7c0.141,0,0.271,0.026,0.391,0.078\r\n\tc0.12,0.052,0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312C14.974,7.729,15,7.859,15,8s-0.026,0.271-0.078,0.391\r\n\tc-0.052,0.12-0.125,0.227-0.219,0.32c-0.089,0.089-0.193,0.159-0.312,0.211C14.271,8.974,14.141,9,14,9s-0.271-0.026-0.391-0.078\r\n\tc-0.12-0.052-0.227-0.122-0.32-0.211C13.2,8.617,13.13,8.51,13.078,8.391C13.026,8.271,13,8.141,13,8s0.026-0.271,0.078-0.391\r\n\tc0.052-0.12,0.122-0.224,0.211-0.312c0.094-0.094,0.201-0.167,0.32-0.219C13.729,7.026,13.859,7,14,7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"MultipleUnreadMail_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 256 h 2048 v 1408 h -2048 m 1819 -1280 h -1590 l 795 562 m 896 590 v -1067 l -896 633 l -896 -633 v 1067 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1984 1600 h -1920 v -1280 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 256 h 2048 v 1408 h -2048 m 1819 -1280 h -1590 l 795 562 m 896 590 v -1067 l -896 633 l -896 -633 v 1067 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"NoEditPBI_16x17",children:[{type:"path",d:"M15.1794 0.926893C14.0271 -0.284951 12.1027 -0.309226 10.9203 0.873168L1.54545 \r\n10.2475C1.21763 10.5754 0.990085 10.9899 0.889529 11.4424L0.0119121 15.3923C-0.0251689 \r\n15.5592 0.02559 15.7335 0.146489 15.8544C0.267387 15.9753 0.441665 16.026 0.608549 \r\n15.9889L4.53494 15.1157C5.00237 15.0118 5.43048 14.7767 5.76907 14.4381L6.20707 14.0001C6.09703 \r\n13.6111 6.02873 13.2046 6.00729 12.7857L5.06196 13.731C4.85781 13.9352 4.59969 14.0769 \r\n4.31786 14.1396L1.15855 14.8421L1.86572 11.6593C1.92502 11.3924 2.05921 11.148 2.25254 \r\n10.9547L10.2489 2.95864L13.0416 5.7513L11.7856 7.00729C12.2045 7.02872 12.6111 7.09702 \r\n13.0001 7.20705L15.1271 5.08003C16.2681 3.939 16.2913 2.09631 15.1794 0.926893ZM11.6274 \r\n1.58029C12.4123 0.795384 13.6898 0.811498 14.4547 1.61596C15.1928 2.39225 15.1774 3.61548 \r\n14.42 4.37293L13.7487 5.04418L10.9561 2.25155L11.6274 1.58029ZM7 12.5C7 14.9853 9.01472 \r\n17 11.5 17C13.9853 17 16 14.9853 16 12.5C16 10.0147 13.9853 8 11.5 8C9.01472 8 7 10.0147 \r\n7 12.5ZM8 12.5C8 10.567 9.567 9 11.5 9C12.2862 9 13.0118 9.2592 13.5961 9.69681L8.69681 \r\n14.5961C8.2592 14.0118 8 13.2862 8 12.5ZM11.5 16C10.7138 16 9.9882 15.7408 9.40391 \r\n15.3032L14.3032 10.4039C14.7408 10.9882 15 11.7138 15 12.5C15 14.433 13.433 16 11.5 16Z"},{type:"path",className:"PowerBIIconColors11",d:"M7 12.5C7 14.9853 9.01472 17 11.5 17C13.9853 17 16 14.9853 16 12.5C16 10.0147 \r\n13.9853 8 11.5 8C9.01472 8 7 10.0147 7 12.5ZM8 12.5C8 10.567 9.567 9 11.5 9C12.2862 9 \r\n13.0118 9.2592 13.5961 9.69681L8.69681 14.5961C8.2592 14.0118 8 13.2862 8 12.5ZM11.5 \r\n16C10.7138 16 9.9882 15.7408 9.40391 15.3032L14.3032 10.4039C14.7408 10.9882 15 11.7138 \r\n15 12.5C15 14.433 13.433 16 11.5 16Z"}],viewBox:"0 0 16 17"},{type:"svg",id:"PBIModelingView_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 896 v -512 h -640 v 128 h 384 v 896 h -384 v 128 h 640 v -512 h 896 v 896 h -896 v -256 h -768 v -256 h -384 v -896 h 384 v -256 h 768 v -256 h 896 v 896 m -768 896 h 640 v -384 h -640 m -512 -512 h -640 v 384 h 640 m 512 -512 h 640 v -384 h -640 m 0 896 h 640 v -128 h -640 m 0 -896 h 640 v -128 h -640 m -1152 512 v 128 h 640 v -128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 64 1344 v -768 h 768 v 768 m 384 512 v -768 h 768 v 768 m -768 -1024 v -768 h 768 v 768 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 896 v -512 h -640 v 128 h 384 v 896 h -384 v 128 h 640 v -512 h 896 v 896 h -896 v -256 h -768 v -256 h -384 v -896 h 384 v -256 h 768 v -256 h 896 v 896 m -768 896 h 640 v -384 h -640 m -512 -512 h -640 v 384 h 640 m 512 -512 h 640 v -384 h -640 m 0 896 h 640 v -128 h -640 m 0 -896 h 640 v -128 h -640 m -1152 512 v 128 h 640 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PdfPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14,5V3.289L10.711,0H1v5H0v8h1v3h13v-3h1V5H14z M11,1.711L12.289,3H11V1.711z M2,1h8v3h3v1H2V1z M13,15H2\r\n\tv-2h11V15z M14,12H1V6h13V12z M11,11h-1V7h2.5v1H11v1h1.5v1H11V11z M3,10h0.5c0.208,0,0.404-0.039,0.586-0.117\r\n\ts0.341-0.185,0.477-0.32s0.242-0.294,0.32-0.477S5,8.708,5,8.5S4.961,8.096,4.883,7.914s-0.185-0.341-0.32-0.477\r\n\ts-0.294-0.242-0.477-0.32S3.708,7,3.5,7H2v4h1V10z M3,8h0.5c0.135,0,0.253,0.049,0.352,0.148S4,8.365,4,8.5S3.951,8.753,3.852,8.852\r\n\tS3.635,9,3.5,9H3V8z M7.773,10.844c0.245-0.104,0.458-0.247,0.641-0.43c0.182-0.182,0.326-0.393,0.43-0.633C8.948,9.536,9,9.276,9,9\r\n\tS8.948,8.466,8.844,8.227C8.74,7.982,8.596,7.768,8.414,7.586S8.018,7.26,7.773,7.156C7.534,7.052,7.276,7,7,7H6v4h1\r\n\tC7.276,11,7.534,10.948,7.773,10.844z M7,8c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219\r\n\tC7.797,8.385,7.87,8.49,7.922,8.609S8,8.859,8,9S7.974,9.271,7.922,9.391s-0.125,0.227-0.219,0.32\r\n\tC7.615,9.799,7.51,9.87,7.391,9.922S7.141,10,7,10V8z"},{type:"path",className:"OfficeIconColors_m20",d:"M13,5H2V1h9l2,2V5z M1,6v6h13V6H1z M2,15h11v-2H2V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,5V4h-3V1H2v4H1V0h9.711L14,3.289V5H13z M13,13v2H2v-2H1v3h13v-3H13z M11,3h1.289L11,1.711V3z"},{type:"path",className:"OfficeIconColors_m213",d:"M14,6v6H1V6H14 M15,5H0v8h15V5L15,5z"},{type:"path",className:"OfficeIconColors_m23",d:"M4.562,7.438c-0.135-0.135-0.294-0.242-0.477-0.32S3.708,7,3.5,7H2v4h1v-1h0.5\r\n\tc0.208,0,0.404-0.039,0.586-0.117s0.341-0.185,0.477-0.32s0.242-0.294,0.32-0.477S5,8.708,5,8.5S4.961,8.096,4.883,7.914\r\n\tS4.698,7.573,4.562,7.438z M3.852,8.852C3.753,8.951,3.635,9,3.5,9H3V8h0.5c0.135,0,0.253,0.049,0.352,0.148S4,8.365,4,8.5\r\n\tS3.951,8.753,3.852,8.852z M8.414,7.586C8.232,7.404,8.018,7.26,7.773,7.156C7.534,7.052,7.276,7,7,7H6v4h1\r\n\tc0.276,0,0.534-0.052,0.773-0.156c0.245-0.104,0.458-0.247,0.641-0.43c0.182-0.182,0.326-0.393,0.43-0.633C8.948,9.536,9,9.276,9,9\r\n\tS8.948,8.466,8.844,8.227C8.74,7.982,8.596,7.768,8.414,7.586z M7.922,9.391C7.87,9.51,7.797,9.617,7.703,9.711\r\n\tC7.615,9.799,7.51,9.87,7.391,9.922S7.141,10,7,10V8c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219\r\n\tC7.797,8.385,7.87,8.49,7.922,8.609S8,8.859,8,9S7.974,9.271,7.922,9.391z M11,8v1h1.5v1H11v1h-1V7h2.5v1H11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PinToDashboard_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M10.156,0.453C9.984,0.625,9.826,0.794,9.68,0.961C9.539,1.122,9.419,1.292,9.32,1.469\r\n\ts-0.177,0.37-0.234,0.578C9.034,2.25,9.008,2.479,9.008,2.734c0,0.177,0.016,0.346,0.047,0.508L6.094,6.203\r\n\tc-0.391-0.13-0.799-0.195-1.227-0.195c-0.516,0-1.01,0.096-1.484,0.289C2.914,6.49,2.497,6.768,2.133,7.133L1.781,7.484L4.797,10.5\r\n\tl-4.445,4.438L0,16l1.062-0.352L5.5,11.203l3.016,3.016c0.229-0.229,0.435-0.453,0.617-0.672c0.182-0.224,0.336-0.458,0.461-0.703\r\n\tc0.13-0.245,0.229-0.505,0.297-0.781s0.102-0.583,0.102-0.922c0-0.208-0.016-0.417-0.047-0.625\r\n\tc-0.031-0.208-0.081-0.411-0.148-0.609l2.961-2.961c0.161,0.031,0.331,0.047,0.508,0.047c0.26,0,0.492-0.026,0.695-0.078\r\n\tc0.208-0.057,0.398-0.135,0.57-0.234c0.177-0.099,0.346-0.219,0.508-0.359c0.167-0.146,0.336-0.305,0.508-0.477L10.156,0.453z\r\n\t M13.266,5.992c-0.146,0-0.284-0.016-0.414-0.047c-0.125-0.036-0.255-0.076-0.391-0.117L8.625,9.672\r\n\tc0.052,0.13,0.102,0.253,0.148,0.367c0.047,0.115,0.086,0.232,0.117,0.352c0.036,0.115,0.062,0.234,0.078,0.359\r\n\tC8.99,10.87,9,11,9,11.141C9,11.432,8.956,11.719,8.867,12c-0.089,0.276-0.216,0.534-0.383,0.773L3.227,7.516\r\n\tC3.466,7.349,3.724,7.224,4,7.141c0.281-0.089,0.57-0.133,0.867-0.133c0.141,0,0.271,0.01,0.391,0.031\r\n\tc0.125,0.016,0.245,0.039,0.359,0.07s0.229,0.07,0.344,0.117s0.237,0.096,0.367,0.148l3.844-3.836\r\n\tc-0.042-0.135-0.081-0.266-0.117-0.391c-0.031-0.13-0.047-0.268-0.047-0.414c0-0.286,0.068-0.557,0.203-0.812l3.867,3.867\r\n\tC13.823,5.924,13.552,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m212",d:"M13.266,5.992c0.286,0,0.557-0.068,0.812-0.203l-3.867-3.867c-0.135,0.255-0.203,0.526-0.203,0.812\r\n\tc0,0.146,0.016,0.284,0.047,0.414c0.036,0.125,0.076,0.255,0.117,0.391L6.328,7.375c-0.13-0.052-0.253-0.102-0.367-0.148\r\n\tC5.846,7.18,5.732,7.141,5.617,7.109c-0.115-0.031-0.234-0.055-0.359-0.07c-0.12-0.021-0.25-0.031-0.391-0.031\r\n\tC4.57,7.008,4.281,7.052,4,7.141C3.724,7.224,3.466,7.349,3.227,7.516l5.258,5.258c0.167-0.24,0.294-0.497,0.383-0.773\r\n\tC8.956,11.719,9,11.432,9,11.141C9,11,8.99,10.87,8.969,10.75c-0.016-0.125-0.042-0.245-0.078-0.359\r\n\tc-0.031-0.12-0.07-0.237-0.117-0.352C8.727,9.924,8.677,9.802,8.625,9.672l3.836-3.844c0.135,0.042,0.266,0.081,0.391,0.117\r\n\tC12.982,5.977,13.12,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m210",d:"M1.781,7.484l0.352-0.352C2.497,6.769,2.915,6.49,3.387,6.297c0.472-0.192,0.965-0.289,1.48-0.289\r\n\tc0.427,0,0.836,0.065,1.227,0.195l2.961-2.961C9.023,3.081,9.008,2.912,9.008,2.734c0-0.255,0.027-0.485,0.082-0.691\r\n\tc0.055-0.206,0.132-0.397,0.23-0.574c0.099-0.177,0.22-0.348,0.363-0.512s0.301-0.332,0.473-0.504l5.391,5.391\r\n\tc-0.172,0.172-0.34,0.33-0.504,0.473C14.879,6.46,14.71,6.581,14.535,6.68c-0.175,0.099-0.364,0.176-0.57,0.23\r\n\ts-0.438,0.082-0.699,0.082c-0.177,0-0.347-0.016-0.508-0.047L9.797,9.906c0.067,0.198,0.117,0.401,0.148,0.609\r\n\tc0.031,0.209,0.047,0.417,0.047,0.625c0,0.339-0.034,0.646-0.102,0.922c-0.067,0.276-0.165,0.536-0.293,0.781\r\n\ts-0.282,0.478-0.465,0.699s-0.388,0.446-0.617,0.676L1.781,7.484z M13.266,5.992c0.286,0,0.558-0.067,0.812-0.203l-3.867-3.867\r\n\tc-0.136,0.255-0.203,0.526-0.203,0.812c0,0.146,0.017,0.283,0.051,0.41c0.034,0.128,0.071,0.259,0.113,0.395L6.328,7.375\r\n\tc-0.13-0.052-0.253-0.102-0.367-0.148S5.731,7.141,5.617,7.109S5.384,7.054,5.262,7.035C5.14,7.017,5.008,7.008,4.867,7.008\r\n\tc-0.297,0-0.585,0.043-0.863,0.129S3.466,7.349,3.227,7.516l5.258,5.258c0.167-0.239,0.294-0.499,0.383-0.777S9,11.433,9,11.141\r\n\tC9,11,8.991,10.869,8.973,10.746c-0.019-0.122-0.044-0.242-0.078-0.359s-0.074-0.232-0.121-0.348\r\n\tC8.727,9.925,8.677,9.803,8.625,9.672l3.836-3.844c0.136,0.042,0.267,0.08,0.395,0.113C12.983,5.976,13.12,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m22",d:"M1.062,15.648L5.5,11.203L4.797,10.5l-4.445,4.438L0,16L1.062,15.648z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PowerAutomate_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.576,6.732l-4.667-5.334C10.687,1.145,10.367,1,10.031,1H1.303C0.839,1,0.432,1.262,0.241,1.685\r\n\tS0.12,2.586,0.425,2.935L4.419,7.5l-3.995,4.565c-0.305,0.349-0.375,0.827-0.184,1.25C0.432,13.737,0.839,14,1.303,14h8.728\r\n\tc0.336,0,0.655-0.145,0.878-0.398l4.668-5.333C15.959,7.83,15.959,7.17,15.576,6.732z M1.178,2.276\r\n\tc-0.062-0.07-0.043-0.142-0.026-0.178C1.168,2.062,1.21,2,1.303,2h7.901L5.083,6.739L1.178,2.276z M1.151,12.902\r\n\tc-0.017-0.037-0.035-0.108,0.026-0.179L5.749,7.5L5.748,7.499l4.572-5.257l2.118,2.421L5.026,13H1.303\r\n\tC1.21,13,1.168,12.938,1.151,12.902z M14.824,7.61l-4.667,5.333C10.125,12.979,10.079,13,10.031,13H6.364l6.737-7.579l1.722,1.969\r\n\tC14.879,7.453,14.879,7.547,14.824,7.61z"},{type:"path",className:"OfficeIconColors_m20",d:"M1.303,1.5c-0.27,0-0.496,0.146-0.607,0.391c-0.11,0.245-0.071,0.512,0.105,0.714L5.084,7.5l-4.283,4.895\r\n\tc-0.177,0.202-0.216,0.47-0.105,0.715C0.805,13.351,1.038,13.5,1.303,13.5h8.729c0.192,0,0.375-0.083,0.502-0.229l4.668-5.333\r\n\tc0.218-0.25,0.217-0.627-0.001-0.878l-4.667-5.334C10.406,1.583,10.223,1.5,10.031,1.5H1.303z"},{type:"path",className:"OfficeIconColors_m228",d:"M15.576,6.732l-4.667-5.334C10.687,1.145,10.367,1,10.031,1H1.303C0.839,1,0.432,1.262,0.241,1.685\r\n\tS0.12,2.586,0.425,2.935L4.419,7.5l-3.995,4.565c-0.305,0.349-0.375,0.827-0.184,1.25C0.432,13.737,0.839,14,1.303,14h8.728\r\n\tc0.336,0,0.655-0.145,0.878-0.398l4.668-5.333C15.959,7.83,15.959,7.17,15.576,6.732z M1.178,2.276\r\n\tc-0.062-0.07-0.043-0.142-0.026-0.178C1.168,2.062,1.21,2,1.303,2h7.901L5.083,6.739L1.178,2.276z M1.151,12.902\r\n\tc-0.017-0.037-0.035-0.108,0.026-0.179L5.749,7.5L5.748,7.499l4.572-5.257l2.118,2.421L5.026,13H1.303\r\n\tC1.21,13,1.168,12.938,1.151,12.902z M14.824,7.61l-4.667,5.333C10.125,12.979,10.079,13,10.031,13H6.364l6.737-7.579l1.722,1.969\r\n\tC14.879,7.453,14.879,7.547,14.824,7.61z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PowerPointMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -121 0 -234 -27 q -114 -27 -216 -77 q -102 -50 -190 -121 q -89 -71 -159 -159 h -97 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 97 q 70 -88 159 -159 q 88 -71 190 -121 q 102 -50 216 -77 q 113 -27 234 -27 m 128 384 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 512 h 640 q 0 -113 -26 -218 q -27 -105 -76 -198 q -50 -93 -119 -173 q -70 -79 -155 -140 q -85 -60 -184 -101 q -100 -40 -208 -56 m -128 -11 q -92 0 -178 18 q -87 18 -166 51 q -80 33 -151 80 q -72 48 -133 108 h 628 m -663 1056 h 206 v -271 h 107 q 72 0 130 -23 q 57 -22 97 -61 q 40 -39 62 -92 q 21 -52 21 -113 q 0 -131 -78 -202 q -79 -70 -223 -70 h -322 m 663 1311 q 113 0 218 -27 q 105 -27 198 -76 q 93 -49 173 -119 q 79 -69 140 -155 q 60 -85 101 -184 q 40 -99 56 -207 h -630 v 385 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -752 q 60 59 131 106 q 71 47 150 80 q 79 33 166 51 q 86 18 177 18 m -366 -932 h -91 v -196 h 95 q 36 0 58 8 q 21 8 32 21 q 11 14 15 31 q 3 17 3 35 q 0 52 -26 76 q -27 25 -86 25 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1984 q -109 0 -214 -24 q -105 -24 -201 -70 q -96 -46 -181 -113 q -85 -67 -153 -153 l -19 -24 h -128 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 128 l 19 -24 q 68 -86 153 -153 q 85 -67 181 -113 q 96 -46 201 -70 q 105 -24 214 -24 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"},{type:"path",className:"OfficeIconColors_m2264",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -121 0 -234 -27 q -114 -27 -216 -77 q -102 -50 -190 -121 q -89 -71 -159 -159 h -97 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 97 q 70 -88 159 -159 q 88 -71 190 -121 q 102 -50 216 -77 q 113 -27 234 -27 m 128 384 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 512 h 640 q 0 -113 -26 -218 q -27 -105 -76 -198 q -50 -93 -119 -173 q -70 -79 -155 -140 q -85 -60 -184 -101 q -100 -40 -208 -56 m -128 -11 q -92 0 -178 18 q -87 18 -166 51 q -80 33 -151 80 q -72 48 -133 108 h 628 m -663 1056 h 206 v -271 h 107 q 72 0 130 -23 q 57 -22 97 -61 q 40 -39 62 -92 q 21 -52 21 -113 q 0 -131 -78 -202 q -79 -70 -223 -70 h -322 m 663 1311 q 113 0 218 -27 q 105 -27 198 -76 q 93 -49 173 -119 q 79 -69 140 -155 q 60 -85 101 -184 q 40 -99 56 -207 h -630 v 385 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -752 q 60 59 131 106 q 71 47 150 80 q 79 33 166 51 q 86 18 177 18 m -366 -932 h -91 v -196 h 95 q 36 0 58 8 q 21 8 32 21 q 11 14 15 31 q 3 17 3 35 q 0 52 -26 76 q -27 25 -86 25 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PrintPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,6c0.135,0,0.263,0.026,0.383,0.078c0.125,0.052,0.232,0.125,0.32,0.219\r\n\tc0.094,0.089,0.167,0.195,0.219,0.32C15.974,6.737,16,6.865,16,7v7h-4v2H4v-2H0V7c0-0.135,0.026-0.263,0.078-0.383\r\n\tC0.13,6.492,0.2,6.385,0.289,6.297C0.383,6.203,0.49,6.13,0.609,6.078C0.734,6.026,0.865,6,1,6h3V0h8v6H15z M5,6h6V1H5V6z M11,11H5\r\n\tv4h6V11z M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852S2.635,9,2.5,9\r\n\tS2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"},{type:"path",className:"OfficeIconColors_m21",d:"M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852\r\n\tS2.635,9,2.5,9S2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"},{type:"path",className:"OfficeIconColors_m20",d:"M11,1v5H5V1H11z M5,15h6v-4H5V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M15,6c0.135,0,0.263,0.026,0.383,0.078c0.125,0.052,0.232,0.125,0.32,0.219\r\n\tc0.094,0.089,0.167,0.195,0.219,0.32C15.974,6.737,16,6.865,16,7v7h-4v2H4v-2H0V7c0-0.135,0.026-0.263,0.078-0.383\r\n\tC0.13,6.492,0.2,6.385,0.289,6.297C0.383,6.203,0.49,6.13,0.609,6.078C0.734,6.026,0.865,6,1,6h3V0h8v6H15z M5,6h6V1H5V6z M11,11H5\r\n\tv4h6V11z M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852S2.635,9,2.5,9\r\n\tS2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"}],viewBox:"0 0 16 16"},{type:"svg",id:"QRCode_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M3,5V3h2v2H3z M1,7V1h6v6H1z M2,2v4h4V2H2z M3,13v-2h2v2H3z M1,15V9h6v6H1z M2,10v4h4v-4H2z M13,3v2h-2V3H13\r\n\tz M9,1h6v6H9V1z M14,6V2h-4v4H14z M9,12h1v1H9V12z M11,10h-1v1H9V9h2V10z M13,9v1h-1V9H13z M12,10v2h-2v-1h1v-1H12z M10,13h2v1h-1v1\r\n\tH9v-1h1V13z M12,15v-1h2v1H12z M15,14h-1v-2h1V14z M14,10V9h1v2h-1v1h-1v-2H14z M12,13v-1h1v1H12z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,1h6v6H1V1z M1,15h6V9H1V15z M9,1v6h6V1H9z M9,15h6V9H9V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M3,5V3h2v2H3z M1,7V1h6v6H1z M2,2v4h4V2H2z M3,13v-2h2v2H3z M1,15V9h6v6H1z M2,10v4h4v-4H2z M13,3v2h-2V3H13\r\n\tz M9,1h6v6H9V1z M14,6V2h-4v4H14z M9,12h1v1H9V12z M11,10h-1v1H9V9h2V10z M13,9v1h-1V9H13z M12,10v2h-2v-1h1v-1H12z M10,13h2v1h-1v1\r\n\tH9v-1h1V13z M12,15v-1h2v1H12z M15,14h-1v-2h1V14z M14,10V9h1v2h-1v1h-1v-2H14z M12,13v-1h1v1H12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Save_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -1728 l -320 -320 v -1728 m 512 128 v 640 h 1024 v -640 m -128 1792 v -512 h -768 v 512 m 1280 -1792 h -256 v 768 h -1280 v -768 h -256 v 1547 l 245 245 h 139 v -640 h 1024 v 640 h 384 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1694 909 h -1329 v -850 h 1329 m -143 1917 h -1057 v -716 h 1057 z"},{type:"path",className:"OfficeIconColors_m221",d:"M 1984 64 v 1920 h -497 v -640 h -934 v 640 h -206 l -283 -283 v -1637 h 365 v 776 h 1176 v -776 z"},{type:"path",className:"OfficeIconColors_m220",d:"M 2048 0 v 2048 h -1728 l -320 -320 v -1728 m 512 128 v 640 h 1024 v -640 m -128 1792 v -512 h -768 v 512 m 1280 -1792 h -256 v 768 h -1280 v -768 h -256 v 1547 l 245 245 h 139 v -640 h 1024 v 640 h 384 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"SaveACopy_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M2,9H1.711L1,8.289V1h1v4h6V1h1v4h1V1c0-0.141-0.026-0.271-0.078-0.391C9.87,0.49,9.797,0.385,9.703,0.297\r\n\tC9.615,0.203,9.51,0.13,9.391,0.078C9.271,0.026,9.141,0,9,0H1C0.859,0,0.729,0.026,0.609,0.078C0.49,0.13,0.383,0.203,0.289,0.297\r\n\tC0.201,0.385,0.13,0.49,0.078,0.609C0.026,0.729,0,0.859,0,1v7.711L1.289,10H5V8H4v1H3V7h2V6H2V9z M3,1h4v3H3V1z M15.922,6.609\r\n\tc-0.052-0.119-0.125-0.223-0.219-0.312c-0.088-0.094-0.192-0.167-0.312-0.219S15.141,6,15,6H7C6.859,6,6.729,6.026,6.609,6.078\r\n\tC6.49,6.13,6.383,6.203,6.289,6.297C6.201,6.385,6.13,6.49,6.078,6.609C6.026,6.729,6,6.859,6,7v7.711L7.289,16H16V7\r\n\tC16,6.859,15.974,6.729,15.922,6.609z M9,7h4v3H9V7z M13,15h-2v-1h-1v1H9v-2h4V15z M15,15h-1v-3H8v3H7.711L7,14.289V7h1v4h6V7h1V15z\r\n\t"},{type:"path",className:"OfficeIconColors_m20",d:"M9,5H5v4H1V1h8V5z M14,7h-1H9H8H7v7.289V15h0.711H8h1h1h1h2h1h1V7H14z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,5V1H1v7.289L1.711,9H2V6h3v1H3v2h1V8h1v2H1.289L0,8.711V1c0-0.141,0.026-0.271,0.078-0.391\r\n\tC0.13,0.49,0.201,0.385,0.289,0.297C0.383,0.203,0.49,0.13,0.609,0.078C0.729,0.026,0.859,0,1,0h8c0.141,0,0.271,0.026,0.391,0.078\r\n\tC9.51,0.13,9.615,0.203,9.703,0.297C9.797,0.385,9.87,0.49,9.922,0.609C9.974,0.729,10,0.859,10,1v4H9V1H8v4H2z M3,4h4V1H3V4z"},{type:"path",className:"OfficeIconColors_m219",d:"M15,6c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312\r\n\tC15.974,6.729,16,6.859,16,7v9H7.289L6,14.711V7c0-0.141,0.026-0.271,0.078-0.391C6.13,6.49,6.201,6.385,6.289,6.297\r\n\tC6.383,6.203,6.49,6.13,6.609,6.078C6.729,6.026,6.859,6,7,6H15z M9,7v3h4V7H9z M13,15v-2H9v2h1v-1h1v1H13z M15,7h-1v4H8V7H7v7.289\r\n\tL7.711,15H8v-3h6v3h1V7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SeeRelatedContent_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,5V0h-5v2.562l-6,4V5H0v5h5V8.438l6,4V15h5v-5h-5v1.234L5.398,7.5L11,3.766V5H16z M12,1h3v3h-3V1z M4,9H1\r\n\tV6h3V9z M12,11h3v3h-3V11z"},{type:"path",className:"OfficeIconColors_m26",d:"M1,6h3v3H1V6z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,1v3h-3V1H15z M12,14h3v-3h-3V14z"},{type:"path",className:"OfficeIconColors_m22",d:"M5,6.562l6-4V0h5v5h-5V3.766L5.398,7.5L11,11.234V10h5v5h-5v-2.562l-6-4V6.562z M12,1v3h3V1H12z M12,11v3h3\r\n\tv-3H12z"},{type:"path",className:"OfficeIconColors_m25",d:"M4,6v3H1V6H4 M5,5H0v5h5V5L5,5z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SettingsPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.93,7.719c0,0.047,0,0.094,0,0.141c0.005,0.046,0.008,0.093,0.008,0.14s-0.003,0.094-0.008,0.141\r\n\tc0,0.047,0,0.094,0,0.141l2.023,1.258l-1.242,2.992L12.391,12c-0.125,0.135-0.255,0.266-0.391,0.391l0.531,2.32l-2.992,1.242\r\n\tL8.281,13.93c-0.047,0-0.094,0.003-0.141,0.008c-0.047,0-0.094,0-0.141,0s-0.094,0-0.141,0c-0.047-0.005-0.094-0.008-0.141-0.008\r\n\tl-1.258,2.023l-2.992-1.242L4,12.391C3.865,12.266,3.734,12.135,3.609,12l-2.32,0.531L0.047,9.539L2.07,8.281\r\n\tc0-0.047-0.003-0.094-0.008-0.141c0-0.047,0-0.094,0-0.141s0-0.094,0-0.141C2.068,7.812,2.07,7.766,2.07,7.719L0.047,6.461\r\n\tl1.242-2.992L3.609,4C3.734,3.865,3.865,3.734,4,3.609l-0.531-2.32l2.992-1.242L7.719,2.07c0.047,0,0.094,0,0.141,0\r\n\tC7.906,2.065,7.953,2.062,8,2.062S8.094,2.065,8.141,2.07c0.047,0,0.094,0,0.141,0L9.54,0.047l2.992,1.242L12,3.609\r\n\tC12.135,3.734,12.266,3.865,12.391,4l2.32-0.531l1.242,2.992L13.93,7.719z M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367\r\n\tc0.01-0.125,0.016-0.25,0.016-0.375c0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977\r\n\tc-0.161-0.198-0.328-0.38-0.5-0.547c-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984\r\n\tc-0.12-0.01-0.242-0.021-0.367-0.031C8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016\r\n\tc-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812L4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5\r\n\tc-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156C2.975,7.39,2.964,7.515,2.954,7.64\r\n\tc-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367c0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625\r\n\tl2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547c0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844\r\n\tc0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062c0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031\r\n\tl1.148,1.844l1.625-0.672l-0.492-2.117c0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492\r\n\tl0.672-1.625L13.016,8.734z M8,5.062c0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86\r\n\tc0.156,0.354,0.235,0.734,0.235,1.14s-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93\r\n\tc-0.266,0.266-0.578,0.477-0.937,0.633C8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227\r\n\tc-0.354-0.156-0.664-0.367-0.93-0.633c-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8\r\n\ts0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922c0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z\r\n\t M8,10.062c0.286,0,0.555-0.052,0.805-0.156c0.25-0.109,0.469-0.258,0.656-0.445s0.333-0.406,0.438-0.656\r\n\tc0.109-0.25,0.164-0.518,0.164-0.805s-0.055-0.555-0.164-0.805c-0.104-0.25-0.25-0.469-0.438-0.656S9.055,6.206,8.805,6.102\r\n\tC8.555,5.992,8.286,5.938,8,5.938S7.445,5.992,7.195,6.102c-0.25,0.104-0.469,0.25-0.656,0.438S6.203,6.945,6.094,7.195\r\n\tC5.99,7.445,5.938,7.714,5.938,8c0,0.286,0.052,0.555,0.156,0.805c0.109,0.25,0.258,0.469,0.445,0.656s0.406,0.336,0.656,0.445\r\n\tC7.445,10.01,7.714,10.062,8,10.062z"},{type:"path",className:"OfficeIconColors_m20",d:"M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367c0.01-0.125,0.016-0.25,0.016-0.375\r\n\tc0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977c-0.161-0.198-0.328-0.38-0.5-0.547\r\n\tc-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984c-0.12-0.01-0.242-0.021-0.367-0.031\r\n\tC8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016c-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812\r\n\tL4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5c-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156\r\n\tC2.975,7.39,2.964,7.515,2.954,7.64c-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367\r\n\tc0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625l2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547\r\n\tc0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844c0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062\r\n\tc0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031l1.148,1.844l1.625-0.672l-0.492-2.117\r\n\tc0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492l0.672-1.625L13.016,8.734z M8,5.062\r\n\tc0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86c0.156,0.354,0.235,0.734,0.235,1.14\r\n\ts-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93c-0.266,0.266-0.578,0.477-0.937,0.633\r\n\tC8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227c-0.354-0.156-0.664-0.367-0.93-0.633\r\n\tc-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8s0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922\r\n\tc0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z"},{type:"path",className:"OfficeIconColors_m22",d:"M13.93,7.719c0,0.047,0,0.094,0,0.141c0.005,0.046,0.008,0.093,0.008,0.14s-0.003,0.094-0.008,0.141\r\n\tc0,0.047,0,0.094,0,0.141l2.023,1.258l-1.242,2.992L12.391,12c-0.125,0.135-0.255,0.266-0.391,0.391l0.531,2.32l-2.992,1.242\r\n\tL8.281,13.93c-0.047,0-0.094,0.003-0.141,0.008c-0.047,0-0.094,0-0.141,0s-0.094,0-0.141,0c-0.047-0.005-0.094-0.008-0.141-0.008\r\n\tl-1.258,2.023l-2.992-1.242L4,12.391C3.865,12.266,3.734,12.135,3.609,12l-2.32,0.531L0.047,9.539L2.07,8.281\r\n\tc0-0.047-0.003-0.094-0.008-0.141c0-0.047,0-0.094,0-0.141s0-0.094,0-0.141C2.068,7.812,2.07,7.766,2.07,7.719L0.047,6.461\r\n\tl1.242-2.992L3.609,4C3.734,3.865,3.865,3.734,4,3.609l-0.531-2.32l2.992-1.242L7.719,2.07c0.047,0,0.094,0,0.141,0\r\n\tC7.906,2.065,7.953,2.062,8,2.062S8.094,2.065,8.141,2.07c0.047,0,0.094,0,0.141,0L9.54,0.047l2.992,1.242L12,3.609\r\n\tC12.135,3.734,12.266,3.865,12.391,4l2.32-0.531l1.242,2.992L13.93,7.719z M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367\r\n\tc0.01-0.125,0.016-0.25,0.016-0.375c0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977\r\n\tc-0.161-0.198-0.328-0.38-0.5-0.547c-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984\r\n\tc-0.12-0.01-0.242-0.021-0.367-0.031C8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016\r\n\tc-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812L4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5\r\n\tc-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156C2.975,7.39,2.964,7.515,2.954,7.64\r\n\tc-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367c0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625\r\n\tl2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547c0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844\r\n\tc0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062c0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031\r\n\tl1.148,1.844l1.625-0.672l-0.492-2.117c0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492\r\n\tl0.672-1.625L13.016,8.734z M8,5.062c0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86\r\n\tc0.156,0.354,0.235,0.734,0.235,1.14s-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93\r\n\tc-0.266,0.266-0.578,0.477-0.937,0.633C8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227\r\n\tc-0.354-0.156-0.664-0.367-0.93-0.633c-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8\r\n\ts0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922c0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z\r\n\t M8,10.062c0.286,0,0.555-0.052,0.805-0.156c0.25-0.109,0.469-0.258,0.656-0.445s0.333-0.406,0.438-0.656\r\n\tc0.109-0.25,0.164-0.518,0.164-0.805s-0.055-0.555-0.164-0.805c-0.104-0.25-0.25-0.469-0.438-0.656S9.055,6.206,8.805,6.102\r\n\tC8.555,5.992,8.286,5.938,8,5.938S7.445,5.992,7.195,6.102c-0.25,0.104-0.469,0.25-0.656,0.438S6.203,6.945,6.094,7.195\r\n\tC5.99,7.445,5.938,7.714,5.938,8c0,0.286,0.052,0.555,0.156,0.805c0.109,0.25,0.258,0.469,0.445,0.656s0.406,0.336,0.656,0.445\r\n\tC7.445,10.01,7.714,10.062,8,10.062z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ShareasLink_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"SharePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M11,12l1-1v3H0V4h1v9h10V12z M4.492,9.734C3.956,10.104,3.458,10.526,3,11v-1\r\n\tc0-0.646,0.083-1.266,0.25-1.859c0.167-0.599,0.401-1.156,0.703-1.672C4.26,5.948,4.625,5.477,5.047,5.055\r\n\tc0.427-0.427,0.898-0.792,1.414-1.094C6.982,3.654,7.539,3.417,8.133,3.25C8.732,3.083,9.354,3,10,3V0l5.5,5.5L10,11V8\r\n\tC9.333,8,8.68,8.068,8.039,8.203c-0.635,0.13-1.25,0.326-1.844,0.586C5.602,9.044,5.034,9.359,4.492,9.734z M4.125,8.766\r\n\tC5,8.182,5.935,7.742,6.93,7.445S8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4h-0.211c-0.292,0-0.565,0.003-0.82,0.008\r\n\tC9.714,4.013,9.461,4.031,9.211,4.062c-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266\r\n\tC7.211,4.656,6.789,4.896,6.398,5.188c-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211\r\n\tC4.378,7.831,4.224,8.286,4.125,8.766z"},{type:"path",className:"OfficeIconColors_m26",d:"M10.789,4c-0.292,0-0.565,0.003-0.82,0.008C9.714,4.013,9.461,4.031,9.211,4.062\r\n\tc-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266C7.211,4.656,6.789,4.896,6.398,5.188\r\n\tc-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211C4.378,7.831,4.224,8.286,4.125,8.766\r\n\tC5,8.182,5.935,7.742,6.93,7.445C7.924,7.148,8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4H10.789z"},{type:"path",className:"OfficeIconColors_m22",d:"M11,12l1-1v3H0V4h1v9h10V12z"},{type:"path",className:"OfficeIconColors_m25",d:"M10,8C9.333,8,8.68,8.068,8.039,8.203c-0.635,0.13-1.25,0.326-1.844,0.586\r\n\tc-0.594,0.255-1.161,0.57-1.703,0.945C3.956,10.104,3.458,10.526,3,11v-1c0-0.646,0.083-1.266,0.25-1.859\r\n\tc0.167-0.599,0.401-1.156,0.703-1.672C4.26,5.948,4.625,5.477,5.047,5.055c0.427-0.427,0.898-0.792,1.414-1.094\r\n\tC6.982,3.654,7.539,3.417,8.133,3.25C8.732,3.083,9.354,3,10,3V0l5.5,5.5L10,11V8z M10.789,4c-0.292,0-0.565,0.003-0.82,0.008\r\n\tC9.714,4.013,9.461,4.031,9.211,4.062c-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266\r\n\tC7.211,4.656,6.789,4.896,6.398,5.188c-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211\r\n\tC4.378,7.831,4.224,8.286,4.125,8.766C5,8.182,5.935,7.742,6.93,7.445C7.924,7.148,8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4\r\n\tH10.789z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SharePointMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1567 641 q 100 6 188 48 q 88 42 153 111 q 65 69 103 159 q 37 91 37 193 q 0 106 -40 199 q -40 94 -109 163 q -70 70 -163 110 q -94 40 -200 40 q -25 0 -49 -3 q -25 -2 -48 -6 q -5 82 -39 153 q -34 72 -90 125 q -56 54 -129 84 q -74 31 -157 31 q -82 0 -154 -30 q -73 -30 -129 -82 q -56 -52 -91 -122 q -35 -70 -41 -150 h -481 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 267 q 33 -84 90 -155 q 56 -70 130 -121 q 73 -51 161 -80 q 88 -28 184 -28 q 126 0 237 48 q 110 48 193 130 q 82 83 130 193 q 48 111 48 237 q 0 9 0 17 q 0 8 -1 16 m -607 -513 q -69 0 -132 18 q -64 19 -119 53 q -55 34 -99 81 q -44 47 -74 104 h 616 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 196 q 73 -42 157 -59 q 2 -10 3 -20 q 0 -10 0 -21 q 0 -99 -37 -187 q -38 -87 -103 -153 q -66 -65 -153 -103 q -88 -37 -187 -37 m -480 1327 q 66 12 142 12 q 69 0 129 -15 q 60 -15 105 -47 q 45 -31 71 -81 q 25 -49 25 -117 q 0 -74 -29 -125 q -29 -50 -81 -84 q -59 -37 -109 -59 q -51 -22 -89 -38 q -38 -15 -59 -31 q -22 -15 -22 -39 q 0 -13 10 -24 q 9 -11 26 -20 q 16 -8 38 -13 q 22 -4 48 -4 q 49 0 98 12 q 49 12 84 35 l 49 32 v -228 l -20 -8 q -79 -32 -214 -32 q -72 0 -134 17 q -63 17 -109 50 q -46 33 -72 81 q -27 49 -27 111 q 0 48 14 85 q 13 37 40 67 q 27 31 68 57 q 41 26 96 50 q 85 35 128 60 q 43 25 43 56 q 0 33 -30 48 q -31 15 -88 15 q -25 0 -55 -5 q -30 -5 -59 -15 q -30 -9 -57 -22 q -27 -13 -47 -28 l -51 -39 v 241 l 18 9 q 25 13 56 21 q 30 8 64 15 m 544 465 q 60 0 113 -23 q 52 -22 91 -61 q 39 -39 62 -92 q 22 -52 22 -112 q 0 -35 -9 -69 q -9 -33 -23 -62 v 35 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -414 q 6 54 31 101 q 24 47 63 81 q 38 35 87 54 q 49 20 105 20 m 512 -384 q 79 0 149 -31 q 70 -30 122 -82 q 52 -52 83 -122 q 30 -70 30 -149 q 0 -79 -30 -149 q -31 -69 -83 -122 q -53 -52 -122 -83 q -70 -30 -149 -30 q -74 0 -139 26 q -66 27 -117 73 v 438 q 51 40 88 94 q 37 54 55 119 q 54 18 113 18 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1984 q -69 0 -130 -25 q -62 -25 -109 -69 q -47 -44 -76 -104 q -30 -59 -36 -127 l -5 -59 h -540 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 310 l 16 -40 q 31 -78 83 -142 q 51 -63 117 -108 q 66 -45 144 -70 q 78 -24 162 -24 q 112 0 212 43 q 99 43 173 116 q 73 74 116 173 q 43 100 43 212 q 0 7 0 13 q 0 6 -1 13 l -7 67 l 67 4 q 88 5 165 42 q 77 37 134 97 q 57 61 90 140 q 32 79 32 168 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 q -23 0 -44 -2 q -22 -2 -43 -6 l -70 -12 l -4 72 q -4 70 -33 130 q -29 61 -76 106 q -48 45 -110 70 q -62 26 -132 26 z"},{type:"path",className:"OfficeIconColors_m2268",d:"M 1567 641 q 100 6 188 48 q 88 42 153 111 q 65 69 103 159 q 37 91 37 193 q 0 106 -40 199 q -40 94 -109 163 q -70 70 -163 110 q -94 40 -200 40 q -25 0 -49 -3 q -25 -2 -48 -6 q -5 82 -39 153 q -34 72 -90 125 q -56 54 -129 84 q -74 31 -157 31 q -82 0 -154 -30 q -73 -30 -129 -82 q -56 -52 -91 -122 q -35 -70 -41 -150 h -481 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 267 q 33 -84 90 -155 q 56 -70 130 -121 q 73 -51 161 -80 q 88 -28 184 -28 q 126 0 237 48 q 110 48 193 130 q 82 83 130 193 q 48 111 48 237 q 0 9 0 17 q 0 8 -1 16 m -607 -513 q -69 0 -132 18 q -64 19 -119 53 q -55 34 -99 81 q -44 47 -74 104 h 616 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 196 q 73 -42 157 -59 q 2 -10 3 -20 q 0 -10 0 -21 q 0 -99 -37 -187 q -38 -87 -103 -153 q -66 -65 -153 -103 q -88 -37 -187 -37 m -480 1327 q 66 12 142 12 q 69 0 129 -15 q 60 -15 105 -47 q 45 -31 71 -81 q 25 -49 25 -117 q 0 -74 -29 -125 q -29 -50 -81 -84 q -59 -37 -109 -59 q -51 -22 -89 -38 q -38 -15 -59 -31 q -22 -15 -22 -39 q 0 -13 10 -24 q 9 -11 26 -20 q 16 -8 38 -13 q 22 -4 48 -4 q 49 0 98 12 q 49 12 84 35 l 49 32 v -228 l -20 -8 q -79 -32 -214 -32 q -72 0 -134 17 q -63 17 -109 50 q -46 33 -72 81 q -27 49 -27 111 q 0 48 14 85 q 13 37 40 67 q 27 31 68 57 q 41 26 96 50 q 85 35 128 60 q 43 25 43 56 q 0 33 -30 48 q -31 15 -88 15 q -25 0 -55 -5 q -30 -5 -59 -15 q -30 -9 -57 -22 q -27 -13 -47 -28 l -51 -39 v 241 l 18 9 q 25 13 56 21 q 30 8 64 15 m 544 465 q 60 0 113 -23 q 52 -22 91 -61 q 39 -39 62 -92 q 22 -52 22 -112 q 0 -35 -9 -69 q -9 -33 -23 -62 v 35 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -414 q 6 54 31 101 q 24 47 63 81 q 38 35 87 54 q 49 20 105 20 m 512 -384 q 79 0 149 -31 q 70 -30 122 -82 q 52 -52 83 -122 q 30 -70 30 -149 q 0 -79 -30 -149 q -31 -69 -83 -122 q -53 -52 -122 -83 q -70 -30 -149 -30 q -74 0 -139 26 q -66 27 -117 73 v 438 q 51 40 88 94 q 37 54 55 119 q 54 18 113 18 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ShareReport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,3v10h5.352c-0.073-0.156-0.135-0.318-0.188-0.484C5.112,12.344,5.073,12.172,5.047,12H1V4.555l7,3.508\r\n\tl7-3.508v5.75c0.188,0.089,0.365,0.195,0.531,0.32c0.167,0.12,0.323,0.255,0.469,0.406V3H0z M8,6.938L2.117,4h11.766L8,6.938z\r\n\t M7.117,10.914C7.039,11.096,7,11.292,7,11.5c0,0.167,0.026,0.326,0.078,0.477c0.052,0.146,0.122,0.281,0.211,0.406\r\n\tc0.094,0.125,0.206,0.234,0.336,0.328c0.13,0.094,0.273,0.167,0.43,0.219c-0.016,0.094-0.029,0.19-0.039,0.289\r\n\tC8.005,13.312,8,13.406,8,13.5c0,0.073,0.005,0.148,0.016,0.227c0.01,0.078,0.021,0.154,0.031,0.227\r\n\tc-0.297-0.052-0.57-0.151-0.82-0.297c-0.25-0.151-0.466-0.336-0.648-0.555c-0.182-0.219-0.326-0.464-0.43-0.734\r\n\tC6.049,12.091,6,11.802,6,11.5c0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.307-0.565,0.531-0.789\r\n\tc0.229-0.229,0.495-0.409,0.797-0.539C7.831,9.068,8.156,9,8.5,9h2c0.344,0,0.667,0.068,0.969,0.203\r\n\tc0.302,0.13,0.565,0.31,0.789,0.539c0.229,0.224,0.409,0.487,0.539,0.789C12.932,10.833,13,11.156,13,11.5\r\n\tc0,0.297-0.049,0.581-0.148,0.852c-0.099,0.271-0.237,0.516-0.414,0.734c-0.177,0.214-0.388,0.396-0.633,0.547\r\n\tc-0.245,0.151-0.513,0.255-0.805,0.312v-1.039c0.146-0.052,0.281-0.125,0.406-0.219s0.229-0.201,0.313-0.32\r\n\tc0.089-0.125,0.156-0.26,0.203-0.406C11.974,11.81,12,11.656,12,11.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C10.904,10.039,10.708,10,10.5,10h-2\r\n\tc-0.208,0-0.404,0.039-0.586,0.117c-0.182,0.078-0.341,0.185-0.477,0.32S7.195,10.732,7.117,10.914z M15.844,12.617\r\n\tC15.948,12.888,16,13.174,16,13.477c0,0.344-0.065,0.669-0.195,0.977c-0.13,0.302-0.31,0.57-0.539,0.805\r\n\tc-0.224,0.229-0.49,0.411-0.797,0.547C14.167,15.935,13.844,16,13.5,16h-2c-0.344,0-0.669-0.065-0.977-0.195\r\n\tc-0.302-0.135-0.568-0.318-0.797-0.547c-0.224-0.234-0.401-0.503-0.531-0.805C9.065,14.146,9,13.82,9,13.477\r\n\tc0-0.297,0.049-0.581,0.148-0.852s0.237-0.516,0.414-0.734c0.177-0.224,0.388-0.411,0.633-0.562c0.245-0.156,0.513-0.263,0.805-0.32\r\n\tv1.039c-0.151,0.052-0.289,0.128-0.414,0.227c-0.12,0.094-0.224,0.206-0.312,0.336c-0.083,0.125-0.151,0.263-0.203,0.414\r\n\tC10.023,13.169,10,13.32,10,13.477c0,0.203,0.039,0.398,0.117,0.586c0.078,0.182,0.185,0.344,0.32,0.484\r\n\tc0.135,0.141,0.294,0.253,0.477,0.336C11.096,14.961,11.292,15,11.5,15h2c0.208,0,0.404-0.039,0.586-0.117\r\n\tc0.182-0.083,0.341-0.195,0.477-0.336c0.135-0.141,0.242-0.302,0.32-0.484C14.961,13.875,15,13.68,15,13.477\r\n\tc0-0.161-0.026-0.318-0.078-0.469c-0.052-0.156-0.125-0.297-0.219-0.422c-0.089-0.13-0.198-0.242-0.328-0.336\r\n\tc-0.13-0.099-0.273-0.172-0.43-0.219c0.016-0.094,0.029-0.187,0.039-0.281C13.995,11.651,14,11.555,14,11.461\r\n\tc0-0.073-0.005-0.148-0.016-0.227c-0.01-0.078-0.021-0.154-0.031-0.227c0.297,0.057,0.57,0.161,0.82,0.312\r\n\tc0.25,0.151,0.466,0.336,0.648,0.555C15.604,12.094,15.745,12.341,15.844,12.617z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,4.555l6.958,3.487C6.283,8.302,5,9.751,5,11.5c0,0.17,0.012,0.337,0.035,0.5H1V4.555z M8.073,8.026\r\n\tC8.213,8.009,8.356,8,8.5,8h2c1.398,0,2.604,0.819,3.165,2.004c0.476,0.022,0.927,0.139,1.335,0.333V4.555L8.073,8.026z M2.117,4\r\n\tL8,6.938L13.883,4H2.117z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,3v8.031c-0.146-0.151-0.302-0.286-0.469-0.406c-0.167-0.125-0.344-0.232-0.531-0.32v-5.75L8,8.062\r\n\tL1,4.555V12h4.047c0.026,0.172,0.065,0.344,0.117,0.516C5.216,12.682,5.279,12.844,5.352,13H0V3H16z M8,6.938L13.883,4H2.117\r\n\tL8,6.938z"},{type:"path",className:"OfficeIconColors_m23",d:"M8.5,10c-0.208,0-0.404,0.039-0.586,0.117c-0.182,0.078-0.341,0.185-0.477,0.32s-0.242,0.294-0.32,0.477\r\n\tC7.039,11.096,7,11.292,7,11.5c0,0.167,0.026,0.325,0.078,0.477c0.052,0.146,0.122,0.281,0.211,0.406\r\n\tc0.094,0.125,0.206,0.234,0.336,0.328c0.13,0.094,0.273,0.167,0.43,0.219c-0.016,0.094-0.029,0.19-0.039,0.289\r\n\tC8.005,13.312,8,13.406,8,13.5c0,0.073,0.005,0.148,0.016,0.227c0.01,0.078,0.021,0.154,0.031,0.227\r\n\tc-0.297-0.052-0.57-0.151-0.82-0.297c-0.25-0.151-0.466-0.336-0.648-0.555c-0.182-0.219-0.326-0.464-0.43-0.734\r\n\tC6.049,12.091,6,11.802,6,11.5c0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.307-0.565,0.531-0.789\r\n\tc0.229-0.229,0.495-0.409,0.797-0.539C7.831,9.068,8.156,9,8.5,9h2c0.344,0,0.667,0.068,0.969,0.203\r\n\tc0.302,0.13,0.565,0.31,0.789,0.539c0.229,0.224,0.409,0.487,0.539,0.789C12.932,10.833,13,11.156,13,11.5\r\n\tc0,0.297-0.05,0.581-0.148,0.852c-0.099,0.271-0.237,0.516-0.414,0.734c-0.177,0.214-0.388,0.396-0.633,0.547\r\n\tc-0.245,0.151-0.513,0.255-0.805,0.312v-1.039c0.146-0.052,0.281-0.125,0.406-0.219s0.229-0.2,0.313-0.32\r\n\tc0.089-0.125,0.156-0.26,0.203-0.406C11.974,11.81,12,11.656,12,11.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C10.904,10.039,10.708,10,10.5,10H8.5z M13.953,11.008\r\n\tc0.297,0.057,0.57,0.161,0.82,0.312c0.25,0.151,0.466,0.336,0.648,0.555c0.182,0.219,0.323,0.466,0.422,0.742\r\n\tC15.948,12.888,16,13.175,16,13.477c0,0.344-0.065,0.669-0.195,0.977c-0.13,0.302-0.31,0.57-0.539,0.805\r\n\tc-0.224,0.229-0.49,0.411-0.797,0.547C14.167,15.935,13.844,16,13.5,16h-2c-0.344,0-0.669-0.065-0.977-0.195\r\n\tc-0.302-0.135-0.568-0.318-0.797-0.547c-0.224-0.234-0.401-0.503-0.531-0.805C9.065,14.146,9,13.82,9,13.477\r\n\tc0-0.297,0.049-0.581,0.148-0.852s0.237-0.516,0.414-0.734c0.177-0.224,0.388-0.411,0.633-0.562c0.245-0.156,0.513-0.263,0.805-0.32\r\n\tv1.039c-0.151,0.052-0.289,0.128-0.414,0.227c-0.12,0.094-0.224,0.206-0.312,0.336c-0.083,0.125-0.151,0.263-0.203,0.414\r\n\tC10.023,13.169,10,13.32,10,13.477c0,0.203,0.039,0.398,0.117,0.586c0.078,0.182,0.185,0.344,0.32,0.484\r\n\tc0.135,0.141,0.294,0.253,0.477,0.336C11.096,14.961,11.292,15,11.5,15h2c0.208,0,0.404-0.039,0.586-0.117\r\n\tc0.182-0.083,0.341-0.195,0.477-0.336c0.135-0.141,0.242-0.302,0.32-0.484C14.961,13.875,15,13.68,15,13.477\r\n\tc0-0.161-0.026-0.318-0.078-0.469c-0.052-0.156-0.125-0.297-0.219-0.422c-0.089-0.13-0.198-0.242-0.328-0.336\r\n\tc-0.13-0.099-0.273-0.172-0.43-0.219c0.016-0.094,0.029-0.187,0.039-0.281C13.995,11.651,14,11.555,14,11.461\r\n\tc0-0.073-0.005-0.148-0.016-0.227C13.974,11.156,13.964,11.081,13.953,11.008z"}],viewBox:"0 0 16 16"},{type:"svg",id:"TeamsMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1792 640 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 q 0 -53 20 -100 q 20 -46 55 -81 q 35 -35 82 -55 q 46 -20 99 -20 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 99 q -20 47 -55 82 q -35 35 -81 55 q -47 20 -100 20 m 0 -384 q -27 0 -50 10 q -23 10 -40 27 q -18 18 -28 41 q -10 23 -10 50 q 0 27 10 50 q 10 23 28 40 q 17 18 40 28 q 23 10 50 10 q 27 0 50 -10 q 23 -10 41 -28 q 17 -17 27 -40 q 10 -23 10 -50 q 0 -27 -10 -50 q -10 -23 -27 -41 q -18 -17 -41 -27 q -23 -10 -50 -10 m 151 512 q 22 0 41 8 q 19 9 33 23 q 14 14 23 33 q 8 19 8 41 v 521 q 0 72 -27 136 q -28 64 -75 111 q -48 47 -112 74 q -64 28 -136 28 q -52 0 -95 -13 q -36 71 -89 129 q -53 59 -119 101 q -67 42 -145 65 q -78 23 -162 23 q -94 0 -179 -29 q -86 -28 -157 -79 q -71 -51 -124 -122 q -53 -70 -83 -154 h -417 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 640 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 122 82 q 52 53 82 123 q 30 70 30 149 q 0 63 -19 120 q -19 57 -52 104 q -34 47 -81 82 q -47 36 -103 56 v 22 h 279 h 8 m -415 -640 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 h 256 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 94 q 57 -34 93 -92 q 35 -58 35 -130 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 m 384 768 h -256 v 640 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -469 q 27 57 69 104 q 41 47 94 80 q 52 34 114 53 q 61 19 128 19 q 93 0 175 -36 q 81 -35 142 -96 q 60 -60 96 -142 q 35 -81 35 -174 m 384 -576 h -256 v 576 q 0 68 -17 138 q 28 5 51 5 q 46 0 87 -18 q 40 -17 70 -47 q 30 -30 48 -70 q 17 -40 17 -86 m -1120 46 v -640 h 256 v -192 h -704 v 192 h 256 v 640 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1088 1984 q -81 0 -156 -25 q -76 -24 -139 -69 q -64 -45 -112 -108 q -49 -62 -76 -139 l -15 -43 h -462 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 704 v -64 q 0 -66 25 -125 q 25 -58 69 -102 q 43 -43 102 -68 q 58 -25 124 -25 q 66 0 125 25 q 58 25 102 68 q 43 44 68 102 q 25 59 25 125 q 0 51 -15 98 q -16 47 -44 87 q -28 40 -67 70 q -39 31 -87 47 l -43 15 v 131 h 727 q 17 0 29 12 q 12 12 12 29 v 521 q 0 59 -22 111 q -23 52 -62 90 q -39 39 -91 61 q -52 23 -111 23 q -20 0 -39 -2 q -19 -2 -39 -8 l -50 -15 l -24 47 q -33 66 -81 118 q -49 53 -108 89 q -59 37 -127 56 q -69 20 -142 20 m 704 -1408 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 z"},{type:"path",className:"OfficeIconColors_m2267",d:"M 1792 640 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 q 0 -53 20 -100 q 20 -46 55 -81 q 35 -35 82 -55 q 46 -20 99 -20 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 99 q -20 47 -55 82 q -35 35 -81 55 q -47 20 -100 20 m 0 -384 q -27 0 -50 10 q -23 10 -40 27 q -18 18 -28 41 q -10 23 -10 50 q 0 27 10 50 q 10 23 28 40 q 17 18 40 28 q 23 10 50 10 q 27 0 50 -10 q 23 -10 41 -28 q 17 -17 27 -40 q 10 -23 10 -50 q 0 -27 -10 -50 q -10 -23 -27 -41 q -18 -17 -41 -27 q -23 -10 -50 -10 m 151 512 q 22 0 41 8 q 19 9 33 23 q 14 14 23 33 q 8 19 8 41 v 521 q 0 72 -27 136 q -28 64 -75 111 q -48 47 -112 74 q -64 28 -136 28 q -52 0 -95 -13 q -36 71 -89 129 q -53 59 -119 101 q -67 42 -145 65 q -78 23 -162 23 q -94 0 -179 -29 q -86 -28 -157 -79 q -71 -51 -124 -122 q -53 -70 -83 -154 h -417 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 640 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 122 82 q 52 53 82 123 q 30 70 30 149 q 0 63 -19 120 q -19 57 -52 104 q -34 47 -81 82 q -47 36 -103 56 v 22 h 279 h 8 m -415 -640 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 h 256 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 94 q 57 -34 93 -92 q 35 -58 35 -130 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 m 384 768 h -256 v 640 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -469 q 27 57 69 104 q 41 47 94 80 q 52 34 114 53 q 61 19 128 19 q 93 0 175 -36 q 81 -35 142 -96 q 60 -60 96 -142 q 35 -81 35 -174 m 384 -576 h -256 v 576 q 0 68 -17 138 q 28 5 51 5 q 46 0 87 -18 q 40 -17 70 -47 q 30 -30 48 -70 q 17 -40 17 -86 m -1120 46 v -640 h 256 v -192 h -704 v 192 h 256 v 640 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"UsageMetrics_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14,7h1v9h-1V7z M4,10.5l1-1V16H4V10.5z M2,12.5l1-1V16H2V12.5z M6,8.5l1-1V16H6V8.5z M8,7.5l1,1v7.492H8\r\n\tV7.5z M10.5,10L11,9.5V16h-1V9.5L10.5,10z M12,8.5l1-1V16h-1V8.5z M0,14.5l1-1V16H0V14.5z M16,2v4h-1V3.711l-4.5,4.492l-3-3\r\n\tL0,12.711v-1.422l7.5-7.492l3,3L14.289,3H12V2H16z"},{type:"path",className:"OfficeIconColors_m22",d:"M14,7h1v9h-1V7z M4,10.5l1-1V16H4V10.5z M2,12.5l1-1V16H2V12.5z M6,8.5l1-1V16H6V8.5z M8,7.5l1,1v7.492H8\r\n\tV7.5z M10.5,10L11,9.5V16h-1V9.5L10.5,10z M12,8.5l1-1V16h-1V8.5z M0,14.5l1-1V16H0V14.5z M16,2v4h-1V3.711l-4.5,4.492l-3-3\r\n\tL0,12.711v-1.422l7.5-7.492l3,3L14.289,3H12V2H16z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ViewPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14.75,2c0.172,0,0.333,0.034,0.484,0.102c0.151,0.062,0.284,0.151,0.398,0.266\r\n\tc0.115,0.115,0.203,0.247,0.266,0.398C15.966,2.917,16,3.078,16,3.25v9.5c0,0.172-0.034,0.333-0.102,0.484\r\n\tc-0.062,0.151-0.151,0.284-0.266,0.398s-0.247,0.206-0.398,0.273C15.083,13.969,14.922,14,14.75,14H1.25\r\n\tc-0.172,0-0.333-0.031-0.484-0.094c-0.151-0.068-0.284-0.159-0.398-0.273c-0.115-0.115-0.206-0.247-0.273-0.398\r\n\tC0.031,13.083,0,12.922,0,12.75v-9.5c0-0.172,0.031-0.333,0.094-0.484c0.068-0.151,0.159-0.284,0.273-0.398\r\n\tc0.115-0.115,0.247-0.203,0.398-0.266C0.917,2.034,1.078,2,1.25,2H14.75z M15,3.25c0-0.073-0.023-0.133-0.07-0.18\r\n\tC14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07C1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18\r\n\tC1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07S15,12.823,15,12.75V3.25z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,3.25c0-0.073-0.023-0.133-0.07-0.18C14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07\r\n\tC1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18C1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07\r\n\tS15,12.823,15,12.75V3.25z"},{type:"path",className:"OfficeIconColors_m22",d:"M14.75,2c0.172,0,0.333,0.034,0.484,0.102c0.151,0.062,0.284,0.151,0.398,0.266\r\n\tc0.115,0.115,0.203,0.247,0.266,0.398C15.966,2.917,16,3.078,16,3.25v9.5c0,0.172-0.034,0.333-0.102,0.484\r\n\tc-0.062,0.151-0.151,0.284-0.266,0.398s-0.247,0.206-0.398,0.273C15.083,13.969,14.922,14,14.75,14H1.25\r\n\tc-0.172,0-0.333-0.031-0.484-0.094c-0.151-0.068-0.284-0.159-0.398-0.273c-0.115-0.115-0.206-0.247-0.273-0.398\r\n\tC0.031,13.083,0,12.922,0,12.75v-9.5c0-0.172,0.031-0.333,0.094-0.484c0.068-0.151,0.159-0.284,0.273-0.398\r\n\tc0.115-0.115,0.247-0.203,0.398-0.266C0.917,2.034,1.078,2,1.25,2H14.75z M15,3.25c0-0.073-0.023-0.133-0.07-0.18\r\n\tC14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07C1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18\r\n\tC1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07S15,12.823,15,12.75V3.25z"}],viewBox:"0 0 16 16"},{type:"svg",id:"WebPublish_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,1v13h12v-1H1V5h14v4h1V1H0z M15,4H1V2h14V4z M13.5,8.797l2.5,2.492L15.289,12L14,10.711V16h-1v-5.289\r\n\tL11.711,12L11,11.289L13.5,8.797z"},{type:"path",className:"OfficeIconColors_m21",d:"M1,2h14v2H1V2z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,5H1v8h10.297l-1.712-1.712L13.5,7.385L15,8.88V5z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,1v8h-1V5H1v8h11v1H0V1H16z M15,2H1v2h14V2z"},{type:"path",className:"OfficeIconColors_m24",d:"M13.5,8.797l2.5,2.492L15.289,12L14,10.711V16h-1v-5.289L11.711,12L11,11.289L13.5,8.797z"}],viewBox:"0 0 16 16"},{type:"svg",id:"CodeEdit_16",children:[{type:"path",className:"OfficeIconColors_m20",d:"M11.8359 4.94531C11.9453 4.83594 12 4.70312 12 4.54688C12 4.38542 11.9453 4.25521 11.8359 4.15625C11.7318 4.05208 11.599 4 11.4375 4C11.3646 4 11.2943 4.01302 11.2266 4.03906C11.1589 4.0599 11.099 4.09635 11.0469 4.14844L5.64062 9.57031L5.375 10.625L6.42969 10.3594L11.8359 4.94531Z"},{type:"path",className:"OfficeIconColors_m22",d:"M1.71094 8L3.3125 9.60156L3.02344 10.7344L0.289062 8L3.64844 4.64844L4.35156 5.35156L1.71094 8ZM15.7109 8L12.3516 11.3516L11.6484 10.6484L14.2891 8L13.125 6.83594C13.2604 6.70052 13.3828 6.57552 13.4922 6.46094C13.6016 6.34115 13.7005 6.21615 13.7891 6.08594L15.7109 8Z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.4375 3C11.6562 3 11.8594 3.03906 12.0469 3.11719C12.2396 3.19531 12.4062 3.30469 12.5469 3.44531C12.6875 3.58594 12.7969 3.75 12.875 3.9375C12.9583 4.125 13 4.32812 13 4.54688C13 4.75 12.9609 4.94792 12.8828 5.14062C12.8047 5.33333 12.6927 5.5026 12.5469 5.64844L6.94531 11.2656L4 12L4.73438 9.05469L10.3359 3.44531C10.4818 3.29948 10.651 3.1901 10.8438 3.11719C11.0365 3.03906 11.2344 3 11.4375 3ZM11.8359 4.94531C11.9453 4.83594 12 4.70312 12 4.54688C12 4.38542 11.9453 4.25521 11.8359 4.15625C11.7318 4.05208 11.599 4 11.4375 4C11.3646 4 11.2943 4.01302 11.2266 4.03906C11.1589 4.0599 11.099 4.09635 11.0469 4.14844L5.64062 9.57031L5.375 10.625L6.42969 10.3594L11.8359 4.94531Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"AddAPlace_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1024 h -896 v 896 h -128 v -896 h -896 v -128 h 896 v -896 h 128 v 896 h 896 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1920 1024 h -896 v 896 h -128 v -896 h -896 v -128 h 896 v -896 h 128 v 896 h 896 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessNewTable_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 2048 v 2048 h -2048 m 128 -1920 v 256 h 1792 v -256 m -1280 1280 v -384 h -512 v 384 m 640 -384 v 384 h 512 v -384 m 0 512 h -512 v 384 h 512 m -512 -1024 h 512 v -384 h -512 m 640 512 v 384 h 512 v -384 m -512 -128 h 512 v -384 h -512 m -768 0 h -512 v 384 h 512 m -512 640 v 384 h 512 v -384 m 768 384 h 512 v -384 h -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 64 1984 v -1920 h 1920 v 1920 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 64 448 v -384 h 1920 v 384 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1984 1024 h -576 v 384 h 576 v 128 h -576 v 448 h -128 v -448 h -512 v 448 h -128 v -448 h -576 v -128 h 576 v -384 h -576 v -128 h 576 v -448 h 128 v 448 h 512 v -448 h 128 v 448 h 576 m -704 512 v -384 h -512 v 384 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 0 h 2048 v 2048 h -2048 m 1920 -128 v -1408 h -1792 v 1408 m 1792 -1536 v -256 h -1792 v 256 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BarChart4_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,16h3v-5H0V16z M1,12h1v3H1V12z M4,16h3V7H4V16z M5,8h1v7H5V8z M8,16h3V3H8V16z M9,4h1v11H9V4z M12,7v9h3\r\n\tV7H12z M14,15h-1V8h1V15z"},{type:"path",className:"OfficeIconColors_m20",d:"M5,8v7h1V8H5z M9,4v11h1V4H9z M1,12v3h1v-3H1z M14,8h-1v7h1V8z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,16h3v-5H0V16z M1,12h1v3H1V12z M4,16h3V7H4V16z M5,8h1v7H5V8z M8,16h3V3H8V16z M9,4h1v11H9V4z M12,7v9h3\r\n\tV7H12z M14,15h-1V8h1V15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PBIReportTemplate_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,11h-1v5h1V11z M14,9h-1v7h1V9z M12,11h-1v5h1V11z M10,13H9v3h1V13z M2,0v1H1V0H2z M2,2v1H1V2H2z M2,4v1\r\n\tH1V4H2z M2,6v1H1V6H2z M2,8v1H1V8H2z M2,10v1H1v-1H2z M2,12v1H1v-1H2z M1,14h1v1H1V14z M2,16v-1h1v1H2z M4,0v1H3V0H4z M4,16v-1h1v1\r\n\tH4z M6,0v1H5V0H6z M6,16v-1h1v1H6z M8,0v1H7V0H8z M10,0v1H9V0H10z M12,0v1h-1V0H12z M13,2h-1V1h1V2z M13,3v1h-1V3H13z M12,6V5h1v1\r\n\tH12z M12,8V7h1v1H12z"},{type:"path",className:"OfficeIconColors_m20",d:"M13,0H1v16h7v-4h2v-2h2V8h1V0z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,11h-1v5h1V11z M14,9h-1v7h1V9z M12,11h-1v5h1V11z M10,13H9v3h1V13z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,0v1H1V0H2z M2,2v1H1V2H2z M2,4v1H1V4H2z M2,6v1H1V6H2z M2,8v1H1V8H2z M2,10v1H1v-1H2z M2,12v1H1v-1H2z\r\n\t M1,14h1v1H1V14z M2,16v-1h1v1H2z M4,0v1H3V0H4z M4,16v-1h1v1H4z M6,0v1H5V0H6z M6,16v-1h1v1H6z M8,0v1H7V0H8z M10,0v1H9V0H10z\r\n\t M12,0v1h-1V0H12z M13,2h-1V1h1V2z M13,3v1h-1V3H13z M12,6V5h1v1H12z M12,8V7h1v1H12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshNow_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M10.133,0.297c0.865,0.234,1.656,0.602,2.375,1.102c0.719,0.495,1.336,1.083,1.852,1.766\r\n\tc0.521,0.677,0.925,1.43,1.211,2.258C15.857,6.245,16,7.104,16,8c0,0.734-0.096,1.443-0.289,2.125\r\n\tc-0.188,0.682-0.456,1.32-0.805,1.914c-0.344,0.594-0.76,1.135-1.25,1.625c-0.484,0.484-1.023,0.901-1.617,1.25\r\n\tc-0.594,0.344-1.232,0.612-1.914,0.805C9.443,15.906,8.734,16,8,16s-1.443-0.094-2.125-0.281c-0.682-0.193-1.32-0.461-1.914-0.805\r\n\tc-0.594-0.349-1.135-0.766-1.625-1.25c-0.484-0.49-0.901-1.031-1.25-1.625c-0.344-0.594-0.612-1.229-0.805-1.906\r\n\tC0.094,9.451,0,8.74,0,8c0-0.729,0.096-1.438,0.289-2.125c0.193-0.688,0.466-1.333,0.82-1.938c0.359-0.609,0.794-1.161,1.305-1.656\r\n\tC2.924,1.781,3.5,1.354,4.141,1H2V0h4v4H5V1.68C4.391,1.971,3.839,2.339,3.344,2.781c-0.49,0.438-0.909,0.932-1.258,1.484\r\n\tC1.737,4.812,1.469,5.404,1.281,6.039C1.094,6.674,1,7.328,1,8c0,0.641,0.083,1.26,0.25,1.859c0.167,0.594,0.401,1.151,0.703,1.672\r\n\tc0.307,0.516,0.674,0.987,1.102,1.414c0.427,0.427,0.898,0.794,1.414,1.102c0.521,0.302,1.078,0.536,1.672,0.703\r\n\tC6.734,14.917,7.354,15,8,15c0.641,0,1.258-0.083,1.852-0.25c0.599-0.167,1.156-0.401,1.672-0.703\r\n\tc0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414c0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8\r\n\tc0-0.781-0.128-1.534-0.383-2.258c-0.25-0.724-0.602-1.383-1.055-1.977c-0.453-0.594-0.995-1.107-1.625-1.539\r\n\tc-0.625-0.438-1.315-0.76-2.07-0.969L10.133,0.297z"},{type:"path",className:"OfficeIconColors_m22",d:"M10.133,0.297c0.865,0.234,1.656,0.602,2.375,1.102c0.719,0.495,1.336,1.083,1.852,1.766\r\n\tc0.521,0.677,0.925,1.43,1.211,2.258C15.857,6.245,16,7.104,16,8c0,0.734-0.096,1.443-0.289,2.125\r\n\tc-0.188,0.682-0.456,1.32-0.805,1.914c-0.344,0.594-0.76,1.135-1.25,1.625c-0.484,0.484-1.023,0.901-1.617,1.25\r\n\tc-0.594,0.344-1.232,0.612-1.914,0.805C9.443,15.906,8.734,16,8,16s-1.443-0.094-2.125-0.281c-0.682-0.193-1.32-0.461-1.914-0.805\r\n\tc-0.594-0.349-1.135-0.766-1.625-1.25c-0.484-0.49-0.901-1.031-1.25-1.625c-0.344-0.594-0.612-1.229-0.805-1.906\r\n\tC0.094,9.451,0,8.74,0,8c0-0.729,0.096-1.438,0.289-2.125c0.193-0.688,0.466-1.333,0.82-1.938c0.359-0.609,0.794-1.161,1.305-1.656\r\n\tC2.924,1.781,3.5,1.354,4.141,1H2V0h4v4H5V1.68C4.391,1.971,3.839,2.339,3.344,2.781c-0.49,0.438-0.909,0.932-1.258,1.484\r\n\tC1.737,4.812,1.469,5.404,1.281,6.039C1.094,6.674,1,7.328,1,8c0,0.641,0.083,1.26,0.25,1.859c0.167,0.594,0.401,1.151,0.703,1.672\r\n\tc0.307,0.516,0.674,0.987,1.102,1.414c0.427,0.427,0.898,0.794,1.414,1.102c0.521,0.302,1.078,0.536,1.672,0.703\r\n\tC6.734,14.917,7.354,15,8,15c0.641,0,1.258-0.083,1.852-0.25c0.599-0.167,1.156-0.401,1.672-0.703\r\n\tc0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414c0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8\r\n\tc0-0.781-0.128-1.534-0.383-2.258c-0.25-0.724-0.602-1.383-1.055-1.977c-0.453-0.594-0.995-1.107-1.625-1.539\r\n\tc-0.625-0.438-1.315-0.76-2.07-0.969L10.133,0.297z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshCancel_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8.0 16.0q1.1015625 0.0 2.12109375 -0.28515625t1.91015625 -0.80859375t1.62109375 -1.25390625t1.25390625 -1.62109375t0.80859375 -1.91015625t0.28515625 -2.12109375t-0.28515625 -2.12109375t-0.80859375 -1.91015625t-1.25390625 -1.62109375t-1.62109375 -1.25390625t-1.91015625 -0.80859375t-2.12109375 -0.28515625t-2.12109375 0.28515625t-1.91015625 0.80859375t-1.62109375 1.25390625t-1.25390625 1.62109375t-0.80859375 1.91015625t-0.28515625 2.12109375 t0.28515625 2.12109375t0.80859375 1.91015625t1.25390625 1.62109375t1.62109375 1.25390625t1.91015625 0.80859375t2.12109375 0.28515625zM8.0 1.0q1.28125 0.0 2.44921875 0.4375t2.13671875 1.2734375l-9.875 9.875q-0.8359375 -0.96875 -1.2734375 -2.13671875t-0.4375 -2.44921875q0.0 -0.96875 0.25 -1.86328125t0.70703125 -1.671875t1.09375 -1.4140625t1.4140625 -1.09375t1.671875 -0.70703125t1.86328125 -0.25zM13.2890625 3.4140625q0.8359375 0.96875 1.2734375 2.13671875t0.4375 2.44921875 q0.0 0.96875 -0.25 1.86328125t-0.70703125 1.671875t-1.09375 1.4140625t-1.4140625 1.09375t-1.671875 0.70703125t-1.86328125 0.25q-1.28125 0.0 -2.44921875 -0.4375t-2.13671875 -1.2734375z"},{type:"path",className:"OfficeIconColors_m22",d:"M8.0 16.0q1.1015625 0.0 2.12109375 -0.28515625t1.91015625 -0.80859375t1.62109375 -1.25390625t1.25390625 -1.62109375t0.80859375 -1.91015625t0.28515625 -2.12109375t-0.28515625 -2.12109375t-0.80859375 -1.91015625t-1.25390625 -1.62109375t-1.62109375 -1.25390625t-1.91015625 -0.80859375t-2.12109375 -0.28515625t-2.12109375 0.28515625t-1.91015625 0.80859375t-1.62109375 1.25390625t-1.25390625 1.62109375t-0.80859375 1.91015625t-0.28515625 2.12109375 t0.28515625 2.12109375t0.80859375 1.91015625t1.25390625 1.62109375t1.62109375 1.25390625t1.91015625 0.80859375t2.12109375 0.28515625zM8.0 1.0q1.28125 0.0 2.44921875 0.4375t2.13671875 1.2734375l-9.875 9.875q-0.8359375 -0.96875 -1.2734375 -2.13671875t-0.4375 -2.44921875q0.0 -0.96875 0.25 -1.86328125t0.70703125 -1.671875t1.09375 -1.4140625t1.4140625 -1.09375t1.671875 -0.70703125t1.86328125 -0.25zM13.2890625 3.4140625q0.8359375 0.96875 1.2734375 2.13671875t0.4375 2.44921875 q0.0 0.96875 -0.25 1.86328125t-0.70703125 1.671875t-1.09375 1.4140625t-1.4140625 1.09375t-1.671875 0.70703125t-1.86328125 0.25q-1.28125 0.0 -2.44921875 -0.4375t-2.13671875 -1.2734375z"}],viewBox:"0 0 16 16"},{type:"svg",id:"DateTime_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M7,8h1v0.672C7.915,8.778,7.833,8.887,7.758,9H7V8z M12,6h-1v1h0.5H12V6z M7,7h1V6H7V7z M10,6H9v1h1V6z\r\n\t M3,11h1v-1H3V11z M5,7h1V6H5V7z M3,9h1V8H3V9z M16,11.5c0,0.62-0.12,1.203-0.359,1.75c-0.234,0.547-0.555,1.023-0.961,1.43\r\n\tc-0.406,0.406-0.883,0.729-1.43,0.969C12.703,15.883,12.12,16,11.5,16s-1.203-0.117-1.75-0.352c-0.547-0.24-1.023-0.562-1.43-0.969\r\n\tc-0.406-0.406-0.729-0.883-0.969-1.43C7.317,13.169,7.302,13.083,7.274,13H7.258H1V1h2V0h1v1h7V0h1v1h2v6.758V7.77\r\n\tc0.244,0.162,0.473,0.343,0.68,0.55c0.406,0.406,0.727,0.883,0.961,1.43C15.88,10.297,16,10.88,16,11.5z M2,4h11V2h-1v1h-1V2H4v1H3\r\n\tV2H2V4z M7.352,9.75c0.24-0.547,0.562-1.023,0.969-1.43s0.883-0.727,1.43-0.961C10.297,7.12,10.88,7,11.5,7\r\n\tc0.529,0,1.025,0.106,1.5,0.281V7.258V5H2v7h5.028h0.021C7.028,11.835,7,11.672,7,11.5C7,10.88,7.117,10.297,7.352,9.75z M15,11.5\r\n\tc0-0.484-0.094-0.938-0.281-1.359c-0.182-0.427-0.432-0.797-0.75-1.109c-0.313-0.318-0.682-0.568-1.109-0.75\r\n\tC12.438,8.094,11.984,8,11.5,8s-0.94,0.094-1.367,0.281c-0.422,0.182-0.792,0.432-1.109,0.75c-0.312,0.312-0.562,0.682-0.75,1.109\r\n\tC8.091,10.562,8,11.016,8,11.5s0.091,0.94,0.273,1.367c0.188,0.422,0.438,0.792,0.75,1.109c0.318,0.312,0.688,0.562,1.109,0.75\r\n\tC10.56,14.909,11.016,15,11.5,15s0.938-0.091,1.359-0.273c0.427-0.188,0.797-0.438,1.109-0.75c0.318-0.318,0.568-0.688,0.75-1.109\r\n\tC14.906,12.44,15,11.984,15,11.5z M12,9h-1v3h2.5v-1H12V9z M5,9h1V8H5V9z M5,11h1v-1H5V11z"},{type:"path",className:"OfficeIconColors_m26",d:"M2,2h11v2H2V2z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,11.5c0,1.933-1.567,3.5-3.5,3.5c-1.762,0-3.205-1.306-3.45-3H2V5h11v3.35\r\n\tC14.179,8.913,15,10.106,15,11.5z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.5,7c0.62,0,1.203,0.12,1.75,0.359c0.547,0.234,1.023,0.555,1.43,0.961\r\n\tc0.406,0.406,0.727,0.883,0.961,1.43C15.88,10.297,16,10.88,16,11.5s-0.12,1.203-0.359,1.75c-0.234,0.547-0.555,1.023-0.961,1.43\r\n\tc-0.406,0.406-0.883,0.729-1.43,0.969C12.703,15.883,12.12,16,11.5,16s-1.203-0.117-1.75-0.352c-0.547-0.24-1.023-0.562-1.43-0.969\r\n\tc-0.406-0.406-0.729-0.883-0.969-1.43C7.117,12.703,7,12.12,7,11.5s0.117-1.203,0.352-1.75c0.24-0.547,0.562-1.023,0.969-1.43\r\n\tc0.406-0.406,0.883-0.727,1.43-0.961C10.297,7.12,10.88,7,11.5,7z M11.5,15c0.484,0,0.938-0.091,1.359-0.273\r\n\tc0.427-0.188,0.797-0.438,1.109-0.75c0.318-0.318,0.568-0.688,0.75-1.109C14.906,12.44,15,11.984,15,11.5s-0.094-0.938-0.281-1.359\r\n\tc-0.182-0.427-0.432-0.797-0.75-1.109c-0.313-0.318-0.682-0.568-1.109-0.75C12.438,8.094,11.984,8,11.5,8s-0.94,0.094-1.367,0.281\r\n\tc-0.422,0.182-0.792,0.432-1.109,0.75c-0.312,0.312-0.562,0.682-0.75,1.109C8.091,10.562,8,11.016,8,11.5s0.091,0.94,0.273,1.367\r\n\tc0.188,0.422,0.438,0.792,0.75,1.109c0.318,0.312,0.688,0.562,1.109,0.75C10.56,14.909,11.016,15,11.5,15z"},{type:"path",className:"OfficeIconColors_m22",d:"M14,1v6.758c-0.309-0.207-0.644-0.374-1-0.5V5H2v7h5.028\r\n\tc0.039,0.347,0.117,0.681,0.23,1H1V1h2V0h1v1h7V0h1v1H14z M2,2v2h11V2h-1v1h-1V2H4v1H3V2H2z M6,11v-1H5v1H6z M12,6v1h-1V6H12z\r\n\t M7.758,9C7.833,8.887,7.915,8.778,8,8.672V8H7v1H7.758z M3,8h1v1H3V8z M6,8H5v1h1V8z M5,6h1v1H5V6z M4,10H3v1h1V10z M7,7h1V6H7V7z\r\n\t M10,7H9V6h1V7z M12,11h1.5v1H11V9h1V11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PeopleSettings_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.844,7.898c-0.104-0.359-0.253-0.693-0.445-1c-0.193-0.312-0.427-0.594-0.703-0.844\r\n\tc-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062C12.891,3.924,13,3.474,13,3\r\n\tc0-0.412-0.081-0.799-0.242-1.164c-0.156-0.365-0.37-0.682-0.641-0.953c-0.145-0.145-0.303-0.273-0.475-0.385\r\n\tc-0.149-0.098-0.309-0.183-0.478-0.255C10.799,0.081,10.412,0,10,0C9.771,0,9.548,0.025,9.333,0.075\r\n\tc-0.17,0.04-0.336,0.095-0.498,0.167c-0.365,0.156-0.682,0.37-0.953,0.641S7.396,1.471,7.234,1.836C7.078,2.201,7,2.588,7,3\r\n\tc0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062C7.88,5.586,7.573,5.799,7.297,6.055\r\n\tc-0.271,0.25-0.502,0.531-0.695,0.844c-0.07,0.111-0.129,0.228-0.187,0.345c-0.092-0.126-0.186-0.25-0.297-0.361\r\n\tC5.846,6.612,5.529,6.398,5.164,6.242C4.799,6.081,4.411,6,4,6S3.201,6.081,2.836,6.242c-0.365,0.156-0.682,0.37-0.953,0.641\r\n\tS1.396,7.471,1.234,7.836C1.078,8.201,1,8.589,1,9c0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062\r\n\tc-0.339,0.172-0.646,0.385-0.922,0.641c-0.271,0.25-0.503,0.531-0.695,0.844c-0.193,0.307-0.341,0.641-0.445,1\r\n\tC0.052,14.253,0,14.62,0,15h1c0-0.411,0.078-0.799,0.234-1.164c0.161-0.365,0.378-0.682,0.648-0.953s0.589-0.484,0.953-0.641\r\n\tC3.201,12.081,3.589,12,4,12s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641s0.484,0.589,0.641,0.953\r\n\tC6.919,14.201,7,14.589,7,15h1c0-0.38-0.052-0.747-0.156-1.102c-0.104-0.359-0.253-0.693-0.445-1\r\n\tc-0.193-0.312-0.427-0.594-0.703-0.844c-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062\r\n\tC6.891,9.924,7,9.474,7,9c0-0.412,0.078-0.799,0.234-1.164c0.022-0.051,0.046-0.101,0.071-0.15c0.152-0.303,0.344-0.57,0.578-0.803\r\n\tc0.271-0.271,0.588-0.484,0.953-0.641C9.201,6.081,9.588,6,10,6s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641\r\n\ts0.484,0.588,0.641,0.953c0.026,0.058,0.049,0.117,0.071,0.176c0.38,0.027,0.748,0.103,1.097,0.219\r\n\tC13.903,8.119,13.876,8.008,13.844,7.898z M5.836,9.781c-0.104,0.24-0.247,0.451-0.43,0.633c-0.177,0.177-0.388,0.32-0.633,0.43\r\n\tC4.529,10.948,4.271,11,4,11c-0.276,0-0.536-0.052-0.781-0.156c-0.24-0.109-0.451-0.253-0.633-0.43\r\n\tc-0.177-0.182-0.32-0.393-0.43-0.633C2.052,9.536,2,9.276,2,9c0-0.271,0.052-0.529,0.156-0.773c0.109-0.245,0.253-0.456,0.43-0.633\r\n\tc0.182-0.182,0.393-0.326,0.633-0.43C3.464,7.055,3.724,7,4,7c0.271,0,0.529,0.055,0.773,0.164c0.245,0.104,0.456,0.247,0.633,0.43\r\n\tc0.182,0.177,0.326,0.388,0.43,0.633C5.945,8.471,6,8.729,6,9C6,9.276,5.945,9.536,5.836,9.781z M10.773,4.844\r\n\tC10.529,4.948,10.271,5,10,5C9.724,5,9.463,4.948,9.219,4.844C9.086,4.783,8.962,4.712,8.847,4.631\r\n\tc-0.093-0.065-0.18-0.138-0.261-0.217c-0.177-0.182-0.32-0.393-0.43-0.633C8.052,3.537,8,3.276,8,3c0-0.271,0.052-0.529,0.156-0.773\r\n\tc0.109-0.245,0.252-0.456,0.43-0.633c0.182-0.182,0.393-0.326,0.633-0.43C9.463,1.055,9.724,1,10,1c0.271,0,0.529,0.055,0.773,0.164\r\n\tc0.245,0.104,0.456,0.248,0.633,0.43c0.103,0.1,0.193,0.211,0.271,0.333c0.06,0.094,0.113,0.194,0.158,0.3\r\n\tC11.945,2.471,12,2.729,12,3c0,0.276-0.055,0.537-0.164,0.781c-0.104,0.24-0.247,0.451-0.43,0.633\r\n\tC11.229,4.591,11.018,4.734,10.773,4.844z M15,12.5c0,0.161-0.016,0.32-0.047,0.477l0.969,0.398l-0.383,0.93l-0.969-0.406\r\n\tc-0.078,0.13-0.177,0.255-0.297,0.375c-0.12,0.115-0.245,0.214-0.375,0.297l0.406,0.969l-0.93,0.383l-0.398-0.969\r\n\tC12.82,14.984,12.661,15,12.5,15s-0.32-0.016-0.477-0.047l-0.398,0.969l-0.93-0.383l0.406-0.969\r\n\tc-0.266-0.182-0.49-0.406-0.672-0.672l-0.969,0.406l-0.383-0.93l0.969-0.398C10.016,12.82,10,12.661,10,12.5s0.016-0.32,0.047-0.477\r\n\tl-0.969-0.398l0.383-0.93l0.969,0.406c0.177-0.271,0.401-0.495,0.672-0.672l-0.406-0.969l0.93-0.383l0.398,0.969\r\n\tc0.073-0.01,0.143-0.018,0.211-0.023c0.073-0.01,0.146-0.016,0.219-0.016c0.089,0,0.174,0.005,0.258,0.016\r\n\tc0.083,0.01,0.169,0.023,0.258,0.039l0.406-0.984l0.93,0.383l-0.414,0.984c0.276,0.167,0.503,0.385,0.68,0.656l0.969-0.406\r\n\tl0.383,0.93l-0.969,0.398C14.984,12.18,15,12.339,15,12.5z M14,12.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C12.904,11.039,12.708,11,12.5,11c-0.203,0-0.396,0.039-0.578,0.117\r\n\tc-0.182,0.078-0.344,0.188-0.484,0.328c-0.135,0.135-0.242,0.294-0.32,0.477C11.039,12.104,11,12.297,11,12.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.083,0.182,0.193,0.341,0.328,0.477s0.294,0.242,0.477,0.32C12.109,13.961,12.305,14,12.508,14\r\n\ts0.393-0.039,0.57-0.117c0.182-0.083,0.341-0.193,0.477-0.328c0.141-0.135,0.25-0.294,0.328-0.477C13.961,12.896,14,12.703,14,12.5z\r\n\t"},{type:"path",className:"OfficeIconColors_m20",d:"M12,3c0,1.104-0.896,2-2,2C8.896,5,8,4.104,8,3s0.896-2,2-2C11.104,1,12,1.896,12,3z M12.833,8.012\r\n\tC12.425,6.841,11.311,6,10,6C8.343,6,7,7.343,7,9h2.671c0.773-0.625,1.757-1,2.829-1C12.612,8,12.723,8.004,12.833,8.012z M4,11\r\n\tc1.104,0,2-0.896,2-2c0-1.104-0.896-2-2-2S2,7.896,2,9C2,10.104,2.896,11,4,11z M4,12c1.657,0,3,1.343,3,3H1C1,13.343,2.343,12,4,12\r\n\tz"},{type:"path",className:"OfficeIconColors_m22",d:"M13.844,7.898c-0.104-0.359-0.253-0.693-0.445-1c-0.193-0.312-0.427-0.594-0.703-0.844\r\n\tc-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062C12.891,3.924,13,3.474,13,3\r\n\tc0-0.412-0.081-0.799-0.242-1.164c-0.156-0.365-0.37-0.682-0.641-0.953c-0.145-0.145-0.303-0.273-0.475-0.385\r\n\tc-0.149-0.098-0.309-0.183-0.478-0.255C10.799,0.081,10.412,0,10,0C9.771,0,9.548,0.025,9.333,0.075\r\n\tc-0.17,0.04-0.336,0.095-0.498,0.167c-0.365,0.156-0.682,0.37-0.953,0.641S7.396,1.471,7.234,1.836C7.078,2.201,7,2.588,7,3\r\n\tc0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062C7.88,5.586,7.573,5.799,7.297,6.055\r\n\tc-0.271,0.25-0.502,0.531-0.695,0.844c-0.07,0.111-0.129,0.228-0.187,0.345c-0.092-0.126-0.186-0.25-0.297-0.361\r\n\tC5.846,6.612,5.529,6.398,5.164,6.242C4.799,6.081,4.411,6,4,6S3.201,6.081,2.836,6.242c-0.365,0.156-0.682,0.37-0.953,0.641\r\n\tS1.396,7.471,1.234,7.836C1.078,8.201,1,8.589,1,9c0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062\r\n\tc-0.339,0.172-0.646,0.385-0.922,0.641c-0.271,0.25-0.503,0.531-0.695,0.844c-0.193,0.307-0.341,0.641-0.445,1\r\n\tC0.052,14.253,0,14.62,0,15h1c0-0.411,0.078-0.799,0.234-1.164c0.161-0.365,0.378-0.682,0.648-0.953s0.589-0.484,0.953-0.641\r\n\tC3.201,12.081,3.589,12,4,12s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641s0.484,0.589,0.641,0.953\r\n\tC6.919,14.201,7,14.589,7,15h1c0-0.38-0.052-0.747-0.156-1.102c-0.104-0.359-0.253-0.693-0.445-1\r\n\tc-0.193-0.312-0.427-0.594-0.703-0.844c-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062\r\n\tC6.891,9.924,7,9.474,7,9c0-0.412,0.078-0.799,0.234-1.164c0.022-0.051,0.046-0.101,0.071-0.15c0.152-0.303,0.344-0.57,0.578-0.803\r\n\tc0.271-0.271,0.588-0.484,0.953-0.641C9.201,6.081,9.588,6,10,6s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641\r\n\ts0.484,0.588,0.641,0.953c0.026,0.058,0.049,0.117,0.071,0.176c0.38,0.027,0.748,0.103,1.097,0.219\r\n\tC13.903,8.119,13.876,8.008,13.844,7.898z M5.836,9.781c-0.104,0.24-0.247,0.451-0.43,0.633c-0.177,0.177-0.388,0.32-0.633,0.43\r\n\tC4.529,10.948,4.271,11,4,11c-0.276,0-0.536-0.052-0.781-0.156c-0.24-0.109-0.451-0.253-0.633-0.43\r\n\tc-0.177-0.182-0.32-0.393-0.43-0.633C2.052,9.536,2,9.276,2,9c0-0.271,0.052-0.529,0.156-0.773c0.109-0.245,0.253-0.456,0.43-0.633\r\n\tc0.182-0.182,0.393-0.326,0.633-0.43C3.464,7.055,3.724,7,4,7c0.271,0,0.529,0.055,0.773,0.164c0.245,0.104,0.456,0.247,0.633,0.43\r\n\tc0.182,0.177,0.326,0.388,0.43,0.633C5.945,8.471,6,8.729,6,9C6,9.276,5.945,9.536,5.836,9.781z M10.773,4.844\r\n\tC10.529,4.948,10.271,5,10,5C9.724,5,9.463,4.948,9.219,4.844C9.086,4.783,8.962,4.712,8.847,4.631\r\n\tc-0.093-0.065-0.18-0.138-0.261-0.217c-0.177-0.182-0.32-0.393-0.43-0.633C8.052,3.537,8,3.276,8,3c0-0.271,0.052-0.529,0.156-0.773\r\n\tc0.109-0.245,0.252-0.456,0.43-0.633c0.182-0.182,0.393-0.326,0.633-0.43C9.463,1.055,9.724,1,10,1c0.271,0,0.529,0.055,0.773,0.164\r\n\tc0.245,0.104,0.456,0.248,0.633,0.43c0.103,0.1,0.193,0.211,0.271,0.333c0.06,0.094,0.113,0.194,0.158,0.3\r\n\tC11.945,2.471,12,2.729,12,3c0,0.276-0.055,0.537-0.164,0.781c-0.104,0.24-0.247,0.451-0.43,0.633\r\n\tC11.229,4.591,11.018,4.734,10.773,4.844z"},{type:"path",className:"OfficeIconColors_m23",d:"M15,12.5c0,0.161-0.016,0.32-0.047,0.477l0.969,0.398l-0.383,0.93l-0.969-0.406\r\n\tc-0.078,0.13-0.177,0.255-0.297,0.375c-0.12,0.115-0.245,0.214-0.375,0.297l0.406,0.969l-0.93,0.383l-0.398-0.969\r\n\tC12.82,14.984,12.661,15,12.5,15s-0.32-0.016-0.477-0.047l-0.398,0.969l-0.93-0.383l0.406-0.969\r\n\tc-0.266-0.182-0.49-0.406-0.672-0.672l-0.969,0.406l-0.383-0.93l0.969-0.398C10.016,12.82,10,12.661,10,12.5s0.016-0.32,0.047-0.477\r\n\tl-0.969-0.398l0.383-0.93l0.969,0.406c0.177-0.271,0.401-0.495,0.672-0.672l-0.406-0.969l0.93-0.383l0.398,0.969\r\n\tc0.073-0.01,0.143-0.018,0.211-0.023c0.073-0.01,0.146-0.016,0.219-0.016c0.089,0,0.174,0.005,0.258,0.016\r\n\tc0.083,0.01,0.169,0.023,0.258,0.039l0.406-0.984l0.93,0.383l-0.414,0.984c0.276,0.167,0.503,0.385,0.68,0.656l0.969-0.406\r\n\tl0.383,0.93l-0.969,0.398C14.984,12.18,15,12.339,15,12.5z M14,12.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C12.904,11.039,12.708,11,12.5,11c-0.203,0-0.396,0.039-0.578,0.117\r\n\tc-0.182,0.078-0.344,0.188-0.484,0.328c-0.135,0.135-0.242,0.294-0.32,0.477C11.039,12.104,11,12.297,11,12.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.083,0.182,0.193,0.341,0.328,0.477s0.294,0.242,0.477,0.32C12.109,13.961,12.305,14,12.508,14\r\n\ts0.393-0.039,0.57-0.117c0.182-0.083,0.341-0.193,0.477-0.328c0.141-0.135,0.25-0.294,0.328-0.477C13.961,12.896,14,12.703,14,12.5z\r\n\t"}],viewBox:"0 0 16 16"},{type:"svg",id:"Database_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1792 1664 q 0 53 -27 102 q -28 49 -78 91 q -50 43 -120 78 q -70 35 -155 60 q -86 25 -184 39 q -98 14 -204 14 q -106 0 -204 -14 q -98 -14 -183 -39 q -86 -25 -156 -60 q -70 -35 -120 -78 q -50 -42 -77 -91 q -28 -49 -28 -102 v -1280 q 0 -79 61 -149 q 60 -70 164 -123 q 104 -52 244 -82 q 140 -30 299 -30 q 159 0 299 30 q 140 30 244 82 q 104 53 165 123 q 60 70 60 149 m -768 -256 q -147 0 -265 25 q -118 26 -201 64 q -84 38 -129 83 q -45 45 -45 84 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 q 0 -39 -45 -84 q -45 -45 -128 -83 q -84 -38 -202 -64 q -118 -25 -265 -25 m 0 1792 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 v -1068 q -52 39 -121 71 q -69 32 -151 54 q -82 23 -175 35 q -93 12 -193 12 q -100 0 -193 -12 q -93 -12 -175 -35 q -82 -22 -151 -54 q -69 -32 -121 -71 v 1068 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1728 384 v 1339 q 3 0 3 2 q 0 7 -25 28 q -25 22 -73 51 q -48 29 -117 61 q -69 32 -156 59 q -87 27 -191 44 q -105 18 -223 18 q -100 0 -180 -12 q -80 -12 -142 -32 q -63 -19 -110 -45 q -47 -25 -81 -51 q -79 -62 -113 -141 v -1321 q 0 -58 51 -116 q 51 -57 144 -103 q 92 -45 222 -73 q 129 -28 287 -28 q 158 0 288 28 q 129 28 222 73 q 92 46 143 103 q 51 58 51 116 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1792 1664 q 0 53 -27 102 q -28 49 -78 91 q -50 43 -120 78 q -70 35 -155 60 q -86 25 -184 39 q -98 14 -204 14 q -106 0 -204 -14 q -98 -14 -183 -39 q -86 -25 -156 -60 q -70 -35 -120 -78 q -50 -42 -77 -91 q -28 -49 -28 -102 v -1280 q 0 -79 61 -149 q 60 -70 164 -123 q 104 -52 244 -82 q 140 -30 299 -30 q 159 0 299 30 q 140 30 244 82 q 104 53 165 123 q 60 70 60 149 m -768 -256 q -147 0 -265 25 q -118 26 -201 64 q -84 38 -129 83 q -45 45 -45 84 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 q 0 -39 -45 -84 q -45 -45 -128 -83 q -84 -38 -202 -64 q -118 -25 -265 -25 m 0 1792 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 v -1068 q -52 39 -121 71 q -69 32 -151 54 q -82 23 -175 35 q -93 12 -193 12 q -100 0 -193 -12 q -93 -12 -175 -35 q -82 -22 -151 -54 q -69 -32 -121 -71 v 1068 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ImpactAnalysis_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,5v9H4v-2H2v-2H0V1h10.258C9.898,1.104,9.549,1.24,9.211,1.406C8.878,1.573,8.56,1.771,8.258,2H1v7h10V5\r\n\th0.5L12,5.5V10H3v1h10V6l1-1v7H5v1h10V5H16z M7,7c0-0.458,0.06-0.901,0.18-1.328c0.12-0.427,0.286-0.826,0.5-1.195\r\n\tc0.219-0.37,0.479-0.706,0.781-1.008c0.307-0.307,0.646-0.568,1.016-0.781c0.37-0.219,0.768-0.388,1.195-0.508\r\n\tC11.099,2.06,11.542,2,12,2h1.289l-1.141-1.148l0.703-0.703L15.203,2.5l-2.352,2.352l-0.703-0.703L13.289,3H12\r\n\tc-0.552,0-1.07,0.107-1.555,0.32C9.961,3.529,9.536,3.815,9.172,4.18C8.812,4.539,8.526,4.961,8.312,5.445C8.104,5.93,8,6.448,8,7H7\r\n\tz"},{type:"path",className:"OfficeIconColors_m20",d:"M5.75,8.25V7c0-0.569,0.075-1.125,0.226-1.666c0.147-0.524,0.353-1.019,0.621-1.483L6.604,3.84\r\n\tC6.876,3.381,7.2,2.961,7.577,2.585C7.789,2.373,8.014,2.178,8.252,2H1v7h10V5h-0.879c-0.022,0.021-0.044,0.042-0.066,0.064\r\n\tC9.812,5.308,9.612,5.598,9.459,5.944C9.322,6.264,9.25,6.612,9.25,7v1.25H5.75z M5,12v1h10V6h-1v6H5z M12,10V6h1v5H3v-1H12z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,5v9H4v-2H2v-2H0V1h10.258C9.898,1.104,9.549,1.24,9.211,1.406C8.878,1.573,8.56,1.771,8.258,2H1v7h10V5\r\n\th0.5L12,5.5V10H3v1h10V6l1-1v7H5v1h10V5H16z"},{type:"path",className:"OfficeIconColors_m24",d:"M7,7c0-0.458,0.06-0.901,0.18-1.328c0.12-0.427,0.286-0.826,0.5-1.195c0.219-0.37,0.479-0.706,0.781-1.008\r\n\tc0.307-0.307,0.646-0.568,1.016-0.781c0.37-0.219,0.768-0.388,1.195-0.508C11.099,2.06,11.542,2,12,2h1.289l-1.141-1.148\r\n\tl0.703-0.703L15.203,2.5l-2.352,2.352l-0.703-0.703L13.289,3H12c-0.552,0-1.07,0.107-1.555,0.32C9.961,3.529,9.536,3.815,9.172,4.18\r\n\tC8.812,4.539,8.526,4.961,8.312,5.445C8.104,5.93,8,6.448,8,7H7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"AutoCreateReport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.758,6L13.9,9H16l-5.25,7H8.688l2-4h-2l3.023-6H15.758z M14,10h-1.9l1.859-3h-1.631l-2.016,4h2\r\n\tl-1.882,3.766L14,10z M9,1v8.158l-1,1.984V0h3v5.189l-1,1.984V1H9z M13,4v1h-1V3h3v2h-1V4H13z M0,13h3V8H0V13z M1,9h1v3H1V9z M7,13\r\n\tH4V3h3V13z M6,4H5v8h1V4z"},{type:"path",className:"OfficeIconColors_m212",d:"M14,10h-1.9l1.859-3h-1.631l-2.016,4h2l-1.882,3.766L14,10z"},{type:"path",className:"OfficeIconColors_m211",d:"M15.758,6L13.9,9H16l-5.25,7H8.688l2-4h-2l3.023-6H15.758z M14,10h-1.9l1.859-3h-1.631l-2.016,4h2\r\n\tl-1.882,3.766L14,10z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,9h1v3H1V9z M6,4H5v8h1V4z M9,9.158V1h1v6.173L9,9.158z M13,5V4\r\n\th1v1H13z"},{type:"path",className:"OfficeIconColors_m22",d:"M9,1v8.158l-1,1.984V0h3v5.189l-1,1.984V1H9z M13,4v1h-1V3h3v2h-1V4H13z M0,13h3V8H0V13z M1,9h1v3H1V9z\r\n\t M7,13H4V3h3V13z M6,4H5v8h1V4z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PaginatedReport_16",children:[{type:"path",d:"M5,1C3.895,1,3,1.895,3,3V13C3,14.105,3.895,15,5,15H11C12.105,15,13,14.105,13,13V5.414C13,5.016,12.842,4.635,12.561,4.353L9.647,1.439C9.366,1.158,8.984,1,8.586,1H5ZM4,3C4,2.448,4.448,2,5,2H8V4.5C8,5.328,8.672,6,9.5,6H12V13C12,13.552,11.552,14,11,14H5C4.448,14,4,13.552,4,13V3ZM11.793,5H9.5C9.224,5,9,4.776,9,4.5V2.207L11.793,5ZM8,13C7.724,13,7.5,12.776,7.5,12.5V7.5C7.5,7.224,7.724,7,8,7C8.276,7,8.5,7.224,8.5,7.5V12.5C8.5,12.776,8.276,13,8,13ZM10.5,13C10.224,13,10,12.776,10,12.5V9.5C10,9.224,10.224,9,10.5,9C10.776,9,11,9.224,11,9.5V12.5C11,12.776,10.776,13,10.5,13ZM5.5,13C5.224,13,5,12.776,5,12.5V10.5C5,10.224,5.224,10,5.5,10C5.776,10,6,10.224,6,10.5V12.5C6,12.776,5.776,13,5.5,13Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"CloudImportExport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M12.727,6.008c0.458,0.031,0.887,0.144,1.285,0.336c0.398,0.193,0.745,0.447,1.039,0.762\r\n\tc0.294,0.315,0.526,0.679,0.695,1.09S16,9.042,16,9.5c0,0.484-0.093,0.939-0.277,1.363c-0.185,0.425-0.435,0.795-0.75,1.109\r\n\tc-0.315,0.315-0.685,0.565-1.109,0.75C13.438,12.908,12.984,13,12.5,13H12v-1h0.5c0.344,0,0.668-0.064,0.973-0.195\r\n\tc0.305-0.13,0.57-0.309,0.797-0.535s0.405-0.492,0.535-0.797S15,9.844,15,9.5s-0.065-0.668-0.195-0.973s-0.309-0.57-0.535-0.797\r\n\ts-0.492-0.405-0.797-0.535C13.168,7.065,12.844,7,12.5,7c-0.094,0-0.187,0.005-0.277,0.016c-0.091,0.011-0.181,0.026-0.27,0.047\r\n\tc-0.052-0.438-0.18-0.842-0.383-1.215c-0.203-0.372-0.458-0.695-0.766-0.969S10.146,4.391,9.75,4.234S8.938,4,8.5,4\r\n\tC8.136,4,7.784,4.055,7.445,4.164S6.796,4.427,6.512,4.625S5.977,5.062,5.758,5.34C5.539,5.619,5.364,5.93,5.234,6.273\r\n\tC4.844,6.091,4.432,6,4,6C3.583,6,3.194,6.078,2.832,6.234C2.47,6.391,2.152,6.605,1.879,6.879S1.391,7.472,1.234,7.836\r\n\tC1.078,8.201,1,8.589,1,9c0,0.318,0.048,0.623,0.145,0.914c0.096,0.292,0.231,0.562,0.406,0.809\r\n\tc0.174,0.248,0.385,0.465,0.633,0.652c0.247,0.188,0.52,0.334,0.816,0.438v1.047c-0.438-0.114-0.84-0.294-1.207-0.539\r\n\tc-0.367-0.244-0.684-0.537-0.949-0.879c-0.266-0.341-0.473-0.72-0.621-1.137C0.074,9.889,0,9.453,0,9\r\n\tc0-0.552,0.105-1.07,0.316-1.555s0.497-0.907,0.859-1.27c0.362-0.362,0.785-0.648,1.27-0.859S3.448,5,4,5\r\n\tc0.239,0,0.481,0.023,0.727,0.07c0.208-0.317,0.45-0.604,0.727-0.859c0.275-0.255,0.575-0.473,0.898-0.652s0.667-0.317,1.031-0.414\r\n\tC7.747,3.048,8.12,3,8.5,3c0.474,0,0.931,0.073,1.371,0.219c0.44,0.146,0.847,0.351,1.219,0.613c0.372,0.263,0.699,0.58,0.98,0.949\r\n\tC12.352,5.151,12.57,5.56,12.727,6.008z M7,13.289l1.148-1.141l0.703,0.703L6.5,15.203l-2.352-2.352l0.703-0.703L6,13.289V8h1\r\n\tV13.289z M12.148,10.852L11,9.711V15h-1V9.711l-1.148,1.141l-0.703-0.703L10.5,7.797l2.352,2.352L12.148,10.852z"},{type:"path",className:"OfficeIconColors_m20",d:"M15.5,9.5c0,0.409-0.079,0.803-0.235,1.169c-0.154,0.361-0.37,0.683-0.642,0.954s-0.593,0.487-0.954,0.642\r\n\tC13.306,12.421,12.912,12.5,12.5,12.5H12v-0.386l0.151,0.15l2.115-2.115L10.5,6.383L8,8.883V7H5v3.886l-0.151-0.15l-1.661,1.661\r\n\tc-0.19-0.045-0.377-0.096-0.554-0.173c-0.418-0.181-0.791-0.433-1.108-0.75s-0.569-0.69-0.75-1.108C0.593,9.943,0.5,9.484,0.5,9\r\n\tc0-0.478,0.093-0.936,0.274-1.361c0.182-0.422,0.434-0.797,0.751-1.114s0.69-0.57,1.108-0.75C3.347,5.467,4.199,5.412,4.972,5.64\r\n\tc0.112-0.216,0.244-0.419,0.393-0.609C5.613,4.714,5.903,4.44,6.226,4.215s0.682-0.402,1.066-0.527\r\n\tc0.895-0.29,1.914-0.241,2.769,0.126c0.48,0.207,0.907,0.495,1.269,0.855c0.362,0.362,0.649,0.789,0.856,1.27\r\n\tc0.075,0.176,0.135,0.361,0.183,0.564c0.452-0.019,0.896,0.06,1.301,0.232c0.362,0.155,0.684,0.371,0.954,0.642\r\n\tc0.271,0.271,0.487,0.593,0.642,0.954C15.421,8.698,15.5,9.091,15.5,9.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M12.727,6.008c0.458,0.031,0.887,0.144,1.285,0.336c0.398,0.193,0.745,0.447,1.039,0.762\r\n\tc0.294,0.315,0.526,0.679,0.695,1.09S16,9.042,16,9.5c0,0.484-0.093,0.939-0.277,1.363c-0.185,0.425-0.435,0.795-0.75,1.109\r\n\tc-0.315,0.315-0.685,0.565-1.109,0.75C13.438,12.908,12.984,13,12.5,13H12v-1h0.5c0.344,0,0.668-0.064,0.973-0.195\r\n\tc0.305-0.13,0.57-0.309,0.797-0.535s0.405-0.492,0.535-0.797S15,9.844,15,9.5s-0.065-0.668-0.195-0.973s-0.309-0.57-0.535-0.797\r\n\ts-0.492-0.405-0.797-0.535C13.168,7.065,12.844,7,12.5,7c-0.094,0-0.187,0.005-0.277,0.016c-0.091,0.011-0.181,0.026-0.27,0.047\r\n\tc-0.052-0.438-0.18-0.842-0.383-1.215c-0.203-0.372-0.458-0.695-0.766-0.969S10.146,4.391,9.75,4.234S8.938,4,8.5,4\r\n\tC8.136,4,7.784,4.055,7.445,4.164S6.796,4.427,6.512,4.625S5.977,5.062,5.758,5.34C5.539,5.619,5.364,5.93,5.234,6.273\r\n\tC4.844,6.091,4.432,6,4,6C3.583,6,3.194,6.078,2.832,6.234C2.47,6.391,2.152,6.605,1.879,6.879S1.391,7.472,1.234,7.836\r\n\tC1.078,8.201,1,8.589,1,9c0,0.318,0.048,0.623,0.145,0.914c0.096,0.292,0.231,0.562,0.406,0.809\r\n\tc0.174,0.248,0.385,0.465,0.633,0.652c0.247,0.188,0.52,0.334,0.816,0.438v1.047c-0.438-0.114-0.84-0.294-1.207-0.539\r\n\tc-0.367-0.244-0.684-0.537-0.949-0.879c-0.266-0.341-0.473-0.72-0.621-1.137C0.074,9.889,0,9.453,0,9\r\n\tc0-0.552,0.105-1.07,0.316-1.555s0.497-0.907,0.859-1.27c0.362-0.362,0.785-0.648,1.27-0.859S3.448,5,4,5\r\n\tc0.239,0,0.481,0.023,0.727,0.07c0.208-0.317,0.45-0.604,0.727-0.859c0.275-0.255,0.575-0.473,0.898-0.652s0.667-0.317,1.031-0.414\r\n\tC7.747,3.048,8.12,3,8.5,3c0.474,0,0.931,0.073,1.371,0.219c0.44,0.146,0.847,0.351,1.219,0.613c0.372,0.263,0.699,0.58,0.98,0.949\r\n\tC12.352,5.151,12.57,5.56,12.727,6.008z"},{type:"path",className:"OfficeIconColors_m24",d:"M7,13.289l1.148-1.141l0.703,0.703L6.5,15.203l-2.352-2.352l0.703-0.703L6,13.289V8h1V13.289z\r\n\t M12.148,10.852L11,9.711V15h-1V9.711l-1.148,1.141l-0.703-0.703L10.5,7.797l2.352,2.352L12.148,10.852z"}],viewBox:"0 0 16 16"},{type:"svg",id:"GenericScan_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,5V1h4v1H1v3H0z M1,11v3h3v1H0v-4H1z M3,11V5h1v6H3z M6,11V5h1v6H6z M9,11V5h1v6H9z M12,1h4v4h-1V2h-3V1z\r\n\t M13,5v6h-1V5H13z M15,14v-3h1v4h-4v-1H15z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,5V1h4v1H1v3H0z M1,11v3h3v1H0v-4H1z M3,11V5h1v6H3z M6,11V5h1v6H6z M9,11V5h1v6H9z M12,1h4v4h-1V2h-3V1z\r\n\t M13,5v6h-1V5H13z M15,14v-3h1v4h-4v-1H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Key_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,12.289V16h-4v-2h-2v-2H8v-1.617c-0.386,0.203-0.789,0.357-1.211,0.461C6.367,10.948,5.938,11,5.5,11\r\n\tc-0.505,0-0.992-0.064-1.461-0.195c-0.469-0.13-0.906-0.314-1.312-0.555C2.32,10.011,1.949,9.723,1.613,9.387S0.989,8.68,0.75,8.273\r\n\tC0.51,7.867,0.325,7.43,0.195,6.961C0.065,6.492,0,6.005,0,5.5c0-0.505,0.065-0.992,0.195-1.461C0.325,3.57,0.51,3.133,0.75,2.727\r\n\tC0.989,2.32,1.277,1.949,1.613,1.613S2.32,0.99,2.727,0.75C3.133,0.511,3.57,0.326,4.039,0.195C4.508,0.065,4.995,0,5.5,0\r\n\tc0.505,0,0.992,0.065,1.461,0.195C7.43,0.326,7.867,0.511,8.273,0.75C8.68,0.99,9.051,1.277,9.387,1.613s0.624,0.707,0.863,1.113\r\n\ts0.425,0.844,0.555,1.312S11,4.995,11,5.5c0,0.266-0.021,0.529-0.062,0.789c-0.042,0.261-0.102,0.516-0.18,0.766L16,12.289z\r\n\t M15,12.711L9.609,7.32c0.114-0.297,0.208-0.595,0.281-0.895C9.963,6.126,10,5.818,10,5.5c0-0.62-0.119-1.203-0.355-1.75\r\n\tC9.407,3.203,9.086,2.727,8.68,2.32S7.797,1.593,7.25,1.355C6.703,1.119,6.12,1,5.5,1C4.88,1,4.297,1.119,3.75,1.355\r\n\tC3.203,1.593,2.727,1.914,2.32,2.32S1.592,3.203,1.355,3.75C1.118,4.297,1,4.88,1,5.5c0,0.62,0.118,1.203,0.355,1.75\r\n\tC1.592,7.797,1.914,8.273,2.32,8.68s0.883,0.729,1.43,0.965C4.297,9.882,4.88,10,5.5,10c0.505,0,1.001-0.086,1.488-0.258\r\n\tC7.475,9.57,7.914,9.323,8.305,9H9v2h2v2h2v2h2V12.711z M4,3c0.141,0,0.271,0.026,0.391,0.078C4.51,3.13,4.616,3.202,4.707,3.293\r\n\tC4.798,3.384,4.87,3.49,4.922,3.609C4.974,3.729,5,3.859,5,4S4.974,4.271,4.922,4.391C4.87,4.511,4.798,4.616,4.707,4.707\r\n\tC4.616,4.798,4.51,4.87,4.391,4.922C4.271,4.974,4.141,5,4,5S3.729,4.974,3.609,4.922C3.489,4.87,3.384,4.798,3.293,4.707\r\n\tC3.202,4.616,3.13,4.511,3.078,4.391C3.026,4.271,3,4.141,3,4s0.026-0.271,0.078-0.391C3.13,3.49,3.202,3.384,3.293,3.293\r\n\tC3.384,3.202,3.489,3.13,3.609,3.078C3.729,3.026,3.859,3,4,3z"},{type:"path",className:"OfficeIconColors_m20",d:"M10.188,7.191c0.073-0.215,0.136-0.431,0.189-0.647C10.458,6.207,10.5,5.855,10.5,5.5\r\n\tc0-0.685-0.133-1.341-0.397-1.949c-0.261-0.603-0.622-1.136-1.07-1.584s-0.981-0.809-1.584-1.07c-1.216-0.526-2.681-0.527-3.898,0\r\n\tc-0.603,0.261-1.136,0.622-1.584,1.07c-0.449,0.449-0.81,0.982-1.07,1.584C0.633,4.158,0.5,4.813,0.5,5.5s0.133,1.342,0.396,1.949\r\n\tc0.261,0.602,0.621,1.135,1.07,1.584c0.45,0.45,0.983,0.811,1.584,1.07c1.101,0.477,2.404,0.532,3.604,0.11\r\n\tc0.482-0.17,0.927-0.41,1.324-0.714l0.021,2h2v2h2v2h3v-2.996L10.188,7.191z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,12.289V16h-4v-2h-2v-2H8v-1.617c-0.386,0.203-0.789,0.357-1.211,0.461C6.367,10.948,5.938,11,5.5,11\r\n\tc-0.505,0-0.992-0.064-1.461-0.195c-0.469-0.13-0.906-0.314-1.312-0.555C2.32,10.011,1.949,9.723,1.613,9.387S0.989,8.68,0.75,8.273\r\n\tC0.51,7.867,0.325,7.43,0.195,6.961C0.065,6.492,0,6.005,0,5.5c0-0.505,0.065-0.992,0.195-1.461C0.325,3.57,0.51,3.133,0.75,2.727\r\n\tC0.989,2.32,1.277,1.949,1.613,1.613S2.32,0.99,2.727,0.75C3.133,0.511,3.57,0.326,4.039,0.195C4.508,0.065,4.995,0,5.5,0\r\n\tc0.505,0,0.992,0.065,1.461,0.195C7.43,0.326,7.867,0.511,8.273,0.75C8.68,0.99,9.051,1.277,9.387,1.613s0.624,0.707,0.863,1.113\r\n\ts0.425,0.844,0.555,1.312S11,4.995,11,5.5c0,0.266-0.021,0.529-0.062,0.789c-0.042,0.261-0.102,0.516-0.18,0.766L16,12.289z\r\n\t M15,12.711L9.609,7.32c0.114-0.297,0.208-0.595,0.281-0.895C9.963,6.126,10,5.818,10,5.5c0-0.62-0.119-1.203-0.355-1.75\r\n\tC9.407,3.203,9.086,2.727,8.68,2.32S7.797,1.593,7.25,1.355C6.703,1.119,6.12,1,5.5,1C4.88,1,4.297,1.119,3.75,1.355\r\n\tC3.203,1.593,2.727,1.914,2.32,2.32S1.592,3.203,1.355,3.75C1.118,4.297,1,4.88,1,5.5c0,0.62,0.118,1.203,0.355,1.75\r\n\tC1.592,7.797,1.914,8.273,2.32,8.68s0.883,0.729,1.43,0.965C4.297,9.882,4.88,10,5.5,10c0.505,0,1.001-0.086,1.488-0.258\r\n\tC7.475,9.57,7.914,9.323,8.305,9H9v2h2v2h2v2h2V12.711z M4,3c0.141,0,0.271,0.026,0.391,0.078C4.51,3.13,4.616,3.202,4.707,3.293\r\n\tC4.798,3.384,4.87,3.49,4.922,3.609C4.974,3.729,5,3.859,5,4S4.974,4.271,4.922,4.391C4.87,4.511,4.798,4.616,4.707,4.707\r\n\tC4.616,4.798,4.51,4.87,4.391,4.922C4.271,4.974,4.141,5,4,5S3.729,4.974,3.609,4.922C3.489,4.87,3.384,4.798,3.293,4.707\r\n\tC3.202,4.616,3.13,4.511,3.078,4.391C3.026,4.271,3,4.141,3,4s0.026-0.271,0.078-0.391C3.13,3.49,3.202,3.384,3.293,3.293\r\n\tC3.384,3.202,3.489,3.13,3.609,3.078C3.729,3.026,3.859,3,4,3z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Repair_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.078,1.719c0.137,0.234,0.26,0.458,0.371,0.672c0.113,0.214,0.211,0.43,0.293,0.648\r\n\tc0.084,0.219,0.148,0.447,0.191,0.684C15.979,3.96,16,4.219,16,4.5c0,0.412-0.053,0.809-0.16,1.191\r\n\tc-0.105,0.383-0.258,0.741-0.453,1.074c-0.195,0.333-0.43,0.638-0.707,0.914c-0.275,0.276-0.58,0.512-0.914,0.707\r\n\tc-0.332,0.195-0.691,0.347-1.074,0.453C12.309,8.947,11.912,9,11.5,9c-0.119,0-0.24-0.005-0.363-0.016\r\n\tc-0.121-0.01-0.242-0.026-0.363-0.047l-6.297,6.297c-0.25,0.25-0.535,0.44-0.855,0.57S2.966,16,2.617,16\r\n\tc-0.359,0-0.698-0.069-1.016-0.207c-0.318-0.138-0.595-0.325-0.832-0.562c-0.237-0.237-0.425-0.515-0.562-0.832\r\n\tC0.069,14.081,0,13.742,0,13.383c0-0.349,0.065-0.684,0.195-1.004c0.13-0.32,0.32-0.605,0.57-0.855l6.297-6.297\r\n\tc-0.021-0.12-0.037-0.241-0.047-0.363C7.005,4.741,7,4.62,7,4.5c0-0.411,0.053-0.809,0.16-1.191\r\n\tc0.106-0.383,0.258-0.741,0.453-1.074C7.809,1.901,8.044,1.597,8.32,1.32c0.276-0.276,0.581-0.512,0.914-0.707\r\n\tc0.334-0.195,0.691-0.346,1.074-0.453C10.691,0.054,11.09,0,11.5,0c0.281,0,0.541,0.022,0.777,0.066\r\n\tc0.238,0.044,0.465,0.108,0.684,0.191c0.219,0.083,0.436,0.181,0.648,0.293c0.215,0.112,0.438,0.236,0.672,0.371L11.203,4L12,4.797\r\n\tL15.078,1.719z M11.5,8c0.484,0,0.939-0.092,1.363-0.277c0.426-0.185,0.795-0.435,1.109-0.75c0.316-0.315,0.566-0.685,0.75-1.109\r\n\tC14.908,5.439,15,4.984,15,4.5c0-0.38-0.062-0.747-0.188-1.102L12,6.203L9.797,4l2.805-2.812C12.248,1.062,11.881,1,11.5,1\r\n\tc-0.484,0-0.938,0.093-1.363,0.277c-0.424,0.185-0.793,0.435-1.109,0.75c-0.315,0.315-0.565,0.685-0.75,1.109\r\n\tC8.092,3.562,8,4.016,8,4.5c0,0.183,0.016,0.359,0.047,0.531s0.067,0.344,0.109,0.516l-6.68,6.688\r\n\tc-0.151,0.151-0.269,0.326-0.352,0.523C1.042,12.956,1,13.164,1,13.383s0.043,0.428,0.129,0.625c0.086,0.198,0.202,0.37,0.348,0.516\r\n\tc0.146,0.146,0.317,0.262,0.516,0.348C2.19,14.957,2.398,15,2.617,15s0.427-0.042,0.625-0.125c0.198-0.083,0.372-0.2,0.523-0.352\r\n\tl6.688-6.68c0.172,0.042,0.344,0.078,0.516,0.109S11.318,8,11.5,8z"},{type:"path",className:"OfficeIconColors_m20",d:"M15.5,4.5c0,0.553-0.107,1.079-0.319,1.563c-0.207,0.479-0.495,0.905-0.855,1.264\r\n\tc-0.356,0.358-0.782,0.646-1.263,0.854c-0.67,0.292-1.457,0.396-2.184,0.263C10.79,8.429,10.7,8.411,10.611,8.393l-6.492,6.484\r\n\tc-0.196,0.196-0.426,0.351-0.683,0.459C3.176,15.445,2.9,15.5,2.617,15.5c-0.287,0-0.565-0.058-0.824-0.171\r\n\tc-0.254-0.109-0.479-0.262-0.67-0.452c-0.188-0.188-0.342-0.413-0.453-0.67C0.558,13.948,0.5,13.67,0.5,13.383\r\n\tc0-0.286,0.056-0.562,0.165-0.82c0.107-0.256,0.262-0.485,0.458-0.682l6.484-6.492C7.589,5.299,7.571,5.21,7.555,5.121\r\n\tC7.519,4.92,7.5,4.713,7.5,4.5c0-0.553,0.107-1.079,0.319-1.563c0.209-0.479,0.497-0.904,0.854-1.262\r\n\tc0.361-0.359,0.786-0.646,1.264-0.855c0.877-0.381,1.913-0.428,2.832-0.103l0.746,0.264L10.504,4l1.497,1.497l3.02-3.012\r\n\tl0.264,0.747C15.428,3.639,15.5,4.065,15.5,4.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M15.078,1.719c0.137,0.234,0.26,0.458,0.371,0.672c0.113,0.214,0.211,0.43,0.293,0.648\r\n\tc0.084,0.219,0.148,0.447,0.191,0.684C15.979,3.96,16,4.219,16,4.5c0,0.412-0.053,0.809-0.16,1.191\r\n\tc-0.105,0.383-0.258,0.741-0.453,1.074c-0.195,0.333-0.43,0.638-0.707,0.914c-0.275,0.276-0.58,0.512-0.914,0.707\r\n\tc-0.332,0.195-0.691,0.347-1.074,0.453C12.309,8.947,11.912,9,11.5,9c-0.119,0-0.24-0.005-0.363-0.016\r\n\tc-0.121-0.01-0.242-0.026-0.363-0.047l-6.297,6.297c-0.25,0.25-0.535,0.44-0.855,0.57S2.966,16,2.617,16\r\n\tc-0.359,0-0.698-0.069-1.016-0.207c-0.318-0.138-0.595-0.325-0.832-0.562c-0.237-0.237-0.425-0.515-0.562-0.832\r\n\tC0.069,14.081,0,13.742,0,13.383c0-0.349,0.065-0.684,0.195-1.004c0.13-0.32,0.32-0.605,0.57-0.855l6.297-6.297\r\n\tc-0.021-0.12-0.037-0.241-0.047-0.363C7.005,4.741,7,4.62,7,4.5c0-0.411,0.053-0.809,0.16-1.191\r\n\tc0.106-0.383,0.258-0.741,0.453-1.074C7.809,1.901,8.044,1.597,8.32,1.32c0.276-0.276,0.581-0.512,0.914-0.707\r\n\tc0.334-0.195,0.691-0.346,1.074-0.453C10.691,0.054,11.09,0,11.5,0c0.281,0,0.541,0.022,0.777,0.066\r\n\tc0.238,0.044,0.465,0.108,0.684,0.191c0.219,0.083,0.436,0.181,0.648,0.293c0.215,0.112,0.438,0.236,0.672,0.371L11.203,4L12,4.797\r\n\tL15.078,1.719z M11.5,8c0.484,0,0.939-0.092,1.363-0.277c0.426-0.185,0.795-0.435,1.109-0.75c0.316-0.315,0.566-0.685,0.75-1.109\r\n\tC14.908,5.439,15,4.984,15,4.5c0-0.38-0.062-0.747-0.188-1.102L12,6.203L9.797,4l2.805-2.812C12.248,1.062,11.881,1,11.5,1\r\n\tc-0.484,0-0.938,0.093-1.363,0.277c-0.424,0.185-0.793,0.435-1.109,0.75c-0.315,0.315-0.565,0.685-0.75,1.109\r\n\tC8.092,3.562,8,4.016,8,4.5c0,0.183,0.016,0.359,0.047,0.531s0.067,0.344,0.109,0.516l-6.68,6.688\r\n\tc-0.151,0.151-0.269,0.326-0.352,0.523C1.042,12.956,1,13.164,1,13.383s0.043,0.428,0.129,0.625c0.086,0.198,0.202,0.37,0.348,0.516\r\n\tc0.146,0.146,0.317,0.262,0.516,0.348C2.19,14.957,2.398,15,2.617,15s0.427-0.042,0.625-0.125c0.198-0.083,0.372-0.2,0.523-0.352\r\n\tl6.688-6.68c0.172,0.042,0.344,0.078,0.516,0.109S11.318,8,11.5,8z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Unknown_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14.703,5.516c-0.178-0.635-0.429-1.23-0.754-1.785c-0.326-0.555-0.715-1.059-1.168-1.512\r\n\ts-0.957-0.842-1.512-1.168c-0.555-0.325-1.15-0.577-1.785-0.754C8.849,0.12,8.188,0.031,7.5,0.031S6.151,0.12,5.516,0.297\r\n\tC4.88,0.474,4.285,0.726,3.73,1.051C3.176,1.376,2.672,1.766,2.219,2.219S1.376,3.176,1.051,3.73\r\n\tC0.725,4.285,0.474,4.88,0.297,5.516C0.12,6.151,0.031,6.812,0.031,7.5S0.12,8.849,0.297,9.484c0.177,0.636,0.428,1.23,0.754,1.785\r\n\tc0.325,0.555,0.715,1.059,1.168,1.512s0.957,0.843,1.512,1.168c0.555,0.326,1.149,0.577,1.785,0.754\r\n\tc0.635,0.178,1.297,0.266,1.984,0.266s1.349-0.088,1.984-0.266c0.635-0.177,1.23-0.428,1.785-0.754\r\n\tc0.555-0.325,1.059-0.715,1.512-1.168s0.842-0.957,1.168-1.512c0.325-0.555,0.576-1.149,0.754-1.785\r\n\tc0.177-0.635,0.266-1.297,0.266-1.984S14.88,6.151,14.703,5.516z M13.797,9.234c-0.156,0.558-0.377,1.078-0.66,1.562\r\n\tc-0.284,0.484-0.624,0.925-1.02,1.32c-0.396,0.396-0.836,0.736-1.32,1.02c-0.484,0.284-1.006,0.504-1.562,0.66\r\n\tc-0.558,0.156-1.136,0.234-1.734,0.234c-0.599,0-1.177-0.078-1.734-0.234c-0.558-0.156-1.078-0.376-1.562-0.66\r\n\tc-0.484-0.283-0.925-0.623-1.32-1.02c-0.396-0.396-0.736-0.836-1.02-1.32c-0.284-0.484-0.504-1.005-0.66-1.562\r\n\tC1.047,8.677,0.969,8.099,0.969,7.5c0-0.599,0.078-1.177,0.234-1.734c0.156-0.557,0.376-1.078,0.66-1.562\r\n\tc0.284-0.484,0.624-0.924,1.02-1.32c0.396-0.396,0.836-0.735,1.32-1.02c0.484-0.284,1.005-0.504,1.562-0.66\r\n\tC6.323,1.047,6.901,0.969,7.5,0.969c0.599,0,1.177,0.078,1.734,0.234c0.557,0.156,1.078,0.376,1.562,0.66\r\n\tc0.484,0.284,0.924,0.624,1.32,1.02c0.396,0.396,0.735,0.836,1.02,1.32c0.283,0.484,0.504,1.005,0.66,1.562\r\n\tc0.156,0.558,0.234,1.136,0.234,1.734C14.031,8.099,13.953,8.677,13.797,9.234z M7,11h1v1H7V11z M9.801,5.031\r\n\tC9.934,5.333,10,5.656,10,6c0,0.312-0.05,0.585-0.148,0.816c-0.1,0.232-0.223,0.441-0.371,0.629S9.172,7.804,9,7.957\r\n\tC8.828,8.111,8.668,8.265,8.52,8.418C8.371,8.572,8.247,8.736,8.148,8.91C8.049,9.085,8,9.281,8,9.5V10H7V9.5\r\n\tc0-0.312,0.049-0.584,0.148-0.816C7.247,8.452,7.371,8.242,7.52,8.055S7.828,7.697,8,7.543C8.172,7.39,8.332,7.236,8.48,7.082\r\n\tc0.148-0.153,0.272-0.316,0.371-0.488C8.95,6.422,9,6.224,9,6c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.185-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.294-0.242-0.477-0.32C7.903,4.539,7.708,4.5,7.5,4.5c-0.208,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.341,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C6.039,5.597,6,5.792,6,6H5\r\n\tc0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539S7.156,3.5,7.5,3.5\r\n\ts0.667,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539S9.668,4.729,9.801,5.031z"},{type:"path",className:"OfficeIconColors_m20",d:"M14.531,7.5c0,0.642-0.085,1.271-0.253,1.869c-0.166,0.594-0.405,1.159-0.71,1.68\r\n\tc-0.306,0.521-0.675,0.999-1.098,1.422c-0.426,0.426-0.904,0.795-1.422,1.098c-0.517,0.303-1.082,0.542-1.68,0.71\r\n\tc-0.599,0.168-1.228,0.253-1.869,0.253c-0.643,0-1.271-0.085-1.869-0.253c-0.597-0.167-1.162-0.406-1.681-0.71\r\n\tc-0.52-0.304-0.998-0.674-1.421-1.098c-0.424-0.423-0.794-0.901-1.098-1.422c-0.304-0.518-0.543-1.083-0.71-1.68\r\n\tC0.554,8.771,0.469,8.142,0.469,7.5c0-0.642,0.085-1.271,0.253-1.869C0.89,5.033,1.128,4.468,1.432,3.95\r\n\tc0.304-0.518,0.673-0.997,1.098-1.421C2.952,2.106,3.431,1.737,3.95,1.432c0.521-0.305,1.085-0.544,1.681-0.71\r\n\tc1.194-0.336,2.54-0.336,3.738,0c0.597,0.167,1.161,0.406,1.681,0.71c0.518,0.304,0.995,0.673,1.421,1.097\r\n\tc0.424,0.425,0.793,0.903,1.098,1.421c0.305,0.521,0.543,1.086,0.71,1.68C14.446,6.229,14.531,6.858,14.531,7.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M7.5,0.031c0.688,0,1.349,0.089,1.984,0.266c0.635,0.177,1.23,0.429,1.785,0.754\r\n\tc0.555,0.326,1.059,0.715,1.512,1.168s0.842,0.957,1.168,1.512c0.325,0.555,0.576,1.15,0.754,1.785\r\n\tc0.177,0.636,0.266,1.297,0.266,1.984s-0.089,1.349-0.266,1.984c-0.178,0.636-0.429,1.23-0.754,1.785\r\n\tc-0.326,0.555-0.715,1.059-1.168,1.512s-0.957,0.843-1.512,1.168c-0.555,0.326-1.15,0.577-1.785,0.754\r\n\tc-0.636,0.178-1.297,0.266-1.984,0.266s-1.349-0.088-1.984-0.266c-0.636-0.177-1.23-0.428-1.785-0.754\r\n\tc-0.555-0.325-1.059-0.715-1.512-1.168s-0.843-0.957-1.168-1.512c-0.326-0.555-0.577-1.149-0.754-1.785\r\n\tC0.12,8.849,0.031,8.188,0.031,7.5S0.12,6.151,0.297,5.516C0.474,4.88,0.725,4.285,1.051,3.73c0.325-0.555,0.715-1.059,1.168-1.512\r\n\tS3.176,1.376,3.73,1.051C4.285,0.726,4.88,0.474,5.516,0.297C6.151,0.12,6.812,0.031,7.5,0.031z M7.5,14.031\r\n\tc0.599,0,1.177-0.078,1.734-0.234c0.557-0.156,1.078-0.376,1.562-0.66c0.484-0.283,0.924-0.623,1.32-1.02\r\n\tc0.396-0.396,0.735-0.836,1.02-1.32c0.283-0.484,0.504-1.005,0.66-1.562c0.156-0.557,0.234-1.135,0.234-1.734\r\n\tc0-0.599-0.078-1.177-0.234-1.734c-0.156-0.557-0.377-1.078-0.66-1.562c-0.284-0.484-0.624-0.924-1.02-1.32\r\n\tc-0.396-0.396-0.836-0.735-1.32-1.02c-0.484-0.284-1.006-0.504-1.562-0.66C8.677,1.047,8.099,0.969,7.5,0.969\r\n\tc-0.599,0-1.177,0.078-1.734,0.234C5.208,1.359,4.688,1.58,4.203,1.863c-0.484,0.284-0.925,0.624-1.32,1.02\r\n\tc-0.396,0.396-0.736,0.836-1.02,1.32c-0.284,0.484-0.504,1.005-0.66,1.562C1.047,6.323,0.969,6.901,0.969,7.5\r\n\tc0,0.599,0.078,1.177,0.234,1.734c0.156,0.558,0.376,1.078,0.66,1.562c0.284,0.484,0.624,0.925,1.02,1.32\r\n\tc0.396,0.396,0.836,0.736,1.32,1.02c0.484,0.284,1.005,0.504,1.562,0.66C6.323,13.953,6.901,14.031,7.5,14.031z"},{type:"path",className:"OfficeIconColors_m24",d:"M7.5,3.5c0.344,0,0.667,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC9.934,5.333,10,5.656,10,6c0,0.312-0.05,0.585-0.148,0.816c-0.1,0.232-0.223,0.441-0.371,0.629S9.172,7.804,9,7.957\r\n\tC8.828,8.111,8.668,8.265,8.52,8.418C8.371,8.572,8.247,8.736,8.148,8.91C8.049,9.085,8,9.281,8,9.5V10H7V9.5\r\n\tc0-0.312,0.049-0.584,0.148-0.816C7.247,8.452,7.371,8.242,7.52,8.055S7.828,7.697,8,7.543C8.172,7.39,8.332,7.236,8.48,7.082\r\n\tc0.148-0.153,0.272-0.316,0.371-0.488C8.95,6.422,9,6.224,9,6c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.185-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.294-0.242-0.477-0.32C7.903,4.539,7.708,4.5,7.5,4.5c-0.208,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.341,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C6.039,5.597,6,5.792,6,6H5\r\n\tc0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539S7.156,3.5,7.5,3.5z M7,11h1v1H7V11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshHistory_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8,4v4.289l2.852,2.859l-0.703,0.703L7,8.711V4H8z M15.375,4.883C15.792,5.883,16,6.922,16,8\r\n\ts-0.208,2.117-0.625,3.117c-0.406,0.953-0.979,1.8-1.719,2.539c-0.74,0.74-1.586,1.313-2.539,1.719C10.117,15.792,9.078,16,8,16\r\n\tc-0.906,0-1.781-0.148-2.625-0.445c-0.823-0.286-1.576-0.693-2.258-1.219C2.44,13.81,1.859,13.19,1.375,12.477\r\n\tc-0.245-0.359-0.458-0.734-0.641-1.125c-0.177-0.391-0.323-0.797-0.438-1.219l0.961-0.266c0.208,0.755,0.529,1.448,0.961,2.078\r\n\tc0.438,0.63,0.953,1.172,1.547,1.625c0.594,0.453,1.253,0.805,1.977,1.055S7.219,15,8,15c0.641,0,1.258-0.083,1.852-0.25\r\n\tc0.599-0.167,1.156-0.401,1.672-0.703c0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414\r\n\tc0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8c0-0.641-0.083-1.258-0.25-1.852\r\n\tc-0.167-0.599-0.404-1.156-0.711-1.672c-0.302-0.521-0.667-0.995-1.094-1.422c-0.427-0.427-0.901-0.792-1.422-1.094\r\n\tC11.008,1.654,10.45,1.417,9.852,1.25C9.258,1.083,8.641,1,8,1C7.323,1,6.667,1.096,6.031,1.289C5.396,1.477,4.802,1.745,4.25,2.094\r\n\tC3.703,2.443,3.208,2.865,2.766,3.359C2.328,3.849,1.966,4.396,1.68,5H4v1H0V2h1v2.141c0.089-0.167,0.185-0.328,0.289-0.484\r\n\tc0.104-0.161,0.214-0.318,0.328-0.469C2.107,2.536,2.68,1.974,3.336,1.5C4.023,1.01,4.76,0.638,5.547,0.383C6.333,0.128,7.151,0,8,0\r\n\tc1.078,0,2.117,0.208,3.117,0.625c0.953,0.406,1.8,0.979,2.539,1.719C14.396,3.083,14.969,3.93,15.375,4.883z"},{type:"path",className:"OfficeIconColors_m20",d:"M8,1c3.866,0,7,3.134,7,7s-3.134,7-7,7s-7-3.134-7-7S4.134,1,8,1z"},{type:"path",className:"OfficeIconColors_m22",d:"M8,4v4.289l2.852,2.859l-0.703,0.703L7,8.711V4H8z M15.375,4.883C15.792,5.883,16,6.922,16,8\r\n\ts-0.208,2.117-0.625,3.117c-0.406,0.953-0.979,1.8-1.719,2.539c-0.74,0.74-1.586,1.313-2.539,1.719C10.117,15.792,9.078,16,8,16\r\n\tc-0.906,0-1.781-0.148-2.625-0.445c-0.823-0.286-1.576-0.693-2.258-1.219C2.44,13.81,1.859,13.19,1.375,12.477\r\n\tc-0.245-0.359-0.458-0.734-0.641-1.125c-0.177-0.391-0.323-0.797-0.438-1.219l0.961-0.266c0.208,0.755,0.529,1.448,0.961,2.078\r\n\tc0.438,0.63,0.953,1.172,1.547,1.625c0.594,0.453,1.253,0.805,1.977,1.055S7.219,15,8,15c0.641,0,1.258-0.083,1.852-0.25\r\n\tc0.599-0.167,1.156-0.401,1.672-0.703c0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414\r\n\tc0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8c0-0.641-0.083-1.258-0.25-1.852\r\n\tc-0.167-0.599-0.404-1.156-0.711-1.672c-0.302-0.521-0.667-0.995-1.094-1.422c-0.427-0.427-0.901-0.792-1.422-1.094\r\n\tC11.008,1.654,10.45,1.417,9.852,1.25C9.258,1.083,8.641,1,8,1C7.323,1,6.667,1.096,6.031,1.289C5.396,1.477,4.802,1.745,4.25,2.094\r\n\tC3.703,2.443,3.208,2.865,2.766,3.359C2.328,3.849,1.966,4.396,1.68,5H4v1H0V2h1v2.141c0.089-0.167,0.185-0.328,0.289-0.484\r\n\tc0.104-0.161,0.214-0.318,0.328-0.469C2.107,2.536,2.68,1.974,3.336,1.5C4.023,1.01,4.76,0.638,5.547,0.383C6.333,0.128,7.151,0,8,0\r\n\tc1.078,0,2.117,0.208,3.117,0.625c0.953,0.406,1.8,0.979,2.539,1.719C14.396,3.083,14.969,3.93,15.375,4.883z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BackChevron_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1272 1728 l -696 -696 l 696 -697 l 114 113 l -584 584 l 584 583 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 1272 1728 l -696 -696 l 696 -697 l 114 113 l -584 584 l 584 583 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Medical_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.5,5c0.344,0,0.666,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC15.934,6.833,16,7.156,16,7.5c0,0.297-0.05,0.581-0.148,0.852c-0.1,0.271-0.237,0.515-0.414,0.73\r\n\tc-0.178,0.217-0.389,0.4-0.633,0.551C14.56,9.784,14.291,9.891,14,9.953v0.797c0,0.464-0.058,0.916-0.172,1.355\r\n\tc-0.115,0.44-0.277,0.855-0.488,1.246s-0.467,0.748-0.766,1.07c-0.3,0.323-0.636,0.602-1.008,0.836\r\n\tc-0.373,0.234-0.775,0.417-1.207,0.547C9.927,15.936,9.474,16,9,16c-0.474,0-0.927-0.064-1.359-0.195\r\n\tc-0.433-0.13-0.835-0.312-1.207-0.547c-0.373-0.234-0.708-0.513-1.008-0.836c-0.3-0.322-0.555-0.68-0.766-1.07\r\n\ts-0.374-0.806-0.488-1.246C4.057,11.666,4,11.214,4,10.75V8.961C3.359,8.904,2.79,8.75,2.293,8.5\r\n\tC1.795,8.25,1.377,7.922,1.039,7.516C0.7,7.109,0.442,6.638,0.266,6.102C0.088,5.565,0,4.984,0,4.359V0h2.5\r\n\tc0.135,0,0.252,0.05,0.352,0.148C2.95,0.248,3,0.365,3,0.5c0,0.136-0.05,0.253-0.148,0.352C2.752,0.951,2.635,1,2.5,1H1v3.359\r\n\tc0,0.552,0.077,1.052,0.23,1.5C1.384,6.308,1.609,6.69,1.906,7.008C2.203,7.326,2.569,7.57,3.004,7.742C3.438,7.914,3.938,8,4.5,8\r\n\tc0.526,0,1.005-0.081,1.438-0.242C6.37,7.597,6.738,7.365,7.043,7.062c0.305-0.302,0.54-0.668,0.707-1.098\r\n\tC7.917,5.535,8,5.055,8,4.523V1H6.5C6.364,1,6.247,0.951,6.148,0.852C6.049,0.753,6,0.636,6,0.5c0-0.135,0.049-0.252,0.148-0.352\r\n\tC6.247,0.05,6.364,0,6.5,0H9v4.359c0,0.625-0.089,1.206-0.266,1.742C8.557,6.638,8.299,7.109,7.961,7.516\r\n\tC7.622,7.922,7.204,8.25,6.707,8.5C6.209,8.75,5.641,8.904,5,8.961v1.789c0,0.558,0.1,1.093,0.301,1.605\r\n\tc0.2,0.514,0.479,0.965,0.836,1.355c0.356,0.391,0.778,0.703,1.266,0.938C7.889,14.883,8.422,15,9,15s1.11-0.117,1.598-0.352\r\n\tc0.486-0.234,0.908-0.547,1.266-0.938c0.356-0.391,0.635-0.842,0.836-1.355C12.899,11.843,13,11.308,13,10.75V9.953\r\n\tc-0.292-0.062-0.561-0.169-0.805-0.32c-0.245-0.15-0.456-0.334-0.633-0.551c-0.178-0.216-0.315-0.459-0.414-0.73\r\n\tC11.049,8.081,11,7.797,11,7.5c0-0.344,0.064-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539\r\n\tS13.156,5,13.5,5z M13.5,9c0.208,0,0.403-0.039,0.586-0.117c0.182-0.078,0.341-0.185,0.477-0.32c0.135-0.135,0.242-0.294,0.32-0.477\r\n\tC14.961,7.904,15,7.708,15,7.5c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.186-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.295-0.242-0.477-0.32C13.903,6.039,13.708,6,13.5,6c-0.209,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.342,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C12.039,7.097,12,7.292,12,7.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.078,0.183,0.185,0.341,0.32,0.477c0.135,0.136,0.294,0.242,0.477,0.32\r\n\tC13.096,8.961,13.291,9,13.5,9z"},{type:"path",className:"OfficeIconColors_m20",d:"M13.5,9.5L13.5,9.5c-1.1,0-2-0.9-2-2v0c0-1.1,0.9-2,2-2h0c1.1,0,2,0.9,2,2v0C15.5,8.6,14.6,9.5,13.5,9.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M13.5,5c0.344,0,0.666,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC15.934,6.833,16,7.156,16,7.5c0,0.297-0.05,0.581-0.148,0.852c-0.1,0.271-0.237,0.515-0.414,0.73\r\n\tc-0.178,0.217-0.389,0.4-0.633,0.551C14.56,9.784,14.291,9.891,14,9.953v0.797c0,0.464-0.058,0.916-0.172,1.355\r\n\tc-0.115,0.44-0.277,0.855-0.488,1.246s-0.467,0.748-0.766,1.07c-0.3,0.323-0.636,0.602-1.008,0.836\r\n\tc-0.373,0.234-0.775,0.417-1.207,0.547C9.927,15.936,9.474,16,9,16c-0.474,0-0.927-0.064-1.359-0.195\r\n\tc-0.433-0.13-0.835-0.312-1.207-0.547c-0.373-0.234-0.708-0.513-1.008-0.836c-0.3-0.322-0.555-0.68-0.766-1.07\r\n\ts-0.374-0.806-0.488-1.246C4.057,11.666,4,11.214,4,10.75V8.961C3.359,8.904,2.79,8.75,2.293,8.5\r\n\tC1.795,8.25,1.377,7.922,1.039,7.516C0.7,7.109,0.442,6.638,0.266,6.102C0.088,5.565,0,4.984,0,4.359V0h2.5\r\n\tc0.135,0,0.252,0.05,0.352,0.148C2.95,0.248,3,0.365,3,0.5c0,0.136-0.05,0.253-0.148,0.352C2.752,0.951,2.635,1,2.5,1H1v3.359\r\n\tc0,0.552,0.077,1.052,0.23,1.5C1.384,6.308,1.609,6.69,1.906,7.008C2.203,7.326,2.569,7.57,3.004,7.742C3.438,7.914,3.938,8,4.5,8\r\n\tc0.526,0,1.005-0.081,1.438-0.242C6.37,7.597,6.738,7.365,7.043,7.062c0.305-0.302,0.54-0.668,0.707-1.098\r\n\tC7.917,5.535,8,5.055,8,4.523V1H6.5C6.364,1,6.247,0.951,6.148,0.852C6.049,0.753,6,0.636,6,0.5c0-0.135,0.049-0.252,0.148-0.352\r\n\tC6.247,0.05,6.364,0,6.5,0H9v4.359c0,0.625-0.089,1.206-0.266,1.742C8.557,6.638,8.299,7.109,7.961,7.516\r\n\tC7.622,7.922,7.204,8.25,6.707,8.5C6.209,8.75,5.641,8.904,5,8.961v1.789c0,0.558,0.1,1.093,0.301,1.605\r\n\tc0.2,0.514,0.479,0.965,0.836,1.355c0.356,0.391,0.778,0.703,1.266,0.938C7.889,14.883,8.422,15,9,15s1.11-0.117,1.598-0.352\r\n\tc0.486-0.234,0.908-0.547,1.266-0.938c0.356-0.391,0.635-0.842,0.836-1.355C12.899,11.843,13,11.308,13,10.75V9.953\r\n\tc-0.292-0.062-0.561-0.169-0.805-0.32c-0.245-0.15-0.456-0.334-0.633-0.551c-0.178-0.216-0.315-0.459-0.414-0.73\r\n\tC11.049,8.081,11,7.797,11,7.5c0-0.344,0.064-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539\r\n\tS13.156,5,13.5,5z M13.5,9c0.208,0,0.403-0.039,0.586-0.117c0.182-0.078,0.341-0.185,0.477-0.32c0.135-0.135,0.242-0.294,0.32-0.477\r\n\tC14.961,7.904,15,7.708,15,7.5c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.186-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.295-0.242-0.477-0.32C13.903,6.039,13.708,6,13.5,6c-0.209,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.342,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C12.039,7.097,12,7.292,12,7.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.078,0.183,0.185,0.341,0.32,0.477c0.135,0.136,0.294,0.242,0.477,0.32\r\n\tC13.096,8.961,13.291,9,13.5,9z"}],viewBox:"0 0 16 16"},{type:"svg",id:"QueryList_16",children:[{type:"path",d:"M1664 128H0V0h1664v128zm0 512H0V512h1664v128zM0 1024h768v128H0v-128zm2048 0v219l-384 384v421h-384v-421l-384-384v-219h1152zm-128 128h-896v37l384 384v347h128v-347l384-384v-37z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PermissionsKey_16",children:[{type:"path",className:"OfficeIconColors_m227",d:"M15 12.7109L9.60938 7.32031C9.72396 7.02344 9.81771 6.72656 9.89062 6.42969C9.96354 6.1276 10 5.81771 10 5.5C10 4.88021 9.88021 4.29688 9.64062 3.75C9.40625 3.20312 9.08594 2.72656 8.67969 2.32031C8.27344 1.91406 7.79688 1.59375 7.25 1.35938C6.70312 1.11979 6.11979 1 5.5 1C4.88021 1 4.29688 1.11979 3.75 1.35938C3.20312 1.59375 2.72656 1.91406 2.32031 2.32031C1.91406 2.72656 1.59115 3.20312 1.35156 3.75C1.11719 4.29688 1 4.88021 1 5.5C1 6.11979 1.11719 6.70312 1.35156 7.25C1.59115 7.79688 1.91406 8.27344 2.32031 8.67969C2.72656 9.08594 3.20312 9.40885 3.75 9.64844C4.29688 9.88281 4.88021 10 5.5 10C6.00521 10 6.5 9.91406 6.98438 9.74219C7.47396 9.57031 7.91406 9.32292 8.30469 9H9V11H11V13H13V15H15V12.7109Z"},{type:"path",className:"OfficeIconColors_m2148",d:"M16 12.2891V16H12V14H10V12H8V10.3828C7.61458 10.5859 7.21094 10.7396 6.78906 10.8438C6.36719 10.9479 5.9375 11 5.5 11C4.99479 11 4.50781 10.9349 4.03906 10.8047C3.57031 10.6745 3.13281 10.4896 2.72656 10.25C2.32031 10.0104 1.94792 9.72396 1.60938 9.39062C1.27604 9.05208 0.989583 8.67969 0.75 8.27344C0.510417 7.86719 0.325521 7.42969 0.195312 6.96094C0.0651042 6.49219 0 6.00521 0 5.5C0 4.99479 0.0651042 4.50781 0.195312 4.03906C0.325521 3.57031 0.510417 3.13281 0.75 2.72656C0.989583 2.32031 1.27604 1.95052 1.60938 1.61719C1.94792 1.27865 2.32031 0.989583 2.72656 0.75C3.13281 0.510417 3.57031 0.325521 4.03906 0.195312C4.50781 0.0651042 4.99479 0 5.5 0C6.00521 0 6.49219 0.0651042 6.96094 0.195312C7.42969 0.325521 7.86719 0.510417 8.27344 0.75C8.67969 0.989583 9.04948 1.27865 9.38281 1.61719C9.72135 1.95052 10.0104 2.32031 10.25 2.72656C10.4896 3.13281 10.6745 3.57031 10.8047 4.03906C10.9349 4.50781 11 4.99479 11 5.5C11 5.76562 10.9792 6.02865 10.9375 6.28906C10.8958 6.54948 10.8359 6.80469 10.7578 7.05469L16 12.2891ZM15 12.7109L9.60938 7.32031C9.72396 7.02344 9.81771 6.72656 9.89062 6.42969C9.96354 6.1276 10 5.81771 10 5.5C10 4.88021 9.88021 4.29688 9.64062 3.75C9.40625 3.20312 9.08594 2.72656 8.67969 2.32031C8.27344 1.91406 7.79688 1.59375 7.25 1.35938C6.70312 1.11979 6.11979 1 5.5 1C4.88021 1 4.29688 1.11979 3.75 1.35938C3.20312 1.59375 2.72656 1.91406 2.32031 2.32031C1.91406 2.72656 1.59115 3.20312 1.35156 3.75C1.11719 4.29688 1 4.88021 1 5.5C1 6.11979 1.11719 6.70312 1.35156 7.25C1.59115 7.79688 1.91406 8.27344 2.32031 8.67969C2.72656 9.08594 3.20312 9.40885 3.75 9.64844C4.29688 9.88281 4.88021 10 5.5 10C6.00521 10 6.5 9.91406 6.98438 9.74219C7.47396 9.57031 7.91406 9.32292 8.30469 9H9V11H11V13H13V15H15V12.7109ZM4 3C4.14062 3 4.27083 3.02604 4.39062 3.07812C4.51042 3.13021 4.61458 3.20312 4.70312 3.29688C4.79688 3.38542 4.86979 3.48958 4.92188 3.60938C4.97396 3.72917 5 3.85938 5 4C5 4.14062 4.97396 4.27083 4.92188 4.39062C4.86979 4.51042 4.79688 4.61719 4.70312 4.71094C4.61458 4.79948 4.51042 4.86979 4.39062 4.92188C4.27083 4.97396 4.14062 5 4 5C3.85938 5 3.72917 4.97396 3.60938 4.92188C3.48958 4.86979 3.38281 4.79948 3.28906 4.71094C3.20052 4.61719 3.13021 4.51042 3.07812 4.39062C3.02604 4.27083 3 4.14062 3 4C3 3.85938 3.02604 3.72917 3.07812 3.60938C3.13021 3.48958 3.20052 3.38542 3.28906 3.29688C3.38281 3.20312 3.48958 3.13021 3.60938 3.07812C3.72917 3.02604 3.85938 3 4 3Z"}],viewBox:"0 0 16 16"}]}},21e3:function(Pt,vt,m){"use strict";m.d(vt,{H:function(){return Ee}});var M=m(82762),u=m(33554),e=m(9936),F=m(14172),oe=m(48787),D=m(50423),Re=m(47754),Be=m(15910),Ee=function(){function pe(R,Fe){this.profileImageService=R,this.userHttpService=Fe,this.usersCache={}}return pe.prototype.getUserPhoto=function(R){return(0,M.D)(this.profileImageService.getOtherUserPhoto(R))},pe.prototype.getUserDetails=function(R){var Fe=this;R=_.filter(R,function(ve){return!!ve});var De=[],G=[];if(_.isEmpty(R))return(0,M.D)([]);for(var We=0,Ue=R;We<Ue.length;We++){var se=Ue[We].toLowerCase();this.usersCache[se]||(this.usersCache[se]=new u.t(1),G.push(se)),De.push(this.usersCache[se])}return _.isEmpty(G)||this.userHttpService.getUserDetails(G).pipe((0,oe.q)(1)).subscribe(function(ve){var Se={};if(_.some(ve?.data))for(var W=0,He=ve?.data;W<He.length;W++){var je=(he=He[W]).userPrincipalName,rt=he.objectId;Fe.upsert(he.emailAddress,he,Se),Fe.upsert(je,he,Se),Fe.upsert(rt,he,Se)}for(var Q=0,K=_.filter(G,function(ee){return!Se[ee]});Q<K.length;Q++){var he;Fe.usersCache[he=K[Q]].next(void 0),Fe.usersCache[he].complete()}},function(){for(var ve,Se,W=0,He=G;W<He.length;W++){var he=He[W];null===(ve=Fe.usersCache[he])||void 0===ve||ve.next(void 0),null===(Se=Fe.usersCache[he])||void 0===Se||Se.complete(),delete Fe.usersCache[he]}}),(0,e.D)(De).pipe((0,F.U)(function(ve){return _.filter(ve,function(Se){return!!Se})}))},pe.prototype.findUsers=function(R,Fe){return this.userHttpService.findUsers(R,1,Fe,!0,!0).pipe((0,F.U)(function(De){return De?.data}))},pe.prototype.upsert=function(R,Fe,De){if(R){var G=R.toLowerCase();this.usersCache[G]||(this.usersCache[G]=new u.t(1)),this.usersCache[G].next(Fe),this.usersCache[G].complete(),De[G]=!0}},pe.\u0275fac=function(Fe){return new(Fe||pe)(D.\u0275\u0275inject(Re.L),D.\u0275\u0275inject(Be.W))},pe.\u0275prov=D.\u0275\u0275defineInjectable({token:pe,factory:pe.\u0275fac,providedIn:"root"}),pe}()},6342:function(Pt,vt,m){"use strict";m.d(vt,{N:function(){return pe}});var M=m(21e3),u=m(77476),e=m(10723),F=m(79061),oe=m(76037),D=m(56545),Re=m(88717),Be=m(68264),Ee=m(50423),pe=function(){function R(){}return R.\u0275fac=function(De){return new(De||R)},R.\u0275mod=Ee.\u0275\u0275defineNgModule({type:R}),R.\u0275inj=Ee.\u0275\u0275defineInjector({providers:[{provide:e.K,useClass:M.H}],imports:[u.CommonModule,F.v,oe.J,D.g,Re.R,Be.z]}),R}()},5432:function(Pt,vt,m){"use strict";m.d(vt,{d:function(){return K}});var M=m(81337),u=m(50423),e=m(3613),F=function(){function ee(ae){this.cultureService=ae,this.currencyRecentFormats=[]}return ee.prototype.getCurrencyGeneralFormat=function(){return this.currencyGeneralFormat||(this.currencyGeneralFormat={culture:null,displayLabel:this.localizationService.get("Format_Label_Currency_General"),symbol:"$",positivePattern:0,negativePattern:0,formatType:"CurrencyGeneral"}),this.currencyGeneralFormat},ee.prototype.getCurrencyCommonFormats=function(){if(!this.currencyCommonFormats){var ae=_.filter(this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo(),function(fe){return"en-US"===fe.culture||"en-GB"===fe.culture||"fr-CH"===fe.culture||null===fe.culture});this.currencyCommonFormats=_.flatten([this.getCurrencyGeneralFormat(),ae.find(function(fe){return"en-US"===fe.culture}),ae.find(function(fe){return"en-GB"===fe.culture}),ae.filter(function(fe){return!fe.culture&&"\u20ac"===fe.symbol}),ae.find(function(fe){return!fe.culture&&"\xa5"===fe.symbol}),ae.find(function(fe){return"fr-CH"===fe.culture})])}return this.currencyCommonFormats},ee.prototype.getCurrencyAllFormats=function(){if(!this.currencyAllFormats){var ae=this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo();this.currencyAllFormats=(0,M.__spreadArray)([this.getCurrencyGeneralFormat()],ae,!0)}return this.currencyAllFormats},ee.prototype.getCurrencyAllCultureFormats=function(){return this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo()},ee.prototype.getCurrencyRecentFormats=function(){return this.currencyRecentFormats},ee.\u0275fac=function(fe){return new(fe||ee)(u.\u0275\u0275inject(e.h))},ee.\u0275prov=u.\u0275\u0275defineInjectable({token:ee,factory:ee.\u0275fac,providedIn:"root"}),ee}(),oe=m(61353),D=m(98776),Re=m(18967),Be=m(62458),Ee=m(64560),pe=m(65181),R=m(77476),Fe=m(59968),De=m(48205),G=m(33846),We=m(7970),Ue=m(80357),ne=m(86663),se=m(69437),ve=m(36858),Se=m(85102);function W(ee,ae){if(1&ee&&(u.\u0275\u0275elementStart(0,"mat-option",7),u.\u0275\u0275text(1),u.\u0275\u0275elementEnd()),2&ee){var fe=ae.$implicit;u.\u0275\u0275property("value",fe.value)("pbiTooltip",fe.label),u.\u0275\u0275attribute("aria-label",fe.label),u.\u0275\u0275advance(1),u.\u0275\u0275textInterpolate1(" ",fe.label," ")}}var He=function(ae){return{btnDisabled:ae}},he=function(ae){return{isToggled:ae}};function ye(ee,ae){if(1&ee){var fe=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementContainerStart(0),u.\u0275\u0275elementStart(1,"div",8)(2,"div")(3,"button",9),u.\u0275\u0275listener("click",function(){u.\u0275\u0275restoreView(fe);var ct=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(ct.onCurrencyClicked())}),u.\u0275\u0275pipe(4,"localize"),u.\u0275\u0275pipe(5,"localize"),u.\u0275\u0275element(6,"pbi-office-icon",10),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementStart(7,"button",11),u.\u0275\u0275listener("pbiMenuButtonClick",function(ct){u.\u0275\u0275restoreView(fe);var Ct=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(Ct.onCurrencyItemClicked(ct))}),u.\u0275\u0275pipe(8,"localize"),u.\u0275\u0275pipe(9,"localize"),u.\u0275\u0275element(10,"pbi-icon",12),u.\u0275\u0275elementEnd()(),u.\u0275\u0275elementStart(11,"button",13),u.\u0275\u0275listener("click",function(){u.\u0275\u0275restoreView(fe);var ct=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(ct.onChangePercentageToggle())}),u.\u0275\u0275pipe(12,"localize"),u.\u0275\u0275pipe(13,"localize"),u.\u0275\u0275element(14,"pbi-office-icon",14),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementStart(15,"button",13),u.\u0275\u0275listener("click",function(){u.\u0275\u0275restoreView(fe);var ct=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(ct.onChangeThousandSeparatorToggle())}),u.\u0275\u0275pipe(16,"localize"),u.\u0275\u0275pipe(17,"localize"),u.\u0275\u0275element(18,"pbi-office-icon",15),u.\u0275\u0275elementEnd()(),u.\u0275\u0275elementStart(19,"div",16),u.\u0275\u0275pipe(20,"localize"),u.\u0275\u0275elementStart(21,"span",17),u.\u0275\u0275element(22,"pbi-office-icon",18),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementStart(23,"num-up-down",19),u.\u0275\u0275listener("modelValueChange",function(ct){u.\u0275\u0275restoreView(fe);var Ct=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(Ct.onDecimalPlacesChanged(ct))}),u.\u0275\u0275elementEnd()(),u.\u0275\u0275elementContainerEnd()}if(2&ee){var me=u.\u0275\u0275nextContext();u.\u0275\u0275advance(3),u.\u0275\u0275property("disabled",!me.isNumericFormatEnabled())("pbiTooltip",u.\u0275\u0275pipeBind1(4,22,"Value_Formatting_Tooltip_Currency_Format")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(5,24,"Value_Formatting_ARIA_Label_Currency_Format")),u.\u0275\u0275advance(4),u.\u0275\u0275property("ngClass",u.\u0275\u0275pureFunction1(40,He,!me.isNumericFormatEnabled()))("pbiMenu",me.currencyMenu)("pbiTooltip",u.\u0275\u0275pipeBind1(8,26,"Value_Formatting_Tooltip_Currency_Format"))("disabled",!me.isNumericFormatEnabled()),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(9,28,"Value_Formatting_ARIA_Label_Currency_Format")),u.\u0275\u0275advance(4),u.\u0275\u0275property("ngClass",u.\u0275\u0275pureFunction1(42,he,me.isPercentFormatterToggled()))("disabled",!me.isNumericFormatEnabled())("pbiTooltip",u.\u0275\u0275pipeBind1(12,30,"Value_Formatting_Tooltip_Percentage_Format")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(13,32,"Value_Formatting_ARIA_Label_Percentage_Format")),u.\u0275\u0275advance(4),u.\u0275\u0275property("ngClass",u.\u0275\u0275pureFunction1(44,he,me.isThousandSeparatorToggled()))("disabled",!me.isNumericFormatEnabled(!0))("pbiTooltip",u.\u0275\u0275pipeBind1(16,34,"Ribbon_Tooltip_DataFormatDecimalPlaces")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(17,36,"Value_Formatting_ARIA_Label_Thousands_Separator_Format")),u.\u0275\u0275advance(4),u.\u0275\u0275property("pbiTooltip",u.\u0275\u0275pipeBind1(20,38,"Ribbon_Tooltip_DataFormatDecimalPlaces")),u.\u0275\u0275advance(3),u.\u0275\u0275property("disabled",(null==me.formatInformation?null:me.formatInformation.format)===me.FormatNumberWhole),u.\u0275\u0275advance(1),u.\u0275\u0275property("options",me.options)("useModernStyles",!0)("modelValue",me.formatInformation&&me.formatInformation.accuracy)("isDisabled",!me.isNumericFormatEnabled()||(null==me.formatInformation?null:me.formatInformation.format)===me.FormatNumberWhole)}}function je(ee,ae){if(1&ee&&(u.\u0275\u0275elementStart(0,"mat-option",7),u.\u0275\u0275text(1),u.\u0275\u0275elementEnd()),2&ee){var fe=ae.index,me=u.\u0275\u0275nextContext(3);u.\u0275\u0275property("value",fe)("pbiTooltip",me.categoryListNames[fe]),u.\u0275\u0275advance(1),u.\u0275\u0275textInterpolate1(" ",me.categoryListNames[fe]," ")}}function rt(ee,ae){if(1&ee){var fe=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementContainerStart(0),u.\u0275\u0275elementStart(1,"mat-select",21),u.\u0275\u0275listener("valueChange",function(ct){u.\u0275\u0275restoreView(fe);var Ct=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Ct.selectedCategoryList=ct)}),u.\u0275\u0275pipe(2,"localize"),u.\u0275\u0275template(3,je,2,3,"mat-option",4),u.\u0275\u0275elementStart(4,"div",22)(5,"button",23),u.\u0275\u0275listener("click",function(){u.\u0275\u0275restoreView(fe);var ct=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(ct.launchCategoryListsEditPane(!1))}),u.\u0275\u0275pipe(6,"localize"),u.\u0275\u0275pipe(7,"localize"),u.\u0275\u0275element(8,"span",24),u.\u0275\u0275elementEnd(),u.\u0275\u0275elementStart(9,"button",25),u.\u0275\u0275listener("click",function(){u.\u0275\u0275restoreView(fe);var ct=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(ct.launchCategoryListsEditPane(!0))}),u.\u0275\u0275pipe(10,"localize"),u.\u0275\u0275pipe(11,"localize"),u.\u0275\u0275element(12,"span",26),u.\u0275\u0275elementEnd()()(),u.\u0275\u0275elementContainerEnd()}if(2&ee){var me=u.\u0275\u0275nextContext(2);u.\u0275\u0275advance(1),u.\u0275\u0275property("value",me.selectedCategoryList),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(2,7,"Value_Formatting_ARIA_Label_SelectCategoryListDropdown")),u.\u0275\u0275advance(2),u.\u0275\u0275property("ngForOf",me.goalValueCategoryLists),u.\u0275\u0275advance(2),u.\u0275\u0275property("pbiTooltip",u.\u0275\u0275pipeBind1(6,9,"Manage_Lists")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(7,11,"Manage_Lists")),u.\u0275\u0275advance(4),u.\u0275\u0275property("pbiTooltip",u.\u0275\u0275pipeBind1(10,13,"Create_A_List")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(11,15,"Create_A_List"))}}function Ke(ee,ae){if(1&ee&&u.\u0275\u0275template(0,rt,13,17,"ng-container",20),2&ee){var fe=u.\u0275\u0275nextContext();u.\u0275\u0275property("ngIf",(null==fe.goalValueCategoryLists?null:fe.goalValueCategoryLists.length)>0)}}var Q=[{value:"General",label:"Format_Label_General"},{value:"CurrencyCustom",label:"Format_Label_Currency"},{value:"DateTimeGeneralPattern",label:"Format_Label_DateTime"},{value:"NumberDecimal",label:"DataType_Label_Number"},{value:"NumberWhole",label:"DataType_Label_WholeNumber"},{value:"Percentage",label:"Format_Label_Percentage"},{value:"Scientific",label:"Format_Label_Scientific"},{value:"Text",label:"Text"},{value:"Boolean",label:"DataType_Label_Boolean"},{value:"Binary",label:"DataType_Binary"},{value:"Custom",label:"DataType_Label_Categorical"}],K=function(){function ee(ae,fe,me,$e){this.cultureService=ae,this.currencyFormatService=fe,this.dateTimeFormatService=me,this.localizationService=$e,this.formatStringChange=new u.EventEmitter,this.onSelectedCategoryListChange=new u.EventEmitter,this.availableFormats=[],this.options={unitSymbol:"",minValue:0,maxValue:15},this.FormatNumberWhole="NumberWhole",this.formatUtils=new D.c(this.cultureService.getFormatInfo()),this.allCurrenciesOptions=ae.getAllCurrencySymbolCustomFormatItemsInfo(),this.commonCurrenciesOptions=ae.getAllCommonCurrencySymbolCustomFormatItemsInfo(),this.availableCurrencyFormats=this.generateCurrencyFormatInfoMapping(this.allCurrenciesOptions),this.currencyMenu=this.currencyFormatInfoToPbiMenuAdaptor(this.commonCurrenciesOptions,this.allCurrenciesOptions)}return Object.defineProperty(ee.prototype,"formatString",{set:function(fe){this.formatInformation=this.cultureService.tryParse(fe,this.dataType),fe===ee.CategoricalFormatString&&(this.formatInformation.format="Custom"),this.updateCompatibleFormats()},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"dataType",{get:function(){return this._dataType},set:function(fe){this._dataType=fe,this.formatInformation&&(this.isCategorical?this.formatInformation.format="Custom":this.formatInformation=this.cultureService.tryParse(this.formatInformation.formatString,fe)),this.updateCompatibleFormats()},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"goalValueCategoryLists",{get:function(){return this._goalValueCategoryLists},set:function(fe){var me=this;this.supportCategoricalValues&&(this._goalValueCategoryLists=fe,this.categoryListNames=fe.map(function($e){return me.getCategoryListName($e)}))},enumerable:!1,configurable:!0}),ee.prototype.ngOnInit=function(){this.updateCompatibleFormats()},ee.prototype.isNumericFormatEnabled=function(ae){void 0===ae&&(ae=!1);var fe=this.dataType,me=this.formatInformation&&this.formatInformation.format;return(me&&ae?this.isValidNumericFormat(me):"Custom"!==me)&&(2===fe||3===fe||4===fe||13===fe)},ee.prototype.isThousandSeparatorToggled=function(){return this.formatInformation&&this.formatInformation.thousandSeparator},ee.prototype.isPercentFormatterToggled=function(){return this.formatInformation&&"Percentage"===this.formatInformation.format},ee.prototype.onChangePercentageToggle=function(){var ae;this.formatInformation=this.formatInformation&&"Percentage"===this.formatInformation.format?void 0:this.formatUtils.changeFormat(this.dataType,this.formatInformation,"Percentage"),this.formatStringChange.emit(null===(ae=this.formatInformation)||void 0===ae?void 0:ae.formatString)},ee.prototype.onChangeThousandSeparatorToggle=function(){var ae;this.formatInformation=this.formatUtils.toggleThousandsSeparator(this.dataType,this.formatInformation),this.formatStringChange.emit(null===(ae=this.formatInformation)||void 0===ae?void 0:ae.formatString)},ee.prototype.onCurrencyClicked=function(){var ae;this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,"CurrencyCustom"),this.formatStringChange.emit(null===(ae=this.formatInformation)||void 0===ae?void 0:ae.formatString)},ee.prototype.onCurrencyItemClicked=function(ae){this.availableCurrencyFormats=this.generateCurrencyFormatInfoMapping(this.allCurrenciesOptions);var me=this.availableCurrencyFormats.get(ae.text);this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,"CurrencyCustom"),this.formatInformation=this.formatUtils.setCurrencyFormat(this.dataType,this.formatInformation,this.formatInformation.format,me.culture,me.symbol,me.positivePattern,me.negativePattern),this.formatStringChange.emit(this.formatInformation.formatString)},ee.prototype.onDecimalPlacesChanged=function(ae){this.formatInformation=this.formatUtils.setAccuracy(this.dataType,this.formatInformation,ae),this.formatStringChange.emit(this.formatInformation.formatString)},Object.defineProperty(ee.prototype,"selectedFormat",{get:function(){if(!this.formatInformation)return"General";var fe=this.formatInformation.format;switch(this.formatInformation.format){case"CurrencyCustom":fe="CurrencyCustom";break;case"DateTimeCustom":case"DateTimeGeneralPattern":this.formatInformation.dateTimeCustomFormat&&(fe=this.formatInformation.dateTimeCustomFormat.formatString)}return fe},set:function(fe){var me,$e;switch(fe){case"General":this.formatInformation=void 0;break;case"NumberDecimal":case"NumberWhole":case"Percentage":case"CurrencyCustom":case"Scientific":case"Binary":case"Boolean":case"Text":this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,fe);break;case"Custom":this.formatInformation={format:fe,formatString:ee.CategoricalFormatString,thousandSeparator:void 0,currencyFormat:void 0,dateTimeCustomFormat:void 0},_.isEmpty(this.categoryListNames)?(this.selectedCategoryList=-1,this.formatStringChange.emit(null===(me=this.formatInformation)||void 0===me?void 0:me.formatString),this.launchCategoryListsEditPane(!0)):this.selectedCategoryList=0;break;default:var ct=this.dateTimeFormatService.getFormat(fe);this.formatInformation=this.formatUtils.setDateTimeFormat(this.dataType,this.formatInformation,ct.formatType,ct.pattern,ct.formatString)}this.formatStringChange.emit(null===($e=this.formatInformation)||void 0===$e?void 0:$e.formatString)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"selectedCategoryList",{get:function(){return this.selectedCategoryListIndex},set:function(fe){this.selectedCategoryListIndex=fe,this.onSelectedCategoryListChange.emit(fe)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"isCategorical",{get:function(){var fe;return(null===(fe=this.formatInformation)||void 0===fe?void 0:fe.formatString)===ee.CategoricalFormatString},enumerable:!1,configurable:!0}),ee.prototype.currencyFormatInfoToPbiMenuAdaptor=function(ae,fe){var me=this.buildCommonCurrencyPbiMenu(ae);Be.fF.assertValue(fe,"ICurrencyFormatInfo[] should not be null");var $e={type:Ee.iB.Header,text:this.localizationService.get("All_Currency_Symbols"),tooltip:this.localizationService.get("All_Currency_Symbols")};return me.items.push({type:Ee.iB.Divider}),me.items.push($e),this.forgeMenuOptions(me,fe)},ee.prototype.buildCommonCurrencyPbiMenu=function(ae){var fe={items:[]};Be.fF.assertValue(ae,"ICurrencyFormatInfo[] should not be null");var me={type:Ee.iB.Header,text:this.localizationService.get("Common_Currency_Symbols"),tooltip:this.localizationService.get("Common_Currency_Symbols")};return fe.items.push(me),this.forgeMenuOptions(fe,ae)},ee.prototype.forgeMenuOptions=function(ae,fe){for(var me=ae,$e=0;$e<fe.length;$e++)me.items.push({id:$e,type:Ee.iB.Button,text:fe[$e].displayLabel,tooltip:fe[$e].displayLabel,disabled:!1});return me},ee.prototype.generateCurrencyFormatInfoMapping=function(ae){var fe=new Map;Be.fF.assertValue(ae,"ICurrencyFormatInfo[] should not be null");for(var me=0,$e=ae;me<$e.length;me++){var ct=$e[me];fe.set(ct.displayLabel,ct)}return fe},ee.prototype.isValidNumericFormat=function(ae){return"General"===ae||"CurrencyGeneral"===ae||"CurrencyCustom"===ae||"Scientific"===ae||"Percentage"===ae||"NumberDecimal"===ae||"NumberWhole"===ae||"Custom"===ae},ee.prototype.getCompatibleFormats=function(ae){switch(ae){case 4:case 3:case 2:var fe=["General","NumberWhole","NumberDecimal","CurrencyCustom","Percentage","Scientific"];return this.supportCategoricalValues&&fe.push("Custom"),fe;case 6:case 7:case 9:return[];case 11:return["Binary"];case 5:return["Boolean"];case 1:case 13:return["Text"];default:return["General"]}},ee.prototype.updateCompatibleFormats=function(){var ae=this;switch(this.dataType){case 6:this.availableFormats=_.map(this.dateTimeFormatService.getDateFormats(),function(me){return{value:me.formatString,label:me.displayLabel}});break;case 9:this.availableFormats=_.map(this.dateTimeFormatService.getTimeFormats(),function(me){return{value:me.formatString,label:me.displayLabel}});break;case 7:this.availableFormats=_.map(this.dateTimeFormatService.getCommonFormats(),function(me){return{value:me.formatString,label:me.displayLabel}});break;default:var fe=this.getCompatibleFormats(this.dataType);this.availableFormats=_.filter(_.map(Q,function(me){return{value:me.value,label:ae.localizationService.get(me.label)}}),function(me){return _.some(fe,function($e){return $e===me.value})})}},ee.prototype.getCategoryListName=function(ae){if(_.isEmpty(ae.name)){var fe=_.map(ae.categories,function(me){return me.displayName});return _.join(fe,", ")}return ae.name},ee.CategoricalFormatString="CategoricalFormatString",ee.\u0275fac=function(fe){return new(fe||ee)(u.\u0275\u0275directiveInject(e.h),u.\u0275\u0275directiveInject(F),u.\u0275\u0275directiveInject(oe.u),u.\u0275\u0275directiveInject(pe.o))},ee.\u0275cmp=u.\u0275\u0275defineComponent({type:ee,selectors:[["value-formatting"]],inputs:{formatString:"formatString",dataType:"dataType",supportCategoricalValues:"supportCategoricalValues",goalValueCategoryLists:"goalValueCategoryLists",selectedCategoryListIndex:"selectedCategoryListIndex",launchCategoryListsEditPane:"launchCategoryListsEditPane"},outputs:{formatStringChange:"formatStringChange",onSelectedCategoryListChange:"onSelectedCategoryListChange"},features:[u.\u0275\u0275ProvidersFeature([{provide:F,useClass:F},{provide:Re.c,useClass:e.h},{provide:oe.u,useClass:oe.u}])],decls:10,vars:11,consts:[[1,"valueFormatterToolbarContainer"],[1,"valueFormatterDropdownGroup",3,"pbiTooltip"],["name","PBIDataFormat_16",1,"icon-format"],["pbiMatSelect","","panelClass","pbi-modern-select-panel","disableOptionCentering","","role","combobox",1,"pbi-modern-select","valueFormatDropdown",3,"value","disabled","valueChange"],[3,"value","pbiTooltip",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["categoryListsSelector",""],[3,"value","pbiTooltip"],[1,"valueFormatterToggleButtonsGroup"],[1,"btn","toggleBtn","icon","splitButtonText",3,"disabled","pbiTooltip","click"],["name","CurrencyFormat_16",1,"icon-currency"],[1,"btn","toggleBtn","icon","splitButton",3,"ngClass","pbiMenu","pbiTooltip","disabled","pbiMenuButtonClick"],["name","chevrondownsmall","size","mini",1,"chevrondown"],[1,"btn","toggleBtn","icon","focusOutline",3,"ngClass","disabled","pbiTooltip","click"],["name","Percentage_16"],["name","CommaFormat_16"],[1,"valueFormatterNumUpDownGroup",3,"pbiTooltip"],[1,"icon"],["name","DecreaseDecimals_16",1,"icon-decreaseDecimals",3,"disabled"],["attr.aria-label","'Value_Formatting_ARIA_Label_Decimal_Place_Format' | localize","placeholderText","Auto",1,"numUpDown",3,"options","useModernStyles","modelValue","isDisabled","modelValueChange"],[4,"ngIf"],["pbiMatSelect","","panelClass","pbi-modern-select-panel","disableOptionCentering","","role","combobox",1,"pbi-modern-select","select-category-list-dropdown",3,"value","valueChange"],[1,"edit-category-lists-in-dropdown"],[1,"btn","edit-category-lists-button",3,"pbiTooltip","click"],["localize","Manage_Lists"],[1,"btn","create-category-list-button",3,"pbiTooltip","click"],["localize","Create_A_List"]],template:function(fe,me){if(1&fe&&(u.\u0275\u0275elementStart(0,"div",0)(1,"div",1),u.\u0275\u0275pipe(2,"localize"),u.\u0275\u0275element(3,"pbi-office-icon",2),u.\u0275\u0275elementStart(4,"mat-select",3),u.\u0275\u0275listener("valueChange",function(Ct){return me.selectedFormat=Ct}),u.\u0275\u0275pipe(5,"localize"),u.\u0275\u0275template(6,W,2,4,"mat-option",4),u.\u0275\u0275elementEnd()(),u.\u0275\u0275template(7,ye,24,46,"ng-container",5),u.\u0275\u0275template(8,Ke,1,1,"ng-template",null,6,u.\u0275\u0275templateRefExtractor),u.\u0275\u0275elementEnd()),2&fe){var $e=u.\u0275\u0275reference(9);u.\u0275\u0275advance(1),u.\u0275\u0275property("pbiTooltip",u.\u0275\u0275pipeBind1(2,7,"Value_Formatting_Tooltip_ComboBox")),u.\u0275\u0275advance(3),u.\u0275\u0275property("value",me.selectedFormat)("disabled",me.availableFormats.length<=1),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(5,9,"Value_Formatting_ARIA_Label_ComboBox")),u.\u0275\u0275advance(2),u.\u0275\u0275property("ngForOf",me.availableFormats),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",!me.isCategorical)("ngIfElse",$e)}},dependencies:[R.NgClass,R.NgForOf,R.NgIf,Fe.X,De.x8,G.CK,We.x4,Ue.l8,ne._,se.m,ve.V,Se.F],styles:['.focusOutline[_ngcontent-%COMP%]{outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]{background-color:inherit;border-top:inherit;display:flex;flex-direction:row;padding:8px 10px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;padding-right:13px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]{background-color:var(--fluent-theme-white-color, #FFF);border:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);display:table;height:24px;width:150px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]     .mat-select-arrow{color:var(--fluent-theme-neutral-primary-color, #323130)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatOptions[_ngcontent-%COMP%]{height:30px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]     .mat-select-disabled .mat-select-value{color:var(--fluent-theme-black-color, #000)!important;opacity:.38}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .select-category-list-dropdown[_ngcontent-%COMP%]{width:150px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .edit-category-lists[_ngcontent-%COMP%]:hover, .valueFormatterToolbarContainer[_ngcontent-%COMP%]   .edit-category-lists[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{box-shadow:unset;display:inline-block;height:24px;margin:0;outline:unset;padding:0;vertical-align:middle;width:24px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .icon-arrowDown[_ngcontent-%COMP%]{font-size:xx-small}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:inherit}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]{background-color:var(--fluent-theme-primary-color, #F2C811)!important}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]   .pbi-office-icon[_ngcontent-%COMP%]{fill:var(--button-primary-content-color)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]   .pbi-office-icon[_ngcontent-%COMP%]     svg>path.OfficeIconColors_m22{fill:var(--button-primary-content-color)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;width:15px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]:focus:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]   .chevrondown[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .btnDisabled[_ngcontent-%COMP%]{cursor:default}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButtonText[_ngcontent-%COMP%]{width:16px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButtonText[_ngcontent-%COMP%]:focus:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .focusOutline[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]{margin-left:10px;width:82px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field{width:100%}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown{border:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);background:var(--fluent-theme-white-color, #FFF)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown .navigationButtons .buttonBox{color:var(--fluent-theme-neutral-primary-color, #323130)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown .navigationButtons .buttonBox:hover{background-color:transparent}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field._mat-animation-noopable .mat-form-field-label{height:26px;padding-left:7px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     input{caret-color:var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field-appearance-legacy .mat-form-field-label{top:12px;left:6.5px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field.mat-focused .mat-form-field-label{color:var(--fluent-theme-black-color, #000);opacity:.54}.valueFormatterToolbarContainer[_ngcontent-%COMP%]     .pbi-office-icon{width:16px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .icon-decreaseDecimals[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .icon-format[_ngcontent-%COMP%]{padding-right:10px;padding-top:2px}.edit-category-lists-in-dropdown[_ngcontent-%COMP%]{border-top:1px solid var(--gray-60, #C8C6C4);display:flex;flex-direction:column}.edit-category-lists-button[_ngcontent-%COMP%], .create-category-list-button[_ngcontent-%COMP%]{width:100%;background-color:transparent;border:none;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}.edit-category-lists-button[_ngcontent-%COMP%]:hover, .create-category-list-button[_ngcontent-%COMP%]:hover, .edit-category-lists-button[_ngcontent-%COMP%]:active, .create-category-list-button[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}']}),ee}()},90127:function(Pt,vt,m){"use strict";m.d(vt,{D:function(){return oe}});var M=m(62458),u=m(50423),e=m(9380),F=m(82621),oe=function(){function D(Re,Be){this.featureSwitchServices=Re,this.formatValuePipe=Be}return D.prototype.transform=function(Re,Be,Ee,pe,R){var Fe;return void 0===pe&&(pe=!0),void 0===R&&(R="\u2014"),this.featureSwitchServices.featureSwitches.goalsCategoricalValues&&Be?_.isNil(Re)?R:(M.fF.assert(function(){return _.isNumber(Re)},"formatGoalValue transform value"),null===(Fe=Be[Re])||void 0===Fe?void 0:Fe.displayName):this.formatValuePipe.transform(Re,Ee,pe,R)},D.\u0275fac=function(Be){return new(Be||D)(u.\u0275\u0275directiveInject(e.vZ,16),u.\u0275\u0275directiveInject(F.c,16))},D.\u0275pipe=u.\u0275\u0275definePipe({name:"formatGoalValue",type:D,pure:!0}),D}()},82621:function(Pt,vt,m){"use strict";m.d(vt,{c:function(){return oe}});var M=m(62458),u=m(58098),e=m(72489),F=m(50423),oe=function(){function D(){}return D.prototype.transform=function(Re,Be,Ee,pe){if(void 0===Ee&&(Ee=!0),void 0===pe&&(pe="\u2014"),M.fF.assert(function(){return _.isNil(Re)||D.isPrimitiveValue(Re)},"Should only use FormatValuePipe on PrimitiveValue type"),_.isNil(Re)||!D.isPrimitiveValue(Re))return pe;Be=Be??D.getDefaultFormatString(Re);var R=(0,e.Ue)({format:Be,formatSingleValues:!0,columnType:void 0});return Ee&&_.isNumber(Re)&&(R=(0,e.Ue)({format:Be,value:_.isNumber(Re)?Re:0,precision:Number.NaN,displayUnitSystemType:u.V.WholeUnits,formatSingleValues:!1,allowFormatBeautification:!0,columnType:void 0})),R.format(Re)},D.getDefaultFormatString=function(Re){var Be=D.valueTypeDescriptorFromPrimitiveValue(Re);if(Be.integer){if(Re<D.MIN_INTEGER_VALUE_FOR_DISPLAY_UNITS)return D.INT_FORMAT_STRING_NO_DISPLAY_UNITS;var pe=(0,e.Ue)({value:_.isNumber(Re)?Re:0}).displayUnit.project(Re);return _.isInteger(pe)?D.INT_FORMAT_STRING_NO_DISPLAY_UNITS:D.NUMERIC_FORMAT_STRING}return(0,e.v1)(Be)},D.isPrimitiveValue=function(Re){return!!(_.isString(Re)||_.isNumber(Re)||_.isBoolean(Re)||_.isDate(Re))},D.valueTypeDescriptorFromPrimitiveValue=function(Re){return _.isDate(Re)?{dateTime:!0}:_.isInteger(Re)?{integer:!0}:_.isNumber(Re)?{numeric:!0}:_.isBoolean(Re)?{bool:!0}:_.isString(Re)?{text:!0}:(M.fF.assert(function(){return!Re},"Unsupported primitive value"),{none:!0})},D.INT_FORMAT_STRING_NO_DISPLAY_UNITS="#,0",D.NUMERIC_FORMAT_STRING="#,0.00",D.MIN_INTEGER_VALUE_FOR_DISPLAY_UNITS=1e3,D.\u0275fac=function(Be){return new(Be||D)},D.\u0275pipe=F.\u0275\u0275definePipe({name:"formatValue",type:D,pure:!0}),D}()},76777:function(Pt,vt,m){"use strict";m.d(vt,{H:function(){return We}}),m(5432);var u=m(90127),e=m(82621),F=m(77476),oe=m(48205),D=m(79061),Re=m(91382),Be=m(93367),Ee=m(94841),pe=m(45411),R=m(16095),Fe=m(50423),De=m(54485),We=function(){function Ue(ne){m.e("value-formatting").then(m.bind(m,24854)).then(function(se){ne.registerIcons(se.iconSpriteSheet.sprite)})}return Ue.\u0275fac=function(se){return new(se||Ue)(Fe.\u0275\u0275inject(De.u))},Ue.\u0275mod=Fe.\u0275\u0275defineNgModule({type:Ue}),Ue.\u0275inj=Fe.\u0275\u0275defineInjector({providers:[u.D,e.c],imports:[F.CommonModule,D.v,oe.uw,Re.d,Ee.b,Be.U,pe.m,R.Z]}),Ue}()},23873:function(Pt,vt,m){"use strict";m.d(vt,{o:function(){return _e}});var M=m(81337),u=m(50423),e=m(21661),F=m(30794),oe=m(83317),D=m(3307),Re=m(17653),Be=m(77526),Ee=m(59973),pe=m(48787),R=m(12587),Fe=m(35510),De=m(74466);function Ue(S,f,E){return(0,De.ZP)(S,function(x){-1===x.start.column&&(x.start.column=0,x.end.column=E-1),-1===x.start.row&&(x.start.row=0,x.end.row=f-1),x.start.row=Math.max(0,Math.min(x.start.row,f-1)),x.start.column=Math.max(0,Math.min(x.start.column,E-1)),x.end.row=Math.max(0,Math.min(x.end.row,f-1)),x.end.column=Math.max(0,Math.min(x.end.column,E-1))})}function ne(S,f){switch(f){case"Date":if(S){_.isString(S)&&(S=S.replace(/\//g,"-"));var E=new Date(S);if(_.isFinite(E.getTime()))return E}return;case"Number":return _.isFinite(parseFloat(S))?parseFloat(S):void 0;default:return S}}(0,De.Fl)(!1);var se=function(){function S(){this._columns$=new Fe.X([]),this._rows$=new Fe.X([])}return Object.defineProperty(S.prototype,"columns",{get:function(){return this._columns$.value},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"rows",{get:function(){return this._rows$.value},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"rows$",{get:function(){return this._rows$.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"columns$",{get:function(){return this._columns$.asObservable()},enumerable:!1,configurable:!0}),S.prototype.setColumns=function(f){this._columns$.next(f||[])},S.prototype.setRows=function(f){this._rows$.next(f||[])},S.prototype.appendRow=function(){this.ensureRows(this.rows.length+1)},S.prototype.ensureRows=function(f){var E=this.rows;f<=E.length||this.setRows((0,M.__spreadArray)((0,M.__spreadArray)([],E,!0),_.map(new Array(f-E.length),function(){return[]}),!0))},S.prototype.setCellData=function(f,E){if(this.isValidCell(f)){var x=this.rows,U=(0,M.__spreadArray)((0,M.__spreadArray)((0,M.__spreadArray)([],_.slice(x,0,f.row),!0),[(0,M.__spreadArray)([],x[f.row],!0)],!1),_.slice(x,f.row+1,x.length),!0);U[f.row][f.column]=E,this.setRows(U)}},S.prototype.deleteRows=function(f,E){var x=this.rows;this.setRows((0,M.__spreadArray)((0,M.__spreadArray)([],_.slice(x,0,f),!0),_.slice(x,f+E,x.length),!0))},S.prototype.emptyRange=function(f){var E=this;this.setRows((0,De.Uy)(this.rows,function(x){for(var U=(f=Ue(f,E.rows.length,E.columns.length)).start.row;U<=f.end.row;U++)for(var le=f.start.column;le<=f.end.column;le++)x[U][le]=null}))},S.prototype.isValidCell=function(f){return!(!_.isFinite(f.row)||!_.isFinite(f.column)||f.row>=this._rows$.value.length||f.column>=this._columns$.value.length||f.row<0||f.column<0)},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac=function(E){return new(E||S)}}),S}(),ve=function(){function S(f){this.dataSource=f,this._editingCell$=new Fe.X(void 0),this._isReadOnly$=new Fe.X(!1),this.isReadOnly$=this._isReadOnly$.asObservable()}return Object.defineProperty(S.prototype,"isReadOnly",{get:function(){return!!this._isReadOnly$.value},enumerable:!1,configurable:!0}),S.prototype.setReadOnly=function(f){this.cancelEditing(),this._isReadOnly$.next(!!f)},Object.defineProperty(S.prototype,"editingCell$",{get:function(){return this._editingCell$.asObservable()},enumerable:!1,configurable:!0}),S.prototype.isEditing=function(){return!!this._editingCell$.value},S.prototype.isEditingCell=function(f){var E=this._editingCell$.value;return!!E&&!!f&&f.column===E.column&&f.row===E.row},S.prototype.tryEditCell=function(f,E){this.isEditingCell(f)||this.isReadOnly||this.editCell(f,E)},S.prototype.editCell=function(f,E){this.commitPendingEdit(),this.dataSource.isValidCell(f)&&this._editingCell$.next({column:f.column,row:f.row,data:_.isNil(E)?this.dataSource.rows[f.row][f.column]:E})},S.prototype.setEditingData=function(f){var E,x,U,le=void 0===(x=(E=this._editingCell$.value||{}).row)?0:x,Pe=void 0===(U=E.column)?0:U;this._editingCell$.next({data:f,row:le,column:Pe})},S.prototype.commitPendingEdit=function(){var f=this._editingCell$.value;f&&(this.dataSource.setCellData(f,f.data),this._editingCell$.next(void 0))},S.prototype.cancelEditing=function(){this._editingCell$.value&&this._editingCell$.next(void 0)},S.\u0275fac=function(E){return new(E||S)(u.\u0275\u0275inject(se))},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}(),Se=m(14172),W=m(57243),He=function(){function S(f){var E=this;this.dataStore=f,this.currentSelection$=new Fe.X(void 0),this._enforceSelectingColumn=!1,this.normalizedSelection$=this.currentSelection$.pipe((0,Se.U)(function(x){return E.normalizeSelection(x)}),(0,W.d)({bufferSize:1,refCount:!0})),this.selectedCell$=this.currentSelection$.pipe((0,Se.U)(function(x){return x&&{column:x.start.column,row:x.start.row}}),(0,W.d)({bufferSize:1,refCount:!0}))}return Object.defineProperty(S.prototype,"selectedCell",{get:function(){var E;return this.selectedCell$.pipe((0,pe.q)(1)).subscribe(function(x){return E=x}),E},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"normalizedSelection",{get:function(){var E;return this.normalizedSelection$.pipe((0,pe.q)(1)).subscribe(function(x){return E=x}),E},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"selection",{get:function(){return this.currentSelection$.value},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"enforceSelectingColumn",{set:function(E){this._enforceSelectingColumn=E},enumerable:!1,configurable:!0}),S.prototype.setSelection=function(f){f&&(this._enforceSelectingColumn&&(f.start={row:-1,column:f.start.column},f.end={row:-1,column:f.start.column}),f.start=this.normalizeCell(f.start),f.end=this.normalizeCell(f.end)),this.currentSelection$.next(f),this.clearFocus()},S.prototype.setFocus=function(f,E){this.ensureRowIsInVirtualScroll(f.row);var x=E.querySelector('[data-row="'.concat(f.row,'"][data-column="').concat(f.column,'"]'));x&&(x.focus(),this.focusedCell=f)},S.prototype.clearFocus=function(){this.focusedCell=void 0},S.prototype.ensureRowIsInVirtualScroll=function(f){var E=this.virtualScroll.getRenderedRange();f>=0&&(E.start>f||E.end<f)&&this.virtualScroll.scrollToIndex(f)},S.prototype.selectCell=function(f){f=this.normalizeCell(f),this.setSelection({start:f,end:f})},S.prototype.setSelectionStart=function(f){f=this.normalizeCell(f);var E=this.currentSelection$.value;this.setSelection({start:f,end:E?.end||f})},S.prototype.setSelectionEnd=function(f){f=this.normalizeCell(f);var E=this.currentSelection$.value;this.setSelection({start:E?.start||f,end:f})},S.prototype.selectAll=function(){this.selectCell({row:-1,column:-1})},S.prototype.normalizeCell=function(f){var E=this.dataStore.rows.length,x=this.dataStore.columns.length;return{row:_.isFinite(f?.row)?Math.max(-1,Math.min(f.row,E-1)):-1,column:_.isFinite(f?.column)?Math.max(-1,Math.min(f.column,x-1)):-1}},S.prototype.normalizeSelection=function(f){if(!_.isNil(f))return{start:{row:Math.min(f.start.row,f.end.row),column:Math.min(f.start.column,f.end.column)},end:{row:Math.max(f.start.row,f.end.row),column:Math.max(f.start.column,f.end.column)}}},S.\u0275fac=function(E){return new(E||S)(u.\u0275\u0275inject(se))},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}(),he=function(){function S(f,E,x){this.selectionService=f,this.dataSource=E,this.cellEditingService=x}return S.prototype.canCopyCurrentSelection=function(){return!!this.selectionService.normalizedSelection},S.prototype.copyCurrentSelection=function(f){return void 0===f&&(f=!1),(0,M.__awaiter)(this,void 0,void 0,function(){var E,qe;return(0,M.__generator)(this,function(St){switch(St.label){case 0:return(E=this.selectionService.normalizedSelection)?(qe=Ue({start:E.start||{row:0,column:0},end:E.end||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length),[4,this.copy(qe.start,qe.end,!1,f)]):[2];case 1:return St.sent(),[2]}})})},S.prototype.copyAll=function(f){return(0,M.__awaiter)(this,void 0,void 0,function(){return(0,M.__generator)(this,function(Pe){switch(Pe.label){case 0:return[4,this.copy({row:0,column:0},{row:this.dataSource.rows.length-1,column:this.dataSource.columns.length-1},f)];case 1:return Pe.sent(),[2]}})})},S.prototype.copy=function(f,E,x,U){void 0===U&&(U=!1);var Pe=_.map(_.slice(this.dataSource.rows,f.row,E.row+1),function(on){return _.slice(on,f.column,E.column+1)}),qe=[];if(x){var St=_(this.dataSource.columns).map(function(on){return on.name}).slice(f.column,E.column+1).join("\t");qe.push(St)}for(var Et=0,at=Pe;Et<at.length;Et++){var en=_.join(at[Et].map(function(on){return U?'"'+(on??"").toString().trimStart().replace(/"/g,'""'):(on??"").toString()}),"\t");qe.push(en)}return navigator.clipboard.writeText(_.join(qe,"\r\n"))},S.prototype.pasteOverSelection=function(){return(0,M.__awaiter)(this,void 0,void 0,function(){var f,E,x,U,le,Pe;return(0,M.__generator)(this,function(qe){switch(qe.label){case 0:return!(f=this.selectionService.normalizedSelection)||this.cellEditingService.isReadOnly?[2]:[4,navigator.clipboard.readText()];case 1:return(E=qe.sent())?(0===(x=_.map(E.split(/\n|\r\n/),function(St){return St.split(/\t/)})).length||(U=this.dataSource.columns,(le=f.start||{row:0,column:0}).row=Math.max(0,le.row),le.column=Math.max(0,le.column),this.dataSource.ensureRows(le.row+x.length),Pe=(0,De.ZP)(this.dataSource.rows,function(St){for(var Et=0;Et<x.length;Et++)for(var at=le.column,Lt=0;at<U.length&&Lt<x[Et].length;at++,Lt++){var en=ne(x[Et][Lt],U[at].type);en&&(St[le.row+Et][at]=en)}}),this.dataSource.setRows(Pe),this.selectionService.setSelection({start:le,end:{row:le.row+x.length-1,column:le.column+x[0].length-1}})),[2]):[2]}})})},S.\u0275fac=function(E){return new(E||S)(u.\u0275\u0275inject(He),u.\u0275\u0275inject(se),u.\u0275\u0275inject(ve))},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}(),ye=function(S){return S.ArrowUp="ArrowUp",S.ArrowDown="ArrowDown",S.ArrowLeft="ArrowLeft",S.ArrowRight="ArrowRight",S}({}),je=function(S){return S.Enter="Enter",S.Tab="Tab",S.Escape="Escape",S.Delete="Delete",S.Backspace="Backspace",S.F2="F2",S.Space=" ",S}({}),rt=function(){function S(f,E,x,U){this.cellEditing=f,this.selectionService=E,this.dataSource=x,this.clipboardService=U}return S.prototype.keydown=function(f,E,x){var U=!1;"c"===f.key&&f.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.copyCurrentSelection(),U=!0):"v"===f.key&&f.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.pasteOverSelection(),U=!0):"a"===f.key&&f.ctrlKey&&!this.cellEditing.isEditing()?(this.selectionService.selectAll(),U=!0):f.key.match(/^[a-z0-9]$/i)?U=this.handleAlphaNumeric(f.key):f.key in ye?U=f.altKey?this.handleColumnResize(f.key):this.handleArrowKey(f.key,(f.shiftKey||f.ctrlKey)&&x,E):f.key===je.Enter?U=this.handleEnter(f):f.key===je.Tab?U=this.handleTab():f.key===je.Escape?U=this.handleEscape():f.key===je.Delete||f.key===je.Backspace?U=this.handleDelete():f.key===je.F2?U=this.handleF2():f.key===je.Space&&(U=this.handleSpace(f)),U&&(f.stopPropagation(),f.preventDefault())},S.prototype.handleF2=function(){var f=this.selectionService.selectedCell;return!(!f||this.cellEditing.isEditingCell(f)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(f),0))},S.prototype.handleAlphaNumeric=function(f){var E=this.selectionService.selectedCell;if(E&&!this.cellEditing.isEditingCell(E)&&!this.cellEditing.isReadOnly){var x=this.dataSource.columns[E.column];return this.cellEditing.tryEditCell(E,ne(f,x?.type)),!0}return!1},S.prototype.handleColumnResize=function(f){var E,x,U=null===(E=this.selectionService.focusedCell)||void 0===E?void 0:E.column;if(void 0!==U&&-1!==U){var le=null!==(x=this.dataSource.columns[U].width)&&void 0!==x?x:50,qe=this.dataSource.columns;switch(f){case ye.ArrowLeft:qe[U].width=Math.max(le-1,45),this.dataSource.setColumns(qe);break;case ye.ArrowRight:qe[U].width=le+1,this.dataSource.setColumns(qe)}}return!0},S.prototype.handleArrowKey=function(f,E,x){var U={row:-1,column:-1};if(this.selectionService.focusedCell)U={row:this.selectionService.focusedCell.row,column:this.selectionService.focusedCell.column};else{var le=this.selectionService.selection;le?.end&&E?U=(0,M.__assign)({},le.end):le?.start&&(U=(0,M.__assign)({},le.start))}switch(f){case ye.ArrowUp:if(this.cellEditing.isEditing())return!1;U.row--;break;case ye.ArrowDown:U.row++,this.cellEditing.isReadOnly||this.dataSource.ensureRows(U.row+1);break;case ye.ArrowLeft:if(this.cellEditing.isEditing())return!1;U.column--;break;case ye.ArrowRight:if(this.cellEditing.isEditing())return!1;U.column++}return E&&this.selectionService.setSelectionEnd(U),this.selectionService.setFocus(U,x),!0},S.prototype.handleTab=function(){return this.selectionService.clearFocus(),!1},S.prototype.handleEnter=function(f){var E,x,U=this.selectionService.focusedCell;if(U)return this.selectionService.selectCell(U),null===(E=f.target)||void 0===E||E.blur(),null===(x=f.currentTarget)||void 0===x||x.focus(),!0;var le=this.selectionService.selectedCell;if(le){if(this.cellEditing.isEditingCell(le)){var Pe={row:le.row+1,column:le.column};return this.dataSource.ensureRows(Pe.row+1),this.selectionService.selectCell(Pe),!0}if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(le),!0}return!1},S.prototype.handleSpace=function(f){var E,x,U=this.selectionService.focusedCell;if(U)return this.selectionService.selectCell(U),null===(E=f.target)||void 0===E||E.blur(),null===(x=f.currentTarget)||void 0===x||x.focus(),!0;var le=this.selectionService.selectedCell;if(le){if(this.cellEditing.isEditingCell(le))return!1;if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(le),!0}return!1},S.prototype.handleEscape=function(){return this.cellEditing.cancelEditing(),!0},S.prototype.handleDelete=function(){var f=this.selectionService.normalizedSelection;return!(!f||this.cellEditing.isEditing()||this.cellEditing.isReadOnly||(-1===f.start.column&&-1!==f.start.row?(this.dataSource.deleteRows(f.start.row,f.end.row-f.start.row+1),this.selectionService.selectCell({row:f.start.row,column:-1})):this.dataSource.emptyRange(f),0))},S.\u0275fac=function(E){return new(E||S)(u.\u0275\u0275inject(ve),u.\u0275\u0275inject(He),u.\u0275\u0275inject(se),u.\u0275\u0275inject(he))},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}(),Ke=m(80786),Q=function(){function S(f,E,x){this.cellEditing=f,this.selectionService=E,this.dataSource=x}return S.prototype.doubleClick=function(f,E){this.cellEditing.isEditingCell(E)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(E),f.preventDefault(),f.stopPropagation())},S.prototype.mouseDown=function(f,E,x){if(this._supportRightClickMenu&&f.button===Ke.tc.Secondary)return f.preventDefault(),void f.stopPropagation();this.cellEditing.isEditingCell(E)||(f.preventDefault(),f.stopPropagation(),$(f.currentTarget).trigger("focus"),f.shiftKey&&x?this.selectionService.setSelectionEnd(E):this.selectionService.selectCell(E),this.isSelecting=!0)},S.prototype.mouseOver=function(f,E,x){this.isSelecting&&x&&(f.preventDefault(),f.stopPropagation(),this.selectionService.setSelectionEnd(E))},S.prototype.mouseLeave=function(f){this.isSelecting&&(this.isSelecting=!1,f.preventDefault(),f.stopPropagation())},S.prototype.mouseUpInCell=function(f,E){var x,U;if(this.showRightClickMenu=!1,E&&!this.cellEditing.isEditingCell(E)&&this._supportRightClickMenu&&f.button===Ke.tc.Secondary){var le=null===(x=this.selectionService.normalizedSelection)||void 0===x?void 0:x.start,Pe=null===(U=this.selectionService.normalizedSelection)||void 0===U?void 0:U.end;if(!le||!Pe)return;return this.isInEffectiveRange(E,le,Pe)&&(this.showRightClickMenu=!0),f.preventDefault(),void f.stopPropagation()}},Object.defineProperty(S.prototype,"supportRightClickMenu",{set:function(E){this._supportRightClickMenu=E},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"showRightClickMenu",{get:function(){return this._showRightClickMenu},set:function(E){this._showRightClickMenu=E},enumerable:!1,configurable:!0}),S.prototype.isInEffectiveRange=function(f,E,x){var U,qe=(U=Ue({start:E||{row:0,column:0},end:x||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length)).start,St=U.end;return f.row>=qe.row&&f.row<=St.row&&f.column>=qe.column&&f.column<=St.column},S.\u0275fac=function(E){return new(E||S)(u.\u0275\u0275inject(ve),u.\u0275\u0275inject(He),u.\u0275\u0275inject(se))},S.\u0275prov=u.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}(),K=m(81900),ee=m(77476),ae=m(74913),fe=function(){function S(){}return S.\u0275fac=function(E){return new(E||S)},S.\u0275cmp=u.\u0275\u0275defineComponent({type:S,selectors:[["tri-cell"]],inputs:{data:"data"},decls:1,vars:1,template:function(E,x){1&E&&u.\u0275\u0275text(0),2&E&&u.\u0275\u0275textInterpolate(x.data)},styles:["[_nghost-%COMP%]{cursor:default;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"],changeDetection:0}),S}(),me=m(33554),$e=m(17174),ct=["editor"],Ct=function(){function S(){this.onDestroy$=new me.t(1)}return S.prototype.ngOnInit=function(){var E,f=this;null===(E=this.focusEditor$)||void 0===E||E.pipe((0,oe.R)(this.onDestroy$)).subscribe(function(){f.focusEditor()})},S.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},S.prototype.ngOnChanges=function(f){if(f.data&&"Date"===this.column.type){var E=new Date(this.data);_.isFinite(E.getTime())&&(this.data=E.toISOString().slice(0,10))}if(f.column)switch(this.column.type){case"Date":this.type="date";break;case"Number":this.type="number";break;default:this.type="text"}},S.prototype.ngAfterViewInit=function(){this.focusEditor()},S.prototype.onDataChange=function(f){var E=ne(f,this.column.type);_.isNil(E)||this.dataChange(E)},S.prototype.focusEditor=function(){var f;null===(f=this.editor.nativeElement)||void 0===f||f.focus()},S.\u0275fac=function(E){return new(E||S)},S.\u0275cmp=u.\u0275\u0275defineComponent({type:S,selectors:[["tri-cell-editor"]],viewQuery:function(E,x){var U;(1&E&&u.\u0275\u0275viewQuery(ct,5),2&E)&&(u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(x.editor=U.first))},inputs:{column:"column",data:"data",focusEditor$:"focusEditor$",dataChange:"dataChange"},features:[u.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[["autofocus","",3,"type","ngModel","ngModelChange"],["editor",""]],template:function(E,x){1&E&&(u.\u0275\u0275elementStart(0,"input",0,1),u.\u0275\u0275listener("ngModelChange",function(le){return x.onDataChange(le)}),u.\u0275\u0275elementEnd()),2&E&&(u.\u0275\u0275property("type",x.type)("ngModel",x.data),u.\u0275\u0275attribute("aria-label",x.data))},dependencies:[$e.Fj,$e.JJ,$e.On],styles:["input[_ngcontent-%COMP%]{border:0;width:100%;background:transparent;padding:0;display:inline-flex;align-items:center}input[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:hover, input[_ngcontent-%COMP%]:active, input[_ngcontent-%COMP%]:active:hover, input[_ngcontent-%COMP%]:focus:hover{outline:none}[_ngcontent-%COMP%]::-webkit-outer-spin-button, [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-webkit-appearance:textfield;appearance:textfield;-moz-appearance:textfield}"],changeDetection:0}),S}(),Me=function(){function S(){this.columnResized=new u.EventEmitter}return S.prototype.onMouseDown=function(f){var E,x,U;return this.isResizing=!0,this.pageX=f.pageX,this.initialWidth=null!==(U=null===(x=null===(E=f.target)||void 0===E?void 0:E.parentElement)||void 0===x?void 0:x.offsetWidth)&&void 0!==U?U:0,document.body.style.cursor="col-resize",f.stopPropagation(),!1},S.prototype.onDragStart=function(){return!1},S.prototype.onMouseMove=function(f){return!this.isResizing||(this.columnResized.emit(Math.max(0,this.initialWidth+f.pageX-this.pageX)),f.stopPropagation(),!1)},S.prototype.onMouseLeave=function(f){return!this.isResizing||(this.isResizing=!1,document.body.style.cursor="",f.stopPropagation(),!1)},S.\u0275fac=function(E){return new(E||S)},S.\u0275dir=u.\u0275\u0275defineDirective({type:S,selectors:[["","triResizeColumn",""]],hostBindings:function(E,x){1&E&&u.\u0275\u0275listener("mousedown",function(le){return x.onMouseDown(le)})("touchstart",function(le){return x.onMouseDown(le)})("dragstart",function(){return x.onDragStart()})("mousemove",function(le){return x.onMouseMove(le)},!1,u.\u0275\u0275resolveWindow)("touchmove",function(le){return x.onMouseMove(le)},!1,u.\u0275\u0275resolveWindow)("mouseup",function(le){return x.onMouseLeave(le)},!1,u.\u0275\u0275resolveWindow)("mouseleave",function(le){return x.onMouseLeave(le)},!1,u.\u0275\u0275resolveWindow)("touchend",function(le){return x.onMouseLeave(le)},!1,u.\u0275\u0275resolveWindow)},outputs:{columnResized:"columnResized"}}),S}(),Ge=function(){function S(){}return S.prototype.transform=function(f,E,x){return!!f&&(-1===f.start.row||E>=f.start.row&&E<=f.end.row)&&(-1===f.start.column||x>=f.start.column&&x<=f.end.column)},S.\u0275fac=function(E){return new(E||S)},S.\u0275pipe=u.\u0275\u0275definePipe({name:"isSelected",type:S,pure:!0}),S}(),Te=["headers"],Ve=["table"],_t=["viewport"],yt=["cellEditor"];function tt(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",11),u.\u0275\u0275listener("focus",function(le){u.\u0275\u0275restoreView(E);var Pe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Pe.focusCell(le,{row:-1,column:-1}))}),u.\u0275\u0275element(1,"tri-svg-icon",12),u.\u0275\u0275elementEnd()}if(2&S){var x=u.\u0275\u0275nextContext(2);u.\u0275\u0275property("tabindex",x.focusedCell?-1:0),u.\u0275\u0275attribute("data-row",-1)("data-column",-1),u.\u0275\u0275advance(1),u.\u0275\u0275property("name","table_20_regular")}}var zt=function(f){return{headerName:f}};function k(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",13),u.\u0275\u0275listener("focus",function(St){var at=u.\u0275\u0275restoreView(E).index,Lt=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Lt.focusCell(St,{row:-1,column:at}))}),u.\u0275\u0275pipe(1,"isSelected"),u.\u0275\u0275elementContainer(2,14),u.\u0275\u0275elementStart(3,"span",15),u.\u0275\u0275listener("columnResized",function(St){var at=u.\u0275\u0275restoreView(E).index,Lt=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Lt.onColumnResized(St,at))}),u.\u0275\u0275elementEnd()()}if(2&S){var x=f.$implicit,U=f.index,le=u.\u0275\u0275nextContext(2),Pe=u.\u0275\u0275reference(9);u.\u0275\u0275styleProp("width",le.columnWidths[U]),u.\u0275\u0275classProp("selection-start",u.\u0275\u0275pipeBind3(1,9,le.selection,-1,U)),u.\u0275\u0275property("tabindex",le.focusedCell||le.rowHeaders||0!==U?-1:0),u.\u0275\u0275attribute("data-row",-1)("data-column",U),u.\u0275\u0275advance(2),u.\u0275\u0275property("ngTemplateOutlet",x.headerTemplate||Pe)("ngTemplateOutletContext",u.\u0275\u0275pureFunction1(13,zt,x.name))}}function Cn(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",23),u.\u0275\u0275listener("focus",function(Pe){u.\u0275\u0275restoreView(E);var qe=u.\u0275\u0275nextContext().index,St=u.\u0275\u0275nextContext(3);return u.\u0275\u0275resetView(St.focusCell(Pe,{row:qe,column:-1}))}),u.\u0275\u0275pipe(1,"isSelected"),u.\u0275\u0275text(2),u.\u0275\u0275elementEnd()}if(2&S){var x=u.\u0275\u0275nextContext().index,U=u.\u0275\u0275nextContext(3);u.\u0275\u0275classProp("selection-start",u.\u0275\u0275pipeBind3(1,5,U.selection,x,-1)),u.\u0275\u0275attribute("data-row",x)("data-column",-1),u.\u0275\u0275advance(2),u.\u0275\u0275textInterpolate1(" ",x+U.rowIndexDisplayOffset," ")}}var It=function(f,E,x,U){return{column:f,data:E,dataChange:x,focusEditor$:U}};function nt(S,f){if(1&S&&u.\u0275\u0275elementContainer(0,14,27),2&S){var E=u.\u0275\u0275nextContext().$implicit,x=u.\u0275\u0275nextContext(4),U=u.\u0275\u0275reference(5);u.\u0275\u0275property("ngTemplateOutlet",E.editTemplate||U)("ngTemplateOutletContext",u.\u0275\u0275pureFunction4(2,It,E,x.editingCell.data,x.onEditCellDataChange.bind(x),x.focusEditor$))}}var be=function(f,E){return{column:f,data:E}};function de(S,f){if(1&S&&u.\u0275\u0275elementContainer(0,14),2&S){var E=u.\u0275\u0275nextContext(),x=E.$implicit,U=E.index,le=u.\u0275\u0275nextContext().$implicit;u.\u0275\u0275nextContext(3);var Pe=u.\u0275\u0275reference(7);u.\u0275\u0275property("ngTemplateOutlet",x.template||Pe)("ngTemplateOutletContext",u.\u0275\u0275pureFunction2(2,be,x,le[U]))}}function V(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",24),u.\u0275\u0275listener("focus",function(Et){var Lt=u.\u0275\u0275restoreView(E).index,en=u.\u0275\u0275nextContext().index,on=u.\u0275\u0275nextContext(3);return u.\u0275\u0275resetView(on.focusCell(Et,{row:en,column:Lt}))}),u.\u0275\u0275pipe(1,"isSelected"),u.\u0275\u0275template(2,nt,2,7,"ng-container",25),u.\u0275\u0275template(3,de,1,5,"ng-template",null,26,u.\u0275\u0275templateRefExtractor),u.\u0275\u0275elementEnd()}if(2&S){var x=f.index,U=u.\u0275\u0275reference(4),le=u.\u0275\u0275nextContext().index;u.\u0275\u0275nextContext();var Pe=u.\u0275\u0275reference(1),qe=u.\u0275\u0275nextContext(2);u.\u0275\u0275styleProp("width",qe.columnWidths[x]),u.\u0275\u0275classProp("selected-top",le===(null==qe.selection||null==qe.selection.start?null:qe.selection.start.row)||0===le&&-1===(null==qe.selection||null==qe.selection.start?null:qe.selection.start.row))("selected-bottom",le===(null==qe.selection||null==qe.selection.end?null:qe.selection.end.row)&&-1!==(null==qe.selection||null==qe.selection.start?null:qe.selection.start.row)||le===qe.dataSource.rows.length-1&&-1===(null==qe.selection||null==qe.selection.end?null:qe.selection.end.row))("selected-left",x===(null==qe.selection||null==qe.selection.start?null:qe.selection.start.column)||0===x&&-1===(null==qe.selection||null==qe.selection.start?null:qe.selection.start.column))("selected-right",x===(null==qe.selection||null==qe.selection.end?null:qe.selection.end.column)&&-1!==(null==qe.selection||null==qe.selection.start?null:qe.selection.start.column)||x===qe.dataSource.columns.length-1&&-1===(null==qe.selection||null==qe.selection.start?null:qe.selection.start.column))("selected",u.\u0275\u0275pipeBind3(1,19,qe.selection,le,x))("selection-start",qe.selectedCell&&qe.selectedCell.row===le&&qe.selectedCell.column===x),u.\u0275\u0275attribute("data-row",le)("data-column",x)("aria-colindex",(Pe.getRenderedRange().start||0)+x+1),u.\u0275\u0275advance(2),u.\u0275\u0275property("ngIf",qe.editingCell&&qe.editingCell.row===le&&qe.editingCell.column===x)("ngIfElse",U)}}function lt(S,f){if(1&S&&(u.\u0275\u0275elementStart(0,"div",20),u.\u0275\u0275template(1,Cn,3,9,"div",21),u.\u0275\u0275template(2,V,5,23,"div",22),u.\u0275\u0275elementEnd()),2&S){var E=f.index,x=u.\u0275\u0275nextContext(2).$implicit,U=u.\u0275\u0275nextContext();u.\u0275\u0275attribute("aria-rowindex",E+1),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",U.rowHeaders),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngForOf",x)("ngForTrackBy",U.trackByColumn)}}function Xt(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",31),u.\u0275\u0275listener("mousedown",function(){u.\u0275\u0275restoreView(E);var U=u.\u0275\u0275nextContext(4);return u.\u0275\u0275resetView(U.appendRow(-1))})("focus",function(U){u.\u0275\u0275restoreView(E);var le=u.\u0275\u0275nextContext(2).$implicit,Pe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Pe.focusCell(U,{row:le.length,column:-1}))}),u.\u0275\u0275text(1,"+"),u.\u0275\u0275elementEnd()}}function sn(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"div",32),u.\u0275\u0275listener("mousedown",function(){var qe=u.\u0275\u0275restoreView(E).index,St=u.\u0275\u0275nextContext(4);return u.\u0275\u0275resetView(St.appendRow(qe))})("focus",function(Pe){var St=u.\u0275\u0275restoreView(E).index,Et=u.\u0275\u0275nextContext(2).$implicit,at=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(at.focusCell(Pe,{row:Et.length,column:St}))}),u.\u0275\u0275elementEnd()}if(2&S){var x=f.index,U=u.\u0275\u0275nextContext(4);u.\u0275\u0275styleProp("width",U.columnWidths[x])}}function Mn(S,f){if(1&S&&(u.\u0275\u0275elementStart(0,"div",28),u.\u0275\u0275template(1,Xt,2,0,"div",29),u.\u0275\u0275template(2,sn,1,2,"div",30),u.\u0275\u0275elementEnd()),2&S){var E=u.\u0275\u0275nextContext(2).$implicit,x=u.\u0275\u0275nextContext();u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",x.rowHeaders),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngForOf",E)("ngForTrackBy",x.trackByColumn)}}function fn(S,f){if(1&S){var E=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"cdk-virtual-scroll-viewport",16,17),u.\u0275\u0275listener("scroll",function(){u.\u0275\u0275restoreView(E);var Pe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Pe.scroll())}),u.\u0275\u0275template(2,lt,3,4,"div",18),u.\u0275\u0275template(3,Mn,3,3,"div",19),u.\u0275\u0275pipe(4,"async"),u.\u0275\u0275elementEnd()}if(2&S){var x=f.$implicit,U=u.\u0275\u0275nextContext(2);u.\u0275\u0275property("itemSize",U.rowHeight),u.\u0275\u0275advance(2),u.\u0275\u0275property("cdkVirtualForOf",x)("cdkVirtualForTrackBy",U.trackByColumn)("cdkVirtualForTemplateCacheSize",100),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",U.showAppendRow&&!1===u.\u0275\u0275pipeBind1(4,5,U.isReadOnly$))}}function jt(S,f){if(1&S&&(u.\u0275\u0275elementContainerStart(0),u.\u0275\u0275elementStart(1,"div",6,7),u.\u0275\u0275template(3,tt,2,4,"div",8),u.\u0275\u0275template(4,k,4,15,"div",9),u.\u0275\u0275elementEnd(),u.\u0275\u0275template(5,fn,5,7,"cdk-virtual-scroll-viewport",10),u.\u0275\u0275pipe(6,"async"),u.\u0275\u0275elementContainerEnd()),2&S){var E=f.$implicit,x=u.\u0275\u0275nextContext();u.\u0275\u0275advance(3),u.\u0275\u0275property("ngIf",x.rowHeaders),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngForOf",E)("ngForTrackBy",x.trackByColumn),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",u.\u0275\u0275pipeBind1(6,4,x.rows$))}}function Tt(S,f){if(1&S&&u.\u0275\u0275element(0,"tri-cell-editor",33),2&S){var x=f.data,U=f.dataChange,le=f.focusEditor$;u.\u0275\u0275property("column",f.column)("data",x)("dataChange",U)("focusEditor$",le)}}function Dt(S,f){1&S&&u.\u0275\u0275element(0,"tri-cell",34),2&S&&u.\u0275\u0275property("data",f.data)}function ke(S,f){if(1&S&&(u.\u0275\u0275elementStart(0,"span",35),u.\u0275\u0275text(1),u.\u0275\u0275elementEnd()),2&S){var E=f.headerName;u.\u0275\u0275advance(1),u.\u0275\u0275textInterpolate1(" ",E," ")}}var _e=function(S){function f(E,x,U,le,Pe,qe,St,Et){var at=S.call(this)||this;return at.changeDetector=E,at.cellEditing=x,at.dataSource=U,at.selectionService=le,at.mouseEventHandler=Pe,at.keyboardEventHandler=qe,at.clipboardService=St,at.resizeService=Et,at.columnWidths=[],at.focusEditor$=new F.xQ,at.rowHeight=24,at.isReadOnly$=at.cellEditing.isReadOnly$,at.rowHeaders=!0,at.showAppendRow=!0,at.isReadOnly=!1,at.allowExpandSelection=!0,at.enforceSelectingColumn=!1,at.clearSelectionOnDataChange=!1,at.rowIndexDisplayOffset=0,at.supportRightClickMenu=!1,at.rowsChange=new u.EventEmitter,at.selectionChange=new u.EventEmitter,at.columnWidthChange=new u.EventEmitter,at.showRightClickMenu=new u.EventEmitter,at.columns$=at.dataSource.columns$,at.rows$=at.dataSource.rows$,at}return(0,M.__extends)(f,S),f.prototype.releaseMouse=function(E){this.mouseEventHandler.mouseLeave(E)},f.prototype.ngOnInit=function(){var E=this;this.changes$("isReadOnly").subscribe(function(x){return E.cellEditing.setReadOnly(x)}),this.changes$("columns").subscribe(function(x){E.columnWidths=_.map(x,function(U){return(_.isFinite(U.width)?U.width:50)+"px"}),E.dataSource.setColumns(x),E.clearSelectionOnDataChangeHandler()}),this.changes$("rows").subscribe(function(x){E.dataSource.setRows(x),E.clearSelectionOnDataChangeHandler()}),this.dataSource.rows$.pipe((0,oe.R)(this.onDestroy$)).subscribe(function(x){E.rows!==x&&E.rowsChange.emit(x)}),this.dataSource.columns$.pipe((0,oe.R)(this.onDestroy$)).subscribe(function(x){E.columnWidths=_.map(x,function(U){return(_.isFinite(U.width)?U.width:50)+"px"})}),this.cellEditing.editingCell$.pipe((0,D.T)(1),(0,oe.R)(this.onDestroy$),(0,Re.b)(function(x){E.editingCell=x,E.changeDetector.markForCheck()}),(0,Be.x)(function(x,U){return x?.row===U?.row&&x?.column===U?.column})).subscribe(function(){E.editingCell?setTimeout(function(){return E.focusEditor$.next()},0):setTimeout(function(){return E.table.nativeElement.focus()},0)}),this.selectionService.enforceSelectingColumn=this.enforceSelectingColumn,this.selectionService.selectedCell$.pipe((0,oe.R)(this.onDestroy$),(0,Re.b)(function(x){E.selectedCell=x,E.changeDetector.markForCheck()}),(0,Ee.h)(function(x){return!!x}),(0,Be.x)(function(x,U){return x.row===U.row&&x.column===U.column})).subscribe(function(x){var U,le,Pe;E.cellEditing.isEditing()&&!E.cellEditing.isEditingCell(x)&&E.cellEditing.commitPendingEdit();var qe=(null===(U=E.viewport.nativeElement)||void 0===U?void 0:U.scrollTop)/E.rowHeight,St=qe+(null===(le=E.viewport.nativeElement)||void 0===le?void 0:le.offsetHeight)/E.rowHeight;x.row>=0&&(x.row<qe||x.row>=St)&&(null===(Pe=E.viewportComponent)||void 0===Pe||Pe.scrollToIndex(x.row))}),this.selectionService.normalizedSelection$.pipe((0,oe.R)(this.onDestroy$)).subscribe(function(x){E.selection=x,E.selectionChange.emit(x),E.changeDetector.markForCheck()}),this.resizeService&&this.resizeService.resize$.pipe((0,oe.R)(this.onDestroy$)).subscribe(function(){E.viewportComponent.checkViewportSize()}),this.mouseEventHandler.supportRightClickMenu=this.supportRightClickMenu},f.prototype.ngAfterViewInit=function(){var E=this;this.table.nativeElement.style.setProperty("--row-height",this.rowHeight+"px"),this.keyboardEventHandler.parentElement=this.table.nativeElement,setTimeout(function(){E.changes$("nextSelectionInput").subscribe(function(x){E.scrollToSelectedColumn(x),E.selectionService.setSelection(x)})},0),this.selectionService.virtualScroll=this.viewportComponent},f.prototype.scrollToSelectedColumn=function(E){var x=this;if(E){var U=0;if(this.nextSelectionInputChangedFromSelection(E)&&this.columns&&this.columnWidths)for(var le=0;le<this.columns.length&&le<=E.start.column-1;le++)U+=this.substractWidh(this.columnWidths[le]);setTimeout(function(){var Pe,qe;(null===(Pe=x.viewport)||void 0===Pe?void 0:Pe.nativeElement.clientWidth)<U&&(null===(qe=x.viewport)||void 0===qe||qe.nativeElement.scroll(U,0))},300)}},f.prototype.nextSelectionInputChangedFromSelection=function(E){var x,U,le,Pe,qe,St,Et,at;return E.end.column!==(null===(U=null===(x=this.selection)||void 0===x?void 0:x.end)||void 0===U?void 0:U.column)||E.end.row!==(null===(Pe=null===(le=this.selection)||void 0===le?void 0:le.end)||void 0===Pe?void 0:Pe.row)||E.start.row!==(null===(St=null===(qe=this.selection)||void 0===qe?void 0:qe.start)||void 0===St?void 0:St.row)||E.start.column!==(null===(at=null===(Et=this.selection)||void 0===Et?void 0:Et.start)||void 0===at?void 0:at.column)},f.prototype.substractWidh=function(E){var x,U=null===(x=E?.match(/\d+(\.\d+)?/g))||void 0===x?void 0:x.map(Number);return U?U[0]:0},f.prototype.flushPendingChanges=function(){var E;return this.cellEditing.commitPendingEdit(),this.rows$.pipe((0,pe.q)(1)).subscribe(function(x){return E=x}),E},f.prototype.trackByColumn=function(E){return E},f.prototype.scroll=function(){this.headers.nativeElement.style.transform="translateX(".concat(-this.viewport.nativeElement.scrollLeft,"px)")},f.prototype.onColumnResized=function(E,x){this.columnWidths[x]=E+"px",this.columnWidthChange.emit({width:E,column:x})},f.prototype.onCellMouseDown=function(E){var x=this.getCell();x&&this.mouseEventHandler.mouseDown(E,x,this.allowExpandSelection)},f.prototype.onCellMouseUp=function(E){var x=this.getCell();this.mouseEventHandler.mouseUpInCell(E,x),this.mouseEventHandler.showRightClickMenu&&this.showRightClickMenu.emit({pageX:E.pageX,pageY:E.pageY})},f.prototype.onCellMouseOver=function(E){var x=this.getCell();x&&this.mouseEventHandler.mouseOver(E,x,this.allowExpandSelection)},f.prototype.onCellDoubleClick=function(E){var x=this.getCell();x&&this.mouseEventHandler.doubleClick(E,x)},f.prototype.onEditCellDataChange=function(E){this.cellEditing.setEditingData(E)},f.prototype.focusCell=function(E,x){this.selectionService.setFocus(x,this.table.nativeElement),this.scrollViewportHorizontally(E.target)},Object.defineProperty(f.prototype,"focusedCell",{get:function(){return this.selectionService.focusedCell},enumerable:!1,configurable:!0}),f.prototype.scrollViewportHorizontally=function(E){var x=this.viewport.nativeElement,U=E.offsetLeft;(x.scrollLeft+x.clientWidth<U||x.scrollLeft>U)&&(x.scrollLeft=U-(x.clientWidth-E.clientWidth)/2,this.viewport.nativeElement.scrollIntoView())},f.prototype.handleKeydown=function(E){this.keyboardEventHandler.keydown(E,this.table.nativeElement,this.allowExpandSelection)},f.prototype.getCell=function(){var E=$("[data-clickable]:hover").get(0);if(E){var x=E.getAttribute("data-row"),U=E.getAttribute("data-column");if(x&&U){var le=parseInt(x,10),Pe=parseInt(U,10);if(_.isFinite(le)&&_.isFinite(Pe))return{row:le,column:Pe}}}},f.prototype.appendRow=function(E){this.dataSource.appendRow(),this.selectionService.selectCell({row:this.dataSource.rows.length,column:E})},f.prototype.clearSelectionOnDataChangeHandler=function(){this.clearSelectionOnDataChange&&this.selectionService.setSelection(void 0)},f.\u0275fac=function(x){return new(x||f)(u.\u0275\u0275directiveInject(u.ChangeDetectorRef),u.\u0275\u0275directiveInject(ve),u.\u0275\u0275directiveInject(se),u.\u0275\u0275directiveInject(He),u.\u0275\u0275directiveInject(Q),u.\u0275\u0275directiveInject(rt),u.\u0275\u0275directiveInject(he),u.\u0275\u0275directiveInject(K.g,8))},f.\u0275cmp=u.\u0275\u0275defineComponent({type:f,selectors:[["tri-grid"]],viewQuery:function(x,U){if(1&x&&(u.\u0275\u0275viewQuery(Te,5),u.\u0275\u0275viewQuery(Ve,5),u.\u0275\u0275viewQuery(_t,5,u.ElementRef),u.\u0275\u0275viewQuery(e.N7,5),u.\u0275\u0275viewQuery(yt,5)),2&x){var le=void 0;u.\u0275\u0275queryRefresh(le=u.\u0275\u0275loadQuery())&&(U.headers=le.first),u.\u0275\u0275queryRefresh(le=u.\u0275\u0275loadQuery())&&(U.table=le.first),u.\u0275\u0275queryRefresh(le=u.\u0275\u0275loadQuery())&&(U.viewport=le.first),u.\u0275\u0275queryRefresh(le=u.\u0275\u0275loadQuery())&&(U.viewportComponent=le.first),u.\u0275\u0275queryRefresh(le=u.\u0275\u0275loadQuery())&&(U.cellEditor=le.first)}},hostBindings:function(x,U){1&x&&u.\u0275\u0275listener("mouseup",function(Pe){return U.releaseMouse(Pe)},!1,u.\u0275\u0275resolveWindow)("mouseleave",function(Pe){return U.releaseMouse(Pe)},!1,u.\u0275\u0275resolveWindow)},inputs:{columns:"columns",rows:"rows",rowHeaders:"rowHeaders",showAppendRow:"showAppendRow",isReadOnly:"isReadOnly",allowExpandSelection:"allowExpandSelection",enforceSelectingColumn:"enforceSelectingColumn",nextSelectionInput:"nextSelectionInput",clearSelectionOnDataChange:"clearSelectionOnDataChange",rowIndexDisplayOffset:"rowIndexDisplayOffset",supportRightClickMenu:"supportRightClickMenu"},outputs:{rowsChange:"rowsChange",selectionChange:"selectionChange",columnWidthChange:"columnWidthChange",showRightClickMenu:"showRightClickMenu"},features:[u.\u0275\u0275ProvidersFeature([He,ve,se,Q,rt,he]),u.\u0275\u0275InheritDefinitionFeature],decls:10,vars:3,consts:[["tabindex","-1","role","table",1,"table",3,"keydown","mousedown","mouseover","mouseup","dblclick"],["table",""],[4,"ngIf"],["defaultCellEditor",""],["defaultViewCell",""],["defaultHeaderCell",""],["role","row",1,"headers"],["headers",""],["class","header selectable table-icon","role","columnheader","data-clickable","true",3,"tabindex","focus",4,"ngIf"],["class","header selectable","data-clickable","true","role","columnheader",3,"selection-start","tabindex","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],[3,"itemSize","scroll",4,"ngIf"],["role","columnheader","data-clickable","true",1,"header","selectable","table-icon",3,"tabindex","focus"],["tri-svg-icon-20","",1,"table-svg-icon",3,"name"],["data-clickable","true","role","columnheader",1,"header","selectable",3,"tabindex","focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["triResizeColumn","",1,"resize-handle",3,"columnResized"],[3,"itemSize","scroll"],["viewport",""],["class","row","role","row",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],["class","row","role","row","tabindex","0",4,"ngIf"],["role","row",1,"row"],["class","cell row-header selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selection-start","focus",4,"ngIf"],["class","cell selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selected-top","selected-bottom","selected-left","selected-right","selected","selection-start","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","row-header","selectable",3,"focus"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","selectable",3,"focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["viewCell",""],["cellEditor",""],["role","row","tabindex","0",1,"row"],["class","cell row-header","role","gridcell","tabindex","-1",3,"mousedown","focus",4,"ngIf"],["tabindex","-1","class","cell","role","gridcell",3,"width","mousedown","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1",1,"cell","row-header",3,"mousedown","focus"],["tabindex","-1","role","gridcell",1,"cell",3,"mousedown","focus"],[3,"column","data","dataChange","focusEditor$"],[3,"data"],[1,"default-header-name"]],template:function(x,U){1&x&&(u.\u0275\u0275elementStart(0,"div",0,1),u.\u0275\u0275listener("keydown",function(Pe){return U.handleKeydown(Pe)})("mousedown",function(Pe){return U.onCellMouseDown(Pe)})("mouseover",function(Pe){return U.onCellMouseOver(Pe)})("mouseup",function(Pe){return U.onCellMouseUp(Pe)})("dblclick",function(Pe){return U.onCellDoubleClick(Pe)}),u.\u0275\u0275template(2,jt,7,6,"ng-container",2),u.\u0275\u0275pipe(3,"async"),u.\u0275\u0275elementEnd(),u.\u0275\u0275template(4,Tt,1,4,"ng-template",null,3,u.\u0275\u0275templateRefExtractor),u.\u0275\u0275template(6,Dt,1,1,"ng-template",null,4,u.\u0275\u0275templateRefExtractor),u.\u0275\u0275template(8,ke,2,1,"ng-template",null,5,u.\u0275\u0275templateRefExtractor)),2&x&&(u.\u0275\u0275advance(2),u.\u0275\u0275property("ngIf",u.\u0275\u0275pipeBind1(3,1,U.columns$)))},dependencies:[ee.NgForOf,ee.NgIf,ee.NgTemplateOutlet,e.xd,e.x0,e.N7,ae.M,fe,Ct,Me,ee.AsyncPipe,Ge],styles:['[_nghost-%COMP%]{height:100%;width:100%;display:flex;background:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);--row-height: $default-row-height}[_nghost-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box}[_nghost-%COMP%]   *[_ngcontent-%COMP%]:focus{outline:none}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{overflow-x:auto;height:calc(100% - var(--row-height));position:absolute;top:var(--row-height);bottom:0;width:100%;scrollbar-width:thin}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border:1px solid var(--fluentThemeNeutralSecondaryAltColor, #767676);border-radius:20px;background-color:var(--fluentThemeNeutralSecondaryAltColor, #767676)}.table[_ngcontent-%COMP%]{height:100%;display:flex;position:relative;max-width:100%;overflow-x:hidden;width:max-content;padding-right:5px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]{text-align:start;display:flex;flex-wrap:nowrap;height:var(--row-height);width:100%;border-left:1px solid var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:inline-flex;position:relative;min-width:45px;height:var(--row-height);line-height:12px;margin:0;padding:3px 6px;background:var(--colorNeutralBackground2);flex-shrink:0;flex-grow:0;overflow:hidden;border-top:solid 1px var(--colorNeutralStroke2);border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .default-header-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;opacity:0;width:10px;cursor:col-resize}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]:focus{padding:2px 5px 2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]   .table-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForeground2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;border-left:solid 1px var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .selectable[_ngcontent-%COMP%]:not(.selection-start):focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:1.5px 4px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{cursor:default;position:relative;display:inline-flex;flex-grow:0;min-width:45px;height:var(--row-height);padding:3.5px 6px;align-items:center;overflow:hidden;border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);background:var(--colorSubtleBackground);outline:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.number-cell[_ngcontent-%COMP%]{text-align:right}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2);justify-content:center;padding:3px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:focus{padding:1px 1px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected[_ngcontent-%COMP%]{background:var(--colorSubtleBackgroundSelected)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:not(.selected-bottom){padding-bottom:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:not(.selected-top){padding-top:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-top:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:before{border-top:1px solid var(--colorNeutralStrokeFocus1);top:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-bottom:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:before{border-bottom:1px solid var(--colorNeutralStrokeFocus1);bottom:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-left:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]:before{border-left:1px solid var(--colorNeutralStrokeFocus1);left:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-right:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]:before{border-right:1px solid var(--colorNeutralStrokeFocus1);right:0}'],changeDetection:0}),f}(R.w)},11962:function(Pt,vt,m){"use strict";m.d(vt,{oY:function(){return oe.o},V7:function(){return Ee}});var M=m(17174),u=m(77476),e=m(21661),F=m(78035),oe=m(23873),D=m(17177),Re=m(50423),Ee=function(){function R(){}return R.\u0275fac=function(De){return new(De||R)},R.\u0275mod=Re.\u0275\u0275defineNgModule({type:R}),R.\u0275inj=Re.\u0275\u0275defineInjector({imports:[u.CommonModule,M.u5,F.Y,e.Cl,D.T6]}),R}();m(81900)},81900:function(Pt,vt,m){"use strict";m.d(vt,{g:function(){return u}});var u=new(m(50423).InjectionToken)("ResizeService")},87491:function(Pt,vt,m){var M=m(51968),e=m(20806)(M);e.push([Pt.id,"",""]),Pt.exports=e},94908:function(Pt,vt,m){"use strict";m.d(vt,{Mz:function(){return It},VI:function(){return fn},g8:function(){return Xt},q5:function(){return be},zp:function(){return Mn}});var ae,fe,me,$e,ct,Ct,Me,M=m(62661),u=m(90341),e=m(37419),F=m(50423),oe=m(48138),D=m(77476),Re=m(21661),Be=m(59051),Ee=m(51193),pe=m(4437),R=m(10519),Fe=m(26124),De=m(34763),G=m(30794),We=m(48636),Ue=m(63057),ne=m(59787),se=m(11547),ve=m(93247),Se=m(22760),W=m(17174),He=m(60733),he=m(22318),ye=m(81905),je=m(48787),rt=m(59973),Ke=m(17653),Q=m(70032),K=m(14172),ee=m(94130),Ge=["panel"];function Te(Dt,ke){if(1&Dt){var _e=F.\u0275\u0275getCurrentView();F.\u0275\u0275elementStart(0,"div",0,1),F.\u0275\u0275listener("@panelAnimation.done",function(x){F.\u0275\u0275restoreView(_e);var U=F.\u0275\u0275nextContext();return F.\u0275\u0275resetView(U._animationDone.next(x))}),F.\u0275\u0275projection(2),F.\u0275\u0275elementEnd()}if(2&Dt){var S=ke.id,f=F.\u0275\u0275nextContext();F.\u0275\u0275property("id",f.id)("ngClass",f._classList)("@panelAnimation",f.isOpen?"visible":"hidden"),F.\u0275\u0275attribute("aria-label",f.ariaLabel||null)("aria-labelledby",f._getPanelAriaLabelledby(S))}}var _t=(0,Fe.X$)("panelAnimation",[(0,Fe.SB)("void, hidden",(0,Fe.oB)({opacity:0,transform:"scaleY(0.8)"})),(0,Fe.eR)(":enter, hidden => visible",[(0,Fe.ru)([(0,Fe.jt)("0.03s linear",(0,Fe.oB)({opacity:1})),(0,Fe.jt)("0.12s cubic-bezier(0, 0, 0.2, 1)",(0,Fe.oB)({transform:"scaleY(1)"}))])]),(0,Fe.eR)(":leave, visible => hidden",[(0,Fe.jt)("0.075s linear",(0,Fe.oB)({opacity:0}))])]),yt=0,tt=function(ke,_e){this.source=ke,this.option=_e},zt=(0,oe.Kr)(function(){return function(){}}()),k=new F.InjectionToken("mat-autocomplete-default-options",{providedIn:"root",factory:function(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}}),It=function(Dt){(0,e.Z)(_e,Dt);var ke=_e.prototype;function _e(S,f,E,x){var U;return(U=Dt.call(this)||this)._changeDetectorRef=S,U._elementRef=f,U._defaults=E,U._activeOptionChanges=De.w.EMPTY,U.showPanel=!1,U._isOpen=!1,U.displayWith=null,U.optionSelected=new F.EventEmitter,U.opened=new F.EventEmitter,U.closed=new F.EventEmitter,U.optionActivated=new F.EventEmitter,U._classList={},U.id="mat-autocomplete-"+yt++,U.inertGroups=x?.SAFARI||!1,U._autoActiveFirstOption=!!E.autoActiveFirstOption,U._autoSelectActiveOption=!!E.autoSelectActiveOption,U._requireSelection=!!E.requireSelection,U}return ke._setColor=function(f){this._color=f,this._setThemeClasses(this._classList)},ke.ngAfterContentInit=function(){var f=this;this._keyManager=new Ee.s1(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(function(E){f.isOpen&&f.optionActivated.emit({source:f,option:f.options.toArray()[E]||null})}),this._setVisibility()},ke.ngOnDestroy=function(){var f;null==(f=this._keyManager)||f.destroy(),this._activeOptionChanges.unsubscribe()},ke._setScrollTop=function(f){this.panel&&(this.panel.nativeElement.scrollTop=f)},ke._getScrollTop=function(){return this.panel?this.panel.nativeElement.scrollTop:0},ke._setVisibility=function(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()},ke._emitSelectEvent=function(f){var E=new tt(this,f);this.optionSelected.emit(E)},ke._getPanelAriaLabelledby=function(f){return this.ariaLabel?null:this.ariaLabelledby?(f?f+" ":"")+this.ariaLabelledby:f},ke._setVisibilityClasses=function(f){f[this._visibleClass]=this.showPanel,f[this._hiddenClass]=!this.showPanel},ke._setThemeClasses=function(f){f["mat-primary"]="primary"===this._color,f["mat-warn"]="warn"===this._color,f["mat-accent"]="accent"===this._color},ke._skipPredicate=function(f){return f.disabled},(0,u.Z)(_e,[{key:"isOpen",get:function(){return this._isOpen&&this.showPanel}},{key:"autoActiveFirstOption",get:function(){return this._autoActiveFirstOption},set:function(f){this._autoActiveFirstOption=(0,pe.Ig)(f)}},{key:"autoSelectActiveOption",get:function(){return this._autoSelectActiveOption},set:function(f){this._autoSelectActiveOption=(0,pe.Ig)(f)}},{key:"requireSelection",get:function(){return this._requireSelection},set:function(f){this._requireSelection=(0,pe.Ig)(f)}},{key:"classList",set:function(f){this._classList=f&&f.length?(0,pe.du)(f).reduce(function(E,x){return E[x]=!0,E},{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}}]),_e}(zt);(ae=It).\u0275fac=function(ke){return new(ke||ae)(F.\u0275\u0275directiveInject(F.ChangeDetectorRef),F.\u0275\u0275directiveInject(F.ElementRef),F.\u0275\u0275directiveInject(k),F.\u0275\u0275directiveInject(R.t4))},ae.\u0275dir=F.\u0275\u0275defineDirective({type:ae,viewQuery:function(ke,_e){var S;1&ke&&(F.\u0275\u0275viewQuery(F.TemplateRef,7),F.\u0275\u0275viewQuery(Ge,5)),2&ke&&(F.\u0275\u0275queryRefresh(S=F.\u0275\u0275loadQuery())&&(_e.template=S.first),F.\u0275\u0275queryRefresh(S=F.\u0275\u0275loadQuery())&&(_e.panel=S.first))},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",requireSelection:"requireSelection",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[F.\u0275\u0275InheritDefinitionFeature]});var nt=function(Dt){function ke(){var S,f;return(f=Dt.apply(this,arguments)||this)._visibleClass="mat-mdc-autocomplete-visible",f._hiddenClass="mat-mdc-autocomplete-hidden",f._animationDone=new F.EventEmitter,f._hideSingleSelectionIndicator=null!=(S=f._defaults.hideSingleSelectionIndicator)&&S,f}(0,e.Z)(ke,Dt);var _e=ke.prototype;return _e._syncParentProperties=function(){if(this.options)for(var E,f=(0,M.Z)(this.options);!(E=f()).done;)E.value._changeDetectorRef.markForCheck()},_e.ngOnDestroy=function(){Dt.prototype.ngOnDestroy.call(this),this._animationDone.complete()},_e._skipPredicate=function(f){return!1},(0,u.Z)(ke,[{key:"hideSingleSelectionIndicator",get:function(){return this._hideSingleSelectionIndicator},set:function(f){this._hideSingleSelectionIndicator=(0,pe.Ig)(f),this._syncParentProperties()}}]),ke}(It);(fe=nt).\u0275fac=function(){var Dt;return function(_e){return(Dt||(Dt=F.\u0275\u0275getInheritedFactory(fe)))(_e||fe)}}(),fe.\u0275cmp=F.\u0275\u0275defineComponent({type:fe,selectors:[["mat-autocomplete"]],contentQueries:function(ke,_e,S){var f;1&ke&&(F.\u0275\u0275contentQuery(S,oe.K7,5),F.\u0275\u0275contentQuery(S,oe.ey,5)),2&ke&&(F.\u0275\u0275queryRefresh(f=F.\u0275\u0275loadQuery())&&(_e.optionGroups=f),F.\u0275\u0275queryRefresh(f=F.\u0275\u0275loadQuery())&&(_e.options=f))},hostAttrs:["ngSkipHydration","",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[F.\u0275\u0275ProvidersFeature([{provide:oe.HF,useExisting:fe}]),F.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(ke,_e){1&ke&&(F.\u0275\u0275projectionDef(),F.\u0275\u0275template(0,Te,3,5,"ng-template"))},dependencies:[D.NgClass],styles:["div.mat-mdc-autocomplete-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[_t]},changeDetection:0});var be=function(ke){this.elementRef=ke};(me=be).\u0275fac=function(ke){return new(ke||me)(F.\u0275\u0275directiveInject(F.ElementRef))},me.\u0275dir=F.\u0275\u0275defineDirective({type:me});var de=function(Dt){function ke(){return Dt.apply(this,arguments)||this}return(0,e.Z)(ke,Dt),ke}(be);($e=de).\u0275fac=function(){var Dt;return function(_e){return(Dt||(Dt=F.\u0275\u0275getInheritedFactory($e)))(_e||$e)}}(),$e.\u0275dir=F.\u0275\u0275defineDirective({type:$e,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[F.\u0275\u0275InheritDefinitionFeature]});var V={provide:W.JU,useExisting:(0,F.forwardRef)(function(){return jt}),multi:!0},Xt=new F.InjectionToken("mat-autocomplete-scroll-strategy"),Mn={provide:Xt,deps:[Be.aV],useFactory:function(Dt){return function(){return Dt.scrollStrategies.reposition()}}},fn=function(){function Dt(_e,S,f,E,x,U,le,Pe,qe,St,Et){var at=this;this._element=_e,this._overlay=S,this._viewContainerRef=f,this._zone=E,this._changeDetectorRef=x,this._dir=le,this._formField=Pe,this._document=qe,this._viewportRuler=St,this._defaults=Et,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=De.w.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new G.xQ,this._windowBlurHandler=function(){at._canOpenOnNextFocus=at._document.activeElement!==at._element.nativeElement||at.panelOpen},this._onChange=function(){},this._onTouched=function(){},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,We.P)(function(){var Lt=at.autocomplete?at.autocomplete.options:null;return Lt?Lt.changes.pipe((0,he.O)(Lt),(0,ye.w)(function(){return Ue.T.apply(void 0,Lt.map(function(en){return en.onSelectionChange}))})):at._zone.onStable.pipe((0,je.q)(1),(0,ye.w)(function(){return at.optionSelections}))}),this._handlePanelKeydown=function(Lt){var en;(Lt.keyCode===ve.hY&&!(0,ve.Vb)(Lt)||Lt.keyCode===ve.LH&&(0,ve.Vb)(Lt,"altKey"))&&(at._pendingAutoselectedOption&&(at._updateNativeInputValue(null!=(en=at._valueBeforeAutoSelection)?en:""),at._pendingAutoselectedOption=null),at._closeKeyEventStream.next(),at._resetActiveItem(),Lt.stopPropagation(),Lt.preventDefault())},this._trackedModal=null,this._scrollStrategy=U}var ke=Dt.prototype;return ke.ngAfterViewInit=function(){var S=this,f=this._getWindow();typeof f<"u"&&this._zone.runOutsideAngular(function(){return f.addEventListener("blur",S._windowBlurHandler)})},ke.ngOnChanges=function(S){S.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())},ke.ngOnDestroy=function(){var S=this._getWindow();typeof S<"u"&&S.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()},ke.openPanel=function(){this._attachOverlay(),this._floatLabel(),this._trackedModal&&(0,Ee.Zf)(this._trackedModal,"aria-owns",this.autocomplete.id)},ke.closePanel=function(){var S=this;this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(function(){S.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)&&(0,Ee.iD)(this._trackedModal,"aria-owns",this.autocomplete.id)},ke.updatePosition=function(){this._overlayAttached&&this._overlayRef.updatePosition()},ke._getOutsideClickStream=function(){var S=this;return(0,Ue.T)((0,ne.R)(this._document,"click"),(0,ne.R)(this._document,"auxclick"),(0,ne.R)(this._document,"touchend")).pipe((0,rt.h)(function(f){var E=(0,R.sA)(f),x=S._formField?S._formField._elementRef.nativeElement:null,U=S.connectedTo?S.connectedTo.elementRef.nativeElement:null;return S._overlayAttached&&E!==S._element.nativeElement&&S._document.activeElement!==S._element.nativeElement&&(!x||!x.contains(E))&&(!U||!U.contains(E))&&!!S._overlayRef&&!S._overlayRef.overlayElement.contains(E)}))},ke.writeValue=function(S){var f=this;Promise.resolve(null).then(function(){return f._assignOptionValue(S)})},ke.registerOnChange=function(S){this._onChange=S},ke.registerOnTouched=function(S){this._onTouched=S},ke.setDisabledState=function(S){this._element.nativeElement.disabled=S},ke._handleKeydown=function(S){var f=S.keyCode,E=(0,ve.Vb)(S);if(f===ve.hY&&!E&&S.preventDefault(),this.activeOption&&f===ve.K5&&this.panelOpen&&!E)this.activeOption._selectViaInteraction(),this._resetActiveItem(),S.preventDefault();else if(this.autocomplete){var x=this.autocomplete._keyManager.activeItem,U=f===ve.LH||f===ve.JH;f===ve.Mf||U&&!E&&this.panelOpen?this.autocomplete._keyManager.onKeydown(S):U&&this._canOpen()&&this.openPanel(),(U||this.autocomplete._keyManager.activeItem!==x)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}},ke._handleInput=function(S){var f=S.target,E=f.value;"number"===f.type&&(E=""==E?null:parseFloat(E)),this._previousValue!==E&&(this._previousValue=E,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(E),E||this._clearPreviousSelectedOption(null,!1),this._canOpen()&&this._document.activeElement===S.target&&this.openPanel())},ke._handleFocus=function(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0},ke._handleClick=function(){this._canOpen()&&!this.panelOpen&&this.openPanel()},ke._floatLabel=function(S){void 0===S&&(S=!1),this._formField&&"auto"===this._formField.floatLabel&&(S?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)},ke._resetLabel=function(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)},ke._subscribeToClosingActions=function(){var S=this,f=this._zone.onStable.pipe((0,je.q)(1)),E=this.autocomplete.options.changes.pipe((0,Ke.b)(function(){return S._positionStrategy.reapplyLastPosition()}),(0,Q.g)(0));return(0,Ue.T)(f,E).pipe((0,ye.w)(function(){return S._zone.run(function(){var x=S.panelOpen;S._resetActiveItem(),S._updatePanelState(),S._changeDetectorRef.detectChanges(),S.panelOpen&&S._overlayRef.updatePosition(),x!==S.panelOpen&&(S.panelOpen?(S._captureValueOnAttach(),S._emitOpened()):S.autocomplete.closed.emit())}),S.panelClosingActions}),(0,je.q)(1)).subscribe(function(x){return S._setValueAndClose(x)})},ke._emitOpened=function(){this.autocomplete.opened.emit()},ke._captureValueOnAttach=function(){this._valueOnAttach=this._element.nativeElement.value},ke._destroyPanel=function(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)},ke._assignOptionValue=function(S){var f=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(S):S;this._updateNativeInputValue(f??"")},ke._updateNativeInputValue=function(S){this._formField?this._formField._control.value=S:this._element.nativeElement.value=S,this._previousValue=S},ke._setValueAndClose=function(S){var f=this,E=this.autocomplete,x=S?S.source:this._pendingAutoselectedOption;x?(this._clearPreviousSelectedOption(x),this._assignOptionValue(x.value),this._onChange(x.value),E._emitSelectEvent(x),this._element.nativeElement.focus()):E.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),E._animationDone?E._animationDone.pipe((0,je.q)(1)).subscribe(function(){return f._onChange(null)}):this._onChange(null)),this.closePanel()},ke._clearPreviousSelectedOption=function(S,f){var E;null==(E=this.autocomplete)||null==(E=E.options)||E.forEach(function(x){x!==S&&x.selected&&x.deselect(f)})},ke._attachOverlay=function(){var f,x,S=this,E=this._overlayRef;E?(this._positionStrategy.setOrigin(this._getConnectedElement()),E.updateSize({width:this._getPanelWidth()})):(this._portal=new Se.UE(this.autocomplete.template,this._viewContainerRef,{id:null==(x=this._formField)?void 0:x.getLabelId()}),E=this._overlay.create(this._getOverlayConfig()),this._overlayRef=E,this._viewportSubscription=this._viewportRuler.change().subscribe(function(){S.panelOpen&&E&&E.updateSize({width:S._getPanelWidth()})})),E&&!E.hasAttached()&&(E.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());var U=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(null==(f=this._formField)?void 0:f.color),this._updatePanelState(),this._applyModalPanelOwnership(),this._captureValueOnAttach(),this.panelOpen&&U!==this.panelOpen&&this._emitOpened()},ke._updatePanelState=function(){if(this.autocomplete._setVisibility(),this.panelOpen){var S=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=S.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=S.outsidePointerEvents().subscribe())}else{var f,E;null==(f=this._keydownSubscription)||f.unsubscribe(),null==(E=this._outsideClickSubscription)||E.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}},ke._getOverlayConfig=function(){var S,f;return new Be.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:null!=(S=this._dir)?S:void 0,panelClass:null==(f=this._defaults)?void 0:f.overlayPanelClass})},ke._getOverlayPosition=function(){var S=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(S),this._positionStrategy=S,S},ke._setStrategyPositions=function(S){var U,f=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],E=this._aboveClass,x=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:E},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:E}];U="above"===this.position?x:"below"===this.position?f:[].concat(f,x),S.withPositions(U)},ke._getConnectedElement=function(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element},ke._getPanelWidth=function(){return this.autocomplete.panelWidth||this._getHostWidth()},ke._getHostWidth=function(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width},ke._resetActiveItem=function(){var S=this.autocomplete;if(S.autoActiveFirstOption){for(var f=-1,E=0;E<S.options.length;E++)if(!S.options.get(E).disabled){f=E;break}S._keyManager.setActiveItem(f)}else S._keyManager.setActiveItem(-1)},ke._canOpen=function(){var S=this._element.nativeElement;return!S.readOnly&&!S.disabled&&!this._autocompleteDisabled},ke._getWindow=function(){var S;return(null==(S=this._document)?void 0:S.defaultView)||window},ke._scrollToOption=function(S){var f=this.autocomplete,E=(0,oe.CB)(S,f.options,f.optionGroups);if(0===S&&1===E)f._setScrollTop(0);else if(f.panel){var x=f.options.toArray()[S];if(x){var U=x._getHostElement(),le=(0,oe.jH)(U.offsetTop,U.offsetHeight,f._getScrollTop(),f.panel.nativeElement.offsetHeight);f._setScrollTop(le)}}},ke._applyModalPanelOwnership=function(){var S=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(S){var f=this.autocomplete.id;this._trackedModal&&(0,Ee.iD)(this._trackedModal,"aria-owns",f),(0,Ee.Zf)(S,"aria-owns",f),this._trackedModal=S}},ke._clearFromModal=function(){this._trackedModal&&((0,Ee.iD)(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)},(0,u.Z)(Dt,[{key:"autocompleteDisabled",get:function(){return this._autocompleteDisabled},set:function(S){this._autocompleteDisabled=(0,pe.Ig)(S)}},{key:"panelOpen",get:function(){return this._overlayAttached&&this.autocomplete.showPanel}},{key:"panelClosingActions",get:function(){var S=this;return(0,Ue.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,rt.h)(function(){return S._overlayAttached})),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,rt.h)(function(){return S._overlayAttached})):(0,se.of)()).pipe((0,K.U)(function(f){return f instanceof oe.rN?f:null}))}},{key:"activeOption",get:function(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}}]),Dt}();(ct=fn).\u0275fac=function(ke){return new(ke||ct)(F.\u0275\u0275directiveInject(F.ElementRef),F.\u0275\u0275directiveInject(Be.aV),F.\u0275\u0275directiveInject(F.ViewContainerRef),F.\u0275\u0275directiveInject(F.NgZone),F.\u0275\u0275directiveInject(F.ChangeDetectorRef),F.\u0275\u0275directiveInject(Xt),F.\u0275\u0275directiveInject(ee.Is,8),F.\u0275\u0275directiveInject(He.G_,9),F.\u0275\u0275directiveInject(D.DOCUMENT,8),F.\u0275\u0275directiveInject(Re.rL),F.\u0275\u0275directiveInject(k,8))},ct.\u0275dir=F.\u0275\u0275defineDirective({type:ct,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[F.\u0275\u0275NgOnChangesFeature]});var jt=function(Dt){function ke(){var _e;return(_e=Dt.apply(this,arguments)||this)._aboveClass="mat-mdc-autocomplete-panel-above",_e}return(0,e.Z)(ke,Dt),ke}(fn);(Ct=jt).\u0275fac=function(){var Dt;return function(_e){return(Dt||(Dt=F.\u0275\u0275getInheritedFactory(Ct)))(_e||Ct)}}(),Ct.\u0275dir=F.\u0275\u0275defineDirective({type:Ct,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(ke,_e){1&ke&&F.\u0275\u0275listener("focusin",function(){return _e._handleFocus()})("blur",function(){return _e._onTouched()})("input",function(f){return _e._handleInput(f)})("keydown",function(f){return _e._handleKeydown(f)})("click",function(){return _e._handleClick()}),2&ke&&F.\u0275\u0275attribute("autocomplete",_e.autocompleteAttribute)("role",_e.autocompleteDisabled?null:"combobox")("aria-autocomplete",_e.autocompleteDisabled?null:"list")("aria-activedescendant",_e.panelOpen&&_e.activeOption?_e.activeOption.id:null)("aria-expanded",_e.autocompleteDisabled?null:_e.panelOpen.toString())("aria-controls",_e.autocompleteDisabled||!_e.panelOpen||null==_e.autocomplete?null:_e.autocomplete.id)("aria-haspopup",_e.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[F.\u0275\u0275ProvidersFeature([V]),F.\u0275\u0275InheritDefinitionFeature]}),(Me=function(){}).\u0275fac=function(ke){return new(ke||Me)},Me.\u0275mod=F.\u0275\u0275defineNgModule({type:Me}),Me.\u0275inj=F.\u0275\u0275defineInjector({providers:[Mn],imports:[Be.U8,oe.Ng,oe.BQ,D.CommonModule,Re.ZD,oe.Ng,oe.BQ]})},34895:function(Pt,vt,m){"use strict";m.d(vt,{D8:function(){return Se},QJ:function(){return se},VN:function(){return Ue}});var pe,R,Fe,De,M=m(37419),u=m(50423),e=m(48138),F=m(33846),oe=m(94908),D=m(77476),Re=m(59051),Be=m(21661),Ee=m(17174);function G(W,He){if(1&W&&(u.\u0275\u0275elementStart(0,"div",0,1),u.\u0275\u0275projection(2),u.\u0275\u0275elementEnd()),2&W){var he=He.id,ye=u.\u0275\u0275nextContext();u.\u0275\u0275property("id",ye.id)("ngClass",ye._classList),u.\u0275\u0275attribute("aria-label",ye.ariaLabel||null)("aria-labelledby",ye._getPanelAriaLabelledby(he))}}var Ue=function(W){function He(){var he;return(he=W.apply(this,arguments)||this)._visibleClass="mat-autocomplete-visible",he._hiddenClass="mat-autocomplete-hidden",he._animationDone=null,he}return(0,M.Z)(He,W),He}(oe.Mz);(pe=Ue).\u0275fac=function(){var W;return function(he){return(W||(W=u.\u0275\u0275getInheritedFactory(pe)))(he||pe)}}(),pe.\u0275cmp=u.\u0275\u0275defineComponent({type:pe,selectors:[["mat-autocomplete"]],contentQueries:function(He,he,ye){var je;1&He&&(u.\u0275\u0275contentQuery(ye,e.K7,5),u.\u0275\u0275contentQuery(ye,F.CK,5)),2&He&&(u.\u0275\u0275queryRefresh(je=u.\u0275\u0275loadQuery())&&(he.optionGroups=je),u.\u0275\u0275queryRefresh(je=u.\u0275\u0275loadQuery())&&(he.options=je))},hostAttrs:["ngSkipHydration","",1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[u.\u0275\u0275ProvidersFeature([{provide:e.HF,useExisting:pe}]),u.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(He,he){1&He&&(u.\u0275\u0275projectionDef(),u.\u0275\u0275template(0,G,3,4,"ng-template"))},dependencies:[D.NgClass],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}"],encapsulation:2,changeDetection:0});var ne={provide:Ee.JU,useExisting:(0,u.forwardRef)(function(){return se}),multi:!0},se=function(W){function He(){var he;return(he=W.apply(this,arguments)||this)._aboveClass="mat-autocomplete-panel-above",he}return(0,M.Z)(He,W),He}(oe.VI);(R=se).\u0275fac=function(){var W;return function(he){return(W||(W=u.\u0275\u0275getInheritedFactory(R)))(he||R)}}(),R.\u0275dir=u.\u0275\u0275defineDirective({type:R,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(He,he){1&He&&u.\u0275\u0275listener("focusin",function(){return he._handleFocus()})("blur",function(){return he._onTouched()})("input",function(je){return he._handleInput(je)})("keydown",function(je){return he._handleKeydown(je)})("click",function(){return he._handleClick()}),2&He&&u.\u0275\u0275attribute("autocomplete",he.autocompleteAttribute)("role",he.autocompleteDisabled?null:"combobox")("aria-autocomplete",he.autocompleteDisabled?null:"list")("aria-activedescendant",he.panelOpen&&he.activeOption?he.activeOption.id:null)("aria-expanded",he.autocompleteDisabled?null:he.panelOpen.toString())("aria-owns",he.autocompleteDisabled||!he.panelOpen||null==he.autocomplete?null:he.autocomplete.id)("aria-haspopup",he.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[u.\u0275\u0275ProvidersFeature([ne]),u.\u0275\u0275InheritDefinitionFeature]});var ve=function(W){function He(){return W.apply(this,arguments)||this}return(0,M.Z)(He,W),He}(oe.q5);(Fe=ve).\u0275fac=function(){var W;return function(he){return(W||(W=u.\u0275\u0275getInheritedFactory(Fe)))(he||Fe)}}(),Fe.\u0275dir=u.\u0275\u0275defineDirective({type:Fe,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[u.\u0275\u0275InheritDefinitionFeature]});var Se=function(){};(De=Se).\u0275fac=function(He){return new(He||De)},De.\u0275mod=u.\u0275\u0275defineNgModule({type:De}),De.\u0275inj=u.\u0275\u0275defineInjector({providers:[oe.zp],imports:[Re.U8,F.Uc,e.BQ,D.CommonModule,Be.ZD,F.Uc,e.BQ]})},89075:function(Pt,vt,m){"use strict";m.d(vt,{IP:function(){return zt},Y6:function(){return Me},ir:function(){return yt},lw:function(){return Ct},yD:function(){return Cn}});var Se,W,He,he,ye,je,rt,M=m(90341),u=m(76920),e=m(37419),F=m(93247),oe=m(50423),D=m(48138),Re=m(4437),Be=m(10519),Ee=m(77476),pe=m(30794),R=m(63057),Fe=m(48787),De=m(83317),G=m(22318),We=m(51193),Ue=m(94130),ne=m(77445),se=m(17174),ve=m(60733),K=new oe.InjectionToken("MatChipRemove"),ee=new oe.InjectionToken("MatChipAvatar"),ae=new oe.InjectionToken("MatChipTrailingIcon"),me=(0,D.sb)((0,D.pj)((0,D.Kr)(function(nt){this._elementRef=nt}),"primary"),-1);(Se=function(){}).\u0275fac=function(nt){return new(nt||Se)},Se.\u0275dir=oe.\u0275\u0275defineDirective({type:Se,selectors:[["mat-chip-avatar"],["","matChipAvatar",""]],hostAttrs:[1,"mat-chip-avatar"],features:[oe.\u0275\u0275ProvidersFeature([{provide:ee,useExisting:Se}])]});(W=function(){}).\u0275fac=function(nt){return new(nt||W)},W.\u0275dir=oe.\u0275\u0275defineDirective({type:W,selectors:[["mat-chip-trailing-icon"],["","matChipTrailingIcon",""]],hostAttrs:[1,"mat-chip-trailing-icon"],features:[oe.\u0275\u0275ProvidersFeature([{provide:ae,useExisting:W}])]});var Ct=function(It){function nt(de,V,lt,Xt,sn,Mn,fn,jt){var Tt;return(Tt=It.call(this,de)||this)._ngZone=V,Tt._changeDetectorRef=sn,Tt._hasFocus=!1,Tt.chipListSelectable=!0,Tt._chipListMultiple=!1,Tt._chipListDisabled=!1,Tt.role="option",Tt._selected=!1,Tt._selectable=!0,Tt._disabled=!1,Tt._removable=!0,Tt._onFocus=new pe.xQ,Tt._onBlur=new pe.xQ,Tt.selectionChange=new oe.EventEmitter,Tt.destroyed=new oe.EventEmitter,Tt.removed=new oe.EventEmitter,Tt._addHostClassName(),Tt._chipRippleTarget=Mn.createElement("div"),Tt._chipRippleTarget.classList.add("mat-chip-ripple"),Tt._elementRef.nativeElement.appendChild(Tt._chipRippleTarget),Tt._chipRipple=new D.IR((0,u.Z)(Tt),V,Tt._chipRippleTarget,lt),Tt._chipRipple.setupTriggerEvents(de),Tt.rippleConfig=Xt||{},Tt._animationsDisabled="NoopAnimations"===fn,Tt.tabIndex=null!=jt&&parseInt(jt)||-1,Tt}(0,e.Z)(nt,It);var be=nt.prototype;return be._addHostClassName=function(){var V="mat-basic-chip",lt=this._elementRef.nativeElement;lt.hasAttribute(V)||lt.tagName.toLowerCase()===V?lt.classList.add(V):lt.classList.add("mat-standard-chip")},be.ngOnDestroy=function(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()},be.select=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},be.deselect=function(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},be.selectViaInteraction=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())},be.toggleSelected=function(V){return void 0===V&&(V=!1),this._selected=!this.selected,this._dispatchSelectionChange(V),this._changeDetectorRef.markForCheck(),this.selected},be.focus=function(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0},be.remove=function(){this.removable&&this.removed.emit({chip:this})},be._handleClick=function(V){this.disabled&&V.preventDefault()},be._handleKeydown=function(V){if(!this.disabled)switch(V.keyCode){case F.yY:case F.ZH:this.remove(),V.preventDefault();break;case F.L_:this.selectable&&this.toggleSelected(!0),V.preventDefault()}},be._blur=function(){var V=this;this._ngZone.onStable.pipe((0,Fe.q)(1)).subscribe(function(){V._ngZone.run(function(){V._hasFocus=!1,V._onBlur.next({chip:V})})})},be._dispatchSelectionChange=function(V){void 0===V&&(V=!1),this.selectionChange.emit({source:this,isUserInput:V,selected:this._selected})},(0,M.Z)(nt,[{key:"rippleDisabled",get:function(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}},{key:"selected",get:function(){return this._selected},set:function(V){var lt=(0,Re.Ig)(V);lt!==this._selected&&(this._selected=lt,this._dispatchSelectionChange())}},{key:"value",get:function(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent},set:function(V){this._value=V}},{key:"selectable",get:function(){return this._selectable&&this.chipListSelectable},set:function(V){this._selectable=(0,Re.Ig)(V)}},{key:"disabled",get:function(){return this._chipListDisabled||this._disabled},set:function(V){this._disabled=(0,Re.Ig)(V)}},{key:"removable",get:function(){return this._removable},set:function(V){this._removable=(0,Re.Ig)(V)}},{key:"ariaSelected",get:function(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}}]),nt}(me);(He=Ct).\u0275fac=function(nt){return new(nt||He)(oe.\u0275\u0275directiveInject(oe.ElementRef),oe.\u0275\u0275directiveInject(oe.NgZone),oe.\u0275\u0275directiveInject(Be.t4),oe.\u0275\u0275directiveInject(D.Y2,8),oe.\u0275\u0275directiveInject(oe.ChangeDetectorRef),oe.\u0275\u0275directiveInject(Ee.DOCUMENT),oe.\u0275\u0275directiveInject(oe.ANIMATION_MODULE_TYPE,8),oe.\u0275\u0275injectAttribute("tabindex"))},He.\u0275dir=oe.\u0275\u0275defineDirective({type:He,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(nt,be,de){var V;1&nt&&(oe.\u0275\u0275contentQuery(de,ee,5),oe.\u0275\u0275contentQuery(de,ae,5),oe.\u0275\u0275contentQuery(de,K,5)),2&nt&&(oe.\u0275\u0275queryRefresh(V=oe.\u0275\u0275loadQuery())&&(be.avatar=V.first),oe.\u0275\u0275queryRefresh(V=oe.\u0275\u0275loadQuery())&&(be.trailingIcon=V.first),oe.\u0275\u0275queryRefresh(V=oe.\u0275\u0275loadQuery())&&(be.removeIcon=V.first))},hostAttrs:[1,"mat-chip","mat-focus-indicator"],hostVars:15,hostBindings:function(nt,be){1&nt&&oe.\u0275\u0275listener("click",function(V){return be._handleClick(V)})("keydown",function(V){return be._handleKeydown(V)})("focus",function(){return be.focus()})("blur",function(){return be._blur()}),2&nt&&(oe.\u0275\u0275attribute("tabindex",be.disabled?null:be.tabIndex)("role",be.role)("disabled",be.disabled||null)("aria-disabled",be.disabled.toString())("aria-selected",be.ariaSelected),oe.\u0275\u0275classProp("mat-chip-selected",be.selected)("mat-chip-with-avatar",be.avatar)("mat-chip-with-trailing-icon",be.trailingIcon||be.removeIcon)("mat-chip-disabled",be.disabled)("_mat-animation-noopable",be._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[oe.\u0275\u0275InheritDefinitionFeature]});var Me=function(){function It(be,de){this._parentChip=be,"BUTTON"===de.nativeElement.nodeName&&de.nativeElement.setAttribute("type","button")}return It.prototype._handleClick=function(de){var V=this._parentChip;V.removable&&!V.disabled&&V.remove(),de.stopPropagation(),de.preventDefault()},It}();(he=Me).\u0275fac=function(nt){return new(nt||he)(oe.\u0275\u0275directiveInject(Ct),oe.\u0275\u0275directiveInject(oe.ElementRef))},he.\u0275dir=oe.\u0275\u0275defineDirective({type:he,selectors:[["","matChipRemove",""]],hostAttrs:[1,"mat-chip-remove","mat-chip-trailing-icon"],hostBindings:function(nt,be){1&nt&&oe.\u0275\u0275listener("click",function(V){return be._handleClick(V)})},features:[oe.\u0275\u0275ProvidersFeature([{provide:K,useExisting:he}])]});var Ge=new oe.InjectionToken("mat-chips-default-options"),Te=(0,D.FD)(function(){return function(nt,be,de,V){this._defaultErrorStateMatcher=nt,this._parentForm=be,this._parentFormGroup=de,this.ngControl=V,this.stateChanges=new pe.xQ}}()),Ve=0,_t=function(nt,be){this.source=nt,this.value=be},yt=function(It){function nt(de,V,lt,Xt,sn,Mn,fn){var jt;return(jt=It.call(this,Mn,Xt,sn,fn)||this)._elementRef=de,jt._changeDetectorRef=V,jt._dir=lt,jt.controlType="mat-chip-list",jt._lastDestroyedChipIndex=null,jt._destroyed=new pe.xQ,jt._uid="mat-chip-list-"+Ve++,jt._tabIndex=0,jt._userTabIndex=null,jt._onTouched=function(){},jt._onChange=function(){},jt._multiple=!1,jt._compareWith=function(Tt,Dt){return Tt===Dt},jt._disabled=!1,jt.ariaOrientation="horizontal",jt._selectable=!0,jt.change=new oe.EventEmitter,jt.valueChange=new oe.EventEmitter,jt.ngControl&&(jt.ngControl.valueAccessor=(0,u.Z)(jt)),jt}(0,e.Z)(nt,It);var be=nt.prototype;return be.ngAfterContentInit=function(){var V=this;this._keyManager=new We.Em(this.chips).withWrap().withVerticalOrientation().withHomeAndEnd().withHorizontalOrientation(this._dir?this._dir.value:"ltr"),this._dir&&this._dir.change.pipe((0,De.R)(this._destroyed)).subscribe(function(lt){return V._keyManager.withHorizontalOrientation(lt)}),this._keyManager.tabOut.subscribe(function(){return V._allowFocusEscape()}),this.chips.changes.pipe((0,G.O)(null),(0,De.R)(this._destroyed)).subscribe(function(){(V.disabled||!V.selectable)&&Promise.resolve().then(function(){V._syncChipsState()}),V._resetChips(),V._initializeSelection(),V._updateTabIndex(),V._updateFocusForDestroyedChips(),V.stateChanges.next()})},be.ngOnInit=function(){this._selectionModel=new ne.Ov(this.multiple,void 0,!1),this.stateChanges.next()},be.ngDoCheck=function(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==this._disabled&&(this.disabled=!!this.ngControl.disabled))},be.ngOnDestroy=function(){var V;null==(V=this._keyManager)||V.destroy(),this._destroyed.next(),this._destroyed.complete(),this.stateChanges.complete(),this._dropSubscriptions()},be.registerInput=function(V){this._chipInput=V,this._elementRef.nativeElement.setAttribute("data-mat-chip-input",V.id)},be.setDescribedByIds=function(V){V.length?this._elementRef.nativeElement.setAttribute("aria-describedby",V.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")},be.writeValue=function(V){this.chips&&this._setSelectionByValue(V,!1)},be.registerOnChange=function(V){this._onChange=V},be.registerOnTouched=function(V){this._onTouched=V},be.setDisabledState=function(V){this.disabled=V,this.stateChanges.next()},be.onContainerClick=function(V){this._originatesFromChip(V)||this.focus()},be.focus=function(V){this.disabled||this._chipInput&&this._chipInput.focused||(this.chips.length>0?(this._keyManager.setFirstItemActive(),this.stateChanges.next()):(this._focusInput(V),this.stateChanges.next()))},be._focusInput=function(V){this._chipInput&&this._chipInput.focus(V)},be._keydown=function(V){var lt=V.target;lt&&lt.classList.contains("mat-chip")&&(this._keyManager.onKeydown(V),this.stateChanges.next())},be._updateTabIndex=function(){this._tabIndex=this._userTabIndex||(0===this.chips.length?-1:0)},be._updateFocusForDestroyedChips=function(){if(null!=this._lastDestroyedChipIndex)if(this.chips.length){var V=Math.min(this._lastDestroyedChipIndex,this.chips.length-1);this._keyManager.setActiveItem(V)}else this.focus();this._lastDestroyedChipIndex=null},be._isValidIndex=function(V){return V>=0&&V<this.chips.length},be._setSelectionByValue=function(V,lt){var Xt=this;if(void 0===lt&&(lt=!0),this._clearSelection(),this.chips.forEach(function(Mn){return Mn.deselect()}),Array.isArray(V))V.forEach(function(Mn){return Xt._selectValue(Mn,lt)}),this._sortValues();else{var sn=this._selectValue(V,lt);sn&&lt&&this._keyManager.setActiveItem(sn)}},be._selectValue=function(V,lt){var Xt=this;void 0===lt&&(lt=!0);var sn=this.chips.find(function(Mn){return null!=Mn.value&&Xt._compareWith(Mn.value,V)});return sn&&(lt?sn.selectViaInteraction():sn.select(),this._selectionModel.select(sn)),sn},be._initializeSelection=function(){var V=this;Promise.resolve().then(function(){(V.ngControl||V._value)&&(V._setSelectionByValue(V.ngControl?V.ngControl.value:V._value,!1),V.stateChanges.next())})},be._clearSelection=function(V){this._selectionModel.clear(),this.chips.forEach(function(lt){lt!==V&&lt.deselect()}),this.stateChanges.next()},be._sortValues=function(){var V=this;this._multiple&&(this._selectionModel.clear(),this.chips.forEach(function(lt){lt.selected&&V._selectionModel.select(lt)}),this.stateChanges.next())},be._propagateChanges=function(V){var lt;lt=Array.isArray(this.selected)?this.selected.map(function(Xt){return Xt.value}):this.selected?this.selected.value:V,this._value=lt,this.change.emit(new _t(this,lt)),this.valueChange.emit(lt),this._onChange(lt),this._changeDetectorRef.markForCheck()},be._blur=function(){var V=this;this._hasFocusedChip()||this._keyManager.setActiveItem(-1),this.disabled||(this._chipInput?setTimeout(function(){V.focused||V._markAsTouched()}):this._markAsTouched())},be._markAsTouched=function(){this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next()},be._allowFocusEscape=function(){var V=this;-1!==this._tabIndex&&(this._tabIndex=-1,setTimeout(function(){V._tabIndex=V._userTabIndex||0,V._changeDetectorRef.markForCheck()}))},be._resetChips=function(){this._dropSubscriptions(),this._listenToChipsFocus(),this._listenToChipsSelection(),this._listenToChipsRemoved()},be._dropSubscriptions=function(){this._chipFocusSubscription&&(this._chipFocusSubscription.unsubscribe(),this._chipFocusSubscription=null),this._chipBlurSubscription&&(this._chipBlurSubscription.unsubscribe(),this._chipBlurSubscription=null),this._chipSelectionSubscription&&(this._chipSelectionSubscription.unsubscribe(),this._chipSelectionSubscription=null),this._chipRemoveSubscription&&(this._chipRemoveSubscription.unsubscribe(),this._chipRemoveSubscription=null)},be._listenToChipsSelection=function(){var V=this;this._chipSelectionSubscription=this.chipSelectionChanges.subscribe(function(lt){lt.source.selected?V._selectionModel.select(lt.source):V._selectionModel.deselect(lt.source),V.multiple||V.chips.forEach(function(Xt){!V._selectionModel.isSelected(Xt)&&Xt.selected&&Xt.deselect()}),lt.isUserInput&&V._propagateChanges()})},be._listenToChipsFocus=function(){var V=this;this._chipFocusSubscription=this.chipFocusChanges.subscribe(function(lt){var Xt=V.chips.toArray().indexOf(lt.chip);V._isValidIndex(Xt)&&V._keyManager.updateActiveItem(Xt),V.stateChanges.next()}),this._chipBlurSubscription=this.chipBlurChanges.subscribe(function(){V._blur(),V.stateChanges.next()})},be._listenToChipsRemoved=function(){var V=this;this._chipRemoveSubscription=this.chipRemoveChanges.subscribe(function(lt){var Xt=lt.chip,sn=V.chips.toArray().indexOf(lt.chip);V._isValidIndex(sn)&&Xt._hasFocus&&(V._lastDestroyedChipIndex=sn)})},be._originatesFromChip=function(V){for(var lt=V.target;lt&&lt!==this._elementRef.nativeElement;){if(lt.classList.contains("mat-chip"))return!0;lt=lt.parentElement}return!1},be._hasFocusedChip=function(){return this.chips&&this.chips.some(function(V){return V._hasFocus})},be._syncChipsState=function(){var V=this;this.chips&&this.chips.forEach(function(lt){lt._chipListDisabled=V._disabled,lt._chipListMultiple=V.multiple,lt.chipListSelectable=V._selectable})},(0,M.Z)(nt,[{key:"selected",get:function(){var V,lt;return this.multiple?(null==(V=this._selectionModel)?void 0:V.selected)||[]:null==(lt=this._selectionModel)?void 0:lt.selected[0]}},{key:"role",get:function(){return this._explicitRole?this._explicitRole:this.empty?null:"listbox"},set:function(V){this._explicitRole=V}},{key:"multiple",get:function(){return this._multiple},set:function(V){this._multiple=(0,Re.Ig)(V),this._syncChipsState()}},{key:"compareWith",get:function(){return this._compareWith},set:function(V){this._compareWith=V,this._selectionModel&&this._initializeSelection()}},{key:"value",get:function(){return this._value},set:function(V){this.writeValue(V),this._value=V}},{key:"id",get:function(){return this._chipInput?this._chipInput.id:this._uid}},{key:"required",get:function(){var V,lt,Xt;return null!=(V=null!=(lt=this._required)?lt:null==(Xt=this.ngControl)||null==(Xt=Xt.control)?void 0:Xt.hasValidator(se.kI.required))&&V},set:function(V){this._required=(0,Re.Ig)(V),this.stateChanges.next()}},{key:"placeholder",get:function(){return this._chipInput?this._chipInput.placeholder:this._placeholder},set:function(V){this._placeholder=V,this.stateChanges.next()}},{key:"focused",get:function(){return this._chipInput&&this._chipInput.focused||this._hasFocusedChip()}},{key:"empty",get:function(){return(!this._chipInput||this._chipInput.empty)&&(!this.chips||0===this.chips.length)}},{key:"shouldLabelFloat",get:function(){return!this.empty||this.focused}},{key:"disabled",get:function(){return this.ngControl?!!this.ngControl.disabled:this._disabled},set:function(V){this._disabled=(0,Re.Ig)(V),this._syncChipsState()}},{key:"selectable",get:function(){return this._selectable},set:function(V){this._selectable=(0,Re.Ig)(V),this._syncChipsState()}},{key:"tabIndex",set:function(V){this._userTabIndex=V,this._tabIndex=V}},{key:"chipSelectionChanges",get:function(){return R.T.apply(void 0,this.chips.map(function(V){return V.selectionChange}))}},{key:"chipFocusChanges",get:function(){return R.T.apply(void 0,this.chips.map(function(V){return V._onFocus}))}},{key:"chipBlurChanges",get:function(){return R.T.apply(void 0,this.chips.map(function(V){return V._onBlur}))}},{key:"chipRemoveChanges",get:function(){return R.T.apply(void 0,this.chips.map(function(V){return V.destroyed}))}}]),nt}(Te);(ye=yt).\u0275fac=function(nt){return new(nt||ye)(oe.\u0275\u0275directiveInject(oe.ElementRef),oe.\u0275\u0275directiveInject(oe.ChangeDetectorRef),oe.\u0275\u0275directiveInject(Ue.Is,8),oe.\u0275\u0275directiveInject(se.F,8),oe.\u0275\u0275directiveInject(se.sg,8),oe.\u0275\u0275directiveInject(D.rD),oe.\u0275\u0275directiveInject(se.a5,10))},ye.\u0275cmp=oe.\u0275\u0275defineComponent({type:ye,selectors:[["mat-chip-list"]],contentQueries:function(nt,be,de){var V;1&nt&&oe.\u0275\u0275contentQuery(de,Ct,5),2&nt&&oe.\u0275\u0275queryRefresh(V=oe.\u0275\u0275loadQuery())&&(be.chips=V)},hostAttrs:["ngSkipHydration","",1,"mat-chip-list"],hostVars:14,hostBindings:function(nt,be){1&nt&&oe.\u0275\u0275listener("focus",function(){return be.focus()})("blur",function(){return be._blur()})("keydown",function(V){return be._keydown(V)}),2&nt&&(oe.\u0275\u0275hostProperty("id",be._uid),oe.\u0275\u0275attribute("tabindex",be.disabled?null:be._tabIndex)("aria-required",be.role?be.required:null)("aria-disabled",be.disabled.toString())("aria-invalid",be.errorState)("aria-multiselectable",be.multiple)("role",be.role)("aria-orientation",be.ariaOrientation),oe.\u0275\u0275classProp("mat-chip-list-disabled",be.disabled)("mat-chip-list-invalid",be.errorState)("mat-chip-list-required",be.required))},inputs:{role:"role",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],errorStateMatcher:"errorStateMatcher",multiple:"multiple",compareWith:"compareWith",value:"value",required:"required",placeholder:"placeholder",disabled:"disabled",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",tabIndex:"tabIndex"},outputs:{change:"change",valueChange:"valueChange"},exportAs:["matChipList"],features:[oe.\u0275\u0275ProvidersFeature([{provide:ve.Eo,useExisting:ye}]),oe.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:2,vars:0,consts:[[1,"mat-chip-list-wrapper"]],template:function(nt,be){1&nt&&(oe.\u0275\u0275projectionDef(),oe.\u0275\u0275elementStart(0,"div",0),oe.\u0275\u0275projection(1),oe.\u0275\u0275elementEnd())},styles:['.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-chip::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}.mat-standard-chip._mat-animation-noopable{transition:none !important;animation:none !important}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip.mat-chip-selected{outline-width:3px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden;transform:translateZ(0)}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}'],encapsulation:2,changeDetection:0});var tt=0,zt=function(){function It(be,de){this._elementRef=be,this.focused=!1,this._addOnBlur=!1,this.chipEnd=new oe.EventEmitter,this.placeholder="",this.id="mat-chip-list-input-"+tt++,this._disabled=!1,this.inputElement=this._elementRef.nativeElement,this.separatorKeyCodes=de.separatorKeyCodes}var nt=It.prototype;return nt.ngOnChanges=function(){this._chipList.stateChanges.next()},nt.ngOnDestroy=function(){this.chipEnd.complete()},nt.ngAfterContentInit=function(){this._focusLastChipOnBackspace=this.empty},nt._keydown=function(de){if(de){if(de.keyCode===F.Mf&&!(0,F.Vb)(de,"shiftKey")&&this._chipList._allowFocusEscape(),de.keyCode===F.ZH&&this._focusLastChipOnBackspace)return this._chipList._keyManager.setLastItemActive(),void de.preventDefault();this._focusLastChipOnBackspace=!1}this._emitChipEnd(de)},nt._keyup=function(de){!this._focusLastChipOnBackspace&&de.keyCode===F.ZH&&this.empty&&(this._focusLastChipOnBackspace=!0,de.preventDefault())},nt._blur=function(){this.addOnBlur&&this._emitChipEnd(),this.focused=!1,this._chipList.focused||this._chipList._blur(),this._chipList.stateChanges.next()},nt._focus=function(){this.focused=!0,this._focusLastChipOnBackspace=this.empty,this._chipList.stateChanges.next()},nt._emitChipEnd=function(de){!this.inputElement.value&&de&&this._chipList._keydown(de),(!de||this._isSeparatorKey(de))&&(this.chipEnd.emit({input:this.inputElement,value:this.inputElement.value,chipInput:this}),de?.preventDefault())},nt._onInput=function(){this._chipList.stateChanges.next()},nt.focus=function(de){this.inputElement.focus(de)},nt.clear=function(){this.inputElement.value="",this._focusLastChipOnBackspace=!0},nt._isSeparatorKey=function(de){return!(0,F.Vb)(de)&&new Set(this.separatorKeyCodes).has(de.keyCode)},(0,M.Z)(It,[{key:"chipList",set:function(de){de&&(this._chipList=de,this._chipList.registerInput(this))}},{key:"addOnBlur",get:function(){return this._addOnBlur},set:function(de){this._addOnBlur=(0,Re.Ig)(de)}},{key:"disabled",get:function(){return this._disabled||this._chipList&&this._chipList.disabled},set:function(de){this._disabled=(0,Re.Ig)(de)}},{key:"empty",get:function(){return!this.inputElement.value}}]),It}();(je=zt).\u0275fac=function(nt){return new(nt||je)(oe.\u0275\u0275directiveInject(oe.ElementRef),oe.\u0275\u0275directiveInject(Ge))},je.\u0275dir=oe.\u0275\u0275defineDirective({type:je,selectors:[["input","matChipInputFor",""]],hostAttrs:[1,"mat-chip-input","mat-input-element"],hostVars:5,hostBindings:function(nt,be){1&nt&&oe.\u0275\u0275listener("keydown",function(V){return be._keydown(V)})("keyup",function(V){return be._keyup(V)})("blur",function(){return be._blur()})("focus",function(){return be._focus()})("input",function(){return be._onInput()}),2&nt&&(oe.\u0275\u0275hostProperty("id",be.id),oe.\u0275\u0275attribute("disabled",be.disabled||null)("placeholder",be.placeholder||null)("aria-invalid",be._chipList&&be._chipList.ngControl?be._chipList.ngControl.invalid:null)("aria-required",be._chipList&&be._chipList.required||null))},inputs:{chipList:["matChipInputFor","chipList"],addOnBlur:["matChipInputAddOnBlur","addOnBlur"],separatorKeyCodes:["matChipInputSeparatorKeyCodes","separatorKeyCodes"],placeholder:"placeholder",id:"id",disabled:"disabled"},outputs:{chipEnd:"matChipInputTokenEnd"},exportAs:["matChipInput","matChipInputFor"],features:[oe.\u0275\u0275NgOnChangesFeature]});var Cn=function(){};(rt=Cn).\u0275fac=function(nt){return new(nt||rt)},rt.\u0275mod=oe.\u0275\u0275defineNgModule({type:rt}),rt.\u0275inj=oe.\u0275\u0275defineInjector({providers:[D.rD,{provide:Ge,useValue:{separatorKeyCodes:[F.K5]}}],imports:[D.BQ]})}}]);