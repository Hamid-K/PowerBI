"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["kpiStatusWithHistory"],{3352:function(De,nt,g){g.r(nt),g.d(nt,{KPIStatusWithHistory:function(){return b}});var F=g(81337),$=g(14599),i=g(47895),p=g(90120),q=g(21181),it=g(56707),W=g(18664),U=g(32105),lt=g(33024),k=g(18765),V=g(92374),H=g(44027),M=g(97878),R=g(20486),bt=g(45296),G=g(44783),c=g(79154),w=g(62458),tt=g(38265),B=g(32041),l=g(56578),L=g(64329),st=g(58098),Y=g(38958),s=g(82755),et=g(72489),ct="powervisuals-glyph",at="foregroundNeutralDark",dt="foregroundNeutralSecondary",_t=(0,c.CH)("kpiVisual"),xt=(0,c.CH)("kpiGraphicsContext"),b=function(){function e(t){t&&(this.interactivityEnabled=t.interactivityEnabled)}return e.prototype.init=function(t){this.host=t.host,this.style=t.style,e.getLocalizedString=t.host.getLocalizedString.bind(t.host),this.rootElement=d3.select(t.element.get(0)).append("div").classed(_t.class,!0),this.svg=this.rootElement.append("svg").classed(xt.class,!0),this.interactivityEnabled&&this.svg.attr("tabindex",0).attr("focusable",!0);var r=this.svg.append("g");this.areaFill=r.append("path"),this.lastTrendAxisPointSummaryContainer=this.rootElement.append("div").classed("lastTrendAxisPointSummaryContainer",!0),this.indicatorContainer=this.lastTrendAxisPointSummaryContainer.append("div").classed("indicatorContainer",!0),this.indicatorText=this.indicatorContainer.append("div").classed("indicatorText",!0),this.indicatorIcon=this.indicatorContainer.append("div").classed("powervisuals-glyph",!0),this.goalText=this.lastTrendAxisPointSummaryContainer.append("div").classed("goalText",!0).style("color",p.v.getThemeColor(this.style,G.fA)),this.distanceText=this.lastTrendAxisPointSummaryContainer.append("div").classed("distanceText",!0),this.lastDateText=this.lastTrendAxisPointSummaryContainer.append("div").classed("lastDateText",!0),e.initDefaultLabelSettings(this.style)},e.prototype.update=function(t){if(t.dataViews&&t.dataViews[0]){var r=this.dataView=t.dataViews[0],o=t.viewport;if((!r.categorical||!r.categorical.values||r.categorical.values.length<1)&&(!r.categorical||!r.categorical.categories||r.categorical.categories.length<1))return this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr("visibility","visible");var a=e.converter(r,o,e.getPropKPIDirection(r),this.style,this.host);if(this.hasGoal=!_.isEmpty(a.goals),this.interactivityEnabled){var n=""===a.formattedGoalString?"":" ".concat(a.formattedGoalString,"."),d="".concat(e.getLocalizedString("KpiValueFieldListDisplayName")," ").concat(a.formattedValue,".").concat(n);this.svg.attr("aria-label",d)}this.render(a,o)}},e.calculateHeight=function(t,r,o,a,n,d,u,m,h,S,f){var P=L.FP.fromPoint(t.indicatorFont.size.pt),v=B.b.measureSvgTextHeight({fontFamily:d,fontSize:P},r);if(t.indicatorIconShowIcon&&f){var I=L.FP.fromPoint(t.indicatorIconSize),y=B.b.measureSvgGlyphHeight(I,ct,f);v=Math.max(v,y)}var C=0,A=L.FP.fromPoint(t.distanceFont.size.pt);t.showDistanceFromGoal&&(C=B.b.measureSvgTextHeight({fontFamily:m,fontSize:A},a));var D=0,z=L.FP.fromPoint(t.goalFont.size.pt);if(t.showGoal&&(D=B.b.measureSvgTextHeight({fontFamily:u,fontSize:z},o)),S){var T=L.FP.fromPoint(t.lastDateFont.size.pt);v+=B.b.measureSvgTextHeight({fontFamily:h,fontSize:T},t.lastDateValue)}return t.showGoal&&t.showDistanceFromGoal?B.b.measureSvgTextWidth({fontFamily:u,fontSize:z},o)+B.b.measureSvgTextWidth({fontFamily:m,fontSize:A},a)>n?v=v+C+D:v+=D>C?D:C:(t.showGoal&&(v+=D),t.showDistanceFromGoal&&(v+=C)),v},e.prototype.render=function(t,r){if(this.setShowDataMissingWarning(!(t.indicatorExists&&t.trendExists)),0===t.dataPoints.length||!t.indicatorExists||!t.trendExists)return this.areaFill.attr("visibility","hidden"),this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr("height",r.height).attr("width",r.width);var o=e.status.NOGOAL,a=null;t.targetExists&&t.indicatorExists&&t.trendExists&&(o=function(e,t,r){if(!t||0===t.length)return b.status.NOGOAL;var o,a;if(2===t.length){if(o=Math.max.apply(Math,t),e>=(a=Math.min.apply(Math,t))&&e<=o)return b.status.IN_BETWEEN}else o=t[0],a=t[0];switch(r){case H.i1:if(e<a)return b.status.DROP;break;case H.pd:if(e>o)return b.status.DROP}return b.status.INCREASE}(t.actual,t.goals,t.directionType));for(var h,n=t.formattedValue,d=t.showLastDate,u=t.showGoal?t.formattedGoalString+" ":"",m=t.showDistanceFromGoal?t.formattedDistanceString:"",S=0,f=e.indicatorIconContent;S<f.length;S++)if(o===(P=f[S]).status){h=P.hexCode,a=P.textId;break}var C,v=e.calculateHeight(t,n,u,m,r.width,t.indicatorFont.family,t.goalFont.family,t.distanceFont.family,t.lastDateFont.family,d,h),I="",y="";if(t.horizontalAlignment===V.D.center&&(I+="width: "+r.width+"px; text-align: center;",y+="justify-content: center"),t.horizontalAlignment===V.D.left&&(I+="left: 8px; text-align: left;",y+="justify-content: flex-start"),t.horizontalAlignment===V.D.right&&(I+="right: 5px; text-align: right;",y+="justify-content: flex-end"),t.verticalAlignment===k.Q4.middle&&(I+="top:"+(r.height-v)/2+"px"),t.verticalAlignment===k.Q4.top&&(I+="top: 5px;"),t.verticalAlignment===k.Q4.bottom&&(I+="bottom: 5px;"),this.lastTrendAxisPointSummaryContainer.attr("style",I),this.indicatorContainer.attr("style",y),C=o===e.status.NOGOAL?t.indicatorFont.color:function(e,t){switch(e){case b.status.NOGOAL:return w.fF.assertFail("should not call this function without a goal (for `callout` textClass color theme reasons)"),t.textGrey;case b.status.INCREASE:return t.good;case b.status.IN_BETWEEN:return t.neutral;case b.status.DROP:return t.bad}}(o,t.colors),this.indicatorText.styles((0,W.wB)(t.indicatorFont)).text(n),this.indicatorText.style("color",C),t.indicatorIconShowIcon&&!this.indicatorIcon?this.indicatorIcon=this.indicatorContainer.append("div").classed(ct,!0):!t.indicatorIconShowIcon&&this.indicatorIcon&&(this.indicatorIcon.remove(),this.indicatorIcon=null),this.indicatorIcon){for(var A=0,D=e.indicatorIconContent;A<D.length;A++){var P;this.indicatorIcon.classed((P=D[A]).class,o===P.status)}this.indicatorIcon.styles((0,W.wB)({size:U.B.createFromPt(t.indicatorIconSize)})),this.indicatorIcon.style("color",C),o!==e.status.NOGOAL&&this.indicatorIcon.attr("role","img").attr("aria-label",e.getLocalizedString(a))}this.goalText.styles((0,W.wB)(t.goalFont)).text(u),this.distanceText.styles((0,W.wB)(t.distanceFont)).text(" "+m);var z="";if(t.showLastDate&&(z=t.lastDateValue),this.lastDateText.styles((0,W.wB)(t.lastDateFont)).text(z),t.showTrendLine&&t.historyExists){var E=d3.area().x(function(N){return N.x}).y0(r.height).y1(function(N){return N.y}),T=function(e,t){switch(e){case b.status.NOGOAL:return t.graphGrey;case b.status.INCREASE:return t.good;case b.status.IN_BETWEEN:return t.neutral;case b.status.DROP:return t.bad}}(o,t.colors);this.areaFill.attr("d",E(t.dataPoints)).attr("stroke","none").attr("visibility","visible").attr("fill-opacity",t.indicatorTransparency/100).style("color",T).style("fill",T)}else this.areaFill.attr("visibility","hidden")},e.prototype.setShowDataMissingWarning=function(t){this.host.setWarnings(t?[new bt.EY]:[])},e.getDefaultFormatSettings=function(t){var r=(0,q.bT)({show:!0,fontSize:45,labelColor:p.v.getThemeColor(t,at),fontFamily:tt.Wn.lightSecondary.family,style:t,textClassName:"callout",bold:"normal",italic:"normal",underline:"none"}),o=(0,q.bT)({show:!0,fontSize:8,labelColor:p.v.getThemeColor(t,"foreground"),fontFamily:tt.Wn.semibold.family,style:t,textClassName:"largeLabel"}),a=(0,q.bT)({show:!0,fontSize:9,labelColor:p.v.getThemeColor(t,"foreground"),fontFamily:tt.Wn.regular.family,style:t,textClassName:"smallLabel"}),n={family:o.fontProperties.family,size:o.fontProperties.size,color:o.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu},d={family:o.fontProperties.family,size:o.fontProperties.size,color:o.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu},u={family:a.fontProperties.family,size:a.fontProperties.size,color:a.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu};return{labelSettings:r,indicatorIconSize:U.B.createFromPx(12).pt,indicatorIconShowIcon:!0,indicatorTransparency:20,goalFont:n,distanceLabel:R.aQ,distancePrecision:2,distanceFont:d,lastDateFont:u,wordWrap:!1,horizontalAlignment:"center",verticalAlignment:"middle",bold:!1,italic:!1,underline:!1}},e.getFormatString=function(t){return w.fF.assertAnyValue(t,"column"),(0,et.EO)(t,$.e0.formatString)},e.getPropShowKPIGoal=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPIGoal,!0)},e.getPropShowKPITrendLine=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPITrendLine,!0)},e.getPropShowKPILastDate=function(t){return!(!t||!t.metadata)&&(0,s.NA)(t.metadata.objects,i.xg.showKPILastDate,!1)},e.getPropShowKPIDistance=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPIDistance,!0)},e.getPropKPIDirection=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.directionTypeStringProp,H.i1):H.i1},e.getPropGoodColor=function(t,r){var o=p.v.getSentimentColor(r,"good",G.fA);return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.goodColorProp,o):o},e.getPropNeutralColor=function(t,r){var o=p.v.getSentimentColor(r,"neutral",G.fA);return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.neutralColorProp,o):o},e.getPropBadColor=function(t,r){var o=p.v.getSentimentColor(r,"bad",G.fA);return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.badColorProp,o):o},e.getPropIndicatorDisplayUnits=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorDisplayUnitsProp,e.defaultLabelSettings.displayUnits):e.defaultLabelSettings.displayUnits},e.getPropIndicatorHorizontalAlignment=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorHorizontalAlignmentProp,e.defaultCardFormatSetting.horizontalAlignment):e.defaultCardFormatSetting.horizontalAlignment},e.getPropIndicatorVerticalAlignment=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorVerticalAlignmentProp,e.defaultCardFormatSetting.verticalAlignment):e.defaultCardFormatSetting.verticalAlignment},e.getPropIndicatorPrecision=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorPrecisionProp,e.defaultLabelSettings.precision):e.defaultLabelSettings.precision},e.getPropIndicatorFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorFontSizeProp,e.defaultCardFormatSetting.labelSettings.fontProperties.size.pt):e.defaultCardFormatSetting.labelSettings.fontProperties.size.pt},e.getPropIndicatorFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorFontFamilyProp,e.defaultCardFormatSetting.labelSettings.fontProperties.family):e.defaultCardFormatSetting.labelSettings.fontProperties.family},e.getPropIndicatorFontColor=function(t,r){var o=e.defaultCardFormatSetting.labelSettings.fontProperties.color;return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.indicatorFontColorProp,o):o},e.getPropIndicatorIconSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorIconSizeProp,e.defaultCardFormatSetting.indicatorIconSize):e.defaultCardFormatSetting.indicatorIconSize},e.getPropIndicatorShowIcon=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorIconShowIconProp,!0):e.defaultCardFormatSetting.indicatorIconShowIcon},e.getPropIndicatorTransparency=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorTransparencyProp,e.defaultCardFormatSetting.indicatorTransparency):e.defaultCardFormatSetting.indicatorTransparency},e.getPropIndicatorBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropIndicatorItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropIndicatorUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropGoalFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalFontSizeProp,e.defaultCardFormatSetting.goalFont.size.pt):e.defaultCardFormatSetting.goalFont.size.pt},e.getPropGoalBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropGoalItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropGoalUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropGoalFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalFontFamilyProp,e.defaultCardFormatSetting.goalFont.family):e.defaultCardFormatSetting.goalFont.family},e.getPropGoalFontColor=function(t,r){var o=e.defaultCardFormatSetting.goalFont.color;return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.goalFontColorProp,o):o},e.getPropGoalText=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalTextProp,e.getLocalizedString("Visual_KPI_Goal_Title")):e.getLocalizedString("Visual_KPI_Goal_Title")},e.getPropDistanceLabel=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceLabelProp,e.defaultCardFormatSetting.distanceLabel):e.defaultCardFormatSetting.distanceLabel},e.getPropDistancePrecision=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distancePrecisionProp,e.defaultCardFormatSetting.distancePrecision):e.defaultCardFormatSetting.distancePrecision},e.getPropDistanceFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceFontSizeProp,this.getPropGoalFontSize(t)):e.defaultCardFormatSetting.distanceFont.size.pt},e.getPropDistanceBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropDistanceItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropDistanceUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropDistanceFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceFontFamilyProp,this.getPropGoalFontFamily(t)):e.defaultCardFormatSetting.distanceFont.family},e.getPropDistanceFontColor=function(t,r){var o=this.getPropGoalFontColor(t,r);return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.distanceFontColorProp,o):o},e.getPropDistanceDirection=function(t){var r;return t&&t.metadata?(r=this.getPropKPIDirection(t)===H.i1?M.i1:M.pd,(0,s.NA)(t.metadata.objects,i.xg.distanceDirectionTypeStringProp,r)):M.i1},e.getPropLastDateFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateFontSizeProp,e.defaultCardFormatSetting.lastDateFont.size.pt):e.defaultCardFormatSetting.lastDateFont.size.pt},e.getProplastDateBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getProplastDateItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getProplastDateUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropLastDateFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateFontFamilyProp,e.defaultCardFormatSetting.lastDateFont.family):e.defaultCardFormatSetting.lastDateFont.family},e.getPropLastDateFontColor=function(t,r){var o=e.defaultCardFormatSetting.lastDateFont.color;return t&&t.metadata?p.v.create(r).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.lastDateFontColorProp,o):o},e.initDefaultLabelSettings=function(t){e.defaultCardFormatSetting=e.getDefaultFormatSettings(t),e.defaultLabelSettings=e.defaultCardFormatSetting.labelSettings},e.getFormattedValue=function(t,r,o,a,n){var d;void 0===n&&(n=st.V.WholeUnits),w.fF.assertValue(r,"theValue");var u=0===a;return(0,et.Ue)({format:null!==(d=r.formatString)&&void 0!==d?d:e.getFormatString(t),value:a,precision:o,displayUnitSystemType:n,formatSingleValues:!!u,allowFormatBeautification:!0,columnType:t?t.type:void 0}).format(r.value)},e.getFormattedLastDate=function(t,r){return(0,et.Ue)({format:e.getFormatString(t),allowFormatBeautification:!0,columnType:t?t.type:void 0}).format(r)},e.getFormattedGoalString=function(t,r,o,a,n){if(!r||0===r.length)return"";var d=e.getPropGoalText(n)+": "+e.getFormattedValue(t,r[0],o,a);return 2===r.length&&(d+=", "+e.getFormattedValue(t,r[1],o,a)),d},e.getFormattedDistanceString=function(t,r,o,a,n,d,u,m){if(!o||1!==o.length||0===o[0].value)return"";var h="+",S=r.value,f=o[0].value;switch(u){case M.i1:S<f&&(h="-");break;case M.pd:S>f&&(h="-")}var P=Math.abs(S-f),v=Math.abs(f),I=Number((100*P/v).toFixed(a)),y="",C=m.getLocalizedString("PercentFormat",h+I),D=e.getFormattedValue(t,{value:P,formatString:r.formatString},a,n);switch(d){case R.aQ:y="("+C+")";break;case R.S3:y="("+h+D+")";break;case R.Hk:y="("+h+D+" "+C+")";break;default:w.fF.assertFail("unknown kpiDistanceLabel type: ".concat(d))}return y},e.converter=function(t,r,o,a,n){var d,u,X,K,Z,m=[],h=t.categorical,S=null,f=null,P=null,v="",I="",y="",C="",A=!1,D=!1,z=!1,E=!0;t.categorical.categories||(E=!1);for(var T=h.values,Q=0,J=t.metadata.columns;Q<J.length;Q++){var j=J[Q];(0,Y.nu)(j,"Indicator")&&(D=!0,S=j),(0,Y.nu)(j,"TrendLine")&&(z=!0,P=j),(0,Y.nu)(j,"Goal")&&(A=!0,f=j)}if(e.initDefaultLabelSettings(a),!(D&&z&&T&&0!==T.length&&T[0].values&&t.categorical.values))return{dataPoints:m,directionType:o,actual:0,indicatorFont:e.defaultCardFormatSetting.labelSettings.fontProperties,indicatorIconSize:e.defaultCardFormatSetting.indicatorIconSize,indicatorIconShowIcon:e.defaultCardFormatSetting.indicatorIconShowIcon,indicatorTransparency:e.defaultCardFormatSetting.indicatorTransparency,goalFont:e.defaultCardFormatSetting.goalFont,distanceLabel:e.defaultCardFormatSetting.distanceLabel,distancePrecision:e.defaultCardFormatSetting.distancePrecision,distanceFont:e.defaultCardFormatSetting.distanceFont,distanceDirection:e.defaultCardFormatSetting.distanceDirection,lastDateFont:e.defaultCardFormatSetting.lastDateFont,goals:[],formattedGoalString:v,formattedDistanceString:I,targetExists:A,historyExists:E,indicatorExists:D,trendExists:z,formattedValue:y,lastDateValue:C,showGoal:!1,showDistanceFromGoal:!1,showTrendLine:!1,showLastDate:!1,colors:{good:p.v.getSentimentColor(a,"good",G.fA),neutral:p.v.getSentimentColor(a,"neutral",G.fA),bad:p.v.getSentimentColor(a,"bad",G.fA),graphGrey:p.v.getThemeColor(a,dt),textGrey:p.v.getThemeColor(a,at)},horizontalAlignment:e.defaultCardFormatSetting.horizontalAlignment,verticalAlignment:e.defaultCardFormatSetting.verticalAlignment};E&&(X=h.categories[0].values);for(var pt,Pt,O=[],gt=[],mt=[],ft=e.getColumnsByRole(T,"Indicator"),Lt=e.getColumnsByRole(T,"Goal"),x=0,Gt=T[0].values.length;x<Gt;x++){pt=ft[0].values[x],Pt=(0,s.NA)(null===(d=ft[0].objects)||void 0===d?void 0:d[x],$.e0.formatString);for(var vt=[],ot=0,ht=Lt;ot<ht.length;ot++){var Ft=ht[ot];vt.push({value:Ft.values[x],formatString:(0,s.NA)(null===(u=Ft.objects)||void 0===u?void 0:u[x],$.e0.formatString)})}mt.push(vt),O.push(pt),gt.push(Pt)}var Bt=Math.max.apply(Math,O),St=Math.min.apply(Math,O),Nt=1*r.height,Ct=e.getPropIndicatorPrecision(t),rt=e.getPropIndicatorDisplayUnits(t),Ot=e.getPropIndicatorFontSize(t),Kt=e.getPropIndicatorFontFamily(t),Ut=e.getPropIndicatorFontColor(t,a),Rt=+e.getPropIndicatorIconSize(t),jt=e.getPropIndicatorShowIcon(t),Wt=e.getPropIndicatorTransparency(t),Ht=e.getPropIndicatorHorizontalAlignment(t),Mt=e.getPropIndicatorVerticalAlignment(t),Qt=e.getPropIndicatorBold(t)?c.en:c.AI,wt=e.getPropIndicatorItalic(t)?c.BF:c.AI,Yt=e.getPropIndicatorUnderline(t)?c.f0:c.zu,Jt=e.getPropGoalFontSize(t),Xt=e.getPropGoalFontFamily(t),Zt=e.getPropGoalFontColor(t,a),$t=e.getPropGoalBold(t)?c.en:c.AI,qt=e.getPropGoalItalic(t)?c.BF:c.AI,kt=e.getPropGoalUnderline(t)?c.f0:c.zu,Dt=e.getPropDistanceLabel(t),It=e.getPropDistancePrecision(t),Vt=e.getPropDistanceFontSize(t),te=e.getPropDistanceFontFamily(t),ee=e.getPropDistanceFontColor(t,a),yt=e.getPropDistanceDirection(t),ae=e.getPropDistanceBold(t)?c.en:c.AI,oe=e.getPropDistanceItalic(t)?c.BF:c.AI,re=e.getPropDistanceUnderline(t)?c.f0:c.zu,ne=e.getPropLastDateFontSize(t),ie=e.getPropLastDateFontFamily(t),le=e.getPropLastDateFontColor(t,a),se=e.getProplastDateBold(t)?c.en:c.AI,ce=e.getProplastDateItalic(t)?c.BF:c.AI,de=e.getProplastDateUnderline(t)?c.f0:c.zu;for(x=0;x<O.length;x++)m.push({x:x*r.width/(O.length-1),y:r.height-Nt*(O[x]-St)/(Bt-St),actual:{value:O[x],formatString:gt[x]},goals:mt[x]});m.length>0&&(K=m[m.length-1].actual,Z=m[m.length-1].goals),1===m.length&&(E=!1),y=K&&e.getFormattedValue(S,K,Ct,rt,st.V.DataLabels),v=e.getFormattedGoalString(f,Z,Ct,rt,t),I=e.getFormattedDistanceString(S,K,Z,It,rt,Dt,yt,n),X.length>0&&(C=e.getFormattedLastDate(P,X[X.length-1]));var ge=e.getPropShowKPIGoal(t),me=e.getPropShowKPIDistance(t),fe=e.getPropShowKPITrendLine(t),pe=e.getPropShowKPILastDate(t),Pe={good:e.getPropGoodColor(t,a),neutral:e.getPropNeutralColor(t,a),bad:e.getPropBadColor(t,a),graphGrey:p.v.getThemeColor(a,dt),textGrey:p.v.getThemeColor(a,at)},ve={size:U.B.createFromPt(+Jt),family:Xt,color:Zt,weight:$t,style:qt,textDecoration:kt},he={size:U.B.createFromPt(+Vt),family:te,color:ee,weight:ae,style:oe,textDecoration:re},Fe={size:U.B.createFromPt(+Ot),family:Kt,color:Ut,weight:Qt,style:wt,textDecoration:Yt},Se={size:U.B.createFromPt(+ne),family:ie,color:le,weight:se,style:ce,textDecoration:de};return{dataPoints:m,directionType:o,actual:K?.value,goals:_.map(Z,function(Ce){return Ce.value}),formattedGoalString:v,formattedDistanceString:I,indicatorFont:Fe,targetExists:A,historyExists:E,indicatorExists:D,trendExists:z,formattedValue:y,showGoal:ge,indicatorIconSize:Rt,indicatorIconShowIcon:jt,indicatorTransparency:Wt,goalFont:ve,showDistanceFromGoal:me,distanceLabel:Dt,distancePrecision:It,distanceFont:he,distanceDirection:yt,lastDateFont:Se,showTrendLine:fe,showLastDate:pe,lastDateValue:C,colors:Pe,horizontalAlignment:Ht,verticalAlignment:Mt}},e.getColumnsByRole=function(t,r){for(var o=[],a=0,n=t;a<n.length;a++){var d=n[a];(0,Y.nu)(d.source,r)&&o.push(d)}return o},e.prototype.enumerateGoalsProperties=function(){var t=this.dataView,r=e.getPropDistanceLabel(t);return{showGoal:e.getPropShowKPIGoal(t),goalText:e.getPropGoalText(t),goalFontColor:e.getPropGoalFontColor(t,this.style),goalFontFamily:e.getPropGoalFontFamily(t),fontSize:e.getPropGoalFontSize(t),bold:e.getPropGoalBold(t),italic:e.getPropGoalItalic(t),underline:e.getPropGoalUnderline(t),showDistance:e.getPropShowKPIDistance(t),distanceLabel:e.getPropDistanceLabel(t),distanceFontColor:e.getPropDistanceFontColor(t,this.style),distanceFontFamily:e.getPropDistanceFontFamily(t),titleBold:e.getPropDistanceBold(t),titleItalic:e.getPropDistanceItalic(t),titleUnderline:e.getPropDistanceUnderline(t),titleFontSize:e.getPropDistanceFontSize(t),direction:e.getPropDistanceDirection(t),labelPrecision:r!==R.aQ?e.getPropDistancePrecision(t):void 0}},e.prototype.enumerateIndicatorProperties=function(){var t={indicatorDisplayUnits:e.getPropIndicatorDisplayUnits(this.dataView),indicatorPrecision:e.getPropIndicatorPrecision(this.dataView),fontSize:e.getPropIndicatorFontSize(this.dataView),bold:e.getPropIndicatorBold(this.dataView),italic:e.getPropIndicatorItalic(this.dataView),underline:e.getPropIndicatorUnderline(this.dataView),fontColor:e.getPropIndicatorFontColor(this.dataView,this.style),fontFamily:e.getPropIndicatorFontFamily(this.dataView),horizontalAlignment:e.getPropIndicatorHorizontalAlignment(this.dataView),verticalAlignment:e.getPropIndicatorVerticalAlignment(this.dataView)};return this.hasGoal&&delete t.fontColor,t.showIcon=e.getPropIndicatorShowIcon(this.dataView),t.showIcon&&(t.iconSize=+e.getPropIndicatorIconSize(this.dataView)),t},e.prototype.getFormattingModel=function(){var t=this,r={minValue:{type:0,value:0},maxValue:{type:1,value:it.vo}},o={minValue:{type:0,value:L.Gj},maxValue:{type:1,value:L.PR},unitSymbol:lt.tQ};return new l.Nq(function(){return t.getIndicatorCard(r)},function(){return t.getIconCard(o)},function(){return t.getTrendAxisCard()},function(){return t.getTargetLabelCard(r)},function(){return t.getDateCard()}).build()},e.prototype.getIndicatorCard=function(t){var r=this,u=(0,F.__rest)(i.Te.indicator,["showIcon","iconSize"]),m=new l.CQ(new l.lg("calloutValue"),"Visual_Gauge_CalloutValue",u,function(P){return r.host.getLocalizedString(P)});m.withDescription("Role_DisplayName_KPI_IndicatorDescription");var S=(new l.UN).withFontFamily({descriptor:u.fontFamily,value:e.getPropIndicatorFontFamily(this.dataView)}).withFontSizeProperties({descriptor:u.fontSize,value:e.getPropIndicatorFontSize(this.dataView)}).withBold({descriptor:u.bold,value:e.getPropIndicatorBold(this.dataView)}).withItalic({descriptor:u.italic,value:e.getPropIndicatorItalic(this.dataView)}).withUnderline({descriptor:u.underline,value:e.getPropIndicatorUnderline(this.dataView)}).build();return m.addGroup("values",function(f){f.addCompositeSlice("font","Font",S),r.hasGoal||f.addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},u.fontColor),{instanceKind:3}),value:{value:e.getPropIndicatorFontColor(r.dataView,r.style)}}).build()),f.addSimpleSlice("horizontalAlignment",new l.Gp({descriptor:u.horizontalAlignment,value:e.getPropIndicatorHorizontalAlignment(r.dataView),mode:"horizontalAlignment"}).build()).addSimpleSlice("verticalAlignment",new l.Gp({descriptor:u.verticalAlignment,value:e.getPropIndicatorVerticalAlignment(r.dataView),mode:"verticalAlignment"}).build()).addSimpleSlice("indicatorDisplayUnits",new l.uY({descriptor:u.indicatorDisplayUnits,value:e.getPropIndicatorDisplayUnits(r.dataView)}).build()).addSimpleSlice("indicatorPrecision",new l.mu({descriptor:u.indicatorPrecision,value:e.getPropIndicatorPrecision(r.dataView),options:t}).build())}),m.build()},e.prototype.getIconCard=function(t){var r=this,a=new l.CQ(new l.lg("icons"),"Visual_Tablix_Icons",[i.Te.indicator.showIcon,i.Te.indicator.iconSize],function(d){return r.host.getLocalizedString(d)});return a.addTopLevelToggle("showIcon",function(){return new l.bd({descriptor:i.Te.indicator.showIcon,value:e.getPropIndicatorShowIcon(r.dataView)}).build()}).addGroup("icons",function(n){n.withDisplayName("Visual_Tablix_Icons"),n.addSimpleSlice("iconSize",new l.mu({descriptor:i.Te.indicator.iconSize,value:e.getPropIndicatorIconSize(r.dataView),options:t}).build())}),a.build()},e.prototype.getTrendAxisCard=function(){var t=this,r=function(u){return t.host.getLocalizedString(u)},o=(0,F.__assign)((0,F.__assign)({},i.Te.trendline),i.Te.status),a=this.dataView,n=new l.CQ(new l.lg("trendAxis"),"Role_DisplayName_KPI_TrendLine",o,r);return n.withDescription("Role_DisplayName_KPI_Trendline_Description").addTopLevelToggle("show",function(){return new l.bd({descriptor:o.show,value:e.getPropShowKPITrendLine(a)}).build()}).addGroup("trendAxis",function(d){d.addSimpleSlice("direction",new l.uY({descriptor:o.direction,value:e.getPropKPIDirection(a)}).build()).addSimpleSlice("goodColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},o.goodColor),{instanceKind:3}),value:{value:e.getPropGoodColor(a,t.style)}}).build()).addSimpleSlice("neutralColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},o.neutralColor),{instanceKind:3}),value:{value:e.getPropNeutralColor(a,t.style)}}).build()).addSimpleSlice("badColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},o.badColor),{instanceKind:3}),value:{value:e.getPropBadColor(a,t.style)}}).build()).addSimpleSlice("transparency",l.JN.getTransparencySliderBuilder({descriptor:o.transparency,value:e.getPropIndicatorTransparency(a),localize:r}).build())}),n.build()},e.prototype.getTargetLabelCard=function(t){var r=this,a=i.Te.goals,n=this.dataView,d=new l.CQ(new l.lg("targetLabel"),"Visual_Gauge_Axis_TargetLabel",a,function(P){return r.host.getLocalizedString(P)}),u=(new l.UN).withFontFamily({descriptor:a.goalFontFamily,value:e.getPropGoalFontFamily(n)}).withFontSizeProperties({descriptor:a.fontSize,value:e.getPropGoalFontSize(n)}).withBold({descriptor:a.bold,value:e.getPropGoalBold(n)}).withItalic({descriptor:a.italic,value:e.getPropGoalItalic(n)}).withUnderline({descriptor:a.underline,value:e.getPropGoalUnderline(n)}),m=(new l.UN).withFontFamily({descriptor:a.distanceFontFamily,value:e.getPropDistanceFontFamily(n)}).withFontSizeProperties({descriptor:a.titleFontSize,value:e.getPropDistanceFontSize(n)}).withBold({descriptor:a.titleBold,value:e.getPropDistanceBold(n)}).withItalic({descriptor:a.titleItalic,value:e.getPropDistanceItalic(n)}).withUnderline({descriptor:a.titleUnderline,value:e.getPropDistanceUnderline(n)}),h=u.build(),S=m.build();return d.addTopLevelToggle("showGoal",function(){return new l.bd({descriptor:a.showGoal,value:e.getPropShowKPIGoal(n)}).build()}).addGroup("values",function(f){f.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",h).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},a.goalFontColor),{instanceKind:3}),value:{value:e.getPropGoalFontColor(n,r.style)}}).build()).addSimpleSlice("goalText",new l.fq({descriptor:a.goalText,value:e.getPropGoalText(n),placeholder:""}).build())}).addGroup("distance",function(f){f.withDisplayName("Visual_KPI_DistanceToGoal").addTopLevelToggle("showDistance",function(){return new l.bd({descriptor:a.showDistance,value:e.getPropShowKPIDistance(n)}).build()});var P=e.getPropDistanceLabel(n);f.addSimpleSlice("style",new l.uY({descriptor:a.distanceLabel,value:P}).build(),function(v){return v.withCustomDisplayName("Style")}),P!==R.aQ&&f.addSimpleSlice("labelPrecision",new l.mu({descriptor:a.labelPrecision,value:e.getPropDistancePrecision(n),options:t}).build()),f.addSimpleSlice("direction",new l.uY({descriptor:a.direction,value:e.getPropDistanceDirection(n)}).build()).addCompositeSlice("font","Font",S).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},a.distanceFontColor),{instanceKind:3}),value:{value:e.getPropDistanceFontColor(n,r.style)}}).build())}),d.build()},e.prototype.getDateCard=function(){var t=this,o=i.Te.lastDate,a=this.dataView,n=new l.CQ(new l.lg("date"),"Date",o,function(h){return t.host.getLocalizedString(h)}),u=(new l.UN).withFontFamily({descriptor:o.lastDateFontFamily,value:e.getPropLastDateFontFamily(a)}).withFontSizeProperties({descriptor:o.fontSize,value:e.getPropLastDateFontSize(a)}).withBold({descriptor:o.bold,value:e.getProplastDateBold(a)}).withItalic({descriptor:o.italic,value:e.getProplastDateItalic(a)}).withUnderline({descriptor:o.underline,value:e.getProplastDateUnderline(a)}).build();return n.withDescription("Role_DisplayName_KPI_Date_Description").addTopLevelToggle("show",function(){return new l.bd({descriptor:o.show,value:e.getPropShowKPILastDate(a)}).build()}).addGroup("date",function(m){m.addCompositeSlice("font","Font",u).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.__assign)((0,F.__assign)({},o.lastDateFontColor),{instanceKind:3}),value:{value:e.getPropLastDateFontColor(a,t.style)}}).build())}),n.build()},e.prototype.enumerateObjectInstances=function(t){var r=[],o=this.dataView,a={numberRange:{min:0,max:it.vo}},n={numberRange:{min:L.Gj,max:L.PR},unitSymbol:lt.tQ};switch(t.objectName){case"indicator":r.push({selector:null,objectName:"indicator",properties:this.enumerateIndicatorProperties(),validValues:{indicatorPrecision:a,iconSize:n},propertyInstanceKind:{fontColor:3}});break;case"trendline":r.push({selector:null,objectName:"trendline",properties:{show:e.getPropShowKPITrendLine(o),transparency:e.getPropIndicatorTransparency(o)}});break;case"goals":r.push({selector:null,objectName:"goals",properties:this.enumerateGoalsProperties(),validValues:{labelPrecision:a},propertyInstanceKind:{goalFontColor:3,distanceFontColor:3}});break;case"status":r.push({selector:null,objectName:"status",properties:{direction:e.getPropKPIDirection(o),goodColor:e.getPropGoodColor(o,this.style),neutralColor:e.getPropNeutralColor(o,this.style),badColor:e.getPropBadColor(o,this.style)},propertyInstanceKind:{goodColor:3,neutralColor:3,badColor:3}});break;case"lastDate":r.push({selector:null,objectName:"lastDate",properties:{show:e.getPropShowKPILastDate(o),lastDateFontColor:e.getPropLastDateFontColor(o,this.style),lastDateFontFamily:e.getPropLastDateFontFamily(o),fontSize:e.getPropLastDateFontSize(o),bold:e.getProplastDateBold(o),italic:e.getProplastDateItalic(o),underline:e.getProplastDateUnderline(o)},propertyInstanceKind:{lastDateFontColor:3}})}return r},e.prototype.destroy=function(){this.svg=null},e.status={INCREASE:"increase",DROP:"drop",IN_BETWEEN:"in-between",NOGOAL:"no-goal"},e.statusBandingType={Below:"BELOW",Above:"ABOVE"},e.actualTextConsts={VERTICAL_OFFSET_FROM_HALF_HEIGHT:20,FONT_WIDTH_FACTOR:14,RIGHT_MARGIN:10},e.indicatorIconContent=[{class:"checkmark",textId:"Visual_KPI_TargetMet",hexCode:"\ue718",status:e.status.INCREASE},{class:"circle-small",textId:"Visual_KPI_TargetBetween",hexCode:"\ue712",status:e.status.IN_BETWEEN},{class:"exclamation",textId:"Visual_KPI_TargetNotMet",hexCode:"\ue715",status:e.status.DROP}],e}()}}]);