"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["extension-host-artifact-update"],{73582:function(et,T,a){a.r(T),a.d(T,{ExtensionHostArtifactUpdateModule:function(){return L}});var P=a(77476),u=a(60756),s=a(85732),x=a(14172),V=a(77526),W=a(6663),$=a(17653),k=a(11105),h=a(73471),R=a(60397),S=a(17899),B=a(82618),H=(0,s.PH)("[Extension Host Artifact Update] Subscribe Artifact Update",(0,s.Ky)()),O=(0,s.PH)("[Extension Host Artifact Update] Unsubscribe Artifact Update",(0,s.Ky)()),G=a(8894),F="extensionHostArtifactUpdate",l=(0,G.H)({selectId:function(d){return d.subscriptionId}}),K={artifactUpdateSubscriptions:l.getInitialState()},N=(0,s.ZF)(F),Q=(0,s.P1)(N,function(e){return l.getSelectors().selectAll(e.artifactUpdateSubscriptions)}),p=a(50423),X=function(){function e(d,i,f){var o=this;this.actions$=d,this.messageBroker=i,this.store=f,this.onSubscribeArtifactUpdateReceived$=(0,S.Av)(this.actions$,this.messageBroker,h.Vm.subscribeArtifactUpdate,function(n){var r=n.iframeId,g=n.workspaceObjectId,j=(0,k.Z)();return o.store.dispatch(H({subscriptionId:j,iframeId:r,workspaceObjectId:g})),h.Vm.subscribeArtifactUpdate.resolve({subscriptionId:j})}),this.onUnsubscribeArtifactUpdateReceived$=(0,u.GW)(function(){return o.actions$.pipe((0,S.pR)(h.Vm.unsubscribeArtifactUpdate),(0,x.U)(function(n){return O({subscriptionId:n.subscriptionId})}))}),this.pushArtifactUpdate$=(0,u.GW)(function(){return o.store.select(B.Fe).pipe((0,V.x)(),(0,W.G)(),(0,u.IC)(function(){return o.store.select(Q)}),(0,x.U)(function(n){for(var r=n[0],g=r[0],j=r[1],C=[],z=function(_,tt,b){var I=[],m=g[b],y=j[b];m&&y&&(y.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"add",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),m.forEach(function(t){var c=y.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"remove",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),y.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&t.lastUpdatedDate&&c&&c.objectId&&c.artifactType&&c.lastUpdatedDate&&c.lastUpdatedDate.getTime()!==t.lastUpdatedDate.getTime()&&I.push({changeType:"edit",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})})),I.length>0&&C.push(h.Vm.onArtifactUpdate({subscriptionId:_,changes:I})(tt))},E=0,M=n[1];E<M.length;E++){var A=M[E];z(A.subscriptionId,A.iframeId,A.workspaceObjectId)}return C}),(0,$.b)(function(n){n.forEach(function(r){o.messageBroker.send(r)})}))},{dispatch:!1})}return e.\u0275fac=function(i){return new(i||e)(p.\u0275\u0275inject(u.eX),p.\u0275\u0275inject(R.u),p.\u0275\u0275inject(s.yh))},e.\u0275prov=p.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),D=a(36012);function Z(e,d){return(0,s.Lq)(K,(0,D.P)(H,function(i,f){i.artifactUpdateSubscriptions=l.upsertOne({subscriptionId:f.subscriptionId,iframeId:f.iframeId,workspaceObjectId:f.workspaceObjectId},i.artifactUpdateSubscriptions)}),(0,D.P)(O,function(i,f){i.artifactUpdateSubscriptions=l.removeOne(f.subscriptionId,i.artifactUpdateSubscriptions)}))(e,d)}var L=function(){function e(){}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=p.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=p.\u0275\u0275defineInjector({imports:[P.CommonModule,s.Aw.forFeature(F,Z),u.sQ.forFeature([X])]}),e}()}}]);