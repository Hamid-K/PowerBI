(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["dataflow-gen2-publish-error"],{77489:function(ue){ue.exports=function(j,ce){(null==ce||ce>j.length)&&(ce=j.length);for(var Se=0,X=new Array(ce);Se<ce;Se++)X[Se]=j[Se];return X},ue.exports.default=ue.exports,ue.exports.__esModule=!0},32878:function(ue){function ze(ce,Se){for(var X=0;X<Se.length;X++){var Q=Se[X];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(ce,Q.key,Q)}}ue.exports=function(ce,Se,X){return Se&&ze(ce.prototype,Se),X&&ze(ce,X),ce},ue.exports.default=ue.exports,ue.exports.__esModule=!0},34850:function(ue,ze,j){var ce=j(91052);ue.exports=function(X,Q){var de=typeof Symbol<"u"&&X[Symbol.iterator]||X["@@iterator"];if(de)return(de=de.call(X)).next.bind(de);if(Array.isArray(X)||(de=ce(X))||Q&&X&&"number"==typeof X.length){de&&(X=de);var De=0;return function(){return De>=X.length?{done:!0}:{done:!1,value:X[De++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},ue.exports.default=ue.exports,ue.exports.__esModule=!0},12864:function(ue,ze,j){var ce=j(74);ue.exports=function(X,Q){X.prototype=Object.create(Q.prototype),X.prototype.constructor=X,ce(X,Q)},ue.exports.default=ue.exports,ue.exports.__esModule=!0},74:function(ue){function ze(j,ce){return ue.exports=ze=Object.setPrototypeOf||function(X,Q){return X.__proto__=Q,X},ue.exports.default=ue.exports,ue.exports.__esModule=!0,ze(j,ce)}ue.exports=ze,ue.exports.default=ue.exports,ue.exports.__esModule=!0},91052:function(ue,ze,j){var ce=j(77489);ue.exports=function(X,Q){if(X){if("string"==typeof X)return ce(X,Q);var de=Object.prototype.toString.call(X).slice(8,-1);if("Object"===de&&X.constructor&&(de=X.constructor.name),"Map"===de||"Set"===de)return Array.from(X);if("Arguments"===de||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(de))return ce(X,Q)}},ue.exports.default=ue.exports,ue.exports.__esModule=!0},36444:function(ue,ze,j){var ce=j(32878).default,Se=j(12864).default,X=j(34850).default;function Q(){"use strict";Q=function(){return De};var de,De={},Me=Object.prototype,$e=Me.hasOwnProperty,he=Object.defineProperty||function(G,U,B){G[U]=B.value},re="function"==typeof Symbol?Symbol:{},D=re.iterator||"@@iterator",Ee=re.asyncIterator||"@@asyncIterator",oe=re.toStringTag||"@@toStringTag";function E(G,U,B){return Object.defineProperty(G,U,{value:B,enumerable:!0,configurable:!0,writable:!0}),G[U]}try{E({},"")}catch{E=function(B,F,Z){return B[F]=Z}}function be(G,U,B,F){var J=Object.create((U&&U.prototype instanceof Pe?U:Pe).prototype),x=new ht(F||[]);return he(J,"_invoke",{value:Xt(G,B,x)}),J}function Oe(G,U,B){try{return{type:"normal",arg:G.call(U,B)}}catch(F){return{type:"throw",arg:F}}}De.wrap=be;var ee="suspendedStart",te="suspendedYield",$="executing",K="completed",se={};function Pe(){}function Te(){}function ge(){}var Fe={};E(Fe,D,function(){return this});var Ve=Object.getPrototypeOf,Je=Ve&&Ve(Ve(Yt([])));Je&&Je!==Me&&$e.call(Je,D)&&(Fe=Je);var H=ge.prototype=Pe.prototype=Object.create(Fe);function Xe(G){["next","throw","return"].forEach(function(U){E(G,U,function(B){return this._invoke(U,B)})})}function qe(G,U){function B(Z,J,x,Ae){var h=Oe(G[Z],G,J);if("throw"!==h.type){var Be=h.arg,je=Be.value;return je&&"object"==typeof je&&$e.call(je,"__await")?U.resolve(je.__await).then(function(Le){B("next",Le,x,Ae)},function(Le){B("throw",Le,x,Ae)}):U.resolve(je).then(function(Le){Be.value=Le,x(Be)},function(Le){return B("throw",Le,x,Ae)})}Ae(h.arg)}var F;he(this,"_invoke",{value:function(J,x){function Ae(){return new U(function(h,Be){B(J,x,h,Be)})}return F=F?F.then(Ae,Ae):Ae()}})}function Xt(G,U,B){var F=ee;return function(Z,J){if(F===$)throw new Error("Generator is already running");if(F===K){if("throw"===Z)throw J;return{value:de,done:!0}}for(B.method=Z,B.arg=J;;){var x=B.delegate;if(x){var Ae=Mt(x,B);if(Ae){if(Ae===se)continue;return Ae}}if("next"===B.method)B.sent=B._sent=B.arg;else if("throw"===B.method){if(F===ee)throw F=K,B.arg;B.dispatchException(B.arg)}else"return"===B.method&&B.abrupt("return",B.arg);F=$;var h=Oe(G,U,B);if("normal"===h.type){if(F=B.done?K:te,h.arg===se)continue;return{value:h.arg,done:B.done}}"throw"===h.type&&(F=K,B.method="throw",B.arg=h.arg)}}}function Mt(G,U){var B=U.method,F=G.iterator[B];if(F===de)return U.delegate=null,"throw"===B&&G.iterator.return&&(U.method="return",U.arg=de,Mt(G,U),"throw"===U.method)||"return"!==B&&(U.method="throw",U.arg=new TypeError("The iterator does not provide a '"+B+"' method")),se;var Z=Oe(F,G.iterator,U.arg);if("throw"===Z.type)return U.method="throw",U.arg=Z.arg,U.delegate=null,se;var J=Z.arg;return J?J.done?(U[G.resultName]=J.value,U.next=G.nextLoc,"return"!==U.method&&(U.method="next",U.arg=de),U.delegate=null,se):J:(U.method="throw",U.arg=new TypeError("iterator result is not an object"),U.delegate=null,se)}function Re(G){var U={tryLoc:G[0]};1 in G&&(U.catchLoc=G[1]),2 in G&&(U.finallyLoc=G[2],U.afterLoc=G[3]),this.tryEntries.push(U)}function pt(G){var U=G.completion||{};U.type="normal",delete U.arg,G.completion=U}function ht(G){this.tryEntries=[{tryLoc:"root"}],G.forEach(Re,this),this.reset(!0)}function Yt(G){if(G||""===G){var U=G[D];if(U)return U.call(G);if("function"==typeof G.next)return G;if(!isNaN(G.length)){var B=-1,F=function Z(){for(;++B<G.length;)if($e.call(G,B))return Z.value=G[B],Z.done=!1,Z;return Z.value=de,Z.done=!0,Z};return F.next=F}}throw new TypeError(typeof G+" is not iterable")}return Te.prototype=ge,he(H,"constructor",{value:ge,configurable:!0}),he(ge,"constructor",{value:Te,configurable:!0}),Te.displayName=E(ge,oe,"GeneratorFunction"),De.isGeneratorFunction=function(G){var U="function"==typeof G&&G.constructor;return!!U&&(U===Te||"GeneratorFunction"===(U.displayName||U.name))},De.mark=function(G){return Object.setPrototypeOf?Object.setPrototypeOf(G,ge):(G.__proto__=ge,E(G,oe,"GeneratorFunction")),G.prototype=Object.create(H),G},De.awrap=function(G){return{__await:G}},Xe(qe.prototype),E(qe.prototype,Ee,function(){return this}),De.AsyncIterator=qe,De.async=function(G,U,B,F,Z){void 0===Z&&(Z=Promise);var J=new qe(be(G,U,B,F),Z);return De.isGeneratorFunction(U)?J:J.next().then(function(x){return x.done?x.value:J.next()})},Xe(H),E(H,oe,"Generator"),E(H,D,function(){return this}),E(H,"toString",function(){return"[object Generator]"}),De.keys=function(G){var U=Object(G),B=[];for(var F in U)B.push(F);return B.reverse(),function Z(){for(;B.length;){var J=B.pop();if(J in U)return Z.value=J,Z.done=!1,Z}return Z.done=!0,Z}},De.values=Yt,ht.prototype={constructor:ht,reset:function(U){if(this.prev=0,this.next=0,this.sent=this._sent=de,this.done=!1,this.delegate=null,this.method="next",this.arg=de,this.tryEntries.forEach(pt),!U)for(var B in this)"t"===B.charAt(0)&&$e.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=de)},stop:function(){this.done=!0;var U=this.tryEntries[0].completion;if("throw"===U.type)throw U.arg;return this.rval},dispatchException:function(U){if(this.done)throw U;var B=this;function F(Be,je){return x.type="throw",x.arg=U,B.next=Be,je&&(B.method="next",B.arg=de),!!je}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var J=this.tryEntries[Z],x=J.completion;if("root"===J.tryLoc)return F("end");if(J.tryLoc<=this.prev){var Ae=$e.call(J,"catchLoc"),h=$e.call(J,"finallyLoc");if(Ae&&h){if(this.prev<J.catchLoc)return F(J.catchLoc,!0);if(this.prev<J.finallyLoc)return F(J.finallyLoc)}else if(Ae){if(this.prev<J.catchLoc)return F(J.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<J.finallyLoc)return F(J.finallyLoc)}}}},abrupt:function(U,B){for(var F=this.tryEntries.length-1;F>=0;--F){var Z=this.tryEntries[F];if(Z.tryLoc<=this.prev&&$e.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var J=Z;break}}J&&("break"===U||"continue"===U)&&J.tryLoc<=B&&B<=J.finallyLoc&&(J=null);var x=J?J.completion:{};return x.type=U,x.arg=B,J?(this.method="next",this.next=J.finallyLoc,se):this.complete(x)},complete:function(U,B){if("throw"===U.type)throw U.arg;return"break"===U.type||"continue"===U.type?this.next=U.arg:"return"===U.type?(this.rval=this.arg=U.arg,this.method="return",this.next="end"):"normal"===U.type&&B&&(this.next=B),se},finish:function(U){for(var B=this.tryEntries.length-1;B>=0;--B){var F=this.tryEntries[B];if(F.finallyLoc===U)return this.complete(F.completion,F.afterLoc),pt(F),se}},catch:function(U){for(var B=this.tryEntries.length-1;B>=0;--B){var F=this.tryEntries[B];if(F.tryLoc===U){var Z=F.completion;if("throw"===Z.type){var J=Z.arg;pt(F)}return J}}throw new Error("illegal catch attempt")},delegateYield:function(U,B,F){return this.delegate={iterator:Yt(U),resultName:B,nextLoc:F},"next"===this.method&&(this.arg=de),se}},De}typeof self<"u"&&self,ue.exports=function(){var he,re,de={302:function(re,D,Ee){var E;D.formatArgs=function(E){if(E[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+E[0]+(this.useColors?"%c ":" ")+"+"+re.exports.humanize(this.diff),this.useColors){var be="color: "+this.color;E.splice(1,0,be,"color: inherit");var Oe=0,ee=0;E[0].replace(/%[a-zA-Z%]/g,function(te){"%%"!==te&&(Oe++,"%c"===te&&(ee=Oe))}),E.splice(ee,0,be)}},D.save=function(E){try{E?D.storage.setItem("debug",E):D.storage.removeItem("debug")}catch{}},D.load=function(){var E;try{E=D.storage.getItem("debug")}catch{}return!E&&typeof process<"u"&&"env"in process&&(E=process.env.DEBUG),E},D.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},D.storage=function(){try{return localStorage}catch{}}(),D.destroy=(E=!1,function(){E||(E=!0)}),D.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],D.log=console.debug||console.log||function(){},re.exports=Ee(65)(D),re.exports.formatters.j=function(E){try{return JSON.stringify(E)}catch(be){return"[UnexpectedJSONParseError]: "+be.message}}},65:function(re,D,Ee){re.exports=function(oe){function E(ee){var te,$,K,se=null;function Pe(){for(var Te=arguments.length,ge=new Array(Te),Fe=0;Fe<Te;Fe++)ge[Fe]=arguments[Fe];if(Pe.enabled){var Ve=Pe,Je=Number(new Date);Ve.diff=Je-(te||Je),Ve.prev=te,Ve.curr=Je,te=Je,ge[0]=E.coerce(ge[0]),"string"!=typeof ge[0]&&ge.unshift("%O");var Xe=0;ge[0]=ge[0].replace(/%([a-zA-Z%])/g,function(qe,Xt){if("%%"===qe)return"%";Xe++;var Mt=E.formatters[Xt];return"function"==typeof Mt&&(qe=Mt.call(Ve,ge[Xe]),ge.splice(Xe,1),Xe--),qe}),E.formatArgs.call(Ve,ge),(Ve.log||E.log).apply(Ve,ge)}}return Pe.namespace=ee,Pe.useColors=E.useColors(),Pe.color=E.selectColor(ee),Pe.extend=be,Pe.destroy=E.destroy,Object.defineProperty(Pe,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==se?se:($!==E.namespaces&&($=E.namespaces,K=E.enabled(ee)),K)},set:function(ge){se=ge}}),"function"==typeof E.init&&E.init(Pe),Pe}function be(ee,te){var $=E(this.namespace+(void 0===te?":":te)+ee);return $.log=this.log,$}function Oe(ee){return ee.toString().substring(2,ee.toString().length-2).replace(/\.\*\?$/,"*")}return E.debug=E,E.default=E,E.coerce=function(ee){return ee instanceof Error?ee.stack||ee.message:ee},E.disable=function(){var ee=[].concat(E.names.map(Oe),E.skips.map(Oe).map(function(te){return"-"+te})).join(",");return E.enable(""),ee},E.enable=function(ee){var te;E.save(ee),E.namespaces=ee,E.names=[],E.skips=[];var $=("string"==typeof ee?ee:"").split(/[\s,]+/),K=$.length;for(te=0;te<K;te++)$[te]&&("-"===(ee=$[te].replace(/\*/g,".*?"))[0]?E.skips.push(new RegExp("^"+ee.slice(1)+"$")):E.names.push(new RegExp("^"+ee+"$")))},E.enabled=function(ee){if("*"===ee[ee.length-1])return!0;var te,$;for(te=0,$=E.skips.length;te<$;te++)if(E.skips[te].test(ee))return!1;for(te=0,$=E.names.length;te<$;te++)if(E.names[te].test(ee))return!0;return!1},E.humanize=Ee(247),E.destroy=function(){},Object.keys(oe).forEach(function(ee){E[ee]=oe[ee]}),E.names=[],E.skips=[],E.formatters={},E.selectColor=function(ee){for(var te=0,$=0;$<ee.length;$++)te=(te<<5)-te+ee.charCodeAt($),te|=0;return E.colors[Math.abs(te)%E.colors.length]},E.enable(E.load()),E}},247:function(re){var D=1e3,Ee=60*D,oe=60*Ee,E=24*oe;function te($,K,se,Pe){var Te=K>=1.5*se;return Math.round($/se)+" "+Pe+(Te?"s":"")}re.exports=function($,K){K=K||{};var se=typeof $;if("string"===se&&$.length>0)return function($){if(!(($=String($)).length>100)){var K=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(K){var se=parseFloat(K[1]);switch((K[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*se;case"weeks":case"week":case"w":return 6048e5*se;case"days":case"day":case"d":return se*E;case"hours":case"hour":case"hrs":case"hr":case"h":return se*oe;case"minutes":case"minute":case"mins":case"min":case"m":return se*Ee;case"seconds":case"second":case"secs":case"sec":case"s":return se*D;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return se;default:return}}}}($);if("number"===se&&isFinite($))return K.long?function($){var K=Math.abs($);return K>=E?te($,K,E,"day"):K>=oe?te($,K,oe,"hour"):K>=Ee?te($,K,Ee,"minute"):K>=D?te($,K,D,"second"):$+" ms"}($):function($){var K=Math.abs($);return K>=E?Math.round($/E)+"d":K>=oe?Math.round($/oe)+"h":K>=Ee?Math.round($/Ee)+"m":K>=D?Math.round($/D)+"s":$+"ms"}($);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify($))}}},De={};function Me(he){var re=De[he];if(void 0!==re)return re.exports;var D=De[he]={exports:{}};return de[he](D,D.exports,Me),D.exports}re=Object.getPrototypeOf?function(D){return Object.getPrototypeOf(D)}:function(D){return D.__proto__},Me.t=function(D,Ee){if(1&Ee&&(D=this(D)),8&Ee||"object"==typeof D&&D&&(4&Ee&&D.__esModule||16&Ee&&"function"==typeof D.then))return D;var oe=Object.create(null);Me.r(oe);var E={};he=he||[null,re({}),re([]),re(re)];for(var be=2&Ee&&D;"object"==typeof be&&!~he.indexOf(be);be=re(be))Object.getOwnPropertyNames(be).forEach(function(Oe){return E[Oe]=function(){return D[Oe]}});return E.default=function(){return D},Me.d(oe,E),oe},Me.d=function(he,re){for(var D in re)Me.o(re,D)&&!Me.o(he,D)&&Object.defineProperty(he,D,{enumerable:!0,get:re[D]})},Me.o=function(he,re){return Object.prototype.hasOwnProperty.call(he,re)},Me.r=function(he){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(he,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(he,"__esModule",{value:!0})};var $e={};return function(){"use strict";Me.r($e),Me.d($e,{ActionObjectType:function(){return U},ChannelType:function(){return _n},ChildAppWindow:function(){return ki},DialogDimension:function(){return Le},ErrorCode:function(){return F},FileOpenPreference:function(){return G},FrameContexts:function(){return h},HostClientType:function(){return x},HostName:function(){return Ae},LiveShareHost:function(){return wa},NotificationTypes:function(){return sr},ParentAppWindow:function(){return la},SecondaryM365ContentIdName:function(){return B},TaskModuleDimension:function(){return Ot},TeamType:function(){return Be},UserSettingTypes:function(){return lr},UserTeamRole:function(){return je},ViewerActionTypes:function(){return ur},app:function(){return st},appEntity:function(){return Jt},appInitialization:function(){return Dr},appInstallDialog:function(){return fr},authentication:function(){return Dn},barCode:function(){return xn},calendar:function(){return Un},call:function(){return Ir},chat:function(){return an},clipboard:function(){return pr},conversations:function(){return cr},dialog:function(){return lt},enablePrintCapability:function(){return ji},executeDeepLink:function(){return Ne},externalAppAuthentication:function(){return Or},externalAppCardActions:function(){return hn},files:function(){return gn},geoLocation:function(){return un},getAdaptiveCardSchemaVersion:function(){return ua},getContext:function(){return qi},getMruTabInstances:function(){return Ki},getTabInstances:function(){return Yi},initialize:function(){return zi},initializeWithFrameContext:function(){return eo},liveShare:function(){return Gn},location:function(){return Qt},logs:function(){return ar},mail:function(){return gr},marketplace:function(){return pn},media:function(){return ft},meeting:function(){return Nn},meetingRoom:function(){return vn},menus:function(){return en},monetization:function(){return hr},navigateBack:function(){return $t},navigateCrossDomain:function(){return ro},navigateToTab:function(){return no},notifications:function(){return mn},openFilePreview:function(){return Pi},pages:function(){return We},people:function(){return vr},print:function(){return Qi},profile:function(){return mr},registerAppButtonClickHandler:function(){return va},registerAppButtonHoverEnterHandler:function(){return cn},registerAppButtonHoverLeaveHandler:function(){return _i},registerBackButtonHandler:function(){return $i},registerBeforeUnloadHandler:function(){return Zi},registerChangeSettingsHandler:function(){return Rr},registerCustomHandler:function(){return Yo},registerFocusEnterHandler:function(){return Xi},registerFullScreenHandler:function(){return Wn},registerOnLoadHandler:function(){return Ji},registerOnThemeChangeHandler:function(){return ga},registerUserSettingsChangeHandler:function(){return Si},remoteCamera:function(){return jn},returnFocus:function(){return to},search:function(){return Vn},secondaryBrowser:function(){return ln},sendCustomEvent:function(){return Xo},sendCustomMessage:function(){return Zo},setFrameContext:function(){return Tr},settings:function(){return Tt},shareDeepLink:function(){return wt},sharing:function(){return br},stageView:function(){return Sr},tasks:function(){return Fr},teams:function(){return wn},teamsCore:function(){return Bt},thirdPartyCloudStorage:function(){return Bn},uploadCustomApp:function(){return bi},version:function(){return Pn},videoEffects:function(){return Rt},videoEffectsEx:function(){return Qn},visualMedia:function(){return Er},webStorage:function(){return Ar}});var oe,E,t,he=(0,Me(302).debug)("teamsJs");function re(t){return he.extend(t)}function D(t,a){return t+"_"+a}function Ee(t){return/^v\d+_[\w.]+$/.test(t)}(t=oe||(oe={})).V_0="v0",t.V_1="v1",t.V_2="v2",t.V_3="v3",function(t){t.App_GetContext="app.getContext",t.App_Initialize="app.initialize",t.App_NotifyAppLoaded="app.notifyAppLoaded",t.App_NotifyExpectedFailure="app.notifyExpectedFailure",t.App_NotifyFailure="app.notifyFailure",t.App_NotifySuccess="app.notifySuccess",t.App_OpenLink="app.openLink",t.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",t.AppEntity_SelectAppEntity="appEntity.selectAppEntity",t.BarCode_HasPermission="barCode.hasPermission",t.BarCode_RequestPermission="barCode.requestPermission",t.BarCode_ScanBarCode="barCode.scanBarCode",t.Calendar_ComposeMeeting="calendar.composeMeeting",t.Calendar_OpenCalendarItem="calendar.openCalendarItem",t.Call_StartCall="call.startCall",t.Clipboard_Read="clipboard.read",t.Clipboard_Write="clipboard.write",t.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",t.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",t.Dialog_Update_Resize="dialog.update.resize",t.Dialog_Url_Bot_Open="dialog.url.bot.open",t.Dialog_Url_Open="dialog.url.open",t.Dialog_Url_Submit="dialog.url.submit",t.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",t.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",t.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",t.GeoLocation_HasPermission="geoLocation.hasPermission",t.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",t.GeoLocation_RequestPermission="geoLocation.hasPermission",t.GeoLocation_ShowLocation="geoLocation.showLocation",t.Location_GetLocation="location.getLocation",t.Location_ShowLocation="location.showLocation",t.Mail_ComposeMail="mail.composeMail",t.Mail_OpenMailItem="mail.openMailItem",t.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",t.Marketplace_GetCart="marketplace.getCart",t.Marketplace_RemoveCardItems="marketplace.removeCartItems",t.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",t.Media_CaptureImage="media.captureImage",t.Media_Controller="media.controller",t.Media_GetMedia="media.getMedia",t.Media_HasPermission="media.hasPermission",t.Media_RequestPermission="media.requestPermission",t.Media_ScanBarCode="media.scanBarCode",t.Media_SelectMedia="media.selectMedia",t.Media_ViewImages="media.viewImages",t.Navigation_NavigateBack="navigation.navigateBack",t.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",t.Navigation_NavigateToTab="navigation.navigateToTab",t.Navigation_ReturnFocus="navigation.returnFocus",t.Pages_AppButton_OnClick="pages.appButton.onClick",t.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",t.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",t.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",t.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",t.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",t.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",t.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",t.Pages_Config_SetConfig="pages.config.setConfig",t.Pages_Config_SetValidityState="pages.config.setValidityState",t.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",t.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",t.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",t.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",t.Pages_GetConfig="pages.getConfig.",t.Pages_NavigateCrossDomain="pages.navigateCrossDomain",t.Pages_NavigateToApp="pages.navigateToApp",t.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",t.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",t.Pages_ReturnFocus="pages.returnFocus",t.Pages_SetCurrentFrame="pages.setCurrentFrame",t.Pages_ShareDeepLink="pages.shareDeepLink",t.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",t.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",t.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",t.PublicAPIs_ExecuteDeepLink="executeDeepLink",t.PublicAPIs_GetContext="getContext",t.PublicAPIs_GetMruTabInstances="getMruTabInstances",t.PublicAPIs_GetTabInstances="getTabInstances",t.PublicAPIs_Initialize="initialize",t.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",t.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",t.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",t.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",t.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",t.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",t.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",t.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",t.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",t.PublicAPIs_SetFrameContext="setFrameContext",t.PublicAPIs_ShareDeepLink="shareDeepLink",t.RegisterHandler="registerHandler",t.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",t.Settings_Remove_Failure="settings.remove.failure",t.Settings_Remove_Success="settings.remove.success",t.Settings_Save_Failure="settings.save.failure",t.Settings_Save_Success="settings.save.success",t.Tasks_StartTask="tasks.startTask",t.Tasks_SubmitTask="tasks.submitTask",t.Tasks_UpdateTask="tasks.updateTask"}(E||(E={}));var be=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),Oe="2.0.1",$="1.8.0",K=Me.t(be,2).validOrigins,se=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),Pe=/^https:\/\//,Te="https",ge="teams.microsoft.com",Fe="The library has not yet been initialized",Ve="The runtime has not yet been initialized",Je="The runtime version is not supported",H=function(){};H.initializeCalled=!1,H.initializeCompleted=!1,H.additionalValidOrigins=[],H.initializePromise=void 0,H.isFramelessWindow=!1,H.frameContext=void 0,H.hostClientType=void 0,H.printCapabilityEnabled=!1;var qe,Xe={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},Xt=new Uint8Array(16);function Mt(){if(!qe&&!(qe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qe(Xt)}for(var Re=[],pt=0;pt<256;++pt)Re.push((pt+256).toString(16).slice(1));var G,U,B,F,Z,J,x,Ae,h,Be,je,Le,Yt=function(a,l,c){if(Xe.randomUUID&&!l&&!a)return Xe.randomUUID();var s=(a=a||{}).random||(a.rng||Mt)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,l){c=c||0;for(var f=0;f<16;++f)l[c+f]=s[f];return l}return function(t,a){return void 0===a&&(a=0),(Re[t[a+0]]+Re[t[a+1]]+Re[t[a+2]]+Re[t[a+3]]+"-"+Re[t[a+4]]+Re[t[a+5]]+"-"+Re[t[a+6]]+Re[t[a+7]]+"-"+Re[t[a+8]]+Re[t[a+9]]+"-"+Re[t[a+10]]+Re[t[a+11]]+Re[t[a+12]]+Re[t[a+13]]+Re[t[a+14]]+Re[t[a+15]]).toLowerCase()}(s)};(function(t){t.Inline="inline",t.Desktop="desktop",t.Web="web"})(G||(G={})),function(t){t.M365Content="m365content"}(U||(U={})),function(t){t.DriveId="driveId",t.GroupId="groupId",t.SiteId="siteId",t.UserId="userId"}(B||(B={})),function(t){t[t.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t[t.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",t[t.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",t[t.NETWORK_ERROR=2e3]="NETWORK_ERROR",t[t.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",t[t.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",t[t.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",t[t.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",t[t.THROTTLE=7e3]="THROTTLE",t[t.USER_ABORT=8e3]="USER_ABORT",t[t.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",t[t.OLD_PLATFORM=9e3]="OLD_PLATFORM",t[t.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",t[t.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(F||(F={})),function(t){t.GeoLocation="geolocation",t.Media="media"}(Z||(Z={})),function(t){t.TextPlain="text/plain",t.TextHtml="text/html",t.ImagePNG="image/png",t.ImageJPEG="image/jpeg"}(J||(J={})),function(t){t.desktop="desktop",t.web="web",t.android="android",t.ios="ios",t.ipados="ipados",t.macos="macos",t.rigel="rigel",t.surfaceHub="surfaceHub",t.teamsRoomsWindows="teamsRoomsWindows",t.teamsRoomsAndroid="teamsRoomsAndroid",t.teamsPhones="teamsPhones",t.teamsDisplays="teamsDisplays"}(x||(x={})),function(t){t.office="Office",t.outlook="Outlook",t.outlookWin32="OutlookWin32",t.orange="Orange",t.places="Places",t.teams="Teams",t.teamsModern="TeamsModern"}(Ae||(Ae={})),function(t){t.settings="settings",t.content="content",t.authentication="authentication",t.remove="remove",t.task="task",t.sidePanel="sidePanel",t.stage="stage",t.meetingStage="meetingStage"}(h||(h={})),function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff"}(Be||(Be={})),function(t){t[t.Admin=0]="Admin",t[t.User=1]="User",t[t.Guest=2]="Guest"}(je||(je={})),function(t){t.Large="large",t.Medium="medium",t.Small="small"}(Le||(Le={}));var _n,Ot=Le;!function(t){t.Regular="Regular",t.Private="Private",t.Shared="Shared"}(_n||(_n={}));var k={errorCode:F.NOT_SUPPORTED_ON_PLATFORM},xr={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},go=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),vo=new Error("Invalid response: Received more images than the specified max limit in the response.");function St(t){return function(a,l){if(!a)throw new Error(t||l)}}function Lt(t,a){if("string"!=typeof t||"string"!=typeof a)return NaN;var l=t.split("."),c=a.split(".");function s(m){return/^\d+$/.test(m)}if(!l.every(s)||!c.every(s))return NaN;for(;l.length<c.length;)l.push("0");for(;c.length<l.length;)c.push("0");for(var f=0;f<l.length;++f)if(Number(l[f])!=Number(c[f]))return Number(l[f])>Number(c[f])?1:-1;return 0}function Nr(){return Yt()}function Ur(t){return Object.keys(t).forEach(function(a){"object"==typeof t[a]&&Ur(t[a])}),Object.freeze(t)}function Hr(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];var f=t.apply(void 0,c);return f.then(function(){a&&a(null)}).catch(function(m){a&&a(m)}),f}function ut(t){return!(Lt(t.majorVersion+"."+t.minorVersion,"1.5")>=0)}function Vr(t){return"https:"===t.protocol}function Br(t,a){return new Promise(function(l,c){t||c("MimeType cannot be null or empty."),a||c("Base64 string cannot be null or empty.");var s=atob(a);if(t.startsWith("image/")){for(var f=new Uint8Array(s.length),m=0;m<s.length;m++)f[m]=s.charCodeAt(m);l(new Blob([f],{type:t}))}l(new Blob([s],{type:t}))})}function Co(t){return new Promise(function(a,l){0===t.size&&l(new Error("Blob cannot be empty."));var c=new FileReader;c.onloadend=function(){c.result?a(c.result.toString().split(",")[1]):l(new Error("Failed to read the blob"))},c.onerror=function(){l(c.error)},c.readAsDataURL(t)})}function xt(){if(tt())throw new Error("window object undefined at SSR check");return window}function tt(){return typeof window>"u"}var bo=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Kt(t){if(!bo.test(t))throw new Error("App ID is not valid. Must be GUID format. App ID: "+t)}var Jn=re("runtime"),yn=3;function Wr(t){return t.apiVersion===yn}var p={apiVersion:-1,supports:{}},Ao={apiVersion:3,hostVersionsInfo:xr,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Gr=[x.desktop,x.web,x.rigel,x.surfaceHub,x.teamsRoomsWindows,x.teamsRoomsAndroid,x.teamsPhones,x.teamsDisplays],zr=[].concat(Gr,[x.android,x.ios,x.ipados]);var Nt=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(a){var l;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:a.isLegacyTeams,supports:Object.assign(Object.assign({},a.supports),{dialog:a.supports.dialog?{card:void 0,url:a.supports.dialog,update:null===(l=a.supports.dialog)||void 0===l?void 0:l.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(a){var s=function(a,l){var c={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&l.indexOf(s)<0&&(c[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)l.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(c[s[f]]=a[s[f]])}return c}(a.supports,["appNotification"]);return Object.assign(Object.assign({},a),{apiVersion:3,supports:s})}}],Do={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Gr}],"1.9.0":[{capability:{location:{}},hostClientTypes:zr}],"2.0.0":[{capability:{people:{}},hostClientTypes:zr},{capability:{sharing:{}},hostClientTypes:[x.desktop,x.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[x.android,x.desktop,x.ios,x.teamsRoomsAndroid,x.teamsPhones,x.teamsDisplays,x.web]},{capability:{webStorage:{}},hostClientTypes:[x.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[x.android,x.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[x.android,x.ios]}]},Cn=Jn.extend("generateBackCompatRuntimeConfig");function Xn(t,a){var l=Object.assign({},t);for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&("object"!=typeof a[c]||Array.isArray(a[c])?c in t||(l[c]=a[c]):l[c]=Xn(t[c]||{},a[c]));return l}function bn(t,a,l){Cn("generating back compat runtime config for %s",t);var c=Object.assign({},a.supports);Cn("Supported capabilities in config before updating based on highestSupportedVersion: %o",c),Object.keys(l).forEach(function(f){Lt(t,f)>=0&&l[f].forEach(function(m){void 0!==H.hostClientType&&m.hostClientTypes.includes(H.hostClientType)&&(c=Xn(c,m.capability))})});var s={apiVersion:yn,hostVersionsInfo:xr,isLegacyTeams:!0,supports:c};return Cn("Runtime config after updating based on highestSupportedVersion: %o",s),s}var Yn=Jn.extend("applyRuntimeConfig");function Sn(t){"string"==typeof t.apiVersion&&(Yn("Trying to apply runtime with string apiVersion, processing as v1: %o",t),t=Object.assign(Object.assign({},t),{apiVersion:1})),Yn("Fast-forwarding runtime %o",t);var a=function(t){var a=t;if(a.apiVersion<yn&&Nt.forEach(function(l){a.apiVersion===l.versionToUpgradeFrom&&(a=l.upgradeToNextVersion(a))}),Wr(a))return a;throw new Error("Received a runtime that could not be upgraded to the latest version")}(t);Yn("Applying runtime %o",a),p=Ur(a)}var Pn="2.19.0",jr=re("internal"),Qr=jr.extend("ensureInitializeCalled"),qr=jr.extend("ensureInitialized");function gt(){if(!H.initializeCalled)throw Qr(Fe),new Error(Fe)}function C(t){if(!H.initializeCompleted)throw qr("%s. initializeCalled: %s",Fe,H.initializeCalled.toString()),new Error(Fe);for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];if(l&&l.length>0){for(var s=!1,f=0;f<l.length;f++)if(l[f]===H.frameContext){s=!0;break}if(!s)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(l)+'. Current context: "'+H.frameContext+'".')}return function(t){if(Wr(t))return!0;throw-1===t.apiVersion?new Error(Ve):new Error(Je)}(t)}function nt(t){void 0===t&&(t=Oe);var a=Lt(H.clientSupportedSDKVersion,t);return!isNaN(a)&&a>=0}function Kn(){return H.hostClientType==x.android||H.hostClientType==x.ios||H.hostClientType==x.ipados}function En(t){if(void 0===t&&(t=Oe),!Kn())throw{errorCode:F.NOT_SUPPORTED_ON_PLATFORM};if(!nt(t))throw{errorCode:F.OLD_PLATFORM}}function Ie(t){return null==t}var Dn,_r=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})},Ut=[],An=re("validateOrigin");function $r(){return _r(this,void 0,void 0,Q().mark(function t(){return Q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",0!==Ut.length?Ut:tt()?(Ut=K,K):fetch(se).then(function(c){if(!c.ok)throw new Error("Invalid Response from Fetch Call");return c.json().then(function(s){if(Jr(JSON.stringify(s)))return Ut=s.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(c){return An("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",c),Ut=K}));case 1:case"end":return l.stop()}},t)}))}function Jr(t){var a=JSON.parse(t);try{a=JSON.parse(t)}catch{return!1}if(!a.validOrigins)return!1;for(var c,l=X(a.validOrigins);!(c=l()).done;){var s=c.value;try{new URL("https://"+s)}catch{return An("isValidOriginsFromCDN call failed to validate origin: %s",s),!1}}return!0}function In(t,a){if("*."===t.substring(0,2)){var l=t.substring(1);if(a.length>l.length&&a.split(".").length===l.split(".").length&&a.substring(a.length-l.length)===l)return!0}else if(t===a)return!0;return!1}function Fo(t){return $r().then(function(a){if(!Vr(t))return An("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",t,t.protocol),!1;var l=t.host;if(a.some(function(m){return In(m,l)}))return!0;for(var s,c=X(H.additionalValidOrigins);!(s=c()).done;){var f=s.value;if(In("https://"===f.substring(0,8)?f.substring(8):f,l))return!0}return An("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",t,a,H.additionalValidOrigins),!1})}!function(t){var a,l,c,R;function f(R){return new Promise(function(V,z){if(H.hostClientType===x.desktop||H.hostClientType===x.android||H.hostClientType===x.ios||H.hostClientType===x.ipados||H.hostClientType===x.macos||H.hostClientType===x.rigel||H.hostClientType===x.teamsRoomsWindows||H.hostClientType===x.teamsRoomsAndroid||H.hostClientType===x.teamsPhones||H.hostClientType===x.teamsDisplays||H.hostClientType===x.surfaceHub){var L=document.createElement("a");L.href=R.url,V(it("authentication.authenticate",[L.href,R.width,R.height,R.isExternal]).then(function(ie){var Ye=ie[1];if(ie[0])return Ye;throw new Error(Ye)}))}else a={success:V,fail:z},function(R){b();var V=R.width||600,z=R.height||400;V=Math.min(V,O.currentWindow.outerWidth-400),z=Math.min(z,O.currentWindow.outerHeight-200);var L=document.createElement("a");L.href=R.url.replace("{oauthRedirectMethod}","web");var ie=void 0!==O.currentWindow.screenLeft?O.currentWindow.screenLeft:O.currentWindow.screenX,pe=void 0!==O.currentWindow.screenTop?O.currentWindow.screenTop:O.currentWindow.screenY;O.childWindow=O.currentWindow.open(L.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(pe+=O.currentWindow.outerHeight/2-z/2)+", left="+(ie+=O.currentWindow.outerWidth/2-V/2)+", width="+V+", height="+z),O.childWindow?(v(),l=O.currentWindow.setInterval(function(){if(!O.childWindow||O.childWindow.closed)M("CancelledByUser");else{var R=O.childOrigin;try{O.childOrigin="*",ct("ping")}finally{O.childOrigin=R}}},100),Y("initialize",function(){return[h.authentication,H.hostClientType]}),Y("navigateCrossDomain",function(){return!1})):M("FailedToOpenWindow")}(R)})}function b(){v();try{O.childWindow&&O.childWindow.close()}finally{O.childWindow=null,O.childOrigin=null}}function v(){l&&(clearInterval(l),l=0),_e("initialize"),_e("navigateCrossDomain")}function A(R){try{a&&a.success(R)}finally{a=void 0,b()}}function M(R){try{a&&a.fail(new Error(R))}finally{a=void 0,b()}}function ne(R,V,z){if(R){var L=document.createElement("a");L.href=decodeURIComponent(R),L.host&&L.host!==xt().location.host&&"outlook.office.com"===L.host&&L.search.indexOf("client_type=Win32_Outlook")>-1&&(V&&"result"===V&&(z&&(L.href=N(L.href,"result",z)),O.currentWindow.location.assign(N(L.href,"authSuccess",""))),V&&"reason"===V&&(z&&(L.href=N(L.href,"reason",z)),O.currentWindow.location.assign(N(L.href,"authFailure",""))))}}function N(R,V,z){var L=R.indexOf("#"),ie=-1===L?"#":R.substr(L);return ie=ie+"&"+V+(""!==z?"="+z:""),(R=-1===L?R:R.substr(0,L))+ie}t.initialize=function(){Y("authentication.authenticate.success",A,!1),Y("authentication.authenticate.failure",M,!1)},t.registerAuthenticationHandlers=function(R){c=R},t.authenticate=function(R){var V=void 0!==R,z=V?R:c;if(!z)throw new Error("No parameters are provided for authentication");return C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),f(z).then(function(L){try{return z&&z.successCallback?(z.successCallback(L),""):L}finally{V||(c=void 0)}}).catch(function(L){try{if(z&&z.failureCallback)return z.failureCallback(L.message),"";throw L}finally{V||(c=void 0)}})},t.getAuthToken=function(R){return gt(),function(R){return new Promise(function(V){V(it("authentication.getAuthToken",[R?.resources,R?.claims,R?.silent]))}).then(function(V){var L=V[1];if(V[0])return L;throw new Error(L)})}(R).then(function(V){return R&&R.successCallback?(R.successCallback(V),""):V}).catch(function(V){if(R&&R.failureCallback)return R.failureCallback(V.message),"";throw V})},t.getUser=function(R){return gt(),new Promise(function(R){R(it("authentication.getUser"))}).then(function(R){var z=R[1];if(R[0])return z;throw new Error(z)}).then(function(V){return R&&R.successCallback?(R.successCallback(V),null):V}).catch(function(V){if(R&&R.failureCallback)return R.failureCallback(V.message),null;throw V})},t.notifySuccess=function(R,V){ne(V,"result",R),C(p,h.authentication),W("authentication.authenticate.success",[R]),yi(O.parentWindow,function(){return setTimeout(function(){return O.currentWindow.close()},200)})},t.notifyFailure=function(R,V){ne(V,"reason",R),C(p,h.authentication),W("authentication.authenticate.failure",[R]),yi(O.parentWindow,function(){return setTimeout(function(){return O.currentWindow.close()},200)})},(R=t.DataResidency||(t.DataResidency={})).Public="public",R.EUDB="eudb",R.Other="other"}(Dn||(Dn={}));var lt,en,vt=oe.V_2;function Zr(t,a){if(C(p,h.content,h.sidePanel,h.task,h.meetingStage),!lt.update.isSupported())throw k;ae(t,"tasks.updateTask",[a])}function Xr(t,a,l,c){if(C(p,h.content,h.sidePanel,h.meetingStage),!lt.url.isSupported())throw k;c&&Y("messageForParent",c),ae(t,"tasks.startTask",[lt.url.getDialogInfoFromUrlDialogInfo(a)],function(s,f){l?.({err:s,result:f}),_e("messageForParent")})}function er(t,a,l,c){if(C(p,h.content,h.sidePanel,h.meetingStage),!lt.url.bot.isSupported())throw k;c&&Y("messageForParent",c),ae(t,"tasks.startTask",[lt.url.getDialogInfoFromBotUrlDialogInfo(a)],function(s,f){l?.({err:s,result:f}),_e("messageForParent")})}function Yr(t,a,l){if(C(p,h.content,h.task),!lt.url.isSupported())throw k;ae(t,"tasks.completeTask",[a,l?Array.isArray(l)?l:[l]:[]])}(function(t){var m,a=[];function l(m){H.frameContext&&(H.frameContext===h.task?a.push(m):_e("messageForChild"))}t.initialize=function(){Y("messageForChild",l,!1)},function(m){function y(){return C(p)&&void 0!==(p.supports.dialog&&p.supports.dialog.url)}var v;function w(v){return{url:v.url,height:v.size?v.size.height:Le.Small,width:v.size?v.size.width:Le.Small,title:v.title,fallbackUrl:v.fallbackUrl}}m.open=function(v,P,A){Xr(D(vt,E.Dialog_Url_Open),v,P,A)},m.submit=function(v,P){Yr(D(vt,E.Dialog_Url_Submit),v,P)},m.sendMessageToParentFromDialog=function(v){if(C(p,h.task),!y())throw k;ae(D(vt,E.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[v])},m.sendMessageToDialog=function(v){if(C(p,h.content,h.sidePanel,h.meetingStage),!y())throw k;ae(D(vt,E.Dialog_Url_SendMessageToDialog),"messageForChild",[v])},m.registerOnMessageFromParent=function(v){if(C(p,h.task),!y())throw k;for(_e("messageForChild"),Y("messageForChild",v),a.reverse();a.length>0;)v(a.pop())},m.isSupported=y,(v=m.bot||(m.bot={})).open=function(P,A,M){er(D(vt,E.Dialog_Url_Bot_Open),P,A,M)},v.isSupported=function(){return C(p)&&void 0!==(p.supports.dialog&&p.supports.dialog.url&&p.supports.dialog.url.bot)},m.getDialogInfoFromUrlDialogInfo=w,m.getDialogInfoFromBotUrlDialogInfo=function(v){var P=w(v);return P.completionBotId=v.completionBotId,P}}(t.url||(t.url={})),t.isSupported=function(){return!(!C(p)||!p.supports.dialog)},(m=t.update||(t.update={})).resize=function(y){Zr(D(vt,E.Dialog_Update_Resize),y)},m.isSupported=function(){return!(!C(p)||!p.supports.dialog||!p.supports.dialog.update)},function(m){function y(){var P=p.hostVersionsInfo&&p.hostVersionsInfo.adaptiveCardSchemaVersion&&!ut(p.hostVersionsInfo.adaptiveCardSchemaVersion);return C(p)&&void 0!==(P&&p.supports.dialog&&p.supports.dialog.card)}function w(P){return{card:P.card,height:P.size?P.size.height:Le.Small,width:P.size?P.size.width:Le.Small,title:P.title}}m.open=function(P,A){if(C(p,h.content,h.sidePanel,h.meetingStage),!y())throw k;var M=w(P);ae(D(vt,E.Dialog_AdaptiveCard_Open),"tasks.startTask",[M],function(ne,N){A?.({err:ne,result:N})})},m.isSupported=y,function(P){function A(){var M=p.hostVersionsInfo&&p.hostVersionsInfo.adaptiveCardSchemaVersion&&!ut(p.hostVersionsInfo.adaptiveCardSchemaVersion);return C(p)&&void 0!==(M&&p.supports.dialog&&p.supports.dialog.card&&p.supports.dialog.card.bot)}P.open=function(M,ne){if(C(p,h.content,h.sidePanel,h.meetingStage),!A())throw k;var N=function(P){var A=w(P);return A.completionBotId=P.completionBotId,A}(M);ae(D(vt,E.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[N],function(R,V){ne?.({err:R,result:V})})},P.isSupported=A}(m.bot||(m.bot={}))}(t.adaptiveCard||(t.adaptiveCard={}))})(lt||(lt={})),function(t){var c,s,f,v;function m(v){f&&f(v)||(C(p),W("viewConfigItemPress",[v]))}function y(v){c&&c(v)||(C(p),W("handleNavBarMenuItemPress",[v]))}function b(v){s&&s(v)||(C(p),W("handleActionMenuItemPress",[v]))}function w(){return!(!C(p)||!p.supports.menus)}(v=t.DisplayMode||(t.DisplayMode={}))[v.ifRoom=0]="ifRoom",v[v.overflowOnly=1]="overflowOnly",t.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(v){v.dropDown="dropDown",v.popOver="popOver"}(t.MenuListType||(t.MenuListType={})),t.initialize=function(){Y("navBarMenuItemPress",y,!1),Y("actionMenuItemPress",b,!1),Y("setModuleView",m,!1)},t.setUpViews=function(v,P){if(C(p),!w())throw k;f=P,W("setUpViews",[v])},t.setNavBarMenu=function(v,P){if(C(p),!w())throw k;c=P,W("setNavBarMenu",[v])},t.showActionMenu=function(v,P){if(C(p),!w())throw k;s=P,W("showActionMenu",[v])},t.isSupported=w}(en||(en={}));var Pt=oe.V_2,Kr=5e3,ei=re("app");function zt(t,a){return tt()?(ei.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(t,a,l){return new Promise(function(c,s){var f=setTimeout(s,a,l);t().then(function(m){clearTimeout(f),c(m)}).catch(function(m){clearTimeout(f),s(m)})})}(function(){return function(t,a){return new Promise(function(l){H.initializeCalled||(H.initializeCalled=!0,Ce.initializeHandlers(),H.initializePromise=function(t,a){var l=this;if(ke.messageListener=function(s){return Rn(l,void 0,void 0,Q().mark(function f(){return Q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,gi(s);case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},f)}))},O.currentWindow=O.currentWindow||xt(),O.parentWindow=O.currentWindow.parent!==O.currentWindow.self?O.currentWindow.parent:O.currentWindow.opener,(O.parentWindow||t)&&O.currentWindow.addEventListener("message",ke.messageListener,!1),!O.parentWindow){var c=O.currentWindow;if(!c.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));H.isFramelessWindow=!0,c.onNativeMessage=vi}try{return O.parentOrigin="*",nn(a,"initialize",[Pn,yn]).then(function(s){return{context:s[0],clientType:s[1],runtimeConfig:s[2],clientSupportedSDKVersion:s[3]}})}finally{O.parentOrigin=null}}(a,t).then(function(c){var f=c.clientType,m=c.runtimeConfig,y=c.clientSupportedSDKVersion,b=void 0===y?Oe:y;H.frameContext=c.context,H.hostClientType=f,H.clientSupportedSDKVersion=b;try{Et("Parsing %s",m);var w=JSON.parse(m);if(Et("Checking if %o is a valid runtime object",w??"null"),!w||!w.apiVersion)throw new Error("Received runtime config is invalid");m&&Sn(w)}catch(P){if(!(P instanceof SyntaxError))throw P;try{Et("Attempting to parse %s as an SDK version",m),isNaN(Lt(m,Oe))||(H.clientSupportedSDKVersion=m);var v=JSON.parse(b);if(Et("givenRuntimeConfig parsed to %o",v??"null"),!v)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Sn(v)}catch(A){if(!(A instanceof SyntaxError))throw A;Sn(bn(H.clientSupportedSDKVersion,Ao,Do))}}H.initializeCompleted=!0}),Dn.initialize(),en.initialize(),We.config.initialize(),lt.initialize()),Array.isArray(a)&&function(t){var a=H.additionalValidOrigins.concat(t.filter(function(c){return"string"==typeof c&&Pe.test(c)})),l={};a=a.filter(function(c){return!l[c]&&(l[c]=!0,!0)}),H.additionalValidOrigins=a}(a),void 0!==H.initializePromise?l(H.initializePromise):Et("GlobalVars.initializePromise is unexpectedly undefined")})}(t,a)},Kr,new Error("SDK initialization timed out."))}var st,Et=ei.extend("initializeHelper");function ve(t,a){!Ie(a)&&gt(),function(t,a){Ce.themeChangeHandler=a,!Ie(a)&&ae(t,"registerHandler",["themeChange"])}(t,a)}function fe(t,a){return new Promise(function(l){C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),l(At(t,"executeDeepLink",a))})}!function(t){var f,a=re("app");t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(f=t.FailedReason||(t.FailedReason={})).AuthFailed="AuthFailed",f.Timeout="Timeout",f.Other="Other",function(f){f.PermissionError="PermissionError",f.NotFound="NotFound",f.Throttling="Throttling",f.Offline="Offline",f.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return H.initializeCompleted},t.getFrameContext=function(){return H.frameContext},function(){if(!tt()){var f=document.getElementsByTagName("script"),m=f&&f[f.length-1]&&f[f.length-1].src,y="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";m&&0!==m.length?a("teamsjs is being used from %s. %s",m,y):a("teamsjs is being used from a script tag embedded directly in your html. %s",y)}}(),t.initialize=function(f){return function(){_r(this,void 0,void 0,Q().mark(function t(){return Q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,$r();case 2:case"end":return l.stop()}},t)}))}(),zt(D(Pt,E.App_Initialize),f)},t._initialize=function(f){O.currentWindow=f},t._uninitialize=function(){H.initializeCalled&&(Ce.uninitializeHandlers(),H.initializeCalled=!1,H.initializeCompleted=!1,H.initializePromise=void 0,H.additionalValidOrigins=[],H.frameContext=void 0,H.hostClientType=void 0,H.isFramelessWindow=!1,O.currentWindow&&O.currentWindow.removeEventListener("message",ke.messageListener,!1),O.currentWindow=null,O.parentWindow=null,O.parentOrigin=null,O.childWindow=null,O.childOrigin=null,ke.parentMessageQueue=[],ke.childMessageQueue=[],ke.nextMessageId=0,ke.callbacks={},ke.promiseCallbacks={})},t.getContext=function(){return new Promise(function(f){gt(),f(tn(D(Pt,E.App_GetContext),"getContext"))}).then(function(f){return function(t){var a;return{actionInfo:t.actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:Ae.teams,clientType:t.hostClientType?t.hostClientType:x.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId},appLaunchId:t.appLaunchId},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:H.frameContext,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,sourceOrigin:t.sourceOrigin},user:{id:null!==(a=t.userObjectId)&&void 0!==a?a:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0}}(f)})},t.notifyAppLoaded=function(){gt(),ae(D(Pt,E.App_NotifyAppLoaded),t.Messages.AppLoaded,[Pn])},t.notifySuccess=function(){gt(),ae(D(Pt,E.App_NotifySuccess),t.Messages.Success,[Pn])},t.notifyFailure=function(f){gt(),ae(D(Pt,E.App_NotifyFailure),t.Messages.Failure,[f.reason,f.message])},t.notifyExpectedFailure=function(f){gt(),ae(D(Pt,E.App_NotifyExpectedFailure),t.Messages.ExpectedFailure,[f.reason,f.message])},t.registerOnThemeChangeHandler=function(f){ve(D(Pt,E.App_RegisterOnThemeChangeHandler),f)},t.openLink=function(f){return fe(D(Pt,E.App_OpenLink),f)},function(f){f.registerBeforeSuspendOrTerminateHandler=function(m){if(!m)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");C(p),function(t){Ce.beforeSuspendOrTerminateHandler=t,!Ie(t)&&W("registerHandler",["beforeUnload"])}(m)},f.registerOnResumeHandler=function(m){if(!m)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");C(p),function(t){Ce.resumeHandler=t,!Ie(t)&&W("registerHandler",["load"])}(m)}}(t.lifecycle||(t.lifecycle={}))}(st||(st={}));var We,we=oe.V_2;function ti(t,a){return new Promise(function(l){if(C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),!We.isSupported())throw k;l(nr(t,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",a))})}function ni(t){return new Promise(function(a){if(C(p),!We.backStack.isSupported())throw k;a(nr(t,"navigateBack","Back navigation is not supported in the current client or context."))})}function ri(t,a){return new Promise(function(l){if(C(p),!We.tabs.isSupported())throw k;l(nr(t,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",a))})}function ii(t,a){if(C(p),!We.isSupported())throw k;ae(t,"returnFocus",[a])}function oi(t,a){return new Promise(function(l){if(C(p),!We.tabs.isSupported())throw k;l(tn(t,"getTabInstances",a))})}function ai(t,a){return new Promise(function(l){if(C(p),!We.tabs.isSupported())throw k;l(tn(t,"getMruTabInstances",a))})}function si(t,a){if(C(p,h.content,h.sidePanel,h.meetingStage),!We.isSupported())throw k;ae(t,"shareDeepLink",[a.subPageId,a.subPageLabel,a.subPageWebUrl])}function tr(t,a){if(C(p,h.content),!We.isSupported())throw k;ae(t,"setFrameContext",[a])}!function(t){function a(w){tr(D(we,E.Pages_SetCurrentFrame),w)}function l(){return!(!C(p)||!p.supports.pages)}var w;t.returnFocus=function(w){ii(D(we,E.Pages_ReturnFocus),w)},t.registerFocusEnterHandler=function(w){rt(D(we,E.Pages_RegisterFocusEnterHandler),"focusEnter",w,[],function(){if(!l())throw k})},t.setCurrentFrame=a,t.initializeWithFrameContext=function(w,v,P){st.initialize(P).then(function(){return v&&v()}),a(w)},t.getConfig=function(){return new Promise(function(w){if(C(p,h.content,h.settings,h.remove,h.sidePanel),!l())throw k;w(tn(D(we,E.Pages_GetConfig),"settings.getSettings"))})},t.navigateCrossDomain=function(w){return ti(D(we,E.Pages_NavigateCrossDomain),w)},t.navigateToApp=function(w){return new Promise(function(v){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!l())throw k;var P=D(we,E.Pages_NavigateCrossDomain);v(p.isLegacyTeams?At(P,"executeDeepLink",function(t){var a=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(t.appId)+"/"+encodeURIComponent(t.pageId));return t.webUrl&&a.searchParams.append("webUrl",t.webUrl),(t.channelId||t.subPageId)&&a.searchParams.append("context",JSON.stringify({channelId:t.channelId,subEntityId:t.subPageId})),a.toString()}(w)):At(P,"pages.navigateToApp",w))})},t.shareDeepLink=function(w){return si(D(we,E.Pages_ShareDeepLink),w)},t.registerFullScreenHandler=function(w){rt(D(we,E.Pages_RegisterFullScreenHandler),"fullScreenChange",w,[],function(){if(!Ie(w)&&!l())throw k})},t.isSupported=l,(w=t.tabs||(t.tabs={})).navigateToTab=function(v){return ri(D(we,E.Pages_Tabs_NavigateToTab),v)},w.getTabInstances=function(v){return oi(D(we,E.Pages_Tabs_GetTabInstances),v)},w.getMruTabInstances=function(v){return ai(D(we,E.Pages_Tabs_GetMruTabInstances),v)},w.isSupported=function(){return!(!C(p)||!p.supports.pages||!p.supports.pages.tabs)},function(w){var v,P;function A(L,ie){!Ie(L)&&C(p,h.settings),ie&&ie(),v=L,!Ie(L)&&ae(D(we,E.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function M(L,ie){!Ie(L)&&C(p,h.remove,h.settings),ie&&ie(),P=L,!Ie(L)&&ae(D(we,E.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function ne(L){var ie=new N(L);v?v(ie):O.childWindow?ct("settings.save",[L]):ie.notifySuccess()}w.initialize=function(){Y("settings.save",ne,!1),Y("settings.remove",R,!1)},w.setValidityState=function(L){if(C(p,h.settings,h.remove),!z())throw k;ae(D(we,E.Pages_Config_SetValidityState),"settings.setValidityState",[L])},w.setConfig=function(L){return new Promise(function(ie){if(C(p,h.content,h.settings,h.sidePanel),!z())throw k;ie(At(D(we,E.Pages_Config_SetConfig),"settings.setSettings",L))})},w.registerOnSaveHandler=function(L){A(L,function(){if(!Ie(L)&&!z())throw k})},w.registerOnSaveHandlerHelper=A,w.registerOnRemoveHandler=function(L){M(L,function(){if(!Ie(L)&&!z())throw k})},w.registerOnRemoveHandlerHelper=M,w.registerChangeConfigHandler=function(L){rt(D(we,E.Pages_Config_RegisterChangeConfigHandler),"changeSettings",L,[h.content],function(){if(!z())throw k})};var N=function(){function L(pe){this.notified=!1,this.result=pe||{}}var ie=L.prototype;return ie.notifySuccess=function(){this.ensureNotNotified(),ae(D(we,E.Settings_Save_Success),"settings.save.success"),this.notified=!0},ie.notifyFailure=function(Ye){this.ensureNotNotified(),ae(D(we,E.Settings_Save_Failure),"settings.save.failure",[Ye]),this.notified=!0},ie.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},L}();function R(){var L=new V;P?P(L):O.childWindow?ct("settings.remove",[]):L.notifySuccess()}var V=function(){function L(){this.notified=!1}var ie=L.prototype;return ie.notifySuccess=function(){this.ensureNotNotified(),ae(D(we,E.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},ie.notifyFailure=function(Ye){this.ensureNotNotified(),ae(D(we,E.Settings_Remove_Failure),"settings.remove.failure",[Ye]),this.notified=!0},ie.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},L}();function z(){return!(!C(p)||!p.supports.pages||!p.supports.pages.config)}w.isSupported=z}(t.config||(t.config={})),function(w){var v;function P(){return ni(D(we,E.Pages_BackStack_NavigateBack))}function A(N,R,V){!Ie(R)&&C(p),V&&V(),v=R,!Ie(R)&&ae(N,"registerHandler",["backButton"])}function M(){v&&v()||(O.childWindow?ct("backButtonPress",[]):P())}function ne(){return!(!C(p)||!p.supports.pages||!p.supports.pages.backStack)}w._initialize=function(){Y("backButtonPress",M,!1)},w.navigateBack=P,w.registerBackButtonHandler=function(N){A(D(we,E.Pages_BackStack_RegisterBackButtonHandler),N,function(){if(!Ie(N)&&!ne())throw k})},w.registerBackButtonHandlerHelper=A,w.isSupported=ne}(t.backStack||(t.backStack={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.fullTrust)}w.enterFullscreen=function(){if(C(p,h.content),!v())throw k;ae(D(we,E.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},w.exitFullscreen=function(){if(C(p,h.content),!v())throw k;ae(D(we,E.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},w.isSupported=v}(t.fullTrust||(t.fullTrust={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.appButton)}w.onClick=function(P){rt(D(we,E.Pages_AppButton_OnClick),"appButtonClick",P,[h.content],function(){if(!v())throw k})},w.onHoverEnter=function(P){rt(D(we,E.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",P,[h.content],function(){if(!v())throw k})},w.onHoverLeave=function(P){rt(D(we,E.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",P,[h.content],function(){if(!v())throw k})},w.isSupported=v}(t.appButton||(t.appButton={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.currentApp)}w.navigateTo=function(P){return new Promise(function(A){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!v())throw k;A(Qe(D(we,E.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",P))})},w.navigateToDefaultPage=function(){return new Promise(function(P){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!v())throw k;P(Qe(D(we,E.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},w.isSupported=v}(t.currentApp||(t.currentApp={}))}(We||(We={}));var Oo=re("handlers"),Ce=function(){function t(){}return t.initializeHandlers=function(){t.handlers.themeChange=Uo,t.handlers.load=Ho,t.handlers.beforeUnload=Bo,We.backStack._initialize()},t.uninitializeHandlers=function(){t.handlers={},t.themeChangeHandler=null,t.loadHandler=null,t.beforeUnloadHandler=null,t.beforeSuspendOrTerminateHandler=null,t.resumeHandler=null},t}();Ce.handlers={},Ce.themeChangeHandler=null,Ce.loadHandler=null,Ce.beforeUnloadHandler=null,Ce.beforeSuspendOrTerminateHandler=null,Ce.resumeHandler=null;var ui=Oo.extend("callHandler");function li(t,a){var l=Ce.handlers[t];return l?(ui("Invoking the registered handler for message %s with arguments %o",t,a),[!0,l.apply(this,a)]):O.childWindow?(ct(t,a),[!1,void 0]):(ui("Handler for action message %s not found.",t),[!1,void 0])}function Y(t,a,l,c){void 0===l&&(l=!0),void 0===c&&(c=[]),a?(Ce.handlers[t]=a,l&&ae(D(oe.V_0,E.RegisterHandler),"registerHandler",[t].concat(c))):delete Ce.handlers[t]}function _e(t){delete Ce.handlers[t]}function ci(t){return null!=Ce.handlers[t]}function rt(t,a,l,c,s){l&&C.apply(void 0,[p].concat(c)),s&&s(),Y(a,l)}function Uo(t){Ce.themeChangeHandler&&Ce.themeChangeHandler(t),O.childWindow&&ct("themeChange",[t])}function Ho(t){Ce.resumeHandler?Ce.resumeHandler(t):Ce.loadHandler&&Ce.loadHandler(t),O.childWindow&&ct("load",[t])}function Bo(){var t=function(){W("readyToUnload",[])};Ce.beforeSuspendOrTerminateHandler?(Ce.beforeSuspendOrTerminateHandler(),O.childWindow?ct("beforeUnload"):t()):Ce.beforeUnloadHandler&&Ce.beforeUnloadHandler(t)||(O.childWindow?ct("beforeUnload"):t())}var Rn=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})},Ht=re("communication"),O=function(){},ke=function(){};function tn(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];return nn(t,a,c).then(function(f){return f[0]})}function Tn(t){for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return it(t,l).then(function(s){return s[0]})}function At(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];return nn(t,a,c).then(function(f){if(!f[0])throw new Error(f[1])})}function It(t){for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return it(t,l).then(function(s){if(!s[0])throw new Error(s[1])})}function nr(t,a,l){for(var c=arguments.length,s=new Array(c>3?c-3:0),f=3;f<c;f++)s[f-3]=arguments[f];return nn(t,a,s).then(function(m){if(!m[0])throw new Error(m[1]||l)})}function Qe(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];return nn(t,a,c).then(function(f){var m=f[0];if(m)throw m;return f[1]})}function xe(t){for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return it(t,l).then(function(s){var f=s[0];if(f)throw f;return s[1]})}function nn(t,a,l){if(void 0===l&&(l=void 0),!Ee(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(c){c(rr(rn(t,a,l).id))})}function it(t,a){return void 0===a&&(a=void 0),new Promise(function(l){l(rr(rn(D(oe.V_0,"testing"),t,a).id))})}function rr(t){return new Promise(function(a){ke.promiseCallbacks[t]=a})}function ae(t,a,l,c){var s;if(l instanceof Function?c=l:l instanceof Array&&(s=l),!Ee(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var f=rn(t,a,s);c&&(ke.callbacks[f.id]=c)}function W(t,a,l){var c;a instanceof Function?l=a:a instanceof Array&&(c=a);var s=rn(D(oe.V_0,"testing"),t,c);l&&(ke.callbacks[s.id]=l)}ke.parentMessageQueue=[],ke.childMessageQueue=[],ke.nextMessageId=0,ke.callbacks={},ke.promiseCallbacks={};var zo=Ht.extend("sendMessageToParentHelper");function rn(t,a,l){var c=zo,s=O.parentWindow,f=function(t,a,l){return{id:ke.nextMessageId++,func:a,timestamp:Date.now(),args:l||[],apiversiontag:t}}(t,a,l);if(c("Message %i information: %o",f.id,{actionName:a,args:l}),H.isFramelessWindow)O.currentWindow&&O.currentWindow.nativeInterface&&(c("Sending message %i to parent via framelessPostMessage interface",f.id),O.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(f)));else{var m=Fn(s);s&&m?(c("Sending message %i to parent via postMessage",f.id),s.postMessage(f,m)):(c("Adding message %i to parent message queue",f.id),kn(s).push(f))}return f}var hi=Ht.extend("processMessage");function gi(t){return Rn(this,void 0,void 0,Q().mark(function a(){var l,c;return Q().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t&&t.data&&"object"==typeof t.data){f.next=2;break}return f.abrupt("return",void hi("Unrecognized message format received by app, message being ignored. Message: %o",t));case 2:return f.abrupt("return",jo(l=t.source||t.originalEvent&&t.originalEvent.source,c=t.origin||t.originalEvent&&t.originalEvent.origin).then(function(m){m?(Qo(l,c),l===O.parentWindow?vi(t):l===O.childWindow&&or(t)):hi("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return f.stop()}},a)}))}var ir=Ht.extend("shouldProcessMessage");function jo(t,a){return Rn(this,void 0,void 0,Q().mark(function l(){var c;return Q().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!O.currentWindow||t!==O.currentWindow){f.next=2;break}return f.abrupt("return",(ir("Should not process message because it is coming from the current window"),!1));case 2:if(!(O.currentWindow&&O.currentWindow.location&&a&&a===O.currentWindow.location.origin)){f.next=4;break}return f.abrupt("return",!0);case 4:return f.next=6,Fo(new URL(a));case 6:return f.abrupt("return",((c=f.sent)||ir("Message has an invalid origin of %s",a),c));case 8:case"end":return f.stop()}},l)}))}function Qo(t,a){H.isFramelessWindow||O.parentWindow&&!O.parentWindow.closed&&t!==O.parentWindow?O.childWindow&&!O.childWindow.closed&&t!==O.childWindow||(O.childWindow=t,O.childOrigin=a):(O.parentWindow=t,O.parentOrigin=a),O.parentWindow&&O.parentWindow.closed&&(O.parentWindow=null,O.parentOrigin=null),O.childWindow&&O.childWindow.closed&&(O.childWindow=null,O.childOrigin=null),wi(O.parentWindow),wi(O.childWindow)}var qo=Ht.extend("handleParentMessage");function vi(t){var a=qo;if("id"in t.data&&"number"==typeof t.data.id){var l=t.data,c=ke.callbacks[l.id];a("Received a response from parent for message %i",l.id),c&&(a("Invoking the registered callback for message %i with arguments %o",l.id,l.args),c.apply(null,[].concat(l.args,[l.isPartialResponse])),function(t){return!0===t.data.isPartialResponse}(t)||(a("Removing registered callback for message %i",l.id),delete ke.callbacks[l.id]));var s=ke.promiseCallbacks[l.id];s&&(a("Invoking the registered promise callback for message %i with arguments %o",l.id,l.args),s(l.args),a("Removing registered promise callback for message %i",l.id),delete ke.promiseCallbacks[l.id])}else if("func"in t.data&&"string"==typeof t.data.func){var f=t.data;a("Received an action message %s from parent",f.func),li(f.func,f.args)}else a("Received an unknown message: %O",t)}function or(t){if("id"in t.data&&"func"in t.data){var a=t.data,l=li(a.func,a.args),s=l[1];l[0]&&void 0!==s?Ci(a.id,Array.isArray(s)?s:[s]):W(a.func,a.args,function(){if(O.childWindow){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];var b=m.pop();Ci(a.id,m,b)}})}}function kn(t){return t===O.parentWindow?ke.parentMessageQueue:t===O.childWindow?ke.childMessageQueue:[]}function Fn(t){return t===O.parentWindow?O.parentOrigin:t===O.childWindow?O.childOrigin:null}var ar,sr,ur,lr,cr,mi=Ht.extend("flushMessageQueue");function wi(t){for(var a=Fn(t),l=kn(t),c=t==O.parentWindow?"parent":"child";t&&a&&l.length>0;){var s=l.shift();mi("Flushing message %i from "+c+" message queue via postMessage.",s?.id),t.postMessage(s,a)}}function yi(t,a){var l;l=O.currentWindow.setInterval(function(){0===kn(t).length&&(clearInterval(l),a())},100)}function Ci(t,a,l){var c=O.childWindow,s=function(t,a,l){return{id:t,args:a||[],isPartialResponse:l}}(t,a,l),f=Fn(c);c&&f&&c.postMessage(s,f)}function ct(t,a){var l=O.childWindow,c=function(t,a){return{func:t,args:a||[]}}(t,a),s=Fn(l);l&&s?l.postMessage(c,s):kn(l).push(c)}function bi(t,a){C(p),W("uploadCustomApp",[t],a||St())}function Zo(t,a,l){C(p),W(t,a,l)}function Xo(t,a){if(C(p),!O.childWindow)throw new Error("The child window has not yet been initialized or is not present");ct(t,a)}function Yo(t,a){var l=this;C(p),Y(t,function(){for(var c=arguments.length,s=new Array(c),f=0;f<c;f++)s[f]=arguments[f];return a.apply(l,s)})}function Si(t,a){C(p),Y("userSettingsChange",a,!0,[t])}function Pi(t){C(p,h.content,h.task),W("openFilePreview",[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId,t.viewerAction,t.fileOpenPreference,t.conversationId,t.sizeInBytes])}(function(t){function a(){return!(!C(p)||!p.supports.logs)}t.registerGetLogHandler=function(l){if(!Ie(l)&&C(p),!Ie(l)&&!a())throw k;l?Y("log.request",function(){W("log.receive",[l()])}):_e("log.request")},t.isSupported=a})(ar||(ar={})),function(t){t.fileDownloadStart="fileDownloadStart",t.fileDownloadComplete="fileDownloadComplete"}(sr||(sr={})),function(t){t.view="view",t.edit="edit",t.editNew="editNew"}(ur||(ur={})),function(t){t.fileOpenPreference="fileOpenPreference",t.theme="theme"}(lr||(lr={})),function(t){function a(){return!(!C(p)||!p.supports.conversations)}t.openConversation=function(l){return new Promise(function(c){if(C(p,h.content),!a())throw k;var s=It("conversations.openConversation",{title:l.title,subEntityId:l.subEntityId,conversationId:l.conversationId,channelId:l.channelId,entityId:l.entityId});l.onStartConversation&&Y("startConversation",function(f,m,y,b){var w;return null===(w=l.onStartConversation)||void 0===w?void 0:w.call(l,{subEntityId:f,conversationId:m,channelId:y,entityId:b})}),l.onCloseConversation&&Y("closeConversation",function(f,m,y,b){var w;return null===(w=l.onCloseConversation)||void 0===w?void 0:w.call(l,{subEntityId:f,conversationId:m,channelId:y,entityId:b})}),c(s)})},t.closeConversation=function(){if(C(p,h.content),!a())throw k;W("conversations.closeConversation"),_e("startConversation"),_e("closeConversation")},t.getChatMembers=function(){return new Promise(function(l){if(C(p),!a())throw k;l(Tn("getChatMembers"))})},t.isSupported=a}(cr||(cr={}));var fr;function Ai(t,a,l){if(0===t.length)throw new Error("Must have at least one user when creating a chat deep link");var c="users="+t.map(function(m){return encodeURIComponent(m)}).join(","),s=void 0===a?"":"&topicName="+encodeURIComponent(a),f=void 0===l?"":"&message="+encodeURIComponent(l);return Te+"://"+ge+"/l/chat/0/0?"+c+s+f}!function(t){function a(){return!(!C(p)||!p.supports.appInstallDialog)}t.openAppInstallDialog=function(l){return new Promise(function(c){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!a())throw new Error("Not supported");p.isLegacyTeams?c(It("executeDeepLink",function(t){if(!t)throw new Error("App ID must be set when creating an app install dialog deep link");return Te+"://"+ge+"/l/app/"+encodeURIComponent(t)}(l.appId))):(W("appInstallDialog.openAppInstallDialog",[l]),c())})},t.isSupported=a}(fr||(fr={}));var ft,ot=oe.V_1,Ii=re("media");function on(t,a){if(null==t||null==a||t.length<=0)return null;var l=null,c=1;return t.sort(function(s,f){return s.sequence>f.sequence?1:-1}),t.forEach(function(s){s.sequence==c&&(l=l?new Blob([l,s.file],{type:a}):new Blob([s.file],{type:a}),c++)}),l}function On(t,a){if(null==t||null==a)return null;for(var l=atob(t.chunk),c=new Array(l.length),s=0;s<l.length;s++)c[s]=l.charCodeAt(s);var f=new Uint8Array(c),m=new Blob([f],{type:a});return{sequence:t.chunkSequence,file:m}}function na(t){!function(t){return!(!t||t.mediaType!=ft.MediaType.VideoAndImage&&!t.videoAndImageProps)}(t)?function(t){return!(!t||t.mediaType!=ft.MediaType.Video||!t.videoProps||t.videoProps.isFullScreenMode)}(t)?En("2.0.3"):function(t){var a;return!(t?.mediaType!=ft.MediaType.Image||null===(a=t?.imageProps)||void 0===a||!a.imageOutputFormats)}(t)&&En("2.0.4"):En("2.0.2")}function Ri(t){return!t||!(null===t.timeOutIntervalInSec||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec<=0||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec>60)}!function(t){var l,f,A;(A=t.FileFormat||(t.FileFormat={})).Base64="base64",A.ID="id";var b=function(){};function w(){return!(!C(p)||!p.supports.permissions)}t.File=b,t.captureImage=function(A){if(!A)throw new Error("[captureImage] Callback cannot be null");C(p,h.content,h.task),H.isFramelessWindow?nt("1.7.0")?ae(D(ot,E.Media_CaptureImage),"captureImage",A):A({errorCode:F.OLD_PLATFORM},[]):A({errorCode:F.NOT_SUPPORTED_ON_PLATFORM},[])},t.hasPermission=function(){if(C(p,h.content,h.task),!w())throw k;var A=Z.Media;return new Promise(function(M){M(Qe(D(ot,E.Media_HasPermission),"permissions.has",A))})},t.requestPermission=function(){if(C(p,h.content,h.task),!w())throw k;var A=Z.Media;return new Promise(function(M){M(Qe(D(ot,E.Media_RequestPermission),"permissions.request",A))})};var v=function(A){function M(N){var R;return R=A.call(this)||this,N&&(R.content=N.content,R.format=N.format,R.mimeType=N.mimeType,R.name=N.name,R.preview=N.preview,R.size=N.size),R}Se(M,A);var ne=M.prototype;return ne.getMedia=function(R){if(!R)throw new Error("[get Media] Callback cannot be null");C(p,h.content,h.task),nt($)?function(t,a,l){return null!=t&&null!=a&&a==ft.FileFormat.ID&&null!=l}(this.mimeType,this.format,this.content)?nt("2.0.0")?this.getMediaViaCallback(R):this.getMediaViaHandler(R):R({errorCode:F.INVALID_ARGUMENTS},new Blob):R({errorCode:F.OLD_PLATFORM},new Blob)},ne.getMediaViaCallback=function(R){var V={mediaMimeType:this.mimeType,assembleAttachment:[]},z=[this.content];ae(D(ot,E.Media_GetMedia),"getMedia",z,function(L){if(R)if(L&&L.error)R(L.error,new Blob);else if(L&&L.mediaChunk)if(L.mediaChunk.chunkSequence<=0){var ie=on(V.assembleAttachment,V.mediaMimeType);R(L.error,ie??new Blob)}else{var pe=On(L.mediaChunk,V.mediaMimeType);pe?V.assembleAttachment.push(pe):Ii("Received a null assemble attachment for when decoding chunk sequence "+L.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else R({errorCode:F.INTERNAL_ERROR,message:"data received is null"},new Blob)})},ne.getMediaViaHandler=function(R){var V=Nr(),z={mediaMimeType:this.mimeType,assembleAttachment:[]},L=[V,this.content];this.content&&!Ie(R)&&ae(D(ot,E.Media_GetMedia),"getMedia",L),Y("getMedia"+V,function(ie){if(R){var pe=JSON.parse(ie);if(pe.error)R(pe.error,new Blob),_e("getMedia"+V);else if(pe.mediaChunk)if(pe.mediaChunk.chunkSequence<=0){var Ye=on(z.assembleAttachment,z.mediaMimeType);R(pe.error,Ye??new Blob),_e("getMedia"+V)}else{var Ze=On(pe.mediaChunk,z.mediaMimeType);Ze&&z.assembleAttachment.push(Ze)}else R({errorCode:F.INTERNAL_ERROR,message:"data received is null"},new Blob),_e("getMedia"+V)}})},M}(b);t.Media=v;var P=function(){function A(ne){this.controllerCallback=ne}var M=A.prototype;return M.notifyEventToHost=function(N,R){C(p,h.content,h.task);try{En("2.0.3")}catch(z){return void(R&&R(z))}var V={mediaType:this.getMediaType(),mediaControllerEvent:N};ae(D(ot,E.Media_Controller),"media.controller",[V],function(z){R&&R(z)})},M.stop=function(N){this.notifyEventToHost(l.StopRecording,N)},A}();t.VideoController=function(A){function M(){return A.apply(this,arguments)||this}Se(M,A);var ne=M.prototype;return ne.getMediaType=function(){return f.Video},ne.notifyEventToApp=function(R){if(this.controllerCallback)switch(R){case l.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},M}(P),function(A){A[A.StartRecording=1]="StartRecording",A[A.StopRecording=2]="StopRecording"}(l=t.MediaControllerEvent||(t.MediaControllerEvent={})),function(A){A[A.Photo=1]="Photo",A[A.Document=2]="Document",A[A.Whiteboard=3]="Whiteboard",A[A.BusinessCard=4]="BusinessCard"}(t.CameraStartMode||(t.CameraStartMode={})),function(A){A[A.Camera=1]="Camera",A[A.Gallery=2]="Gallery"}(t.Source||(t.Source={})),function(A){A[A.Image=1]="Image",A[A.Video=2]="Video",A[A.VideoAndImage=3]="VideoAndImage",A[A.Audio=4]="Audio"}(f=t.MediaType||(t.MediaType={})),function(A){A[A.ID=1]="ID",A[A.URL=2]="URL"}(t.ImageUriType||(t.ImageUriType={})),function(A){A[A.IMAGE=1]="IMAGE",A[A.PDF=2]="PDF"}(t.ImageOutputFormats||(t.ImageOutputFormats={})),t.selectMedia=function(A,M){if(!M)throw new Error("[select Media] Callback cannot be null");if(C(p,h.content,h.task),nt($)){try{na(A)}catch(V){return void M(V,[])}if(function(t){return!(null==t||t.maxMediaCount>10)}(A)){var R=[A];ae(D(ot,E.Media_SelectMedia),"selectMedia",R,function(V,z,L){var ie,pe;if(L)(function(t){return!(t.mediaType!=ft.MediaType.Video||!t.videoProps||!t.videoProps.videoController)})(A)&&(null===(pe=null===(ie=A?.videoProps)||void 0===ie?void 0:ie.videoController)||void 0===pe||pe.notifyEventToApp(L));else if(z){for(var kt,Ye=[],Ze=X(z);!(kt=Ze()).done;)Ye.push(new v(kt.value));M(V,Ye)}else M(V,[])})}else M({errorCode:F.INVALID_ARGUMENTS},[])}else M({errorCode:F.OLD_PLATFORM},[])},t.viewImages=function(A,M){if(!M)throw new Error("[view images] Callback cannot be null");if(C(p,h.content,h.task),nt($))if(function(t){return!(null==t||t.length<=0||t.length>10)}(A)){var ne=[A];ae(D(ot,E.Media_ViewImages),"viewImages",ne,M)}else M({errorCode:F.INVALID_ARGUMENTS});else M({errorCode:F.OLD_PLATFORM})},t.scanBarCode=function(A,M){if(!A)throw new Error("[media.scanBarCode] Callback cannot be null");C(p,h.content,h.task),H.hostClientType!==x.desktop&&H.hostClientType!==x.web&&H.hostClientType!==x.rigel&&H.hostClientType!==x.teamsRoomsWindows&&H.hostClientType!==x.teamsRoomsAndroid&&H.hostClientType!==x.teamsPhones&&H.hostClientType!==x.teamsDisplays?nt("1.9.0")?Ri(M)?ae(D(ot,E.Media_ScanBarCode),"media.scanBarCode",[M],A):A({errorCode:F.INVALID_ARGUMENTS},""):A({errorCode:F.OLD_PLATFORM},""):A({errorCode:F.NOT_SUPPORTED_ON_PLATFORM},"")}}(ft||(ft={}));var xn,an,Ln=oe.V_2;(function(t){function a(){return!!(C(p)&&p.supports.barCode&&p.supports.permissions)}t.scanBarCode=function(l){return new Promise(function(c){if(C(p,h.content,h.task),!a())throw k;if(!Ri(l))throw{errorCode:F.INVALID_ARGUMENTS};c(Qe(D(Ln,E.BarCode_ScanBarCode),"media.scanBarCode",l))})},t.hasPermission=function(){if(C(p,h.content,h.task),!a())throw k;var l=Z.Media;return new Promise(function(c){c(Qe(D(Ln,E.BarCode_HasPermission),"permissions.has",l))})},t.requestPermission=function(){if(C(p,h.content,h.task),!a())throw k;var l=Z.Media;return new Promise(function(c){c(Qe(D(Ln,E.BarCode_RequestPermission),"permissions.request",l))})},t.isSupported=a})(xn||(xn={})),function(t){function a(c){return new Promise(function(s){if(C(p,h.content,h.task),!l())throw k;s(p.isLegacyTeams?It("executeDeepLink",Ai([c.user],void 0,c.message)):It("chat.openChat",{members:[c.user],message:c.message}))})}function l(){return!(!C(p)||!p.supports.chat)}t.openChat=a,t.openGroupChat=function(c){return new Promise(function(s){if(c.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===c.users.length)s(a({user:c.users[0],message:c.message}));else{if(C(p,h.content,h.task),!l())throw k;s(p.isLegacyTeams?It("executeDeepLink",Ai(c.users,c.topic,c.message)):It("chat.openChat",{members:c.users,message:c.message,topic:c.topic}))}})},t.isSupported=l}(an||(an={}));var pr,Ti=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})},dr=oe.V_2;!function(t){function a(){return!!(C(p)&&navigator&&navigator.clipboard&&p.supports.clipboard)}t.write=function(l){return Ti(this,void 0,void 0,Q().mark(function c(){var f;return Q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(C(p,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel),a()){y.next=2;break}throw k;case 2:if(l.type&&Object.values(J).includes(l.type)){y.next=4;break}throw new Error("Blob type "+l.type+" is not supported. Supported blob types are "+Object.values(J));case 4:return y.next=6,Co(l);case 6:return f={mimeType:l.type,content:y.sent},y.abrupt("return",Qe(D(dr,E.Clipboard_Write),"clipboard.writeToClipboard",f));case 9:case"end":return y.stop()}},c)}))},t.read=function(){return Ti(this,void 0,void 0,Q().mark(function l(){var c;return Q().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(C(p,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel),a()){f.next=2;break}throw k;case 2:if(!Kn()&&H.hostClientType!==x.macos){f.next=9;break}return f.t0=JSON,f.next=6,xe("clipboard.readFromClipboard");case 6:return f.t1=f.sent,c=f.t0.parse.call(f.t0,f.t1),f.abrupt("return",Br(c.mimeType,c.content));case 9:return f.abrupt("return",Qe(D(dr,E.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return f.stop()}},l)}))},t.isSupported=a}(pr||(pr={}));var un,ln,sn=oe.V_2;function ua(){return p.hostVersionsInfo?p.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(t){function a(){return!!(C(p)&&p.supports.geoLocation&&p.supports.permissions)}t.getCurrentLocation=function(){if(C(p,h.content,h.task),!a())throw k;return Qe(D(sn,E.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},t.hasPermission=function(){if(C(p,h.content,h.task),!a())throw k;var c=Z.GeoLocation;return new Promise(function(s){s(Qe(D(sn,E.GeoLocation_HasPermission),"permissions.has",c))})},t.requestPermission=function(){if(C(p,h.content,h.task),!a())throw k;var c=Z.GeoLocation;return new Promise(function(s){s(Qe(D(sn,E.GeoLocation_RequestPermission),"permissions.request",c))})},t.isSupported=a,function(c){function s(){return!!(C(p)&&p.supports.geoLocation&&p.supports.geoLocation.map&&p.supports.permissions)}c.chooseLocation=function(){if(C(p,h.content,h.task),!s())throw k;return Qe(D(sn,E.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},c.showLocation=function(f){if(C(p,h.content,h.task),!s())throw k;if(!f)throw{errorCode:F.INVALID_ARGUMENTS};return Qe(D(sn,E.GeoLocation_ShowLocation),"location.showLocation",f)},c.isSupported=s}(t.map||(t.map={}))}(un||(un={}));var ki=function(){function t(){}var a=t.prototype;return a.postMessage=function(c,s){C(p),W("messageForChild",[c],s||St())},a.addEventListener=function(c,s){C(p),"message"===c&&Y("messageForParent",s)},t}(),la=function(){function t(){}var a=t.prototype;return a.postMessage=function(c,s){C(p,h.task),W("messageForParent",[c],s||St())},a.addEventListener=function(c,s){C(p,h.task),"message"===c&&Y("messageForChild",s)},ce(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();!function(t){function a(){return!(!C(p)||!p.supports.secondaryBrowser)}t.open=function(l){if(C(p,h.content),!a())throw k;if(!l||!Vr(l))throw{errorCode:F.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return xe("secondaryBrowser.open",l.toString())},t.isSupported=a}(ln||(ln={}));var Qt,mt=oe.V_1;!function(t){function a(){return!(!C(p)||!p.supports.location)}t.getLocation=function(l,c){if(!c)throw new Error("[location.getLocation] Callback cannot be null");if(C(p,h.content,h.task),!nt("1.9.0"))throw{errorCode:F.OLD_PLATFORM};if(!l)throw{errorCode:F.INVALID_ARGUMENTS};if(!a())throw k;ae(D(mt,E.Location_GetLocation),"location.getLocation",[l],c)},t.showLocation=function(l,c){if(!c)throw new Error("[location.showLocation] Callback cannot be null");if(C(p,h.content,h.task),!nt("1.9.0"))throw{errorCode:F.OLD_PLATFORM};if(!l)throw{errorCode:F.INVALID_ARGUMENTS};if(!a())throw k;ae(D(mt,E.Location_ShowLocation),"location.showLocation",[l],c)},t.isSupported=a}(Qt||(Qt={}));var Nn,hr,ca=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})};(function(t){var a,f,v;function w(v,P){C(p,h.sidePanel,h.meetingStage),W("meeting.updateMicState",[v,P])}(v=a||(a={}))[v.HostInitiated=0]="HostInitiated",v[v.AppInitiated=1]="AppInitiated",v[v.AppDeclinedToChange=2]="AppDeclinedToChange",v[v.AppFailedToChange=3]="AppFailedToChange",function(v){v.like="like",v.heart="heart",v.laugh="laugh",v.surprised="surprised",v.applause="applause"}(t.MeetingReactionType||(t.MeetingReactionType={})),function(v){v.Unknown="Unknown",v.Adhoc="Adhoc",v.Scheduled="Scheduled",v.Recurring="Recurring",v.Broadcast="Broadcast",v.MeetNow="MeetNow"}(t.MeetingType||(t.MeetingType={})),function(v){v.OneOnOneCall="oneOnOneCall",v.GroupCall="groupCall"}(t.CallType||(t.CallType={})),function(v){v.Collaborative="Collaborative",v.ScreenShare="ScreenShare"}(f=t.SharingProtocol||(t.SharingProtocol={})),t.getIncomingClientAudioState=function(v){if(!v)throw new Error("[get incoming client audio state] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("getIncomingClientAudioState",v)},t.toggleIncomingClientAudio=function(v){if(!v)throw new Error("[toggle incoming client audio] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("toggleIncomingClientAudio",v)},t.getMeetingDetails=function(v){if(!v)throw new Error("[get meeting details] Callback cannot be null");C(p,h.sidePanel,h.meetingStage,h.settings,h.content),W("meeting.getMeetingDetails",v)},t.getAuthenticationTokenForAnonymousUser=function(v){if(!v)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");C(p,h.sidePanel,h.meetingStage,h.task),W("meeting.getAuthenticationTokenForAnonymousUser",v)},t.getLiveStreamState=function(v){if(!v)throw new Error("[get live stream state] Callback cannot be null");C(p,h.sidePanel),W("meeting.getLiveStreamState",v)},t.requestStartLiveStreaming=function(v,P,A){if(!v)throw new Error("[request start live streaming] Callback cannot be null");C(p,h.sidePanel),W("meeting.requestStartLiveStreaming",[P,A],v)},t.requestStopLiveStreaming=function(v){if(!v)throw new Error("[request stop live streaming] Callback cannot be null");C(p,h.sidePanel),W("meeting.requestStopLiveStreaming",v)},t.registerLiveStreamChangedHandler=function(v){if(!v)throw new Error("[register live stream changed handler] Handler cannot be null");C(p,h.sidePanel),Y("meeting.liveStreamChanged",v)},t.shareAppContentToStage=function(v,P,A){if(void 0===A&&(A={sharingProtocol:f.Collaborative}),!v)throw new Error("[share app content to stage] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("meeting.shareAppContentToStage",[P,A],v)},t.getAppContentStageSharingCapabilities=function(v){if(!v)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("meeting.getAppContentStageSharingCapabilities",v)},t.stopSharingAppContentToStage=function(v){if(!v)throw new Error("[stop sharing app content to stage] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("meeting.stopSharingAppContentToStage",v)},t.getAppContentStageSharingState=function(v){if(!v)throw new Error("[get app content stage sharing state] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),W("meeting.getAppContentStageSharingState",v)},t.registerSpeakingStateChangeHandler=function(v){if(!v)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),Y("meeting.speakingStateChanged",v)},t.registerRaiseHandStateChangedHandler=function(v){if(!v)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),Y("meeting.raiseHandStateChanged",v)},t.registerMeetingReactionReceivedHandler=function(v){if(!v)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),Y("meeting.meetingReactionReceived",v)},function(v){v.setOptions=function(P){C(p,h.sidePanel),P.contentUrl&&new URL(P.contentUrl),W("meeting.appShareButton.setOptions",[P])}}(t.appShareButton||(t.appShareButton={})),t.requestAppAudioHandling=function(v,P){if(!P)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!v.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");C(p,h.sidePanel,h.meetingStage),v.isAppHandlingAudio?function(v,P){var A=this;W("meeting.requestAppAudioHandling",[v.isAppHandlingAudio],function(M,ne){if(M&&null!=ne)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(M)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+M.errorCode+" "+M.message);if("boolean"!=typeof ne)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Y("meeting.micStateChanged",function(N){return ca(A,void 0,void 0,Q().mark(function R(){var V;return Q().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,v.micMuteStateChangedCallback(N);case 3:w(V=L.sent,V.isMicMuted===N.isMicMuted?a.HostInitiated:a.AppDeclinedToChange),L.next=10;break;case 7:L.prev=7,L.t0=L.catch(0),w(N,a.AppFailedToChange);case 10:case"end":return L.stop()}},R,null,[[0,7]])}))}),Y("meeting.audioDeviceSelectionChanged",function(N){var R;null===(R=v.audioDeviceSelectionChangedCallback)||void 0===R||R.call(v,N)}),P(ne)})}(v,P):function(v,P){W("meeting.requestAppAudioHandling",[v.isAppHandlingAudio],function(A,M){if(A&&null!=M)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(A)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+A.errorCode+" "+A.message);if("boolean"!=typeof M)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");ci("meeting.micStateChanged")&&_e("meeting.micStateChanged"),ci("meeting.audioDeviceSelectionChanged")&&_e("meeting.audioDeviceSelectionChanged"),P(M)})}(v,P)},t.updateMicState=function(v){w(v,a.AppInitiated)}})(Nn||(Nn={})),function(t){function a(){return!(!C(p)||!p.supports.monetization)}t.openPurchaseExperience=function(l,c){var s,f;return"function"==typeof l?(s=l,f=c):f=l,C(p,h.content),function(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];var f=t.apply(void 0,c);return f.then(function(m){a&&a(null,m)}).catch(function(m){a&&a(m,null)}),f}(function(){return new Promise(function(m){if(!a())throw k;m(xe("monetization.openPurchaseExperience",f))})},s)},t.isSupported=a}(hr||(hr={}));var Un,Fi=oe.V_2;!function(t){function a(){return!(!C(p)||!p.supports.calendar)}t.openCalendarItem=function(l){return new Promise(function(c){if(C(p,h.content),!a())throw new Error("Not supported");if(!l.itemId||!l.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");c(At(D(Fi,E.Calendar_OpenCalendarItem),"calendar.openCalendarItem",l))})},t.composeMeeting=function(l){return new Promise(function(c){if(C(p,h.content),!a())throw new Error("Not supported");c(p.isLegacyTeams?It("executeDeepLink",function(t,a,l,c,s){var f=void 0===t?"":"attendees="+t.map(function(v){return encodeURIComponent(v)}).join(","),m=void 0===a?"":"&startTime="+encodeURIComponent(a),y=void 0===l?"":"&endTime="+encodeURIComponent(l),b=void 0===c?"":"&subject="+encodeURIComponent(c),w=void 0===s?"":"&content="+encodeURIComponent(s);return Te+"://"+ge+"/l/meeting/new?"+f+m+y+b+w}(l.attendees,l.startTime,l.endTime,l.subject,l.content)):At(D(Fi,E.Calendar_ComposeMeeting),"calendar.composeMeeting",l))})},t.isSupported=a}(Un||(Un={}));var gr,Bt,vr,mr,Mi=oe.V_2;(function(t){function a(){return!(!C(p)||!p.supports.mail)}var c;t.openMailItem=function(c){return new Promise(function(s){if(C(p,h.content),!a())throw new Error("Not supported");if(!c.itemId||!c.itemId.trim())throw new Error("Must supply an itemId to openMailItem");s(At(D(Mi,E.Mail_OpenMailItem),"mail.openMailItem",c))})},t.composeMail=function(c){return new Promise(function(s){if(C(p,h.content),!a())throw new Error("Not supported");s(At(D(Mi,E.Mail_ComposeMail),"mail.composeMail",c))})},t.isSupported=a,(c=t.ComposeMailType||(t.ComposeMailType={})).New="new",c.Reply="reply",c.ReplyAll="replyAll",c.Forward="forward"})(gr||(gr={})),function(t){function a(){xt().print()}function l(f,m){!Ie(f)&&C(p),!Ie(f)&&m&&m(),function(t){Ce.loadHandler=t,!Ie(t)&&ae(D(oe.V_2,E.RegisterHandler),"registerHandler",["load"])}(f)}function c(f,m){!Ie(f)&&C(p),!Ie(f)&&m&&m(),function(t){Ce.beforeUnloadHandler=t,!Ie(t)&&ae(D(oe.V_2,E.RegisterHandler),"registerHandler",["beforeUnload"])}(f)}function s(){return!(!C(p)||!p.supports.teamsCore)}t.enablePrintCapability=function(){if(!H.printCapabilityEnabled){if(C(p),!s())throw k;H.printCapabilityEnabled=!0,document.addEventListener("keydown",function(f){(f.ctrlKey||f.metaKey)&&80===f.keyCode&&(a(),f.cancelBubble=!0,f.preventDefault(),f.stopImmediatePropagation())})}},t.print=a,t.registerOnLoadHandler=function(f){l(f,function(){if(!Ie(f)&&!s())throw k})},t.registerOnLoadHandlerHelper=l,t.registerBeforeUnloadHandler=function(f){c(f,function(){if(!Ie(f)&&!s())throw k})},t.registerBeforeUnloadHandlerHelper=c,t.isSupported=s}(Bt||(Bt={})),function(t){function a(c){return new Promise(function(s){if(!nt("2.0.0"))throw{errorCode:F.OLD_PLATFORM};if(!function(t){return!(t&&(t.title&&"string"!=typeof t.title||t.setSelected&&"object"!=typeof t.setSelected||t.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof t.openOrgWideSearchInChatOrChannel||t.singleSelect&&"boolean"!=typeof t.singleSelect))}(c))throw{errorCode:F.INVALID_ARGUMENTS};if(!l())throw k;s(xe("people.selectPeople",c))})}function l(){return!(!C(p)||!p.supports.people)}t.selectPeople=function(c,s){var f,m,y;return C(p,h.content,h.task,h.settings),"function"==typeof c?(m=(f=[c,s])[0],y=f[1]):y=c,function(t,a){for(var l=arguments.length,c=new Array(l>2?l-2:0),s=2;s<l;s++)c[s-2]=arguments[s];var f=t.apply(void 0,c);return f.then(function(m){a&&a(void 0,m)}).catch(function(m){a&&a(m)}),f}(a,m,y)},t.isSupported=l}(vr||(vr={})),function(t){t.showProfile=function(a){return C(p,h.content),new Promise(function(l){var c=function(t){return t?t.modality&&"string"!=typeof t.modality?[!1,"modality must be a string"]:t.targetElementBoundingRect&&"object"==typeof t.targetElementBoundingRect?t.triggerType&&"string"==typeof t.triggerType?function(t){return t?t.displayName&&"string"!=typeof t.displayName?[!1,"displayName must be a string"]:t.identifiers&&"object"==typeof t.identifiers?t.identifiers.AadObjectId||t.identifiers.Smtp||t.identifiers.Upn?t.identifiers.AadObjectId&&"string"!=typeof t.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:t.identifiers.Smtp&&"string"!=typeof t.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:t.identifiers.Upn&&"string"!=typeof t.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(t.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(a);if(!c[0])throw{errorCode:F.INVALID_ARGUMENTS,message:c[1]};l(xe("profile.showProfile",{modality:a.modality,persona:a.persona,triggerType:a.triggerType,targetRectangle:{x:a.targetElementBoundingRect.x,y:a.targetElementBoundingRect.y,width:a.targetElementBoundingRect.width,height:a.targetElementBoundingRect.height}}))})},t.isSupported=function(){return!(!C(p)||!p.supports.profile)}}(mr||(mr={}));var Dt,qt=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})};function Li(t,a,l,c){var s,f;return qt(this,void 0,void 0,Q().mark(function m(){var y;return Q().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return y=Ui(),!tt()&&(null===(f=null===(s=window.chrome)||void 0===s?void 0:s.webview)||void 0===f||f.registerTextureStream(t,y)),w.t0=wr,w.next=5,Ni(t,l,c);case 5:w.t1=w.sent,w.t2=new da(l,a),w.t3=y.writable,(0,w.t0)(w.t1,w.t2,w.t3);case 9:case"end":return w.stop()}},m)}))}function xi(t,a,l,c){var s,f;return qt(this,void 0,void 0,Q().mark(function m(){var y;return Q().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return y=Ui(),!tt()&&(null===(f=null===(s=window.chrome)||void 0===s?void 0:s.webview)||void 0===f||f.registerTextureStream(t,y)),w.t0=wr,w.next=5,Ni(t,l,c);case 5:w.t1=w.sent,w.t2=new pa(l,a),w.t3=y.writable,(0,w.t0)(w.t1,w.t2,w.t3);case 9:case"end":return w.stop()}},m)}))}function Ni(t,a,l){return qt(this,void 0,void 0,Q().mark(function c(){var s,f;return Q().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!tt()){y.next=2;break}throw k;case 2:return s=xt().chrome,y.prev=3,l?.reportGettingTextureStream(t),y.next=7,s.webview.getTextureStream(t);case 7:if(0!==(f=y.sent.getVideoTracks()).length){y.next=10;break}throw new Error("No video track in stream "+t);case 10:return y.abrupt("return",(l?.reportTextureStreamAcquired(),f[0]));case 13:throw y.prev=13,y.t0=y.catch(3),a("Failed to get video track from stream "+t+", error: "+y.t0),new Error("Internal error: can't get video track from stream "+t);case 16:case"end":return y.stop()}},c,null,[[3,13]])}))}function Ui(){if(tt())throw k;var t=window.MediaStreamTrackGenerator;if(!t)throw k;return new t({kind:"video"})}function wr(t,a,l){new(xt().MediaStreamTrackProcessor)({track:t}).readable.pipeThrough(new TransformStream(a)).pipeTo(l)}!function(t){t.TimestampIsNull="timestamp of the original video frame is null",t.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Dt||(Dt={}));var da=function(a,l){var c=this;this.notifyError=a,this.videoFrameHandler=l,this.transform=function(s,f){return qt(c,void 0,void 0,Q().mark(function m(){var y,b,w;return Q().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(null===(y=s.timestamp)){P.next=15;break}return P.prev=2,P.next=5,this.videoFrameHandler({videoFrame:s});case 5:b=P.sent,w=new VideoFrame(b,{timestamp:y}),f.enqueue(w),s.close(),b.close(),P.next=13;break;case 10:P.prev=10,P.t0=P.catch(2),s.close(),this.notifyError(P.t0);case 13:P.next=16;break;case 15:this.notifyError(Dt.TimestampIsNull);case 16:case"end":return P.stop()}},m,this,[[2,10]])}))}},yr=function(){function t(a,l){if(this.headerBuffer=a,this.notifyError=l,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(a),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return ce(t,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),t}(),Hi=function(){function t(a,l){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var c=new Uint32Array(a),s=0,f=0;s<l;s++){var m=c[f++],y=c[f++],b=c[f++],w=new Uint8Array(a,y,b);this.metadataMap.set(m,w)}}return ce(t,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),t}(),pa=function(a,l){var c=this;this.notifyError=a,this.videoFrameHandler=l,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(s,f){return qt(c,void 0,void 0,Q().mark(function m(){var y,b,w,v,A,M,ne;return Q().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(null===(y=s.timestamp)){R.next=22;break}return R.prev=2,R.next=5,this.extractVideoFrameAndMetadata(s);case 5:return w=(b=R.sent).videoFrame,A=(void 0===(v=b.metadata)?{}:v).audioInferenceResult,R.next=12,this.videoFrameHandler({videoFrame:w,audioInferenceResult:A});case 12:M=R.sent,ne=new VideoFrame(M,{timestamp:y}),f.enqueue(ne),w.close(),s.close(),M.close(),R.next=20;break;case 17:R.prev=17,R.t0=R.catch(2),s.close(),this.notifyError(R.t0);case 20:R.next=23;break;case 22:this.notifyError(Dt.TimestampIsNull);case 23:case"end":return R.stop()}},m,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(s){return qt(c,void 0,void 0,Q().mark(function f(){var m,y,b,w,v,P;return Q().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!tt()){M.next=2;break}throw k;case 2:if("NV12"===s.format){M.next=4;break}throw this.notifyError(Dt.UnsupportedVideoFramePixelFormat),new Error(Dt.UnsupportedVideoFramePixelFormat);case 4:return m={x:0,y:0,width:s.codedWidth,height:2},y=new ArrayBuffer(m.width*m.height*3/2),M.next=7,s.copyTo(y,{rect:m});case 7:return b=new yr(y,this.notifyError),w={x:0,y:b.multiStreamHeaderRowOffset,width:s.codedWidth,height:s.codedHeight-b.multiStreamHeaderRowOffset},v=new ArrayBuffer(w.width*w.height*3/2),M.next=10,s.copyTo(v,{rect:w});case 10:return P=new Hi(v,b.multiStreamCount),M.abrupt("return",{videoFrame:new VideoFrame(s,{timestamp:s.timestamp,visibleRect:{x:0,y:b.frameRowOffset,width:b.frameWidth,height:b.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:P.audioInferenceResult}});case 12:case"end":return M.stop()}},f,this)}))},Y("video.mediaStream.audioInferenceDiscardStatusChange",function(s){c.shouldDiscardAudioInferenceResult=s.discardAudioInferenceResult})};function Vi(t,a){return function(l,c){a?.reportApplyingVideoEffect(l||"",c),t(l,c).then(function(){a?.reportVideoEffectChanged(l||"",c),W("video.videoEffectReadiness",[!0,l,void 0,c])}).catch(function(s){W("video.videoEffectReadiness",[!1,l,s in Rt.EffectFailureReason?s:Rt.EffectFailureReason.InitializationFailure,c])})}}var _t=function(){function t(){}return t.setTimeout=function(l,c){var s=performance.now(),f=Nr();return t.setTimeoutCallbacks[f]={callback:l,timeoutInMs:c,startedAtInMs:s},f},t.clearTimeout=function(l){delete t.setTimeoutCallbacks[l]},t.setInterval=function(l,c){t.setTimeout(function s(){l(),t.setTimeout(s,c)},c)},t.tick=function(){var l=performance.now(),c=[];for(var s in t.setTimeoutCallbacks){var f=t.setTimeoutCallbacks[s];l-f.startedAtInMs>=f.timeoutInMs&&c.push(s)}for(var m=0,y=c;m<y.length;m++){var b=y[m];t.setTimeoutCallbacks[b].callback(),delete t.setTimeoutCallbacks[b]}},t}();_t.setTimeoutCallbacks={};var Cr=function(){function t(l,c){this.reportStatisticsResult=c,this.sampleCount=0,this.distributionBins=new Uint32Array(l)}var a=t.prototype;return a.processStarts=function(c,s,f,m){_t.tick(),this.suitableForThisSession(c,s,f,m)||this.reportAndResetSession(this.getStatistics(),c,m,s,f),this.start()},a.processEnds=function(){var c=performance.now()-this.frameProcessingStartedAt,s=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,c)));this.distributionBins[s]+=1,this.sampleCount+=1},a.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},a.start=function(){this.frameProcessingStartedAt=performance.now()},a.suitableForThisSession=function(c,s,f,m){return this.currentSession&&this.currentSession.effectId===c&&this.currentSession.effectParam===m&&this.currentSession.frameWidth===s&&this.currentSession.frameHeight===f},a.reportAndResetSession=function(c,s,f,m,y){var b=this;c&&this.reportStatisticsResult(c),this.resetCurrentSession(this.getNextTimeout(s,this.currentSession),s,f,m,y),this.timeoutId&&_t.clearTimeout(this.timeoutId),this.timeoutId=_t.setTimeout(function(){return b.reportAndResetSession(b.getStatistics(),s,f,m,y)}.bind(this),this.currentSession.timeoutInMs)},a.resetCurrentSession=function(c,s,f,m,y){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:c,effectId:s,effectParam:f,frameWidth:m,frameHeight:y},this.sampleCount=0,this.distributionBins.fill(0)},a.getNextTimeout=function(c,s){return s&&s.effectId===c?Math.min(t.maxSessionTimeoutInMs,2*s.timeoutInMs):t.initialSessionTimeoutInMs},t}();Cr.initialSessionTimeoutInMs=1e3,Cr.maxSessionTimeoutInMs=3e4;var Hn=function(){function t(l){var c=this;this.reportPerformanceEvent=l,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Cr(t.distributionBinSize,function(s){return c.reportPerformanceEvent("video.performance.performanceDataGenerated",[s])})}var a=t.prototype;return a.startMonitorSlowFrameProcessing=function(){var c=this;_t.setInterval(function(){if(0!==c.processedFrameCount){var s=c.frameProcessingTimeCost/c.processedFrameCount;s>c.frameProcessTimeLimit&&c.reportPerformanceEvent("video.performance.frameProcessingSlow",[s]),c.frameProcessingTimeCost=0,c.processedFrameCount=0}},t.calculateFPSInterval)},a.setFrameProcessTimeLimit=function(c){this.frameProcessTimeLimit=c},a.reportApplyingVideoEffect=function(c,s){var f,m;(null===(f=this.applyingEffect)||void 0===f?void 0:f.effectId)===c&&(null===(m=this.applyingEffect)||void 0===m?void 0:m.effectParam)===s||(this.applyingEffect={effectId:c,effectParam:s},this.appliedEffect=void 0)},a.reportVideoEffectChanged=function(c,s){void 0===this.applyingEffect||this.applyingEffect.effectId!==c&&this.applyingEffect.effectParam!==s||(this.appliedEffect={effectId:c,effectParam:s},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},a.reportStartFrameProcessing=function(c,s){_t.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,c,s,this.appliedEffect.effectParam))},a.reportFrameProcessed=function(){var c;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(c=this.appliedEffect)||void 0===c?void 0:c.effectParam])))},a.reportGettingTextureStream=function(c){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=c},a.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var c=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,c])}},t}();Hn.distributionBinSize=1e3,Hn.calculateFPSInterval=1e3;var Rt,Vn,br,Sr,Pr=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})};(function(t){var N,a=tt()?void 0:new Hn(W);function m(N){W("video.notifyError",[N])}function y(){return C(p)&&!!p.supports.video&&(!!p.supports.video.mediaStream||!!p.supports.video.sharedFrame)}function w(N,R){var V=this;return function(z){return Pr(V,void 0,void 0,Q().mark(function L(){var ie,pe;return Q().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return ie=z.videoFrame,R?.reportStartFrameProcessing(ie.codedWidth,ie.codedHeight),Ze.next=4,N(z);case 4:return pe=Ze.sent,Ze.abrupt("return",(R?.reportFrameProcessed(),pe));case 6:case"end":return Ze.stop()}},L)}))}}function v(N,R){if(C(p,h.sidePanel),!y()||!ne())throw k;Y("video.newVideoFrame",function(V){if(V){var z=V.timestamp;a?.reportStartFrameProcessing(V.width,V.height),N(function(N){if("videoFrameBuffer"in N)return N;var R=N.data,V=function(a,l){var c={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&l.indexOf(s)<0&&(c[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)l.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(c[s[f]]=a[s[f]])}return c}(N,["data"]);return Object.assign(Object.assign({},V),{videoFrameBuffer:R})}(V),function(){a?.reportFrameProcessed(),function(N){W("video.videoFrameProcessed",[N])}(z)},m)}},!1),W("video.registerForVideoFrame",[R])}function A(){var N;return C(p,h.sidePanel)&&function(){var N,R,V,z;return!(null===(R=null===(N=xt().chrome)||void 0===N?void 0:N.webview)||void 0===R||!R.getTextureStream||null===(z=null===(V=xt().chrome)||void 0===V?void 0:V.webview)||void 0===z||!z.registerTextureStream)}()&&!(null===(N=p.supports.video)||void 0===N||!N.mediaStream)}function ne(){var N;return C(p,h.sidePanel)&&!(null===(N=p.supports.video)||void 0===N||!N.sharedFrame)}(t.VideoFrameFormat||(t.VideoFrameFormat={})).NV12="NV12",(N=t.EffectChangeType||(t.EffectChangeType={})).EffectChanged="EffectChanged",N.EffectDisabled="EffectDisabled",function(N){N.InvalidEffectId="InvalidEffectId",N.InitializationFailure="InitializationFailure"}(t.EffectFailureReason||(t.EffectFailureReason={})),t.registerForVideoFrame=function(N){if(C(p,h.sidePanel),!y())throw k;if(!N.videoFrameHandler||!N.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Y("video.setFrameProcessTimeLimit",function(R){return a?.setFrameProcessTimeLimit(R.timeLimit)},!1),A())!function(N,R){var V=this;if(C(p,h.sidePanel),!y()||!A())throw k;Y("video.startVideoExtensibilityVideoStream",function(z){return Pr(V,void 0,void 0,Q().mark(function L(){var ie,pe;return Q().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return ie=z.streamId,pe=w(N,a),Ze.next=3,Li(ie,pe,m,a);case 3:case"end":return Ze.stop()}},L)}))},!1),W("video.mediaStream.registerForVideoFrame",[R])}(N.videoFrameHandler,N.config);else{if(!ne())throw k;v(N.videoBufferHandler,N.config)}a?.startMonitorSlowFrameProcessing()},t.notifySelectedVideoEffectChanged=function(N,R){if(C(p,h.sidePanel),!y())throw k;W("video.videoEffectChanged",[N,R])},t.registerForVideoEffect=function(N){if(C(p,h.sidePanel),!y())throw k;Y("video.effectParameterChange",Vi(N,a),!1),W("video.registerForVideoEffect")},t.isSupported=y})(Rt||(Rt={})),function(t){var a="search.queryChange",l="search.queryClose",c="search.queryExecute";function s(){return!(!C(p)||!p.supports.search)}t.registerHandlers=function(f,m,y){if(C(p,h.content),!s())throw k;Y(l,f),Y(c,m),y&&Y(a,y)},t.unregisterHandlers=function(){if(C(p,h.content),!s())throw k;W("search.unregister"),_e(a),_e(l),_e(c)},t.isSupported=s,t.closeSearch=function(){return new Promise(function(f){if(C(p,h.content),!s())throw new Error("Not supported");f(It("search.closeSearch"))})}}(Vn||(Vn={})),function(t){function a(m){return new Promise(function(y){if(!f())throw k;y(xe(t.SharingAPIMessages.shareWebContent,m))})}function f(){return!(!C(p)||!p.supports.sharing)}t.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},t.shareWebContent=function(m,y){try{(function(m){if(!(m&&m.content&&m.content.length))throw{errorCode:F.INVALID_ARGUMENTS,message:"Shared content is missing"}})(m),function(m){if(m.content.some(function(b){return!b.type}))throw{errorCode:F.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(m.content.some(function(b){return b.type!==m.content[0].type}))throw{errorCode:F.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(m),function(m){if("URL"!==m.content[0].type)throw{errorCode:F.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(m.content.some(function(b){return!b.url}))throw{errorCode:F.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(m)}catch(b){return Hr(function(){return Promise.reject(b)},y)}return C(p,h.content,h.sidePanel,h.task,h.stage,h.meetingStage),Hr(a,y,m)},t.isSupported=f}(br||(br={})),function(t){var c;function l(){return!(!C(p)||!p.supports.stageView)}(c=t.StageViewOpenMode||(t.StageViewOpenMode={})).modal="modal",c.popout="popout",c.popoutWithChat="popoutWithChat",t.open=function(c){return new Promise(function(s){if(C(p,h.content),!l())throw k;if(!c)throw new Error("[stageView.open] Stage view params cannot be null");s(xe("stageView.open",c))})},t.isSupported=l}(Sr||(Sr={}));var Er,Ar,Wi=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})};(function(t){var c,s;(s=t.CameraRestriction||(t.CameraRestriction={}))[s.FrontOrRear=1]="FrontOrRear",s[s.FrontOnly=2]="FrontOnly",s[s.RearOnly=3]="RearOnly",function(s){s[s.Camera=1]="Camera",s[s.Gallery=2]="Gallery"}(t.Source||(t.Source={})),t.hasPermission=function(){if(C(p,h.content,h.task),!c.isSupported())throw k;return xe("permissions.has",Z.Media)},t.requestPermission=function(){if(C(p,h.content,h.task),!c.isSupported())throw k;return xe("permissions.request",Z.Media)},function(s){function f(){return!!(C(p)&&p.supports.visualMedia&&p.supports.visualMedia.image&&p.supports.permissions)}function m(){if(!f())throw k}function y(w){if(!w||w.maxVisualMediaCount>10||w.maxVisualMediaCount<1)throw go}function b(w,v){if(v.length>w)throw vo}s.captureImages=function(w){return Wi(this,void 0,void 0,Q().mark(function v(){var P;return Q().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return C(p,h.content,h.task),m(),y(w),M.next=3,xe("visualMedia.image.captureImages",w);case 3:return M.abrupt("return",(b(w.maxVisualMediaCount,P=M.sent),P));case 5:case"end":return M.stop()}},v)}))},s.retrieveImages=function(w){return Wi(this,void 0,void 0,Q().mark(function v(){var P;return Q().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return C(p,h.content,h.task),m(),y(w),M.next=3,xe("visualMedia.image.retrieveImages",w);case 3:return M.abrupt("return",(b(w.maxVisualMediaCount,P=M.sent),P));case 5:case"end":return M.stop()}},v)}))},s.isSupported=f}(c=t.image||(t.image={}))})(Er||(Er={})),function(t){function a(){return!(!C(p)||!p.supports.webStorage)}t.isWebStorageClearedOnUserLogOut=function(){return C(p),a()},t.isSupported=a}(Ar||(Ar={}));var Ir,Dr,ha=oe.V_2;(function(t){var a,c;function l(){return!(!C(p)||!p.supports.call)}(c=a=t.CallModalities||(t.CallModalities={})).Unknown="unknown",c.Audio="audio",c.Video="video",c.VideoBasedScreenSharing="videoBasedScreenSharing",c.Data="data",t.startCall=function(c){var s=D(ha,E.Call_StartCall);return new Promise(function(f){var m;if(C(p,h.content,h.task),!l())throw k;if(!p.isLegacyTeams)return ae(s,"call.startCall",[c],f);f(tn(s,"executeDeepLink",function(t,a,l){if(0===t.length)throw new Error("Must have at least one target when creating a call deep link");var c="users="+t.map(function(m){return encodeURIComponent(m)}).join(","),s=void 0===a?"":"&withVideo="+encodeURIComponent(a),f=void 0===l?"":"&source="+encodeURIComponent(l);return Te+"://"+ge+"/l/call/0/0?"+c+s+f}(c.targets,null===(m=c.requestedModalities)||void 0===m?void 0:m.includes(a.Video),c.source)).then(function(y){if(!y)throw new Error("The call was not properly started");return y}))})},t.isSupported=l})(Ir||(Ir={})),function(t){t.Messages=st.Messages,t.FailedReason=st.FailedReason,t.ExpectedFailureReason=st.ExpectedFailureReason,t.notifyAppLoaded=function(){st.notifyAppLoaded()},t.notifySuccess=function(){st.notifySuccess()},t.notifyFailure=function(a){st.notifyFailure(a)},t.notifyExpectedFailure=function(a){st.notifyExpectedFailure(a)}}(Dr||(Dr={}));var Bn,Gi=re("thirdPartyCloudStorage");!function(t){var a=[],l={fileType:"",assembleAttachment:[]},c=!0,s=null;function f(y){if(s)if(y&&y.error)s([],y.error),s=null;else if(y&&y.fileChunk)try{c||0!==y.fileChunk.chunkSequence||(Gi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),c=!0,s([],{errorCode:F.INTERNAL_ERROR,message:"error occurred while receiving data"}),a=[],s=null);var b=On(y.fileChunk,y.fileType);if(b?l.assembleAttachment.push(b):(Gi("Received a null assemble attachment for when decoding chunk sequence "+y.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),s?s([],{errorCode:F.INTERNAL_ERROR,message:"error occurred while receiving data"}):s=null,a=[],s=null,c=!0),c=y.fileChunk.endOfFile,y.fileChunk.endOfFile){var w=on(l.assembleAttachment,l.fileType);if(w){var v=new File([w],y.fileName,{type:w.type});a.push(v)}y.isLastFile&&s&&(s(a,y.error),a=[],s=null,c=!0),l={fileType:"",assembleAttachment:[]}}}catch(P){s&&(s([],{errorCode:F.INTERNAL_ERROR,message:P}),a=[],s=null,c=!0)}else s([],{errorCode:F.INTERNAL_ERROR,message:"data received is null"}),a=[],s=null,c=!0}function m(){return!(!C(p)||!p.supports.thirdPartyCloudStorage)}t.getDragAndDropFiles=function(y,b){if(!b)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(y&&""!==y){if(C(p,h.content,h.task),!m())throw k;if(s)throw s=null,new Error("getDragAndDropFiles cannot be called twice");s=b,c=!0,W("thirdPartyCloudStorage.getDragAndDropFiles",[y],f)}else b([],{errorCode:F.INVALID_ARGUMENTS})},t.isSupported=m}(Bn||(Bn={}));var Ge=oe.V_1;function zi(t,a){zt(D(Ge,E.PublicAPIs_Initialize),a).then(function(){t&&t()})}function ji(){Bt.enablePrintCapability()}function Qi(){Bt.print()}function qi(t){gt(),ae(D(Ge,E.PublicAPIs_GetContext),"getContext",function(a){a.frameContext||(a.frameContext=H.frameContext),t(a)})}function ga(t){ve(D(Ge,E.PublicAPIs_RegisterOnThemeChangeHandlerHelper),t)}function Wn(t){rt(D(Ge,E.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",t,[])}function va(t){rt(D(Ge,E.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",t,[h.content])}function cn(t){rt(D(Ge,E.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",t,[h.content])}function _i(t){rt(D(Ge,E.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",t,[h.content])}function $i(t){We.backStack.registerBackButtonHandlerHelper(D(Ge,E.PublicAPIs_RegisterBackButtonHandler),t)}function Ji(t){Bt.registerOnLoadHandlerHelper(t)}function Zi(t){Bt.registerBeforeUnloadHandlerHelper(t)}function Xi(t){rt(D(Ge,E.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",t,[])}function Rr(t){rt(D(Ge,E.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",t,[h.content])}function Yi(t,a){C(p),oi(D(Ge,E.PublicAPIs_GetTabInstances),a).then(function(l){t(l)})}function Ki(t,a){C(p),ai(D(Ge,E.PublicAPIs_GetMruTabInstances),a).then(function(l){t(l)})}function wt(t){si(D(Ge,E.PublicAPIs_ShareDeepLink),{subPageId:t.subEntityId,subPageLabel:t.subEntityLabel,subPageWebUrl:t.subEntityWebUrl})}function Ne(t,a){C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage);var l=a??St();fe(D(Ge,E.PublicAPIs_ExecuteDeepLink),t).then(function(){l(!0)}).catch(function(c){l(!1,c.message)})}function Tr(t){tr(D(Ge,E.PublicAPIs_SetFrameContext),t)}function eo(t,a,l){zt(D(Ge,E.PublicAPIs_Initialize),l).then(function(){return a&&a()}),tr(D(Ge,E.PublicAPIs_SetFrameContext),t)}var Tt,fn=oe.V_1;function to(t){ii(D(fn,E.Navigation_ReturnFocus),t)}function no(t,a){C(p);var l=a??St();ri(D(fn,E.Navigation_NavigateToTab),t).then(function(){l(!0)}).catch(function(c){l(!1,c.message)})}function ro(t,a){C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage);var l=a??St();ti(D(fn,E.Navigation_NavigateCrossDomain),t).then(function(){l(!0)}).catch(function(c){l(!1,c.message)})}function $t(t){C(p);var a=t??St();ni(D(fn,E.Navigation_NavigateBack)).then(function(){a(!0)}).catch(function(l){a(!1,l.message)})}!function(t){t.setValidityState=function(a){We.config.setValidityState(a)},t.getSettings=function(a){C(p,h.content,h.settings,h.remove,h.sidePanel),We.getConfig().then(function(l){a(l)})},t.setSettings=function(a,l){C(p,h.content,h.settings,h.sidePanel);var c=l??St();We.config.setConfig(a).then(function(){c(!0)}).catch(function(s){c(!1,s.message)})},t.registerOnSaveHandler=function(a){We.config.registerOnSaveHandlerHelper(a)},t.registerOnRemoveHandler=function(a){We.config.registerOnRemoveHandlerHelper(a)}}(Tt||(Tt={}));var Fr,Gn,kr=oe.V_1;(function(t){function c(s){return s.height=s.height?s.height:Ot.Small,s.width=s.width?s.width:Ot.Small,s}t.startTask=function(s,f){var m=D(kr,E.Tasks_StartTask),y=f?function(b){var w,v;return f(null!==(w=b.err)&&void 0!==w?w:"",null!==(v=b.result)&&void 0!==v?v:"")}:void 0;return void 0===s.card&&void 0===s.url||s.card?(C(p,h.content,h.sidePanel,h.meetingStage),ae(m,"tasks.startTask",[s],f)):void 0!==s.completionBotId?er(m,function(s){if(void 0===s.url||void 0===s.completionBotId)throw new Error("Both url "+s.url+" and completionBotId "+s.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:s.url,size:{height:s.height?s.height:Ot.Small,width:s.width?s.width:Ot.Small},title:s.title,fallbackUrl:s.fallbackUrl,completionBotId:s.completionBotId}}(s),y):Xr(m,function(s){if(void 0===s.url)throw new Error("url property of taskInfo object can't be undefined");return{url:s.url,size:{height:s.height?s.height:Ot.Small,width:s.width?s.width:Ot.Small},title:s.title,fallbackUrl:s.fallbackUrl}}(s),y),new ki},t.updateTask=function(s){var b=function(a,l){var c={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&l.indexOf(s)<0&&(c[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)l.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(c[s[f]]=a[s[f]])}return c}(s=c(s),["width","height"]);if(Object.keys(b).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Zr(D(kr,E.Tasks_UpdateTask),s)},t.submitTask=function(s,f){Yr(D(kr,E.Tasks_SubmitTask),s,f)},t.getDefaultSizeIfNotProvided=c})(Fr||(Fr={})),function(t){var c;(c=t.UserMeetingRole||(t.UserMeetingRole={})).guest="Guest",c.attendee="Attendee",c.presenter="Presenter",c.organizer="Organizer",function(c){c.added="Added",c.alreadyExists="AlreadyExists",c.conflict="Conflict",c.notFound="NotFound"}(t.ContainerState||(t.ContainerState={})),t.isSupported=function(){return!(!C(p,h.meetingStage,h.sidePanel)||!p.supports.interactive)}}(Gn||(Gn={}));var wa=function(){function t(){}var a=t.prototype;return a.getFluidTenantInfo=function(){return yt(),new Promise(function(c){c(xe("interactive.getFluidTenantInfo"))})},a.getFluidToken=function(c){return yt(),new Promise(function(s){s(xe("interactive.getFluidToken",c))})},a.getFluidContainerId=function(){return yt(),new Promise(function(c){c(xe("interactive.getFluidContainerId"))})},a.setFluidContainerId=function(c){return yt(),new Promise(function(s){s(xe("interactive.setFluidContainerId",c))})},a.getNtpTime=function(){return yt(),new Promise(function(c){c(xe("interactive.getNtpTime"))})},a.registerClientId=function(c){return yt(),new Promise(function(s){s(xe("interactive.registerClientId",c))})},a.getClientRoles=function(c){return yt(),new Promise(function(s){s(xe("interactive.getClientRoles",c))})},a.getClientInfo=function(c){return yt(),new Promise(function(s){s(xe("interactive.getClientInfo",c))})},t.create=function(){return yt(),new t},t}();function yt(){if(!Gn.isSupported())throw new Error("LiveShareHost Not supported")}var ya=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function zn(t){try{return t.cartItems=oo(t.cartItems),t}catch{throw new Error("Error deserializing cart")}}function oo(t){return t.map(function(a){if(a.imageURL){var l=new URL(a.imageURL);a.imageURL=l}return a.accessories&&(a.accessories=oo(a.accessories)),a})}var ba=function t(a){try{return a.map(function(l){var c=l.imageURL,s=l.accessories,f=function(a,l){var c={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&l.indexOf(s)<0&&(c[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)l.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(c[s[f]]=a[s[f]])}return c}(l,["imageURL","accessories"]),m=Object.assign({},f);return c&&(m.imageURL=c.href),s&&(m.accessories=t(s)),m})}catch{throw new Error("Error serializing cart items")}};function Pa(t){if(null!=t){if(!Array.isArray(t)||0===t.length)throw new Error("CartItem.accessories must be a non-empty array");for(var l,a=X(t);!(l=a()).done;){var c=l.value;if(c.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");ao(c)}}}function ao(t){if(!t.id)throw new Error("cartItem.id must not be empty");if(!t.name)throw new Error("cartItem.name must not be empty");(function(t){if("number"!=typeof t||t<0)throw new Error("price "+t+" must be a number not less than 0");if(parseFloat(t.toFixed(3))!==t)throw new Error("price "+t+" must have at most 3 decimal places")})(t.price),function(t){if("number"!=typeof t||t<=0||parseInt(t.toString())!==t)throw new Error("quantity "+t+" must be an integer greater than 0")}(t.quantity)}function Mr(t){if(null!=t){if(!t)throw new Error("id must not be empty");if(!1===("string"==typeof(a=t)&&ya.test(a)))throw new Error("id must be a valid UUID")}var a}var pn,Or,hn,gn,vn,mn,jn,dn=oe.V_2;(function(t){var s;function c(){return!(!C(p)||!p.supports.marketplace)}t.cartVersion={majorVersion:1,minorVersion:1},(s=t.Intent||(t.Intent={})).TACAdminUser="TACAdminUser",s.TeamsAdminUser="TeamsAdminUser",s.TeamsEndUser="TeamsEndUser",function(s){s.Open="Open",s.Processing="Processing",s.Processed="Processed",s.Closed="Closed",s.Error="Error"}(t.CartStatus||(t.CartStatus={})),t.getCart=function(){if(C(p,h.content,h.task),!c())throw k;return Qe(D(dn,E.Marketplace_GetCart),"marketplace.getCart",t.cartVersion).then(zn)},t.addOrUpdateCartItems=function(s){if(C(p,h.content,h.task),!c())throw k;if(!s)throw new Error("addOrUpdateCartItemsParams must be provided");return Mr(s?.cartId),function(t){if(!Array.isArray(t)||0===t.length)throw new Error("cartItems must be a non-empty array");for(var l,a=X(t);!(l=a()).done;){var c=l.value;ao(c),Pa(c.accessories)}}(s?.cartItems),Qe(D(dn,E.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},s),{cartItems:ba(s.cartItems),cartVersion:t.cartVersion})).then(zn)},t.removeCartItems=function(s){if(C(p,h.content,h.task),!c())throw k;if(!s)throw new Error("removeCartItemsParams must be provided");if(Mr(s?.cartId),!Array.isArray(s?.cartItemIds)||0===s?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return Qe(D(dn,E.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},s),{cartVersion:t.cartVersion})).then(zn)},t.updateCartStatus=function(s){if(C(p,h.content,h.task),!c())throw k;if(!s)throw new Error("updateCartStatusParams must be provided");return Mr(s?.cartId),function(t){if(!Object.values(pn.CartStatus).includes(t))throw new Error("cartStatus "+t+" is not valid")}(s?.cartStatus),Qe(D(dn,E.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},s),{cartVersion:t.cartVersion})).then(zn)},t.isSupported=c})(pn||(pn={})),function(t){var l,s,y,a="Action.Execute";function f(y){if(y.requestType===l.ActionExecuteInvokeRequest){if(y.type!==a)throw{errorCode:s.INTERNAL_ERROR,message:"Invalid action type "+y.type+'. Action type must be "'+a+'"'}}else if(y.requestType===l.QueryMessageExtensionRequest){if(y.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(y.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var v,w=X(y.parameters);!(v=w()).done;){var P=v.value;if(P.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(P.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function m(){return!(!C(p)||!p.supports.externalAppAuthentication)}(y=l=t.OriginalRequestType||(t.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",y.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(y){y.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",y.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(t.InvokeResponseType||(t.InvokeResponseType={})),function(y){y.INTERNAL_ERROR="INTERNAL_ERROR"}(s=t.InvokeErrorCode||(t.InvokeErrorCode={})),t.authenticateAndResendRequest=function(y,b,w){if(C(p,h.content),!m())throw k;return Kt(y),f(w),it("externalAppAuthentication.authenticateAndResendRequest",[y,w,b.url.href,b.width,b.height,b.isExternal]).then(function(v){var A=v[1];if(v[0]&&null!=A.responseType)return A;throw A})},t.authenticateWithSSO=function(y,b){if(C(p,h.content),!m())throw k;return Kt(y),it("externalAppAuthentication.authenticateWithSSO",[y,b.claims,b.silent]).then(function(w){if(!w[0])throw w[1]})},t.authenticateWithSSOAndResendRequest=function(y,b,w){if(C(p,h.content),!m())throw k;return Kt(y),f(w),it("externalAppAuthentication.authenticateWithSSOAndResendRequest",[y,w,b.claims,b.silent]).then(function(v){var A=v[1];if(v[0]&&null!=A.responseType)return A;throw A})},t.isSupported=m}(Or||(Or={})),function(t){var f;function s(){return!(!C(p)||!p.supports.externalAppCardActions)}(f=t.ActionOpenUrlType||(t.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",f.DeepLinkOther="DeepLinkOther",f.DeepLinkStageView="DeepLinkStageView",f.GenericUrl="GenericUrl",function(f){f.INTERNAL_ERROR="INTERNAL_ERROR",f.INVALID_LINK="INVALID_LINK",f.NOT_SUPPORTED="NOT_SUPPORTED"}(t.ActionOpenUrlErrorCode||(t.ActionOpenUrlErrorCode={})),function(f){f.INTERNAL_ERROR="INTERNAL_ERROR"}(t.ActionSubmitErrorCode||(t.ActionSubmitErrorCode={})),t.processActionSubmit=function(f,m){if(C(p,h.content),!s())throw k;return Kt(f),it("externalAppCardActions.processActionSubmit",[f,m]).then(function(y){if(!y[0])throw y[1]})},t.processActionOpenUrl=function(f,m){if(C(p,h.content),!s())throw k;return Kt(f),it("externalAppCardActions.processActionOpenUrl",[f,m.href]).then(function(y){var b=y[0];if(b)throw b;return y[1]})},t.isSupported=s}(hn||(hn={})),function(t){var b;function y(b,w){return{errorCode:b,message:w}}(b=t.CloudStorageProvider||(t.CloudStorageProvider={})).Dropbox="DROPBOX",b.Box="BOX",b.Sharefile="SHAREFILE",b.GoogleDrive="GOOGLEDRIVE",b.Egnyte="EGNYTE",b.SharePoint="SharePoint",function(b){b[b.Sharepoint=0]="Sharepoint",b[b.WopiIntegration=1]="WopiIntegration",b[b.Google=2]="Google",b[b.OneDrive=3]="OneDrive",b[b.Recent=4]="Recent",b[b.Aggregate=5]="Aggregate",b[b.FileSystem=6]="FileSystem",b[b.Search=7]="Search",b[b.AllFiles=8]="AllFiles",b[b.SharedWithMe=9]="SharedWithMe"}(t.CloudStorageProviderType||(t.CloudStorageProviderType={})),function(b){b.ClassMaterials="classMaterials"}(t.SpecialDocumentLibraryType||(t.SpecialDocumentLibraryType={})),function(b){b.Readonly="readonly"}(t.DocumentLibraryAccessType||(t.DocumentLibraryAccessType={})),function(b){b.Downloaded="Downloaded",b.Downloading="Downloading",b.Failed="Failed"}(t.FileDownloadStatus||(t.FileDownloadStatus={})),function(b){b.Download="DOWNLOAD",b.Upload="UPLOAD",b.Delete="DELETE"}(t.CloudStorageProviderFileAction||(t.CloudStorageProviderFileAction={})),t.getCloudStorageFolders=function(b,w){if(C(p,h.content),!b||0===b.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!w)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");W("files.getCloudStorageFolders",[b],w)},t.addCloudStorageFolder=function(b,w){if(C(p,h.content),!b||0===b.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!w)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");W("files.addCloudStorageFolder",[b],w)},t.deleteCloudStorageFolder=function(b,w,v){if(C(p,h.content),!b)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!w)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!v)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");W("files.deleteCloudStorageFolder",[b,w],v)},t.getCloudStorageFolderContents=function(b,w,v){if(C(p,h.content),!b||!w)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!v)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in b&&!b.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");W("files.getCloudStorageFolderContents",[b,w],v)},t.openCloudStorageFile=function(b,w,v){if(C(p,h.content),!b||!w)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(b.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");W("files.openCloudStorageFile",[b,w,v])},t.getExternalProviders=function(b,w){if(void 0===b&&(b=!1),C(p,h.content),!w)throw new Error("[files.getExternalProviders] Callback cannot be null");W("files.getExternalProviders",[b],w)},t.copyMoveFiles=function(b,w,v,P,A,M){if(void 0===A&&(A=!1),C(p,h.content),!b||0===b.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!w)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!v)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!P)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!M)throw new Error("[files.copyMoveFiles] callback cannot be null");W("files.copyMoveFiles",[b,w,v,P,A],M)},t.getFileDownloads=function(b){if(C(p,h.content),!b)throw new Error("[files.getFileDownloads] Callback cannot be null");W("files.getFileDownloads",[],b)},t.openDownloadFolder=function(b,w){if(void 0===b&&(b=void 0),C(p,h.content),!w)throw new Error("[files.openDownloadFolder] Callback cannot be null");W("files.openDownloadFolder",[b],w)},t.addCloudStorageProvider=function(b){if(C(p,h.content),!b)throw y(F.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");W("files.addCloudStorageProvider",[],b)},t.removeCloudStorageProvider=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!b||!b.content)throw y(F.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");W("files.removeCloudStorageProvider",[b],w)},t.addCloudStorageProviderFile=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!b||!b.content)throw y(F.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");W("files.addCloudStorageProviderFile",[b],w)},t.renameCloudStorageProviderFile=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!b||!b.content)throw y(F.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");W("files.renameCloudStorageProviderFile",[b],w)},t.deleteCloudStorageProviderFile=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(b&&b.content&&b.content.itemList&&b.content.itemList.length>0))throw y(F.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");W("files.deleteCloudStorageProviderFile",[b],w)},t.downloadCloudStorageProviderFile=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(b&&b.content&&b.content.itemList&&b.content.itemList.length>0))throw y(F.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");W("files.downloadCloudStorageProviderFile",[b],w)},t.uploadCloudStorageProviderFile=function(b,w){if(C(p,h.content),!w)throw y(F.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(b&&b.content&&b.content.itemList&&b.content.itemList.length>0))throw y(F.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!b.content.destinationFolder)throw y(F.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");W("files.uploadCloudStorageProviderFile",[b],w)},t.registerCloudStorageProviderListChangeHandler=function(b){if(C(p),!b)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Y("files.cloudStorageProviderListChange",b)},t.registerCloudStorageProviderContentChangeHandler=function(b){if(C(p),!b)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Y("files.cloudStorageProviderContentChange",b)}}(gn||(gn={})),function(t){function a(){return!(!C(p)||!p.supports.meetingRoom)}t.getPairedMeetingRoomInfo=function(){return new Promise(function(l){if(C(p),!a())throw k;l(xe("meetingRoom.getPairedMeetingRoomInfo"))})},t.sendCommandToPairedMeetingRoom=function(l){return new Promise(function(c){if(!l||0==l.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(C(p),!a())throw k;c(xe("meetingRoom.sendCommandToPairedMeetingRoom",l))})},t.registerMeetingRoomCapabilitiesUpdateHandler=function(l){if(!l)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(C(p),!a())throw k;Y("meetingRoom.meetingRoomCapabilitiesUpdate",function(c){C(p),l(c)})},t.registerMeetingRoomStatesUpdateHandler=function(l){if(!l)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(C(p),!a())throw k;Y("meetingRoom.meetingRoomStatesUpdate",function(c){C(p),l(c)})},t.isSupported=a}(vn||(vn={})),function(t){function a(){return!(!C(p)||!p.supports.notifications)}t.showNotification=function(l){if(C(p,h.content),!a())throw k;W("notifications.showNotification",[l])},t.isSupported=a}(mn||(mn={})),function(t){var f;function s(){return!(!C(p)||!p.supports.remoteCamera)}(f=t.ControlCommand||(t.ControlCommand={})).Reset="Reset",f.ZoomIn="ZoomIn",f.ZoomOut="ZoomOut",f.PanLeft="PanLeft",f.PanRight="PanRight",f.TiltUp="TiltUp",f.TiltDown="TiltDown",function(f){f[f.CommandResetError=0]="CommandResetError",f[f.CommandZoomInError=1]="CommandZoomInError",f[f.CommandZoomOutError=2]="CommandZoomOutError",f[f.CommandPanLeftError=3]="CommandPanLeftError",f[f.CommandPanRightError=4]="CommandPanRightError",f[f.CommandTiltUpError=5]="CommandTiltUpError",f[f.CommandTiltDownError=6]="CommandTiltDownError",f[f.SendDataError=7]="SendDataError"}(t.ErrorReason||(t.ErrorReason={})),function(f){f[f.None=0]="None",f[f.ControlDenied=1]="ControlDenied",f[f.ControlNoResponse=2]="ControlNoResponse",f[f.ControlBusy=3]="ControlBusy",f[f.AckTimeout=4]="AckTimeout",f[f.ControlTerminated=5]="ControlTerminated",f[f.ControllerTerminated=6]="ControllerTerminated",f[f.DataChannelError=7]="DataChannelError",f[f.ControllerCancelled=8]="ControllerCancelled",f[f.ControlDisabled=9]="ControlDisabled",f[f.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(t.SessionTerminatedReason||(t.SessionTerminatedReason={})),t.getCapableParticipants=function(f){if(!f)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(C(p,h.sidePanel),!s())throw k;W("remoteCamera.getCapableParticipants",f)},t.requestControl=function(f,m){if(!f)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!m)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(C(p,h.sidePanel),!s())throw k;W("remoteCamera.requestControl",[f],m)},t.sendControlCommand=function(f,m){if(!f)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!m)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(C(p,h.sidePanel),!s())throw k;W("remoteCamera.sendControlCommand",[f],m)},t.terminateSession=function(f){if(!f)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(C(p,h.sidePanel),!s())throw k;W("remoteCamera.terminateSession",f)},t.registerOnCapableParticipantsChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw k;Y("remoteCamera.capableParticipantsChange",f)},t.registerOnErrorHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw k;Y("remoteCamera.handlerError",f)},t.registerOnDeviceStateChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw k;Y("remoteCamera.deviceStateChange",f)},t.registerOnSessionStatusChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw k;Y("remoteCamera.sessionStatusChange",f)},t.isSupported=s}(jn||(jn={}));var Jt,wn,uo=oe.V_1;(function(t){function a(){return!(!C(p)||!p.supports.appEntity)}t.selectAppEntity=function(l,c,s,f){if(C(p,h.content),!a())throw k;if(!l||0==l.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!f)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");ae(D(uo,E.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[l,c,s],f)},t.isSupported=a})(Jt||(Jt={})),function(t){var s;function c(){return!(!C(p)||!p.supports.teams)}(s=t.ChannelType||(t.ChannelType={}))[s.Regular=0]="Regular",s[s.Private=1]="Private",s[s.Shared=2]="Shared",t.getTeamChannels=function(s,f){if(C(p,h.content),!c())throw k;if(!s)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!f)throw new Error("[teams.getTeamChannels] Callback cannot be null");W("teams.getTeamChannels",[s],f)},t.refreshSiteUrl=function(s,f){if(C(p),!c())throw k;if(!s)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!f)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");W("teams.refreshSiteUrl",[s],f)},t.isSupported=c,function(s){function m(){return!(!C(p)||!p.supports.teams||!p.supports.teams.fullTrust)}(function(y){function b(){return!!(C(p)&&p.supports.teams&&p.supports.teams.fullTrust&&p.supports.teams.fullTrust.joinedTeams)}y.getUserJoinedTeams=function(w){return new Promise(function(v){if(C(p),!b())throw k;if((H.hostClientType===x.android||H.hostClientType===x.teamsRoomsAndroid||H.hostClientType===x.teamsPhones||H.hostClientType===x.teamsDisplays)&&!nt("2.0.1"))throw new Error(JSON.stringify({errorCode:F.OLD_PLATFORM}));v(Tn("getUserJoinedTeams",w))})},y.isSupported=b})(s.joinedTeams||(s.joinedTeams={})),s.getConfigSetting=function(y){return new Promise(function(b){if(C(p),!m())throw k;b(Tn("getConfigSetting",y))})},s.isSupported=m}(t.fullTrust||(t.fullTrust={}))}(wn||(wn={}));var Qn,lo=function(a,l,c,s){return new(c||(c=Promise))(function(m,y){function b(P){try{v(s.next(P))}catch(A){y(A)}}function w(P){try{v(s.throw(P))}catch(A){y(A)}}function v(P){P.done?m(P.value):function(m){return m instanceof c?m:new c(function(y){y(m)})}(P.value).then(b,w)}v((s=s.apply(a,l||[])).next())})};!function(t){t.frameProcessingTimeoutInMs=2e3;var l,w,a=tt()?void 0:new Hn(W);function c(){var w=setTimeout(function(){b("Frame not processed in "+t.frameProcessingTimeoutInMs+"ms",l.Warn)},t.frameProcessingTimeoutInMs);return function(){clearTimeout(w)}}function s(w,v){var P=this;return function(A){return lo(P,void 0,void 0,Q().mark(function M(){var ne,N,R;return Q().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return v.reportStartFrameProcessing((ne=A.videoFrame).codedWidth,ne.codedHeight),N=c(),z.next=5,w(A);case 5:return R=z.sent,z.abrupt("return",(N(),v.reportFrameProcessed(),R));case 7:case"end":return z.stop()}},M)}))}}function m(){return C(p),Rt.isSupported()}function b(w,v){void 0===v&&(v=l.Warn),W("video.notifyError",[w,v])}(w=l=t.ErrorLevel||(t.ErrorLevel={})).Fatal="fatal",w.Warn="warn",t.registerForVideoFrame=function(w){var P,A,v=this;if(!m())throw k;if(!w.videoFrameHandler||!w.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(C(p,h.sidePanel)){if(Y("video.setFrameProcessTimeLimit",function(M){return a?.setFrameProcessTimeLimit(M)},!1),null===(P=p.supports.video)||void 0===P?void 0:P.mediaStream)Y("video.startVideoExtensibilityVideoStream",function(M){return lo(v,void 0,void 0,Q().mark(function ne(){var N,R,V;return Q().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(N=M.streamId,R=M.metadataInTexture,V=a?s(w.videoFrameHandler,a):w.videoFrameHandler,!R){L.next=6;break}return L.next=4,xi(N,V,b,a);case 4:L.next=8;break;case 6:return L.next=8,Li(N,V,b,a);case 8:case"end":return L.stop()}},ne)}))},!1),W("video.mediaStream.registerForVideoFrame",[w.config]);else{if(null===(A=p.supports.video)||void 0===A||!A.sharedFrame)throw k;Y("video.newVideoFrame",function(M){if(M){a?.reportStartFrameProcessing(M.width,M.height);var ne=c(),N=M.timestamp;w.videoBufferHandler(function(w){return w.videoFrameBuffer=w.videoFrameBuffer||w.data,delete w.data,w}(M),function(){ne(),a?.reportFrameProcessed(),function(w){W("video.videoFrameProcessed",[w])}(N)},b)}},!1),W("video.registerForVideoFrame",[w.config])}a?.startMonitorSlowFrameProcessing()}},t.notifySelectedVideoEffectChanged=function(w,v,P){if(C(p,h.sidePanel),!m())throw k;W("video.videoEffectChanged",[w,v,P])},t.registerForVideoEffect=function(w){if(C(p,h.sidePanel),!m())throw k;Y("video.effectParameterChange",Vi(w,a),!1),W("video.registerForVideoEffect")},t.updatePersonalizedEffects=function(w){if(C(p,h.sidePanel),!Rt.isSupported())throw k;W("video.personalizedEffectsChanged",[w])},t.isSupported=m,t.notifyFatalError=function(w){if(C(p),!Rt.isSupported())throw k;b(w,l.Fatal)}}(Qn||(Qn={}))}(),$e}()},30587:function(ue,ze,j){"use strict";j.r(ze),j.d(ze,{DataflowGen2PublishErrorModule:function(){return uu}});var de,e,De,Me,$e,he,re,D,J,x,Ae,h,ce=j(81337),Se=j(32293),X=j(74076),Q=j(38078);function te(e,n){return e.kind===n.kind}(e=de||(de={})).Cancel="Cancel",e.Commit="Commit",function(e){e.AlwaysCancel="AlwaysCancel",e.AlwaysCommit="AlwaysCommit",e.Ask="Ask"}(De||(De={})),function(e){e.Custom="Custom",e.Standard="Standard",e.System="System"}(Me||(Me={})),function(e){e.Action="Action.Type",e.Any="Any.Type",e.Binary="Binary.Type",e.Byte="Byte.Type",e.Character="Character.Type",e.Currency="Currency.Type",e.Date="Date.Type",e.DateTime="DateTime.Type",e.DateTimeZone="DateTimeZone.Type",e.Decimal="Decimal.Type",e.Double="Double.Type",e.Duration="Duration.Type",e.Function="Function.Type",e.Int16="Int16.Type",e.Int32="Int32.Type",e.Int64="Int64.Type",e.Int8="Int8.Type",e.List="List.Type",e.Logical="Logical.Type",e.None="None.Type",e.Null="Null.Type",e.Number="Number.Type",e.Percentage="Percentage.Type",e.Record="Record.Type",e.Single="Single.Type",e.Table="Table.Type",e.Text="Text.Type",e.Time="Time.Type",e.Type="Type.Type"}($e||($e={})),function(e){e[e.Fullscreen=0]="Fullscreen",e[e.LargeDialog=1]="LargeDialog",e[e.Panel=2]="Panel",e[e.SmallDialog=3]="SmallDialog"}(he||(he={})),function(e){e.SinglePage="SinglePage",e.Flow="Flow"}(re||(re={})),function(e){e.BrowseDataflow="BrowseDataflow",e.CreateDataflow="CreateDataflow",e.EditDataflow="EditDataflow",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.PublishErrorDialog="PublishErrorDialog",e.RefreshHistory="RefreshHistory"}(D||(D={})),window,function(e){e.GetEntityQueryScript="browseDataflowRpcMethodNames.getEntityQueryScript"}(J||(J={})),function(e){e.GenerateNewDataflowName="dataflowEditorRpcMethodNames.generateNewDataflowName",e.GetDataflowSensitivityLabel="dataflowEditorRpcMethodNames.getDataflowSensitivityLabel",e.GetInitialComputeEngineSettings="dataflowEditorRpcMethodNames.getInitialComputeEngineSettings",e.OnDataflowEditingSessionChanged="dataflowEditorRpcMethodNames.onDataflowEditingSessionChanged",e.OnDataflowEditingSessionInitialized="dataflowEditorRpcMethodNames.onDataflowEditingSessionInitialized",e.OnDataflowEditorClick="dataflowEditorRpcMethodNames.onDataflowEditorClick",e.RenameDataflow="dataflowEditorRpcMethodNames.renameDataflow"}(x||(x={})),function(e){e.OnCallToActionButtonClick="dataflowsErrorDialogCallbacks.onCallToActionButtonClick"}(Ae||(Ae={})),function(e){e.EditDataflow="refreshHistoryRpcMethodNames.editDataflow",e.RefreshNow="refreshHistoryRpcMethodNames.refreshNow",e.ScheduleRefresh="refreshHistoryRpcMethodNames.scheduleRefresh"}(h||(h={}));var je=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var u,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(u=o.next()).done;)i.push(u.value)}catch(S){d={error:S}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i},Le=function(e,n,r){if(r||2===arguments.length)for(var i,o=0,u=n.length;o<u;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))};function ot(e,n){return e<n?-1:e>n?1:0}function Ii(e,n){for(var r=function(i){var d=n[i];e=function(e,n){var r=function(S,I){var g=d.propertyGetter(S),T=d.propertyGetter(I);return d.propertyComparer(g,T)}||ot,o=e.map(function(u,i){return{value:u,index:i}});return o.sort(function(u,i){var d=r(u.value,i.value);return 0!==d?d:u.index-i.index}),o.map(function(u){return u.value})}(e)},o=n.length-1;o>=0;o--)r(o);return function(e,n,r){if(r||2===arguments.length)for(var i,o=0,u=n.length;o<u;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))}([],function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var u,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(u=o.next()).done;)i.push(u.value)}catch(S){d={error:S}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i}(e),!1)}function ln(e,n,r){var o;return e&&Qt(e)&&e.hasOwnProperty(n)&&null!==(o=e[n])&&void 0!==o?o:r}function Qt(e){return function(e){return null!==e&&"object"==typeof e}(e)&&!Array.isArray(e)&&e.constructor===Object}!function(){function e(n,r){this.array=n,this.sortDefinitions=r}e.prototype.getArray=function(){return Ii(this.array,this.sortDefinitions)},e.prototype.thenBy=function(n,r){return r||(r=ot),this.sortDefinitions.push({propertyGetter:n,propertyComparer:r}),this}}();var wt,Ne,zi=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var u,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(u=o.next()).done;)i.push(u.value)}catch(S){d={error:S}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i};function ji(e,n){if(!e)return"";if(!n)return e;var r=function(e){var n=new Map;return e&&(function(e,n,r){return e.startsWith("?")}(e)&&(e=e.substring(1)),e.split("&").forEach(function(r){var o=zi(r.split("="),2),i=o[1];n.set(decodeURIComponent(o[0]||""),decodeURIComponent(i||""))})),n}(e),o=function(e,n){var r=new Map;return e.forEach(function(o,u){n(u,o)&&r.set(u,o)}),r}(r,function(u){return!n.includes(u)});return o&&o.size>0?"?".concat(function(e){return function(e){return Le([],je(e.keys()),!1)}(e).map(function(n){var r,o=encodeURIComponent(n),u=encodeURIComponent(null!==(r=e.get(n))&&void 0!==r?r:"");return"".concat(o,"=").concat(u)}).join("&")}(o)):""}function Wn(e){cn(e)}function cn(e,n){if(null==e)throw new Error(n?n():"Value should be defined");return e}function Rr(e,n){return n.toLowerCase().lastIndexOf(e.toLowerCase())}!function(e){e.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",e.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(wt||(wt={})),function(e){e.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",e.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",e.GetEntities="mappingEditorCallbacks.getEntities",e.GetEntityFields="mappingEditorCallbacks.getEntityFields",e.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",e.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(Ne||(Ne={}));var Tr=function(){function e(){var n=this;this.resolveMethod=function(r){},this.rejectMethod=function(r){},this.promise=new Promise(function(r,o){n.resolveMethod=r,n.rejectMethod=o})}return e.createResolvedDeferred=function(){var n=new e;return n.resolve(),n},e.prototype.resolve=function(n){this.resolveMethod(n)},e.prototype.reject=function(n){this.rejectMethod(n)},e}(),eo=function(){function e(n,r,o){this.clientRpcChannel=n,this.configuration=r,this.clientRpcEndpointHost=o,this.ready=new Tr,this.registerRpcMethods()}return Object.defineProperty(e.prototype,"readyPromise",{get:function(){return this.ready.promise},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.unregisterRpcMethods()},e.prototype.register=function(n,r){this.clientRpcChannel.register(n,r)},e.prototype.registerRpcMethods=function(){var r,o,u,i,d,S,I,g,T,q,me,ye,He,dt,Ft,Gt,at,Ue,Ke,Ct,Zt,n=this;this.register("acquireToken",function(bt){return n.configuration.acquireToken(bt)}),this.register("acquireUPN",function(){return n.configuration.acquireUPN()}),this.register("getHostDeepLinkOnLoad",function(){return function(e){var n;if(void 0!==(null===(n=e.deepLink)||void 0===n?void 0:n.hostAppBasePathname))return function(e,n,r,o){var u=function(e,n,r,o){var u=""===e?n:n.substring(Rr(e,n)+e.length);return void 0!==o&&""!==r?function(e,n,r){return"".concat(e).concat(ji(n,r))}(u,r,cn(o)):u}(e,n,r,o);return function(e){return e.length>0&&"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}(u)}(e.deepLink.hostAppBasePathname,window.location.pathname,window.location.search)}(n.configuration.clientSettings)}),this.register("getSettings",function(){return n.configuration.appSettings}),this.register("getVersion",function(){return"2.47.0"}),this.register("onClose",function(bt){return n.clientRpcEndpointHost.onCloseCurrentFlow(bt)}),this.register("onPublish",function(bt){return n.clientRpcEndpointHost.onPublish(bt)}),this.register("onReady",function(){return n.ready.resolve()}),this.register("updateHostUrl",function(bt){return n.clientRpcEndpointHost.updateHostUrl(bt)}),this.configuration.linkToDataLake&&this.register("linkToDataLake",this.configuration.linkToDataLake),!(null===(r=this.configuration.browseDataflowCallbacks)||void 0===r)&&r.getEntityQueryScript&&this.register(J.GetEntityQueryScript,this.configuration.browseDataflowCallbacks.getEntityQueryScript),!(null===(o=this.configuration.hostPopupsCallbacks)||void 0===o)&&o.getLoginSuccessRedirectUri&&this.register(wt.GetLoginSuccessRedirectUri,null===(u=this.configuration.hostPopupsCallbacks)||void 0===u?void 0:u.getLoginSuccessRedirectUri),!(null===(i=this.configuration.hostPopupsCallbacks)||void 0===i)&&i.openHostPopup&&this.register(wt.OpenHostPopup,null===(d=this.configuration.hostPopupsCallbacks)||void 0===d?void 0:d.openHostPopup),!(null===(S=this.configuration.mappingEditorCallbacks)||void 0===S)&&S.generateNewEntityFieldNames&&this.register(Ne.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(I=this.configuration.mappingEditorCallbacks)||void 0===I)&&I.generateNewEntityNames&&this.register(Ne.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(g=this.configuration.mappingEditorCallbacks)||void 0===g)&&g.getEntities&&this.register(Ne.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===(T=this.configuration.mappingEditorCallbacks)||void 0===T)&&T.getEntityFields&&this.register(Ne.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(q=this.configuration.mappingEditorCallbacks)||void 0===q)&&q.getEntityKeys&&this.register(Ne.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(me=this.configuration.mappingEditorCallbacks)||void 0===me)&&me.validateMappingEditorResult&&this.register(Ne.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(ye=this.configuration.dataflowEditorCallbacks)||void 0===ye)&&ye.generateNewDataflowName&&this.register(x.GenerateNewDataflowName,this.configuration.dataflowEditorCallbacks.generateNewDataflowName),!(null===(He=this.configuration.dataflowEditorCallbacks)||void 0===He)&&He.getDataflowSensitivityLabel&&this.register(x.GetDataflowSensitivityLabel,this.configuration.dataflowEditorCallbacks.getDataflowSensitivityLabel),!(null===(dt=this.configuration.dataflowEditorCallbacks)||void 0===dt)&&dt.getInitialComputeEngineSettings&&this.register(x.GetInitialComputeEngineSettings,this.configuration.dataflowEditorCallbacks.getInitialComputeEngineSettings),!(null===(Ft=this.configuration.dataflowEditorCallbacks)||void 0===Ft)&&Ft.onDataflowEditingSessionChanged&&this.register(x.OnDataflowEditingSessionChanged,this.configuration.dataflowEditorCallbacks.onDataflowEditingSessionChanged),!(null===(Gt=this.configuration.dataflowEditorCallbacks)||void 0===Gt)&&Gt.onDataflowEditingSessionInitialized&&this.register(x.OnDataflowEditingSessionInitialized,this.configuration.dataflowEditorCallbacks.onDataflowEditingSessionInitialized),!(null===(at=this.configuration.dataflowEditorCallbacks)||void 0===at)&&at.onDataflowEditorClick&&this.register(x.OnDataflowEditorClick,this.configuration.dataflowEditorCallbacks.onDataflowEditorClick),!(null===(Ue=this.configuration.dataflowEditorCallbacks)||void 0===Ue)&&Ue.renameDataflow&&this.register(x.RenameDataflow,this.configuration.dataflowEditorCallbacks.renameDataflow),this.configuration.publishErrorDialogCallbacks&&this.register(Ae.OnCallToActionButtonClick,function(){var bt,fo;return null===(fo=(bt=n.clientRpcEndpointHost).onPublishErrorDialogCallToActionButtonClick)||void 0===fo?void 0:fo.call(bt)}),!(null===(Ke=this.configuration.refreshHistoryCallbacks)||void 0===Ke)&&Ke.editDataflow&&this.register(h.EditDataflow,this.configuration.refreshHistoryCallbacks.editDataflow),!(null===(Ct=this.configuration.refreshHistoryCallbacks)||void 0===Ct)&&Ct.refreshNow&&this.register(h.RefreshNow,this.configuration.refreshHistoryCallbacks.refreshNow),null!==(Zt=this.configuration.refreshHistoryCallbacks)&&void 0!==Zt&&Zt.scheduleRefresh&&this.register(h.ScheduleRefresh,this.configuration.refreshHistoryCallbacks.scheduleRefresh)},e.prototype.unregister=function(n){this.clientRpcChannel.unregister(n)},e.prototype.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("acquireUPN"),this.unregister("getHostDeepLinkOnLoad"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onClose"),this.unregister("onPublish"),this.unregister("onReady"),this.unregister("updateHostUrl"),this.unregister("linkToDataLake"),this.unregister(J.GetEntityQueryScript),this.unregister(wt.GetLoginSuccessRedirectUri),this.unregister(wt.OpenHostPopup),this.unregister(Ne.GenerateNewEntityFieldNames),this.unregister(Ne.GenerateNewEntityNames),this.unregister(Ne.GetEntities),this.unregister(Ne.GetEntityFields),this.unregister(Ne.GetEntityKeys),this.unregister(Ne.ValidateMappingEditorResult),this.unregister(x.GenerateNewDataflowName),this.unregister(x.GetDataflowSensitivityLabel),this.unregister(x.GetInitialComputeEngineSettings),this.unregister(x.OnDataflowEditingSessionChanged),this.unregister(x.OnDataflowEditingSessionInitialized),this.unregister(x.OnDataflowEditorClick),this.unregister(x.RenameDataflow),this.unregister(Ae.OnCallToActionButtonClick),this.unregister(h.EditDataflow),this.unregister(h.RefreshNow),this.unregister(h.ScheduleRefresh)},e}(),no=function(){function e(n){this.serviceRpcChannel=n}return e.prototype.call=function(n,r){return r?this.serviceRpcChannel.call(n,r):this.serviceRpcChannel.call(n)},e.prototype.callIfSupported=function(n,r){return r?this.serviceRpcChannel.callIfSupported(n,r):this.serviceRpcChannel.callIfSupported(n)},e.prototype.getMethodIfSupported=function(n){return function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function S(T){try{g(o.next(T))}catch(q){d(q)}}function I(T){try{g(o.throw(T))}catch(q){d(q)}}function g(T){T.done?i(T.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(T.value).then(S,I)}g((o=o.apply(e,n||[])).next())})}(this,void 0,void 0,function(){var r=this;return function(e,n){var o,u,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function S(g){return function(T){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,u&&(i=2&g[0]?u.return:g[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,g[1])).done)return i;switch(u=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,u=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(T){g=[6,T],u=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,T])}}}(this,function(o){switch(o.label){case 0:return[4,this.supportsMethod(n)];case 1:return o.sent()?[2,function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(n,u)}]:[2,void 0]}})})},e.prototype.supportsMethod=function(n){return this.serviceRpcChannel.supportsMethod(n)},e}(),ro=function(){var e=function(r,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(u[d]=i[d])})(r,o)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}e(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),$t=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function S(T){try{g(o.next(T))}catch(q){d(q)}}function I(T){try{g(o.throw(T))}catch(q){d(q)}}function g(T){T.done?i(T.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(T.value).then(S,I)}g((o=o.apply(e,n||[])).next())})},Tt=function(e,n){var o,u,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function S(g){return function(T){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,u&&(i=2&g[0]?u.return:g[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,g[1])).done)return i;switch(u=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,u=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(T){g=[6,T],u=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,T])}}};!function(e){function n(r){return e.call(this,r)||this}ro(n,e),n.prototype.ack=function(){return this.serviceRpcChannel.ack()},n.prototype.acquireToken=function(r){return this.call("acquireToken",[r])},n.prototype.acquireUPN=function(){return this.call("acquireUPN")},n.prototype.getHostPopupCallbacks=function(){return $t(this,void 0,void 0,function(){var r;return Tt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(wt.GetLoginSuccessRedirectUri)];case 1:return r.getLoginSuccessRedirectUri=o.sent(),[4,this.getMethodIfSupported(wt.OpenHostPopup)];case 2:return[2,(r.openHostPopup=o.sent(),r)]}})})},n.prototype.getBrowseDataflowCallbacks=function(){return $t(this,void 0,void 0,function(){var r;return Tt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(J.GetEntityQueryScript)];case 1:return[2,(r.getEntityQueryScript=o.sent(),r)]}})})},n.prototype.getDataflowEditorCallbacks=function(){return $t(this,void 0,void 0,function(){var r;return Tt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(x.GenerateNewDataflowName)];case 1:return r.generateNewDataflowName=o.sent(),[4,this.getMethodIfSupported(x.GetDataflowSensitivityLabel)];case 2:return r.getDataflowSensitivityLabel=o.sent(),[4,this.getMethodIfSupported(x.GetInitialComputeEngineSettings)];case 3:return r.getInitialComputeEngineSettings=o.sent(),[4,this.getMethodIfSupported(x.OnDataflowEditingSessionChanged)];case 4:return r.onDataflowEditingSessionChanged=o.sent(),[4,this.getMethodIfSupported(x.OnDataflowEditingSessionInitialized)];case 5:return r.onDataflowEditingSessionInitialized=o.sent(),[4,this.getMethodIfSupported(x.OnDataflowEditorClick)];case 6:return r.onDataflowEditorClick=o.sent(),[4,this.getMethodIfSupported(x.RenameDataflow)];case 7:return[2,(r.renameDataflow=o.sent(),r)]}})})},n.prototype.getPublishErrorDialogCallbacks=function(){var r=this;return{onCallToActionButtonClick:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ae.OnCallToActionButtonClick,u)}}},n.prototype.getRefreshHistoryCallbacks=function(){return $t(this,void 0,void 0,function(){var r;return Tt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(h.EditDataflow)];case 1:return r.editDataflow=o.sent(),[4,this.getMethodIfSupported(h.RefreshNow)];case 2:return r.refreshNow=o.sent(),[4,this.getMethodIfSupported(h.ScheduleRefresh)];case 3:return[2,(r.scheduleRefresh=o.sent(),r)]}})})},n.prototype.getHostDeepLinkOnLoad=function(){return this.serviceRpcChannel.callIfSupported("getHostDeepLinkOnLoad")},n.prototype.getMappingEditorCallbacks=function(){var r=this;return{generateNewEntityFieldNames:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.GenerateNewEntityFieldNames,u)},generateNewEntityNames:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.GenerateNewEntityNames,u)},getEntities:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.GetEntities,u)},getEntityFields:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.GetEntityFields,u)},getEntityKeys:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.GetEntityKeys,u)},validateMappingEditorResult:function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return r.call(Ne.ValidateMappingEditorResult,u)}}},n.prototype.getSettings=function(){return this.call("getSettings")},n.prototype.getVersion=function(){return this.callIfSupported("getVersion")},n.prototype.linkToDataLake=function(){return $t(this,void 0,void 0,function(){var o=this;return Tt(this,function(u){switch(u.label){case 0:return[4,this.serviceRpcChannel.supportsMethod("linkToDataLake")];case 1:return u.sent()?[2,function(){return o.call("linkToDataLake")}]:[2,void 0]}})})},n.prototype.onClose=function(r){return this.call("onClose",[r])},n.prototype.onPublish=function(r){return this.callIfSupported("onPublish",[r])},n.prototype.onReady=function(){return this.call("onReady")},n.prototype.updateHostUrl=function(r){return this.call("updateHostUrl",[r])}}(no),function(){function e(n,r,o,u,i,d,S,I,g,T){this.serviceRpcChannel=n,this.getFlow=r,this.startFlow=o,this.endFlow=u,this.getDataflowEditingSession=i,this.isDialogVisible=T,this.logXFramePerformanceMarks=g,this.onHostPopupCancelled=d,this.showCloseDataflowPrompt=S,this.showCloseOpenDialogsPrompt=I,this.registerRpcMethods()}e.prototype.ack=function(){return this.serviceRpcChannel.ack()},e.prototype.registerRpcMethods=function(){this.registerRpcMethod("disposeService"),this.registerRpcMethod("endFlow"),this.registerRpcMethod("getDataflowEditingSession"),this.registerRpcMethod("getFlow"),this.registerRpcMethod("isDialogVisible"),this.registerRpcMethod("logXFramePerformanceMarks"),this.registerRpcMethod("onHostPopupCancelled"),this.registerRpcMethod("showCloseDataflowPrompt"),this.registerRpcMethod("showCloseOpenDialogsPrompt"),this.registerRpcMethod("startFlow")},e.prototype.registerRpcMethod=function(n){var r=this;switch(n){case"disposeService":this.serviceRpcChannel.register("disposeService",function(){return r.disposeService()});break;case"endFlow":this.serviceRpcChannel.register("endFlow",function(){return r.endFlow()});break;case"getDataflowEditingSession":this.serviceRpcChannel.register("getDataflowEditingSession",function(){return r.getDataflowEditingSession()});break;case"getFlow":this.serviceRpcChannel.register("getFlow",function(){return r.getFlow()});break;case"isDialogVisible":this.serviceRpcChannel.register("isDialogVisible",function(){return r.isDialogVisible()});break;case"logXFramePerformanceMarks":this.serviceRpcChannel.register("logXFramePerformanceMarks",function(o){return r.logXFramePerformanceMarks(o)});break;case"onHostPopupCancelled":this.onHostPopupCancelled&&this.serviceRpcChannel.register("onHostPopupCancelled",function(o){return r.onHostPopupCancelled(o)});break;case"showCloseDataflowPrompt":this.serviceRpcChannel.register("showCloseDataflowPrompt",function(){return r.showCloseDataflowPrompt()});break;case"showCloseOpenDialogsPrompt":this.serviceRpcChannel.register("showCloseOpenDialogsPrompt",function(){return r.showCloseOpenDialogsPrompt()});break;case"startFlow":this.serviceRpcChannel.register("startFlow",function(o){return r.startFlow(o)});break;default:!function(e){throw new Error("Unexpected value: ".concat(e))}(n)}},e.prototype.disposeService=function(){}}();var so=function(){function e(n){this.clientRpcChannel=n}return e.prototype.disposeService=function(){return this.clientRpcChannel.call("disposeService")},e.prototype.endFlow=function(){return this.clientRpcChannel.call("endFlow")},e.prototype.getDataflowEditingSession=function(){return this.clientRpcChannel.call("getDataflowEditingSession")},e.prototype.getFlow=function(){return this.clientRpcChannel.call("getFlow")},e.prototype.isDialogVisible=function(){return this.clientRpcChannel.call("isDialogVisible")},e.prototype.logXFramePerformanceMarks=function(n){return this.clientRpcChannel.call("logXFramePerformanceMarks",[n])},e.prototype.onHostPopupCancelled=function(n){return this.clientRpcChannel.call("onHostPopupCancelled",[n])},e.prototype.showCloseDataflowPrompt=function(){return this.clientRpcChannel.call("showCloseDataflowPrompt")},e.prototype.showCloseOpenDialogsPrompt=function(){return this.clientRpcChannel.call("showCloseOpenDialogsPrompt")},e.prototype.startFlow=function(n){return this.clientRpcChannel.call("startFlow",[n])},e}(),pn=j(11105);function hn(){return pn.Z()}var b,gn=function(){var e=function(r,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(u[d]=i[d])})(r,o)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}e(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),vn=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function S(T){try{g(o.next(T))}catch(q){d(q)}}function I(T){try{g(o.throw(T))}catch(q){d(q)}}function g(T){T.done?i(T.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(T.value).then(S,I)}g((o=o.apply(e,n||[])).next())})},mn=function(e,n){var o,u,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function S(g){return function(T){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,u&&(i=2&g[0]?u.return:g[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,g[1])).done)return i;switch(u=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,u=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(T){g=[6,T],u=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,T])}}},Jt="__SUPPORTS_METHOD__",wn=function(){function e(n){var r=this;this.onMessageReceived=function(o){o.method?r.handleRequestMessageReceived(o):r.handleResponseMessageReceived(o)},this.options=n,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(Jt,function(o){return r.handleSupportsMethodMessage(o)})}return e.prototype.call=function(n,r){return this.internalCall(e.normalizeMethodName(n),r)},e.prototype.callIfSupported=function(n,r){return vn(this,void 0,void 0,function(){return mn(this,function(u){switch(u.label){case 0:return[4,this.supportsMethod(n)];case 1:return u.sent()?[2,this.call(n,r)]:[2,void 0]}})})},e.prototype.dispose=function(){this.internalUnregister(Jt),this.requestDeferredByMessageId.forEach(function(n){return n.reject(function(e){var n=new Error("Rpc disposed");if(null!=n.stack)return n;try{throw n}catch(r){return r}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},e.prototype.register=function(n,r){var o=this,u=e.normalizeMethodName(n);this.internalRegister(u,function(){for(var i,d,S=[],I=0;I<arguments.length;I++)S[I]=arguments[I];return null===(d=(i=o.options).onMethodInvoked)||void 0===d||d.call(i,n,S),r.apply(void 0,function(e,n,r){if(r||2===arguments.length)for(var i,o=0,u=n.length;o<u;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))}([],function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var u,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(u=o.next()).done;)i.push(u.value)}catch(S){d={error:S}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i}(S),!1))})},e.prototype.supportsMethod=function(n){return this.internalCall(Jt,[n])},e.prototype.unregister=function(n){var r=e.normalizeMethodName(n);this.internalUnregister(r)},e.prototype.canPostMessage=function(n){return this.ready},Object.defineProperty(e.prototype,"rpcHandshakeHandler",{get:function(){return this.options.rpcHandshakeHandler},enumerable:!1,configurable:!0}),e.prototype.internalCall=function(n,r){void 0===r&&(r=void 0);var o=hn(),u={id:o,method:n,params:r},i=new Tr;return this.requestDeferredByMessageId.set(o,i),this.canPostMessage(u)?this.tryPostMessage(u):this.queuedRequestMessages.push(u),i.promise},e.prototype.internalRegister=function(n,r){if(this.methodCallbackMap.has(n))throw new Error("Rpc method with name '".concat(n,"' already registered."));this.methodCallbackMap.set(n,r)},e.prototype.internalUnregister=function(n){this.methodCallbackMap.delete(n)},e.prototype.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},e.getResponseMessageError=function(n){return n instanceof Error?{message:n.message,name:n.name,stack:n.stack}:n},e.normalizeMethodName=function(n){return n.toUpperCase()},e.prototype.flushRequestMessageQueue=function(){var n=this;this.queuedRequestMessages.forEach(function(r){return n.tryPostMessage(r)}),this.queuedRequestMessages=[]},e.prototype.handleRequestMessageReceived=function(n){var r=this,o=this.methodCallbackMap.get(n.method);if(o){var u={signature:n.signature,id:n.id};try{var i=o.apply(this,n.params);Promise.resolve(i).then(function(d){u.result=d,r.postMessage(u)}).catch(function(d){u.error=e.getResponseMessageError(d),r.postMessage(u)})}catch(d){u.error=e.getResponseMessageError(d),this.postMessage(u)}}},e.prototype.handleResponseMessageReceived=function(n){var r=n.id,o=this.requestDeferredByMessageId.get(r);o&&(n.error?o.reject(n.error):o.resolve(n.result),this.requestDeferredByMessageId.delete(r))},e.prototype.handleSupportsMethodMessage=function(n){return this.methodCallbackMap.has(e.normalizeMethodName(n))},e.prototype.postMessage=function(n){this.options.rpcWindow.postMessage(n)},e.prototype.tryPostMessage=function(n){try{this.postMessage(n)}catch(u){if(u instanceof Error){var r=n.id,o=this.requestDeferredByMessageId.get(r);o&&(o.reject(u),this.requestDeferredByMessageId.delete(r))}}},e}(),Qn=function(e){function n(r){var o=e.call(this,r)||this;return o.clientOptions=r,o.internalRegister(r.rpcHandshakeHandler.getReadyMessageMethod(),function(){return o.handleReadyMessage()}),o}return gn(n,e),n.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},n}(wn),t=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}gn(n,e),n.prototype.ack=function(){return vn(this,void 0,void 0,function(){var r,o;return mn(this,function(i){switch(i.label){case 0:return r=this.rpcHandshakeHandler.getReadyMessageMethod(),[4,this.internalCall(r)];case 1:if(o=i.sent(),!this.rpcHandshakeHandler.isAckResponse(o))throw new Error("Invalid Handshake message. Received: '".concat(o,"'."));return this.onReady(),[2]}})})},n.prototype.canPostMessage=function(r){return e.prototype.canPostMessage.call(this,r)||r.method===this.rpcHandshakeHandler.getReadyMessageMethod()}}(wn),function(){function e(n){this.signature=n}return e.prototype.deserialize=function(n){var r=n.data;return Qt(r)?ln(r,"data",r):r},e.prototype.serialize=function(n){return n.signature=this.signature,{id:n.id,kind:ln(n,"method",e.emptyValue),signature:e.frameSignature,data:n}},e.emptyValue="",e.frameSignature="FxFrameControl",e}()),l="start",c=function(){function e(){}return e.prototype.createAckResponse=function(){return l},e.prototype.getReadyMessageMethod=function(){return"ready"},e.prototype.isAckResponse=function(n){return n===l},e}(),s=function(){function e(n){this.signature=n}return e.prototype.deserialize=function(n){return n.data},e.prototype.serialize=function(n){return n.signature=this.signature,n},e}(),m="__PONG__",y=function(){function e(){}return e.prototype.createAckResponse=function(){return m},e.prototype.getReadyMessageMethod=function(){return"__PING__"},e.prototype.isAckResponse=function(n){return n===m},e}();!function(e){e.Default="default",e.AzurePortal_v1_0_0="azureportal-v1.0.0"}(b||(b={}));var Ia,Da,Ra,Ta,ka,Fa,Ma,Oa,La,xa,Na,Ua,Ha,Va,Ba,Wa,Ga,za,ja,Qa,qa,_a,$a,Ja,Za,Xa,Ya,Ka,es,ts,ns,rs,qn,is,os,as,ss,us,ls,cs,fs,ds,ps,hs,gs,vs,ms,ws,ys,Cs,bs,Ss,Ps,Es,As,Is,Ds,Rs,Ts,ks,Fs,Ms,P=function(){function e(n){Wn(n.targetWindow),Wn(n.sourceWindow),this.options=n,this.eventListeners=new Map}return e.prototype.addListener=function(n){var r=this;if(this.eventListeners.has(n))throw new Error("Duplicate rpc listener added.");var o=function(i){return r.handleMessageReceived(i,n)};this.eventListeners.set(n,o),this.options.sourceWindow.addEventListener(e.eventTypeName,o)},e.prototype.postMessage=function(n){var r=this.options.targetOriginProvider.getTargetOrigin(n);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(n),r)},e.prototype.removeListener=function(n){var r=this.eventListeners.get(n);r&&(this.options.sourceWindow.removeEventListener(e.eventTypeName,r),this.eventListeners.delete(n))},e.isMessageEvent=function(n){return!function(e){return null==e}(n.data)},e.prototype.canProcessMessage=function(n){return!!n&&n.signature===this.options.rpcMessageConverter.signature},e.prototype.handleMessageReceived=function(n,r){if(e.isMessageEvent(n)){var o=this.options.rpcMessageConverter.deserialize(n);this.canProcessMessage(o)&&this.options.allowedOrigins.some(function(u){return function(e,n){if("*"===n)return!0;if(n.startsWith("https://*.")&&e.startsWith("https://")){var o=n.substring(9);return e.substring(8).endsWith(o)}return e===n}(n.origin,u)})&&(this.options.targetOriginProvider.onMessageReceived(n.origin),r(o))}},e.eventTypeName="message",e}(),A=function(){function e(n){this.explicitTargetOrigin=n}return e.prototype.getTargetOrigin=function(n){return this.explicitTargetOrigin},e.prototype.onMessageReceived=function(n){},e}(),ie=function(n){return n?"dfpq-".concat(n):"dfpq"},kt=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function S(T){try{g(o.next(T))}catch(q){d(q)}}function I(T){try{g(o.throw(T))}catch(q){d(q)}}function g(T){T.done?i(T.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(T.value).then(S,I)}g((o=o.apply(e,n||[])).next())})},Wt=function(e,n){var o,u,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function S(g){return function(T){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,u&&(i=2&g[0]?u.return:g[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,g[1])).done)return i;switch(u=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,u=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(T){g=[6,T],u=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,T])}}},Hs=function(){function e(n){var o,r=this;this.onPublish=function(g){return cn(r.currentFlowConfiguration).onPublish(g)};var u=hn();this.configurations=n,this.iframe=this.renderIFrame(n.clientSettings,u),n.appSettings.runMode===re.Flow&&this.hideApp();var i=function(n,r,o,u){var i,d=null!=n.clientSettings.allowedOrigin?n.clientSettings.allowedOrigin:"*",S=function(e,n){return n===b.AzurePortal_v1_0_0?{rpcMessageConverter:new t(e),rpcHandshakeHandler:new c}:{rpcMessageConverter:new s(e),rpcHandshakeHandler:new y}}(ie(r),b.Default),I=new Qn({debugName:"DataflowsRpcUtils.clientRpcChannel",enableDebugLogging:null!==(i=n.clientSettings.enableDebugLogging)&&void 0!==i&&i,rpcHandshakeHandler:S.rpcHandshakeHandler,rpcWindow:new P({allowedOrigins:[d],rpcMessageConverter:S.rpcMessageConverter,sourceWindow:window,targetOriginProvider:new A(d),targetWindow:cn(o.contentWindow,function(){return"Unable to find the contentWindow on the iFrame element."})})}),g=new eo(I,n,u);return{serviceRpcProxy:new so(I),clientRpcEndpoint:g,clientRpcChannel:I}}(n,u,this.iframe,{onCloseCurrentFlow:function(T){return r.onCloseCurrentFlow(T)},onPublish:function(T){return r.onPublish(T)},onPublishErrorDialogCallToActionButtonClick:null===(o=this.configurations.publishErrorDialogCallbacks)||void 0===o?void 0:o.onCallToActionButtonClick,updateHostUrl:function(T){return function(e,n){if(e?.allowUpdateHostUrlWithRelativePath){var r=function(e,n){return""===e?"":n.substring(0,Rr(e,n)+e.length)}(e.hostAppBasePathname,window.location.pathname);history.replaceState(null,"",r+n)}}(n.clientSettings.deepLink,T)}}),S=i.clientRpcEndpoint,I=i.clientRpcChannel;this.serviceProxy=i.serviceRpcProxy,this.clientRpcEndpoint=S,this.clientRpcChannel=I,this.ready=this.clientRpcEndpoint.readyPromise}return e.prototype.dispose=function(){return kt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return this.hideApp(),[4,this.serviceProxy.disposeService()];case 1:return n.sent(),this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.configurations.clientSettings.container.removeChild(this.iframe),[2]}})})},e.prototype.endFlow=function(){if(this.configurations.appSettings.runMode!==re.Flow)throw new Error("Cannot end a flow with runMode set to '".concat(this.configurations.appSettings.runMode,"'."));return this.hideApp(),this.serviceProxy.endFlow()},e.prototype.getDataflowEditingSession=function(){if(this.configurations.appSettings.runMode!==re.Flow)throw new Error("App is currently running on runMode '".concat(this.configurations.appSettings.runMode,"'."));return this.serviceProxy.getDataflowEditingSession()},e.prototype.getFlow=function(){if(this.configurations.appSettings.runMode!==re.Flow)throw new Error("App is currently running on runMode '".concat(this.configurations.appSettings.runMode,"'."));return this.serviceProxy.getFlow()},e.prototype.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},e.prototype.logXFramePerformanceMarks=function(n){return this.serviceProxy.logXFramePerformanceMarks(n)},e.prototype.onHostPopupCancelled=function(n){return kt(this,void 0,void 0,function(){return Wt(this,function(r){switch(r.label){case 0:return[4,this.serviceProxy.onHostPopupCancelled(n)];case 1:return r.sent(),[2]}})})},e.prototype.showCloseDataflowPrompt=function(){return kt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.serviceProxy.showCloseDataflowPrompt()];case 1:return n.sent(),[2]}})})},e.prototype.showCloseOpenDialogsPrompt=function(){return kt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.serviceProxy.showCloseOpenDialogsPrompt()];case 1:return n.sent(),[2]}})})},e.prototype.startFlow=function(n,r,o){return kt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:if(this.configurations.appSettings.runMode!==re.Flow)throw new Error("Cannot start a flow with runMode set to '".concat(this.configurations.appSettings.runMode,"'."));return[4,this.ready];case 1:return i.sent(),[4,this.getFlow()];case 2:if(null!=i.sent())throw new Error("Cannot start a new flow when an existing flow is running");return this.currentFlowConfiguration={onClose:function(S){if(te(S,n))return r(S);throw new Error("The flow ".concat(n.kind," returned the wrong type of result: ").concat(S.kind))},onPublish:function(S){var I;if(te(S,n))return null!==(I=o?.(S))&&void 0!==I?I:Promise.resolve();throw new Error("The flow ".concat(n.kind," returned the wrong type of result: ").concat(S.kind))}},this.showApp(),[2,this.serviceProxy.startFlow(n)]}})})},e.prototype.hideApp=function(){this.iframe.style.display="none"},e.prototype.onCloseCurrentFlow=function(n){return kt(this,void 0,void 0,function(){return Wt(this,function(r){switch(r.label){case 0:return Wn(this.currentFlowConfiguration),[4,this.currentFlowConfiguration.onClose(n)];case 1:return r.sent(),this.hideApp(),this.currentFlowConfiguration=void 0,[2]}})})},e.prototype.renderIFrame=function(n,r){var o=document.createElement("iframe");return o.src=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var u=e.indexOf("?")>-1?"&":"?",i=n.map(function(d){return"".concat(encodeURIComponent(d.name),"=").concat(encodeURIComponent(d.value))}).join("&");return"".concat(e).concat(u).concat(i)}(n.url,{name:"df_ClientInstanceId",value:r}),o.title="Dataflows",o.style.width="100%",o.style.height="100%",o.style.border="none",o.allow="clipboard-write",n.className&&(o.className=n.className),n.container.appendChild(o),o},e.prototype.showApp=function(){this.iframe.style.display="block"},e}();!function(e){e.Success="Success",e.Error_EmptyName="Error_EmptyName",e.Error_InvalidCharacters="Error_InvalidCharacters",e.Error_NameAlreadyExists="Error_NameAlreadyExists",e.Error_NameTooLong="Error_NameTooLong"}(Ia||(Ia={})),function(e){e.Editable="Editable",e.Hidden="Hidden",e.Readonly="Readonly"}(Da||(Da={})),function(e){e.CombinedRefreshPublishStatus="CombinedRefreshPublishStatus",e.DataflowType="DataflowType",e.DraftStatus="DraftStatus",e.LastPublished="LastPublished",e.LastRefresh="LastRefresh",e.NextRefresh="NextRefresh"}(Ra||(Ra={})),function(e){e.PublishLater="PublishLater",e.PublishNow="PublishNow"}(Ta||(Ta={})),function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.NotRequired="NotRequired"}(ka||(ka={})),function(e){e.Action="action",e.Any="any",e.AnyNonNull="anynonnull",e.Binary="binary",e.Currency="currency",e.Date="date",e.DateTime="datetime",e.DateTimeZone="datetimezone",e.Duration="duration",e.Exception="exception",e.Function="function",e.List="list",e.Logical="logical",e.None="none",e.Null="null",e.Number="number",e.Percentage="percentage",e.Record="record",e.Table="table",e.Text="text",e.Time="time",e.Type="type",e.WholeNumber="wholenumber"}(Fa||(Fa={})),function(e){e.AM="AM",e.PM="PM"}(Ma||(Ma={})),function(e){e[e.anonymous=1]="anonymous",e[e.basic=2]="basic",e[e.oAuth2=3]="oAuth2",e[e.windows=4]="windows",e[e.key=5]="key",e[e.sas=6]="sas",e[e.servicePrincipal=7]="servicePrincipal"}(Oa||(Oa={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(La||(La={})),function(e){e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(xa||(xa={})),function(e){e.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",e.AdfConnectionEvaluationError="AdfConnectionEvaluationError",e.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",e.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",e.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",e.ConnectionKindNotSupported="ConnectionKindNotSupported",e.ConnectionNotFound="ConnectionNotFound",e.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",e.DataAccessError="DataAccessError",e.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",e.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",e.DuplicateDataSourceNameError="DuplicateDataSourceNameError",e.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",e.ExceededLimit="ExceededLimit",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",e.InvalidCredentials="InvalidCredentials",e.InvalidPath="InvalidPath",e.OboSignInError="OboSignInError",e.TooManyConnections="TooManyConnections",e.UnknownDmtsError="UnknownDmtsError",e.UnknownError="UnknownError",e.UnknownGatewayError="UnknownGatewayError",e.Unsupported="Unsupported"}(Na||(Na={})),function(e){e.AddStep="AddStep",e.CreateQuery="CreateQuery",e.DeleteQuery="DeleteQuery",e.ExplainQuery="ExplainQuery",e.ExplainStep="ExplainStep"}(Ua||(Ua={})),function(e){e.CouldNotExplainQuery="CouldNotExplainQuery",e.CouldNotGenerateQuery="CouldNotGenerateQuery",e.CouldNotGenerateStep="CouldNotGenerateStep",e.DataItemsMissing="DataItemsMissing",e.LanguageNotSupported="LanguageNotSupported",e.OutOfScope="OutOfScope",e.QueryNotFound="QueryNotFound",e.SkillNotFound="SkillNotFound",e.TableNotFound="TableNotFound",e.Unknown="Unknown"}(Ha||(Ha={})),function(e){e.Action="Action",e.Error="Error"}(Va||(Va={})),function(e){e.Singleton="Singleton",e.Database="Database",e.Uri="Uri",e.Custom="Custom"}(Ba||(Ba={})),function(e){e.BuiltIn="BuiltIn",e.Extension="Extension"}(Wa||(Wa={})),function(e){e.JsonDsr="JsonDsr",e.MScript="MScript",e.QueryModel="QueryModel"}(Ga||(Ga={})),function(e){e.Cluster="Cluster",e.Database="Database",e.Lakehouse="Lakehouse",e.Object="Object",e.Schema="Schema",e.Server="Server",e.Table="Table",e.Warehouse="Warehouse",e.Workspace="Workspace"}(za||(za={})),function(e){e.Constant="Constant",e.Duplicate="Duplicate",e.Empty="Empty",e.Index="Index"}(ja||(ja={})),function(e){e[e.false=0]="false",e[e.true=1]="true",e[e.notApplicable=2]="notApplicable",e[e.existingConnection=3]="existingConnection"}(Qa||(Qa={})),function(e){e.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",e.Cancelled="Cancelled",e.DuplicateEvaluationId="DuplicateEvaluationId",e.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",e.EvaluationAgentNotFound="EvaluationAgentNotFound",e.EvaluationQuotaReached="EvaluationQuotaReached",e.ExternalServiceError="ExternalServiceError",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNeeded="GatewayNeeded",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayNotFound="GatewayNotFound",e.GatewayUnknownError="GatewayUnknownError",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUpgradeRequired="GatewayUpgradeRequired",e.GatewayUserError="GatewayUserError",e.MashupEntityNotFound="MashupEntityNotFound",e.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",e.NetworkAccessDenied="NetworkAccessDenied",e.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",e.ParameterNotFound="ParameterNotFound",e.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",e.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",e.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",e.QueryNotFound="QueryNotFound",e.StepNotFound="StepNotFound",e.UnableToContactBackend="UnableToContactBackend",e.Unknown="Unknown",e.UnsupportedKind="UnsupportedKind",e.ValueTooComplex="ValueTooComplex"}(qa||(qa={})),function(e){e.Path="Path",e.QueryScript="QueryScript"}(_a||(_a={})),function(e){e.AutoFilterColumnValues="AutoFilterColumnValues",e.BinaryMetadata="BinaryMetadata",e.ConnectorRows="ConnectorRows",e.ConnectorSchema="ConnectorSchema",e.CubeAllowedValues="CubeAllowedValues",e.CubeDisplayFolders="CubeDisplayFolders",e.CubeParameters="CubeParameters",e.DataSourceQuery="DataSourceQuery",e.DetailsPreview="DetailsPreview",e.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",e.DsrDetailsFetching="DsrDetailsFetching",e.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",e.ExpandColumnNames="ExpandColumnNames",e.FunctionBrowser="FunctionBrowser",e.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",e.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",e.LoadToCdsRelationships="LoadToCdsRelationships",e.LoadToCdsSchema="LoadToCdsSchema",e.MappingEditorQueryProfiling="MappingEditorQueryProfiling",e.MappingEditorSchemaResult="MappingEditorSchemaResult",e.MappingEditorTypeMetadata="MappingEditorTypeMetadata",e.MashupLoad="MashupLoad",e.MergeMatchAnalysis="MergeMatchAnalysis",e.MergeQueriesPreview="MergeQueriesPreview",e.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",e.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",e.NaturalLanguageValidation="NaturalLanguageValidation",e.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",e.NavigatorCubeParameters="NavigatorCubeParameters",e.NavigatorCubePreview="NavigatorCubePreview",e.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",e.NavigatorPreview="NavigatorPreview",e.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",e.Preview="Preview",e.QueryAnalysis="QueryAnalysis",e.QueryPlan="QueryPlan",e.QuerySanitizer="QuerySanitizer",e.QuerySanitizerAnalysis="QuerySanitizerAnalysis",e.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",e.QueryScriptPreview="QueryScriptPreview",e.SemanticEntitySets="SemanticEntitySets",e.SemanticDataGetData="SemanticDataGetData",e.SemanticDataList="SemanticDataList",e.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",e.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",e.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",e.StepAnalysis="StepAnalysis",e.TableProfiler="TableProfiler",e.TextByExampleGetText="TextByExampleGetText",e.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",e.WebByExampleGetHtml="WebByExampleGetHtml"}($a||($a={})),function(e){e.None="None",e.Any="Any",e.Access="Access",e.Excel="Excel",e.Json="Json",e.TextCsv="TextCsv",e.Pdf="Pdf",e.Xml="Xml"}(Ja||(Ja={})),function(e){e.List="List"}(Za||(Za={})),function(e){e.MenuItem="MenuItem",e.Separator="Separator"}(Xa||(Xa={})),function(e){e.Max="Max",e.Mean="Mean",e.Min="Min",e.Mode="Mode",e.RoundedMean="RoundedMean"}(Ya||(Ya={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}(Ka||(Ka={})),function(e){e.Database="Database",e.File="File"}(es||(es={})),function(e){e.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",e.BasedOnMetadata="BasedOnMetadata",e.Never="Never"}(ts||(ts={})),function(e){e.Always="Always",e.Never="Never",e.HasNewLoadableQueries="HasNewLoadableQueries",e.NumberOfQueries="NumberOfQueries"}(ns||(ns={})),function(e){e.Equals="Equals",e.GreaterThan="GreaterThan",e.GreaterThanOrEqual="GreaterThanOrEqual",e.LessThan="LessThan",e.LessThanOrEqual="LessThanOrEqual"}(rs||(rs={})),function(e){e.Adf="Adf",e.Athena="Athena",e.AzureSearch="AzureSearch",e.BingAtWork="BingAtWork",e.CdsA="CdsA",e.CdsLite="CdsLite",e.CdsT="CdsT",e.CdsV1="CdsAdHoc",e.CustomerInsights="CustomerInsights",e.CustomerInsightsPPDF="CustomerInsightsPPDF",e.D365TalentInsights="D365TalentInsights",e.DataIntegration="DataIntegration",e.DesktopBootstrap="DesktopBootstrap",e.DesktopUITester="DesktopUITester",e.DmtsPowerBiExperimental="DmtsPowerBiExperimental",e.DmtsSaExperimental="DmtsSaExperimental",e.ExcelDesktop="ExcelDesktop",e.ExcelOnline="ExcelOnline",e.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",e.Experimental="Experimental",e.Flow="Flow",e.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",e.IntelligentOrderManagement="IntelligentOrderManagement",e.InternalPortal="InternalPortal",e.KustoViewDesigner="KustoViewDesigner",e.MashupEditorBootstrap="MashupEditorBootstrap",e.PowerAppsTeams="PowerAppsTeams",e.PowerBIDataMart="PowerBIDataMart",e.PowerBIModeling="PowerBIModeling",e.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",e.PowerBIPaginatedReports="PowerBIPaginatedReports",e.PowerBIPPDF="PowerBIPPDF",e.PowerBIReportView="PowerBIReportView",e.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",e.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",e.PowerPlatformExperimental="PowerPlatformExperimental",e.PowerQueryDesktop="PowerQueryDesktop",e.ProcessAdvisor="ProcessAdvisor",e.SupplyChainVisibility="SupplyChainVisibility",e.SustainabilityCloud="SustainabilityCloud",e.Synapse="Synapse",e.TridentDataflow="TridentDataflow",e.TridentDataPipeline="TridentDataPipeline",e.TridentDataWarehouse="TridentDataWarehouse",e.TridentEventStream="TridentEventStream",e.TridentKusto="TridentKusto",e.TridentLakehouse="TridentLakehouse",e.TridentLakeWarehouse="TridentLakeWarehouse",e.TridentMountedDataWarehouse="TridentMountedDataWarehouse",e.TridentOneLake="TridentOneLake",e.TridentReplicator="TridentReplicator",e.TridentSynapseLink="TridentSynapseLink"}(qn||(qn={})),function(e){e.Boolean="Boolean"}(is||(is={})),function(e){e.NaN="NaN",e.NegativeInfinity="NegativeInfinity",e.PositiveInfinity="PositiveInfinity",e.FormattedNumber="FormattedNumber",e.Number="Number"}(os||(os={})),function(e){e.Access="Access",e.ActiveDirectory="ActiveDirectory",e.AdoDotNet="AdoDotNet",e.AdobeAnalytics="AdobeAnalytics",e.AnalysisServices="AnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.Cdpa="CDPA",e.CurrentWorkbook="CurrentWorkbook",e.DB2="DB2",e.Environment="Environment",e.Essbase="Essbase",e.Exchange="Exchange",e.File="File",e.Folder="Folder",e.Ftp="Ftp",e.GoogleAnalytics="GoogleAnalytics",e.HDInsight="HDInsight",e.Hdfs="Hdfs",e.Informix="Informix",e.MQ="MQ",e.MicrosoftInformationProtection="MicrosoftInformationProtection",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.OleDb="OleDb",e.Oracle="Oracle",e.PostgreSQL="PostgreSQL",e.PowerBIDataflow="PowerBI",e.Python="Python",e.R="R",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Spark="Spark",e.Sql="SQL",e.Staging="Staging",e.Sybase="Sybase",e.Teradata="Teradata",e.Web="Web"}(as||(as={})),function(e){e.TemplateMetadata="Metadata.json",e.MashupDocument="MashupDocument.pq",e.MashupMetadata="MashupMetadata.json"}(ss||(ss={})),function(e){e.GroupNestingLimitReached="GroupNestingLimitReached",e.NullMashupXml="NullMashupXml",e.Unknown="Unknown"}(us||(us={})),function(e){e.CompletedSuccessfully="CompletedSuccessfully",e.CompletedWithExpectedError="CompletedWithExpectedError",e.CompletedWithUnexpectedError="CompletedWithUnexpectedError",e.Started="Started"}(ls||(ls={})),function(e){e.Above="Above",e.Below="Below"}(cs||(cs={})),function(e){e.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",e.NoProgramFound="NoProgramFound",e.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",e.RequestCanceled="RequestCanceled"}(fs||(fs={})),function(e){e.Ascii="Ascii",e.Utf8="Utf8",e.Utf16="Utf16",e.Windows="Windows"}(ds||(ds={})),function(e){e.Excel="Excel",e.Json="Json",e.Parquet="Parquet",e.Text="Text"}(ps||(ps={})),function(e){e.Colon="Colon",e.Comma="Comma",e.None="None",e.Semicolon="Semicolon",e.Space="Space",e.Tab="Tab"}(hs||(hs={})),function(e){e.Even="Even",e.Odd="Odd"}(gs||(gs={})),function(e){e.None="None",e.Private="Private",e.Organizational="Organizational",e.Public="Public"}(vs||(vs={})),function(e){e.QueryNeedsToFold="QueryNeedsToFold"}(ms||(ms={})),function(e){e.AzureBlob="AzureBlob",e.Database="Database"}(ws||(ws={})),function(e){e.DynamicPlanFolded="DynamicPlanFolded",e.DynamicPlanMightFold="DynamicPlanMightFold",e.DynamicPlanNotFolded="DynamicPlanNotFolded",e.DynamicPlanOpaque="DynamicPlanOpaque",e.ErrorRetrievingPlan="ErrorRetrievingPlan",e.FoldedQueryNotImplemented="FoldedQueryNotImplemented",e.FoldedQueryNull="FoldedQueryNull",e.FoldedWithQuery="FoldedWithQuery",e.NotFolded="NotFolded",e.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",e.NotTable="NotTable",e.OpaqueConstant="OpaqueConstant",e.UnexpectedPlanKind="UnexpectedPlanKind"}(ys||(ys={})),function(e){e.ActiveDirectory="ActiveDirectory",e.AdobeAnalytics="AdobeAnalytics",e.AmazonRedshift="AmazonRedshift",e.AnalysisServices="AnalysisServices",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataExplorer="AzureDataExplorer",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.AIFunctions="AIFunctions",e.AIInsights="AIInsights",e.AzureMLFunctions="AzureMLFunctions",e.AIInsightsInProc="AIInsightsInProc",e.Cds="Cds",e.CommonDataService="CommonDataService",e.DataLake="DataLake",e.Dataverse="Dataverse",e.DB2="DB2",e.ElasticSearch="ElasticSearch",e.Exchange="Exchange",e.Fhir="Fhir",e.File="File",e.Folder="Folder",e.GoogleAnalytics="GoogleAnalytics",e.GoogleBigQuery="GoogleBigQuery",e.HDInsight="HDInsight",e.Impala="Impala",e.Kusto="Kusto",e.Lakehouse="Lakehouse",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.Oracle="Oracle",e.OracleERP="OracleERP",e.PostgreSQL="PostgreSQL",e.PowerBI="PowerBI",e.PowerBIDatamarts="PowerBIDatamarts",e.PowerPlatformDataflows="PowerPlatformDataflows",e.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SAPERP="SAPERP",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Snowflake="Snowflake",e.Spark="Spark",e.SQL="SQL",e.Sybase="Sybase",e.Teradata="Teradata",e.Vertica="Vertica",e.Warehouse="Warehouse",e.Web="Web"}(Cs||(Cs={})),function(e){e.CompilationError="CompilationError",e.InvalidQueryName="InvalidQueryName",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(bs||(bs={})),function(e){e.Failure="Failure",e.Success="Success"}(Ss||(Ss={})),function(e){e[e.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",e[e.httpError=1]="httpError",e[e.invalidInput=2]="invalidInput",e[e.maxRetriesReached=3]="maxRetriesReached",e[e.modelError=4]="modelError"}(Ps||(Ps={})),function(e){e.Error="Error",e.Ok="Ok"}(Es||(Es={})),function(e){e.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",e.DuplicateQueryId="DuplicateQueryId",e.DuplicateQueryName="DuplicateQueryName",e.DuplicateStepName="DuplicateStepName",e.InvalidQueryName="InvalidQueryName",e.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",e.ParsingError="ParsingError",e.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(As||(As={})),function(e){e.Custom="Custom",e.DropColumn="DropColumn",e.DropBlankRows="DropBlankRows",e.DropDuplicates="DropDuplicates",e.FillColumn="FillColumn",e.SplitColumn="SplitColumn",e.UnpivotColumns="UnpivotColumns",e.UnpivotOtherColumns="UnpivotOtherColumns"}(Is||(Is={})),function(e){e.Column="Column",e.ColumnType="ColumnType",e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(Ds||(Ds={})),function(e){e.SelectRows="SelectRows",e.Sort="Sort",e.SelectColumns="SelectColumns",e.RenameColumns="RenameColumns",e.AddColumn="AddColumn",e.ReplaceColumn="ReplaceColumns",e.ReplaceRows="ReplaceRows",e.AddRows="AddRows",e.ReplaceValues="ReplaceValues",e.SplitColumn="SplitColumn",e.ReplaceTable="ReplaceTable"}(Rs||(Rs={})),function(e){e.InvocationPattern="InvocationPattern",e.Script="Script"}(Ts||(Ts={})),function(e){e.DataSourceTag="DataSourceTag",e.QueryEditorMessageBar="QueryEditorMessageBar",e.QuickCreateForm="QuickCreateForm",e.WebByExampleForm="WebByExampleForm"}(ks||(ks={})),function(e){e.CompilationError="CompilationError",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Fs||(Fs={})),function(e){e.Link="Link",e.Text="Text"}(Ms||(Ms={}));var Vs=j(88255),le=j(50423),Os=j(9380),Bs=j(98873),Ls=j(65181),co=j(9398),xs=j(85732),Ns=j(41114),Us="PBI.DataflowsClient.OnReadyError",Ws=Ns.cx[Us]=(0,Ns.b1)(Us),Gs=j(48741),zs=j(12966),js=j(73221),Qs=j(46544),qs=j(35510),_s=j(59017),$s=j(59973),Js=j(85928),Lr=j(77476),Zs=j(24326),Xs=["dataflowsClientIFrame"];function Ys(e,n){1&e&&(le.\u0275\u0275elementStart(0,"div",3),le.\u0275\u0275element(1,"pbi-spinner",4),le.\u0275\u0275elementEnd())}var Ks=window,eu=function(e){function n(r,o,u,i,d,S){var I=e.call(this)||this;return I.activatedRoute=r,I.featureSwitchService=o,I.store=u,I.mashupService=i,I.localizationService=d,I.telemetryService=S,I.onError=new le.EventEmitter,I.onUpdateDataflowsClient=new le.EventEmitter,I.isReady$=new qs.X(!1),I}return(0,ce.ZT)(n,e),n.prototype.ngAfterViewInit=function(){var r=this;this.dataflowsAppFeatureFlags=new Map,this.activatedRoute.snapshot.queryParamMap.keys.forEach(function(o){r.dataflowsAppFeatureFlags.set(o,r.activatedRoute.snapshot.queryParamMap.get(o))}),this.lifecycleSubscriptions.add((0,_s.aj)([this.mashupService.getPQEndpoint(),this.store.select(X.CW),this.store.select(X.T),this.store.select(X.iF)]).pipe((0,$s.h)(function(o){return!!o[0]&&!!o[1]})).subscribe(function(o){r.initDataflowsClient(o[0],o[2]?o[3]:o[1])},function(o){r.onError.emit(o)}))},n.prototype.ngOnDestroy=function(){var r;this.onUpdateDataflowsClient.emit(void 0),null===(r=this.dataflowsClient)||void 0===r||r.dispose(),e.prototype.ngOnDestroy.call(this)},n.prototype.ngOnChanges=function(r){r.flow&&r.flow.isFirstChange()&&this.startFlow(),e.prototype.ngOnChanges.call(this,r)},n.prototype.createDataflowsAppUrl=function(r){var o="".concat(r,"/DataflowsApp");if(this.dataflowsAppFeatureFlags&&this.dataflowsAppFeatureFlags.size>0){var u=new Gs.LE;this.dataflowsAppFeatureFlags.forEach(function(i,d){u=u.set(d,i)}),o=o+"?"+u.toString()}return o},n.prototype.getDefaultAppSettings=function(r){return{group:{id:r,location:"westus",languageCode:1033},hostCapabilities:{platformCapabilities:{supportsDraftDataflows:!1,supportsPublishLater:!1}},hostContext:{type:Ks.isTrident?qn.TridentDataflow:qn.PowerBIPPDF,details:{capacityObjectId:this.capacityObjectId,dataPoolId:this.dataflowId,groupObjectId:"",metadataClientType:"PowerBI",metadataProviderType:"PowerBI"}},locale:this.localizationService.currentLanguageLocale,queryEditorSettings:{closeButtonSettings:{showConfirmationPrompt:!0,actionOnConfirm:De.AlwaysCancel},enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!0,enableQueryOutputDestinations:!0,enableWelcomePane:!0,helpSettings:{communityUrl:"https://aka.ms/PQCommunity",submitAnIdeaUrl:"https://go.microsoft.com/fwlink/?linkid=2154006",supportUrl:"https://go.microsoft.com/fwlink/?linkid=2153926"},useHostConnectionProvider:!0},runMode:re.Flow,sessionId:Q.b$.generateGuid(),themeOverride:zs.z6}},n.prototype.getDefaultClientSettings=function(r){return{container:this.dataflowsClientIFrame.nativeElement,url:this.createDataflowsAppUrl(r)}},n.prototype.initDataflowsClient=function(r,o){var u=this;this.dataflowsClientIFrame.nativeElement.style.display="none",this.isReady$.next(!1),this.dataflowsClient=new Hs(_.merge({appSettings:this.getDefaultAppSettings(o),clientSettings:this.getDefaultClientSettings(r),acquireToken:function(d){return u.mashupService.getPQToken("".concat(d,"/.default")).toPromise()},acquireUPN:function(){return Promise.resolve("")}},this.clientConfigurations)),this.onUpdateDataflowsClient.emit(this.dataflowsClient),this.dataflowsClient.ready.then(function(){u.isReady$.next(!0),u.dataflowsClientIFrame.nativeElement.style.display="block"}),this.startFlow()},n.prototype.startFlow=function(){var r=this;!this.flow||!this.dataflowsClient||this.dataflowsClient.ready.then(function(){r.dataflowsClient.startFlow(r.flow,r.onCloseDataflowsClient)},function(o){r.telemetryService.logEvent(Ws,{reason:o})})},n.\u0275fac=function(o){return new(o||n)(le.\u0275\u0275directiveInject(co.gz),le.\u0275\u0275directiveInject(Os.vZ),le.\u0275\u0275directiveInject(xs.yh),le.\u0275\u0275directiveInject(Js.M),le.\u0275\u0275directiveInject(Ls.o),le.\u0275\u0275directiveInject(Qs.y0))},n.\u0275cmp=le.\u0275\u0275defineComponent({type:n,selectors:[["dataflows-client"]],viewQuery:function(o,u){var i;(1&o&&le.\u0275\u0275viewQuery(Xs,5),2&o)&&(le.\u0275\u0275queryRefresh(i=le.\u0275\u0275loadQuery())&&(u.dataflowsClientIFrame=i.first))},inputs:{capacityObjectId:"capacityObjectId",clientConfigurations:"clientConfigurations",dataflowId:"dataflowId",flow:"flow",onCloseDataflowsClient:"onCloseDataflowsClient"},outputs:{onError:"onError",onUpdateDataflowsClient:"onUpdateDataflowsClient"},features:[le.\u0275\u0275InheritDefinitionFeature,le.\u0275\u0275NgOnChangesFeature],decls:4,vars:3,consts:[["id","dataflowsClientIFrame","pbi-auto-focus",""],["dataflowsClientIFrame",""],["class","loadingSpinnerContainer",4,"ngIf"],[1,"loadingSpinnerContainer"],[1,"pbi-spinner-extra-large"]],template:function(o,u){1&o&&(le.\u0275\u0275element(0,"div",0,1),le.\u0275\u0275template(2,Ys,2,0,"div",2),le.\u0275\u0275pipe(3,"async")),2&o&&(le.\u0275\u0275advance(2),le.\u0275\u0275property("ngIf",!le.\u0275\u0275pipeBind1(3,1,u.isReady$)))},dependencies:[Lr.NgIf,Zs.k,Lr.AsyncPipe],styles:["[_nghost-%COMP%]{display:flex}#dataflowsClientIFrame[_ngcontent-%COMP%], .loadingSpinnerContainer[_ngcontent-%COMP%]{background:var(--fluent-theme-white-color, #FFF);display:flex;flex:1 1 auto;align-items:center;justify-content:center}#dataflowsClientIFrame[hidden][_ngcontent-%COMP%], .loadingSpinnerContainer[hidden][_ngcontent-%COMP%]{display:none}"],changeDetection:0}),n}(js.w),tu=function(){function e(n,r,o,u,i,d,S,I){var g=this;this.dialogRef=n,this.featureSwitchService=r,this.folderService=o,this.localizationService=u,this.route=i,this.router=d,this.store=S,this.data=I,this.flow={kind:D.PublishErrorDialog,errorInfo:this.getErrorInfo(),correlationDetails:{label:this.localizationService.get("Root_Activity_ID_Colon"),id:this.data.rootActivityId},dataflowId:this.data.dataflowId,getHelpUrl:"https://docs.microsoft.com/en-us/power-query/dataflows/troubleshooting-dataflows-issues-creating-dataflow",hostContext:{type:qn.TridentDataflow,details:{capacityObjectId:this.folderService.selectedFolder.capacityObjectId,datapoolId:this.data.dataflowId,metadataClientType:"PowerBI",metadataProviderType:"PowerBI",workspaceObjectId:this.folderService.selectedFolder.isMyWorkspace?this.folderService.selectedFolder.workspaceId:this.folderService.selectedFolder.objectId}},timestamp:this.data.timestamp},this.clientConfigurations={publishErrorDialogCallbacks:{onCallToActionButtonClick:function(){return(0,ce.mG)(g,void 0,void 0,function(){var q,me,ye;return(0,ce.Jh)(this,function(He){switch(He.label){case 0:return this.dialogRef.close(),[4,this.store.select(X.S6).pipe((0,Vs.P)()).toPromise()];case 1:return q=He.sent(),me=["workloads","dataflows","author","capacityObjectId",this.folderService.activeFolder.capacity.id,"dataflowId",this.data.dataflowId,"extensionActionId",Q.b$.generateGuid(),"workspaceObjectId",null!==(ye=q.workspaceId)&&void 0!==ye?ye:q.objectId],[4,this.router.navigate(me,{queryParamsHandling:"preserve",relativeTo:this.route})];case 2:return He.sent(),[2]}})})}}},this.onCloseDataflowsClient=function(){return(0,ce.mG)(g,void 0,void 0,function(){return(0,ce.Jh)(this,function(T){return this.dialogRef.close(),[2]})})}}return e.prototype.getErrorInfo=function(){if(this.featureSwitchService.featureSwitches.enableHostPublishErrorMessagesForGen2Dataflows){var n=this.getErrorMessages();return{kind:"Explicit",callToActionButtonLabel:this.localizationService.get("Edit_Dataflow"),disableCallToActionButton:this.data.disableCallToActionButton,errorMessage:n.errorMessage,callToActionMessage:n.callToActionMessage,errorDetails:this.data.errorDetails}}return{kind:"ErrorCode",callToActionButtonLabel:this.localizationService.get("Edit_Dataflow"),disableCallToActionButton:this.data.disableCallToActionButton,errorCode:this.data.errorCode,errorDetails:this.data.errorDetails}},e.prototype.getErrorMessages=function(){switch(this.data.errorCode){case 200060:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DependencyCycleDetected_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200020:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowRefreshInProgress_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowRefreshInProgress_CallToActionMessage")};case 200030:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DynamicDatasourceNotSupported_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200050:return{errorMessage:this.localizationService.get("Dataflow_Gen2_MashupDocumentContainsDuplicateQueryName_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200090:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowSnapshotMismatch_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowSnapshotMismatch_CallToActionMessage")};case 200100:case 200130:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowNotFound_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowNotFound_CallToActionMessage")};case 200150:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowUnauthorizedError_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowUnauthorizedError_CallToActionMessage")};case 200230:return{errorMessage:this.localizationService.get("Dataflow_DataflowPublish_CapacityThrottled"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_GenericError_CallToActionMessage")};default:return{errorMessage:this.localizationService.get("Dataflow_Gen2_GenericError_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_GenericError_CallToActionMessage")}}},e.\u0275fac=function(r){return new(r||e)(le.\u0275\u0275directiveInject(Se.so),le.\u0275\u0275directiveInject(Os.vZ),le.\u0275\u0275directiveInject(Bs.s),le.\u0275\u0275directiveInject(Ls.o),le.\u0275\u0275directiveInject(co.gz),le.\u0275\u0275directiveInject(co.F0),le.\u0275\u0275directiveInject(xs.yh),le.\u0275\u0275directiveInject(Se.WI))},e.\u0275cmp=le.\u0275\u0275defineComponent({type:e,selectors:[["dataflow-gen2-publish-error"]],decls:1,vars:3,consts:[[3,"clientConfigurations","flow","onCloseDataflowsClient"]],template:function(r,o){1&r&&le.\u0275\u0275element(0,"dataflows-client",0),2&r&&le.\u0275\u0275property("clientConfigurations",o.clientConfigurations)("flow",o.flow)("onCloseDataflowsClient",o.onCloseDataflowsClient)},dependencies:[eu],styles:["dataflows-client[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e}(),nu=j(16748),ru=function(){function e(){}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=le.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=le.\u0275\u0275defineInjector({imports:[Lr.CommonModule,nu.H]}),e}(),iu=j(95859),ou=j(76966),au=j(52950),su=[{componentType:tu,componentIdentifier:"DataflowGen2PublishErrorComponentId"}],uu=function(){function e(){}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=le.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=le.\u0275\u0275defineInjector({imports:[Lr.CommonModule,ru,ou.c.withManifest(su),iu.v,au.g]}),e}()},12966:function(ue,ze,j){"use strict";j.d(ze,{C8:function(){return ce},z6:function(){return Se}});var ce={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},Se={palette:{themePrimary:"#117865",themeLighterAlt:"#f1faf8",themeLighter:"#c9e9e3",themeLight:"#9fd6cc",themeTertiary:"#54ae9d",themeSecondary:"#218875",themeDarkAlt:"#0f6c5b",themeDark:"#0d5b4d",themeDarker:"#094339",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},semanticColors:{}}},85928:function(ue,ze,j){"use strict";j.d(ze,{M:function(){return $}});var ce=j(36444),Se=j(33567),X=j(85732),Q=(0,X.ZF)("urlConfiguration"),de=(0,X.P1)(Q,function(K){return K.powerQueryHostUrl}),De=j(37263),Me=j(59694),$e=j(11547),he=j(82762),re=j(35510),D=j(42195),Ee=j(14172),oe=j(17653),E=j(88255),be=j(50423),Oe=j(62113),ee=j(73875),te=window,$=function(){function K(se,Pe,Te,ge){var Fe=this;this.store=se,this.accessTokenProviderService=Pe,this.httpService=Te,this.inTeams=ge,this.getAADToken$=function(Ve){return(0,$e.of)(null).pipe((0,D.zg)(function(){if(te.clientAuthEnabled)return(0,he.D)(Fe.accessTokenProviderService.acquireToken("MashupService",[Ve],!1)).pipe((0,Ee.U)(function(qe){return qe.token}));if(Fe.inTeams){var Je=Ve.substring(0,Ve.lastIndexOf("/"));return ce.authentication.initialize(),(0,he.D)(ce.authentication.getAuthToken({resources:[Je],silent:!0}))}var H=(0,Me.W)("{0}/msal",te.baseUrl||window.location.origin),Xe=Fe.httpService.powerbiRequestOptions();return Xe.params={scopes:Ve},Fe.httpService.get(H,Xe).pipe((0,Ee.U)(function(qe){return qe.data.AccessToken}))}),(0,oe.b)(function(Je){var Xe=1e3*(0,Se.oG)(Je).exp;Fe.AADTokenCache$.next(new Map(Fe.AADTokenCache$.getValue()).set(Ve,{token:Je,expiration:Xe}))}))},this.AADTokenCache$=new re.X(new Map)}return K.prototype.getPQEndpoint=function(){return this.store.select(de).pipe((0,Ee.U)(function(se){return(0,Me.g)(se)?null:se.replace(/\/$/,"")}))},K.prototype.getPQToken=function(se){var Pe=this;return this.AADTokenCache$.pipe((0,E.P)(),(0,D.zg)(function(Te){return!Te.has(se)||Date.now()+3e5>Te.get(se).expiration?Pe.getAADToken$(se):(0,$e.of)(Te.get(se).token)}))},K.\u0275fac=function(Pe){return new(Pe||K)(be.\u0275\u0275inject(X.yh),be.\u0275\u0275inject(Oe.Q),be.\u0275\u0275inject(ee.O),be.\u0275\u0275inject(De.$,8))},K.\u0275prov=be.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac,providedIn:"root"}),K}()}}]);