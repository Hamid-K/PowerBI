"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["visual-container-skittles-ui"],{41606:function(re,A,r){r.d(A,{x:function(){return a}});var f=r(47508),a=function(){function D(){}return D.getDefaultVisualPlugin=function(k){return k&&k.featureSwitches&&k.featureSwitches.pivotTableVisualEnabled?f.L.tableEx:f.L.table},D}()},87644:function(re,A,r){r.d(A,{VO:function(){return D},Vj:function(){return k},ub:function(){return a}});var a="formattingService",D="formattingUIService",k=D},32441:function(re,A,r){r.d(A,{u:function(){return k}});var f=r(50423),a=r(18460),D=function(P,C,x,j,X){return{formattingSources:P,indicatorEnabled:C,mobileFormatting:x,disabledCards:j,disabledSlices:X}},k=function(){function y(){var P=this;this.mobileFormatting=!1,this.propertyChanged=new f.EventEmitter,this.outputArgs={propertyChanged:function(x){return P.propertyChanged.emit(x)}},this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="FormattingPaneComponentId"}return y.\u0275fac=function(C){return new(C||y)},y.\u0275cmp=f.\u0275\u0275defineComponent({type:y,selectors:[["formatting-pane-lazy"]],inputs:{formattingSources:"formattingSources",indicatorEnabled:"indicatorEnabled",mobileFormatting:"mobileFormatting",disabledCards:"disabledCards",disabledSlices:"disabledSlices"},outputs:{propertyChanged:"propertyChanged"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(C,x){1&C&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&C&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction5(4,D,x.formattingSources,x.indicatorEnabled,x.mobileFormatting,x.disabledCards,x.disabledSlices))("modulePath",x.modulePath)("outputArgs",x.outputArgs)("componentId",x.componentId)},dependencies:[a.R],encapsulation:2,changeDetection:0}),y}()},78633:function(re,A,r){r.d(A,{a:function(){return k}});var f=r(50423),a=r(18460),D=function(P){return{colors:P}},k=function(){function y(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="GradientBarComponentId"}return y.\u0275fac=function(C){return new(C||y)},y.\u0275cmp=f.\u0275\u0275defineComponent({type:y,selectors:[["gradient-bar-lazy"]],inputs:{colors:"colors"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(C,x){1&C&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&C&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction1(3,D,x.colors))("modulePath",x.modulePath)("componentId",x.componentId)},dependencies:[a.R],encapsulation:2,changeDetection:0}),y}()},92278:function(re,A,r){r.d(A,{I:function(){return k}});var f=r(50423),a=r(18460),D=function(P,C,x,j,X){return{toggle:P,ariaLabelledby:C,ariaDescribedby:x,toggleLabel:j,isDisabled:X}},k=function(){function y(){var P=this;this.onToggleChange=new f.EventEmitter,this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="ToggleSwitchModernComponentId",this.outputArgs={onToggleChange:function(x){return P.onToggleChange.emit(x)}}}return y.\u0275fac=function(C){return new(C||y)},y.\u0275cmp=f.\u0275\u0275defineComponent({type:y,selectors:[["toggle-switch-modern-lazy"]],inputs:{toggle:"toggle",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",toggleLabel:"toggleLabel",isDisabled:"isDisabled"},outputs:{onToggleChange:"onToggleChange"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(C,x){1&C&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&C&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction5(4,D,x.toggle,x.ariaLabelledby,x.ariaDescribedby,x.toggleLabel,x.isDisabled))("modulePath",x.modulePath)("outputArgs",x.outputArgs)("componentId",x.componentId)},dependencies:[a.R],encapsulation:2,changeDetection:0}),y}()},90094:function(re,A,r){r.d(A,{l:function(){return k}});var f=r(50423),a=r(18460),D=function(P){return{warningMessage:P}},k=function(){function y(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="WarningComponentId"}return y.\u0275fac=function(C){return new(C||y)},y.\u0275cmp=f.\u0275\u0275defineComponent({type:y,selectors:[["warning-eager"]],inputs:{warningMessage:"warningMessage"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(C,x){1&C&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&C&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction1(3,D,x.warningMessage))("modulePath",x.modulePath)("componentId",x.componentId)},dependencies:[a.R],encapsulation:2,changeDetection:0}),y}()},42101:function(re,A,r){r.d(A,{p:function(){return S}});var f=r(9844),P=(r(32441),r(78633),r(92278),r(90094),r(77476)),C=r(9398),x=r(76072),j=r(77906),X=r(50423),N={loadChildren:function(){return Promise.all([r.e(5),r.e("pane-formatting")]).then(r.bind(r,53150)).then(function(h){return h.PaneFormattingModule})}};x.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",N.loadChildren);var ee=[{path:"dummy-pane-formatting-lazy",loadChildren:N.loadChildren}],S=function(){function e(){}return e.\u0275fac=function(M){return new(M||e)},e.\u0275mod=X.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=X.\u0275\u0275defineInjector({imports:[P.CommonModule,f.j,j.N,C.Bz.forChild(ee)]}),e}()},79930:function(re,A,r){r.d(A,{EY:function(){return e},Wg:function(){return h}});var f=r(81337),a=r(8082),D=r(40823),k=r(83008),y=r(77616),P=r(54766),C=r(3468),x=r(74082),j=r(25740),X=r(65181),N=r(58938),ee=r(4877),H=r(50423),e={provide:"conditionalFormattingDialogLauncherService",useFactory:function(M,m,u,v,F,w){return new h(M,m,u,v,F,w)},deps:[X.o,N.x,ee.a,k.D,a.s,D._]},h=function(){function M(m,u,v,F,w,G){this.localizationService=m,this.dialogService=u,this.itemPickerService=v,this.dataSourcesService=F,this.runningVisuals=w,this.dataSourcesSerializer=G}return M.prototype.show=function(m,u,v,F,w,G){return(0,f.mG)(this,void 0,void 0,function(){var V;return(0,f.Jh)(this,function(Q){switch(Q.label){case 0:return V=v&&(0,x.tO)(v)?v.measure:v,[4,this.showModernConditionaFormattingDialog(m,u,V,F,w,G)];case 1:return[2,Q.sent().afterClosed().toPromise()]}})})},M.prototype.showModernConditionaFormattingDialog=function(m,u,v,F,w,G){var V,U;return(0,f.mG)(this,void 0,void 0,function(){var Q,Ce,q,me,Fe;return(0,f.Jh)(this,function(_e){return Q=this.dataSourcesSerializer.serializeDataSources(this.dataSourcesService.get()),Ce=F.propertyDescriptor,q=this.runningVisuals.getVisual(m),me={colorPalette:(0,j.NO)(G.colorPalette),icons:null===(V=this.itemPickerService)||void 0===V?void 0:V.getIcons(),iconSets:null===(U=this.itemPickerService)||void 0===U?void 0:U.getIconSets(),inDataSources:Q,propertySelector:F.selector&&(0,P.UZ)(F.selector),allowOverrideTotalMatching:F.allowOverrideSubtotalMatching,propertyDefinition:w&&(0,P.W7)(w,Ce),propertyDescriptor:(0,y.m8)(Ce,this.localizationService),targetFieldDisplayName:u,targetFieldExpr:v&&C.ib.serializeExpr(v),visualType:q.getType(),hasGrouping:!!F.selector&&this.hasGroupingColumn(q)},Fe={title:"".concat(me.propertyDescriptor.displayName," - ").concat(me.targetFieldDisplayName),input:me,hideOkButton:!1,hideCancelButton:!1,focusInitialCloseButton:!0,footerLink:{text:this.localizationService.get("ConditionalFormattingDialog_LearnMore"),url:"https://go.microsoft.com/fwlink/?linkid=874399",type:"external"}},[2,this.dialogService.showTemplateDialog("ConditionalFormattingDialog",Fe,{minWidth:"940px",height:"665px",autoFocus:!0})]})})},M.prototype.hasGroupingColumn=function(m){if(!m)return!1;var u=m.getDataViews()[0];if(u.metadata&&u.metadata.columns)for(var v=0,F=u.metadata.columns;v<F.length;v++)if(!F[v].isMeasure)return!0;return!1},M.\u0275fac=function(u){return new(u||M)(H.\u0275\u0275inject(X.o),H.\u0275\u0275inject(N.x),H.\u0275\u0275inject(ee.a),H.\u0275\u0275inject(k.D),H.\u0275\u0275inject(a.s),H.\u0275\u0275inject(D._))},M.\u0275prov=H.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac}),M}()},51576:function(re,A,r){r.r(A),r.d(A,{VisualContainerSkittlesUIModule:function(){return qi}});var f=r(77476),a=r(32288),D=r(91280),k=r(42101),y=r(77906),P=r(95859),C=r(47913),x=r(63654),j=r(45411),X=r(66972),N=r(13254),ee=r(72359),H=r(16095),S=r(17177),e=r(50423),h=r(36858),M=r(74913),m=function(){function l(){}return l.prototype.ngOnInit=function(){this.infoIconName=this.mouseOutIcon},l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["build-field-well-info"]],inputs:{iconSprite:"iconSprite",mouseInIcon:"mouseInIcon",mouseOutIcon:"mouseOutIcon",tooltip:"tooltip"},decls:1,vars:4,consts:[["role","tooltip","tri-svg-icon-16","","tabIndex","0",2,"margin-left","4px","margin-top","6px","fill","currentColor",3,"name","sprite","pbiTooltip","mouseenter","mouseleave"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"tri-svg-icon",0),e.\u0275\u0275listener("mouseenter",function(){return i.infoIconName=i.mouseInIcon})("mouseleave",function(){return i.infoIconName=i.mouseOutIcon}),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("name",i.infoIconName)("sprite",i.iconSprite)("pbiTooltip",i.tooltip),e.\u0275\u0275attribute("aria-label",i.tooltip))},dependencies:[h.V,M.M],encapsulation:2}),l}(),u=r(81337),v=r(35510),F=r(30794),w=r(59017),G=r(63057),V=r(37272),U=r(59973),Q=r(81905),Ce=r(22318),q=r(83317),me=r(13941),Fe=r(98476),ke=r(96127),_e=r(73221),We=r(96883),T=r(61561),W=r(8590),R=r(60661),Z=r(41606),de=r(38078),ge=r(57419),b=r(62458),Be=r(45413),Se=r(74082),xt=r(58295),Ze=r(45551),xe=r(58609),Ye=r(43626),Et=r(79930),qe=r(26898),je=r(54952),$e=r(83008),Pt=r(85677),et=r(10861),Ft=r(48145),Ne=r(11494),kt=r(13702),tt=r(8082),it=r(15393),It=r(9380),Ot=r(23983),we=r(28894),Le=r(65181),Mt=r(88409),Tt=r(29866),Bt=r(67930);function wt(l,n){if(1&l&&e.\u0275\u0275element(0,"build-field-well-info",6),2&l){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tooltip",t.bucketInfTooltip)}}function Lt(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",2)(2,"h2",3),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,wt,1,1,"build-field-well-info",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"field-picker-modern-lazy",5),e.\u0275\u0275listener("onExprChange",function(d){var g=e.\u0275\u0275restoreView(t).$implicit,E=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(E.onFieldsChange(d,g))})("onCrossPickerDrop",function(d){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onCrossBucketFieldDrop(d))}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&l){var s,i=n.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.displayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.hasHiddenFieldsInVisual),e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabelledby",o.bucketTitle)("disabled",i.disabled)("initialExpr",i.exprs)("withFieldList",!0)("allowMultipleValues",i.supportsMultipleItems)("allowReorderItems",null===(s=o.allowReorderFields)||void 0===s||s)("promotedActionStrategy",i.showHideProjectionStrategy)("getDropExprStrategy",i.getDropExprStrategy)("menuStrategy",i.menuStrategy)("displayNameStrategy",i.displayNameStrategy)("flyoutFieldsStrategy",i.fieldFlyoutFieldsStrategy)("visualCalcFieldsStrategy",i.visualCalcFlyoutFieldsStrategy)("directEditStrategy",i.directEditStrategy)("enterExitFieldRename",e.\u0275\u0275pipeBind1(6,24,i.enterExitFieldRename$))("externalCrossPickerDragDropMonitor",i.crossBucketDragDropMonitor)("perspectiveDisplayName",o.perspectiveDisplayName)("tooltipWithFlexiblePositions",!1)("parameterPickerDataFormat",o.parameterPickerDataFormat)("visualCapabilities",o.visualCapabilities)("addDataAriaLabelKey",i.addDataAriaLabelKey)("emptyFieldSetsDefaultLabel",!o.isVisualCalc)("role",i.role)}}var nt=function(l){function n(t,i,o,s,c,d,p,g,E,z,Y,I,pe,te,ue,L,le,J){var O=l.call(this)||this;O.changeDetectorRef=t,O.conceptualSchemaProxy=i,O.contextActivityService=o,O.dataSourcesService=s,O.eventBridge=c,O.explorationDisplayNameService=d,O.featureSwitchService=p,O.groupingDesignStateService=g,O.lazyScoped=E,O.localizationService=z,O.runningVisualService=Y,O.showValueAsService=I,O.visibilityService=pe,O.visualAuthoring=te,O.visualCalcEagerService=ue,O.visualPlugin=L,O.explorationCapabilitiesService=le,O.visualActionContext=J,O.contentUpdate=new e.EventEmitter,O.parameterPickerDataFormat="buildfieldwell",O.fieldBucketsInternal$=new v.X(void 0),O.uid=de.b$.generateGuid(),O.manualUpdate$=new F.xQ,O.fieldBuckets$=O.fieldBucketsInternal$.asObservable();var B,fe=new ge.W,se=O.changes$("visualContainer");return(0,w.aj)([se.pipe(),(0,G.T)(O.manualUpdate$,O.visualCalcEagerService.onContextChange$(),O.visibilityService.get$(16),O.eventBridge.on(W.CCe),O.eventBridge.on(W.KD7),O.eventBridge.on(W.jCS),se.pipe((0,U.h)(function(K){return!!K}),(0,Q.w)(function(K){return O.runningVisualService.getVisual$(K)}),(0,Q.w)(function(K){return K?K.getErrorInfo$():V.E})),O.eventBridge.on(W.D1A)).pipe((0,Ce.O)(void 0))]).pipe((0,q.R)(O.onDestroy$)).subscribe(function(K){var he=K[0];return(0,u.mG)(O,void 0,void 0,function(){var ve=this;return(0,u.Jh)(this,function(Pe){switch(Pe.label){case 0:return[4,fe.enqueue(function(){return(0,u.mG)(ve,void 0,void 0,function(){var ie,ne=this;return(0,u.Jh)(this,function(oe){switch(oe.label){case 0:return this.visualCapabilities=(0,R.cj)(he,this.visualPlugin),this.contentUpdate.emit({type:"start",forVisualContainerChange:ie=he!==B}),[4,this.updateFieldBuckets(he)];case 1:return oe.sent(),this.changeDetectorRef.detectChanges(),setTimeout(function(){ne.contentUpdate.emit({type:"end",forVisualContainerChange:ie})}),B=he,[2]}})})})];case 1:return Pe.sent(),[2]}})})}),O.showFieldTooltip=O.localizationService.get("Visual_Calculation_Field_Well_Show_In_Visual"),O.hideFieldTooltip=O.localizationService.get("Visual_Calculation_Field_Well_Hide_From_Visual"),O.bucketInfTooltip=O.localizationService.get("Visual_Calculation_Field_Bucket_Tooltip"),O}return(0,u.ZT)(n,l),n.prototype.onFieldsChange=function(t,i){return(0,u.mG)(this,void 0,void 0,function(){var o,s;return(0,u.Jh)(this,function(c){switch(c.label){case 0:return s=!0,(0,me.JB)(o=t.fromUpdate)?[4,this.handleAdd(i,o,t.newExpr)]:[3,2];case 1:return s=c.sent(),[3,9];case 2:return(0,me.H2)(o)?[4,this.handleDelete(i,o)]:[3,4];case 3:return c.sent(),[3,9];case 4:return(0,me.cA)(o)?[4,this.handleReplace(i,o,t.newExpr)]:[3,6];case 5:return s=c.sent(),[3,9];case 6:return(0,me.cS)(o)?(b.fF.assert(function(){return _.isArray(t.newExpr)},"there must be multiple fields when reoreder udpate happpens"),[4,this.handleReorder(i,o,t.newExpr)]):[3,8];case 7:return s=c.sent(),[3,9];case 8:(0,me.y$)(o)&&this.handleRename(i,o),c.label=9;case 9:return s||this.manualUpdate$.next(),[2]}})})},n.prototype.onCrossBucketFieldDrop=function(t){if(t.fromGroupId===this.uid&&t.toGroupId===this.uid){var i=t.fromComponentId,o=t.toComponentId;if(i===o)return void b.fF.assertFail("Expect this only be called when field is moved between different buckets");var s=this.fieldBucketsInternal$.value,c=_.find(s,function(te){return te.bucketUid===i});if(c){var d=_.find(s,function(te){return te.bucketUid===o});if(d){var p=t.fromPosition,g=t.toPosition;b.fF.assert(function(){return 1===_.size(p)&&("end"===g||1===_.size(g))},"build-field-well supports cross-bucket drag-drop of first-level items only. Add your implementation for new scenario.");var z="end"===g?"end":g[0],Y=c.properties[p[0]],I={sourceRole:c.role,sourceIndex:Y.startIndex,hierarchyLevelCount:_.size(Y.hierarchyLevels)};"end"===z?d.core.dropWithPayload(I):d.properties[z].core.dropWithPayloadAndAction(I,2)}}}},n.prototype.updateFieldBuckets=function(t){return(0,u.mG)(this,void 0,void 0,function(){var i,o,s,c,d,p,g,E,z,Y,I,pe,te,ue,L=this;return(0,u.Jh)(this,function(le){switch(le.label){case 0:return this.fieldWellViewModelService?[3,2]:(i=this,[4,this.lazyScoped.get(ke.A)]);case 1:i.fieldWellViewModelService=le.sent(),le.label=2;case 2:return this.fieldWellBucketService?[3,4]:(o=this,[4,this.lazyScoped.get(Ye.fI)]);case 3:o.fieldWellBucketService=le.sent(),le.label=4;case 4:return this.fieldWellFieldService?[3,6]:(s=this,[4,this.lazyScoped.get(Ye.tE)]);case 5:s.fieldWellFieldService=le.sent(),le.label=6;case 6:return t?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:(c=(0,R.x3)(Z.x.getDefaultVisualPlugin(this.featureSwitchService)),d=this.fieldWellViewModelService.createEmptyBuckets(c,[]),b.fF.assert(function(){return 1===_.size(d)},"build-field-well should show only one empty bucket when no visual is selected"),p=d[0],g=this.localizationService.get("Data"),(E=(0,u.pi)((0,u.pi)({},p),{core:this.getFieldWellBucketCore(p),displayName:g,addDataAriaLabelKey:this.localizationService.format("Skittles_Build_AddData",g)})).fieldFlyoutFieldsStrategy=this.getFieldFlyoutFieldsStrategy(E,0,t),this.fieldBucketsInternal$.next([E]),[2]);case 7:return z=le.sent(),this.isVisualCalc=16===t.visibility,[4,this.fieldWellViewModelService.createBuckets(this.runningVisualService.getVisual(t),t,z,this.groupingDesignStateService,this.showValueAsService,this.visualPlugin,this.explorationDisplayNameService,[],!1,this.isVisualCalc,!0,this.overrideSingleBucketForAutoVisual).promise];case 8:for(Y=le.sent(),I=_.map(Y,function(J){var O=L.isVisualCalc?J.properties:_.filter(J.properties,function(ie){return!ie.isHiddenInVisual}),B=J.properties.length>O.length;J.properties=O,J.supportsMultipleItems=L.isVisualCalc||J.supportsMultipleItems;var ae={getDropExpr:function(ne,oe){return Promise.resolve({expr:ne})},getDroppedExprChildren:function(ne,oe,be,ye){return L.getChildExprs(J,oe,be,ye)}},fe={getMenu:function(ne,oe,be,ye){return void 0===ye&&(ye=void 0),L.getMenu(J,ne,oe,ye)},menuItemClickHandler:function(ne,oe,be){b.fF.assert(function(){return 1===_.size(oe)},"build-field-well supports menu on first-level items, i.e., non hierarchy-levels only. Add your implementation for new scenario."),Pe[oe[0]].core.selectFieldMenuItem(ne.data)}},se={getDisplayName:function(ne,oe,be,ye){return L.getFieldDisplayName(J,oe,ye)},isRenameAllowed:function(ne,oe){return L.getIsRenameAllowed(J,ne,oe)},getCustomTooltipContent:function(ne,oe,be,ye){return L.getCustomTooltipContent(J,be,ye)},isFieldInvalid:function(ne,oe){return L.getIsFieldInvalid(J,ne,oe)},getDisplayNameStyle:function(ne,oe){return L.getFieldDisplayNameStyle(J,ne,oe)}},K=_.map(J.properties,function(ie){return ie.expr}),he=new v.X(void 0),ve=(0,u.pi)((0,u.pi)({},J),{bucketUid:de.b$.generateGuid(),exprs:J.supportsMultipleItems?_.map(K,function(ie){return{expr:ie}}):K[0]?{expr:K[0]}:void 0,core:L.getFieldWellBucketCore(J),getDropExprStrategy:ae,menuStrategy:fe,displayNameStrategy:se,enterExitFieldRename$:he,addDataAriaLabelKey:L.localizationService.format("Skittles_Build_AddData",J.displayName)}),Pe=_.map(J.properties,function(ie,ne){return(0,u.pi)((0,u.pi)({},ie),{core:L.getFieldWellFieldCore(ve,ne,ie),showHideFieldAction$:new v.X(L.generateFieldAction(t,ie))})});return ve.properties=Pe,ve.showHideProjectionStrategy={getAction:function(ne,oe){if(L.isShowHideActionInfoReady(oe)&&1===_.size(ne))return ve.properties[ne[0]].showHideFieldAction$.asObservable()}},ve.hasHiddenFieldsInVisual=B,ve}),pe=function(O){var B=I[O];B.crossBucketDragDropMonitor={groupId:te.uid,componentId:B.bucketUid},B.fieldFlyoutFieldsStrategy=te.getFieldFlyoutFieldsStrategy(B,O,t),te.featureSwitchService.featureSwitches.visualCalculationPencilIcon?B.directEditStrategy={onEdit:function(se){return(0,u.mG)(L,void 0,void 0,function(){var K,he;return(0,u.Jh)(this,function(ve){switch(ve.label){case 0:return null==(K=B.properties[se[0]])?[2]:(he=(0,R.$Z)(t,K.role,K.startIndex),[4,this.enterVisualCalcMode(t,he)]);case 1:return ve.sent(),[2]}})})},isDisabled:function(se){if(!L.visualCalcEagerService.isVisualCalcAuthoringEnabled()||L.explorationCapabilitiesService.getCapabilities().disableVisualCalcAuthoring)return!0;var K=B.properties[se[0]];if(null==K)return!0;b.fF.assert(function(){return(0,Se.jX)(K.expr)},"Expect only native visual calc fields to be editable");var he=K.expr,ve=_.find((0,R.oJ)(t),function(Pe){return Pe.nativeReferenceName===he.name});return null==ve||L.visualCalcEagerService.shouldDisableEditing(ve.name,t)},getActionTooltip:function(){return L.visualCalcEagerService.isVisualCalcAuthoringEnabled()?L.explorationCapabilitiesService.getCapabilities().disableVisualCalcAuthoring?L.localizationService.get("FieldWell_EditVisualCalculation_Disabled_From_Explore"):L.localizationService.get("Calculation_Options_Pencil"):L.localizationService.get("Calculation_Options_NoFS")},shouldAllowDirectEdit:function(se){var K,he=null===(K=B.properties[se[0]])||void 0===K?void 0:K.expr;return null!=he&&(0,Se.jX)(he)}}:B.visualCalcFlyoutFieldsStrategy={onEditVisualCalc:function(se){return(0,u.mG)(L,void 0,void 0,function(){return(0,u.Jh)(this,function(K){switch(K.label){case 0:return[4,this.enterVisualCalcMode(t,se)];case 1:return K.sent(),[2]}})})},getQueryName:function(se){var K=B.properties[se[0]];if(null!=K)return(0,R.$Z)(t,K.role,K.startIndex)},isEditableVisualCalc:function(se){return!(!L.visualCalcEagerService.isVisualCalcAuthoringEnabled()||null==se)&&(0,Se.jX)(se)}}},te=this,ue=0;ue<I.length;ue++)pe(ue);return this.fieldBucketsInternal$.next(I),[2]}})})},n.prototype.enterVisualCalcMode=function(t,i){return(0,u.mG)(this,void 0,void 0,function(){var o;return(0,u.Jh)(this,function(s){switch(s.label){case 0:return o=(0,xe.hF)(this.contextActivityService,{name:"VisualAction",visualName:this.visualContainer.name,data:(0,u.pi)((0,u.pi)({},this.visualActionContext),{action:"EditVisualCalculation"})}),[4,this.visualCalcEagerService.enterVisualCalcMode(t,i,o)];case 1:return s.sent(),[2]}})})},n.prototype.getFieldFlyoutFieldsStrategy=function(t,i,o){var s=this;return{getFieldsToSelectOnOpen:function(p,g){return s.getInitialFlyoutFieldsToSelect(t,p,g)},getFieldsToDisableOnOpen:function(p,g,E,z){return s.getInitialFlyoutFieldsToDisable(t,p,z)},handleSelectedField:function(p,g){return(0,u.mG)(s,void 0,void 0,function(){return(0,u.Jh)(this,function(E){switch(E.label){case 0:return[4,this.handleSelectedField(t,p,g)];case 1:return E.sent(),[2]}})})},handleDeselectedField:function(p){return s.handleDeselectedField(s.fieldBucketsInternal$.value[i],p)},onCloseWithCreateVisualCalc:function(p){return(0,u.mG)(s,void 0,void 0,function(){return(0,u.Jh)(this,function(g){switch(g.label){case 0:return[4,this.onCloseFlyoutWithCreateVisualCalc(o,p)];case 1:return g.sent(),[2]}})})},getVisualCalcCreationInfo:function(p){return(0,u.mG)(s,void 0,void 0,function(){return(0,u.Jh)(this,function(g){switch(g.label){case 0:return[4,this.getVisualCalcCreationInfo(o,p)];case 1:return[2,g.sent()]}})})},canOpenFlyout:function(p){var g;if(null==p)return!1;if(!s.featureSwitchService.featureSwitches.visualCalculationPencilIcon)return!0;var E=null===(g=t.properties[p[0]])||void 0===g?void 0:g.expr;return null==E||!(0,Se.jX)(E)}}},n.prototype.generateFieldAction=function(t,i){var o=this;if(16===t.visibility){var s=i.expr;if(null!=s&&((0,xt.k)(s)||(0,Se.jX)(s))){var c=i.isHiddenInVisual,d=i.role,p=i.startIndex;return{tooltip:c?this.showFieldTooltip:this.hideFieldTooltip,svgIconName:c?"eye_off_16_regular":"eye_16_regular",svgIconSpriteName:"fluentui-icons",handler:function(){o.visualAuthoring.toggleFieldHidden(d,p,t,o.dataSourcesService.get())}}}}},n.prototype.getCustomTooltipContent=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);b.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c?{title:d.displayOptions.tooltipTitle,description:d.displayOptions.tooltipDescription}:{title:d.hierarchyLevels[i[1]].tooltipTitle}}},n.prototype.getFieldDisplayName=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);b.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c?d.displayOptions.displayName:d.hierarchyLevels[i[1]].displayName}},n.prototype.getFieldDisplayNameStyle=function(t,i,o){var s={};if(!this.isNameInfoReadyAtUpdate(o))return s;var d=_.size(i);b.fF.assert(function(){return 1===d||2===d},"fields in build-field-well has either 1 or 2 levels");var p=_.nth(t.properties,i[0]);return null!=p?.displayOptions.pbiStyle?p.displayOptions.pbiStyle:s},n.prototype.getIsFieldInvalid=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);b.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c&&!d.valid}},n.prototype.isNameInfoReadyAtUpdate=function(t){var i=t.type;switch(i){case"delete":case"add":case"reorder":case"replace":return!1;case"rename":b.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":return!0;default:return void b.fF.assertNever(i)}},n.prototype.isShowHideActionInfoReady=function(t){var i=t.type;switch(i){case"add":case"replace":case"delete":return!1;case"initialize":case"rename":case"reorder":return!0;default:return void b.fF.assertNever(i)}},n.prototype.getMenu=function(t,i,o,s){var c,d,p=s.type;switch(p){case"delete":b.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"rename":case"reorder":case"replace":d=!1;break;case"initialize":d=!0;break;default:b.fF.assertNever(p)}if(d){var g=_.size(o);if(b.fF.assert(function(){return 1===g||2===g},"fields in build-field-well has either 1 or 2 levels"),1===g){var E=_.nth(t.properties,o[0]);if(!E||!(0,Be.fS)(E.expr,i))return void b.fF.assertFail("expression (after drop) of property at index "+o[0]+" does not match expected");var z=null===(c=E.interactivityOptions)||void 0===c?void 0:c.dropDownItems;return _.isEmpty(z)?void 0:(0,We.m)(z)}}},n.prototype.getIsRenameAllowed=function(t,i,o){var s,c,d=o.type;switch(d){case"delete":b.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"reorder":case"replace":c=!1;break;case"rename":b.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":c=!0;break;default:b.fF.assertNever(d)}if(c){var p=_.size(i);if(b.fF.assert(function(){return 1===p||2===p},"fields in build-field-well has either 1 or 2 levels"),1===p)return null===(s=_.nth(t.properties,i[0]).interactivityOptions)||void 0===s?void 0:s.isEditableField}},n.prototype.getChildExprs=function(t,i,o,s){var c,d=s.type;switch(d){case"delete":b.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"reorder":case"replace":c=!1;break;case"rename":b.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":c=!0;break;default:b.fF.assertNever(d)}if(c&&1===_.size(i)){var p=ot(t,i[0],o);return _.map(p,function(g){return{expr:g}})}},n.prototype.getInitialFlyoutFieldsToSelect=function(t,i,o){if(b.fF.assert(function(){return!!o==!!i},"flyoutOpenFromPosition and flyoutOpenFromField should be both undefined or defined"),o){b.fF.assert(function(){return _.size(i)<=2},"build-field-well have maximum 2 levels of fiels");var s=_.nth(t.properties,i[0]),c=s.expr;if(b.fF&&2===_.size(i))if((0,Se.ez)(o)){var d=(0,Se.t3)(c)&&(0,Be.fS)((0,Ze.ZB)(o),c),p=(0,Se.y3)(c)&&(0,Be.fS)(c,o.arg);b.fF.assert(function(){return d||p},"in build-field-well, a hierarchy-level field's parent should be its variation source or owning hierarchy")}else b.fF.assertFail("second level fields of build-field-well should be hierarchy levels");return _.isEmpty(s.hierarchyLevels)?[c]:[s.hierarchyLevels[0].expr.arg]}},n.prototype.getInitialFlyoutFieldsToDisable=function(t,i,o){if(i)return b.fF.assert(function(){return _.size(i)<=2},"build-field-well have maximum 2 levels of fiels"),ot(t,i[0],o)},n.prototype.handleDeselectedField=function(t,i){var o=(0,Fe.f)(i,t.properties);_.isEmpty(o)||this.handleDelete(t,{type:"delete",deleted:{position:o,expr:i}})},n.prototype.handleSelectedField=function(t,i,o){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(s){switch(s.label){case 0:return o?(b.fF.assert(function(){return _.size(o)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),b.fF.assert(function(){return 1===_.size(o)||!!_.nth(t.properties[o[0]].hierarchyLevels,o[1])},"build-field-well flyout opened from second-level field should correspond to a hierarchy level"),[4,t.properties[o[0]].core.dropField(i,1)]):[3,2];case 1:return s.sent(),[3,3];case 2:t.core.dropField(i),s.label=3;case 3:return[2]}})})},n.prototype.onCloseFlyoutWithCreateVisualCalc=function(t,i){var o,s;return(0,u.mG)(this,void 0,void 0,function(){var c,d,p,E;return(0,u.Jh)(this,function(z){switch(z.label){case 0:c=(0,xe.hF)(this.contextActivityService,{name:"VisualAction",visualName:this.visualContainer.name,data:(0,u.pi)((0,u.pi)({},this.visualActionContext),{action:"CreateVisualCalculation"})}),z.label=1;case 1:return z.trys.push([1,5,,6]),null!=this.visualCalcService?[3,3]:(d=this,[4,this.lazyScoped.get(T.w)]);case 2:d.visualCalcService=z.sent(),z.label=3;case 3:return p=null===(s=null===(o=t?.config)||void 0===o?void 0:o.singleVisual)||void 0===s?void 0:s.autoSelectVisualType,[4,this.visualCalcService.enterVisualCalcMode(t,void 0,p?void 0:i,c)];case 4:return z.sent(),c.resolve(),[3,6];case 5:throw E=z.sent(),c.reject(E),E;case 6:return[2]}})})},n.prototype.getVisualCalcCreationInfo=function(t,i){return(0,u.mG)(this,void 0,void 0,function(){var o;return(0,u.Jh)(this,function(s){switch(s.label){case 0:return null!=this.visualCalcService?[3,2]:(o=this,[4,this.lazyScoped.get(T.w)]);case 1:o.visualCalcService=s.sent(),s.label=2;case 2:return[4,this.visualCalcService.getVisualCalcCreationInfo(t,this.visualCapabilities,i)];case 3:return[2,s.sent()]}})})},n.prototype.handleAdd=function(t,i,o){return(0,u.mG)(this,void 0,void 0,function(){var s,d,p;return(0,u.Jh)(this,function(pe){return s=_.isArray(o)?o:o?[o]:[],1===_.size(s)?[2,t.core.dropField(s[0].expr)]:(d=i.added.position,b.fF.assert(function(){return"end"===d||1===_.size(d)},"build-field-well only allows add into first-level fields."),(p="end"===d?_.size(s)-1:d[0])===_.size(s)-1?[2,t.core.dropField(_.last(s).expr)]:[2,t.properties[p].core.dropWithPayloadAndAction({field:i.added.pickerOriginalExpr},2)])})})},n.prototype.handleDelete=function(t,i){return(0,u.mG)(this,void 0,void 0,function(){var o,s,c,d;return(0,u.Jh)(this,function(p){switch(p.label){case 0:return o=i.deleted.position,b.fF.assert(function(){return 1===_.size(o)||2===_.size(o)},"build-field-well supports maximum 2-levels of fields"),s=_.first(o),b.fF.assert(function(){return _.inRange(s,0,_.size(t.properties))},"first level fieldindex to delete is not in valid range"),c=t.properties[s],d=_.nth(o,1),b.fF.assert(function(){return null==d||_.inRange(d,0,_.size(c.hierarchyLevels))},"child index to delete is not in valid range"),[4,c.core.deleteField(d)];case 1:return p.sent(),[2]}})})},n.prototype.handleReorder=function(t,i,o){return(0,u.mG)(this,void 0,void 0,function(){var s,c,d,p,g,E,z;return(0,u.Jh)(this,function(I){return s=i.reordered.fromPosition,c=i.reordered.toPosition,b.fF.assert(function(){return 1===_.size(s)&&1===_.size(c)},"build-field-well supports reordering of first-level items only. Add your implementation for new scenario."),d=s[0],b.fF.assert(function(){return _.inRange(d,0,_.size(t.properties))},"reorder.fromIndex is not in valid range"),p={sourceRole:t.role,sourceIndex:t.properties[d].startIndex,hierarchyLevelCount:_.size(t.properties[d].hierarchyLevels)},z=c[0],b.fF.assert(function(){return _.inRange(z,0,_.size(t.properties)+1)},"reorder.toIndex is not in valid range"),z===_.size(o)?(g=_.last(t.properties).core,E=3):(g=t.properties[z].core,E=2),[2,g.dropWithPayloadAndAction(p,E)]})})},n.prototype.handleReplace=function(t,i,o){return(0,u.mG)(this,void 0,void 0,function(){var s,c,d;return(0,u.Jh)(this,function(p){return s=i.replaced.position,b.fF.assert(function(){return 1===_.size(s)},"build-field-well only allows replace first-level fields from underlying pbi-drag-drop-picker"),c=s[0],b.fF.assert(function(){return _.inRange(c,0,_.size(t.properties))},"index to replace is not in valid range"),b.fF.assert(t.supportsMultipleItems?function(){return _.isArray(o)&&_.size(t.properties)===_.size(o)}:function(){return!_.isArray(o)&&1===_.size(t.properties)},"properties and newExprsAfterUpdate size mismatch"),d=_.isArray(o)?o[c]:o,[2,t.properties[c].core.dropField(d.expr,1)]})})},n.prototype.handleRename=function(t,i){var o=i.renamed.position;b.fF.assert(function(){return 1===_.size(o)},"build-field-well only allows rename of first-level fields");var s=i.renamed.newName,c=t.properties[o[0]];b.fF.assertValue(c,"Invalid fieldIndex"),c.core.rename(s)},n.prototype.getFieldWellFieldCore=function(t,i,o){var s=this,c=this.fieldWellFieldService.createFieldWellFieldCore(void 0,function(d){return s.onLabelInEditingModeChanged(t,i,d)});return c.viewModel=o,c},n.prototype.onLabelInEditingModeChanged=function(t,i,o){t.enterExitFieldRename$.next({fieldPosition:[i],modeOn:!!o})},n.prototype.getFieldWellBucketCore=function(t){var i=this.fieldWellBucketService.createFieldWellBucketCore();return i.viewModel=t,i},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(qe.i),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject($e.D),e.\u0275\u0275directiveInject(Ne.J),e.\u0275\u0275directiveInject(kt.O),e.\u0275\u0275directiveInject(It.vZ),e.\u0275\u0275directiveInject(Ot.AA),e.\u0275\u0275directiveInject(we.H),e.\u0275\u0275directiveInject(Le.o),e.\u0275\u0275directiveInject(tt.s),e.\u0275\u0275directiveInject(Pt.P),e.\u0275\u0275directiveInject(it.w),e.\u0275\u0275directiveInject(et.$8),e.\u0275\u0275directiveInject(Mt.w),e.\u0275\u0275directiveInject(Tt.D),e.\u0275\u0275directiveInject(Ft.U),e.\u0275\u0275directiveInject(xe.yk))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-field-well"]],inputs:{visualContainer:"visualContainer",perspectiveDisplayName:"perspectiveDisplayName",allowReorderFields:"allowReorderFields",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual"},outputs:{contentUpdate:"contentUpdate"},features:[e.\u0275\u0275ProvidersFeature([Et.Wg]),e.\u0275\u0275InheritDefinitionFeature],decls:3,vars:3,consts:[[1,"buildFieldWell"],[4,"ngFor","ngForOf"],[1,"bucketHeader"],["id","bucketTitle",1,"bucketTitle"],["iconSprite","fluentui-icons","mouseInIcon","info_20_filled","mouseOutIcon","info_20_regular",3,"tooltip",4,"ngIf"],["tooltipPosition","before",3,"ariaLabelledby","disabled","initialExpr","withFieldList","allowMultipleValues","allowReorderItems","promotedActionStrategy","getDropExprStrategy","menuStrategy","displayNameStrategy","flyoutFieldsStrategy","visualCalcFieldsStrategy","directEditStrategy","enterExitFieldRename","externalCrossPickerDragDropMonitor","perspectiveDisplayName","tooltipWithFlexiblePositions","parameterPickerDataFormat","visualCapabilities","addDataAriaLabelKey","emptyFieldSetsDefaultLabel","role","onExprChange","onCrossPickerDrop"],["iconSprite","fluentui-icons","mouseInIcon","info_20_filled","mouseOutIcon","info_20_regular",3,"tooltip"]],template:function(i,o){1&i&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Lt,7,26,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,o.fieldBuckets$)))},dependencies:[f.NgForOf,f.NgIf,Bt.m,m,f.AsyncPipe],styles:['.buildFieldWell[_ngcontent-%COMP%]   .bucketHeader[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;flex-direction:row}.buildFieldWell[_ngcontent-%COMP%]   .bucketTitle[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin:8px 0 4px}.buildFieldWell[_ngcontent-%COMP%]     .drap-drop-picker{background:white}'],changeDetection:0}),n}(_e.w);function ot(l,n,t){var i=_.nth(l.properties,n);if(!_.isEmpty(i.hierarchyLevels)){var o=_.map(i.hierarchyLevels,function(c){return c.expr});if(b.fF){var s=(0,Ze.wA)(t,i.expr);if(!_.isArray(s)||_.isEmpty(s))return void b.fF.assertFail("Corresponding bucket property has hierarchyLevels, the expanded expr should have hierarchy level children as well");_.some(o,function(c){return!_.find(s,function(d){return(0,Be.fS)(d,c)})})&&b.fF.assertFail("Cannot find the corresponding bucket property hierarchyLevel in hierarchy levels expanded from the dropped expr")}return o}}var ce=r(14172),Dt=r(59051),Vt=r(96441),De=r(86286),Ee=r(49977),Rt=r(90331),Oe=function(l){function n(t,i){var s,o=this;(o=l.call(this,t,i)||this).overlayRef=i,o.config.providers.set(n,o),o.horizontalSide=t.horizontalSide,o.verticalLayout=t.verticalLayout,o.horizontalLayout=t.horizontalLayout,o.flyoutWidthSubject$=new v.X(null!==(s=o.config.options.width)&&void 0!==s?s:Ee.Lc.childOverlayWidth),o.flyoutWidth$=o.flyoutWidthSubject$.asObservable(),o.flyoutWidth$.pipe((0,q.R)(o.onClose)).subscribe(function(g){requestAnimationFrame(function(){o.overlayRef.updateSize({width:g})})});var d,p,c=o.config.options.positionStrategy;return(d=c instanceof Rt.M?c.positionStrategy:c)instanceof Dt._G?p=d.positionChanges.pipe((0,ce.U)(function(g){return g.connectionPair.originX})):d instanceof Vt.A&&(p=d.onPositionChange$().pipe((0,ce.U)(function(g){return g.originX}))),p&&p.pipe((0,q.R)(o.onClose)).subscribe(function(g){g&&("start"===g&&(o.horizontalSide="left"),"end"===g&&(o.horizontalSide="right"))}),o}return(0,u.ZT)(n,l),n.prototype.updateWidth=function(t){this.flyoutWidthSubject$.next(t)},n}(De.w),rt=function(){function l(){this.pauseScrollCalls=0}return l.prototype.setScrollContainerElementRef=function(n){this.scrollContainerElementRef!==n&&(this.pauseScrollCalls=0),this.scrollContainerElementRef=n},l.prototype.onContentScroll=function(){var n=this.scrollContainerElementRef.nativeElement;this.pauseScrollCalls>0&&n.scrollTop!==this.restoreScrollTop&&(n.scrollTop=this.restoreScrollTop)},l.prototype.onContentUpdate=function(n){var t;if(!n.forVisualContainerChange)if("start"===n.type){if(this.pauseScrollCalls++,1===this.pauseScrollCalls){var i=null===(t=this.scrollContainerElementRef)||void 0===t?void 0:t.nativeElement;if(b.fF.assertValue(i,"skittle content update starts when it is not for a new visual container, scrollContainerElement should exist"),!i)return;this.restoreScrollTop=i.scrollTop}}else this.pauseScrollCalls--},l}(),zt=r(49162),At={autoVisualWithPerspectives:!1,showClearChanges:!1,dimensions:{}},Me=function(l){function n(){return l.call(this,At)||this}return(0,u.ZT)(n,l),n.prototype.getAutoVisualWithPerspectives=function(){return this.settings.autoVisualWithPerspectives},n.prototype.setAutoVisualWithPerspectives=function(t){this.setValue("autoVisualWithPerspectives",t)},n.prototype.getShowClearChanges=function(){return this.settings.showClearChanges},n.prototype.setShowClearChanges=function(t){this.setValue("showClearChanges",t)},n.prototype.getDimensions=function(t){return void 0===t&&(t=0),this.settings.dimensions[t]},n.prototype.setDimensions=function(t,i){var o,s=this.getDimensions(t),c=i;s&&(c=(0,u.pi)((0,u.pi)({},s),i)),this.setValue("dimensions",(0,u.pi)((0,u.pi)({},this.settings.dimensions),((o={})[t]=c,o)))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(i){return new(i||n)}}),n}(zt.g),lt=r(80649),Te=r(77526),Ve=r(17653),Ue=r(48787),Wt=r(87644),at=r(43505),jt=r(7779),$t=r(59725),st=r(15580),Nt=r(3579),Ut=r(39503),Ht=r(93215),Kt=r(18460),Re=r(59968),Qt=r(65005);function Gt(l,n){if(1&l&&e.\u0275\u0275element(0,"pbi-lazy-load",6),2&l){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.exploreUIAuthoringModulePath)("componentId","AutoVisualComponentId")("inputArgs",t.autoVisualInputArgs)}}var ct=function(n,t){return{"pbi-glyph-chevrondownmedium":n,"pbi-glyph-chevronupmedium":t}};function Xt(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.fieldListSectionExpanded=!s.fieldListSectionExpanded)}),e.\u0275\u0275element(1,"span",8)(2,"i",9),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,ct,!i.fieldListSectionExpanded,i.fieldListSectionExpanded))}}function Jt(l,n){if(1&l&&(e.\u0275\u0275elementStart(0,"div",10),e.\u0275\u0275element(1,"pbi-field-list",11),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&l){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(2,5,t.fieldListTree$))("checkMode",t.fieldListCheckMode)("hasHighlights",!1)("loading",!e.\u0275\u0275pipeBind1(3,7,t.fieldListTree$))("options",t.fieldListOptions)}}function Zt(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.toggleFieldWellSectionExpansion())}),e.\u0275\u0275element(1,"span",12)(2,"i",9),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,ct,!i.fieldWellSectionExpanded,i.fieldWellSectionExpanded))}}var Yt=function(n){return{"with-field-list":n}};function qt(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"build-field-well",13),e.\u0275\u0275listener("contentUpdate",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onContentUpdate(s))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(7,Yt,i.withFieldList))("visualContainer",i.visualContainer)("perspectiveDisplayName",i.perspectiveDisplayName)("allowReorderFields",i.overrideSingleBucketForAutoVisual||e.\u0275\u0275pipeBind1(1,5,i.allowReorderFields$))("overrideSingleBucketForAutoVisual",i.overrideSingleBucketForAutoVisual)}}var ei=function(){return{ignoreOverlay:!1,ignoreMobile:!1}},ze=function(l){function n(t,i,o,s,c,d,p,g,E,z,Y){var I=l.call(this)||this;I.changeDetectorRef=t,I.conceptualSchemaProxy=i,I.contextActivityService=o,I.dataSources=s,I.eventBridge=c,I.explorationNavigation=d,I.fieldListTreeService=p,I.lazyScoped=g,I.localizationService=E,I.modelService=z,I.skittleSettingsService=Y,I.contentUpdate=new e.EventEmitter,I.fieldListCheckMode=$t.kH.Multi,I.isAutoVisualInternal$=new v.X(void 0),I.isSessionDirtyInternal$=new v.X(!1);var pe=I.localizationService.get("Suggestions"),te=I.localizationService.get("Skittles_Build_SuggestLabel"),ue=I.localizationService.get("Skittles_Build_SuggestTooltip");return I.isSessionDirty$=I.isSessionDirtyInternal$.pipe((0,Te.x)(),(0,q.R)(I.onDestroy$)),I.allowReorderFields$=I.isAutoVisualInternal$.pipe((0,ce.U)(function(L){return!L}),(0,Te.x)(),(0,q.R)(I.onDestroy$)),I.changes$("visualContainer").pipe((0,q.R)(I.onDestroy$)).subscribe(function(L){L&&(I.originalVisualConfig={singleVisual:(0,st.d9)(L.config.singleVisual)},I.isAutoVisualInternal$.next((0,R.II)(L)))}),(0,w.aj)([I.changes$("visualContainer"),I.changes$("host"),I.changes$("setFocusAfterInitialization",!0)]).pipe((0,q.R)(I.onDestroy$)).subscribe(function(L){var J=L[1],O=L[2],B="Pane"===J;I.autoVisualInputArgs={label:pe,autoModeToggleLabel:te,tooltip:ue,visualContainer:L[0],withPerspectives:I.skittleSettingsService.getAutoVisualWithPerspectives(),setFocusAfterInitialization:O,host:J,allowSelectVisualTypeWhenNoVisual:!0,noAutoToggleSwitch:B,noSuggestions:B,alwaysExpanded:B}}),I.lazyScoped.get(Wt.ub).then(function(L){L.startFormattingTutorial("FieldPickerTutorial")}),I}return(0,u.ZT)(n,l),n.prototype.onContentUpdate=function(t){this.contentUpdate.emit(t)},n.prototype.ngOnInit=function(){var t=this;this.withFieldList=null!=this.fieldListOptions&&null!=this.fieldListTreeOptions,this.fieldListSectionExpanded=this.withFieldList,this.fieldWellSectionExpanded=this.expandFieldWellOnInit||!this.withFieldList,null!=this.refreshFieldList$&&this.refreshFieldList$.pipe((0,Te.x)()).pipe((0,q.R)(this.onDestroy$)).subscribe(function(){return t.fieldListTreeService.refresh()}),this.withFieldList&&this.modelService.update([]).then(function(){t.modelService.modelChange$.pipe((0,q.R)(t.onDestroy$)).subscribe(function(i){if(null!=i?.model){var o=1===_.size(i.model.tables);t.fieldListTreeService.modelToPbiTreeConverterOptions=t.fieldListTreeOptions,t.fieldListTreeService.modelToPbiTreeConverterOptions.expandedSetting=new ti(o),t.fieldListTreeService.setOrUpdateFieldListTreeModel(i.model),t.fieldListTree$=t.fieldListTreeService.fieldListTree$}})}),this.skittleSettingsService.getAutoVisualWithPerspectives()&&(this.perspectiveDisplayName=this.getPerspectiveDisplayName()),(0,G.T)(this.eventBridge.on(W.tRg),this.eventBridge.on(W.KD7),this.eventBridge.on(W.jCS),this.eventBridge.on(W.D1A),this.eventBridge.on(W.Udu)).pipe((0,Ve.b)(function(){return t.checkDirtyState()}),(0,q.R)(this.onDestroy$)).subscribe(function(){t.isAutoVisualInternal$.next((0,R.II)(t.visualContainer)),null!=t.fieldListOptions&&t.updateFieldListSelectionState()}),this.expandFieldWellSectionOnInitialChange&&this.eventBridge.on(W.jCS).pipe((0,Ue.q)(1)).subscribe(function(){var i;!0!==t.fieldWellSectionExpanded&&(t.fieldWellSectionExpanded=!0,t.changeDetectorRef.detectChanges(),document.activeElement.scrollIntoView(!0),t.autoExpandFieldWellSectionActivity=t.contextActivityService.createActivity({name:"Automatically expand field well section",visualName:null===(i=t.visualContainer)||void 0===i?void 0:i.name,data:{closed:null,source:"Skittle",skittleType:"Build"}}))})},n.prototype.ngOnDestroy=function(){var t;!(null===(t=this.autoExpandFieldWellSectionActivity)||void 0===t)&&t.isRunning()&&this.resolveAutoExpandFieldWellSectionActivity("automatically"),l.prototype.ngOnDestroy.call(this)},Object.defineProperty(n.prototype,"exploreUIAuthoringModulePath",{get:function(){return"@powerbi/ExploreUIAuthoring/lazy-modules/explore-ui-authoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},enumerable:!1,configurable:!0}),n.prototype.toggleFieldWellSectionExpansion=function(){var t;!(null===(t=this.autoExpandFieldWellSectionActivity)||void 0===t)&&t.isRunning()&&this.resolveAutoExpandFieldWellSectionActivity("manually"),this.fieldWellSectionExpanded=!this.fieldWellSectionExpanded},n.prototype.discardChanges=function(){var t=this;this.visualContainer.config.singleVisual=(0,st.d9)(this.originalVisualConfig.singleVisual),this.eventBridge.publishToChannel(W.jCS,{affectContainer:function(o){return o.name===t.visualContainer.name}})},n.prototype.resolveAutoExpandFieldWellSectionActivity=function(t){this.autoExpandFieldWellSectionActivity.updateProperty("data",function(i){return(0,u.pi)((0,u.pi)({},i),{closed:t})}),this.autoExpandFieldWellSectionActivity.resolve()},n.prototype.getPerspectiveDisplayName=function(){var t,i,o,s=this.explorationNavigation.getCurrentExploration(),c=s.sections[s.activeSectionIndex];return null===(o=null===(i=null===(t=c?.evaluatedObjects)||void 0===t?void 0:t.personalizeVisual)||void 0===i?void 0:i.perspectiveRef)||void 0===o?void 0:o.toString()},n.prototype.updateFieldListSelectionState=function(){return(0,u.mG)(this,void 0,void 0,function(){var t,i,o,s;return(0,u.Jh)(this,function(c){switch(c.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return t=c.sent(),i=(0,R.oJ)(this.visualContainer),o=this.modelService.model,s=_.flatMapDeep(i,function(d){return o.findItems(d.expr,t)}),this.fieldListTreeService.setOrUpdateFieldListTreeModel(o,void 0,s),[2]}})})},n.prototype.checkDirtyState=function(){var t,i,o,s,c=null===(i=null===(t=this.originalVisualConfig)||void 0===t?void 0:t.singleVisual)||void 0===i?void 0:i.query,d=null===(s=null===(o=this.originalVisualConfig)||void 0===o?void 0:o.singleVisual)||void 0===s?void 0:s.visualType,p=(0,R.Xf)(this.visualContainer),g=(0,Nt.s)(this.visualContainer),E=null==c,z=null==p;if(E&&z)this.isSessionDirtyInternal$.next(!1);else{var Y=d!==g||E!==z||!c.equals(p);this.isSessionDirtyInternal$.next(Y)}},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(qe.i),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject($e.D),e.\u0275\u0275directiveInject(Ne.J),e.\u0275\u0275directiveInject(Ut.z),e.\u0275\u0275directiveInject(at.p),e.\u0275\u0275directiveInject(we.H),e.\u0275\u0275directiveInject(Le.o),e.\u0275\u0275directiveInject(Ht.b),e.\u0275\u0275directiveInject(Me))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-skittle"]],inputs:{fieldListOptions:"fieldListOptions",fieldListTreeOptions:"fieldListTreeOptions",hideVisualPicker:"hideVisualPicker",expandFieldWellSectionOnInitialChange:"expandFieldWellSectionOnInitialChange",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual",setFocusAfterInitialization:"setFocusAfterInitialization",host:"host",refreshFieldList$:"refreshFieldList$",expandFieldWellOnInit:"expandFieldWellOnInit",visualContainer:"visualContainer"},outputs:{contentUpdate:"contentUpdate"},features:[e.\u0275\u0275ProvidersFeature((0,u.ev)([at.p],jt.r,!0)),e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[1,"buildSkittle",3,"pbiScrollbar"],[1,"visualPicker","compact-visual-types"],[3,"modulePath","componentId","inputArgs",4,"ngIf"],["class","sectionHeader",3,"click",4,"ngIf"],["class","fieldListContainer",4,"ngIf"],[3,"ngClass","visualContainer","perspectiveDisplayName","allowReorderFields","overrideSingleBucketForAutoVisual","contentUpdate",4,"ngIf"],[3,"modulePath","componentId","inputArgs"],[1,"sectionHeader",3,"click"],["localize","Skittles_Build_FieldListSectionTitle"],[1,"glyphicon","glyph-small",3,"ngClass"],[1,"fieldListContainer"],[3,"fieldListTree","checkMode","hasHighlights","loading","options"],["localize","Skittles_Build_FieldWellSectionTitle"],[3,"ngClass","visualContainer","perspectiveDisplayName","allowReorderFields","overrideSingleBucketForAutoVisual","contentUpdate"]],template:function(i,o){1&i&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Gt,1,3,"pbi-lazy-load",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Xt,3,4,"div",3),e.\u0275\u0275template(4,Jt,4,9,"div",4),e.\u0275\u0275template(5,Zt,3,4,"div",3),e.\u0275\u0275template(6,qt,2,9,"build-field-well",5),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275property("pbiScrollbar",e.\u0275\u0275pureFunction0(6,ei)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!o.hideVisualPicker),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList&&o.fieldListSectionExpanded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.fieldWellSectionExpanded))},dependencies:[f.NgClass,f.NgIf,Kt.R,Re.X,Qt.l,lt.r,nt,f.AsyncPipe],styles:['.buildSkittle[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   .fieldListContainer[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   build-field-well[_ngcontent-%COMP%]{padding:0 8px}.buildSkittle[_ngcontent-%COMP%]   .fieldListContainer[_ngcontent-%COMP%]{flex:1;position:relative}.buildSkittle[_ngcontent-%COMP%]   build-field-well[_ngcontent-%COMP%]{flex:1}.buildSkittle[_ngcontent-%COMP%]   build-field-well.with-field-list[_ngcontent-%COMP%]{overflow:auto}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px;border-top:1px solid var(--globalColorGrey90)}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}']}),n}(_e.w),ti=function(){function l(n){this.hasSingleTable=n}return l.prototype.isExpanded=function(n){return"Hierarchy"===n.modelObjectType||"Table"===n.modelObjectType&&this.hasSingleTable},l.prototype.isExpandedStateFixed=function(n){return"Hierarchy"===n.modelObjectType},l}(),ii=["buildSkittle"],ni=["scrollContainer"],oi=function(){return{ignoreOverlay:!1,ignoreMobile:!1}},ut=function(){function l(n,t,i){this.skittleSettingsService=n,this.localizationService=t,this.flyoutRef=i,this.host="Skittle",this.contentScrollContainerHelper=new rt,this.destroy$=new F.xQ,this.allowClearChanges=this.skittleSettingsService.getShowClearChanges(),this.visualContainer=i.visualContainer}return Object.defineProperty(l.prototype,"_scrollContainer",{set:function(t){this.contentScrollContainerHelper.setScrollContainerElementRef(t)},enumerable:!1,configurable:!0}),l.prototype.ngAfterViewInit=function(){var n=this;this.buildSkittleComponent.isSessionDirty$.pipe((0,q.R)(this.destroy$),(0,ce.U)(function(t){var i=[];return n.allowClearChanges&&i.push({icon:"eraser",iconSize:"small",tooltip:n.getDiscardChangesTooltipText(t),disabled:!t,click:function(){return n.discardChanges()}}),i})).subscribe(function(t){return n.flyoutRef.setHeaderButtons(t)})},l.prototype.onContentUpdate=function(n){this.contentScrollContainerHelper.onContentUpdate(n)},l.prototype.onContentScroll=function(){this.contentScrollContainerHelper.onContentScroll()},l.prototype.discardChanges=function(){this.buildSkittleComponent.discardChanges()},l.prototype.getDiscardChangesTooltipText=function(n){return this.localizationService.get(n?"PersonalizeVisual_DiscardChanges":"PersonalizeVisual_DiscardChanges_Disabled")},l.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(Me),e.\u0275\u0275directiveInject(Le.o),e.\u0275\u0275directiveInject(Oe))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["build-skittle-flyout"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(ii,5),e.\u0275\u0275viewQuery(ni,5)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.buildSkittleComponent=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._scrollContainer=o.first)}},features:[e.\u0275\u0275ProvidersFeature([{provide:xe.yk,useValue:{source:"Skittle",skittleType:"Build"}}])],decls:4,vars:4,consts:[[1,"scrollContainer",3,"pbiScrollbar","scroll"],["scrollContainer",""],[3,"host","visualContainer","contentUpdate"],["buildSkittle",""]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275listener("scroll",function(){return i.onContentScroll()}),e.\u0275\u0275elementStart(2,"build-skittle",2,3),e.\u0275\u0275listener("contentUpdate",function(s){return i.onContentUpdate(s)}),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275property("pbiScrollbar",e.\u0275\u0275pureFunction0(3,oi)),e.\u0275\u0275advance(2),e.\u0275\u0275property("host",i.host)("visualContainer",i.visualContainer))},dependencies:[lt.r,ze],encapsulation:2}),l}(),dt=r(9215),Ae=r(21024),He=r(72262),ri=r(66977),Ke=r(21023),Qe=r(24548),pt=r(69437),ft=function(){function l(){}return l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["build-skittle-watermark"]],inputs:{watermarkText:"watermarkText"},decls:4,vars:1,consts:[[1,"watermark"],["name","PBIBuild_20",1,"watermarkIcon"],[1,"watermarkText"],[3,"localize"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"pbi-office-icon",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275element(3,"span",3),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",i.watermarkText))},dependencies:[Re.X,pt.m],styles:[".watermark[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.watermarkIcon[_ngcontent-%COMP%]{width:32px;height:32px;padding-bottom:16px}.watermarkText[_ngcontent-%COMP%]{--watermark-text-color: var(--globalColorGrey14);padding-inline-start:24px;padding-inline-end:24px;text-align:center;color:var(--watermark-text-color)}  [data-legacy-theming=false] .watermarkText{--watermark-text-color: var(--colorNeutralForeground1)}"],changeDetection:0}),l}(),li=["allContentScrollContainer"];function ai(l,n){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",5),e.\u0275\u0275element(2,"build-skittle-watermark",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&l){var t=n.ngIf;e.\u0275\u0275advance(2),e.\u0275\u0275property("watermarkText",t)}}function si(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7,8),e.\u0275\u0275listener("scroll",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onContentScroll())}),e.\u0275\u0275elementStart(2,"build-skittle",9),e.\u0275\u0275listener("contentUpdate",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.onContentUpdate(s))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("fieldListOptions",i.fieldListOptions)("fieldListTreeOptions",i.fieldListTreeOptions)("visualContainer",e.\u0275\u0275pipeBind1(3,10,i.visualContainer$))("hideVisualPicker",i.hideVisualPicker)("expandFieldWellSectionOnInitialChange",i.expandFieldWellSectionOnInitialChange)("overrideSingleBucketForAutoVisual",i.overrideSingleBucketForAutoVisual)("setFocusAfterInitialization",i.setFocusAfterInitialization)("refreshFieldList$",i.refreshFieldList$)("expandFieldWellOnInit",i.expandFieldWellOnInit)("host",i.host)}}function ci(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section",2),e.\u0275\u0275template(2,ai,3,1,"ng-container",3),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,si,4,12,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()}if(2&l){var c,i=n.ngIf,o=e.\u0275\u0275reference(5),s=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("disableScroll",!0)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",null===(c=s.showCollapse)||void 0===c||c),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,8,s.watermarkText$))("ngIfElse",o)}}var ht=function(l){function n(t,i,o){var s=l.call(this)||this;s.panesVisibilityService=t,s.selectionService=i,s.visualPluginOps=o,s.paneViewModel$=s.panesVisibilityService.getPanes$().pipe((0,ce.U)(function(d){return d.build})),s.host="Pane",s.contentScrollContainerHelper=new rt;var c=s.selectionService.selectedElements$.pipe((0,ce.U)(function(d){if(d)return d.reduce(function(p,g){var E=g.canvasItem;return E&&p.push(E),p},[])}));return s.visualContainer$=c.pipe((0,ce.U)(function(d){if(!_.isEmpty(d)){var p=(0,dt.rQ)(d)[0];return 1===p.length?p[0]:void 0}})),s.watermarkText$=c.pipe((0,ce.U)(function(d){var p;if(!_.isEmpty(d)){var g=(p=(0,dt.rQ)(d))[0];if(!_.isEmpty(p[1])||g.length>1)return"Build_Pane_Multiple_Visual";var z=g[0],Y=s.visualPluginOps.canConvertVisual(z),I=s.visualPluginOps.isQueryVisual(z.config.singleVisual.visualType);if(!Y&&!I)return"Build_Pane_NoData_Visual"}})),s}return(0,u.ZT)(n,l),Object.defineProperty(n.prototype,"_allContentScrollContainer",{set:function(i){this.contentScrollContainerHelper.setScrollContainerElementRef(i)},enumerable:!1,configurable:!0}),n.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("build",!1)},n.prototype.onContentUpdate=function(t){this.contentScrollContainerHelper.onContentUpdate(t)},n.prototype.onContentScroll=function(){this.contentScrollContainerHelper.onContentScroll()},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(Ae.r),e.\u0275\u0275directiveInject(He.z),e.\u0275\u0275directiveInject(ri.f))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-skittle-pane"]],viewQuery:function(i,o){var s;(1&i&&e.\u0275\u0275viewQuery(li,5),2&i)&&(e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(o._allContentScrollContainer=s.first))},inputs:{fieldListOptions:"fieldListOptions",fieldListTreeOptions:"fieldListTreeOptions",hideVisualPicker:"hideVisualPicker",expandFieldWellSectionOnInitialChange:"expandFieldWellSectionOnInitialChange",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual",setFocusAfterInitialization:"setFocusAfterInitialization",refreshFieldList$:"refreshFieldList$",expandFieldWellOnInit:"expandFieldWellOnInit",showCollapse:"showCollapse"},features:[e.\u0275\u0275ProvidersFeature([{provide:xe.yk,useValue:{source:"Pane",paneType:"build"}}]),e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","buildSkittlePane",3,"expanded","title","disableScroll","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[1,"buildSkittlePane",3,"expanded","title","disableScroll","allowToggle","optionsSetting","showCollapse","onCollapse"],[1,"no-padding"],[4,"ngIf","ngIfElse"],["skittles",""],[1,"watermarkContainer"],[3,"watermarkText"],[1,"paneContentScrollContainer",3,"scroll"],["allContentScrollContainer",""],[3,"fieldListOptions","fieldListTreeOptions","visualContainer","hideVisualPicker","expandFieldWellSectionOnInitialChange","overrideSingleBucketForAutoVisual","setFocusAfterInitialization","refreshFieldList$","expandFieldWellOnInit","host","contentUpdate"]],template:function(i,o){1&i&&(e.\u0275\u0275template(0,ci,6,10,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&i&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,o.paneViewModel$))},dependencies:[f.NgIf,Ke.VO,Qe.i,ze,ft,f.AsyncPipe],styles:[".buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]{height:100%}.buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]   .paneContentScrollContainer[_ngcontent-%COMP%]{height:100%;overflow:auto}.buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]   .watermarkContainer[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}"]}),n}(_e.w),ui=r(90094),di=r(56011),Ge=r(85102),pi=["checkboxElement"];function fi(l,n){1&l&&e.\u0275\u0275element(0,"warning-eager",11),2&l&&e.\u0275\u0275property("warningMessage",n.ngIf)}function hi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7)(1,"pbi-checkbox",8,9),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext().$implicit,d=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(d.updateFormatOption(c))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,fi,1,1,"warning-eager",10),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()}if(2&l){var o,i=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("checked",i.checked)("label",i.displayName)("isCompact",!0)("ariaDescription",i.warningMessage$?null==(o=e.\u0275\u0275pipeBind1(3,6,i.warningMessage$))?null:o.detail:void 0),e.\u0275\u0275attribute("id",i.uid),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(5,8,i.warningMessage$))}}function vi(l,n){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,hi,6,10,"div",6),e.\u0275\u0275elementContainerEnd()),2&l){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.disabled)}}function gi(l,n){if(1&l&&(e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275template(1,vi,2,1,"ng-container",5),e.\u0275\u0275elementEnd()),2&l){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.items)}}function mi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,gi,2,1,"div",2),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.openFormatPane())}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,3,i.formatState$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","Options_Menu")("pbiTooltip",e.\u0275\u0275pipeBind1(4,5,"Options_Menu"))}}var Xe=function(l){function n(t,i,o,s){var c=l.call(this)||this;return c.changeDetector=t,c.lazyScoped=i,c.panesVisibility=o,c.selectionService=s,c.isInitialized$=new v.X(!1),c}return(0,u.ZT)(n,l),Object.defineProperty(n.prototype,"_checkboxElementRefs",{set:function(i){var o,s;if(this.checkboxElements=[],i){var c=i.toArray();if(this.checkboxElements=c.map(function(E){return E.nativeElement}),!_.isEmpty(this.restoreFocusElementId))for(var d=0,p=c;d<p.length;d++){var g=p[d];if(g.nativeElement.id===this.restoreFocusElementId)return void(null===(s=null===(o=g.nativeElement.getElementsByTagName("INPUT"))||void 0===o?void 0:o[0])||void 0===s||s.focus())}}},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var t=this,i=_.compact(this.selectionService.getSelectedElements().map(function(s){return s.canvasItem})),o=_.first(i);this.lazyScoped.get("formattingService").then(function(s){t.formattingService=s;var c=t.formattingService.getFor({type:0,canvasItem:o});t.formatState$=c.getChartElementsContract$().pipe((0,Ve.b)(function(d){var p=document.activeElement;if("INPUT"===document.activeElement.tagName){var g=_.find(t.checkboxElements,function(E){return E.contains(p)});t.restoreFocusElementId=g?.id}})),t.changeDetector.detectChanges(),t.isInitialized$.next(!0)})},n.prototype.updateFormatOption=function(t){var i;t.checked=!t.checked;var o=null===(i=_.first(this.selectionService.getSelectedElements()))||void 0===i?void 0:i.canvasItem;this.formattingService.saveValues({changes:[{objectName:t.descriptor.objectName,uid:t.uid,hasDynamicExpressionSupport:!1,formattingSource:t.formattingSource,propertySlice:{name:t.descriptor.propertyName,selector:t.descriptor.selector,type:{bool:!0},value:t.checked},canvasItems:[o],visualUpdateSource:0}]},{source:"Skittle",skittleType:"ChartElements"}),this.changeDetector.detectChanges()},n.prototype.openFormatPane=function(){this.panesVisibility.isPaneVisible("format")&&!this.panesVisibility.isPaneExpanded("format")?this.panesVisibility.togglePaneExpansion("format"):this.panesVisibility.isPaneVisible("format")?this.panesVisibility.emphasizePane("format"):this.panesVisibility.togglePaneVisibility("format"),this.panesVisibility.setFocusedPane("format")},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(we.H),e.\u0275\u0275directiveInject(Ae.r),e.\u0275\u0275directiveInject(He.z))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["chart-elements-skittle"]],viewQuery:function(i,o){var s;(1&i&&e.\u0275\u0275viewQuery(pi,5,e.ElementRef),2&i)&&(e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(o._checkboxElementRefs=s))},features:[e.\u0275\u0275ProvidersFeature([{provide:xe.yk,useValue:{source:"Skittle",skittleType:"ChartElements"}}]),e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","chartElementsSkittle",4,"ngIf"],[1,"chartElementsSkittle"],["class","options",4,"ngIf"],[1,"pbi-fluent-button","moreOptionsButton",3,"localize","pbiTooltip","click"],[1,"options"],[4,"ngFor","ngForOf"],["class","item-container",4,"ngIf"],[1,"item-container"],[3,"checked","label","isCompact","ariaDescription","onChange"],["checkboxElement",""],["class","warning",3,"warningMessage",4,"ngIf"],[1,"warning",3,"warningMessage"]],template:function(i,o){1&i&&(e.\u0275\u0275template(0,mi,5,7,"div",0),e.\u0275\u0275pipe(1,"async")),2&i&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,o.isInitialized$))},dependencies:[f.NgForOf,f.NgIf,Re.X,ui.l,di.v,h.V,f.AsyncPipe,Ge.F],styles:['.chartElementsSkittle[_ngcontent-%COMP%]{padding:4px 8px 0}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-direction:column}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;margin-bottom:6px}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{width:fit-content;margin:2px 0}html:not([dir="rtl"])[_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-left:auto}html[dir="rtl"][_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-right:auto}.chartElementsSkittle[_ngcontent-%COMP%]   .moreOptionsButton[_ngcontent-%COMP%]{margin-top:6px;padding:6px 16px;border:1px solid var(--gray-110, #8A8886);max-width:100%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}'],changeDetection:0}),n}(_e.w),vt=function(){function l(){}return l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["chart-elements-skittle-flyout"]],decls:1,vars:0,template:function(t,i){1&t&&e.\u0275\u0275element(0,"chart-elements-skittle")},dependencies:[Xe],encapsulation:2,changeDetection:0}),l}();function yi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section"),e.\u0275\u0275element(2,"chart-elements-skittle"),e.\u0275\u0275elementEnd()()}if(2&l){var i=n.ngIf;e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",!0)}}var gt=function(){function l(n){this.panesVisibilityService=n,this.paneViewModel$=this.panesVisibilityService.getPanes$().pipe((0,ce.U)(function(t){return t.chartElementsSkittle}))}return l.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("chartElementsSkittle",!1)},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(Ae.r))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["chart-elements-skittle-pane"]],decls:2,vars:3,consts:[[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,yi,3,5,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[f.NgIf,Ke.VO,Qe.i,Xe,f.AsyncPipe],encapsulation:2,changeDetection:0}),l}();function Ci(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section",2),e.\u0275\u0275element(2,"build-skittle",3),e.\u0275\u0275elementEnd()()}if(2&l){var i=n.ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("host",o.host)}}var mt=function(){function l(n){this.panesVisibilityService=n,this.host="Skittle",this.paneViewModel$=this.panesVisibilityService.getPanes$().pipe((0,ce.U)(function(t){return t.suggestSkittle}))}return l.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("suggestSkittle",!1)},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(Ae.r))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["suggest-skittle-pane"]],features:[e.\u0275\u0275ProvidersFeature([{provide:xe.yk,useValue:{source:"Pane",paneType:"suggestSkittle"}}])],decls:2,vars:3,consts:[[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse"],[1,"no-padding"],[3,"host"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Ci,3,6,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[f.NgIf,Ke.VO,Qe.i,ze,f.AsyncPipe],encapsulation:2,changeDetection:0}),l}(),Ie=r(25512),yt=r(76072),Si=r(83309),bi=["flyout"],_i=["container"];function xi(l,n){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"h2",8),e.\u0275\u0275elementContainerEnd()),2&l){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",t)}}function Ei(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",10),e.\u0275\u0275listener("click",function(s){var c=e.\u0275\u0275restoreView(t);return e.\u0275\u0275resetView(c.$implicit.click(s))}),e.\u0275\u0275elementEnd()}if(2&l){var i=n.$implicit;e.\u0275\u0275classMapInterpolate2("glyphicon glyph-",i.iconSize," pbi-glyph-",i.icon,""),e.\u0275\u0275property("pbiTooltip",i.tooltip)}}function Pi(l,n){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ei,1,5,"button",9),e.\u0275\u0275elementContainerEnd()),2&l){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function Fi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onClose())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}2&l&&e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,1,"Close"))}var ki=function(){function l(n,t,i,o,s,c){this.injector=n,this.lazyProvider=t,this.localizationService=i,this.screenReaderService=o,this.flyoutRef=s,this.data=c,this.destroy$=new F.xQ}return l.prototype.ngOnInit=function(){var n=this;this.flyoutRef.title$.pipe((0,q.R)(this.destroy$)).subscribe(function(t){if(t){var i="".concat(n.localizationService.get(t)," ").concat(n.localizationService.get("Slicer_Menu"));n.screenReaderService.alert(i)}})},l.prototype.ngAfterViewInit=function(){return(0,u.mG)(this,void 0,void 0,function(){var n;return(0,u.Jh)(this,function(i){switch(i.label){case 0:return[4,this.lazyProvider.getModule("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule")];case 1:return n=i.sent(),this.container.createComponent(this.data.skittleContentComponent,{injector:this.injector,ngModuleRef:n}).changeDetectorRef.detectChanges(),[2]}})})},l.prototype.ngOnDestroy=function(){this.container.clear(),this.destroy$.next(),this.destroy$.complete()},l.prototype.onClose=function(){this.data.toggleSkittle(this.flyoutRef.type)},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(yt.E),e.\u0275\u0275directiveInject(Le.o),e.\u0275\u0275directiveInject(Si.g),e.\u0275\u0275directiveInject(Oe),e.\u0275\u0275directiveInject(De.M))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["skittle-flyout"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(bi,5),e.\u0275\u0275viewQuery(_i,5,e.ViewContainerRef)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.flyoutElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.container=o.first)}},decls:13,vars:10,consts:[["role","menu","aria-labelledby","skittleTitle",1,"skittleFlyout"],["flyout",""],[1,"header"],[4,"ngIf"],[1,"buttonContainer"],["class","glyphicon glyph-mini pbi-glyph-close","aria-label","Close",3,"pbiTooltip","click",4,"ngIf"],["role","menuitem",1,"allContent"],["container",""],["id","skittleTitle",1,"title",3,"localize"],["pbiTooltipCaretSize","small",3,"class","pbiTooltip","click",4,"ngFor","ngForOf"],["pbiTooltipCaretSize","small",3,"pbiTooltip","click"],["aria-label","Close",1,"glyphicon","glyph-mini","pbi-glyph-close",3,"pbiTooltip","click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2),e.\u0275\u0275template(3,xi,2,1,"ng-container",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275template(6,Pi,2,1,"ng-container",3),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,Fi,2,3,"button",5),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div",6),e.\u0275\u0275elementContainer(11,null,7),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275attribute("aria-expanded",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(4,4,i.flyoutRef.title$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,6,i.flyoutRef.headerButtons$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,8,i.flyoutRef.showCloseButton$)))},dependencies:[f.NgForOf,f.NgIf,Re.X,h.V,f.AsyncPipe,Ge.F],styles:['[_nghost-%COMP%]{--caret-background-color: var(--fluent-theme-neutral-lighter-color, #F3F2F1);--caret-border-color: var(--gray-70, #BEBBB8);--skittle-flyout-border-color: var(--gray-70, #BEBBB8);--skittle-flyout-background-color: var(--fluent-theme-neutral-lighter-color, #F3F2F1);background-color:var(--skittle-flyout-background-color);border:1px solid var(--skittle-flyout-border-color);border-radius:2px;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 2px 4px var(--colorNeutralShadowKey);box-sizing:border-box;padding:8px 0;width:100%}[data-legacy-theming=false]   [_nghost-%COMP%]{--caret-background-color: var(--colorNeutralBackground3);--caret-border-color: var(--colorNeutralStroke1Selected);--skittle-flyout-border-color: var(--colorNeutralStroke1Selected);--skittle-flyout-background-color: var(--colorNeutralBackground3)}.pbi-overlay-caret.themeableElement[_nghost-%COMP%]:before, .pbi-overlay-caret.themeableElement[_nghost-%COMP%]:after{background:var(--caret-background-color);border:1px solid var(--caret-border-color)}.skittleFlyout[_ngcontent-%COMP%]{--skittle-flyout-button-color: var(--gray-190, #201F1E);display:flex;flex-direction:column;position:relative;height:100%;width:100%;z-index:1;color:var(--colorNeutralForeground1)}  [data-legacy-theming=false] .skittleFlyout{--skittle-flyout-button-color: var(--colorNeutralForeground1)}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 8px 12px}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);margin:0;flex-grow:1}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]{display:flex;align-items:center}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0;border:0;background:transparent;margin-left:8px;color:var(--skittle-flyout-button-color)}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.5}.skittleFlyout[_ngcontent-%COMP%]   .allContent[_ngcontent-%COMP%]{flex:1;margin:0;overflow-x:hidden;overflow-y:overlay}@media print{[_nghost-%COMP%]{display:none!important}}'],changeDetection:0}),l}(),Ii=r(88819),Ct=r(86940),Oi=r(10675),Mi=["container"],Ti=function(){function l(n,t,i){this.injector=n,this.lazyProvider=t,this.flyoutRef=i,this.destroy$=new F.xQ}return l.prototype.ngOnDestroy=function(){this.container.clear(),this.destroy$.next(),this.destroy$.complete()},l.prototype.ngAfterViewInit=function(){return(0,u.mG)(this,void 0,void 0,function(){var n;return(0,u.Jh)(this,function(i){switch(i.label){case 0:return[4,this.lazyProvider.getModule("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule")];case 1:return n=i.sent(),this.container.createComponent(this.flyoutRef.config.component,{injector:this.injector,ngModuleRef:n}).changeDetectorRef.detectChanges(),[2]}})})},l.prototype.setNewHorizontalFlyoutSize=function(n){n.cancel||this.flyoutRef.updateWidth(n.newSize)},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(yt.E),e.\u0275\u0275directiveInject(Oe))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["flyout"]],viewQuery:function(t,i){var o;(1&t&&e.\u0275\u0275viewQuery(Mi,5,e.ViewContainerRef),2&t)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.container=o.first))},decls:3,vars:3,consts:[[3,"dock","enabled","disableElementSizing","onResize"],["container",""]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"resizer",0),e.\u0275\u0275listener("onResize",function(s){return i.setNewHorizontalFlyoutSize(s)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainer(1,null,1)),2&t&&e.\u0275\u0275property("dock",i.flyoutRef.horizontalSide)("enabled",!0)("disableElementSizing",!0)},dependencies:[Oi.d],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;min-height:100%;min-width:100%}.pbi-overlay-caret.themeableElement[_nghost-%COMP%]:before, .pbi-overlay-caret.themeableElement[_nghost-%COMP%]:after{background:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border:1px solid var(--gray-70, #BEBBB8)}[_nghost-%COMP%] >*{display:block}@media print{[_nghost-%COMP%]{display:none!important}}"],changeDetection:0}),l}(),Bi=function(){function l(n,t,i){void 0===i&&(i=0),this.skittleSettingsService=t,this.level=i,this.currentLayout=_.first(n),this.childLayouts=n.slice(1)}return l.prototype.createFlyoutConfig=function(n){var t,i,o,s=n.providers;this.childLayouts.length>0&&(s||(s=new WeakMap),s.set(Ii.l,new l(this.childLayouts,this.skittleSettingsService,this.level+1)));var c=null===(t=n.options)||void 0===t?void 0:t.width,d=this.skittleSettingsService.getDimensions(this.level);return d?.width&&(c=this.minMaxDimension(d.width,null===(i=n.options)||void 0===i?void 0:i.minWidth,null===(o=n.options)||void 0===o?void 0:o.maxWidth)),(0,u.pi)((0,u.pi)({},n),{options:(0,u.pi)((0,u.pi)({},n.options),{width:c}),providers:s,horizontalLayout:this.currentLayout.horizontalLayout,horizontalSide:this.currentLayout.horizontalSide,verticalLayout:this.currentLayout.verticalLayout})},l.prototype.monitorFlyoutDimensions=function(n){var t=this;n.flyoutWidth$.pipe((0,q.R)(n.onClose)).subscribe(function(i){var o=t.skittleSettingsService.getDimensions(t.level);i!==o?.width&&t.skittleSettingsService.setDimensions(t.level,{width:i})})},l.prototype.create=function(n,t){var i=this.createFlyoutConfig(n),o=new Oe(i,t);return this.monitorFlyoutDimensions(o),o},l.prototype.createComponentPortal=function(n){return Ct._.createComponentPortal((0,u.pi)((0,u.pi)({},n),{component:Ti}))},l.prototype.minMaxDimension=function(n,t,i){return(null==t||"string"==typeof t)&&(t=0),(null==i||"string"==typeof i)&&(i=Number.MAX_SAFE_INTEGER),Math.max(t,Math.min(n,i))},l}(),wi=function(l){function n(t,i){var o=l.call(this,t,i)||this;o.overlayRef=i,o.titleSubject$=new v.X(null),o.title$=o.titleSubject$.asObservable(),o.showCloseButtonSubject$=new v.X(!1),o.showCloseButton$=o.showCloseButtonSubject$.asObservable(),o.headerButtonsSubject$=new v.X([]),o.headerButtons$=o.headerButtonsSubject$.asObservable(),o.config.providers.set(n,o);var s=o.config.data;return o.type=s.type,o.visualContainer=s.visualContainer,o.setTitle(s.title),o.setShowCloseButton(s.showCloseButton),o}return(0,u.ZT)(n,l),n.prototype.setTitle=function(t){this.titleSubject$.next(t)},n.prototype.setHeaderButtons=function(t){this.headerButtonsSubject$.next(t)},n.prototype.setShowCloseButton=function(t){this.showCloseButtonSubject$.next(t)},n}(Oe),Li=function(l){function n(t,i){return l.call(this,t,i)||this}return(0,u.ZT)(n,l),n.prototype.create=function(t,i){var o=this.createFlyoutConfig(t),s=new wi(o,i);return this.monitorFlyoutDimensions(s),s},n}(Bi),St=function(){function l(n,t){this.overlay=n,this.skittleSettingsService=t,this.destroy$=new F.xQ}return l.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},l.prototype.isFlyoutOpen=function(){return void 0!==this.skittleFlyoutRef},l.prototype.isFlyoutOfTypeOpen=function(n){var t;return(null===(t=this.skittleFlyoutRef)||void 0===t?void 0:t.type)===n},l.prototype.showFlyout=function(n,t){var i=this;b.fF.assertNonEmpty(t.flyoutLayouts,"Flyout layouts cannot be empty. Please provide at least 2 layouts.");var o=t.elementRef,s=t.flyoutLayouts,c=t.focusElementOnClose,d=t.disableAutoFocus,p=t.injector,g=t.minWidth,E=t.parent,Y=t.position;if(E){var pe=E.overlayRef.getConfig().positionStrategy,L=this.overlay.position(E.overlayContainer).getPositionStrategyAdapter(pe).getPosition();"start"===L.overlayX?Y=this.getPositions(!1):"end"===L.overlayX&&(Y=this.getPositions(!0))}var le=this.getPositionStrategy(o,Y,E?.overlayContainer),J=new Li(s,this.skittleSettingsService),O={component:ki,data:n,options:{positionStrategy:le,scrollStrategy:this.overlay.scrollStrategies.reposition(),hasBackdrop:!1,disposeOnNavigation:!0,minWidth:g},caretSize:1,hasCaret:!0,useCaretOffsets:!1,closeOnBackdropClick:!1,disableCloseOnEsc:!1,disableFocusTrapSetting:{disable:!1,disableAutoFocus:d??!1},focusElementOnClose:c,injector:p,parent:E,closeWithParent:!0},B=this.overlay.openWithFactory(O,J);B.onClose.subscribe(function(){i.skittleFlyoutRef=void 0}),this.skittleFlyoutRef=B},l.prototype.closeFlyout=function(){this.skittleFlyoutRef&&this.skittleFlyoutRef.close()},l.prototype.getPositionStrategy=function(n,t,i){return this.overlay.position(i).withinOverlayContainer(n).withPositions(t).withMaxiumumVisibility(!0)},l.prototype.getPositions=function(n){var t=n?0:1,i=n?1:0;return[(0,Ie.Zz)(Ee.Lc.marginHorizontal,void 0,t),(0,Ie.v3)(Ee.Lc.marginHorizontal,void 0,t),(0,Ie.J7)(Ee.Lc.marginHorizontal,void 0,t),(0,Ie.Iz)(-Ee.Lc.marginHorizontal,void 0,i),(0,Ie.q6)(-Ee.Lc.marginHorizontal,void 0,i),(0,Ie.Kb)(-Ee.Lc.marginHorizontal,void 0,i)]},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275inject(Ct._),e.\u0275\u0275inject(Me))},l.\u0275prov=e.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac}),l}(),bt=r(14002),Di=r(21728),Vi=r(76312),Ri=r(65302),Je=r(10167),zi=r(11547);function Wi(l){return null!=l.get(11)}var ji=["buildSkittle"],$i=["chartElementsSkittle"],Ni=["buildSkittleMask"],Ui=function(n){return{selected:n}};function Hi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275listener("keydown",function(c){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(d.onKeydown(c,"Build"))})("click",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.toggleBuildSkittle())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"pbi-office-icon",6)(5,"div",7,8),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",i.width+"px")("height",i.height+"px"),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(13,Ui,"Build"===o.skittlesService.lastOpenSkittleType))("pbiTooltip",e.\u0275\u0275pipeBind1(2,9,"VisualContainer_Skittle_Tooltip_Build"))("pbiTooltipPosition",o.tooltipPosition),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,11,"VisualContainer_Skittle_Tooltip_Build"))("aria-haspopup","menu")}}var Ki=function(n,t){return{selected:n,disabled:t}};function Qi(l,n){if(1&l){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",10,11),e.\u0275\u0275listener("keydown",function(d){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.onKeydown(d,"ChartElements"))})("click",function(){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext().ngIf,p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(!(null!=d.disabledState&&d.disabledState.disabled)&&p.toggleChartElementsSkittle())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"pbi-office-icon",12),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",o.width+"px")("height",o.height+"px"),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(15,Ki,"ChartElements"===s.skittlesService.lastOpenSkittleType,null==i.disabledState?null:i.disabledState.disabled))("pbiTooltip",e.\u0275\u0275pipeBind1(2,11,i.tooltip))("pbiTooltipDisabled",!1)("pbiTooltipPosition",s.tooltipPosition),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,13,i.tooltip))("aria-disabled",null==i.disabledState?null:i.disabledState.disabled)("aria-haspopup","menu")}}function Gi(l,n){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Qi,5,18,"button",9),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&l){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,t.chartElementsVisible$))}}var Xi=function(n,t){return{disabledState:n,tooltip:t}};function Ji(l,n){if(1&l&&(e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,Hi,7,15,"button",2),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Gi,3,3,"ng-container",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()),2&l){var t=n.ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("row-gap",t.betweenMargin+"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,4,i.buildVisible$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction2(10,Xi,e.\u0275\u0275pipeBind1(4,6,i.chartElementsDisabledState$),e.\u0275\u0275pipeBind1(5,8,i.chartElementsTooltip$)))}}var _t=function(){function l(n,t,i,o,s,c,d,p,g,E,z,Y,I,pe){var ue,L,te=this;this.skittleSettingsService=n,this.changeDetection=t,this.dataSources=i,this.eventBridge=o,this.hostOverlayRef=s,this.injector=c,this.lazyScopedProviderModern=d,this.runningVisualService=p,this.selectionService=g,this.skittleFlyoutService=E,this.visualAuthoring=z,this.skittlesData=Y,this.contextActivityService=I,this.visibilityService=pe,this.destroy$=new F.xQ,this.buildSkittleElementRef$=new v.X(void 0),this.chartElementsSkittleElementRef$=new v.X(void 0),this.buildSkittleMaskElementRef$=new v.X(void 0),this.visualContainer=this.skittlesData.visualContainer,b.fF.assertValue(this.visualContainer,"Expect this.skittlesData.visualContainer to be defined"),this.buildVisible$=this.skittlesData.supportedSkittleTypes$.pipe((0,ce.U)(function(B){return _.some(B,function(ae){return"Build"===ae.type})}),(0,Ve.b)(function(B){!B&&te.isFlyoutOfTypeOpen("Build")&&te.skittleFlyoutService.closeFlyout()}),(0,Te.x)());var le=this.skittlesData.supportedSkittleTypes$.pipe((0,ce.U)(function(B){return _.some(B,function(ae){return"ChartElements"===ae.type})})),J=null===(ue=this.runningVisualService.getVisual(this.visualContainer))||void 0===ue?void 0:ue.getErrorInfo(),O=new v.X(!!J);this.eventBridge.on(W.uB4).pipe((0,q.R)(this.destroy$)).subscribe(function(){var B;b.fF.assertValue(O,"Expect visualHasError$ to be defined");var ae=null===(B=te.runningVisualService.getVisual(te.visualContainer))||void 0===B?void 0:B.getErrorInfo();O.next(!!ae)}),this.chartElementsVisible$=(0,w.aj)([le,O]).pipe((0,ce.U)(function(B){return B[0]&&!B[1]}),(0,Ve.b)(function(B){!B&&te.isFlyoutOfTypeOpen("ChartElements")&&te.skittleFlyoutService.closeFlyout()}),(0,Te.x)()),this.chartElementsDisabledState$=this.skittlesData.supportedSkittleTypes$.pipe((0,ce.U)(function(B){var ae;return null===(ae=_.find(B,function(fe){return"ChartElements"===fe.type}))||void 0===ae?void 0:ae.disabled$}),(0,Q.w)(function(B){return B??(0,zi.of)(void 0)})),this.chartElementsTooltip$=null===(L=this.chartElementsDisabledState$)||void 0===L?void 0:L.pipe((0,ce.U)(function(B){if(null!=B)return B?.disabled?B.disabledReasonKey:"VisualContainer_Skittle_Tooltip_ChartElement"}),(0,q.R)(this.destroy$))}return Object.defineProperty(l.prototype,"_buildSkittleElement",{set:function(t){var i=this;this.buildSkittleElementRef$.next(t),t?.nativeElement&&this.skittlesData.showBuildFlyout$.pipe((0,U.h)(function(o){return null!==o}),(0,q.R)(this.destroy$)).subscribe(function(){setTimeout(function(){i.isFlyoutOfTypeOpen("Build")||i.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay)})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"_chartElementsSkittleElement",{set:function(t){this.chartElementsSkittleElementRef$.next(t)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"_buildSkittleMaskElement",{set:function(t){this.buildSkittleMaskElementRef$.next(t),t?.nativeElement&&this.setupBuildSkittleDragHandler(t.nativeElement)},enumerable:!1,configurable:!0}),l.prototype.ngOnInit=function(){var n=this;this.lazyScopedProviderModern.get("visualContainerSkittlesService").then(function(t){n.skittlesService=t,n.skittlesStyle$=n.skittlesService.skittlesPosition$.pipe((0,U.h)(function(o){return null!=o&&o.container===n.visualContainer}),(0,ce.U)(function(o){return{height:o.positions.skittleButtons.buttonHeight,width:o.positions.skittleButtons.buttonWidth,betweenMargin:o.positions.skittleButtons.betweenButtonMargin}})),n.skittlesService.skittlesPosition$.pipe((0,U.h)(function(o){return null!=o&&o.container===n.visualContainer}),(0,q.R)(n.destroy$)).subscribe(function(o){n.skittlePosition=o.positions,n.tooltipPosition=n.skittlePosition.skittleButtons.tooltipPosition}),n.changeDetection.detectChanges();var i=n.skittlesData.withActiveSkittle;null!=i&&n.skittlesData.supportedSkittleTypes$.pipe((0,Ue.q)(1)).subscribe(function(o){n.skittlePosition&&_.some(o,function(c){return c.type===i})&&(n.initialFlyoutOpenSkittleType$=new v.X(i),(0,w.aj)([n.initialFlyoutOpenSkittleType$,"Build"===i?n.buildSkittleElementRef$:n.chartElementsSkittleElementRef$]).pipe((0,U.h)(function(c){return null!=c[0]&&null!=c[1]}),(0,Ue.q)(1)).subscribe(function(c){n.toggleSkittle(c[0],n.skittlesData.skipActiveSkittleFlyoutAutoFocus)}))})}),this.eventBridge.on(W.tRg).pipe((0,q.R)(this.destroy$)).subscribe(function(){if(n.skittleFlyoutService.isFlyoutOpen()){var t=n.selectionService.getSelectedElements();1===_.size(t)&&!_.isEmpty(t[0].subSelections)&&(n.skittlesService.lastOpenSkittleType=void 0,n.skittleFlyoutService.closeFlyout())}})},l.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},l.prototype.toggleBuildSkittle=function(){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,this.toggleSkittle("Build")];case 1:return n.sent(),[2]}})})},l.prototype.toggleChartElementsSkittle=function(){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,this.toggleSkittle("ChartElements")];case 1:return n.sent(),[2]}})})},l.prototype.onKeydown=function(n,t){return(0,u.mG)(this,void 0,void 0,function(){var i;return(0,u.Jh)(this,function(o){switch(n.key){case"ArrowDown":"Build"===t&&(i=this.chartElementsSkittleElementRef$.value.nativeElement);break;case"ArrowUp":"ChartElements"===t&&(i=this.buildSkittleElementRef$.value.nativeElement)}return i&&Ri.IK.focus(i),[2]})})},l.prototype.toggleSkittle=function(n,t){return void 0===t&&(t=!1),(0,u.mG)(this,void 0,void 0,function(){var i,o,s;return(0,u.Jh)(this,function(c){switch(c.label){case 0:i=function(l,n,t,i){var o,s=null===(o=_.first(i.getSelectedElements()))||void 0===o?void 0:o.canvasItem.name;return n.createActivity({name:"OpenSkittle",visualName:s,data:{skittleType:l,source:Wi(t)?"InFocus":"Skittle"}})}(n,this.contextActivityService,this.visibilityService,this.selectionService),c.label=1;case 1:return c.trys.push([1,5,,6]),o=this.isFlyoutOfTypeOpen(n),this.skittleFlyoutService.closeFlyout(),o?[3,3]:[4,this.showFlyoutOfType(n,t)];case 2:return c.sent(),this.skittlesService.lastOpenSkittleType=n,[3,4];case 3:this.skittlesService.lastOpenSkittleType=void 0,c.label=4;case 4:return this.changeDetection.detectChanges(),i.resolve(),[3,6];case 5:throw s=c.sent(),i.reject(s),s;case 6:return[2]}})})},l.prototype.showFlyoutOfType=function(n,t){var i,o=this;void 0===t&&(t=!1),b.fF.assertValue(this.skittlePosition,"expecting skittles to be open to show the flyout");var s=(i=this.getSkittleFlyoutProperties(n)).title,c=i.component,d=i.flyoutPosition,p=i.elementRef;b.fF.assertValue(p,"expecting skittle of type ".concat(n," exists")),this.ensureSubselectionClosed(),"Build"===n&&(this.skittleSettingsService.setAutoVisualWithPerspectives(this.skittlesData.fromPersonalize),this.skittleSettingsService.setShowClearChanges(this.skittlesData.fromPersonalize)),this.skittleFlyoutService.showFlyout({skittleContentComponent:c,toggleSkittle:function(le){return o.toggleSkittle(le)},title:s,type:n,showCloseButton:!0,visualContainer:this.visualContainer},{flyoutLayouts:[{horizontalLayout:this.skittlePosition.horizontalLayout.firstLevelFlyout,verticalLayout:this.skittlePosition.verticalLayout.firstLevelFlyout,horizontalSide:"Left"===this.skittlePosition.horizontalLayout.firstLevelFlyout.alignment?"left":"right"},{horizontalLayout:this.skittlePosition.horizontalLayout.secondLevelFlyout,verticalLayout:this.skittlePosition.verticalLayout.secondLevelFlyout,horizontalSide:"Left"===this.skittlePosition.horizontalLayout.secondLevelFlyout.alignment?"left":"right"}],elementRef:p,focusElementOnClose:p.nativeElement,disableAutoFocus:t,injector:this.injector,parent:this.hostOverlayRef,position:d.position,height:d.height,maxHeight:d.maxHeight,width:d.width,minWidth:d.minWidth,maxWidth:d.maxWidth})},l.prototype.getSkittleFlyoutProperties=function(n){switch(n){case"Build":return{title:"Suggest_A_Visual",flyoutPosition:(0,bt.m)(this.skittlePosition.horizontalLayout.firstLevelFlyout,this.skittlePosition.verticalLayout.firstLevelFlyout,(t=this.buildSkittleElementRef$.value).nativeElement),elementRef:t,component:ut};case"ChartElements":var t;return{title:"Skittles_ChartElements_Title",flyoutPosition:(0,bt.m)(this.skittlePosition.horizontalLayout.firstLevelFlyout,this.skittlePosition.verticalLayout.firstLevelFlyout,(t=this.chartElementsSkittleElementRef$.value).nativeElement),elementRef:this.chartElementsSkittleElementRef$.value,component:vt};default:b.fF.assertNever(n)}},l.prototype.isFlyoutOfTypeOpen=function(n){return this.skittleFlyoutService.isFlyoutOfTypeOpen&&this.skittleFlyoutService.isFlyoutOfTypeOpen(n)},l.prototype.ensureSubselectionClosed=function(){Di.UP.selectSubSelection(this.selectionService,this.visualContainer,[],0)},l.prototype.setupBuildSkittleDragHandler=function(n){var i,t=this;n.addEventListener("dragenter",function(){i=setTimeout(function(){t.isFlyoutOfTypeOpen("Build")||t.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay)}),n.addEventListener("dragleave",function(){clearTimeout(i)}),(0,Vi.$o)(n,function(o,s){return(0,u.mG)(t,void 0,void 0,function(){var d=this;return(0,u.Jh)(this,function(p){switch(p.label){case 0:return[4,this.visualAuthoring.addFieldToVisual(s,this.dataSources.get(),this.visualContainer,"DraggedToVisual")];case 1:return p.sent()&&setTimeout(function(){d.isFlyoutOfTypeOpen("Build")||d.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay),[2]}})})})},l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(Me),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject($e.D),e.\u0275\u0275directiveInject(Ne.J),e.\u0275\u0275directiveInject(De.w),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(we.H),e.\u0275\u0275directiveInject(tt.s),e.\u0275\u0275directiveInject(He.z),e.\u0275\u0275directiveInject(St),e.\u0275\u0275directiveInject(et.$8),e.\u0275\u0275directiveInject(De.M),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject(it.w))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["visual-container-skittles"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(ji,5,e.ElementRef),e.\u0275\u0275viewQuery($i,5,e.ElementRef),e.\u0275\u0275viewQuery(Ni,5,e.ElementRef)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._buildSkittleElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._chartElementsSkittleElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._buildSkittleMaskElement=o.first)}},features:[e.\u0275\u0275ProvidersFeature([St])],decls:2,vars:3,consts:[["class","visualContainerSkittles",3,"row-gap",4,"ngIf"],[1,"visualContainerSkittles"],["class","skittle pbi-depth-1","data-automation-id","visual-container-skittle-build-button","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",3,"ngClass","width","height","pbiTooltip","pbiTooltipPosition","keydown","click",4,"ngIf"],[4,"ngIf"],["data-automation-id","visual-container-skittle-build-button","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",1,"skittle","pbi-depth-1",3,"ngClass","pbiTooltip","pbiTooltipPosition","keydown","click"],["buildSkittle",""],["name","suggestLightningBolt_20"],[1,"skittle-mask"],["buildSkittleMask",""],["class","skittle pbi-depth-1","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",3,"ngClass","width","height","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","keydown","click",4,"ngIf"],["pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",1,"skittle","pbi-depth-1",3,"ngClass","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","keydown","click"],["chartElementsSkittle",""],["name","PBIAddToChart_20"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Ji,6,13,"div",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.skittlesStyle$))},dependencies:[f.NgClass,f.NgIf,pt.m,h.V,f.AsyncPipe,Ge.F],styles:[".visualContainerSkittles[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;--skittle-background-color: var(--gray-40, #E1DFDD);--skittle-box-shadow: 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey);--skittle-border-color: var(--gray-50, #D2D0CE);--skittle-selected-background-color: var(--gray-80, #B3B0AD);--skittle-selected-border-color: var(--gray-130, #605E5C);--skittle-hover-background-color: var(--gray-70, #BEBBB8);--skittle-active-background-color: var(--gray-90, #A19F9D)}  [data-legacy-theming=false] .visualContainerSkittles{--skittle-background-color: var(--colorNeutralBackground3);--skittle-box-shadow: 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey);--skittle-border-color: var(--colorNeutralStroke3);--skittle-selected-background-color: var(--colorNeutralBackground3Selected);--skittle-selected-border-color: var(--colorNeutralStroke3);--skittle-hover-background-color: var(--colorNeutralBackground3Hover);--skittle-active-background-color: var(--colorNeutralBackground3Pressed)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]{background-color:var(--skittle-background-color);box-shadow:var(--skittle-box-shadow);outline:none;border:1px solid var(--skittle-border-color);border-radius:2px;box-sizing:border-box;padding:0;align-items:center;justify-content:center;display:flex;cursor:pointer;position:relative}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--skittle-hover-background-color);border-color:transparent}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--skittle-active-background-color);border-color:transparent}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.selected[_ngcontent-%COMP%]{background-color:var(--skittle-selected-background-color);border-color:var(--skittle-selected-border-color)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.disabled[_ngcontent-%COMP%]{cursor:default}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.disabled[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{opacity:.4}  html[data-focus-source=key] .visualContainerSkittles .skittle:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle:hover:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle:active:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle.selected:focus{border:2px solid var(--fluent-theme-black-color, #000)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{height:20px;width:20px}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]   .skittle-mask[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}@media print{[_nghost-%COMP%]{display:none!important}}"],changeDetection:0}),l}(),Zi=r(54485),Yi=[{type:_t,componentId:"VisualContainerSkittlesComponentId"},{type:ht,componentId:"BuildSkittlePaneComponentId"},{type:mt,componentId:"SuggestSkittlePaneComponentId"},{type:gt,componentId:"ChartElementsSkittlePaneComponentId"}],qi=function(){function l(n){r.e("on-object").then(r.bind(r,39875)).then(function(t){n.registerIcons(t.iconSpriteSheet.sprite)})}return l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275inject(Zi.u))},l.\u0275mod=e.\u0275\u0275defineNgModule({type:l}),l.\u0275inj=e.\u0275\u0275defineInjector({providers:[Me],imports:[f.CommonModule,a.J,y.N.withManifests(Yi),P.v,k.p,C.V,x.X,j.m,X.N,N.x,H.Z,ee.K,S.T6,D.Q]}),l}()},13941:function(re,A,r){function f(C){return"add"===C.type}function a(C){return"delete"===C.type}function D(C){return"reorder"===C.type}function k(C){return"replace"===C.type}function y(C){return"rename"===C.type}function P(C){return"initialize"===C.type}r.d(A,{H2:function(){return a},JB:function(){return f},V5:function(){return P},cA:function(){return k},cS:function(){return D},y$:function(){return y}})},14002:function(re,A,r){r.d(A,{C:function(){return C},m:function(){return x}});var f=r(64466),a=r(62458),D=r(25512),k=r(49977),y={LeftTop:D.Iz,RightTop:D.Zz,LeftCenter:D.q6,RightCenter:D.v3,LeftBottom:D.Kb,RightBottom:D.J7,RightInsideTop:function(M,m){return{originX:"end",originY:"top",overlayX:"end",overlayY:"top",offsetX:M,offsetY:m}},RightInsideBottom:function(M,m){return{originX:"end",originY:"bottom",overlayX:"end",overlayY:"bottom",offsetX:M,offsetY:m}}},P=2;function C(h,M){a.fF.assertValue(h,"visualContainer"),a.fF.assertValue(M,"visualOverlayPosition");var m=M.getOrigin(h);if(m){if(!(m instanceof Element))return void a.fF.assertFail("Visual container origin is not of type Element");var u=document.querySelector(f.s.DisplayAreaContainerNameSelector.selector);if(!(u&&u instanceof Element))return void a.fF.assertFail("Canvas area container is not of type Element");var v=j(u,m);if(a.fF.assert(function(){return 0!==v.originWidth&&0!==v.originHeight},"visual width or height is 0 now, check how to avoid calculating skittle position before visual is rendered"),function(h){if(h.relativeY>=h.pageHeight||h.relativeY+h.originHeight<=0||h.relativeX>=h.pageWidth)return!1;var m=h.relativeX+h.originWidth;return!(m<=0)&&!(h.relativeX<0&&h.pageWidth-m<0)}(v)){var F=function(h){var V,U,Q,m=h.pageWidth-(h.relativeX+h.originWidth),u=h.relativeX,v=k.Lc.width+k.Lc.marginHorizontal,F=k.Lc.childOverlayWidth+k.Lc.marginHorizontal,w=v+2*F,G=v+F;return m>=G?{skittleButtons:V="Right",firstLevelFlyout:{alignment:U="Right",maxWidth:S(h,V,U,Q=m>=w?"Right":"Left")},secondLevelFlyout:{alignment:Q}}:u>=G?{skittleButtons:V="Left",firstLevelFlyout:{alignment:U="Left",maxWidth:S(h,V,U,Q=u>=w?"Left":"Right")},secondLevelFlyout:{alignment:Q}}:m>=v?{skittleButtons:V="Right",firstLevelFlyout:{alignment:U="Left",maxWidth:S(h,V,U,Q="Left")},secondLevelFlyout:{alignment:Q}}:u>=v?{skittleButtons:V="Left",firstLevelFlyout:{alignment:U="Right",maxWidth:S(h,V,U,Q="Right")},secondLevelFlyout:{alignment:Q}}:m>=0?{skittleButtons:V="RightInside",firstLevelFlyout:{alignment:U="Left",maxWidth:S(h,V,U,Q="Left")},secondLevelFlyout:{alignment:Q}}:void 0}(v);if(F){var w=function(h){var F=h.relativeY/h.pageHeight*100;return{skittleButtons:(h.relativeY>=0?h.pageHeight-h.relativeY:h.pageHeight)>=(k.Lc.height+k.Lc.betweenSkittlesVerticalSpace)*P-k.Lc.betweenSkittlesVerticalSpace?"Top":"Bottom",firstLevelFlyout:F<=50?"Top":F<=75?"Center":"Bottom",secondLevelFlyout:"Center"}}(v);if(w){var G=function(h,M){var m;if("Top"===h){var u=0-M.relativeY;u>0&&(m=u)}else if("Bottom"===h){var v=M.relativeY+M.originHeight-M.pageHeight;v>0&&(m=-v)}return m}(w.skittleButtons,v);return{skittleButtons:{overlayPosition:[H(F.skittleButtons,w.skittleButtons,k.Lc.marginHorizontal,G)],buttonHeight:k.Lc.height,buttonWidth:k.Lc.width,betweenButtonMargin:k.Lc.betweenSkittlesVerticalSpace,tooltipPosition:"Left"===F.firstLevelFlyout.alignment?"after":"before"},verticalLayout:w,horizontalLayout:F}}}}}}function x(h,M,m,u){void 0===u&&(u=0);var v=h.alignment,F=h.maxWidth,w=M,G=document.querySelector(f.s.DisplayAreaContainerNameSelector.selector);if(G&&G instanceof Element){var Q,V=j(G,m),U=V.pageHeight-V.relativeY-1;switch(w){case"Top":Q=U-u;break;case"Center":Q=2*(U-V.originHeight/2),u=document.documentElement.clientHeight-V.originY-u-1-U+u;break;case"Bottom":Q=V.originY+V.originHeight-u}return{position:[H(v,w,k.Lc.marginHorizontal,u)],height:void 0,width:k.Lc.childOverlayWidth,maxHeight:Q,maxWidth:F,minWidth:k.Lc.childOverlayWidth}}}function j(h,M){var m=M.getBoundingClientRect(),u=h.getBoundingClientRect();return{pageHeight:u.height,pageWidth:u.width,pageX:u.x,pageY:u.y,originHeight:m.height,originWidth:m.width,originX:m.x,originY:m.y,relativeX:m.x-u.x,relativeY:m.y-u.y}}function H(h,M,m,u){if(null==m&&null==u)return y["".concat(h).concat(M)]();var v="Left"===h||"RightInside"===h?-m:m;return y["".concat(h).concat(M)](v,u)}function S(h,M,m,u){var v=h.pageWidth,F=h.originWidth,w=h.relativeX,G=k.Lc.width+2*k.Lc.marginHorizontal,V=k.Lc.childOverlayWidth+k.Lc.marginHorizontal;if("Right"===M){if("Right"!==m)return a.fF.assert(function(){return"Left"===m&&"Left"===u},"Skittle buttons right; Should match combination in getHorizontalLayout"),w+F-V;if("Right"===u)return v-(w+F)-G-V;if("Left"===u)return v-(w+F)-G}else if("Left"===M){if("Left"===m){if("Right"===u)return w-G;if("Left"===u)return w-G-V}else if("Right"===m)return a.fF.assert(function(){return"Right"===u},"SkittlePosition left; should match combinations in getHorizontalLayout"),v-w-V}else if("RightInside"===M)return a.fF.assert(function(){return"Left"===m&&"Left"===u},"Skittle buttons are RightInside, but should match combination in getHorizontalLayout"),w+F-G-V;return k.Lc.childOverlayWidth}},98476:function(re,A,r){r.d(A,{f:function(){return k}});var f=r(45413),a=r(74082);function D(y){return void 0!==y.pickerDataExpr}function k(y,P){for(var x,C=(0,a.ez)(y),j=P.length-1;j>=0;j--){var X=P[j],N=X.expr;if(C&&(0,a.y3)(N)){var H,ee=j;if((H=D(X)?_.findIndex(X.children,function(S){return(0,f.fS)(S.expr,y)}):_.findIndex(X.hierarchyLevels,function(S){return(0,f.fS)(S.expr,y)}))>=0)return[ee,H]}if((0,a.iV)(N)&&(N=N.arg),(0,f.fS)(N,y))return[j]}return x}},34145:function(re,A,r){r.d(A,{q:function(){return a}});var a=new(r(50423).InjectionToken)("ModelService")},9738:function(re,A,r){r.d(A,{$x:function(){return y},W6:function(){return D},fc:function(){return k}});var f=r(50423),a=r(30794),D=new f.InjectionToken("ModelingSelectionService"),k=new f.InjectionToken("ModelingCheckingService"),y=function(){function P(){this.notifcationsuspended=!1,this.selectedItems=new Set,this.selectionChanged=new a.xQ}return P.prototype.suspendNotification=function(){this.notifcationsuspended=!0},P.prototype.resumeNotification=function(){this.notifcationsuspended=!1,this.notifySelectionChanged()},P.prototype.select=function(C,x){this.selectAll([C],x)},P.prototype.deselect=function(C){this.selectedItems.delete(C),this.notifySelectionChanged()},P.prototype.selectAll=function(C,x){x&&this.selectedItems.clear();for(var j=0,X=C;j<X.length;j++)this.selectedItems.add(X[j]);this.notifySelectionChanged()},P.prototype.clear=function(){this.selectedItems.clear(),this.notifySelectionChanged()},P.prototype.isSelected=function(C){return this.selectedItems.has(C)},Object.defineProperty(P.prototype,"selection",{get:function(){return Array.from(this.selectedItems)},enumerable:!1,configurable:!0}),P.prototype.notifySelectionChanged=function(){this.notifcationsuspended||this.selectionChanged.next(this.selection)},P.\u0275prov=f.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac=function(x){return new(x||P)}}),P}()},7779:function(re,A,r){r.d(A,{r:function(){return P}});var f=r(23983),a=r(29834),D=r(93215),k=r(8538),y=r(34145),P=[f.eE,a.c,D.b,k.h,{provide:y.q,useExisting:D.b}]},93215:function(re,A,r){r.d(A,{b:function(){return X}});var f=r(81337),a=r(32518),D=r(8590),k=r(35510),y=r(50423),P=r(11494),C=r(83008),x=r(26898),j=r(65181),X=function(){function N(ee,H,S,e){var h=this;this.conceptualSchemaProxy=H,this.dataSourcesService=S,this.localizationService=e,this.modelUpdates=new k.X({schema:void 0,model:void 0,appliedChanges:void 0}),this.subscriptionManager=ee.createChannelSubscriptionManager(),this.subscriptionManager.subscribe(D.CCe,function(M,m){return h.update(m.result.changes)})}return N.prototype.update=function(ee,H,S){return void 0===H&&(H=!0),void 0===S&&(S=!1),(0,f.mG)(this,void 0,void 0,function(){var e,h;return(0,f.Jh)(this,function(m){switch(m.label){case 0:return this.dataSourcesService.get()?(H||this.conceptualSchemaProxy.clearCache(),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:(e=m.sent())&&(h=new a.O(this.localizationService).createModel(e,S)),m.label=2;case 2:return this.modelUpdates.next({schema:e,model:h,appliedChanges:ee}),[2]}})})},Object.defineProperty(N.prototype,"modelChange$",{get:function(){return this.modelUpdates.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"model",{get:function(){return this.modelUpdates.value.model},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"schema",{get:function(){return this.modelUpdates.value.schema},enumerable:!1,configurable:!0}),N.\u0275fac=function(H){return new(H||N)(y.\u0275\u0275inject(P.J),y.\u0275\u0275inject(x.i),y.\u0275\u0275inject(C.D),y.\u0275\u0275inject(j.o))},N.\u0275prov=y.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac}),N}()},8538:function(re,A,r){r.d(A,{h:function(){return H}});var f=r(70863);function a(S){return{schema:S.schemaName,entity:(0,f.wb)(S)?S.name:(0,f.Om)(S)?S.table.name:(0,f.ez)(S)?S.hierarchy.table.name:void 0,hierarchy:(0,f.y3)(S)?S.name:(0,f.ez)(S)?S.hierarchy.name:void 0,hierarchyLevel:(0,f.ez)(S)?S.name:void 0,property:(0,f.wb)(S)||(0,f.y3)(S)||(0,f.ez)(S)||(0,f.Ov)(S)?void 0:S.name}}var y=r(8590),P=r(62458),C=r(9738),x=r(34763),j=r(50423),X=r(11494),N=r(39833),ee=r(93215),H=function(){function S(e,h,M,m){this.schemaItemActivationService=h,this.modelService=M,this.modelingSelectionService=m,this.subscription=new x.w,this.subscriptionManager=e.createChannelSubscriptionManager()}return S.prototype.initialize=function(){var e=this;this.subscriptionManager.subscribe(y.$Bd,function(){return e.onSchemaItemActivationChanged()}),this.subscription.add(this.modelingSelectionService.selectionChanged.subscribe(function(h){return e.onSelectionChanged(h)}))},S.prototype.onSelectionChanged=function(e){if(0===e.length)this.schemaItemActivationService.clearActiveItem();else{var h=e[e.length-1];e.length>1&&this.modelingSelectionService.select(h,!0),this.schemaItemActivationService.setActiveItem(a(h))}},S.prototype.onSchemaItemActivationChanged=function(){if(!function(S,e){if(!e&&0===S.length)return!0;if(1===S.length&&e){var h=a(S[0]);return e.schema===h.schema&&e.entity===h.entity&&e.property===h.property&&e.hierarchy===h.hierarchy&&e.hierarchyLevel===h.hierarchyLevel}return!1}(this.modelingSelectionService.selection,this.schemaItemActivationService.getActiveItem())){var e=this.schemaItemActivationService.getActiveItem();if(e){var h=function(S,e){return e.hierarchyLevel?(0,f.xu)(S,e.schema,e.entity,e.hierarchy,e.hierarchyLevel):e.hierarchy?(0,f.ZG)(S,e.schema,e.entity,e.hierarchy):e.property?(0,f.Gz)(S,e.schema,e.entity,e.property)||(0,f.yo)(S,e.schema,e.entity,e.property):(0,f.AG)(S,e.entity)}(this.modelService.model,e);h?this.modelingSelectionService.select(h,!0):P.fF.assert(function(){return!!h},"onSchemaItemActivationChanged item not found in model")}else this.modelingSelectionService.clear()}},S.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.subscription.unsubscribe()},S.\u0275fac=function(h){return new(h||S)(j.\u0275\u0275inject(X.J),j.\u0275\u0275inject(N.WK),j.\u0275\u0275inject(ee.b),j.\u0275\u0275inject(C.W6))},S.\u0275prov=j.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac}),S}()},65005:function(re,A,r){r.d(A,{l:function(){return We}});var f=r(81337),a=r(50423),D=r(48787),k=r(30794),y=r(12179),P=[],C=r(77476),x=r(68070),j=r(89237);function X(T,W){1&T&&a.\u0275\u0275element(0,"div",7)}function N(T,W){1&T&&(a.\u0275\u0275elementStart(0,"div",8),a.\u0275\u0275element(1,"div",9)(2,"div",10),a.\u0275\u0275elementEnd())}function ee(T,W){1&T&&(a.\u0275\u0275elementStart(0,"div",11),a.\u0275\u0275element(1,"div",12),a.\u0275\u0275elementStart(2,"div",13),a.\u0275\u0275element(3,"div",14)(4,"div",15),a.\u0275\u0275elementEnd()())}function H(T,W){if(1&T&&(a.\u0275\u0275elementContainerStart(0,3),a.\u0275\u0275template(1,X,1,0,"div",4),a.\u0275\u0275template(2,N,3,0,"div",5),a.\u0275\u0275template(3,ee,5,0,"div",6),a.\u0275\u0275elementContainerEnd()),2&T){var R=W.$implicit,Z=a.\u0275\u0275nextContext(2);a.\u0275\u0275property("ngSwitch",R),a.\u0275\u0275advance(1),a.\u0275\u0275property("ngSwitchCase",Z.largeBarType),a.\u0275\u0275advance(1),a.\u0275\u0275property("ngSwitchCase",Z.multipleBarType),a.\u0275\u0275advance(1),a.\u0275\u0275property("ngSwitchCase",Z.multipleSmallLargeType)}}function S(T,W){if(1&T&&(a.\u0275\u0275elementStart(0,"div",1),a.\u0275\u0275template(1,H,4,4,"ng-container",2),a.\u0275\u0275elementEnd()),2&T){var R=a.\u0275\u0275nextContext();a.\u0275\u0275property("ngStyle",R.barsStyle),a.\u0275\u0275advance(1),a.\u0275\u0275property("ngForOf",R.barsProperties.bars)}}var v=function(){function T(){this.largeBarType=0,this.multipleBarType=1,this.multipleSmallLargeType=2}return T.prototype.ngOnChanges=function(){this.barsProperties&&(this.barsStyle={height:"".concat((this.barsProperties.height+8)*this.barsProperties.bars.length,"px")})},T.\u0275fac=function(R){return new(R||T)},T.\u0275cmp=a.\u0275\u0275defineComponent({type:T,selectors:[["shimmering-bars"]],inputs:{barsProperties:"barsProperties"},features:[a.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","bars",3,"ngStyle",4,"ngIf"],[1,"bars",3,"ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["class","largerLoadingBar animate",4,"ngSwitchCase"],["class","multipleBars",4,"ngSwitchCase"],["class","multipleSmallLarge",4,"ngSwitchCase"],[1,"largerLoadingBar","animate"],[1,"multipleBars"],[1,"miniLoadingBar","animate"],[1,"smallerLoadingBar","animate"],[1,"multipleSmallLarge"],[1,"shimmerBox","animate"],[1,"smallLargeBarContainer"],[1,"upperLoadingBar","animate"],[1,"lowerLoadingBar","animate"]],template:function(R,Z){1&R&&a.\u0275\u0275template(0,S,2,2,"div",0),2&R&&a.\u0275\u0275property("ngIf",Z.barsProperties)},dependencies:[C.NgForOf,C.NgIf,C.NgStyle,C.NgSwitch,C.NgSwitchCase],styles:['[_nghost-%COMP%]{--shimmer-background-color: var(--gray-20);--shimmer-animate1: var(--gray-30);--shimmer-animate2: var(--gray-50)}[data-legacy-theming=false]   [_nghost-%COMP%]{--shimmer-background-color: var(--colorNeutralBackground3);--shimmer-animate1: var(--colorNeutralBackground3Hover);--shimmer-animate2: var(--colorNeutralBackground3Pressed)}.bars[_ngcontent-%COMP%]{display:flex;flex-direction:column}.largerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;flex-grow:1;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}.multipleBars[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}.miniLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:60%;width:10%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-right:4px}html[dir="rtl"][_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-left:4px}.smallerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:80%;width:100%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-left:4px}html[dir="rtl"][_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-right:4px}.multipleSmallLarge[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:10px 9px}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}.upperLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:49%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 4px 11px 0}html[dir="rtl"][_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 0 11px 4px}.lowerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:100%;background:var(--shimmer-background-color)}.shimmerBox[_ngcontent-%COMP%]{background:var(--shimmer-background-color);border-radius:2px;height:32px;width:32px}.smallLargeBarContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;max-width:167px}html:not([dir="rtl"])[_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 0 2.42px 13px}html[dir="rtl"][_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 13px 2.42px 0}.animate[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shimmer 5s infinite linear;background:linear-gradient(270deg,var(--shimmer-animate1) 0%,var(--shimmer-animate2) 50%,var(--shimmer-animate1) 100%);background-size:250% 100%}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:250% 0}to{background-position:-250% 0}}'],changeDetection:0}),T}(),F=r(85102),w=["pbiTree"];function G(T,W){if(1&T){var R=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"tri-search-box",5),a.\u0275\u0275listener("value",function(ge){a.\u0275\u0275restoreView(R);var b=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(b.search$.next(ge))}),a.\u0275\u0275pipe(1,"localize"),a.\u0275\u0275pipe(2,"localize"),a.\u0275\u0275elementEnd()}if(2&T){var Z=a.\u0275\u0275nextContext();a.\u0275\u0275property("currentInputValue",Z.searchText||"")("placeholderText",a.\u0275\u0275pipeBind1(2,8,"SearchBox_Text"))("fluentTheme",!0)("compact",!0)("fullWidth",!0),a.\u0275\u0275attribute("aria-label",a.\u0275\u0275pipeBind1(1,6,"SearchBox_Text"))}}function V(T,W){if(1&T){var R=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"pbi-search-box")(1,"input",6),a.\u0275\u0275listener("input",function(ge){a.\u0275\u0275restoreView(R);var b=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(b.search$.next(ge.target.value))}),a.\u0275\u0275pipe(2,"localize"),a.\u0275\u0275pipe(3,"localize"),a.\u0275\u0275elementEnd()()}if(2&T){var Z=a.\u0275\u0275nextContext();a.\u0275\u0275advance(1),a.\u0275\u0275property("value",Z.searchText||"")("placeholder",a.\u0275\u0275pipeBind1(3,5,"SearchBox_Text")),a.\u0275\u0275attribute("aria-label",a.\u0275\u0275pipeBind1(2,3,"SearchBox_Text"))}}function U(T,W){if(1&T&&(a.\u0275\u0275elementContainerStart(0),a.\u0275\u0275element(1,"shimmering-bars",7),a.\u0275\u0275elementContainerEnd()),2&T){var R=a.\u0275\u0275nextContext();a.\u0275\u0275advance(1),a.\u0275\u0275property("barsProperties",R.shimmeringBars)}}function Q(T,W){if(1&T){var R=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"pbi-tree",12,13),a.\u0275\u0275listener("onNodeClick",function(ge){a.\u0275\u0275restoreView(R);var b=a.\u0275\u0275nextContext(2);return a.\u0275\u0275resetView(b.onNodeClick.emit(ge))})("onNodeCheck",function(ge){a.\u0275\u0275restoreView(R);var b=a.\u0275\u0275nextContext(2);return a.\u0275\u0275resetView(b.onNodeCheck.emit(ge))})("onNodeExpansionToggle",function(ge){a.\u0275\u0275restoreView(R);var b=a.\u0275\u0275nextContext(2);return a.\u0275\u0275resetView(b.onNodeExpansionToggle.emit(ge))})("onFirstRender",function(){a.\u0275\u0275restoreView(R);var ge=a.\u0275\u0275nextContext(2);return a.\u0275\u0275resetView(ge.onFirstRender())}),a.\u0275\u0275pipe(2,"async"),a.\u0275\u0275elementEnd()}if(2&T){var Z=a.\u0275\u0275nextContext(2);a.\u0275\u0275property("tree",Z.fieldListTree)("search",a.\u0275\u0275pipeBind1(2,5,Z.search$))("hasHighlights",Z.hasHighlights)("checkMode",Z.checkMode)("options",Z._options)}}function Ce(T,W){1&T&&a.\u0275\u0275projection(0,2)}function q(T,W){if(1&T&&(a.\u0275\u0275elementStart(0,"div",8),a.\u0275\u0275element(1,"div",9),a.\u0275\u0275elementEnd(),a.\u0275\u0275template(2,Q,3,7,"pbi-tree",10),a.\u0275\u0275template(3,Ce,1,0,"ng-template",null,11,a.\u0275\u0275templateRefExtractor)),2&T){var R=a.\u0275\u0275reference(4),Z=a.\u0275\u0275nextContext();a.\u0275\u0275advance(2),a.\u0275\u0275property("ngIf",Z.fieldListTree)("ngIfElse",R)}}var me=[[["",8,"pbi-field-list-perspective-header"]],[["",8,"pbi-field-list-header"]],[["",8,"pbi-field-list-watermark"]]],Fe=[".pbi-field-list-perspective-header",".pbi-field-list-header",".pbi-field-list-watermark"],_e={height:24,bars:[0,1,1,0,0]},We=function(){function T(){this.hasHighlights=!1,this.loading=!1,this.shimmeringBars=_e,this.defaultOptions={},this._options=this.defaultOptions,this.onNodeExpansionToggle=new a.EventEmitter,this.onNodeClick=new a.EventEmitter,this.onNodeCheck=new a.EventEmitter,this.onFirstRenderComplete=new a.EventEmitter,this.handleFieldListTreeHeightDiff=new a.EventEmitter,this.search$=new k.xQ}return Object.defineProperty(T.prototype,"options",{set:function(R){this._options=(0,f.pi)((0,f.pi)({},this.defaultOptions),R)},enumerable:!1,configurable:!0}),T.prototype.ngOnInit=function(){var W=this;this.focusSearchBoxOnFirstRenderComplete&&this.onFirstRenderComplete.pipe((0,D.q)(1)).subscribe(function(){return W.focusSearchBox()})},T.prototype.onFirstRender=function(){var W=this.getFieldListTreeHeightDiff();this.handleFieldListTreeHeightDiff.emit(W),this.scrollSelectedItemIntoViewOnInit&&this.pbiTree.scrollToFirstSelectedNode(),this.onFirstRenderComplete.emit()},T.prototype.focusSearchBox=function(){$(".field-list-search-container input").trigger("focus")},T.prototype.getFieldListTreeHeightDiff=function(){return this.pbiTree.getTreeHeight()+2-this.pbiTreeElementRef.nativeElement.getBoundingClientRect().height},T.\u0275fac=function(R){return new(R||T)},T.\u0275cmp=a.\u0275\u0275defineComponent({type:T,selectors:[["pbi-field-list"]],viewQuery:function(R,Z){if(1&R&&(a.\u0275\u0275viewQuery(y.u,5),a.\u0275\u0275viewQuery(w,5,a.ElementRef)),2&R){var de=void 0;a.\u0275\u0275queryRefresh(de=a.\u0275\u0275loadQuery())&&(Z.pbiTree=de.first),a.\u0275\u0275queryRefresh(de=a.\u0275\u0275loadQuery())&&(Z.pbiTreeElementRef=de.first)}},inputs:{fieldListTree:"fieldListTree",scrollSelectedItemIntoViewOnInit:"scrollSelectedItemIntoViewOnInit",checkMode:"checkMode",hasHighlights:"hasHighlights",loading:"loading",searchText:"searchText",focusSearchBoxOnFirstRenderComplete:"focusSearchBoxOnFirstRenderComplete",fluent:"fluent",options:"options"},outputs:{onNodeExpansionToggle:"onNodeExpansionToggle",onNodeClick:"onNodeClick",onNodeCheck:"onNodeCheck",onFirstRenderComplete:"onFirstRenderComplete",handleFieldListTreeHeightDiff:"handleFieldListTreeHeightDiff"},features:[a.\u0275\u0275ProvidersFeature(P)],ngContentSelectors:Fe,decls:8,vars:4,consts:[["data-tutorial-target","search-box",1,"field-list-search-container"],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["loaded",""],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value"],["pbiSearchInput","","data-testid","search-bar-input",1,"pbi-focus-outline",3,"value","placeholder","input"],[3,"barsProperties"],[1,"tutorial-target-container"],["data-tutorial-target","data-tree"],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender",4,"ngIf","ngIfElse"],["watermark",""],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender"],["pbiTree",""]],template:function(R,Z){if(1&R&&(a.\u0275\u0275projectionDef(me),a.\u0275\u0275elementStart(0,"div",0),a.\u0275\u0275template(1,G,3,10,"tri-search-box",1),a.\u0275\u0275template(2,V,4,7,"pbi-search-box",2),a.\u0275\u0275elementEnd(),a.\u0275\u0275projection(3),a.\u0275\u0275projection(4,1),a.\u0275\u0275template(5,U,2,1,"ng-container",3),a.\u0275\u0275template(6,q,5,2,"ng-template",null,4,a.\u0275\u0275templateRefExtractor)),2&R){var de=a.\u0275\u0275reference(7);a.\u0275\u0275advance(1),a.\u0275\u0275property("ngIf",Z.fluent),a.\u0275\u0275advance(1),a.\u0275\u0275property("ngIf",!Z.fluent),a.\u0275\u0275advance(3),a.\u0275\u0275property("ngIf",Z.loading)("ngIfElse",de)}},dependencies:[C.NgIf,x.a,x.p,j.U,y.u,v,C.AsyncPipe,F.F],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}pbi-tree[_ngcontent-%COMP%]{margin-top:9px;height:100%;display:block;overflow:hidden}.tutorial-target-container[_ngcontent-%COMP%]{position:relative;visibility:hidden;height:0;width:0}.tutorial-target-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:20px;visibility:hidden;height:0;width:0}"],changeDetection:0}),T}()},96883:function(re,A,r){r.d(A,{m:function(){return a}});var f=r(64560);function a(D){return{items:D.items.map(function(y){return{type:y.children?f.iB.SubMenu:Number(y.type),text:y.text,tooltip:y.tooltip,checkable:void 0!==y.checked||void 0,checked:y.checked,disabled:y.disabled,icon:y.icon?{type:0,glyph:y.icon}:void 0,menu:y.children?a({items:y.children}):void 0,data:y.key}})}}},68070:function(re,A,r){r.d(A,{a:function(){return M},p:function(){return h}});var f=r(81337),a=r(50423),D=r(73221),k=r(35510),y=r(59017),P=r(63057),C=r(59787),x=r(6754),j=r(14172),X=r(77526),N=r(77476),ee=function(){return{tooltipLocalizeTitle:"Clear",tooltipShowOnFocus:!0}};function H(m,u){if(1&m){var v=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"button",2),a.\u0275\u0275listener("click",function(){a.\u0275\u0275restoreView(v);var w=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(w.onCancelButtonClick())}),a.\u0275\u0275elementEnd()}2&m&&a.\u0275\u0275property("pbi-tooltip",a.\u0275\u0275pureFunction0(1,ee))}var S=[[["input"]]],e=["input"],h=function(){function m(){}return m.\u0275fac=function(v){return new(v||m)},m.\u0275dir=a.\u0275\u0275defineDirective({type:m,selectors:[["","pbiSearchInput",""]]}),m}(),M=function(m){function u(v){var F=m.call(this)||this;return F.changeDetectorRef=v,F.searchCleared=new a.EventEmitter,F.onSearchTextChanged=new a.EventEmitter,F.emptyValue$=new k.X(void 0),F.hasInput=!1,F}return(0,f.ZT)(u,m),u.prototype.onCancelButtonClick=function(){this.clearSearchText(),this.input.nativeElement.focus()},u.prototype.clearSearchText=function(){this.input.nativeElement.value="",this.hasInput=!1,this.changeDetectorRef.markForCheck(),this.emptyValue$.next(),this.searchCleared.emit()},u.prototype.ngAfterViewInit=function(){var v=this;this.lifecycleSubscriptions.add((0,y.aj)([(0,P.T)((0,C.R)(this.input.nativeElement,"keyup"),(0,C.R)(this.input.nativeElement,"keydown")).pipe((0,x.b)(250)),this.emptyValue$]).pipe((0,j.U)(function(){return v.input.nativeElement.value}),(0,X.x)()).subscribe(function(F){return v.onSearchTextChanged.emit(F)})),setTimeout(function(){return v.onInputChanged(v.input.nativeElement.value)},0)},u.prototype.onInputChanged=function(v){this.hasInput!==!!v&&(this.hasInput=!!v,this.changeDetectorRef.markForCheck())},u.\u0275fac=function(F){return new(F||u)(a.\u0275\u0275directiveInject(a.ChangeDetectorRef))},u.\u0275cmp=a.\u0275\u0275defineComponent({type:u,selectors:[["pbi-search-box"]],contentQueries:function(F,w,G){var V;(1&F&&a.\u0275\u0275contentQuery(G,h,5,a.ElementRef),2&F)&&(a.\u0275\u0275queryRefresh(V=a.\u0275\u0275loadQuery())&&(w.input=V.first))},outputs:{searchCleared:"searchCleared",onSearchTextChanged:"onSearchTextChanged"},features:[a.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:e,decls:3,vars:1,consts:[[1,"pbi-search-box",3,"input"],["class","clearIcon pbi-borderless-button glyphicon pbi-glyph-clear glyph-mini searchbox-clear-icon",3,"pbi-tooltip","click",4,"ngIf"],[1,"clearIcon","pbi-borderless-button","glyphicon","pbi-glyph-clear","glyph-mini","searchbox-clear-icon",3,"pbi-tooltip","click"]],template:function(F,w){1&F&&(a.\u0275\u0275projectionDef(S),a.\u0275\u0275elementStart(0,"div",0),a.\u0275\u0275listener("input",function(V){return w.onInputChanged(V.target.value)}),a.\u0275\u0275projection(1),a.\u0275\u0275template(2,H,1,2,"button",1),a.\u0275\u0275elementEnd()),2&F&&(a.\u0275\u0275advance(2),a.\u0275\u0275property("ngIf",w.hasInput))},dependencies:[N.NgIf],styles:['.pbi-search-box{--searchBox-colorEditLabelBorder: var(--gray-120);--searchBox-colorEditLabelBorderHover: var(--gray-160);--searchBox-colorEditLabelForeground: var(--gray-130);--searchBox-colorEditLabelPlaceholderForeground: var(--gray-140);--searchBox-colorEditLabelBackground: auto;--searchBox-colorEditLabelSelectedForeground: var(--text-primary-content-color);--searchBox-colorEditLabelSelectedBackground: var(--fluent-theme-primary-color)}[data-legacy-theming=false] .pbi-search-box{--searchBox-colorEditLabelBorder: var(--colorNeutralStroke1);--searchBox-colorEditLabelBorderHover: var(--colorNeutralStroke1);--searchBox-colorEditLabelForeground: var(--colorNeutralForeground1);--searchBox-colorEditLabelPlaceholderForeground: auto;--searchBox-colorEditLabelBackground: var(--colorNeutralBackground1);--searchBox-colorEditLabelSelectedForeground: var(--colorNeutralForegroundOnBrand);--searchBox-colorEditLabelSelectedBackground: var(--colorBrandBackground)}.pbi-search-box{display:block;width:100%;position:relative}.pbi-search-box:before{content:"\\e721"}.pbi-search-box:before{color:var(--searchBox-colorEditLabelForeground);display:inline-block;font-family:PowrMDL2;font-size:14px;position:absolute;top:6px;left:8px}.pbi-search-box input{padding:3px 28px;border-radius:2px;border:1px solid var(--searchBox-colorEditLabelBorder);color:var(--searchBox-colorEditLabelForeground);background-color:var(--searchBox-colorEditLabelBackground);outline:none;box-sizing:border-box;font-size:14px;width:100%}.pbi-search-box input:hover,.pbi-search-box input:focus{border-color:var(--searchBox-colorEditLabelBorderHover)}.pbi-search-box input::placeholder{color:var(--searchBox-colorEditLabelPlaceholderForeground)}.pbi-search-box input::selection{background:var(--searchBox-colorEditLabelSelectedBackground);color:var(--searchBox-colorEditLabelSelectedForeground)}.pbi-search-box .pbi-glyph-clear{background-color:transparent}.pbi-search-box .searchbox-clear-icon{color:var(--searchBox-colorEditLabelForeground);position:absolute;right:8px;top:7px;border:0px;padding:0}\n'],encapsulation:2,changeDetection:0}),u}(D.w)}}]);