"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["visual-container-skittles-ui"],{41606:function(ue,j,a){a.d(j,{x:function(){return s}});var f=a(47508),s=function(){function z(){}return z.getDefaultVisualPlugin=function(k){return k&&k.featureSwitches&&k.featureSwitches.pivotTableVisualEnabled?f.L.tableEx:f.L.table},z}()},87644:function(ue,j,a){a.d(j,{VO:function(){return z},Vj:function(){return k},ub:function(){return s}});var s="formattingService",z="formattingUIService",k=z},32441:function(ue,j,a){a.d(j,{u:function(){return k}});var f=a(50423),s=a(18460),z=function(B,S,E,X,q){return{formattingSources:B,indicatorEnabled:S,mobileFormatting:E,disabledCards:X,disabledSlices:q}},k=function(){function b(){var B=this;this.mobileFormatting=!1,this.propertyChanged=new f.EventEmitter,this.outputArgs={propertyChanged:function(E){return B.propertyChanged.emit(E)}},this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="FormattingPaneComponentId"}return b.\u0275fac=function(S){return new(S||b)},b.\u0275cmp=f.\u0275\u0275defineComponent({type:b,selectors:[["formatting-pane-lazy"]],inputs:{formattingSources:"formattingSources",indicatorEnabled:"indicatorEnabled",mobileFormatting:"mobileFormatting",disabledCards:"disabledCards",disabledSlices:"disabledSlices"},outputs:{propertyChanged:"propertyChanged"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(S,E){1&S&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&S&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction5(4,z,E.formattingSources,E.indicatorEnabled,E.mobileFormatting,E.disabledCards,E.disabledSlices))("modulePath",E.modulePath)("outputArgs",E.outputArgs)("componentId",E.componentId)},dependencies:[s.R],encapsulation:2,changeDetection:0}),b}()},78633:function(ue,j,a){a.d(j,{a:function(){return k}});var f=a(50423),s=a(18460),z=function(B){return{colors:B}},k=function(){function b(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="GradientBarComponentId"}return b.\u0275fac=function(S){return new(S||b)},b.\u0275cmp=f.\u0275\u0275defineComponent({type:b,selectors:[["gradient-bar-lazy"]],inputs:{colors:"colors"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(S,E){1&S&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&S&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction1(3,z,E.colors))("modulePath",E.modulePath)("componentId",E.componentId)},dependencies:[s.R],encapsulation:2,changeDetection:0}),b}()},71707:function(ue,j,a){a.d(j,{I:function(){return k}});var f=a(50423),s=a(18460),z=function(B,S,E,X,q){return{toggle:B,ariaLabelledby:S,ariaDescribedby:E,toggleLabel:X,isDisabled:q}},k=function(){function b(){var B=this;this.onToggleChange=new f.EventEmitter,this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="ToggleSwitchModernComponentId",this.outputArgs={onToggleChange:function(E){return B.onToggleChange.emit(E)}}}return b.\u0275fac=function(S){return new(S||b)},b.\u0275cmp=f.\u0275\u0275defineComponent({type:b,selectors:[["toggle-switch-modern-lazy"]],inputs:{toggle:"toggle",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",toggleLabel:"toggleLabel",isDisabled:"isDisabled"},outputs:{onToggleChange:"onToggleChange"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(S,E){1&S&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&S&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction5(4,z,E.toggle,E.ariaLabelledby,E.ariaDescribedby,E.toggleLabel,E.isDisabled))("modulePath",E.modulePath)("outputArgs",E.outputArgs)("componentId",E.componentId)},dependencies:[s.R],encapsulation:2,changeDetection:0}),b}()},90094:function(ue,j,a){a.d(j,{l:function(){return k}});var f=a(50423),s=a(18460),z=function(B){return{warningMessage:B}},k=function(){function b(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="WarningComponentId"}return b.\u0275fac=function(S){return new(S||b)},b.\u0275cmp=f.\u0275\u0275defineComponent({type:b,selectors:[["warning-eager"]],inputs:{warningMessage:"warningMessage"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(S,E){1&S&&f.\u0275\u0275element(0,"pbi-lazy-load",0),2&S&&f.\u0275\u0275property("inputArgs",f.\u0275\u0275pureFunction1(3,z,E.warningMessage))("modulePath",E.modulePath)("componentId",E.componentId)},dependencies:[s.R],encapsulation:2,changeDetection:0}),b}()},42101:function(ue,j,a){a.d(j,{p:function(){return m}});var f=a(9844),B=(a(32441),a(78633),a(71707),a(90094),a(77476)),S=a(9398),E=a(76072),X=a(82156),q=a(50423),H={loadChildren:function(){return Promise.all([a.e(5),a.e("pane-formatting")]).then(a.bind(a,53150)).then(function(v){return v.PaneFormattingModule})}};E.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",H.loadChildren);var ie=[{path:"dummy-pane-formatting-lazy",loadChildren:H.loadChildren}],m=function(){function e(){}return e.\u0275fac=function(O){return new(O||e)},e.\u0275mod=q.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=q.\u0275\u0275defineInjector({imports:[B.CommonModule,f.j,X.N,S.Bz.forChild(ie)]}),e}()},79930:function(ue,j,a){a.d(j,{EY:function(){return e},Wg:function(){return v}});var f=a(81337),s=a(8082),z=a(40823),k=a(83008),b=a(77616),B=a(54766),S=a(54834),E=a(74082),X=a(25740),q=a(65181),H=a(58938),ie=a(4877),K=a(50423),e={provide:"conditionalFormattingDialogLauncherService",useFactory:function(O,g,u,y,D,V){return new v(O,g,u,y,D,V)},deps:[q.o,H.x,ie.a,k.D,s.s,z._]},v=function(){function O(g,u,y,D,V,Y){this.localizationService=g,this.dialogService=u,this.itemPickerService=y,this.dataSourcesService=D,this.runningVisuals=V,this.dataSourcesSerializer=Y}return O.prototype.show=function(g,u,y,D,V,Y){return(0,f.__awaiter)(this,void 0,void 0,function(){var R;return(0,f.__generator)(this,function(U){switch(U.label){case 0:return R=y&&(0,E.tO)(y)?y.measure:y,[4,this.showModernConditionaFormattingDialog(g,u,R,D,V,Y)];case 1:return[2,U.sent().afterClosed().toPromise()]}})})},O.prototype.showModernConditionaFormattingDialog=function(g,u,y,D,V,Y){var R,W;return(0,f.__awaiter)(this,void 0,void 0,function(){var U,_e,J,me,Ee;return(0,f.__generator)(this,function(Le){return U=this.dataSourcesSerializer.serializeDataSources(this.dataSourcesService.get()),_e=D.propertyDescriptor,J=this.runningVisuals.getVisual(g),me={colorPalette:(0,X.NO)(Y.colorPalette),icons:null===(R=this.itemPickerService)||void 0===R?void 0:R.getIcons(),iconSets:null===(W=this.itemPickerService)||void 0===W?void 0:W.getIconSets(),inDataSources:U,propertySelector:D.selector&&(0,B.UZ)(D.selector),allowOverrideTotalMatching:D.allowOverrideSubtotalMatching,propertyDefinition:V&&(0,B.W7)(V,_e),propertyDescriptor:(0,b.m8)(_e,this.localizationService),targetFieldDisplayName:u,targetFieldExpr:y&&S.ib.serializeExpr(y),visualType:J.getType(),hasGrouping:!!D.selector&&this.hasGroupingColumn(J)},Ee={title:"".concat(me.propertyDescriptor.displayName," - ").concat(me.targetFieldDisplayName),input:me,hideOkButton:!1,hideCancelButton:!1,focusInitialCloseButton:!0,footerLink:{text:this.localizationService.get("ConditionalFormattingDialog_LearnMore"),url:"https://go.microsoft.com/fwlink/?linkid=874399",type:"external"}},[2,this.dialogService.showTemplateDialog("ConditionalFormattingDialog",Ee,{minWidth:"940px",height:"665px",autoFocus:!0})]})})},O.prototype.hasGroupingColumn=function(g){if(!g)return!1;var u=g.getDataViews()[0];if(u.metadata&&u.metadata.columns)for(var y=0,D=u.metadata.columns;y<D.length;y++)if(!D[y].isMeasure)return!0;return!1},O.\u0275fac=function(u){return new(u||O)(K.\u0275\u0275inject(q.o),K.\u0275\u0275inject(H.x),K.\u0275\u0275inject(ie.a),K.\u0275\u0275inject(k.D),K.\u0275\u0275inject(s.s),K.\u0275\u0275inject(z._))},O.\u0275prov=K.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac}),O}()},15250:function(ue,j,a){a.r(j),a.d(j,{VisualContainerSkittlesUIModule:function(){return en}});var f=a(77476),s=a(32208),z=a(91280),k=a(42101),b=a(82156),B=a(79061),S=a(47913),E=a(63654),X=a(45411),q=a(66972),H=a(13254),ie=a(72359),K=a(16095),m=a(17177),e=a(50423),v=a(36858),O=a(74913),g=function(){function r(){}return r.prototype.ngOnInit=function(){this.infoIconName=this.mouseOutIcon},r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["build-field-well-info"]],inputs:{iconSprite:"iconSprite",mouseInIcon:"mouseInIcon",mouseOutIcon:"mouseOutIcon",tooltip:"tooltip"},decls:1,vars:4,consts:[["role","tooltip","tri-svg-icon-16","","tabIndex","0",2,"margin-left","4px","margin-top","6px","fill","currentColor",3,"name","sprite","pbiTooltip","mouseenter","mouseleave"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"tri-svg-icon",0),e.\u0275\u0275listener("mouseenter",function(){return i.infoIconName=i.mouseInIcon})("mouseleave",function(){return i.infoIconName=i.mouseOutIcon}),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("name",i.infoIconName)("sprite",i.iconSprite)("pbiTooltip",i.tooltip),e.\u0275\u0275attribute("aria-label",i.tooltip))},dependencies:[v.V,O.M],encapsulation:2}),r}(),u=a(81337),y=a(35510),D=a(30794),V=a(59017),Y=a(63057),R=a(37272),W=a(59973),U=a(81905),_e=a(22318),J=a(83317),me=a(13941),Ee=a(98476),Oe=a(73221),w=a(96883),Z=a(61561),M=a(8590),A=a(60661),pe=a(41606),fe=a(38078),ye=a(57419),P=a(62458),Be=a(45413),Se=a(74082),xt=a(58295),Ze=a(45551),Fe=a(58609),qe=a(43626),Pt=a(79930),et=a(26898),je=a(29748),Ne=a(83008),Et=a(85677),tt=a(66890),kt=a(48145),Ue=a(11494),Ot=a(13702),it=a(8082),nt=a(15393),It=a(9380),wt=a(23983),De=a(28894),Ve=a(65181),Mt=a(88409),Tt=a(29866),Lt=a(67930);function Bt(r,n){if(1&r&&e.\u0275\u0275element(0,"build-field-well-info",6),2&r){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tooltip",t.bucketInfTooltip)}}function Dt(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",2)(2,"h2",3),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Bt,1,1,"build-field-well-info",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"field-picker-modern-lazy",5),e.\u0275\u0275listener("onExprChange",function(d){var h=e.\u0275\u0275restoreView(t).$implicit,C=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(C.onFieldsChange(d,h))})("onCrossPickerDrop",function(d){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onCrossBucketFieldDrop(d))}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&r){var l,i=n.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.displayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.hasHiddenFieldsInVisual),e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabelledby",o.bucketTitle)("disabled",i.disabled)("initialExpr",i.exprs)("withFieldList",!0)("allowMultipleValues",i.supportsMultipleItems)("allowReorderItems",null===(l=o.allowReorderFields)||void 0===l||l)("promotedActionStrategy",i.showHideProjectionStrategy)("getDropExprStrategy",i.getDropExprStrategy)("menuStrategy",i.menuStrategy)("displayNameStrategy",i.displayNameStrategy)("flyoutFieldsStrategy",i.fieldFlyoutFieldsStrategy)("visualCalcFieldsStrategy",i.visualCalcFlyoutFieldsStrategy)("directEditStrategy",i.directEditStrategy)("enterExitFieldRename",e.\u0275\u0275pipeBind1(6,24,i.enterExitFieldRename$))("externalCrossPickerDragDropMonitor",i.crossBucketDragDropMonitor)("perspectiveDisplayName",o.perspectiveDisplayName)("tooltipWithFlexiblePositions",!1)("parameterPickerDataFormat",o.parameterPickerDataFormat)("visualCapabilities",o.visualCapabilities)("addDataAriaLabelKey",i.addDataAriaLabelKey)("emptyFieldSetsDefaultLabel",!o.isVisualCalc)("role",i.role)}}var ot=function(r){function n(t,i,o,l,c,d,p,h,C,L,G,F,de,ee,ce,T,re,Q){var x=r.call(this)||this;x.changeDetectorRef=t,x.conceptualSchemaProxy=i,x.contextActivityService=o,x.dataSourcesService=l,x.eventBridge=c,x.explorationDisplayNameService=d,x.featureSwitchService=p,x.groupingDesignStateService=h,x.lazyScoped=C,x.localizationService=L,x.runningVisualService=G,x.showValueAsService=F,x.visibilityService=de,x.visualAuthoring=ee,x.visualCalcEagerService=ce,x.visualPlugin=T,x.explorationCapabilitiesService=re,x.visualActionContext=Q,x.contentUpdate=new e.EventEmitter,x.parameterPickerDataFormat="buildfieldwell",x.fieldBucketsInternal$=new y.X(void 0),x.uid=fe.b$.generateGuid(),x.manualUpdate$=new D.xQ,x.fieldBuckets$=x.fieldBucketsInternal$.asObservable();var I,ve=new ye.W,le=x.changes$("visualContainer");return(0,V.aj)([le.pipe(),(0,Y.T)(x.manualUpdate$,x.visualCalcEagerService.onContextChange$(),x.visibilityService.get$(16),x.eventBridge.on(M.CCe),x.eventBridge.on(M.KD7),x.eventBridge.on(M.jCS),le.pipe((0,W.h)(function(N){return!!N}),(0,U.w)(function(N){return x.runningVisualService.getVisual$(N)}),(0,U.w)(function(N){return N?N.getErrorInfo$():R.E})),x.eventBridge.on(M.D1A)).pipe((0,_e.O)(void 0))]).pipe((0,J.R)(x.onDestroy$)).subscribe(function(N){var he=N[0];return(0,u.__awaiter)(x,void 0,void 0,function(){var ge=this;return(0,u.__generator)(this,function(Pe){switch(Pe.label){case 0:return[4,ve.enqueue(function(){return(0,u.__awaiter)(ge,void 0,void 0,function(){var te,ne=this;return(0,u.__generator)(this,function(oe){switch(oe.label){case 0:return this.visualCapabilities=(0,A.cj)(he,this.visualPlugin),this.contentUpdate.emit({type:"start",forVisualContainerChange:te=he!==I}),[4,this.updateFieldBuckets(he)];case 1:return oe.sent(),this.changeDetectorRef.detectChanges(),setTimeout(function(){ne.contentUpdate.emit({type:"end",forVisualContainerChange:te})}),I=he,[2]}})})})];case 1:return Pe.sent(),[2]}})})}),x.showFieldTooltip=x.localizationService.get("Visual_Calculation_Field_Well_Show_In_Visual"),x.hideFieldTooltip=x.localizationService.get("Visual_Calculation_Field_Well_Hide_From_Visual"),x.bucketInfTooltip=x.localizationService.get("Visual_Calculation_Field_Bucket_Tooltip"),x}return(0,u.__extends)(n,r),n.prototype.onFieldsChange=function(t,i){return(0,u.__awaiter)(this,void 0,void 0,function(){var o,l;return(0,u.__generator)(this,function(c){switch(c.label){case 0:return l=!0,(0,me.JB)(o=t.fromUpdate)?[4,this.handleAdd(i,o,t.newExpr)]:[3,2];case 1:return l=c.sent(),[3,9];case 2:return(0,me.H2)(o)?[4,this.handleDelete(i,o)]:[3,4];case 3:return c.sent(),[3,9];case 4:return(0,me.cA)(o)?[4,this.handleReplace(i,o,t.newExpr)]:[3,6];case 5:return l=c.sent(),[3,9];case 6:return(0,me.cS)(o)?(P.fF.assert(function(){return _.isArray(t.newExpr)},"there must be multiple fields when reoreder udpate happpens"),[4,this.handleReorder(i,o,t.newExpr)]):[3,8];case 7:return l=c.sent(),[3,9];case 8:(0,me.y$)(o)&&this.handleRename(i,o),c.label=9;case 9:return l||this.manualUpdate$.next(),[2]}})})},n.prototype.onCrossBucketFieldDrop=function(t){if(t.fromGroupId===this.uid&&t.toGroupId===this.uid){var i=t.fromComponentId,o=t.toComponentId;if(i===o)return void P.fF.assertFail("Expect this only be called when field is moved between different buckets");var l=this.fieldBucketsInternal$.value,c=_.find(l,function(ee){return ee.bucketUid===i});if(c){var d=_.find(l,function(ee){return ee.bucketUid===o});if(d){var p=t.fromPosition,h=t.toPosition;P.fF.assert(function(){return 1===_.size(p)&&("end"===h||1===_.size(h))},"build-field-well supports cross-bucket drag-drop of first-level items only. Add your implementation for new scenario.");var L="end"===h?"end":h[0],G=c.properties[p[0]],F={sourceRole:c.role,sourceIndex:G.startIndex,hierarchyLevelCount:_.size(G.hierarchyLevels)};"end"===L?d.core.dropWithPayload(F):d.properties[L].core.dropWithPayloadAndAction(F,2)}}}},n.prototype.updateFieldBuckets=function(t){return(0,u.__awaiter)(this,void 0,void 0,function(){var i,o,l,c,d,p,h,C,L,G,F,de,ee,ce,T=this;return(0,u.__generator)(this,function(re){switch(re.label){case 0:return this.fieldWellViewModelService?[3,2]:(i=this,[4,this.lazyScoped.get("fieldWellViewModelService")]);case 1:i.fieldWellViewModelService=re.sent(),re.label=2;case 2:return this.fieldWellBucketService?[3,4]:(o=this,[4,this.lazyScoped.get(qe.fI)]);case 3:o.fieldWellBucketService=re.sent(),re.label=4;case 4:return this.fieldWellFieldService?[3,6]:(l=this,[4,this.lazyScoped.get(qe.tE)]);case 5:l.fieldWellFieldService=re.sent(),re.label=6;case 6:return t?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:(c=(0,A.x3)(pe.x.getDefaultVisualPlugin(this.featureSwitchService)),d=this.fieldWellViewModelService.createEmptyBuckets(c,[]),P.fF.assert(function(){return 1===_.size(d)},"build-field-well should show only one empty bucket when no visual is selected"),p=d[0],h=this.localizationService.get("Data"),(C=(0,u.__assign)((0,u.__assign)({},p),{core:this.getFieldWellBucketCore(p),displayName:h,addDataAriaLabelKey:this.localizationService.format("Skittles_Build_AddData",h)})).fieldFlyoutFieldsStrategy=this.getFieldFlyoutFieldsStrategy(C,0,t),this.fieldBucketsInternal$.next([C]),[2]);case 7:return L=re.sent(),this.isVisualCalc=16===t.visibility,[4,this.fieldWellViewModelService.createBuckets(this.runningVisualService.getVisual(t),t,L,this.groupingDesignStateService,this.showValueAsService,this.visualPlugin,this.explorationDisplayNameService,[],!1,this.isVisualCalc,!0,this.overrideSingleBucketForAutoVisual).promise];case 8:for(G=re.sent(),F=_.map(G,function(Q){var x=T.isVisualCalc?Q.properties:_.filter(Q.properties,function(te){return!te.isHiddenInVisual}),I=Q.properties.length>x.length;Q.properties=x,Q.supportsMultipleItems=T.isVisualCalc||Q.supportsMultipleItems;var ae={getDropExpr:function(ne,oe){return Promise.resolve({expr:ne})},getDroppedExprChildren:function(ne,oe,be,Ce){return T.getChildExprs(Q,oe,be,Ce)}},ve={getMenu:function(ne,oe,be,Ce){return void 0===Ce&&(Ce=void 0),T.getMenu(Q,ne,oe,Ce)},menuItemClickHandler:function(ne,oe,be){P.fF.assert(function(){return 1===_.size(oe)},"build-field-well supports menu on first-level items, i.e., non hierarchy-levels only. Add your implementation for new scenario."),Pe[oe[0]].core.selectFieldMenuItem(ne.data)}},le={getDisplayName:function(ne,oe,be,Ce){return T.getFieldDisplayName(Q,oe,Ce)},isRenameAllowed:function(ne,oe){return T.getIsRenameAllowed(Q,ne,oe)},getCustomTooltipContent:function(ne,oe,be,Ce){return T.getCustomTooltipContent(Q,be,Ce)},isFieldInvalid:function(ne,oe){return T.getIsFieldInvalid(Q,ne,oe)},getDisplayNameStyle:function(ne,oe){return T.getFieldDisplayNameStyle(Q,ne,oe)}},N=_.map(Q.properties,function(te){return te.expr}),he=new y.X(void 0),ge=(0,u.__assign)((0,u.__assign)({},Q),{bucketUid:fe.b$.generateGuid(),exprs:Q.supportsMultipleItems?_.map(N,function(te){return{expr:te}}):N[0]?{expr:N[0]}:void 0,core:T.getFieldWellBucketCore(Q),getDropExprStrategy:ae,menuStrategy:ve,displayNameStrategy:le,enterExitFieldRename$:he,addDataAriaLabelKey:T.localizationService.format("Skittles_Build_AddData",Q.displayName)}),Pe=_.map(Q.properties,function(te,ne){return(0,u.__assign)((0,u.__assign)({},te),{core:T.getFieldWellFieldCore(ge,ne,te),showHideFieldAction$:new y.X(T.generateFieldAction(t,te))})});return ge.properties=Pe,ge.showHideProjectionStrategy={getAction:function(ne,oe){if(T.isShowHideActionInfoReady(oe)&&1===_.size(ne))return ge.properties[ne[0]].showHideFieldAction$.asObservable()}},ge.hasHiddenFieldsInVisual=I,ge}),de=function(x){var I=F[x];I.crossBucketDragDropMonitor={groupId:ee.uid,componentId:I.bucketUid},I.fieldFlyoutFieldsStrategy=ee.getFieldFlyoutFieldsStrategy(I,x,t),ee.featureSwitchService.featureSwitches.visualCalculationPencilIcon?I.directEditStrategy={onEdit:function(le){return(0,u.__awaiter)(T,void 0,void 0,function(){var N,he;return(0,u.__generator)(this,function(ge){switch(ge.label){case 0:return null==(N=I.properties[le[0]])?[2]:(he=(0,A.$Z)(t,N.role,N.startIndex),[4,this.enterVisualCalcMode(t,he)]);case 1:return ge.sent(),[2]}})})},isDisabled:function(le){if(!T.visualCalcEagerService.isVisualCalcAuthoringEnabled()||T.explorationCapabilitiesService.getCapabilities().disableVisualCalcAuthoring)return!0;var N=I.properties[le[0]];if(null==N)return!0;P.fF.assert(function(){return(0,Se.jX)(N.expr)},"Expect only native visual calc fields to be editable");var he=N.expr,ge=_.find((0,A.oJ)(t),function(Pe){return Pe.nativeReferenceName===he.name});return null==ge||T.visualCalcEagerService.shouldDisableEditing(ge.name,t)},getActionTooltip:function(){return T.visualCalcEagerService.isVisualCalcAuthoringEnabled()?T.explorationCapabilitiesService.getCapabilities().disableVisualCalcAuthoring?T.localizationService.get("FieldWell_EditVisualCalculation_Disabled_From_Explore"):T.localizationService.get("Calculation_Options_Pencil"):T.localizationService.get("Calculation_Options_NoFS")},shouldAllowDirectEdit:function(le){var N,he=null===(N=I.properties[le[0]])||void 0===N?void 0:N.expr;return null!=he&&(0,Se.jX)(he)}}:I.visualCalcFlyoutFieldsStrategy={onEditVisualCalc:function(le){return(0,u.__awaiter)(T,void 0,void 0,function(){return(0,u.__generator)(this,function(N){switch(N.label){case 0:return[4,this.enterVisualCalcMode(t,le)];case 1:return N.sent(),[2]}})})},getQueryName:function(le){var N=I.properties[le[0]];if(null!=N)return(0,A.$Z)(t,N.role,N.startIndex)},isEditableVisualCalc:function(le){return!(!T.visualCalcEagerService.isVisualCalcAuthoringEnabled()||null==le)&&(0,Se.jX)(le)}}},ee=this,ce=0;ce<F.length;ce++)de(ce);return this.fieldBucketsInternal$.next(F),[2]}})})},n.prototype.enterVisualCalcMode=function(t,i){return(0,u.__awaiter)(this,void 0,void 0,function(){var o;return(0,u.__generator)(this,function(l){switch(l.label){case 0:return o=(0,Fe.hF)(this.contextActivityService,{name:"VisualAction",visualName:this.visualContainer.name,data:(0,u.__assign)((0,u.__assign)({},this.visualActionContext),{action:"EditVisualCalculation"})}),[4,this.visualCalcEagerService.enterVisualCalcMode(t,i,o)];case 1:return l.sent(),[2]}})})},n.prototype.getFieldFlyoutFieldsStrategy=function(t,i,o){var l=this;return{getFieldsToSelectOnOpen:function(p,h){return l.getInitialFlyoutFieldsToSelect(t,p,h)},getFieldsToDisableOnOpen:function(p,h,C,L){return l.getInitialFlyoutFieldsToDisable(t,p,L)},handleSelectedField:function(p,h){return(0,u.__awaiter)(l,void 0,void 0,function(){return(0,u.__generator)(this,function(C){switch(C.label){case 0:return[4,this.handleSelectedField(t,p,h)];case 1:return C.sent(),[2]}})})},handleDeselectedField:function(p){return l.handleDeselectedField(l.fieldBucketsInternal$.value[i],p)},onCloseWithCreateVisualCalc:function(p){return(0,u.__awaiter)(l,void 0,void 0,function(){return(0,u.__generator)(this,function(h){switch(h.label){case 0:return[4,this.onCloseFlyoutWithCreateVisualCalc(o,p)];case 1:return h.sent(),[2]}})})},getVisualCalcCreationInfo:function(p){return(0,u.__awaiter)(l,void 0,void 0,function(){return(0,u.__generator)(this,function(h){switch(h.label){case 0:return[4,this.getVisualCalcCreationInfo(o,p)];case 1:return[2,h.sent()]}})})},canOpenFlyout:function(p){var h;if(null==p)return!1;if(!l.featureSwitchService.featureSwitches.visualCalculationPencilIcon)return!0;var C=null===(h=t.properties[p[0]])||void 0===h?void 0:h.expr;return null==C||!(0,Se.jX)(C)}}},n.prototype.generateFieldAction=function(t,i){var o=this;if(16===t.visibility){var l=i.expr;if(null!=l&&((0,xt.k)(l)||(0,Se.jX)(l))){var c=i.isHiddenInVisual,d=i.role,p=i.startIndex;return{tooltip:c?this.showFieldTooltip:this.hideFieldTooltip,svgIconName:c?"eye_off_16_regular":"eye_16_regular",svgIconSpriteName:"fluentui-icons",handler:function(){o.visualAuthoring.toggleFieldHidden(d,p,t,o.dataSourcesService.get())}}}}},n.prototype.getCustomTooltipContent=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);P.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c?{title:d.displayOptions.tooltipTitle,description:d.displayOptions.tooltipDescription}:{title:d.hierarchyLevels[i[1]].tooltipTitle}}},n.prototype.getFieldDisplayName=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);P.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c?d.displayOptions.displayName:d.hierarchyLevels[i[1]].displayName}},n.prototype.getFieldDisplayNameStyle=function(t,i,o){var l={};if(!this.isNameInfoReadyAtUpdate(o))return l;var d=_.size(i);P.fF.assert(function(){return 1===d||2===d},"fields in build-field-well has either 1 or 2 levels");var p=_.nth(t.properties,i[0]);return null!=p?.displayOptions.pbiStyle?p.displayOptions.pbiStyle:l},n.prototype.getIsFieldInvalid=function(t,i,o){if(this.isNameInfoReadyAtUpdate(o)){var c=_.size(i);P.fF.assert(function(){return 1===c||2===c},"fields in build-field-well has either 1 or 2 levels");var d=_.nth(t.properties,i[0]);return 1===c&&!d.valid}},n.prototype.isNameInfoReadyAtUpdate=function(t){var i=t.type;switch(i){case"delete":case"add":case"reorder":case"replace":return!1;case"rename":P.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":return!0;default:return void P.fF.assertNever(i)}},n.prototype.isShowHideActionInfoReady=function(t){var i=t.type;switch(i){case"add":case"replace":case"delete":return!1;case"initialize":case"rename":case"reorder":return!0;default:return void P.fF.assertNever(i)}},n.prototype.getMenu=function(t,i,o,l){var c,d,p=l.type;switch(p){case"delete":P.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"rename":case"reorder":case"replace":d=!1;break;case"initialize":d=!0;break;default:P.fF.assertNever(p)}if(d){var h=_.size(o);if(P.fF.assert(function(){return 1===h||2===h},"fields in build-field-well has either 1 or 2 levels"),1===h){var C=_.nth(t.properties,o[0]);if(!C||!(0,Be.fS)(C.expr,i))return void P.fF.assertFail("expression (after drop) of property at index "+o[0]+" does not match expected");var L=null===(c=C.interactivityOptions)||void 0===c?void 0:c.dropDownItems;return _.isEmpty(L)?void 0:(0,w.m)(L)}}},n.prototype.getIsRenameAllowed=function(t,i,o){var l,c,d=o.type;switch(d){case"delete":P.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"reorder":case"replace":c=!1;break;case"rename":P.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":c=!0;break;default:P.fF.assertNever(d)}if(c){var p=_.size(i);if(P.fF.assert(function(){return 1===p||2===p},"fields in build-field-well has either 1 or 2 levels"),1===p)return null===(l=_.nth(t.properties,i[0]).interactivityOptions)||void 0===l?void 0:l.isEditableField}},n.prototype.getChildExprs=function(t,i,o,l){var c,d=l.type;switch(d){case"delete":P.fF.assertFail("Expect this NOT to be called for update type Delete");case"add":case"reorder":case"replace":c=!1;break;case"rename":P.fF.assertFail("Expect this NOT to be called for update type Rename");case"initialize":c=!0;break;default:P.fF.assertNever(d)}if(c&&1===_.size(i)){var p=rt(t,i[0],o);return _.map(p,function(h){return{expr:h}})}},n.prototype.getInitialFlyoutFieldsToSelect=function(t,i,o){if(P.fF.assert(function(){return!!o==!!i},"flyoutOpenFromPosition and flyoutOpenFromField should be both undefined or defined"),o){P.fF.assert(function(){return _.size(i)<=2},"build-field-well have maximum 2 levels of fiels");var l=_.nth(t.properties,i[0]),c=l.expr;if(P.fF&&2===_.size(i))if((0,Se.ez)(o)){var d=(0,Se.t3)(c)&&(0,Be.fS)((0,Ze.ZB)(o),c),p=(0,Se.y3)(c)&&(0,Be.fS)(c,o.arg);P.fF.assert(function(){return d||p},"in build-field-well, a hierarchy-level field's parent should be its variation source or owning hierarchy")}else P.fF.assertFail("second level fields of build-field-well should be hierarchy levels");return _.isEmpty(l.hierarchyLevels)?[c]:[l.hierarchyLevels[0].expr.arg]}},n.prototype.getInitialFlyoutFieldsToDisable=function(t,i,o){if(i)return P.fF.assert(function(){return _.size(i)<=2},"build-field-well have maximum 2 levels of fiels"),rt(t,i[0],o)},n.prototype.handleDeselectedField=function(t,i){var o=(0,Ee.f)(i,t.properties);_.isEmpty(o)||this.handleDelete(t,{type:"delete",deleted:{position:o,expr:i}})},n.prototype.handleSelectedField=function(t,i,o){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(l){switch(l.label){case 0:return o?(P.fF.assert(function(){return _.size(o)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),P.fF.assert(function(){return 1===_.size(o)||!!_.nth(t.properties[o[0]].hierarchyLevels,o[1])},"build-field-well flyout opened from second-level field should correspond to a hierarchy level"),[4,t.properties[o[0]].core.dropField(i,1)]):[3,2];case 1:return l.sent(),[3,3];case 2:t.core.dropField(i),l.label=3;case 3:return[2]}})})},n.prototype.onCloseFlyoutWithCreateVisualCalc=function(t,i){var o,l;return(0,u.__awaiter)(this,void 0,void 0,function(){var c,d,p,C;return(0,u.__generator)(this,function(L){switch(L.label){case 0:c=(0,Fe.hF)(this.contextActivityService,{name:"VisualAction",visualName:this.visualContainer.name,data:(0,u.__assign)((0,u.__assign)({},this.visualActionContext),{action:"CreateVisualCalculation"})}),L.label=1;case 1:return L.trys.push([1,5,,6]),null!=this.visualCalcService?[3,3]:(d=this,[4,this.lazyScoped.get(Z.w)]);case 2:d.visualCalcService=L.sent(),L.label=3;case 3:return p=null===(l=null===(o=t?.config)||void 0===o?void 0:o.singleVisual)||void 0===l?void 0:l.autoSelectVisualType,[4,this.visualCalcService.enterVisualCalcMode(t,void 0,p?void 0:i,c)];case 4:return L.sent(),c.resolve(),[3,6];case 5:throw C=L.sent(),c.reject(C),C;case 6:return[2]}})})},n.prototype.getVisualCalcCreationInfo=function(t,i){return(0,u.__awaiter)(this,void 0,void 0,function(){var o;return(0,u.__generator)(this,function(l){switch(l.label){case 0:return null!=this.visualCalcService?[3,2]:(o=this,[4,this.lazyScoped.get(Z.w)]);case 1:o.visualCalcService=l.sent(),l.label=2;case 2:return[4,this.visualCalcService.getVisualCalcCreationInfo(t,this.visualCapabilities,i)];case 3:return[2,l.sent()]}})})},n.prototype.handleAdd=function(t,i,o){return(0,u.__awaiter)(this,void 0,void 0,function(){var l,d,p;return(0,u.__generator)(this,function(de){return l=_.isArray(o)?o:o?[o]:[],1===_.size(l)?[2,t.core.dropField(l[0].expr)]:(d=i.added.position,P.fF.assert(function(){return"end"===d||1===_.size(d)},"build-field-well only allows add into first-level fields."),(p="end"===d?_.size(l)-1:d[0])===_.size(l)-1?[2,t.core.dropField(_.last(l).expr)]:[2,t.properties[p].core.dropWithPayloadAndAction({field:i.added.pickerOriginalExpr},2)])})})},n.prototype.handleDelete=function(t,i){return(0,u.__awaiter)(this,void 0,void 0,function(){var o,l,c,d;return(0,u.__generator)(this,function(p){switch(p.label){case 0:return o=i.deleted.position,P.fF.assert(function(){return 1===_.size(o)||2===_.size(o)},"build-field-well supports maximum 2-levels of fields"),l=_.first(o),P.fF.assert(function(){return _.inRange(l,0,_.size(t.properties))},"first level fieldindex to delete is not in valid range"),c=t.properties[l],d=_.nth(o,1),P.fF.assert(function(){return null==d||_.inRange(d,0,_.size(c.hierarchyLevels))},"child index to delete is not in valid range"),[4,c.core.deleteField(d)];case 1:return p.sent(),[2]}})})},n.prototype.handleReorder=function(t,i,o){return(0,u.__awaiter)(this,void 0,void 0,function(){var l,c,d,p,h,C,L;return(0,u.__generator)(this,function(F){return l=i.reordered.fromPosition,c=i.reordered.toPosition,P.fF.assert(function(){return 1===_.size(l)&&1===_.size(c)},"build-field-well supports reordering of first-level items only. Add your implementation for new scenario."),d=l[0],P.fF.assert(function(){return _.inRange(d,0,_.size(t.properties))},"reorder.fromIndex is not in valid range"),p={sourceRole:t.role,sourceIndex:t.properties[d].startIndex,hierarchyLevelCount:_.size(t.properties[d].hierarchyLevels)},L=c[0],P.fF.assert(function(){return _.inRange(L,0,_.size(t.properties)+1)},"reorder.toIndex is not in valid range"),L===_.size(o)?(h=_.last(t.properties).core,C=3):(h=t.properties[L].core,C=2),[2,h.dropWithPayloadAndAction(p,C)]})})},n.prototype.handleReplace=function(t,i,o){return(0,u.__awaiter)(this,void 0,void 0,function(){var l,c,d;return(0,u.__generator)(this,function(p){return l=i.replaced.position,P.fF.assert(function(){return 1===_.size(l)},"build-field-well only allows replace first-level fields from underlying pbi-drag-drop-picker"),c=l[0],P.fF.assert(function(){return _.inRange(c,0,_.size(t.properties))},"index to replace is not in valid range"),P.fF.assert(t.supportsMultipleItems?function(){return _.isArray(o)&&_.size(t.properties)===_.size(o)}:function(){return!_.isArray(o)&&1===_.size(t.properties)},"properties and newExprsAfterUpdate size mismatch"),d=_.isArray(o)?o[c]:o,[2,t.properties[c].core.dropField(d.expr,1)]})})},n.prototype.handleRename=function(t,i){var o=i.renamed.position;P.fF.assert(function(){return 1===_.size(o)},"build-field-well only allows rename of first-level fields");var l=i.renamed.newName,c=t.properties[o[0]];P.fF.assertValue(c,"Invalid fieldIndex"),c.core.rename(l)},n.prototype.getFieldWellFieldCore=function(t,i,o){var l=this,c=this.fieldWellFieldService.createFieldWellFieldCore(void 0,function(d){return l.onLabelInEditingModeChanged(t,i,d)});return c.viewModel=o,c},n.prototype.onLabelInEditingModeChanged=function(t,i,o){t.enterExitFieldRename$.next({fieldPosition:[i],modeOn:!!o})},n.prototype.getFieldWellBucketCore=function(t){var i=this.fieldWellBucketService.createFieldWellBucketCore();return i.viewModel=t,i},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(et.i),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject(Ne.D),e.\u0275\u0275directiveInject(Ue.J),e.\u0275\u0275directiveInject(Ot.O),e.\u0275\u0275directiveInject(It.vZ),e.\u0275\u0275directiveInject(wt.AA),e.\u0275\u0275directiveInject(De.H),e.\u0275\u0275directiveInject(Ve.o),e.\u0275\u0275directiveInject(it.s),e.\u0275\u0275directiveInject(Et.P),e.\u0275\u0275directiveInject(nt.w),e.\u0275\u0275directiveInject(tt.$8),e.\u0275\u0275directiveInject(Mt.w),e.\u0275\u0275directiveInject(Tt.D),e.\u0275\u0275directiveInject(kt.U),e.\u0275\u0275directiveInject(Fe.yk))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-field-well"]],inputs:{visualContainer:"visualContainer",perspectiveDisplayName:"perspectiveDisplayName",allowReorderFields:"allowReorderFields",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual"},outputs:{contentUpdate:"contentUpdate"},features:[e.\u0275\u0275ProvidersFeature([Pt.Wg]),e.\u0275\u0275InheritDefinitionFeature],decls:3,vars:3,consts:[[1,"buildFieldWell"],[4,"ngFor","ngForOf"],[1,"bucketHeader"],["id","bucketTitle",1,"bucketTitle"],["iconSprite","fluentui-icons","mouseInIcon","info_20_filled","mouseOutIcon","info_20_regular",3,"tooltip",4,"ngIf"],["tooltipPosition","before",3,"ariaLabelledby","disabled","initialExpr","withFieldList","allowMultipleValues","allowReorderItems","promotedActionStrategy","getDropExprStrategy","menuStrategy","displayNameStrategy","flyoutFieldsStrategy","visualCalcFieldsStrategy","directEditStrategy","enterExitFieldRename","externalCrossPickerDragDropMonitor","perspectiveDisplayName","tooltipWithFlexiblePositions","parameterPickerDataFormat","visualCapabilities","addDataAriaLabelKey","emptyFieldSetsDefaultLabel","role","onExprChange","onCrossPickerDrop"],["iconSprite","fluentui-icons","mouseInIcon","info_20_filled","mouseOutIcon","info_20_regular",3,"tooltip"]],template:function(i,o){1&i&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Dt,7,26,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,o.fieldBuckets$)))},dependencies:[f.NgForOf,f.NgIf,Lt.m,g,f.AsyncPipe],styles:['.buildFieldWell[_ngcontent-%COMP%]   .bucketHeader[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;flex-direction:row}.buildFieldWell[_ngcontent-%COMP%]   .bucketTitle[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin:8px 0 4px}.buildFieldWell[_ngcontent-%COMP%]     .drap-drop-picker{background:white}'],changeDetection:0}),n}(Oe.w);function rt(r,n,t){var i=_.nth(r.properties,n);if(!_.isEmpty(i.hierarchyLevels)){var o=_.map(i.hierarchyLevels,function(c){return c.expr});if(P.fF){var l=(0,Ze.wA)(t,i.expr);if(!_.isArray(l)||_.isEmpty(l))return void P.fF.assertFail("Corresponding bucket property has hierarchyLevels, the expanded expr should have hierarchy level children as well");_.some(o,function(c){return!_.find(l,function(d){return(0,Be.fS)(d,c)})})&&P.fF.assertFail("Cannot find the corresponding bucket property hierarchyLevel in hierarchy levels expanded from the dropped expr")}return o}}var se=a(14172),Vt=a(59051),zt=a(96441),ze=a(86286),xe=a(49977),Rt=a(90331),we=function(r){function n(t,i){var l,o=this;(o=r.call(this,t,i)||this).overlayRef=i,o.config.providers.set(n,o),o.horizontalSide=t.horizontalSide,o.verticalLayout=t.verticalLayout,o.horizontalLayout=t.horizontalLayout,o.flyoutWidthSubject$=new y.X(null!==(l=o.config.options.width)&&void 0!==l?l:xe.Lc.childOverlayWidth),o.flyoutWidth$=o.flyoutWidthSubject$.asObservable(),o.flyoutWidth$.pipe((0,J.R)(o.onClose)).subscribe(function(h){requestAnimationFrame(function(){o.overlayRef.updateSize({width:h})})});var d,p,c=o.config.options.positionStrategy;return(d=c instanceof Rt.M?c.positionStrategy:c)instanceof Vt._G?p=d.positionChanges.pipe((0,se.U)(function(h){return h.connectionPair.originX})):d instanceof zt.A&&(p=d.onPositionChange$().pipe((0,se.U)(function(h){return h.originX}))),p&&p.pipe((0,J.R)(o.onClose)).subscribe(function(h){h&&("start"===h&&(o.horizontalSide="left"),"end"===h&&(o.horizontalSide="right"))}),o}return(0,u.__extends)(n,r),n.prototype.updateWidth=function(t){this.flyoutWidthSubject$.next(t)},n}(ze.w),at=function(){function r(){this.pauseScrollCalls=0}return r.prototype.setScrollContainerElementRef=function(n){this.scrollContainerElementRef!==n&&(this.pauseScrollCalls=0),this.scrollContainerElementRef=n},r.prototype.onContentScroll=function(){var n=this.scrollContainerElementRef.nativeElement;this.pauseScrollCalls>0&&n.scrollTop!==this.restoreScrollTop&&(n.scrollTop=this.restoreScrollTop)},r.prototype.onContentUpdate=function(n){var t;if(!n.forVisualContainerChange)if("start"===n.type){if(this.pauseScrollCalls++,1===this.pauseScrollCalls){var i=null===(t=this.scrollContainerElementRef)||void 0===t?void 0:t.nativeElement;if(P.fF.assertValue(i,"skittle content update starts when it is not for a new visual container, scrollContainerElement should exist"),!i)return;this.restoreScrollTop=i.scrollTop}}else this.pauseScrollCalls--},r}(),At=a(49162),Wt={autoVisualWithPerspectives:!1,showClearChanges:!1,dimensions:{}},Me=function(r){function n(){return r.call(this,Wt)||this}return(0,u.__extends)(n,r),n.prototype.getAutoVisualWithPerspectives=function(){return this.settings.autoVisualWithPerspectives},n.prototype.setAutoVisualWithPerspectives=function(t){this.setValue("autoVisualWithPerspectives",t)},n.prototype.getShowClearChanges=function(){return this.settings.showClearChanges},n.prototype.setShowClearChanges=function(t){this.setValue("showClearChanges",t)},n.prototype.getDimensions=function(t){return void 0===t&&(t=0),this.settings.dimensions[t]},n.prototype.setDimensions=function(t,i){var o,l=this.getDimensions(t),c=i;l&&(c=(0,u.__assign)((0,u.__assign)({},l),i)),this.setValue("dimensions",(0,u.__assign)((0,u.__assign)({},this.settings.dimensions),((o={})[t]=c,o)))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(i){return new(i||n)}}),n}(At.g),lt=a(80649),Te=a(77526),Re=a(17653),He=a(48787),$t=a(87644),st=a(75096),jt=a(7779),Nt=a(59725),ct=a(15580),Ut=a(3579),Ht=a(39503),Kt=a(93215),Qt=a(18460),Ae=a(59968),Xt=a(65005);function Gt(r,n){if(1&r&&e.\u0275\u0275element(0,"pbi-lazy-load",6),2&r){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.exploreUIAuthoringModulePath)("componentId","AutoVisualComponentId")("inputArgs",t.autoVisualInputArgs)}}var ut=function(n,t){return{"pbi-glyph-chevrondownmedium":n,"pbi-glyph-chevronupmedium":t}};function Yt(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.fieldListSectionExpanded=!l.fieldListSectionExpanded)}),e.\u0275\u0275element(1,"span",8)(2,"i",9),e.\u0275\u0275elementEnd()}if(2&r){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,ut,!i.fieldListSectionExpanded,i.fieldListSectionExpanded))}}function Jt(r,n){if(1&r&&(e.\u0275\u0275elementStart(0,"div",10),e.\u0275\u0275element(1,"pbi-field-list",11),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&r){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(2,5,t.fieldListTree$))("checkMode",t.fieldListCheckMode)("hasHighlights",!1)("loading",!e.\u0275\u0275pipeBind1(3,7,t.fieldListTree$))("options",t.fieldListOptions)}}function Zt(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.toggleFieldWellSectionExpansion())}),e.\u0275\u0275element(1,"span",12)(2,"i",9),e.\u0275\u0275elementEnd()}if(2&r){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,ut,!i.fieldWellSectionExpanded,i.fieldWellSectionExpanded))}}var qt=function(n){return{"with-field-list":n}};function ei(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"build-field-well",13),e.\u0275\u0275listener("contentUpdate",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onContentUpdate(l))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&r){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(7,qt,i.withFieldList))("visualContainer",i.visualContainer)("perspectiveDisplayName",i.perspectiveDisplayName)("allowReorderFields",i.overrideSingleBucketForAutoVisual||e.\u0275\u0275pipeBind1(1,5,i.allowReorderFields$))("overrideSingleBucketForAutoVisual",i.overrideSingleBucketForAutoVisual)}}var ti=function(){return{ignoreOverlay:!1,ignoreMobile:!1}},We=function(r){function n(t,i,o,l,c,d,p,h,C,L,G){var F=r.call(this)||this;F.changeDetectorRef=t,F.conceptualSchemaProxy=i,F.contextActivityService=o,F.dataSources=l,F.eventBridge=c,F.explorationNavigation=d,F.fieldListTreeService=p,F.lazyScoped=h,F.localizationService=C,F.modelService=L,F.skittleSettingsService=G,F.contentUpdate=new e.EventEmitter,F.fieldListCheckMode=Nt.kH.Multi,F.isAutoVisualInternal$=new y.X(void 0),F.isSessionDirtyInternal$=new y.X(!1);var de=F.localizationService.get("Suggestions"),ee=F.localizationService.get("Skittles_Build_SuggestLabel"),ce=F.localizationService.get("Skittles_Build_SuggestTooltip");return F.isSessionDirty$=F.isSessionDirtyInternal$.pipe((0,Te.x)(),(0,J.R)(F.onDestroy$)),F.allowReorderFields$=F.isAutoVisualInternal$.pipe((0,se.U)(function(T){return!T}),(0,Te.x)(),(0,J.R)(F.onDestroy$)),F.changes$("visualContainer").pipe((0,J.R)(F.onDestroy$)).subscribe(function(T){T&&(F.originalVisualConfig={singleVisual:(0,ct.d9)(T.config.singleVisual)},F.isAutoVisualInternal$.next((0,A.II)(T)))}),(0,V.aj)([F.changes$("visualContainer"),F.changes$("host"),F.changes$("setFocusAfterInitialization",!0)]).pipe((0,J.R)(F.onDestroy$)).subscribe(function(T){var Q=T[1],x=T[2],I="Pane"===Q;F.autoVisualInputArgs={label:de,autoModeToggleLabel:ee,tooltip:ce,visualContainer:T[0],withPerspectives:F.skittleSettingsService.getAutoVisualWithPerspectives(),setFocusAfterInitialization:x,host:Q,allowSelectVisualTypeWhenNoVisual:!0,noAutoToggleSwitch:I,noSuggestions:I,alwaysExpanded:I}}),F.lazyScoped.get($t.ub).then(function(T){T.startFormattingTutorial("FieldPickerTutorial")}),F}return(0,u.__extends)(n,r),n.prototype.onContentUpdate=function(t){this.contentUpdate.emit(t)},n.prototype.ngOnInit=function(){var t=this;this.withFieldList=null!=this.fieldListOptions&&null!=this.fieldListTreeOptions,this.fieldListSectionExpanded=this.withFieldList,this.fieldWellSectionExpanded=this.expandFieldWellOnInit||!this.withFieldList,null!=this.refreshFieldList$&&this.refreshFieldList$.pipe((0,Te.x)()).pipe((0,J.R)(this.onDestroy$)).subscribe(function(){return t.fieldListTreeService.refresh()}),this.withFieldList&&this.modelService.update([]).then(function(){t.modelService.modelChange$.pipe((0,J.R)(t.onDestroy$)).subscribe(function(i){if(null!=i?.model){var o=1===_.size(i.model.tables);t.fieldListTreeService.modelToPbiTreeConverterOptions=t.fieldListTreeOptions,t.fieldListTreeService.modelToPbiTreeConverterOptions.expandedSetting=new ii(o),t.fieldListTreeService.setOrUpdateFieldListTreeModel(i.model),t.fieldListTree$=t.fieldListTreeService.fieldListTree$}})}),this.skittleSettingsService.getAutoVisualWithPerspectives()&&(this.perspectiveDisplayName=this.getPerspectiveDisplayName()),(0,Y.T)(this.eventBridge.on(M.tRg),this.eventBridge.on(M.KD7),this.eventBridge.on(M.jCS),this.eventBridge.on(M.D1A),this.eventBridge.on(M.Udu)).pipe((0,Re.b)(function(){return t.checkDirtyState()}),(0,J.R)(this.onDestroy$)).subscribe(function(){t.isAutoVisualInternal$.next((0,A.II)(t.visualContainer)),null!=t.fieldListOptions&&t.updateFieldListSelectionState()}),this.expandFieldWellSectionOnInitialChange&&this.eventBridge.on(M.jCS).pipe((0,He.q)(1)).subscribe(function(){var i;!0!==t.fieldWellSectionExpanded&&(t.fieldWellSectionExpanded=!0,t.changeDetectorRef.detectChanges(),document.activeElement.scrollIntoView(!0),t.autoExpandFieldWellSectionActivity=t.contextActivityService.createActivity({name:"Automatically expand field well section",visualName:null===(i=t.visualContainer)||void 0===i?void 0:i.name,data:{closed:null,source:"Skittle",skittleType:"Build"}}))})},n.prototype.ngOnDestroy=function(){var t;!(null===(t=this.autoExpandFieldWellSectionActivity)||void 0===t)&&t.isRunning()&&this.resolveAutoExpandFieldWellSectionActivity("automatically"),r.prototype.ngOnDestroy.call(this)},Object.defineProperty(n.prototype,"exploreUIAuthoringModulePath",{get:function(){return"@powerbi/ExploreUIAuthoring/lazy-modules/explore-ui-authoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},enumerable:!1,configurable:!0}),n.prototype.toggleFieldWellSectionExpansion=function(){var t;!(null===(t=this.autoExpandFieldWellSectionActivity)||void 0===t)&&t.isRunning()&&this.resolveAutoExpandFieldWellSectionActivity("manually"),this.fieldWellSectionExpanded=!this.fieldWellSectionExpanded},n.prototype.discardChanges=function(){var t=this;this.visualContainer.config.singleVisual=(0,ct.d9)(this.originalVisualConfig.singleVisual),this.eventBridge.publishToChannel(M.jCS,{affectContainer:function(o){return o.name===t.visualContainer.name}})},n.prototype.resolveAutoExpandFieldWellSectionActivity=function(t){this.autoExpandFieldWellSectionActivity.updateProperty("data",function(i){return(0,u.__assign)((0,u.__assign)({},i),{closed:t})}),this.autoExpandFieldWellSectionActivity.resolve()},n.prototype.getPerspectiveDisplayName=function(){var t,i,o,l=this.explorationNavigation.getCurrentExploration(),c=l.sections[l.activeSectionIndex];return null===(o=null===(i=null===(t=c?.evaluatedObjects)||void 0===t?void 0:t.personalizeVisual)||void 0===i?void 0:i.perspectiveRef)||void 0===o?void 0:o.toString()},n.prototype.updateFieldListSelectionState=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,i,o,l;return(0,u.__generator)(this,function(c){switch(c.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return t=c.sent(),i=(0,A.oJ)(this.visualContainer),o=this.modelService.model,l=_.flatMapDeep(i,function(d){return o.findItems(d.expr,t)}),this.fieldListTreeService.setOrUpdateFieldListTreeModel(o,void 0,l),[2]}})})},n.prototype.checkDirtyState=function(){var t,i,o,l,c=null===(i=null===(t=this.originalVisualConfig)||void 0===t?void 0:t.singleVisual)||void 0===i?void 0:i.query,d=null===(l=null===(o=this.originalVisualConfig)||void 0===o?void 0:o.singleVisual)||void 0===l?void 0:l.visualType,p=(0,A.Xf)(this.visualContainer),h=(0,Ut.s)(this.visualContainer),C=null==c,L=null==p;if(C&&L)this.isSessionDirtyInternal$.next(!1);else{var G=d!==h||C!==L||!c.equals(p);this.isSessionDirtyInternal$.next(G)}},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(et.i),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject(Ne.D),e.\u0275\u0275directiveInject(Ue.J),e.\u0275\u0275directiveInject(Ht.z),e.\u0275\u0275directiveInject(st.p),e.\u0275\u0275directiveInject(De.H),e.\u0275\u0275directiveInject(Ve.o),e.\u0275\u0275directiveInject(Kt.b),e.\u0275\u0275directiveInject(Me))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-skittle"]],inputs:{fieldListOptions:"fieldListOptions",fieldListTreeOptions:"fieldListTreeOptions",hideVisualPicker:"hideVisualPicker",expandFieldWellSectionOnInitialChange:"expandFieldWellSectionOnInitialChange",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual",setFocusAfterInitialization:"setFocusAfterInitialization",host:"host",refreshFieldList$:"refreshFieldList$",expandFieldWellOnInit:"expandFieldWellOnInit",visualContainer:"visualContainer"},outputs:{contentUpdate:"contentUpdate"},features:[e.\u0275\u0275ProvidersFeature((0,u.__spreadArray)([st.p],jt.r,!0)),e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[1,"buildSkittle",3,"pbiScrollbar"],[1,"visualPicker","compact-visual-types"],[3,"modulePath","componentId","inputArgs",4,"ngIf"],["class","sectionHeader",3,"click",4,"ngIf"],["class","fieldListContainer",4,"ngIf"],[3,"ngClass","visualContainer","perspectiveDisplayName","allowReorderFields","overrideSingleBucketForAutoVisual","contentUpdate",4,"ngIf"],[3,"modulePath","componentId","inputArgs"],[1,"sectionHeader",3,"click"],["localize","Skittles_Build_FieldListSectionTitle"],[1,"glyphicon","glyph-small",3,"ngClass"],[1,"fieldListContainer"],[3,"fieldListTree","checkMode","hasHighlights","loading","options"],["localize","Skittles_Build_FieldWellSectionTitle"],[3,"ngClass","visualContainer","perspectiveDisplayName","allowReorderFields","overrideSingleBucketForAutoVisual","contentUpdate"]],template:function(i,o){1&i&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Gt,1,3,"pbi-lazy-load",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Yt,3,4,"div",3),e.\u0275\u0275template(4,Jt,4,9,"div",4),e.\u0275\u0275template(5,Zt,3,4,"div",3),e.\u0275\u0275template(6,ei,2,9,"build-field-well",5),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275property("pbiScrollbar",e.\u0275\u0275pureFunction0(6,ti)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!o.hideVisualPicker),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList&&o.fieldListSectionExpanded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.withFieldList),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.fieldWellSectionExpanded))},dependencies:[f.NgClass,f.NgIf,Qt.R,Ae.X,Xt.l,lt.r,ot,f.AsyncPipe],styles:['.buildSkittle[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   .fieldListContainer[_ngcontent-%COMP%], .buildSkittle[_ngcontent-%COMP%]   build-field-well[_ngcontent-%COMP%]{padding:0 8px}.buildSkittle[_ngcontent-%COMP%]   .fieldListContainer[_ngcontent-%COMP%]{flex:1;position:relative}.buildSkittle[_ngcontent-%COMP%]   build-field-well[_ngcontent-%COMP%]{flex:1}.buildSkittle[_ngcontent-%COMP%]   build-field-well.with-field-list[_ngcontent-%COMP%]{overflow:auto}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px;border-top:1px solid var(--globalColorGrey90)}.buildSkittle[_ngcontent-%COMP%]   .sectionHeader[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}']}),n}(Oe.w),ii=function(){function r(n){this.hasSingleTable=n}return r.prototype.isExpanded=function(n){return"Hierarchy"===n.modelObjectType||"Table"===n.modelObjectType&&this.hasSingleTable},r.prototype.isExpandedStateFixed=function(n){return"Hierarchy"===n.modelObjectType},r}(),ni=["buildSkittle"],oi=["scrollContainer"],ri=function(){return{ignoreOverlay:!1,ignoreMobile:!1}},dt=function(){function r(n,t,i){this.skittleSettingsService=n,this.localizationService=t,this.flyoutRef=i,this.host="Skittle",this.contentScrollContainerHelper=new at,this.destroy$=new D.xQ,this.allowClearChanges=this.skittleSettingsService.getShowClearChanges(),this.visualContainer=i.visualContainer}return Object.defineProperty(r.prototype,"_scrollContainer",{set:function(t){this.contentScrollContainerHelper.setScrollContainerElementRef(t)},enumerable:!1,configurable:!0}),r.prototype.ngAfterViewInit=function(){var n=this;this.buildSkittleComponent.isSessionDirty$.pipe((0,J.R)(this.destroy$),(0,se.U)(function(t){var i=[];return n.allowClearChanges&&i.push({icon:"eraser",iconSize:"small",tooltip:n.getDiscardChangesTooltipText(t),disabled:!t,click:function(){return n.discardChanges()}}),i})).subscribe(function(t){return n.flyoutRef.setHeaderButtons(t)})},r.prototype.onContentUpdate=function(n){this.contentScrollContainerHelper.onContentUpdate(n)},r.prototype.onContentScroll=function(){this.contentScrollContainerHelper.onContentScroll()},r.prototype.discardChanges=function(){this.buildSkittleComponent.discardChanges()},r.prototype.getDiscardChangesTooltipText=function(n){return this.localizationService.get(n?"PersonalizeVisual_DiscardChanges":"PersonalizeVisual_DiscardChanges_Disabled")},r.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(Me),e.\u0275\u0275directiveInject(Ve.o),e.\u0275\u0275directiveInject(we))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["build-skittle-flyout"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(ni,5),e.\u0275\u0275viewQuery(oi,5)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.buildSkittleComponent=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._scrollContainer=o.first)}},features:[e.\u0275\u0275ProvidersFeature([{provide:Fe.yk,useValue:{source:"Skittle",skittleType:"Build"}}])],decls:4,vars:4,consts:[[1,"scrollContainer",3,"pbiScrollbar","scroll"],["scrollContainer",""],[3,"host","visualContainer","contentUpdate"],["buildSkittle",""]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275listener("scroll",function(){return i.onContentScroll()}),e.\u0275\u0275elementStart(2,"build-skittle",2,3),e.\u0275\u0275listener("contentUpdate",function(l){return i.onContentUpdate(l)}),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275property("pbiScrollbar",e.\u0275\u0275pureFunction0(3,ri)),e.\u0275\u0275advance(2),e.\u0275\u0275property("host",i.host)("visualContainer",i.visualContainer))},dependencies:[lt.r,We],encapsulation:2}),r}(),pt=a(9215),$e=a(21024),Ke=a(72262),ai=a(66977),Qe=a(21023),Xe=a(24548),ft=a(69437),vt=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["build-skittle-watermark"]],inputs:{watermarkText:"watermarkText"},decls:4,vars:1,consts:[[1,"watermark"],["name","PBIBuild_20",1,"watermarkIcon"],[1,"watermarkText"],[3,"localize"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"pbi-office-icon",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275element(3,"span",3),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",i.watermarkText))},dependencies:[Ae.X,ft.m],styles:[".watermark[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.watermarkIcon[_ngcontent-%COMP%]{width:32px;height:32px;padding-bottom:16px}.watermarkText[_ngcontent-%COMP%]{--watermark-text-color: var(--globalColorGrey14);padding-inline-start:24px;padding-inline-end:24px;text-align:center;color:var(--watermark-text-color)}  [data-legacy-theming=false] .watermarkText{--watermark-text-color: var(--colorNeutralForeground1)}"],changeDetection:0}),r}(),li=["allContentScrollContainer"];function si(r,n){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",5),e.\u0275\u0275element(2,"build-skittle-watermark",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&r){var t=n.ngIf;e.\u0275\u0275advance(2),e.\u0275\u0275property("watermarkText",t)}}function ci(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7,8),e.\u0275\u0275listener("scroll",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onContentScroll())}),e.\u0275\u0275elementStart(2,"build-skittle",9),e.\u0275\u0275listener("contentUpdate",function(l){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.onContentUpdate(l))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()()}if(2&r){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("fieldListOptions",i.fieldListOptions)("fieldListTreeOptions",i.fieldListTreeOptions)("visualContainer",e.\u0275\u0275pipeBind1(3,10,i.visualContainer$))("hideVisualPicker",i.hideVisualPicker)("expandFieldWellSectionOnInitialChange",i.expandFieldWellSectionOnInitialChange)("overrideSingleBucketForAutoVisual",i.overrideSingleBucketForAutoVisual)("setFocusAfterInitialization",i.setFocusAfterInitialization)("refreshFieldList$",i.refreshFieldList$)("expandFieldWellOnInit",i.expandFieldWellOnInit)("host",i.host)}}function ui(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section",2),e.\u0275\u0275template(2,si,3,1,"ng-container",3),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,ci,4,12,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()}if(2&r){var c,i=n.ngIf,o=e.\u0275\u0275reference(5),l=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("disableScroll",!0)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",null===(c=l.showCollapse)||void 0===c||c),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,8,l.watermarkText$))("ngIfElse",o)}}var ht=function(r){function n(t,i,o){var l=r.call(this)||this;l.panesVisibilityService=t,l.selectionService=i,l.visualPluginOps=o,l.paneViewModel$=l.panesVisibilityService.getPanes$().pipe((0,se.U)(function(d){return d.build})),l.host="Pane",l.contentScrollContainerHelper=new at;var c=l.selectionService.selectedElements$.pipe((0,se.U)(function(d){if(d)return d.reduce(function(p,h){var C=h.canvasItem;return C&&p.push(C),p},[])}));return l.visualContainer$=c.pipe((0,se.U)(function(d){if(!_.isEmpty(d)){var p=(0,pt.rQ)(d)[0];return 1===p.length?p[0]:void 0}})),l.watermarkText$=c.pipe((0,se.U)(function(d){var p;if(!_.isEmpty(d)){var h=(p=(0,pt.rQ)(d))[0];if(!_.isEmpty(p[1])||h.length>1)return"Build_Pane_Multiple_Visual";var L=h[0],G=l.visualPluginOps.canConvertVisual(L),F=l.visualPluginOps.isQueryVisual(L.config.singleVisual.visualType);if(!G&&!F)return"Build_Pane_NoData_Visual"}})),l}return(0,u.__extends)(n,r),Object.defineProperty(n.prototype,"_allContentScrollContainer",{set:function(i){this.contentScrollContainerHelper.setScrollContainerElementRef(i)},enumerable:!1,configurable:!0}),n.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("build",!1)},n.prototype.onContentUpdate=function(t){this.contentScrollContainerHelper.onContentUpdate(t)},n.prototype.onContentScroll=function(){this.contentScrollContainerHelper.onContentScroll()},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject($e.r),e.\u0275\u0275directiveInject(Ke.z),e.\u0275\u0275directiveInject(ai.f))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["build-skittle-pane"]],viewQuery:function(i,o){var l;(1&i&&e.\u0275\u0275viewQuery(li,5),2&i)&&(e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(o._allContentScrollContainer=l.first))},inputs:{fieldListOptions:"fieldListOptions",fieldListTreeOptions:"fieldListTreeOptions",hideVisualPicker:"hideVisualPicker",expandFieldWellSectionOnInitialChange:"expandFieldWellSectionOnInitialChange",overrideSingleBucketForAutoVisual:"overrideSingleBucketForAutoVisual",setFocusAfterInitialization:"setFocusAfterInitialization",refreshFieldList$:"refreshFieldList$",expandFieldWellOnInit:"expandFieldWellOnInit",showCollapse:"showCollapse"},features:[e.\u0275\u0275ProvidersFeature([{provide:Fe.yk,useValue:{source:"Pane",paneType:"build"}}]),e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","buildSkittlePane",3,"expanded","title","disableScroll","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[1,"buildSkittlePane",3,"expanded","title","disableScroll","allowToggle","optionsSetting","showCollapse","onCollapse"],[1,"no-padding"],[4,"ngIf","ngIfElse"],["skittles",""],[1,"watermarkContainer"],[3,"watermarkText"],[1,"paneContentScrollContainer",3,"scroll"],["allContentScrollContainer",""],[3,"fieldListOptions","fieldListTreeOptions","visualContainer","hideVisualPicker","expandFieldWellSectionOnInitialChange","overrideSingleBucketForAutoVisual","setFocusAfterInitialization","refreshFieldList$","expandFieldWellOnInit","host","contentUpdate"]],template:function(i,o){1&i&&(e.\u0275\u0275template(0,ui,6,10,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&i&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,o.paneViewModel$))},dependencies:[f.NgIf,Qe.VO,Xe.i,We,vt,f.AsyncPipe],styles:[".buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]{height:100%}.buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]   .paneContentScrollContainer[_ngcontent-%COMP%]{height:100%;overflow:auto}.buildSkittlePane[_ngcontent-%COMP%]   pbi-pane-section[_ngcontent-%COMP%]   .watermarkContainer[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}"]}),n}(Oe.w),di=a(90094),pi=a(56011),Ge=a(85102),fi=["checkboxElement"];function vi(r,n){1&r&&e.\u0275\u0275element(0,"warning-eager",11),2&r&&e.\u0275\u0275property("warningMessage",n.ngIf)}function hi(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7)(1,"pbi-checkbox",8,9),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext().$implicit,d=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(d.updateFormatOption(c))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,vi,1,1,"warning-eager",10),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()}if(2&r){var o,i=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("checked",i.checked)("label",i.displayName)("isCompact",!0)("ariaDescription",i.warningMessage$?null==(o=e.\u0275\u0275pipeBind1(3,6,i.warningMessage$))?null:o.detail:void 0),e.\u0275\u0275attribute("id",i.uid),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(5,8,i.warningMessage$))}}function gi(r,n){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,hi,6,10,"div",6),e.\u0275\u0275elementContainerEnd()),2&r){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.disabled)}}function mi(r,n){if(1&r&&(e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275template(1,gi,2,1,"ng-container",5),e.\u0275\u0275elementEnd()),2&r){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.items)}}function yi(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,mi,2,1,"div",2),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.openFormatPane())}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&r){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,3,i.formatState$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","Options_Menu")("pbiTooltip",e.\u0275\u0275pipeBind1(4,5,"Options_Menu"))}}var Ye=function(r){function n(t,i,o,l){var c=r.call(this)||this;return c.changeDetector=t,c.lazyScoped=i,c.panesVisibility=o,c.selectionService=l,c.isInitialized$=new y.X(!1),c}return(0,u.__extends)(n,r),Object.defineProperty(n.prototype,"_checkboxElementRefs",{set:function(i){var o,l;if(this.checkboxElements=[],i){var c=i.toArray();if(this.checkboxElements=c.map(function(C){return C.nativeElement}),!_.isEmpty(this.restoreFocusElementId))for(var d=0,p=c;d<p.length;d++){var h=p[d];if(h.nativeElement.id===this.restoreFocusElementId)return void(null===(l=null===(o=h.nativeElement.getElementsByTagName("INPUT"))||void 0===o?void 0:o[0])||void 0===l||l.focus())}}},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var t=this,i=_.compact(this.selectionService.getSelectedElements().map(function(l){return l.canvasItem})),o=_.first(i);this.lazyScoped.get("formattingService").then(function(l){t.formattingService=l;var c=t.formattingService.getFor({type:0,canvasItem:o});t.formatState$=c.getChartElementsContract$().pipe((0,Re.b)(function(d){var p=document.activeElement;if("INPUT"===document.activeElement.tagName){var h=_.find(t.checkboxElements,function(C){return C.contains(p)});t.restoreFocusElementId=h?.id}})),t.changeDetector.detectChanges(),t.isInitialized$.next(!0)})},n.prototype.updateFormatOption=function(t){var i;t.checked=!t.checked;var o=null===(i=_.first(this.selectionService.getSelectedElements()))||void 0===i?void 0:i.canvasItem;this.formattingService.saveValues({changes:[{objectName:t.descriptor.objectName,uid:t.uid,hasDynamicExpressionSupport:!1,formattingSource:t.formattingSource,propertySlice:{name:t.descriptor.propertyName,selector:t.descriptor.selector,type:{bool:!0},value:t.checked},canvasItems:[o],visualUpdateSource:0}]},{source:"Skittle",skittleType:"ChartElements"}),this.changeDetector.detectChanges()},n.prototype.openFormatPane=function(){this.panesVisibility.isPaneVisible("format")&&!this.panesVisibility.isPaneExpanded("format")?this.panesVisibility.togglePaneExpansion("format"):this.panesVisibility.isPaneVisible("format")?this.panesVisibility.emphasizePane("format"):this.panesVisibility.togglePaneVisibility("format"),this.panesVisibility.setFocusedPane("format")},n.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(De.H),e.\u0275\u0275directiveInject($e.r),e.\u0275\u0275directiveInject(Ke.z))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["chart-elements-skittle"]],viewQuery:function(i,o){var l;(1&i&&e.\u0275\u0275viewQuery(fi,5,e.ElementRef),2&i)&&(e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(o._checkboxElementRefs=l))},features:[e.\u0275\u0275ProvidersFeature([{provide:Fe.yk,useValue:{source:"Skittle",skittleType:"ChartElements"}}]),e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","chartElementsSkittle",4,"ngIf"],[1,"chartElementsSkittle"],["class","options",4,"ngIf"],[1,"pbi-fluent-button","moreOptionsButton",3,"localize","pbiTooltip","click"],[1,"options"],[4,"ngFor","ngForOf"],["class","item-container",4,"ngIf"],[1,"item-container"],[3,"checked","label","isCompact","ariaDescription","onChange"],["checkboxElement",""],["class","warning",3,"warningMessage",4,"ngIf"],[1,"warning",3,"warningMessage"]],template:function(i,o){1&i&&(e.\u0275\u0275template(0,yi,5,7,"div",0),e.\u0275\u0275pipe(1,"async")),2&i&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,o.isInitialized$))},dependencies:[f.NgForOf,f.NgIf,Ae.X,di.l,pi.v,v.V,f.AsyncPipe,Ge.F],styles:['.chartElementsSkittle[_ngcontent-%COMP%]{padding:4px 8px 0}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-direction:column}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;margin-bottom:6px}.chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{width:fit-content;margin:2px 0}html:not([dir="rtl"])[_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-left:auto}html[dir="rtl"][_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .chartElementsSkittle[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .item-container[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin-right:auto}.chartElementsSkittle[_ngcontent-%COMP%]   .moreOptionsButton[_ngcontent-%COMP%]{margin-top:6px;padding:6px 16px;border:1px solid var(--gray-110, #8A8886);max-width:100%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}'],changeDetection:0}),n}(Oe.w),gt=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["chart-elements-skittle-flyout"]],decls:1,vars:0,template:function(t,i){1&t&&e.\u0275\u0275element(0,"chart-elements-skittle")},dependencies:[Ye],encapsulation:2,changeDetection:0}),r}();function Ci(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section"),e.\u0275\u0275element(2,"chart-elements-skittle"),e.\u0275\u0275elementEnd()()}if(2&r){var i=n.ngIf;e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",!0)}}var mt=function(){function r(n){this.panesVisibilityService=n,this.paneViewModel$=this.panesVisibilityService.getPanes$().pipe((0,se.U)(function(t){return t.chartElementsSkittle}))}return r.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("chartElementsSkittle",!1)},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject($e.r))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["chart-elements-skittle-pane"]],decls:2,vars:3,consts:[[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Ci,3,5,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[f.NgIf,Qe.VO,Xe.i,Ye,f.AsyncPipe],encapsulation:2,changeDetection:0}),r}();function _i(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pane",1),e.\u0275\u0275listener("onCollapse",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onPaneCollapsed())}),e.\u0275\u0275elementStart(1,"pbi-pane-section",2),e.\u0275\u0275element(2,"build-skittle",3),e.\u0275\u0275elementEnd()()}if(2&r){var i=n.ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",i.isPaneExpanded)("title",i.title)("allowToggle",!1)("optionsSetting",i.optionsSetting)("showCollapse",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("host",o.host)}}var yt=function(){function r(n){this.panesVisibilityService=n,this.host="Skittle",this.paneViewModel$=this.panesVisibilityService.getPanes$().pipe((0,se.U)(function(t){return t.suggestSkittle}))}return r.prototype.onPaneCollapsed=function(){this.panesVisibilityService.setPaneExpansion("suggestSkittle",!1)},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject($e.r))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["suggest-skittle-pane"]],features:[e.\u0275\u0275ProvidersFeature([{provide:Fe.yk,useValue:{source:"Pane",paneType:"suggestSkittle"}}])],decls:2,vars:3,consts:[[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse",4,"ngIf"],[3,"expanded","title","allowToggle","optionsSetting","showCollapse","onCollapse"],[1,"no-padding"],[3,"host"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,_i,3,6,"pbi-pane",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[f.NgIf,Qe.VO,Xe.i,We,f.AsyncPipe],encapsulation:2,changeDetection:0}),r}(),Ie=a(25512),Ct=a(76072),Si=a(83309),bi=["flyout"],Fi=["container"];function xi(r,n){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"h2",8),e.\u0275\u0275elementContainerEnd()),2&r){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",t)}}function Pi(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",10),e.\u0275\u0275listener("click",function(l){var c=e.\u0275\u0275restoreView(t);return e.\u0275\u0275resetView(c.$implicit.click(l))}),e.\u0275\u0275elementEnd()}if(2&r){var i=n.$implicit;e.\u0275\u0275classMapInterpolate2("glyphicon glyph-",i.iconSize," pbi-glyph-",i.icon,""),e.\u0275\u0275property("pbiTooltip",i.tooltip)}}function Ei(r,n){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Pi,1,5,"button",9),e.\u0275\u0275elementContainerEnd()),2&r){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function ki(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onClose())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}2&r&&e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,1,"Close"))}var Oi=function(){function r(n,t,i,o,l,c){this.injector=n,this.lazyProvider=t,this.localizationService=i,this.screenReaderService=o,this.flyoutRef=l,this.data=c,this.destroy$=new D.xQ}return r.prototype.ngOnInit=function(){var n=this;this.flyoutRef.title$.pipe((0,J.R)(this.destroy$)).subscribe(function(t){if(t){var i="".concat(n.localizationService.get(t)," ").concat(n.localizationService.get("Slicer_Menu"));n.screenReaderService.alert(i)}})},r.prototype.ngAfterViewInit=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){var n;return(0,u.__generator)(this,function(i){switch(i.label){case 0:return[4,this.lazyProvider.getModule("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule")];case 1:return n=i.sent(),this.container.createComponent(this.data.skittleContentComponent,{injector:this.injector,ngModuleRef:n}).changeDetectorRef.detectChanges(),[2]}})})},r.prototype.ngOnDestroy=function(){this.container.clear(),this.destroy$.next(),this.destroy$.complete()},r.prototype.onClose=function(){this.data.toggleSkittle(this.flyoutRef.type)},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Ct.E),e.\u0275\u0275directiveInject(Ve.o),e.\u0275\u0275directiveInject(Si.g),e.\u0275\u0275directiveInject(we),e.\u0275\u0275directiveInject(ze.M))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["skittle-flyout"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(bi,5),e.\u0275\u0275viewQuery(Fi,5,e.ViewContainerRef)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.flyoutElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.container=o.first)}},decls:13,vars:10,consts:[["role","menu","aria-labelledby","skittleTitle",1,"skittleFlyout"],["flyout",""],[1,"header"],[4,"ngIf"],[1,"buttonContainer"],["class","glyphicon glyph-mini pbi-glyph-close","aria-label","Close",3,"pbiTooltip","click",4,"ngIf"],["role","menuitem",1,"allContent"],["container",""],["id","skittleTitle",1,"title",3,"localize"],["pbiTooltipCaretSize","small",3,"class","pbiTooltip","click",4,"ngFor","ngForOf"],["pbiTooltipCaretSize","small",3,"pbiTooltip","click"],["aria-label","Close",1,"glyphicon","glyph-mini","pbi-glyph-close",3,"pbiTooltip","click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2),e.\u0275\u0275template(3,xi,2,1,"ng-container",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275template(6,Ei,2,1,"ng-container",3),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,ki,2,3,"button",5),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div",6),e.\u0275\u0275elementContainer(11,null,7),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275attribute("aria-expanded",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(4,4,i.flyoutRef.title$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,6,i.flyoutRef.headerButtons$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,8,i.flyoutRef.showCloseButton$)))},dependencies:[f.NgForOf,f.NgIf,Ae.X,v.V,f.AsyncPipe,Ge.F],styles:['[_nghost-%COMP%]{--caret-background-color: var(--fluent-theme-neutral-lighter-color, #F3F2F1);--caret-border-color: var(--gray-70, #BEBBB8);--skittle-flyout-border-color: var(--gray-70, #BEBBB8);--skittle-flyout-background-color: var(--fluent-theme-neutral-lighter-color, #F3F2F1);background-color:var(--skittle-flyout-background-color);border:1px solid var(--skittle-flyout-border-color);border-radius:2px;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 2px 4px var(--colorNeutralShadowKey);box-sizing:border-box;padding:8px 0;width:100%}[data-legacy-theming=false]   [_nghost-%COMP%]{--caret-background-color: var(--colorNeutralBackground3);--caret-border-color: var(--colorNeutralStroke1Selected);--skittle-flyout-border-color: var(--colorNeutralStroke1Selected);--skittle-flyout-background-color: var(--colorNeutralBackground3)}.pbi-overlay-caret.themeableElement[_nghost-%COMP%]:before, .pbi-overlay-caret.themeableElement[_nghost-%COMP%]:after{background:var(--caret-background-color);border:1px solid var(--caret-border-color)}.skittleFlyout[_ngcontent-%COMP%]{--skittle-flyout-button-color: var(--gray-190, #201F1E);display:flex;flex-direction:column;position:relative;height:100%;width:100%;z-index:1;color:var(--colorNeutralForeground1)}  [data-legacy-theming=false] .skittleFlyout{--skittle-flyout-button-color: var(--colorNeutralForeground1)}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 8px 12px}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);margin:0;flex-grow:1}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]{display:flex;align-items:center}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0;border:0;background:transparent;margin-left:8px;color:var(--skittle-flyout-button-color)}.skittleFlyout[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .buttonContainer[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.5}.skittleFlyout[_ngcontent-%COMP%]   .allContent[_ngcontent-%COMP%]{flex:1;margin:0;overflow-x:hidden;overflow-y:overlay}@media print{[_nghost-%COMP%]{display:none!important}}'],changeDetection:0}),r}(),Ii=a(88819),_t=a(86940),wi=a(10675),Mi=["container"],Ti=function(){function r(n,t,i){this.injector=n,this.lazyProvider=t,this.flyoutRef=i,this.destroy$=new D.xQ}return r.prototype.ngOnDestroy=function(){this.container.clear(),this.destroy$.next(),this.destroy$.complete()},r.prototype.ngAfterViewInit=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){var n;return(0,u.__generator)(this,function(i){switch(i.label){case 0:return[4,this.lazyProvider.getModule("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule")];case 1:return n=i.sent(),this.container.createComponent(this.flyoutRef.config.component,{injector:this.injector,ngModuleRef:n}).changeDetectorRef.detectChanges(),[2]}})})},r.prototype.setNewHorizontalFlyoutSize=function(n){n.cancel||this.flyoutRef.updateWidth(n.newSize)},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Ct.E),e.\u0275\u0275directiveInject(we))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["flyout"]],viewQuery:function(t,i){var o;(1&t&&e.\u0275\u0275viewQuery(Mi,5,e.ViewContainerRef),2&t)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i.container=o.first))},decls:3,vars:3,consts:[[3,"dock","enabled","disableElementSizing","onResize"],["container",""]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"resizer",0),e.\u0275\u0275listener("onResize",function(l){return i.setNewHorizontalFlyoutSize(l)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainer(1,null,1)),2&t&&e.\u0275\u0275property("dock",i.flyoutRef.horizontalSide)("enabled",!0)("disableElementSizing",!0)},dependencies:[wi.d],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;min-height:100%;min-width:100%}.pbi-overlay-caret.themeableElement[_nghost-%COMP%]:before, .pbi-overlay-caret.themeableElement[_nghost-%COMP%]:after{background:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border:1px solid var(--gray-70, #BEBBB8)}[_nghost-%COMP%] >*{display:block}@media print{[_nghost-%COMP%]{display:none!important}}"],changeDetection:0}),r}(),Li=function(){function r(n,t,i){void 0===i&&(i=0),this.skittleSettingsService=t,this.level=i,this.currentLayout=_.first(n),this.childLayouts=n.slice(1)}return r.prototype.createFlyoutConfig=function(n){var t,i,o,l=n.providers;this.childLayouts.length>0&&(l||(l=new WeakMap),l.set(Ii.l,new r(this.childLayouts,this.skittleSettingsService,this.level+1)));var c=null===(t=n.options)||void 0===t?void 0:t.width,d=this.skittleSettingsService.getDimensions(this.level);return d?.width&&(c=this.minMaxDimension(d.width,null===(i=n.options)||void 0===i?void 0:i.minWidth,null===(o=n.options)||void 0===o?void 0:o.maxWidth)),(0,u.__assign)((0,u.__assign)({},n),{options:(0,u.__assign)((0,u.__assign)({},n.options),{width:c}),providers:l,horizontalLayout:this.currentLayout.horizontalLayout,horizontalSide:this.currentLayout.horizontalSide,verticalLayout:this.currentLayout.verticalLayout})},r.prototype.monitorFlyoutDimensions=function(n){var t=this;n.flyoutWidth$.pipe((0,J.R)(n.onClose)).subscribe(function(i){var o=t.skittleSettingsService.getDimensions(t.level);i!==o?.width&&t.skittleSettingsService.setDimensions(t.level,{width:i})})},r.prototype.create=function(n,t){var i=this.createFlyoutConfig(n),o=new we(i,t);return this.monitorFlyoutDimensions(o),o},r.prototype.createComponentPortal=function(n){return _t._.createComponentPortal((0,u.__assign)((0,u.__assign)({},n),{component:Ti}))},r.prototype.minMaxDimension=function(n,t,i){return(null==t||"string"==typeof t)&&(t=0),(null==i||"string"==typeof i)&&(i=Number.MAX_SAFE_INTEGER),Math.max(t,Math.min(n,i))},r}(),Bi=function(r){function n(t,i){var o=r.call(this,t,i)||this;o.overlayRef=i,o.titleSubject$=new y.X(null),o.title$=o.titleSubject$.asObservable(),o.showCloseButtonSubject$=new y.X(!1),o.showCloseButton$=o.showCloseButtonSubject$.asObservable(),o.headerButtonsSubject$=new y.X([]),o.headerButtons$=o.headerButtonsSubject$.asObservable(),o.config.providers.set(n,o);var l=o.config.data;return o.type=l.type,o.visualContainer=l.visualContainer,o.setTitle(l.title),o.setShowCloseButton(l.showCloseButton),o}return(0,u.__extends)(n,r),n.prototype.setTitle=function(t){this.titleSubject$.next(t)},n.prototype.setHeaderButtons=function(t){this.headerButtonsSubject$.next(t)},n.prototype.setShowCloseButton=function(t){this.showCloseButtonSubject$.next(t)},n}(we),Di=function(r){function n(t,i){return r.call(this,t,i)||this}return(0,u.__extends)(n,r),n.prototype.create=function(t,i){var o=this.createFlyoutConfig(t),l=new Bi(o,i);return this.monitorFlyoutDimensions(l),l},n}(Li),St=function(){function r(n,t){this.overlay=n,this.skittleSettingsService=t,this.destroy$=new D.xQ}return r.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},r.prototype.isFlyoutOpen=function(){return void 0!==this.skittleFlyoutRef},r.prototype.isFlyoutOfTypeOpen=function(n){var t;return(null===(t=this.skittleFlyoutRef)||void 0===t?void 0:t.type)===n},r.prototype.showFlyout=function(n,t){var i=this;P.fF.assertNonEmpty(t.flyoutLayouts,"Flyout layouts cannot be empty. Please provide at least 2 layouts.");var o=t.elementRef,l=t.flyoutLayouts,c=t.focusElementOnClose,d=t.disableAutoFocus,p=t.injector,h=t.minWidth,C=t.parent,G=t.position;if(C){var de=C.overlayRef.getConfig().positionStrategy,T=this.overlay.position(C.overlayContainer).getPositionStrategyAdapter(de).getPosition();"start"===T.overlayX?G=this.getPositions(!1):"end"===T.overlayX&&(G=this.getPositions(!0))}var re=this.getPositionStrategy(o,G,C?.overlayContainer),Q=new Di(l,this.skittleSettingsService),x={component:Oi,data:n,options:{positionStrategy:re,scrollStrategy:this.overlay.scrollStrategies.reposition(),hasBackdrop:!1,disposeOnNavigation:!0,minWidth:h},caretSize:1,hasCaret:!0,useCaretOffsets:!1,closeOnBackdropClick:!1,disableCloseOnEsc:!1,disableFocusTrapSetting:{disable:!1,disableAutoFocus:d??!1},focusElementOnClose:c,injector:p,parent:C,closeWithParent:!0},I=this.overlay.openWithFactory(x,Q);I.onClose.subscribe(function(){i.skittleFlyoutRef=void 0}),this.skittleFlyoutRef=I},r.prototype.closeFlyout=function(){this.skittleFlyoutRef&&this.skittleFlyoutRef.close()},r.prototype.getPositionStrategy=function(n,t,i){return this.overlay.position(i).withinOverlayContainer(n).withPositions(t).withMaxiumumVisibility(!0)},r.prototype.getPositions=function(n){var t=n?0:1,i=n?1:0;return[(0,Ie.Zz)(xe.Lc.marginHorizontal,void 0,t),(0,Ie.v3)(xe.Lc.marginHorizontal,void 0,t),(0,Ie.J7)(xe.Lc.marginHorizontal,void 0,t),(0,Ie.Iz)(-xe.Lc.marginHorizontal,void 0,i),(0,Ie.q6)(-xe.Lc.marginHorizontal,void 0,i),(0,Ie.Kb)(-xe.Lc.marginHorizontal,void 0,i)]},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275inject(_t._),e.\u0275\u0275inject(Me))},r.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),bt=a(14002),Vi=a(21728),zi=a(76312),Ri=a(65302),Je=a(98727),Ai=a(11547);function $i(r){return null!=r.get(11)}var ji=["buildSkittle"],Ni=["chartElementsSkittle"],Ui=["buildSkittleMask"],Hi=function(n){return{selected:n}};function Ki(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275listener("keydown",function(c){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(d.onKeydown(c,"Build"))})("click",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.toggleBuildSkittle())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"pbi-office-icon",6)(5,"div",7,8),e.\u0275\u0275elementEnd()}if(2&r){var i=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",i.width+"px")("height",i.height+"px"),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(13,Hi,"Build"===o.skittlesService.lastOpenSkittleType))("pbiTooltip",e.\u0275\u0275pipeBind1(2,9,"VisualContainer_Skittle_Tooltip_Build"))("pbiTooltipPosition",o.tooltipPosition),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,11,"VisualContainer_Skittle_Tooltip_Build"))("aria-haspopup","menu")}}var Qi=function(n,t){return{selected:n,disabled:t}};function Xi(r,n){if(1&r){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",10,11),e.\u0275\u0275listener("keydown",function(d){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.onKeydown(d,"ChartElements"))})("click",function(){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext().ngIf,p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(!(null!=d.disabledState&&d.disabledState.disabled)&&p.toggleChartElementsSkittle())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"pbi-office-icon",12),e.\u0275\u0275elementEnd()}if(2&r){var i=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",o.width+"px")("height",o.height+"px"),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(15,Qi,"ChartElements"===l.skittlesService.lastOpenSkittleType,null==i.disabledState?null:i.disabledState.disabled))("pbiTooltip",e.\u0275\u0275pipeBind1(2,11,i.tooltip))("pbiTooltipDisabled",!1)("pbiTooltipPosition",l.tooltipPosition),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,13,i.tooltip))("aria-disabled",null==i.disabledState?null:i.disabledState.disabled)("aria-haspopup","menu")}}function Gi(r,n){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Xi,5,18,"button",9),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,t.chartElementsVisible$))}}var Yi=function(n,t){return{disabledState:n,tooltip:t}};function Ji(r,n){if(1&r&&(e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,Ki,7,15,"button",2),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Gi,3,3,"ng-container",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()),2&r){var t=n.ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("row-gap",t.betweenMargin+"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,4,i.buildVisible$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction2(10,Yi,e.\u0275\u0275pipeBind1(4,6,i.chartElementsDisabledState$),e.\u0275\u0275pipeBind1(5,8,i.chartElementsTooltip$)))}}var Ft=function(){function r(n,t,i,o,l,c,d,p,h,C,L,G,F,de){var ce,T,ee=this;this.skittleSettingsService=n,this.changeDetection=t,this.dataSources=i,this.eventBridge=o,this.hostOverlayRef=l,this.injector=c,this.lazyScopedProviderModern=d,this.runningVisualService=p,this.selectionService=h,this.skittleFlyoutService=C,this.visualAuthoring=L,this.skittlesData=G,this.contextActivityService=F,this.visibilityService=de,this.destroy$=new D.xQ,this.buildSkittleElementRef$=new y.X(void 0),this.chartElementsSkittleElementRef$=new y.X(void 0),this.buildSkittleMaskElementRef$=new y.X(void 0),this.visualContainer=this.skittlesData.visualContainer,P.fF.assertValue(this.visualContainer,"Expect this.skittlesData.visualContainer to be defined"),this.buildVisible$=this.skittlesData.supportedSkittleTypes$.pipe((0,se.U)(function(I){return _.some(I,function(ae){return"Build"===ae.type})}),(0,Re.b)(function(I){!I&&ee.isFlyoutOfTypeOpen("Build")&&ee.skittleFlyoutService.closeFlyout()}),(0,Te.x)());var re=this.skittlesData.supportedSkittleTypes$.pipe((0,se.U)(function(I){return _.some(I,function(ae){return"ChartElements"===ae.type})})),Q=null===(ce=this.runningVisualService.getVisual(this.visualContainer))||void 0===ce?void 0:ce.getErrorInfo(),x=new y.X(!!Q);this.eventBridge.on(M.uB4).pipe((0,J.R)(this.destroy$)).subscribe(function(){var I;P.fF.assertValue(x,"Expect visualHasError$ to be defined");var ae=null===(I=ee.runningVisualService.getVisual(ee.visualContainer))||void 0===I?void 0:I.getErrorInfo();x.next(!!ae)}),this.chartElementsVisible$=(0,V.aj)([re,x]).pipe((0,se.U)(function(I){return I[0]&&!I[1]}),(0,Re.b)(function(I){!I&&ee.isFlyoutOfTypeOpen("ChartElements")&&ee.skittleFlyoutService.closeFlyout()}),(0,Te.x)()),this.chartElementsDisabledState$=this.skittlesData.supportedSkittleTypes$.pipe((0,se.U)(function(I){var ae;return null===(ae=_.find(I,function(ve){return"ChartElements"===ve.type}))||void 0===ae?void 0:ae.disabled$}),(0,U.w)(function(I){return I??(0,Ai.of)(void 0)})),this.chartElementsTooltip$=null===(T=this.chartElementsDisabledState$)||void 0===T?void 0:T.pipe((0,se.U)(function(I){if(null!=I)return I?.disabled?I.disabledReasonKey:"VisualContainer_Skittle_Tooltip_ChartElement"}),(0,J.R)(this.destroy$))}return Object.defineProperty(r.prototype,"_buildSkittleElement",{set:function(t){var i=this;this.buildSkittleElementRef$.next(t),t?.nativeElement&&this.skittlesData.showBuildFlyout$.pipe((0,W.h)(function(o){return null!==o}),(0,J.R)(this.destroy$)).subscribe(function(){setTimeout(function(){i.isFlyoutOfTypeOpen("Build")||i.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay)})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_chartElementsSkittleElement",{set:function(t){this.chartElementsSkittleElementRef$.next(t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_buildSkittleMaskElement",{set:function(t){this.buildSkittleMaskElementRef$.next(t),t?.nativeElement&&this.setupBuildSkittleDragHandler(t.nativeElement)},enumerable:!1,configurable:!0}),r.prototype.ngOnInit=function(){var n=this;this.lazyScopedProviderModern.get("visualContainerSkittlesService").then(function(t){n.skittlesService=t,n.skittlesStyle$=n.skittlesService.skittlesPosition$.pipe((0,W.h)(function(o){return null!=o&&o.container===n.visualContainer}),(0,se.U)(function(o){return{height:o.positions.skittleButtons.buttonHeight,width:o.positions.skittleButtons.buttonWidth,betweenMargin:o.positions.skittleButtons.betweenButtonMargin}})),n.skittlesService.skittlesPosition$.pipe((0,W.h)(function(o){return null!=o&&o.container===n.visualContainer}),(0,J.R)(n.destroy$)).subscribe(function(o){n.skittlePosition=o.positions,n.tooltipPosition=n.skittlePosition.skittleButtons.tooltipPosition}),n.changeDetection.detectChanges();var i=n.skittlesData.withActiveSkittle;null!=i&&n.skittlesData.supportedSkittleTypes$.pipe((0,He.q)(1)).subscribe(function(o){n.skittlePosition&&_.some(o,function(c){return c.type===i})&&(n.initialFlyoutOpenSkittleType$=new y.X(i),(0,V.aj)([n.initialFlyoutOpenSkittleType$,"Build"===i?n.buildSkittleElementRef$:n.chartElementsSkittleElementRef$]).pipe((0,W.h)(function(c){return null!=c[0]&&null!=c[1]}),(0,He.q)(1)).subscribe(function(c){n.toggleSkittle(c[0],n.skittlesData.skipActiveSkittleFlyoutAutoFocus)}))})}),this.eventBridge.on(M.tRg).pipe((0,J.R)(this.destroy$)).subscribe(function(){if(n.skittleFlyoutService.isFlyoutOpen()){var t=n.selectionService.getSelectedElements();1===_.size(t)&&!_.isEmpty(t[0].subSelections)&&(n.skittlesService.lastOpenSkittleType=void 0,n.skittleFlyoutService.closeFlyout())}})},r.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},r.prototype.toggleBuildSkittle=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(n){switch(n.label){case 0:return[4,this.toggleSkittle("Build")];case 1:return n.sent(),[2]}})})},r.prototype.toggleChartElementsSkittle=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(n){switch(n.label){case 0:return[4,this.toggleSkittle("ChartElements")];case 1:return n.sent(),[2]}})})},r.prototype.onKeydown=function(n,t){return(0,u.__awaiter)(this,void 0,void 0,function(){var i;return(0,u.__generator)(this,function(o){switch(n.key){case"ArrowDown":"Build"===t&&(i=this.chartElementsSkittleElementRef$.value.nativeElement);break;case"ArrowUp":"ChartElements"===t&&(i=this.buildSkittleElementRef$.value.nativeElement)}return i&&Ri.IK.focus(i),[2]})})},r.prototype.toggleSkittle=function(n,t){return void 0===t&&(t=!1),(0,u.__awaiter)(this,void 0,void 0,function(){var i,o,l;return(0,u.__generator)(this,function(c){switch(c.label){case 0:i=function(r,n,t,i){var o,l=null===(o=_.first(i.getSelectedElements()))||void 0===o?void 0:o.canvasItem.name;return n.createActivity({name:"OpenSkittle",visualName:l,data:{skittleType:r,source:$i(t)?"InFocus":"Skittle"}})}(n,this.contextActivityService,this.visibilityService,this.selectionService),c.label=1;case 1:return c.trys.push([1,5,,6]),o=this.isFlyoutOfTypeOpen(n),this.skittleFlyoutService.closeFlyout(),o?[3,3]:[4,this.showFlyoutOfType(n,t)];case 2:return c.sent(),this.skittlesService.lastOpenSkittleType=n,[3,4];case 3:this.skittlesService.lastOpenSkittleType=void 0,c.label=4;case 4:return this.changeDetection.detectChanges(),i.resolve(),[3,6];case 5:throw l=c.sent(),i.reject(l),l;case 6:return[2]}})})},r.prototype.showFlyoutOfType=function(n,t){var i,o=this;void 0===t&&(t=!1),P.fF.assertValue(this.skittlePosition,"expecting skittles to be open to show the flyout");var l=(i=this.getSkittleFlyoutProperties(n)).title,c=i.component,d=i.flyoutPosition,p=i.elementRef;P.fF.assertValue(p,"expecting skittle of type ".concat(n," exists")),this.ensureSubselectionClosed(),"Build"===n&&(this.skittleSettingsService.setAutoVisualWithPerspectives(this.skittlesData.fromPersonalize),this.skittleSettingsService.setShowClearChanges(this.skittlesData.fromPersonalize)),this.skittleFlyoutService.showFlyout({skittleContentComponent:c,toggleSkittle:function(re){return o.toggleSkittle(re)},title:l,type:n,showCloseButton:!0,visualContainer:this.visualContainer},{flyoutLayouts:[{horizontalLayout:this.skittlePosition.horizontalLayout.firstLevelFlyout,verticalLayout:this.skittlePosition.verticalLayout.firstLevelFlyout,horizontalSide:"Left"===this.skittlePosition.horizontalLayout.firstLevelFlyout.alignment?"left":"right"},{horizontalLayout:this.skittlePosition.horizontalLayout.secondLevelFlyout,verticalLayout:this.skittlePosition.verticalLayout.secondLevelFlyout,horizontalSide:"Left"===this.skittlePosition.horizontalLayout.secondLevelFlyout.alignment?"left":"right"}],elementRef:p,focusElementOnClose:p.nativeElement,disableAutoFocus:t,injector:this.injector,parent:this.hostOverlayRef,position:d.position,height:d.height,maxHeight:d.maxHeight,width:d.width,minWidth:d.minWidth,maxWidth:d.maxWidth})},r.prototype.getSkittleFlyoutProperties=function(n){switch(n){case"Build":return{title:"Suggest_A_Visual",flyoutPosition:(0,bt.m)(this.skittlePosition.horizontalLayout.firstLevelFlyout,this.skittlePosition.verticalLayout.firstLevelFlyout,(t=this.buildSkittleElementRef$.value).nativeElement),elementRef:t,component:dt};case"ChartElements":var t;return{title:"Skittles_ChartElements_Title",flyoutPosition:(0,bt.m)(this.skittlePosition.horizontalLayout.firstLevelFlyout,this.skittlePosition.verticalLayout.firstLevelFlyout,(t=this.chartElementsSkittleElementRef$.value).nativeElement),elementRef:this.chartElementsSkittleElementRef$.value,component:gt};default:P.fF.assertNever(n)}},r.prototype.isFlyoutOfTypeOpen=function(n){return this.skittleFlyoutService.isFlyoutOfTypeOpen&&this.skittleFlyoutService.isFlyoutOfTypeOpen(n)},r.prototype.ensureSubselectionClosed=function(){Vi.UP.selectSubSelection(this.selectionService,this.visualContainer,[],0)},r.prototype.setupBuildSkittleDragHandler=function(n){var i,t=this;n.addEventListener("dragenter",function(){i=setTimeout(function(){t.isFlyoutOfTypeOpen("Build")||t.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay)}),n.addEventListener("dragleave",function(){clearTimeout(i)}),(0,zi.$o)(n,function(o,l){return(0,u.__awaiter)(t,void 0,void 0,function(){var d=this;return(0,u.__generator)(this,function(p){switch(p.label){case 0:return[4,this.visualAuthoring.addFieldToVisual(l,this.dataSources.get(),this.visualContainer,"DraggedToVisual")];case 1:return p.sent()&&setTimeout(function(){d.isFlyoutOfTypeOpen("Build")||d.showFlyoutOfType("Build")},Je.sM.DefaultShowDelay),[2]}})})})},r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(Me),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Ne.D),e.\u0275\u0275directiveInject(Ue.J),e.\u0275\u0275directiveInject(ze.w),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(De.H),e.\u0275\u0275directiveInject(it.s),e.\u0275\u0275directiveInject(Ke.z),e.\u0275\u0275directiveInject(St),e.\u0275\u0275directiveInject(tt.$8),e.\u0275\u0275directiveInject(ze.M),e.\u0275\u0275directiveInject(je.r),e.\u0275\u0275directiveInject(nt.w))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["visual-container-skittles"]],viewQuery:function(t,i){if(1&t&&(e.\u0275\u0275viewQuery(ji,5,e.ElementRef),e.\u0275\u0275viewQuery(Ni,5,e.ElementRef),e.\u0275\u0275viewQuery(Ui,5,e.ElementRef)),2&t){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._buildSkittleElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._chartElementsSkittleElement=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(i._buildSkittleMaskElement=o.first)}},features:[e.\u0275\u0275ProvidersFeature([St])],decls:2,vars:3,consts:[["class","visualContainerSkittles",3,"row-gap",4,"ngIf"],[1,"visualContainerSkittles"],["class","skittle pbi-depth-1","data-automation-id","visual-container-skittle-build-button","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",3,"ngClass","width","height","pbiTooltip","pbiTooltipPosition","keydown","click",4,"ngIf"],[4,"ngIf"],["data-automation-id","visual-container-skittle-build-button","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",1,"skittle","pbi-depth-1",3,"ngClass","pbiTooltip","pbiTooltipPosition","keydown","click"],["buildSkittle",""],["name","suggestLightningBolt_20"],[1,"skittle-mask"],["buildSkittleMask",""],["class","skittle pbi-depth-1","pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",3,"ngClass","width","height","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","keydown","click",4,"ngIf"],["pbiTooltipCaretSize","small","pbiTooltipShowDelay","500",1,"skittle","pbi-depth-1",3,"ngClass","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","keydown","click"],["chartElementsSkittle",""],["name","PBIAddToChart_20"]],template:function(t,i){1&t&&(e.\u0275\u0275template(0,Ji,6,13,"div",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.skittlesStyle$))},dependencies:[f.NgClass,f.NgIf,ft.m,v.V,f.AsyncPipe,Ge.F],styles:[".visualContainerSkittles[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;--skittle-background-color: var(--gray-40, #E1DFDD);--skittle-box-shadow: 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey);--skittle-border-color: var(--gray-50, #D2D0CE);--skittle-selected-background-color: var(--gray-80, #B3B0AD);--skittle-selected-border-color: var(--gray-130, #605E5C);--skittle-hover-background-color: var(--gray-70, #BEBBB8);--skittle-active-background-color: var(--gray-90, #A19F9D)}  [data-legacy-theming=false] .visualContainerSkittles{--skittle-background-color: var(--colorNeutralBackground3);--skittle-box-shadow: 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey);--skittle-border-color: var(--colorNeutralStroke3);--skittle-selected-background-color: var(--colorNeutralBackground3Selected);--skittle-selected-border-color: var(--colorNeutralStroke3);--skittle-hover-background-color: var(--colorNeutralBackground3Hover);--skittle-active-background-color: var(--colorNeutralBackground3Pressed)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]{background-color:var(--skittle-background-color);box-shadow:var(--skittle-box-shadow);outline:none;border:1px solid var(--skittle-border-color);border-radius:2px;box-sizing:border-box;padding:0;align-items:center;justify-content:center;display:flex;cursor:pointer;position:relative}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--skittle-hover-background-color);border-color:transparent}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--skittle-active-background-color);border-color:transparent}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.selected[_ngcontent-%COMP%]{background-color:var(--skittle-selected-background-color);border-color:var(--skittle-selected-border-color)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.disabled[_ngcontent-%COMP%]{cursor:default}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle.disabled[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{opacity:.4}  html[data-focus-source=key] .visualContainerSkittles .skittle:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle:hover:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle:active:focus,   html[data-focus-source=key] .visualContainerSkittles .skittle.selected:focus{border:2px solid var(--fluent-theme-black-color, #000)}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{height:20px;width:20px}.visualContainerSkittles[_ngcontent-%COMP%]   .skittle[_ngcontent-%COMP%]   .skittle-mask[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}@media print{[_nghost-%COMP%]{display:none!important}}"],changeDetection:0}),r}(),Zi=a(54485),qi=[{type:Ft,componentId:"VisualContainerSkittlesComponentId"},{type:ht,componentId:"BuildSkittlePaneComponentId"},{type:yt,componentId:"SuggestSkittlePaneComponentId"},{type:mt,componentId:"ChartElementsSkittlePaneComponentId"}],en=function(){function r(n){a.e("on-object").then(a.bind(a,39875)).then(function(t){n.registerIcons(t.iconSpriteSheet.sprite)})}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275inject(Zi.u))},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({providers:[Me],imports:[f.CommonModule,s.J,b.N.withManifests(qi),B.v,k.p,S.V,E.X,X.m,q.N,H.x,K.Z,ie.K,m.T6,z.Q]}),r}()},13941:function(ue,j,a){function f(S){return"add"===S.type}function s(S){return"delete"===S.type}function z(S){return"reorder"===S.type}function k(S){return"replace"===S.type}function b(S){return"rename"===S.type}function B(S){return"initialize"===S.type}a.d(j,{H2:function(){return s},JB:function(){return f},V5:function(){return B},cA:function(){return k},cS:function(){return z},y$:function(){return b}})},14002:function(ue,j,a){a.d(j,{C:function(){return S},m:function(){return E}});var f=a(64466),s=a(62458),z=a(25512),k=a(49977),b={LeftTop:z.Iz,RightTop:z.Zz,LeftCenter:z.q6,RightCenter:z.v3,LeftBottom:z.Kb,RightBottom:z.J7,RightInsideTop:function(O,g){return{originX:"end",originY:"top",overlayX:"end",overlayY:"top",offsetX:O,offsetY:g}},RightInsideBottom:function(O,g){return{originX:"end",originY:"bottom",overlayX:"end",overlayY:"bottom",offsetX:O,offsetY:g}}},B=2;function S(v,O){s.fF.assertValue(v,"visualContainer"),s.fF.assertValue(O,"visualOverlayPosition");var g=O.getOrigin(v);if(g){if(!(g instanceof Element))return void s.fF.assertFail("Visual container origin is not of type Element");var u=document.querySelector(f.s.DisplayAreaContainerNameSelector.selector);if(!(u&&u instanceof Element))return void s.fF.assertFail("Canvas area container is not of type Element");var y=X(u,g);if(s.fF.assert(function(){return 0!==y.originWidth&&0!==y.originHeight},"visual width or height is 0 now, check how to avoid calculating skittle position before visual is rendered"),function(v){if(v.relativeY>=v.pageHeight||v.relativeY+v.originHeight<=0||v.relativeX>=v.pageWidth)return!1;var g=v.relativeX+v.originWidth;return!(g<=0)&&!(v.relativeX<0&&v.pageWidth-g<0)}(y)){var D=function(v){var R,W,U,g=v.pageWidth-(v.relativeX+v.originWidth),u=v.relativeX,y=k.Lc.width+k.Lc.marginHorizontal,D=k.Lc.childOverlayWidth+k.Lc.marginHorizontal,V=y+2*D,Y=y+D;return g>=Y?{skittleButtons:R="Right",firstLevelFlyout:{alignment:W="Right",maxWidth:m(v,R,W,U=g>=V?"Right":"Left")},secondLevelFlyout:{alignment:U}}:u>=Y?{skittleButtons:R="Left",firstLevelFlyout:{alignment:W="Left",maxWidth:m(v,R,W,U=u>=V?"Left":"Right")},secondLevelFlyout:{alignment:U}}:g>=y?{skittleButtons:R="Right",firstLevelFlyout:{alignment:W="Left",maxWidth:m(v,R,W,U="Left")},secondLevelFlyout:{alignment:U}}:u>=y?{skittleButtons:R="Left",firstLevelFlyout:{alignment:W="Right",maxWidth:m(v,R,W,U="Right")},secondLevelFlyout:{alignment:U}}:g>=0?{skittleButtons:R="RightInside",firstLevelFlyout:{alignment:W="Left",maxWidth:m(v,R,W,U="Left")},secondLevelFlyout:{alignment:U}}:void 0}(y);if(D){var V=function(v){var D=v.relativeY/v.pageHeight*100;return{skittleButtons:(v.relativeY>=0?v.pageHeight-v.relativeY:v.pageHeight)>=(k.Lc.height+k.Lc.betweenSkittlesVerticalSpace)*B-k.Lc.betweenSkittlesVerticalSpace?"Top":"Bottom",firstLevelFlyout:D<=50?"Top":D<=75?"Center":"Bottom",secondLevelFlyout:"Center"}}(y);if(V){var Y=function(v,O){var g;if("Top"===v){var u=0-O.relativeY;u>0&&(g=u)}else if("Bottom"===v){var y=O.relativeY+O.originHeight-O.pageHeight;y>0&&(g=-y)}return g}(V.skittleButtons,y);return{skittleButtons:{overlayPosition:[K(D.skittleButtons,V.skittleButtons,k.Lc.marginHorizontal,Y)],buttonHeight:k.Lc.height,buttonWidth:k.Lc.width,betweenButtonMargin:k.Lc.betweenSkittlesVerticalSpace,tooltipPosition:"Left"===D.firstLevelFlyout.alignment?"after":"before"},verticalLayout:V,horizontalLayout:D}}}}}}function E(v,O,g,u){void 0===u&&(u=0);var y=v.alignment,D=v.maxWidth,V=O,Y=document.querySelector(f.s.DisplayAreaContainerNameSelector.selector);if(Y&&Y instanceof Element){var U,R=X(Y,g),W=R.pageHeight-R.relativeY-1;switch(V){case"Top":U=W-u;break;case"Center":U=2*(W-R.originHeight/2),u=document.documentElement.clientHeight-R.originY-u-1-W+u;break;case"Bottom":U=R.originY+R.originHeight-u}return{position:[K(y,V,k.Lc.marginHorizontal,u)],height:void 0,width:k.Lc.childOverlayWidth,maxHeight:U,maxWidth:D,minWidth:k.Lc.childOverlayWidth}}}function X(v,O){var g=O.getBoundingClientRect(),u=v.getBoundingClientRect();return{pageHeight:u.height,pageWidth:u.width,pageX:u.x,pageY:u.y,originHeight:g.height,originWidth:g.width,originX:g.x,originY:g.y,relativeX:g.x-u.x,relativeY:g.y-u.y}}function K(v,O,g,u){if(null==g&&null==u)return b["".concat(v).concat(O)]();var y="Left"===v||"RightInside"===v?-g:g;return b["".concat(v).concat(O)](y,u)}function m(v,O,g,u){var y=v.pageWidth,D=v.originWidth,V=v.relativeX,Y=k.Lc.width+2*k.Lc.marginHorizontal,R=k.Lc.childOverlayWidth+k.Lc.marginHorizontal;if("Right"===O){if("Right"!==g)return s.fF.assert(function(){return"Left"===g&&"Left"===u},"Skittle buttons right; Should match combination in getHorizontalLayout"),V+D-R;if("Right"===u)return y-(V+D)-Y-R;if("Left"===u)return y-(V+D)-Y}else if("Left"===O){if("Left"===g){if("Right"===u)return V-Y;if("Left"===u)return V-Y-R}else if("Right"===g)return s.fF.assert(function(){return"Right"===u},"SkittlePosition left; should match combinations in getHorizontalLayout"),y-V-R}else if("RightInside"===O)return s.fF.assert(function(){return"Left"===g&&"Left"===u},"Skittle buttons are RightInside, but should match combination in getHorizontalLayout"),V+D-Y-R;return k.Lc.childOverlayWidth}},98476:function(ue,j,a){a.d(j,{f:function(){return k}});var f=a(45413),s=a(74082);function z(b){return void 0!==b.pickerDataExpr}function k(b,B){for(var E,S=(0,s.ez)(b),X=B.length-1;X>=0;X--){var q=B[X],H=q.expr;if(S&&(0,s.y3)(H)){var K,ie=X;if((K=z(q)?_.findIndex(q.children,function(m){return(0,f.fS)(m.expr,b)}):_.findIndex(q.hierarchyLevels,function(m){return(0,f.fS)(m.expr,b)}))>=0)return[ie,K]}if((0,s.iV)(H)&&(H=H.arg),(0,f.fS)(H,b))return[X]}return E}},7779:function(ue,j,a){a.d(j,{r:function(){return B}});var f=a(23983),s=a(29834),z=a(93215),k=a(8538),b=a(34145),B=[f.eE,s.c,z.b,k.h,{provide:b.q,useExisting:z.b}]},93215:function(ue,j,a){a.d(j,{b:function(){return q}});var f=a(81337),s=a(98209),z=a(8590),k=a(35510),b=a(50423),B=a(11494),S=a(83008),E=a(26898),X=a(65181),q=function(){function H(ie,K,m,e){var v=this;this.conceptualSchemaProxy=K,this.dataSourcesService=m,this.localizationService=e,this.modelUpdates=new k.X({schema:void 0,model:void 0,appliedChanges:void 0}),this.subscriptionManager=ie.createChannelSubscriptionManager(),this.subscriptionManager.subscribe(z.CCe,function(O,g){return v.update(g.result.changes)})}return H.prototype.update=function(ie,K,m){return void 0===K&&(K=!0),void 0===m&&(m=!1),(0,f.__awaiter)(this,void 0,void 0,function(){var e,v;return(0,f.__generator)(this,function(g){switch(g.label){case 0:return this.dataSourcesService.get()?(K||this.conceptualSchemaProxy.clearCache(),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:(e=g.sent())&&(v=new s.O(this.localizationService).createModel(e,m)),g.label=2;case 2:return this.modelUpdates.next({schema:e,model:v,appliedChanges:ie}),[2]}})})},Object.defineProperty(H.prototype,"modelChange$",{get:function(){return this.modelUpdates.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"model",{get:function(){return this.modelUpdates.value.model},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"schema",{get:function(){return this.modelUpdates.value.schema},enumerable:!1,configurable:!0}),H.\u0275fac=function(K){return new(K||H)(b.\u0275\u0275inject(B.J),b.\u0275\u0275inject(E.i),b.\u0275\u0275inject(S.D),b.\u0275\u0275inject(X.o))},H.\u0275prov=b.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac}),H}()},8538:function(ue,j,a){a.d(j,{h:function(){return K}});var f=a(70863);function s(m){return{schema:m.schemaName,entity:(0,f.wb)(m)?m.name:(0,f.Om)(m)?m.table.name:(0,f.ez)(m)?m.hierarchy.table.name:void 0,hierarchy:(0,f.y3)(m)?m.name:(0,f.ez)(m)?m.hierarchy.name:void 0,hierarchyLevel:(0,f.ez)(m)?m.name:void 0,property:(0,f.wb)(m)||(0,f.y3)(m)||(0,f.ez)(m)||(0,f.Ov)(m)?void 0:m.name}}var b=a(8590),B=a(62458),S=a(9738),E=a(34763),X=a(50423),q=a(11494),H=a(39833),ie=a(93215),K=function(){function m(e,v,O,g){this.schemaItemActivationService=v,this.modelService=O,this.modelingSelectionService=g,this.subscription=new E.w,this.subscriptionManager=e.createChannelSubscriptionManager()}return m.prototype.initialize=function(){var e=this;this.subscriptionManager.subscribe(b.$Bd,function(){return e.onSchemaItemActivationChanged()}),this.subscription.add(this.modelingSelectionService.selectionChanged.subscribe(function(v){return e.onSelectionChanged(v)}))},m.prototype.onSelectionChanged=function(e){if(0===e.length)this.schemaItemActivationService.clearActiveItem();else{var v=e[e.length-1];e.length>1&&this.modelingSelectionService.select(v,!0),this.schemaItemActivationService.setActiveItem(s(v))}},m.prototype.onSchemaItemActivationChanged=function(){if(!function(m,e){if(!e&&0===m.length)return!0;if(1===m.length&&e){var v=s(m[0]);return e.schema===v.schema&&e.entity===v.entity&&e.property===v.property&&e.hierarchy===v.hierarchy&&e.hierarchyLevel===v.hierarchyLevel}return!1}(this.modelingSelectionService.selection,this.schemaItemActivationService.getActiveItem())){var e=this.schemaItemActivationService.getActiveItem();if(e){var v=function(m,e){return e.hierarchyLevel?(0,f.xu)(m,e.schema,e.entity,e.hierarchy,e.hierarchyLevel):e.hierarchy?(0,f.ZG)(m,e.schema,e.entity,e.hierarchy):e.property?(0,f.Gz)(m,e.schema,e.entity,e.property)||(0,f.yo)(m,e.schema,e.entity,e.property):(0,f.AG)(m,e.entity)}(this.modelService.model,e);v?this.modelingSelectionService.select(v,!0):B.fF.assert(function(){return!!v},"onSchemaItemActivationChanged item not found in model")}else this.modelingSelectionService.clear()}},m.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.subscription.unsubscribe()},m.\u0275fac=function(v){return new(v||m)(X.\u0275\u0275inject(q.J),X.\u0275\u0275inject(H.WK),X.\u0275\u0275inject(ie.b),X.\u0275\u0275inject(S.W6))},m.\u0275prov=X.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac}),m}()},65005:function(ue,j,a){a.d(j,{l:function(){return Oe}});var f=a(81337),s=a(50423),z=a(48787),k=a(30794),b=a(37196),B=[],S=a(77476),E=a(68070),X=a(89237);function q(w,Z){1&w&&s.\u0275\u0275element(0,"div",7)}function H(w,Z){1&w&&(s.\u0275\u0275elementStart(0,"div",8),s.\u0275\u0275element(1,"div",9)(2,"div",10),s.\u0275\u0275elementEnd())}function ie(w,Z){1&w&&(s.\u0275\u0275elementStart(0,"div",11),s.\u0275\u0275element(1,"div",12),s.\u0275\u0275elementStart(2,"div",13),s.\u0275\u0275element(3,"div",14)(4,"div",15),s.\u0275\u0275elementEnd()())}function K(w,Z){if(1&w&&(s.\u0275\u0275elementContainerStart(0,3),s.\u0275\u0275template(1,q,1,0,"div",4),s.\u0275\u0275template(2,H,3,0,"div",5),s.\u0275\u0275template(3,ie,5,0,"div",6),s.\u0275\u0275elementContainerEnd()),2&w){var M=Z.$implicit,A=s.\u0275\u0275nextContext(2);s.\u0275\u0275property("ngSwitch",M),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngSwitchCase",A.largeBarType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngSwitchCase",A.multipleBarType),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngSwitchCase",A.multipleSmallLargeType)}}function m(w,Z){if(1&w&&(s.\u0275\u0275elementStart(0,"div",1),s.\u0275\u0275template(1,K,4,4,"ng-container",2),s.\u0275\u0275elementEnd()),2&w){var M=s.\u0275\u0275nextContext();s.\u0275\u0275property("ngStyle",M.barsStyle),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngForOf",M.barsProperties.bars)}}var y=function(){function w(){this.largeBarType=0,this.multipleBarType=1,this.multipleSmallLargeType=2}return w.prototype.ngOnChanges=function(){this.barsProperties&&(this.barsStyle={height:"".concat((this.barsProperties.height+8)*this.barsProperties.bars.length,"px")})},w.\u0275fac=function(M){return new(M||w)},w.\u0275cmp=s.\u0275\u0275defineComponent({type:w,selectors:[["shimmering-bars"]],inputs:{barsProperties:"barsProperties"},features:[s.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","bars",3,"ngStyle",4,"ngIf"],[1,"bars",3,"ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["class","largerLoadingBar animate",4,"ngSwitchCase"],["class","multipleBars",4,"ngSwitchCase"],["class","multipleSmallLarge",4,"ngSwitchCase"],[1,"largerLoadingBar","animate"],[1,"multipleBars"],[1,"miniLoadingBar","animate"],[1,"smallerLoadingBar","animate"],[1,"multipleSmallLarge"],[1,"shimmerBox","animate"],[1,"smallLargeBarContainer"],[1,"upperLoadingBar","animate"],[1,"lowerLoadingBar","animate"]],template:function(M,A){1&M&&s.\u0275\u0275template(0,m,2,2,"div",0),2&M&&s.\u0275\u0275property("ngIf",A.barsProperties)},dependencies:[S.NgForOf,S.NgIf,S.NgStyle,S.NgSwitch,S.NgSwitchCase],styles:['[_nghost-%COMP%]{--shimmer-background-color: var(--gray-20);--shimmer-animate1: var(--gray-30);--shimmer-animate2: var(--gray-50)}[data-legacy-theming=false]   [_nghost-%COMP%]{--shimmer-background-color: var(--colorNeutralBackground3);--shimmer-animate1: var(--colorNeutralBackground3Hover);--shimmer-animate2: var(--colorNeutralBackground3Pressed)}.bars[_ngcontent-%COMP%]{display:flex;flex-direction:column}.largerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;flex-grow:1;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}.multipleBars[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}.miniLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:60%;width:10%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-right:4px}html[dir="rtl"][_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-left:4px}.smallerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:80%;width:100%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-left:4px}html[dir="rtl"][_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-right:4px}.multipleSmallLarge[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:10px 9px}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}.upperLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:49%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 4px 11px 0}html[dir="rtl"][_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 0 11px 4px}.lowerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:100%;background:var(--shimmer-background-color)}.shimmerBox[_ngcontent-%COMP%]{background:var(--shimmer-background-color);border-radius:2px;height:32px;width:32px}.smallLargeBarContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;max-width:167px}html:not([dir="rtl"])[_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 0 2.42px 13px}html[dir="rtl"][_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 13px 2.42px 0}.animate[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shimmer 5s infinite linear;background:linear-gradient(270deg,var(--shimmer-animate1) 0%,var(--shimmer-animate2) 50%,var(--shimmer-animate1) 100%);background-size:250% 100%}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:250% 0}to{background-position:-250% 0}}'],changeDetection:0}),w}(),D=a(85102),V=["pbiTree"];function Y(w,Z){if(1&w){var M=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"tri-search-box",5),s.\u0275\u0275listener("value",function(fe){s.\u0275\u0275restoreView(M);var ye=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(ye.search$.next(fe))}),s.\u0275\u0275pipe(1,"localize"),s.\u0275\u0275pipe(2,"localize"),s.\u0275\u0275elementEnd()}if(2&w){var A=s.\u0275\u0275nextContext();s.\u0275\u0275property("currentInputValue",A.searchText||"")("placeholderText",s.\u0275\u0275pipeBind1(2,8,"SearchBox_Text"))("fluentTheme",!0)("compact",!0)("fullWidth",!0),s.\u0275\u0275attribute("aria-label",s.\u0275\u0275pipeBind1(1,6,"SearchBox_Text"))}}function R(w,Z){if(1&w){var M=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"pbi-search-box")(1,"input",6),s.\u0275\u0275listener("input",function(fe){s.\u0275\u0275restoreView(M);var ye=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(ye.search$.next(fe.target.value))}),s.\u0275\u0275pipe(2,"localize"),s.\u0275\u0275pipe(3,"localize"),s.\u0275\u0275elementEnd()()}if(2&w){var A=s.\u0275\u0275nextContext();s.\u0275\u0275advance(1),s.\u0275\u0275property("value",A.searchText||"")("placeholder",s.\u0275\u0275pipeBind1(3,5,"SearchBox_Text")),s.\u0275\u0275attribute("aria-label",s.\u0275\u0275pipeBind1(2,3,"SearchBox_Text"))}}function W(w,Z){if(1&w&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275element(1,"shimmering-bars",7),s.\u0275\u0275elementContainerEnd()),2&w){var M=s.\u0275\u0275nextContext();s.\u0275\u0275advance(1),s.\u0275\u0275property("barsProperties",M.shimmeringBars)}}function U(w,Z){if(1&w){var M=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"pbi-tree",12,13),s.\u0275\u0275listener("onNodeClick",function(fe){s.\u0275\u0275restoreView(M);var ye=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(ye.onNodeClick.emit(fe))})("onNodeCheck",function(fe){s.\u0275\u0275restoreView(M);var ye=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(ye.onNodeCheck.emit(fe))})("onNodeExpansionToggle",function(fe){s.\u0275\u0275restoreView(M);var ye=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(ye.onNodeExpansionToggle.emit(fe))})("onFirstRender",function(){s.\u0275\u0275restoreView(M);var fe=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(fe.onFirstRender())}),s.\u0275\u0275pipe(2,"async"),s.\u0275\u0275elementEnd()}if(2&w){var A=s.\u0275\u0275nextContext(2);s.\u0275\u0275property("tree",A.fieldListTree)("search",s.\u0275\u0275pipeBind1(2,5,A.search$))("hasHighlights",A.hasHighlights)("checkMode",A.checkMode)("options",A._options)}}function _e(w,Z){1&w&&s.\u0275\u0275projection(0,2)}function J(w,Z){if(1&w&&(s.\u0275\u0275elementStart(0,"div",8),s.\u0275\u0275element(1,"div",9),s.\u0275\u0275elementEnd(),s.\u0275\u0275template(2,U,3,7,"pbi-tree",10),s.\u0275\u0275template(3,_e,1,0,"ng-template",null,11,s.\u0275\u0275templateRefExtractor)),2&w){var M=s.\u0275\u0275reference(4),A=s.\u0275\u0275nextContext();s.\u0275\u0275advance(2),s.\u0275\u0275property("ngIf",A.fieldListTree)("ngIfElse",M)}}var me=[[["",8,"pbi-field-list-perspective-header"]],[["",8,"pbi-field-list-header"]],[["",8,"pbi-field-list-watermark"]]],Ee=[".pbi-field-list-perspective-header",".pbi-field-list-header",".pbi-field-list-watermark"],Le={height:24,bars:[0,1,1,0,0]},Oe=function(){function w(){this.hasHighlights=!1,this.loading=!1,this.shimmeringBars=Le,this.defaultOptions={},this._options=this.defaultOptions,this.onNodeExpansionToggle=new s.EventEmitter,this.onNodeClick=new s.EventEmitter,this.onNodeCheck=new s.EventEmitter,this.onFirstRenderComplete=new s.EventEmitter,this.handleFieldListTreeHeightDiff=new s.EventEmitter,this.search$=new k.xQ}return Object.defineProperty(w.prototype,"options",{set:function(M){this._options=(0,f.__assign)((0,f.__assign)({},this.defaultOptions),M)},enumerable:!1,configurable:!0}),w.prototype.ngOnInit=function(){var Z=this;this.focusSearchBoxOnFirstRenderComplete&&this.onFirstRenderComplete.pipe((0,z.q)(1)).subscribe(function(){return Z.focusSearchBox()})},w.prototype.onFirstRender=function(){var Z=this.getFieldListTreeHeightDiff();this.handleFieldListTreeHeightDiff.emit(Z),this.scrollSelectedItemIntoViewOnInit&&this.pbiTree.scrollToFirstSelectedNode(),this.onFirstRenderComplete.emit()},w.prototype.focusSearchBox=function(){$(".field-list-search-container input").trigger("focus")},w.prototype.getFieldListTreeHeightDiff=function(){return this.pbiTree.getTreeHeight()+2-this.pbiTreeElementRef.nativeElement.getBoundingClientRect().height},w.\u0275fac=function(M){return new(M||w)},w.\u0275cmp=s.\u0275\u0275defineComponent({type:w,selectors:[["pbi-field-list"]],viewQuery:function(M,A){if(1&M&&(s.\u0275\u0275viewQuery(b.u,5),s.\u0275\u0275viewQuery(V,5,s.ElementRef)),2&M){var pe=void 0;s.\u0275\u0275queryRefresh(pe=s.\u0275\u0275loadQuery())&&(A.pbiTree=pe.first),s.\u0275\u0275queryRefresh(pe=s.\u0275\u0275loadQuery())&&(A.pbiTreeElementRef=pe.first)}},inputs:{fieldListTree:"fieldListTree",scrollSelectedItemIntoViewOnInit:"scrollSelectedItemIntoViewOnInit",checkMode:"checkMode",hasHighlights:"hasHighlights",loading:"loading",searchText:"searchText",focusSearchBoxOnFirstRenderComplete:"focusSearchBoxOnFirstRenderComplete",fluent:"fluent",options:"options"},outputs:{onNodeExpansionToggle:"onNodeExpansionToggle",onNodeClick:"onNodeClick",onNodeCheck:"onNodeCheck",onFirstRenderComplete:"onFirstRenderComplete",handleFieldListTreeHeightDiff:"handleFieldListTreeHeightDiff"},features:[s.\u0275\u0275ProvidersFeature(B)],ngContentSelectors:Ee,decls:8,vars:4,consts:[["data-tutorial-target","search-box",1,"field-list-search-container"],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["loaded",""],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value"],["pbiSearchInput","","data-testid","search-bar-input",1,"pbi-focus-outline",3,"value","placeholder","input"],[3,"barsProperties"],[1,"tutorial-target-container"],["data-tutorial-target","data-tree"],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender",4,"ngIf","ngIfElse"],["watermark",""],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender"],["pbiTree",""]],template:function(M,A){if(1&M&&(s.\u0275\u0275projectionDef(me),s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275template(1,Y,3,10,"tri-search-box",1),s.\u0275\u0275template(2,R,4,7,"pbi-search-box",2),s.\u0275\u0275elementEnd(),s.\u0275\u0275projection(3),s.\u0275\u0275projection(4,1),s.\u0275\u0275template(5,W,2,1,"ng-container",3),s.\u0275\u0275template(6,J,5,2,"ng-template",null,4,s.\u0275\u0275templateRefExtractor)),2&M){var pe=s.\u0275\u0275reference(7);s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",A.fluent),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",!A.fluent),s.\u0275\u0275advance(3),s.\u0275\u0275property("ngIf",A.loading)("ngIfElse",pe)}},dependencies:[S.NgIf,E.a,E.p,X.U,b.u,y,S.AsyncPipe,D.F],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}pbi-tree[_ngcontent-%COMP%]{margin-top:9px;height:100%;display:block;overflow:hidden}.tutorial-target-container[_ngcontent-%COMP%]{position:relative;visibility:hidden;height:0;width:0}.tutorial-target-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:20px;visibility:hidden;height:0;width:0}"],changeDetection:0}),w}()}}]);