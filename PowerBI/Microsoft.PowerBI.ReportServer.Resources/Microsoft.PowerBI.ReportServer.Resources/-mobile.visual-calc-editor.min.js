"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["visual-calc-editor"],{8898:function(Ke,we,E){E.d(we,{x:function(){return z}});var z=new(E(50423).InjectionToken)("EventAggregationServiceToken")},55863:function(Ke,we,E){E.d(we,{hu:function(){return V},mv:function(){return j},sr:function(){return M},vE:function(){return k}});var H,R=E(62458);function V(Y,Z){R.fF.isDisabled()||!0!==Y&&M(Z||"condition: ".concat(Y))}function j(Y,Z){R.fF.isDisabled()||null==Y&&M(Z||"condition: "+Y)}function M(Y){if(!R.fF.isDisabled())throw(H||alert)("Debug Assert failed: ".concat(Y)),new Error(Y)}function k(Y){return M(Y)}},48563:function(Ke,we,E){E.d(we,{w:function(){return z}});var R=E(17819);function z(Y){return Y.map(function(Z){return function(Y){return{name:Y.Name,description:Y.Description,category:V(Y.Category),pushableToDQ:j(Y.PushableToDirectQuery),parameters:M(Y.Parameters),visualCalculationsInfo:Y.VisualCalculationsInfo}}(Z)})}function V(Y){switch(Y){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9}}function j(Y){var Z=0;return 1===Y?Z=1:2===Y?Z=2:3===Y&&(Z=3),Z}function M(Y){return Y?Y.map(function(Z){return function(Y){return new R.Hw(Y.Name,Y.Optional,Y.Repeatable,Y.RepeatGroup,Y.Skippable)}(Z)}):[]}},11674:function(Ke,we,E){E.d(we,{w_:function(){return je},MX:function(){return Me},Jt:function(){return xe}});var j,R=E(81337),z=E(55863),H=E(58871),V=E(63513);!function(P){P.buildAnonymousExpression=function(d,C,m){return new T(d,C,m).buildAnonymousExpression()};var T=function(){function d(C,m,O){this.tokenization=C,this.context=m,this.delimitIdentifier=O,this.matchObjectReplacements=new V.Xy,this.unmatchedObjectReplacements={},this.tableIndex=0,this.columnIndex=0,this.measureIndex=0,this.variableIndex=0,this.unmatchedIndex=0}return d.prototype.buildAnonymousExpression=function(){for(var C="",m=0,O=this.tokenization.tokens;m<O.length;m++){var A=O[m],U=void 0;switch(A.type){case 29:case 2:case 3:case 4:case 5:case 6:case 7:U=" ";break;case 10:case 11:case 12:case 13:case 14:case 9:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 40:U=A.getString();break;case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 51:case 52:case 53:case 54:case 49:case 50:case 55:U=A.getString().toUpperCase();break;case 30:case 31:U='"String"';break;case 36:case 37:U="0";break;case 32:case 33:case 34:case 35:case 58:case 57:U=this.anonymizeIdentifier(A);break;case 59:U="?";break;case 38:case 39:U='DT""';break;default:(0,z.sr)("Unexpected token type"),U=""}C+=U}return C},d.prototype.anonymizeIdentifier=function(C){var O,m=C.matchObject;if(m instanceof H.it||m instanceof H.Gs||m instanceof H.Z0)return C.getString().toUpperCase();if(m instanceof H.XN||m instanceof H.Cf||m instanceof H.S2||m instanceof H.yB)(O=this.matchObjectReplacements.get(m))||(O=m instanceof H.XN?"Column"+ ++this.columnIndex:m instanceof H.Cf?"Measure"+ ++this.measureIndex:m instanceof H.S2?"Table"+ ++this.tableIndex:"Variable"+ ++this.variableIndex,this.matchObjectReplacements.add(m,O));else{var A=C.getIdentifier();(O=this.unmatchedObjectReplacements[A])||(O="Unmatched"+ ++this.unmatchedIndex,this.unmatchedObjectReplacements[A]=O)}return this.delimitIdentifier(C.type,O,this.context)},d}()}(j||(j={}));var D,M=E(70163),k=E(66106),Y=E(3371),Z=E(22021),I=E(85616),te=E(68706),ee=E(82269),W=E(40546),i=E(20540),K=E(66813),y=E(85786),ie=function(){function P(p,T){var d=this;this.newExpressionNode=new I.ig(p,function(){return d._rootNode=T(),d._rootNode}),this._context=p,this._leafPositions=[],this.tokenization=new K.h("",0,void 0,void 0)}return Object.defineProperty(P.prototype,"rootNode",{get:function(){return this._rootNode},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"leafPositions",{get:function(){return this._leafPositions},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"anyErrors",{get:function(){return _.some(this._leafPositions,function(T){return _.some(T.validNodes,function(d){return d instanceof I.IE})})},enumerable:!1,configurable:!0}),P.prototype.getValidLeafNodesAtPosition=function(p){return this._leafPositions[p].validNodes},P.prototype.update=function(p){var T={iToken:void 0,currentNodes:void 0};this.reuseExistingParseTree(p,T),this.completeParseTree(p,T.iToken,T.currentNodes),this.tokenization=p},P.prototype.tryAddClosingParens=function(p,T){var d={result:!1,countParensAdded:-1},C={iToken:void 0,currentNodes:void 0};this.reuseExistingParseTree(this.tokenization,C),(0,z.hu)(C.iToken===this.tokenization.parseTokenCount,"expected iToken to be parseTokenCount");var m=T.expression;for(d.countParensAdded=0;;){var O=new y.WU(24,m+=")",m.length-1,1),A=new H.qf(O);switch(this.tryEatToken(O,new H.qf(O),C)){case i.R.Yum:d.countParensAdded++,p&&(T.expression=m,this.tokenization.updateExpression(T.expression),this.tokenization.tokens.push(O),this.tokenization.parseTokenCount++,this.leafPositions.push(A));break;case i.R.Yuck:return d.result=!1,d;case i.R.NotHungry:return d.result=!0,d}}},P.prototype.reuseExistingParseTree=function(p,T){var d=Math.min(this.tokenization.parseTokenCount,p.parseTokenCount);for(T.iToken=0;T.iToken<d;T.iToken++){var C=this.tokenization.tokens[T.iToken],m=p.tokens[T.iToken];if(C.activelyEdited||m.activelyEdited||!(0,y.Cu)(m.type,C.type))break;this.leafPositions[T.iToken].rebindToken(m)}T.iToken<this.leafPositions.length&&this.leafPositions.splice(T.iToken,this.leafPositions.length-T.iToken);for(var O=T.iToken-1;O>=0;O--){var A=this.leafPositions[O];if(A.isInParseTree)return T.currentNodes=A.nodes,void this.refreshParsePaths(T.currentNodes)}T.currentNodes=[this.newExpressionNode]},P.prototype.refreshParsePaths=function(p){this.removeLaterNodes(p),this.reinitializeParsePaths(p)},P.prototype.removeLaterNodes=function(p){for(var T=0,d=p;T<d.length;T++){var C=d[T];C.onParseIncomplete();for(var m=void 0,O=C;m=O.parent;O=m)m.removeLaterChildren(O),m.onParseIncomplete()}},P.prototype.reinitializeParsePaths=function(p){for(var T=0,d=p;T<d.length;T++)for(var m=d[T].path;m;m=m.parent)m.reinitialize();for(var O=0,A=p;O<A.length;O++)for(var U=(m=A[O].path).parent;U&&U.addChild(m);m=U,U=U.parent);},P.prototype.completeParseTree=function(p,T,d){for(var C={currentNodes:d},m=[],O=!0,A=[],U=function(){var ne=p.tokens[T],pe=new H.qf(ne);if((0,z.hu)(Q.leafPositions.length===T,"iToken to be the end of the leaf positions"),Q.leafPositions.push(pe),Q.tryEatToken(ne,pe,C),!W.d.featureSwitches.addTriviaToParseNodeMetadata)return"continue";if(ne.ignorable)return m.push(ne),"continue";if(60===ne.type)return"continue";if(O&&C.currentNodes.length)O=!1,C.currentNodes.map(function(Se){return Se.leadingTrivia=m}),m=[];else if(A.length&&C.currentNodes.length){var me=m.findIndex(function(Se){return Se.getString().includes("\n")}),Ee=-1===me?m.length:me+1;A.map(function(Se){return Se.trailingTrivia=m.slice(0,Ee)}),C.currentNodes.map(function(Se){return Se.leadingTrivia=m.slice(Ee)}),m=[]}A=C.currentNodes},Q=this;T<p.parseTokenCount;T++)U();W.d.featureSwitches.addTriviaToParseNodeMetadata&&m.length>0&&A.length&&A.map(function(oe){return oe.trailingTrivia=m})},P.prototype.tryEatToken=function(p,T,d){if(p.ignorable)return T.addNode(new I.i8(T,this.context)),i.R.Yum;for(var C=!1,m=0,O=d.currentNodes;m<O.length;m++)for(var A=O[m],U=[],Q=A;;Q=Q.parent){var oe=Q.eatToken(T,A.path);if(oe===i.R.Yum){for(var ne=0,pe=U;ne<pe.length;ne++){var me=pe[ne];me.parentNode.setChild(me.parseNode)}if(60!==T.token.type)for(var Ee=A;Ee!==Q;Ee=Ee.parent)Ee.onParseComplete();break}if(oe===i.R.Yuck){A.path.markUnsuccessful();break}if((0,z.hu)(oe===i.R.NotHungry,"expected ".concat(oe," to be EatResult.NotHungry (").concat(i.R.NotHungry,")")),!Q.parent){C=!0,A.path.markUnsuccessful();break}var Se=Q.parent instanceof I.q1?Q.parent:null;Se&&U.push({parseNode:Q,parentNode:Se})}return _.some(T.nodes)?(d.currentNodes=T.nodes,d.currentNodes.forEach(function(Ae){return Ae.consolidatePath()}),i.R.Yum):(60!==p.type&&T.addNode(new I.IE(T,this.context)),this.reinitializeParsePaths(d.currentNodes),C?i.R.NotHungry:i.R.Yuck)},P.prototype.clearAllContexts=function(){for(var p=[this.rootNode];p.length>0;){var d=p.pop();d.parent&&d.clearContext(),d instanceof H.sN&&(d instanceof I.q1?d.prospectiveChildren:d.children).forEach(function(C){return p.push(C)})}},P}(),ve=E(88498);(D||(D={})).couldBeOperand=function(T){for(var d=T.parent;null!=d&&d.isFirstChild(T);T=d,d=d.parent)if(d instanceof I.HV||d instanceof I.Ti||d instanceof I.F0||d instanceof I.IS||d instanceof I.RZ||d instanceof I.gi||d instanceof I.Ed||d instanceof I.gR||d instanceof I.ze||d instanceof I.Sm)return!0;return!1};var b=E(42165),q=E(48987),he=function(){function P(p,T,d,C){this.tokenization=p,this.parseTree=T,this.iNewToken=d,this.iTokenLeft=C,this.suggestionContexts=[],this._suggestions=[],this._replaceStart=-1,this._replaceEnd=-1,this._afterOParen=-1,this._afterCParen=-1,this._bestMatch=-1}return Object.defineProperty(P.prototype,"bestMatch",{get:function(){return this._bestMatch},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"afterCParen",{get:function(){return this._afterCParen},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"afterOParen",{get:function(){return this._afterOParen},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"replaceStart",{get:function(){return this._replaceStart},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"replaceEnd",{get:function(){return this._replaceEnd},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"suggestions",{get:function(){return this._suggestions},enumerable:!1,configurable:!0}),P.prototype.buildSuggestions=function(){this.addSuggestions(),this.removeDuplicateSuggestionsForSameObject(),this.removeDuplicateSuggestionsBySuggestionText(),this.sortSuggestions(),this.findBestMatch()},P.prototype.addSuggestions=function(p,T){if(p)this.suggestionContexts=this.suggestionContexts.concat(_.map(p,function(v){return new ye(v,T)}));else if(this._replaceStart=this.tokenization.cursorPosition||0,this._replaceEnd=this.tokenization.cursorPosition||0,this.tokenization.activeCursor&&3!==this.tokenization.cursorActivity){var d=this.iNewToken;if(-1===d&&(d=this.iTokenLeft),-1!==d){for(var C=this.tokenization.tokens[d],m=0,O=this.parseTree.getValidLeafNodesAtPosition(d);m<O.length;m++){var A=O[m];if(A instanceof I.IE)return;var U=A.parent,Q=void 0;if((U instanceof I.DH||U instanceof I.qS||U instanceof I.Fc)&&(Q=U.firstDescendent.token)!==C){for(var oe=void 0,ne=d-1;(oe=this.tokenization.tokens[ne])!==Q;ne--)if(29!==oe.type&&_.some(this.parseTree.getValidLeafNodesAtPosition(ne),function(v){return v instanceof I.i8||v instanceof I.IE}))return;var pe=(0,V.as)(U,I.Fc);if(pe){this.addSuggestionsBasedOnPartialVariation(C.getIdentifier(),A.context,pe.dotNode.token.startPosition);var me=pe.variationSource;(0,V.as)(me.parent,I.DH)?this.addSuggestionsBasedOnTableColumnAndPartialVariation(Q.getIdentifier(),me.token.getIdentifier(),C.getIdentifier(),Q.matchesType(32),pe.context,Q.startPosition):this.addSuggestionsBasedOnColumnAndPartialVariation(me.token.getIdentifier(),C.getIdentifier(),pe.context,Q.startPosition)}else U instanceof I.qS?this.addSuggestionsBasedOnPartialIdentifier(this.tokenization.expression.substr(Q.startPosition,C.endPosition-Q.startPosition),U.context,Q.startPosition):this.addSuggestionsBasedOnTableAndPartialColumnOrMeasure(Q.getIdentifier(),C.getIdentifier(),Q.matchesType(32),U.context,Q.startPosition)}else{var Se=A.context;if(W.d.featureSwitches.suggestKeywords&&A instanceof I.ub&&!(A.parent instanceof I.mR)&&this.addSuggestionsBasedOnPartialKeywordValue(C.getString(),A.keyword,C.startPosition),33===C.type)this.addSuggestionsBasedOnPartialTable(C.getIdentifier(),Se,C.startPosition),this.addSuggestionsBasedOnPartialCalendarCore(C.getIdentifier(),!0,new ce(Se),C.startPosition);else if(35===C.type)this.addSuggestionsBasedOnPartialColumnOrMeasure(C.getIdentifier(),Se,C.startPosition);else if(C.isIdentifierOrKeyword&&D.couldBeOperand(A))this.addSuggestionsBasedOnPartialIdentifier(C.getIdentifier(),Se,C.startPosition);else if(36===C.type)this.addSuggestionsBasedOnPartialEnumValue(C.getString(),Se,C.startPosition);else if(60===C.type){var Ae=this.tokenization.nextNonIgnorable(d);this.addSuggestionsBasedOnNewToken(Se,(Ae?Ae.matchedType:k.Yl.None).type,C.startPosition,4===this.tokenization.cursorActivity)}}}this.setReplaceStartAndPadSuggestions(),this._replaceEnd=C.endPosition;var s={iTokenNext:-1},l=this.tokenization.nextNonIgnorable(d,s);l&&(l.secondHalf&&(l.matchObject||1===l.length)&&(33===C.type&&32===l.type||35===C.type&&34===l.type||C.isIdentifierOrKeyword&&l.isIdentifierOrKeyword)&&((0,z.hu)(this.replaceEnd===l.startPosition,"expected replaceEnd to equal startPosition"),this._replaceEnd=l.endPosition,l=this.tokenization.nextNonIgnorable(s.iTokenNext,s)),l&&23===l.type&&(this._afterOParen=l.endPosition,(l=this.tokenization.nextNonIgnorable(s.iTokenNext,s))&&24===l.type&&(this._afterCParen=l.endPosition)))}}},P.prototype.addSuggestion=function(p,T){this.suggestionContexts.push(new ye(p,T))},P.prototype.setReplaceStartAndPadSuggestions=function(){var p=this;this.suggestionContexts.length>0&&(this._replaceStart=_.min(_.map(this.suggestionContexts,function(T){return T.replaceStart})),this._suggestions=this._suggestions.concat(_.map(this.suggestionContexts,function(T){return p.replaceStart<T.replaceStart&&T.suggestion.prependSuggestionText(p.tokenization.expression.substr(p.replaceStart,T.replaceStart-p.replaceStart)),T.suggestion})))},P.prototype.addSuggestionsBasedOnPartialTableCore=function(p,T,d,C){this.addSuggestions(_.chain(d.tables).filter(function(Ee){return P.isMatch(Ee.name,p)}).map(function(Ee){return new q.q$(Ee,Ee.getAutoCompleteName(T))}).value(),C);for(var m=function(Se){var Ae=P.tableToSuggest(Se),w=Ae.getAutoCompleteName(T),u=P.isMatch(Ae.name,p);u&&p!==w&&O.addSuggestion(new q.tA(Ae,w),C),O.addSuggestions(_.chain(Se.columns).filter(function(s){return u||P.isColumnMatch(s,p)}).map(function(s){return P.buildTableColumnSuggestion(s,T,!0)}).value(),C)},O=this,A=0,U=d.tablesForQualifiedColumnRefs;A<U.length;A++)m(U[A]);for(var oe=function(Se){var Ae=Se.getAutoCompleteName(T);ne.addSuggestions(_.map(Se.measures,function(w){return new q.q$(w,Ae+V.LP.bracket(w.name),Se,w)}),C)},ne=this,pe=0,me=_.filter(d.tablesForMeasures,function(Ee){return P.isMatch(Ee.name,p)});pe<me.length;pe++)oe(me[pe])},P.prototype.addSuggestionsBasedOnPartialTable=function(p,T,d){this.addSuggestionsBasedOnPartialTableCore(p,!0,new ce(T),d),this.userInput=p},P.prototype.addSuggestionsBasedOnPartialColumnOrMeasureCore=function(p,T,d){this.addSuggestions(_.chain(T.simpleColumnRefs).filter(function(C){return P.isColumnMatch(C,p)}).map(function(C){return P.buildColumnSuggestion(C)}).value(),d),this.addSuggestions(_.chain(T.measures).filter(function(C){return P.isMatch(C.name,p)}).map(function(C){return new q.q$(C,V.LP.bracket(C.name))}).value(),d)},P.prototype.addSuggestionsBasedOnPartialColumnOrMeasure=function(p,T,d){this.addSuggestionsBasedOnPartialColumnOrMeasureCore(p,new ce(T),d),this.userInput=p},P.prototype.addSuggestionsBasedOnColumnAndPartialVariation=function(p,T,d,C){var m=new ce(d);this.addSuggestions(_.chain(m.simpleColumnRefs).filter(function(O){return O.table.variationSource&&V.uI.equalIgnoreCase(O.table.variationSource.name,p)&&P.isMatch(O.name,T)}).map(function(O){return new q.q$(O,V.LP.bracket(O.table.variationSource.name)+"."+V.LP.bracket(O.name),O)}).value(),C),this.userInput=T},P.prototype.addSuggestionsBasedOnPartialEnumValueCore=function(p,T,d){this.addSuggestions(_.chain(T.enumValues).filter(function(C){return P.isMatch(C.name,p)}).map(function(C){return new q.q$(C,C.name)}).value(),d)},P.prototype.addSuggestionsBasedOnPartialCalendarCore=function(p,T,d,C){this.addSuggestions(_.chain(d.calendars).filter(function(m){return P.isMatch(m.name,p)}).map(function(m){if(T)return new q.q$(m,V.LP.quote(m.name));var O=m.name.trim().indexOf(" ")>=0;return new q.q$(m,O?V.LP.quote(m.name):m.name)}).value(),C)},P.prototype.addSuggestionsBasedOnPartialEnumValue=function(p,T,d){this.addSuggestionsBasedOnPartialEnumValueCore(p,new ce(T),d),this.userInput=p},P.prototype.addSuggestionsBasedOnPartialKeywordValue=function(p,T,d){P.isMatch(T,p)&&this.addSuggestions([new q.q$(new H.Z0(T),T.toUpperCase())],d),this.userInput=p},P.prototype.addSuggestionBasedOnParitialAxis=function(p,T,d){var C=T.axes.map(function(O){return O.name}),m=C;C.length>=2&&(m=(0,R.ev)((0,R.ev)([],C,!0),["".concat(C[0]," ").concat(C[1]),"".concat(C[1]," ").concat(C[0])],!1)),this.addSuggestions(_.chain(m).filter(function(O){return P.startsWith(O,p)}).map(function(O){return new q.q$(new H.cr(O),O)}).value(),d)},P.prototype.addSuggestionsBasedOnPartialIdentifier=function(p,T,d){var C=new ce(T);this.addSuggestionsBasedOnPartialTableCore(p,!1,C,d),this.addSuggestionsBasedOnPartialColumnOrMeasureCore(p,C,d),this.addSuggestionsBasedOnPartialEnumValueCore(p,C,d),this.addSuggestionBasedOnParitialAxis(p,C,d),this.addSuggestionsBasedOnPartialCalendarCore(p,!1,C,d),this.addSuggestions(_.chain(C.functions).filter(function(m){return P.isMatch(m.name,p)}).map(function(m){return new q.q$(m,m.name)}).value(),d),this.addSuggestions(_.chain(C.variables).filter(function(m){return P.isMatch(m.name,p)}).map(function(m){return new q.q$(m,m.name)}).value(),d),this.userInput=p},P.prototype.addSuggestionsBasedOnNewToken=function(p,T,d,C){_.some(p.ephemeralContexts)?T!==k.Yl.None.type&&_.some(p.ephemeralContexts,function(O){return V.G.hasFlag(O.allowedTypes,T)})||this.addSuggestionsBasedOnPartialIdentifier("",p,d):C&&this.addSuggestionsBasedOnPartialIdentifier("",p,d)},P.prototype.addSuggestionsBasedOnTableAndPartialColumnOrMeasure=function(p,T,d,C,m){for(var O=new ce(C),A=0,U=O.tablesForQualifiedColumnRefs;A<U.length;A++){var Q=U[A],oe=P.tableToSuggest(Q);V.uI.equalIgnoreCase(oe.name,p)&&this.addSuggestions(Q.columns.filter(function(me){return P.isColumnMatch(me,T)}).map(function(me){return P.buildTableColumnSuggestion(me,d,!1)}),m)}var ne=_.find(O.tablesForMeasures,function(me){return V.uI.equalIgnoreCase(me.name,p)});if(ne){var pe=ne.getAutoCompleteName(d);this.addSuggestions(ne.measures.filter(function(me){return P.isMatch(me.name,T)}).map(function(me){return new q.q$(me,pe+V.LP.bracket(me.name),me)}),m)}this.userInput=T},P.prototype.addSuggestionsBasedOnTableColumnAndPartialVariation=function(p,T,d,C,m,O){for(var A=new ce(m),U=function(Ee){var Ae=Ee.variationSource.table.getAutoCompleteName(C);Q.addSuggestions(Ee.columns.filter(function(w){return P.isMatch(w.name,d)}).map(function(w){return new q.q$(w,Ae+V.LP.bracket(Ee.variationSource.name)+"."+V.LP.bracket(w.name),w)}),O)},Q=this,oe=0,ne=_.filter(A.tablesForQualifiedColumnRefs,function(me){return me.variationSource&&V.uI.equalIgnoreCase(me.variationSource.table.name,p)&&V.uI.equalIgnoreCase(me.variationSource.name,T)});oe<ne.length;oe++)U(ne[oe]);this.userInput=d},P.prototype.addSuggestionsBasedOnPartialVariation=function(p,T,d){var C=new ce(T),m=_.chain(C.newVariations).filter(function(O){return P.isMatch(O.name,p)}).map(function(O){return new q.q$(O,"."+V.LP.bracket(O.name))}).value();_.some(m)&&(this.addSuggestions(m,d),this.userInput=p)},P.prototype.removeDuplicateSuggestionsForSameObject=function(){for(var p=new V.Xy,T=0,d=this.suggestions;T<d.length;T++){var C=d[T],m=C.matchObject;p.containsKey(m)?C.segments.length>p.get(m).segments.length&&p.update(m,C):p.add(m,C)}this._suggestions=p.values()},P.prototype.removeDuplicateSuggestionsBySuggestionText=function(){this._suggestions=V.Sy.distinct(this.suggestions,q.XI.equals)},P.prototype.sortSuggestions=function(){this.suggestions.sort(q.J_)},P.prototype.findBestMatch=function(){var p=this;if(this._bestMatch=-1,_.some(this.suggestions)){for(var T=void 0,d=function(U){if(T=_.find(C.suggestions,function(Q){return Q.segments.length>U&&_.startsWith(Q.segments[U].toUpperCase(),p.userInput.toUpperCase())}))return"break"},C=this,m=0;m<3&&"break"!==d(m);m++);this._bestMatch=0,T&&(this._bestMatch=this.suggestions.indexOf(T))}},P.buildColumnSuggestion=function(p){var T=V.LP.bracket(p.name),d=[p],C=p.table.variationSource;return C&&(T=V.LP.bracket(C.name)+"."+T,d.splice(0,0,C)),p.variationTable?new(q.tA.bind.apply(q.tA,(0,R.ev)([void 0,p,T],d,!1))):new(q.q$.bind.apply(q.q$,(0,R.ev)([void 0,p,T],d,!1)))},P.tableToSuggest=function(p){return p.variationSource?p.variationSource.table:p},P.buildTableColumnSuggestion=function(p,T,d){var C=p.table,m=V.LP.bracket(p.name),O=[p],A=C.variationSource;return A&&(m=V.LP.bracket(A.name)+"."+m,O.splice(0,0,A),C=A.table),m=C.getAutoCompleteName(T)+m,d&&O.splice(0,0,C),p.variationTable?new(q.tA.bind.apply(q.tA,(0,R.ev)([void 0,p,m],O,!1))):new(q.q$.bind.apply(q.q$,(0,R.ev)([void 0,p,m],O,!1)))},P.isColumnMatch=function(p,T){if(P.isMatch(p.name,T))return!0;var d=p.table.variationSource;return!(!d||!P.isMatch(d.name,T))},P.isMatch=function(p,T){return!!(P.startsWith(p,T)||T.length>=2&&p.toUpperCase().indexOf(T.toUpperCase())>=0)},P.startsWith=function(p,T){return _.startsWith(p.toUpperCase(),T.toUpperCase())},P}(),ce=function(){function P(p){this._tables=[],this._tablesForMeasures=[],this._measures=[],this._newVariations=[],this._axes=[],this._calendars=[];var T=!1,d=[],C=[],m=[],O=[],A=0;if(_.some(p.ephemeralContexts))for(var U=0,Q=p.ephemeralContexts;U<Q.length;U++){var oe=Q[U],ne=oe.allowedTypes;(V.G.hasFlag(ne,1)||W.d.featureSwitches.useSkippableParams&&void 0===ne)&&(T=!0),(V.G.hasFlag(ne,2)||V.G.hasFlag(ne,4))&&(this._tables=p.matchObjects.tables.filter(function(pe){return pe.isUserTable}),A|=256),V.G.hasFlag(ne,8)&&(d=d.concat(oe.getTablesInScopeForQualifiedColRefs())),V.G.hasFlag(ne,16)&&(C=C.concat(oe.getSimpleColumnRefsInScope())),V.G.hasFlag(ne,64)&&(m=m.concat(oe.enumValues)),V.G.hasFlag(ne,2)&&(A|=20494,O=O.concat(_.filter(p.variables,function(pe){return pe.value&&pe.value.tableValue}))),V.G.hasFlag(ne,128)&&(A|=16),V.G.hasFlag(ne,256)&&(A|=32),V.G.hasFlag(ne,512)&&(A|=64),V.G.hasFlag(ne,1024)&&(A|=128),V.G.hasFlag(ne,16384)&&(A|=512),V.G.hasFlag(ne,32768)&&(A|=1024),V.G.hasFlag(ne,131072)&&(A|=2048),V.G.hasFlag(ne,8192)&&(this._newVariations=oe.getSimpleColumnRefsInScope()),(V.G.hasFlag(ne,524288)||V.G.hasFlag(ne,65536))&&(this._axes=p.matchObjects.axes),V.G.hasFlag(ne,524288)&&(A|=8192),V.G.hasFlag(ne,1048576)&&(this._calendars=p.matchObjects.calendars)}else T=!0;T&&(d=d.concat(p.getTablesInScopeForQualifiedColRefs()),C=C.concat(p.getSimpleColumnRefsInScope()),O=O.concat(p.variables),this._tablesForMeasures=p.matchObjects.tables.filter(function(pe){return pe.isUserTable}),this._measures=p.matchObjects.measures,A|=20495,A|=256),p.groupByCurrentTable||(A&=-9),this._tablesForQualifiedColumnRefs=d.filter(function(pe){return pe.isUserTable}),this._simpleColumnRefs=C,this._enumValues=m,this._variables=O,this._functions=_.filter(p.matchObjects.functions,function(pe){return!!(pe.role&A)})}return Object.defineProperty(P.prototype,"tables",{get:function(){return this._tables},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"tablesForMeasures",{get:function(){return this._tablesForMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"tablesForQualifiedColumnRefs",{get:function(){return this._tablesForQualifiedColumnRefs},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"simpleColumnRefs",{get:function(){return this._simpleColumnRefs},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"variables",{get:function(){return this._variables},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"measures",{get:function(){return this._measures},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"newVariations",{get:function(){return this._newVariations},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"axes",{get:function(){return this._axes},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"calendars",{get:function(){return this._calendars},enumerable:!1,configurable:!0}),P}(),ye=function(){return function(p,T){this.suggestion=p,this.replaceStart=T}}(),Pe=E(21527);M.j(function(P,p){var T=P.trimEnd();if("]"!==T[T.length-1])return!1;var d=(0,Pe.w)(P,0,void 0,void 0,void 0,!0),C=new I.DH(void 0),m=new ie(void 0,function(){return C});return m.update(d),m.anyErrors?(p.table=void 0,p.column=void 0,!1):C.tryGetTableAndColumnNames(p)});var Me=function(P){return P[P.LegacyDefaultBehavior=0]="LegacyDefaultBehavior",P[P.AddMissingParens=1]="AddMissingParens",P[P.ConvertToEngine=2]="ConvertToEngine",P[P.Anonymize=4]="Anonymize",P}({}),xe=function(P){return P[P.Expression=0]="Expression",P[P.Query=1]="Query",P[P.MultipleQueries=2]="MultipleQueries",P[P.MaskExpressionType=3]="MaskExpressionType",P}({}),je=function(){function P(p){void 0===p&&(p=xe.Expression),this.options=p,this.clearParseState()}return Object.defineProperty(P.prototype,"parseTree",{get:function(){return this._parseTree},enumerable:!1,configurable:!0}),P.findCursorTokens=function(p){var T={iToken:-1,iNewToken:-1,iTokenLeft:-1,iTokenRight:-1,iTokenPrev:-1,iTokenSelection:-1};if(0!==p.cursorActivity){for(var d=p.cursorPosition||0,C=p.parseTokenCount-1;C>=0;C--)if(!(m=p.tokens[C]).ignorable&&(m.startPosition===d?m.length>0?T.iTokenRight=C:((0,z.hu)(60===m.type,"expected newToken"),T.iNewToken=C):m.startPosition+m.length===d&&(T.iTokenLeft=C),m.startPosition<d)){T.iTokenPrev=C;break}var O=p.selectionStart||0;if(O>=0)for(C=p.parseTokenCount-1;C>=0;C--){var m;if(!((m=p.tokens[C]).startPosition>=O)){m.startPosition+m.length>O&&29!==m.type&&(T.iTokenSelection=-1);break}m.ignorable||(T.iTokenSelection=C)}}return T},P.isUnrecognizedIdentifier=function(p){var T=p.token;return(0,z.hu)(T.isAnyKindOfIdentifier,"Expected IsUnrecognizedIdentifier to be called with an identifier node"),!T.matchObject&&!(p.parent instanceof I.qS||p.parent instanceof I.ai)},P.checkSemiselectability=function(p,T,d,C){-1!==d&&(C.semiselectable=_.some(T.getValidLeafNodesAtPosition(d),D.couldBeOperand))},P.updateSuggestions=function(p,T,d,C,m){var O=new he(p,T,d,C);O.buildSuggestions(),m.suggestions=O.suggestions,m.replaceStart=O.replaceStart,m.replaceEnd=O.replaceEnd,m.afterOParen=O.afterOParen,m.afterCParen=O.afterCParen,m.bestMatch=O.bestMatch},P.checkBoldParens=function(p,T,d,C,m){var O;if(-1!==d&&24===p.tokens[d].type?O=_.map(T.getValidLeafNodesAtPosition(d),function(Ee){return Ee.parent}):-1!==C&&23===p.tokens[C].type&&(O=_.map(T.getValidLeafNodesAtPosition(C),function(Ee){return Ee.parent})),O){for(var A,U,Q=0,oe=O;Q<oe.length;Q++){var ne=oe[Q],pe=(0,V.as)(ne,I.U6);if(pe){A=pe.leftParen,U=pe.rightParen;break}var me=ne instanceof I.u0?ne:null;if(me){A=me.leftParen,U=me.rightParen;break}}A&&U&&(m.boldLeftParen=A.token.startPosition,m.boldRightParen=U.token.startPosition)}},P.checkPrototype=function(p,T,d){var C,m;if(-1!==T)for(var O=0,A=p.getValidLeafNodesAtPosition(T);O<A.length;O++){var Q=void 0,oe=void 0;for(oe=(Q=A[O]).parent;oe;Q=oe,oe=oe.parent){var ne=void 0,pe=void 0,me=void 0;if(ne=(0,V.as)(oe,I.fA)){var Ee=ne.getParamIndex(Q);(Se=ne.getParameterByIndex(Ee))&&(C=d.prototypeParamContexts).push.apply(C,Se.context.parameterContexts)}else if((pe=oe instanceof I.u0?oe:void 0)&&(me=pe.functionNode)&&Q!==pe.rightParen){var Ae=pe.leftParen,w=me.token;if(d.prototypeFunctionBase=(0,V.as)(w.matchObject,H.eL),d.prototypePosition=w.startPosition,Q===Ae){var Se=void 0;(ne=pe.parameterList)&&(Se=ne.getParameterByIndex(0)),Se?(m=d.prototypeParamContexts).push.apply(m,Se.context.parameterContexts):d.prototypeParamContexts.push(new H.Go)}if(Q!==me)break}}if(d.prototypeFunctionBase)break}},P.userEditingNode=function(p,T){if(!p.activeCursor)return!1;for(var d=T.token,C=d,m=T.parent;m instanceof I.n1||m instanceof I.DH||m instanceof I.jg||m instanceof I.Fc||m instanceof I.qS;m=m.parent)d=m.firstDescendent.token,C=m.lastDescendent.token;var O=p.cursorPosition||0;return d.startPosition<=O&&O<=C.endPosition},P.updateSyntaxHighlighting=function(p,T){for(var d,C=0;C<p.tokens.length;C++){var m=p.tokens[C];m.isComment?T.comments.push(m.getSegment()):m.isKeyword?T.functions.push(m.getSegment()):30===m.type||31===m.type?T.strings.push(m.getSegment()):33===m.type||35===m.type||39===m.type?T.unrecognizedIdentifiers.push(m.getSegment()):m.isAnyKindOfIdentifier&&(m.matchObject instanceof H.Gs||m.matchObject instanceof H.Z0||m.matchObject instanceof H.it||m.matchObject instanceof H.cr?T.functions.push(m.getSegment()):m.matchObject instanceof H.S2?T.tableReferences.push(m.getSegment()):m.matchObject instanceof H.XN?T.columnReferences.push(m.getSegment()):m.matchObject instanceof H.Cf?T.measureReferences.push(m.getSegment()):m.matchObject instanceof H.yB?T.variables.push(m.getSegment()):C<p.parseTokenCount&&T.unrecognizedIdentifiers.push(m.getSegment()))}(d=T.references).push.apply(d,(0,R.ev)((0,R.ev)((0,R.ev)([],T.tableReferences,!1),T.columnReferences,!1),T.measureReferences,!1))},P.detectErrors=function(p,T,d){for(var C,m=0,O=T.leafPositions;m<O.length;m++){for(var U=void 0,Q=0,oe=O[m].validNodes;Q<oe.length;Q++){var pe=P.errorsAtNode(p,oe[Q],T.context);(!U||pe.length<U.length)&&(U=pe)}U&&(C=d.errors).push.apply(C,U)}},P.errorsAtNode=function(p,T,d){var C=[],m=T.token;if(T instanceof I.IE){if(P.userEditingNode(p,T))switch(m.type){case 60:case 40:return C}return C.push(new te.D(m.getSegment(),te.j.Gramatical)),C}if(P.userEditingNode(p,T)||!T.parent)return C;if(T instanceof I.R6){var O=(0,V.as)(T.parent,I.tw);O&&!O.isInValidLocation&&C.push(new te.D(O.fullSpan,te.j.InvalidTupleLocation))}if(T instanceof I.N9){var U=(0,V.as)(T.parent,I._N).invalidRightArgument;U&&C.push(new te.D(U.fullSpan,te.j.RightArgumentToInOperatorNotValidTable))}if(T instanceof I.gq&&T.parent instanceof I.pZ){var Q=T.parent.measureDef;if(Q?.isComplete){var oe=Q.tableName,ne=Q.identifier,pe=d.matchObjects.measures.find(function(Ie){return!Ie.isQueryScoped&&Ie.name.toLowerCase()===ne?.toLowerCase()});pe&&pe.table.name.toLowerCase()!==oe?.toLowerCase()&&C.push(new te.D(Q.fullSpan,te.j.DuplicateMeasureName))}}if(m.isAnyKindOfIdentifier&&(T.parent instanceof I.xY&&_.some(Object.keys(T.context.matchObjects.reservedWords),function(Ie){return V.uI.equalIgnoreCase(Ie,m.getString())})&&C.push(new te.D(m.getSegment(),te.j.VariableNameReserved)),P.isUnrecognizedIdentifier(T)&&C.push(new te.D(m.getSegment(),te.j.UnrecognizedIdentifier))),37===m.type&&C.push(new te.D(m.getSegment(),te.j.IncompleteNumber)),m.isIdentifierOrKeyword){var me=T.parent instanceof I.u0?T.parent:null;if(me){var Ee=(0,V.as)(m.matchObject,H.eL);if(Ee){var Se=me.parameterList,Ae=function(P,p,T){for(var d=new H.gR,C=P.getParamCount(T),m=P.signatures.map(function(pe){return new H.o(p,pe,T,C,!1)}),O=V.jl.getAllExploredStates(m),Q=0,oe=O.completedStates.concat(O.incompleteStates);Q<oe.length;Q++){var ne=oe[Q];d.assessStatus(ne.actualParam,C,ne.prototypeParam,ne.prototypeSignature)}return d}(Ee,me.context,Se),w=te.j.InvalidParameter;if(!Ae.success){var u=me.rightParen,s=void 0,l=void 0;if(Ae.incomplete)u&&(s=l=u.token,w=te.j.MissingParameters);else if(Ae.badParam>-1){if(Ae.badParam!==Se.parameterCount-1||u){var v=Se.getParameterByIndex(Ae.badParam);if(v){s=v.firstDescendent.token,l=v.lastDescendent.token;var L=Ae.associatedSignature;Ae.badParam<L.length&&(L[Ae.badParam].role===k.Yl.OrderByParam&&(w=te.j.IncorrectOrderByParam),L[Ae.badParam].role===k.Yl.PartitionByParam&&(w=te.j.IncorrectPartitionByParam),L[Ae.badParam].role===k.Yl.MatchByParam&&(w=te.j.IncorrectMatchByParam))}else{var J=Se.getSeparatorByIndex(Ae.badParam+1);J||(J=u),s=l=J.token}}}else Ae.firstExtraParam>-1&&(w=te.j.TooManyParameters,s=(0===Ae.firstExtraParam?Se.firstDescendent:Se.getSeparatorByIndex(Ae.firstExtraParam)).token,l=Se.lastDescendent.token);s&&C.push(new te.D(b.X.fromTokens(s,l),w))}}else C.push(new te.D(m.getSegment(),te.j.FunctionCallOnNonFunction))}var se=(0,V.as)(T.parent,I.qS);if(se)if(V.LP.hasValidAxesReferences(se.axesRef)||se.isValidEnumValue||T!==se.firstIdentifier){if(V.LP.hasValidAxesReferences(se.axesRef)&&T===se.firstIdentifier){var de=se.axesRef,Re=se.firstIdentifier.token,Ne=se.lastIdentifier.token;_.uniqWith(de,H.e$).length!==de.length&&C.push(new te.D(b.X.fromTokens(Re,Ne),te.j.InvalidParameter))}}else for(var Ce=1;Ce<se.children.length;Ce++)C.push(new te.D(se.getIdentifier(Ce).token.getSegment(),te.j.InvalidIdentifier))}return C},P.getResult=function(p,T,d){d=d||{};var C=new ee.b(p.expression,p.cursorActivity,p.cursorPosition,p.selectionStart);if(!d.disableAll){var m=P.findCursorTokens(p);P.checkSemiselectability(p,T,m.iTokenSelection,C),d.disableSuggestions||P.updateSuggestions(p,T,m.iNewToken,m.iTokenLeft,C),P.checkBoldParens(p,T,m.iTokenLeft,m.iTokenRight,C),P.checkPrototype(T,m.iTokenPrev,C),d.disableSyntaxHighlighting||P.updateSyntaxHighlighting(p,C),d.disableErrorDetection||P.detectErrors(p,T,C)}return C},P.prototype.tryBindQualifiedReference=function(p,T){(0,z.hu)(34===p.type,"expected BracketedIdentifier"),(0,z.hu)(T.token===p,"expected BracketedIdentifier");var d=(0,V.as)(T.parent,I.DH);if(d){var O=d.tableRefNode.tableNode.token,A=O.getString();32===O.type&&(A=P.unquote(A));for(var U=P.unbracket(p.getString()),Q=0,oe=_.filter(d.context.getAllTablesInScopeForQualifiedColRefs(),function(Se){return Oe(Se.name,A)});Q<oe.length;Q++){var ne=oe[Q],pe=ne.findColumn(U);if(pe)return O.matchObject=ne,p.matchObject=pe,!0}var me=d.context.matchObjects.findTable(A),Ee=me?.findMeasure(U);return Ee&&(O.matchObject=me,p.matchObject=Ee),!0}return!1},P.prototype.tryBindVariation=function(p,T){(0,z.hu)(34===p.type,"expected brackedIdentifierToken"),(0,z.hu)(T.token===p,"expected brackedIdentifierToken");var d=(0,V.as)(T.parent,I.Fc);if(d){var C=P.unbracket(p.getString()),m=d.variationSource,O=m.token,A=O.matchObject;if(A&&A.variationTable&&(p.matchObject=A.variationTable.findColumn(C)),!p.matchObject){var Q,U=void 0;m.parent instanceof I.DH&&(Q=(U=m.parent.tableRefNode.tableNode.token).getIdentifier());var oe=O.getIdentifier(),ne=_.find(d.context.getAllSimpleColRefsInScope(),function(pe){return!!pe.table.variationSource&&Oe(pe.name,C)&&Oe(pe.table.variationSource.name,oe)&&(!Q||Oe(pe.table.variationSource.table.name,Q))});ne&&(U&&(U.matchObject=ne.table.variationSource.table),O.matchObject=ne.table.variationSource,p.matchObject=ne)}return!0}return!1},P.prototype.bindTokens=function(p,T){for(var d=p.tokens,C=0;C<p.parseTokenCount;C++)this.bindToken(d[C],this._parseTree.getValidLeafNodesAtPosition(C),T)},P.prototype.bindToken=function(p,T,d){if(!p.matchObject)for(var C=function(ne){switch(p.type){case 58:var pe=ne.parent;if(pe instanceof I.qS){if(m.tryBindMultiAxisReference(p,(0,V.as)(pe,I.qS))||m.tryBindMultiEnumValue(p,(0,V.as)(pe,I.qS)))return{value:void 0};break}var me=p.getString();if(p.matchObject=d.findAxis(me))return p.matchObject=new H.cr(me),{value:void 0};var Ee=(0,V.as)(pe,I.rI);if(Ee&&Ee.identifier===ne)return p.matchObject=new H.yB(me,Ee),{value:void 0};if(p.matchObject=d.findFunction(me))return{value:void 0};if(_.includes(Object.keys(d.reservedWords),me))return p.matchObject=new H.Z0(me),{value:void 0};if(p.matchObject=d.findTable(me))return{value:void 0};if(p.matchObject=_.find(ne.context.variables,function(u){return Oe(u.name,me)}))return{value:void 0};var Se=_.flatMap(ne.context.ephemeralContexts,function(u){return u.enumValues}).filter(function(u){return!!u});if(!_.isEmpty(Se)&&(p.matchObject=_.find(Se,function(u){return Oe(u.name,me)})))return{value:void 0};if(p.matchObject=d.findCalendar(me))return{value:void 0};break;case 57:case 46:p.matchObject=d.findFunction(p.getString());break;case 32:var Ae=P.unquote(p.getString());if(p.matchObject=d.findTable(Ae))return{value:void 0};if(p.matchObject=d.findCalendar(Ae))return{value:void 0};break;case 34:if(m.tryBindQualifiedReference(p,ne)||m.tryBindVariation(p,ne))return{value:void 0};var w=P.unbracket(p.getString());if(p.matchObject=_.find(ne.context.getAllSimpleColRefsInScope(),function(u){return Oe(u.name,w)}))return{value:void 0};if(p.matchObject=_.find(d.measures,function(u){return Oe(u.name,w)}))return{value:void 0};break;case 49:case 50:return p.matchObject=new H.Z0(p.getString()),{value:void 0}}},m=this,O=0,A=T;O<A.length;O++){var Q=C(A[O]);if("object"==typeof Q)return Q.value}},P.prototype.tryBindMultiAxisReference=function(p,T){var d=p.getString();return!!(p.matchObject=T.context.matchObjects.findAxis(d))&&(p.matchObject=new H.cr(d),!0)},P.prototype.tryBindMultiEnumValue=function(p,T){var d=p.getString();return!!T.isValidEnumValue&&(p.matchObject=new H.it(d,void 0),!0)},P.prototype.doParse=function(p,T,d,C,m,O){if(void 0===d&&(d=0),void 0===C&&(C=void 0),void 0===m&&(m=void 0),void 0===O&&(O=void 0),T!==this.context&&(this.context=T,this.clearParseState()),p===this.tokenization.expression&&d===this.tokenization.cursorActivity&&C===this.tokenization.cursorPosition&&m===this.tokenization.selectionStart)return O&&(O.tokensMatch=!0),!1;var A=(0,Pe.w)(p,d,C,m,this.tokenization,!0,this.penultimateTokenization);return this._parseTree.update(A),this.hasInvalidatedQueries()&&this.doQueryInvalidations(T,A),this.bindTokens(A,T.matchObjects),O&&(O.tokensMatch=A.tokens.length===this.tokenization.tokens.length&&_.isEqual(_.map(A.tokens,function(U){return U.type}),_.map(this.tokenization.tokens,function(U){return U.type}))),this.penultimateTokenization=this.tokenization,this.tokenization=A,!0},P.prototype.hasInvalidatedQueries=function(){var p=(0,V.as)(this._parseTree.rootNode,I.Vu);if(p)return p.isInvalidated;if(this._parseTree.rootNode instanceof I._7)for(var d=0,C=this._parseTree.rootNode.queries;d<C.length;d++)if(C[d].isInvalidated)return!0;return!1},P.prototype.doQueryInvalidations=function(p,T){this._parseTree.clearAllContexts(),T.tokens.forEach(function(d){return d.matchObject=void 0}),p.matchObjects.clearDefinedMeasures(),p.matchObjects.clearDefinedVariables()},P.prototype.buildParseTree=function(p,T,d,C){void 0===T&&(T=0),void 0===d&&(d=void 0),void 0===C&&(C=void 0),this.context=void 0,this.clearParseState();var m=(0,Pe.w)(p,T,d,C,this.tokenization,!0,this.penultimateTokenization);return this._parseTree.update(m),this._parseTree},P.prototype.parse=function(p,T,d,C,m,O,A){if(0===T)d=void 0,C=void 0;else{if(null==d)throw new Error("cursorPosition is null");if(null==C)throw new Error("selectionStart is null")}if(this.doParse(p,m,T,d,C,A))try{O.result=P.getResult(this.tokenization,this._parseTree)}catch(U){throw U.DaxParserTokenList="["+_.map(this.tokenization.tokens,function(Q){return Q.type}).join()+"]",U}},P.prototype.tryParse=function(p,T,d,C,m,O,A){if(void 0===d&&(d=void 0),void 0===C&&(C=void 0),void 0===m&&(m=0),void 0===O&&(O=void 0),void 0===A&&(A=void 0),0===m)O=void 0,A=void 0;else{if(null==O)throw new Error("cursorPosition is null");if(null==A)throw new Error("selectionStart is null")}if(this.doParse(p,T,m,O,A)){if(!d)return!0;try{return d.result=P.getResult(this.tokenization,this._parseTree,C),!0}catch(U){throw U.DaxParserTokenList="["+_.map(this.tokenization.tokens,function(Q){return Q.type}).join()+"]",U}}return!1},P.prototype.getDescription=function(p){for(var T=0,d=this.tokenization.tokens;T<d.length;T++){var C=d[T];if(C.matchObject&&C.startPosition<=p&&C.endPosition>=p)return C.matchObject.description}},P.prototype.getMeasureReferences=function(p,T,d){if(this.clearParseState(),!this.doParse(p,T))return d.unrecognizedMeasures=!0,[];var C={};d.unrecognizedMeasures=!1;for(var m=0;m<this.tokenization.tokens.length;m++){var O=this.tokenization.tokens[m],A=(0,V.as)(O.matchObject,H.Cf);if(A)C[A.name]=A;else if(34===O.type){var U=this._parseTree.getValidLeafNodesAtPosition(m);_.every(U,function(Q){return P.isUnrecognizedIdentifier(Q)})&&(d.unrecognizedMeasures=!0)}}return _.values(C)},P.prototype.renameReferences=function(p,T,d,C,m){if(this.clearParseState(),!this.doParse(T,d))return T;for(var O="",A=0,U=this.tokenization.tokens;A<U.length;A++){var Q=U[A],oe=void 0;switch(p){case"column":oe=(0,V.as)(Q.matchObject,H.XN);break;case"measure":oe=(0,V.as)(Q.matchObject,H.Cf);break;case"table":oe=(0,V.as)(Q.matchObject,H.S2)}oe&&V.uI.equalIgnoreCase(oe.name,C)?O+=P.delimitIdentifier(Q.type,m,d):O+=Q.getString()}return O},P.prototype.renameMovedMeasureTableReference=function(p,T,d,C,m){if(this.clearParseState(),!this.doParse(p,T))return p;for(var O=0,A=0;A<this.tokenization.tokens.length;A++){var Q=(0,V.as)(this.tokenization.tokens[A].matchObject,H.Cf);if(Q&&V.uI.equalIgnoreCase(Q.name,d))for(var ne=0,pe=this._parseTree.getValidLeafNodesAtPosition(A);ne<pe.length;ne++){var Ee=(0,V.as)(pe[ne].parent,I.DH);if(Ee){var Se=Ee.tableRefNode.tableNode.token,Ae=Se.getSegment(),w=P.delimitIdentifier(Se.type,m,T);p=p.substr(0,O+Ae.startPosition)+w+p.substr(O+Ae.startPosition+Ae.length),O+=w.length-Ae.length;break}}}return p},P.prototype.finalParse=function(p,T,d,C){if(void 0===C&&(C=Me.LegacyDefaultBehavior),this.doParse(p,T),d.finalResult=new Z.s,this._parseTree.anyErrors)d.finalResult.valid=!1;else{var m={expression:p},O=this._parseTree.tryAddClosingParens(!!(C&Me.AddMissingParens),m);d.finalResult.valid=O.result,p=m.expression,d.finalResult.cParensNeeded=O.countParensAdded}C&Me.ConvertToEngine&&(p=P.convertFormatCore(p,this.tokenization,!1)),d.finalResult.updatedExpression=p,C&Me.Anonymize&&(d.finalResult.anonymizedExpression=j.buildAnonymousExpression(this.tokenization,T,P.delimitIdentifier)),this.clearParseState()},P.prototype.clearParseState=function(){var T,p=this;switch(this.penultimateTokenization=void 0,this.tokenization=new K.h("",0),this.options&xe.MaskExpressionType){case xe.Query:T=function(){return new I.Vu(void 0,p.context)};break;case xe.Expression:T=function(){return new I.HV(void 0,p.context)};break;case xe.MultipleQueries:T=function(){return new I._7(void 0,p.context)};break;default:(0,z.sr)("Unknown expression type in option value: "+JSON.stringify(this.options)),T=function(){return new I.HV(void 0,p.context)}}this._parseTree=new ie(this.context,T)},Object.defineProperty(P,"listSeparator",{get:function(){return ve.ft().listSeparator},enumerable:!1,configurable:!0}),Object.defineProperty(P,"decimalSeparator",{get:function(){return ve.ft().numberDecimalSeparator},enumerable:!1,configurable:!0}),P.quoteIfNeeded=function(p,T){return P.quoteNeeded(p,T)?P.quote(p):p},P.quoteNeeded=function(p,T){return V.LP.quoteNeeded(p,T instanceof H.hK?T:function(){return Y.M.isReservedWord(p,T)})},P.quote=function(p){return P.quotePartial(p)+"'"},P.quotePartial=function(p){return"'"+p.replace(/'/g,"''")},P.unquote=function(p){return P.unquotePartial(p.substr(0,p.length-1))},P.unquotePartial=function(p){return p.substr(1).replace(/''/g,"'")},P.DoubleQuote=function(p){return'"'.concat(p.replace(/"/g,'""'),'"')},P.unDoubleQuote=function(p){return p.substr(1,p.length-2).replace(/""/g,'"')},P.bracket=function(p){return P.bracketPartial(p)+"]"},P.bracketPartial=function(p){return"["+p.replace(/\]/g,"]]")},P.delimitIdentifier=function(p,T,d){return P.delimitIdentifierInternal(p,T,function(){return P.quoteIfNeeded(T,d)})},P.delimitIdentifierInternal=function(p,T,d){switch(p){case 32:return P.quote(T);case 33:return P.quotePartial(T);case 34:return P.bracket(T);case 35:return P.bracketPartial(T);default:return(0,z.hu)(58===p,"expected identifier type"),d()}},P.unbracket=function(p){return P.unbracketPartial(p.substr(0,p.length-1))},P.unbracketPartial=function(p){return p.substr(1).replace(/\]\]/g,"]")},P.isFormulaTranslationNeeded=function(){return"."!==P.decimalSeparator||","!==P.listSeparator},P.convertFormat=function(p,T){return P.convertFormatCore(p,void 0,T)},P.convertFormatCore=function(p,T,d){var C=","!==P.listSeparator,m="."!==P.decimalSeparator,A=!d&&-1!==p.indexOf("\xa0");if(C||m||A){var U="";T||(T=(0,Pe.w)(p,0,void 0,void 0,void 0,!d));var Q=void 0,oe=void 0,ne=void 0;d?(Q=P.listSeparator,oe=".",ne=P.decimalSeparator):(Q=",",oe=P.decimalSeparator,ne=".");for(var pe=0,me=0,Ee=T.tokens;me<Ee.length;me++){var Se=Ee[me],Ae=Se.getString(),w=Ae;switch(Se.offsetPosition(pe),Se.type){case 27:C&&(w=Q);break;case 36:m&&(w=Ae.replace(oe,ne));break;case 29:A&&(w=Ae.replace("\xa0"," "))}pe+=w.length-Ae.length,U+=w}p=U,T.tokens.forEach(function(u){return u.attachToNewExpression(p)})}return p},P.convertToUI=function(p){return P.convertFormat(p,!0)},P.convertToEngine=function(p){return P.convertFormat(p,!1)},P}();function Oe(P,p){return V.uI.equalIgnoreCase(P,p)}},40546:function(Ke,we,E){E.d(we,{d:function(){return z}});var R=E(81337),z=function(){function H(){}return Object.defineProperty(H,"featureSwitches",{get:function(){return H._featureSwitches},enumerable:!1,configurable:!0}),H.setFeatureSwitches=function(V){H._featureSwitches=(0,R.pi)((0,R.pi)({},this._featureSwitches),V)},H._featureSwitches={useSkippableParams:!1,suggestKeywords:!0,includeUndefinedOptionalFunctionParameters:!1,resetSuggestWidgetStateBeforeCompletion:!0,addTriviaToParseNodeMetadata:!0,useParseTreeFormatting:!1,customCalendars:!1},H}()},95792:function(Ke,we,E){E.d(we,{BY:function(){return je},Gz:function(){return Pe},K2:function(){return ce},Mk:function(){return he},Mn:function(){return q},O5:function(){return ve},Sm:function(){return Me},kD:function(){return ye},ub:function(){return xe}});var R=E(3371),z=E(58871),H=E(68706),V=E(42165),j=E(74104),M=E(63513),Z=/=|:=/,te=new RegExp("^"+j.co+"$"),ee=new RegExp("^"+j.jZ),W=new RegExp("^:$"),i=["]","["],K=/\t|\n|\r/g,y=[" ","\t","\n","\r"],ie=[" ","\t"];function ve(re,P){return D(re,!1,P)}function D(re,P,p,T){var d={name:null,formula:null,formulaStart:-1,errors:[]};try{var C=M.uI.trimStart(re=re||"",y),m=ge(C,te);if(m&&m[0].length===C.length)return d.name=p?m[0]:M.LP.unbracketPartial(m[0]),d;var O=ge(C,ee);O&&(d.name=p?O[0]:M.LP.unbracket(O[0]),C=M.uI.trimStart(C.substr(O[0].length),y));var A=Z.exec(C);if(null==A&&T)return d.name="",d.formula=P?M.uI.trimStart(re,ie):re,d.formulaStart=0,d;var U=M.uI.trimEnd(A?C.substr(0,A.index):C,y);if(null==d.name){var Q=M.uI.indexOfAny(U,i);if(-1===Q)d.name=U;else{d.name=U.substr(0,Q);var oe=re.length-C.length;do{d.errors.push(new H.D(new V.X(re,oe+Q,1),H.j.InvalidNameCharacter)),Q=M.uI.indexOfAny(U,i,Q+1)}while(-1!==Q)}}else if(!M.uI.isNullOrEmpty(U)){var ne=ge(U,W);!A&&ne&&ne[0].length===U.length||d.errors.push(new H.D(new V.X(re,re.length-C.length,U.length),H.j.CantSeparateFormulaNameAndExpression))}if(!A)return d;C=C.substr(A.index+A[0].length),P&&(C=M.uI.trimStart(C,ie)),d.formula=C,d.formulaStart=re.length-C.length}finally{d.name=d.name.replace(K,"")}return d}function q(re,P,p){var T=function(re,P){var p=D(re,!0,!1,P),T={name:p.name,formula:p.formula,invalidFormula:void 0};return p.errors.length>0||null==p.formula?(T.formula="",T.invalidFormula=re):T.invalidFormula=null,T}(re,p);return P.name=T.name,P.expression=T.formula,null==T.invalidFormula}function he(re,P){return function(re){return M.uI.trim(re,y)!==re||-1!==M.uI.indexOfAny(re,i)||!!Z.exec(re)}(re)&&(re=M.LP.bracket(re)),"".concat(re," = ").concat(P)}function ce(re,P,p,T){var d={matchObjects:null};R.M.populateAll(re,P,d);var C=d.matchObjects;T&&C.chooseFunctions(function(U){return M.G.hasFlag(U.pushableToDirectQuery,1)});var m=new z.hK(C),O=C.findTable(p.table.name);O&&(m.currentTable=O.uberTable);var A=new z.hK(m,!1);return A.currentTable=null,A}function ye(re,P,p,T){var d={matchObjects:null};R.M.populateAll(re,P,d);var C=d.matchObjects;T&&C.chooseFunctions(function(Q){return M.G.hasFlag(Q.pushableToDirectQuery,1)});var m=new z.hK(C),O=C.findTable(p.table.name);if(O){var A=O.findMeasure(p.name);A&&(C.hideMeasure(A),O.hideMeasure(A)),m.currentTable=O.uberTable}var U=new z.hK(m,!1);return U.currentTable=null,U}function Pe(re,P,p,T){var d={matchObjects:null};R.M.populateAll(re,P,d);var C=d.matchObjects;T&&C.chooseFunctions(function(U){return M.G.hasFlag(U.pushableToDirectQuery,2)});var m=new z.hK(d.matchObjects),O=C.findTable(p.table.name);if(O){var A=O.findColumn(p.name);A&&(C.hideColumn(A),O.hideColumn(A)),m.currentTable=O.uberTable}return m}function Me(re,P,p){var T={matchObjects:null};R.M.populateAll(re,P,T);var d=T.matchObjects,C=new z.hK(d),m=d.findTable(p.name);return m&&(C.currentTable=m.uberTable),C}function xe(re,P,p){var T={matchObjects:null};R.M.populateAll(re,P,T);var d=T.matchObjects,C=new z.hK(d);C.ephemeralContexts.push(new z.xE(C,null,{type:2},null));var m=d.findTable(p.name);return m&&d.hideTable(m),C}function je(re,P){var p={matchObjects:null};return R.M.populateAll(re,P,p),new z.hK(p.matchObjects)}function ge(re,P){var p=P.exec(re);if(p&&0===p.index)return p}},20540:function(Ke,we,E){E.d(we,{R:function(){return R}});var R=function(z){return z[z.Yum=0]="Yum",z[z.NotHungry=1]="NotHungry",z[z.Yuck=2]="Yuck",z}({})},79232:function(Ke,we,E){E.d(we,{A3:function(){return oe},AP:function(){return ne},Bw:function(){return b},E8:function(){return C},EF:function(){return U},Ex:function(){return p},FY:function(){return W},Ht:function(){return m},JQ:function(){return I},M0:function(){return ve},M5:function(){return Pe},ME:function(){return d},NB:function(){return he},Nw:function(){return ce},PH:function(){return ee},PY:function(){return i},S7:function(){return O},Sx:function(){return ie},T8:function(){return xe},TG:function(){return y},UE:function(){return Ae},Wt:function(){return Y},Ym:function(){return k},ZO:function(){return ge},ZQ:function(){return ye},_H:function(){return re},aN:function(){return Z},bM:function(){return Oe},dG:function(){return T},mO:function(){return Q},qo:function(){return A},sC:function(){return je},sW:function(){return Me},tR:function(){return P},w1:function(){return te},wV:function(){return D},zA:function(){return q}});var R=E(81337),z=E(55863),H=E(58871),V=E(63513),j=function(){function w(){}return w.prototype.toTraceString=function(){return this.toString(!0)},w.prototype.toString=function(u){void 0===u&&(u=!1);try{var s=new Ae(u);return this.accept(s)}catch(l){if(u)return l.ToString()}},w.Comparer={equals:function(s,l){return s.toLowerCase()===l.toLowerCase()}},w}(),M=function(w){function u(s,l){var v=w.call(this)||this;return v.left=s,v.right=l,(0,z.mv)(s,"left expression should not be null"),(0,z.mv)(l,"right expression should not be null"),v}return(0,R.ZT)(u,w),u.prototype.equals=function(s){return null!=s&&s instanceof u&&this.left.equals(s.left)&&this.right.equals(s.right)&&this.equalsCore(s)},u}(j),k=function(w){function u(s,l,v){var L=w.call(this,l,v)||this;return L.comparison=s,L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitComparison(this,l)},u.prototype.equalsCore=function(s){return s instanceof u&&this.comparison===s.comparison},u}(M),Y=function(w){function u(s,l,v){var L=w.call(this,l,v)||this;return L.operator=s,L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitLogicalOperation(this,l)},u.prototype.equalsCore=function(s){return s instanceof u&&this.operator===s.operator},u}(M),Z=function(w){function u(s,l,v){var L=w.call(this,l,v)||this;return L.operation=s,L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitArithmetic(this,l)},u.prototype.equalsCore=function(s){return s instanceof u&&this.operation===s.operation},u}(M),I=function(w){function u(s){var l=w.call(this)||this;return l.value=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitDateTimeLiteral(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.value===s.value},u}(j),te=function(w){function u(s,l){var v=w.call(this)||this;return v.value=s,v.type=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitConstantScalar(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.value===s.value&&this.type===s.type},u}(j),ee=function(w){function u(s){var l=w.call(this)||this;return l.expression=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitNot(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.expression.equals(s.expression)},u}(j),W=function(w){function u(s){var l=w.call(this)||this;return l.expression=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitNegation(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.expression.equals(s.expression)},u}(j),i=function(w){function u(s){for(var l=[],v=1;v<arguments.length;v++)l[v-1]=arguments[v];var L=w.call(this)||this;return L.functionName=s,L.parameters=l,L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitFunction(this,l)},u.prototype.equals=function(s){if(!(s instanceof u&&j.Comparer.equals(this.functionName,s.functionName)&&this.parameters.length===s.parameters.length))return!1;for(var l=0;l<this.parameters.length;l++)if(!this.parameters[l].equals(s.parameters[l]))return!1;return!0},u}(j),K=function(w){function u(s){var l=w.call(this)||this;return l.tableName=s,l}return(0,R.ZT)(u,w),u}(j),y=function(w){function u(s){var l=w.call(this,s)||this;return l.tableName=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitTableReference(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.tableName,s.tableName)},u}(K),ie=function(w){function u(s,l){var v=w.call(this,s)||this;return v.tableName=s,v.propertyName=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitColumnReference(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.tableName,s.tableName)&&j.Comparer.equals(this.propertyName,s.propertyName)},u}(K),ve=function(w){function u(s,l){var v=w.call(this,s)||this;return v.propertyName=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitMeasureReference(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.tableName,s.tableName)&&j.Comparer.equals(this.propertyName,s.propertyName)},u}(K),D=function(w){function u(s,l){return w.call(this,s,l)||this}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitTextConcatenation(this,l)},u.prototype.equalsCore=function(s){return s instanceof u},u}(M),b=function(w){function u(s,l){return w.call(this,s,l)||this}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitIn(this,l)},u.prototype.equalsCore=function(s){return s instanceof u},u}(M),q=function(w){function u(s){var l=w.call(this)||this;return l.items=s,(0,z.mv)(l.items,"items should not be null"),l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitRowConstructor(this,l)},u.prototype.equals=function(s){if(!(s instanceof u)||this.items.length!==s.items.length)return!1;for(var l=0;l<this.items.length;l++)if(!this.items[l].equals(s.items[l]))return!1;return!0},u}(j),he=function(w){function u(s){var l=w.call(this)||this;return l.rows=s,(0,z.mv)(l.rows,"rows should not be null"),l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitTableConstructor(this,l)},u.prototype.equals=function(s){if(!(s instanceof u)||this.rows.length!==s.rows.length)return!1;for(var l=0;l<this.rows.length;l++)if(!this.rows[l].equals(s.rows[l]))return!1;return!0},u.empty=new u([]),u}(j),ce=function(w){function u(s,l){var v=w.call(this)||this;return v.name=s,v.definition=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitMeasureExpression(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.name.equals(s.name)&&this.definition.equals(s.definition)},u}(j),ye=function(w){return w.Asc="ASC",w.Desc="DESC",w.True="TRUE",w.False="FALSE",w}({}),Pe=function(w){function u(s){var l=w.call(this)||this;return l.value=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitKeyword(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.value===s.value},u.Asc=new u(ye.Asc),u.Desc=new u(ye.Desc),u.True=new u(ye.True),u.False=new u(ye.False),u}(j),Me=function(w){function u(s){var l=w.call(this)||this;return l.axis=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitAxis(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.axis===s.axis},u}(j),xe=function(w){function u(s){var l=w.call(this)||this;return l.expressions=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitMultiIdentifier(this,l)},u.prototype.equals=function(s){if(!(s instanceof u)||this.expressions.length!==s.expressions.length)return!1;for(var l=this.expressions.length,v=0;v<l;v++)if(!this.expressions[v].equals(s.expressions[v]))return!1;return!0},u}(j),je=function(w){function u(s){var l=w.call(this)||this;return l.value=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitEnum(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.value===s.value},u}(j),ge=function(w){function u(){return w.call(this)||this}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitOmittedArgument(this,l)},u.prototype.equals=function(s){return this===s},u.instance=new u,u}(j),Oe=function(w){function u(s){var l=w.call(this)||this;return(0,z.mv)(s,"nodeOrExpressionText should be defined"),l.expressionText=s instanceof H.$Y?s.fullSpan.text:s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitUnknown(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.expressionText,s.expressionText)},u}(j),re=function(w){function u(s,l){var v=w.call(this)||this;return v.name=s,v.definition=l,(0,z.hu)(!V.uI.isNullOrEmpty(s),"name should not be null or empty"),(0,z.mv)(l,"definition should not be null"),v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitVariableDefinition(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.name,s.name)&&this.definition.equals(s.definition)},u}(j),P=function(w){function u(s,l){var v=w.call(this)||this;return v.variables=s,v.returnExpression=l,(0,z.mv)(s,"variables should not be null"),(0,z.mv)(l,"returnExpression should not be null"),v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitVarReturn(this,l)},u.prototype.equals=function(s){if(!(s instanceof u&&this.variables.length===s.variables.length&&this.returnExpression.equals(s.returnExpression)))return!1;for(var l=0;l<this.variables.length;l++)if(!this.variables[l].equals(s.variables[l]))return!1;return!0},u}(j),p=function(w){function u(s){var l=w.call(this)||this;return l.name=s,(0,z.hu)(!V.uI.isNullOrEmpty(s),"name should not be null or empty"),l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitVariableReference(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.name,s.name)},u}(j),T=function(w){function u(s,l,v){var L=w.call(this)||this;return L.tableName=s,L.variationSourceName=l,L.targetPropertyName=v,(0,z.mv)(l,"variationSourceName should not be null"),(0,z.mv)(v,"targetPropertyName should not be null"),L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitVariationColumnReference(this,l)},u.prototype.equals=function(s){return s instanceof u&&j.Comparer.equals(this.tableName,s.tableName)&&j.Comparer.equals(this.variationSourceName,s.variationSourceName)&&j.Comparer.equals(this.targetPropertyName,s.targetPropertyName)},u}(j),d=function(w){function u(s){var l=w.call(this)||this;return l.values=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitStartAt(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.values.length===s.values.length&&this.values.every(function(l,v){return l.equals(s.values[v])})},u}(j),C=function(w){function u(s,l){var v=w.call(this)||this;return v.clause=s,v.direction=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitSort(this,l)},u.prototype.equals=function(s){return!!(s instanceof u&&this.clause.equals(s.clause))&&(!this.direction||!!s.direction&&this.direction.equals(s.direction))},u}(j),m=function(w){function u(s,l){var v=w.call(this)||this;return v.sortClauses=s,v.startAt=l,v}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitOrderBy(this,l)},u.prototype.equals=function(s){if(!(s instanceof u)||this.sortClauses.length!==s.sortClauses.length)return!1;for(var l=0;l<this.sortClauses.length;l++)if(!this.sortClauses[l].equals(s.sortClauses[l]))return!1;return!this.startAt||!!s.startAt&&this.startAt.equals(s.startAt)},u}(j),O=function(w){function u(s,l,v){var L=w.call(this)||this;return L.definitions=s,L.evaluate=l,L.orderBy=v,L}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitQuery(this,l)},u.prototype.equals=function(s){var l,v;if(!(s instanceof u)||(null===(l=this.definitions)||void 0===l?void 0:l.length)!==(null===(v=s.definitions)||void 0===v?void 0:v.length))return!1;for(var L=0;L<this.definitions.length;L++)if(!this.definitions[L].equals(s.definitions[L]))return!1;return!!this.evaluate.equals(s.evaluate)&&(!this.orderBy||!!s.orderBy&&this.orderBy.equals(s.orderBy))},u}(j),A=function(w){function u(s){var l=w.call(this)||this;return l.queries=s,l}return(0,R.ZT)(u,w),u.prototype.accept=function(s,l){return s.visitQueries(this,l)},u.prototype.equals=function(s){return s instanceof u&&this.queries.length===s.queries.length&&this.queries.every(function(l,v){return l.equals(s.queries[v])})},u}(j),U=function(w){return w[w.Add=0]="Add",w[w.Subtract=1]="Subtract",w[w.Multiply=2]="Multiply",w[w.Divide=3]="Divide",w[w.Power=4]="Power",w}({}),Q=function(w){return w[w.EqualTo=0]="EqualTo",w[w.StrictEqualTo=1]="StrictEqualTo",w[w.GreaterThan=2]="GreaterThan",w[w.LessThan=3]="LessThan",w[w.GreaterThanEqualTo=4]="GreaterThanEqualTo",w[w.LessThanEqualTo=5]="LessThanEqualTo",w[w.NotEqualTo=6]="NotEqualTo",w}({}),oe=function(w){return w[w.And=0]="And",w[w.Or=1]="Or",w}({}),ne=function(w){return w[w.String=0]="String",w[w.Number=1]="Number",w}({});function Ee(w){switch(w){case ne.Number:return"Number";case ne.String:return"String"}return(0,z.vE)("uexpected ConstantDataType ".concat(w))}var Ae=function(){function w(u){this.traceString=u}return w.prototype.visitStartAt=function(u,s){var l=this,v="";return u.values.length>0&&(v="START AT ",v+=u.values.map(function(L){return L.accept(l,s)}).join(", ")),v},w.prototype.visitSort=function(u,s){return"".concat(u.clause.accept(this,s)).concat(u.direction?" "+u.direction.accept(this,s):"")},w.prototype.visitOrderBy=function(u,s){var l=this,v="";return u.sortClauses.length>0&&(v="ORDER BY\n",v+="    "+u.sortClauses.map(function(L){return L.accept(l,s)}).join(", "),u.startAt&&(v+="\n"+u.startAt.accept(this,s))),v},w.prototype.visitMeasureExpression=function(u,s){return"MEASURE ".concat(u.name," = ").concat(u.definition.accept(this,s))},w.prototype.visitVariableDefinition=function(u,s){return"VAR ".concat(u.name," = ").concat(u.definition.accept(this,s))},w.prototype.visitQuery=function(u,s){var l=this,v="";u.definitions.length>0&&(v="DEFINE\n",v+=u.definitions.map(function(fe){return"    "+fe.accept(l,s)}).join("\n"),v+="\n");var L="EVALUATE ".concat(u.evaluate.accept(this,s),"\n"),J=u.orderBy?"".concat(u.orderBy.accept(this,s),"\n"):"";return"".concat(v).concat(L).concat(J)},w.prototype.visitQueries=function(u,s){var l=this;return u.queries.map(function(v){return v.accept(l,s)}).join("\n\n")},w.prototype.visitAxis=function(u,s){return u.axis},w.prototype.visitMultiIdentifier=function(u,s){for(var l="",v=0,L=u.expressions;v<L.length;v++)l+=this.visitExpression(L[v]);return l},w.prototype.visitEnum=function(u,s){return u.value},w.prototype.visitArithmetic=function(u){return this.visitBinaryExpression(u,function(w){switch(w){case U.Add:return"+";case U.Divide:return"/";case U.Multiply:return"*";case U.Power:return"^";case U.Subtract:return"-"}return(0,z.vE)("unexpected operator ".concat(w))}(u.operation))},w.prototype.visitConstantScalar=function(u){if(this.traceString)return"{".concat(Ee(u.type),"}");switch(u.type){case ne.String:return V.LP.doubleQuote(u.value);case ne.Number:return u.value;default:(0,z.sr)("Unsupported node of type ".concat(Ee(u.type)))}},w.prototype.visitDateTimeLiteral=function(u,s){return u.value},w.prototype.visitComparison=function(u){return this.visitBinaryExpression(u,function(w){switch(w){case Q.EqualTo:return"=";case Q.StrictEqualTo:return"==";case Q.NotEqualTo:return"<>";case Q.GreaterThan:return">";case Q.GreaterThanEqualTo:return">=";case Q.LessThan:return"<";case Q.LessThanEqualTo:return"<="}return(0,z.vE)("unexpected comparison operator ".concat(w))}(u.comparison))},w.prototype.visitNegation=function(u){return"-".concat(this.visitExpression(u.expression))},w.prototype.visitNot=function(u){return"NOT(".concat(u.expression.toString(this.traceString),")")},w.prototype.visitFunction=function(u){var s=this,l=u.parameters.map(function(v){return s.visitExpression(v)}).join(", ");return"".concat(u.functionName,"(").concat(l,")")},w.prototype.visitTableReference=function(u){return this.traceString?"Table":V.LP.quote(u.tableName)},w.prototype.visitColumnReference=function(u){return this.traceString?"Table[Column]":"".concat(V.LP.quote(u.tableName)).concat(V.LP.bracket(u.propertyName))},w.prototype.visitMeasureReference=function(u){return this.traceString?"[Measure]":"".concat(V.LP.quote(u.tableName)).concat(V.LP.bracket(u.propertyName))},w.prototype.visitLogicalOperation=function(u){return this.visitBinaryExpression(u,function(w){switch(w){case oe.And:return"&&";case oe.Or:return"||"}return(0,z.vE)("unexpected logical operator ".concat(w))}(u.operator))},w.prototype.visitIn=function(u){return this.visitBinaryExpression(u,"IN")},w.prototype.visitTextConcatenation=function(u){return this.visitBinaryExpression(u,"&")},w.prototype.visitRowConstructor=function(u){var s=this,l=u.items.map(function(v){return v.toString(s.traceString)}).join(", ");return"(".concat(l,")")},w.prototype.visitTableConstructor=function(u){var s=this,l=u.rows.map(function(v){return v.toString(s.traceString)}).join(", ");return"{".concat(l,"}")},w.prototype.visitKeyword=function(u){return u.value.toString().toUpperCase()},w.prototype.visitOmittedArgument=function(u){return""},w.prototype.visitUnknown=function(u){return this.traceString?"{Unknown}":u.expressionText},w.prototype.visitVarReturn=function(u){var s=this,l=u.variables.map(function(v){return"VAR ".concat(s.traceString?"__X":v.name," = ").concat(s.visitExpression(v.definition))}).join(" ");return"".concat(l," RETURN ").concat(this.visitExpression(u.returnExpression))},w.prototype.visitVariableReference=function(u){return this.traceString?"__X":u.name},w.prototype.visitVariationColumnReference=function(u){return this.traceString?"Table[VariationSource].[Column]":"".concat(V.LP.quote(u.tableName)).concat(V.LP.bracket(u.variationSourceName),".").concat(V.LP.bracket(u.targetPropertyName))},w.prototype.visitBinaryExpression=function(u,s){var l=this.getExpressionType(u),v=this.getExpressionType(u.left),L=this.getExpressionType(u.right),J=!1,fe=!1;0===v&&(J=!0),0===L&&(fe=!0);var se=this.getPrecedence(l);if(J||13===v||se<this.getPrecedence(v)&&(J=!0),!fe&&13!==L){var de=this.getPrecedence(L);(se<de||se===de&&!this.canCombine(l,L))&&(fe=!0)}return"".concat(this.visitExpression(u.left,J)," ").concat(s," ").concat(this.visitExpression(u.right,fe))},w.prototype.visitExpression=function(u,s){void 0===s&&(s=!1);var l="";return s&&(l+="("),l+=u.accept(this),s&&(l+=")"),l},w.prototype.getPrecedence=function(u){switch(u){case 1:return 0;case 2:return 1;case 3:case 4:return 2;case 6:case 7:return 3;case 8:return 4;case 12:case 9:return 5;case 5:return 6;case 10:return 7;case 11:return 8;default:(0,z.vE)("Unsuppored expression type ".concat(u))}},w.prototype.getExpressionType=function(u){if(u instanceof Oe)return 0;if(u instanceof W)return 2;if(u instanceof ee)return 5;if(u instanceof D)return 8;if(u instanceof b)return 12;if(u instanceof Z)switch(u.operation){case U.Power:return 1;case U.Multiply:return 3;case U.Divide:return 4;case U.Add:return 6;case U.Subtract:return 7;default:(0,z.vE)("Unsupported arithmetic operation ".concat(u.operation))}if(u instanceof k)return 9;if(u instanceof Y)switch(u.operator){case oe.And:return 10;case oe.Or:return 11;default:(0,z.vE)("Unsupported binary logical operator ".concat(u.operator))}return 13},w.prototype.canCombine=function(u,s){return 6===u&&6===s||3===u&&3===s||10===u&&10===s||11===u&&11===s},w}()},98277:function(Ke,we,E){E.d(we,{r:function(){return Y}});var Y,R=E(81337),z=E(55863),H=E(40546),V=E(58871),j=E(85616),M=E(79232),k=E(59458);!function(ie){var ve;function b(d){var C=d,m=function(d){for(;null!=d&&1===d.children.length&&d instanceof j._L;){if(!(d.isComplete&&d.children[0]instanceof V.sN)){d=void 0;break}d=d.children[0]}return d}(C);if(null==m)return new M.bM(C);if(1===C.children.length&&C instanceof j.q1){if(C.valid){var A=C.children[0];return A.valid?A instanceof j._L||A instanceof j.q1?b(A):q(A):new M.bM(m)}return new M.bM(m)}if(null!=m&&m instanceof j.ze){for(var Q=0,oe=m.children;Q<oe.length;Q++){var ne=oe[Q];if(!(ne instanceof j._L)||ne.isComplete)return q(ne)}return new M.bM(m)}return q(m)}function q(d){if((0,k.hI)(ve)&&d instanceof j.Ti){if(d.children.length>=2){for(var C=!1,m=0;m<d.children.length-1;m++)44===d.children[0].token.type&&(C=!C);var A=b(d.children[d.children.length-1]);return C?new M.PH(A):A}return new M.bM(d)}if(d instanceof j.Hf)return M.M5.Asc;if(d instanceof j.QB)return M.M5.Desc;if(d instanceof j.a$){var U=d.children.length;if(U>=3){if(d instanceof j.gi||d instanceof j.RZ||d instanceof j.Ed)return he(d.children,U-1,Z);if((0,k.V0)(ve)&&d instanceof j.F0)return he(d.children,U-1,I);if((0,k.Tk)(ve)&&d instanceof j.HV)return he(d.children,U-1,te);if((0,k.pi)(ve)&&d instanceof j.IS)return he(d.children,U-1,ee)}return new M.bM(d)}if(d instanceof j.gR){if(d.children.length>=2){var Q=1;for(m=0;m<d.children.length-1;m++)20===d.children[m].token.type&&(Q*=-1);return Me(A=b(d.children[d.children.length-1]),Q)}return new M.bM(d)}if(d instanceof j.U6)return 3===d.children.length?b(d.children[1]):new M.bM(d);if(d instanceof j.DU){if(d.children.length>=3){var ne=d.children[0].token.getString(),pe=[];if(d.children[2]instanceof j.fA){var me=d.children[2];if(me.parameterCount>0){pe=new Array(me.parameterCount);var Se=H.d.featureSwitches.includeUndefinedOptionalFunctionParameters?me.allParametersIncludingUndefined:me.parameters;for(m=0;m<me.parameterCount;m++)pe[m]=null!=Se[m]?b(Se[m]):M.ZO.instance}}return new(M.PY.bind.apply(M.PY,(0,R.ev)([void 0,ne],pe,!1)))}return new M.bM(d)}if(d instanceof j.DH){var w=d;return w.qualifiedColumnRef?new M.Sx(w.qualifiedColumnRef.table.name,d.qualifiedColumnRef.name):w.bracketedIdentifier&&w.tableRefNode?p(w):new M.bM(d)}if(d instanceof j.Fc){var u=d.variationSource;if(null!=u&&null!=u.simpleColumnRef){var s=u.simpleColumnRef.table.name,l=u.simpleColumnRef.name;if(null!=d.qualifiedColumnRef)return new M.dG(s,l,d.qualifiedColumnRef.name);if(null!=d.simpleColumnRef)return new M.dG(s,l,d.simpleColumnRef.name)}return new M.bM(d)}if(d instanceof j.TV||d instanceof j.T0||d instanceof j.eV)return p(d);if(d instanceof j.qS)return function(d){for(var C=[],m=0,O=d.children;m<O.length;m++){var U=p(O[m]);U&&C.push(U)}return new M.T8(C)}(d);if(d instanceof j.uA)return new M.JQ(d.token.getString());if(d instanceof j.vX)return new M.w1(d.token.getString(),M.AP.Number);if(d instanceof j.XN)return new M.w1(d.string,M.AP.String);if((0,k.hI)(ve)&&d instanceof j.Cm)return function(d){var C=d.children.length;if(!d.isComplete||C<3||!(d.children[C-2]instanceof j.y3))return new M.bM(d);for(var m=new Array(C-2),O=0;O<C-2;O++){var A=d.children[O];if(null==A)return new M.bM(d);var U=ye(A);if(!U)return new M.bM(d);m[O]=U}return new M.tR(m,b(d.children[C-1]))}(d);if((0,k.A3)(ve)){if(d instanceof j._N)return d.children.length>=3&&d.children[1]instanceof j.N9?he(d.children,d.children.length-1,W):new M.bM(d);if(d instanceof j.tw){var v=d.children,L=[];for(m=1;m<v.length-1;m++)v[m]instanceof j.ZH||L.push(b(v[m]));return new M.zA(L)}if(d instanceof j.lg){var J=function(d){var C=d.children,m=C.length;if(!(m<2)&&C[0]instanceof j.HI&&C[m-1]instanceof j.yE){if(2===m)return M.NB.empty;for(var O=[],A=1;A<m-1;A++)if(!(C[A]instanceof j.ZH)){var U=b(C[A]);O.push(U instanceof M.zA?U:new M.zA([U]))}return new M.NB(O)}}(d);return J??new M.bM(d)}}if((0,k.XD)(ve)&&d instanceof j.mR&&1===d.children.length){var fe=d.children[0];if(fe instanceof j.Hf)return M.M5.Asc;if(fe instanceof j.QB)return M.M5.Desc}if(d instanceof j.ZQ)return b(d.children[0]);if(d instanceof j.Lj){var se=b(d.children[0]),Ce=void 0;return d.children[1]instanceof j.et&&(Ce=b(d.children[1])),new M.E8(se,Ce)}return new M.bM(d)}function he(d,C,m){if(C<0)return new M.bM(d[0]);if(0===C)return b(d[C]);var O=he(d,C-2,m);return m(d[C-1],O,b(d[C]))}function ye(d){if(d.isComplete&&!(d.children.length<4)&&d.children[0]instanceof j.fY&&d.children[2]instanceof j.sB){var m=d.children[1];if(m instanceof j.TV){var O=m.token.matchObject;if(O instanceof V.yB)return new M._H(O.name,b(d.children[3]))}}}function Me(d,C){return d instanceof M.FY?Me(d.expression,-1*C):C<0?new M.FY(d):d}function ge(d){var C=d.children;if(d.isComplete&&!(C.length<4)&&C[0]instanceof j.gq&&C[1]instanceof j.ai&&C[2]instanceof j.sB&&C[3]instanceof j.ZQ){var O=p(C[1]),A=b(C[3]);return new M.Nw(O,A)}}function Oe(d){if(!d.isComplete)return new M.bM(d);var O,A,C=d.children,m=[],U=0;if(C[U]instanceof j.N4){for(var oe=0,ne=C[U].children;oe<ne.length;oe++){var pe=ne[oe];if(pe instanceof j.pZ){var me=ge(pe);if(!me)return new M.bM(d);m.push(me)}else if(pe instanceof j.dl){var Ee=ye(pe);if(!Ee)return new M.bM(d);m.push(Ee)}}U++}return C[U]instanceof j.yC&&C[++U]instanceof j.ZQ?(O=b(C[U]),C[++U]instanceof j.rc&&!(A=function(d){var C=d.children,m=C.length;if(!(m<3)){for(var U,O=[],A=2;A<m&&!(C[A]instanceof j.ic);)C[A]instanceof j.Lj&&O.push(b(C[A])),A++;if(!(C[A]instanceof j.ic)||(U=function(d){var C=d.children,m=C.length;if(!(m<3)&&C[0]instanceof j.Xg&&C[1]instanceof j.rL){for(var O=[],A=2;A<m;A++)C[A]instanceof j.ZH||O.push(b(C[A]));return new M.ME(O)}}(C[A]),U))return new M.Ht(O,U)}}(C[U]))?new M.bM(d):new M.S7(m,O,A)):new M.bM(d)}function p(d){var C=d instanceof j.DH?d.bracketedIdentifier:d;if(!(C instanceof V.a9))return new M.bM(d);var m=C.token;if(m.matchObject instanceof V.S2)return new M.TG(m.matchObject.name);if(m.matchObject instanceof V.Cf)return new M.M0(m.matchObject.table.name,m.matchObject.name);if(m.matchObject instanceof V.XN)return new M.Sx(m.matchObject.table.name,m.matchObject.name);if(m.matchObject instanceof V.yB)return new M.Ex(m.matchObject.name);if(m.matchObject instanceof V.Gs){if(m.matchObject.name===M.ZQ.True)return M.M5.True;if(m.matchObject.name===M.ZQ.False)return M.M5.False}if(m.matchObject instanceof V.cr)return new M.sW(m.matchObject.name);if(m.matchObject instanceof V.it)return new M.sC(m.matchObject.name);if(m.matchObject instanceof V.Z0){if(m.matchObject.name===M.ZQ.Asc)return M.M5.Asc;if(m.matchObject.name===M.ZQ.Desc)return M.M5.Desc}return new M.bM(d)}ie.build=function(d,C){return ve=C,d instanceof j._7?function(d){if(!d.isComplete)return new M.bM(d);for(var C=[],m=0,O=d.children;m<O.length;m++){var A=O[m];if(!(A instanceof j.Vu))return new M.bM(A);var U=Oe(A);if(!(U instanceof M.S7))return new M.bM(A);C.push(U)}return new M.qo(C)}(d):b(d)}}(Y||(Y={}));var Z=function(ve,D,b){return new M.aN(function(ie){if(ie instanceof V.a9)switch(ie.token.type){case 21:return M.EF.Multiply;case 22:return M.EF.Divide;case 19:return M.EF.Add;case 20:return M.EF.Subtract;case 18:return M.EF.Power}return(0,z.vE)("Not a SingleTokenNode arithmetic Operator ".concat(JSON.stringify(ie)))}(ve),D,b)},I=function(ve,D,b){return new M.Ym(function(ie){if(ie instanceof V.a9)switch(ie.token.type){case 15:return M.mO.LessThan;case 11:return M.mO.LessThanEqualTo;case 17:return M.mO.EqualTo;case 9:return M.mO.StrictEqualTo;case 12:return M.mO.GreaterThanEqualTo;case 16:return M.mO.GreaterThan;case 10:return M.mO.NotEqualTo}return(0,z.vE)("Not a SingleTokenNode ComparisonOperator ".concat(ie.token.type))}(ve),D,b)},te=function(ve,D,b){return new M.Wt(function(ie){switch(ie.token.type){case 13:return M.A3.And;case 14:return M.A3.Or}return(0,z.vE)("Not a SingleTokenNode LogicalOperator ".concat(ie.token.type))}(ve),D,b)},ee=function(ve,D,b){return new M.wV(D,b)},W=function(ve,D,b){return new M.Bw(D,b)}},59458:function(Ke,we,E){E.d(we,{A3:function(){return M},Tk:function(){return V},V0:function(){return H},XD:function(){return k},hI:function(){return z},pi:function(){return j}});var R=E(63513);function z(Z){return R.G.hasFlag(Z,1)}function H(Z){return R.G.hasFlag(Z,2)}function V(Z){return R.G.hasFlag(Z,4)}function j(Z){return R.G.hasFlag(Z,16)}function M(Z){return R.G.hasFlag(Z,8)}function k(Z){return R.G.hasFlag(Z,32)}},17819:function(Ke,we,E){E.d(we,{MQ:function(){return I.M},cr:function(){return Y.cr},Df:function(){return Y.Df},XN:function(){return Y.XN},hK:function(){return Y.hK},it:function(){return Y.it},Gs:function(){return Y.Gs},Z0:function(){return Y.Z0},Cf:function(){return Y.Cf},w_:function(){return R.w_},dH:function(){return y.d},S2:function(){return Y.S2},yB:function(){return Y.yB},MX:function(){return R.MX},ss:function(){return te.s},Hw:function(){return ie},bp:function(){return Z.b},O5:function(){return d.O5},Gz:function(){return d.Gz},K2:function(){return d.K2},kD:function(){return d.kD},Sm:function(){return d.Sm},ub:function(){return d.ub},Mk:function(){return d.Mk},yD:function(){return he},o4:function(){return ce},g5:function(){return C.g5},Mn:function(){return d.Mn}});var R=E(11674);E(68706),E(98277),E(59458),E(79232);var Y=E(58871),Z=E(82269),I=E(3371),te=E(22021),ee=E(81337),W=E(55863),i=E(66106),K=E(63513),y=E(40546),ie=function(){return function(O,A,U,Q,oe){this.name=O,this.optional=A,this.repeatable=U,this.repeatGroup=Q,this.skippable=oe}}(),ve=function(){return function(O,A,U,Q,oe,ne){this.name=O,this.description=A,this.category=U,this.pushableToDQ=Q,this.parameters=oe,this.VisualCalculationsInfo=ne}}(),D=function(){return function(O,A,U){this.param=O,this.value=A,this.description=U}}(),b=function(){return function(O,A,U,Q,oe){void 0===oe&&(oe=1023),this.name=O,this.role=A,this.signatureRole=U,this.enumValues=Q,this.returnType=oe}}(),q=function(){function m(O,A,U){this._reservedWords={},this._functions=[],this._daxAxes=U?U.map(function(Se){return new Y.cr(Se)}):[];for(var Q=0,oe=O;Q<oe.length;Q++)this._reservedWords[oe[Q].toUpperCase()]=!0;for(var pe=0,me=A;pe<me.length;pe++){var Ee=me[pe];("ROLLUPADDISSUBTOTAL"===Ee.name||"ROLLUPISSUBTOTAL"===Ee.name)&&4===Ee.parameters.length&&(Ee.parameters[0].skippable=!0,Ee.parameters[0].repeatGroup=1,Ee.parameters[0].repeatable=!0,Ee.parameters[1].repeatGroup=2,Ee.parameters[2].repeatGroup=2,Ee.parameters[3].repeatGroup=2,Ee.parameters[3].skippable=!0),this.addFunction(Ee)}this.ensureSpecialFunctions()}return Object.defineProperty(m.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"reservedWords",{get:function(){return this._reservedWords},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"fnCalculate",{get:function(){return this._fnCalculate},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"axes",{get:function(){return this._daxAxes},enumerable:!1,configurable:!0}),m.loadHardcodedCalculateSignature=function(){return new Y.Gs(Y.Gs.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME,"",4,3,1023,1,[[new Y.td("expression",1023,!1,!1,0,i.Yl.None,!1,void 0),new Y.td("filter",1023,!0,!0,0,i.Yl.Filter,!1,void 0)]])},m.prototype.addFunction=function(O){(0,W.mv)(O.name,"functionDataFromEngine.name");var A=(0,ee.ev)((0,ee.ev)([],m.builtinFunctionData,!0),m.builtinVisualCalcFunctionData,!0);y.d.featureSwitches.customCalendars&&A.forEach(function(Se){Se.signatureRole[0]===i.Yl.DatesAddToRet&&(Se.signatureRole[0]=i.Yl.DatesCalendarsAddToRet)});var Q,U=_.find(A,function(Se){return K.uI.equalIgnoreCase(Se.name,O.name)});Q=null==U||"EXPAND"!==U.name&&"COLLAPSE"!==U.name?[O.parameters]:this.createHardCodedSignaturesForExpandCollapseFunctions(O);for(var oe=[],ne=function(Ae){for(var u=0,s=[],l=0,v=Q[Ae];l<v.length;l++){var L=v[l],J=i.Yl.None;if(null!=U?.signatureRole){var fe;fe=_.isArray(U.signatureRole[0])?U.signatureRole[Ae]:U.signatureRole,u<fe.length&&(J=fe[u])}var se=[];K.G.hasFlag(J.type,64)&&(se=_.chain(U.enumValues).filter(function(Ce){return Ce.param===u}).map(function(Ce){return new Y.it(Ce.value,Ce.description)}).value()),s.push(new Y.td(L.name,J.dataType,L.repeatable,L.optional,L.repeatGroup,J,L.skippable,se)),u++}oe.push(s)},pe=0;pe<Q.length;pe++)ne(pe);var me=1,Ee=0;U&&(me=U.role,Ee=U.returnType),this._functions.push(new Y.Gs(O.name,O.description,O.category,O.pushableToDQ,Ee,me,oe))},m.prototype.createHardCodedSignaturesForExpandCollapseFunctions=function(O){var A=4===O.parameters.length;if((0,W.mv)(A,"expecting 4 parameters"),!A)return[];var U="Expression"===O.parameters[0].name,Q="Axis"===O.parameters[1].name,oe="Column"===O.parameters[2].name,ne="N"===O.parameters[3].name;if((0,W.mv)(U,"1st parameter should be Expression"),(0,W.mv)(Q,"2nd parameter should be Axis"),(0,W.mv)(oe,"3rd parameter should be Column"),(0,W.mv)(ne,"4th parameter should be N"),!(U&&Q&&oe&&ne))return[];var Se=O.parameters[1],Ae=O.parameters[2],w=O.parameters[3],u=new ie(O.parameters[0].name,!0,!1,-1,!0),s=new ie(w.name,!0,!1,-1,!0);return[[u,new ie(Se.name,!1,!1,-1,!1),s],[u,new ie(Ae.name,!1,!0,0,!1)]]},m.prototype.ensureSpecialFunctions=function(){this._fnCalculate=_.find(this.functions,function(O){return O.name===Y.Gs.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME}),this._fnCalculate||(this._fnCalculate=m.hardcodedFnCalculate,this._functions.push(this._fnCalculate))},m.hardcodedFnCalculate=m.loadHardcodedCalculateSignature(),m.builtinFunctionData=[new b("ADDCOLUMNS",2,[i.Yl.TableExprAddToRet,i.Yl.NewCol,i.Yl.ExprOverTable],void 0),new b("ADDMISSINGITEMS",2,[i.Yl.QualifiedColRef,i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.ColFromExtractedTable,{type:512}),i.Yl.TableExpr],void 0),new b("ALLCROSSFILTERED",1,[i.Yl.TableRef],void 0),new b("ALL",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("ALLEXCEPT",2,[i.Yl.TableRefAddToRet,{type:12,columnReferenceScope:5,argumentContextAction:4}],void 0),new b("ALLNOBLANKROW",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("ALLSELECTED",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("APPROXIMATEDISTINCTCOUNT",1,[i.Yl.AnyColRef],void 0),new b("AVERAGE",1,[i.Yl.AnyColRef],void 0),new b("AVERAGEA",1,[i.Yl.AnyColRef],void 0),new b("AVERAGEX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("CALCULATE",1,[{dataType:1087,argumentContextAction:5},(0,ee.pi)({dataType:264},i.Yl.Filter)],void 0,1024),new b("CALCULATETABLE",2,[i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:5}),i.Yl.Filter],void 0),new b("CALENDAR",4,[i.Yl.None,i.Yl.None],void 0),new b("CALENDARAUTO",4,[i.Yl.None],void 0),new b("CLOSINGBALANCEMONTH",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("CLOSINGBALANCEQUARTER",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("CLOSINGBALANCEYEAR",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("COLUMNSTATISTICS",4096,[],void 0),new b("CONCATENATEX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(4,"ASC"),new D(4,"DESC")]),new b("CONTAINS",1,[i.Yl.TableExpr,i.Yl.ColFromExtractedTableOrRel,i.Yl.None],void 0),new b("CONVERT",1,[i.Yl.None,i.Yl.EnumValue],[new D(1,"BOOLEAN"),new D(1,"DOUBLE"),new D(1,"INTEGER"),new D(1,"DATETIME"),new D(1,"CURRENCY"),new D(1,"STRING")]),new b("CONVERTTOCSV",1,[i.Yl.TableExpr,i.Yl.None,i.Yl.None,i.Yl.None],void 0),new b("COUNT",1,[i.Yl.AnyColRef],void 0),new b("COUNTA",1,[i.Yl.AnyColRef],void 0),new b("COUNTAX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("COUNTBLANK",1,[i.Yl.AnyColRef],void 0),new b("COUNTX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("COUNTROWS",1,[i.Yl.TableExpr],void 0),new b("CROSSFILTER",1,[i.Yl.QualifiedColRef,i.Yl.QualifiedColRef,i.Yl.EnumValue],[new D(2,"None"),new D(2,"OneWay"),new D(2,"Both"),new D(2,"OneWay_LeftFiltersRight"),new D(2,"OneWay_RightFiltersLeft")]),new b("CROSSJOIN",2,[i.Yl.TableExprAddToRet],void 0),new b("CURRENTGROUP",8,[],void 0),new b("DATATABLE",2,[i.Yl.NewCol,i.Yl.EnumValue,{type:4096}],[new D(1,"BOOLEAN"),new D(1,"DOUBLE"),new D(1,"INTEGER"),new D(1,"DATETIME"),new D(1,"CURRENCY"),new D(1,"STRING")]),new b("DATE",1,[(0,ee.pi)({dataType:1},i.Yl.None),(0,ee.pi)({dataType:1},i.Yl.None),(0,ee.pi)({dataType:1},i.Yl.None)],void 0,16),new b("DATEADD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.EnumValue],[new D(2,"DAY"),new D(2,"MONTH"),new D(2,"QUARTER"),new D(2,"YEAR")]),new b("DATEDIFF",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"DAY"),new D(2,"WEEK"),new D(2,"MONTH"),new D(2,"QUARTER"),new D(2,"YEAR"),new D(2,"HOUR"),new D(2,"MINUTE"),new D(2,"SECOND")]),new b("DATESBETWEEN",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.None],void 0),new b("DATESINPERIOD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(3,"DAY"),new D(3,"MONTH"),new D(3,"QUARTER"),new D(3,"YEAR")]),new b("DATESMTD",2,[i.Yl.DatesAddToRet],void 0),new b("DATESQTD",2,[i.Yl.DatesAddToRet],void 0),new b("DATESYTD",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("DISTINCT",8194,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,i.Yl.TableExprAddToRet)],void 0),new b("DISTINCTCOUNT",1,[i.Yl.AnyColRef],void 0),new b("DISTINCTCOUNTNOBLANK",1,[i.Yl.AnyColRef],void 0),new b("EARLIER",1,[i.Yl.EarlierColRef],void 0),new b("EARLIEST",1,[i.Yl.EarliestColRef],void 0),new b("ENDOFMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("ENDOFQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("ENDOFYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("EVALUATEANDLOG",256,[i.Yl.or({type:1},i.Yl.TableExpr,i.Yl.TableExprAddToRet,i.Yl.TableRef,i.Yl.TableRefAddToRet),i.Yl.None,i.Yl.None],void 0),new b("EXCEPT",2,[i.Yl.TableExprAddToRet,i.Yl.TableExpr],void 0),new b("EXTERNALMEASURE",1,[{type:2048},i.Yl.EnumValue,{type:2048}],[new D(1,"BOOLEAN"),new D(1,"DOUBLE"),new D(1,"INTEGER"),new D(1,"DATETIME"),new D(1,"CURRENCY"),new D(1,"STRING"),new D(1,"VARIANT")]),new b("FILTER",2,[(0,ee.pi)({dataType:256},i.Yl.TableExprAddToRet),(0,ee.pi)({dataType:8},i.Yl.ExprOverTable)],void 0,256),new b("FILTERS",2,[i.Yl.or(i.Yl.HomeOrQualifiedColRef,{argumentAction:1})],void 0),new b("FIRSTDATE",2,[i.Yl.DatesAddToRet],void 0),new b("FIRSTNONBLANK",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("FIRSTNONBLANKVALUE",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("FULLOUTERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("GENERATE",2,[i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:1})],void 0),new b("GENERATEALL",2,[i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:1})],void 0),new b("GENERATESERIES",12,[i.Yl.None,i.Yl.None,i.Yl.None],void 0),new b("GEOMEAN",1,[i.Yl.AnyColRef],void 0),new b("GEOMEANX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("GROUPBY",2,[i.Yl.TableExpr,i.Yl.ColFromExtractedTableOrRelAddToRet,i.Yl.NewCol,{additionalBehaviors:1}],void 0),new b("HASONEVALUE",1,[i.Yl.QualifiedColRef],void 0),new b("HASONEFILTER",1,[i.Yl.HomeOrQualifiedColRef],void 0),new b("KEEPFILTERS",2,[i.Yl.or(i.Yl.TableExprAddToRet,{type:1})],void 0),new b("IF",1,[(0,ee.pi)((0,ee.pi)({},i.Yl.None),{dataType:59}),(0,ee.pi)({dataType:1087},i.Yl.None),(0,ee.pi)({dataType:1087},i.Yl.None)],void 0,1024),new b("INFO.ALTERNATEOFDEFINITIONS",16384,[]),new b("INFO.ANNOTATIONS",16384,[]),new b("INFO.ATTRIBUTEHIERARCHIES",16384,[]),new b("INFO.ATTRIBUTEHIERARCHYSTORAGES",16384,[]),new b("INFO.CALCDEPENDENCY",16384,[]),new b("INFO.CALCULATIONGROUPS",16384,[]),new b("INFO.CALCULATIONITEMS",16384,[]),new b("INFO.CATALOGS",16384,[]),new b("INFO.CHANGEDPROPERTIES",16384,[]),new b("INFO.COLUMNPARTITIONSTORAGES",16384,[]),new b("INFO.COLUMNPERMISSIONS",16384,[]),new b("INFO.COLUMNS",16384,[]),new b("INFO.COLUMNSTORAGES",16384,[]),new b("INFO.CULTURES",16384,[]),new b("INFO.DATACOVERAGEDEFINITIONS",16384,[]),new b("INFO.DATASOURCES",16384,[]),new b("INFO.DELTATABLEMETADATASTORAGES",16384,[]),new b("INFO.DETAILROWSDEFINITIONS",16384,[]),new b("INFO.DICTIONARYSTORAGES",16384,[]),new b("INFO.EXCLUDEDARTIFACTS",16384,[]),new b("INFO.EXPRESSIONS",16384,[]),new b("INFO.EXTENDEDPROPERTIES",16384,[]),new b("INFO.FORMATSTRINGDEFINITIONS",16384,[]),new b("INFO.FUNCTIONS",16384,[]),new b("INFO.GENERALSEGMENTMAPSEGMENTMETADATASTORAGES",16384,[]),new b("INFO.GROUPBYCOLUMNS",16384,[]),new b("INFO.HIERARCHIES",16384,[]),new b("INFO.HIERARCHYSTORAGES",16384,[]),new b("INFO.KPIS",16384,[]),new b("INFO.LEVELS",16384,[]),new b("INFO.LINGUISTICMETADATA",16384,[]),new b("INFO.MEASURES",16384,[]),new b("INFO.MODEL",16384,[]),new b("INFO.OBJECTTRANSLATIONS",16384,[]),new b("INFO.PARQUETFILESTORAGES",16384,[]),new b("INFO.PARTITIONS",16384,[]),new b("INFO.PARTITIONSTORAGES",16384,[]),new b("INFO.PERSPECTIVECOLUMNS",16384,[]),new b("INFO.PERSPECTIVEHIERARCHIES",16384,[]),new b("INFO.PERSPECTIVEMEASURES",16384,[]),new b("INFO.PERSPECTIVES",16384,[]),new b("INFO.PERSPECTIVETABLES",16384,[]),new b("INFO.PROPERTIES",16384,[]),new b("INFO.QUERYGROUPS",16384,[]),new b("INFO.REFRESHPOLICIES",16384,[]),new b("INFO.RELATEDCOLUMNDETAILS",16384,[]),new b("INFO.RELATIONSHIPINDEXSTORAGES",16384,[]),new b("INFO.RELATIONSHIPS",16384,[]),new b("INFO.RELATIONSHIPSTORAGES",16384,[]),new b("INFO.ROLEMEMBERSHIPS",16384,[]),new b("INFO.ROLES",16384,[]),new b("INFO.SEGMENTMAPSTORAGES",16384,[]),new b("INFO.SEGMENTSTORAGES",16384,[]),new b("INFO.STORAGEFILES",16384,[]),new b("INFO.STORAGEFOLDERS",16384,[]),new b("INFO.STORAGETABLECOLUMNS",16384,[]),new b("INFO.STORAGETABLECOLUMNSEGMENTS",16384,[]),new b("INFO.STORAGETABLES",16384,[]),new b("INFO.TABLEPERMISSIONS",16384,[]),new b("INFO.TABLES",16384,[]),new b("INFO.TABLESTORAGES",16384,[]),new b("INFO.VARIATIONS",16384,[]),new b("INTERSECT",2,[i.Yl.TableExprAddToRet,i.Yl.TableExpr],void 0),new b("ISAFTER",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"ASC"),new D(2,"DESC")]),new b("ISCROSSFILTERED",1,[i.Yl.or(i.Yl.TableRef,i.Yl.HomeOrQualifiedColRef)],void 0),new b("ISEMPTY",1,[i.Yl.TableExpr],void 0),new b("ISFILTERED",1,[i.Yl.or(i.Yl.TableRef,i.Yl.HomeOrQualifiedColRef)],void 0),new b("INDEX",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new D(3,"DEFAULT"),new D(6,"NONE"),new D(6,"LOWESTPARENT"),new D(6,"HIGHESTPARENT")],256),new b("ISINSCOPE",1,[i.Yl.HomeOrQualifiedColRef],void 0),new b("ISONORAFTER",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"ASC"),new D(2,"DESC")]),new b("ISSUBTOTAL",1,[i.Yl.ColFromCurTable],void 0),new b("LASTDATE",2,[i.Yl.DatesAddToRet],void 0),new b("LASTNONBLANK",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("LASTNONBLANKVALUE",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("LINEST",2,[i.Yl.AnyColRef,i.Yl.AnyColRef,i.Yl.EnumValue],[new D(2,"TRUE"),new D(2,"FALSE")],256),new b("LINESTX",2,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(3,"TRUE"),new D(3,"FALSE")],256),new b("LOOKUPVALUE",1,[i.Yl.or(i.Yl.HomeOrQualifiedColRef,{argumentAction:4}),i.Yl.ColFromExtractedTableOrRel,i.Yl.None],void 0),new b("MATCHBY",2048,[i.Yl.AnyColRef],void 0),new b("MAX",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("MAXA",1,[i.Yl.AnyColRef],void 0),new b("MAXX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(2,"TRUE"),new D(2,"FALSE")],void 0),new b("MEDIAN",1,[i.Yl.AnyColRef],void 0),new b("MEDIANX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("MIN",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("MINA",1,[i.Yl.AnyColRef],void 0),new b("MINX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(2,"TRUE"),new D(2,"FALSE")],void 0),new b("NAMEOF",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("NATURALINNERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("NATURALLEFTOUTERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("NETWORKDAYS",1,[i.Yl.None,i.Yl.None,i.Yl.None,i.Yl.TableExpr],void 0,63),new b("NEXTDAY",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTYEAR",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("NONVISUAL",2,[i.Yl.TableExprAddToRet],void 0),new b("OFFSET",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new D(3,"DEFAULT"),new D(6,"NONE"),new D(6,"LOWESTPARENT"),new D(6,"HIGHESTPARENT")],256),new b("OPENINGBALANCEMONTH",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("OPENINGBALANCEQUARTER",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("OPENINGBALANCEYEAR",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("ORDERBY",512,[i.Yl.or(i.Yl.ColFromCurTable,{type:1}),i.Yl.EnumValue],[new D(1,"ASC"),new D(1,"DESC"),new D(1,"ASC BLANKS DEFAULT"),new D(1,"ASC BLANKS FIRST"),new D(1,"ASC BLANKS LAST"),new D(1,"DESC BLANKS DEFAULT"),new D(1,"DESC BLANKS FIRST"),new D(1,"DESC BLANKS LAST")]),new b("PARALLELPERIOD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.EnumValue],[new D(2,"MONTH"),new D(2,"QUARTER"),new D(2,"YEAR")]),new b("PARTITIONBY",1024,[i.Yl.AnyColRef],void 0),new b("PATH",1,[i.Yl.HomeOrQualifiedColRef,i.Yl.HomeOrQualifiedColRef],void 0),new b("PATHITEM",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"TEXT","Function returns a string"),new D(2,"INTEGER","Function returns an integer")]),new b("PATHITEMREVERSE",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"TEXT","Function returns a string"),new D(2,"INTEGER","Function returns an integer")]),new b("PERCENTILE.EXC",1,[i.Yl.AnyColRef,i.Yl.None],void 0),new b("PERCENTILE.INC",1,[i.Yl.AnyColRef,i.Yl.None],void 0),new b("PERCENTILEX.EXC",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("PERCENTILEX.INC",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("PREVIOUSDAY",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSYEAR",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("PRODUCT",1,[i.Yl.AnyColRef],void 0),new b("PRODUCTX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("RANK",1,[i.Yl.EnumValue,i.Yl.TableExpr,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new D(0,"DENSE"),new D(0,"SKIP"),new D(3,"DEFAULT"),new D(3,"FIRST"),new D(3,"LAST"),new D(6,"NONE"),new D(6,"LOWESTPARENT"),new D(6,"HIGHESTPARENT")]),new b("RANK.EQ",1,[i.Yl.None,i.Yl.AnyColRef,i.Yl.EnumValue],[new D(2,"ASC"),new D(2,"DESC")]),new b("RANKX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None,i.Yl.EnumValue,i.Yl.EnumValue],[new D(3,"ASC"),new D(3,"DESC"),new D(4,"Skip"),new D(4,"Dense")]),new b("RELATED",1,[i.Yl.RelatedColRef],void 0),new b("RELATEDTABLE",2,[i.Yl.or(i.Yl.TableRefAddToRet,{argumentContextAction:5})],void 0),new b("REMOVEFILTERS",1,[i.Yl.or(i.Yl.TableRef,i.Yl.QualifiedColRef),i.Yl.QualifiedColRef],void 0),new b("ROLLUP",16,[{type:1024,additionalBehaviors:4}],void 0),new b("ROLLUPGROUP",128,[{additionalBehaviors:4}],void 0),new b("ROLLUPADDISSUBTOTAL",32,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromParentContext,{type:1024,additionalBehaviors:4}),i.Yl.NewCol,i.Yl.TableExpr],void 0),new b("ROLLUPISSUBTOTAL",64,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromParentContext,{type:1024,additionalBehaviors:4}),i.Yl.ColFromParentContext,i.Yl.TableExpr],void 0),new b("ROW",2,[i.Yl.NewCol,i.Yl.None],void 0),new b("ROWNUMBER",1,[i.Yl.TableExpr,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new D(2,"DEFAULT"),new D(2,"FIRST"),new D(2,"LAST"),new D(5,"NONE"),new D(5,"LOWESTPARENT"),new D(5,"HIGHESTPARENT")]),new b("SAMEPERIODLASTYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("SAMPLE",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(3,"ASC"),new D(3,"DESC")]),new b("SELECTCOLUMNS",2,[i.Yl.TableExpr,i.Yl.NewCol,i.Yl.ExprOverTable],void 0),new b("SELECTEDVALUE",1,[(0,ee.pi)({dataType:1024},i.Yl.QualifiedColRef)],void 0,1024),new b("STARTOFMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("STARTOFQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("STARTOFYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("STDEV.P",1,[i.Yl.AnyColRef],void 0),new b("STDEV.S",1,[i.Yl.AnyColRef],void 0),new b("STDEVX.P",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("STDEVX.S",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("SUBSTITUTEWITHINDEX",2,[{type:2,argumentAction:1},i.Yl.NewCol,i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(4,"ASC"),new D(4,"DESC")]),new b("SUMMARIZE",2,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromExtractedTableOrRelAddToRet,{type:1152,argumentAction:8}),i.Yl.NewCol,{argumentContextAction:2}],void 0),new b("SUMMARIZECOLUMNS",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{type:256}),i.Yl.TableExpr,i.Yl.NewCol,i.Yl.None],void 0),new b("SUM",1,[(0,ee.pi)((0,ee.pi)({},i.Yl.AnyColRef),{dataType:1083})],void 0,1024),new b("SUMX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0,1024),new b("TOCSV",1,[i.Yl.TableExpr,i.Yl.None,i.Yl.None,i.Yl.None],void 0,4),new b("TODAY",1,[],void 0,16),new b("TOJSON",1,[i.Yl.TableExpr,i.Yl.None],void 0,4),new b("TOPN",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(3,"ASC"),new D(3,"DESC"),new D(3,"0"),new D(3,"1"),new D(3,"TRUE"),new D(3,"FALSE")]),new b("TOPNSKIP",2,[i.Yl.None,i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new D(4,"ASC"),new D(4,"DESC"),new D(4,"0"),new D(4,"1"),new D(4,"TRUE"),new D(4,"FALSE")]),new b("TOTALMTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("TOTALQTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("TOTALYTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("TREATAS",2,[{type:2},i.Yl.QualifiedColRefAddToRet],void 0),new b("UNION",2,[i.Yl.or(i.Yl.TableExprAddToRet,{argumentAction:2})],void 0),new b("USERELATIONSHIP",1,[i.Yl.QualifiedColRef,i.Yl.QualifiedColRef],void 0),new b("VALUES",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet)],void 0),new b("VAR.P",1,[i.Yl.AnyColRef],void 0),new b("VAR.S",1,[i.Yl.AnyColRef],void 0),new b("VARX.P",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("VARX.S",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("WINDOW",2,[i.Yl.None,i.Yl.EnumValue,i.Yl.None,i.Yl.EnumValue,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new D(1,"ABS"),new D(1,"REL"),new D(3,"ABS"),new D(3,"REL"),new D(6,"DEFAULT"),new D(9,"NONE"),new D(9,"LOWESTPARENT"),new D(9,"HIGHESTPARENT")],256),new b("WEEKDAY",1,[i.Yl.None,i.Yl.EnumValue],[new D(1,"1","Sunday=1 through Saturday=7"),new D(1,"2","Monday=1 through Sunday=7"),new D(1,"3","Monday=0 through Sunday=6")]),new b("WEEKNUM",1,[i.Yl.None,i.Yl.EnumValue],[new D(1,"1","Week begins on Sunday"),new D(1,"2","Week begins on Monday"),new D(1,"11","Week begins on Monday"),new D(1,"12","Week begins on Tuesday"),new D(1,"13","Week begins on Wednesday"),new D(1,"14","Week begins on Thursday"),new D(1,"15","Week begins on Friday"),new D(1,"16","Week begins on Saturday"),new D(1,"17","Week begins on Sunday"),new D(1,"21","Based on the European week numbering system, the week begins on Monday")]),new b("XIRR",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("XNPV",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("YEARFRAC",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new D(2,"0","US (NASD) 30/360"),new D(2,"1","Actual/actual"),new D(2,"2","Actual/360"),new D(2,"3","Actual/365"),new D(2,"4","European 30/360")])],m.builtinVisualCalcFunctionData=[new b("FIRST",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(2,"DEFAULT"),new D(2,"FIRST"),new D(2,"LAST"),new D(3,"NONE"),new D(3,"LOWESTPARENT"),new D(3,"HIGHESTPARENT")]),new b("LAST",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(2,"DEFAULT"),new D(2,"FIRST"),new D(2,"LAST"),new D(3,"NONE"),new D(3,"LOWESTPARENT"),new D(3,"HIGHESTPARENT")]),new b("NEXT",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(3,"DEFAULT"),new D(3,"FIRST"),new D(3,"LAST"),new D(4,"NONE"),new D(4,"LOWESTPARENT"),new D(4,"HIGHESTPARENT")]),new b("PREVIOUS",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(3,"DEFAULT"),new D(3,"FIRST"),new D(3,"LAST"),new D(4,"NONE"),new D(4,"LOWESTPARENT"),new D(4,"HIGHESTPARENT")]),new b("LOOKUP",1,[i.Yl.AnyColRef,i.Yl.Filter],void 0),new b("RUNNINGSUM",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(2,"DEFAULT"),new D(2,"FIRST"),new D(2,"LAST"),new D(3,"NONE"),new D(3,"LOWESTPARENT"),new D(3,"HIGHESTPARENT")]),new b("MOVINGAVERAGE",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.EnumValue,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(2,"TRUE"),new D(2,"FALSE"),new D(4,"DEFAULT"),new D(4,"FIRST"),new D(4,"LAST"),new D(5,"NONE"),new D(5,"LOWESTPARENT"),new D(5,"HIGHESTPARENT")]),new b("EXPAND",1,[[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.None],[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AnyColRef]],void 0),new b("COLLAPSE",1,[[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.None],[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AnyColRef]],void 0),new b("EXPANDALL",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr],void 0),new b("COLLAPSEALL",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr],void 0),new b("RANGE",2,[i.Yl.None,i.Yl.EnumValue,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new D(1,"TRUE"),new D(1,"FALSE"),new D(3,"DEFAULT"),new D(3,"FIRST"),new D(3,"LAST"),new D(4,"NONE"),new D(4,"LOWESTPARENT"),new D(4,"HIGHESTPARENT")]),new b("ISATLEVEL",1,[i.Yl.AnyColRef],void 0)],m}();function he(m,O){return new q(m.reservedWords,m.functionDataFromEngine.map(function(A){return function(m){return new ve(m.name,m.description,m.category,m.pushableToDQ,m.parameters.map(function(O){return function(m){return new ie(m.name,m.optional,m.repeatable,m.repeatGroup,m.skippable)}(O)}),m.visualCalculationsInfo)}(A)}),O)}function ce(m){return new Me(m)}var Me=function(){function m(O){this.tables=[];for(var A=0,U=O.tables;A<U.length;A++)this.tables.push(new Oe(U[A]));for(var oe=0,ne=this.tables;oe<ne.length;oe++)for(var me=0,Ee=ne[oe].columns;me<Ee.length;me++)Ee[me].bindVariationTable(this.tables);this.relationshipGraph=new re(this,O.relationships)}return m.prototype.findTable=function(O){return _.find(this.tables,function(A){return A.name===O})},m}(),xe=function(){function m(O,A){this.table=O,this.name=A.name,this.description=A.description,this.variationTableName=A.variationTable}return Object.defineProperty(m.prototype,"variationTable",{get:function(){return this._variationTable},enumerable:!1,configurable:!0}),m.prototype.bindVariationTable=function(O){var A=this;this.variationTableName&&(this._variationTable=_.find(O,function(U){return U.name===A.variationTableName}))},m}(),je=function(){return function(O,A){this.table=O,this.name=A.name,this.description=A.description,this.expression=A.expression,this.isExternal=A.isExternal}}(),ge=function(){return function(O,A){this.table=O,this.name=A.name}}(),Oe=function(){function m(O){var U,A=this;this.name=O.name,this.description=O.description,this.measures=O.measures.map(function(oe){return new je(A,oe)});var Q=O.columns.filter(function(oe){return oe.isUserColumn});this.columns=Q.map(function(oe){return new xe(A,oe)}),this.calendars=null===(U=O.calendars)||void 0===U?void 0:U.map(function(oe){return new ge(A,oe)}),this.isTransparent=O.isTransparent,this.isUserTable=O.isUserTable}return m.prototype.getHashCode=function(){return this.name},m.prototype.equals=function(O){return this.name===O.name},m}(),re=function(){function m(O,A){this.reachableTables=new K.Xy,this.reachableTables=m.buildReachableTables(O,A)}return m.prototype.getRelatedTables=function(O){var A=this.reachableTables.get(O);return A?A.values():[]},m.buildReachableTables=function(O,A){for(var U=new K.Xy,Q=0,oe=_.filter(A,function(se){return se.active});Q<oe.length;Q++){var ne=oe[Q],pe=O.findTable(ne.from.table),me=O.findTable(ne.to.table);m.addRelatedTable(U,pe,me),"one"===ne.from.cardinality&&"one"===ne.to.cardinality&&m.addRelatedTable(U,me,pe)}for(var Ee=new K.Xy,Se=0,Ae=U.keys;Se<Ae.length;Se++){var w=Ae[Se],u=new K.Bl,s=new K.ci;for(u.add(w),s.enqueue(w);s.length>0;){var l=s.dequeue(),v=U.get(l);if(v)for(var L=0,J=v.values();L<J.length;L++){var fe=J[L];u.add(fe)&&s.enqueue(fe)}}u.remove(w),Ee.update(w,u)}return Ee},m.addRelatedTable=function(O,A,U){var Q=O.get(A);Q||(Q=new K.Bl,O.add(A,Q)),Q.add(U)},m}(),d=(E(21527),E(85786),E(48987),E(95792)),C=E(88498)},70163:function(Ke,we,E){function R(H){z.initialize(H)}E.d(we,{J:function(){return z},j:function(){return R}});var z=function(){function H(){}return H.initialize=function(V){H._tryParseColumnReference=V},Object.defineProperty(H,"tryParseColumnReference",{get:function(){if(!this._tryParseColumnReference)throw new Error("NodeUtilities has not been initialized! Ensure DaxParserUtils.initialize has been called first");return H._tryParseColumnReference},enumerable:!1,configurable:!0}),H}()},66106:function(Ke,we,E){E.d(we,{Rv:function(){return M},XD:function(){return V},Yl:function(){return j},e9:function(){return H}});var j,M,k,R=E(81337),z=E(63513),H=1920,V=24;!function(k){function Y(){for(var Z=[],I=0;I<arguments.length;I++)Z[I]=arguments[I];for(var te=k.None,ee=0,W=Z;ee<W.length;ee++){var i=W[ee];te={additionalBehaviors:te.additionalBehaviors|i.additionalBehaviors,argumentAction:te.argumentAction|i.argumentAction,argumentContextAction:te.argumentContextAction|i.argumentContextAction,columnReferenceScope:te.columnReferenceScope|i.columnReferenceScope,type:te.type|i.type,dataType:te.dataType|i.dataType}}return te}k.None={},k.InvalidParam={type:262144},k.TableExpr={type:524290,argumentAction:4},k.TableExprAddToRet={type:524290,argumentAction:5},k.TableRef={type:65540,argumentAction:4},k.TableRefAddToRet={type:65540,argumentAction:5},k.AnyColRef={type:24,columnReferenceScope:49},k.QualifiedColRef={type:8,columnReferenceScope:16},k.CalendarRef={type:1048576,argumentAction:4},k.QualifiedColRefAddToRet=Y(k.QualifiedColRef,{argumentAction:1}),k.RelatedColRef={type:8,columnReferenceScope:4},k.HomeOrQualifiedColRef={type:8,columnReferenceScope:48},k.EarlierColRef={type:24,columnReferenceScope:3,argumentContextAction:6},k.EarliestColRef={type:24,columnReferenceScope:3,argumentContextAction:7},k.ColFromParentContext={type:24,additionalBehaviors:4},k.ColFromCurTable={type:24,columnReferenceScope:3},k.ColFromExtractedTable=Y(k.ColFromCurTable,{argumentContextAction:4}),k.ColFromExtractedTableOrRel=Y(k.ColFromCurTable,{columnReferenceScope:4,argumentContextAction:4}),k.ColFromExtractedTableOrRelAddToRet=Y(k.ColFromExtractedTableOrRel,{columnReferenceScope:8,argumentAction:1}),k.NewCol={type:32,argumentAction:1},k.ExprOverTable={argumentContextAction:1},k.EnumValue={type:64},k.Dates=Y(k.TableExpr,k.QualifiedColRef),k.DatesAddToRet=Y(k.Dates,{argumentAction:1}),k.DatesCalendars=Y(k.Dates,k.CalendarRef),k.DatesCalendarsAddToRet=Y(k.DatesCalendars,{argumentAction:1}),k.Filter={type:1,additionalBehaviors:2},k.OrderByParam={type:16384,argumentContextAction:1},k.PartitionByParam={type:32768},k.MatchByParam={type:131072},k.AxisExpr={type:524288},k.EnumOrIntValue=Y(k.EnumValue,{type:1}),k.or=Y}(j||(j={})),(k=M||(M={})).getTypes=function(I,te){var ee=I.type;if(z.G.hasFlag(I.additionalBehaviors,4))for(var W=0,i=te.ephemeralContexts;W<i.length;W++)ee|=i[W].allowedTypes&V;return!_.isEmpty(te.matchObjects.transparentTables)&&z.G.hasFlag(ee,8)&&(ee|=16),ee},k.transformRole=function(I,te){if(!_.isEmpty(te.matchObjects.transparentTables)&&z.G.hasFlag(I.type,8)){var ee=I.type?16|I.type:16;return(0,R.pi)((0,R.pi)({},I),{type:ee})}return I}},85402:function(Ke,we,E){E.d(we,{q:function(){return z}});var R=E(55863),z=function(){function H(V){this._parent=V,null!=this.parent&&this.parent.addChild(this),this._state=0,this.children=[]}return Object.defineProperty(H.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"childCount",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),H.prototype.addChild=function(V){return!_.includes(this.children,V)&&(this.children.push(V),!0)},H.prototype.removeChild=function(V){var j=_.indexOf(this.children,V);-1!==j&&this.children.splice(j,1)},H.prototype.reinitialize=function(){this._state=0,this.children=[]},H.prototype.markUnsuccessful=function(){for(var V=this;;){V._state=2;var j=V.parent;if(!j||(j.removeChild(V),j.childCount>0))break;V=j}},H.prototype.consolidatePath=function(){var V,j;for(V=this,j=this.parent;null!=j&&j.childCount<=1;V=j,j=j.parent)(0,R.hu)(1===j.childCount,"Must have at least one child, since it is our parent"),V._state=1,j.removeChild(V);return V},Object.defineProperty(H.prototype,"isValid",{get:function(){for(var j=this;;j=j.parent){if((0,R.hu)(null!=j,"There must be an ongoing ParsePath at the root of the tree of ParsePaths"),0===j.state)return!0;if(2===j.state)return!1}},enumerable:!1,configurable:!0}),H}()},88498:function(Ke,we,E){E.d(we,{Mz:function(){return j},V:function(){return R},ft:function(){return H},g5:function(){return V}});var j,M,R={listSeparator:",",numberDecimalSeparator:"."},z=R;function H(){return z}function V(M){z=M}(M=j||(j={})).alwaysRebuildContext=!1,M.debugging=!0},3371:function(Ke,we,E){E.d(we,{M:function(){return V}});var V,R=E(55863),z=E(63513),H=E(58871);!function(j){function k(ee,W,i){for(var K=W.name,ie=new H.S2(K,W.description,z.LP.quoteNeeded(K,function(ye){return te(ye,ee)}),W.name,W.isTransparent,W.isUserTable),ve=0,D=W.columns;ve<D.length;ve++){var b=D[ve],q=b.description,he=void 0;i&&b.variationTable&&(he=k(ee,b.variationTable,!1));var ce=new H.XN(b.name,q,ie);ie.addColumn(ce),null!=he&&(ce.variationTable=he,he.variationSource=ce)}return ie}function te(ee,W){return H.hK.isReservedWord(ee,W.reservedWords,W.functions)}j.populateAll=function(ee,W,i){var K={daxTables:[],daxColumns:[],transparentDaxTables:[]};!function(ee,W,i){var K={},y={};i.daxTables=[],i.daxColumns=[],i.transparentDaxTables=[];for(var ie=0,ve=ee.tables;ie<ve.length;ie++){var D=ve[ie];(b=k(W,D,!0)).isTransparent?i.transparentDaxTables.push(b):i.daxTables.push(b),K[b.name]=b,y[D.name]=D,i.daxColumns=i.daxColumns.concat(b.columns)}for(var q=ee.relationshipGraph,he=0,ce=i.daxTables;he<ce.length;he++)for(var b,ye=(b=ce[he]).uberTable,Pe=0,Me=q.getRelatedTables(y[b.name]);Pe<Me.length;Pe++){var je=K[Me[Pe].name];je&&ye.relatedTables.push(je)}}(ee,W,K);var y={measures:[]};!function(ee,W,i,K){K.measures=[];for(var y=function(q){if(!_.some(q.measures))return"continue";var he=_.find(i.daxTables,function(xe){return xe.name===q.name});(0,R.mv)(he,"daxTable");for(var ce=0,ye=q.measures;ce<ye.length;ce++){var Pe=ye[ce],Me=new H.Cf(Pe.name,Pe.description,he,W);he.addMeasure(Me),K.measures.push(Me)}},ie=0,ve=ee.tables;ie<ve.length;ie++)y(ve[ie])}(ee,W.fnCalculate,K,y);var ie={calendars:[]};(function(ee,W,i){i.calendars=[];for(var K=function(b){if(!_.some(b.calendars))return"continue";var q=_.find(W.daxTables,function(Me){return Me.name===b.name});(0,R.mv)(q,"daxTable");for(var he=0,ce=b.calendars;he<ce.length;he++){var Pe=new H.Df(ce[he].name,q);q.addCalendar(Pe),i.calendars.push(Pe)}},y=0,ie=ee.tables;y<ie.length;y++)K(ie[y])})(ee,K,ie),i.matchObjects=new H.ZY(K.daxTables,K.daxColumns,y.measures,ie.calendars,W.functions,W.reservedWords,K.transparentDaxTables,W.axes)},j.isReservedWord=te}(V||(V={}))},22021:function(Ke,we,E){E.d(we,{s:function(){return R}});var R=function(){return function(){this.valid=!1,this.cParensNeeded=0}}()},58871:function(Ke,we,E){E.d(we,{cr:function(){return b},e$:function(){return Me},Df:function(){return q},XN:function(){return je},hK:function(){return i},it:function(){return ge},xE:function(){return K},Gs:function(){return C},eL:function(){return re},gR:function(){return P},td:function(){return Oe},Z0:function(){return D},ZY:function(){return y},Cf:function(){return m},Go:function(){return d},S2:function(){return xe},Lc:function(){return ve},yB:function(){return he},Nr:function(){return O},qf:function(){return oe},o:function(){return ne},sN:function(){return U},$Y:function(){return A},a9:function(){return Q}});var R=E(81337),z=E(55863),H=E(40546),V=E(20540),j=E(70163),M=E(66106),k=E(85402),Y=E(88498),Z=E(42165),I=E(63513),te={CALENDAR:{columns:["Date"]},CALENDARAUTO:{columns:["Date"]},COLUMNSTATISTICS:{columns:["Table Name","Column Name","Min","Max","Cardinality","Max Length"]},GENERATESERIES:{columns:["Value"]},"INFO.ALTERNATEOFDEFINITIONS":{columns:["ID","ColumnID","BaseColumnID","BaseTableID","Summarization"]},"INFO.ANNOTATIONS":{columns:["ID","ObjectID","ObjectType","Name","Value","ModifiedTime"]},"INFO.ATTRIBUTEHIERARCHIES":{columns:["ID","ColumnID","State","AttributeHierarchyStorageID","ModifiedTime","RefreshedTime"]},"INFO.ATTRIBUTEHIERARCHYSTORAGES":{columns:["ID","AttributeHierarchyID","SortOrder","OptimizationLevel","MaterializationType","ColumnPositionToData","ColumnDataToPosition","DistinctDataCount","DataVersion","StorageFileID","SystemTableID","HasStatistics","MinValue","MaxValue","StringValueMaxLength"]},"INFO.CALCDEPENDENCY":{columns:["DATABASE_NAME","OBJECT_TYPE","TABLE","OBJECT","EXPRESSION","REFERENCED_OBJECT_TYPE","REFERENCED_TABLE","REFERENCED_OBJECT","REFERENCED_EXPRESSION","QUERY"]},"INFO.CALCULATIONGROUPS":{columns:["ID","TableID","Description","ModifiedTime","Precedence"]},"INFO.CALCULATIONITEMS":{columns:["ID","CalculationGroupID","FormatStringDefinitionID","Name","Description","ModifiedTime","State","ErrorMessage","Expression","Ordinal"]},"INFO.CATALOGS":{columns:["CATALOG_NAME","DESCRIPTION","ROLES","DATE_MODIFIED","COMPATIBILITY_LEVEL","TYPE","VERSION","DATABASE_ID","DATABASE_GUID","DATE_QUERIED","CURRENTLY_USED","POPULARITY","WEIGHTEDPOPULARITY","CLIENTCACHEREFRESHPOLICY","ENCRYPTION_LEVEL"]},"INFO.CHANGEDPROPERTIES":{columns:["ID","ObjectID","ObjectType","Property"]},"INFO.COLUMNPARTITIONSTORAGES":{columns:["ID","ColumnStorageID","PartitionStorageID","DataVersion","State","SegmentStorageID","StorageFileID"]},"INFO.COLUMNPERMISSIONS":{columns:["ID","TablePermissionID","ColumnID","ModifiedTime","MetadataPermission"]},"INFO.COLUMNS":{columns:["ID","TableID","ExplicitName","InferredName","ExplicitDataType","InferredDataType","DataCategory","Description","IsHidden","State","IsUnique","IsKey","IsNullable","Alignment","TableDetailPosition","IsDefaultLabel","IsDefaultImage","SummarizeBy","ColumnStorageID","Type","SourceColumn","ColumnOriginID","Expression","FormatString","IsAvailableInMDX","SortByColumnID","AttributeHierarchyID","ModifiedTime","StructureModifiedTime","RefreshedTime","SystemFlags","KeepUniqueRows","DisplayOrdinal","ErrorMessage","SourceProviderType","DisplayFolder","EncodingHint","RelatedColumnDetailsID","AlternateOfID","LineageTag","SourceLineageTag"]},"INFO.COLUMNSTORAGES":{columns:["ID","ColumnID","Name","StoragePosition","DictionaryStorageID","Settings","ColumnFlags","Collation","OrderByColumn","Locale","BinaryCharacters","Statistics_DistinctStates","Statistics_MinDataID","Statistics_MaxDataID","Statistics_OriginalMinSegmentDataID","Statistics_RLESortOrder","Statistics_RowCount","Statistics_HasNulls","Statistics_RLERuns","Statistics_OthersRLERuns","Statistics_Usage","Statistics_DBType","Statistics_XMType","Statistics_CompressionType","Statistics_CompressionParam","Statistics_EncodingHint","IsDeltaPartitionColumn","DeltaColumnMappingPhysicalName","DeltaColumnMappingId","FramedSourceColumn"]},"INFO.CULTURES":{columns:["ID","ModelID","Name","LinguisticMetadataID","ModifiedTime","StructureModifiedTime"]},"INFO.DATASOURCES":{columns:["ID","ModelID","Name","Description","Type","ConnectionString","ImpersonationMode","Account","Password","MaxConnections","Isolation","Timeout","Provider","ModifiedTime","ConnectionDetails","Options","Credential","ContextExpression"]},"INFO.DELTATABLEMETADATASTORAGES":{columns:["ID","PartitionStorageID","TableName","RootLocation","CurrentVersion","TableObjectID","DatamartObjectID","FramedSchemaName","FallbackReason"]},"INFO.DETAILROWSDEFINITIONS":{columns:["ID","ObjectID","ObjectType","Expression","ModifiedTime","State","ErrorMessage"]},"INFO.DICTIONARYSTORAGES":{columns:["ID","ColumnStorageID","Type","DataType","DataVersion","BaseId","Magnitude","LastId","IsNullable","IsUnique","IsOperatingOn32","DictionaryFlags","StorageFileID","Size"]},"INFO.EXCLUDEDARTIFACTS":{columns:["ID","ObjectID","ObjectType","ArtifactType","Reference"]},"INFO.EXPRESSIONS":{columns:["ID","ModelID","Name","Description","Kind","Expression","ModifiedTime","QueryGroupID","ParameterValuesColumnID","MAttributes","LineageTag","SourceLineageTag"]},"INFO.EXTENDEDPROPERTIES":{columns:["ID","ObjectID","ObjectType","Name","Type","Value","ModifiedTime"]},"INFO.FORMATSTRINGDEFINITIONS":{columns:["ID","ObjectID","ObjectType","Expression","ModifiedTime","State","ErrorMessage"]},"INFO.FUNCTIONS":{columns:["FUNCTION_NAME","DESCRIPTION","PARAMETER_LIST","RETURN_TYPE","ORIGIN","INTERFACE_NAME","LIBRARY_NAME","DLL_NAME","HELP_FILE","HELP_CONTEXT","OBJECT","CAPTION","PARAMETERINFO","DIRECTQUERY_PUSHABLE","VISUAL_CALCULATIONS_INFO"]},"INFO.GENERALSEGMENTMAPSEGMENTMETADATASTORAGES":{columns:["ID","SegmentMapStorageID","RecordCount","Ordinal"]},"INFO.GROUPBYCOLUMNS":{columns:["ID","RelatedColumnDetailsID","GroupingColumnID","ModifiedTime"]},"INFO.HIERARCHIES":{columns:["ID","TableID","Name","Description","IsHidden","State","HierarchyStorageID","ModifiedTime","StructureModifiedTime","RefreshedTime","DisplayFolder","HideMembers","LineageTag","SourceLineageTag"]},"INFO.HIERARCHYSTORAGES":{columns:["ID","HierarchyID","Name","LevelDefinition","MaterializationType","StructureType","SystemTableID"]},"INFO.KPIS":{columns:["ID","MeasureID","Description","TargetDescription","TargetExpression","TargetFormatString","StatusGraphic","StatusDescription","StatusExpression","TrendGraphic","TrendDescription","TrendExpression","ModifiedTime"]},"INFO.LEVELS":{columns:["ID","HierarchyID","Ordinal","Name","Description","ColumnID","ModifiedTime","LineageTag","SourceLineageTag"]},"INFO.LINGUISTICMETADATA":{columns:["ID","CultureID","Content","ModifiedTime","ContentType"]},"INFO.MEASURES":{columns:["ID","TableID","Name","Description","DataType","Expression","FormatString","IsHidden","State","ModifiedTime","StructureModifiedTime","KPIID","IsSimpleMeasure","ErrorMessage","DisplayFolder","DetailRowsDefinitionID","DataCategory","LineageTag","SourceLineageTag"]},"INFO.MODEL":{columns:["ID","Name","Description","StorageLocation","DefaultMode","DefaultDataView","Culture","Collation","ModifiedTime","StructureModifiedTime","Version","DataAccessOptions","DefaultMeasureID","DefaultPowerBIDataSourceVersion","ForceUniqueNames","DiscourageImplicitMeasures","DataSourceVariablesOverrideBehavior","DataSourceDefaultMaxConnections","SourceQueryCulture","MAttributes"]},"INFO.OBJECTTRANSLATIONS":{columns:["ID","CultureID","ObjectID","ObjectType","Property","Value","ModifiedTime"]},"INFO.PARQUETFILESTORAGES":{columns:["ID","DeltaTableMetadataStorageID","Size","Location","CreatedVersion","DeletedVersion","RowgroupCount","Ordinal","ETag","DeletionVectorFileLocation","DeletionVectorBitmapOffset","DeletionVectorBitmapSize","DeletionVectorFileETag"]},"INFO.PARTITIONS":{columns:["ID","TableID","Name","Description","DataSourceID","QueryDefinition","State","Type","PartitionStorageID","Mode","DataView","ModifiedTime","RefreshedTime","SystemFlags","ErrorMessage","RetainDataTillForceCalculate","RangeStart","RangeEnd","RangeGranularity","RefreshBookmark","QueryGroupID","ExpressionSourceID","MAttributes"]},"INFO.PARTITIONSTORAGES":{columns:["ID","PartitionID","Name","StoragePosition","SegmentMapStorageID","DataObjectId","StorageFolderID"]},"INFO.PERSPECTIVECOLUMNS":{columns:["ID","PerspectiveTableID","ColumnID","ModifiedTime"]},"INFO.PERSPECTIVEHIERARCHIES":{columns:["ID","PerspectiveTableID","HierarchyID","ModifiedTime"]},"INFO.PERSPECTIVEMEASURES":{columns:["ID","PerspectiveTableID","MeasureID","ModifiedTime"]},"INFO.PERSPECTIVES":{columns:["ID","ModelID","Name","Description","ModifiedTime"]},"INFO.PERSPECTIVETABLES":{columns:["ID","PerspectiveID","TableID","IncludeAll","ModifiedTime"]},"INFO.PROPERTIES":{columns:["PropertyName","PropertyDescription","PropertyType","PropertyAccessType","IsRequired","Value"]},"INFO.QUERYGROUPS":{columns:["ID","ModelID","Folder","Description"]},"INFO.REFRESHPOLICIES":{columns:["ID","TableID","PolicyType","RollingWindowGranularity","RollingWindowPeriods","IncrementalGranularity","IncrementalPeriods","IncrementalPeriodsOffset","PollingExpression","SourceExpression"]},"INFO.RELATEDCOLUMNDETAILS":{columns:["ID","ColumnID","ModifiedTime"]},"INFO.RELATIONSHIPINDEXSTORAGES":{columns:["ID","RelationshipStorageID","IndexType","Flags","RecordCount","SecondaryRecordCount","StorageFolderID","StorageFileID","SystemTableID","SecondarySystemTableID"]},"INFO.RELATIONSHIPS":{columns:["ID","ModelID","Name","IsActive","Type","CrossFilteringBehavior","JoinOnDateBehavior","RelyOnReferentialIntegrity","FromTableID","FromColumnID","FromCardinality","ToTableID","ToColumnID","ToCardinality","State","RelationshipStorageID","RelationshipStorage2ID","ModifiedTime","RefreshedTime","SecurityFilteringBehavior"]},"INFO.RELATIONSHIPSTORAGES":{columns:["ID","RelationshipID","Name","DefinitionType","Cardinality","Flags","RelationshipIndexStorageID"]},"INFO.ROLEMEMBERSHIPS":{columns:["ID","RoleID","MemberName","MemberID","IdentityProvider","MemberType","ModifiedTime"]},"INFO.ROLES":{columns:["ID","ModelID","Name","Description","ModelPermission","ModifiedTime"]},"INFO.SEGMENTMAPSTORAGES":{columns:["ID","PartitionStorageID","Type","RecordCount","SegmentCount","RecordsPerSegment"]},"INFO.SEGMENTSTORAGES":{columns:["ID","ColumnPartitionStorageID","SegmentCount","StorageFileID"]},"INFO.STORAGEFILES":{columns:["ID","OwnerID","OwnerType","StorageFolderID","FileName"]},"INFO.STORAGEFOLDERS":{columns:["ID","OwnerID","OwnerType","Path"]},"INFO.STORAGETABLECOLUMNS":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","DIMENSION_NAME","ATTRIBUTE_NAME","TABLE_ID","COLUMN_ID","COLUMN_TYPE","COLUMN_ENCODING","DATATYPE","ISKEY","ISUNIQUE","ISNULLABLE","ISROWNUMBER","DICTIONARY_SIZE","DICTIONARY_ISPAGEABLE","DICTIONARY_ISRESIDENT","DICTIONARY_TEMPERATURE","DICTIONARY_LAST_ACCESSED"]},"INFO.STORAGETABLECOLUMNSEGMENTS":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","PARTITION_NAME","DIMENSION_NAME","TABLE_ID","COLUMN_ID","SEGMENT_NUMBER","TABLE_PARTITION_NUMBER","RECORDS_COUNT","ALLOCATED_SIZE","USED_SIZE","COMPRESSION_TYPE","BITS_COUNT","BOOKMARK_BITS_COUNT","VERTIPAQ_STATE","ISPAGEABLE","ISRESIDENT","TEMPERATURE","LAST_ACCESSED"]},"INFO.STORAGETABLES":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","DIMENSION_NAME","TABLE_ID","TABLE_PARTITIONS_COUNT","HINT_TABLE_TYPE","ROWS_COUNT","RIVIOLATION_COUNT"]},"INFO.TABLEPERMISSIONS":{columns:["ID","RoleID","TableID","FilterExpression","ModifiedTime","State","ErrorMessage","MetadataPermission"]},"INFO.TABLES":{columns:["ID","ModelID","Name","DataCategory","Description","IsHidden","TableStorageID","ModifiedTime","StructureModifiedTime","SystemFlags","ShowAsVariationsOnly","IsPrivate","DefaultDetailRowsDefinitionID","AlternateSourcePrecedence","RefreshPolicyID","CalculationGroupID","ExcludeFromModelRefresh","LineageTag","SourceLineageTag"]},"INFO.TABLESTORAGES":{columns:["ID","TableID","Name","Version","Settings","RIViolationCount","StorageFolderID"]},"INFO.VARIATIONS":{columns:["ID","ColumnID","Name","Description","RelationshipID","DefaultHierarchyID","DefaultColumnID","IsDefault"]}},ee=E(19194),i=function(){function u(s,l){this.inlineVariables=[],this._parameterContexts=[];var v=function(u){return!!u.matchObjects}(s)?s.matchObjects:s;if(this._homeContext=this,this._matchObjects=v,this.inlineVariables=[],this.filterExpressionState=0,this._parameterContexts=[],this._ephemeralContexts=[],!(s instanceof y)){var L=s;this._previousContext=L,this._homeContext=L.homeContext,this._earliestContext=L.earliestContext,this._earlierContext=L.earlierContext,this.currentTable=L.currentTable,this.groupByCurrentTable=L.groupByCurrentTable,this.inlineVariables=this.inlineVariables.concat(L.inlineVariables),this.filterExpressionState=L.filterExpressionState,l&&L.parameterContexts&&(this._parameterContexts=this._parameterContexts.concat(L.parameterContexts))}}return Object.defineProperty(u.prototype,"matchObjects",{get:function(){return this._matchObjects},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"homeContext",{get:function(){return this._homeContext},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"earlierContext",{get:function(){return this._earlierContext},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"earliestContext",{get:function(){return this._earliestContext},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"ephemeralContexts",{get:function(){return this._ephemeralContexts},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"parameterContexts",{get:function(){return this._parameterContexts},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"variables",{get:function(){return I.Sy.union(this.matchObjects.variables,this.inlineVariables,ye)},enumerable:!1,configurable:!0}),u.prototype.getTablesInScopeForQualifiedColRefs=function(){return this.getTablesInScopeForQualifiedColRefsEx(void 0,M.Yl.None.columnReferenceScope)},u.prototype.getAllTablesInScopeForQualifiedColRefs=function(){return _.union(this.getTablesInScopeForQualifiedColRefs(),_.flatten(_.map(this.ephemeralContexts,function(s){return s.getTablesInScopeForQualifiedColRefs()})))},u.prototype.getSimpleColumnRefsInScope=function(){return this.getSimpleColumnRefsInScopeEx(void 0,M.Yl.None.columnReferenceScope)},u.prototype.getAllSimpleColRefsInScope=function(){return this.getSimpleColumnRefsInScope().concat(_.flatten(_.map(this.ephemeralContexts,function(s){return s.getSimpleColumnRefsInScope()})))},u.prototype.getAllTables=function(){var s=this.matchObjects.tables;return this.currentTable&&(s=s.concat(this.currentTable.constructedTables)),s.concat(_.chain(this.ephemeralContexts).filter(function(l){return!!l.currentTable}).map(function(l){return l.currentTable.constructedTables}).flatten().value())},u.prototype.getTablesInScopeForQualifiedColRefsEx=function(s,l){if(s||(s=this.currentTable),l===M.Yl.None.columnReferenceScope)switch(this.filterExpressionState){case 1:l=18;break;case 0:case 2:l=3}var v=[];if(I.G.hasFlag(l,16))v=_.union(v,this.matchObjects.tables);else{if(I.G.hasFlag(l,1)&&null!=s&&(v=_.union(v,s.immediateTables)),I.G.hasFlag(l,32)){var L=this.homeContext.currentTable;null!=L&&(v=_.union(v,L.immediateTables))}I.G.hasFlag(l,4)&&null!=s&&(v=_.union(v,s.relatedTables))}return I.G.hasFlag(l,2)&&null!=s&&(v=_.union(v,_.filter(s.constructedTables,function(J){return!I.uI.isNullOrEmpty(J.name)}))),v},u.prototype.getSimpleColumnRefsInScopeEx=function(s,l){var v=l;if(s||(s=this.currentTable),l===M.Yl.None.columnReferenceScope||64===l)switch(this.filterExpressionState){case 1:case 2:l=18;break;case 0:l=3}var L=[];if(I.G.hasFlag(l,1)&&null!=s)for(var J=0,fe=s.immediateTables;J<fe.length;J++)L=L.concat(fe[J].columns);if(I.G.hasFlag(l,32)){var Ce=this.homeContext.currentTable;if(null!=Ce)for(var de=0,Re=Ce.immediateTables;de<Re.length;de++)L=L.concat(Re[de].columns)}if(I.G.hasFlag(l,8)&&null!=s)for(var Ne=0,Ie=s.relatedTables;Ne<Ie.length;Ne++)L=L.concat(Ie[Ne].columns);if(I.G.hasFlag(l,2)&&null!=s)for(var ke=0,Ge=s.constructedTables;ke<Ge.length;ke++)L=L.concat(Ge[ke].columns);if(!I.G.hasFlag(v,64))for(var Ue=0,Ze=this.matchObjects.transparentTables;Ue<Ze.length;Ue++)L=L.concat(Ze[Ue].columns);return L},u.prototype.isReservedWord=function(s){return u.isReservedWord(s,this.matchObjects.reservedWords,this.matchObjects.functions)},u.isReservedWord=function(s,l,v){return!(!s||!_.has(l,s.toUpperCase())&&!_.find(v,function(L){return I.uI.equalIgnoreCase(L.name,s)}))},u.prototype.newTableScan=function(){for(this._earlierContext=this._previousContext,this._earliestContext=this.earlierContext;null!=this.earliestContext.earlierContext;this._earliestContext=this.earliestContext.earlierContext);},u.prototype.mergeInlineVariables=function(s){_.remove(this.inlineVariables,function(l){return _.some(s,function(v){return I.uI.equalIgnoreCase(v.name,l.name)})}),this.inlineVariables=this.inlineVariables.concat(s)},u}(),K=function(){function u(s,l,v,L){this.context=s,this._currentTable=l,this._role=v,this._enumValues=L}return Object.defineProperty(u.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"allowedTypes",{get:function(){return this.role.type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentTable",{get:function(){return this._currentTable},enumerable:!1,configurable:!0}),u.prototype.getTablesInScopeForQualifiedColRefs=function(){return this.context.getTablesInScopeForQualifiedColRefsEx(this.currentTable,this.role.columnReferenceScope)},u.prototype.getSimpleColumnRefsInScope=function(){return this.context.getSimpleColumnRefsInScopeEx(this.currentTable,this.role.columnReferenceScope)},u}(),y=function(){function u(s,l,v,L,J,fe,se,Ce){this._tables=s,this._columns=l,this._measures=v,this._calendars=L,this.reservedWords=fe,this.transparentTables=se,this.visibleColumnMap={},this.visibleTableMap={},this.definedVarMap={},this.visibleMeasureMap={},this.definedMeasureMap={},this.functionMap={},this.axisMap={},this.calendarMap={},this.unhideAll();for(var de=0,Re=J;de<Re.length;de++){var Ne=Re[de];this.functionMap[C.getMatchObjectKey(Ne.name)]=Ne}for(var Ie=0,ke=Ce;Ie<ke.length;Ie++){var Ge=ke[Ie];this.axisMap[b.getMatchObjectKey(Ge.name)]=Ge}for(var Ue=0,Ze=this._calendars;Ue<Ze.length;Ue++){var ct=Ze[Ue];this.calendarMap[ct.matchObjectKey]=ct}}return Object.defineProperty(u.prototype,"axes",{get:function(){return Object.values(this.axisMap)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tables",{get:function(){return Object.values(this.visibleTableMap)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"columns",{get:function(){return Object.values(this.visibleColumnMap)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"functions",{get:function(){return Object.values(this.functionMap)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"measures",{get:function(){return Object.values((0,R.pi)((0,R.pi)({},this.definedMeasureMap),this.visibleMeasureMap))},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"variables",{get:function(){return Object.values(this.definedVarMap)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"calendars",{get:function(){return Object.values(this.calendarMap)},enumerable:!1,configurable:!0}),u.prototype.hideTable=function(s){delete this.visibleTableMap[s.matchObjectKey];for(var l=0,v=Object.entries(this.visibleColumnMap);l<v.length;l++){var L=v[l],J=L[0];L[1].table===s&&delete this.visibleColumnMap[J]}for(var se=0,Ce=Object.entries(this.visibleMeasureMap);se<Ce.length;se++){var de=Ce[se];J=de[0],de[1].table===s&&delete this.visibleMeasureMap[J]}},u.prototype.hideColumn=function(s){delete this.visibleColumnMap[s.matchObjectKey]},u.prototype.hideMeasure=function(s){delete this.visibleMeasureMap[s.matchObjectKey]},u.prototype.unhideAll=function(){for(var s=0,l=this._tables;s<l.length;s++){var v=l[s];this.visibleTableMap[v.matchObjectKey]=v}for(var L=0,J=this._columns;L<J.length;L++){var fe=J[L];this.visibleColumnMap[fe.matchObjectKey]=fe}for(var se=0,Ce=this._measures;se<Ce.length;se++){var de=Ce[se];this.visibleMeasureMap[de.matchObjectKey]=de}for(var Re=0,Ne=this._tables;Re<Ne.length;Re++)Ne[Re].unhideAll()},u.prototype.clearDefinedMeasures=function(){this.definedMeasureMap={};for(var s=0,l=this.tables;s<l.length;s++)l[s].clearDefinedMeasures()},u.prototype.clearDefinedVariables=function(){this.definedVarMap={}},u.prototype.chooseFunctions=function(s){for(var l=0,v=Object.entries(this.functionMap);l<v.length;l++){var L=v[l],J=L[0];s(L[1])||delete this.functionMap[J]}},u.prototype.mergeMeasures=function(s){for(var l=0,v=s;l<v.length;l++){var L=v[l];this.definedMeasureMap[L.matchObjectKey]||(this.definedMeasureMap[L.matchObjectKey]=L)}},u.prototype.removeDefinedMeasure=function(s,l){var v=O.getMatchObjectKey(l,s);delete this.definedMeasureMap[v]},u.prototype.mergeVariables=function(s){for(var l=0,v=s;l<v.length;l++){var L=v[l];this.definedVarMap[L.matchObjectKey]||(this.definedVarMap[L.matchObjectKey]=L)}},u.prototype.removeDefinedVariable=function(s){var l=he.getMatchObjectKey(s,!0);delete this.definedVarMap[l]},u.prototype.findAxis=function(s){return this.axisMap[b.getMatchObjectKey(s)]},u.prototype.findTable=function(s){return this.visibleTableMap[xe.getMatchObjectKey(s)]},u.prototype.findFunction=function(s){return this.functionMap[C.getMatchObjectKey(s)]},u.prototype.findVariable=function(s){var l=he.getMatchObjectKey(s,!0);return this.definedVarMap[l]},u.prototype.findCalendar=function(s){return this.calendarMap[q.getMatchObjectKey(s)]},u}(),ie=function(){function u(s,l){this._name=s,this._description=l}return Object.defineProperty(u.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),u.prototype.toString=function(){return this.name},u.prototype.getHashCode=function(){return this.name},u}(),ve=function(){return function(){this.constructedTables=[],this.immediateTables=[],this.relatedTables=[]}}(),D=function(u){function s(l){return u.call(this,l,void 0)||this}return(0,R.ZT)(s,u),s}(ie),b=function(u){function s(l){var v=u.call(this,l,void 0)||this;return v.matchObjectKey=s.getMatchObjectKey(l),v}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l){return l.toLowerCase()},Object.defineProperty(s.prototype,"description",{get:function(){return"rows"===this.name.toLowerCase()?ee.m.localizedStrings.rowsDescription:"columns"===this.name.toLowerCase()?ee.m.localizedStrings.columnsDescription:"rows columns"===this.name.toLowerCase()?ee.m.localizedStrings.rowsColumnsDescription:"columns rows"===this.name.toLowerCase()?ee.m.localizedStrings.columnsRowsDescription:""},enumerable:!1,configurable:!0}),s}(ie),q=function(u){function s(l,v){var L=u.call(this,l,void 0)||this;return L._table=v,L.matchObjectKey=s.getMatchObjectKey(l),L}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l){return l.toLowerCase()},Object.defineProperty(s.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),s}(ie),he=function(u){function s(l,v,L){void 0===L&&(L=!1);var J=u.call(this,l,void 0)||this;return J.variableNode=v,J._isQueryScoped=L,J.matchObjectKey=s.getMatchObjectKey(l,L),J}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l,v){return"".concat(l.toLowerCase(),":").concat(v)},Object.defineProperty(s.prototype,"value",{get:function(){return this.variableNode&&this.variableNode.value},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isQueryScoped",{get:function(){return this._isQueryScoped},enumerable:!1,configurable:!0}),s}(ie);function ye(u,s){return u===s||I.uI.equalIgnoreCase(u.name,s.name)}function Me(u,s){return u===s||I.uI.equalIgnoreCase(u.name,s.name)}var xe=function(u){function s(l,v,L,J,fe,se){void 0===J&&(J=l),void 0===fe&&(fe=!1),void 0===se&&(se=!0);var Ce=u.call(this,l,v)||this;return Ce.visibleColumnMap={},Ce.visibleMeasureMap={},Ce.definedMeasureMap={},Ce._uberTable=new ve,Ce._uberTable.immediateTables.push(Ce),Ce._quoteNeeded=L,Ce._tableId=J,Ce._columnMap={},Ce._measureMap={},Ce._calendarMap={},Ce._isTransparent=fe,Ce._isUserTable=se,Ce.matchObjectKey=s.getMatchObjectKey(l),Ce.unhideAll(),Ce}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l){return l.toLowerCase()},Object.defineProperty(s.prototype,"isTransparent",{get:function(){return this._isTransparent},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"quoteNeeded",{get:function(){return this._quoteNeeded},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"uberTable",{get:function(){return this._uberTable},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"tableId",{get:function(){return this._tableId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"columns",{get:function(){return this.visibleColumns},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"measures",{get:function(){return Object.values((0,R.pi)((0,R.pi)({},this.definedMeasureMap),this.visibleMeasureMap))},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"calendars",{get:function(){return Object.values((0,R.pi)({},this._calendarMap))},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isUserTable",{get:function(){return this._isUserTable},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"visibleColumns",{get:function(){return Object.values(this.visibleColumnMap)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"visibleMeasures",{get:function(){return Object.values(this.visibleMeasureMap)},enumerable:!1,configurable:!0}),s.prototype.addColumn=function(l){this._columnMap[l.matchObjectKey]=l,this.visibleColumnMap[l.matchObjectKey]=l},s.prototype.addMeasure=function(l){this._measureMap[l.matchObjectKey]=l,this.visibleMeasureMap[l.matchObjectKey]=l},s.prototype.addCalendar=function(l){this._calendarMap[l.matchObjectKey]=l},s.prototype.hideColumn=function(l){delete this.visibleColumnMap[l.matchObjectKey]},s.prototype.hideMeasure=function(l){delete this.visibleMeasureMap[l.matchObjectKey]},s.prototype.unhideAll=function(){this.visibleColumnMap=(0,R.pi)({},this._columnMap),this.visibleMeasureMap=(0,R.pi)({},this._measureMap)},s.prototype.getAutoCompleteName=function(l){return l||this.quoteNeeded?I.LP.quote(this.name):this.name},s.prototype.clearDefinedMeasures=function(){this.definedMeasureMap={}},s.prototype.mergeDefinedMeasure=function(l){(0,z.hu)(l.isQueryScoped,"Should only be merging defined measures"),this.definedMeasureMap[l.matchObjectKey]||(this.definedMeasureMap[l.matchObjectKey]=l)},s.prototype.removeDefinedMeasure=function(l){var v=O.getMatchObjectKey(this.name,l);delete this.definedMeasureMap[v]},s.prototype.findColumn=function(l){var v=je.getMatchObjectKey(this.name,l);return this.visibleColumnMap[v]},s.prototype.findMeasure=function(l){var v=O.getMatchObjectKey(this.name,l),L=m.getMatchObjectKey(this.name,l);return this.definedMeasureMap[v]||this.visibleMeasureMap[L]},s}(ie),je=function(u){function s(l,v,L){var J=u.call(this,l,v)||this;return J._table=L,J.matchObjectKey=s.getMatchObjectKey(L.name,l),J}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l,v){return"".concat(l.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(s.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),s}(ie),ge=function(u){function s(l,v){return u.call(this,l,v)||this}return(0,R.ZT)(s,u),s}(ie),Oe=function(){function u(s,l,v,L,J,fe,se,Ce){this._name=s,this._type=l,this._repeatable=v,this._optional=L,this._repeatGroup=v?J:-1,this._role=fe,this._skippable=se,this._enumValues=Ce}return Object.defineProperty(u.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"optional",{get:function(){return this._optional},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"repeatable",{get:function(){return this._repeatable},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"repeatGroup",{get:function(){return this._repeatGroup},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"skippable",{get:function(){return this._skippable},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),u.prototype.getNameForPrototype=function(s){void 0===s&&(s=0);var l=this.optional,v=this.name;return this.repeatable&&(v+=s,s>1&&(l=!0)),l&&(v="[".concat(v,"]")),v},u}(),re=function(u){function s(l,v,L,J,fe){void 0===fe&&(fe=[]);var se=u.call(this,l,v)||this;return se._returnType=L,se._role=J,se._signatures=fe,se}return(0,R.ZT)(s,u),Object.defineProperty(s.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"signatures",{get:function(){return this._signatures},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"returnType",{get:function(){return this._returnType},enumerable:!1,configurable:!0}),s.prototype.getParamCount=function(l){return l?l.getParameterCount():0},s.prototype.getTableReturnValue=function(l,v){var L;switch(this.role){case 2:case 8194:if(v){L=new ve;for(var J=this.getParamCount(v),fe=0,se=this.signatures;fe<se.length;fe++)new Se(l,se[fe],v,J,L).iterate()}break;case 4:case 4096:case 12:case 16384:(0,z.hu)(!!te[this.name],"Function ".concat(this.name," does not have a schema defined.")),L=new ve;var de=new xe("",void 0,!1);te[this.name].columns.forEach(function(Re){de.addColumn(new je(Re,void 0,de))}),L.immediateTables.push(de);break;case 8:L=l.groupByCurrentTable}return L},s.prototype.getContextForParam=function(l,v,L){for(var J,fe=this.signatures.map(function(Ve){return new me(l,Ve,v,L)}),Ce=I.jl.getAllExploredStates(fe).completedStates.filter(function(Ve){return Ve.prototypeParam<Ve.prototypeSignature.length}),de=new i(l,!1),Re=v.getParameter(L),Ne=!1,Ie=!1,ke=0,Ge=Ce;ke<Ge.length;ke++){var ct=(Ue=Ge[ke]).prototypeSignature[Ue.prototypeParam],rt=ct.role,tt=M.Rv.getTypes(rt,l),nt=!0;if(tt!==M.Yl.None.type&&(Re.couldBeType({type:tt})||(nt=!1,Ne=!0)),nt){Ue.paramContext.prototypeParam=Ue.prototypeParam,Ue.paramContext.skippedParameters=Ue.skippedParameters,de.parameterContexts.push(Ue.paramContext);var dt=void 0,Je=rt.argumentContextAction;if(3===Je||1===Je||2===Je){var qe=de.currentTable,We=de.currentTable;(2===Je||3===Je)&&Ue.extractedColumns.length>0?((We=new ve).constructedTables=We.constructedTables.concat(Ue.extractedColumns),null!=qe&&(We.immediateTables=We.immediateTables.concat(qe.immediateTables),We.relatedTables=We.relatedTables.concat(qe.relatedTables),We.constructedTables=We.constructedTables.concat(qe.constructedTables))):(1===Je||3===Je)&&null!=Ue.extractedTable&&(qe?((We=new ve).immediateTables=We.immediateTables.concat(qe.immediateTables.concat(Ue.extractedTable.immediateTables)),We.relatedTables=We.relatedTables.concat(qe.relatedTables.concat(Ue.extractedTable.relatedTables)),We.constructedTables=We.constructedTables.concat(qe.constructedTables.concat(Ue.extractedTable.constructedTables))):We=Ue.extractedTable),We!==qe&&(de.currentTable=We,de.newTableScan())}else 4===Je?dt=Ue.extractedTable:5===Je?de.currentTable=void 0:6===Je?de.currentTable=de.earlierContext?de.earlierContext.currentTable:void 0:7===Je&&(de.currentTable=de.earliestContext?de.earliestContext.currentTable:void 0);if(I.G.hasFlag(rt.additionalBehaviors,1)&&(de.groupByCurrentTable=Ue.extractedTable),I.G.hasFlag(rt.additionalBehaviors,2)?de.filterExpressionState=1:!_.isEqual(rt,M.Yl.None)&&!I.G.hasFlag(rt.type,1)&&(de.filterExpressionState=0),I.G.hasFlag(rt.additionalBehaviors,4)&&(J=de.ephemeralContexts).push.apply(J,_.chain(l.ephemeralContexts).filter(function(Ve){return!!(Ve.allowedTypes&M.XD)}).map(function(Ve){return new K(de,Ve.currentTable,(0,R.pi)((0,R.pi)({},Ve.role),{type:M.XD}),Ve.enumValues)}).value()),tt!==M.Yl.None.type){var ht=M.Rv.transformRole(rt,l);de.ephemeralContexts.push(new K(de,dt,ht,I.G.hasFlag(ht.type,64)?ct.enumValues:void 0))}else Ie=!0}}if(0===de.parameterContexts.length)for(var mt=0,Tt=Ce;mt<Tt.length;mt++){var Ue;(Ue=Tt[mt]).paramContext.prototypeParam=Ue.prototypeParam,de.parameterContexts.push(Ue.paramContext)}return Ne&&0===de.ephemeralContexts.length&&de.ephemeralContexts.push(new K(de,void 0,H.d.featureSwitches.useSkippableParams&&!Ie?M.Yl.InvalidParam:M.Yl.None,void 0)),de},s.prototype.getDefaultPrototype=function(){for(var v="",L=0,J=this.getPrototype(void 0);L<J.length;L++){var fe=J[L];v+=fe.text+fe.separator}return v},s.prototype.getPrototype=function(l){var v=[];v.push({text:this.name+"(",separator:"",bold:!1});for(var J=l?l.prototypeSignature:this.signatures[0],fe=l?l.prototypeParam:-1,se=J.length,Ce=0,de=0;de<se;){var Re=J[de];if(Re.repeatable){var Ne=void 0;for(Ne=de+1;Ne<se&&((Ie=J[Ne]).repeatable&&Ie.repeatGroup===Re.repeatGroup);Ne++);var ke=0;l&&Ce<l.repeatCounts.length&&(ke=l.repeatCounts[Ce]),Ce++;var Ge=fe<Ne;if(Ge&&ke++,ke>0){if(ke>1){for(var Ue=de;Ue<Ne;Ue++){var Ie=J[Ue];T(l?.skippedParameters,Ue,0)||v.push({text:Ie.getNameForPrototype(1)+Y.ft().listSeparator,separator:" ",bold:!1})}ke>2&&v.push({text:"..."+Y.ft().listSeparator,separator:" ",bold:!1})}for(;de<Ne;de++)Re=J[de],!T(l?.skippedParameters,de,ke-1)&&v.push({text:Re.getNameForPrototype(ke)+Y.ft().listSeparator,separator:" ",bold:de===fe});Ge&&v.push({text:"..."+Y.ft().listSeparator,separator:" ",bold:!1})}else de=Ne}else T(l?.skippedParameters,de,0)||v.push({text:Re.getNameForPrototype()+Y.ft().listSeparator,separator:" ",bold:de===fe}),de++}if(v.length>1){var Ze=_.last(v);v[v.length-1]={text:Ze.text.substr(0,Ze.text.length-Y.ft().listSeparator.length),separator:"",bold:Ze.bold}}return v.push({text:")",separator:"",bold:!1}),v},s}(ie),P=function(){function u(){this.success=!1,this.badParam=-1,this.firstExtraParam=-1,this.incomplete=!1,this.associatedSignature=[]}return u.prototype.assessStatus=function(s,l,v,L){if(s<l)v<L.length?(this.badParam=Math.max(this.badParam,s),this.associatedSignature=L):this.firstExtraParam=Math.max(this.firstExtraParam,s);else{for(;v<L.length&&L[v].optional;v++);v<L.length?this.incomplete=!0:this.success=!0}},u.prototype.markSuccess=function(){this.success=!0},u}(),p=function(){function u(s,l){this.paramNumber=s,this.repeatCount=l}return u.prototype.equals=function(s){return!(this.paramNumber!==s.paramNumber||this.repeatCount!==s.repeatCount)},u}();function T(u,s,l){return!(!H.d.featureSwitches.useSkippableParams||!u?.find(function(v){return v.equals(new p(s,l))}))}var d=function(){function u(s){this.prototypeSignature=[],this.prototypeParam=s?s.prototypeParam:0,this.skippedParameters=s?_.toArray(s.skippedParameters):[],this._repeatCounts=s?_.toArray(s.repeatCounts):[]}return Object.defineProperty(u.prototype,"repeatCounts",{get:function(){return this._repeatCounts},enumerable:!1,configurable:!0}),u.prototype.equals=function(s){if(this.prototypeParam!==s.prototypeParam||this.repeatCounts.length!==s.repeatCounts.length)return!1;for(var l=0;l<this.repeatCounts.length;l++)if(this.repeatCounts[l]!==s.repeatCounts[l])return!1;if(H.d.featureSwitches.useSkippableParams){if(this.skippedParameters.length!==s.skippedParameters.length)return!1;for(l=0;l<this.skippedParameters.length;l++)if(!this.skippedParameters[l].equals(s.skippedParameters[l]))return!1}return!0},u}(),C=function(u){function s(l,v,L,J,fe,se,Ce){var de=u.call(this,l,v,fe,se,Ce)||this;return de._category=L,de._pushableToDirectQuery=J,de.matchObjectKey=s.getMatchObjectKey(l),de}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l){return l.toLowerCase()},Object.defineProperty(s.prototype,"pushableToDirectQuery",{get:function(){return this._pushableToDirectQuery},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"category",{get:function(){return this._category},enumerable:!1,configurable:!0}),s.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME="CALCULATE",s}(re),m=function(u){function s(l,v,L,J,fe){void 0===fe&&(fe=!1);var se=u.call(this,l,v,J.returnType,J.role,s.removeFirstParam(J.signatures))||this;return se._table=L,se._isQueryScoped=fe,se.matchObjectKey=s.getMatchObjectKey(L.name,l),se}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l,v){return"".concat(l.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(s.prototype,"isQueryScoped",{get:function(){return this._isQueryScoped},enumerable:!1,configurable:!0}),s.removeFirstParam=function(l){(0,z.mv)(1===l.length,"Expected exactly one parameter prototype");var v=_.toArray(l[0]);return v.shift(),[v]},Object.defineProperty(s.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),s}(re),O=function(u){function s(l,v,L,J,fe){var se=u.call(this,l,v,L,J,!0)||this;return se._measureExpressionNode=fe,se.matchObjectKey=s.getMatchObjectKey(L.name,l),se}return(0,R.ZT)(s,u),s.getMatchObjectKey=function(l,v){return"".concat(l.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(s.prototype,"measureExpressionNode",{get:function(){return this._measureExpressionNode},enumerable:!1,configurable:!0}),s}(m),A=function(){function u(s,l){this.leadingTrivia=[],this.trailingTrivia=[],this._parent=s,this.cachedContext=l}return Object.defineProperty(u.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"fullSpan",{get:function(){return Z.X.fromTokens(this.firstDescendent.token,this.lastDescendent.token)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tableValue",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tableRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"qualifiedColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"filterColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"simpleColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isDataTable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"string",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tupleCardinality",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"axesRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isValidAxisValue",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isValidEnumValue",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"calendarRef",{get:function(){},enumerable:!1,configurable:!0}),u.prototype.getRolledUpColumns=function(s){},u.prototype.getChildFunctionName=function(){},u.prototype.couldBeType=function(s){return!1},Object.defineProperty(u.prototype,"context",{get:function(){return(!this.cachedContext||Y.Mz.alwaysRebuildContext)&&this.parent&&(this.cachedContext=this.parent.getContextForChild(this)),this.cachedContext},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"segment",{get:function(){return Z.X.fromTokens(this.firstDescendent.token,this.lastDescendent.token)},enumerable:!1,configurable:!0}),u.prototype.onParseComplete=function(){},u.prototype.onParseIncomplete=function(){},Object.defineProperty(u.prototype,"selfDescription",{get:function(){if(Y.Mz.debugging){var l=this.constructor.name.toString();return _.endsWith(l,"Node")&&(l=l.substr(0,l.length-4)),l}},enumerable:!1,configurable:!0}),u.prototype.clearContext=function(){this.cachedContext=void 0},u.prototype.printSelf=function(s){},u.prototype.printSelfAndChildren=function(s){Y.Mz.debugging&&(this.printSelf(s),this.printChildren(s+2))},u.prototype.printChildren=function(s){},u}(),U=function(u){function s(l,v){return u.call(this,l,v)||this}return(0,R.ZT)(s,u),Object.defineProperty(s.prototype,"tableValue",{get:function(){return this.getFromOnlyChild(function(v){return v.tableValue})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"tableRef",{get:function(){return this.getFromOnlyChild(function(v){return v.tableRef})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"qualifiedColumnRef",{get:function(){return this.getFromOnlyChild(function(v){return v.qualifiedColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"simpleColumnRef",{get:function(){return this.getFromOnlyChild(function(v){return v.simpleColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"string",{get:function(){return this.getFromOnlyChild(function(v){return v.string})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isDataTable",{get:function(){return this.getFromOnlyChild(function(v){return v.isDataTable})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"tupleCardinality",{get:function(){return this.getFromOnlyChild(function(v){return v.tupleCardinality})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"axesRef",{get:function(){return this.getFromOnlyChild(function(v){return v.axesRef})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isValidAxisValue",{get:function(){return this.getFromOnlyChild(function(v){return v.isValidAxisValue})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isValidEnumValue",{get:function(){return this.getFromOnlyChild(function(v){return v.isValidEnumValue})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"calendarRef",{get:function(){return this.getFromOnlyChild(function(v){return v.calendarRef})},enumerable:!1,configurable:!0}),s.prototype.getRolledUpColumns=function(l){return this.getFromOnlyChild(function(v){return v.getRolledUpColumns(l)})},s.prototype.getChildFunctionName=function(){return this.getFromOnlyChild(function(l){return l.getChildFunctionName()})},s.prototype.couldBeType=function(l){return this.getFromOnlyChild(function(v){return v.couldBeType(l)})},s}(A),Q=function(u){function s(l,v,L){var J=u.call(this,l,L)||this;return J.types=_.isArray(v)?v:[v],J}return(0,R.ZT)(s,u),Object.defineProperty(s.prototype,"leafPosition",{get:function(){return this._leafPosition},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"token",{get:function(){return this._leafPosition.token},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"path",{get:function(){return this._path},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"firstDescendent",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"lastDescendent",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"valid",{get:function(){return!this.path||this.path.isValid},enumerable:!1,configurable:!0}),s.prototype.eatToken=function(l,v){if(this.leafPosition)return V.R.NotHungry;for(var L=l.token,J=!1,fe=0,se=this.types;fe<se.length;fe++)if(L.matchesType(se[fe])){J=!0;break}return J||this.otherwiseMatchesToken(L)?(this._path=new k.q(v),this._leafPosition=l,this._leafPosition.addNode(this),V.R.Yum):V.R.Yuck},Object.defineProperty(s.prototype,"isValidEnumValue",{get:function(){var v=this,L=_.flatMap(this.context.ephemeralContexts,function(J){return J.enumValues}).filter(function(J){return!!J});return!_.isEmpty(L)&&_.some(L,function(J){return I.uI.equalIgnoreCase(J.name,v.token.getString())})},enumerable:!1,configurable:!0}),s.prototype.consolidatePath=function(){this._path=this.path.consolidatePath()},s.prototype.otherwiseMatchesToken=function(l){return!1},s}(A),oe=function(){function u(s){this._nodes=[],this._token=s}return Object.defineProperty(u.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"validNodes",{get:function(){return _.filter(this.nodes,function(l){return l.valid})},enumerable:!1,configurable:!0}),u.prototype.addNode=function(s){this.nodes.push(s)},u.prototype.rebindToken=function(s){this._token=s},Object.defineProperty(u.prototype,"isInParseTree",{get:function(){return _.some(this.nodes,function(l){return l.parent})},enumerable:!1,configurable:!0}),u}(),ne=function(){function u(s,l,v,L,J){this.parentContext=s,this._prototypeSignature=l,this._actualParameters=v,this._actualParamMax=L,this._useMismatchedState=J,this._useMismatchedState=J,this._completedStates=[],this._incompleteStates=[]}return Object.defineProperty(u.prototype,"completedStates",{get:function(){return this._completedStates},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"incompleteStates",{get:function(){return this._incompleteStates},enumerable:!1,configurable:!0}),u.prototype.iterate=function(){var s=[],l=[];for(s.push(this.newIteration());;){var v=void 0;if(s.length>0)v=s.shift();else if(this._useMismatchedState&&0===this.completedStates.length){for(var L=void 0,J=!1,fe=0,se=l;fe<se.length;fe++){var Ce=se[fe];!L||Ce.actualParam>L.actualParam?(L=Ce,J=!1):Ce.actualParam===L.actualParam&&(J=!0)}l.length=0,L&&!J&&(v=L).advanceParameter()}if(!v)break;v.iterate(s,l)?this.completedStates.push(v):this.incompleteStates.push(v)}},u.prototype.newIteration=function(){return new pe(this)},u}(),pe=function(){function u(s){this._actualParam=0,this._prototypeParam=0,this._skippedParameters=[],this._prototypeSignature=[],this.repeatStart=-1,this._repeated=!1,this.repeatGroup=-1,this.repeatCount=0,s instanceof u?(this.paramIter=s.paramIter,this._actualParam=s.actualParam,this._prototypeParam=s.prototypeParam,this._skippedParameters=s.skippedParameters?_.toArray(s.skippedParameters):[],this._prototypeSignature=s._prototypeSignature,this.repeatStart=s.repeatStart,this._repeated=s.repeated,this.repeatGroup=s.repeatGroup,this.repeatCount=s.repeatCount):(this.paramIter=s,this._prototypeSignature=s._prototypeSignature)}return Object.defineProperty(u.prototype,"actualParam",{get:function(){return this._actualParam},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"prototypeParam",{get:function(){return this._prototypeParam},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"skippedParameters",{get:function(){return this._skippedParameters},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"prototypeSignature",{get:function(){return this._prototypeSignature},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"repeated",{get:function(){return this._repeated},enumerable:!1,configurable:!0}),u.prototype.advanceParameter=function(){this._prototypeParam++,this._actualParam++},u.prototype.skipCurrentParameter=function(){this._skippedParameters.push(new p(this.prototypeParam,this.repeatCount)),this._prototypeParam++},u.prototype.iterate=function(s,l){for(var L,J,fe,v=this;;){if(this.repeatStart>-1&&(this.prototypeParam>=this.paramIter._prototypeSignature.length||this.paramIter._prototypeSignature[this.prototypeParam].repeatGroup!==this.repeatGroup)){if(this.repeat(),H.d.featureSwitches.useSkippableParams){if(this.skippedParameters.filter(function(Rt){return Rt.repeatCount===v.repeatCount}).length===this.paramIter._prototypeSignature.filter(function(Rt){return Rt.repeatGroup===v.repeatGroup}).length)return!1;this.repeatCount++}var se=this.clone();se.repeatStart=-1,se._repeated=!1,se.repeatCount=0,s.push(se),this._repeated=!0,this._prototypeParam=this.repeatStart}if(this.prototypeParam>=this.paramIter._prototypeSignature.length)return this.actualParam===this.paramIter._actualParamMax;var Ce=this.paramIter._prototypeSignature[this.prototypeParam],de=Ce.role,Re=M.Rv.getTypes(de,this.paramIter.parentContext);if(-1===this.repeatStart){if(Ce.optional&&Ce.repeatable){var Ne;for((Ne=this.clone())._prototypeParam++;Ne.prototypeParam<this.paramIter._prototypeSignature.length&&this.paramIter._prototypeSignature[Ne.prototypeParam].repeatGroup===Ce.repeatGroup;)Ne._prototypeParam++;Ne.newRepeatGroup(),s.push(Ne)}Ce.repeatable&&(this.repeatStart=this.prototypeParam,this.repeatGroup=Ce.repeatGroup,this.newRepeatGroup())}if(H.d.featureSwitches.useSkippableParams&&Ce.skippable&&((Ne=this.clone()).skipCurrentParameter(),s.push(Ne)),this.actualParam===this.paramIter._actualParamMax)return!0;var Ie=!1,ke=this.paramIter._actualParameters.getParameter(this.actualParam);if(null==ke)Ie=Ce.optional;else{var Ge=void 0;if(!Ie&&I.G.hasFlag(Re,2)){var Ue=ke.getTableValue();(Ie=null!=Ue)&&(this.handleTableValue(de,Ue),Ge=2)}if(!Ie&&I.G.hasFlag(Re,4)){var Ze=ke.getTableRef();(Ie=null!=Ze)&&(this.handleTableRef(de,Ze),Ge=4)}var ct=!1,rt=void 0,tt=void 0,nt=void 0;if(this.prototypeParam>0&&(rt=T(this.skippedParameters,this.prototypeParam-1,this.repeatCount),nt=M.Rv.getTypes((tt=this.paramIter._prototypeSignature[this.prototypeParam-1]).role,this.paramIter.parentContext),rt&&I.G.hasFlag(nt,32)&&(Re=24,ct=!0)),!Ie&&I.G.hasFlag(Re,8)){var dt=ke.getQualifiedColumnRef();(Ie=!!dt)&&(ct&&this.handleNewCol(tt.role,dt.table.name,dt.name,dt.table.quoteNeeded),this.handleQualifiedColRef(de,dt),Ge=8)}if(!Ie&&I.G.hasFlag(Re,16)){var Je=ke.getSimpleColumnRef();(Ie=null!=Je)&&(ct&&this.handleNewCol(tt.role,Je.table.name,Je.name,Je.table.quoteNeeded),this.handleSimpleColRef(de,Je),Ge=16)}if(!Ie&&I.G.hasFlag(Re,32)){var qe=ke.getString();if(Ie=!!qe){var We=void 0,ht={table:void 0,column:void 0};j.J.tryParseColumnReference(qe,ht)?We=I.LP.quoteNeeded(ht.table,this.paramIter.parentContext):(ht.column=qe,ht.table="",We=!1),this.handleNewCol(de,ht.table,ht.column,We),Ge=32}}if(!Ie&&I.G.hasFlag(Re,2048)&&(Ie=null!=ke.getString(),Ge=2048),!Ie&&Re&M.e9){var mt=ke.getRolledUpColumns({type:Re});if(Ie=null!=mt)for(var Tt=0,Ve=mt;Tt<Ve.length;Tt++)this.handleSimpleColRef(de,Ve[Tt]);Ge=Re&M.e9}!Ie&&I.G.hasFlag(Re,16384)&&(Ie="ORDERBY"===(null===(L=ke.getChildFunctionName())||void 0===L?void 0:L.toUpperCase()))&&(Ge=16384),!Ie&&I.G.hasFlag(Re,32768)&&(Ie="PARTITIONBY"===(null===(J=ke.getChildFunctionName())||void 0===J?void 0:J.toUpperCase()))&&(Ge=32768),!Ie&&I.G.hasFlag(Re,524288)&&(Ie=ke.hasValidAxisValue())&&(Ge=524288),!Ie&&I.G.hasFlag(Re,65536)&&(Ie=ke.hasValidAxisRef())&&(Ge=65536),!Ie&&I.G.hasFlag(Re,131072)&&(Ie="MATCHBY"===(null===(fe=ke.getChildFunctionName())||void 0===fe?void 0:fe.toUpperCase()))&&(Ge=131072),ke.isDataTable?!Ie&&I.G.hasFlag(Re,4096)&&(Ie=!0,Ge=4096):(!Ie&&I.G.hasFlag(Re,64)&&(Ie=ke.hasValidEnumValue())&&(Ge=64),!Ie&&I.G.hasFlag(Re,1)&&(Ie=!0,Ge=1),!Ie&&I.G.hasFlag(Re,1048576)&&(Ie=null!=ke.getCalendarRef())&&(Ge=1048576),Re===M.Yl.None.type&&(Ie=!0)),Ie&&ke.storeMatchedType({type:Ge})}if(!Ie)return this.paramIter._useMismatchedState&&l.push(this),!1;this.advanceParameter()}},u.prototype.repeat=function(){},u.prototype.newRepeatGroup=function(){},u.prototype.clone=function(){return new u(this)},u.prototype.handleTableValue=function(s,l){},u.prototype.handleTableRef=function(s,l){},u.prototype.handleQualifiedColRef=function(s,l){},u.prototype.handleSimpleColRef=function(s,l){},u.prototype.handleNewCol=function(s,l,v,L){},u}(),me=function(u){function s(l,v,L,J){return u.call(this,l,v,L,J,!0)||this}return(0,R.ZT)(s,u),s.prototype.newIteration=function(){return new Ee(this)},s}(ne),Ee=function(u){function s(l){var v=this;return l instanceof ne?((v=u.call(this,l)||this)._paramContext=new d,v._extractedColumns=[]):((v=u.call(this,l)||this)._paramContext=new d(l.paramContext),v._extractedTable=l.extractedTable,v._extractedColumns=l.extractedColumns.slice()),v._paramContext.prototypeSignature=v.prototypeSignature,v}return(0,R.ZT)(s,u),Object.defineProperty(s.prototype,"extractedColumns",{get:function(){return this._extractedColumns},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"paramContext",{get:function(){return this._paramContext},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"extractedTable",{get:function(){return this._extractedTable},enumerable:!1,configurable:!0}),s.prototype.repeat=function(){this.paramContext.repeatCounts[this.paramContext.repeatCounts.length-1]++},s.prototype.newRepeatGroup=function(){this.paramContext.repeatCounts.push(0)},s.prototype.clone=function(){return new s(this)},s.prototype.handleTableValue=function(l,v){this.checkExtractTable(l,v)},s.prototype.handleTableRef=function(l,v){this.checkExtractTable(l,v)},s.prototype.handleQualifiedColRef=function(l,v){this.checkExtractTable(l,v.table.uberTable),this.checkExtractColumn(l,function(){return w.isolatedClone(v)})},s.prototype.handleSimpleColRef=function(l,v){this.checkExtractColumn(l,function(){return w.isolatedClone(v)})},s.prototype.handleNewCol=function(l,v,L,J){this.checkExtractColumn(l,function(){return w.buildIsolatedColumn(L,v,J)})},s.prototype.checkExtractTable=function(l,v){I.G.hasFlag(l.argumentAction,4)&&(this._extractedTable=v)},s.prototype.checkExtractColumn=function(l,v){I.G.hasFlag(l.argumentAction,8)&&this._extractedColumns.push(v().table)},s}(pe),Se=function(u){function s(l,v,L,J,fe){var se=u.call(this,l,v,L,J,!1)||this;return se.resultTable=fe,se}return(0,R.ZT)(s,u),s.prototype.newIteration=function(){return new Ae(this,this.resultTable)},s}(ne),Ae=function(u){function s(l,v){var L=this;return(L=u.call(this,l)||this)._resultTable=l instanceof s?l.resultTable:v,L}return(0,R.ZT)(s,u),Object.defineProperty(s.prototype,"resultTable",{get:function(){return this._resultTable},enumerable:!1,configurable:!0}),s.prototype.clone=function(){return new s(this)},s.prototype.handleTableValue=function(l,v){this.checkAddUberTableToResult(l,v)},s.prototype.handleTableRef=function(l,v){this.checkAddUberTableToResult(l,v)},s.prototype.handleQualifiedColRef=function(l,v){this.checkAddConstructedTableToResult(l,function(){return w.isolatedClone(v)})},s.prototype.handleSimpleColRef=function(l,v){this.checkAddConstructedTableToResult(l,function(){return w.isolatedClone(v)})},s.prototype.handleNewCol=function(l,v,L,J){this.checkAddConstructedTableToResult(l,function(){return w.buildIsolatedColumn(L,v,J)})},s.prototype.checkAddUberTableToResult=function(l,v){I.G.hasFlag(l.argumentAction,1)&&(!I.G.hasFlag(l.argumentAction,2)||!this.repeated)&&(this.resultTable.immediateTables=this.resultTable.immediateTables.concat(v.immediateTables),this.resultTable.relatedTables=this.resultTable.relatedTables.concat(v.relatedTables),this.resultTable.constructedTables=this.resultTable.constructedTables.concat(v.constructedTables))},s.prototype.checkAddConstructedTableToResult=function(l,v){I.G.hasFlag(l.argumentAction,1)&&(!I.G.hasFlag(l.argumentAction,2)||!this.repeated)&&this.resultTable.constructedTables.push(v().table)},s}(pe),w=function(){function u(){}return u.buildIsolatedColumn=function(s,l,v){var L=new xe(l,void 0,v),J=new je(s,void 0,L);return L.addColumn(J),J},u.isolatedClone=function(s){var l=this.isolatedCloneCore(s);if(s.table.variationSource){var v=this.isolatedCloneCore(s.table.variationSource);l.table.variationSource=v,v.variationTable=l.table}return l},u.isolatedCloneCore=function(s){return this.buildIsolatedColumn(s.name,s.table.name,s.table.quoteNeeded)},u}()},85616:function(Ke,we,E){E.d(we,{$Z:function(){return nt},Cm:function(){return Kt},DH:function(){return It},DU:function(){return Me},Ed:function(){return ke},F0:function(){return y},Fc:function(){return _e},HI:function(){return qe},HV:function(){return l},Hf:function(){return Ee},IE:function(){return ce},IS:function(){return Rt},Lj:function(){return Ve},N4:function(){return q},N9:function(){return Ae},QB:function(){return Se},R6:function(){return We},RZ:function(){return Ie},Sm:function(){return Oe},T0:function(){return Ze},TV:function(){return P},Ti:function(){return $e},U6:function(){return Ne},VW:function(){return Q},Vu:function(){return Ue},XN:function(){return Ot},Xg:function(){return w},ZH:function(){return u},ZQ:function(){return ye},_7:function(){return Ge},_L:function(){return Y},_N:function(){return T},a$:function(){return W},ai:function(){return v},dl:function(){return b},eV:function(){return i},et:function(){return lt},fA:function(){return ee},fY:function(){return A},gR:function(){return zt},gi:function(){return Le},gq:function(){return O},i8:function(){return p},ic:function(){return Ct},ig:function(){return Ce},jg:function(){return K},lg:function(){return kt},mR:function(){return s},n1:function(){return Dt},pZ:function(){return L},q1:function(){return Z},qS:function(){return se},rI:function(){return bt},rL:function(){return C},rc:function(){return Re},sB:function(){return dt},tw:function(){return Pt},u0:function(){return Pe},uA:function(){return mt},ub:function(){return d},vX:function(){return Je},xY:function(){return I},y3:function(){return U},yC:function(){return oe},yE:function(){return tt},ze:function(){return de}});var R=E(81337),z=E(55863),H=E(20540),V=E(66106),j=E(85402),M=E(58871),k=E(63513),Y=function(B){function h(f,N){var X=B.call(this,f,N)||this;return X._children=[],X}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"filterColumnRef",{get:function(){if(1===this.context.filterExpressionState)for(var N=0,X=this._children;N<X.length;N++){var Fe=X[N].filterColumnRef;if(Fe)return Fe}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"valid",{get:function(){return this._children[0].valid},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"firstDescendent",{get:function(){return this._children[0].firstDescendent},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"lastDescendent",{get:function(){var N=_.last(this._children);if(N)return N.lastDescendent},enumerable:!1,configurable:!0}),h.prototype.eatToken=function(f,N){for(var X=0,be=this.getPotentialNextChildren();X<be.length;X++){var Fe=be[X];if(Fe.eatToken(f,N)===H.R.Yum)return this._children.push(Fe),H.R.Yum}return this.isComplete?H.R.NotHungry:H.R.Yuck},h.prototype.getFromOnlyChild=function(f){return 1===this._children.length?f(this._children[0]):void 0},Object.defineProperty(h.prototype,"lastChild",{get:function(){return _.last(this._children)},enumerable:!1,configurable:!0}),h.prototype.getFromFirstChild=function(f){if(1===this._children.length)return f(this._children[0])},h.prototype.getContextForChild=function(f){var N=this.context,X=N;if(0!==X.ephemeralContexts.length&&f!==this.childWhichReceivesEphemeralContexts&&(X=new M.hK(X,!0)),1===X.filterExpressionState)for(var be=0,Fe=this._children;be<Fe.length;be++){var ze=Fe[be];if(ze===f)break;ze.filterColumnRef&&(X===N&&(X=new M.hK(X,!0)),X.filterExpressionState=2,X.currentTable=ze.filterColumnRef.table.uberTable,X.newTableScan())}return X},Object.defineProperty(h.prototype,"childWhichReceivesEphemeralContexts",{get:function(){return this._children[0]},enumerable:!1,configurable:!0}),h.prototype.isFirstChild=function(f){return f===_.head(this._children)},h.prototype.isOnlyChild=function(f){return 1===this._children.length&&this.isFirstChild(f)},h.prototype.removeLaterChildren=function(f){for(var N=this._children.length-1;this._children[N]!==f;N--)(0,z.hu)(N>0,"iChild > 0"),this._children.splice(N,1)},h.prototype.printEarlierNodes=function(f){var N;N=this.parent?this.parent.printEarlierNodes(this):0,this.printSelf(N),N+=2;for(var X=0,be=this._children;X<be.length;X++){var Fe=be[X];if(Fe===f)break;Fe.printSelfAndChildren(N)}return N},h.prototype.printChildren=function(f){for(var N=0,X=this._children;N<X.length;N++)X[N].printSelfAndChildren(f)},h}(M.sN),Z=function(B){function h(){var f=null!==B&&B.apply(this,arguments)||this;return f.prospectiveChildren=[],f}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"filterColumnRef",{get:function(){return this.getFromOnlyChild(function(N){return N.filterColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"firstDescendent",{get:function(){return _.head(this.validChildren).firstDescendent},enumerable:!1,configurable:!0}),h.prototype.getFromOnlyChild=function(f){return this.child?f(this.child):void 0},Object.defineProperty(h.prototype,"children",{get:function(){return this.validChildren},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"lastDescendent",{get:function(){return _.head(this.validChildren).lastDescendent},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"valid",{get:function(){return _.some(this.validChildren)},enumerable:!1,configurable:!0}),h.prototype.setChild=function(f){(0,z.hu)(!this.child,"expected no existing child"),this.child=f},h.prototype.eatToken=function(f,N){if((0,z.hu)(null==this.child,"child == null"),_.some(this.prospectiveChildren))return H.R.NotHungry;for(var X=0,be=this.getPotentialChildren();X<be.length;X++){var Fe=be[X];Fe.eatToken(f,N)===H.R.Yum&&this.prospectiveChildren.push(Fe)}return this.prospectiveChildren.length>0?H.R.Yum:H.R.Yuck},Object.defineProperty(h.prototype,"validChildren",{get:function(){return this.child?[this.child]:_.filter(this.prospectiveChildren,function(N){return N.valid})},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return _.some(this.validChildren,function(N){return N.couldBeType(f)})},h.prototype.getContextForChild=function(f){return this.context},h.prototype.printEarlierNodes=function(f){var N;return N=this.parent?this.parent.printEarlierNodes(this):0,this.printSelf(N),N+2},h.prototype.printChildren=function(f){this.child&&this.child.printSelfAndChildren(f)},h.prototype.removeLaterChildren=function(f){this.child=void 0},h.prototype.isFirstChild=function(f){return!0},h.prototype.isOnlyChild=function(f){return!0},h}(M.sN),I=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialNextChildren=function(){var f;switch(this._children.length){case 0:f=new A(this);break;case 1:f=new P(this);break;case 2:f=new dt(this);break;case 3:f=new l(this);break;default:return[]}return[f]},Object.defineProperty(h.prototype,"isComplete",{get:function(){return 4===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"identifier",{get:function(){return this._children.length>1?(0,k.as)(this._children[1],P):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this._children.length>3?this._children[3]:void 0},enumerable:!1,configurable:!0}),h}(Y),te=function(B){function h(f,N){var X=B.call(this,f)||this;return X._index=N,X}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),h.prototype.getPotentialChildren=function(){return[new l(this)]},h.prototype.getTableValue=function(){return this.tableValue},h.prototype.getTableRef=function(){return this.tableRef},h.prototype.getQualifiedColumnRef=function(){return this.qualifiedColumnRef},h.prototype.getSimpleColumnRef=function(){return this.simpleColumnRef},h.prototype.getString=function(){return this.string},h.prototype.hasValidAxisRef=function(){return k.LP.hasValidAxesReferences(this.axesRef)},h.prototype.hasValidAxisValue=function(){return this.isValidAxisValue},h.prototype.hasValidEnumValue=function(){return this.isValidEnumValue},h.prototype.couldBeType=function(f){return!(!k.G.hasFlag(f.type,64)&&!k.G.hasFlag(f.type,1))||B.prototype.couldBeType.call(this,f)},h.prototype.storeMatchedType=function(f){this.firstDescendent.token.matchedType=f},h.prototype.getCalendarRef=function(){return this.calendarRef},h}(Z),ee=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getContextForChild=function(f){return this.parent.getContextForParam(this,this.getParamIndex(f))},Object.defineProperty(h.prototype,"isComplete",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"parameterCount",{get:function(){return(0,z.hu)(this._children.length>0,"children.length > 0"),this.getParamIndex(this.lastChild)+1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"parameters",{get:function(){for(var N=[],X=0;X<this.parameterCount;X++){var be=this.getParameterByIndex(X);be&&N.push(be)}return N},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"allParametersIncludingUndefined",{get:function(){for(var N=[],X=0;X<this.parameterCount;X++){var be=this.getParameterByIndex(X);N.push(be)}return N},enumerable:!1,configurable:!0}),h.prototype.getParamIndex=function(f){return this.getParamIndexAndIsParameter(f).index},h.prototype.getSeparatorByIndex=function(f){var N=_.filter(this._children,function(X){return X instanceof u&&X.index===f});if(N.length>1)throw new Error("expected at most one parameter at index "+f);return(0,k.as)(N[0],u)},h.prototype.getParameterByIndex=function(f){var N=_.filter(this._children,function(X){return X instanceof te&&X.index===f});if(N.length>1)throw new Error("expected at most one parameter at index "+f);return(0,k.as)(N[0],te)},h.prototype.getParameterCount=function(){return this.parameterCount},h.prototype.getParameter=function(f){return this.getParameterByIndex(f)},h.prototype.getPotentialNextChildren=function(){var f=!1,N=0;if(this._children.length>0){var X=this.getParamIndexAndIsParameter(this.lastChild);N=X.index,f=X.isParameter}return f?[new u(this,N+1)]:[this.newParameterNode(N),new u(this,N+1)]},h.prototype.newParameterNode=function(f){return new te(this,f)},h.prototype.getParamIndexAndIsParameter=function(f){var N=(0,k.as)(f,te);return N?{index:N.index,isParameter:!0}:{index:f.index,isParameter:!1}},h}(Y),W=function(B){function h(f,N){return B.call(this,f,N)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialNextChildren=function(){return[this._children.length%2==0?this.getOperand():this.getOperator()]},Object.defineProperty(h.prototype,"isComplete",{get:function(){return this._children.length%2==1},enumerable:!1,configurable:!0}),h}(Y),i=function(B){function h(f){return B.call(this,f,34)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"simpleColumnRef",{get:function(){var N=this.token;if(35!==N.type)return(0,k.as)(N.matchObject,M.XN)},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,16)},h}(M.a9),K=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new i(this),new It(this)]},Object.defineProperty(h.prototype,"bracketedIdentifier",{get:function(){var N=(0,k.as)(this.child,i);if(!N){var X=(0,k.as)(this.child,It);null!=X&&(N=X.bracketedIdentifier)}return N},enumerable:!1,configurable:!0}),h}(Z),y=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new T(this)},h.prototype.getOperator=function(){return new M.a9(this,[9,10,11,12,15,16,17])},h}(W),ie=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new Ot(this),new Je(this),new ct(this),new mt(this)]},h}(Z),ve=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new P(this),new Ot(this),new Je(this),new ct(this),new rt(this),new mt(this)]},h}(Z),D=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new qe(this)];var f=this.lastChild;return f instanceof qe||f instanceof u?[new ve(this),new u(this,0),new tt(this)]:f instanceof ve?[new u(this,0),new tt(this)]:[]},h}(Y),b=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h}(I),q=function(B){function h(f){var N=B.call(this,f)||this;return N.query=f,N}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this._children.length>=2},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){return 0===this._children.length?[new m(this)]:[new L(this),new b(this)]},h.prototype.getContextForChild=function(f){var N=this.addDefinedMeasuresToMatchObjects();this.context.matchObjects.mergeMeasures(N);var X=this.createDefinedVariables();return this.context.matchObjects.mergeVariables(X),this.context},h.prototype.removeLaterChildren=function(f){var N=this.removeDefinedMeasuresFromMatchObjectsAfter(f),X=this.removeDefinedVariablesAfter(f);(N||X)&&(this.query.isInvalidated=!0),this.isComplete||(this.query.isInvalidated=!0),B.prototype.removeLaterChildren.call(this,f)},h.prototype.removeDefinedVariablesAfter=function(f){for(var N=!1,X=k.Sy.skipWhile(this._children,function(ut){return ut!==f}).slice(1),be=0,Fe=k.Sy.ofType(X,b);be<Fe.length;be++){var ze=Fe[be];ze.identifier&&(this.context.matchObjects.removeDefinedVariable(ze.identifier.token.getString()),N=!0)}return N},h.prototype.removeDefinedMeasuresFromMatchObjectsAfter=function(f){for(var N=!1,X=k.Sy.skipWhile(this._children,function(wt){return wt!==f}).slice(1),be=0,Fe=k.Sy.ofType(X,L);be<Fe.length;be++){var ze=Fe[be];if(ze.measureDef){var ut=this.context.matchObjects.findTable(ze.measureDef.tableName);null!=ut&&(ut.removeDefinedMeasure(ze.measureDef.identifier),this.context.matchObjects.removeDefinedMeasure(ze.measureDef.identifier,ze.measureDef.tableName),N=!0)}}return N},h.prototype.createDefinedVariables=function(){var f=_.chain(k.Sy.ofType(this._children,b)).filter(function(N){return N.identifier}).map(this.createVariable).value();return _.some(f)&&(this.query.isInvalidated=!0),f},h.prototype.createVariable=function(f){return new M.yB(f.identifier.token.getString(),f,!0)},h.prototype.addDefinedMeasuresToMatchObjects=function(){for(var f=[],N=0,X=_.filter(k.Sy.ofType(this._children,L),function(ze){return ze.isComplete});N<X.length;N++){var be=X[N],Fe=this.context.matchObjects.findTable(be.measureDef.tableName);Fe&&f.push(this.createMeasure(be,Fe))}return _.some(f)&&(this.query.isInvalidated=!0),f},h.prototype.createMeasure=function(f,N){var X=new M.Nr(f.measureDef.identifier,f.measureDef.identifier,N,this.context.matchObjects.findFunction("CALCULATE"),f);return N.mergeDefinedMeasure(X),X},h}(Y),he=function(B){function h(f){return B.call(this,f,[40,60])||this}return(0,R.ZT)(h,B),h}(M.a9),ce=function(B){function h(f,N){var X=B.call(this,void 0,0,N)||this;return X._leafPosition=f,X}return(0,R.ZT)(h,B),h}(M.a9),ye=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new l(this)]},h}(Z),Pe=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){var N=this.daxFunctionBase;return N&&N.getTableReturnValue(this.context,this.parameterList)},enumerable:!1,configurable:!0}),h.prototype.getRolledUpColumns=function(f){var N=this;if(this.functionMatchesType(f.type)&&this.parameterList)return _.chain(this.parameterList.parameters).map(function(X){var be=X.getRolledUpColumns({type:V.e9});if(be)return be;var Fe=X.qualifiedColumnRef||X.simpleColumnRef;if(Fe)return[Fe];if((N.functionMatchesType(256)||N.functionMatchesType(512))&&X.couldBeType({type:32})){var ze=new M.S2("",void 0,!1);return[new M.XN(X.string,"",ze)]}return[]}).flatten().value()},h.prototype.couldBeType=function(f){return this.functionMatchesType(f.type)},h.prototype.functionMatchesType=function(f){var N=this.daxFunctionBase;return!!N&&(16===N.role&&k.G.hasFlag(f,128)||32===N.role&&k.G.hasFlag(f,256)||64===N.role&&k.G.hasFlag(f,512)||128===N.role&&k.G.hasFlag(f,1024)||512===N.role&&k.G.hasFlag(f,16384)||12===N.role&&k.G.hasFlag(f,2)||4===N.role&&k.G.hasFlag(f,2)||4096===N.role&&k.G.hasFlag(f,2)||16384===N.role&&k.G.hasFlag(f,2)||2===N.role&&k.G.hasFlag(f,2)||k.G.hasFlag(N.role,8192)&&k.G.hasFlag(f,524288)||256===N.role&&(k.G.hasFlag(f,4)||k.G.hasFlag(f,2)||k.G.hasFlag(f,1)||k.G.hasFlag(f,2048)))},h.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[this.getPotentialFirstChild()];if(1===this._children.length)return[new We(this)];var f=this.lastChild;return f instanceof We?[this.newParamList(),new nt(this)]:f instanceof ee?[new nt(this)]:[]},h.prototype.newParamList=function(){return new ee(this)},Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof nt},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"leftParen",{get:function(){return this._children.length>1?(0,k.as)(this._children[1],We):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"parameterList",{get:function(){return this._children.length>2?(0,k.as)(this._children[2],ee):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rightParen",{get:function(){var N=this._children.length>3?(0,k.as)(this._children[3],nt):void 0;return N||(N=this._children.length>2?(0,k.as)(this._children[2],nt):void 0),N},enumerable:!1,configurable:!0}),h.prototype.getChildFunctionName=function(){var f;return null===(f=this.functionNode)||void 0===f?void 0:f.segment.text},Object.defineProperty(h.prototype,"daxFunctionBase",{get:function(){var N=this.functionNode;if(N)return(0,k.as)(N.token.matchObject,M.eL)},enumerable:!1,configurable:!0}),h.prototype.getContextForParam=function(f,N){var X=this.daxFunctionBase;return X?X.getContextForParam(this.context,f,N):this.context},Object.defineProperty(h.prototype,"isValidAxisValue",{get:function(){var N=this.daxFunctionBase;return!!N&&k.G.hasFlag(N.role,8192)},enumerable:!1,configurable:!0}),h}(Y),Me=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"functionNode",{get:function(){return(0,k.as)(this._children[0],M.a9)},enumerable:!1,configurable:!0}),h.prototype.getPotentialFirstChild=function(){return new P(this)},h}(Pe),xe=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){var N,X;return null===(X=null===(N=this.parameterList)||void 0===N?void 0:N.parameters[0])||void 0===X?void 0:X.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableRef",{get:function(){var N,X;return null===(X=null===(N=this.parameterList)||void 0===N?void 0:N.parameters[0])||void 0===X?void 0:X.tableRef},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"string",{get:function(){var N,X;return null===(X=null===(N=this.parameterList)||void 0===N?void 0:N.parameters[0])||void 0===X?void 0:X.string},enumerable:!1,configurable:!0}),h.prototype.getPotentialFirstChild=function(){return new Tt(this)},h.prototype.getContextForParam=function(f,N){var X=this.daxFunctionBase;if(X&&0!==N)return X.getContextForParam(this.context,f,N);for(var be=new M.hK(this.context,!1),Fe=0,ze=this.context.ephemeralContexts;Fe<ze.length;Fe++){var ut=ze[Fe];be.ephemeralContexts.push(new M.xE(be,ut.currentTable,(0,R.pi)((0,R.pi)({},ut.role),{type:7&ut.role.type}),ut.enumValues))}return be},h}(Me),je=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"functionNode",{get:function(){return(0,k.as)(_.head(this._children),M.a9)},enumerable:!1,configurable:!0}),h.prototype.getPotentialFirstChild=function(){return new ne(this)},h.prototype.newParamList=function(){return new re(this)},h}(Pe),ge=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isDataTable",{get:function(){return!0},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,4096)},h.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new qe(this)];var f=this.lastChild;return f instanceof qe||f instanceof u?[new D(this)]:f instanceof D?[new u(this,0),new tt(this)]:[]},h}(Y),Oe=function(B){function h(f,N){return B.call(this,f,N)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new Ot(this),new P(this),new ge(this)]},h}(te),re=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.newParameterNode=function(f){return new Oe(this,f)},h}(ee),P=function(B){function h(f){return B.call(this,f,58)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){if(this.token){var N=this.token.matchObject,X=(0,k.as)(N,M.S2);if(X)return X.uberTable;var be=(0,k.as)(N,M.yB);if(be&&be.value)return be.value.tableValue}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableRef",{get:function(){return this.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"axesRef",{get:function(){if(this.token){var N=(0,k.as)(this.token.matchObject,M.cr);if(N)return[N]}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"calendarRef",{get:function(){if(this.token){var N=(0,k.as)(this.token.matchObject,M.Df);if(N)return N}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isValidAxisValue",{get:function(){return k.LP.hasValidAxesReferences(this.axesRef)},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return!!(k.G.hasFlag(f.type,2)||k.G.hasFlag(f.type,4)||k.G.hasFlag(f.type,8)||k.G.hasFlag(f.type,16)||k.G.hasFlag(f.type,16384)||k.G.hasFlag(f.type,32768)||k.G.hasFlag(f.type,65536)||k.G.hasFlag(f.type,524288)||k.G.hasFlag(f.type,131072)||60===this.token.type&&(k.G.hasFlag(f.type,32)||k.G.hasFlag(f.type,2048)||k.G.hasFlag(f.type,4096)))},h.prototype.otherwiseMatchesToken=function(f){return f.isKeyword&&f.activelyEdited},h}(M.a9),p=function(B){function h(f,N){var X=B.call(this,void 0,0,N)||this;return X._leafPosition=f,X}return(0,R.ZT)(h,B),h}(M.a9),T=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"firstChildCouldBeTuple",{get:function(){return this._children.length>=2||!this.parseComplete},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"invalidRightArgument",{get:function(){if(!(this._children.length<3)&&this.parseComplete){var N=this._children[2];if(!N.tableValue)return N}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 1===this._children.length||3===this._children.length},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Rt(this)];case 1:return[new Ae(this)];case 2:return[new h(this)];default:return[]}},h.prototype.onParseComplete=function(){this.parseComplete=!0},h.prototype.onParseIncomplete=function(){this.parseComplete=!1},h}(Y),d=function(B){function h(f,N,X){var be=B.call(this,f,N)||this;return be.keyword=X,be}return(0,R.ZT)(h,B),h.prototype.otherwiseMatchesToken=function(f){return f.isIdentifierOrKeyword&&f.activelyEdited&&k.uI.startsWithIgnoreCase(this.keyword,f.getString())},h}(M.a9),C=function(B){function h(f){return B.call(this,f,52,"at")||this}return(0,R.ZT)(h,B),h}(d),m=function(B){function h(f){return B.call(this,f,53,"define")||this}return(0,R.ZT)(h,B),h}(d),O=function(B){function h(f){return B.call(this,f,54,"measure")||this}return(0,R.ZT)(h,B),h}(d),A=function(B){function h(f){return B.call(this,f,42,"var")||this}return(0,R.ZT)(h,B),h}(d),U=function(B){function h(f){return B.call(this,f,43,"return")||this}return(0,R.ZT)(h,B),h}(d),Q=function(B){function h(f){return B.call(this,f,44,"not")||this}return(0,R.ZT)(h,B),h}(d),oe=function(B){function h(f){return B.call(this,f,45,"evaluate")||this}return(0,R.ZT)(h,B),h}(d),ne=function(B){function h(f){return B.call(this,f,46,"datatable")||this}return(0,R.ZT)(h,B),h}(d),pe=function(B){function h(f){return B.call(this,f,47,"order")||this}return(0,R.ZT)(h,B),h}(d),me=function(B){function h(f){return B.call(this,f,48,"by")||this}return(0,R.ZT)(h,B),h}(d),Ee=function(B){function h(f){return B.call(this,f,49,"asc")||this}return(0,R.ZT)(h,B),h}(d),Se=function(B){function h(f){return B.call(this,f,50,"desc")||this}return(0,R.ZT)(h,B),h}(d),Ae=function(B){function h(f){return B.call(this,f,55,"in")||this}return(0,R.ZT)(h,B),h}(d),w=function(B){function h(f){return B.call(this,f,51,"start")||this}return(0,R.ZT)(h,B),h}(d),u=function(B){function h(f,N){var X=B.call(this,f,27)||this;return X._index=N,X}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),h}(M.a9),s=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new Ee(this),new Se(this)]},Object.defineProperty(h.prototype,"isValidEnumValue",{get:function(){return!0},enumerable:!1,configurable:!0}),h}(Z),l=function(B){function h(f,N){return B.call(this,f,N)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new $e(this)},h.prototype.getOperator=function(){return new M.a9(this,[13,14])},h}(W),v=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"identifier",{get:function(){if(!(this._children.length<2)){var N=(0,k.as)(this._children[1],i);return N?N.token.getIdentifier():void(0,z.sr)("Unexpected node type: "+this._children[1].constructor)}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableRefNode",{get:function(){return this._children.length>0?(0,k.as)(this._children[0],Dt):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableName",{get:function(){if(this.tableRefNode)return this.tableRefNode.tableNode.token.getIdentifier()},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Dt(this)];case 1:return[new i(this)]}return[]},h}(Y),L=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new O(this)];case 1:return[new v(this)];case 2:return[new dt(this)];case 3:return[new ye(this)]}return[]},Object.defineProperty(h.prototype,"isComplete",{get:function(){return 4===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"measureDef",{get:function(){if(this._children.length>1)return(0,k.as)(this._children[1],v)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"expressionNode",{get:function(){if(this._children.length>2)return(0,k.as)(this._children[3],ye)},enumerable:!1,configurable:!0}),h.prototype.getContextForChild=function(f){var N=this;if(f instanceof ye){var X=new M.hK(this.context.matchObjects),be=_.find(X.matchObjects.tables,function(ze){return ze.name===N.measureDef.tableName});if(be){X.currentTable=be.uberTable;var Fe=new M.hK(X,!1);return Fe.currentTable=void 0,Fe}}return B.prototype.getContextForChild.call(this,f)},h}(Y),J=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"functionNode",{get:function(){return this._children[0].bracketedIdentifier},enumerable:!1,configurable:!0}),h.prototype.getPotentialFirstChild=function(){return new fe(this)},h}(Pe),fe=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"bracketedIdentifier",{get:function(){var N=(0,k.as)(this.child,i);if(!N){var X=(0,k.as)(this.child,It);X&&(N=X.bracketedIdentifier)}return N},enumerable:!1,configurable:!0}),h.prototype.getPotentialChildren=function(){return[new i(this),new It(this)]},h}(Z),se=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this._children.length>1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"firstIdentifier",{get:function(){return(0,k.as)(this._children[0],M.a9)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"lastIdentifier",{get:function(){return(0,k.as)(this.lastChild,M.a9)},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,2)||k.G.hasFlag(f.type,4)||k.G.hasFlag(f.type,8)||k.G.hasFlag(f.type,65536)||k.G.hasFlag(f.type,524288)||k.G.hasFlag(f.type,64)},h.prototype.getIdentifier=function(f){return(0,k.as)(this._children[f],M.a9)},h.prototype.getPotentialNextChildren=function(){return[new P(this),new Ee(this),new Se(this)]},Object.defineProperty(h.prototype,"axesRef",{get:function(){return this._children.map(function(N){var X;return null!==(X=N.axesRef)&&void 0!==X&&X.length?N.axesRef[0]:void 0})},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isValidAxisValue",{get:function(){return k.LP.hasValidAxesReferences(this.axesRef)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"matchingMultiEnumValue",{get:function(){var N=_.find(this.context.ephemeralContexts,function(be){return be.enumValues});if(N){(0,z.hu)(_.every(this.children,function(be){return!!(0,k.as)(be,M.a9)}),"Unexpected child type");var X=_.join(_.map(this.children,function(be){return(0,k.as)(be,M.a9).token.getString()})," ");return _.find(N.enumValues,function(be){return k.uI.equalIgnoreCase(be.name,X)})}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isValidEnumValue",{get:function(){return!!this.matchingMultiEnumValue},enumerable:!1,configurable:!0}),h}(Y),Ce=function(B){function h(f,N){var X=B.call(this,void 0,0,f)||this;return X._path=new j.q(void 0),X.newRootNode=N,X}return(0,R.ZT)(h,B),h.prototype.eatToken=function(f,N){return this.newRootNode().eatToken(f,N)},h}(M.a9),de=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new P(this),new s(this),new Ze(this),new i(this),new It(this),new _e(this),new Ot(this),new Je(this),new mt(this),new Me(this),new J(this),new je(this),new Ne(this),new Kt(this),new se(this),new kt(this),new Pt(this),new xe(this)]},h}(Z),Re=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof Ve||this.lastChild instanceof Ct},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new pe(this)];case 1:return[new me(this)];default:var f=this.lastChild;if(f instanceof u||f instanceof me)return[new Ve(this)];if(f instanceof Ve)return[new u(this,0),new Ct(this)]}return[]},h}(Y),Ne=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getFromOnlyChild=function(f){if(this._children.length>=2)return f(this._children[1])},Object.defineProperty(h.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"childWhichReceivesEphemeralContexts",{get:function(){if(this._children.length>=2)return this._children[1]},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"leftParen",{get:function(){return(0,k.as)(this._children[0],M.a9)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rightParen",{get:function(){if(this._children.length>2)return(0,k.as)(this._children[2],M.a9)},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new M.a9(this,23)];case 1:return[new l(this)];case 2:return[new M.a9(this,24)];default:return[]}},h}(Y),Ie=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new Le(this)},h.prototype.getOperator=function(){return new M.a9(this,[19,20])},h}(W),ke=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new zt(this)},h.prototype.getOperator=function(){return new M.a9(this,[18])},h}(W),Ge=function(B){function h(f,N){return B.call(this,f,N)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this._children.length>=1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"queries",{get:function(){return _.filter(this._children,function(N){return N instanceof Ue})},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){return[new Ue(this,this.context)]},h}(Y),Ue=function(B){function h(f,N){return B.call(this,f,N)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.hasDefineMeasure?this._children.length>=3:this._children.length>=2},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"hasDefineMeasure",{get:function(){return this._children.length>0&&this._children[0]instanceof q},enumerable:!1,configurable:!0}),h.prototype.getContextForChild=function(f){var N=this.context;if(f instanceof ye)(N=new M.hK(N,!1)).ephemeralContexts.push(new M.xE(N,void 0,V.Yl.TableExpr,void 0));else if(f instanceof Re){var be=_.find(this._children,function(Fe){return Fe instanceof ye}).tableValue;(N=new M.hK(N,!1)).currentTable=be}return N},h.prototype.getPotentialNextChildren=function(){if(0===this._children.length)return[new oe(this),new q(this)];var N;switch(this.hasDefineMeasure?this._children.length-1:this._children.length){case 0:N=new oe(this);break;case 1:N=new ye(this);break;case 2:N=new Re(this);break;default:return[]}return[N]},h}(Y),Ze=function(B){function h(f){return B.call(this,f,32)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){if(this.token){var N=(0,k.as)(this.token.matchObject,M.S2);if(N)return N.uberTable}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableRef",{get:function(){return this.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"calendarRef",{get:function(){if(this.token){var N=(0,k.as)(this.token.matchObject,M.Df);if(N)return N}},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,2)||k.G.hasFlag(f.type,4)||k.G.hasFlag(f.type,8)||k.G.hasFlag(f.type,16)},h}(M.a9),ct=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new ht(this)];case 1:return[new Je(this)];default:return[]}},h}(Y),rt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new P(this)];case 1:return[new We(this)];case 2:return[new nt(this)];default:return[]}},h}(Y),tt=function(B){function h(f){return B.call(this,f,26)||this}return(0,R.ZT)(h,B),h}(M.a9),nt=function(B){function h(f){return B.call(this,f,24)||this}return(0,R.ZT)(h,B),h}(M.a9),dt=function(B){function h(f){return B.call(this,f,17)||this}return(0,R.ZT)(h,B),h}(M.a9),Je=function(B){function h(f){return B.call(this,f,36)||this}return(0,R.ZT)(h,B),h}(M.a9),qe=function(B){function h(f){return B.call(this,f,25)||this}return(0,R.ZT)(h,B),h}(M.a9),We=function(B){function h(f){return B.call(this,f,23)||this}return(0,R.ZT)(h,B),h}(M.a9),ht=function(B){function h(f){return B.call(this,f,[19,20])||this}return(0,R.ZT)(h,B),h}(M.a9),mt=function(B){function h(f){return B.call(this,f,38)||this}return(0,R.ZT)(h,B),h}(M.a9),Tt=function(B){function h(f){return B.call(this,f,57)||this}return(0,R.ZT)(h,B),h}(M.a9),Ve=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this._children.length>=1},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new ye(this)];case 1:return[new lt(this)];default:return[]}},h}(Y),lt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialChildren=function(){return[new Ee(this),new Se(this)]},h}(Z),Ct=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getPotentialNextChildren=function(){var f;switch(this._children.length){case 0:f=new w(this);break;case 1:f=new C(this);break;default:var N=this.lastChild;N instanceof u||N instanceof C?f=new ie(this):((0,z.hu)(N instanceof ie,"Unexpected node type "+N.constructor),f=new u(this,0))}return[f]},Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof ie},enumerable:!1,configurable:!0}),h}(Y),Ot=function(B){function h(f){return B.call(this,f,30)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"string",{get:function(){var N=this.token;if(30===N.type)return k.LP.unDoubleQuote(N.getString())},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,32)||k.G.hasFlag(f.type,2048)},h}(M.a9),Rt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new Ie(this)},h.prototype.getOperator=function(){return new M.a9(this,[28])},h}(W),It=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"bracketedIdentifier",{get:function(){return this._children.length>1?(0,k.as)(this._children[1],i):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"qualifiedColumnRef",{get:function(){var N=this.bracketedIdentifier;if(N)return N.simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"filterColumnRef",{get:function(){if(1===this.context.filterExpressionState)return this.qualifiedColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tableRefNode",{get:function(){if(_.some(this._children))return(0,k.as)(_.head(this._children),Dt)},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){if(k.G.hasFlag(f.type,2)||k.G.hasFlag(f.type,2)){var N=this.bracketedIdentifier;if(!N||60===N.token.type)return!0}return k.G.hasFlag(f.type,8)},h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Dt(this)];case 1:return[new i(this)];default:return[]}},h.prototype.tryGetTableAndColumnNames=function(f){if(!this.bracketedIdentifier||34!==this.bracketedIdentifier.token.type)return f.table=void 0,f.column=void 0,!1;var N=this.firstDescendent,be=N.token.getString();return N instanceof Ze&&(be=k.LP.unquote(be)),f.table=be,f.column=k.LP.unbracket(this.bracketedIdentifier.token.getString()),!0},h}(Y),kt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){var N=new M.Lc,X=new M.S2("",void 0,!1);N.constructedTables.push(X);var be=_.head(k.Sy.ofType(this._children,l));if(be)if(be.tupleCardinality>1)for(var Fe=0;Fe<be.tupleCardinality;Fe++)X.addColumn(new M.XN("Value".concat(Fe+1),void 0,X));else X.addColumn(new M.XN("Value",void 0,X));return N},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,2)},Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new qe(this)];var f=this.lastChild;return f instanceof qe?[new l(this),new tt(this)]:f instanceof u?[new l(this)]:f instanceof l?[new u(this,0),new tt(this)]:[]},h}(Y),Dt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableNode",{get:function(){return(0,k.as)(this.child,M.a9)},enumerable:!1,configurable:!0}),h.prototype.getPotentialChildren=function(){return[new P(this),new Ze(this)]},h}(Z),Le=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h.prototype.getOperand=function(){return new ke(this)},h.prototype.getOperator=function(){return new M.a9(this,[21,22])},h}(W),Pt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof nt},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tupleCardinality",{get:function(){return this.nextSeparatorIndex},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isInValidLocation",{get:function(){for(var N=this,X=N.parent;X;N=X,X=X.parent){if(X instanceof kt)return!0;var be=(0,k.as)(X,T);if(be&&be.firstChildCouldBeTuple)return!0;if(!X.isOnlyChild(N))break}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"nextSeparatorIndex",{get:function(){for(var N=this._children.length-1;N>0;N--){var X=(0,k.as)(this._children[N],u);if(X)return X.index+1}return 1},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new We(this)];var f=this.lastChild;if(f instanceof We)return[new l(this),new u(this,1)];if(f instanceof l||f instanceof u){var N=this.nextSeparatorIndex,X=[new u(this,N)];return f instanceof u&&X.push(new l(this)),N>1&&X.push(new nt(this)),X}return[]},h}(Y),$e=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof y},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){return this.isComplete?[]:[new Q(this),new y(this)]},h}(Y),zt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof de},enumerable:!1,configurable:!0}),h.prototype.getPotentialNextChildren=function(){return this.isComplete?[]:[new ht(this),new de(this)]},h}(Y),bt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),h}(I),_e=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"simpleColumnRef",{get:function(){if(this._children[0].simpleColumnRef&&!(this._children.length<3))return this._children[2].simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"qualifiedColumnRef",{get:function(){if(this._children[0].qualifiedColumnRef&&!(this._children.length<3))return this._children[2].simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"dotNode",{get:function(){return this._children[1]},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"variationSource",{get:function(){return this._children[0].bracketedIdentifier},enumerable:!1,configurable:!0}),h.prototype.couldBeType=function(f){return this._children[0].couldBeType(f)},h.prototype.getContextForChild=function(f){var N=this.context;if(f===this._children[0])return N;var be=(0,k.as)(this.variationSource.token.matchObject,M.XN),Fe=be&&be.variationTable?be.variationTable.uberTable:new M.Lc,ze=new M.hK(N,!0);return ze.ephemeralContexts.push(new M.xE(ze,Fe,{type:8192,columnReferenceScope:64},void 0)),ze},h.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new K(this)];case 1:return[new he(this)];case 2:return[new i(this)];default:return[]}},h}(Y),Kt=function(B){function h(f){return B.call(this,f)||this}return(0,R.ZT)(h,B),Object.defineProperty(h.prototype,"tableValue",{get:function(){var N=this.returnedExpression;if(N)return N.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"returnedExpression",{get:function(){return(0,k.as)(this.lastChild,l)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isComplete",{get:function(){return this.lastChild instanceof l},enumerable:!1,configurable:!0}),h.prototype.getEarlierVariables=function(f){for(var N=[],X=0,be=this._children;X<be.length;X++){var Fe=be[X];if(Fe===f)break;Fe instanceof bt&&N.push(Fe)}return N},h.prototype.couldBeType=function(f){return k.G.hasFlag(f.type,2)},h.prototype.getContextForChild=function(f){for(var N=[],X=0,be=this._children;X<be.length;X++){var Fe=be[X];if(Fe===f)break;var ze=(0,k.as)(Fe,bt);ze&&N.push(ze.identifier.token.matchObject)}var ut=this.context;return(f!==this._children[0]&&_.some(ut.ephemeralContexts)||_.some(N))&&(ut=new M.hK(ut,!0)).mergeInlineVariables(N),ut},h.prototype.getPotentialNextChildren=function(){var f=this.lastChild;return f?f instanceof bt?[new bt(this),new U(this)]:f instanceof U?[new l(this)]:[]:[new bt(this)]},h}(Y)},68706:function(Ke,we,E){E.d(we,{D:function(){return V},j:function(){return H}});var R=E(55863),z=E(19194),H=function(j){return j[j.CantSeparateFormulaNameAndExpression=0]="CantSeparateFormulaNameAndExpression",j[j.DuplicateMeasureName=1]="DuplicateMeasureName",j[j.FunctionCallOnNonFunction=2]="FunctionCallOnNonFunction",j[j.Gramatical=3]="Gramatical",j[j.IncompleteNumber=4]="IncompleteNumber",j[j.IncorrectOrderByParam=5]="IncorrectOrderByParam",j[j.IncorrectPartitionByParam=6]="IncorrectPartitionByParam",j[j.IncorrectMatchByParam=7]="IncorrectMatchByParam",j[j.InvalidIdentifier=8]="InvalidIdentifier",j[j.InvalidNameCharacter=9]="InvalidNameCharacter",j[j.InvalidTupleLocation=10]="InvalidTupleLocation",j[j.InvalidParameter=11]="InvalidParameter",j[j.MissingParameters=12]="MissingParameters",j[j.RightArgumentToInOperatorNotValidTable=13]="RightArgumentToInOperatorNotValidTable",j[j.TooManyParameters=14]="TooManyParameters",j[j.UnrecognizedIdentifier=15]="UnrecognizedIdentifier",j[j.VariableNameReserved=16]="VariableNameReserved",j}({}),V=function(){function j(M,k){this.segment=M,this.errorCode=k,this.message=j.getMessage(M,k)}return j.prototype.equals=function(M){return this.segment.equals(M.segment)&&this.errorCode===M.errorCode},j.prototype.toString=function(){return"".concat(this.errorCode,": ").concat(this.segment.text)},j.getMessage=function(M,k){switch(k){case H.CantSeparateFormulaNameAndExpression:return z.m.format(z.m.localizedStrings.invalidIdentifier,M.text);case H.FunctionCallOnNonFunction:return z.m.format(z.m.localizedStrings.functionCallOnNonFunction,M.text);case H.Gramatical:return z.m.format(z.m.localizedStrings.grammaticalError,M.text);case H.IncompleteNumber:return z.m.format(z.m.localizedStrings.incompleteNumber);case H.IncorrectOrderByParam:return z.m.format(z.m.localizedStrings.incorrectOrderByParam);case H.IncorrectPartitionByParam:return z.m.format(z.m.localizedStrings.incorrectPartitionByParam);case H.IncorrectMatchByParam:return z.m.format(z.m.localizedStrings.incorrectMatchByParam);case H.InvalidIdentifier:return z.m.format(z.m.localizedStrings.invalidIdentifier,M.text);case H.InvalidNameCharacter:return z.m.format(z.m.localizedStrings.invalidNameCharacter,M.text);case H.InvalidTupleLocation:return z.m.format(z.m.localizedStrings.invalidTupleLocation);case H.InvalidParameter:return z.m.format(z.m.localizedStrings.invalidParameter);case H.MissingParameters:return z.m.format(z.m.localizedStrings.missingParameters);case H.RightArgumentToInOperatorNotValidTable:return z.m.format(z.m.localizedStrings.rightArgumentToInOperatorNotValidTable,M.text);case H.TooManyParameters:return z.m.format(z.m.localizedStrings.tooManyParameters,M.text);case H.UnrecognizedIdentifier:return z.m.format(z.m.localizedStrings.unrecognizedIdentifier,M.text);case H.VariableNameReserved:return z.m.format(z.m.localizedStrings.variableNameReserved,M.text);case H.DuplicateMeasureName:return z.m.format(z.m.localizedStrings.duplicateMeasureName)}(0,R.vE)("unexpected error code ".concat(k))},j}()},82269:function(Ke,we,E){E.d(we,{b:function(){return R}});var R=function(){function z(H,V,j,M){void 0===H&&(H=""),void 0===V&&(V=0),this._expression=H,this._cursorActivity=V,this._cursorPosition=j,this._selectionStart=M,this.semiselectable=!1,this.suggestions=[],this.replaceStart=-1,this.replaceEnd=-1,this.afterOParen=-1,this.afterCParen=-1,this.bestMatch=-1,this._prototypeParamContexts=[],this.prototypePosition=-1,this.boldLeftParen=-1,this.boldRightParen=-1,this._errors=[],this._comments=[],this._functions=[],this._references=[],this._tableReferences=[],this._columnReferences=[],this._measureReferences=[],this._strings=[],this._variables=[],this._unrecognizedIdentifiers=[]}return Object.defineProperty(z.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"cursorActivity",{get:function(){return this._cursorActivity},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"cursorPosition",{get:function(){return this._cursorPosition},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"selectionStart",{get:function(){return this._selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"prototypeParamContexts",{get:function(){return this._prototypeParamContexts},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"comments",{get:function(){return this._comments},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"references",{get:function(){return this._references},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"measureReferences",{get:function(){return this._measureReferences},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"tableReferences",{get:function(){return this._tableReferences},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"columnReferences",{get:function(){return this._columnReferences},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"strings",{get:function(){return this._strings},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"variables",{get:function(){return this._variables},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"unrecognizedIdentifiers",{get:function(){return this._unrecognizedIdentifiers},enumerable:!1,configurable:!0}),z}()},42165:function(Ke,we,E){E.d(we,{X:function(){return z}});var R=E(55863),z=function(){function H(V,j,M){(0,R.mv)(V,"Segment expression cannot be null"),(0,R.hu)(j>=0&&j<=V.length,"Invalid startPos"),(0,R.hu)(M>=0&&j+M<=V.length,"Invalid length"),this._expression=V,this._startPosition=j,this._length=M}return H.fromTokens=function(V,j){return new H(j.expression,V.startPosition,j.startPosition+j.length-V.startPosition)},Object.defineProperty(H.prototype,"startPosition",{get:function(){return this._startPosition},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"text",{get:function(){return this.expression.substr(this.startPosition,this.length)},enumerable:!1,configurable:!0}),H.prototype.equals=function(V){return this.startPosition===V.startPosition&&this.length===V.length},H}()},19194:function(Ke,we,E){E.d(we,{m:function(){return z}});var z,R=E(55863);!function(H){function k(Y){return null==Y?"":_.isString(Y)?Y:_.isNumber(Y)||_.isDate(Y)?Y.toLocaleString():_.isObject(Y)?null!=Y.toLocaleString?Y.toLocaleString():Y.toString():""}H.localizedStrings={incompleteNumber:"Invalid number.",invalidTupleLocation:"Unexpected tuple.",invalidParameter:"Parameter is not the correct type.",missingParameters:"Expected additional parameters.",incorrectOrderByParam:"The OrderBy parameter only accepts the ORDERBY function.",incorrectPartitionByParam:"The PartitionBy parameter only accepts the PARTITIONBY function.",incorrectMatchByParam:"The MatchBy parameter only accepts the MATCHBY function.",grammaticalError:"Unexpected expression {0}",functionCallOnNonFunction:"'{0}' is not a function.",rightArgumentToInOperatorNotValidTable:"{0} is not a valid table.",tooManyParameters:"Unexepected parameter '{0}'",invalidNameCharacter:"'{0}' is not a valid name character.",invalidIdentifier:"Cannot find name '{0}'",unrecognizedIdentifier:"Cannot find name '{0}'",variableNameReserved:"'{0}' is a reserved word",rowsDescription:"Calculate vertically across rows.",columnsDescription:"Calculate horizontally across columns.",rowsColumnsDescription:"Calculate vertically across rows, continuing column by column.",columnsRowsDescription:"Calculate horizontally across columns, continuing row by row.",duplicateMeasureName:"This measure's name has already been used in another table"},H.setLocalizedDaxStrings=function(Y){H.localizedStrings=Y},H.format=function(Y){for(var Z=[],I=1;I<arguments.length;I++)Z[I-1]=arguments[I];_.isArray(Z[0])&&((0,R.hu)(1===Z.length,"expected single argument to format if called with an array"),Z=Z[0]);var te=Y;if(te)for(var ee=Z.length;ee--;)te=te.replace(new RegExp("\\{"+ee+"\\}","gm"),k(Z[ee]));return te}}(z||(z={}))},48987:function(Ke,we,E){E.d(we,{J_:function(){return j},XI:function(){return M},q$:function(){return H},tA:function(){return V}});var R=E(81337),z=E(63513),H=function(){function k(Y,Z){for(var I=[],te=2;te<arguments.length;te++)I[te-2]=arguments[te];this._matchObject=Y,this._suggestionText=Z,_.some(I)||(I=[Y]),this._segments=_.map(I,function(ee){return ee.name})}return Object.defineProperty(k.prototype,"complete",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"matchObject",{get:function(){return this._matchObject},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"suggestionText",{get:function(){return this._suggestionText},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"segments",{get:function(){return this._segments},enumerable:!1,configurable:!0}),k.prototype.prependSuggestionText=function(Y){this._suggestionText=Y+this._suggestionText},k}(),V=function(k){function Y(Z,I){for(var te=[],ee=2;ee<arguments.length;ee++)te[ee-2]=arguments[ee];return k.apply(this,(0,R.ev)([Z,I],te,!1))||this}return(0,R.ZT)(Y,k),Object.defineProperty(Y.prototype,"complete",{get:function(){return!1},enumerable:!1,configurable:!0}),Y}(H);function j(k,Y){for(var Z=0;;Z++){if(Z>=k.segments.length&&Z>=Y.segments.length)return 0;if(Z>=k.segments.length)return-1;if(Z>=Y.segments.length)return 1;var I=z.uI.compare(k.segments[Z],Y.segments[Z],!0);if(0!==I)return I}}var M=function(){function k(){}return k.equals=function(Y,Z){return typeof Y.matchObject==typeof Z.matchObject&&z.uI.equalIgnoreCase(Y.suggestionText,Z.suggestionText)},k}()},74104:function(Ke,we,E){E.d(we,{co:function(){return k},jZ:function(){return M},nR:function(){return V}});var R=E(55863),z=E(85786),H=E(63513),V=_.memoize(function(Y,Z){return new j(Y,Z)}),j=function(){function Y(Z,I){this.initializeRules(Z,I)}return Y.prototype.isTokenComplete=function(Z){var I=_.find(this.rules,function(te){return te.tokenType===Z.type});return!(!I||I.canBeExtendedByIdentifier)},Y.prototype.nextToken=function(Z,I,te){this.uberRegExp.lastIndex=I;var ee=this.uberRegExp.exec(Z.substr(0,te));if(!ee)return new z.WU(59,Z,I,Z.length-I);if(ee.index>I)return new z.WU(59,Z,I,ee.index-I);for(var i,W=ee[0],K=0,y=this.rules;K<y.length;K++){var ie=y[K],ve=ie.regExp.exec(W);if(ve&&0===ve.index&&ve[0].length===W.length){i=new z.WU(ie.tokenType,Z,I,W.length,ie.isIgnorable);break}}switch((0,R.mv)(i,"Given that the uber-regexp found a match, one of the token rules must also match"),i.type){case 3:i=this.adjustMLCommentToken(i,te);break;case 58:i=this.adjustIdentifierToken(i)}return i},Y.prototype.adjustIdentifierToken=function(Z){var I=Z.getString(),te=_.find(this.keywordRules,function(W){return H.uI.equalIgnoreCase(W.keyword,I)}),ee=te?te.tokenType:0;return 0!==ee?new z.WU(ee,Z.expression,Z.startPosition,Z.length,Z.ignorable):Z},Y.prototype.adjustMLCommentToken=function(Z,I){for(var te=1,ee=Z.expression,W=Z.endPosition;W<I;){var i=ee[W++];switch(i){case"*":if(W<I&&"/"===(i=ee[W++])&&0==--te)return new z.WU(2,ee,Z.startPosition,W-Z.startPosition,Z.ignorable);break;case"/":W<I&&"*"===(i=ee[W++])&&++te}}return new z.WU(3,ee,Z.startPosition,W-Z.startPosition,Z.ignorable)},Y.prototype.initializeRules=function(Z,I){this.rules=[],this.addRule(3,"/\\*",!0,!0),this.addRule(4,"//.*\\n",!1,!0),this.addRule(5,"//.*",!0,!0),this.addRule(6,"--.*\\n",!1,!0),this.addRule(7,"--.*",!0,!0),this.addOperatorRule(9,"=="),this.addOperatorRule(10,"<>"),this.addOperatorRule(11,"<="),this.addOperatorRule(12,">="),this.addOperatorRule(13,"&&"),this.addOperatorRule(14,"\\|\\|"),this.addOperatorRule(15,"<"),this.addOperatorRule(16,">"),this.addOperatorRule(17,"="),this.addOperatorRule(18,"\\^"),this.addOperatorRule(28,"&"),this.addOperatorRule(19,"\\+"),this.addOperatorRule(20,"-"),this.addOperatorRule(21,"\\*"),this.addOperatorRule(22,"/"),this.addOperatorRule(23,"\\("),this.addOperatorRule(24,"\\)"),this.addOperatorRule(25,"\\{"),this.addOperatorRule(26,"}"),this.addOperatorRule(27,Z),this.addRule(29,"[\\s\\t\\r\\n]+",!1,!0),this.addDelimitedIdentifierRule(30,31,'"','"'),this.addDelimitedIdentifierRule(32,33,"'","'"),this.addDelimitedIdentifierRule(34,35,"[","]");var te=_.escapeRegExp(I),ee="(([0-9]+"+te+"[0-9]*)|([0-9]*"+te+"[0-9]+)|([0-9]+))";this.addRule(38,'[dD][tT]"[^"]+"',!1,!1),this.addRule(39,'[dD][tT]"[^"]*',!1,!1),this.addRuleWithUberPattern(36,ee+"([eE][+\\-]?[0-9]+)?",!1,!1,ee+"([eE][+\\-]?[0-9]*)?"),this.addRuleWithUberPattern(37,ee+"([eE][+\\-]?)",!1,!1,void 0),this.addOperatorRule(40,"\\."),this.addRule(57,"evaluateandlog",!1,!1,!0),this.addRule(58,"[a-zA-Z_][a-zA-Z_0-9.]*",!0,!1),this.keywordRules=[],this.keywordRules.push({keyword:"var",tokenType:42}),this.keywordRules.push({keyword:"return",tokenType:43}),this.keywordRules.push({keyword:"not",tokenType:44}),this.keywordRules.push({keyword:"evaluate",tokenType:45}),this.keywordRules.push({keyword:"datatable",tokenType:46}),this.keywordRules.push({keyword:"order",tokenType:47}),this.keywordRules.push({keyword:"by",tokenType:48}),this.keywordRules.push({keyword:"start",tokenType:51}),this.keywordRules.push({keyword:"at",tokenType:52}),this.keywordRules.push({keyword:"asc",tokenType:49}),this.keywordRules.push({keyword:"desc",tokenType:50}),this.keywordRules.push({keyword:"define",tokenType:53}),this.keywordRules.push({keyword:"measure",tokenType:54}),this.keywordRules.push({keyword:"in",tokenType:55}),this.buildUberPattern()},Y.prototype.buildUberPattern=function(){for(var Z="",I=!0,te=0,ee=this.rules;te<ee.length;te++){var W=ee[te];W.uberPattern&&(I||(Z+="|"),Z+="("+(W.uberPattern||W.regExp.source)+")",I=!1)}this.uberRegExp=new RegExp(Z,"g")},Y.prototype.addDelimitedIdentifierRule=function(Z,I,te,ee){this.addRuleWithUberPattern(Z,Y.delimitedIdentifier(te,ee),!1,!1,Y.delimitedIdentifierStartOrComplete(te,ee)),this.addRuleWithUberPattern(I,Y.delimitedIdentifierStart(te,ee),!0,!1,void 0)},Y.prototype.addOperatorRule=function(Z,I){this.addRule(Z,I,!1,!1)},Y.prototype.addRule=function(Z,I,te,ee,W){void 0===W&&(W=!1),this.addRuleWithUberPattern(Z,I,te,ee,I,W)},Y.prototype.addRuleWithUberPattern=function(Z,I,te,ee,W,i){void 0===i&&(i=!1),this.rules.push({tokenType:Z,regExp:new RegExp(I,i?"i":""),canBeExtendedByIdentifier:te,isIgnorable:ee,uberPattern:W})},Y.delimitedIdentifierStartOrComplete=function(Z,I){return Y.delimitedIdentifier(Z,I)+"?"},Y.delimitedIdentifier=function(Z,I){return Y.delimitedIdentifierStart(Z,I)+"("+_.escapeRegExp(I)+")"},Y.delimitedIdentifierStart=function(Z,I){return Z=_.escapeRegExp(Z),I=_.escapeRegExp(I),"(".concat(Z,")([^").concat(I,"]|(").concat(I).concat(I,"))*")},Y}(),M=j.delimitedIdentifier("[","]"),k=j.delimitedIdentifierStart("[","]")},66813:function(Ke,we,E){E.d(we,{h:function(){return R}});var R=function(){function z(H,V,j,M){this._expression=H,this._cursorActivity=V,this._cursorPosition=j,this._selectionStart=M,this._tokens=[],this.parseTokenCount=-1}return Object.defineProperty(z.prototype,"activeCursor",{get:function(){return this.cursorActivity>=3},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"cursorActivity",{get:function(){return this._cursorActivity},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"cursorPosition",{get:function(){return this._cursorPosition},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"selectionStart",{get:function(){return this._selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"tokens",{get:function(){return this._tokens},enumerable:!1,configurable:!0}),z.prototype.updateExpression=function(H){this._expression=H},z.prototype.nextNonIgnorable=function(H,V){for(void 0===V&&(V={iTokenNext:void 0}),V.iTokenNext=H+1;V.iTokenNext<this.tokens.length;V.iTokenNext++){var j=this.tokens[V.iTokenNext];if(!j.ignorable)return j}},z}()},21527:function(Ke,we,E){E.d(we,{w:function(){return k}});var R=E(55863),z=E(88498),H=E(66813),V=E(74104),j=E(85786),M=E(63513);function k(I,te,ee,W,i,K,y){var ie,ve=K?z.ft():z.V,D=(0,V.nR)(ve.listSeparator,ve.numberDecimalSeparator),b=new H.h(I,te,ee,W),q=0,he=I.length,ce=b.activeCursor;ce&&(0,R.hu)(null!=ee,"cursorPosition must have value if the cursor is active");var ye=[],Pe={stopPosition:he},Me=i&&Z(b,i,!1,ye,Pe);if(Me||(Me=y&&Z(b,y,!1,ye,Pe)),Me||(Me=i&&Z(b,i,!0,ye,Pe)),Me||(Me=y&&Z(b,y,!0,ye,Pe)),he=Pe.stopPosition,i){var xe=he;i.activeCursor&&(xe=Math.min(xe,i.cursorPosition||0)),ce&&(xe=Math.min(xe,ee||0));for(var je=0,ge=i.tokens;je<ge.length;je++){(0,R.hu)(i.expression.length>=(Oe=ge[je]).startPosition+Oe.length,"expected token to be within the bounds of the expression");var re=Oe.startPosition+Oe.length;if(xe<=re||i.expression.length<=re||I[re]!==i.expression[re]||!M.uI.equalIgnoreCase(I.substr(Oe.startPosition,Oe.length),i.expression.substr(Oe.startPosition,Oe.length)))break;(0,R.hu)(60!==Oe.type,"cannot reuse NewToken"),b.tokens.push(Oe)}if(b.tokens.length>0){var P=b.tokens[b.tokens.length-1];q=P.startPosition+P.length}}for(;q<he;){var Oe=D.nextToken(I,q,he);if(ce&&Oe.startPosition<ee&&Oe.startPosition+Oe.length>ee){for(;q<ee;){var p=D.nextToken(I,q,ee);b.tokens.push(p),q+=p.length}Oe.markAsSecondHalf(ee)}ce&&(Oe.startPosition===ee?(Y(0,I,b.tokens),b.parseTokenCount=b.tokens.length):Oe.endPosition===ee&&(Oe.activelyEdited=!0)),b.tokens.push(Oe),q+=Oe.length}if(ce)q===ee&&Y(0,I,b.tokens),-1===b.parseTokenCount&&(b.parseTokenCount=b.tokens.length),(ie=b.tokens).push.apply(ie,ye);else{if(0!==b.cursorActivity&&ee>=0){var T=!1;(0,R.hu)(q>=ee,"currentPosition >= cursorPosition");for(var d=q,C=b.tokens.length;;){if(d===ee){T=!0;break}if((0,R.hu)(d>ee,"effectiveEndPosition > cursorPosition"),(0,R.hu)(C>0,"iToken > 0"),C--,(d=(Oe=b.tokens[C]).startPosition)<ee){T=29===Oe.type;break}if(!Oe.ignorable)break}T&&Y(0,I,b.tokens)}b.parseTokenCount=b.tokens.length}return b}function Y(I,te,ee){var W=!0,i=0;if(_.some(ee)){var K=_.last(ee);(W=K.isComplete)&&(i=K.startPosition+K.length)}W&&ee.push(new j.WU(60,te,i,0))}function Z(I,te,ee,W,i){if(0===te.expression.length)return!1;if(I.activeCursor){var K=te.expression,y=I.expression,ie=0===te.cursorActivity?0:Math.max(0,te.cursorPosition||0),ve=Math.max(0,I.cursorPosition||0),D=K.length-ie,b=y.length-ve,q=ee?Math.min(D,b):b,he=K.substr(K.length-q),ce=y.substr(y.length-q);if(D>=q&&M.uI.equalIgnoreCase(he,ce)){for(var ye=y.length-K.length,Pe=q,Me=te.tokens.length-1;Me>=0&&Pe>0;Me--){var xe=te.tokens[Me];if(60!==xe.type){var je=xe.startPosition+ye,ge=xe.length,Oe=xe.secondHalf;ge>Pe&&(je+=ge-Pe,ge=Pe,Oe=!0),W.unshift(xe.cloneForReuse(y,je,ge,Oe)),Pe-=ge}else(0,R.hu)(0===xe.length,"token.length === 0")}return b>q&&W.unshift(new j.WU(61,y,ve,b-q)),i.stopPosition=ve,!0}}return!1}},85786:function(Ke,we,E){E.d(we,{C3:function(){return I},Cu:function(){return Y},WU:function(){return k}});var R=E(55863),z=E(40546),H=E(66106),V=E(88498),j=E(42165),M=E(63513),k=function(){function i(K,y,ie,ve,D,b,q,he,ce){void 0===D&&(D=!1),void 0===b&&(b=!1),void 0===q&&(q=!1),void 0===ce&&(ce=H.Yl.None),this._type=K,this._expression=y,this._startPosition=ie,this._length=ve,this._ignorable=D,this._secondHalf=b,this.activelyEdited=q,this.matchObject=he,this.matchedType=ce}return i.prototype.debuggerDisplay=function(){return(0,R.hu)(V.Mz.debugging,"cannot use debuggerDisplay unless debugging"),"".concat(this.type," ").concat(this.getString()," (").concat(this.startPosition,", ").concat(this.length,")")},i.prototype.toString=function(){return this.debuggerDisplay()},Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startPosition",{get:function(){return this._startPosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endPosition",{get:function(){return this.startPosition+this.length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ignorable",{get:function(){return this._ignorable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondHalf",{get:function(){return this._secondHalf},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComment",{get:function(){return I(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isKeyword",{get:function(){return W(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isIdentifierOrKeyword",{get:function(){return function(i){return 58===i||W(i)}(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isAnyKindOfIdentifier",{get:function(){return function(i){return 58===i||32===i||34===i}(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return function(i){if(W(i))return!1;switch(i){case 3:case 5:case 7:case 31:case 33:case 35:case 36:case 37:case 39:case 58:return!1}return!0}(this.type)},enumerable:!1,configurable:!0}),i.prototype.getSegment=function(){return new j.X(this.expression,this.startPosition,this.length)},i.prototype.getString=function(){return this.expression.substr(this.startPosition,this.length)},i.prototype.getIdentifier=function(){var K=this.getString();if(this.isIdentifierOrKeyword)return K;switch(this.type){case 32:return M.LP.unquote(K);case 33:return M.LP.unquotePartial(K);case 34:return M.LP.unbracket(K);case 35:return M.LP.unbracketPartial(K)}return""},i.prototype.matchesType=function(K){return!!Y(this.type,K)||60===this.type&&(58===K||32===K||34===K||z.d.featureSwitches.suggestKeywords&&48===K)},i.prototype.markAsSecondHalf=function(K){this._length=this._startPosition+this._length-K,this._startPosition=K,this._secondHalf=!0},i.prototype.cloneForReuse=function(K,y,ie,ve){return new i(this.type,K,y,ie,this.ignorable,ve,!1,this.matchObject,ve?H.Yl.None:this.matchedType)},i.prototype.attachToNewExpression=function(K){this._expression=K},i.prototype.offsetPosition=function(K){this._startPosition+=K},i}();function Y(i,K){if(i===K)return!0;switch(i){case 31:return 30===K;case 30:return 31===K;case 33:return 32===K;case 32:return 33===K;case 35:return 34===K;case 34:return 35===K;case 37:return 36===K;case 36:return 37===K;case 38:return 39===K;case 39:return 38===K}return!1}function I(i){return i>1&&i<8}function W(i){return i>41&&i<56}},63513:function(Ke,we,E){E.d(we,{Bl:function(){return Z},G:function(){return H},LP:function(){return te},Sy:function(){return V},Xy:function(){return I},as:function(){return M},ci:function(){return Y},jl:function(){return ee},uI:function(){return j}});var H,V,j,W,R=E(81337),z=E(55863);function M(W,i){return W instanceof i?W:void 0}function k(W,i){return W?W.equals?W.equals(i):W===i:i?i.equals?i.equals(W):i===W:W===i}(H||(H={})).hasFlag=function(K,y){return void 0===K&&(K=0),void 0===y&&(y=0),(K&y)===y},(W=V||(V={})).union=function(ve,D,b){return ve.concat(_.filter(D,function(q){return!_.some(ve,function(he){return b(q,he)})}))},W.distinct=function(ve,D){for(var b=[],q=function(Me){_.some(b,function(xe){return D(Me,xe)})||b.push(Me)},he=0,ce=ve;he<ce.length;he++)q(ce[he]);return b},W.ofType=function(ve,D){return _.filter(ve,function(b){return b instanceof D})},W.skipWhile=function(ve,D){for(var b=0;b<ve.length&&D(ve[b]);)b++;return ve.slice(b)},function(W){function y(he,ce){for(var ye=0;ye<he.length&&_.includes(ce,he[ye]);ye++);return he.substr(ye)}function ie(he,ce){for(var ye=he.length-1;ye>=0&&_.includes(ce,he[ye]);ye--);return he.substr(0,ye+1)}W.compare=function(he,ce,ye){return he===ce?0:null==he||null==ce?-1:(ye&&(he=he.toUpperCase(),ce=ce.toUpperCase()),he===ce?0:he<ce?-1:1)},W.trim=function(he,ce){return y(ie(he,ce),ce)},W.trimStart=y,W.trimEnd=ie,W.indexOfAny=function(he,ce,ye){for(var Pe,Me=0,xe=ce;Me<xe.length;Me++){var ge=he.indexOf(xe[Me],ye);-1!==ge&&(null==Pe||ge<Pe)&&(Pe=ge)}return void 0!==Pe?Pe:-1},W.equalIgnoreCase=function(he,ce){return(0,z.mv)(he,"first string in comparison must be defined"),(0,z.mv)(ce,"second string in comparison must be defined"),he.toUpperCase()===ce.toUpperCase()},W.isNullOrEmpty=function(he){return!he},W.startsWithIgnoreCase=function(he,ce){return(0,z.mv)(he,"str"),_.startsWith(he.toUpperCase(),ce.toUpperCase())}}(j||(j={}));var te,ee,Y=function(){function W(){this.items=[]}return W.prototype.enqueue=function(i){this.items.push(i)},W.prototype.dequeue=function(){return this.items.pop()},Object.defineProperty(W.prototype,"length",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),W}(),Z=function(){function W(){this.table=new I}return W.prototype.add=function(i){var K=this.table.get(i);return!(K&&_.some(K,function(y){return k(y,i)})||(this.table.add(i,[i]),0))},W.prototype.remove=function(i){var K=this.table.get(i);if(!K)return!1;for(var y=0;y<K.length;y++)if(k(K[y],i))return K.splice(y,1),!0;return!1},W.prototype.contains=function(i){var K=this.table.get(i);return!!K&&_.some(K,function(y){return k(y,i)})},W.prototype.values=function(){for(var i=[],K=0,y=this.table.values();K<y.length;K++)i.push.apply(i,y[K]);return i},W}(),I=function(){function W(){this.hashMap={}}return Object.defineProperty(W.prototype,"keys",{get:function(){var K=[];for(var y in this.hashMap)K.push.apply(K,this.hashMap[y].map(function(ve){return ve.key}));return K},enumerable:!1,configurable:!0}),W.prototype.add=function(i,K){var y=W.getHashCode(i),ie=this.getBucket(i);if(ie){if(this.containsKey(i))throw new Error("Cannot add duplicate value to dictionary");ie.push({key:i,value:K})}else this.hashMap[y]=[{key:i,value:K}]},W.prototype.update=function(i,K){var y=this.getEntry(i);y?y.value=K:this.add(i,K)},W.prototype.get=function(i){var K=this.getEntry(i);return K&&K.value},W.prototype.values=function(){var i=[];for(var K in this.hashMap)i.push.apply(i,_.map(this.hashMap[K],function(ie){return ie.value}));return i},W.prototype.containsKey=function(i){return!!this.getEntry(i)},W.prototype.getBucket=function(i){var K=W.getHashCode(i);return this.hashMap.hasOwnProperty(K)?this.hashMap[K]:void 0},W.prototype.getEntry=function(i){var K=this.getBucket(i);if(K)return _.find(K,function(y){return W.equals(y.key,i)})},W.getHashCode=function(i){var K=i;return _.isFunction(K.getHashCode)?K.getHashCode():0},W.equals=function(i,K){if((0,z.mv)(i,"a"),(0,z.mv)(K,"b"),i.constructor!==K.constructor)return!1;var y=i;return _.isFunction(y.equals)?y.equals(K):i===K},W}();!function(W){var i=/[a-zA-Z_][a-zA-Z_0-9]*/;function y(ge,Oe){return _.isFunction(Oe)?ie(ge,Oe):ie(ge,function(re){return Oe.isReservedWord(re)})}function ie(ge,Oe){var re=i.exec(ge);return!re||re[0].length!==ge.length||Oe(ge)}function ve(ge){return ge&&D(ge)+"'"}function D(ge){return"'"+ge.replace(/'/g,"''")}function q(ge){return ge.substr(1).replace(/''/g,"'")}function Pe(ge){return"["+ge.replace(/\]/g,"]]")}function xe(ge){return ge.substr(1).replace(/\]\]/g,"]")}W.quoteIfNeeded=function(ge,Oe){return y(ge,Oe)?ve(ge):ge},W.quoteNeeded=y,W.quote=ve,W.quotePartial=D,W.unquote=function(ge){return q(ge.substr(0,ge.length-1))},W.unquotePartial=q,W.doubleQuote=function(ge){return'"'.concat(ge.replace(/"/g,'""'),'"')},W.unDoubleQuote=function(ge){return ge.substr(1,ge.length-2).replace(/""/g,'"')},W.bracket=function(ge){return Pe(ge)+"]"},W.bracketPartial=Pe,W.unbracket=function(ge){return xe(ge.substr(0,ge.length-1))},W.unbracketPartial=xe,W.hasValidAxesReferences=function(ge){return!_.isEmpty(ge)&&!_.some(ge,function(Oe){return _.isEmpty(Oe)})}}(te||(te={})),function(W){W.getAllExploredStates=function(K){for(var y=[],ie=[],ve=0,D=K;ve<D.length;ve++){var b=D[ve];b.iterate(),y=(0,R.ev)((0,R.ev)([],y,!0),b.completedStates,!0),ie=(0,R.ev)((0,R.ev)([],ie,!0),b.incompleteStates,!0)}return{completedStates:y,incompleteStates:ie}}}(ee||(ee={}))},35747:function(Ke,we,E){E.r(we),E.d(we,{VisualCalcEditorModule:function(){return ca},VisualCalcServiceLazyProvider:function(){return or},VisualCalcServicePromiseFactory:function(){return ar}});var R=E(77476),z=E(17174),H=E(46544),V=E(26898),j=E(83008),M=E(21024),k=E(48145),Y=E(27980),Z=E(32288),I=E(9380),te=E(9844),ee=E(67659),W=E(95859),i=E(50423),K=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({}),r}(),y=E(81337),ie=E(74611),ve=E(55375),D=E(75334),b=E(8898),q=E(62458),he=E(81213),ce=E(65181),ye=function(r){return r[r.GetDataModel=0]="GetDataModel",r[r.ApplyChange=1]="ApplyChange",r[r.ManageRelationship=2]="ManageRelationship",r[r.PendingChange=3]="PendingChange",r[r.AutodetectRelationship=4]="AutodetectRelationship",r}({}),Me=function(){function r(e,t,n,o){var a=this;this.errorService=e,this.eventAggregationService=t,this.featureSwitchService=n,this.localizationService=o,this.clientSystemErrorCategories=["ModelObjectState","Structural","Unknown"],this.handleGeneralSystemOrExternalErrors=function(c,g,S){void 0===S&&(S=!0);var x=a.localizationService.get(a.commonErrorMessages.get(c).systemOrExternalErrorKey),F=!1;return S&&(a.handleDefaultError(c,g),F=!0),a.eventHandling(x,x,!1),F},this.handleDefaultError=function(c,g){var S=a.commonErrorMessages.get(c).systemOrExternalErrorKey,x=a.commonErrorMessages.get(c).errorType;return a.defaultErrorDialog(a.localizationService.get(S),x,g),!0},this.defaultErrorDialog=function(c,g,S){a.errorService.error(c,g,{requestId:S.requestId,statusCode:S.status&&S.status.toString(),errorDetails:a.getErrorDetails(S),stackTrace:a.getStackTrace(S.error)})},this.handleModelStateUserErrors=function(c,g){switch(a.getErrorObject(g).code){case"ModelOutOfSync":return a.handleModelOutOfSyncError(),!0;case"DataModelVersionNotSupported":return a.handleDataModelVersionNotSupported(),!0;case"ApplyPendingChanges":return a.handleApplyPendingChanges(g),!0;case"DeleteDataSourceNotSupported":return a.handleDeleteDataSourceError(),!0;case"InvalidCapacityState":return!!a.featureSwitchService.featureSwitches.detectFabricCapacityStateErrors&&(a.handleInvalidCapacityStateError(c,g),!0)}return!1},this.handleGeneralUserErrors=function(c,g,S,x,F){var G=a.getErrorObject(g).code;if(a.handleModelStateUserErrors(c,g))return!0;switch(G){case"NameValidationError":return a.handleNameValidationError(g),!0;case"RelationshipError":return a.handleRelationshipError(g,!0),!0;case"ASOperationExceptionError":return a.handleASOperationError(g,F),!0;default:return!!S&&(a.handleUnknownUserError(g,c),!0)}},this.handlGetDataModelUserErrors=function(c,g){return a.handleModelStateUserErrors(c,g)||a.tryHandleUnknowUserError(g,c),!0},this.handleUnknownUserError=function(c,g){if(!a.tryHandleClientSystemError(c,g)){var S=a.tryHandleUnknowUserError(c,g),x=a.commonErrorMessages.get(g).unkownUserErrorKey;a.eventHandling(a.localizationService.get(x),S||a.getErrorDetails(c),!1)}},this.commonErrorMessages=new Map([[ye.GetDataModel,{systemOrExternalErrorKey:"WebModeling_GetDataModelSystemOrExternalError",unkownUserErrorKey:"WebModeling_GetDataModelUnKnownUserError",errorType:"webModelingGetDataModelFailure"}],[ye.ApplyChange,{systemOrExternalErrorKey:"WebModeling_ApplyChangeSystemOrExternalError",unkownUserErrorKey:"WebModeling_ApplyChangeUnKnownUserError",errorType:"webModelingApplyChangeFailure"}],[ye.ManageRelationship,{systemOrExternalErrorKey:"WebModeling_ManageRelationshipSystemOrExternalError",unkownUserErrorKey:"WebModeling_ManageRelationshipUnKnownUserError",errorType:"webModelingManageRelaitonshipFailure"}],[ye.PendingChange,{systemOrExternalErrorKey:"WebModeling_PendingChangeFailed",unkownUserErrorKey:"WebModeling_PendingChangeFailed",errorType:"webModelingPendingChangeFailure"}],[ye.AutodetectRelationship,{systemOrExternalErrorKey:"WebModeling_AutodetectRelationshipSystemOrExternalError",unkownUserErrorKey:"WebModeling_AutodetectRelationshipUnknownError",errorType:"webModelingAutodetectRelationshipFailure"}]])}return r.prototype.handleApplyChangeErrors=function(e,t,n,o,a){return this.associateTelemetryEvent=t,this.handleError(e,ye.ApplyChange,n?this.handleGeneralUserErrors:this.handleModelStateUserErrors,this.handleGeneralSystemOrExternalErrors,o,!1,a)},r.prototype.handleGetDataModelErrors=function(e){this.handleError(e,ye.GetDataModel,this.handlGetDataModelUserErrors,this.handleDefaultError)},r.prototype.handleManageRelationshipErrors=function(e,t){this.associateTelemetryEvent=t,this.handleError(e,ye.ManageRelationship,this.handleGeneralUserErrors,this.handleGeneralSystemOrExternalErrors)},r.prototype.handlePendingChangeError=function(e,t){this.handleError(e,ye.PendingChange,this.handleGeneralUserErrors,this.handleDefaultError),this.eventHandling("WebModeling_PendingChangeFailed","WebModeling_PendingChangeFailed",!0)},r.prototype.handleAutodetectRelationshipError=function(e,t){this.associateTelemetryEvent=t,this.handleError(e,ye.AutodetectRelationship,this.handleGeneralUserErrors,this.handleGeneralSystemOrExternalErrors)},r.prototype.handleError=function(e,t,n,o,a,c,g){void 0===a&&(a=!0),void 0===c&&(c=!0);var S=this.getErrorObject(e);return S&&S["pbi.error"]?1===S["pbi.error"].exceptionCulprit?n(t,e,a,c,g):o(t,e,a):!!a&&(this.defaultErrorDialog(this.getErrorDetails(e),this.commonErrorMessages.get(t).errorType,e),!0)},r.prototype.handleModelOutOfSyncError=function(){this.displayUserErrorDialog(this.localizationService.get("ErrorMessage_DefaultTitle"),this.localizationService.get("WebModeling_ModelOutOfSync")),this.eventHandling(this.localizationService.get("WebModeling_ModelOutOfSync"),"",!0)},r.prototype.handleDataModelVersionNotSupported=function(){var e=this.localizationService.get("DataModelVersionNotSupportedMessage");this.displayUserErrorDialog(this.localizationService.get("PendingChangesTitle"),e),this.eventHandling("ModelingEngineError",e,!1)},r.prototype.handleApplyPendingChanges=function(e){var t=this.getErrorMessage(e);q.fF.assertValue(t,"The error message in applyPendingChanges should not be empty."),this.displayUserErrorDialog(this.localizationService.get("PendingChangesTitle"),t),this.eventHandling("ModelingEngineError",t,!1)},r.prototype.handleDeleteDataSourceError=function(){var e=this.localizationService.get("DeleteDataSourceNotAllowedMessage");this.displayUserErrorDialog(this.localizationService.get("DeleteDataSourceNotAllowedTitle"),e),this.eventHandling("ModelingEngineError",e,!1)},r.prototype.handleNameValidationError=function(e){var o,t=this.getDetailValue(e,"ModelingServiceError_ObjectType"),n=this.getErrorMessage(e);switch(q.fF.assertValue(t,"The object type in nameValidationError should not be empty."),q.fF.assertValue(n,"The error message in nameValidationError should not be empty."),t){case"Hierarchy":o=this.localizationService.get("RenameHierarchyTitle");break;case"Column":o=this.localizationService.get("RenameColumnTitle");break;case"Level":o=this.localizationService.get("RenameHierarchyLevelTitle");break;case"Measure":o=this.localizationService.get("RenameMeasureErrorTitle");break;case"Table":o=this.localizationService.get("RenameTableTitle");break;default:q.fF.assertFail("Unexpected object type failed name validation: "+t),o=this.localizationService.get("RenameItemTitle")}q.fF.assertValue(n,"The error message in nameValidationError should not be empty."),this.displayUserErrorDialog(o,n),this.eventHandling("ModelingEngineError",n,!1)},r.prototype.handleInvalidCapacityStateError=function(e,t){var n,o,a=this.localizationService.get(this.commonErrorMessages.get(e).unkownUserErrorKey),c=this.getErrorObject(t),g=c&&c["pbi.error"];if(this.containsCapacityExceptionCause(g)){var S=this.getCapacityExceptionCause(g);o="https://aka.ms/capacitymessages",n=this.localizationService.format("FabricThrottled"===S||"PowerBIThrottled"===S?"CapacityThrottledGenericErrorContent":"FabricCapacityNotAvailableErrorContent")}else n=this.getErrorMessage(t);q.fF.assertValue(n,"Error message not calculated"),q.fF.assertValue(a,"Error title not calculated"),this.displayUserErrorDialog(a,n,o),e!==ye.GetDataModel&&this.eventHandling("InvalidCapacityState",n,!1)},r.prototype.handleASOperationError=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c,g;return(0,y.Jh)(this,function(S){if(t.length>0&&t.every(function(x){return!!x.setDataType}))a=(0,ie.dr)(t[0].setDataType.dataType),c=a?this.localizationService.get(a):null,n=this.localizationService.format("ReportModelChangeColumnDataTypeFailedMessage",c),o=this.localizationService.get("Error");else switch(n=this.getErrorMessage(e),g=this.getDetailValue(e,"ModelingServiceError_AdditionalErrorCode"),g){case"PFE_TM_ALTERNATEOF_INVALID_RLS":o=this.localizationService.get("ManageRolesASExceptionForRLSWithAggsMessageTitle");break;case"PFE_TM_NO_SFB_FOR_RLS_TABLE":o=this.localizationService.get("ManageRolesASExceptionForCrossFilteringRelationshipsMessageTitle"),n=this.localizationService.get("ManageRolesASExceptionForCrossFilteringRelationshipsMessage");break;case"PFE_XM_COLUMN_UNIQUE_CONSTRAINT":o=this.localizationService.get("KeyColumnUniquenessErrorTitle"),n=this.localizationService.get("KeyColumnUniquenessErrorMessage");break;case"PFE_TM_RLS_NOT_SUPPORTED_ON_PROXY_TABLE":o=this.localizationService.get("WebModeling_ApplyChangeUnKnownUserError"),n=this.localizationService.get("RLS_Error_Message_For_ProxyModels");break;default:o=this.localizationService.get("Error")}return q.fF.assertValue(n,"Error message not calculated"),q.fF.assertValue(o,"Error title not calculated"),this.displayUserErrorDialog(o,n),this.eventHandling("ASOperationExceptionError",n,!1),[2]})})},r.prototype.handleRelationshipError=function(e,t){var n=this.getErrorMessage(e);q.fF.assertValue(n,"The error message in relationshipError should not be empty."),t&&this.displayUserErrorDialog(this.localizationService.get("InvalidRelationshipTitle"),n),this.eventHandling("WebModeling_ChangeRelationshipFailed",n,!1)},r.prototype.eventHandling=function(e,t,n){this.eventAggregationService.publishToClient("ModelChangeFailedEvent",[{errorInfoKey:e,errorInfoValue:t}]),this.eventAggregationService.publishToClient("LoadClientDataModelEvent",{refreshModel:n})},r.prototype.tryHandleUnknowUserError=function(e,t){var n=this.getErrorMessage(e);return n?this.displayUserErrorDialog(this.localizationService.get(this.commonErrorMessages.get(t).unkownUserErrorKey),n):this.defaultErrorDialog(this.localizationService.get(this.commonErrorMessages.get(t).unkownUserErrorKey),this.commonErrorMessages.get(t).errorType,e),n},r.prototype.tryHandleClientSystemError=function(e,t){var n=this.getClientSideSystemError(e);if(n){this.logClientSystemErrorIntoTelemetry(e.requestId,n,t.toString());var o=this.commonErrorMessages.get(t).unkownUserErrorKey;return this.eventHandling(this.localizationService.get(o),this.getErrorDetails(e),!0),this.defaultErrorDialog(this.localizationService.get(o),this.commonErrorMessages.get(t).errorType,e),!0}return!1},r.prototype.logClientSystemErrorIntoTelemetry=function(e,t,n){if(this.associateTelemetryEvent){var o=this.associateTelemetryEvent.event.info;o.hasClientSystemError=!0,o.apiErrorSource=n,o.errorCategory=t,o.stackTrace=this.getStackTrace()}},r.prototype.getClientSideSystemError=function(e){var t=this.getDetailValue(e,"ModelingServiceError_UserErrorCategory");if(this.clientSystemErrorCategories.find(function(n){return n===t}))return t},r.prototype.displayUserErrorDialog=function(e,t,n){this.errorService.error(t,"modelingError",{title:e,source:"User",hideGetHelpLink:!n,getHelpTextOverride:n?"Generic_LearnMore":void 0,showAdditionalErrorInfo:!1,helpLink:n})},r.prototype.getErrorDetails=function(e){var t;return JSON.stringify(null!==(t=this.getErrorObject(e))&&void 0!==t?t:e.data)},r.prototype.getDetailValue=function(e,t){return r.getDetailValueFromApiObject(this.getErrorObject(e),t)},r.getDetailValueFromApiObject=function(e,t){var n,o=e&&e["pbi.error"];if(!o)throw"pbi.error object doesn't exist in the error response";var a=_.find(o.details,function(c){return c.code===t});return null===(n=a?.detail)||void 0===n?void 0:n.value},r.prototype.getErrorMessage=function(e){return r.getErrorMessageFromApiObject(this.getErrorObject(e))},r.getErrorMessageFromApiObject=function(e){var t;return null!==(t=r.getDetailValueFromApiObject(e,"ModelingServiceError_Reason"))&&void 0!==t?t:""},r.prototype.getErrorObject=function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.error},r.prototype.getStackTrace=function(e){var t;return e?null===(t=e.innererror)||void 0===t?void 0:t.trace:(new Error).stack},r.prototype.getCapacityExceptionCause=function(e){if(e){var t=Array.isArray(e.parameters)?_.first(e.parameters):e.parameters;return t&&t.CapacityExceptionCause}},r.prototype.containsCapacityExceptionCause=function(e){return void 0!==this.getCapacityExceptionCause(e)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(he.T),i.\u0275\u0275inject(b.x),i.\u0275\u0275inject(I.vZ),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),xe=E(68082),je=E(53439),ge=E(65843),Oe=E(33197),re=E(58938),P=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.moveMeasure=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c;return(0,y.Jh)(this,function(S){switch(S.label){case 0:t=[],n=0,o=e,S.label=1;case 1:return n<o.length?[4,this.moveMeasureAllowed((c=(a=o[n]).measureMove).property,c.schema,c.destination,c.source)]:[3,4];case 2:S.sent()&&t.push(a),S.label=3;case 3:return n++,[3,1];case 4:return _.isEmpty(t)?[2]:[4,this.modelAuthoring.apply({changes:t})];case 5:return S.sent(),[2]}})})},r.prototype.moveMeasureAllowed=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){var a;return(0,y.Jh)(this,function(c){return a=this.dataModelService.getDataModel(),(0,ie.Gz)(a,t,n,e)?(ve.Z.buildCancelDialog(this.localizationService.get("MoveMeasureConfirmationTitle"),this.localizationService.format("MoveMeasureNameConflict",n,e),"MoveMeasureCancellationDialog",this.dialogService,this.localizationService),[2,!1]):[2,!0]})})},r.prototype.createNewCalcTable=function(){var e=this.localizationService.get("Table_ToolTip"),t=D.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Table",null,e,null);return this.applySchemaChangesWithIsNewFlag([{newCalculatedTableCreated:{entity:t,schema:null,expression:""}}],ge.X6.getTableUrn(t))},r.prototype.createNewCalcColumn=function(e,t){q.fF.assertValue(e,"Table not supplied for new column");var n=this.localizationService.get("Column"),o=D.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Column",e,n,null),a=[{newCalculatedColumnCreated:{entity:e,name:o,schema:null}}];if(t?.displayFolder){var c={setDisplayFolder:{modelObject:ge.X6.getColumnUrn(e,o,null),displayFolder:t.displayFolder}};a.push(c)}return this.applySchemaChangesWithIsNewFlag(a,ge.X6.getColumnUrn(e,o))},r.prototype.createNewMeasure=function(e,t,n){q.fF.assertValue(e,"Table not supplied for new measure");var o=this.localizationService.get("Measure"),a=D.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Measure",e,o,t),c=[{newMeasureCreated:{entity:e,name:a,schema:t,expression:"",dataType:"WholeNumber"}}];if(n?.displayFolder){var g={setDisplayFolder:{modelObject:ge.X6.getMeasureUrn(e,a,t),displayFolder:n.displayFolder}};c.push(g)}return this.applySchemaChangesWithIsNewFlag(c,ge.X6.getMeasureUrn(e,a,t))},r.prototype.updateCalculation=function(e,t,n,o,a,c){var g,S;return(0,y.mG)(this,void 0,void 0,function(){var x,G,ae,le;return(0,y.Jh)(this,function(ue){switch(ue.label){case 0:return x=Oe.G.createObject(e),[4,this.showUpdateCalculationConfirmation(x)];case 1:return ue.sent()?(G={updateExpression:{modelObject:e,expression:a?"":n,anonymizedExpression:o,expressionOverride:a,errorMessage:c}},le=null!==(S=null===(g=x.getSecondLevelPart())||void 0===g?void 0:g.name)&&void 0!==S?S:x.getTopLevelPart().name,t&&t!==le&&(ae="Table"===x.getObjectType()?{entityRename:{before:le,after:t,schema:x.getSchemaName()}}:{propertyRename:{objectType:x.getObjectType(),entity:x.getTopLevelPart().name,before:le,after:t,schema:x.getSchemaName()}}),[4,this.updateExpressionAndRename(G,ae)]):[2];case 2:return ue.sent(),[2]}})})},r.prototype.updateExpressionAndRename=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,c;return(0,y.Jh)(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,4]),c={changes:[e]},t&&(c.changes[1]=t),[4,this.modelAuthoring.apply(c,!0)];case 1:case 3:return g.sent(),[3,4];case 2:return n=g.sent(),o=Me.getErrorMessageFromApiObject(n),c={changes:[{updateExpression:{modelObject:e.updateExpression.modelObject,expression:"",anonymizedExpression:"",expressionOverride:{expression:e.updateExpression.expression},errorMessage:o}}]},t&&(c.changes[1]=t),[4,this.modelAuthoring.apply(c,!1)];case 4:return[2]}})})},r.prototype.showUpdateCalculationConfirmation=function(e){var t;return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c,g,S,x;return(0,y.Jh)(this,function(ae){switch(ae.label){case 0:return n=e.getSchemaName(),o=e.getTopLevelPart().name,a=null===(t=e.getSecondLevelPart())||void 0===t?void 0:t.name,c=this.dataModelService.getDataModel(),[],S=(0,ie.Lc)(c,n,o,a),g=a?(0,ie.L9)([S]):S.columns.filter(function(le){return"CalculatedTableColumn"===le.columnType}),(x=this.getUserSemanticDependentsAsDisplayableString(g))?[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("ChangeCalculationLabel"),message:this.localizationService.format("ModelingChangeConfirmationWithDependents",x)},"ChangeCalculationUserSemanticDependentsTitle",this.dialogService,this.localizationService)]:[3,3];case 1:return[4,ae.sent().afterClosed().toPromise()];case 2:return[2,1===ae.sent()];case 3:return[2,!0]}})})},r.prototype.getUserSemanticDependentsAsDisplayableString=function(e){if(!_.isEmpty(e)){var t=(0,ie.Y3)(e,this.localizationService);if(!_.isNull(t)&&!_.isEmpty(t))return t.join(this.localizationService.get("ListJoin_Separator"))}},r.prototype.applySchemaChangesWithIsNewFlag=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n={setAnnotation:{annotationName:ie.j0,value:"True",modelObject:t}},[4,this.modelAuthoring.apply({changes:(0,y.ev)((0,y.ev)([],e,!0),[n],!1)})];case 1:return o.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),p=E(70863),T=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.setDataType=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(a){switch(a.label){case 0:return[4,this.setDataType_internal(e,t,n,o)];case 1:return a.sent(),[2]}})})},r.prototype.setDescription=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return e&&0!==e.length&&0===e.filter(function(n){return!n.object.canEdit}).length?[4,this.SetDescriptionBySchemaChanges(e)]:[2];case 1:return t.sent(),[2]}})})},r.prototype.SetDescriptionBySchemaChanges=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return t=[],e.forEach(function(o){(0,p.t3)(o.object)||(0,p.kb)(o.object)||(0,p.y3)(o.object)||(0,p.ez)(o.object)||(0,p.wb)(o.object)?t.push({setDescription:{description:o.newValue,modelObject:o.object.urn}}):q.fF.assertFail("Trying to set description on unsupported object")}),[4,this.setDescription_internal(t)];case 1:return n.sent(),[2]}})})},r.prototype.setDescription_internal=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c,g,S,x,F,G,ae;return(0,y.Jh)(this,function(Te){switch(Te.label){case 0:for(t=this.dataModelService.getDataModel(),n=[],o=0,a=e;o<a.length;o++)q.fF.assertValue((c=a[o]).setDescription,"The SetDescription schemaChange shouldn't be empty"),1===(g=new Oe.M(c.setDescription.modelObject)).getParts().length&&"Table"===g.getTopLevelPart().objectType&&(S=(0,ie.Xt)(t,g.getTopLevelPart().name),x=(0,ie.aP)(S),F=(0,ie.q1)(S),(0,ie.oQ)(S,c.setDescription.description,x?.name,F?.name)&&n.push(S));return 0===n.length?[3,3]:(G=n.map(function(Be){return Be.name}).join(this.localizationService.get("ListJoin_Separator")),ae=this.localizationService.format(1===n.length?"DeleteDescriptionConfirmationWithCuration":"DeleteDescriptionConfirmationMultipleWithCuration",G),[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("DeleteDescriptionConfirmationTitle"),message:ae},"DeleteDescriptionConfirmationDialog",this.dialogService,this.localizationService,this.localizationService.get("Clear"))]);case 1:return[4,Te.sent().afterClosed().toPromise()];case 2:if(1!==Te.sent())return[2];Te.label=3;case 3:return[4,this.modelAuthoring.apply({changes:e})];case 4:return Te.sent(),[2]}})})},r.prototype.setDataType_internal=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){var a,c,g,S,x,F,G,ae,le,ue,Te,Be,De,gt,xt=this;return(0,y.Jh)(this,function(ft){switch(ft.label){case 0:for(a=[],c=this.dataModelService.getDataModel(),g=0,S=e;g<S.length;g++)"Column"===(x=S[g]).objectType&&(De=(0,ie.Gz)(c,x.schema,x.tableName,x.itemName))&&a.push(De);for(F=[],G=a.filter(function(st){return xt.isLossyConversion(st,t)}),ae=this.getUserSemanticDependentsAsDisplayableString(a),_.isEmpty(G)?ae&&F.push(this.localizationService.format("ModelingChangeConfirmationWithDependents",ae)):F.push(ae?this.localizationService.format("LossyDataTypeChangeConfirmationWithDependents",ae):this.localizationService.get("LossyDataTypeChangeConfirmationMessage")),le=function(yt){var At=c.expressions.filter(function(en){return _.isEqual(en.parameterValuesColumn,yt)});if(At&&!_.isEmpty(At))return F.push(ue.localizationService.get("DQP_Incompatible_Data_Type")),"break"},ue=this,Te=0,Be=a;Te<Be.length&&"break"!==le(De=Be[Te]);Te++);return _.isEmpty(F)?[3,3]:[4,ve.Z.buildOKCancelDialogWithList(this.localizationService.get("DataTypeChangeConfirmationTitle"),F,"DataTypeChangeConfirmationTitle",this.localizationService.get("DataTypeChangeConfirmation"),this.dialogService,this.localizationService)];case 1:return[4,ft.sent().afterClosed().toPromise()];case 2:if(1!==ft.sent())return[2];ft.label=3;case 3:return gt=[],e.forEach(function(st){var yt;"Column"===st.objectType?yt=ge.X6.getColumnUrn(st.tableName,st.itemName,st.schema):"Measure"===st.objectType&&(yt=ge.X6.getMeasureUrn(st.tableName,st.itemName,st.schema)),gt.push({setDataType:{dataType:t,clearTableValues:n,sourceProviderType:o,modelObject:yt}})}),[4,this.modelAuthoring.apply({changes:gt})];case 4:return ft.sent(),[2]}})})},r.prototype.getUserSemanticDependentsAsDisplayableString=function(e){var t=(0,ie.Y3)(e,this.localizationService);if(null!==t&&0!==t.length)return t.join(this.localizationService.get("ListJoin_Separator"))},r.prototype.isLossyConversion=function(e,t){var n=(0,ie.iQ)(e);return!!n[t]&&n[t]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),d=E(33565),C=E(34145),m=new i.InjectionToken("SchemaChangeService"),O=function(){return function(e,t,n){this.existingLevelUrn=e,this.levelName=t,this.columnName=n}}(),A=function(){function r(e,t,n){this.modelService=e,this.schemaChangeService=t,this.deleteModelItemService=n}return r.prototype.createHierarchy=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c,g,S,x,ae;return(0,y.Jh)(this,function(le){switch(le.label){case 0:return t=(0,p.QA)(this.modelService.model.tables,e.table.name),n=t.hierarchies?t.hierarchies.getItems().map(function(ue){return ue.name}):[],[4,this.schemaChangeService.createHierarchy([e])];case 1:for(le.sent(),o=(0,p.QA)(this.modelService.model.tables,e.table.name),a=o.hierarchies?o.hierarchies.getItems().map(function(ue){return ue.name}):[],g=function(Te){if(_.every(n,function(Be){return Be!==Te}))return c=Te,"break"},S=0,x=a;S<x.length&&"break"!==g(x[S]);S++);return c?(ae=(0,p.QA)(o.hierarchies,c),e.displayFolder?[4,this.schemaChangeService.setDisplayFolder([{object:ae,newValue:e.displayFolder}])]:[3,3]):[3,4];case 2:return le.sent(),o=(0,p.QA)(this.modelService.model.tables,e.table.name),[2,(0,p.QA)(o.hierarchies,c)];case 3:return[2,ae];case 4:return[2,null]}})})},r.prototype.createHierarchyFromMultiple=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c,g,S,x,ae;return(0,y.Jh)(this,function(le){switch(le.label){case 0:return t=(0,p.QA)(this.modelService.model.tables,e[0].table.name),n=t.hierarchies?t.hierarchies.getItems().map(function(ue){return ue.name}):[],[4,this.schemaChangeService.createHierarchy(e)];case 1:for(le.sent(),o=(0,p.QA)(this.modelService.model.tables,e[0].table.name),a=o.hierarchies?o.hierarchies.getItems().map(function(ue){return ue.name}):[],g=function(Te){if(_.every(n,function(Be){return Be!==Te}))return c=Te,"break"},S=0,x=a;S<x.length&&"break"!==g(x[S]);S++);return c?(ae=(0,p.QA)(o.hierarchies,c),e[0].displayFolder?[4,this.schemaChangeService.setDisplayFolder([{object:ae,newValue:e[0].displayFolder}])]:[3,3]):[3,4];case 2:return le.sent(),o=(0,p.QA)(this.modelService.model.tables,e[0].table.name),[2,(0,p.QA)(o.hierarchies,c)];case 3:return[2,ae];case 4:return[2,null]}})})},r.prototype.applyLevelChanges=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,a,c,g=this;return(0,y.Jh)(this,function(S){switch(S.label){case 0:return o=[],e.levels.getItems().forEach(function(x){var F=t.find(function(G){return G.levelName===x.name});F?F.existingLevelUrn||(F.existingLevelUrn=x.urn):o.push(x)}),a=[],c=[],t.forEach(function(x,F){var G;x.existingLevelUrn&&(G=(0,p.Tr)(e.levels,x.existingLevelUrn)),G?G.ordinal!==F&&a.push({object:G,newValue:F}):c.push(g.createLevel(e,x.levelName,x.columnName,F,n))}),c.length>0&&a.length>0&&c.length+a.length>1?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(c,a,null)]:[3,2];case 1:return S.sent(),[3,6];case 2:return c.length>0?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(c,null,null)]:[3,4];case 3:return S.sent(),[3,6];case 4:return a.length>0&&c.length+a.length>1?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(null,a,null)]:[3,6];case 5:S.sent(),S.label=6;case 6:return o.length>0?[4,this.deleteModelItemService.deleteAllFromModel(o,!c.length)]:[3,8];case 7:S.sent(),S.label=8;case 8:return[2]}})})},r.prototype.addNewLevels=function(e,t){var n=[];e.levels.getItems().forEach(function(o){var a=new O(o.urn,o.name,o.column.name);n.push(a)}),t.forEach(function(o){if(!n.find(function(c){return c.columnName===o.name})){var a=new O(null,o.name,o.name);n.push(a)}}),this.applyLevelChanges(e,n)},r.prototype.createLevelWithName=function(e,t,n,o){return void 0===o&&(o=!0),{name:t,displayName:void 0,lineageTag:"",description:"",hierarchy:e,column:(0,p.QA)(e.table.columns,n),schemaName:e.schemaName,canEdit:void 0,canDelete:void 0,canRename:void 0,urn:ge.X6.getLevelUrn(e.table.name,void 0,e.name,t,e.schemaName),ordinal:void 0,modelObjectType:"Level"}},r.prototype.createLevel=function(e,t,n,o,a){return void 0===a&&(a=!1),{schema:e.schemaName,entity:e.table.name,hierarchy:e.name,property:n,levelName:t,index:void 0!==o?o:e.levels.length}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(C.q),i.\u0275\u0275inject(m),i.\u0275\u0275inject(d.c))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),U=E(67789),Q=new i.InjectionToken("ModernModalDialogService"),pe=E(48787),me="GroupsDialog",Ee=function(r){return r[r.CloseDialog=0]="CloseDialog",r[r.ChangeTab=1]="ChangeTab",r[r.AssignPaneRoleSelection=2]="AssignPaneRoleSelection",r[r.Revert=3]="Revert",r}({}),Se=function(){function r(e,t,n,o,a){this.dataModelService=e,this.dialogService=t,this.featureSwitchService=n,this.localizationService=o,this.modalDialogService=a,document.modelingDialogService=this}return r.prototype.openDataSearchCurationDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return t={title:this.localizationService.get("FeaturedTable_Setup_Title"),okButtonText:this.localizationService.get("ModalDialog_Save"),hideCancelButton:!1,focusInitialCloseButton:!0,input:{table:e}},[4,this.dialogService.showTemplateDialog("DataSearchCurationComponent",t,{minHeight:453,width:"650px"})];case 1:return o.sent(),[2]}})})},r.prototype.openRemoveOrDeleteTableDialog=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var a=this;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return[4,this.dialogService.openHostDialog({dialogName:"Remove or delete this table?",componentName:"RemoveOrDeleteTableComponent",bindings:{multipleTables:e},config:{minHeight:170,width:"575px",panelClass:["no-padding"],backdropClass:"cdk-overlay-transparent-backdrop"}})];case 1:return c.sent().afterClosed().pipe((0,pe.q)(1)).subscribe(function(g){return(0,y.mG)(a,void 0,void 0,function(){return(0,y.Jh)(this,function(S){return t(g),[2]})})}),[2]}})})},r.prototype.openManageAggregationsDialog=function(e){var t;return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return!(n=this.dataModelService.getDataModel()).tables.find(function(g){return _.isEqual(g.name,e)}).capabilities.canEdit||null!==(t=n.expressions)&&void 0!==t&&t.find(function(g){return null!=g.parameterValuesColumn})?[3,2]:[4,this.dialogService.openHostDialog({componentName:"ManageAggregationsComponent",dialogName:"Manage aggregations",autoFocus:!0,bindings:{table:e},config:{height:"628px",width:"800px",backdropClass:"cdk-overlay-transparent-backdrop",panelClass:["pbi-dialog","no-padding"]}})];case 1:c.sent(),c.label=2;case 2:return[2]}})})},r.prototype.openManageRelationshipsDialog=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,n=this;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return e={title:this.localizationService.get("Manage_Relationships"),okButtonText:"Close",hideCancelButton:!0,focusInitialCloseButton:!0},[4,this.dialogService.showTemplateDialog("ManageRelationshipsComponent",e)];case 1:return o.sent().afterClosed().pipe((0,pe.q)(1)).subscribe(function(a){return(0,y.mG)(n,void 0,void 0,function(){return(0,y.Jh)(this,function(c){switch(c.label){case 0:return"OpenNewRelationshipDialog"!==a?.closeStatus?[3,2]:[4,this.openCreateRelationshipDialog(a.args,!0)];case 1:return c.sent(),[3,4];case 2:return"OpenEditRelationshipDialog"!==a?.closeStatus?[3,4]:[4,this.openEditRelationshipDialog(a.args,!0)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}),[2]}})})},r.prototype.openFixMissingRelationshipsDialog=function(e,t){return void 0===t&&(t=!1),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return n={title:this.localizationService.get("RelationshipDetection_Tooltip"),showDefaultActions:!1,input:{tables:e,autodetect:t}},[4,this.dialogService.showTemplateDialog("FixMissingRelationshipsDialogComponent",n)];case 1:return[2,a.sent().afterClosed().toPromise()]}})})},r.prototype.openDeleteLayoutConfirmDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,ve.Z.buildOKCancelDialog({title:this.localizationService.format("WebDiagram_Delete_LayoutName",e),message:this.localizationService.format("WebDiagram_Delete_LayoutMessage")},"Delete Layout",this.dialogService,this.localizationService,this.localizationService.format("Delete"))];case 1:return[2,n.sent().afterClosed().toPromise()]}})})},r.prototype.openIncrementalRefreshPolicyDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,c,g;return(0,y.Jh)(this,function(x){switch(x.label){case 0:return t=this.dataModelService.getDataModel(),n=t.tables.find(function(F){return _.isEqual(F.name,e)}),(o=n.capabilities.canSetIncrementalRefreshPolicy&&n.capabilities.canEdit)&&!this.featureSwitchService.enableHybridTables?[4,this.dialogService.openHostDialog({componentName:"IncrementalRefreshPolicyComponent",dialogName:"Incremental Refresh Policy",autoFocus:!0,bindings:{table:e},config:{height:"668px",width:"660px",backdropClass:"cdk-overlay-transparent-backdrop",panelClass:["pbi-dialog","no-padding"]}})]:[3,2];case 1:case 3:return x.sent(),[2];case 2:return o&&this.featureSwitchService.enableHybridTables?(c={table:e},g={title:this.localizationService.get("Incremental_Refresh_With_DQ_Title"),input:c,okButtonText:this.localizationService.get("Apply"),isDraggable:!0},[4,this.dialogService.showTemplateDialog("IncrementalRefreshPolicyWithDirectQueryComponent",g,{width:"614px",height:"700px"})]):[3,4];case 4:return[2]}})})},r.prototype.openRLSEditorDialog=function(){return(0,y.mG)(this,void 0,void 0,function(){var e;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return e={title:this.localizationService.get("RLS_Editor_Title"),cancelButtonText:this.localizationService.get("Close"),okButtonText:this.localizationService.get("ModalDialog_Save"),okButtonDisabled:!0,input:null,dontCloseOnDefaultActions:!0},[4,this.dialogService.showTemplateDialog("RLSEditorDialogComponent",e,{width:"1068px"})];case 1:return n.sent(),[2]}})})},r.prototype.openRLSEditorConfirmationDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a;return(0,y.Jh)(this,function(S){switch(S.label){case 0:switch(n=this.localizationService.get("SaveChanges"),o=this.localizationService.get("ModalDialog_Save"),a=this.localizationService.get("ModalDialog_DontSave"),e){case Ee.AssignPaneRoleSelection:t=this.localizationService.get("RLS_Editor_SaveChanges_Message_SwitchRole");break;case Ee.ChangeTab:t=this.localizationService.get("RLS_Editor_SaveChanges_Message_Tabbing");break;case Ee.CloseDialog:t=this.localizationService.get("RLS_Editor_SaveChanges_Message");break;case Ee.Revert:t=this.localizationService.get("RLS_Editor_RevertChanges_Message"),n=this.localizationService.get("Revert_Changes"),o=this.localizationService.get("MobileReport_RevertText"),a=this.localizationService.get("Cancel_ButtonText")}return[4,ve.Z.buildOKCancelDialog({title:n,preventEscPropagation:!0,message:t},"SaveChangesDialog",this.dialogService,this.localizationService,o,a)];case 1:return[4,S.sent().afterClosed().toPromise()];case 2:return[2,S.sent()]}})})},r.prototype.openCreateRelationshipDialog=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.openCreateOrEditRelationshipDialog(e,null,!!t)];case 1:return[2,n.sent()]}})})},r.prototype.openGroupDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return this.featureSwitchService.modernGroupingDialog?(t={title:this.localizationService.get("Groups"),input:e,hideOkButton:!1,hideCancelButton:!1,okButtonText:this.localizationService.get("OK_ButtonText"),okButtonDisabled:!0},[4,this.dialogService.showTemplateDialog(me,t)]):[3,3];case 1:return[4,o.sent().afterClosed().toPromise()];case 2:return[2,o.sent()];case 3:return[2,this.modalDialogService.showHostModalDialog({dialogName:me,definitionTemplateCachePath:"components/groupsDialog/groupsDialogDefinition.html",bindings:{args:e}})]}})})},r.prototype.openEditRelationshipDialog=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:if(n=this.dataModelService.getDataModel(),!(o=(0,ie.Te)(n,e.fromTableId,e.toTableId,e.fromColumnId,e.toColumnId)))throw new Error("relationship does not exist for editing");return a={fromTableId:e.fromTableId,fromColumnId:e.fromColumnId,toTableId:e.toTableId,toColumnId:e.toColumnId,canEdit:o.capabilities.canEdit,isActive:o.isActive,crossFilterDirection:o.crossFilteringBehavior.toString(),fromCardinality:o.fromCardinality.toString(),toCardinality:o.toCardinality.toString(),securityFilteringBehavior:o.securityFilteringBehavior.toString(),referentialIntegrity:o.referentialIntegrity},[4,this.openCreateOrEditRelationshipDialog(a,o.name,!!t)];case 1:return[2,c.sent()]}})})},r.prototype.openCreateOrEditRelationshipDialog=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,a,g,S=this;return(0,y.Jh)(this,function(x){switch(x.label){case 0:return o={title:this.localizationService.get(t?"Edit_Relationship":"New_Relationship"),okButtonText:this.localizationService.get("ModalDialog_Save"),hideCancelButton:!1,focusInitialCloseButton:!0,backButton:n,dontCloseOnAction:!0,input:{relationshipName:t,fromTable:e.fromTableId,fromColumn:e.fromColumnId,toTable:e.toTableId,toColumn:e.toColumnId,canEdit:e.canEdit,isActive:e.isActive,crossFilterDirection:e.crossFilterDirection,fromCardinality:e.fromCardinality,toCardinality:e.toCardinality,securityFilteringBehavior:e.securityFilteringBehavior,referentialIntegrity:e.referentialIntegrity,backToManageRelationshipDialogAfterClose:n}},a=this.featureSwitchService.newManageRelationshipDialog&&this.dataModelService.getDataModel().capabilities.supportManageRelationships,[4,this.dialogService.showTemplateDialog("CreateOrEditRelationshipComponent",o,{minHeight:a?"775":"545",minwidth:a?"686":"727"})];case 1:return(g=x.sent()).afterClosed().pipe((0,pe.q)(1)).subscribe(function(F){return(0,y.mG)(S,void 0,void 0,function(){return(0,y.Jh)(this,function(G){switch(G.label){case 0:return!0!==F?.backToManageRelationshipDialog?[3,2]:[4,this.openManageRelationshipsDialog()];case 1:G.sent(),G.label=2;case 2:return[2]}})})}),[2,g]}})})},r.prototype.openGenerateModelItemDescriptionDialog=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o;return(0,y.Jh)(this,function(g){switch(g.label){case 0:return e||(e=this.localizationService.get("None")),n={currentDescription:e,args:t},o={title:this.localizationService.get("Review_Copilot_Measure_Description"),okButtonText:this.localizationService.get("Keep_It"),cancelButtonText:this.localizationService.get("Settings_DiscardButtonText"),input:n},[4,this.dialogService.showTemplateDialog("GenerateModelItemDescriptionsComponent",o,{width:"640px",panelClass:["generateModelItemDescriptionDialog"]})];case 1:return[4,g.sent().afterClosed().toPromise()];case 2:return[2,g.sent()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(U.h),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(Q))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ae=E(83164),w=function(){function r(e){this.modelAuthoring=e}return r.prototype.applyRoleSettings=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.applyChanges(e)];case 1:return[2,!!(t=n.sent())&&"Failed"!==t.resultStatus]}})})},r.prototype.verifyRoleSettings=function(e){var t,n;return(0,y.mG)(this,void 0,void 0,function(){var o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return[4,this.applyChanges(e,!0)];case 1:return o=a.sent(),[2,null!==(n=null===(t=o.clientDataModel)||void 0===t?void 0:t.dataModel.roles)&&void 0!==n?n:[]]}})})},r.prototype.applyChanges=function(e,t){return void 0===t&&(t=!1),(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(o){switch(o.label){case 0:return[4,this.modelAuthoring.apply({changes:e},void 0,t)];case 1:return[2,o.sent()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),u=E(70604),s=E(66339),l=function(){function r(e,t){this.modelAuthoring=e,this.telemetryService=t}return r.prototype.renameObjects=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)?n.push({propertyRename:{schema:a.object.schemaName,entity:a.object.table.name,objectType:"Column",before:a.object.name,after:a.newName}}):(0,p.kb)(a.object)||(0,p.jz)(a.object)?n.push({propertyRename:{schema:a.object.schemaName,entity:a.object.table.name,objectType:"Measure",before:a.object.name,after:a.newName}}):(0,p.y3)(a.object)?n.push({propertyRename:{schema:a.object.schemaName,entity:a.object.table.name,objectType:"Hierarchy",before:a.object.name,after:a.newName}}):(0,p.ez)(a.object)?n.push({hierarchyLevelRename:{schema:a.object.schemaName,entity:a.object.hierarchy.table.name,hierarchy:a.object.hierarchy.name,before:a.object.name,after:a.newName}}):(0,p.wb)(a.object)?n.push({entityRename:{schema:a.object.schemaName,before:a.object.name,after:a.newName}}):(0,p.RF)(a.object)?n.push({propertyRename:{schema:a.object.schemaName,entity:a.object.calculationGroup.table.name,objectType:"CalculationItem",before:a.object.name,after:a.newName}}):q.fF.assertFail("Trying to 'renameObjects' unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDisplayFolder=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)||(0,p.kb)(a.object)||(0,p.y3)(a.object)?n.push({setDisplayFolder:{displayFolder:a.newValue,modelObject:a.object.urn}}):q.fF.assertFail("Trying to set displayFolder on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setIsHidden=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n,o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return n=[],e.forEach(function(c){if((0,p.wb)(c.object))o=ge.X6.getTableUrn(c.object.name,c.object.schemaName);else if((0,p.t3)(c.object))o=ge.X6.getColumnUrn(c.object.table.name,c.object.name,c.object.schemaName);else if((0,p.kb)(c.object))o=ge.X6.getMeasureUrn(c.object.table.name,c.object.name,c.object.schemaName);else{if(!(0,p.y3)(c.object))throw"Trying to set isHidden on unsupported object";o=c.object.urn}n.push({itemShowHide:{makeHidden:c.newValue,modelObject:o}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,a.sent()]}})})},r.prototype.setIsCuratedForDataSearch=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.wb)(a.object)?n.push({updateDataSearchCuration:{schema:a.object.schemaName,entity:a.object.name,isCurationEnabled:a.newValue}}):q.fF.assertFail("Trying to disable/enable data search curation on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.refreshData=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=_.map(e,function(a){return{entityRefresh:{schema:a.schemaName,entity:a.name}}}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.createLevelsAndOrSetLevelOrdinal=function(e,t,n){return void 0===n&&(n=null),(0,y.mG)(this,void 0,void 0,function(){var o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return o=[],e?.forEach(function(c){o.push({hierarchyLevelCreate:c})}),t?.forEach(function(c){(0,p.ez)(c.object)?o.push({hierarchyLevelMove:{schema:c.object.hierarchy.table.schemaName,entity:c.object.hierarchy.table.name,hierarchy:c.object.hierarchy.name,level:c.object.name,index:c.newValue}}):q.fF.assertFail("Trying to set ordinal on unsupported object")}),[4,this.pushOrApplyChanges(o,n)];case 1:return[2,a.sent()]}})})},r.prototype.createHierarchy=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.pushOrApplyChanges([{hierarchyCreate:{schema:e[0].table.schemaName,entity:e[0].table.name,name:null,levels:e.map(function(o){return{property:o.name,columnName:o.name}})}}],t)];case 1:return[2,n.sent()]}})})},r.prototype.setDescription=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.vP)(a.object)||(0,p.t3)(a.object)||(0,p.kb)(a.object)||(0,p.y3)(a.object)||(0,p.wb)(a.object)?n.push({setDescription:{description:a.newValue,modelObject:a.object.urn}}):(0,p.ez)(a.object)?q.fF.assertFail("Trying to set description on unsupported object (hierarchy level)"):q.fF.assertFail("Trying to set description on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setIsNullable=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)?n.push({setColumnNullable:{isNullable:a.newValue,modelObject:a.object.urn}}):q.fF.assertFail("Trying to set isNullable on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setSummarizeBy=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)?n.push({setDefaultSummarization:{aggregateFunction:"Default"===a.newValue?null:a.newValue,modelObject:a.object.urn}}):q.fF.assertFail("Trying to set sortByColumn on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDataCategory=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){n.push({setDataCategory:{modelObject:a.object.urn,dataCategory:a.newValue}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDecimalPlaces=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)||(0,p.kb)(a.object)?n.push({setDecimalPlaces:{decimalPlaces:a.newValue,modelObject:a.object.urn}}):q.fF.assertFail("Trying to set DecimalPlaces on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.toggleThousandsSeparator=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){n.push({toggleThousandsSeparator:{modelObject:a.urn}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setKeyColumn=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.wb)(a.object)?n.push({updateKeyColumn:{schema:a.object.schemaName,entity:a.object.name,property:a.newValue}}):q.fF.assertFail("Trying to set key column on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDefaultLabel=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.wb)(a.object)?n.push({updateDefaultLabel:{modelObject:a.newValue?ge.X6.getColumnUrn(a.object.name,a.newValue):a.object.urn}}):q.fF.assertFail("Trying to set default label on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.apply=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){return t=new u.B,e&&e.changes&&e.changes.length&&(this.telemetryService.logApplyChanges(this.getChangeNames(e)),this.modelAuthoring.apply(e).then(function(o){t.resolve()},function(o){q.fF.log(JSON.stringify(o)),t.reject(o.message)})),[2,t.promise]})})},r.prototype.setAlternateSourcePrecedence=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.wb)(a.object)?n.push({setTableAlternateSourcePrecedence:{schema:a.object.schemaName,entity:a.object.name,alternateSourcePrecedence:a.newValue}}):q.fF.assertFail("Trying to set AlternateSourcePrecedence on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setSortByColumn=function(e,t){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(a){(0,p.t3)(a.object)?n.push({sortByAnotherColumn:{sortByProperty:a.newValue,modelObject:a.object.urn}}):q.fF.assertFail("Trying to set sortByColumn on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setFormatInformation=function(e,t,n){return void 0===t&&(t=null),(0,y.mG)(this,void 0,void 0,function(){var o,a=this;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return o=[],e.forEach(function(g){if((0,p.t3)(g.object)||(0,p.kb)(g.object)){var S=a.createFormatInformationSchemaChange(g.object,g.newValue,n);S&&o.push(S)}else q.fF.assertFail("Trying to set formatInformation on unsupported object")}),[4,this.pushOrApplyChanges(o,t)];case 1:return[2,c.sent()]}})})},r.prototype.getChangeNames=function(e){return e.changes.map(function(t){return Object.keys(t)}).reduce(function(t,n){return(0,y.ev)((0,y.ev)([],t,!0),n,!0)})},r.prototype.pushOrApplyChanges=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return t?(t.changes||(t.changes=[]),e.length&&(n=t.changes).push.apply(n,e||[]),[2,null]):[3,1];case 1:return[4,this.apply({changes:e})];case 2:return[2,o.sent()]}})})},r.prototype.createFormatInformationSchemaChange=function(e,t,n){var o=null,a=e.formatInformation;return a.format!==t.format||"Custom"===t.format?o=this.changeFormatFormatInformationSchemaChange(e,t,n):t.dateTimeCustomFormat?o={setDateTimeFormatInfo:{format:t.format,dateTimeCustomFormatGroup:t.dateTimeCustomFormat.formatGroup,formatString:t.dateTimeCustomFormat.formatString,modelObject:e.urn}}:a.thousandSeparator!==t.thousandSeparator?o={toggleThousandsSeparator:{modelObject:e.urn}}:a.accuracy!==t.accuracy?o={setDecimalPlaces:{decimalPlaces:t.accuracy,modelObject:e.urn}}:t.currencyFormat&&(o={setCurrencyFormatInfo:{culture:t.currencyFormat.culture,currencySymbol:t.currencyFormat.currencySymbol,positivePattern:t.currencyFormat.positivePattern,negativePattern:t.currencyFormat.negativePattern,format:t.format,modelObject:e.urn}}),o},r.prototype.changeFormatFormatInformationSchemaChange=function(e,t,n){switch(void 0===n&&(n=e.formatString),t.format){case"CurrencyGeneral":case"CurrencyCustom":return{setCurrencyFormatInfo:{culture:t.currencyFormat.culture,currencySymbol:t.currencyFormat.currencySymbol,positivePattern:t.currencyFormat.positivePattern,negativePattern:t.currencyFormat.negativePattern,format:t.format,modelObject:e.urn}};case"DateTimeGeneralPattern":case"DateTimeCustom":return{setDateTimeFormatInfo:{format:t.format,dateTimeCustomFormatGroup:t.dateTimeCustomFormat.formatGroup,formatString:t.dateTimeCustomFormat.formatString,modelObject:e.urn}};case"Custom":return{setCustomFormatStringInfo:{formatString:n,modelObject:e.urn}};default:return{setFormatting:{format:t.format,modelObject:e.urn}}}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(s.L))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),v=new i.InjectionToken("DataQueriesExecutionService"),L=E(49346),J=E(82762),fe=E(14172),se=E(59822);function Ce(r,e){var t,n=new Ge(e);return r.getColumnsCardinalityInfo?t=n.visitGetColumnsCardinality(r.getColumnsCardinalityInfo):r.validateReferentialIntegrity?t=n.visitValidateReferentialIntegrity(r.validateReferentialIntegrity):r.getTableData?t=n.visitGetTableData(r.getTableData):r.isValidKeyForDateTable?t=n.visitIsValidKeyForDateTable(r.isValidKeyForDateTable):r.canSortByColumn&&(t=n.visitCanSortByColumn(r.canSortByColumn)),t}var de=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("columns"))throw new Error("expect getColumnsCardinalityInfo has columns property");var n=this.dataQueriesExecutionResponse.dataQueries,o=[];if(1!==t.columns.length)throw new Error("Expect to only have one column in getColumnsCardinalityInfo query as for now.");for(var a=function(x){var F=n.queries[x];if(F.getColumnsCardinalityInfo){var G=t.columns.map(function(Te){return Te.column})[0],le=F.getColumnsCardinalityInfo.columns.map(function(Te){return Te.column}).findIndex(function(Te){return Te===G});if(le>-1)return o.push([x,[le]]),"break"}},c=0;c<n.queries.length&&"break"!==a(c);c++);return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.getColumnsCardinalityInfo)throw new Error("getColumnsCardinalityInfo should be found from dataQueriesResult");var o=e[0][1][0];if(n.getColumnsCardinalityInfo.columnsCardinalityInfo.length<o)throw new Error("target column cannot be found from getColumnsCardinalityInfo dataQueriesResult");return{columnsCardinalityInfo:[n.getColumnsCardinalityInfo.columnsCardinalityInfo[o]]}},r}(),Re=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("foreignKeyColumn")||!t.hasOwnProperty("primaryKeyColumn"))throw new Error("expect validateReferentialIntegrity has foreignKeyColumn or primaryKeyColumn property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],a=0;a<n.queries.length;a++){var c=n.queries[a];if(c.validateReferentialIntegrity&&c.validateReferentialIntegrity.foreignKeyColumn===t.foreignKeyColumn&&c.validateReferentialIntegrity.primaryKeyColumn===t.primaryKeyColumn){o.push([a,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.validateReferentialIntegrity)throw new Error("validateReferentialIntegrity should be found from dataQueriesResult");return(0,y.pi)({},n.validateReferentialIntegrity)},r}(),Ne=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("table")||!t.hasOwnProperty("columnNames"))throw new Error("expect getTableData has table or columns property");var n=this.dataQueriesExecutionResponse.dataQueries,o=[];if(t.columnNames.length<=0)throw new Error("Expect to have at least one column in getTableData");for(var a=function(S){var x=n.queries[S];if(x.getTableData){var F=!0,G=x.getTableData.columnNames;_.forEach(t.columnNames,function(ae){(G.findIndex(function(ue){return ue===ae})<0||x.getTableData.table!==t.table)&&(F=!1)}),F&&o.push([S,[0]])}},c=0;c<n.queries.length;c++)a(c);return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.getTableData)throw new Error("getTableData should be found from dataQueriesResult");return(0,y.pi)({},n.getTableData)},r}(),Ie=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("column"))throw new Error("expect isValidKeyForDateTable has column property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],a=0;a<n.queries.length;a++){var c=n.queries[a];if(c.isValidKeyForDateTable&&c.isValidKeyForDateTable.column===t.column){o.push([a,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.dateColumnValidations)throw new Error("dateColumnValidations should be found from dataQueriesResult");return(0,y.pi)({},n.dateColumnValidations)},r}(),ke=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("column"))throw new Error("expect canSortByColumn has column property");if(!t.hasOwnProperty("sortByColumn"))throw new Error("expect canSortByColumn has sortByColumn property");if(!t.hasOwnProperty("tablePartitionMode"))throw new Error("expect canSortByColumn has tablePartitionMode property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],a=0;a<n.queries.length;a++){var c=n.queries[a];if(c.canSortByColumn&&c.canSortByColumn.column===t.column&&c.canSortByColumn.sortByColumn===t.sortByColumn&&c.canSortByColumn.tablePartitionMode===t.tablePartitionMode){o.push([a,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.canSortByColumn)throw new Error("canSortByColumn should be found from dataQueriesResult");return(0,y.pi)({},n.canSortByColumn)},r}(),Ge=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.visitGetColumnsCardinality=function(e){var t=new de(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitValidateReferentialIntegrity=function(e){var t=new Re(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitGetTableData=function(e){var t=new Ne(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitIsValidKeyForDateTable=function(e){var t=new Ie(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitCanSortByColumn=function(e){var t=new ke(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.getTargetQueryResult=function(e,t){var n=t.getTargetQueryLocation(e);return t.getTargetQueryResult(n)},r}(),Ze=function(){function r(e,t){this._code=e,this._errorValue=t}return Object.defineProperty(r.prototype,"code",{get:function(){return this._code},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"pbi.error",{get:function(){return{code:this._code,details:[{code:"ModelingServiceError_Reason",detail:{type:1,value:this._errorValue}}],parameters:[]}},enumerable:!1,configurable:!0}),r}();function nt(r,e,t){return new Promise(function(n,o){(0,J.D)(e.executeDataQueries({queries:r})).pipe((0,fe.U)(function(a){return a}),(0,se.K)(function(a){throw t})).subscribe(function(a){return n(a)},function(a){return o(a)})})}function dt(r,e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,e];case 1:return t=n.sent(),[2,Ce(r,t)]}})})}var Je=function(r){function e(){return r.call(this)||this}return(0,y.ZT)(e,r),e}(Error),qe=E(96608),We=function(){function r(e,t){this.telemetryService=e,this.dataQueriesExecutionService=t,this.cache=new Map}return r.prototype.ngOnDestroy=function(){this.cache.clear()},r.prototype.setDataQueryCache=function(e,t){this.checkDataQueryDefined(e),this.checkDataQueryResponseDefined(t);var n=this.getCacheKey(e);this.cache.set(n,t)},r.prototype.isDataQueryInCache=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);return this.cache.has(t)},r.prototype.getDataQueryRequest=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);if(!this.isDataQueryInCache(e))throw new Je;return this.cache.get(t)},r.prototype.removeCache=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);return this.cache.delete(t)},r.prototype.tryToConstructDataQueriesRequestIfMissInCache=function(e,t,n){void 0===n&&(n=function(le){return le});for(var o=[],a=0,c=e;a<c.length;a++){var S=!0;this.isDataQueryInCache(g=c[a])||(o.push(g),S=!1),this.telemetryService.logEvent(L.g4,{isCacheHit:S,cacheKey:JSON.stringify(g)})}if(!_.isEmpty(o))for(var x=nt(n(o),this.dataQueriesExecutionService,t),F=0,G=o;F<G.length;F++){var g;this.setDataQueryCache(g=G[F],x)}},r.prototype.getCacheKey=function(e){return JSON.stringify(e)},r.prototype.checkDataQueryDefined=function(e){if(!e)throw new Error("dataQuery is not defined")},r.prototype.checkDataQueryResponseDefined=function(e){if(!e)throw new Error("dataQueryResponse is not defined")},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(qe.y0),i.\u0275\u0275inject(v))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),ht=function(){function r(e,t,n,o,a,c,g,S){this.modelAuthoring=e,this.dataModelService=t,this.featureSwitchService=n,this.dialogService=o,this.localizationService=a,this.executeDataQueriesRequestCacheService=c,this.dataQueriesExecutionService=g,this.telemetryService=S}return r.prototype.setSortByColumn=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return e&&0!==e.length?[4,this.setSortByColumn_internal(e)]:[2];case 1:return t.sent(),[2]}})})},r.prototype.setSortByColumn_internal=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c,g,S,x,G,le;return(0,y.Jh)(this,function(ue){switch(ue.label){case 0:for(t=this.dataModelService.getDataModel(),n=[],o=[],a=function(Be){g=Oe.G.createObject(Be.modelObject),q.fF.assert(function(){return 2===g.getParts().length},"Should have 2 parts in model object");var De=(0,ie.Xt)(t,g.getTopLevelPart().name);if(Be.sortByProperty){var Xe=De.columns.find(function(at){return at.name===Be.sortByProperty});if(q.fF.assert(function(){return!!Xe},"sortByColumn is invalid or not found on the table."),(0,ie.ef)(Xe))return c.showErrorDialog(c.localizationService.format("SortByAnotherColumnInvalidColumnErrorMessage",g.getSecondLevelPart().name,Be.sortByProperty)),{value:void 0};var ot=ge.X6.getColumnUrn(De.name,Xe.name,Xe.schemaName);o.push({canSortByColumn:{column:g.toString(),sortByColumn:ot,tablePartitionMode:(0,ie.iJ)(De)}})}n.push({sortByAnotherColumn:Be})},c=this,S=0,x=e;S<x.length;S++)if("object"==typeof(G=a(x[S])))return[2,G.value];ue.label=1;case 1:return ue.trys.push([1,3,,4]),[4,this.runDataQueryValidation(o)];case 2:return ue.sent()?[3,4]:[2];case 3:if((le=ue.sent())instanceof Ze&&"ExecuteDataQueriesFailed"===le.code)return this.showErrorDialog(this.localizationService.get("DateTableDialog_GenericErrorMessage")),[2];throw le;case 4:return[4,this.modelAuthoring.apply({changes:n})];case 5:return ue.sent(),[2]}})})},r.prototype.showErrorDialog=function(e){ve.Z.buildCancelDialog(this.localizationService.get("SortByAnotherColumnErrorTitle"),e,"setSortByColumnDialog",this.dialogService,this.localizationService)},r.prototype.runDataQueryValidation=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a,c,g,S,x,F,ae,le,ue=this;return(0,y.Jh)(this,function(Te){switch(Te.label){case 0:if(!e||_.isEmpty(e))return[2,!0];t=this.telemetryService.startEvent(L.TM,{}),n=e.filter(function(Be){return!function(r,e){return!r&&"DirectLake"===e}(ue.featureSwitchService.allowDirectLakeDataValidation,Be.canSortByColumn.tablePartitionMode)}),o=n.filter(function(Be){return!ue.executeDataQueriesRequestCacheService.isDataQueryInCache(Be)}),_.isEmpty(o)||(a=nt(o,this.dataQueriesExecutionService,new Ze("ExecuteDataQueriesFailed",this.localizationService.format("SortByColumnValidationExecuteDataQueriesFailed"))),o.forEach(function(Be){return ue.executeDataQueriesRequestCacheService.setDataQueryCache(Be,a)})),c=!0,S=0,x=n,Te.label=1;case 1:return S<x.length?[4,this.getDataQueryResult(F=x[S])]:[3,4];case 2:if(!Te.sent().isValid)return c=!1,ae=Oe.G.createObject((g=F).canSortByColumn.column),le=Oe.G.createObject(g.canSortByColumn.sortByColumn),this.showErrorDialog(this.localizationService.format("SortByAnotherColumnMoreThanOneValueErrorMessage",ae.getSecondLevelPart().name,le.getSecondLevelPart().name)),[3,4];Te.label=3;case 3:return S++,[3,1];case 4:return g&&(t.event.info.errors=JSON.stringify(g)),t.resolve(),[2,c]}})})},r.prototype.getDataQueryResult=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache(e))throw new Error("data query should be found from cache");if(!e.canSortByColumn)throw new Error("Expect canSortByColumn to be present on the data query");return t=this.executeDataQueriesRequestCacheService.getDataQueryRequest(e),[4,dt(e,t)];case 1:if(!(n=o.sent()).hasOwnProperty("isValid"))throw new Error("Expect isValid defined in canSortByColumnResult");return[2,n]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(U.h),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(We),i.\u0275\u0275inject(v),i.\u0275\u0275inject(H.y0))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),mt=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.updateDefaultLabel=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return t=this.dataModelService.getDataModel(),n=Oe.G.createObject(e.modelObject),e&&this.canUpdateDefaultLabel(t,e,n)?[4,this.updateDefaultLabel_internal(t,e,n)]:[2];case 1:return o.sent(),[2]}})})},r.prototype.updateDefaultLabel_internal=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,a,c,g,S,x,F,le;return(0,y.Jh)(this,function(ue){switch(ue.label){case 0:return o=n.getTopLevelPart().name,a="Table"===n.getObjectType()?void 0:n.getSecondLevelPart().name,c=(0,ie.Xt)(e,o),g=(0,ie.Gz)(e,void 0,o,a),S=(0,ie.aP)(c),(0,ie.oQ)(c,c.description,S?.name,g?.name)?(x=void 0,F=void 0,g&&g.isHidden?(F=this.localizationService.get("HiddenDefaultLabelConfirmationTitle"),x=this.localizationService.format("HiddenDefaultLabelConfirmationMessage",c.name)):(F=this.localizationService.get("UnsetDefaultLabelConfirmationTitle"),x=this.localizationService.format("UnsetDefaultLabelConfirmationMessage",c.name)),[4,ve.Z.buildOKCancelDialog({title:F,message:x},"UpdateDefaultLabelConfirmationDialog",this.dialogService,this.localizationService)]):[3,3];case 1:return[4,ue.sent().afterClosed().toPromise()];case 2:if(1!==ue.sent())return[2];ue.label=3;case 3:return(le=[]).push({updateDefaultLabel:t}),[4,this.modelAuthoring.apply({changes:le})];case 4:return ue.sent(),[2]}})})},r.prototype.canUpdateDefaultLabel=function(e,t,n){q.fF.assert(function(){return 1===n.getParts().length&&"Table"===n.getObjectType()||2===n.getParts().length&&"Column"===n.getObjectType()},"objectType and modelObjectUri is not matched");var o=n.getTopLevelPart().name,a="Table"===n.getObjectType()?void 0:n.getSecondLevelPart().name,c=(0,ie.Xt)(e,o),g=(0,ie.Gz)(e,void 0,o,a),S=(0,ie.q1)(c);return c.capabilities.canEdit&&(!g||g.capabilities.canEdit)&&(!S||S.capabilities.canEdit)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Tt=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.updateKeyColumn=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return t=this.dataModelService.getDataModel(),e&&this.canUpdateKeyColumn(t,e)?[4,this.updateKeyColumn_internal(t,e)]:[2];case 1:return n.sent(),[2]}})})},r.prototype.updateKeyColumn_internal=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c,g,F;return(0,y.Jh)(this,function(G){switch(G.label){case 0:return n=(0,ie.Xt)(e,t.entity),o=(0,ie.Gz)(e,void 0,t.entity,t.property),a=(0,ie.q1)(n),(0,ie.oQ)(n,n.description,o?.name,a?.name)?(c=void 0,g=void 0,o&&o.isHidden?(g=this.localizationService.get("HiddenKeyColumnConfirmationTitle"),c=this.localizationService.format("HiddenKeyColumnConfirmationMessage",n.name)):(g=this.localizationService.get("UnsetKeyColumnConfirmationTitle"),c=this.localizationService.format("UnsetKeyColumnConfirmationMessage",n.name)),[4,ve.Z.buildOKCancelDialog({title:g,message:c},"UpdateKeyColumnConfirmationDialog",this.dialogService,this.localizationService)]):[3,3];case 1:return[4,G.sent().afterClosed().toPromise()];case 2:if(1!==G.sent())return[2];G.label=3;case 3:return(F=[]).push({updateKeyColumn:t}),[4,this.modelAuthoring.apply({changes:F})];case 4:return G.sent(),[2]}})})},r.prototype.canUpdateKeyColumn=function(e,t){var n=(0,ie.Xt)(e,t.entity),o=(0,ie.Gz)(e,void 0,t.entity,t.property),a=(0,ie.aP)(n);return n.capabilities.canEdit&&(!o||o.capabilities.canEdit)&&(!a||a.capabilities.canEdit)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ve=E(96898),lt=function(r){return r.MaxNumberOfGroups="MaxNumberOfGroups",r.MaxNumberOfItems="MaxNumberOfItems",r.NotInteger="NotInteger",r.OutOfRangeOrdinal="OutOfRangeOrdinal",r.OutOfRangePrecedence="OutOfRangePrecedence",r.PrecedenceNotUnique="PrecedenceNotUnique",r}({}),Ct=function(){function r(e,t,n,o,a){this.modelAuthoring=e,this.dataModelService=t,this.localizationService=n,this.dialogService=o,this.errorService=a}return r.prototype.createNewCalculationGroup=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,t,n,o,a,c,g,S,x;return(0,y.Jh)(this,function(F){switch(F.label){case 0:return e=[],t=this.dataModelService.getDataModel(),[4,this.checkAndApplyDiscourageImplicitMeasures(t.discourageImplicitMeasures,e)];case 1:if(!F.sent())return[2];if(this.addFeatureTagIfMissing(e),(n=this.getCalculationGroupInfo()).length)if((a=Math.max.apply(Math,n.map(function(G){return G.precedence})))<Ve.SX)o=a+1;else{if(!(n.length<=Ve.SX))return this.handleUserError(lt.MaxNumberOfGroups),[2];for(c=n.length-2,o=a-1;c>=0&&o!==n[c].precedence;)c--,o-=1}else o=Ve.UI;return g=D.cm.makeValidName(t,this.localizationService,"CalculationGroup",null,this.localizationService.get("CalculationGroup"),null),S={newCalculationGroup:{name:g,columnName:this.localizationService.get("CalculationGroupColumn"),ordinalColumnName:this.localizationService.get("Ordinal"),precedence:o}},x=this.createNewCalculationItemSchemaChange(g,Ve.Ow,this.localizationService.get("CalculationItem"),t.editableSchemaName),e.push(S,x),[4,this.modelAuthoring.apply({changes:e})];case 2:return F.sent(),[2]}})})},r.prototype.addNewCalculationItem=function(e){var t;return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c,g,S,x;return(0,y.Jh)(this,function(F){switch(F.label){case 0:return n=this.dataModelService.getDataModel(),o=null===(t=n.tables.find(function(G){return G.name===e}))||void 0===t?void 0:t.calculationGroup,q.fF.assert(function(){return!!o}),(c=o.calculationItems.map(function(G){return G.ordinal})).length?c.every(function(G){return G===Ve.Ow})?a=Ve.Ow:(g=Math.max.apply(Math,c),a=g<Ve.BT?g+1:g):a=Ve.Ow,this.addFeatureTagIfMissing(S=[]),x=D.cm.makeValidName(n,this.localizationService,"CalculationItem",e,this.localizationService.get("CalculationItem"),null),S.push(this.createNewCalculationItemSchemaChange(e,a,x,n.editableSchemaName)),[4,this.modelAuthoring.apply({changes:S})];case 1:return F.sent(),[2]}})})},r.prototype.handleEditPrecedenceFromReorder=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,g,S=this;return(0,y.Jh)(this,function(x){switch(x.label){case 0:return n=this.getCalculationGroupInfo(),q.fF.assert(function(){return e>=0&&e<n.length&&t>=0&&t<n.length}),o=n[e],e===t?[2]:(o.dirty=!0,e<t&&(n[t].precedence>(t<n.length-1?n[t+1].precedence+1:Ve.UI)?o.precedence=n[t].precedence-1:(o.precedence=n[t].precedence-.5,n.sort(Ve.zb),o.precedence=Math.round(n[t].precedence+.5),this.resolvePrecedenceConflict(n,t-1,-1))),e>t&&(n[t].precedence<(t>0?n[t-1].precedence-1:Ve.SX)?o.precedence=n[t].precedence+1:(o.precedence=n[t].precedence+.5,n.sort(Ve.zb),o.precedence=Math.round(n[t].precedence-.5),this.resolvePrecedenceConflict(n,t+1,1))),g=n.filter(function(F){return F.dirty}).map(function(F){return S.createSetPrecedenceSchemaChange(F.name,F.precedence)}),this.addFeatureTagIfMissing(g),[4,this.modelAuthoring.apply({changes:g})]);case 1:return x.sent(),[2]}})})},r.prototype.handleEditPrecedenceDirectly=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return n=this.getCalculationGroupInfo(),(o=n.find(function(g){return g.name===e})).precedence===t?[2]:n.some(function(g){return g.precedence===t})?(this.handleUserError(lt.PrecedenceNotUnique),[2]):t<Ve.UI||t>Ve.SX?(this.handleUserError(lt.OutOfRangePrecedence),[2]):Number.isSafeInteger(t)?(a=[this.createSetPrecedenceSchemaChange(o.name,t)],this.addFeatureTagIfMissing(a),[4,this.modelAuthoring.apply({changes:a})]):(this.handleUserError(lt.NotInteger),[2]);case 1:return c.sent(),[2]}})})},r.prototype.handleEditOrdinalFromReorder=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,a,c,g,S=this;return(0,y.Jh)(this,function(x){switch(x.label){case 0:return o=this.getCalculationItems(e),q.fF.assert(function(){return null!==o&&t>=0&&t<o.length&&n>=0&&n<o.length}),t===n?[2]:(_.forEach(o,function(F,G){F.ordinal!==G&&(F.ordinal=G,F.dirty=!0)}),a=o[t],c=t>n?_.concat(_.slice(o,0,n),a,_.slice(o,n,t),_.slice(o,t+1)):_.concat(_.slice(o,0,t),_.slice(o,t+1,n+1),a,_.slice(o,n+1)),g=[],_.forEach(c,function(F,G){(F.dirty||F.ordinal!==G)&&g.push(S.createSetOrdinalSchemaChange(e,F.name,G))}),this.addFeatureTagIfMissing(g),[4,this.modelAuthoring.apply({changes:g})]);case 1:return x.sent(),[2]}})})},r.prototype.handleResetAllOrdinalsToDefault=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o=this;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return t=this.getCalculationItems(e),n=t.filter(function(c){return c.ordinal!==Ve.Ow}).map(function(c){return o.createSetOrdinalSchemaChange(e,c.name,Ve.Ow)}),this.addFeatureTagIfMissing(n),[4,this.modelAuthoring.apply({changes:n})];case 1:return a.sent(),[2]}})})},r.prototype.findCalculationGroupIndex=function(e){var t=this.getCalculationGroupInfo();return _.findIndex(t,function(n){return n.name===e})},r.prototype.findCalculationItemIndex=function(e,t){var n=this.getCalculationItems(e);return _.findIndex(n,function(o){return o.name===t})},r.prototype.supportCalculationGroupAuthoring=function(){return this.dataModelService.getDataModel().capabilities.supportCalculationGroupAuthoring},r.prototype.resolvePrecedenceConflict=function(e,t,n){for(var o=function(S){if(e[S].precedence!==e[S-n].precedence)return"break";e[S].precedence-=n,e[S].dirty=!0,q.fF.assert(function(){return e[S].precedence>=Ve.UI&&e[S].precedence<=Ve.SX})},a=t;a>=0&&a<e.length&&"break"!==o(a);a+=n);},r.prototype.checkAndApplyDiscourageImplicitMeasures=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(a){switch(a.label){case 0:return e?[3,3]:[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("CalculationGroupEnableDiscourageImplicitMeasuresDialogTitle"),message:this.localizationService.get("CalculationGroupEnableDiscourageImplicitMeasuresDialogMessage")},"CalculationGroupEnableDiscourageImplicitMeasuresDialog",this.dialogService,this.localizationService)];case 1:return[4,a.sent().afterClosed().toPromise()];case 2:return 1===a.sent()?(t.push(this.createSetDiscourageImplicitMeasuresSchemaChange(!0)),[2,!0]):[2,!1];case 3:return[2,!0]}})})},r.prototype.resolveOrdinalConflict=function(e,t,n){for(var o=function(S){if(e[S].ordinal!==e[S-n].ordinal)return"break";e[S].ordinal+=n,e[S].dirty=!0,q.fF.assert(function(){return e[S].ordinal>=Ve.Ow&&e[S].ordinal<=Ve.BT})},a=t;a>=0&&a<e.length&&"break"!==o(a);a+=n);},r.prototype.getCalculationGroupInfo=function(){var t=this.dataModelService.getDataModel().tables.filter(function(n){return null!==n.calculationGroup}).map(function(n){return{precedence:n.calculationGroup.precedence,name:n.name,dirty:!1}});return t.sort(Ve.zb),t},r.prototype.getCalculationItems=function(e){var t,n,a=null===(n=null===(t=this.dataModelService.getDataModel().tables.find(function(c){return c.name===e}))||void 0===t?void 0:t.calculationGroup)||void 0===n?void 0:n.calculationItems;return a.sort(Ve.hJ),a},r.prototype.createNewCalculationItemSchemaChange=function(e,t,n,o){return{newCalculationItem:{name:n,ordinal:t,expression:Ve.tU,modelObject:ge.X6.getTableUrn(e,o)}}},r.prototype.createSetPrecedenceSchemaChange=function(e,t){var n=this.dataModelService.getDataModel().editableSchemaName;return{setCalculationGroupPrecedence:{precedence:t,modelObject:ge.X6.getTableUrn(e,n)}}},r.prototype.createSetOrdinalSchemaChange=function(e,t,n){var o=this.dataModelService.getDataModel().editableSchemaName;return{setCalculationItemOrdinal:{ordinal:n,modelObject:ge.X6.getCalculationItemUrn(e,t,o)}}},r.prototype.createSetDiscourageImplicitMeasuresSchemaChange=function(e){return{setDiscourageImplicitMeasures:{discourageImplicitMeasures:e}}},r.prototype.handleUserError=function(e){this.errorService.error(this.getErrorMessageDescription(e),"modelingError",{title:this.getErrorMessageTitle(e),source:"User",hideGetHelpLink:!0,showAdditionalErrorInfo:!1})},r.prototype.getErrorMessageTitle=function(e){return this.localizationService.get("".concat(this.getErrorMessageKey(e),"_Title"))},r.prototype.getErrorMessageDescription=function(e){return e===lt.OutOfRangePrecedence?this.localizationService.format(this.getErrorMessageKey(e),Ve.UI):e===lt.OutOfRangeOrdinal?this.localizationService.format(this.getErrorMessageKey(e),Ve.Ow):this.localizationService.get(this.getErrorMessageKey(e))},r.prototype.getErrorMessageKey=function(e){switch(e){case lt.MaxNumberOfGroups:case lt.MaxNumberOfItems:case lt.NotInteger:case lt.OutOfRangeOrdinal:case lt.OutOfRangePrecedence:case lt.PrecedenceNotUnique:return"CalculationGroupAuthoringService_".concat(e,"Error");default:q.fF.assertNever(e)}},r.prototype.addFeatureTagIfMissing=function(e){var t=this.dataModelService.getDataModel();(0,ie.vQ)(t,ie.CL,"CalcGroup")||e.push({SetUsedFeatureModelTraitSchemaChange:{featureTagsToAdd:["CalcGroup"]}})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(he.T))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ot=function(){function r(e,t){this.modelAuthoring=e,this.deleteModelItemService=t}return r.prototype.createCalendar=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(o){switch(o.label){case 0:return[4,this.modelAuthoring.apply({changes:[{createCalendar:{modelObject:e,calendarName:t.name,timeUnitColumnAssociations:t.associations}}]})];case 1:return o.sent(),[2]}})})},r.prototype.editCalendar=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){var a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return a=[],t&&a.push({propertyRename:{schema:o,entity:e,before:t.oldName,after:t.name,objectType:"Calendar"}}),n&&a.push({updateCalendar:{modelObject:ge.X6.getCalendarUrn(e,n.name,o),timeUnitColumnAssociations:n.associations}}),[4,this.modelAuthoring.apply({changes:a})];case 1:return c.sent(),[2]}})})},r.prototype.deleteCalendar=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(o){switch(o.label){case 0:return[4,this.deleteModelItemService.deleteModelItem([{schema:n,tableName:e,itemName:t,objectType:"Calendar"}],!1)];case 1:return o.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(d.c))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Rt=function(){function r(e,t){this.dialogService=e,this.localizationService=t}return r.prototype.showCalendarOptions=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){var a,c;return(0,y.Jh)(this,function(g){switch(g.label){case 0:return a={tableName:e,entryPoint:t,initialState:n,editingCalendarName:o},c={title:this.localizationService.format("CalendarOptions_ForTable",e),input:a,dontCloseOnAction:!0,dontCloseOnDefaultActions:!0,hideClose:!0},[4,this.dialogService.showTemplateDialog("CalendarOptionsComponent",c)];case 1:return g.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),It=function(){function r(e,t,n,o,a){this.modelAuthoring=e,this.dialogService=t,this.featureSwitchService=n,this.localizationService=o,this.dataModelService=a}return r.prototype.showOrEditDateTable=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return[4,this.showDateTableDialog(e,t??void 0,n)];case 1:return(o=a.sent())?[4,this.modelAuthoring.apply({changes:[{markAsDateTable:{schema:o.schema,tableName:o.tableName,columnName:o.dateColumnName,enabled:o.enabled}}]})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})},r.prototype.createAssistedDateTable=function(e){return void 0===e&&(e=null),(0,y.mG)(this,void 0,void 0,function(){var t,n,o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return t=this.generateNewAssistedDateTableName(),[4,this.showAuthorDateTableDialog({tableName:t,srcColumns:e?[ge.X6.getColumnUrn(e.table.name,e.name,e.table.schemaName)]:[],dateAttributes:[{dateAttribute:"Date",isHidden:!1,customName:this.localizationService.get("Date")},{dateAttribute:"Year",isHidden:!1,customName:this.localizationService.get("TimeUnit_Year")},{dateAttribute:"YearNumber",isHidden:!1,customName:this.localizationService.get("YearNumber")},{dateAttribute:"Quarter",isHidden:!1,customName:this.localizationService.get("CdsaAuthoring_Iframe_Quarter")},{dateAttribute:"Month",isHidden:!1,customName:this.localizationService.get("TimeUnit_Month")},{dateAttribute:"MonthNumber",isHidden:!1,customName:this.localizationService.get("MonthNumber")}],startMonthOfYear:1,hideSourceColumn:!0,hideDefaultCalendar:!0})];case 1:return(n=a.sent())?(o=n.srcColumns.map(function(c,g){return{caption:c.columnName,field:c.columnName,ordinal:g,table:c.tableName}}),[4,this.modelAuthoring.apply({changes:[{createAssistedDateTable:{dateTableDefinition:{dateAttributes:n.dateAttributes,dateFieldInfo:o,hideDefaultCalendar:n.hideDefaultCalendar,hideSourceColumn:n.hideSourceColumn,startMonthOfYear:n.startMonthOfYear},modelObject:ge.X6.getTableUrn(t)}}]})]):[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})},r.prototype.editAssistedDateTable=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o;return(0,y.Jh)(this,function(a){switch(a.label){case 0:return[4,this.getExistingDateTableMetadata(e)];case 1:return t=a.sent(),[4,this.showAuthorDateTableDialog(t)];case 2:return(n=a.sent())?(o=n.srcColumns.map(function(c,g){return{caption:c.columnName,field:c.columnName,ordinal:g,table:c.tableName}}),[4,this.modelAuthoring.apply({changes:[{editAssistedDateTable:{dateTableDefinition:{dateAttributes:n.dateAttributes,dateFieldInfo:o,hideDefaultCalendar:n.hideDefaultCalendar,hideSourceColumn:n.hideSourceColumn,startMonthOfYear:n.startMonthOfYear},modelObject:ge.X6.getTableUrn(e.name,e.schemaName)}}]})]):[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}})})},r.prototype.getExistingDateTableMetadata=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){return[2,Promise.resolve(null)]})})},r.prototype.generateNewAssistedDateTableName=function(){var e=new Set(this.dataModelService.getDataModel().tables.map(function(o){return o.name})),t=this.localizationService.get("Date_Table");if(!e.has(t))return t;var n=1;for(t=this.localizationService.format("NamePattern_Bracket",this.localizationService.get("Date_Table"),n);e.has(t);)n++,t=this.localizationService.format("NamePattern_Bracket",this.localizationService.get("Date_Table"),n);return t},r.prototype.showAuthorDateTableDialog=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.dialogService.showTemplateDialog("AuthorDateTableComponent",{title:this.localizationService.format("Customize_Bracket",e.tableName),okButtonText:this.localizationService.get("SaveAndClose_ButtonText"),input:e,hideCancelButton:!0},{width:"639px",height:"712px"})];case 1:return[2,n.sent().afterClosed().toPromise()]}})})},r.prototype.showDateTableDialog=function(e,t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,c,g;return(0,y.Jh)(this,function(S){switch(S.label){case 0:return o={entityName:e,schemaName:t,entryPoint:n},g=this.localizationService.get((c=this.featureSwitchService.featureSwitches.customCalendars)?"CalendarOptions_MarkAsADateTable_NotRecommended":"MarkAsADateTable"),o.description=c?void 0:this.localizationService.get("DateTableDialog_MarkAsDateTableDescription"),o.warning=this.localizationService.get(c?"CalendarOptions_MarkAsADateTable_Warning":"DateTableDialog_MarkAsDateTableWarning"),[4,this.dialogService.showTemplateDialog("DateTableComponent",{title:g,okButtonText:this.localizationService.get("PBI_Button_Label_Save"),input:o})];case 1:return[2,S.sent().afterClosed().toPromise()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(je.S),i.\u0275\u0275inject(re.x),i.\u0275\u0275inject(I.vZ),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(xe.n))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),kt=function(){function r(e){this.telemetryService=e,this.telemetryService.initialize()}return r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(s.L))},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[d.c,Tt,mt,T,P,ht,A,Se,s.L,w,Ae.B,Ct,Ot,Rt,It,We,{provide:m,useClass:l}],imports:[K]}),r}(),Dt=new i.InjectionToken("AccessibilityService"),Le=E(68816),Pt=function(){function r(){var e=this;this.modelToProviderConfig=new Map,Le.editor.onWillDisposeModel(function(t){return e.disposeModel(t)})}return r.getInstance=function(){return this._instance||(this._instance=new r)},r.prototype.getProviderConfig=function(e){return this.modelToProviderConfig.get(e)},r.prototype.createMonacoModelWithConfig=function(e,t,n){var o,a,c=Le.editor.createModel(e,t);return this.modelToProviderConfig.set(c.id,n),void 0!==(null===(o=n.modelOptions)||void 0===o?void 0:o.endOfLineStyle)&&c.setEOL(n.modelOptions.endOfLineStyle),void 0!==(null===(a=n.modelOptions)||void 0===a?void 0:a.textModelUpdateOptions)&&c.updateOptions(n.modelOptions.textModelUpdateOptions),c},r.prototype.disposeModel=function(e){this.modelToProviderConfig.delete(e.id)},r}(),$e=E(13500),zt=E(19194),bt=E(33567),_e=E(17819),Kt=E(47164),h=function(r){function e(t){var n=r.call(this,t)||this;return n.message=t,n.name="DaxConfigError",n}return(0,y.ZT)(e,r),e}(Error),f=function(r){function e(t){var n=r.call(this,t.message)||this;return n.originalError=t,Object.setPrototypeOf(n,e.prototype),n.name="MonacoError",n}return(0,y.ZT)(e,r),e}(Error),X=E(85386),be=function(r){return r[r.Column=0]="Column",r[r.Measure=1]="Measure",r[r.Table=2]="Table",r[r.Role=3]="Role",r[r.VisualCalculation=4]="VisualCalculation",r[r.CalculationItem=5]="CalculationItem",r}({}),Fe=function(r){return r[r.Formula=0]="Formula",r[r.Expression=1]="Expression",r[r.Query=2]="Query",r}({}),ze=function(r){return r.ModelChange="ModelChange",r.CodeAction="CodeAction",r.CodeLens="CodeLens",r.Completions="Completions",r.Formatting="Formatting",r.Hover="Hover",r.SemanticTokens="SemanticTokens",r.SignatureHelp="SignatureHelp",r.Validation="Validation",r.Unknown="Unknown",r}({}),ut=function(){function r(e){this.daxParserManager=e,this.signatureHelpTriggerCharacters=["(",","],this.signatureHelpRetriggerCharacters=[","]}return r.prototype.provideSignatureHelp=function(e,t,n,o){var a=this.daxParserManager.getParseResult(e,e.getOffsetAt(t),void 0,!0,ze.SignatureHelp);if(!a)return Promise.resolve(void 0);var c=a.parseResult&&a.parseResult.prototypeFunctionBase;if(!c)return Promise.resolve(void 0);var g=[],S={currentParameter:-1};if(a.parseResult.prototypeParamContexts.length)for(var x=0,F=a.parseResult.prototypeParamContexts;x<F.length;x++)g.push(this.buildSignature(c,F[x],S));else g.push(this.buildSignature(c,void 0,S));return Promise.resolve({value:{signatures:g,activeParameter:S.currentParameter,activeSignature:0},dispose:function(){}})},r.prototype.buildSignature=function(e,t,n){var o={documentation:e.description,label:void 0,parameters:[],activeParameter:void 0};if(n.currentParameter=-1,!t)return o.label=e.getDefaultPrototype(),o;var G,c="",g=e.getPrototype(t);c+=g[0].text+g[0].separator;for(var S=1;S<g.length-1;S++){var x=g[S];o.parameters.push({documentation:"",label:(G=x.text,G.endsWith(_e.w_.listSeparator)&&(G=G.substr(0,G.length-_e.w_.listSeparator.length)),G)}),c+=x.text,c+=x.separator,x.bold&&(n.currentParameter=S-1)}return o.label="".concat(c+=g[g.length-1].text+g[g.length-1].separator),o.activeParameter=n.currentParameter,o},r}(),wt=E(35510),pt=function(){function r(){}return r.configureModel=function(e,t,n,o,a){this.config=new lr(e,(0,_e.yD)(t,a),n,o),this.newConfig$.next()},r.newConfigNotification=function(){return this.newConfig$.asObservable()},r.getConfig=function(){return r.config},r.getModel=function(){return r.config&&r.config.daxModel},r.getMonacoModel=function(){return r.config&&r.config.wireModel},r.getDataSourceInfo=function(){return r.config&&r.config.dataSourceInfo},r.getContext=function(){return r.config&&r.config.daxContext},r.config=void 0,r.newConfig$=new wt.X(void 0),r}(),lr=function(){function r(e,t,n,o){this.wireModel=e,this.dataSourceInfo=t,this.calculation=n,this.restrictedDirectQuery=o}return Object.defineProperty(r.prototype,"syntaxType",{get:function(){var t,n;return null!==(n=null===(t=this.calculation)||void 0===t?void 0:t.syntaxType)&&void 0!==n?n:Fe.Formula},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"daxModel",{get:function(){return this._daxModel||(this._daxModel=(0,_e.o4)(this.wireModel)),this._daxModel},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"daxContext",{get:function(){if(!this._daxContext){var t={matchObjects:null};_e.MQ.populateAll(this.daxModel,this.dataSourceInfo,t);var n=this.calculation;if(!n||n.syntaxType===Fe.Query)return this._daxContext=new _e.hK(t.matchObjects),this._daxContext;var o=_.find(this.daxModel.tables,function(g){return g.name===n.tableName});switch(n.type){case be.Column:var a=_.find(o.columns,function(g){return g.name===n.calculationName});this._daxContext=(0,_e.Gz)(this.daxModel,this.dataSourceInfo,a,this.restrictedDirectQuery);break;case be.Measure:var c=_.find(o.measures,function(g){return g.name===n.calculationName});this._daxContext=n.syntaxType===Fe.Expression?(0,_e.K2)(this.daxModel,this.dataSourceInfo,c,this.restrictedDirectQuery):(0,_e.kD)(this.daxModel,this.dataSourceInfo,c,this.restrictedDirectQuery);break;case be.Table:this._daxContext=(0,_e.ub)(this.daxModel,this.dataSourceInfo,o);break;case be.Role:this._daxContext=(0,_e.Sm)(this.daxModel,this.dataSourceInfo,o);break;default:this._daxContext=new _e.hK(t.matchObjects)}}return this._daxContext},enumerable:!1,configurable:!0}),r.prototype.onWireModelUpdated=function(){this._daxModel=null,this._daxContext=null},r}(),Ut=E(6855),ur=function(){function r(e){this.daxParserManager=e,this.triggerCharacters=[",","[","(","]","'"],function(){var r=Ut.n.prototype.triggerSuggest;Ut.n.prototype.triggerSuggest=function(e,t){return r.apply(this,[e,!0])}}()}return r.prototype.provideCompletionItems=function(e,t,n,o){if(""===e.getValue())return Promise.resolve(function(){var r,e=new Le.Range(1,1,1,1);return{suggestions:(null===(r=pt.getConfig())||void 0===r?void 0:r.syntaxType)===Fe.Query?[{label:"DEFINE",insertText:"DEFINE",range:e,kind:Le.languages.CompletionItemKind.Keyword},{label:"EVALUATE",insertText:"EVALUATE",range:e,kind:Le.languages.CompletionItemKind.Keyword}]:[]}}());var a=this.daxParserManager.getParseResult(e,e.getOffsetAt(t),5,void 0,ze.Completions);if(!a||!a.parseResult)return Promise.resolve(void 0);var c=a.parseResult,g=c.suggestions.map(function(S,x){var G,F=S.suggestionText;if(S.matchObject instanceof _e.Gs){var ae=S.matchObject;F+="(",(0===ae.signatures.length||1===ae.signatures.length&&0===ae.signatures[0].length)&&(F+=")"),G={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"}}S.complete||(G={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"});var le=function(r,e,t,n){var o=e.replaceEnd;if(r.matchObject instanceof _e.Gs){e.afterOParen===o+1&&(o=e.afterOParen);var a=r.matchObject;(0===a.signatures.length||1===a.signatures.length&&0===a.signatures[0].length)&&e.afterCParen===o+1&&(o=e.afterCParen)}var c=n.getPositionAt(e.replaceStart+t.formulaBreakup.formulaStart),g=n.getPositionAt(o+t.formulaBreakup.formulaStart);return{startLineNumber:c.lineNumber,startColumn:c.column,endLineNumber:g.lineNumber,endColumn:g.column}}(S,c,a,e);return{label:S.suggestionText,command:G,range:le,preselect:x===c.bestMatch,insertText:F,documentation:S.matchObject.description||"",kind:fr(S),filterText:e.getValueInRange(le)}});return Promise.resolve({suggestions:g})},r.prototype.resolveCompletionItem=function(e,t){return Promise.resolve(e)},r}();function fr(r){if(r.matchObject instanceof _e.Gs)return Le.languages.CompletionItemKind.Function;if(r.matchObject instanceof _e.Z0)return Le.languages.CompletionItemKind.Keyword;if(r.matchObject instanceof _e.S2)return Le.languages.CompletionItemKind.Class;if(r.matchObject instanceof _e.XN)return Le.languages.CompletionItemKind.Property;if(r.matchObject instanceof _e.Cf)return Le.languages.CompletionItemKind.Method;if(r.matchObject instanceof _e.it)return Le.languages.CompletionItemKind.Enum;if(r.matchObject instanceof _e.Df)return Le.languages.CompletionItemKind.Event;if(r.matchObject instanceof _e.cr){var e=r.matchObject;if("rows"===e.name.toLowerCase())return Le.languages.CompletionItemKind.Struct;if("columns"===e.name.toLowerCase())return Le.languages.CompletionItemKind.Interface;if("rows columns"===e.name.toLowerCase())return Le.languages.CompletionItemKind.Constructor;if("columns rows"===e.name.toLowerCase())return Le.languages.CompletionItemKind.Module}return Le.languages.CompletionItemKind.Folder}var Vt=E(11674),pr=E(40546),fn=E(79232),gr=E(98277),tn=E(58871),Ye=E(85616),mr=E(85786),dn=E(63513),vr=function(){function r(e){this.daxParserManager=e,this.maxCharactersInLine={},this.modelToEditorDictionary={},this.disposables=[],this.daxParser=new Vt.w_(Vt.Jt.MultipleQueries)}return r.prototype.initialize=function(){var e=this;this.disposables.push(Le.editor.onDidCreateEditor(function(t){var n,o=t.getId(),a=null===(n=t.getModel())||void 0===n?void 0:n.uri.toString();a&&(e.modelToEditorDictionary[a]&&e.modelToEditorDictionary[a]!==o&&(0,bt.sr)("The formatting provider currently doesn't support using the same model on multiple editors"),e.modelToEditorDictionary[a]=o),e.maxCharactersInLine[o]||(e.maxCharactersInLine[o]=200),e.disposables.push(t.onDidChangeModel(function(c){var g,S=null===(g=c.newModelUrl)||void 0===g?void 0:g.toString();S&&e.modelToEditorDictionary[S]&&e.modelToEditorDictionary[S]!==o&&(0,bt.sr)("The formatting provider currently doesn't support using the same model on multiple editors"),c.oldModelUrl&&(e.modelToEditorDictionary[c.oldModelUrl.toString()]=void 0),e.modelToEditorDictionary[S]=o})),e.disposables.push(t.onDidLayoutChange(function(c){e.maxCharactersInLine[o]=c.viewportColumn}))}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},r.prototype.provideDocumentFormattingEdits=function(e,t,n){var o,a,c,g=Pt.getInstance().getProviderConfig(e.id);if(null!==(o=g?.formatting)&&void 0!==o&&o.enabled){var S=null!==(c=null===(a=g.formatting)||void 0===a?void 0:a.formattingOptions)&&void 0!==c?c:(0,y.pi)((0,y.pi)({},t),{addSpaceBetweenFunctionArguments:!1,contextualLineBreaksAndIndentation:!1,functionAndKeywordCase:"uppercase",lineStyle:"editorWidth",maxCharactersInLine:this.maxCharactersInLine[this.modelToEditorDictionary[e.uri.toString()]],removeUnnecessaryRowParenthesis:!1,spaceBetweenFunctionNameAndParenthesis:!1});return this.provideDocumentFormattingEditsCore(e,S,n)}},r.prototype.formatDaxText=function(e,t,n,o){var a;if(!n||!n.isCancellationRequested){var c=this.daxParser.buildParseTree(e);if(!c.anyErrors){t=t??{tabSize:4,insertSpaces:!1,functionAndKeywordCase:"uppercase",lineStyle:"short",addSpaceBetweenFunctionArguments:!0,contextualLineBreaksAndIndentation:!0,removeUnnecessaryRowParenthesis:!0,spaceBetweenFunctionNameAndParenthesis:!1};var x=((null===(a=pt.getConfig())||void 0===a?void 0:a.syntaxType)===Fe.Formula?(0,_e.O5)(e):{errors:[],formula:void 0,formulaStart:0,name:null}).name,G=new yr(t).format(c.rootNode),ae=x?"".concat(x," ="):"";return _.isEmpty(ae)?G:o&&ae.length+G.length+1<=this.maxCharactersInLine[this.modelToEditorDictionary[o]]?"".concat(ae," ").concat(G):"".concat(ae,"\n").concat(G)}}},r.prototype.provideDocumentFormattingEditsCore=function(e,t,n){return pr.d.featureSwitches.useParseTreeFormatting?this.provideDocumentFormattingEditsUsingParseTree(e,t,n):this.provideDocumentFormattingEditsUsingExpressionTree(e,t,n)},r.prototype.provideDocumentFormattingEditsUsingParseTree=function(e,t,n){if(this.modelToEditorDictionary[e.uri.toString()]){var o=this.formatDaxText(e.getValue(),t,n,e.uri.toString());if(o)return[{text:o,range:e.getFullModelRange()}]}},r.prototype.provideDocumentFormattingEditsUsingExpressionTree=function(e,t,n){if(this.modelToEditorDictionary[e.uri.toString()]&&!n.isCancellationRequested){var o=this.daxParserManager.getParseResult(e,e.getValueLength(),void 0,!0,ze.Formatting);if(o&&o.formulaBreakup&&null!==o.parser.parseTree.rootNode&&!(o.parseResult.errors.length>0)){var a=o.formulaBreakup.name,g=gr.r.build(o.parser.parseTree.rootNode,127).accept(new Cr(t)),S=a?"".concat(a," ="):"",x="";x=_.isEmpty(S)?g:S.length+g.length+1<=this.maxCharactersInLine[this.modelToEditorDictionary[e.uri.toString()]]?"".concat(S," ").concat(g):"".concat(S,"\n").concat(g);var F=this.getPositionMetadataOfEachLeaf(o.parser._parseTree.leafPositions,e.getValue()),G=this.findCommentsFromLeaves(F);return 0===G.length||(x=this.addCommentsToText(x,G)),[{text:x,range:e.getFullModelRange()}]}}},r.prototype.getPositionMetadataOfEachLeaf=function(e,t){for(var n=[],o=0,a=e;o<a.length;o++){var c=a[o];if(60!==c.token.type){if(c.token.ignorable){n.push({leaf:c,instance:0});continue}for(var g=c.token.getString(),S=0,x=t.indexOf(g);-1!==x;){if(c.token.startPosition===x){n.push({leaf:c,instance:S});break}S++,x=t.indexOf(g,x+1)}}}return n},r.prototype.findCommentsFromLeaves=function(e){for(var t=[],n=0;n<e.length;n++)if((0,mr.C3)(e[n].leaf.token.type)){var a=e[n].leaf.token.getString(),c=this.getLeavesUntillTheNextNonIgnorableLeaf(e,n-1,"Decrement"),g=this.getLeavesUntillTheNextNonIgnorableLeaf(e,n+1,"Increment"),S=c.some(function(De){return De&&De.leaf.token.isComment}),x=g.some(function(De){return De&&De.leaf.token.isComment}),F=!this.isThereAnyTextBeforeTheNewLine(c,!0)&&(!this.isThereAnyTextBeforeTheNewLine(g,!1)||a.endsWith("\n")),G=this.getNumberOfNewLinesInLeaves(c),ae=this.getNumberOfNewLinesInLeaves(g)+(a.endsWith("\n")?1:0),le=0!==c.length&&!c[c.length-1].leaf.token.ignorable,ue=0!==g.length&&!g[g.length-1].leaf.token.ignorable,Te=!S&&!le,Be=!x&&!ue;t.push({text:a,type:F&&ue&&(ae<=G||Te)?"Above":F&&le&&(G<=ae||Be)?"Below":F||!G&&!Te||ae&&!x?F||G&&x||!ae&&!Be?"Between":"Behind":"Front",leavesBeforeComment:c,leavesAfterComment:g})}return t},r.prototype.getLeavesUntillTheNextNonIgnorableLeaf=function(e,t,n){for(var o=[];t>=0&&t<e.length&&e[t].leaf.token.ignorable;)o.push(e[t]),t="Increment"===n?t+1:t-1;return t>=0&&t<e.length&&o.push(e[t]),o},r.prototype.isThereAnyTextBeforeTheNewLine=function(e,t){void 0===t&&(t=!1);for(var n=0,o=e;n<o.length;n++){var a=o[n],c=t?a.leaf.token.getString().split("").reverse().join(""):a.leaf.token.getString(),g=c.search(/\S/),S=c.search(/\n/);if(-1!==g||-1!==S)return!(-1===g&&-1!==S||-1!==g&&-1!==S&&S<g)}return!1},r.prototype.getNumberOfNewLinesInLeaves=function(e){return e.reduce(function(t,n){return t+(n.leaf.token.getString().split("\n").length-1)},0)},r.prototype.addCommentsToText=function(e,t){for(var n,o=0,a=0,c=t;a<c.length;a++)e=(n=this.addCommentToText(e,c[a],o))[0],o=n[1];return e},r.prototype.addCommentToText=function(e,t,n){var o,a,c,g,S;void 0===n&&(n=0);var x=t.leavesBeforeComment[t.leavesBeforeComment.length-1],F=t.leavesAfterComment[t.leavesAfterComment.length-1],G=null!==(o=x?.leaf.token.getString().toLowerCase())&&void 0!==o?o:void 0,ae=null!==(a=F?.leaf.token.getString().toLowerCase())&&void 0!==a?a:void 0,le=this.getStartPositionsThatMatchTheSubstring(e.toLowerCase(),G),ue=this.getStartPositionsThatMatchTheSubstring(e.toLowerCase(),ae),Te=le[null!==(c=x?.instance)&&void 0!==c?c:-1],Be=ue[null!==(g=F?.instance)&&void 0!==g?g:-1],De=0;void 0!==Te&&(De=Te+(null!==(S=G?.length)&&void 0!==S?S:0)),void 0===Te&&void 0!==Be&&(De=Be-e.slice(0,Be).split("").reverse().join().search(/\S/)),void 0===Be&&(Be=e.slice(De).search(/\S/)+De);var ot=this.formatComment(e,t,n,Be,De,F),at=ot[0],gt=ot[1],xt=ot[2],ft=ot[3];return[e=e.slice(0,ft)+gt+at.text+xt+e.slice(ft),n=ft+t.text.length+gt.length+xt.length]},r.prototype.formatComment=function(e,t,n,o,a,c){var g="",S="",x=0;switch(t.type){case"Above":x=o,t.text.endsWith("\n")||(S="\n"),S+=(e.slice(0,x).match(/[ \t]*$/)||[""])[0];break;case"Below":x=a,n>=a&&(x=n),e.slice(0,x).endsWith("\n")||(g="\n");var F=e.slice(0,x).lastIndexOf("\n")+1;g+=(e.slice(F,x).match(/^[ \t]*/)||[""])[0],t.text.endsWith("\n")&&(t.text=t.text.slice(0,-1));break;case"Front":!e.slice(x=o).startsWith(" ")&&!t.text.endsWith("\n")&&(S=" ");break;case"Between":x=o;break;case"Behind":x=a,n>=a&&(x=n),e.slice(0,x).endsWith(" ")||(g=" "),t.text.endsWith("\n")&&e.slice(x,o).includes("\n")?t.text=t.text.slice(0,-1):!t.text.endsWith("\n")&&!e.slice(x,o).includes("\n")&&void 0!==c&&(t.text=t.text+"\n")}return[t,g,S,x]},r.prototype.getStartPositionsThatMatchTheSubstring=function(e,t){if(void 0===t)return[];for(var n=[],o=e.indexOf(t);-1!==o;)n.push(o),o=e.indexOf(t,o+1);return n},r}(),yr=function(){function r(e){var t=this;this.options=e,this.functionWithNoShortLineBreaks=["DATE"],this.functionWithLineFollowedByPairs=["SWITCH"],this.functionWithJustPairs=["ROW"],this.functionWithNameAndExpressionPairs=["SUMMARIZE","SUMMARIZECOLUMNS","ADDCOLUMNS","SELECTCOLUMNS"],this.identifersThatChangeCase=["true","false"],this.indentLevel=0,this.indentPadding="",this.addIndentation=function(){return _.repeat(t.indentPadding,t.indentLevel)},this.indentPadding=this.options.insertSpaces?_.repeat(" ",this.options.tabSize):"\t"}return r.prototype.format=function(e){var t=this.formatCore(e);return(t=t.replace(/(?<=\n)[ \t]+(?=\n)/g,"")).replace(/(\n?[\t ]*)+$/,"")},r.prototype.addSpacesBetweenArgsIfNone=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0;o<e.length;o++)e[o-1]&&!this.doesEndWithWhitespace(e[o-1])&&n.push(" "),n.push(e[o]);return n.join("")},r.prototype.doesEndWithWhitespace=function(e){return/\s$/.test(e)},r.prototype.formatCore=function(e,t){var n,o;void 0===t&&(t=!1);var a="";if(void 0===e)return a;if(a+=this.formatTrivia(null!==(n=e.leadingTrivia)&&void 0!==n?n:[],!0),e instanceof Ye.a$)a+=this.formatBinaryOperation(e);else if(e instanceof Ye.N4)a+=this.formatDefinitions(e);else if(e instanceof Ye.DU)a+=this.formatFunctionCall(e);else if(e instanceof Ye.TV&&e.parent instanceof Ye.DU)a+=this.formatIdentifier(e,!0);else if(e instanceof Ye.TV&&this.identifersThatChangeCase.includes(e.token.getString().toLowerCase()))a+=this.formatIdentifier(e,!0);else if(e instanceof Ye.TV)a+=this.formatIdentifier(e);else if(e instanceof Ye._N)a+=this.formatInOperation(e);else if(e instanceof Ye.ub)a+=this.formatKeyword(e);else if(e instanceof Ye.pZ)a+=this.formatMeasureExpression(e);else if(e instanceof Ye.rc)a+=this.formatOrderBy(e);else if(e instanceof Ye._7)a+=this.formatQueries(e);else if(e instanceof Ye.Vu)a+=this.formatQuery(e);else if(e instanceof Ye.ic)a+=this.formatStartAt(e);else if(e instanceof Ye.Lj)a+=this.formatSortClause(e);else if(e instanceof Ye.lg)a+=this.formatTableConstructor(e);else if(e instanceof Ye.tw)a+=this.formatTuple(e);else if(e instanceof Ye.Ti)a+=this.formatUnaryLogicalOperation(e);else if(e instanceof Ye.dl||e instanceof Ye.rI)a+=this.formatVariable(e);else if(e instanceof Ye.Cm)a+=this.formatVarStatementNode(e);else if(e instanceof tn.a9)a+=e.token.getString();else if(e instanceof Ye.q1&&e.children.length>1)for(var g=0,S=this.getAllDescendents(e.children[0]);g<S.length;g++)a+=this.formatCore(S[g],t);else if(e instanceof tn.sN)for(var F=0,G=e.children;F<G.length;F++)a+=this.formatCore(G[F],t);return a+=this.formatTrivia(null!==(o=e.trailingTrivia)&&void 0!==o?o:[],!1),t?a.replace(/(\n[\t ]*$)/,""):a},r.prototype.formatBinaryOperation=function(e){return this.formatBinaryOperationCore(e.children)},r.prototype.formatBinaryOperationCore=function(e){var t;if(1===e.length)return this.formatCore(e[0]);var n=this.formatBinaryOperationCore(e.slice(0,e.length-2)),o=this.formatCore(e[e.length-2]),a=this.formatCore(e[e.length-1]);return"editorWidth"===this.options.lineStyle&&n.length+a.length+2+this.indentLevel*this.options.tabSize<=(null!==(t=this.options.maxCharactersInLine)&&void 0!==t?t:200)||"long"===this.options.lineStyle||"short"===this.options.lineStyle?this.addSpacesBetweenArgsIfNone(n,o,a):"".concat(n,"\n").concat(this.addIndentation()).concat(this.addSpacesBetweenArgsIfNone(o,a))},r.prototype.formatDefinitions=function(e){var t="";t+=this.formatCore(e.children[0],!0),this.options.contextualLineBreaksAndIndentation&&this.indentLevel++;for(var n=1;n<e.children.length;n++)t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n],!0));return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,t},r.prototype.formatFunctionCall=function(e){var t,n,o,a=this.formatCore(e.children[0]),c=null!==(n=null===(t=e.getChildFunctionName())||void 0===t?void 0:t.toUpperCase())&&void 0!==n?n:"",g=this.formatCore(e.children[1],!0),S=e.children[e.children.length-1]instanceof Ye.$Z?this.formatCore(e.children[e.children.length-1]):"",x=this.functionWithNoShortLineBreaks.includes(c),F=this.functionWithLineFollowedByPairs.includes(c),G=this.functionWithJustPairs.includes(c),ae=this.functionWithNameAndExpressionPairs.includes(c);x||this.indentLevel++;var le=void 0;e.children[2]instanceof Ye.fA&&(le=e.children[2]);var ue=this.options.spaceBetweenFunctionNameAndParenthesis?" ":"",Te=this.options.addSpaceBetweenFunctionArguments?" ":"";if("long"===this.options.lineStyle||"editorWidth"===this.options.lineStyle&&a.length+(le?le.fullSpan.length:0)+this.indentLevel*this.options.tabSize+g.length+S.length<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"short"===this.options.lineStyle&&le&&le.children.length<=1||!le||"short"===this.options.lineStyle&&x){x||this.indentLevel--;var De="";if(le)for(var Xe=0,ot=le.children;Xe<ot.length;Xe++)De+=this.formatCore(at=ot[Xe]),at instanceof Ye.ZH&&!this.doesEndWithWhitespace(De)&&(De+=Te);return ue=this.doesEndWithWhitespace(a)?"":ue,"".concat(a).concat(ue).concat(g).concat(De).concat(S)}var gt="";gt+="".concat(a).concat(ue).concat(g,"\n");for(var xt=!1,ft="\n",st=this.addIndentation(),yt=0,At=0;le&&At<le.children.length;At++){var at,en=this.formatCore(at=le.children[At],!0);if(at instanceof Ye.ZH)le.children[At-1]&&le.children[At-1]instanceof Ye.ZH&&(gt+=st),gt+="".concat(en).concat(ft);else{if(st=this.addIndentation(),ft="\n",F)st=0!==yt&&yt%2==0?"":this.addIndentation(),ft=yt%2!=0?" ":"\n";else if(G)st=yt%2==0?this.addIndentation():" ",ft=yt%2==0?"":"\n";else if(ae){var sr=this.getAllDescendents(at);1===sr.length&&sr[0]instanceof Ye.XN&&!xt?(ft=" ",xt=!0):xt&&(st="",xt=!1)}gt+="".concat(st).concat(en),yt++}}return gt+="\n",x||this.indentLevel--,gt+"".concat(this.addIndentation()).concat(S)},r.prototype.formatIdentifier=function(e,t){void 0===t&&(t=!1);var n=e.token.getIdentifier();return t&&(n="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase()),n},r.prototype.formatInOperation=function(e){return 1===e.children.length?this.formatCore(e.children[0]):this.addSpacesBetweenArgsIfNone(this.formatCore(e.children[0]),this.formatCore(e.children[1]),this.formatCore(e.children[2]))},r.prototype.formatKeyword=function(e){return"uppercase"===this.options.functionAndKeywordCase?e.keyword.toUpperCase():e.keyword.toLowerCase()},r.prototype.formatMeasureExpression=function(e){this.indentLevel++;var t=this.formatCore(e.children[0]),n=this.formatCore(e.children[1]),o=this.formatCore(e.children[2]),a=this.formatCore(e.children[3]);return this.indentLevel--,this.addSpacesBetweenArgsIfNone(t,n,o,a)},r.prototype.formatOrderBy=function(e){var t="",n="".concat(this.addIndentation()),o="\n".concat(this.addIndentation());this.indentLevel++;var a="\n".concat(this.addIndentation()),c=" ";this.options.contextualLineBreaksAndIndentation&&(a=e.children.length<=4?" ":a,c="\n".concat(this.addIndentation())),this.indentLevel--;var g=this.formatCore(e.children[0]),S=this.formatCore(e.children[1],!0);t+="".concat(n).concat(this.addSpacesBetweenArgsIfNone(g,S)).concat(a);for(var x=2;x<e.children.length&&!(e.children[x]instanceof Ye.ic);x++){var F=this.formatCore(e.children[x],!0);x%2!=0&&(F+=c),t+=F}return e.children[e.children.length-1]instanceof Ye.ic&&(t+="".concat(o).concat(this.formatCore(e.children[e.children.length-1]))),t},r.prototype.formatQueries=function(e){for(var t="",n=0;n<e.children.length;n++){var o=n!==e.children.length-1;t+=this.formatCore(e.children[n],o),t+=o?"\n":""}return t},r.prototype.formatQuery=function(e){var n,o,a,c,t=e.children,g=0;t[g]instanceof Ye.N4&&(n=t[g],g++),o=t[g],a=t[++g],t[++g]instanceof Ye.rc&&(c=t[g]);var S=n?"".concat(this.formatCore(n),"\n"):"",x=this.formatCore(o,!0),F=" ";this.options.contextualLineBreaksAndIndentation&&(this.indentLevel++,F="\n".concat(this.addIndentation()));var G=void 0!==c;x+="".concat(F).concat(this.formatCore(a,G));var ae=c?"\n".concat(this.formatCore(c)):"";return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,"".concat(S).concat(x).concat(ae)},r.prototype.formatSortClause=function(e){var t="";return t+=this.formatCore(e.children[0]),e.children[1]&&(/\n\s*$/.test(t)&&(this.indentLevel++,t+=this.addIndentation(),this.indentLevel--),t+=this.doesEndWithWhitespace(t)?"":" ",t+=this.formatCore(e.children[1])),t},r.prototype.formatStartAt=function(e){var t="",n=" ",o=" ",a=this.formatCore(e.children[0]),c=this.formatCore(e.children[1],!0);"short"===this.options.lineStyle&&e.children.length>3&&(this.indentLevel++,n="\n".concat(this.addIndentation()),o="\n".concat(this.addIndentation()),this.indentLevel--),t+="".concat(this.addSpacesBetweenArgsIfNone(a,c)).concat(n);for(var g=2;g<e.children.length;g++)t+=this.formatCore(e.children[g],!0),g%2!=0&&(t+=o);return t},r.prototype.formatTableConstructor=function(e){var t=[],n=" ",o="",a="",c=0,g=this.formatCore(e.children[c],!0);for(c++,"short"===this.options.lineStyle&&(this.indentLevel++,n="\n".concat(this.addIndentation()),o="\n".concat(this.addIndentation()));c<e.children.length&&!(e.children[c]instanceof Ye.yE);c++)t.push(this.formatCore(e.children[c],!0));"short"===this.options.lineStyle&&(this.indentLevel--,a=e.children[c]?"\n".concat(this.addIndentation()):"");for(var S=this.formatCore(e.children[c]),x="",F=0;F<t.length;F++)x+=F%2?"".concat(t[F]).concat(n):t[F];return"".concat(g).concat(o).concat(x).concat(a).concat(S)},r.prototype.formatTuple=function(e){var t=this.options.contextualLineBreaksAndIndentation?" ":"\n".concat(this.addIndentation()),n=0,o=this.formatCore(e.children[n]);n++;for(var a="";n<e.children.length&&!(e.children[n]instanceof Ye.$Z);n++)a+=this.formatCore(e.children[n],!0),a+=n%2?"":t;var c=this.formatCore(e.children[n]);return"".concat(o).concat(a).concat(c)},r.prototype.formatTrivia=function(e,t){for(var n="",o=0;o<e.length;o++)if(!e[o].isComment&&e[o].getString().includes("\n")){var a=e[o].getString().split("\n").length-1;n+="\n".repeat(a<0?0:a),n+=this.addIndentation()}else if(!e[o].isComment&&(e[o-1]&&e[o-1].isComment&&!e[o-1].getString().endsWith("\n")&&e[o+1]&&e[o+1].isComment||t&&e.length-1===o&&e[o-1]&&e[o-1].isComment&&!e[o-1].getString().endsWith("\n")||!t&&0===o&&e[o+1]&&e[o+1].isComment))n+=" ";else{if(!e[o].isComment)continue;if(e[o].isComment&&e[o].getString().endsWith("\n"))n+="".concat(e[o].getString()).concat(this.addIndentation());else if(e[o].isComment&&e[o].getString().includes("\n")){var c=e[o].getString().match(/\/\*([ ]*)(?=[^\s\n])/),S=" ".repeat(c&&c[1]?c[1].length+2:2);(n+=e[o].getString().replace(/(\n)[ \t]+/g,"\n").replace(/\n/g,"\n".concat(this.addIndentation()).concat(S))).endsWith("\n".concat(this.addIndentation()).concat(S,"*/"))&&(n=n.slice(0,n.length-S.length-2),n+="*/")}else n+=e[o].getString()}return n},r.prototype.formatUnaryLogicalOperation=function(e){for(var t="",n=0,o=e.children;n<o.length;n++){var a=o[n];a instanceof Ye.VW?(t+=this.formatCore(a),t+=this.doesEndWithWhitespace(t)?"":" "):t+=this.formatCore(a)}return t},r.prototype.formatVariable=function(e){var t=this.formatCore(e.children[0]),n=this.formatCore(e.children[1]),o=this.formatCore(e.children[2]),a=this.formatCore(e.children[3]);return this.addSpacesBetweenArgsIfNone(t,n,o,a)},r.prototype.formatVarStatementNode=function(e){for(var t="",n=0;n<e.children.length&&e.children[n]instanceof Ye.rI;n++)t+=0===n?"":this.addIndentation(),t+=this.formatCore(e.children[n],!0),e.children[n+1]instanceof Ye.rI&&(t+="\n");return t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n],!0)),n++,this.indentLevel++,t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n])),this.indentLevel--,t},r.prototype.getAllDescendents=function(e){if(e instanceof tn.sN){for(var t=[],n=0,o=e.children;n<o.length;n++)t.push.apply(t,this.getAllDescendents(o[n]));return t}return[e]},r}(),Cr=function(r){function e(t){var n=r.call(this,!1)||this;return n.options=t,n.functionWithNoShortLineBreaks=["DATE"],n.functionWithLineFollowedByPairs=["SWITCH","ADDCOLUMNS"],n.functionWithJustPairs=["ROW"],n.functionWithNameAndExpressionPairs=["SUMMARIZE","SUMMARIZECOLUMNS"],n.indentLevel=0,n.indentPadding="",n.addIndentation=function(){return _.repeat(n.indentPadding,n.indentLevel)},n.indentPadding=n.options.insertSpaces?_.repeat(" ",n.options.tabSize):"\t",n}return(0,y.ZT)(e,r),e.prototype.visitStartAt=function(t,n){var o=this,a="uppercase"===this.options.functionAndKeywordCase?"START AT":"start at",c=" ",g=", ";"short"===this.options.lineStyle&&t.values.length>1&&(this.indentLevel++,c="\n".concat(this.addIndentation()),g=",\n".concat(this.addIndentation()),this.indentLevel--);var S="";return t.values.length>0&&(S="".concat(this.addIndentation()).concat(a).concat(c),S+=t.values.map(function(x){return x.accept(o,n)}).join(g)),S},e.prototype.visitOrderBy=function(t,n){var o=this,a="uppercase"===this.options.functionAndKeywordCase?"ORDER BY":"order by";this.indentLevel++;var c="\n".concat(this.addIndentation()),g=", ";this.options.contextualLineBreaksAndIndentation&&(c=1===t.sortClauses.length?" ":c,g=",\n".concat(this.addIndentation())),this.indentLevel--;var S="";return t.sortClauses.length>0&&(S="".concat(this.addIndentation()).concat(a),S+=c+t.sortClauses.map(function(x){return x.accept(o,n)}).join(g),t.startAt&&(this.indentLevel++,S+="\n"+t.startAt.accept(this,n),this.indentLevel--)),S},e.prototype.visitMeasureExpression=function(t,n){return this.lowercaseKeywordsIfNeeded(r.prototype.visitMeasureExpression.call(this,t,n),"MEASURE")},e.prototype.visitMeasureReference=function(t){return"".concat(dn.LP.bracket(t.propertyName))},e.prototype.visitVariableDefinition=function(t,n){return this.lowercaseKeywordsIfNeeded(r.prototype.visitVariableDefinition.call(this,t,n),"VAR")},e.prototype.visitQuery=function(t,n){var o=this,c="uppercase"===this.options.functionAndKeywordCase?"EVALUATE":"evaluate",g="";t.definitions.length>0&&(g="".concat("uppercase"===this.options.functionAndKeywordCase?"DEFINE":"define","\n"),this.indentLevel++,g+=t.definitions.map(function(ae){return o.addIndentation()+ae.accept(o,n)}).join("\n"),this.indentLevel--,g+="\n",g+=this.options.contextualLineBreaksAndIndentation?"\n":"");var S=" ";this.options.contextualLineBreaksAndIndentation&&(this.indentLevel++,S="\n".concat(this.addIndentation()));var x="".concat(c).concat(S).concat(t.evaluate.accept(this,n)),F=t.orderBy?"\n".concat(t.orderBy.accept(this,n)):"",G="".concat(g).concat(x).concat(F);return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,G},e.prototype.visitNegation=function(t){return this.visitUnaryExpression(t,"-","")},e.prototype.visitNot=function(t){return this.visitUnaryExpression(t,"NOT"," ")},e.prototype.visitFunction=function(t){var o,n=this,a="uppercase"===this.options.functionAndKeywordCase?t.functionName.toUpperCase():t.functionName.toLowerCase(),c=this.functionWithNoShortLineBreaks.includes(a.toUpperCase()),g=this.functionWithLineFollowedByPairs.includes(a.toUpperCase()),S=this.functionWithJustPairs.includes(a.toUpperCase()),x=this.functionWithNameAndExpressionPairs.includes(a.toUpperCase()),F=this.options.spaceBetweenFunctionNameAndParenthesis?" ":"",G=this.options.addSpaceBetweenFunctionArguments?", ":",";c||this.indentLevel++;var ae=t.parameters.map(function(Be){return r.prototype.visitExpression.call(n,Be)}),le=a.length+_.sum(_.map(ae,function(Be){return Be.length}))+this.indentLevel*this.options.tabSize+2+_.size(ae)-1;if("long"===this.options.lineStyle||"editorWidth"===this.options.lineStyle&&le<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"short"===this.options.lineStyle&&ae.length<=1||"short"===this.options.lineStyle&&c)return c||this.indentLevel--,"".concat(a).concat(F,"(").concat(ae.join(G),")");var ue="";ue+="".concat(a).concat(F,"(\n");var Te=!1;return _.forEach(t.parameters,function(Be,De){var Xe=ae[De],ot=n.addIndentation(),at="\n";g?(ot=0!==De&&De%2==0?"":n.addIndentation(),at=De%2!=0?" ":"\n"):S?(ot=De%2==0?n.addIndentation():" ",at=De%2==0?"":"\n"):x&&(Be instanceof fn.w1&&!Te?(at=" ",Te=!0):Te&&(ot="",Te=!1)),ue+=ot,ue+=De===ae.length-1?"".concat(Xe,"\n"):"".concat(Xe,",").concat(at)}),c||this.indentLevel--,ue+=this.addIndentation(),ue+=")"},e.prototype.visitKeyword=function(t){return"uppercase"===this.options.functionAndKeywordCase?r.prototype.visitKeyword.call(this,t):r.prototype.visitKeyword.call(this,t).toLowerCase()},e.prototype.visitRowConstructor=function(t){var n=this,o=this.options.contextualLineBreaksAndIndentation?", ":",\n".concat(this.addIndentation()),a=t.items.map(function(c){return c.accept(n)}).join(o);return this.options.removeUnnecessaryRowParenthesis&&1===t.items.length?a:"(".concat(a,")")},e.prototype.visitTableConstructor=function(t){var n=this,o=", ",a="{",c="}";"short"===this.options.lineStyle&&(this.indentLevel++,o=",\n".concat(this.addIndentation()),a="{\n".concat(this.addIndentation()),this.indentLevel--,c="\n".concat(this.addIndentation(),"}"));var g=t.rows.map(function(S){return S.accept(n)}).join(o);return"".concat(a).concat(g).concat(c)},e.prototype.visitVarReturn=function(t){var n=this,o="uppercase"===this.options.functionAndKeywordCase?"VAR":"var",a="uppercase"===this.options.functionAndKeywordCase?"RETURN":"return",c="",g=t.variables.map(function(S){var x=S.name;return"".concat(o," ").concat(x," = ").concat(n.visitExpression(S.definition))}).join("\n".concat(this.addIndentation()));return c+="".concat(g,"\n").concat(this.addIndentation()).concat(a,"\n"),this.indentLevel++,c+=this.addIndentation(),c+=this.visitExpression(t.returnExpression),this.indentLevel--,c},e.prototype.visitBinaryExpression=function(t,n){var o,a="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase(),c=this.getExpressionType(t),g=this.getExpressionType(t.left),S=this.getExpressionType(t.right),x=!1,F=!1;0===g&&(x=!0),0===S&&(F=!0);var G=this.getPrecedence(c);if(x||13===g||G<this.getPrecedence(g)&&(x=!0),!F&&13!==S){var le=this.getPrecedence(S);(G<le||G===le&&!this.canCombine(c,S))&&(F=!0)}var ue=this.visitExpression(t.left,x),Te=this.visitExpression(t.right,F);return"editorWidth"===this.options.lineStyle&&ue.length+Te.length+2+this.indentLevel*this.options.tabSize<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"long"===this.options.lineStyle||"short"===this.options.lineStyle?"".concat(ue," ").concat(a," ").concat(Te):"".concat(ue,"\n").concat(this.addIndentation()).concat(a," ").concat(Te)},e.prototype.visitUnaryExpression=function(t,n,o){var a="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase(),c=this.getExpressionType(t),g=this.getExpressionType(t.expression),S=!1;0===g&&(S=!0);var x=this.getPrecedence(c);S||13===g||x<this.getPrecedence(g)&&(S=!0);var G=this.visitExpression(t.expression,S);return"".concat(a).concat(o).concat(G)},e.prototype.lowercaseKeywordsIfNeeded=function(t,n){return"lowercase"===this.options.functionAndKeywordCase&&(t=t.replace(n,n.toLowerCase())),t},e}(fn.UE),br=function(){function r(){}return r.triggerValidation=function(e,t){var n,o=t.getModel();if(o){var a=e.getParseResult(o,void 0,void 0,void 0,ze.Validation);if(!a)return;var c=this.getMarkerDataFromErrors(a.formulaBreakup.errors,o,0),g=this.getMarkerDataFromErrors((null===(n=a.parseResult)||void 0===n?void 0:n.errors)||[],o,a.formulaBreakup.formulaStart);this.decorationsByEditor[t.getId()]?this.decorationsByEditor[t.getId()].set((0,y.ev)((0,y.ev)([],c,!0),g,!0)):this.decorationsByEditor[t.getId()]=t.createDecorationsCollection((0,y.ev)((0,y.ev)([],c,!0),g,!0))}},r.getMarkerDataFromErrors=function(e,t,n){for(var o=[],a=0,c=e;a<c.length;a++){var g=c[a],S=t.getPositionAt(n+g.segment.startPosition),x=t.getPositionAt(n+g.segment.startPosition+g.segment.length);o.push({range:new Le.Range(S.lineNumber,S.column,x.lineNumber,x.column),options:{className:"squiggly-error",overviewRuler:{color:{id:"editorOverviewRuler.errorForeground"},position:Le.editor.OverviewRulerLane.Right},stickiness:Le.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,zIndex:30,hoverMessage:{value:g.message,isTrusted:!1}}})}return o},r.decorationsByEditor={},r}(),Er=function(){function r(){this.daxParserCache={},this.deleteKeyDown={},this.suspendCursorPositionChange={},this.forceRetokenizeEmitter=new Le.Emitter,this.disposables=[],this.subscriptions=[]}return Object.defineProperty(r.prototype,"forceRetokenize",{get:function(){return this.forceRetokenizeEmitter.event},enumerable:!1,configurable:!0}),r.prototype.clearCursorPositionChange=function(e){this.suspendCursorPositionChange[e]=!1},r.prototype.initialize=function(e){var t=this;this.subscriptions.push(pt.newConfigNotification().subscribe(function(){t.clearParserCache();for(var o=0,a=Le.editor.getEditors();o<a.length;o++)t.handleModelChange(a[o],"clearParserCache")})),this.disposables.push(Le.editor.onDidCreateEditor(function(n){var o;t.disposables.push(n.onDidChangeCursorPosition(function(a){o=a.position,t.suspendCursorPositionChange[n.getModel().id]||t.handleModelChange(n,a.source)})),t.listenForSpecialKeys(n),t.disposables.push(n.onDidChangeModelContent(function(a){var c;t.isModelRegistered(n.getModel().id)&&(_e.dH.featureSwitches.resetSuggestWidgetStateBeforeCompletion&&(null===(c=Ut.n.get(n))||void 0===c||c.cancelSuggestWidget()),!o||_.some(a.changes,function(g){return!Le.Range.containsPosition(g.range,o)})?(t.clearParserCache(n.getModel().id),t.handleModelChange(n,"reset"),t.forceRetokenizeEmitter.fire()):t.deleteKeyDown[n.getModel().id]&&t.handleModelChange(n,"delete"))})),t.disposables.push(n.onDidChangeModel(function(a){var c=a.newModelUrl;if(c){var g=Le.editor.getModel(c);g&&t.registerModel(g,e)}}))})),this.disposables.push(Le.editor.onDidCreateModel(function(n){t.registerModel(n,e)}))},r.prototype.dispose=function(){for(var e=0,t=this.subscriptions;e<t.length;e++)t[e].unsubscribe();for(var o=0,a=this.disposables;o<a.length;o++)a[o].dispose()},r.prototype.getParseResult=function(e,t,n,o,a){var c=e.getValue();if(this.isModelRegistered(e.id)){if(this.suspendCursorPositionChange[e.id])return o?this.daxParserCache[e.id].getParseResult():void 0;switch(this.daxParserCache[e.id].doesKeyMatch(c,n,t)){case vt.FullMatch:return this.daxParserCache[e.id].getParseResult();case vt.MouseCursorChange:case vt.DifferentCursorActivity:return this.parseModelExpression(e,t,n,a,!1);case vt.CacheCleared:return this.parseModelExpression(e,t||c.length,1,a);default:return this.daxParserCache[e.id].clear(),this.parseModelExpression(e,t||c.length,5,a)}}},r.prototype.handleModelChange=function(e,t){var n=e.getModel();if(n&&this.isModelRegistered(n.id)&&pt.getConfig()){var o=n.getOffsetAt(e.getPosition()),a=this.getNewCursorActivity(n,o);if(this.daxParserCache[n.id].doesKeyMatch(n.getValue(),a,o)!==vt.FullMatch){var c=1===a&&5===this.daxParserCache[n.id].parseResultKey.cursorActivity;this.parseModelExpression(n,o,a,ze.ModelChange),br.triggerValidation(this,e),5===a&&"snippet"!==t&&"modelChange"!==t&&e.trigger("HandleModelChangedChangeTriggeredSuggest","editor.action.triggerSuggest",{auto:!0}),c&&this.forceRetokenizeEmitter.fire()}}},r.prototype.parseModelExpression=function(e,t,n,o,a){void 0===o&&(o=ze.Unknown),void 0===a&&(a=!0);var c=performance.now(),g=e.getValue(),S=pt.getConfig();if(!S)throw new h("DaxMode resource config is not defined");var le,F=S.syntaxType===Fe.Formula?(0,_e.O5)(g):{errors:[],formula:g,formulaStart:0,name:null},G={result:null},ae=this.daxParserCache[e.id].getDaxParser();if(F.formula){var ue=this.daxParserCache[e.id].getParseResult();if(ue&&ue.formulaBreakup&&F.name!==ue.formulaBreakup.name&&F.formula===ue.formulaBreakup.formula)le={parseResult:ue.parseResult,formulaBreakup:F,parser:ae};else{if(!ae.tryParse(F.formula,pt.getContext(),G,void 0,n,t-F.formulaStart,t-F.formulaStart)&&(ae.clearParseState(),!ae.tryParse(F.formula,pt.getContext(),G,void 0,n,t-F.formulaStart,t-F.formulaStart)))return ue;le={parseResult:G.result,formulaBreakup:F,parser:ae}}}var Te=performance.now();return a&&this.daxParserCache[e.id].setParseResult(g,t,le,n),this.logParseEvent(e.id,c,Te,t,g,o),le},r.prototype.registerModel=function(e,t){var o,n=this;if(!this.isModelRegistered(e.id)&&e.getLanguageId()===t){var a=null===(o=pt.getConfig())||void 0===o?void 0:o.syntaxType;this.daxParserCache[e.id]=new Tr(a),this.disposables.push(e.onWillDispose(function(){n.disposeModel(e.id)}))}},r.prototype.isModelRegistered=function(e){return e in this.daxParserCache},r.prototype.disposeModel=function(e){this.daxParserCache=_.pickBy(this.daxParserCache,function(t,n){return n!==e}),this.deleteKeyDown=_.pickBy(this.deleteKeyDown,function(t,n){return n!==e}),this.suspendCursorPositionChange=_.pickBy(this.suspendCursorPositionChange,function(t,n){return n!==e})},r.prototype.clearParserCache=function(e){void 0===e&&(e=void 0);for(var n=0,o=e?[e]:Object.keys(this.daxParserCache);n<o.length;n++)this.daxParserCache[o[n]].clear()},r.prototype.listenForSpecialKeys=function(e){var t=this;this.disposables.push(e.onKeyDown(function(n){n.keyCode===Le.KeyCode.Delete?t.deleteKeyDown[e.getModel().id]=!0:(n.keyCode===Le.KeyCode.PageDown||n.keyCode===Le.KeyCode.PageUp||n.keyCode===Le.KeyCode.LeftArrow||n.keyCode===Le.KeyCode.RightArrow||n.keyCode===Le.KeyCode.UpArrow||n.keyCode===Le.KeyCode.DownArrow||n.ctrlKey&&(n.keyCode===Le.KeyCode.KeyZ||n.keyCode===Le.KeyCode.KeyY))&&(t.suspendCursorPositionChange[e.getModel().id]=!0)})),this.disposables.push(e.onMouseDown(function(n){t.suspendCursorPositionChange[e.getModel().id]=!0})),this.disposables.push(e.onKeyUp(function(n){n.keyCode===Le.KeyCode.Delete?t.deleteKeyDown[e.getModel().id]=!1:n.keyCode===Le.KeyCode.PageDown||n.keyCode===Le.KeyCode.PageUp||n.keyCode===Le.KeyCode.LeftArrow||n.keyCode===Le.KeyCode.RightArrow||n.keyCode===Le.KeyCode.UpArrow||n.keyCode===Le.KeyCode.DownArrow?(t.suspendCursorPositionChange[e.getModel().id]=!1,t.handleModelChange(e,"keyup")):n.ctrlKey&&(n.keyCode===Le.KeyCode.KeyZ||n.keyCode===Le.KeyCode.KeyY)&&(t.suspendCursorPositionChange[e.getModel().id]=!1,t.clearParserCache(e.getModel().id),t.handleModelChange(e,"undoRedo"))})),this.disposables.push(e.onMouseUp(function(n){t.suspendCursorPositionChange[e.getModel().id]=!1,t.handleModelChange(e,"mouseClick")}))},r.prototype.getNewCursorActivity=function(e,t){var n=this.daxParserCache[e.id].parseResultKey,o=this.daxParserCache[e.id].doesKeyMatch(e.getValue(),void 0,t);return o===vt.FullMatch?n.cursorActivity:o===vt.CacheCleared||n.expression===e.getValue()?1:5},r.prototype.logParseEvent=function(e,t,n,o,a,c){return(0,y.mG)(this,void 0,void 0,function(){var g;return(0,y.Jh)(this,function(S){return g=Pt.getInstance().getProviderConfig(e),g?.logger&&g.logger.logDaxEvent({startTime:t,endTime:n,expressionLength:a.length,cursorPosition:o,parseTriggerSource:c}),[2]})})},r}(),vt=function(r){return r[r.FullMatch=0]="FullMatch",r[r.NoMatch=1]="NoMatch",r[r.DifferentCursorActivity=2]="DifferentCursorActivity",r[r.CacheCleared=3]="CacheCleared",r[r.MouseCursorChange=4]="MouseCursorChange",r}({}),Tr=function(){function r(e){this.parseResult=void 0,this._parseResultKey={expression:void 0,cursorPosition:void 0,cursorActivity:void 0},this.daxParser=new _e.w_(e===Fe.Query?Vt.Jt.MultipleQueries:Vt.Jt.Expression)}return Object.defineProperty(r.prototype,"parseResultKey",{get:function(){return this._parseResultKey},enumerable:!1,configurable:!0}),r.prototype.getDaxParser=function(){return this.daxParser},r.prototype.getParseResult=function(){return this.parseResult},r.prototype.setParseResult=function(e,t,n,o){this._parseResultKey={expression:e,cursorPosition:t,cursorActivity:o},this.parseResult=n},r.prototype.doesKeyMatch=function(e,t,n){return void 0===this.parseResultKey.expression&&void 0===this.parseResultKey.cursorPosition&&void 0===this.parseResultKey.cursorActivity?vt.CacheCleared:e===this.parseResultKey.expression&&2===t?vt.MouseCursorChange:n&&n!==this.parseResultKey.cursorPosition||e!==this.parseResultKey.expression?vt.NoMatch:t&&t!==this.parseResultKey.cursorActivity?vt.DifferentCursorActivity:vt.FullMatch},r.prototype.clear=function(){this.daxParser.clearParseState(),this.parseResult=void 0,this._parseResultKey={expression:void 0,cursorPosition:void 0,cursorActivity:void 0}},r}(),Or=function(){function r(e){this.daxParserManager=e,this.onDidChangeEmitter=new Le.Emitter,this.disposables=[]}return r.prototype.initialize=function(){var e=this;this.disposables.push(this.daxParserManager.forceRetokenize(function(){return e.onDidChangeEmitter.fire()}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},Object.defineProperty(r.prototype,"onDidChange",{get:function(){return this.onDidChangeEmitter.event},enumerable:!1,configurable:!0}),r.prototype.getLegend=function(){return{tokenTypes:["comment","function","identifier","keyword","axis","number","string","variable","measureReference","unrecognizedIdentifier","name"],tokenModifiers:["declaration"]}},r.prototype.provideDocumentSemanticTokens=function(e,t,n){if(""===e.getValue())return{data:new Uint32Array([]),resultId:null};var a=this.daxParserManager.getParseResult(e,void 0,void 0,void 0,ze.SemanticTokens);if(!a)return{data:new Uint32Array([]),resultId:null};for(var c=a.parser.tokenization.tokens,g=[0],S=1;S<e.getLineCount();S++)g.push(g[S-1]+e.getLineLength(S));var x=[],F=0,G=0,ae=a.formulaBreakup.formulaStart;ae>0&&x.push(0,0,ae,10,0);for(var le=0,ue=c;le<ue.length;le++){var Te=ue[le],Be=Pr(Te);if(11!==Be){var De=F,Xe=Te.startPosition+ae;for(S=F;S<g.length&&Xe-S>=g[S];S++)De=S;Xe-=De,Xe-=g[De],x.push(De-F,De===F?Xe-G:Xe,Te.length,Be,0),F=De,G=Xe}}return{data:new Uint32Array(x),resultId:null}},r.prototype.releaseDocumentSemanticTokens=function(e){},r}();function Pr(r){return r.isComment?0:r.isKeyword?3:r.matchObject instanceof _e.cr?4:30===r.type||31===r.type?6:36===r.type||37===r.type?5:33===r.type||35===r.type||39===r.type?11:r.isAnyKindOfIdentifier?r.matchObject instanceof _e.Gs||r.matchObject instanceof _e.Z0||r.matchObject instanceof _e.it?1:r.matchObject instanceof _e.yB?7:r.matchObject instanceof _e.Cf?8:r.matchObject instanceof _e.S2||r.matchObject instanceof _e.XN||r.matchObject instanceof _e.Df?2:9:11}var Mr=function(){function r(e,t){this.daxParserManager=e,this.localizationService=t}return r.prototype.provideHover=function(e,t,n){var o,a=Pt.getInstance().getProviderConfig(e.id);if(null!==(o=a?.hover)&&void 0!==o&&o.enabled)return a.hover.provideHover?a.hover.provideHover(e,t,n,{daxParserManager:this.daxParserManager}):this.defaultProvideHover(e,t,n)},r.prototype.defaultProvideHover=function(e,t,n){var o,a=pt.getModel(),c=pt.getContext();if(a&&c){var g=e.getOffsetAt(t),S=this.daxParserManager.getParseResult(e,g,2,void 0,ze.Hover);if(S?.parseResult){var x=null===(o=S.parser.tokenization)||void 0===o?void 0:o.tokens.find(function(ue){return ue.startPosition<=g&&g<ue.startPosition+ue.length});if(x){var F=x.getSegment(),G=x.matchObject,ae=e.getPositionAt(F.startPosition),le=e.getPositionAt(F.startPosition+F.length);if(G instanceof _e.Gs)return this.getFunctionDetails(G,ae,le);if(G instanceof _e.Cf)return this.getMeasureDetails(G,ae,le,S.parser.parseTree)}}}},r.prototype.getFunctionDetails=function(e,t,n){var o=e.description||"",a=e.getDefaultPrototype();return{range:Le.Range.fromPositions(t,n),contents:[{value:"**".concat(this.localizationService.get("Function"),"** ").concat(a)},{value:o}]}},r.prototype.getMeasureDetails=function(e,t,n,o){var a=e.name,c=function(r,e){for(var n,o=function(F){if(n=_.find(F.measures,function(G){return G.name.toLocaleLowerCase()===r.toLocaleLowerCase()&&(!e||e.toLowerCase()===F.name.toLowerCase())}))return"break"},a=0,c=pt.getModel().tables;a<c.length&&"break"!==o(c[a]);a++);return n}(e.name,e.table.name),g=c?.description,S=c&&!_.isNil(c.expression),x=this.getDefinedMeasure(e.table.name,e.name,o);if(c||x){var F=c?.isExternal,G=x?x.expressionNode.segment.text:void 0,ae=c&&x&&G!==c?.expression,le=x?G:S&&!F?c.expression:void 0;return{range:Le.Range.fromPositions(t,n),contents:[{value:"**".concat(this.localizationService.get("Measure"),"** ").concat(a).concat(g?" \u2013 ":"").concat(g??"")},{value:le?"```dax\n"+le+"\n```":"*".concat(this.localizationService.get("Dax_Formula_Unavailable"),"*")},{value:ae?"*".concat(this.localizationService.get("Dax_Query_View_Inactive_Measure"),"*\n").concat(c.expression&&!F?"```dax\n"+c.expression+"\n```":"\n*".concat(this.localizationService.get("Dax_Formula_Unavailable"),"*")):""}]}}},r.prototype.getDefinedMeasure=function(e,t,n){return this.getDefinedMeasures(n.rootNode).find(function(c){return t===c.measureDef.identifier&&e===c.measureDef.tableName})},r.prototype.getDefinedMeasures=function(e){if(!(e instanceof Ye._7))return[];for(var t=[],n=0,o=e.children;n<o.length;n++){var a=o[n];if(a instanceof Ye.Vu&&a.children[0]instanceof Ye.N4){var c=a.children[0].children.filter(function(g){return g instanceof Ye.pZ&&g.isComplete});t=(0,y.ev)((0,y.ev)([],t,!0),c,!0)}}return t},r}(),xr=function(){function r(e){this.daxParserManager=e}return r.prototype.provideCodeLenses=function(e,t){var n,o=Pt.getInstance().getProviderConfig(e.id);if(null!==(n=o?.codeLens)&&void 0!==n&&n.provideCodeLenses)return o.codeLens.provideCodeLenses(e,t,{daxParserManager:this.daxParserManager})},r}(),Rr=function(){function r(e){this.daxParserManager=e}return r.prototype.provideCodeActions=function(e,t,n,o){var a,c,g=Pt.getInstance().getProviderConfig(e.id);if(null!==(a=g?.codeAction)&&void 0!==a&&a.enabled&&null!==(c=g?.codeAction)&&void 0!==c&&c.provideCodeActions)return g.codeAction.provideCodeActions(e,t,n,o,{daxParserManager:this.daxParserManager})},r}(),Ir={rules:[{token:"comment",foreground:"008000"},{token:"function",foreground:"3165BB"},{token:"identifier",foreground:"001080"},{token:"keyword",foreground:"0000FF"},{token:"axis",foreground:"0000FF"},{token:"number",foreground:"098658"},{token:"string",foreground:"A31515"},{token:"variable",foreground:"008080"},{token:"measureReference",foreground:"68349C"},{token:"unrecognizedIdentifier",foreground:"5F5F5F5F"},{token:"name",foreground:"000000"}],colors:{"editor.background":"#FFFFFF","minimap.background":"#FFFFFF","editorSuggestWidget.selectedBackground":"#CFE4FA","editorSuggestWidget.selectedForeground":"#242424","editorSuggestWidget.highlightForeground":"#115EA3","editorSuggestWidget.focusHighlightForeground":"#115EA3"}},wr={rules:[{token:"comment",foreground:"6A9955"},{token:"function",foreground:"569CD6"},{token:"identifier",foreground:"9CDCFE"},{token:"keyword",foreground:"4FC1FF"},{token:"axis",foreground:"4FC1FF"},{token:"number",foreground:"B5CEA8"},{token:"string",foreground:"D16989"},{token:"variable",foreground:"4EC9B0"},{token:"measureReference",foreground:"C586C0"},{token:"unrecognizedIdentifier",foreground:"C8C8C8"},{token:"name",foreground:"FFFFFF"}],colors:{"editor.background":"#292929","minimap.background":"#292929","editorSuggestWidget.selectedBackground":"#0C3B5E","editorSuggestWidget.selectedForeground":"#FFFFFF","editorSuggestWidget.highlightForeground":"#479EF5","editorSuggestWidget.focusHighlightForeground":"#479EF5"}},it="dax",Ar=["var","return","not","evaluate","datatable","order","by","start","at","asc","desc","define","measure","in"],pn=function(){function r(){}return r.registerLanguageContributions=function(e,t,n){if(e===it)return void 0===this.initializedCount&&(this.initializedCount=0,r.registerDaxContributions(t,n)),this.initializedCount++,1===this.initializedCount&&r.initializeDaxContributions(),_e.dH.setFeatureSwitches({useSkippableParams:t.useSkippableParams,includeUndefinedOptionalFunctionParameters:t.includeUndefinedOptionalFunctionParameters,addTriviaToParseNodeMetadata:t.addTriviaToParseNodeMetadata,useParseTreeFormatting:t.useParseTreeFormatting}),this.daxContributions;(0,bt.sr)("Only DAX language is implemented with Monaco Contributions so far")},r.disposeLanguageContributions=function(e){if(e===it&&void 0!==this.initializedCount&&(this.initializedCount--,0===this.initializedCount)){this.daxContributions.daxParserManager.dispose(),this.daxContributions.semanticTokensProvider.dispose(),this.daxContributions.formattingEditProvider.dispose();for(var t=0,n=this.disposables;t<n.length;t++)n[t].dispose()}},r.registerDaxContributions=function(e,t){Kt.Po.unexpectedErrorHandler=function(r){setTimeout(function(){throw new f(r)})};var n=new Er;r.overrideIntellisenseWidgetPositioningStrategy(n),$e.languages.register({id:it,aliases:["DAX"],extensions:["dax","DAX"]});var o=function(r,e){var t="(".concat(r.join("|"),")");return{ignoreCase:!0,keywords:e,functions:r,tokenizer:{root:[{include:"@expression"}],expression:[[new RegExp("/\\*"),"comment","@comment"],[new RegExp("(//.*)"),"comment"],[new RegExp("--.*"),"comment"],[new RegExp('"'),"string","@string"],[new RegExp("[0-9"+Vt.w_.decimalSeparator+"]e?"),"number"],[new RegExp(t+"(\\s*\\()"),["function","function-parenthesis"]],[new RegExp("\\["),"bracketed-identifier","@bracketedIdentifier"],[new RegExp("\\'"),"quoted-identifier","@quotedIdentifier"],[new RegExp("[a-z_$][a-zA-Z0-9_$]*"),{cases:{"@keywords":"keyword"}}]],comment:[[new RegExp("[^/*]+"),"comment"],[new RegExp("/\\*"),"comment","@push"],[new RegExp("\\*/"),"comment","@pop"],[new RegExp("[/*]"),"comment"]],string:[[new RegExp('[^"]+'),"string"],[new RegExp('"'),"string","@pop"]],bracketedIdentifier:[[new RegExp("[^\\]]+"),"bracketed-identifier"],[new RegExp("]"),"bracketed-identifier","@pop"]],quotedIdentifier:[[new RegExp("[^\\']+"),"quoted-identifier"],[new RegExp("'"),"quoted-identifier","@pop"]]}}}(e.functionNames,Ar);$e.languages.setMonarchTokensProvider(it,o);var a=new Or(n);$e.languages.registerDocumentSemanticTokensProvider(it,a);var c=new ut(n);$e.languages.registerSignatureHelpProvider(it,c);var g=new ur(n);$e.languages.registerCompletionItemProvider(it,g);var S=new vr(n);$e.languages.registerDocumentFormattingEditProvider(it,S);var x=new Mr(n,t);$e.languages.registerHoverProvider(it,x);var F=new xr(n);$e.languages.registerCodeLensProvider(it,F);var G=new Rr(n);$e.languages.registerCodeActionProvider(it,G),this.daxContributions={daxParserManager:n,monarchTokensProvider:o,semanticTokensProvider:a,signatureHelpProvider:c,completionItemProvider:g,formattingEditProvider:S,hoverProvider:x,codeLensProvider:F,codeActionProvider:G},$e.editor.defineTheme(it,(0,y.pi)({base:"vs",inherit:!0},Ir)),$e.editor.defineTheme("".concat(it,"-dark"),(0,y.pi)({base:"vs-dark",inherit:!0},wr)),zt.m.setLocalizedDaxStrings({incompleteNumber:t.get("DaxError_IncompleteNumber"),invalidTupleLocation:t.get("DaxError_InvalidTupleLocation"),invalidParameter:t.get("DaxError_InvalidParameter"),missingParameters:t.get("DaxError_MissingParameters"),incorrectOrderByParam:t.get("DaxError_IncorrectOrderByParam"),incorrectPartitionByParam:t.get("DaxError_IncorrectPartitionByParam"),incorrectMatchByParam:t.get("DaxError_IncorrectMatchByParam"),grammaticalError:t.get("DaxError_GrammaticalError"),functionCallOnNonFunction:t.get("DaxError_FunctionCallOnNonFunction"),rightArgumentToInOperatorNotValidTable:t.get("DaxError_RightArgumentToInOperatorNotValidTable"),tooManyParameters:t.get("DaxError_TooManyParameters"),invalidNameCharacter:t.get("DaxError_InvalidNameCharacter"),invalidIdentifier:t.get("DaxError_UnrecognizedIdentifier"),unrecognizedIdentifier:t.get("DaxError_UnrecognizedIdentifier"),variableNameReserved:t.get("DaxError_VariableNameReserved"),rowsDescription:t.get("DaxDescription_Rows"),columnsDescription:t.get("DaxDescription_Columns"),rowsColumnsDescription:t.get("DaxDescription_RowsColumns"),columnsRowsDescription:t.get("DaxDescription_ColumnsRows"),duplicateMeasureName:t.get("DaxError_DuplicateMeasure")})},r.initializeDaxContributions=function(){var e=this;this.disposables.push($e.languages.setLanguageConfiguration(it,{brackets:[["{","}"],["(",")"],["[","]"]],comments:{lineComment:"//",blockComment:["/*","*/"]}})),this.disposables.push($e.editor.onDidCreateEditor(function(t){e.disposables.push(t.onDidChangeCursorSelection(function(n){if("snippet"===n.source){var o=t.getModel();if(!o)return;var a=t.getPosition();if(a&&a.equals(n.selection.getPosition())){var c=o.getPositionAt(o.getOffsetAt(n.selection.getPosition())-1),g=o.getValueInRange($e.Range.fromPositions(c,a));e.daxContributions.signatureHelpProvider.signatureHelpTriggerCharacters.some(function(S){return S===g})&&t.trigger("ModelChangeTriggeredParameterHints","editor.action.triggerParameterHints",null)}}}))})),this.daxContributions.daxParserManager.initialize(it),this.daxContributions.semanticTokensProvider.initialize(),this.daxContributions.formattingEditProvider.initialize()},r.overrideIntellisenseWidgetPositioningStrategy=function(e){var t=X.j.prototype.getPosition;X.j.prototype.getPosition=function(){try{var n=this.editor.getModel();if(!n)return null;var o=t.apply(this);if(n.getLanguageId()!==it||!o)return o;var a=e.getParseResult(n,n.getOffsetAt(this.editor.getPosition()),void 0,!0);return a?{position:n.getPositionAt(a.formulaBreakup.formulaStart+a.parseResult.prototypePosition),preference:[$e.editor.ContentWidgetPositionPreference.ABOVE,$e.editor.ContentWidgetPositionPreference.BELOW]}:o}catch(g){return t.apply(this)}}},r.disposables=[],r}(),Wt="tmdl",gn=function(){function r(){}return r.registerLanguageContributions=function(e){e===Wt?(0===this.initializedCount&&Le.languages.register({id:Wt,aliases:["TMDL"],extensions:["tmdl"]}),this.initializedCount++):(0,bt.sr)('Trying to register TMDL language while provided language is not "'.concat(e,'".'))},r.disposeLanguageContributions=function(e){e===Wt&&this.initializedCount--},r.initializedCount=0,r}(),Dr=["ADD","ALL","ALTER","AND","ANY","AS","ASC","AUTHORIZATION","BACKUP","BEGIN","BETWEEN","BREAK","BROWSE","BULK","BY","CASCADE","CASE","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COLLATE","COLUMN","COMMIT","COMPUTE","CONSTRAINT","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CREATE","CROSS","CURRENT","CURSOR","DATABASE","DBCC","DEALLOCATE","DECLARE","DEFAULT","DELETE","DENY","DESC","DISK","DISTINCT","DISTRIBUTED","DOUBLE","DROP","DUMP","ELSE","END","ERRLVL","ESCAPE","EXCEPT","EXEC","EXECUTE","EXISTS","EXIT","EXTERNAL","FETCH","FILE","FILLFACTOR","FOR","FOREIGN","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GOTO","GRANT","GROUP","HAVING","HOLDLOCK","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IN","INDEX","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KILL","LEFT","LIKE","LINENO","LOAD","MERGE","NATIONAL","NOCHECK","NONCLUSTERED","NOT","NULL","OF","OFF","OFFSETS","ON","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OUTER","OVER","PERCENT","PIVOT","PLAN","PRECISION","PRIMARY","PRINT","PROC","PROCEDURE","PUBLIC","RAISERROR","READ","READTEXT","RECONFIGURE","REFERENCES","REPLICATION","RESTORE","RESTRICT","RETURN","REVERT","REVOKE","RIGHT","ROLLBACK","ROWCOUNT","ROWGUIDCOL","RULE","SAVE","SCHEMA","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SET","SETUSER","SHUTDOWN","SOME","STATISTICS","TABLE","TABLESAMPLE","TEXTSIZE","THEN","TO","TOP","TRAN","TRANSACTION","TRIGGER","TRUNCATE","TRY_CONVERT","TSEQUAL","UNION","UNIQUE","UNPIVOT","UPDATE","UPDATETEXT","USE","USER","VALUES","VARYING","VIEW","WAITFOR","WHEN","WHERE","WHILE","WITH","WITHIN","WRITETEXT"],Nr=["ABSOLUTE","ACTION","ADA","ADD","ALLOCATE","ARE","ASSERTION","AT","BIT","BOTH","CASCADED","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","COLLATION","CONNECT","CONNECTION","CONSTRAINTS","CORRESPONDING","DATE","DEC","DECIMAL","DEFERRABLE","DEFERRED","DESCRIBE","DESCRIPTOR","DIAGNOSTICS","DISCONNECT","DOMAIN","END-EXEC","EXCEPTION","EXTRACT","FALSE","FIRST","FLOAT","FORTRAN","FOUND","GET","GLOBAL","GO","IMMEDIATE","INCLUDE","INDICATOR","INITIALLY","INSENSITIVE","INT","INTEGER","INTERVAL","ISOLATION","LANGUAGE","LAST","LEADING","LEVEL","LOCAL","MATCH","MAX","MIN","MODULE","NAMES","NATURAL","NCHAR","NEXT","NO","NONE","NUMERIC","ONLY","OVERLAPS","PAD","PARTIAL","PASCAL","POSITION","PREPARE","PRESERVE","PRIOR","PRIVILEGES","REAL","RELATIVE","ROWS","SCROLL","SECTION","SESSION","SIZE","SMALLINT","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","TEMPORARY","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TRAILING","TRANSLATE","TRANSLATION","TRIM","TRUE","UNKNOWN","USAGE","USING","VALUE","VARCHAR","WHENEVER","WORK","WRITE","ZONE"],Fr=["ADMIN","AFTER","AGGREGATE","ALIAS","ARRAY","ASENSITIVE","ASYMMETRIC","ATOMIC","BEFORE","BINARY","BLOB","BOOLEAN","BREADTH","CALL","CALLED","CARDINALITY","CLASS","CLOB","COLLECT","COMPLETION","CONDITION","CONSTRUCTOR","CORR","COVAR_POP","COVAR_SAMP","CUBE","CURRENT_CATALOG","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CYCLE","DATA","DEPTH","DEREF","DESTROY","DESTRUCTOR","DETERMINISTIC","DICTIONARY","DYNAMIC","EACH","ELEMENT","EQUALS","EVERY","FILTER","FREE","FULLTEXTTABLE","FUSION","GENERAL","HOLD","HOST","IGNORE","INITIALIZE","INOUT","INPUT","INTERSECTION","ITERATE","LARGE","LATERAL","LESS","LIKE_REGEX","LIMIT","LN","LOCALTIME","LOCALTIMESTAMP","LOCATOR","MAP","MEMBER","METHOD","MOD","MODIFIES","MODIFY","MULTISET","NCLOB","NEW","NORMALIZE","OBJECT","OCCURRENCES_REGEX","OLD","OPERATION","ORDINALITY","OUT","OUTPUT","OVERLAY","PARAMETER","PARAMETERS","PARTITION","PATH","POSITION_REGEX","POSTFIX","PREFIX","PREORDER","RANGE","READS","RECURSIVE","REF","REFERENCING","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RESULT","RETURNS","ROLE","ROLLUP","ROUTINE","ROW","SAVEPOINT","SCOPE","SEARCH","SENSITIVE","SEQUENCE","SETS","SIMILAR","SPECIFIC","SPECIFICTYPE","SQLEXCEPTION","START","STATE","STATEMENT","STATIC","STDDEV_POP","STDDEV_SAMP","STRUCTURE","SUBMULTISET","SUBSTRING_REGEX","SYMMETRIC","SYSTEM","TERMINATE","THAN","TRANSLATE_REGEX","TREAT","UESCAPE","UNDER","UNNEST","VARIABLE","VAR_POP","VAR_SAMP","WIDTH_BUCKET","WINDOW","WITHOUT","XMLAGG","XMLATTRIBUTES","XMLBINARY","XMLCAST","XMLCOMMENT","XMLCONCAT","XMLDOCUMENT","XMLELEMENT","XMLEXISTS","XMLFOREST","XMLITERATE","XMLNAMESPACES","XMLPARSE","XMLPI","XMLQUERY","XMLSERIALIZE","XMLTABLE","XMLTEXT","XMLVALIDATE"],Br=["APPLY","MATCHED"],Lr=["ABS","ACOS","APPROX_COUNT_DISTINCT","ASCII","ASIN","ATAN","ATN2","AVG","BINARY_CHECKSUM","BIT_LENGTH","CEILING","CHARINDEX","CHECKSUM","COALESCE","COLLATIONPROPERTY","COL_NAME","CONCAT","COS","COT","COUNT","COUNT_BIG","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASEPROPERTYEX","DATALENGTH","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DB_ID","DB_NAME","DEGREES","DENSE_RANK","DIFFERENCE","EOMONTH","ERROR_MESSAGE","ERROR_NUMBER","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","EXP","FIRST_VALUE","FLOOR","GETDATE","GETUTCDATE","GROUPING","HASHBYTES","HAS_DBACCESS","HOUR","INDEXPROPERTY","ISDATE","ISNULL","ISNUMERIC","LAG","LAST_VALUE","LEAD","LEN","LOG10","LOWER","LTRIM","MINUTE","MONTH","MONTHNAME","NTILE","NULLIF","OBJECTPROPERTY","OBJECTPROPERTYEX","OBJECT_ID","OBJECT_NAME","OCTET_LENGTH","PARSENAME","PATINDEX","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PI","POWER","QUARTER","QUOTENAME","RADIANS","RAND","RANK","REPLACE","REVERSE","ROUND","ROW_NUMBER","RTRIM","SCHEMA_ID","SCHEMA_NAME","SECOND","SERVERPROPERTY","SESSION_USER","SIGN","SIN","SMALLDATETIMEFROMPARTS","SOUNDEX","SPACE","SQL_VARIANT_PROPERTY","SQRT","SQUARE","STATS_DATE","STDEV","STDEVP","STR","STRING_AGG","STUFF","SUBSTRING","SUM","SUSER_SNAME","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSTEM_USER","SYSUTCDATETIME","TAN","TERTIARY_WEIGHTS","TIMEFROMPARTS","TODATETIMEOFFSET","TYPEPROPERTY","TYPE_ID","TYPE_NAME","UNICODE","UPPER","USER_NAME","VAR","VARP","WEEK","XACT_STATE","YEAR"],jr=function(){function r(){!function(){var r=Ut.n.prototype.triggerSuggest;Ut.n.prototype.triggerSuggest=function(e,t){return r.apply(this,[e,!0])}}()}return r.prototype.provideCompletionItems=function(e,t,n,o){var a=e.getWordUntilPosition(t),c={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:a.startColumn,endColumn:a.endColumn},g={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"},S=Dr.map(function(ue){return{label:ue,kind:Le.languages.CompletionItemKind.Keyword,detail:"",insertText:ue,range:c,command:g}}).filter(function(ue){var Te;return ue.label.toString().startsWith(null===(Te=a.word)||void 0===Te?void 0:Te.toLocaleUpperCase())}),x=Nr.map(function(ue){return{label:ue,kind:Le.languages.CompletionItemKind.Keyword,detail:"",insertText:ue,range:c,command:g}}).filter(function(ue){var Te;return ue.label.toString().startsWith(null===(Te=a.word)||void 0===Te?void 0:Te.toLocaleUpperCase())}),F=Fr.map(function(ue){return{label:ue,kind:Le.languages.CompletionItemKind.Keyword,detail:"",insertText:ue,range:c,command:g}}).filter(function(ue){var Te;return ue.label.toString().startsWith(null===(Te=a.word)||void 0===Te?void 0:Te.toLocaleUpperCase())}),G=Br.map(function(ue){return{label:ue,kind:Le.languages.CompletionItemKind.Operator,detail:"",insertText:ue,range:c,command:g}}).filter(function(ue){var Te;return ue.label.toString().startsWith(null===(Te=a.word)||void 0===Te?void 0:Te.toLocaleUpperCase())}),ae=Lr.map(function(ue){return{label:ue,kind:Le.languages.CompletionItemKind.Function,detail:"",insertText:ue,range:c,command:g}}).filter(function(ue){var Te;return ue.label.toString().startsWith(null===(Te=a.word)||void 0===Te?void 0:Te.toLocaleUpperCase())}),le=(0,y.ev)((0,y.ev)((0,y.ev)((0,y.ev)((0,y.ev)([],S,!0),x,!0),F,!0),G,!0),ae,!0);return Promise.resolve({suggestions:le})},r.prototype.resolveCompletionItem=function(e,t){return Promise.resolve(e)},r}(),kr=function(){function r(){this.disposables=[]}return r.prototype.initialize=function(e){var t=this;this.disposables.push(Le.editor.onDidCreateEditor(function(n){t.disposables.push(n.onDidChangeModelContent(function(o){t.handleModelChange(n,"reset")}))}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},r.prototype.handleModelChange=function(e,t){e.trigger("TriggerSuggestion","editor.action.triggerSuggest",{auto:!0,completionOptions:{providerFilter:void 0,kindFilter:void 0}})},r}(),Nt="sql",mn=function(){function r(){}return r.registerLanguageContributions=function(e){return e===Nt?(0===this.initializedCount&&(this.initializedCount=1,r.registerSqlContributions()),1===this.initializedCount&&r.initializeSqlContributions(),this.sqlContributions):this.sqlContributions},r.disposeLanguageContributions=function(e){if(e===Nt&&(this.initializedCount--,this.initializedCount<=0)){this.sqlContributions.sqlParserManager.dispose();for(var t=0,n=this.disposables;t<n.length;t++)n[t].dispose()}},r.registerSqlContributions=function(){$e.languages.register({id:Nt,aliases:["sql"],extensions:["sql"]});var e=new kr,t=new jr;this.disposables.push($e.languages.registerCompletionItemProvider(Nt,t)),this.sqlContributions={sqlParserManager:e,completionItemProvider:t}},r.initializeSqlContributions=function(){this.disposables.push($e.languages.setLanguageConfiguration(Nt,{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]})),this.sqlContributions.sqlParserManager.initialize(Nt)},r.initializedCount=0,r.disposables=[],r}(),Ur=E(32238),Qe=function(r){return r[r.AltEnter=0]="AltEnter",r[r.AltF1=1]="AltF1",r[r.Ctrl0=2]="Ctrl0",r[r.CtrlEnter=3]="CtrlEnter",r[r.CtrlEqual=4]="CtrlEqual",r[r.CtrlF=5]="CtrlF",r[r.CtrlF3=6]="CtrlF3",r[r.CtrlH=7]="CtrlH",r[r.CtrlJ=8]="CtrlJ",r[r.CtrlMinus=9]="CtrlMinus",r[r.Enter=10]="Enter",r[r.Escape=11]="Escape",r[r.F1=12]="F1",r[r.F3=13]="F3",r[r.F8=14]="F8",r[r.ShiftEnter=15]="ShiftEnter",r}({}),vn="accessibilityWidgetVisible",yn="suggestWidgetVisible",Hr={scrollbar:{vertical:"visible"}},zr={scrollbar:{vertical:"hidden"}},Cn=function(){function r(e){this.editor=e}return r.prototype.insertNewLine=function(){var e=this.editor.getPosition().lineNumber;this.editor.trigger("MonacoEditorUtility.insertNewLine","lineBreakInsert",{}),this.editor.setPosition({lineNumber:e+1,column:this.editor.getModel().getLineIndentColumn(e+1)}),this.updateEditorScrollbar(),this.editor.trigger("InsertNewLineTriggeredSuggest","editor.action.triggerSuggest",{auto:!0})},r.prototype.getSelections=function(){return this.editor.getSelections()},r.prototype.setSelection=function(e){if(e){var t=this.editor.getModel();if(!(e.startPosition+e.length>this.getModelText(t).length)){var n=t.getPositionAt(e.startPosition),o=t.getPositionAt(e.startPosition+e.length);this.editor.setSelection({startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:o.lineNumber,endColumn:o.column})}}},r.prototype.setIsReadOnly=function(e){this.editor.updateOptions({readOnly:e})},r.prototype.getModelText=function(e){return e?e.getValue():""},r.prototype.getEditorText=function(){return this.getModelText(this.editor.getModel())},r.prototype.getCursorPosition=function(){var e=this.editor.getModel(),t=this.getModelText(e),n=this.editor.getSelection(),o=this.getAbsolutePositionInModel(e,n.getEndPosition(),t);return{position:o,selectionStart:n.isEmpty()?o:this.getAbsolutePositionInModel(e,n.getStartPosition(),t)}},r.prototype.getAbsolutePositionInModel=function(e,t,n){var o=e.getLinesContent();if(t.lineNumber>o.length)return n.length;for(var a=t.lineNumber-1,g=t.column>o[a].length?o[a].length:t.column-1;--a>=0;)g+=o[a].length+1;return g},r.prototype.updateEditorScrollbar=function(){var e=this.editor.getLayoutInfo();this.editor.getContentHeight()>e.height?this.editor.updateOptions(Hr):this.editor.updateOptions(zr)},r.prototype.executeCopy=function(){this.executeCommandForSelection("copy")},r.prototype.executeCut=function(){this.executeCommandForSelection("cut")},r.prototype.executeFormat=function(){var e;return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.editor.getAction("editor.action.formatDocument"))||void 0===e?void 0:e.run()];case 1:return t.sent(),[2]}})})},r.prototype.executeCommandForSelection=function(e){this.editor.getSelection().isEmpty()||document.execCommand(e)},r}(),bn=E(64647),Kr=["editorContainer"],Wr=["accessibilityContent"];function Qr(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",3),i.\u0275\u0275listener("keydown",function(a){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onAccessibilityWidgetKeypress(a))}),i.\u0275\u0275elementStart(1,"div",4,5),i.\u0275\u0275listener("blur",function(){i.\u0275\u0275restoreView(t);var a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onAccessibilityWidgetBlur())}),i.\u0275\u0275text(3),i.\u0275\u0275element(4,"br")(5,"br"),i.\u0275\u0275text(6),i.\u0275\u0275element(7,"br")(8,"br"),i.\u0275\u0275text(9),i.\u0275\u0275element(10,"br")(11,"br"),i.\u0275\u0275text(12),i.\u0275\u0275element(13,"br")(14,"br"),i.\u0275\u0275text(15),i.\u0275\u0275elementEnd()()}if(2&r){var n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngStyle",n.accessibilityWidgetStyle),i.\u0275\u0275attribute("aria-hidden",!n.accessibilityWidgetVisible),i.\u0275\u0275advance(1),i.\u0275\u0275attribute("aria-label",n.accessibilityWidgetAria),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",n.accessibilityWidgetMessages.cursor," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.optimized," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.tabbing," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.documentation," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("",n.accessibilityWidgetMessages.dismiss," ")}}var Qt=function(){function r(e,t,n,o,a,c,g){this.themeManager=e,this.element=t,this.highContrastCssGenerationService=n,this.accessibilityService=o,this.localizationService=a,this.featureSwitchService=c,this.ref=g,this.defaultMonacoProviderConfig={modelOptions:{endOfLineStyle:$e.editor.EndOfLineSequence.LF}},this.initialized=new i.EventEmitter,this.onFocus=new i.EventEmitter,this.onBlur=new i.EventEmitter,this.tabFocusMode=new i.EventEmitter,this.onContentChanged=new i.EventEmitter,this.onContentHeightChanged=new i.EventEmitter,this.onZoomLevelChanged=new i.EventEmitter,this.subscriptions=[],this.isInHighContrast=!1,this.toUnhooks=[],this.initializationTask=new u.B}return Object.defineProperty(r.prototype,"monacoKeybindingsMap",{get:function(){return this._monacoKeybindingsMap},enumerable:!1,configurable:!0}),r.prototype.ngOnInit=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,n,a,c,g,S,x,F=this;return(0,y.Jh)(this,function(G){switch(G.label){case 0:return[4,Promise.all([Promise.resolve().then(E.bind(E,68816)),Promise.resolve().then(E.bind(E,94124))])];case 1:return S=G.sent(),this.monacoApi={monaco:e=S[0],EditorZoom:S[1].EditorZoom},this._monacoKeybindingsMap=((x={})[Qe.AltEnter]=e.KeyMod.Alt|e.KeyCode.Enter,x[Qe.AltF1]=e.KeyMod.Alt|e.KeyCode.F1,x[Qe.Ctrl0]=e.KeyMod.CtrlCmd|e.KeyCode.Numpad0,x[Qe.CtrlEnter]=e.KeyMod.CtrlCmd|e.KeyCode.Enter,x[Qe.CtrlEqual]=e.KeyMod.CtrlCmd|e.KeyCode.Equal,x[Qe.CtrlF]=e.KeyMod.CtrlCmd|e.KeyCode.KeyF,x[Qe.CtrlF3]=e.KeyMod.CtrlCmd|e.KeyCode.F3,x[Qe.CtrlH]=e.KeyMod.CtrlCmd|e.KeyCode.KeyH,x[Qe.CtrlJ]=e.KeyMod.CtrlCmd|e.KeyCode.KeyJ,x[Qe.CtrlMinus]=e.KeyMod.CtrlCmd|e.KeyCode.Minus,x[Qe.Enter]=e.KeyCode.Enter,x[Qe.Escape]=e.KeyCode.Escape,x[Qe.F1]=e.KeyCode.F1,x[Qe.F3]=e.KeyCode.F3,x[Qe.F8]=e.KeyCode.F8,x[Qe.ShiftEnter]=e.KeyMod.Shift|e.KeyCode.Enter,x),this.mode===Nt?mn.registerLanguageContributions(this.mode):this.mode===it?(n=[],this.languageOptions&&(n=this.languageOptions.Functions.map(function(ae){return ae.Name})),this.contributions=pn.registerLanguageContributions(this.mode,{functionNames:n,useSkippableParams:!0,includeUndefinedOptionalFunctionParameters:!0,addTriviaToParseNodeMetadata:!0,useParseTreeFormatting:!0},this.localizationService)):this.mode===Wt&&gn.registerLanguageContributions(this.mode),a={automaticLayout:!1,autoClosingBrackets:"never",codeLens:!1,contextmenu:!1,folding:!1,fontSize:12,language:this.mode,lineHeight:18,lineNumbersMinChars:1,minimap:{enabled:!1},mouseWheelZoom:!0,quickSuggestions:!1,renderLineHighlight:"none",roundedSelection:!1,scrollbar:{useShadows:!1,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,selectionHighlight:!1,suggestSelection:"first",wordBasedSuggestions:!1,acceptSuggestionOnEnter:"on",wordWrap:"on",value:"","semanticHighlighting.enabled":!0,unicodeHighlight:{nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}},this.isReadOnly&&(a.overviewRulerBorder=!1,a.hideCursorInOverviewRuler=!0,a.lineNumbers="off"),c=null!=this.customCreationOptions?(0,y.pi)((0,y.pi)({},a),this.customCreationOptions):a,g=Pt.getInstance().createMonacoModelWithConfig("",this.mode,this.defaultMonacoProviderConfig),this.textEditor=this.monacoApi.monaco.editor.create(this.editorContainer.nativeElement,(0,y.pi)({model:g},c)),$(this.textEditor.getDomNode()).find("textarea.inputarea").addClass("cdk-visually-hidden"),this.monacoEditorUtility=new Cn(this.textEditor),this.initializeMonacoEvents(),this.initializeHighContrastSettings(),this.initializationTask.resolve(),this.initialized.next(this),this.subscriptions.push(this.themeManager.theme$.subscribe(function(ae){var le=F.resolveThemeName(ae);F.theme=le,F.isInHighContrast||F.monacoApi.monaco.editor.setTheme(le)})),[2]}})})},r.prototype.ngOnChanges=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,this.initializationTask.promise];case 1:return t.sent(),e.formulaText&&this.setText(e.formulaText.currentValue),e.isReadOnly&&!e.isReadOnly.isFirstChange()&&this.setIsReadOnly(e.isReadOnly.currentValue),e.selection&&this.monacoEditorUtility.setSelection(e.selection.currentValue),[2]}})})},r.prototype.ngOnDestroy=function(){for(var e=0,t=this.toUnhooks;e<t.length;e++)t[e].dispose();if(this.subscriptions)for(var o=0,a=this.subscriptions;o<a.length;o++)a[o].unsubscribe();this.textEditor&&this.textEditor.dispose(),pn.disposeLanguageContributions(this.mode),mn.disposeLanguageContributions(this.mode),gn.disposeLanguageContributions(this.mode)},Object.defineProperty(r.prototype,"accessibilityWidgetAria",{get:function(){if(this.accessibilityWidgetMessages)return"".concat(this.accessibilityWidgetMessages.cursor," ").concat(this.accessibilityWidgetMessages.optimized," ").concat(this.accessibilityWidgetMessages.tabbing," ").concat(this.accessibilityWidgetMessages.documentation," ").concat(this.accessibilityWidgetMessages.dismiss)},enumerable:!1,configurable:!0}),r.prototype.focus=function(){this.textEditor&&this.textEditor.focus()},r.prototype.scrollTop=function(){this.textEditor.setScrollPosition({scrollTop:0})},r.prototype.copy=function(){this.monacoEditorUtility.executeCopy()},r.prototype.cut=function(){this.monacoEditorUtility.executeCut()},r.prototype.paste=function(e){for(var n=[],o=0,a=this.monacoEditorUtility.getSelections();o<a.length;o++)n.push({text:e,range:a[o],forceMoveMarkers:!0});this.textEditor.executeEdits(e,n)},r.prototype.getText=function(){return this.monacoEditorUtility.getEditorText()},r.prototype.resetModelTokens=function(e){var t;this.monacoEditorUtility.getEditorText()!==e?this.textEditor.getModel().setValue(e):null===(t=this.textModelInternal().tokenization)||void 0===t||t.resetTokenization()},r.prototype.textModelInternal=function(){return this.textEditor.getModel()},r.prototype.format=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,this.monacoEditorUtility.executeFormat()];case 1:return e.sent(),[2]}})})},r.prototype.onAccessibilityWidgetBlur=function(){this.accessibilityWidgetVisible=!1,this.accessibilityWidgetContextKey.set(!1),this.textEditor.focus()},r.prototype.onAccessibilityWidgetKeypress=function(e){var t=!1;switch(e.code){case"KeyE":e.ctrlKey&&(t=!0,this.textEditor.updateOptions({accessibilitySupport:this.textEditor.getRawOptions().accessibilitySupport}));break;case"KeyH":e.ctrlKey&&(t=!0,window.open("https://go.microsoft.com/fwlink?linkid=2028689"));break;case"KeyM":e.ctrlKey&&(t=!0,this.toggleTabMovesFocus());break;case"Escape":t=!0,this.onAccessibilityWidgetBlur()}t&&(event.stopPropagation(),event.preventDefault())},r.prototype.layout=function(e,t){if(q.fF.assert(function(){return void 0!==e||void 0!==t},"At least one of the width/height values should be specified."),this.textEditor){var n=this.textEditor.getLayoutInfo(),o=e||n.width,a=t||n.height;this.textEditor.layout({width:o,height:a}),$(this.editorContainer).width(o).height(a)}},r.prototype.toggleTabMovesFocus=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,this.initializationTask];case 1:return e.sent(),this.textEditor.getAction("editor.action.toggleTabFocusMode").run(),[2]}})})},r.prototype.registerActions=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return[4,this.initializationTask.promise];case 1:for(c.sent(),t=0,n=e;t<n.length;t++)a=(o=n[t]).keybindingContext?"".concat(this.editorContextId,"&&").concat(o.keybindingContext):this.editorContextId,o.keybindingContext=a,this.textEditor.addAction(o);return[2]}})})},r.prototype.setValue=function(e){this.textEditor.setValue(e)},r.prototype.insertTextAtCurrentCursor=function(e){this.textEditor.trigger("keyboard","paste",{text:e})},r.prototype.getHighlightedText=function(){var e=this.textEditor.getSelection();return null==e?"":this.textEditor.getModel().getValueInRange(e)},r.prototype.updateZoomLevel=function(e){q.fF.assert(function(){return e>=-5&&e<=20},"zoomLevel should be between -5 to 20"),this.monacoApi.EditorZoom.setZoomLevel(e)},r.prototype.getZoomLevel=function(){return this.monacoApi.EditorZoom.getZoomLevel()},r.prototype.showAccessibilityWidget=function(){if(!this.accessibilityWidgetVisible){this.updateAccessibilityMessage();var e=this.textEditor.getLayoutInfo();this.accessibilityWidgetStyle={top:"30px","max-width":"".concat(e.width,"px"),"max-height":"".concat(e.height-38,"px")},this.accessibilityWidgetVisible=!0,this.accessibilityWidgetContextKey.set(!0),this.ref.detectChanges(),this.accessibilityContent.nativeElement.focus()}},r.prototype.updateAccessibilityMessage=function(){var e=this.textEditor.getPosition();this.accessibilityWidgetMessages={cursor:this.localizationService.format("MonacoEditorAccessibilityMessageCursor",[e.lineNumber,e.column]),optimized:this.localizationService.get(this.textEditor.getOption(this.monacoApi.monaco.editor.EditorOption.accessibilitySupport)?"MonacoEditorAccessibilityOn":"MonacoEditorAccessibilityOff"),tabbing:this.localizationService.get(this.textEditor.getOption(this.monacoApi.monaco.editor.EditorOption.tabFocusMode)?"MonacoEditorAccessibilityTabMovesFocusOn":"MonacoEditorAccessibilityTabMovesFocusOff"),documentation:this.localizationService.get("MonacoEditorAccessibilityMessageDocumentation"),dismiss:this.localizationService.get("MonacoEditorAccessibilityMessageDismiss")}},r.prototype.initializeHighContrastSettings=function(){var e=this;this.subscriptions.push(this.accessibilityService.highContrastThemeChanged$.subscribe(function(t){return e.setHighContrastTheme(t)})),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .view-overlays .selected-text","{ background-color: @selectedBackgroundColor !important; border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .cursor","{ color: @foregroundColor !important; background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .hc-black .monaco-scrollable-element > .scrollbar > .slider","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .view-line span.inline-selected-text","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget > .tree","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .details","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon::before","{ color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-struct::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-interface::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-constructor::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-module::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .parameter-hints-widget","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-details","{ background-color: @backgroundColor !important; }"),this.setHighContrastTheme(this.accessibilityService.getHighContrastTheme())},r.prototype.setIsReadOnly=function(e){this.monacoEditorUtility.setIsReadOnly(e),this.textEditor.updateOptions({overviewRulerBorder:!e&&void 0,hideCursorInOverviewRuler:!!e||void 0,lineNumbers:e?"off":void 0})},r.prototype.setText=function(e){var t=this.textEditor.getModel();this.monacoEditorUtility.getEditorText()!==e&&t.applyEdits([{text:e||"",range:t.getFullModelRange()}]);var n=e?t.getPositionAt(e.length):{lineNumber:1,column:1};this.textEditor.setPosition(n)},r.prototype.setHighContrastTheme=function(e){if(!e)return this.isInHighContrast=!1,void this.monacoApi.monaco.editor.setTheme(this.theme);this.isInHighContrast=!0;var t=function(o){return"#"===o[0]?o.substr(1):o};this.monacoApi.monaco.editor.defineTheme("highContrast",{base:"hc-black",inherit:!1,rules:[{background:t(e.background),foreground:t(e.foreground),token:""}],colors:{"editor.background":e.background,"editor.foreground":e.foreground,"editorCursor.foreground":e.foreground,"editor.selectionBackground":e.selectedBackground,"editor.selectionForeground":e.selectedText,"editor.selectionHighlight":e.selected}}),this.monacoApi.monaco.editor.setTheme("highContrast")},r.prototype.initializeMonacoEvents=function(){var e=this;this.editorContextId="MonacoEditorHost".concat(this.textEditor.getId(),".focused");var t=this.textEditor.createContextKey(this.editorContextId,!1);this.toUnhooks.push(this.textEditor.onDidFocusEditorText(function(){t.set(!0),e.onFocus.emit()})),this.toUnhooks.push(this.textEditor.onDidBlurEditorText(function(){t.set(!1),e.onBlur.emit()})),this.accessibilityWidgetContextKey=this.textEditor.createContextKey(vn,!1),this.configureDefaultKeybindings(),this.toUnhooks.push(this.textEditor.onDidChangeConfiguration(function(){e.tabFocusMode.next(e.textEditor.getOption(e.monacoApi.monaco.editor.EditorOption.tabFocusMode)),e.textEditor.getModel()&&e.updateAccessibilityMessage()})),this.toUnhooks.push(this.textEditor.onDidChangeModelContent(function(n){e.onContentChanged.next(n.changes)})),this.toUnhooks.push(this.textEditor.onDidContentSizeChange(function(n){n.contentHeightChanged&&e.onContentHeightChanged.next(n.contentHeight)})),this.toUnhooks.push(this.monacoApi.EditorZoom.onDidChangeZoomLevel(function(n){e.onZoomLevelChanged.next(n),e.hideSuggestWidget()}))},r.prototype.configureDefaultKeybindings=function(){var e=this,t=[{id:"editor.action.fontZoomIn",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomIn"),keybindings:[this.monacoKeybindingsMap[Qe.CtrlEqual]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(e.monacoApi.EditorZoom.getZoomLevel()+1),e.hideSuggestWidget()}},{id:"editor.action.fontZoomOut",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomOut"),keybindings:[this.monacoKeybindingsMap[Qe.CtrlMinus]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(e.monacoApi.EditorZoom.getZoomLevel()-1),e.hideSuggestWidget()}},{id:"editor.action.fontZoomReset",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomReset"),keybindings:[this.monacoKeybindingsMap[Qe.Ctrl0]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(0),e.hideSuggestWidget()}},{id:"editor.action.showAccessibilityWidget",label:"Show Accessibility Widget",keybindings:[this.monacoKeybindingsMap[Qe.AltF1]],run:function(){e.showAccessibilityWidget()}},{id:"editor.action.newLineAltEnter",label:this.localizationService.get("New_Line_AltEnter"),keybindings:[this.monacoKeybindingsMap[Qe.AltEnter]],run:function(){return e.monacoEditorUtility.insertNewLine()}},{id:"editor.action.newLineShiftEnter",label:this.localizationService.get("New_Line_ShiftEnter"),keybindings:[this.monacoKeybindingsMap[Qe.ShiftEnter]],run:function(){return e.monacoEditorUtility.insertNewLine()}}];this.registerActions(t),this.textEditor.addCommand(this.monacoKeybindingsMap[Qe.F1],_.noop)},r.prototype.hideSuggestWidget=function(){this.textEditor.trigger(null,"hideSuggestWidget",null)},r.prototype.resolveThemeName=function(e){return this.mode===it?"dark"===e?"dax-dark":"dax":"dark"===e?"vs-dark":"vs"},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275directiveInject(Ur.Ve),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(bn.g),i.\u0275\u0275directiveInject(Dt),i.\u0275\u0275directiveInject(ce.o),i.\u0275\u0275directiveInject(I.vZ),i.\u0275\u0275directiveInject(i.ChangeDetectorRef))},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["monaco-editor-host"]],viewQuery:function(t,n){if(1&t&&(i.\u0275\u0275viewQuery(Kr,7,i.ElementRef),i.\u0275\u0275viewQuery(Wr,5)),2&t){var o=void 0;i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.editorContainer=o.first),i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.accessibilityContent=o.first)}},inputs:{formulaText:"formulaText",isReadOnly:"isReadOnly",mode:"mode",theme:"theme",selection:"selection",customCreationOptions:"customCreationOptions",languageOptions:"languageOptions",defaultMonacoProviderConfig:"defaultMonacoProviderConfig"},outputs:{initialized:"initialized",onFocus:"onFocus",onBlur:"onBlur",tabFocusMode:"tabFocusMode",onContentChanged:"onContentChanged",onContentHeightChanged:"onContentHeightChanged",onZoomLevelChanged:"onZoomLevelChanged"},features:[i.\u0275\u0275NgOnChangesFeature],decls:3,vars:3,consts:[["focus-nav-mode","Browser",1,"monacoEditorContainer"],["editorContainer",""],["class","customAccessibilityHelpWidget","role","dialog",3,"ngStyle","keydown",4,"ngIf"],["role","dialog",1,"customAccessibilityHelpWidget",3,"ngStyle","keydown"],["role","document","tabindex","0",1,"content",3,"blur"],["accessibilityContent",""]],template:function(t,n){1&t&&(i.\u0275\u0275element(0,"div",0,1),i.\u0275\u0275template(2,Qr,16,8,"div",2)),2&t&&(i.\u0275\u0275classProp("readonly",n.isReadOnly),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.accessibilityWidgetVisible))},dependencies:[R.NgIf,R.NgStyle],styles:['[_nghost-%COMP%]   .customAccessibilityHelpWidget[_ngcontent-%COMP%]{position:absolute;width:500px;height:300px;padding:4px;overflow:auto;border:1px solid var(--fluent-theme-neutral-secondary-color, #605E5C);background-color:var(--fluent-theme-neutral-light-color, #EDEBE9);z-index:1}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]{box-sizing:border-box;height:100%}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursors-layer[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .view-lines[_ngcontent-%COMP%]{cursor:inherit}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursors-layer[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .view-lines[_ngcontent-%COMP%]:hover{cursor:text}[_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .inputarea[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .monaco-editor-background[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .margin[_ngcontent-%COMP%]{background-color:var(--fluent-theme-primary-color, #F2C811)}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .wordHighlight{background-color:transparent}@media (forced-colors: active){[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .quick-input-widget{background-color:canvas!important}}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{background-image:none;content:"\\f305";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{background-image:none;content:"\\ed86";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{background-image:none;content:"\\e4bd";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{background-image:none;content:"\\e8ef";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{background-image:none;content:"\\f37c";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{background-image:none;content:"\\f86d";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{background-image:none;content:"\\e787";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+E.p+'../images/DaxAxisRows.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+E.p+'../images/DaxAxisColumns.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+E.p+'../images/DaxAxisRowsColumns.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+E.p+'../images/DaxAxisColumnsRows.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused.string-label .codicon-suggest-more-info{visibility:visible;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}@media (forced-colors: active){[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .scrollbar .slider{background-color:highlight!important}}'],changeDetection:0}),r}(),En=E(77906),Tn=E(17177),nn=E(74913),Jr=E(50057),rn=E(85102),Sn=function(){function r(){this.iconName="copilot_24_multicolor",this.sprite="copilot-icons"}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["copilot-gutter-button"]],inputs:{iconName:"iconName",sprite:"sprite"},decls:3,vars:5,consts:[["tri-button","","appearance","subtle","localize-tooltip","Ribbon_Dax_Copilot_Tooltip",1,"icon-button"],["tri-svg-icon-16","",3,"name","sprite"]],template:function(t,n){1&t&&(i.\u0275\u0275elementStart(0,"button",0),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275element(2,"tri-svg-icon",1),i.\u0275\u0275elementEnd()),2&t&&(i.\u0275\u0275attribute("aria-label",i.\u0275\u0275pipeBind1(1,3,"Ribbon_Dax_Copilot_Tooltip")),i.\u0275\u0275advance(2),i.\u0275\u0275property("name",n.iconName)("sprite",n.sprite))},dependencies:[nn.M,Jr.r,rn.F],styles:["tri-svg-icon[_ngcontent-%COMP%]{fill:var(--colorBrandForeground2);width:100%;height:100%}"]}),r}(),qr={buttonHeightOffset:-7,rightOffset:0,onButtonClick:function(){}},$r=function(){function r(){this.isInitialized=!1,this.gutterContainerSelector=".margin-view-overlays",this.currentLineSelector=".current-line",this.activeLineNumberSelector=".active-line-number"}return r.prototype.initialize=function(e,t,n){this.isInitialized||(this.isInitialized=!0,this.initializeButton(t,n),this.initializeObserver(e))},r.prototype.initializeButton=function(e,t){t=(0,y.pi)((0,y.pi)({},qr),t);var n=e.createComponent(Sn);this.button=n.location.nativeElement,this.button.style.right="".concat(t.rightOffset,"px"),this.button.style.position="absolute",this.button.style.top="".concat(t.buttonHeightOffset,"px"),this.button.style.cursor="pointer",this.button.addEventListener("click",t.onButtonClick)},r.prototype.initializeObserver=function(e){var t=this;e.textEditor.onDidChangeModelDecorations(function(){t.showButtonOnInit(e);var n=document.querySelector(t.gutterContainerSelector);n.childNodes.length>0&&t.observeGutterContainer(n,e)})},r.prototype.showButtonOnInit=function(e){var t=document.querySelector(this.activeLineNumberSelector),n=t?.parentElement;n&&window.getComputedStyle(n).position&&this.handleCurrentLine(t.parentElement,e)},r.prototype.observeGutterContainer=function(e,t){var n=this;this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(function(o){for(var a=0,c=o;a<c.length;a++){var g=c[a];g.addedNodes.length&&n.handleAddedNodes(g.addedNodes,t)}}),this.mutationObserver.observe(e,{childList:!0})},r.prototype.handleAddedNodes=function(e,t){var n=this;e.forEach(function(o){o.querySelector(n.currentLineSelector)&&n.handleCurrentLine(o,t)})},r.prototype.handleCurrentLine=function(e,t){var n=e.querySelector(this.activeLineNumberSelector),o=n?parseInt(n.textContent,10):null,a=t.textEditor.getModel();"number"!=typeof o||o>a.getLineCount()||a.getLineContent(o).trim().length||e.appendChild(this.button)},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)}}),r}(),ei=[{type:Qt,componentId:"MonacoEditorHostComponentId"}],ti=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[$r],imports:[R.CommonModule,En.N.withManifests(ei),Tn.T6,W.v]}),r}(),On=E(93367),ni=E(94841),ri=E(79725),ii=E(16095),oi=E(53772),ai=E(44913),si=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({imports:[R.CommonModule,z.u5,On.U,W.v,ti,ni.b,ii.Z,ri.j,oi.w,kt,ee._,ai.lK,Tn.T6]}),r}(),li=E(14463),Pn=E(15393),Mn=E(10861),Zt=E(51644);function St(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return q.fF.assertValue(r,"functionName"),q.fF.assertValue(e,"args"),"".concat(r).concat(Zt.block("(",e,")"))}var Lt,Ft=E(50550),He=E(21571),xn=function(){function r(e){this.localizationService=e}return r.prototype.getTemplates=function(){return[new pi(this.localizationService),new gi(this.localizationService),new mi(this.localizationService),new vi(this.localizationService),new yi(this.localizationService),new Xt(this.localizationService,0),new Xt(this.localizationService,1),new Xt(this.localizationService,3),new Xt(this.localizationService,2)]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(ce.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),pi=function(){function r(e){this.localizationService=e,this.capabilities={name:"RunningSum",displayName:(0,He.V)("VisualCalcTemplate_RunningSum_DisplayName"),description:(0,He.V)("VisualCalcTemplate_RunningSum_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService);return function(r){return q.fF.assertValue(r,"expression"),St("RUNNINGSUM",r)}("[".concat(e,"]"))},r}(),gi=function(){function r(e){this.localizationService=e,this.capabilities={name:"MovingAverage",displayName:(0,He.V)("VisualCalcTemplate_MovingAverage_DisplayName"),description:(0,He.V)("VisualCalcTemplate_MovingAverage_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"WindowSize",constant:{type:{numeric:!0},defaultValue:1},displayName:(0,He.V)("VisualCalcTemplate_WindowSizeField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService);return function(r,e){return q.fF.assertValue(r,"expression"),q.fF.assertValue(e,"windowSize"),St("MOVINGAVERAGE",r,e)}("[".concat(e,"]"),"".concat(t))},r}(),mi=function(){function r(e){this.localizationService=e,this.capabilities={name:"PercentOfParent",displayName:(0,He.V)("VisualCalcTemplate_PercentOfParent_DisplayName"),description:(0,He.V)("VisualCalcTemplate_PercentOfParent_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"CollapseDenominatorField",column:{},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=(0,He.G)(this.capabilities.input[2].displayName,this.localizationService);return Zt.divide("[".concat(e,"]"),function(r,e){return q.fF.assertValue(r,"expression"),q.fF.assertValue(e,"axis"),St("COLLAPSE",r,e)}("[".concat(t,"]"),"".concat(n)))},r}(),vi=function(){function r(e){this.localizationService=e,this.capabilities={name:"PercentOfGrandTotal",displayName:(0,He.V)("ShowValueAs_Calculation_PercentOfGrandTotal"),description:(0,He.V)("VisualCalcTemplate_PercentOfGrandTotal_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"CollapseAllDenominatorField",column:{},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=(0,He.G)(this.capabilities.input[2].displayName,this.localizationService);return Zt.divide("[".concat(e,"]"),function(r,e){return q.fF.assertValue(r,"expression"),q.fF.assertValue(e,"axis"),St("COLLAPSEALL",r,e)}("[".concat(t,"]"),"".concat(n)))},r}(),yi=function(){function r(e){this.localizationService=e,this.capabilities={name:"AverageOfChildren",displayName:(0,He.V)("VisualCalcTemplate_AverageOfChildren_DisplayName"),description:(0,He.V)("VisualCalcTemplate_AverageOfChildren_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService);return function(r,e){return q.fF.assertValue(r,"expression"),q.fF.assertValue(e,"axis"),St("EXPAND",r,e)}(Zt.average("[".concat(e,"]")),"".concat(t))},r}(),Xt=function(){function r(e,t){void 0===t&&(t=3),this.localizationService=e,this.versusEnum=t;var n=r.versusToDax[this.versusEnum];this.capabilities={name:"Versus".concat(n),displayName:(0,He.V)("VisualCalcTemplate_Versus_".concat(n,"_DisplayName")),description:(0,He.V)("VisualCalcTemplate_Versus_".concat(n,"_Description")),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"DaxFunctionField",column:{},displayName:(0,He.V)("Field"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=r.versusToDax[this.versusEnum];return"[".concat(e,"] - ").concat(St(n,"[".concat(t,"]")))},r.versusToDax=((Lt={})[3]="FIRST",Lt[2]="LAST",Lt[1]="NEXT",Lt[0]="PREVIOUS",Lt),r}(),jt=E(88409),Rn=E(63057),In=E(59787),wn=E(59973),Et=E(83317),Ci=E(17653),bi=E(81905),on=new i.InjectionToken("IntellisenseModelService"),an=new i.InjectionToken("FormulaBarBehaviorService"),An=new i.InjectionToken("FormulaBarZoomService"),Ei=E(48563),sn=E(74249),Ti=E(26112),Si=E(59694),Oi=new i.InjectionToken("IntellisenseProxyServiceOverrideToken"),Jt=function(){function r(){}return r.prototype.onClientViewLoaded=function(e){},r.prototype.onContentChanged=function(e,t,n,o,a){},r.prototype.onEditorFocus=function(){},r.prototype.endIntellisenseSession=function(){},r.prototype.startIntellisenseSession=function(e,t,n,o){},r.prototype.getCultureInfo=function(){return Promise.resolve(JSON.stringify({decimalSeparator:".",listSeparator:","}))},r}(),Mi={provide:Jt,useFactory:function(r){var e=r.get(Oi,null);return e?i.Injector.create([e],r).get(Jt):new Jt},deps:[i.Injector]},xi=[" ","\t"],ln=function(){function r(e,t,n,o){this.localizationService=e,this.intellisenseHostService=t,this.intellisenseModelService=n,this.daxCapabilitiesService=o}return r.prototype.onClientViewLoaded=function(e){this.intellisenseHostService.onClientViewLoaded(e)},r.prototype.onContentChanged=function(e,t,n,o,a){this.intellisenseHostService.onContentChanged(e,t,n,o,a)},r.prototype.setUICulture=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.intellisenseHostService.getCultureInfo()];case 1:return e=n.sent(),t=(0,Ti.K)(e),(0,_e.g5)({listSeparator:t.listSeparator,numberDecimalSeparator:t.decimalSeparator}),[2]}})})},r.prototype.onEditorFocus=function(){this.intellisenseHostService.onEditorFocus()},r.prototype.endIntellisenseSession=function(){this.intellisenseModelService.reset(),this.intellisenseHostService.endIntellisenseSession()},r.prototype.startIntellisenseSession=function(e,t,n,o){this.intellisenseModelService.init({entityName:e,propertyName:t,schemaName:n,calculationEditMode:o}),this.intellisenseHostService.startIntellisenseSession(e,t,n,o)},r.prototype.getCalculationInfo=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){return(t=this.intellisenseModelService.findCalculationObject(e))&&null!=t.expression?[2,Promise.resolve({isNew:t.isNew,alertMessage:t.expressionErrorMessage?t.expressionErrorMessage:void 0,formulaText:this.getCalculationExpression(t)})]:(q.fF.assertFail((0,Si.W)("Cannot find editable Calculation: schema:{0} entity:{1} property:{2}",e?.schemaName,e?.entityName,e?.propertyName)),[2,Promise.resolve(void 0)])})})},r.prototype.getCalculationExpression=function(e){if(e.formulaOverride)return e.formulaOverride.formula;var t=_e.w_.convertToUI(e.expression);return e.calculationSyntaxType===Fe.Expression?t:(0,_e.Mk)(e.name,t)},r.prototype.updateFormulaContextAsync=function(){return(0,y.mG)(this,void 0,void 0,function(){var e;return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,this.getDataSourceInfo()];case 1:return e=t.sent(),[4,this.updateDaxContext(e)];case 2:return t.sent(),[2]}})})},r.prototype.updateDaxContext=function(e){return(0,y.mG)(this,void 0,void 0,function(){var g;return(0,y.Jh)(this,function(S){switch(S.label){case 0:return[4,this.intellisenseModelService.getDaxModeConfigInputs(e)];case 1:return g=S.sent(),pt.configureModel(g.serializableModel,g.wireDataSourceInfo,g.daxCalculation,g.isRestrictedMode,g.axes),[2]}})})},r.prototype.getDataSourceInfo=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,n,a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return[4,Promise.all([this.daxCapabilitiesService.getReservedWords(),this.daxCapabilitiesService.getCapabilities()])];case 1:return a=c.sent(),e=a[0],n=(0,Ei.w)(a[1].Functions),[2,{reservedWords:e,functionDataFromEngine:n}]}})})},r.prototype.analyzeFinalFormulaCommitInfo=function(e,t,n){var o=this.intellisenseModelService.getCalculationObject(),a={name:void 0,expression:void 0,invalidFormula:void 0,anonymizedExpression:void 0,parseResult:void 0},c=function(r,e,t,n){if(!n)return e.name=void 0,e.expression=void 0,e.invalidFormula=void 0,e.anonymizedExpression=void 0,!1;!function(r,e,t,n){var o=!1,a={name:void 0,expression:void 0};if((o=n.calculationSyntaxType===Fe.Expression)?a.expression=dn.uI.trimStart(r,xi):o=(0,_e.Mn)(r,a,n.calculationType===be.VisualCalculation),!o)return e.name=n.name||"",e.name&&!r?e.expression="":(e.invalidFormula=r,e.expression=n.expression||""),null;if(e.name=a.name,e.expression=a.expression,a.expression)if(t){(c=pt.getContext())||q.fF.assertFail("Context should be defined");var g=new _e.w_,S=new _e.ss,x={finalResult:S};g.finalParse(a.expression,c,x,_e.MX.AddMissingParens|_e.MX.Anonymize|_e.MX.ConvertToEngine),e.expression=x.finalResult.updatedExpression,e.anonymizedExpression=x.finalResult.anonymizedExpression,e.parseResult=S}else{g=new _e.w_;var c=pt.getContext(),G={result:new _e.bp};g.parse(a.expression,0,void 0,void 0,c,G,void 0),e.expression=_e.w_.convertToEngine(a.expression),e.parseResult=G.result}}(r,e,t,n);var o,a=n.formulaOverride;return a&&(o=a.formula),n.name!==e.name||n.expression!==e.expression||o!==e.invalidFormula}(e,a,n,o);!c&&t&&o&&(c=!!o.expressionErrorMessage&&!!o.expressionOverride&&!o.formulaOverride);var x,F,G=new Map;if(c&&a.invalidFormula)switch(x={expression:null,formula:a.invalidFormula},o.calculationType){case be.Column:F=this.localizationService.get("ReportModelInvalidColumnNameMessage");break;case be.Table:F=this.localizationService.get("ReportModelInvalidCalculatedTableNameMessage");break;case be.Measure:F=this.localizationService.get("ReportModelInvalidMeasureNameMessage");break;case be.CalculationItem:F=this.localizationService.get("ReportModelInvalidCalcItemNameMessage");break;case be.VisualCalculation:break;default:q.fF.assertFail("Unknown type "+o.calculationType)}return a.parseResult instanceof _e.bp&&a.parseResult.errors.length&&a.parseResult.errors.forEach(function(ae){return G.set(ae.errorCode,ae.message)}),{doCommit:c,newName:a.name,newExpression:a.expression,newInvalidFormula:a.invalidFormula,anonymizedExpression:a.anonymizedExpression,expressionOverride:x,errorMessage:F,parseErrorMessages:G}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(Jt),i.\u0275\u0275inject(on),i.\u0275\u0275inject(sn.r))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),Dn=E(83309),Nn=function(){function r(e,t,n,o){this.intellisenseService=e,this.screenReaderService=t,this.zone=n,this.behaviorService=o,this.suspendParseCount=0}return r.prototype.setUICulture=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,this.intellisenseService.setUICulture()];case 1:return e.sent(),[2]}})})},r.prototype.ngOnDestroy=function(){this.behaviorService.ngOnDestroy()},Object.defineProperty(r.prototype,"mode",{get:function(){return"dax"},enumerable:!1,configurable:!0}),r.prototype.registerFormulaBarControl=function(e){this.formulaBarControl=e,this.behaviorService.registerFormulaBarControl(e),this.intellisenseService.onClientViewLoaded(this)},r.prototype.onContentChanged=function(e,t,n,o){var a=this,c=this.intellisenseService.analyzeFinalFormulaCommitInfo(e,!1,!1);this.behaviorService.contentChanged||(this.behaviorService.contentChanged=c.doCommit),c.parseErrorMessages.size&&c.parseErrorMessages.forEach(function(g,S){a.screenReaderService.alertWithDebounce("dax-error"+S,g)}),this.intellisenseService.onContentChanged(e,t,n,0!==this.suspendParseCount,o.length>1),this.behaviorService.onContentChanged(c)},r.prototype.onEditorFocus=function(){this.intellisenseService.onEditorFocus()},r.prototype.hasUnsavedChanges=function(e){return this.behaviorService.hasUnsavedChanges(e)},r.prototype.onBlur=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,this.behaviorService.commitOrDeletePendingCalculation(e)];case 1:return[2,t.sent()]}})})},r.prototype.onSubmit=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(n){switch(n.label){case 0:return t=this.intellisenseService.analyzeFinalFormulaCommitInfo(e,!0,!0),[4,this.behaviorService.commitCalculationUpdate(t)];case 1:return n.sent(),[2]}})})},r.prototype.onCancel=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){return this.behaviorService.cancel(e),[2]})})},r.prototype.onTemplateSelection=function(e){return this.behaviorService.onTemplateSelection(e)},r.prototype.setCommittedFormulaBarText=function(e){this.formulaBarControl.setCommittedFormulaBarText(e)},r.prototype.hostServiceCalculationCommitedOrDeleted=function(){this.formulaBarControl.endFormulaEdit(),this.behaviorService.contentChanged=!1},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(ln),i.\u0275\u0275inject(Dn.g),i.\u0275\u0275inject(i.NgZone),i.\u0275\u0275inject(an))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),(0,y.gn)([function(r,e,t){var n=t.value;t.value=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var c=this;this.zone.run(function(){return n.apply(c,o)})}},(0,y.w6)("design:type",Function),(0,y.w6)("design:paramtypes",[]),(0,y.w6)("design:returntype",void 0)],r.prototype,"hostServiceCalculationCommitedOrDeleted",null),r}(),Fn=E(46192),Di=E(65302),Ni=E(39681),Bn=E(73221),Ln=E(52570),Yt=E(61561),qt=E(30794),$t=E(23558),Fi=E(22318),jn=E(77526),Bi=E(6663),Li=function(){function r(e,t,n){this.uiBlockingService=e,this.localizationService=t,this.intellisenseService=n}return r.prototype.registerFormulaBarControl=function(e){this.formulaBarControl=e,e.setEditModeOptions([])},r.prototype.focusWhenNotBlocked=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return e.sent(),this.formulaBarControl.focus(),[2]}})})},r.prototype.updateReadOnlyState=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return t.sent(),this.formulaBarControl.setReadOnly(e),[2]}})})},r.prototype.updateContents=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return[4,this.intellisenseService.getDataSourceInfo()];case 1:return n=o.sent(),(_.isEmpty(n.functionDataFromEngine)||_.isEmpty(n.reservedWords))&&!t&&(t=this.localizationService.get("DaxEditor_ErrorMessageToGetIntellisense")),[4,this.updateFormulaText(e,n)];case 2:return o.sent(),this.updateAlertText(t),[2]}})})},r.prototype.updateFormulaText=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){switch(n.label){case 0:return[4,this.intellisenseService.updateDaxContext(t)];case 1:return n.sent(),this.formulaBarControl.setCommittedFormulaBarText(e||null),this.contentChanged=!1,[2]}})})},r.prototype.updateAlertText=function(e){e?this.formulaBarControl.showAlertMessage(e):this.formulaBarControl.hideAlert()},r.\u0275fac=function(t){i.\u0275\u0275invalidFactory()},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),_n=E(95792),ji=E(26657),Bt=E(60661),_i=E(74082),ki=E(63731),Ui=new i.InjectionToken("UIBlockingService"),Vi=E(8590),Mt=E(73202),Gi=E(11494),kn=E(28894),Hi={provide:an,useClass:function(r){function e(t,n,o,a,c,g,S,x){var F=r.call(this,t,o,n)||this;return F.eventBridge=a,F.lazyScopeProvider=c,F.visualCalcEagerService=g,F.daxCapabilitiesService=S,F.zone=x,F.submit$=new qt.xQ,F.cancel$=new qt.xQ,F.onContentChanged$=new wt.X(void 0),F.destroy$=new qt.xQ,F}return(0,y.ZT)(e,r),e.prototype.hasUnsavedChanges=function(t){return!1},e.prototype.commitOrDeletePendingCalculation=function(t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){return[2,!1]})})},e.prototype.commitCalculationUpdate=function(t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(n){return this.submit$.next(t),[2]})})},e.prototype.cancel=function(t){this.cancel$.next()},e.prototype.onContentChanged=function(t){this.onContentChanged$.next(t)},e.prototype.onTemplateSelection=function(t){return(0,y.mG)(this,void 0,void 0,function(){var n,o;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return ji.gD(t)?(n=t.getExpression(),o=(0,He.G)(t.capabilities.displayName,this.localizationService),this.formulaBarControl.isEditorEnabled?[3,3]:[4,this.lazyScopeProvider.get(Yt.w)]):(q.fF.assertFail("Selected template is not a visual calculation template"),[2]);case 1:return[4,c.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Template",n,o)];case 2:return c.sent(),[2];case 3:return _.isEmpty(this.formulaBarControl.getCurrentEditorText())||this.formulaBarControl.getCurrentEditorText()===this.formulaBarControl.getHighlightedText()?this.formulaBarControl.insertTextAtCurrentCursor("".concat(o," = ").concat(n)):this.formulaBarControl.insertTextAtCurrentCursor(n),[2]}})})},e.prototype.setVisualContainer=function(t){this.visualContainer=t},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.registerFormulaBarControl=function(t){var n=this;this.formulaBarControl=t,this.formulaBarControl.setReadOnly(!1),this.eventBridge.on(Vi.jCS).pipe((0,Et.R)(this.destroy$),(0,wn.h)(function(o){return o.affectContainer(n.visualContainer)})).subscribe(function(){n.intellisenseService.updateFormulaContextAsync()}),this.submit$.pipe((0,Et.R)(this.destroy$)).subscribe(function(){n.visualCalcEagerService.enterViewMode("PressedSubmit")}),this.destroy$.pipe((0,$t.M)(this.onContentChanged$,this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var a=o[1],c=o[2];return(0,y.mG)(n,void 0,void 0,function(){return(0,y.Jh)(this,function(S){switch(S.label){case 0:switch(c.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(a,c)];case 2:return S.sent(),[4,this.tryRemoveUnchangedNewCalculation(a,c)];case 3:return S.sent(),[3,5];case 4:return[3,5];case 5:return[2]}})})}),this.cancel$.pipe((0,Et.R)(this.destroy$)).subscribe(function(){n.visualCalcEagerService.enterViewMode("PressedCancel")}),this.visualCalcEagerService.onContextChange$().pipe((0,Fi.O)({type:"Edit",calculationInfo:{isNew:!1}}),(0,jn.x)(function(o,a){return"Edit"===o.type&&"Edit"===a.type&&o.queryName===a.queryName}),(0,Et.R)(this.destroy$),(0,Bi.G)(),(0,$t.M)(this.onContentChanged$)).subscribe(function(o){var a=o[0],c=a[0],g=a[1],S=o[1];return(0,y.mG)(n,void 0,void 0,function(){var F,ue,Te;return(0,y.Jh)(this,function(De){switch(De.label){case 0:if("Edit"!==c.type)return[3,15];switch(g.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(S,c)];case 2:return De.sent(),[4,this.tryRemoveUnchangedNewCalculation(S,c)];case 3:return De.sent(),[3,15];case 4:switch(F=g.entryPoints){case"PressedCancel":return[3,5];case"PressedSubmit":return[3,9];case"DeletedCurrentCalc":return[3,12]}return[3,13];case 5:return c.calculationInfo.isNew?[4,this.lazyScopeProvider.get(Yt.w)]:[3,8];case 6:return[4,De.sent().removeVisualCalculation(this.visualContainer,c.queryName)];case 7:De.sent(),De.label=8;case 8:return[3,14];case 9:return[4,this.tryRemoveUnchangedNewCalculation(S,c)];case 10:return De.sent(),[4,this.tryToCommitContents(S,c)];case 11:return De.sent(),[3,14];case 12:return[3,14];case 13:return q.fF.assertNever(F),[3,14];case 14:return[3,15];case 15:switch(g.type){case"Edit":return[3,16];case"View":return[3,23]}return[3,23];case 16:return(ue=(0,Bt.Xf)(this.visualContainer))&&ue.defn.select().withName(g.queryName)?[4,this.intellisenseService.getCalculationInfo()]:(this.visualCalcEagerService.enterViewMode("DeletedCurrentCalc"),[3,24]);case 17:switch(Te=De.sent(),g.editingType){case"Template":return[3,18];case"Custom":return[3,20]}return[3,20];case 18:return[4,this.handleUpdateContents(!1,Te)];case 19:return De.sent(),[3,22];case 20:return[4,this.handleUpdateContents(Te.isNew,Te)];case 21:return De.sent(),[3,22];case 22:return[3,24];case 23:return this.resetFormulaBar(),[3,24];case 24:return[2]}})})}),this.visualCalcEagerService.onVisualCalcDeleted$().pipe((0,Et.R)(this.destroy$),(0,$t.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var c=o[1];"Edit"===c.type&&o[0]===c.queryName&&n.visualCalcEagerService.enterViewMode("DeletedCurrentCalc")}),this.visualCalcEagerService.onNativeNameReferenceChange$().pipe((0,Et.R)(this.destroy$),(0,$t.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var a=o[0],c=a.oldName,g=a.queryName,S=o[1];return(0,y.mG)(n,void 0,void 0,function(){var x,F,G,ae,le,ue,Te;return(0,y.Jh)(this,function(Be){switch(Be.label){case 0:return"Edit"!==S.type?[3,6]:(x=S.queryName,F=(0,Bt.Xf)(this.visualContainer),G=F?.defn.select().withName(x),G&&(0,_i.jX)(G.expr)?null==(ae=F.defn.select().withName(g))?[2]:(le=this.formulaBarControl.getCurrentEditorText(),x!==g?[3,2]:[4,this.updateExpressionAfterFieldRenamed(le)]):[3,6]);case 1:return Te=Be.sent(),[3,4];case 2:return[4,this.updateExpressionAfterReferencedFieldRenamed(le,F,c,ae.nativeReferenceName)];case 3:Te=Be.sent(),Be.label=4;case 4:return(ue=Te)===le?[3,6]:[4,this.updateContents(ue,void 0)];case 5:Be.sent(),this.formulaBarControl.resetModelTokens(ue),this.intellisenseService.updateFormulaContextAsync(),Be.label=6;case 6:return[2]}})})})},e.prototype.updateExpressionAfterFieldRenamed=function(t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c,g;return(0,y.Jh)(this,function(S){switch(S.label){case 0:return n=t,[4,this.intellisenseService.getCalculationInfo()];case 1:return null!=(o=S.sent())&&(a=(0,_n.O5)(o.formulaText,!0),c=(0,_n.O5)(t),g=c.formula||" ",c.name&&c.name===t&&(g=" ".concat(t)),n="".concat(a.name," =").concat(g)),[2,n]}})})},e.prototype.updateExpressionAfterReferencedFieldRenamed=function(t,n,o,a){return(0,y.mG)(this,void 0,void 0,function(){var c,g,S,x,F,G;return(0,y.Jh)(this,function(ae){switch(ae.label){case 0:return c=t,_.isEmpty(t)?[3,5]:null!=this.vcDaxParserService?[3,2]:(g=this,[4,this.lazyScopeProvider.get(ki.M)]);case 1:g.vcDaxParserService=ae.sent(),ae.label=2;case 2:return[4,this.daxCapabilitiesService.getReservedWords()];case 3:return S=ae.sent(),[4,this.daxCapabilitiesService.getCapabilities()];case 4:x=ae.sent(),F=n.defn.getNativeReferenceNames(!0),F=_.map(F,function(le){return le===a?o:le}),G=this.vcDaxParserService.getContext(F,S,x),c=this.vcDaxParserService.renameReference(G,t,o,a),ae.label=5;case 5:return[2,c]}})})},e.prototype.handleUpdateContents=function(t,n){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(o){switch(o.label){case 0:return this.formulaBarControl.clear(),[4,this.updateContents(n.formulaText,n.alertMessage)];case 1:return o.sent(),[4,this.focusWhenNotBlocked()];case 2:return o.sent(),t&&this.formulaBarControl.setSelection({startPosition:0,length:n.formulaText.length}),[2]}})})},e.prototype.resetFormulaBar=function(){this.formulaBarControl.clear(),this.formulaBarControl.resetModelTokens(""),this.formulaBarControl.setExpandCollapseState(1),this.formulaBarControl.endFormulaEdit()},e.prototype.tryToCommitContents=function(t,n){return(0,y.mG)(this,void 0,void 0,function(){var o,a,c;return(0,y.Jh)(this,function(S){switch(S.label){case 0:return t&&t.doCommit&&!_.isEmpty(t.newExpression)?(a=t.newExpression,c=this.getName(t.newName,o=n.queryName),[4,this.lazyScopeProvider.get(Yt.w)]):[3,3];case 1:return[4,S.sent().updateVisualCalculation(this.visualContainer,c,a,o,n.calculationInfo.isNew)];case 2:S.sent(),S.label=3;case 3:return[2]}})})},e.prototype.tryRemoveUnchangedNewCalculation=function(t,n){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(a){switch(a.label){case 0:return!n.calculationInfo.isNew||!t||t.doCommit&&_.isEmpty(t.newInvalidFormula)&&!_.isEmpty(t.newExpression)?[3,3]:[4,this.lazyScopeProvider.get(Yt.w)];case 1:return[4,a.sent().removeVisualCalculation(this.visualContainer,n.queryName)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},e.prototype.getName=function(t,n){if(_.isEmpty(t)){var o=(0,Bt.Xf)(this.visualContainer);return Mt.Fo(o,n)}return t},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275inject(Ui),i.\u0275\u0275inject(ln),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(Gi.J),i.\u0275\u0275inject(kn.H),i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(sn.r),i.\u0275\u0275inject(i.NgZone))},e.\u0275prov=i.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(Li)},zi=E(78384),Wi={provide:An,useClass:function(){function r(e){this.canvasZoomService=e}return r.prototype.getZoomLevel=function(){var e=this.canvasZoomService.getCurrentZoomLevel();return q.fF.assert(function(){return e>0},"ZoomLevel should greater than 0"),this.canvasZoomService.getCurrentZoomLevel()},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(zi.w))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}()},Qi=E(68405),Zi=E(13080),Un=E(49642),Xi=E(58295),Ht=function(r){return r[r.None=0]="None",r[r.Rows=1]="Rows",r[r.Columns=2]="Columns",r}({}),Ji=function(){function r(e){this.selects=e,this.containsRows=!1,this.containsColumns=!1,this.referencedItems=new Set}return r.prototype.withRestartToken=function(e){return this},r.prototype.withPrimaryWindowExpansion=function(e){return this},r.prototype.withDataVolume=function(e){return this},r.prototype.withIncludeEmptyGroups=function(e){return this},r.prototype.withHighlightFilter=function(e){return this},r.prototype.withGroupBy=function(e){return this},r.prototype.withPrimaryGrouping=function(e,t,n,o,a,c){return this.containsValidAxisGroup(e)&&(this.containsRows=!0),this},r.prototype.withPrimaryGroupingNestedByRole=function(e,t,n,o,a,c,g){return this.withPrimaryGrouping(e,t,n,o,a,c)},r.prototype.withPrimaryExpansion=function(e){return this},r.prototype.withPrimarySynchronization=function(e){return this},r.prototype.withPrimaryGroupingNested=function(e,t,n,o,a){return this.containsValidAxisGroup(e)&&(this.containsRows=!0),this},r.prototype.withSecondaryGrouping=function(e,t,n,o,a){return this.containsValidAxisGroup(e)&&(this.containsColumns=!0),this},r.prototype.withSecondaryGroupingNestedByRole=function(e,t,n,o,a,c){return this.withSecondaryGrouping(e,t,n,o,a)},r.prototype.withSecondaryExpansion=function(e){return this},r.prototype.withSecondaryGroupingNested=function(e,t,n,o,a){return this.containsValidAxisGroup(e)&&(this.containsColumns=!0),this},r.prototype.withCurrentInnermostGrouping=function(e,t,n){return this},r.prototype.withCurrentInnermostPrimaryGrouping=function(e,t,n,o){return this},r.prototype.withPrimaryDataReduction=function(e){return this},r.prototype.withScopedDataReduction=function(e,t){return this},r.prototype.withSecondaryDataReduction=function(e){return this},r.prototype.withIntersectionDataReduction=function(e){return this},r.prototype.withTopLevelAggregates=function(e){return this},r.prototype.withAdditionalProjections=function(e){return this},r.prototype.withRolesWithHierarchicalGroupingSupport=function(e){return this},r.prototype.toQueryShape=function(e){var t=Ht.None;return this.containsRows&&(t|=Ht.Rows),this.containsColumns&&(t|=Ht.Columns),t},r.prototype.containsValidAxisGroup=function(e){if(_.isEmpty(e))return!1;for(var t=0,n=e;t<n.length;t++){var o=n[t];if(this.referencedItems.has(o.queryName))return!0;var a=(0,Ft.rC)(this.selects,o.queryName);if(!(0,Xi.k)(a.expr))return this.referencedItems.add(o.queryName),!0}return!1},r}(),Vn=E(453),qi=E(29866),$i=E(39665),eo=E(99199),to=E(13702),no=E(906),io={provide:on,useClass:function(){function r(e,t,n,o,a,c,g,S,x,F,G){this.visualCalcEagerService=e,this.featureSwitchService=t,this.localizationService=n,this.telemetryService=o,this.visualPluginService=a,this.conceptualSchemaProxy=c,this.dataSources=g,this.displayNameService=S,this.sortService=x,this.transformPluginService=F,this.dataReaders=G}return r.prototype.setVisualContainer=function(e){this.visualContainer=e},r.prototype.init=function(e){},r.prototype.reset=function(){},r.prototype.getCalculationObject=function(){return this.findCalculationObject()},r.prototype.findCalculationObject=function(e){var t=this.visualCalcEagerService.getCurrentEditingContext();if(null==t)return{name:"",expression:"",calculationType:be.VisualCalculation,calculationSyntaxType:Fe.Formula};var n=t.calculationInfo.isNew,o=(0,Bt.Xf)(this.visualContainer),a=Mt.zd(o,t);return{name:Mt.Fo(o,t.queryName),expression:a,calculationType:be.VisualCalculation,calculationSyntaxType:Fe.Formula,isNew:n}},r.prototype.getDaxModeConfigInputs=function(e){return(0,y.mG)(this,void 0,void 0,function(){var t,n,o,a;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return t=this.visualCalcEagerService.getCurrentEditingContext(),n=(0,Bt.Xf)(this.visualContainer),o=Mt.Oq(n,t?.queryName),[4,this.getVisualAxes()];case 1:return a=c.sent(),[2,{serializableModel:Mt.qN(o),wireDataSourceInfo:e,axes:a}]}})})},r.prototype.getVisualAxes=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,t,n,o,a,c,g,S,x,F,G,ae,le,ue,Te,De;return(0,y.Jh)(this,function(Xe){switch(Xe.label){case 0:return t=(e=this.visualContainer.config.singleVisual).visualType,n={displayNameService:this.displayNameService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,sortService:this.sortService,telemetryService:this.telemetryService,transformPluginService:this.transformPluginService,visualPluginService:this.visualPluginService},o=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(o)];case 1:return a=Xe.sent(),c=(0,Qi.W5)(o,e.query&&e.query.defn),_.isEmpty(c)?[2,[]]:(g=this.dataReaders.queryGenerator(c),S=this.visualPluginService.capabilities(e.visualType).visualShapeDataViewMappings,!(x=(0,Vn.p0)(e,t,a,g,n,void 0,S,void 0,_.noop))||x.error?[2,[]]:(F=x.compiled)?(G=(0,Vn.Go)(F.mappings),le=(0,Un.Jz)(ae=F.query.defn),ue=(0,Zi.lr)(G,le),Te=ae.select(),De=(0,Un.cd)(function(){return new Ji(Te)},le,ue.mapping,Te,F.additionalProjections),[2,this.convertVisualAxesTypesToStringArray(De)]):[2,[]])}})})},r.prototype.convertVisualAxesTypesToStringArray=function(e){var t=[];return e&Ht.Rows&&t.push("ROWS"),e&Ht.Columns&&t.push("COLUMNS"),t},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(I.vZ),i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(H.y0),i.\u0275\u0275inject(qi.D),i.\u0275\u0275inject(V.i),i.\u0275\u0275inject(j.D),i.\u0275\u0275inject(to.O),i.\u0275\u0275inject(no.K),i.\u0275\u0275inject($i.y),i.\u0275\u0275inject(eo.A))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}()},oo=E(56083),Gn=function(){function r(e,t){this.localizationService=e,this.tutorialService=t}return r.prototype.showTutorial=function(){var e=this.createVisualCalcTutorial();this.tutorialService.startTutorial(e)},r.prototype.createVisualCalcTutorial=function(){var e,t="VisualCalcTemplateButton",n="VisualCalcEditInFormulaBar";return{itemKeys:[t,n],items:(e={},e[t]=this.createTemplateModelItem(t),e[n]=this.createFormulaBarModelItem(n),e),isSequentialTutorial:!0}},r.prototype.createTemplateModelItem=function(e){var t='[data-unique-id="formula-bar-template-button"]';return{title:this.localizationService.get("VisualCalcTeachingCallout_Template_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_Template_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:e,canShow:function(){return!!$(t)},attachTo:function(){return $(t)},preferredOrientation:"right",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},r.prototype.createFormulaBarModelItem=function(e){var t=".formulaBarEditorContainer";return{title:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:e,canShow:function(){return!!$(t)},attachTo:function(){return $(t)},arrowOffset:{top:0,left:500},offset:{top:0,left:-500},preferredOrientation:"bottom",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(ce.o),i.\u0275\u0275inject(oo.yU))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),ao=E(11934),so=E(19086),uo="padding-left",co="padding-right",fo="padding-top",ho="padding-bottom",po="margin-left",go="margin-right",mo="margin-top",vo="margin-bottom",yo="border-left-width",Co="border-right-width",bo="border-top-width",Eo="border-bottom-width";function Yn(r,e){return 1===e?parseInt(r.css(uo),10)+parseInt(r.css(co),10):parseInt(r.css(fo),10)+parseInt(r.css(ho),10)}function un(r,e){return 1===e?parseInt(r.css(po),10)+parseInt(r.css(go),10):parseInt(r.css(mo),10)+parseInt(r.css(vo),10)}function Hn(r,e){return 1===e?parseInt(r.css(yo),10)+parseInt(r.css(Co),10):parseInt(r.css(bo),10)+parseInt(r.css(Eo),10)}function zn(r){return parseInt(r.css("minWidth"),10)}function Kn(r,e,t){for(var n=un(r,t),o=$("html")[0],a=r.parent();a.length>0&&a[0]!==o&&a[0]!==e[0];)n=n+Yn(a,t)+Hn(a,t)+un(a,t),a=a.parent();return a[0]===e[0]?n=n+Yn(a,t)+Hn(a,t):0}var et=E(26124),xo=E(55863),Ro=E(59017),wo=(new i.InjectionToken("FormulaBarInteraction"),E(37272)),Wn=function(){function r(){this.isValid=!1}return r.prototype.registerFormulaBarInteractionControl=function(e){this.formulaBarStorageControl=e,this.isValid=!0},r.prototype.focus=function(){this.isValid&&this.formulaBarStorageControl.focus()},r.prototype.copy=function(){this.isValid&&(this.formulaBarStorageControl.focus(),this.formulaBarStorageControl.copy())},r.prototype.cut=function(){this.isValid&&(this.formulaBarStorageControl.focus(),this.formulaBarStorageControl.cut())},r.prototype.paste=function(e){this.isValid&&this.formulaBarStorageControl.paste(e)},r.prototype.show=function(){this.isValid&&this.formulaBarStorageControl.show()},Object.defineProperty(r.prototype,"editMode$",{get:function(){return this.isValid?this.formulaBarStorageControl.editMode$:wo.E},enumerable:!1,configurable:!0}),r.prototype.setEditMode=function(e){this.isValid&&this.formulaBarStorageControl.setEditMode(e)},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)},providedIn:"root"}),r}(),Ao=E(59968),Qn=E(36858),Do=E(45916),No=E(698),Fo=E(35756),Zn=E(20551),Bo=E(64716),Lo=E(85721),_t=E(41114),Xn="PBI.FormulaBar.EditFormulaBarObject",Jn=(_t.cx[Xn]=(0,_t.b1)(Xn),"PBI.FormulaBar.SubmitDynamicFormatString"),qn=(_t.cx[Jn]=(0,_t.b1)(Jn),"PBI.FormulaBar.SelectTemplate"),jo=_t.cx[qn]=(0,_t.b1)(qn),$n=E(64560),_o=E(25512),ko=E(5467);function Uo(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",1),i.\u0275\u0275listener("click",function(o){i.\u0275\u0275restoreView(t);var a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.showTemplatesMenu(o))}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275element(2,"tri-svg-icon",2),i.\u0275\u0275elementEnd()}2&r&&i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(1,1,"Visual_Calculation_Template_Button_Tooltip"))}var Vo=function(r){function e(t,n,o,a){var c=r.call(this)||this;return c.elementRef=t,c.pbiMenuService=n,c.localizationService=o,c.telemetryService=a,c.selectedTemplate=new i.EventEmitter,c.showButton$=new wt.X(!1),c}return(0,y.ZT)(e,r),e.prototype.ngOnInit=function(){var t=this;this.changes$("daxTemplates").pipe((0,Et.R)(this.onDestroy$)).subscribe(function(n){t.createTemplateMenu(n)})},e.prototype.showTemplatesMenu=function(t){var n=this;t.preventDefault();var o=this.templatingMenu;null!=o&&0!==o.items.length&&this.pbiMenuService.open({menu:o,origin:this.elementRef.nativeElement,flexibleConnectedPositions:[(0,_o.Oq)(0,0)],closeOnButtonClick:!0,menuMode:$n.Kb.Compact}).onButtonClick$.pipe((0,pe.q)(1)).subscribe(function(c){var g=c.data;n.selectedTemplate.emit(g),n.telemetryService.logEvent(jo,{templateName:g.capabilities.name})})},e.prototype.createTemplateMenu=function(t){var n=this,o=_.map(t,function(a){var c=a.capabilities;return{type:$n.iB.Button,id:c.name,text:(0,He.G)(c.displayName,n.localizationService),tooltip:(0,He.G)(c.description,n.localizationService),data:a}});this.templatingMenu={items:o},this.showButton$.next(o.length>0)},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(ko.o),i.\u0275\u0275directiveInject(ce.o),i.\u0275\u0275directiveInject(H.y0))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["template-button"]],inputs:{daxTemplates:"daxTemplates"},outputs:{selectedTemplate:"selectedTemplate"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","templateButton","tabindex","0",3,"pbiTooltip","click",4,"ngIf"],["tabindex","0",1,"templateButton",3,"pbiTooltip","click"],["tri-svg-icon-24","","name","math_formula_20_regular","sprite","visual-calc-icons"]],template:function(n,o){1&n&&(i.\u0275\u0275template(0,Uo,3,3,"button",0),i.\u0275\u0275pipe(1,"async")),2&n&&i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(1,1,o.showButton$))},dependencies:[R.NgIf,Qn.V,nn.M,R.AsyncPipe,rn.F],styles:[".templateButton[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:24px;background-color:transparent}.templateButton[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2)}.templateButton[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground1Hover)}.templateButton[_ngcontent-%COMP%]:hover   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Hover)}.templateButton[_ngcontent-%COMP%]:active   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Pressed)}"]}),e}(Bn.w),Go=["monacoEditorHostContainer"];function Yo(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"monaco-editor-host",21),i.\u0275\u0275listener("initialized",function(){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onMonacoEditorInitialized())})("tabFocusMode",function(c){i.\u0275\u0275restoreView(t);var g=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(g.onTabFocusModeChanged(c))})("onContentChanged",function(c){i.\u0275\u0275restoreView(t);var g=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(g.onContentChanged(c))})("onContentHeightChanged",function(c){i.\u0275\u0275restoreView(t);var g=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(g.onContentHeightChanged(c))})("onFocus",function(){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onEditorFocus())}),i.\u0275\u0275elementEnd()}if(2&r){var n=e.ngIf,o=i.\u0275\u0275nextContext();i.\u0275\u0275property("selection",o.editorHost.selection)("isReadOnly",o.isReadOnly)("formulaText",o.editorHost.text)("languageOptions",n)("hidden",!o.isEditorEnabled)}}function Ho(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",22),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);var o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.toggleTabMovesFocus())}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275elementEnd()}2&r&&i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(1,1,"Tab_Moves_Focus_Toggle"))}function zo(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"div",23),i.\u0275\u0275element(1,"pbi-svg-use-symbol",24)(2,"tri-svg-icon",25)(3,"textarea",26),i.\u0275\u0275elementEnd()),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",t.alertText)("ngModel",t.alertText),i.\u0275\u0275attribute("aria-label",t.alertText)}}function Ko(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"tri-dropdown-trigger"),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"localize"),i.\u0275\u0275pipe(3,"async"),i.\u0275\u0275elementEnd()),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,1,i.\u0275\u0275pipeBind1(3,3,t.selectedEditModeOption$).displayName)," ")}}function Wo(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"tri-dropdown-item",27),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"localize"),i.\u0275\u0275elementEnd()),2&r){var t=e.$implicit;i.\u0275\u0275property("value",t),i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,2,t.displayName)," ")}}var er="monaco-editor-host",tr=".formulaBarButtons",nr=".formulaBarController",$o=[".formulaBarEditorContainer",tr,"ribbon [data-unique-id='clipboardGroupMlr'], ribbon [data-unique-id='clipboardGroupSlr'], .ms-Callout #FlyoutMenuId","ribbon [data-automation-type='RibbonTab'][data-unique-id='home']"],ea=function(){function r(e,t,n,o,a,c,g,S,x){var F=this;this.element=e,this.highContrastCssGenerationService=t,this.formulaBarService=n,this.localizationService=o,this.screenReaderService=a,this.formulaBarInteractionService=c,this.cdr=g,this.daxCapabilitiesService=S,this.formulaBarZoomService=x,this.catchOutsideClickEventCallBack=function(G){return!1},this.implicitEndEditingOnBlur=!0,this.navMode="Group",this.daxTemplates=[],this.beginEdit=new i.EventEmitter,this.endEdit=new i.EventEmitter,this.templateSelected=new i.EventEmitter,this.editorHost={},this.formulaBarDropdownConfigurations=[],this.destroy$=new qt.xQ,this._dropdownOptions$=new wt.X(void 0),this._dropdownVisible$=new wt.X(!1),this._selectedEditModeOption$=new wt.X(void 0),this.onDocumentMouseDownCapture=function(G){F.lastCapturedMousedownEvent=G,cn(G.target)||F.formulaBarService.hasUnsavedChanges(F.getCurrentEditorText())&&G.stopImmediatePropagation()},this.onDocumentClickCapture=function(G){var ae=F.lastCapturedMousedownEvent&&F.lastCapturedMousedownEvent.target;F.lastCapturedMousedownEvent=void 0;var le=!ae||cn(ae),ue=cn(G.target);le||ue||F.catchOutsideClickEventCallBack(G)||(F.formulaBarService.hasUnsavedChanges(F.getCurrentEditorText())&&(G.stopPropagation(),G.preventDefault()),F.onBlur())},this.triDropdownOptions={panelClass:"formulaBarDropdownPanel"},this.expandedState=1,this.languageOptions$=(0,J.D)(this.daxCapabilitiesService.getCapabilities())}return Object.defineProperty(r.prototype,"selectedEditModeOption$",{get:function(){return this._selectedEditModeOption$},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"editMode$",{get:function(){return this._selectedEditModeOption$.pipe((0,jn.x)(),(0,fe.U)(function(t){return t?.key}))},enumerable:!1,configurable:!0}),r.prototype.setEditMode=function(e){var t=this.formulaBarDropdownConfigurations.findIndex(function(n){return n.key===e});(0,xo.hu)(t>-1,"Invalid calculation edit mode"),this._selectedEditModeOption$.next(this.formulaBarDropdownConfigurations[t])},Object.defineProperty(r.prototype,"editModeOptions$",{get:function(){return this._dropdownOptions$.asObservable()},enumerable:!1,configurable:!0}),r.prototype.setEditModeOptions=function(e){this._dropdownOptions$.next(e),this._selectedEditModeOption$.next(void 0)},Object.defineProperty(r.prototype,"showEditModeSelector$",{get:function(){return this._dropdownVisible$.asObservable()},enumerable:!1,configurable:!0}),r.prototype.showEditModeSelector=function(e){this._dropdownVisible$.next(e)},r.prototype.ngOnInit=function(){return(0,y.mG)(this,void 0,void 0,function(){var e=this;return(0,y.Jh)(this,function(t){switch(t.label){case 0:return this.initializeHighContrastRules(),this.isHidden=this.autoHide,this.setReadOnly(!0),(0,Ro.aj)([this._dropdownOptions$,this._dropdownVisible$]).pipe((0,Et.R)(this.destroy$)).subscribe(function(n){var a=n[1];e.formulaBarDropdownConfigurations=n[0],e.formulaDropdownWidth=a?zn($(".dropdownContainer")):0,e.recalculateOffset(),e.onResize()}),[4,this.formulaBarService.setUICulture()];case 1:return t.sent(),[2]}})})},r.prototype.ngAfterViewInit=function(){var e=this;this.formulaBarService.registerFormulaBarControl(this),this.formulaBarInteractionService.registerFormulaBarInteractionControl(this),this.resizeObserver=new ResizeObserver(function(){window.requestAnimationFrame(function(){e.onResize()})}),this.resizeObserver.observe(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass))},r.prototype.ngOnDestroy=function(){$(this.element.nativeElement).off(nr),$(this.monacoEditorHostContainer.nativeElement).off(nr),this.destroy$.next(),this.destroy$.complete(),this.resizeObserver&&(this.resizeObserver.unobserve(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass)),this.resizeObserver.disconnect())},r.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert, formula-bar .formulaBar .formulaBarAlert .messageAlert","{ background-color: @backgroundColor !important; color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert","{ border: 1px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarEditorContainer","{ background-color: @backgroundColor !important; }")},Object.defineProperty(r.prototype,"willCollapse",{get:function(){return 0===this.nextExpandCollapseState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isEditorEnabled",{get:function(){return!!this.lastCommittedFormulaText||this.isEditing},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"formulaBarExpanderTooltip",{get:function(){var t,n="Formula_Bar_ExpandToFull";switch(this.nextExpandCollapseState){case 0:n="Formula_Bar_CollapseToSingleLine";break;case 1:n="Formula_Bar_ExpandToFit";break;case 2:n=null!==(t=this.expandCollapseConfig.fullyExpandedTooltip)&&void 0!==t?t:"Formula_Bar_ExpandToFull"}return this.localizationService.get(n)},enumerable:!1,configurable:!0}),r.prototype.setReadOnly=function(e){this.isReadOnly=e},r.prototype.onMonacoEditorInitialized=function(){return(0,y.mG)(this,void 0,void 0,function(){var e,t,n;return(0,y.Jh)(this,function(o){switch(o.label){case 0:return this.monacoEditorInitialized=!0,e=$(this.element.nativeElement),t=function(r){return parseInt(r.css("min-height"),10)}(e),n=function(r){return parseInt(r.css("max-height"),10)}(e),this.monacoEditorUtility=new Cn(this.textEditorHost.textEditor),[4,this.textEditorHost.registerActions(this.getKeyboardActions())];case 1:return o.sent(),this.textEditorHeightOffset=this.calculateTextEditorHeightOffset(),this.recalculateOffset(),this.textEditorFullExpandHeight=n-this.textEditorHeightOffset,this.textEditorCollapsedHeight=t-this.textEditorHeightOffset,this.targetEditorHeight=this.textEditorCollapsedHeight,this.onContentHeightChanged(this.textEditorHost.textEditor.getContentHeight()),this.onResize(),this.focusOnInitialized&&this.focus(),[2]}})})},r.prototype.calculateTextEditorHeightOffset=function(){var e=$(this.element.nativeElement);return Kn(e.find(er),e,0)},r.prototype.onTabFocusModeChanged=function(e){this.tabMovesFocus=e},r.prototype.updateEditorExpandedHeight=function(){var e,t,n=this.alertText?20:0,o=this.expandCollapseConfig.formulaBarParentClass,a=null!==(e=this.expandCollapseConfig.expandScaleFactor)&&void 0!==e?e:1,c=null!==(t=this.expandCollapseConfig.expandOffet)&&void 0!==t?t:-80,g=a*$(this.element.nativeElement).closest(o).height()+c;this.textEditorFullExpandHeight=g-this.textEditorHeightOffset-n},r.prototype.updateFormulaBarMaxHeight=function(){var e=this.alertText?20:0,t=1e7;0===this.expandedState?t=this.textEditorCollapsedHeight+this.textEditorHeightOffset+e:1===this.expandedState&&(t=this.targetEditorHeight+this.textEditorHeightOffset+e),q.fF.assertValue(t,"maxHeight"),$(this.element.nativeElement).css("max-height",t)},r.prototype.show=function(){this.isHidden&&(this.isHidden=!1,this.cdr.detectChanges())},r.prototype.hide=function(){this.isHidden||(this.isHidden=!0)},r.prototype.clear=function(){this.setCommittedFormulaBarText(""),this.autoHide&&this.hide()},r.prototype.setSelection=function(e){this.editorHost.selection=e,this.cdr.detectChanges()},r.prototype.showAlertMessage=function(e){e=e.replace(/\n/g,""),this.alertText=e,this.screenReaderService.alert(this.localizationService.format("Formula_Bar_Warning_Aria",e)),this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},r.prototype.toggleTabMovesFocus=function(){this.textEditorHost.toggleTabMovesFocus(),this.textEditorHost.focus()},r.prototype.hideAlert=function(){this.alertText=void 0,this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},r.prototype.setCommittedFormulaBarText=function(e){this.lastCommittedFormulaText=e,this.editorHost.text=e,this.cdr.detectChanges()},r.prototype.focus=function(){this.monacoEditorInitialized?(this.textEditorHost.focus(),this.cdr.detectChanges()):this.focusOnInitialized=!0},r.prototype.scrollTop=function(){this.monacoEditorInitialized&&this.textEditorHost.scrollTop()},r.prototype.copy=function(){this.textEditorHost.copy()},r.prototype.cut=function(){this.textEditorHost.cut()},r.prototype.paste=function(e){this.textEditorHost.paste(e)},r.prototype.resetModelTokens=function(e){this.textEditorHost.resetModelTokens(e)},r.prototype.isFormulaBarActive=function(){return this.isActive},r.prototype.onToggleExpandCollapse=function(){this.setExpandCollapseState(this.nextExpandCollapseState)},r.prototype.setExpandCollapseState=function(e){switch(e){case 0:this.collapse();break;case 1:this.fitToContent();break;case 2:this.fullExpand()}this.calculateNextExpandCollapseState()},r.prototype.calculateNextExpandCollapseState=function(){switch(this.expandedState){case 0:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?2:1;break;case 1:this.nextExpandCollapseState=this.editorContentHeight>=this.textEditorFullExpandHeight?0:this.editorContentHeight<=this.textEditorCollapsedHeight||this.isEditing?2:0;break;case 2:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?1:0;break;default:q.fF.assertNever(this.expandedState)}},r.prototype.fullExpand=function(){this.expandedState=2,this.updateEditorExpandedHeight(),this.layout(void 0,this.textEditorFullExpandHeight)},r.prototype.fitToContent=function(){this.expandedState=1,this.updateEditorExpandedHeight(),this.targetEditorHeight=Math.max(this.textEditorCollapsedHeight,Math.min(this.textEditorFullExpandHeight,this.editorContentHeight)),this.layout(void 0,this.targetEditorHeight)},r.prototype.collapse=function(){this.expandedState=0,this.layout(void 0,this.textEditorCollapsedHeight)},r.prototype.layout=function(e,t){this.updateFormulaBarMaxHeight(),this.monacoEditorInitialized&&this.textEditorHost.layout(e,t)},r.prototype.recalculateOffset=function(){var e,t=$(tr),n=$(this.element.nativeElement),o=n.find(er);this.textEditorWidthOffset=Kn(o,n,1)+zn(t)+un(t,1)+(null!==(e=this.formulaDropdownWidth)&&void 0!==e?e:0)},r.prototype.commitFormulaBarEdit=function(){return(0,y.mG)(this,void 0,void 0,function(){var e;return(0,y.Jh)(this,function(t){switch(t.label){case 0:return this.endFormulaEdit(),(e=this.getCurrentEditorText())===this.lastCommittedFormulaText?[3,2]:(this.lastCommittedFormulaText=e,[4,this.formulaBarService.onSubmit(e)]);case 1:return t.sent(),[3,4];case 2:return[4,this.formulaBarService.onSubmit(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},r.prototype.onBlur=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return this.implicitEndEditingOnBlur?this.endFormulaEdit():(this.removeFocus(),this.removeCatchClickOutsideFormulaBar()),this.lastCommittedFormulaText=this.monacoEditorInitialized?this.getCurrentEditorText():"",[4,this.formulaBarService.onBlur(this.lastCommittedFormulaText)];case 1:return[2,e.sent()]}})})},r.prototype.removeFocus=function(){$(document.activeElement).blur(),$(document.body).focus()},r.prototype.onContentChanged=function(e){var t=this.monacoEditorUtility.getCursorPosition();this.formulaBarService.onContentChanged(this.monacoEditorUtility.getEditorText(),t.position,t.selectionStart,e)},r.prototype.onContentHeightChanged=function(e){this.editorContentHeight=e+2,(1===this.expandedState||0===this.expandedState&&this.isEditing)&&this.fitToContent(),this.calculateNextExpandCollapseState()},r.prototype.submit=function(){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(e){switch(e.label){case 0:return[4,this.commitFormulaBarEdit()];case 1:return e.sent(),[2]}})})},r.prototype.cancel=function(){this.endFormulaEdit(),this.formulaBarService.onCancel(this.lastCommittedFormulaText),this.autoHide&&this.hide()},r.prototype.onEditorFocus=function(){this.isEditorEnabled&&(this.isReadOnly||this.isEditing?this.implicitEndEditingOnBlur||this.catchClickOutsideFormulaBar():this.beginFormulaEdit(),this.formulaBarService.onEditorFocus())},r.prototype.catchClickOutsideFormulaBar=function(){document.body.addEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.addEventListener("click",this.onDocumentClickCapture,!0),document.body.addEventListener("contextmenu",this.onDocumentClickCapture,!0)},r.prototype.removeCatchClickOutsideFormulaBar=function(){document.body.removeEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.removeEventListener("click",this.onDocumentClickCapture,!0),document.body.removeEventListener("contextmenu",this.onDocumentClickCapture,!0)},r.prototype.endFormulaEdit=function(){this.isEditing=!1,this.removeFocus(),this.removeCatchClickOutsideFormulaBar(),this.endEdit.emit()},r.prototype.beginFormulaEdit=function(){this.isEditing=!0,this.catchClickOutsideFormulaBar(),this.beginEdit.emit()},r.prototype.onResize=function(){var e,t;if(this.monacoEditorInitialized){var n;2===this.expandedState?(this.updateEditorExpandedHeight(),n=this.textEditorFullExpandHeight):1===this.expandedState&&(this.updateEditorExpandedHeight(),n=Math.min(this.textEditorFullExpandHeight,this.targetEditorHeight));var o=this.element.nativeElement.getBoundingClientRect().width||1e3,a=null!==(t=null===(e=this.formulaBarZoomService)||void 0===e?void 0:e.getZoomLevel())&&void 0!==t?t:1;this.layout(o/a-this.textEditorWidthOffset,n)}},r.prototype.selectTemplate=function(e){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(t){switch(t.label){case 0:return[4,this.formulaBarService.onTemplateSelection(e)];case 1:return t.sent(),this.templateSelected.emit(),[2]}})})},r.prototype.insertTextAtCurrentCursor=function(e){this.textEditorHost.insertTextAtCurrentCursor(e)},r.prototype.getCurrentEditorText=function(){return this.textEditorHost.getText()},r.prototype.getHighlightedText=function(){return this.textEditorHost.getHighlightedText()},r.prototype.getKeyboardActions=function(){var e=this;return[{id:"formulaBar.find",label:"Find",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlF]],run:_.noop},{id:"formulaBar.findNext",label:"Find next",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.F3]],run:_.noop},{id:"formulaBar.findPrevious",label:"Find previous",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlF3]],run:_.noop},{id:"formulaBar.replace",label:"Replace",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlH]],run:_.noop},{id:"formulaBar.errorNavigator",label:"Error navigator",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.F8]],run:_.noop},{id:"formulaBar.escape",label:"Escape",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.Escape]],run:function(){var n=e.textEditorHost.textEditor.getSelections();n.length<=1?e.cancel():e.textEditorHost.textEditor.setSelection(n[0])},keybindingContext:"!".concat(vn,"&&!").concat(yn,"&&!").concat("parameterHintsVisible")},{id:"formulaBar.submit",label:"Submit",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlEnter]],run:function(){e.submit()}},{id:"formulaBar.enter",label:"Enter",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.Enter]],run:function(){e.submit()},keybindingContext:"!".concat(yn)},{id:"formulaBar.toggleExpandCollapse",label:"Toggle expand collapse",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlJ]],run:function(){e.onToggleExpandCollapse()}}]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(bn.g),i.\u0275\u0275directiveInject(Nn),i.\u0275\u0275directiveInject(ce.o),i.\u0275\u0275directiveInject(Dn.g),i.\u0275\u0275directiveInject(Wn),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(sn.r),i.\u0275\u0275directiveInject(An,8))},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["formula-bar"]],viewQuery:function(t,n){if(1&t&&(i.\u0275\u0275viewQuery(Go,7,i.ElementRef),i.\u0275\u0275viewQuery(Qt,5)),2&t){var o=void 0;i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.monacoEditorHostContainer=o.first),i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.textEditorHost=o.first)}},hostVars:1,hostBindings:function(t,n){1&t&&i.\u0275\u0275listener("desktopUIResizeFormulaBar",function(){return n.onResize()}),2&t&&i.\u0275\u0275hostProperty("hidden",n.isHidden)},inputs:{autoHide:"autoHide",isActive:"isActive",catchOutsideClickEventCallBack:"catchOutsideClickEventCallBack",expandCollapseConfig:"expandCollapseConfig",implicitEndEditingOnBlur:"implicitEndEditingOnBlur",navMode:"navMode",shouldAlwaysEnableCancelButton:"shouldAlwaysEnableCancelButton",daxTemplates:"daxTemplates"},outputs:{beginEdit:"beginEdit",endEdit:"endEdit",templateSelected:"templateSelected"},decls:29,vars:42,consts:[["keyboard-shortcuts","ctrl-F6","focus-priority","11",1,"formulaBar",3,"hidden","on-resize"],[1,"formulaBarEditorContainer"],[1,"formulaBarEditor"],["tabindex","0",1,"formulaBarEditorMain",3,"keydown.enter"],["monacoEditorHostContainer",""],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus",4,"ngIf"],["data-unique-id","formula-bar-chevron",1,"formulaBarExpander",3,"disabled","pbiTooltip","click"],["tri-svg-icon-16","","name","chevron_down_16_regular"],[1,"accessibililtyMessages"],["class","message","localize","Tab_Moves_Focus",3,"pbiTooltip","click",4,"ngIf"],["class","formulaBarAlert",4,"ngIf"],[1,"formulaBarDropdown"],[1,"dropdownContainer",3,"compact","options","isDisabled","value","valueChange"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"formulaBarButtons"],["data-unique-id","formula-bar-cancel",1,"formulaBarCancel",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","dismiss_20_regular"],["data-unique-id","formula-bar-commit",1,"formulaBarCommit",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","checkmark_20_regular"],["data-unique-id","formula-bar-template-button",3,"daxTemplates","selectedTemplate"],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus"],["localize","Tab_Moves_Focus",1,"message",3,"pbiTooltip","click"],[1,"formulaBarAlert"],["symbolId","alert","sheet","filterPaneIcons",1,"imageAlert"],["tri-svg-icon-16","","name","dismiss_circle_16_filled"],["data-unique-id","formula-bar-alert","row","1","cols","1","readonly","","pbiTooltipPosition","below",1,"messageAlert",3,"pbiTooltip","ngModel"],[3,"value"]],template:function(t,n){1&t&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275listener("on-resize",function(){return n.onResize()}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275elementStart(2,"div",1)(3,"div",2)(4,"div",3,4),i.\u0275\u0275listener("keydown.enter",function(){return n.focus()}),i.\u0275\u0275template(6,Yo,1,5,"monaco-editor-host",5),i.\u0275\u0275pipe(7,"async"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(8,"button",6),i.\u0275\u0275listener("click",function(){return n.onToggleExpandCollapse()}),i.\u0275\u0275element(9,"tri-svg-icon",7),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(10,"div",8),i.\u0275\u0275template(11,Ho,2,3,"button",9),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(12,zo,4,3,"div",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(13,"div",11),i.\u0275\u0275pipe(14,"async"),i.\u0275\u0275elementStart(15,"tri-dropdown",12),i.\u0275\u0275listener("valueChange",function(a){return n.setEditMode(a.key)}),i.\u0275\u0275pipe(16,"async"),i.\u0275\u0275template(17,Ko,4,5,"tri-dropdown-trigger",13),i.\u0275\u0275pipe(18,"async"),i.\u0275\u0275template(19,Wo,3,4,"tri-dropdown-item",14),i.\u0275\u0275pipe(20,"async"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(21,"div",15)(22,"button",16),i.\u0275\u0275listener("click",function(){return n.cancel()}),i.\u0275\u0275pipe(23,"localize"),i.\u0275\u0275element(24,"tri-svg-icon",17),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(25,"button",18),i.\u0275\u0275listener("click",function(){return n.submit()}),i.\u0275\u0275pipe(26,"localize"),i.\u0275\u0275element(27,"tri-svg-icon",19),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(28,"template-button",20),i.\u0275\u0275listener("selectedTemplate",function(a){return n.selectTemplate(a)}),i.\u0275\u0275elementEnd()()()),2&t&&(i.\u0275\u0275classProp("readonly",n.isReadOnly),i.\u0275\u0275property("hidden",n.isHidden||!n.monacoEditorInitialized),i.\u0275\u0275attribute("focus-nav-mode",n.navMode)("aria-label",i.\u0275\u0275pipeBind1(1,26,"Formula_Bar")),i.\u0275\u0275advance(2),i.\u0275\u0275classProp("hasAlert",n.alertText),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(7,28,n.languageOptions$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("disabled",!n.monacoEditorInitialized||!n.isEditorEnabled)("pbiTooltip",n.formulaBarExpanderTooltip),i.\u0275\u0275advance(1),i.\u0275\u0275property("@chevron",n.nextExpandCollapseState),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.tabMovesFocus&&!n.isReadOnly&&n.isEditorEnabled),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!!n.alertText),i.\u0275\u0275advance(1),i.\u0275\u0275classProp("hideFormulaBarDropdown",!i.\u0275\u0275pipeBind1(14,30,n.showEditModeSelector$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("compact",!0)("options",n.triDropdownOptions)("isDisabled",n.isReadOnly)("value",i.\u0275\u0275pipeBind1(16,32,n.selectedEditModeOption$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(18,34,n.selectedEditModeOption$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",i.\u0275\u0275pipeBind1(20,36,n.editModeOptions$)),i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(23,38,"Cancel_ButtonText"))("disabled",n.shouldAlwaysEnableCancelButton?!n.monacoEditorInitialized:!n.isEditing||!n.monacoEditorInitialized),i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(26,40,"Commit_ButtonText"))("disabled",!n.isEditing||!n.monacoEditorInitialized),i.\u0275\u0275advance(3),i.\u0275\u0275property("daxTemplates",n.daxTemplates))},dependencies:[R.NgForOf,R.NgIf,z.Fj,z.JJ,z.On,Ao.X,Qt,Qn.V,Do.R,No.O,Fo.q,Zn.M3,Bo.l,Lo.q,Zn.ii,nn.M,Vo,R.AsyncPipe,rn.F],styles:['[_nghost-%COMP%]{--read-only-button-foreground: var(--fluent-theme-neutral-secondary-alt-color);--read-only-background: var(--fluent-theme-neutral-tertiary-color);--read-only-border-color: var(--fluent-theme-neutral-tertiary-color);--button-background: transparent;--button-foreground: var(--gray-180);--editor-container-border-color: var(--fluent-theme-neutral-tertia-color);--editor-container-background: var(--fluent-theme-white-color);--expander-foreground-hover: var(--fluent-theme-black-color);--accessibility-message-background: var(--fluent-theme-neutral-primary-color);--accessibility-message-foreground: var(--fluent-theme-white-color);--accessibility-message-background-focus: var(--fluent-theme-neutral-tertiary-alt-color);--alert-foreground: var(--fluent-theme-black-color);--alert-background: var(--fluent-theme-warning-background-color);--alert-border: none;--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--fluent-theme-neutral-tertiary-alt-color);--submit-cancel-buttons-background: var(--fluent-theme-white-color);--cancel-button-foreground: var(--fluent-theme-error-dark-color);--commit-button-foreground: var(--fluent-theme-success-icon-color);--gray-host-background: var(--gray-20);--gray-border-color: var(--gray-60);--gray-read-only-background: var(--gray-20);--gray-read-only-border: var(--gray-40);position:relative;padding:4px;min-height:36px;max-height:36px;width:100%;box-sizing:border-box;display:flex;flex-direction:column}[data-legacy-theming=false]   [_nghost-%COMP%]{--read-only-button-foreground: var(--colorNeutralForegroundDisabled);--read-only-background: var(--colorNeutralBackgroundDisabled);--read-only-border-color: var(--colorNeutralStrokeDisabled);--button-background: transparent;--button-foreground: var(--colorNeutralForeground1);--editor-container-border-color: var(--colorNeutralStroke1);--editor-container-background: var(--colorNeutralBackground1);--expander-foreground-hover: var(--colorNeutralStrokeFocus2);--accessibility-message-background: var(--colorCompoundBrandBackground);--accessibility-message-foreground: var(--colorNeutralForegroundOnBrand);--accessibility-message-background-focus: var(--colorCompoundBrandBackgroundHover);--alert-foreground: var(--colorNeutralForeground1);--alert-background: var(--colorDangerBackground1);--alert-border: 1px solid var(--colorDangerBorder1);--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--colorNeutralStroke1);--submit-cancel-buttons-background: var(--colorNeutralBackground1);--cancel-button-foreground: var(--colorDangerForeground1);--commit-button-foreground: var(--colorSuccessForeground1);--gray-host-background: var(--colorNeutralBackground3);--gray-border-color: var(--colorNeutralStroke2);--gray-read-only-background: var(--colorNeutralBackground3);--gray-read-only-border: var(--colorNeutralStrokeDisabled)}[hidden][_nghost-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]{flex-grow:1;cursor:default;box-sizing:border-box;display:flex}[_nghost-%COMP%]   .formulaBar[hidden][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--read-only-button-foreground)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-color:var(--read-only-border-color);background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursor[_ngcontent-%COMP%]{background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:var(--button-background);color:var(--button-foreground)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:currentcolor}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [disabled][_ngcontent-%COMP%]{opacity:.4}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{order:1;flex-grow:1;height:100%;display:flex;flex-direction:column;margin-left:3px;min-height:28px;box-sizing:border-box;border:1px solid var(--editor-container-border-color);background-color:var(--editor-container-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer.hasAlert[_ngcontent-%COMP%]{min-height:48px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;padding-top:2px;padding-right:21px;display:flex;flex-direction:column;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;background-color:transparent;-webkit-user-select:none}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:16px;height:16px;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus:not(:disabled){color:var(--expander-foreground-hover)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-left:2px;padding:2px;background-color:var(--accessibility-message-background);color:var(--accessibility-message-foreground);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:focus{background-color:var(--accessibility-message-background-focus)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]{width:100%;height:20px;box-sizing:border-box;color:var(--alert-foreground);background-color:var(--alert-background);outline:var(--alert-border);display:flex;padding-left:2px;align-items:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--alert-icon)}[data-legacy-theming=true]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{width:16px;height:16px}[data-legacy-theming=false]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .messageAlert[_ngcontent-%COMP%]{cursor:default;flex-grow:1;height:100%;box-sizing:border-box;border:none;padding-top:2px;padding-left:4px;background-color:var(--alert-background);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:11px;resize:none;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]{margin-right:3px;font-size:14px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown.hideFormulaBarDropdown[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]{min-width:100px;height:28px;box-sizing:border-box}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]     button{min-width:inherit;height:inherit}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]{min-width:76px;flex:0;height:28px;box-sizing:border-box;border:1px solid var(--submit-cancel-buttons-border);display:flex;align-items:center;justify-content:space-evenly;background-color:var(--submit-cancel-buttons-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-content:center;justify-content:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForegroundDisabled)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:disabled){background:var(--colorNeutralBackground1Hover)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--cancel-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--commit-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:none}.gray-theme   [_nghost-%COMP%]{background-color:var(--gray-host-background)}.gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-radius:2px;border-color:var(--gray-border-color)}.gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{background-color:var(--gray-read-only-background);border-color:var(--gray-read-only-border)}@media print{formula-bar[_ngcontent-%COMP%]   .formulaBar[_ngcontent-%COMP%]{display:none}}'],data:{animation:[(0,et.X$)("chevron",[(0,et.SB)("".concat(0),(0,et.oB)({transform:"rotate(180deg)"})),(0,et.SB)("".concat(2),(0,et.oB)({transform:"rotate(0deg)"})),(0,et.SB)("".concat(1),(0,et.oB)({transform:"rotate(0deg)"})),(0,et.eR)("".concat(1," => ").concat(2,", ").concat(2," => ").concat(1),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(0deg)",offset:0}),(0,et.oB)({transform:"rotate(45deg)",offset:.5}),(0,et.oB)({transform:"rotate(0deg)",offset:1})]))]),(0,et.eR)("* => ".concat(0),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(0deg)",offset:0}),(0,et.oB)({transform:"rotate(180deg)",offset:1})]))]),(0,et.eR)("".concat(0," => *"),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(180deg)",offset:0}),(0,et.oB)({transform:"rotate(0deg)",offset:1})]))])])]}}),r}();function cn(r){return _.some($o,function(e){var t=$(r),n=$(e);return n.is(t)||!!n.find(t).length})}var ta=["formulaBar"],na=["detailVisual"];function ra(r,e){if(1&r&&i.\u0275\u0275element(0,"outline-overlay-lazy",8),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275property("regionOutlinesData",t.regionOutlinesData)}}var ia=function(){return{formulaBarParentClass:".visualCalcEditor",expandScaleFactor:.5,expandOffet:0,fullyExpandedTooltip:"Formula_Bar_ExpandToMultiLine"}},oa=function(r){function e(t,n,o,a,c,g,S,x,F){var G=r.call(this)||this;return G.behaviourService=t,G.intellisenseModelService=n,G.featureSwitchService=o,G.visualCalcEagerService=a,G.visualCalcDaxTemplateService=c,G.lazyScopeProvider=g,G.visualCalcTutorialService=S,G.subSelectionOutlineManager=x,G.visualContainerSubSelectionHostServiceFactory=F,G.visualHTMLElementChanged=new i.EventEmitter,G.templateSelected=G.createEventAdapter(),G.visualCalculationTemplates=G.visualCalcDaxTemplateService.getTemplates(),G.enableSubSelection=G.featureSwitchService.featureSwitches.enableCalculationHighlighting,G.enableSubSelection&&(G.subSelectionHostService=G.visualContainerSubSelectionHostServiceFactory.create(),G.regionOutlinesData={regionOutlines$:G.subSelectionOutlineManager.getRegionOutlines$()}),G}return(0,y.ZT)(e,r),Object.defineProperty(e.prototype,"_detailVisualElementRef",{set:function(n){var o=n?.nativeElement,a=o!==this.detailVisualElement;this.detailVisualElement=o,a&&this.visualHTMLElementChanged.emit(o)},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this,n=(0,Rn.T)((0,In.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"click"),(0,In.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"keydown").pipe((0,wn.h)(function(a){return"Enter"===a.key}))),o=(0,Rn.T)(this.visualCalcEagerService.onEditContextChange$(),this.templateSelected.$).pipe((0,Et.R)(this.onDestroy$));this.visualCalcEagerService.onViewContextChanged$().pipe((0,Et.R)(this.onDestroy$),(0,Ci.b)(function(){return Di.IK.focus(t.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"))}),(0,bi.w)(function(){return n.pipe((0,Et.R)(o),(0,pe.q)(1))})).subscribe(function(){return(0,y.mG)(t,void 0,void 0,function(){return(0,y.Jh)(this,function(c){switch(c.label){case 0:return[4,this.lazyScopeProvider.get(Yt.w)];case 1:return[4,c.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Custom")];case 2:return c.sent(),[2]}})})}),this.visualCalcTutorialService.showTutorial()},e.prototype.ngOnInit=function(){var t=this;this.behaviourService.setVisualContainer(this.visualContainer),this.intellisenseModelService.setVisualContainer(this.visualContainer),this.hostServices=this.parentHostServices,this.enableSubSelection&&(this.hostServices=(0,Ni.ED)(this.parentHostServices,function(n){n.getSubSelectionService=function(){return t.getVisualSubSelectionHostService()}}),this.subSelectionOutlineManager.registerVisualContainer(this.visualContainer.name,this.subSelectionHostService.regionOutlines$,"annotation"))},e.prototype.ngOnDestroy=function(){return this.enableSubSelection&&this.subSelectionOutlineManager.deregisterVisualContainer(this.visualContainer.name,"annotation"),r.prototype.ngOnDestroy.call(this)},e.prototype.onRightClick=function(t){t.stopPropagation()},e.prototype.getVisualSubSelectionHostService=function(){var t=this;return{clearAllRegionOutlines:function(){return t.subSelectionHostService.clearAllRegionOutlines()},getAllRegionOutlines:function(){return t.subSelectionHostService.getAllRegionOutlines()},getRegionOutline:function(o){return t.subSelectionHostService.getRegionOutline(o)},updateRegionOutlines:function(o){var a,c,g=null===(a=t.detailVisualComponent)||void 0===a?void 0:a.getVisualComponentBoundingClientRect();g&&t.subSelectionHostService.updateVisualRegionOutlines(o,null===(c=t.detailVisualElement)||void 0===c?void 0:c.getBoundingClientRect(),g,!1)}}},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275directiveInject(an),i.\u0275\u0275directiveInject(on),i.\u0275\u0275directiveInject(I.vZ),i.\u0275\u0275directiveInject(jt.w),i.\u0275\u0275directiveInject(xn),i.\u0275\u0275directiveInject(kn.H),i.\u0275\u0275directiveInject(Gn),i.\u0275\u0275directiveInject(Ln.g),i.\u0275\u0275directiveInject(ao._))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["visual-calc-editor"]],viewQuery:function(n,o){if(1&n&&(i.\u0275\u0275viewQuery(ta,5,i.ElementRef),i.\u0275\u0275viewQuery(na,5,i.ElementRef),i.\u0275\u0275viewQuery(Fn.X,5)),2&n){var a=void 0;i.\u0275\u0275queryRefresh(a=i.\u0275\u0275loadQuery())&&(o.formulaBar=a.first),i.\u0275\u0275queryRefresh(a=i.\u0275\u0275loadQuery())&&(o._detailVisualElementRef=a.first),i.\u0275\u0275queryRefresh(a=i.\u0275\u0275loadQuery())&&(o.detailVisualComponent=a.first)}},inputs:{visualContainer:"visualContainer",themeCollection:"themeCollection",viewport:"viewport",parentHostServices:"parentHostServices",detailVisualSpinnerActionCallback:"detailVisualSpinnerActionCallback"},outputs:{visualHTMLElementChanged:"visualHTMLElementChanged"},features:[i.\u0275\u0275ProvidersFeature([Nn,Hi,Wi,Mi,io,ln,Gn,Ln.g]),i.\u0275\u0275InheritDefinitionFeature],decls:8,vars:16,consts:[["data-automation-type","visualCalcEditor","role","document",1,"visualCalcEditor",3,"contextmenu"],["visualCalcEditor",""],[3,"isActive","autoHide","expandCollapseConfig","implicitEndEditingOnBlur","navMode","shouldAlwaysEnableCancelButton","daxTemplates","templateSelected"],["formulaBar",""],[1,"visualWithOutlinesOverlay"],["data-automation-type","detailVisual",3,"inVisualCalcMode","parentHostServices","visualContainer","themeCollection","viewport","detailVisualSpinnerActionCallback","applyUIThemeToVisualModern"],["detailVisual",""],["class","outlinesOverlayContainer",3,"regionOutlinesData",4,"ngIf"],[1,"outlinesOverlayContainer",3,"regionOutlinesData"]],template:function(n,o){1&n&&(i.\u0275\u0275elementStart(0,"div",0,1),i.\u0275\u0275listener("contextmenu",function(c){return o.onRightClick(c)}),i.\u0275\u0275elementStart(2,"formula-bar",2,3),i.\u0275\u0275listener("templateSelected",function(){return o.templateSelected.fn()}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",4),i.\u0275\u0275element(5,"detail-visual",5,6),i.\u0275\u0275template(7,ra,1,1,"outline-overlay-lazy",7),i.\u0275\u0275elementEnd()()),2&n&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("isActive",!0)("autoHide",!1)("expandCollapseConfig",i.\u0275\u0275pureFunction0(15,ia))("implicitEndEditingOnBlur",!1)("navMode",void 0)("shouldAlwaysEnableCancelButton",!1)("daxTemplates",o.visualCalculationTemplates),i.\u0275\u0275advance(3),i.\u0275\u0275property("inVisualCalcMode",!0)("parentHostServices",o.hostServices)("visualContainer",o.visualContainer)("themeCollection",o.themeCollection)("viewport",o.viewport)("detailVisualSpinnerActionCallback",o.detailVisualSpinnerActionCallback)("applyUIThemeToVisualModern",!0),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",o.enableSubSelection))},dependencies:[R.NgIf,Fn.X,so.P,ea],styles:[".visualCalcEditor[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:visible;flex-grow:1;box-sizing:border-box;border-width:10px 10px 0 10px;border-style:solid;border-color:var(--colorNeutralStroke1);background-color:var(--colorNeutralBackground1)}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]{position:relative;flex-basis:0;flex-grow:1;overflow:hidden;display:flex}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   detail-visual[_ngcontent-%COMP%]{flex:1;height:100%;z-index:0}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   .outlinesOverlayContainer[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;box-sizing:border-box;z-index:1;pointer-events:none;background:transparent}"]}),e}(Bn.w),aa=E(94419),ir=E(46135),la=function(){function r(e,t,n,o,a,c,g,S,x,F,G){this.conceptualSchemaProxy=e,this.dataSources=t,this.vcEagerService=n,this.visualAuthoring=o,this.visibilityService=a,this.panesVisibilityService=c,this.featureSwitchService=g,this.visualAuthoringOperationService=S,this.certifiedEventsService=x,this.telemetryService=F,this.explorationCapabilitiesService=G}return r.prototype.enterVisualCalcMode=function(e,t,n,o){return(0,y.mG)(this,void 0,void 0,function(){var a;return(0,y.Jh)(this,function(g){switch(g.label){case 0:return 16!==e.visibility&&(e.config.singleVisual.autoSelectVisualType=!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return a=g.sent(),[4,this.visualAuthoring.ensureNativeReferenceName(a,e)];case 2:return g.sent(),this.panesVisibilityService.closePane("quickMeasures"),this.featureSwitchService.featureSwitches.onObject&&this.panesVisibilityService.setPaneExpansion("build",!0,!0),_.isEmpty(t)?[4,this.enterVisualCalcEditingModeWithPlaceHolder(e,"Custom",void 0,void 0,n,o)]:[3,4];case 3:return g.sent(),[3,5];case 4:this.vcEagerService.enterEditMode(t,"Custom",!1),g.label=5;case 5:return this.visibilityService.set(e,16),[2]}})})},r.prototype.updateVisualCalculation=function(e,t,n,o,a){return(0,y.mG)(this,void 0,void 0,function(){var c,g,x,F;return(0,y.Jh)(this,function(G){switch(G.label){case 0:return F=(0,Mt.dQ)(e,o),c=F.fieldIndex,g=F.role,q.fF.assert(function(){return c>=0},"Query name of field doesn't exist"),[4,this.visualAuthoring.updateVisualCalculation({visualContainer:e,fieldIndex:c,role:g,name:t,expression:n,shouldUnhide:a,dataType:void 0},a)];case 1:return x=G.sent(),this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:"VisualCalculationSubmitted",activityName:jt.f,activityStatus:"Succeeded",resultCode:"",activityAttributes:{initialCreation:a}}),[2,x]}})})},r.prototype.removeVisualCalculation=function(e,t){return(0,y.mG)(this,void 0,void 0,function(){var n,o,a,c;return(0,y.Jh)(this,function(g){switch(g.label){case 0:return c=(0,Mt.dQ)(e,t),n=c.fieldIndex,o=c.role,q.fF.assert(function(){return n>=0},"Query name of field doesn't exist"),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return a=g.sent(),[2,this.visualAuthoringOperationService.removeFieldFromRole({role:o,projOptions:{fieldIndex:n}},a,e)]}})})},r.prototype.enterVisualCalcEditingModeWithPlaceHolder=function(e,t,n,o,a,c){return(0,y.mG)(this,void 0,void 0,function(){var g,S,x,F,G,ae;return(0,y.Jh)(this,function(le){switch(le.label){case 0:return g=(0,Bt.Xf)(e),S=(0,Mt.ND)(g,o),x=this.dataSources.get(),F=(0,aa.YU)(S,"BLANK()"),G=!1,null==a?[3,2]:[4,this.visualAuthoring.addFieldInRole(F,a,x,e,void 0,void 0,void 0,!0,!0,c)];case 1:return G=le.sent(),[3,4];case 2:return[4,this.visualAuthoring.addFieldToVisual(F,x,e,"VisualCalculationMode",!0,!0,c)];case 3:G=le.sent(),le.label=4;case 4:return G&&(ae=(0,Mt.oG)((0,Bt.Xf)(e),S),this.vcEagerService.enterEditMode(ae,t,!0,n)),[2,G]}})})},r.prototype.getVisualCalcCreationInfo=function(e,t,n){var o,a;return(0,y.mG)(this,void 0,void 0,function(){var c,x;return(0,y.Jh)(this,function(G){switch(G.label){case 0:return c=this.explorationCapabilitiesService.getCapabilities(),c?.disableVisualCalcAuthoring?[2,{supportVisualCalcCreation:!1}]:[4,this.vcEagerService.canSupportVisualCalc(e)];case 1:return G.sent()?(null===(a=null===(o=e?.config)||void 0===o?void 0:o.singleVisual)||void 0===a?void 0:a.autoSelectVisualType)?[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:!(x=_.find(t.dataRoles,function(ae){return ae.name===n}))||x.kind!==ir.DW.Measure&&x.kind!==ir.DW.GroupingOrMeasure?[2,{supportVisualCalcCreation:!1}]:[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:[2,{supportVisualCalcCreation:!1}]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(V.i),i.\u0275\u0275inject(j.D),i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(Mn.$8),i.\u0275\u0275inject(Pn.w),i.\u0275\u0275inject(M.r),i.\u0275\u0275inject(I.vZ),i.\u0275\u0275inject(Y.Q),i.\u0275\u0275inject(H.ly),i.\u0275\u0275inject(H.y0),i.\u0275\u0275inject(k.U))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),ua=[{type:oa,componentId:"VisualCalcEditorComponentId"}],or={provide:"VisualCalcService",useFactory:ar,deps:[V.i,j.D,jt.w,Mn.$8,Pn.w,M.r,I.vZ,Y.Q,H.ly,H.y0,li.t,k.U]};function ar(r,e,t,n,o,a,c,g,S,x,F,G){var ae=new la(r,e,t,n,o,a,c,g,S,x,G);return F.resolve(ae)}var ca=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[or,xn],imports:[R.CommonModule,Z.J,z.u5,te.j,En.N.withManifests(ua),W.v,On.U,si]}),r}()},33565:function(Ke,we,E){E.d(we,{c:function(){return q}});var K,R=E(81337),z=E(68082),H=E(53439),V=E(50423),j=new V.InjectionToken("ViewScopedUserSettingsService"),Y="hideDeleteRelationshipConfirmation",Z=function(he){return he.DeleteModelItem="DeleteModelItem",he}({}),I=E(74611),te=E(50550),ee=E(62458),W=E(65843),i=E(55375);!function(he){var ce="COMMANDS_DELETE_TABLE",Oe="ListJoin_Separator";function Ae(l,v){return(l=l.sort().map(function(L){return'"'+L+'"'})).join(v.get(Oe))}he.getDeleteConfirmationText=function(l,v){var L=(0,te.EB)(l.map(function(Ne){return(0,I.cO)(Ne)?(0,I.d3)(Ne.fromTable.name,Ne.fromColumn.name,Ne.fromCardinality,Ne.toTable.name,Ne.toColumn.name,Ne.toCardinality):Ne.name})).join(v.get(Oe)+" "),J=v.format("DeleteConfirmationMultiple",L);1===l.length&&(J="Relationship"===l[0].objectType?v.get("DeleteRelationshipConfirmationMessage"):"Calendar"===l[0].objectType?v.get("DeleteCalendarConfirmationMessage"):v.format("DeleteMeasurePrompt",L));var fe=function(l,v){for(var L=(0,I.Y3)((0,I.L9)(l),v),J=0,fe=l;J<fe.length;J++){var se=fe[J];if((0,I.t3)(se)&&se.table.refreshPolicy&&"DateTime"===se.dataType){L.push(v.get("IncrementalRefreshPolicy"));break}}return L.filter(function(Re){return!l.find(function(Ne){return Ne.name===Re})})}(l,v);if(0!==fe.length){var se=(0,te.EB)(fe).join(v.get(Oe)+" ");J=v.format(1===fe.length?"DeleteConfirmationWithDependents":"DeleteConfirmationMultipleWithDependents",L,se)}var Ce=function(l){for(var v=new Set,L=0,J=l;L<J.length;L++){var fe=J[L];if((0,I.t3)(fe)){var se=fe,Ce=se.table.description,de=(0,I.aP)(se.table,se),Re=(0,I.q1)(se.table,se);(0,I.oQ)(se.table,Ce,de?.name,Re?.name)&&v.add(se.table.name)}}return Array.from(v)}(l);if(0!==Ce.length){var de=(0,te.EB)(Ce).join(v.get(Oe)+" ");J=J+"<br/><br/>"+v.format("DeleteConfirmationForCuration",de)}return J},he.showConfirmDialogToDeleteTableWithDependents=function(l,v,L,J){return(0,R.mG)(this,void 0,void 0,function(){var fe;return(0,R.Jh)(this,function(de){switch(de.label){case 0:return fe=function(l,v,L){for(var J=new Set,fe=0,se=l;fe<se.length;fe++)J.add(se[fe].name);for(var de=[],Re=[],Ne=0,Ie=Object.keys(v);Ne<Ie.length;Ne++)for(var ke=Ie[Ne],Ue=!1,Ze=0,ct=v[ke];Ze<ct.length;Ze++){var rt=ct[Ze];J.has(rt)||(Ue||(de.push(ke),Ue=!0),Re.push(rt))}if(0!==de.length){ee.fF.assert(function(){return Re.length>0},"If some tables are remaining, there should have dependents remaining as well");var tt=Ae(Re,L);if(1===de.length)return 1===Re.length?L.format("DeleteQueryWithOneDependent",de[0],Re[0]):L.format("DeleteQueryWithMultipleDependents",de[0],tt);var nt=Ae(de,L);return L.format("DeleteQueriesWithMultipleDependents",nt,tt)}}(l,v,L),fe?[4,i.Z.buildOKCancelDialogWithList(L.get(ce),[fe],"deleteTableConfirmationDialog",L.get("ReportModelTableLoadWillBeDisabled"),J,L)]:[2,!0];case 1:return[4,de.sent().afterClosed().toPromise()];case 2:return[2,1===de.sent()]}})})},he.getQueryToDependents=function(l,v){for(var L={},J={},fe=l.dataModelExtendedState.queryDependencyGraph,se=0,Ce=Object.keys(fe);se<Ce.length;se++)for(var de=Ce[se],Ne=0,Ie=fe[de];Ne<Ie.length;Ne++){var ke=Ie[Ne];J[ke]||(J[ke]=new Set),J[ke].add(de)}for(var Ge=0,Ue=v;Ge<Ue.length;Ge++){var Ze=Ue[Ge];J[Ze.name]&&(L[Ze.name]=Array.from(J[Ze.name]))}return L},he.reorderItemsToMinimizeDependencies=function(l,v,L,J){for(var fe=function(l,v){for(var L=[],J=l.length,fe=function(){var Ce=l.length,de=new Set;l.forEach(function(Re){v[Re.name]&&v[Re.name].forEach(function(Ne){return de.add(Ne)})}),L=L.concat(l.filter(function(Re){return!de.has(Re.name)})),l=l.filter(function(Re){return de.has(Re.name)}),Ce===l.length&&ee.fF.assertFail("Unable to calculate table dependencies")};l.length>0;)fe();return J!==(L=L.reverse()).length&&ee.fF.assertFail("ordered table number is not same as the origin number for deletion"),L}(v,L),se=l.filter(function(Ne){return!(0,I.wb)(Ne)}),Ce=[],de=function(){var Ie=new Set((0,I.Y3)((0,I.L9)(se),J)),ke=se.filter(function(Ge){return!Ie.has(Ge.name)});Ce=ke.concat(Ce),se=se.filter(function(Ge){return Ie.has(Ge.name)})};se.length>0;)de();var Re=Ce.concat(fe);return l.length!==Re.length&&ee.fF.assertFail("ordered all item number is not same as the origin number for deletion"),Re},he.createDeleteSchemaChange=function(l){var v=l.objectType;if("Relationship"===v){var L=l;return{relationshipDelete:{fromColumns:[W.X6.getColumnUrn(L.fromTable.name,L.fromColumn.name,L.fromColumn.schemaName)],toColumns:[W.X6.getColumnUrn(L.toTable.name,L.toColumn.name,L.toColumn.schemaName)]}}}if("Level"===v)return{hierarchyLevelDelete:{schema:l.schemaName,entity:l.hierarchy.table.name,hierarchy:l.hierarchy.name,hierarchyLevel:l.name}};if("Table"===v||"Expression"===v)return{itemDelete:{schema:l.schemaName,entity:l.name,objectType:l.objectType}};var fe=void 0;return"Column"===v||"Measure"===v||"Hierarchy"===v?fe=l:"CalculationItem"===v?fe=l.calculationGroup:"Calendar"===v?fe=l:ee.fF.assertFail("This object type is not implemented "+v.toString()+"when create schemaChange"),{itemDelete:{schema:l.schemaName,entity:fe.table.name,objectType:l.objectType,property:l.name}}},he.getDeleteComfirmationTitle=function(l,v){if(1!==l.length)return v.get("ReportModelDeleteItemsTitle");switch(l[0].objectType){case"Table":return v.get(ce);case"Column":return v.get("DeleteColumnConfirmationTitle");case"Measure":return v.get("DeleteMeasurePromptTitle");case"Hierarchy":return v.get("DeleteHierarchyConfirmationTitle");case"Level":return v.get("DeleteHierarchyLevelConfirmationTitle");case"Relationship":return v.get("DeleteRelationshipConfirmationTitle");case"Calendar":return v.format("DeleteCalendarConfirmationTitle",l[0].name);default:ee.fF.assertFail("Unexpected type being deleted")}},he.getDeleteConfirmationOkButtonText=function(l,v){if(1!==l.length)return v.get("Yes");switch(l[0].objectType){case"Table":case"Column":case"Measure":case"Hierarchy":case"Level":case"Relationship":return v.get("Yes");case"Calendar":return v.get("Delete");default:ee.fF.assertFail("Unexpected type being deleted")}}}(K||(K={}));var y=E(70863),ie=E(58938),ve=E(65181),D=E(66339),q=function(){function he(ce,ye,Pe,Me,xe,je){this.modelAuthoring=ce,this.dataModelService=ye,this.dialogService=Pe,this.localizationService=Me,this.telemetryService=xe,this.viewScopedUserSettingsService=je}return he.prototype.deleteAllFromModel=function(ce,ye,Pe){if(void 0===Pe&&(Pe=!1),ce.every(function(xe){return!0===xe.canDelete})){var Me=this.createDeleteItems(ce,ye);return this.deleteModelItem(Me,Pe)}},he.prototype.createDeleteItems=function(ce,ye){var Pe=[];if(!ce)return Pe;var Me=[],xe=[],je=[],ge=[];ce.forEach(function(re){(0,y.wb)(re)?Me.push(re):(0,y.y3)(re)?xe.push(re):(0,y.ez)(re)?je.push(re):ge.push(re)});var Oe=[];return je.forEach(function(re){if(xe.every(function(p){return p.urn!==re.hierarchy.urn})&&Me.every(function(p){return p.urn!==re.hierarchy.table.urn})){var P=Oe.find(function(p){return p.hierarchy===re.hierarchy});P||Oe.push(P={hierarchy:re.hierarchy,levelsToDelete:[]}),P.levelsToDelete.push(re)}}),Oe.forEach(function(re){ye&&re.levelsToDelete.length===re.hierarchy.levels.length?xe.push(re.hierarchy):ge.push.apply(ge,re.levelsToDelete||[])}),ge.forEach(function(re){(0,y.Mx)(re)?Pe.push({itemName:re.name,schema:null,objectType:"Relationship"}):(0,y.ez)(re)?Pe.push({schema:re.schemaName,tableName:re.hierarchy.table.name,itemName:re.hierarchy.name,subItemName:re.name,objectType:"Level"}):(0,y.kb)(re)||(0,y.jz)(re)?Me.every(function(P){return P.urn!==re.table.urn})&&Pe.push({schema:re.schemaName,tableName:re.table.name,itemName:re.name,objectType:"Measure"}):(0,y.t3)(re)?Me.every(function(P){return P.urn!==re.table.urn})&&Pe.push({schema:re.schemaName,tableName:re.table.name,itemName:re.name,objectType:"Column"}):(0,y.RF)(re)?Me.every(function(P){return P.urn!==re.calculationGroup.table.urn})&&Pe.push({schema:re.schemaName,tableName:re.calculationGroup.table.name,itemName:re.name,objectType:"CalculationItem"}):(0,y.CV)(re)&&Me.every(function(P){return P.urn!==re.table.urn})&&Pe.push({schema:re.schemaName,tableName:re.table.name,itemName:re.name,objectType:"Calendar"})}),xe.forEach(function(re){Me.every(function(P){return P.urn!==re.table.urn})&&Pe.push({schema:re.schemaName,tableName:re.table.name,itemName:re.name,objectType:"Hierarchy"})}),Me.forEach(function(re){Pe.push({schema:re.schemaName,tableName:re.name,itemName:null,objectType:"Table"})}),Pe},he.prototype.deleteModelItem=function(ce,ye){return(0,R.mG)(this,void 0,void 0,function(){var Pe,Me,xe,je,ge,Oe,P,p,d,C;return(0,R.Jh)(this,function(m){switch(m.label){case 0:if(_.isEmpty(ce))return[2];for(Pe=this.dataModelService.getClientDataModel(),Me=[],xe=0,je=ce;xe<je.length;xe++){if(!(Oe=(0,I.Mf)(Pe.dataModel,(ge=je[xe]).objectType,ge.schema,ge.tableName,ge.itemName,ge.subItemName))||!Oe.capabilities.canDelete)return[2];Me.push(Oe)}return ye||this.hasUserOptedOutOfConfirmation(Me)?[3,2]:[4,this.confirmDeleteObjects(Pe.dataModel,Me,ce)];case 1:if(!m.sent())return[2];m.label=2;case 2:return P=Me.filter(function(O){return(0,I.wb)(O)}),p=K.getQueryToDependents(Pe,P),[4,K.showConfirmDialogToDeleteTableWithDependents(P,p,this.localizationService,this.dialogService)];case 3:return m.sent()?(d=K.reorderItemsToMinimizeDependencies(Me,P,p,this.localizationService),C=d.map(function(O){return K.createDeleteSchemaChange(O)}),C?.length>0?(this.telemetryService.logApplyChanges([Z.DeleteModelItem]),[4,this.modelAuthoring.apply({changes:C})]):[3,5]):[2];case 4:m.sent(),m.label=5;case 5:return[2]}})})},he.prototype.hasUserOptedOutOfConfirmation=function(ce){return!(!this.viewScopedUserSettingsService||!this.everyItemIsRelationship(ce)||!this.viewScopedUserSettingsService.get(Y))},he.prototype.confirmDeleteObjects=function(ce,ye,Pe){return(0,R.mG)(this,void 0,void 0,function(){var Me,xe,ge;return(0,R.Jh)(this,function(Oe){switch(Oe.label){case 0:if(0===ye.length)return[2,!1];if(1===ye.length){if("CalculationItem"===ye[0].objectType)return[2,!0];if((Me=(0,I.Lc)(ce,Pe[0].schema,Pe[0].tableName,Pe[0].itemName))&&(0,I.e_)(Me))return[2,!0]}return xe=this.shouldIncludeDontAskAgainCheckbox(ye)?this.localizationService.get("Generic_DontShowThisAgain"):void 0,[4,i.Z.buildOKCancelDialog({title:K.getDeleteComfirmationTitle(ye,this.localizationService),message:K.getDeleteConfirmationText(ye,this.localizationService),doNotShowAgain:xe},"deleteConfirmationDialog",this.dialogService,this.localizationService,K.getDeleteConfirmationOkButtonText(ye,this.localizationService))];case 1:return[4,Oe.sent().afterClosed().toPromise()];case 2:return 5===(ge=Oe.sent())?(this.handleDontAskAgainCheckbox(ye),[2,!1]):2===ge||3===ge?[2,!1]:4===ge?(this.handleDontAskAgainCheckbox(ye),[2,!0]):[2,1===ge]}})})},he.prototype.shouldIncludeDontAskAgainCheckbox=function(ce){return!!this.viewScopedUserSettingsService&&!!this.everyItemIsRelationship(ce)},he.prototype.handleDontAskAgainCheckbox=function(ce){this.viewScopedUserSettingsService&&this.everyItemIsRelationship(ce)&&this.viewScopedUserSettingsService.set(Y,!0)},he.prototype.everyItemIsRelationship=function(ce){return ce.every(function(ye){return"Relationship"===ye.objectType})},he.\u0275fac=function(ye){return new(ye||he)(V.\u0275\u0275inject(H.S),V.\u0275\u0275inject(z.n),V.\u0275\u0275inject(ie.x),V.\u0275\u0275inject(ve.o),V.\u0275\u0275inject(D.L),V.\u0275\u0275inject(j,8))},he.\u0275prov=V.\u0275\u0275defineInjectable({token:he,factory:he.\u0275fac}),he}()},34145:function(Ke,we,E){E.d(we,{q:function(){return z}});var z=new(E(50423).InjectionToken)("ModelService")},49346:function(Ke,we,E){E.d(we,{TM:function(){return te},Yk:function(){return j},Yt:function(){return k},g4:function(){return Z}});var R=E(41114),z="ClientSystemErrorBase",V=(R.cx[z]=(0,R.b1)(z),"PBIModelingCommonApplyChange"),j=R.cx[V]=(0,R.b1)(V),M="PBIModelingCommonDataModelUpdated",k=R.cx[M]=(0,R.b1)(M),Y="PBIExecuteDataQueryCacheEventName",Z=R.cx[Y]=(0,R.b1)(Y),I="PBISortByColumnDataQueryValidationEventName",te=R.cx[I]=(0,R.b1)(I)},66339:function(Ke,we,E){E.d(we,{L:function(){return k}});var R=E(34145),z=E(49346),H=E(68082),V=E(46544),j=E(34763),M=E(50423),k=function(){function Y(Z,I,te){var W,i,ee=this;this.dataModelService=Z,this.modelService=I,this.telemetryService=te,this.subscriptions=new j.w,this.telemetryService&&this.modelService&&this.dataModelService&&(this.subscriptions.add(null===(W=this.dataModelService.modelChanged$)||void 0===W?void 0:W.subscribe(function(){ee.logModelUpdated()})),this.subscriptions.add(null===(i=this.dataModelService.modelLoaded$)||void 0===i?void 0:i.subscribe(function(){ee.logModelUpdated()})))}return Y.prototype.initialize=function(){},Y.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},Y.prototype.logModelUpdated=function(){var Z,I,te=this.dataModelService.getDataModel();this.telemetryService.root&&this.telemetryService.logEvent(z.Yt,{modelVersion:this.dataModelService.version,tables:null===(Z=te?.tables)||void 0===Z?void 0:Z.length,relationships:null===(I=te?.relationships)||void 0===I?void 0:I.length})},Y.prototype.logApplyChanges=function(Z){var I,te;this.telemetryService.root&&this.telemetryService.logEvent(z.Yk,{change:Z.join(", "),modelVersion:null===(te=null===(I=this.modelService)||void 0===I?void 0:I.model)||void 0===te?void 0:te.version})},Y.\u0275fac=function(I){return new(I||Y)(M.\u0275\u0275inject(H.n,8),M.\u0275\u0275inject(R.q,8),M.\u0275\u0275inject(V.y0,8))},Y.\u0275prov=M.\u0275\u0275defineInjectable({token:Y,factory:Y.\u0275fac}),Y}()},55375:function(Ke,we,E){E.d(we,{Z:function(){return z}});var R=E(81337),z=function(){function H(){}return H.buildOKCancelDialog=function(V,j,M,k,Y,Z){return void 0===Y&&(Y=k.get("Yes")),void 0===Z&&(Z=k.get("Cancel_ButtonText")),V=(0,R.pi)((0,R.pi)({},V),{okButtonText:Y,cancelButtonText:Z}),M.openHostDialog({dialogName:j,componentName:"SimpleConfirmationDialogComponent",bindings:V,config:{width:"500px",panelClass:["mat-dialog-content-nonextra-space"],ariaDescribedBy:"simple-dialog-content-id"}})},H.buildOKCancelDialogWithList=function(V,j,M,k,Y,Z){var I=j.join(" ");return this.buildOKCancelDialog({title:V,message:void 0,additionalMessages:[[I,{segmentStr:"",lineBreak:!0},{segmentStr:"",lineBreak:!0},k]]},M,Y,Z)},H.buildCancelDialog=function(V,j,M,k,Y,Z,I,te){var ee={dialogName:M,componentName:"SimpleDialogComponent",bindings:{titleIcon:I,title:V,message:j,okButtonText:Z||Y.get("Close")},config:(0,R.pi)({width:"500px",panelClass:["mat-dialog-content-nonextra-space","legacy-dialog"],ariaDescribedBy:"simple-dialog-content-id"},te)};return k.openHostDialog(ee)},H}()}}]);