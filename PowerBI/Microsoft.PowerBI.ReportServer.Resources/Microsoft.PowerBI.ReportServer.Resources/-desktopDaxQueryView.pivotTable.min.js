"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["pivotTable"],{52073:function(_e,Se,U){function z(q,t){var C=t.getHierarchyDepth(),i=t.getChildren(q);if(!_.isEmpty(i))for(var o=0,w=i;o<w.length;o++)C=Math.min(C,t.getLevel(w[o]));return C-t.getLevel(q)}function pe(q,t){return t.isLeaf(q)?q:pe(_.head(t.getChildren(q)),t)}function se(q,t){return void 0!==t.getLeafIndex(q)?q:se(_.head(t.getChildren(q)),t)}function ue(q,t){return t.isLeaf(q)?q:ue(_.last(t.getChildren(q)),t)}function J(q,t){return void 0!==t.getLeafIndex(q)?q:J(_.last(t.getChildren(q)),t)}function L(q,t){return t.getLeafIndex(pe(q,t))}function W(q,t){return t.getLeafIndex(se(q,t))}function Z(q,t){return t.getLeafIndex(ue(q,t))}function G(q,t){return t.getLeafIndex(J(q,t))}U.d(Se,{LF:function(){return L},O3:function(){return G},hG:function(){return W},oj:function(){return ue},pA:function(){return Z},zG:function(){return z}})},15366:function(_e,Se,U){U.d(Se,{AV:function(){return N},DJ:function(){return D},DX:function(){return ne},EO:function(){return q},FA:function(){return ee},MN:function(){return L},Ms:function(){return W},Sv:function(){return w},_E:function(){return i},hw:function(){return G},sB:function(){return te},sW:function(){return o},yl:function(){return C}});var z=U(81337),pe=U(62458),se=U(52073),ue=U(7911),J=U(44404),L=10,W=50,G=20,q=20,C=function(){function B(){}return B.getAncestorsToMeasure=function(g,S){for(var d=[];;){var v=S.getParent(g);if(!v||!S.isLastItem(g,S.getChildren(v)))break;d.push({node:v,size:-1}),g=v}return d},B.getSizeDifference=function(g,S,d,v){for(var y=0,I=0,M=g;I<M.length;I++)y=Math.max(y,this.getItemSizeDifference(M[I],S,d,v));return y},B.getItemSizeDifference=function(g,S,d,v){for(var I=0,M=(0,se.LF)(g.node,d);M<=S;M++)if((I+=v(M))>=g.size)return 0;return g.size-I},B.getPageIndex=function(g,S){return Math.floor(g/S)},B.itemRangeToPageRange=function(g,S,d){var v=this.getPageIndex(g,d),y=this.getPageIndex(S,d);if(v===y)return[{pageIndex:v,startIndex:g%d,endIndex:S%d}];var I=[];I.push({pageIndex:v,startIndex:g%d,endIndex:d-1});for(var M=v+1;M<y;M++)I.push({pageIndex:M,startIndex:0,endIndex:d-1});return I.push({pageIndex:y,startIndex:0,endIndex:S%d}),I},B}(),i=function(){function B(){}return B.linesOverlapVertically=function(g,S,d,v){return!(d>g+S||d+v<g)},B.isRowMeasured=function(g,S){return this.getMeasuredRowCount(S)>g},B.getMeasuredRowCount=function(g){var S=g.getPageRows();return _.isEmpty(S)?0:(S.length-1)*G+_.last(S).getRowHeights().length},B.remeasureRows=function(g,S,d,v,y,I,M){for(var c=0,e=C.itemRangeToPageRange(v,y,G);c<e.length;c++){var r=e[c];M.measurePage(M.getPageRows()[r.pageIndex],g,S,d,v,I,q,r.startIndex,r.endIndex-r.startIndex+1)}},B.getVisibleRowStart=function(g,S,d){var v=d.getRowHeight(g.firstLeafIndex);return{rowIndex:g.firstLeafIndex,visibleHeight:v-S+g.firstLeafTop}},B.getVisibleRange=function(g,S,d,v,y){var I=this.getVisiblePageRange(g,S,d);if(!I)return null;var M=this.getFirstVisibleIndex(I.firstPageRow,I.firstPageIndex,I.firstPageTop,g,S);if(null!=M){var c,Q=this.getLastVisibleIndex(I.lastPageRow,I.lastPageIndex,I.lastPageTop,g,S);if(null!=Q)return null!=v&&v>=0&&null!=y&&y>=0&&(c=Math.max(Q,M.leafIndex+v-1),c=Math.min(c,y)),{firstLeafIndex:M.leafIndex,firstLeafTop:M.top,lastLeafIndex:c??Q}}},B.getVisiblePageRange=function(g,S,d){for(var v=0,y=0,I=null,Q=0,c=d.getPageRows();Q<c.length;Q++){var e=c[Q],r=e.getHeight();if(this.linesOverlapVertically(v,r,g,S))I?(I.lastPageRow=e,I.lastPageIndex=y,I.lastPageTop=v):I={firstPageRow:e,firstPageIndex:y,firstPageTop:v,lastPageRow:e,lastPageIndex:y,lastPageTop:v};else if(I)break;v+=r,y++}return I},B.getFirstVisibleIndex=function(g,S,d,v,y){for(var I=0,M=d,c=0,e=g.getRowHeights();c<e.length;c++){var r=e[c];if(this.linesOverlapVertically(M,r,v,y))return{leafIndex:S*G+I,top:M};M+=r,I++}},B.getLastVisibleIndex=function(g,S,d,v,y){for(var Q,I=0,M=d,c=0,e=g.getRowHeights();c<e.length;c++){var r=e[c];this.linesOverlapVertically(M,r,v,y)&&(Q=S*G+I),M+=r,I++}return Q},B.getBounds=function(g,S){var d=C.getPageIndex(g,G);if(!(d>=S.getPageRows().length)){for(var v=S.getPageRows()[d],y=S.getPageRowTop(v),I=g%G,M=0;M<I;M++)y+=v.getRowHeights()[M];return{top:y,height:v.getRowHeights()[I]}}},B.getOffset=function(g,S){var d=this.getBounds(g.rowIndex,S);return d?g.alignBottom?g.visibleHeight>=d.height?d.top+d.height:d.top+g.visibleHeight:g.visibleHeight>=d.height?d.top:d.top+d.height-g.visibleHeight:0},B}(),o=function(){function B(){}return B.linesOverlapHorizontally=function(g,S,d,v){return!(d>g+S||d+v<g)},B.isColumnMeasured=function(g,S){return this.getMeasuredColumnCount(S)>g},B.getMeasuredColumnCount=function(g){var S=g.getPageColumns();return _.isEmpty(S)?0:(S.length-1)*L+_.last(S).getColumnWidths().length},B.remeasureColumn=function(g,S,d,v,y,I){var M=I.getPageColumn(g,S,d,v,y);I.measurePage(M,S,d,v,y,W,g%L,1)},B.getVisibleColumnStart=function(g,S,d){var v=d.getColumnWidth(g.firstLeafIndex);return{columnIndex:g.firstLeafIndex,visibleWidth:v-S+g.firstLeafLeft}},B.getVisibleRange=function(g,S,d,v,y){var I=this.getVisiblePageRange(g,S,d);if(!I)return null;var M=this.getFirstVisibleIndex(I.firstPageColumn,I.firstPageIndex,I.firstPageLeft,g,S);if(null!=M){var c,Q=this.getLastVisibleIndex(I.lastPageColumn,I.lastPageIndex,I.lastPageLeft,g,S);if(null!=Q)return null!=v&&v>=0&&null!=y&&y>=0&&(c=Math.max(Q,M.leafIndex+v-1),c=Math.min(c,y)),{firstLeafIndex:M.leafIndex,firstLeafLeft:M.left,lastLeafIndex:c??Q}}},B.getVisiblePageRange=function(g,S,d){for(var v=0,y=0,I=null,M=0,Q=d.getPageColumns();M<Q.length;M++){var c=Q[M],e=c.getWidth();if(this.linesOverlapHorizontally(v,e,g,S))I?(I.lastPageColumn=c,I.lastPageIndex=y,I.lastPageLeft=v):I={firstPageColumn:c,firstPageIndex:y,firstPageLeft:v,lastPageColumn:c,lastPageIndex:y,lastPageLeft:v};else if(I)break;v+=e,y++}return I},B.getFirstVisibleIndex=function(g,S,d,v,y){for(var I=0,M=d,c=0,e=g.getColumnWidths();c<e.length;c++){var r=e[c];if(this.linesOverlapHorizontally(M,r,v,y))return{leafIndex:S*L+I,left:M};M+=r,I++}return null},B.getLastVisibleIndex=function(g,S,d,v,y){for(var Q,I=0,M=d,c=0,e=g.getColumnWidths();c<e.length;c++){var r=e[c];this.linesOverlapHorizontally(M,r,v,y)&&(Q=S*L+I),M+=r,I++}return Q},B.getBounds=function(g,S){var d=C.getPageIndex(g,L);if(!(d>=S.getPageColumns().length)){for(var v=S.getPageColumns()[d],y=S.getPageColumnLeft(v),I=g%L,M=v.getColumnWidths(),Q=0;Q<I;Q++)y+=M[Q];return{left:y,width:M[I]}}},B.getOffset=function(g,S){var d=this.getBounds(g.columnIndex,S);return d?g.alignRight?g.visibleWidth>=d.width?d.left+d.width:d.left+g.visibleWidth:g.visibleWidth>=d.width?d.left:d.left+d.width-g.visibleWidth:0},B}(),w=function(){function B(g,S){this.pageColumns=[],this.measureElement=g,this.sizeManager=S}return B.prototype.canAddPageColumn=function(g){return this.pageColumns.length<this.getMaxPageColumnCount(g)},B.prototype.getMaxPageColumnCount=function(g){return Math.ceil(g.getHierarchyLeafCount()/L)},B.prototype.getPageColumns=function(){return this.pageColumns},B.prototype.getPageColumnStartIndex=function(g){var S=this.pageColumns.indexOf(g);return-1===S?-1:S*L},B.prototype.getPageColumnLeft=function(g){for(var S=0,d=0,v=this.pageColumns;d<v.length;d++){var y=v[d];if(g===y)break;S+=y.getWidth()}return S},B.prototype.getColumnsWidth=function(){for(var g=0,S=0,d=this.pageColumns;S<d.length;S++)g+=d[S].getWidth();return g},B.prototype.clear=function(){this.pageColumns=[]},B.prototype.measureNextPage=function(g,S,d,v){var y=new ue.VG;this.getPageColumns().push(y),this.measurePage(y,g,S,d,v,W)},B.prototype.getWidestCellBindingString=function(g,S,d,v,y,I,M){for(var Q={item:null,width:-1},c=0;c<I;c++)this.updateWidestItemFromBodyCell(v.getHierarchyLeafAt(c+M),g,d,v,Q);if(S){var e=v.getFloatingHierarchyLeafCount();for(c=0;c<e;c++)this.updateWidestItemFromBodyCell(v.getFloatingHierarchyLeafAt(c),g,d,v,Q)}var l,r=d.getApproximateColumnHeaderWidth(g);return r>Q.width&&(Q.item=g,Q.width=r),l=Q.item===g?d.getColumnHeaderBinding(Q.item,!0):d.getBodyCellBinding(Q.item,!0),ue.bG.build(l,B.measureRequiredStyle)},B.prototype.measurePage=function(g,S,d,v,y,I,M,Q){var c=this.getPageColumnStartIndex(g);void 0===M&&(M=0),void 0===Q&&(Q=Math.min(v.getHierarchyLeafCount()-c,L)+M);for(var e=Math.min(d.getHierarchyLeafCount()-y,I),r="",l=d.getFloatingHierarchyItems(),s=0;s<Q;s++){var p=v.getHierarchyLeafAt(s+M+c);void 0===(g.getColumnWidths()[s+M]=this.sizeManager.getColumnWidth(p))&&(r+=this.getWidestCellBindingString(p,l,S,d,v,e,y))}if(r){this.measureElement.insertAdjacentHTML("beforeend",r);var n=this.measureElement.firstChild;for(s=0;s<Q;s++)void 0===g.getColumnWidths()[s+M]&&(g.getColumnWidths()[s+M]=n.offsetWidth+1,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(g,S,v,c,M,Q)}},B.prototype.updateWidestItemFromBodyCell=function(g,S,d,v,y){var I=v.getIntersection(g,S),M=d.getApproximateBodyCellWidth(I);M>y.width&&(y.item=I,y.width=M)},B.prototype.adjustItemsWidth=function(g,S,d,v,y,I){for(var M=0;M<I;M++){var Q=d.getHierarchyLeafAt(M+y+v);void 0===this.sizeManager.getColumnWidth(Q)&&this.adjustItemWidth(g,M+y,v,S,d,Q)}},B.prototype.adjustItemWidth=function(g,S,d,v,y,I){var M=this,Q=C.getAncestorsToMeasure(I,y);_.isEmpty(Q)||(this.measureAncestors(Q,v),g.getColumnWidths()[S]+=C.getSizeDifference(Q,S+d,y,function(c){return M.getColumnWidth(c)}))},B.prototype.measureAncestors=function(g,S){for(var d="",v=0,y=g;v<y.length;v++){var M=S.getColumnHeaderBinding(y[v].node,!0);d+=ue.bG.build(M,B.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",d);for(var Q=this.measureElement.firstChild,c=0,e=g;c<e.length;c++)e[c].size=Q.offsetWidth+1,Q=Q.nextSibling;this.measureElement.innerHTML=""},B.prototype.getColumnWidth=function(g,S,d,v,y){return this.getPageColumn(g,S,d,v,y).getColumnWidths()[g%L]},B.prototype.setColumnWidth=function(g,S){this.getPageColumn(g).getColumnWidths()[g%L]=S},B.prototype.getPageColumn=function(g,S,d,v,y){var I=this.getPageIndex(g);if(S&&I>=this.pageColumns.length)for(var M=I-this.pageColumns.length+1,Q=0;Q<M;Q++)this.measureNextPage(S,d,v,y);return this.pageColumns[I]},B.prototype.getPageIndex=function(g){return C.getPageIndex(g,L)},B.prototype.getLastMeasuredIndex=function(){var g=this.pageColumns.length;if(0===g)return-1;var S=_.last(this.pageColumns);return(g-1)*L+(S.getColumnWidths().length-1)},B.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},B}(),O=function(){function B(g,S,d,v){this.pageRows=[],this.measureElement=g,this.columnWidthMeasureManager=S,this.rowLevelWidthMeasureManager=d,this.sizeManager=v}return B.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},B.prototype.clearFloatingRows=function(){this.floatingPageRow=new ue.BJ},B.prototype.ensureLastPageComplete=function(g,S,d,v,y,I){if(0===this.pageRows.length)return-1;var Q=this.pageRows.length-1,c=this.pageRows[Q],e=c.getRowHeights().length;return e<G&&this.gotMoreRows(c,S)&&(this.measurePage(c,g,S,d,v,y,I,c.getRowHeights().length-1),c.getRowHeights().length>e)?Q:-1},B.prototype.measureNextPage=function(g,S,d,v,y){var I=new ue.BJ;this.getPageRows().push(I),this.measurePage(I,g,S,d,v,y,q)},B.prototype.measureFloatingRows=function(g,S,d,v,y,I,M){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var Q=S.getFloatingHierarchyItems();if(!_.isEmpty(Q)){for(var c=Math.min(d.getHierarchyLeafCount()-y,q),e="",r=S.getFloatingHierarchyLeafCount(),l=0;l<r;l++){var s=S.getFloatingHierarchyLeafAt(l);this.floatingPageRow.getRowHeights()[l]=this.sizeManager.getRowHeight(s),void 0===this.floatingPageRow.getRowHeights()[l]&&(e+=this.getHeighestCellBindingString(s,g,S,d,c,y,v,I,M))}if(e){this.measureElement.insertAdjacentHTML("beforeend",e);var p=this.measureElement.firstChild;for(l=0;l<r;l++)void 0===this.floatingPageRow.getRowHeights()[l]&&(this.floatingPageRow.getRowHeights()[l]=p.offsetHeight,p=p.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,g,S,0,0,r)}}}},B.prototype.getPageIndex=function(g){return C.getPageIndex(g,G)},B.prototype.getMeasureRequiredStyle=function(g){return{"box-sizing":"border-box",width:(0,J.S)(g)}},B.prototype.gotMoreRows=function(g,S){return S.getHierarchyLeafCount()-this.getPageRowStartIndex(g)-g.getRowHeights().length>0},B.prototype.measurePage=function(g,S,d,v,y,I,M,Q,c){var e=this.getPageRowStartIndex(g);void 0===Q&&(Q=0),void 0===c&&(c=Math.min(d.getHierarchyLeafCount()-e,G)-Q);for(var r=Math.min(v.getHierarchyLeafCount()-I,M),l="",s=0;s<c;s++){var p=d.getHierarchyLeafAt(s+Q+e);void 0===(g.getRowHeights()[s+Q]=this.sizeManager.getRowHeight(p))&&(l+=this.getHeighestCellBindingString(p,S,d,v,r,I,y))}if(l){this.measureElement.insertAdjacentHTML("beforeend",l);var n=this.measureElement.firstChild;for(s=0;s<c;s++)void 0===g.getRowHeights()[s+Q]&&(g.getRowHeights()[s+Q]=n.offsetHeight,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(g,S,d,e,Q,c)}},B.prototype.getHeighestCellBindingString=function(g,S,d,v,y,I,M,Q,c){for(var e={item:null,width:-1,height:-1},r=0;r<y;r++){var l=v.getHierarchyLeafAt(r+I),s=d.getIntersection(g,l),p=this.columnWidthMeasureManager.getColumnWidth(r+I,S,d,v,M),u=S.getApproximateBodyCellHeight(s,p);u>e.height&&(e.item=s,e.width=p,e.height=u)}var H,n=this.getItemWidth(g,d),h=S.getApproximateRowHeaderHeight(g,n);return h>e.height&&(e.item=g,e.height=h,e.width=n),H=e.item===g?S.getRowHeaderBinding(e.item,!0):S.getBodyCellBinding(e.item,!0,void 0,void 0,void 0,Q,void 0,c),ue.bG.build(H,this.getMeasureRequiredStyle(e.width))},B.prototype.getItemWidth=function(g,S){return pe.fF.assertFail("abstract method"),0},B.prototype.adjustItemsHeight=function(g,S,d,v,y,I){pe.fF.assertFail("abstract method")},B.prototype.getMaxPageRowCount=function(g){return Math.ceil(g.getHierarchyLeafCount()/G)},B.prototype.getPageRows=function(){return this.pageRows},B.prototype.getFloatingPageRow=function(){return this.floatingPageRow},B.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},B.prototype.canAddPageRow=function(g){return this.pageRows.length<this.getMaxPageRowCount(g)},B.prototype.getPageRowStartIndex=function(g){if(g===this.floatingPageRow)return 0;var S=this.pageRows.indexOf(g);return-1===S?-1:S*G},B.prototype.getPageRowTop=function(g){if(g===this.floatingPageRow)return 0;for(var S=0,d=0,v=this.pageRows;d<v.length;d++){var y=v[d];if(g===y)break;S+=y.getHeight()}return S},B.prototype.getRowsHeight=function(){for(var g=0,S=0,d=this.pageRows;S<d.length;S++)g+=d[S].getHeight();return g},B.prototype.getRowHeight=function(g,S,d,v,y,I){return this.getPageRow(g,S,d,v,I).getRowHeights()[g%G]},B.prototype.getFloatingRowHeight=function(g){return this.floatingPageRow.getRowHeights()[g]},B.prototype.getPageRow=function(g,S,d,v,y,I){var M=this.getPageIndex(g);if(S&&M>this.pageRows.length)for(var Q=M-this.pageRows.length+1,c=0;c<Q;c++)this.measureNextPage(S,d,v,y,I);return this.pageRows[M]},B.prototype.getLastMeasuredIndex=function(){var g=this.pageRows.length;if(0===g)return-1;var S=_.last(this.pageRows);return(g-1)*G+(S.getRowHeights().length-1)},B}(),D=function(B){function g(){return null!==B&&B.apply(this,arguments)||this}return(0,z.__extends)(g,B),g.prototype.getItemWidth=function(S,d){return this.rowLevelWidthMeasureManager.getWidth(d.getLevel(S),(0,se.zG)(S,d))},g.prototype.adjustItemsHeight=function(S,d,v,y,I,M){for(var Q=0;Q<M;Q++){var c=v.getHierarchyLeafAt(Q+I+y);void 0===this.sizeManager.getRowHeight(c)&&this.adjustItemHeight(S,Q+I,y,d,v,c)}},g.prototype.adjustItemHeight=function(S,d,v,y,I,M){var Q=this,c=C.getAncestorsToMeasure(M,I);_.isEmpty(c)||(this.measureAncestors(c,y,I),S.getRowHeights()[d]+=C.getSizeDifference(c,v+d,I,function(e){return S===Q.getFloatingPageRow()?Q.getFloatingRowHeight(e):Q.getRowHeight(e)}))},g.prototype.measureAncestors=function(S,d,v){for(var y="",I=0,M=S;I<M.length;I++){var c=d.getRowHeaderBinding((Q=M[I]).node,!0);y+=ue.bG.build(c,this.getMeasureRequiredStyle(this.getItemWidth(Q.node,v)))}this.measureElement.insertAdjacentHTML("beforeend",y);for(var e=this.measureElement.firstChild,r=0,l=S;r<l.length;r++){var Q;(Q=l[r]).size=e.offsetHeight,e=e.nextSibling}this.measureElement.innerHTML=""},g}(O),N=function(B){function g(){return null!==B&&B.apply(this,arguments)||this}return(0,z.__extends)(g,B),g.prototype.getItemWidth=function(S,d){return this.rowLevelWidthMeasureManager.getLevelWidth(d.getLevel(S))},g.prototype.adjustItemsHeight=function(S,d,v,y,I,M){},g}(O),te=function(){function B(g,S,d,v){this.columnLevelHeights=[],this.measureElement=g,this.columnWidthMeasureManager=S,this.rowLevelWidthMeasureManager=d,this.sizeManager=v}return B.prototype.clear=function(){this.columnLevelHeights=[]},B.prototype.getMeasureRequiredStyle=function(g){return{"box-sizing":"border-box",width:(0,J.S)(g)}},B.prototype.measure=function(g,S,d,v,y,I,M){if(0===this.columnLevelHeights.length){for(var Q={done:!1,levels:[],spanningHeaders:[],leafCount:0},c=d.getHierarchyDepth(),e=S.getHierarchyDepth(),r=0;r<c;r++)(void 0===M||M===r)&&(this.columnLevelHeights[r]=this.sizeManager.getColumnLevelHeight(S.getCorner(e-1,r))),Q.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var l=d.getHierarchyItems();l&&this.getHeighestColumnHeaders(l,Q,g,S,d,v,y,I);for(var s=0;s<e;s++)for(var p=0;p<c;p++)if(void 0===this.columnLevelHeights[p]){var u=S.getCorner(s,p),n=this.rowLevelWidthMeasureManager.getLevelWidth(s),h=g.getApproximateCornerCellHeight(u,n);h>Q.levels[p].largestItemHeight&&(Q.levels[p].isHeader=!1,Q.levels[p].largestItem=u,Q.levels[p].largestItemHeight=h,Q.levels[p].largestItemWidth=n)}for(var H="",f=0,m=Q.levels;f<m.length;f++)if((b=m[f]).largestItem){var T=this.getMeasureRequiredStyle(b.largestItemWidth);if(b.isHeader){var R=g.getColumnHeaderBinding(b.largestItem,!0);H+=ue.bG.build(R,T)}else R=g.getCornerCellBinding(b.largestItem,!0),H+=ue.bG.build(R,T)}if(H){this.measureElement.insertAdjacentHTML("beforeend",H);for(var k=this.measureElement.firstChild,E=0,ie=0,le=Q.levels;ie<le.length;ie++){var b;(b=le[ie]).largestItem&&((void 0===M||M===E)&&(this.columnLevelHeights[E]=k.offsetHeight),k=k.nextSibling),E++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(Q,g,S,d,v)}}},B.prototype.adjustLevelHeightsFromSpanningHeaders=function(g,S,d,v,y){for(var I="",M=0,Q=g.spanningHeaders;M<Q.length;M++)if(g.levels[(c=Q[M]).levelToAdjust].largestItem){var e=this.getMeasureRequiredStyle(this.getHeaderWidth(c.item,S,d,v,y)),r=S.getColumnHeaderBinding(c.item,!0);I+=ue.bG.build(r,e)}if(I){this.measureElement.insertAdjacentHTML("beforeend",I);for(var l=this.measureElement.firstChild,s=0,p=g.spanningHeaders;s<p.length;s++){var c;g.levels[(c=p[s]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(c.item,c.level,c.levelToAdjust,l.offsetHeight,v),l=l.nextSibling)}this.measureElement.innerHTML=""}},B.prototype.adjustLevelFromSpanningHeader=function(g,S,d,v,y){for(var I=0,M=S;M<=d;M++)I+=this.getLevelHeight(M);v>I&&(this.columnLevelHeights[d]+=v-I)},B.prototype.getHeighestColumnHeaders=function(g,S,d,v,y,I,M,Q){for(var c=0,e=g;c<e.length;c++){var r=e[c];if(S.done)return;var l=y.isLeaf(r),s=y.getLevel(r),p=(0,se.zG)(r,y),u=(0,se.pA)(r,y)>=M;if(u)if(1===p){if(void 0===this.columnLevelHeights[s]){var n=this.getHeaderWidth(r,d,v,y,I),h=d.getApproximateColumnHeaderHeight(r,n);h>S.levels[s].largestItemHeight&&(S.levels[s].largestItem=r,S.levels[s].largestItemHeight=h,S.levels[s].largestItemWidth=n)}}else S.spanningHeaders.push({item:r,level:s,levelToAdjust:p+s-1});var H=y.getChildren(r);H&&this.getHeighestColumnHeaders(H,S,d,v,y,I,M,Q),l&&u&&S.leafCount++,S.leafCount===Q&&(S.done=!0)}},B.prototype.getHeadersHeight=function(){for(var g=0,S=0,d=this.columnLevelHeights;S<d.length;S++)g+=d[S];return g},B.prototype.getLevelTop=function(g){for(var S=0,d=0;d<g;d++)S+=this.columnLevelHeights[d];return S},B.prototype.getLevelHeight=function(g){return this.columnLevelHeights[g]},B.prototype.getHeaderWidth=function(g,S,d,v,y){for(var I=(0,se.LF)(g,v),M=(0,se.pA)(g,v),Q=0,c=I;c<=M;c++)Q+=this.columnWidthMeasureManager.getColumnWidth(c,S,d,v,y);return Q},B}(),ne=function(){function B(g,S){this.rowLevelWidths=[],this.measureElement=g,this.sizeManager=S}return B.prototype.clear=function(){this.rowLevelWidths=[]},B.prototype.measure=function(g,S,d,v,y,I){if(0===this.rowLevelWidths.length||void 0!==I){for(var M={done:!1,levels:[],spanningHeaders:[],leafCount:0},Q=S.getHierarchyDepth(),c=d.getHierarchyDepth(),e=0;e<Q;e++)(void 0===I||I===e)&&(this.rowLevelWidths[e]=this.sizeManager.getRowLevelWidth(S.getCorner(e,c-1))),M.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(S.getHierarchyItems(),M,g,S,v,y);var r=S.getFloatingHierarchyItems();_.isEmpty(r)||(M.done=!1,M.leafCount=0,this.getWidestRowHeaders(r,M,g,S,-1,S.getFloatingHierarchyLeafCount()));for(var l=0;l<c;l++)for(var s=0;s<Q;s++)if(void 0===this.rowLevelWidths[s]){var p=S.getCorner(s,l),u=g.getApproximateCornerCellWidth(p);u>M.levels[s].largestItemWidth&&(M.levels[s].isHeader=!1,M.levels[s].largestItem=p,M.levels[s].largestItemWidth=u)}for(var n="",h=0,H=M.levels;h<H.length;h++)if((f=H[h]).largestItem)if(f.isHeader){var m=g.getRowHeaderBinding(f.largestItem,!0);n+=ue.bG.build(m,B.measureRequiredStyles)}else m=g.getCornerCellBinding(f.largestItem,!0),n+=ue.bG.build(m,B.measureRequiredStyles);if(n){this.measureElement.insertAdjacentHTML("beforeend",n);for(var b=this.measureElement.firstChild,T=0,R=0,k=M.levels;R<k.length;R++){var f;(f=k[R]).largestItem&&((void 0===I||I===T)&&(this.rowLevelWidths[T]=b.offsetWidth+1),b=b.nextSibling),T++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(M,g,S)}}},B.prototype.adjustLevelWidthsFromSpanningHeaders=function(g,S,d){for(var v="",y=0,I=g.spanningHeaders;y<I.length;y++)if(g.levels[(M=I[y]).levelToAdjust].largestItem){var Q=S.getRowHeaderBinding(M.item,!0);v+=ue.bG.build(Q,B.measureRequiredStyles)}if(v){this.measureElement.insertAdjacentHTML("beforeend",v);for(var c=this.measureElement.firstChild,e=0,r=g.spanningHeaders;e<r.length;e++){var M;g.levels[(M=r[e]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(M.item,M.level,M.levelToAdjust,c.offsetWidth,d),c=c.nextSibling)}this.measureElement.innerHTML=""}},B.prototype.adjustLevelWidthFromSpanningHeader=function(g,S,d,v,y){for(var I=0,M=S;M<=d;M++)I+=this.getLevelWidth(M);v>I&&(this.rowLevelWidths[d]+=v-I)},B.prototype.getWidestRowHeaders=function(g,S,d,v,y,I){for(var M=0,Q=g;M<Q.length;M++){var c=Q[M];if(S.done)return;var e=v.isLeaf(c),r=v.getLevel(c),l=(0,se.zG)(c,v),s=(0,se.pA)(c,v)>=y;if(s)if(1===l){if(void 0===this.rowLevelWidths[r]){var p=d.getApproximateRowHeaderWidth(c);p>S.levels[r].largestItemWidth&&(S.levels[r].largestItem=c,S.levels[r].largestItemWidth=p)}}else S.spanningHeaders.push({item:c,level:r,levelToAdjust:l+r-1});var u=v.getChildren(c);u&&this.getWidestRowHeaders(u,S,d,v,y,I),e&&s&&S.leafCount++,S.leafCount===I&&(S.done=!0)}},B.prototype.getHeadersWidth=function(){for(var g=0,S=0,d=this.rowLevelWidths;S<d.length;S++)g+=d[S];return g},B.prototype.getLevelLeft=function(g){for(var S=0,d=0;d<g;d++)S+=this.rowLevelWidths[d];return S},B.prototype.getLevelWidth=function(g){return this.rowLevelWidths[g]},B.prototype.setLevelWidth=function(g,S){this.rowLevelWidths[g]=S},B.prototype.getWidth=function(g,S){for(var d=0,v=g;v<g+S;v++)d+=this.getLevelWidth(v);return d},B.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},B}(),ee=function(){function B(g,S){this.measureElement=g,this.sizeManager=S}return B.prototype.clear=function(){this.width=void 0},B.prototype.getHeaderBindingString=function(g,S){var d=S.getRowHeaderBinding(g,!0);return ue.bG.build(d,ne.measureRequiredStyles)},B.prototype.measure=function(g,S,d,v,y,I){if((void 0===this.width||void 0!==I)&&(this.width=this.sizeManager.getRowLevelWidth(S.getCorner(0,d.getHierarchyDepth()-1)),void 0===this.width)){for(var M="",Q=Math.min(S.getHierarchyLeafCount()-v,y),c=0;c<Q;c++)M+=this.getHeaderBindingString(S.getHierarchyLeafAt(c+v),g);var e=S.getFloatingHierarchyItems();if(!_.isEmpty(e)){var r=S.getFloatingHierarchyLeafCount();for(c=0;c<r;c++)M+=this.getHeaderBindingString(S.getFloatingHierarchyLeafAt(c),g)}if(S.getHierarchyDepth()>0)for(c=0;c<d.getHierarchyDepth();c++){var l=S.getCorner(0,c),s=g.getCornerCellBinding(l,!0);M+=ue.bG.build(s,ne.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",M);for(var p=this.measureElement.firstChild,u=0;p;)u=Math.max(u,p.offsetWidth+1),p=p.nextSibling;this.measureElement.innerHTML="",this.width=u}},B.prototype.getHeadersWidth=function(){return this.width},B.prototype.getLevelWidth=function(g){return this.width},B.prototype.setLevelWidth=function(g,S){this.width=S},B.prototype.getLevelLeft=function(g){return 0},B}()},87914:function(_e,Se,U){U.d(Se,{yv:function(){return se},zf:function(){return z}});var z=9,se=250},79465:function(_e,Se,U){U.d(Se,{BM:function(){return z},aP:function(){return J},p0:function(){return pe},xU:function(){return ue},y2:function(){return se}});var z=function(L){return L[L.Incremental=0]="Incremental",L[L.ClearRendering=1]="ClearRendering",L[L.ClearMeasurement=2]="ClearMeasurement",L[L.ClearMeasurementOnly=3]="ClearMeasurementOnly",L[L.ResizeColumn=4]="ResizeColumn",L}({}),pe=function(L){return L[L.Header=0]="Header",L[L.Body=1]="Body",L[L.Footer=2]="Footer",L[L.FooterHeader=3]="FooterHeader",L[L.MatrixRowHeader=4]="MatrixRowHeader",L[L.MatrixCorner=5]="MatrixCorner",L}({}),se=function(L){return L[L.Table=0]="Table",L[L.Matrix=1]="Matrix",L}({}),ue=function(L){return L[L.Blocked=0]="Blocked",L[L.Stepped=1]="Stepped",L}({}),J=function(L){return L[L.Prefix=0]="Prefix",L[L.Main=1]="Main",L}({})},44404:function(_e,Se,U){U.d(Se,{S:function(){return pe}});var z=U(62458);function pe(se){return z.fF.assertValue(null!=se,"value should be defined"),0===se?se.toString():se+"px"}},7911:function(_e,Se,U){U.d(Se,{BJ:function(){return J},VG:function(){return ue},bG:function(){return L}});var z=U(55007),pe=U(62458),se=U(79602),ue=function(){function W(){this.columnWidths=[]}return W.prototype.getColumnWidths=function(){return this.columnWidths},W.prototype.getWidth=function(){return _.sum(this.columnWidths)},W}(),J=function(){function W(){this.rowHeights=[]}return W.prototype.getRowHeights=function(){return this.rowHeights},W.prototype.getHeight=function(){return _.sum(this.rowHeights)},W.prototype.clear=function(){this.rowHeights=[]},W}(),L=function(){function W(){}return W.build=function(Z,G){if(void 0===G&&(G={}),null===Z.tagName)return Z.content;var q=Z.tagName||"div",t="<"+q+" "+this.buildAttributes(Z.attributes)+this.buildClassNames(Z.classNames)+this.buildStyles(Z.styleProperties,G)+">";if(_.isEmpty(Z.children))null!=Z.content&&(t+=Z.content);else for(var C=0,i=Z.children;C<i.length;C++)t+=W.build(i[C],null);return t+"</"+q+">"},W.buildMultiple=function(Z){return _.map(Z,function(G){return W.build(G)}).join("")},W.buildAttributes=function(Z){var G="";if(Z)for(var q in Z)G+=q+"="+z.u3+Z[q]+z.u3;return G},W.buildClassNames=function(Z){if(!Z||0===Z.length)return"";for(var G='class="',q=0,t=Z;q<t.length;q++)G+=t[q]+" ";return G+'"'},W.buildStyles=function(Z,G){var q=!_.isEmpty(G),t=!_.isEmpty(Z);if(!q&&!t)return"";var C="style="+z.u3;if(t)for(var i in Z)C+=i+":"+Z[i]+";";if(q)for(var o in G)C+=o+":"+G[o]+";";return C+z.u3},W.attachEventHandlers=function(Z,G){if(G.clickHandler&&Z.addEventListener("click",function(t){return G.clickHandler(t)}),G.contextMenuHandler&&Z.addEventListener("contextmenu",function(t){return G.contextMenuHandler(t)}),G.scrollHandler&&se.l.runOutsideAngular(function(){Z.addEventListener("scroll",function(t){return G.scrollHandler(t)})}),!_.isEmpty(G.children)){pe.fF.assert(function(){return G.children.length===Z.childNodes.length},"Element children mismatch");for(var q=0;q<G.children.length;q++)null!==G.children[q].tagName&&W.attachEventHandlers(Z.childNodes[q],G.children[q])}},W.attachEventHandlersMultiple=function(Z,G){var q=Z;G.forEach(function(t){W.attachEventHandlers(q,t),q=q.nextElementSibling})},W}()},24133:function(_e,Se,U){U.d(Se,{d:function(){return Q}});var z=U(81337),pe=U(11034),se=U(62458),ue=U(59107),J=U(98094),L=U(79602),W=U(44102),Z=U(93340),G=U(71090),q=U(52073),t=U(15366),C=U(44404),i=U(87914),o=U(79465),w=U(11184),O=function(){function c(e,r,l){this.onFocusChangedHandler=e,this.isA11yTable=r,this.isA11yMatrix=l}return Object.defineProperty(c.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),c.prototype.updateMeasureManagers=function(e,r){this.rowHeightMeasureManager=e,this.columnWidthMeasureManager=r},c.prototype.setAsFocusTableEx=function(e,r,l,s){se.fF.assert(function(){return null!=e||l!==o.p0.Body},"body cells need row index"),l===o.p0.Header?this.currentFocus=s?{columnHeader:s}:{columnHeader:[r]}:l===o.p0.Body?this.currentFocus={bodyCell:{rowIndex:e,columnIndex:r}}:l===o.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:e??0,columnIndex:r}}:l===o.p0.FooterHeader?this.currentFocus={floatingRowHeader:e}:l===o.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:r,columnLevel:e}}:l===o.p0.MatrixRowHeader?this.currentFocus=s?{rowHeader:s}:{rowHeader:[e]}:se.fF.assertNever(l),this.updateFocusedItem()},c.prototype.updateFocusedItem=function(){if(se.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var e=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),r=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);se.fF.assertValue(e,"row leaf not found"),se.fF.assertValue(r,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,r)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(e=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),r=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),se.fF.assertValue(e,"row leaf not found"),se.fF.assertValue(r,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,r)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):se.fF.assertFail("unexpected focus state");se.fF.assertValue(this.currentFocus,"Undefined focused item")}},c.prototype.moveFocus=function(e,r,l,s,p,u){se.fF.assertValue(this.currentFocus,"No initial focus");var n=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(e,r,p,s):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(e,r,p,u):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(e,r,s):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(e,r):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(e,r):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(e,r)),se.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=n},c.prototype.moveBodyCellFocusTableEx=function(e,r,l,s){var p=this.currentFocus.bodyCell.rowIndex,u=this.currentFocus.bodyCell.columnIndex,n=this.rowNavigator.getFloatingHierarchyLeafCount()>0,h=-1===u,H=this.rowHeightMeasureManager.getPageRows().length,f=_.last(this.rowHeightMeasureManager.getPageRows()),m=(H-1)*t.hw+(f.getRowHeights().length-1),b=this.columnWidthMeasureManager.getPageColumns().length,T=_.last(this.columnWidthMeasureManager.getPageColumns()),R=(b-1)*t.MN+(T.getColumnWidths().length-1);if(r){if("home"===e)return s?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return s?this.getBottomRightCell():n?{floatingBodyCell:{rowIndex:0,columnIndex:R}}:{bodyCell:{rowIndex:m,columnIndex:R}};if("up"===e)return s?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(u))[0]]}:h?{bodyCell:{rowIndex:0,columnIndex:u}}:{columnHeader:[u]};if("down"===e)return h||!n?{bodyCell:{rowIndex:m,columnIndex:u}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:u}};if("left"===e)return s?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(p))[0]]}:{bodyCell:{rowIndex:p,columnIndex:0}};if("right"===e)return{bodyCell:{rowIndex:p,columnIndex:R}}}else{if("home"===e){if(s){var k=this.rowNavigator.getHierarchyLeafAt(p),E=this.rowNavigator.getLeafAncestorAtLevel(k,0);return{rowHeader:this.rowNavigator.getPathIndices(E)}}return{bodyCell:{rowIndex:p,columnIndex:0}}}if("end"===e)return s?{bodyCell:{rowIndex:p,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:p,columnIndex:R}};if("pageup"===e&&l)return{bodyCell:{rowIndex:le=Math.max(this.prevNonblankRowIndex(p-l+1),0),columnIndex:u}};if("pagedown"===e&&l){var fe=this.prevNonblankRowIndex(m+1);return{bodyCell:{rowIndex:le=Math.min(this.nextNonblankRowIndex(p+l-1),fe),columnIndex:u}}}if("up"===e)return(le=this.prevNonblankRowIndex(p))<0?h?{bodyCell:{rowIndex:0,columnIndex:u}}:s&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(u))}:{columnHeader:[u]}:{bodyCell:{rowIndex:le,columnIndex:u}};if("down"===e){var le;if(!((le=this.nextNonblankRowIndex(p))>m))return{bodyCell:{rowIndex:le,columnIndex:u}};if(h||!n&&!s)return{bodyCell:{rowIndex:m,columnIndex:u}};if(!s||n)return{floatingBodyCell:{rowIndex:0,columnIndex:u}}}if("left"===e)return s&&0===u?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(p))}:{rowHeader:[p]}:{bodyCell:{rowIndex:p,columnIndex:Math.max(u-1,-1)}};if("right"===e)return{bodyCell:{rowIndex:p,columnIndex:Math.min(u+1,R)}}}return this.currentFocus},c.prototype.moveRowHeaderFocusTableEx=function(e,r,l,s){var p,u=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=this.columnNavigator.getHierarchyDepth(),h=this.currentFocus.rowHeader,H=this.rowNavigator.getNodeFromPath(h),f=this.rowNavigator instanceof w.S?0:this.rowNavigator.getLevel(H),m=this.rowNavigator.getItemsByLevel(f),b=m.indexOf(H),T=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(r){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:f,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(f)}else{if("left"===e&&h.length>1)return{rowHeader:_.dropRight(h,1)};if("right"===e){if(null!==(p=this.previousFocus)&&void 0!==p&&p.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var R=this.rowNavigator.getLeafIndex(H);if(void 0===R)return{rowHeader:(0,z.__spreadArray)((0,z.__spreadArray)([],h||[],!0),[0],!1)};if(u>-1)return{bodyCell:{rowIndex:R,columnIndex:0}}}if("up"===e)return(k=this.prevNonblankHeaderRowIndex(b,m))>=0?{rowHeader:this.rowNavigator.getPathIndices(m[k])}:{cornerCell:{rowLevel:f,columnLevel:n-1}};if("down"===e){if((k=this.nextNonblankHeaderRowIndex(b,m))<=m.length-1)return{rowHeader:this.rowNavigator.getPathIndices(m[k])};if(T)return{floatingRowHeader:0}}if("pagedown"===e){var E=this.rowHeightMeasureManager.getLastMeasuredIndex(),ie=(0,q.hG)(this.currentFocus.item,this.rowNavigator),le=this.nextNonblankRowIndex(ie+l-1),fe=this.prevNonblankRowIndex(E+1),he=Math.min(le,fe),Y=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(he));if(this.rowNavigator.isLeaf(H)||this.rowNavigator instanceof w.S)return{rowHeader:Y};var de=_.take(Y,Math.min(this.currentFocus.rowHeader.length,Y.length)),k=this.nextNonblankHeaderRowIndex(b,m);return _.isEqual(de,this.currentFocus.rowHeader)&&k<=m.length-1?{rowHeader:this.rowNavigator.getPathIndices(m[k])}:{rowHeader:de}}if("pageup"===e&&(ie=(0,q.hG)(this.currentFocus.item,this.rowNavigator),he=Math.max(this.prevNonblankRowIndex(ie-l+1),0),Y=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(he)),(de=_.take(Y,Math.min(this.currentFocus.rowHeader.length,Y.length)))!==this.currentFocus.rowHeader))return{rowHeader:de}}return h.length>1&&(r&&"left"===e||"home"===e)?{rowHeader:[h[0]]}:r&&"right"===e||"end"===e?{bodyCell:{rowIndex:(0,q.hG)(H,this.rowNavigator),columnIndex:u}}:this.currentFocus},c.prototype.moveColumnHeaderFocusTableEx=function(e,r,l){var s,p=this.currentFocus.columnHeader[0],u=this.rowNavigator.getFloatingHierarchyLeafCount()>0,n=this.rowHeightMeasureManager.getPageRows().length,h=_.last(this.rowHeightMeasureManager.getPageRows()),H=h?(n-1)*t.hw+(h.getRowHeights().length-1):-1,f=this.columnWidthMeasureManager.getPageColumns().length,m=_.last(this.columnWidthMeasureManager.getPageColumns()),b=(f-1)*t.MN+(m.getColumnWidths().length-1),T=this.currentFocus.columnHeader,R=this.columnNavigator.getNodeFromPath(T),k=this.columnNavigator.getLevel(R),E=this.rowNavigator.getHierarchyDepth();if(r){if("home"===e)return l?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e){if(l)return this.getBottomRightCell();if(u)return{floatingBodyCell:{rowIndex:0,columnIndex:b}};if(-1!==H)return{bodyCell:{rowIndex:H,columnIndex:b}}}if("down"===e){var ie=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(R):p;return this.getBottomFooterBodyCell(ie,H)}if("up"===e)return{columnHeader:[T[0]]}}else{if("up"===e&&l&&this.columnNavigator.hasHierarchy()&&T.length>1)return{columnHeader:_.dropRight(T,1)};if("down"===e){if(l){if(null!==(s=this.previousFocus)&&void 0!==s&&s.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var le=this.columnNavigator.getLeafIndex(R);if(!this.columnNavigator.isLeaf(R))return{columnHeader:(0,z.__spreadArray)((0,z.__spreadArray)([],this.currentFocus.columnHeader,!0),[0],!1)};if(H>=0)return{bodyCell:{rowIndex:0,columnIndex:le}};if(u)return{floatingBodyCell:{rowIndex:0,columnIndex:le}}}if(-1!==H)return{bodyCell:{rowIndex:0,columnIndex:p}}}var fe=this.columnNavigator.getItemsByLevel(k),he=fe.indexOf(R);if("left"===e)return l?he>0?{columnHeader:this.columnNavigator.getPathIndices(fe[he-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:E-1,columnLevel:k}}:{cornerCell:{rowLevel:0,columnLevel:k}}:{columnHeader:[Math.max(p-1,0)]};if("right"===e)return l&&-1!==he?{columnHeader:this.columnNavigator.getPathIndices(fe[Math.min(he+1,fe.length-1)])}:{columnHeader:[Math.min(p+1,b)]}}return"home"===e||r&&"left"===e?l?{cornerCell:{rowLevel:0,columnLevel:k}}:{columnHeader:[0]}:"end"===e||r&&"right"===e?l?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[b]}:this.currentFocus},c.prototype.moveCornerCellFocusTableEx=function(e,r){var l=this.currentFocus.cornerCell.rowLevel,s=this.currentFocus.cornerCell.columnLevel,p=this.rowNavigator.getItemsByLevel(l),u=this.columnNavigator.getItemsByLevel(s),n=this.rowNavigator.getHierarchyLeafCount(),h=this.rowNavigator.getHierarchyDepth(),H=this.columnNavigator.getHierarchyDepth(),f=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(r){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:l,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(l)}else{if("up"===e&&s>0)return{cornerCell:{rowLevel:l,columnLevel:s-1}};if("down"===e){if(s<H-1)return{cornerCell:{rowLevel:l,columnLevel:s+1}};if(n>0)return{rowHeader:this.rowNavigator.getPathIndices(p[0])};if(f)return{floatingRowHeader:0}}if("right"===e){if(l<h-1)return{cornerCell:{rowLevel:l+1,columnLevel:s}};if(!_.isEmpty(u))return{columnHeader:this.columnNavigator.getPathIndices(u[0])}}if("left"===e&&l>0)return{cornerCell:{rowLevel:l-1,columnLevel:s}}}return l>0&&("home"===e||r&&"left"===e)?{cornerCell:{rowLevel:0,columnLevel:s}}:"end"===e||r&&"right"===e?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},c.prototype.moveFloatingRowHeaderFocusTableEx=function(e,r){var l=this.rowNavigator.getHierarchyLeafCount(),s=this.columnWidthMeasureManager.getLastMeasuredIndex(),p=this.columnNavigator.getHierarchyDepth(),u=this.currentFocus.floatingRowHeader;if(se.fF.assert(function(){return s>-1},"There can not be Floating rows without column headers"),r){if("home"===e||"up"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("down"===e&&u<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===e)return{floatingBodyCell:{rowIndex:u,columnIndex:0}};if("up"===e){if(u>0)return{floatingRowHeader:u-1};if(l>0){var n=this.rowNavigator.getItemsByLevel(0),h=this.prevNonblankHeaderRowIndex(n.length,n);return{rowHeader:this.rowNavigator.getPathIndices(n[h])}}return{cornerCell:{rowLevel:0,columnLevel:p-1}}}if("down"===e&&u<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:u+1}}return r&&"right"===e||"end"===e?{floatingBodyCell:{rowIndex:u,columnIndex:s}}:this.currentFocus},c.prototype.moveFloatingBodyCellFocusTableEx=function(e,r){var l=this.currentFocus.floatingBodyCell.columnIndex,s=this.currentFocus.floatingBodyCell.rowIndex,p=-1===l,u=this.rowHeightMeasureManager.getPageRows().length,n=_.last(this.rowHeightMeasureManager.getPageRows()),h=n?(u-1)*t.hw+(n.getRowHeights().length-1):-1,H=this.columnWidthMeasureManager.getPageColumns().length,f=_.last(this.columnWidthMeasureManager.getPageColumns()),m=(H-1)*t.MN+(f.getColumnWidths().length-1);if(r){if("home"===e)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:m}};if("up"===e){if(this.isA11yMatrix){var b=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0);return{columnHeader:[this.columnNavigator.getIndex(b)]}}return p?{bodyCell:{rowIndex:0,columnIndex:l}}:{columnHeader:[l]}}if("down"===e)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:l}};if("left"===e)return this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===e)return{floatingBodyCell:{rowIndex:s,columnIndex:m}}}else{if("home"===e)return this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===e)return{floatingBodyCell:{rowIndex:0,columnIndex:m}};if("up"===e)return 0===s?h>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(h+1),columnIndex:l}}:(b=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0),{columnHeader:[this.columnNavigator.getIndex(b)]}):{floatingBodyCell:{rowIndex:s-1,columnIndex:l}};if("down"===e&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:s+1,columnIndex:l}};if("left"===e)return 0===l&&this.isA11yMatrix?{floatingRowHeader:s}:{floatingBodyCell:{rowIndex:s,columnIndex:Math.max(l-1,0)}};if("right"===e)return{floatingBodyCell:{rowIndex:s,columnIndex:Math.min(l+1,m)}}}return this.currentFocus},c.prototype.getBottomRightCell=function(){var e=this.rowNavigator.getFloatingHierarchyLeafCount(),r=this.columnWidthMeasureManager.getLastMeasuredIndex(),l=this.rowNavigator.getHierarchyLeafCount()-1;return e>0?{floatingBodyCell:{rowIndex:e-1,columnIndex:r}}:{bodyCell:{rowIndex:l,columnIndex:r}}},c.prototype.getLastMatrixColumnCell=function(e){var r=this.columnNavigator.getHierarchyLeafCount(),l=this.columnNavigator.getHierarchyLeafAt(r-1),s=this.columnNavigator.getPathIndices(l);return{columnHeader:_.dropRight(s,s.length-(e+1))}},c.prototype.getFirstColumnLeafFromAncestor=function(e){return this.columnNavigator.isLeaf(e)?this.columnNavigator.getLeafIndex(e):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(e)[0])},c.prototype.getBottomFooterBodyCell=function(e,r){var l=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==e&&l?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:e}}:-1===r?this.currentFocus:{bodyCell:{rowIndex:r,columnIndex:e}}},c.prototype.getBottomFooterHeaderCell=function(e){var r=this.rowNavigator.getItemsByLevel(e);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(r[r.length-1])}},c.prototype.prevNonblankRowIndex=function(e){for(var r=e-1;r>=0;r--)if(!this.rowNavigator.isBlankRow(r))return r;return-1},c.prototype.nextNonblankRowIndex=function(e){for(var r=this.rowNavigator.getHierarchyLeafCount(),l=e+1;l<r;l++)if(!this.rowNavigator.isBlankRow(l))return l;return r+1},c.prototype.prevNonblankHeaderRowIndex=function(e,r){for(var l=e-1;l>=0;l--)if(!this.rowNavigator.isBlank(r[l]))return l;return-1},c.prototype.nextNonblankHeaderRowIndex=function(e,r){for(var l=e+1;l<r.length;l++)if(!this.rowNavigator.isBlank(r[l]))return l;return r.length},c}(),D=U(51660),N=function(){function c(e,r,l,s,p,u){var n=this;this.isA11yMatrix=u,this.elementOriginalCursor=r?.style.cursor,this.verticalResizeHandler=l,this.horizontalResizeHandler=s,(l||s)&&(r.addEventListener("mousedown",function(h){return r.closest("[".concat(D.y3,"=true]"))?null:n.onMouseDown(e,r,h)}),r.addEventListener("mousemove",function(h){return r.closest("[".concat(D.y3,"=true]"))?null:n.onMouseMove(r,h)}),r.addEventListener("dblclick",function(h){return r.closest("[".concat(D.y3,"=true]"))?null:n.onDoubleClick(e,r,h)})),p&&r.addEventListener("click",function(h){return n.onClick(e,r,h,p)})}return c.prototype.onMouseDown=function(e,r,l){var s=this.getActiveHandler(r,l);if(s){this.resizing=!0,this.startMousePosition=c.getMouseCoordinates(l);var p=(0,Z.df)(r);this.initializeDocumentEvents(r,s,p),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(r,l)),s.onStartResize(e)}else this.resizing=!1},c.prototype.onMouseMove=function(e,r){this.startMousePosition||(e.style.cursor=this.getCursor(e,r))},c.prototype.onDoubleClick=function(e,r,l){var s=this.getActiveHandler(r,l);s&&s.onReset(e)},c.prototype.onClick=function(e,r,l,s){this.isA11yMatrix&&!r.closest("[".concat(D.y3,"=true]"))&&l.stopPropagation(),!this.resizing&&s&&s(e,l)},c.prototype.getActiveHandler=function(e,r){return this.isMouseOnVerticalHandle(e,c.getMouseCoordinates(r))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(e,c.getMouseCoordinates(r))?this.horizontalResizeHandler:null},c.prototype.getCursor=function(e,r){return this.isMouseOnVerticalHandle(e,c.getMouseCoordinates(r))?"col-resize":this.isMouseOnHorizontalHandle(e,c.getMouseCoordinates(r))?"row-resize":this.elementOriginalCursor},c.prototype.initializeDocumentEvents=function(e,r,l){var s=this;this.documentMouseMoveListener=function(p){p.preventDefault(),r.onResize(c.getMouseCoordinatesDelta(s.startMousePosition,c.getMouseCoordinates(p),l))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(p){p.preventDefault(),document.removeEventListener("mousemove",s.documentMouseMoveListener),s.documentMouseMoveListener=null,document.removeEventListener("mouseup",s.documentMouseUpListener),s.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=s.documentOriginalCursor,s.documentOriginalCursor=void 0),s.startMousePosition=null,r.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},c.prototype.isMouseOnVerticalHandle=function(e,r){return!!this.verticalResizeHandler&&r.x>=e.getBoundingClientRect().right-c.HandleSize},c.prototype.isMouseOnHorizontalHandle=function(e,r){return!!this.horizontalResizeHandler&&r.y>=e.getBoundingClientRect().bottom-c.HandleSize},c.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},c.getMouseCoordinatesDelta=function(e,r,l){return r&&e?{x:(r.x-e.x)/l,y:(r.y-e.y)/l}:{x:0,y:0}},c.HandleSize=4,c}(),te=function(){function c(e,r,l){this.a11yTableFS=r,this.a11yMatrixFS=l,this.control=e}return c.prototype.onStartResize=function(e){var r=(0,q.oj)(e,this.control.getColumnNavigator()),l=this.control.getColumnNavigator().getLeafIndex(r);this.resizeState={leafToResize:r,leafToResizeIndex:l,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(l)}},c.prototype.onResize=function(e){if(e.x&&this.resizeState){var r=this.control.getViewport(),l=t._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager()),s=t.sW.getVisibleRange(r.left,r.width,this.control.getColumnWidthMeasureManager());if(l&&s){var p=Math.max(this.resizeState.originalWidth+e.x,N.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,p),t._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,s.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ResizeColumn)}}},c.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.leafToResize,r=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),l=this.resizeState.originalWidth;this.resizeState=void 0;var s=this.control.getViewport(),p=t._E.getVisibleRange(s.top,s.height,this.control.getRowHeightMeasureManager());if(p&&r!==l){this.control.getSizeManager().setColumnWidth(e,r);var u=t._E.getVisibleRowStart(p,s.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}}},c.prototype.onReset=function(e){var r=this.control.getViewport(),l=t._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager());if(l){var s=(0,q.oj)(e,this.control.getColumnNavigator()),p=this.control.getColumnNavigator().getLeafIndex(s);this.control.getSizeManager().setColumnWidth(s,void 0),t.sW.remeasureColumn(p,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,this.control.getColumnWidthMeasureManager());var u=t._E.getVisibleRowStart(l,r.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}},c}(),B=function(){function c(e,r){this.a11yMatrixFS=r,this.control=e}return c.prototype.onStartResize=function(e){var r=this.getLevelToResize(e);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(r,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:r,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(r)}},c.prototype.onResize=function(e){if(e.x&&this.resizeState){var r=this.control.getViewport(),l=t._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager()),s=t.sW.getVisibleRange(r.left,r.width,this.control.getColumnWidthMeasureManager());if(l){var p=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+e.x,N.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,p),t._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,s?s.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ResizeColumn)}}},c.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.cornerCellToResize,r=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),l=this.resizeState.originalWidth;this.resizeState=void 0;var s=this.control.getViewport(),p=t._E.getVisibleRange(s.top,s.height,this.control.getRowHeightMeasureManager());if(p&&r!==l){this.control.getSizeManager().setRowLevelWidth(e,r);var u=t._E.getVisibleRowStart(p,s.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(o.BM.ClearRendering,u)}}},c.prototype.onReset=function(e){var r=this.control.getViewport(),l=t._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager());if(l){var s=this.getLevelToResize(e),p=this.control.getRowNavigator().getCorner(s,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(p,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,t.Ms,s);var u=t._E.getVisibleRowStart(l,r.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(o.BM.Incremental,u)}},c.prototype.getLevelToResize=function(e){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(e)},c.prototype.getMaxWidth=function(e){for(var r=this.control.getClientWidth(),l=0;l<e;l++)r-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(l);return r},c}(),g=U(57470),S=U(7911),d=function(){function c(e,r,l,s,p,u,n,h,H,f,m,b,T){var k,R=this;this.element=e,this.prefixCellClickHandler=r,this.prefixCellContextMenuHandler=l,this.mainCellClickHandler=s,this.mainCellContextMenuHandler=p,this.interactionHandler=u,this.section=n,this.renderType=h,this.onObject=H,this.enableCalculationHighlight=f,this.isRenderStable=m,this.showTotalPlaceHolders=b,this.showAsTableNativeMenu=T,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(E){var ie,le,fe=E.target,he=R.getItemByElement(fe);he&&(R.isPrefixCell(fe)?null===(ie=R.prefixCellClickHandler)||void 0===ie||ie.call(R,he,E,void 0,R.section):null===(le=R.mainCellClickHandler)||void 0===le||le.call(R,he,E,void 0,R.section))}),this.element.addEventListener("contextmenu",function(E){var ie,le,fe=E.target,he=R.getItemByElement(fe);!he||T||(R.isPrefixCell(fe)?null===(ie=R.prefixCellContextMenuHandler)||void 0===ie||ie.call(R,he,E):null===(le=R.mainCellContextMenuHandler)||void 0===le||le.call(R,he,E))}),this.renderType===o.y2.Table&&this.element.addEventListener("change",function(E){var ie,le=d3.select(E.target).attr("checkbox-rowindex");null!=le&&(null===(ie=R.mainCellClickHandler)||void 0===ie||ie.call(R,void 0,void 0,+le,R.section))}),null===(k=this.interactionHandler)||void 0===k||k.setTooltipDelegate(function(E){return R.getItemByElement(E.context)},this.element,this.getRegion.bind(this),!T,function(E){return R.shouldHideDefaultTooltip(E.context)})}return c.prototype.update=function(e,r,l,s){var p=this.rowHeightMeasureManager.getLastMeasuredIndex(),u=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=t._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager,t.hw,p),h=t.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager,t.MN,u);if(this.section!==o.p0.Body||n){var H,f,m;switch(h||(h={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case o.p0.Header:H=[0,s.getHierarchyDepth()-1],f=this.rowHeightMeasureManager.getPageRows(),m=this.columnWidthMeasureManager.getPageColumns();break;case o.p0.Body:H=[n.firstLeafIndex,n.lastLeafIndex],f=this.rowHeightMeasureManager.getPageRows(),m=this.columnWidthMeasureManager.getPageColumns();break;case o.p0.Footer:H=[0,l.getFloatingHierarchyLeafCount()-1],f=[this.rowHeightMeasureManager.getFloatingPageRow()],m=this.columnWidthMeasureManager.getPageColumns();break;default:se.fF.assertNever(this.section)}this.renderMeta={viewport:e,binder:r,rowNavigator:l,columnNavigator:s,visibleRowRange:H,visibleColumnRange:[h.firstLeafIndex,h.lastLeafIndex],pageRows:f,pageColumns:m},this.updateRendering()}},c.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e},c.prototype.setRepeatRowHeaders=function(e){this.repeatRowHeaders=e},c.prototype.setRowWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(r+=e),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",r+"px")},c.prototype.updateBodyLeft=function(){var e=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",e+"px")},c.prototype.shouldHideDefaultTooltip=function(e){var l=g.M.getFirstMatchingAncestor(e,function(n){return n.matches(".prefix-cell")||n.matches(".main-cell")},this.element,!0);if(!l)return!0;var p,s=d3.select(l);return!s.select(".tablixUrlIconGlyph").node()&&(!(p=s.classed("pivotTableCellWrap")||s.classed("pivotTableCellNoWrap")?s.node():s.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||p.scrollHeight===p.clientHeight&&p.scrollWidth===p.clientWidth)},c.prototype.updateMeasureManagers=function(e,r,l,s,p){this.rowHeaderType=e,this.rowHeightMeasureManager=r,this.columnWidthMeasureManager=l,this.rowLevelWidthMeasureManager=s,this.columnLevelHeightMeasureManager=p},c.prototype.scrollToX=function(e){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-e+"px"),this.xPosition=e},c.prototype.onColumnResize=function(){var e=this;d3.select(this.element).selectAll(".row").each(function(){var r=e.getRowIndex(this),l=e.getRowHeight(r),s=e.getRowTop(r);d3.select(this).style("height",l+"px").style("top",s+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var r=e.getRowIndex(this),l=e.getColumnIndex(this),s=e.isFillerCell(this),p=s?0:e.getPrefixCellHeight(r,l),u=s?0:e.getPrefixCellWidth(r,l),n=e.getPrefixCellLeft(r,l),h=parseFloat(d3.select(this).style("--padding-left")),H=parseFloat(d3.select(this).style("--padding-right")),f=e.getAdjustedPaddings(u,h,H),m=f[0],b=f[1];d3.select(this).style("height",p+"px").style("width",u+"px").style("left",n+"px").style("padding-left",m+"px").style("padding-right",b+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var r=e.getRowIndex(this),l=e.getColumnIndex(this),s=e.getMainCellHeight(r,l),p=e.getMainCellWidth(r,l),u=e.getMainCellLeft(r,l),n=parseFloat(d3.select(this).style("--padding-left")),h=parseFloat(d3.select(this).style("--padding-right")),H=e.getAdjustedPaddings(p,n,h),f=H[0],m=H[1];d3.select(this).style("height",s+"px").style("width",p+"px").style("left",u+"px").style("padding-left",f+"px").style("padding-right",m+"px")}),this.adjustHeaders()},c.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},c.prototype.getElementByIndex=function(e,r,l){var s=l===o.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(e,'"] ').concat(s,'[column-index="').concat(r,'"]')).node()},c.prototype.getItemByElement=function(e){if(this.isRenderStable()){var r=this.getRowIndex(e);if(null!=r){var l=this.getColumnIndex(e);if(null!=l){var s=this.isPrefixCell(e);return this.getCellItem(r,l,s)}}}},c.prototype.updateRendering=function(){var e=this,r=[],l=[];this.clearUnusedElements(),this.setGroupLocations(r,l),r.forEach(function(s){return e.insertRowGroup(s)}),l.forEach(function(s){return e.insertCellGroup(s)}),this.scrollToX(this.xPosition),this.adjustHeaders()},c.prototype.clearUnusedElements=function(){var e=this;for(var r in this.viewSync)if(+r<this.renderMeta.visibleRowRange[0]||+r>this.renderMeta.visibleRowRange[1])delete this.viewSync[r];else for(var l in this.viewSync[r])+l>=0&&(+l<this.renderMeta.visibleColumnRange[0]||+l>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[r][l];d3.select(this.element).selectAll(".row").filter(function(){var s=e.getRowIndex(this);return s<e.renderMeta.visibleRowRange[0]||s>e.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var s=e.getColumnIndex(this);return s<e.renderMeta.visibleColumnRange[0]||s>e.renderMeta.visibleColumnRange[1]}).remove()},c.prototype.setGroupLocations=function(e,r){for(var l,s=this.renderMeta.visibleRowRange[0];s<=this.renderMeta.visibleRowRange[1];s++)if(this.viewSync[s]){l=!1;var u=void 0;this.viewSync[s][-1]||r.push({rowIndex:s,columnStart:-1,columnEnd:-1});for(var p=this.renderMeta.visibleColumnRange[0];p<=this.renderMeta.visibleColumnRange[1];p++)this.viewSync[s][p]?u=!1:(u?_.last(r).columnEnd++:(r.push({rowIndex:s,columnStart:p,columnEnd:p}),u=!0),this.viewSync[s][p]=!0)}else for(l?_.last(e).rowEnd++:(e.push({rowStart:s,rowEnd:s}),l=!0),this.viewSync[s]={"-1":!0},p=this.renderMeta.visibleColumnRange[0];p<=this.renderMeta.visibleColumnRange[1];p++)this.viewSync[s][p]=!0},c.prototype.insertRowGroup=function(e){for(var l,r=this,s=d3.select(this.element).selectAll(".row").nodes(),p=s.length-1;p>=0;p--){se.fF.assert(function(){return r.section===o.p0.Body},"header and footer should never insert additional row groups");var u=this.getRowIndex(s[p]);if(e.rowStart>u){l=s[p];break}}var h,n=this.getRowGroupBindings(e.rowStart,e.rowEnd);l?(l.insertAdjacentHTML("afterend",S.bG.buildMultiple(n)),h=l.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",S.bG.buildMultiple(n)),h=_.first(this.element.children)),S.bG.attachEventHandlersMultiple(h,n)},c.prototype.insertCellGroup=function(e){var r;se.fF.assert(function(){return-1!==e.columnStart},"cell group insertion of prefix cells is not supported");for(var s=d3.select(this.element).select('[row-index="'.concat(e.rowIndex,'"]')).select(".scrollable-cells-container"),p=s.node(),u=s.selectAll(".prefix-cell").nodes(),n=s.selectAll(".main-cell").nodes(),h=n.length-1;h>=0;h--){var H=this.getColumnIndex(n[h]);if(e.columnStart>H){r=n[h];break}}!r&&!_.isEmpty(u)&&(r=_.last(u));var m,f=this.getMainBindings(e.rowIndex,e.columnStart,e.columnEnd);r?(r.insertAdjacentHTML("afterend",S.bG.buildMultiple(f)),m=r.nextElementSibling):(p.insertAdjacentHTML("afterbegin",S.bG.buildMultiple(f)),m=_.first(p.children)),S.bG.attachEventHandlersMultiple(m,f)},c.prototype.getRowGroupBindings=function(e,r){for(var l,s=[],p=e;p<=r;p++){var u=this.getRowHeight(p),n=this.getRowTop(p),h=!1,H=0;this.renderMeta.binder.blankRowsEnabled()&&(h=this.renderMeta.rowNavigator.isBlankRow(p),H=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(p));var f={classNames:["row"],attributes:{role:"row","row-index":p.toString()},styleProperties:{position:"absolute",height:u+"px",width:"100%",top:n+"px","pointer-events":"none"},children:[]};h?f.attributes["aria-hidden"]="true":f.attributes["aria-rowindex"]=(this.getAriaRowIndex(p)-H).toString();var m=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),b=this.columnWidthMeasureManager.getColumnsWidth(),T=this.getPrefixBindings(p),R=this.getMainBindings(p,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===o.y2.Matrix&&(l=f.children).push.apply(l,T);var E={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:m+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:b+"px"},children:this.unfrozenRowHeaders||this.renderType===o.y2.Table?(0,z.__spreadArray)((0,z.__spreadArray)([],T,!0),R,!0):R}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===o.y2.Matrix&&(E.attributes[D.oy]=(0).toString()),f.children.push(E),s.push(f)}return s},c.prototype.getPrefixBindings=function(e){for(var r=[],l=this.renderMeta.rowNavigator.getHierarchyDepth(),s=0;s<l;s++){var p=this.getPrefixCellBinding(e,s);r.push(p)}return r},c.prototype.getMainBindings=function(e,r,l){for(var s=[],p=r;p<=l;p++){var u=this.getMainCellBinding(e,p);s.push(u)}return s},c.prototype.adjustCellBindingPadding=function(e,r){var l=parseFloat(e.styleProperties["padding-left"]),s=parseFloat(e.styleProperties["padding-right"]);isNaN(l)&&(l=0),isNaN(s)&&(s=0);var p=this.getAdjustedPaddings(r,l,s),n=p[1];e.styleProperties["padding-left"]=p[0]+"px",e.styleProperties["padding-right"]=n+"px",e.styleProperties["--padding-left"]=l.toString(),e.styleProperties["--padding-right"]=s.toString()},c.prototype.getAdjustedPaddings=function(e,r,l){var s=Math.max(e-r,0),p=Math.min(l,s);return[Math.min(r,e),p]},c.prototype.getRowIndex=function(e){var l=g.M.getFirstMatchingAncestor(e,function(p){return p.matches("[row-index]")},this.element,!0);return l&&+l.getAttribute("row-index")},c.prototype.getColumnIndex=function(e){var l=g.M.getFirstMatchingAncestor(e,function(p){return p.matches("[column-index]")},this.element,!0);return l&&+l.getAttribute("column-index")},c.prototype.isPrefixCell=function(e){return!!g.M.getFirstMatchingAncestor(e,function(p){return p.matches(".prefix-cell")},this.element,!0)},c.prototype.getRegion=function(e){return this.isPrefixCell(e)?o.aP.Prefix:o.aP.Main},c.prototype.isFillerCell=function(e){return!!g.M.getFirstMatchingAncestor(e,function(p){return p.matches(".filler-cell")},this.element,!0)},c.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},c.prototype.getAriaColIndex=function(e,r){return r?e+1:e+1+this.renderMeta.rowNavigator.getHierarchyDepth()},c.prototype.getColumnWidth=function(e,r){return r?this.rowLevelWidthMeasureManager.getLevelWidth(e):this.columnWidthMeasureManager.getPageColumns()[t.yl.getPageIndex(e,t.MN)].getColumnWidths()[e%t.MN]},c.prototype.getColumnLeft=function(e,r){if(r)return this.rowLevelWidthMeasureManager.getLevelLeft(e);var s=this.columnWidthMeasureManager.getPageColumns()[t.yl.getPageIndex(e,t.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(s)+_.sum(s.getColumnWidths().slice(0,e%t.MN))},c}(),v=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,z.__extends)(e,c),e.prototype.setResizeHandlers=function(r,l){this.columnWidthResizeHandler=r,this.rowLevelWidthResizeHandler=l},e.prototype.adjustHeaders=function(){var r=this;for(var l in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var n=r.getRowIndex(this),h=r.getColumnIndex(this),H=r.getMainCellWidth(n,h),f=h===r.renderMeta.visibleColumnRange[0],m=d3.select(this).classed("secondary-columnheader")&&!f;if(d3.select(this).classed("visually-hidden",m),f&&!d3.select(this).classed("last-secondary-columnheader")){var b=r.getColumnHeaderOffset(h),T=H-b;d3.select(this).style("transform","translateX(".concat(b,"px)")),d3.select(this).style("width",T+"px")}else m||(d3.select(this).style("transform",null),d3.select(this).style("width",H+"px"))}),this.viewSync)for(var s in this.viewSync[l])if("resizable"!==this.viewSync[l][s]){if("-1"===s)d3.select(this.element).select('[row-index="'.concat(l,'"]')).selectAll(".prefix-cell").each(function(){if(!r.isFillerCell(this)){var n=r.getItemByElement(this);new N(n,this,r.rowLevelWidthResizeHandler,null,r.prefixCellClickHandler,!0)}});else{var p=this.getElementByIndex(l,s,o.aP.Main);if(!this.isFillerCell(p)){var u=this.getItemByElement(p);new N(u,p,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[l][s]="resizable"}},e.prototype.getPrefixCellBinding=function(r,l){var s=l,p=r,u=this.rowLevelWidthMeasureManager.getLevelLeft(s),n=this.columnLevelHeightMeasureManager.getLevelHeight(p),h=this.rowLevelWidthMeasureManager.getLevelWidth(s),H=this.renderMeta.rowNavigator.getCorner(s,p),f=this.renderMeta.binder.getCornerCellBinding(H,!1,!0,this.onObject,h);return f.classNames||(f.classNames=[]),f.attributes||(f.attributes={}),f.styleProperties||(f.styleProperties={}),f.classNames.push("prefix-cell"),f.attributes.role="columnheader",f.attributes["column-index"]=l.toString(),f.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),null==f.attributes.tabindex&&(f.attributes.tabindex="0"),f.styleProperties.position="absolute",f.styleProperties.left=u+"px",f.styleProperties.height=n+"px",f.styleProperties.width=h+"px",f.styleProperties["box-sizing"]="border-box",f.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(f,h),f},e.prototype.getMainCellBinding=function(r,l){var s=r,u=this.columnWidthMeasureManager.getPageColumns()[t.yl.getPageIndex(l,t.MN)],H=this.columnWidthMeasureManager.getPageColumnLeft(u)+_.sum(u.getColumnWidths().slice(0,l%t.MN));this.unfrozenRowHeaders&&(H+=this.rowLevelWidthMeasureManager.getHeadersWidth());var f=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),m=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(f,s,!0);if(!m)return{attributes:{role:"columnheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:H+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var R,T=this.renderMeta.columnNavigator.getHierarchyLeafAt(l+1);T&&(R=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(T,s,!0)),R===m&&(R=void 0);var k=this.getMainCellHeight(r,l),E=this.getMainCellWidth(r,l),ie=this.renderMeta.binder.getColumnHeaderBinding(m,!1,!0,this.onObject,R,E),le=this.renderMeta.columnNavigator.isLeaf(m),fe=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(m),he=this.renderMeta.columnNavigator.getNodeLeafCount(m)-(l-fe),Y=!le&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(m)===l,de=!le&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(m)!==l,ge=de&&1===he;return ie.classNames||(ie.classNames=[]),ie.attributes||(ie.attributes={}),ie.styleProperties||(ie.styleProperties={}),ie.classNames.push("main-cell"),Y&&ie.classNames.push("primary-columnheader"),de&&ie.classNames.push("secondary-columnheader"),ge&&ie.classNames.push("last-secondary-columnheader"),ie.attributes.role="columnheader",ie.attributes["column-index"]=l.toString(),ie.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),ie.attributes.tabindex="0",ie.styleProperties.position="absolute",ie.styleProperties.left=H+"px",ie.styleProperties.width=E+"px",ie.styleProperties.height=k+"px",ie.styleProperties["box-sizing"]="border-box",ie.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(ie,E),ie},e.prototype.getAriaRowIndex=function(r){return r+1},e.prototype.getRowHeight=function(r){return this.columnLevelHeightMeasureManager.getLevelHeight(r)},e.prototype.getRowTop=function(r){return this.columnLevelHeightMeasureManager.getLevelTop(r)},e.prototype.getPrefixCellWidth=function(r,l){return this.rowLevelWidthMeasureManager.getLevelWidth(l)},e.prototype.getPrefixCellHeight=function(r,l){return this.columnLevelHeightMeasureManager.getLevelHeight(r)},e.prototype.getPrefixCellLeft=function(r,l){return this.rowLevelWidthMeasureManager.getLevelLeft(l)},e.prototype.getMainCellWidth=function(r,l){var s=this,p=r,u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(u,p),h=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(n),H=this.renderMeta.columnNavigator.getNodeLeafCount(n)-(l-h),f=this.columnWidthMeasureManager.getLastMeasuredIndex(),m=Math.min(l+H-1,f);return _.sum(_.range(l,m+1).map(function(b){return s.columnWidthMeasureManager.getColumnWidth(b)}))},e.prototype.getMainCellHeight=function(r,l){var s=this,p=r,u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(u,p),h=(0,q.zG)(n,this.renderMeta.columnNavigator);return _.sum(_.range(r,p+h-1+1).map(function(f){return s.columnLevelHeightMeasureManager.getLevelHeight(f)}))},e.prototype.getMainCellLeft=function(r,l){var p=this.columnWidthMeasureManager.getPageColumns()[t.yl.getPageIndex(l,t.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(p)+_.sum(p.getColumnWidths().slice(0,l%t.MN))},e.prototype.getCellItem=function(r,l,s){if(s)return this.renderMeta.rowNavigator.getCorner(l,r);var n=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(n,r)},e.prototype.getColumnHeaderOffset=function(r){return this.renderMeta.viewport.left-this.getColumnLeft(r,!1)},e}(d),y=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,z.__extends)(e,c),e.prototype.scrollToY=function(r){this.element.style.top=-r+"px"},e.prototype.adjustHeaders=function(){if(this.rowHeaderType!==o.xU.Stepped&&!this.repeatRowHeaders){var r=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var l=r.getRowIndex(this),s=r.getColumnIndex(this),p=r.getPrefixCellHeight(l,s),u=l===r.renderMeta.visibleRowRange[0],n=d3.select(this).classed("secondary-rowheader")&&!u;if(d3.select(this).classed("visually-hidden",n),u&&!d3.select(this).classed("last-secondary-rowheader")){var h=r.getRowHeaderOffset(l),H=p-h;d3.select(this).style("transform","translateY(".concat(h,"px)")),d3.select(this).style("height",H+"px")}else n||(d3.select(this).style("transform",null),d3.select(this).style("height",p+"px"))})}},e.prototype.getPrefixCellBinding=function(r,l){var h,s=l,p=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),u=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(p,s,!0),n=this.rowLevelWidthMeasureManager.getLevelLeft(s);if(!u)return{attributes:{role:"rowheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:n+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===o.y2.Table){var H=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),f=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());h=f?this.renderMeta.rowNavigator.getIntersection(H,f):void 0}var b,m=this.renderMeta.rowNavigator.getHierarchyLeafAt(r+1);m&&(b=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(m,s,!0)),b===u&&(b=void 0);var T=this.getPrefixCellWidth(r,l),R=this.getPrefixCellHeight(r,l),k=this.renderMeta.rowNavigator.isLeaf(u),E=this.rowHeaderType===o.xU.Stepped,ie=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u),le=this.renderMeta.rowNavigator.getNodeLeafCount(u)-(r-ie),fe=!k&&!E&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u)===r,he=!k&&!E&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(u)!==r,Y=he&&1===le,de=this.renderType===o.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():T,ge=de+"px",ye=this.renderMeta.binder.getRowHeaderBinding(u,!1,this.onObject,!1,h,b,de,this.repeatRowHeaders?p:void 0,he);if(ye.classNames||(ye.classNames=[]),ye.attributes||(ye.attributes={}),ye.styleProperties||(ye.styleProperties={}),ye.classNames.push("prefix-cell"),fe&&ye.classNames.push("primary-rowheader"),he&&ye.classNames.push("secondary-rowheader"),Y&&ye.classNames.push("last-secondary-rowheader"),ye.attributes["column-index"]=l.toString(),ye.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),ye.attributes.tabindex="0",ye.styleProperties.position="absolute",ye.styleProperties.left=n+"px",ye.styleProperties.height=R+"px",ye.styleProperties.width=ge,ye.styleProperties["box-sizing"]="border-box",ye.styleProperties["pointer-events"]=this.renderType===o.y2.Table?"none":"auto",this.renderType===o.y2.Table){var me=u===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),we=this.renderMeta.rowNavigator.isLastItem(u,this.renderMeta.rowNavigator.getHierarchyItems()),Re=this.renderMeta.binder.getBorderInfo(me,we,!0,!0,!0,o.p0.Body);ye.styleProperties["--outline-top"]=Re.weightTop+1+"px",ye.styleProperties["--outline-right"]=Re.weightRight+1+"px",ye.styleProperties["--outline-bottom"]=Re.weightBottom+1+"px",ye.styleProperties["--outline-left"]=Re.weightLeft+1+"px",ye.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(ye,T),ye},e.prototype.getMainCellBinding=function(r,l){var s=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),p=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),u=this.renderMeta.rowNavigator.getIntersection(s,p),n=this.getRowHeight(r),h=this.getColumnWidth(l,!1),H=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(H+=this.rowLevelWidthMeasureManager.getHeadersWidth());var f=this.renderMeta.rowNavigator.getHierarchyLeafAt(r+1),m=f&&this.renderMeta.rowNavigator.getIntersection(f,p),b=this.renderMeta.binder.getBodyCellBinding(u,!1,n,h,!0,this.onObject,m,this.showTotalPlaceHolders);return b.classNames||(b.classNames=[]),b.attributes||(b.attributes={}),b.styleProperties||(b.styleProperties={}),b.classNames.push("main-cell"),b.attributes.role="gridcell",b.attributes["column-index"]=l.toString(),b.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),b.attributes.tabindex="0",b.styleProperties.position="absolute",b.styleProperties["box-sizing"]="border-box",b.styleProperties.height="100%",b.styleProperties.width=h+"px",b.styleProperties.left=H+"px",b.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(b,h),b},e.prototype.getAriaRowIndex=function(r){return r+1+this.renderMeta.columnNavigator.getHierarchyDepth()},e.prototype.getRowHeight=function(r){return this.rowHeightMeasureManager.getPageRows()[t.yl.getPageIndex(r,t.hw)].getRowHeights()[r%t.hw]},e.prototype.getRowTop=function(r){var s=this.rowHeightMeasureManager.getPageRows()[t.yl.getPageIndex(r,t.hw)];return this.rowHeightMeasureManager.getPageRowTop(s)+_.sum(s.getRowHeights().slice(0,r%t.hw))},e.prototype.getPrefixCellWidth=function(r,l){var s=this;if(this.rowHeaderType===o.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var p=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,p),h=(0,q.zG)(n,this.renderMeta.rowNavigator);return _.sum(_.range(p,p+h-1+1).map(function(f){return s.rowLevelWidthMeasureManager.getLevelWidth(f)}))},e.prototype.getPrefixCellHeight=function(r,l){var s=this;if(this.renderType===o.y2.Table||this.rowHeaderType===o.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(r);var p=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,p),h=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(n),H=this.renderMeta.rowNavigator.getNodeLeafCount(n)-(r-h),f=this.rowHeightMeasureManager.getLastMeasuredIndex(),m=Math.min(r+H-1,f);return _.sum(_.range(r,m+1).map(function(b){return s.rowHeightMeasureManager.getRowHeight(b)}))},e.prototype.getPrefixCellLeft=function(r,l){return this.getColumnLeft(l,!0)},e.prototype.getMainCellWidth=function(r,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(r,l){return this.getRowHeight(r)},e.prototype.getMainCellLeft=function(r,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(r,l,s){if(s){var p=l,u=this.renderMeta.rowNavigator.getHierarchyLeafAt(r);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(u,p)}var n=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),h=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(n,h)},e.prototype.getRowHeaderOffset=function(r){return this.renderMeta.viewport.top-this.getRowTop(r)},e}(d),I=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return(0,z.__extends)(e,c),e.prototype.adjustHeaders=function(){for(var s=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),p=0,u=d3.select(this.element).selectAll(".row").nodes().reverse();p<u.length;p++)d3.select(u[p]).attr("aria-rowindex",s--)},e.prototype.getPrefixCellBinding=function(r,l){var s=this.rowHeightMeasureManager.getFloatingRowHeight(r),p=this.rowLevelWidthMeasureManager.getHeadersWidth(),u=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),n=this.renderMeta.binder.getRowHeaderBinding(u,!1,this.onObject,!0,void 0,void 0,p);return n.classNames||(n.classNames=[]),n.attributes||(n.attributes={}),n.styleProperties||(n.styleProperties={}),n.classNames.push("prefix-cell"),n.attributes.role="rowheader",n.attributes["column-index"]=l.toString(),n.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),n.attributes.tabindex="0",n.styleProperties.position="absolute",n.styleProperties.left="0",n.styleProperties.height=s+"px",n.styleProperties.width=p+"px",n.styleProperties["box-sizing"]="border-box",n.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(n,p),n},e.prototype.getMainCellBinding=function(r,l){var s=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),p=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),u=this.renderMeta.rowNavigator.getIntersection(s,p),n=this.getRowHeight(r),h=this.getColumnWidth(l,!1),H=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(H+=this.rowLevelWidthMeasureManager.getHeadersWidth());var f=this.renderMeta.binder.getBodyCellBinding(u,!1,n,h,!0,this.onObject,void 0,this.showTotalPlaceHolders);return f.classNames||(f.classNames=[]),f.attributes||(f.attributes={}),f.styleProperties||(f.styleProperties={}),f.classNames.push("main-cell"),f.attributes.role="gridcell",f.attributes["column-index"]=l.toString(),f.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),f.attributes.tabindex="0",f.styleProperties.position="absolute",f.styleProperties["box-sizing"]="border-box",f.styleProperties.height="100%",f.styleProperties.width=h+"px",f.styleProperties.left=H+"px",f.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(f,h),f},e.prototype.getAriaRowIndex=function(r){return-1},e.prototype.getRowHeight=function(r){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[r]},e.prototype.getRowTop=function(r){var l=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(l)+_.sum(l.getRowHeights().slice(0,r))},e.prototype.getPrefixCellWidth=function(r,l){return this.rowLevelWidthMeasureManager.getHeadersWidth()},e.prototype.getPrefixCellHeight=function(r,l){return this.rowHeightMeasureManager.getFloatingRowHeight(r)},e.prototype.getPrefixCellLeft=function(r,l){return 0},e.prototype.getMainCellWidth=function(r,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(r,l){return this.getRowHeight(r)},e.prototype.getMainCellLeft=function(r,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(r,l,s){if(s)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r);var p=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(p,u)},e}(d),M=function(c){return c[c.Default=0]="Default",c[c.ColumnResizing=1]="ColumnResizing",c[c.RowLevelResizing=2]="RowLevelResizing",c}({}),Q=function(){function c(e,r,l,s,p,u,n,h,H,f,m,b,T,R,k){var E=this;this.hostServices=h,this.visualStyle=H,this.showTotalPlaceHolders=T,this.subSelectionHelper=R,this.showAsTableNativeMenu=k,this.unfrozenRowHeaders=!1,this.isA11yTable=s,this.isA11yMatrix=p,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=u,this.enableCalculationHighlighting=n,this.sizeManager=r,this.scrollingEnabled=l.scrollingEnabled;var ie=h.getLocalizedString(G.iC),le=h.getLocalizedString(G.Hw),fe=h.getLocalizedString(G.dm),he=h.getLocalizedString(G.Ds),Y=b?"interactive-grid":"",de="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(ie,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(le,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(fe,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(he,"</button>\n                    <div role='grid' class='").concat(Y," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");e.insertAdjacentHTML("beforeend",de),this.element=e.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(D.oy,(0).toString()),this.midViewport.setAttribute(D.oy,(0).toString()),this.botViewport.setAttribute(D.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var ge,be;null===(ge=E.rowScrollbar)||void 0===ge||ge.scrollPageUp();var ye=E.getViewport(),me=t._E.getVisibleRange(ye.top,ye.height,E.rowHeightMeasureManager,t.hw,null===(be=E.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());f(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var ge,be;null===(ge=E.rowScrollbar)||void 0===ge||ge.scrollPageDown();var ye=E.getViewport(),me=t._E.getVisibleRange(ye.top,ye.height,E.rowHeightMeasureManager,t.hw,null===(be=E.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());f(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var ge,be;null===(ge=E.columnScrollbar)||void 0===ge||ge.scrollPageUp();var ye=E.getViewport(),me=t.sW.getVisibleRange(ye.left,ye.width,E.columnWidthMeasureManager,t.MN,null===(be=E.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());m(me.firstLeafIndex,me.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var ge,be;null===(ge=E.columnScrollbar)||void 0===ge||ge.scrollPageDown();var ye=E.getViewport(),me=t.sW.getVisibleRange(ye.left,ye.width,E.columnWidthMeasureManager,t.MN,null===(be=E.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());m(me.firstLeafIndex,me.lastLeafIndex)}),this.options=l,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(ge){return E.onClick(ge)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new te(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new B(this,!0)),$(this.element).on(pe.BZ,function(){return E.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(ge){return E.onKeyDown(ge)}),this.keyUpState=M.Default,this.element.addEventListener("keyup",function(){return E.onKeyUp()}),this.focusManager=new O(function(){return E.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),l.scrollingEnabled&&this.attachScrollEventHandlers()}return c.prototype.onShowTotalPlaceHoldersChanged=function(e){e!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=e,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=e),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=e),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=e))},c.prototype.updateOptions=function(e){this.options=e},c.prototype.attachScrollEventHandlers=function(){var e=this;L.l.runOutsideAngular(function(){e.midViewport.style.overflowY="auto",e.midViewport.addEventListener("scroll",function(){return e.scrollTo(null,e.midViewport.scrollTop)}),e.innerContainer.addEventListener("wheel",function(r){var l;performance.now()-e.prevHorizontalWheelTime>100&&(e.propagateWheel=void 0),clearInterval(e.momentumScrollHandle);var s=!r.shiftKey&&Math.abs(r.deltaX)<=Math.abs(r.deltaY);if(!e.propagateWheel&&!s){var p=r.shiftKey&&Math.abs(r.deltaX)<=Math.abs(r.deltaY)?r.deltaY:r.deltaX,u=Math.max(Math.min(p,c.ScrollDeltaMax),-c.ScrollDeltaMax),n=e.scrollBy(u,0);null!==(l=e.propagateWheel)&&void 0!==l||(e.propagateWheel=!n),e.propagateWheel||(r.stopPropagation(),r.preventDefault()),e.prevHorizontalWheelTime=performance.now()}}),e.innerContainer.addEventListener("touchstart",function(r){clearInterval(e.momentumScrollHandle),e.propagateTouch=r.touches.length>1||void 0,e.touchPreviousX=r.touches[0].clientX,e.touchPreviousY=r.touches[0].clientY}),e.innerContainer.addEventListener("touchmove",function(r){var l,s;if(!e.propagateTouch){var p=e.touchPreviousX-r.touches[0].clientX,u=e.touchPreviousY-r.touches[0].clientY;if(null!==(l=e.propagateTouch)&&void 0!==l||(e.propagateTouch=0===p||Math.abs(p)<=Math.abs(u)||void 0),!e.propagateTouch){e.touchDeltaX=Math.max(Math.min(p,c.ScrollDeltaMax),-c.ScrollDeltaMax),e.touchPreviousX=r.touches[0].clientX,e.touchPreviousY=r.touches[0].clientY;var n=e.scrollBy(e.touchDeltaX,0);null!==(s=e.propagateTouch)&&void 0!==s||(e.propagateTouch=!n),e.propagateTouch||(r.stopPropagation(),r.preventDefault())}}}),e.innerContainer.addEventListener("touchend",function(){if(!e.propagateTouch){var r=e.renderIteration;e.momentumScrollHandle=setInterval(function(l){l[0]+=1/120;var s=e.touchDeltaX*(1-d3.easeCircleOut(l[0]));r!==e.renderIteration||l[0]>=120||Math.abs(s)<1?clearInterval(e.momentumScrollHandle):e.scrollBy(s,0)},1e3/60,[0])}})})},c.prototype.onFocusManagerEnter=function(){var e;null===(e=this.hostServices.telemetry())||void 0===e||e.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},c.prototype.onKeyUp=function(){switch(this.keyUpState){case M.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=M.Default;break;case M.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=M.Default;break;case M.Default:break;default:se.fF.assertNever(this.keyUpState)}},c.prototype.onKeyDown=function(e){var r=this;if(this.renderLock||this.keyboardLock)return e.stopPropagation(),void e.preventDefault();this.updateFocus();var l=e.code||e.key,s=e.shiftKey,p=ue.M.isCtrlOrMeta(e),u=e.altKey,n=this.isA11yTable,h=this.isA11yMatrix;if("Escape"!==l&&"Esc"!==l&&"Tab"!==l){if("ArrowRight"===l||"Right"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s){if(r.focusManager.CurrentFocus.columnHeader&&r.columnWidthResizeHandler)return r.columnWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.columnWidthResizeHandler.onResize({x:1,y:0}),void(r.keyUpState=M.ColumnResizing);if(r.focusManager.CurrentFocus.cornerCell&&r.columnWidthResizeHandler)return r.rowLevelWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(r.keyUpState=M.RowLevelResizing);r.options.rowHeaderExpandCollapseHandler&&r.focusManager.CurrentFocus.rowHeader&&1===r.rowNavigator.getExpansionState(r.focusManager.CurrentFocus.item)&&r.options.rowHeaderExpandCollapseHandler(r.focusManager.CurrentFocus.item,!1)}else r.focusManager.moveFocus("right",p,n,h)});if("ArrowLeft"===l||"Left"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s){if(r.focusManager.CurrentFocus.columnHeader&&r.columnWidthResizeHandler)return r.columnWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.columnWidthResizeHandler.onResize({x:-1,y:0}),void(r.keyUpState=M.ColumnResizing);if(r.focusManager.CurrentFocus.cornerCell&&r.columnWidthResizeHandler)return r.rowLevelWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(r.keyUpState=M.RowLevelResizing);r.options.rowHeaderExpandCollapseHandler&&r.focusManager.CurrentFocus.rowHeader&&0===r.rowNavigator.getExpansionState(r.focusManager.CurrentFocus.item)&&r.options.rowHeaderExpandCollapseHandler(r.focusManager.CurrentFocus.item,!0)}else r.focusManager.moveFocus("left",p,n,h)});if("ArrowUp"===l||"Up"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s&&!p){if(n){var H=r.focusManager.CurrentFocus;r.focusManager.moveFocus("up",p,n,h);var f=r.focusManager.CurrentFocus;r.selectFocus(e,H),r.selectFocus(e,f)}}else r.focusManager.moveFocus("up",p,n,h)});if("ArrowDown"===l||"Down"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(s&&!p){if(n){var H=r.focusManager.CurrentFocus;r.focusManager.moveFocus("down",p,n,h);var f=r.focusManager.CurrentFocus;r.selectFocus(e,H),r.selectFocus(e,f)}}else r.focusManager.moveFocus("down",p,n,h)});if("Home"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("home",p,n,h)});if("End"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("end",p,n,h)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("pagedown",p,n,h,r.getNumberOfVisibleRows())});if("PageUp"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("pageup",p,n,h,r.getNumberOfVisibleRows())})}if("F10"===l&&s)return p?void 0:(e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.showContextMenuForFocus(e)}));if("Enter"===l||"Space"===l||"Spacebar"===l||" "===l)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.selectFocus(e,r.focusManager.CurrentFocus)});if("KeyO"===l&&p&&u)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.activateCellContent()});if(("KeyC"===l||"c"===l)&&p&&s)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.options.whitespaceClickHandler(null,!0)})}},c.prototype.runIfFrameReady=function(e){return(0,z.__awaiter)(this,void 0,void 0,function(){return(0,z.__generator)(this,function(r){switch(r.label){case 0:return this.keyboardLock=!0,e(),[4,this.requestAnimationFrameAsync()];case 1:return r.sent(),this.keyboardLock=!1,[2]}})})},c.prototype.notifyVisual=function(e){e.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item,e.bodyCell.rowIndex):e.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(e.item):e.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(e.item):e.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(e.item):e.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item):void 0!==e.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(e.item)},c.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e,this.topRenderer.setUnfrozenRowHeaders(e),this.midRenderer.setUnfrozenRowHeaders(e),this.botRenderer.setUnfrozenRowHeaders(e)},c.prototype.setRepeatRowHeaders=function(e){this.topRenderer.setRepeatRowHeaders(e),this.midRenderer.setRepeatRowHeaders(e),this.botRenderer.setRepeatRowHeaders(e)},c.prototype.onFocusChanged=function(){var e,r=this.focusManager.CurrentFocus;se.fF.assertValue(r,"No current focus"),this.notifyVisual(r);var s,p,u,n,h,H,le,fe,l=this.getViewport();if(r.bodyCell)r.bodyCell.columnIndex>=0&&(n=r.bodyCell.columnIndex),s=r.bodyCell.rowIndex;else if(r.rowHeader){var f=t._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager),m=(0,q.hG)(r.item,this.rowNavigator),b=(0,q.O3)(r.item,this.rowNavigator);m<=f.firstLeafIndex||b-m+1>=f.lastLeafIndex-f.firstLeafIndex+1?(s=m,p=!1):(s=Math.min(b,this.rowHeightMeasureManager.getLastMeasuredIndex()),p=!0)}else if(r.columnHeader){var k=t.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager);m=(0,q.hG)(r.item,this.columnNavigator),b=(0,q.O3)(r.item,this.columnNavigator),m<=k.firstLeafIndex||b-m+1>=k.lastLeafIndex-k.firstLeafIndex+1?(n=m,H=!1):(n=Math.min(b,this.columnWidthMeasureManager.getLastMeasuredIndex()),H=!0)}else r.floatingBodyCell&&(n=r.floatingBodyCell.columnIndex);if(void 0!==s&&this.rowScrollbar.visible&&(f=t._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager))&&(s<=f.firstLeafIndex?u={rowIndex:s,visibleHeight:Number.MAX_VALUE,alignBottom:p??!1}:s>=f.lastLeafIndex&&(u={rowIndex:s,visibleHeight:Number.MAX_VALUE,alignBottom:p??!0})),void 0!==n&&this.columnScrollbar.visible&&(k=t.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager))&&(n<=k.firstLeafIndex?h=this.unfrozenRowHeaders&&0===n&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:H??!1}:n>=k.lastLeafIndex&&(h={columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:H??!0})),u&&(le=t._E.getOffset(u,this.rowHeightMeasureManager),u.alignBottom&&(le-=this.rowScrollbar.viewSize)),h&&(fe=t.sW.getOffset(h,this.columnWidthMeasureManager),h.alignRight&&(fe-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(fe+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(r.cornerCell||r.rowHeader||r.floatingRowHeader)){var he=this.getFocusedCell(r),Y=he.offsetLeft,de=he.offsetWidth;fe=Y<this.columnScrollbar.viewMin||de>this.columnScrollbar.viewSize?Y:Y+de>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?Y-this.columnScrollbar.viewSize:null}this.scrollTo(fe,le),null===(e=this.getFocusedCell(r))||void 0===e||e.focus({preventScroll:!0})},c.prototype.getFocusedCell=function(e){var r,l;if(e.bodyCell)return-1===e.bodyCell.columnIndex?this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,0,o.aP.Prefix):this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,e.bodyCell.columnIndex,o.aP.Main);if(e.columnHeader){var s=e.item,p=this.columnNavigator.getLevel(s),u=void 0;return u=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(s):null!==(r=this.rowNavigator.getLeafIndex(s))&&void 0!==r?r:this.rowNavigator.getIndexOfFirstLeaf(s),this.topRenderer.getElementByIndex(p,u,o.aP.Main)}if(e.rowHeader){var n=e.item;return p=null!==(l=this.columnNavigator.getLeafIndex(n))&&void 0!==l?l:this.columnNavigator.getIndexOfFirstLeaf(n),u=this.steppedLayout?0:this.rowNavigator.getLevel(n),this.midRenderer.getElementByIndex(p,u,o.aP.Prefix)}return e.cornerCell?this.topRenderer.getElementByIndex(e.cornerCell.columnLevel,e.cornerCell.rowLevel,o.aP.Prefix):e.floatingBodyCell?this.botRenderer.getElementByIndex(e.floatingBodyCell.rowIndex,e.floatingBodyCell.columnIndex,o.aP.Main):null!=e.floatingRowHeader?this.botRenderer.getElementByIndex(e.floatingRowHeader,0,o.aP.Prefix):void se.fF.assertFail("Unexpected focused item")},c.prototype.getCurrentFocusBoundingRect=function(){var e=document.activeElement;if(e){var r=e.getBoundingClientRect();return{top:r.top,left:r.left,width:r.width,height:r.height}}return{top:0,left:0,width:0,height:0}},c.prototype.selectFocus=function(e,r){var l=r.item,s=this.createMouseEvent(e);r.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,s,r.bodyCell.rowIndex,o.p0.Body):r.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,s,void 0,o.p0.Footer):r.rowHeader||void 0!==r.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(l,s):r.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(l,s):r.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(l,s):se.fF.assertFail("Unexpected focused item")},c.prototype.activateCellContent=function(){var r=document.activeElement;if(r&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var l=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(r,l)}},c.prototype.createSimpleMouseClickEvent=function(){var e=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:e.left,clientY:e.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},c.prototype.createMouseEvent=function(e){var r=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:r.left,clientY:r.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey})},c.prototype.showContextMenuForFocus=function(e){var r,l=this.focusManager.CurrentFocus;if(-1!==(null===(r=l.bodyCell)||void 0===r?void 0:r.columnIndex)){se.fF.assertValue(l&&l.item,"Keyboard Selection triggered with no focused cell");var s=l.item,p=this.getCurrentFocusBoundingRect(),u=new MouseEvent("contextmenu",{clientX:p.left,clientY:p.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey});l.bodyCell||l.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(s,u):l.rowHeader||void 0!==l.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(s,u):l.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(s,u):l.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(s,u):se.fF.assertFail("Unexpected focused item")}},c.prototype.onClick=function(e){var r=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),l=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(r>=this.width&&l>=this.height)){var s=(0,Z.ut)(this.element,e);(s.x>r||s.y>l)&&this.options.whitespaceClickHandler(e)}},c.prototype.initializeScrollbars=function(){var e=this;this.columnScrollbar=new W.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,C.S)(i.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar=new W.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,C.S)(i.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},c.prototype.setSteppedLayout=function(e){if(e!==this.steppedLayout){this.steppedLayout=e;var r=e?o.xU.Stepped:o.xU.Blocked;this.columnWidthMeasureManager=new t.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new t.FA(this.measureElement,this.sizeManager):new t.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new t.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new t.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new t.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},c.prototype.createRenderers=function(){var e=this,r=this.isA11yTable?o.y2.Table:o.y2.Matrix;this.topRenderer=new v(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,o.p0.Header,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new y(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,o.p0.Body,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new I(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,o.p0.Footer,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},c.prototype.setWidth=function(e){this.width=e,this.element.style.width=(0,C.S)(this.width),this.columnScrollbar.invalidateArrange()},c.prototype.setHeight=function(e){this.height=e,this.element.style.height=(0,C.S)(this.height),this.rowScrollbar.invalidateArrange()},c.prototype.getWidth=function(){return this.width},c.prototype.getHeight=function(){return this.height},c.prototype.setClassName=function(e){this.element.className=e},c.prototype.setColumnNavigator=function(e){this.columnNavigator=e,this.focusManager.columnNavigator=e},c.prototype.setRowNavigator=function(e){this.rowNavigator=e,this.focusManager.rowNavigator=e},c.prototype.setBinder=function(e){this.binder=e},c.prototype.getSteppedLayout=function(){return this.steppedLayout},c.prototype.getColumnNavigator=function(){return this.columnNavigator},c.prototype.getRowNavigator=function(){return this.rowNavigator},c.prototype.getSizeManager=function(){return this.sizeManager},c.prototype.getBinder=function(){return this.binder},c.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},c.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},c.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},c.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},c.prototype.getTopRenderer=function(){return this.topRenderer},c.prototype.getMidRenderer=function(){return this.midRenderer},c.prototype.getBotRenderer=function(){return this.botRenderer},c.prototype.getViewport=function(){var e=this.columnScrollbar.viewMin,r=this.rowScrollbar.viewMin,l=this.columnScrollbar.viewSize,s=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(e=Math.max(e-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),l-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:e,top:r,width:l=Math.max(l,0),height:s=Math.max(s,0)}},c.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?i.zf:0)},c.prototype.storeFocus=function(){var r,l,s,p,e=document.activeElement;if(this.topViewport.contains(e))this.topRenderer.isPrefixCell(e)?(r=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),s=o.p0.Header,p=o.aP.Prefix):(r=this.topRenderer.getRowIndex(e),l=this.topRenderer.getColumnIndex(e),s=o.p0.Header,p=o.aP.Main);else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?(r=this.midRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),s=o.p0.Body,p=o.aP.Prefix):(r=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),s=o.p0.Body,p=o.aP.Main);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?(r=this.botRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),s=o.p0.Footer,p=o.aP.Prefix):(r=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),s=o.p0.Footer,p=o.aP.Main);else if(this.isA11yTable){var n=d3.select(this.topViewport).select(".main-cell").node();r=this.topRenderer.getRowIndex(n),l=this.topRenderer.getColumnIndex(n),s=o.p0.Header,p=o.aP.Main}else{var h=d3.select(this.topViewport).select(".prefix-cell").node();r=this.topRenderer.getRowIndex(h),l=this.topRenderer.getColumnIndex(h),s=o.p0.Header,p=o.aP.Prefix}this.tempFocus={rowIndex:r,columnIndex:l,section:s,region:p}},c.prototype.restoreFocus=function(){var r,e=this;se.fF.assert(function(){return!!e.tempFocus},"tempFocus must be defined"),this.tempFocus.section===o.p0.Header?r=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===o.p0.Body?r=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,o.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===o.p0.Footer&&(r=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),r||(this.updateFocus(),r=this.getFocusedCell(this.focusManager.CurrentFocus)),r.focus({preventScroll:!0})},c.prototype.updateFocus=function(){var r,l,s,p,e=document.activeElement;if(this.topViewport.contains(e))if(this.topRenderer.isPrefixCell(e))r=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),s=this.isA11yTable?o.p0.Header:o.p0.MatrixCorner;else{var n=this.topRenderer.getItemByElement(e);s=o.p0.Header,p=this.columnNavigator.getPathIndices(n)}else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?this.isA11yTable?(r=this.midRenderer.getRowIndex(e),l=-1,s=o.p0.Body):(n=this.midRenderer.getItemByElement(e),s=o.p0.MatrixRowHeader,p=this.rowNavigator.getPathIndices(n)):(r=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),s=o.p0.Body);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?this.isA11yTable?(r=this.botRenderer.getRowIndex(e),l=-1,s=o.p0.Footer):(r=this.botRenderer.getRowIndex(e),s=o.p0.FooterHeader):(r=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),s=o.p0.Footer);else if(this.isA11yTable){var h=d3.select(this.topViewport).select(".main-cell").node();r=this.topRenderer.getRowIndex(h),l=this.topRenderer.getColumnIndex(h),s=o.p0.Header}else{var H=d3.select(this.topViewport).select(".prefix-cell").node();r=this.topRenderer.getRowIndex(H),l=this.topRenderer.getColumnIndex(H),s=o.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(r,l,s,p)},c.prototype.scrollBy=function(e,r){if(this.renderLock)return!1;var l,s;if(e){var p=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(e,!0),this.columnScrollbar.refresh(),l=p!==this.columnScrollbar.viewMin}if(r){var n=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(r,!0),this.rowScrollbar.refresh(),s=n!==this.rowScrollbar.viewMin}return!(!l&&!s||(this.refresh(),0))},c.prototype.scrollTo=function(e,r){this.renderLock||(null!=e&&(this.columnScrollbar.scrollTo(e,!0),this.columnScrollbar.refresh()),null!=r&&(this.rowScrollbar.scrollTo(r,!0),this.rowScrollbar.refresh()),this.refresh())},c.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var e=this.getViewport(),r=this.columnScrollbar.viewMin,l=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(r),this.midRenderer.scrollToX(r),this.botRenderer.scrollToX(r),this.midViewport.scrollTop=l,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator)}},c.prototype.renderAsync=function(e,r,l){return(0,z.__awaiter)(this,void 0,void 0,function(){var s,p,u,n,h;return(0,z.__generator)(this,function(H){switch(H.label){case 0:return s=++this.renderIteration,e===o.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(r,l,s)];case 1:return h=H.sent(),p=h[0],u=h[1],s!==this.renderIteration||(this.unlockRendering(),(n=this.element.contains(document.activeElement))&&this.storeFocus(),(e===o.BM.ClearRendering||e===o.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(p,u),e===o.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),n&&(e===o.BM.ClearRendering||e===o.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},c.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},c.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},c.prototype.measureAsync=function(e,r,l){return(0,z.__awaiter)(this,void 0,void 0,function(){var s,p,u,n,h,H,f;return(0,z.__generator)(this,function(m){switch(m.label){case 0:if(h=this.getViewport(),e?n=e.rowIndex:(H=t._E.getVisibleRange(h.top,h.height,this.rowHeightMeasureManager),n=H?H.firstLeafIndex:0),r?u=r.columnIndex:(f=t.sW.getVisibleRange(h.left,h.width,this.columnWidthMeasureManager),u=f?f.firstLeafIndex:0),u=Math.max(0,Math.floor(u-t.EO/2)),!r)return[3,4];m.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&r.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,3];case 2:return m.sent(),l!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return s=t.sW.getOffset(r,this.columnWidthMeasureManager),r.alignRight&&(s-=this.columnScrollbar.viewSize),[3,5];case 4:s=this.columnScrollbar.viewMin,m.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-s<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,7];case 6:return m.sent(),l!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,t.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,n,u,t.EO),!e)return[3,11];m.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&e.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,u),[4,this.setTimeoutAsync()]):[3,10];case 9:return m.sent(),l!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return p=t._E.getOffset(e,this.rowHeightMeasureManager),e.alignBottom&&(p-=this.rowScrollbar.viewSize),[3,12];case 11:p=this.rowScrollbar.viewMin,m.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-p<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,u),[4,this.setTimeoutAsync()]):[3,14];case 13:return m.sent(),l!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,n,u,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,u,t.EO),this.measurePageColumnsAsync(n,l),this.measurePageRowsAsync(n,u,l),[2,[s,p]]}})})},c.prototype.updateAria=function(){var e=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),r=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",e),d3.select(this.innerContainer).attr("aria-colcount",r)},c.prototype.setTimeoutAsync=function(e){return void 0===e&&(e=0),(0,z.__awaiter)(this,void 0,void 0,function(){return(0,z.__generator)(this,function(r){return[2,new J.J(function(l){return L.l.setTimeout(function(){return l()},e)})]})})},c.prototype.requestAnimationFrameAsync=function(){return(0,z.__awaiter)(this,void 0,void 0,function(){return(0,z.__generator)(this,function(e){return[2,new J.J(function(r){return L.l.requestAnimationFrame(function(){return r()})})]})})},c.prototype.getVisibleRowStart=function(){var e=this.getViewport(),r=t._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);return r?t._E.getVisibleRowStart(r,e.top,this.rowHeightMeasureManager):null},c.prototype.getVisibleColumnStart=function(){var e=this.getViewport(),r=t.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager);return r?t.sW.getVisibleColumnStart(r,e.left,this.columnWidthMeasureManager):null},c.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},c.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},c.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},c.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,C.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var e=(0,C.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=e},c.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var e=this.rowHeightMeasureManager.getFloatingRowHeights(),r=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-e,l=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),s=this.rowHeightMeasureManager.getRowsHeight(),p=this.columnWidthMeasureManager.getColumnsWidth(),u=this.options.scrollingEnabled&&s>0&&s>r,n=this.options.scrollingEnabled&&p>0&&p>l;!u&&n&&s>0&&(u=s>r-i.zf),!n&&u&&p>0&&(n=p>l-i.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=u?this.rowScrollbar.width:(0,C.S)(0);var H,f,h=n?i.zf:0;s>r-h?(H=h+e,f=h):(H=r+e-s,f=r-s),this.midViewport.style.bottom=(0,C.S)(H),this.botViewport.style.bottom=(0,C.S)(f),this.rowScrollbar.show(u),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=n?i.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(n),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=u?i.zf+"px":"0",this.columnScrollbar.refresh()},c.prototype.getBodyCellWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-e,r)},c.prototype.measurePageColumnsAsync=function(e,r){return(0,z.__awaiter)(this,void 0,void 0,function(){return(0,z.__generator)(this,function(l){switch(l.label){case 0:return[4,this.setTimeoutAsync(i.yv)];case 1:if(l.sent(),r!==this.renderIteration)return[2];l.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(i.yv)]):[3,4];case 3:return l.sent(),r!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},c.prototype.measurePageRowsAsync=function(e,r,l){return(0,z.__awaiter)(this,void 0,void 0,function(){return(0,z.__generator)(this,function(s){switch(s.label){case 0:return[4,this.setTimeoutAsync(i.yv)];case 1:if(s.sent(),l!==this.renderIteration)return[2];s.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e,r),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(i.yv)]):[3,4];case 3:return s.sent(),l!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},c.prototype.updateScrollRegionWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth(),l=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?r+e:r,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?l:l-e,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},c.prototype.updateScrollRegionHeight=function(){var e=this.rowHeightMeasureManager.getRowsHeight(),r=this.midViewport.clientHeight,l=(0,C.S)(Math.max(e,r));this.innerBodyCellContainer.style.height=l,this.rowScrollbar.max=e,this.rowScrollbar.viewSize=r,this.rowScrollbar.refresh()},c.prototype.getNumberOfVisibleRows=function(){var e=this.getViewport(),r=t._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);if(r)return Math.max(0===r.firstLeafIndex?r.lastLeafIndex-r.firstLeafIndex:r.lastLeafIndex-r.firstLeafIndex-1,1)},c.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},c.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},c.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},c.prototype.destroy=function(){this.renderIteration=NaN},c.ScrollDeltaMax=200,c}()},44102:function(_e,Se,U){U.d(Se,{AT:function(){return t},Xg:function(){return q},fw:function(){return W}});var z=U(81337),pe=U(66232),se=U(62458),ue=U(87914),J=U(93340),L="unselectable";function W(C,i){if(C)for(var o=0,w=C;o<w.length;o++)(0,w[o])(i)}var Z=function(){function C(i,o){this._owner=i,this._direction=o,this._timerHandle=void 0,this.createView();var w=this;this._element.addEventListener("mousedown",function(O){w.onMouseDown(O)}),$(this._element).addClass(L),$(this._svg).addClass(L),$(this._polygon).addClass(L)}return Object.defineProperty(C.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),C.prototype.createView=function(){var i="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(i,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",C.ARROW_COLOR),this._svg=document.createElementNS(i,"svg");var o=this._svg.style;o.position="absolute",o.left="0px",o.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=G.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},C.prototype.onMouseDown=function(i){var o=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){i.cancelBubble=!0;var w=this;this._mouseUpWrapper=function(O){w.onMouseUp(O)},G.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){o.onMouseDown(i)},100),i.preventDefault&&i.preventDefault()},C.prototype.onMouseUp=function(i){clearTimeout(this._timerHandle),G.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},C.prototype.arrange=function(i,o,w){var O=Math.min(i,o);this._polygon.setAttributeNS(null,"transform","translate("+(i-O)/2+", "+(o-O)/2+") scale("+O/16+") rotate("+w+",8,8)"),this._svg.setAttributeNS(null,"width",i+"px"),this._svg.setAttributeNS(null,"height",o+"px"),(0,J.Py)(this._element,i),(0,J.Iw)(this._element,o)},C.MIN_WIDTH=26,C.ARROW_COLOR="#404040",C}(),G=function(){function C(i,o,w,O){this.isModern=w,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(i,o);var D=this;this._element.addEventListener("mousedown",function(N){D.onBackgroundMouseDown(N)}),this._element.addEventListener("pointerdown",function(N){(0,pe.n)(N)}),this._element.addEventListener("dblclick",function(N){(0,pe.n)(N)}),this._middleBar.addEventListener("mousedown",function(N){D.onMiddleBarMouseDown(N)}),this._middleBar.addEventListener("pointerdown",function(N){(0,pe.n)(N)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(L),this.onScrollBehavior=O}return C.prototype.scrollBy=function(i,o){this.scrollTo(this.viewMin+i,o)},C.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},C.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},C.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},C.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(C.prototype,"width",{get:function(){return this._width},set:function(o){this._width=o,this._element.style.width=o,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"height",{get:function(){return this._height},set:function(o){this._height=o,this._element.style.height=o,this.invalidateArrange()},enumerable:!1,configurable:!0}),C.prototype.refresh=function(){se.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(C.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),C.prototype._scrollSmallIncrement=function(i){this.scrollBy(this.smallIncrement*i)},Object.defineProperty(C.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),C.prototype.show=function(i){this._visible=i,this.element.style.visibility=i?"visible":"hidden",this.invalidateArrange()},C.prototype._getMouseOffset=function(i){return void 0!==i.offsetX?{x:i.offsetX,y:i.offsetY}:void 0!==i.layerX?{x:i.layerX,y:i.layerY}:{x:i.screenX,y:i.screenY}},C.prototype._getOffsetXDelta=function(i){return(i.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},C.prototype._getOffsetYDelta=function(i){return(i.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},C.prototype._getOffsetXTouchDelta=function(i){return this._getMouseOffset(i).x-this._offsetTouchPrevPos.x},C.prototype._getOffsetYTouchDelta=function(i){return this._getMouseOffset(i).y-this._offsetTouchPrevPos.y},C.prototype.onTouchStart=function(i){1===i.touches.length&&this.onTouchMouseDown(i.touches[0])},C.prototype.onTouchMove=function(i){1===i.touches.length&&(i.preventDefault&&i.preventDefault(),this.onTouchMouseMove(i.touches[0]))},C.prototype.onTouchEnd=function(i){this.onTouchMouseUp(1===i.touches.length?i.touches[0]:i,!0)},C.prototype.onTouchMouseDown=function(i){!this._allowMouseDrag&&i.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},C.prototype._getOffsetTouchDelta=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},C.prototype.onTouchMouseMove=function(i){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(i));var o=this._getOffsetTouchDelta(i);0!==o&&(this.scrollBy(-o/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(i)),i.preventDefault&&i.preventDefault(),i.cancelBubble=!0}},C.prototype.onTouchMouseUp=function(i,o){if(this._touchStarted&&this._offsetTouchStartPos){var w=this._getMouseOffset(i);!o&&(Math.abs(this._offsetTouchStartPos.x-w.x)>3||Math.abs(this._offsetTouchStartPos.y-w.y)>3)&&(i.preventDefault&&i.preventDefault(),i.cancelBubble=!0)}this._touchStarted=!1},C.prototype.createView=function(i,o){this._element=document.createElement("div"),this._element.className=C.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(ue.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===o&&i.appendChild(this._element),this.isModern||(this._minButton=new Z(this,-1),this._maxButton=new Z(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=C.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(ue.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},C.prototype.scrollTo=function(i,o){var w=Math.min(this.max-this.viewSize,Math.max(this.min,i));(w=Math.max(this.min,w))!==this.viewMin&&(this.viewMin=w,o||W(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},C.prototype._scrollByPage=function(i){se.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},C.prototype._getRunningSize=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},C.prototype._getOffsetDelta=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},C.prototype.scroll=function(i){var o=this._getOffsetDelta(i)/this._getRunningSize(!0)*(this.max-this.min);if(o<0){if(this._getScreenMousePos(i)>=this._screenMaxMousePos)return}else if(o>0&&this._getScreenMousePos(i)<=this._screenMinMousePos)return;this.scrollBy(o)},Object.defineProperty(C.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),C.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},C.prototype._calculateButtonWidth=function(){return se.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},C.prototype._calculateButtonHeight=function(){return se.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},C.prototype._getMinButtonAngle=function(){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},C.prototype._getMaxButtonAngle=function(){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},C.prototype._setMaxButtonPosition=function(){se.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},C.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},C.prototype.onHoldBackgroundMouseDown=function(i){var o=this;this._timerHandle=setTimeout(function(){o.onBackgroundMouseDown(i)},this._timerHandle?C.ScrollbarBackgroundMousedownHoldDelay:C.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},C.prototype.onBackgroundMouseDown=function(i){var o=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(i.cancelBubble=!0,this._backgroundMouseUpWrapper=function(w){o.onBackgroundMouseUp(w)},C.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(i),this.refresh(),this.onHoldBackgroundMouseDown(i),i.preventDefault&&i.preventDefault()},C.prototype.onBackgroundMouseUp=function(i){clearTimeout(this._timerHandle),this._timerHandle=void 0,C.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},C.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},C.prototype.onMiddleBarMouseDown=function(i){i.cancelBubble=!0,this._screenPrevMousePos={x:i.screenX,y:i.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(i)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(i)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(i)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(i)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,J.df)(this.element)*this.getPinchZoomY();var o=this;this._middleBarMouseMoveWrapper=function(w){o.onMiddleBarMouseMove(w)},C.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(w){o.onMiddleBarMouseUp(w)},C.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),i.preventDefault&&i.preventDefault()},C.prototype.onMiddleBarMouseMove=function(i){this._screenPrevMousePos&&(this.scroll(i),this.refresh(),this._screenPrevMousePos={x:i.screenX,y:i.screenY})},C.prototype.onMiddleBarMouseUp=function(i){this._screenPrevMousePos=void 0,C.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,C.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,i.preventDefault&&i.preventDefault()},C.prototype._getScreenContextualLeft=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},C.prototype._getScreenContextualRight=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},C.prototype.onMouseWheel=function(i){i&&this.mouseWheel(i)},C.prototype.mouseWheel=function(i){this.visible&&(i<0?i=Math.min(-C.MouseWheelRange,i):i>0&&(i=Math.max(C.MouseWheelRange,i)),this.scrollBy(-i/C.MouseWheelRange*this.smallIncrement))},C.prototype._getScreenMousePos=function(i){return se.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},C.addDocumentMouseUpEvent=function(i){document.addEventListener("mouseup",i)},C.removeDocumentMouseUpEvent=function(i){document.removeEventListener("mouseup",i)},C.addDocumentMouseMoveEvent=function(i){document.addEventListener("mousemove",i)},C.removeDocumentMouseMoveEvent=function(i){document.removeEventListener("mousemove",i)},C.DefaultScrollbarWidth="15px",C.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,C.ScrollbarBackgroundMousedownHoldDelay=50,C.MouseWheelRange=120,C.className="scroll-bar-div",C.barClassName="scroll-bar-part-bar",C.arrowClassName="scroll-bar-part-arrow",C}(),q=function(C){function i(o,w,O,D){var N=C.call(this,o,w,O,D)||this;return N.height=G.DefaultScrollbarWidth,N}return(0,z.__extends)(i,C),i.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,Z.MIN_WIDTH))},i.prototype._calculateButtonHeight=function(){return this.actualHeight},i.prototype._getMinButtonAngle=function(){return-180},i.prototype._getMaxButtonAngle=function(){return 0},i.prototype._setMaxButtonPosition=function(){(0,J.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},i.prototype.refresh=function(){this.arrange();var o=this.actualWidth-2*this.actualButtonWidth-2,w=this.viewSize/(this.max-this.min)*o;w<this.MIN_BAR_SIZE&&(o-=this.MIN_BAR_SIZE-w,w=this.MIN_BAR_SIZE),o<0&&(o=0,w=0),w=Math.min(w,o);var O=this.viewMin/(this.max-this.min)*o;(0,J.Py)(this.middleBar,w),(0,J.Iw)(this.middleBar,this.actualHeight);var D=this.actualButtonWidth+1+O;this.isModern?this.middleBar.style.transform="translateX(".concat(D,"px)"):(0,J.hn)(this.middleBar,D)},i.prototype.show=function(o){o!==this.visible&&(C.prototype.show.call(this,o),o?this.element.style.height=this.height:(0,J.Iw)(this.element,0))},i.prototype._scrollByPage=function(o){var w;if(this.isModern){var O=window.getComputedStyle(this.middleBar);w=new WebKitCSSMatrix(O.transform).m41}else w=this.middleBar.offsetLeft;var te=void 0===o.offsetX?o.layerX:o.offsetX;te>w+this.middleBar.offsetWidth?this.scrollPageDown():te<w&&this.scrollPageUp()},i.prototype._getRunningSize=function(o){var w=this.actualWidth;if(o){var D=(w-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));D<this.MIN_BAR_SIZE&&(w-=this.MIN_BAR_SIZE-D)}return w},i.prototype._getOffsetDelta=function(o){return this._getOffsetXDelta(o)},i.prototype._getOffsetTouchDelta=function(o){return this._getOffsetXTouchDelta(o)},i.prototype._getScreenContextualLeft=function(o){return o.getBoundingClientRect().left},i.prototype._getScreenContextualRight=function(o){return o.getBoundingClientRect().right},i.prototype._getScreenMousePos=function(o){return o.screenX},i}(G),t=function(C){function i(o,w,O,D){var N=C.call(this,o,w,O,D)||this;return N.width=G.DefaultScrollbarWidth,N}return(0,z.__extends)(i,C),i.prototype._calculateButtonWidth=function(){return this.actualWidth},i.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,Z.MIN_WIDTH))},i.prototype._getMinButtonAngle=function(){return-90},i.prototype._getMaxButtonAngle=function(){return 90},i.prototype._setMaxButtonPosition=function(){(0,J.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},i.prototype.refresh=function(){this.arrange();var o=this.actualHeight-2*this.actualButtonHeight-2,w=this.viewSize/(this.max-this.min)*o;w<this.MIN_BAR_SIZE&&(o-=this.MIN_BAR_SIZE-w,w=this.MIN_BAR_SIZE),o<0&&(o=0,w=0);var O=this.viewMin/(this.max-this.min)*o;(0,J.Py)(this.middleBar,this.actualWidth),(0,J.Iw)(this.middleBar,w);var D=this.actualButtonHeight+1+O;this.isModern?this.middleBar.style.transform="translateY(".concat(D,"px)"):(0,J.FX)(this.middleBar,D)},i.prototype.show=function(o){o!==this.visible&&(C.prototype.show.call(this,o),o?this.element.style.width=this.width:(0,J.Py)(this.element,0))},i.prototype._scrollByPage=function(o){var w;if(this.isModern){var O=window.getComputedStyle(this.middleBar);w=new WebKitCSSMatrix(O.transform).m42}else w=this.middleBar.offsetTop;var te=void 0===o.offsetY?o.layerY:o.offsetY;te>w+this.middleBar.offsetHeight?this.scrollPageDown():te<w&&this.scrollPageUp()},i.prototype._getRunningSize=function(o){var w=this.actualHeight;if(o){var D=(w-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));D<this.MIN_BAR_SIZE&&(w-=this.MIN_BAR_SIZE-D)}return w},i.prototype._getOffsetDelta=function(o){return this._getOffsetYDelta(o)},i.prototype._getOffsetTouchDelta=function(o){return this._getOffsetYTouchDelta(o)},i.prototype._getScreenContextualLeft=function(o){return o.getBoundingClientRect().top},i.prototype._getScreenContextualRight=function(o){return o.getBoundingClientRect().bottom},i.prototype._getScreenMousePos=function(o){return o.screenY},i}(G)},73889:function(_e,Se,U){U.d(Se,{Y:function(){return z}});var z=function(pe){return pe[pe.Matrix=0]="Matrix",pe[pe.Table=1]="Table",pe[pe.PivotTable=2]="PivotTable",pe[pe.TableEx=3]="TableEx",pe}({})},71090:function(_e,Se,U){U.d(Se,{Ds:function(){return o},Ed:function(){return d},Eo:function(){return v},F2:function(){return T},Hw:function(){return C},JM:function(){return M},LU:function(){return S},Mh:function(){return W},NA:function(){return g},OM:function(){return l},P$:function(){return H},Pr:function(){return D},QM:function(){return r},R9:function(){return B},Sl:function(){return q},TV:function(){return G},Vz:function(){return k},WA:function(){return N},YR:function(){return n},Yo:function(){return fe},Zk:function(){return R},b:function(){return Z},bn:function(){return ue},dG:function(){return b},dm:function(){return i},en:function(){return O},f:function(){return te},fG:function(){return f},iC:function(){return t},jv:function(){return s},lN:function(){return ie},mQ:function(){return ne},qT:function(){return se},rJ:function(){return h},rx:function(){return u},rz:function(){return w},s$:function(){return I},s0:function(){return ee},sR:function(){return pe},uX:function(){return L},uZ:function(){return le},wH:function(){return p},wd:function(){return m},yF:function(){return J},ye:function(){return E},z7:function(){return e},zq:function(){return Q}});var z=U(38265),pe=.8,se="TableTotalLabel",ue="Format_AddTotalLabel",J="Visual_LabelText_Value",L="Row_Selection",W="SelectRow",Z="Row_Selected",G="Row_Unselected",q="Additional_Conditional_Formatting",t="DecompositionTree_ScrollLevelUp_Tooltip",C="DecompositionTree_ScrollLevelDown_Tooltip",i="Scroll_Left",o="Scroll_Right",w="tablixDiv",O="tablixCellContentElement",D="tablixCellContentHost",N="tablixWrappingContainer",te="tablixHeader",ne="tablixColumnHeaderLeaf",ee="tablixValueNumeric",B="tablixValueTotal",g="powervisuals-glyph tablixUrlIconGlyph",S="tablixValueUrlIcon",d="tablixImageContainer",v="matrixRowHeaderLeaf",I="tableFooterCell",M="tableBodyCell",Q="tableBodyCellBottom",e="tablixAlignLeft",r="tablixAlignCenter",l="tablixAlignRight",s="&nbsp;",p="px",u="tablixSortIconContainer",n=10,h=5,H=5,f=5,m=1,b=z.Wn.regular.css,T=z.Wn.regular.css,R=z.Wn.bold.css,k=z.Wn.glyphs.css,E="#333",ie="#666",le=Number.POSITIVE_INFINITY,fe=.71},42737:function(_e,Se,U){U.d(Se,{A:function(){return pe}});var z=U(62458),pe=function(){function se(ue,J){this._element=ue,this._handler=J,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return se.addDocumentMouseUpEvent=function(ue){document.addEventListener("mouseup",ue)},se.removeDocumentMouseUpEvent=function(ue){document.removeEventListener("mouseup",ue)},se.addDocumentMouseMoveEvent=function(ue){document.addEventListener("mousemove",ue)},se.removeDocumentMouseMoveEvent=function(ue){document.removeEventListener("mousemove",ue)},se.getMouseCoordinates=function(ue){return{x:ue.pageX,y:ue.pageY}},se.getMouseCoordinateDelta=function(ue,J){return{x:J.x-ue.x,y:J.y-ue.y}},se.prototype.initialize=function(){var ue=this;this._elementMouseDownWrapper=function(J){return ue.onElementMouseDown(J)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(J){return ue.onElementMouseMove(J)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(J){return ue.onElementMouseOut(J)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(J){return ue.onElementMouseDoubleClick(J)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},se.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(se.prototype,"cell",{get:function(){return z.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(se.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),se.prototype._hotSpot=function(ue){return z.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},se.prototype.onElementMouseDown=function(ue){var J=this,L=se.getMouseCoordinates(ue);this._hotSpot(L)&&(ue.cancelBubble=!0,this._startMousePosition=L,this._documentMouseMoveWrapper=function(W){return J.onDocumentMouseMove(W)},se.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(W){return J.onDocumentMouseUp(W)},se.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=se.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},se.prototype.onElementMouseMove=function(ue){this._startMousePosition||(this._hotSpot(se.getMouseCoordinates(ue))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=se.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},se.prototype.onElementMouseOut=function(ue){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},se.prototype.onElementMouseDoubleClick=function(ue){this._hotSpot(se.getMouseCoordinates(ue))&&this._handler.onReset(this.cell)},se.prototype.onDocumentMouseMove=function(ue){if(this._startMousePosition){var J=se.getMouseCoordinateDelta(this._startMousePosition,se.getMouseCoordinates(ue));this._handler.onResize(this.cell,J.x,J.y),ue.preventDefault()}},se.prototype.onDocumentMouseUp=function(ue){this._startMousePosition=null,se.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,se.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),ue.preventDefault&&ue.preventDefault(),this._handler.onEndResize(this.cell)},se.resizeHandleSize=4,se.resizeCursor="e-resize",se}()},93340:function(_e,Se,U){U.d(Se,{AB:function(){return s},Av:function(){return E},Ch:function(){return u},D4:function(){return C},D6:function(){return le},DM:function(){return l},FX:function(){return i},G9:function(){return e},Hd:function(){return we},Hx:function(){return H},Iw:function(){return w},MN:function(){return m},Or:function(){return R},Pb:function(){return B},Py:function(){return O},R5:function(){return c},RP:function(){return b},Uy:function(){return N},W_:function(){return I},Y1:function(){return k},Y4:function(){return Y},aP:function(){return r},df:function(){return ne},ey:function(){return Q},hn:function(){return o},jG:function(){return y},jT:function(){return Re},mx:function(){return D},om:function(){return g},pW:function(){return de},qZ:function(){return S},ri:function(){return v},ut:function(){return ee},v4:function(){return p},vU:function(){return h},wC:function(){return M},wX:function(){return T},x7:function(){return ie},xl:function(){return n}});var z=U(54522),pe=U(91358),se=U(44977),ue=U(38308),J=U(62458),L=U(6444),W=U(64329),Z=U(48066),G=U(28326),q=U(42737),t=U(71090);function C(P){if(P)for(;P.hasChildNodes();)P.removeChild(P.firstChild)}function i(P,x){P.style.top=x+"px"}function o(P,x){P.style.left=x+"px"}function w(P,x){P.style.height=te(x)?"":x+"px"}function O(P,x){P.style.width=te(x)?"":x+"px"}function D(P){return P.offsetWidth}function N(P){return P.offsetHeight}function te(P){return-1===P}function ne(P){var x=P.offsetWidth;return 0===x?1:P.getBoundingClientRect().width/x}function ee(P,x){var A=P.getBoundingClientRect(),j=ne(P);return{x:(x.pageX-A.left)/j,y:(x.pageY-A.top)/j}}var B=function(P){return P[P.Outline=0]="Outline",P[P.Gridline=1]="Gridline",P}({}),g=function(){function P(x,A){this.applyParams(!0,x,A)}return P.prototype.applyParams=function(x,A,j,oe){x?(this.weight=A??0,this.color=j??"black",this.type=oe??B.Gridline):(this.weight=0,this.color="black",this.type=B.Gridline)},P.prototype.getCSS=function(){var x=[];return _.isNumber(this.weight)&&(x.push(this.weight+t.wH),this.color&&x.push(this.color),x.push("solid")),x.join(" ")},P.prototype.getPriority=function(x){return this===x.top||this===x.bottom?this.type===B.Outline?2:0:this===x.right||this===x.left?this.type===B.Outline?3:1:-1},P.prototype.getShadowCss=function(x,A){var oe=this.weight?this.weight+5:0,ve="inset ";if(this===x.left)ve+=oe+t.wH+" 0";else if(this===x.right)ve+="-"+Math.min(oe,A+5)+t.wH+" 0";else if(this===x.top)ve+="0 "+oe+t.wH;else{if(this!==x.bottom)return"";ve+="0 -"+oe+t.wH}return ve+" 0 -".concat(5,"px ")+this.color},P}(),S=function(){function P(x,A){void 0===x&&(x=t.YR),void 0===A&&(A=t.rJ),this.borders={},this.paddings={top:0,left:x,bottom:0,right:A},this.fontColor="",this.fontFamily="",this.backColor=""}return P.prototype.applyStyle=function(x){var j=x.extension.contentHost.style;j.fontFamily=this.fontFamily,j.fontSize=this.fontSize?W.FP.toString(this.fontSize.px):void 0,j.fontWeight=this.fontWeight,j.fontStyle=this.fontStyle,j.textDecoration=this.textDecoration,j.color=this.fontColor,j.backgroundColor=this.backColor,j.boxShadow=this.getBoxShadow(),j.border="none",j.paddingTop=this.getPaddingTop(),j.paddingRight=this.getPaddingRight(),j.paddingBottom=this.getPaddingBottom(),j.paddingLeft=this.getPaddingLeft(),j.maxWidth=this.maxWidth},P.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+t.wH},P.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+t.wH},P.prototype.getPaddingRight=function(){return(this.paddings.right??t.rJ)+(null==this.borders.right?0:this.borders.right.weight)+t.wH},P.prototype.getPaddingLeft=function(){return(this.paddings.left??t.YR)+(null==this.borders.left?0:this.borders.left.weight)+t.wH},P.prototype.getBoxShadow=function(x){var A,j,oe,ce,ve,Pe,Fe,Ce,He=[];return(null===(A=this.borders.left)||void 0===A?void 0:A.type)===B.Outline&&0!==this.borders.left.weight&&He.push(this.borders.left.getShadowCss(this.borders)),(null===(j=this.borders.right)||void 0===j?void 0:j.type)===B.Outline&&0!==this.borders.right.weight&&0!==x&&He.push(this.borders.right.getShadowCss(this.borders,x)),(null===(oe=this.borders.bottom)||void 0===oe?void 0:oe.type)===B.Outline&&0!==this.borders.bottom.weight&&He.push(this.borders.bottom.getShadowCss(this.borders)),(null===(ce=this.borders.top)||void 0===ce?void 0:ce.type)===B.Outline&&0!==this.borders.top.weight&&He.push(this.borders.top.getShadowCss(this.borders)),(null===(ve=this.borders.left)||void 0===ve?void 0:ve.type)===B.Gridline&&0!==this.borders.left.weight&&He.push(this.borders.left.getShadowCss(this.borders)),(null===(Pe=this.borders.right)||void 0===Pe?void 0:Pe.type)===B.Gridline&&0!==this.borders.right.weight&&0!==x&&He.push(this.borders.right.getShadowCss(this.borders,x)),(null===(Fe=this.borders.bottom)||void 0===Fe?void 0:Fe.type)===B.Gridline&&0!==this.borders.bottom.weight&&He.push(this.borders.bottom.getShadowCss(this.borders)),(null===(Ce=this.borders.top)||void 0===Ce?void 0:Ce.type)===B.Gridline&&0!==this.borders.top.weight&&He.push(this.borders.top.getShadowCss(this.borders)),He.join(", ")},P.prototype.setAttributes=function(x,A,j,oe,ce){if(x["padding-top"]=this.getPaddingTop(),x["padding-right"]=this.getPaddingRight(),x["padding-bottom"]=this.getPaddingBottom(),x["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(x["font-family"]=this.fontFamily),null!=this.fontSize&&(x["font-size"]=W.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(x["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(x["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(x["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(x.color=this.fontColor),_.isEmpty(this.backColor)||(x["background-color"]=this.backColor),oe||!A&&!j){var ve=parseFloat(this.getPaddingLeft()),Pe=parseFloat(this.getPaddingRight()),Fe=this.getRightBorderMax(ce,ve,Pe),Ce=this.getBoxShadow(Fe);_.isEmpty(Ce)||(x["box-shadow"]=Ce)}_.isEmpty(this.maxWidth)||(x["max-width"]=this.maxWidth),(A||j)&&(x["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",x["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",x["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",x["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},P.prototype.getRightBorderMax=function(x,A,j){if(null==x)return j;var oe=Math.max(x-A,0);return Math.min(j,oe)},P.prototype.getAttributes=function(x,A,j,oe){var ce={};return this.setAttributes(ce,x,A,j,oe),ce},P.prototype.getExtraTop=function(){var x=0;return this.paddings.top&&(x+=this.paddings.top),this.borders.top&&(x+=this.borders.top.weight),x},P.prototype.getExtraBottom=function(){var x=0;return this.paddings.bottom&&(x+=this.paddings.bottom),this.borders.bottom&&(x+=this.borders.bottom.weight),x},P.prototype.getExtraRight=function(){var x=0;return this.paddings.right&&(x+=this.paddings.right),this.borders.right&&(x+=this.borders.right.weight),x},P.prototype.getExtraLeft=function(){var x=0;return this.paddings.left&&(x+=this.paddings.left),this.borders.left&&(x+=this.borders.left.weight),x},P}(),d=function(){return function(){}}(),v=function(){function P(){this.row=new d,this.column=new d}return P.prototype.isMatch=function(x){return this.column.index===x.column.index&&this.row.index===x.row.index},P}(),y=function(){function P(x,A,j,oe,ce,ve,Pe,Fe,Ce,He,Le){this.dataPoint=x,this.objects=A,this.isRowSubTotal=j,this.isColumnSubTotal=oe,this.isRowGrandTotal=ce,this.isColumnGrandTotal=ve,this.isBlankRow=Pe,this.columnMetadata=Fe,this.formatter=Ce,this.tooltipFormatter=He,this.type=Le,this.position=new v,this.cachedTextContent=Ce?this.formatter.format(x,A):null!=this.dataPoint?x:""}return Object.defineProperty(P.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isKpi",{get:function(){return this.columnMetadata&&k(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(P,x){J.fF.assertValue(P,"kpi"),J.fF.assertValue(x,"kpiValue");var A=(0,pe.sq)(P,x)||"";return(0,ue.hi)().addClass(A).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,z.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,z.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isValidUrl",{get:function(){return m(this.columnMetadata,this.textContent)!==Z.av.NONE},enumerable:!1,configurable:!0}),P.prototype.isMatch=function(x){return this.position.isMatch(x.position)&&this.backColor===x.backColor},P}();function I(){return document.createElement("table")}function M(){var P=document.createElement("div");return P.className=t.rz,P}function Q(P){P.extension.contentElement.className=t.rz+" "+t.en,P.extension.contentHost.className=t.rz+" "+t.Pr}function c(P,x){P.extension.contentHost.className+=" "+x}function e(P){P.extension.contentHost.className="",P.extension.contentHost.style.cssText=""}function r(P){P.extension.contentHost.textContent="",P.extension.contentHost.removeAttribute("title"),P.contentHeight=P.contentWidth=0,C(P.extension.contentHost)}function l(P,x,A){s(P,x),p(P,A||x)}function s(P,x){x.textContent=(0,se.PC)(P)}function p(P,x){x.title=P}function u(P,x){var A=M();return P.appendChild(A),x&&(A.textContent=x),A}function n(P){var A=P.offsetX;return A>=0&&A<P.target.offsetWidth-q.A.resizeHandleSize}function h(P,x,A){var j=null;0===x.childElementCount?(j=document.createElement("a"),x.appendChild(j)):j=x.children[0],j.href=P,j.target="_blank",j.rel="noopener noreferrer",j.title=P,null!=A?(j.className=t.NA+" "+A,$(x).addClass(t.LU)):j.innerText=P}function H(P,x,A){var j=M(),oe=document.createElement("img");j.style.height=A+"px",j.style.width="100%",j.style.textAlign="center",oe.src=P,oe.style.maxHeight="100%",oe.style.maxWidth="100%",j.appendChild(oe),x.appendChild(j),x.title=P}function m(P,x){return(0,z.cR)(P)?(0,Z.MN)(x):Z.av.NONE}function b(P){switch(P){case Z.av.file:case Z.av.ftp:return"page2";case Z.av.mailto:return"mail";case Z.av.news:return"link";case Z.av.telnet:return"pc1";case Z.av.http:case Z.av.https:return"link";default:return null}}function T(P,x,A){return R(P,x)&&(0,Z.gU)(A)}function R(P,x){return(0,z.pt)(x)&&!P.isSubtotal&&!!P.identity}function k(P,x){return!(!P||void 0===x||!(0,pe.sq)(P,x))}function E(P,x){return{sortDescriptors:[{queryName:P,sortDirection:x}]}}function ie(P){return 2===P?1:2}function le(P,x){var A=M();P?(A.appendChild(fe(P,!0)),A.appendChild(fe(ie(P),!1))):A.appendChild(fe(2,!1));var j=M();return A.appendChild(j),x.appendChild(A),j}function fe(P,x){var A=document.createElement("i");return A.className=t.rx+" "+(x?"sorted":"future")+" "+(1===P?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),A}function Y(P){(function(P){for(var x=0,A=P.extension.contentElement.childElementCount;x<A;x++)if(P.extension.contentElement.children.item(x).classList.contains(t.rx))return!0;return!1})(P)&&$(P.extension.contentElement).find("."+t.rx).remove()}function de(P){return J.fF.assert(function(){return!(P instanceof Date)||(0,L.M4)(P)},"dates should implement DateWithEpochValue"),(0,L.M4)(P)&&(P=G.y3.fromDateWithEpochValue(P).toString()),String(P)}function we(P){return P+2}function Re(P){return P+2}},74304:function(_e,Se,U){U.d(Se,{U:function(){return l}});var z=U(81337),pe=U(67016),se=U(2142),ue=U(85196),J=U(84183),L=U(54522),W=U(56707),Z=U(85028),G=U(32105),q=U(33024),t=U(55007),C=U(85308),i=U(62458),o=U(56578),w=U(64329),O=U(82755),D=U(76045),N=U(91059),te=U(96915),ne=U(82386),ee=U(86878),g=U(72489),S=U(71090),d=U(73889),v=U(66842),y=U(40845),I=10,l=function(){function p(u){this.tablixProperties=new t.FX(u)}return p.getMetadataObjects=function(u){return u&&u.metadata?u.metadata.objects:null},p.prototype.enumerateObjectRepetition=function(u,n,h,H){var f,m,b,T,R,k,E;i.fF.assertValue(u,"enumeration should be defined"),i.fF.assertValue(n,"dataView can't be undefined");var le,ie=this.getSelectorData(h);switch(h){case d.Y.Table:case d.Y.TableEx:le=this.getTableColumnMetadata(n);break;case d.Y.Matrix:case d.Y.PivotTable:le=this.getMatrixValuesColumnMetadata(n);break;default:return void i.fF.assertNever(h)}if(le){le=_.uniq(le);for(var fe=h===d.Y.PivotTable||h===d.Y.TableEx,he=0,Y=le;he<Y.length;he++){var de=Y[he],ge=null===(E=de.type.misc)||void 0===E?void 0:E.sparkline;if(fe){var ye={containerName:de.displayName,selector:this.getSelector(de.queryName,ie),allowOverrideSubtotalMatching:!0,objects:(m={},m[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},m)};if(u.push(ye),!ge){var me={containerName:de.displayName,selector:this.getSelector(de.queryName,ie),allowOverrideSubtotalMatching:!0,objects:(b={},b[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},b)};u.push(me)}if(de.type.numeric&&!ge){var we={containerName:de.displayName,selector:this.getSelector(de.queryName),objects:(T={},T[t.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[t.FX.PropColumnFormattingDataBars.propertyName]},T)};u.push(we)}var Re={containerName:de.displayName,selector:this.getSelector(de.queryName,ie),altStaticSelector:this.getSelector(de.queryName),allowOverrideSubtotalMatching:!0,objects:(R={},R[t.FX.PropValuesIcon.objectName]={formattingProperties:[t.FX.PropValuesIcon.propertyName]},R)};if(u.push(Re),fe&&H?.conditionalTablixWebURL&&!(0,L.cR)(de)&&!ge){var ae={containerName:de.displayName,selector:this.getSelector(de.queryName,ie),allowOverrideSubtotalMatching:!0,objects:(k={},k[t.FX.PropValuesWebURL.objectName]={formattingProperties:[t.FX.PropValuesWebURL.propertyName]},k)};u.push(ae)}}else{if(!de.isMeasure||!de.type.numeric)continue;var be={containerName:de.displayName,selector:this.getSelector(de.queryName,ie),objects:(f={},f[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},f)};u.push(be)}}}},p.prototype.getSelectorData=function(u){switch(u){case d.Y.Table:return[(0,N.Yp)(["Values"])];case d.Y.TableEx:return[(0,te.Ue)(1)];case d.Y.Matrix:return[(0,N.Yp)(["Rows","Columns"])];case d.Y.PivotTable:return[(0,te.Ue)(1)];default:return void i.fF.assertNever(u)}},p.prototype.getConditionalFormattingSelector=function(u,n,h){void 0===h&&(h=!0);var H=h?this.getSelectorData(u):void 0;return this.getSelector(n,H)},p.prototype.getSelector=function(u,n){var h={metadata:u};return n&&(h.data=n),h},p.prototype.getFormattingModel=function(u,n,h,H,f,m,b){void 0===f&&(f=!1),i.fF.assertValue(h,"dataView can't be undefined");var E,T=p.getMetadataObjects(h),R=n,k=n,ie=this.getColumnsMetadata(h,H);E=H===d.Y.Table?this.shouldShowTableTotalsOption(h)&&t.FX.PropGeneralTableTotals.getValue(T):this.shouldShowColumnSubtotalsOption(h)&&t.FX.PropGeneralMatrixColumnSubtotals.getValue(T)||this.shouldShowRowSubtotalsOption(h)&&t.FX.PropGeneralMatrixRowSubtotals.getValue(T);var le=this.getTablixTextClassProperties(b),fe=new o.Nq(this.getStylePresetCard(u,R,H,m),this.getGridCard(u,n,H,T,le,m),this.getBlankRowCard(u,R,H,m),this.getValueCard(u,n,H,T,m),this.getColumnHeadersCard(u,n,H,m),this.getRowHeadersCard(u,R,H,T,f,m),this.getTotalsCard(u,k,H,m),this.getColumnSubtotalCard(u,R,h,H,E,m),this.getRowSubTotalsCard(u,R,h,H,E,m),this.getColumnGrandTotalsCard(u,R,H),this.getRowGrandTotalsCard(u,R,H),this.getColumnFormattingCard(u,n,ie,H),this.getCellColumnCard(u,H,h,m),this.getUrlIconCard(u,n,H),this.getImageSizeCard(u,n,H,m),this.getSparklinesCard(ie,u,H)),he=this.getMatrixRowsColumnMetadata(h),Y=this.getMatrixColumnsColumnMetadata(h),de=m.a11yShowAsMatrix?this.getAccessibilityCardNew(he,Y,ie,u,k,H):this.getAccessibilityCard(ie,u,k,H);return de&&fe.addCards(de),fe.build()},p.prototype.getLayoutSlice=function(u,n){return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new o.uY({descriptor:pe.t.general.layout,value:u.general.layout}).build(),localize:n}).build()},p.prototype.getIndentationSlice=function(u,n){if(u.general.layout===v.t.Compact){var h=u.rowHeaders;return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(h,n).build(),localize:n}).build()}},p.prototype.getRepeatRowHeadersSlice=function(u,n){if(u.general.layout!==v.t.Compact)return new o.vi({uidBuilder:new o.IN(new o.SS(new o.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new o.bd({descriptor:pe.t.rowHeaders.repeatRowHeaders,value:u.rowHeaders.repeatRowHeaders}).build(),localize:n}).build()},p.prototype.getStylePresetCard=function(u,n,h,H){var f=this,m="StylePresets";H.matrixLayouts&&h===d.Y.PivotTable&&(m="Layout_And_StylePresets");var b=function(k){return u.getLocalizedString(k)},T=new o.CQ(new o.lg("stylePreset"),m,[pe.t.general.layout,pe.t.rowHeaders.steppedLayoutIndentation,pe.t.rowHeaders.repeatRowHeaders],b);return T.addGroup(void 0,function(R){if(R.addSlicePlaceholder((0,o.E0)("stylePreset")),H.matrixLayouts&&h===d.Y.PivotTable){var k=f.getLayoutSlice(n,b),E=f.getIndentationSlice(n,b),ie=f.getRepeatRowHeadersSlice(n,b);R.addSlice(k),E&&R.addSlice(E),ie&&R.addSlice(ie)}}),T.build()},p.prototype.getBlankRowCard=function(u,n,h,H){if(H.matrixLayouts&&h===d.Y.PivotTable){var f=function(R){return u.getLocalizedString(R)},m=pe.t.blankRows,b=new o.CQ(new o.lg("blankRows"),"Visual_Blank_Rows",m,f).addTopLevelToggle("blankRow",function(){return new o.bd({descriptor:m.showBlankRows,value:n.blankRows.showBlankRows}).build()});return b.addGroup("colors",function(T){T.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new o.BT({descriptor:m.blankRowColor,value:{value:n.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new o.JN({descriptor:m.blankRowTransparency,value:n.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:q.t2},localize:f}).build(),function(R){return R.withCustomDisplayName("Transparency")})}),b.addGroup("border",function(T){T.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new o.bd({descriptor:m.showBorder,value:n.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new o.uY({descriptor:m.borderPosition,value:n.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new o.BT({descriptor:m.borderColor,value:{value:n.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new o.JN({descriptor:m.borderTransparency,value:n.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:q.t2},localize:f}).build(),function(R){return R.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new o.mu({descriptor:m.borderWidth,value:n.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:I},unitSymbol:q.e_}}).build(),function(R){return R.withCustomDisplayName("Visual_General_Properties_Width")})}),b.build()}},p.prototype.getGridCard=function(u,n,h,H,f,m){var b=function(A){return u.getLocalizedString(A)},T=h===d.Y.TableEx?se.Z.grid:pe.t.grid,R=h===d.Y.TableEx?se.Z.values:pe.t.values,k=R.outlineStyle,E=R.outlineWeight,ie=R.outlineColor,le=h===d.Y.TableEx?se.Z.columnHeaders:pe.t.columnHeaders,fe=le.outlineStyle,he=le.outlineWeight,Y=le.outlineColor,de=h===d.Y.TableEx?se.Z.total:pe.t.total,ge=de.outlineStyle,be=de.outlineWeight,ye=de.outlineColor,me=pe.t.rowHeaders,we=me.outlineStyle,Re=me.outlineWeight,ae=me.outlineColor,K=T.outlineStyle,X=(0,z.__rest)(T,["imageHeight","imageWidth","outline","outlineStyle"]);X=(0,z.__assign)((0,z.__assign)({},X),{outlineStyle:K,valuesOutlineStyle:k,valuesOutlineWeight:E,valuesOutlineColor:ie,columnHeadersOutlineStyle:fe,columnHeadersOutlineWeight:he,columnHeadersOutlineColor:Y}),h===d.Y.TableEx&&(X=(0,z.__assign)((0,z.__assign)({},X),{totalsOutlineStyle:ge,totalsOutlineColor:ye,totalsOutlineWeight:be})),h===d.Y.PivotTable&&(X=(0,z.__assign)((0,z.__assign)({},X),{rowHeaderOutlineStyle:we,rowHeaderOutlineWeight:Re,rowHeaderOutlineColor:ae}));var re=n.grid,P=new o.CQ(new o.lg("grid"),"Visual_Grid",X,b);return P.addGroup("gridHorizontal",function(x){x.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new o.bd({descriptor:X.gridHorizontal,value:re.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new o.BT({descriptor:X.gridHorizontalColor,value:{value:re.gridHorizontalColor}}).build()},function(A){return A.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new o.mu({descriptor:X.gridHorizontalWeight,value:re.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:I}}}).build(),function(A){return A.withCustomDisplayName("Visual_General_Properties_Width")})}),P.addGroup("gridVertical",function(x){x.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new o.bd({descriptor:X.gridVertical,value:re.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new o.BT({descriptor:X.gridVerticalColor,value:{value:re.gridVerticalColor}}).build()},function(A){return A.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new o.mu({descriptor:X.gridVerticalWeight,value:re.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:I}}}).build(),function(A){return A.withCustomDisplayName("Visual_General_Properties_Width")})}),P.addGroup("border",function(x){x.withDisplayName("Visual_Border").addContainer("outline",function(A){A.withDisplayName("Section"),A.addContainerItem("all",b("All"),function(j){j.addSimpleSlice("outlineStyle",function(){return new o.oM({descriptor:X.outlineStyle,value:re.outline}).build()},function(oe){return oe.withCustomDisplayName("Visual_Border_Position")}),j.addSimpleSlice("outlineColor",function(){return new o.BT({descriptor:X.outlineColor,value:{value:re.outlineColor}}).build()},function(oe){return oe.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new o.mu({descriptor:X.outlineWeight,value:re.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:I}}}).build(),function(oe){return oe.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",b("Visual_Tablix_ColumnHeader"),function(j){var oe=n.columnHeaders;j.addSimpleSlice("outlineStyleColumnHeaders",function(){return new o.oM({descriptor:fe,value:oe.outline}).build()},function(ce){return ce.withCustomDisplayName("Visual_Border_Position")}),j.addSimpleSlice("outlineColorColumnHeaders",function(){return new o.BT({descriptor:Y,value:{value:oe.outlineColor}}).build()},function(ce){return ce.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new o.mu({descriptor:he,value:oe.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:I}}}).build(),function(ce){return ce.withCustomDisplayName("Visual_General_Properties_Width")})}),h===d.Y.PivotTable&&A.addContainerItem("rowHeaders",b("Visual_Tablix_RowHeaders"),function(j){var oe=n.rowHeaders;j.addSimpleSlice("outlineStyleRowHeaders",function(){return new o.oM({descriptor:we,value:oe.outline}).build()},function(ce){return ce.withCustomDisplayName("Visual_Border_Position")}),j.addSimpleSlice("outlineColorRowHeaders",function(){return new o.BT({descriptor:ae,value:{value:oe.outlineColor}}).build()},function(ce){return ce.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new o.mu({descriptor:Re,value:oe.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:I}}}).build(),function(ce){return ce.withCustomDisplayName("Visual_General_Properties_Width")})}),A.addContainerItem("values",b("Visual_Tablix_ValuesSection"),function(j){var oe=n.values;j.addSimpleSlice("outlineStyleValues",function(){return new o.oM({descriptor:k,value:oe.outline}).build()},function(ce){return ce.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new o.BT({descriptor:ie,value:{value:oe.outlineColor}}).build()},function(ce){return ce.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new o.mu({descriptor:E,value:oe.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:I}}}).build(),function(ce){return ce.withCustomDisplayName("Visual_General_Properties_Width")})}),h===d.Y.TableEx&&A.addContainerItem("outline-totals",b("Visual_Tablix_TotalsSection"),function(j){var oe=n.total;j.addSimpleSlice("outlineStyleTotals",function(){return new o.oM({descriptor:ge,value:oe.outline}).build()},function(ce){return ce.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new o.BT({descriptor:ye,value:{value:oe.outlineColor}}).build()},function(ce){return ce.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new o.mu({descriptor:be,value:oe.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:I}}}).build(),function(ce){return ce.withCustomDisplayName("Visual_General_Properties_Width")})})})}),P.addGroup("options",function(x){x.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new o.mu({descriptor:X.rowPadding,value:re.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new o.mu({descriptor:X.textSize,value:t.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,H,f.fontSizeOverrideFn,f.labelFontProperties.size&&f.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(A){return A.withCustomDisplayName("Global_Font_Size")})}),P.build()},p.prototype.getValueCard=function(u,n,h,H,f){var he=(0,z.__rest)(h===d.Y.TableEx?se.Z.values:pe.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),Y=n.values,de=new o.CQ(new o.lg("values"),"Visual_Tablix_Values",he,function(me){return u.getLocalizedString(me)}),be=(new o.UN).withFontFamily({descriptor:he.fontFamily,value:Y.fontFamily}).withFontSizeProperties({descriptor:he.fontSize,value:Y.fontSize.pt}).withBold({descriptor:he.bold,value:Y.bold}).withItalic({descriptor:he.italic,value:Y.italic}).withUnderline({descriptor:he.underline,value:Y.underline}).build();return de.addGroup("values",function(ye){ye.withDisplayName("Visual_Tablix_Values"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&ye.addCompositeSlice("font","Font",be),ye.addSimpleSlice("fontColorPrimary",function(){return new o.BT({descriptor:he.fontColorPrimary,value:{value:Y.fontColorPrimary}}).build()},function(me){return me.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new o.BT({descriptor:he.backColorPrimary,value:{value:Y.backColorPrimary}}).build()},function(me){return me.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new o.BT({descriptor:he.fontColorSecondary,value:{value:Y.fontColorSecondary}}).build()},function(me){return me.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new o.BT({descriptor:he.backColorSecondary,value:{value:Y.backColorSecondary}}).build()},function(me){return me.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new o.bd({descriptor:he.wordWrap,value:Y.wordWrap}).build(),function(me){return me.withCustomDisplayName("TextWrap")})}),h===d.Y.PivotTable&&de.addGroup("options",function(ye){ye.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new o.bd({descriptor:he.valuesOnRow,value:t.FX.PropValuesOnRow.setInstanceProperty(void 0,H)}).build(),function(me){return me.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),de.build()},p.prototype.getColumnHeadersCard=function(u,n,h,H){var E=(0,z.__rest)(h===d.Y.TableEx?se.Z.columnHeaders:pe.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),ie=n.columnHeaders,le=new o.CQ(new o.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",E,function(de){return u.getLocalizedString(de)}),he=(new o.UN).withFontFamily({descriptor:E.fontFamily,value:ie.fontFamily}).withFontSizeProperties({descriptor:E.fontSize,value:ie.fontSize.pt}).withBold({descriptor:E.bold,value:ie.bold}).withItalic({descriptor:E.italic,value:ie.italic}).withUnderline({descriptor:E.underline,value:ie.underline}).build();return le.addGroup("text",function(Y){Y.withDisplayName("Text"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&Y.addCompositeSlice("font","Font",he),Y.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:E.fontColor,value:{value:ie.fontColor}}).build()},function(ge){return ge.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:E.backColor,value:{value:ie.backColor}}).build()},function(ge){return ge.withCustomDisplayName("Background_Color")}),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&Y.addSimpleSlice("alignment",new o.Gp({descriptor:E.alignment,value:ie.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(ge){return ge.withCustomDisplayName("Visual_TextAlignment_Header")}),h===d.Y.PivotTable&&Y.addSimpleSlice("titleAlignment",new o.Gp({descriptor:E.titleAlignment,value:n.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&Y.addSimpleSlice("wordWrap",new o.bd({descriptor:E.wordWrap,value:ie.wordWrap}).build(),function(ge){return ge.withCustomDisplayName("TextWrap")})}),(h===d.Y.PivotTable||h===d.Y.TableEx)&&le.addGroup("options",function(Y){Y.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new o.bd({descriptor:E.autoSizeColumnWidth,value:n.general.autoSizeColumnWidth}).build(),function(de){return de.withCustomDisplayName("Visual_AutoSize_Width")})}),le.build()},p.prototype.getRowHeadersCard=function(u,n,h,H,f,m){var b=this;if(void 0===f&&(f=!1),h===d.Y.PivotTable){var T=function(we){return u.getLocalizedString(we)},he=(0,z.__rest)(pe.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),Y=pe.t.values.bandedRowHeaders;h===d.Y.PivotTable&&(he=(0,z.__assign)((0,z.__assign)({},he),{bandedRowHeaders:Y}));var de=n.rowHeaders,ge=new o.CQ(new o.lg("rowHeaders"),"Visual_Tablix_RowHeaders",he,T),ye=(new o.UN).withFontFamily({descriptor:he.fontFamily,value:de.fontFamily}).withFontSizeProperties({descriptor:he.fontSize,value:de.fontSize.pt}).withBold({descriptor:he.bold,value:de.bold}).withItalic({descriptor:he.italic,value:de.italic}).withUnderline({descriptor:he.underline,value:de.underline}).build();return ge.addGroup("text",function(me){me.withDisplayName("Text"),(h===d.Y.PivotTable||h===d.Y.TableEx)&&me.addCompositeSlice("font","Font",ye),me.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:he.fontColor,value:{value:de.fontColor}}).build()},function(we){return we.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:he.backColor,value:{value:de.backColor}}).build()},function(we){return we.withCustomDisplayName("Background_Color")}),h===d.Y.PivotTable&&me.addSimpleSlice("bandedRowHeaders",new o.bd({descriptor:he.bandedRowHeaders,value:t.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,H)}).build()),me.addSimpleSlice("alignment",new o.Gp({descriptor:he.alignment,value:de.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new o.bd({descriptor:he.wordWrap,value:de.wordWrap}).build(),function(we){return we.withCustomDisplayName("TextWrap")})}),h===d.Y.PivotTable&&f&&ge.addGroup("expandCollapseButtons",function(me){me.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),me.addTopLevelToggle("showExpandCollapseButtons",function(){return new o.bd({descriptor:he.showExpandCollapseButtons,value:de.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new o.BT({descriptor:he.expandCollapseButtonsColor,value:{value:de.expandCollapseButtonsColor}}).build()},function(we){return we.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new o.mu({descriptor:he.expandCollapseButtonsSize,value:de.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(we){return we.withCustomDisplayName("Visual_BubbleSize")})}),m.matrixLayouts||ge.addGroup("options",function(me){me.withDisplayName("Desktop_FileMenu_Options"),me.addSimpleSlice("stepped",new o.bd({descriptor:he.stepped,value:de.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",b.getIndentationSliderBuilder(de,T).build())}),ge.build()}},p.prototype.getIndentationSliderBuilder=function(u,n){return new o.JN({descriptor:pe.t.rowHeaders.steppedLayoutIndentation,value:u.steppedLayoutIndentation,localize:n,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},p.prototype.getTotalsCard=function(u,n,h,H){if(h===d.Y.TableEx){var k=(0,z.__rest)(h===d.Y.TableEx?se.Z.total:pe.t.total,["outlineStyle","outlineWeight","outlineColor"]),E=n.total,ie=new o.CQ(new o.lg("totals"),"Visual_Totals",k,function(Y){return u.getLocalizedString(Y)}),fe=(new o.UN).withFontFamily({descriptor:k.fontFamily,value:E.fontFamily}).withFontSizeProperties({descriptor:k.fontSize,value:E.fontSize.pt}).withBold({descriptor:k.bold,value:E.bold}).withItalic({descriptor:k.italic,value:E.italic}).withUnderline({descriptor:k.underline,value:E.underline}).build();return ie.addGroup("values",function(he){var Y;he.withDisplayName("Visual_Tablix_Values"),h===d.Y.TableEx?(he.addTopLevelToggle("gridVertical",function(){return new o.bd({descriptor:k.totals,value:n.general.totals}).build()}),Y=n.general.totals):Y=!0,Y&&he.addSimpleSlice("totalLabel",new o.fq({descriptor:k.label,value:E.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",fe),he.addSimpleSlice("fontColor",function(){return new o.BT({descriptor:k.fontColor,value:{value:E.fontColor}}).build()},function(de){return de.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:k.backColor,value:{value:E.backColor}}).build()},function(de){return de.withCustomDisplayName("Background_Color")})}),ie.build()}},p.prototype.getColumnGrandTotalsCard=function(u,n,h){if(h!==d.Y.TableEx){var T=(0,z.__rest)(pe.t.columnTotal,["outlineStyle","outline"]),R=n.columnGrandTotal,k=new o.CQ(new o.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",T,function(fe){return u.getLocalizedString(fe)}),ie=(new o.UN).withFontFamily({descriptor:T.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:R.fontSize.pt}).withBold({descriptor:T.bold,value:R.bold}).withItalic({descriptor:T.italic,value:R.italic}).withUnderline({descriptor:T.underline,value:R.underline}).build();return k.addGroup("values",function(le){le.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",ie).addSimpleSlice("fontColor",function(){return new o.BT({descriptor:T.fontColor,value:{value:R.fontColor}}).build()},function(fe){return fe.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:T.backColor,value:{value:R.backColor}}).build()},function(fe){return fe.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:T.applyToHeaders,value:R.applyToHeaders}).build())}),k.build()}},p.prototype.getRowGrandTotalsCard=function(u,n,h){if(h!==d.Y.TableEx){var T=(0,z.__rest)(pe.t.rowTotal,["outlineStyle","outline"]),R=n.rowGrandTotal,k=new o.CQ(new o.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",T,function(fe){return u.getLocalizedString(fe)}),ie=(new o.UN).withFontFamily({descriptor:T.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:R.fontSize.pt}).withBold({descriptor:T.bold,value:R.bold}).withItalic({descriptor:T.italic,value:R.italic}).withUnderline({descriptor:T.underline,value:R.underline}).build();return k.addGroup("values",function(le){le.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",ie).addSimpleSlice("fontColor",function(){return new o.BT({descriptor:T.fontColor,value:{value:R.fontColor}}).build()},function(fe){return fe.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new o.BT({descriptor:T.backColor,value:{value:R.backColor}}).build()},function(fe){return fe.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:T.applyToHeaders,value:R.applyToHeaders}).build())}),k.build()}},p.prototype.addAltTextGroup=function(u,n,h,H,f,m){_.isEmpty(H)||u.addGroup(n,function(b){b.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),b.addContainer("measure",function(T){T.withDisplayName(h);for(var R=function(fe){var he;m===ue.r.rows||m===ue.r.columns?he={data:[(0,N.Yp)([m])]}:m===ue.r.values?he={data:[(0,te.Ue)(0)],metadata:fe.queryName}:i.fF.assertFail("unexpected role"),T.addContainerItem(fe.queryName,fe.displayName,function(Y){return Y.addSimpleSlice("altTextColumns",new o.k0({descriptor:(0,z.__assign)((0,z.__assign)({},f.altTextColumns),{selector:he,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},k=0,E=H;k<E.length;k++)R(E[k])})})},p.prototype.getAccessibilityCardNew=function(u,n,h,H,f,m){i.fF.assert(function(){return m===d.Y.TableEx||m===d.Y.PivotTable});var b=m===d.Y.TableEx?se.Z.accessibility:pe.t.accessibility,T=_.filter(u,L.pt),R=_.filter(n,L.pt),k=_.filter(h,L.pt),E=_.filter(h,function(he){return he.type.text}).map(function(he){return{displayName:he.displayName,value:he.queryName}});if(!(_.isEmpty(T)&&_.isEmpty(R)&&_.isEmpty(k))||m!==d.Y.PivotTable&&!_.isEmpty(E)){var le=new o.CQ(new o.lg("accessibility"),"Accessibility",m===d.Y.TableEx?[b.altTextColumns,b.rowWithReferenceText]:[b.altTextColumns],function(Y){return H.getLocalizedString(Y)});if(this.addAltTextGroup(le,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",T,b,ue.r.rows),this.addAltTextGroup(le,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",R,b,ue.r.columns),this.addAltTextGroup(le,"AltTextValues","Image_Alt_Text_Values",k,b,ue.r.values),m===d.Y.TableEx&&!_.isEmpty(E)){var fe={displayName:H.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};E.unshift(fe),le.addGroup("rowWithReferenceText",function(he){var Y;he.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),he.addSimpleSlice("rowWithReferenceText",new o.uY({descriptor:(0,z.__assign)({},b.rowWithReferenceText),items:E,value:null!==(Y=_.find(E,function(de){return de.value===f.rowWithReferenceText.rowWithReferenceText}))&&void 0!==Y?Y:E[0]}).build())})}return le.build()}},p.prototype.getAccessibilityCard=function(u,n,h,H){if(H===d.Y.TableEx){var f=se.Z.accessibility,m=_.filter(u,L.pt),b=_.filter(u,function(E){return E.type.text}).map(function(E){return{displayName:E.displayName,value:E.queryName}});if(!_.isEmpty(m)||!_.isEmpty(b)){var R=new o.CQ(new o.lg("accessibility"),"Accessibility",[f.altTextColumns,f.rowWithReferenceText],function(ie){return n.getLocalizedString(ie)});if(_.isEmpty(m)||R.addGroup("AltTextValues",function(E){E.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),E.addContainer("measure",function(ie){ie.withDisplayName("Image_Alt_Text_Values");for(var le=function(ge){ie.addContainerItem(ge.queryName,ge.displayName,function(be){return be.addSimpleSlice("altTextColumns",new o.k0({descriptor:(0,z.__assign)((0,z.__assign)({},f.altTextColumns),{selector:{data:[(0,te.Ue)(0)],metadata:ge.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},fe=0,he=m;fe<he.length;fe++)le(he[fe])})}),!_.isEmpty(b)){var k={displayName:n.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};b.unshift(k),R.addGroup("rowWithReferenceText",function(E){var ie;E.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),E.addSimpleSlice("rowWithReferenceText",new o.uY({descriptor:(0,z.__assign)({},f.rowWithReferenceText),items:b,value:null!==(ie=_.find(b,function(le){return le.value===h.rowWithReferenceText.rowWithReferenceText}))&&void 0!==ie?ie:b[0]}).build())})}return R.build()}}},p.prototype.getRowSubTotalsCard=function(u,n,h,H,f,m){var b=this;if(f||H===d.Y.PivotTable){var T=p.getMetadataObjects(h),R=t.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,T),k=function(Y){return u.getLocalizedString(Y)},E=pe.t.subTotals,ie=(0,z.__assign)((0,z.__assign)({},n.subtotals),n.rowSubtotals),le=new o.CQ(new o.lg("rowSubTotal"),"Visual_SubtotalRow",[E.rowSubtotalsLabel,E.rowSubtotals,E.rowSubtotalsPosition,E.perRowLevel,E.levelSubtotalEnabled,E.levelSubtotalLabel,E.fontColor,E.backColor,E.fontSize,E.fontFamily,E.bold,E.italic,E.underline,E.applyToHeaders],k);le.addTopLevelToggle("rowSubtotals",function(){return new o.bd({descriptor:E.rowSubtotals,value:n.general.rowSubtotals}).build()});var fe=0;return le.addGroup("applySettingsTo",function(he){he.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new o.bd({descriptor:E.perRowLevel,value:R}).build(),function(Y){return Y.withDisabled(!b.shouldShowRowSubtotalsOption(h)).withCustomDescriptionIf(function(){return!b.shouldShowRowSubtotalsOption(h)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(Y){Y.withDisplayName("Visual_Tablix_Row_Level"),Y.addContainerItem("all",k("All"),function(ae){return b.getRowSubtotalContainers(n,ae,k,m,E,ie,void 0,T)});for(var de=0,ge=h.matrix.rows.levels;de<ge.length;de++)for(var ye=function(a){if(!a.isMeasure){var F={metadata:a.queryName};Y.addContainerItem(a.displayName,a.displayName,function(V){return b.getRowSubtotalContainers(n,V,k,m,E,ie,F,a.objects,fe)}),fe++}},me=0,we=ge[de].sources;me<we.length;me++)ye(we[me])})}),le.build()}},p.prototype.getRowSubtotalContainers=function(u,n,h,H,f,m,b,T,R){var k=b?t.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(T,!0):t.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(T,!0),E=b?"":h(S.qT),ie=b?f.levelSubtotalLabel:f.rowSubtotalsLabel;n.addGroup("rows",function(le){le.withDisplayName("Role_DisplayName_Rows"),le.addSimpleSlice("levelSubtotalEnabled",new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},f.levelSubtotalEnabled),{selector:b}),value:t.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,T)}).build(),function(fe){return fe.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!b)}).addSimpleSlice("rowSubtotalsLabel",new o.fq({descriptor:(0,z.__assign)((0,z.__assign)({},ie),{selector:b}),value:k||E,placeholder:""}).build(),function(fe){return fe.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(b?"rowSubtotalsPositionSeries".concat(R):"rowSubtotalsPositionAll",new o.uY({descriptor:f.rowSubtotalsPosition,value:u.subtotals.rowSubtotalsPosition}).build(),function(fe){return fe.withCustomDisplayName("Visual_Position").withDisabled(!!b||H.matrixLayouts&&u.general.layout===v.t.Tabular)})}),n.addGroup("values",function(le){if(le.withDisplayName("Visual_Tablix_Values"),b)le.withDisabled(!0,"");else{var fe={id:"Row"},Y=(new o.UN).withFontFamily({descriptor:(0,z.__assign)((0,z.__assign)({},f.fontFamily),{selector:fe}),value:m.fontFamily}).withFontSizeProperties({descriptor:(0,z.__assign)((0,z.__assign)({},f.fontSize),{selector:fe}),value:m.fontSize.pt}).withBold({descriptor:(0,z.__assign)((0,z.__assign)({},f.bold),{selector:fe}),value:m.bold}).withItalic({descriptor:(0,z.__assign)((0,z.__assign)({},f.italic),{selector:fe}),value:m.italic}).withUnderline({descriptor:(0,z.__assign)((0,z.__assign)({},f.underline),{selector:fe}),value:m.underline}).build();le.addCompositeSlice("font","Font",Y).addSimpleSlice("fontColor",function(){var de={value:m.fontColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},f.fontColor),{selector:fe}),value:de}).build()},function(de){return de.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var de={value:m.backColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},f.backColor),{selector:fe}),value:de}).build()},function(de){return de.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},f.applyToHeaders),{selector:fe}),value:m.applyToHeaders}).build())}})},p.prototype.getColumnSubtotalCard=function(u,n,h,H,f,m){var b=this;if(f||H===d.Y.PivotTable||this.shouldShowColumnSubtotalsOption(h)){var T=p.getMetadataObjects(h),R=t.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(T),k=function(he){return u.getLocalizedString(he)},E=pe.t.subTotals,ie=(0,z.__assign)((0,z.__assign)({},n.subtotals),n.columnSubtotals),le=new o.CQ(new o.lg("columnSubTotal"),"Visual_SubtotalColumn",[E.columnSubtotals,E.columnSubtotalsLabel,E.perColumnLevel,E.levelSubtotalEnabled,E.levelSubtotalLabel,E.fontColor,E.backColor,E.fontSize,E.fontFamily,E.bold,E.italic,E.underline,E.applyToHeaders],k);return le.addTopLevelToggle("columnSubtotals",function(){return new o.bd({descriptor:E.columnSubtotals,value:n.general.columnSubtotals}).build()}),le.addGroup("applySettingsTo",function(fe){fe.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new o.bd({descriptor:E.perColumnLevel,value:R}).build(),function(he){return he.withDisabled(!b.shouldShowColumnSubtotalsOption(h)).withCustomDescriptionIf(function(){return!b.shouldShowColumnSubtotalsOption(h)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(he){he.withDisplayName("Visual_Tablix_Column_Level"),he.addContainerItem("all",k("All"),function(Re){return b.getColumnSubtotalContainers(Re,k,m,E,ie,void 0,T)});for(var Y=0,de=h.matrix.columns.levels;Y<de.length;Y++)for(var be=function(ae){if(!ae.isMeasure){var a={metadata:ae.queryName};he.addContainerItem(ae.displayName,ae.displayName,function(F){return b.getColumnSubtotalContainers(F,k,m,E,ie,a,ae.objects)})}},ye=0,me=de[Y].sources;ye<me.length;ye++)be(me[ye])})}),le.build()}},p.prototype.getColumnSubtotalContainers=function(u,n,h,H,f,m,b){var T=n(S.qT),R=m?t.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(b,!0):t.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(b,!0),k=m?H.levelSubtotalLabel:H.columnSubtotalsLabel;u.addGroup("columns",function(E){E.withDisplayName("Role_DisplayName_Columns"),E.addSimpleSlice("levelSubtotalEnabled",new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},H.levelSubtotalEnabled),{selector:m}),value:t.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,b)}).build(),function(ie){return ie.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!m)}).addSimpleSlice("columnSubtotalsLabel",new o.fq({descriptor:(0,z.__assign)((0,z.__assign)({},k),{selector:m}),value:R||T,placeholder:""}).build(),function(ie){return ie.withCustomDisplayName("Visual_Subtotal_Label")})}),u.addGroup("values",function(E){if(E.withDisplayName("Visual_Tablix_Values"),m)E.withDisabled(!0,"");else{var ie={id:"Column"},fe=(new o.UN).withFontFamily({descriptor:(0,z.__assign)((0,z.__assign)({},H.fontFamily),{selector:ie}),value:f.fontFamily}).withFontSizeProperties({descriptor:(0,z.__assign)((0,z.__assign)({},H.fontSize),{selector:ie}),value:f.fontSize.pt}).withBold({descriptor:(0,z.__assign)((0,z.__assign)({},H.bold),{selector:ie}),value:f.bold}).withItalic({descriptor:(0,z.__assign)((0,z.__assign)({},H.italic),{selector:ie}),value:f.italic}).withUnderline({descriptor:(0,z.__assign)((0,z.__assign)({},H.underline),{selector:ie}),value:f.underline}).build();E.addCompositeSlice("font","Font",fe).addSimpleSlice("fontColor",function(){var he={value:f.fontColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},H.fontColor),{selector:ie}),value:he}).build()},function(he){return he.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var he={value:f.backColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},H.backColor),{selector:ie}),value:he}).build()},function(he){return he.withCustomDisplayName("Background_Color")}),E.addSimpleSlice("applyToHeaders",new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},H.applyToHeaders),{selector:ie}),value:f.applyToHeaders}).build())}})},p.prototype.getColumnFormattingCard=function(u,n,h,H){if(!_.isEmpty(h)){var T=(0,z.__rest)(H===d.Y.TableEx?se.Z.columnFormatting:pe.t.columnFormatting,["dataBars"]),R=n.columnFormatting,k=new o.CQ(new o.lg("columnFormatting"),"Visual_Tablix_Specific_Column",T,function(ie){return u.getLocalizedString(ie)});return k.withDescription("Visual_Matrix_SpecificColumn_Description"),k.addGroup("columns",function(E){E.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(ie){ie.withDisplayName("Series");for(var le=function(ge){var be=ge&&ge.objects;ie.addContainerItem(ge.queryName,ge.displayName,function(ye){ye.addSimpleSlice(T.styleHeader,new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},T.styleHeader),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleHeader}).build()),H===d.Y.PivotTable&&ye.addSimpleSlice(T.styleSubtotals,new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},T.styleSubtotals),{selector:{metadata:ge.queryName}}),value:t.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,be)}).build()),ye.addSimpleSlice(T.styleTotal,new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},T.styleTotal),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleTotal}).build()).addSimpleSlice(T.styleValues,new o.bd({descriptor:(0,z.__assign)((0,z.__assign)({},T.styleValues),{selector:{metadata:ge.queryName}}),value:R[ge.queryName].styleValues}).build()),ye.addGroup("values",function(me){if(me.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var Re={value:R[ge.queryName].fontColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},T.fontColor),{selector:{metadata:ge.queryName}}),value:Re}).build()},function(Re){return Re.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var Re={value:R[ge.queryName].backColor};return new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},T.backColor),{selector:{metadata:ge.queryName}}),value:Re}).build()},function(Re){return Re.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new o.Gp({descriptor:(0,z.__assign)((0,z.__assign)({},T.alignment),{selector:{metadata:ge.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:R[ge.queryName].alignment}).build()),ge.type.numeric&&(H===d.Y.PivotTable||H===d.Y.TableEx)){var we=ge&&ge.objects;me.addSimpleSlice("labelDisplayUnits",new o.uY({descriptor:(0,z.__assign)((0,z.__assign)({},T.labelDisplayUnits),{selector:{metadata:ge.queryName}}),value:t.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,we)}).build()).addSimpleSlice("labelPrecision",new o.mu({descriptor:(0,z.__assign)((0,z.__assign)({},T.labelPrecision),{selector:{metadata:ge.queryName}}),value:t.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,we),options:{minValue:{type:0,value:0},maxValue:{type:1,value:W.vo}}}).build())}})})},fe=0,he=h;fe<he.length;fe++)le(he[fe])})}),k.build()}},p.prototype.getCellColumnCard=function(u,n,h,H){var b=(0,se.k)().objects,T=[];return this.enumerateObjectRepetition(T,h,n,H),(0,J.Z)(T,function(k){return u.getLocalizedString(k)},b,"Cell_Elements","Visual_Matrix_CellElements_Description")},p.prototype.getUrlIconCard=function(u,n,h){var H=h===d.Y.TableEx?se.Z.values.urlIcon:pe.t.values.urlIcon,f=n,m=pe.t.columnHeaders.urlIcon,b=pe.t.rowHeaders.urlIcon,R=new o.CQ(new o.lg("urlIcon"),"Visual_Tablix_UrlIcon",[H,m,b],function(E){return u.getLocalizedString(E)});return R.addGroup("urlIcon",function(k){(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&k.addSimpleSlice("values",new o.bd({descriptor:H,value:n.values.urlIcon}).build(),function(E){return E.withCustomDisplayName("Visual_Tablix_Values")}),h===d.Y.PivotTable&&k.addSimpleSlice("columnheaders",new o.bd({descriptor:m,value:f.columnHeaders.urlIcon}).build(),function(E){return E.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new o.bd({descriptor:b,value:f.rowHeaders.urlIcon}).build(),function(E){return E.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),R.build()},p.prototype.getImageSizeCard=function(u,n,h,H){var f=h===d.Y.TableEx?se.Z.grid.imageHeight:pe.t.grid.imageHeight,m=h===d.Y.TableEx?se.Z.grid.imageWidth:pe.t.grid.imageWidth,T=new o.CQ(new o.lg("imageHeight"),"Visual_Tablix_ImageSize",[f,m],function(k){return u.getLocalizedString(k)});return T.addGroup("imageHeight",function(R){R.addSimpleSlice("imageHeight",new o.mu({descriptor:f,value:n.grid.imageHeight,options:{minValue:{type:0,value:p.ImageSizeMin},maxValue:{type:1,value:p.ImageSizeMax},unitSymbol:q.e_}}).build()),H.tablixImageWidth&&R.addSimpleSlice("imageWidth",new o.mu({descriptor:m,value:n.grid.imageWidth,options:{minValue:{type:0,value:p.ImageSizeMin},maxValue:{type:1,value:p.ImageSizeMax},unitSymbol:q.e_}}).build())}),T.build()},p.prototype.getSparklinesCard=function(u,n,h){var H=this;if(!_.isEmpty(u)&&this.hasSparklines(u)){var f=function(T){return n.getLocalizedString(T)},m=h===d.Y.TableEx?se.Z.sparklines:pe.t.sparklines;return new o.CQ(new o.lg("sparklines"),"Sparkline_Label",m,f).addGroup("columns",function(b){return b.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(T){var R;T.withDisplayName("Sparkline_Singular_Label");for(var k=function(he){if(!(null===(R=he.type.misc)||void 0===R?void 0:R.sparkline))return"continue";var de=he?.objects,ge={metadata:he.queryName};T.addContainerItem(he.queryName,he.displayName,function(be){var ye=t.FX.PropSparklinesChartType.setInstanceProperty(void 0,de);be.addGroup("sparklines",function(me){return me.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new o.uY({descriptor:(0,z.__assign)((0,z.__assign)({},m.chartType),{selector:ge}),value:ye}).build()).addSimpleSlice("dataColor",new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},m.dataColor),{selector:ge}),value:{value:H.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,de).solid.color}}).build()).addSimpleSlice("strokeWidth",new o.JN({descriptor:(0,z.__assign)((0,z.__assign)({},m.strokeWidth),{selector:ge}),value:t.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,de),localize:f,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(we){return we.withHidden(ye!==C.U.line)})}),ye===C.U.line&&be.addGroup("markers",function(me){var we=t.FX.PropSparklinesMarkerType.getValue(de);me.withDisplayName("Marker").addSimpleSlice("markers",new o.oM({descriptor:(0,z.__assign)((0,z.__assign)({},m.markers),{selector:ge}),value:we}).build()),null!=we&&0!==we&&me.addSimpleSlice("markerColor",new o.BT({descriptor:(0,z.__assign)((0,z.__assign)({},m.markerColor),{selector:ge}),value:{value:H.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,de).solid.color}}).build()).addSimpleSlice("markerShape",new o.uY({descriptor:(0,z.__assign)((0,z.__assign)({},m.markerShape),{selector:ge}),value:t.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,de)}).build()).addSimpleSlice("markerSize",new o.JN({descriptor:(0,z.__assign)((0,z.__assign)({},m.markerSize),{selector:ge}),value:t.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,de),localize:f,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},E=0,ie=u;E<ie.length;E++)k(ie[E])})}).build()}},p.prototype.hasSparklines=function(u){for(var n,h=0,H=u;h<H.length;h++)if(null===(n=H[h].type.misc)||void 0===n?void 0:n.sparkline)return!0;return!1},p.prototype.enumerateObjectInstances=function(u,n,h,H,f,m,b,T){void 0===m&&(m={}),void 0===b&&(b=!1),i.fF.assertValue(h,"dataView can't be undefined");var E,R=p.getMetadataObjects(h),k=this.getTablixTextClassProperties(T);switch(E=H===d.Y.Table?this.shouldShowTableTotalsOption(h)&&t.FX.PropGeneralTableTotals.getValue(R):this.shouldShowColumnSubtotalsOption(h)&&t.FX.PropGeneralMatrixColumnSubtotals.getValue(R)||this.shouldShowRowSubtotalsOption(h)&&t.FX.PropGeneralMatrixRowSubtotals.getValue(R),u.objectName){case t.FX.ObjectGeneral:this.enumerateGeneralOptions(n,R,H,h);break;case t.FX.ObjectGrid:this.enumerateGridOptions(n,R,H,k,m);break;case t.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(n,R,H,k,m);break;case t.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(n,R,H,b,k,m);break;case t.FX.ObjectValues:this.enumerateValuesOptions(n,R,H,k,m);break;case t.FX.ObjectTotal:H===d.Y.TableEx?this.enumerateTotalOptions(n,R,d.Y.TableEx,f,m,k):E&&(H===d.Y.Table?this.enumerateTotalOptions(n,R,d.Y.TableEx,f,m,k):this.enumerateGrandTotalOptions(n,R,H,k));break;case t.FX.ObjectColumnTotal:H===d.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(n,R,k,m);break;case t.FX.ObjectRowTotal:H===d.Y.PivotTable&&this.enumerateRowGrandTotalOptions(n,R,k,m);break;case t.FX.ObjectSubTotals:(E||H===d.Y.PivotTable)&&this.enumerateSubTotalsOptions(n,R,H,h,f,m,k);break;case t.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(n,this.getColumnsMetadata(h,H),H);break;case t.FX.ObjectSparklines:this.enumerateSparklines(n,this.getColumnsMetadata(h,H))}},p.prototype.getColumnsMetadata=function(u,n){switch(n){case d.Y.Table:case d.Y.TableEx:return this.getTableColumnMetadata(u);case d.Y.Matrix:case d.Y.PivotTable:return this.getMatrixValuesColumnMetadata(u);default:return void i.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+n)}},p.prototype.getTableColumnMetadata=function(u){if(u&&u.table&&!_.isEmpty(u.table.columns))return u.table.columns},p.prototype.getMatrixRowsColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.rows)){for(var n=[],h=0,H=u.matrix.rows.levels;h<H.length;h++)for(var m=0,b=H[h].sources;m<b.length;m++)n.push(b[m]);return n}},p.prototype.getMatrixColumnsColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.columns)){for(var n=[],h=0,H=u.matrix.columns.levels;h<H.length;h++)for(var m=0,b=H[h].sources;m<b.length;m++)n.push(b[m]);return n}},p.prototype.getMatrixValuesColumnMetadata=function(u){if(u&&u.matrix&&!_.isEmpty(u.matrix.valueSources))return u.matrix.valueSources},p.prototype.createVisualObjectInstance=function(u,n,h){void 0===n&&(n=null);var H={selector:n,objectName:u,properties:{}};return null!=h&&(H.displayName=h),H},p.prototype.enumerateGeneralOptions=function(u,n,h,H){var f=this.createVisualObjectInstance(t.FX.ObjectGeneral);switch(h){case d.Y.Table:t.FX.PropGeneralAutoSizeColumns.setInstanceProperty(f,n),t.FX.PropGeneralTextSize.setInstanceProperty(f,n),this.shouldShowTableTotalsOption(H)&&t.FX.PropGeneralTableTotals.setInstanceProperty(f,n);break;case d.Y.Matrix:t.FX.PropGeneralAutoSizeColumns.setInstanceProperty(f,n),t.FX.PropGeneralTextSize.setInstanceProperty(f,n),this.shouldShowRowSubtotalsOption(H)&&t.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(f,n),this.shouldShowColumnSubtotalsOption(H)&&t.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(f,n)}u.pushInstance(f)},p.prototype.enumerateGridOptions=function(u,n,h,H,f){var m=this.createVisualObjectInstance(t.FX.ObjectGrid),b=H.labelFontProperties.size&&H.labelFontProperties.size.pt,T=t.FX.PropGridVertical.getValue(n);t.FX.PropGridVertical.setInstanceProperty(m,n),T&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(m,n),t.FX.PropGridVerticalWeight.setInstanceProperty(m,n));var R=h===d.Y.Table||h===d.Y.TableEx,k=(R?t.FX.PropGridHorizontalTable:t.FX.PropGridHorizontalMatrix).getValue(n);(R?t.FX.PropGridHorizontalTable:t.FX.PropGridHorizontalMatrix).setInstanceProperty(m,n),k&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(m,n),t.FX.PropGridHorizontalWeight.setInstanceProperty(m,n)),t.FX.PropGridRowPadding.setInstanceProperty(m,n),(h===d.Y.PivotTable||h===d.Y.TableEx)&&t.FX.PropGridOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,t.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(m,n),t.FX.PropGridOutlineWeight.setInstanceProperty(m,n),(h===d.Y.PivotTable||h===d.Y.TableEx)&&t.FX.PropGridPivotTableTextSize.setInstanceProperty(m,n,H.fontSizeOverrideFn,b),t.FX.PropGridImageHeight.setInstanceProperty(m,n),u.pushInstance(m)},p.prototype.enumerateColumnHeadersOptions=function(u,n,h,H,f){var m=this.createVisualObjectInstance(t.FX.ObjectColumnHeaders),b=H.labelFontProperties.size&&H.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(m,n,H.fontColorOverrideFn,H.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(m,n),h===d.Y.PivotTable||h===d.Y.TableEx){var R=this.ensureOutline(t.FX.PropColumnsOutlineStyle.getValue(n),n,t.UR);t.FX.PropColumnsOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,R);var k=this.ensureOutlineWeight(t.FX.PropColumnsOutlineWeight.getValue(n),n);t.FX.PropColumnsOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,k);var E=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(n),n);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,E),t.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(m,n),t.FX.PropColumnsFontFamily.setInstanceProperty(m,n,H.fontFamilyOverrideFn,H.labelFontProperties.family),t.FX.PropColumnsFontSize.setInstanceProperty(m,n,H.fontSizeOverrideFn,b),t.FX.PropColumnsBold.setInstanceProperty(m,n),t.FX.PropColumnsItalic.setInstanceProperty(m,n),t.FX.PropColumnsUnderline.setInstanceProperty(m,n),t.FX.PropColumnsAlignment.setInstanceProperty(m,n)}else t.FX.PropColumnsOutline.setInstanceProperty(m,n);h===d.Y.PivotTable&&(t.FX.PropColumnsAlignmentTitle.setInstanceProperty(m,n),t.FX.PropColumnsUrlIcon.setInstanceProperty(m,n)),(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&t.FX.PropColumnsWordWrap.setInstanceProperty(m,n),u.pushInstance(m)},p.prototype.enumerateRowHeadersOptions=function(u,n,h,H,f,m){void 0===H&&(H=!1);var b=this.createVisualObjectInstance(t.FX.ObjectRowHeaders),T=f.labelFontProperties.size&&f.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(b,n,f.fontColorOverrideFn,f.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(b,n),h===d.Y.PivotTable||h===d.Y.TableEx){var k=this.ensureOutline(t.FX.PropRowsOutlineStyle.getValue(n),n,t.Pi);t.FX.PropRowsOutlineStyle.setInstanceProperty(b,n,this.outlineOverrideFn,k)}else t.FX.PropRowsOutline.setInstanceProperty(b,n);if(h===d.Y.PivotTable){var E=this.ensureOutlineWeight(t.FX.PropRowsOutlineWeight.getValue(n),n);t.FX.PropRowsOutlineWeight.setInstanceProperty(b,n,this.outlineOverrideFn,E);var ie=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(n),n);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(b,n,this.outlineOverrideFn,ie),t.FX.PropRowsSteppedLayout.setInstanceProperty(b,n)&&t.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(b,n),t.FX.PropRowsUrlIcon.setInstanceProperty(b,n),t.FX.PropGeneralMatrixLayout.setInstanceProperty(b,n)!==v.t.Compact&&t.FX.PropRowsRepeatRowHeaders.setInstanceProperty(b,n)}(h===d.Y.Matrix||h===d.Y.PivotTable)&&t.FX.PropRowsWordWrap.setInstanceProperty(b,n),(h===d.Y.PivotTable||h===d.Y.TableEx)&&(t.FX.PropRowsFontFamily.setInstanceProperty(b,n,f.fontFamilyOverrideFn,f.labelFontProperties.family),t.FX.PropRowsFontSize.setInstanceProperty(b,n,f.fontSizeOverrideFn,T),t.FX.PropRowsBold.setInstanceProperty(b,n),t.FX.PropRowsItalic.setInstanceProperty(b,n),t.FX.PropRowsUnderline.setInstanceProperty(b,n),t.FX.PropRowsAlignment.setInstanceProperty(b,n)),h===d.Y.PivotTable&&H&&(t.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(b,n),t.FX.PropRowsShowExpandCollapseButtons.getValue(n)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(b,n),t.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(b,n))),u.pushInstance(b)},p.prototype.enumerateValuesOptions=function(u,n,h,H,f){var m=this.createVisualObjectInstance(t.FX.ObjectValues),b=H.labelFontProperties.size&&H.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(m,n,H.fontColorOverrideFn,H.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(m,n),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(m,n),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(m,n),h===d.Y.PivotTable&&(t.FX.PropValuesBandedRowHeaders.setInstanceProperty(m,n),t.FX.PropValuesOnRow.setInstanceProperty(m,n)),h===d.Y.PivotTable||h===d.Y.TableEx){var R=this.ensureOutline(t.FX.PropValuesOutlineStyle.getValue(n),n,t.IC);t.FX.PropValuesOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,R);var k=this.ensureOutlineWeight(t.FX.PropValuesOutlineWeight.getValue(n),n);t.FX.PropValuesOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,k);var E=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(n),n);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,E)}else t.FX.PropValuesOutline.setInstanceProperty(m,n);(h===d.Y.Table||h===d.Y.TableEx||h===d.Y.PivotTable)&&t.FX.PropValuesUrlIcon.setInstanceProperty(m,n),(h===d.Y.PivotTable||h===d.Y.TableEx)&&(t.FX.PropValuesWordWrap.setInstanceProperty(m,n),t.FX.PropValuesFontFamily.setInstanceProperty(m,n,H.fontFamilyOverrideFn,H.labelFontProperties.family),t.FX.PropValuesFontSize.setInstanceProperty(m,n,H.fontSizeOverrideFn,b),t.FX.PropValuesBold.setInstanceProperty(m,n),t.FX.PropValuesItalic.setInstanceProperty(m,n),t.FX.PropValuesUnderline.setInstanceProperty(m,n)),u.pushInstance(m)},p.prototype.enumerateTotalOptions=function(u,n,h,H,f,m){var b=this.createVisualObjectInstance(t.FX.ObjectTotal),T=m.boldLabelFontProperties.size&&m.boldLabelFontProperties.size.pt;if(h!==d.Y.TableEx||t.FX.PropTotalTableExTotals.setInstanceProperty(b,n)){if(h===d.Y.TableEx){var k=t.FX.PropTotalTableExTotalLabel.getValue(n,!0)||H(S.qT);b.properties[t.FX.PropTotalTableExTotalLabel.propertyName]=k}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(b,n,m.fontColorOverrideFn,m.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(b,n),h===d.Y.PivotTable||h===d.Y.TableEx){var ie=this.ensureOutline(t.FX.PropTotalOutlineStyle.getValue(n),n,t.Sc);t.FX.PropTotalOutlineStyle.setInstanceProperty(b,n,this.outlineOverrideFn,ie)}else t.FX.PropTotalOutline.setInstanceProperty(b,n);if(h===d.Y.TableEx){var le=this.ensureOutlineWeight(t.FX.PropTotalOutlineWeight.getValue(n),n);t.FX.PropTotalOutlineWeight.setInstanceProperty(b,n,this.outlineOverrideFn,le);var fe=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(n),n);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(b,n,this.outlineOverrideFn,fe)}(h===d.Y.PivotTable||h===d.Y.TableEx)&&(t.FX.PropTotalFontFamily.setInstanceProperty(b,n,m.fontFamilyOverrideFn,m.boldLabelFontProperties.family),t.FX.PropTotalFontSize.setInstanceProperty(b,n,m.fontSizeOverrideFn,T),t.FX.PropTotalBold.setInstanceProperty(b,n),t.FX.PropTotalItalic.setInstanceProperty(b,n),t.FX.PropTotalUnderline.setInstanceProperty(b,n))}u.pushInstance(b)},p.prototype.enumerateGrandTotalOptions=function(u,n,h,H){if(h!==d.Y.PivotTable){var f=this.createVisualObjectInstance(t.FX.ObjectTotal),m=H.boldLabelFontProperties.size&&H.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(f,n,H.fontColorOverrideFn,H.boldLabelFontProperties.color),t.FX.PropGrandTotalFontFamily.setInstanceProperty(f,n),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(f,n),t.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(f,n),h===d.Y.TableEx&&(t.FX.PropGrandTotalFontFamily.setInstanceProperty(f,n,H.fontFamilyOverrideFn,H.boldLabelFontProperties.family),t.FX.PropGrandTotalFontSize.setInstanceProperty(f,n,H.fontSizeOverrideFn,m),t.FX.PropGrandTotalBold.setInstanceProperty(f,n),t.FX.PropGrandTotalItalic.setInstanceProperty(f,n),t.FX.PropGrandTotalUnderline.setInstanceProperty(f,n)),u.pushInstance(f)}},p.prototype.enumerateColumnGrandTotalOptions=function(u,n,h,H){var f=this.createVisualObjectInstance(t.FX.ObjectColumnTotal),m=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(f,n,h.fontColorOverrideFn,h.boldLabelFontProperties.color),t.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(f,n),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(f,n),t.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(f,n),t.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(f,n,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family),t.FX.PropColumnGrandTotalFontSize.setInstanceProperty(f,n,h.fontSizeOverrideFn,m),t.FX.PropColumnGrandTotalBold.setInstanceProperty(f,n),t.FX.PropColumnGrandTotalItalic.setInstanceProperty(f,n),t.FX.PropColumnGrandTotalUnderline.setInstanceProperty(f,n),u.pushInstance(f)},p.prototype.enumerateRowGrandTotalOptions=function(u,n,h,H){var f=this.createVisualObjectInstance(t.FX.ObjectRowTotal),m=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(f,n,h.fontColorOverrideFn,h.boldLabelFontProperties.color),t.FX.PropRowGrandTotalFontFamily.setInstanceProperty(f,n),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(f,n),t.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(f,n),t.FX.PropRowGrandTotalFontFamily.setInstanceProperty(f,n,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family),t.FX.PropRowGrandTotalFontSize.setInstanceProperty(f,n,h.fontSizeOverrideFn,m),t.FX.PropRowGrandTotalBold.setInstanceProperty(f,n),t.FX.PropRowGrandTotalItalic.setInstanceProperty(f,n),t.FX.PropRowGrandTotalUnderline.setInstanceProperty(f,n),u.pushInstance(f)},p.prototype.enumerateSubTotalsOptions=function(u,n,h,H,f,m,b){var k,E,ie,T=!1,R=!1;if(h===d.Y.PivotTable){i.fF.assertValue(f,"enumerateSubTotalsOptions - localizer"),k=f(S.qT);var le=this.createVisualObjectInstance(t.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(H)&&(T=t.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(le,n)),T&&(E=t.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(n,!0)||k,le.properties[t.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=E),u.pushInstance(le)}if(this.enumerateSubtotalsFontProperties(u,n,b,m,h,"Row"),T){le=this.createVisualObjectInstance(t.FX.ObjectSubTotals),t.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(le,n),u.pushInstance(le),le=this.createVisualObjectInstance(t.FX.ObjectSubTotals);var fe=t.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(le,n);u.pushInstance(le,!1),fe&&this.enumeratePerLevelSubtotals(u,H.matrix.rows.levels,E,f)}h===d.Y.PivotTable&&(le=this.createVisualObjectInstance(t.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(H)&&(R=t.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(le,n)),R&&(ie=t.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(n,!0)||k,le.properties[t.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=ie),u.pushInstance(le,!1)),this.enumerateSubtotalsFontProperties(u,n,b,m,h,"Column"),R&&(le=this.createVisualObjectInstance(t.FX.ObjectSubTotals),fe=t.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(le,n),u.pushInstance(le,!1),i.fF.assert(function(){return!_.isEmpty(H.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),fe&&this.enumeratePerLevelSubtotals(u,H.matrix.columns.levels,ie,f))},p.prototype.enumerateSubtotalsFontProperties=function(u,n,h,H,f,m){var T=this.createVisualObjectInstance(t.FX.ObjectSubTotals,m?{id:m}:void 0),R=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(T,n,h.fontColorOverrideFn,h.boldLabelFontProperties.color,m),t.FX.PropSubTotalsFontFamily.setInstanceProperty(T,n,void 0,void 0,m),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(T,n,void 0,void 0,m),f===d.Y.PivotTable&&(t.FX.PropSubTotalsFontFamily.setInstanceProperty(T,n,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family,m),t.FX.PropSubTotalsFontSize.setInstanceProperty(T,n,h.fontSizeOverrideFn,R,m),t.FX.PropSubTotalsBold.setInstanceProperty(T,n,void 0,void 0,m),t.FX.PropSubTotalsItalic.setInstanceProperty(T,n,void 0,void 0,m),t.FX.PropSubTotalsUnderline.setInstanceProperty(T,n,void 0,void 0,m),t.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(T,n,void 0,void 0,m)),u.pushInstance(T)},p.prototype.enumeratePerLevelSubtotals=function(u,n,h,H){i.fF.assert(function(){return!_.isEmpty(n)},"enumeratePerLevelSubtotals: Empty levels");for(var f=0,m=n;f<m.length;f++)for(var T=0,R=m[f].sources;T<R.length;T++){var k=R[T];if(!k.isMeasure){var E=this.createVisualObjectInstance(t.FX.ObjectSubTotals,{metadata:k.queryName},k.displayName);t.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(E,k.objects),u.pushInstance(E,!1),E=this.createVisualObjectInstance(t.FX.ObjectSubTotals,{metadata:k.queryName},H("Visual_PivotTable_TotalLabel",k.displayName));var ie=t.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(k.objects,!0)||h;E.properties[t.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=ie,u.pushInstance(E,!1)}}},p.prototype.enumerateColumnFormattingOptions=function(u,n,h){if(!_.isEmpty(n))for(var H=0,f=n;H<f.length;H++){var m=f[H];u.pushContainer({displayName:m.displayName});var b=m&&m.objects,T=this.createVisualObjectInstance(t.FX.ObjectColumnFormatting,{metadata:m.queryName});m.type.numeric&&(h===d.Y.PivotTable||h===d.Y.TableEx)&&(t.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(T,b),t.FX.PropColumnFormattingPrecision.setInstanceProperty(T,b),t.FX.PropColumnFormattingPrecision.setInstanceValidValues(T,{numberRange:{min:0,max:W.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(T,b),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(T,b),(h===d.Y.PivotTable||h===d.Y.TableEx)&&t.FX.PropColumnFormattingAlignment.setInstanceProperty(T,b),t.FX.PropColumnFormattingStyleHeader.setInstanceProperty(T,b),t.FX.PropColumnFormattingStyleValues.setInstanceProperty(T,b),(h===d.Y.Matrix||h===d.Y.PivotTable)&&t.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(T,b),t.FX.PropColumnFormattingStyleTotal.setInstanceProperty(T,b),u.pushInstance(T),u.popContainer()}},p.prototype.enumerateSparklines=function(u,n){var h;if(!_.isEmpty(n))for(var H=0,f=n;H<f.length;H++){var m=f[H];if(null===(h=m.type.misc)||void 0===h?void 0:h.sparkline){u.pushContainer({displayName:m.displayName});var T=m&&m.objects,R=this.createVisualObjectInstance(t.FX.ObjectSparklines,{metadata:m.queryName});if(t.FX.PropSparklinesChartType.setInstanceProperty(R,T),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(R,T),t.FX.PropSparklinesChartType.getValue(T)===C.U.line){t.FX.PropSparklinesStrokeWidth.setInstanceProperty(R,T),t.FX.PropSparklinesStrokeWidth.setInstanceValidValues(R,{numberRange:{min:1,max:4}}),t.FX.PropSparklinesMarkerType.setInstanceProperty(R,T);var k=t.FX.PropSparklinesMarkerType.getValue(T);null!=k&&0!==k&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(R,T),t.FX.PropSparklinesMarkerSize.setInstanceProperty(R,T),t.FX.PropSparklinesMarkerSize.setInstanceValidValues(R,{numberRange:{min:3,max:5}}),t.FX.PropSparklinesMarkerShape.setInstanceProperty(R,T))}u.pushInstance(R),u.popContainer()}}},p.prototype.getTableObjects=function(u){var n=p.getMetadataObjects(u),h=t.FX.PropGeneralTextSize.getValue(n),H=null!=h?G.B.createFromPt(+h):void 0,f={general:{autoSizeColumnWidth:t.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:H,totals:t.FX.PropGeneralTableTotals.getValue(n)}};f.grid={gridVertical:t.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:t.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:t.FX.PropGridHorizontalTable.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:t.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:t.FX.PropGridOutlineWeight.getValue(n),rowPadding:t.FX.PropGridRowPadding.getValue(n),imageHeight:t.FX.PropGridImageHeight.getValue(n)},f.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:t.FX.PropColumnsOutline.getValue(n),wordWrap:t.FX.PropColumnsWordWrap.getValue(n)},f.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:t.FX.PropValuesOutline.getValue(n),urlIcon:t.FX.PropValuesUrlIcon.getValue(n)},f.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(n),backColor:this.tablixProperties.PropTotalBackColor.getValue(n),outline:t.FX.PropTotalOutline.getValue(n)},f.columnFormatting={},f.formatters={};var m=this.getTableColumnMetadata(u);if(m)for(var b=0,T=m;b<T.length;b++){var R=T[b],k=R&&R.objects;f.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(k),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(k),styleHeader:t.FX.PropColumnFormattingStyleHeader.getValue(k),styleValues:t.FX.PropColumnFormattingStyleValues.getValue(k),styleTotal:t.FX.PropColumnFormattingStyleTotal.getValue(k)},f.formatters[R.queryName]=new g.g({column:R,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!1})}return f},p.prototype.getMatrixObjects=function(u){var n=p.getMetadataObjects(u),h=t.FX.PropGeneralTextSize.getValue(n),H=null!=h?G.B.createFromPt(+h):void 0,f={general:{autoSizeColumnWidth:t.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:H,rowSubtotals:t.FX.PropGeneralMatrixRowSubtotals.getValue(n),columnSubtotals:t.FX.PropGeneralMatrixColumnSubtotals.getValue(n),layout:t.FX.PropGeneralMatrixLayout.getValue(n)}};f.grid={gridVertical:t.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:t.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:t.FX.PropGridHorizontalMatrix.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:t.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:t.FX.PropGridOutlineWeight.getValue(n),rowPadding:t.FX.PropGridRowPadding.getValue(n),imageHeight:t.FX.PropGridImageHeight.getValue(n)},f.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:t.FX.PropColumnsOutline.getValue(n)},f.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(n),backColor:this.tablixProperties.PropRowsBackColor.getValue(n),outline:t.FX.PropRowsOutline.getValue(n),wordWrap:t.FX.PropRowsWordWrap.getValue(n),repeatRowHeaders:t.FX.PropRowsRepeatRowHeaders.getValue(n)},f.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:t.FX.PropValuesOutline.getValue(n)},f.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(n),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(n),applyToHeaders:t.FX.PropGrandTotalApplyToHeaders.getValue(n)},f.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(n),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(n)},f.columnFormatting={},f.formatters={};var m=this.getMatrixValuesColumnMetadata(u);if(m)for(var b=0,T=m;b<T.length;b++){var R=T[b],k=R&&R.objects;f.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(k),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(k),styleHeader:t.FX.PropColumnFormattingStyleHeader.getValue(k),styleValues:t.FX.PropColumnFormattingStyleValues.getValue(k),styleTotal:t.FX.PropColumnFormattingStyleTotal.getValue(k),styleSubTotals:t.FX.PropColumnFormattingStyleSubtotals.getValue(k)},f.formatters[R.queryName]=new g.g({column:R,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(u.matrix.rows,f.formatters),this.addMatrixHierarchyColumnsFormatters(u.matrix.columns,f.formatters),f},p.prototype.addMatrixHierarchyColumnsFormatters=function(u,n,h){if(u){i.fF.assertValue(u.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var H=0,f=u.levels;H<f.length;H++){var m=f[H];i.fF.assertValue(m.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var b=0,T=m.sources;b<T.length;b++){var R=T[b];if(!R.isMeasure){var k=R.queryName;n[k]=new g.g({column:R,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!1}),h&&(h[k]=new g.g({column:R,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},p.prototype.addMatrixHierarchySubtotalLabels=function(u,n,h,H){if(u){i.fF.assertValue(u.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var f=0,m=u.levels;f<m.length;f++){var b=m[f];i.fF.assertValue(b.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var T=void 0,R=0,k=b.sources;R<k.length;R++){var E=k[R];E.isMeasure||(H&&(T=t.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(E.objects)),T||(T=h),n[E.queryName]={subtotalLabel:T})}}}},p.prototype.getPivotTableObjects=function(u,n,h,H,f,m){var b,T,R,k,E,ie,le,fe,he;void 0===m&&(m=!1);var Y=p.getMetadataObjects(u),de=this.getTablixTextClassProperties(H),ge=de.labelFontProperties.size&&de.labelFontProperties.size.pt,be=de.boldLabelFontProperties.size&&de.boldLabelFontProperties.size.pt,ye=t.FX.PropGridPivotTableTextSize.getValue(Y,void 0,de.fontSizeOverrideFn,ge),me=null!=ye?G.B.createFromPt(+ye):void 0,we=t.FX.PropColumnsFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,ge),Re=null!=we?G.B.createFromPt(+we):void 0,ae=t.FX.PropRowsFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,ge),a=null!=ae?G.B.createFromPt(+ae):void 0,F=t.FX.PropRowsExpandCollapseButtonsSize.getValue(Y),V=null!=F?G.B.createFromPt(+F):void 0,K=t.FX.PropRowsExpandCompositeHierarchy.getValue(Y),X=t.FX.PropValuesFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,ge),re=null!=X?G.B.createFromPt(+X):void 0,P=t.FX.PropGrandTotalFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be),A=(null!=P&&G.B.createFromPt(+P),t.FX.PropColumnGrandTotalFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be,void 0,["Column"])),j=null!=A?G.B.createFromPt(+A):void 0,oe=t.FX.PropRowGrandTotalFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be,void 0,["Row"]),ce=null!=oe?G.B.createFromPt(+oe):void 0,ve=t.FX.PropSubTotalsFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be),Fe=(null!=ve&&G.B.createFromPt(+ve),t.FX.PropSubTotalsFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be,"Row")),Ce=null!=Fe?G.B.createFromPt(+Fe):void 0,He=t.FX.PropSubTotalsFontSize.getValue(Y,void 0,de.fontSizeOverrideFn,be,"Column"),Le=null!=He?G.B.createFromPt(+He):void 0,We=n(S.qT),Ne=t.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(Y)||We,xe=t.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(Y)||We,Me=t.FX.PropRowsSteppedLayout.getValue(Y),Ie=t.FX.PropGeneralMatrixLayout.getValue(Y)||(Me?v.t.Compact:v.t.Outline);f.matrixLayouts&&(Me=Ie===v.t.Compact);var Oe={showBlankRows:t.FX.PropBlankRowsShowBlankRows.getValue(Y),blankRowColor:null!==(b=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(Y))&&void 0!==b?b:this.tablixProperties.PropValuesBackColorPrimary.getValue(Y),blankRowTransparency:t.FX.PropBlankRowsTransparency.getValue(Y),showBorder:t.FX.PropBlankRowsShowBorder.getValue(Y),borderPosition:null!==(T=t.FX.PropBlankRowsBorderPosition.getValue(Y))&&void 0!==T?T:"Top",borderColor:null!==(R=this.tablixProperties.PropBlankRowsBorderColor.getValue(Y))&&void 0!==R?R:H.colorPalette.foregroundNeutralSecondary.value,borderTransparency:t.FX.PropBlankRowsBorderTransparency.getValue(Y),borderWidth:t.FX.PropBlankRowsBorderWidth.getValue(Y)},Be={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.boldLabelFontProperties.color,"Row"),fontFamily:t.FX.PropSubTotalsFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.boldLabelFontProperties.family,"Row"),fontSize:Ce,bold:t.FX.PropSubTotalsBold.getValue(Y,void 0,void 0,void 0,"Row"),italic:t.FX.PropSubTotalsItalic.getValue(Y,void 0,void 0,void 0,"Row"),underline:t.FX.PropSubTotalsUnderline.getValue(Y,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(Y,void 0,void 0,void 0,"Row"),applyToHeaders:t.FX.PropSubTotalsApplyToHeaders.getValue(Y,void 0,void 0,void 0,"Row")},ze={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.boldLabelFontProperties.color,"Column"),fontFamily:t.FX.PropSubTotalsFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.boldLabelFontProperties.family,"Column"),fontSize:Le,bold:t.FX.PropSubTotalsBold.getValue(Y,void 0,void 0,void 0,"Column"),italic:t.FX.PropSubTotalsItalic.getValue(Y,void 0,void 0,void 0,"Column"),underline:t.FX.PropSubTotalsUnderline.getValue(Y,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(Y,void 0,void 0,void 0,"Column"),applyToHeaders:t.FX.PropSubTotalsApplyToHeaders.getValue(Y,void 0,void 0,void 0,"Column")},De={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:t.FX.PropColumnGrandTotalFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.boldLabelFontProperties.family,void 0,["Column"]),fontSize:j,bold:t.FX.PropColumnGrandTotalBold.getValue(Y),italic:t.FX.PropColumnGrandTotalItalic.getValue(Y),underline:t.FX.PropColumnGrandTotalUnderline.getValue(Y),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(Y),applyToHeaders:t.FX.PropColumnGrandTotalApplyToHeaders.getValue(Y)},Ae={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:t.FX.PropRowGrandTotalFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.boldLabelFontProperties.family,void 0,["Row"]),fontSize:ce,bold:t.FX.PropRowGrandTotalBold.getValue(Y),italic:t.FX.PropRowGrandTotalItalic.getValue(Y),underline:t.FX.PropRowGrandTotalUnderline.getValue(Y),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(Y),applyToHeaders:t.FX.PropRowGrandTotalApplyToHeaders.getValue(Y)},Te={general:{autoSizeColumnWidth:t.FX.PropColumnPivotTableAutoSizeColumns.getValue(Y),textSize:me,rowSubtotals:t.FX.PropSubTotalsPivotTableRowSubtotals.getValue(Y),columnSubtotals:t.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(Y),layout:Ie},grid:{gridVertical:t.FX.PropGridVertical.getValue(Y),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(Y),gridVerticalWeight:t.FX.PropGridVerticalWeight.getValue(Y),gridHorizontal:t.FX.PropGridHorizontalMatrix.getValue(Y),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(Y),gridHorizontalWeight:t.FX.PropGridHorizontalWeight.getValue(Y),outline:t.FX.PropGridOutlineStyle.getValue(Y)||t.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(Y),outlineWeight:t.FX.PropGridOutlineWeight.getValue(Y),rowPadding:t.FX.PropGridRowPadding.getValue(Y),imageHeight:t.FX.PropGridImageHeight.getValue(Y),imageWidth:t.FX.PropGridImageWidth.getValue(Y)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.labelFontProperties.color),fontFamily:t.FX.PropColumnsFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.labelFontProperties.family),fontSize:Re,bold:t.FX.PropColumnsBold.getValue(Y),italic:t.FX.PropColumnsItalic.getValue(Y),underline:t.FX.PropColumnsUnderline.getValue(Y),backColor:this.tablixProperties.PropColumnsBackColor.getValue(Y),outline:this.ensureOutline(t.FX.PropColumnsOutlineStyle.getValue(Y),Y,t.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(t.FX.PropColumnsOutlineWeight.getValue(Y),Y),urlIcon:t.FX.PropColumnsUrlIcon.getValue(Y),wordWrap:t.FX.PropColumnsWordWrap.getValue(Y),alignment:t.FX.PropColumnsAlignment.getValue(Y),titleAlignment:t.FX.PropColumnsAlignmentTitle.getValue(Y)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(Y,void 0,de.fontColorOverrideFn,de.labelFontProperties.color),fontFamily:t.FX.PropRowsFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.labelFontProperties.family),fontSize:a,bold:t.FX.PropRowsBold.getValue(Y),italic:t.FX.PropRowsItalic.getValue(Y),underline:t.FX.PropRowsUnderline.getValue(Y),backColor:this.tablixProperties.PropRowsBackColor.getValue(Y),outline:this.ensureOutline(t.FX.PropRowsOutlineStyle.getValue(Y),Y,t.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(t.FX.PropRowsOutlineWeight.getValue(Y),Y),steppedLayout:Me,steppedLayoutIndentation:t.FX.PropRowsSteppedLayoutIndentation.getValue(Y),urlIcon:t.FX.PropRowsUrlIcon.getValue(Y),wordWrap:t.FX.PropRowsWordWrap.getValue(Y),alignment:t.FX.PropRowsAlignment.getValue(Y),showExpandCollapseButtons:!!h&&t.FX.PropRowsShowExpandCollapseButtons.getValue(Y),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(Y),expandCollapseButtonsSize:V,expandCompositeHierarchy:K,repeatRowHeaders:t.FX.PropRowsRepeatRowHeaders.getValue(Y),legacyStyleDisabled:t.FX.PropRowsLegacyStyleDisabled.getValue(Y)},values:{fontFamily:t.FX.PropValuesFontFamily.getValue(Y,void 0,de.fontFamilyOverrideFn,de.labelFontProperties.family),fontSize:re,bold:t.FX.PropValuesBold.getValue(Y),italic:t.FX.PropValuesItalic.getValue(Y),underline:t.FX.PropValuesUnderline.getValue(Y),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(Y,void 0,de.fontColorOverrideFn,de.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(Y),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(Y),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(Y),bandedRowHeaders:t.FX.PropValuesBandedRowHeaders.getValue(Y),outline:this.ensureOutline(t.FX.PropValuesOutlineStyle.getValue(Y),Y,t.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(t.FX.PropValuesOutlineWeight.getValue(Y),Y),urlIcon:t.FX.PropValuesUrlIcon.getValue(Y),wordWrap:t.FX.PropValuesWordWrap.getValue(Y),valuesOnRow:t.FX.PropValuesOnRow.getValue(Y)},columnGrandTotal:De,rowGrandTotal:Ae,subtotals:{rowSubtotalsPosition:Ie===v.t.Tabular?y.I:t.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(Y),rowSubtotalsLabel:Ne,columnSubtotalsLabel:xe},rowSubtotals:Be,columnSubtotals:ze,blankRows:Oe,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ge=this.getMatrixValuesColumnMetadata(u);if(Ge)for(var Xe=0,ke=Ge;Xe<ke.length;Xe++){var Ee=ke[Xe],Ve=Ee&&Ee.objects;Te.columnFormatting[Ee.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(Ve),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(Ve),alignment:t.FX.PropColumnFormattingAlignment.getValue(Ve),styleHeader:t.FX.PropColumnFormattingStyleHeader.getValue(Ve),styleValues:t.FX.PropColumnFormattingStyleValues.getValue(Ve),styleTotal:t.FX.PropColumnFormattingStyleTotal.getValue(Ve),styleSubTotals:t.FX.PropColumnFormattingStyleSubtotals.getValue(Ve),dataBarsSettings:t.FX.PropColumnFormattingDataBars.getValue(Ve),icon:t.FX.PropValuesIcon.getValue(Ve)};var Ue=void 0,Ke=void 0;if(Ee.type.numeric&&(Ue=t.FX.PropColumnFormattingDisplayUnits.getValue(Ve),Ke=t.FX.PropColumnFormattingPrecision.getValue(Ve)),Te.formatters[Ee.queryName]=new g.g({column:Ee,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Ue,precision:Ke,trailingZeroes:!0}),Te.tooltipFormatters[Ee.queryName]=new g.g({column:Ee,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Ue,precision:Ke,trailingZeroes:!0}),null!==(k=Ee.type.misc)&&void 0!==k&&k.sparkline){var Je=t.FX.PropSparklinesChartType.getValue(Ve),Qe=new s(Ee.displayName,Ee.type,n);Te.formatters[Ee.queryName]=Qe,Te.tooltipFormatters[Ee.queryName]=Qe,Te.sparklines[Ee.queryName]={chartType:Je,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(Ve).solid.color,strokeWidth:t.FX.PropSparklinesStrokeWidth.getValue(Ve),marker:{show:!0,typeFlags:t.FX.PropSparklinesMarkerType.getValue(Ve),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(Ve).solid.color,size:t.FX.PropSparklinesMarkerSize.getValue(Ve),shape:t.FX.PropSparklinesMarkerShape.getValue(Ve)}}}}m&&(Te.annotationFormatting={columnHeaders:{}},_.forEach(null===(E=u.metadata)||void 0===E?void 0:E.columns,function(je){var Ze;if(null!==(Ze=je.objects)&&void 0!==Ze&&Ze.annotations){var Ye=(0,O.NA)(je.objects,pe.t.annotations.highlights);Ye&&(null!=Ye.backColor||!0===Ye.emphasizeText)&&(Te.annotationFormatting.columnHeaders[je.queryName]={backColor:Ye.backColor,bold:Ye.emphasizeText})}}),_.isEmpty(Te.annotationFormatting.columnHeaders)&&(Te.annotationFormatting=void 0));var $e=t.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(Y),qe=t.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(Y);return this.addMatrixHierarchySubtotalLabels(null===(ie=u?.matrix)||void 0===ie?void 0:ie.rows,Te.columnFormatting,Ne,$e),this.addMatrixHierarchySubtotalLabels(null===(le=u?.matrix)||void 0===le?void 0:le.columns,Te.columnFormatting,xe,qe),this.addMatrixHierarchyColumnsFormatters(null===(fe=u?.matrix)||void 0===fe?void 0:fe.rows,Te.formatters,Te.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(he=u?.matrix)||void 0===he?void 0:he.columns,Te.formatters,Te.tooltipFormatters),Te},p.prototype.getTableExObjects=function(u,n,h,H){var f,m=p.getMetadataObjects(u),b=this.getTablixTextClassProperties(h),T=b.labelFontProperties.size&&b.labelFontProperties.size.pt,R=b.boldLabelFontProperties.size&&b.boldLabelFontProperties.size.pt,k=t.FX.PropGridPivotTableTextSize.getValue(m),E=null!=k?G.B.createFromPt(+k):void 0,ie=t.FX.PropColumnsFontSize.getValue(m,void 0,b.fontSizeOverrideFn,T),le=null!=ie?G.B.createFromPt(+ie):void 0,fe=t.FX.PropValuesFontSize.getValue(m,void 0,b.fontSizeOverrideFn,T),he=null!=fe?G.B.createFromPt(+fe):void 0,Y=t.FX.PropTotalFontSize.getValue(m,void 0,b.fontSizeOverrideFn,R),de=null!=Y?G.B.createFromPt(+Y):void 0,ge=t.FX.ProprowWithReferenceText.getValue(m),be={general:{autoSizeColumnWidth:t.FX.PropColumnPivotTableAutoSizeColumns.getValue(m),textSize:E,totals:t.FX.PropTotalTableExTotals.getValue(m)}};be.grid={gridVertical:t.FX.PropGridVertical.getValue(m),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(m),gridVerticalWeight:t.FX.PropGridVerticalWeight.getValue(m),gridHorizontal:t.FX.PropGridHorizontalTable.getValue(m),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(m),gridHorizontalWeight:t.FX.PropGridHorizontalWeight.getValue(m),outline:t.FX.PropGridOutlineStyle.getValue(m)||t.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(m),outlineWeight:t.FX.PropGridOutlineWeight.getValue(m),rowPadding:t.FX.PropGridRowPadding.getValue(m),imageHeight:t.FX.PropGridImageHeight.getValue(m),imageWidth:t.FX.PropGridImageWidth.getValue(m)},be.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(m,void 0,b.fontColorOverrideFn,b.labelFontProperties.color),fontFamily:t.FX.PropColumnsFontFamily.getValue(m,void 0,b.fontFamilyOverrideFn,b.labelFontProperties.family),fontSize:le,bold:t.FX.PropColumnsBold.getValue(m),italic:t.FX.PropColumnsItalic.getValue(m),underline:t.FX.PropColumnsUnderline.getValue(m),backColor:this.tablixProperties.PropColumnsBackColor.getValue(m),outline:this.ensureOutline(t.FX.PropColumnsOutlineStyle.getValue(m),m,t.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(m),m),outlineWeight:this.ensureOutlineWeight(t.FX.PropColumnsOutlineWeight.getValue(m),m),wordWrap:t.FX.PropColumnsWordWrap.getValue(m),alignment:t.FX.PropColumnsAlignment.getValue(m)},be.values={fontFamily:t.FX.PropValuesFontFamily.getValue(m,void 0,b.fontFamilyOverrideFn,b.labelFontProperties.family),fontSize:he,bold:t.FX.PropValuesBold.getValue(m),italic:t.FX.PropValuesItalic.getValue(m),underline:t.FX.PropValuesUnderline.getValue(m),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(m,void 0,b.fontColorOverrideFn,b.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(m),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(m),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(m),outline:this.ensureOutline(t.FX.PropValuesOutlineStyle.getValue(m),m,t.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(m),m),outlineWeight:this.ensureOutlineWeight(t.FX.PropValuesOutlineWeight.getValue(m),m),urlIcon:t.FX.PropValuesUrlIcon.getValue(m),wordWrap:t.FX.PropValuesWordWrap.getValue(m)};var ye=t.FX.PropTotalTableExTotalLabel.getValue(m);be.total={totalLabel:ye||n(S.qT),totalPlaceholderLabel:n(S.bn),isDefaultTotalLabel:!ye,fontFamily:t.FX.PropTotalFontFamily.getValue(m,void 0,b.fontFamilyOverrideFn,b.boldLabelFontProperties.family),fontSize:de,bold:t.FX.PropTotalBold.getValue(m),italic:t.FX.PropTotalItalic.getValue(m),underline:t.FX.PropTotalUnderline.getValue(m),fontColor:this.tablixProperties.PropTotalFontColor.getValue(m,void 0,b.fontColorOverrideFn,b.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(m),outline:this.ensureOutline(t.FX.PropTotalOutlineStyle.getValue(m),m,t.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(m),m),outlineWeight:this.ensureOutlineWeight(t.FX.PropTotalOutlineWeight.getValue(m),m)},be.columnFormatting={},be.formatters={},be.tooltipFormatters={},be.sparklines={};var me=this.getTableColumnMetadata(u);if(me)for(var we=0,Re=me;we<Re.length;we++){var ae=Re[we];if(ae){var a=ae.objects,F=ae.queryName;be.columnFormatting[F]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(a),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(a),alignment:t.FX.PropColumnFormattingAlignment.getValue(a),styleHeader:t.FX.PropColumnFormattingStyleHeader.getValue(a),styleValues:t.FX.PropColumnFormattingStyleValues.getValue(a),styleTotal:t.FX.PropColumnFormattingStyleTotal.getValue(a),dataBarsSettings:t.FX.PropColumnFormattingDataBars.getValue(a),icon:t.FX.PropValuesIcon.getValue(a)};var V=void 0,K=void 0;if(ae.type.numeric&&(V=t.FX.PropColumnFormattingDisplayUnits.getValue(a),K=t.FX.PropColumnFormattingPrecision.getValue(a)),be.formatters[F]=new g.g({column:ae,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:V,precision:K,trailingZeroes:!0}),be.tooltipFormatters[F]=new g.g({column:ae,formatStringPropId:t.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:V,precision:K,trailingZeroes:!0}),null!==(f=ae.type.misc)&&void 0!==f&&f.sparkline){var X=t.FX.PropSparklinesChartType.getValue(a),re=new s(ae.displayName,ae.type,n);be.formatters[F]=re,be.tooltipFormatters[F]=re,be.sparklines[F]={chartType:X,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(a).solid.color,strokeWidth:t.FX.PropSparklinesStrokeWidth.getValue(a),marker:{show:!0,typeFlags:t.FX.PropSparklinesMarkerType.getValue(a),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(a).solid.color,size:t.FX.PropSparklinesMarkerSize.getValue(a),shape:t.FX.PropSparklinesMarkerShape.getValue(a)}}}}}return be.rowWithReferenceText={rowWithReferenceText:ge},be},p.prototype.ensureOutline=function(u,n,h){var H;return null!==(H=u??t.FX.PropGridOutlineStyle.getValue(n))&&void 0!==H?H:h},p.prototype.ensureOutlineWeight=function(u,n){return u??t.FX.PropGridOutlineWeight.getValue(n)},p.prototype.outlineOverrideFn=function(u,n){return!!(0,O.NA)(u,n)},p.prototype.ensureOutlineColor=function(u,n){return u??this.tablixProperties.PropGridOutlineColor.getValue(n)},p.getTextSizeInPx=function(u){return w.FP.toString(u.px)},p.prototype.shouldShowTableTotalsOption=function(u){return!(u&&u.table&&!_.isEmpty(u.table.columns)&&_.some(u.table.columns,function(h){return h.discourageAggregationAcrossGroups}))},p.prototype.shouldShowRowSubtotalsOption=function(u){return!(!u||(0,ne.be)(u.matrix)<1||this.isDiscourageAggregationAcrossGroups(u.matrix.rows.levels))},p.prototype.shouldShowColumnSubtotalsOption=function(u){if(!u||!u.matrix||(0,ne.pr)(u.matrix.columns)<1)return!1;var n=u.matrix.columns.levels;return u.matrix.valueSources.length>1&&(n=_.initial(n)),!this.isDiscourageAggregationAcrossGroups(n)},p.prototype.isDiscourageAggregationAcrossGroups=function(u){var n=_.last(u);return n&&_.some(n.sources,function(h){return h.discourageAggregationAcrossGroups})},p.prototype.getTablixTextClassProperties=function(u){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,Z.m)(u,"label"),boldLabelFontProperties:(0,Z.m)(u,"boldLabel")}},p.prototype.fontSizeOverridePredicate=function(){var u=this;return function(n,h,H){var f=(0,O.RK)(n,h.objectName),m=(0,O.RK)(n,t.FX.ObjectGrid),b=(0,O.RK)(n,t.FX.ObjectValues),T=(0,O.RK)(n,t.FX.ObjectSubTotals),R=u.gridDependentObject(h.objectName),k=(0,D.N)(m,"textSize",void 0)&&!(0,D.N)(f,h.propertyName,void 0,H),E=u.valuesDependentObject(h.objectName),ie=(0,D.N)(b,"fontSize",void 0)&&!(0,D.N)(f,h.propertyName,void 0,H),le=u.subTotalsDependentObject(h.objectName),fe=u.getSubTotalsValue(h.objectName,T,"fontSize",void 0)&&!(0,D.N)(f,h.propertyName,void 0,H),Y=!!(0,D.N)(f,h.objectName===t.FX.ObjectGrid?"textSize":"fontSize",void 0,H);return R&&k||E&&ie||le&&fe||Y}},p.prototype.fontFamilyOverridePredicate=function(){var u=this;return function(n,h,H){var f=(0,O.RK)(n,h.objectName),m=(0,O.RK)(n,t.FX.ObjectValues),b=(0,O.RK)(n,t.FX.ObjectSubTotals),T=u.valuesDependentObject(h.objectName),R=(0,D.N)(m,"fontFamily",void 0)&&!(0,D.N)(f,h.propertyName,void 0),k=u.subTotalsDependentObject(h.objectName),E=u.getSubTotalsValue(h.objectName,b,"fontFamily",void 0)&&!(0,D.N)(f,h.propertyName,void 0,H),ie=!!(0,D.N)(f,"fontFamily",void 0,H);return T&&R||k&&E||ie}},p.prototype.fontColorOverridePredicate=function(){return function(u,n,h){var H=(0,O.RK)(u,n.objectName),f=n.objectName===t.FX.ObjectValues?"fontColorPrimary":"fontColor",m=(0,D.N)(H,f);return!!(0,D.N)(H,f,m,h)}},p.prototype.gridDependentObject=function(u){return this.valuesDependentObject(u)||u===t.FX.ObjectRowHeaders||u===t.FX.ObjectColumnHeaders||u===t.FX.ObjectValues},p.prototype.valuesDependentObject=function(u){return this.subTotalsDependentObject(u)||u===t.FX.ObjectSubTotals},p.prototype.subTotalsDependentObject=function(u){return u===t.FX.ObjectTotal||u===t.FX.ObjectRowTotal||u===t.FX.ObjectColumnTotal},p.prototype.getSubTotalsValue=function(u,n,h,H){var f=u===t.FX.ObjectRowTotal?"Row":u===t.FX.ObjectColumnTotal?"Column":void 0;return H=H??(0,D.N)(n,h),(0,D.N)(n,h,H,f)},p.ImageSizeMin=8,p.ImageSizeMax=512,p}(),s=function(){function p(u,n,h){this.displayName=u,this.sparklineType=n,this.localizer=h}return p.prototype.format=function(u,n){var h=function(p,u,n){if(n){var h=n.points;if(h=_.filter(h,function(le){return null!=le.x&&null!=le.y}),!_.isEmpty(h)){var H=_.size(h);if(1===H)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[p,n.lowY]};var f=u.misc.sparkline.groupingType;if(f&&(f.numeric||f.dateTime||f.temporal)){var b=h[0].y,T=h[H-1].y;if(!_.some(h,function(le){return le.y!==b}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[p,b]};if((0,ee.JM)(_.map(h,function(le){return le.x}),_.map(h,function(le){return le.y}),!0).rSquared>.5){var ie,E="Sparkline_Tooltip_ScalarTrend";return E+=T>b?"Up":"Down",0!==b?(ie=100*(T-b)/b,E+="Percent"):(ie=T-b,E+="Value"),{key:E,parameters:[p,+Math.abs(ie).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[p,n.lowY,n.highY]}}return n.lowY===n.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[p,n.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[p,n.lowY,n.highY]}}}}(this.displayName,this.sparklineType,u);if(h)return this.localizer.apply(this,(0,z.__spreadArray)([h.key],h.parameters,!1))},p}()},91468:function(_e,Se,U){U.d(Se,{CQ:function(){return d},D2:function(){return y},JT:function(){return B},K2:function(){return D},Km:function(){return l},Kq:function(){return m},MO:function(){return te},Nk:function(){return H},Od:function(){return n},Ps:function(){return I},RD:function(){return e},RP:function(){return c},TQ:function(){return h},VM:function(){return o},X1:function(){return ee},aY:function(){return f},do:function(){return g},jv:function(){return p},kJ:function(){return v},n2:function(){return O},qk:function(){return ne},rP:function(){return u},s$:function(){return N},tO:function(){return r},wV:function(){return w},x9:function(){return S}});var z=U(18664),pe=U(91358),se=U(32105),ue=U(19650),J=U(62458),L=U(32041),W=U(48066),Z=U(38078),G=U(66001),q=U(7911),t=U(93340),C=U(71090),i="0.3",o="cell-interactive",w="pivotTableCellNoWrap",O="pivotTableCellWrap",D=5,N=5,te=5;function ne(b){return b.insertAdjacentHTML("beforeend",q.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),b.lastChild}function ee(b,T){return _.isEmpty(b)?0:L.b.measureSvgTextWidth(T,b)}function B(b,T){if(_.isEmpty(b))return 0;var R=0;return b.split("\n").forEach(function(k){var E=ee(k,T);E>R&&(R=E)}),R}function g(b,T,R){return _.isEmpty(b)?[b]:(b=b.trim(),(0,G.ql)(b,R,L.b.measureSvgTextWidth,T,C.uZ,void 0,!0,!0))}function S(b,T){return Math.max(0,b-(T.getExtraLeft()+T.getExtraRight()))}function d(b){b.opacity=i}function v(b,T){return J.fF.assertValue(b,"kpi"),J.fF.assertValue(T,"kpiValue"),q.bG.build({content:"",classNames:[(0,pe.sq)(b,T)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function y(b,T,R,k){var E={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:b,referrerpolicy:"no-referrer"},contextMenuHandler:function(le){le.stopPropagation()}};return null!=k&&(E.attributes.alt=k),{children:[E],classNames:[C.Ed],styleProperties:{height:T+"px",width:R+"px"},attributes:null}}function I(b,T,R,k){J.fF.assertValue(b,"undefined iconSettings");var E={attributes:{},styleProperties:{},classNames:["flex-container"]},ie=function(b,T,R){J.fF.assertValue(b,"undefined icon");var k=T+"px";return null===b.value?{tagName:"div",styleProperties:{height:k,width:k},attributes:{},classNames:null}:(J.fF.assertValue(b.value,"Undefined icon value"),b.value.svgId?{tagName:"svg",attributes:{height:k,width:k,role:"img","aria-label":R.getLocalizedString(b.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+b.value.svgId},classNames:null,styleProperties:{}}]}:null!=b.value.url?{tagName:"img",classNames:null,styleProperties:{height:k,width:k},attributes:{src:(0,Z.HZ)(b.value.url),referrerpolicy:"no-referrer"}}:void J.fF.assertFail("Unrecognized icon value"))}(b,T,k);switch(R.classNames.push("stretching-content"),b.layout){case"IconOnly":R.children=[ie],Q(b,R),E.children=[R];break;case"After":Q(b,ie),E.children=[R,ie];break;default:Q(b,ie),E.children=[ie,R]}return E}function Q(b,T){T.classNames||(T.classNames=[]);var R=T.classNames;switch(R.push("tablixIcon"),b.layout){case"IconOnly":break;case"Before":R.push("before");break;default:R.push("after")}switch(b.verticalAlignment){case"Bottom":R.push("bottom");break;case"Middle":R.push("middle");break;default:R.push("top")}}function c(b,T){return b?(0,t.RP)(T):null}function e(b,T,R,k,E,ie){var le={tagName:"a",classNames:[],styleProperties:{},attributes:{href:T,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(he){he.stopPropagation(),k(T,he)},contextMenuHandler:function(he){he.stopPropagation()}};return"string"==typeof b?le.content=b:le.children=[b],R&&(le.content=void 0,le.children=void 0,le.classNames.push(C.NA,R),le.attributes["aria-label"]=T),E&&(le.styleProperties.color="inherit"),ie&&(le.attributes.title=T),le}function r(b){return b-1}function l(b,T,R,k,E,ie,le){var fe,he={};return T&&(fe=b?["powervisuals-glyph","sort-icon",s(b)]:R?["powervisuals-glyph","sort-icon",s(k),"future"]:["sort-icon"]),!b&&R?he["aria-label"]=le.getLocalizedString("Field_Sorting_Possible"):he["aria-hidden"]="true",{content:C.jv,attributes:he,styleProperties:{"font-size":ie,bottom:E+"px"},classNames:fe}}function s(b){switch(b){case 1:return"caret-up";case 2:return"caret-down"}}function p(b,T){return(0,t.MN)(b,T)!==W.av.NONE}function u(b){return b&&b.replace(/&#10;/g,"<BR />")}function n(b,T){b.size&&8.52===b.size.px&&(b=(0,z.ED)(b,{size:se.B.createFromPx(8)}));var R={measuredFontHeight:null,textProperties:(0,z.qk)(b),fontProperties:b};return T.addItem(R),R}function h(b,T,R){return n((0,z.ED)(b.fontProperties,T),R)}function H(b,T,R){var k=b.fontProperties;k.family&&(T.fontFamily=k.family),k.size&&(T.fontSize=k.size),k.weight&&(T.fontWeight=k.weight),k.style&&(T.fontStyle=k.style),k.textDecoration&&R&&(T.textDecoration=k.textDecoration)}function f(b,T,R){if(J.fF.assertValue(T,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==b||b===ue.H.auto){if(!R)return;b=R}switch(b){case ue.H.left:return void T.push(C.z7);case ue.H.center:return void T.push(C.QM);case ue.H.right:return void T.push(C.OM);default:return}}var m=function(){function b(){this.items=[]}return b.prototype.addItem=function(T){this.items.push(T)},b.prototype.measureAll=function(T){if(!_.isEmpty(this.items)){for(var R=[],k=0,E=this.items;k<E.length;k++){var le={content:"a",classNames:null,styleProperties:(0,z.wB)(E[k].fontProperties),attributes:null};R.push(q.bG.build(le,null))}var fe=R.join("");T.insertAdjacentHTML("beforeend",fe);for(var Y,he=!0,de=0,ge=this.items;de<ge.length;de++)he?(he=!1,Y=T.firstChild):Y=Y.nextSibling,ge[de].measuredFontHeight=Math.ceil(Y.offsetHeight);T.innerHTML=""}},b}()},59151:function(_e,Se,U){U.d(Se,{P:function(){return pe}});var z=U(55007);function pe(se,ue,J){for(var L={remove:[],merge:[]},W=0,Z=se;W<Z.length;W++){var G=Z[W],q={selector:G.selector,objectName:z.FX.PropColumnWidthValue.objectName,properties:{}};q.properties[z.FX.PropColumnWidthValue.propertyName]=G.value,null==G.value?L.remove.push(q):L.merge.push(q)}ue.persistProperties(L,J)}},93568:function(_e,Se,U){U.d(Se,{$H:function(){return S},B0:function(){return w},aV:function(){return O},cP:function(){return D},qW:function(){return g}});var z=U(1521),pe=U(79154),se=U(54522),ue=U(55007),J=U(40550),L=U(62458),W=U(32041),Z=U(64329),G=U(48066),q=U(66001),t=U(93340),C=U(71090),i=U(13375),o=U(64067);function w(d,v,y,I,M,Q,c,e){var r,l,s,p,u;void 0===Q&&(Q=!1),void 0===c&&(c=!1);var n=M.grid,h=M.rowHeaders,H=M.values,f=M.columnHeaders,m=null!==(r=M.grandTotal)&&void 0!==r?r:M.rowGrandTotal,b=M.subtotals||{},T=M.rowSubtotals||{},R=null!==(l=h.outlineWeight)&&void 0!==l?l:n.outlineWeight,k=null!==(s=h.outlineColor)&&void 0!==s?s:n.outlineColor;y.paddings.top=y.paddings.bottom=n.rowPadding;var E=i.hc.isNodeGrandTotal(v);y.borders.top=new t.om,(d.row.isFirst&&!I||I&&0===v.leafIndex)&&(y.borders.top.applyParams((0,J.yo)(h.outline),R,k,t.Pb.Outline),!(0,J.yo)(h.outline)&&(0,J.yo)(H.outline)&&(y.paddings.top+=R)),y.borders.bottom=new t.om,d.row.isLast&&(!I||I&&d.column.isLast&&!M.general.rowSubtotals)||I&&d.row.isFirst&&v.isSubtotal?(y.borders.bottom.applyParams((0,J.mv)(h.outline),R,k,t.Pb.Outline),!(0,J.mv)(h.outline)&&(0,J.mv)(H.outline)&&(y.paddings.bottom+=R)):y.borders.bottom.applyParams(n.gridHorizontal,n.gridHorizontalWeight,n.gridHorizontalColor,t.Pb.Gridline),y.borders.left=new t.om,(I||d.column.isFirst)&&(y.borders.left.applyParams((0,J.fs)(h.outline),R,k,t.Pb.Outline),!(0,J.fs)(h.outline)&&(0,J.fs)(f.outline)&&(y.paddings.left+=R)),y.borders.right=new t.om;var ie=I||d.column.isLast;if(ie?y.borders.right.applyParams((0,J.BK)(h.outline),R,k,t.Pb.Outline):y.borders.right.applyParams(n.gridVertical,n.gridVerticalWeight,n.gridVerticalColor,t.Pb.Gridline),v.isBlankRow&&te(y,M),m.applyToHeaders&&E)y.fontColor=m.fontColor||h.fontColor,y.backColor=m.backColor||h.backColor;else{var fe=Q&&(H.fontColorPrimary!==H.fontColorSecondary||H.backColorPrimary!==H.backColorSecondary)&&(c||ie),he=null!==(p=T.fontColor)&&void 0!==p?p:b.fontColor,ge=fe&&!(v.hasSubtotalStyle&&he)&&!(E&&m.fontColor),be=null!==(u=T.backColor)&&void 0!==u?u:b.backColor,we=fe&&!(v.hasSubtotalStyle&&be)&&!(E&&m.backColor),Re=void 0;(ge||we)&&(Re=e??ne(v.position,M.general,be)),y.fontColor=ge?ee(Re,H):h.fontColor,y.backColor=v.isBlankRow?N(v.isBlankRow,M):we?B(Re,H):h.backColor}}function O(d,v,y,I){var M,Q,c,e,r,l=I.grid,s=I.columnHeaders,p=I.values,u=null!==(M=I.grandTotal)&&void 0!==M?M:I.columnGrandTotal,n=null!==(Q=s.outlineWeight)&&void 0!==Q?Q:l.outlineWeight,h=null!==(c=s.outlineColor)&&void 0!==c?c:l.outlineColor,H=I.columnFormatting[v.queryName],f=null===(r=null===(e=I.annotationFormatting)||void 0===e?void 0:e.columnHeaders)||void 0===r?void 0:r[v.queryName],m=i.hc.isNodeGrandTotal(v);y.fontColor=H&&H.styleHeader&&H.fontColor?H.fontColor:u.applyToHeaders&&m&&u.fontColor||s.fontColor,y.backColor=f&&f.backColor?f.backColor:H&&H.styleHeader&&H.backColor?H.backColor:u.applyToHeaders&&m&&u.backColor||s.backColor,f&&f.bold&&(y.fontWeight=pe.en),y.paddings.top=y.paddings.bottom=l.rowPadding,y.borders.top=new t.om,d.row.isFirst&&y.borders.top.applyParams((0,J.yo)(s.outline),n,h,t.Pb.Outline),y.borders.bottom=new t.om,d.row.isLast?y.borders.bottom.applyParams((0,J.mv)(s.outline),n,h,t.Pb.Outline):y.borders.bottom.applyParams(l.gridHorizontal,l.gridHorizontalWeight,l.gridHorizontalColor,t.Pb.Gridline),y.borders.left=new t.om,d.column.isFirst&&!(0,J.fs)(s.outline)&&(0,J.fs)(p.outline)&&(y.paddings.left+=n),y.borders.right=new t.om,d.column.isLast?(y.borders.right.applyParams((0,J.BK)(s.outline),n,h,t.Pb.Outline),!(0,J.BK)(s.outline)&&(0,J.BK)(p.outline)&&(y.paddings.right+=n)):y.borders.right.applyParams(l.gridVertical,l.gridVerticalWeight,l.gridVerticalColor,t.Pb.Gridline)}function D(d,v,y,I,M,Q){var c,e,r,l,s,p,u,n,h,H=M.grid,f=M.values,m=M.rowHeaders,b=M.columnHeaders,T=M.rowSubtotals||{},R=M.columnSubtotals||{},k=M.subtotals||{},E=null!==(c=f.outlineWeight)&&void 0!==c?c:H.outlineWeight,ie=null!==(e=f.outlineColor)&&void 0!==e?e:H.outlineColor;y.paddings.top=y.paddings.bottom=H.rowPadding,y.borders.top=new t.om,d.row.isFirst&&(y.borders.top.applyParams((0,J.yo)(f.outline),E,ie,t.Pb.Outline),!(0,J.yo)(f.outline)&&(0,J.yo)(m.outline)&&(y.paddings.top+=E)),y.borders.bottom=new t.om,d.row.isLast&&(!I||I&&!M.general.rowSubtotals)||I&&v.isRowGrandTotal?(y.borders.bottom.applyParams((0,J.mv)(f.outline),E,ie,t.Pb.Outline),!(0,J.mv)(f.outline)&&(0,J.mv)(m.outline)&&(y.paddings.bottom+=E)):y.borders.bottom.applyParams(H.gridHorizontal,H.gridHorizontalWeight,H.gridHorizontalColor),y.borders.left=new t.om,d.column.isFirst&&y.borders.left.applyParams((0,J.fs)(f.outline),E,ie,t.Pb.Outline),y.borders.right=new t.om,d.column.isLast?(y.borders.right.applyParams((0,J.BK)(f.outline),E,ie,t.Pb.Outline),!(0,J.BK)(f.outline)&&(0,J.BK)(b.outline)&&(y.paddings.right+=E)):y.borders.right.applyParams(H.gridVertical,H.gridVerticalWeight,H.gridVerticalColor,t.Pb.Gridline),null!==(r=v.rowItem)&&void 0!==r&&r.isBlankRow&&te(y,M);var fe,he,Y,de,le=v.columnMetadata&&M.columnFormatting[v.columnMetadata.queryName];le&&(v.isGrandTotal?(he=le.styleTotal&&le.fontColor,fe=le.styleTotal&&le.backColor):v.hasSubtotalStyle?(he=le.styleSubTotals&&le.fontColor,fe=le.styleSubTotals&&le.backColor):(he=le.styleValues&&le.fontColor,fe=le.styleValues&&le.backColor)),v.hasColumnSubtotalStyle?(Y=null!==(l=R.fontColor)&&void 0!==l?l:k.fontColor,de=null!==(s=R.backColor)&&void 0!==s?s:k.backColor):v.hasRowSubtotalStyle?(Y=null!==(p=T.fontColor)&&void 0!==p?p:k.fontColor,de=null!==(u=T.backColor)&&void 0!==u?u:k.backColor):(Y=k.fontColor,de=k.backColor);var ge=Q??ne(v.position,M.general,de??T.backColor),be=ee(ge,f),ye=B(ge,f),me=N(null===(n=v.rowItem)||void 0===n?void 0:n.isBlankRow,M);if(v.isGrandTotal){var we=null!==(h=M.grandTotal)&&void 0!==h?h:v.isColumnGrandTotal?M.columnGrandTotal:M.rowGrandTotal;y.fontColor=v.fontColor||he||we.fontColor||Y||be,y.backColor=v.backColor||fe||we.backColor||de||me||ye}else v.hasSubtotalStyle?(y.fontColor=v.fontColor||he||Y||be,y.backColor=v.backColor||fe||de||me||ye):(y.fontColor=v.fontColor||he||be,y.backColor=v.backColor||fe||me||ye)}function N(d,v){var y,I,M;if(d){var Q=null===(y=v.blankRows)||void 0===y?void 0:y.blankRowTransparency;M=null===(I=v.blankRows)||void 0===I?void 0:I.blankRowColor,null!=Q&&(M=(0,z.Et)(M,(0,o.TD)(Q)))}return M}function te(d,v){var y,I,M,Q,c;if(null!==(y=v?.blankRows)&&void 0!==y&&y.showBorder){var e=null===(I=v?.blankRows)||void 0===I?void 0:I.borderPosition,r=null===(M=v?.blankRows)||void 0===M?void 0:M.borderWidth,l=null===(Q=v?.blankRows)||void 0===Q?void 0:Q.borderTransparency,s=null===(c=v?.blankRows)||void 0===c?void 0:c.borderColor;null!=s&&null!=l&&(s=(0,z.Et)(s,(0,o.TD)(l))),("Top"===e||"TopAndBottom"===e)&&(d.borders.top.color=s,d.borders.top.weight=r),("Bottom"===e||"TopAndBottom"===e)&&(d.borders.bottom.color=s,d.borders.bottom.weight=r)}}function ne(d,v,y){var I;return(I=v.rowSubtotals&&y?d.row.indexInSiblings:d.row.index)<0||I%2==0}function ee(d,v){return d?v.fontColorPrimary:v.fontColorSecondary}function B(d,v){return d?v.backColorPrimary:v.backColorSecondary}function g(d,v,y,I){var M,Q,c=I.grid,e=I.columnHeaders,r=I.rowHeaders,l=null!==(M=e.outlineWeight)&&void 0!==M?M:c.outlineWeight,s=null!==(Q=e.outlineColor)&&void 0!==Q?Q:c.outlineColor;v.fontColor=e.fontColor||r.fontColor,v.backColor=e.backColor||r.backColor,v.paddings.top=v.paddings.bottom=c.rowPadding,v.borders.top=new t.om,d.row.isFirst&&v.borders.top.applyParams((0,J.yo)(e.outline),l,s,t.Pb.Outline),v.borders.bottom=new t.om,d.row.isLast?v.borders.bottom.applyParams((0,J.mv)(e.outline),l,s,t.Pb.Outline):v.borders.bottom.applyParams(c.gridHorizontal,c.gridHorizontalWeight,c.gridHorizontalColor,t.Pb.Gridline),v.borders.left=new t.om,(d.column.isFirst||y)&&(v.borders.left.applyParams((0,J.fs)(e.outline),l,s,t.Pb.Outline),!(0,J.fs)(e.outline)&&(0,J.fs)(r.outline)&&(v.paddings.left+=l)),v.borders.right=new t.om,v.borders.right.applyParams(c.gridVertical,c.gridVerticalWeight,c.gridVerticalColor,t.Pb.Gridline)}var S=function(){function d(v,y){this.hierarchyNavigator=v,this.options=y}return d.prototype.onDataViewChanged=function(v){this.formattingProperties=v,this.updateTextHeights()},d.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:C.F2,fontSize:Z.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(W.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:C.dG,fontSize:Z.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(W.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:C.Zk,fontSize:Z.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(W.b.measureSvgTextHeight(this.textPropsTotal,"a"))},d.prototype.onStartRenderingSession=function(){},d.prototype.onEndRenderingSession=function(){},d.prototype.bindRowHeader=function(v,y){(0,t.ey)(y);var I=this.options.tablixProperties,M=new t.qZ;this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(v)&&((0,t.R5)(y,C.Eo),M.borders.right=new t.om(ue.FX.PropGridOutlineWeight.defaultValue,I.PropGridOutlineColor.getValue(null))),v.isSubtotal&&(M.paddings.left=C.P$),y.contentWidth=0,this.bindHeader(v,y,y.extension.contentHost,this.hierarchyNavigator.getRowHeaderMetadataColumn(v),M),y.contentWidth=Math.ceil(y.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(v),w(y.position,v,M,!1,this.formattingProperties),y.applyStyle(M)},d.prototype.unbindRowHeader=function(v,y){(0,t.G9)(y),(0,t.aP)(y)},d.prototype.bindColumnHeader=function(v,y){(0,t.ey)(y);var I=new t.qZ,M=this.options.tablixProperties,Q=!1,c=y.extension.contentHost;if((c=(0,t.Ch)(c)).classList.add(C.WA),y.contentWidth=0,this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(v)){if(I.borders.bottom=new t.om(ue.FX.PropGridOutlineWeight.defaultValue,M.PropGridOutlineColor.getValue(null)),(0,t.R5)(y,C.mQ),(0,t.R5)(y,C.s0),this.options.showSortIcons){var r=this.getSortableHeaderColumnMetadata(v);r&&(this.registerColumnHeaderClickHandler(r,y),c=(0,t.D6)(r.sort,c),r.sort&&(y.contentWidth=this.fontSizeHeader+C.fG))}v.isSubtotal&&v.parent&&v.parent.children.length>1&&v.parent.children[0].isSubtotal&&(Q=!0)}y.extension.disableDragResize(),this.bindHeader(v,y,c,this.hierarchyNavigator.getColumnHeaderMetadataColumn(v),I,Q),y.contentWidth=Math.ceil(y.contentWidth),O(y.position,v,I,this.formattingProperties),y.applyStyle(I)},d.prototype.unbindColumnHeader=function(v,y){(0,t.G9)(y),(0,t.aP)(y),this.getSortableHeaderColumnMetadata(v)&&this.unregisterColumnHeaderClickHandler(y),this.options.showSortIcons&&(0,t.Y4)(y)},d.prototype.bindHeader=function(v,y,I,M,Q,c){(0,t.R5)(y,C.f),Q.fontFamily=C.F2,Q.fontColor=C.lN;var e=this.formattingProperties.grid.imageHeight;if(y.contentHeight=(0,se.pt)(M)?e:v.hasSubtotalStyle?this.textHeightTotal:this.textHeightValue,v.hasSubtotalStyle&&((0,t.R5)(y,C.R9),Q.fontFamily=C.Zk),v.isSubtotal&&!c)return(0,t.DM)(this.options.totalLabel,I,y.extension.contentHost),void(y.contentWidth=W.b.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var r=this.getHeaderLabel(v);if(r)return(0,t.MN)(M,r)!==G.av.NONE?((0,t.vU)(r,I),void(y.contentWidth+=W.b.measureSvgTextWidth(this.textPropsHeader,r))):(0,se.pt)(M)&&(0,G.gU)(r)?((0,t.Hx)(v.valueFormatted,I,e),void(y.contentWidth+=e*C.wd)):((0,t.DM)(r,I,y.extension.contentHost),void(y.contentWidth+=W.b.measureSvgTextWidth(v.hasSubtotalStyle?this.textPropsTotal:this.textPropsHeader,r)));I.innerHTML=C.jv},d.prototype.applyWordWrapping=function(v,y){if(L.fF.assertValue(y,"applyWordWrapping - Undefined cell"),L.fF.assert(function(){return null!=y.containerWidth&&-1!==y.containerWidth},"applyWordWrapping - Undefined width"),L.fF.assert(function(){return null!=y.containerHeight&&-1!==y.containerHeight},"applyWordWrapping - Undefined height"),1===y.type){var I=this.hierarchyNavigator.getRowHeaderMetadataColumn(v);if(!(0,se.cR)(I)&&!(0,se.pt)(I)){var M=y.extension.contentHost;(0,t.D4)(M);var Q=v.valueFormatted,c=new t.qZ;w(v.position,v,c,!1,this.formattingProperties);for(var e=y.containerWidth-(c.getExtraRight()+c.getExtraLeft()),r=y.containerHeight-(c.getExtraTop()+c.getExtraBottom()),l=Math.floor(r/this.textHeightHeader),p=0,u=(0,q.ql)(Q,this.textPropsHeader,W.b.measureSvgTextWidth,e,l,null,!0);p<u.length;p++)(0,t.Ch)(M,u[p])}}},d.prototype.registerColumnHeaderClickHandler=function(v,y){var I=this;this.options.onColumnHeaderClick&&y.extension.registerClickHandler(function(c){if((0,t.xl)(c)){var e=(0,t.x7)(v.sort);I.options.onColumnHeaderClick(v.queryName?v.queryName:v.displayName,e)}})},d.prototype.unregisterColumnHeaderClickHandler=function(v){this.options.onColumnHeaderClick&&v.extension.unregisterClickHandler()},d.prototype.bindBodyCell=function(v,y){(0,t.ey)(y);var I=new t.qZ;y.contentHeight=this.textHeightValue;var M=v.kpiContent;if(M)$(y.extension.contentHost).append(M),y.contentWidth=this.fontSizeValue;else{var Q=this.textPropsValue;(0,t.R5)(y,C.s0),v.isTotal&&((0,t.R5)(y,C.R9),I.fontFamily=C.Zk,y.contentHeight=this.textHeightTotal,Q=this.textPropsTotal);var c=v.textContent;c&&((0,t.DM)(c,y.extension.contentHost),y.contentWidth=W.b.measureSvgTextWidth(Q,c))}y.contentWidth=Math.ceil(y.contentWidth),D(y.position,v,I,!1,this.formattingProperties),y.applyStyle(I)},d.prototype.unbindBodyCell=function(v,y){(0,t.G9)(y),(0,t.aP)(y)},d.prototype.bindCornerCell=function(v,y){(0,t.ey)(y);var I=this.options.tablixProperties,M=new t.qZ;M.fontFamily=C.F2,M.fontColor=C.lN,y.contentHeight=this.textHeightHeader,y.contentWidth=0;var Q=y.extension.contentHost;if((Q=(0,t.Ch)(Q)).classList.add(C.WA),v.isColumnHeaderLeaf&&((0,t.R5)(y,C.mQ),M.borders.bottom=new t.om(ue.FX.PropGridOutlineWeight.defaultValue,I.PropGridOutlineColor.getValue(null)),this.options.showSortIcons)){var c=this.getSortableCornerColumnMetadata(v);c&&(this.registerColumnHeaderClickHandler(c,y),Q=(0,t.D6)(c?c.sort:void 0,Q),c.sort&&(y.contentWidth=this.fontSizeHeader+C.fG))}(0,t.DM)(v.displayName,Q,y.extension.contentHost),y.contentWidth+=W.b.measureSvgTextWidth(this.textPropsHeader,v.displayName),y.contentWidth=Math.ceil(y.contentWidth),v.isRowHeaderLeaf&&(0,t.R5)(y,C.Eo),(0,t.R5)(y,C.f),g(y.position,M,!1,this.formattingProperties),y.applyStyle(M),y.extension.disableDragResize()},d.prototype.unbindCornerCell=function(v,y){(0,t.G9)(y),(0,t.aP)(y),this.options.showSortIcons&&(0,t.Y4)(y),v.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(y)},d.prototype.bindEmptySpaceHeaderCell=function(v){},d.prototype.unbindEmptySpaceHeaderCell=function(v){},d.prototype.bindEmptySpaceFooterCell=function(v){},d.prototype.unbindEmptySpaceFooterCell=function(v){},d.prototype.getHeaderLabel=function(v){return v.valueFormatted},d.prototype.getCellContent=function(v){return v.textContent||""},d.prototype.hasRowGroups=function(){var v=this.hierarchyNavigator.getRowHierarchy();return!(!v||!v.levels||0===v.levels.length)},d.prototype.getSortableCornerColumnMetadata=function(v){if(v.isColumnHeaderLeaf)return v.metadata},d.prototype.getSortableHeaderColumnMetadata=function(v){var y=this.hierarchyNavigator.getRowHierarchy();if(!y||!y.levels||0===y.levels.length)return null;var I=this.hierarchyNavigator.getValueSources(),M=I&&I.length>1,Q=this.hierarchyNavigator.getColumnHierarchy(),c=Q?Q.levels.length:0;M?c--:1===c&&Q.levels[0]&&Q.levels[0].sources&&Q.levels[0].sources[0]&&Q.levels[0].sources[0].roles&&Q.levels[0].sources[0].roles.Values&&(c=0);var e=-1;return 0===c?e=v.levelSourceIndex:v.isSubtotal&&(M?v.parent&&0===v.parent.level&&(e=v.levelSourceIndex):0===v.level&&(e=v.levelSourceIndex)),-1!==e?I[e=e||0]:null},d}()},13375:function(_e,Se,U){U.d(Se,{aD:function(){return q},hc:function(){return t}});var z=U(81337),pe=U(62458),se=U(39681),ue=U(38078),J=U(93340),L=U(29043),W=U(66842),Z=U(40845),G=function(C){function i(o,w,O,D,N,te,ne,ee){var g,S,d,v,B=this;if(O)for(d=O;d.parent;)d=d.parent;if(D)for(v=D;v.parent;)v=v.parent;var y=v&&!!v.isSubtotal,I=!y&&D&&!!D.isSubtotal,M=d&&!!d.isSubtotal,Q=!M&&O&&!!O.isSubtotal,c=O.isBlankRow;return _.isString(o)&&!(null===(S=null===(g=N?.type)||void 0===g?void 0:g.misc)||void 0===S)&&S.sparkline&&(o=(0,L.th)(o,te)),(B=C.call(this,o,w,Q,I,M,y,c,N,ne,ee,0)||this).rowItem=O,B.columnItem=D,B.hasRowSubtotalStyle=O&&O.hasSubtotalStyle,B.hasColumnSubtotalStyle=D&&D.hasSubtotalStyle,B.hasSubtotalStyle=B.hasRowSubtotalStyle||B.hasColumnSubtotalStyle,B}return(0,z.__extends)(i,C),Object.defineProperty(i.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),i}(J.jG);function q(C,i,o,w,O,D,N,te,ne,ee){void 0===N&&(N=!0);var B=new t(w,O,D,ee,!0);return N&&B.update(C,!1,!1,!1,i,!0,o,te,ne,void 0,void 0,!1),B}var t=function(){function C(i,o,w,O,D){this.tablixProperties=o,this.hostServices=w,this.expandCompositeHierarchy=O,this.modernRowHeaderStyle=D,this.compositeGroupSeparator=i}return C.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},C.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},C.prototype.getLeafCount=function(i){var o=this.getMatrixHierarchy(i);return o?o.leafNodes.length:0},C.prototype.getLeafAt=function(i,o){var w=this.getMatrixHierarchy(i);return w?w.leafNodes[o]:null},C.prototype.getLeafIndex=function(i){return pe.fF.assertValue(i,"item"),i.leafIndex},C.prototype.getParent=function(i){return pe.fF.assertValue(i,"item"),0===i.level?null:i.parent},C.prototype.getIndex=function(i){return pe.fF.assertValue(i,"item"),i?i.index:-1},C.prototype.isLeaf=function(i){return pe.fF.assertValue(i,"item"),!i.children||0===i.children.length},C.prototype.isRowHierarchyLeaf=function(i){return!0},C.prototype.isColumnHierarchyLeaf=function(i){return!1},C.prototype.isFirstItem=function(i,o){return i===_.head(o)},C.prototype.areAllParentsFirst=function(i,o){if(!i)return!1;var w=this.getParent(i);return w?this.isFirstItem(i,i.siblings)&&this.areAllParentsFirst(w,w.siblings):this.isFirstItem(i,i.siblings)},C.prototype.isLastItem=function(i,o){if(pe.fF.assertValue(i,"item"),i!==_.last(o))return!1;if(!this.isItemRow(i)||this.isDataComplete)return!0;for(var w=i.parent;w;){if(w!==_.last(w.siblings))return!0;w=w.parent}return!1},C.prototype.isItemRow=function(i){if(!i)return!1;for(var o=i;o.parent;)o=o.parent;return o.siblings===this.rowHierarchy.root.children},C.prototype.areAllParentsLast=function(i,o){if(!i)return!1;var w=this.getParent(i);return w?this.isLastItem(i,i.siblings)&&this.areAllParentsLast(w,w.siblings):this.isLastItem(i,i.siblings)},C.prototype.getChildren=function(i){return pe.fF.assertValue(i,"item"),i.children},C.prototype.getChildrenLevelDifference=function(i){var o=1/0,w=this.getChildren(i);if(!_.isEmpty(w))for(var O=0,D=w.length;O<D;O++)o=Math.min(o,w[O].level-i.level);return o},C.prototype.getCount=function(i){return pe.fF.assertValue(i,"items"),i.length},C.prototype.getAt=function(i,o){return pe.fF.assertValue(i,"items"),i[o]},C.prototype.getLevel=function(i){return pe.fF.assertValue(i,"item"),i.level},C.prototype.getRowLeafIndex=function(i){return this.isSteppedLayout&&i.isSubtotal?i.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?i.parent.leafIndex:i.leafIndex:this.valuesOnRow?i.levelSourceIndex:-1:i.leafIndex},C.prototype.getIntersection=function(i,o){pe.fF.assertValue(i,"rowItem"),pe.fF.assertValue(o,"columnItem");var w,D,O=o.leafIndex;if(w=i.values?i.values[o.leafIndex]:void 0){var N=this.valueSources[w.valueSourceIndex||0],te=N.queryName;D=new G(w.value,w.objects,i,o,N,this.hostServices,this.formatters[te],this.tooltipFormatters[te])}else D=new G(void 0,void 0,i,o,void 0,this.hostServices,void 0,void 0);var B=this.getRowLeafIndex(i);return D.position.row.index=B,D.position.row.indexInSiblings=i.siblings.indexOf(i),D.position.row.isFirst=0===B,D.position.row.isLast=this.isDataComplete&&B===this.rowHierarchy.leafNodes.length-1,D.position.column.index=O,D.position.column.indexInSiblings=o.siblings.indexOf(o),D.position.column.isFirst=0===O,D.position.column.isLast=O===this.columnHierarchy.leafNodes.length-1,w&&w.objects&&(D.backColor=(0,ue.HZ)(this.tablixProperties.PropValuesBackColor.getValue(w.objects)),D.fontColor=(0,ue.HZ)(this.tablixProperties.PropValuesFontColor.getValue(w.objects))),D},C.prototype.getCorner=function(i,o){pe.fF.assert(function(){return i>=0},"rowLevel"),pe.fF.assert(function(){return o>=0},"columnLevel");var D,w=this.columnHierarchy.levels,O=this.rowHierarchy.levels;if((o===w.length-1||0===w.length)&&(D=O[i])){var N=i===O.length-1,te=this.valuesOnRow&&N;return{metadata:1===D.sources.length||D.sources.length>1&&te?D.sources[0]:null,displayName:te?"":_.map(D.sources,function(B){return B.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:N,position:this.calculateCornerCellPosition(i,o),rowLevel:i,columnLevel:o}}if(i===O.length-1&&(D=w[o])){var ee=D.sources.filter(function(g){return!g.isMeasure});return{metadata:1===D.sources.length?D.sources[0]:null,displayName:_.map(ee,function(g){return g.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(i,o),rowLevel:i,columnLevel:o}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(i,o),rowLevel:i,columnLevel:o}},C.prototype.calculateCornerCellPosition=function(i,o){var w=new J.ri,O=o;w.row.index=w.row.indexInSiblings=O,w.row.isFirst=0===O;var D=this.getColumnHierarchyDepth();w.row.isLast=o===D-1;var N=i;w.column.index=w.column.indexInSiblings=N,w.column.isFirst=0===N;var te=this.getRowHierarchyDepth();return w.column.isLast=N===te-1,w},C.prototype.headerItemEquals=function(i,o){return!(!i||!o)&&i===o},C.prototype.bodyCellItemEquals=function(i,o){return i.position.isMatch(o.position)},C.prototype.cornerCellItemEquals=function(i,o){return!(!i||!o)&&i.displayName===o.displayName&&i.isColumnHeaderLeaf===o.isColumnHeaderLeaf&&i.isRowHeaderLeaf===o.isRowHeaderLeaf&&i.metadata===o.metadata},C.prototype.getColumnHierarchy=function(){return this.columnHierarchy},C.prototype.getRowHierarchy=function(){return this.rowHierarchy},C.prototype.getValueSources=function(){return this.valueSources},C.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},C.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},C.prototype.update=function(i,o,w,O,D,N,te,ne,ee,B,g,S){var d=this;pe.fF.assertValue(i,"matrix"),this.isSteppedLayout=o,this.valuesOnRow=w,this.areRowSubtotalsBefore=O,this.isDataComplete=D,this.valueSources=i.valueSources,this.formatters=te,this.tooltipFormatters=ne||{},this.subtotalByColumn=ee||{},this.multipleValueSources=i.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(i.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,S,B,g),(N=N||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(i.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,g,this.areRowSubtotalsBefore,function(v,y){return d.calculateRowHeaderPosition(v,y)}),N&&(this.updateHierarchy(this.columnHierarchy,!1,g,!1,function(v,y){return d.calculateColumnHeaderPosition(v,y)}),this.updateStaticColumnHeaders(this.columnHierarchy))},C.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},C.prototype.removeValueNodesFromColumnHierarchy=function(i){pe.fF.assertValue(i,"nodes");for(var o=0,w=i;o<w.length;o++){var O=w[o];if(!O.parent&&this.isLeaf(O))return i.length=0,void i.push({level:0});this.isLeaf(O.children[0])?O.children=void 0:this.removeValueNodesFromColumnHierarchy(O.children)}},C.prototype.addValueNodesToRowHierarchy=function(i,o){for(var w=this.getRowHierarchyDepth(),O=this.valueSources.length,D=i.length,N=0;N<D;N++){var te=i[N];if(this.isLeaf(te)){var ne=void 0,ee=void 0,B=void 0;if(this.isSteppedLayout&&te.isSubtotal||!o?(i.splice(N,1),ne=i,ee=N,B=te.level,D=D-1+O,N=N-1+O):(te.children=[],ne=te.children,ee=0,B=w),!te.isBlankRow)for(var g=0;g<O;g++){var S=this.createRowValueNode(g,O,te,B);ne.splice(ee++,0,S)}te.values=null}else this.addValueNodesToRowHierarchy(te.children,o)}},C.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},C.prototype.createRowValueNode=function(i,o,w,O){var D={level:O,levelSourceIndex:i,isSubtotal:w.isSubtotal,hasSubtotalStyle:!!w.hasSubtotalStyle,values:{}},N=0,te=0;for(var ne in w.values)N%o===i&&(D.values[te++]=w.values[N]),N++;return D},C.prototype.createBlankRowValueNode=function(i){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(i),function(w){return w.valueSourceIndex}).map(function(w){return{value:"",valueSourceIndex:w,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.needsBlankRow=function(i,o,w){return!i.isSubtotal||o===Z.we&&w!==W.t.Compact},C.prototype.findValues=function(i){if(i.values)return i.values;var o=_.first(i.children);return o?this.findValues(o):void 0},C.prototype.wrapHierarchy=function(i,o,w,O,D,N){var ne,te=this;return ne={levels:this.wrapLevels(i.levels,o),root:{children:this.wrapNodes(i.root.children,i,o,w)}},O&&ne.root.children.length>0&&(ne.root.children=_.flatMap(ne.root.children,function(ee){return te.needsBlankRow(ee,D,N)?[ee,te.createBlankRowValueNode(ee)]:[ee]})),ne.leafNodes=[],ne},C.prototype.wrapLevels=function(i,o){if(i){for(var w=[],O=0,D=i;O<D.length;O++){var N=D[O],te=(0,se.ED)(N);if(w.push(te),N.sources.length>1&&o){for(var ne=1;ne<N.sources.length;ne++)w.push({sources:[N.sources[ne]]});te.sources.splice(1,te.sources.length-1)}}return w}},C.prototype.wrapNodes=function(i,o,w,O){if(i){for(var D=[],N=0,te=i;N<te.length;N++){var ne=te[N],ee=(0,se.ED)(ne);if(ne.isCollapsed&&!_.isEmpty(ne.children)){var B=_.find(ne.children,function(M){return M.isSubtotal});B&&(ee.values=B.values),ee.children=null,ee.hasSubtotalStyle=!0}else{if(ee.isSubtotal){var g=o.levels[ee.level||0];if(1===g.sources.length&&!1===this.subtotalByColumn[g.sources[0].queryName])continue}ee.hasSubtotalStyle=!!ne.isSubtotal||O&&!_.isEmpty(ne.children),ee.children=this.wrapNodes(ne.children,o,w,O)}if(!_.isEmpty(ee.levelValues)&&ee.levelValues.length>1&&w){for(var S=ee.children,d=ee,v=1;v<ee.levelValues.length;v++){var y=(0,se.ED)(ee),I=ee.levelValues[v];I.levelSourceIndex=0,y.levelValues=[I],y.level+=v,y.isCollapsed=!0,y.children=void 0,d.isCollapsed=!1,d.children=[y],d=y}_.isEmpty(S)||(d.children=S,d.isCollapsed=!1),d.values=ee.values,ee.values=void 0,ee.levelValues.splice(1,ee.levelValues.length-1)}D.push(ee)}return D}},C.prototype.updateHierarchy=function(i,o,w,O,D){i.leafNodes.length>0&&(i.leafNodes.length=0),i.root.children&&this.updateRecursive(i,i.root.children,null,i.leafNodes,o,w,O,D)},C.prototype.createEmptyNode=function(i){return void 0===i&&(i=0),{level:i,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.updateRecursive=function(i,o,w,O,D,N,te,ne){for(var ee,B=function(y,I){var M=o[y];if(M.siblings=o,i===g.rowHierarchy&&!M.isCollapsed&&!_.isEmpty(M.children)&&N===W.t.Outline&&!te&&M.children.unshift(g.createEmptyNode(M.children[0].level)),w&&(M.parent=w),ee=i===g.rowHierarchy&&g.isSteppedLayout&&M.isSubtotal&&void 0!==M.levelSourceIndex?_.last(i.levels):i.levels[M.level],M.hierarchyLevel=ee,ee)if(M.levelValues){for(var Q=[],c=[],e=0,r=M.levelValues;e<r.length;e++){var l=r[e],u=l.value;Q.push(g.formatters[(s=ee.sources[l.levelSourceIndex||0]).queryName].format(u,null));var n=g.tooltipFormatters[s.queryName];n&&c.push(n.format(u,null))}pe.fF.assert(function(){return Q.length===c.length||_.isEmpty(c)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),M.valueFormatted=Q.join(g.compositeGroupSeparator),M.tooltipValueFormatted=_.isEmpty(c)?void 0:c.join(g.compositeGroupSeparator),M.queryName=1!==ee.sources.length?void 0:ee.sources[0].queryName}else{var s;M.valueFormatted=(s=ee.sources[M.levelSourceIndex||0]).displayName,M.tooltipValueFormatted=s.displayName,M.queryName=s.queryName}M.index=y,_.isEmpty(M.children)?(!D||!M.isSubtotal||!te&&M.parent&&!M.parent.isSubtotal||g.valuesOnRow&&M.parent)&&(M.leafIndex=O.length,O.push(M)):(D&&(M.leafIndex=O.length,O.push(M)),g.updateRecursive(i,M.children,M,O,D,N,te,ne),D&&(pe.fF.assertAnyValue(_.every(M.children,function(h){return _.isEqual(h.hierarchyLevel,M.children[0].hierarchyLevel)}),"Children may come from different levels"),(!g.hasMultipleValueSources()||_.some(M.children,function(h){return _.some(h.hierarchyLevel.sources,function(H){return!H.isMeasure})}))&&(M.hasSubtotalStyle=!0))),M.position=ne(M,o)},g=this,S=0,d=o.length;S<d;S++)B(S)},C.prototype.updateStaticColumnHeaders=function(i){var o=i.leafNodes;if(o&&o.length>0){if(!o[0].identity&&this.valuesOnRow&&1===o.length)return;for(var w=0,O=o.length;w<O;w++){var D=o[w];if(!D.identity&&_.isEmpty(D.levelValues)){var te=i.levels[D.level].sources[D.levelSourceIndex?D.levelSourceIndex:0];te&&(D.valueFormatted=te.displayName)}}}},C.prototype.getMatrixHierarchy=function(i){var o=this.rowHierarchy.root.children;if(o&&i===o)return this.rowHierarchy;var w=this.columnHierarchy.root.children;return w&&i===w?this.columnHierarchy:null},C.prototype.calculateRowHeaderPosition=function(i,o){var w=new J.ri;w.row.index=this.getRowLeafIndex(i),w.row.indexInSiblings=this.getIndex(i),w.row.isFirst=this.areAllParentsFirst(i,o),w.row.isLast=this.areAllParentsLast(i,o);var O=this.getLevel(i);return w.column.index=w.column.indexInSiblings=O,w.column.isFirst=0===O,w.column.isLast=this.isLeaf(i),w},C.prototype.calculateColumnHeaderPosition=function(i,o){var w=new J.ri,O=this.getLevel(i);w.row.index=w.row.indexInSiblings=O,w.row.isFirst=0===O,w.row.isLast=this.isLeaf(i);var D=this.getIndex(i);return w.column.index=w.column.indexInSiblings=D,w.column.isFirst=this.areAllParentsFirst(i,o),w.column.isLast=this.areAllParentsLast(i,o),w},C.prototype.getRowHeaderMetadataColumn=function(i){var o=this.getRowHeaderMetadataColumns(i);return o&&o[0]},C.prototype.getRowHeaderMetadataColumns=function(i){if(i&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,i.level)},C.prototype.getColumnHeaderMetadataColumn=function(i){var o=this.getColumnHeaderMetadataColumns(i);return o&&o[0]},C.prototype.getColumnHeaderMetadataColumns=function(i){if(i&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,i.level)},C.prototype.getHierarchyMetadataColumns=function(i,o){if(i&&i.levels&&!(i.levels.length<o)){var w=i.levels[o];if(w&&w.sources&&0!==w.sources.length)return w.sources}},C.isNodeGrandTotal=function(i){if(i){for(var o=i;o.parent;)o=o.parent;return o.isSubtotal}return!1},C}()},32771:function(_e,Se,U){U.d(Se,{JF:function(){return Z},az:function(){return W}});var z=U(81337),pe=U(90120),se=U(34021),ue=U(44783),J=U(62458),L=U(38078);function W(q,t,C){if(J.fF.assertValue(q,"getColumnDataBarsSettings: column"),t){var o,w,i=q.aggregates;if(null!=t.minValue?o=t.minValue:i&&null!=i.min&&_.isNumber(i.min)&&(o=i.min),null!=t.maxValue?w=t.maxValue:i&&null!=i.max&&_.isNumber(i.max)&&(w=i.max),!(null==o||null==w||o>w)){var O=null!=t.minValue,D=null!=t.maxValue;return o>=0&&w>0&&!O&&(o=0),o<0&&w<0&&!D&&(w=0),{min:o,max:w,range:w-o,zeroPosition:0===o&&0===w?.5:o>=0&&w>0&&O?0:o<0&&w<=0&&D?1:(0-o)/(w-o),positiveColor:(0,L.HZ)(pe.v.getFillColor(C,t.positiveColor,ue.U)),negativeColor:(0,L.HZ)(pe.v.getFillColor(C,t.negativeColor,ue.U)),axisColor:(0,L.HZ)(pe.v.getFillColor(C,t.axisColor,ue.fA)),hideText:!!t.hideText,reverseDirection:!!t.reverseDirection,strokeSettings:(0,z.__assign)((0,z.__assign)({},(0,se.kG)(C)),{width:1}),totalMatching:t.totalMatchingOption}}}}function Z(q,t,C,i,o){var w,O=C.getExtraLeft()+"px",D=C.getExtraRight()+"px",N=C.getExtraTop()+"px",te=C.getExtraBottom()+"px",ne={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:O,right:D,top:N,bottom:te}},ee=[],B=function(q,t,C){if(null!=t&&_.isNumber(t)&&0!==t){var D,N,te,i=q.min,o=q.max,w=q.range,O=q.zeroPosition;if(t>=o){if(1===O)return;t=o}else if(t<=i){if(0===O)return;t=i}if(0===w?(D=N=O,te=q.positiveColor):t>0?(D=O,N=(t-i)/w,te=q.positiveColor):(D=(t-i)/w,N=O,te=q.negativeColor),q.reverseDirection){var ne=D;D=1-N,N=1-ne}var ee=100*(N-D);C?.push((t>=0?"":"-")+Math.round(ee)+"%");var B={left:100*D+"%",width:ee+"%",background:te},g=q.strokeSettings;return g&&g.visible&&(B.outline="".concat(g.width,"px solid ").concat(g.color),B["outline-offset"]="-".concat(g.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:B}}}(t,i,ee);B&&ne.children.push(B);var d,g=t.zeroPosition;t.reverseDirection&&(g=1-g),ne.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+N,bottom:"-"+te,left:100*g+"%","border-left-color":t.axisColor}}),o&&(d={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:o.getLocalizedString("Data_Bar_Percentage",null!==(w=ee[0])&&void 0!==w?w:"0%")});var v=q.styleProperties;return v.position="absolute",v.left=O,v.right=D,v.top=N,v.bottom=te,d?{children:[ne,q,d],classNames:[],attributes:{},styleProperties:{}}:{children:[ne,q],classNames:[],attributes:{},styleProperties:{}}}},21242:function(_e,Se,U){U.d(Se,{Ak:function(){return o},IP:function(){return D},JW:function(){return Z},MX:function(){return C},d4:function(){return ue},kH:function(){return J},mM:function(){return i},p_:function(){return O},re:function(){return G}});var z=U(81337),pe=U(13375);function se(N,te,ne,ee){var B,g,S,d,v,y;void 0===ne&&(ne=!0);var I=N.columnItem,M=N.rowItem,Q=0,c={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},e=M&&!_.isEmpty(M.values),r=M&&t(M,te,ne,ee);r&&((B=c.displayNameParts).push.apply(B,r.displayNameParts||[]),(g=c.valueParts).push.apply(g,r.valueParts||[]),(S=c.headerParts).push.apply(S,_.map(r.valueParts,function(){return!0})),c.concatenatedParts.push(_.map(r.displayNameParts,function(){return Q++})));var l=I&&t(I,te,ne,ee);if(l&&((d=c.displayNameParts).push.apply(d,l.displayNameParts||[]),(v=c.valueParts).push.apply(v,l.valueParts||[]),(y=c.headerParts).push.apply(y,_.map(l.valueParts,function(){return!0})),c.concatenatedParts.push(_.map(l.displayNameParts,function(){return Q++}))),e)if(c.displayNameParts.push(N.columnMetadata.displayName),c.concatenatedParts.push([Q++]),c.headerParts.push(!1),N.isKpi){var s={metadata:N.columnMetadata.kpi,value:N.tooltipContent};(c.otherType[c.displayNameParts.length-1]={}).kpiValue=s,c.valueParts.push(N.tooltipContent)}else _.isEmpty(N.tooltipContent)||c.valueParts.push(N.tooltipContent);return c}function ue(N,te,ne){if(N)return ne?[{displayName:"",value:N.tooltipContent}]:function(N){for(var te=[],ne=function(d){var v=_.filter(N.displayNameParts,function(Q,c){return-1!==d.indexOf(c)}),y=_.filter(N.valueParts,function(Q,c){return-1!==d.indexOf(c)});if((v.length>0||y.length>0)&&(te.push({displayName:v.join(" "),value:y.join(" ")}),N.otherType)){var I=_.first(d);if(_.has(N.otherType,String(I))){var M=te.length-1;delete te[M].value,te[M]=(0,z.__assign)((0,z.__assign)({},te[M]),N.otherType[I])}}},ee=0,B=N.concatenatedParts;ee<B.length;ee++)ne(B[ee]);return te}(se(N,te))}function J(N,te,ne,ee){for(var B=[],g=0,S=N;g<S.length;g++)B.push(se(S[g],ee));var v=0,y=te.getHierarchyLeafCount()*ne.getHierarchyLeafCount();return 0!==y&&(v=Math.round(N.length/y*100)),(0,z.__assign)({coveragePercentage:v},L(B))}function L(N){for(var te={headers:_.uniq(_.flatten(_.map(N,function(l){return l.displayNameParts}))),isHeader:{},values:[]},ne=te.values,ee=te.headers,B=te.isHeader,g={},S=0;S<ee.length;S++)g[ee[S]]=S;for(var d=0,v=N;d<v.length;d++){var y=v[d],I=_.fill(new Array(ee.length),"");for(S=0;S<y.displayNameParts.length;S++){var c=g[y.displayNameParts[S]];I[c]=y.valueParts[S],y.headerParts&&(te.isHeader[c]=y.headerParts[S])}ne.push(I)}if(!_.isEmpty(N)&&N[0].headerParts)for(var e=function(s){for(var p=ne[s],u=[],n=s+1;n<ne.length;n++)_.every(ne[n],function(he,Y){return B[Y]&&he===p[Y]||!B[Y]&&(""===he||""===p[Y])})&&u.push(n);if(u.length>0)for(var f=_.reduce(p,function(he,Y,de){return""===Y&&he.push(de),he},[]),m=0,b=u;m<b.length;m++){var R=ne[b[m]];for(n=0;n<f.length;n++){var k=f[n],E=R[k];""!==E&&(p[k]=E,f.splice(n,1),n--)}}u.sort(function(he,Y){return Y-he});for(var ie=0,le=u;ie<le.length;ie++)ne.splice(le[ie],1)},r=0;r<ne.length;r++)e(r);return te}function Z(N,te){if(N)return te?[{displayName:"",value:N.displayName}]:[{displayName:N.displayName}]}function G(N,te,ne,ee,B,g){if(N){if(g)return[{displayName:"",value:N.isSubtotal||pe.hc.isNodeGrandTotal(N)?ee:N.tooltipValueFormatted}];if(pe.hc.isNodeGrandTotal(N))return ne(N)?[{displayName:N.tooltipValueFormatted}]:[{displayName:ee}];var d=[],v=function(N,te){var ne=C(N,te),ee=ne.displayNameParts,B=ne.valueParts;if(ee.length>0||B.length>0)return{displayName:ee.join(" "),value:B.join(" ")}}(N,B);return v&&d.push(v),te(N)&&d.push({displayName:B,value:N.valueFormatted}),d}}function t(N,te,ne,ee){void 0===ne&&(ne=!0);var B=w(N),g=N.queryName,S=_.find(B,function(d){return d.queryName===g});return S&&S.isMeasure&&(N=N.parent),C(N,te,ne,ee)}function C(N,te,ne,ee){void 0===ne&&(ne=!0);for(var B=[],g=[];N;)if(ne&&N.isSubtotal)N=N.parent;else{var S=w(N);if(!_.isEmpty(S)){for(var d=[],v=0,y=S;v<y.length;v++){var I=y[v];d.push(I.isMeasure?te:I.displayName)}B.push(d.join(" ")),_.every(S,function(M){return M.isMeasure})?g.push(S[0].displayName):g.push(N.isSubtotal?ee:N.tooltipValueFormatted)}N=N.parent}return{displayNameParts:B=B.reverse(),valueParts:g=g.reverse()}}function i(N,te,ne,ee,B){var g=o(ne,ee,N,te),S=0,d=ne.getHierarchyLeafCount()*ee.getHierarchyLeafCount();0!==d&&(S=Math.round(g.length/d*100));for(var v=[],y=0,I=g;y<I.length;y++)v.push(se(I[y],B));return(0,z.__assign)({coveragePercentage:S},L(v))}function o(N,te,ne,ee){_.isEmpty(ne)&&(ne=N.getHierarchyItems()),_.isEmpty(ee)&&(ee=te.getHierarchyItems());var B=[];N.getLeaves(ne,B),B=_.filter(B,function(c){return!c.isSubtotal});var g=[];te.getLeaves(ee,g),g=_.filter(g,function(c){return!c.isSubtotal});for(var S=[],d=0,v=B;d<v.length;d++)for(var y=v[d],I=0,M=g;I<M.length;I++)S.push(N.getIntersection(y,M[I]));return S.filter(function(c){return!c.isSubtotal&&!c.isGrandTotal})}function w(N){var te=N.hierarchyLevel&&N.hierarchyLevel.sources;return _.isEmpty(te)?[]:_.every(te,function(ne){return ne.isMeasure})?[te[N.levelSourceIndex||0]]:te}function O(N){return{displayNameParts:[N.displayName],valueParts:[null]}}function D(N,te){for(var ne=[],ee=0;ee<N.displayNameParts.length;ee++){var B=N.displayNameParts[ee],g=N.valueParts[ee];null!=g&&(B+=": "+g),ne.push(B)}if(!_.isEmpty(te))for(var S=0,d=te;S<d.length;S++)ne.push(d[S]);return ne.join(". ")}},29043:function(_e,Se,U){U.d(Se,{MV:function(){return i},th:function(){return t},wJ:function(){return C}});var z=U(53197),pe=U(90120),se=U(51995),ue=U(85308),J=U(58520),L=U(45296),W=U(44783),Z=U(62458),G=U(43286),q=52;function t(N,te){var r,ne={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(N)){var ee;try{ee=JSON.parse(N)}catch{return}var B=+ee.yl,g=+ee.yh,d=+ee.xl,v=+ee.xh,y=null!=ee.md?+ee.md:void 0;_.size(ee.p)>q&&te.setWarnings([new L.El]);for(var I=0,M=ee.p;I<M.length;I++){var Q=M[I];ne.points.push({x:null!=Q[0]?+Q[0]:void 0,y:null!=Q[1]?(r=+Q[1],r*(g-B)/100+B):void 0})}return{points:_.filter(ne.points,function(e){return _.isFinite(e.x)&&(null!=e.y||_.isFinite(e.y))}),lowX:d,highX:v,lowY:B,highY:g,minXDifference:y}}}function C(N,te,ne){var ee;Z.fF.assertValue(N,"sparkline"),Z.fF.assertValue(null===(ee=te?.misc)||void 0===ee?void 0:ee.sparkline,"invalid type for sparkline"),Z.fF.assertValue(ne,"style");var B=te.misc.sparkline.groupingType;return{chartType:N.chartType,dataColor:ne.isHighContrast?pe.v.getThemeColor(ne,W.fA):N.dataColor,strokeWidth:N.strokeWidth,marker:{show:!0,typeFlags:N.marker.typeFlags,color:ne.isHighContrast?pe.v.getThemeColor(ne,W.fA):N.marker.color,size:N.marker.size,shape:N.marker.shape},isScalar:B&&!!(B.numeric||B.dateTime||B.temporal)}}function i(N,te,ne,ee,B,g,S,d){var v;if(null!=ee){var c=g-ne.getExtraLeft()-ne.getExtraRight()-(d?d+5:0),e=B-ne.getExtraTop()-ne.getExtraBottom();c-te.strokeWidth>1&&e-te.strokeWidth>1&&(v=te.chartType===ue.U.line?function(N,te,ne,ee){var s,g=N.dataColor,S=N.strokeWidth,d=N.marker,v=d.color,y=d.size,I=d.shape,M=d.typeFlags,Q=N.isScalar,c=(0,G.Js)(M),e=0===c||1===c&&(0,G.yE)(M,J.qC),r=Math.max(S,2)+(e?0:Math.ceil(y/2)),l=ee.points;s=Q?d3.scaleLinear().domain([ee.lowX,ee.highX]).range([r,te-r]):d3.scalePoint().domain(_.map(_.range(ee.lowX,ee.highX+1),function(k){return k.toString()})).range([r,te-r]);var f,m,p=d3.scaleLinear().domain(d3.extent(l,function(k){return k.y})).range([ne-r,r]),u=d3.line().x(function(k){return s(k.x)}).y(function(k){return p(k.y)}),n=_.filter(l,function(k){return null!=k.y}),H={tagName:"path",attributes:{d:u(n)},classNames:[],styleProperties:{stroke:g,"stroke-width":S.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},b=function(N,te){var ne=te.marker.typeFlags,ee=d3.extent(N,function(S){return S.y}),B=ee[0],g=ee[1];return _.filter(N,function(S,d){var v,y;return null!=S.y&&(!!(0,G.yE)(ne,J.$6)||(0,G.yE)(ne,J.Ps)&&0===d||(0,G.yE)(ne,J.Z$)&&d===N.length-1||(0,G.yE)(ne,J.pd)&&S.y<0||(0,G.yE)(ne,J.Zc)&&S.y===g||(0,G.yE)(ne,J.O3)&&S.y===B||(0,G.yE)(ne,J.qC)&&null==(null===(v=N[d-1])||void 0===v?void 0:v.y)&&null==(null===(y=N[d+1])||void 0===y?void 0:y.y))})}(n,N);if(!_.isEmpty(b)){var T="markerKey".concat(y).concat(v).concat(I);f={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:T,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:y.toString(),markerWidth:y.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,se.F)(I).toString(),"stroke-opacity":"1",stroke:v,fill:v},attributes:{d:(0,se.Ar)(I)}}]}]},m={tagName:"path",attributes:{d:u(b)},classNames:[],styleProperties:{stroke:g,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(T,")"),"marker-mid":"url(#".concat(T,")"),"marker-end":"url(#".concat(T,")")}}}return{tagName:"svg",children:m?[f,H,m]:[H],classNames:[],styleProperties:{},attributes:{height:ne+"px",width:te+"px"}}}(te,c,e,ee):function(N,te,ne,ee){var I,B=N.dataColor,g=N.isScalar,S=ee.points,d=[ee.lowX,ee.highX],v=function(N,te,ne,ee,B){if(_.isEmpty(N))return 0;var d,v=ee[ee.length-1]-ee[0];return B&&ee&&ee.length>1?(0!==v?(Z.fF.assert(function(){return null!=te},"minXDifference cannot be null for scalar plotted as columns"),d=ne*(te/(v+te))):d=ne,d=Math.max(d,2)):d=ne/(v+1),.8*d}(S,ee.minXDifference,te,d,g),y=v/2;I=g?d3.scaleLinear().domain(d).range([y,te-y]):d3.scalePoint().domain(_.map(_.range(ee.lowX,ee.highX+1),function(r){return r.toString()})).range([y,te-y]);var M=d3.extent(S,function(r){return r.y});M[0]=Math.min(0,M[0]),M[1]=Math.max(0,M[1]);var Q=d3.scaleLinear().domain(M).range([ne,0]),c=Q(0),e=v.toString();return{tagName:"svg",children:_.chain(S).filter(function(r){return null!=r.y}).map(function(r){var l=(I(r.x)-y).toString(),s=(c+(0,z.sc)(Q,Math.max(0,r.y),0)).toString(),p=Math.abs((0,z.sc)(Q,0,r.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:B},attributes:{x:l,y:s,width:e,height:p}}}).value(),classNames:[],styleProperties:{},attributes:{height:ne+"px",width:te+"px"}}}(te,c,e,ee))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(S&&"Before"!==S.layout?[v,N]:[N,v],function(s){return!!s})}}},74764:function(_e,Se,U){U.r(Se),U.d(Se,{PivotTable:function(){return me}});var z=U(81337),pe=U(80065),se=U(82755),ue=U(46135),J=U(79465),L=U(57419),W=U(59107),Z=U(15366),G=U(32379),q=U(31198),t=U(40739),C=U(62458),i=U(51660),o=U(21242),w=U(13375),O=U(85196),D=U(26543),N=function(){function ae(a,F,V,K){this.tooltipService=a,this.selectionManager=F,this.valueLabel=V,this.totalLabel=K,this.tooltipsEnabled=!0}return ae.prototype.getHandlerTop=function(){var a=this,F=function(re){return re.isSubtotal&&!a.rowHierarchyNavigator.valuesOnRowApplied()&&a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(re)},V=function(re){return a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(re)},K=O.r.columns;return{addTooltip:null,removeTooltip:function(re,P){return a.removeTooltip(P)},isTooltipEnabled:null,setTooltipDelegate:function(re,P,x,A,j){return a.setTooltipDelegateTop(re,P,x,F,V,K,A,j)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ae.prototype.getHandlerMidOrBot=function(){var a=this,F=function(re){return re.isSubtotal&&a.rowHierarchyNavigator.valuesOnRowApplied()&&a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(re)},V=function(re){return a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(re)},K=O.r.rows;return{addTooltip:null,removeTooltip:function(re,P){return a.removeTooltip(P)},isTooltipEnabled:null,setTooltipDelegate:function(re,P,x,A,j){return a.setTooltipDelegateMidOrBot(re,P,x,F,V,K,A,j)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ae.prototype.getRowHeaderHandler=function(){var a=this;return this.getHeaderHandler(function(F){return F.isSubtotal&&a.rowHierarchyNavigator.valuesOnRowApplied()&&a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(F)},function(F){return a.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(F)},O.r.rows)},ae.prototype.getColumnHeaderHandler=function(){var a=this;return this.getHeaderHandler(function(F){return F.isSubtotal&&!a.rowHierarchyNavigator.valuesOnRowApplied()&&a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(F)},function(F){return a.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(F)},O.r.columns)},ae.prototype.getBodyHandler=function(){var a=this;return{addTooltip:function(V,K){return a.addBodyTooltip(V,K)},removeTooltip:function(V,K){return a.removeTooltip(K)},isTooltipEnabled:function(V){return a.tooltipsEnabled},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ae.prototype.onDataViewChanged=function(a,F){this.rowHierarchyNavigator=a,this.columnHierarchyNavigator=F},ae.prototype.addBodyTooltip=function(a,F){var V=this,K=d3.select(F);this.tooltipService.addTooltip(K,function(){return(0,o.d4)(a,V.valueLabel,!V.tooltipsEnabled)},function(){var X=V.getItemSelectionId(a,O.r.values,void 0);return X&&[X]})},ae.prototype.getCornerHandler=function(){var a=this;return{addTooltip:function(V,K){return a.addCornerTooltip(V,K)},removeTooltip:function(V,K){return a.removeTooltip(K)},isTooltipEnabled:function(V){return a.tooltipsEnabled&&!_.isEmpty(V.displayName)},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},ae.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},ae.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},ae.prototype.setTooltipsEnabled=function(a){this.tooltipsEnabled=a},ae.prototype.addHeaderTooltip=function(a,F,V,K,X){var re,x,A,P=this,j=d3.select(F),oe=null===(A=(x=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===A?void 0:A.call(x),ce=((re={})[0]=!oe,re);this.tooltipService.addTooltip(j,function(){return(0,o.re)(a,V,K,P.totalLabel,P.valueLabel)},function(){var ve=P.getItemSelectionId(a,X,ce);return ve&&[ve]})},ae.prototype.addCornerTooltip=function(a,F){var V=this,K=d3.select(F);this.tooltipService.addTooltip(K,function(){return(0,o.JW)(a)},function(){var X=V.getItemSelectionId(a,void 0,void 0);return X&&[X]})},ae.prototype.getHeaderHandler=function(a,F,V){var K=this;return{addTooltip:function(re,P){return K.addHeaderTooltip(re,P,a,F,V)},removeTooltip:function(re,P){return K.removeTooltip(P)},isTooltipEnabled:function(re){return K.tooltipsEnabled&&void 0!==re.valueFormatted},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return K.tooltipsEnabled}}},ae.prototype.removeTooltip=function(a){var F=d3.select(a);this.tooltipService.removeTooltips(F)},ae.prototype.getItemSelectionId=function(a,F,V){if(a){var K=this.selectionManager.createSelectorsByColumn(a),X=K&&D.l0.fromSelectorsByColumnAndRoles(K,F);return X&&V&&(X.exclude=(0,z.__assign)((0,z.__assign)({},X.exclude),V??{})),X}},ae.prototype.setTooltipDelegateTop=function(a,F,V,K,X,re,P,x){var A,oe,ce,j=this,ve=d3.select(F),Pe=null===(ce=(oe=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===ce?void 0:ce.call(oe),Fe=((A={})[0]=!Pe,A);this.tooltipService.addTooltip(ve,function(Ce){return!j.tooltipsEnabled&&x(Ce)?null:V(Ce.context)===J.aP.Prefix?(0,o.JW)(a(Ce),!j.tooltipsEnabled):(0,o.re)(a(Ce),K,X,j.totalLabel,j.valueLabel,!j.tooltipsEnabled)},function(Ce){return j.tooltipsEnabled?V(Ce.context)===J.aP.Prefix?(He=j.getItemSelectionId(a(Ce),void 0,void 0))&&[He]:(He=j.getItemSelectionId(a(Ce),re,Fe))&&[He]:null;var He},!0,!0,P)},ae.prototype.setTooltipDelegateMidOrBot=function(a,F,V,K,X,re,P,x){var A,oe,ce,j=this,ve=d3.select(F),Pe=null===(ce=(oe=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===ce?void 0:ce.call(oe),Fe=((A={})[0]=!Pe,A);this.tooltipService.addTooltip(ve,function(Ce){return!j.tooltipsEnabled&&x(Ce)?null:V(Ce.context)===J.aP.Prefix?(0,o.re)(a(Ce),K,X,j.totalLabel,j.valueLabel,!j.tooltipsEnabled):(0,o.d4)(a(Ce),j.valueLabel,!j.tooltipsEnabled)},function(Ce){return j.tooltipsEnabled?V(Ce.context)===J.aP.Prefix?(He=j.getItemSelectionId(a(Ce),re,Fe))&&[He]:(He=j.getItemSelectionId(a(Ce),O.r.values,void 0))&&[He]:null;var He},!0,!0,P)},ae}(),te=U(28579),ne=U(54522),ee=U(44977),B=U(32105),g=U(55007),S=U(40550),d=U(19650),v=U(64067),y=U(79154),I=U(48066),M=U(38078),Q=U(58702),c=U(7911),e=U(93340),r=U(71090),l=U(93568),s=U(91468),p=U(32771),u=U(29043),n=U(76797),h=U(59784),H=U(66842),f=U(67016),m=function(){function ae(a,F,V,K,X,re){this.selectionManager=F,this.sortingManager=V,this.hostServices=K,this.isA11yMatrix=re,this.specificColumnHeaderFontInfo={},this.binderOptions=a,this.measureElement=(0,s.qk)(X),this.legacyTooltipsEnabled=!0}return ae.prototype.setFormatMode=function(a){this.formatMode=a},ae.prototype.setRowNavigator=function(a){this.rowNavigator=a},ae.prototype.setColumnNavigator=function(a){this.columnNavigator=a},ae.prototype.getRowHeaderBinding=function(a,F,V,K,X,re,P,x,A){var j=this;this.binderOptions.onBindRowHeader&&!F&&this.binderOptions.onBindRowHeader(a);var Pe,Fe,oe=a.hierarchyLevel&&a.hierarchyLevel.sources,ce=oe&&oe.length>1,ve=(0,M.HZ)(this.getRowHeaderLabel(a));if(this.formattingProperties.rowHeaders.wordWrap&&(ve=(0,s.rP)(ve)),_.isEmpty(ve)&&(ve=r.jv),!ce){var Ce=this.rowNavigator.getRowHeaderMetadataColumn(a),He=(0,e.MN)(Ce,ve);if(He!==I.av.NONE){var Le=(0,M.HZ)(a.valueFormatted);Fe=(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,He),Pe=(0,s.RD)(ve,Le,Fe,function(Ve,Ue){return j.binderOptions.onHyperlinkClicked(Ve,Ue)})}else if((0,e.Or)(a,Ce)){var We=g.FX.PropAltTextValue.getValue(a.objects),Ne=this.formattingProperties.grid;Pe=(0,s.D2)(ve,Ne.imageHeight,Ne.imageWidth,We)}}Pe=Pe?{children:[Pe],classNames:[],styleProperties:{},attributes:{}}:{content:ve,classNames:[],styleProperties:{},attributes:{}};var xe,Ie,Me=this.getExpandCollapseButtonBinding(a,A),Oe=this.formattingProperties.rowHeaders.steppedLayout;if(!F&&this.selectionManager.isRowHeaderIndicatorOn(a,Oe)){var Te=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,a.position.column.isFirst,a.position.column.isLast,!0,J.p0.MatrixRowHeader),Ge=re&&this.selectionManager.isRowHeaderIndicatorOn(re,Oe);Ie={attributes:{},classNames:[],styleProperties:{width:"100%",top:Te.weightTop+"px",bottom:Ge?"0":Te.weightBottom+"px",left:Te.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},this.selectionManager.getIndicatorStyle()===n.D.RowHeader?Ie.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):Ie.children[0].attributes["aria-hidden"]="true"}Me||Ie?(xe={attributes:{},classNames:[],styleProperties:{},children:[Pe]},Me&&(Pe.classNames.push("expandableContent"),xe.classNames.push("expandableCell"),xe.children.unshift(Me)),Ie&&xe.children.push(Ie)):xe=Pe;var Ee,ke=!_.isEmpty(ve?.trim());return x&&((Ee=new e.ri).row=x.position.row,Ee.column=a.position.column),_.assign(xe.styleProperties,this.getRowHeaderStyleAttributes(a,F,ke,P,x,Ee)),this.addRowHeaderClasses(a,!!Fe,Pe.classNames,xe.classNames),this.isA11yMatrix&&(xe.attributes||(xe.attributes={}),xe.attributes.role="rowheader"),V&&(null!=a.children?(xe.classNames.push(i.cy),xe.attributes[i.Ez]="".concat("rowHeaders"),xe.attributes[i.QZ]="".concat(1),xe.attributes[i.CK]="Visual_Tablix_RowHeaders"):a.isSubtotal&&(a.position.row.isFirst?(xe.classNames.push(i.cy),xe.attributes[i.Ez]="".concat("total-row"),xe.attributes[i.QZ]="".concat(1),xe.attributes[i.CK]="Visual_Tablix_Matrix_Row_TotalGrand"):(xe.classNames.push(i.cy),xe.attributes[i.Ez]="".concat("subtotal-row-labels"),xe.attributes[i.QZ]="".concat(1),xe.attributes[i.CK]="Visual_Subtotal_Label",xe.attributes[i.kv]=JSON.stringify({reference:f.t.subTotals.rowSubtotalsLabel,style:3}).replace(/\"/g,"&quot;")))),xe},ae.prototype.getExpandCollapseButtonBinding=function(a,F){var V=this,K=this.getRowsExpandCollapseButtonSize(a);if(0!==K){var X,re,P=["expandCollapseButton"];if(void 0===a.isCollapsed||F)X="";else{var x=a.isCollapsed?"pbi-glyph-explore-content-single":"pbi-glyph-collapse-content-single",A=this.hostServices.getLocalizedString(a.isCollapsed?"FieldListProperty_Collapsed":"FieldListProperty_Expanded");X='<i role="button" aria-label="'.concat(A,'" class="glyphicon ').concat(x,'"></i>'),this.isExpandCollapseEnabled?(P.push("clickable"),re=function(oe){V.binderOptions.onRowHeaderExpansionChange(a,!a.isCollapsed),oe.stopPropagation()}):P.push("disabled")}return{content:X,classNames:P,styleProperties:{width:K+r.wH,height:K+r.wH,color:this.formattingProperties.rowHeaders.expandCollapseButtonsColor,"font-size":this.expandCollapseButtonFontInfo.fontProperties.size.px+r.wH},attributes:{},clickHandler:re}}},ae.prototype.getRowsExpandCollapseButtonSize=function(a){return this.formattingProperties.rowHeaders.showExpandCollapseButtons&&a.hierarchyLevel&&(a.hierarchyLevel.canBeExpanded||a.level&&this.formattingProperties.rowHeaders.steppedLayout)?this.expandCollapseButtonFontInfo.measuredFontHeight:0},ae.prototype.getColumnHeaderBinding=function(a,F,V,K,X,re){var P=(0,M.HZ)(this.getColumnHeaderLabel(a));this.formattingProperties.columnHeaders.wordWrap&&(P=(0,s.rP)(P)),_.isEmpty(P)&&(P=r.jv);var x=!_.isEmpty(P?.trim()),A=this.getColumnHeaderStyle(a,this.getColumnHeaderFontInfo(a),F,x),j=A.getExtraBottom();a.position.row.isLast&&(A.paddings.bottom+=(0,s.tO)(this.glyphFontInfo.measuredFontHeight));var ve,oe=this.columnNavigator.getColumnHeaderMetadataColumn(a),ce=(0,e.MN)(oe,P),Fe={tagName:"div",content:P,attributes:{},classNames:[this.formattingProperties.columnHeaders.wordWrap?s.n2:s.wV],styleProperties:{}};if(ce!==I.av.NONE){var Ce=(0,M.HZ)(a.valueFormatted);ve=(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,ce),Fe=(0,s.RD)(Fe,Ce,ve,this.binderOptions.onHyperlinkClicked)}else if((0,e.Or)(a,oe)){var He=g.FX.PropAltTextValue.getValue(a.objects),Le=this.formattingProperties.grid;Fe=(0,s.D2)(P,Le.imageHeight,Le.imageWidth,He)}var We=this.getColumnHeaderClasses(a,!!ve),Ne={};K&&(We.push(i.cy),Ne[i.QZ]="".concat(1),Ne[i.Ez]="".concat("columnHeaders"),Ne[i.CK]="Visual_Tablix_ColumnHeaders");var xe={tagName:"div",children:[Fe],classNames:We,styleProperties:this.getColumnHeaderStyleAttributes(a,A,re),attributes:Ne};if(a.position.row.isLast){var Me=this.binderOptions.sortingEnabled&&this.sortingManager.isColumnHeaderSortable(a),Ie=this.sortingManager.getColumnHeaderSortDirection(a),Oe=(0,s.Km)(Ie,this.binderOptions.sortIconEnabled,Me,h.S.getNextSortDirection(Ie,oe),j,this.glyphFontInfo.textProperties.fontSize,this.hostServices);xe.children.push(Oe),1===Ie?xe.attributes["aria-sort"]="ascending":2===Ie&&(xe.attributes["aria-sort"]="descending")}if(!F&&this.selectionManager.isColumnHeaderIndicatorOn(a)){var Te=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,!1,a.position.column.isLast,!0,J.p0.Header),Ge=X&&this.selectionManager.isColumnHeaderIndicatorOn(X),ke={attributes:{},classNames:[],styleProperties:{height:"5px",left:Te.weightLeft+"px",right:Ge?"0":Te.weightRight+"px",bottom:Te.weightBottom+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"0",y1:"2",x2:"100%",y2:"2",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"0",y1:"4",x2:"100%",y2:"4",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}}]}]};this.selectionManager.getIndicatorStyle()===n.D.ColumnHeader?ke.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):ke.children[0].attributes["aria-hidden"]="true",xe.children.push(ke)}return xe},ae.prototype.getBodyCellBinding=function(a,F,V,K,X,re,P){var A,x=(0,M.HZ)(this.getBodyCellContent(a)),j=!_.isEmpty(x?.trim()),oe=this.getBodyCellStyle(a,this.getBodyCellFontInfo(a),F,j);this.formattingProperties.values.underline&&j&&(oe.textDecoration=y.f0);var Le,ce=a.columnMetadata,ve=ce&&this.columnsDataBarsSettings[ce.queryName],Pe=this.shouldApplyDataBars(ve,a),Fe=ce&&this.formattingProperties.columnFormatting[ce.queryName],Ce=(0,Q.TS)(Fe&&Fe.icon,a.icon),He=a.hyperlink;if(Ce&&"IconOnly"===Ce.layout)x="";else if(_.isEmpty(x)&&(x=r.jv),a.isKpi)x=(0,s.kJ)(a.columnMetadata.kpi,a.textContent);else if(Pe&&ve.hideText)x=F?r.jv:"";else{this.formattingProperties.values.wordWrap&&(x=(0,s.rP)(x));var We=(0,e.MN)(a.columnMetadata,x);if(We!==I.av.NONE)A=(0,s.RP)(this.formattingProperties.values.urlIcon,We),Le=(0,s.RD)(x,(0,M.HZ)(a.textContent),A,this.binderOptions.onHyperlinkClicked),He=void 0;else if(this.isImage(a)){var Ne=M.b$.encodeUriForImageDataSvg(a.textContent),xe=this.formattingProperties.grid;Le=(0,s.D2)(Ne,xe.imageHeight,xe.imageWidth,(0,M.HZ)(a.altText))}else this.isSparkline(a)&&(x=F?r.jv:"")}this.binderOptions.hyperlinksEnabled&&(Le||""!==x&&x!==r.jv)&&He&&(0,I.MN)(He)!==I.av.NONE&&(Le=(0,s.RD)(Le||x,(0,M.HZ)(He),null,this.binderOptions.onHyperlinkClicked,!0,!0));var Ie,ze,Me={tagName:"div",classNames:[],styleProperties:{},attributes:{}};if(Le?Me.children=[Le]:Me.content=x,Le=Me,Ce&&(Ie=this.getBodyCellFontInfo(a).measuredFontHeight,Me=(0,s.Ps)(Ce,Ie,Le,this.hostServices)),Pe&&!F&&(Me=(0,p.JF)(Me,ve,oe,a.dataPoint,this.hostServices)),!F&&this.isSparkline(a)&&(C.fF.assert(function(){return null!=V&&null!=K},"height and width should be defined for sparkline rendering"),Me=(0,u.MV)(Me,this.sparklineSettings[a.columnMetadata.queryName],oe,a.dataPoint,V,K,Ce,Ie)),this.isA11yMatrix&&(a.fontColor||a.backColor)){var Be=this.hostServices.getLocalizedString(r.Sl);_.isEmpty(Me.children)?Me={attributes:{},classNames:[],styleProperties:{},children:[Me,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Be}]}:Me.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Be})}if(this.isA11yMatrix&&!F&&this.selectionManager.isBodyCellIndicatorOn(a)){var De=this.formattingProperties.rowHeaders.steppedLayout,ke=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast&&(!De||De&&!this.formattingProperties.general.rowSubtotals)||De&&a.isRowGrandTotal,a.position.column.isFirst,a.position.column.isLast,!0,J.p0.Body),Ee=P&&this.selectionManager.isBodyCellIndicatorOn(P);ze={attributes:{},classNames:[],styleProperties:{width:"100%",top:ke.weightTop+"px",bottom:Ee?"0":ke.weightBottom+"px",left:ke.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},Me.content?Me={attributes:{},classNames:[],styleProperties:{},children:[Me,ze]}:(Me.children||(Me.children=[]),Me.children.push(ze))}return re&&(a.isGrandTotal?(Me.classNames.push(i.cy),Me.attributes[i.QZ]="".concat(1),a.isColumnGrandTotal?(Me.attributes[i.Ez]="".concat("total-column"),Me.attributes[i.CK]="Visual_TotalColumn"):(Me.attributes[i.Ez]="".concat("total-row"),Me.attributes[i.CK]="Visual_TotalRow")):(a.isRowSubTotal||a.isColumnSubTotal)&&(Me.classNames.push(i.cy),Me.attributes[i.QZ]="".concat(1),a.isColumnSubTotal?(Me.attributes[i.Ez]="".concat("subtotal-column"),Me.attributes[i.CK]="Visual_SubtotalColumn"):(Me.classNames.push(i.cy),Me.attributes[i.Ez]="".concat("subtotal-row"),Me.attributes[i.CK]="Visual_SubtotalRow"))),this.addBodyCellClasses(a,!!A,Le.classNames,Me.classNames),this.addBodyCellStyleAttributes(a,oe,Le.styleProperties,Me.styleProperties,K),Me},ae.prototype.getCornerCellBinding=function(a,F,V,K,X){var re=(0,M.HZ)(this.getCornerCellLabel(a)),P={},x=this.getCornerCellClasses(a);K&&(x.push(i.cy),P[i.Ez]="".concat("columnHeaders"),P[i.QZ]="".concat(1),P[i.CK]="Visual_Tablix_ColumnHeaders"),P.columnLevel=this.rowNavigator.getColumnLevel(a).toString(),P.rowLevel=this.rowNavigator.getRowLevel(a).toString(),this.formattingProperties.columnHeaders.wordWrap&&(re=(0,s.rP)(re)),_.isEmpty(re)&&(re=r.jv);var A=!_.isEmpty(re?.trim()),j=this.getCornerCellStyle(a,this.getCornerCellFontInfo(),F,A);if(a.position.row.isLast){var oe=this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(a),ce=this.sortingManager.getCornerSortDirection(a),Pe=(0,s.Km)(ce,this.binderOptions.sortIconEnabled,oe,ce??1,j.getExtraBottom(),this.glyphFontInfo.textProperties.fontSize,this.hostServices);re+=c.bG.build(Pe),j.paddings.bottom+=(0,s.tO)(this.glyphFontInfo.measuredFontHeight),1===ce?P["aria-sort"]="ascending":2===ce&&(P["aria-sort"]="descending")}return{content:re,classNames:x,styleProperties:j.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,X),attributes:P}},ae.prototype.getApproximateRowHeaderWidth=function(a){var F,V,K,X,j,re=this.rowNavigator.getRowHeaderMetadataColumn(a),P=this.getRowHeaderLabel(a),x=(0,e.MN)(re,P),A=this.rowHeaderFontInfo.fontProperties.size.px;if(x!==I.av.NONE&&(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,x))j=A;else if((0,e.Or)(a,re))j=this.formattingProperties.grid.imageWidth;else{var oe=this.getRowHeaderFontInfo(a),ce=this.getRowHeaderStyle(a,oe,!0,!0,void 0,void 0);j=(this.formattingProperties.rowHeaders.wordWrap?(0,s.JT)(P,oe.textProperties):(0,s.X1)(P,oe.textProperties))+(null!==(V=null===(F=ce.borders.left)||void 0===F?void 0:F.weight)&&void 0!==V?V:0)+(null!==(X=null===(K=ce.borders.right)||void 0===K?void 0:K.weight)&&void 0!==X?X:0)}var Ce=this.getRowsExpandCollapseButtonSize(a);return Ce>0&&(j+=Ce+s.s$),j},ae.prototype.getApproximateColumnHeaderWidth=function(a){var F,V,K,X,re=this.columnNavigator.getColumnHeaderMetadataColumn(a),P=this.getColumnHeaderLabel(a),x=(0,e.MN)(re,P);if(x!==I.av.NONE&&(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,x))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(a,re))return this.formattingProperties.grid.imageWidth;var A=this.getColumnHeaderFontInfo(a),j=this.getColumnHeaderStyle(a,A,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,s.JT)(P,A.textProperties):(0,s.X1)(P,A.textProperties))+(null!==(V=null===(F=j.borders.left)||void 0===F?void 0:F.weight)&&void 0!==V?V:0)+(null!==(X=null===(K=j.borders.right)||void 0===K?void 0:K.weight)&&void 0!==X?X:0)},ae.prototype.getApproximateBodyCellWidth=function(a){var F,V,K,X,re=0;if(a.icon){if(re=this.getBodyCellFontInfo(a).measuredFontHeight,"IconOnly"===a.icon.layout)return re;re+=s.MO}if(a.isKpi)return re+this.valueFontInfo.fontProperties.size.px;var P=a.columnMetadata&&this.columnsDataBarsSettings[a.columnMetadata.queryName];if(this.shouldApplyDataBars(P,a)&&P.hideText)return re;var x=this.getBodyCellContent(a);if(this.isUrlIcon(a,x))return re+this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return re+this.formattingProperties.grid.imageWidth;if(this.isSparkline(a))return re;var A=this.getBodyCellFontInfo(a),j=this.getBodyCellStyle(a,A,!0,!0);return re+(this.formattingProperties.values.wordWrap?(0,s.JT)(x,A.textProperties):(0,s.X1)(x,A.textProperties))+(null!==(V=null===(F=j.borders.left)||void 0===F?void 0:F.weight)&&void 0!==V?V:0)+(null!==(X=null===(K=j.borders.right)||void 0===K?void 0:K.weight)&&void 0!==X?X:0)},ae.prototype.getApproximateCornerCellWidth=function(a){var F,V,K,X,re=this.getCornerCellFontInfo(),P=this.getCornerCellStyle(a,re,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,s.JT)(this.getCornerCellLabel(a),re.textProperties):(0,s.X1)(this.getCornerCellLabel(a),re.textProperties))+(null!==(V=null===(F=P.borders.left)||void 0===F?void 0:F.weight)&&void 0!==V?V:0)+(null!==(X=null===(K=P.borders.right)||void 0===K?void 0:K.weight)&&void 0!==X?X:0)},ae.prototype.getApproximateRowHeaderHeight=function(a,F){var V,K,X,re,j,P=this.rowNavigator.getRowHeaderMetadataColumn(a),x=this.getRowHeaderLabel(a),A=(0,e.MN)(P,x),oe=this.getRowsExpandCollapseButtonSize(a);if(A!==I.av.NONE&&(0,s.RP)(this.formattingProperties.rowHeaders.urlIcon,A))j=this.rowHeaderFontInfo.fontProperties.size.px;else if((0,e.Or)(a,P))j=this.formattingProperties.grid.imageHeight;else{var ce,ve=this.getRowHeaderFontInfo(a);F-=this.getRowsExpandCollapseButtonSize(a);var Pe=this.getRowHeaderStyle(a,ve,!0,!0,void 0,void 0);ce=this.formattingProperties.rowHeaders.wordWrap?(0,s.do)(x,(0,s.x9)(F,Pe),ve.textProperties).length:1;var Fe=null!==(K=null===(V=Pe.borders.top)||void 0===V?void 0:V.weight)&&void 0!==K?K:0,Ce=null!==(re=null===(X=Pe.borders.bottom)||void 0===X?void 0:X.weight)&&void 0!==re?re:0;j=ve.measuredFontHeight*ce+Fe+Ce}return void 0===a.isCollapsed?j:Math.max(oe,j)},ae.prototype.getApproximateColumnHeaderHeight=function(a,F){var V,K,X,re,P=this.columnNavigator.getColumnHeaderMetadataColumn(a),x=this.getColumnHeaderLabel(a),A=(0,e.MN)(P,x);if(A!==I.av.NONE&&(0,s.RP)(this.formattingProperties.columnHeaders.urlIcon,A))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(a,P))return this.formattingProperties.grid.imageHeight;var j,oe=this.getColumnHeaderFontInfo(a),ce=this.getColumnHeaderStyle(a,oe,!0,!0);j=this.formattingProperties.columnHeaders.wordWrap?(0,s.do)(x,(0,s.x9)(F,ce),oe.textProperties).length:1;var ve=null!==(K=null===(V=ce.borders.top)||void 0===V?void 0:V.weight)&&void 0!==K?K:0,Pe=null!==(re=null===(X=ce.borders.bottom)||void 0===X?void 0:X.weight)&&void 0!==re?re:0;return oe.measuredFontHeight*j+ve+Pe},ae.prototype.getApproximateBodyCellHeight=function(a,F){var V,K,X,re,P=this.getBodyCellFontInfo(a);if(a.icon&&"IconOnly"===a.icon.layout)return P.measuredFontHeight;if(a.isKpi)return this.valueFontInfo.fontProperties.size.px;var x=this.getBodyCellContent(a);if(this.isUrlIcon(a,x))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(a))return P.measuredFontHeight;var A,j=this.getBodyCellStyle(a,P,!0,!0);this.formattingProperties.values.wordWrap&&null!=F?(a.icon&&(F-=P.measuredFontHeight+s.MO),A=(0,s.do)(x,(0,s.x9)(F,j),P.textProperties).length):A=1;var oe=null!==(K=null===(V=j.borders.top)||void 0===V?void 0:V.weight)&&void 0!==K?K:0,ce=null!==(re=null===(X=j.borders.bottom)||void 0===X?void 0:X.weight)&&void 0!==re?re:0;return P.measuredFontHeight*A+oe+ce},ae.prototype.getApproximateCornerCellHeight=function(a,F){var V,K,X,re,P,x=this.getCornerCellFontInfo(),A=this.getCornerCellStyle(a,x,!0,!0);P=this.formattingProperties.columnHeaders.wordWrap?(0,s.do)(this.getCornerCellLabel(a),(0,s.x9)(F,A),x.textProperties).length:1;var j=null!==(K=null===(V=A.borders.top)||void 0===V?void 0:V.weight)&&void 0!==K?K:0,oe=null!==(re=null===(X=A.borders.bottom)||void 0===X?void 0:X.weight)&&void 0!==re?re:0;return x.measuredFontHeight*P+j+oe},ae.prototype.blankRowsEnabled=function(){return this.formattingProperties.blankRows.showBlankRows},ae.prototype.getSectionProperties=function(a){var F;switch(a){case J.p0.Header:F=this.formattingProperties.columnHeaders;break;case J.p0.Body:F=this.formattingProperties.values;break;case J.p0.MatrixRowHeader:F=this.formattingProperties.rowHeaders;break;default:C.fF.assertNever(a)}return F},ae.prototype.getBorderInfo=function(a,F,V,K,X,re){var P,x,A,j,Fe,Ce,He,Le,We,Ne,xe,Me,oe=0,ce=0,ve=0,Pe=0,Ie=this.getSectionProperties(re),Oe=null!==(P=Ie.outlineWeight)&&void 0!==P?P:this.formattingProperties.grid.outlineWeight,Be=null!==(x=Ie.outlineColor)&&void 0!==x?x:this.formattingProperties.grid.outlineColor,ze=null===(A=this.formattingProperties.grid)||void 0===A?void 0:A.gridHorizontalColor,De=null===(j=this.formattingProperties.grid)||void 0===j?void 0:j.gridVerticalColor,Ae=(0,v.ok)("#FFFFFF",.7,ze),Te=(0,v.ok)("#FFFFFF",.7,De);return a&&(0,S.yo)(Ie.outline)&&(oe=Oe,Fe=e.Pb.Outline,We=Be),K&&(0,S.BK)(Ie.outline)?(ce=Oe,Ce=e.Pb.Outline,Ne=Be):!K&&this.formattingProperties.grid.gridVertical&&(ce=this.formattingProperties.grid.gridVerticalWeight,Ce=e.Pb.Gridline,Ne=this.selectionManager.isSelectionEmpty()?De:Te),F&&(0,S.mv)(Ie.outline)?(ve=Oe,He=e.Pb.Outline,xe=Be):!F&&this.formattingProperties.grid.gridHorizontal&&(ve=this.formattingProperties.grid.gridHorizontalWeight,He=e.Pb.Gridline,xe=X?ze:Ae),V&&(0,S.fs)(Ie.outline)&&(Pe=Oe,Le=e.Pb.Outline,Me=Be),{weightTop:oe,weightRight:ce,weightBottom:ve,weightLeft:Pe,typeTop:Fe,typeRight:Ce,typeBottom:He,typeLeft:Le,colorTop:We,colorRight:Ne,colorBottom:xe,colorLeft:Me}},ae.prototype.isUrlIcon=function(a,F){var V=(0,e.MN)(a.columnMetadata,F);return V!==I.av.NONE&&!!(0,s.RP)(this.formattingProperties.values.urlIcon,V)},ae.prototype.getColumnHeaderFontInfo=function(a){return w.hc.isNodeGrandTotal(a)?this.grandTotalColumnHeaderFontInfo:a.hasSubtotalStyle?this.subtotalColumnHeaderFontInfo:this.specificColumnHeaderFontInfo[a.queryName]||this.columnHeaderFontInfo},ae.prototype.getRowHeaderFontInfo=function(a){return w.hc.isNodeGrandTotal(a)?this.grandTotalRowHeaderFontInfo:a.hasSubtotalStyle?this.subtotalRowHeaderFontInfo:this.rowHeaderFontInfo},ae.prototype.getBodyCellFontInfo=function(a){return a.isColumnGrandTotal?this.columnGrandTotalFontInfo:a.isRowGrandTotal?this.rowGrandTotalFontInfo:a.isColumnSubTotal?this.columnSubtotalFontInfo:a.isRowSubTotal||a.hasSubtotalStyle?this.rowSubtotalFontInfo:this.valueFontInfo},ae.prototype.getCornerCellFontInfo=function(){return this.columnHeaderFontInfo},ae.prototype.addRowHeaderClasses=function(a,F,V,K){var re,X=this.formattingProperties.rowHeaders;if(V.push(X.wordWrap?s.n2:s.wV),F&&V.push(r.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&n.l.hasIdentity(a)&&K.push(s.VM),F&&(re=d.H.center),(0,s.aY)(X.alignment,V,re),this.isA11yMatrix){var P=this.formattingProperties.rowHeaders.steppedLayout;this.selectionManager.isRowHeaderHighlighted(a)?(this.selectionManager.isRowHeaderIndicatorOn(a,P)||this.selectionManager.isRowHeaderDarkened(a))&&K.push("cell-selected"):K.push("cell-unselected")}},ae.prototype.getColumnHeaderClasses=function(a,F){var V=[],K=this.formattingProperties.columnHeaders,X=this.formattingProperties.columnFormatting[a.queryName];F&&V.push(r.LU);var A,re=n.l.hasIdentity(a),P=this.sortingManager.isColumnHeaderSortable(a);return C.fF.assert(function(){return!(re&&P)},"getColumnHeaderClasses: header selectable and sortable"),this.binderOptions.interactivityIndicatorEnabled&&(this.binderOptions.selectionEnabled&&re&&!P||this.binderOptions.sortingEnabled&&P&&!re)&&V.push(s.VM),F&&(A=d.H.center),(0,s.aY)(X&&X.styleHeader&&X.alignment||K.alignment,V,A),this.isA11yMatrix&&(this.selectionManager.isColumnHeaderHighlighted(a)?(this.selectionManager.isColumnHeaderIndicatorOn(a)||this.selectionManager.isColumnHeaderDarkened(a))&&V.push("cell-selected"):V.push("cell-unselected")),V},ae.prototype.addBodyCellClasses=function(a,F,V,K){V.push(this.formattingProperties.values.wordWrap?s.n2:s.wV),F&&V.push(r.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&!a.isRowAndColumnGrandTotal&&!a.isBlankRow&&K.push(s.VM);var X,A,P=this.formattingProperties.columnFormatting[a.columnMetadata&&a.columnMetadata.queryName];P&&(a.isGrandTotal?P.styleTotal:a.hasSubtotalStyle?P.styleSubTotals:P.styleValues)&&(X=P.alignment),F?A=d.H.center:!a.isKpi&&a.isNumeric&&(A=d.H.right),(0,s.aY)(X,V,A),this.isA11yMatrix&&(this.selectionManager.isBodyCellHighlighted(a)?!this.selectionManager.isSelectionEmpty()&&this.selectionManager.isBodyCellHighlighted(a)&&K.push("cell-selected"):K.push("cell-unselected"))},ae.prototype.getCornerCellClasses=function(a){var F=[];F.push(this.formattingProperties.columnHeaders.wordWrap?s.n2:s.wV),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(a)&&F.push(s.VM);var V=this.formattingProperties.columnHeaders.titleAlignment;return V===d.H.auto&&(V=this.formattingProperties.columnHeaders.alignment),(0,s.aY)(V,F),F},ae.prototype.getSteppedLayoutIndentation=function(a){return this.rowNavigator.getLevel(a)*this.formattingProperties.rowHeaders.steppedLayoutIndentation},ae.prototype.getRowHeaderStyle=function(a,F,V,K,X,re){var j,P=re??a.position,x=new e.qZ(s.K2,s.K2);if(this.formattingProperties.rowHeaders.underline&&K&&(x.textDecoration=y.f0),P.column.isLast&&(x.borders.right=new e.om(g.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),x.fontColor=r.lN,this.formattingProperties.blankRows.showBlankRows){var oe=this.rowNavigator.getAncestor(a),ce=this.formattingProperties.general.layout===H.t.Compact?this.rowNavigator.getLeafIndex(oe):this.rowNavigator.getIndexOfFirstLeaf(oe);j=(P.row.index-ce)%2!=0}(0,l.B0)(P,X??a,x,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,this.formattingProperties.values.bandedRowHeaders,!!X,j),(0,s.Nk)(F,x,K);var ve=this.formattingProperties.columnFormatting[a.queryName],Pe=ve&&ve.styleHeader,Fe=w.hc.isNodeGrandTotal(a)&&this.formattingProperties.rowGrandTotal.applyToHeaders,Ce=a.hasSubtotalStyle&&this.formattingProperties.rowSubtotals.applyToHeaders;return Pe&&ve.fontColor?x.fontColor=ve.fontColor:Fe&&this.formattingProperties.rowGrandTotal.fontColor?x.fontColor=this.formattingProperties.rowGrandTotal.fontColor:Ce&&this.formattingProperties.rowSubtotals.fontColor&&(x.fontColor=this.formattingProperties.rowSubtotals.fontColor),Pe&&ve.backColor?x.backColor=ve.backColor:Fe&&this.formattingProperties.rowGrandTotal.backColor?x.backColor=this.formattingProperties.rowGrandTotal.backColor:Ce&&this.formattingProperties.rowSubtotals.backColor&&(x.backColor=this.formattingProperties.rowSubtotals.backColor),this.formattingProperties.rowHeaders.steppedLayout&&(x.paddings.left+=this.getSteppedLayoutIndentation(a)),x},ae.prototype.getRowHeaderStyleAttributes=function(a,F,V,K,X,re){return this.getRowHeaderStyle(a,this.getRowHeaderFontInfo(a),F,V,X,re).getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,K)},ae.prototype.getColumnHeaderStyle=function(a,F,V,K){var X=new e.qZ(s.K2,s.K2);a.position.row.isLast&&(X.borders.bottom=new e.om(g.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),X.fontColor=r.lN,(0,l.aV)(a.position,a,X,this.formattingProperties),(0,s.Nk)(F,X,K);var P=this.formattingProperties.columnFormatting[a.queryName],x=P&&P.styleHeader,A=w.hc.isNodeGrandTotal(a)&&this.formattingProperties.columnGrandTotal.applyToHeaders,j=a.hasSubtotalStyle&&this.formattingProperties.columnSubtotals.applyToHeaders;return x&&P.fontColor?X.fontColor=P.fontColor:A&&this.formattingProperties.columnGrandTotal.fontColor?X.fontColor=this.formattingProperties.columnGrandTotal.fontColor:j&&this.formattingProperties.columnSubtotals.fontColor&&(X.fontColor=this.formattingProperties.columnSubtotals.fontColor),x&&P.backColor?X.backColor=P.backColor:A&&this.formattingProperties.columnGrandTotal.backColor?X.backColor=this.formattingProperties.columnGrandTotal.backColor:j&&this.formattingProperties.columnSubtotals.backColor&&(X.backColor=this.formattingProperties.columnSubtotals.backColor),this.formattingProperties.columnHeaders.underline&&K&&(X.textDecoration=y.f0),X},ae.prototype.getColumnHeaderStyleAttributes=function(a,F,V){var K=F.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,V);return this.isA11yMatrix||this.selectionManager.isColumnHeaderHighlighted(a)||(0,s.CQ)(K),K},ae.prototype.getBodyCellStyle=function(a,F,V,K){var re,X=new e.qZ(s.K2,s.K2);if(this.formattingProperties.blankRows.showBlankRows){var P=this.rowNavigator.getAncestor(a.rowItem),x=this.formattingProperties.general.layout===H.t.Compact?this.rowNavigator.getLeafIndex(P):this.rowNavigator.getIndexOfFirstLeaf(P);re=(a.position.row.index-x)%2!=0}return(0,l.cP)(a.position,a,X,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,re),(0,s.Nk)(F,X,K),X},ae.prototype.addBodyCellStyleAttributes=function(a,F,V,K,X){F.setAttributes(K,!1,this.isA11yMatrix,this.isA11yMatrix,X),K.position="relative",this.isA11yMatrix||this.selectionManager.isBodyCellHighlighted(a)||(0,s.CQ)(K)},ae.prototype.getCornerCellStyle=function(a,F,V,K){var X=new e.qZ(s.K2,s.K2);return X.fontColor=r.lN,this.formattingProperties.columnHeaders.underline&&K&&(X.textDecoration=y.f0),a.position.row.isLast&&(X.borders.bottom=new e.om(g.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),(0,l.qW)(a.position,X,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties),(0,s.Nk)(F,X,K),X},ae.prototype.getColumnHeaderLabel=function(a){return this.getHeaderContent(a,this.columnNavigator.getColumnHeaderMetadataColumn(a),this.columnNavigator.isColumnHeaderMultiValueSubtotal(a),this.formattingProperties.columnHeaders.wordWrap)},ae.prototype.getRowHeaderLabel=function(a){return this.getHeaderContent(a,this.rowNavigator.getRowHeaderMetadataColumn(a),this.rowNavigator.isRowHeaderMultiValueSubtotal(a),this.formattingProperties.rowHeaders.wordWrap)},ae.prototype.getBodyCellContent=function(a){return this.formattingProperties.values.wordWrap?a.textContent:(0,ee.PC)(a.textContent)},ae.prototype.getCornerCellLabel=function(a){return this.formattingProperties.columnHeaders.wordWrap?a.displayName:(0,ee.PC)(a.displayName)},ae.prototype.getHeaderContent=function(a,F,V,K){if(a.isSubtotal&&!V){var X=this.formattingProperties.columnFormatting[F.queryName],re=X?X.subtotalLabel:this.binderOptions.defaultTotalLabel;return K?re:(0,ee.PC)(re)}var P=a.valueFormatted;return(0,s.jv)(F,P)?P:P&&(0,e.wX)(a,F,P)?M.b$.encodeUriForImageDataSvg(P):K?P:(0,ee.PC)(P)},ae.prototype.onDataViewChanged=function(a,F,V,K,X){var P,re=this;this.formattingProperties=F,this.legacyTooltipsEnabled=K,this.isExpandCollapseEnabled=!!X;var x=F.general.textSize,A=new s.Kq,j={},oe={},ce={};j.family=F.columnHeaders.fontFamily||r.F2,j.size=F.columnHeaders.fontSize||x,F.columnHeaders.bold&&(j.weight=y.en),F.columnHeaders.italic&&(j.style=y.BF),F.columnHeaders.underline&&(j.textDecoration=y.f0),this.columnHeaderFontInfo=(0,s.Od)(j,A),this.specificColumnHeaderFontInfo={};var ve=null===(P=this.formattingProperties.annotationFormatting)||void 0===P?void 0:P.columnHeaders;ve&&_.forEach(ve,function(ze,De){var Ae=(0,z.__assign)({},j);(ze.bold||F.columnHeaders.bold)&&(Ae.weight=y.en),re.specificColumnHeaderFontInfo[De]=(0,s.Od)(Ae,A)}),ce.family=F.rowHeaders.fontFamily||r.F2,ce.size=F.rowHeaders.fontSize||x,F.rowHeaders.bold&&(ce.weight=y.en),F.rowHeaders.italic&&(ce.style=y.BF),F.rowHeaders.underline&&(ce.textDecoration=y.f0),this.rowHeaderFontInfo=(0,s.Od)(ce,A),this.expandCollapseButtonFontInfo=(0,s.Od)({family:"PowrMDL2",size:F.rowHeaders.expandCollapseButtonsSize||this.rowHeaderFontInfo.fontProperties.size},A),oe.family=F.values.fontFamily||r.dG,oe.size=F.values.fontSize||x,F.values.bold&&(oe.weight=y.en),F.values.italic&&(oe.style=y.BF),F.values.underline&&(oe.textDecoration=y.f0),this.valueFontInfo=(0,s.Od)(oe,A),this.columnSubtotalFontInfo=this.getSubtotalFontInfo(F.columnSubtotals,A),this.rowSubtotalFontInfo=this.getSubtotalFontInfo(F.rowSubtotals,A),this.columnGrandTotalFontInfo=this.getGrandTotalFontInfo(F.columnGrandTotal,A,this.columnSubtotalFontInfo),this.rowGrandTotalFontInfo=this.getGrandTotalFontInfo(F.rowGrandTotal,A,this.rowSubtotalFontInfo);var Fe=this.columnHeaderFontInfo.fontProperties.family===r.F2,Ce=this.rowHeaderFontInfo.fontProperties.family===r.F2;this.subtotalColumnHeaderFontInfo=F.columnSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,s.TQ)(this.columnSubtotalFontInfo,{},A):(0,s.TQ)(this.columnHeaderFontInfo,ae.applyBold(Fe),A),this.subtotalRowHeaderFontInfo=F.rowSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,s.TQ)(this.rowSubtotalFontInfo,{},A):(0,s.TQ)(this.rowHeaderFontInfo,ae.applyBold(Ce),A),this.grandTotalColumnHeaderFontInfo=F.columnGrandTotal.applyToHeaders?(0,s.TQ)(this.columnGrandTotalFontInfo,{},A):(0,s.TQ)(this.columnHeaderFontInfo,ae.applyBold(Fe),A),this.grandTotalRowHeaderFontInfo=F.rowGrandTotal.applyToHeaders?(0,s.TQ)(this.rowGrandTotalFontInfo,{},A):(0,s.TQ)(this.rowHeaderFontInfo,ae.applyBold(Ce),A),this.glyphFontInfo=(0,s.Od)({family:r.Vz,size:B.B.createFromPt((F.columnHeaders.fontSize||x).pt*r.Yo),lineHeight:"100%"},A),A.measureAll(this.measureElement),this.columnsDataBarsSettings={};var He=F.columnFormatting;if(He&&a&&a.matrix&&!_.isEmpty(a.matrix.valueSources))for(var Le=0,We=a.matrix.valueSources;Le<We.length;Le++)(xe=(Ne=We[Le]).queryName)&&He[xe]&&(this.columnsDataBarsSettings[xe]=(0,p.az)(Ne,He[xe].dataBarsSettings,V));this.sparklineSettings={};var Me=F.sparklines;if(Me&&a&&a.matrix&&!_.isEmpty(a.matrix.valueSources))for(var Ie=0,Oe=a.matrix.valueSources;Ie<Oe.length;Ie++){var Ne,xe;(xe=(Ne=Oe[Ie]).queryName)&&Me[xe]&&(this.sparklineSettings[xe]=(0,u.wJ)(Me[xe],Ne.type,V))}},ae.prototype.getGrandTotalFontInfo=function(a,F,V){var K={},X=a.fontFamily;return K.family=X,K.size=a.fontSize,a.bold&&X&&(K.weight=y.en),a.italic&&(K.style=y.BF),a.underline&&(K.textDecoration=y.f0),(0,s.TQ)(V,K,F)},ae.prototype.shouldApplyDataBars=function(a,F){if(!a||!_.isNumber(F.dataPoint))return!1;var V=F.isTotal||F.hasSubtotalStyle;switch(a.totalMatching){case 0:return!0;case 1:case void 0:return!V;case 2:return V;default:return C.fF.assertNever(a.totalMatching),!V}},ae.prototype.isImage=function(a){return(0,ne.pt)(a.columnMetadata)},ae.prototype.isSparkline=function(a){var F,V=a.columnMetadata,K=null===(F=V?.type)||void 0===F?void 0:F.misc;return null!=K&&null!=K.sparkline},ae.applyBold=function(a){return{family:a?r.Zk:void 0,weight:a?void 0:y.en}},ae.prototype.getSubtotalFontInfo=function(a,F){var K,V=a.fontFamily;V||this.valueFontInfo.fontProperties.family!==r.dG?K=!0:this.valueFontInfo.fontProperties.family===r.dG&&(V=r.Zk);var X={};return X.family=V,X.size=a.fontSize,a.bold&&K&&(X.weight=y.en),a.italic&&(X.style=y.BF),a.underline&&(X.textDecoration=y.f0),(0,s.TQ)(this.valueFontInfo,X,F)},ae.prototype.setHorizontalBorderXPositions=function(a,F){var V="0",K="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[V,K];switch(F){case J.p0.Header:V="0",K="100%";break;case J.p0.Body:V=a.toString();break;case J.p0.MatrixRowHeader:V="0",K=a.toString();break;default:C.fF.assertFail("this should never be the case")}return[V,K]},ae.prototype.setVerticalBorderYPositions=function(a,F){var V="0",K="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[V,K];switch(F){case J.p0.Header:V="0",K="100%";break;case J.p0.Body:break;case J.p0.MatrixRowHeader:V="0",K=a.toString();break;default:C.fF.assertFail("this should never be the case")}return[V,K]},ae}(),b=U(31577),T=U(82386),R=U(59151),k=function(){function ae(a){this.hostServices=a}return ae.prototype.onDataViewChanged=function(a,F,V,K){this.columnHierarchy=a,this.valueSources=F,this.metatdataObjects=V,this.valuesOnRowApplied=K,this.hasColumnGrouping=(0,T.pr)(this.columnHierarchy)>0,this.hasMultiMeasureOnColumns=!_.isEmpty(this.valueSources)&&this.valueSources.length>1&&!this.valuesOnRowApplied,this.headerPendingChanges=[],this.cornerPendingChanges=[]},ae.prototype.getNodeSelector=function(a){if(C.fF.assertValue(a,"PivotTableSizeManager.getNodeSelector: header"),!this.hasColumnGrouping){if(a.queryName)return{metadata:a.queryName};if(this.valuesOnRowApplied)return null}for(var F={};a;){if(this.hasMultiMeasureOnColumns&&a.level===this.columnHierarchy.levels.length-1)F.metadata=a.queryName;else if(a.isSubtotal){for(var V=[],X=0,re=this.columnHierarchy.levels[a.level].sources;X<re.length;X++){var P=re[X];_.isEmpty(P.identityExprs)||V.push.apply(V,P.identityExprs||[])}_.isEmpty(V)||(F.data=[(0,b.ms)(V)])}else a.identity&&(F.data?F.data.splice(0,0,a.identity):F.data=[a.identity]);a=a.parent}return F},ae.prototype.getCornerSelector=function(a){if(C.fF.assertValue(a,"PivotTableSizeManager.getCornerSelector: corner"),a.metadata&&a.metadata.queryName)return{metadata:a.metadata.queryName}},ae.prototype.getHeaderPendingChange=function(a){return _.find(this.headerPendingChanges,function(F){return n.l.areHeadersEqual(F.cell,a)})},ae.prototype.getCornerPendingChange=function(a){return _.find(this.cornerPendingChanges,function(F){return n.l.areCornerItemsEqual(F.cell,a)})},ae.prototype.queueHeaderPendingChange=function(a,F){var V=this.getHeaderPendingChange(a);V?V.width=F:this.headerPendingChanges.push({cell:a,width:F})},ae.prototype.queueCornerPendingChange=function(a,F){var V=this.getCornerPendingChange(a);V?V.width=F:this.cornerPendingChanges.push({cell:a,width:F})},ae.prototype.getColumnWidth=function(a){C.fF.assertValue(a,"PivotTableSizeManager.getColumnWidth: header");var V,F=this.getHeaderPendingChange(a);return F?F.width:(this.hasColumnGrouping?V=a.objects:a.queryName?V=this.valueSources[a.levelSourceIndex||0].objects:this.valuesOnRowApplied&&(V=this.metatdataObjects),g.FX.PropColumnWidthValue.getValue(V))},ae.prototype.setColumnWidth=function(a,F){var V=this.getNodeSelector(a);this.queueHeaderPendingChange(a,F),(0,R.P)([{selector:V,value:F}],this.hostServices,!1)},ae.prototype.getRowHeight=function(a){},ae.prototype.setRowHeight=function(a,F){},ae.prototype.getRowLevelWidth=function(a){C.fF.assertValue(a,"PivotTableSizeManager.getRowLevelWidth: cornerCell");var F=this.getCornerPendingChange(a);return F?F.width:a.metadata&&a.metadata.objects?g.FX.PropColumnWidthValue.getValue(a.metadata.objects):void 0},ae.prototype.setRowLevelWidth=function(a,F){var V=this.getCornerSelector(a);V&&(this.queueCornerPendingChange(a,F),(0,R.P)([{selector:V,value:F}],this.hostServices,!1))},ae.prototype.getColumnLevelHeight=function(a){},ae.prototype.setColumnLevelHeight=function(a,F){},ae.prototype.setMissingWidths=function(a,F){for(var V=[],K=0,X=a;K<X.length;K++){var re=X[K],P=re.node,x=re.width;null==this.getColumnWidth(P)&&(this.queueHeaderPendingChange(P,x),V.push({selector:this.getNodeSelector(P),value:x}))}for(var A=0,j=F;A<j.length;A++){var oe=j[A],ce=oe.corner,ve=(x=oe.width,this.getCornerSelector(ce));ve&&null==this.getRowLevelWidth(ce)&&(this.queueCornerPendingChange(ce,x),V.push({selector:ve,value:x}))}_.isEmpty(V)||(0,R.P)(V,this.hostServices,!0)},ae.prototype.clearWidths=function(a,F){for(var V=[],K=0,X=a;K<X.length;K++){var re=X[K];null!=this.getColumnWidth(re)&&V.push({selector:this.getNodeSelector(re),value:void 0}),this.queueHeaderPendingChange(re,void 0)}for(var P=0,x=F;P<x.length;P++){var A=x[P];null!=this.getRowLevelWidth(A)&&V.push({selector:this.getCornerSelector(A),value:void 0}),this.queueCornerPendingChange(A,void 0)}_.isEmpty(V)||(0,R.P)(V,this.hostServices,!0)},ae}(),E=U(11184),ie=U(98094),le=U(48645),fe=U(86900),he=U(24133),Y=U(73889),de=U(74304),ge=U(40845),be=U(12913),me=function(){function ae(a,F){void 0===a&&(a=(0,q.DH)()),this.options=a,this.annotationHighlightElementToRegionIdMap=new Map,this.featureSwitches=F||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.showAsTableNativeMenuEnabled=this.options.showAsTableNativeMenuEnabled,this.tooltipType=0,this.asyncSerializer=new L.W,this.supportsOnObject=!!this.featureSwitches.onObject,this.enableCalculationHighlighting=!!this.featureSwitches.enableCalculationHighlighting,this.numFontDelays=0}return ae.prototype.init=function(a){var V,F=this;this.currentViewport=a.viewport,this.element=a.element,this.hostServices=a.host,this.waitingForData=!1,this.style=a.style,this.tablixPropertyManager=new de.U(this.style),this.selectionManager=new n.l(this.hostServices,this.featureSwitches),this.sortingManager=new h.S(this.hostServices),this.sizeManager=new k(this.hostServices),this.tooltipService=(0,t.r)(a.host),this.valueLabel=this.hostServices.getLocalizedString(r.yF),this.totalLabel=this.hostServices.getLocalizedString(r.qT);var X=(null===(V=this.hostServices)||void 0===V?void 0:V.getSubSelectionService())??fe.D.createWithDefaultHost(),re=new le.y(X);this.enableCalculationHighlighting&&(this.annotationHelper=i.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:re,targetSource:"annotation",scale:function(){return F.currentViewport.scale},customElementRegionOutlineIdCallback:function(x){return F.getAnnotationHighlightElementSubSelectionOutlineRegionId(x)},customScrollCallbacks:{onScrollStart:function(){return F.annotationHighlightOnScrollStart()},onScrollEnd:function(){return F.annotationHighlightOnScrollEnd()}}})),this.supportsOnObject&&(this.subSelectionHelper=i.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:re,targetSource:"format",scale:function(){return F.currentViewport.scale}}))},ae.prototype.update=function(a){return(0,z.__awaiter)(this,void 0,void 0,function(){var F=this;return(0,z.__generator)(this,function(V){switch(V.label){case 0:return[4,this.asyncSerializer.enqueue(function(){return(0,z.__awaiter)(F,void 0,void 0,function(){var K,X,re,P,x,A,j;return(0,z.__generator)(this,function(oe){switch(oe.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new ie.J(function(ce){return setTimeout(ce,500)})]:[3,2];case 1:return oe.sent(),this.numFontDelays++,[3,0];case 2:return a.type&ue.EP.Data?[4,this.onDataViewChanged(a.dataViews,a.operationKind,a.viewport)]:[3,4];case 3:oe.sent(),oe.label=4;case 4:return this.pivotTableControl&&a.type&ue.EP.Resize?(K=this.getVisibleRowStart(this.getPreviousVisibleRowStart(),!1),X=this.getVisibleColumnStart(this.getPreviousVisibleColumnStart()),this.pivotTableControl.setWidth(a.viewport.width),this.pivotTableControl.setHeight(a.viewport.height),[4,this.renderControl(J.BM.Incremental,K,X)]):[3,6];case 5:oe.sent(),oe.label=6;case 6:return this.supportsOnObject?a.formatMode===this.formatMode?[3,8]:(this.formatMode=a.formatMode,this.subSelectionHelper.setFormatMode(a.formatMode),a.formatMode?(this.element.get(0).setAttribute(i.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(i.y3),this.pivotTableControl&&this.pivotTableControl instanceof he.d?(this.pivotTableControl.getBinder().setFormatMode(a.formatMode),[4,this.pivotTableControl.renderAsync(J.BM.ClearRendering)]):[3,8]):[3,8];case 7:oe.sent(),oe.label=8;case 8:return this.enableCalculationHighlighting&&(this.allowAnnotationHighlights=a.allowAnnotationHighlights),re=a.type&ue.EP.Data||a.type&ue.EP.Resize||a.type&ue.EP.FormattingSubSelectionChange,P=a.type&ue.EP.FormattingSubSelectionChange,this.subSelectionHelper&&re&&(this.subSelectionHelper.updateOutlinesFromSubSelections(a.subSelections,!0),this.hostServices.alertScreenReader&&P&&(x=this.subSelectionHelper.getLabelsFromSubSelections(a.subSelections,["aria-label"]),(A=x?.length&&x.join(" "))&&this.hostServices.alertScreenReader(A))),j=a.type&ue.EP.Data||a.type&ue.EP.Resize,this.annotationHelper&&j&&this.allowAnnotationHighlights&&this.updateOutlinesFromAnnotations(),[2]}})})})];case 1:return V.sent(),[2]}})})},ae.prototype.hasNoColumnData=function(){var a,F,V,K,X=null===(K=null===(V=null===(F=null===(a=this.dataView)||void 0===a?void 0:a.matrix)||void 0===F?void 0:F.columns)||void 0===V?void 0:V.root)||void 0===K?void 0:K.children;return!X||!_.some(X,function(re){return!re?.isSubtotal})},ae.prototype.updatePersistedWidths=function(a){var F=g.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!F&&this.pivotTableControl){if(this.hasNoColumnData())return;for(var V=[],K=this.columnHierarchyNavigator.getHierarchyLeafNodes(),re=0,P=0,x=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();P<x.length;P++)for(var oe=0,ce=x[P].getColumnWidths();oe<ce.length;oe++)V.push({node:K[re],width:ce[oe]}),re++;for(var Pe=[],Fe=this.rowHierarchyNavigator.getHierarchyDepth(),Ce=this.columnHierarchyNavigator.getHierarchyDepth(),He=0;He<Fe;He++)Pe.push({corner:this.rowHierarchyNavigator.getCorner(He,Ce-1),width:this.pivotTableControl.getRowLevelWidthMeasureManager().getLevelWidth(He)});this.sizeManager.setMissingWidths(V,Pe)}else if(F&&a&&a.metadata&&a.metadata.objects&&!g.FX.PropColumnPivotTableAutoSizeColumns.getValue(a.metadata.objects)){K=this.columnHierarchyNavigator.getHierarchyLeafNodes();var Le=[];for(Fe=this.rowHierarchyNavigator.getHierarchyDepth(),Ce=this.columnHierarchyNavigator.getHierarchyDepth(),He=0;He<Fe;He++)Le.push(this.rowHierarchyNavigator.getCorner(He,Ce-1));this.sizeManager.clearWidths(K,Le)}},ae.prototype.onDataViewChanged=function(a,F,V){return(0,z.__awaiter)(this,void 0,void 0,function(){var K,X,re,P=this;return(0,z.__generator)(this,function(x){switch(x.label){case 0:return this.setExpandCollapseEnabled(),_.isEmpty(a)?[3,5]:(K=this.dataView,this.dataView=a[0],X=!this.dataView.metadata.segment,this.formattingProperties=this.tablixPropertyManager.getPivotTableObjects(this.dataView,function(A){for(var j,oe=[],ce=1;ce<arguments.length;ce++)oe[ce-1]=arguments[ce];return(j=P.hostServices).getLocalizedString.apply(j,(0,z.__spreadArray)([A],oe||[],!1))},this.expandCollapseEnabled,this.style,this.featureSwitches,this.featureSwitches.enableCalculationHighlighting),this.formatters=this.formattingProperties.formatters,this.tooltipFormatters=this.formattingProperties.tooltipFormatters,re=this.shouldApplyValuesOnRow(),F!==ue.su.Append?[3,2]:[4,this.onAppendDataView(K,re,X)]);case 1:return x.sent(),[3,4];case 2:return[4,this.onNewDataView(K,V,re,X)];case 3:x.sent(),x.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),x.label=6;case 6:return this.waitingForData=!1,[2]}})})},ae.prototype.destroy=function(){var a;null===(a=this.pivotTableControl)||void 0===a||a.destroy()},ae.prototype.onAppendDataView=function(a,F,V){return(0,z.__awaiter)(this,void 0,void 0,function(){var K,X,re,P,x,A;return(0,z.__generator)(this,function(j){switch(j.label){case 0:return this.pivotTableControl.setUnfrozenRowHeaders(g.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(g.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),K=this.rowHierarchyNavigator.getHierarchyLeafCount(),X=this.getPreviousVisibleRowStart(),re=this.getPreviousVisibleColumnStart(),this.updateHierarchyNavigators(this.formattingProperties.rowHeaders.steppedLayout,F,this.formattingProperties.subtotals.rowSubtotalsPosition===ge.we,V,a.matrix.rows.root!==this.dataView.matrix.rows.root),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),P=this.formattingProperties.rowHeaders.steppedLayout,x=this.matrixNavigator.getColumnHierarchy(),A=this.matrixNavigator.getValueSources(),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),x,A,P,F),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),K>this.rowHierarchyNavigator.getHierarchyLeafCount()||!_.isEqual(a.metadata.columns,this.dataView.metadata.columns)?[4,this.renderControl(J.BM.ClearMeasurement,this.getVisibleRowStart(X,!1),this.getVisibleColumnStart(re))]:[3,2];case 1:return j.sent(),[3,4];case 2:return[4,this.renderControl(J.BM.ClearRendering,null,null)];case 3:j.sent(),j.label=4;case 4:return[2]}})})},ae.prototype.onNewDataView=function(a,F,V,K){return(0,z.__awaiter)(this,void 0,void 0,function(){var X,re,P,x,A,j;return(0,z.__generator)(this,function(ce){switch(ce.label){case 0:return X=this.formattingProperties.rowHeaders.steppedLayout,re=this.getPreviousVisibleRowStart(),P=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(X,V,this.formattingProperties.subtotals.rowSubtotalsPosition===ge.we,K,this.formattingProperties.rowHeaders.expandCompositeHierarchy),this.pivotTableControl.setUnfrozenRowHeaders(g.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(g.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),x=this.matrixNavigator.getColumnHierarchy(),A=this.matrixNavigator.getValueSources(),this.sizeManager.onDataViewChanged(x,A,this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,V),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),x,A,X,V),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(F.width),this.pivotTableControl.setHeight(F.height),j=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&j&&j.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.onDataViewChanged(this.dataView,this.formattingProperties,this.style,0===this.tooltipType,this.expandCollapseEnabled&&"interactive"===this.options.expandCollapse.buttonsOption),[4,this.renderControl(J.BM.ClearMeasurement,this.getVisibleRowStart(re,h.S.hasSortingChanged(a,this.dataView)),this.getVisibleColumnStart(P))];case 1:return ce.sent(),this.updatePersistedWidths(a),[2]}})})},ae.prototype.onVerticalScrollButtonClick=function(a,F){var V=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(a),this.getScrollRowIndex(F));this.hostServices.alertScreenReader(V)},ae.prototype.onHorizontalScrollButtonClick=function(a,F){var V=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(a),this.getScrollColumnIndex(F));this.hostServices.alertScreenReader(V)},ae.prototype.getScrollRowIndex=function(a){return 0===a?1:this.pivotTableControl.getMidRenderer().getAriaRowIndex(a)},ae.prototype.getScrollColumnIndex=function(a){return 0===a?1:this.pivotTableControl.getMidRenderer().getAriaColIndex(a,!1)},ae.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},ae.prototype.onRestoreSelection=function(a){var F=this.selectionManager.restoreSelectionState(a.selection,this.matrixNavigator);return this.renderSelection(),F},ae.prototype.shouldApplyValuesOnRow=function(){var a=this.dataView.matrix,F=a.valueSources,V=a.columns.levels;if(_.isEmpty(V))return!1;var K=V[0].sources;return this.formattingProperties.values.valuesOnRow&&F.length>1&&!(_.find(K,function(X){return X.isMeasure})&&_.find(K,function(X){return!X.isMeasure}))},ae.prototype.updateHierarchyNavigators=function(a,F,V,K,X){this.matrixNavigator.update(this.dataView.matrix,a,F,V,K,X,this.formatters,this.tooltipFormatters,this.getSubtotalByColumn(),this.formattingProperties.subtotals.rowSubtotalsPosition,this.featureSwitches.matrixLayouts?this.formattingProperties.general.layout:void 0,this.formattingProperties.blankRows.showBlankRows),this.rowHierarchyNavigator.setHierarchy(this.matrixNavigator.getRowHierarchy()),this.columnHierarchyNavigator.setHierarchy(this.matrixNavigator.getColumnHierarchy())},ae.prototype.getSubtotalByColumn=function(){for(var a={},F=this.dataView.metadata.objects,V=g.FX.PropSubTotalsPivotTableRowSubtotals.getValue(F),K=g.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(F),X=g.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(F),re=g.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(F),P=0,x=this.dataView.metadata.columns;P<x.length;P++){var A=x[P],j=void 0,oe=void 0;if(A.roles){if(A.roles[O.r.rows])j=V,oe=K;else{if(!A.roles[O.r.columns])continue;j=X,oe=re}a[A.queryName]=j&&(!oe||g.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.getValue(A.objects))}}return a},ae.prototype.renderControl=function(a,F,V){return this.pivotTableControl.renderAsync(a,F,V)},ae.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleRowStart();if(!a)return null;var F=this.rowHierarchyNavigator.getHierarchyLeafAt(a.rowIndex);return F?{item:F,offset:a.visibleHeight}:null}},ae.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleColumnStart();if(!a)return null;var F=this.columnHierarchyNavigator.getHierarchyLeafAt(a.columnIndex);return F?{item:F,offset:a.visibleWidth}:null}},ae.prototype.getSubSelectionShortcuts=function(a){if(this.supportsOnObject)for(var X=0,re=_.first(a).visualObjects;X<re.length;X++){var P=re[X];switch(_.isEmpty(P.selectorsByColumn)||(0,G.tV)(P.selectorsByColumn),P.objectName){case"columnHeaders":return[{type:0},(0,z.__assign)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Column_Subtotals")},f.t.subTotals.columnSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"rowHeaders":return[{type:0,excludedResetFormattingIds:[f.t.rowHeaders.showExpandCollapseButtons,f.t.subTotals.rowSubtotals]},(0,z.__assign)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_ExpandCollapse")},f.t.rowHeaders.showExpandCollapseButtons),(0,z.__assign)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Row_Subtotals")},f.t.subTotals.rowSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowHeaders"),groupUid:"".concat("rowHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Row_Headers")}];case"subtotal-row":return[{type:0},(0,z.__assign)({type:3,label:this.hostServices.getLocalizedString("Visual_Position")},f.t.subTotals.rowSubtotalsPosition),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotals")}];case"subtotal-row-labels":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotal_Label")}];case"subtotal-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnSubTotal")},label:this.hostServices.getLocalizedString("Format_Column_Subtotals")}];case"total-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnTotal"),groupUid:"".concat("columnTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}];case"total-row":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowTotal"),groupUid:"".concat("rowTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}]}}},ae.prototype.getSubSelectionStyles=function(a){if(this.supportsOnObject){var K,X,V=_.first(a).visualObjects;if(!(V.length>0))return;switch(K=V[0],_.isEmpty(K.selectorsByColumn)||(X=(0,G.tV)(K.selectorsByColumn)),K.objectName){case"columnHeaders":var re=(0,pe.RM)(this.hostServices,{boldReference:f.t.columnHeaders.bold,italicReference:f.t.columnHeaders.italic,underlineReference:f.t.columnHeaders.underline,fontColorReference:f.t.columnHeaders.fontColor,fontFamilyReference:f.t.columnHeaders.fontFamily,fontSizeReference:f.t.columnHeaders.fontSize,backgroundReference:f.t.columnHeaders.backColor,horizontalAlignmentReference:f.t.columnHeaders.alignment,wordWrapReference:f.t.columnHeaders.wordWrap});return(0,z.__assign)({type:1},re);case"rowHeaders":var P=(0,pe.RM)(this.hostServices,{boldReference:f.t.rowHeaders.bold,italicReference:f.t.rowHeaders.italic,underlineReference:f.t.rowHeaders.underline,fontColorReference:f.t.rowHeaders.fontColor,fontFamilyReference:f.t.rowHeaders.fontFamily,fontSizeReference:f.t.rowHeaders.fontSize,backgroundReference:f.t.rowHeaders.backColor,horizontalAlignmentReference:f.t.rowHeaders.alignment,wordWrapReference:f.t.rowHeaders.wordWrap});return(0,z.__assign)({type:1},P);case"subtotal-row":X={id:"Row"};var x=(0,pe.RM)(this.hostServices,{boldReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.bold),{selector:X}),italicReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.italic),{selector:X}),underlineReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.underline),{selector:X}),fontColorReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontColor),{selector:X}),fontFamilyReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontFamily),{selector:X}),fontSizeReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontSize),{selector:X}),backgroundReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.backColor),{selector:X})});return(0,z.__assign)({type:1},x);case"subtotal-column":X={id:"Column"};var A=(0,pe.RM)(this.hostServices,{boldReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.bold),{selector:X}),italicReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.italic),{selector:X}),underlineReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.underline),{selector:X}),fontColorReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontColor),{selector:X}),fontFamilyReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontFamily),{selector:X}),fontSizeReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.fontSize),{selector:X}),backgroundReference:(0,z.__assign)((0,z.__assign)({},f.t.subTotals.backColor),{selector:X})});return(0,z.__assign)({type:1},A);case"total-column":var j=(0,pe.RM)(this.hostServices,{boldReference:f.t.columnTotal.bold,italicReference:f.t.columnTotal.italic,underlineReference:f.t.columnTotal.underline,fontColorReference:f.t.columnTotal.fontColor,fontFamilyReference:f.t.columnTotal.fontFamily,fontSizeReference:f.t.columnTotal.fontSize,backgroundReference:f.t.columnTotal.backColor});return(0,z.__assign)({type:1},j);case"total-row":var oe=(0,pe.RM)(this.hostServices,{boldReference:f.t.rowTotal.bold,italicReference:f.t.rowTotal.italic,underlineReference:f.t.rowTotal.underline,fontColorReference:f.t.rowTotal.fontColor,fontFamilyReference:f.t.rowTotal.fontFamily,fontSizeReference:f.t.rowTotal.fontSize,backgroundReference:f.t.rowTotal.backColor});return(0,z.__assign)({type:1},oe)}}},ae.prototype.getVisibleRowStart=function(a,F){if(!a||0===this.pivotTableControl.getViewport().top)return null;if(F)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var V=n.l.getMatchingHeader(a.item,this.rowHierarchyNavigator.getHierarchyItems());if(!V)return null;var K=this.rowHierarchyNavigator.getLeafIndex(V);return void 0===K?null:{rowIndex:K,visibleHeight:a.offset}},ae.prototype.getVisibleColumnStart=function(a){if(!a||0===this.pivotTableControl.getViewport().left)return null;var F=n.l.getMatchingHeader(a.item,this.columnHierarchyNavigator.getHierarchyItems());return F&&this.columnHierarchyNavigator.isLeaf(F)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(F),visibleWidth:a.offset}:null},ae.prototype.renderSelection=function(){this.pivotTableControl.renderAsync(J.BM.ClearRendering).catch(function(a){return be.f.error(a)})},ae.prototype.createOrUpdateControlAndNavigators=function(a,F,V,K,X){var re=this,P=this.hostServices.getLocalizedString("ListJoin_Separator");if(this.matrixNavigator||(this.matrixNavigator=new w.hc(P,this.tablixPropertyManager.tablixProperties,this.hostServices,X,this.isModernRowHeaderStyle())),this.rowHierarchyNavigator?a?this.rowHierarchyNavigator instanceof E.S||(this.rowHierarchyNavigator=new E.S(this.matrixNavigator)):this.rowHierarchyNavigator instanceof E.S&&(this.rowHierarchyNavigator=new E.Q(this.matrixNavigator)):(this.rowHierarchyNavigator=a?new E.S(this.matrixNavigator):new E.Q(this.matrixNavigator),this.columnHierarchyNavigator=new E.Q(this.matrixNavigator)),this.updateHierarchyNavigators(a,F,V,K,!0),this.pivotTableControl)this.pivotTableControl.getSteppedLayout()!==a&&this.switchRowHeadersLayout(a);else{var x={onBindRowHeader:function(ce){re.onBindRowHeader(ce)},onHyperlinkClicked:function(ce,ve){return re.onHyperlinkClicked(ce,ve)},onRowHeaderExpansionChange:function(ce,ve){return re.onHeaderExpansionChange(ce,[O.r.rows],ve)},defaultTotalLabel:this.totalLabel,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties},A=document.createElement("div");A.className="pivotTableContainer",this.element.append(A),this.binder=new m(x,this.selectionManager,this.sortingManager,this.hostServices,A,!0);var j=this.supportsOnObject;this.pivotTableControl=new he.d(A,this.sizeManager,this.createControlOptions(),!1,!0,j,this.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,void 0,void 0,this.showAsTableNativeMenuEnabled),this.pivotTableControl.setClassName("pivotTable"),this.switchRowHeadersLayout(a),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.binder.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},ae.prototype.isModernRowHeaderStyle=function(){var a;return!(!this.featureSwitches.matrixLayouts||null===(a=this.formattingProperties.rowHeaders)||void 0===a||!a.legacyStyleDisabled)},ae.prototype.createControlOptions=function(){var a=this,F=this.options.scrolling.enabled,V=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=new N(this.tooltipService,this.selectionManager,this.valueLabel,this.totalLabel));var K=this.interactionManager,X="interactive"===this.options.expandCollapse.buttonsOption,P=null;K&&(P=K.getHandlerTop());var x=null;return K&&(x=K.getHandlerMidOrBot()),this.options.selection.enabled?{rowHeaderClickHandler:function(oe,ce){return!a.formatMode&&a.onItemClick(oe,ce,n.D.RowHeader)},rowHeaderContextMenuHandler:function(oe,ce){return!a.formatMode&&a.onItemContextMenu(oe,n.D.RowHeader,ce,O.r.rows)},rowHeaderInteractionHandler:null,rowHeaderFocusHandler:function(oe){return a.onRowHeaderFocus(oe)},rowHeaderExpandCollapseHandler:X?function(j,oe){return a.onHeaderExpansionChange(j,[O.r.rows],oe)}:null,columnHeaderClickHandler:function(oe,ce){return!a.formatMode&&a.onItemClick(oe,ce,n.D.ColumnHeader)},columnHeaderContextMenuHandler:function(oe,ce){return!a.formatMode&&a.onItemContextMenu(oe,n.D.ColumnHeader,ce,O.r.columns)},columnHeaderInteractionHandler:this.formatMode?null:P,columnHeaderFocusHandler:function(oe){return a.onColumnHeaderFocus(oe)},bodyCellClickHandler:function(oe,ce){return!a.formatMode&&a.onItemClick(oe,ce,n.D.BodyCell)},bodyCellContextMenuHandler:function(oe,ce){return!a.formatMode&&a.onItemContextMenu(oe,n.D.BodyCell,ce,O.r.values)},bodyCellInteractionHandler:this.formatMode?null:x,bodyCellFocusHandler:function(oe){return null},cornerCellClickHandler:function(oe,ce){return!a.formatMode&&a.onCornerCellClick(oe,ce)},cornerCellContextMenuHandler:function(oe,ce){return!a.formatMode&&a.onCornerCellContextMenu(oe,ce)},cornerCellInteractionHandler:null,cornerCellFocusHandler:function(oe){return a.onCornerCellFocus(oe)},cellContentActivationHandler:function(oe,ce){return!a.formatMode&&a.onContentActivation(oe,ce)},whitespaceClickHandler:function(oe,ce){return!a.formatMode&&a.onWhitespaceClick(ce)},scrollingEnabled:F,columnResizingEnabled:V,rowLevelResizingEnabled:V,onScroll:function(){return a.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:X?function(j,oe){return a.onHeaderExpansionChange(j,[O.r.rows],oe)}:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:P,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:x,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:F,columnResizingEnabled:V,rowLevelResizingEnabled:V,onScroll:function(){return a.onScroll()}}},ae.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip(),this.supportsOnObject&&this.subSelectionHelper&&this.formatMode&&(this.subSelectionHelper.onVisualScroll(),this.subSelectionHelper.clearHoveredOutline()),this.enableCalculationHighlighting&&this.annotationHelper&&this.allowAnnotationHighlights&&this.annotationHelper.onVisualScroll()},ae.prototype.onWhitespaceClick=function(a){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),a){var F=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(F)}},ae.prototype.onHyperlinkClicked=function(a,F){this.hostServices.onHyperlinkClick(a,F)},ae.prototype.onItemClick=function(a,F,V){if(!this.selectionManager.isDrillingEnabled(a,F,V))if(V===n.D.ColumnHeader&&this.sortingManager.isColumnHeaderSortable(a))this.options.sorting.enabled&&this.sortingManager.sortColumnHeader(a);else{var K=n.l.getMatchingItem(a,V,this.rowHierarchyNavigator.getHierarchyItems(),this.columnHierarchyNavigator.getHierarchyItems(),this.rowHierarchyNavigator),X=W.M.isCtrlOrMeta(F)||1===this.hostServices.dataMultiSelectMode()?3:0;K&&(this.selectionManager.select(K,V,X),this.renderSelection())}},ae.prototype.onRowHeaderFocus=function(a){(0,o.MX)(a,this.valueLabel,!1,this.totalLabel);var V=[],K=this.rowHierarchyNavigator.getExpansionState(a);if(!this.pivotTableControl.getSteppedLayout()&&1!==K){var X=this.rowHierarchyNavigator.getNodeLeafCount(a);X>1&&V.push(this.hostServices.getLocalizedString("SpansXRows",X))}if(this.rowHierarchyNavigator.isMultiLevelHierarchy()){var re=this.getHierarchyLevelInfo(a);V.push(re)}if(this.rowHierarchyNavigator.getLevel(a)>0){var P=this.rowHierarchyNavigator.getParent(a).children.length,x=this.rowHierarchyNavigator.getIndex(a)+1;this.pivotTableControl.getSteppedLayout()&&(P-=1,x-=1),V.push(this.hostServices.getLocalizedString("Generic_ListPosition",x,P))}this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]},V))},ae.prototype.onColumnHeaderFocus=function(a){(0,o.MX)(a,this.valueLabel,!1,this.totalLabel);var V=[],K=this.columnHierarchyNavigator.getNodeLeafCount(a);if(K>1&&V.push(this.hostServices.getLocalizedString("SpansXColumns",K)),this.columnHierarchyNavigator.isMultiLevelHierarchy()){var X=this.getHierarchyLevelInfo(a);V.push(X)}if(this.columnHierarchyNavigator.getLevel(a)>0){var re=this.columnHierarchyNavigator.getParent(a).children.length,P=this.columnHierarchyNavigator.getIndex(a)+1;V.push(this.hostServices.getLocalizedString("Generic_ListPosition",P,re))}this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]},V))},ae.prototype.onHeaderExpansionChange=function(a,F,V){var K=this.selectionManager.createSelectorsByColumn(a),X=this.selectionManager.getHierarchyNodeIndex(a);this.hostServices.setNodeExpansionState({dataRoles:F,data:K,isCollapse:V,nodeIndex:X})},ae.prototype.onItemContextMenu=function(a,F,V,K){var X;V.stopPropagation(),V.preventDefault(),this.selectionManager.onItemContextMenu(a,F,V,[K],g.FX.PropUnfrozenRowHeaders.getValue(null===(X=this.dataView)||void 0===X?void 0:X.metadata.objects))},ae.prototype.onCornerCellClick=function(a,F){this.options.sorting.enabled&&this.sortingManager.isCornerSortable(a)&&this.sortingManager.sortCorner(a)},ae.prototype.onCornerCellContextMenu=function(a,F){},ae.prototype.onCornerCellFocus=function(a){(0,o.p_)(a),this.hostServices.alertScreenReader((0,o.IP)({displayNameParts:[],valueParts:[]}))},ae.prototype.onContentActivation=function(a,F){C.fF.assertValue(a,"onContentActivated - null cellElement");var V=a.querySelector("a");V&&V.dispatchEvent(F)},ae.prototype.switchRowHeadersLayout=function(a){this.pivotTableControl.setSteppedLayout(a),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.binder.setRowNavigator(this.rowHierarchyNavigator)},ae.prototype.onBindRowHeader=function(a){this.needsMoreData(a)&&(setTimeout(this.hostServices.loadMoreData),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},ae.prototype.needsMoreData=function(a){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var V=this.rowHierarchyNavigator.getHierarchyLeafCount()*ae.preferredLoadMoreThreshold;return this.rowHierarchyNavigator.getLeafIndex(a)>=V},ae.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,Y.Y.PivotTable,this.expandCollapseEnabled,this.featureSwitches,this.style)},ae.prototype.enumerateObjectInstances=function(a){var F=this,V=new te.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(a,V,this.dataView,Y.Y.PivotTable,function(K){for(var X,re=[],P=1;P<arguments.length;P++)re[P-1]=arguments[P];return(X=F.hostServices).getLocalizedString.apply(X,(0,z.__spreadArray)([K],re||[],!1))},this.featureSwitches,this.expandCollapseEnabled,this.style),V.complete()},ae.prototype.enumerateObjectRepetition=function(){var a=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(a,this.dataView,Y.Y.PivotTable,this.featureSwitches),a},ae.prototype.getHierarchyLevelInfo=function(a){return"".concat(this.hostServices.getLocalizedString("Level")," ").concat(this.rowHierarchyNavigator.getLevel(a)+1)},ae.prototype.setExpandCollapseEnabled=function(){this.expandCollapseEnabled=this.hostServices.canExpandCollapse([O.r.rows])&&"hidden"!==this.options.expandCollapse.buttonsOption},ae.prototype.getSubSelectables=function(a){return this.subSelectionHelper.getAllSubSelectables(a)},ae.prototype.updateOutlinesFromAnnotations=function(){var a=this;this.annotationHighlightElementToRegionIdMap.clear(),this.annotationHelper.hideAllOutlines(!0);var F=function(ae){var a;if(ae){var F={};return _.forEach(null===(a=ae.metadata)||void 0===a?void 0:a.columns,function(V){var K;if(null!==(K=V.objects)&&void 0!==K&&K.annotations){var X=V.queryName,re=(0,se.NA)(V.objects,f.t.annotations.highlights);X&&re&&(F[X]=re)}}),F}}(this.dataView);if(_.isEmpty(F))this.annotationHelper.renderOutlines();else{var V=this.pivotTableControl,K=V.getViewport(),X=Z.sW.getVisibleRange(K.left,K.width,V.getColumnWidthMeasureManager());if(X){var re=Z._E.getVisibleRange(K.top,K.height,V.getRowHeightMeasureManager());if(re){var P=V.getMidRenderer(),A=function(ae,a,F,V){for(var K,X=new Set(ae),re={},P=a.firstLeafIndex;P<=a.lastLeafIndex;P++)for(var x=F.firstLeafIndex;x<=F.lastLeafIndex;x++){var A=V.getElementByIndex(x,P,J.aP.Main);if(A){var j=V.getItemByElement(A),oe=null===(K=j?.columnMetadata)||void 0===K?void 0:K.queryName;if(oe&&X.has(oe)){var ce=re[oe];null==ce&&(re[oe]=ce=[]),ce.push(A)}}}return re}(_.keys(F),X,re,P);_.forEach(A,function(j,oe){_.forEach(j,function(Pe){a.annotationHighlightElementToRegionIdMap.set(Pe,"".concat("fullColumn","_").concat(oe))});var ce={showHandles:!1,thickness:2},ve=F[oe].color;ve&&(ce.color=ve),a.annotationHelper.updateOutlinesFromSubSelectionElements(j,2,ce)}),this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}},ae.prototype.getAnnotationHighlightElementSubSelectionOutlineRegionId=function(a){var F=this.annotationHighlightElementToRegionIdMap.get(a);return C.fF.assert(function(){return null!=F},"the given element should have an entry in this.annotationHighlightElementToRegionIdMap"),F},ae.prototype.annotationHighlightOnScrollStart=function(){this.annotationHelper.hideAllOutlines()},ae.prototype.annotationHighlightOnScrollEnd=function(){this.updateOutlinesFromAnnotations()},ae.preferredLoadMoreThreshold=.8,ae}()},11184:function(_e,Se,U){U.d(Se,{Q:function(){return ue},S:function(){return J}});var z=U(81337),pe=U(55007),se=U(62458),ue=function(){function L(W){this.matrixNavigator=W}return L.prototype.setHierarchy=function(W){this.hierarchy=W,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},L.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},L.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},L.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},L.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},L.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},L.prototype.getHierarchyLeafAt=function(W){return this.hierarchy.leafNodes[W]},L.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},L.prototype.getFloatingHierarchyLeafAt=function(W){return this.floatingLeaves[W]},L.prototype.isBlank=function(W){return W.isBlankRow},L.prototype.isBlankRow=function(W){return this.getHierarchyLeafAt(W).isBlankRow},L.prototype.numberOfBlankRowsBefore=function(W){var Z=this.getHierarchyLeafAt(W),G=this.getAncestor(Z);return Math.floor(G.index/2)},L.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},L.prototype.getFloatingHierarchyItems=function(){return null},L.prototype.getLeafIndex=function(W){return this.matrixNavigator.getLeafIndex(W)},L.prototype.isLeaf=function(W){return this.matrixNavigator.isLeaf(W)},L.prototype.isLastItem=function(W,Z){return this.matrixNavigator.isLastItem(W,Z)},L.prototype.getAncestor=function(W){for(;W.parent;)W=W.parent;return W},L.prototype.getParent=function(W){return this.matrixNavigator.getParent(W)},L.prototype.getIndex=function(W){return this.matrixNavigator.getIndex(W)},L.prototype.getNodeLeafCount=function(W){var Z=this;return this.isLeaf(W)?1:_.sum(_.map(W.children,function(G){return Z.getNodeLeafCount(G)}))},L.prototype.getIndexOfFirstLeaf=function(W){for(;!_.isEmpty(W.children);)W=W.children[0];return this.getLeafIndex(W)},L.prototype.getPathIndices=function(W){for(var Z=[this.getIndex(W)],G=this.getParent(W);G;)Z=(0,z.__spreadArray)([this.getIndex(G)],Z||[],!0),G=this.getParent(G);return Z},L.prototype.getNodeFromPath=function(W){var Z=this.hierarchy.levels.length||1;if(!(_.isEmpty(W)||W.length>Z)){for(var G=this.hierarchy.root,q=0,t=W;q<t.length;q++)if(!(G=G.children[t[q]]))return;return G}},L.prototype.getLeafAncestorAtLevel=function(W,Z,G){if(se.fF.assertValue(W,"Undefined leaf node"),se.fF.assert(function(){return Z>=0},"Invalid target level"),!(Z>this.getLevel(W))){for(var q=W;this.getLevel(q)>Z;){if(q=this.getParent(q),G&&this.getLevel(q)<Z)return;se.fF.assertValue(q,"reached root without finding a matching ancestor")}return q}},L.prototype.getItemsByLevel=function(W){var Z=[];return this.findLevelItems(W,this.hierarchy.root,-1,Z),Z},L.prototype.findLevelItems=function(W,Z,G,q){if(!_.isEmpty(Z.children))for(var t=G+1,C=0,i=Z.children;C<i.length;C++){var o=i[C];t===W||t+this.matrixNavigator.getChildrenLevelDifference(o)>W?q.push(o):t<W&&this.findLevelItems(W,o,t,q)}},L.prototype.getExpansionState=function(W){return W.isCollapsed?1:!1===W.isCollapsed?0:2},L.prototype.getChildren=function(W){return this.matrixNavigator.getChildren(W)},L.prototype.getLevel=function(W){return this.matrixNavigator.getLevel(W)},L.prototype.getIntersection=function(W,Z){var G=this.matrixNavigator.getIntersection(W,Z);return G&&G.objects&&(G.icon=pe.FX.PropValuesIcon.getValue(G.objects),G.hyperlink=pe.FX.PropValuesWebURL.getValue(G.objects),G.altText=pe.FX.PropAltTextValue.getValue(G.objects)),G},L.prototype.getCorner=function(W,Z){return this.matrixNavigator.getCorner(W,Z)},L.prototype.getRowLevel=function(W){return W.rowLevel},L.prototype.getColumnLevel=function(W){return W.columnLevel},L.prototype.getRowHeaderMetadataColumn=function(W){return this.matrixNavigator.getRowHeaderMetadataColumn(W)},L.prototype.getRowHeaderMetadataColumns=function(W){return this.matrixNavigator.getRowHeaderMetadataColumns(W)},L.prototype.getColumnHeaderMetadataColumn=function(W){return this.matrixNavigator.getColumnHeaderMetadataColumn(W)},L.prototype.getColumnHeaderMetadataColumns=function(W){return this.matrixNavigator.getColumnHeaderMetadataColumns(W)},L.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},L.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},L.prototype.isColumnHeaderMultiValueSubtotal=function(W){return W.isSubtotal&&W.parent&&W.parent.isSubtotal},L.prototype.isRowHeaderMultiValueSubtotal=function(W){return this.valuesOnRowApplied()&&W.parent&&W.parent.isSubtotal},L.prototype.getLeaves=function(W,Z){if(!_.isEmpty(W))for(var G=0,q=W;G<q.length;G++){var t=q[G];this.isLeaf(t)?Z.push(t):this.getLeaves(this.getChildren(t),Z)}},L.prototype.getColumnIndexFromQueryName=function(W){return null},L}(),J=function(L){function W(){return null!==L&&L.apply(this,arguments)||this}return(0,z.__extends)(W,L),W.prototype.getIntersection=function(Z,G){return this.isLeaf(Z)||_.isEmpty(Z.children)||!Z.children[0].isSubtotal||this.valuesOnRowApplied()?L.prototype.getIntersection.call(this,Z,G):L.prototype.getIntersection.call(this,Z.children[0],G)},W.prototype.getChildren=function(Z){return se.fF.assertValue(Z,"item"),!_.isEmpty(Z.children)&&Z.children[0].isSubtotal?Z.children.slice(1):Z.children},W.prototype.getHierarchyDepth=function(){return L.prototype.getHierarchyDepth.call(this)>0?1:0},W.prototype.getCorner=function(Z,G){var q=G===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return L.prototype.getCorner.call(this,q,G)},W.prototype.getFloatingHierarchyItems=function(){var Z=this.getHierarchyItems();if(_.isEmpty(Z))return null;for(var G=0,q=[];;){var t=Z[G];if(!t||!t.isSubtotal)break;q.push(t),G++}return _.isEmpty(q)?null:q},W.prototype.isRowHeaderMultiValueSubtotal=function(Z){return this.valuesOnRowApplied()&&Z.isSubtotal},W.prototype.getLeaves=function(Z,G){if(!_.isEmpty(Z))for(var q=0,t=Z;q<t.length;q++){var C=t[q];G.push(C),this.getLeaves(this.getChildren(C),G)}},W.prototype.getPathIndices=function(Z){return[this.getLeafIndex(Z)]},W.prototype.getNodeFromPath=function(Z){if(1===Z.length)return this.getHierarchyLeafAt(Z[0])},W.prototype.getItemsByLevel=function(Z){return se.fF.assert(function(){return 0===Z},"Stepped PivotTable rows hierarchy has 1 level"),(0,z.__spreadArray)([],this.getHierarchyLeafNodes()||[],!0)},W.prototype.getLeafAncestorAtLevel=function(Z,G){return se.fF.assert(function(){return 0===G},"Stepped PivotTable rows hierarchy has 1 level"),se.fF.assertValue(Z,"Undefined leaf node"),Z},W}(ue)},76797:function(_e,Se,U){U.d(Se,{D:function(){return G},l:function(){return t}});var z=U(81337),pe=U(85196),se=U(66232),ue=U(62458),J=U(78843),L=U(93340),W=U(71090),Z=U(21242),G=function(C){return C[C.RowHeader=0]="RowHeader",C[C.ColumnHeader=1]="ColumnHeader",C[C.BodyCell=2]="BodyCell",C}({});function q(C){return 0===C.type}var t=function(){function C(i,o){this.hostServices=i,this.featureSwitches=o,this.clearLocal()}return C.prototype.onItemContextMenu=function(i,o,w,O,D){var N;(0,se.n)(w),!this.isEmpty()&&this.isItemSelected(i,!0)?(N=this.selectedItems,o=this.selectionMode):N=[i];var te=this.createContextMenuArgs(i,o,N,w,O,D);te&&this.hostServices.onContextMenu(te)},C.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},C.prototype.isDrillingEnabled=function(i,o,w){var O=this.createSelectingArgs(i,w,o);return this.hostServices.onSelecting(O),1===O.action},C.prototype.select=function(i,o,w){this.updateSelection(i,o,w,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(i)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,w))},C.prototype.getSelectionScreenReaderMessage=function(i){var o,w,O;switch(this.indicatorStyle){case G.RowHeader:w=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(i));var D=1===this.rowHierarchyNavigator.getExpansionState(i);o=_.isEmpty(this.selectedItems)?!w||i.isSubtotal||D?"Row_Group_Unselected":"Row_Unselected":!w||i.isSubtotal||D?"Row_Group_Selected":"Row_Selected";break;case G.ColumnHeader:O=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(i)),o=_.isEmpty(this.selectedItems)?O&&!i.isSubtotal?"Column_Unselected":"Column_Group_Unselected":O&&!i.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case G.BodyCell:w=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(i.rowItem)),O=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(i.columnItem)),o=_.isEmpty(this.selectedItems)?w&&O&&!i.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":w&&O&&!i.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:o="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(o)},C.prototype.getIndicatorStyle=function(){return this.indicatorStyle},C.prototype.updateSelection=function(i,o,w,O){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in i&&(i.isRowAndColumnGrandTotal||i.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!O&&o!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(i))if(this.isItemSelected(i,O)){if(O)return!1;1===this.selectedItems.length&&1!==w?this.clearLocal():3===w?this.unselectItem(i):0===w&&(this.selectedItems=[i])}else(0===w||o!==this.selectionMode)&&this.clearLocal(),this.selectionMode=o,this.indicatorStyle=o,this.selectedItems.push(i),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[i]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return i.isRowGrandTotal?this.indicatorStyle=G.ColumnHeader:i.isColumnGrandTotal&&(this.indicatorStyle=G.RowHeader),!0},C.prototype.isRowHeaderHighlighted=function(i){if(this.isEmpty())return!0;for(var o=0,w=this.selectedItems;o<w.length;o++)if(this.isRowHeaderOnSelectedPath(w[o],i))return!0;return!1},C.prototype.isColumnHeaderHighlighted=function(i){if(this.isEmpty())return!0;for(var o=0,w=this.selectedItems;o<w.length;o++)if(this.isColumnHeaderOnSelectedPath(w[o],i))return!0;return!1},C.prototype.isRowHeaderIndicatorOn=function(i,o){var w=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(N){return w.isRowHeaderOnSelectedPath(N,i,!0,!o)})&&!(this.indicatorStyle===G.ColumnHeader)},C.prototype.isRowHeaderDarkened=function(i){var o=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(D){return o.isRowHeaderOnSelectedPath(D,i,!0,!1)})&&this.indicatorStyle===G.RowHeader},C.prototype.isColumnHeaderIndicatorOn=function(i){var o=this;if(!this.featureSwitches.a11yMatrix)return!1;var w=this.columnHierarchyNavigator.isLeaf(i),O=_.some(this.selectedItems,function(N){return o.isColumnHeaderOnSelectedPath(N,i)});return w&&O&&!(this.indicatorStyle===G.RowHeader)},C.prototype.isColumnHeaderDarkened=function(i){var o=this;return _.some(this.selectedItems,function(D){return o.isColumnHeaderOnSelectedPath(D,i)})&&!(this.indicatorStyle===G.RowHeader)},C.prototype.isBodyCellHighlighted=function(i){if(this.isEmpty())return!0;for(var o=0,w=this.selectedItems;o<w.length;o++)if(this.isBodyCellOnSelectedPath(w[o],i))return!0;return!1},C.prototype.isBodyCellIndicatorOn=function(i){if(this.isEmpty())return!1;for(var o=0,w=this.selectedItems;o<w.length;o++)if(this.isBodyCellOnSelectedPath(w[o],i)&&this.indicatorStyle===G.BodyCell)return!0;return!1},C.prototype.isRowHeaderOnSelectedPath=function(i,o,w,O){return this.indicatorStyle===G.ColumnHeader||(D=q(i)?i.rowItem:i,this.isOnSelectedPath(this.getEffectiveSelectedHeader(D),o,w,O));var D},C.prototype.isColumnHeaderOnSelectedPath=function(i,o){return this.indicatorStyle===G.RowHeader||(w=q(i)?i.columnItem:i,this.isOnSelectedPath(this.getEffectiveSelectedHeader(w),o));var w},C.prototype.isBodyCellOnSelectedPath=function(i,o){return this.isRowHeaderOnSelectedPath(i,o.rowItem)&&this.isColumnHeaderOnSelectedPath(i,o.columnItem)},C.prototype.isOnSelectedPath=function(i,o,w,O){if(!i||i===o)return!0;var D=i;if(!w)for(;D;){if(D===o)return!0;D=D.parent}if(D=o,!O)for(;D;){if(D===i)return!0;D=D.parent}return!1},C.prototype.onDataViewChanged=function(i,o){this.rowHierarchyNavigator=i,this.columnHierarchyNavigator=o;var w=i&&i.getHierarchyItems(),O=o&&o.getHierarchyItems();if(!this.isEmpty()){for(var D=[],N=0,te=this.selectedItems;N<te.length;N++){var ne=te[N],ee=C.getMatchingItem(ne,this.selectionMode,w,O,i);D.push(ee||ne)}this.selectedItems=D}},C.getMatchingItem=function(i,o,w,O,D){if(i.isBlankRow)return null;switch(o){case G.RowHeader:return this.getMatchingHeader(i,w);case G.ColumnHeader:return this.getMatchingHeader(i,O);case G.BodyCell:var N=i,te=this.getMatchingHeader(N.rowItem,w),ne=this.getMatchingHeader(N.columnItem,O);return te&&ne?D.getIntersection(te,ne):null}},C.getMatchingHeader=function(i,o){if(o)for(var w=0,O=o;w<O.length;w++){var D=O[w];if(this.areHeadersEqual(i,D))return D;var N=this.getMatchingHeader(i,D.children);if(N)return N}return null},C.areHeadersEqual=function(i,o){if(ue.fF.assert(function(){return!!i&&!!o},"items cannot be null"),(0,J.fS)(i.identity,o.identity)&&i.queryName===o.queryName){if(!i.parent&&!o.parent)return!0;if(i.parent&&o.parent)return this.areHeadersEqual(i.parent,o.parent)}return!1},C.getMatchingItemById=function(i,o,w,O,D){var N=_.keys(i.dataMap),te=_.chain(D.getColumnHierarchy().levels).filter(function(g){return!g.sources[0].isMeasure}).map(function(g){return g.sources[0].queryName}).filter(function(g){return _.includes(N,g)}).value(),ne=_.chain(D.getRowHierarchy().levels).map(function(g){return g.sources[0].queryName}).filter(function(g){return _.includes(N,g)}).value();switch(o){case G.RowHeader:return this.getMatchingHeaderById(i,ne,w);case G.ColumnHeader:return this.getMatchingHeaderById(i,te,O);case G.BodyCell:var ee=this.getMatchingHeaderById(i,ne,w),B=this.getMatchingHeaderById(i,te,O);return ee&&B?D.getIntersection(ee,B):null}},C.getMatchingHeaderById=function(i,o,w){if(w)for(var O=0,D=w;O<D.length;O++)for(var N=D[O],te=function(d,v){var y=o[d];if(ne.headerMatchesId(i,y,N)){if(1===v)return{value:N};ue.fF.assertAnyValue(N.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var I=ne.getMatchingHeaderById(i,_.filter(o,function(M){return M!==y}),N.children);if(I)return{value:I}}},ne=this,ee=0,B=o.length;ee<B;ee++){var g=te(ee,B);if("object"==typeof g)return g.value}return null},C.headerMatchesId=function(i,o,w){return ue.fF.assert(function(){return!!i&&!!w},"items cannot be null"),!!(o===w.queryName&&i.dataMap&&i.dataMap[o]&&(0,J.fS)(_.head(i.dataMap[o]),w.identity))},C.areCornerItemsEqual=function(i,o){return!(!i.metadata||!o.metadata)&&i.metadata.queryName===o.metadata.queryName},C.prototype.clearLocal=function(){this.selectedItems=[]},C.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.restoreSelectionState=function(i,o){if(this.clearLocal(),_.isEmpty(i))return!0;for(var w=!1,O=this.selectedItems,D=0,N=i;D<N.length;D++){var te=N[D],ne=this.determineSelectionModeFromIds(te,o);if(null!=ne){this.selectionMode=ne,this.indicatorStyle=ne;var ee=C.getMatchingItemById(te,ne,o.getRowHierarchy().root.children,o.getColumnHierarchy().root.children,o);ee&&(O.push(ee),w=!0,ee.isRowGrandTotal?this.indicatorStyle=G.ColumnHeader:ee.isColumnGrandTotal&&(this.indicatorStyle=G.RowHeader))}}return w},C.prototype.determineSelectionModeFromIds=function(i,o){if(!i)return this.selectionMode;var w=_.map(o.getColumnHierarchy().levels,function(ne){return ne.sources[0].queryName}),O=!1,D=_.map(o.getRowHierarchy().levels,function(ne){return ne.sources[0].queryName}),N=!1;for(var te in i.dataMap)if(_.includes(w,te))O=!0;else{if(!_.includes(D,te))return;N=!0}return O&&N?G.BodyCell:O?G.ColumnHeader:N?G.RowHeader:void 0},C.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.isItemSelected=function(i,o){void 0===o&&(o=!1);for(var w=q(i)?i:void 0,O=0,D=this.selectedItems;O<D.length;O++){var N=D[O];if(q(N)&&w){if(this.areBodyCellsEqual(N,w))return!0}else if(N===i)return!0}return!(!o||this.isEmpty()||!w)&&this.isBodyCellHighlighted(w)},C.prototype.unselectItem=function(i){var o=this;q(i)?_.remove(this.selectedItems,function(w){return o.areBodyCellsEqual(w,i)}):_.pull(this.selectedItems,i)},C.prototype.areBodyCellsEqual=function(i,o){return i.rowItem===o.rowItem&&i.columnItem===o.columnItem},C.prototype.getEffectiveSelectedHeader=function(i){return i&&!i.identity&&i.parent?this.getEffectiveSelectedHeader(i.parent):i},C.prototype.getEffectiveSelectedNodes=function(i){return i.parent?[this.getEffectiveSelectedHeader(i)]:i.identity?[i]:i.siblings},C.getRoleNames=function(i){switch(i){case G.ColumnHeader:return[pe.r.columns];case G.RowHeader:return[pe.r.rows];case G.BodyCell:return[pe.r.values];default:ue.fF.assertFail("unexpected PivotTableSelectionMode")}},C.prototype.createSelectingArgs=function(i,o,w){return{type:0,visualObjects:this.getVisualObjects([i]),position:C.getMouseEventPosition(w),dataRoles:C.getRoleNames(o)}},C.prototype.createSelectArgs=function(i,o){for(var w=[],O=0,D=i;O<D.length;O++){var te=this.createSelectorsByColumn(D[O]);te&&w.push({objectName:"",selectorsByColumn:te})}return{type:0,visualObjects:this.getVisualObjects(i),selectionMode:o}},C.prototype.getVisualObjects=function(i){for(var o=[],w=0,O=i;w<O.length;w++){var N=this.createSelectorsByColumn(O[w]);N&&o.push({objectName:"",selectorsByColumn:N})}return o},C.prototype.createContextMenuArgs=function(i,o,w,O,D,N){for(var ne,ee,B,g,S,d,te=this,v=[],y=0,I=w;y<I.length;y++){var Q=this.createSelectorsByColumn(I[y]);Q&&v.push(Q)}var r,c={dataRoles:D,data:v,position:C.getMouseEventPosition(O)};if(q(i)||(c.nodeIndex=this.getHierarchyNodeIndex(i)),(_.isEmpty(v)||v.every(function(p){return _.isEmpty(p.dataMap)}))&&q(i)&&i.isRowAndColumnGrandTotal){var e=null===(B=null===(ee=null===(ne=i.columnMetadata)||void 0===ne?void 0:ne.type)||void 0===ee?void 0:ee.misc)||void 0===B?void 0:B.sparkline;return c.copyArgs={singleValue:function(){return e?i.textContent:String(i.dataPoint)}},c}if(q(i))if(null===(d=null===(S=null===(g=i.columnMetadata)||void 0===g?void 0:g.type)||void 0===S?void 0:S.misc)||void 0===d?void 0:d.sparkline)r=i.textContent;else{var s=i.dataPoint;null!=s&&(r=(0,L.pW)(s))}else r=i.tooltipValueFormatted;return c.copyArgs={grid:function(){return te.generateGridCopyCallback(w,o)}},void 0!==r&&(c.copyArgs.singleValue=function(){return String(r)}),this.featureSwitches.a11yShowAsMatrix&&(c.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,z.__awaiter)(te,void 0,void 0,function(){return(0,z.__generator)(this,function(u){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,z.__awaiter)(te,void 0,void 0,function(){return(0,z.__generator)(this,function(u){return[2,!N]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,z.__awaiter)(te,void 0,void 0,function(){return(0,z.__generator)(this,function(u){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,z.__awaiter)(te,void 0,void 0,function(){return(0,z.__generator)(this,function(u){return[2,N]})})}}]),c},C.prototype.generateGridCopyCallback=function(i,o){var D,w=i.slice(),O=[];switch(o){case G.BodyCell:w=this.collectSelectedBodyNodes(w),D=(0,Z.kH)(w,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),O.push.apply(O,(0,z.__spreadArray)([D.headers],D.values||[],!1));break;case G.ColumnHeader:for(var N=[],te=0,ne=w;te<ne.length;te++){var ee=ne[te];this.columnHierarchyNavigator.isLeaf(ee)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(ee).isMeasure?N.push.apply(N,ee.siblings||[]):N.push(ee)}D=(0,Z.mM)([],w=N,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),O.push.apply(O,(0,z.__spreadArray)([D.headers],D.values||[],!1));break;case G.RowHeader:D=(0,Z.mM)(w,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),O.push.apply(O,(0,z.__spreadArray)([D.headers],D.values||[],!1));break;default:ue.fF.assertNever(o)}return{grid:O,coveragePercentage:D?D.coveragePercentage:void 0}},C.prototype.getHierarchyNodeIndex=function(i){for(var o=[];i&&null!=i.index;)o.splice(0,0,i.index),i=i.parent;return o},C.prototype.collectSelectedBodyNodes=function(i){for(var o=[],w=0,O=i;w<O.length;w++){var D=O[w];if(!D.isSubtotal&&D.columnItem.identity&&D.rowItem.identity)o.push(D);else{var N=[],te=[];D.isRowGrandTotal||(N=this.getEffectiveSelectedNodes(D.rowItem)),D.isColumnGrandTotal||(te=this.getEffectiveSelectedNodes(D.columnItem));var ne=(0,Z.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,N,te);o.push.apply(o,ne||[])}}for(var ee=0;ee<o.length;ee++)for(var B=o[ee],g=ee+1;g<o.length;g++)_.isEqual(B,o[g])&&(o.splice(g,1),g--);return o},C.prototype.createSelectorsByColumn=function(i){return q(i)?this.createSelectorsByColumnForBodyCell(i):this.createSelectorsByColumnForHeader(i)},C.prototype.createSelectorsByColumnForHeader=function(i){var o=i.queryName,w={};return C.addHeaderIdentities(i,w)?{dataMap:w,metadata:[o]}:void 0},C.prototype.createSelectorsByColumnForBodyCell=function(i){var o,w={},O=C.addHeaderIdentities(i.rowItem,w),D=C.addHeaderIdentities(i.columnItem,w),N=null===(o=i.columnMetadata)||void 0===o?void 0:o.queryName;return ue.fF.assert(function(){return O||D||!!N},"Must have a row or column identity or column metadata"),{dataMap:w,metadata:N?[N]:void 0}},C.addHeaderIdentities=function(i,o){for(var w=[];i;)i.identity&&w.splice(0,0,i),i=i.parent;for(var O=0,D=w;O<D.length;O++){var N=D[O];o[N.queryName]=[N.identity]}return w.length>0},C.hasIdentity=function(i){return C.addHeaderIdentities(i,{})},C.getMouseEventPosition=function(i){return{x:i.clientX,y:i.clientY}},C}()},59784:function(_e,Se,U){U.d(Se,{S:function(){return pe}});var z=U(76797),pe=function(){function se(ue){this.hostServices=ue}return se.prototype.onDataViewChanged=function(ue,J,L,W,Z){this.isSteppedLayout=W,this.valuesOnRowApplied=Z,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(ue),this.valueSources=L,this.hasRows=ue&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=J&&!_.isEmpty(J.levels),this.measureCount=L?L.length:0},se.hasSortingChanged=function(ue,J){if(!ue||!J)return!1;var L=ue.metadata.columns;if(_.isEmpty(L))return!1;var W=J.metadata.columns;if(_.isEmpty(W))return!1;for(var Z=function(o){var w=_.find(L,function(O){return o.queryName===O.queryName});if(w&&o.sort!==w.sort)return{value:!0}},G=0,q=W;G<q.length;G++){var C=Z(q[G]);if("object"==typeof C)return C.value}return!1},se.prototype.isCornerSortable=function(ue){return this.hasRows&&null!=ue.metadata&&ue.position.row.isLast&&(!this.valuesOnRowApplied||!ue.position.column.isLast)},se.prototype.getNonMeasureRowLevels=function(ue){if(this.valuesOnRowApplied){var J=[];return J.push.apply(J,ue.levels||[]),J.pop(),J}return ue.levels},se.prototype.isColumnHeaderSortable=function(ue){var J=z.l.hasIdentity(ue);return this.hasRows&&this.measureCount>0&&!J&&ue.position.row.isLast&&!this.valuesOnRowApplied},se.prototype.getCornerSortDirection=function(ue){if(!this.isCornerSortable(ue))return null;if(this.isSteppedLayout){for(var J=null,L=0,W=this.nonMeasureRowLevels;L<W.length;L++){var Z=W[L];if(1!==Z.sources.length)return null;var G=Z.sources[0].sort;if(null==G)return null;if(null!==J){if(G!==J)return null}else J=G}return J}return this.nonMeasureRowLevels[ue.position.column.index].sources[0].sort},se.prototype.getColumnHeaderSortDirection=function(ue){return this.isColumnHeaderSortable(ue)?this.getMeasureSortDirection(this.getMeasureQueryName(ue)):null},se.prototype.getMeasureQueryName=function(ue){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:ue.queryName},se.prototype.sortCorner=function(ue){var W,J=this.getCornerSortDirection(ue),L=se.getNextSortDirection(J);if(this.isSteppedLayout){W=[];for(var Z=0,G=this.nonMeasureRowLevels;Z<G.length;Z++)W.push({queryName:G[Z].sources[0].queryName,sortDirection:L})}else W=[{queryName:ue.metadata.queryName,sortDirection:L}];this.hostServices.onCustomSort({sortDescriptors:W,suppressAnnouncements:!0})},se.prototype.sortColumnHeader=function(ue){var J=this.getColumnHeaderSortDirection(ue),L=this.getMeasureColumn(this.getMeasureQueryName(ue));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(ue),sortDirection:se.getNextSortDirection(J,L)}],suppressAnnouncements:!0})},se.getNextSortDirection=function(ue,J){return void 0===ue?se.getDefaultSortDirection(J):1===ue?2:1},se.getDefaultSortDirection=function(ue){return ue&&ue.isMeasure&&ue.type&&ue.type.numeric&&!ue.type.temporal?2:1},se.prototype.getMeasureSortDirection=function(ue){var J=this.getMeasureColumn(ue);if(null!=J)return J.sort},se.prototype.getMeasureColumn=function(ue){return _.find(this.valueSources,function(J){return J.queryName===ue})},se}()},79476:function(_e,Se,U){U.d(Se,{ao:function(){return C},fS:function(){return se},oY:function(){return t}});var z=U(19377);function se(i,o){return null!=i&&null!=o&&i.x===o.x&&i.y===o.y}function t(i,o,w){var O=(o.y-i.y)*(w.x-o.x)-(o.x-i.x)*(w.y-o.y);return 0===O?z.i.Colinear:O>0?z.i.Clockwise:z.i.Counterclockwise}function C(i,o,w){return w.x<=Math.max(i.x,o.x)&&w.x>=Math.min(i.x,o.x)&&w.y<=Math.max(i.y,o.y)&&w.y>=Math.min(i.y,o.y)}},92379:function(_e,Se,U){U.d(Se,{m:function(){return ue}});var z=U(19377),pe=U(79476),se=U(80758),ue=function(){function J(L){L&&(this.polygonPoints=this.convertArrayPathToPoints(L))}return J.fromPolygonPoints=function(L){var W=new J(null);return W.polygonPoints=L,W},J.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},J.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},J.prototype.contains=function(L){var Z={x:L.left+L.width,y:L.top},G={x:L.left,y:L.top+L.height},q={x:L.left+L.width,y:L.top+L.height};return this.inside({x:L.left,y:L.top})&&this.inside(Z)&&this.inside(G)&&this.inside(q)},J.prototype.conflicts=function(L){if(!this.isConflictWithBoundingBox(L))return!1;var Z={x:L.left+L.width/2,y:L.top},G={x:L.left+L.width,y:L.top},q={x:L.left,y:L.top+L.height},t={x:L.left+L.width/2,y:L.top+L.height},C={x:L.left+L.width,y:L.top+L.height},i={x:L.left,y:L.top+L.height/2},o={x:L.left+L.width,y:L.top+L.height/2};return this.inside({x:L.left,y:L.top})||this.inside(Z)||this.inside(G)||this.inside(q)||this.inside(t)||this.inside(C)||this.inside(i)||this.inside(o)},J.prototype.lineIntersectionPoint=function(L,W){for(var Z=0;Z<this.polygonPoints.length;Z++){var t=this.getLineIntersection(L,W,this.polygonPoints[Z],Z===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[Z+1]);if(null!==t)return t}return null},J.calculateAbsolutePolygonArea=function(L){var W,Z=1,G=0;for(W=0;W<L.length;W++)G+=L[W].x*L[Z].y-L[Z].x*L[W].y,Z=(Z+1)%L.length;return.5*G},J.prototype.overlapPath=function(L){if(this.inside({x:L[0],y:L[1]}))return!0;var W=new J(L);if(W.inside(this.polygonPoints[0]))return!0;for(var Z=0;Z<this.polygonPoints.length;Z++)if(W.lineIntersectionPoint(this.polygonPoints[Z],this.polygonPoints[(Z+1)%this.polygonPoints.length]))return!0;return!1},J.prototype.inside=function(L){for(var W=L.x,Z=L.y,G=!1,q=0,t=this.polygonPoints.length-1;q<this.polygonPoints.length;t=q++){var C=this.polygonPoints[q].x,i=this.polygonPoints[q].y,w=this.polygonPoints[t].y;i>Z!=w>Z&&W<(this.polygonPoints[t].x-C)*(Z-i)/(w-i)+C&&(G=!G)}return G},J.translateX=function(L,W){for(var Z=new Float64Array(2*L.polygonPoints.length),G=0;G<L.polygonPoints.length;G++)Z[2*G]=L.polygonPoints[G].x+W,Z[2*G+1]=L.polygonPoints[G].y;return new J(Z)},J.polygonBoundsOverlap=function(L,W){var Z=(0,se.WN)(J.getPolyBoundLeft(L),J.getPolyBoundRight(L),J.getPolyBoundLeft(W),J.getPolyBoundRight(W)),G=(0,se.WN)(J.getPolyBoundLower(L),J.getPolyBoundUpper(L),J.getPolyBoundLower(W),J.getPolyBoundUpper(W));return Z&&G},J.circleRectangleOverlap=function(L,W,Z){var G=Math.max(L.left,Math.min(W.x,L.right)),q=Math.min(L.bottom,Math.max(W.y,L.top)),t=G-W.x,C=q-W.y;return t*t+C*C<=Z*Z},J.linesIntersect=function(L,W,Z,G,q){void 0===q&&(q=!0);var t=(0,pe.oY)(L,W,Z),C=(0,pe.oY)(L,W,G),i=(0,pe.oY)(Z,G,L),o=(0,pe.oY)(Z,G,W);return t!==C&&i!==o||!!q&&!!(t===z.i.Colinear&&(0,pe.ao)(L,W,Z)||C===z.i.Colinear&&(0,pe.ao)(L,W,G)||i===z.i.Colinear&&(0,pe.ao)(Z,G,L)||o===z.i.Colinear&&(0,pe.ao)(Z,G,W))},J.resize=function(L,W){if(0===W)return L;for(var Z=J.calculateAbsolutePolygonArea(L.polygonPoints)>0,q=_.clone(W>0&&!0===Z||W<0&&!1===Z?L.polygonPoints.reverse():L.polygonPoints),t=L.absoluteCentroid(),C=[],i=0;i<q.length;i++){var o=q[i],w=q[(i+1)%q.length],O=w.y-o.y,D=void 0;0!==O&&(D=-(w.x-o.x)/O);var N=0;_.isUndefined(D)||(N=(o.y<w.y?-1:1)*Math.sqrt(W*W/(1+D*D)));var te=0;0===N?te=(o.x>w.x?-1:1)*W:_.isUndefined(D)||(te=D*N);var ne={x:o.x+N,y:o.y+te},ee={x:0,y:0};0===D?(ee.x=ne.x,ee.y=ne.y+10):_.isUndefined(D)||(ee.x=ne.x+10,ee.y=ne.y-10/D);var B=(ne.x-ee.x)*(t.y-o.y)-(ne.y-ee.y)*(t.x-o.x);if(0!==B){var g={x:((ne.x*ee.y-ne.y*ee.x)*(t.x-o.x)-(ne.x-ee.x)*(t.x*o.y-t.y*o.x))/B,y:((ne.x*ee.y-ne.y*ee.x)*(t.y-o.y)-(ne.y-ee.y)*(t.x*o.y-t.y*o.x))/B};isFinite(g.x)&&isFinite(g.y)&&C.push(g)}}return J.fromPolygonPoints(C)},J.getPolyBoundLeft=function(L){var W;return null===(W=_.minBy(L.polygonPoints,function(Z){return Z.x}))||void 0===W?void 0:W.x},J.getPolyBoundRight=function(L){var W;return null===(W=_.maxBy(L.polygonPoints,function(Z){return Z.x}))||void 0===W?void 0:W.x},J.getPolyBoundUpper=function(L){var W;return null===(W=_.maxBy(L.polygonPoints,function(Z){return Z.y}))||void 0===W?void 0:W.y},J.getPolyBoundLower=function(L){var W;return null===(W=_.minBy(L.polygonPoints,function(Z){return Z.y}))||void 0===W?void 0:W.y},J.prototype.isConflictWithBoundingBox=function(L){return(0,se.HL)(this.absoluteBoundingRect(),L)},J.prototype.calculatePolygonCentroid=function(){var L,W,Z,G,q,t;for(L=J.calculateAbsolutePolygonArea(this.polygonPoints),Z=G=0,t=1,q=0;q<this.polygonPoints.length;q++)Z+=(this.polygonPoints[q].x+this.polygonPoints[t].x)*(W=this.polygonPoints[q].x*this.polygonPoints[t].y-this.polygonPoints[t].x*this.polygonPoints[q].y),G+=(this.polygonPoints[q].y+this.polygonPoints[t].y)*W,t=(t+1)%this.polygonPoints.length;return{x:Z/=6*L,y:G/=6*L}},J.prototype.calculateBoundingRect=function(){for(var L=Number.POSITIVE_INFINITY,W=Number.POSITIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,G=Number.NEGATIVE_INFINITY,q=0,t=this.polygonPoints;q<t.length;q++){var C=t[q];C.x<L?L=C.x:C.x>Z&&(Z=C.x),C.y<W?W=C.y:C.y>G&&(G=C.y)}return{left:L,top:W,width:Z-L,height:G-W}},J.prototype.getLineIntersection=function(L,W,Z,G){var q=L.x,t=L.y,o=Z.x,w=Z.y,N=W.x-q,te=W.y-t,ne=G.x-o,ee=G.y-w,B=(-te*(q-o)+N*(t-w))/(-ne*te+N*ee),g=(ne*(t-w)-ee*(q-o))/(-ne*te+N*ee);return B>=0&&B<=1&&g>=0&&g<=1?{x:q+g*N,y:t+g*te}:null},J.prototype.convertArrayPathToPoints=function(L){for(var W=[],Z=0;Z<L.length;Z+=2)W.push({x:L[Z],y:L[Z+1]});return W},J}()},19377:function(_e,Se,U){U.d(Se,{i:function(){return z}});var z=function(pe){return pe[pe.Clockwise=0]="Clockwise",pe[pe.Counterclockwise=1]="Counterclockwise",pe[pe.Colinear=2]="Colinear",pe}({})}}]);