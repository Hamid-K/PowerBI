"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["format-mode"],{87644:function(ue,Q,s){s.d(Q,{VO:function(){return N},Vj:function(){return P},ub:function(){return c}});var c="formattingService",N="formattingUIService",P=N},21302:function(ue,Q,s){s.d(Q,{Ol:function(){return P},mF:function(){return N},sn:function(){return c}});var V=s(50423),c={type:3,name:"showFormatPane"},N={type:3,name:"showPageFormatPane"},P=new V.InjectionToken("PropertyChangeIndicatorService")},92755:function(ue,Q,s){s.d(Q,{cY:function(){return ce},ks:function(){return U}});var V=s(81337),c=s(11547),N=s(59017),P=s(14172),j=s(32379),e=s(61617);function U(q,K,J,ie,Y,z,A){return{objectName:K.objectName,uid:J,formattingSource:ie,hasDynamicExpressionSupport:A?.isSet,canvasItems:Y,propertySlice:{name:K.propertyName,value:q,type:K.type,selector:K.selector,altConstantValueSelector:K.altConstantValueSelector},conditionalFormatting:!!A,visualUpdateSource:z}}function ce(q,K,J){void 0===J&&(J=[]);for(var ie=[],Y=function(pe){var ge=(0,c.of)([]),re=(0,c.of)([]),ae=pe;ae&&J.some(function(T){return T.objectName===ae.objectName&&(0,j.fS)(T.selector,ae.selector)&&T.propertyName===ae.propertyName})||!ae||(ge=q.selectTopLevelToggle(pe).pipe((0,P.U)(function(T){return T?[(0,V.__assign)((0,V.__assign)({},T.control.properties.descriptor),{originSource:T.originSource})]:[]})),re=q.selectSlice(pe).pipe((0,P.U)(function(T){return T?(0,e.i6)(T).map(function(le){return(0,V.__assign)((0,V.__assign)({},le),{originSource:T.originSource})}):[]}))),ie.push((0,N.aj)([ge,re]).pipe((0,P.U)(function(T){var L;return null!==(L=_.find(T,function(H){return!_.isEmpty(H)}))&&void 0!==L?L:[]})))},z=0,A=K;z<A.length;z++)Y(A[z]);return(0,N.aj)(ie).pipe((0,P.U)(function(de){return _.flatten(de)}))}},89535:function(ue,Q,s){s.d(Q,{Kj:function(){return P},YR:function(){return e},lD:function(){return N},r4:function(){return j},y5:function(){return U}});var V=s(19650),c=s(50423),N=function(){return function(K,J){this.value=K,this.equals=J}}(),P=new c.InjectionToken("SliceCustomizationService"),j=6,e=60,U={left:V.H.left,center:V.H.center,right:V.H.right,Auto:V.H.auto}},43626:function(ue,Q,s){s.d(Q,{DS:function(){return K},E6:function(){return ie},Vc:function(){return q},fI:function(){return J},tE:function(){return Y}});var V=s(76072),c={loadChildren:function(){return s.e("explore-ui-authoring").then(s.bind(s,43281)).then(function(A){return A.ExploreUIAuthoringModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/explore-ui-authoring/explore-ui-authoring.module#ExploreUIAuthoringModule",c.loadChildren),V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/explore-formatting/explore-formatting.module#ExploreFormattingModule",function(){return Promise.all([s.e(5),s.e("explore-formatting")]).then(s.bind(s,7989)).then(function(A){return A.ExploreFormattingModule})});var P={loadChildren:function(){return s.e("selection-pane").then(s.bind(s,78656)).then(function(A){return A.SelectionPaneModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/selection-pane/selection-pane.module#SelectionPaneModule",P.loadChildren);var j={loadChildren:function(){return s.e("bookmarks-pane").then(s.bind(s,6396)).then(function(A){return A.BookmarksPaneModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUI/lazy-modules/bookmarks-pane/bookmarks-pane.module#BookmarksPaneModule",j.loadChildren);var e={loadChildren:function(){return s.e("field-well-view-model").then(s.bind(s,42611)).then(function(A){return A.FieldWellViewModelModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/field-well-view-model/field-well-view-model.module#FieldWellViewModelModule",e.loadChildren);var U={loadChildren:function(){return s.e("visual-container-skittles-ui").then(s.bind(s,15250)).then(function(A){return A.VisualContainerSkittlesUIModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule",U.loadChildren);var ne={loadChildren:function(){return s.e("visual-calc-editor").then(s.bind(s,83269)).then(function(A){return A.VisualCalcEditorModule})}};V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-editor/visual-calc-editor.module#VisualCalcEditorModule",ne.loadChildren),V.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-flyout/visual-calc-flyout.module#VisualCalcFlyoutModule",function(){return s.e("visual-calc-flyout").then(s.bind(s,56137)).then(function(A){return A.VisualCalcFlyoutModule})});var q=[{path:"dummy-explore-ui-authoring-lazy",loadChildren:c.loadChildren},{path:"dummy-selection-pane-module",loadChildren:P.loadChildren},{path:"dummy-bookmarks-pane-module",loadChildren:j.loadChildren},{path:"field-well-view-model-module",loadChildren:e.loadChildren},{path:"visual-container-skittles-module",loadChildren:U.loadChildren},{path:"dummy-visual-calc-editor",loadChildren:ne.loadChildren}],K="fieldWellBucketService",J=K,ie="fieldWellFieldService",Y=ie},63205:function(ue,Q,s){s.r(Q),s.d(Q,{FormatModeModule:function(){return mi}});var V=s(43626),c=s(81337),N=s(73221),P=s(59017),j=s(14172),e=s(50423),U=s(77476),ne=s(69437);function ce(a,o){if(1&a&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"stop")),2&a){var t=o.$implicit,n=o.index,i=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275attribute("stop-color",t)("offset",n*(100/(i.colors.length-1))+"%")}}function q(a,o){if(1&a&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",3)(1,"defs")(2,"linearGradient",4),e.\u0275\u0275template(3,ce,1,2,"stop",5),e.\u0275\u0275elementEnd()()()),2&a){var t=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(2),e.\u0275\u0275property("id",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.colors)}}var K=function(o){return{fill:o}},J=function(o,t){return{full:o,compact:t}};function ie(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,q,4,2,"svg",1),e.\u0275\u0275element(2,"pbi-office-icon",2),e.\u0275\u0275elementEnd()),2&a){var t=o.ngIf,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.colors.length>1),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",n.iconName)("disabled",n.disabled)("ngStyle",e.\u0275\u0275pureFunction1(5,K,t.reference))("ngClass",e.\u0275\u0275pureFunction2(7,J,n.iconMode===n.iconModeEnum.Full,n.iconMode===n.iconModeEnum.Compact))}}var Y=function(a){return a[a.Full=0]="Full",a[a.Compact=1]="Compact",a}({}),z=function(a){function o(){var t=null!==a&&a.apply(this,arguments)||this;return t.iconModeEnum=Y,t}return(0,c.__extends)(o,a),o.prototype.ngOnInit=function(){this.gradientId$=this.changes$("iconColors").pipe((0,j.U)(function(t){return function(a){if(a&&!_.isEmpty(a)){if(a.length>1){for(var o="",t=0;t<a.length;t++){var n=a[t];/#/g.test(n)?o+=n.replace(/#/g,""):/^rgb/gi.test(n)&&(o+=he(n)),t<a.length-1&&(o+="-")}return o}if(o=_.first(a))return/^rgb/gi.test(o)&&(o="#".concat(he(o))),o}return""}(t)})),this.fillColorProperties$=(0,P.aj)([this.gradientId$,this.changes$("iconColors")]).pipe((0,j.U)(function(t){var n=t[0],i=t[1];return{id:n,colors:i??[],reference:i&&i.length>1?"url(#".concat(n,")"):"".concat(n)}}))},o.\u0275fac=function(){var t;return function(i){return(t||(t=e.\u0275\u0275getInheritedFactory(o)))(i||o)}}(),o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar-cf-gradient-icon"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",iconMode:"iconMode"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],["class","cf-gradient-container",4,"ngIf"],[3,"name","disabled","ngStyle","ngClass"],[1,"cf-gradient-container"],[3,"id"],[4,"ngFor","ngForOf"]],template:function(n,i){1&n&&(e.\u0275\u0275template(0,ie,3,10,"div",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,i.fillColorProperties$))},dependencies:[U.NgClass,U.NgForOf,U.NgIf,U.NgStyle,ne.m,U.AsyncPipe],styles:[".cf-gradient-container[_ngcontent-%COMP%]{height:0;width:0}pbi-office-icon.full[_ngcontent-%COMP%]{padding-right:1px;width:24px;height:20px}pbi-office-icon.compact[_ngcontent-%COMP%]{width:20px;height:20px}"],changeDetection:0}),o}(N.w);function he(a){var t="",n=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/.exec(a);return n&&(t=(16777216+(de(n[1],!!n[2])<<16)+(de(n[3],!!n[4])<<8)+de(n[5],!!n[6])).toString(16).slice(1)),t}function de(a,o){var t=Math.max(0,parseInt(a,10));return o?Math.floor(255*Math.min(100,t)/100):Math.min(255,t)}var pe=s(36858),ge=function(a){function o(){var t=null!==a&&a.apply(this,arguments)||this;return t.clicked=new e.EventEmitter,t.ready=new e.EventEmitter,t.iconModeEnum=Y,t}return(0,c.__extends)(o,a),o.prototype.ngAfterViewInit=function(){this.ready.emit()},o.\u0275fac=function(){var t;return function(i){return(t||(t=e.\u0275\u0275getInheritedFactory(o)))(i||o)}}(),o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar-large-button"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",label:"label",title:"title",ariaHasPopup:"ariaHasPopup"},outputs:{clicked:"clicked",ready:"ready"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:6,vars:10,consts:[["data-automation-type","mini-toolbar-button",1,"mini-toolbar-button","mini-toolbar-large-button",3,"disabled","pbiTooltip","click"],[1,"icon-container"],[3,"disabled","iconName","iconColors","iconMode"],["name","CommonControlChevronDown_12",1,"chevron",3,"disabled"],[1,"label"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(l){return i.clicked.emit(l)}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275element(2,"mini-toolbar-cf-gradient-icon",2)(3,"pbi-office-icon",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("disabled",i.disabled)("pbiTooltip",i.title),e.\u0275\u0275attribute("aria-label",i.label)("aria-haspopup",i.ariaHasPopup),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",i.disabled)("iconName",i.iconName)("iconColors",i.iconColors)("iconMode",i.iconModeEnum.Full),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",i.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.label))},dependencies:[ne.m,pe.V,z],styles:['.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]{background:none;border:none;box-sizing:border-box;--buttonBackgroundSelected: var(--gray-40);--buttonColorSelected: var(--gray-180);flex:none;--buttonBackgroundHover: var(--gray-30);--buttonBackgroundSelectedHover: var(--gray-50);--buttonColorHover: var(--gray-180);display:flex;flex-direction:column;align-items:center;width:58px;height:60px;padding:5px 10px 8px}[data-legacy-theming=false][_ngcontent-%COMP%]   .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]{--buttonBackgroundSelected: var(--colorNeutralBackground1Selected);--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorSelected: var(--colorNeutralForeground1Selected);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:not(:focus-visible), .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active:not(:focus-visible){border:none}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active:not(:disabled):not([disabled]):not(.disabled), .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:active:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundSelectedHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button.ql-active[_ngcontent-%COMP%]:not(:hover):not(:active), .mini-toolbar-button.mini-toolbar-large-button.selected[_ngcontent-%COMP%]:not(:hover):not(:active){background-color:var(--buttonBackgroundSelected);color:var(--buttonColorSelected)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:focus-visible{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:disabled, .mini-toolbar-button.mini-toolbar-large-button[disabled][_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button.disabled[_ngcontent-%COMP%]{background:none;color:var(--gray-90)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:disabled   .icon[_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button[disabled][_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .mini-toolbar-button.mini-toolbar-large-button.disabled[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:40%}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}  [data-legacy-theming=false] .mini-toolbar-button.mini-toolbar-large-button{--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover, .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:active, .mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]:hover:active{background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;align-self:flex-start;flex-grow:1}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{padding-left:1px;width:12px}.mini-toolbar-button.mini-toolbar-large-button[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;flex:none;width:inherit}'],changeDetection:0}),o}(N.w),re=s(17174),ae=s(81905),D=s(22318),C=s(83317),M=s(6181),T=s(57243),L=s(87644),H=s(64560),le=s(86286),se=s(9215),me=s(21728),Pe=s(71286),St=s(52083),Ct=s(19650),k=s(62458),xt=s(5265),_t=s(94419),be=s(74082),Mt=s(58702),Ge=s(80777),ye=s(89535),It=s(58609),Qe=s(29748),xe=s(28894),wt=s(84281),Et=s(38561);function Tt(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-menu-container",2),e.\u0275\u0275listener("menuButtonClick",function(r){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.executeMenuItem(r))}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("menu",n.menuFactoryObservable)("menuMode",n.menuMode)}}function Ot(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Tt,1,2,"pbi-menu-container",1),e.\u0275\u0275elementContainerEnd()),2&a){var t=o.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.items&&t.items.length>0)}}function Pt(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ot,2,1,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,t.menu$))}}var Fe=function(a){function o(t,n,i,r){var l=a.call(this)||this;return l.changeDetectorRef=t,l.contextActivityService=n,l.lazyScoped=i,l.undoRedo=r,l.onExecuteContextMenuAction=new e.EventEmitter,l.menuMode=H.Kb.Full,l.menuFactoryObservable=function(){return l.menu$},l}return(0,c.__extends)(o,a),o.prototype.ngOnInit=function(){var t=this;Promise.all([this.lazyScoped.get(L.ub),this.lazyScoped.get(L.Vj)]).then(function(n){var r=n[1];t.formattingService=n[0];var u=t.changes$("subSelectionUpdateArgs").pipe((0,M.j)("canvasItem"),(0,j.U)(function(d){return d?[d]:void 0})).pipe((0,ae.w)(function(d){return d?r.getSubSelectionStyleShortcutsForCanvasItems$(d):r.getSubSelectionStyleShortcutsForNonCanvasItems$(t.subSelectionShortcuts)}));t.menu$=t.changes$("menuInput$",!0).pipe((0,ae.w)(function(d){return d||u})),t.changeDetectorRef.detectChanges()})},o.prototype.executeMenuItem=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:switch((n=t.data).type){case 0:return[3,1];case 1:return[3,3];case 2:return[3,5];case 3:return[3,7];case 4:return[3,9];case 6:return[3,11];case 5:return[3,13];case 9:return[3,14]}return[3,16];case 1:return[4,this.executeResetShortcut(n)];case 2:case 4:case 6:case 8:case 10:case 12:case 15:return r.sent(),[3,16];case 3:return[4,this.executeNavigateShortcut(n)];case 5:return[4,this.executeToggleShortcut(n)];case 7:return[4,this.executePickerShortcut(n)];case 9:return[4,this.executeSortShortcut(n,t.checked)];case 11:return[4,this.executeConditionalFormattingShortcut(n)];case 13:return this.executeCustomActionShortcut(n),[3,16];case 14:return[4,this.executeSetValueShortcut(n)];case 16:return this.onExecuteContextMenuAction.emit(),[2]}})})},o.prototype.executeResetShortcut=function(t){var n,r,l,i=this;k.fF.assert(function(){return!!i.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executePickerShortcut");var v,u=(n=this.subSelectionUpdateArgs).canvasItem,p=null===(l=null===(r=n.subSelections[0])||void 0===r?void 0:r.visualSubSelection.visualObjects[0])||void 0===l?void 0:l.objectName,m=(0,It.hF)(this.contextActivityService,{name:"Revert To Default",visualName:u.name,data:{objectName:p,source:"ContextMenu",contextMenuType:"Visual"}}),g=this.subSelectionShortcuts.find(function(I){return 4===I.type}),f={type:0,revertToDefaultDescriptors:t.revertToDefaultDescriptors,resetSortRoleKey:g?.key,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}};return this.undoRedo.register("reset shortcuts",function(){v=i.getFormatModeService().then(function(I){return I.executeShortcut([{canvasItem:u,shortcut:f}],m)}).then(function(){return m.resolve()}).catch(function(I){throw m.reject(I),I})}),v},o.prototype.executeNavigateShortcut=function(t){var n;return(0,c.__awaiter)(this,void 0,void 0,function(){var i,r;return(0,c.__generator)(this,function(l){switch(l.label){case 0:return(i=t.shortcut).togglePaneVisibility=!0,[4,this.getFormatModeService()];case 1:return r=l.sent(),this.contextActivityService.createActivity({name:"ExecuteNavigateShortcut",data:{source:"ContextMenu",contextMenuType:"Visual"}}).resolve(),[2,r.executeShortcut([{canvasItem:null===(n=this.subSelectionUpdateArgs)||void 0===n?void 0:n.canvasItem,shortcut:i}])]}})})},o.prototype.executeToggleShortcut=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,l=this;return(0,c.__generator)(this,function(u){switch(u.label){case 0:return n=t.shortcut,k.fF.assert(function(){return!!l.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeToggleShortcut"),i=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,u.sent().executeShortcut([{canvasItem:i,shortcut:n}])]}})})},o.prototype.executeConditionalFormattingShortcut=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,l=this;return(0,c.__generator)(this,function(u){switch(u.label){case 0:return n=t.shortcut,k.fF.assert(function(){return!!l.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeConditionalFormattingShortcut"),i=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,u.sent().executeShortcut([{canvasItem:i,shortcut:n}])]}})})},o.prototype.executePickerShortcut=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var u,d,m,g=this;return(0,c.__generator)(this,function(f){switch(f.label){case 0:return k.fF.assert(function(){return!!g.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executePickerShortcut"),u={type:3,index:t.index,objectName:(m=t.shortcut).objectName,propertyName:m.propertyName,selector:m.selector,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},d=this.subSelectionUpdateArgs.canvasItem,[4,this.getFormatModeService()];case 1:return[2,f.sent().executeShortcut([{canvasItem:d,shortcut:u}])]}})})},o.prototype.executeSortShortcut=function(t,n){return(0,c.__awaiter)(this,void 0,void 0,function(){var i,r,u=this;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return k.fF.assert(function(){return!!u.subSelectionUpdateArgs},"requires subselectionUpdateArgs to be defined - executeSortShortcut"),i=this.subSelectionUpdateArgs.canvasItem,r=t.isSortField&&n?{type:0,resetSortRoleKey:t.sortGroup.key,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}}:{type:4,sortableField:{queryName:t.sortField.exprs[0].name,sortDirection:t.sortDirection},key:t.sortGroup.key},[4,this.getFormatModeService()];case 1:return[2,d.sent().executeShortcut([{canvasItem:i,shortcut:r}])]}})})},o.prototype.executeCustomActionShortcut=function(t){t.shortcut.customAction()},o.prototype.executeSetValueShortcut=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,c.__generator)(this,function(l){switch(l.label){case 0:return n=this.subSelectionUpdateArgs.canvasItem,i={type:9,referencesAndValues:t.shortcut.referencesAndValues,icon:t.shortcut.icon,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},[4,this.getFormatModeService()];case 1:return[2,l.sent().executeShortcut([{canvasItem:n,shortcut:i}])]}})})},o.prototype.getFormatModeService=function(){return this.formatModeServicePromise||(this.formatModeServicePromise=this.lazyScoped.get("formatModeService")),this.formatModeServicePromise},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Qe.r),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(wt.z))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["on-object-context-menu"]],hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","on-object-context-menu")},inputs:{subSelectionUpdateArgs:"subSelectionUpdateArgs",subSelectionStyles:"subSelectionStyles",subSelectionShortcuts:"subSelectionShortcuts",menuInput$:"menuInput$"},outputs:{onExecuteContextMenuAction:"onExecuteContextMenuAction"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],["class","menu-container",3,"menu","menuMode","menuButtonClick",4,"ngIf"],[1,"menu-container",3,"menu","menuMode","menuButtonClick"]],template:function(n,i){1&n&&e.\u0275\u0275template(0,Pt,3,3,"ng-container",0),2&n&&e.\u0275\u0275property("ngIf",i.formattingService)},dependencies:[U.NgIf,Et.m,U.AsyncPipe],encapsulation:2,changeDetection:0}),o}(N.w),Ft=function(){function a(o){this.overlayData=o}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(le.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-context-menu"]],decls:1,vars:4,consts:[[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","menuInput$","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"on-object-context-menu",0),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){return n.overlayData.closeOverlays()}),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("subSelectionUpdateArgs",n.overlayData.subSelectionUpdateArgs)("subSelectionStyles",n.overlayData.subSelectionStyles)("subSelectionShortcuts",n.overlayData.subSelectionShortcuts)("menuInput$",n.overlayData.menuInput$)},dependencies:[Fe],encapsulation:2,changeDetection:0}),a}(),Dt=s(14335),Ut=function(){function a(o){this.data=o,this.warning=this.data}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(Dt.HK))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-warning"]],decls:2,vars:2,consts:[[1,"warning-tooltip-title",3,"textContent"],[3,"textContent"]],template:function(t,n){1&t&&e.\u0275\u0275element(0,"div",0)(1,"div",1),2&t&&(e.\u0275\u0275property("textContent",n.warning.title),e.\u0275\u0275advance(1),e.\u0275\u0275property("textContent",n.warning.detail))},styles:[".warning-tooltip-title[_ngcontent-%COMP%]{font-weight:var(--font-weight-bold)}"],changeDetection:0}),a}(),Vt=function(o){return{fill:o}};function jt(a,o){if(1&a&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(1,"svg",2),e.\u0275\u0275element(2,"path",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(1,Vt,t.iconColor))}}var At=function(o,t,n){return{toggled:o,narrow:t,disabled:n}},kt=function(){function a(){}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-icon"]],inputs:{iconType:"iconType",iconColor:"iconColor",iconToggled:"iconToggled",iconNarrow:"iconNarrow",iconDisabled:"iconDisabled"},decls:2,vars:6,consts:[[1,"container",3,"ngClass"],[4,"ngIf"],["height","100%","width","100%","viewBox","0,0,2048,2048","focusable","false",3,"ngStyle"],["d","M1472 0l576 576L576 2048 0 1472 1472 0zM181 1472l395 395L1867 576l-395-395-88 88 115 115-91 91-115-115-165 165 197 198-90 90-198-197-165 165 115 116-90 90-116-115-165 165 197 198-90 90-198-197-165 165 115 115-91 91-115-115-88 88z"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,jt,3,3,"ng-container",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,At,n.iconToggled,n.iconNarrow,n.iconDisabled)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","DisplayUnits"===n.iconType))},dependencies:[U.NgClass,U.NgIf,U.NgStyle],styles:["svg[_ngcontent-%COMP%]   path.iconFillTransparent[_ngcontent-%COMP%]{fill:transparent}svg[_ngcontent-%COMP%]   path.iconFillInherit[_ngcontent-%COMP%]{fill:inherit}svg[_ngcontent-%COMP%]   path.iconFill1[_ngcontent-%COMP%]{fill:#fafafa}svg[_ngcontent-%COMP%]   path.iconFill2[_ngcontent-%COMP%]{fill:#c8c6c4}svg[_ngcontent-%COMP%]   path.iconFill3[_ngcontent-%COMP%]{fill:#3a3a38}svg[_ngcontent-%COMP%]   path.iconFill4[_ngcontent-%COMP%]{fill:#1e8bcd}svg[_ngcontent-%COMP%]   path.iconFill5[_ngcontent-%COMP%]{fill:#0063b1}svg[_ngcontent-%COMP%]   path.iconFill6[_ngcontent-%COMP%]{fill:#83beec}svg[_ngcontent-%COMP%]   path.iconFill7[_ngcontent-%COMP%]{fill:#252423}svg[_ngcontent-%COMP%]   path.iconFillWhite[_ngcontent-%COMP%]{fill:#fff}.toggled[_ngcontent-%COMP%]{background-color:#d3d3d3}.container[_ngcontent-%COMP%]{width:20px;height:20px;display:inline-block}.container.narrow[_ngcontent-%COMP%]{width:10px}.container.disabled[_ngcontent-%COMP%]{opacity:.2}"],changeDetection:0}),a}();function Bt(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar-icon",4),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("iconType",t.iconName)}}function Nt(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar-cf-gradient-icon",5),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",t.disabled)("iconName",t.iconName)("iconColors",t.iconColors)("iconMode",t.iconModeEnum.Compact)}}function zt(a,o){1&a&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275element(1,"pbi-office-icon",7),e.\u0275\u0275elementEnd())}var Ke=function(){function a(){this.customIcon=!1,this.showChevron=!1,this.clicked=new e.EventEmitter,this.iconModeEnum=Y}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-button"]],inputs:{disabled:"disabled",iconName:"iconName",iconColors:"iconColors",selected:"selected",customIcon:"customIcon",showChevron:"showChevron",ariaLabel:"ariaLabel",ariaHasPopup:"ariaHasPopup"},outputs:{clicked:"clicked"},decls:5,vars:11,consts:[["data-automation-type","mini-toolbar-button",1,"mini-toolbar-button",3,"disabled","click"],["class","icon",3,"iconType",4,"ngIf","ngIfElse"],["officeIconBlock",""],["class","chevron-container",4,"ngIf"],[1,"icon",3,"iconType"],[3,"disabled","iconName","iconColors","iconMode"],[1,"chevron-container"],["name","CommonControlChevronDown_12",1,"icon"]],template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(l){return!n.disabled&&n.clicked.emit(l)}),e.\u0275\u0275template(1,Bt,1,1,"mini-toolbar-icon",1),e.\u0275\u0275template(2,Nt,1,4,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,zt,2,0,"div",3),e.\u0275\u0275elementEnd()),2&t){var i=e.\u0275\u0275reference(3);e.\u0275\u0275classProp("selected",n.selected)("show-chevron",n.showChevron),e.\u0275\u0275property("disabled",n.disabled),e.\u0275\u0275attribute("aria-haspopup",n.ariaHasPopup)("aria-label",n.ariaLabel)("aria-pressed",n.selected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.customIcon)("ngIfElse",i),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.showChevron)}},dependencies:[U.NgIf,ne.m,z,kt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row}.mini-toolbar-button[_ngcontent-%COMP%]{background:none;border:none;box-sizing:border-box;--buttonBackgroundSelected: var(--gray-40);--buttonBackgroundHover: var(--gray-30);--buttonBackgroundSelectedHover: var(--gray-50);--buttonColorSelected: var(--gray-180);--buttonColorHover: var(--gray-180);flex:none}[data-legacy-theming=false][_ngcontent-%COMP%]   .mini-toolbar-button[_ngcontent-%COMP%]{--buttonBackgroundSelected: var(--colorNeutralBackground1Selected);--buttonBackgroundHover: var(--colorNeutralBackground1Hover);--buttonBackgroundSelectedHover: var(--colorNeutralBackground1Pressed);--buttonColorSelected: var(--colorNeutralForeground1Selected);--buttonColorHover: var(--colorNeutralForeground1Hover)}.mini-toolbar-button[_ngcontent-%COMP%]:hover:not(:focus-visible), .mini-toolbar-button[_ngcontent-%COMP%]:active:not(:focus-visible){border:none}.mini-toolbar-button[_ngcontent-%COMP%]:hover:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundHover);color:var(--buttonColorHover)}.mini-toolbar-button[_ngcontent-%COMP%]:active:not(:disabled):not([disabled]):not(.disabled), .mini-toolbar-button[_ngcontent-%COMP%]:hover:active:not(:disabled):not([disabled]):not(.disabled){background-color:var(--buttonBackgroundSelectedHover);color:var(--buttonColorHover)}.mini-toolbar-button.ql-active[_ngcontent-%COMP%]:not(:hover):not(:active), .mini-toolbar-button.selected[_ngcontent-%COMP%]:not(:hover):not(:active){background-color:var(--buttonBackgroundSelected);color:var(--buttonColorSelected)}.mini-toolbar-button[_ngcontent-%COMP%]:focus-visible{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.mini-toolbar-button[_ngcontent-%COMP%]:disabled, .mini-toolbar-button[disabled][_ngcontent-%COMP%], .mini-toolbar-button.disabled[_ngcontent-%COMP%]{background:none;color:var(--gray-90)}.mini-toolbar-button[_ngcontent-%COMP%]:disabled   .icon[_ngcontent-%COMP%], .mini-toolbar-button[disabled][_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .mini-toolbar-button.disabled[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:40%}.mini-toolbar-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}.mini-toolbar-button[_ngcontent-%COMP%]{width:28px;height:28px;padding:4px;display:flex;align-items:center;justify-content:center}.mini-toolbar-button.show-chevron[_ngcontent-%COMP%]{width:48px}.chevron-container[_ngcontent-%COMP%]{width:20px;padding:0 0 0 4px;display:flex;align-items:center;justify-content:center}.chevron-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:12px;height:12px}"],changeDetection:0}),a}(),Ye=s(10342),Xe=s(14463),Je=s(30794),Se=s(33554),_e=s(72262),fe=function(){function a(o){this.selectionService=o,this.contextMenuActionExecuted$=new Je.xQ,this.miniToolbarActionTouched$=new Je.xQ,this.formatPaneRegistered$=new Se.t(1),this.formatPaneCardExpansion$=new Se.t(1)}return a.prototype.executeContextMenuAction=function(){this.contextMenuActionExecuted$.next()},a.prototype.onMiniToolbarTouched=function(){this.miniToolbarActionTouched$.next()},a.prototype.registerFormatPane=function(){this.formatPaneRegistered$.next(!0)},a.prototype.deregisterFormatPane=function(){this.formatPaneRegistered$.next(!1)},a.prototype.getFormatPaneRegistered$=function(){return this.formatPaneRegistered$},a.prototype.getFormatPaneCardExpansion$=function(){return this.formatPaneCardExpansion$},a.prototype.setFormatPaneCardExpansion=function(o){this.formatPaneCardExpansion$.next(o)},a.prototype.markCardNavigationAsHandled=function(){this.formatPaneCardExpansion$.next(void 0)},a.prototype.handleFormatPaneInteraction=function(){me.UP.clearSubSelections(this.selectionService)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(_e.z))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Rt={provide:Ye.a,useFactory:function(a,o){return a.resolve(o)},deps:[Xe.t,fe]},Lt=s(4877),Ht=s(65181),Wt=s(5467),De=s(86940),we=s(8082),Gt=s(36861),Ze=s(42189),Qt=s(45924),ve=s(59973),oe=s(48787),Ee=s(23558),qe=s(84354),et=function(){function a(o){var t=this;this.pbiDropdownService=o,this.autocompleteElementRef$=this.pbiDropdownService.select$("autocompleteElementRef"),this.compact$=this.pbiDropdownService.select$("compact"),this.disabled$=this.pbiDropdownService.select$("disabled"),this.dropdownItems$=this.pbiDropdownService.select$("dropdownItems"),this.elementRef$=this.pbiDropdownService.select$("elementRef"),this.isInputFocused$=this.pbiDropdownService.select$("containerFocused"),this.isOpen$=this.pbiDropdownService.select$("open"),this.overlayRef$=this.pbiDropdownService.select$("overlayRef");var n=this.pbiDropdownService.onDestroy$;this.dropdownItems$.pipe((0,ve.h)(function(i){return!!i}),(0,oe.q)(1)).subscribe(function(i){i.changes.pipe((0,C.R)(n),(0,j.U)(function(r){return r.length}),(0,D.O)(i.length),(0,Ee.M)(t.overlayRef$,t.compact$,t.elementRef$)).subscribe(function(r){var l=r[0],u=r[1],d=r[2];if(u){var m=r[3].nativeElement.getBoundingClientRect(),g=t.getDropdownHeight(m,l,d);u.overlayRef.updateSize({minHeight:g})}t.pbiDropdownService.updateState({totalItems:l,overlayRef:u})})}),this.isInputFocused$.pipe((0,C.R)(n),(0,Ee.M)(this.autocompleteElementRef$,this.isOpen$),(0,ve.h)(function(i){return!!i[1]})).subscribe(function(i){var l=i[1],u=i[2];i[0]&&(l.nativeElement.focus(),l.nativeElement.select(),u||t.pbiDropdownService.toggleOpenState())}),(0,P.aj)([this.autocompleteElementRef$,this.disabled$,this.isOpen$]).pipe((0,C.R)(n),(0,ve.h)(function(i){return!!i[0]})).subscribe(function(i){return t.updateAttributes(i[0],i[1],i[2])})}return a.prototype.getDropdownHeight=function(o,t,n){return(0,Qt.z)(o,t,n)},a.prototype.buttonKeydown=function(o){var t=this;(0,P.aj)([this.dropdownItems$,this.isOpen$]).pipe((0,ve.h)(function(n){return!!n[0]}),(0,Ee.M)(this.overlayRef$,this.isInputFocused$),(0,oe.q)(1)).subscribe(function(n){var i=n[0],r=i[0],u=n[1],d=n[2];if(i[1])switch(o.keyCode){case 40:if(!d)break;o.stopPropagation();case 36:case 33:r.first.focus(),o.preventDefault();break;case 38:if(!d)break;o.stopPropagation();case 35:case 34:r.last.focus(),o.preventDefault();break;case 27:t.closeDropdown(u),o.preventDefault(),o.stopPropagation();break;case 9:d&&t.closeDropdown(u);break;case 32:o.stopPropagation();break;default:t.autoSelect(o.key,r)}else switch(o.keyCode){case 13:case 38:case 40:t.pbiDropdownService.toggleOpenState(),o.preventDefault();break;case 36:case 33:t.pbiDropdownService.onSelectionChange({value:r.first.value}),o.preventDefault();break;case 35:case 34:t.pbiDropdownService.onSelectionChange({value:r.last.value}),o.preventDefault();break;case 32:o.stopPropagation()}})},a.prototype.containerFocused=function(o){this.pbiDropdownService.updateState({containerFocused:o})},a.prototype.closeDropdown=function(o){o.close(),this.pbiDropdownService.updateState({overlayRef:o=void 0,open:!1})},a.prototype.autoSelect=function(o,t){var n=t.find(function(i){return i.item.nativeElement.textContent.toLocaleLowerCase().startsWith(o.toLocaleLowerCase())});n&&n.focus()},a.prototype.updateAttributes=function(o,t,n){var i=o.nativeElement;i.setAttribute("role","combobox"),i.setAttribute("aria-haspopup","listbox"),i.setAttribute("aria-autocomplete","list"),i.setAttribute("aria-expanded",n),i.style.cursor="text",i.style.border="none",i.style.outline="none",i.style.flexGrow=1,t?(i.setAttribute("disabled",!0),i.style.backgroundColor="var(--gray-20, @gray-20)",i.style.color="var(--gray-90, @gray-90)",i.style.pointerEvents="none"):(i.removeAttribute("disabled"),i.style.backgroundColor=null,i.style.color=null,i.style.pointerEvents=null)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(qe.S))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Kt=s(26333),Yt=s(31343),tt=s(59787),Xt=["autocompleteInput"],Jt=function(){function a(o,t,n){this.elementRef=o,this.pbiDropdownService=t,this.strategy=n,this.onDestroy$=this.pbiDropdownService.onDestroy$}return a.prototype.ngAfterViewInit=function(){var o=this;(0,Kt.x)([{autocompleteElementRef:this.autocompleteInput,dropdownItems:this.dropdownItems,strategy:this.strategy}],Yt.N).subscribe(function(t){o.pbiDropdownService.updateState(t)}),(0,tt.R)(this.elementRef.nativeElement.children[0],"focus").pipe((0,C.R)(this.onDestroy$)).subscribe(function(){o.strategy.containerFocused&&o.strategy.containerFocused(!0)}),(0,tt.R)(this.autocompleteInput.nativeElement,"blur").pipe((0,C.R)(this.onDestroy$)).subscribe(function(){o.strategy.containerFocused&&o.strategy.containerFocused(!1)})},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(qe.S),e.\u0275\u0275directiveInject(et))},a.\u0275dir=e.\u0275\u0275defineDirective({type:a,selectors:[["pbi-dropdown","dropdown-type","autocomplete"]],contentQueries:function(t,n,i){if(1&t&&(e.\u0275\u0275contentQuery(i,Xt,5),e.\u0275\u0275contentQuery(i,Ze.r,5)),2&t){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.autocompleteInput=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.dropdownItems=r)}},features:[e.\u0275\u0275ProvidersFeature([et])]}),a}(),nt=s(76492),Zt=s(78173),qt=s(85102);function en(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mini-toolbar-button",2),e.\u0275\u0275listener("clicked",function(){var l=e.\u0275\u0275restoreView(t).$implicit,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.clicked(l.value))}),e.\u0275\u0275elementEnd()}if(2&a){var n=o.$implicit;e.\u0275\u0275property("iconName",n.icon),e.\u0275\u0275attribute("data-automation-id",n.icon)}}var tn=["backgroundColorDropdown"],nn=["fillColorDropdown"],on=["fontColorDropdown"],rn=["lineColorDropdown"],an=["alignDropdown"],ln=["displayUnitsDropdown"],sn=["largeBorderDropdown"],cn=["largeGridDropdown"],un=["self"];function dn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",13,14),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(2).ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.displayUnitsClicked(r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("ariaLabel",e.\u0275\u0275pipeBind1(3,5,"Visual_Forecast_Parameter_Units"))("disabled",n.disabled.displayUnits)("customIcon",!0)("showChevron",!0)}}var pn=function(o){return{warning:o}};function mn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"font-picker",9),e.\u0275\u0275listener("onFontFamilyChange",function(l){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext().ngIf,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.fontFamilyChanged(l,u.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"pbi-spin-button",10),e.\u0275\u0275listener("ngModelChange",function(l){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext().ngIf,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.fontSizeChanged(l,u.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mini-toolbar-button",11),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext().ngIf,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.adjustFontSize("increaseFontSize",l.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mini-toolbar-button",12),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext().ngIf,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.adjustFontSize("decreaseFontSize",l.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,dn,4,7,"ng-container",0),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,18,"Font"))("showFullContent",!0)("fontFamily",n.values.fontProperties.fontFamily)("isDisabled",n.disabled.fontProperties)("size",i.fontFamilyPickerSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(26,pn,!!n.warnings.fontSize))("ariaLabel",e.\u0275\u0275pipeBind1(4,20,"FontSize"))("ngModel",n.values.fontProperties.fontSize)("options",i.fontSizeSpinButtonOptions)("disabled",n.disabled.fontProperties||n.disabled.fontSize)("size",i.fontSizePickerSize)("pbiTooltip",n.warnings.fontSize?i.MiniToolbarWarningComponent:void 0)("pbiTooltipComponentData",n.warnings.fontSize||void 0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,22,"Visual_IncreaseFontSize"))("disabled",n.disabled.increaseFontSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(8,24,"Visual_DecreaseFontSize"))("disabled",n.disabled.decreaseFontSize),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","NumericText"===n.mode)}}function fn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",15),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.biuChanged("bold",!r.values.bold,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-button",16),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.biuChanged("italic",!r.values.italic,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mini-toolbar-button",17),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.biuChanged("underline",!r.values.underline,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,9,"Bold"))("selected",n.values.bold)("disabled",n.disabled.bold),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(4,11,"Italic"))("selected",n.values.italic)("disabled",n.disabled.italic),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,13,"Underline"))("selected",n.values.underline)("disabled",n.disabled.underline)}}function vn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mini-toolbar-button",18,19),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.backgroundColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("iconColors",n.values.backgroundColors)("disabled",n.disabled.background)("showChevron",!0)("ariaHasPopup","menu")}}function gn(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",29),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){var t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.visualSubSelection.displayName," ")}}function hn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-dropdown",25),e.\u0275\u0275listener("valueChange",function(r){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext(2).ngIf,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onDisambiguationValueChange(r,l.subSelectionPosition))}),e.\u0275\u0275elementStart(1,"pbi-dropdown-trigger"),e.\u0275\u0275element(2,"input",26,27),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,gn,2,2,"pbi-dropdown-item",28),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("maxHeight",324)("value",n.subSelectedItem),e.\u0275\u0275advance(2),e.\u0275\u0275property("formControl",n.autocompleteControl),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(5,4,n.filteredSubselectables$))}}function bn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-large-button",20,21),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.fillColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-large-button",22,23),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.strokeColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,hn,6,6,"pbi-dropdown",24),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("iconColors",n.values.fillColors)("disabled",n.disabled.fill)("label",n.labels.fill),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaHasPopup","menu")("iconColors",n.values.strokeColors)("disabled",n.disabled.stroke)("label",n.labels.stroke),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.subSelectables.length>1)}}function yn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",30,31),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.fontColorClicked(r.mode,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mini-toolbar-button",32,33),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.alignClicked(r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mini-toolbar-button",34),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.wordWrapChanged(!r.values.wordWrap,r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaHasPopup","menu")("ariaLabel",e.\u0275\u0275pipeBind1(3,11,"Visual_FontColor"))("iconColors",n.values.fontColors)("disabled",n.disabled.fontColor)("showChevron",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(6,13,"Visual_TextAlignment"))("iconName",n.values.alignIconType||"Centered_20")("disabled",n.disabled.horizontalAlignment),e.\u0275\u0275advance(3),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(8,15,"Visual_WordWrap"))("selected",n.values.wordWrap)("disabled",n.disabled.wordWrap)}}function Sn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mini-toolbar-button",35),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.adjustDecimal("increaseDecimal",r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mini-toolbar-button",36),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.adjustDecimal("decreaseDecimal",r.boundSubSelectionStylesSlices))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(2,4,"Visual_IncreaseDecimal"))("disabled",n.disabled.increaseDecimal),e.\u0275\u0275advance(2),e.\u0275\u0275property("ariaLabel",e.\u0275\u0275pipeBind1(4,6,"Visual_DecreaseDecimal"))("disabled",n.disabled.decreaseDecimal)}}function Cn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",4)(2,"div",6)(3,"mini-toolbar-large-button",38,39),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.borderStyleClicked(i.boundContainer))}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}2&a&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(5,1,"Visual_Border")))}function xn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",4)(2,"div",6)(3,"mini-toolbar-large-button",40,41),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.gridStyleClicked(i.boundContainer))}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}2&a&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(5,1,"Visual_Grid")))}function _n(a,o){if(1&a&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,Cn,6,3,"ng-container",0),e.\u0275\u0275template(2,xn,6,3,"ng-container",0),e.\u0275\u0275elementEnd()),2&a){var t=e.\u0275\u0275nextContext().ngIf,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",("Text"===t.mode||"NumericText"===t.mode)&&!!n.subSelectionStyles.border),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!n.subSelectionStyles.grid)}}var Mn=function(o){return{hidden:o}};function In(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",1,2),e.\u0275\u0275listener("pointerdown",function(){e.\u0275\u0275restoreView(t);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onPointerDown())}),e.\u0275\u0275elementStart(3,"div",3)(4,"div",4),e.\u0275\u0275template(5,mn,10,28,"div",5),e.\u0275\u0275elementStart(6,"div",6),e.\u0275\u0275template(7,fn,7,15,"ng-container",0),e.\u0275\u0275template(8,vn,2,4,"mini-toolbar-button",7),e.\u0275\u0275template(9,bn,6,9,"ng-container",0),e.\u0275\u0275template(10,yn,9,17,"ng-container",0),e.\u0275\u0275template(11,Sn,5,8,"ng-container",0),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(12,_n,3,2,"div",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&a){var n=o.ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(8,Mn,!n.mode)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Shape"!==n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Shape"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Text"===n.mode||"NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","NumericText"===n.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!i.subSelectionStyles.border||!!i.subSelectionStyles.grid)}}var it=".container[_ngcontent-%COMP%]{border-radius:2px;background-color:var(--white-color);box-shadow:var(--fluent-shadow-depth8);padding:4px;width:fit-content}.container.hidden[_ngcontent-%COMP%]{display:none}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding-bottom:4px}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:last-child{padding-bottom:0}.container[_ngcontent-%COMP%]   .colContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row}.container[_ngcontent-%COMP%]   .extraItemsContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;border-left:1px solid var(--fluent-theme-neutral-light-color)}.container[_ngcontent-%COMP%]   .colItem[_ngcontent-%COMP%]{display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   .font-family[_ngcontent-%COMP%]{width:128px;margin-right:4px}.container[_ngcontent-%COMP%]   .font-size[_ngcontent-%COMP%]{width:52px}.container[_ngcontent-%COMP%]   .disambiguation-menu[_ngcontent-%COMP%]{padding:14px 8px;width:180px}",Ue={left:"LeftAlign_20",center:"Centered_20",right:"RightAlign_20",Auto:void 0},wn={Left:"left",Center:"center",Right:"right",Auto:"Auto"},En=function(){function a(o){this.picked=o,this.alignments=Object.keys(Ue).filter(function(t){return"Auto"!==t}).map(function(t){return{value:t,icon:Ue[t]}})}return a.prototype.clicked=function(o){this.picked(o)},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(le.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-alignment"]],decls:2,vars:1,consts:[[1,"alignment-container","container","row"],[3,"iconName","clicked",4,"ngFor","ngForOf"],[3,"iconName","clicked"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,en,1,2,"mini-toolbar-button",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.alignments))},dependencies:[U.NgForOf,Ke],styles:[it],changeDetection:0}),a}(),ot=function(a){function o(t,n,i,r,l,u,d,p,m,g,f){var v=a.call(this)||this;return v.changeDetector=t,v.componentFactoryResolver=n,v.formattingUIManager=i,v.injector=r,v.itemPickerService=l,v.lazyScoped=u,v.localizationService=d,v.menuService=p,v.overlay=m,v.runningVisuals=g,v.selectionService=f,v.fontSizeSpinButtonOptions={minValue:ye.r4,maxValue:ye.YR,stepAmount:1},v.fontFamilyPickerSize="sm",v.fontSizePickerSize="sm",v.MiniToolbarWarningComponent=Ut,v.rainbowColorValues=["#Ff0000","#ff0","#0f0","#00BCE3","#0000ff","#f0f"],v.autocompleteControl=new re.p4,v.overlays={alignOverlayRef:void 0,borderOverlayRef:void 0,colorOverlayRef:void 0,displayUnitsMenuRef:void 0,gridOverlayRef:void 0},v}return(0,c.__extends)(o,a),o.prototype.ngOnInit=function(){var t=this;Promise.all([this.lazyScoped.get(L.ub),this.lazyScoped.get(L.Vj)]).then(function(n){var i=n[0],r=n[1];t.formattingService=i,t.formattingUIService=r,k.fF.assert(function(){return 1===t.subSelectionUpdateArgs.subSelections.length},"expected subselections of length 1"),k.fF.assert(function(){return!!t.subSelectedItem},"expected subSelectedItem"),k.fF.assert(function(){return!!t.subSelectedItem.visualSubSelection.selectionOrigin},"miniToolbar - subSelectedItem should not have an empty selectionOrigin, onDisambiguationValueChange should have been handled and added selectionOrigin");var l=t.changes$("subSelectedItem").pipe((0,j.U)(function(h){return h.visualSubSelection})),u=l.pipe((0,j.U)(function(h){return{x:h.selectionOrigin.x,y:h.selectionOrigin.y}})),d=(0,P.aj)([t.changes$("subSelectionUpdateArgs"),l]).pipe((0,ae.w)(function(h){var y=h[1];return i.getFor({type:0,canvasItem:h[0].canvasItem}).getSubSelectables$().pipe((0,j.U)(function(E){return _.isEmpty(E)?[]:E.filter(function(F){return F.subSelectionType===y.subSelectionType}).map(function(F){return{visualSubSelection:F,source:"disambiguationMenu",triggerAction:0}})}))}));t.autocompleteControl.setValue(t.subSelectedItem.visualSubSelection.displayName,{emitEvent:!1}),t.filteredSubselectables$=(0,P.aj)([t.autocompleteControl.valueChanges.pipe((0,D.O)("")),d]).pipe((0,C.R)(t.onDestroy$),(0,j.U)(function(h){return t.getFilteredSubselectables(h[0],h[1])}));var p=t.changes$("subSelectionStyles").pipe((0,j.U)(function(h){return 1===h.type?"Text":2===h.type?"NumericText":"Shape"})),m=t.changes$("subSelectionUpdateArgs").pipe((0,M.j)("canvasItem")),g=t.formattingUIService.getSubSelectionStylesSlices$(m.pipe((0,j.U)(function(h){return[h]}))),f=(0,P.aj)([p,g,m]).pipe((0,j.U)(function(h){var b=h[0],y=h[1],S=h[2];return"Text"===b||"NumericText"===b?t.bindToText(y,S):"Shape"===b?t.bindToShape(y,S):{disabled:{},values:{fontProperties:{fontFamily:"",fontSize:0}},lables:{},warnings:{}}}),(0,T.d)({bufferSize:1,refCount:!0})),v=f.pipe((0,M.j)("disabled")),I=f.pipe((0,M.j)("values")),O=f.pipe((0,M.j)("labels")),x=f.pipe((0,M.j)("warnings"));t.viewModel$=(0,P.aj)([m,g,v,O,p,d,u,I,x]).pipe((0,j.U)(function(h){return{boundContainer:h[0],boundSubSelectionStylesSlices:h[1],disabled:h[2],labels:h[3],mode:h[4],subSelectables:h[5],subSelectionPosition:h[6],values:h[7],warnings:h[8]}})),t.onDestroy$.subscribe(function(){return t.closeOverlays()}),t.changeDetector.detectChanges()})},o.prototype.onDisambiguationValueChange=function(t,n){return(0,c.__awaiter)(this,void 0,void 0,function(){var i,r,l;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return i=me.UP.getSelectedCanvasItem(this.selectionService),r=(0,c.__assign)((0,c.__assign)({},t),{visualSubSelection:(0,c.__assign)((0,c.__assign)({},t.visualSubSelection),{showUI:!0})}),this.autocompleteControl.setValue((l=r.visualSubSelection).displayName,{emitEvent:!1}),n||k.fF.assertFail("Disambiguation menu should not be able to be called without a position set"),l.selectionOrigin={x:n.x,y:n.y},me.UP.selectSubSelection(this.selectionService,i,[r],0),[4,this.lazyScoped.get("formatModeService")];case 1:return[4,d.sent().triggerShowUI({canvasItem:i,subSelections:[r]})];case 2:return d.sent(),[2]}})})},o.prototype.onPointerDown=function(){this.formattingUIManager.onMiniToolbarTouched()},o.prototype.getConditionalFormattingGradient=function(t,n){var i,r,l,d,u=(0,xt.my)(t,n.objectName,n.selector);if(u&&(d=u.properties[n.propertyName]),d&&(0,Mt.X2)(d)){var m=d&&d.solid&&d.solid.color;if(m&&!(0,be.VC)(m)&&!(0,be.wt)(m)){if((0,be.Tu)(m)){var g=(0,St.qG)(m.rule),f=this.itemPickerService.getDataColors().getGradientColors(),v=[];return v.push(null!==(i=g.minColor)&&void 0!==i?i:f.minColor.value),g.diverging&&v.push(null!==(r=g.midColor)&&void 0!==r?r:f.midColor.value),v.push(null!==(l=g.maxColor)&&void 0!==l?l:f.maxColor.value),v}if((0,be.Gs)(m))return m.cases.reverse().map(function(I){return _t.jz.getTextValue(I.value)});if((0,be.kb)(m)||(0,be.iV)(m))return this.rainbowColorValues}}},o.prototype.getColorProperties=function(t,n){var i,r,l,u;if(!n)return{disabled:!0};var g,d=n.properties,m=null===(i=d.conditionalFormattingObjects)||void 0===i?void 0:i.isSet;if(!d)return{disabled:!0};if(d.disabled)g=[Pe.UD];else if(m){var f;f=(0,se.Vz)(t)?_.merge({},t.config.singleVisual.vcObjects,t.config.singleVisual.objects):null!==(r=t.objects)&&void 0!==r?r:{},g=n.instances.length>1?[Pe.UD]:this.getConditionalFormattingGradient(f,n.instances[0].descriptor)}return g||(g=[null!==(u=null===(l=n.resolvedValue)||void 0===l?void 0:l.value)&&void 0!==u?u:Pe.UD]),{disabled:!1,value:g,label:d.label}},o.prototype.bindToText=function(t,n){var i={},r={fontProperties:void 0},u={};r.fontProperties={fontFamily:"",fontSize:0};var d=t.fontFamily;d&&d.properties?(i.fontProperties=!1,r.fontProperties.fontFamily=d.resolvedValue):i.fontProperties=!0;var m=t.fontSize,g=m&&m.properties;g?(i.increaseFontSize=!1,i.decreaseFontSize=!1,i.fontSize=!1,r.fontProperties.fontSize=m.resolvedValue,g.options&&(this.fontSizeSpinButtonOptions.minValue=null==g.options.minValue?ye.r4:g.options.minValue.value,this.fontSizeSpinButtonOptions.maxValue=null==g.options.maxValue?ye.YR:g.options.maxValue.value),u.fontSize=g.warning):(i.increaseFontSize=!0,i.decreaseFontSize=!0,i.fontSize=!0,u.fontSize=void 0,this.fontSizeSpinButtonOptions.minValue=ye.r4,this.fontSizeSpinButtonOptions.maxValue=ye.YR);var f=t.bold;f?(i.bold=!1,r.bold=f.resolvedValue):i.bold=!0;var v=t.italic;v?(i.italic=!1,r.italic=v.resolvedValue):i.italic=!0;var I=t.underline;I?(i.underline=!1,r.underline=I.resolvedValue):i.underline=!0;var x=this.getColorProperties(n,t.background);i.background=!x||x.disabled,r.backgroundColors=x?.value||[""];var b=this.getColorProperties(n,t.fontColor);i.fontColor=!b||b.disabled,r.fontColors=b?.value||[""];var y=t.horizontalAlignment;if(y&&y.properties){i.horizontalAlignment=!1;var w=this.getAlignmentFromControl(y.resolvedValue,y.instances);r.alignIconType=Ue[w],r.alignIconType||(i.horizontalAlignment="Auto"!==w,r.alignIconType="")}else i.horizontalAlignment=!0,r.alignIconType="";var E=t.wordWrap;E&&E.properties?(i.wordWrap=!1,r.wordWrap=E.resolvedValue):(i.wordWrap=!0,r.wordWrap=!1);var B=t.precision;return B&&B.properties?(i.increaseDecimal=!1,i.decreaseDecimal=!1):(i.increaseDecimal=!0,i.decreaseDecimal=!0),i.displayUnits=!t.displayUnits,{disabled:i,values:r,labels:{},warnings:u}},o.prototype.bindToShape=function(t,n){var i={},r={fontProperties:void 0},l={},p=this.getColorProperties(n,t.fill);i.fill=p.disabled,r.fillColors=p.value||[""],l.fill=p.label||this.localizationService.get("Visual_Fill");var g=this.getColorProperties(n,t.stroke);return i.stroke=g.disabled,r.strokeColors=g.value||[""],l.stroke=g.label||this.localizationService.get("Visual_Border"),{disabled:i,values:r,labels:l,warnings:{}}},o.prototype.fontFamilyChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"fontFamily",value:t},{source:"MiniToolbar"})},o.prototype.fontSizeChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"fontSize",value:t},{source:"MiniToolbar"})},o.prototype.adjustFontSize=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:t},{source:"MiniToolbar"})},o.prototype.biuChanged=function(t,n,i){this.closeOverlays(),this.formattingUIService.onControlClicked(i,{key:t,value:n},{source:"MiniToolbar"})},o.prototype.colorClicked=function(t,n,i){var r=this;this.closeOverlays(this.overlays.colorOverlayRef)||t&&(this.overlays.colorOverlayRef=this.formattingUIService.openColorPicker(t,this.minitoolbar.nativeElement,function(){return r.closeOverlays()},{source:"MiniToolbar"}))},o.prototype.fontColorClicked=function(t,n){this.colorClicked(n.fontColor,"fontColor",t)},o.prototype.fillColorClicked=function(t,n){this.colorClicked(n.fill,"fill",t)},o.prototype.backgroundColorClicked=function(t,n){this.colorClicked(n.background,"background",t)},o.prototype.strokeColorClicked=function(t,n){this.closeOverlays(),this.colorClicked(n.stroke,"stroke",t)},o.prototype.wordWrapChanged=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:"wordWrap",value:t},{source:"MiniToolbar"})},o.prototype.adjustDecimal=function(t,n){this.closeOverlays(),this.formattingUIService.onControlClicked(n,{key:t},{source:"MiniToolbar"})},o.prototype.alignClicked=function(t){var n=this;if(t.horizontalAlignment&&!this.closeOverlays(this.overlays.alignOverlayRef)){var r=this.overlay.position().flexibleConnectedTo(this.alignDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:10}]);this.overlays.alignOverlayRef=this.overlay.open({component:En,data:function(u){n.closeOverlays(),n.alignChanged(u,t)},closeOnBackdropClick:!0,options:{positionStrategy:r,hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver}),this.overlays.alignOverlayRef.onClose.subscribe(function(){n.overlays.alignOverlayRef=void 0})}},o.prototype.alignChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"horizontalAlignment",value:t},{source:"MiniToolbar"})},o.prototype.displayUnitsClicked=function(t){var n=this;if(!this.closeOverlays(this.overlays.displayUnitsMenuRef)){var i=t.displayUnits;if(i){var u=i.resolvedValue,d={menu:{items:_.map(i.properties.items,function(p){return{type:H.iB.Button,text:p.displayName,data:p,checked:p.value===u.value,checkable:!0}})},origin:this.displayUnitsDropdown.nativeElement};this.overlays.displayUnitsMenuRef=this.menuService.open(d),this.overlays.displayUnitsMenuRef.onClose$.subscribe(function(){n.overlays.displayUnitsMenuRef=void 0}),this.overlays.displayUnitsMenuRef.onButtonClick$.subscribe(function(p){n.displayUnitsChanged(p.data.value,t),n.closeOverlays()})}}},o.prototype.displayUnitsChanged=function(t,n){this.formattingUIService.onControlClicked(n,{key:"displayUnits",value:t},{source:"MiniToolbar"})},o.prototype.borderStyleClicked=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,r,l,u,d=this;return(0,c.__generator)(this,function(p){switch(p.label){case 0:return this.closeOverlays(this.overlays.borderOverlayRef)?[2]:(0,se.Vz)(t)?(n=this.overlay.position().flexibleConnectedTo(this.largeBorderDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:0}]),i=this.runningVisuals.getVisual(t),[4,i?.getSubSelectionShortcuts([this.subSelectedItem.visualSubSelection],"border")]):[2];case 1:return r=p.sent(),[4,i?.getSubSelectionStyles([this.subSelectedItem.visualSubSelection])];case 2:return l=p.sent(),u=this.formattingUIService.getMenuItems$(r,t,[l],i).pipe((0,j.U)(function(m){return{items:_.flatten(m)}})),this.overlays.borderOverlayRef=this.openMiniToolbarContextMenu(t,r,n,u),this.overlays.borderOverlayRef.onClose.subscribe(function(){d.overlays.borderOverlayRef=void 0}),[2]}})})},o.prototype.gridStyleClicked=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,r,l,u,d=this;return(0,c.__generator)(this,function(p){switch(p.label){case 0:return this.closeOverlays(this.overlays.gridOverlayRef)?[2]:(0,se.Vz)(t)?(n=this.overlay.position().flexibleConnectedTo(this.largeGridDropdown.nativeElement).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:0}]),i=this.runningVisuals.getVisual(t),[4,i?.getSubSelectionShortcuts([this.subSelectedItem.visualSubSelection],"grid")]):[2];case 1:return r=p.sent(),[4,i?.getSubSelectionStyles([this.subSelectedItem.visualSubSelection])];case 2:return l=p.sent(),u=this.formattingUIService.getMenuItems$(r,t,[l],i).pipe((0,j.U)(function(m){return{items:_.flatten(m)}})),this.overlays.gridOverlayRef=this.openMiniToolbarContextMenu(t,r,n,u),this.overlays.gridOverlayRef.onClose.subscribe(function(){d.overlays.gridOverlayRef=void 0}),[2]}})})},o.prototype.openMiniToolbarContextMenu=function(t,n,i,r){var l=this;return this.overlay.open({component:Ft,data:{subSelectionUpdateArgs:{canvasItem:t,subSelections:[this.subSelectedItem.visualSubSelection]},subSelectionStyles:void 0,subSelectionShortcuts:n,menuInput$:r,closeOverlays:function(){return l.closeOverlays()}},closeOnBackdropClick:!0,options:{positionStrategy:i,hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver})},o.prototype.closeOverlays=function(t){var n=!1;for(var i in this.overlays){var r=this.overlays[i];r&&(this.overlays[i]=void 0,n=n||t===r,r.close())}return n},o.prototype.getFilteredSubselectables=function(t,n){var i=t.toLocaleLowerCase();return n.filter(function(l){return l.visualSubSelection.displayName.toLocaleLowerCase().includes(i)})},o.prototype.getAlignmentFromControl=function(t,n){var i,r=n[0].descriptor.type;if(k.fF.assert(function(){return _.every(n,function(u){return u.descriptor.type===r})},"MiniToolbar alignment - expected all the descriptors to have same property type"),Ge.Ge.isValueTypeDescriptor(r)){var l=Ge.Ge.fromDescriptor(r);if(l.enum===Ct.K)return wn[t];if(null!==(i=l.formatting)&&void 0!==i&&i.alignment)return t;k.fF.assertFail("MiniToolbar alignment - unexpected descriptor property type")}else k.fF.assertFail("MiniToolbar alignment - not a value type descriptor")},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(fe),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Lt.a),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(Ht.o),e.\u0275\u0275directiveInject(Wt.o),e.\u0275\u0275directiveInject(De._),e.\u0275\u0275directiveInject(we.s),e.\u0275\u0275directiveInject(_e.z))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["mini-toolbar"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(tn,5,e.ElementRef),e.\u0275\u0275viewQuery(nn,5,e.ElementRef),e.\u0275\u0275viewQuery(on,5,e.ElementRef),e.\u0275\u0275viewQuery(rn,5,e.ElementRef),e.\u0275\u0275viewQuery(an,5,e.ElementRef),e.\u0275\u0275viewQuery(ln,5,e.ElementRef),e.\u0275\u0275viewQuery(sn,5,e.ElementRef),e.\u0275\u0275viewQuery(cn,5,e.ElementRef),e.\u0275\u0275viewQuery(un,5,e.ElementRef)),2&n){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.backgroundColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.fillColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.fontColorDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.strokeDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.alignDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.displayUnitsDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.largeBorderDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.largeGridDropdown=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.minitoolbar=r.first)}},hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","mini-toolbar")},inputs:{subSelectionUpdateArgs:"subSelectionUpdateArgs",subSelectionStyles:"subSelectionStyles",subSelectedItem:"subSelectedItem"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],[1,"container","smallFontSize",3,"ngClass","pointerdown"],["self",""],[1,"colContainer"],[1,"colItem"],["class","row",4,"ngIf"],[1,"row"],["iconName","FillColorSplitDropdown_20","data-automation-id","mini-toolbar-fill-color",3,"iconColors","disabled","showChevron","ariaHasPopup","clicked",4,"ngIf"],["class","extraItemsContainer",4,"ngIf"],["data-automation-id","mini-toolbar-font-picker",1,"font-family",3,"ariaLabel","showFullContent","fontFamily","isDisabled","size","onFontFamilyChange"],["data-automation-id","mini-toolbar-font-size",1,"font-size",3,"ngClass","ariaLabel","ngModel","options","disabled","size","pbiTooltip","pbiTooltipComponentData","ngModelChange"],["iconName","GrowFont_20","data-automation-id","mini-toolbar-increase-font-size",3,"ariaLabel","disabled","clicked"],["iconName","ShrinkFont_20","data-automation-id","mini-toolbar-decrease-font-size",3,"ariaLabel","disabled","clicked"],["iconName","DisplayUnits","data-automation-id","mini-toolbar-display-units",3,"ariaHasPopup","ariaLabel","disabled","customIcon","showChevron","clicked"],["displayUnitsDropdown",""],["iconName","Bold_20","data-automation-id","mini-toolbar-bold",3,"ariaLabel","selected","disabled","clicked"],["iconName","Italic_20","data-automation-id","mini-toolbar-italic",3,"ariaLabel","selected","disabled","clicked"],["iconName","Underline_20","data-automation-id","mini-toolbar-underline",3,"ariaLabel","selected","disabled","clicked"],["iconName","FillColorSplitDropdown_20","data-automation-id","mini-toolbar-fill-color",3,"iconColors","disabled","showChevron","ariaHasPopup","clicked"],["backgroundColorDropdown",""],["iconName","FillColorSplitDropdown_24","data-automation-id","mini-toolbar-shape-fill-color",3,"ariaHasPopup","iconColors","disabled","label","clicked"],["fillColorDropdown",""],["iconName","TableBorderColorSplitDropdown_24","data-automation-id","mini-toolbar-line-color",3,"ariaHasPopup","iconColors","disabled","label","clicked"],["lineColorDropdown",""],["class","disambiguation-menu","dropdown-type","autocomplete","data-automation-id","mini-toolbar-disambiguration-menu",3,"maxHeight","value","valueChange",4,"ngIf"],["dropdown-type","autocomplete","data-automation-id","mini-toolbar-disambiguration-menu",1,"disambiguation-menu",3,"maxHeight","value","valueChange"],["type","text",1,"auto-input",3,"formControl"],["autocompleteInput",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["iconName","FontColorNoPreview_20","data-automation-id","font-color",3,"ariaHasPopup","ariaLabel","iconColors","disabled","showChevron","clicked"],["fontColorDropdown",""],["data-automation-id","mini-toolbar-alignment",3,"ariaLabel","iconName","disabled","clicked"],["alignDropdown",""],["iconName","WrapText_20","data-automation-id","mini-toolbar-word-wrap",3,"ariaLabel","selected","disabled","clicked"],["iconName","IncreaseDecimal_20","data-automation-id","mini-toolbar-increase-decimal",3,"ariaLabel","disabled","clicked"],["iconName","DecreaseDecimal_20","data-automation-id","mini-toolbar-decrease-decimal",3,"ariaLabel","disabled","clicked"],[1,"extraItemsContainer"],["iconName","BorderDrawToolGrid_20","data-automation-id","mini-toolbar-border",3,"label","clicked"],["largeBorderDropdown",""],["iconName","GridCard_24","data-automation-id","mini-toolbar-grid",3,"label","clicked"],["largeGridDropdown",""]],template:function(n,i){1&n&&(e.\u0275\u0275template(0,In,13,10,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",i.formattingService&&e.\u0275\u0275pipeBind1(1,1,i.viewModel$))},dependencies:[U.NgClass,U.NgForOf,U.NgIf,Gt.w,re.Fj,re.JJ,re.On,Jt,nt.H,Ze.r,nt.T,Zt.a,pe.V,re.oH,Ke,ge,U.AsyncPipe,qt.F],styles:[it],changeDetection:0}),o}(N.w),rt=s(64548);function Tn(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar",4),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",t.data.subSelectionUpdateArgs)("subSelectionStyles",t.data.subSelectionStyles)("subSelectedItem",(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections)&&(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections[0])),e.\u0275\u0275attribute("aria-labelledby",t.ariaLabelledby)}}function On(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"on-object-context-menu",5),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.executeContextMenuAction())}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",n.data.subSelectionUpdateArgs)("subSelectionStyles",n.data.subSelectionStyles)("subSelectionShortcuts",n.data.subSelectionShortcuts)}}var Pn=function(){function a(o,t){var i,r,n=this;this.onObjectUIData=o,this.formattingUIManager=t,this.hideContextMenu=!1,this.data=this.onObjectUIData;var l=null===(i=this.data.subSelectionUpdateArgs)||void 0===i?void 0:i.subSelections;l&&(this.hideContextMenu=l.some(function(u){return"disambiguationMenu"===u.source})),this.ariaLabelledby=(0,rt.u)(null===(r=this.data.subSelectionUpdateArgs)||void 0===r?void 0:r.canvasItem.name),this.subscription=this.formattingUIManager.miniToolbarActionTouched$.pipe((0,oe.q)(1)).subscribe(function(){n.hideContextMenu=!0})}return a.prototype.executeContextMenuAction=function(){this.formattingUIManager.executeContextMenuAction()},a.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(le.M),e.\u0275\u0275directiveInject(fe))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["on-object-container"]],decls:4,vars:4,consts:[[1,"on-object-container"],["class","mini-toolbar","role","toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem",4,"ngIf"],[1,"context-menu"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction",4,"ngIf"],["role","toolbar",1,"mini-toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Tn,1,4,"mini-toolbar",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275template(3,On,1,3,"on-object-context-menu",3),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275classProp("flip",null==n.data?null:n.data.flip),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionStyles)&&(null==n.data?null:n.data.subSelectionUpdateArgs)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionShortcuts)&&!n.hideContextMenu))},styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column}.on-object-container.flip[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{order:1;margin-top:8px}.on-object-container.flip[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{order:0;margin-top:0}.on-object-container[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{pointer-events:auto;max-width:fit-content;order:0}.on-object-container[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{margin-top:8px;min-width:180px;max-width:fit-content;height:auto;pointer-events:auto;order:1}"],changeDetection:0}),a}(),Ce=s(61617),Fn=s(57419),Dn=s(65966),at=s(56578),Un=s(86900),Ve=s(32041),Vn=["outlineContainer"],jn=["directEditTextBox"];function An(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"textarea",1,2),e.\u0275\u0275listener("click",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("mousedown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("pointerdown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditTextBoxMouseEvent(i))})("input",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.directEditTextBoxChange())})("blur",function(){e.\u0275\u0275restoreView(t);var i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.directEditTextBoxBlur())})("keydown",function(i){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.directEditKeyDown(i))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"div",3,4),e.\u0275\u0275elementContainerEnd()}}var je,Ae,Te,zn=function(){function a(o){this.textbox=o}return Object.defineProperty(a.prototype,"left",{get:function(){return this._left},set:function(t){t!==this._left&&(this._left=t,this.textbox.style.left="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._top},set:function(t){t!==this._top&&(this._top=t,this.textbox.style.top="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this._width},set:function(t){t!==this._width&&(this._width=t,this.textbox.style.width="".concat(t,"px"))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(t){t!==this._height&&(this._height=t,this.textbox.style.height="".concat(t,"px"))},enumerable:!1,configurable:!0}),a}(),Rn=function(a){function o(t,n,i,r,l){var u=a.call(this)||this;return u.element=t,u.lazyScoped=n,u.selection=i,u.changeDetector=r,u.contextActivityService=l,u.directEditTextBoxVisible=!1,u.asyncSerializer=new Fn.W,u}return(0,c.__extends)(o,a),o.prototype.directEditKeyDown=function(t){var n=this;("Enter"===t.key||"Escape"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.asyncSerializer.enqueue(function(){return(0,c.__awaiter)(n,void 0,void 0,function(){return(0,c.__generator)(this,function(i){return"Escape"===t.key?this.directEditState&&this.directEditState.changed&&(this.directEditState.dirty=!0,this.directEditState.value=this.directEditState.originalValueUndefined?void 0:this.directEditState.originalValue,this.flushUpdate()):this.flushUpdate(),this.endDirectEdit(),this.queueRender(),[2]})})}))},o.prototype.maintainTextboxHeight=function(t){if(this.directEditState&&this.directEditTextBoxVisible){var i=this.directEditTextBox.nativeElement,l=i.scrollHeight+2;if(null!=t&&l<t&&(l=t),l>Te&&(l=Te),l>i.clientHeight+2){this.directEditTextBoxDimensions.height=l;var d=this.outlineContainer.nativeElement.getBoundingClientRect();this.directEditTextBoxDimensions.top+this.directEditTextBoxDimensions.height>d.height&&(this.directEditTextBoxDimensions.top=d.height-this.directEditTextBoxDimensions.height)}}},o.prototype.directEditTextBoxMouseEvent=function(t){t.stopImmediatePropagation()},o.prototype.directEditTextBoxChange=function(){this.directEditState&&(this.maintainTextboxHeight(),this.directEditState.value=this.directEditTextBox.nativeElement.value,this.directEditState.dirty=!0,this.queueUpdate())},o.prototype.directEditTextBoxBlur=function(){this.flushUpdate()},o.prototype.queueUpdate=function(){var t=this;this.directEditUpdateTimeout&&(clearTimeout(this.directEditUpdateTimeout),this.directEditUpdateTimeout=void 0),this.directEditUpdateTimeout=setTimeout(function(){t.directEditUpdateTimeout=void 0,t.directEditState&&null!=t.directEditState.value&&t.directEditState.value.trim()&&t.sendUpdate()},500)},o.prototype.flushUpdate=function(){this.directEditUpdateTimeout&&(clearTimeout(this.directEditUpdateTimeout),this.directEditUpdateTimeout=void 0),this.sendUpdate()},o.prototype.sendUpdate=function(){this.directEditState&&this.directEditState.dirty&&(this.directEditState.dirty=!1,this.directEditState.changed=!0,this.updateDirectEditValue())},o.prototype.ngAfterViewInit=function(){var t=this;this.lazyScoped.get("formatModeService").then(function(n){n.immediateDirectEdit$.pipe((0,C.R)(t.onDestroy$)).subscribe(function(i){return t.asyncSerializer.enqueue(function(){return t.immediateDirectEdit(i)})})}),this.lazyScoped.get("formattingService").then(function(n){t.formattingService=n,t.changeDetector.detectChanges(),t.renderer=Un.D.create(t.outlineContainer.nativeElement,{startEdit:function(l){return t.asyncSerializer.enqueue(function(){return t.startDirectEdit(l)})},showUI:function(l,u){return t.asyncSerializer.enqueue(function(){return t.showUI(l,u)})}}),t.changes$("regionOutlines").pipe((0,C.R)(t.onDestroy$)).subscribe(function(r){t.asyncSerializer.enqueue(function(){return t.updateOutlines(r)})})})},o.prototype.queueRender=function(){this.render()},o.prototype.render=function(t){var n=this,i=this.renderOutlines,r=this.directEditTextBox.nativeElement;if(this.directEditTextBoxDimensions||(this.directEditTextBoxDimensions=new zn(r)),this.directEditState){i=_.filter(i,function(v){return 2!==v.visibility});var u=this.directEditState.directEdit.style,d=this.getTextBoxSizingFont();if(!t&&!Ve.b.isFontLoaded(d))return void document.fonts.load("16px "+d.fontFamily).then(function(v){},function(v){throw v}).finally(function(){return n.render(!0)});var g=this.calcTextBoxDimensions(d,{width:this.directEditTextBoxVisible&&!!this.directEditTextBoxDimensions.width&&0!==u,height:this.directEditTextBoxVisible&&!!this.directEditTextBoxDimensions.height});this.directEditTextBoxDimensions.left=g.left,this.directEditTextBoxDimensions.top=g.top,this.directEditTextBoxDimensions.width=g.width,(!this.directEditTextBoxVisible||0!==u)&&(this.directEditTextBoxDimensions.height=g.height),this.directEditTextBoxVisible||(this.directEditTextBoxVisible=!0,r.value=this.directEditState.value??"",r.style.display="block",0===u&&(this.directEditTextBoxDimensions.height=Math.min(Te,r.scrollHeight+2)),r.focus(),r.select(),this.directEditState.bodyClickDismissListener=function(v){r.contains(v.target)||(r.style.display="none",n.asyncSerializer.enqueue(function(){return(0,c.__awaiter)(n,void 0,void 0,function(){return(0,c.__generator)(this,function(I){return this.directEditState&&(this.flushUpdate(),this.endDirectEdit(),this.queueRender()),[2]})})}))},document.body.addEventListener("pointerdown",this.directEditState.bodyClickDismissListener,!0)),this.maintainTextboxHeight(g.height)}else this.directEditTextBoxVisible&&(this.directEditTextBoxVisible=!1,r.style.display="none");this.sendOutlinesToRenderer(i)},o.prototype.sendStartDirectEditEvent=function(){this.contextActivityService.createActivity({name:"StartDirectEdit",visualName:this.directEditState.visualName,data:{formattingId:this.directEditState.directEdit.reference,source:"DirectEdit"}}).resolve()},o.prototype.sendEndDirectEditEvent=function(){this.contextActivityService.createActivity({name:"EndDirectEdit",visualName:this.directEditState.visualName,data:{formattingId:this.directEditState.directEdit.reference,changed:this.directEditState.changed,source:"DirectEdit"}}).resolve()},o.prototype.getTextBoxSizingFont=function(){var t=window.getComputedStyle(this.directEditTextBox.nativeElement);return{fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,text:(this.directEditState.value||"")+"MMMMMMMMMMMMMMMMMMMM"}},o.prototype.calcTextBoxDimensions=function(t,n){var i=Ve.b.measureSvgTextRect(t);if(void 0===je){var r=Ve.b.measureSvgTextRect((0,c.__assign)((0,c.__assign)({},t),{text:"M"}));Ae=r.width,Te=4*(je=r.height)+6}var l=this.directEditState.directEditOutline.directEdit().reference,d=this.directEditState.directEdit.style,p=ct(this.directEditState.directEditOutlineRegion,function(w){return 1===w.type&&w.directEdit&&(0,Ce.cd)(w.directEdit().reference,l)}),m=this.outlineContainer.nativeElement,g=m.getBoundingClientRect(),f={left:p.x-g.x,top:p.y-g.y,width:p.width,height:p.height},v=n&&n.width&&this.directEditTextBoxDimensions.width&&this.directEditTextBoxDimensions.width-6,I=n&&n.height&&this.directEditTextBoxDimensions.height&&this.directEditTextBoxDimensions.height-6;switch(d){case 1:case 2:var O=f.left+f.width/2,x=f.top+f.height/2,h=Math.min(v||i.width,30*Ae),b=I||i.height;f.left=O-h/2,f.top=x-b/2,f.width=h,f.height=b;break;case 3:x=f.top+f.height/2,h=Math.min(v||i.width,30*Ae),f.top=x-(b=I||i.height)/2,f.width=h,f.height=b;break;case 0:v&&(f.width=v),I&&I>f.height&&(f.height=I),f.height<i.height&&(f.height=i.height)}f.left-=3,f.top-=3,f.width+=6,f.height+=6;var y=$(m).width(),S=$(m).height();return f.width>y&&(f.width=y),f.height>S&&(f.height=S),f.left<0&&(f.left=0),f.left+f.width>y&&(f.left=Math.max(0,y-f.width)),f.top<0&&(f.top=0),f.top+f.height>S&&(f.top=Math.max(0,S-f.height)),f},o.prototype.immediateDirectEdit=function(t){var n;return(0,c.__awaiter)(this,void 0,void 0,function(){var i,r,l,u;return(0,c.__generator)(this,function(d){if(this.pendingImmediateDirectEdit=void 0,this.directEditState){if(t.outlineId===(null===(n=this.directEditState.directEditOutlineRegion)||void 0===n?void 0:n.id))return[2];this.endDirectEdit()}if(this.renderOutlines)for(i=0,r=this.renderOutlines;i<r.length;i++)if((l=r[i]).id===t.outlineId&&2===l.visibility&&(u=Ne(l.outline)))return this.startDirectEdit(u),[2];return this.pendingImmediateDirectEdit=t,[2]})})},o.prototype.updateOutlines=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,r=this;return(0,c.__generator)(this,function(l){return this.renderOutlines=t,this.directEditState&&(n=this.directEditState.directEdit.reference,i=!1,_.forEach(t,function(u){if(2===u.visibility){var d=ct(u,function(p){return 1===p.type&&p.directEdit&&(0,Ce.cd)(p.directEdit().reference,n)});d&&(i=!0,r.directEditState.directEditOutlineRegion=u,r.directEditState.directEditOutline=d,r.directEditState.directEdit=d.directEdit())}}),i||this.endDirectEdit()),this.queueRender(),[2]})})},o.prototype.endDirectEdit=function(){this.sendEndDirectEditEvent(),this.directEditState.bodyClickDismissListener&&document.body.removeEventListener("pointerdown",this.directEditState.bodyClickDismissListener,!0),this.directEditState=void 0,this.changeDetector.markForCheck()},o.prototype.showUI=function(t,n){return(0,c.__awaiter)(this,void 0,void 0,function(){var i,r,l=this;return(0,c.__generator)(this,function(u){switch(u.label){case 0:return(i=_.first(this.selection.getSelectedElements()))&&!_.isEmpty(i.subSelections)?[4,this.lazyScoped.get("formatModeService")]:[3,3];case 1:return(r=u.sent()).updateSubSelection({canvasItem:i.canvasItem,subSelections:_.map(i.subSelections,function(d){return{source:"external",triggerAction:0,visualSubSelection:{displayName:d.visualSubSelection.displayName,subSelectionType:1,selectionOrigin:l.getSelectionOrigin(n),showUI:!0,visualObjects:d.visualSubSelection.visualObjects,target:n.target}}})}),[4,r.triggerShowUI(void 0)];case 2:u.sent(),u.label=3;case 3:return[2]}})})},o.prototype.getSelectionOrigin=function(t){var n=t.target.getBoundingClientRect().top,i=-1*Math.abs(n-t.clientY);return{x:t.clientX,y:t.clientY,offset:{x:0,y:i}}},o.prototype.startDirectEdit=function(t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,c.__generator)(this,function(r){switch(r.label){case 0:return this.pendingImmediateDirectEdit=void 0,[4,this.lazyScoped.get("formatModeService")];case 1:return n=r.sent(),i=this,[4,this.getDirectEditContext(t)];case 2:return i.directEditState=r.sent(),this.directEditState?(n.hideAllUI(),this.changeDetector.markForCheck(),this.queueRender(),this.sendStartDirectEditEvent(),[2]):[2]}})})},o.prototype.updateDirectEditValue=function(){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:return t=this.directEditState,(n=_.first(this.selection.getSelectedElements()))&&!_.isEmpty(n.subSelections)&&n.canvasItem?t.value?[4,this.formattingService.saveValues({changes:[{objectName:t.descriptor.objectName,uid:t.uid,formattingSource:t.source,propertySlice:{name:t.descriptor.propertyName,value:t.value,type:t.descriptor.type},hasDynamicExpressionSupport:!1,canvasItems:[n.canvasItem],visualUpdateSource:1}]},{source:"DirectEdit"})]:[3,2]:[2];case 1:return r.sent(),[3,4];case 2:return[4,this.formattingService.revertToDefault([(0,c.__assign)((0,c.__assign)({},t.descriptor),{originSource:t.source,canvasItems:[n.canvasItem]})])];case 3:r.sent(),r.label=4;case 4:return[2]}})})},o.prototype.getDirectEditContext=function(t){var p,m,n=this,i=new Dn.B,r=t.directEdit(),l=r.reference,u=this.renderOutlines,d=_.first(this.selection.getSelectedElements());d?(p=this.formattingService.getFor({type:0,canvasItem:d.canvasItem}),m=d.canvasItem.name):p=this.formattingService.getFor({type:1});var g=0,v=p.selectSlice(l).pipe((0,oe.q)(2)).subscribe(function(x){if(x&&x.control&&x.control.properties&&x.control.properties.descriptor){if((0,at.IW)(x))return k.fF.assertFail("Unexpected composite slice"),void O(void 0);var h=_.first(n.selection.getSelectedElements());if(h&&!_.isEmpty(h.subSelections)&&h.canvasItem){var b=x.originSource,y=x.pivotSource,S=x.control.properties,w=S.descriptor,E=S.value,F=x.uid,B=null==E?void 0:"".concat(E),R=!0,G=h.canvasItem;if((0,se.Vz)(G)){R=!function(a,o,t){var n=a.vcObjects,i=n&&n[o];if(i)return null!=i[0].properties[t];var r=a.objects,l=r&&r[o];return!!l&&null!=l[0].properties[t]}(G.config.singleVisual,w.objectName,w.propertyName);var W=_.find(u,function(X){return X.visualContainerName===m&&ee(X.outline)});O(W?{regionOutlines:u,directEditOutlineRegion:W,directEditOutline:t,directEdit:r,source:b,pivot:y,descriptor:w,value:R&&void 0!==r.displayValue?r.displayValue:B,originalValue:B,originalValueUndefined:R,dirty:!1,visualName:h&&h.canvasItem.name,bodyClickDismissListener:void 0,uid:F}:void 0)}else O(void 0)}else O(void 0)}else 2==++g&&O(void 0);function ee(X){var Ie;if(X===t)return!0;if(1===X.type&&X.directEdit){var He=null===(Ie=X.directEdit())||void 0===Ie?void 0:Ie.reference;if((0,Ce.cd)(He,l))return!0}return!(0!==X.type||!_.some(X.outlines,function(We){return ee(We)}))}}),I=!1;function O(x){I=!0,i.resolve(x),v&&v.unsubscribe()}return I&&v.unsubscribe(),i.promise},o.prototype.sendOutlinesToRenderer=function(t){var n=this.element.nativeElement.getBoundingClientRect();if(this.renderer.updateRegionOutlines(t,n),this.pendingImmediateDirectEdit)for(var i=0,r=t;i<r.length;i++){var l=r[i];if(l.id===this.pendingImmediateDirectEdit.outlineId&&2===l.visibility){var u=Ne(l.outline);u&&this.startDirectEdit(u)}}},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(xe.H),e.\u0275\u0275directiveInject(_e.z),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Qe.r))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["outline-overlay"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(Vn,5),e.\u0275\u0275viewQuery(jn,5)),2&n){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.outlineContainer=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(i.directEditTextBox=r.first)}},hostVars:1,hostBindings:function(n,i){2&n&&e.\u0275\u0275attribute("data-testid","outline-overlay")},inputs:{regionOutlines:"regionOutlines"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],["data-testid","directEditTextBox",1,"directEditTextBox",3,"click","mousedown","pointerdown","input","blur","keydown"],["directEditTextBox",""],[1,"outlineContainer"],["outlineContainer",""]],template:function(n,i){1&n&&e.\u0275\u0275template(0,An,5,0,"ng-container",0),2&n&&e.\u0275\u0275property("ngIf",i.formattingService)},dependencies:[U.NgIf],styles:["[_nghost-%COMP%]{display:block}.directEditTextBox[_ngcontent-%COMP%]{position:absolute;display:none;pointer-events:auto;resize:none;box-sizing:border-box;padding:2px;border-width:1px}.outlineContainer[_ngcontent-%COMP%]{pointer-events:none;position:absolute;height:100%;width:100%;overflow:hidden;top:0;left:0}"],changeDetection:0}),o}(N.w);function ct(a,o){for(var t=[a.outline];!_.isEmpty(t);){var n=t.shift();if(0===n.type)t.push.apply(t,n.outlines);else if(o(n))return n}}function Ne(a){if(1===a.type)return a;if(0===a.type)for(var o=0,t=a.outlines;o<t.length;o++){var i=Ne(t[o]);if(i)return i}}var Ln=s(35510),Hn=s(77526),ut=s(26898),dt=s(83008),pt=s(11494),mt=s(53081),ft=s(21024),vt=s(77200),gt=s(27980),Oe=s(92755),Z=s(25512),Wn=s(64466);function Gn(a,o){if(1&a&&e.\u0275\u0275element(0,"mini-toolbar",2),2&a){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",t.data.subSelectionUpdateArgs)("subSelectionStyles",t.data.subSelectionStyles)("subSelectedItem",(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections)&&(null==t.data.subSelectionUpdateArgs?null:t.data.subSelectionUpdateArgs.subSelections[0])),e.\u0275\u0275attribute("aria-labelledby",t.ariaLabelledby)}}var ht=function(){function a(o){var t;this.onObjectUIData=o,this.data=this.onObjectUIData,this.ariaLabelledby=(0,rt.u)(null===(t=this.data.subSelectionUpdateArgs)||void 0===t?void 0:t.canvasItem.name)}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(le.M))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["mini-toolbar-component-wrapper"]],decls:2,vars:1,consts:[[1,"on-object-container"],["class","mini-toolbar","role","toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem",4,"ngIf"],["role","toolbar",1,"mini-toolbar",3,"subSelectionUpdateArgs","subSelectionStyles","subSelectedItem"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Gn,1,4,"mini-toolbar",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionStyles)&&(null==n.data?null:n.data.subSelectionUpdateArgs)))},dependencies:[U.NgIf,ot],styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none}.on-object-container[_ngcontent-%COMP%]   .mini-toolbar[_ngcontent-%COMP%]{pointer-events:auto;max-width:fit-content}"],changeDetection:0}),a}();function Qn(a,o){if(1&a){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"on-object-context-menu",3),e.\u0275\u0275listener("onExecuteContextMenuAction",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.executeContextMenuAction())}),e.\u0275\u0275elementEnd()}if(2&a){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("subSelectionUpdateArgs",n.data.subSelectionUpdateArgs)("subSelectionStyles",n.data.subSelectionStyles)("subSelectionShortcuts",n.data.subSelectionShortcuts)}}var ze=function(){function a(o,t){var n;this.onObjectUIData=o,this.formattingUIManager=t,this.hideContextMenu=!1,this.data=this.onObjectUIData;var i=null===(n=this.data.subSelectionUpdateArgs)||void 0===n?void 0:n.subSelections;i&&(this.hideContextMenu=i.some(function(r){return"disambiguationMenu"===r.source}))}return a.prototype.executeContextMenuAction=function(){this.formattingUIManager.executeContextMenuAction()},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(le.M),e.\u0275\u0275directiveInject(fe))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["on-object-context-menu-wrapper"]],decls:3,vars:1,consts:[[1,"on-object-container"],[1,"context-menu"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction",4,"ngIf"],[3,"subSelectionUpdateArgs","subSelectionStyles","subSelectionShortcuts","onExecuteContextMenuAction"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Qn,1,3,"on-object-context-menu",2),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==n.data?null:n.data.subSelectionShortcuts)&&!n.hideContextMenu))},dependencies:[U.NgIf,Fe],styles:[".on-object-container[_ngcontent-%COMP%]{pointer-events:none}.on-object-container[_ngcontent-%COMP%]   .context-menu[_ngcontent-%COMP%]{min-width:180px;max-width:fit-content;height:auto;pointer-events:auto}"],changeDetection:0}),a}(),bt=s(52287),Kn=s(26691),yt="pbi-pointer-events-none",Yn=Wn.s.DisplayAreaNameSelector.selector,$e=function(){function a(o,t,n,i,r,l){var u=this;this.componentFactoryResolver=o,this.formattingUIManager=t,this.injector=n,this.pbiOverlay=i,this.runningVisuals=r,this.visualOverlayPositionService=l,this.formattingUIManager.contextMenuActionExecuted$.subscribe(function(){u.hide()})}return a.prototype.show=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return(0,mt.A)(o)?[4,this.showForVisual(o)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.showForNonVisual(o),t.label=3;case 3:return[2]}})})},a.prototype.showForVisual=function(o){var t,n,i,r,l,u;return(0,c.__awaiter)(this,void 0,void 0,function(){var d,p,m,g,f,v,I,O,x,h,b,y,S,w,E,F;return(0,c.__generator)(this,function(B){switch(B.label){case 0:return p=o.subSelections,(0,se.Vz)(d=o.canvasItem)?(k.fF.assert(function(){return 1===p.length},"Expected 1 sub-selection"),(m=this.runningVisuals.getVisual(d))?(v=p.map(function(R){return R.visualSubSelection}),[4,m.getSubSelectionShortcuts(v,void 0)]):[3,3]):(k.fF.assertFail("Groups are not supported"),[2]);case 1:return g=B.sent(),[4,m.getSubSelectionStyles(v)];case 2:f=B.sent(),B.label=3;case 3:return g||f?(I=_.first(p).visualSubSelection.selectionOrigin,O=null===(t=_.first(p).visualSubSelection)||void 0===t?void 0:t.target,x=null===(n=this.visualOverlayPositionService.getElement(d))||void 0===n?void 0:n.get(0),(h=(null!==(r=null===(i=$(O).closest("[".concat(bt.CP,"]")))||void 0===i?void 0:i.get(0))&&void 0!==r?r:O)||x).classList.contains(bt.cy)||(h=x),S=this.createPositions(b=!!f,y=!!g,h,I),w=this.pbiOverlay.position().flexibleConnectedTo(h).withPositions(S),E={subSelectionShortcuts:g,subSelectionStyles:f,subSelectionUpdateArgs:o},this.hide(),b&&y?(this.minitoolbarRef=this.openOverlay(E,w,ht),F=this.pbiOverlay.position().flexibleConnectedTo(null===(u=null===(l=this.minitoolbarRef)||void 0===l?void 0:l.overlayRef)||void 0===u?void 0:u.overlayElement).withPositions([(0,Z.Oq)(0,8),(0,Z.w3)(0,-8)]),this.contextMenuRef=this.openOverlay(E,F,ze),[2]):b?(this.minitoolbarRef=this.openOverlay(E,w,ht),[2]):y?(this.contextMenuRef=this.openOverlay(E,w,ze),[2]):[2]):[2]}})})},a.prototype.showForNonVisual=function(o){var t=o.customShortcuts,n=o.sourceEvent;if(t){var i={subSelectionShortcuts:t},r={x:n.clientX,y:n.clientY},l=this.pbiOverlay.position().flexibleConnectedTo(r).withPositions(this.createNonVisualPositions());this.contextMenuRef=this.openOverlay(i,l,ze)}},a.prototype.openOverlay=function(o,t,n){return this.pbiOverlay.open({component:n,data:o,options:{positionStrategy:t,hasBackdrop:!0,backdropClass:[De.L,yt],panelClass:yt},injector:this.injector,componentFactoryResolver:this.componentFactoryResolver,closeOnBackdropClick:!0})},a.prototype.hide=function(){this.minitoolbarRef&&(this.minitoolbarRef.close(),this.minitoolbarRef=void 0),this.contextMenuRef&&(this.contextMenuRef.close(),this.contextMenuRef=void 0)},a.prototype.createPositions=function(o,t,n,i){var r,l=(r=this.visualOverlayPositionService.getRelativeOffsets(n,i)).endX,u=r.startX,d=r.startY,p=r.endY;if(o){var m=[(0,Z.Zz)(l,d-68),(0,Z.Iz)(u,d-68),(0,Z.J7)(l,p),(0,Z.Kb)(u,p)],g=document.querySelector(Yn).getBoundingClientRect().top;return i.y-g<68&&m.unshift((0,Z.Oq)(d,p)),m}if(t)return[(0,Z.Zz)(l,d),(0,Z.Iz)(u,d),(0,Z.J7)(l,p),(0,Z.Kb)(u,p)]},a.prototype.createNonVisualPositions=function(){return[(0,Z.Zz)(),(0,Z.Iz)(),(0,Z.J7)(),(0,Z.Kb)()]},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(e.ComponentFactoryResolver),e.\u0275\u0275inject(fe),e.\u0275\u0275inject(e.Injector),e.\u0275\u0275inject(De._),e.\u0275\u0275inject(we.s),e.\u0275\u0275inject(Kn.z))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Le=s(21302),Xn=function(){function a(o,t,n,i,r,l,u,d,p,m,g){var f=this;this.conceptualSchemaProxy=o,this.dataSourcesService=t,this.eventBridge=n,this.formattingUIManager=i,this.lazyScoped=r,this.onObjectOverlayService=l,this.paneVisibility=u,this.runningVisuals=d,this.selection=p,this.viewModeState=m,this.visualAuthoringOperationsService=g,this.requestedSubSelection$=new Se.t(1),this.triggerShowUIWithSubSelection$=new Ln.X(void 0),this.navigateShortcut$=new Se.t(1),this.onDestroy$=new Se.t(1),this.navigateId=0,this.immediateDirectEdit$=new Se.t(1),(0,P.aj)([this.formattingUIManager.getFormatPaneRegistered$(),this.navigateShortcut$]).pipe((0,C.R)(this.onDestroy$)).subscribe(function(v){var I=v[0],O=v[1];return(0,c.__awaiter)(f,void 0,void 0,function(){var x,h,b,y,S,w,E,F,B,R,G,ee;return(0,c.__generator)(this,function(W){switch(W.label){case 0:return this.navigateId++,x=this.navigateId,I&&O?(b=O.canvasItem,y=(h=O.shortcut).destinationInfo,S=void 0,F=void 0,this.eventBridge.publishToChannel(h.destinationPivot&&"Page"===(S=h.destinationPivot)?Le.mF:Le.sn),B=this.formattingService.getFor(b?{type:0,canvasItem:b}:{type:1}),(0,Ce.LI)(y)?[4,B.selectSlice(y).pipe((0,C.R)(this.onDestroy$),(0,ve.h)(function(te){return!!te}),(0,oe.q)(1)).toPromise()]:[3,3]):[3,6];case 1:return(R=W.sent())&&x===this.navigateId?(S=R.pivotSource,[4,B.selectGroup(E=R.groupUid).pipe((0,C.R)(this.onDestroy$),(0,ve.h)(function(te){return!!te}),(0,oe.q)(1)).toPromise()]):[2];case 2:return(G=W.sent())&&x===this.navigateId?(w=G.cardUid,F=G.parentContainers,[3,5]):[2];case 3:return E=y.groupUid,[4,B.selectCard(w=y.cardUid).pipe((0,C.R)(this.onDestroy$),(0,ve.h)(function(te){return!!te}),(0,j.U)(function(te){return te.pivotSource}),(0,oe.q)(1)).toPromise()];case 4:if(!(ee=W.sent())||x!==this.navigateId)return[2];S=S??ee,W.label=5;case 5:this.formattingUIManager.setFormatPaneCardExpansion({selectedPivot:S,isCardExpanded:function(X){return w===X},isGroupExpanded:function(X,Ie){if(w===X&&null!=E)return(0,Ce.Ko)(E)===(0,Ce.Ko)(Ie)},formattingContainersNavigationInfo:F,canvasItems:[b],scrollToOpenCard:!0}),h.doNotDismissUI||this.hideAllUI(),this.navigateShortcut$.next(void 0),W.label=6;case 6:return[2]}})})})}return a.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0)},a.prototype.monitor=function(){return(0,c.__awaiter)(this,void 0,void 0,function(){var o,t,n,i=this;return(0,c.__generator)(this,function(r){switch(r.label){case 0:return this.monitoring?[2]:(this.monitoring=!0,[4,this.ensureStoreInitialized()]);case 1:return r.sent(),o=this.viewModeState.formatMode$,t=me.UP.getSelectedVisualContainer$(this.selection),n=t.pipe((0,j.U)(function(l){return l?.name}),(0,Hn.x)()),o.pipe((0,ve.h)(function(l){return l}),(0,C.R)(this.onDestroy$)).subscribe(function(){return i.showFormatPane(!0)}),(0,P.aj)([o,n,this.triggerShowUIWithSubSelection$]).pipe((0,Ee.M)(this.requestedSubSelection$),(0,C.R)(this.onDestroy$)).subscribe(function(l){var u,d,p=l[0],m=p[0],g=p[1],v=l[1];i.hideUI(null===(u=v.canvasItem)||void 0===u?void 0:u.name),m&&g===(null===(d=v.canvasItem)||void 0===d?void 0:d.name)&&_.some(v.subSelections,function(I){return I.visualSubSelection.showUI})&&i.showUI(v)}),[2]}})})},a.prototype.updateSubSelection=function(o){this.requestedSubSelection$.next(o)},a.prototype.triggerShowUI=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return o?[4,this.showUI(o)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.triggerShowUIWithSubSelection$.next(),t.label=3;case 3:return[2]}})})},a.prototype.triggerImmediateDirectEdit=function(o){this.immediateDirectEdit$.next({outlineId:o,timestamp:performance.now()})},a.prototype.ensureStoreInitialized=function(){return(0,c.__awaiter)(this,void 0,void 0,function(){var o;return(0,c.__generator)(this,function(t){switch(t.label){case 0:return this.formattingService?[3,2]:(o=this,[4,this.lazyScoped.get("formattingService")]);case 1:o.formattingService=t.sent(),t.label=2;case 2:return[2]}})})},a.prototype.showUI=function(o){var t;return(0,c.__awaiter)(this,void 0,void 0,function(){var n;return(0,c.__generator)(this,function(i){switch(i.label){case 0:return n=!this.activeContainerName,(0,mt.A)(o)&&(n=n||this.activeContainerName===o.canvasItem.name,this.activeContainerName=null!==(t=this.activeContainerName)&&void 0!==t?t:o.canvasItem.name),n?[4,this.onObjectOverlayService.show(o)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},a.prototype.showFormatPane=function(o){var t=this.paneVisibility.isPaneVisible("format"),n=this.paneVisibility.isPaneExpanded("format");return!!(o||t&&n)&&(t||(this.paneVisibility.togglePaneVisibility("format"),t=!0),(n=this.paneVisibility.isPaneExpanded("format"))||(n=this.paneVisibility.togglePaneExpansion("format")),t&&n)},a.prototype.hideUI=function(o){(!this.activeContainerName||this.activeContainerName&&o===this.activeContainerName)&&this.hideAllUI()},a.prototype.hideAllUI=function(){this.activeContainerName=void 0,this.onObjectOverlayService.hide()},a.prototype.executeShortcut=function(o,t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:if(_.isEmpty(o))return[2];switch(n=o[0].shortcut.type){case 0:return[3,1];case 1:return[3,3];case 2:return[3,5];case 3:return[3,7];case 4:return[3,9];case 5:return[3,10];case 6:return[3,11];case 9:return[3,13]}return[3,15];case 1:return[4,this.executeResetShortcut(o,t)];case 2:return r.sent(),[2];case 3:return[4,this.executeNavigateShortcut(o)];case 4:return r.sent(),[2];case 5:return[4,this.executeToggleShortcut(o)];case 6:return r.sent(),[2];case 7:return[4,this.executePickerShortcut(o)];case 8:return r.sent(),[2];case 9:return this.executeSortShortcut(o),[2];case 10:return this.executeCustomActionShortcut(o),[2];case 11:return[4,this.executeConditionalFormattingShortcut(o)];case 12:return r.sent(),[2];case 13:return[4,this.executeSetValueShortcut(o)];case 14:return r.sent(),[2];case 15:k.fF.assertNever(n),r.label=16;case 16:return[2]}})})},a.prototype.executeResetShortcut=function(o,t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,r,l,u;return(0,c.__generator)(this,function(p){switch(p.label){case 0:return[4,this.ensureStoreInitialized()];case 1:p.sent(),n=[],i=function(g){var f,v,I,O;return(0,c.__generator)(this,function(x){switch(x.label){case 0:if(f=g.canvasItem,(v=g.shortcut).revertToDefaultDescriptors)for(O in I=_.groupBy(v.revertToDefaultDescriptors,function(h){return h.originSource}))n.push.apply(n,_.map(I[O],function(h){return(0,c.__assign)((0,c.__assign)({},h),{canvasItems:[f]})}));return v.resetSortRoleKey?[4,r.resetSortShortcut(f,v.resetSortRoleKey)]:[3,2];case 1:x.sent(),x.label=2;case 2:return[2]}})},r=this,l=0,u=o,p.label=2;case 2:return l<u.length?[5,i(u[l])]:[3,5];case 3:p.sent(),p.label=4;case 4:return l++,[3,2];case 5:return this.formattingService.revertToDefault(n,void 0,t),[2]}})})},a.prototype.executeToggleShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,l,u,d,p,g;return(0,c.__generator)(this,function(f){for(t=[],n=0,i=o;n<i.length;n++){if(l=(r=i[n]).shortcut,u=r.canvasItem,!_.isEmpty(l.relatedToggledFormattingIds))for(d=0,p=l.relatedToggledFormattingIds;d<p.length;d++)g=(0,c.__assign)((0,c.__assign)({type:2},p[d]),{telemetrySource:l.telemetrySource}),t.push({shortcut:g,canvasItem:u});t.push(r)}return[2,this.setToggleValue(t)]})})},a.prototype.setToggleValue=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,l,u,d;return(0,c.__generator)(this,function(m){switch(m.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(m.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,k.fF.assert(function(){return _.every(o,function(g){return g.shortcut.telemetrySource===t})},"expected only one telemetry source for all the toggle shortcuts"),n=[],i=[],r=function(f){var v,I,O,h,b,y,S,w,E,F,B,R,G,ee;return(0,c.__generator)(this,function(W){switch(W.label){case 0:return v=f.shortcut,O=l.formattingService.getFor({type:0,canvasItem:I=f.canvasItem}),h=v.nextValue,y=void 0,l.isToggleShortcut(v)?[4,O.selectTopLevelToggle(v).pipe((0,oe.q)(1)).toPromise()]:[3,5];case 1:return(S=W.sent())?(y=S.uid,b={toggleSwitch:S.control.properties,togglePivot:S.originSource},[3,4]):[3,2];case 2:return[4,O.selectSlice(v).pipe((0,oe.q)(1)).toPromise()];case 3:(w=W.sent())&&(k.fF.assert(function(){return"ToggleSwitch"===w.control.type},"expected slice to be a toggle switch"),y=w.uid,b={toggleSwitch:w.control.properties,togglePivot:w.originSource,conditionalFormattingObjects:w.conditionalFormattingObjects}),W.label=4;case 4:return[3,7];case 5:return[4,O.selectSlice(v).pipe((0,oe.q)(1)).toPromise()];case 6:(E=W.sent())&&(k.fF.assert(function(){return"ToggleSwitch"===E.control.type},"expected slice to be a toggle switch"),y=E.uid,b={toggleSwitch:E.control.properties,togglePivot:E.originSource,conditionalFormattingObjects:E.conditionalFormattingObjects}),W.label=7;case 7:return b?(B=b.togglePivot,R=b.conditionalFormattingObjects,(F=b.toggleSwitch)&&(G=F.descriptor,void 0!==h?(ee=(0,Oe.ks)(h,G,y,B,[I],1,R),i.push(ee)):n.push((0,c.__assign)((0,c.__assign)({},G),{originSource:B,canvasItems:[I]})))):k.fF.assert(function(){return!!b},"toggle should be present in the store"),[2]}})},l=this,u=0,d=o,m.label=2;case 2:return u<d.length?[5,r(d[u])]:[3,5];case 3:m.sent(),m.label=4;case 4:return u++,[3,2];case 5:return _.isEmpty(i)?[3,7]:[4,this.formattingService.saveValues({changes:i},t)];case 6:m.sent(),m.label=7;case 7:return _.isEmpty(n)?[3,9]:[4,this.formattingService.revertToDefault(n)];case 8:m.sent(),m.label=9;case 9:return[2]}})})},a.prototype.isToggleShortcut=function(o){return 2===o.type},a.prototype.executeNavigateShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,c.__generator)(this,function(l){switch(l.label){case 0:return[4,this.ensureStoreInitialized()];case 1:return l.sent(),k.fF.assert(function(){return 1===o.length},"only one navigate shortcut should be executed at a time"),n=o[0].canvasItem,(t=o[0].shortcut).destinationInfo&&this.showFormatPane(t.togglePaneVisibility)?(this.navigateShortcut$.next({shortcut:t,canvasItem:n}),[2]):[2]}})})},a.prototype.executePickerShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,l,u,d,p,m,g,x,h=this;return(0,c.__generator)(this,function(b){switch(b.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(b.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,k.fF.assert(function(){return _.every(o,function(y){return y.shortcut.telemetrySource===t})},"expected only one telemetry source for all the picker shortcuts"),n=[],i=[],r=function(S,w,E,F,B){return(0,c.__awaiter)(h,void 0,void 0,function(){var R,G,ee,W,te;return(0,c.__generator)(this,function(X){switch(X.label){case 0:return R=w,S&&!_.isEmpty(S.items)?(G=void 0,void 0!==F&&(ee=S.items[F])&&(S.value=ee,G=ee.value),W=S.descriptor,void 0===G?[3,1]:(te=(0,Oe.ks)(G,W,B,R,[E],1),i.push(te),[3,3])):[3,3];case 1:return n.push((0,c.__assign)((0,c.__assign)({},W),{originSource:R,canvasItems:[E]})),[4,this.formattingService.revertToDefault([(0,c.__assign)((0,c.__assign)({},W),{originSource:R,canvasItems:[E]})])];case 2:X.sent(),X.label=3;case 3:return[2]}})})},l=0,u=o,b.label=2;case 2:return l<u.length?(g=(p=(d=u[l]).shortcut).index,[4,this.formattingService.getFor({type:0,canvasItem:m=d.canvasItem}).selectSlice(p).pipe((0,j.U)(function(y){return{dropdown:y?.control.properties,dropdownPivot:y?.pivotSource,uid:y?.uid}}),(0,oe.q)(1)).toPromise()]):[3,6];case 3:return x=b.sent(),[4,r(x.dropdown,x.dropdownPivot,m,g,x.uid)];case 4:b.sent(),b.label=5;case 5:return l++,[3,2];case 6:return _.isEmpty(i)?[3,8]:[4,this.formattingService.saveValues({changes:i},t)];case 7:b.sent(),b.label=8;case 8:return _.isEmpty(n)?[3,10]:[4,this.formattingService.revertToDefault(n)];case 9:b.sent(),b.label=10;case 10:return[2]}})})},a.prototype.executeSortShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,l,u;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return k.fF.assert(function(){return 1===o.length},"only one sort shortcut supported at a time"),n=o[0].shortcut,(0,se.Vz)(t=o[0].canvasItem)?(i=this.runningVisuals.getVisual(t))&&i.sortServices?(r=[n.sortableField],[4,i.sortServices.getSortableGroups()]):[3,2]:[2];case 1:l=d.sent(),u=l.filter(function(p){return p.key!==n.key}).flatMap(function(p){return p.fields.filter(function(m){return void 0!==m.sortDirection}).map(function(m){return{queryName:m.exprs[0].name,sortDirection:m.sortDirection}})}),r.push.apply(r,u),i.sortServices.sort(r),d.label=2;case 2:return[2]}})})},a.prototype.resetSortShortcut=function(o,t){return(0,c.__awaiter)(this,void 0,void 0,function(){var n,i,r,l,u,d;return(0,c.__generator)(this,function(p){switch(p.label){case 0:return(0,se.Vz)(o)?(n=this.runningVisuals.getVisual(o))&&n.sortServices?[4,n.sortServices.getSortableGroups()]:[3,3]:[2];case 1:return i=p.sent(),(r=i.find(function(m){return m.key===t}))?(l=_.flatten(r.fields.map(function(m){return m.exprs[0].expr})),u=this.dataSourcesService.get(),[4,this.conceptualSchemaProxy.get(u)]):[3,3];case 2:d=p.sent(),this.visualAuthoringOperationsService.removeOrderBy(o,l,d),p.label=3;case 3:return[2]}})})},a.prototype.executeCustomActionShortcut=function(o){for(var t=0,n=o;t<n.length;t++)n[t].shortcut.customAction()},a.prototype.executeConditionalFormattingShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return[4,this.setToggleValue(o)];case 1:return t.sent(),[2]}})})},a.prototype.executeSetValueShortcut=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,l,u,p,m,g,f,v,I,O,x,h,b,S,w,E;return(0,c.__generator)(this,function(F){switch(F.label){case 0:return[4,this.ensureStoreInitialized()];case 1:if(F.sent(),_.isEmpty(o))return[2];t=o[0].shortcut.telemetrySource,k.fF.assert(function(){return _.every(o,function(B){return B.shortcut.telemetrySource===t})},"expected only one telemetry source for all the picker shortcuts"),n=[],i=[],r=0,l=o,F.label=2;case 2:if(!(r<l.length))return[3,9];if(p=(u=l[r]).canvasItem,!(m=u.shortcut.referencesAndValues))return[3,8];g=0,f=m,F.label=3;case 3:return g<f.length?(I=(v=f[g]).isTopLevelToggle,O=v.value,x=this.formattingService.getFor({type:0,canvasItem:p}),h=void 0,b=v,I?[4,x.selectTopLevelToggle(b).pipe((0,oe.q)(1)).toPromise()]:[3,5]):[3,8];case 4:return(S=F.sent())?(E=(0,Oe.ks)(O,w=S.control.properties.descriptor,h=S.uid,S.originSource,[p],1),n.push(E),[3,7]):(k.fF.assertFail("no top level toggle was found from the reference - setValueShortcut"),[2]);case 5:return[4,x.selectSlice(b).pipe((0,oe.q)(1)).toPromise()];case 6:if(!(S=F.sent()))return k.fF.assertFail("no slice was found from the reference - setValueShortcut"),[2];if(h=S.uid,(0,at.IW)(S))return k.fF.assertFail("No support for setting values for composite slices yet"),[2];w=(0,c.__assign)((0,c.__assign)({},S.control.properties.descriptor),{originSource:S.originSource,canvasItems:[p]}),null!=O?(E=(0,Oe.ks)(O,w,h,S.originSource,[p],1),n.push(E)):i.push(w),F.label=7;case 7:return g++,[3,3];case 8:return r++,[3,2];case 9:return _.isEmpty(n)?[3,11]:[4,this.formattingService.saveValues({changes:n},t)];case 10:F.sent(),F.label=11;case 11:return _.isEmpty(i)?[3,13]:[4,this.formattingService.revertToDefault(i)];case 12:F.sent(),F.label=13;case 13:return[2]}})})},a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(ut.i),e.\u0275\u0275inject(dt.D),e.\u0275\u0275inject(pt.J),e.\u0275\u0275inject(fe),e.\u0275\u0275inject(xe.H),e.\u0275\u0275inject($e),e.\u0275\u0275inject(ft.r),e.\u0275\u0275inject(we.s),e.\u0275\u0275inject(_e.z),e.\u0275\u0275inject(vt.kc),e.\u0275\u0275inject(gt.Q))},a.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Jn={provide:Ye.e,useFactory:function(a,o,t,n,i,r,l,u,d,p,m,g){var f=new Xn(a,o,t,n,i,r,l,d,p,m,g);return u.resolve(f)},deps:[ut.i,dt.D,pt.J,fe,xe.H,$e,ft.r,Xe.t,we.s,_e.z,vt.kc,gt.Q]},qn=s(9398),ei=s(82156),ti=s(79061),ni=s(45925),ii=s(53935),oi=s(6015),ri=s(94841),ai=s(45411),li=s(66972),si=s(55533),ci=s(16095),ui=s(27037),di=s(54485),pi=[{type:ge,componentId:"MiniToolbarLargeButtonComponentId"},{type:Rn,componentId:"OutlineOverlayComponentId"}],mi=function(){function a(o){s.e("on-object").then(s.bind(s,39875)).then(function(t){o.registerIcons(t.iconSpriteSheet.sprite)})}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275inject(di.u))},a.\u0275mod=e.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=e.\u0275\u0275defineInjector({providers:[$e,Jn,Rt,fe],imports:[U.CommonModule,ni.e,re.u5,ei.N.withManifests(pi),ti.v,ii.e,oi.C,ri.b,ai.m,li.N,si.q,ci.Z,re.UX,qn.Bz.forChild(V.Vc),ui.b]}),a}();e.\u0275\u0275setComponentScope(Pn,function(){return[U.NgIf,ot,Fe]},[])},36861:function(ue,Q,s){s.d(Q,{w:function(){return ae}});var V=s(81337),c=s(50423),N=s(17174),P=s(62458);function j(D){P.fF.assert(function(){return!_.isEmpty(D)},"Font family should exist");var C=D.match(/^(?:\s)*('|")?((?:\w|\s|-|\\.)+)(?:\1(?=,|$))/);return C&&C[2]||D}var e=s(72065),U=s(11547),ne=s(59017),ce=s(14172),q=s(83317),K=s(77526),J=s(39681),ie=function(){function D(){}return D.prototype.getAllFonts=function(){return _.map(D.StandardFonts,function(C){return(0,J.ED)(C)})},D.getFamilyCSS=function(C){return C?C.map(function(M){return M.indexOf(" ")>-1?"'".concat(M,"'"):M}).join(", "):null},D.StandardFonts=_.map([{families:["Arial"],displayName:"Arial"},{families:["Arial Black"],displayName:"Arial Black"},{families:["Arial Unicode MS"],displayName:"Arial Unicode MS"},{families:["Calibri"],displayName:"Calibri"},{families:["Cambria"],displayName:"Cambria"},{families:["Cambria Math"],displayName:"Cambria Math"},{families:["Candara"],displayName:"Candara"},{families:["Comic Sans MS"],displayName:"Comic Sans MS"},{families:["Consolas"],displayName:"Consolas"},{families:["Constantia"],displayName:"Constantia"},{families:["Corbel"],displayName:"Corbel"},{families:["Courier New"],displayName:"Courier New"},{families:["wf_standard-font","helvetica","arial","sans-serif"],displayName:"DIN"},{families:["wf_standard-font_light","helvetica","arial","sans-serif"],displayName:"DIN Light"},{families:["Georgia"],displayName:"Georgia"},{families:["Lucida Sans Unicode"],displayName:"Lucida Sans Unicode"},{families:["Segoe UI","wf_segoe-ui_normal","helvetica","arial","sans-serif"],displayName:"Segoe UI"},{families:["Segoe UI Light","wf_segoe-ui_light","helvetica","arial","sans-serif"],displayName:"Segoe UI Light"},{families:["Segoe UI Semibold","wf_segoe-ui_semibold","helvetica","arial","sans-serif"],displayName:"Segoe UI Semibold"},{families:["Segoe UI Bold","wf_segoe-ui_bold","helvetica","arial","sans-serif"],displayName:"Segoe UI Bold"},{families:["Symbol"],displayName:"Symbol",suppressStyle:!0},{families:["Tahoma"],displayName:"Tahoma"},{families:["Times New Roman"],displayName:"Times New Roman"},{families:["Trebuchet MS"],displayName:"Trebuchet MS"},{families:["Verdana"],displayName:"Verdana"},{families:["Wingdings"],displayName:"Wingdings",suppressStyle:!0}],function(C){return{family:D.getFamilyCSS(C.families),displayName:C.displayName,suppressStyle:C.suppressStyle}}),D.\u0275prov=c.\u0275\u0275defineInjectable({token:D,factory:D.\u0275fac=function(M){return new(M||D)},providedIn:"root"}),D}(),Y=s(77476),z=s(76492),A=s(42189),he=s(9529);function de(D,C){if(1&D&&(c.\u0275\u0275elementStart(0,"pbi-dropdown-item",5)(1,"p",3),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd()()),2&D){var M=C.$implicit;c.\u0275\u0275property("value",M),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngStyle",M.style),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(M.displayName)}}var pe=function(C){return{showFullContent:C}};function ge(D,C){if(1&D){var M=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"pbi-dropdown",2),c.\u0275\u0275listener("valueChange",function(se){c.\u0275\u0275restoreView(M);var me=c.\u0275\u0275nextContext(2);return c.\u0275\u0275resetView(me.setFontFamily(se))}),c.\u0275\u0275pipe(1,"async"),c.\u0275\u0275elementStart(2,"pbi-dropdown-trigger")(3,"p",3),c.\u0275\u0275text(4),c.\u0275\u0275elementEnd()(),c.\u0275\u0275template(5,de,3,3,"pbi-dropdown-item",4),c.\u0275\u0275elementEnd()}if(2&D){var T=C.ngIf,L=c.\u0275\u0275nextContext().ngIf,H=c.\u0275\u0275nextContext();c.\u0275\u0275property("aria-label",H.ariaLabel)("aria-labelledby",H.ariaLabelledby)("aria-describedby",H.ariaDescribedby)("compact",H.compact)("size",H.size)("maxHeight",H.maxHeight)("options",c.\u0275\u0275pureFunction1(14,pe,H.showFullContent))("value",T)("isDisabled",c.\u0275\u0275pipeBind1(1,12,H.isDisabled$)),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngStyle",T.style),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(T.displayName),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",L)}}function re(D,C){if(1&D&&(c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275template(1,ge,6,16,"pbi-dropdown",1),c.\u0275\u0275pipe(2,"async"),c.\u0275\u0275elementContainerEnd()),2&D){var M=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",c.\u0275\u0275pipeBind1(2,1,M.selectedItem$))}}var ae=function(D){function C(M){var T=D.call(this)||this;return T.fontService=M,T.onFontFamilyChange=new c.EventEmitter,T.maxHeight=324,T}return(0,V.__extends)(C,D),C.prototype.ngOnInit=function(){this.isDisabled$=this.mergePropertyInputsAndFormControl(this.changes$("isDisabled"),this.disabled$,"isDisabled",this.onDestroy$),this.populateFontPickerItems()},C.prototype.populateFontPickerItems=function(){var M=this,T=this.mergePropertyInputsAndFormControl(this.changes$("fontFamily"),this.value$,"fontFamily",this.onDestroy$).pipe((0,ce.U)(function(L){return M.normalizeFontFamily(L)}),(0,q.R)(this.onDestroy$),(0,K.x)());this.fontPickerItems$=(0,U.of)(this.fontService.getAllFonts()).pipe((0,ce.U)(function(L){return L.map(function(H){return M.getFontPickerItem(H)})})),this.selectedItem$=(0,ne.aj)([T,this.fontPickerItems$]).pipe((0,ce.U)(function(L){var H,le=L[0];return null!==(H=_.find(L[1],function(me){return me.family===le}))&&void 0!==H?H:M.getCustomFontPickerInfo(le)}))},C.prototype.normalizeFontFamily=function(M){return(M??"").split(", ").map(function(T){return T.indexOf(" ")>0&&!T.startsWith("'")?"'".concat(T,"'"):T}).join(", ")},C.prototype.getFontPickerItem=function(M){return{displayName:M.displayName,family:M.family,style:{fontFamily:M.suppressStyle?void 0:M.family}}},C.prototype.setFontFamily=function(M){var T=M.family;this.onFontFamilyChange.emit(T),this.onValueChange(T),this.onTouched()},C.prototype.getCustomFontPickerInfo=function(M){return{displayName:M?j(M):"",family:M,style:{fontFamily:M}}},C.\u0275fac=function(T){return new(T||C)(c.\u0275\u0275directiveInject(ie))},C.\u0275cmp=c.\u0275\u0275defineComponent({type:C,selectors:[["font-picker"]],inputs:{fontFamily:"fontFamily",ariaLabel:"ariaLabel",ariaDescribedby:"ariaDescribedby",ariaLabelledby:"ariaLabelledby",compact:"compact",isDisabled:"isDisabled",showFullContent:"showFullContent",size:"size"},outputs:{onFontFamilyChange:"onFontFamilyChange"},features:[c.\u0275\u0275ProvidersFeature([{provide:N.JU,useExisting:(0,c.forwardRef)(function(){return C}),multi:!0}]),c.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],[3,"aria-label","aria-labelledby","aria-describedby","compact","size","maxHeight","options","value","isDisabled","valueChange",4,"ngIf"],[3,"aria-label","aria-labelledby","aria-describedby","compact","size","maxHeight","options","value","isDisabled","valueChange"],[3,"ngStyle"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(T,L){1&T&&(c.\u0275\u0275template(0,re,3,3,"ng-container",0),c.\u0275\u0275pipe(1,"async")),2&T&&c.\u0275\u0275property("ngIf",c.\u0275\u0275pipeBind1(1,1,L.fontPickerItems$))},dependencies:[Y.NgForOf,Y.NgIf,Y.NgStyle,z.H,A.r,he._,z.T,Y.AsyncPipe],styles:["pbi-dropdown[_ngcontent-%COMP%]{width:100%}pbi-dropdown-trigger[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}pbi-dropdown-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:auto}"],changeDetection:0}),C}(e.N)},45925:function(ue,Q,s){s.d(Q,{e:function(){return j}});var V=s(6015),c=s(77476),N=s(17174),P=s(50423),j=function(){function e(){}return e.\u0275fac=function(ne){return new(ne||e)},e.\u0275mod=P.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=P.\u0275\u0275defineInjector({imports:[c.CommonModule,N.u5,V.C,N.UX]}),e}()},53935:function(ue,Q,s){s.d(Q,{e:function(){return N}});var V=s(77476),c=s(50423),N=function(){function P(){}return P.\u0275fac=function(e){return new(e||P)},P.\u0275mod=c.\u0275\u0275defineNgModule({type:P}),P.\u0275inj=c.\u0275\u0275defineInjector({imports:[V.CommonModule]}),P}()}}]);