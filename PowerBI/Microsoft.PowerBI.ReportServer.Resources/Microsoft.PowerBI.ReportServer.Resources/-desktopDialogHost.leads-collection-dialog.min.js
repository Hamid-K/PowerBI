"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["leads-collection-dialog"],{62113:function(Z,N,l){l.d(N,{Q:function(){return W}});var P,n,I=l(81337),b=l(29019),v=l(66422),s=l(37241),L=l(41170),o_clientInfoDecodingError_code="client_info_decoding_error",o_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",o_clientInfoEmptyError_code="client_info_empty_error",o_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",o_tokenParsingError_code="token_parsing_error",o_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",o_nullOrEmptyToken_code="null_or_empty_token",o_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",o_endpointResolutionError_code="endpoints_resolution_error",o_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",o_networkError_code="network_error",o_networkError_desc="Network request failed. Please check network trace to determine root cause.",o_unableToGetOpenidConfigError_code="openid_config_error",o_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",o_hashNotDeserialized_code="hash_not_deserialized",o_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",o_invalidStateError_code="invalid_state",o_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",o_stateMismatchError_code="state_mismatch",o_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",o_stateNotFoundError_code="state_not_found",o_stateNotFoundError_desc="State not found",o_nonceMismatchError_code="nonce_mismatch",o_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",o_nonceNotFoundError_code="nonce_not_found",o_nonceNotFoundError_desc="nonce not found",o_multipleMatchingTokens_code="multiple_matching_tokens",o_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",o_multipleMatchingAccounts_code="multiple_matching_accounts",o_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",o_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",o_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",o_tokenRequestCannotBeMade_code="request_cannot_be_made",o_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",o_appendEmptyScopeError_code="cannot_append_empty_scope",o_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",o_removeEmptyScopeError_code="cannot_remove_empty_scope",o_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",o_appendScopeSetError_code="cannot_append_scopeset",o_appendScopeSetError_desc="Cannot append ScopeSet due to error.",o_emptyInputScopeSetError_code="empty_input_scopeset",o_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",o_DeviceCodePollingCancelled_code="device_code_polling_cancelled",o_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",o_DeviceCodeExpired_code="device_code_expired",o_DeviceCodeExpired_desc="Device code is expired.",o_DeviceCodeUnknownError_code="device_code_unknown_error",o_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",o_NoAccountInSilentRequest_code="no_account_in_silent_request",o_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",o_invalidCacheRecord_code="invalid_cache_record",o_invalidCacheRecord_desc="Cache record object was null or undefined.",o_invalidCacheEnvironment_code="invalid_cache_environment",o_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",o_noAccountFound_code="no_account_found",o_noAccountFound_desc="No account found in cache for given key.",o_CachePluginError_code="no cache plugin set on CacheManager",o_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",o_noCryptoObj_code="no_crypto_object",o_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",o_invalidCacheType_code="invalid_cache_type",o_invalidCacheType_desc="Invalid cache type",o_unexpectedAccountType_code="unexpected_account_type",o_unexpectedAccountType_desc="Unexpected account type.",o_unexpectedCredentialType_code="unexpected_credential_type",o_unexpectedCredentialType_desc="Unexpected credential type.",o_invalidAssertion_code="invalid_assertion",o_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",o_invalidClientCredential_code="invalid_client_credential",o_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",o_tokenRefreshRequired_code="token_refresh_required",o_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",o_userTimeoutReached_code="user_timeout_reached",o_userTimeoutReached_desc="User defined timeout for device code polling reached",o_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",o_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",o_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",o_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",o_bindingKeyNotRemovedError_code="binding_key_not_removed",o_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",o_logoutNotSupported_code="end_session_endpoint_not_supported",o_logoutNotSupported_desc="Provided authority does not support logout.",o_keyIdMissing_code="key_id_missing",o_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",C=function(n){function e(t,r){var u=n.call(this,t,r)||this;return u.name="ClientAuthError",Object.setPrototypeOf(u,e.prototype),u}return(0,s.ZT)(e,n),e.createClientInfoDecodingError=function(t){return new e(o_clientInfoDecodingError_code,o_clientInfoDecodingError_desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(o_clientInfoEmptyError_code,""+o_clientInfoEmptyError_desc)},e.createTokenParsingError=function(t){return new e(o_tokenParsingError_code,o_tokenParsingError_desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(o_nullOrEmptyToken_code,o_nullOrEmptyToken_desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(o_endpointResolutionError_code,o_endpointResolutionError_desc+" Detail: "+t)},e.createNetworkError=function(t,r){return new e(o_networkError_code,o_networkError_desc+" | Fetch client threw: "+r+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(o_unableToGetOpenidConfigError_code,o_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(o_hashNotDeserialized_code,o_hashNotDeserialized_desc+" Given Object: "+t)},e.createInvalidStateError=function(t,r){return new e(o_invalidStateError_code,o_invalidStateError_desc+" Invalid State: "+t+", Root Err: "+r)},e.createStateMismatchError=function(){return new e(o_stateMismatchError_code,o_stateMismatchError_desc)},e.createStateNotFoundError=function(t){return new e(o_stateNotFoundError_code,o_stateNotFoundError_desc+":  "+t)},e.createNonceMismatchError=function(){return new e(o_nonceMismatchError_code,o_nonceMismatchError_desc)},e.createNonceNotFoundError=function(t){return new e(o_nonceNotFoundError_code,o_nonceNotFoundError_desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(o_multipleMatchingTokens_code,o_multipleMatchingTokens_desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(o_multipleMatchingAccounts_code,o_multipleMatchingAccounts_desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(o_multipleMatchingAppMetadata_code,o_multipleMatchingAppMetadata_desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(o_tokenRequestCannotBeMade_code,o_tokenRequestCannotBeMade_desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(o_appendEmptyScopeError_code,o_appendEmptyScopeError_desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(o_removeEmptyScopeError_code,o_removeEmptyScopeError_desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(o_appendScopeSetError_code,o_appendScopeSetError_desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(o_emptyInputScopeSetError_code,""+o_emptyInputScopeSetError_desc)},e.createDeviceCodeCancelledError=function(){return new e(o_DeviceCodePollingCancelled_code,""+o_DeviceCodePollingCancelled_desc)},e.createDeviceCodeExpiredError=function(){return new e(o_DeviceCodeExpired_code,""+o_DeviceCodeExpired_desc)},e.createDeviceCodeUnknownError=function(){return new e(o_DeviceCodeUnknownError_code,""+o_DeviceCodeUnknownError_desc)},e.createNoAccountInSilentRequestError=function(){return new e(o_NoAccountInSilentRequest_code,""+o_NoAccountInSilentRequest_desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(o_invalidCacheRecord_code,o_invalidCacheRecord_desc)},e.createInvalidCacheEnvironmentError=function(){return new e(o_invalidCacheEnvironment_code,o_invalidCacheEnvironment_desc)},e.createNoAccountFoundError=function(){return new e(o_noAccountFound_code,o_noAccountFound_desc)},e.createCachePluginError=function(){return new e(o_CachePluginError_code,""+o_CachePluginError_desc)},e.createNoCryptoObjectError=function(t){return new e(o_noCryptoObj_code,""+o_noCryptoObj_desc+t)},e.createInvalidCacheTypeError=function(){return new e(o_invalidCacheType_code,""+o_invalidCacheType_desc)},e.createUnexpectedAccountTypeError=function(){return new e(o_unexpectedAccountType_code,""+o_unexpectedAccountType_desc)},e.createUnexpectedCredentialTypeError=function(){return new e(o_unexpectedCredentialType_code,""+o_unexpectedCredentialType_desc)},e.createInvalidAssertionError=function(){return new e(o_invalidAssertion_code,""+o_invalidAssertion_desc)},e.createInvalidCredentialError=function(){return new e(o_invalidClientCredential_code,""+o_invalidClientCredential_desc)},e.createRefreshRequiredError=function(){return new e(o_tokenRefreshRequired_code,o_tokenRefreshRequired_desc)},e.createUserTimeoutReachedError=function(){return new e(o_userTimeoutReached_code,o_userTimeoutReached_desc)},e.createTokenClaimsRequiredError=function(){return new e(o_tokenClaimsRequired_code,o_tokenClaimsRequired_desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(o_noAuthorizationCodeFromServer_code,o_noAuthorizationCodeFromServer_desc)},e.createBindingKeyNotRemovedError=function(){return new e(o_bindingKeyNotRemovedError_code,o_bindingKeyNotRemovedError_desc)},e.createLogoutNotSupportedError=function(){return new e(o_logoutNotSupported_code,o_logoutNotSupported_desc)},e.createKeyIdMissingError=function(){return new e(o_keyIdMissing_code,o_keyIdMissing_desc)},e}(L.l),_=function(){function n(){}return n.decodeAuthToken=function(e){if(n.isEmpty(e))throw C.createTokenNullOrEmptyError(e);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!r||r.length<4)throw C.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},n.isEmpty=function(e){return typeof e>"u"||!e||0===e.length},n.isEmptyObj=function(e){if(e&&!n.isEmpty(e))try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch{}return!0},n.startsWith=function(e,t){return 0===e.indexOf(t)},n.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},n.queryStringToObject=function(e){var t={},r=e.split("&"),u=function(h){return decodeURIComponent(h.replace(/\+/g," "))};return r.forEach(function(f){if(f.trim()){var h=f.split(/=(.+)/g,2),E=h[0],p=h[1];E&&p&&(t[u(E)]=u(p))}}),t},n.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},n.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!n.isEmpty(t)})},n.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},n.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},n}();(n=P||(P={}))[n.Default=0]="Default",n[n.Adfs=1]="Adfs";var z=function(){function n(){}return n.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(v.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},n.prototype.generateAccountKey=function(){return n.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},n.prototype.generateType=function(){switch(this.authorityType){case v.iR.ADFS_ACCOUNT_TYPE:return v.LL.ADFS;case v.iR.MSAV1_ACCOUNT_TYPE:return v.LL.MSA;case v.iR.MSSTS_ACCOUNT_TYPE:return v.LL.MSSTS;case v.iR.GENERIC_ACCOUNT_TYPE:return v.LL.GENERIC;default:throw C.createUnexpectedAccountTypeError()}},n.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},n.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||v.gT.EMPTY_STRING,e.tenantId||v.gT.EMPTY_STRING].join(v.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},n.createAccount=function(e,t,r,u,f,h,E,p,m){var a,i,c,d,g,S,y=new n;y.authorityType=v.iR.MSSTS_ACCOUNT_TYPE,y.clientInfo=e,y.homeAccountId=t,y.nativeAccountId=m;var k=p||u&&u.getPreferredCache();if(!k)throw C.createInvalidCacheEnvironmentError();return y.environment=k,y.realm=(null===(a=r?.claims)||void 0===a?void 0:a.tid)||v.gT.EMPTY_STRING,y.oboAssertion=f,r&&(y.idTokenClaims=r.claims,y.localAccountId=(null===(i=r?.claims)||void 0===i?void 0:i.oid)||(null===(c=r?.claims)||void 0===c?void 0:c.sub)||v.gT.EMPTY_STRING,y.username=(null===(d=r?.claims)||void 0===d?void 0:d.preferred_username)||(null!==(g=r?.claims)&&void 0!==g&&g.emails?r.claims.emails[0]:v.gT.EMPTY_STRING),y.name=null===(S=r?.claims)||void 0===S?void 0:S.name),y.cloudGraphHostName=h,y.msGraphHost=E,y},n.createGenericAccount=function(e,t,r,u,f,h,E){var p,m,a,i,c=new n;c.authorityType=r&&r.authorityType===P.Adfs?v.iR.ADFS_ACCOUNT_TYPE:v.iR.GENERIC_ACCOUNT_TYPE,c.homeAccountId=e,c.realm=v.gT.EMPTY_STRING,c.oboAssertion=u;var d=E||r&&r.getPreferredCache();if(!d)throw C.createInvalidCacheEnvironmentError();return t&&(c.localAccountId=(null===(p=t?.claims)||void 0===p?void 0:p.oid)||(null===(m=t?.claims)||void 0===m?void 0:m.sub)||v.gT.EMPTY_STRING,c.username=(null===(a=t?.claims)||void 0===a?void 0:a.upn)||v.gT.EMPTY_STRING,c.name=(null===(i=t?.claims)||void 0===i?void 0:i.name)||v.gT.EMPTY_STRING,c.idTokenClaims=t?.claims),c.environment=d,c.cloudGraphHostName=f,c.msGraphHost=h,c},n.generateHomeAccountId=function(e,t,r,u,f){var h,E=null!==(h=f?.claims)&&void 0!==h&&h.sub?f.claims.sub:v.gT.EMPTY_STRING;if(t===P.Adfs)return E;if(e)try{var p=function(n,e){if(_.isEmpty(n))throw C.createClientInfoEmptyError();try{var t=e.base64Decode(n);return JSON.parse(t)}catch(r){throw C.createClientInfoDecodingError(r)}}(e,u);if(!_.isEmpty(p.uid)&&!_.isEmpty(p.utid))return""+p.uid+v.Bv.CLIENT_INFO_SEPARATOR+p.utid}catch{}return r.verbose("No client info in response"),E},n.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},n.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var u=!0;if(r){var f=e.idTokenClaims||{},h=t.idTokenClaims||{};u=f.iat===h.iat&&f.nonce===h.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&u},n}(),j=l(98665),G=l(98049),w=l(19270),H=l(66070),D=function(n){function e(t,r){var u=n.call(this,t)||this;return u.message=t,u.msalError=r,u}return(0,I.__extends)(e,n),e}(Error),R=l(41114),O="PBI.App.AdHocTokenAcquisition",x=R.cx[O]=(0,R.b1)(O),U="PBI.App.AdHocTokenAcquisition.UserConfirmation",q=R.cx[U]=(0,R.b1)(U),M=l(50423),B=l(58938),Y=l(65181),T=window,W=function(){function n(e,t,r){this.dialogService=e,this.localizationService=t,this.telemetryService=r,this.msalClientApplication=T.msalClientApplication}return n.prototype.acquireToken=function(e,t,r){var u;return void 0===r&&(r=!1),(0,I.__awaiter)(this,void 0,void 0,function(){var f,h,E,p,m;return(0,I.__generator)(this,function(a){switch(a.label){case 0:if(f=this.retrieveSignedInAccount(),h=this.telemetryService.startActivity(null,x,{scenarioName:e,authMethod:"Silent"}),!f)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.msalClientApplication.acquireTokenSilent({scopes:t,account:f,forceRefresh:r})];case 2:return E=a.sent(),h.resolve(),[2,{token:E.accessToken,expiry:E.expiresOn}];case 3:throw(p=a.sent()).constructor.name===b.Yo.name?(h.reject({errorSource:"External",errorMessage:m=w.fW.UserInteractionRequired,errorCode:"UserInteractionRequired"}),new D(m,p)):(m=null!==(u=p.message)&&void 0!==u?u:p,h.reject({errorSource:"External",errorMessage:m,errorCode:p.code}),new D("Error code: ".concat(p.code,", error message: ").concat(m),p));case 4:return[3,6];case 5:throw h.reject({errorSource:"PowerBI",errorMessage:m=w.fW.UserNotSignedIn,errorCode:"UserNotSignedIn"}),Error(m);case 6:return[2]}})})},n.prototype.acquireTokenPopup=function(e,t){return(0,I.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,I.__generator)(this,function(u){return[2,H.kB.retryOnInteractionInProgressError(function(){return r.acquireTokenPopupInternal(e,t)})]})})},n.prototype.acquireTokenPopupInternal=function(e,t){var r;return(0,I.__awaiter)(this,void 0,void 0,function(){var f,h,E,p,m,a;return(0,I.__generator)(this,function(i){switch(i.label){case 0:return[4,this.dialogService.open(G.J,{data:{title:this.localizationService.get("AcquireToken_Dialog_VerifyIdentity"),ariaLabel:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),message:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),cancelButtonText:this.localizationService.get("ModalDialog_Cancel")},autoFocus:!0}).afterClosed().toPromise()];case 1:if(f=i.sent(),this.telemetryService.logEvent(q,{scenarioName:e,authMethod:"Popup",result:1===f}),1!==f)throw Error(w.fW.UserInteractionDeclined);h=this.retrieveSignedInAccount(),E=this.telemetryService.startActivity(null,x,{scenarioName:e,authMethod:"Popup"}),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.msalClientApplication.acquireTokenPopup({scopes:t,account:h})];case 3:return p=i.sent(),this.msalClientApplication.setActiveAccount(p.account),[3,5];case 4:throw m=i.sent(),a=null!==(r=m.message)&&void 0!==r?r:m,E.reject({errorSource:"External",errorMessage:a,errorCode:m.code}),new D("Error code: ".concat(m.code,", error message: ").concat(a),m);case 5:if(!z.accountInfoIsEqual(h??null,p.account))throw E.reject({errorSource:"External",errorMessage:w.fW.UserAccountChanged,errorCode:"UserAccountChanged"}),this.reloadPage(),Error(w.fW.UserAccountChanged);return E.resolve(),[2,{token:p.accessToken,expiry:p.expiresOn}]}})})},n.prototype.reloadPage=function(){window.location.reload()},n.prototype.retrieveSignedInAccount=function(){return T.signInProviderService.retrieveSignedInAccount()},n.\u0275fac=function(t){return new(t||n)(M.\u0275\u0275inject(B.x),M.\u0275\u0275inject(Y.o),M.\u0275\u0275inject(j.y0))},n.\u0275prov=M.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},38022:function(Z,N,l){l.r(N),l.d(N,{LeadsCollectionDialogModule:function(){return m}});var I=l(16748),b=l(42729),v=l(62113),s=l(50423),L=function(){function a(){}return a.\u0275fac=function(c){return new(c||a)},a.\u0275mod=s.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=s.\u0275\u0275defineInjector({providers:[v.Q],imports:[b.c]}),a}(),o=l(32293),C=l(77476),_=l(79061),F=l(4444),V=l(59694),P=l(40580),z=l(35510),j=l(6754),G=l(18942),w=l(65181),H=l(73875),D=l(58938),R=l(32140),O=l(9380),x=l(22844),U=l(50057),q=l(24326),M=["iframe"];function B(a,i){1&a&&s.\u0275\u0275element(0,"pbi-spinner",6)}var Y=function(){return{"aria-label":"Close"}},T=window,p=[{componentType:function(){function a(i,c,d,g,S,y,k,K,A){var J=this;this.frontEndUrl=i,this.sanitizer=c,this.dialogRef=d,this.localizationService=g,this.httpService=S,this.accessTokenProviderService=y,this.dialogService=k,this.userInfoService=K,this.tokenScopes=[T.microsoftGraphUrl+"/User.Read"],this.isLoading=new z.X(!0),this.baseUrl=A.featureSwitches.newLeadsUrl?"https://www.microsoft.com/":"https://powerbi.microsoft.com/",A.featureSwitches.leadsTip1&&(this.baseUrl="https://tip1.powerbi.microsoft.com/"),A.featureSwitches.leadsTip2&&(this.baseUrl="https://tip2.powerbi.microsoft.com/"),A.featureSwitches.leadsDevUrl&&(this.baseUrl="https://powerbi-frontend-tip2-eastus.azurewebsites.net/"),this.leadsCollectionUrl=this.sanitizer.bypassSecurityTrustResourceUrl(A.featureSwitches.newLeadsUrl?this.baseUrl+this.localizationService.currentLanguageLocale+"/product-leadcollection/lead-collection/":this.baseUrl+this.localizationService.currentLanguageLocale+"/lead-collection/"),this.title=this.localizationService.get("CustomerVoiceSurveyTitle"),A.featureSwitches.leadsTesting||this.isLoading.pipe((0,j.b)(1e4)).subscribe(function(Q){return Q?J.closeDialog(!1,"timeout"):null})}return a.prototype.ngOnInit=function(){var i=this;T.clientAuthEnabled?(this.graphTokenPromiseV2=this.accessTokenProviderService.acquireToken("LeadsCollectionDialog",this.tokenScopes),this.graphTokenPromiseV2.catch(function(c){i.closeDialog(!1,c)})):(this.graphTokenPromise=this.httpService.get((0,V.W)("{0}/graph",this.frontEndUrl),this.httpService.powerbiRequestOptions()).toPromise(),this.graphTokenPromise.catch(function(c){var d;i.closeDialog(!1,(null===(d=c?.data)||void 0===d?void 0:d.message)||c.status)})),this.isNotFirstTrial=this.userInfoService.userFreeTrialExpired||this.userInfoService.userFreeTrialDaysRemaining>=0,this.messageHandler=function(c){return i.handleMessage(c)},window.addEventListener("message",this.messageHandler)},a.prototype.postData=function(i,c){var d=(0,F.bG)().uoid,g=T.tenantId,S=i.get("Leads_Dialog_Header"),y=i.get(this.isNotFirstTrial?"Leads_Dialog_Subheader_Trial_Renewal":"Leads_Dialog_Subheader"),k=i.get(this.isNotFirstTrial?"Leads_Dialog_Button_Renewal":"Leads_Dialog_Button"),J=this.iframe.nativeElement,X=JSON.stringify({token:c,userObjId:d,headerText:S,subHeaderText:y,ctaText:k,tenantID:g,offerID:this.isNotFirstTrial?"CO-DBI-Account-PowerBI-TrialRenewal-OfferID":"CO-DBI-ACCOUNT-POWERBI-TRIALINITIATION-OFFERID",GraphUrl:T.microsoftGraphUrl});J.contentWindow.postMessage(""+X,"*")},a.prototype.ngOnDestroy=function(){window.removeEventListener("message",this.messageHandler)},a.prototype.close=function(i){this.closeDialog()},a.prototype.closeOnOverlayClicked=function(i){if(this.isNotFirstTrial){var c=(i?.target).className;c?.includes("cdk-overlay-backdrop")&&this.showNoTrialDialog()}},a.prototype.closeDialog=function(i,c){var d=this;document.getElementById("leads").remove(),this.dialogRef.close({isComplete:i,error:c}),this.isNotFirstTrial&&this.dialogRef.afterClosed().subscribe(function(){return d.showNoTrialDialog()})},a.prototype.showNoTrialDialog=function(){var i,d=(i=this.getNoTrialDialogContentByServicePlan()).title;this.dialogService.showSimpleDialog(d,i.message,{panelClass:["no-trial-dialog"],maxHeight:"min-content",maxWidth:"340px"},{url:"https://go.microsoft.com/fwlink/?linkid=2222575",text:"LearnMore",showIcon:!0},this.localizationService.get("ModalDialogButtonText_GotIt"))},a.prototype.getNoTrialDialogContentByServicePlan=function(){var i,c;return this.userInfoService.userHasProPlan?(i=this.localizationService.get("Workspace_LicenseMode_Pro"),c=this.localizationService.get("PowerBI_PremiumPerUser")):(i=this.localizationService.get("PowerBI_Free"),c=this.localizationService.get("Workspace_LicenseMode_Pro")),{title:this.localizationService.format("TrialRenewalRefused_Dialog_Title",[i]),message:this.localizationService.format("TrialRenewalRefused_Dialog_Message",[i,c])}},a.prototype.handleMessage=function(i){var c=this;if(this.isTrustedOrigin(i.origin)&&this.isTrustedSource(i.source)&&this.isTrustedData(i.data)){var d;try{d=JSON.parse(i.data)}catch(g){return void this.dialogRef.close({error:g})}if(d.Error&&2!==d.FormEvent)return void this.dialogRef.close({isComplete:6===d.FormEvent,error:d.Error});switch(d.FormEvent){case 1:T.clientAuthEnabled?this.graphTokenPromiseV2.then(function(g){c.postData(c.localizationService,g.token)}):this.graphTokenPromise.then(function(g){c.postData(c.localizationService,g.data)});break;case 4:this.isLoading.next(!1);break;case 6:this.dialogRef.close({isComplete:!0,error:d.Error})}}},a.prototype.isTrustedOrigin=function(i){return new URL(i).origin===new URL(this.baseUrl).origin},a.prototype.isTrustedSource=function(i){return i===this.iframe.nativeElement.contentWindow},a.prototype.isTrustedData=function(i){return"string"==typeof i},a.\u0275fac=function(c){return new(c||a)(s.\u0275\u0275directiveInject(P.Zp),s.\u0275\u0275directiveInject(G.H7),s.\u0275\u0275directiveInject(o.so),s.\u0275\u0275directiveInject(w.o),s.\u0275\u0275directiveInject(H.O),s.\u0275\u0275directiveInject(v.Q),s.\u0275\u0275directiveInject(D.x),s.\u0275\u0275directiveInject(R.a),s.\u0275\u0275directiveInject(O.vZ))},a.\u0275cmp=s.\u0275\u0275defineComponent({type:a,selectors:[["leads-collection-dialog"]],viewQuery:function(c,d){var g;(1&c&&s.\u0275\u0275viewQuery(M,5,s.ElementRef),2&c)&&(s.\u0275\u0275queryRefresh(g=s.\u0275\u0275loadQuery())&&(d.iframe=g.first))},hostBindings:function(c,d){1&c&&s.\u0275\u0275listener("keyup.escape",function(S){return d.close(S)},!1,s.\u0275\u0275resolveWindow)("click",function(S){return d.closeOnOverlayClicked(S)},!1,s.\u0275\u0275resolveBody)},decls:10,vars:10,consts:[[1,"header-container"],[1,"header-actions"],["id","close-button","mat-button","","localizeTooltip","Close",1,"glyphicon","pbi-glyph-close","glyph-small","close-button",3,"localizeAttr","click"],["class","pbi-spinner-large",4,"ngIf"],["id","leads","width","100%","height","100%","frameborder","0","marginwidth","0","marginheight","0","scrolling","auto","seamless","seamless","sandbox","allow-forms allow-presentation allow-same-origin allow-scripts allow-popups","allowfullscreen","","webkitallowfullscreen","","mozallowfullscreen","","msallowfullscreen","",1,"leads-form",3,"hidden","title","src"],["iframe",""],[1,"pbi-spinner-large"]],template:function(c,d){1&c&&(s.\u0275\u0275elementStart(0,"mat-dialog-content")(1,"div",0)(2,"header")(3,"div",1)(4,"button",2),s.\u0275\u0275listener("click",function(){return d.closeDialog()}),s.\u0275\u0275elementEnd()()()(),s.\u0275\u0275template(5,B,1,0,"pbi-spinner",3),s.\u0275\u0275pipe(6,"async"),s.\u0275\u0275element(7,"iframe",4,5),s.\u0275\u0275pipe(9,"async"),s.\u0275\u0275elementEnd()),2&c&&(s.\u0275\u0275advance(4),s.\u0275\u0275property("localizeAttr",s.\u0275\u0275pureFunction0(9,Y)),s.\u0275\u0275advance(1),s.\u0275\u0275property("ngIf",s.\u0275\u0275pipeBind1(6,5,d.isLoading)),s.\u0275\u0275advance(2),s.\u0275\u0275propertyInterpolate("title",d.title),s.\u0275\u0275property("hidden",s.\u0275\u0275pipeBind1(9,7,d.isLoading))("src",d.leadsCollectionUrl,s.\u0275\u0275sanitizeResourceUrl))},dependencies:[o.xY,C.NgIf,x.b,U.r,q.k,C.AsyncPipe],styles:["pbi-spinner[_ngcontent-%COMP%]{height:650px;background-color:var(--fluent-theme-light-gray-color, #c8c8c8);display:flex;align-items:center;justify-content:center}.mat-mdc-dialog-content[_ngcontent-%COMP%]{padding:0;height:100%;position:relative;overflow:hidden}.header-container[_ngcontent-%COMP%]{position:absolute;top:10px;width:100%}.header-container[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;background-color:transparent}.header-container[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:0 24px;flex-direction:column;align-items:flex-end}.header-container[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{height:32px;border:none;padding:0;background-color:transparent}.leads-form[_ngcontent-%COMP%]{border:none;max-width:100%;max-height:100%}  .no-trial-dialog mat-dialog-container .mdc-dialog__surface{padding:0 24px}  .no-trial-dialog mat-dialog-container .pbi-dialog-header{margin-bottom:16px;margin-top:16px;align-items:baseline}  .no-trial-dialog mat-dialog-container .pbi-dialog-body{margin-bottom:32px}  .no-trial-dialog mat-dialog-container .pbi-dialog-footer{padding:0!important;height:72px}"],changeDetection:0}),a}(),componentIdentifier:l(71209).Q}],m=function(){function a(){}return a.\u0275fac=function(c){return new(c||a)},a.\u0275mod=s.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=s.\u0275\u0275defineInjector({imports:[o.Is,C.CommonModule,_.v,I.H,L,b.c.withManifest(p)]}),a}()}}]);