(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["shapeMap","shapeMapBehaviors"],{43174:function(En,_t,q){var wt,Ut;!function(){var tn={version:"1.6.19",mesh:function(N){return ft(N,Bt.apply(this,arguments))},meshArcs:Bt,merge:function(N){return ft(N,Kt.apply(this,arguments))},mergeArcs:Kt,feature:function(F,N){return"GeometryCollection"===N.type?{type:"FeatureCollection",features:N.geometries.map(function(x){return Ct(F,x)})}:Ct(F,N)},neighbors:function(F){var N={},x=F.map(function(){return[]});function G(H,V){H.forEach(function(K){K<0&&(K=~K);var zt=N[K];zt?zt.push(V):N[K]=[V]})}function b(H,V){H.forEach(function(K){G(K,V)})}var T={LineString:G,MultiLineString:b,Polygon:b,MultiPolygon:function(V,K){V.forEach(function(zt){b(zt,K)})}};for(var L in F.forEach(function W(H,V){"GeometryCollection"===H.type?H.geometries.forEach(function(K){W(K,V)}):H.type in T&&T[H.type](H.arcs,V)}),N)for(var k=N[L],g=k.length,z=0;z<g;++z)for(var M=z+1;M<g;++M){var A,P=k[z],j=k[M];(A=x[P])[L=ct(A,j)]!==j&&A.splice(L,0,j),(A=x[j])[L=ct(A,P)]!==P&&A.splice(L,0,P)}return x},presimplify:function(F,N){var x=Pn(F.transform),G=function(F){if(!F)return et;var N,x,G=F.scale[0],b=F.scale[1],W=F.translate[0],T=F.translate[1];return function(L,k){k||(N=x=0);var g=(L[0]-W)/G|0,z=(L[1]-T)/b|0;L[0]=g-N,L[1]=z-x,N=g,x=z}}(F.transform),b=function(){var F={},N=[],x=0;function G(W,T){for(;T>0;){var L=(T+1>>1)-1,k=N[L];if(E(W,k)>=0)break;N[k._=T]=k,N[W._=T=L]=W}}function b(W,T){for(;;){var L=T+1<<1,k=L-1,g=T,z=N[g];if(k<x&&E(N[k],z)<0&&(z=N[g=k]),L<x&&E(N[L],z)<0&&(z=N[g=L]),g===T)break;N[z._=T]=z,N[W._=T=g]=W}}return F.push=function(W){return G(N[W._=x]=W,x++),x},F.pop=function(){if(!(x<=0)){var T,W=N[0];return--x>0&&b(N[(T=N[x])._=0]=T,0),W}},F.remove=function(W){var L,T=W._;if(N[T]===W)return T!==--x&&(E(L=N[x],W)<0?G:b)(N[L._=T]=L,T),T},F}();function W(T){b.remove(T),T[1][2]=N(T),b.push(T)}return N||(N=Gt),F.arcs.forEach(function(T){for(var g,P,L=[],k=0,z=0,M=T.length;z<M;++z)x(T[z]=[(P=T[z])[0],P[1],1/0],z);for(z=1,M=T.length-1;z<M;++z)(g=T.slice(z-1,z+2))[1][2]=N(g),L.push(g),b.push(g);for(z=0,M=L.length;z<M;++z)(g=L[z]).previous=L[z-1],g.next=L[z+1];for(;g=b.pop();){var j=g.previous,A=g.next;g[1][2]<k?g[1][2]=k:k=g[1][2],j&&(j.next=A,j[2]=g[2],W(j)),A&&(A.previous=j,A[0]=g[0],W(A))}T.forEach(G)}),F}};function It(F,N){var x={},G={},b={},W=[],T=-1;function k(g,z){for(var M in g){var P=g[M];delete z[P.start],delete P.start,delete P.end,P.forEach(function(j){x[j<0?~j:j]=1}),W.push(P)}}return N.forEach(function(g,z){var P,M=F.arcs[g<0?~g:g];M.length<3&&!M[1][0]&&!M[1][1]&&(P=N[++T],N[T]=g,N[z]=P)}),N.forEach(function(g){var j,A,z=function(g){var P,z=F.arcs[g<0?~g:g],M=z[0];return F.transform?(P=[0,0],z.forEach(function(j){P[0]+=j[0],P[1]+=j[1]})):P=z[z.length-1],g<0?[P,M]:[M,P]}(g),M=z[0],P=z[1];if(j=b[M])if(delete b[j.end],j.push(g),j.end=P,A=G[P]){delete G[A.start];var H=A===j?j:j.concat(A);G[H.start=j.start]=b[H.end=A.end]=H}else G[j.start]=b[j.end]=j;else if(j=G[P])if(delete G[j.start],j.unshift(g),j.start=M,A=b[M]){delete b[A.end];var V=A===j?j:A.concat(j);G[V.start=A.start]=b[V.end=j.end]=V}else G[j.start]=b[j.end]=j;else G[(j=[g]).start=M]=b[j.end=P]=j}),k(b,G),k(G,b),N.forEach(function(g){x[g<0?~g:g]||W.push([g])}),W}function Bt(F,N,x){var G=[];if(arguments.length>1){var g,b=function(A){var H=A<0?~A:A;(k[H]||(k[H]=[])).push({i:A,g})},W=function(A){A.forEach(b)},T=function(A){A.forEach(W)},k=[],z={LineString:W,MultiLineString:T,Polygon:T,MultiPolygon:function(A){A.forEach(T)}};(function j(A){"GeometryCollection"===A.type?A.geometries.forEach(j):A.type in z&&(g=A,z[A.type](A.arcs))})(N),k.forEach(arguments.length<3?function(j){G.push(j[0].i)}:function(j){x(j[0].g,j[j.length-1].g)&&G.push(j[0].i)})}else for(var M=0,P=F.arcs.length;M<P;++M)G.push(M);return{type:"MultiLineString",arcs:It(F,G)}}function Kt(F,N){var x={},G=[],b=[];function W(L){L.forEach(function(k){k.forEach(function(g){(x[g=g<0?~g:g]||(x[g]=[])).push(L)})}),G.push(L)}function T(L){return function(F){for(var G,N=-1,x=F.length,b=F[x-1],W=0;++N<x;)W+=(G=b)[0]*(b=F[N])[1]-G[1]*b[0];return.5*W}(ft(F,{type:"Polygon",arcs:[L]}).coordinates[0])>0}return N.forEach(function(L){"Polygon"===L.type?W(L.arcs):"MultiPolygon"===L.type&&L.arcs.forEach(W)}),G.forEach(function(L){if(!L._){var k=[],g=[L];for(L._=1,b.push(k);L=g.pop();)k.push(L),L.forEach(function(z){z.forEach(function(M){x[M<0?~M:M].forEach(function(P){P._||(P._=1,g.push(P))})})})}}),G.forEach(function(L){delete L._}),{type:"MultiPolygon",arcs:b.map(function(L){var k=[];if(L.forEach(function(P){P.forEach(function(j){j.forEach(function(A){x[A<0?~A:A].length<2&&k.push(A)})})}),k=It(F,k),(n=k.length)>1)for(var M,g=T(L[0][0]),z=0;z<n;++z)if(g===T(k[z])){M=k[0],k[0]=k[z],k[z]=M;break}return k})}}function Ct(F,N){var x={type:"Feature",id:N.id,properties:N.properties||{},geometry:ft(F,N)};return null==N.id&&delete x.id,x}function ft(F,N){var x=Pn(F.transform),G=F.arcs;function b(M,P){P.length&&P.pop();for(var V,j=G[M<0?~M:M],A=0,H=j.length;A<H;++A)P.push(V=j[A].slice()),x(V,A);M<0&&function(F,N){for(var x,G=F.length,b=G-N;b<--G;)x=F[b],F[b++]=F[G],F[G]=x}(P,H)}function W(M){return M=M.slice(),x(M,0),M}function T(M){for(var P=[],j=0,A=M.length;j<A;++j)b(M[j],P);return P.length<2&&P.push(P[0].slice()),P}function L(M){for(var P=T(M);P.length<4;)P.push(P[0].slice());return P}function k(M){return M.map(L)}var z={Point:function(P){return W(P.coordinates)},MultiPoint:function(P){return P.coordinates.map(W)},LineString:function(P){return T(P.arcs)},MultiLineString:function(P){return P.arcs.map(T)},Polygon:function(P){return k(P.arcs)},MultiPolygon:function(P){return P.arcs.map(k)}};return function g(M){var P=M.type;return"GeometryCollection"===P?{type:P,geometries:M.geometries.map(g)}:P in z?{type:P,coordinates:z[P](M)}:null}(N)}function ct(F,N){for(var x=0,G=F.length;x<G;){var b=x+G>>>1;F[b]<N?x=b+1:G=b}return x}function Gt(F){var N=F[0],x=F[1],G=F[2];return Math.abs((N[0]-G[0])*(x[1]-N[1])-(N[0]-x[0])*(G[1]-N[1]))}function E(F,N){return F[1][2]-N[1][2]}function Pn(F){if(!F)return et;var N,x,G=F.scale[0],b=F.scale[1],W=F.translate[0],T=F.translate[1];return function(L,k){k||(N=x=0),L[0]=(N+=L[0])*G+W,L[1]=(x+=L[1])*b+T}}function et(){}void 0!==(Ut="function"==typeof(wt=tn)?wt.call(_t,q,_t,En):wt)&&(En.exports=Ut)}()},78825:function(En,_t,q){"use strict";q.r(_t),q.d(_t,{Matcher:function(){return dr},ShapeMap:function(){return Ao},ShapeMapBehavior:function(){return Do}});var wt=q(22921),Ut=q(32554),tn=q(90120),It=q(60066),Bt=q(54522),Kt=q(52083),Xt=q(28579),Ct=q(51129),ft=q(79811),Nt=q(65741),ct=q(86727),ht=q(77686),Lt=q(72902),Dt=q(40739),Gt=q(11305),E=q(22091),pt=q(20792),Pn=q(45296),ie=q(62458),et=q(56578),F=q(38958),N=q(82755),x=q(26543),G=q(52967),b=q(15841);function W(){return new T}function T(){this.reset()}T.prototype={constructor:T,reset:function(){this.s=this.t=0},add:function(t){k(L,t,this.t),k(this,L.s,this.s),this.s?this.t+=L.t:this.s=L.t},valueOf:function(){return this.s}};var L=new T;function k(e,t,r){var i=e.s=t+r,o=i-t;e.t=t-(i-o)+(r-o)}var g=1e-6,z=1e-12,M=Math.PI,P=M/2,j=M/4,A=2*M,H=180/M,V=M/180,K=Math.abs,zt=Math.atan,At=Math.atan2,U=Math.cos,_e=(Math,Math.exp),Ue=(Math,Math.log),B=(Math,Math.sin),gr=Math.sign||function(e){return e>0?1:e<0?-1:0},vt=Math.sqrt,Xe=Math.tan;function ke(e){return e>1?0:e<-1?M:Math.acos(e)}function Mt(e){return e>1?P:e<-1?-P:Math.asin(e)}function it(){}function Cn(e,t){e&&He.hasOwnProperty(e.type)&&He[e.type](e,t)}var Ye={Feature:function(t,r){Cn(t.geometry,r)},FeatureCollection:function(t,r){for(var i=t.features,o=-1,a=i.length;++o<a;)Cn(i[o].geometry,r)}},He={Sphere:function(t,r){r.sphere()},Point:function(t,r){r.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,r){for(var i=t.coordinates,o=-1,a=i.length;++o<a;)r.point((t=i[o])[0],t[1],t[2])},LineString:function(t,r){re(t.coordinates,r,0)},MultiLineString:function(t,r){for(var i=t.coordinates,o=-1,a=i.length;++o<a;)re(i[o],r,0)},Polygon:function(t,r){Ie(t.coordinates,r)},MultiPolygon:function(t,r){for(var i=t.coordinates,o=-1,a=i.length;++o<a;)Ie(i[o],r)},GeometryCollection:function(t,r){for(var i=t.geometries,o=-1,a=i.length;++o<a;)Cn(i[o],r)}};function re(e,t,r){var a,i=-1,o=e.length-r;for(t.lineStart();++i<o;)t.point((a=e[i])[0],a[1],a[2]);t.lineEnd()}function Ie(e,t){var r=-1,i=e.length;for(t.polygonStart();++r<i;)re(e[r],t,1);t.polygonEnd()}function kt(e,t){e&&Ye.hasOwnProperty(e.type)?Ye[e.type](e,t):Cn(e,t)}function jn(e){return[At(e[1],e[0]),Mt(e[2])]}function qt(e){var t=e[0],r=e[1],i=U(r);return[i*U(t),i*B(t),B(r)]}function Ln(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nn(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function le(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function An(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Rn(e){var t=vt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}W(),W(),W();var sn,Fn,Zn,zn,Vn,xn,Tn,Bn,ce,fe,he,oi,ai,mt,St,yt,Rt={sphere:it,point:pe,lineStart:ui,lineEnd:li,polygonStart:function(){Rt.lineStart=Nr,Rt.lineEnd=Dr},polygonEnd:function(){Rt.lineStart=ui,Rt.lineEnd=li}};function pe(e,t){e*=V;var r=U(t*=V);cn(r*U(e),r*B(e),B(t))}function cn(e,t,r){++sn,Zn+=(e-Zn)/sn,zn+=(t-zn)/sn,Vn+=(r-Vn)/sn}function ui(){Rt.point=Pr}function Pr(e,t){e*=V;var r=U(t*=V);mt=r*U(e),St=r*B(e),yt=B(t),Rt.point=Cr,cn(mt,St,yt)}function Cr(e,t){e*=V;var r=U(t*=V),i=r*U(e),o=r*B(e),a=B(t),u=At(vt((u=St*a-yt*o)*u+(u=yt*i-mt*a)*u+(u=mt*o-St*i)*u),mt*i+St*o+yt*a);Fn+=u,xn+=u*(mt+(mt=i)),Tn+=u*(St+(St=o)),Bn+=u*(yt+(yt=a)),cn(mt,St,yt)}function li(){Rt.point=pe}function Nr(){Rt.point=jr}function Dr(){si(oi,ai),Rt.point=pe}function jr(e,t){oi=e,ai=t,e*=V,t*=V,Rt.point=si;var r=U(t);mt=r*U(e),St=r*B(e),yt=B(t),cn(mt,St,yt)}function si(e,t){e*=V;var r=U(t*=V),i=r*U(e),o=r*B(e),a=B(t),u=St*a-yt*o,s=yt*i-mt*a,c=mt*o-St*i,p=vt(u*u+s*s+c*c),l=Mt(p),h=p&&-l/p;ce+=h*u,fe+=h*s,he+=h*c,Fn+=l,xn+=l*(mt+(mt=i)),Tn+=l*(St+(St=o)),Bn+=l*(yt+(yt=a)),cn(mt,St,yt)}function ve(e,t){function r(i,o){return i=e(i,o),t(i[0],i[1])}return e.invert&&t.invert&&(r.invert=function(i,o){return(i=t.invert(i,o))&&e.invert(i[0],i[1])}),r}function de(e,t){return[e>M?e-A:e<-M?e+A:e,t]}function ci(e,t,r){return(e%=A)?t||r?ve(hi(e),pi(t,r)):hi(e):t||r?pi(t,r):de}function fi(e){return function(t,r){return[(t+=e)>M?t-A:t<-M?t+A:t,r]}}function hi(e){var t=fi(e);return t.invert=fi(-e),t}function pi(e,t){var r=U(e),i=B(e),o=U(t),a=B(t);function u(s,c){var p=U(c),l=U(s)*p,h=B(s)*p,f=B(c),v=f*r+l*i;return[At(h*o-v*a,l*r-f*i),Mt(v*o+h*a)]}return u.invert=function(s,c){var p=U(c),l=U(s)*p,h=B(s)*p,f=B(c),v=f*o-h*a;return[At(h*o+f*a,l*r+v*i),Mt(v*r-l*i)]},u}function di(e,t){(t=qt(t))[0]-=e,Rn(t);var r=ke(-t[1]);return((-t[2]<0?-r:r)+A-g)%A}function gi(){var t,e=[];return{point:function(i,o){t.push([i,o])},lineStart:function(){e.push(t=[])},lineEnd:it,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function Gn(e,t){return K(e[0]-t[0])<g&&K(e[1]-t[1])<g}function On(e,t,r,i){this.x=e,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function mi(e,t,r,i,o){var s,c,a=[],u=[];if(e.forEach(function(d){if(!((w=d.length-1)<=0)){var w,Z,y=d[0],C=d[w];if(Gn(y,C)){for(o.lineStart(),s=0;s<w;++s)o.point((y=d[s])[0],y[1]);return void o.lineEnd()}a.push(Z=new On(y,d,null,!0)),u.push(Z.o=new On(y,null,Z,!1)),a.push(Z=new On(C,d,null,!1)),u.push(Z.o=new On(C,null,Z,!0))}}),a.length){for(u.sort(t),Si(a),Si(u),s=0,c=u.length;s<c;++s)u[s].e=r=!r;for(var l,h,p=a[0];;){for(var f=p,v=!0;f.v;)if((f=f.n)===p)return;l=f.z,o.lineStart();do{if(f.v=f.o.v=!0,f.e){if(v)for(s=0,c=l.length;s<c;++s)o.point((h=l[s])[0],h[1]);else i(f.x,f.n.x,1,o);f=f.n}else{if(v)for(s=(l=f.p.z).length-1;s>=0;--s)o.point((h=l[s])[0],h[1]);else i(f.x,f.p.x,-1,o);f=f.p}l=(f=f.o).z,v=!v}while(!f.v);o.lineEnd()}}}function Si(e){if(t=e.length){for(var t,o,r=0,i=e[0];++r<t;)i.n=o=e[r],o.p=i,i=o;i.n=o=e[0],o.p=i}}de.invert=de;var e,ge=W();function Mi(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Pi(e){for(var r,a,u,t=e.length,i=-1,o=0;++i<t;)o+=e[i].length;for(a=new Array(o);--t>=0;)for(r=(u=e[t]).length;--r>=0;)a[--o]=u[r];return a}function Ci(e,t,r,i){return function(o){var p,l,h,a=t(o),u=gi(),s=t(u),c=!1,f={point:v,lineStart:w,lineEnd:y,polygonStart:function(){f.point=C,f.lineStart=Z,f.lineEnd=S,l=[],p=[]},polygonEnd:function(){f.point=v,f.lineStart=w,f.lineEnd=y,l=Pi(l);var D=function(e,t){var r=t[0],i=t[1],o=B(i),a=[B(r),-U(r),0],u=0,s=0;ge.reset(),1===o?i=P+g:-1===o&&(i=-P-g);for(var c=0,p=e.length;c<p;++c)if(h=(l=e[c]).length)for(var l,h,f=l[h-1],v=f[0],d=f[1]/2+j,w=B(d),y=U(d),C=0;C<h;++C,v=S,w=D,y=Y,f=Z){var Z=l[C],S=Z[0],m=Z[1]/2+j,D=B(m),Y=U(m),X=S-v,Q=X>=0?1:-1,O=Q*X,nt=O>M,$=w*D;if(ge.add(At($*Q*B(O),y*Y+$*U(O))),u+=nt?X+Q*A:X,nt^v>=r^S>=r){var rt=nn(qt(f),qt(Z));Rn(rt);var R=nn(a,rt);Rn(R);var I=(nt^X>=0?-1:1)*Mt(R[2]);(i>I||i===I&&(rt[0]||rt[1]))&&(s+=nt^X>=0?1:-1)}}return(u<-g||u<g&&ge<-g)^1&s}(p,i);l.length?(c||(o.polygonStart(),c=!0),mi(l,Vr,D,r,o)):D&&(c||(o.polygonStart(),c=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),c&&(o.polygonEnd(),c=!1),l=p=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function v(m,D){e(m,D)&&o.point(m,D)}function d(m,D){a.point(m,D)}function w(){f.point=d,a.lineStart()}function y(){f.point=v,a.lineEnd()}function C(m,D){h.push([m,D]),s.point(m,D)}function Z(){s.lineStart(),h=[]}function S(){C(h[0][0],h[0][1]),s.lineEnd();var Y,Q,O,nt,m=s.clean(),D=u.result(),X=D.length;if(h.pop(),p.push(h),h=null,X){if(1&m){if((Q=(O=D[0]).length-1)>0){for(c||(o.polygonStart(),c=!0),o.lineStart(),Y=0;Y<Q;++Y)o.point((nt=O[Y])[0],nt[1]);o.lineEnd()}return}X>1&&2&m&&D.push(D.pop().concat(D.shift())),l.push(D.filter(zr))}}return f}}function zr(e){return e.length>1}function Vr(e,t){return((e=e.x)[0]<0?e[1]-P-g:P-e[1])-((t=t.x)[0]<0?t[1]-P-g:P-t[1])}1===(e=Mi).length&&(e=function(e){return function(t,r){return Mi(e(t),r)}}(e)),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Ni=Ci(function(){return!0},function(e){var o,t=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),o=1},point:function(u,s){var c=u>0?M:-M,p=K(u-t);K(p-M)<g?(e.point(t,r=(r+s)/2>0?P:-P),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(c,r),e.point(u,r),o=0):i!==c&&p>=M&&(K(t-i)<g&&(t-=i*g),K(u-c)<g&&(u-=c*g),r=function(e,t,r,i){var o,a,u=B(e-r);return K(u)>g?zt((B(t)*(a=U(i))*B(r)-B(i)*(o=U(t))*B(e))/(o*a*u)):(t+i)/2}(t,r,u,s),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(c,r),o=0),e.point(t=u,r=s),i=c},lineEnd:function(){e.lineEnd(),t=r=NaN},clean:function(){return 2-o}}},function(e,t,r,i){var o;if(null==e)i.point(-M,o=r*P),i.point(0,o),i.point(M,o),i.point(M,0),i.point(M,-o),i.point(0,-o),i.point(-M,-o),i.point(-M,0),i.point(-M,o);else if(K(e[0]-t[0])>g){var a=e[0]<t[0]?M:-M;i.point(-a,o=r*a/2),i.point(0,o),i.point(a,o)}else i.point(t[0],t[1])},[-M,-P]),fn=1e9,Wn=-fn;function Pe(e){return e}W();var Vi,xi,De,je,Ce=W(),Ne=W(),Ht={point:it,lineStart:it,lineEnd:it,polygonStart:function(){Ht.lineStart=Kr,Ht.lineEnd=Qr},polygonEnd:function(){Ht.lineStart=Ht.lineEnd=Ht.point=it,Ce.add(K(Ne)),Ne.reset()},result:function(){var t=Ce/2;return Ce.reset(),t}};function Kr(){Ht.point=qr}function qr(e,t){Ht.point=Ti,Vi=De=e,xi=je=t}function Ti(e,t){Ne.add(je*e-De*t),De=e,je=t}function Qr(){Ti(Vi,xi)}var Gi,Oi,xt,Tt,Bi=Ht,on=1/0,kn=on,hn=-on,Yn=hn,Jr={point:function(e,t){e<on&&(on=e),e>hn&&(hn=e),t<kn&&(kn=t),t>Yn&&(Yn=t)},lineStart:it,lineEnd:it,polygonStart:it,polygonEnd:it,result:function(){var t=[[on,kn],[hn,Yn]];return hn=Yn=-(kn=on=1/0),t}},Hn=Jr,Le=0,Ae=0,pn=0,In=0,Kn=0,an=0,Re=0,Fe=0,vn=0,Ft={point:Jt,lineStart:Wi,lineEnd:bi,polygonStart:function(){Ft.lineStart=eo,Ft.lineEnd=io},polygonEnd:function(){Ft.point=Jt,Ft.lineStart=Wi,Ft.lineEnd=bi},result:function(){var t=vn?[Re/vn,Fe/vn]:an?[In/an,Kn/an]:pn?[Le/pn,Ae/pn]:[NaN,NaN];return Le=Ae=pn=In=Kn=an=Re=Fe=vn=0,t}};function Jt(e,t){Le+=e,Ae+=t,++pn}function Wi(){Ft.point=to}function to(e,t){Ft.point=no,Jt(xt=e,Tt=t)}function no(e,t){var r=e-xt,i=t-Tt,o=vt(r*r+i*i);In+=o*(xt+e)/2,Kn+=o*(Tt+t)/2,an+=o,Jt(xt=e,Tt=t)}function bi(){Ft.point=Jt}function eo(){Ft.point=ro}function io(){_i(Gi,Oi)}function ro(e,t){Ft.point=_i,Jt(Gi=xt=e,Oi=Tt=t)}function _i(e,t){var r=e-xt,i=t-Tt,o=vt(r*r+i*i);In+=o*(xt+e)/2,Kn+=o*(Tt+t)/2,an+=o,Re+=(o=Tt*e-xt*t)*(xt+e),Fe+=o*(Tt+t),vn+=3*o,Jt(xt=e,Tt=t)}var Ui=Ft;function Xi(e){this._context=e}Xi.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,r){switch(this._point){case 0:this._context.moveTo(t,r),this._point=1;break;case 1:this._context.lineTo(t,r);break;default:this._context.moveTo(t+this._radius,r),this._context.arc(t,r,this._radius,0,A)}},result:it};var ze,ki,Yi,dn,gn,Ze=W(),qn={point:it,lineStart:function(){qn.point=oo},lineEnd:function(){ze&&Hi(ki,Yi),qn.point=it},polygonStart:function(){ze=!0},polygonEnd:function(){ze=null},result:function(){var t=+Ze;return Ze.reset(),t}};function oo(e,t){qn.point=Hi,ki=dn=e,Yi=gn=t}function Hi(e,t){Ze.add(vt((dn-=e)*dn+(gn-=t)*gn)),dn=e,gn=t}var Ii=qn;function Ki(){this._string=[]}function qi(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Ve(e,t){var i,o,r=4.5;function a(u){return u&&("function"==typeof r&&o.pointRadius(+r.apply(this,arguments)),kt(u,i(o))),o.result()}return a.area=function(u){return kt(u,i(Bi)),Bi.result()},a.measure=function(u){return kt(u,i(Ii)),Ii.result()},a.bounds=function(u){return kt(u,i(Hn)),Hn.result()},a.centroid=function(u){return kt(u,i(Ui)),Ui.result()},a.projection=function(u){return arguments.length?(i=null==u?(e=null,Pe):(e=u).stream,a):e},a.context=function(u){return arguments.length?(o=null==u?(t=null,new Ki):new Xi(t=u),"function"!=typeof r&&o.pointRadius(r),a):t},a.pointRadius=function(u){return arguments.length?(r="function"==typeof u?u:(o.pointRadius(+u),+u),a):r},a.projection(e).context(t)}function Qn(e){return function(t){var r=new xe;for(var i in e)r[i]=e[i];return r.stream=t,r}}function xe(){}function Te(e,t,r){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),kt(r,e.stream(Hn)),t(Hn.result()),null!=i&&e.clipExtent(i),e}function Be(e,t,r){return Te(e,function(i){var o=t[1][0]-t[0][0],a=t[1][1]-t[0][1],u=Math.min(o/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),s=+t[0][0]+(o-u*(i[1][0]+i[0][0]))/2,c=+t[0][1]+(a-u*(i[1][1]+i[0][1]))/2;e.scale(150*u).translate([s,c])},r)}function Qi(e,t,r){return Be(e,[[0,0],t],r)}function Ji(e,t,r){return Te(e,function(i){var o=+t,a=o/(i[1][0]-i[0][0]),u=(o-a*(i[1][0]+i[0][0]))/2,s=-a*i[0][1];e.scale(150*a).translate([u,s])},r)}function $i(e,t,r){return Te(e,function(i){var o=+t,a=o/(i[1][1]-i[0][1]),u=-a*i[0][0],s=(o-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([u,s])},r)}Ki.prototype={_radius:4.5,_circle:qi(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,r){switch(this._point){case 0:this._string.push("M",t,",",r),this._point=1;break;case 1:this._string.push("L",t,",",r);break;default:null==this._circle&&(this._circle=qi(this._radius)),this._string.push("M",t,",",r,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},xe.prototype={constructor:xe,point:function(t,r){this.stream.point(t,r)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var tr=16,ao=U(30*V);function nr(e,t){return+t?function(e,t){function r(i,o,a,u,s,c,p,l,h,f,v,d,w,y){var C=p-i,Z=l-o,S=C*C+Z*Z;if(S>4*t&&w--){var m=u+f,D=s+v,Y=c+d,X=vt(m*m+D*D+Y*Y),Q=Mt(Y/=X),O=K(K(Y)-1)<g||K(a-h)<g?(a+h)/2:At(D,m),nt=e(O,Q),$=nt[0],rt=nt[1],R=$-i,I=rt-o,J=Z*R-C*I;(J*J/S>t||K((C*R+Z*I)/S-.5)>.3||u*f+s*v+c*d<ao)&&(r(i,o,a,u,s,c,$,rt,O,m/=X,D/=X,Y,w,y),y.point($,rt),r($,rt,O,m,D,Y,p,l,h,f,v,d,w,y))}}return function(i){var o,a,u,s,c,p,l,h,f,v,d,w,y={point:C,lineStart:Z,lineEnd:m,polygonStart:function(){i.polygonStart(),y.lineStart=D},polygonEnd:function(){i.polygonEnd(),y.lineStart=Z}};function C(Q,O){Q=e(Q,O),i.point(Q[0],Q[1])}function Z(){h=NaN,y.point=S,i.lineStart()}function S(Q,O){var nt=qt([Q,O]),$=e(Q,O);r(h,f,l,v,d,w,h=$[0],f=$[1],l=Q,v=nt[0],d=nt[1],w=nt[2],tr,i),i.point(h,f)}function m(){y.point=C,i.lineEnd()}function D(){Z(),y.point=Y,y.lineEnd=X}function Y(Q,O){S(o=Q,O),a=h,u=f,s=v,c=d,p=w,y.point=S}function X(){r(h,f,l,v,d,w,a,u,o,s,c,p,tr,i),y.lineEnd=m,m()}return y}}(e,t):function(e){return Qn({point:function(r,i){r=e(r,i),this.stream.point(r[0],r[1])}})}(e)}var so=Qn({point:function(t,r){this.stream.point(t*V,r*V)}});function fo(e,t,r){function i(o,a){return[t+e*o,r-e*a]}return i.invert=function(o,a){return[(o-t)/e,(r-a)/e]},i}function er(e,t,r,i){var o=U(i),a=B(i),u=o*e,s=a*e,c=o/e,p=a/e,l=(a*r-o*t)/e,h=(a*t+o*r)/e;function f(v,d){return[u*v-s*d+t,r-s*v-u*d]}return f.invert=function(v,d){return[c*v-p*d+l,h-p*v-c*d]},f}function Ge(e){return ir(function(){return e})()}function ir(e){var t,l,w,y,C,m,D,Y,X,Q,r=150,i=480,o=250,a=0,u=0,s=0,c=0,p=0,h=0,f=null,v=Ni,d=null,Z=Pe,S=.5;function O(R){return Y(R[0]*V,R[1]*V)}function nt(R){return(R=Y.invert(R[0],R[1]))&&[R[0]*H,R[1]*H]}function $(){var R=er(r,0,0,h).apply(null,t(a,u)),I=(h?er:fo)(r,i-R[0],o-R[1],h);return l=ci(s,c,p),D=ve(t,I),Y=ve(l,D),m=nr(D,S),rt()}function rt(){return X=Q=null,O}return O.stream=function(R){return X&&Q===R?X:X=so(function(e){return Qn({point:function(r,i){var o=e(r,i);return this.stream.point(o[0],o[1])}})}(l)(v(m(Z(Q=R)))))},O.preclip=function(R){return arguments.length?(v=R,f=void 0,rt()):v},O.postclip=function(R){return arguments.length?(Z=R,d=w=y=C=null,rt()):Z},O.clipAngle=function(R){return arguments.length?(v=+R?function(e){var t=U(e),r=6*V,i=t>0,o=K(t)>g;function u(l,h){return U(l)*U(h)>t}function c(l,h,f){var w=[1,0,0],y=nn(qt(l),qt(h)),C=Ln(y,y),Z=y[0],S=C-Z*Z;if(!S)return!f&&l;var m=t*C/S,D=-t*Z/S,Y=nn(w,y),X=An(w,m);le(X,An(y,D));var O=Y,nt=Ln(X,O),$=Ln(O,O),rt=nt*nt-$*(Ln(X,X)-1);if(!(rt<0)){var R=vt(rt),I=An(O,(-nt-R)/$);if(le(I,X),I=jn(I),!f)return I;var gt,J=l[0],tt=h[0],ut=l[1],lt=h[1];tt<J&&(gt=J,J=tt,tt=gt);var Zt=tt-J,st=K(Zt-M)<g;if(!st&&lt<ut&&(gt=ut,ut=lt,lt=gt),st||Zt<g?st?ut+lt>0^I[1]<(K(I[0]-J)<g?ut:lt):ut<=I[1]&&I[1]<=lt:Zt>M^(J<=I[0]&&I[0]<=tt)){var bt=An(O,(-nt+R)/$);return le(bt,X),[I,jn(bt)]}}}function p(l,h){var f=i?e:M-e,v=0;return l<-f?v|=1:l>f&&(v|=2),h<-f?v|=4:h>f&&(v|=8),v}return Ci(u,function(l){var h,f,v,d,w;return{lineStart:function(){d=v=!1,w=1},point:function(C,Z){var m,S=[C,Z],D=u(C,Z),Y=i?D?0:p(C,Z):D?p(C+(C<0?M:-M),Z):0;if(!h&&(d=v=D)&&l.lineStart(),D!==v&&(!(m=c(h,S))||Gn(h,m)||Gn(S,m))&&(S[0]+=g,S[1]+=g,D=u(S[0],S[1])),D!==v)w=0,D?(l.lineStart(),m=c(S,h),l.point(m[0],m[1])):(m=c(h,S),l.point(m[0],m[1]),l.lineEnd()),h=m;else if(o&&h&&i^D){var X;!(Y&f)&&(X=c(S,h,!0))&&(w=0,i?(l.lineStart(),l.point(X[0][0],X[0][1]),l.point(X[1][0],X[1][1]),l.lineEnd()):(l.point(X[1][0],X[1][1]),l.lineEnd(),l.lineStart(),l.point(X[0][0],X[0][1])))}D&&(!h||!Gn(h,S))&&l.point(S[0],S[1]),h=S,v=D,f=Y},lineEnd:function(){v&&l.lineEnd(),h=null},clean:function(){return w|(d&&v)<<1}}},function(l,h,f,v){!function(e,t,r,i,o,a){if(r){var u=U(t),s=B(t),c=i*r;null==o?(o=t+i*A,a=t-c/2):(o=di(u,o),a=di(u,a),(i>0?o<a:o>a)&&(o+=i*A));for(var p,l=o;i>0?l>a:l<a;l-=c)p=jn([u,-s*U(l),-s*B(l)]),e.point(p[0],p[1])}}(v,e,r,f,l,h)},i?[0,-e]:[-M,e-M])}(f=R*V):(f=null,Ni),rt()):f*H},O.clipExtent=function(R){return arguments.length?(Z=null==R?(d=w=y=C=null,Pe):function(e,t,r,i){function o(p,l){return e<=p&&p<=r&&t<=l&&l<=i}function a(p,l,h,f){var v=0,d=0;if(null==p||(v=u(p,h))!==(d=u(l,h))||c(p,l)<0^h>0)do{f.point(0===v||3===v?e:r,v>1?i:t)}while((v=(v+h+4)%4)!==d);else f.point(l[0],l[1])}function u(p,l){return K(p[0]-e)<g?l>0?0:3:K(p[0]-r)<g?l>0?2:1:K(p[1]-t)<g?l>0?1:0:l>0?3:2}function s(p,l){return c(p.x,l.x)}function c(p,l){var h=u(p,1),f=u(l,1);return h!==f?h-f:0===h?l[1]-p[1]:1===h?p[0]-l[0]:2===h?p[1]-l[1]:l[0]-p[0]}return function(p){var f,v,d,w,y,C,Z,S,m,D,Y,l=p,h=gi(),X={point:Q,lineStart:function(){X.point=I,v&&v.push(d=[]),D=!0,m=!1,Z=S=NaN},lineEnd:function(){f&&(I(w,y),C&&m&&h.rejoin(),f.push(h.result())),X.point=Q,m&&l.lineEnd()},polygonStart:function(){l=h,f=[],v=[],Y=!0},polygonEnd:function(){var J=function(){for(var J=0,tt=0,ut=v.length;tt<ut;++tt)for(var $t,bt,lt=v[tt],gt=1,Zt=lt.length,st=lt[0],ee=st[0],un=st[1];gt<Zt;++gt)$t=ee,bt=un,ee=(st=lt[gt])[0],un=st[1],bt<=i?un>i&&(ee-$t)*(i-bt)>(un-bt)*(e-$t)&&++J:un<=i&&(ee-$t)*(i-bt)<(un-bt)*(e-$t)&&--J;return J}(),tt=Y&&J,ut=(f=Pi(f)).length;(tt||ut)&&(p.polygonStart(),tt&&(p.lineStart(),a(null,null,1,p),p.lineEnd()),ut&&mi(f,s,J,a,p),p.polygonEnd()),l=p,f=v=d=null}};function Q(J,tt){o(J,tt)&&l.point(J,tt)}function I(J,tt){var ut=o(J,tt);if(v&&d.push([J,tt]),D)w=J,y=tt,C=ut,D=!1,ut&&(l.lineStart(),l.point(J,tt));else if(ut&&m)l.point(J,tt);else{var lt=[Z=Math.max(Wn,Math.min(fn,Z)),S=Math.max(Wn,Math.min(fn,S))],gt=[J=Math.max(Wn,Math.min(fn,J)),tt=Math.max(Wn,Math.min(fn,tt))];!function(e,t,r,i,o,a){var d,u=e[0],s=e[1],l=0,h=1,f=t[0]-u,v=t[1]-s;if(d=r-u,f||!(d>0)){if(d/=f,f<0){if(d<l)return;d<h&&(h=d)}else if(f>0){if(d>h)return;d>l&&(l=d)}if(d=o-u,f||!(d<0)){if(d/=f,f<0){if(d>h)return;d>l&&(l=d)}else if(f>0){if(d<l)return;d<h&&(h=d)}if(d=i-s,v||!(d>0)){if(d/=v,v<0){if(d<l)return;d<h&&(h=d)}else if(v>0){if(d>h)return;d>l&&(l=d)}if(d=a-s,v||!(d<0)){if(d/=v,v<0){if(d>h)return;d>l&&(l=d)}else if(v>0){if(d<l)return;d<h&&(h=d)}return l>0&&(e[0]=u+l*f,e[1]=s+l*v),h<1&&(t[0]=u+h*f,t[1]=s+h*v),!0}}}}}(lt,gt,e,t,r,i)?ut&&(l.lineStart(),l.point(J,tt),Y=!1):(m||(l.lineStart(),l.point(lt[0],lt[1])),l.point(gt[0],gt[1]),ut||l.lineEnd(),Y=!1)}Z=J,S=tt,m=ut}return X}}(d=+R[0][0],w=+R[0][1],y=+R[1][0],C=+R[1][1]),rt()):null==d?null:[[d,w],[y,C]]},O.scale=function(R){return arguments.length?(r=+R,$()):r},O.translate=function(R){return arguments.length?(i=+R[0],o=+R[1],$()):[i,o]},O.center=function(R){return arguments.length?(a=R[0]%360*V,u=R[1]%360*V,$()):[a*H,u*H]},O.rotate=function(R){return arguments.length?(s=R[0]%360*V,c=R[1]%360*V,p=R.length>2?R[2]%360*V:0,$()):[s*H,c*H,p*H]},O.angle=function(R){return arguments.length?(h=R%360*V,$()):h*H},O.precision=function(R){return arguments.length?(m=nr(D,S=R*R),rt()):vt(S)},O.fitExtent=function(R,I){return Be(O,R,I)},O.fitSize=function(R,I){return Qi(O,R,I)},O.fitWidth=function(R,I){return Ji(O,R,I)},O.fitHeight=function(R,I){return $i(O,R,I)},function(){return t=e.apply(this,arguments),O.invert=t.invert&&nt,$()}}function vo(e,t){var r=B(e),i=(r+B(t))/2;if(K(i)<g)return function(e){var t=U(e);function r(i,o){return[i*t,B(o)/t]}return r.invert=function(i,o){return[i/t,Mt(o*t)]},r}(e);var o=1+r*(2*i-r),a=vt(o)/i;function u(s,c){var p=vt(o-2*i*B(c))/i;return[p*B(s*=i),a-p*U(s)]}return u.invert=function(s,c){var p=a-c;return[At(s,K(p))/i*gr(p),Mt((o-(s*s+p*p)*i*i)/(2*i))]},u}function Oe(){return function(e){var t=0,r=M/3,i=ir(e),o=i(t,r);return o.parallels=function(a){return arguments.length?i(t=a[0]*V,r=a[1]*V):[t*H,r*H]},o}(vo).scale(155.424).center([0,33.6442])}function rr(e){return function(t,r){var i=U(t),o=U(r),a=e(i*o);return[a*o*B(t),a*B(r)]}}function mn(e){return function(t,r){var i=vt(t*t+r*r),o=e(i),a=B(o),u=U(o);return[At(t*a,i*u),Mt(i&&r*a/i)]}}var or=rr(function(e){return vt(2/(1+e))});or.invert=mn(function(e){return 2*Mt(e/2)});var ar=rr(function(e){return(e=ke(e))&&e/B(e)});function We(e,t){return[e,Ue(Xe((P+t)/2))]}function be(e,t){return[e,t]}ar.invert=mn(function(e){return e}),We.invert=function(e,t){return[e,2*zt(_e(t))-P]},be.invert=be;vt(3);function cr(e,t){return[U(t)*B(e),B(t)]}function fr(){return Ge(cr).scale(249.5).clipAngle(90+g)}mn(zt),cr.invert=mn(Mt),mn(function(e){return 2*zt(e)});var dt,No=q(43174),Do=b.ShapeMapBehavior,vr=((dt={})[pt.fC]={projections:[E.Lu,E.hD,E.s6]},dt[pt.M4]={projections:[E.Lu,E.hD,E.s6]},dt[pt.p8]={projections:[E.s6,E.hD,E.Lu]},dt[pt.S9]={projections:[E.s6,E.hD,E.Lu]},dt[pt.G]={projections:[E.s6,E.hD,E.Lu]},dt[pt.r5]={projections:[E.s6,E.hD,E.Lu]},dt[pt.Bo]={projections:[E.s6,E.hD,E.Lu]},dt[pt.S$]={projections:[E.s6,E.hD,E.Lu]},dt[pt.sp]={projections:[E.s6,E.hD,E.Lu]},dt[pt.Ss]={projections:[E.Lu,E.hD,E.s6]},dt[pt.Xl]={projections:[E.s6,E.hD,E.Lu]},dt[pt.ei]={projections:[E.Lu,E.hD,E.s6]},dt[pt.Wl]={projections:[E.s6,E.hD,E.Lu]},dt[pt.X9]={projections:[E.rU,E.hD,E.Lu,E.s6]},dt),ne=[E.Lu,E.hD,E.s6],Ao=function(){function e(t){this.resetToDefault=!1,t&&(this.behavior=t.behavior,this.behavior&&(this.behavior.shapeMap=this),this.tooltipsEnabled=t.tooltipsEnabled)}return e.prototype.init=function(t){this.root=t.element,this.hostServices=t.host,this.tooltipService=(0,Dt.r)(t.host),this.viewport=t.viewport,this.featureSwitches=t.featureSwitches,this.svg=d3.select(this.root.get(0)).append("svg").attr("focus-nav-mode","Hierarchy").attr("tabindex","0").attr("aria-label",this.hostServices.getLocalizedString("Visual_Plot")).attr("class","shapeMap").attr("width",this.viewport.width).attr("height",this.viewport.height).attr("drag-resize-disabled","true").style("position","absolute"),this.behavior&&(this.clearCatcher=(0,Lt.EX)(this.svg),this.interactivityService=(0,Lt.ub)(this.hostServices,this.featureSwitches)),this.mapG=this.svg.append("g"),this.style=t.style,this.legend=(0,Nt.OG)(this.root,t.interactivity&&t.interactivity.mobileTileInteractive,this.interactivityService,!0,void 0,this.style,this.hostServices)},e.prototype.update=function(t){if(this.viewport=t.viewport,!_.isEmpty(t.dataViews)&&t.dataViews[0]){var r=this.dataView=t.dataViews[0];this.viewModel=e.converter(r,this.style,this.interactivityService,this.tooltipsEnabled),this.render(t.suppressAnimations)}},e.prototype.enumerateObjectInstances=function(t){if(this.viewModel){var r=new Xt.G;switch(t.objectName){case"shape":r.pushInstance(this.viewModel.shapeMap?{objectName:"shape",selector:null,properties:{map:_.clone(this.viewModel.shapeMap),projectionEnum:this.viewModel.projectionEnum},validValues:{projectionEnum:e.validProjectionsForShapeMap(this.viewModel.shapeMap)}}:{objectName:"shape",selector:null,properties:{map:{}},validValues:{projectionEnum:ne}});break;case"defaultColors":r.pushInstance({objectName:"defaultColors",selector:null,properties:{defaultShow:this.viewModel.defaultShow,defaultColor:this.viewModel.defaultShow?this.viewModel.defaultColor:null,borderColor:this.viewModel.borderColor,borderThickness:this.viewModel.borderThickness}})}return r.complete()}},e.prototype.getFormattingModel=function(){return new et.Nq(this.getMapSettingsCard(),this.getLegendCard(),this.getFillColorsCard()).build()},e.prototype.getMapSettingsCard=function(){var t=this,r=wt.L.shape,i=wt.L.zoom,o=new et.CQ(new et.lg("mapSettings"),"Visual_AzureMapsMapSettings",[r.map,r.projectionEnum,i.autoZoom,i.selectionZoom,i.manualZoom],function(s){return t.hostServices.getLocalizedString(s)}),a=this.viewModel,u=a.shapeMap;return o.addGroup("options",function(s){s.withDisplayName("Visual_AzureMapsMapSettings").addSimpleSlice("shapeMapSelector",new et.vX({descriptor:r.map,value:u?_.clone(u):void 0}).build()).addSimpleSlice("projection",new et.uY({descriptor:r.projectionEnum,value:u&&a.projectionEnum,filterValues:u?e.validProjectionsForShapeMap(u):ne}).build())}).addGroup("zoom",function(s){s.withDisplayName("Visual_ShapeMap_Zoom").addSimpleSlice("autoZoom",new et.bd({descriptor:i.autoZoom,value:a.autoZoom}).build()).addSimpleSlice("selectionZoom",new et.bd({descriptor:i.selectionZoom,value:a.selectionZoom}).build()).addSimpleSlice("manualZoom",new et.bd({descriptor:i.manualZoom,value:a.manualZoom}).build())}),o.build()},e.prototype.getLegendCard=function(){var t=this.viewModel;return(0,ct.ZF)({legendData:t.legendData},this.hostServices,this.featureSwitches,!t.hasDynamicSeries)},e.prototype.getFillColorsCard=function(){var t=this,r=this.viewModel,i=this.dataView,o=wt.L.dataPoint,a=wt.L.defaultColors,u=function(m){return t.hostServices.getLocalizedString(m)},s={objectName:"gradient",propertyName:"diverging"},c={objectName:"gradient",propertyName:"gradientBar"},p={objectName:"gradient",propertyName:"minColor"},l={objectName:"gradient",propertyName:"midColor"},h={objectName:"gradient",propertyName:"maxColor"},f={objectName:"gradient",propertyName:"minValue"},v={objectName:"gradient",propertyName:"midValue"},d={objectName:"gradient",propertyName:"maxValue"},w=new et.CQ(new et.lg("fillColors"),"Visual_FillColors",[o.fill,o.fillRule,o.showAllDataPoints,a.defaultShow,a.defaultColor,a.borderColor,a.borderThickness,s,c,p,l,h,f,v,d],function(S){return t.hostServices.getLocalizedString(S)});if(e.shouldEnumerateDataPoints(i))w.addGroup("colors",function(S){if(S.withDisplayName("Visual_Colors"),r.hasDynamicSeries){var m={groupBuilder:S,dataPoints:(0,ct.l3)(r.legendData),seriesColorProps:o,localize:u,featureSwitches:t.featureSwitches};(0,Ut.y0)(m)}else{var D={groupBuilder:S,colorProps:o,featureSwitches:t.featureSwitches,hostService:t.hostServices,options:{dataView:i,style:t.style,categories:_.map(r.dataPoints,function(Y){return{displayName:Y.location,color:Y.color,identity:Y.identity}}),fillInstanceKind:3}};(0,Ut.jN)(D)}});else{var y=(0,N.NA)(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,{objectName:"dataPoint",propertyName:"fillRule"},null),C=(0,Kt.Wt)(y),Z=this.style.colorPalette.dataColors.getGradientColors();w.addGroup("colors",function(S){S.withDisplayName("Visual_Colors").addSimpleSlice("diverging",new et.bd({descriptor:s,value:C.diverging}).build(),function(m){return m.withCustomDisplayName("ConditionalFormattingDialogModern_Mode_ColorScale").withCustomDescription("Visual_Gradient_DivergingDescription")}).addSimpleSlice("gradientBar",new et._m({descriptor:c,value:(0,Kt.Kj)(C,Z)}).build()).addSimpleSlice("minColor",new et.BT({descriptor:p,value:{value:C.minColor||Z.minColor.value}}).build(),function(m){return m.withCustomDisplayName("Aggregate_Min").withCustomDescription("Visual_Gradient_MinColorDescription")}),C.diverging&&S.addSimpleSlice("midColor",new et.BT({descriptor:l,value:{value:C.midColor||Z.midColor.value}}).build(),function(m){return m.withCustomDisplayName("ConditionalFormattingDialog_CenterHeader").withCustomDescription("Visual_Gradient_MidColorDescription")}),S.addSimpleSlice("maxColor",new et.BT({descriptor:h,value:{value:C.maxColor||Z.maxColor.value}}).build(),function(m){return m.withCustomDisplayName("Aggregate_Max").withCustomDescription("Visual_Gradient_MaxColorDescription")}).addSimpleSlice("minValue",new et.mu({descriptor:f,value:C.minValue}).build(),function(m){return m.withCustomDisplayName("Aggregate_Min").withCustomDescription("Visual_Gradient_MinValueDescription")}),C.diverging&&S.addSimpleSlice("midValue",new et.mu({descriptor:v,value:C.midValue}).build(),function(m){return m.withCustomDisplayName("ConditionalFormattingDialog_CenterHeader").withCustomDescription("Visual_Gradient_MidValueDescription")}),S.addSimpleSlice("maxValue",new et.mu({descriptor:d,value:C.maxValue}).build(),function(m){return m.withCustomDisplayName("Aggregate_Max").withCustomDescription("Visual_Gradient_MaxValueDescription")})})}return w.addGroup("blankAreas",function(S){S.withDisplayName("Visual_ShapeMap_BlankAreas").addSimpleSlice("showBlankAreas",new et.bd({descriptor:a.defaultShow,value:r.defaultShow}).build(),function(m){return m.withCustomDisplayName("Visual_ShapeMap_BlankAreasShow")}).addSimpleSlice("color",new et.BT({descriptor:a.defaultColor,value:{value:r.defaultColor}}).build(),function(m){return m.withDisabled(!r.defaultShow)})}).addGroup("border",function(S){S.withDisplayName("Visual_Border").addSimpleSlice("color",new et.BT({descriptor:a.borderColor,value:{value:r.borderColor}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice("thickness",new et.mu({descriptor:a.borderThickness,value:r.borderThickness,options:{minValue:{type:0,value:0},maxValue:{type:1,value:10}}}).build(),function(m){return m.withCustomDisplayName("Visual_General_Properties_Width")})}),w.build()},e.getStandardGeoJsonFiles=function(){return _.clone(vr)},e.validProjectionsForShapeMap=function(t){if(!t||!t.name)return ne;var r=vr[t.name];return!r||_.isEmpty(r.projections)?ne:r.projections},e.shouldEnumerateDataPoints=function(t){return!!(0,F.c5)(t,E.ac)||!(0,F.c5)(t,E.S3)},e.prototype.getDataPointFromShape=function(t){return this.matcher.getDataPointFromShape(t)},e.getObjectProperties=function(t,r){var i=t&&t.metadata&&t.metadata.objects?t.metadata.objects:{},o=wt.L,a=(0,N.NA)(i,o.shape.map,null),u=e.validProjectionsForShapeMap(a),s=u[0],c=(0,N.NA)(i,o.shape.projectionEnum,s);_.includes(u,c)||(c=s);var p=tn.v.create(r);return{map:a,projectionEnum:c,autoZoom:(0,N.NA)(i,o.zoom.autoZoom,!1),selectionZoom:(0,N.NA)(i,o.zoom.selectionZoom,!1),manualZoom:(0,N.NA)(i,o.zoom.manualZoom,!1),defaultShow:(0,N.NA)(i,o.defaultColors.defaultShow,!0),defaultColor:p.getColorForProperty(i,o.defaultColors.defaultColor,"backgroundNeutral"),borderColor:p.getColorForProperty(i,o.defaultColors.borderColor,"foregroundNeutralSecondaryAlt2"),borderThickness:(0,N.NA)(i,o.defaultColors.borderThickness,1)}},e.converter=function(t,r,i,o){var a,u,s;void 0===o&&(o=!0);var p,l,h,f,c=[],v=0,d=wt.L.general.formatString;t&&(h=(p=(0,Ct.G)(t,{colorOptions:{valueRole:E.S3,visualStyle:r},formatStringProp:d})).columns,f=(l=p.data).getCategoryDisplayName(E.W3));var w=!1,y=!1,C=!1;p&&(w=h.hasDynamicSeries(),y=l.hasValues(E.S3),C=l.hasCategoryWithRole(E.W3),l.getValueQueryName(E.S3));var S=t&&p&&l.hasCategories();if(S){v=l.getSeriesCount();for(var m=0;m<l.getCategoryCount();m++){var D=l.getValue(E.S3,m),Y=l.getFormatString(E.S3,m),X=void 0,Q=void 0,O=void 0,nt=void 0;C&&(X=l.getCategoryValue(E.W3,m),Q={displayName:l.getCategoryDisplayName(E.W3),value:(0,Bt.xq)(X,h.getCategoryMetadataColumn(E.W3),d)}),v=l.getSeriesCount(),l.hasValues(E.S3)||(v=1);for(var $=h.getCategoryColumn(E.W3),R=(new x.dw).withCategory([$],m,null===(a=$?.source)||void 0===a?void 0:a.queryName,!0).withMeasure(l.getValueQueryName(E.S3)).createSelectionId(),I=0;I<v;I++){var J,tt=null===(u=t.categorical.values)||void 0===u?void 0:u.grouped(),ut=tt&&tt[I];J=p.colors.createBySeries(I,m);var lt=h.getCategoryColumn(C?E.W3:E.S3),gt=(new x.dw).withCategory([lt],m,null===(s=lt?.source)||void 0===s?void 0:s.queryName,!0).withMeasure(l.getValueQueryName(E.S3),h.getValueColumn(E.S3,I),m);w&&(gt=gt.withSeries(h.getSeriesValueColumns(),ut,!0),O={displayName:l.getSeriesDisplayName(),value:(0,Bt.xq)(l.getSeriesName(I),h.getSeriesMetadataColumn(),d)}),y&&(D=l.getValue(E.S3,m,I),Y=l.getFormatString(E.S3,m,I),nt={displayName:l.getValueDisplayName(E.S3),value:(0,Bt.xq)(D,h.getValueMetadataColumn(E.S3,I),d,!1,Y)});var Zt=[];o&&(Q&&Zt.push(Q),O&&Zt.push(O),nt&&Zt.push(nt),(0,Gt.VT)(p,Zt,m,I,d)),(null!=D||!y)&&c.push({location:X,identity:gt.createSelectionId(),value:D,selected:!1,tooltipInfo:Zt,color:J,categoryIdentity:R})}}}i&&i.applySelectionStateToData(c);var st=e.getObjectProperties(t,r);return{shapeMap:st.map,projectionEnum:st.projectionEnum,autoZoom:st.autoZoom,selectionZoom:st.selectionZoom,manualZoom:st.manualZoom,defaultShow:st.defaultShow,defaultColor:st.defaultColor,borderColor:st.borderColor,borderThickness:st.borderThickness,dataPoints:c,categoryName:f,dataAvailable:S,hasDynamicSeries:w,seriesCount:v,legendData:(0,ft.pq)({dataView:t,showByDefault:!0,style:r})}},e.createProjection=function(t){var r;switch(t){case E.rU:r=function(){var e,t,i,a,s,c,r=Oe().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7]),o=Oe().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Oe().rotate([157,0]).center([-3,19.9]).parallels([8,18]),p={point:function(v,d){c=[v,d]}};function l(f){var v=f[0],d=f[1];return c=null,i.point(v,d),c||(a.point(v,d),c)||(s.point(v,d),c)}function h(){return e=t=null,l}return l.invert=function(f){var v=r.scale(),d=r.translate(),w=(f[0]-d[0])/v,y=(f[1]-d[1])/v;return(y>=.12&&y<.234&&w>=-.425&&w<-.214?o:y>=.166&&y<.234&&w>=-.214&&w<-.115?u:r).invert(f)},l.stream=function(f){return e&&t===f?e:e=function(e){var t=e.length;return{point:function(i,o){for(var a=-1;++a<t;)e[a].point(i,o)},sphere:function(){for(var i=-1;++i<t;)e[i].sphere()},lineStart:function(){for(var i=-1;++i<t;)e[i].lineStart()},lineEnd:function(){for(var i=-1;++i<t;)e[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<t;)e[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<t;)e[i].polygonEnd()}}}([r.stream(t=f),o.stream(f),u.stream(f)])},l.precision=function(f){return arguments.length?(r.precision(f),o.precision(f),u.precision(f),h()):r.precision()},l.scale=function(f){return arguments.length?(r.scale(f),o.scale(.35*f),u.scale(f),l.translate(r.translate())):r.scale()},l.translate=function(f){if(!arguments.length)return r.translate();var v=r.scale(),d=+f[0],w=+f[1];return i=r.translate(f).clipExtent([[d-.455*v,w-.238*v],[d+.455*v,w+.238*v]]).stream(p),a=o.translate([d-.307*v,w+.201*v]).clipExtent([[d-.425*v+g,w+.12*v+g],[d-.214*v-g,w+.234*v-g]]).stream(p),s=u.translate([d-.205*v,w+.212*v]).clipExtent([[d-.214*v+g,w+.166*v+g],[d-.115*v-g,w+.234*v-g]]).stream(p),h()},l.fitExtent=function(f,v){return Be(l,f,v)},l.fitSize=function(f,v){return Qi(l,f,v)},l.fitWidth=function(f,v){return Ji(l,f,v)},l.fitHeight=function(f,v){return $i(l,f,v)},l.scale(1070)}();break;case E.hD:r=Ge(be).scale(152.63);break;case E.Lu:r=function(e){var s,c,p,t=Ge(e),r=t.center,i=t.scale,o=t.translate,a=t.clipExtent,u=null;function l(){var h=M*i(),f=t(function(e){function t(r){return(r=e(r[0]*V,r[1]*V))[0]*=H,r[1]*=H,r}return e=ci(e[0]*V,e[1]*V,e.length>2?e[2]*V:0),t.invert=function(r){return(r=e.invert(r[0]*V,r[1]*V))[0]*=H,r[1]*=H,r},t}(t.rotate()).invert([0,0]));return a(null==u?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:e===We?[[Math.max(f[0]-h,u),s],[Math.min(f[0]+h,c),p]]:[[u,Math.max(f[1]-h,s)],[c,Math.min(f[1]+h,p)]])}return t.scale=function(h){return arguments.length?(i(h),l()):i()},t.translate=function(h){return arguments.length?(o(h),l()):o()},t.center=function(h){return arguments.length?(r(h),l()):r()},t.clipExtent=function(h){return arguments.length?(null==h?u=s=c=p=null:(u=+h[0][0],s=+h[0][1],c=+h[1][0],p=+h[1][1]),l()):null==u?null:[[u,s],[c,p]]},l()}(We).scale(961/A);break;case E.s6:r=fr();break;default:ie.fF.assertFail("undefined projection"),r=fr()}return t===E.s6&&r.clipAngle(90),r},e.adjustProjection=function(t,r,i,o,a,u,s){if(void 0===s&&(s=1),t.scale(1),t.translate([0,0]),r>0){var c=function(e){sn=Fn=Zn=zn=Vn=xn=Tn=Bn=ce=fe=he=0,kt(e,Rt);var t=ce,r=fe,i=he,o=t*t+r*r+i*i;return o<z&&(t=xn,r=Tn,i=Bn,Fn<g&&(t=Zn,r=zn,i=Vn),(o=t*t+r*r+i*i)<z)?[NaN,NaN]:[At(r,t)*H,Mt(i/vt(o))*H]}(a);t.rotate(c.map(function(S,m){return m<r?-S:0}))}var p;try{p=Ve().projection(t).bounds(a)}catch(S){if(S instanceof TypeError)return void u.setWarnings([new Pn.pi]);throw S}var l=p[0][0],h=p[1][0],f=p[0][1],v=p[1][1],d=Math.abs(h-l),w=Math.abs(v-f),y=Math.min(i/d,o/w);t.scale(y*=s),t.translate([(i-y*(h+l))/2,(o-y*(v+f))/2])},e.prototype.createGetColorFunction=function(){var t=this;return function(r){var i=t.matcher.getDataPointFromShape(r);return i&&null!=i.color?i.color:t.viewModel.defaultColor}},e.rotationAxes=function(t){switch(t){case E.rU:return 0;case E.Lu:case E.hD:return 1;case E.s6:return 2;default:return 0}},e.prototype.zoomOnClick=function(t){!this.viewModel||!this.viewModel.selectionZoom||(this.selectionZoomShape=!t&&this.selectionZoomShape||t&&t.id&&this.selectionZoomShape&&this.selectionZoomShape.id&&this.selectionZoomShape.id===t.id?null:t,this.render(!1,!0))},e.prototype.resetToDefaultMap=function(){var t={type:G.c1,name:pt.X9,content:void 0};this.hostServices.persistProperties([{objectName:"shape",selector:null,properties:{map:t,projectionEnum:E.rU},validValues:{projectionEnum:e.validProjectionsForShapeMap(t)}}])},e.loadFeatureCollection=function(t){if(_.isEmpty(t.objects))return{features:[],type:"FeatureCollection"};for(var r in t.objects)return No.feature(t,t.objects[r])},e.prototype.featuresToZoomTo=function(t,r){var i=this;if(r&&this.selectionZoomShape)return{type:"FeatureCollection",features:[this.selectionZoomShape]};if(this.viewModel.autoZoom){var o={type:"FeatureCollection",features:t.features.filter(function(a){return!!i.getDataPointFromShape(a)})};if(o.features.length>0)return o}return t},e.prototype.render=function(t,r){var i=this;if(this.viewModel.shapeMap&&this.viewModel.shapeMap.content){this.resetToDefault=!1,this.mapG.interrupt(),this.shapes&&this.shapes.interrupt(),this.shapesExit&&this.shapesExit.interrupt(),this.manualZoomDisconnect(),this.viewModel.projectionEnum!==this.projectionEnum&&(this.projection=null),this.projectionEnum=this.viewModel.projectionEnum,this.renderLegend(),(0,ht.xz)(this.svg,this.legend);var o=this.getMapViewport();this.svg.attr("width",o.width).attr("height",o.height);var a=JSON.parse(this.viewModel.shapeMap.content),u=e.loadFeatureCollection(a);this.matcher=new dr(u.features,this.viewModel.dataPoints,this.viewModel.categoryName);var p,s=this.featuresToZoomTo(u,r),c=this.projection&&!this.viewModel.autoZoom&&!this.viewModel.selectionZoom&&this.prevAutoZoom===this.viewModel.autoZoom&&this.prevManualZoom===this.viewModel.manualZoom&&this.prevSelectionZoom===this.viewModel.selectionZoom&&this.prevShapeMapName===this.viewModel.shapeMap.name&&this.prevMapViewportWidth===o.width&&this.prevMapViewportHeight===o.height;if(this.prevAutoZoom=this.viewModel.autoZoom,this.prevManualZoom=this.viewModel.manualZoom,this.prevSelectionZoom=this.viewModel.selectionZoom,this.prevShapeMapName=this.viewModel.shapeMap.name,this.prevMapViewportWidth=o.width,this.prevMapViewportHeight=o.height,c)p=this.projection;else{p=e.createProjection(this.viewModel.projectionEnum);var l=e.rotationAxes(this.viewModel.projectionEnum);e.adjustProjection(p,l,o.width,o.height,s,this.hostServices,.9)}var f=this.createGetColorFunction();this.mapG.style("stroke-width",this.viewModel.borderThickness/2).style("stroke",this.viewModel.borderColor).style("fill",this.viewModel.defaultColor);var v=this.mapG.selectAll("path").data(this.visibleFeatures(u),this.shapeKeyFunction(u));this.shapesExit=void 0;var d=!1;if(this.interactivityService&&(d=this.interactivityService.hasSelection()),!this.projection||t)this.projection=p,this.path=Ve().projection(this.projection),this.shapes=v.enter().append("path").merge(v),this.shapes.attr("d",this.path).style("fill",f).style("opacity",function(m){var D=i.getDataPointFromShape(m);return(0,It.eR)(D&&D.selected,!1,d,!1)}),this.setAccessibilityAttributes(this.shapes,d),v.exit().remove(),this.manualZoomConnect();else if(this.path=Ve().projection(this.projection),this.shapes=v.enter().append("path").style("fill",f).style("opacity",0).attr("d",this.path).merge(v),this.setAccessibilityAttributes(this.shapes,d),this.shapes.transition().duration(600).style("fill",f).style("opacity",function(m){var D=i.getDataPointFromShape(m);return(0,It.eR)(D&&D.selected,!1,d,!1)}),this.shapesExit=v.exit(),this.shapesExit.transition().duration(600).style("fill",f).style("opacity",0).remove(),e.projectionsEqual(this.projection,p))this.projection=p,this.shapes.attr("d",this.path),this.shapesExit.attr("d",this.path),this.manualZoomConnect();else{var y=this.projection,C=p;this.mapG.transition().duration(600).tween("projection transition",function(){var m=y.scale&&d3.interpolate(y.scale(),C.scale()),D=y.translate&&d3.interpolate(y.translate(),C.translate()),Y=y.rotate&&d3.interpolate(y.rotate(),C.rotate());return y=null,C=null,function(X){m&&i.projection.scale(m(X)),D&&i.projection.translate(D(X)),Y&&i.projection.rotate(Y(X)),i.shapes.attr("d",i.path),i.shapesExit.attr("d",i.path)}}).on("end",function(){return i.manualZoomConnect()})}if(this.tooltipsEnabled){var Z=[];this.viewModel.dataAvailable||(Z=this.matcher.shapeProps.map(function(m){return m.propName}).sort()),this.tooltipService.addTooltip(this.shapes,function(m){if(i.viewModel.dataAvailable){if(!m.data)return;var D=i.matcher.getDataPointFromShape(m.data);return D?D.tooltipInfo:[{displayName:i.viewModel.categoryName,value:""+i.matcher.getShapeProp(m.data,i.matcher.shapePropName)||""}]}return Z.map(function(Y){return{displayName:Y||"ID",value:""+i.matcher.getShapeProp(m.data,Y)}})},function(m){var D=m.data&&i.matcher.getDataPointFromShape(m.data);if(D)return D.identity&&[D.identity]})}this.behavior&&this.interactivityService&&this.interactivityService.bind(this.viewModel.dataPoints,this.behavior,{shapes:this.shapes,clearCatcher:this.clearCatcher},{pointSourceKey:"shape-map"})}else this.resetToDefault||(this.resetToDefault=!0,this.resetToDefaultMap())},e.prototype.setAccessibilityAttributes=function(t,r){var i=this;t.attr("tabindex",function(o){return i.getDataPointFromShape(o)?"0":void 0}).attr("aria-selected",function(o){var a=i.getDataPointFromShape(o);if(a)return r&&a.selected})},e.prototype.visibleFeatures=function(t){var r=this;return this.viewModel.defaultShow?t.features:t.features.filter(function(i){return!!r.getDataPointFromShape(i)})},e.prototype.shapeKeyFunction=function(t){return t.features[0]&&null!=t.features[0].id?function(r){return r.id}:null},e.projectionsEqual=function(t,r){return!(t.scale&&!_.isEqual(t.scale(),r.scale())||t.rotate&&!_.isEqual(t.rotate(),r.rotate())||t.translate&&!_.isEqual(t.translate(),r.translate()))},e.prototype.manualZoomConnect=function(){var t,r=this;if(!this.zoom&&this.viewModel.manualZoom){var a=this.projection.scale(),u=[a/4,16*a];this.zoom=d3.zoom().scaleExtent(u).on("zoom",function(){var s=d3.event.transform;r.projection.translate([s.x,s.y]).scale(s.k),r.shapes.attr("d",r.path)}),this.svg.call(this.zoom).call(this.zoom.transform,(t=d3.zoomIdentity).translate.apply(t,this.projection.translate()).scale(a))}},e.prototype.manualZoomDisconnect=function(){this.zoom&&this.zoom.on("zoom",null),this.zoom=null},e.prototype.getMapViewport=function(){var t=this.viewport,r=this.legend.getMargins();return{width:t.width-r.width,height:t.height-r.height}},e.prototype.renderLegend=function(){var t=this.viewModel.legendData;null!=t.position&&this.legend.setPosition(t.position),1===t.dataPoints.length&&!t.grouped&&!this.viewModel.hasDynamicSeries&&(t.dataPoints=[]),this.legend.drawLegend({data:t,parentViewport:this.viewport})},e.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},e.prototype.onRestoreSelection=function(t){return!!this.interactivityService&&this.interactivityService.restoreSelection(t.selection)},e}(),dr=function(){function e(t,r,i){this.shapes=t,this.dataPoints=r,this.categoryName=i,this.shapeProps=this.countShapeProps(this.shapes),this.shapeProps=this.shapeProps.sort(this.getShapePropCompareFunction(this.categoryName)),this.buildMappings()}return e.prototype.getDataPointFromShape=function(t){var r=this.getShapeProp(t,this.shapePropName);return r||0===r?this.shapeToData[r]:null},e.prototype.getShapeFromDataPoint=function(t){return this.dataToShape[t.location]},e.prototype.countShapeProps=function(t){for(var r={},i=0,o=t.length,a=0;a<o;a++){var u=t[a];for(var s in u.hasOwnProperty("id")&&i++,u.properties)r.hasOwnProperty(s)?r[s]++:r[s]=1}var c=[];for(var s in r)r.hasOwnProperty(s)&&c.push({propName:s,count:r[s]});return i>0&&c.push({propName:"",count:i}),c},e.prototype.getShapePropCompareFunction=function(t){return function(r,i){if(r.count!==i.count)return i.count-r.count;if(t){if(r.propName===t)return-1;if(i.propName===t)return 1;if(t=t.toLowerCase().trim(),r.propName.toLowerCase().trim()===t)return-1;if(i.propName.toLowerCase().trim()===t)return 1}return 0}},e.prototype.getShapeProp=function(t,r){return""===r?t.id:t.properties[r]},e.prototype.removeAtIndex=function(t,r){return t.slice(0,r).concat(t.slice(r+1))},e.prototype.buildMappings=function(){var t=0;t:for(var r=0,i=this.shapeProps;r<i.length;r++){var o=i[r];if(t>o.count)break t;for(var a=0,u={},s={},c=this.shapes,p=this.dataPoints,l=c.length-1;l>=0;l--){var h=c[l],f=this.getShapeProp(h,o.propName);if(f||0===f){n:for(var v=0;v<p.length;v++){var d=p[v],w=d.location;if(null!=w&&(w===f||w.toLowerCase&&f.toLowerCase&&w.toLowerCase()===f.toLowerCase())){u[w]=h,s[f]=d,c=this.removeAtIndex(c,l),p=this.removeAtIndex(p,v),a++;break n}}if(0===c.length||0===p.length){t=a,this.shapePropName=o.propName,this.shapeToData=s,this.dataToShape=u;break t}}}a>t&&(t=a,this.shapePropName=o.propName,this.shapeToData=s,this.dataToShape=u)}},e}()},15841:function(En,_t,q){"use strict";q.r(_t),q.d(_t,{ShapeMapBehavior:function(){return Kt}});var wt=q(60066),Ut=q(66232),tn=q(30237),It=q(38400),Bt=q(59107),Kt=function(){function Xt(){}return Xt.prototype.onClick=function(Ct,ft){var Nt=this.shapeMap.getDataPointFromShape(Ct);Nt?(0,tn.c8)({identity:Nt.categoryIdentity,selected:Nt.selected},ft):ft.handleClearSelection()},Xt.prototype.bindEvents=function(Ct,ft,Nt){var ct=this;Ct.clearCatcher.on("click",function(){var ht=d3.event;Bt.M.isCtrlOrMeta(ht)||ft.handleClearSelection(),ct.shapeMap.zoomOnClick()}),this.shapes=Ct.shapes,this.shapes.on("click",function(ht,Lt){ct.onClick(ht,ft),ct.shapeMap.zoomOnClick(ht)}),this.shapes.on("focus",function(){var ht=d3.event,Dt=d3.select(ht.target),Gt=Dt.datum();if(Gt){var E=ct.shapeMap.getDataPointFromShape(Gt);E&&Dt.attr("aria-label",(0,It.X)(E.tooltipInfo))}}),this.shapes.on("contextmenu",function(){var ht=d3.event;if(!Bt.M.isCtrlOrMeta(ht)){ht.preventDefault(),(0,Ut.n)(ht);var Dt=d3.select(ht.target).datum();if(Dt){var Gt=ct.shapeMap.getDataPointFromShape(Dt);if(Gt){var E=(0,tn.bt)();ft.handleContextMenu(Gt,E)}}}}),this.shapes.on("keydown.select",function(ht){var Dt=d3.event.keyCode;(32===Dt||13===Dt)&&ct.onClick(ht,ft)})},Xt.prototype.renderSelection=function(Ct){var ft=this;this.shapes.attr("aria-selected",function(Nt){var ct=ft.shapeMap.getDataPointFromShape(Nt);return Ct&&ct&&ct.selected}).transition().duration(600).style("opacity",function(Nt){var ct=ft.shapeMap.getDataPointFromShape(Nt);return(0,wt.eR)(ct&&ct.selected,!1,Ct,!1)})},Xt}()}}]);