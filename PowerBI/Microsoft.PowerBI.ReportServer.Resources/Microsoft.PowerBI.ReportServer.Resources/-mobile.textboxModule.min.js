"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["textboxModule","textbox"],{28241:function(fe,Y,T){T.r(Y),T.d(Y,{AlwaysUseSmallViewport:function(){return Se},ColorPicker:function(){return Z},DefaultAlignment:function(){return $t},DefaultLinkInputValue:function(){return Ut},FontSizePrecision:function(){return Mt},FontSizes:function(){return Ct},Fonts:function(){return gt},FormattingSettings:function(){return ue},LegacyDefaultFont:function(){return Vt},LegacyDefaultFontProperties:function(){return yt},LegacyFontSize:function(){return zt},LinkInput:function(){return Bt},LinkPreview:function(){return Wt},MiniToolbarLargeButton:function(){return ce},ModelKeyName:function(){return dt},QuillPlaceholder:function(){return nt},QuillWrapper:function(){return B},SmartNarrativesEditor:function(){return le},TextAlignments:function(){return It},TextIndent:function(){return Ot},TextListTypes:function(){return ct},TextRunElement:function(){return bt},TextScriptTypes:function(){return ut},Textbox:function(){return Lt},Toolbar:function(){return Xt},ViewModelAdapter:function(){return qt},applyTooltip:function(){return rt},buildToolbarLinkInputTemplate:function(){return ee},button:function(){return oe},convertDeltaToParagraphs:function(){return Rt},convertFormatAttributesToTextStyle:function(){return ht},convertIndentToPadding:function(){return Dt},convertParagraphsToHtml:function(){return Ht},convertParagraphsToOps:function(){return Gt},div:function(){return R},formatButton:function(){return K},formatGroup:function(){return I},formattingSettingsClass:function(){return At},formattingSettingsGroup:function(){return ne},getAtMentionTextRun:function(){return Kt},getBlockStyle:function(){return Qt},getCSSFromFont:function(){return J},getCssFontFamily:function(){return Zt},getCssFontSize:function(){return Yt},getCustomQuillFormatValue:function(){return ft},getFontFromCSS:function(){return St},getTextRunFromSmartNarrativesInsert:function(){return jt},getTooltip:function(){return U},getVerticalDivider:function(){return Et},isValidLinkUrl:function(){return it},linkTooltipTemplateGenerator:function(){return te},mentionDefaultMaxSearchLength:function(){return kt},options:function(){return Tt},picker:function(){return xt},removeQuotes:function(){return Jt},selector:function(){return ae},smartNarrativesEditor:function(){return ie},smartNarrativesEditorClass:function(){return Nt},span:function(){return re},toggleGroup:function(){return pt},updatePicker:function(){return Ft},updateSelector:function(){return se}});var y=T(81337),X=T(65302),ot=T(11034),vt=T(57470),L=T(57869),tt=T(90120),et=T(18664),pe=T(67064),j=T(32105),Pt=T(64067),ve=T(44783),w=T(79154),m=T(62458),D=T(65195),W=T(38265),me=T(57419),ge=T(59107),at=T(9795),wt=T(98094),st=T(48066),_t=T(38078),Ce=T(66001),lt=T(38830),P=T(19060),kt=48,mt=(0,w.CH)("textboxFocusElement"),ye={linkTooltip:(0,w.CH)("ql-link-tooltip"),toolbarUrlInput:(0,w.CH)("toolbar-url-input")},gt=["Arial","Arial Black","Arial Unicode MS","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","DIN","DIN Light","Georgia","Lucida Sans Unicode","Segoe (Bold)","Segoe UI","Segoe UI Light","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Wingdings"],Mt=1,Ct=[8,9,10,10.5,11,12,14,16,18,20,24,28,32,36,40,42,44,54,60,66,72,80,88,96],Vt=W.Wn.light.family,zt=j.B.createFromPx(14),yt={family:Vt,size:zt},It=["Left","Center","Right"],Ot=["-1","+1"],$t="Left",ut=function(e){return e.Super="Super",e.Sub="Sub",e}({}),ct=function(e){return e.Bullet="bullet",e.Numbered="ordered",e}({});function J(e){var t=W.bw[e];return t?t.family:e}function St(e){return _.findKey(W.bw,function(i){return i.family===e||i.family.indexOf(e)>0})||e}var Lt=function(){function e(t){var i=this;this.asyncSerializer=new me.W,t&&(this.supportsNarrativeExpressions=!1!==t.supportsNarrativeExpressions,this.supportsAtMention=!!t.supportsAtMention,this.textChangeThrottle=t.textChangeThrottle,this.placeholderText=t.placeholderText,this.supportsFormattingChangeIndicationOptions=!!t.supportsFormattingChangeIndication,this.hierarchicalTabbing=!!t.hierarchicalTabbing,m.fF.assert(function(){return!(t.textChangeThrottle&&i.supportsNarrativeExpressions)},"textChangeThrottle cannot be used with supportsNarrativeExpressions"),this.fontFamilies=(0,y.ev)([],t.allowedFonts||gt||[],!0),this.fontSizes=(0,y.ev)([],t.allowedFontSizes||Ct||[],!0),this.restrictFontSizes=_.some(t.allowedFontSizes),t.viewModelAdapter&&(this.viewModelAdapter=t.viewModelAdapter),this.disableScrollingInViewMode=t.disableScrollingInViewMode,this.featureSwitches=t.featureSwitches)}return e.prototype.init=function(t){this.element=t.element,this.host=t.host,this.viewport=t.viewport,this.style=t.style,this.readOnly=0===this.host.getViewMode(),this.paragraphs=[],this.defaultFont=(0,y.pi)({},yt),this.fontFamilies=(0,y.ev)([],this.fontFamilies||gt||[],!0),this.fontSizes=(0,y.ev)([],this.fontSizes||Ct||[],!0),this.evaluatedValues={},this.quillEditorIsReady=this.host.promiseFactory().defer(),this.featureSwitches=t.featureSwitches,this.configureMentions(),this.refreshView()},e.prototype.onResizing=function(t){var i=this.viewport;this.viewport=t,this.updateSize(),this.viewModelAdapter&&this.viewModelAdapter.onResizing(this.element,this.viewport,i,this.defaultFont)},e.prototype.onDataChanged=function(t){m.fF.assertValue(t,"options");var i=t.dataViews;this.evaluatedValues={},this.paragraphs=[];var n=this.editor&&this.editor.isDirty;if(n&&(this.paragraphs=this.getContents()),i&&i.length>0){var r=i[0].metadata.objects;r&&r.general&&!n&&(this.paragraphs=r.general.paragraphs),(0,P.Ih)(r,this.evaluatedValues,this.host.telemetry());var o=tt.v.create(this.style);this.defaultFont=(0,et.Zi)(r&&r.text,{family:"fontFamily",size:"fontSize",color:"color"},o,this.style,"foreground","label",yt)}this.mergeParagraphFontsWithStandardFonts(),this.refreshView()},e.prototype.getTelemetryInformation=function(){for(var t,i,o=!1,a=[],s=0,l=this.paragraphs;s<l.length;s++)for(var d=0,h=l[s].textRuns;d<h.length;d++){var c=h[d];if((0,P.ki)(c)){if(o=!0,!_.isEmpty(c.cases)){var v=_.first(c.cases);a.push(_.round(v.pattern,-2))}}else(0,P.HA)(c)?(0,lt.U)(c.value)&&(o=!0):m.fF.assertNever(c)}return o&&((t={}).SmartNarratives=!0,t.SummarizationTemplateIds=a.join(","),i=t),i},e.prototype.mergeParagraphFontsWithStandardFonts=function(){var t=(0,y.ev)((0,y.ev)([],_.map(this.fontSizes,function(p){return j.B.createFromPt(p)}),!0),[this.defaultFont.size],!1),i=_.chain(t).map(function(p){return p.pt}).uniqBy(function(p){return p}).sortBy(function(p){return p}).value(),n=St(this.defaultFont.family),r=(0,y.ev)((0,y.ev)([],this.fontFamilies,!0),[n],!1),o=this.paragraphs;if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(l.textRuns)for(var u=0,d=l.textRuns;u<d.length;u++){var h=d[u],c=h&&(0,P.HA)(h)&&h.textStyle;if(c){if(c.fontSize){var v=j.B.createFromCSS(c.fontSize,Mt);if(v)if(this.restrictFontSizes){var f=_.sortedIndex(i,v.pt);c.fontSize=i[Math.min(f,i.length-1)]+"pt"}else t.push(v)}c.fontFamily&&r.push(c.fontFamily)}}}this.fontSizes=_.chain(t).map(function(p){return p.pt}).sortBy(function(p){return p}).uniqBy(function(p){return p}).value(),this.fontFamilies=_.chain(r).sortBy(function(p){return p}).uniqBy(function(p){return p}).value()},e.prototype.destroy=function(){this.editor&&(this.editor.destroy(),this.editor=void 0),this.isDisposed=!0},e.prototype.focus=function(){if(this.editor)return this.editor.focus(),!0},e.prototype.onViewModeChanged=function(t){this.readOnly=0===t,this.refreshView()},e.prototype.setSelection=function(t,i){m.fF.assertValue(this.editor,"editor"),this.editor&&this.editor.setSelection(t,i)},e.prototype.getSelection=function(){return this.editor.getSelection()},e.prototype.ensureFocusableElement=function(){var t=this,i=this.element;if(!i.find(mt.selector).length){var n=$("<div>").width(0).height(0).attr("tabindex",0).addClass(mt.class);i.append(n),n.on(ot.BZ,function(){t.focus()})}},e.prototype.removeFocusableElement=function(){this.element.find(mt.selector).remove()},e.prototype.refreshView=function(){return(0,y.mG)(this,void 0,void 0,function(){var t=this;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return[4,this.asyncSerializer.enqueue(function(){return(0,y.mG)(t,void 0,void 0,function(){var n,r,o,a,s,l,u,d,h=this;return(0,y.Jh)(this,function(c){switch(c.label){case 0:return this.isDisposed?[2]:this.readOnly?(this.editor&&(this.editor.isDirty&&this.saveContents(),this.editor.destroy(),this.editor=null),this.element.empty(),n=Ht(this.paragraphs,this.defaultFont,this.evaluatedValues,this.$mentionsHoverContainer,this.personCardComponent),r=$("<div>").addClass(e.ClassAndSelector.class).css((0,et.wB)(this.defaultFont)).append(n),this.supportsAtMention&&r.append(this.$mentionsHoverContainer),this.viewModelAdapter&&this.viewModelAdapter.onDataChanged(r,this.viewport,this.defaultFont),o=void 0,this.disableScrollingInViewMode?(o=r,this.element.append(r)):(o=this.$scrollableDiv=$("<div></div>").addClass(e.ScrollWrapperClassAndSelector.class).css({height:"".concat(this.viewport.height,"px"),"overflow-y":"auto","overflow-x":"hidden"}).append(r),this.element.append(this.$scrollableDiv)),this.removeFocusableElement(),o.attr("tabindex",0).attr("role","document").attr(ot.Qt,"Browser").on("keydown",function(v){27===v.keyCode&&(X.IK.focus(vt.M.getParentFocusElement(document.activeElement)),v.stopPropagation())}),[3,5]):[3,1];case 1:return a={defaultFont:this.defaultFont,evaluatedValues:this.evaluatedValues,fontFamilies:this.fontFamilies,fontSizes:this.fontSizes,supportsNarrativeExpressions:this.supportsNarrativeExpressions,textChangeThrottle:this.textChangeThrottle,onEscape:function(){return h.focus()},featureSwitches:this.featureSwitches,supportsFormattingChangeIndication:this.supportsFormattingChangeIndicationOptions,onRenderTooltip:function(f,p){return h.getTooltipsComponent(f,p)},hierarchicalTabbing:this.hierarchicalTabbing},s=this.supportsFormattingChangeIndicationOptions&&!this.readOnly,this.editor?[3,3]:(this.editor=new B(this.readOnly,this.host,this.style,a,this.supportsAtMention,this.$mentionsHoverContainer,this.personCardComponent,this.placeholderText,s,this.hierarchicalTabbing),this.editor.textChanged=function(){return h.saveContents()},this.element.empty(),this.ensureFocusableElement(),(l=this.editor.getElement()).addClass(e.ClassAndSelector.class),this.element.append(l),[4,this.editor.init()]);case 2:return c.sent(),[3,4];case 3:this.editor.updateOptions(a),c.label=4;case 4:if(!this.editor)return[2];this.editor.getElement().css((0,et.wB)(this.defaultFont)),this.quillEditorIsReady.resolve(),this.restrictFontSizes&&(this.editor.onPaste=function(){h.mergeParagraphFontsWithStandardFonts(),h.refreshView()}),u=this.editor.getSelection(),d=Gt(this.paragraphs,this.evaluatedValues,this.editor,this.style,this.$mentionsHoverContainer,this.personCardComponent),this.editor.setContents(d),u&&this.editor.setSelection(u.index,u.length),c.label=5;case 5:return this.updateSize(),[2]}})})})];case 1:return i.sent(),[2]}})})},e.prototype.getContents=function(){if(this.editor){var t=this.editor.getContents();if(t){var i=Rt(t,this.supportsNarrativeExpressions,this.evaluatedValues);if(!(i.length<1))return i}}},e.prototype.saveContents=function(){var t=this.getContents();t&&(this.paragraphs=t,this.host.persistProperties([{objectName:"general",properties:{paragraphs:this.paragraphs},selector:null}]),this.editor&&this.editor.isDirty&&(this.editor.isDirty=!1))},e.prototype.updateSize=function(){this.editor?this.editor.resize(this.viewport):this.$scrollableDiv&&this.$scrollableDiv.css("height","".concat(this.viewport.height,"px"))},e.prototype.configureMentions=function(){if(this.supportsAtMention){this.$mentionsHoverContainer=$("<span>").addClass(e.MentionsHoverClassAndSelector.class).hide();var t=this.host.getUIComponentFactory();m.fF.assertValue(t,"uiComponentFactory"),this.personCardComponent=t.createPersonCard(this.$mentionsHoverContainer.get(0))}},e.prototype.onTextEditorReady=function(){return this.quillEditorIsReady.promise},e.prototype.getTooltipsComponent=function(t,i){return this.tooltip&&this.tooltip.close(),this.tooltip=this.host.getUIComponentFactory().createTooltip(t,i),this.tooltip},e.ClassAndSelector=(0,w.CH)("textbox"),e.MentionsHoverClassAndSelector=(0,w.CH)("mentions-hover"),e.ScrollWrapperClassAndSelector=(0,w.CH)("scrollWrapper"),e}(),Ut="https://",qt=function(){function e(t){this.smallViewportProperties=t}return e.prototype.onResizing=function(t,i,n,r){var o=this.isSmallViewport(n),a=this.isSmallViewport(i);o!==a&&this.applyScaleOnElement(t,a,r)},e.prototype.onDataChanged=function(t,i,n){this.isSmallViewport(i)&&this.applyScaleOnElement(t,!0,n)},e.prototype.isSmallViewport=function(t){return!!t&&!!this.smallViewportProperties&&(t.height<=this.smallViewportProperties.minHeightToScaleFontSize||t.width<=this.smallViewportProperties.minWidthToScaleFontSize)},e.prototype.applyScaleOnElement=function(t,i,n){i&&(n=(0,y.pi)((0,y.pi)({},n),{size:e.scale(n.size)})),t.find(Lt.ClassAndSelector.selector).css((0,et.wB)(n)),t.find(bt.selector).each(function(r,o){var a;if(i){var l,s=$(o).css("font-size");l=s?j.B.createFromCSS(s):n.size,a=e.scale(l)}else{var u=$(o).data(dt),d=u.textStyle&&u.textStyle.fontSize;d&&(a=j.B.createFromCSS(d))}var h=n;a&&(h=(0,y.pi)((0,y.pi)({},n),{size:a})),(0,et.JZ)(h,o)})},e.scale=function(t){var i=t.px;return j.B.createFromPx(i>66?32:i>42?28:i>26?24:i>16?20:i>11?14:12)},e}(),Se=function(e){function t(){return e.call(this,{minHeightToScaleFontSize:1/0,minWidthToScaleFontSize:1/0})||this}return(0,y.ZT)(t,e),t}(qt),Wt=function(){function e(){}return e.format=function(t){return/^\S+@\S+\.\S+$/.test(t)?"mailto:"+t:/^https?:\/\//i.test(t)?t:Ut+t},e}(),dt="ModelObject",bt=(0,w.CH)("textRun");function Rt(e,t,i){for(var n=[],r={textRuns:[]},o=!1,a=function(h,c){var v=e.ops[h];m.fF.assertValue(v,"operation should be an insert");var f=v.attributes,p=v.insert;if(void 0===p)return"continue";if(_.isString(p)){var g=p;o=!1,f&&f.align&&(m.fF.assert(function(){return void 0===r.horizontalTextAlignment||r.horizontalTextAlignment===f.align},"paragraph should not have more than one horizontal alignment"),r.horizontalTextAlignment=f.align),f&&f.indent&&(r.indent=f.indent),f&&f.list&&(r.listType=f.list);var E=0,F=0,k=void 0;do{if((F=g.indexOf(L.mj,E))<0?(k=!1,F=g.length):k=!0,F-E>0){var C={value:g.substring(E,F)};if(f){void 0!==f.link&&it(f.link)&&(C.url=f.link);var b=ht(f);b&&(C.textStyle=b)}r.textRuns.push(C)}k&&(0===r.textRuns.length&&r.textRuns.push({value:""}),n.push(r),r={textRuns:[]}),E=F+1}while(E<g.length)}else if(_.isNumber(p))m.fF.assertFail("embeds not supported");else{var S=Kt(f,p);if(S)r.textRuns.push(S);else if(t){if(!(C=jt(f,p)))return"continue";if((0,P.ki)(C)){var V=(0,P.kO)(C,i),x=(0,P.AA)(V,i);if((x===L.mj||x===L.d$)&&!o)return 0===r.textRuns.length&&r.textRuns.push({value:""}),n.push(r),r={textRuns:[]},o=!1,"continue";o=!0}r.textRuns.push(C)}}},s=0,l=e.ops.length;s<l;s++)a(s);if(r.textRuns.length>0){var u=_.first(r.textRuns);(0,P.HA)(u)&&_.isString(u.value)&&u.value.length>0&&n.push(r)}return n}function Ht(e,t,i,n,r){for(var o=$(),a=0,s=$(),l=0,u=e.length;l<u;++l){var d=e[l],h=!0;d.listType===ct.Numbered?a++:(a=0,s=void 0);var c=$("<p>").data(dt,d);d.horizontalTextAlignment&&c.css("text-align",d.horizontalTextAlignment),d.indent&&c.css("padding","0px 0px 0px "+Dt(d.indent)+"px");for(var v=function(k,O){var b,A,C=d.textRuns[k],S=void 0,V=void 0,x=void 0;if((0,P.HA)(C))S=C.value,V=C.textStyle,x=C.url,(0,P.n8)(C)&&(S="@".concat(S),(V=V||{}).color="#1453b3",A=C.mentionEmail);else{if(!(0,P.ki)(C))return m.fF.assertNever(C),"continue";var M=(0,P.kO)(C,i);if((S=(0,P.AA)(M,i))===L.d$)return"continue";_.isEmpty(M)||(V=M[0].textStyle,x=M[0].url)}_.isEmpty(S)||(h=!1),b=void 0!==x&&it(x)?$("<a>").attr("href",x).attr("rel","noopener noreferrer").attr("target","_blank"):$("<span>");var q=(0,P.SV)(S,i);b.text(q).addClass(bt.class).data(dt,C);var N=V;if(N){var z={};if(N.fontFamily&&(z["font-family"]=Zt(N.fontFamily,t)),N.fontSize){var de=j.B.createFromCSS(N.fontSize);z["font-size"]=Yt(de,t)}N.fontStyle&&(z["font-style"]=N.fontStyle),N.fontWeight&&(z["font-weight"]=N.fontWeight),N.color&&(z.color=N.color),N.textDecoration&&(z["text-decoration"]=N.textDecoration),N.scriptType&&(z.lineHeight="0"===N.lineHeight?"Normal":N.lineHeight,z.position=N.position,z.verticalAlign=N.verticalAlign,N.scriptType===ut.Sub.toLowerCase()?z.bottom=N.bottom:z.top=N.top),b.css(z)}A&&b.on(D.Wo,function(){r.showUser(A);var G=b.get(0),H=G.getBoundingClientRect();n.stop(!0,!0).css({left:G.offsetLeft,top:G.offsetTop-H.height-32}).delay(200).queue(function(Q){b.is(":hover")&&n.fadeIn("fast"),Q()})}).on(D.xw,function(){n.delay(500).queue(function(G){!function Q(he){n.is(":hover")?setTimeout(function(){return Q(he)},500):he()}(G)}).fadeOut("fast")}),c.append(b)},f=0,p=d.textRuns.length;f<p;++f)v(f);if(d.listType===ct.Bullet&&(c.css("display","inline"),(c=c.wrap("<ul><li></li></ul>").parent().parent()).css("text-align",d.horizontalTextAlignment)),d.listType===ct.Numbered){var g="list-style-type: decimal !important; list-style-position: inside !important;";c.css("display","inline"),1===a?((s=c=c.wrap("<ol><li></li></ol>").parent().parent()).children().attr("style",g),o=o.add(s)):a>1&&((c=c.wrap("<li></li>").parent()).attr("style",g),s.append(c)),c.css("text-align",d.horizontalTextAlignment)}else h&&c.append($("<br>")),o=o.add(c)}return o}function Dt(e){var t;return(t=Number(e))>=0&&t<=9?40*t:0}function Gt(e,t,i,n,r,o){for(var a,s,l,u=[],d=0,h=0,c=e.length;h<c;++h){for(var v=e[h],f=0,p=v.textRuns.length;f<p;++f){var g=v.textRuns[f],E=void 0,F=void 0,k=void 0;if((0,P.HA)(g))E=g.textStyle,F=g.url,k=g.value;else{if(!(0,P.ki)(g)){m.fF.assertNever(g);continue}if(!_.isEmpty(g.cases)){var O=_.first(g.cases);_.isEmpty(O.textRuns)||(E=_.first(O.textRuns).textStyle,F=_.first(O.textRuns).url)}}var C={},b=E;b&&(b.fontFamily&&(C.font=(0,W._b)(J(Jt(b.fontFamily)))),b.fontSize&&(C.size=b.fontSize),b.color&&(C.color=b.color),C.italic="italic"===b.fontStyle||void 0,C.bold="bold"===b.fontWeight||void 0,C.underline="underline"===b.textDecoration||void 0,b.scriptType&&(C.script=b.scriptType));var S=k;F&&it(F)&&(C.link=F);var V=void 0;if((0,lt.U)(S))V={attributes:C,insert:(a={},a[B.smartNarrativesBlotClass.class]={definition:g,destroyEditorActions:i.destroyEditorActions,evaluatedValues:t,localizationProvider:i.localizationProvider,objRef:x=S.selector.id,onSelectSmartNarrativesBlot:function(G){var H;null===(H=i?.smartNarrativesEditorContainer)||void 0===H||H.getSmartNarrativesEditor().onSelectEditableObject(G)},style:n},a)};else if((0,P.ki)(g)){var x=(0,lt.U)(g.expression)?g.expression.selector.id:void 0,M={conditionalIndex:d,definition:g,destroyEditorActions:i.destroyEditorActions,evaluatedValues:t,localizationProvider:i.localizationProvider,objRef:x,onSelectSmartNarrativesBlot:function(H){var Q;null===(Q=i?.smartNarrativesEditorContainer)||void 0===Q||Q.getSmartNarrativesEditor().onSelectEditableObject(H)},onSelectSmartNarrativesConditionalBlot:function(H){setTimeout(function(){i?.setSelectionOfConditional(H)})},style:n};d++,V={attributes:C,insert:(s={},s[B.smartNarrativesConditionalBlotClass.class]=M,s)}}else V=(0,P.n8)(g)?{attributes:C,insert:(l={},l[B.atMentionBlotClass.class]={email:g.mentionEmail,displayName:S,hoverContainer:r,personCardComponent:o},l)}:{attributes:C,insert:S};u.push(V)}var N={insert:"\n"};m.fF.assert(function(){return!_.endsWith(_.last(u).insert,"\n")},"paragraphs should not end in a new line");var z=Qt(v);z&&(N.attributes=z),u.push(N)}return u}function Kt(e,t){var i,n,r;if(e&&(r=ht(e)),t[B.atMentionBlotClass.class]&&!0!==t[B.atMentionBlotClass.class]){var o=t[B.atMentionBlotClass.class];n={mentionEmail:o.email,value:null!==(i=o.displayName)&&void 0!==i?i:o.email},r&&(n.textStyle=r)}return n}function jt(e,t){var i,n,r;if(e){var o=ht(e);o&&(n=o),void 0!==e.link&&it(e.link)&&(r=e.link)}if(t[B.smartNarrativesBlotClass.class]&&!0!==t[B.smartNarrativesBlotClass.class]){var s=t[B.smartNarrativesBlotClass.class].objRef;if(!s)return void m.fF.assertFail("Invalid narrative blot retrieved from QuillJS");if(s===nt)return;i={textStyle:n,url:r,value:{propertyIdentifier:L.RL.values.expr,selector:{id:s}}}}else if(t[B.smartNarrativesConditionalBlotClass.class]&&!0!==t[B.smartNarrativesConditionalBlotClass.class]){var l=t[B.smartNarrativesConditionalBlotClass.class];if(!(0,P.ki)(l.definition))return void m.fF.assertFail("Invalid conditional retrieved from QuillJS");for(var u=0,d=(i=l.definition).cases;u<d.length;u++)for(var c=0,v=d[u].textRuns;c<v.length;c++)(f=v[c]).textStyle=n,f.url=r;for(var p=0,g=i.defaultCase.textRuns;p<g.length;p++){var f;(f=g[p]).textStyle=n,f.url=r}}return i}function it(e){if(_.isEmpty(e))return!1;switch((0,st.MN)(e)){case st.av.http:case st.av.https:case st.av.mailto:return!0;default:return!1}}function Qt(e){var t={};return e.horizontalTextAlignment&&(t.align=e.horizontalTextAlignment),e.listType&&(t.list=e.listType),e.indent&&(t.indent=e.indent),!_.isEmpty(t)&&t}function ht(e){var t={};if(e.bold&&(t.fontWeight="bold"),e.font){var i=(0,W._b)(_.unescape(e.font),!1);i=St(i),t.fontFamily=i}return e.italic&&(t.fontStyle="italic"),e.size&&(t.fontSize=e.size),e.underline&&(t.textDecoration="underline"),e.color&&(t.color=e.color),e.script&&(t.lineHeight="0",t.position="relative",t.verticalAlign="baseline",t.scriptType=e.script,e.script===ut.Sub.toLowerCase()?t.bottom="-0.25em":t.top="-0.25em",e.indent&&(t.indent=e.indent)),t}function Jt(e){return!_.startsWith(e,"'")||(0,_t.ms)(e,",")?e:(m.fF.assert(function(){return _.endsWith(e,"'")},"mismatched quotes"),e.slice(1,e.length-1))}function Zt(e,t){var i=J(e);return i!==t.family?i:void 0}function Yt(e,t){return null==e||e.equals(t.size)?"":"".concat(e.pt,"pt")}var nt="__Placeholder__";function ft(e,t){var i;return void 0!==e&&!_.isString(e.insert)&&!_.isNumber(e.insert)&&void 0!==e.insert&&(i=e.insert[t]),i}var B=function(){function e(t,i,n,r,o,a,s,l,u,d){var h=this;this.readOnly=t,this.host=i,this.style=n,this.options=r,this.supportsAtMention=o,this.$mentionsHoverContainer=a,this.personCardComponent=s,this.placeholderText=l,this.supportsFormattingChangeIndication=u,this.hierarchicalTabbing=d,this.textChanged=_.noop,this.isDirty=!1,this.$container=$("<div>"),this.localizationProvider={get:function(v){return h.host.getLocalizedString(v)},getOptional:function(v){return h.host.getLocalizedString(v)},format:function(v){for(var f=[],p=1;p<arguments.length;p++)f[p-1]=arguments[p];return h.host.getLocalizedString(v,f)}}}return e.prototype.init=function(){return(0,y.mG)(this,void 0,void 0,function(){var t;return(0,y.Jh)(this,function(i){switch(i.label){case 0:return(0,pe.mR)()?(this.initialized=!1,[4,this.host.loader().require({javascript:"quill",css:["quill.core"]})]):[3,3];case 1:return t=i.sent(),this.$container?[4,this.initializeQuill(t)]:[2];case 2:return i.sent(),[3,5];case 3:return[4,this.initializeQuill(window.Quill)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},e.getFormatPath=function(t){return"".concat(e.quillFormatsPath,"/").concat(t)},e.prototype.updateOptions=function(t){if(m.fF.assertValue(t,"options"),this.initialized){this.options=t;var i=this.toolbar;i&&i.updateOptions(t),this.smartNarrativesEditorContainer&&this.smartNarrativesEditorContainer.updateOptions(t)}},e.prototype.initializeQuill=function(t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(i){switch(i.label){case 0:return this.quillStatic=t,[4,this.rebuildQuillEditor()];case 1:return i.sent(),this.initialized=!0,this.quillStatic.debug("error"),[2]}})})},e.prototype.getElement=function(){return this.$container},e.prototype.getContents=function(){if(this.initialized)return this.editor.getContents()},e.prototype.setContents=function(t){var i=this;m.fF.assert(function(){return i.initialized},"initialized"),this.editor&&this.editor.setContents(t)},e.prototype.resize=function(t){this.$container.width(t.width),this.$container.height(t.height),this.updateToolbar()},e.prototype.setSelection=function(t,i){this.editor&&this.editor.setSelection(t,i)},e.prototype.getSelection=function(t){if(this.editor)return this.editor.getSelection(t)},e.prototype.focus=function(){this.editor&&0===$(document.activeElement).closest(this.$container).length&&this.editor.focus()},e.prototype.destroy=function(){this.host.setToolbar(null),this.toolbar=null,this.$container.remove(),this.$container=null,this.destroyEditor()},e.prototype.destroyEditor=function(){this.editor&&(_.isEmpty(this.destroyEditorActions)||(_.forEach(this.destroyEditorActions,function(t){return t()}),this.destroyEditorActions=void 0),this.editor=null)},e.prototype.getSelectionAtCursor=function(){var t=this.getTextWithoutTrailingBreak(),i=this.getSelection(!0);if(i&&0===i.length){var n=(0,Ce.sE)(i.index,t);return{index:n.start,length:n.end-n.start}}return i},e.prototype.getWord=function(){var t=this.getSelectionAtCursor();return this.getTextWithoutTrailingBreak().slice(t.index,t.index+t.length)},e.prototype.getEditorContainer=function(){if(this.editor)return $(this.editor.container)},e.prototype.setSelectionOfConditional=function(t){var i=this.getContents();if(i)for(var n=0,r=0,o=i.ops;r<o.length;r++){var s=o[r];if(!s)return void m.fF.assertFail("ops should not be undefined");if(_.isString(s.insert))n+=s.insert.length;else if(_.isNumber(s.insert))n+=1;else{n+=1;var l=ft(s,e.smartNarrativesConditionalBlotClass.class);if(l?.conditionalIndex===t){this.setSelection(n,0);break}}}},e.computeTransparentSmartNarrativesColor=function(t){var i=(0,Pt.WV)(t);return i.A=e.smartNarrativesPlaceholderOpacity,(0,Pt.U8)(i)},e.prototype.getTextWithoutTrailingBreak=function(){return this.editor.getText().slice(0,-1)},e.prototype.rebuildQuillEditor=function(){var t;return(0,y.mG)(this,void 0,void 0,function(){var i,n,r,o,a,s,l,u,h,c,v,f,p,g,E,F,k,C,b,S=this;return(0,y.Jh)(this,function(V){switch(V.label){case 0:return i=null,n=this.options.supportsNarrativeExpressions,this.editor&&(i=this.editor.getContents()),this.$container.empty(),this.$container.keydown(function(x){var A=x.which;x.ctrlKey&&(0,at.iZ)(A)&&x.stopPropagation(),((0,at.Wl)(A)||(0,at.SF)(A))&&x.stopPropagation(),(0,at.rH)(A)&&x.stopPropagation(),ge.M.isCtrlOrMeta(x)&&117===x.keyCode&&(S.focusToolbar(),x.stopPropagation())}),r=$("<div>"),a={readOnly:this.readOnly,formats:["bold","italic","underline","font","size","link","align","color","indent","script","list"],modules:{history:{userOnly:!0},keyboard:{bindings:{}}},placeholder:this.placeholderText},s=this.host.getUIComponentFactory(),l=[],this.supportsAtMention?(this.setupAtMentionFormat(),o=$("<div>"),l.push({mentionCharacter:"@",blotName:e.atMentionBlotClass.class,initialize:function(A,M){o.addClass(e.atMentionContainerClass.class).hide(),S.userSuggestionsComponent=A.createUserSuggestions(o.get(0),function(z){M({displayName:z.displayName,email:z.email,hoverContainer:S.$mentionsHoverContainer,personCardComponent:S.personCardComponent})})},hideSuggestions:function(){return o.hide(),S.userSuggestionsComponent.hideSuggestions()},renderSuggestions:function(A,M,q){o.css({left:M,top:q}).show(),S.userSuggestionsComponent.showSuggestions(A)},pickSuggestion:function(){return S.userSuggestionsComponent.pickSuggestion()},navigateSuggestions:function(A){return S.userSuggestionsComponent.navigateSuggestions(A)}}),a.formats.push(e.atMentionBlotClass.class),a.modules.keyboard.bindings.enter={handler:u=function(){for(var A=!0,M=0,q=l;M<q.length;M++)A=q[M].pickSuggestion();return A},key:13},a.modules.keyboard.bindings.tab={handler:u,key:9}):this.hierarchicalTabbing&&(a.modules.keyboard.bindings.tab={handler:function(){return!0},key:9}),_.isEmpty(l)||(a.modules.mention={save:function(){return S.saveState()},mentions:l,maxSearchLength:kt,componentFactory:s},this.registerMentionModule()),n&&(a.formats.push(e.smartNarrativesBlotClass.class),a.formats.push(e.smartNarrativesConditionalBlotClass.class),a.formats.push(e.smartNarrativesFocusFormatAttributeName)),h=ee(this.localizationProvider),c=Bt.buildNode(h),this.readOnly?[3,4]:(v=this.toolbar,this.toolbar?[3,2]:(f=this,[4,Xt.createToolbar(this.host,this,this.localizationProvider,c,this.options)]));case 1:return v=f.toolbar=V.sent(),(F=v.getElement()).addClass("unselectable"),F.toggleClass("high-contrast",this.style.isHighContrast),a.modules.toolbar={container:F.get(0)},[3,3];case 2:v.updateOptions(this.options),V.label=3;case 3:r.attr("drag-resize-disabled","true"),V.label=4;case 4:return this.destroyEditor(),this.destroyEditorActions=[],n&&(this.setUpSmartNarrativesFormat(),this.setUpSmartNarrativesConditionalFormat(),this.setUpSmartNarrativesFocusFormat()),this.editor=new this.quillStatic(r.get(0),a),this.readOnly||(p=new Bt(c,this.editor,this.quillStatic,this.toolbar,this.options.featureSwitches),g=function(A){A?(S.editor.setSelection(S.getSelectionAtCursor()),p.open()):p.remove()},e.setUpFontFormat(this.quillStatic),(E=this.editor.getModule("toolbar")).addHandler("link",g),s&&(F=this.toolbar.getElement(),k=new Z({quill:this.editor,uiComponentFactory:s,$colorSwatch:F.find(Z.colorSwatchGlyphClassAndSelector.selector),$colorPickerButton:F.find(Z.pickerButtonClassAndSelector.selector),$colorPickerButtonWrapper:F.find(Z.pickerButtonWrapperClassAndSelector.selector),defaultColor:tt.v.getThemeColor(this.style,ve.fA),format:"color"}),E.addHandler("color",function(){return k.applyFormat(k.getColor())})),this.destroyEditorActions.push(function(){E.addHandler("link",void 0),E.addHandler("color",void 0)}),n&&s&&(this.smartNarrativesEditorContainer=new le({container:this.toolbar.getElement(),destroyEditorActions:this.destroyEditorActions,evaluatedValues:this.options.evaluatedValues,hostServices:this.host,localizationProvider:this.localizationProvider,onEditSmartNarrativePersist:this.textChanged,quill:this.editor,style:this.style,toolbar:this.toolbar}),this.smartNarrativesEditorContainer.getSmartNarrativesEditor()),this.supportsFormattingChangeIndication&&(this.formattingSettingsContainer=new ue({container:this.toolbar.getElement(),hostServices:this.host}),this.formattingSettingsContainer.getTextboxFormattingSettings()),this.updateToolbar()),this.$container?(this.$container.append(r),this.$mentionsHoverContainer&&this.$container.append(this.$mentionsHoverContainer),o&&this.$container.append(o),i&&this.setContents(i),n||this.supportsFormattingChangeIndication?(this.editor.keyboard.addBinding({key:83,shiftKey:!0,shortKey:!0},void 0,function(){S.saveState()}),this.editor.on("text-change",C=function(A,M,q){"api"!==q&&(S.isDirty=!0)}),this.destroyEditorActions.push(function(){S.editor.off("text-change",C),C=void 0})):this.throttleTextChanged(),this.supportsFormattingChangeIndication&&!(null===(t=this.formattingSettingsContainer.getTextboxFormattingSettings())||void 0===t)&&t.shouldListenToTextChanged()&&this.throttleTextChanged(),this.editor.root.addEventListener("blur",b=function(A){var M=A.relatedTarget||document.activeElement;M&&(S.targetIsInToolbar(M,n)||((n||S.supportsFormattingChangeIndication)&&S.saveState(),e.willBrowserHandleFocus(M)))||S.setSelection(null,null)},!1),this.destroyEditorActions.push(function(){S.editor.root.removeEventListener("blur",b,!1)}),[2]):[2]}})})},e.prototype.throttleTextChanged=function(){var i,t=this,n=_.debounce(function(){return t.onTextChanged()},null!==(i=this.options.textChangeThrottle)&&void 0!==i?i:e.textChangeThrottle),r=function(a,s,l){if("api"!==l){t.isDirty=!0;for(var u=0,d=a.ops;u<d.length;u++){var h=d[u];if(e.isInsertOp(h)){var c=h.insert;if(c&&(0,_t.Oi)(c))return t.onTextChanged(),void n.cancel()}}n()}};this.editor.on("text-change",r),this.destroyEditorActions.push(function(){t.editor.off("text-change",r),n.cancel(),n=void 0}),this.onPaste&&this.$container.on("paste",function(){return setTimeout(function(){return t.onPaste()},0)})},e.setUpFontFormat=function(t){var i=t.import("parchment"),n=t.import(e.getFormatPath("font"));n.value=function(r){var o=e.camelize(n.keyName);return _.escape((0,W._b)(r.style[o]))},n.canAdd=function(r,o){return null!=i.query(r,i.Scope.BLOT&(n.scope|i.Scope.TYPE))&&(null==n.whitelist||n.whitelist.indexOf((0,W._b)(_.unescape(o)))>-1)},n.add=function(r,o){if(!n.canAdd(r,o))return!1;var a=e.camelize(n.keyName),s=(0,W._b)(_.unescape(o));return r.style[a]=s,!0}},e.prototype.isFormatRegisteredWithQuill=function(t){m.fF.assertValue(this.quillStatic,"quillStatic");var i=this.quillStatic.imports;return!_.isEmpty(i)&&!!i[e.getFormatPath(t)]},e.prototype.setUpSmartNarrativesFormat=function(){if(!this.isFormatRegisteredWithQuill(e.smartNarrativesBlotClass.class)){var i=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return(0,y.ZT)(r,n),r.create=function(o){m.fF.assertValue(o,"options");var l,a=n.create.call(this,o.objRef),s=tt.v.getDataColorByIndex(o.style,0);if(o.objRef===nt){l=this.placeholderText;var u=e.computeTransparentSmartNarrativesColor(s);$(a).addClass(e.smartNarrativesPlaceholderClass.class).css("background-color",u)}else{l=(0,P.YA)(o.objRef,o.evaluatedValues)||"";var d="".concat(D.NN).concat(e.smartNarrativesBlotClass.selector);o.destroyEditorActions&&($(a).on(d,function(){o.onSelectSmartNarrativesBlot(o.objRef)}),o.destroyEditorActions.push(function(){$(a).off(d)}))}return $(a).attr(e.smartNarrativesBlotClass.class,o.objRef).attr(D.bd,"false").css("border-bottom","1px solid ".concat(s)).data(e.smartNarrativesBlotClass.class,o),l?$(a).text(l):e.appendHiddenSmartNarrativesDisplay(a,o.localizationProvider.get("Visual_SmartNarratives_TextBox_Hidden")),a},r.value=function(o){return $(o).data(e.smartNarrativesBlotClass.class)},r.blotName=e.smartNarrativesBlotClass.class,r.className=e.smartNarrativesBlotClass.class,r.placeholderText="                ",r.tagName="span",r}(this.quillStatic.import("blots/embed"));this.quillStatic.register(i)}},e.prototype.setUpSmartNarrativesConditionalFormat=function(){if(!this.isFormatRegisteredWithQuill(e.smartNarrativesConditionalBlotClass.class)){var i=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return(0,y.ZT)(r,n),r.create=function(o){if(m.fF.assertValue(o,"options"),(0,P.ki)(o.definition)){var a=n.create.call(this,o.objRef),s="".concat(D.NN).concat(e.smartNarrativesConditionalBlotClass.selector);$(a).attr(e.smartNarrativesConditionalBlotClass.class,o.objRef).attr(D.bd,"false").data(e.smartNarrativesConditionalBlotClass.class,o);for(var l=!1,u=(0,P.kO)(o.definition,o.evaluatedValues),d=tt.v.getDataColorByIndex(o.style,0),h=function(g){var E=$("<span>");if((0,lt.U)(g.value)){var F=g.value.selector.id,k=(0,P.YA)(F,o.evaluatedValues);if(!k)return"continue";var O=k;E.addClass(e.smartNarrativesBlotClass.class).css("border-bottom","1px solid ".concat(d)).text(O),o.destroyEditorActions&&(E.on(s,function(){o.onSelectSmartNarrativesBlot(F)}),o.destroyEditorActions.push(function(){E.off(s)}))}else g.value===L.d$?(E.text(L.mj),l=!0):E.text(g.value);$(a).append(E)},c=0,v=u;c<v.length;c++)h(v[c]);return 0===a.childElementCount?e.appendHiddenSmartNarrativesDisplay(a,o.localizationProvider.get("Visual_SmartNarratives_TextBox_Hidden")):a.innerText===L.mj&&($(a).addClass(e.smartNarrativesNewlineClass.class).attr(D.bd,"true").empty().text(L.mj),l&&$(a).addClass(e.smartNarrativesHiddenClass.class)),o.destroyEditorActions&&($(a).on(s,function(){o.onSelectSmartNarrativesConditionalBlot(o.conditionalIndex)}),o.destroyEditorActions.push(function(){$(a).off(s)})),a}},r.value=function(o){return $(o).data(e.smartNarrativesConditionalBlotClass.class)},r.blotName=e.smartNarrativesConditionalBlotClass.class,r.className=e.smartNarrativesConditionalBlotClass.class,r.tagName="span",r}(this.quillStatic.import("blots/embed"));this.quillStatic.register(i)}},e.prototype.setUpSmartNarrativesFocusFormat=function(){var t,i=e.getFormatPath(e.smartNarrativesFocusFormatAttributeName);if(!this.isFormatRegisteredWithQuill(i)){var n=this.quillStatic.import(e.getFormatPath("background"));n.attrName=e.smartNarrativesFocusFormatAttributeName,this.quillStatic.register(((t={})[i]=n,t))}},e.prototype.setupAtMentionFormat=function(){if(!this.isFormatRegisteredWithQuill(e.atMentionBlotClass.class)){var i=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return(0,y.ZT)(r,n),r.create=function(o){var a;m.fF.assertValue(o,"options");var s=n.create.call(this,o.email);return $(s).attr(e.atMentionBlotClass.class,o.email).attr(D.bd,"false").data(e.atMentionBlotClass.class,o).on(D.Wo,function(){o.personCardComponent.showUser(o.email);var l=s.getBoundingClientRect();o.hoverContainer.stop(!0,!0).css({left:s.offsetLeft,top:s.offsetTop-l.height-r.topPaddingOffset}).delay(200).queue(function(u){$(s).is(":hover")&&o.hoverContainer.fadeIn("fast"),u()})}).on(D.xw,function(){o.hoverContainer.delay(500).queue(function(l){!function d(h){o.hoverContainer.is(":hover")?setTimeout(function(){return d(h)},500):h()}(l)}).fadeOut("fast")}).css("color","#1453b3").text(null!==(a="@"+o.displayName)&&void 0!==a?a:o.email),s},r.value=function(o){return $(o).data(e.atMentionBlotClass.class)},r.blotName=e.atMentionBlotClass.class,r.className=e.atMentionBlotClass.class,r.tagName="span",r.topPaddingOffset=24,r}(this.quillStatic.import("blots/embed"));this.quillStatic.register(i)}},e.prototype.registerMentionModule=function(){this.quillStatic.imports["modules/mention"]||this.quillStatic.register("modules/mention",function(){function i(n,r){var o=this;this.options=r,this.quill=n,m.fF.assert(function(){return!_.isEmpty(r.mentions)},"No mention configuration"),n.on("text-change",function(d,h,c){return o.onTextChange(d,h,c)});for(var a=function(h){m.fF.assert(function(){return 1===h.mentionCharacter.length},"Expected single mention character"),h.initialize(r.componentFactory,function(c){return o.insertBlot(h.blotName,c)})},s=0,l=r.mentions;s<l.length;s++)a(l[s]);this.addKeyBindings()}return i.prototype.addKeyBindings=function(){var n=this,r=function(s){for(var l=!0,u=0,d=n.options.mentions;u<d.length;u++)l=d[u].navigateSuggestions(s);return l};this.quill.keyboard.addBinding({key:40},void 0,function(){return r(0)}),this.quill.keyboard.addBinding({key:38},void 0,function(){return r(1)}),this.quill.keyboard.addBinding({key:27},void 0,function(){return function(){for(var s=!0,l=0,u=n.options.mentions;l<u.length;l++)s=u[l].hideSuggestions();return s}()})},i.prototype.onTextChange=function(n,r,o){var a;if("user"===o){this.insertPosition=void 0,this.currentPosition=void 0;var s=this.quill.getSelection();if(s){this.currentPosition=s.index;var l=Math.max(0,this.currentPosition-this.options.maxSearchLength),u=this.quill.getText(l,this.currentPosition-l),d=(a=this.getMentionConfig(u)).mentionConfig,h=a.mentionCharacterPosition;if(!d)return void this.hideAllSuggestions();for(var c=u.substring(h+1),v=0,f=this.options.mentions;v<f.length;v++){var p=f[v];p!==d&&p.hideSuggestions()}this.insertPosition=this.currentPosition-c.length-1;var g=this.quill.getBounds(this.insertPosition),E=this.quill.root.getBoundingClientRect(),F=Math.min(g.left,E.width-i.SuggestionWidth);d.renderSuggestions(c,F,g.height+g.bottom)}}},i.prototype.getMentionConfig=function(n){for(var r=0,o=this.options.mentions;r<o.length;r++){var a=o[r],s=n.lastIndexOf(a.mentionCharacter);if(-1!==s)return{mentionConfig:a,mentionCharacterPosition:s}}return{mentionConfig:void 0,mentionCharacterPosition:-1}},i.prototype.insertBlot=function(n,r){this.hideAllSuggestions(),!_.isNil(this.insertPosition)&&!_.isNil(this.currentPosition)&&(this.quill.deleteText(this.insertPosition,this.currentPosition-this.insertPosition,"api"),this.quill.insertEmbed(this.insertPosition,n,r,"api"),this.quill.setSelection(this.insertPosition+1,0,"api"),this.options.save())},i.prototype.hideAllSuggestions=function(){for(var n=0,r=this.options.mentions;n<r.length;n++)r[n].hideSuggestions()},i.SuggestionWidth=200,i}())},e.willBrowserHandleFocus=function(t){return"SELECT"===t.tagName||"INPUT"===t.tagName||!!t.getAttribute("contentEditable")},e.prototype.targetIsInToolbar=function(t,i){if(!this.toolbar)return!1;if("A"===t.tagName||"BUTTON"===t.tagName||i){var n=$(t),r=this.toolbar.getElement();return r.is(":visible")&&(n.is(r)||n.closest(r).length>0)}return!1},e.prototype.onTextChanged=function(){var t;this.textChanged(),this.supportsFormattingChangeIndication&&(null===(t=this.formattingSettingsContainer.getTextboxFormattingSettings())||void 0===t||t.onTextChanged())},e.prototype.saveState=function(){var t,i;null===(i=null===(t=this.editor)||void 0===t?void 0:t.history)||void 0===i||i.clear(),this.onTextChanged()},e.isInsertOp=function(t){return null!=t.insert},e.camelize=function(t){var i=t.split("-"),n=_.map(i.slice(1),function(r){return r[0].toUpperCase()+r.slice(1)}).join("");return i[0]+n},e.prototype.focusToolbar=function(){if(!this.editor||!this.toolbar)return!1;X.IK.focusChildInGroup(this.toolbar.getElement().get(0))},e.appendHiddenSmartNarrativesDisplay=function(t,i){var n=$("<span>"),r=$("<span>"),o=$("<span>");n.text("["),r.addClass("glyphicon glyph-mini pbi-glyph-hide3"),o.text("]"),$(t).addClass(e.smartNarrativesHiddenClass.class).append(n,r,o).attr("title",i)},e.prototype.updateToolbar=function(){var t;if(this.toolbar){var i=null===(t=this.options)||void 0===t?void 0:t.supportsNarrativeExpressions;this.host.setToolbar(this.toolbar.getElement(),{preferHorizontalLayout:i,theme:i?"neutralGrayTheme":"darkTheme"})}},e.quillFormatsPath="formats",e.atMentionBlotClass=(0,w.CH)("at-mention"),e.atMentionContainerClass=(0,w.CH)("mentions-container"),e.smartNarrativesBlotClass=(0,w.CH)("smart-narratives-blot"),e.smartNarrativesConditionalBlotClass=(0,w.CH)("smart-narratives-conditional-blot"),e.smartNarrativesFocusFormatAttributeName="smartNarrativesFocus",e.smartNarrativesHiddenClass=(0,w.CH)("smart-narratives-hidden"),e.smartNarrativesNewlineClass=(0,w.CH)("smart-narratives-newline"),e.smartNarrativesPlaceholderClass=(0,w.CH)("placeholder"),e.smartNarrativesPlaceholderOpacity=.2,e.textChangeThrottle=600,e}(),Xt=function(){function e(t,i,n,r,o){this.host=t,this.quillWrapper=i,this.localizationProvider=n,this.linkInput=r}return e.createToolbar=function(t,i,n,r,o){return(0,y.mG)(this,void 0,void 0,function(){var a;return(0,y.Jh)(this,function(s){switch(s.label){case 0:return[4,(a=new e(t,i,n,r,o)).init(n,o)];case 1:return s.sent(),[2,wt.J.resolve(a)]}})})},e.prototype.init=function(t,i){return(0,y.mG)(this,void 0,void 0,function(){var n,r,o,a,s,l,u,d,h,c,v,f,p,g,E,F,k,O,C;return(0,y.Jh)(this,function(b){switch(b.label){case 0:return this.featureSwitches=i.featureSwitches,this.updateOptions(i),n=i.hierarchicalTabbing?"Hierarchy":"Group",r=Z.buildFontColorButtons(t.get("Visual_FontColor"),t.get("Visual_FontColor_Picker"),i.onRenderTooltip),o=this.container=R().addClass("toolbar").addClass("themeableElement").attr("aria-label",U("FontControl",t)).attr("focus-nav-mode",n),a=I(),_.size(this.fontFamilies)>1&&a.append(this.fontFamilyPicker),_.size(this.fontSizes)>1&&a.append(this.fontSizePicker),s=K(i.onRenderTooltip,U("Bold",t),"bold",void 0,void 0,void 0),l=K(i.onRenderTooltip,U("Italic",t),"italic",null,"italic",!0),u=K(i.onRenderTooltip,U("Underline",t),"underline",void 0,void 0,void 0),d=K(i.onRenderTooltip,U("BulletedList",t),"list","bullet","bulletedlist",!0),h=K(i.onRenderTooltip,U("NumberedList",t),"list","ordered","numberedlist",!0),c=U("Link",t),v=K(i.onRenderTooltip,c,"link",void 0,void 0,void 0),f=R().addClass("toolbar-content"),this.featureSwitches&&this.featureSwitches.onObject?(o.addClass("on-object"),f.addClass("on-object"),p=R().append(a),g=R().append(I().append(s).append(l).append(u)).append(I().append(this.textAlignmentGroup)).append(r),this.featureSwitches.textboxSuperSubScriptBulletedList&&(p.append(I().append(d)).append(I().append(h)),g.append(I().append(this.textScriptGroup))),p.append(I().append(this.textIndentGroup)),E=R().append(p).append(g),f.append(E).append(Et()),F=this.host.getUIComponentFactory(),(O=F)?[4,this.getAddLinkContainer(c,F)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:return(k=O)&&f.append(k).append(Et()),[3,4];case 3:a.append(r),f.append(a).append(I().append(s).append(l).append(u)).append(I().append(this.textAlignmentGroup)).append(I().append(this.textIndentGroup)).append(I().append(v).append(this.linkInput)),this.featureSwitches&&this.featureSwitches.textboxSuperSubScriptBulletedList&&(f.append(I().append(this.textScriptGroup)).append(I().append(d)).append(I().append(h)),f.css("width",this.getWidth()+"px")),b.label=4;case 4:return o.append(f),i.supportsNarrativeExpressions&&(f.addClass("fixed-size"),o.append(ie())),i.supportsFormattingChangeIndication&&!this.quillWrapper.readOnly&&o.append(ne()),(C=this.onEscape)&&o.on("keydown",function(S){27===S.keyCode&&(S.stopPropagation(),S.preventDefault(),C())}),[2]}})})},e.prototype.getAddLinkContainer=function(t,i){return(0,y.mG)(this,void 0,void 0,function(){var n;return(0,y.Jh)(this,function(s){switch(s.label){case 0:return n=I(),[4,new ce({inputArgs:{disabled:!1,iconName:"WebGetLink_16",iconColors:[""],label:t,title:t},outputArgs:{clicked:function(){},ready:function(){}},uiComponentFactory:i}).attach(n)];case 1:return s.sent(),n.find("button").addClass("ql-link"),n.append(this.linkInput),[2,wt.J.resolve(n)]}})})},e.prototype.getElement=function(){return this.container},e.prototype.updateOptions=function(t){m.fF.assertValue(t,"options");var i=t.defaultFont;this.onEscape=t.onEscape,this.updateFontFamilyUI(i,t.fontFamilies,t.onRenderTooltip),this.updateFontSizeUI(i,t.fontSizes,t.onRenderTooltip),this.updateTextAlignmentUI(t.onRenderTooltip),this.updateTextIndent(t.onRenderTooltip),this.featureSwitches&&this.featureSwitches.textboxSuperSubScriptBulletedList&&this.updateTextScriptUI(t.onRenderTooltip)},e.prototype.updateFontSizeUI=function(t,i,n){var r="size",o=B.getFormatPath(r);this.updateStyleAllowList(this.quillWrapper.quillStatic,r,null,o,!0),this.fontSizes=_.map(i,function(a){return{label:"".concat(a),value:"".concat(a,"pt")}}),this.defaultFontSize="".concat(t.size.pt,"pt"),this.fontSizePicker?Ft(this.fontSizePicker,this.fontSizes,this.defaultFontSize):this.fontSizePicker=xt(U("Size",this.localizationProvider),this.fontSizes,"size",this.defaultFontSize,n)},e.prototype.updateFontFamilyUI=function(t,i,n){var r="font",o=i.map(function(s){return(0,W._b)(J(s))}),a=B.getFormatPath(r);this.updateStyleAllowList(this.quillWrapper.quillStatic,r,o,a,!0),this.fontFamilies=_.map(i,function(s){return{label:s,value:_.escape((0,W._b)(J(s)))}}),this.defaultFontFamily=_.escape((0,W._b)(J(t.family))),this.fontFamilyPicker?Ft(this.fontFamilyPicker,this.fontFamilies,this.defaultFontFamily):this.fontFamilyPicker=xt(U("Font",this.localizationProvider),this.fontFamilies,"font",this.defaultFontFamily,n,function(s,l){return s.css("font-family",l.value),s})},e.prototype.updateTextAlignmentUI=function(t){var n=this.defaultTextAlignment=$t;this.textAlignments=_.map(It,function(s){var l=s.toLowerCase();return{label:s,value:s===n?"":l,glyph:"align".concat(l)}});var o=_.map(this.textAlignments,function(s){return s.value}),a=B.getFormatPath("align");this.updateAllowList(this.quillWrapper.quillStatic,a,o),this.textAlignmentGroup||(this.textAlignmentGroup=pt(0,this.textAlignments,"align",0,this.localizationProvider,!1,t))},e.prototype.updateTextIndent=function(t){this.textIndent=_.map(Ot,function(n){return{label:"".concat("+1"===n?"Increase":"Decrease","Indent"),value:n,glyph:"+1"===n?"increaseindent":"decreaseindent"}}),this.textIndentGroup||(this.textIndentGroup=pt(0,this.textIndent,"indent",0,this.localizationProvider,!0,t))},e.prototype.updateTextScriptUI=function(t){this.textScripts=_.map(ut,function(a){var s=a.toLowerCase();return{label:a,value:s,glyph:s+"script"}});var r=_.map(this.textScripts,function(a){return a.value}),o=B.getFormatPath("script");this.updateAllowList(this.quillWrapper.quillStatic,o,r),this.textScriptGroup||(this.textScriptGroup=pt(0,this.textScripts,"script",0,this.localizationProvider,!0,t))},e.prototype.updateStyleAllowList=function(t,i,n,r,o){void 0===o&&(o=!1),this.updateAllowList(t,"attributors/style/"+i,n,r,o)},e.prototype.updateAllowList=function(t,i,n,r,o){void 0===o&&(o=!1);var a=t.import(i);m.fF.assertValue(a,'No attributor was found in the path "'+i+'"'),a.whitelist=n,t.register(r||i,a,o)},e.prototype.getWidth=function(){return 750},e}();function te(e,t,i,n){return $('\n                        <a href="#" class="ql-preview" target="_blank"></a>\n                        <input class="input" type="text" aria-label="'.concat(n,'">\n                        <span class="bar">&nbsp;|&nbsp;</span>\n                        <button class="ql-action ql-save">').concat(t,'</button>\n                        <button class="ql-action ql-edit">').concat(i,'</button>\n                        <button class="ql-remove">').concat(e,"</button>\n                    "))}function ee(e){var t=R(),i=e.get("RichTextbox_Link_Done"),n=e.get("RichTextbox_Link_Remove"),r=e.get("RichTextbox_Link_Edit"),o=U("Link",e);return t.append(te(n,i,r,o)),t.html()}function I(){return re().addClass("ql-formats")}function ie(){return R().addClass(Nt.class)}function ne(){return R().addClass(At.class)}function R(){return $("<div>")}function re(){return $("<span>")}function oe(){return $("<button>")}function pt(e,t,i,n,r,o,a){return t.map(function(l){var u=null!=l.glyph?l.glyph:i+l.value;return K(a,U(l.label,r),i,l.value,u,o)})}function xt(e,t,i,n,r,o){return ae(e,t,r,n,o).addClass("ql-"+i+" ql-picker")}function Ft(e,t,i,n){return se(e,t,i,n)}function ae(e,t,i,n,r){var o=$("<select>").attr("aria-label",e).addClass("themeableElementCustom").append(Tt(t,n,r));return rt(o,e,i),o}function se(e,t,i,n){return e.empty().append(Tt(t,i,n))}function Tt(e,t,i){return _.map(e,function(n){var r=$("<option>").text(n.label);return n.value===t?r.attr("selected","selected"):r.attr("value",n.value),void 0!==i&&(r=i(r,n)),r})}function rt(e,t,i){var n;e.on("focus mouseenter",function(r){n=i(e.get(0),t)}),e.on("blur mouseleave",function(r){n&&n.close(),n=null}),e.on("keydown",function(r){n&&27===r.keyCode&&(event.stopPropagation(),event.preventDefault(),n.close(),n=null)})}function K(e,t,i,n,r,o){var a=oe();return a.attr("aria-label",t),rt(a,t,e),a.on("click",function(s){s.target.setAttribute("aria-pressed",a.hasClass("ql-active")?"false":"true")}),null!=i&&a.addClass("ql-"+i),null!=n&&a.attr("value",n),null==r&&(null!=i&&(r=i),null!=n&&(r=(r||"")+n)),a.addClass("themeableElementCustom"),null!=r&&o?(a.addClass("pbi-glyph-"+r),a.addClass(i),a.css("font-family","PowrMDL2")):a.addClass("powervisuals-glyph "+r),a}function U(e,t){return t.get("RichTextbox_"+e+"_ToolTip")}function Et(){return R().addClass("vertical-divider")}var Nt=(0,w.CH)("smart-narratives-editor"),At=(0,w.CH)("formatting-settings"),Bt=function(){function e(t,i,n,r,o){var a=this;m.fF.assertValue(t,"container must have a value"),m.fF.assertValue(i,"quill must have a value"),m.fF.assertValue(n,"quillStatic"),this.$container=t,this.quill=i,this.quillStatic=n,this.$preview=this.$container.find("a.ql-preview"),this.$textbox=this.$container.find("input[type=text]"),this.textbox=this.$textbox[0],this.$action=this.$container.find(".ql-action"),this.toolbar=r,this.hide(),this.featureSwitches=o,this.$textbox.on("keydown",function(s){13===s.keyCode?a.onSave(s):27===s.keyCode&&a.onHide(s)}),["click","touchstart"].forEach(function(s){a.$action.on(s,function(l){a.$container.hasClass(e.editingClass)?a.onSave(l):a.onEdit(l)}),a.$container.find(".ql-remove").on(s,function(l){return a.onRemove(l)})}),i.on("selection-change",function(s){var l;if(null!=s||!a.isEditing){if(a.toolbar.getElement().find(".toolbar-content > .ql-formats > button").each(function(c,v){$(v).attr("aria-pressed",$(v).hasClass("ql-active")?"true":"false")}),null!=s&&0===s.length){if(l=i.scroll.descendant(a.quillStatic.import(B.getFormatPath("link")),s.index),a.link=l[0],null!=a.link){var d={index:s.index-l[1],length:a.link.length()};return void(_.isEqual(a.range,d)||(a.range=d,a.show(),a.updateToolbarWidth()))}s.index>0&&i.scroll.descendant(a.quillStatic.import(B.getFormatPath("link")),s.index-1)[0]&&setTimeout(function(){return a.quill.format("link",!1)})}a.hide(),a.updateToolbarWidth()}})}return e.buildNode=function(t){return R().addClass(ye.toolbarUrlInput.class).append($(t))},e.prototype.onHide=function(t){this.hide(),this.stopEvent(t),this.updateToolbarWidth()},e.prototype.onSave=function(t){this.save(),this.stopEvent(t),this.updateToolbarWidth()},e.prototype.onEdit=function(t){this.edit(),this.stopEvent(t),this.updateToolbarWidth()},e.prototype.onRemove=function(t){this.remove(),this.stopEvent(t),this.updateToolbarWidth()},e.prototype.stopEvent=function(t){t.stopPropagation(),t.preventDefault()},e.prototype.edit=function(){this.isEditing=!0,this.$container.addClass(e.editingClass),this.$textbox.focus(),this.textbox.setSelectionRange(0,this.textbox.value.length)},e.prototype.open=function(){this.range=this.quill.getSelection(),this.show(),this.edit(),this.updateToolbarWidth()},e.prototype.hide=function(){this.range=this.link=null,this.$container.hide(),this.isEditing=!1},e.prototype.remove=function(){this.range=this.range||this.quill.getSelection(),this.quill.formatText(this.range,"link",!1,"user"),this.quill.setSelection(this.range,"silent"),this.hide(),this.updateToolbarWidth()},e.prototype.save=function(){var t=this.range,i=this.textbox.value;0===t.length&&(this.quill.insertText(this.range.index,i),this.quill.setSelection(this.range.index,i.length),t=this.range=this.quill.getSelection()),this.quill.formatText(t.index,t.length,"link",i,"user"),this.quill.setSelection(t,"silent"),this.link=this.quill.scroll.descendant(this.quillStatic.import(B.getFormatPath("link")),t.index)[0],this.show()},e.prototype.show=function(){this.isEditing=!1,this.$container.removeClass(e.editingClass),this.$container.show();var t,i=this.range=this.range||this.quill.getSelection();null!=this.link?t=this.link.formats().link:(t=this.quill.getText(i.index,i.length),t=Wt.format(t)),this.$textbox.val(t),this.$preview.text(t),this.$preview.attr("href",t)},e.prototype.updateToolbarWidth=function(){this.featureSwitches&&!this.featureSwitches.onObject&&this.toolbar.getElement().find(".toolbar-content").css("width",this.toolbar.getWidth()+this.getWidth()+"px")},e.prototype.getWidth=function(){return this.$container.get(0).offsetWidth},e.editingClass="ql-editing",e}(),Z=function(){function e(t){var i=this;m.fF.assertValue(t,"options"),this.quill=t.quill,this.uiComponentFactory=t.uiComponentFactory,this.$colorSwatch=t.$colorSwatch,this.$colorPickerButtonWrapper=t.$colorPickerButtonWrapper,this.defaultColor=t.defaultColor,this.format=t.format,this.currentColor=t.defaultColor,this.setSwatch(this.currentColor),t.$colorPickerButton.on("click",function(n){n.stopPropagation(),i.toggle()})}return e.buildFontColorButtons=function(t,i,n){var r=$("<span></span>").addClass("powervisuals-glyph themeableElementCustom").addClass(e.colorGlyphClassAndSelector.class),o=$("<span></span>").addClass("powervisuals-glyph themeableElementCustom").addClass(e.colorSwatchGlyphClassAndSelector.class),a=$("<button>").addClass("ql-color themeableElementCustom").addClass(e.colorButtonClassAndSelector.class).attr("aria-label",t).val("false").append(r).append(o),s=$("<button>").addClass("colorpicker powervisuals-glyph chevrondown themeableElementCustom").addClass(e.pickerButtonClassAndSelector.class).attr("aria-label",i).val("false");return rt(a,t,n),rt(s,i,n),[a,$("<div>").addClass(e.pickerButtonWrapperClassAndSelector.class).append(s)]},e.prototype.onColorChange=function(t){this.currentColor.toUpperCase()!==t.toUpperCase()&&(this.setSwatch(t||this.defaultColor),this.applyFormat(t||null,this.range),this.currentColor=t)},e.prototype.onClose=function(){var t=this.ensureRange();this.quill.setSelection(t.index,t.length),this.quill.format(this.format,!!this.color&&this.color,"user")},e.prototype.getColor=function(){return this.currentColor},e.prototype.applyFormat=function(t,i){var n=this.ensureRange(i);this.color=t,t&&t!==this.defaultColor?(this.quill.formatText(n.index,n.length,this.format,t,"user"),this.quill.format(this.format,this.color,"user")):(this.quill.formatText(n.index,n.length,this.format,!1,"user"),this.quill.format(this.format,!1,"user"))},e.prototype.toggle=function(){this.range=this.ensureRange(),this.getColorPicker().toggle()},e.prototype.getColorPicker=function(){var t=this,i=this.$colorPickerButtonWrapper.get(0);return this.colorPicker=this.uiComponentFactory.createColorPicker(i.firstChild,{value:this.getRangeColor()},function(n){return t.onColorChange(n&&n.value)},function(){return t.onClose()}),this.colorPicker},e.prototype.getRangeColor=function(){var t=this.quill.getSelection();if(!t)return this.defaultColor;var i=this.quill.getFormat(t.index,t.length);return"string"==typeof i?.color?i.color:this.defaultColor},e.prototype.setSwatch=function(t){this.$colorSwatch.get(0).style.setProperty("color",t,"important")},e.prototype.ensureRange=function(t){return this.quill.focus(),t||this.quill.getSelection()||{index:0,length:0}},e.colorGlyphClassAndSelector=(0,w.CH)("fontcolor"),e.colorSwatchGlyphClassAndSelector=(0,w.CH)("fontcolorswatch"),e.colorButtonClassAndSelector=(0,w.CH)("fontcolorbutton"),e.pickerButtonClassAndSelector=(0,w.CH)("fontcolorpicker"),e.pickerButtonWrapperClassAndSelector=(0,w.CH)("fontcolorbutton-wrapper"),e}(),le=function(){function e(t){this.container=t.container,this.destroyEditorActions=t.destroyEditorActions,this.evaluatedValues=t.evaluatedValues,this.hostServices=t.hostServices,this.localizationProvider=t.localizationProvider,this.onEditSmartNarrativePersist=t.onEditSmartNarrativePersist,this.quill=t.quill,this.style=t.style,this.toolbar=t.toolbar,m.fF.assertValue(this.container,"container"),m.fF.assertValue(this.destroyEditorActions,"destroyEditorActions"),m.fF.assertValue(this.evaluatedValues,"evaluatedValues"),m.fF.assertValue(this.hostServices,"hostServices"),m.fF.assertValue(this.localizationProvider,"localizationProvider"),m.fF.assertValue(this.onEditSmartNarrativePersist,"onEditSmartNarrativePersist"),m.fF.assertValue(this.quill,"quill"),m.fF.assertValue(this.style,"style"),m.fF.assertValue(this.toolbar,"toolbar");var i=tt.v.getDataColorByIndex(t.style,0);this.focusColor=B.computeTransparentSmartNarrativesColor(i)}return e.prototype.getSmartNarrativesEditor=function(){var t=this;return this.component=this.component||this.hostServices.getUIComponentFactory().createSmartNarrativesEditor(this.container.find(Nt.selector).get(0),L.RL.values.expr,{onEditSmartNarrativeCancel:function(){return t.onEditSmartNarrativeCancel()},onEditSmartNarrativeFinish:function(n,r){return t.onEditSmartNarrativeFinish(n,r)},onEditSmartNarrativeStart:function(){return t.onEditSmartNarrativeStart()},onSmartNarrativeFocusChange:function(n,r){return t.onSmartNarrativeFocusChange(n,r)},onUpdateToolbar:function(n){return t.onUpdateToolbar(n)},onEscape:function(){return t.focusOnToolbar()}}),this.component},e.prototype.onGetSmartNarrativesBlot=function(t){var i={index:-1,op:void 0},n=this.quill.getContents();return n&&(i.op=_.find(n.ops,function(r){if(r){if(_.isString(r.insert))return i.index+=r.insert.length,!1;if(_.isNumber(r.insert))return i.index+=1,!1;var o=ft(r,B.smartNarrativesBlotClass.class);return i.index+=1,o?.objRef===t}return m.fF.assertFail("ops should not be undefined"),!1})),i},e.prototype.onEditSmartNarrativeCancel=function(){var t=-1,i=this.onGetSmartNarrativesBlot(nt);return i&&i.index>=0&&i.op&&(this.quill.removeFormat(i.index,1),this.quill.setSelection(t=i.index,0,"api")),t},e.prototype.onEditSmartNarrativeFinish=function(t,i){var n=this;m.fF.assertValue(t,"objRef");var r=this.onEditSmartNarrativeCancel();i?this.applyObjRefUpdate(i,function(s){var l=n.quill.getFormat(s);n.quill.removeFormat(s,1),n.insertSmartNarrativesBlot(t,s),n.quill.formatText(s,1,l,"api")}):(r<0&&(r=this.getInsertionIndex()),this.insertSmartNarrativesBlot(t,r)),this.onEditSmartNarrativePersist()},e.prototype.onEditSmartNarrativeStart=function(){this.onEditSmartNarrativeCancel();var t=this.getInsertionIndex();this.insertSmartNarrativesBlot(nt,t)},e.prototype.onSmartNarrativeFocusChange=function(t,i){var n=this;this.applyObjRefUpdate(t,function(a){var s=n.quill.getFormat(a,1);s.smartNarrativesFocus=i?n.focusColor:void 0,n.quill.formatText(a,1,s,"api")})},e.prototype.updateOptions=function(t){this.evaluatedValues=t.evaluatedValues},e.prototype.applyObjRefUpdate=function(t,i){var n=this.quill.getContents();if(n)for(var r=-1,o=0,a=n.ops;o<a.length;o++){var l=a[o];if(!l)return void m.fF.assertFail("ops should not be undefined");if(_.isString(l.insert))r+=l.insert.length;else if(_.isNumber(l.insert))r+=1;else{r+=1;var u=ft(l,B.smartNarrativesBlotClass.class);u?.objRef===t&&i(r)}}},e.prototype.getInsertionIndex=function(){var t=this.quill.getSelection(!0);return t?t.index:0},e.prototype.insertSmartNarrativesBlot=function(t,i){var n=this;this.quill.insertEmbed(i,B.smartNarrativesBlotClass.class,{destroyEditorActions:this.destroyEditorActions,evaluatedValues:this.evaluatedValues,localizationProvider:this.localizationProvider,objRef:t,onSelectSmartNarrativesBlot:function(a){n.getSmartNarrativesEditor().onSelectEditableObject(a)},style:this.style},"api"),this.quill.setSelection(i+1,0,"api")},e.prototype.onUpdateToolbar=function(t){this.hostServices.setToolbar(this.toolbar.getElement(),{preferHorizontalLayout:!0,theme:"neutralGrayTheme",dropdownOptions:t})},e.prototype.focusOnToolbar=function(){this.toolbar&&X.IK.focusChildInGroup(this.toolbar.getElement().get(0))},e}(),ue=function(){function e(t){this.container=t.container,this.hostServices=t.hostServices,m.fF.assertValue(this.container,"container"),m.fF.assertValue(this.hostServices,"hostServices")}return e.prototype.getTextboxFormattingSettings=function(){var t;return this.component=this.component||(null===(t=this.hostServices.getUIComponentFactory())||void 0===t?void 0:t.createTextboxFormattingSettings(this.container.find(At.selector).get(0))),this.component},e}(),ce=function(){function e(t){this.uiComponentFactory=t.uiComponentFactory,this.inputArgs=t.inputArgs,this.outputArgs=t.outputArgs,m.fF.assertValue(this.inputArgs,"inputArgs"),m.fF.assertValue(this.outputArgs,"outputArgs"),m.fF.assertValue(this.uiComponentFactory,"uiComponentFactory")}return e.prototype.attach=function(t){return(0,y.mG)(this,void 0,void 0,function(){return(0,y.Jh)(this,function(i){switch(i.label){case 0:return[4,this.uiComponentFactory.createMiniToolbarLargeButton(t.get(0),this.inputArgs,this.outputArgs)];case 1:return i.sent(),[2]}})})},e}()},80963:function(fe,Y,T){T.r(Y),T.d(Y,{createAlwaysUseSmallViewportTextboxViewModelAdapter:function(){return vt},createTextbox:function(){return X},createTextboxViewModelAdapter:function(){return ot}});var y=T(28241);function X(L){return new y.Textbox(L)}function ot(L){return new y.ViewModelAdapter(L)}function vt(){return new y.AlwaysUseSmallViewport}}}]);