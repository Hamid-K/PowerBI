"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["store-rating-dialog"],{17802:function($,g,i){i.r(g),i.d(g,{StoreRatingDialogModule:function(){return A}});var f=i(9623),d=i(81337),u=i(62458),v=i(35510),t=i(50423),h=i(5034),C=i(32293),S=i(65181),s=i(77476),y=i(59968),x=i(45051),R=i(53833),B=i(44511),_=i(44581),P=i(69437),I=i(85102);function M(e,a){1&e&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"p",3),t.\u0275\u0275elementEnd())}function O(e,a){if(1&e){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",7),t.\u0275\u0275listener("accessible-click",function(){var N=t.\u0275\u0275restoreView(o).$implicit,E=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(E.onSupportButtonClicked(N.type))}),t.\u0275\u0275pipe(1,"localize"),t.\u0275\u0275element(2,"pbi-office-icon",8)(3,"p",9),t.\u0275\u0275elementEnd()}if(2&e){var n=a.$implicit;t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,n.labelKey)),t.\u0275\u0275advance(2),t.\u0275\u0275property("name",n.iconName),t.\u0275\u0275advance(1),t.\u0275\u0275property("localize",n.labelKey)}}function b(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"p",4),t.\u0275\u0275elementStart(2,"div",5),t.\u0275\u0275template(3,O,4,5,"div",6),t.\u0275\u0275elementEnd()()),2&e){var o=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",o.supportButtons)}}function T(e,a){if(1&e){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"dialog-footer",10),t.\u0275\u0275listener("okAction",function(){t.\u0275\u0275restoreView(o);var c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.onOkButtonClicked())})("cancelAction",function(){t.\u0275\u0275restoreView(o);var c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.onCancelButtonClicked())}),t.\u0275\u0275elementEnd()}if(2&e){var n=t.\u0275\u0275nextContext().ngIf;t.\u0275\u0275property("okText",n.okButtonText)("cancelText",n.cancelButtonText)("hideCancel",n.hideCancelButton)}}function D(e,a){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"dialog-body"),t.\u0275\u0275template(2,M,2,0,"section",1),t.\u0275\u0275template(3,b,4,1,"section",1),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,T,1,3,"dialog-footer",2),t.\u0275\u0275elementContainerEnd()),2&e){var o=a.ngIf,n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o.contentType===n.RatingDialogContentType.Prompt),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.contentType===n.RatingDialogContentType.Support),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!o.hideFooter)}}var r=function(e){return e[e.Initial=0]="Initial",e[e.Prompt=1]="Prompt",e[e.Support=2]="Support",e}({}),l=function(e){return e[e.Support=0]="Support",e[e.Community=1]="Community",e[e.Idea=2]="Idea",e}({}),m=function(){function e(a,o,n){this.commandStore=a,this.dialogRef=o,this.localizationService=n,this.RatingDialogContentType=r,this.supportButtons=[{type:l.Support,labelKey:"AboutVisualDialog_Support",iconName:"OfficeAssistant_20"},{type:l.Community,labelKey:"TopNav_HelpMenu_Community",iconName:"BrowseGroups_20"},{type:l.Idea,labelKey:"GetData_SubmitAnIdea",iconName:"ClassSendFeedback_20"}],this.storeRatingVm$=new v.X({contentType:r.Initial,title:this.localizationService.get("StoreRating_Initial_Title"),okButtonText:this.localizationService.get("Yes"),cancelButtonText:this.localizationService.get("No"),hideCancelButton:!1,hideFooter:!1})}return e.prototype.onOkButtonClicked=function(){switch(this.storeRatingVm$.value.contentType){case r.Initial:this.storeRatingVm$.next({contentType:r.Prompt,title:this.localizationService.get("StoreRating_Prompt_Title"),okButtonText:this.localizationService.get("StoreRating_Rate_Button"),hideCancelButton:!0,hideFooter:!1,titleIcon:"pbi-glyph-circled-checkmark"});break;case r.Prompt:this.dialogRef.close({promptForRating:!0});break;default:u.fF.assertFail("No handlers defined for other scenarios")}},e.prototype.onCancelButtonClicked=function(){this.storeRatingVm$.value.contentType===r.Initial?this.storeRatingVm$.next({contentType:r.Support,title:this.localizationService.get("StoreRating_Support_Title"),hideCancelButton:!0,hideFooter:!0}):u.fF.assertFail("No handlers defined for other scenarios")},e.prototype.onSupportButtonClicked=function(a){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:switch(a){case l.Support:return[3,1];case l.Community:return[3,3];case l.Idea:return[3,5]}return[3,7];case 1:return[4,this.commandStore.Help.Support.execute()];case 2:case 4:case 6:return n.sent(),[3,8];case 3:return[4,this.commandStore.Community.Community.execute()];case 5:return[4,this.commandStore.Community.SubmitAnIdea.execute()];case 7:return u.fF.assertNever(a),[3,8];case 8:return[2]}})})},e.prototype.onCloseButtonClicked=function(){this.cancelStoreRatingPrompt()},e.prototype.onEscapeKey=function(){this.cancelStoreRatingPrompt()},Object.defineProperty(e.prototype,"ariaLabel",{get:function(){return this.storeRatingVm$.value.title},enumerable:!1,configurable:!0}),e.prototype.cancelStoreRatingPrompt=function(){this.dialogRef.close({promptForRating:!1})},e.\u0275fac=function(o){return new(o||e)(t.\u0275\u0275directiveInject(h.N6),t.\u0275\u0275directiveInject(C.so),t.\u0275\u0275directiveInject(S.o))},e.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["store-rating-dialog"]],hostAttrs:["role","dialog"],hostVars:1,hostBindings:function(o,n){1&o&&t.\u0275\u0275listener("keydown.esc",function(){return n.onEscapeKey()},!1,t.\u0275\u0275resolveDocument),2&o&&t.\u0275\u0275attribute("aria-label",n.ariaLabel)},decls:4,vars:8,consts:[[3,"title","oneLineWithEllipsis","focusInitialCloseButton","close"],[4,"ngIf"],[3,"okText","cancelText","hideCancel","okAction","cancelAction",4,"ngIf"],["localize","StoreRating_Prompt_Body"],["localize","StoreRating_Support_Body"],[1,"supportButtonRow"],["role","button","class","supportButton",3,"accessible-click",4,"ngFor","ngForOf"],["role","button",1,"supportButton",3,"accessible-click"],[3,"name"],[3,"localize"],[3,"okText","cancelText","hideCancel","okAction","cancelAction"]],template:function(o,n){1&o&&(t.\u0275\u0275elementStart(0,"dialog-header",0),t.\u0275\u0275listener("close",function(){return n.onCloseButtonClicked()}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(2,D,5,3,"ng-container",1),t.\u0275\u0275pipe(3,"async")),2&o&&(t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(1,4,n.storeRatingVm$).title)("oneLineWithEllipsis",!1)("focusInitialCloseButton",!0),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(3,6,n.storeRatingVm$)))},dependencies:[s.NgForOf,s.NgIf,y.X,x.A,R.H,B.g,_.t,P.m,s.AsyncPipe,I.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;padding:24px;box-sizing:border-box;width:400px}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-content:center}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]   .supportButton[_ngcontent-%COMP%]{width:90px;height:90px;display:flex;flex-direction:column;align-content:center;justify-content:center;border-radius:4px;margin:6px;padding:8px;cursor:pointer;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 2px 4px var(--colorNeutralShadowKey)}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]   .supportButton[_ngcontent-%COMP%]:hover{background-color:var(--button-default-hover-fill-color)}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]   .supportButton[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]   .supportButton[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{flex:1;margin:0;align-self:center;text-align:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}[_nghost-%COMP%]   .supportButtonRow[_ngcontent-%COMP%]   .supportButton[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{width:26px;height:26px;flex:1;align-self:center;margin-top:8px}'],changeDetection:0}),e}(),F=i(79061),k=i(67659),z=i(96327),w=i(42729),V=i(45411),A=function(){function e(){}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=t.\u0275\u0275defineInjector({imports:[s.CommonModule,F.v,z.F,w.c.withManifest([{componentIdentifier:f.O,componentType:m}]),k._,V.m]}),e}()}}]);