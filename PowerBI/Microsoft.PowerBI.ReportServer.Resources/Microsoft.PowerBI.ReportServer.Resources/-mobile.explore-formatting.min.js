(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["explore-formatting"],{45221:function(st,xe,b){"use strict";b.d(xe,{h:function(){return p}});var p=new(b(50423).InjectionToken)("FormattingObjectDefinitionsService")},87644:function(st,xe,b){"use strict";b.d(xe,{VO:function(){return T},Vj:function(){return S},ub:function(){return p}});var p="formattingService",T="formattingUIService",S=T},21302:function(st,xe,b){"use strict";b.d(xe,{Ol:function(){return S},mF:function(){return T},sn:function(){return p}});var ce=b(50423),p={type:3,name:"showFormatPane"},T={type:3,name:"showPageFormatPane"},S=new ce.InjectionToken("PropertyChangeIndicatorService")},92755:function(st,xe,b){"use strict";b.d(xe,{cY:function(){return Be},ks:function(){return rt}});var ce=b(81337),p=b(11547),T=b(59017),S=b(14172),ee=b(32379),K=b(61617);function rt(ge,ye,Q,ke,he,je,de){return{objectName:ye.objectName,uid:Q,formattingSource:ke,hasDynamicExpressionSupport:de?.isSet,canvasItems:he,propertySlice:{name:ye.propertyName,value:ge,type:ye.type,selector:ye.selector,altConstantValueSelector:ye.altConstantValueSelector},conditionalFormatting:!!de,visualUpdateSource:je}}function Be(ge,ye,Q){void 0===Q&&(Q=[]);for(var ke=[],he=function(ot){var vt=(0,p.of)([]),dt=(0,p.of)([]),_e=ot;_e&&Q.some(function(Qe){return Qe.objectName===_e.objectName&&(0,ee.fS)(Qe.selector,_e.selector)&&Qe.propertyName===_e.propertyName})||!_e||(vt=ge.selectTopLevelToggle(ot).pipe((0,S.U)(function(Qe){return Qe?[(0,ce.pi)((0,ce.pi)({},Qe.control.properties.descriptor),{originSource:Qe.originSource})]:[]})),dt=ge.selectSlice(ot).pipe((0,S.U)(function(Qe){return Qe?(0,K.i6)(Qe).map(function(U){return(0,ce.pi)((0,ce.pi)({},U),{originSource:Qe.originSource})}):[]}))),ke.push((0,T.aj)([vt,dt]).pipe((0,S.U)(function(Qe){var W;return null!==(W=_.find(Qe,function(M){return!_.isEmpty(M)}))&&void 0!==W?W:[]})))},je=0,de=ye;je<de.length;je++)he(de[je]);return(0,T.aj)(ke).pipe((0,S.U)(function(Re){return _.flatten(Re)}))}},78432:function(st,xe,b){"use strict";b.d(xe,{An:function(){return Q},Aw:function(){return ot},D1:function(){return Re},H8:function(){return $t},Ky:function(){return k},LF:function(){return he},N6:function(){return U},UV:function(){return je},Wx:function(){return vt},ce:function(){return fe},hy:function(){return dt},m7:function(){return Qe},nB:function(){return ye},nH:function(){return It},so:function(){return H},um:function(){return we},w7:function(){return de},wW:function(){return bt},zS:function(){return W},zh:function(){return ke}});var ce=b(81337),p=b(9215),T=b(61617),S=b(50550),ee=b(62458),K=b(32379),rt=b(10746),Oe=b(5265),Be=b(80981),ge="___",ye="container-object-name";function Q(O,B){switch(O){case"VisualizationPane_Section_Analytics":return"VisualizationPane_Section_Analytics";case"Button":return"Button";case"Format_Label_General":return B.featureSwitches.onObject?"Properties":"Format_Label_General";case"Group":return"Group";case"Image":return"Image";case"Page":return"Page";case"BasicShape_ToolTip":return"BasicShape_ToolTip";case"Visual":return"Visual";default:ee.fF.assertNever(O)}}function ke(O){var B="".concat(ge).concat(O.objectName).concat(ge).concat(O.propertyName);return(0,T.$Q)(B,O.selector)}function he(O,B){return"".concat(B,"-").concat(O)}function je(O,B){return O.substring(B.length+1)}function de(O,B){var re=B[O.objectName],le=re?.properties[O.propertyName];return le}function we(O,B){var re=null;if(O){if((0,p.q4)(O))return Q("Group",B);re=O.config.singleVisual.visualType}switch(re){case"actionButton":return Q("Button",B);case"image":return Q("Image",B);case"shape":return Q("BasicShape_ToolTip",B);default:return Q("Visual",B)}}function Re(O){var B=O?.config.singleVisual;return!B||(0,Be.xj)(B)}function ot(O,B,re){void 0===re&&(re=!1);for(var le=0,ie=B;le<ie.length;le++){var ue=ie[le],Me=O[ue.objectName],Je=!0,lt=ue.selector;if(Me){for(var wt=0,tt=Me;wt<tt.length;wt++){var We=tt[wt];(lt&&((0,K.fS)(We.selector,lt)||_.has(ue,"altConstantValueSelector")&&(0,K.fS)(We.selector,ue.altConstantValueSelector))||re&&We.selector||!lt&&!re)&&delete We.properties[ue.propertyName],Je=Je&&_.isEmpty(We.properties)}Je&&delete O[ue.objectName]}}}function vt(O){var B={},re={};O.forEach(function(ue){ue.canvasItems.forEach(function(Me){var Je=Me.name;re[Je]=Me,B[Je]||(B[Je]=[]),B[Je].push(ue)})});var le=[];for(var ie in B)le.push({canvasItem:re[ie],descriptors:B[ie].map(function(ue){return(0,ce.pi)((0,ce.pi)({},ue),{canvasItems:void 0})})});return le}function dt(O,B,re,le){return O===B&&(0,K.fS)(re,le)}function bt(O,B,re,le){if(!O||!B)return!1;for(var ie=function(tt){var We=B[tt.objectName];if(We)for(var it=0,Pt=We;it<Pt.length;it++){var Yt=Pt[it];if(le){if(!Yt.properties[tt.propertyName])continue;if(!tt.selector||(0,K.fS)(Yt.selector,tt.selector)||(0,K.fS)(Yt.selector,tt.altConstantValueSelector))return{value:!0}}else if(Yt.properties[tt.propertyName])return{value:!0}}if(re&&_.find(re.changes,function(Tt){return Tt.objectName===tt.objectName&&Tt.propertySlice.name===tt.propertyName}))return{value:!0}},ue=0,Me=O;ue<Me.length;ue++){var lt=ie(Me[ue]);if("object"==typeof lt)return lt.value}return!1}function $t(O){return{objectName:O.objectName,propertyName:O.propertySlice.name,propertyValue:O.propertySlice.value,propertyType:O.propertySlice.type,altConstantValueSelector:O.propertySlice.altConstantValueSelector,selector:O.propertySlice.selector}}function It(O,B){var le={objectName:B.objectName,propertySlice:{name:B.propertyName,value:B.propertyValue,type:B.propertyType,altConstantValueSelector:B.altConstantValueSelector,selector:B.selector},hasDynamicExpressionSupport:!1};return le.hasDynamicExpressionSupport=function(O,B){var re=O.config.singleVisual.query,ie=(0,Oe.NA)(O.config.singleVisual.objects,{objectName:B.objectName,propertyName:B.propertySlice.name},B.propertySlice.selector);return!(!ie||!(0,rt.oA)(ie,B.propertySlice.selector,re?re.defn.select():(0,S.bv)()).length)}(O,le),le}function Qe(O,B,re,le){var ie=le.visualPlugin&&le.visualPlugin.capabilities(re);if(ie&&ie.supportsSynchronizingFilterState){var ue=ie.objects[O];if(ue){var Me=ue.properties[B];if(Me&&Me.filterState)return!0}}return!1}function W(O,B){O&&O.syncFilterState(B)}function U(O){return void 0!==O.reference}function k(O){return O.isTopLevelToggle}function H(O){var B=O.visualObjects,re=_.some(B,function(le){return"visual-area"===le.objectName});return re&&B.length>1&&ee.fF.assertFail("Visual area sub selectable should only have one visual object"),re}function fe(O){var B=[],re=O.control.type;switch(re){case"MarginPadding":var le=O.control.properties,ie=qe(O);B=[Ne(le.top,ie),Ne(le.bottom,ie),Ne(le.left,ie),Ne(le.right,ie)];break;case"FontControl":var ue=O.control.properties,Me=qe(O);ue.fontSize&&B.push(Ne(ue.fontSize,Me)),ue.fontFamily&&B.push(function(O,B){return(0,ce.pi)((0,ce.pi)({},B),{control:{type:"FontPicker",properties:O},uid:ke(O.descriptor)})}(ue.fontFamily,Me)),ue.bold&&B.push(Ee(ue.bold,Me)),ue.italic&&B.push(Ee(ue.italic,Me)),ue.underline&&B.push(Ee(ue.underline,Me));break;default:ee.fF.assertNever(re)}return B}function qe(O){return{aliasNames:[],description:"",displayName:"",conditionalFormattingObjects:void 0,conditionalFormattingWarning:void 0,control:void 0,disabled:O.disabled,hidden:O.hidden,disabledReason:O.disabledReason,groupUid:O.groupUid,infoIconText:void 0,originSource:O.originSource,pivotSource:O.pivotSource,placeHolderText:void 0,saveCallback:void 0,showChangeIndicator:O.showChangeIndicator,suppressDisplayName:O.suppressDisplayName,uid:void 0,warningMessage:void 0}}function Ne(O,B){return(0,ce.pi)((0,ce.pi)({},B),{control:{type:"NumUpDown",properties:O},uid:ke(O.descriptor)})}function Ee(O,B){return(0,ce.pi)((0,ce.pi)({},B),{control:{type:"ToggleSwitch",properties:O},uid:ke(O.descriptor)})}},2863:function(st,xe,b){"use strict";b.d(xe,{v:function(){return T}});var ce=b(3579);function T(S,ee,K){var rt=(0,ce.s)(S);return ee.isCustomVisual(rt)||K.isTrustedVisual(rt)}},89535:function(st,xe,b){"use strict";b.d(xe,{Kj:function(){return S},YR:function(){return K},lD:function(){return T},r4:function(){return ee},y5:function(){return rt}});var ce=b(19650),p=b(50423),T=function(){return function(ye,Q){this.value=ye,this.equals=Q}}(),S=new p.InjectionToken("SliceCustomizationService"),ee=6,K=60,rt={left:ce.H.left,center:ce.H.center,right:ce.H.right,Auto:ce.H.auto}},74305:function(st,xe,b){"use strict";b.r(xe),b.d(xe,{ExploreFormattingModule:function(){return Ls}});var he,je,ce=b(77476),p=b(81337),T=b(62458),S=b(56578),ee=b(48708),K=b(47998),rt=b(61193),Oe=b(66123),Be=b(33024),ge=b(2241),ye=b(51490),Q=b(80822),ke=b(90120),de=((he={}).anomalyDetection={objectName:"anomalyDetection",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_AnomalyDetection"},he.forecast={objectName:"forecast",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Forecast"},he.plotAreaShading={objectName:"plotAreaShading",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_SymmetryShading"},he.ratioLine={objectName:"ratioLine",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_RatioLine"},he.referenceLine={objectName:"referenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line"},he.trend={objectName:"trend",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Trend_Line"},he.xAxisReferenceLine={objectName:"xAxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_X"},he.y1AxisReferenceLine={objectName:"y1AxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_Y"},he),we="show",Re="referenceLine",ot="measure",vt="type",dt="percentile",_e="unknown",bt=((je={}).Min=Re+"-minLine",je.Max=Re+"-maxLine",je.Average=Re+"-averageLine",je.Median=Re+"-medianLine",je.Percentile=Re+"-percentileLine",je),It={units:"Unit",forecastLength:"ForecastLength",ignoreLast:"IgnoreLast",confidenceInterval:"ConfidenceLevel",seasonality:"MaxSeasonality"},Qe={sensitivity:Q.DM,explainBy:Q.Bx},W=b(60661),M=b(28579),U=b(47006),k=b(5265),H=b(74082),fe=b(45413),qe=b(45334),Ne=b(58295);function Ee(n,e){return(0,p.mG)(this,void 0,void 0,function(){var t,r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return n?(r={objectName:e},n.enumerateObjectInstancesAsync?[4,n.enumerateObjectInstancesAsync(r)]:[3,2]):[2];case 1:return t=i.sent(),[3,3];case 2:n.enumerateObjectInstances&&(t=n.enumerateObjectInstances(r)),i.label=3;case 3:return[2,M.G.normalize(t)]}})})}function $e(n){var e;return(0,p.mG)(this,void 0,void 0,function(){var t,r,i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return n.getFormattingModelAsync?[4,n.getFormattingModelAsync()]:[3,2];case 1:return r=a.sent(),[3,3];case 2:r=null===(e=n.getFormattingModel)||void 0===e?void 0:e.call(n),a.label=3;case 3:return(t=r)?(i=_.filter(t.cards,function(o){return o.analyticsPane}),T.fF.assert(function(){return _.every(i,function(o){return!(0,S.Qu)(o)})},"Analytics pane does not support Placeholder cards."),[2,i]):[2]}})})}function O(n,e,t,r){var i,a=null===(i=n?.config)||void 0===i?void 0:i.singleVisual;if(!a?.query)return[];var o=r.capabilities(a.visualType);if(!o||!o.objects)return[];var s=[];o.objects[U.Dk]&&s.push(1),o.objects[U.XC]&&s.push(0);for(var l=[],u=(0,W.d$)(n,r)||[],c=a.query.defn.select(),d=function(g){if(_.some(s,function(F){return F===g.cartesianKind}))for(var C=function(V){if(!(0,Ne.k)(V))return"continue";var I=_.find(c,function(L){return(0,fe.fS)(V,L.expr)}),j=t.getDisplayName(V,e,o,I.name,a.columnProperties);l.push({displayName:j,value:I.name,selectExpr:I})},N=0,D=a.query.tryGetExprs(g.name)||[];N<D.length;N++)C(D[N])},v=0,h=u;v<h.length;v++)d(h[v]);return l}function re(n,e,t,r,i,a,o,s){var l;return(0,p.mG)(this,void 0,void 0,function(){var u,c,d,v,h,f;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return null!==(l=i.objects)&&void 0!==l&&l[n]?(T.fF.assert(function(){var g;return 1===(null===(g=_.find(de,function(y){return y.objectName===n}))||void 0===g?void 0:g.maxInstances)},"Expect this be called only for cards that support maximum 1 instance"),[4,Ee(r,n)]):[2];case 1:return u=m.sent(),_.isEmpty(u?.instances)?[2]:(c=s??we,T.fF.assert(function(){return 1===u.instances.length},n+" supports maximum 1 instance but there are "+u.instances.length),v=(d=u.instances[0]).properties[c],(h=new S.CQ(new S.lg(e),t,o,a)).addTopLevelToggle("show",function(){return new S.bd({descriptor:{objectName:n,propertyName:c,selector:d.selector},value:v}).build()}),f=!1,_.isEmpty(d.disabledReason)||(h.withDisabledLocalized(!0,d.disabledReason),f=!0),[2,{cardBuilder:h,objectInstance:d,disableCard:f}])}})})}function le(n,e,t,r,i,a){if(r.objects[e])for(var o={objectName:e,selector:t.selector,altConstantValueSelector:t.altConstantValueSelector,propertyName:void 0,propertyTypes:void 0},s=function(v){var h=v.propertyName;if(!_.has(r.objects[e].properties,h)||!_.has(t.properties,h))return"continue";var f=(0,p.pi)((0,p.pi)({},o),{propertyName:h,propertyTypes:t.propertyTypes?t.propertyTypes[h]:void 0}),m=v.customDisplayNameKey?function(F){F.withCustomDisplayName(v.customDisplayNameKey)}:void 0,g=t.properties[h];if("color"===v.type)n.addSimpleSlice(v.sliceName,function(){var F,I={value:null===(F=g.solid)||void 0===F?void 0:F.color};return new S.BT({descriptor:f,value:I}).build()},m);else if("enumeration"===v.type)n.addSimpleSlice(v.sliceName,function(){return new S.uY({descriptor:f,value:g}).build()},m);else if("toggle"===v.type)n.addSimpleSlice(v.sliceName,function(){return new S.bd({descriptor:f,value:g}).build()});else if("slider"===v.type||"transparency"===v.type){var y,C,N;if("transparency"===v.type)y=Be.t2,C={type:0,value:0},N={type:1,value:100};else if("slider"===v.type){var D=v.options;y=D?.unitSymbol,C=null!=D?.min?{type:0,value:D.min}:void 0,N=null!=D?.max?{type:1,value:D.max}:void 0}n.addSimpleSlice(v.sliceName,function(){return new S.JN({descriptor:f,value:g,options:{unitSymbol:y,minValue:C,maxValue:N},localize:i}).build()},m)}else if("numUpDown"===v.type){var w=v?.options;n.addSimpleSlice(v.sliceName,function(){return new S.mu({descriptor:f,value:g,options:{unitSymbol:w.unitSymbol,unitSymbolAfterInput:w.unitSymbolAfterInput,minValue:null!=w?.min?{type:0,value:w.min}:void 0,maxValue:null!=w?.max?{type:1,value:w.max}:void 0},placeholderText:i(w.placeholderTextKey)}).build()})}},l=0,u=a;l<u.length;l++)s(u[l])}function ie(n,e,t,r){var i=function(n,e){var t,r,i,a,o,s=null!==(i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.objects)&&void 0!==i?i:{};if(null===(a=de[n])||void 0===a||!a.supportsUserDefinedInstances)return null;for(var u=0,c=0,d=s[n]??[];c<d.length;c++){var h=null===(o=d[c].selector)||void 0===o?void 0:o.id,f=null!=h?parseInt(h,10):0;u=Math.max(u,f)}return{id:(u+1).toString()}}(n,t),a={merge:[{objectName:n,selector:i,properties:{show:!0}}]};if(null!=e){var o=We(n,t,e,r);a.merge[0].properties.displayName=o}return a}function ue(n,e,t,r){return ie(n,r.get(e),t,r)}function Me(n,e){return{objectName:n,selector:e,properties:{}}}function Je(n,e,t,r){var i={removeObject:[]};i.removeObject.push(Me(n,e)),r.persistProperties(i,t,!0)}function lt(n,e){var t;if(n){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r){var i=(0,k.NA)(r.objects,{objectName:n.objectName,propertyName:"transform"},n.selector);return i?.parameters&&(i.parameters=_.filter(i.parameters,function(a){return!!a})),i}}}function wt(n,e){if(e){var t=_.find(e.parameters,function(r){return r.name===n});if(!t)return;if((0,H.S9)(t.expr))return t.expr.value;T.fF.assertFail("Expect this only be called for parameters of analytics transforms that has SQConstant expressions with numeric value type")}}function We(n,e,t,r){var i,l,a=null!==(i=e.config.singleVisual.objects)&&void 0!==i?i:{},s=_.map(a[n],function(c){var d=c.properties.displayName;if(d)return qe.m.getPrimitiveValuesFromSQConstantExpr(d)}).filter(function(c){return!!c}),u=1;do{l=r.format("AnalyticsPane_New_Instance_Default_Format",[t,u]),u++}while(_.includes(s,l));return l}var it=b(40702),Pt=b(92194),Yt=b(22733),Tt=b(47508),Ii=b(64869),Ye=b(94419),Bt=b(46544),q=b(50423),Et=b(26898),jt=b(83008),ht=b(10861),yt=b(9380),at=b(65181),Gt=b(8082),qt=b(29866),Ze=Q.xn,tn={numeric:!0},Rr=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.enumerateAnomalyCard=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,v,h,f,m,g,y,C,N,D,w=this;return(0,p.Jh)(this,function(F){switch(F.label){case 0:return this.featureSwitchService.featureSwitches.daxTransformEnabled&&r.objects[Ze]?[4,this.conceptualSchemaProxy.get(this.dataSources.get())]:[2];case 1:return i=F.sent(),(a=function(e,t,r){var i=(0,W.Xf)(e);if(!i)return{shouldInclude:!1};if((0,W.iv)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_VC")};if((0,W.tL)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_Hidden")};var o=(0,W.oJ)(e);if(!_.every(o,function(v){return qe.m.isExprValidForAnalysisTransform(v.expr)}))return{shouldInclude:!1};if(!_.every(t.schemas,function(e){return _.some(e.capabilities.transformCapabilities.supportedTransforms,function(t){return t===Pt.Xp})&&!e.isMultiDimensionalModel}))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_ErrorMessage_NotSupport")};var l=function(n){if(n===Tt.L.lineChart.name)return Yt.x.category;T.fF.assertFail("Unsupported visual type for anomalies: "+n)}(e.config.singleVisual.visualType),u=i.tryGetExprs(l);if(!(0,Q.h_)(u,t)&&!(0,Ii._T)(t,i.defn,i.projections,l)){var c=r.get("Role_DisplayName_Axis");return{shouldInclude:!0,warningText:r.format("Visual_AnomalyDetection_WarningMessage_CategoryNotDateTime",c)}}return{shouldInclude:!0}}(e,i,this.localizationService)).shouldInclude?(o=(0,p.ev)((0,p.ev)([we,Q.DM,Q.Bx],Object.values(Oe.m6),!0),[Q.MA.confidenceBandShow,Q.MA.confidenceBandColor,Q.MA.confidenceBandStyle,Q.MA.transparency],!1),[4,re(Ze,"anomaly","Insights_TitleKey",t,r,s=function(I){return w.localizationService.get(I)},_.map(o,function(V){return{objectName:Ze,propertyName:V}}))]):[2];case 2:return(l=F.sent())?(u=l.cardBuilder,l.disableCard?((c=u.build()).analyticsPane=!0,[2,c]):_.isEmpty(a.warningText)?(h=l.objectInstance,f=(0,ee.Ue)(),D=(0,ye.yF)(h.properties,(0,ye.EL)(f),ke.v.create(f)),m=D.marker,g=D.band,y=function(I){return{objectName:Ze,selector:h.selector,altConstantValueSelector:h.altConstantValueSelector,propertyName:I,propertyTypes:h.propertyTypes?h.propertyTypes[I]:void 0}},C=this.featureSwitchService.featureSwitches.newMarkerProperties,u.addGroup("options",function(V){var I;return V.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("sensitivity",function(){return S.JN.getTransparencySliderBuilder({descriptor:{objectName:Ze,propertyName:Q.DM},value:an(lt(h,e)),localize:s}).build()},function(j){return j.withCustomDisplayName("Visual_AnomalyDetection_Sensitivity")}).addSimpleSlice("explainBy",new S.k0({descriptor:{objectName:Ze,propertyName:Q.Bx},value:{newExpr:_.map(null===(I=rn(h,e))||void 0===I?void 0:I.exprs,function(j){return{expr:j}})},validators:{field:{kind:0}},allowMultipleValues:!0}).build(),function(j){return j.withCustomDisplayName("Role_DisplayName_ExplainBy")})}).addGroup("markers",function(V){C&&V.addTopLevelToggle("markerShow",function(){return new S.bd({descriptor:y(Oe.m6.show),value:m.show}).build()}),V.withDisplayName("Visual_Shape").addSimpleSlice("markerShape",new S.uY({descriptor:y(Oe.m6.shape),value:m.shape}).build()).addSimpleSlice("markerSize",new S.mu({descriptor:y(Oe.m6.size),value:m.size,options:{minValue:{type:0,value:0},maxValue:{type:1,value:10},unitSymbol:Be.e_}}).build()).addSimpleSlice("markerRotation",S.JN.getRotationSliderBuilder({descriptor:y(Oe.m6.rotation),value:m.rotation,localize:s}).build(),function(I){return I.withHidden(!C||!(0,rt.Cd)(m.shape))})}).addGroup("colors",function(V){return V.withDisabled(!m.show).withDisplayName("Generic_Color").addSimpleSlice("markerColor",new S.BT({descriptor:y(Oe.m6.color),value:{value:m.color}}).build()).addSimpleSlice("markerTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(Oe.m6.transparency),value:m.transparency,localize:s}).build(),function(I){return I.withHidden(!C)})}),C&&u.addGroup("border",function(V){return V.withDisplayName("Visual_Border").withDisabled(!(0,rt.nK)(m.shape)||!m.show).addSlices((0,ge.Iq)({containerItemBuilder:V,descriptors:{strokeShow:y(Oe.m6.strokeShow),strokeColorMatch:y(Oe.m6.strokeColorMatch),strokeColor:y(Oe.m6.strokeColor),strokeTransparency:y(Oe.m6.strokeTransparency),strokeWidth:y(Oe.m6.strokeWidth)},strokeData:m.stroke,selector:h.selector,featureSwitches:w.featureSwitchService.featureSwitches,localize:s}).map(function(I){return I.build()}))}),u.addGroup("expectedrange",function(V){V.withDisplayName("Visual_AnomalyDetection_ExpectedRange"),C&&V.addTopLevelToggle("markerBorderShow",function(){return new S.bd({descriptor:y(Q.MA.confidenceBandShow),value:g.show}).build()}),V.addSimpleSlice("confidenceBandStyle",new S.uY({descriptor:y(Q.MA.confidenceBandStyle),value:g.style,filterValues:C?[K.X$.fill,K.X$.line]:[K.X$.fill,K.X$.line,"none"]}).build()).addSimpleSlice("confidenceBandColor",new S.BT({descriptor:y(Q.MA.confidenceBandColor),value:{value:g.color}}).build()).addSimpleSlice("confidenceBandTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(Q.MA.transparency),value:g.transparency,localize:s}).build())}),(N=u.build()).analyticsPane=!0,[2,N]):(u.withDisabledLocalized(!0,a.warningText),(v=u.build()).analyticsPane=!0,[2,v])):[2]}})})},n.prototype.checkAddRemoveInstance=function(e,t,r){return e===Ze&&t.name===we&&(t.value?this.addInstance(r):Je(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.saveGroupSlices=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Ze,t,r)];case 1:return(i=a.sent())&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!i]}})})},n.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Ze]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters)){var i=r.parameters,a=Wr().expr;if(_.some(i,function(o){return o.name===Q.DM&&!(0,fe.fS)(o.expr,a)}))return!0}return!1},n.prototype.revertAnomalyDetectionSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Ze]);if(i){if(_.some(r,function(d){return d.objectName===Ze&&d.propertyName===we}))return void Je(Ze,i.selector,e,this.visualAuthoringService);for(var a=i.properties.transform,o=Q.DM,s=0,l=r;s<l.length;s++)if(l[s].propertyName===o){var c=_.findIndex(a?.parameters,function(d){return d.name===o});c>=0&&(a.parameters[c]=Wr())}}}},n.prototype.getObjectDefinitions=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r],o=a.properties[Q.Bx];if(o&&_.isEmpty(o.exprs)){var s=(0,p.pi)({},a.properties);delete s[Q.Bx],t.push((0,p.pi)((0,p.pi)({},a),{properties:s}))}else t.push(a)}return t},n.prototype.addInstance=function(e){var t=ue(Ze,de.anomalyDetection.displayNameBaseKey,e,this.localizationService);T.fF.assert(function(){var s;return 1===(null===(s=t?.merge)||void 0===s?void 0:s.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;T.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getBoundMeasure(e),T.fF.assertValue(i.metadata,"new anomaly detecton instance selector should have metadata");var a=Wr();r.properties.transform={algorithm:Q.vb,parameters:[a]},r.properties[Q.Bx]={exprs:[]},this.telemetryService.logEvent(it.Yu,{objectName:Ze}),this.visualAuthoringService.persistProperties(t,e,!0)},n.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(c){return _.includes(Qe,c.propertySlice.name)})?[4,Ee(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=u.sent(),_.isEmpty(o?.instances)?[2]:(T.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance but there are "+o.instances.length),s=o.instances[0],T.fF.assert(function(){return _.size(t)<=2},"At most 2 slice changes since there are only 2 slices in the Apply group"),l={merge:[]},_.forEach(t,function(c){var d=c.propertySlice;if(d.name===Q.DM){var v=lt(s,r);if(v){var h=function(n){return n/100}(d.value),f=ji(h);l.merge.push({objectName:Ze,selector:s.selector,properties:{transform:{algorithm:v.algorithm,parameters:[f]}}})}}else if(d.name===Q.Bx){var m=d.value,g=m?.newExpr;l.merge.push({objectName:Q.xn,properties:{explainBy:{exprs:_.map(g,function(y){return y.expr}),kind:"ExprList"}},selector:s.selector})}}),[2,l])}})})},n.prototype.getBoundMeasure=function(e){var t=(0,W.Xf)(e);T.fF.assertValue(t,"visualContainer should have a query");for(var i=0,a=(0,W.d$)(e,this.visualPluginService)??[];i<a.length;i++){var o=a[i];if(1===o.cartesianKind){var s=t.getQueryRefByProjectionIndex(o.name,0);if(s)return s}}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function rn(n,e){var t;if(n){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r)return(0,k.NA)(r.objects,Q.XZ,n.selector)}}function Wr(){return ji(Q.z$)}function an(n){var e=wt(Q.DM,n);return null==e&&(e=Q.z$),function(n){if(null!=n)return Math.round(100*n)}(e)}function ji(n){var e=(0,k.Lo)(n,tn);return T.fF.assert(function(){return e instanceof Ye.Il&&(0,H.VC)(e)},"encoded value for transform sensitivity parameter should be a constant"),{name:Q.DM,expr:e}}var Zt,Xt,mr,gr,n,Hr=b(20114),fr=b(40253),Ce=b(21571),He=b(14599),_i=b(17772),Ai=b(69871),Te=b(82173),oe=It,Kr=((Zt={})[oe.units]=fr.xm,Zt[oe.forecastLength]=10,Zt[oe.ignoreLast]=0,Zt[oe.confidenceInterval]=Hr.s$,Zt[oe.seasonality]=void 0,Zt),xi=((Xt={})[oe.units]={enumeration:fr.dt},Xt[oe.forecastLength]={numeric:!0},Xt[oe.ignoreLast]={numeric:!0},Xt[oe.confidenceInterval]={enumeration:Hr.dt},Xt[oe.seasonality]={numeric:!0},Xt),Jr=((mr={})[oe.forecastLength]=1,mr[oe.ignoreLast]=0,mr[oe.seasonality]=1,mr),Qr=((gr={})[oe.forecastLength]=2e9,gr[oe.ignoreLast]=500,gr[oe.seasonality]=2e9,gr),sr={units:{objectName:Te.Po,propertyName:oe.units},forecastLength:{objectName:Te.Po,propertyName:oe.forecastLength},ignoreLast:{objectName:Te.Po,propertyName:oe.ignoreLast},seasonality:{objectName:Te.Po,propertyName:oe.seasonality},confidenceInterval:{objectName:Te.Po,propertyName:oe.confidenceInterval}},sn=_.map(sr,function(n){return n.propertyName}),zi=(n={},_.forEach(fr.dt.members(),function(e,t){n[e.value]=t}),n),$r=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.enumerateForecastCard=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h,f=this;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return r.objects[Te.Po]?[4,this.querySupportsForecasting(e)]:[2];case 1:return m.sent()?[4,re(Te.Po,"forecast","Visual_Forecast",t,r,a=function(y){return f.localizationService.get(y)},(0,p.ev)((0,p.ev)((0,p.ev)([],Object.values((0,He.pN)(Te.Po,He.ZB)),!0),Object.values((0,He.pN)(Te.Po,He.PK)),!0),_.map((0,p.ev)([oe.units,oe.forecastLength,oe.ignoreLast,oe.seasonality,oe.confidenceInterval,"displayName","matchSeriesInterpolation","interpolation","interpolationStep","interpolationSmooth","interpolationSmoothParam"],Object.keys(He.iQ),!0),function(g){return{objectName:Te.Po,propertyName:g}}),!0),"show")]:[2];case 2:return(o=m.sent())?((0,W.iv)(e)?o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_VC"):(0,W.tL)(e)&&o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_Hidden"),s=o.cardBuilder,o.disableCard?((l=s.build()).analyticsPane=!0,[2,l]):(u=o.objectInstance,[4,this.conceptualSchemaProxy.get(this.dataSources.get())])):[2];case 3:return c=m.sent(),d=lt(u,e),v=yr(oe.units,d),s.addGroup("options",function(g){g.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("units",function(){var y=f.getPossibleUnits(e,c);return new S.uY({items:y,descriptor:sr.units,value:_.find(y,function(C){return C.value===v})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Units").withInfoIconText(f.localizationService.format("AnalyticsPane_Forecast_Units_Apply_To_Properties_InfoText",[f.localizationService.get("Visual_Forecast_Parameter_ForecastLength"),f.localizationService.get("Visual_Forecast_Parameter_IgnoreLength")]))}).addSimpleSlice("forecastLength",function(){var y=yr(oe.forecastLength,d);return new S.mu({descriptor:sr.forecastLength,value:y,options:{minValue:{type:0,value:Jr[oe.forecastLength]},maxValue:{type:1,value:Qr[oe.forecastLength]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ForecastLength")}).addSimpleSlice("ignoreLast",function(){var y=yr(oe.ignoreLast,d);return new S.mu({descriptor:sr.ignoreLast,value:y,options:{minValue:{type:0,value:Jr[oe.ignoreLast]},maxValue:{type:1,value:Qr[oe.ignoreLast]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_IgnoreLength")}).addSimpleSlice("seasonality",function(){var y=yr(oe.seasonality,d);return new S.mu({descriptor:sr.seasonality,value:y,options:{unitSymbol:"Visual_Forecast_Units_Point",unitSymbolAfterInput:!0,minValue:{type:0,value:Jr[oe.seasonality]},maxValue:{type:1,value:Qr[oe.seasonality]}},placeholderText:f.localizationService.get("Visual_Auto")}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Seasonality")}).addSimpleSlice("confidenceInterval",function(){var y=yr(oe.confidenceInterval,d),C=Yr(Hr.dt.members(),f.localizationService);return new S.uY({items:C,descriptor:sr.confidenceInterval,value:_.find(C,function(N){return N.value===y})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ConfidenceInterval")})}).addGroup("forecastline",function(g){return g.withDisplayName("Visual_Forecast_Line").addSlices((0,ge.Iq)({containerItemBuilder:g,descriptors:(0,p.pi)((0,p.pi)({},(0,He.pN)(Te.Po,He.ZB)),{strokeShow:null}),strokeData:(0,ge.AF)(u.properties,He.ZB,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a,isSVGStroke:!0}).map(function(y){return y.build()})).addSimpleSlice("matchSeriesInterpolation",new S.bd({descriptor:(0,p.pi)((0,p.pi)({},Ai.qn.forecast.matchSeriesInterpolation),{selector:u.selector}),value:u.properties.matchSeriesInterpolation}).build()).addSlices((0,_i.Ie)({containerItemBuilder:g,descriptors:Ai.qn.forecast,interpData:(0,_i.Bs)(u.properties,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a}).map(function(y){return y.withDisabled(!0===u.properties.matchSeriesInterpolation).build()}))}),s.addGroup("confidenceLine",function(g){return g.withDisplayName("Visual_Forecast_Confidence_Lines").addSlices((0,ge.Iq)({containerItemBuilder:g,descriptors:(0,He.pN)(Te.Po,He.PK),strokeData:(0,ge.AF)(u.properties,He.PK,{},void 0,u.properties.lineColor.solid.color),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a,isSVGStroke:!0}).map(function(y){return y.build()}))}).addGroup("confidenceArea",function(g){g.withDisplayName("Visual_Forecast_Confidence_Shade").addTopLevelToggle("bandAreaShow",function(){return new S.bd({descriptor:{objectName:Te.Po,propertyName:"bandAreaShow",selector:u.selector},value:u.properties.bandAreaShow}).build()}),le(g,Te.Po,u,r,a,[{type:"toggle",sliceName:"bandAreaMatchColor",propertyName:"bandAreaMatchColor"},{type:"color",sliceName:"bandAreaColor",propertyName:"bandAreaColor"},{type:"transparency",sliceName:"bandAreaTransparency",propertyName:"bandAreaTransparency"}])}),s.addGroup("tooltipTitle",function(g){g.withDisplayName("Visual_Forecast_Tooltip_Title").addSimpleSlice("titleText",new S.fq({descriptor:{objectName:Te.Po,propertyName:"displayName",selector:u.selector},value:u.properties.displayName,placeholder:""}).build(),function(y){return y.withCustomDisplayName("Visual_Title_Text")})}),(h=s.build()).analyticsPane=!0,[2,h]}})})},n.prototype.checkAddRemoveInstance=function(e,t,r){return e===Te.Po&&"show"===t.name&&(t.value?this.addInstance(r):Je(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.saveGroupSlices=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return _.some(t,function(o){return o.objectName!==Te.Po})||e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Te.Po,t,r)];case 1:return i=a.sent(),t&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!t]}})})},n.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Te.Po]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters))for(var i=r.parameters,a=Oi(),o=function(v){var h=_.find(a,function(f){return f.name===v.name});return T.fF.assertValue(h||v.name===oe.seasonality,"every forecast parameter should have a matching default value"),h?(0,fe.fS)(v.expr,h.expr)?void 0:{value:!0}:{value:v.name===oe.seasonality&&!!v.expr}},s=0,l=i||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return!1},n.prototype.revertForecastSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Te.Po]);if(i){if(_.some(r,function(c){return c.objectName===Te.Po&&"show"===c.propertyName}))return void Je(Te.Po,i.selector,e,this.visualAuthoringService);for(var a=i.properties.transform,o=function(d){var v=d.propertyName;if(_.includes(sn,v)){var h=_.findIndex(a?.parameters,function(m){return m.name===v});if(h>=0){var f=a.parameters[h];a.parameters[h]=Mi(f.name),(!a.parameters[h]||!f.expr)&&a.parameters.splice(h)}}},s=0,l=r;s<l.length;s++)o(l[s])}}},n.prototype.querySupportsForecasting=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return(0,W.Xf)(e)?(t=this.getForecastBoundMeasure(e),_.isEmpty(t)?[2,!1]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]):[2,!1];case 1:return r=a.sent(),i=(0,W.oJ)(e),[2,_.every(i,function(o){return qe.m.isExprValidForAnalysisTransform(o.expr)&&!o.expr.hasGroupOnKeys(r)})]}})})},n.prototype.addInstance=function(e){var t=ue(Te.Po,de.forecast.displayNameBaseKey,e,this.localizationService);T.fF.assert(function(){var o;return 1===(null===(o=t?.merge)||void 0===o?void 0:o.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;T.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getForecastBoundMeasure(e);var a=Oi();r.properties.transform={algorithm:"Forecast",parameters:a},this.telemetryService.logEvent(it.Yu,{objectName:Te.Po}),this.visualAuthoringService.persistProperties(t,e,!0)},n.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u;return(0,p.Jh)(this,function(d){switch(d.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(v){return _.includes(It,v.propertySlice.name)})?[4,Ee(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=d.sent(),_.isEmpty(o?.instances)?[2]:(T.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance. If there is object enumeration, it should contain exactly 1 instance"),(l=lt(s=o.instances[0],r))?(u=[],_.forEach(_.values(It),function(v){var h=_.find(t,function(y){return y.propertySlice.name===v}),f=h?function(n,e){return T.fF.assertValue(e,"sliceValue must be defined"),n===oe.units?Li(e):n===oe.confidenceInterval?Bi(e):e}(v,h.propertySlice.value):wt(v,l);if(null!=f){var g=(0,k.Lo)(f,xi[v]);T.fF.assert(function(){return g instanceof Ye.Il&&(0,H.VC)(g)},"encoded value for transform parameter should be a constant"),u.push({name:v,expr:g})}}),[2,{merge:[{objectName:Te.Po,selector:s.selector,properties:{transform:{algorithm:l.algorithm,parameters:u}}}]}]):[2])}})})},n.prototype.getPossibleUnits=function(e,t){var r=e.config.singleVisual,i=this.visualPluginService.capabilities(r.visualType),a=_.find(i.dataRoles,function(C){return 0===C.cartesianKind}),o=!1,s=!1;if(a){var l=r.query.defn,u=r.query.projections,c=a.name;if(!u[c])return;for(var v=function(N){var D=_.find(l.select(),function(F){return N.queryRef===F.name});T.fF.assertValue(D,"select in projections should be present in query");var w=D.expr.getMetadata(t);o=o||w.type.dateTime},h=0,f=u[c].all();h<f.length;h++)v(f[h]);s=(0,Ii._T)(t,l,u,c)}var g=fr.dt.members();if(o||s)return Yr(g,this.localizationService);var y=_.find(g,function(C){return C.value===fr.xm});return T.fF.assertValue(y,'"point" should be an available unit'),Yr([y],this.localizationService)},n.prototype.getForecastBoundMeasure=function(e){var t,r,i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.query;if(!i)return"";for(var o=function(v){if(1===v.cartesianKind){var h=i.defn.select(),f=i.tryGetExprs(v.name)||[];if(1!==_.size(f))return{value:""};var m=_.find(h,function(g){return(0,fe.fS)(f[0],g.expr)});if(m)return{value:m.name}}},s=0,l=(0,W.d$)(e,this.visualPluginService)||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return""},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Oi(){var n=_.map(Kr,function(e,t){return Mi(t)});return _.filter(n,function(e){return!!e})}function Mi(n){var e=Kr[n],t=e;if(null!=t){n===oe.units?t=Li(e):n===oe.confidenceInterval&&(t=Bi(e));var i=(0,k.Lo)(t,xi[n]);return T.fF.assert(function(){return i instanceof Ye.Il&&(0,H.VC)(i)},"encoded value for transform parameter should be a constant"),{name:n,expr:i}}}function yr(n,e){var t=wt(n,e);return null==t?Kr[n]:n===oe.units?function(n){return _.findKey(zi,function(e){return e===n})}(t):n===oe.confidenceInterval?function(n){return 100*n+"%"}(t):t}function Li(n){return zi[n]}function Bi(n){return parseFloat(n)/100}function Yr(n,e){return _.map(n,function(t){return{value:t.value,displayName:(0,Ce.G)(t.displayName,e)}})}var ve,De,Ve=b(57871);!function(n){n.MinContainerWidth=Ve.A6,n.MinContainerHeight=Ve.Q$,n.MaxPrecision=15,n.SliceNameAxisStart="axisStart",n.SliceNameAxisEnd="axisEnd",n.SliceNameStart="start",n.SliceNameEnd="end",n.SliceNameInvertAxis="invertAxis",n.SliceNameSecStart="secStart",n.SliceNameSecEnd="secEnd",n.SliceNameSecInvertAxis="secInvertAxis",n.PlotAreaCardName="plotArea",n.ImageSliceName="image",n.MapSliceName="map",n.ImageFitSliceName="scaling",n.TransparencySliceName="transparency"}(ve||(ve={})),function(n){n.DisplayAreaName="displayArea",n.PageRefreshCardName="pageRefresh",n.PageSizeCardName="pageSize",n.PageSizeTypeName="pageSizeTypes",n.PageSizeWidthName="pageSizeWidth",n.PageSizeHeightName="pageSizeHeight",n.PageBackgroundColor="color",n.PageInformationCardName="pageInformation",n.PageInformationName="pageInformationName",n.PageInformationQnaPodEnabled="pageInformationQnaPodEnabled",n.PageInformationAltName="pageInformationAltName",n.PageInformationType="pageInformationType",n.PageBackgroundImage="image",n.PageBackgroundTransparency="transparency",n.PageBackgroundRevertToDefault="revertToDefault",n.PageBackgroundCardName="background",n.OutspaceBackgroundCardName="outspace",n.OutspacePaneCardName="outspacePane",n.FilterCardName="filterCard",n.PageSizeUnits={Pixels:"px"},n.PersonalizeVisual="personalizeVisual"}(De||(De={}));var er,tr,Zr=b(3579),Z=b(2529),lr=b(57521),Ei=b(32379),Ir=b(13702),_t=["Min","Max","Average","Median","Percentile"],Pr=["ConstantX","ConstantY1"],Gi=((er={}).Min=function(n){return(0,Ye.m_)(n,3)},er.Max=function(n){return(0,Ye.m_)(n,4)},er.Average=function(n){return(0,Ye.m_)(n,1)},er.Median=function(n){return(0,Ye.m_)(n,6)},er.Percentile=function(n,e){var t=parseFloat(e);return t=_.isNaN(t)?0:Math.min(Math.max(0,t),100),(0,Ye.Pe)(n,t/100,!1)},er),vn=[Z.tZ,Z.KZ,Z.oB,Z.FK,Z.yl,Z.Zs,Z.nR,Z.G5,Z.UD,Z.XI,Z.pw],Ui=((tr={}).Min="Visual_Min_Reference_Line",tr.Max="Visual_Max_Reference_Line",tr.Average="Visual_Average_Reference_Line",tr.Median="Visual_Median_Reference_Line",tr.Percentile="Visual_Percentile_Reference_Line",tr),At=Re,jr=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.displayNameService=r,this.featureSwitchService=i,this.localizationService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l,this.visualToUserUnknownLineInstancesMap={}}return n.prototype.getReferenceLineInstancesInfo=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!1)];case 1:return[2,a.sent()]}})})},n.prototype.getReferenceAndConstantLinesInfo=function(e,t,r,i){var a;return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,N,D,w,V,I,j,L,x,z,P;return(0,p.Jh)(this,function(A){switch(A.label){case 0:return r.objects?(o=(0,W.GQ)(e),s=(0,W.oJ)(e),l=!1,u={},v=!1,h=!1,r.objects[At]?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[3,3]):[2];case 1:return f=A.sent(),d=O(e,f,this.displayNameService,this.visualPluginService),_.isEmpty(d)?[3,3]:[4,Ki(t,At)];case 2:c=A.sent(),(l=!_.isEmpty(c))&&(m=function(n,e){for(var t=!1,r=!1,i=0,a=e||[];i<a.length;i++){var s=a[i].selectExpr.expr.getTargetSchemaName(),l=n.schema(s),u=l?.capabilities;if(u?.supportsMedian&&(t=!0),u?.supportsPercentile&&(r=!0),t&&r)break}return{supportsMedian:t,supportsPercentile:r}}(f,d),v=m.supportsMedian,h=m.supportsPercentile,u=null!==(a=_.chain(c).map(function(E){return Ri(E,!E.properties[Z.$Z],o,s)}).groupBy(function(E){return E.type}).value())&&void 0!==a?a:{}),A.label=3;case 3:g=!1,y=!1,N=function(G){var X,te,Y;return(0,p.Jh)(this,function(ne){switch(ne.label){case 0:return X=Vt(G),r.objects[X]?[4,Ki(t,X)]:[3,2];case 1:te=ne.sent(),Y=!_.isEmpty(te),"ConstantX"===G?g=Y:y=Y,Y&&(u[G]=_.map(te,function(Se){return{visualObjectInstance:Se,isDefaultInstance:!Se.properties[Z.$Z],type:G}})),ne.label=2;case 2:return[2]}})},D=0,w=i?Pr:[],A.label=4;case 4:return D<w.length?[5,N(w[D])]:[3,7];case 5:A.sent(),A.label=6;case 6:return D++,[3,4];case 7:if(!l&&!g&&!y)return[2];for(V=[],j=0,L=(0,p.ev)((0,p.ev)([],Pr,!0),_t,!0);j<L.length;j++)("ConstantX"!==(x=L[j])||g)&&("ConstantY1"===x&&!y||_.includes(_t,x)&&!l||"Median"===x&&!v||"Percentile"===x&&!h||(z=u[x],_.isEmpty(z)&&_.includes(_t,x)&&(I||(I=_.find(u[_e],function(E){return E.isDefaultInstance})),I||(I=Ri(c[0],!0,o,s)),(P=_.cloneDeep(I)).type=x,z=[P]),V.push([x,z])));return T.fF.assert(function(){return _.every(V,function(E){return _.size(E[1])>=1})},"We should return at least 1 instance for each of the supported reference or constant reference line types, if no real instance, then return a default one."),[2,{groupedInstances:V,validMeasures:d}]}})})},n.prototype.createReferenceLineCard=function(e,t,r,i,a,o){var s=this,l=new S.lg(e),u=function(h){return s.localizationService.get(h)},c=[],d=new S.CQ(l,t,void 0,u,!1).addGroup(void 0,function(v){for(var h={uid:e+"-container",containerItems:[],displayName:s.localizationService.get("Apply_Settings_To"),isEditable:!0},f=0,m=r??[];f<m.length;f++){var g=m[f],y=g.type,C=Hi(y),N=ki(g),D=g.visualObjectInstance.selector,w={displayName:N,groups:[],uid:"".concat(y,"-").concat(D?.id||_e)};h.containerItems.push(w);var F={objectName:Vt(y),propertyName:void 0,propertyTypes:void 0,selector:D,altConstantValueSelector:g.visualObjectInstance.altConstantValueSelector},V=D?.id.includes(_e),I=V||g.isDefaultInstance;if(o){var j={value:_e,displayName:s.localizationService.get("Choose_A_Type")},L=hn(l,C,y,j,o,F,u);I&&!V&&(L.group.disabled=!0),w.groups.push(L.group),c.push.apply(c,L.descriptors)}var x=fn(l,y,g,a,F,C,u);x&&(I&&(x.group.disabled=!0),w.groups.push(x.group),c.push.apply(c,x.descriptors));var z=mn.call(s,l,y,g,i,F,C,u);I&&(z.group.disabled=!0),w.groups.push(z.group),c.push.apply(c,z.descriptors);var P=gn(l,y,g,i,F,s.localizationService,u);P&&(I&&(P.group.disabled=!0),w.groups.push(P.group),c.push.apply(c,P.descriptors));var A=yn(l,g,i,F,u);I&&(A.group.disabled=!0),w.groups.push(A.group),c.push.apply(c,A.descriptors)}v.withContainer(h)}).build();return d.analyticsPane=!0,d.revertToDefaultDescriptors=c,d},n.prototype.enumerateReferenceAndConstantLineCards=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!0)];case 1:return i=a.sent(),_.isEmpty(i?.groupedInstances)?[2]:this.featureSwitchService.featureSwitches.onObject?[4,this.enumerateReferenceAndConstantLineCardsV2(e,i,r)]:[3,3];case 2:case 4:return[2,a.sent()];case 3:return[4,this.enumerateReferenceAndConstantLineCardsV1(e,i,r)]}})})},n.prototype.checkAddRemoveRenameInstance=function(e,t,r){var i,a,o;return(0,p.mG)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,C,N,D,w,F;return(0,p.Jh)(this,function(V){switch(V.label){case 0:if("editable-container-object-name"!==e)return[2,!1];if(l=t.value,T.fF.assert(function(){var I,j,L;return(_.isEmpty(null===(I=l.itemUpdates)||void 0===I?void 0:I.adds)?0:_.size(l.itemUpdates.adds))+(_.isEmpty(null===(j=l.itemUpdates)||void 0===j?void 0:j.deletes)?0:_.size(l.itemUpdates.deletes))+(_.isEmpty(null===(L=l.itemUpdates)||void 0===L?void 0:L.renames)?0:_.size(l.itemUpdates.renames))<=1},"Expect only one add/delete/rename at a time"),_.isEmpty(null===(i=l.itemUpdates)||void 0===i?void 0:i.adds))return[3,2];if(u=void 0,(c=_.findKey(bt,function(I){return _.includes(t.name,I)}))?u=c:_.includes(t.name,de.xAxisReferenceLine.objectName)?u="ConstantX":_.includes(t.name,de.y1AxisReferenceLine.objectName)&&(u="ConstantY1"),null==u){N=this.visualToUserUnknownLineInstancesMap[d=r.name]||[],v=_.map(N,function(I){return I.displayName}),h=0,f=void 0;do{h++,f=this.localizationService.format("UserUnknown_Line_Format",[h])}while(_.includes(v,f));return m={id:"".concat(_e,"-").concat(h)},N.push({displayName:f,selector:m}),this.visualToUserUnknownLineInstancesMap[d]=N,[2,!0]}return[4,this.addLineInstance(u,r)];case 1:return V.sent(),[2,!0];case 2:return(y=_.first(null===(a=l.itemUpdates)||void 0===a?void 0:a.deletes))?(s=Ji(y))===_e?(this.removeUserUnknownLine(r.name,y.displayName),[2,!0]):(F=Vt(s),[2,this.deleteInstance(F,r,y.displayName)]):(C=_.first(null===(o=l.itemUpdates)||void 0===o?void 0:o.renames))?(s=Ji(C.item))===_e?(N=this.visualToUserUnknownLineInstancesMap[r.name],D=_.find(N,function(I){return I.displayName===C.item.displayName}),w=(0,Ce.G)(C.newDisplayName,this.localizationService),D.displayName=w,[2,!0]):(F=Vt(s),[2,this.renameInstance(F,r,C)]):[2,!1]}})})},n.prototype.tryHandleReferenceLineSpecialSave=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,s,l;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return e===de.xAxisReferenceLine.objectName&&t.name===Z.rS&&_.isBoolean(t.value)?(void 0,i=t.value?_.find(lr.dt.members(),function(c){return c.value!==lr.YP}).value:lr.YP,(s={objectName:e,selector:t.selector,properties:{}}).properties[t.name]=i,[2,{isHandled:!0,persistChanges:{merge:[s]}}]):(a=_.findKey(bt,function(c){return c===e}))&&(t.name===ot||t.name===dt)&&t.selector?(s=function(n,e,t){var r=e.name===ot,i=e.name===dt;if(T.fF.assert(function(){return r||i},"Expect the given slice to be for changing measure selection or changing percentile value"),r||i){var o,a=r?e.value:e.selector.metadata;if(T.fF.assertValue(a,"The slice is for measure or percentile, in either case it should have an associated measure"),i)o=e.value;else if("Percentile"===n&&r){var s=(0,W.GQ)(t),l=_.find(s[Re],function(u){return(0,Ei.fS)(u.selector,e.selector)});T.fF.assertValue(l,"It is changing measure selection of a percentile line, expect the given visual has a matching percentile object"),o=l?(100*l.properties.value.k).toString():"90"}return Wi(n,e.selector,r,a,o,t)}}(a,t,r),[2,{isHandled:!0,persistChanges:{merge:[s]}}]):t.name!==vt?[3,2]:[4,this.tryGetLineTypeChange(e,t,r)];case 1:return l=u.sent(),[2,{isHandled:!0,persistChanges:l?.persistChanges,newPropertyChanges:l?.newPropertyChanges}];case 2:return[2,{isHandled:!1}]}})})},n.prototype.tryGetLineTypeChange=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,c,d,v,h,f,m,g,y,C,N;return(0,p.Jh)(this,function(w){switch(w.label){case 0:return t.selector.id.startsWith(_e)?(i=_.find(this.visualToUserUnknownLineInstancesMap[r.name],function(F){return F.selector.id===t.selector.id}),this.removeUserUnknownLine(r.name,a=i.displayName),o=this.localizationService.get("UserUnknown_Line_Format"),s=new RegExp("^".concat(o," \\d+$")).test(a),[4,this.getAddLineInstanceChanges(t.value,r,s?void 0:a)]):[3,2];case 1:return[2,{persistChanges:{merge:w.sent()}}];case 2:return"xAxisReferenceLine"===e?c="ConstantX":"y1AxisReferenceLine"===e?c="ConstantY1":(d=_.findKey(bt,function(F){return _.includes(e,F)}),c=d),(v=t.value)===c?[2,{}]:(h=(0,W.GQ)(r),f=Vt(c),m=_.find(h[f],function(F){return F.selector.id===t.selector.id}),g=this.checkDefaultDisplayName(c,m,r),y=_.includes(Pr,c),C=_.includes(Pr,v),y||C?[4,this.getModifyCrossObjectLineTypeChange(m,r,c,v,g)]:[3,4]);case 3:return[2,{persistChanges:(N=w.sent()).persistChanges,newPropertyChanges:N.newPropertyChanges}];case 4:return[2,{persistChanges:{merge:[this.getModifyReferenceLineTypeChange(t.selector,v,g,r)]}}]}})})},n.prototype.getModifyReferenceLineTypeChange=function(e,t,r,i){T.fF.assertValue(e,"Expect selector to be defined");var a=e.metadata;T.fF.assertValue(a,"Expect measureName to be defined");var o={objectName:At,selector:e,properties:{}},s="Percentile"===t?"90":void 0,u=(0,Gi[t])((0,Ye.xA)(a),s);if(o.properties.value=u,r){var c=this.getLineDisplayName(t,i);o.properties.displayName=We(Vt(t),i,c,this.localizationService)}return o},n.prototype.getModifyCrossObjectLineTypeChange=function(e,t,r,i,a){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u,d,v,h,f;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return o=Vt(r),s=_r(e),l=Me(o,e.selector),[4,this.getAddLineInstanceChanges(i,t,a?void 0:s)];case 1:return u=m.sent(),d=e.properties,v=[],_.forEach(Object.keys(d),function(g){vn.includes(g)&&v.push({propertyName:g,value:d[g]})}),h={merge:u,removeObject:[l]},_.isEmpty(v)?[2,{persistChanges:h}]:(f={objectName:Vt(i),selector:u[0].selector,properties:{}},_.forEach(v,function(g){f.properties[g.propertyName]=g.value}),[2,{persistChanges:h,newPropertyChanges:f}])}})})},n.prototype.getAddLineInstanceChanges=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c;return(0,p.Jh)(this,function(d){switch(d.label){case 0:return i=Vt(e),a=this.getLineDisplayName(e,t),o=ie(i,a,t,this.localizationService),T.fF.assert(function(){var v;return 1===(null===(v=o?.merge)||void 0===v?void 0:v.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item"),r&&(o.merge[0].properties.displayName=r),_.includes(_t,e)?(T.fF.assertValue(s=o.merge[0].selector,"referenceLine addInstance merge change should have a defined selector"),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:l=d.sent(),u=O(t,l,this.displayNameService,this.visualPluginService),_.isEmpty(u)||(c=Wi(e,s,!0,u[0].value,"Percentile"===e?"90":void 0,t))&&o.merge.push(c),d.label=2;case 2:return this.telemetryService.logEvent(it.Yu,{objectName:e}),[2,o.merge]}})})},n.prototype.removeUserUnknownLine=function(e,t){var r=this.visualToUserUnknownLineInstancesMap[e];r=_.filter(r,function(i){return i.displayName!==t}),this.visualToUserUnknownLineInstancesMap[e]=r},n.prototype.addLineInstance=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return[4,this.getAddLineInstanceChanges(e,t)];case 1:return r=i.sent(),this.visualAuthoringService.persistProperties({merge:r},t,!0),[2]}})})},n.prototype.deleteInstance=function(e,t,r){var i=(0,W.GQ)(t),a=_.find(i[e],function(o){return _r(o)===r});return!!a&&(Je(e,a.selector,t,this.visualAuthoringService),!0)},n.prototype.renameInstance=function(e,t,r){var i=(0,W.GQ)(t),a=_.find(i[e],function(l){return _r(l)===r.item.displayName});return!!a&&(this.visualAuthoringService.persistProperties({merge:[{objectName:e,selector:a.selector,properties:{displayName:r.newDisplayName}}]},t,!0),!0)},n.prototype.enumerateReferenceAndConstantLineCardsV2=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f,m,g,N=this;return(0,p.Jh)(this,function(D){return _.isEmpty(t?.groupedInstances)?[2]:(i=_.map(t.groupedInstances,function(w){return w[0]}),a=_.map(i,function(w){return{value:w,displayName:N.getLineDisplayName(w,e)}}),o=this.localizationService.get("ReferenceLine"),s=[],_.forEach(t.groupedInstances,function(w){return s.push.apply(s,w[1])}),l=_.filter(s,function(w){return!w.isDefaultInstance}),u=this.visualToUserUnknownLineInstancesMap[e.name],c=_.size(l),d=_.size(u),v=c+d,h=_.sortBy(l,function(w){return ki(w)}),f=[],_.forEach(u,function(w){var F,V={visualObjectInstance:{objectName:"referenceLine",properties:(F={},F[Z.ss]=w.displayName,F),selector:w.selector},isDefaultInstance:!1,type:_e};f.push(V)}),h.push.apply(h,_.sortBy(f,function(w){return w.visualObjectInstance.properties.displayName})),0===v&&((m=(0,p.pi)({},s[0])).type=_e,h.push(m)),g=v>0?this.localizationService.format("NamePattern_Bracket",[o,v]):o,[2,[this.createReferenceLineCard("referenceLine",g,h,r,t.validMeasures,a)]])})})},n.prototype.enumerateReferenceAndConstantLineCardsV1=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f;return(0,p.Jh)(this,function(m){for(i=[],a=0,o=t.groupedInstances;a<o.length;a++)l=(s=o[a])[0],u=s[1],!_.isEmpty(u)&&(c=this.getLineDisplayName(l,e),d=_.size(_.filter(u,function(g){return!g.isDefaultInstance})),v=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c,h=bn(l),f=this.createReferenceLineCard(h,v,u,r,t.validMeasures),i.push(f));return[2,i]})})},n.prototype.getLineDisplayName=function(e,t){var r;if("ConstantX"===e||"ConstantY1"===e){var i=Vt(e),a=(0,Zr.s)(t),o=this.visualPluginService.capabilities(a);return(null===(r=o.objects[i])||void 0===r?void 0:r.displayName)?(0,Ce.G)(o.objects[i].displayName,this.localizationService):this.localizationService.get("ConstantX"===e?"Visual_Reference_Line_X":"Visual_Reference_Line_Y")}if(_.includes(_t,e))return this.localizationService.get(Ui[e]);T.fF.assertFail("should always return a displayName key")},n.prototype.checkDefaultDisplayName=function(e,t,r){var i=_r(t).toLocaleLowerCase(),a=this.getLineDisplayName(e,r).toLocaleLowerCase();return new RegExp("^".concat(a," \\d+$")).test(i)},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(Ir.O),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function _r(n){return Ye.jz.getTextValue(n.properties[Z.ss])}function ki(n){return n.visualObjectInstance.properties.displayName}function ei(n){return Hi(n)}function hn(n,e,t,r,i,a,o){return{group:new S.mQ(new S.SS(n,"type"),o).addSimpleSlice(vt,function(){var l=t!==_e?_.find(i,function(u){return u.value===t}):r;return new S.uY({descriptor:(0,p.pi)((0,p.pi)({},a),{objectName:e,propertyName:vt}),items:i,value:l}).build()},function(l){l.withCustomDisplayName("Type")}).build(),descriptors:[{objectName:e,propertyName:vt}]}}function fn(n,e,t,r,i,a,o){if(_.includes(_t,e)){var s=t.visualObjectInstance.propertyTypes;return{group:new S.mQ(new S.SS(n,"measure"),o).withDisplayName("Series").addSimpleSlice(ot,function(){var u=t.isDefaultInstance?r[0]:_.find(r,function(c){return c.value===t.measureName});return new S.uY({descriptor:(0,p.pi)((0,p.pi)({},i),{objectName:a,propertyTypes:s?s[ot]:void 0,propertyName:ot}),items:r,value:u}).build()},function(u){u.withCustomDisplayName("Series")}).build(),descriptors:[{objectName:a,propertyName:ot}]}}}function mn(n,e,t,r,i,a,o){var s,l,u=[],c=t.visualObjectInstance,d=c.propertyTypes,v=new S.mQ(new S.SS(n,"line"),o).withDisplayName("Visual_Shape_Line");!t.isDefaultInstance&&"Percentile"===e&&v.addSimpleSlice(dt,function(){return T.fF.assert(function(){return null!=t.percentileValue},"percentileValue should be calculated already"),S.JN.getTransparencySliderBuilder({descriptor:(0,p.pi)((0,p.pi)({},i),{objectName:a,propertyTypes:d?d[ot]:void 0,propertyName:dt}),value:t.percentileValue,localize:o}).build()},function(N){N.withCustomDisplayName("Visual_Reference_Line_Percentile")}),u.push({objectName:a,propertyName:dt});var h=Z.S3,f=(0,p.pi)((0,p.pi)({},i),{propertyTypes:d?d[h]:void 0,propertyName:Z.S3,instanceKind:c.propertyInstanceKind&&c.propertyInstanceKind[Z.S3]});"ConstantX"===e&&(v.addSimpleSlice(Z.S3,function(){return d&&d[h]&&d[h].dateTime?new S.hz({descriptor:f,value:c.properties[h],placeholder:""}).build():new S.fq({descriptor:f,value:c.properties[h],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName})),"ConstantY1"===e&&(v.addSimpleSlice(Z.S3,function(){return new S.fq({descriptor:f,value:c.properties[Z.S3],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName}));var m=c.objectName;if(r.objects[m]){var g=(0,He.pN)(c.objectName,He.vi),y=(0,ge.Iq)({containerItemBuilder:v,descriptors:g,strokeData:(0,ge.AF)(c.properties,He.vi,U.xs,null===(l=null===(s=c.properties.lineColor)||void 0===s?void 0:s.solid)||void 0===l?void 0:l.color),selector:c.selector,featureSwitches:this.featureSwitchService.featureSwitches,localize:o,isSVGStroke:!0});v.addSlices(y.map(function(N){return N.build()})),u.push.apply(u,Object.values(g));var C=[{type:"enumeration",sliceName:"position",propertyName:Z.FK}];le(v,m,c,r,o,C),u.push.apply(u,_.map(C,function(N){return{objectName:m,propertyName:N.propertyName}}))}return{group:v.build(),descriptors:u}}function gn(n,e,t,r,i,a,o){var s,l=t.visualObjectInstance;if("ConstantX"===e&&l.properties.hasOwnProperty(Z.rS)&&_.has(r.objects[i.objectName].properties,Z.rS)){var u=new S.mQ(new S.SS(n,"shadeArea"),o),c=_.find(lr.dt.members(),function(y){return y.value===lr.YP}),v=l.properties[Z.rS]!==c.value;u.withDisplayName("Visual_Shapes_ShadeArea").addTopLevelToggle("shadeAreaShow",function(){return new S.bd({descriptor:(0,p.pi)((0,p.pi)({},i),{propertyName:Z.rS}),value:v}).build()});var h=_.chain(lr.dt.members()).filter(function(y){return y.value!==c.value}).map(function(y){return{value:y.value,displayName:(0,Ce.G)(y.displayName,a)}}).value(),f=l;v||((f=(0,p.pi)({},l)).properties=(0,p.pi)({},l.properties),f.properties[Z.rS]=null===(s=_.first(h))||void 0===s?void 0:s.value,_.has(f.properties,Z.HO)||(f.properties[Z.HO]={solid:{color:"#000"}}),_.has(f.properties,Z.af)||(f.properties[Z.af]=0));var m=f.properties[Z.rS];u.addSimpleSlice("shadePosition",function(){return new S.uY({descriptor:(0,p.pi)((0,p.pi)({},i),{propertyName:Z.rS}),items:h,value:_.find(h,function(y){return y.value===m})}).build()},function(y){y.withCustomDisplayName("Visual_Position")}),le(u,f.objectName,f,r,o,[{type:"color",sliceName:"shadeColor",propertyName:Z.HO,customDisplayNameKey:"Generic_Color"},{type:"transparency",sliceName:"shadeTransparency",propertyName:Z.af,customDisplayNameKey:"Transparency"}]);var g=[];return g.push({objectName:i.objectName,propertyName:Z.rS}),g.push({objectName:l.objectName,propertyName:Z.HO}),g.push({objectName:l.objectName,propertyName:Z.af}),{group:u.build(),descriptors:g}}}function yn(n,e,t,r,i){var a=[],o=new S.mQ(new S.SS(n,"dataLabel"),i),s=e.visualObjectInstance,l=s.properties.dataLabelShow;o.withDisplayName("Visual_Reference_Line_Data_Label").addTopLevelToggle("dataLabelShow",function(){return new S.bd({descriptor:(0,p.pi)((0,p.pi)({},r),{propertyName:Z.yl}),value:l}).build()}),a.push({objectName:r.objectName,propertyName:Z.yl});var u=[{type:"enumeration",sliceName:"dataLabelHorizontalPosition",propertyName:Z.nR},{type:"enumeration",sliceName:"dataLabelVerticalPosition",propertyName:Z.G5},{type:"enumeration",sliceName:"dataLabelText",propertyName:Z.Zs,customDisplayNameKey:"Style"},{type:"color",sliceName:"dataLabelColor",propertyName:Z.UD},{type:"enumeration",sliceName:"dataLabelDisplayUnits",propertyName:Z.XI},{type:"numUpDown",sliceName:"dataLabelDecimalPoints",propertyName:Z.pw,options:{min:0,max:ve.MaxPrecision,placeholderTextKey:"Visual_Auto"}}],c=s.objectName;l?le(o,c,s,t,i,u):o.addSimpleSlice("dataLabelNotAvailableMessage",function(){return new S.G_({descriptor:{objectName:c,selector:s.selector,propertyName:void 0},value:i("AnalyticsPane_DataLabelGroup_NotAvailable_Message")}).build()}),a.push.apply(a,_.map(u,function(v){return{objectName:c,propertyName:v.propertyName}}));var d=o.build();return l||(d.slices[0].disabled=!0),{group:d,descriptors:a}}function Ri(n,e,t,r){T.fF.assertValue(n,"instance must be defined");var i=(0,k.NA)(t,{objectName:At,propertyName:Z.S3},n.selector),a=n;e&&((a=_.cloneDeep(n)).properties||(a.properties={}),a.properties[Z.$Z]=!1,a.properties[Z.ss]="",a.properties[Z.yl]=!1,a.selector=null);var o=i;if(!o||!(0,H.iV)(o)&&!(0,H.T5)(o))return{visualObjectInstance:a,isDefaultInstance:e,type:void 0};var s=o.arg;if(!s)return{visualObjectInstance:a,isDefaultInstance:e,type:void 0};var c,d,l=r.withName(s.expressionName),u=l?l.name:void 0;return!e&&(0,H.T5)(o)?(c=100*o.k,d="Percentile"):(0,H.X5)(o)?d="Min":(0,H.lg)(o)?d="Max":(0,H.Xx)(o)?d="Median":(0,H.Ny)(o)&&(d="Average"),{visualObjectInstance:a,isDefaultInstance:e,type:d,measureName:u,percentileValue:c}}function Wi(n,e,t,r,i,a){T.fF.assert(function(){return null!=n},"Expect referenceLineType to be defined"),T.fF.assertValue(e,"Expect selector to be defined"),T.fF.assertValue(r,"Expect measureName to be defined"),T.fF.assertAnyValue(i,"");var o={objectName:At,selector:e,properties:{}};if(!t||o.selector.metadata!==r){if(o.selector.metadata!==r){var s=(0,W.GQ)(a);s&&(0,k.xl)(s,At,o.selector,{id:o.selector.id,metadata:r}),o.selector.metadata=r}var u=(0,Gi[n])((0,Ye.xA)(r),i);return o.properties.value=u,o}}function Vt(n){return"ConstantX"===n?de.xAxisReferenceLine.objectName:"ConstantY1"===n?de.y1AxisReferenceLine.objectName:_.includes(_t,n)?At:n===_e?At+"-default":void T.fF.assertFail("should always return an objectName")}function Hi(n){return"ConstantX"===n?de.xAxisReferenceLine.objectName:"ConstantY1"===n?de.y1AxisReferenceLine.objectName:_.includes(_t,n)?bt[n]:n===_e?At+"-default":void T.fF.assertFail("should always return an objectName")}function bn(n){if("ConstantX"===n)return"xAxisReferenceLine";if("ConstantY1"===n)return"y1AxisReferenceLine";if(_.includes(_t,n)){if("Min"===n)return"referenceLine-minLine";if("Max"===n)return"referenceLine-maxLine";if("Average"===n)return"referenceLine-averageLine";if("Median"===n)return"referenceLine-medianLine";if("Percentile"===n)return"referenceLine-percentileLine"}T.fF.assertFail("should always return card name")}function Ki(n,e){return(0,p.mG)(this,void 0,void 0,function(){var t,r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return[4,Ee(n,e)];case 1:return(t=i.sent())?(r=M.G.normalize(t),[2,r?.instances]):[2]}})})}function Ji(n){return n.uid.split("-")[0]}var J=b(9215),ti=b(92783),ri=b(45221),qn=b(6426),rr=b(93599),ae=b(78432),Fe=b(24408),Ct=b(50550),Ut=b(28488),St=b(80777),ii=b(98407),ur=b(28894),Ar=b(59897);function Dn(n){if((0,Ar.Gl)(n.type))return(0,Ar.AG)(n.type.fill.solid.color)}function ut(n,e){return{objectName:e,propertyName:n.name,selector:n.selector,propertyTypes:n.type,instanceKind:n.dynamicExpressionSupport?3:void 0,altConstantValueSelector:n.altConstantValueSelector}}function ai(n,e){var t,r,i,a,o,s,l,u,c,d,v,h,f,m,g;if(n){var y=function(n){var e=Fe.TW(n);switch(e){case"alignment":return"AlignmentGroup";case"fill":return"ColorPicker";case"fontPicker":return"FontPicker";case"image":return"ImageUpload";case"numeric":case"numericSelection":case"numericUnitSelection":return"NumUpDown";case"selection":case"propertyPaneSelection":return"Dropdown";case"slider":return"Slider";case"bool":return"ToggleSwitch";case"geoJson":return"ShapeMapSelector";case"gradientBar":return"GradientBar";case"duration":return"DurationPicker";case"dateTime":return"DatePicker";case"text":return"TextInput";case"textarea":return"TextArea";case"readOnlyText":return"ReadOnlyText";case"linkButton":return"Link";case"flagsSelection":return"FlagsSelection";default:T.fF.assertNever(e)}}(n),C={displayName:n.displayName,description:n.description,uid:e+"-"+n.name};switch(n.showLinkButtonOnly&&(y="Link",C=(0,p.pi)((0,p.pi)({},C),{displayName:n.linkButtonDisplayName})),y){case"ColorPicker":return(0,p.pi)((0,p.pi)({},C),{control:{type:"ColorPicker",properties:{descriptor:ut(n,e),value:n.value,isNoFillItemSupported:Dn(n)}}});case"Dropdown":return(0,p.pi)((0,p.pi)({},C),{control:{type:"Dropdown",properties:{descriptor:ut(n,e),items:n.selectionOptions,value:null!==(t=_.find(n.selectionOptions,function(j){return j.value===n.value}))&&void 0!==t?t:n.selectionOptions[0]}}});case"DurationPicker":return(0,p.pi)((0,p.pi)({},C),{control:{type:"DurationPicker",properties:{descriptor:ut(n,e),value:n.value,validators:n.validators}}});case"GradientBar":return(0,p.pi)((0,p.pi)({},C),{suppressDisplayName:!0,control:{type:"GradientBar",properties:{descriptor:ut(n,e),value:n.value}}});case"Slider":case"NumUpDown":var N=null!==(i=null===(r=n.numericValueOptions)||void 0===r?void 0:r.minValue)&&void 0!==i?i:null===(a=n.validators)||void 0===a?void 0:a.min,D=null!==(s=null===(o=n.numericValueOptions)||void 0===o?void 0:o.maxValue)&&void 0!==s?s:null===(l=n.validators)||void 0===l?void 0:l.max;return T.fF.assert(function(){return _.isUndefined(N)||_.isNumber(N)},"minValue must be a number"),T.fF.assert(function(){return _.isUndefined(D)||_.isNumber(D)},"maxValue must be a number"),(0,p.pi)((0,p.pi)({},C),{control:{type:y,properties:{descriptor:ut(n,e),value:n.value,options:{unitSymbol:null===(u=n.numericValueOptions)||void 0===u?void 0:u.unitSymbol,minValue:{type:0,value:N},maxValue:{type:1,value:D}},placeholderText:n.placeholder}}});case"TextArea":case"TextInput":var w={};return!(null===(c=n.validators)||void 0===c)&&c.required&&(w.required={type:2}),!(null===(d=n.validators)||void 0===d)&&d.pattern&&(w.pattern={type:3,regex:n.validators.pattern}),!(null===(v=n.validators)||void 0===v)&&v.dashArray&&(w.dashArray={type:4}),!(null===(h=n.validators)||void 0===h)&&h.maxLength&&(w.maxLength={type:5,value:n.validators.maxLength}),(0,p.pi)((0,p.pi)({},C),{control:{type:y,properties:{descriptor:ut(n,e),value:n.value,placeholder:null!==(f=n.placeholder)&&void 0!==f?f:"",validators:w}}});case"ToggleSwitch":return(0,p.pi)((0,p.pi)({},C),{control:{type:"ToggleSwitch",properties:{descriptor:ut(n,e),value:n.value}}});case"AlignmentGroup":var F=void 0;switch(n.name){default:T.fF.assertFail('Unexpected alignment group name "'.concat(n.name,'"'));case"horizontalAlignment":F="horizontalAlignment";break;case"verticalAlignment":F="verticalAlignment"}return(0,p.pi)((0,p.pi)({},C),{control:{type:"AlignmentGroup",properties:{descriptor:ut(n,e),mode:F,value:n.value}}});case"ImageUpload":return(0,p.pi)((0,p.pi)({},C),{control:{type:"ImageUpload",properties:{descriptor:ut(n,e),value:n.value}}});case"ShapeMapSelector":return(0,p.pi)((0,p.pi)({},C),{control:{type:"ShapeMapSelector",properties:{descriptor:ut(n,e),value:{type:n.value.type,name:n.value.name,content:n.value.content}}}});case"DatePicker":var V=null===(m=n.validators)||void 0===m?void 0:m.min,I=null===(g=n.validators)||void 0===g?void 0:g.max;return T.fF.assert(function(){return _.isUndefined(V)||_.isDate(V)},"minValue must be a Date"),T.fF.assert(function(){return _.isUndefined(I)||_.isDate(I)},"maxValue must be a Date"),(0,p.pi)((0,p.pi)({},C),{control:{type:"DatePicker",properties:{descriptor:ut(n,e),value:n.value,validators:{min:{type:0,value:V},max:{type:1,value:I}},placeholder:n.placeholder}}});case"FontPicker":return(0,p.pi)((0,p.pi)({},C),{control:{type:"FontPicker",properties:{descriptor:ut(n,e),value:n.value}}});case"ReadOnlyText":return(0,p.pi)((0,p.pi)({},C),{control:{type:"ReadOnlyText",properties:{descriptor:ut(n,e),value:n.value}}});case"Link":return(0,p.pi)((0,p.pi)({},C),{control:{type:"Link",properties:{descriptor:ut(n,e),value:n.linkButtonAction}},suppressDisplayName:n.showLinkButtonOnly});case"FlagsSelection":return(0,p.pi)((0,p.pi)({},C),{control:{type:"FlagsSelection",properties:{descriptor:ut(n,e),items:n.selectionOptions,value:n.value}}});default:T.fF.assertNever(y)}}}var cr=b(93188),wn=b(35598),Qi=b(21728),R=b(67746),xr=b(55133),ze=b(93573),Fn=b(1521),Nn=b(29324),Sr=b(52083),Tn=b(96915),ni=b(17966),kt=b(39503),oi=b(17328),zr=b(84281),$i=b(4877),br=b(67660),qr=b(72262),Cr=b(69866),Vn=[ve.SliceNameAxisStart,ve.SliceNameAxisEnd,ve.SliceNameStart,ve.SliceNameEnd,ve.SliceNameSecStart,ve.SliceNameSecEnd],si=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.conditionalFormattingUtilsService=r,this.dataSources=i,this.explorationNavigation=a,this.featureSwitchService=o,this.formFactor=s,this.itemPicker=l,this.lazyScoped=u,this.localizationService=c,this.runningVisuals=d,this.selectionService=v,this.telemetryService=h,this.themeService=f,this.undoRedo=m,this.visualAuthoring=g,this.visualPlugin=y,this.visualStylePresetService=C,this.hasServicesLoaded=this.loadServices()}return n.prototype.loadServices=function(){return(0,p.mG)(this,void 0,void 0,function(){var e,t;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return this.conditionalFormattingDialogLauncher?[3,2]:(e=this,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:e.conditionalFormattingDialogLauncher=r.sent(),r.label=2;case 2:return this.dataBarsDialogLauncher?[3,4]:(t=this,[4,this.lazyScoped.get("dataBarsDialogLauncherService")]);case 3:t.dataBarsDialogLauncher=r.sent(),r.label=4;case 4:return[2]}})})},n.prototype.getFormattingModel=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t=this;return(0,p.Jh)(this,function(r){return[2,this.hasServicesLoaded.then(function(){return(0,p.mG)(t,void 0,void 0,function(){var i,a;return(0,p.Jh)(this,function(o){switch(o.label){case 0:return[4,this.getPropertyPaneViewModel(e)];case 1:return i=o.sent(),a={cards:[]},e&&i&&(a.cards=this.createCards(i,e.config.singleVisual.visualType)),[2,a]}})})})]})})},n.prototype.convertLegacyToModernCards=function(e,t){var r=this;return e.reduce(function(i,a){var o,s;if(a.name===R.T9)s=r.getConditionalFormattingCard();else{var l=r.createNormalGroup(a);s={displayName:a.displayName,uid:a.id,description:a.description,disabled:!1,groups:0!==l.slices.length||l.container?[l]:[],topLevelToggle:r.getTopLevelToggle(a),revertToDefaultDescriptors:null!==(o=a.customRevertToDefaultDescriptors)&&void 0!==o?o:r.getRevertToDefaultDescriptor(a.name,t),analyticsPane:a.analyticsPane}}return s&&i.push(s),i},[])},n.prototype.createCards=function(e,t){var r=this.visualPlugin.capabilities(t).objects;return this.convertLegacyToModernCards(e.cards,r)},n.prototype.getConditionalFormattingCard=function(){var e=this,t=Qi.UP.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);if((0,J.Vz)(t)){var r=this.runningVisuals.getVisual(t);if(r&&r.getAdapter()){var i=r.getAdapter(),a=i.enumerateObjectRepetition&&i.enumerateObjectRepetition();if(!a)return;var u=this.visualPlugin.capabilities(t.config.singleVisual.visualType).objects;return(0,Nn.Z)(a,function(v){return e.localizationService.get(v)},u,"FieldWell_ConditionalFormatting","")}}},n.prototype.getRevertToDefaultDescriptor=function(e,t){var r,i=null===(r=t[e])||void 0===r?void 0:r.properties;if(i)return Object.keys(i).map(function(a){return{objectName:e,propertyName:a}})},n.prototype.getTopLevelToggle=function(e){var t=e?ai(e.mainShow,e.name):void 0;return t&&(t.displayName=void 0,t.description=void 0,t.suppressDisplayName=!0),t},n.prototype.createNormalGroup=function(e){for(var t,r={displayName:void 0,uid:e.id+"-group",slices:[],disabled:!1},i={},a=0,o=e.slices;a<o.length;a++){var s=o[a],l=ai(s,null!==(t=s.customObjectName)&&void 0!==t?t:e.name);void 0===i[s.name]?i[s.name]=0:(i[s.name]++,l.uid="".concat(l.uid,"-").concat(i[s.name])),l&&r.slices.push(l)}return r.container=e.containers?this.createContainers(e,r.uid):void 0,r},n.prototype.createContainers=function(e,t){var r=t+"-container";return{displayName:e.containersLabel,description:e.containersTooltip,containerItems:e.containers.map(function(a){return{displayName:a.displayName,slices:a.slices.reduce(function(o,s){var l,u=ai(s,null!==(l=s.customObjectName)&&void 0!==l?l:e.name);return u&&o.push(u),o},[]),disabled:a.isDisabled,uid:r+a.displayName}}),isEditable:e.containersEditable,uid:r}},n.prototype.getPropertyPaneViewModel=function(e,t,r,i,a){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,w,V;return(0,p.Jh)(this,function(I){switch(I.label){case 0:return e?(s=this.formFactor.getCurrentLayout(),l={height:xr.aW,width:xr.Co},u=e.layouts.withId(s).position,c=(0,W.hP)(u,s,e.parentGroup),d={x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height)},v=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),h=1===s?l:this.explorationNavigation.getCurrentSection().size,(f=this.runningVisuals.getVisual(e))&&f.getAdapter()?(g=(m=e.config.singleVisual).visualType,y=f.getAdapter(),C=m.objects,(N=this.visualPlugin.capabilities(g))&&N.objects?(D=m.evaluatedObjects&&m.evaluatedObjects.title,w=function(n,e){if(e&&e.config&&e.config.singleVisual){var t=e.config.singleVisual,r=n.capabilities(e.config.singleVisual.visualType),i=(0,Sr.Zn)(r.objects);if(i&&i.inputRole){var a=void 0;return null!=t&&null!=(a=t.query)&&null!=a.projections&&null!=a.projections[i.inputRole]&&(0,wn.mx)(i.conditions,a.projections,(0,W.i1)(a))}return!1}}(this.visualPlugin,e),V={visual:y,dataBarsDialogLauncher:this.dataBarsDialogLauncher,conditionalFormattingDialogLauncher:this.conditionalFormattingDialogLauncher,capabilities:N,visualConfig:m,visualContainer:e,visualTitle:D,visualObjectDefns:C,visualContainerPosition:d,showGradientCard:w,selectedContainers:t,selectedVisualType:g,shouldIncludeObject:function(L){return!L||1===L},localizationService:this.localizationService,dataSourcesService:this.dataSources,visualAuthoring:this.visualAuthoring,visualStyle:v,runningVisual:this.runningVisuals.getVisual(e),sectionSize:h,canvasLayout:s,excludeObjectRepetition:r,disabledSliceTypes:a,excludeConditionalFormattingCard:i},f&&y===f.getAdapter()?[4,this.createViewModelForVisual(V)]:[3,2]):[3,2]):[3,2]):[3,3];case 1:o=I.sent(),I.label=2;case 2:return[3,4];case 3:o=this.createEmptyViewModel(),I.label=4;case 4:return[2,o]}})})},n.prototype.createViewModelForVisual=function(e){var t=this.createEmptyViewModel();return this.populatePaneForVisual(t,e)},n.prototype.createEmptyViewModel=function(){return{selectedVisualType:null,cards:(0,Ct.bv)()}},n.prototype.populatePaneForVisual=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return r=cr.XK(t),[4,this.populatePane(e,r)];case 1:return i.sent(),e.cards=(0,Ct.z8)(_.sortBy(e.cards,function(a){return a.index})),e.selectedVisualType=t.selectedVisualType,this.addValidation(e,t.sectionSize),[2,e]}})})},n.prototype.populatePane=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.Jh)(this,function(o){for(i in T.fF.assertValue(e,"model"),T.fF.assertValue(t,"options"),T.fF.assertValue(t.objectDescriptors,"options.objectDescriptors"),e.selectedContainers=t.selectedContainers,r=[],t.objectDescriptors)r.push(this.populateCard(e,t,i,t.cardIndexCounter++));return[2,Promise.allSettled(r).then(function(){t.showGradientCard&&!e.cards.withName(R.ph)&&a.populateGradientCard(e,t.objectDefinitions,!1,t,t.cardIndexCounter++),t.enumerateObjectRepetition&&!t.excludeConditionalFormattingCard&&(a.conditionalFormattingUtilsService.populateConditionalFormattingCard(e,t),t.cardIndexCounter++);var s=e.cards.withName(R.LQ);s&&(s.index=-2);var l=e.cards.withName(R.H);return l&&(l.index=-1),e})]})})},n.prototype.populateCard=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.Jh)(this,function(c){switch(c.label){case 0:return(a=t.objectDescriptors[r])?t.shouldIncludeObject&&!t.shouldIncludeObject(a.objectCategory)?[2]:[4,t.enumerateObjectInstances(r)]:[2];case 1:return o=c.sent(),!(s=M.G.normalize(o))||_.isEmpty(s.instances)?(t.showGradientCard&&"dataPoint"===r&&this.populateGradientCard(e,t.objectDefinitions,!1,t,i),[2]):((l=e.cards.withName(r))||(u=!!(t.objectDefinitions&&t.objectDefinitions[r]&&t.objectDefinitions[r].length>0),l={name:r,id:Fe.Yb(t.visualType,r),index:i,displayName:(0,ze.Gf)(a.displayName,this.localizationService)||r,description:(0,ze.Gf)(a.description,this.localizationService),slices:(0,Ct.bv)(),footer:[],mainShow:null,isDirty:u},e.cards.push(l)),[4,this.addSlices(l,s,a,t)]);case 2:return c.sent(),Fe.ht(t,l),l.name!==R.LQ&&this.addFooterSlicesToCard(l,t),[2]}})})},n.prototype.addFooterSlicesToCard=function(e,t){var r=R.tV;if(!_.some(e.footer,function(o){return o.name===r})){if(e.name===R.Z0){var i={applyToAllPages:!0};e.footer.push({value:e.isDirty,name:R.Kp,displayName:"",type:i,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,R.Kp,i,t.disabledSliceTypes),save:t.save})}var a={revertToDefault:!0};e.footer.push({value:e.isDirty,name:r,displayName:"",type:a,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,r,a,t.disabledSliceTypes),save:t.save})}},n.prototype.getShowSliceValue=function(e,t,r){if(e.name===ve.PlotAreaCardName&&r){var i=r.properties[ve.ImageSliceName];if(i&&(t===ve.ImageFitSliceName||t===ve.TransparencySliceName))return null!=i.url}return!0},n.prototype.populateGradientCard=function(e,t,r,i,a){var o=(0,Sr.Vn)(t);if(o){var s=this.createGradientCard(e,o,r,i,a);e.cards.push(s),this.addFooterSlicesToCard(s,i)}},n.prototype.addSlices=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h;return(0,p.Jh)(this,function(f){switch(f.label){case 0:T.fF.assertValue(e,"propertyPaneCard"),T.fF.assertValue(t,"enumeration"),T.fF.assertValue(r,"objectDescriptor"),a=i.isDisabled,t.containerInfo&&!_.isEmpty(t.containers)&&(e.containersLabel=(0,ze.Gf)(t.containerInfo.containersLabel,this.localizationService),e.containersTooltip=(0,ze.Gf)(t.containerInfo.containersTooltip,this.localizationService)),o=0,s=t.instances,f.label=1;case 1:return o<s.length?(u=r.properties,c=(l=s[o]).properties,null==l.containerIdx?[3,3]:(d=M.G.getContainerForInstance(t,l),v=Fe.Yl(e.name,l.containerIdx),h={name:v,displayName:(0,ze.Gf)(d.displayName,this.localizationService),value:v,selector:l.selector,containerIndex:l.containerIdx,isDisabled:!1,slices:(0,Ct.bv)()},e.containers||(e.containers=(0,Ct.bv)()),[4,this.createSlices(l,u,i,c,e,a,h.slices,h.displayName)])):[3,6];case 2:return f.sent(),e.containers.push(h),[3,5];case 3:return[4,this.createSlices(l,u,i,c,e,a,e.slices)];case 4:f.sent(),f.label=5;case 5:return o++,[3,1];case 6:return[2]}})})},n.prototype.createSlices=function(e,t,r,i,a,o,s,l){return(0,p.mG)(this,void 0,void 0,function(){var u,c,d,v,h,f,m,g,y;return(0,p.Jh)(this,function(N){switch(N.label){case 0:for(g in d=this.getPropertyWarning(c=(u=r.visualWarningCollection&&r.visualWarningCollection.visualObjectWarnings)&&u[a.name]||[]),v=function(w){var F,V,I,j,L,x,z,A,G,X,te,Se,Ue,Ae,Ie,mt;return(0,p.Jh)(this,function(pt){switch(pt.label){case 0:return Fe.Ke(F=t[w])?(V=e.selector?e.displayName:void 0,I=(0,ze.Gf)(F.displayName,h.localizationService),j=(0,ze.Gf)(F.description,h.localizationService),L=(0,ze.Gf)(F.placeHolderText,h.localizationService),x=w===ve.ImageSliceName||w===ve.MapSliceName?"":V||I||w,z=St.Ge.fromDescriptor(F.type),[4,Fe.cn({propertyType:z,instance:e,propertyName:w,paneServices:{bookmarkService:h.bookmarkService,dataSourcesService:h.dataSources,explorationNavigation:h.explorationNavigation,localizationService:h.localizationService,visualStylePresetService:h.visualStylePresetService},visualType:r.visualType})]):[2,"continue"];case 1:return A=pt.sent(),G=h.getPropertyDescriptorType(F.type,e.propertyTypes&&e.propertyTypes[w]),X=h.getPropertyValue(i[w],A,G,w,r),"strictSingleSelect"===(te={name:w,displayName:x,description:j,type:G,selector:e.selector,altConstantValueSelector:e.altConstantValueSelector,value:X,show:h.getShowSliceValue(a,w,e),placeholder:L,isValid:!0,isDisabled:o||h.isSliceDisabled(a,w,G,r.disabledSliceTypes),containerIndex:e.containerIdx,save:r.save,selectionOptions:A}).name&&h.shouldDisableStrictSelectionDueToMappedColumn(r.visualContainer,te),e.propertyInstanceKind&&3===e.propertyInstanceKind[w]&&h.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(e,w,G,F,r.objectDefinitions,te,r.localizationService,c,{featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation,visualContainer:r.visualContainer,conditionalFormattingDialogLauncher:h.conditionalFormattingDialogLauncher},a.displayName,te.selector?l:void 0),(Se=h.getNumericValueOptionsFromValidValues(e,te)||Fe.X_(te))&&(te.numericValueOptions=Se),h.configureValidators(e,te),w===R.di?(d&&(te.warningMessage=Fe.qb(d,r.localizationService,!0)),a.mainShow=te):s.push(te),(!!(Ue=(0,k.NA)(r.objectDefinitions,{objectName:"dataPoint",propertyName:"fill"},{data:[(0,Tn.Ue)(1)]}))||h.featureSwitchService&&h.featureSwitchService.featureSwitches.cartesianConditionalFormatting)&&e.propertyInstanceKind&&e.propertyInstanceKind[w]&&(1&(Ae=e.propertyInstanceKind[w])||(te.showLinkButtonOnly=!0),2===Ae&&r.conditionalFormattingDialogLauncherFactory&&(T.fF.assert(function(){return!(2===Ae&&void 0!==e.altConstantValueSelector)},"Rule-only property kind with alt selector is not supported."),Ie={featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation},mt=h.themeService.getVisualStyle(h.explorationNavigation.getCurrentExploration().themeCollection),h.conditionalFormattingUtilsService.addDialogLauncherToSlice(Ie,r.conditionalFormattingDialogLauncherFactory,r.visualContainer,e,Ue,F,a,te,mt))),[2]}})},h=this,m=[],f=i)m.push(g);y=0,N.label=1;case 1:return y<m.length?(g=m[y])in f?[5,v(g)]:[3,3]:[3,4];case 2:N.sent(),N.label=3;case 3:return y++,[3,1];case 4:return d&&!a.mainShow&&(a.mainShow=this.createWarningPlaceHolderSlice(Fe.qb(d,r.localizationService,!0),e,r,o)),[2]}})})},n.prototype.configureValidators=function(e,t){var r,i=St.Ge.fromDescriptor(t.type);i.numeric?(r=this.getVisualObjectValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.numberRange):i.duration&&(r=this.getDurationPickerValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.durationRange)},n.prototype.shouldDisableStrictSelectionDueToMappedColumn=function(e,t){var r,i,a,o;return(0,p.mG)(this,void 0,void 0,function(){var s,l,u,d;return(0,p.Jh)(this,function(v){switch(v.label){case 0:return s=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(s)];case 1:return(l=v.sent())?(!(u=null===(o=null===(a=null===(i=null===(r=e?.config)||void 0===r?void 0:r.singleVisual)||void 0===i?void 0:i.query)||void 0===a?void 0:a.defn)||void 0===o?void 0:o.select())&&u?.length>1||(d=qe.m.getConceptualParameterMetadata(u[0].expr,l),1===d?.kind&&!d?.supportsMultipleValues&&(t.isDisabled=!0)),[2]):[2]}})})},n.prototype.getVisualObjectValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.numberRange&&_.isNumber(i.numberRange.max)&&_.isNumber(i.numberRange.min))return i}},n.prototype.getDurationPickerValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.durationRange)return i}},n.prototype.getNumericValueOptionsFromValidValues=function(e,t){var r=St.Ge.fromDescriptor(t.type);if(r.integer||r.formatting&&r.formatting.fontSize){var i=this.getVisualObjectValidationOptionsFromValidValues(e,t.name);if(i&&i.numberRange)return{minValue:i.numberRange.min,maxValue:i.numberRange.max,unitSymbol:i.unitSymbol||""}}},n.prototype.getPropertyDescriptorType=function(e,t){var r=St.Ge.fromDescriptor(e);if(!r.variant)return e;T.fF.assertValue(t,"propertyTypes");for(var i=St.Ge.fromDescriptor(t),a=0,o=r.variant;a<o.length;a++)if(i.isCompatibleFrom(o[a]))return t},n.prototype.getPropertyValue=function(e,t,r,i,a){if(null==e)return e;if(t)return Fe.vw(t,e);if(!r.numeric||_.isFinite(parseFloat(e))){if(this.isFillProperty(r)){var o=e&&e.solid?e.solid.color:e;e={value:(0,Fn.SW)(o&&o.toString())}}return r.formatting&&r.formatting.stylePreset&&(T.fF.assertValue(a.visualType,"propertyPaneViewModelFactory.getPropertyValue - visualType should exist to set a stylePreset"),e={visualType:a.visualType,stylePresetName:e}),e}},n.prototype.getPropertyWarning=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.warnings)for(var a=0,o=i.warnings;a<o.length;a++)return o[a]}},n.prototype.createWarningPlaceHolderSlice=function(e,t,r,i){var a="warningPlaceHolder";return{name:a,displayName:"",type:null,selector:t.selector,value:"",show:!0,placeholder:a,isValid:!0,isDisabled:i,containerIndex:t.containerIdx,save:r.save,warningMessage:e}},n.prototype.createGradientCard=function(e,t,r,i,a){var o=e.cards.withName(R.ph);o||(o={name:R.ph,id:Fe.Yb(i.visualType,R.ph),index:a,displayName:(0,ze.Gf)((0,Ce.V)("Visual_DataPoint"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_DataPointDescription"),this.localizationService),slices:(0,Ct.bv)(),footer:[],mainShow:null,isDirty:r});var s=this.itemPicker.getDataColors().getGradientColors(),l=(0,Sr.Ym)(t),u="diverging",c={bool:!0};return o.slices.push({value:l.diverging,name:u,displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_Diverging"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_DivergingDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),u="gradientBar",c={none:!0},o.slices.push({value:(0,Sr.Kj)(l,s),name:u,displayName:"gradientBar",type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.minColor||s.minColor.value},name:u="minColor",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MinColor"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MinColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:{value:l.midColor||s.midColor.value},name:u="midColor",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MidColor"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MidColorDescription"),this.localizationService),type:{fill:{solid:{color:!0}}},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.maxColor||s.maxColor.value},name:u="maxColor",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MaxColor"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MaxColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={numeric:!0},o.slices.push({value:l.minValue,name:u="minValue",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MinValue"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MinValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:l.midValue,name:u="midValue",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MidValue"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MidValueDescription"),this.localizationService),type:{numeric:!0},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={numeric:!0},o.slices.push({value:l.maxValue,name:u="maxValue",displayName:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MaxValue"),this.localizationService),description:(0,ze.Gf)((0,Ce.V)("Visual_Gradient_MaxValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o},n.prototype.isFillProperty=function(e){return null!=e.fill},n.prototype.isSliceDisabled=function(e,t,r,i){return null!=e.mainShow&&!1===e.mainShow.value&&!this.isSliceAlwaysEnabled(t)||!!i?.some(function(a){return!!r[a]})},n.prototype.isSliceAlwaysEnabled=function(e){switch(e){case R.di:case R.b4:case R.tV:case ve.SliceNameStart:case ve.SliceNameEnd:case ve.SliceNameInvertAxis:case ve.SliceNameSecStart:case ve.SliceNameSecEnd:case ve.SliceNameSecInvertAxis:case R.V1:case R.jv:case R.Kp:return!0;default:return!1}},n.prototype.addValidation=function(e,t){for(var r=0,i=e.cards;r<i.length;r++){var a=i[r];switch(a.name){case R.rR:case R.$l:case R.mn:this.setAxisValidationLimitations(a);break;case R.LQ:this.setGeneralValidationLimitations(a,t);break;default:for(var o=0,s=a.slices;o<s.length;o++)this.setSliceValidation(s[o])}if(!_.isEmpty(a.containers))for(var u=0,c=a.containers;u<c.length;u++)for(var v=0,h=c[u].slices;v<h.length;v++)this.setSliceValidation(h[v])}return e},n.prototype.setSliceValidation=function(e){var t=St.Ge.fromDescriptor(e.type);t.misc&&t.misc.webUrl&&(e.validators||(e.validators={}),e.validators.url=!0),(t.numeric||t.integer||t.dateTime)&&"indicatorPrecision"===e.name&&(e.validators={max:ve.MaxPrecision})},n.prototype.setGeneralValidationLimitations=function(e,t){for(var r=0,i=e.slices;r<i.length;r++){var a=i[r],o=a.name;switch(a.validators={},o){case R.Lu:var s=e.slices.withName(R.X),l=parseFloat(s.value);a.validators.max=t.width-l,a.validators.min=ve.MinContainerWidth,a.validators.integer=!0,a.validators.required=!0;break;case R.oU:var u=e.slices.withName(R.Y),c=parseFloat(u.value);a.validators.max=t.height-c,a.validators.min=ve.MinContainerHeight,a.validators.integer=!0,a.validators.required=!0;break;case R.X:var d=e.slices.withName(R.Lu),v=parseFloat(d.value);a.validators.max=t.width-v,a.validators.min=0,a.validators.integer=!0,a.validators.required=!0;break;case R.Y:var h=e.slices.withName(R.oU),f=parseFloat(h.value);a.validators.max=t.height-f,a.validators.min=0,a.validators.integer=!0,a.validators.required=!0}}},n.prototype.setAxisValidationLimitations=function(e){for(var t=0,r=e.slices;t<r.length;t++){var i=r[t],a=i.name;if(_.includes(Vn,a)){var o=St.Ge.fromDescriptor(i.type);i.validators={};for(var s=0,l=e.slices;s<l.length;s++){var u=l[s];if(a===ve.SliceNameStart&&u.name===ve.SliceNameEnd||a===ve.SliceNameSecStart&&u.name===ve.SliceNameSecEnd||a===ve.SliceNameAxisStart&&u.name===ve.SliceNameAxisEnd)if(o.dateTime)i.validators.max=u.value;else{var c=parseFloat(u.value);i.validators.max=_.isFinite(c)?c:void 0,i.validators.decimal=!0}else(a===ve.SliceNameEnd&&u.name===ve.SliceNameStart||a===ve.SliceNameSecEnd&&u.name===ve.SliceNameSecStart||a===ve.SliceNameAxisEnd&&u.name===ve.SliceNameAxisStart)&&(o.dateTime?i.validators.min=u.value:(c=parseFloat(u.value),i.validators.min=_.isFinite(c)?c:void 0,i.validators.decimal=!0))}}else this.setSliceValidation(i)}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(ni.F),q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(ii.z),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(oi.F),q.\u0275\u0275inject($i.a),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(qr.z),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(br.f),q.\u0275\u0275inject(zr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(Cr.A))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),li=function(){function n(e,t,r,i,a,o,s,l,u){this.conditionalFormattingUtilsService=e,this.featureSwitchService=t,this.lazyScoped=r,this.legacyVisualFormattingService=i,this.localizationService=a,this.referenceLineHelper=o,this.undoRedoService=s,this.visualAuthoring=l,this.visualPluginService=u}return n.prototype.getFormattingCards=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s=this;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return[4,this.buildAnalyticsCards(e,i,t,r)];case 1:return a=l.sent(),_.isEmpty(a)?[2]:(o=_.map(a,function(u,c){return s.convertToPropertyPaneCard(u,c)}),[2,this.legacyVisualFormattingService.convertLegacyToModernCards(o,i.objects)])}})})},n.prototype.getPropertyDisplayName=function(e,t){if(T.fF.assertValue(e,"propertyName must be defined"),T.fF.assertAnyValue(t,"propertyDescriptor is allowed to have any value"),t){var r=(0,Ce.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r}},n.prototype.getNonReferenceCardDisplayName=function(e,t,r){var a=1!==ui(e)&&r>0,o=_.find(de,function(l){return l.objectName===e}),s=o?this.localizationService.get(o.displayNameBaseKey):this.getObjectDisplayName(e,t);return a?this.localizationService.format("NamePattern_Bracket",[s,r]):s},n.prototype.getObjectDisplayName=function(e,t){var r=(0,Ce.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r},n.prototype.getTargetAnalyticsObjects=function(e){var t={};for(var r in e.objects||{})2===e.objects[r].objectCategory&&!_.includes(["forecast","anomalyDetection"],r)&&(t[r]=e.objects[r]);return t},n.prototype.buildAnalyticsCards=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h;return(0,p.Jh)(this,function(f){switch(f.label){case 0:if(a=this.getTargetAnalyticsObjects(t),_.isEmpty(a))return[2];for(u in o=[],l=[],s=a)l.push(u);c=0,f.label=1;case 1:return c<l.length?(u=l[c])in s?(d=u)!==Re?[3,3]:[4,this.buildReferenceLineCards(e,t,i,r)]:[3,5]:[3,6];case 2:return v=f.sent(),o.push.apply(o,v??[]),[3,5];case 3:return[4,this.buildNonReferenceLineCard(d,t.objects[d],e,i,r)];case 4:(h=f.sent())&&o.push(h),f.label=5;case 5:return c++,[3,1];case 6:return[2,o]}})})},n.prototype.buildReferenceLineCards=function(e,t,r,i){var a;return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,m;return(0,p.Jh)(this,function(g){switch(g.label){case 0:return(o=null===(a=t.objects)||void 0===a?void 0:a[Re])?[4,this.referenceLineHelper.getReferenceLineInstancesInfo(e,r,t)]:[2];case 1:if(s=g.sent(),_.isEmpty(s?.groupedInstances))return[2];l=s.validMeasures,u=[],c=0,d=s.groupedInstances,g.label=2;case 2:return c<d.length?[4,this.buildReferenceLineCard((v=d[c])[0],v[1],l,o,e,i)]:[3,5];case 3:m=g.sent(),u.push(m),g.label=4;case 4:return c++,[3,2];case 5:return[2,u]}})})},n.prototype.buildReferenceLineCard=function(e,t,r,i,a,o){return(0,p.mG)(this,void 0,void 0,function(){var s;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return T.fF.assert(function(){return!_.isEmpty(t)},"Expect the given typedLineInstances NOT to be empty"),T.fF.assert(function(){return!_.isEmpty(r)},"Expect the given validMeasures NOT to be empty"),T.fF.assertValue(i,"Expect the given objectDescriptor to be defined"),[4,this.buildAnalyticsCard(Re,i,{type:e,instances:t,validMeasures:r},a,o)];case 1:return s=l.sent(),T.fF.assertValue(s,"No undefined legacy reference line card should be created"),[2,s]}})})},n.prototype.buildNonReferenceLineCard=function(e,t,r,i,a){return(0,p.mG)(this,void 0,void 0,function(){var o,s;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return[4,Ee(i,e)];case 1:return o=l.sent(),s=M.G.normalize(o),_.isEmpty(s?.instances)?[2]:[4,this.buildAnalyticsCard(e,t,{instances:s.instances},r,a)];case 2:return[2,l.sent()]}})})},n.prototype.buildAnalyticsCard=function(e,t,r,i,a){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,F,V,I;return(0,p.Jh)(this,function(j){switch(j.label){case 0:return _.isEmpty(r.instances)?[2]:(function(n){return n.hasOwnProperty("validMeasures")}(r)?(u=r.validMeasures,o=ei(l=r.type),c=this.localizationService.get(Ui[l]),d=_.size(_.filter(r.instances,function(L){return!L.isDefaultInstance})),s=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c):(o=e,d=_.size(_.filter(r.instances,function(L){return!!L.properties[we]})),s=this.getNonReferenceCardDisplayName(e,t,d)),v=t.properties,h={objectName:e,id:o,displayName:s,description:(0,Ce.G)(t.description,this.localizationService),instances:[],defaultInstance:null,maxInstances:ui(e),supportsUserDefinedInstances:_n(e)},f=i.config.singleVisual,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:m=j.sent(),g={conditionalFormattingDialogLauncher:m,conditionalFormattingUtilsService:this.conditionalFormattingUtilsService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,objectDefinitions:f.objects,visualAuthoring:this.visualAuthoring,visualContainer:i,visualPlugin:this.visualPluginService,visualWarningCollection:a.getWarnings(),undoRedo:this.undoRedoService},y=function(x){var z,P,A,E;return(0,p.Jh)(this,function(G){switch(G.label){case 0:return z=void 0,P=void 0,Yi(x)?(P=x.visualObjectInstance,A=x.isDefaultInstance,z={instance:x,validMeasures:u}):(A=!(P=x).properties[we],z=x),T.fF.assert(function(){return!A||!h.defaultInstance},'Each object should NOT have multiple instances with "show" property being false'),E=P.disabledReason,_.isEmpty(E)?[4,C.addInstanceToCard(h,z,l,A,e,v,g)]:(h.readOnly=!0,h.warningText=E,[2,{value:h}]);case 1:return G.sent(),[2]}})},C=this,N=0,D=r.instances,j.label=2;case 2:return N<D.length?[5,y(D[N])]:[3,5];case 3:if("object"==typeof(F=j.sent()))return[2,F.value];j.label=4;case 4:return N++,[3,2];case 5:return h.defaultInstance?[3,7]:(I=Yi(V=r.instances[0])?{instance:V,validMeasures:u}:V,[4,this.addInstanceToCard(h,I,l,!0,e,v,g)]);case 6:j.sent(),j.label=7;case 7:return[2,h]}})})},n.prototype.addInstanceToCard=function(e,t,r,i,a,o,s){return(0,p.mG)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,y,C,N,D;return(0,p.Jh)(this,function(w){switch(w.label){case 0:for(m in l=Zi(t)?t.instance.visualObjectInstance:t,c=i?null:l.selector,d=(u=l.properties).displayName,v={slices:[],displayName:_.isString(d)&&!_.isEmpty(d)?d:e.displayName,selector:c,type:r},Zi(t)&&this.buildReferenceLineSpecialSlices(e,v,t,i),f=[],h=u)f.push(m);g=0,w.label=1;case 1:return g<f.length?(m=f[g])in h?(C=u[y=m],function(n,e,t){var r=["displayName","type",we];return n===Re&&r.push("value"),!_.includes(r,e)&&Fe.Ke(t)}(a,y,N=o[y])?[4,this.buildSlice(a,y,N,C,v.displayName,l,i,s)]:[3,3]):[3,3]:[3,4];case 2:D=w.sent(),v.slices.push(D),w.label=3;case 3:return g++,[3,1];case 4:return i?e.defaultInstance=v:e.instances.push(v),[2]}})})},n.prototype.buildSlice=function(e,t,r,i,a,o,s,l){var u,c,d;return(0,p.mG)(this,void 0,void 0,function(){var v,h,f,m,g,C,N,D;return(0,p.Jh)(this,function(w){switch(w.label){case 0:return v=this.getSliceDisplayName(t,r,o),h=this.getPropertyTypeDescriptor(t,r,o),[4,this.getSliceValue(t,r,i,o)];case 1:return D=w.sent(),f=D.value,m=D.selectionOptions,g={name:t,displayName:v,description:(0,Ce.G)(r.description,this.localizationService),type:h,selector:o.selector,value:f,show:!0,placeholder:(0,Ce.G)(r.placeHolderText,this.localizationService),isValid:!0,isDisabled:s,containerIndex:o.containerIdx,selectionOptions:m},h.fill&&(g.value={value:g.value}),3===(null===(u=o.propertyInstanceKind)||void 0===u?void 0:u[t])&&(C=(null===(d=null===(c=l.visualWarningCollection)||void 0===c?void 0:c.visualObjectWarnings)||void 0===d?void 0:d[e])||[],l.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(o,t,h,r,l.objectDefinitions,g,l.localizationService,C,l,a)),(N=Fe.X_(g))&&(g.numericValueOptions=N),g.isPropertyTitleWidthStretch=Fe.OR(g),function(n){n.name===Z.pw&&(n.validators={max:ve.MaxPrecision})}(g),[2,g]}})})},n.prototype.buildReferenceLineSpecialSlices=function(e,t,r,i){if(!i){var a=r.instance,o={displayName:this.localizationService.get("Series"),name:"measure",customObjectName:ei(t.type),show:!0,isDisabled:i,isValid:!0,placeholder:this.localizationService.get("Visual_Reference_Line_Measure_Default"),selectionOptions:r.validMeasures,value:a.measureName,selector:a.visualObjectInstance.selector,type:{enumeration:(0,Ut.i)([])}};t.slices.push(o);var s=a.percentileValue;if(null!=s){var l={displayName:this.localizationService.get("Visual_Reference_Line_Percentile"),name:"percentile",customObjectName:ei(t.type),show:!0,isDisabled:!1,isValid:!0,placeholder:void 0,value:s,selector:a.visualObjectInstance.selector,type:{numeric:!0}};l.numericValueOptions=Fe.X_(l),l.isPropertyTitleWidthStretch=Fe.OR(l),t.slices.push(l)}}},n.prototype.getSliceDisplayName=function(e,t,r){var i=r.selector?r.displayName:void 0;return _.isEmpty(i)?this.getPropertyDisplayName(e,t):i},n.prototype.getSliceValue=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return a=r,[4,Fe.cn({propertyType:St.Ge.fromDescriptor(t.type),instance:i,propertyName:e})];case 1:return(o=l.sent())&&(a=Fe.vw(o,r)),s=a,"color"!==e&&a?.solid&&t.type.fill&&(s=r.solid.color),[2,{value:s,selectionOptions:o}]}})})},n.prototype.getPropertyTypeDescriptor=function(e,t,r){var i,a=null===(i=r.propertyTypes)||void 0===i?void 0:i[e],o=Fe.sH(t.type,a),s=t.type.variant;return s&&(o=(0,p.pi)((0,p.pi)({},o),{variant:s})),o},n.prototype.convertToPropertyPaneCard=function(e,t){var r={name:e.objectName,displayName:e.displayName,description:e.description,id:e.id,slices:(0,Ct.z8)([]),footer:[],mainShow:void 0,isDirty:!1,index:t,analyticsPane:!0,customRevertToDefaultDescriptors:[]},i=_.size(e.instances);if(1===e.maxInstances){var a=1===i?e.instances[0]:e.defaultInstance;T.fF.assertValue(a,"If maxInstances===1, one instance must be found to show the UI, be it a default instance or a real instance");var o=(0,Ct.z8)(a?.slices||[]);r.slices=o,r.mainShow={displayName:void 0,isDisabled:!!e.readOnly,isValid:!0,name:we,save:_.noop,show:!0,type:{bool:!0},value:a!==e.defaultInstance,placeholder:null},_.forEach(o,function(u){var c;r.customRevertToDefaultDescriptors.push({objectName:null!==(c=u.customObjectName)&&void 0!==c?c:e.objectName,propertyName:u.name})}),r.customRevertToDefaultDescriptors.push({objectName:e.objectName,propertyName:we})}else{var s=[];_.forEach(i>0?e.instances:[e.defaultInstance],function(u,c){var d={name:void 0,displayName:u===e.defaultInstance?void 0:u.displayName,value:void 0,isDisabled:u===e.defaultInstance,slices:(0,Ct.z8)(u.slices||[]),selector:u.selector,containerIndex:c};s.push(d),_.forEach(d.slices,function(v){var h;r.customRevertToDefaultDescriptors.push({objectName:null!==(h=v.customObjectName)&&void 0!==h?h:e.objectName,propertyName:v.name})})}),r.containersLabel=this.localizationService.get("Apply_Settings_To"),r.containersTooltip=null,r.containersEditable=!0,r.containers=(0,Ct.z8)(s),r.selectedContainer=_.first(r.containers)}return r},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(ii.z),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(si),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(jr),q.\u0275\u0275inject(zr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ui(n){var e=_.find(de,function(t){return t.objectName===n});return e?e.maxInstances:1}function _n(n){var e=_.find(de,function(t){return t.objectName===n});return!!e&&e.supportsUserDefinedInstances}function Yi(n){return n.hasOwnProperty("visualObjectInstance")}function Zi(n){return n.hasOwnProperty("validMeasures")}var On=b(58702),Xi=function(){function n(e,t,r,i,a,o,s,l){this.anomalyDetectionHelper=e,this.forecastHelper=t,this.legacyAnalyticsFormattingService=r,this.localizationService=i,this.referenceLineHelper=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.saveChangedSlicesToDefinition=function(e,t,r){return void 0===r&&(r=!1),(0,p.mG)(this,void 0,void 0,function(){var i,a,o;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return(0,J.Vz)(t)?(i=e[0].groupDisplayName,_.isEmpty(i)?[3,2]:(a=e[0].objectName,T.fF.assert(function(){return e.every(function(u){return u.objectName===a})},"all the changes should have same object"),T.fF.assert(function(){return e.every(function(u){return u.groupDisplayName===i})},"all the changes should have same groupDisplayName"),[4,this.handleGroupSlicesSave(a,i,e,t)])):[2,!1];case 1:return[2,l.sent()];case 2:return T.fF.assert(function(){return 1===_.size(e)},"Expect saveObject to have 1 single change when it is not from a grouped save"),(o=e[0]).propertySlice.type.errorRange?[2,this.saveSliceExpression(o.objectName,o.propertySlice,t)]:[2,this.saveSliceValue(o.objectName,o.propertySlice,t,!!r)];case 3:return[2]}})})},n.prototype.saveSliceExpression=function(e,t,r){var i=t.value;T.fF.assert(function(){return void 0===i||i instanceof Ye.Il||(0,On.hl)(i)},"Slice value is not a valid expression");var a={objectName:e,propertyName:t.name},o=t.selector;return void 0===i?this.visualAuthoringService.removePropertyDefinition(r,a,o,!0):this.visualAuthoringService.setPropertyDefinition(r,a,o,i,void 0,!0),!0},n.prototype.saveSliceValue=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h=this;return(0,p.Jh)(this,function(f){switch(f.label){case 0:return[4,this.checkAddRemoveRenameInstance(e,t,r,i)];case 1:return f.sent()?[2,!0]:"editable-container-object-name"===e?[2,!1]:[4,this.referenceLineHelper.tryHandleReferenceLineSpecialSave(e,t,r)];case 2:return(s=f.sent()).isHandled?(a=s.persistChanges,o=s.newPropertyChanges):(a={merge:[],remove:[]},l={objectName:e,selector:t.selector,properties:{}},c=St.Ge.fromDescriptor(u=t.type),d=t.value,!c.text&&""===d&&(d=null),null==d||d instanceof Ye.jz&&null==d.value?(l.properties[t.name]=d,a.remove.push(l)):(u.variant&&!(d instanceof Ye.Il)&&(d=(0,k.Lo)(d,u)),l.properties[t.name]=d,a.merge.push(l))),(v=!(_.isEmpty(a?.merge)&&_.isEmpty(a?.replace)&&_.isEmpty(a?.remove)&&_.isEmpty(a?.removeObject)))&&this.visualAuthoringService.persistProperties(a,r,!0),o&&_.forEach(o.properties,function(m,g){h.visualAuthoringService.setPropertyDefinition(r,{objectName:o.objectName,propertyName:g},o.selector,m,void 0,!0)}),[2,v]}})})},n.prototype.handleGroupSlicesSave=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return e!==Te.Po?[3,2]:[4,this.forecastHelper.saveGroupSlices(t,r,i)];case 1:case 3:return[2,a.sent()];case 2:return e!==Ze?[3,4]:[4,this.anomalyDetectionHelper.saveGroupSlices(t,r,i)];case 4:return[2,!1]}})})},n.prototype.checkAddRemoveRenameInstance=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.referenceLineHelper.checkAddRemoveRenameInstance(e,t,r)];case 1:return a.sent()||this.forecastHelper.checkAddRemoveInstance(e,t,r)||this.anomalyDetectionHelper.checkAddRemoveInstance(e,t,r)||this.checkAddRemoveNormalInstance(e,t,r,i)?[2,!0]:[2,!1]}})})},n.prototype.checkAddRemoveNormalInstance=function(e,t,r,i){if(i||de[e])return 1===(i?ui(e):de[e].maxInstances)&&t.name===we&&(t.value?this.addNormalInstance(e,r,i):Je(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.addNormalInstance=function(e,t,r){var i;if(T.fF.assert(function(){return e!==Re&&e!==Te.Po&&e!==Ze},"Expect this NOT be called for reference line or forecast"),r){var a=this.visualPluginService.capabilities(t.config.singleVisual.visualType),s=this.legacyAnalyticsFormattingService.getPropertyDisplayName(e,a.objects[e].properties.displayName);i=ie(e,s,t,this.localizationService)}else{var l=_.find(de,function(u){return u.objectName===e}).displayNameBaseKey;i=ue(e,l,t,this.localizationService)}this.telemetryService.logEvent(it.Yu,{objectName:e}),this.visualAuthoringService.persistProperties(i,t,!0)},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Rr),q.\u0275\u0275inject($r),q.\u0275\u0275inject(li),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(jr),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Ft=b(66609),Ln=b(54766),ea=b(36998),Bn=b(10746),ci=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.featureSwitchService=r,this.lazyScoped=i,this.conditionalFormattingUtilService=a,this.explorationNavigation=o,this.themeService=s,this.visualAuthoring=l}return n.prototype.getDynamicExpressionSupportObjectForSlice=function(e){var t=this,r=e.containerSliceDisplayName,i=e.descriptor,a=e.objectDefinitions,o=e.objectDisplayName,s=e.propertyDescriptor,l=e.propertyTypeDescriptor,u=e.warning,c=e.canvasItem;if(!c||!(0,J.Vz)(c))return T.fF.assertFail("visualContainer should exist"),{dynamicExpressionSupport:void 0,warningMessage:void 0};var f,d=i.objectName,v=i.propertyName,h=i.selector,g=_.clone(s);g.type=l;var C=c.config.singleVisual.query,N=!1,D=(0,k.NA)(a,{objectName:d,propertyName:v},h);return D&&(0,Bn.oA)(D,h,C?C.defn.select():(0,Ct.bv)()).length&&(N=!0,u&&(f=this.getDataBoundExprWarning(u,i))),{warningMessage:f,dynamicExpressionSupport:{isSet:N,showDialog:function(){return t.showConditionalFormattingDialogForSlice(c,D,g,r??o,v,i)}}}},n.prototype.getDataBoundExprWarning=function(e,t){if(e instanceof ea.L&&e.propertyId.propertyName===t.propertyName&&(!e.selector&&!t.selector||(0,Ei.fS)(e.selector,t.selector)))return e},n.prototype.getConditionalFormattingSliceProperties=function(e,t,r){var i=this;if(r&&(0,J.Vz)(r)){var a=r.config.singleVisual.objects,o=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),l=this.conditionalFormattingUtilService.getConditionalFormattingSliceProperties({conceptualSchemaProxy:this.conceptualSchemaProxy,conditionalFormattingDialogLauncherFactory:function(){return i.lazyScoped.get("conditionalFormattingDialogLauncherService")},dataBarsDialogLauncherFactory:function(){return i.lazyScoped.get("dataBarsDialogLauncherService")},dataSourcesService:this.dataSourcesService,featureSwitchService:this.featureSwitchService,visualAuthoring:this.visualAuthoring},r,a,e,o,t);if(l)return(0,p.pi)((0,p.pi)({},l),{toggleButton:(0,p.pi)((0,p.pi)({},l.toggleButton),{saveCallback:function(d){return i.saveConditionalFormattingControlProperties(d,l.toggleButton.saveCallback,[r])}})})}else T.fF.assertFail("visualContainer should exist")},n.prototype.saveConditionalFormattingControlProperties=function(e,t,r){T.fF.assert(function(){return 1===_.size(e.changes)},"Expect this NOT be called when there are multiple changes in the save object");for(var i=e.changes[0].objectName,a=e.changes[0].propertySlice,o=0,s=r;o<s.length;o++)t(i,a,s[o])},n.prototype.showConditionalFormattingDialogForSlice=function(e,t,r,i,a,o){return(0,p.mG)(this,void 0,void 0,function(){var s,l,u,c;return(0,p.Jh)(this,function(v){switch(v.label){case 0:return s=this.explorationNavigation.getCurrentExploration(),l=this.themeService.getVisualStyle(s.themeCollection),[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")];case 1:return u=v.sent(),[4,this.conditionalFormattingUtilService.getConditionalFormattingDialogResult(u,e,t,r,i,a,o,l)];case 2:return!(c=v.sent())||_.isUndefined(c.propertyDefinition)?[2,{value:void 0,shouldSave:!1}]:[2,{value:(0,Ln.PU)(c.propertyDefinition,c.repetition.propertyDescriptor,!1),shouldSave:!0}]}})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(ii.z),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(br.f),q.\u0275\u0275inject(ht.$8))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),ta=b(58938),ra=function(){function n(){this._fieldPickerAllStaticSeriesValue=new Map}return n.prototype.cleanFieldPickerStaticSeries=function(e,t){if("FieldPicker"===e.control.type){var r=e.control.properties;if(!r.dataLabelPickerType)return;var a=r.dataLabelPickerType.dataLabelRole;!r.value&&2===r.dataLabelPickerType.seriesType&&t&&(0,J.Vz)(t)&&this.clearAllStaticSeriesValue(a,t.name)}},n.prototype.updateFieldPickerControlValue=function(e,t,r,i){var s=(0,k.NA)(r,{objectName:t.objectName,propertyName:t.propertyName},t.selector);e.splitValuesIntoInstances?this.splitFieldPickerPropsIntoInstances(t,r,e):e.unwrapExprOnGet&&this.wrapPropertyValueForFieldPicker(e,s),i&&(0,J.Vz)(i)&&this.updateFieldPickerControlFallbackExpression(e,s,i),this.setFallbackExpressionAsDisplayedValue(e)},n.prototype.wrapPropertyValueForFieldPicker=function(e,t){e.value=t?{newExpr:{expr:t}}:void 0},n.prototype.splitFieldPickerPropsIntoInstances=function(e,t,r){var o=(0,k.hz)(t,{objectName:e.objectName,propertyName:e.propertyName},e.selector);if(o){for(var s=_.sortBy(Object.keys(o),function(v){var h;return null===(h=o[v].selector)||void 0===h?void 0:h.order}),l=[],u=0,c=s;u<c.length;u++){var d=c[u];l.push({expr:o[d].value,metadata:d})}T.fF.assert(function(){return!!l.length},"expect at least one expr to add"),r.value={newExpr:l}}else r.value=void 0},n.prototype.updateFieldPickerControlFallbackExpression=function(e,t,r){if(e.dataLabelPickerType&&[2,3].includes(e.dataLabelPickerType.seriesType)){var a=r.name,o=e.dataLabelPickerType.seriesType,s=e.dataLabelPickerType.dataLabelRole;if(2===o)return void(e.value?this.setAllStaticSeriesValue(s,t,a):this.clearAllStaticSeriesValue(s,a));3===o&&(e.fallbackExpr=this.allStaticSeriesHasValueForRole(s,a)?this.getAllStaticSeriesValue(s,a):e.fallbackExpr)}},n.prototype.setFallbackExpressionAsDisplayedValue=function(e){var t;!e.value&&e.fallbackExpr?(e.value={newExpr:{expr:e.fallbackExpr}},e.allowClear=null!==(t=e.allowClear)&&void 0!==t&&t):e.fallbackExpr&&(e.allowClear=!0)},n.prototype.allStaticSeriesHasValueForRole=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.has(r)},n.prototype.getAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.get(r)},n.prototype.setAllStaticSeriesValue=function(e,t,r){var i=this.createFieldPickerSeriesValueKey(e,r);this._fieldPickerAllStaticSeriesValue.set(i,t)},n.prototype.clearAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);this._fieldPickerAllStaticSeriesValue.delete(r)},n.prototype.createFieldPickerSeriesValueKey=function(e,t){return"".concat(e,"-").concat(t)},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(t){return new(t||n)}}),n}();function Or(n,e,t){return(0,p.pi)((0,p.pi)({},Fe.qb(n,e,!!t)),{source:n})}var wr=function(){function n(e,t,r,i,a,o,s,l){this.bookmarkService=e,this.conditionalFormattingService=t,this.dialogService=r,this.explorationNavigationService=i,this.fieldPickerTransformationService=a,this.localizationService=o,this.visualAuthoringService=s,this.visualStylePresetService=l}return n.prototype.transformFormattingSlice=function(e){var r=e.objectDescriptors,i=e.visualType,o=e.dynamicExpressionSupportOptions,s=this.applyBasicTransformation(e.formattingSlice,e.visualObjects,r,o);return this.applyControlSpecificTransformation(s,r,i,o?.canvasItem)},n.prototype.applyBasicTransformation=function(e,t,r,i){if(!(0,S.IW)(e)){var o=ae.w7(e.control.properties.descriptor,r),s=e.displayName,l=e.description;!s&&!e.suppressDisplayName&&o&&(s=(0,Ce.G)(o.displayName,this.localizationService)),!l&&o&&o.description&&(l=(0,Ce.G)(o.description,this.localizationService));var u=void 0;o&&o.placeHolderText&&(u=(0,Ce.G)(o.placeHolderText,this.localizationService));var c=this.getDynamicExpressionSupportObjectsForSlice(e,i),d=c?.warningMessage,v=void 0;d&&(v=Or(d,this.localizationService));var h=(e=this.fillRuleOnlySliceValue(e,t,i?.canvasItem)).aliasNames;return c&&(h=(0,p.ev)((0,p.ev)([],h=h??[],!0),[this.localizationService.get("FieldWell_ConditionalFormatting")],!1)),(0,p.pi)((0,p.pi)({},e),{displayName:s,placeHolderText:u,description:l,conditionalFormattingWarning:v,conditionalFormattingObjects:c?c.dynamicExpressionSupport:void 0,aliasNames:h})}return e},n.prototype.fillRuleOnlySliceValue=function(e,t,r){if("ConditionalFormattingControl"===e.control.type||(0,S.IW)(e))return e;var i=e.control.properties.descriptor;if(2!==i.instanceKind)return e;T.fF.assert(function(){return void 0===e.control.properties.value},"A RuleOnly Slice shouldn't have a value in Formatting Model");var s=(0,k.NA)(t,{objectName:i.objectName,propertyName:i.propertyName},i.selector);if(""===s?.value){if("FieldPicker"===e.control.type){var l=e.control.properties,u=l?.fallbackExpr;l.value=u?{newExpr:{expr:u}}:l.value,this.fieldPickerTransformationService.cleanFieldPickerStaticSeries(e,r)}return e}var c=(0,p.pi)((0,p.pi)({},e),{control:(0,p.pi)((0,p.pi)({},e.control),{properties:(0,p.pi)((0,p.pi)({},e.control.properties),{value:s})})}),d=c.control;return"FieldPicker"===d.type&&this.fieldPickerTransformationService.updateFieldPickerControlValue(d.properties,i,t,r),c},n.prototype.transformConditionalFormattingControl=function(e,t){var r=this,i=e.control;if("ConditionalFormattingControl"!==i.type)return T.fF.assertFail("Unexpected slice type"),e;var a=this.conditionalFormattingService.getConditionalFormattingSliceProperties(e.displayName,i.properties.value,t);if(a){var o=a.toggleButton,s=a.isApplied,l={isSet:!1,isDisabled:!s,showDialog:function(){return(0,p.mG)(r,void 0,void 0,function(){return(0,p.Jh)(this,function(c){return[2,s&&s.value()]})})}};return(0,p.pi)((0,p.pi)({},e),{displayName:o.displayName,description:o.description,control:{type:"ToggleSwitch",properties:{descriptor:e.control.properties.descriptor,value:o.value}},conditionalFormattingObjects:l,saveCallback:o.saveCallback})}},n.prototype.getDynamicExpressionSupportObjectsForSlice=function(e,t){if(t){var r=t.formattingDescriptor;if("ErrorRangeControl"!==e.control.type&&"FieldPicker"!==e.control.type&&(3===r.instanceKind||2===r.instanceKind)){var s=t.formattingModelWarnings;return this.conditionalFormattingService.getDynamicExpressionSupportObjectForSlice({containerSliceDisplayName:t.containerSliceDisplayName,descriptor:r,objectDefinitions:t.formattingObjectOptions.objectDefinitions,objectDisplayName:t.conditionalFormattingDisplayName,propertyDescriptor:t.propertyDescriptor,propertyTypeDescriptor:t.type,warning:s&&s[r.objectName],canvasItem:t.canvasItem})}}},n.prototype.applyControlSpecificTransformation=function(e,t,r,i){switch(e.control.type){case"Dropdown":return this.transformDropdowns(e,t,r);case"FlagsSelection":return this.transformFlagsSelection(e,t,r);case"MarginPadding":case"NumUpDown":case"Slider":return this.transformControlsWithUnit(e);case"ConditionalFormattingControl":return this.transformConditionalFormattingControl(e,i);case"SeriesDialogLink":return this.transformSeriesDialogLink(e,i);case"ColorPicker":case"FontControl":return this.transformControlWithAliasNames(e);default:return e}},n.prototype.transformSeriesDialogLink=function(e,t){var r=this,i=e.control;if("SeriesDialogLink"!==i.type)return e;var a=i.properties,o=this.localizationService;return(0,p.pi)((0,p.pi)({},e),{control:(0,p.pi)((0,p.pi)({},i),{type:"Link",properties:(0,p.pi)((0,p.pi)({},i.properties),{value:function(){return(0,p.mG)(r,void 0,void 0,function(){var c;return(0,p.Jh)(this,function(h){switch(h.label){case 0:return[4,this.dialogService.showConfirmationDialog({title:o.get("Enable_This_Setting"),message:o.get("Format_Series_Toggle_Upgrade"),okButtonText:o.get("Restore_And_Enable"),cancelButtonText:o.get("Discard_And_Enable")},{maxWidth:450,maxHeight:225}).afterClosed().toPromise()];case 1:return 1===(c=h.sent())?[2,!0]:2===c?(a.resetToDefaultDescriptors&&t&&(0,J.Vz)(t)&&(ae.Aw(t.config.singleVisual.objects,a.resetToDefaultDescriptors,!0),this.visualAuthoringService.raiseCanvasItemChanged(t)),[2,!0]):[2,!1]}})})}})})})},n.prototype.transformControlsWithUnit=function(e){if(this.localizationService.currentLanguageLocale.startsWith("en-"))return e;switch(e.control.type){case"NumUpDown":case"Slider":return this.transformNumUpDownControl(e);case"MarginPadding":return this.transformMarginPaddingControl(e);default:return e}},n.prototype.transformControlWithAliasNames=function(e){var t,i=null!==(t=e.aliasNames)&&void 0!==t?t:[];switch(e.control.type){case"ColorPicker":var a=this.localizationService.get("Generic_Color");return i.push(a),(0,p.pi)((0,p.pi)({},e),{aliasNames:i});case"FontControl":var o=this.localizationService.get("Role_DisplayName_Size");return i.push(o),(0,p.pi)((0,p.pi)({},e),{aliasNames:i});default:return e}},n.prototype.transformNumUpDownControl=function(e){var t,r=e.control;if("Slider"!==r.type&&"NumUpDown"!==r.type)return e;var i=null===(t=r.properties.options)||void 0===t?void 0:t.unitSymbol;if(!i)return e;var a=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(i)]);return(0,p.pi)((0,p.pi)({},e),{displayName:a,control:(0,p.pi)((0,p.pi)({},r),{properties:(0,p.pi)((0,p.pi)({},r.properties),{options:(0,p.pi)((0,p.pi)({},r.properties.options),{unitSymbol:void 0})})})})},n.prototype.transformMarginPaddingControl=function(e){var t,r,i=e.control;if("MarginPadding"!==i.type)return e;var a=i.properties,o=null===(r=null===(t=a.top)||void 0===t?void 0:t.options)||void 0===r?void 0:r.unitSymbol;if(!o)return e;var s=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(o)]),l={},u=function(v){var h=v,f=a[h];if(!f)return"continue";T.fF.assert(function(){return o===f.options.unitSymbol},"MarginPadding, all dimensions should have same unit"),l[h]=(0,p.pi)((0,p.pi)({},f),{options:(0,p.pi)((0,p.pi)({},f.options),{unitSymbol:void 0})})};for(var c in a)u(c);return(0,p.pi)((0,p.pi)({},e),{displayName:s,control:(0,p.pi)((0,p.pi)({},i),{properties:l})})},n.prototype.transformDropdowns=function(e,t,r){var i,a,o=e.control;if("Dropdown"!==o.type)return e;var s=o.properties;if(Fe.WN(s))return e;var l=s.descriptor,u=s.filterValues,c=s.mergeValues,d=s.value,v=ae.w7(l,t);T.fF.assertValue(v,"Need property descriptor to resolve EnumDropdown");var h=St.Ge.fromDescriptor(v.type),f={objectName:l.objectName,properties:(i={},i[l.propertyName]=d,i),selector:l.selector};(u||c)&&(f.validValues=((a={})[l.propertyName]={filterValues:u,mergeValues:c},a));var g=this.getSelectionOptions({propertyType:h,instance:f,propertyName:l.propertyName,visualType:r}),y="".concat(d),C=g?.find(function(F){return F.value===d||F.value===y});T.fF.assertValue(C,"selectedEnum");var N=(0,p.pi)((0,p.pi)({},s),{items:g,value:C}),D=N;D.filterValues=void 0,D.mergeValues=void 0;var w={type:"Dropdown",properties:N};return(0,p.pi)((0,p.pi)({},e),{control:w})},n.prototype.transformFlagsSelection=function(e,t,r){var i,a=e.control;if("FlagsSelection"!==a.type)return e;var o=a.properties;if(function(n){return!!n.items}(o))return e;var s=o.descriptor,l=o.value,u=ae.w7(s,t);T.fF.assertValue(u,"Need property descriptor to resolve EnumFlagsSelection");var c=St.Ge.fromDescriptor(u.type),d={objectName:s.objectName,properties:(i={},i[s.propertyName]=l,i),selector:s.selector},h=this.getSelectionOptions({propertyType:c,instance:d,propertyName:s.propertyName,visualType:r}),f="".concat(l),g={type:"FlagsSelection",properties:(0,p.pi)((0,p.pi)({},o),{items:h,value:f})};return(0,p.pi)((0,p.pi)({},e),{control:g})},n.prototype.getSelectionOptions=function(e){var t=e.propertyType,r=e.instance,i=e.propertyName,a=e.visualType,o=this.bookmarkService,s=this.explorationNavigationService,l=this.localizationService,u=this.visualStylePresetService;T.fF.assertValue(t,"propertyType"),T.fF.assertValue(r,"instance");var c=t.enum||t.flagsEnum;if(!c){var d=t.formatting;d&&(d.labelDisplayUnits?c=(0,Ut.i)((0,Ft.p$)()):d.displayUnitsWithoutAuto?c=(0,Ut.i)((0,Ft.p$)(!0)):d.stylePreset&&(c=u.getEnumFromName(a,r.properties.name)));var v=t.reference;v&&(v.bookmark?(T.fF.assertValue(o,"bookmarks not implemented here"),T.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Ut.i)(Fe.oE(o.getAllBookmarks())))):v.bookmarkGroup?(T.fF.assertValue(o,"bookmarks not implemented here"),T.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Ut.i)(Fe.yp(o.getBookmarkGroups())))):v.section?(T.fF.assertValue(s,"explorationNavigation not implemented here"),T.fF.assertValue(l,"localizationService is missing"),s&&(c=(0,Ut.i)(Fe.OY(s.getAllSections())))):T.fF.assertFail(v.perspective?"Perspectives must be set directly in `values`":"Unknown refType"))}if(c){var h=Fe.Cc(r,i);if(h){var f=void 0;if(Fe.QI(h)){if(f=h.filterValues,h.mergeValues){var m=(0,p.ev)((0,p.ev)([],h.mergeValues||[],!0),c.members()||[],!0);c=(0,Ut.i)(m)}}else f=h;f&&(c=(0,Ut.i)(c.members(f)))}return(0,Ft.Iq)(c.members(),l)}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(ni.F),q.\u0275\u0275inject(ci),q.\u0275\u0275inject(ta.x),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(ra),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(Cr.A))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Mr=b(66977),Lr_propertyNames_upperShadingColor="upperShadingColor",Lr_propertyNames_lowerShadingColor="lowerShadingColor",Lr_propertyNames_transparency="transparency",pi=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f){this.analyticsPaneSaveService=e,this.anomalyDetectionHelper=t,this.featureSwitchService=r,this.forecastHelper=i,this.formattingSliceTransformerService=a,this.legacyAnalyticsFormattingService=o,this.localizationService=s,this.referenceLineHelper=l,this.runningVisualService=u,this.selectionService=c,this.visualAuthoring=d,this.visualPluginService=v,this.visualPluginOperationsService=h,this.formattingObjectDefinitionsService=f}return n.prototype.getFormattingModel=function(e){var t;return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C;return(0,p.Jh)(this,function(N){switch(N.label){case 0:return r=[],i={cards:[]},e?(0,J.q4)(e)||(0,rr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)||ae.D1(e)?[2,i]:(o=this.visualPluginService.capabilities((a=e.config.singleVisual).visualType))?(s=this.runningVisualService.getVisual(e))&&(s.getHasPendingChanges()||s.getErrorInfo())?[2,i]:(l=s?.getAdapter(),l?this.visualPluginService.isCustomVisual(a.visualType)?[4,$e(l)]:[3,4]:[2,i]):[2,i]:[2,{cards:r}];case 1:return(u=N.sent())?[3,3]:[4,this.legacyAnalyticsFormattingService.getFormattingCards(e,s,l,o)];case 2:u=N.sent(),N.label=3;case 3:return r.push.apply(r,u??[]),[3,10];case 4:return[4,this.enumerateTrendLineCard(l,o)];case 5:return(c=N.sent())&&r.push(c),[4,this.referenceLineHelper.enumerateReferenceAndConstantLineCards(e,l,o)];case 6:return(d=N.sent())&&r.push.apply(r,d||[]),[4,this.enumerateSymmetricShadingCard(l,o)];case 7:return(v=N.sent())&&r.push(v),[4,this.enumerateRatioLineCard(l,o)];case 8:return(h=N.sent())&&r.push(h),m=(f=r.push).apply,g=[r],[4,$e(l)];case 9:m.apply(f,g.concat([null!==(t=N.sent())&&void 0!==t?t:[]])),N.label=10;case 10:return[4,this.forecastHelper.enumerateForecastCard(e,l,o)];case 11:return(y=N.sent())&&r.push(y),[4,this.anomalyDetectionHelper.enumerateAnomalyCard(e,l,o)];case 12:return(C=N.sent())&&r.push(C),[2,_.isEmpty(r)?i:{cards:r.map(function(D){return(0,p.pi)((0,p.pi)({},D),{analyticsPane:!0})})}]}})})},n.prototype.getObjectDescriptors=function(e){if((0,J.q4)(e))return{};var r=this.visualPluginService.capabilities(e.config.singleVisual.visualType);return r?_.pickBy(r.objects,function(i,a){return 2===i.objectCategory}):{}},n.prototype.getObjectDefinitions=function(e,t){var i,r=this;if((0,J.q4)(e))return{};var s,a=e.config.singleVisual,o=null===(i=this.visualPluginService.capabilities(a.visualType))||void 0===i?void 0:i.objects;if(!o)return{};s=t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getObjectDefinitions(e):a.objects;var l={};return _.forEach(s,function(u,c){var d;2===(null===(d=o[c])||void 0===d?void 0:d.objectCategory)&&(l[c]=c!==Ze?u:r.anomalyDetectionHelper.getObjectDefinitions(u))}),l},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"VisualizationPane_Section_Analytics",itemTypeDisplayName:(0,ae.um)(e,this.featureSwitchService)}},n.prototype.getFormatPaneSliceTransform=function(e){var t=this,r=(0,Zr.s)(e),i=(0,J.Vz)(e)?(0,W.GQ)(e):void 0;return function(a,o,s){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:a,objectDescriptors:o,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:s})}},n.prototype.saveProperties=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a;return(0,p.Jh)(this,function(s){switch(s.label){case 0:return(0,J.q4)(t)?(T.fF.assertFail("Analytics pane does not support VisualContainerGroup"),[3,3]):[3,1];case 1:return i=!1,a=e[0].objectName,T.fF.assert(function(){return e.every(function(l){return l.objectName===a})},"all the changes should have same object"),this.visualPluginService.isCustomVisual(t.config.singleVisual.visualType)&&a!==Te.Po&&a!==Ze&&(i=!0),[4,this.analyticsPaneSaveService.saveChangedSlicesToDefinition(e,t,i)];case 2:s.sent()&&this.visualAuthoring.raiseVisualContainerChanged(t,{parentContextActivity:r}),s.label=3;case 3:return[2]}})})},n.prototype.getRevertToDefaultEnabled=function(e,t,r){var i=this.getObjectDefinitions(e);return!!i&&!!((0,ae.wW)(t,i,r)||this.forecastHelper.hasParameterWithNonDefaultValue(i)||this.anomalyDetectionHelper.hasParameterWithNonDefaultValue(i))},n.prototype.getModelUnavailableInformation=function(e){if(e&&(0,J.Vz)(e)){var t=this.runningVisualService.getVisual(e);if(t?.getHasPendingChanges())return{messageKey:"AnalyticsPane_Disabled_Paused"}}return{messageKey:"AnalyticsPane_Unavailable",learnMoreLink:"https://go.microsoft.com/fwlink/?LinkID=825117",imageName:"".concat((0,qn.Xr)(),"/images/RecommendedCharts.svg")}},n.prototype.revertVisualSlicesToDefinitions=function(e,t){for(var r=[],a=0,o=(0,ae.Wx)(e);a<o.length;a++){var s=o[a],l=s.canvasItem;r.push(l);var u=s.descriptors;if((0,J.Vz)(l)){var c=l.config.singleVisual,d=c.objects;if(!d){c.objects={};continue}this.forecastHelper.revertForecastSpecialDefinitions(l,d,u),this.anomalyDetectionHelper.revertAnomalyDetectionSpecialDefinitions(l,d,u),(0,ae.Aw)(d,u)}}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},n.prototype.shouldShowGroupChangeIndicator=function(){return!1},n.prototype.shouldShowSliceChangeIndicator=function(){return!1},n.prototype.enumerateTrendLineCard=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v=this;return(0,p.Jh)(this,function(h){switch(h.label){case 0:return i=function(m){return v.localizationService.get(m)},a=[],o=[{type:"toggle",sliceName:"combineSeries",propertyName:ti.Kx},{type:"toggle",sliceName:"useHighlightValues",propertyName:ti.$B}],s=(0,He.pN)(r=ti.s4,He.vi),a.push.apply(a,Object.values(s)),a.push.apply(a,_.map(o,function(f){return{objectName:r,propertyName:f.propertyName}})),[4,re(r,"trendLine","Visual_Trend_Line",e,t,i,a,"show")];case 1:return(l=h.sent())?(u=l.objectInstance,(c=l.cardBuilder).addGroup(void 0,function(f){var m,g;f.addSlices((0,ge.Iq)({containerItemBuilder:f,descriptors:s,strokeData:(0,ge.AF)(u.properties,He.vi,{},null===(g=null===(m=u.properties.lineColor)||void 0===m?void 0:m.solid)||void 0===g?void 0:g.color),selector:u.selector,featureSwitches:v.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(y){return y.build()})),le(f,r,u,t,i,o)}),(d=c.build()).analyticsPane=!0,[2,d]):[2]}})})},n.prototype.enumerateSymmetricShadingCard=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,kn(e,t,"plotAreaShading","plotAreaShading","Visual_Scatter_SymmetryShading",[{type:"color",sliceName:"upperShadingColor",propertyName:Lr_propertyNames_upperShadingColor},{type:"color",sliceName:"lowerShadingColor",propertyName:Lr_propertyNames_lowerShadingColor},{type:"transparency",sliceName:"transparency",propertyName:Lr_propertyNames_transparency}],this.localizationService)];case 1:return[2,a.sent()]}})})},n.prototype.enumerateRatioLineCard=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d=this;return(0,p.Jh)(this,function(v){switch(v.label){case 0:return i=function(f){return d.localizationService.get(f)},a=[],o=(0,He.pN)("ratioLine",He.vi),a.push.apply(a,Object.values(o)),[4,re("ratioLine","ratioLine","Visual_Scatter_RatioLine",e,t,i,a,"show")];case 1:return(s=v.sent())?(l=s.objectInstance,(u=s.cardBuilder).addGroup(void 0,function(h){var f,m;return h.addSlices((0,ge.Iq)({containerItemBuilder:h,descriptors:o,strokeData:(0,ge.AF)(l.properties,He.vi,{},null===(m=null===(f=l.properties.lineColor)||void 0===f?void 0:f.solid)||void 0===m?void 0:m.color),selector:l.selector,featureSwitches:d.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(g){return g.build()}))}),(c=u.build()).analyticsPane=!0,[2,c]):[2]}})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Xi),q.\u0275\u0275inject(Rr),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject($r),q.\u0275\u0275inject(wr),q.\u0275\u0275inject(li),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(jr),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(qr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(Mr.f),q.\u0275\u0275inject(ri.h,8))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function kn(n,e,t,r,i,a,o,s){return(0,p.mG)(this,void 0,void 0,function(){var l,u,c,d,v,h;return(0,p.Jh)(this,function(f){switch(f.label){case 0:return l=function(g){return o.get(g)},(u=_.map(a,function(m){return{objectName:t,propertyName:m.propertyName}})).push({objectName:t,propertyName:s||we}),[4,re(t,r,i,n,e,l,u,s)];case 1:return(c=f.sent())?(d=c.objectInstance,(v=c.cardBuilder).addGroup(void 0,function(m){le(m,t,d,e,l,a)}),(h=v.build()).analyticsPane=!0,[2,h]):[2]}})})}var Nt=b(15580),se=b(80981),ia=b(21002),Rn=b(92129),aa=b(84668),Wn=b(68082),vi=b(90006),Hn=new q.InjectionToken("CultureFormattingService"),Kn=b(77896),Jn=b(28326),na=b(98776),Qn=b(52364),$n=b(40645),Br=function(){function n(e,t,r,i){this.cultureService=e,this.formatStringConverterService=t,this.cultureSettingsService=r,this.cultureFormattingService=i,this.allCurrencyFormats=null,this.cultureSettingsService&&this.cultureFormattingService?this.useTypescriptService=!1:(this.useTypescriptService=!0,this.cultureService.initialize())}return n.prototype.updateCultureFormatUtils=function(){var e;this.useTypescriptService?e=this.cultureService.getFormatInfo():this.useTypescriptService||(e=this.cultureSettingsService.getFormatInfo()),this.formatUtil=new na.c(e)},n.prototype.cloneFormatInfo=function(e){if(!e)return null;var t={formatString:e.formatString,format:e.format,accuracy:e.accuracy,thousandSeparator:e.thousandSeparator};if(e.currencyFormat){var r=e.currencyFormat;t.currencyFormat={culture:r.culture,currencySymbol:r.currencySymbol,positivePattern:r.positivePattern,negativePattern:r.negativePattern}}if(e.dateTimeCustomFormat){var a=e.dateTimeCustomFormat;t.dateTimeCustomFormat={culture:a.culture,formatGroup:a.formatGroup,formatString:a.formatString}}return t},n.prototype.updateFormatUponDataTypeChange=function(e,t){this.updateCultureFormatUtils();var r=this.cloneFormatInfo(t);return this.formatUtil.updateFormatUponDataTypeChange(e,r)},n.prototype.changeFormat=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.changeFormat(e,i,r)},n.prototype.setThousandsSeparator=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.setThousandsSeparator(e,i,r)},n.prototype.toggleThousandsSeparator=function(e,t){this.updateCultureFormatUtils();var r=this.cloneFormatInfo(t);return this.formatUtil.toggleThousandsSeparator(e,r)},n.prototype.setAccuracy=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.setAccuracy(e,i,r)},n.prototype.setDateTimeFormat=function(e,t,r,i,a){this.updateCultureFormatUtils();var o=this.cloneFormatInfo(t);return this.formatUtil.setDateTimeFormat(e,o,r,i,a)},n.prototype.setCurrencyFormat=function(e,t,r,i,a,o,s){this.updateCultureFormatUtils();var l=this.cloneFormatInfo(t);return this.formatUtil.setCurrencyFormat(e,l,r,i,a,o,s)},n.prototype.setCurrencyFormatWithCulture=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o;return(0,p.Jh)(this,function(s){switch(s.label){case 0:return this.allCurrencyFormats?[3,2]:(a=this,[4,this.cultureService.getAllCurrencySymbolCustomFormatItemsInfoAsync()]);case 1:a.allCurrencyFormats=s.sent(),s.label=2;case 2:if(!(o=this.allCurrencyFormats.find(function(l){return l.culture===i})))throw"Cannot find selected currency format option based on selected value";return[2,this.setCurrencyFormat(e,t,r,o.culture,o.symbol,o.positivePattern,o.negativePattern)]}})})},n.prototype.setCustomFormatString=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(r);return this.formatUtil.setCustomFormatString(e,t,i)},n.prototype.getAllCurrencySymbolCustomFormatItemsInfo=function(){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(e){switch(e.label){case 0:return this.updateCultureFormatUtils(),this.useTypescriptService?[4,this.cultureService.getAllCurrencySymbolCustomFormatItemsInfoAsync()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,this.cultureSettingsService.getAllCurrencySymbolCustomFormatItemsInfo()]}})})},n.prototype.getAllCustomFormats=function(){return this.updateCultureFormatUtils(),this.useTypescriptService?this.cultureService.getAllCustomFormats():this.cultureSettingsService.getAllCustomFormats()},n.prototype.getAllDateTimeFormatItemsInfo=function(){return this.updateCultureFormatUtils(),this.useTypescriptService?this.cultureService.getAllDateTimeFormatItemsInfo():this.cultureSettingsService.getAllDateTimeFormatItemsInfo()},n.prototype.formatWithVBAString=function(e,t){if(this.updateCultureFormatUtils(),this.useTypescriptService){var r=this.formatStringConverterService.VBAToDotNet(e);return Promise.resolve(Jn.dx.formatValue(t,r))}return this.cultureFormattingService.formatWithVBAString(e,t)},n.prototype.convertVBAToDAX=function(e){return this.updateCultureFormatUtils(),this.useTypescriptService?Promise.resolve(this.formatStringConverterService.VBAToDotNet(e)):this.cultureFormattingService.convertVBAToDAX(e)},n.prototype.convertDotNetToVBA=function(e){return this.updateCultureFormatUtils(),this.useTypescriptService?Promise.resolve(this.formatStringConverterService.DotNetToVBA(e)):this.cultureFormattingService.convertDotNetToVBA(e)},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Qn.t),q.\u0275\u0275inject($n.z),q.\u0275\u0275inject(Kn.e,8),q.\u0275\u0275inject(Hn,8))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),io=function(){function n(e){this.formatInfoService=e}return n.prototype.getApplicableDateTimeFormats=function(e){switch(e){case"Date":return this.getAllDateFormats();case"DateTime":return(0,p.ev)((0,p.ev)((0,p.ev)([],this.getAllDateFormats(),!0),this.getAllDateTimeFormats(),!0),this.getAllTimeFormats(),!0);case"Time":return this.getAllTimeFormats();default:return[]}},n.prototype.getApplicableCommonDateTimeFormats=function(e){return"DateTime"===e?this.getCommonDateTimeFormats():[]},n.prototype.getApplicableCustomDateTimeFormats=function(){return this.getAllCustomFormats()},n.prototype.getAllCustomFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return la(t)})},n.prototype.getAllDateFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return oa(t)})},n.prototype.getAllTimeFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return sa(t)})},n.prototype.getAllDateTimeFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return function(n){return!oa(n)&&!sa(n)&&!la(n)}(t)})},n.prototype.getAllFormats=function(){return this.cachedAllFormats||(this.cachedAllFormats=this.formatInfoService.getAllDateTimeFormatItemsInfo()),this.cachedAllFormats},n.prototype.getCommonDateTimeFormats=function(){var e,t,r,i,a,o,s,l=this;if(this.cachedCommonDateTimeFormats)return this.cachedCommonDateTimeFormats;this.cachedCommonDateTimeFormats=[];var u=0,c=0,d=0,v=0,h=0,f=0,m=[],g=[],y=[],C=[],N=[],D=[],w=[];return this.getAllFormats().forEach(function(V,I){0===I||1===I?l.cachedCommonDateTimeFormats.push(V):"LongDate"===V.pattern&&u<2?(m.push(V),u++):"ShortDate"===V.pattern&&c<2?(g.push(V),c++):"YearMonth"===V.pattern&&d<1?(y.push(V),d++):"MonthDay"===V.pattern&&v<1?(C.push(V),v++):"LongTime"===V.pattern&&h<4?(N.push(V),h++):"ShortTime"===V.pattern&&f<4?(D.push(V),f++):"YearYYYY"===V.pattern&&w.push(V)}),(e=this.cachedCommonDateTimeFormats).push.apply(e,m||[]),(t=this.cachedCommonDateTimeFormats).push.apply(t,g||[]),(r=this.cachedCommonDateTimeFormats).push.apply(r,y||[]),(i=this.cachedCommonDateTimeFormats).push.apply(i,C||[]),(a=this.cachedCommonDateTimeFormats).push.apply(a,N||[]),(o=this.cachedCommonDateTimeFormats).push.apply(o,D||[]),(s=this.cachedCommonDateTimeFormats).push.apply(s,w||[]),this.cachedCommonDateTimeFormats},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Br))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}();function oa(n){return"LongDate"===n.pattern||"ShortDate"===n.pattern||"DMYDate"===n.pattern||"MonthDay"===n.pattern||"YearMonth"===n.pattern||"YearMM"===n.pattern||"YearYY"===n.pattern||"YearYYYY"===n.pattern}function sa(n){return"LongTime"===n.pattern||"ShortTime"===n.pattern}function la(n){return"Custom"===n.pattern}var oo=b(61561),so=function(){function n(e,t){this.localizationService=e,this.formatInfoService=t}return n.prototype.getAllSupportedCurrencyFormats=function(){return(0,p.mG)(this,void 0,void 0,function(){var e,t;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return this.cachedAllCurrencyFormatInfo?[2,this.cachedAllCurrencyFormatInfo]:[4,this.formatInfoService.getAllCurrencySymbolCustomFormatItemsInfo()];case 1:return e=r.sent(),this.cachedAllCurrencyFormatInfo=[],this.cachedAllCurrencyFormatInfo.push(this.createGeneralCurrencyFormat()),(t=this.cachedAllCurrencyFormatInfo).push.apply(t,e),[2,this.cachedAllCurrencyFormatInfo]}})})},n.prototype.getCommonSupportedCurrencyFormats=function(){return(0,p.mG)(this,void 0,void 0,function(){var e,t;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return this.cachedCommonCurrencyFormatInfo?[2,this.cachedCommonCurrencyFormatInfo]:[4,this.formatInfoService.getAllCurrencySymbolCustomFormatItemsInfo()];case 1:return e=r.sent(),this.cachedCommonCurrencyFormatInfo=[],this.cachedCommonCurrencyFormatInfo.push(this.createGeneralCurrencyFormat()),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return null===i.culture&&"\xa5"===i.symbol})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"en-GB"===i.culture})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"en-US"===i.culture})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"fr-CH"===i.culture})),(t=this.cachedCommonCurrencyFormatInfo).push.apply(t,_.filter(e,function(i){return null===i.culture&&"\u20ac"===i.symbol})),this.cachedCommonCurrencyFormatInfo=_.compact(this.cachedCommonCurrencyFormatInfo),[2,this.cachedCommonCurrencyFormatInfo]}})})},n.prototype.createGeneralCurrencyFormat=function(){return{formatType:"CurrencyGeneral",culture:null,displayLabel:this.localizationService.get("Format_Label_Currency_General"),symbol:"$",positivePattern:0,negativePattern:0}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Br))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),lo=b(91836),ua=function(){function n(e,t){this.formatInformationParserService=e,this.formatInformationService=t,this.cache=new Map}return n.prototype.getFormatInformation=function(e,t){var r,i;return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.Jh)(this,function(d){switch(d.label){case 0:return a=this.cache.get(e.name),o=a?.get(t),s=null===(r=(0,W.PQ)(e))||void 0===r?void 0:r.columnProperties,l=null===(i=s?.[t])||void 0===i?void 0:i.formatString,(u=null!=o)&&!ca(o.formatStringDotNet,l)&&(u=!1),u?[2,o]:[3,1];case 1:return[4,this.updateCacheInternal(e,t,l)];case 2:return[2,d.sent()]}})})},n.prototype.updateCache=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){return[2,this.updateCacheInternal(e,t,r,i)]})})},n.prototype.updateCacheFromFormatInformation=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.updateCacheInternal(e,t,r?.formatString,r)];case 1:return[2,a.sent().formatStringVBA]}})})},n.prototype.updateCacheInternal=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.Jh)(this,function(c){switch(c.label){case 0:return a=this.cache.get(e.name),_.isEmpty(r)&&null==i?(a&&a.delete(t),[2]):(null==a&&this.cache.set(e.name,a=new Map),[4,this.formatInformationService.convertDotNetToVBA(r)]);case 1:return o=c.sent(),null==i?[3,2]:(l=i,[3,4]);case 2:return[4,this.formatInformationParserService.tryParseVBAFormatString(o)];case 3:l=c.sent(),c.label=4;case 4:return s=l,T.fF.assert(function(){return ca(r,s.formatString)},"after .NET->VBA->FormatInformation conversion, original .NET string is changed"),a.set(t,u={formatStringVBA:o,formatStringDotNet:r,formatInformation:s}),[2,u]}})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(lo.Z),q.\u0275\u0275inject(Br))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ca(n,e){return(n??"")===(e??"")}var uo=b(27980),Xe="visualLevelFormat",pr="customFormatString",di="formatOptions",hi="currencyFormats",fi="percentageOn",mi="thousandSeparatorOn",gi="decimalPoints",Fr="visualFieldDataType",po=[{type:"General",displayLabelKey:"Format_Label_General"},{type:"CurrencyGeneral",displayLabelKey:"Format_Label_Currency"},{type:"DateTimeGeneralPattern",displayLabelKey:"Format_Label_DateTime"},{type:"NumberDecimal",displayLabelKey:"DataType_Label_Number"},{type:"NumberWhole",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Percentage",displayLabelKey:"Format_Label_Percentage"},{type:"Scientific",displayLabelKey:"Format_Label_Scientific"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],vo=[{type:"WholeNumber",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Number",displayLabelKey:"DataType_Label_Number"},{type:"Currency",displayLabelKey:"DataType_Label_Currency"},{type:"DateTime",displayLabelKey:"DataType_Label_Date_Time"},{type:"Date",displayLabelKey:"DaxTemplates_DateField"},{type:"Time",displayLabelKey:"DataType_Label_Time"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],ho=[{objectName:Xe,propertyName:pr},{objectName:Xe,propertyName:di},{objectName:Xe,propertyName:hi},{objectName:Xe,propertyName:fi},{objectName:Xe,propertyName:mi},{objectName:Xe,propertyName:gi},{objectName:Xe,propertyName:Fr}],va=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h){this.conceptualSchemaProxy=e,this.currencyFormatService=t,this.dateTimeFormatService=r,this.dataSourcesService=i,this.displayNameService=a,this.featureSwitchService=o,this.formatInformationCacheService=s,this.formatInformationService=l,this.lazyScoped=u,this.localizationService=c,this.visualAuthoringService=d,this.visualAuthoringOperationsService=v,this.dataModelService=h}return n.prototype.getVisualLevelFormatStringCard=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,v,h,f,m,g,y,C,N=this;return(0,p.Jh)(this,function(D){switch(D.label){case 0:i=new S.lg("visualLevelFieldsFormat"),a=new S.CQ(i,"Visual_Level_Fields_Formatting",ho,function(w){return N.localizationService.get(w)},!0),o=function(n){var e=(0,W.oJ)(n),t=(0,W.Ml)(n),r=[];_.isEmpty(e)||_.forEach(t,function(a,o){_.forEach(a.all(),function(s){var l=(0,Ct.rC)(e,s.queryRef);l&&r.push({select:l,isHidden:s.hidden})})});var i=_.groupBy(r,function(a){return a.select.name});return T.fF.assert(function(){return _.every(i,function(a){if(_.size(a)<=1)return!0;var o=a[0].isHidden;return _.every(a,function(s){return s.isHidden===o})})},"We expect all projections corresponding to the same select has the same isHidden value. Now some projections of the same select has different isHidden values. Either the assumption is changed, or there is a bug."),_.uniqBy(r,function(a){return a.select.name})}(e),s=[],l=0,u=o,D.label=1;case 1:return l<u.length?[4,this.formatInformationCacheService.getFormatInformation(e,u[l].select.name)]:[3,4];case 2:v=D.sent(),s.push(v),D.label=3;case 3:return l++,[3,1];case 4:return h=[],_.find(s,function(w){var F;return Si(null===(F=w?.formatInformation)||void 0===F?void 0:F.format)})?[4,this.currencyFormatService.getCommonSupportedCurrencyFormats()]:[3,7];case 5:return f=D.sent(),[4,this.currencyFormatService.getAllSupportedCurrencyFormats()];case 6:m=D.sent(),g=_.uniqBy((0,p.ev)((0,p.ev)([],f??[],!0),m??[],!0),da),h.push.apply(h,g),D.label=7;case 7:return y=null===(r=(0,W.PQ)(e))||void 0===r?void 0:r.columnProperties,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 8:return C=D.sent(),a.addGroup("visualSelects",function(w){w.withDisplayName("Apply_Settings_To").withCollapsible(!1),w.addContainer("visual-fields-container",function(F){_.forEach(o,function(V,I){var j=V.select.name,L=V.select.expr,x=N.displayNameService.getDisplayName(L,C,t,j,y,{includeHierarchyName:!0,includeVariationSource:!0});F.addContainerItem(j,x,function(z){V.isHidden&&z.withIcon("hide3"),z.withGroups([N.getSingleFieldFormatGroup(i,e,j,L,s[I],C,h)])})})})}),[2,a.build()]}})})},n.prototype.saveSlice=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(i){return e!==Xe?[2]:(0,J.Vz)(r)?t.name===pr?[2,this.saveVisualLevelFormatStringSlice(t,r)]:t.name===di?[2,this.saveVisualLevelFormatOptionsSlice(t,r)]:t.name===hi?[2,this.saveVisualLevelCurrencyFormatOptionsSlice(t,r)]:t.name===mi?[2,this.saveVisualLevelThousandSeparatorSlice(t,r)]:t.name===fi?[2,this.saveVisualLevelPercentageSlice(t,r)]:t.name===gi?[2,this.saveVisualLevelDecimalPointsSlice(t,r)]:t.name===Fr?[2,this.saveVisualLevelFieldDataTypeSlice(t,r)]:[2]:(T.fF.assertFail("Expect visualLevelFormatStringFormattingHelper.saveSlice to be called only for a visual container"),[2])})})},n.prototype.resetProperty=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return t!==pr?[3,1]:(this.visualAuthoringOperationsService.removeAllVisualLevelFormatStrings(e),[3,3]);case 1:return t!==Fr?[3,3]:[4,this.visualAuthoringService.getVisualCalcDaxParserServiceContext(e)];case 2:r=i.sent(),this.visualAuthoringOperationsService.removeAllVisualLevelUserSetDataTypes(e,r),i.label=3;case 3:return[2]}})})},n.prototype.saveVisualLevelFieldDataTypeSlice=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,l=this;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return i=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(i)?(T.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=(0,vi.F)(a=e.value),[4,this.visualAuthoringService.updateVisualCalculationDataType(t,i,o)]);case 1:return u.sent()?[2,this.saveSliceWithFormatInformationUpdate(e,t,function(c){return l.formatInformationService.updateFormatUponDataTypeChange((0,vi.F)(a),c.formatInformation)})]:[2]}})})},n.prototype.saveVisualLevelFormatStringSlice=function(e,t){var r,i;return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,c;return(0,p.Jh)(this,function(d){switch(d.label){case 0:return a=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(a)?(T.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=e.value,[4,this.getFieldTypeAndFormatInfo(t,a)]);case 1:return s=d.sent(),l=s?.formatInformation,u="Custom"===l?.format&&"Custom"===(null===(i=l?.dateTimeCustomFormat)||void 0===i?void 0:i.formatGroup),c=u?function(n){var e=ha(n);return(0,p.pi)((0,p.pi)({},e),{dateTimeCustomFormat:{culture:null,formatGroup:"Custom",formatString:e.formatString}})}(o):ha(o),this.formatInformationCacheService.updateCache(t,a,o,c),this.visualAuthoringService.setVisualLevelFormatString(t,a,o,!0),[2]}})})},n.prototype.saveVisualLevelFormatOptionsSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r=this;return(0,p.Jh)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o,s,c,l=JSON.parse(e.value),u=l.formatType;return c=function(n){var e=n.formatType;return"DateTimeGeneralPattern"===e||"DateTimeCustom"===e||"Custom"===e&&"Custom"===n.dateTimePattern}(l)?r.formatInformationService.setDateTimeFormat(a.valueType.primitiveType,a.formatInformation,u,l.dateTimePattern,null!==(o=l.formatString)&&void 0!==o?o:null===(s=a.formatInformation)||void 0===s?void 0:s.formatString):r.formatInformationService.changeFormat(a.valueType.primitiveType,a.formatInformation,u),c})]})})},n.prototype.saveVisualLevelCurrencyFormatOptionsSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r=this;return(0,p.Jh)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o=JSON.parse(e.value);return r.formatInformationService.setCurrencyFormat(a.valueType.primitiveType,a.formatInformation,o.formatType,o.culture,o.symbol,o.positivePattern,o.negativePattern)})]})})},n.prototype.saveVisualLevelThousandSeparatorSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r=this;return(0,p.Jh)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){return r.formatInformationService.setThousandsSeparator(a.valueType.primitiveType,a.formatInformation,e.value)})]})})},n.prototype.saveVisualLevelPercentageSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r=this;return(0,p.Jh)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o=JSON.parse(e.value);return r.formatInformationService.changeFormat(a.valueType.primitiveType,a.formatInformation,o?"Percentage":"General")})]})})},n.prototype.saveVisualLevelDecimalPointsSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r=this;return(0,p.Jh)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){return r.formatInformationService.setAccuracy(a.valueType.primitiveType,a.formatInformation,e.value)})]})})},n.prototype.saveSliceWithFormatInformationUpdate=function(e,t,r){var i;return(0,p.mG)(this,void 0,void 0,function(){var a,o,s;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return a=null===(i=e.selector)||void 0===i?void 0:i.metadata,_.isEmpty(a)?(T.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):[4,this.getFieldTypeAndFormatInfo(t,a)];case 1:return o=l.sent(),T.fF.assert(function(){return null!=o&&null!=o?.valueType},"Expect the matching field has data type and format info"),o&&null!=o?.valueType?(s=r(o),[4,this.formatInformationCacheService.updateCacheFromFormatInformation(t,a,s)]):[2];case 2:return l.sent(),this.visualAuthoringService.setVisualLevelFormatString(t,a,s?.formatString,!0),[2]}})})},n.prototype.getSingleFieldFormatGroup=function(e,t,r,i,a,o,s){var u,l=this,c=new S.mQ(new S.SS(e,"singleFieldVisualLevelFormatGroup"),function(f){return l.localizationService.get(f)});c.withDisplayName("Format_Options");var d=null===(u=i.getMetadata(o))||void 0===u?void 0:u.type;if(T.fF.assert(function(){return null!=d},"Expect the field ".concat(r," to have a data type")),this.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport){var v=(0,vi.m)(d?.primitiveType)||"Number";this.checkToAddDataTypesDropdown(c,i,r,v);var h=a?.formatInformation;this.addFormatsDropdown(c,r,v,h),this.checkToAddCurrencyFormats(c,r,h,s),this.checkToAddNumericFormatControls(c,r,v,h),"Custom"===h?.format&&this.addCustomFormatStringSlices(c,t,r,d,"Visual_FormatCode")}else this.addCustomFormatStringSlices(c,t,r,d,"Format");return c.build()},n.prototype.addCustomFormatStringSlices=function(e,t,r,i,a){var s,l,o=this,u=function(n){var e;return n?.bool||n?.text||!(null===(e=n?.misc)||void 0===e||!e.sparkline)}(i);T.fF.assert(function(){return!u||!o.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport},"If the field does not support custom format string, we do not expect this function to be called when visualLevelFormatStringFullSupport is on"),u&&e.addSimpleSlice("noCustomFormatSupportMessage",function(){return new S.G_({descriptor:{objectName:Xe,selector:{metadata:r},propertyName:void 0},value:o.localizationService.get("CustomFormatString_Disabled_For_CertainTypedFields")}).build()});var c=null===(s=(0,W.PQ)(t))||void 0===s?void 0:s.columnProperties;e.addSimpleSlice("singleFieldVisualLevelFormatString",new S.fq({descriptor:{objectName:Xe,propertyName:pr,selector:{metadata:r}},value:null===(l=c?.[r])||void 0===l?void 0:l.formatString,placeholder:"Auto",validators:{maxLength:{type:5,value:255}}}).build(),function(d){d.withCustomDisplayName(a),u&&d.withDisabled(!0)}),function(n,e){n.addSimpleSlice("singleFieldVisualLevelFormatStringLearnMoreLink",new S.Vc({descriptor:{objectName:Xe,selector:{metadata:e},propertyName:void 0},value:function(){window.open("https://go.microsoft.com/fwlink/p/?LinkId=2099021","_blank")}}).build(),function(t){return t.withCustomDisplayName("LearnMore").withSuppressDisplayName(!0)})}(e,r)},n.prototype.checkToAddDataTypesDropdown=function(e,t,r,i){if((0,H.jX)(t)){var a=this.getDataTypeDropdownItems(),o=_.find(a,function(s){return s.value===i});e.addSimpleSlice("dataTypeOptions",function(){return new S.uY({items:a,descriptor:{objectName:Xe,propertyName:Fr,selector:{metadata:r}},value:o}).build()},function(s){s.withCustomDisplayName("DataType_Title")})}},n.prototype.addFormatsDropdown=function(e,t,r,i){var a=this.getFieldFormatOptions(r),o=_.map(a,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=_.findIndex(a,function(u){return function(n,e){return T.fF.assert(function(){return null!=e},"the given formatOption comes from the main format options dropdown and should never be null"),null!=n&&(T.fF.assert(function(){return"CurrencyCustom"!==e.formatString},"We do not expect the main format options dropdown to have CurrencyCustom"),(Si(n.format)?"CurrencyGeneral":n.format)===e.formatType&&(!n.dateTimeCustomFormat||("Custom"===n.format?"Custom"===e.formatType:n.dateTimeCustomFormat.formatGroup===e.dateTimePattern&&n.dateTimeCustomFormat.formatString===e.formatString)))}(i,u)}),l=-1!==s?o[s]:null;e.addSimpleSlice("formatOptions",function(){return new S.uY({items:o,descriptor:{objectName:Xe,propertyName:di,selector:{metadata:t}},value:l}).build()},function(u){u.withCustomDisplayName("Format")})},n.prototype.checkToAddCurrencyFormats=function(e,t,r,i){var a=r?.format;if(Si(a)){var o=_.map(i,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=function(n){return"".concat(xt(n.culture),"-").concat(xt(n.currencySymbol),"-").concat(xt(n.negativePattern),"-").concat(xt(n.positivePattern))}(r?.currencyFormat),l=_.findIndex(i,function(u){return da(u)===s});e.addSimpleSlice("currencyFormats",function(){return new S.uY({items:o,descriptor:{objectName:Xe,propertyName:hi,selector:{metadata:t}},value:o[l]}).build()},function(u){u.withCustomDisplayName("Properties_Currency_Format")})}},n.prototype.checkToAddNumericFormatControls=function(e,t,r,i){return(0,p.mG)(this,void 0,void 0,function(){var a=this;return(0,p.Jh)(this,function(o){return(0,na.R)(r,i,this.dateTimeFormatService)?(e.addSimpleSlice("percentageFormat",function(){return new S.bd({descriptor:yi(t,fi),value:"Percentage"===i?.format}).build()},function(s){s.withCustomDisplayName("Properties_Percentage_Format")}),e.addSimpleSlice("thousandSeparatorFormat",function(){return new S.bd({descriptor:yi(t,mi),value:i?.thousandSeparator}).build()},function(s){s.withCustomDisplayName("Properties_Thousands_Separator")}),e.addSimpleSlice("decimalPoints",function(){return new S.mu({descriptor:yi(t,gi),value:i?.accuracy,options:{minValue:{type:0,value:0},maxValue:{type:1,value:15}},placeholderText:a.localizationService.get("Visual_Auto")}).build()},function(s){s.withCustomDisplayName("Properties_Decimal_Places")}),[2]):[2]})})},n.prototype.getFieldFormatOptions=function(e){var o,t=this,r={formatType:"Custom",displayLabel:this.localizationService.get("Custom")},i={formatType:"Custom",displayLabel:this.localizationService.get("Custom"),dateTimePattern:"Custom"},a=!function(n){return"Text"===n||"Boolean"===n}(e);if(function(n){return"Date"===n||"DateTime"===n||"Time"===n}(e)){var s=this.dateTimeFormatService.getApplicableCommonDateTimeFormats(e),l=this.dateTimeFormatService.getApplicableDateTimeFormats(e),u=(0,p.ev)((0,p.ev)([],s,!0),l,!0);T.fF.assert(function(){return null==_.find(u,function(v){return"Dynamic"===v.formatType})},"We do not expect a dateTime format item is in type Dynamic"),o=function(n){return _.map(n,function(e){return{formatType:e.formatType,displayLabel:e.displayLabel,formatString:e.formatString,dateTimePattern:e.pattern}})}(u),a&&(_.remove(o,function(v){return"Custom"===v.formatType}),o.unshift(i))}else{var c=this.dataModelService.getCompatibleFormats([e]);c=_.filter(c,function(v){return"Dynamic"!==v}),o=_.compact(_.map(c,function(v){var h=_.find(po,function(f){return f.type===v});if(T.fF.assert(function(){return null!=h||"Custom"===v},"We expect to haven an entry for format type ".concat(v)),h)return{formatType:v,displayLabel:t.localizationService.get(h.displayLabelKey)}})),a&&o.push(r)}a||_.remove(o,function(v){return"Custom"===v.formatType});var d=_.uniqBy(o,function(v){return function(n){return"".concat(n.formatType,"-").concat(xt(n.formatString))}(v)});return d},n.prototype.getFieldTypeAndFormatInfo=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return i=(0,W.oJ)(e),(a=_.find(i,function(c){return c.name===t}))?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[2];case 1:return o=u.sent(),s=null===(r=a.expr.getMetadata(o))||void 0===r?void 0:r.type,T.fF.assert(function(){return null!=s},"We expect the valueType of the field matching the given givenName to be defined"),[4,this.formatInformationCacheService.getFormatInformation(e,t)];case 2:return l=u.sent(),[2,{valueType:s,formatInformation:l?.formatInformation}]}})})},n.prototype.getDataTypeDropdownItems=function(){var e=this;return this.dataTypeDropdownItems||(this.dataTypeDropdownItems=_.map(vo,function(t){return{value:t.type,displayName:e.localizationService.get(t.displayLabelKey),label:t.displayLabelKey}})),this.dataTypeDropdownItems},n.prototype.getVisualCalcService=function(){return(0,p.mG)(this,void 0,void 0,function(){var e;return(0,p.Jh)(this,function(t){switch(t.label){case 0:return null!=this.visualCalcServiceInternal?[3,2]:(e=this,[4,this.lazyScoped.get(oo.w)]);case 1:e.visualCalcServiceInternal=t.sent(),t.label=2;case 2:return[2,this.visualCalcServiceInternal]}})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(so),q.\u0275\u0275inject(io),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(Ir.O),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(ua),q.\u0275\u0275inject(Br),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(uo.Q),q.\u0275\u0275inject(Wn.n))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function da(n){return"".concat(xt(n.culture),"-").concat(xt(n.symbol),"-").concat(xt(n.negativePattern),"-").concat(xt(n.positivePattern))}function yi(n,e){return{objectName:Xe,propertyName:e,selector:{metadata:n}}}function Si(n){return"CurrencyGeneral"===n||"CurrencyCustom"===n}function ha(n){return{formatString:_.isEmpty(n)?void 0:n,format:"Custom",thousandSeparator:!1,currencyFormat:null,dateTimeCustomFormat:null}}function xt(n){return n??""}var No=[R.X,R.Y,R.Lu,R.oU,R.f4,R.Zp];function fa(n,e,t,r){var i=e.layouts.withId(r),a=_.cloneDeep(i.position);T.fF.assertValue(a,"VisualContainer.position");var o=parseInt(n.value,10);if(!isNaN(o)&&null!=o){if(n.name===R.X)if(1!==r){var s=(0,W.P4)((0,p.pi)((0,p.pi)({},a),{x:o}),e);a.x=s.x}else a.x=o;else n.name===R.Y?1!==r?(s=(0,W.P4)((0,p.pi)((0,p.pi)({},a),{y:o}),e),a.y=s.y):a.y=o:n.name===R.Lu?a.width=o:n.name===R.oU&&(a.height=o);t.layoutAuthoring?t.layoutAuthoring.moveCanvasItemFromContract(e,a):T.fF.assertFail("layoutAuthoring should be provided for saving General slice")}}function ma(n){return n.queryOptions||(n.queryOptions={}),n.queryOptions}function ga(n,e){void 0===e&&(e=!0);var t=n.getCurrentSection();return _.chain(n.getAllSections()).filter(function(i){return!(!(1&i.type)||e&&i.name===t.name)}).map(function(i){return i.name}).value()}var Mo=[R.X,R.Y,R.Lu,R.oU];function ya(n){if(n)return Sa(n&&n.getWarnings())}function Sa(n){var e=n&&n.visualObjectWarnings;if(e){var t=_.reduce(e,function(r,i,a){var o=_.first(i),s=o&&_.first(o.warnings);return s&&(r[a]=s),r},{});return _.isEmpty(t)?void 0:t}}var ba=b(18659),qa=b(28340),Ca=b(42145),Da=b(18664),bi=b(45545),wa=b(34021),Fa=b(92374),Eo=b(47316),vr=b(79154),qi=b(48145),Go=b(77200),Na=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,N,D){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.dataSourcesService=r,this.displayNameService=i,this.explorationCapabilitiesService=a,this.explorationNavigationService=o,this.featureSwitchService=s,this.formattingSliceTransformerService=l,this.formFactorService=u,this.lazyScopedProvider=c,this.localizationService=d,this.runningVisualService=v,this.themeService=h,this.viewModeStateService=f,this.visualAuthoring=m,this.visualPluginOperationsService=g,this.visualPluginService=y,this.visualStylePresetService=C,this.visualLevelFormatStringHelperService=N,this.formattingObjectDefinitionsService=D}return n.prototype.getCardBuildingOptions=function(e,t){var r=this.explorationNavigationService.getCurrentExploration(),i=this.explorationCapabilitiesService.getCapabilities();if((0,J.Vz)(e)){var a=se.XW,o=e.config.singleVisual.evaluatedObjects,s=se.fU,l=e.config.singleVisual,u=l.visualType,c=this.visualPluginService.capabilities(l.visualType),v=this.visualPluginOperationsService,h={isScriptVisual:this.visualPluginService.isScriptVisual(u),isAnalysisVisual:v.isAnalysisVisual(u),isQueryVisual:v.isQueryVisual(u),isQnaVisual:v.isQnaVisual(u)},f=this.themeService.getVisualStyle(r.themeCollection);return{allowConditionalFormatting:!(h.isScriptVisual||h.isAnalysisVisual||h.isQnaVisual),capabilities:c,container:e,descriptors:a,exploration:r,evaluatedObjects:o,explorationCapabilities:i,featureSwitches:t,props:s,visualKind:h,visualStyle:f,isQueryVisualWithoutData:(0,rr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)}}return{allowConditionalFormatting:!1,container:e,descriptors:a=se.XW,exploration:r,evaluatedObjects:o=e.evaluatedObjects,explorationCapabilities:i,featureSwitches:t,props:s=ba.fU}},n.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,J.q4)(e))return{messageKey:void 0};if((0,rr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if((0,ae.D1)(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},n.prototype.getFormattingModel=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i,a,s,l,u,c,d,v,h,f;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return e?[4,this.featureSwitchService.getFeatureSwitches()]:[2,{cards:[]}];case 1:if(t=m.sent(),r=this.getCardBuildingOptions(e,t),i=(0,J.Vz)(e),(0,J.Vz)(e)){if((a=r.isQueryVisualWithoutData)&&!t.onObject||(0,ae.D1)(e))return[2,{cards:[]}];if(null==((f=this.runningVisualService.getVisual(e))&&f.getAdapter())&&!a||f&&f.getHasPendingChanges()||f&&f.getErrorInfo())return[2,{cards:[]}]}return l=S.Nq.bind,(u=!t.onObject)?[4,this.getPropertiesCard(r)]:[3,3];case 2:u=m.sent(),m.label=3;case 3:return c=[void 0,u],(d=!t.onObject&&i)?[4,this.getTitleCard(r,t)]:[3,5];case 4:d=m.sent(),m.label=5;case 5:return c=c.concat([d,!t.onObject&&this.getEffectsCard(r)]),(v=t.visualLevelFormatStringConsumption&&t.visualLevelFormatStringAuthoring&&t.visualCalculationsAuthoring)?[4,this.getVisualLevelFormattingCard(r)]:[3,7];case 6:v=m.sent(),m.label=7;case 7:return c=c.concat([v,this.getHeaderIconsCard(r),this.getTooltipsCard(r),this.getAltTextCard(r)]),(h=t.onObject)?[4,this.getAdvancedOptionsCard(r)]:[3,9];case 8:h=m.sent(),m.label=9;case 9:return s=new(l.apply(S.Nq,c.concat([h]))),i&&(f=this.runningVisualService.getVisual(e),s.withWarnings(ya(f))),[2,s.build()]}})})},n.prototype.getObjectDefinitions=function(e,t){if(e)return(0,J.Vz)(e)?function(n,e){var t,r;return(0,W.jt)([e])||(0,W.Wu)([e])?(0,p.pi)((0,p.pi)({},n??{}),((t={})[Xe]=[{properties:(r={},r[pr]={},r[Fr]={},r)}],t)):n}(t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getVcObjectDefinitions(e):e.config.singleVisual.vcObjects,e):e.objects},n.prototype.getObjectDescriptors=function(e){return(0,J.Vz)(e)?se.XW:ba.C7},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ae.um)(e,this.featureSwitchService)}},n.prototype.saveProperties=function(e,t,r,i){var a=this,o=this.formFactorService.getCurrentLayout();if((0,J.Vz)(r)){if(this.featureSwitchService.featureSwitches.onObject){var s=this.runningVisualService.getVisual(r);T.fF.assert(function(){return _.every(e,function(f){return null!=f.visualUpdateSource})},"All changes should have a visual update source");var l=[],u=_.groupBy(e,function(f){return f.visualUpdateSource});for(var c in u){var v=u[c].map(function(f){return(0,ae.H8)(f)});l.push.apply(l,s.onDataViewObjectChanged(v,+c,!1))}T.fF.assertNonEmpty(l,"There should be at least one visual object change"),l.map(function(f){return(0,ae.nH)(r,f)}).forEach(function(f){return a.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)})}else e.forEach(function(f){a.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}else e.forEach(function(f){a.saveVisualContainerGroupProperties(f.objectName,t,r,f.propertySlice,o)}),t.visualAuthoring.raiseVisualContainerGroupChanged(r)},n.prototype.saveVisualContainerProperties=function(e,t,r,i,a){!function(n,e,t,r,i,a){if((0,J.Vz)(t)){var o=t.config.singleVisual;r.telemetryService&&function(n,e,t,r){var i=e.name;if(n!==R.LQ||i!==R.f4&&i!==R.Zp)if(n===R.yD){var s=void 0;"type"===i?s=""+e.value:"section"===i&&(s=e.value===Nt.pJ?Nt.pJ:"custom"),r.logEvent(it.Lo,{objectName:n,propertyName:i,newValue:s,visualType:t})}else n===Xe&&i===pr&&r.logEvent(it.Lo,{objectName:n,propertyName:i,newValue:"Custom",visualType:t});else r.logEvent(it.Lo,{objectName:n,propertyName:i,newValue:e.value,visualType:t})}(n,e,o.visualType,r.telemetryService),n===R.H&&function(n,e){var t,r=e.visualStylePresetService,i=e.themeService;if(r&&i){var a=null===(t=n.evaluatedObjects)||void 0===t?void 0:t.stylePreset,s=r.getStylePreset(n.visualType,a&&a.name);if(s){var l=i.getVisualStyle({}),u=s.evaluate(l);(0,k.Gc)(n.objects,u),(0,k.Gc)(n.vcObjects,u)}}}(o,r),n===R.TY&&function(n){if(n.evaluatedObjects){var e=n.evaluatedObjects.dropShadow;if(e&&e.preset&&e.preset!==se.$g){var t=(0,ia.X2)(e.preset,e.position);if(t){var r=(0,Ye.cA)(t.angle),i=(0,Ye.cA)(t.shadowDistance),a=(0,Ye.cA)(t.shadowBlur),o=(0,Ye.cA)(t.shadowSpread),s=(0,Ye.cA)(t.transparency);(0,k.sO)(n.vcObjects,{objectName:R.TY,propertyName:"angle"},null,r),(0,k.sO)(n.vcObjects,{objectName:R.TY,propertyName:"shadowDistance"},null,i),(0,k.sO)(n.vcObjects,{objectName:R.TY,propertyName:"shadowBlur"},null,a),(0,k.sO)(n.vcObjects,{objectName:R.TY,propertyName:"shadowSpread"},null,o),(0,k.sO)(n.vcObjects,{objectName:R.TY,propertyName:"transparency"},null,s)}}}}(o),n===Xe?a.saveSlice(n,e,t):n===R.LQ&&function(n){return _.includes(No,n.name)}(e)?function(n,e,t,r){var i=e.config.singleVisual;n.name===R.f4?ma(i).allowBinnedLineSample=!!n.value:n.name===R.Zp?ma(i).allowOverlappingPointsSample=!!n.value:fa(n,e,t,r)}(e,t,r,i):(o.vcObjects=o.vcObjects||{},(0,cr.yr)(n,e,o.vcObjects,r),o.autoSelectVisualType=void 0)}}(e,i,r,t,a,this.visualLevelFormatStringHelperService)},n.prototype.saveVisualContainerGroupProperties=function(e,t,r,i,a){!function(n,e,t,r,i){(0,J.q4)(t)&&(n===R.LQ&&function(n){return _.includes(Mo,n.name)}(e)?fa(e,t,r,i):(t.objects=t.objects||{},(0,cr.yr)(n,e,t.objects,r)))}(e,i,r,t,a)},n.prototype.revertVisualSlicesToDefinitions=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d;return(0,p.Jh)(this,function(v){switch(v.label){case 0:r=[],i=(0,ae.Wx)(e),a=0,o=i,v.label=1;case 1:return a<o.length?(r.push(l=(s=o[a]).canvasItem),u=s.descriptors,c=void 0,(0,J.Vz)(l)?((c=(d=l.config.singleVisual).vcObjects)||(d.vcObjects=c={}),[4,this.resetVisualProperty(l,u)]):[3,3]):[3,6];case 2:return v.sent(),[3,4];case 3:(c=l.objects)||(l.objects=c={}),v.label=4;case 4:(0,ae.Aw)(c,u),v.label=5;case 5:return a++,[3,1];case 6:return this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t}),[2]}})})},n.prototype.resetVisualProperty=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a;return(0,p.Jh)(this,function(o){switch(o.label){case 0:r=0,i=t,o.label=1;case 1:return r<i.length?(a=i[r]).objectName!==Xe?[3,3]:[4,this.visualLevelFormatStringHelperService.resetProperty(e,a.propertyName)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.resolvePlaceholder=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,a;return(0,p.Jh)(this,function(s){switch(s.label){case 0:if(!(0,S.Xo)(e))return[3,9];switch(e.name){case"actions":return[3,1];case"title":return[3,3];case"sizeAndStyle":return[3,5]}return[3,7];case 1:return[4,this.resolveActionCardPlaceholder(t,e.suppressDefaultValue)];case 2:return r=s.sent(),[3,8];case 3:return[4,this.resolveTitleCardPlaceholder(t)];case 4:return r=s.sent(),[3,8];case 5:return[4,this.resolveVisualSizeAndStyleCardPlaceholder(t)];case 6:return r=s.sent(),[3,8];case 7:T.fF.assertNever(e.name),s.label=8;case 8:return T.fF.assert(function(){return!!r||e.suppressDefaultValue},"Expected either a placeholder or default value being suppressed"),[2,r];case 9:return(0,S.G8)(e)?(T.fF.assertNever(e.name),[3,15]):[3,10];case 10:return(0,S.Kw)(e)?"stylePreset"===(a=void 0,e.name)?[3,11]:[3,13]:[3,15];case 11:return[4,this.resolveStylePresetSlicePlaceholder(t)];case 12:return a=s.sent(),[3,14];case 13:T.fF.assertNever(e.name),s.label=14;case 14:return[2,a];case 15:return T.fF.assertFail("Unexpected host placeholder"),[2]}})})},n.prototype.resolveActionCardPlaceholder=function(e,t){var r,i;return(0,p.mG)(this,void 0,void 0,function(){var a,o,s,l,u,d,v,h,f,m,g,y,C=this;return(0,p.Jh)(this,function(N){switch(N.label){case 0:return(0,J.q4)(e)?[2,this.resolveActionCardPlaceholderDefault(t)]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return a=N.sent(),o=e.config.singleVisual.evaluatedObjects,s=se.fU.visualLink,u=(l=e.config.singleVisual).visualType,this.visualPluginService.capabilities(l.visualType).supportsVisualLink?(d=se.eJ,v=null!==(r=o?.visualLink)&&void 0!==r?r:{show:!1,type:d},h=null!==(i=v.type)&&void 0!==i?i:d,f=se.Dy.members().map(function(D){return D.value}),a.applyAllSlicersButton||(h!==se.cy&&_.remove(f,function(D){return D===se.cy}),h!==se.WM&&_.remove(f,function(D){return D===se.WM})),h!==se.d8&&h!==se.Ol&&(!a.drillthroughButtonGA&&(u===Tt.L.basicShape.name||u===Tt.L.image.name)&&_.remove(f,function(D){return D===se.d8}),!a.navAndDrillthroughActionTypes&&u===Tt.L.actionButton.name&&_.remove(f,function(D){return D===se.d8||D===se.Ol})),(u===Tt.L.basicShape.name||u===Tt.L.image.name)&&_.remove(f,function(D){return D===se.Ol}),(g=v.type===se.Ol)?[4,this.lazyScopedProvider.get("drillthrough")]:[3,3]):[2,this.resolveActionCardPlaceholderDefault(t)];case 2:g=N.sent(),N.label=3;case 3:return m=g,[2,{item:y=new S.CQ(new S.lg("action"),"Visual_VisualLink",[s.show,s.type,s.bookmark,s.navigationSection,s.drillthroughSection,s.webUrl,s.suppressDefaultTooltip,s.showDefaultTooltip,s.tooltip,s.enabledTooltip,s.disabledTooltip],function(D){return C.localizationService.get(D)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:s.show,value:!!v.show}).build()}).addGroup("action",function(D){var w,F;D.withDisplayName("Visual_VisualLink").addSimpleSlice("type",new S.uY({descriptor:s.type,value:h,filterValues:f}).build());var I,V=[{displayName:function(Ie){return Ie.get("None")},value:se.Qi}],j=v.type===se.rp,L=se.Qi;if(j){var x=C.bookmarkService.getAllBookmarks(),z=_.map(x,function(me){return me.name});I=(0,p.ev)((0,p.ev)([],_.map(V,function(me){return me.value}),!0),z||[],!0);var P=v.bookmark;P&&-1!==I.indexOf(P)&&(L=P)}D.addSimpleSlice("bookmark",new S.uY({descriptor:s.bookmark,value:L,mergeValues:V,filterValues:I}).build(),function(me){return me.withDisabled(!j)});var A={displayName:function(Ie){return Ie.get("None")},value:se.z1};if(v.type===se.d8||v.type===se.Ol){var E=[A],G=C.explorationNavigationService,X=G.getAllSections(),te=G.getCurrentSection();if(v.type===se.d8){var Y=_.map(X,function(me){return me.name}),ne=(0,p.ev)((0,p.ev)([],_.map(E,function(me){return me.value}),!0),_.filter(Y,function(me){return me!==te.name}),!0),Se=null!==(w=v.navigationSection)&&void 0!==w?w:A.value;D.addSimpleSlice("pageNavigationDestination",new S.uY({descriptor:(0,p.pi)((0,p.pi)({},s.navigationSection),{instanceKind:a.drillthroughButtonGA?3:1}),value:Se,filterValues:ne,mergeValues:E}).build())}else if(v.type===se.Ol){var Ue=_.filter(X,function(Ie){return m&&!_.isEmpty(m.getDrillthroughParameters(Ie.name))}),Ke=_.map(Ue,function(Ie){return Ie.name}),Ae=(ne=(0,p.ev)((0,p.ev)([],_.map(E,function(Ie){return Ie.value}),!0),_.filter(Ke,function(Ie){return Ie!==te.name}),!0),null!==(F=v.drillthroughSection)&&void 0!==F?F:A.value);D.addSimpleSlice("drillthroughDestination",new S.uY({descriptor:(0,p.pi)((0,p.pi)({},s.drillthroughSection),{instanceKind:a.drillthroughButtonGA?3:1}),value:Ae,filterValues:ne,mergeValues:E}).build())}}else D.addSimpleSlice("defaultDestination",new S.uY({descriptor:s.drillthroughSection,value:(0,p.pi)((0,p.pi)({},A),{displayName:C.localizationService.get("None")}),items:[A]}).build(),function(me){return me.withDisabled(!0)});D.addSimpleSlice("webUrl",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},s.webUrl),{instanceKind:3}),value:v.webUrl,placeholder:""}).build(),function(me){return me.withDisabled(v.type!==se.ZS)})}).addGroup("tooltip",function(D){var w;D.withDisplayName("Tooltip");var F=null===(w=v.showDefaultTooltip)||void 0===w||w,V=a.showDefaultTooltip?!F:!!v.suppressDefaultTooltip;a.suppressDefaultTooltip&&(a.showDefaultTooltip?D.addTopLevelToggle("showDefaultTooltip",function(){return new S.bd({descriptor:s.showDefaultTooltip,value:F}).build()}):D.addSimpleSlice("suppressDefaultTooltip",new S.bd({descriptor:s.suppressDefaultTooltip,value:!!v.suppressDefaultTooltip}).build())),v.type!==se.Ol?D.addSimpleSlice("text",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},s.tooltip),{instanceKind:3}),value:v.tooltip,placeholder:v.tooltipPlaceholderText}).build(),function(I){return I.withCustomDisplayName("Text").withDisabled(V)}):D.addSimpleSlice("enabledText",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},s.enabledTooltip),{instanceKind:a.drillthroughButtonGA?3:1}),value:v.enabledTooltip,placeholder:""}).build(),function(I){return I.withCustomDisplayName("Enabled_Text").withDisabled(V)}).addSimpleSlice("disabledText",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},s.disabledTooltip),{instanceKind:a.drillthroughButtonGA?3:1}),value:v.disabledTooltip,placeholder:""}).build(),function(I){return I.withCustomDisplayName("Disabled_Text").withDisabled(V)})}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:y.revertToDefaultDescriptors}]}})})},n.prototype.resolveTitleCardPlaceholder=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return(0,J.q4)(e)?[2]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=a.sent(),r=this.getCardBuildingOptions(e,t),T.fF.assert(function(){return!1===r.isQueryVisualWithoutData},"Expected query visual to have data"),[4,this.getTitleCard(r,t)];case 2:return[2,{item:i=a.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},n.prototype.resolveVisualSizeAndStyleCardPlaceholder=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i;return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=a.sent(),r=this.getCardBuildingOptions(e,t),[4,this.getVisualSizeAndStyleCard(r)];case 2:return[2,{item:i=a.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},n.prototype.resolveStylePresetSlicePlaceholder=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,i,a,s,l,c=this;return(0,p.Jh)(this,function(d){return(0,J.Vz)(e)&&(s=this.visualStylePresetService.getStylePreset((t=e.config.singleVisual).visualType,(a=(i=t.evaluatedObjects)&&i.stylePreset)&&a.name))?(l=se.fU.stylePreset,[2,{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("stylePreset"),"style"),"layout"),control:new S.uY({descriptor:l.name,value:s.name}).build(),localize:function(h){return c.localizationService.get(h)}}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:[l.name]}]):[2]})})},n.prototype.resolveActionCardPlaceholderDefault=function(e){var t,r,i=this;if(!e){var a={objectName:"defaultVisualLinkObject",propertyName:"defaultVisualLinkProperty"},o=((t={})[a.objectName]={properties:(r={},r[a.propertyName]={type:{bool:!0}},r)},t);return{item:new S.CQ(new S.lg("action"),"Visual_VisualLink",[a],function(s){return i.localizationService.get(s)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:a,value:!1}).build()}).withDisabled(!0,"Visual_VisualLink_DisabledReason").build(),objectDescriptors:o,revertToDefaultDescriptors:[a]}}},n.prototype.addAdvancedOptionsGroup=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,s,l,u,c,d,v,h,f,m;return(0,p.Jh)(this,function(g){switch(g.label){case 0:return a=e.evaluatedObjects,s=se.fU.general,(0,J.Vz)(i=e.container)?(u=(l=e).capabilities,c=a,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),v=d.schema(void 0).capabilities,h=i.config.singleVisual,(f=v.supportsBinnedLineSample)&&(f=function(n,e,t,r){if(!n?.query||!e||!e.dataViewMappings)return!1;var i=n.query,a=(0,W.i1)(i),o=(0,Rn.Lo)(i.projections,e.dataViewMappings,a,r,e.objects,n.objects,i.defn.select(),t);return _.some(o.supportedMappings,function(s){var l=!1;return(0,aa.oF)(s,{visitRole:function(c){},visitReduction:function(c){l=l||!!c.binnedLineSample}}),l})}(h,u,d,e.featureSwitches)),(m=v.supportsOverlappingPointsSample)&&(m=function(n){return!(!n||!n.dataViewMappings)&&_.some(n.dataViewMappings,function(e){var t=!1;return(0,aa.oF)(e,{visitRole:function(i){},visitReduction:function(i){t=t||!!i.overlappingPointsSample}}),t})}(u)),t.addGroup("advancedOptions",function(y){var C=c&&c.general;y.withDisplayName(r).addSlicePlaceholder((0,S.Q)("responsive")).addSimpleSlice("keepLayerOrder",new S.bd({descriptor:s.keepLayerOrder,value:!(!C||!C.keepLayerOrder)}).build()),f?y.addSimpleSlice("highDensitySampling",new S.bd({descriptor:s.allowBinnedLineSample,value:!(h.queryOptions&&!1===h.queryOptions.allowBinnedLineSample)}).build(),function(N){l.isQueryVisualWithoutData&&N.withDisabled(!0,"Add_Data_To_Format")}):m&&y.addSimpleSlice("overlappingPointSampling",new S.bd({descriptor:s.allowOverlappingPointsSample,value:!(!m||h.queryOptions&&!1===h.queryOptions.allowOverlappingPointsSample)}).build(),function(N){l.isQueryVisualWithoutData&&N.withDisabled(!0,"Add_Data_To_Format")}),l.isQueryVisualWithoutData||y.addSlicePlaceholder((0,S.Q)("dataVolume"))}),g.label=2;case 2:return[2]}})})},n.prototype.addSizeSlices=function(e,t,r,i){var o=t.evaluatedObjects,s=t.props,l=s.general,u={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("height",function(){return new S.mu({descriptor:l.height,value:u.height,options:{minValue:{type:0,value:ve.MinContainerHeight},maxValue:{type:1,value:r.height-u.y},required:{type:2}}}).build()}).addSimpleSlice("width",function(){return new S.mu({descriptor:l.width,value:u.width,options:{minValue:{type:0,value:ve.MinContainerWidth},maxValue:{type:1,value:r.width-u.x},required:{type:2}}}).build()}).addSimpleSlice("lockAspect",function(){var d=o&&o[s.lockAspect.show.objectName];return new S.bd({descriptor:s.lockAspect.show,value:!(!d||!d.show)}).build()},function(c){return c.withCustomDisplayName("VisualContainer_Properties_LockAspect")})},n.prototype.addPositionSlices=function(e,t,r,i){var s=t.props.general,l={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("horizontal",function(){return new S.mu({descriptor:s.x,value:l.x,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.width-l.width},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Horizontal")}).addSimpleSlice("vertical",function(){return new S.mu({descriptor:s.y,value:l.y,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.height-l.height},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Vertical")})},n.prototype.addPaddingSlice=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,s,l,u,c,d,v,h,f,m;return(0,p.Jh)(this,function(g){switch(g.label){case 0:return r=(m=t).evaluatedObjects,a=m.container,s=m.props.padding,u=(i=m.capabilities).suppressDefaultTitle,!1!==(l=r?.title||{}).show||null==l.text?(c=a.config.singleVisual,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),l=this.displayNameService.getVisualTitle(c,d,i,l),g.label=2;case 2:return v=!!l.text&&(l.show||!(0,Nt.xj)(l,u)),h=(0,W.hp)(r?.padding,i,v),f={minValue:{type:0,value:0},maxValue:{type:1,value:20},unitSymbol:Be.e_},e.addCompositeSlice("padding","Visual_Padding",(new S.uM).withTop({descriptor:s.top,value:h.top,options:f}).withBottom({descriptor:s.bottom,value:h.bottom,options:f}).withLeft({descriptor:s.left,value:h.left,options:f}).withRight({descriptor:s.right,value:h.right,options:f}).build(),function(y){return y.withSuppressDisplayName(!0)}),[2]}})})},n.prototype.addGeneralSizeGroups=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,c,d,h,f=this;return(0,p.Jh)(this,function(m){return r=e.container,i=e.featureSwitches,a=this.formFactorService.getCurrentLayout(),o=r.layouts.withId(a).position,s=(0,W.hP)(o,a,r.parentGroup),l={x:Math.floor(s.x),y:Math.floor(s.y),width:Math.floor(s.width),height:Math.floor(s.height)},1===this.formFactorService.getCurrentLayout()?c={height:xr.aW,width:xr.Co}:(d=this.explorationNavigationService.getCurrentSection(),c=d.size),e.featureSwitches.onObject?t.addGroup("sizeAndPosition",function(g){g.withDisplayName("Visual_Size_And_Position"),f.addSizeSlices(g,e,c,l),f.addPositionSlices(g,e,c,l)}):t.addGroup("size",function(g){g.withDisplayName("Visual_BubbleSize"),f.addSizeSlices(g,e,c,l)}).addGroup("position",function(g){g.withDisplayName("Visual_Position"),f.addPositionSlices(g,e,c,l)}),i.vcPadding&&(0,J.Vz)(r)&&(h=e.isQueryVisualWithoutData,t.addGroup("padding",function(g){return(0,p.mG)(f,void 0,void 0,function(){return(0,p.Jh)(this,function(y){switch(y.label){case 0:return g.withDisplayName("Visual_Padding"),h?[3,2]:[4,this.addPaddingSlice(g,e)];case 1:return y.sent(),[3,3];case 2:g.withDisabled(!0,"Add_Data_To_Format"),y.label=3;case 3:return[2]}})})})),[2]})})},n.prototype.addGeneralStyleGroups=function(e,t){var r,i=this,a=e.allowConditionalFormatting,o=e.container,s=e.evaluatedObjects,u=e.props.background,c=se.fU.border,d=se.fU.dropShadow,v=function(y){return i.localizationService.get(y)};if(t.addGroup("background",function(g){var y=s&&s[u.show.objectName];g.withDisplayName("Visual_Background"),(0,J.Vz)(o)&&e.isQueryVisualWithoutData?g.withDisabled(!0,"Add_Data_To_Format"):g.addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:y&&null!=y.show?y.show:(0,bi.kB)()}).build()}).addSimpleSlice("color",function(){var D,F={value:null===(D=(y&&null!=y.color?y.color:(0,bi.WO)()).solid)||void 0===D?void 0:D.color};return new S.BT({descriptor:(0,p.pi)((0,p.pi)({},u.color),{instanceKind:a&&3}),value:F}).build()}).addSimpleSlice("transparency",function(){var D=y&&null!=y.transparency?y.transparency:(0,bi.x6)();return S.JN.getTransparencySliderBuilder({descriptor:u.transparency,value:D,localize:v}).build()})}),(0,J.Vz)(o)){var h=(r=e).evaluatedObjects,f=r.visualStyle,m=r.isQueryVisualWithoutData;t.addGroup("visualBorder",function(g){var y,C,N=h&&h.border||{},D=(0,wa.O4)();g.withDisplayName("VisualBorder"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var w;return new S.bd({descriptor:c.show,value:null!==(w=N.show)&&void 0!==w?w:D.show}).build()}).addSimpleSlice("color",function(){var w,F=null!==(w=N.color)&&void 0!==w?w:D.color,V=F&&F.solid&&F.solid.color;return new S.BT({descriptor:(0,p.pi)((0,p.pi)({},c.color),{instanceKind:a&&3}),value:void 0!==V?{value:V}:void 0}).build()}).addSimpleSlice("roundedCorners",new S.JN({descriptor:c.radius,value:null!==(y=N.radius)&&void 0!==y?y:D.radius,options:{minValue:{type:0,value:0},maxValue:{type:1,value:30},unitSymbol:Be.e_},localize:v}).build(),function(w){return w.withCustomDisplayName("VisualContainer_Border_RoundedCorners")}),i.featureSwitchService.featureSwitches.visualBorderWidth&&g.addSimpleSlice("width",new S.mu({descriptor:c.width,value:null!==(C=N.width)&&void 0!==C?C:wa.GC,options:{minValue:{type:0,value:1},maxValue:{type:1,value:99},unitSymbol:Be.e_}}).build(),function(w){return w.withCustomDisplayName("Visual_General_Properties_Width")}))}).addGroup("shadow",function(g){var y,C,N,D,w,F,V,I,j=h&&h.dropShadow||{},L=(0,ia.O4)(j,f);g.withDisplayName("Visual_DropShadow"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var z;return new S.bd({descriptor:d.show,value:null!==(z=j.show)&&void 0!==z?z:L.show}).build()}).addSimpleSlice("color",function(){var z,P=null!==(z=j.color)&&void 0!==z?z:L.color,A=P&&P.solid&&P.solid.color;return new S.BT({descriptor:(0,p.pi)((0,p.pi)({},d.color),{instanceKind:a&&3}),value:void 0!==A?{value:A}:void 0}).build()}).addSimpleSlice("offset",new S.uY({descriptor:d.position,value:null!==(y=j.position)&&void 0!==y?y:L.position}).build(),function(z){return z.withCustomDisplayName("Offset")}).addSimpleSlice("position",new S.uY({descriptor:d.preset,value:null!==(C=j.preset)&&void 0!==C?C:L.preset}).build(),function(z){return z.withCustomDisplayName("Visual_Position")}),(null!==(N=j.preset)&&void 0!==N?N:L.preset)===se.$g&&g.addSimpleSlice("size",new S.JN({descriptor:d.shadowSpread,value:null!==(D=j.shadowSpread)&&void 0!==D?D:L.shadowSpread,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Be.e_},localize:v}).build()).addSimpleSlice("blur",new S.JN({descriptor:d.shadowBlur,value:null!==(w=j.shadowBlur)&&void 0!==w?w:L.shadowBlur,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Be.e_},localize:v}).build()).addSimpleSlice("angle",S.JN.getRotationSliderBuilder({descriptor:d.angle,value:null!==(F=j.angle)&&void 0!==F?F:L.angle,localize:v}).build()).addSimpleSlice("distance",new S.JN({descriptor:d.shadowDistance,value:null!==(V=j.shadowDistance)&&void 0!==V?V:L.shadowDistance,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Be.e_},localize:v}).build()).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:d.transparency,value:null!==(I=j.transparency)&&void 0!==I?I:L.transparency,localize:v}).build()))})}},n.prototype.getPropertiesCard=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u=this;return(0,p.Jh)(this,function(c){switch(c.label){case 0:return s=[(r=(t=e.props).general).height,r.width,t.lockAspect.show,r.x,r.y,(o=(i=se.fU).padding).top,o.bottom,o.left,o.right,(a=i.general).keepLayerOrder,a.allowBinnedLineSample,a.allowOverlappingPointsSample],l=new S.CQ(new S.lg("properties"),"Properties",s,function(d){return u.localizationService.get(d)}),[4,this.addGeneralSizeGroups(e,l)];case 1:return c.sent(),[4,this.addAdvancedOptionsGroup(e,l,"AdvancedOptions")];case 2:return c.sent(),[2,l.build()]}})})},n.prototype.getAdvancedOptionsCard=function(e){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o=this;return(0,p.Jh)(this,function(s){switch(s.label){case 0:return i=[(r=se.fU.general).keepLayerOrder,r.allowBinnedLineSample,r.allowOverlappingPointsSample],a=new S.CQ(new S.lg("advancedOptions"),"AdvancedOptions",i,function(l){return o.localizationService.get(l)}),[4,this.addAdvancedOptionsGroup(e,a)];case 1:return s.sent(),[2,a.build()]}})})},n.prototype.getTitleCard=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,w,F,V,I=this;return(0,p.Jh)(this,function(j){switch(j.label){case 0:return r=e.allowConditionalFormatting,(0,J.q4)(i=e.container)||(a=e).isQueryVisualWithoutData?[2]:(u=a.visualStyle,c=(o=a.props).title,d=o.divider,v=o.subTitle,h=o.spacing,f=(l=a.evaluatedObjects)&&l.title||{},m=l&&l.subTitle||{},g=i.config.singleVisual,y=(s=a.capabilities).suppressDefaultTitle,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]);case 1:return C=j.sent(),null==f.text&&(f=this.displayNameService.getVisualTitle(g,C,s,f)),t.vcPadding&&null==m.text&&(m=this.displayNameService.getVisualSubTitle(g,C,s,m))&&f?.isGeneratedText&&m?.isGeneratedText&&(f.text=f.titleComponents.title,m.text=m.titleComponents.subtitle),N=ke.v.create(u),D=(0,Da.Zi)(f,{size:"fontSize",family:"fontFamily",color:"fontColor"},N,u,void 0,W.Hf,W.o8),w=(new S.UN).withFontFamily({descriptor:c.fontFamily,value:D.family}).withFontSizeProperties({descriptor:c.fontSize,value:D.size.pt}).withBold({descriptor:c.bold,value:f.bold||!1}).withItalic({descriptor:c.italic,value:f.italic||!1}).withUnderline({descriptor:c.underline,value:f.underline||!1}),F=w.build(),(V=new S.CQ(new S.lg("title"),"Title",[c.show,c.text,c.heading,c.fontFamily,c.fontSize,c.bold,c.italic,c.underline,c.fontColor,c.background,c.alignment,c.titleWrap,v.show,v.text,v.heading,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,v.fontColor,v.alignment,v.titleWrap,d.show,d.ignorePadding,d.color,d.width,d.style,h.customizeSpacing,h.spaceBelowSubTitle,h.spaceBelowTitle,h.spaceBelowTitleArea,h.verticalSpacing],function(L){return I.localizationService.get(L)})).withDescription("Visual_TitleDescription").addTopLevelToggle("show",function(){return new S.bd({descriptor:c.show,value:f.show||!(0,Nt.xj)(f,y)}).build()},function(L){return L.withNoDefaultImpact(y)}),V.addGroup("text",function(L){t.vcPadding&&L.withDisplayName("Title"),L.addSimpleSlice("text",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},c.text),{instanceKind:r&&3}),placeholder:"",value:f.text||""}).build(),function(x){return x.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:c.heading,value:f.heading||W.PY}).build(),function(x){return x.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",F).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.pi)((0,p.pi)({},c.fontColor),{instanceKind:r&&3}),value:{value:D.color}}).build(),function(x){return x.withCustomDisplayName("Text_Color")}).addSimpleSlice("backgroundColor",function(){var x,z,P=null===(z=null===(x=f.background)||void 0===x?void 0:x.solid)||void 0===z?void 0:z.color;return new S.BT({descriptor:(0,p.pi)((0,p.pi)({},c.background),{instanceKind:r&&3}),value:{value:P},isNoFillItemSupported:!0}).build()},function(x){return x.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:c.alignment,value:f.alignment||Fa.D.left,mode:"horizontalAlignment"}).build(),function(x){return x.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:c.titleWrap,value:!!f.titleWrap}).build(),function(x){return x.withCustomDisplayName("TextWrap")})}),t.vcPadding?[4,this.getSubTitleGroup(e,t,V,m)]:[3,3];case 2:j.sent(),this.getDividerGroup(e,V),this.getSpacingGroup(e,V),j.label=3;case 3:return[2,V.build()]}})})},n.prototype.getSubTitleGroup=function(e,t,r,i){var a;return(0,p.mG)(this,void 0,void 0,function(){var o,s,l,c,d,v,h,f,m,g,y,C,N;return(0,p.Jh)(this,function(D){switch(D.label){case 0:return o=e.allowConditionalFormatting,(0,J.q4)(s=e.container)?[2]:(c=(l=e).capabilities,d=l.evaluatedObjects,v=l.visualStyle,h=l.props.subTitle,i?[3,2]:(f=s.config.singleVisual,null!=(i=d&&d.subTitle||{}).text?[3,2]:[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]));case 1:m=D.sent(),(i=this.displayNameService.getVisualTitle(f,m,c,i))&&(i.text=null===(a=i?.titleComponents)||void 0===a?void 0:a.subtitle),D.label=2;case 2:return g=ke.v.create(v),y=(0,Da.Zi)(i,{size:"fontSize",family:"fontFamily",color:"fontColor"},g,v,W.uz,W.Zq,W.o8),C=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:y.family}).withFontSizeProperties({descriptor:h.fontSize,value:y.size.pt}).withBold({descriptor:h.bold,value:i.bold||!1}).withItalic({descriptor:h.italic,value:i.italic||!1}).withUnderline({descriptor:h.underline,value:i.underline||!1}),N=C.build(),r.addGroup("subtitle",function(w){w.withDisplayName("Visual_SubTitle").addTopLevelToggle("show",function(){return new S.bd({descriptor:h.show,value:i.show||!1}).build()}).addSimpleSlice("text",new S.fq({descriptor:(0,p.pi)((0,p.pi)({},h.text),{instanceKind:o&&3}),placeholder:"",value:i.text||""}).build(),function(F){return F.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:h.heading,value:i.heading||W.AS}).build(),function(F){return F.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",N).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.pi)((0,p.pi)({},h.fontColor),{instanceKind:o&&3}),value:{value:y.color}}).build(),function(F){return F.withCustomDisplayName("Text_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:h.alignment,value:i.alignment||Fa.D.left,mode:"horizontalAlignment"}).build(),function(F){return F.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:h.titleWrap,value:!!i.titleWrap}).build(),function(F){return F.withCustomDisplayName("TextWrap")})}),[2]}})})},n.prototype.getDividerGroup=function(e,t){var r,i=(r=e).allowConditionalFormatting,a=r.visualStyle,l=e.evaluatedObjects,u=e.props.divider,c=l&&l.divider||{};t.addGroup("divider",function(d){d.withDisplayName("Visual_Divider").addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:c.show||!1}).build()}).addSimpleSlice("color",function(){var v,h=void 0!==c.color?{value:null===(v=c.color.solid)||void 0===v?void 0:v.color}:{value:a.colorPalette.foregroundNeutralSecondary.value};return new S.BT({descriptor:(0,p.pi)((0,p.pi)({},u.color),{instanceKind:i&&3}),value:h}).build()}).addSimpleSlice("style",new S.uY({descriptor:u.style,value:c.style||Eo.Dv.solid}).build()).addSimpleSlice("width",function(){return new S.mu({descriptor:u.width,value:c.width||1,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10},required:{type:2},unitSymbol:Be.e_}}).build()}).addSimpleSlice("ignorePadding",new S.bd({descriptor:u.ignorePadding,value:!1!==c.ignorePadding}).build())})},n.prototype.getSpacingGroup=function(e,t){var a=e.evaluatedObjects,o=e.props.spacing,s=a&&a.subTitle||{},l=a&&a.divider||{},u=a&&a.spacing||{},h={minValue:{type:0,value:0},maxValue:{type:1,value:10},required:{type:2},unitSymbol:Be.e_};t.addGroup("spacing",function(f){f.withDisplayName("Visual_Spacing").addSimpleSlice("customizeSpacing",function(){var m;return new S.bd({descriptor:o.customizeSpacing,value:null!==(m=u.customizeSpacing)&&void 0!==m&&m}).build()}),u.customizeSpacing?(f.addSimpleSlice("spaceBelowTitle",function(){return new S.mu({descriptor:o.spaceBelowTitle,value:(0,W.h4)(W.hs.Title,u),options:h}).build()}),s.show&&f.addSimpleSlice("spaceBelowSubTitle",function(){return new S.mu({descriptor:o.spaceBelowSubTitle,value:(0,W.h4)(W.hs.SubTitle,u),options:h}).build()}),l.show&&f.addSimpleSlice("spaceBelowTitleArea",function(){return new S.mu({descriptor:o.spaceBelowTitleArea,value:(0,W.h4)(W.hs.Divider,u),options:h}).build()})):f.addSimpleSlice("verticalSpacing",function(){var m;return new S.mu({descriptor:o.verticalSpacing,value:null!==(m=u.verticalSpacing)&&void 0!==m?m:5,options:h}).build()})})},n.prototype.getVisualSizeAndStyleCard=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u,c=this;return(0,p.Jh)(this,function(d){switch(d.label){case 0:return r=(t=e.props).general,i=t.background,a=se.fU.padding,o=se.fU.border,s=se.fU.dropShadow,l=function(h){return c.localizationService.get(h)},u=new S.CQ(new S.lg("sizeAndStyle"),"Visual_Size_And_Style",[r.height,r.width,t.lockAspect.show,r.x,r.y,a.top,a.bottom,a.left,a.right,i.show,i.color,i.transparency,o.show,o.color,o.radius,o.width,s.show,s.color,s.transparency,s.position,s.preset,s.shadowSpread,s.shadowBlur,s.angle,s.shadowDistance],l),[4,this.addGeneralSizeGroups(e,u)];case 1:return d.sent(),this.addGeneralStyleGroups(e,u),[2,u.build()]}})})},n.prototype.getEffectsCard=function(e){var t=this,r=e.props.background,i=se.fU.border,a=se.fU.dropShadow,s=new S.CQ(new S.lg("effects"),"VisualFormatting_Effects",[r.show,r.color,r.transparency,i.show,i.color,i.radius,i.width,a.show,a.color,a.transparency,a.position,a.preset,a.shadowSpread,a.shadowBlur,a.angle,a.shadowDistance],function(u){return t.localizationService.get(u)});return this.addGeneralStyleGroups(e,s),s.build()},n.prototype.getHeaderIconsCard=function(e){var r,i,t=this,o=e.evaluatedObjects,s=e.exploration,l=e.explorationCapabilities,u=e.featureSwitches;if(!(0,J.q4)(e.container)){var c=e,d=c.props,v=d.visualHeader,h=d.visualHeaderTooltip,f=o,m=f&&f.visualHeader||{},y=l.visualContainerOptions.useStylableHeader,C=s.settings,N=null!==(r=C?.useEnhancedTooltips)&&void 0!==r?r:u?.forceEnhancedTooltips,D=function(j){return t.localizationService.get(j)},w=new S.CQ(new S.lg("headerIcons"),"VisualContainer_HeaderIcons",[v.show,v.background,v.border,v.foreground,v.transparency,v.showVisualInformationButton,v.showVisualWarningButton,v.showVisualErrorButton,v.showDrillRoleSelector,v.showDrillUpButton,v.showDrillToggleButton,v.showDrillDownLevelButton,v.showDrillDownExpandButton,v.showPinButton,v.showFocusModeButton,v.showSeeDataLayoutToggleButton,v.showOptionsMenu,v.showFilterRestatementButton,v.showTooltipButton,v.showCommentButton,v.showPersonalizeVisualButton,v.showCopyVisualImageButton,v.showSmartNarrativeButton,v.showSetAlertButton,v.showFollowVisualButton,h.type,h.section,h.text,h.fontFamily,h.fontSize,h.bold,h.italic,h.underline,N?h.themedTitleFontColor:h.titleFontColor,N?h.themedBackground:h.background,h.transparency],D),F={show:!0,background:{solid:{color:"#FFF"}},border:{solid:{color:"#FFF"}},transparency:0,foreground:{solid:{color:"#333"}},showVisualInformationButton:!0,showVisualWarningButton:!0,showVisualErrorButton:!0,showDrillRoleSelector:!0,showDrillUpButton:!0,showDrillToggleButton:!0,showDrillDownLevelButton:!0,showDrillDownExpandButton:!0,showPinButton:!0,showFocusModeButton:!0,showSeeDataLayoutToggleButton:!0,showOptionsMenu:!0,showTooltipButton:!1,showFilterRestatementButton:!0,showCommentButton:!0,showPersonalizeVisualButton:!0,showCopyVisualImageButton:!0,showSmartNarrativeButton:!1,showSetAlertButton:!0,showFollowVisualButton:!1};if(w.withDescription("VisualHeader_Toggle_Description").addTopLevelToggle("show",function(){var I;return new S.bd({descriptor:v.show,value:null!==(I=m.show)&&void 0!==I?I:F.show}).build()}),y){var V=null!==(i=m.showTooltipButton)&&void 0!==i?i:F.showTooltipButton;w.addGroup("colors",function(I){var j,L,x=null!==(j=m.background)&&void 0!==j?j:F.background;I.withDisplayName("Visual_Colors").addSimpleSlice("background",function(){var z,A={value:null===(z=x.solid)||void 0===z?void 0:z.color};return new S.BT({descriptor:v.background,value:A}).build()},function(z){return z.withCustomDisplayName("Visual_Background")}).addSimpleSlice("border",function(){var z,P,A=m.border;void 0===A&&(A=m.background),void 0===A&&(A=F.border);var G={value:null===(P=(null!==(z=m.border)&&void 0!==z?z:F.border).solid)||void 0===P?void 0:P.color};return new S.BT({descriptor:v.border,value:G}).build()}).addSimpleSlice("icon",function(){var z,P,E={value:null===(P=(null!==(z=m.foreground)&&void 0!==z?z:F.foreground).solid)||void 0===P?void 0:P.color};return new S.BT({descriptor:v.foreground,value:E}).build()},function(z){return z.withCustomDisplayName("Icon")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:null!==(L=m.transparency)&&void 0!==L?L:F.transparency,localize:D}).build()).build()}).addGroup("icons",function(I){var j,L,x,z,P,A,E,G,X,te,Y,ne,Se,Ue,Ke,Ae,me,Ie,mt,pt;I.withDisplayName("Visual_Tablix_Icons").addSimpleSlice("showVisualInformationButton",new S.bd({descriptor:v.showVisualInformationButton,value:null!==(L=m.showVisualInformationButton)&&void 0!==L?L:F.showVisualInformationButton}).build(),function(Pe){return Pe.withCustomDisplayName("VisualHeader_ShowVisualInformationButtonLabel")}).addSimpleSlice("showVisualWarningButton",new S.bd({descriptor:v.showVisualWarningButton,value:null!==(x=m.showVisualWarningButton)&&void 0!==x?x:F.showVisualWarningButton}).build(),function(Pe){return Pe.withCustomDisplayName("VisualHeader_ShowVisualWarningButtonLabel")}).addSimpleSlice("showVisualErrorButton",new S.bd({descriptor:v.showVisualErrorButton,value:null!==(z=m.showVisualErrorButton)&&void 0!==z?z:F.showVisualErrorButton}).build(),function(Pe){return Pe.withCustomDisplayName("VisualHeader_ShowVisualErrorButtonLabel")}).addSimpleSlice("showDrillRoleSelector",new S.bd({descriptor:v.showDrillRoleSelector,value:null!==(P=m.showDrillRoleSelector)&&void 0!==P?P:F.showDrillRoleSelector}).build()).addSimpleSlice("showDrillUpButton",new S.bd({descriptor:v.showDrillUpButton,value:null!==(A=m.showDrillUpButton)&&void 0!==A?A:F.showDrillUpButton}).build(),function(Pe){return Pe.withCustomDisplayName("DrillUp")}).addSimpleSlice("showDrillToggleButton",new S.bd({descriptor:v.showDrillToggleButton,value:null!==(E=m.showDrillToggleButton)&&void 0!==E?E:F.showDrillToggleButton}).build(),function(Pe){return Pe.withCustomDisplayName("DrillDown")}).addSimpleSlice("showDrillDownLevelButton",new S.bd({descriptor:v.showDrillDownLevelButton,value:null!==(G=m.showDrillDownLevelButton)&&void 0!==G?G:F.showDrillDownLevelButton}).build(),function(Pe){return Pe.withCustomDisplayName("DrillDownLevel")}).addSimpleSlice("showDrillDownExpandButton",new S.bd({descriptor:v.showDrillDownExpandButton,value:null!==(X=m.showDrillDownExpandButton)&&void 0!==X?X:F.showDrillDownExpandButton}).build(),function(Pe){return Pe.withCustomDisplayName("DrillDownLevelGrouped")}).addSimpleSlice("showPinButton",new S.bd({descriptor:v.showPinButton,value:null!==(te=m.showPinButton)&&void 0!==te?te:F.showPinButton}).build(),function(Pe){return Pe.withCustomDisplayName("ReportContainer_Pin")}).addSimpleSlice("showFocusModeButton",new S.bd({descriptor:v.showFocusModeButton,value:null!==(Y=m.showFocusModeButton)&&void 0!==Y?Y:F.showFocusModeButton}).build(),function(Pe){return Pe.withCustomDisplayName("FocusModeVisual_ToolTip")}).addSimpleSlice("showSeeDataLayoutToggleButton",new S.bd({descriptor:v.showSeeDataLayoutToggleButton,value:null!==(ne=m.showSeeDataLayoutToggleButton)&&void 0!==ne?ne:F.showSeeDataLayoutToggleButton}).build(),function(Pe){return Pe.withCustomDisplayName("VisualHeader_ShowSeeDataLayoutToggleButtonLabel")}).addSimpleSlice("showOptionsMenu",new S.bd({descriptor:v.showOptionsMenu,value:null!==(Se=m.showOptionsMenu)&&void 0!==Se?Se:F.showOptionsMenu}).build(),function(Pe){return Pe.withCustomDisplayName("Options_Menu")}).addSimpleSlice("showFilterRestatementButton",new S.bd({descriptor:v.showFilterRestatementButton,value:null!==(Ue=m.showFilterRestatementButton)&&void 0!==Ue?Ue:F.showFilterRestatementButton}).build(),function(Pe){return Pe.withCustomDisplayName("Filter")}).addSimpleSlice("showTooltipButton",new S.bd({descriptor:v.showTooltipButton,value:V}).build(),function(Pe){return Pe.withCustomDisplayName("VisualContainer_HelpTooltip")}),l.annotationsEnabled&&I.addSimpleSlice("showCommentButton",new S.bd({descriptor:v.showCommentButton,value:null!==(Ke=m.showCommentButton)&&void 0!==Ke?Ke:F.showCommentButton}).build());var gt=(j=c.visualKind).isQueryVisual,kr=function(n,e,t,r){return!!(n&&e&&t&&t.settings)&&!e.disableInlineExplore&&t.settings.allowInlineExploration&&r}(u,l,s,gt||j.isQnaVisual);kr&&I.addSimpleSlice("showPersonalizeVisualButton",new S.bd({descriptor:v.showPersonalizeVisualButton,value:null!==(Ae=m.showPersonalizeVisualButton)&&void 0!==Ae?Ae:F.showPersonalizeVisualButton}).build()),u.copyVisualImage&&u.exportVisualImageTenantEnabled&&I.addSimpleSlice("showCopyVisualImageButton",new S.bd({descriptor:v.showCopyVisualImageButton,value:null!==(me=m.showCopyVisualImageButton)&&void 0!==me?me:F.showCopyVisualImageButton}).build()),u.smartNarrativeVisualContainterButton&&I.addSimpleSlice("showSmartNarrativeButton",new S.bd({descriptor:v.showSmartNarrativeButton,value:null!==(Ie=m.showSmartNarrativeButton)&&void 0!==Ie?Ie:F.showSmartNarrativeButton}).build()),u.reflexPBIVisualToolbarEntry&&I.addSimpleSlice("showSetAlertButton",new S.bd({descriptor:v.showSetAlertButton,value:null!==(mt=m.showSetAlertButton)&&void 0!==mt?mt:F.showSetAlertButton}).build()),u.reflexPBIFollowVisual&&I.addSimpleSlice("showFollowVisualButton",new S.bd({descriptor:v.showFollowVisualButton,value:null!==(pt=m.showFollowVisualButton)&&void 0!==pt?pt:F.showFollowVisualButton}).build())}),V&&w.addGroup("helpTooltip",function(I){var j=(0,p.pi)({type:qa.xv,show:!0,text:void 0,section:se.F},f&&f.visualHeaderTooltip||{}),L=c.visualStyle,x=t.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,z=(0,Ca.UM)(L,N,x,j);I.withDisplayName("VisualContainer_HelpTooltip");var P=z.titleFontProperties,A=[{displayName:function(ne){return ne.get("None")},value:se.F}],E=ga(t.explorationNavigationService)||[],G=(0,p.ev)((0,p.ev)([],E,!0),_.map(A,function(Y){return Y.value}),!0),X=0===E.length;I.addSimpleSlice("type",new S.uY({descriptor:h.type,value:j.type}).build()).addSimpleSlice("section",new S.uY({descriptor:h.section,value:j.section,mergeValues:A,filterValues:G}).build(),function(Y){return Y.withDisabled(X||j.type!==qa.Xz)});var te=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:P.family}).withFontSizeProperties({descriptor:h.fontSize,value:P.size.pt}).withBold({descriptor:h.bold,value:P.weight===vr.en}).withItalic({descriptor:h.italic,value:P.style===vr.BF}).withUnderline({descriptor:h.underline,value:P.textDecoration===vr.f0});I.addSimpleSlice("tooltipText",new S.Jr({descriptor:h.text,placeholder:"VisualContainer_HelpTooltip_TextPlaceholder",value:j.text,localize:function(ne){return t.localizationService.get(ne)}}).build()).addCompositeSlice("font","Font",te.build()).addSimpleSlice("textColor",function(){return new S.BT({descriptor:N?h.themedTitleFontColor:h.titleFontColor,value:{value:P.color}}).build()}).addSimpleSlice("background",function(){var ne=z.background;return new S.BT({descriptor:N?h.themedBackground:h.background,value:{value:ne&&ne.solid&&ne.solid.color},isNoFillItemSupported:!0}).build()},function(Y){return Y.withCustomDisplayName("Background_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:h.transparency,value:z.transparency,localize:D}).build())})}return w.build()}},n.prototype.getTooltipsCard=function(e){var r,t=this,a=e.evaluatedObjects,o=e.exploration,s=e.featureSwitches;if(!(0,J.q4)(e.container)){var l=e;if(!l.isQueryVisualWithoutData){var c=l.capabilities.tooltips;if(c){var N,v=l.props.visualTooltip,f=a&&a.visualTooltip,m=o.settings,g=null!==(r=m?.useEnhancedTooltips)&&void 0!==r?r:s?.forceEnhancedTooltips,y=function(A){return t.localizationService.get(A)},C=new S.CQ(new S.lg("tooltips"),"Role_DisplayName_Tooltips",[v.show,v.type,v.section,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,g?v.themedTitleFontColor:v.titleFontColor,g?v.themedValueFontColor:v.valueFontColor,v.actionFontColor,g?v.themedBackground:v.background,v.transparency],y);N=f&&void 0!==f.show?!!f.show:void 0===c.showByDefault||!!c.showByDefault,C.addTopLevelToggle("show",function(){return new S.bd({descriptor:v.show,value:N}).build()});var D=c.supportedTypes;if(null!=D){var w=l.visualStyle,F=this.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,V=(0,Ca.UM)(w,g,F,f),I=V.titleFontProperties,j=V.valueFontProperties,L=V.actionFontProperties;C.addGroup("options",function(P){var A,G=(A=function(n,e,t,r){var a,i=[];for(var o in n)if(n[o]){var l=e[o];i.push(l),l===t&&(a=l)}return T.fF.assert(function(){return!_.isEmpty(i)},"No valid values were found"),void 0===a&&(a=r,T.fF.assert(function(){return _.some(i,function(u){return u===r})},"Default value is not supported")),{selectedValue:a,validValues:i}}(D,{default:Nt.gA,canvas:Nt.Xz},f&&f.type,D.canvas?Nt.Xz:Nt.gA),A.selectedValue),X=A.validValues,te=[{displayName:function(Ue){return Ue.get("Visual_Auto")},value:Nt.pJ}],Y=(0,p.ev)((0,p.ev)([],ga(t.explorationNavigationService)||[],!0),_.map(te,function(Se){return Se.value}),!0),ne=f&&f.section||Nt.pJ;P.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("type",new S.uY({descriptor:v.type,value:G,filterValues:X}).build()).addSimpleSlice("section",new S.uY({descriptor:v.section,value:ne,mergeValues:te,filterValues:Y}).build(),function(Se){return Se.withDisabled(G!==Nt.Xz)})});var z=(new S.UN).withFontFamily({descriptor:v.fontFamily,value:I.family}).withFontSizeProperties({descriptor:v.fontSize,value:I.size.pt}).withBold({descriptor:v.bold,value:I.weight===vr.en}).withItalic({descriptor:v.italic,value:I.style===vr.BF}).withUnderline({descriptor:v.underline,value:I.textDecoration===vr.f0}).build();return s.defaultTooltipFormatting&&C.addGroup("text",function(P){P.withDisplayName("Text").addCompositeSlice("font","Font",z).addSimpleSlice("labelColor",function(){return new S.BT({descriptor:g?v.themedTitleFontColor:v.titleFontColor,value:{value:I.color}}).build()},function(A){return A.withCustomDisplayName("Role_DisplayName_LabelColor")}).addSimpleSlice("valueColor",function(){return new S.BT({descriptor:g?v.themedValueFontColor:v.valueFontColor,value:{value:j.color}}).build()},function(A){return A.withCustomDisplayName("Value_Color")}),g&&P.addSimpleSlice("drillTextAndIconColor",new S.BT({descriptor:v.actionFontColor,value:{value:L.color}}).build(),function(A){return A.withCustomDisplayName("Visual_Action_FontColor")})}).addGroup("background",function(P){P.withDisplayName("Visual_Background").addSimpleSlice("color",function(){var E=V.background;return new S.BT({descriptor:g?v.themedBackground:v.background,value:{value:E&&E.solid&&E.solid.color},isNoFillItemSupported:!0}).build()},function(A){return A.withCustomDisplayName("Generic_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:V.transparency,localize:y}).build())}),C.build()}}}}},n.prototype.getAltTextCard=function(e){var t=this,r=e.allowConditionalFormatting,i=e.evaluatedObjects,o=e.props.general,s=new S.CQ(new S.lg("altText"),"Visual_General_Properties_Description",[o.altText],function(l){return t.localizationService.get(l)});return s.addGroup(void 0,function(l){l.addSimpleSlice("altText",function(){var u=i&&i[o.altText.objectName],c=u&&u.altText||"";return new S.Jr({descriptor:(0,p.pi)((0,p.pi)({},o.altText),{instanceKind:r&&3}),value:c,placeholder:"Visual_General_Properties_Description_Placeholder",localize:function(v){return t.localizationService.get(v)}}).build()})}),s.build()},n.prototype.getVisualLevelFormattingCard=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r;return(0,p.Jh)(this,function(a){return(0,J.q4)(t=e.container)||!(r=e).visualKind.isQueryVisual||r.isQueryVisualWithoutData?[2]:[2,this.visualLevelFormatStringHelperService.getVisualLevelFormatStringCard(t,r.capabilities)]})})},n.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,J.Vz)(e)){var a=e.config.singleVisual;r=a.visualType,i=a.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(ni.F),q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(Ir.O),q.\u0275\u0275inject(qi.U),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(wr),q.\u0275\u0275inject(oi.F),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(br.f),q.\u0275\u0275inject(Go.kc),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(Mr.f),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(Cr.A),q.\u0275\u0275inject(va),q.\u0275\u0275inject(ri.h,8))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Er=b(30794),pe=b(14172),ir=b(61617),dr=b(89535),Uo=b(2863),ko=b(21302),Ro=b(78778),Ta=b(29804),Va=b(22921),Gr=[{objectName:se.fU.stylePreset.name.objectName,descriptor:se.XW.stylePreset}],Ia=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m){this.analyticsFormattingService=e,this.dataSources=t,this.explorationNavigation=r,this.featureSwitchService=i,this.formattingSliceTransformerService=a,this.formFactor=o,this.legacyVisualFormattingService=s,this.localizationService=l,this.modernDialogService=u,this.runningVisualService=c,this.selectionService=d,this.visualAuthoring=v,this.visualPluginOperationsService=h,this.visualPluginService=f,this.formattingObjectDefinitionsService=m}return n.prototype.getFormattingModel=function(e){var t;return(0,p.mG)(this,void 0,void 0,function(){var r,i,a;return(0,p.Jh)(this,function(s){switch(s.label){case 0:return(0,J.q4)(e)?(i={cards:[]},this.featureSwitchService.featureSwitches.onObject&&(r=this.getVisualSizeAndStylePlaceholder(),i.cards.push(r)),[2,i]):[3,1];case 1:return[4,this.getVisualFormatPaneViewModel(e)];case 2:return i=s.sent(),!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting()?[2,i]:[3,3];case 3:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 4:return a=s.sent(),[2,(0,p.pi)((0,p.pi)({},i),{cards:(0,p.ev)((0,p.ev)([],i.cards,!0),null!==(t=a?.cards)&&void 0!==t?t:[],!0)})]}})})},n.prototype.getPivotDisplayName=function(e){return ae.um(e,this.featureSwitchService)},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:this.getPivotDisplayName(e)}},n.prototype.saveProperties=function(e,t,r,i){if((0,J.q4)(r))T.fF.assertFail("Visual pivot does not support VisualContainerGroup");else{var a=this.formFactor.getCurrentLayout();if(this.featureSwitchService&&this.featureSwitchService.featureSwitches.updateFormattingPaneObjects){var o=(0,Ta.z)(),s=this.runningVisualService.getVisual(r),l=r.config.singleVisual.visualType,u=[];T.fF.assert(function(){return _.every(e,function(y){return null!=y.visualUpdateSource})},"All changes should have a visual update source");var c=_.groupBy(e,function(y){return y.visualUpdateSource});for(var d in c){var h=c[d].map(function(y){return ae.H8(y)});u.push.apply(u,s.onDataViewObjectChanged(h,+d,!0))}T.fF.assertNonEmpty(u,"There should be at least one visual object change");var m,f=u.map(function(y){return ae.nH(r,y)});_.forEach(f,function(y){m||(m=ae.m7(y.objectName,y.propertySlice.name,l,t)),(0,cr.Sn)(y.objectName,y.propertySlice,r,t,a,y.hasDynamicExpressionSupport)}),m&&ae.zS(t.visualSync,r);var g=(0,Ta.z)();T.fF.assert(function(){return g-o<50},"Updating multiple object definitions should not take more than 50 milliseconds")}else _.forEach(e,function(y){(0,cr.Sn)(y.objectName,y.propertySlice,r,t,a,y.hasDynamicExpressionSupport,!0)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}},n.prototype.revertVisualSlicesToDefinitions=function(e,t){this.revertVisualBasedSlicesToDefinitions(e,t),this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&this.analyticsFormattingService.revertVisualSlicesToDefinitions(e,t)},n.prototype.revertVisualBasedSlicesToDefinitions=function(e,t){for(var r=[],a=0,o=(0,ae.Wx)(e);a<o.length;a++){var s=o[a],l=s.canvasItem;r.push(l);var u=s.descriptors,c=void 0;if((0,J.Vz)(l)){var d=l.config.singleVisual;(c=d.objects)||(d.objects=c={});var v=d.vcObjects;if(v){for(var h=[],f=function(D){var w=u.findIndex(function(V){return V.objectName===D.objectName});if(-1===w)return"continue";var F=u.splice(w,1)[0];h.push(F)},m=0,g=Gr;m<g.length;m++)f(g[m]);_.isEmpty(h)||ae.Aw(v,h)}}else(c=l.objects)||(l.objects=c={});if((0,J.Vz)(l)){if(l.config.singleVisual.visualType===Tt.L.shapeMap.name){var C=u.findIndex(function(N){return N.objectName===Va.L.dataPoint.fillRule.objectName&&N.propertyName===Va.L.dataPoint.fillRule.propertyName});C>-1&&(u.splice(C,1),(0,Sr._8)("revertToDefault",!1,c))}ae.Aw(c,u)}else ae.Aw(c,u)}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},n.prototype.getObjectDescriptors=function(e){var t=this.getVisualObjectDescriptors(e);if(!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting())return t;var r=this.analyticsFormattingService.getObjectDescriptors(e);return(0,p.pi)((0,p.pi)({},t),r)},n.prototype.getVisualObjectDescriptors=function(e){if((0,J.q4)(e))return{};for(var a=(0,p.pi)({},this.visualPluginService.capabilities(e.config.singleVisual.visualType).objects),o=function(d){T.fF.assert(function(){return!a[d.objectName]},"Existing descriptor"),a[d.objectName]=d.descriptor},s=0,l=Gr;s<l.length;s++)o(l[s]);return a},n.prototype.getObjectDefinitions=function(e,t){var i,r=this.getVisualObjectDefinitions(e,t);return this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&(i=this.analyticsFormattingService.getObjectDefinitions(e,t)),r&&i?(0,p.pi)((0,p.pi)({},r),i):r||i||void 0},n.prototype.getVisualObjectDefinitions=function(e,t){if(!(0,J.q4)(e)){var r=void 0,i=void 0;if(t&&this.formattingObjectDefinitionsService)r=this.formattingObjectDefinitionsService.getObjectDefinitions(e),i=this.formattingObjectDefinitionsService.getVcObjectDefinitions(e);else{var a=e.config.singleVisual;r=a.objects,i=a.vcObjects}if(i){for(var o=!1,s=(0,p.pi)({},r||{}),l=0,u=Gr;l<u.length;l++){var d=u[l].objectName,v=i[d];v&&(o=!0,s[d]=v)}if(o)return s}return r}},n.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,J.Vz)(e)){var a=e.config.singleVisual;r=a.visualType,i=a.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},n.prototype.resolvePlaceholder=function(e,t){if(!(0,J.q4)(t)){var r=this.runningVisualService.getVisual(t),i=this.getVisualAdapter(r),a=i&&i.resolveFormattingPlaceholder&&i.resolveFormattingPlaceholder(e);return a?(0,p.pi)((0,p.pi)({},a),{objectDescriptors:this.getObjectDescriptors(t)}):e.suppressDefaultValue?void T.fF.assertFail("Expected either a placeholder or default value being suppressed"):this.resolvePlaceholderDefault(e)}T.fF.assertFail("Unexpected placeholder")},n.prototype.resolvePlaceholderDefault=function(e){if((0,S.ie)(e))T.fF.assertNever(e.name);else if((0,S.LY)(e))T.fF.assertNever(e.name);else if((0,S.n$)(e))switch(e.name){case"responsive":return this.resolveResponsivePlaceholder();case"dataVolume":return;default:T.fF.assertNever(e.name)}else T.fF.assertFail("Unexpected placeholder type")},n.prototype.resolveResponsivePlaceholder=function(){var e=this,t=Yt.p.general.responsive,r={general:{properties:{responsive:He.iD.responsive}}};return{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new S.bd({descriptor:t,value:!1}).build(),localize:function(a){return e.localizationService.get(a)}}).withDisabled(!0).build(),objectDescriptors:r,revertToDefaultDescriptors:[t]}},n.prototype.getVisualAdapter=function(e){return e&&e.getAdapter()},n.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,J.q4)(e))return{messageKey:void 0};if((0,rr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if(ae.D1(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},n.prototype.getVisualFormatPaneViewModel=function(e){var t,r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,u,c,d,v,h,f;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return ae.D1(e)?[2,{cards:[]}]:(o=(0,rr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))?[3,6]:(a=this.runningVisualService.getVisual(e),null==(s=this.getVisualAdapter(a))||a.getHasPendingChanges()||a.getErrorInfo()?[2,{cards:[]}]:a&&a.getType()===e.config.singleVisual.visualType?s.getFormattingModelAsync?[4,s.getFormattingModelAsync()]:[3,2]:[3,5]);case 1:return u=m.sent(),[3,3];case 2:u=null===(t=s.getFormattingModel)||void 0===t?void 0:t.call(s),m.label=3;case 3:return(i=u)?[3,5]:[4,this.legacyVisualFormattingService.getFormattingModel(e)];case 4:i=m.sent(),m.label=5;case 5:i=this.filterOutAnalyticsCards(i),m.label=6;case 6:if(this.featureSwitchService.featureSwitches.onObject)c=this.getTitlePlaceholder(),d=this.getVisualSizeAndStylePlaceholder(),i=(0,p.pi)((0,p.pi)({},i||{}),{cards:(0,p.ev)((0,p.ev)([d],o?[]:[c],!0),null!==(r=i?.cards)&&void 0!==r?r:[],!0)});else if(!i||0===i.cards.length)return[2,{cards:[]}];return o||(v=this.getFormattingModelMessage(e),h=ya(a),f=a&&a.getWarnings$().pipe((0,pe.U)(function(g){return Sa(g)})),(v||h)&&(i=(0,p.pi)((0,p.pi)({},i),{warnings:h,warnings$:f}))),[2,i]}})})},n.prototype.getTitlePlaceholder=function(){return(0,S.UH)("title")},n.prototype.isInMobileFormatting=function(){return 1===this.formFactor.getCurrentLayout()},n.prototype.getVisualSizeAndStylePlaceholder=function(){return(0,S.UH)("sizeAndStyle")},n.prototype.filterOutAnalyticsCards=function(e){if(e){var t=e.cards.filter(function(r){return!r.analyticsPane});return(0,p.pi)((0,p.pi)({},e),{cards:t})}},n.prototype.getFormattingModelMessage=function(e){if(!(0,J.q4)(e)){var t=e.config.singleVisual.visualType,r=this.featureSwitchService.featureSwitches.shapeVisual,i=this.formFactor.getCurrentLayout();if("basicShape"===t&&r&&1!==i){var a=this.createShowDialogServices();return{messageKey:"ConvertShape_PropPaneMessage",action:{key:"Convert",fn:function(){return n.showDialog(t,a,Ro.al)}}}}}},n.prototype.createShowDialogServices=function(){return{dataSources:this.dataSources,explorationNavigation:this.explorationNavigation,localizationService:this.localizationService,modernDialogService:this.modernDialogService,selection:this.selectionService,visualAuthoring:this.visualAuthoring}},n.showDialog=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,g,y,C,N,D,w;return(0,p.Jh)(this,function(F){switch(F.label){case 0:return"basicShape"===(s=[],l=[],e)&&(i="ConvertShape_DialogConvertAll",a="ConvertShape_DialogTitle",o="ConvertShape_DialogMessage",s=t.explorationNavigation.getAllVisualContainers(e),l.push("basicShape"),u="shape",c="340px"),d={convertAll:{label:i}},v=t.localizationService.get("Undo"),h={titleText:a,messageTemplate:t.localizationService.format(o,"<b>"+v+"</b>"),okButtonText:"Convert",cancelButtonText:"Cancel_ButtonText",checkboxes:d},[4,t.modernDialogService.openHostDialog({dialogName:"CheckboxDialog",componentName:r,bindings:h,config:{panelClass:["checkbox-dialog"],width:c,autoFocus:!0}})];case 1:return[4,F.sent().afterClosed().toPromise()];case 2:if(!(g=F.sent())||0!==g.result)return[2];if(y=[],g.checkboxes.convertAll)y=s;else for(C=Qi.UP.getSelectedCanvasItems(t.selection),N=0,D=C;N<D.length;N++)(0,J.Vz)(w=D[N])&&l.includes(w.config.singleVisual.visualType)&&y.push(w);return t.visualAuthoring.convertMultiple(y,t.dataSources.get(),u),[2]}})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(pi),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(wr),q.\u0275\u0275inject(oi.F),q.\u0275\u0275inject(si),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(ta.x),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(qr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(Mr.f),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(ri.h,8))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Pa=b(63387),ja=b(64370),_a=b(54952),Aa=b(42587),be=b(40474),Ko=b(75570),xa=b(2911);function Jo(n,e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,m,g,C,N,D,V,I,j,L=this;return(0,p.Jh)(this,function(x){switch(x.label){case 0:return r=[],i=n.dataSourcesService,a=n.conceptualSchemaProxy,o=n.localizationService,s=n.changeDetectionMeasure,l=n.telemetryService,T.fF.assert(function(){return!!i},"options.dataSourcesService should not be null or undefined for CDM propertypane card"),T.fF.assert(function(){return!!a},"options.conceptualSchemaProxy should not be null or undefined for CDM propertypane card"),T.fF.assert(function(){return!!s},"options.changeDetectionMeasure should not be null or undefined for CDM propertypane card"),u=i.get(),[4,a.get(u)];case 1:if(!(c=x.sent()))return[2,[]];for(d=!1,v=0,h=c.schemas;v<h.length;v++)for(m=0,g=h[v].entities;m<g.length;m++)for(C=function(P){if(P.measure&&P.measure.changeDetectionMetadata){var A=(0,xa.bW)(P.measure.changeDetectionMetadata.refreshInterval),E=(0,xa.ei)(A);T.fF.assert(function(){return 1===E.length}," Expecting only 1 ISODurationString");var G=(0,Ko.u6)(E[0],o);return r=r.concat(t.getMeasureAndCheckEverySlices(P.name,G,o,e)),d=!0,"break"}},N=0,D=g[m].properties;N<D.length&&"break"!==C(D[N]);N++);return n.explorationCapabilities.getCapabilities().disableChangeDetectionDialog||(V=function(){return(0,p.mG)(L,void 0,void 0,function(){return(0,p.Jh)(this,function(P){return l.logEvent(it._m,{launchPoint:"PropertyPane"}),s.showDialog(),[2]})})},I=(0,ze.Gf)((0,Ce.V)(d?"ChangeDetectionEditLink":"ChangeDetectionAddLink"),n.localizationService),j=o.get(d?"Link_Button_Edit_Aria_Value":"Link_Button_Add_Aria_Value"),r.push(t.getAddCDMDialogSlice(I,e,V,j))),[2,r]}})})}function Qo(n,e){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(r){switch(r.label){case 0:return[4,Jo(n,e,{getAddCDMDialogSlice:$o,getMeasureAndCheckEverySlices:Yo})];case 1:return[2,r.sent()]}})})}function $o(n,e,t,r){var i=be.js.pageRefresh.dialogLauncher;return(new S.q6).withDisplayName(n,void 0,!0).withUid(i).withDisabled(e).withControlProperties(new S.Vc({descriptor:i,value:t,ariaLabel:r}).build()).build()}function Yo(n,e,t,r){var i=be.js.pageRefresh.measure,a=(new S.q6).withDisplayName(t.get("NewMeasureName")).withUid(i).withDisabled(r).withControlProperties(new S.G_({descriptor:i,value:n}).build()).build(),o=be.js.pageRefresh.checkEvery;return[a,(new S.q6).withDisplayName(t.get("CheckEvery")).withUid(o).withDisabled(r).withControlProperties(new S.G_({descriptor:o,value:e}).build()).build()]}var Zo=b(14463),zt=b(6236),Xo=b(68507),Ge=b(9480),Le=b(8590),Nr=b(78417),Ci=b(73795),Rt=b(64329),Tr=b(49977),es=b(28199),za=b(41114),Oa="PBI.Data.GetPerspectives",Ma=za.cx[Oa]=(0,za.b1)(Oa),ts=b(80688),rs=b(60225),Di=b(48787),is=b(17653),hr=b(57243),as=b(81213),ns=function(){function n(e,t,r,i){this.errorService=e,this.localizationService=t,this.perspectivesReader=r,this.telemetryService=i,this.perspectivesCache={}}return n.prototype.get=function(e){var t=this,i=e.filter(function(u){return"dsr"===u.type})[0];if(!i){this.telemetryService.startEvent(Ma,{dataSourceObjectId:""}).reject({errorMessage:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),errorCode:"NoValidDataSourceProvided",errorSource:"PowerBI"});var a={message:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),code:"NoValidDataSourceProvided",details:{source:"PowerBI"}};return(0,rs._)(a)}var o=this.telemetryService.startEvent(Ma,{dataSourceObjectId:i.objectId}),s=this.perspectivesCache[i.objectId];if(s)return s;var l=this.perspectivesReader.get(i).pipe((0,Di.q)(1),(0,is.b)(function(){return o.resolve()},function(u){t.perspectivesCache[i.objectId]=void 0,o.reject({errorMessage:u.message,errorCode:u.code,errorSource:"PowerBI"}),t.errorService.error(u.message,u.code,u.details)}),(0,hr.d)(1));return this.perspectivesCache[i.objectId]=l,l},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(as.T),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(ts.c),q.\u0275\u0275inject(Bt.y0))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),os=b(84669),ss=b(28016),La=b(11494),ls=b(52298),Ba=b(16524),Ea=b(52121),Ga=b(69071),Ur="linkType-",Ra=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,w,F,V,I,j,L,x,z){var P=this;this.promiseFactory=e,this.aggrOps=t,this.canvasScale=r,this.changeDetectionMeasure=i,this.conceptualSchemaProxy=a,this.contextActivityService=o,this.dataSources=s,this.displayNameService=l,this.eventBridge=u,this.explorationCapabilities=c,this.explorationNavigation=d,this.featureSwitchService=v,this.formattingSliceTransformerService=h,this.layoutAuthoring=f,this.lazyScoped=m,this.linguisticSchemaProxy=g,this.localizationService=y,this.perspectivesService=C,this.resourceLoader=N,this.resourceRegistration=D,this.telemetryService=w,this.themeService=F,this.undoRedo=V,this.visualAuthoring=I,this.visualPlugin=j,this.visualStylePresetService=L,this.visualSync=x,this.trustedVisualService=z,this.eventsSubscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(Le.yVh,function(){P.previousSizeType=void 0,P.sectionCustomWidth=void 0,P.sectionCustomHeight=void 0;var A=P.explorationNavigation.getCurrentSection();P.isCustomPageSize=(0,Ft.Y9)(A.size,P.explorationNavigation)===Ge.t.Custom}),this.linkFieldTypeAsCategorized={value:"categorized",displayName:this.localizationService.get("LinkField_AsAggregationDisabledText")},this.linkFieldTypeAsSummarized={value:"summarized",displayName:this.localizationService.get("LinkField_AsAggregationEnabledText")},this.pageTypeOptions=[{displayName:this.localizationService.get("Standard"),value:0},{displayName:this.localizationService.get("Tooltip"),value:1},{displayName:this.localizationService.get("Drillthrough_OneWord"),value:2}]}return n.prototype.ngOnDestroy=function(){this.eventsSubscriptionManager.unsubscribeAll()},n.prototype.getFormattingModel=function(){return(0,p.mG)(this,void 0,void 0,function(){var e,t,r,i,a,o,s,l,c,v,h,f,m,g;return(0,p.Jh)(this,function(y){switch(y.label){case 0:return t={cards:e=[]},r=this.explorationNavigation.getCurrentSection(),i=this.dataSources.get(),r&&i?[4,this.conceptualSchemaProxy.get(i)]:[3,6];case 1:return a=y.sent(),o=_.map(a.schemas,function(C){return C.capabilities}).filter(function(C){return!!C}),l=(s=e).push,[4,this.populatePageInformation(r)];case 2:return l.apply(s,[y.sent()]),e.push(this.populateCanvasSettings(r)),e.push(this.populateCanvasBackground(r)),e.push(this.populateWallpaper(r)),e.push(this.populateFilterPane(r)),e.push(this.populateFilterCard(r)),this.explorationCapabilities.getCapabilities().disableInlineExplore?[3,4]:(c=this.explorationNavigation.getCurrentExploration())&&c.settings&&c.settings.allowInlineExploration?(h=(v=e).push,[4,this.populatePersonalizeVisual(r)]):[3,4];case 3:h.apply(v,[y.sent()]),y.label=4;case 4:return this.featureSwitchService.featureSwitches.realTimeRefresh&&!this.featureSwitchService.featureSwitches.realTimeRefreshDisabled&&_.some(o,function(C){return C.supportsFastRefresh})?(f=_.some(o,function(C){return C.supportChangeDetectionMeasureRefresh}),g=(m=e).push,[4,this.populatePageRefresh(r,f)]):[3,6];case 5:g.apply(m,[y.sent()]),y.label=6;case 6:return[2,t]}})})},n.prototype.getObjectDescriptors=function(){return be.C7},n.prototype.saveProperties=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,m,g,y,C,N,D,w,V,I,j,L,x,z,A,E;return(0,p.Jh)(this,function(Y){switch(Y.label){case 0:return T.fF.assert(function(){return 1===_.size(e)},"We do not support saving multiple property changes to the page right now. Add your support if need."),1!==_.size(e)?[2]:(i=e[0].objectName,a=e[0].propertySlice,o=this.getPagePropertyPaneSaveServices(),s=this.explorationNavigation.getCurrentExploration(),l=this.explorationNavigation.getCurrentSection(),a.name!==De.PageSizeTypeName?[3,2]:(u=a.value,N=this.savePageProperties(a,i,t,o),this.isCustomPageSize=u===Ge.t.Custom,u!==Ge.t.Tooltip&&(this.previousSizeType=u),this.isCustomPageSize&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height),c=this.checkIfPageInformationTypeNeedsUpdate(u,l),d=void 0,c&&(v=!this.featureSwitchService.featureSwitches.onObject||(null===(r=_.find(this.pageTypeOptions,function(ne){return 1===ne.value}))||void 0===r?void 0:r.value),h=(0,p.pi)((0,p.pi)({},a),{name:De.PageInformationType,value:v}),d=this.savePageProperties(h,De.PageInformationCardName,t,o)),[4,Promise.all([d,N])]));case 1:return[2,(z=Y.sent()).every(function(ne){return ne})];case 2:return a.name===De.PageInformationType&&_.isEmpty(l.visualContainers)?(m=void 0,this.featureSwitchService.featureSwitches.onObject?(g=a.value,T.fF.assert(function(){return null!=g},"propertyPaneSlice.value for page type cannot be null"),m=1===g):m=a.value,y=this.savePageProperties(a,i,t,o),C=(0,Ft.Y9)(l.size,this.explorationNavigation),m?(this.isCustomPageSize=!1,null==this.previousSizeType&&(this.previousSizeType=C),C===Ge.t.Custom&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height)):this.isCustomPageSize=this.previousSizeType?this.previousSizeType===Ge.t.Custom:C===Ge.t.Custom,N=void 0,D=void 0,w=void 0,this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,m,l,o)?(V=m?Ge.t.Tooltip:this.previousSizeType,I=(0,p.pi)((0,p.pi)({},a),{name:De.PageSizeTypeName,value:V}),[4,this.savePageProperties(I,j=De.PageSizeCardName,t,o)]):[3,4]):[3,6];case 3:N=Y.sent(),!m&&this.previousSizeType===Ge.t.Custom&&(null!=this.sectionCustomWidth&&l.size.width!==this.sectionCustomWidth&&(L=(0,p.pi)((0,p.pi)({},a),{name:De.PageSizeWidthName,value:this.sectionCustomWidth}),D=this.savePageProperties(L,j,t,o)),null!=this.sectionCustomHeight&&l.size.height!==this.sectionCustomHeight&&(x=(0,p.pi)((0,p.pi)({},a),{name:De.PageSizeHeightName,value:this.sectionCustomHeight}),w=this.savePageProperties(x,j,t,o))),Y.label=4;case 4:return[4,Promise.all([y,D,w])];case 5:return z=Y.sent(),[2,N&&z.every(function(ne){return ne})];case 6:return a.name===De.PageSizeWidthName&&(A=a.value,(null==this.sectionCustomWidth||A!==this.sectionCustomWidth)&&(this.sectionCustomWidth=A)),a.name===De.PageSizeHeightName&&(E=a.value,(null==this.sectionCustomHeight||E!==this.sectionCustomHeight)&&(this.sectionCustomHeight=E)),a.name!==be.js.pageInformation.pageInformationDrillthroughKeepAllFilters.propertyName?[3,8]:[4,this.saveDrillthroughFilterPassingModeUpdate(a.value,s,l)];case 7:return Y.sent(),[2,!0];case 8:return a.name!==be.js.pageInformation.pageInformationDrillthroughCrossReportEnabled.propertyName?[3,10]:[4,this.saveDrillthroughCrossReportModeUpdate(a.value,s,l)];case 9:return Y.sent(),[2,!0];case 10:return a.name!==be.js.pageInformation.pageInformationDrillthroughFields.propertyName?[3,12]:[4,this.saveDrillthroughFieldsUpdate(a.value,l)];case 11:return[2,Y.sent()];case 12:return e[0].uid.includes(Ur)?(this.saveLinkFieldLinkTypeUpdate(l,e[0]),[2,!0]):[4,this.savePageProperties(a,i,t,o)];case 13:return[2,Y.sent()]}})})},n.prototype.saveDrillthroughFilterPassingModeUpdate=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.lazyScoped.get(Tr.Sz)];case 1:return a.sent().setDrillthroughFilterPassingMode(t,r,e),[2]}})})},n.prototype.saveDrillthroughCrossReportModeUpdate=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return[4,this.lazyScoped.get(Tr.Sz)];case 1:return a.sent().setCrossReportDrillthrough(t,r,e),[2]}})})},n.prototype.saveDrillthroughFieldsUpdate=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a;return(0,p.Jh)(this,function(o){return(r=e.fromUpdate)?"add"===r.type?[2,!0]:(i=!1,"delete"===r.type?(a=r.deleted.metadata.boundFilter,_.isEmpty(a)||(i=(0,Ci.ku)(a,1,t,this.visualAuthoring)),[2,i]):[2,!1]):[2]})})},n.prototype.saveLinkFieldLinkTypeUpdate=function(e,t){var r=t.uid,i=r.lastIndexOf(Ur),a=r.substring(i+9),o=_.find(e.filters,function(u){return u.name===a});o&&this.visualAuthoring.setLinkFieldAsAggregation(o,{scopeType:1,container:e},t.propertySlice.value===this.linkFieldTypeAsSummarized.value)},n.prototype.checkIfSizeTypeNeedsUpdate=function(e,t,r,i){if(!_.isEmpty(r.visualContainers))return!1;var o=void 0!==e,s=(0,Ft.Y9)(r.size,i.explorationNavigation);return!!(t&&s!==Ge.t.Tooltip||!t&&o&&s!==e)},n.prototype.checkIfPageInformationTypeNeedsUpdate=function(e,t){return!(e!==Ge.t.Tooltip||1===t.type)},n.prototype.revertPageSliceDefinitions=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i,a,o,s;return(0,p.Jh)(this,function(l){switch(l.label){case 0:return t=this.explorationNavigation.getCurrentExploration(),r=this.explorationNavigation.getCurrentSection(),(0,ae.Aw)(i=r.objects||{},e),r.objects=i,[4,this.lazyScoped.get(Tr.Sz)];case 1:return a=l.sent(),o=be.js.pageInformation.pageInformationType,s=be.js.pageSize.pageSizeTypes,e&&e.some(function(u){return u.objectName===o.objectName})?[4,this.setPageInformationDefaultValues(t,r,a)]:[3,3];case 2:l.sent(),l.label=3;case 3:return e&&e.some(function(u){return u.objectName===s.objectName})?[4,this.setPageSizeDefaultValues(t,r,a)]:[3,5];case 4:l.sent(),l.label=5;case 5:return this.eventBridge.publishToChannel(Le.H8N,r),[2]}})})},n.prototype.setPageInformationDefaultValues=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(a){switch(a.label){case 0:return 0===t.type?[3,2]:(Ha(0,r,e,t,this.featureSwitchService.featureSwitches.onObject),this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,!1,t,this.getPagePropertyPaneSaveServices())?[4,this.setPageSizeDefaultValues(e,t,r)]:[3,2]);case 1:a.sent(),a.label=2;case 2:return e&&e.pods?[4,(0,Nr.QU)(e,t.name,this.linguisticSchemaProxy)]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}})})},n.prototype.setPageSizeDefaultValues=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i;return(0,p.Jh)(this,function(o){switch(o.label){case 0:return Wa(Ge.t.Widescreen,t.size,this.eventBridge,r,this.canvasScale.getDisplayOption()),this.isCustomPageSize=!1,this.previousSizeType=i=Ge.t.Widescreen,this.checkIfPageInformationTypeNeedsUpdate(i,t)?[4,this.setPageInformationDefaultValues(e,t,r)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},n.prototype.getObjectDefinitions=function(){var e=this.explorationNavigation.getCurrentSection();return e?.objects},n.prototype.getRevertToDefaultMetadata=function(){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ae.An)("Page",this.featureSwitchService)}},n.prototype.isPageInformationDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection();if(1&e.type||2&e.type)return!0;var t=this.explorationNavigation.getCurrentExploration();return!(!t||!t.pods)},n.prototype.isPageSizeDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection(),t=(0,Ft.Y9)(e.size,this.explorationNavigation),r=(0,Ft.MO)(Ge.t.Widescreen);return!(!this.isCustomPageSize&&t===Ge.t.Widescreen&&e.size.width===r.width&&e.size.height===r.height)},n.prototype.getRevertToDefaultEnabled=function(e,t){var r=this.getObjectDefinitions();if((0,ae.wW)(e,r,t))return!0;var i=be.js.pageInformation.pageInformationType;if(e&&e.some(function(l){return l.objectName===i.objectName})&&this.isPageInformationDefaultValuesChanged())return!0;var o=be.js.pageSize.pageSizeTypes;return!(!e||!e.some(function(l){return l.objectName===o.objectName})||!this.isPageSizeDefaultValuesChanged())},n.prototype.populatePageInformation=function(e){return(0,p.mG)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,w=this;return(0,p.Jh)(this,function(F){switch(F.label){case 0:return t=function(I){return w.localizationService.get(I)},l=[i=(r=be.js.pageInformation).pageInformationName,a=r.pageInformationType,o=r.pageInformationQnaPodEnabled,s=r.pageInformationAltName],this.featureSwitchService.featureSwitches.onObject&&l.push.apply(l,[r.pageInformationDrillthroughKeepAllFilters,r.pageInformationDrillthroughCrossReportEnabled,r.pageInformationDrillthroughFields,r.pageInformationDrillthroughLinkFieldsLinkTypes]),u=new S.lg("pageInformation"),c=new S.CQ(u,"PagePropertyPane_PageInformation",l,t).build(),d=this.explorationNavigation.getCurrentExploration(),[4,(0,Nr._3)(d,e.name,this.linguisticSchemaProxy,this.promiseFactory)];case 1:return v=F.sent(),h=new S.mQ(new S.SS(u,"pageInformation"),t).addSimpleSlice(i.propertyName,new S.fq({descriptor:i,value:e.displayName,placeholder:"",validators:{required:{type:2}}}).build(),function(V){return V.withCustomDisplayName("Name")}),this.featureSwitchService.featureSwitches.onObject||(h.addSimpleSlice(a.propertyName,new S.bd({descriptor:a,value:!!(1&e.type)}).build(),function(V){return V.withCustomDisplayName("Allow_As_Tooltip").withCustomDescription("PagePropertyPane_PageInformation_Tooltip_Description")}),h.addSimpleSlice(o.propertyName,new S.bd({descriptor:o,value:!!v}).build(),function(V){return V.withCustomDisplayName("Allow_Qna").withCustomDescription("PagePropertyPane_PageInformation_PodEnabled_Description")}),v&&h.addSimpleSlice(s.propertyName,new S.Jr({descriptor:s,value:v.altNames?v.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:t}).build(),function(V){return V.withCustomDisplayName("Page_Synonyms")}),c.groups.push(h.build())),this.featureSwitchService.featureSwitches.onObject?(f=function(n,e){for(var t,r=1===e.type?2:1,i=[],a=0,o=null!==(t=n.pods)&&void 0!==t?t:[];a<o.length;a++){var s=o[a];if(s.type===r&&s.boundSection===e.name)for(var l=0,u=s.parameters;l<u.length;l++){var c=u[l];c.fieldExpr&&i.push(c)}}return i}(d,e),[4,this.getLinkParameterFilterDisplayNameMappings(f,e)]):[3,5];case 2:return m=F.sent(),g=this.getDrillthroughTooltipControlSettings(d,e),this.addDefaultGroupDrillthroughRelatedSlices(e,f,g,h),c.groups.push(h.build()),C=null==(y=e.type)||0===y,T.fF.assert(function(){return!(C&&!_.isEmpty(f))},"A section in null/Regular type and has drillthrough content should've been upgraded to Drillthrough type already!"),1===y||2===y?[4,this.getLinkFieldsLinkTypeGroup(f,m,g,u,t)]:[3,4];case 3:N=F.sent(),c.groups.push(N),F.label=4;case 4:D=this.getQnaGroup(v,u,t),c.groups.push(D),F.label=5;case 5:return[2,c]}})})},n.prototype.addDefaultGroupDrillthroughRelatedSlices=function(e,t,r,i){var a=this;if(this.featureSwitchService.featureSwitches.onObject){var o=null!=e.type?e.type:0,s=be.js.pageInformation,l=s.pageInformationType,u=s.pageInformationDrillthroughKeepAllFilters,c=s.pageInformationDrillthroughCrossReportEnabled,d=s.pageInformationDrillthroughFields;if(i.addSimpleSlice(l.propertyName,new S.uY({descriptor:l,items:this.pageTypeOptions,value:_.find(this.pageTypeOptions,function(f){return f.value===o})}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_PageType").withCustomDescription("PagePropertyPane_PageType_Tooltip")}),1===o||2===o){i.addSimpleSlice(u.propertyName,new S.bd({descriptor:u,value:r.keepAllFilters.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_KeepAllFilters").withCustomDescription(r.keepAllFilters.tooltip,!1).withDisabled(r.keepAllFilters.disabled)}),2===o&&i.addSimpleSlice(c.propertyName,new S.bd({descriptor:c,value:r.crossReportDrillthrough.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_CrossReportDrillthrough").withCustomDescription(r.crossReportDrillthrough.tooltip,!1)});var h={control:{type:"FieldPicker",properties:{descriptor:d,value:{newExpr:_.map(t,function(f){return{expr:f.fieldExpr,metadata:{boundFilter:f.boundFilter}}}),fromUpdate:{type:"initialize"}},validators:void 0,allowMultipleValues:!0,disallowReplaceItems:!0,getDropExprStrategy:{getDropExpr:function(m,g){return(0,p.mG)(a,void 0,void 0,function(){return(0,p.Jh)(this,function(y){switch(y.label){case 0:return[4,this.tryCreateDrillthroughFilter(e,m)];case 1:return[2,y.sent()]}})})},getDroppedExprChildren:function(m,g,y,C){}}}},displayName:r.linkFieldsDropZoneTitle,uid:i.uidBuilder.withSlice(d.propertyName).build()};i.addSlice(h)}}},n.prototype.getLinkParameterFilterDisplayNameMappings=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.Jh)(this,function(o){switch(o.label){case 0:return _.isEmpty(e)?[2,{}]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return r=o.sent(),i={},_.forEach(e,function(s){var l=_.find(t.filters,function(c){return c.name===s.boundFilter}),u=(0,Ci.eW)(l,{scopeType:1,container:t},r,a.aggrOps,a.displayNameService,a.localizationService,a.visualPlugin);i[s.name]=u}),[2,i]}})})},n.prototype.getLinkFieldsLinkTypeGroup=function(e,t,r,i,a){return(0,p.mG)(this,void 0,void 0,function(){var o,s,l=this;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return o=new S.mQ(new S.SS(i,"pageInformationDrillthroughLinkFieldsLinkTypes"),a).withDisplayName(r.linkFieldsLinkTypeGroupTitle,!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=u.sent(),_.forEach(e,function(c){var h,d=!0,v=!0,f=c.fieldExpr;(0,H.kb)(f)?(h=!0,d=!1):qe.m.discourageAggregation(f,s)?(h=!1,v=!1):h=c.asAggregation;var m=[];d&&m.push(l.linkFieldTypeAsCategorized),v&&m.push(l.linkFieldTypeAsSummarized),o.addSimpleSlice(Ur+c.boundFilter,new S.uY({descriptor:be.js.pageInformation.pageInformationDrillthroughLinkFieldsLinkTypes,items:m,value:h?l.linkFieldTypeAsSummarized:l.linkFieldTypeAsCategorized}).build(),function(C){T.fF.assert(function(){return!_.isEmpty(t[c.name])},"there should be a corresponding filter display name for parameter "+c.name);var D=l.localizationService.format("PagePropertyPane_LinkField_LinkType_FieldName",t[c.name]);C.withCustomDisplayName(D,!1)})}),_.isEmpty(e)&&o.withDisabled(!0,void 0),[2,o.build()]}})})},n.prototype.getQnaGroup=function(e,t,r){var i=be.js.pageInformation,a=i.pageInformationQnaPodEnabled,o=i.pageInformationAltName;return new S.mQ(new S.SS(t,"pageInformationQnaPodEnabled"),r).withDisplayName("Allow_Qna").addTopLevelToggle(a.propertyName,function(){return new S.bd({descriptor:a,value:!!e}).build()}).addSimpleSlice(o.propertyName,new S.Jr({descriptor:o,value:e?.altNames?e.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:r}).build(),function(l){return l.withDisabled(!e).withCustomDisplayName("Page_Synonyms")}).build()},n.prototype.populateCanvasSettings=function(e){var t,r=this,i=function(g){return r.localizationService.get(g)},a=(t=be.js.pageSize).pageSizeTypes,o=t.pageSizeHeight,s=t.pageSizeWidth,l=be.js.displayArea.verticalAlignment,u=new S.CQ(new S.lg("pageSize"),"Canvas_Settings",[a,o,s,l],i),c=this.isCustomPageSize?Ge.t.Custom:(0,Ft.Y9)(e.size,this.explorationNavigation),d=(0,Ft.Iq)(Ge.D.members(),this.localizationService);c===Ge.t.Dynamic&&d.unshift({value:Ge.t.Dynamic,displayName:i("PagePropertyPane_PageSizeType_Dynamic")});var v=this.explorationNavigation.getCurrentExploration(),h=e.evaluatedObjects&&e.evaluatedObjects.displayArea,f=h&&h.verticalAlignment;return void 0===f&&(f=v&&v.evaluatedObjects&&v.evaluatedObjects.section&&v.evaluatedObjects.section.verticalAlignment),void 0===f&&(f=Xo.XN),u.addGroup("pageSize",function(m){m.addSimpleSlice(a.propertyName,new S.uY({descriptor:a,items:d,value:d.find(function(g){return g.value===c})}).build(),function(g){return g.withCustomDisplayName("Type")}).addSimpleSlice(o.propertyName,new S.mu({descriptor:o,value:e.size.height,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeHeight").withDisabled(c!==Ge.t.Custom)}).addSimpleSlice(s.propertyName,new S.mu({descriptor:s,value:e.size.width,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeWidth").withDisabled(c!==Ge.t.Custom)}).addSimpleSlice(l.propertyName,new S.uY({descriptor:l,value:f}).build(),function(g){return g.withCustomDisplayName("Visual_Alignment_Vertical")})}).build()},n.prototype.populateCanvasBackground=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[De.PageBackgroundCardName],a=Ve.tb,o=Ve.nW,s=(0,Ar.Gl)(i?.color)?i.color.solid.color:a,l=be.js.background,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("background"),"Canvas_Background",[u,c,d],r).withDescription("Area_Beneath_Visual").addGroup("background",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},n.prototype.populateWallpaper=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[De.OutspaceBackgroundCardName],a=Ve.hH,o=Ve.Dd,s=(0,Ar.Gl)(i?.color)?i.color.solid.color:a,l=be.js.outspace,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("outspace"),"PagePropertyPane_Outspace",[u,c,d],r).withDescription("Area_Behind_Canvas").addGroup("outspace",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},n.prototype.populatePageRefresh=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,D=this;return(0,p.Jh)(this,function(w){switch(w.label){case 0:return r=function(V){return D.localizationService.get(V)},a=(i=e.evaluatedObjects&&e.evaluatedObjects.pageRefresh||{show:!1,duration:Ve.oK,refreshType:zt.wO}).show||!1,s=(o=be.js.pageRefresh).show,l=o.refreshType,u=o.duration,c=o.dialogLauncher,d=o.measure,v=o.checkEvery,h=new S.CQ(new S.lg("pageRefresh"),"PageRefresh",[s,l,u,c,d,v],r),f=i.duration||Ve.oK,m=i.refreshType||zt.wO,t||(m=zt.wO),y=t?[zt.wO,zt.kj]:[zt.wO],(g=this.featureSwitchService.featureSwitches.changeDetection)&&m===zt.kj?[4,Qo({localizationService:this.localizationService,dataSourcesService:this.dataSources,changeDetectionMeasure:this.changeDetectionMeasure,conceptualSchemaProxy:this.conceptualSchemaProxy,explorationCapabilities:this.explorationCapabilities,telemetryService:this.telemetryService},!a)]:[3,2];case 1:C=w.sent(),w.label=2;case 2:return[2,h.addTopLevelToggle(s.propertyName,function(){return new S.bd({descriptor:s,value:a}).build()}).addGroup("pageRefresh",function(F){g?m===zt.wO?(D.createRefreshTypeSlice(F,l,"".concat(m),y),D.createDurationSlice(F,u,f)):D.createRefreshTypeSlice(F,l,"".concat(m),y):D.createDurationSlice(F,u,f),g&&m===zt.kj&&F.addSlices(C)}).build()]}})})},n.prototype.createDurationSlice=function(e,t,r){e.addSimpleSlice(t.propertyName,new S.Cv({descriptor:t,value:r,validators:{min:"PT1S",max:"P24D",integer:!0}}).build(),function(i){return i.withCustomDisplayName("AutoPageRefreshInterval")})},n.prototype.createRefreshTypeSlice=function(e,t,r,i){e.addSimpleSlice(t.propertyName,new S.uY({descriptor:t,value:r,filterValues:i}).build(),function(a){return a.withCustomDisplayName("AutoPageRefreshType")})},n.prototype.populatePersonalizeVisual=function(e){var t,r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f=this;return(0,p.Jh)(this,function(m){switch(m.label){case 0:return i=function(y){return f.localizationService.get(y)},o=(a=be.js.personalizeVisual).show,s=a.perspectiveRef,l=a.applyToAllPages,u=new S.CQ(new S.lg("personalizeVisual"),"VisualHeader_ShowPersonalizeVisualButton",[o,s,l],i),c=null===(r=null===(t=e.evaluatedObjects)||void 0===t?void 0:t.personalizeVisual)||void 0===r?void 0:r.perspectiveRef,[4,(0,Fe.mI)(this.dataSources,this.perspectivesService,this.localizationService)];case 1:return d=m.sent(),v=null!=c&&_.find(d,function(g){return g.value===c}),h=v?.value||"",[2,u.addTopLevelToggle(o.propertyName,function(){var g,y,C;return new S.bd({descriptor:o,value:null===(C=null===(y=null===(g=e?.evaluatedObjects)||void 0===g?void 0:g.personalizeVisual)||void 0===y?void 0:y.show)||void 0===C||C}).build()}).addGroup("personalizeVisual",function(g){g.addSimpleSlice(s.propertyName,new S.uY({descriptor:s,items:d,value:_.find(d,function(y){return y.value===h})}).build(),function(y){return y.withCustomDisplayName("PersonalizeVisual_PerspectivePropertyName")}).addSimpleSlice(l.propertyName,new S.Vc({descriptor:l,value:function(){return f.onApplyToAllPages(l)}}).build(),function(y){return y.withCustomDisplayName("PagePropertyPane_ApplyToAllPages").withSuppressDisplayName(!0)})}).build()]}})})},n.prototype.onApplyToAllPages=function(e){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(r){return this.saveProperties([{objectName:e.objectName,uid:"applyToAllPagesUid",propertySlice:{name:e.propertyName,type:{applyToAllPages:!0},value:!1},hasDynamicExpressionSupport:!1,formattingSource:"Page",visualUpdateSource:0}],{contextActivityService:this.contextActivityService,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,layoutAuthoring:this.layoutAuthoring,localizationService:this.localizationService,resourceLoader:this.resourceLoader,resourceRegistration:this.resourceRegistration,telemetryService:this.telemetryService,themeService:this.themeService,undoRedo:this.undoRedo,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visualStylePresetService:this.visualStylePresetService,visualSync:this.visualSync,trustedVisualService:this.trustedVisualService}),[2]})})},n.prototype.populateFilterPane=function(e){var t=this,r=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),i=e.evaluatedObjects&&e.evaluatedObjects.outspacePane,a=function(w){return t.localizationService.get(w)},o=be.js.outspacePane,s=o.fontFamily,l=o.titleSize,u=o.foregroundColor,c=o.inputBoxColor,d=o.headerSize,v=o.searchTextSize,h=o.border,f=o.borderColor,m=o.backgroundColor,g=o.transparency,y=o.width,C=o.checkboxAndApplyColor;return new S.CQ(new S.lg("outspacePane"),"Exploration_FilterPane",[s,l,u,c,d,v,h,f,m,g,y,C],a).addGroup("text",function(D){var w=i&&null!=i.foregroundColor?i.foregroundColor.solid.color:r.colorPalette.foreground.value;D.withDisplayName("Text").addCompositeSlice(s.propertyName,"Font",(new S.UN).withFontFamily({descriptor:s,value:i&&null!=i.fontFamily?"".concat(i.fontFamily):Ve.h9}).withFontSizeProperties({descriptor:l,value:i&&null!=i.titleSize?i.titleSize:Ve.Db,options:{maxValue:{type:1,value:Rt.PR},minValue:{type:0,value:Rt.Gj}}}).build()).addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:w}}).build(),function(F){return F.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(D){var w=i&&null!=i.inputBoxColor?i.inputBoxColor.solid.color:i&&null!=i.backgroundColor?i.backgroundColor.solid.color:Ve.$U;D.withDisplayName("Input").addSimpleSlice(c.propertyName,new S.BT({descriptor:c,value:{value:w}}).build(),function(F){return F.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("header",function(D){D.withDisplayName("ThemeDialog_SubSection_Header").addSimpleSlice(d.propertyName,new S.mu({descriptor:d,value:i&&null!=i.headerSize?i.headerSize:Ve.SC,options:{maxValue:{type:1,value:Rt.PR},minValue:{type:0,value:Rt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(w){return w.withCustomDisplayName("PagePropertyPane_OutspacePane_HeaderSize")})}).addGroup("searchbox",function(D){D.withDisplayName("SearchBox").addSimpleSlice(v.propertyName,new S.mu({descriptor:v,value:i&&null!=i.searchTextSize?i.searchTextSize:Ve.D6,options:{maxValue:{type:1,value:Rt.PR},minValue:{type:0,value:Rt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(w){return w.withCustomDisplayName("PagePropertyPane_OutspacePane_SearchTextSize")})}).addGroup("border",function(D){var w=i&&null!=i.borderColor?i.borderColor.solid.color:Ve.JW;D.withDisplayName("Visual_Border").addTopLevelToggle(h.propertyName,function(){return new S.bd({descriptor:h,value:i&&null!=i.border?i.border:Ve.zH}).build()}).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:w}}).build(),function(F){return F.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(D){var w,F=i&&null!=i.backgroundColor?i.backgroundColor.solid.color:r.colorPalette.background.value;D.withDisplayName("Visual_Background").addSimpleSlice(m.propertyName,new S.BT({descriptor:m,value:{value:F}}).build(),function(V){return V.withCustomDisplayName("Generic_Color")}).addSimpleSlice(g.propertyName,S.JN.getTransparencySliderBuilder({descriptor:g,value:null!==(w=i?.transparency)&&void 0!==w?w:Ve.yX,localize:a}).build(),function(V){return V.withCustomDisplayName("Transparency")})}).addGroup("options",function(D){var w=i&&null!=i.checkboxAndApplyColor?i.checkboxAndApplyColor.solid.color:Ve.mC;D.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice(y.propertyName,new S.mu({descriptor:y,value:i&&null!=i.width?i.width:Ve.vg,options:{maxValue:{type:1,value:Ve.Xj},minValue:{type:0,value:Ve.AA},unitSymbol:"Numeric_Pixel"}}).build(),function(F){return F.withCustomDisplayName("Pane_Width")}).addSimpleSlice(C.propertyName,new S.BT({descriptor:C,value:{value:w}}).build(),function(F){return F.withCustomDisplayName("Apply_And_Checkboxes").withCustomDescription("Apply_And_Checkboxes_Tooltip")})}).build()},n.prototype.populateFilterCard=function(e){var t=this,r=function(s){return t.localizationService.get(s)},i=be.js.filterCard;return new S.CQ(new S.lg("filterCard"),"PagePropertyPane_FilterCards",[i.fontFamily,i.textSize,i.foregroundColor,i.inputBoxColor,i.border,i.borderColor,i.backgroundColor,i.transparency],r).addGroup("applySettingsTo",function(o){o.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("state",function(s){s.withDisplayName("State").addContainerItem("default",r("Default"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!1)}).addContainerItem("applied",r("PagePropertyPane_FilterCards_Applied"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!0)})})}).build()},n.prototype.generateFilterCardContainerItemBuilder=function(e,t,r){var i=this,a=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),o=function(v){return i.localizationService.get(v)},s=t.evaluatedObjects&&t.evaluatedObjects.filterCard,l=r?Ve.ZF:Ve.Kc,u={id:l},c=s&&s.$instances&&s.$instances[l];e.addGroup("text",function(d){var v=(0,p.pi)((0,p.pi)({},be.js.filterCard.fontFamily),{selector:u}),h=c&&null!=c.foregroundColor?c.foregroundColor.solid.color:a.colorPalette.foreground.value,f=(0,p.pi)((0,p.pi)({},be.js.filterCard.foregroundColor),{selector:u});d.withDisplayName("Text").addCompositeSlice(v.propertyName,"Font",(new S.UN).withFontFamily({descriptor:v,value:c&&null!=c.fontFamily?"".concat(c.fontFamily):Ve.h9}).withFontSizeProperties({descriptor:(0,p.pi)((0,p.pi)({},be.js.filterCard.textSize),{selector:u}),value:c&&null!=c.textSize?c.textSize:Ve.JM,options:{maxValue:{type:1,value:Rt.PR},minValue:{type:0,value:Rt.Gj}}}).build()).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:h}}).build(),function(m){return m.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(d){var v=(0,p.pi)((0,p.pi)({},be.js.filterCard.inputBoxColor),{selector:u}),h=c&&null!=c.inputBoxColor?c.inputBoxColor.solid.color:Ve.NC;d.withDisplayName("Input").addSimpleSlice(v.propertyName,new S.BT({descriptor:v,value:{value:h}}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("border",function(d){var v=(0,p.pi)((0,p.pi)({},be.js.filterCard.border),{selector:u}),h=(0,p.pi)((0,p.pi)({},be.js.filterCard.borderColor),{selector:u}),f=c&&null!=c.borderColor?c.borderColor.solid.color:Ve.bm;d.withDisplayName("Visual_Border").addTopLevelToggle(v.propertyName,function(){return new S.bd({descriptor:v,value:c&&null!=c.border?c.border:Ve.HX}).build()}).addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(d){var v,h=(0,p.pi)((0,p.pi)({},be.js.filterCard.backgroundColor),{selector:u}),f=c&&null!=c.backgroundColor?c.backgroundColor.solid.color:a.colorPalette.background.value,m=(0,p.pi)((0,p.pi)({},be.js.filterCard.transparency),{selector:u});d.withDisplayName("Visual_Background").addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(g){return g.withCustomDisplayName("Generic_Color")}).addSimpleSlice(m.propertyName,S.JN.getTransparencySliderBuilder({descriptor:m,value:null!==(v=c?.transparency)&&void 0!==v?v:Ve.$V,localize:o}).build(),function(g){return g.withCustomDisplayName("Transparency")})})},n.prototype.getFormatPaneSliceTransform=function(){var e=this;return function(t,r,i){return e.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:t,objectDescriptors:r,visualType:void 0,visualObjects:void 0,dynamicExpressionSupportOptions:i})}},n.prototype.getPagePropertyPaneSaveServices=function(){return{canvasScale:this.canvasScale,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,lazyScoped:this.lazyScoped,linguisticSchemaProxy:this.linguisticSchemaProxy,promiseFactory:this.promiseFactory,telemetryService:this.telemetryService,undoRedo:this.undoRedo}},n.prototype.getDrillthroughTooltipControlSettings=function(e,t){return Aa.F(e,t,Aa.j(t.type,this.localizationService,!0),!1)},n.prototype.tryCreateDrillthroughFilter=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return[4,(0,Ci.uE)(1,e,!0,this.dataSources,t,this.visualAuthoring,!1)];case 1:return r=i.sent(),_.isEmpty(r)?[2]:[2,{expr:t,metadata:{boundFilter:r}}]}})})},n.prototype.savePageProperties=function(e,t,r,i){var a,o;return(0,p.mG)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,C,N;return(0,p.Jh)(this,function(D){return s=i.explorationNavigation.getCurrentExploration(),l=i.explorationNavigation.getCurrentSection(),u=l.size,c=i.canvasScale.getDisplayOption(),d=i.promiseFactory.defer(),e.name===De.PageInformationName?(e.value?(v={sectionNewName:e.value,sectionIndex:_.indexOf(s.sections,l)},i.eventBridge.publishToChannel(Le.HOc,v)):e.value=l.displayName,d.resolve(!1)):e.name===De.PageInformationQnaPodEnabled?e.value?i.undoRedo.register("ReportPagePodEnabled",function(){(0,Nr.k9)(s,l,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):i.undoRedo.register("ReportPagePodDisabled",function(){(0,Nr.QU)(s,l.name,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):e.name===De.PageInformationAltName?(h=e.value.split(/[,\n]/).map(function(w){return w.trim()}).filter(function(w){return!_.isEmpty(w)}),i.undoRedo.register("UpdateLinguisticAltNames",function(){(0,Nr.XY)(s,l,h,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})})):e.name===De.PageInformationType?((f=r.featureSwitchService.featureSwitches.onObject)?(m=e.value,T.fF.assert(function(){return null!=m},"propertyPaneSlice.value for page type cannot be null")):m=e.value?1:0,i.lazyScoped.get(Tr.Sz).then(function(w){var F;Ha(m,w,s,l,f),0===m?F="regular":2===m?F="drillthrough":1===m?F="tooltip":T.fF.assertFail("unhandled type "+m),i.telemetryService.logEvent(it.Lo,{objectName:De.PageInformationCardName,propertyName:e.name,newValue:F,visualType:"page"}),d.resolve(!1)})):e.name===De.PageSizeTypeName?i.lazyScoped.get(Tr.Sz).then(function(w){Wa(e.value,u,i.eventBridge,w,c),d.resolve(!1)}):e.name===De.PageSizeWidthName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Le.qHu,{width:parseInt(y,10),height:u.height,displayOption:c}),d.resolve(!1)):e.name===De.PageSizeHeightName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Le.qHu,{width:u.width,height:parseInt(y,10),displayOption:c}),d.resolve(!1)):t===De.PageBackgroundCardName?(ar("UpdateCanvasBackground",t,e,r,i),d.resolve(!0)):t===De.OutspaceBackgroundCardName?(ar("UpdateOutspaceBackground",t,e,r,i),d.resolve(!0)):t===De.OutspacePaneCardName?(ar("UpdateOutspacePaneBackground",t,e,r,i),d.resolve(!0)):t===De.FilterCardName?(ar("UpdateFilterCard",t,e,r,i),d.resolve(!0)):t===De.DisplayAreaName?(ar("UpdateDisplayAreaAlignment",t,e,r,i),d.resolve(!0)):t===De.PageRefreshCardName?(ar("UpdatePageRefresh",t,e,r,i),(y=e.value)&&i.telemetryService.logEvent(it.Lo,{objectName:De.PageRefreshCardName,propertyName:e.name,newValue:y.toString(),visualType:"page"}),d.resolve(!0)):t===De.PersonalizeVisual&&(ar("UpdatePersonalizeVisual",t,e,r,i),C="applyToAllPages"in e.type&&!(null===(a=e.type)||void 0===a||!a.applyToAllPages),N=!C&&("reference"in e.type&&null!==(o=e.type.reference)&&void 0!==o&&o.perspective?""===e.value:!(!("revertToDefault"in e.type)||!e.type.revertToDefault)||void 0),i.telemetryService.logEvent(it.gW,{isDefault:N,isApplyToAllPages:C}),d.resolve(!0)),[2,d.promise]})})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Zo.t),q.\u0275\u0275inject(es.C),q.\u0275\u0275inject(os.Z),q.\u0275\u0275inject(ss.C),q.\u0275\u0275inject(Et.i),q.\u0275\u0275inject(_a.r),q.\u0275\u0275inject(jt.D),q.\u0275\u0275inject(Ir.O),q.\u0275\u0275inject(La.J),q.\u0275\u0275inject(qi.U),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(wr),q.\u0275\u0275inject(Pa.U),q.\u0275\u0275inject(ur.H),q.\u0275\u0275inject(ls.e),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(ns),q.\u0275\u0275inject(Ea.l6),q.\u0275\u0275inject(Ba.j),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(br.f),q.\u0275\u0275inject(zr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(Cr.A),q.\u0275\u0275inject(ja.M),q.\u0275\u0275inject(Ga.t))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ar(n,e,t,r,i){var a=i.explorationNavigation.getCurrentSection();i.undoRedo.register(n,function(){var o=a.objects||{};cr.yr(e,t,o,r),a.objects=o}),i.eventBridge.publishToChannel(Le.H8N,a)}function Wa(n,e,t,r,i){var a=(0,Ft.MO)(n);n===Ge.t.Custom&&0!==i&&(a=e),t.publishToChannel(Le.qHu,a);var o=n===Ge.t.Tooltip;!o&&(1===i||n===Ge.t.Custom)||r.setCanvasDisplay(o?3:1)}function Ha(n,e,t,r,i){e.setSectionType(t,r,n),(i?2===n:null==n||0===n)||e.setCrossReportDrillthrough(t,r,!1,!1)}var wi="editable-container-object-name",cs=function(){function n(){this.referencedDescriptors=[],this.revertToDefaultDescriptors=[],this.revertToDefaultProperties=new Set}return n.prototype.addDescriptors=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(_.isEmpty(t))return this;(e=this.revertToDefaultDescriptors).push.apply(e,t||[]);for(var i=0,a=t;i<a.length;i++){var s=this.getDescriptorString(a[i]);this.revertToDefaultProperties.add(s)}return this},n.prototype.getDescriptors=function(){return this.revertToDefaultDescriptors},n.prototype.getDescriptorString=function(e){return"".concat(e.objectName,"-").concat(e.propertyName)},n.prototype.hasDescriptor=function(e){var t=this.getDescriptorString(e);return this.revertToDefaultProperties.has(t)},n.prototype.hasDescriptors=function(){return!_.isEmpty(this.revertToDefaultDescriptors)},n.prototype.addReferencedDescriptor=function(e){this.referencedDescriptors.push(e)},n.prototype.validateRevertToDefaultDescriptors=function(){if(this.hasDescriptors())for(var t=0,r=this.referencedDescriptors;t<r.length;t++){var i=r[t];this.hasDescriptor(i)||T.fF.assertFail("Descriptor '".concat(this.getDescriptorString(i),"' is missing from RevertToDefault"))}},n}(),Ka=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,C,N,D,w){this.propertyChangeIndicatorService=e,this.analyticsFormattingService=i,this.canvasItemFormattingService=a,this.conditionalFormattingService=o,this.contextActivityService=s,this.featureSwitchService=l,this.localizationService=u,this.pageFormattingService=c,this.visualFormattingService=d,this.containerSelectionChangedSubject=new Er.xQ,this.selectedContainerItems=new Map,this.selectedListEditorItems=new Map,this.saveServices={contextActivityService:s,explorationNavigation:t,featureSwitchService:l,layoutAuthoring:r,localizationService:u,resourceLoader:v,resourceRegistration:h,telemetryService:f,themeService:m,undoRedo:y,visualAuthoring:C,visualPlugin:N,visualStylePresetService:D,visualSync:w,trustedVisualService:g}}return n.prototype.getFormattingOptions=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,s,l;return(0,p.Jh)(this,function(c){switch(c.label){case 0:switch(t){case"Visual":return[3,1];case"Format_Label_General":return[3,3];case"Page":return[3,5];case"Analytics":return[3,7]}return[3,9];case 1:return[4,this.visualFormattingService.getFormattingModel(e)];case 2:return r=c.sent(),i=this.visualFormattingService.getObjectDescriptors(e),a=this.visualFormattingService.getFormatPaneSliceTransform(e),[3,10];case 3:return[4,this.canvasItemFormattingService.getFormattingModel(e)];case 4:return r=c.sent(),i=this.canvasItemFormattingService.getObjectDescriptors(e),a=this.canvasItemFormattingService.getFormatPaneSliceTransform(e),[3,10];case 5:return[4,this.pageFormattingService.getFormattingModel()];case 6:return r=c.sent(),i=this.pageFormattingService.getObjectDescriptors(),a=this.pageFormattingService.getFormatPaneSliceTransform(),[3,10];case 7:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 8:return r=c.sent(),i=this.analyticsFormattingService.getObjectDescriptors(e),a=this.analyticsFormattingService.getFormatPaneSliceTransform(e),[3,10];case 9:T.fF.assertNever(t),c.label=10;case 10:return s={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:e?new dr.lD(e,function(d){return d===e||d&&e&&e.name===d.name}):void 0},r?(l=this.getObjectDefinitions(t,e),[4,this.updateFormattingContract(e,{objectDefinitions:l,objectDescriptors:i,originSource:t},r,a,s,t)]):[2,s];case 11:return c.sent(),[2,s]}})})},n.prototype.getRevertToDefaultMetadata=function(e,t){if(!t)return{formattingSettingsString:void 0,itemTypeDisplayName:void 0};switch(t){case"Visual":return this.visualFormattingService.getRevertToDefaultMetadata(e);case"Format_Label_General":return this.canvasItemFormattingService.getRevertToDefaultMetadata(e);case"Page":return this.pageFormattingService.getRevertToDefaultMetadata();case"Analytics":return this.analyticsFormattingService.getRevertToDefaultMetadata(e);default:T.fF.assertNever(t)}},n.prototype.getContainerChanged$=function(){return this.containerSelectionChangedSubject.asObservable()},n.prototype.updateFormattingContract=function(e,t,r,i,a,o){var s;return(0,p.mG)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,C=this;return(0,p.Jh)(this,function(N){switch(N.label){case 0:l=[],u=i,c=o,d=[],v=0,h=function(w){var F,V,I,j,L,x,z,P,A,G,X,te,Y,ne,Se,Ue;return(0,p.Jh)(this,function(Ke){switch(Ke.label){case 0:return V=t,I=new cs,(0,S.Qu)(w)?[4,f.resolvePlaceholder(w,e)]:[3,2];case 1:if(!(j=Ke.sent()))return[2,"continue"];if(F=j.item,V={objectDescriptors:j.objectDescriptors,objectDefinitions:f.getObjectDefinitions(L=j.originSource,e),originSource:L},x=j.revertToDefaultDescriptors){for(z=[],P=0,A=x;P<A.length;P++)z.push((0,p.pi)((0,p.pi)({},A[P]),{originSource:L}));I.addDescriptors.apply(I,z)}return[3,3];case 2:(F=w).analyticsPane&&(V=(0,p.pi)((0,p.pi)({},V),{originSource:"Analytics"})),I.addDescriptors.apply(I,(null!==(s=F.revertToDefaultDescriptors)&&void 0!==s?s:[]).map(function(Ae){return(0,p.pi)((0,p.pi)({},Ae),{originSource:V.originSource})})),Ke.label=3;case 3:return G=ae.LF(F.uid,c),X=r.warnings,te=r.warnings$,[4,f.getFormattingGroupsContract(e,V,F.groups,f.getDisabledState(F.topLevelToggle),G,F.displayName,i,void 0,void 0,I,X,o,[])];case 4:return Y=Ke.sent(),ne=F.topLevelToggle?f.getSimpleFormattingSlice(e,V,F.topLevelToggle,!!F.disabled,F.displayName,u,void 0,I,X):void 0,Se=I.getDescriptors(),d.push.apply(d,Se),Ue=(0,p.pi)((0,p.pi)({},F),{pivotSource:c,uid:G,warningMessage:f.getCardWarning(X,F,Y,ne),warningMessage$:te&&te.pipe((0,pe.U)(function(Ae){return C.getCardWarning(Ae,F,Y,ne)})),topLevelToggle:ne?(0,p.pi)((0,p.pi)({},ne),{isTopLevelToggle:!0,originSource:V.originSource}):void 0,revertToDefaultDescriptors:Se,originSource:V.originSource,index:v++,groupUids:Y.map(function(Ae){return Ae.uid}),groups:Y}),l.push(Ue),I.validateRevertToDefaultDescriptors(),[2]}})},f=this,m=0,g=r.cards,N.label=1;case 1:return m<g.length?[5,h(g[m])]:[3,4];case 2:N.sent(),N.label=3;case 3:return m++,[3,1];case 4:return this.normalize(l,a),a.revertToDefaultDescriptors=d,[2]}})})},n.prototype.normalize=function(e,t){for(var r,i,a=0,o=0,s=e;o<s.length;o++){var l=s[o];t.cards[l.uid]=l;for(var u=l.originSource,c=function(m){for(var y=[],C=0,N=m.slices?(0,p.ev)([],m.slices,!0):[];C<N.length;C++){var D=N[C],w=(0,ir.O7)(D),F=(0,ir.$Q)(D.uid,w);t.slices[F]&&(D.uid="".concat(D.uid,"___").concat(a++,"___"),F=(0,ir.$Q)(D.uid,w));var V=(0,p.pi)((0,p.pi)({},D),{groupUid:m.uid,originSource:null!==(r=D.originSource)&&void 0!==r?r:u});t.slices[F]=V;for(var j=0,L=(0,S.IW)(V)?ae.ce(V):[V];j<L.length;j++){var x=L[j],z=ae.zh(x.control.properties.descriptor);t.slices[z]=x}y.push({uid:V.uid,selector:w})}delete m.slices,T.fF.assert(function(){return!t.groups[m.uid]},"duplicate group uid ".concat(m.uid)),t.groups[m.uid]=(0,p.pi)((0,p.pi)({},m),{originSource:null!==(i=m.originSource)&&void 0!==i?i:u,sliceIds:y})},d=0,v=l.groups;d<v.length;d++)c(v[d]);delete l.groups}},n.prototype.getModelUnavailableInformation=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getModelUnavailableInformation(t);case"Format_Label_General":return this.canvasItemFormattingService.getModelUnavailableInformation(t);case"Page":return{messageKey:void 0};case"Analytics":return this.analyticsFormattingService.getModelUnavailableInformation(t);default:T.fF.assertNever(e)}},n.prototype.getFormattingModelMessage=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getFormattingModelMessage(t);case"Format_Label_General":case"Page":case"Analytics":return;default:T.fF.assertNever(e)}},n.prototype.getObjectDefinitions=function(e,t,r){switch(e){case"Visual":return this.visualFormattingService.getObjectDefinitions(t,r);case"Format_Label_General":return this.canvasItemFormattingService.getObjectDefinitions(t,r);case"Page":return this.pageFormattingService.getObjectDefinitions();case"Analytics":return this.analyticsFormattingService.getObjectDefinitions(t,r);default:T.fF.assertNever(e)}},n.prototype.getRevertToDefaultEnabled=function(e,t,r){if(_.isEmpty(t))return!1;var i=_.groupBy(t,function(u){return u.originSource}),a=!1;for(var o in i){var s=o;switch(s){case"Visual":case"Format_Label_General":var l=this.getObjectDefinitions(s,e,!0);a=ae.wW(t,l,r,this.featureSwitchService.featureSwitches.onObject);break;case"Page":a=this.pageFormattingService.getRevertToDefaultEnabled(t,r);break;case"Analytics":a=this.analyticsFormattingService.getRevertToDefaultEnabled(e,t??[],r);break;default:T.fF.assertNever(s)}if(a)break}return a},n.prototype.getSliceShowChangeIndicator=function(e,t,r){var i=t.originSource;switch(i){case"Visual":case"Format_Label_General":case"Page":return this.shouldShowSliceChangeIndicator(e,t,r);case"Analytics":return this.analyticsFormattingService.shouldShowSliceChangeIndicator();default:T.fF.assertNever(i)}},n.prototype.shouldShowSliceChangeIndicator=function(e,t,r){var a=this.getObjectDefinitions(t.originSource,e,!0);return this.propertyChangeIndicatorService&&this.propertyChangeIndicatorService.shouldShowSliceChangeIndicator(r,a)},n.prototype.getCardWarning=function(e,t,r,i){var a;if(e){var o=e[t.uid];o&&!(o instanceof ea.L)&&(a=o)}if(i&&i.warningMessage&&(a=i.warningMessage.source),!a){var s=r.find(function(l){return!!l.warningMessage});s&&s.warningMessage&&(a=s.warningMessage.source)}if(a)return Or(a,this.localizationService,!0)},n.prototype.getGroupWarning=function(e,t){var r;if(t&&t.warningMessage&&(r=t.warningMessage.source),!r){var i=e.find(function(a){return!!a.warningMessage});i&&(r=i.warningMessage.source)}if(r)return Or(r,this.localizationService,!0)},n.prototype.getSliceWarning=function(e,t,r){if(e.conditionalFormattingWarning)return e.conditionalFormattingWarning;var i=this.getWarningForDescriptor(r,t);return i?Or(i,this.localizationService):void 0},n.prototype.resolvePlaceholder=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r;return(0,p.Jh)(this,function(i){switch(i.label){case 0:return(0,S.Dw)(e)?[4,this.canvasItemFormattingService.resolvePlaceholder(e,t)]:[3,2];case 1:return[2,(r=i.sent())?(0,p.pi)((0,p.pi)({},r),{originSource:"Format_Label_General"}):void 0];case 2:if((0,S.d5)(e))return[2,(r=this.visualFormattingService.resolvePlaceholder(e,t))?(0,p.pi)((0,p.pi)({},r),{originSource:"Visual"}):void 0];T.fF.assertFail("Unexpected placeholder type"),i.label=3;case 3:return[2]}})})},n.prototype.getFormattingGroupsContract=function(e,t,r,i,a,o,s,l,u,c,d,v,h){var f;return(0,p.mG)(this,void 0,void 0,function(){var m,g,y,C,N,D,w,F;return(0,p.Jh)(this,function(I){switch(I.label){case 0:m=[],g=s,y=_.cloneDeep(h),N=function(L){var x,z,P,A,E,G,X,te,Y,Se,Ue,Ke,Ae,me,Ie,mt,pt,Jt,gt,Dt,kr;return(0,p.Jh)(this,function(Qt){switch(Qt.label){case 0:return z=t,(0,S.Qu)(L)?[4,D.resolvePlaceholder(L,e)]:[3,2];case 1:if(!(P=Qt.sent()))return[2,"continue"];if(x=P.item,A=P.originSource,E=P.objectDescriptors,G=P.revertToDefaultDescriptors){for(X=[],te=0,Y=G;te<Y.length;te++)X.push((0,p.pi)((0,p.pi)({},Y[te]),{originSource:A}));c.addDescriptors.apply(c,X)}return z={objectDescriptors:E,objectDefinitions:D.getObjectDefinitions(A,e),originSource:A},[3,3];case 2:x=L,Qt.label=3;case 3:return C=x.displayName?"".concat(o," - ").concat(x.displayName):"".concat(o),Se=[],Ue=[],Ke=null===(f=x.inheritDisabled)||void 0===f||f,Ae=Ke&&i||x.disabled,me=z.originSource,Ie=x.topLevelToggle?D.getSimpleFormattingSlice(e,z,x.topLevelToggle,Ae,C,g,void 0,c,d):void 0,x.topLevelToggle=Ie,x.container&&x.container.containerItems.length>0?[4,D.convertFormattingContainers(e,z,x.container,a,x.uid,Ae||D.getDisabledState(x.topLevelToggle),s,C,x.containerDisabled,c,d,v,h)]:[3,5];case 4:mt=Qt.sent(),Se=mt.slices,Ue=mt.groups,Qt.label=5;case 5:return x.container=void 0,[4,D.getFormattingSliceContracts(e,z,x.slices,Ae||D.getDisabledState(x.topLevelToggle),C,s,u,c,d,x.uid,v)];case 6:return pt=Qt.sent(),Jt=!!x.displayName&&(!!_.isUndefined(x.collapsible)||x.collapsible),gt=_.concat(pt,Se),Dt=D.getGroupWarning(gt,Ie),kr=(0,p.pi)((0,p.pi)({},x),{collapsible:Jt,disableInteractivity:l?.disableInteractivity,warningMessage:Dt,disabled:Ae,originSource:me,cardUid:a,pivotSource:v,sliceIds:gt.map(function(Pe){return{uid:Pe.uid,selector:(0,ir.O7)(Pe)}}),slices:gt,parentContainers:y,topLevelToggle:Ie?(0,p.pi)((0,p.pi)({},Ie),{isTopLevelToggle:!0,originSource:me}):void 0}),m.push(kr),m=_.concat(m,Ue),T.fF.assert(function(){return x.sliceWithContainer||!(pt.length>0&&Se.length>0)},"we don't have proper UI for supporting containers and slices in same group"),[2]}})},D=this,w=0,F=r,I.label=1;case 1:return w<F.length?[5,N(F[w])]:[3,4];case 2:I.sent(),I.label=3;case 3:return w++,[3,1];case 4:return[2,m]}})})},n.prototype.convertFormattingContainers=function(e,t,r,i,a,o,s,l,u,c,d,v,h){return(0,p.mG)(this,void 0,void 0,function(){var f,m,g,y,C,N,D,w,F,V,I,j,L,x,z,P;return(0,p.Jh)(this,function(A){switch(A.label){case 0:if(r.containerItems.length<=0)return[2];f=[],m=this.getContainerDropdownDescriptor(i,r.uid,r.isEditable),g=m.propertyName,r.isEditable?(V=r.containerItems.map(function(E,G){return{displayName:E.displayName,value:G,uid:E.uid}}),y=this.getSelectedListEditorItemIndex(g),V=_.filter(V,function(E){return!_.isEmpty(E.displayName)}),_.isEmpty(V)&&(y=0),C={displayName:r.displayName,disabled:o,control:{type:"ListEditor",properties:{descriptor:(0,p.pi)((0,p.pi)({},m),{type:{}}),value:{items:V,selectedItem:V[y]}}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,pivotSource:v,groupUid:a},f.push(C)):(N=this.getSelectedContainerItemName(g),V=r.containerItems.map(function(E,G){var X={displayName:E.displayName,value:E.displayName,icon:E.icon?{glyph:E.icon}:void 0};return 0===G&&(w=X,F=0),E.defaultSelected&&(w=X,F=G),(0===G&&null===N||N===E.displayName)&&(D=X),X}),(y=_.findIndex(r.containerItems,function(E){return E.displayName===N}))<0&&(y=F,D=w),I={displayName:r.displayName,disabled:o||!!u,control:{type:"Dropdown",properties:{descriptor:(0,p.pi)((0,p.pi)({},m),{type:{}}),items:V,value:D}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,groupUid:a,pivotSource:v},f.push(I)),j=[],L=this.featureSwitchService.featureSwitches.onObject,x=function(G){var X,te,ne,Se,Ue,Ke,Ae,me,Ie,mt,pt,Jt;return(0,p.Jh)(this,function(gt){switch(gt.label){case 0:return L||G===y?(te=G!==y,ne=(X=r.containerItems[G]).disabled,Se=o||ne,Ue=(0,p.ev)((0,p.ev)([],h,!0),[{containerName:g,value:X.displayName}],!1),Ke={groups:[],slices:[]},X.container?[4,z.convertFormattingContainers(e,t,X.container,i,X.container.uid,o,s,l,u,c,d,v,Ue)]:[3,2]):[2,"continue"];case 1:Ke=gt.sent(),gt.label=2;case 2:return(Ae=X.slices)?[4,z.getFormattingSliceContracts(e,t,Ae,Se,l,s,r.displayName,c,d,a,v)]:[3,4];case 3:return Ie=gt.sent(),[3,5];case 4:Ie=[],gt.label=5;case 5:return me=(me=Ie).concat(Ke.slices),f=_.concat(f,_.map(me,function(Dt){return(0,p.pi)((0,p.pi)({},Dt),{hidden:Dt.hidden||te})})),(mt=X.groups)?[4,z.getFormattingGroupsContract(e,t,mt,Se,i,l,s,ne?{disableInteractivity:!0,collapsed:!0}:void 0,r.displayName,c,d,v,Ue)]:[3,7];case 6:return Jt=gt.sent(),[3,8];case 7:Jt=[],gt.label=8;case 8:return pt=(pt=Jt).concat(Ke.groups),j=_.concat(j,_.map(pt,function(Dt){return(0,p.pi)((0,p.pi)({},Dt),{uid:L?(0,ir.aO)(Dt.uid,G):Dt.uid,hidden:te||Dt.hidden})})),[2]}})},z=this,P=0,A.label=1;case 1:return P<r.containerItems.length?[5,x(P)]:[3,4];case 2:A.sent(),A.label=3;case 3:return P++,[3,1];case 4:return[2,{slices:f,groups:j}]}})})},n.prototype.getSelectedContainerItemName=function(e){return this.selectedContainerItems.has(e)||this.selectedContainerItems.set(e,null),this.selectedContainerItems.get(e)},n.prototype.getSelectedListEditorItemIndex=function(e){return this.selectedListEditorItems.has(e)||this.selectedListEditorItems.set(e,0),this.selectedListEditorItems.get(e)},n.prototype.getContainerDropdownDescriptor=function(e,t,r){return{objectName:r?wi:ae.nB,propertyName:e+"-"+t+"-container"}},n.prototype.getFormattingSliceContracts=function(e,t,r,i,a,o,s,l,u,c,d){return(0,p.mG)(this,void 0,void 0,function(){var v,h,f,m,g,y,C,N,D,w,F,V,j;return(0,p.Jh)(this,function(L){switch(L.label){case 0:if(!r)return[2,[]];v=[],h=0,f=r,L.label=1;case 1:return h<f.length?(g=void 0,y=t,(0,S.Qu)(m=f[h])?[4,this.resolvePlaceholder(m,e)]:[3,3]):[3,6];case 2:if(!(C=L.sent()))return[3,5];if(g=C.item,y={objectDescriptors:C.objectDescriptors,objectDefinitions:this.getObjectDefinitions(N=C.originSource,e),originSource:C.originSource},D=C.revertToDefaultDescriptors){for(w=[],F=0,V=D;F<V.length;F++)w.push((0,p.pi)((0,p.pi)({},V[F]),{originSource:N}));l.addDescriptors.apply(l,w)}return[3,4];case 3:g=m,L.label=4;case 4:(j=this.getFormattingSliceContract(e,y,g,i,a,o,s,l,u,c,d))&&v.push(j),L.label=5;case 5:return h++,[3,1];case 6:return[2,v]}})})},n.prototype.getDisabledState=function(e){return!!e&&!e.control.properties.value},n.prototype.getFormattingSliceContract=function(e,t,r,i,a,o,s,l,u,c,d){var v;if((0,S.IW)(r)){var f=this.getCompositeFormattingSlice(e,t,r,i,o,l,u);f&&(v=(0,p.pi)((0,p.pi)({},f),{pivotSource:d,groupUid:c}))}else{var g=this.getSimpleFormattingSlice(e,t,r,i,a,o,s,l,u);g&&(v=(0,p.pi)((0,p.pi)({},g),{pivotSource:d,groupUid:c}))}return v},n.prototype.getSimpleFormattingSlice=function(e,t,r,i,a,o,s,l,u){var c=t.objectDescriptors,d=t.originSource,v=r.control.properties.descriptor;_.isEmpty(v.propertyName)||l.addReferencedDescriptor((0,p.pi)((0,p.pi)({},v),{originSource:d}));var h=ae.w7(v,c),f=this.getTypeFromObjectDescriptor(v,h),g=o(r,c,{conditionalFormattingDisplayName:a,containerSliceDisplayName:s,formattingDescriptor:v,formattingModelWarnings:u,formattingObjectOptions:t,propertyDescriptor:h,type:f,canvasItem:e});if(g){var y=this.getSliceShowChangeIndicator(e,t,v),C=this.getFormattingDescriptorContract({formattingDescriptor:v,type:f}),N=this.getSliceWarning(g,v,u),D=g.control,w=(0,p.pi)((0,p.pi)({},D),{properties:(0,p.pi)((0,p.pi)({},D.properties),{descriptor:C})});return(0,p.pi)((0,p.pi)({},g),{disabled:i||g.disabled,control:w,warningMessage:N,showChangeIndicator:y,originSource:d})}},n.prototype.getCompositeFormattingSlice=function(e,t,r,i,a,o,s){var l=t.objectDescriptors,u=t.originSource;if(r=a(r,l,void 0)){var c=r.control;T.fF.assertValue(r.displayName,"Composite controls must specify a display name");var d,v=!1,h=c.properties,f={};for(var m in h){var g=m,y=h[g];if(y){var C=y.descriptor;_.isEmpty(C.propertyName)||o.addReferencedDescriptor((0,p.pi)((0,p.pi)({},C),{originSource:u}));var N=ae.w7(y.descriptor,l),D=y.descriptor;!v&&this.getSliceShowChangeIndicator(e,t,D)&&(v=!0);var w=this.getTypeFromObjectDescriptor(D,N),F=this.getFormattingDescriptorContract({formattingDescriptor:D,type:w});d=d||this.getSliceWarning(r,D,s),f[g]=(0,p.pi)((0,p.pi)({},y),{descriptor:F})}}var V=(0,p.pi)((0,p.pi)({},c),{properties:f});return(0,p.pi)((0,p.pi)({},r),{disabled:i||r.disabled,control:V,warningMessage:d,showChangeIndicator:v,originSource:u})}},n.prototype.getWarningForDescriptor=function(e,t){if(e){var r=e[t.objectName];if(r){var i=this.conditionalFormattingService.getDataBoundExprWarning(r,t);if(i)return i;if(this.featureSwitchService.featureSwitches.onObject){var a=r.propertyName;if(a&&a===t.propertyName)return r}}}},n.prototype.getFormattingDescriptorContract=function(e){var r=e.type;return(0,p.pi)((0,p.pi)({},e.formattingDescriptor),{type:r})},n.prototype.getTypeFromObjectDescriptor=function(e,t){var r,i=(0,Fe.sH)(t?.type||{},e.propertyTypes),a=null===(r=t?.type)||void 0===r?void 0:r.variant;return a&&(i=(0,p.pi)((0,p.pi)({},i),{variant:a})),i},n.prototype.createSaveFormattingSlicesActivity=function(e){return this.contextActivityService.createActivity((0,p.pi)({name:"Save Formatting Slices"},e))},n.prototype.createChangeFormatActivity=function(e,t,r,i,a,o,s){return s.createChildActivity({name:"Change Format",data:(0,p.pi)({propertyName:a,objectName:i},o),visualName:e,visualType:t,uid:r})},n.prototype.revertToDefault=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f;return(0,p.Jh)(this,function(g){switch(g.label){case 0:if(t)for(i=0,a=Array.from(this.selectedContainerItems.keys());i<a.length;i++)(o=a[i]).startsWith(t)&&this.selectedContainerItems.delete(o);else this.selectedContainerItems.clear();for(c in s=_.groupBy(e,function(y){return y.originSource}),u=[],l=s)u.push(c);d=0,g.label=1;case 1:if(!(d<u.length))return[3,10];if(!((c=u[d])in l))return[3,9];switch(f=s[v=c],h=v){case"Page":return[3,2];case"Analytics":return[3,4];case"Visual":return[3,5];case"Format_Label_General":return[3,6]}return[3,8];case 2:return[4,this.pageFormattingService.revertPageSliceDefinitions(f)];case 3:return g.sent(),[3,9];case 4:return this.analyticsFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 5:return this.visualFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 6:return[4,this.canvasItemFormattingService.revertVisualSlicesToDefinitions(f,r)];case 7:return g.sent(),[3,9];case 8:T.fF.assertNever(h),g.label=9;case 9:return d++,[3,1];case 10:return[2]}})})},n.prototype.changeContainerDropdownValue=function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];this.selectedContainerItems.set(a.containerName,a.value)}this.containerSelectionChangedSubject.next({canvasItems:t})},n.prototype.saveFormattingSlicesValue=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,c,d,v,h,f,m,g,y;return(0,p.Jh)(this,function(C){switch(C.label){case 0:i=this.createSaveFormattingSlicesActivity(t),C.label=1;case 1:return C.trys.push([1,7,,8]),a=[],"No Telemetry"!==t.source&&((o=null===(r=e[0].canvasItems)||void 0===r?void 0:r[0])?(0,Uo.v)(o,this.saveServices.visualPlugin,this.saveServices.trustedVisualService)||(a=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o)):"Pane"===t.source&&(a=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o))),1===_.size(e)&&e[0].objectName===ae.nB?(this.changeContainerDropdownValue([{containerName:(d=(c=e[0]).propertySlice).name,value:d.value}],v=c.canvasItems),[2]):1===_.size(e)&&e[0].objectName===wi?(d=(c=e[0]).propertySlice,v=c.canvasItems,this.isEditableContainerWithSelectionChangeOnly(e)&&this.containerSelectionChangedSubject.next({canvasItems:v}),h=d.value,f=_.filter(h.items,function(N){var D;return!_.find(null===(D=h.itemUpdates)||void 0===D?void 0:D.deletes,function(w){return w.displayName===N.displayName})}),m=_.isEmpty(f)?0:_.findIndex(f,function(N){return _.isEqual(N.value,h.selectedItem.value)}),T.fF.assert(function(){return m>=0},"Expect the selected index of EditableContainer always >=0"),[4,this.saveProperties(e,i)]):[3,3];case 2:return C.sent(),m>=0&&this.selectedListEditorItems.get(d.name)!==m&&this.selectedListEditorItems.set(d.name,m),[2];case 3:return C.trys.push([3,5,,6]),[4,this.saveProperties(e,i)];case 4:return C.sent(),a.forEach(function(N){return N.resolve()}),[3,6];case 5:throw g=C.sent(),a.forEach(function(N){return N.reject(g)}),g;case 6:return i.resolve(),[3,8];case 7:throw y=C.sent(),i.reject(y),y;case 8:return[2]}})})},n.prototype.createChangeFormatContextActivitiesFromChanges=function(e,t,r,i){var a=this;return e.map(function(o){var s,l,u=o.objectName,c=null===(s=o.propertySlice)||void 0===s?void 0:s.name,d=null!==(l=i?.name)&&void 0!==l?l:void 0,v=i&&(0,Zr.s)(i);return a.createChangeFormatActivity(d,v,o.uid,u,c,t,r)})},n.prototype.isEditableContainerWithSelectionChangeOnly=function(e){var t,r,i;if(_.size(e)>1||e[0].objectName!==wi)return!1;var a=e[0].propertySlice,o=a.value;return!!(_.isEmpty(null===(t=o.itemUpdates)||void 0===t?void 0:t.adds)&&_.isEmpty(null===(r=o.itemUpdates)||void 0===r?void 0:r.deletes)&&_.isEmpty(null===(i=o.itemUpdates)||void 0===i?void 0:i.renames))&&this.selectedListEditorItems.get(a.name)!==_.findIndex(o.items,function(u){return _.isEqual(u.value,o.selectedItem.value)})},n.prototype.saveProperties=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a,o;return(0,p.Jh)(this,function(s){switch(s.label){case 0:return o=_.partition(e,function(l){return"Page"===l.formattingSource}),r=o[0],i=o[1],_.isEmpty(r)?[3,2]:[4,this.pageFormattingService.saveProperties(r,this.saveServices)];case 1:s.sent(),s.label=2;case 2:return _.isEmpty(i)?[3,4]:(a=i.map(function(l){var u=_.some(Gr,function(c){return l.objectName===c.objectName});return(0,p.pi)((0,p.pi)({},l),{formattingSource:u?"Format_Label_General":l.formattingSource})}),[4,this.saveCanvasProperties(a,t)]);case 3:s.sent(),s.label=4;case 4:return[2]}})})},n.prototype.saveCanvasProperties=function(e,t){return(0,p.mG)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.Jh)(this,function(o){switch(o.label){case 0:return r=_.groupBy(e,function(s){return s.formattingSource}),i=[],this.saveServices.undoRedo.register("SaveFormattingValues",function(){for(var s in r)for(var c=0,d=a.getChangesPerCanvasItem(r[s]);c<d.length;c++){var v=d[c];switch(s){case"Format_Label_General":a.canvasItemFormattingService.saveProperties(v.changes,a.saveServices,v.canvasItem,t);break;case"Visual":a.visualFormattingService.saveProperties(v.changes,a.saveServices,v.canvasItem,t);break;case"Analytics":i.push(a.analyticsFormattingService.saveProperties(v.changes,v.canvasItem,t))}}}),[4,Promise.all(i)];case 1:return o.sent(),[2]}})})},n.prototype.getChangesPerCanvasItem=function(e){var t={},r={};e.forEach(function(o){o.canvasItems.forEach(function(s){var l=s.name;r[l]=s,t[l]||(t[l]=[]);var u=(0,p.pi)({},o);t[l]=(0,p.ev)((0,p.ev)([],t[l],!0),[u],!1)})});var i=[];for(var a in t)i.push({canvasItem:r[a],changes:t[a].map(function(o){return(0,p.pi)((0,p.pi)({},o),{canvasItems:void 0})})});return i},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(ko.Ol,8),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(Pa.U),q.\u0275\u0275inject(pi),q.\u0275\u0275inject(Na),q.\u0275\u0275inject(ci),q.\u0275\u0275inject(_a.r),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Ra),q.\u0275\u0275inject(Ia),q.\u0275\u0275inject(Ea.l6),q.\u0275\u0275inject(Ba.j),q.\u0275\u0275inject(Bt.y0),q.\u0275\u0275inject(br.f),q.\u0275\u0275inject(Ga.t),q.\u0275\u0275inject(zr.z),q.\u0275\u0275inject(ht.$8),q.\u0275\u0275inject(qt.D),q.\u0275\u0275inject(Cr.A),q.\u0275\u0275inject(ja.M))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Wt=b(63057),ps=b(37272),nr=b(82762),Fi=b(38860),ft=b(11547),Ot=b(59973),Ht=b(83317),Vr=b(23558),Ja=b(22318),vs=b(6663),et=b(81905),ds=b(73805),hs=b(91615),fs=b(95281),Kt=b(85732),Mt=b(77526),Lt=function(e){return e},Qa=function(){function n(){}return n.prototype.create=function(){return new qs},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(t){return new(t||n)}}),n}(),qs=function(n){function e(){var t=n.call(this)||this;return t.setState({cards:void 0,groups:void 0,slices:void 0,revertToDefaultDescriptors:[],canvasItem:void 0}),t.state$.pipe((0,Di.q)(1)).subscribe(function(r){T.fF.assert(function(){return void 0===r.cards&&void 0===r.groups&&void 0===r.slices},"FormattingStore: state should be empty")}),t}return(0,p.ZT)(e,n),e.prototype.getViewModel$=function(){return this.select(Lt).pipe((0,Ot.h)(function(t){return!(void 0===t.cards&&void 0===t.groups&&void 0===t.slices)}))},e.prototype.selectAllCards=function(){return this.select((0,Kt.P1)(Lt,function(e){return e.cards}))},e.prototype.selectTopLevelToggle=function(t,r){return this.select(function(e,t){return(0,Kt.P1)(Lt,function(r){var i,a=function(s){return(ae.hy(s.uid,e,(0,ir.O7)(s),t)||ae.zh(s.control.properties.descriptor)===e)&&(i=s,!0)};return r.cards&&Object.keys(r.cards).forEach(function(o){var l=r.cards[o].topLevelToggle;l&&a(l)&&(i=l)}),i||r.groups&&Object.keys(r.groups).forEach(function(o){var l=r.groups[o].topLevelToggle;l&&a(l)&&(i=l)}),i})}(t,r)).pipe((0,Mt.x)(_.isEqual))},e.prototype.selectGroup=function(t){return this.select(function(e){return(0,Kt.P1)(Lt,function(t){return t.groups&&t.groups[e]})}(t)).pipe((0,Mt.x)(_.isEqual))},e.prototype.selectSlice=function(t,r){return this.select(function(e,t){return(0,Kt.P1)(Lt,function(r){var i=(0,ir.$Q)(e,t);return r.slices&&r.slices[i]})}(t,r)).pipe((0,Mt.x)(_.isEqual))},e.prototype.selectCard=function(t){return this.select(function(e){return(0,Kt.P1)(Lt,function(t){return t.cards&&t.cards[e]})}(t)).pipe((0,Mt.x)(_.isEqual))},e.prototype.getChartElementsContract$=function(){var t=this,r=(0,Kt.P1)(Lt,function(i){return t.getChartElementsFormatContract(i)});return this.select(r).pipe((0,Mt.x)(_.isEqual))},e.prototype.getCanvasItem$=function(){var t=(0,Kt.P1)(Lt,function(r){return r.canvasItem});return this.select(t).pipe((0,Mt.x)())},e.prototype.getChartElementsFormatContract=function(t){var r=[];return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&"Visual"===l.pivotSource&&r.push({formattingSource:l.originSource,displayName:l.displayName,description:l.description,checked:l.topLevelToggle.control.properties.value,uid:l.topLevelToggle.uid,descriptor:l.topLevelToggle.control.properties.descriptor,disabled:l.disabled,disabledReason:l.disabledReason,isAnalyticsPane:l.analyticsPane,warningMessage$:l.warningMessage$})}}(t.cards),_.isEmpty(r)?void 0:{items:r}},e.prototype.getCardTopLevelToggleUids$=function(){var t=this,r=(0,Kt.P1)(Lt,function(i){return t.getCardTopLevelToggleUids(i)});return this.select(r).pipe((0,Mt.x)(_.isEqual))},e.prototype.getCardTopLevelToggleUids=function(t){var r=new Set;return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&r.add(l.topLevelToggle.uid)}}(t.cards),r},e}(fs.m1),Cs=b(3307),Ds=b(21024),ws=b(56083),$a=function(){function n(e,t,r){var i=this;this.localizationService=e,this.paneVisibilityService=t,this.tutorialPopupService=r,this.localCache={},this.destroy$=new Er.xQ,this.paneVisibilityService.getPanes$().pipe((0,Cs.T)(1),(0,Ot.h)(function(a){return _.every(Object.values(a),function(o){return!o.isPaneVisible})}),(0,Ht.R)(this.destroy$)).subscribe(function(){i.startFormattingTutorial("PaneMoveTutorial")})}return n.prototype.startFormattingTutorial=function(e,t){switch(e){case"AnalyticsPaneMoveTutorial":this.localCache.AnalyticsPaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getAnalyticsPaneMoveTutorial(t));break;case"FieldPickerTutorial":this.localCache.FieldPickerTutorial||this.tutorialPopupService.startTutorial(this.getFieldPickerTutorial());break;case"DrillthroughTutorial":this.localCache.DrillthroughTutorial||this.tutorialPopupService.startTutorial(this.getDrillthroughPaneMoveTutorial());break;case"PaneMoveTutorial":this.localCache.PaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getPaneMoveTutorial());break;default:T.fF.assertFail("Unknown formatting tutorial type")}this.localCache[e]=!0},n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.getPaneMoveTutorial=function(){var e,t="onObjectPaneMoveTutorial",r='ribbon [data-unique-id="view"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Title"),text:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.prototype.getAnalyticsPaneMoveTutorial=function(e){var t;T.fF.assertAnyValue(!!e,"options should be provided in the case of AnalyticsPaneMoveTutorial");var r="onObjectAnalyticsFormattingTutorial",i=e.selector;return{itemKeys:[r],items:(t={},t[r]={title:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Title"),text:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:r,canShow:function(){return!!$(i)},attachTo:function(){return $(i)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,offset:e.offset,arrowOffset:e.arrowOffset,closeOnBackdropClick:!0},t),isSequentialTutorial:!1}},n.prototype.getFieldPickerTutorial=function(){var e,t="onObjectFieldPickerTutorial",r="build-field-well field-picker-modern pbi-drag-drop-picker span div.selfAndChildrenContent";return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_FieldWell_Title"),text:this.localizationService.get("TutorialPopup_FieldWell_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r).first()},attachTo:function(){return $(r).first()},customClass:"trident no-icon big-popup",modalButtonClassOverride:"hidden",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.prototype.getDrillthroughPaneMoveTutorial=function(){var e,t="onObjectDrillthroughTutorial",r='[data-unique-id="Page-pageInformation"] [data-testid="formatting-card-button"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Title"),text:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(Ds.r),q.\u0275\u0275inject(ws.yU))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Ni(n){return void 0!==n?_.omit(n,"deferredStatus"):void 0}function Ns(n,e){return void 0!==n?(0,p.pi)((0,p.pi)({},n),{deferredStatus:e}):void 0}var Ti="page",Vi=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v){this.sliceCustomizationService=e,this.eventBridge=t,this.explorationNavigationService=r,this.explorationCapabilities=i,this.featureSwitchService=a,this.formattingModelService=o,this.formattingStoreFactory=s,this.formattingTutorialService=l,this.runningVisual=u,this.selectionService=c,this.visualPluginOperationsService=d,this.visualPluginService=v,this.updateCounter=0,this.currentUpdateIds=new Map,this.formattingStores=new Map,this.destroy$=new Er.xQ;var h=this.selectionService.selectedElements$.pipe((0,pe.U)(function(f){var m;return null!==(m=f?.reduce(function(g,y){var C=y.canvasItem;return C&&g.push(C),g},[]))&&void 0!==m?m:[]}),(0,hr.d)(1));this.initUpdateHandlers(h),this.initPauseHandlers(h)}return n.prototype.initUpdateHandlers=function(e){var h,t=this,r=function(){t.updateStateInt(t.getNonVisualUpdateSources(),void 0)},a=function(A){A.forEach(function(E){return function(A){t.updateStateInt(t.getVisualUpdateSources(),A)}(E)})},o=this.formattingModelService.getContainerChanged$().pipe((0,pe.U)(function(P){return P.canvasItems})),s=this.eventBridge.on(Le.wAN),l=this.eventBridge.on(Le.WJC).pipe((0,Ot.h)(function(P){return!!P.allowInlineExplorationChanged})),u=this.eventBridge.on(Le.TTT),c=this.eventBridge.on(Le.jsX),d=this.explorationNavigationService.sections$,v=this.eventBridge.on(hs.kx);(0,Wt.T)(s,l,u,c,d,v,o.pipe((0,Ot.h)(function(P){return _.isEmpty(P)}))).pipe((0,Ht.R)(this.destroy$)).subscribe(function(){void 0===h&&(h=setTimeout(function(){r(),clearTimeout(h),h=void 0},100))});var I,m=this.eventBridge.on(Le.Of1).pipe((0,Vr.M)(e),(0,pe.U)(function(P){var A=P[0];return P[1].filter(function(G){return(0,J.Vz)(G)&&A.affectContainer(G)})})),g=this.eventBridge.on(Le.jCS).pipe((0,Vr.M)(e),(0,pe.U)(function(P){var A=P[0];return P[1].filter(function(G){return(0,J.Vz)(G)&&A.affectContainer(G)&&(0,rr.LR)(t.visualPluginService,t.visualPluginOperationsService,G)})})),y=(0,Wt.T)(g,m),C=this.eventBridge.on(Le.D1A),N=this.eventBridge.on(Le.DSN),D=(0,Wt.T)(C,N).pipe((0,Ht.R)(this.destroy$),(0,pe.U)(function(P){return[P]})),w=this.eventBridge.on(Le.KD7).pipe((0,pe.U)(function(P){return P.changedItems})),F=e.pipe((0,Ht.R)(this.destroy$),(0,Ja.O)([]),(0,vs.G)(),(0,pe.U)(function(P){var G=_.difference(P[1],P[0]);return _.isEmpty(G)?[]:G})),V=new Map;(0,Wt.T)(y,w,o,F,D).pipe((0,Ht.R)(this.destroy$),(0,Ot.h)(function(P){return!_.isEmpty(P)})).subscribe(function(P){P.forEach(function(A){V.set(A.name,A)}),void 0===I&&(I=setTimeout(function(){a(Array.from(V.values())),V.clear(),clearTimeout(I),I=void 0},100))}),this.destroy$.subscribe(function(){void 0!==I&&(clearTimeout(I),I=void 0),void 0!==h&&(clearTimeout(h),h=void 0)});var L=this.eventBridge.on(Le.CCe),x=this.eventBridge.on(Le.$$f);(0,Wt.T)(L,x).pipe((0,Ht.R)(this.destroy$)).pipe((0,Vr.M)(e)).subscribe(function(P){var E=P[1];r(),a(E)})},n.prototype.initPauseHandlers=function(e){var t=this,r=e.pipe((0,pe.U)(function(o){return o.reduce(function(s,l){return s.push(l.name),s},[])})),i=this.eventBridge.on(Le.KD7).pipe((0,Ht.R)(this.destroy$)),a=this.eventBridge.on(Le.D1A).pipe((0,Ht.R)(this.destroy$));i.pipe((0,Vr.M)(r)).subscribe(function(o){var l=o[1],c=o[0].changedItems.filter(function(v){return!(0,rr.LR)(t.visualPluginService,t.visualPluginOperationsService,v)}).map(function(v){return v.name}),d=_.intersection(l,c);_.isEmpty(d)||t.pauseUpdatesForVisualContainers(d)}),a.subscribe(function(o){t.pauseUpdatesPromise&&t.resumeUpdateForVisualContainers([o.name])}),r.subscribe(function(o){var s=new Set(o);if(Array.from(t.formattingStores.keys()).forEach(function(f){if(!s.has(f)&&f!==Ti){var m=t.formattingStores.get(f);t.formattingStores.delete(f),m.ngOnDestroy()}}),t.pauseUpdatesPromise){for(var c=[],d=0,v=Array.from(t.pausedContainerNames.values());d<v.length;d++){var h=v[d];s.has(h)||c.push(h)}t.resumeUpdateForVisualContainers(c)}})},n.prototype.pauseUpdatesForVisualContainers=function(e){var t=this,r=this.pausedContainerNames=this.pausedContainerNames||new Set;e.forEach(function(i){return r.add(i)}),this.pauseUpdatesPromise||(this.pauseUpdatesPromise=new Promise(function(i){return t.pauseUpdatesResolver=i}))},n.prototype.resumeUpdateForVisualContainers=function(e){var t=this.pausedContainerNames;T.fF.assertValue(t,"pausedContainers"),e.forEach(function(r){return t.delete(r)}),0===t.size&&(this.pauseUpdatesResolver(),this.pauseUpdatesResolver=void 0,this.pauseUpdatesPromise=void 0,this.pausedContainerNames=void 0)},n.prototype.getViewModelIntl=function(e){return this.getStore$(e).pipe((0,et.w)(function(t){return t.getViewModel$()}))},n.prototype.selectAllCardsIntl=function(e){return this.getStore$(e).pipe((0,et.w)(function(t){return t.selectAllCards()}))},n.prototype.selectTopLevelToggleIntl=function(e,t,r){return this.getStore$(r).pipe((0,et.w)(function(i){return i.selectTopLevelToggle(e,t)}))},n.prototype.selectGroupIntl=function(e,t){return this.getStore$(t).pipe((0,et.w)(function(r){return r.selectGroup(e).pipe((0,pe.U)(function(i){return Ni(i)}))}))},n.prototype.selectSliceIntl=function(e,t,r){return this.getStore$(r).pipe((0,et.w)(function(i){return i.selectSlice(e,t).pipe((0,pe.U)(function(a){return Ni(a)}))}))},n.prototype.selectCardIntl=function(e,t){return this.getStore$(t).pipe((0,et.w)(function(r){return r.selectCard(e).pipe((0,pe.U)(function(i){return Ni(i)}))}))},n.prototype.getChartElementsContractIntl=function(e){return this.getStore$(e).pipe((0,et.w)(function(t){return t.getChartElementsContract$()}))},n.prototype.getCardTopLevelToggleUidsIntl=function(e){return this.getStore$(e).pipe((0,et.w)(function(t){return t.getCardTopLevelToggleUids$()}))},n.prototype.getSubSelectablesIntl=function(e){var t=this;return e.pipe((0,et.w)(function(r){if(1===r.type)return ps.E;var i=r.canvasItem,a=(0,Wt.T)(t.eventBridge.on(Le.D1A),t.eventBridge.on(Le.DSN)).pipe((0,Ot.h)(function(u){return u.name===i.name})),o=t.eventBridge.on(Le.KD7).pipe((0,Ot.h)(function(u){return _.some(u.changedItems,function(c){return c.name===i.name})})),s=t.eventBridge.on(Le.jCS).pipe((0,Ot.h)(function(u){return(0,J.Vz)(i)&&u.affectContainer(i)}));return(0,Wt.T)(o,a,s).pipe((0,Ja.O)({}),(0,ds.h)({})).pipe((0,et.w)(function(u){return(0,J.Vz)(i)?t.runningVisual.getVisual$(i).pipe((0,et.w)(function(d){return d?(0,nr.D)(d.getSubSelectables()):[]})):[]}))}),(0,hr.d)({bufferSize:1,refCount:!0}))},n.prototype.getFor=function(e){var t=this,r=(0,Fi.b)(e)?e:(0,ft.of)(e);return{getCardTopLevelToggleUids$:function(){return t.getCardTopLevelToggleUidsIntl(r)},getChartElementsContract$:function(){return t.getChartElementsContractIntl(r)},getViewModel$:function(){return t.getViewModelIntl(r)},selectAllCards:function(){return t.selectAllCardsIntl(r)},selectCard:function(a){return t.selectCardIntl(a,r)},selectGroup:function(a){return t.selectGroupIntl(a,r)},selectSlice:function(a){var o=ae.zh(a);return t.selectSliceIntl(o,void 0,r)},selectTopLevelToggle:function(a){var o=ae.zh(a);return t.selectTopLevelToggleIntl(o,void 0,r)},getSubSelectables$:function(){return t.getSubSelectablesIntl(r)}}},n.prototype.getRevertToDefaultMetadata=function(e,t){return this.formattingModelService.getRevertToDefaultMetadata(e,t)},n.prototype.changeContainerDropdownValue=function(e,t){this.formattingModelService.changeContainerDropdownValue(e,t)},n.prototype.getFormattingStoreForCanvasItem=function(e){var t;return this.formattingStores.has(t=1===e.type?Ti:e.canvasItem.name)||this.formattingStores.set(t,this.formattingStoreFactory.create()),this.formattingStores.get(t)},n.prototype.getStore$=function(e){var t=this;return e.pipe((0,pe.U)(function(r){return t.getFormattingStoreForCanvasItem(r)}))},n.prototype.updateStateInt=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d;return(0,p.Jh)(this,function(h){switch(h.label){case 0:return _.isEmpty(e)?[2]:(i=1===e.length&&"Page"===e[0]?Ti:t.name,a=this.updateCounter++,this.currentUpdateIds.set(i,a),this.pauseUpdatesPromise?[4,this.pauseUpdatesPromise]:[3,2]);case 1:if(h.sent(),this.currentUpdateIds.get(i)!==a)return[2];h.label=2;case 2:o={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:t?new dr.lD(t,function(f){return f===t||f&&t&&t.name===f.name}):void 0},s=this.featureSwitchService.featureSwitches.onObject,l=function(m){var g,y,C,N,D,w,F,V,I,j,L,z;return(0,p.Jh)(this,function(P){switch(P.label){case 0:return T.fF.assert(function(){return!s||"Analytics"!==m},"Should not be asking for Analytics with OnObject (it is part of Visuals)"),g=function(E,G){for(var X={},te=0,Y=Object.keys(E);te<Y.length;te++){var ne=Y[te];X[ne]=Ns(E[ne],G)}return X},[4,u.formattingModelService.getFormattingOptions(t,m)];case 1:for(z=P.sent(),y=z.cards,C=z.groups,N=z.slices,D=z.revertToDefaultDescriptors,u.featureSwitchService.featureSwitches.interactiveMobileCanvas&&(null===(r=u.sliceCustomizationService)||void 0===r||r.customizeSliceOptions(N)),w=g(y,1),F=g(C,1),V=g(N,1),I=0,j=Object.keys(w);I<j.length;I++)w[L=j[I]]=(0,p.pi)((0,p.pi)({},y[L]),{deferredStatus:1});return T.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.cards),_.keys(w)))},"Expected no cards to have duplicate uids"),T.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.groups),_.keys(F)))},"Expected no groups to have duplicate uids"),o.cards=(0,p.pi)((0,p.pi)({},o.cards),w),o.groups=(0,p.pi)((0,p.pi)({},o.groups),F),o.slices=(0,p.pi)((0,p.pi)({},o.slices),V),o.revertToDefaultDescriptors=(0,p.ev)((0,p.ev)([],o.revertToDefaultDescriptors,!0),D,!0),[2]}})},u=this,c=0,d=e,h.label=3;case 3:return c<d.length?[5,l(d[c])]:[3,6];case 4:h.sent(),h.label=5;case 5:return c++,[3,3];case 6:return this.currentUpdateIds.get(i)!==a||(this.updateFormattingContract(o,t),this.currentUpdateIds.delete(i)),[2]}})})},n.prototype.getVisualUpdateSources=function(){var e=["Format_Label_General","Visual"];return this.featureSwitchService.featureSwitches.onObject||e.push("Analytics"),e},n.prototype.getNonVisualUpdateSources=function(){return["Page"]},n.prototype.updateFormattingContract=function(e,t){var r=this.getFormattingOptions(t);this.getFormattingStoreForCanvasItem(r).setState(e)},n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.saveValues=function(e,t){var r;return(0,p.mG)(this,void 0,void 0,function(){var i,a,o,s,l,u;return(0,p.Jh)(this,function(d){switch(d.label){case 0:i=e.changes.some(function(v){return"Page"===v.formattingSource}),a=[],o=function(h){var f,m;return(0,p.Jh)(this,function(g){switch(g.label){case 0:return h.conditionalFormatting?(T.fF.assert(function(){return!h.canvasItems||1===h.canvasItems.length},"Conditional formatting is only supported for single canvas item or page formatting"),f=s.getFormattingOptions(null===(r=h.canvasItems)||void 0===r?void 0:r[0]),[4,s.getFor(f).selectSlice({objectName:h.objectName,propertyName:h.propertySlice.name,selector:h.propertySlice.selector}).pipe((0,Di.q)(1)).toPromise()]):[3,2];case 1:if((m=g.sent())&&m.saveCallback)return m.saveCallback(e),[2,"continue"];g.label=2;case 2:return a.push(h),[2]}})},s=this,l=0,u=e.changes,d.label=1;case 1:return l<u.length?[5,o(u[l])]:[3,4];case 2:d.sent(),d.label=3;case 3:return l++,[3,1];case 4:return _.isEmpty(a)?[2]:(e.changes=a,[4,this.formattingModelService.saveFormattingSlicesValue(e.changes,t)]);case 5:return d.sent(),i&&this.updateStateInt(["Page"],void 0),[2]}})})},n.prototype.isEditableContainerWithSelectionChangeOnly=function(e){return this.formattingModelService.isEditableContainerWithSelectionChangeOnly(e.changes)},n.prototype.revertToDefault=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){return(0,p.Jh)(this,function(i){return[2,this.formattingModelService.revertToDefault(e,t,r)]})})},n.prototype.getRevertToDefaultEnabled=function(e,t,r){return this.formattingModelService.getRevertToDefaultEnabled(e,t,r)},n.prototype.getModelUnavailableInformation=function(e,t){return this.formattingModelService.getModelUnavailableInformation(e,t)},n.prototype.getFormattingModelMessage=function(e,t){return this.formattingModelService.getFormattingModelMessage(e,t)},n.prototype.startFormattingTutorial=function(e,t){this.explorationCapabilities.getCapabilities().disableFormattingTutorial||this.formattingTutorialService.startFormattingTutorial(e,t)},n.prototype.getFormattingOptions=function(e){return e?{type:0,canvasItem:e}:{type:1}},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(dr.Kj,8),q.\u0275\u0275inject(La.J),q.\u0275\u0275inject(kt.z),q.\u0275\u0275inject(qi.U),q.\u0275\u0275inject(yt.vZ),q.\u0275\u0275inject(Ka),q.\u0275\u0275inject(Qa),q.\u0275\u0275inject($a),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(qr.z),q.\u0275\u0275inject(Mr.f),q.\u0275\u0275inject(qt.D))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Ts={provide:"formattingService",useFactory:function(n){return Promise.resolve(n)},deps:[Vi]},nt=b(59017),ct=b(64560),Is=b(5838),Ps=b(44104),js=b(19650),or=b(92755);function Ya(n){return n.flatMap(function(e){return function(n){var e=[];switch(n.type){case 8:e.push.apply(e,Ya(n.shortcuts));break;case 0:n.relatedResetFormattingIds&&e.push.apply(e,n.relatedResetFormattingIds);break;case 2:n.relatedToggledFormattingIds&&e.push.apply(e,n.relatedToggledFormattingIds);case 3:case 6:e.push(n);break;case 9:e.push.apply(e,n.referencesAndValues);break;case 4:case 1:case 5:case 7:case 10:break;default:T.fF.assertNever(n)}return e}(e)})}var xs=b(86940),Za=function(){function n(e,t,r,i,a,o,s){this.formattingService=e,this.injector=t,this.itemPickerService=r,this.localizationService=i,this.overlay=a,this.runningVisual=o,this.selectionService=s,this.destroy$=new Er.xQ}return n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.openColorPicker=function(e,t,r,i){var a=this;if(e){var o=e&&e.properties,s=o&&o.conditionalFormattingObjects,l=e.resolvedValue;return(0,Ps.Z)({itemPickerService:this.itemPickerService,localizationService:this.localizationService,overlay:this.overlay,injector:this.injector,connectedTo:t,isNoFillItemSupported:!1,backDropClass:"invisible-backdrop",conditionalFormattingOptions:!!s&&{showDialog:function(){(0,nr.D)(s.showDialog()).subscribe(function(h){h&&h.shouldSave&&a.saveChanges([h.value],e.instances,i)})},isSet:s.isSet},setColor:function(h){if(h&&(h.value!==l?.value||s?.isSet)){var f=[];s?.isSet&&f.push(null),f.push(h),a.saveChanges(f,e.instances,i)}},closed:r,color:l,defaultColor:void 0,overlayHeight:s?400:362,overlayWidth:310})}},n.prototype.onControlClicked=function(e,t,r){var i=t.key;switch(i){case"horizontalAlignment":var a=e.horizontalAlignment;if(!a)return;var o=this.getAlignmentSaveValue(t.value,a.instances);return this.saveChanges([o],a.instances,r);case"increaseFontSize":return this.adjustFontSize(1,e,r);case"decreaseFontSize":return this.adjustFontSize(-1,e,r);case"decreaseDecimal":return this.adjustDecimal(-1,e,r);case"increaseDecimal":return this.adjustDecimal(1,e,r);case"background":case"fill":case"fontColor":case"stroke":case"border":case"grid":T.fF.assertFail("".concat(i," should not be handled here"));break;case"height":case"width":case"displayUnits":case"wordWrap":case"bold":case"italic":case"fontSize":case"underline":case"fontFamily":return(s=e[i])?this.saveChanges([t.value],s.instances,r):void 0;case"shadow":var s;return(s=e[i])?this.saveShadowChanges(t.value,e,r):void 0;default:T.fF.assertNever(i)}},n.prototype.adjustDecimal=function(e,t,r){var i=t.precision,a=i&&i.properties;if(a){var o=_.compact(_.map(i.instances,function(s){var l;if(!s.disabled||s.overrideDisabled){var u=_.isNumber(i.resolvedValue)?i.resolvedValue:null!==(l=a.defaultPrecision)&&void 0!==l?l:0,c=Math.max(0,u+=e);return(0,or.ks)(c,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}}));if(!_.isEmpty(o))return this.formattingService.saveValues({changes:o},r)}},n.prototype.adjustFontSize=function(e,t,r){var i,a,o,s,l=t.fontSize,u=l&&l.properties;if(u){var c=null==(null===(a=null===(i=u.options)||void 0===i?void 0:i.minValue)||void 0===a?void 0:a.value)?dr.r4:u.options.minValue.value,d=null==(null===(s=null===(o=u.options)||void 0===o?void 0:o.maxValue)||void 0===s?void 0:s.value)?dr.YR:u.options.maxValue.value,v=_.map(l.instances,function(h){if(!h.disabled||h.overrideDisabled){var f=h.currentValue,m=Math.min(Math.max(f+e,c),d);if(m!==f)return(0,or.ks)(m,h.descriptor,h.uid,h.formattingSource,[h.canvasItem],1)}});if(v=_.compact(v),!_.isEmpty(v))return this.formattingService.saveValues({changes:v},r)}},n.prototype.saveChanges=function(e,t,r){return(0,p.mG)(this,void 0,void 0,function(){var i;return(0,p.Jh)(this,function(a){return i=_.flatten(_.map(e,function(o){return _.compact(_.map(t,function(s){return s.disabled&&!s.overrideDisabled?void 0:(0,or.ks)(o,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}))})),_.isEmpty(i)?[2]:[2,this.formattingService.saveValues({changes:i},r)]})})},n.prototype.getAlignmentSaveValue=function(e,t){var r=t[0].descriptor.type;if(T.fF.assert(function(){return _.every(t,function(a){return a.descriptor.type===r})},"MiniToolbar alignment - expected all the descriptors to have same property type"),St.Ge.isValueTypeDescriptor(r)){var i=St.Ge.fromDescriptor(r);if(i.enum===js.K)return dr.y5[e];if(i.formatting.alignment)return e;T.fF.assertFail("MiniToolbar alignment - unexpected descriptor property type")}else T.fF.assertFail("MiniToolbar alignment - not a value type descriptor")},n.prototype.saveShadowChanges=function(e,t,r){var s=t.shadowPreset.instances,l=t.shadowPosition.instances,u=t.shadow.instances;T.fF.assert(function(){return s.length===l.length&&s.length===u.length},"shadow - expected all the instances to have same length");for(var c=[],d=function(f){if(u[f].disabled)return"continue";var m=u[f],g=s[f],y=l[f],C=e.shadowPreset,N=e.shadowPosition,D=e.shadow,w=g.descriptor,F=y.descriptor,V=m.descriptor,I=g.uid,j=y.uid,L=m.uid,x=g.formattingSource,z=y.formattingSource,P=m.formattingSource,A=m.canvasItem;T.fF.assert(function(){return A===g.canvasItem&&A===y.canvasItem},"shadow - expected all the instances to have same canvasItem");var E=(0,or.ks)(C,w,I,x,[A],1),G=(0,or.ks)(N,F,j,z,[A],1),X=(0,or.ks)(D,V,L,P,[A],1);c.push(X,G,E)},v=0;v<u.length;v++)d(v);if(!_.isEmpty(c))return this.formattingService.saveValues({changes:c},r)},n.prototype.getSubSelectionStyleShortcutsForNonCanvasItems$=function(e){return this.getMenuItems$(e,void 0,void 0,void 0).pipe((0,pe.U)(function(r){return{items:_.flatten(r)}}))},n.prototype.getSubSelectionStyleShortcutsForCanvasItems$=function(e){var t=this;return((0,Fi.b)(e)?e:(0,ft.of)(e)).pipe((0,et.w)(function(i){var a,o=(a=(0,J.rQ)(i))[0],s=a[1];if(_.isEmpty(o)||!_.isEmpty(s))return(0,ft.of)({items:[]});var l=_.map(o,function(u){var c=t.runningVisual.getVisual$(u),v=t.getActiveSubSelectables$(t.formattingService.getFor({type:0,canvasItem:u}),u);return(0,nt.aj)([c,v]).pipe((0,et.w)(function(h){var f=h[0],m=h[1],g=(0,nt.aj)(_.compact(_.map(m,function(C){return f&&(0,nr.D)(f.getSubSelectionStyles([C]))}))),y=(0,nt.aj)(_.compact(_.map(m,function(C){return f&&(0,nr.D)(f.getSubSelectionShortcuts([C],void 0))})));return(0,nt.aj)([g,y]).pipe((0,pe.U)(function(C){var D=C[1];return{canvasItem:u,visual:f,subSelectionStyles:_.compact(C[0]),subSelectionShortcuts:_.compact(_.flatten(D))}}))}))});return(0,nt.aj)(l).pipe((0,et.w)(function(u){var c=_.map(u,function(d){return t.getMenuItems$(d.subSelectionShortcuts,d.canvasItem,d.subSelectionStyles,d.visual)});return(0,nt.aj)(c).pipe((0,pe.U)(function(d){return{items:_.flatten(d)}}))}))}),(0,hr.d)({bufferSize:1,refCount:!0}))},n.prototype.getSubSelectionStylesSlices$=function(e){var t=(0,Fi.b)(e)?e:(0,ft.of)(e);return this.getSubSelectionStylesForMultipleVisuals$(t)},n.prototype.getSubSelectionStylesForMultipleVisuals$=function(e){var t=this;return e.pipe((0,et.w)(function(r){var i,a=(i=(0,J.rQ)(r))[0],o=i[1];if(_.isEmpty(a)||!_.isEmpty(o))return(0,ft.of)({});if(1===a.length)return t.getVisualSubSelectionStylesSlicesForSingleVisual$(a[0]);var s=_.map(a,function(l){return{canvasItem:l,subSelectionStyles$:t.getVisualAreaSubSelectionStyles$(l)}});return t.getSubSelectionSlicesFromStyles$(s)}),(0,hr.d)({bufferSize:1,refCount:!0}),(0,Mt.x)(function(r,i){return _.isEqual(r,i)}))},n.prototype.getActiveSubSelectables$=function(e,t){var r=e.getSubSelectables$().pipe((0,pe.U)(function(o){return o.find(function(s){return(0,ae.so)(s)})})),i=this.selectionService.getSubSelections$(t).pipe((0,pe.U)(function(o){return _.map(o,function(s){return s.visualSubSelection})}));return(0,nt.aj)([r,i]).pipe((0,pe.U)(function(o){var s=o[0],l=o[1];return _.isEmpty(l)?s?[s]:[]:l}))},n.prototype.getVisualSubSelectionStylesSlicesForSingleVisual$=function(e){var t=this,i=this.getActiveSubSelectables$(this.formattingService.getFor({type:0,canvasItem:e}),e),a=this.runningVisual.getVisual$(e),o=(0,nt.aj)([i,a]).pipe((0,et.w)(function(s){var l=s[0],u=s[1];if(!u)return(0,ft.of)([]);var c=_.map(l,function(d){return(0,ae.so)(d)?t.getVisualAreaSubSelectionStyles$(e):(0,nr.D)(u.getSubSelectionStyles([d]))});return(0,nt.aj)(c).pipe((0,pe.U)(function(d){return _.compact(_.flatten(d))}))}));return this.getSubSelectionSlicesFromStyles$([{subSelectionStyles$:o,canvasItem:e}])},n.prototype.getVisualAreaSubSelectionStyles$=function(e){var t=this.runningVisual.getVisual$(e),i=this.formattingService.getFor({type:0,canvasItem:e}).getSubSelectables$();return(0,nt.aj)([i,t]).pipe((0,et.w)(function(a){var o=a[0],s=a[1];if(!s)return(0,ft.of)([]);var l=_.map(o,function(u){return(0,nr.D)(s.getSubSelectionStyles([u])).pipe((0,pe.U)(function(c){if(c){if((0,ae.so)(u))return c;if(1===c.type||2===c.type)return{fontColor:"fontColor"in c?c.fontColor:void 0,fontFamily:"fontFamily"in c?c.fontFamily:void 0,fontSize:"fontSize"in c?c.fontSize:void 0,bold:"bold"in c?c.bold:void 0,italic:"italic"in c?c.italic:void 0,underline:"underline"in c?c.underline:void 0,type:c.type}}}))});return(0,nt.aj)(l).pipe((0,pe.U)(function(u){return _.compact(u)}))}))},n.prototype.getSubSelectionSlicesFromStyles$=function(e){var t=this,r=_.map(e,function(i){var a=i.canvasItem;return i.subSelectionStyles$.pipe((0,pe.U)(function(s){return _.map(s,function(l){return{subSelectionStyle:l,canvasItem:a}})}))});return(0,nt.aj)(r).pipe((0,et.w)(function(i){for(var a=(0,ft.of)({}),s=function(f,m){a=a.pipe((0,et.w)(function(g){return t.getBoundSubSelectionStylesSlices$(f,g,m)}))},l=0,u=_.flatten(i);l<u.length;l++){var c=u[l];s(c.subSelectionStyle,c.canvasItem)}return a}))},n.prototype.getBoundSubSelectionStylesSlices$=function(e,t,r){var i=this,a={type:0,canvasItem:r},o=e??{},s=_.map(Object.keys(o),function(l){var u=o[l];if("type"!==l&&u&&(0,ae.N6)(u)){var c=u.reference;return c?i.mergeSliceAndTopLevelToggle(i.formattingService.getFor(a),c).pipe((0,pe.U)(function(d){if(d)return i.getSubSelectionStylesSlices(d,u,l,t,r)})):(0,ft.of)(void 0)}return(0,ft.of)(void 0)});return(0,nt.aj)(s).pipe((0,pe.U)(function(l){return l.reduce(function(u,c){return c&&(u=(0,p.pi)((0,p.pi)({},u),c)),u},t)}),(0,hr.d)({bufferSize:1,refCount:!0}))},n.prototype.getSubSelectionStylesSlices=function(e,t,r,i,a){var o,s,l,u,c,d,v,h={};switch(r){case"background":case"color":case"fill":case"fontColor":case"stroke":var f=!0,m=this.resolveBaseProperties(e,t,null===(o=i[r])||void 0===o?void 0:o.properties,f);h[r]=this.getStylesForColorPicker(e,m,i[r],a,f);break;case"horizontalAlignment":m=this.resolveBaseProperties(e,t,null===(s=i[r])||void 0===s?void 0:s.properties),h[r]=this.getStylesForAlignmentGroup(e,m,i[r],a);break;case"fontSize":case"height":case"width":case"precision":m=this.resolveBaseProperties(e,t,null===(l=i[r])||void 0===l?void 0:l.properties),h[r]=this.getStylesForNumUpDown(e,m,t,i[r],a);break;case"fontFamily":m=this.resolveBaseProperties(e,t,null===(u=i[r])||void 0===u?void 0:u.properties),h[r]=this.getStylesForFontFamily(e,m,i,a);break;case"shadowPreset":case"shadowPosition":case"style":case"displayUnits":m=this.resolveBaseProperties(e,t,null===(c=i[r])||void 0===c?void 0:c.properties),h[r]=this.getStylesForDropdown(e,m,i[r],a);break;case"bold":case"italic":case"underline":case"shadow":case"grid":case"wordWrap":m=this.resolveBaseProperties(e,t,null===(d=i[r])||void 0===d?void 0:d.properties),h[r]=this.getStylesForToggleSwitch(e,m,i[r],a);break;case"border":m=this.resolveBaseProperties(e,t,null===(v=i[r])||void 0===v?void 0:v.properties),h[r]=this.getStylesForFlagsSelection(e,m,i[r],a);break;default:T.fF.assertNever(r)}return h},n.prototype.getIdentifierForSlice=function(e,t,r,i,a){return{currentValue:t,descriptor:r,formattingSource:e.originSource,uid:e.uid,canvasItem:i,disabled:e.disabled,overrideDisabled:a}},n.prototype.resolveBaseProperties=function(e,t,r,i){return void 0===i&&(i=!1),{disabled:e.disabled&&(!r||r.disabled)&&!i,label:t.label}},n.prototype.getStylesForColorPicker=function(e,t,r,i,a){var o=e.control;if("ColorPicker"!==o.type||(0,S.IW)(e)||ae.Ky(e))return T.fF.assertFail("Expected a ColorPicker type to get color properties."),r;var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,i,a),r?.instances),l=this.resolveValue(o.properties.value,r?.resolvedValue);return{instances:s,properties:(0,p.pi)((0,p.pi)({},t),{conditionalFormattingObjects:r?void 0:e.conditionalFormattingObjects}),resolvedValue:l}},n.prototype.getStylesForNumUpDown=function(e,t,r,i,a){var o=e.control;if("NumUpDown"===o.type&&!(0,S.IW)(e)){var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,a),i?.instances),l=this.resolveValue(o.properties.value,i?.resolvedValue);return{instances:s,properties:(0,p.pi)((0,p.pi)({},t),{options:o.properties.options,defaultPrecision:r.defaultPrecision}),resolvedValue:l}}T.fF.assertFail("Expected a NumUpDown type to get spin button properties")},n.prototype.getStylesForAlignmentGroup=function(e,t,r,i){var a=e.control;if("AlignmentGroup"!==a.type||(0,S.IW)(e))return T.fF.assertFail("Expected a AlignmentGroup type to get alignment properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=r?r.resolvedValue===a.properties.value?a.properties.value:void 0:a.properties.value;return{instances:o,properties:(0,p.pi)({},t),resolvedValue:s}},n.prototype.getStylesForDropdown=function(e,t,r,i){var a=e.control;if("Dropdown"!==a.type||(0,S.IW)(e)||!(0,Fe.WN)(a.properties))return T.fF.assertFail("Expected a Dropdown type to get Dropdown properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.pi)((0,p.pi)({},t),{items:a.properties.items}),resolvedValue:s}},n.prototype.getStylesForFlagsSelection=function(e,t,r,i){var a=e.control;if("FlagsSelection"!==a.type||(0,S.IW)(e))return T.fF.assertFail("Expected a FlagsSelection type to get FlagsSelection properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.pi)({},t),resolvedValue:s}},n.prototype.getStylesForToggleSwitch=function(e,t,r,i){var a=e.control;if("ToggleSwitch"!==a.type||(0,S.IW)(e))return T.fF.assertFail("Expected a ToggleSwitch type to get toggle button properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.pi)({},t),resolvedValue:s}},n.prototype.getStylesForFontFamily=function(e,t,r,i){var a=e.control;if("FontPicker"!==a.type||(0,S.IW)(e))return T.fF.assertFail("Expected a FontPicker type to get Font Family properties"),r.fontFamily;var o=r.fontFamily,s=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),o?.instances),l=this.resolveValue(a.properties.value,o?.resolvedValue);return{instances:s,properties:(0,p.pi)({},t),resolvedValue:l}},n.prototype.resolveValue=function(e,t){return void 0!==t?_.isEqual(t,e)?e:null:e},n.prototype.resolveInstances=function(e,t){return t?(0,p.ev)((0,p.ev)([],t,!0),[e],!1):[e]},n.prototype.mergeSliceAndTopLevelToggle=function(e,t){var r=e.selectSlice(t),i=e.selectTopLevelToggle(t).pipe((0,Ot.h)(function(a){return!!a}));return(0,Wt.T)(r,i)},n.prototype.getMenuItems$=function(e,t,r,i){for(var a=this.formattingService.getFor(t?{type:0,canvasItem:t}:{type:1}),o=[],s=!1,l=0,u=e??[];l<u.length;l++){var c=u[l];if(!c.suppressOnUI){var d=void 0;switch(c.type){case 0:case 10:d=this.getResetShortcut$(c,e.some(function(v){return 4===v.type}),t,e,r,a);break;case 1:d=this.getNavigateShortcut$(c,t,a);break;case 2:d=this.getToggleShortcut$(c,t,a);break;case 3:d=this.getPickerShortcut$(c,t,a);break;case 5:d=this.getCustomActionShortcut$(c,t);break;case 4:s||(s=!0,d=this.getSortShortcut$(c,t,e,i));break;case 6:d=this.getConditionalFormattingShortcut$(c,t,a);break;case 7:d=this.getDivider$();break;case 8:d=this.getSubMenuShortcut$(c,t,a);break;case 9:d=this.getSetValueShortcut$(c,t)}d&&o.push(d)}}return(0,nt.aj)(o).pipe((0,pe.U)(function(v){return _.flatten(v).filter(function(h){return!!h})}),(0,Mt.x)(function(v,h){return _.isEqual(v,h)}))},n.prototype.getResetShortcut$=function(e,t,r,i,a,o){var d,s=this,l=this.isResetSortDisabled(t,r),c=Ya(i);return a&&_.forEach(a,function(v){c.push.apply(c,function(n){var e=[];switch(n.type){case 2:n.displayUnits&&e.push(n.displayUnits.reference),n.precision&&e.push(n.precision.reference);case 1:n.background&&e.push(n.background.reference),n.horizontalAlignment&&e.push(n.horizontalAlignment.reference),n.wordWrap&&e.push(n.wordWrap.reference),"fontSize"in n&&n.fontSize&&e.push(n.fontSize.reference),"fontFamily"in n&&n.fontFamily&&e.push(n.fontFamily.reference),"bold"in n&&n.bold&&e.push(n.bold.reference),"italic"in n&&n.italic&&e.push(n.italic.reference),"underline"in n&&n.underline&&e.push(n.underline.reference),e.push(n.fontColor.reference);break;case 3:n.color&&e.push(n.color.reference),n.fill&&e.push(n.fill.reference),n.stroke&&e.push(n.stroke.reference),n.style&&e.push(n.style.reference),n.width&&e.push(n.width.reference);break;default:T.fF.assertNever(n)}return e}(v))}),(d=0===e.type?or.cY(o,c,e.excludedResetFormattingIds):o.getViewModel$().pipe((0,pe.U)(function(v){return v.revertToDefaultDescriptors}))).pipe((0,pe.U)(function(v){return s.formattingService.getRevertToDefaultEnabled(r,v)})).pipe((0,Vr.M)(d),(0,pe.U)(function(v){var h=v[0];return{type:ct.iB.Button,data:{type:0,revertToDefaultDescriptors:v[1],canvasItem:r},text:s.localizationService.get("Reset_To_Default"),disabled:!h&&l,icon:{type:0,glyph:"glyphicon pbi-glyph-reset"}}}))},n.prototype.isResetSortDisabled=function(e,t){var r=!0;if(e){var i=t.config.singleVisual,a=i.query;if(a){var o=a.defn.orderBy(),s=(0,W.II)(t),l=i.hasDefaultSort;r=s&&void 0===l||l||_.isEmpty(o)}}return r},n.prototype.getNavigateShortcut$=function(e,t,r){return r.selectAllCards().pipe((0,pe.U)(function(a){return _.isEmpty(a)})).pipe((0,pe.U)(function(a){return{type:ct.iB.Button,data:{type:1,shortcut:e,canvasItem:t},text:e.label,disabled:a,icon:{type:2,name:Is.z.ChartStylesGallery_20}}}))},n.prototype.getToggleSwitch$=function(e,t){return this.mergeSliceAndTopLevelToggle(t,e).pipe((0,pe.U)(function(r){return r?.control.properties}))},n.prototype.getToggleShortcut$=function(e,t,r){var i=this,a=e.relatedToggledFormattingIds,o=e.selector,s=this.getToggleSwitch$(e,r),l=(0,nt.aj)((0,p.ev)([s],(a??[]).map(function(u){return i.getToggleSwitch$(u,r)}),!0)).pipe((0,pe.U)(function(u){return u.every(function(c){return c?.value})}));return(0,nt.aj)([s,l]).pipe((0,pe.U)(function(u){var d=u[1];if(u[0]){var v=d?e.disabledLabel:e.enabledLabel;if(v){var h=a?a.map(function(g){return(0,p.pi)((0,p.pi)({},g),{nextValue:!d,selector:g.selector})}):[],m=(0,p.pi)((0,p.pi)({type:2,nextValue:!d},{objectName:e.objectName,propertyName:e.propertyName}),{selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"},relatedToggledFormattingIds:h});return{type:ct.iB.Button,data:{type:2,shortcut:m,canvasItem:t},text:v}}}}))},n.prototype.getConditionalFormattingShortcut$=function(e,t,r){var i=e.objectName,a=e.propertyName,o=e.selector,s=e.label;return r.selectSlice(e).pipe((0,pe.U)(function(u){if(u)return{type:ct.iB.Button,data:{type:6,shortcut:{type:6,nextValue:!u.control.properties.value,objectName:i,propertyName:a,selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},canvasItem:t},text:s}}))},n.prototype.getPickerShortcut$=function(e,t,r){var i=this;return r.selectSlice(e).pipe((0,pe.U)(function(o){return o&&o.control.properties})).pipe((0,pe.U)(function(o){if(o&&!_.isEmpty(o.items))return{type:ct.iB.SubMenu,text:e.label,menu:{items:_.map(o.items,function(l,u){return function(u,c){return{type:ct.iB.Button,data:{type:3,shortcut:e,index:c,canvasItem:t},text:(0,Ce.G)(u.displayName,i.localizationService),checkable:!0,checked:_.isEqual(u,o.value)}}(l,u)})}}}))},n.prototype.getSubMenuShortcut$=function(e,t,r){var i=this,o=_.map(e.shortcuts,function(s){return function(l){switch(l.type){case 1:return i.getNavigateShortcut$(l,t,r);case 2:return i.getToggleShortcut$(l,t,r).pipe((0,pe.U)(function(d){var v;if(d)return(0,p.pi)((0,p.pi)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 6:return i.getConditionalFormattingShortcut$(l,t,r).pipe((0,pe.U)(function(d){var v;if(d)return(0,p.pi)((0,p.pi)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 7:return i.getDivider$()}}(s)});return(0,nt.aj)(o).pipe((0,pe.U)(function(s){return{type:ct.iB.SubMenu,text:e.label,menu:{items:s.filter(function(l){return!!l})}}}))},n.prototype.getSortShortcut$=function(e,t,r,i){var o,s,a=this;return(!_.isEmpty(r)&&i?.sortServices?(0,nr.D)(i.sortServices.getSortableGroups()):(0,ft.of)([])).pipe((0,pe.U)(function(c){var d=c.find(function(w){return w.key===e.key}),v=[];if(d){(s=d.fields.find(function(w){return w.active}))&&(o=d);for(var h=0,f=d.fields;h<f.length;h++){var m=f[h];v.push({type:ct.iB.Button,data:{type:4,sortGroup:d,sortField:m,sortDirection:s&&s.sortDirection?s.sortDirection:m.sortDirection?m.sortDirection:2,isSortField:!0,canvasItem:t},text:a.localizationService.format("Sort_SortBy",m.displayName),checkable:!0,checked:m.active})}}if(!_.isEmpty(v)){var g=v.length>1&&!s,y=void 0,C=void 0;if(1!==v.length||s)y=o,C=s;else{var N=v[0].data;y=N.sortGroup,C=N.sortField}var D=[{type:ct.iB.Button,data:{type:4,sortGroup:y,sortField:C,sortDirection:2,isSortField:!1,canvasItem:t},text:a.localizationService.get("Sort_Desc"),checkable:!0,checked:2===s?.sortDirection,disabled:g},{type:ct.iB.Button,data:{type:4,sortGroup:y,sortField:C,sortDirection:1,isSortField:!1,canvasItem:t},text:a.localizationService.get("Sort_Asc"),checkable:!0,checked:1===s?.sortDirection,disabled:g}];return{type:ct.iB.SubMenu,text:e.label,menu:{items:(0,p.ev)((0,p.ev)((0,p.ev)([],v,!0),[{type:ct.iB.Divider}],!1),D,!0)}}}}))},n.prototype.getCustomActionShortcut$=function(e,t){return(0,ft.of)({type:ct.iB.Button,data:{type:5,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon},disabled:e.disabled})},n.prototype.getSetValueShortcut$=function(e,t){return(0,ft.of)({type:ct.iB.Button,data:{type:9,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon}})},n.prototype.getDivider$=function(){return(0,ft.of)({type:ct.iB.Divider})},n.\u0275fac=function(t){return new(t||n)(q.\u0275\u0275inject(Vi),q.\u0275\u0275inject(q.Injector),q.\u0275\u0275inject($i.a),q.\u0275\u0275inject(at.o),q.\u0275\u0275inject(xs._),q.\u0275\u0275inject(Gt.s),q.\u0275\u0275inject(qr.z))},n.\u0275prov=q.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Os={provide:b(87644).VO,useFactory:function(n){return Promise.resolve(n)},deps:[Za]},Ls=function(){function n(){}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=q.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=q.\u0275\u0275defineInjector({providers:[Rr,$r,jr,pi,Xi,Na,ci,ra,Ka,Vi,Ts,wr,Qa,$a,Za,Os,li,si,Ra,Ia,ua,va],imports:[ce.CommonModule]}),n}()},93188:function(st,xe,b){"use strict";b.d(xe,{Sn:function(){return _e},XK:function(){return ot},yr:function(){return vt}});var ce=b(81337),p=b(40702),T=b(40474),S=b(9215),ee=b(61308),K=b(67746),rt=b(52083),Oe=b(50550),Be=b(62458),ge=b(48066),ye=b(5265),Q=b(10746),ke=b(82834),he=b(94419),je=b(52967),de=b(80777),we=b(18231),Re=b(45413);function ot(M){var U=this;return{dataBarsDialogLauncherFactory:function(){return(0,ce.mG)(U,void 0,void 0,function(){return(0,ce.Jh)(this,function(fe){return[2,M.dataBarsDialogLauncher]})})},conditionalFormattingDialogLauncherFactory:function(){return(0,ce.mG)(U,void 0,void 0,function(){return(0,ce.Jh)(this,function(fe){return[2,M.conditionalFormattingDialogLauncher]})})},objectDescriptors:M.capabilities.objects,objectDefinitions:M.visualObjectDefns,shouldIncludeObject:M.shouldIncludeObject,dataSourcesService:M.dataSourcesService,enumerateObjectInstances:function(fe){return(0,ce.mG)(U,void 0,void 0,function(){var qe,Ne;return(0,ce.Jh)(this,function(Ee){return M.visual?(Ne={objectName:fe},(qe=M.visual).enumerateObjectInstancesAsync?[2,qe.enumerateObjectInstancesAsync(Ne)]:qe.enumerateObjectInstances?[2,qe.enumerateObjectInstances(Ne)]:[2]):[2]})})},enumerateObjectRepetition:function(){if(M.visual&&M.visual.enumerateObjectRepetition)return M.visual.enumerateObjectRepetition()},showGradientCard:M.showGradientCard,selectedContainers:M.selectedContainers,save:_e,visualType:M.visualConfig.visualType,visualContainer:M.visualContainer,visualWarningCollection:M.runningVisual&&M.runningVisual.getWarnings(),localizationService:M.localizationService,visualStyle:M.visualStyle,cardIndexCounter:0,disabledSliceTypes:M.disabledSliceTypes,excludeConditionalFormattingCard:M.excludeConditionalFormattingCard}}function vt(M,U,k,H,fe){var qe,Ne,Ee,$e,O,B;if(U.name!==K.tV)if(U.name!==K.Kp)if((0,ke.e4)(U.name)){var We,tt=U.type;We=(0,ye.e4)(U.value)?U.value:tt.image?function(M,U,k,H,fe,qe){if(!M||_.isEmpty(M.name))return{name:(0,he.fL)(""),url:(0,he.fL)("")};var Ne,Ee=!0;if(M.scaling){var $e=(0,ye.NA)(fe,{objectName:U,propertyName:k},H);Ee=!$e||(0,Re.fS)($e.name,(0,he.fL)(""))||(0,Re.fS)($e.scaling,(0,he.fL)(M.scaling))}if(Ee&&qe)Ne=qe.add(M.name,1,we.Ut.Image,{content:M.url});else{var O=(0,ye.NA)(fe,{objectName:U,propertyName:k},H);O&&(Ne=O.url)}var B={name:(0,he.fL)(M.name),url:Ne};return M.scaling&&(B.scaling=(0,he.fL)(M.scaling)),B}(U.value,M,U.name,U.selector,k,H.resourceRegistration):tt.geoJson?function(M,U){if(M){var k;if(M.type===je.c1)U.add(M.name,2,we.Ut.ShapeMap),k=(0,he.nF)(we.IG,2,M.name);else if(M.type===je.BD&&M.content){var H=(0,ge.wo)(M.content);k=U.add(M.name,1,we.Ut.ShapeMap,{content:H})}else k=M.content?(0,he.fL)(M.content):(0,he.IF)();return{name:(0,he.fL)(M.name),type:(0,he.fL)(M.type),content:k}}}(U.value,H.resourceRegistration):tt.filter&&null===U.value?null:(0,ye.Lo)(U.value,tt),!de.Ge.fromDescriptor(U.type).text&&""===We&&(We=null);var Pt=U.selector;void 0!==U.altConstantValueSelector&&(null==U.value?fe||(Pt=U.altConstantValueSelector):(0,Q.oA)(We,Pt,(0,Oe.bv)()).length?(0,ye.E2)(k,M,U.altConstantValueSelector,U.name):Pt=U.altConstantValueSelector),function(M,U,k,H,fe){if(null!=M){if(null!=H?.order){var qe=(0,ye.GQ)(fe,U,H,{skipOrder:!0});if(qe.length){Be.fF.assert(function(){return 1===qe.length},"expected one match when updating order");var Ne=_.first(qe).selector;Ne.order!==H.order&&((0,ye.xl)(fe,U,Ne,H),(0,ye.dM)(fe,{objectName:U,propertyName:k},H))}}(function(M,U,k,H){M===K.De&&U===K.di&&((0,ye.zx)(k,M,null).properties[K.Ll]=H)})(U,k,fe,M),(0,ye.zx)(fe,U,H).properties[k]=M}else(0,ye.E2)(fe,U,H,k)}(We,M,U.name,Pt,k)}else Be.fF.assertFail("Invalid property name");else for(var re=k[M],le=null!==($e=null===(Ee=H.explorationNavigation)||void 0===Ee?void 0:Ee.getAllSections())&&void 0!==$e?$e:[],ie=null===(O=H.explorationNavigation)||void 0===O?void 0:O.getCurrentSection(),ue=T.C7,Me=0,Je=le;Me<Je.length;Me++){var lt=Je[Me];if(lt!==ie){var wt=lt.objects=null!==(B=lt.objects)&&void 0!==B?B:{};re?(0,ee.C)(((qe={})[M]=ue[M],qe),ue,((Ne={})[M]=re,Ne),wt):delete wt[M]}}else delete k[M]}var _e=function(U,k,H,fe,qe,Ne,Ee){if((0,S.Vz)(H)){var $e=H.config.singleVisual.visualType;if(fe.telemetryService&&function(M,U,k,H){var fe,qe,Ne,Ee,$e,O,B,re,le,ie=U.name;if(M===K.jA&&ie===K.di&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k}),M===K.LG&&ie===K.di&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k}),M===K.hz&&ie===K.i$&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k}),M===K.$l&&ie===K.ns&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k}),M===K.Rz&&ie===K.Il){var ue=null===(Ne=null===(qe=null===(fe=U.value)||void 0===fe?void 0:fe.solid)||void 0===qe?void 0:qe.color)||void 0===Ne?void 0:Ne.rule;_.isEmpty(ue)||H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k})}M===K.jA&&ie===K.Il&&(ue=null===(O=null===($e=null===(Ee=U.value)||void 0===Ee?void 0:Ee.solid)||void 0===$e?void 0:$e.color)||void 0===O?void 0:O.rule,_.isEmpty(ue)||H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k})),M===K.e4&&ie===K.Il&&(ue=null===(le=null===(re=null===(B=U.value)||void 0===B?void 0:B.solid)||void 0===re?void 0:re.color)||void 0===le?void 0:le.rule,_.isEmpty(ue)||H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k})),(M===K.Rz||M===K.ve)&&ie===K.xh&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,newValue:U.value,visualType:k}),(M===K.Rz||M===K.ve)&&ie===K.es&&H.logEvent(p.Lo,{objectName:M,propertyName:ie,visualType:k})}(U,k,$e,fe.telemetryService),U===K.ph)!function(M,U){var k=U.config.singleVisual.objects;k||(U.config.singleVisual.objects=k={}),(0,rt._8)(M.name,M.value,k)}(k,H);else{var O=H.config.singleVisual.objects;if(O||(H.config.singleVisual.objects=O={}),Ee){var B=fe.visualPlugin&&fe.visualPlugin.capabilities($e);if(B&&B.supportsSynchronizingFilterState){var re=B.objects[U];if(re){var le=re.properties[k.name];if(le&&le.filterState){var ie=fe.visualSync;ie&&ie.syncFilterState(H)}}}}vt(U,k,O,fe,Ne),H.config.singleVisual.autoSelectVisualType=void 0}}}},42587:function(st,xe,b){"use strict";b.d(xe,{F:function(){return T},j:function(){return p}});var ce=b(78417);function p(S,ee,K){return void 0===K&&(K=!1),1===S?{paneTitle:ee.get("Tooltip"),paneTitleTooltip:ee.get("Drillthrough_TooltipTitleTooltip"),linkFieldsDropZoneTitle:ee.get(K?"PagePropertyPane_LinkFieldsDropZoneTitle_Tooltip":"DrillthroughLinks_Tooltip_Fields"),dropZoneText:ee.get("FieldDropZone_TooltipLink_Watermark"),keepAllFiltersLabel:ee.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:ee.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip"),keepAllFiltersToggleForcedOnTooltip:ee.format("Drillthrough_KeepAllFiltersForcedOnForTooltip_Tooltip",[ee.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip")]),crossReportDrillthroughLabel:ee.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:ee.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:ee.get("DrillthroughLinks_LinkTypeGroup_Tooltip")}:{paneTitle:ee.get("Drillthrough"),paneTitleTooltip:ee.get("Drillthrough_DrillthroughTitleTooltip"),linkFieldsDropZoneTitle:ee.get(K?"PagePropertyPane_LinkFieldsDropZoneTitle_Drillthrough":"DrillthroughLinks_Drillthrough_Fields"),dropZoneText:ee.get("FieldDropZone_DrillthroughLink_Watermark"),keepAllFiltersLabel:ee.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:ee.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip"),keepAllFiltersToggleForcedOnTooltip:ee.format("Drillthrough_KeepAllFiltersForcedOnForDrillthrough_Tooltip",[ee.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip")]),crossReportDrillthroughLabel:ee.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:ee.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:ee.get("DrillthroughLinks_LinkTypeGroup_Drillthrough")}}function T(S,ee,K,rt){var Oe=(0,ce.Dt)(S,ee),Be=(0,ce.LM)(S,ee)||Oe,ge=!ee||Oe,je=!!ee&&2===ee.type||rt&&!!ee&&(void 0===ee.type||0===ee.type);return{keepAllFilters:{disabled:ge,value:Be,tooltip:ge&&Be?K.keepAllFiltersToggleForcedOnTooltip:K.keepAllFiltersTooltip},crossReportDrillthrough:{show:je,disabled:!ee,value:!!je&&(0,ce.aQ)(S,ee),tooltip:K.crossReportDrillthroughTooltip},linkFieldsDropZoneTitle:K.linkFieldsDropZoneTitle,linkFieldsLinkTypeGroupTitle:K.linkFieldsLinkTypeGroupTitle}}},90617:function(){window.onObjectSprite={icons:[{type:"svg",id:"PBIData_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 q -110 0 -202 -14 q -92 -14 -166 -37 q -74 -22 -129 -49 q -56 -27 -93 -53 q -38 -26 -57 -48 q -19 -21 -19 -33 v -1250 q 0 -45 49 -91 q 49 -46 137 -83 q 88 -36 211 -59 q 122 -23 269 -23 q 147 0 270 23 q 122 23 210 59 q 88 37 137 83 q 49 46 49 91 v 1250 q 0 12 -19 33 q -19 22 -56 48 q -38 26 -93 53 q -56 27 -130 49 q -74 23 -166 37 q -92 14 -202 14 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIFormat_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"AudioBookmark_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1473 l -512 372 v -1691 h 1024 v 1691 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LaunchSelectionPane_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 922 h 922 v 102 h -819 v 819 h 819 v 103 h -922 m 922 -1526 v 399 h -307 v -717 h 1229 v 1127 h -12 m -265 307 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 1894 v -921 h 870 v 921 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 1946 h -922 v -1024 h 922 v 102 h -819 v 819 h 819 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1024 819 h -256 v -665 h 1126 v 1024 h -18 l -852 -758 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1843 205 h -1024 v 614 h -102 v -717 h 1229 v 1127 h -12 l -116 -103 h 25 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1440 1560 l -262 262 v -991 l 735 654 h -325 l 198 425 l -150 70 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1669 1536 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPerformanceAnalyzer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1895 1249 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -1004 732 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 m 1177 103 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 m -614 -359 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 m 921 512 v 102 h -307 v -307 h 102 v 205 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1587 q 0 85 22 162 q 21 77 61 145 h -698 v -1740 h 1332 v 665 h -461 v 270 q -58 42 -105 96 q -48 54 -81 118 q -34 64 -52 135 q -18 72 -18 149 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 973 1587 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1029 1843 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1587 1997 q -85 0 -159 -33 q -75 -32 -130 -88 q -56 -55 -88 -130 q -32 -74 -32 -159 q 0 -85 32 -160 q 32 -74 88 -130 q 55 -55 130 -87 q 74 -32 159 -32 q 85 0 160 32 q 74 32 130 87 q 55 56 88 130 q 32 75 32 160 q 0 85 -32 159 q -33 75 -88 130 q -56 56 -130 88 q -75 33 -160 33 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1843 1536 v 102 h -307 v -307 h 102 v 205 m 257 -287 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -446 835 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBISyncSlicer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 m -820 -1232 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 m 927 -512 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 m 888 256 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 922 1395 l 307 254 v 245 h -1075 v -614 h 102 v -70 q 145 70 307 70 q 99 0 189 -25 q 90 -25 170 -71 m 358 -723 h 614 v 461 h -710 q 38 -66 62 -140 q 23 -73 31 -154 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1894 154 v 307 h -614 v -307 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1093 1536 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 102 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1997 1075 v 181 l -307 256 v 485 h -308 v -485 l -307 -256 v -181 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1126 0 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIBuild_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z m1280-103q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"},{type:"path",className:"OfficeIconColors_m20",d:"M1792 736v-173h-512v-409h-512v716h-512v1024h768v-945l3-13q12-39 59-78 47-39 121-70 74-32 172-51 96-20 208-20 111 0 205 19z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z"},{type:"path",className:"OfficeIconColors_m20",d:"M1452 1989q62 8 135 8 73 0 136-7 62-8 112-20 50-13 86-28 36-16 55-32l21-17v-860l-2-9q-8-28-41-55-34-28-87-50-54-22-125-35-71-14-155-14-81 0-151 14-71 13-125 35-54 21-88 48-34 27-43 54l-2 9v863l20 17q19 16 55 32 35 15 86 27 50 12 113 20z"},{type:"path",className:"OfficeIconColors_m210",d:"M1587 819q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAddToChart_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95-10-1-20 0-60 0-104 20-44 19-77 52-33 33-58 75-26 42-51 87l-9 16q-27 41-62 73-35 32-73 56-38 23-77 40-40 16-77 26-87 26-179 29 23 47 73 80 49 32 110 53 60 21 125 33 65 11 121 17 55 5 94 6 38 1 45 1 80 0 165-27 84-27 153-77 69-50 113-122 44-72 44-161 0-12-1-24 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z m-835 754q-31-31-74-50 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46l-15 13q-19-46-52-77z m-398 495q-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64-69 24-144 24z m870-64h-354v111h354v355h111v-355h355v-111h-355v-354h-111v354z"},{type:"path",className:"OfficeIconColors_m26",d:"M754 1520q-69 24-144 24-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64z"},{type:"path",className:"OfficeIconColors_m25",d:"M808 975q62 0 113 19 51 19 87 55 36 35 56 87 20 51 20 116 0 89-44 161-44 72-113 122-69 50-153 77-85 27-165 27-7 0-45-1-39-1-94-6-56-6-121-17-65-12-125-33-61-21-110-53-50-33-73-80 92-3 179-29 37-10 77-26 39-17 77-40 38-24 73-56 35-32 62-73l9-16q25-45 51-87 25-42 58-75 33-33 77-52 44-20 104-20z m-198 569q75 0 144-24 68-24 121-64 52-41 83-94 31-53 31-110 0-89-46-135-47-47-135-47-38 0-65 11-27 11-49 34-23 22-44 57-22 34-48 80l-14 25q-30 45-67 81-37 35-77 62-40 27-82 47-42 20-82 33 38 11 80 20 42 8 85 14 43 5 85 8 42 2 80 2z"},{type:"path",className:"OfficeIconColors_m20",d:"M1060 1126l15-13q25-24 48-46 24-24 49-48 25-24 46-45 109-108 190-195 80-88 138-156 57-69 94-120 37-52 60-89 22-38 32-62 10-24 14-38-21 6-67 29-46 22-124 79-79 57-195 157-116 100-276 261-45 45-82 86-36 38-68 73 43 18 74 50 33 32 52 77z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95 50 3 93 19 7 3 13 5 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46 0 0-1 0-10 9-14 13 2 5 4 10 16 42 19 92 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z"},{type:"path",className:"OfficeIconColors_m27",d:"M1126 1480h354v-354h111v354h355v111h-355v355h-111v-355h-354v-111z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAnomalyExplain_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5\r\n\tL2,9.709V18H11.721z M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"},{type:"path",className:"OfficeIconColors_m22",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5L2,9.709V18H11.721z"},{type:"path",className:"OfficeIconColors_m26",d:"M17.819,12.007c-1.072-0.672-2.566-0.672-3.639,0c-0.948,0.596-1.537,1.519-1.659,2.6\r\n\tc-0.119,1.065,0.246,2.11,1.004,2.866c0.252,0.252,0.68,0.59,1.094,0.916c0.361,0.285,0.732,0.577,1.048,0.858L16,19.544\r\n\tl0.333-0.297c0.315-0.281,0.687-0.573,1.048-0.858c0.414-0.326,0.842-0.664,1.094-0.916c0.758-0.756,1.123-1.801,1.004-2.866\r\n\tC19.356,13.525,18.768,12.603,17.819,12.007z"},{type:"path",className:"OfficeIconColors_m20",d:"M16,13.5c0.828,0,1.5,0.672,1.5,1.5s-0.672,1.5-1.5,1.5c-0.828,0-1.5-0.672-1.5-1.5S15.172,13.5,16,13.5z"},{type:"path",className:"OfficeIconColors_m25",d:"M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"}],viewBox:"0 0 20 20"},{type:"svg",id:"PBINewQuickMeasure_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m 819 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 m -424 410 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 m 1280 -716 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 m 416 921 h -205 v -205 h 205 m 0 -102 h -205 v -205 h 205 m -615 512 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1690 154 v 1740 h -1332 v -614 l 738 -973 h -210 l 114 -153 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1382 461 v 205 h -558 l 155 -205 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 410 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 1024 h -205 v -205 h 205 m 0 512 h -205 v -205 h 205 m -615 205 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 71 1178 l 205 -615 h -193 l 256 -512 h 480 l -307 410 h 205 l -538 717 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m -308 512 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPageVisuals_20",children:[{type:"path",className:"OfficeIconColors_m20",d:"M17.5 7V5.49805H12.5V1.50391H7.5V8.49609H2.5V18.4961H10V8C10 7.44772 10.4477 7 11 7H17.5Z"},{type:"path",className:"OfficeIconColors_m22",d:"M17.998 7V5H12.998V0.996094H7.00195V7.99805H2.00195V19.0039H10V17.998H7.99805V2.00195H12.002V7H12.998V5.99609H17.002V7H17.998ZM2.99805 9.00391H7.00195V17.998H2.99805V9.00391Z"},{type:"path",className:"OfficeIconColors_m25",d:"M18 9H12V19H18V9ZM12 8H18C18.5523 8 19 8.44772 19 9V19C19 19.5523 18.5523 20 18 20H12C11.4477 20 11 19.5523 11 19V9C11 8.44772 11.4477 8 12 8Z"},{type:"path",className:"OfficeIconColors_m20",d:"M18 9H12V19H18V9Z"},{type:"path",className:"OfficeIconColors_m25",d:"M16 18H14V17H16V18Z"}],viewBox:"0 0 20 20"},{type:"svg",id:"addchartplaceholder_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 205 1331 h 205 v 103 h -308 v -308 h 103 m -103 -1024 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 512 -307 h -205 v -103 h 205 m 307 103 h -205 v -103 h 205 m 307 103 h -205 v -103 h 308 v 205 h -103 m 615 410 v 1229 h -1332 v -820 h 410 v -716 h 512 v 307 m -512 512 h -307 v 614 h 307 m 410 -1331 h -308 v 1331 h 308 m 409 -1024 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 512 1434 h -410 v -1332 h 1332 v 205 h -512 v 717 h -410 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 102 1434 v -308 h 103 v 205 h 205 v 103 m -308 -1332 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 307 -307 v -103 h 205 v 103 m 102 0 v -103 h 205 v 103 m 307 0 h -205 v -103 h 308 v 205 h -103 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1075 1894 h -409 v -716 h 409 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1126 1126 v 820 h -512 v -820 m 410 103 h -307 v 614 h 307 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1485 768 h 409 v 1126 h -409 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1946 717 v 1229 h -512 v -1229 m 409 102 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1485 1894 h -410 v -1433 h 410 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 410 v 1536 h -512 v -1536 m 410 102 h -308 v 1331 h 308 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Paste_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1842 q 0 1 1 1 h 613 v 103 h -717 v -1639 h 466 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 h 466 v 410 h -103 v -307 h -204 v 307 h -820 v -307 h -204 m 307 204 h 614 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 m 1331 409 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 h -666 v -1536 h 457 l 8 -41 q 7 -36 26 -66 q 18 -29 45 -51 q 26 -22 60 -34 q 33 -12 70 -12 q 41 0 75 13 q 34 14 60 37 q 25 24 42 55 q 17 32 25 67 l 7 32 h 457 v 359 h -666 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 666 512 h -154 v 1229 h 512 v 153 h -666 v -1536 h 308 m 1024 0 v 359 h -154 v -205 h -154 v -154 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1024 1946 h -717 v -1639 h 359 v 103 h -256 v 1432 q 0 1 1 1 h 613 m 614 -1433 h -256 v -103 h 359 v 410 h -103 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 307 v 410 h -820 v -410 h 159 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 m 56 307 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 v 204 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1178 1997 v -1127 h 819 v 1127 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 819 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CustomFieldGraphicalIndicatorGreenPlus_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"powermap_newtour_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"suggestLightningBolt_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M614 410l308-410h-615l-307 614h205l-205 615h205l614-819h-205z m0 102l-460 614h-12l205-614h-181l204-410h347l-307 410h204z m-409 1434v-615h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638z m1126-1332v1229h410v-1229h-410z"},{type:"path",className:"OfficeIconColors_m20",d:"M205 1331h0v615h0v-615z m1638 615h0v-1434h0v1434z m-512-1434v-410h0v410h0z m-435-307l-77 103h205l-205 273v1262h410v-1638h-333z m-179 512l0 0v102h0v-102z m-154 205l-256 342v579h410v-921h-154z m768-308h410v1229h-410v-1229z"},{type:"path",className:"OfficeIconColors_m22",d:"M205 1331h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638v-615z m1536-717h-410v1229h410v-1229z"},{type:"path",className:"OfficeIconColors_m212",d:"M614 512l-460 614h-12l205-614h-181l204-410h347l-307 410h204z"},{type:"path",className:"OfficeIconColors_m211",d:"M922 0l-308 410h205l-614 819h-205l205-615h-205l307-614h615z m-768 1126l460-614h-204l307-410h-347l-204 410h181l-205 614h12z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"GrowFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 m 1108 157 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1873 512 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ShrinkFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 m -507 1433 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1371 1638 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Bold_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Italic_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Underline_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 234 -614 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 79 v 144 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 l 58 59 q 15 -12 38 -28 q 22 -16 50 -30 q 27 -13 58 -23 q 30 -9 62 -9 q 11 0 21 1 q 9 2 20 4 q 69 18 113 63 q 43 45 67 105 q 24 60 33 128 q 9 69 9 135 q 0 55 -4 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -19 -74 -37 -144 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -29 -9 -52 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -691 689 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 269 921 l 644 -644 l 542 542 l -644 644 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1331 652 q 27 -25 58 -44 q 26 -17 60 -31 q 33 -14 68 -14 q 18 0 33 4 q 55 14 90 50 q 34 37 54 85 q 19 48 26 103 q 7 55 7 107 q 0 44 -3 82 q -3 38 -6 65 q -5 39 -16 78 q -12 39 -26 71 q -16 37 -34 72 q -16 -59 -30 -115 q -12 -48 -23 -100 q -12 -52 -17 -89 q -8 -57 -15 -89 q -8 -32 -14 -49 q -7 -19 -14 -26 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1536 512 q 69 18 112 63 q 43 45 68 105 q 24 60 33 129 q 8 69 8 134 q 0 55 -3 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -20 -75 -38 -145 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -28 -9 -51 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -127 -103 q 23 -10 45 -14 q 21 -3 40 -3 q 7 0 17 0 q 10 1 21 2 q 10 1 20 4 q 9 3 15 7 l 31 25 q 10 8 21 20 q 10 13 21 35 q 11 23 22 59 q 10 37 19 93 q 0 -298 -143 -333 q -10 -2 -16 -2 q -15 0 -31 4 q -16 5 -31 13 q -20 6 -46 19 q -26 14 -55 31 l -71 -57 q 34 -31 73 -56 q 33 -21 75 -39 q 41 -17 86 -17 q 18 0 41 5 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1510 819 l -691 689 l -585 -586 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 223 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FontColorNoPreview_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 2048 h -2048 v -512 h 2048 m -589 -102 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1459 1434 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Centered_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"RightAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LeftAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WrapText_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 m -1241 -697 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 584 429 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"IncreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 m 1024 297 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 m 1341 -1374 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 860 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"DecreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 m 1178 -721 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 m -625 343 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 614 860 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TableBorderColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 80 -85 v -1280 h 1376 l -84 85 h -1207 v 1109 h 412 l -27 86 m 272 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 46 0 87 17 q 41 17 72 46 q 30 30 48 69 q 17 39 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 m 914 -1115 l 195 190 l 46 -44 q 19 -18 30 -43 q 10 -25 10 -52 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 m -709 724 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -485 856 q -13 -60 -57 -103 q -45 -43 -107 -56 l -77 239 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 577 1365 l -27 86 h -470 v -1280 h 1376 l -84 85 h -1207 v 1109 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1863 263 q 26 26 40 59 q 13 33 13 67 q 0 35 -13 67 q -14 32 -40 58 l -759 768 q -6 -19 -12 -41 q -7 -21 -16 -44 q -9 -22 -23 -45 q -14 -22 -36 -43 q -14 -13 -34 -25 q -20 -11 -43 -21 q -23 -10 -47 -19 q -24 -8 -44 -14 l 694 -703 q 26 -34 58 -60 q 27 -23 62 -42 q 35 -19 77 -19 q 29 0 60 12 q 31 13 63 45 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 853 1031 q 10 2 35 13 q 24 11 50 25 q 30 16 64 36 q 45 43 70 89 q 25 47 37 88 l -358 98 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1898 232 q 32 32 49 71 q 17 40 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 l 138 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 44 0 85 15 q 41 15 73 46 m -965 785 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -726 936 l 241 -80 q -13 -60 -57 -103 q -45 -43 -107 -56 m 951 -610 q 19 -19 30 -44 q 10 -24 10 -51 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 l -44 43 l 195 190 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 285 -683 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 l 26 27 q 11 -12 32 -32 q 21 -20 49 -39 q 28 -19 62 -33 q 34 -13 70 -13 q 7 0 14 0 q 6 1 13 2 q 59 10 101 41 q 41 32 68 77 q 27 46 43 101 q 15 56 23 112 q 7 57 9 111 q 2 54 2 97 v 37 q 0 41 -7 88 q -8 48 -19 96 q -11 48 -24 92 q -14 45 -25 79 q -11 34 -19 54 q -8 21 -9 21 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -3 -5 -7 -10 q -4 -5 -8 -9 l -663 657 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 316 853 l 623 -622 l 537 537 l -623 622 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1237 498 q 25 -30 56 -55 q 26 -20 61 -38 q 34 -17 73 -17 q 5 0 11 0 q 5 1 11 2 q 49 8 84 34 q 34 27 57 65 q 23 39 37 85 q 13 47 20 94 q 6 48 8 93 q 2 46 2 82 v 54 q 0 49 -5 92 q -6 44 -13 76 q -8 39 -18 71 q -12 -89 -23 -165 q -5 -32 -11 -65 q -6 -32 -12 -60 q -6 -27 -11 -48 q -6 -21 -12 -30 q -8 -12 -24 -22 q -17 -9 -34 -16 q -20 -8 -42 -14 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1461 363 q 58 10 99 41 q 40 31 67 76 q 27 45 43 99 q 16 55 24 111 q 8 57 10 110 q 2 54 2 97 v 33 q 0 41 -7 89 q -7 48 -18 97 q -11 49 -23 94 q -13 46 -24 81 q -12 35 -20 56 q -8 22 -10 22 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -9 -14 -19 -22 q -11 -8 -21 -12 q -11 -4 -23 -5 l -45 -46 q 30 -16 53 -21 q 23 -5 40 -5 q 14 0 30 8 q 15 8 30 22 q 14 14 26 33 q 11 19 16 40 q -4 -63 -14 -123 q -11 -60 -32 -107 q -21 -46 -54 -75 q -33 -28 -81 -28 q -26 0 -53 14 q -27 14 -50 31 l 3 3 q -25 22 -59 62 l -65 -66 q 31 -36 67 -65 q 31 -24 71 -45 q 40 -20 86 -20 q 13 0 27 3 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1513 768 l -663 657 l -565 -572 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CommonControlChevronDown_12",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"GridCard_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1920 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BorderDrawToolGrid_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1005 1124 q -43 -76 -119 -119 l -71 188 m 1034 -887 l -144 -145 l -760 760 q 92 54 145 144 m 848 -847 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 m -1695 834 h 365 l -40 102 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -717 v 717 h 210 l -102 102 h -108 v 108 l -102 102 v -210 h -717 m 0 -819 v 717 h 717 v -717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 819 1634 q 240 -270 448 -482 q 59 -60 119 -120 q 60 -59 118 -113 q 57 -53 111 -99 q 53 -46 99 -80 q 46 -33 83 -52 q 36 -19 60 -19 q 8 0 12 1 q 41 11 68 28 q 26 17 41 37 q 15 20 21 41 q 6 22 6 42 q 0 17 -3 32 q -3 16 -7 27 q -4 13 -9 25 l -958 950 m -478 -60 h -396 v -1638 h 1638 v 312 q -58 8 -109 33 q -51 25 -93 67 l -921 921 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 922 1024 h -768 v -102 h 768 v -768 h 102 v 768 h 210 l -102 102 h -108 v 108 l -102 102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 530 1843 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -1536 v 1536 h 365 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 836 1609 q 77 27 134 84 q 56 57 83 133 l -362 145 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1065 921 q 92 54 145 144 l 759 -759 l -144 -145 m -890 1032 l 190 -69 q -43 -76 -119 -119 m 1052 -787 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesNone_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesVertical_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 0 v 1920 h -1792 v -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 1792 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 -896 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesHorizontal_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1792 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 1536 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesBoth_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 0 v 1920 h -1920 v -1920 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m -1792 1920 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1856 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 128 v -128 h 1920 v 128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopAndThickBottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m 0 1920 h -1920 v -256 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1792 h -1920 v -1728 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -1792 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 896 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m 0 384 h -128 v -126 h 128 m 0 382 h -128 v -128 h 128 m 512 -256 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1664 v 256 h -1920 v -256 m 1920 -1664 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1856 h -1920 v -1856 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m 1792 256 v 128 h -128 v -128 m 0 256 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m -1792 -1408 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 1024 -1280 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -128 256 h 128 v 126 h -128 m 0 132 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 640 -768 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1792 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BoxBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -1664 v 1664 h 1664 m -768 -768 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m -128 258 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 768 -768 v 128 h -128 v -128 m -256 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 1792 v -1664 h -1664 v 1664 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"NoBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WebGetLink_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"},{type:"path",className:"OfficeIconColors_m233",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CreateCustomAction_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 m -1136 -409 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1620 870 l -990 1024 h -173 l 424 -716 h -488 l 41 -77 h 257 v -410 h 410 v -384 h -240 l 82 -153 h 472 l -363 716 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 0 410 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"List_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 154 h 409 v 409 h -409 m 0 819 h 409 v 410 h -409 m 0 -1024 h 409 v 410 h -409 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ChartStylesGallery_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Gear_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1984 907 v 234 l -298 125 l -11 24 q -20 51 -47 95 q -28 45 -61 87 l -17 21 l 32 321 l -207 111 l -250 -204 l -27 3 q -18 2 -36 3 q -19 1 -38 1 q -24 0 -47 -2 q -24 -1 -47 -5 l -26 -4 l -258 197 l -203 -117 l 41 -321 l -16 -22 q -61 -77 -95 -164 l -11 -24 l -298 -125 v -234 l 298 -125 l 11 -24 q 20 -51 48 -96 q 27 -44 60 -86 l 17 -21 l -32 -321 l 207 -111 l 250 204 l 27 -3 q 18 -2 37 -3 q 18 -1 37 -1 q 24 1 48 2 q 23 1 46 5 l 26 4 l 258 -197 l 203 117 l -41 321 l 16 22 q 61 77 95 164 l 11 24 m -662 562 q 66 0 125 -25 q 58 -25 102 -69 q 43 -43 68 -102 q 25 -58 25 -124 q 0 -66 -25 -125 q -25 -58 -68 -102 q -44 -43 -102 -68 q -59 -25 -125 -25 q -66 0 -124 25 q -59 25 -102 68 q -44 44 -69 102 q -25 59 -25 125 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"}],viewBox:"0,0,2048,2048"},{type:"png",id:"Copilot_80",base64String:"iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABeASURBVHgB7VxdjF3XVV5rn3tnxjOOPaakTdIEXxcaoFXJ5IEf04DHlahUHshEpVJURGwjiiIQSioVib7gMVLVF0qcFlQqHjxWgxrUBk8eKiGB6nFpQgWq6jwUqUCZm5akIW3iGzfxnbn3nL1Zv/ucO048d+yZvHS2fXz+/77zrbW+tfa+Bthtu2237bbdttt2227bbT+ODWEb2+Gn0wJAOkZXnaMLd1JKst1m2pL8tX8AIu30h5DjZH8aPXbDNap+CS8//QJc+sYPYfjyGh2DvLsXEC+0WmH5tacOn4U3qW0LgHP/NJzHIp1BwI5saICUGijothqJvNgAanQ52SMmAlp3lr0BPHf2P9Owtw5IN+QbyJwOCwFlQsSVooATvZXDXdjhdsMA/vyX1x4KAKeb25h5I6wDxQJtbryU2yffgHpefYJttjlPFYH3g7//L2DwdA+BRniFIqQQEoYQaAWTYFjg6kQrvu+Ff9xZEFtwA+0d5147OVyrFkc2vg7bGhhlkHw970+NdajBFg7bNV/5l+eJgQoes04Zx8wTEGW5IDtGmtP+Q/R6Z+jgo7CD7boZeMffXT5OD3nGLxCTX9A9GI4AaFs2mGpS28smWj/QRt8YXx1C77Fv5yOKQsw10bwBJM15u6ALMm+10tHu8i+uwA6162LgLWcudaph9cjG7Q6UsIneMxIqiCOwjbhA+ovJTJF2jH7MJmtpWvu3/+NDkrCNgBIACbyCmFeEhv9jUGXOx9F2QApssAI71K4LwKpM5ypIs+ah0LDQv0lBkUUnGdSxwbbrIp+fInsscZt6uu9FO5dmgwTr3+7JxyA/R6wDNAayyaaihajmKz4wszEFeaxjdLWHYYfalk149q9fPE4vcCYm8UMMAUalD1rQlBcXBiaHVc+lEwRgWZZJgLZgkYGVk/mgii5IGED5ncswfPpFMdlWCxU8ChytQphI/o+ZaYASuEnAk7AsINL1jnYfe88K7EDbMgNTqk6WJSp91M0ZCwGy8xNGJRSdIdQSNpFPihhHozPGRlCROR9bRREofA8GsfzvHzFAYq7q94iBDKT6QDNlOo+OiQVKaE5CQwWSLjQPO2TGWwJw32e+fzLF1GEaQeQPKxFS7dXILGYYfSUHEoKOlqIGjegbdb9ZASp7Y9R1onjkrVdKgB/0GTBiV0ISyuL/sgnzvGVsI1YmApNAS8BzdCbiEdihFrZ0dKyOM7X0JStGhDcSggxPhbzu2wTaWLEh8x9CQ5c13jLCcg6ArfP1+BqCHC0Tl2SKL/YtYDBwxMBCIzAHCjbn0AqJo0iiZZtombhOaEcC26b5zsOrs7ADbWwG3vTpVQIvdnjZImMyL+9sS4GA9KgqAGGWy6wtkh4bJS6r71PXieIYzVeyz5KPAHKX4fNXJDBopKUA4tHVWMgbIoFKoMlyKsxsCzdhdgshrVUVR+Ml2OY2NoAEz8mco1rwyAFAIIyqWKTpTsEFJVaABo8kqx6Xg7kARFPMdhxineMNnhtYlGUWEhTELAMPGazIQaNVqOkyiMFB1DmDGAN7jhab8RJscxsrCs9+ZnWeXvUr6tcZAWWRoYKYk62kbk+iih1Tg+bBRuKEA0qMyxHIABcvyW34vQj9r1ZQkJmy72u3OHjoMvk9FPMU89UpEkOhFQxYFOaB+kRm5aW9U9U7uouHerCNbSwGtsOVY8kiKmi8EJMzk5RjFCTPHpxtYCmrm3rSAoAlbxp7UH0o1h8ATTWuP8dRN4DqPjVhE8sElkXabLrEQjFd1G1qxkRV+5QBD1yO7YfoJqdgG9umDOw88s3Ztal4Se1KQbGga+tRWeVEcsYZGDCyXDNTVbPJFSskqJt0NgP88IlpwH6AVpsm1n1tlCgMFhygXUDFkZfZKEwsZDn7wsJY6ZEZ8JU0ke7uffzWLmxT25yBM1cWJtzygoMYc3BAZxfmioCBaaC5L1RgsAmkJydi0gacZzPrL7QhvRZEMEt9wFI44a+BIldQJqbkphtMyjAjNTrrF+LEOOAs3eX87CcvHe19/EAXtqFtCmAIa/cW7EtStARh1CRHmGY0xI0gB9vvZqumayastZrg1+ND6HaXvztlFRfwHFeRFrPUcoxEWmWcmy9pGzdhkzbGRHmwwIzEgwT96k2femmJUr9TvY/eGJDXNOG5M+dm+zB1SUOlpxmjJmkma6LaQnPeBpBNUkK2RmpsXKfJWAArjpKM+e4Tt1PpaorNt9duFcsUdS8UE6lHZtsjAQglf3qaMwVKmeu2d04Vsx9stY7twzA3EUJHPnVAfyKde+ijW3ZiuLgvQa+GArtVjM/Sp1k5vHjTCmzSrsnAqogLbVhTO0uxAUh+6RHJYdEWG6bsCYY8NTFRIrhcz7WfnpvUMer1Bj9qw/pLkyyUH52ZnljsLt89VuT894+tnkzD9HAclrPM6WS2oMtBJHr24nmCudeSfjl7Ei9GnvznP3mlG6t46v1/eWAJrgfANg7vTfbd5BmEeQqGO3+oHwXrqqj6uzDCQNSgAZnNFpfMt1pVho+5/PwM7158+Su/cuplGK997Y/+4/za2vo82St/agIrSL5TgxegCaquS+4Iyb2HKAIVU1oLSh269JnlB186svA3bzkBWwWwFfrzUIOEnq6OyBKBQgMIFjWgSf2a1bfUNQpgeLX5ZxFuJZ0rL0wtXf7q4VMwLni/941HYn9wRBLEVNDVFKzKQIsyFcZABzRmgP2tLLPF0YKaqIbjj//uC8/c//lbTm+89xv6wHu+8Nl54sT5/K58LYnCVilgxgRlzIhcyRc1fSjmEBUcbJi/lw8J+WC1Q16v1gt46tEjh9a+Pl5fxr/ef75Thsn/EYAYNK75yHJhLKQpCivRj6EIkyp5mgD6eXXZXosXUVJ0C3RqKbG3Z7B+6L7lUSH+hgxstdeOuUXWmQaM+jw0887rIMUEAVBQySbf1IS1ksnpnl6flUbcE5fHBU8eiMproVzjUEu3oTSPQFIEKFQTcNy7RN4ceV0+pJozCtvoeFmXK7kpI7h5JdQCr5pPnO2HcBw2dKC9IYBtXJt3f2rgWBhOkAVwliGuYMyU8z64Kno3ZQ96wPFlLZM9CVto7eFgHoVZ/OEqqh9Svid+kNgs3lA6AoiZ7H+l2krHuU8UD69lkJxHWRbf8OHBTJnOODIWgAvnFjvrsN4ZNU0FK2MKmX3GyhF5oymeOz81Eqs7GKDWX8maGGphgSRTVmDM9q0PnZsbxOpgAV4D0lJ4mWVRod8QCi9UAEsBBjGIn6Qqm4AVmLM5E/cwDK5N6WNo7wDctfEZXp+Bxdp8W0EyEAwozTik0wPk1vwxk4sD1Afkm0d/DNF0GMwFNkWEoKoPGOy6tHjhzAc+14UxG32iIwFLLgBK7Vofs6RYVtRcAv+m5P1oD7FSwKNgw3TnvmR+EwDP9C2v0jtg03IY8kNjAVgUa/e2vICCKjnrl8+Mc1HscgSCmWw2ez5efHNMNcCuwmpA62i8NfMtYLig7Kr8u2hkD9ofU1l44LSRKomplGjPzCu05Mtfn6Ox4OS+UJ/Gi+n+Ph6RxwJwBgdzzOwAdTrbkCweHJogCJuwGYldvqD168iLJetwchbrPcBiIeW3KzBmW73/C51BVc37C1aq2ziX04+FLrOS+jyat4R5SbQfszFqJJaQkmQwg1PFjNiCibmvRr3zGgB+5MvH5wKuH8yByKKmOlQ1W0Rnkn6vYMGgLkXZNmyatvlPO9frEug+BnF18f1fughjtqoazgd5An6FCtTdFOILmZV6TzFZFNMVEwxSCyIGCoyVemUBUf2fshAtJ9J6b7Y0fuDepgDua5WdmCrM2UVD26F/BWaOVli00OE+zGVp/vrSE+fdnNgAFzzgYGY0XoAttBZW94pYppChtlbIC1fCwigyRgMZaz1NdyJoBGbfx9xHYRy/SbQMXtior+tFN4sn+k7w7KYATobBXdIdJoEec4RtgCi4GQisrbOMMXP39drXhca6RWPJ7xV/FNOO8SxsCcByvhJJUoj7EJ+XI69TO3I5BqQLm4AK0rGKJt091Ws6o5BVLeRxJynrDjqyuymAe4H8X0hNQKAGxOYhuSm7T4ORIAMujEGlCvf+WoBWfxjVeGqf2Pv937iwAmO279//2Xky21mV7Ro8NE3UwlslwLFuK5L1H/I90eSKpnoMJ1hsBVWL0EgLXEMkq3OA5ioXNwVwGgedpN8mS4DMHM3mEmSbjPwOkntn81R9mh8lyFOmzEJI9r2NwVLng7gl86VazbGYWCcUaE5ewJOeVImpDE6RBDjJjIKApm8VIPvCbL4c6WqlqrYBWOOoPpCOfGYMANc7YH7LzrfesyTFTYCGL9MDajniTBTD1GMKzMOsEP0ffikzCzOaLcqXOI+h4u8nPk+GEHFQYGiwEPmSrK6ooUNzYgVMQZbAoembgBUBs2LcGG9V0fD7F13YDMCpMNifovq2nFUos7wqlTMKzYUbfi9HVjd1gCxb6kqbeR1jLu+L4w+7ePXDn5irUtWRWwahjgQMNVBjHQRRdxyFteoiICbxeynY9wzZfJkuBTTrTZh9oA124vyle/cXP7C5CU/CwM2t9oEqO1weqbsNyUex1ccq6OI3NEhk/ziSJAHkyhwfceF9R7/VhTFbVbTmQ4zMJVChXEhZgP2ediIUmreScGZ20l7Zl0AzDulckccJqgPFR4t2SI3+RWgkI1ooQnxdiXUVgHtwWPuq/NJ1ghPMBMEGsWmwUCxFPtRRpE7dMOWharVWNH+KYRm20EKr/C3u2OBRIUXUao76vUKUVMiD6zyIaLFAsw9UCWP2E2QshbyVqUZL2pLIhFxUUCzTk2MBOAXDLn2rg5BTOBwtWYGZKmSfCI2UrBF09Mu5GzDhPJrq0cXLABdgzNZ/cLFTlfGo6V8ewcmuUEAM7A9DRFcfXPtLZjRa8q4sB+aHtuqLJHbZdjSZTCaqnTHmnqri9d3M1QwM6xfptM5o9BV2iRQJ7vzrIoPrae27AS88pFqmQO0KUOWNa6zuu977/PjZB8C8Jg1RewcsTTNSCfPIupNG2STDk4KWroRh4gudfV5M9Sdj+dCoF9moO9QqTXr2zscf6I4HIJYrdIkFMHPQvMJ0YdM0PX0DYxV6xLcAgQZs7T9z6qYvK3RcgS00bKV7mXU8iMsuLAO80OeqOXlcR0JhnASRFEzCNEDL6ZsWFKRPBqy0i7Wn9qzqjZ/zKgCLMp5tt8tFepD96qeg+V2wGQhypQJGzNYzlWZAUZ8XkglqC/Bh/GEW5+fmO1UcLBShDdJxjCpB5QWjyybaU7Ffo5KWxH2pTQtIlXYMWwcEm3Clvk+A2+ik6jfmNTrnLIwL4N1Hu73vPPXW0/SdFkMwPzZ6aWVUrNWSs8oZlwsHvr2u7ko1ifcRIx59y+FXuzBmu+W2t51sTdLJMap84SFXksLaqE0veaJVnchsMUaFIkZLZYNkqSkFU1jBhViq7SJlL61dNfDK2x//wxUYF0BuP/3eF089/7WfOERmcAwbyqih89i/uf6zgfhJRhCA9X0psDXAIZu1DNG4ODGxZxHGbE/9wj0nZ2anj3PYFZuS5EFCpVaW+XYMVlRbkPDOj8FyLKqpohb9OEtlwePFAzD50ijnZ6qYn8ZrqoQ37BO57Z6Xj1/6+sw36es9TJftuDqpA4MLTAAYLW+h13ZDFvSerouBnyp+OS4CrMNmbXV+frbXr86sDWBh3803iW4xime2Sc4h4EiWgeKooxdTCK4Q1Zn5GCgjsCVnGlBis5xvUsbcX4Br+2mEMdprTxcL7VY4giV1NIc0m02Z/ymnO1Dt6djglnx3qRcwkDJ6l1KgQfsifO+Os/DS/p6U79aoDFXynK+hyyVt6/dbs2uDarY/gCP9PiwQeLM4NQN33vNu6cvQ6gBqjh91XX4mwIUoKTMHCdIaKYIQk3Wgu3AfoWeuOgsV9Jq7BMYgrou3V1f6Bw4sL/ZuCMDNWjr3oTkowkP0NsegpCcZ0p2HhOCQnn7A6zLXbXk9gsz5WFlOabiesE/EXJMppf46IgEI+25/G9z2rp/SZFABZHapnmewom23ESTJljWshiTDsUV1SQ+W2WxOQGU0AuQiHDTV2fK+z//pfdd69xv6rZw3vO+LrOVOpCd++xli1yNS6lXZrzS0LMSzt0bI88nqHzLYMtXCSNmx//b9ar6NPj79LRjqUH1hu3aEoMwBvIImLjmgAVYpQhhSdnYaKBpzA5XvE+OmRY6tjdLfDMgPfuk0seqEAFhFVr4y4B7ywH07cAREz7ERTKvb+FWd2tMTsPet0wKgTC2KqAxmPSWeoKjsGLohL+tx1BGSt6V8fCtfiyYCtfA5HdfSCVolVjDcNM3cVgAFxN/5hyUy47PyMyMBMdkvGZIxBTZMtfRnAgmJMoApzdw8DfzCDpgEBQUTkUuCBBQ4mLSucweVQawUsFZeRgGLJjvWrk/ElvNBP0YrLh1YWtx0VNi2mPBVraTe+5geEBBlwEDSfh8JKIqUmGwONKJnGW+RbsmGGrKt7rvjJgVNfZVHYPFr+hMVz0TUS4iqkREcWnWReqr7w2CBI1lWnixRj2D6XutHoJWys+O86rYzUB7oD5YvwoA6YIb0hCWhVBoLK2eigSqmrb6IwUv1YQJkRSv7Du4VU3OzQ2OfTK3KWENI87Iyh9ftuMrYxcfRl2MWGhv1WpUeZ9uTbBdz7+75q8WVcd51RwCUVsVlYVuZ1OGXBqAzsAZPKcfVFGWh9A7xrr137BX2caml6bfcTGmfvHAK7P8cRPNnLfWJWIOP6Of7toZ/rMGWaXHc19w5ANeqJ0WiOIjqE7kKaiZt+yr+RRipGHr+qtKEgknLQO47OFO/aGgEjZb5t7bMDZAqBwxjKtagUyrZ1oCiYMlxqQYyZabSvtU9n/rkWObLbWd8ILf1qYtQ9F8hpu0nAB24JL7Q19ls6ZmrkkgnAJLQIN/OQPI0/fZJBSOozlM/p4VOT+lQf2sMOixVfaQcn9BGYqDJJLB+YPuJow3rruskYN3/8OmtvOaOMRAXl3swqFZI1qAwkE24BDRTRmdfIvAkESFwSgaPwK0IjD23TsHEbFBGsYmGhrkFM0fzhTnyjvpJaDBSuo+hjrj5/GSSh1lK+1anP/EXp7fynjvHQG4V5ZEV1/AYuKiRWKWN+MRkpssJSUm4lLxOePD8J39uWnyf/ucHIFUYqQFIYS9aloFJB1EYD7m4EhFzpLXoazWsJN3FlsopL7EhnFk3hz+HLbad84HcrgzPCgOHFokZRGGgmC4OyUcOiH3DIW0eEhMpnWM28m879r9zUnRd9mmm/7KjD+IXzQ9qAEhB/F5yNtaRmL6Y+USZ2sbeZkAJ8MyePzu9BFtsOwognl7pEWAXc37M4FmezEANS60j8HzATKyUfXt/ZgpaM8kAS7UcoSk0nL9G4godPA4UyaNtEJnD5zfMvKrNfCQaV70JDPddzzvurAlzK9MyTXMm8JKYLflCAW2o07CsJ2birb8+remVjGmXTiGNwjqIQP9DAf7tv1S3glaeC+kx11EA1GuH1mNPekiGfuUuXvsZc6rL0FwF+yh+7HQXrqPtPIBX4FGS9cf5vwoguYKZcQ3gBmbCvLz/PZM4OVtoWYmfTkrIUctYwSKrdOhWmjUUMjpD/KD9ojQl78tRtHWQXtJefMg/VbHiW8JT7T/+3BJcZ9uWctZmbfDhX50jNM4PyzTLkmXADKzU9wmQ5Pt4DjMF/uwDB2ByNnjnLFgVx6otoGmcBYZc3kouVdDTN7D6IJiM0fJX0sEGNmSGZsXDEw/+7aNwA+1NAZBb//75Tn+9Ok8+rpN9H9cAS8QB+UacKeBOBm//BrdcF5kwa7rKI61Wn7WSo4aZZJSQR1+9gkdh/UWiXLNL559of2RpBW6wvWkAevvf3/y148MBHCMA7yImHgh7C9j/7km4+ZemoTWFr/eEqdGflTeCAZN/NWssTDE0zdN+4yMdSs9GDmgJzrZOPLal0RC7bbfttt2223bbbtttu223bWz/D8F4Mx2kB0G2AAAAAElFTkSuQmCC"}]}},5838:function(st,xe,b){"use strict";b.d(xe,{$:function(){return bt},z:function(){return dt()}}),b(90617),b(52601);var T=b(25834),S=b.n(T),ee=b(59215),K=b.n(ee),rt=b(51269),Oe=b.n(rt),Be=b(53581),ge=b.n(Be),ye=b(76902),Q=b.n(ye),ke=b(9382),he=b.n(ke),je=b(59419),de=b.n(je),we={};we.styleTagTransform=he(),we.setAttributes=ge(),we.insert=Oe().bind(null,"head"),we.domAPI=K(),we.insertStyleElement=Q(),S()(de(),we),de()&&de().locals&&de();var vt=b(3013),dt=b.n(vt),_e="onObjectSprite",bt={name:_e,sprite:window[_e]}},3013:function(st){st.exports={PBIData_20:"PBIData_20",PBIFormat_20:"PBIFormat_20",AudioBookmark_20:"AudioBookmark_20",LaunchSelectionPane_20:"LaunchSelectionPane_20",PBIPerformanceAnalyzer_20:"PBIPerformanceAnalyzer_20",PBISyncSlicer_20:"PBISyncSlicer_20",PBIBuild_20:"PBIBuild_20",PBIAddToChart_20:"PBIAddToChart_20",PBIAnomalyExplain_20:"PBIAnomalyExplain_20",PBINewQuickMeasure_20:"PBINewQuickMeasure_20",PBIPageVisuals_20:"PBIPageVisuals_20",addchartplaceholder_20:"addchartplaceholder_20",Paste_20:"Paste_20",CustomFieldGraphicalIndicatorGreenPlus_20:"CustomFieldGraphicalIndicatorGreenPlus_20",powermap_newtour_20:"powermap_newtour_20",suggestLightningBolt_20:"suggestLightningBolt_20",GrowFont_20:"GrowFont_20",ShrinkFont_20:"ShrinkFont_20",Bold_20:"Bold_20",Italic_20:"Italic_20",Underline_20:"Underline_20",FillColorSplitDropdown_20:"FillColorSplitDropdown_20",FontColorNoPreview_20:"FontColorNoPreview_20",Centered_20:"Centered_20",RightAlign_20:"RightAlign_20",LeftAlign_20:"LeftAlign_20",WrapText_20:"WrapText_20",IncreaseDecimal_20:"IncreaseDecimal_20",DecreaseDecimal_20:"DecreaseDecimal_20",TableBorderColorSplitDropdown_24:"TableBorderColorSplitDropdown_24",FillColorSplitDropdown_24:"FillColorSplitDropdown_24",CommonControlChevronDown_12:"CommonControlChevronDown_12",GridCard_24:"GridCard_24",BorderDrawToolGrid_20:"BorderDrawToolGrid_20",AccessGridlinesNone_16:"AccessGridlinesNone_16",AccessGridlinesVertical_16:"AccessGridlinesVertical_16",AccessGridlinesHorizontal_16:"AccessGridlinesHorizontal_16",AccessGridlinesBoth_16:"AccessGridlinesBoth_16",TopBorder_16:"TopBorder_16",TopAndThickBottomBorder_16:"TopAndThickBottomBorder_16",BottomBorder_16:"BottomBorder_16",BoxBorder_16:"BoxBorder_16",NoBorder_16:"NoBorder_16",WebGetLink_16:"WebGetLink_16",CreateCustomAction_20:"CreateCustomAction_20",List_20:"List_20",ChartStylesGallery_20:"ChartStylesGallery_20",Gear_16:"Gear_16",Copilot_80:"Copilot_80"}},59419:function(st,xe,b){var ce=b(51968),T=b(20806)(ce);T.push([st.id,"",""]),st.exports=T}}]);