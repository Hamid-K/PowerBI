(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["cartesianChart"],{45863:function(Ei,pa){var R,g;void 0!==(g="function"==typeof(R=function(){"use strict";var N="14.6.2";function J(M){M.parentElement.removeChild(M)}function G(M){return null!=M}function ie(M){M.preventDefault()}function he(M){return"number"==typeof M&&!isNaN(M)&&isFinite(M)}function U(M,w,ee){ee>0&&(ke(M,w),setTimeout(function(){Y(M,w)},ee))}function te(M){return Math.max(Math.min(M,100),0)}function q(M){return Array.isArray(M)?M:[M]}function Re(M){var w=(M=String(M)).split(".");return w.length>1?w[1].length:0}function ke(M,w){M.classList&&!/\s/.test(w)?M.classList.add(w):M.className+=" "+w}function Y(M,w){M.classList&&!/\s/.test(w)?M.classList.remove(w):M.className=M.className.replace(new RegExp("(^|\\b)"+w.split(" ").join("|")+"(\\b|$)","gi")," ")}function ht(M){var w=void 0!==window.pageXOffset,ee="CSS1Compat"===(M.compatMode||"");return{x:w?window.pageXOffset:ee?M.documentElement.scrollLeft:M.body.scrollLeft,y:w?window.pageYOffset:ee?M.documentElement.scrollTop:M.body.scrollTop}}function be(M,w){return 100/(w-M)}function Sn(M,w,ee){return 100*w/(M[ee+1]-M[ee])}function Wa(M,w){for(var ee=1;M>=w[ee];)ee+=1;return ee}function Dt(M,w,ee){if(ee>=M.slice(-1)[0])return 100;var Q=Wa(ee,M),ft=w[Q-1],Ht=w[Q];return ft+function(M,w){return Sn(M,M[0]<0?w+Math.abs(M[0]):w-M[0],0)}([M[Q-1],M[Q]],ee)/be(ft,Ht)}function Me(M,w,ee,Q){if(100===Q)return Q;var Ye=Wa(Q,M),gt=M[Ye-1],ft=M[Ye];return ee?Q-gt>(ft-gt)/2?ft:gt:w[Ye-1]?M[Ye-1]+function(M,w){return Math.round(M/w)*w}(Q-M[Ye-1],w[Ye-1]):Q}function Le(M,w,ee){var Q;if("number"==typeof w&&(w=[w]),!Array.isArray(w))throw new Error("noUiSlider ("+N+"): 'range' contains invalid value.");if(!he(Q="min"===M?0:"max"===M?100:parseFloat(M))||!he(w[0]))throw new Error("noUiSlider ("+N+"): 'range' value isn't numeric.");ee.xPct.push(Q),ee.xVal.push(w[0]),Q?ee.xSteps.push(!isNaN(w[1])&&w[1]):isNaN(w[1])||(ee.xSteps[0]=w[1]),ee.xHighestCompleteStep.push(0)}function Bi(M,w,ee){if(w){if(ee.xVal[M]===ee.xVal[M+1])return void(ee.xSteps[M]=ee.xHighestCompleteStep[M]=ee.xVal[M]);ee.xSteps[M]=Sn([ee.xVal[M],ee.xVal[M+1]],w,0)/be(ee.xPct[M],ee.xPct[M+1]);var Ye=Math.ceil(Number(((ee.xVal[M+1]-ee.xVal[M])/ee.xNumSteps[M]).toFixed(3))-1);ee.xHighestCompleteStep[M]=ee.xVal[M]+ee.xNumSteps[M]*Ye}}function Ce(M,w,ee){this.xPct=[],this.xVal=[],this.xSteps=[ee||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=w;var Q,Ye=[];for(Q in M)M.hasOwnProperty(Q)&&Ye.push([M[Q],Q]);for(Ye.sort(Ye.length&&"object"==typeof Ye[0][0]?function(gt,ft){return gt[0][0]-ft[0][0]}:function(gt,ft){return gt[0]-ft[0]}),Q=0;Q<Ye.length;Q++)Le(Ye[Q][1],Ye[Q][0],this);for(this.xNumSteps=this.xSteps.slice(0),Q=0;Q<this.xNumSteps.length;Q++)Bi(Q,this.xNumSteps[Q],this)}Ce.prototype.getDistance=function(M){var w,ee=[];for(w=0;w<this.xNumSteps.length-1;w++){var Q=this.xNumSteps[w];if(Q&&M/Q%1!=0)throw new Error("noUiSlider ("+N+"): 'limit', 'margin' and 'padding' of "+this.xPct[w]+"% range must be divisible by step.");ee[w]=Sn(this.xVal,M,w)}return ee},Ce.prototype.getAbsoluteDistance=function(M,w,ee){var Q=0;if(M<this.xPct[this.xPct.length-1])for(;M>this.xPct[Q+1];)Q++;else M===this.xPct[this.xPct.length-1]&&(Q=this.xPct.length-2);!ee&&M===this.xPct[Q+1]&&Q++;var Ye,gt=1,ft=w[Q],Ht=0,st=0,ca=0,na=0;for(Ye=ee?(M-this.xPct[Q])/(this.xPct[Q+1]-this.xPct[Q]):(this.xPct[Q+1]-M)/(this.xPct[Q+1]-this.xPct[Q]);ft>0;)Ht=this.xPct[Q+1+na]-this.xPct[Q+na],w[Q+na]*gt+100-100*Ye>100?(st=Ht*Ye,gt=(ft-100*Ye)/w[Q+na],Ye=1):(st=w[Q+na]*Ht/100*gt,gt=0),ee?(ca-=st,this.xPct.length+na>=1&&na--):(ca+=st,this.xPct.length-na>=1&&na++),ft=w[Q+na]*gt;return M+ca},Ce.prototype.toStepping=function(M){return Dt(this.xVal,this.xPct,M)},Ce.prototype.fromStepping=function(M){return function(M,w,ee){if(ee>=100)return M.slice(-1)[0];var Q=Wa(ee,w),ft=w[Q-1];return function(M,w){return w*(M[1]-M[0])/100+M[0]}([M[Q-1],M[Q]],(ee-ft)*be(ft,w[Q]))}(this.xVal,this.xPct,M)},Ce.prototype.getStep=function(M){return Me(this.xPct,this.xSteps,this.snap,M)},Ce.prototype.getDefaultStep=function(M,w,ee){var Q=Wa(M,this.xPct);return(100===M||w&&M===this.xPct[Q-1])&&(Q=Math.max(Q-1,1)),(this.xVal[Q]-this.xVal[Q-1])/ee},Ce.prototype.getNearbySteps=function(M){var w=Wa(M,this.xPct);return{stepBefore:{startValue:this.xVal[w-2],step:this.xNumSteps[w-2],highestStep:this.xHighestCompleteStep[w-2]},thisStep:{startValue:this.xVal[w-1],step:this.xNumSteps[w-1],highestStep:this.xHighestCompleteStep[w-1]},stepAfter:{startValue:this.xVal[w],step:this.xNumSteps[w],highestStep:this.xHighestCompleteStep[w]}}},Ce.prototype.countStepDecimals=function(){var M=this.xNumSteps.map(Re);return Math.max.apply(null,M)},Ce.prototype.convert=function(M){return this.getStep(this.toStepping(M))};var Hi={to:function(w){return void 0!==w&&w.toFixed(2)},from:Number},We={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"};function pi(M){if(function(M){return"object"==typeof M&&"function"==typeof M.to&&"function"==typeof M.from}(M))return!0;throw new Error("noUiSlider ("+N+"): 'format' requires 'to' and 'from' methods.")}function Pt(M,w){if(!he(w))throw new Error("noUiSlider ("+N+"): 'step' is not numeric.");M.singleStep=w}function Lt(M,w){if(!he(w))throw new Error("noUiSlider ("+N+"): 'keyboardPageMultiplier' is not numeric.");M.keyboardPageMultiplier=w}function io(M,w){if(!he(w))throw new Error("noUiSlider ("+N+"): 'keyboardDefaultStep' is not numeric.");M.keyboardDefaultStep=w}function Wi(M,w){if("object"!=typeof w||Array.isArray(w))throw new Error("noUiSlider ("+N+"): 'range' is not an object.");if(void 0===w.min||void 0===w.max)throw new Error("noUiSlider ("+N+"): Missing 'min' or 'max' in 'range'.");if(w.min===w.max)throw new Error("noUiSlider ("+N+"): 'range' 'min' and 'max' cannot be equal.");M.spectrum=new Ce(w,M.snap,M.singleStep)}function ra(M,w){if(w=q(w),!Array.isArray(w)||!w.length)throw new Error("noUiSlider ("+N+"): 'start' option is incorrect.");M.handles=w.length,M.start=w}function ro(M,w){if(M.snap=w,"boolean"!=typeof w)throw new Error("noUiSlider ("+N+"): 'snap' option must be a boolean.")}function we(M,w){if(M.animate=w,"boolean"!=typeof w)throw new Error("noUiSlider ("+N+"): 'animate' option must be a boolean.")}function Ta(M,w){if(M.animationDuration=w,"number"!=typeof w)throw new Error("noUiSlider ("+N+"): 'animationDuration' option must be a number.")}function Gi(M,w){var Q,ee=[!1];if("lower"===w?w=[!0,!1]:"upper"===w&&(w=[!1,!0]),!0===w||!1===w){for(Q=1;Q<M.handles;Q++)ee.push(w);ee.push(!1)}else{if(!Array.isArray(w)||!w.length||w.length!==M.handles+1)throw new Error("noUiSlider ("+N+"): 'connect' option doesn't match handle count.");ee=w}M.connect=ee}function xn(M,w){switch(w){case"horizontal":M.ort=0;break;case"vertical":M.ort=1;break;default:throw new Error("noUiSlider ("+N+"): 'orientation' option is invalid.")}}function St(M,w){if(!he(w))throw new Error("noUiSlider ("+N+"): 'margin' option must be numeric.");0!==w&&(M.margin=M.spectrum.getDistance(w))}function Cn(M,w){if(!he(w))throw new Error("noUiSlider ("+N+"): 'limit' option must be numeric.");if(M.limit=M.spectrum.getDistance(w),!M.limit||M.handles<2)throw new Error("noUiSlider ("+N+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function ne(M,w){var ee;if(!he(w)&&!Array.isArray(w))throw new Error("noUiSlider ("+N+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(w)&&2!==w.length&&!he(w[0])&&!he(w[1]))throw new Error("noUiSlider ("+N+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==w){for(Array.isArray(w)||(w=[w,w]),M.padding=[M.spectrum.getDistance(w[0]),M.spectrum.getDistance(w[1])],ee=0;ee<M.spectrum.xNumSteps.length-1;ee++)if(M.padding[0][ee]<0||M.padding[1][ee]<0)throw new Error("noUiSlider ("+N+"): 'padding' option must be a positive number(s).");if((w[0]+w[1])/(M.spectrum.xVal[M.spectrum.xVal.length-1]-M.spectrum.xVal[0])>1)throw new Error("noUiSlider ("+N+"): 'padding' option must not exceed 100% of the range.")}}function ur(M,w){switch(w){case"ltr":M.dir=0;break;case"rtl":M.dir=1;break;default:throw new Error("noUiSlider ("+N+"): 'direction' option was not recognized.")}}function Tt(M,w){if("string"!=typeof w)throw new Error("noUiSlider ("+N+"): 'behaviour' must be a string containing options.");var ee=w.indexOf("tap")>=0,Q=w.indexOf("drag")>=0,Ye=w.indexOf("fixed")>=0,gt=w.indexOf("snap")>=0,ft=w.indexOf("hover")>=0,Ht=w.indexOf("unconstrained")>=0;if(Ye){if(2!==M.handles)throw new Error("noUiSlider ("+N+"): 'fixed' behaviour must be used with 2 handles");St(M,M.start[1]-M.start[0])}if(Ht&&(M.margin||M.limit))throw new Error("noUiSlider ("+N+"): 'unconstrained' behaviour cannot be used with margin or limit");M.events={tap:ee||gt,drag:Q,fixed:Ye,snap:gt,hover:ft,unconstrained:Ht}}function qe(M,w){if(!1!==w)if(!0===w){M.tooltips=[];for(var ee=0;ee<M.handles;ee++)M.tooltips.push(!0)}else{if(M.tooltips=q(w),M.tooltips.length!==M.handles)throw new Error("noUiSlider ("+N+"): must pass a formatter for all handles.");M.tooltips.forEach(function(Q){if("boolean"!=typeof Q&&("object"!=typeof Q||"function"!=typeof Q.to))throw new Error("noUiSlider ("+N+"): 'tooltips' must be passed a formatter or 'false'.")})}}function cr(M,w){M.ariaFormat=w,pi(w)}function no(M,w){M.format=w,pi(w)}function dr(M,w){if(M.keyboardSupport=w,"boolean"!=typeof w)throw new Error("noUiSlider ("+N+"): 'keyboardSupport' option must be a boolean.")}function Ci(M,w){M.documentElement=w}function qt(M,w){if("string"!=typeof w&&!1!==w)throw new Error("noUiSlider ("+N+"): 'cssPrefix' must be a string or `false`.");M.cssPrefix=w}function Na(M,w){if("object"!=typeof w)throw new Error("noUiSlider ("+N+"): 'cssClasses' must be an object.");if("string"==typeof M.cssPrefix)for(var ee in M.cssClasses={},w)w.hasOwnProperty(ee)&&(M.cssClasses[ee]=M.cssPrefix+w[ee]);else M.cssClasses=w}function hr(M){var w={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:Hi,format:Hi},ee={step:{r:!1,t:Pt},keyboardPageMultiplier:{r:!1,t:Lt},keyboardDefaultStep:{r:!1,t:io},start:{r:!0,t:ra},connect:{r:!0,t:Gi},direction:{r:!0,t:ur},snap:{r:!1,t:ro},animate:{r:!1,t:we},animationDuration:{r:!1,t:Ta},range:{r:!0,t:Wi},orientation:{r:!1,t:xn},margin:{r:!1,t:St},limit:{r:!1,t:Cn},padding:{r:!1,t:ne},behaviour:{r:!0,t:Tt},ariaFormat:{r:!1,t:cr},format:{r:!1,t:no},tooltips:{r:!1,t:qe},keyboardSupport:{r:!0,t:dr},documentElement:{r:!1,t:Ci},cssPrefix:{r:!0,t:qt},cssClasses:{r:!0,t:Na}},Q={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:We,keyboardPageMultiplier:5,keyboardDefaultStep:10};M.format&&!M.ariaFormat&&(M.ariaFormat=M.format),Object.keys(ee).forEach(function(st){if(!G(M[st])&&void 0===Q[st]){if(ee[st].r)throw new Error("noUiSlider ("+N+"): '"+st+"' is required.");return!0}ee[st].t(w,G(M[st])?M[st]:Q[st])}),w.pips=M.pips;var Ye=document.createElement("div");return w.transformRule=void 0!==Ye.style.transform?"transform":void 0!==Ye.style.msTransform?"msTransform":"webkitTransform",w.style=[["left","top"],["right","bottom"]][w.dir][w.ort],w}function Ai(M,w,ee){var Ht,st,ca,na,ka,Ir,V,Q=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},gt=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var M=!1;try{var w=Object.defineProperty({},"passive",{get:function(){M=!0}});window.addEventListener("test",null,w)}catch{}return M}(),ft=M,ot=w.spectrum,wi=[],It=[],ti=[],cs=0,gi={},ji=M.ownerDocument,Ga=w.documentElement||ji.documentElement,zr=ji.body,ds=-1,Di=0,Ui=1,An=2,hs="rtl"===ji.dir||1===w.ort?0:100;function ai(V,z){var W=ji.createElement("div");return z&&ke(W,z),V.appendChild(W),W}function Er(V,z){var W=ai(V,w.cssClasses.origin),K=ai(W,w.cssClasses.handle);return ai(K,w.cssClasses.touchArea),K.setAttribute("data-handle",z),w.keyboardSupport&&(K.setAttribute("tabindex","0"),K.addEventListener("keydown",function(ue){return function(V,z){if(vs()||xa(z))return!1;var W=["Left","Right"],K=["Down","Up"],ue=["PageDown","PageUp"],de=["Home","End"];w.dir&&!w.ort?W.reverse():w.ort&&!w.dir&&(K.reverse(),ue.reverse());var bt,pe=V.key.replace("Arrow",""),Xe=pe===ue[0],tt=pe===ue[1],Ct=pe===K[0]||pe===W[0]||Xe,_t=pe===K[1]||pe===W[1]||tt,Ft=pe===de[1];if(!(Ct||_t||pe===de[0]||Ft))return!0;if(V.preventDefault(),_t||Ct){var Ca=w.keyboardPageMultiplier,Ti=Ct?0:1,oa=Zr(z)[Ti];if(null===oa)return!1;!1===oa&&(oa=ot.getDefaultStep(It[z],Ct,w.keyboardDefaultStep)),(tt||Xe)&&(oa*=Ca),oa=Math.max(oa,1e-7),bt=wi[z]+(oa*=Ct?-1:1)}else bt=Ft?w.spectrum.xVal[w.spectrum.xVal.length-1]:w.spectrum.xVal[0];return Pi(z,ot.toStepping(bt),!0,!0),Wt("slide",z),Wt("update",z),Wt("change",z),Wt("set",z),!1}(ue,z)})),K.setAttribute("role","slider"),K.setAttribute("aria-orientation",w.ort?"vertical":"horizontal"),0===z?ke(K,w.cssClasses.handleLower):z===w.handles-1&&ke(K,w.cssClasses.handleUpper),W}function ja(V,z){return!!z&&ai(V,w.cssClasses.connect)}function Dn(V,z){return!!w.tooltips[z]&&ai(V.firstChild,w.cssClasses.tooltip)}function vs(){return ft.hasAttribute("disabled")}function xa(V){return st[V].hasAttribute("disabled")}function Li(){ka&&(Gr("update.tooltips"),ka.forEach(function(V){V&&J(V)}),ka=null)}function Yi(){Li(),ka=st.map(Dn),Mn("update.tooltips",function(V,z,W){if(ka[z]){var K=V[z];!0!==w.tooltips[z]&&(K=w.tooltips[z].to(W[z])),ka[z].innerHTML=K}})}function _n(V,z,W){var K=ji.createElement("div"),ue=[];ue[Di]=w.cssClasses.valueNormal,ue[Ui]=w.cssClasses.valueLarge,ue[An]=w.cssClasses.valueSub;var de=[];de[Di]=w.cssClasses.markerNormal,de[Ui]=w.cssClasses.markerLarge,de[An]=w.cssClasses.markerSub;var pe=[w.cssClasses.valueHorizontal,w.cssClasses.valueVertical],Xe=[w.cssClasses.markerHorizontal,w.cssClasses.markerVertical];function tt(_t,Qt){var Ft=Qt===w.cssClasses.value;return Qt+" "+(Ft?pe:Xe)[w.ort]+" "+(Ft?ue:de)[_t]}return ke(K,w.cssClasses.pips),ke(K,0===w.ort?w.cssClasses.pipsHorizontal:w.cssClasses.pipsVertical),Object.keys(V).forEach(function(_t){!function(_t,Qt,Ft){if((Ft=z?z(Qt,Ft):Ft)!==ds){var bt=ai(K,!1);bt.className=tt(Ft,w.cssClasses.marker),bt.style[w.style]=_t+"%",Ft>Di&&((bt=ai(K,!1)).className=tt(Ft,w.cssClasses.value),bt.setAttribute("data-value",Qt),bt.style[w.style]=_t+"%",bt.innerHTML=W.to(Qt))}}(_t,V[_t][0],V[_t][1])}),K}function Br(){na&&(J(na),na=null)}function Hr(V){Br();var z=V.mode,K=V.filter||!1,Xe=function(V,z,W){function K(_t,Qt){return(_t+Qt).toFixed(7)/1}var ue={},de=ot.xVal[0],pe=ot.xVal[ot.xVal.length-1],Xe=!1,tt=!1,Ct=0;return(W=function(M){return M.filter(function(w){return!this[w]&&(this[w]=!0)},{})}(W.slice().sort(function(_t,Qt){return _t-Qt})))[0]!==de&&(W.unshift(de),Xe=!0),W[W.length-1]!==pe&&(W.push(pe),tt=!0),W.forEach(function(_t,Qt){var Ft,bt,Ca,oa,Ra,Kr,qr,Qr,Nn,Ti=_t,Ut=W[Qt+1],xs="steps"===z;if(xs&&(Ft=ot.xNumSteps[Qt]),Ft||(Ft=Ut-Ti),!1!==Ti)for(void 0===Ut&&(Ut=Ti),Ft=Math.max(Ft,1e-7),bt=Ti;bt<=Ut;bt=K(bt,Ft)){for(Nn=(Ra=(oa=ot.toStepping(bt))-Ct)/(Qr=Math.round(Ra/V)),Ca=1;Ca<=Qr;Ca+=1)ue[(Kr=Ct+Ca*Nn).toFixed(5)]=[ot.fromStepping(Kr),0];qr=W.indexOf(bt)>-1?Ui:xs?An:Di,!Qt&&Xe&&bt!==Ut&&(qr=0),bt===Ut&&tt||(ue[oa.toFixed(5)]=[bt,qr]),Ct=oa}}),ue}(V.density||1,z,function(V,z,W){if("range"===V||"steps"===V)return ot.xVal;if("count"===V){if(z<2)throw new Error("noUiSlider ("+N+"): 'values' (>= 2) required for mode 'count'.");var K=z-1,ue=100/K;for(z=[];K--;)z[K]=K*ue;z.push(100),V="positions"}return"positions"===V?z.map(function(de){return ot.fromStepping(W?ot.getStep(de):de)}):"values"===V?W?z.map(function(de){return ot.fromStepping(ot.getStep(ot.toStepping(de)))}):z:void 0}(z,V.values||!1,V.stepped||!1)),tt=V.format||{to:Math.round};return na=ft.appendChild(_n(Xe,K,tt))}function Pn(){var V=Ht.getBoundingClientRect(),z="offset"+["Width","Height"][w.ort];return 0===w.ort?V.width||Ht[z]:V.height||Ht[z]}function Ua(V,z,W,K){var ue=function(Xe){if(!(Xe=function(V,z,W){var pe,Xe,K=0===V.type.indexOf("touch"),ue=0===V.type.indexOf("mouse"),de=0===V.type.indexOf("pointer");if(0===V.type.indexOf("MSPointer")&&(de=!0),"mousedown"===V.type&&!V.buttons&&!V.touches)return!1;if(K){var tt=function(Ft){return Ft.target===W||W.contains(Ft.target)||Ft.target.shadowRoot&&Ft.target.shadowRoot.contains(W)};if("touchstart"===V.type){var Ct=Array.prototype.filter.call(V.touches,tt);if(Ct.length>1)return!1;pe=Ct[0].pageX,Xe=Ct[0].pageY}else{var _t=Array.prototype.find.call(V.changedTouches,tt);if(!_t)return!1;pe=_t.pageX,Xe=_t.pageY}}return z=z||ht(ji),(ue||de)&&(pe=V.clientX+z.x,Xe=V.clientY+z.y),V.pageOffset=z,V.points=[pe,Xe],V.cursor=ue||de,V}(Xe,K.pageOffset,K.target||z))||vs()&&!K.doNotReject||function(M,w){return M.classList?M.classList.contains(w):new RegExp("\\b"+w+"\\b").test(M.className)}(ft,w.cssClasses.tap)&&!K.doNotReject||V===Q.start&&void 0!==Xe.buttons&&Xe.buttons>1||K.hover&&Xe.buttons)return!1;gt||Xe.preventDefault(),Xe.calcPoint=Xe.points[w.ort],W(Xe,K)},de=[];return V.split(" ").forEach(function(pe){var Xe=!!gt&&{passive:!0};z.addEventListener(pe,ue,Xe),de.push([pe,ue,Xe])}),de}function gs(V){var W=100*(V-function(M,w){var ee=M.getBoundingClientRect(),Q=M.ownerDocument,Ye=Q.documentElement,gt=ht(Q);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(gt.x=0),w?ee.top+gt.y-Ye.clientTop:ee.left+gt.x-Ye.clientLeft}(Ht,w.ort))/Pn();return W=te(W),w.dir?100-W:W}function uo(V,z){"mouseout"===V.type&&"HTML"===V.target.nodeName&&null===V.relatedTarget&&Tn(V,z)}function co(V,z){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===V.buttons&&0!==z.buttonsProperty)return Tn(V,z);var W=(w.dir?-1:1)*(V.calcPoint-z.startCalcPoint);_i(W>0,100*W/z.baseSize,z.locations,z.handleNumbers)}function Tn(V,z){z.handle&&(Y(z.handle,w.cssClasses.active),cs-=1),z.listeners.forEach(function(W){Ga.removeEventListener(W[0],W[1],W[2])}),0===cs&&(Y(ft,w.cssClasses.drag),Ur(),V.cursor&&(zr.style.cursor="",zr.removeEventListener("selectstart",ie))),z.handleNumbers.forEach(function(W){Wt("change",W),Wt("set",W),Wt("end",W)})}function Xi(V,z){if(z.handleNumbers.some(xa))return!1;var W;1===z.handleNumbers.length&&(cs+=1,ke(W=st[z.handleNumbers[0]].children[0],w.cssClasses.active)),V.stopPropagation();var ue=[],de=Ua(Q.move,Ga,co,{target:V.target,handle:W,listeners:ue,startCalcPoint:V.calcPoint,baseSize:Pn(),pageOffset:V.pageOffset,handleNumbers:z.handleNumbers,buttonsProperty:V.buttons,locations:It.slice()}),pe=Ua(Q.end,Ga,Tn,{target:V.target,handle:W,listeners:ue,doNotReject:!0,handleNumbers:z.handleNumbers}),Xe=Ua("mouseout",Ga,uo,{target:V.target,handle:W,listeners:ue,doNotReject:!0,handleNumbers:z.handleNumbers});ue.push.apply(ue,de.concat(pe,Xe)),V.cursor&&(zr.style.cursor=getComputedStyle(V.target).cursor,st.length>1&&ke(ft,w.cssClasses.drag),zr.addEventListener("selectstart",ie,!1)),z.handleNumbers.forEach(function(tt){Wt("start",tt)})}function ho(V){V.stopPropagation();var z=gs(V.calcPoint),W=function(V){var z=100,W=!1;return st.forEach(function(K,ue){if(!xa(ue)){var de=It[ue],pe=Math.abs(de-V);(pe<z||pe<=z&&V>de||100===pe&&100===z)&&(W=ue,z=pe)}}),W}(z);if(!1===W)return!1;w.events.snap||U(ft,w.cssClasses.tap,w.animationDuration),Pi(W,z,!0,!0),Ur(),Wt("slide",W,!0),Wt("update",W,!0),Wt("change",W,!0),Wt("set",W,!0),w.events.snap&&Xi(V,{handleNumbers:[W]})}function Wr(V){var z=gs(V.calcPoint),W=ot.getStep(z),K=ot.fromStepping(W);Object.keys(gi).forEach(function(ue){"hover"===ue.split(".")[0]&&gi[ue].forEach(function(de){de.call(Ir,K)})})}function Mn(V,z){gi[V]=gi[V]||[],gi[V].push(z),"update"===V.split(".")[0]&&st.forEach(function(W,K){Wt("update",K)})}function Gr(V){var z=V&&V.split(".")[0],W=z&&V.substring(z.length);Object.keys(gi).forEach(function(K){var ue=K.split(".")[0],de=K.substring(ue.length);z&&z!==ue||W&&W!==de||delete gi[K]})}function Wt(V,z,W){Object.keys(gi).forEach(function(K){var ue=K.split(".")[0];V===ue&&gi[K].forEach(function(de){de.call(Ir,wi.map(w.format.to),z,wi.slice(),W||!1,It.slice(),Ir)})})}function jr(V,z,W,K,ue,de){var pe;return st.length>1&&!w.events.unconstrained&&(K&&z>0&&(pe=ot.getAbsoluteDistance(V[z-1],w.margin,0),W=Math.max(W,pe)),ue&&z<st.length-1&&(pe=ot.getAbsoluteDistance(V[z+1],w.margin,1),W=Math.min(W,pe))),st.length>1&&w.limit&&(K&&z>0&&(pe=ot.getAbsoluteDistance(V[z-1],w.limit,0),W=Math.min(W,pe)),ue&&z<st.length-1&&(pe=ot.getAbsoluteDistance(V[z+1],w.limit,1),W=Math.max(W,pe))),w.padding&&(0===z&&(pe=ot.getAbsoluteDistance(0,w.padding[0],0),W=Math.max(W,pe)),z===st.length-1&&(pe=ot.getAbsoluteDistance(100,w.padding[1],1),W=Math.min(W,pe))),!((W=te(W=ot.getStep(W)))===V[z]&&!de)&&W}function vr(V,z){var W=w.ort;return(W?z:V)+", "+(W?V:z)}function _i(V,z,W,K){var ue=W.slice(),de=[!V,V],pe=[V,!V];K=K.slice(),V&&K.reverse(),K.length>1?K.forEach(function(tt,Ct){var _t=jr(ue,tt,ue[tt]+z,de[Ct],pe[Ct],!1);!1===_t?z=0:(z=_t-ue[tt],ue[tt]=_t)}):de=pe=[!0];var Xe=!1;K.forEach(function(tt,Ct){Xe=Pi(tt,W[tt]+z,de[Ct],pe[Ct])||Xe}),Xe&&K.forEach(function(tt){Wt("update",tt),Wt("slide",tt)})}function Fn(V,z){return w.dir?100-V-z:V}function Ur(){ti.forEach(function(V){st[V].style.zIndex=3+(st.length+(It[V]>50?-1:1)*V)})}function Pi(V,z,W,K,ue){return ue||(z=jr(It,V,z,W,K,!1)),!1!==z&&(function(V,z){It[V]=z,wi[V]=ot.fromStepping(z);var K="translate("+vr(10*(Fn(z,0)-hs)+"%","0")+")";st[V].style[w.transformRule]=K,Vn(V),Vn(V+1)}(V,z),!0)}function Vn(V){if(ca[V]){var z=0,W=100;0!==V&&(z=It[V-1]),V!==ca.length-1&&(W=It[V]);var K=W-z,ue="translate("+vr(Fn(z,K)+"%","0")+")",de="scale("+vr(K/100,"1")+")";ca[V].style[w.transformRule]=ue+" "+de}}function fr(V,z){return null===V||!1===V||void 0===V||("number"==typeof V&&(V=String(V)),V=w.format.from(V),!1===(V=ot.toStepping(V))||isNaN(V))?It[z]:V}function Zi(V,z,W){var K=q(V);z=void 0===z||!!z,w.animate&&!(void 0===It[0])&&U(ft,w.cssClasses.tap,w.animationDuration),ti.forEach(function(pe){Pi(pe,fr(K[pe],pe),!0,!1,W)});for(var de=1===ti.length?0:1;de<ti.length;++de)ti.forEach(function(pe){Pi(pe,It[pe],!0,!0,W)});Ur(),ti.forEach(function(pe){Wt("update",pe),null!==K[pe]&&z&&Wt("set",pe)})}function pr(){var V=wi.map(w.format.to);return 1===V.length?V[0]:V}function Zr(V){var z=It[V],W=ot.getNearbySteps(z),K=wi[V],ue=W.thisStep.step,de=null;if(w.snap)return[K-W.stepBefore.startValue||null,W.stepAfter.startValue-K||null];!1!==ue&&K+ue>W.stepAfter.startValue&&(ue=W.stepAfter.startValue-K),de=K>W.thisStep.startValue?W.thisStep.step:!1!==W.stepBefore.step&&K-W.stepBefore.highestStep,100===z?ue=null:0===z&&(de=null);var pe=ot.countStepDecimals();return null!==ue&&!1!==ue&&(ue=Number(ue.toFixed(pe))),null!==de&&!1!==de&&(de=Number(de.toFixed(pe))),[de,ue]}return ke(V=ft,w.cssClasses.target),ke(V,0===w.dir?w.cssClasses.ltr:w.cssClasses.rtl),ke(V,0===w.ort?w.cssClasses.horizontal:w.cssClasses.vertical),ke(V,"rtl"===getComputedStyle(V).direction?w.cssClasses.textDirectionRtl:w.cssClasses.textDirectionLtr),Ht=ai(V,w.cssClasses.base),function(V,z){var W=ai(z,w.cssClasses.connects);st=[],(ca=[]).push(ja(W,V[0]));for(var K=0;K<w.handles;K++)st.push(Er(z,K)),ti[K]=K,ca.push(ja(W,V[K+1]))}(w.connect,Ht),function(V){V.fixed||st.forEach(function(z,W){Ua(Q.start,z.children[0],Xi,{handleNumbers:[W]})}),V.tap&&Ua(Q.start,Ht,ho,{}),V.hover&&Ua(Q.move,Ht,Wr,{hover:!0}),V.drag&&ca.forEach(function(z,W){if(!1!==z&&0!==W&&W!==ca.length-1){var K=st[W-1],ue=st[W],de=[z];ke(z,w.cssClasses.draggable),V.fixed&&(de.push(K.children[0]),de.push(ue.children[0])),de.forEach(function(pe){Ua(Q.start,pe,Xi,{handles:[K,ue],handleNumbers:[W-1,W]})})}})}(w.events),Zi(w.start),w.pips&&Hr(w.pips),w.tooltips&&Yi(),Mn("update",function(V,z,W,K,ue){ti.forEach(function(de){var pe=st[de],Xe=jr(It,de,0,!0,!0,!0),tt=jr(It,de,100,!0,!0,!0),Ct=ue[de];w.ariaFormat.to(W[de]),Xe=ot.fromStepping(Xe).toFixed(0),tt=ot.fromStepping(tt).toFixed(0),Ct=ot.fromStepping(Ct).toFixed(0),pe.children[0].setAttribute("aria-valuemin",Xe),pe.children[0].setAttribute("aria-valuemax",tt),pe.children[0].setAttribute("aria-valuenow",Ct)})}),Ir={destroy:function(){for(var V in w.cssClasses)w.cssClasses.hasOwnProperty(V)&&Y(ft,w.cssClasses[V]);for(;ft.firstChild;)ft.removeChild(ft.firstChild);delete ft.noUiSlider},steps:function(){return ti.map(Zr)},on:Mn,off:Gr,get:pr,set:Zi,setHandle:function(V,z,W,K){if(!((V=Number(V))>=0&&V<ti.length))throw new Error("noUiSlider ("+N+"): invalid handle number, got: "+V);Pi(V,fr(z,V),!0,!0,K),Wt("update",V),W&&Wt("set",V)},reset:function(V){Zi(w.start,V)},__moveHandles:function(z,W,K){_i(z,W,It,K)},options:ee,updateOptions:function(V,z){var W=pr(),K=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];K.forEach(function(de){void 0!==V[de]&&(ee[de]=V[de])});var ue=hr(ee);K.forEach(function(de){void 0!==V[de]&&(w[de]=ue[de])}),ot=ue.spectrum,w.margin=ue.margin,w.limit=ue.limit,w.padding=ue.padding,w.pips?Hr(w.pips):Br(),w.tooltips?Yi():Li(),It=[],Zi(V.start||W,z)},target:ft,removePips:Br,removeTooltips:Li,getTooltips:function(){return ka},getOrigins:function(){return st},pips:Hr}}return{__spectrum:Ce,version:N,cssClasses:We,create:function(M,w){if(!M||!M.nodeName)throw new Error("noUiSlider ("+N+"): create requires a single element, got: "+M);if(M.noUiSlider)throw new Error("noUiSlider ("+N+"): Slider was already initialized.");var Q=Ai(M,hr(w),w);return M.noUiSlider=Q,Q}}})?R.apply(pa,[]):R)&&(Ei.exports=g)},90390:function(Ei,pa,R){"use strict";R.r(pa),R.d(pa,{CartesianAxisRenderModeSelector:function(){return pl},CartesianCategoryLoadMoreDataHandler:function(){return kc},CartesianChart:function(){return Ip},SharedColorPalette:function(){return Tc}});var wt={};R.r(wt),R.d(wt,{DefaultInnerTickSize:function(){return Zi},DefaultRotation:function(){return Rn},DefaultRotationForYAxisHierarchy:function(){return xl},DefaultVerticalRotation:function(){return go},Mockable:function(){return de},StackedAxisPadding:function(){return fr},adjustDomainWithConstantPixelDifference:function(){return Ft},assertScalarDomain:function(){return Ca},axisFactory:function(){return pr},createAxis:function(){return Ra},createAxisLabel:function(){return Ic},createD3Scale_Band:function(){return mo},createD3Scale_Numeric:function(){return bo},createDomain:function(){return bt},createFormatter:function(){return ml},createScalarDomainOptions:function(){return Yt},createScale:function(){return yl},createStackedD3Axis:function(){return Nn},createUncertaintyAwareValueDomain:function(){return Cs},createValueDomain:function(){return po},defaultTickFormat:function(){return On},emptyDomain:function(){return _i},ensureValuesInRange:function(){return Ti},extendCreateAxisOptions:function(){return Kr},generateScalarDomainSources:function(){return Cl},getAxisFormatString:function(){return As},getBestNumberOfTicks:function(){return Zr},getCategoryThickness:function(){return Ct},getCategoryValueType:function(){return Ut},getHierStack:function(){return En},getMaxWidth:function(){return xo},getMergedUserDomains:function(){return Jr},getNumHierarchyLevels:function(){return Dl},getRecommendedNumberOfTicksForXAxis:function(){return Yr},getRecommendedNumberOfTicksForYAxis:function(){return Xr},getRecommendedTickValues:function(){return Ss},getTickLabelMargins:function(){return ue},hasForcedDomain:function(){return Ya},invertOrdinalScale:function(){return _t},invertOrdinalSimpleScaleWithDirection:function(){return Qt},invertScale:function(){return Xe},isHierarchical:function(){return In},isLogScaleAllowedFunc:function(){return So},isOrdinalAxisDomain:function(){return Rc},isScalarAxisDomain:function(){return Nc},isStackedAxisProperties:function(){return zn},mergeDomains:function(){return ii},mergeScalarAxisDomains:function(){return ga},powerOfTen:function(){return wl},rotate:function(){return yo},scaleShouldClamp:function(){return Al},shouldIncludeZero:function(){return oa},willLabelsFit:function(){return Sl},willLabelsWordBreak:function(){return bl}});var g=R(81337),N=R(22733),xt=R(86946),J=R(90120),G=R(95938),ie=R(51650),oe=R(95309),De=R(33777),Te=R(28579),he=R(46099),U=R(51660),te=R(86900),q=R(92783),Re=R(45545),ke=R(70569),Y=R(72902),zt=R(40739),ht=R(48766),Ue=R(45296),yt=R(44783),k=R(62458),be=R(39681),Sn=R(58778),F=R(56578),bn=R(60810),Wa=R(46135),Dt=R(38958),le=R(82755),Me=R(79154),Le=R(32041),Bi=R(64329),Ce=R(3087),Hi=R(38168),We=R(18664),pi=R(95519),Pt=R(80065),Lt=R(41640),io=R(68365),Wi=R(66001),ra=R(41414),ro=R(45059),we=R(72489),Ta=R(28326),Gi=R(80777),xn=R(37274),St=R(54522),Cn=R(44977),ne=R(53197),ur=R(38265),Tt=R(26543),qe=R(14599),cr=R(61297),no=R(91593),dr=R(32476),Ci=R(49511),qt=R(47316),Na=R(32105),hr=R(18765),Ai=R(92374),Je=R(76045),M=0,w=75,ee=.2,Ye=1,gt=1,st=36,ca="cartesianChart",ka=20,ot=2,wi=ur.Wn.regular.css,It=8,Ga=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],hs="foregroundNeutralLight";function Er(){return{categoryCount:0,categoryThickness:ka,outerPaddingRatio:0,innerPaddingRatio:0,isScalar:!1}}function ja(i,e){var t=e?{showAxisTitle:!0}:{};if(!i)return t;var a=i.objects;if(a){var r=a.categoryAxis;r&&((t=_.clone(r)).showAxisTitle=r.showAxisTitle??e)}return t}function wn(i,e,t){void 0===t&&(t="valueAxis");var a=e?{showAxisTitle:!0}:{};if(!i)return a;var r=i.objects;if(r){var n=r[t];n&&((a=_.clone(n)).showAxisTitle=n.showAxisTitle??e)}return a}function so(i){return void 0!==i.innerPadding?Math.round(100*i.innerPadding):void 0}function Dn(i,e){return!(!i||e&&e.axisType&&e.axisType!==ht.w.scalar)}function xa(i){return 13===i||14===i}function Li(i){var e=i.preferredCategoryWidth;return null==e?void 0:+e}function Yi(i,e,t,a){if(k.fF.assertValue(i,"data"),k.fF.assertValue(t,"type"),a)return(0,ne.v9)(t)?Ta.y3.fromTimeValue(e):e;if(t.text)return k.fF.assert(function(){return e<i.categories.length},"category index out of range"),i.categories[e];if(i&&i.series&&i.series.length>0){var r=i.series[0];if(r){var n=r.data;if(n){i.hasHighlights&&(e*=2);var s=n[e];if(s)return(0,ne.v9)(t)&&null!=s.categoryValue?Ta.y3.fromTimeValue(s.categoryValue):s.categoryValue}}}return e}function fs(i){if(_.isEmpty(i))return 0;for(var e=0,t=0,a=i;t<a.length;t++){var r=a[t];_.isEmpty(r.data)||(e=Math.max(r.data[r.data.length-1].categoryIndex,e))}return e}function ps(i,e){var t;return Tt.dw.builder().withCategory([e],i,null===(t=e?.source)||void 0===t?void 0:t.queryName,!0).createSelectionId()}function Ln(i,e){var t,r,a=!1;if(e){var n=_.head(i.categories);t=(a=(r=(0,xt.A8)(n))&&!_.isEmpty(r.values))?n:_.last(i.categories)}else t=_.isEmpty(i.categories)?{source:void 0,values:[(0,we.WU)(null)],identity:void 0}:_.last(i.categories);return{category:t,useScalarKeys:a,scalarKeys:r}}function _n(i){return i[0]}function Br(i){var e;return k.fF.assert(function(){return!_.isEmpty(i)},"getCategoryValueType layers"),null===(e=_.find(i,function(t){return t.getCategoryValueType&&t.hasData()}))||void 0===e?void 0:e.getCategoryValueType()}function Hr(i){var e,t,a,r,n;if(_.size(i)<1)return!1;var s=null===(n=null===(r=null===(a=null===(t=null===(e=i[0])||void 0===e?void 0:e.matrix)||void 0===t?void 0:t.rows)||void 0===a?void 0:a.levels)||void 0===r?void 0:r[0])||void 0===n?void 0:n.sources;return!(_.size(s)<1||_.isEmpty(i[0].matrix.rows.root.children))&&_.every(s,function(o){return(0,Dt.nu)(o,N.x.rows)})}function Pn(i){switch(i){case 7:case 6:case 8:return!0}return!1}function Ua(i){var e=i.categoryCount,t=i.availableWidth,a=i.isScalar,r=void 0!==a&&a,n=i.cartesianOptions,o=(void 0===n?{}:n).isScrollable,l=function(i){var e=i.categoryCount,t=i.availableWidth,a=i.isScalar,r=i.preferredCategoryWidth,n=i.outerPaddingRatio,s=function(i){var e,t,a,d,r=i.data,n=i.categoryCount,s=i.availableWidth,o=i.domain,l=i.isScalar,u=i.trimOrdinalDataOnOverflow,c=i.outerPaddingRatio;if(n<2)d=s*(1-c);else if(l&&o&&o.length>1){var h=function(i){var e=Number.MAX_VALUE;if(i.length>0)for(var t=i[0].data.filter(function(s){return!s.highlight}),a=function(o,l){var u=t[o+1].categoryValue,c=t[o].categoryValue;k.fF.assert(function(){return _.isNumber(u)},"nextValue"),k.fF.assert(function(){return _.isNumber(c)},"currentValue"),e=Math.min(e,Math.abs(u-c))},r=0,n=t.length-1;r<n;r++)a(r);return e}(null!==(e=r?.series)&&void 0!==e?e:[]);d=s*(h/(o[o.length-1]-o[0]+h*c*2));var f=null!==(a=null===(t=i.axisZoom)||void 0===t?void 0:t.getCategoryZoomFactor())&&void 0!==a?a:1;k.fF.assert(function(){return f>=1},"zoomFactor must be >= 1"),d=Math.max(d*f,2)}else d=s/(n+2*c),u&&(d=Math.max(d,ka));return d=Math.min(d,s/(3+2*c)),!l&&n>=3&&u?Math.max(d,ka):d}(i);if(a||null==r||r<s)return{categoryThickness:s,outerPaddingRatio:n};var o=Math.floor((t-r*n*2)/r);return o<=0?s=t/(1+2*n):o<e?(n=(t-r*o)/(2*r),s=r):s=Math.min(r,t),{categoryThickness:s,outerPaddingRatio:n}}(i),u=l.categoryThickness,c=l.outerPaddingRatio,h=(0,Lt.Uy)((t-u*c*2)/u),v=Math.min(h,e);return r||v<e&&o||(c=Math.max(0,(t-u*v)/2/u),c=(0,Lt.GG)(c,0)?0:c),{categoryCount:!r&&o?e:v,categoryThickness:u,outerPaddingRatio:c,innerPaddingRatio:i.innerPaddingRatio,isScalar:r}}function uo(i,e){return{x:i.x.show,y:i.y.show,y2:i.y2.show||e&&!1!==i.y2.show}}function Xi(i,e){var t,a,r=(0,le.RK)(i,cr.Xi),n=function(i){return{layoutType:i?.layoutType,rowCount:i?.rowCount,columnCount:i?.columnCount,backgroundColor:i?.backgroundColor,backgroundTransparency:i?.backgroundTransparency,gridPadding:i?.gridPadding,advancedPaddingOptions:i?.advancedPaddingOptions,columnPaddingInner:i?.columnPaddingInner,columnPaddingOuter:i?.columnPaddingOuter,rowPaddingInner:i?.rowPaddingInner,rowPaddingOuter:i?.rowPaddingOuter}}(r),s=function(i){return{layoutType:0,rowCount:cr.UE,columnCount:cr.ZO,backgroundColor:null,backgroundTransparency:0,gridline:{region:Ci.o.none,strokeShow:!1,strokePattern:qt.kY.solid,strokeWidth:1,strokeColor:J.v.getThemeColor(i,yt.md),strokeTransparency:0},advancedPaddingOptions:!1,gridPadding:12,columnPaddingInner:12,columnPaddingOuter:12,rowPaddingInner:12,rowPaddingOuter:12}}(e),o=J.v.create(e),l=r?.gridLineShow,u=null!==(t=r?.gridLineType)&&void 0!==t?t:s.gridline.region;!1===l?u=Ci.o.none:!0===l?(u===Ci.o.none||!u)&&(u=Ci.o.inner):null==l&&(l=u!==Ci.o.none);var c=(0,g.__assign)((0,g.__assign)({},n?.layoutType===no.r.auto?{layoutType:0,rowCount:s.rowCount,columnCount:s.columnCount}:{layoutType:1,rowCount:n?.rowCount||s.rowCount,columnCount:n?.columnCount||s.columnCount}),{backgroundColor:o.getColorForPropertyNameWithDefaultColor(r,qe.e0.smallMultiplesBackgroundColor.propertyName,s.backgroundColor,!0),backgroundTransparency:null!==(a=n?.backgroundTransparency)&&void 0!==a?a:s.backgroundTransparency,gridline:{region:u,strokeShow:l,strokePattern:(0,Je.N)(r,"gridLineStyle",s.gridline.strokePattern),strokeColor:o.getColorForPropertyNameWithDefaultColor(r,"gridLineColor",s.gridline.strokeColor),strokeWidth:(0,Je.N)(r,"gridLineWidth",s.gridline.strokeWidth),strokeTransparency:(0,Je.N)(r,"gridLineTransparency",s.gridline.strokeTransparency)}});return function(i,e,t){i.gridPadding=e&&void 0!==e.gridPadding?e.gridPadding:t.gridPadding,i.advancedPaddingOptions=e&&void 0!==e.advancedPaddingOptions?e.advancedPaddingOptions:t.advancedPaddingOptions;var a=e&&e.advancedPaddingOptions,r={gridPadding:i.gridPadding,gridLineRegion:i.gridline.region};i.columnPaddingInner=a&&void 0!==e.columnPaddingInner?e.columnPaddingInner:Wr(r,1),a&&void 0!==e.columnPaddingOuter?i.columnPaddingOuter=e.columnPaddingOuter:(r.defaultPadding=t.columnPaddingOuter,i.columnPaddingOuter=Wr(r,0)),i.rowPaddingInner=a&&void 0!==e.rowPaddingInner?e.rowPaddingInner:Wr(r,2),a&&void 0!==e.rowPaddingOuter?i.rowPaddingOuter=e.rowPaddingOuter:(r.defaultPadding=t.rowPaddingOuter,i.rowPaddingOuter=Wr(r,0))}(c,n,s),c}function Wr(i,e){var t=i.gridPadding,a=i.gridLineRegion,r=i.defaultPadding;switch(e){case 0:return dr.Me.typeHasOuterGridLines(a)?t:r;case 1:return dr.Me.typeHasVerticalGridLines(a)?t:ys(t);case 2:return dr.Me.typeHasHorizontalGridLines(a)?t:ys(t);default:k.fF.assertNever(e)}}function ys(i){return i%2==0?i/2:Math.ceil(i/2)}function kn(i,e){var t=(0,le.RK)(i,"subheader"),a=Mn(),r=J.v.create(e),n=(0,We.Zi)(t,{family:"fontFamily",size:"fontSize",color:"fontColor",bold:"bold",italic:"italic",underline:"underline"},r,e,a.ColorName,a.TextClassName,{color:J.v.getThemeColor(e,a.ColorName),size:Na.B.createFromPt(a.FontPointSize),family:a.FontFamily,weight:Me.AI,style:Me.AI,textDecoration:Me.zu}),s={top:0,bottom:2,left:5,right:0},o=n.size.px+s.top+s.bottom,l=a.Vertical,u=a.Horizontal,c=a.TitleWrap,d=a.Show,h=!1,v=!1,y=!1;if(t){switch(t.position){case hr.cL.top:l=0;break;case hr.cL.bottom:l=1}switch(t.alignment){case Ai.D.left:u=0;break;case Ai.D.center:u=1;break;case Ai.D.right:u=2}c=t.titleWrap,void 0!==t.show&&(d=t.show),void 0!==t.bold&&(h=t.bold),void 0!==t.italic&&(v=t.italic),void 0!==t.underline&&(y=t.underline)}return{fontProperties:n,show:d,height:o,margins:s,vertical:l,horizontal:u,titleWrap:c,labelBold:h,labelItalic:v,labelUnderline:y}}var Mn=function(){return{FontFamily:ur.Wn.regular.css,FontPointSize:8,ColorName:"foregroundNeutralSecondary",TextClassName:"title",Vertical:0,Horizontal:0,Show:!0,TitleWrap:!1,bold:!1,italic:!1,underline:!1}};function Wt(i,e){var t=d3.select(i.get(0)),a=t.select("svg");a.empty()&&((a=t.append("svg")).classed(ca,!0),a.style("position","absolute"));var r=(0,Y.EX)(a);return e&&a.attrs({width:e.width,height:e.height}),{element:a,clearCatcher:r}}function vr(i){return{maxRowCount:Math.floor(st/i.columnCount),maxColumnCount:Math.floor(st/i.rowCount)}}var _i=[0,0],Fn=35,ms=2,Ur=3,Pi=10,Vn=3,fr=5,Zi=6;function Yr(i){return i<300?3:i<500?5:8}function Xr(i){return i<150?3:i<300?5:8}function pr(i,e){switch(e){case ne.Or.top:return d3.axisTop(i);case ne.Or.right:return d3.axisRight(i);case ne.Or.bottom:return d3.axisBottom(i);case ne.Or.left:return d3.axisLeft(i);default:k.fF.assertNever(e)}}function On(i){return k.fF.warn('Using default (unformatted) tickFormat for value "'.concat(i,'"')),"".concat(i)}function Zr(i,e,t,a,r){var n=i[0],s=i[1];return k.fF.assert(function(){return t>=0},"maxTickCount must be greater or equal to zero"),isNaN(n)||isNaN(s)?Ur:n===s?r||a?1:Ur:(k.fF.assert(function(){return n<=s},"min value needs to be less or equal to max value"),t<=1||s<=1&&n>=-1||e.some(function(o){return o?.type&&!o.type.integer})?t:Math.min(s-n+1,t))}function Ss(i,e){var t=i.axis,r=(void 0===t?{}:t).logAxisScale,n=i.isScalar,s=i.domainOptions,o=i.isLogScaleAllowed,l=i.valueType,u=i.minTickInterval,c=e.scale,d=e.bestTickCount;if(e.isInvalidDomain)return[];if(n&&!_.isEmpty(s?.domain)&&1===d)return[s?.domain[0]];if(!n||(0,ne._9)(c))return function(i,e){if(i<=0)return[];var t=e.length;if(i>t)return e;for(var a=[],r=0,n=Math.ceil(t/i);r<t;r+=n)a.push(e[r]);return a}(d,c.domain());if((0,ne.v9)(l))return function(i,e){if(0===e[0]&&0===e[1])return[];var a=ro.EP.calculate(Ta.y3.fromTimeValue(e[0]),Ta.y3.fromTimeValue(e[1]),i).sequence.map(function(r){return r.getTime()});return Ti(a,e[0],e[1])}(d,c.domain());var h=function(i,e,t,a){if(!e.ticks)return k.fF.assertFail("must pass a quantitative scale to this method"),[];if(i<=1)return[];var n=i,s=e.ticks(n);if(s.length>i&&i>1){var o=e.domain();n=function(u,c,d){var h=(c-u)/d,v=Math.floor(Math.log(h)/Math.LN10),y=h/Math.pow(10,v);if(y>=Math.sqrt(50)){var f=Math.sqrt(2)*Math.pow(10,v+1);return Math.floor((c-u)/f)}if(y>=Math.sqrt(10)){var p=Math.sqrt(50)*Math.pow(10,v);return Math.floor((c-u)/p)}if(y>=Math.sqrt(2)){var S=Math.sqrt(10)*Math.pow(10,v);return Math.floor((c-u)/S)}var m=Math.sqrt(2)*Math.pow(10,v);return Math.floor((c-u)/m)}(o[0],o[1],s.length),s=e.ticks(n)}if(s.length<ms&&(s=e.ticks(n=i+1)),t&&s.length>1)for(var l=s[1]-s[0];l>0&&(0,Lt.Po)(l,t)&&n>2;){if(n--,(s=e.ticks(n)).length<ms){s=e.ticks(++n);break}l=s[1]-s[0]}return s.length<=1?[]:(a||(s=function(i,e){if(void 0===e&&(e=1e-5),!i||i.length<2)return i;var t=e*Math.abs(i[1]-i[0]);return i.map(function(a){return Math.abs(a)<=t?0:a})}(s)),k.fF.assert(function(){return 0===s.length||(0,Lt.bA)(s[0],e.domain()[0],Lt.BM)&&(0,Lt.bl)(s[s.length-1],e.domain()[1],Lt.BM)},"getRecommendedTickValuesForAQuantitativeRange should not generate tick values outside the scale"),s)}(d,c,u,r);if(r&&o)for(var v=0;h.length>10;)h=h.filter(function(y){return wl(y,v)}),v++;return h}function W(i,e,t){var a=10===e?.[0],r=10===e?.[1],n=r&&a&&i[0]>=i[1];(!a||n)&&(i[0]-=Math.abs(t[0]),e&&(e[0]=0)),(!r||n)&&(i[1]+=Math.abs(t[1]),e&&(e[1]=0))}function ue(i){var e=i.plotArea,t=i.yMarginLimit,a=i.textHeightMeasurer,r=i.textWidthMeasurer,n=i.axes,s=i.bottomMarginLimit,o=i.axesFontProperties,l=i.rotate90,u=i.showY1OnRight,c=i.shouldRenderAxis,d=c.x,h=c.y,v=c.y2,y=Dl(n),f=null!=y&&y>0;k.fF.assertValue(e,"options.plotArea"),k.fF.assertValue(n,"axes");var p=n.x,S=n.y1,m=n.y2;k.fF.assertValue(e,"plotArea"),k.fF.assertValue(r,"textWidthMeasurer"),k.fF.assertValue(a,"textHeightMeasurer"),k.fF.assertValue(p,"xAxis"),k.fF.assertValue(S,"yAxis");var b=p.values,x=0,C=0,A=0,T=0,P=0,D=0,L=0,B=p.categoryThickness?p.categoryThickness*(null!=p.innerPaddingRatio?.5-p.innerPaddingRatio/2:0):0,E=(0,ne._9)(p.scale),H=0;void 0!==p.outerPadding?H=p.outerPadding:void 0!==p.xLabelMaxWidth&&(H=Math.max(0,(e.width-p.xLabelMaxWidth*b.length)/2));var ve,fe,Z=d&&!_.isEmpty(b);if(0!==Yr(e.width)||0!==Xr(e.height)){var re=l||f&&p.isCategoryAxis?go:Rn;if(h){var Ae,ge=o.y.tickLabels;S.categoryIdentities&&(ge=(0,We.ED)(ge,{weight:"700"})),P=(Ae=de.getAxisTickLabelMargins(S,ge,r,a)).maxWidth,A=Math.max(A,Ae.overflow.top),T=Math.max(T,Ae.overflow.bottom),fe=Ae.textHeight}m&&v&&(D=(Ae=de.getAxisTickLabelMargins(m,o.y2.tickLabels,r,a)).maxWidth,A=Math.max(A,Ae.overflow.top),T=Math.max(T,Ae.overflow.bottom));var Pe=o.x.tickLabels,se=(0,We.qk)(Pe),Se=p.scale,Fe=Se.domain();if(ve=a(se),Z){var Ie=Math.floor(s/ve);p.categoryIdentities&&!p.willLabelsWordBreak&&(se.fontWeight="700");for(var xe=0,Ne=b.length;xe<Ne;xe++){var $e=void 0;se.text=b[xe];var je=r(se);if(p.willLabelsWordBreak){var et=_.isEmpty(p.categoryLabelMaxWidths)?p.xLabelMaxWidth:p.categoryLabelMaxWidths[xe];$e=(0,Wi.ql)(se.text,se,r,et,Ie).length*ve,je=et}else if(!p.willLabelsFit&&E){var rt=Pe.size.pt<=It;$e=je*re.sine+(rt?0:ve*re.cosine),je=je*re.cosine+(rt?0:ve*re.sine)}else $e=ve+-5;if(0===xe){if(E)x=p.willLabelsFit?je/2-B-H:je-B-H,x=Math.max(x,0);else if(Fe.length>1){var ze=0;ze=je/2-(kt=Se(Fe[p.invertAxis?1:0])),ze=Math.max(ze,0),p.invertAxis&&u?C=ze:x=ze}}else if(xe===Ne-1)if(E)(p.willLabelsFit||p.willLabelsWordBreak)&&(C=je/2-B-H,C=Math.max(C,0));else if(Fe.length>1){ze=0;var kt=Se(Fe[p.invertAxis?0:1]);ze=je/2-(e.width-kt),ze=Math.max(ze,0),p.invertAxis&&u?x=ze:C=ze}L=Math.max(L,$e)}x=Math.min(x,Fn),C=Math.min(C,Fn)}}var Qe,Ze=0,ct=0,Nt=Math.min(Math.max(T,Math.ceil(L)),s);if(u?(ct=Math.min(Math.max(x,D),t),Ze=Math.min(Math.max(C,P),t)):(ct=Math.min(Math.max(x,P),t),Ze=Math.min(Math.max(C,D),t)),f){var ea=function(){return Qe*(y-1)};p.isCategoryAxis&&Z?(Qe=ve+fr,Nt+=ea()):S.isCategoryAxis&&h?(Qe=fe+fr,u?Ze+=ea():ct+=ea()):Qe=0}return{yTop:Math.ceil(A),yLeft:Math.ceil(ct),yBottom:Math.ceil(T),yRight:Math.ceil(Ze),xMax:Math.ceil(Nt),stackHeight:Qe,axesOverflow:{top:Math.ceil(A),bottom:Math.ceil(T),left:Math.ceil(x),right:Math.ceil(C)}}}var de={getAxisTickLabelMargins:function(e,t,a,r){var n,l,u,s=e.scale,o=e.d3Axis.tickValues();if(_.isEmpty(o))return{maxWidth:0,overflow:{top:0,bottom:0}};if((0,ne._9)(s))l=(n=s.range())[0],u=n[1];else{var c=s.range();l=_.head(c),u=_.last(c)}var h,v,y,f,d=e.values;l<u?(h=l,v=s(_.head(o)),y=u,f=s(_.last(o))):(h=u,v=s(_.last(o)),y=l,f=s(_.head(o)));for(var p=(0,We.qk)(t,"".concat(_.head(d))),S=r(p),m=Math.max(0,-(v-S/2-h)),b=Math.max(0,f+S/2-y),x=0,C=0,A=d.length;C<A;C++)p.text="".concat(d[C]),x=Math.max(x,a(p));return{maxWidth:x,overflow:{top:m,bottom:b},textHeight:S}}};function Xe(i,e,t,a,r){return(0,ne._9)(i)?0===t?{value:_t(i,e)}:Qt(i,e,t,a,r):{value:i.invert(e)}}function tt(i){return(0,ne._9)(i)?i.domain().map(function(e){return i(e)}):i.range()}function Ct(i){var e=tt(i);if(e.length<2){if((0,ne._9)(i)){var t=i.range();return t[1]-t[0]}k.fF.assertFail("Unsupported axis type")}return e[1]-e[0]}function _t(i,e){var t=i.bandwidth(),a=tt(i),r=i.domain();return a.length<2||a[0]>e?r[0]||0:r[d3.bisect(a,e+(a[1]-a[0]-t)/2)-1]}function Qt(i,e,t,a,r){var n=tt(i),s=i.domain(),o=r||1,l=i.bandwidth()/o;if(0!==s.length){k.fF.assert(function(){return!_.some(s,function(S,m){return 0!==m&&S!==s[m-1]+1})});var u=1===a?l/2:0;if(n[0]+u>e)return 1===t?void 0:{value:s[0],seriesIndex:0};if(!(e>n[n.length-1]+l*o-u&&-1===t)){var c=u*t*-1,d=n[1]-n[0]-l*o;if(o>1){var h=d3.bisect(n,e)-1,v=i(s[h]),y=_.map(d3.range(o),function(S){return S*l+v}),f=d3.bisect(y,e+c)-1;return f<0?{value:s[h-1],seriesIndex:o-1}:-1===t&&f===o-1&&h!==n.length-1&&e+c+d>n[h+1]?{value:s[h+1],seriesIndex:0}:{value:s[h],seriesIndex:f}}-1===t&&(c+=d);var p=d3.bisect(n,e+c)-1;return{value:s[p],seriesIndex:0}}}}function Ft(i,e,t,a){if(t<i||a>e){var r=Math.abs(Math.min(t-i,0)),n=Math.max(a-e,0),s=e-i,l=i-r*Math.pow(s,2)/((s-n)*(s-r)-r*n);return{domain:[l,e+n*(e-l)/(s-n)],adjusted:!0}}return{domain:void 0,adjusted:!1}}function bt(i,e,t,a){if(t&&!(0,ne.c$)(e)){if(0===i.length)return;var n=_.flatMap(i,function(d){return _.flatMap(d.data,function(h){return[h?.categoryValue]})});return ga.apply(void 0,(0,g.__spreadArray)([Yt(d3.extent(n),0)],a||[],!1))}var s=[];if(!_.isEmpty(i))for(var l=0,u=i[0].data;l<u.length;l++){var c=u[l];c.highlight||s.push(c.categoryIndex)}return{domain:s,type:0}}function Ca(i){if(2!==i.length&&!_.every(i,function(t){return null==t||_.isNumber(t)}))throw new io.wJ("CartesianAxisScalarDomain")}function Ti(i,e,t){k.fF.assert(function(){return e<=t},"min must be less or equal to max");var a=i.filter(function(r){return r>=e&&r<=t});return a.length>=2?a:[e,t]}function Ut(i,e){return function(i){return i&&(i.bool||i.numeric||i.text||i.dateTime)}(i?.type)?i.type:Gi.Ge.fromDescriptor(e?{numeric:!0}:{text:!0})}function oa(i){var e=i?.domain;if(!e||2!==e.length)return!0;var t=i.domainSources;return!((10===t[0]?e[0]:void 0)>0||(10===t[1]?e[1]:void 0)<0)}function Ra(i){var e=qr(i);return i.axisZoom&&!i.skipAxisZoomUpdate&&(i.axisZoom.updateAxisOptions(e,i),e=qr(i)),e}function Kr(i){var e,t=i.isScalar,r=i.axis.logAxisScale,n=void 0!==r&&r,s=i.orientation,o=void 0===s?i.isVertical?ne.Or.left:ne.Or.bottom:s,l=i.metaDataColumn,u=i.outerPadding,c=void 0===u?0:u,d=i.innerPaddingRatio,h=void 0===d?ee:d,v=i.outerPaddingRatio,y=void 0===v?0:v,f=null===(e=i.domainOptions)||void 0===e?void 0:e.domain,S=Ut(l instanceof Array?_n(l):l,t),m=So(f,S);return(0,g.__assign)((0,g.__assign)((0,g.__assign)({},i),{isLogScaleAllowed:m,valueType:S,minTickInterval:t?Oc(i.formatString,S,i.is100Pct):void 0,hasDisallowedZeroInDomain:t&&!m&&n,orientation:o,innerPaddingRatio:h,outerPaddingRatio:y,outerPadding:0===c&&t&&i.isVertical?1:c}),i.isCategoryAxis&&function(i,e,t,a){var r;return!(!i||e&&"0"!==e&&"g"!==e&&"G"!==e||t&&1!==t||!(null!==(r=i.temporal)&&void 0!==r&&r.year||i.integer&&2===a?.length&&Qr(a[0])&&Qr(a[1])))}(S,i.formatString,i.axis.labelDisplayUnits,f)?{formatString:"0",useTickIntervalForDisplayUnits:!1}:{})}function qr(i){var e,t=Kr(i),a=t.domainOptions,n=(void 0===a?{}:a).domain,s=yl(t),o=s.scale,l=s.bestTickCount,u=o.domain(),c=i.categoryThickness;if(c&&t.isScalar&&2===n?.length){k.fF.assert(function(){return!(n[0]instanceof Date)||n[0]instanceof Ta.y3},"The domain has to be a no-Date object or a PBIFormattingDate");var d=n[1]-n[0],h=u[1]-u[0];d>0&&h>0&&(c=c*d/h)}var p,S,v=Ss(t,s),y=ml(s,t,v),f=pr(o,t.orientation).tickSizeInner(Zi).tickSizeOuter(0).ticks(l).tickValues(v);return!t.isScalar&&c?p=Math.max(1,c-2*ot):v.length>1?(p=function(i,e){return i&&!_.isEmpty(e)?Math.abs(i(e[1])-i(e[0])):1}(o,v),p-=2*Vn,t.margin&&(S=function(i,e,t,a,r){var n=_.times(e.length,_.constant(r)),s=t.left,o=t.right,l=i(_.head(e)),u=i(_.last(e)),c=tt(i),h=c[1],v=2*(Math.abs(l-c[0])+s+a),y=2*(Math.abs(u-h)+o+a);return n[0]=Math.min(v,r),n[e.length-1]=Math.min(y,r),n}(o,v,t.margin,t.outerPadding,p),p=void 0)):p=i.pixelSpan-2*Vn,{scale:s.scale,isInvalidDomain:s.isInvalidDomain,d3Axis:f,formatter:y,values:_.isEmpty(t.metaDataColumn)?[]:Vc(f,v,y,t.valueType,t.getValueFn),axisLabel:(0,St.O1)(t.metaDataColumn),xLabelMaxWidth:p,categoryLabelMaxWidths:S,categoryThickness:c,valueType:t.valueType,isCategoryAxis:t.isCategoryAxis,outerPadding:t.outerPadding,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio,isLogScaleAllowed:t.isLogScaleAllowed,dataDomain:null===(e=t.domainOptions)||void 0===e?void 0:e.domain,hasDisallowedZeroInDomain:t.hasDisallowedZeroInDomain,invertAxis:t.axis.invertAxis,orientation:t.orientation}}function Qr(i){return _.isNumber(i)&&i===Math.floor(i)&&i>-1e4&&i<1e4}function Nn(i){return k.fF.assertValue(i,"options is null or undefined"),k.fF.assertValue(i.d3axis,"options.axis is null or undefined"),k.fF.assertValue(i.scale,"options.scale is null or undefined"),k.fF.assertValue(i.tickFormat,"options.tickFormat is null or undefined"),pr(i.scale,null!=i.orient?i.orient:ne.Or.bottom).tickSizeInner(i.innerTickSize||0).tickSizeOuter(i.outerTickSize||0).ticks(i.d3axis.tickArguments()).tickValues(i.d3axis.tickValues()).tickFormat(i.tickFormat)}function yl(i){var e=i.pixelSpan,t=i.metaDataColumn,a=i.outerPadding,r=i.isScalar,n=i.isVertical,s=i.forcedTickCount,o=i.maxTickCount,l=i.allowSingleScalarTick,u=i.includeZero,c=i.domainOptions,d=i.zeroScalarDomain,h=i.minTickInterval,v=i.valueType,y=i.axis,f=y.logAxisScale,p=y.invertAxis,S=i.domainOptions,m=c?.domain;k.fF.assert(function(){return!l||l&&r},"allowSingleScalarTick should only be true if the chart is scalar"),k.fF.assert(function(){return!u||r&&u},"includeZero can only have an effect if the domain is scalar");var b=t instanceof Array?t:[t];if(null==m||2===m.length&&null==m[0]&&null==m[1]||2!==m.length&&r)return{isInvalidDomain:!0,scale:(0,ne.c$)(v)?mo(i,v.dateTime?_i:[]):bo(i,_i,f),bestTickCount:0};var x=n?Xr(e):Yr(e);o&&(x=Math.min(x,o));var D,C=x,A=i.axis.logAxisScale&&i.isLogScaleAllowed,T=m?.slice();if(T&&r){if(u){var P=A?_.every(T,function(L){return L>0})?1:-1:0;T[0]=Math.min(P,T[0]),T[T.length-1]=Math.max(P,T[T.length-1])}2===T.length&&(Ca(T),C=void 0!==s?0!==x?s:0:Zr(T,b,x,v.dateTime,l),T=function(i,e,t,a){return isNaN(i[0])||isNaN(i[1])?_i:(i[0]===i[1]?null==t||.2*Math.abs(i[1])>=t?W(i,e,[.2*i[0],.2*i[1]]):0!==i[1]&&W(i,e,[t,t]):a||Math.abs(i[0])<1e-4&&Math.abs(i[0]/(i[1]-i[0]))<1e-4&&10!==e?.[0]&&(i[0]=0),i)}(T,S.domainSources,h,f))}return r&&(v.numeric||v.dateTime)?(v.dateTime||(Ca(T),2===S.domain.length&&0===S.domain[0]&&0===S.domain[1]&&d&&(W(T,S.domainSources,d),void 0===s&&(C=Zr(T,b,x,v.dateTime,l)))),D=bo(i,T,A,C)):v.text||v.dateTime||v.numeric||v.bool?(D=mo(i,T),C=0===x?0:Math.min(T.length,(e-2*a)/ka)):(k.fF.assertFail("unsupported dataType, something other than text or numeric"),k.fF.assert(function(){return!!D},"scale must be defined")),n&&r&&D.range(tt(D).reverse()),p&&D.range(D.range().reverse()),function(i){for(var e=i.domain(),t=0,a=e.length;t<a;++t)e[t]===Number.POSITIVE_INFINITY?e[t]=Number.MAX_VALUE:e[t]===Number.NEGATIVE_INFINITY&&(e[t]=-Number.MAX_VALUE);i.domain(e)}(D),{scale:D,bestTickCount:C}}function ml(i,e,t){var r=i.bestTickCount,n=e.domainOptions,s=e.valueType,l=e.formatString,u=e.useTickIntervalForDisplayUnits,c=e.axis,d=c.logAxisScale,h=c.labelPrecision,v=c.labelDisplayUnits;if(e.isScalar){if(s.dateTime){var f=i.scale.domain();return(0,we.Ue)({format:l,value:Ta.y3.fromTimeValue(1===r?n.domain[0]:f[0]),value2:Ta.y3.fromTimeValue(1===r?n.domain[0]:f[1]),tickCount:r,columnType:s})}if(u&&t.length>1){var p=[t[0],t[1]];return d&&_.every(t,function(S){return S<=0})&&(p=[t[t.length-2],t[t.length-1]]),(0,we.Ue)({format:l,value:v||p[1]-p[0],value2:0,allowFormatBeautification:!0,columnType:s,precision:h??(0,ne.Gv)(p[0],p[1],v,l)})}if(1===t.length)return(0,we.Ue)({format:l,value:v||(u?_.head(t):0),allowFormatBeautification:!0,precision:h})}return(0,we.E3)(l,!0)}function Vc(i,e,t,a,r){return r||(r=function(s){return s}),t?(i.tickFormat(function(n){return t.format(r(n,a))}),e.map(function(n){return t.format(r(n,a))})):e.map(function(n){return r(n,a)})}function Oc(i,e,t){if(i&&!(0,Ta.iH)(i)){var r=(0,Ta.rH)(i,!0).precision;return i.indexOf("%")>-1&&(r+=2),Math.pow(10,-r)}return t?.01:e.integer?1:0}function po(i,e){if(k.fF.assertValue(i,"data"),0===i.length)return null;var t=_.flatMap(i,function(a){return _.flatMap(a.data,function(r){return[r?.value]})});return e&&t.push(0),d3.extent(t)}function Cs(i,e){if(k.fF.assertValue(i,"data"),0===i.length)return null;if(!_.some(i,function(r){var n;return null===(n=r.uncertainty)||void 0===n?void 0:n.renderUncertainty}))return po(i,e);var t=d3.min(i,function(r){var n;return null!==(n=r.uncertainty)&&void 0!==n&&n.renderUncertainty?d3.min(r.data,function(s){var o;return s&&d3.min([s.value,null===(o=s.uncertainty)||void 0===o?void 0:o.lower])}):d3.min(r.data,function(s){return s&&s.value})}),a=d3.max(i,function(r){var n;return null!==(n=r.uncertainty)&&void 0!==n&&n.renderUncertainty?d3.max(r.data,function(s){var o;return s&&d3.max([s.value,null===(o=s.uncertainty)||void 0===o?void 0:o.upper])}):d3.max(r.data,function(s){return s&&s.value})});return e&&(t=null==t?0:Math.min(t,0),a=null==a?0:Math.max(a,0)),[t,a]}function As(i){if(k.fF.assertValue(i,"data"),i.length>=1)for(var e=0,t=i;e<t.length;e++){var r=_.find(t[e].data,function(n){return n?.labelFormatString});if(r)return r.labelFormatString}}function Sl(i,e,t,a){var r=i.values;if(0===r.length)return!1;var n=void 0!==i.xLabelMaxWidth?i.xLabelMaxWidth:e/r.length;return!r.some(function(s){return a.text=s,t(a)>n})}function bl(i,e,t,a,r,n,s){var o=i.values,l=void 0!==i.xLabelMaxWidth?i.xLabelMaxWidth:t/o.length,u=e.bottom/Rn.sine,c=r(s),d=Math.max(1,Math.floor(e.bottom/c));return 0!==o.length&&!o.some(function(y){return s.text=y,!(0,Wi.r)(y)&&a(s)>l})&&o.filter(function(y,f){var m=Math.min((e.left+i.outerPadding+i.categoryThickness*(f+.5)-Pi)/Rn.cosine,u),b=(0,Wi.ql)(y,s,a,l,d,n).join(" ");s.text=y;var x=n(s,m);return(0,Cn.mC)(b).length>=(0,Cn.mC)(x).length}).length>=o.length>>1}var Rn={sine:Math.sin(Math.PI*(35/180)),cosine:Math.cos(Math.PI*(35/180)),tangent:Math.tan(Math.PI*(35/180)),transform:"rotate(-35)",dy:"-0.5em",textAnchor:"end"},go={sine:Math.sin(.5*Math.PI),cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.65em",textAnchor:"end"},xl={sine:Math.sin(.5*Math.PI),cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.45em",textAnchor:"middle",x:0,y:0,dx:0};function yo(i,e){var t=e.textTruncator,a=e.textProperties,r=e.needRotate,n=e.needEllipsis,s=e.axisProperties,o=e.margin,l=e.rotate90,u=e.firstVisibleNode,c=e.rotationPadding,d=void 0===c?0:c,h=e.dropLabelsOnOverlap,v=e.height,y=e.y1Hierarchy;if(r){k.fF.assert(function(){return(0,ne._9)(s.scale)},"Rotating non-ordinal scales is currently not supported");var ve,fe,f=y?xl:l?go:Rn,p=(0,Lt.GG)(Math.abs(f.cosine),0,1e-10),S=o.left-(p?Pi:0),m=Bi.FP.fromPointToPixel(It),x=parseFloat(a.fontSize),C=x<=m,A=Le.b.estimateSvgTextHeight(a),T=s.scale,P=tt(T),D=Ct(T),L=A*f.sine,O=p?0:A*f.cosine,E=L/2,j=(p?0:O/f.tangent)+E,H=E,Z=!!u;if(C)ve=v/f.sine,fe=-5.5;else{var re=m/2;fe=-(re+O)*f.sine,ve=r?(v-re-O-(!l||Z?0:re))/f.sine:void 0}var se,Ae=T.bandwidth()/2,Pe=D/2;se=h?Z?new xn._F(d+P[0]+Ae-Pe,j,H,u,T,Pe,d):new xn.LO(d-(l?0:S),j,H):new xn.DR;var Fe=-1;i.each(function(Ie,xe){var Ne=d3.select(this),$e=P[xe]+Ae;if(h&&se.willCollide($e))return se.skipItem($e),void Ne.text(null);se.addItem($e);var et,je=Ne.text();if(a.text=je,p)if(y&&l){if(!je)return;var _e=s;Fe=_.indexOf(_e.adjustedValues,je,Fe+1),et=_e.categoryLabelMaxWidths[Fe],k.fF.assert(function(){return!isNaN(et)},"stacked group allowedLength should be a valid number")}else et=ve;else et=((C?s.outerPadding+s.categoryThickness*(xe+.5):$e)+S-L)/f.cosine;if(l||n||et<ve){var vt=t(a,Math.min(et,ve));vt!==je&&Ne.text(vt)}var ze=Ne.attr("x");Ne.style("text-anchor",f.textAnchor).attrs({x:null!=f.x?f.x:ze,y:null!=f.y?f.y:x,dx:null!=f.dx?f.dx:fe,dy:f.dy,transform:f.transform})})}else i.each(function(Ie){var xe=d3.select(this),Ne=xe.text();a.text=Ne;var $e=xo(s,Ie),je=t(a,$e);je!==Ne&&xe.text(je),xe.style("text-anchor","middle").attrs({dx:"0em",dy:"1em",transform:"rotate(0)"})})}function mo(i,e){var t,a=i.categoryThickness?i.outerPadding/i.categoryThickness:0;return k.fF.assert(function(){return a>=0&&a<4},"outerPaddingRatio should be a value between zero and four"),d3.scaleBand().range([0,i.pixelSpan]).paddingInner(null!==(t=i.innerPaddingRatio)&&void 0!==t?t:ee).paddingOuter(a).domain(e)}function So(i,e){return null!=i&&!(0,ne.v9)(e)&&(i[0]>0&&i[1]>0||i[0]<0&&i[1]<0)}function bo(i,e,t,a){var r=(t?d3.scaleLog():d3.scaleLinear()).range([i.outerPadding,i.pixelSpan-i.outerPadding]).domain([e[0],e[1]]).clamp(t||i.shouldClamp);return!(0,ne.v9)(i.valueType)&&!i.preventNice&&!(i.allowSingleScalarTick&&2===e.length&&e[0]===e[1])&&e[0]!==-Number.MAX_VALUE&&e[1]!==Number.MAX_VALUE&&r.nice(t?void 0:a),r}function Nc(i){return 1===i?.type}function Rc(i){return 0===i?.type}function Jr(i){var e,t,a=_.filter(i.includeDomains,function(r){return _.includes(r.domainSources,10)});return null!==(t=null===(e=ga.apply(void 0,a))||void 0===e?void 0:e.domain)&&void 0!==t?t:[void 0,void 0]}function ii(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];for(var t,a,r=0,n=i;r<n.length;r++){var s=n[r];if(s){var o=s[0],l=s[1];null!=o&&(t=Math.min(o,void 0===t?Number.POSITIVE_INFINITY:t)),null!=l&&(a=Math.max(l,void 0===a?Number.NEGATIVE_INFINITY:a))}}return[t,a]}function Yt(i,e,t){if(i){k.fF.assert(function(){return void 0===i[0]||void 0===i[1]||Number.isNaN(i[0])||Number.isNaN(i[1])||i[0]<=i[1]},"min should be less or equal to max");var a={type:1,domain:i,domainSources:Cl(i,e),forced:t};return k.fF.assert(function(){return!_.includes(a.domainSources,10)||!(!Ya(a)||!a.domain)},"For a user-set domain, `forced` must be true and `domain` must be set"),a}}function Cl(i,e){return[null!=i[0]?e:void 0,null!=i[1]?e:void 0]}function ga(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t={forced:!1,source:0},a={forced:!1,source:0},r={forced:!1,source:0,value:null},n={forced:!1,source:0,value:null};function s(v,y){var f,p,S,m,b,x,C="min"===y,A=C?t:a,T=C?r:n,P=null!==(p=null===(f=v.domainSources)||void 0===f?void 0:f[C?0:1])&&void 0!==p?p:0,D=null!==(m=null===(S=v.forced)||void 0===S?void 0:S[C?0:1])&&void 0!==m&&m,L=v.domain[C?0:1];if(null!=L){var O=function(E){0===P&&(T.value=E,T.forced=D)};null==T.value&&O(L),P>A.source?(A.value=L,A.source=P,A.forced=D):P===A.source&&(D&&!A.forced?(A.value=L,A.forced=!0,O(L)):(D||!A.forced)&&(A.value=C?Math.min(L,null!==(b=A.value)&&void 0!==b?b:Number.POSITIVE_INFINITY):Math.max(L,null!==(x=A.value)&&void 0!==x?x:Number.NEGATIVE_INFINITY),O(A.value)))}}for(var o=0,l=i;o<l.length;o++){var u=l[o];!u||!u.domain||(s(u,"min"),s(u,"max"))}if(void 0!==t.value||void 0!==a.value){var c=null!=r.value&&null!=n.value&&(0===t.source||0===a.source)&&(t.value>n.value||a.value<r.value),d=c?r:t,h=c?n:a;return{type:1,domain:[d.value,h.value],forced:[d.forced,h.forced],domainSources:[d.source,h.source]}}}function Ya(i){var e,t;return(null===(e=i?.forced)||void 0===e?void 0:e[0])||(null===(t=i?.forced)||void 0===t?void 0:t[1])}function Ic(i,e,t,a){void 0===a&&(a=!1);var r=a?"secAxisStyle":"axisStyle";return i?.[r]?(0,ra.O1)(i[r],e,t):e}function Al(i,e){return!(!i||!e||i.length<2||e.length<2||i[0]===e[0]&&i[1]===e[1])}function wl(i,e){void 0===e&&(e=0);var t=Math.abs(i),a=Math.log(t)/Math.LN10;return a=Math.ceil(a-1e-12),t/Math.pow(10,a)==1&&a%Math.pow(2,e)==0}function In(i){return!0===i.isHierarchical}function zn(i){return!0===i.isStacked}function En(i){return In(i.x)?i.x.hierStack:In(i.y1)?i.y1.hierStack:[]}function Dl(i){return In(i.x)?i.x.numHierarchyLevels:In(i.y1)?i.y1.numHierarchyLevels:void 0}function xo(i,e){if(_.isEmpty(i.categoryLabelMaxWidths))return i.xLabelMaxWidth;if(zn(i))return i.categoryLabelMaxWidths[e];var a=i.d3Axis.tickValues().indexOf(e);return i.categoryLabelMaxWidths[a]}var Ll=R(45863),zc=(0,Me.CH)("noUi-target"),Ec=(0,Me.CH)("noUi-base"),_l=(0,Me.CH)("noUi-value"),Pl=(0,Me.CH)("noUi-handle"),Ml=function(){function i(){}return i.createOrUpdateSliders=function(e){var a=e.axesData,r=e.zoomAxes,n=e.zoomData,s=e.zoomExtents,o=e.hasYAxisCategorical,l=e.yFlipped,u=e.maxLabelWidthLeft,c=e.maxLabelWidthRight,d=e.resetEventHandlers,h=e.hideSliders,v=e.visualHostServices,y=e.invertedState;e.containers.each(function(f){var m,b,p=i.getAxisType(f,l),S=!1;if("y2"===p?(m=r.valueSecAxis,b=s.valueSecExtent):"y1"===p&&o||"x"===p&&!o?(m=r.categoryAxis,b=s.categoryExtent):(m=r.valueAxis,b=s.valueExtent),m){var x=i.getAxisData(p,a),C=m.scale.domain(),A=m.d3Axis.tickValues(),T=x.logAxisScale&&So(C),P=h?"none":i.getScaleType(C,T);"none"!==P&&T&&(b=i.calcLogSliderValues(b),C=i.calcLogSliderValues(C),A=i.calcLogSliderValues(A));var D=i.getFormatFn(m,P),L=d3.select(this),O=L.select(zc.selector);i.wasInverted(p,a,y)&&(O.node()&&O.node().noUiSlider.destroy(),S=!0),O.node()&&!S?i.updateSlider({slider:O,axisType:p,axisData:x,zoomData:n,hasYAxisCategorical:o,extent:b,scaleDomain:C,labelValues:A,maxLabelWidth:"left"===f?u:c,scaleType:P,formatFn:D,resetEventHandlers:d,visualHostServices:v}):i.createSlider({container:L,axisType:p,axisData:x,zoomData:n,hasYAxisCategorical:o,extent:b,scaleDomain:C,labelValues:A,maxLabelWidth:"left"===f?u:c,scaleType:P,formatFn:D,visualHostServices:v})}})},i.createSlider=function(e){var a=e.axisType,r=e.axisData,n=e.zoomData,s=e.hasYAxisCategorical,o=e.extent,l=e.scaleDomain,u=e.labelValues,c=e.maxLabelWidth,d=e.scaleType,h=e.formatFn,v=e.visualHostServices;if("none"!==d){var y=e.container.append("div").attr("rtl","rtl"===document.dir);(0,Ll.create)(y.node(),{start:o,range:{min:l[0],max:l[1]},margin:.001*(l[1]-l[0]),connect:!0,behaviour:"tap-drag",orientation:"x"===a?"horizontal":"vertical",direction:"x"===a?r.invertAxis?"rtl":"ltr":r.invertAxis?"ltr":"rtl",tooltips:!!n.showTooltip&&[{to:h},{to:h}],pips:n.showLabels?{mode:"values",values:u,format:{to:h,from:void 0}}:void 0}),y.select(Ec.selector).attr("drag-resize-disabled",!0).on("keydown",function(){return d3.event.stopPropagation()}),this.applyVisualAxisStyles(y,a,r,c);var f=this.getAxisZoomPropertyNames(a,s);y.node().querySelectorAll(Pl.selector).forEach(function(p){p.setAttribute("aria-label",e.visualHostServices.getLocalizedString("Visual_ZoomSlider"))}),y.node().noUiSlider.on("slide",_.throttle(function(p,S,m){i.onSlide(f.min,f.max,f.size,m,this.options.range.min,this.options.range.max,d,v)},100)),this.convertSliderToSubSelectable(y,a)}},i.updateSlider=function(e){var t=e.slider,a=e.axisType,r=e.axisData,n=e.zoomData,s=e.hasYAxisCategorical,o=e.extent,l=e.scaleDomain,u=e.labelValues,c=e.maxLabelWidth,d=e.scaleType,h=e.formatFn,v=e.resetEventHandlers,y=e.visualHostServices;if("none"!==d){if(t.node().noUiSlider.updateOptions({start:o,range:{min:l[0],max:l[1]},margin:.001*(l[1]-l[0]),tooltips:!!n.showTooltip&&[{to:h},{to:h}],pips:n.showLabels?{mode:"values",values:u,format:{to:h,from:void 0}}:null},!1),this.applyVisualAxisStyles(t,a,r,c),v){var f=this.getAxisZoomPropertyNames(a,s);t.node().noUiSlider.off("slide"),t.node().noUiSlider.on("slide",_.throttle(function(p,S,m){i.onSlide(f.min,f.max,f.size,m,this.options.range.min,this.options.range.max,d,y)},100))}this.convertSliderToSubSelectable(t,a)}else t.node().noUiSlider.destroy()},i.convertSliderToSubSelectable=function(e,t){var a=this;e.classed(U.cy,!0).attr(U.Ez,this.getAxisZoomSliderSubSelectableRegionAttribute(t)).attr(U.CK,"Visual_ZoomSlider").attr(U.QZ,0);var r=e.node();U.O5.setDataForElement(r,{getRegionOutlines:function(){return a.getSliderOutlines(r,t)}})},i.getSliderOutlines=function(e,t){var a=e.getBoundingClientRect(),r=e.querySelector(Pl.selector).getBoundingClientRect().width/2;return[{id:this.getAxisZoomSliderSubSelectableRegionAttribute(t),outline:{x:a.x-r,y:a.y-r,width:r+a.width+r,height:r+a.height+r,type:1}}]},i.getAxisZoomSliderSubSelectableRegionAttribute=function(e){switch(e){case"x":return"x-axis-zoom-slider";case"y1":return"y1-axis-zoom-slider";case"y2":return"y2-axis-zoom-slider";default:k.fF.assertFail("Unsupported axis type")}},i.destroySliders=function(e){var a=e.hasYAxisCategorical,r=e.yFlipped,n=e.visualHostServices;e.containers.each(function(s){var o=i.getAxisType(s,r);i.destroySlider({axisType:o,hasYAxisCategorical:a,visualHostServices:n})})},i.destroySlider=function(e){var r=e.visualHostServices,n=this.getAxisZoomPropertyNames(e.axisType,e.hasYAxisCategorical),s={};s[n.min]=!0,s[n.max]=!0,s[n.size]=!0,r.persistProperties({remove:[{objectName:"zoom",properties:s,selector:void 0}]},!0)},i.onSlide=function(e,t,a,r,n,s,o,l){var u={},c={};r=_.map(r,function(h){return i.calcOriginalValue(h,o)}),n=i.calcOriginalValue(n,o),s=i.calcOriginalValue(s,o);var d=r[1]-r[0];r[0]===n&&r[1]===s?(c[e]=!0,c[t]=!0,c[a]=!0):r[0]===n?(c[e]=!0,u[t]=1,u[a]=d):r[1]===s?(u[e]=1,c[t]=!0,u[a]=d):(u[e]=r[0],u[t]=r[1],c[a]=!0),l.persistProperties({merge:[{objectName:"zoom",properties:u,selector:void 0}],remove:[{objectName:"zoom",properties:c,selector:void 0}]},!0)},i.getAxisType=function(e,t){switch(e){case"bottom":return"x";case"left":return t?"y2":"y1";case"right":return t?"y1":"y2";default:k.fF.assertNever(e)}},i.getFormatFn=function(e,t){var a;if("none"!==t){var r=null!==(a=e.d3Axis.tickFormat())&&void 0!==a?a:On;return function(n){return r(i.calcOriginalValue(n,t),0)}}},i.calcLogSliderValues=function(e){return _.map(e,function(t){return i.log10(Math.abs(t))})},i.calcOriginalValue=function(e,t){switch(t){case"linear":return e;case"log":return Math.pow(10,e);case"rLog":return-Math.pow(10,e);default:k.fF.assertNever(t)}},i.applyVisualAxisStyles=function(e,t,a,r){var n=a.labelFontProperties;e.selectAll(_l.selector).styles((0,We.wB)(n)),"x"!==t&&e.selectAll(_l.selector).call(ne.oq,r,Le.b.svgEllipsis)},i.getAxisData=function(e,t){return t["y1"===e?"y":e]},i.getScaleType=function(e,t){return k.fF.assert(function(){return e[0]!==e[1]},"Scale domain should not have zero width"),t?(k.fF.assert(function(){return e[0]<0&&e[1]<0||e[0]>0&&e[1]>0},"Log scale domain should not cross or contain 0"),e[0]<0?"rLog":"log"):"linear"},i.log10=function(e){return Math.log(e)/Math.log(10)},i.wasInverted=function(e,t,a){return"x"===e&&a?.x!==t.x.invertAxis||"y1"===e&&a?.y!==t.y.invertAxis||"y2"===e&&a?.y2!==t.y2.invertAxis},i.getAxisZoomPropertyNames=function(e,t){return"y2"===e?{min:Ce.t.valueSecMin.propertyName,max:Ce.t.valueSecMax.propertyName,size:Ce.t.valueSecSize.propertyName}:"y1"===e&&t||"x"===e&&!t?{min:Ce.t.categoryMin.propertyName,max:Ce.t.categoryMax.propertyName,size:Ce.t.categorySize.propertyName}:{min:Ce.t.valueMin.propertyName,max:Ce.t.valueMax.propertyName,size:Ce.t.valueSize.propertyName}},i}(),Fl=(0,Me.CH)("zoom"),Vl=function(){function i(e,t,a,r){this.hostServices=t,this.isScrollable=a,this.featureSwitches=r,this._zoomData=(0,g.__assign)({},i.DefaultOptions),this.axesLabels={},this.zoomContext=d3.select(e.get(0)).append("div").attr("class","axisZoom").style("position","absolute"),this.zoomAxes={categoryAxis:void 0,valueAxis:void 0,valueSecAxis:void 0},this.zoomExtents={categoryExtent:void 0,valueExtent:void 0,valueSecExtent:void 0}}return i.prototype.destroy=function(){this.zoomContext.selectAll(Fl.selector).remove()},i.prototype.update=function(e){var t,a,r,n=e.dataViews,s=e.hasScalarCategoryAxis;if(this.hasSmallMultiples=e.hasSmallMultiples,this.hasYAxisCategorical=e.hasYAxisCategorical,this._zoomData=this.hasSmallMultiples||!this.isScrollable?(0,g.__assign)({},i.DefaultOptions):e.zoomData,s||(this._zoomData.showOnCategoryAxis=!1),this.hasValueAxis=!1,this.hasCategoryAxis=!1,this.hasY2Axis=!1,n){for(var o=0,l=n;o<l.length;o++){var u=l[o];this.hasCategoryAxis||(this.hasCategoryAxis=s&&((0,Dt.c5)(u,N.x.category)||(0,Dt.c5)(u,N.x.x))),this.hasValueAxis||(this.hasValueAxis=(0,Dt.c5)(u,N.x.y)),this.hasY2Axis||(this.hasY2Axis=(0,Dt.c5)(u,N.x.y2))}(t=this._zoomData).showOnValueAxis&&(t.showOnValueAxis=this.hasValueAxis),(a=this._zoomData).showOnValueSecAxis&&(a.showOnValueSecAxis=this.hasY2Axis),(r=this._zoomData).showOnCategoryAxis&&(r.showOnCategoryAxis=this.hasCategoryAxis)}},i.prototype.render=function(e){var t,r,n,s,a=this,o=(t=e.axesLayout).margin,l=t.shouldRenderAxis,u=e.axesData,c=(0,g.__assign)({},this.baseZoomAxesPosition);if(c.bottom){c.bottom.width-=o.left+o.right;var d=u?.showsSeriesLabels()?(0,pi.lr)(u.seriesLabelSettings,c.bottom.width):0;c.bottom.width-=d,c.bottom.left+=o.left+(u.seriesLabelSettings.position===Hi.M.left?d:0),!this.hasYAxisCategorical&&this.xOuterPadding&&(c.bottom.left+=this.xOuterPadding,c.bottom.width-=2*this.xOuterPadding)}c.left&&(c.left.top+=o.top,c.left.height-=o.top+o.bottom),c.right&&(c.right.top+=o.top,c.right.height-=o.top+o.bottom);var h=this.axesLabels,v=this.yFlipped,y=null===(r=this.zoomAxes.categoryAxis)||void 0===r?void 0:r.scale.domain(),f=null===(n=this.zoomAxes.valueAxis)||void 0===n?void 0:n.scale.domain(),p=null===(s=this.zoomAxes.valueSecAxis)||void 0===s?void 0:s.scale.domain(),m=!(l.x||l.y||l.y2)||y&&y[0]===y[1]||f&&f[0]===f[1]||p&&p[0]===p[1],b=this.featureSwitches&&this.featureSwitches.onObject,x=this;this.zoomContext.selectAll(Fl.selector).style("top",function(C){return c[C].top?"".concat(c[C].top,"px"):null}).style("left",function(C){return c[C].left?"".concat(c[C].left,"px"):null}).style("width",function(C){return"".concat(c[C].width,"px")}).style("height",function(C){return"".concat(c[C].height,"px")}).call(function(C){return Ml.createOrUpdateSliders({containers:C,axesData:u,zoomAxes:a.zoomAxes,zoomData:a.zoomData,zoomExtents:a.zoomExtents,hasYAxisCategorical:a.hasYAxisCategorical,yFlipped:a.yFlipped,maxLabelWidthLeft:a.maxZoomLabelWidthLeft,maxLabelWidthRight:a.maxZoomLabelWidthRight,resetEventHandlers:a.resetEventHandlers,hideSliders:m,visualHostServices:a.hostServices,invertedState:a.invertedState})}).each(function(C){var T,A=d3.select(this);switch(C){case"bottom":T="x";break;case"left":T=v?"y2":"y";break;case"right":T=v?"y":"y2";break;default:k.fF.assertFail(C)}var D,P=u[T].titleFontProperties,L=[];if(u[T].showAxisTitle&&!m){var O=h[T];k.fF.assertValue("axisZoom: axisLabel",O),!O&&e.showTitlePlaceholders&&b&&(O=x.hostServices.getLocalizedString("Format_AddAxisTitle"),D=!0),L=[O]}A.selectAll(".title").data(L,function(B){return B}).join(function(B){return B.append("span").attr("class","title")}).each(function(B){var fe,E=d3.select(this),j=(0,We.qk)(P,B),H=c[C].height,Z=c[C].width,ve=P.size.px;switch(C){case"bottom":fe=Z,E.style("top","".concat(H-ve,"px")).style("left","50%").style("width","100%").style("transform","translateX(-50%)");break;case"left":fe=H,E.style("width","".concat(H,"px")).style("transform","translateX(-".concat(H/2,"px)rotate(-90deg)")).style("top","".concat(H/2-i.SliderHandleRadius,"px"));break;case"right":fe=H,E.style("width","".concat(H,"px")).style("transform","translateX(-".concat(H/2-8,"px)rotate(-90deg)")).style("top","".concat(H/2-i.SliderHandleRadius,"px")).style("left","".concat(Z-ve,"px"));break;default:k.fF.assertNever(C)}if(E.styles((0,We.wB)(P)).text(Le.b.getTailoredTextOrDefault(j,fe)),b){E.classed(U.cy,!0).attr(U.CK,"Visual_Axis_Title").attr(U.QZ,1);var re=void 0;switch(T){case"x":E.attr(U.Ez,"x-axis-title"),re=(0,Pt.s4)(u.categoryAxis===u.x?N.p.categoryAxis.titleText:N.p.valueAxis.titleText,h.x);break;case"y":E.attr(U.Ez,"y1-axis-title"),re=(0,Pt.Mw)(u.categoryAxis===u.y?N.p.categoryAxis.titleText:N.p.valueAxis.titleText,h.y);break;case"y2":E.attr(U.Ez,"y2-axis-title"),re=(0,Pt.Mw)(N.p.valueAxis.secTitleText,h.y2);break;default:k.fF.assertFail(T)}D&&E.classed(U.Qh.class,!0),re&&E.attr(U.kv,JSON.stringify(re))}})}),this.invertedState={x:u.x.invertAxis,y:u.y.invertAxis,y2:u.y2.invertAxis}},i.prototype.renderContainers=function(e,t,a,r){var n,s=this;void 0===a&&(a=0),this.resetEventHandlers=void 0!==this.yFlipped&&t.y.switchAxisPosition!==this.yFlipped||void 0!==this.isLogScaleX&&t.x.logAxisScale!==this.isLogScaleX||void 0!==this.isLogScaleY1&&t.y.logAxisScale!==this.isLogScaleY1||void 0!==this.isLogScaleY2&&t.y2.logAxisScale!==this.isLogScaleY2,this.yFlipped=t.y.switchAxisPosition,this.isLogScaleX=t.x.logAxisScale,this.isLogScaleY1=t.y.logAxisScale,this.isLogScaleY2=t.y2.logAxisScale;var o={top:0,left:0,right:0,bottom:0},l=[];if(this.zoomData.show){var c=(n=this.zoomData).show,d=n.showOnCategoryAxis,h=n.showOnValueAxis,y=n.showLabels;if(c){var p=h&&!this.hasYAxisCategorical||d&&this.hasYAxisCategorical,S=n.showOnValueSecAxis;(d&&!this.hasYAxisCategorical||h&&this.hasYAxisCategorical)&&(o.bottom+=16,y&&(o.bottom+=t.x.labelFontProperties.size.px+i.StaticPadding),t.x.showAxisTitle&&(o.bottom+=t.x.titleFontProperties.size.px+i.StaticPadding),l.push("bottom")),(p&&!this.yFlipped||S&&this.yFlipped)&&(this.maxZoomLabelWidthLeft=this.getMaxYLabelWidth("left",this.yFlipped,t),o.left+=(y?16+this.maxZoomLabelWidthLeft+i.StaticPadding:16)+8,t.y.showAxisTitle&&!this.yFlipped?o.left+=t.y.titleFontProperties.size.px+i.StaticPadding:t.y2.showAxisTitle&&this.yFlipped&&(o.left+=t.y2.titleFontProperties.size.px+i.StaticPadding),l.push("left")),(S&&!this.yFlipped||p&&this.yFlipped)&&(this.maxZoomLabelWidthRight=this.getMaxYLabelWidth("right",this.yFlipped,t),o.right+=(y?16+this.maxZoomLabelWidthRight+i.StaticPadding:16)+8,t.y2.showAxisTitle&&!this.yFlipped?o.right+=t.y2.titleFontProperties.size.px+i.StaticPadding:t.y.showAxisTitle&&this.yFlipped&&(o.right+=t.y.titleFontProperties.size.px+i.StaticPadding),l.push("right"))}}this.baseZoomAxesPosition=this.calculateZoomAxesPositions(l,e,o,a);var b=this.zoomContext.selectAll(".zoom").data(l,function(A){return A});b.enter().append("div").attr("class",function(A){return"zoom zoom-".concat(A)}).attr("tabindex",0).attr("focus-nav-mode","Hierarchy").attr("role","group").attr("aria-label",this.hostServices.getLocalizedString("Slicer_Slider")).style("position","absolute");var x=b.exit();return this.resetEventHandlers||x.call(function(A){return Ml.destroySliders({containers:A,hasYAxisCategorical:s.hasYAxisCategorical,yFlipped:s.yFlipped,visualHostServices:s.hostServices})}),x.remove(),_.some(o,function(A){return 0!==A})?o:void 0},i.prototype.updateShowAxisTitles=function(e){var t,a=(t=this.zoomData).show,r=t.showOnCategoryAxis,n=t.showOnValueAxis;return a?{x:e.x&&!(this.hasYAxisCategorical?n:r),y:e.y&&!(this.hasYAxisCategorical?r:n),y2:e.y2&&!t.showOnValueSecAxis}:e},i.prototype.updateAxisTitles=function(e){this.zoomData.show&&(this.axesLabels=(0,g.__assign)((0,g.__assign)({},this.axesLabels),e))},i.prototype.getCategoryZoomFactor=function(){var e,t=null===(e=this.zoomAxes.categoryAxis)||void 0===e?void 0:e.scale.domain(),a=this.zoomExtents.categoryExtent;if(_.isEmpty(t)||_.isEmpty(a))return 1;var r=Math.abs(t[1]-t[0]),n=Math.abs(a[1]-a[0]);return 0===n?1:Math.max(1,r/n)},i.prototype.updateAxisOptions=function(e,t){var a,r,n;if(t.isScalar&&this.zoomData.show){var s=function(c,d){if(t.domainOptions){var h=t.domainOptions.domain,v=e.scale.domain();c=[Math.max(c[0],Math.min(h[0],v[0])),Math.min(c[1],Math.max(h[1],v[1]))]}c[0]=Math.min(c[0],c[1]),t.domainOptions=Yt(c),t.preventNice||(t.preventNice=d),t.includeZero&&(t.includeZero=!d)};if(t.isCategoryAxis){if(this.zoomData.showOnCategoryAxis){this.zoomAxes.categoryAxis=e;var o=(a=i.getAxisRange(e,this.zoomData.categoryMin,this.zoomData.categoryMax,this.zoomData.categorySize)).domain,l=a.force;this.zoomExtents.categoryExtent=o,s(o,l),this.hasYAxisCategorical||(this.xOuterPadding=e.outerPadding)}}else t.isSecValueAxis?this.zoomData.showOnValueSecAxis&&(this.zoomAxes.valueSecAxis=e,o=(r=i.getAxisRange(e,this.zoomData.valueSecMin,this.zoomData.valueSecMax,this.zoomData.valueSecSize)).domain,l=r.force,this.zoomExtents.valueSecExtent=o,s(o,l)):this.zoomData.showOnValueAxis&&(this.zoomAxes.valueAxis=e,o=(n=i.getAxisRange(e,this.zoomData.valueMin,this.zoomData.valueMax,this.zoomData.valueSize)).domain,l=n.force,this.zoomExtents.valueExtent=o,s(o,l))}},i.prototype.skipMergingValueAxisDomains=function(){return this.zoomData.show&&(this.zoomData.showOnValueAxis||this.zoomData.showOnValueSecAxis)},i.getAxisRange=function(e,t,a,r){var n=e.scale.domain(),s=[void 0,void 0];return null!=r?(k.fF.assert(function(){return t!==a},"axisZoom: only one of min/max should be set if size is set"),null!=a?(k.fF.assert(function(){return null==t},"axisZoom: if size and max is set, min should not (zooming linked to min extent)"),s=[n[0],Math.min(n[0]+r,n[1])]):(k.fF.assert(function(){return null==a},"axisZoom: if size and min is set, max should not (zooming linked to max extent)"),s=[Math.max(n[1]-r,n[0]),n[1]])):(s[0]=null!=t&&t>=n[0]&&t<n[1]?t:n[0],s[1]=null!=a&&a>n[0]&&a<=n[1]?a:n[1]),{domain:s,force:!(null==r&&null==a&&null==t||s[0]===n[0]&&s[1]===n[1])}},Object.defineProperty(i.prototype,"zoomData",{get:function(){return this._zoomData},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"context",{get:function(){return this.zoomContext},enumerable:!1,configurable:!0}),i.converter=function(e){var t,a=null===(t=e?.metadata)||void 0===t?void 0:t.objects;return{show:(0,le.NA)(a,Ce.t.show,i.DefaultOptions.show),showOnValueAxis:(0,le.NA)(a,Ce.t.showOnValueAxis,i.DefaultOptions.showOnValueAxis),valueMin:this.clampValue((0,le.NA)(a,Ce.t.valueMin,null)),valueMax:this.clampValue((0,le.NA)(a,Ce.t.valueMax,null)),valueSize:this.clampValue((0,le.NA)(a,Ce.t.valueSize,null)),showOnCategoryAxis:(0,le.NA)(a,Ce.t.showOnCategoryAxis,i.DefaultOptions.showOnCategoryAxis),categoryMin:this.clampValue((0,le.NA)(a,Ce.t.categoryMin,null)),categoryMax:this.clampValue((0,le.NA)(a,Ce.t.categoryMax,null)),categorySize:this.clampValue((0,le.NA)(a,Ce.t.categorySize,null)),showOnValueSecAxis:(0,le.NA)(a,Ce.t.showOnValueSecAxis,i.DefaultOptions.showOnValueSecAxis),valueSecMin:this.clampValue((0,le.NA)(a,Ce.t.valueSecMin,null)),valueSecMax:this.clampValue((0,le.NA)(a,Ce.t.valueSecMax,null)),valueSecSize:this.clampValue((0,le.NA)(a,Ce.t.valueSecSize,null)),showLabels:(0,le.NA)(a,Ce.t.showLabels,i.DefaultOptions.showLabels),showTooltip:(0,le.NA)(a,Ce.t.showTooltip,i.DefaultOptions.showTooltip)}},i.clampValue=function(e){return isNaN(e)||"number"!=typeof e?null:e},i.prototype.getZoomCard=function(e){var t=this;if(!this.hasSmallMultiples&&e){var r=this.zoomData;return new F.CQ(new F.lg("zoom"),"Visual_ZoomSlider",[Ce.t.show,Ce.t.showOnCategoryAxis,Ce.t.showOnValueAxis,Ce.t.showOnValueSecAxis,Ce.t.showLabels,Ce.t.showTooltip],function(s){return t.hostServices.getLocalizedString(s)}).addTopLevelToggle("show",function(){return new F.bd({descriptor:Ce.t.show,value:r.show}).build()}).addGroup(void 0,function(n){t.hasCategoryAxis&&n.addSimpleSlice("categoryAxis",new F.bd({descriptor:Ce.t.showOnCategoryAxis,value:r.showOnCategoryAxis}).build(),function(s){return s.withCustomDisplayName(t.hasYAxisCategorical?"Visual_YAxis_Hyphen":"Visual_XAxis_Hyphen")}),t.hasValueAxis&&n.addSimpleSlice("valueAxis",new F.bd({descriptor:Ce.t.showOnValueAxis,value:r.showOnValueAxis}).build(),function(s){return s.withCustomDisplayName(t.hasYAxisCategorical?"Visual_XAxis_Hyphen":"Visual_YAxis_Hyphen")}),t.hasY2Axis&&n.addSimpleSlice("valueSecAxis",new F.bd({descriptor:Ce.t.showOnValueSecAxis,value:r.showOnValueSecAxis}).build(),function(s){return s.withCustomDisplayName("Visual_Y2Axis_Hyphen")}),n.addSimpleSlice("labels",new F.bd({descriptor:Ce.t.showLabels,value:r.showLabels}).build()).addSimpleSlice("tooltips",new F.bd({descriptor:Ce.t.showTooltip,value:r.showTooltip}).build())}).build()}},i.prototype.calculateZoomAxesPositions=function(e,t,a,r){void 0===r&&(r=0);for(var n={},s=t.height-a.bottom-r,o=t.width-a.right,l={height:s-a.top,width:o-a.left},u=i.SliderHandleRadius,c=0,d=e;c<d.length;c++){var h=d[c];switch(h){case"bottom":n.bottom={top:s,left:a.left-u,width:l.width+2*u,height:a.bottom};break;case"left":n.left={top:-u,left:null,width:a.left,height:l.height+2*u};break;case"right":n.right={top:-u,left:o,width:a.right,height:l.height+2*u};break;default:k.fF.assertNever(h)}}return n},i.prototype.getMaxYLabelWidth=function(e,t,a){if(!a)return 50;var r=this.getAxisType(e,t),s=a["y1"===r?"y":r].labelFontProperties,o={text:"1234567",fontFamily:s.family,fontSize:Bi.FP.toString(s.size.px),fontWeight:s.weight,fontStyle:s.style,fontVariant:s.variant,whiteSpace:s.whiteSpace};return Le.b.measureSvgTextWidth(o)},i.prototype.getAxisType=function(e,t){var a;switch(e){case"bottom":a="x";break;case"left":a=t?"y2":"y1";break;case"right":a=t?"y1":"y2";break;default:k.fF.assertNever(e)}return a},i.DefaultOptions={show:!1,showOnValueAxis:!0,showOnValueSecAxis:!1,showOnCategoryAxis:!0,showLabels:!1,showTooltip:!1},i.StaticPadding=5,i.SliderHandleRadius=8,i}(),ye=R(56707),$r=R(78843),Ol=R(26743),Nl=R(39407),gr=R(82173),Bn=R(51490),lt=R(21181),Hc=R(48708);function Rl(i,e,t){return ws(function(a){return!a.supportsStaticReferenceLines||a.supportsStaticReferenceLines()},i,e,t)}function Il(i,e,t){return ws(function(a){return a.supportsTrendLine&&a.supportsTrendLine()},i,e,t)}function Gc(i,e,t){return!ws(function(a){return!a.getCartesianVisualCapabilities().isValueAxisIrregular},i,e,t)}function ws(i,e,t,a){var r=Ao(e);return!_.isEmpty(t)&&_.every(null==a?t:[t[a]],function(s,o){return!r[o]||i(s)})}function Ao(i){return _.isEmpty(i)?[]:_.filter(i,function(e){return!(0,q.Qp)(e)&&!(0,gr.Aq)(e)&&!(0,Bn.Ik)(e)})}function Ds(i,e,t){return i&&function(i){return xa(i)||0===i||1===i||2===i||3===i}(e)?function(i){if(i.length>1){var e=i[0].getSeriesLabelsSettings(),t=i[1].getSeriesLabelsSettings();return e.maxWidthPercentage>t.maxWidthPercentage?e:t}return i[0].getSeriesLabelsSettings()}(i):Hn(t)}function Hn(i){var e=J.v.getThemeColor(i||(0,Hc.Ue)(),ye.uQ);return{show:!1,seriesColor:e,position:Hi.M.right,fontProperties:(0,lt.bT)({style:i,labelColor:e,textClassName:"smallLightLabel"}).fontProperties,wordWrap:!1,maxWidthPercentage:20,defaultSeriesWidth:20,showLabelPerSeries:!1,enableBackground:!1,bold:!1,italic:!1,underline:!1}}function wo(i,e){if(i)return{categoryIndex:i.categoryIndex,categoryValue:i.categoryValue,hierarchyCategoryLevels:e,hasData:null!=i.value}}function zl(i,e){return i.map(function(t){return(0,G.BJ)(e.categoryData[t.categoryIndex].hierarchyCategoryLevels)})}var Ki=function(){function i(e,t,a){this.scrollbarWidth=t,this.isScrollable=e,this.trimOrdinalDataOnOverflow=a}return i.prototype.init=function(e){this.axesData=e.axesData,this.axisZoom=e.axisZoom,this.interactivityService=e.interactivityService},i.prototype.shouldShowY1OnRight=function(){return!0===this.axesData.y.switchAxisPosition},Object.defineProperty(i.prototype,"isYAxisCategorical",{get:function(){return Pn(this.axesData.chartType)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"categoryAxis",{get:function(){return this.getAxis(this.isYAxisCategorical?1:0)},enumerable:!1,configurable:!0}),i.prototype.hasCategoryAxis=function(){return null!=this.categoryAxis},i.prototype.isCategoryAxisDateTime=function(){var e,t,a;return null!==(a=null===(t=null===(e=this.categoryAxis)||void 0===e?void 0:e.valueType)||void 0===t?void 0:t.dateTime)&&void 0!==a&&a},i.getLeafHeight=function(e,t,a){var r=t===ne.Or.bottom?e.xMax:t===ne.Or.right?e.yRight:e.yLeft,n=e.stackHeight;return k.fF.assertValue(r,"getLeafHeight: availableSpace"),k.fF.assertValue(n,"getLeafHeight: stackHeight"),k.fF.assertValue(a,"getLeafHeight: numStacks"),r-n*(a-1)+fr+1},i.prototype.getYAxisPosition=function(e){return k.fF.assert(function(){return 0!==e},"cannot ask y-axis specific position for x-axis"),1===e?this.getY1AxisPosition():this.getY2AxisPosition()},i.prototype.getY1AxisPosition=function(){return this.axesData.y.switchAxisPosition?"right":"left"},i.prototype.getY2AxisPosition=function(){return this.axesData.y.switchAxisPosition?"left":"right"},i.prototype.update=function(e,t,a,r){this.categories=e,this.axesData=t,this.updateScrollbarWidthIfNeeded(r),this.isHierarchicalCategoryAxis=3===a},i.prototype.updateResize=function(e,t){this.axesData=e,this.updateScrollbarWidthIfNeeded(t)},i.prototype.addWarnings=function(e){var t=this.layout&&this.layout.axes;if(t&&t.x&&t.x.hasDisallowedZeroInDomain){var a={selector:null,warnings:[new Ue.MX]};e.addForVisualObject(this.isYAxisCategorical?"valueAxis":"categoryAxis",a)}if(t&&(t.y1&&t.y1.hasDisallowedZeroInDomain||t.y2&&t.y2.hasDisallowedZeroInDomain)&&(a={selector:null,warnings:[new Ue.MX]},e.addForVisualObject(this.isYAxisCategorical?"categoryAxis":"valueAxis",a)),this.alignZerosWithCustomDomainWarning){var n={selector:null,warnings:[new Ue.rO]};e.addForVisualObject("valueAxis",n)}},i.prototype.getScrollbarWidth=function(){return this.scrollbarWidth},i.prototype.updateScrollbarWidthIfNeeded=function(e){null!=e&&(this.scrollbarWidth=e)},i.prototype.calculateAxes=function(e,t,a,r,n,s){var o,l,u,c=e.options,d=e.isScalar,h=e.isScrollVisible,v=c.layers,y=c.playAxisControlLayout;k.fF.assertValue(v,"layers");var f=i.shouldRenderAnyAxis(s)||d?.4:0,p=this.axesData.categoryAxis.innerPadding,S={x:null,y1:null},m=(o=this.axesData).categoryAxis,b=o.valueAxis,C=_.some(o.y2.includeDomains,function(Nt){return Ya(Nt)}),A=this.axesData.isValueAxisSet&&!1===this.axesData.y2.show&&!C,T=function(Qe){return Qe&&Yt([Qe.min,Qe.max],0)},P=function(Qe,ea){return{includeDomain:ga.apply(wt,(0,g.__spreadArray)((0,g.__spreadArray)([],Qe.includeDomains,!1),[T(ea)],!1)),axis:Qe}},D=P(m,c.ensureXDomain),L=P(b,c.ensureYDomain),O={viewport:t,margin:a,categoryAxisOptions:D,forceMerge:A,trimOrdinalDataOnOverflow:this.trimOrdinalDataOnOverflow,outerPaddingRatio:f,innerPaddingRatio:p,playAxisControlLayout:y,valueAxisOptions:L,axisZoom:this.axisZoom},B=this.axesData.isValueAxisSet&&this.axesData.y2.show,E=this.axesData.isValueAxisSet&&this.axesData.y.alignZeros,j=c.skipMergeValueAxes||!A&&(!0===B||C||void 0===B&&(E||L.includeDomain)),H=!1;if(Do(v)&&!j){var Z=function(i,e){k.fF.assert(function(){return i.length<3},"merging of more than 2 layers is not supported");var t=void 0,a=function(){return{domain:void 0,merged:!1,tickCount:t}};if(i.length<2)return a();var r=(0,be.ED)(e);r.roleName="Y2";var n=i[0].calculateAxesProperties(e)[1],s=i[1].calculateAxesProperties(r)[1],o=n.scale.domain(),l=s.scale.domain();if(n.dataDomain&&s.dataDomain){var u=0===n.dataDomain[0]&&0===n.dataDomain[1],c=0===s.dataDomain[0]&&0===s.dataDomain[1];u&&!c?o=[0,0]:!u&&c&&(l=[0,0])}n.values&&n.values.length>0&&s.values&&s.values.length>0&&(t=Math.max(n.values.length,s.values.length));var d=Math.min(o[0],l[0]),h=Math.max(o[1],l[1]);if(e.forceMerge)return{domain:[d,h],merged:!0,tickCount:t};if(o[0]>l[1]||o[1]<l[0])return a();var v=h-d;if(0===v)return a();var y=Math.max(o[0],l[0]),f=Math.min(o[1],l[1]);return Math.abs((f-y)/v)<.1?a():{domain:[d,h],merged:!0,tickCount:t}}(v,O);(H=Z.merged)?L.includeDomain=ga(L.includeDomain,Yt(Z.domain,0,[!0,!0])):O.forcedTickCount=Z.tickCount}var ve=Do(v)?!H&&!1!==B||B:this.axesData.y2.hasY2Role;ve=ve||C,E=E&&ve;var fe=(0,be.ED)(O);if(ve){var re=this.axesData.y2,ge=fe.valueAxisOptions=(0,g.__assign)((0,g.__assign)({},(0,be.ED)(L)),{axis:(0,g.__assign)((0,g.__assign)({},re),{invertAxis:b.invertAxis}),includeDomain:ga.apply(wt,(0,g.__spreadArray)((0,g.__spreadArray)([],re.includeDomains,!1),[T(c.ensureY2Domain)],!1))});if(E){var Ae=v[0].getAxesDomains(!0,{valueAxis:!0}),Pe=ga.apply(wt,(0,g.__spreadArray)([Yt(Ae.valueAxis,0)],b.includeDomains,!1)),Se=ga(Yt(v[1].getAxesDomains(!0,{valueAxis:!0}).valueAxis,0),ge.includeDomain),Fe=Pe&&Se,Ie=Fe&&(Ya(Pe)||Ya(Se));if(S.alignZerosWithCustomDomainWarning=Ie,Fe&&!Ie){var xe=(l=function(i,e,t){k.fF.assert(function(){return i&&2===i.length},"domain1 length"),k.fF.assert(function(){return e&&2===e.length},"domain2 length"),k.fF.assert(function(){return!0},"bufferMultiplier should be between 0 and 0.15");var a=i.slice(),r=e.slice(),n=i[1]-i[0],s=e[1]-e[0];if(a[0]=a[0]-n*t,a[1]=a[1]+n*t,r[0]=r[0]-s*t,r[1]=r[1]+s*t,i[0]>=0&&e[0]>=0)a[0]=0,r[0]=0;else if(i[1]<=0&&e[1]<=0)a[1]=0,r[1]=0;else{var o=El(a),l=El(r);if(o.pos<o.neg&&l.pos<l.neg)o.pos<l.pos?a[1]=-l.pos*a[0]/(1-l.pos):r[1]=-o.pos*r[0]/(1-o.pos);else if(o.pos>o.neg&&l.pos>l.neg)o.neg<l.neg?a[0]=-l.neg*a[1]/(1-l.neg):r[0]=-o.neg*r[1]/(1-o.neg);else{var u=Math.max(Math.abs(a[0]),Math.abs(a[1])),c=Math.max(Math.abs(r[0]),Math.abs(r[1]));a=[-u,u],r=[-c,c]}}return[a,r]}(Pe.domain,Se.domain,.05),l[0]),Ne=l[1];L.includeDomain=Yt(xe,0,[!0,!0]),ge.includeDomain=Yt(Ne,0,[!0,!0])}else ge.includeDomain=ga(ge.includeDomain,Se)}else H||(ge.includeDomain=this.axesData.isValueAxisSet&&ge.includeDomain)}for(var $e=[O,fe],je=Do(v)||this.axesData.y2.hasY2Role?2:1,et=0;et<je;et++){var Ve=$e[et],rt=null!==(u=v[et])&&void 0!==u?u:v[0];!H&&1===et&&(Ve.roleName="Y2"),k.fF.assertValue(Ve,"currentVisualOptions must be set");var _e=rt.calculateAxesProperties(Ve);0===et?(S.x=_e[0],S.y1=_e[1]):_e&&!S.y2&&(S.x.isInvalidDomain||_.isEmpty(S.x.dataDomain)?(S.x=_e[0],S.y1=_e[1]):(rt.overrideXAxis(S.x),!H&&!_e[1].isInvalidDomain&&!_.isEmpty(_e[1].values)&&(S.y2=_e[1])));var vt=(0,We.qk)(c.axesFontProperties.x.tickLabels),ze=S.x;if(r&&r.x)ze.willLabelsFit=r.x.willLabelsFit,ze.willLabelsWordBreak=r.x.willLabelsWordBreak;else{var kt=t.width-(a.left+a.right);ze.willLabelsFit=Sl(ze,kt,Le.b.measureSvgTextWidth,vt),ze.willLabelsWordBreak=!ze.willLabelsFit&&!h&&bl(S.x,a,kt,Le.b.measureSvgTextWidth,Le.b.estimateSvgTextHeight,Le.b.getTailoredTextOrDefault,vt)}var Ze=S.x.isCategoryAxis;if(this.isHierarchicalCategoryAxis&&(Ze?this.axesData.x.show:this.axesData.y.show)){var ct=Ze?S.x:S.y1;ct.isHierarchical=!0,ct.rootNode=(0,Nl.J_)(this.categories),ct.numHierarchyLevels=this.categories.length,n&&(ct.hierStack=i.createStackedAxis(this.categories,ct,n,Ze?ne.Or.bottom:this.axesData.y.switchAxisPosition?ne.Or.right:ne.Or.left))}}return this.finalizeAxisLabels(S,c.showAxisTitles),S},i.createStackedAxis=function(e,t,a,r){if(k.fF.assertValue(t,"axis"),!_.isEmpty(e)){for(var n=e.length,s=a.stackHeight,o=i.getLeafHeight(a,r,n),l=[],u=Ct(t.scale),c=[],d=function(y){var f=y===n-1,p=n-y-1,S=e[y];f||(k.fF.assertValue(S.source.identityExprs,"levelCategory.source.identityExprs"),c.push.apply(c,S.source.identityExprs||[]));for(var m=[],b=[],x=[],C=[],A=[],T=0,P=void 0,D=S.values.length,L=function(H){var Z=f?S.identity[H]:i.getSpecificIdentityFromCompositeIdentity(S,H,c),fe=(0,St.xq)(S.values[H],S.source,N.p.general.formatString);if(!f&&P&&(0,$r.fS)(P,Z))m[H]=ne.Pt,T++;else{if(T>0&&!f){var re=H-T;C[re]=i.getMaxCategoryWidth(T,u),A[re]=i.getHierarchyLineStyleInfo({levelIndex:p,stackHeight:s,leafHeight:o,categorySpanCount:T,categoryWidth:u,orientation:r})}T=1,m[H]=fe,b[H]=function(){return Tt.dw.builder().withCategoryIdentity(S,H,Z).createSelectionId()},x[H]={categoryIndex:H,seriesIndex:y}}P=Z},O=0;O<D;O++)L(O);if(T>0&&!f){var B=D-T;C[B]=i.getMaxCategoryWidth(T,u),A[B]=i.getHierarchyLineStyleInfo({levelIndex:p,stackHeight:s,leafHeight:o,categorySpanCount:T,categoryWidth:u,orientation:r})}var E=(0,be.ED)(t);E.isStacked=!0,E.adjustedValues=m,t.categoryIdentities&&(E.categoryIdentities=b,E.categoryHierarchyPointers=x,k.fF.assert(function(){return b.length===x.length},"keep identities and pointers in sync")),E.d3Axis=Nn({d3axis:E.d3Axis,scale:E.scale,tickFormat:function(H){return m[H]!==ne.Pt?m[H]:null}}),E.categoryThickness=u,E.levelIndex=p,E.lineStyleInfo=A,E.values=m,E.categoryLabelMaxWidths=C,f||(E.willLabelsFit=!0,E.willLabelsWordBreak=!1),l.unshift(E)},h=0;h<n;h++)d(h);return l}},i.shouldRenderAnyAxis=function(e){return e&&(e.x||e.y)},i.getSpecificIdentityFromCompositeIdentity=function(e,t,a){var r=e.identity;k.fF.assertNonEmpty(r,"columnIdentities");var n=r[t];k.fF.assertValue(n,"identity");var s=(0,Ol.J2)(n.expr,a);return(0,$r.TZ)(s)},i.getCategorySpanSize=function(e,t){return e*t},i.getMaxCategoryWidth=function(e,t){return k.fF.assertValue(e,"categorySpanCount"),k.fF.assertAnyValue(t,"categoryWidth"),i.getCategorySpanSize(e,t)-2*ot},i.getHierarchyLineStyleInfo=function(e){return k.fF.assertValue(e,"options"),k.fF.assertValue(e.levelIndex,"levelIndex"),k.fF.assertValue(e.stackHeight,"stackHeight"),k.fF.assertValue(e.leafHeight,"leafHeight"),k.fF.assertValue(e.categorySpanCount,"categorySpanCount"),k.fF.assertValue(e.categoryWidth,"categoryWidth"),e.orientation===ne.Or.bottom?i.createXHierarchyLineStyleInfo(e):i.createYHierarchyLineStyleInfo(e)},i.createXHierarchyLineStyleInfo=function(e){var t=e.levelIndex,a=e.stackHeight,r=e.leafHeight;if(0!==t){var o=i.getCategorySpanSize(e.categorySpanCount,e.categoryWidth);return(0,g.__spreadArray)([{x1:-o/2,y1:a,x2:-o/2,y2:1===t?-r:0},{x1:o/2,y1:a,x2:o/2,y2:1===t?-r:0}],t>1?[{x1:-o/2,y1:0,x2:o/2,y2:0}]:[],!0)}},i.createYHierarchyLineStyleInfo=function(e){var t=e.levelIndex,a=e.stackHeight,r=e.leafHeight;if(0!==t){var o=i.getCategorySpanSize(e.categorySpanCount,e.categoryWidth);return(0,g.__spreadArray)([{x1:-a,x2:1===t?r:0,y1:-o/2,y2:-o/2},{x1:-a,x2:1===t?r:0,y1:o/2,y2:o/2}],t>1?[{x1:0,x2:0,y1:-o/2,y2:o/2}]:[],!0).map(function(l){return e.orientation===ne.Or.right&&(l.x1=-l.x1-a,l.x2=-l.x2-a),l})}},i.prototype.negotiateAxes=function(e){var t,a,r,x,n=e.layers,s=e.padding,o=e.showAxisTitles,l=(0,be.ED)(i.MinimumMargin),u={left:0,top:0,bottom:0,right:0},c={left:0,top:0,bottom:0,right:0},d=this.axesData,h=(null===(t=d?.categoryAxis)||void 0===t?void 0:t.maxMarginFactor)||i.DefaultMaxMarginFactor,v=(0,be.ED)(e.parentViewport),y=v.width*h,p={left:y,right:y,top:0,bottom:Math.max(i.MinimumMargin.bottom,Math.ceil(v.height*h))},S=null===(r=null===(a=n?.[0])||void 0===a?void 0:a.getVisualCategoryAxisIsScalar)||void 0===r?void 0:r.call(a),m=this.calculateAxesRenderOptions({options:e,viewport:v,axesMargins:l,scrollHandleMargins:u,axesOverflow:c,isScalar:S,marginLimits:p,isScrollVisible:!1}),b=this.getAxesMarginFactors(m.axes);l=(m=this.calculateAxesRenderOptions({options:e,viewport:v,axesMargins:l,scrollHandleMargins:u,axesOverflow:c,isScalar:S,marginLimits:p,isScrollVisible:!1,axesRenderOptions:m})).axesMargins,e.rotateXTickLabels90=e.rotateXTickLabels90||!this.willAllCategoriesFitInPlotArea(m.plotArea,m.preferredPlotArea),this.shouldRecalculateRenderOptions(b,m.axes,e.rotateXTickLabels90)&&(l=(m=this.calculateAxesRenderOptions({options:e,viewport:v,axesMargins:l,axesOverflow:c,scrollHandleMargins:u,isScalar:S,marginLimits:p,isScrollVisible:e.rotateXTickLabels90,skipWordBreakUpdate:!0,axesRenderOptions:m})).axesMargins,!this.willAllCategoriesFitInPlotArea(m.plotArea,m.preferredPlotArea)&&(x=this.updateScrollMargins(m.axes,v,u),l=(m=this.calculateAxesRenderOptions({options:e,viewport:v,axesMargins:l,scrollHandleMargins:u,axesOverflow:c,isScalar:S,marginLimits:p,isScrollVisible:!0,skipWordBreakUpdate:!0,axesRenderOptions:m,skipTickMarginsUpdate:!0,isXScrollBarVisible:x.isXVisible,isYScrollBarVisible:x.isYVisible})).axesMargins));var A=m.axes;return this.layout={axes:A,axisLabels:{x:o.x&&A.x?A.x.axisLabel:null,y:o.y&&A.y1?A.y1.axisLabel:null,y2:o.y2&&A.y2?A.y2.axisLabel:null},margin:l,marginLimits:p,viewport:v,plotArea:m.plotArea,preferredPlotArea:m.preferredPlotArea,tickLabelMargins:m.tickLabelMargins,tickPadding:s,titleMargins:m.titleMargins,rotateXTickLabels90:e.rotateXTickLabels90,shouldRenderAxis:m.shouldRenderAxis,isXScrollBarVisible:x&&x.isXVisible,isYScrollBarVisible:x&&x.isYVisible,scrollHandleMargins:u},this.alignZerosWithCustomDomainWarning=A.alignZerosWithCustomDomainWarning,this.layout},i.prototype.updateScrollMargins=function(e,t,a){var r,n,s=!1,o=!1;return e.x.isCategoryAxis&&(s=!0,t.height-=this.scrollbarWidth,a.bottom=this.scrollbarWidth),e.y1.isCategoryAxis&&(o=!0,t.width-=this.scrollbarWidth,(null===(n=null===(r=this.axesData)||void 0===r?void 0:r.y)||void 0===n?void 0:n.switchAxisPosition)?a.right=this.scrollbarWidth:a.left=this.scrollbarWidth),{isXVisible:s,isYVisible:o}},i.prototype.shouldRecalculateRenderOptions=function(e,t,a){var r=this.getAxesMarginFactors(t);return!!(t.y1&&r.tickCountY1!==e.tickCountY1||t.y2&&r.tickCountY2!==e.tickCountY2||t.x&&r.willFitX!==e.willFitX||t.x&&r.willBreakX!==e.willBreakX||t.x&&r.xLabelMaxWidth!==e.xLabelMaxWidth||a||this.isHierarchicalCategoryAxis||t.x&&r.categoryThickness!==e.categoryThickness)},i.prototype.getAxesMarginFactors=function(e){return{tickCountY1:e.y1&&e.y1.values.length,tickCountY2:e.y2&&e.y2.values.length,willFitX:e.x&&e.x.willLabelsFit,willBreakX:e.x&&e.x.willLabelsWordBreak,xLabelMaxWidth:e.x&&e.x.xLabelMaxWidth,categoryThickness:e.x&&e.x.categoryThickness}},i.prototype.calculateAxesRenderOptions=function(e){var t,a,r,n,s,m,o=e.options,l=e.viewport,u=e.scrollHandleMargins,c=e.isScalar,d=e.marginLimits,h=e.axesRenderOptions,v=e.skipTickMarginsUpdate,y=e.axesMargins,f=e.axesOverflow,p=null!==(a=h?.shouldRenderAxis)&&void 0!==a?a:o.shouldRenderAxis,S=h?.axes,b={top:0,bottom:0,left:0,right:0};if(h){var x=this.shouldShowY1OnRight();m=v?h.tickLabelMargins:ue({plotArea:h.plotArea,yMarginLimit:d.left,textWidthMeasurer:Le.b.measureSvgTextWidth,textHeightMeasurer:Le.b.estimateSvgTextHeight,axes:h.axes,bottomMarginLimit:d.bottom,axesFontProperties:o.axesFontProperties,rotate90:o.rotateXTickLabels90,showY1OnRight:x,shouldRenderAxis:h.shouldRenderAxis}),y=(t=this.updateAxisMargins(e,m,x)).axesMargins,b=t.titleMargins,f=m.axesOverflow}var C=o.calculatePlotArea({viewport:l,axesMargins:y,axesOverflow:f,titleMargins:b,shouldRenderAxis:p,axes:S,scrollHandleMargins:u,seriesLabelSettings:Ds(o.layers,this.axesData.chartType),showSeriesLabels:this.axesData.showsSeriesLabels()});return S=this.calculateAxes(e,this.calculateLayerViewport(C,y),y,e.skipWordBreakUpdate?S:null,m,p),{plotArea:C,preferredPlotArea:this.getPreferredPlotArea(S,o.layers,c),axes:S,axesMargins:y,titleMargins:b,shouldRenderAxis:{x:p.x&&!_.isEmpty(null===(r=S.x)||void 0===r?void 0:r.values),y:p.y&&!_.isEmpty(null===(n=S.y1)||void 0===n?void 0:n.values),y2:p.y2&&!_.isEmpty(null===(s=S.y2)||void 0===s?void 0:s.values)},tickLabelMargins:m}},i.prototype.getPreferredPlotArea=function(e,t,a){if(!a&&this.isScrollable&&!_.isEmpty(t)&&t[0].getPreferredPlotArea){var r=e.x.isCategoryAxis?e.x:e.y1;return t[0].getPreferredPlotArea({isScalar:a,categoryCount:r.dataDomain.length,categoryThickness:r.categoryThickness,outerPaddingRatio:r.outerPaddingRatio})}},i.prototype.calculateLayerViewport=function(e,t){return{width:e.width+t.left+t.right,height:e.height+t.top+t.bottom,scale:e.scale}},i.prototype.willAllCategoriesFitInPlotArea=function(e,t){return!(!this.isYAxisCategorical&&t&&(0,Lt.aP)(t.width,e.width)||this.isYAxisCategorical&&t&&(0,Lt.aP)(t.height,e.height))},i.prototype.updateAxisMargins=function(e,t,a){var r,n,s,o=e.isScalar,l=(r=e.axesRenderOptions).axes,u=r.shouldRenderAxis,c=(n=e.options).padding,d=n.showAxisTitles,h=n.axesFontProperties,v=n.forceMarginMin,y=n.interactivityRightMargin,f={top:0,bottom:0,left:0,right:0},p=a?t.yRight:t.yLeft,S=a?t.yLeft:t.yRight,m=t.xMax;if(u.y&&(p+=a?c.right:c.left),u.y2&&(S+=a?c.left:c.right),u.x&&(m+=c.bottom),null!=l.x.axisLabel&&d.x){var b=Le.b.estimateSvgTextHeight((0,We.qk)(h.x.title));f.bottom=b+i.XAxisLabelPadding+i.XAxisPaddingDeltaForTitle,m+=f.bottom}if(null!=l.y1.axisLabel&&d.y){var x=(b=Le.b.estimateSvgTextHeight((0,We.qk)(h.y.title)))+i.YAxisLabelPadding;a?f.right=x:f.left=x,p+=x}if(null!=(null===(s=l.y2)||void 0===s?void 0:s.axisLabel)&&d.y2){var C=(b=Le.b.estimateSvgTextHeight((0,We.qk)(h.y2.title)))+i.YAxisLabelPadding;a?f.left=C:f.right=C,S+=C}var A=(a?p:S)+(o?0:y);A=e.isYScrollBarVisible?Math.max(A,i.MinimumAxisMarginFromScrollbar):A;var T=m;T=e.isXScrollBarVisible?Math.max(T,i.MinimumAxisMarginFromScrollbar):T,t.axesOverflow.top=Math.max(t.yTop,i.MinimumMargin.top);var P={top:t.axesOverflow.top,left:a?S:p,right:A,bottom:T};return v&&(P={top:Math.max(P.top,v.top),bottom:Math.max(P.bottom,v.bottom),left:Math.max(P.left,v.left),right:Math.max(P.right,v.right)}),{axesMargins:P,titleMargins:f}},i.prototype.getAxis=function(e){var t,a,r,n,s,o;switch(e){case 0:return null===(a=null===(t=this.layout)||void 0===t?void 0:t.axes)||void 0===a?void 0:a.x;case 1:return null===(n=null===(r=this.layout)||void 0===r?void 0:r.axes)||void 0===n?void 0:n.y1;case 2:return null===(o=null===(s=this.layout)||void 0===s?void 0:s.axes)||void 0===o?void 0:o.y2;default:k.fF.assertNever(e)}},i.prototype.isLogScaleAllowed=function(e){var t,a;return null!==(a=null===(t=this.getAxis(e))||void 0===t?void 0:t.isLogScaleAllowed)&&void 0!==a&&a},i.prototype.axesHaveTicks=function(e){if(!this.layout)return!1;var t=this.layout.margin,r=e.height-(t.top+t.bottom);return!(0===Yr(e.width-(t.left+t.right))&&0===Xr(r))},i.prototype.finalizeAxisLabels=function(e,t){var a,r,n,s;if(this.axesData.x.showAxisTitle||this.axesData.y.showAxisTitle||this.axesData.y2.showAxisTitle){var o={x:e.x?null!==(a=this.axesData.x.titleText)&&void 0!==a?a:e.x.axisLabel:void 0,y:e.y1?null!==(r=this.axesData.y.titleText)&&void 0!==r?r:e.y1.axisLabel:void 0,y2:e.y2?null!==(n=this.axesData.y2.titleText)&&void 0!==n?n:e.y2.axisLabel:void 0},l=i.getUnitType(e.x.formatter);e.x.isCategoryAxis?this.categoryAxisHasUnitType=null!=l:this.valueAxisHasUnitType=null!=l,o.x&&l&&(o.x=(0,ra.O1)(this.axesData.x.axisStyle,o.x,l));var u=i.getUnitType(e.y1.formatter);if(e.y1.isCategoryAxis?this.categoryAxisHasUnitType=null!=u:this.valueAxisHasUnitType=null!=u,o.y&&u&&(o.y=(0,ra.O1)(this.axesData.y.axisStyle,o.y,u)),e.y2){var c=i.getUnitType(e.y2.formatter);this.secondaryValueAxisHasUnitType=null!=c,o.y2&&c&&(o.y2=(0,ra.O1)(this.axesData.y2.axisStyle,o.y2,c))}null===(s=this.axisZoom)||void 0===s||s.updateAxisTitles(o),e.x&&(e.x.axisLabel=t.x?o.x:null),e.y1&&(e.y1.axisLabel=t.y?o.y:null),e.y2&&(e.y2.axisLabel=t.y2?o.y2:null)}},i.getUnitType=function(e){var t;if((null===(t=e?.displayUnit)||void 0===t?void 0:t.value)>1)return e.displayUnit.title},i.YAxisLabelPadding=5,i.XAxisLabelPadding=3,i.XAxisPaddingDeltaForTitle=-6,i.DefaultMaxMarginFactor=.25,i.MinimumMargin={left:1,right:1,top:8,bottom:25},i.MinimumAxisMarginFromScrollbar=5,i}();function Do(i){return k.fF.assertValue(i,"layers"),i.length>1}function El(i){return k.fF.assert(function(){return 2===i.length},"domain length must be 2"),k.fF.assert(function(){return i[1]-i[0]!=0},"div by zero warning"),{pos:(i[1]-0)/(i[1]-i[0]),neg:(0-i[0])/(i[1]-i[0])}}var ut=R(46769),Wn=R(34021),Xa=R(11305),Xt=R(61193),yr=R(51129),Ia=R(45034),Bl=R(59694),at=R(32379),Gn=R(24653),da=R(79811),Hl="Waterfall_TotalLabel",Wl="Waterfall_OtherLabel",Qc=function(){function i(){}return i.convert=function(e){var t=e.dataView;if(t){if(t.categorical)return function(i){var e,t,a,r,C,T,n=i.dataView,s=i.hostServices,o=i.dataLabelSettings,l=i.sentimentColors,u=i.interactivityService,c=i.tooltipsEnabled,d=N.p.general.formatString,h=(0,yr.G)(n,{formatStringProp:d}),v=h.data,y=(0,le.NA)(h.objects.getStaticObjects(),N.p.valueAxis.totalsEnabled,true),f=n.categorical.categories||[],p=s.getLocalizedString(Hl),S={current:0,min:0,max:0,formatString:void 0},m=[],b=[],x=[],A=[];if(v.hasValues("Tooltips")&&(T=h.columns.getAllValueMetadataColumnsForRole("Tooltips",void 0)),v.hasValues("Y")){var P=(A=[h.columns.getValueMetadataColumn("Y")])[0].format;if(_.isEmpty(f)){var D=v.getValue("Y",0),L=v.getFormatString("Y",0);S={current:D,max:D,min:0,formatString:L}}else{var O=f[0];C=O.source,(b=O.values.slice()).push(p);for(var B=null!==(e=n.categorical.originalCategories)&&void 0!==e?e:[O],E=o.fontProperties.color,j=function(re,ge){var Ae=b[re],Pe=v.getValue("Y",re)||0,se=v.getFormatString("Y",re);void 0!==se&&void 0===P&&(P=se);var Se=Tt.dw.builder().withCategory(B,re,null===(t=O?.source)||void 0===t?void 0:t.queryName,!0).withMeasure(A[0].queryName,h.columns.getValueColumn("Y"),re).createSelectionId(),Fe=void 0;if(c){Fe=_o(C?[C]:null,A[0],[Ae],Pe,se,d);var Ie=v.getAllValuesForRole("Tooltips",re),xe=v.getAllFormatStringsForRole("Tooltips",re);Ie&&T&&_s(Ie,xe,Fe,T,d,s)}var Ne=(0,ut.t$)({defaultColor:E,categoricalDataReader:h,categoryIndex:re}),$e=(0,ut.B8)(Ne)?Ne.color:E;o.fontProperties=(0,ut.Vv)($e,o.fontProperties),m.push(en(Pe,S.current,l,Ae,re,Se,Fe,Ne.color,se||P,0)),x[re]=function(){return ps(re,O)},S=Ls(S,Pe)},H=0,Z=v.getCategoryCount();H<Z;H++)j(H)}var ve=void 0;c&&(ve=_o(C?[C]:null,A[0],[p],S.current,P,d)),y&&m.push(en(S.current,0,l,p,v.getCategoryCount(),Tt.l0.createNull(),ve,o.fontProperties.color,P,1,{text:!0}))}return u&&u.applySelectionStateToData(m),{series:[{data:m,type:null===(a=A?.[0])||void 0===a?void 0:a.type,measureDisplayName:null===(r=A?.[0])||void 0===r?void 0:r.displayName}],categories:b,categoryIdentities:x,categoryMetadata:C,preferredCategoryWidth:Li(ja(n.metadata,void 0)),valuesMetadata:A,legendData:Gl(l,s,h.objects.getStaticObjects(),i.style,!1,y),hasHighlights:!1,positionMin:S.min,positionMax:S.max,dataLabelsSettings:o,sentimentColors:l,strokeSettings:(0,Wn.kG)(i.style),totalsEnabled:y}}(e);if(t.matrix)return function(i){var e,t,a,r,n=i.dataView,s=i.hostServices,o=i.dataLabelSettings,l=i.sentimentColors,u=i.interactivityService,c=i.tooltipsEnabled,d=i.numberOfBreakdowns,h=n.matrix,v=!_.isEmpty(h.columns.levels)&&h.columns.levels[0].sources[0];k.fF.assert(function(){return!!v},"breakdown role should be defined when using matrix converter");var y=!_.isEmpty(h.rows.levels)&&h.rows.levels[0].sources,f=_.findIndex(h.valueSources,function(pt){return(0,Dt.nu)(pt,"Y")}),p=h.valueSources[f],S=_.filter(h.valueSources,function(pt){return(0,Dt.nu)(pt,"Tooltips")}),m=[],b=[],x={current:0,min:0,max:0},C=0,A=null===(t=n?.metadata)||void 0===t?void 0:t.objects;if(v&&y&&p){k.fF.assert(function(){return(0,Dt.nu)(v,"Breakdown")},"matrix column should have breakdown role"),k.fF.assert(function(){return _.every(y,function(pt){return(0,Dt.nu)(pt,"Category")})},"matrix row should have category role");var T=new ed(v,y,p),P=p.format,D=s.getLocalizedString(Wl),L=N.p.general.formatString,O=h.rows.root.children,B=h.columns.root.children;if(!_.isEmpty(O)&&!_.isEmpty(B)){var E=O.length,j=B.length,H=0,Z=void 0,ve=void 0,fe=_.size(S)+1;E>0&&(C=_.size(O[0].values)/fe-1),d=Math.min(d,C);for(var re=0;re<E;re++){for(var ge=void 0,Ae=O[re],Pe=re>0?O[re-1]:void 0,se=_.map(Ae.levelValues,function(pt){return pt.value}),Se=_.map(se,function(pt,At){return(0,St.xq)(pt,y[At],L)}).join(" "),Fe=T.splitIdentity(Ae.identity.expr),Ie=[],xe=_.size(Ae.values),Ne=0;Ne<xe;Ne+=fe){for(var $e=void 0,je=void 0,et=void 0,Ve=void 0,rt=[],_e=[],vt=0;vt<fe;vt++)if(vt===f){var ze=Ae.values[Ne+vt];$e=(0,ne.eT)(ze.value),et=(0,le.NA)(ze.objects,L),Ve=(0,Je.y)(null===(a=ze.objects)||void 0===a?void 0:a.labels,"color"),ge||(ge=et),je=Pe&&(0,ne.eT)(Pe.values[Ne+vt].value)}else rt.push(Ae.values[Ne+vt].value),_e.push(Pe&&Pe.values[Ne+vt].value);Ie.push({key:Ne,currentValue:$e,previousValue:je,difference:($e||0)-(je||0),column:B[Ne/fe],currentTooltipValues:rt,previousTooltipValues:_e,formatString:et,labelColor:Ve??void 0})}Ie=_.sortBy(Ie,function(pt){return-1*Math.abs(pt.difference)});var Ze=_.chain(Ie).filter(function(pt){return!pt.column.isSubtotal}).take(d).sortBy(function(pt){return-1*pt.difference}).value(),ct=_.find(Ie,function(pt){return pt.column.isSubtotal}),Nt=ct.currentValue,Qe=ct.previousValue;if(Pe){var ea=_.sumBy(Ze,function(pt){return pt.currentValue}),Va=_.sumBy(Ze,function(pt){return pt.previousValue}),Gt=_.chain(Ze).map(function(pt){return T.splitIdentity(pt.column.identity.expr)}).flatten().value(),va=j>d+1,la=0,Oe=void 0,sa=void 0;if(va){var Bt=Nt-ea,Ke=Qe-Va;if(la=Bt-Ke,Oe=T.createBreakdownOtherIdentity(Gt,Fe,ve),c){sa=T.createBreakdownTooltip(Se,Z,D,Bt,Ke,la,L,s);for(var Rt=[],ta=[],Ka=function(At){var ua=ct.currentTooltipValues[At],mt=ct.previousTooltipValues[At];if(_.isNumber(ua)&&_.isNumber(mt)){var ba=ua-_.sumBy(Ze,function(Aa){return Aa.currentTooltipValues[At]}),Kt=mt-_.sumBy(Ze,function(Aa){return Aa.previousTooltipValues[At]});Rt.push(ba-Kt),ta.push(Kt)}},Zt=0;Zt<ct.currentTooltipValues.length;Zt++)Ka(Zt);_s(Rt,void 0,sa,S,L,s,ta,Se,Z)}}for(var I=!1,ce=function(At){va&&la>At.difference&&!I&&(I=!0,m.push(en(la,x.current,l,D,H++,Oe,sa,o.fontProperties.color,P||ge,3,{text:!0})),b.push(D),x=Ls(x,la));var ua=(0,St.xq)(At.column.value,v,L),mt=T.splitIdentity(At.column.identity.expr);k.fF.assertValue(mt,"breakdown identity must be a compare expr");var ba=T.createBreakdownIdentity(Fe,ve,mt),Kt=void 0;c&&(Kt=T.createBreakdownTooltip(Se,Z,ua,At.currentValue,At.previousValue,At.difference,L,s),_s(_.map(At.currentTooltipValues,function(li,Mt){return _.isNumber(li)?li-At.previousTooltipValues[Mt]:li}),void 0,Kt,S,L,s,At.previousTooltipValues,Se,Z)),m.push(en(At.difference,x.current,l,ua,H++,ba,Kt,null!==(r=At.labelColor)&&void 0!==r?r:o.fontProperties.color,At.formatString||P,0,{text:!0})),b.push(ua),x=Ls(x,At.difference)},dt=0,jt=Ze;dt<jt.length;dt++)ce(jt[dt]);va&&!I&&(I=!0,m.push(en(la,x.current,l,D,H++,Oe,sa,o.fontProperties.color,P||ge,3,{text:!0})),b.push(D),x=Ls(x,la))}var Ee={dataMap:(e={},e[y[0].queryName]=[Ae.identity],e),metadata:[p.queryName]},qa=void 0;c&&(qa=_o(y,p,se,Nt,void 0,L),_s(ct.currentTooltipValues,void 0,qa,S,L,s)),m.push(en(Nt,0,l,Se,H++,new Tt.l0((0,at.tV)(Ee),!1,Ee),qa,o.fontProperties.color,P||ge,2,{text:!0})),b.push(Se),0===re&&(x={current:Nt,max:Nt,min:Nt}),Z=Se,ve=Fe}}}return u&&u.applySelectionStateToData(m),{series:[{data:m,type:p?.type,measureDisplayName:p?.displayName}],categories:b,categoryIdentities:_.map(m,function(pt){return function(){return pt.identity}}),categoryMetadata:y[0],preferredCategoryWidth:Li(ja(n.metadata,void 0)),valuesMetadata:h.valueSources,legendData:Gl(l,s,A,i.style,!0,!0),hasHighlights:!1,positionMin:x.min,positionMax:x.max,dataLabelsSettings:o,sentimentColors:l,isBreakdown:!0,numberOfBreakdowns:d,totalBreakdownCategories:C,strokeSettings:(0,Wn.kG)(i.style),totalsEnabled:!0}}(e)}},i}();function Gl(i,e,t,a,r,n){var s=function(u,c,d,h){return{label:e.getLocalizedString(c),marker:{show:!0,color:u,shape:Xt.ZO.circle},identity:Tt.dw.builder().withMeasure(d).createSelectionId(),selected:!1,index:h}},o=(0,g.__spreadArray)((0,g.__spreadArray)([s(i.increaseFill.solid.color,"Increase","increase",0),s(i.decreaseFill.solid.color,"Decrease","decrease",1)],r?[s(i.otherFill.solid.color,Wl,"other",3)]:[],!0),n?[s(i.totalFill.solid.color,Hl,"total",2)]:[],!0);return(0,da.RS)(t,o,!0,"",!1,a)}function _o(i,e,t,a,r,n){var s=new Xa.E4;return _.isEmpty(i)||s.withLazyValue(new Ia.o(function(){return{displayName:_.map(i,function(o){return o.displayName}).join(" "),value:_.map(t,function(o,l){return(0,St.xq)(o,i[l],n)}).join(" ")}})),null!=a&&e&&s.withLazyValue(new Ia.o(function(){return{displayName:e.displayName,value:(0,St.xq)(a,e,n,!1,r)}})),s}function en(i,e,t,a,r,n,s,o,l,u,c){var d,h;return 1===u||2===u?(d=t.totalFill,h=2):3===u?(d=t.otherFill,h=3):i>0?(d=t.increaseFill,h=0):(d=t.decreaseFill,h=1),{value:i,position:e,color:d.solid.color,sentimentColorType:h,categoryValue:a,categoryIndex:r,identity:n,seriesIndex:0,selected:!1,highlight:!1,key:n.getKey(),tooltipInfo:s&&function(){return s.getTooltipItems()},labelFill:o,labelFormatString:l,type:Gi.Ge.fromDescriptor(c),barType:u}}function Ls(i,e){var t=i.current+e;return{current:t,min:Math.min(i.min,t),max:Math.max(i.max,t)}}function _s(i,e,t,a,r,n,s,o,l){if(!_.isEmpty(i)&&!_.isEmpty(a))for(var u=function(h){if(null!=i[h]&&a[h]){var v=a[h].displayName,y=(0,St.xq)(i[h],a[h],r,!1,e?.[h]);if(_.isEmpty(s))t.withLazyValue(new Ia.o(function(){return{displayName:v,value:y}}));else{var f=i[h],p=s[h];if(_.isNumber(f)&&_.isNumber(p))v=(0,Bl.W)(n.getLocalizedString("Waterfall_BreakdownDifferenceTooltip"),v),y=jl(y,f,p),t.withLazyValue(new Ia.o(function(){return{displayName:v,value:y}}));else{if(null!=p){var S=(0,St.xq)(p,a[h],r,!1);t.withLazyValue(new Ia.o(function(){return{displayName:"".concat(l," ").concat(v),value:S}}))}null!=f&&t.withLazyValue(new Ia.o(function(){return{displayName:"".concat(o," ").concat(v),value:y}}))}}}},c=0;c<i.length;c++)u(c)}function jl(i,e,t){if(!t)return i;var a=e/Math.abs(t),r=(0,we.Z)("Percentage"),n=(0,we.WU)(a,r);return"".concat(i," (").concat(n,")")}var ed=function(){function i(e,t,a){this.breakdownMetadata=e,this.categoryMetadata=t,this.valueMetadata=a}return i.prototype.splitIdentity=function(e){return(0,Ol.Dh)(e)},i.prototype.createBreakdownIdentity=function(e,t,a){var r,n={dataMap:(r={},r[this.breakdownMetadata.queryName]=[(0,$r.TZ)((0,Gn.Sh)((0,g.__spreadArray)((0,g.__spreadArray)([],_.map(e,function(o){return o.left}),!0),_.map(a,function(o){return o.left}),!0),[(0,g.__spreadArray)((0,g.__spreadArray)([],_.map(t,function(o){return o.right}),!0),_.map(a,function(o){return o.right}),!0),(0,g.__spreadArray)((0,g.__spreadArray)([],_.map(e,function(o){return o.right}),!0),_.map(a,function(o){return o.right}),!0)]))],r),metadata:[this.valueMetadata.queryName]},s=(0,at.tV)(n);return new Tt.l0(s,!1,n)},i.prototype.createBreakdownOtherIdentity=function(e,t,a){var r,n={dataMap:(r={},r[this.breakdownMetadata.queryName]=[(0,$r.TZ)((0,Gn.ff)((0,Gn.Sh)([this.breakdownMetadata.expr],_.map(e,function(o){return[o.right]}))))],r),metadata:[this.valueMetadata.queryName]};n.dataMap[this.categoryMetadata[0].queryName]=[(0,$r.TZ)((0,Gn.Sh)(_.map(t,function(o){return o.left}),[_.map(a,function(o){return o.right}),_.map(t,function(o){return o.right})]))];var s=(0,at.tV)(n);return new Tt.l0(s,!1,n)},i.prototype.createBreakdownTooltip=function(e,t,a,r,n,s,o,l){var u=this,c=new Xa.E4;if(this.breakdownMetadata&&c.withLazyValue(new Ia.o(function(){return{displayName:u.breakdownMetadata.displayName,value:(0,St.xq)(a,u.breakdownMetadata,o)}})),this.valueMetadata&&(null!=n&&c.withLazyValue(new Ia.o(function(){return{displayName:"".concat(t," ").concat(u.valueMetadata.displayName),value:(0,St.xq)(n,u.valueMetadata,o,!1)}})),null!=r&&c.withLazyValue(new Ia.o(function(){return{displayName:"".concat(e," ").concat(u.valueMetadata.displayName),value:(0,St.xq)(r,u.valueMetadata,o,!1)}})),null!=s)){var d=(0,St.xq)(s,this.valueMetadata,o,!1);d=jl(d,s,n),c.withLazyValue(new Ia.o(function(){return{displayName:(0,Bl.W)(l.getLocalizedString("Waterfall_BreakdownDifferenceTooltip"),u.valueMetadata.displayName),value:d}}))}return c},i}(),Ps=function(){function i(e){var t=e.valueAxisProperties,a=e.y2AxisProperties,r=e.categoryAxisProperties,n=e.isValueAxisIrregular,s=void 0!==n&&n,o=e.style,l=e.hasY2Role,u=e.forceShowY2;this.chartType=e.chartType;var c=Pn(this.chartType),d=11===this.chartType;k.fF.assert(function(){return!(c&&d)},"You can't have a categorical Y axis with a Scatter chart"),this.isCategoryAxisSet=!!r,this.isValueAxisSet=!!t,this.isValueAxisIrregular=s;var h=c?t:r,v=c?r:t,y=this.isComboChart?t:a,f=this.isRibbonChart?.6:ee,p=!this.isRibbonChart,S=(0,g.__assign)((0,g.__assign)({},i.AxisDataDefaults),{innerPadding:c||d?void 0:f});S.gridline.strokeShow=c||d;var m=(0,g.__assign)((0,g.__assign)({},i.AxisDataDefaults),{innerPadding:c?f:void 0,show:!!c||p});m.gridline.strokeShow=!c,this.x=i.createSingleAxisFromObject(h,S,o),this.y=i.createSingleAxisFromObject(v,m,o),this.categoryAxis=c?this.y:this.x,this.valueAxis=c?this.x:this.y,s&&(this.valueAxis.show=!1);var b=(0,g.__assign)((0,g.__assign)({},i.AxisDataDefaults),{show:u&&l||(this.isComboChart?void 0:l),labelFontProperties:(0,We.ED)(c?this.x.labelFontProperties:this.y.labelFontProperties,{weight:Me.zu,style:Me.zu,textDecoration:Me.AI}),showAxisTitle:c?this.x.showAxisTitle:this.y.showAxisTitle,switchAxisPosition:!0});this.y2=(0,g.__assign)((0,g.__assign)({},i.createSingleAxisFromObject(y,b,o,!0,this.isComboChart)),{hasY2Role:l}),this.secondaryValueAxis=this.y2,this.seriesLabelSettings=e.seriesLabelSettings||{show:!1,maxWidthPercentage:0,defaultSeriesWidth:0,position:void 0},this.hasY2Role=l}return Object.defineProperty(i,"AxisDataDefaults",{get:function(){return{show:!0,alignZeros:!1,showAxisTitle:!1,includeDomains:[],axisType:void 0,axisStyle:ra.DO.showTitleOnly,labelDisplayUnits:0,labelPrecision:ye.NZ,titleText:void 0,preferredCategoryWidth:ka,maxMarginFactor:Ki.DefaultMaxMarginFactor,concatenateLabels:!0,labelFontProperties:{color:void 0,family:wi,size:Na.B.createFromPt(It),style:void 0,variant:void 0,weight:void 0,whiteSpace:void 0,textDecoration:void 0},titleFontProperties:{family:wi,size:Na.B.createFromPt(It)},axisLabel:void 0,logAxisScale:!1,gridline:{strokeShow:void 0,strokeColor:void 0,strokeTransparency:0,strokePattern:qt.Dv.solid,strokeWidth:1,strokeDashArray:qt.YU,strokeDashCap:qt.xm,strokeAutoScale:!1},innerPadding:void 0,invertAxis:!1,sharedAxis:!0,scaleToFit:!1,totalsEnabled:true,switchAxisPosition:!1,labelBold:!1,labelItalic:!1,labelUnderline:!1,titleBold:!1,titleItalic:!1,titleUnderline:!1}},enumerable:!1,configurable:!0}),i.prototype.showsSeriesLabels=function(){var e;return(null===(e=this.seriesLabelSettings)||void 0===e?void 0:e.show)&&(!this.isComboChart||this.hasY2Role)},Object.defineProperty(i.prototype,"isComboChart",{get:function(){return xa(this.chartType)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isRibbonChart",{get:function(){return 10===this.chartType},enumerable:!1,configurable:!0}),i.createSingleAxisFromObject=function(e,t,a,r,n){var s=r?function(C){return _.camelCase("sec ".concat(C.propertyName))}:function(C){return C.propertyName},o=N.p.valueAxis,l=J.v.create(a),u=function(A){return A>=1?A/100:A},d=(0,Je.N)(e,s(o.concatenateLabels),t.concatenateLabels),h=(0,Je.N)(e,s(o.gridlineStyle),t.gridline.strokePattern),v={family:s(o.fontFamily),size:s(o.fontSize),color:s(o.labelColor),sizeInPixels:!1,bold:s(o.bold),italic:s(o.italic),underline:s(o.underline)},y=(0,We.Zi)(e,v,l,a,t.labelFontProperties.color?void 0:"foregroundNeutralSecondaryAlt","smallLightLabel",t.labelFontProperties);v.family=s(o.titleFontFamily),v.size=s(o.titleFontSize),v.color=s(o.titleColor),v.bold=s(o.titleBold),v.italic=s(o.titleItalic),v.underline=s(o.titleUnderline);var A,f=(0,We.Zi)(e,v,l,a,void 0,"title",(0,We.ED)(t.titleFontProperties,{color:y.color,family:y.family,size:y.size,variant:y.variant,whiteSpace:y.whiteSpace})),p=Jr(t),S=(0,Je.N)(e,s(o.start),p[0]),m=(0,Je.N)(e,s(o.end),p[1]),b=void 0!==S,x=void 0!==m;return{show:(0,Je.N)(e,n?s(o.show):o.show.propertyName,t.show),alignZeros:(0,Je.N)(e,s(o.alignZeros),t.alignZeros),showAxisTitle:(0,Je.N)(e,s(o.showAxisTitle),t.showAxisTitle),includeDomains:b||x?[Yt([S,m],10,[b,x])]:[],axisType:(0,Je.N)(e,s(o.axisType),t.axisType),axisStyle:(0,Je.N)(e,s(o.axisStyle),t.axisStyle),labelDisplayUnits:(0,Je.N)(e,s(o.labelDisplayUnits),t.labelDisplayUnits),labelPrecision:(A=(0,Je.N)(e,s(o.labelPrecision),t.labelPrecision),null==A||A<0?t.labelPrecision:A),titleText:(0,Je.N)(e,s(o.titleText),t.titleText),preferredCategoryWidth:(0,Je.N)(e,s(o.preferredCategoryWidth),t.preferredCategoryWidth),maxMarginFactor:u((0,Je.N)(e,s(N.p.categoryAxis.maxMarginFactor),t.maxMarginFactor)),concatenateLabels:d,labelFontProperties:y,titleFontProperties:f,axisLabel:(0,Je.N)(e,s(o.axisLabel)),logAxisScale:(0,Je.N)(e,s(o.logAxisScale),t.logAxisScale),gridline:{strokeShow:(0,Je.N)(e,s(o.gridlineShow),t.gridline.strokeShow||!1===d),strokeColor:l.getColorForPropertyName(e,s(o.gridlineColor),i.getGridlineDefaultColorFromGridlineStyle(h)),strokeTransparency:(0,Je.N)(e,s(o.gridlineTransparency),t.gridline.strokeTransparency),strokeWidth:(0,Je.N)(e,s(o.gridlineThickness),t.gridline.strokeWidth),strokePattern:h,strokeDashArray:(0,Je.N)(e,s(o.gridlineDashArray),t.gridline.strokeDashArray),strokeDashCap:(0,Je.N)(e,s(o.gridlineDashCap),t.gridline.strokeDashCap),strokeAutoScale:(0,Je.N)(e,s(o.gridlineAutoScale),t.gridline.strokeAutoScale)},innerPadding:u((0,Je.N)(e,s(N.p.categoryAxis.innerPadding),t.innerPadding)),invertAxis:(0,Je.N)(e,s(o.invertAxis),t.invertAxis),sharedAxis:(0,Je.N)(e,o.sharedAxis.propertyName,t.sharedAxis),scaleToFit:(0,Je.N)(e,o.scaleToFit.propertyName,t.scaleToFit),totalsEnabled:(0,Je.N)(e,s(o.totalsEnabled),t.totalsEnabled),labelBold:(0,Je.N)(e,s(o.bold),t.labelBold),labelItalic:(0,Je.N)(e,s(o.italic),t.labelItalic),labelUnderline:(0,Je.N)(e,s(o.underline),t.labelUnderline),titleBold:(0,Je.N)(e,s(o.titleBold),t.titleBold),titleItalic:(0,Je.N)(e,s(o.titleItalic),t.titleItalic),titleUnderline:(0,Je.N)(e,s(o.titleUnderline),t.titleUnderline),switchAxisPosition:(0,Je.N)(e,s(o.switchAxisPosition),t.switchAxisPosition)}},i.getGridlineDefaultColorFromGridlineStyle=function(e){switch(e){case qt.Dv.dashed:case qt.Dv.solid:case qt.Dv.custom:return hs;case qt.Dv.dotted:return"foregroundNeutralTertiaryAlt";default:return k.fF.assertFail("unknown gridline style: ".concat(e)),hs}},i}(),ya=R(2241),qi=R(33024),jn=R(86727),mr=R(91059),Po=function(e,t,a,r){var n,u,o=N.p.valueAxis;return n=e?{fontFamilyReference:(u=t?o:N.p.y2Axis).secTitleFontFamily,fontSizeReference:u.secTitleFontSize,boldReference:u.secTitleBold,italicReference:u.secTitleItalic,underlineReference:u.secTitleUnderline,fontColorReference:u.secTitleColor}:{fontFamilyReference:(u=a?N.p.categoryAxis:o).titleFontFamily,fontSizeReference:u.titleFontSize,boldReference:u.titleBold,italicReference:u.titleItalic,underlineReference:u.titleUnderline,fontColorReference:u.titleColor},k.fF.assertValue(n,"getAxisTitleSubSelectionStyles titleReferences"),(0,Pt.un)(r,n)},To=function(e,t,a,r){var n,u,o=N.p.valueAxis;return n=e?{fontFamilyReference:(u=t?o:N.p.y2Axis).secFontFamily,fontSizeReference:u.secFontSize,boldReference:u.secBold,italicReference:u.secItalic,underlineReference:u.secUnderline,fontColorReference:u.secLabelColor,displayUnitsReference:u.secLabelDisplayUnits,precisionReference:u.secLabelPrecision}:{fontFamilyReference:(u=a?N.p.categoryAxis:o).fontFamily,fontSizeReference:u.fontSize,boldReference:u.bold,italicReference:u.italic,underlineReference:u.underline,fontColorReference:u.labelColor,displayUnitsReference:u.labelDisplayUnits,precisionReference:u.labelPrecision},(0,Pt.xs)(r,n)},ko=function(e,t,a,r,n){var s=Yl(a,e,t),o=s.axisTitleShow,l=s.zoomAxisShow,u=[{type:1,destinationInfo:{cardUid:Xl(e,a),groupUid:Fo(e,a,"title")},label:n.getLocalizedString("Format_AxisTitle")}];return Ul(a,r)&&u.unshift((0,g.__assign)((0,g.__assign)({type:2},l),{relatedToggledFormattingIds:[Ce.t.show],enabledLabel:n.getLocalizedString("Format_AddZoomSlider")})),u.unshift((0,g.__assign)((0,g.__assign)({type:2},o),{disabledLabel:n.getLocalizedString("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:0,excludedResetFormattingIds:[o,Ce.t.show,l]}),u},Mo=function(e,t,a,r,n,s){var o=Ul(a,r),l=Yl(a,e,t),u=l.axisShow,c=l.axisTitleShow,d=l.zoomAxisShow,h=[{type:1,destinationInfo:{cardUid:Xl(e,a),groupUid:Fo(e,a,a&&o?"valuesScalar":"values")},label:s.getLocalizedString("Format_AxisValues")}];return o||h.unshift({type:4,sortableField:{queryName:"",sortDirection:1},label:s.getLocalizedString("Format_SortAxis"),key:"Category"}),a&&n===ht.w.both&&h.unshift((0,g.__assign)((0,g.__assign)({type:3},N.p.categoryAxis.axisType),{label:s.getLocalizedString("Format_Label_AxisType")})),o&&h.unshift((0,g.__assign)((0,g.__assign)({type:2},d),{relatedToggledFormattingIds:[Ce.t.show],enabledLabel:s.getLocalizedString("Format_AddZoomSlider")})),h.unshift((0,g.__assign)((0,g.__assign)({type:2},c),{enabledLabel:s.getLocalizedString("Format_AddAxisTitle")})),h.unshift((0,g.__assign)((0,g.__assign)({type:2},u),{disabledLabel:s.getLocalizedString("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:0,excludedResetFormattingIds:[u,Ce.t.show,d]}),h},Ul=function(e,t){return!e||t},Yl=function(e,t,a){if(e)return{axisShow:N.p.categoryAxis.show,axisTitleShow:N.p.categoryAxis.showAxisTitle,zoomAxisShow:Ce.t.showOnCategoryAxis};if(t){var r=a?N.p.valueAxis:N.p.y2Axis;return{axisShow:r.show,axisTitleShow:r.secShowAxisTitle,zoomAxisShow:Ce.t.showOnValueSecAxis}}return{axisShow:N.p.valueAxis.show,axisTitleShow:N.p.valueAxis.showAxisTitle,zoomAxisShow:Ce.t.showOnValueAxis}},Xl=function(e,t){return e?"".concat("Visual","-").concat("y2Axis"):t?"".concat("Visual","-").concat("categoryAxis"):"".concat("Visual","-").concat("valueAxis")},Fo=function(e,t,a){return e?"".concat("y2Axis","-").concat(a):t?"".concat("categoryAxis","-").concat(a):"".concat("valueAxis","-").concat(a)},Qi=R(84741),Sr=R(61617),td=[[Qi.rJ.y,Qi.rJ.tooltips],[Qi.rJ.y2]];function Zl(){return td}function rd(i,e,t,a,r,n){var s=n===a?e.topLevelToggle:i.topLevelToggle,o=(0,g.__assign)((0,g.__assign)({},i),{topLevelToggle:s}),l={};e.groups.forEach(function(f){l[f.uid]=f}),i.groups.forEach(function(f,p){if((0,F.Qu)(f))k.fF.assertFail("Unsupported placeholder");else{var S=l[f.uid];S&&(o.groups[p]=Kl(f,S,t,a,r,"errorBars"===i.uid),delete l[f.uid])}});for(var u=0,c=e.groups;u<c.length;u++){var d=c[u];if((0,F.Qu)(d))return void k.fF.assertFail("Unsupported placeholder");var h=l[d.uid];h&&o.groups.push(h)}var v=_.unionWith(i.revertToDefaultDescriptors,e.revertToDefaultDescriptors,_.isEqual),y=Qi.OA;return o.revertToDefaultDescriptors=v.filter(function(f){return y[f.objectName]&&y[f.objectName][f.propertyName]}),o}function Kl(i,e,t,a,r,n){var s=(0,g.__assign)({},e),o=i.slices;k.fF.assert(function(){return!o||o.every(function(u){return!(0,F.Qu)(u)})},"Unexpected placeholder");var l=e.slices;return k.fF.assert(function(){return!l||l.every(function(u){return!(0,F.Qu)(u)})},"Unexpected placeholder"),s.slices=Ql(o,l,t,a,r),s.container=i.container&&e.container?function(i,e,t,a,r,n){var s,o=(0,g.__assign)({},e);o.containerItems=[];var l=(0,g.__spreadArray)([],i.containerItems,!0),u=(0,g.__spreadArray)([],e.containerItems,!0);if(n)(s=o.containerItems).push.apply(s,(0,g.__spreadArray)((0,g.__spreadArray)([],u,!1),l,!1));else{var c=void 0;k.fF.assert(function(){return l[0].displayName===u[0].displayName},"Trying to create a template from formattingContainerItems from items that are not equal"),i.containerItems.length>0&&e.containerItems.length>0&&(c=function(i,e,t,a,r){var n=(0,g.__assign)((0,g.__assign)({},e),{groups:[],slices:[]}),s={};e.groups.forEach(function(c){s[c.uid]=c}),i.groups.forEach(function(c,d){var h=s[c.uid];h?(n.groups[d]=Kl(c,h,t,a,r),delete s[c.uid]):n.groups[d]=c});for(var o=0,l=e.groups;o<l.length;o++){var u=l[o];s[u.uid]&&n.groups.push(s[u.uid])}return n.slices=Ql(i.slices,e.slices,t,a,r),n}(l.shift(),u.shift(),t,a,r)),o.containerItems.push(c);for(var d=[],h=0,v=l;h<v.length;h++)d.push({containerItem:v[h],layerType:t});for(var f=0,p=u;f<p.length;f++)d.push({containerItem:p[f],layerType:a});for(var m=0,b=d;m<b.length;m++){var x=b[m];o.containerItems.push(ud(c,x.containerItem,x.layerType))}}return o}(i.container,e.container,t,a,r,n):i.container||e.container,s}function ql(i){return _.findIndex(i,function(e){return!(0,F.IW)(e)&&function(i){var e=Qi.OA.labels.labelDensity,t=i.control.properties.descriptor;return t.objectName===e.objectName&&t.propertyName===e.propertyName}(e)})}function Ql(i,e,t,a,r){var n=[],s=ql(i),o=i[s],l=ql(e),u=e[l];o&&u&&(i=i.filter(function(m,b){return!(0,F.IW)(m)&&b!==s}),e=e.filter(function(m,b){return!(0,F.IW)(m)&&b!==l}));var c=Qi.OA,d={};e.forEach(function(m){eu(m,c)&&(d[(0,Sr.zU)(m,!1)]=m)}),i.forEach(function(m){if(eu(m,c)){var b=d[(0,Sr.zU)(m,!1)],x=m.displayName;if(function(i,e){return!(!e||e.control.type!==i.control.type||!function(i,e){if(!(0,F.IW)(i)&&!(0,F.IW)(e)){var t=i.control.properties.descriptor,a=e.control.properties.descriptor;if(_.isEqual(_.omit(a,["selector","instanceKind"]),_.omit(t,["selector","instanceKind"]))){if(at.fS(a.selector,t.selector))return!0;var s=void 0;if(null==a.selector&&(s=at.N6(t.selector)),null==t.selector&&(s=at.N6(a.selector)),s)return function(i,e){var t,a=i.control.properties.descriptor,r=e.control.properties.descriptor;a.instanceKind|=r.instanceKind,null!==(t=a.selector)&&void 0!==t||(a.selector=r.selector)}(i,e),!0}return!1}return!0}(i,e))&&("Dropdown"!==e.control.type||!!$l(e.control.properties,i.control.properties))}(m,b)){if((0,F.IW)(m)&&(0,F.IW)(b))for(var C in m.control.properties){var A=m.control.properties[C],T=b.control.properties[C];A&&T&&_.isEqual(A.descriptor,T.descriptor)&&(A.value=T.value)}else m.control.properties.value=b.control.properties.value;delete d[(0,Sr.zU)(b,!1)]}else x=tu(m.uid,t,r);n.push((0,g.__assign)((0,g.__assign)({},m),{displayName:x}))}});for(var h=0,v=e;h<v.length;h++){var y=v[h],f=d[(0,Sr.zU)(y,!1)],p=vd(y.uid,a);if(f){var S=tu(f.uid,a,r);n.push((0,g.__assign)((0,g.__assign)({},f),{displayName:S,uid:p}))}}return o&&u&&function(i,e,t,a){i.control.properties.value=e.control.properties.value;var r=a("Visual_LabelDensity");t.push((0,g.__assign)((0,g.__assign)({},i),{displayName:r}))}(o,u,n,r),n}function ud(i,e,t){var a=(0,g.__assign)({},e),r={};return e.groups.forEach(function(n){r[F.SS.getGroupUid(n.uid)]=n}),k.fF.assert(function(){return i.groups.length<=e.groups.length},"template container item has more groups than created container item"),i.groups.forEach(function(n,s){var o=F.SS.getGroupUid(n.uid);if(r[o]){var l={};r[o].slices.forEach(function(u){l[F.IN.getGroupAndSliceUid(u.uid)]=u}),a.groups[s].slices=[],n.slices.forEach(function(u){if((0,F.Qu)(u))k.fF.assertFail("Unsupported placeholder");else{var c=F.IN.getGroupAndSliceUid(u.uid),d=l[c];if(d||(d=l[function(i,e){return i.replace("__".concat(e,"__"),"")}(c,t)]),d)if("Dropdown"===d.control.type&&"Dropdown"===u.control.type)if($l(d.control.properties,u.control.properties))d.displayName=u.displayName,a.groups[s].slices.push(d);else{var y=a.groups[s].uid;a.groups[s].slices.push((0,g.__assign)((0,g.__assign)({},u),{uid:"".concat(y).concat(u.uid),displayName:u.displayName,disabled:!0}))}else d.displayName=u.displayName,a.groups[s].slices.push(d);else y=a.groups[s].uid,a.groups[s].slices.push((0,g.__assign)((0,g.__assign)({},u),{uid:"".concat(y).concat(u.uid),displayName:u.displayName,disabled:!0}))}})}}),a}function Jl(i){return void 0===i.items}function $l(i,e){return!(!Jl(i)||!Jl(e))&&_.isEqual(i.filterValues,e.filterValues)}function vd(i,e){return"".concat(i,"__").concat(e,"__")}function eu(i,e){if((0,F.IW)(i)){var t=i.control.properties;return!!t&&Object.keys(t).every(function(r){var n=t[r],s=n?.descriptor;return!s||!!(s&&e[s.objectName]&&e[s.objectName][s.propertyName])})}var a=i.control.properties.descriptor;return!!(a&&e[a.objectName]&&e[a.objectName][a.propertyName])}function tu(i,e,t){var n="Visual_Slice_Placeholder_"+function(i){for(var t=0,a=Array.from(yd.entries());t<a.length;t++){var r=a[t],s=r[1];if(r[0].includes(i))return s}return i}(F.IN.getSliceUid(i));return t(n,function(i,e){switch(i){case 4:return e("DisplayName_QuickCalc_PercentOfColumnTotal");case 0:return e("Visual_Slice_PlaceholderChartType_Line");default:k.fF.assertFail("There is not support for merging this chart layer type for formattingCards yet")}}(e,t))}var yd=new Map([[["detailLabelDisplayUnits","detailDisplayUnits","titleLabelDisplayUnits"],"displayUnits"],[["detailLabelPrecision","titleLabelPrecision"],"precision"]]),Vo=60;function bd(){for(var e,t,a,r,n,i=this,s=12!==this.chartType,l=new F.Nq(function(){return au.call(i,xd.call(i))},function(){return au.call(i,Cd.call(i))},function(){return Ad.call(i)},function(){return wd.call(i)},function(){return Ld.call(i)},function(){return Dd.call(i)},function(){return i.axisZoom.getZoomCard(s)}).build(),u=[],c=0,d=this.getLayers();c<d.length;c++){var h=d[c];if(!h.getFormattingCards)return;u.push(h.getFormattingCards({categoryAxisData:null===(t=null===(e=this.originalCartesianData)||void 0===e?void 0:e.axesData)||void 0===t?void 0:t.categoryAxis}))}if(k.fF.assert(function(){return i.isComboChart()||u.length<=1},"Formatting layer cards length is not as expected"),this.isComboChart()){var v=function(i,e){var t=[];switch(e){case 13:case 14:t=["bars","lines","shadeArea","layout","markers","labels","seriesLabels","totals","errorBars"]}return function(i,e){if(0===e.length)return i;var t={};i.forEach(function(o){t[o.uid]=o});for(var a=[],r=0,n=e;r<n.length;r++){var s=n[r];t[s]&&a.push(t[s])}return a}(i,t)}(function(i,e,t){if(0===i.length)return[];var a,r,n;switch(e){case 13:case 14:a=[4,0],r=4;break;default:k.fF.assertFail("There is no support to merge formatting cards for this chart type (enum): ".concat(e))}if(n=function(i,e){if(0!==e.length){var t={};i.forEach(function(l){t[l.type]=l.card});for(var a=[],r=function(u){t[u]&&t[u].forEach(function(c){return a.push({card:c,type:u})})},n=0,s=e;n<s.length;n++)r(s[n]);return a}}(i,a),0===n.length)return[];for(var s={},o=0,l=n;o<l.length;o++){var u=l[o],c=u.card;s[c.uid]=s[c.uid]?{card:rd(s[c.uid].card,c,s[c.uid].type,u.type,t,r),type:u.type}:{card:c,type:u.type}}for(var d=[],h=0,v=_.values(s);h<v.length;h++)d.push(v[h].card);return d}(u,this.chartType,function(f){for(var p=[],S=1;S<arguments.length;S++)p[S-1]=arguments[S];return i.hostServices.getLocalizedString(f,p)}),this.chartType);null===(a=l?.cards)||void 0===a||a.push.apply(a,v)}else 1===u.length?null===(r=l?.cards)||void 0===r||r.push.apply(r,u[0].card):k.fF.assert(function(){return 0===u.length},"Formatting cards for layer has unexpected length");var y=(0,Re._W)(this.background,this.localizer);return y&&(null===(n=l?.cards)||void 0===n||n.push(y)),l}function xd(){var e,i=this,t=null===(e=this.originalCartesianData)||void 0===e?void 0:e.axesData,a=this.axes;if(a.hasCategoryAxis()&&t){var r=N.p.categoryAxis,n=t.categoryAxis,s=a.isYAxisCategorical,o=s?"Visual_YAxis_Hyphen":"Visual_XAxis_Hyphen",l=new F.CQ(new F.lg("categoryAxis"),o,[r.show,r.axisType,r.start,r.end,r.fontFamily,r.fontSize,r.bold,r.italic,r.underline,r.labelColor,r.labelDisplayUnits,r.labelPrecision,r.maxMarginFactor,r.preferredCategoryWidth,r.showAxisTitle,r.titleText,r.axisStyle,r.titleFontFamily,r.titleFontSize,r.titleBold,r.titleItalic,r.titleUnderline,r.titleColor,r.concatenateLabels,r.show,r.invertAxis,r.logAxisScale,r.switchAxisPosition],this.localizer),u=this.categoryAxisIsScalar(),c=u.isScalar;u.supportedType===ht.w.both&&l.addGroup("type",function(b){b.addSimpleSlice("type",new F.uY({descriptor:r.axisType,value:c?ht.w.scalar:ht.w.categorical}).build())}),c&&l.addGroup("range",function(b){b.withDisplayName("Visual_Axis_Range");var x=Jr(n),C=x[0],A=x[1];if(a.isCategoryAxisDateTime()){var T=C&&Ta.y3.fromTimeValue(C),P=A&&Ta.y3.fromTimeValue(A);b.addSimpleSlice("min",new F.hz({descriptor:(0,g.__assign)((0,g.__assign)({},r.start),{propertyTypes:{dateTime:!0},instanceKind:3}),value:T,placeholder:"",validators:{max:{type:1,value:P}}}).build(),function(D){return D.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new F.hz({descriptor:(0,g.__assign)((0,g.__assign)({},r.end),{propertyTypes:{dateTime:!0},instanceKind:3}),value:P,placeholder:"",validators:{min:{type:0,value:T}}}).build(),function(D){return D.withCustomDisplayName("Visual_Gradient_MaxValue")})}else b.addSimpleSlice("min",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},r.start),{propertyTypes:{numeric:!0},instanceKind:3}),value:C,options:{maxValue:{type:1,value:A}}}).build(),function(D){return D.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},r.end),{propertyTypes:{numeric:!0},instanceKind:3}),value:A,options:{minValue:{type:0,value:C}}}).build(),function(D){return D.withCustomDisplayName("Visual_Gradient_MaxValue")});b.addSimpleSlice("logAxisScale",new F.bd({descriptor:r.logAxisScale,value:n.logAxisScale}).build(),function(D){return D.withDisabled(!i.isLogAxisScaleAllowed(!1)).withCustomDescriptionIf(function(){return!i.isLogAxisScaleAllowed(!1)},"Visual_LogarithmicScaleDescription")}),b.addSimpleSlice("invertAxis",new F.bd({descriptor:r.invertAxis,value:n.invertAxis}).build(),function(D){return D.withCustomDisplayName("Visual_InvertRange")})});var h=n.labelFontProperties,v=n.titleFontProperties,y=(new F.UN).withFontFamily({descriptor:r.fontFamily,value:h.family}).withFontSizeProperties({descriptor:r.fontSize,value:h.size.pt}).withBold({descriptor:r.bold,value:h.weight===Me.en}).withItalic({descriptor:r.italic,value:h.style===Me.BF}).withUnderline({descriptor:r.underline,value:h.textDecoration===Me.f0}),f=(new F.UN).withFontFamily({descriptor:r.titleFontFamily,value:v.family}).withFontSizeProperties({descriptor:r.titleFontSize,value:v.size.pt}).withBold({descriptor:r.titleBold,value:v.weight===Me.en}).withItalic({descriptor:r.titleItalic,value:v.style===Me.BF}).withUnderline({descriptor:r.titleUnderline,value:v.textDecoration===Me.f0}),p=y.build(),S=f.build();return l.addGroup(c?"valuesScalar":"values",function(b){var x;b.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",p).addTopLevelToggle("show",function(){return new F.bd({descriptor:r.show,value:n.show}).build()}).addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},r.labelColor),{instanceKind:3}),value:{value:h.color}}).build()),c?b.addSimpleSlice("displayUnits",new F.uY({descriptor:r.labelDisplayUnits,value:n.labelDisplayUnits}).build(),function(C){return C.withAliasName("Decimal")}).addSimpleSlice("precision",new F.mu({descriptor:r.labelPrecision,value:n.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:ye.vo}}}).build()):b.addSimpleSlice("maxMarginFactor",new F.JN({descriptor:r.maxMarginFactor,value:Math.round(100*n.maxMarginFactor),options:{minValue:{type:0,value:15},maxValue:{type:1,value:50},unitSymbol:qi.t2},localize:i.localizer}).build(),function(C){return C.withCustomDisplayName(s?"Visual_Max_Width":"Visual_Max_Height")}),s&&b.addSimpleSlice("switchAxisPosition",new F.bd({descriptor:r.switchAxisPosition,value:n.switchAxisPosition}).build(),function(C){return C.withCustomDisplayName("Visual_SwitchAxisPosition")}),null!==(x=i.cartesianVisualCapabilities)&&void 0!==x&&x.supportsHierarchicalCategoryAxis&&!c&&b.addSimpleSlice("concatenateLabels",new F.bd({descriptor:r.concatenateLabels,value:n.concatenateLabels}).build())}).addGroup("title",function(b){b.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new F.bd({descriptor:r.showAxisTitle,value:n.showAxisTitle}).build()}).addSimpleSlice("text",new F.fq({descriptor:r.titleText,value:n.titleText,placeholder:""}).build(),function(x){return x.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){return new F.uY({descriptor:r.axisStyle,value:n.axisStyle,filterValues:a.categoryAxisHasUnitType?[ra.DO.showTitleOnly,ra.DO.showUnitOnly,ra.DO.showBoth]:[ra.DO.showTitleOnly]}).build()}).addCompositeSlice("font","Font",S).addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},r.titleColor),{instanceKind:3}),value:{value:v.color}}).build(),function(x){return x.withCustomDisplayName("Generic_Color")})}),c||l.addGroup("layout",function(b){b.withDisplayName("Layout").withInheritDisabled(!1).addSimpleSlice("preferredCategoryWidth",new F.JN({descriptor:N.p.categoryAxis.preferredCategoryWidth,value:n.preferredCategoryWidth,options:{minValue:{type:0,value:20},maxValue:{type:1,value:180},unitSymbol:qi.e_},localize:i.localizer}).build(),function(x){return x.withCustomDisplayName(s?"Visual_Category_Height":"Visual_Category_Width").withCustomDescription(s?"Visual_Category_Height_Description":"Visual_Category_Width_Description").withHidden(c)})}),l.build()}}function Cd(){var e,i=this,t=null===(e=this.originalCartesianData)||void 0===e?void 0:e.axesData;if(t?.isValueAxisSet){var a=this.axes,r=N.p.valueAxis,n=t.valueAxis,s=a.isYAxisCategorical,o=s?"Visual_XAxis_Hyphen":"Visual_YAxis_Hyphen",l=new F.CQ(new F.lg("valueAxis"),o,[r.show,r.start,r.end,r.invertAxis,r.sharedAxis,r.scaleToFit,r.fontFamily,r.fontSize,r.bold,r.italic,r.underline,r.labelColor,r.labelDisplayUnits,r.labelPrecision,r.showAxisTitle,r.titleText,r.axisStyle,r.titleFontFamily,r.titleFontSize,r.titleBold,r.titleItalic,r.titleUnderline,r.titleColor,r.logAxisScale,r.switchAxisPosition],this.localizer),u=n.labelFontProperties,c=n.titleFontProperties,d=(new F.UN).withFontFamily({descriptor:r.fontFamily,value:u.family}).withFontSizeProperties({descriptor:r.fontSize,value:u.size.pt}).withBold({descriptor:r.bold,value:n.labelBold}).withItalic({descriptor:r.italic,value:n.labelItalic}).withUnderline({descriptor:r.underline,value:n.labelUnderline}),h=(new F.UN).withFontFamily({descriptor:r.titleFontFamily,value:c.family}).withFontSizeProperties({descriptor:r.titleFontSize,value:c.size.pt}).withBold({descriptor:r.titleBold,value:n.titleBold}).withItalic({descriptor:r.titleItalic,value:n.titleItalic}).withUnderline({descriptor:r.titleUnderline,value:n.titleUnderline}),v=d.build(),y=h.build();return l.addGroup("range",function(f){var p=Jr(n),S=p[0],m=p[1];f.withDisplayName("Visual_Axis_Range").withInheritDisabled(!1).addSimpleSlice("min",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},r.start),{propertyTypes:{numeric:!0},instanceKind:3}),value:S,options:{maxValue:{type:1,value:m}}}).build(),function(b){return b.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},r.end),{propertyTypes:{numeric:!0},instanceKind:3}),value:m,options:{minValue:{type:0,value:S}}}).build(),function(b){return b.withCustomDisplayName("Visual_Gradient_MaxValue")}),12!==i.chartType&&f.addSimpleSlice("logAxisScale",new F.bd({descriptor:r.logAxisScale,value:n.logAxisScale}).build(),function(b){return b.withDisabled(!i.isLogAxisScaleAllowed(!0)).withCustomDescriptionIf(function(){return!i.isLogAxisScaleAllowed(!0)},"Visual_LogarithmicScaleDescription")}),f.addSimpleSlice("invertAxis",new F.bd({descriptor:r.invertAxis,value:n.invertAxis}).build(),function(b){return b.withCustomDisplayName("Visual_InvertRange")}),i.isSmallMultiples()&&f.addSimpleSlice("sharedAxis",new F.bd({descriptor:r.sharedAxis,value:n.sharedAxis}).build(),function(b){a.isYAxisCategorical&&b.withCustomDisplayName("Visual_Shared_XAxis")}).addSimpleSlice("scaleToFit",new F.bd({descriptor:r.scaleToFit,value:n.scaleToFit}).build(),function(b){return b.withDisabled(n.sharedAxis)})}).addGroup("values",function(f){f.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",v).addTopLevelToggle("show",function(){return new F.bd({descriptor:r.show,value:n.show}).build()}).addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},r.labelColor),{instanceKind:3}),value:{value:u.color}}).build()),t.isValueAxisIrregular&&f.withDisabled(!0,"Visual_Axis_Disabled_IrregularAxis"),i.is100Stacked()||f.addSimpleSlice("displayUnits",new F.uY({descriptor:r.labelDisplayUnits,value:n.labelDisplayUnits}).build(),function(p){return p.withAliasName("Decimal")}).addSimpleSlice("precision",new F.mu({descriptor:r.labelPrecision,value:n.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:ye.vo}}}).build()),s||f.addSimpleSlice("switchAxisPosition",new F.bd({descriptor:r.switchAxisPosition,value:n.switchAxisPosition}).build(),function(p){return p.withCustomDisplayName("Visual_SwitchAxisPosition")})}).addGroup("title",function(f){f.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new F.bd({descriptor:r.showAxisTitle,value:n.showAxisTitle}).build()}).addSimpleSlice("text",new F.fq({descriptor:r.titleText,value:n.titleText,placeholder:""}).build(),function(p){return p.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){return new F.uY({descriptor:r.axisStyle,value:n.axisStyle,filterValues:a.valueAxisHasUnitType?[ra.DO.showTitleOnly,ra.DO.showUnitOnly,ra.DO.showBoth]:[ra.DO.showTitleOnly]}).build()}).addCompositeSlice("font","Font",y).addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},r.titleColor),{instanceKind:3}),value:{value:c.color}}).build(),function(p){return p.withCustomDisplayName("Generic_Color")})}),l.build()}}function Ad(){var e,i=this,t=null===(e=this.originalCartesianData)||void 0===e?void 0:e.axesData;if(t?.isValueAxisSet&&!t.isValueAxisIrregular){var r,n,s;switch(this.chartType){case 0:case 1:r=!0,n=N.p.y2Axis.show,s=N.p.y2Axis;break;case 13:case 14:r=!0,n=N.p.valueAxis.secShow,s=N.p.valueAxis;break;default:r=!1}if(r){var o=this.axes,l=t,u=l.y2,d=new F.CQ(new F.lg("y2Axis"),"Visual_Y2Axis_Hyphen",(0,g.__assign)((0,g.__assign)({},s),{alignZeros:N.p.valueAxis.alignZeros}),this.localizer),h=u.labelFontProperties,v=u.titleFontProperties,y=(new F.UN).withFontFamily({descriptor:s.secFontFamily,value:h.family}).withFontSizeProperties({descriptor:s.secFontSize,value:h.size.pt}).withBold({descriptor:s.secBold,value:u.labelBold}).withItalic({descriptor:s.secItalic,value:u.labelItalic}).withUnderline({descriptor:s.secUnderline,value:u.labelUnderline}),f=(new F.UN).withFontFamily({descriptor:s.secTitleFontFamily,value:v.family}).withFontSizeProperties({descriptor:s.secTitleFontSize,value:v.size.pt}).withBold({descriptor:s.secTitleBold,value:u.titleBold}).withItalic({descriptor:s.secTitleItalic,value:u.titleItalic}).withUnderline({descriptor:s.secTitleUnderline,value:u.titleUnderline}),p=y.build(),S=f.build();return d.addGroup("range",function(m){var b=Jr(u),x=b[0],C=b[1];m.withDisplayName("Visual_Axis_Range").addSimpleSlice("min",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},s.secStart),{instanceKind:3}),value:x,options:{maxValue:{type:1,value:C}}}).build(),function(A){return A.withCustomDisplayName("Visual_Gradient_MinValue")}).addSimpleSlice("max",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},s.secEnd),{instanceKind:3}),value:C,options:{minValue:{type:0,value:x}}}).build(),function(A){return A.withCustomDisplayName("Visual_Gradient_MaxValue")}),m.addSimpleSlice("logAxisScale",new F.bd({descriptor:s.secLogAxisScale,value:u.logAxisScale}).build(),function(A){return A.withDisabled(!i.isLogAxisScaleAllowed(!0,!0)).withCustomDescriptionIf(function(){return!i.isLogAxisScaleAllowed(!0,!0)},"Visual_LogarithmicScaleDescription")}),i.isComboChart()&&m.addSimpleSlice("alignZeroes",new F.bd({descriptor:N.p.valueAxis.alignZeros,value:l.valueAxis.alignZeros}).build())}).addGroup("values",function(m){m.withDisplayName("Role_DisplayName_Values").addTopLevelToggle("show",function(){return new F.bd({descriptor:n,value:u.show}).build()}).addCompositeSlice("font","Font",p).addSimpleSlice("color",new F.BT({descriptor:s.secLabelColor,value:{value:h.color}}).build()),i.is100Stacked()||m.addSimpleSlice("displayUnits",new F.uY({descriptor:s.secLabelDisplayUnits,value:u.labelDisplayUnits}).build(),function(b){return b.withAliasName("Decimal")}).addSimpleSlice("precision",new F.mu({descriptor:s.secLabelPrecision,value:u.labelPrecision,options:{minValue:{type:0,value:0},maxValue:{type:1,value:ye.vo}}}).build())}).addGroup("title",function(m){m.withDisplayName("Visual_Title").withInheritDisabled(!1).addTopLevelToggle("show",function(){return new F.bd({descriptor:s.secShowAxisTitle,value:u.showAxisTitle}).build()}).addSimpleSlice("text",new F.fq({descriptor:s.secTitleText,value:u.titleText,placeholder:""}).build(),function(b){return b.withCustomDisplayName("Visual_Title_Text")}).addSimpleSlice("style",function(){return new F.uY({descriptor:s.secAxisStyle,value:u.axisStyle,filterValues:o.valueAxisHasUnitType?[ra.DO.showTitleOnly,ra.DO.showUnitOnly,ra.DO.showBoth]:[ra.DO.showTitleOnly]}).build()}).addCompositeSlice("font","Font",S).addSimpleSlice("color",new F.BT({descriptor:s.secTitleColor,value:{value:v.color}}).build(),function(b){return b.withCustomDisplayName("Generic_Color")})}),d.build()}}}function wd(){var i,e=null===(i=this.originalCartesianData)||void 0===i?void 0:i.legendData;if(!_.isEmpty(this.dataViews)&&e){for(var t={legendData:e},r=0,n=this.getLayers();r<n.length;r++){var s=n[r];s.customizeLegendFormattingModelOptions&&(t=s.customizeLegendFormattingModelOptions(t))}var o;return o=this.featureSwitches.onObject?"Visual_LegendCard_DisabledReasonNew":13===this.chartType?"Visual_LegendCard_ComboLineClustered_DisabledReason":14===this.chartType?"Visual_LegendCard_ComboLineStacked_DisabledReason":"Visual_LegendCard_DisabledReason",(0,jn.ZF)(t,this.hostServices,this.featureSwitches,!this.shouldShowLegendCard(),o)}}function Dd(){var e,i=this,t=null===(e=this.originalCartesianData)||void 0===e?void 0:e.axesData;if(!_.isEmpty(this.dataViews)&&t){var s,o,l,u,a=this.axes,r=a.hasCategoryAxis(),n=a.isYAxisCategorical,d=this.categoryAxisIsScalar().isScalar||this.hasHierarchicalAxisRenderMode;n?(s=N.p.categoryAxis,o=t.categoryAxis,r&&(l=N.p.valueAxis,u=t.valueAxis)):(s=N.p.valueAxis,o=t.valueAxis,r&&12!==this.chartType&&(l=N.p.categoryAxis,u=t.categoryAxis));var h=new F.CQ(new F.lg("gridlines"),"Visual_Gridline_Show",[N.p.categoryAxis.gridlineShow,N.p.categoryAxis.gridlineStyle,N.p.categoryAxis.gridlineColor,N.p.categoryAxis.gridlineTransparency,N.p.categoryAxis.gridlineThickness,N.p.categoryAxis.gridlineDashArray,N.p.categoryAxis.gridlineDashCap,N.p.categoryAxis.gridlineAutoScale,N.p.valueAxis.gridlineShow,N.p.valueAxis.gridlineStyle,N.p.valueAxis.gridlineColor,N.p.valueAxis.gridlineTransparency,N.p.valueAxis.gridlineThickness,N.p.valueAxis.gridlineDashArray,N.p.valueAxis.gridlineDashCap,N.p.valueAxis.gridlineAutoScale],this.localizer),v=function(f,p,S,m){p&&f.withDisplayName(m).addTopLevelToggle("show",function(){return new F.bd({descriptor:p.gridlineShow,value:!!S.show&&S.gridline.strokeShow}).build()},function(b){return b.withDisabled(!S.show)}).addSlices((0,ya.Iq)({containerItemBuilder:f,descriptors:{strokePattern:p.gridlineStyle,strokeColor:p.gridlineColor,strokeTransparency:p.gridlineTransparency,strokeWidth:p.gridlineThickness,strokeDashArray:p.gridlineDashArray,strokeDashCap:p.gridlineDashCap,strokeAutoScale:p.gridlineAutoScale},strokeData:S.gridline,selector:void 0,featureSwitches:i.featureSwitches,localize:i.localizer,isSVGStroke:!0,colorInstanceKind:3,maxWidth:4}).map(function(b){return b.build()}))};return(o&&!n||n&&d)&&h.addGroup("horizontal",function(y){return v(y,s,o,"Visual_LabelOrientation_Horizontal")}),(l&&u&&n||!n&&d)&&h.addGroup("vertical",function(y){return v(y,l,u,"Visual_LabelOrientation_Vertical")}),h.build()}}function Ld(){var i=this;if(11!==this.chartType&&12!==this.chartType&&!_.isEmpty(this.dataViews)){var e=qe.N_.smallMultiplesLayout,t=qe.N_.subheader,a=new F.CQ(new F.lg("smallMultiples"),"Role_DisplayName_SmallMultiples",[e.rowCount,e.columnCount,e.gridPadding,e.advancedPaddingOptions,e.columnPaddingInner,e.columnPaddingOuter,e.rowPaddingInner,e.rowPaddingOuter,e.gridLineType,e.gridLineShow,e.gridLineStyle,e.gridLineColor,e.gridLineTransparency,e.gridLineWidth,e.backgroundColor,e.backgroundTransparency,t.show,t.fontFamily,t.fontSize,t.fontColor,t.underline,t.bold,t.italic,t.position,t.alignment,t.titleWrap],this.localizer);if(!this.showSmallMultiplesCard())return a.withDisabled(!0,"Visual_SmallMultipleCard_DisabledReason"),a.build();var r=Xi(this.dataViews[0].metadata.objects,this.layerStyle),n=kn(this.dataViews[0].metadata.objects,this.layerStyle),s=vr(r);return a.withDescription("Small_Multiples_Layout_Description").addGroup("layout",function(o){k.fF.assert(function(){return 0!==r.layoutType},"Unexpected auto layout"),o.withDisplayName("Layout").addSimpleSlice("rowCount",new F.mu({descriptor:e.rowCount,value:r.rowCount,options:{minValue:{type:0,value:gt},maxValue:{type:1,value:s.maxRowCount}}}).build()).addSimpleSlice("columnCount",new F.mu({descriptor:e.columnCount,value:r.columnCount,options:{minValue:{type:0,value:Ye},maxValue:{type:1,value:s.maxColumnCount}}}).build());var l=r.advancedPaddingOptions,u={minValue:{type:0,value:0},maxValue:{type:1,value:40}};o.addSimpleSlice("gridPadding",new F.mu({descriptor:e.gridPadding,value:r.gridPadding,options:u}).build(),function(c){return c.withDisabled(l).withCustomDisplayName("Small_Multiples_All_Padding")}).addSimpleSlice("advancedPadding",new F.bd({descriptor:e.advancedPaddingOptions,value:r.advancedPaddingOptions}).build(),function(c){return c.withCustomDisplayName("Small_Multiples_Customize_Padding")}),l&&o.addSimpleSlice("columnPaddingInner",new F.JN({descriptor:e.columnPaddingInner,value:r.columnPaddingInner,options:u,localize:i.localizer}).build()).addSimpleSlice("columnPaddingOuter",new F.JN({descriptor:e.columnPaddingOuter,value:r.columnPaddingOuter,options:u,localize:i.localizer}).build()).addSimpleSlice("rowPaddingInner",new F.JN({descriptor:e.rowPaddingInner,value:r.rowPaddingInner,options:u,localize:i.localizer}).build()).addSimpleSlice("rowPaddingOuter",new F.JN({descriptor:e.rowPaddingOuter,value:r.rowPaddingOuter,options:u,localize:i.localizer}).build())}),a.addGroup("border",function(o){return o.withDisplayName("Visual_Border").addSimpleSlice("gridLineType",new F.uY({descriptor:e.gridLineType,value:r.gridline.region===Ci.o.none?Ci.o.inner:r.gridline.region}).build()).addSlices((0,ya.Iq)({containerItemBuilder:o,descriptors:{strokeShow:e.gridLineShow,strokeColor:e.gridLineColor,strokeTransparency:e.gridLineTransparency,strokePattern:e.gridLineStyle,strokeWidth:e.gridLineWidth},strokeData:r.gridline,selector:void 0,featureSwitches:i.featureSwitches,localize:i.localizer}).map(function(l){return l.build()}))}),a.addGroup("title",function(o){o.withDisplayName("Title"),o.addTopLevelToggle("show",function(){return new F.bd({descriptor:t.show,value:!!i.showSubheaderCard()&&n.show}).build()});var l=n.fontProperties,c=(new F.UN).withFontFamily({descriptor:t.fontFamily,value:l.family}).withFontSizeProperties({descriptor:t.fontSize,value:l.size.pt}).withBold({descriptor:t.bold,value:n.labelBold}).withItalic({descriptor:t.italic,value:n.labelItalic}).withUnderline({descriptor:t.underline,value:n.labelUnderline}).build();o.addSimpleSlice("position",function(){var d;switch(n.vertical){default:case 0:d=hr.cL.top;break;case 1:d=hr.cL.bottom}return new F.uY({descriptor:t.position,value:d}).build()}).addCompositeSlice("font","Font",c).addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},t.fontColor),{instanceKind:3,selector:{data:[(0,mr.Yp)([N.x.rows])]},altConstantValueSelector:null}),value:{value:l.color}}).build()).addSimpleSlice("alignment",function(){var d;switch(n.horizontal){default:case 0:d=Ai.D.left;break;case 1:d=Ai.D.center;break;case 2:d=Ai.D.right}return new F.Gp({descriptor:t.alignment,value:d,mode:"horizontalAlignment"}).build()}),o.addSimpleSlice("titleWrap",new F.bd({descriptor:t.titleWrap,value:n.titleWrap}).build(),function(d){return d.withCustomDisplayName("TextWrap")})}),a.addGroup("background",function(o){return o.withDisplayName("Visual_Background").addSimpleSlice("color",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},e.backgroundColor),{selector:{data:[(0,mr.Yp)([N.x.rows])]},altConstantValueSelector:null,instanceKind:3}),value:{value:r.backgroundColor},isNoFillItemSupported:!0}).build(),function(l){return l.withCustomDisplayName("Generic_Color")}).addSimpleSlice("transparency",F.JN.getTransparencySliderBuilder({descriptor:e.backgroundTransparency,value:r.backgroundTransparency,localize:i.localizer}).build(),function(l){return l.withCustomDisplayName("Transparency")})}),a.build()}}function Oo(i,e){return new F.JN({descriptor:N.p.categoryAxis.innerPadding,value:so(i),options:{minValue:{type:0,value:M},maxValue:{type:1,value:w},unitSymbol:qi.t2},localize:e}).build()}function au(i){if(i)for(var t=i,a=0,r=this.getLayers();a<r.length;a++){var n=r[a];return n.customizeFormattingCard&&(t=n.customizeFormattingCard(i)),t}}function _d(i){for(var t=0,a=this.getLayers();t<a.length;t++){var r=a[t];if(r.getSubSelectionCustomOutlines){var n=r.getSubSelectionCustomOutlines(i);if(n)return n}}return[]}function Pd(i){for(var t=0,a=this.getLayers();t<a.length;t++){var r=a[t];if(r.getSubSelectionCustomElements){var n=r.getSubSelectionCustomElements(i);if(n)return n}}return[]}function Td(i){for(var t=0,a=this.getLayers();t<a.length;t++){var r=a[t];if(r.getSubSelectionMetadata){var n=r.getSubSelectionMetadata(i);if(n)return n}}return null}function kd(i){if(this.featureSwitches.onObject){var a,r,t=_.first(i).visualObjects;if(!(t.length>0))return;a=t[0],a?.selectorsByColumn&&(r=(0,at.fd)((0,at.tV)(a.selectorsByColumn)));var n=1===this.getLayers().length&&this.cartesianData.legendData.dataPoints.length<=1,s=this.isComboChart();switch(a.objectName){case"legend-title":return(0,jn.aJ)();case"x-axis-zoom-slider":case"y1-axis-zoom-slider":case"y2-axis-zoom-slider":return;case"legend-items":return(0,jn.Gh)(this.hostServices);case"horizontal-gridlines":return Pt.w3(this.hostServices,this.axes.isYAxisCategorical?N.p.categoryAxis.gridlineColor:N.p.valueAxis.gridlineColor);case"vertical-gridlines":return Pt.w3(this.hostServices,this.axes.isYAxisCategorical?N.p.valueAxis.gridlineColor:N.p.categoryAxis.gridlineColor);case"series-labels":var o=n?void 0:r;return Pt.un(this.hostServices,{fontFamilyReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.seriesFontFamily),{selector:o}),fontSizeReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.textSize),{selector:o}),boldReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.bold),{selector:o}),italicReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.italic),{selector:o}),underlineReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.underline),{selector:o}),fontColorReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.seriesColor),{selector:o}),backgroundReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.backgroundColor),{selector:o}),wordWrapReference:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.seriesWordWrap),{selector:o})});case"x-axis-title":return Po(!1,s,!this.axes.isYAxisCategorical,this.hostServices);case"y1-axis-title":return Po(!1,s,this.axes.isYAxisCategorical,this.hostServices);case"y2-axis-title":return Po(!0,s,this.axes.isYAxisCategorical,this.hostServices);case"x-axis-values":return To(!1,s,!this.axes.isYAxisCategorical,this.hostServices);case"y1-axis-values":return To(!1,s,this.axes.isYAxisCategorical,this.hostServices);case"y2-axis-values":return To(!0,s,this.axes.isYAxisCategorical,this.hostServices);case"grid-cell-subheader":var l=qe.N_.subheader;return Pt.un(this.hostServices,{fontFamilyReference:l.fontFamily,fontSizeReference:l.fontSize,boldReference:l.bold,italicReference:l.italic,underlineReference:l.underline,fontColorReference:(0,g.__assign)((0,g.__assign)({},l.fontColor),{selector:{data:[(0,mr.Yp)([N.x.rows])]}}),horizontalAlignmentReference:l.alignment,wordWrapReference:l.titleWrap});case"small-multiples-gridlines":var u=qe.N_.smallMultiplesLayout;return Pt.w3(this.hostServices,u.gridLineColor,(0,g.__assign)((0,g.__assign)({},u.backgroundColor),{selector:{data:[(0,mr.Yp)([N.x.rows])]}}),this.localizer("Visual_Border"));default:for(var c=0,d=this.getLayers();c<d.length;c++){var h=d[c];if(h.getSubSelectionStyles){var v=h.getSubSelectionStyles(i);if(v)return v}}}}}function Md(i,e){if(this.featureSwitches.onObject&&!e){var r,a=_.first(i).visualObjects;if(!(a.length>0))return;r=a[0];var u,n=this.getLayers(),s=this.isComboChart(),o=n.length<=1&&this.cartesianData.legendData.dataPoints.length<=1,l={key:"Delete",nextValue:!1};switch(!o&&!_.isEmpty(r.selectorsByColumn)&&(u=(0,at.fd)((0,at.tV)(r.selectorsByColumn))),r.objectName){case"legend-title":return(0,jn.tV)(this.hostServices);case"legend-items":return(0,jn.tY)({hostServices:this.hostServices,showSort:!0});case"horizontal-gridlines":return[(0,g.__assign)((0,g.__assign)({type:2},(this.axes.isYAxisCategorical?N.p.categoryAxis:N.p.valueAxis).gridlineShow),{disabledLabel:this.localizer("Delete"),keyboardShortcuts:[l]}),{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("gridlines"),groupUid:"".concat("gridlines","-").concat("horizontal")},label:this.localizer("Format_Gridlines")}];case"vertical-gridlines":return[(0,g.__assign)((0,g.__assign)({type:2},(this.axes.isYAxisCategorical?N.p.valueAxis:N.p.categoryAxis).gridlineShow),{disabledLabel:this.localizer("Delete"),keyboardShortcuts:[l]}),{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("gridlines"),groupUid:"".concat("gridlines","-").concat("vertical")},label:this.localizer("Format_Gridlines")}];case"data-labels":var h=o?qe.N_.labels.show:qe.N_.labels.showSeries;return[(0,g.__assign)((0,g.__assign)({type:2},h),{disabledLabel:this.localizer("Delete"),selector:u,keyboardShortcuts:[l]}),{type:0,excludedResetFormattingIds:[(0,g.__assign)((0,g.__assign)({},h),{selector:u})],relatedResetFormattingIds:[(0,g.__assign)((0,g.__assign)({},qe.N_.labels.enableBackground),{selector:u})]},{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},qe.N_.labels.labelPosition),{selector:u}),label:this.localizer("Format_Data_Labels")}];case"series-labels":return[(0,g.__assign)((0,g.__assign)({type:2},qe.N_.seriesLabels.show),{disabledLabel:this.localizer("Delete"),selector:u,keyboardShortcuts:[l]}),{type:0,relatedResetFormattingIds:[(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.enableBackground),{selector:u})],excludedResetFormattingIds:[(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.show),{selector:u})]},{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},qe.N_.seriesLabels.seriesPosition),{selector:u}),label:this.localizer("Format_Series_Labels")}];case"total-labels":return[(0,g.__assign)((0,g.__assign)({type:2},qe.N_.totals.show),{disabledLabel:this.localizer("Delete"),keyboardShortcuts:[l]}),{type:0,excludedResetFormattingIds:[qe.N_.totals.show]},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("totals"),groupUid:"".concat("totals","-").concat("values")},label:this.localizer("Format_Total_Labels")}];case"x-axis-title":return ko(!1,s,!this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y1-axis-title":return ko(!1,s,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"y2-axis-title":return ko(!0,s,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.hostServices);case"x-axis-values":return Mo(!1,s,!this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"y1-axis-values":return Mo(!1,s,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"y2-axis-values":return Mo(!0,s,this.axes.isYAxisCategorical,this.categoryAxisIsScalar().isScalar,this.categoryAxisIsScalar().supportedType,this.hostServices);case"grid-cell-subheader":return[(0,g.__assign)((0,g.__assign)({type:2},qe.N_.subheader.show),{disabledLabel:this.localizer("Delete"),keyboardShortcuts:[l]}),{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("smallMultiples"),groupUid:"".concat("smallMultiples","-").concat("title")},label:this.localizer("Format_Small_Multiples_Title")}];case"small-multiples-gridlines":return[{type:0},(0,g.__assign)((0,g.__assign)({type:3},qe.N_.smallMultiplesLayout.gridLineType),{label:this.localizer("Small_Multiples_Gridlines_Style")}),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("smallMultiples"),groupUid:"".concat("smallMultiples","-").concat("border")},label:this.localizer("Format_Small_Multiples_Border")}];case"x-axis-zoom-slider":case"y1-axis-zoom-slider":case"y2-axis-zoom-slider":return[(0,g.__assign)((0,g.__assign)({type:2},"y2-axis-zoom-slider"===r.objectName?Ce.t.showOnValueSecAxis:!("x-axis-zoom-slider"!==r.objectName)==!!this.axes.isYAxisCategorical?Ce.t.showOnValueAxis:Ce.t.showOnCategoryAxis),{disabledLabel:this.localizer("Delete"),keyboardShortcuts:[l]}),{type:0,excludedResetFormattingIds:[Ce.t.showOnValueSecAxis]},(0,g.__assign)((0,g.__assign)({type:2},Ce.t.showLabels),{enabledLabel:this.localizer("Format_AddSliderLabels")}),(0,g.__assign)((0,g.__assign)({type:2},Ce.t.showTooltip),{enabledLabel:this.localizer("Format_AddSliderTooltips")}),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("zoom"),groupUid:"".concat("zoom","-").concat("default")},label:this.localizer("Format_ZoomSlider")}];default:for(var m=0,b=n;m<b.length;m++){var x=b[m];if(x.getSubSelectionShortcuts){var C=x.getSubSelectionShortcuts(i,e);if(C)return C}}}}}function Fd(i){for(var e=this.subSelectionHelper.getAllSubSelectables(i),a=0,r=this.getLayers();a<r.length;a++){var n=r[a];n.getDisambiguationSubSelectables&&e.push.apply(e,n.getDisambiguationSubSelectables(this.subSelectionHelper,i))}return e}var tn=R(94478),iu=R(10034),ri=R(77686),ma=R(59107),an=R(30237),ru=function(){function i(){}return i.prototype.bindEvents=function(e,t,a,r){var s,n=this;if(e&&!r){if(this.ticks=e.ticks,a){var o=a.dataPointNavigationManager,l=a.pointSourceKey;o.isEmpty(l)||((0,an.W3)(e.root,o,l),(0,an.I8)(e.root,o,l),(0,an.lt)(e.root,t))}this.ticks.on("click.select",function(){return n.handleSelection(t)}).on("keydown.select",function(){var u=d3.event,c=u.keyCode;(32===c||13===c)&&(u.preventDefault(),u.stopPropagation(),n.handleSelection(t))})}else null===(s=this.ticks)||void 0===s||s.on("click.select",null).on("keydown.select",null)},i.prototype.renderSelection=function(e){var t;null===(t=this.ticks)||void 0===t||t.style("font-weight",function(a){return a.selected?"700":null}).select("text").attr("aria-selected",function(a){return e&&a.selected})},i.prototype.renderFocus=function(e){ma.M.focus(e)},i.prototype.handleSelection=function(e){(0,an.kW)(function(t){return(0,an.c8)(t,e)},!0)},i}(),Vd=R(70450),Ts=R(63194),Vt=R(60066),Un=R(38400),No=R(41234),Yn=R(65195),Et=R(10389);function Ro(i){var e=i.viewport,t=i.margin;return{width:e.width-t.left-t.right,height:e.height-t.top-t.bottom}}var Od={left:10,right:10,top:0,bottom:13};function Io(i){var e=i.rendererSettings,t=e.interactivity,a=e.axes,r=e.calculatePlotArea,n=e.cartesianOptions.chartType,s=i.axisZoom,o=i.axesData,l=i.layers,u=i.playAxesRect,d=i.trimOrdinalDataOnOverflow,h=i.viewport,v=i.rotateXTickLabels90,y=i.forceMarginMin,f=[],p=[],S=[];function m(b){var x=d3.extent(b);return{min:x[0],max:x[1]}}return(0,he.Lp)(i.referenceLines,f,p,S,Br(l)),a.negotiateAxes({layers:l,parentViewport:h,padding:(0,be.ED)(Od),playAxisControlLayout:u,showAxisTitles:su(o,s),shouldRenderAxis:uo(o,xa(n)),axesFontProperties:nu(o),interactivityRightMargin:t?.mobileTileInteractive&&!d?6:0,calculatePlotArea:r,skipMergeValueAxes:s?.skipMergingValueAxisDomains(),ensureXDomain:m(f),ensureYDomain:m(p),ensureY2Domain:m(S),rotateXTickLabels90:v,forceMarginMin:y})}function rn(i){return i.isXScrollBarVisible||i.isYScrollBarVisible}function nu(i){return{x:{tickLabels:i.x.labelFontProperties,title:i.x.titleFontProperties},y:{tickLabels:i.y.labelFontProperties,title:i.y.titleFontProperties},y2:{tickLabels:i.y2.labelFontProperties,title:i.y2.titleFontProperties}}}function su(i,e){var t={x:i.x.showAxisTitle,y:i.y.showAxisTitle,y2:i.y2.showAxisTitle};return e&&(t=e.updateShowAxisTitles(t)),t}var ou=function(){function i(e){this.settings=e,this.axesData=e.data;var t=this.axesData.useManagedTabIndex,a=this.axisGraphicsContext=this.settings.container.append("g").attr(U.CP,!0).classed(i.AxisGraphicsContext.class,!0);this.svgScrollable=this.settings.container.append("svg").classed("svgScrollable",!0).style("overflow","hidden");var r=this.axisGraphicsContextScrollable=this.svgScrollable.append("g").attr(U.CP,!0).classed(i.AxisGraphicsContext.class,!0);this.labelBackgroundRegion=this.svgScrollable.append("g").classed(ye.u9.class,!0),this.labelRegion=this.svgScrollable.append("g").classed(ye.ZL.class,!0),this.labelContainerRegion=this.svgScrollable.append("g").classed(ye.LV.class,!0).attr(U.CP,!0),this.labelSeriesBackgroundRegion=this.svgScrollable.append("g").classed(ye.pJ.class,!0),this.labelSeriesRegion=this.svgScrollable.append("g").classed(ye.oA.class,!0),this.axes.isYAxisCategorical?(this.y1AxisGraphicsContext=r.append("g").attr("class","y axis").attr("data-automation-type","y axis").classed(Ts.rG.class,t).attr(Yn.Rh,t),this.y2AxisGraphicsContext=r.append("g").attr("class","y axis").attr("data-automation-type","y2 axis"),this.xAxisGraphicsContext=a.append("g").attr("class","x axis").attr("data-automation-type","x axis").attr(U.CP,!0)):(this.y1AxisGraphicsContext=a.append("g").attr("class","y axis").attr("data-automation-type","y axis"),this.y2AxisGraphicsContext=a.append("g").attr("class","y axis").attr("data-automation-type","y2 axis"),this.xAxisGraphicsContext=r.append("g").attr("class","x axis").attr("data-automation-type","x axis").classed(Ts.rG.class,t).attr(Yn.Rh,t))}return Object.defineProperty(i.prototype,"axes",{get:function(){return this.settings.axes},enumerable:!1,configurable:!0}),i.prototype.getScrollableRegion=function(){return this.axisGraphicsContextScrollable},i.prototype.getLabelsRegion=function(){return this.labelRegion},i.prototype.getSeriesLabelsRegion=function(){return this.labelSeriesRegion},i.prototype.getLabelBackground=function(){return this.labelBackgroundRegion},i.prototype.getLabelsContainers=function(){return{foreground:this.labelRegion,background:this.labelBackgroundRegion}},i.prototype.getLabelContainerRegion=function(){return{foreground:this.labelContainerRegion}},i.prototype.getSeriesLabelsContainers=function(){return{seriesForeground:this.labelSeriesRegion,seriesBackground:this.labelSeriesBackgroundRegion}},i.prototype.update=function(e){this.axesData=e},Object.defineProperty(i.prototype,"featureSwitches",{get:function(){return this.settings.cartesianOptions.featureSwitches},enumerable:!1,configurable:!0}),i.updateTickTooltips=function(e,t){var a=t.d3Axis.tickValues(),r=i.getTickFormatter(t.d3Axis);e.selectAll(i.TickTextSelector).each(function(n){var s=d3.select(this),o=a.indexOf(n);o<0||s.append("title").text(r(n,o))})},i.getTickFormatter=function(e){return e.tickFormat()||On},i.prototype.renderAxis=function(e){var t,a,r,n,s,o,u,c,d=e.axesLayout,h=e.isStacked,v=e.gridlineOptions,y=e.firstVisibleNode,f=0===e.location,p=1===e.location,S=!f,m=d.tickPadding,b=d.margin,x=d.marginLimits.left,C=d.tickLabelMargins,A=d.plotArea.width,T=d.axes,P=this.getGraphicsElement(e),D=h?1:this.getAxisRenderMode(e);if(0!==D){var L=i.getAxisProps(e),O=i.getAxisTickLabelFontProperties(e),B=!(0,ne._9)(L.scale),E=!f&&"right"===this.axes.getYAxisPosition(e.location),j=E?m.right:m.left;if(_.isEmpty(En(T))||!L.isCategoryAxis||h){P.selectAll(i.HierarchicalStackCS.selector).remove(),f?(L.d3Axis.tickSizeInner(B?-d.plotArea.height:0).tickSizeOuter(0),!L.willLabelsFit&&!B&&L.d3Axis.tickPadding(i.TickPaddingRotatedX)):B?L.d3Axis.tickSize(h?C.stackHeight:p?-A:i.Y2TickSize).tickPadding(j):L.d3Axis.tickSize(Zi),L.d3Axis=i.orient(P,L.d3Axis,f?"bottom":this.axes.getYAxisPosition(e.location));var H=(a=void 0===(t=e.cartesianOptions)?{}:t).animateCategoryAxis,Z=a.animateValueAxis,ve=(n=void 0===(r=e.axesAnimationOptions)?{}:r).duration,fe=n.ease,re=(s=e.axesLayout.axes).x.isCategoryAxis,ge=s.y1.isCategoryAxis,Ae=(void 0===(o=s.y2)?{}:o).isCategoryAxis;k.fF.assert(function(){return!Ae},"Unit test scream check -  Y2 cannot be categorical, must be always numeric"),(ve&&fe&&(f?Z&&re:p?H&&ge||Z&&!ge:H&&Ae||Z&&!Ae)?P.transition().duration(ve).ease(fe):P).call(L.d3Axis);var se=P.selectAll(i.TickTextSelector).attr("style",null).styles((0,We.E_)(O)).style("visibility",null).style("fill",null!==(u=this.getAxisData(e.location).labelFontProperties.color)&&void 0!==u?u:null);if(P.selectAll("g.tick line").classed("zero-line",!1),B&&P.selectAll("g.tick").filter(function(Ie){return 0===Ie}).select("line").classed("zero-line",!0),P.classed("showLinesOnAxis",v.strokeShow).classed("hideLinesOnAxis",!v.strokeShow),P.selectAll("g.tick line:not(".concat(i.InteractivityGridlineClassSelector.selector,")")).styles((0,ya.bc)(v)),!(null===(c=this.featureSwitches)||void 0===c)&&c.onObject&&(this.convertAxisValuesToSubSelectable(e),this.renderInteractivityGridline(e)),2!==D){if(h){var Se=L;P.selectAll("g.tick").filter(function(Ie){return Se.adjustedValues[Ie]===ne.Pt}).selectAll("line").remove(),_.isEmpty(L.categoryLabelMaxWidths)?P.selectAll("g.tick").selectAll("line").remove():(i.centerHierarchyTicks(P,Se),i.styleHierarchyTicks(P,Se,v),S&&se.call(yo,{textTruncator:Le.b.getTailoredTextOrDefault,textProperties:(0,We.qk)(O),needRotate:!0,needEllipsis:!0,axisProperties:L,margin:b,rotate90:!0,firstVisibleNode:y,rotationPadding:ot,height:e.height,y1Hierarchy:!0}))}f?L.willLabelsWordBreak?i.xAxisWordBreak(se,e):se.call(yo,{textTruncator:Le.b.getTailoredTextOrDefault,textProperties:(0,We.qk)(O),needRotate:!L.willLabelsFit&&!B,needEllipsis:!0,axisProperties:L,margin:b,rotate90:rn(d)||!L.willLabelsFit&&(!!h||d.rotateXTickLabels90),firstVisibleNode:y,rotationPadding:ot,height:e.height}):(E?C.yRight:C.yLeft)>=x&&(!h||_.isEmpty(L.categoryLabelMaxWidths))&&P.selectAll(i.TickTextSelector).call(ne.oq,x-j,Le.b.svgEllipsis),i.updateTickTooltips(P,L),(f||p)&&this.axes.interactivityService&&(p?this.axes.isYAxisCategorical:!this.axes.isYAxisCategorical)&&L.categoryIdentities&&(B?this.removeFocusAbility(P):this.renderCategoricalInteractivity(e))}else v.strokeShow&&(P.selectAll(i.TickTextSelector).style("visibility","hidden"),this.removeFocusAbility(P))}else this.renderHierarchicalAxis(e)}else P.selectAll("*").remove()},i.prototype.renderHierarchicalAxis=function(e){var t,a=this,r=(t=e.axesLayout).axes,n=t.tickLabelMargins,s=this.getGraphicsElement(e),o=En(r);k.fF.assertValue(!_.isEmpty(o),"one of the axis must be hierarchical and have sub-axes");var l=r.x.isCategoryAxis;k.fF.assert(function(){return l||r.y1.isCategoryAxis},"renderHierarchicalAxis should only be called if one axis is categorical"),this.axisGraphicsContextScrollable.selectAll(".".concat(l?"x":"y",".axis > .tick")).remove(),(l?r.x:r.y1).categoryIdentities&&s.attr("tabindex",0).attr("focusable",!0).attr("aria-label",l?r.x.axisLabel:r.y1.axisLabel).attr("role","listbox").classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge());var u=l?ne.Or.bottom:"left"===this.axes.getY1AxisPosition()?ne.Or.left:ne.Or.right,c=Ki.getLeafHeight(n,u,o.length);s.selectAll(i.HierarchicalStackCS.selector).data(o).join(function(d){return d.append("g").classed(i.HierarchicalStackCS.class,!0).classed("showLinesOnAxis",e.gridlineOptions.strokeShow).classed("hideLinesOnAxis",!e.gridlineOptions.strokeShow)}).each(function(d,h,v){var y=0,f=0,p=0===h;p||(u===ne.Or.bottom?y=c+(h-1)*n.stackHeight:u===ne.Or.left?f=-c-(h-1)*n.stackHeight:u===ne.Or.right?f=c+h*n.stackHeight:k.fF.assertAnyValue(u,"AxisOrientation is not expected to be top.")),a.renderAxis((0,g.__assign)((0,g.__assign)({},e),{axisProps:d,graphicsElement:d3.select(v[h]).attr("transform",(0,Et.Iu)(f,y)),isStacked:!0,firstVisibleNode:(0,Nl.y$)(d.rootNode,d.scale.domain()[0],o.length-h),useManagedTabIndex:!!l&&e.useManagedTabIndex,height:function(){if(!l)return 999;var S=i.getAxisTickLabelFontProperties(e);return p?S.size.pt<=It?e.axesLayout.marginLimits.bottom:c:n.stackHeight}()}))}),this.categoryAxisGraphicsContext=s},i.prototype.renderCategoricalInteractivity=function(e){var t=i.getAxisProps(e),a=this.getGraphicsElement(e),r=t.categoryIdentities;this.categoryAxisGraphicsContext=a;var n=zn(t);n||(a.attr("aria-label",t.axisLabel),e.useManagedTabIndex||a.attr("tabindex",0).attr("focusable",!0).attr("role","listbox").classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()));for(var s=zn(t)?t.adjustedValues:t.values,o=zn(t)?t.categoryHierarchyPointers:[],l=_.map(t.d3Axis.tickValues(),function(y,f){var p,S,m;0===f&&!_.isEmpty(o)&&(m=y,y=_.findLastIndex(o,function(x){return!!x},y));var b=o[y];return{value:s[y],selected:!1,categoryIndex:null!==(p=b?.categoryIndex)&&void 0!==p?p:y,adjustedCategoryIndex:m,seriesIndex:null!==(S=b?.seriesIndex)&&void 0!==S?S:0,identity:r[y]?r[y]():void 0}}),u=0,c=0,d=r.length;c<d;c++){var h=l[u];if(h?.categoryIndex===c)h.value!==ne.Pt&&this.categoryDataPoints.push(h),u++;else{var v=o[c];(!n||v)&&this.categoryDataPoints.push({value:void 0,categoryIndex:v?v.categoryIndex:c,seriesIndex:v?v.seriesIndex:0,selected:!1,identity:void 0})}}a.selectAll(".tick").data(l,function(y){var f,p,S,m;return null!==(m=null!==(p=null===(f=y.adjustedCategoryIndex)||void 0===f?void 0:f.toString())&&void 0!==p?p:null===(S=y.categoryIndex)||void 0===S?void 0:S.toString())&&void 0!==m?m:y.toString()}).select("text").each(function(y){y.value!==ne.Pt&&d3.select(this).attr("tabindex",0).attr("focusable",!0).attr("role","option").attr("aria-selected",function(f){return f.selected}).attr("data-automation-type","axis-tick-text").classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()).selectAll("tspan").datum(y)})},i.prototype.removeFocusAbility=function(e){e.attr("tabindex",null).attr("focusable",null)},i.prototype.getAxisData=function(e){return 0===e?this.axesData.x:1===e?this.axesData.y:this.axesData.y2},i.getAxisProps=function(e){var t,a=e.axesLayout.axes;return null!==(t=e.axisProps)&&void 0!==t?t:0===e.location?a.x:1===e.location?a.y1:a.y2},i.prototype.getGraphicsElement=function(e){var t,a=e.location;return null!==(t=e.graphicsElement)&&void 0!==t?t:0===a?this.xAxisGraphicsContext:1===a?this.y1AxisGraphicsContext:this.y2AxisGraphicsContext},i.getAxisTickLabelFontProperties=function(e){var t=e.location,a=e.axesFontProperties;return(0===t?a.x:1===t?a.y:a.y2).tickLabels},i.prototype.getAxisRenderMode=function(e){var t=e.location,a=e.axesLayout.shouldRenderAxis;return i.getAxisProps(e)?e.shouldRenderGridLinesOnly&&e.gridlineOptions.strokeShow?2:(0===t?a.x:1===t?a.y:a.y2)?1:0:0},i.prototype.convertAxisValuesToSubSelectable=function(e){var t=0===e.location?"x-axis-values":1===e.location?"y1-axis-values":"y2-axis-values",a=this.getGraphicsElement(e).selectAll(i.TickTextSelector).filter(function(){return"visible"===d3.select(this).style("visibility")}),r=a.nodes();_.isEmpty(r)||(a.classed(U.cy,!0).attr(U.Ez,t).attr(U.CK,"Role_DisplayName_Values").attr(U.QZ,2),r.forEach(function(n){return U.O5.setDataForElement(n,{getRegionOutlines:function(){return i.getAxisValuesOutlines(r,t,e.multipleId)}})}))},i.getAxisValuesOutlines=function(e,t,a){for(var r,n=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,u=0,c=e;u<c.length;u++){var h=(r=c[u].getBoundingClientRect()).x,v=r.y,y=r.bottom,f=r.right;n=Math.min(n,h),s=Math.min(s,v),o=Math.max(o,y),l=Math.max(l,f)}return[{id:"".concat(t).concat(a??""),outline:{x:n,y:s,width:l-n,height:o-s,type:1}}]},i.prototype.renderAxes=function(e){var t,a,r,n;k.fF.assertValue(e.axesLayout,"axesLayout");var d,h,s=e.axesLayout,o=e.axesFontProperties,l=s.axes,u=!_.isEmpty(En(l));this.categoryDataPoints=[],this.categoryAxisGraphicsContext=void 0,k.fF.assert(function(){return null!=l.x},"axes.x must be defined."),this.renderAxis((0,g.__assign)((0,g.__assign)({},e),{location:0,height:(d=o.x.tickLabels.size.pt<=It,h=d?s.marginLimits.bottom:s.margin.bottom,d||null==s.axisLabels.x?h:h-(Le.b.estimateSvgTextHeight((0,We.qk)(o.x.tickLabels))+Ki.XAxisLabelPadding)),gridlineOptions:(0,g.__assign)((0,g.__assign)({},null===(t=this.axesData)||void 0===t?void 0:t.x.gridline),{strokeShow:(!(0,ne._9)(l.x.scale)||l.x.isCategoryAxis&&u)&&(null===(a=this.axesData)||void 0===a?void 0:a.x.gridline.strokeShow)})}));var c=(0,g.__assign)((0,g.__assign)({},null===(r=this.axesData)||void 0===r?void 0:r.y.gridline),{strokeShow:(!(0,ne._9)(l.y1.scale)||l.y1.isCategoryAxis&&u)&&(null===(n=this.axesData)||void 0===n?void 0:n.y.gridline.strokeShow)});if(this.renderAxis((0,g.__assign)((0,g.__assign)({},e),{location:1,gridlineOptions:c})),this.renderAxis((0,g.__assign)((0,g.__assign)({},e),{location:2,gridlineOptions:c})),this.renderAxesTitles(e),this.valueGridlines=this.axisGraphicsContext.selectAll("g.tick line"),this.translateAxes(s),this.axes.interactivityService&&this.categoryAxisGraphicsContext)return{dataPoints:this.categoryDataPoints,behaviorOptions:{root:this.categoryAxisGraphicsContext,ticks:this.categoryAxisGraphicsContext.selectAll(".tick")},navigationOptions:{helper:this,navigationStrategy:u?Y.jN.SeriesFirst:Y.jN.CategoryOnly},animateLabels:!1,labelDataPointGroups:[],labelDataPoints:[],labelOrientation:void 0,labelsAreNumeric:void 0,labelDataPointSeriesGroups:[]}},i.prototype.renderInteractivityGridline=function(e){var t=e.location,a=e.multipleId,r=e.gridlineOptions,n=this.getGraphicsElement(e),s=0===t?"vertical-gridlines":1===t?"horizontal-gridlines":"secondary-horizontal-gridlines",o="vertical-gridlines"!==s,l=n.selectAll("g.tick line:not(".concat(i.InteractivityGridlineClassSelector.selector,")"));l.each(function(){var u,c=d3.select(this.parentNode),d=d3.select(this),h=d.node(),v=(u=h.getBoundingClientRect()).height,f=r.strokeShow&&(o&&u.width>0||!o&&v>0);c.selectAll(i.InteractivityGridlineClassSelector.selector).filter(function(p){return p===h}).data(function(){return f?[h]:[]}).join("line").attr("class",i.InteractivityGridlineClassSelector.class).classed(U.cy,!0).style("stroke-width",i.interactivityGridlinePadding).style("stroke-linejoin",No.t.round).style("stroke-dasharray","none").attrs({x1:d.attr("x1"),y1:d.attr("y1"),x2:d.attr("x2"),y2:d.attr("y2")}).attr(U.Ez,s).attr(U.CK,o?"Visual_Gridline_Horizontal":"Visual_Gridline_Vertical").attr(U.QZ,3).each(function(){U.O5.setDataForElement(this,{getRegionOutlines:function(){var S=l.nodes();return i.getGridlinesOutlines(S,s,a)}})})})},i.prototype.getFirstElement=function(){var e;return{element:null===(e=this.categoryAxisGraphicsContext)||void 0===e?void 0:e.selectAll(i.TickTextSelector).node()}},i.prototype.getDataPointsAtSeries=function(e){return _.filter(this.categoryDataPoints,function(t){return t.seriesIndex===e})},i.prototype.getNextDataPoint=function(e,t,a){var r,n;if(_.isEmpty(this.categoryDataPoints))return{element:this.categoryAxisGraphicsContext.select(i.TickTextSelector).node(),targetCategoryIndex:0};switch(a){case Y.x0.PreviousCategory:case Y.x0.NextCategory:var s=a===Y.x0.PreviousCategory?-1:1,o=this.getDataPointsAtSeries(t),l=s+_.findIndex(o,function(d){return d.categoryIndex===e});l>=o.length||l<0?(r=this.rollToNextSeries(t,a),e=r[0],t=r[1]):e=o[l].categoryIndex;break;case Y.x0.PreviousSeries:case Y.x0.NextSeries:s=a===Y.x0.PreviousSeries?-1:1,o=_.filter(this.categoryDataPoints,function(v){return v.categoryIndex===e});var u=s+_.findIndex(o,function(v){return v.seriesIndex===t});u>=o.length||u<0?(n=this.findNearestSeries(e,t,a),e=n[0],t=n[1]):t=o[u].seriesIndex}return{element:this.categoryAxisGraphicsContext.selectAll(i.TickTextSelector).filter(function(d){return(!d.adjustedCategoryIndex||d.adjustedCategoryIndex===d.categoryIndex)&&d.categoryIndex===e&&d.seriesIndex===t}).node(),targetCategoryIndex:e}},i.getGridlinesOutlines=function(e,t,a){var n={type:0,outlines:e.map(function(s){var o=s.getBoundingClientRect(),l=o.x,u=o.y;return{points:[{x:l,y:u},{x:l+o.width,y:u+o.height}],type:2}})};return[{id:a?"".concat(t).concat(a):t,outline:n}]},i.prototype.rollToNextSeries=function(e,t){k.fF.assert(function(){return t===Y.x0.PreviousCategory||t===Y.x0.NextCategory},"expected a direction having to do with category");var a=t===Y.x0.PreviousCategory?-1:1,r=t===Y.x0.PreviousCategory?_.last:_.first,n=_.maxBy(this.categoryDataPoints,function(l){return l.seriesIndex}).seriesIndex+1;return(e+=a)>=n?e=0:e<0&&(e=n-1),[r(this.getDataPointsAtSeries(e)).categoryIndex,e]},i.prototype.findNearestSeries=function(e,t,a){k.fF.assert(function(){return a===Y.x0.PreviousSeries||a===Y.x0.NextSeries},"expected a direction having to do with series");var r=_.maxBy(this.categoryDataPoints,function(l){return l.seriesIndex}).seriesIndex+1;(t+=a===Y.x0.PreviousSeries?-1:1)>=r&&(t=0),t<0&&(t=r-1);var s=this.getDataPointsAtSeries(t),o=_.sortedLastIndexBy(s,{categoryIndex:e},function(l){return l.categoryIndex})-1;return k.fF.assertValue(e=s[o].categoryIndex,"sortedLastIndexBy failed"),[e,t]},i.prototype.renderAxesTitles=function(e){var t,a=this;this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();var r=e.axesFontProperties,n=(t=e.axesLayout).axisLabels,s=t.viewport,o=t.margin,l=t.axes;if(k.fF.assertValue(s,"viewport"),k.fF.assertValue(n,"axisLabels"),(null!=n.x||null!=n.y||null!=n.y2)&&!e.shouldRenderGridLinesOnly){var c=s.width-(o.left+o.right),d=s.height-o.top,h=this.axes.shouldShowY1OnRight(),v=function(f){var p,S,m,b,x,C,A,T,P=0===f,D=1===f,L=2===f,O=P?n.x:D?n.y:n.y2,B=null===(p=P?r.x:D?r.y:r.y2)||void 0===p?void 0:p.title;if(null!=O&&B){var E,j;if(null!==(S=a.featureSwitches)&&void 0!==S&&S.onObject){var H=L?N.p.valueAxis.secTitleText:P&&l.x.isCategoryAxis||D&&null!==(m=l.y1)&&void 0!==m&&m.isCategoryAxis?N.p.categoryAxis.titleText:N.p.valueAxis.titleText;(j=P?(0,Pt.s4)(H,O):(0,Pt.Mw)(H,O))&&!O&&e.showTitlePlaceholders&&(E=!0,O=a.settings.hostServices.getLocalizedString("Format_AddAxisTitle"))}if(O||!L){var Z=(0,We.qk)(B,O),ve=Le.b.estimateSvgTextBaselineDelta(Z),fe=Le.b.estimateSvgTextHeight(Z),ge=c+o.right-fe-Ki.YAxisLabelPadding+3,Ae=-(o.left+3);a.axisGraphicsContext.append("text").attr("class",P?"xAxisLabel":"yAxisLabel").attr("transform",P?null:"rotate(-90)").attr("dy",P?null:"1em").attr("x",P?c/2:-(d-o.bottom)/2).attr("y",P?d-ve:D?h?ge:Ae:h?Ae:ge).style("text-anchor","middle").styles((0,We.E_)(B)).style("fill",null!==(T=null===(A=P?null===(b=a.axesData)||void 0===b?void 0:b.x:D?null===(x=a.axesData)||void 0===x?void 0:x.y:null===(C=a.axesData)||void 0===C?void 0:C.y2)||void 0===A?void 0:A.titleFontProperties.color)&&void 0!==T?T:null).text(O).call(ne.oq,P?c:d-o.bottom,function(Pe,se){return Le.b.svgEllipsis(Pe,se,Z)}).call(Un.Q,[O]).filter(function(){var Pe;return null===(Pe=a.featureSwitches)||void 0===Pe?void 0:Pe.onObject}).classed(U.cy,!0).classed(U.Qh.class,E).attr(U.Ez,P?"x-axis-title":D?"y1-axis-title":"y2-axis-title").attr(U.CK,"Visual_Axis_Title").attr(U.QZ,1).filter(function(){return!!j}).attr(U.kv,JSON.stringify(j))}}};v(0),v(1),v(2)}},i.prototype.translateAxes=function(e){var t,a=this,r=e.margin,n=(t=Ro(e)).width,s=t.height,o=this.axesData.showsSeriesLabels()?(0,pi.lr)(this.axesData.seriesLabelSettings,n):0,l=this.axesData.seriesLabelSettings.position===Hi.M.right,u=l?r.left:r.left+o,c=l?0:o,d=this.axes.shouldShowY1OnRight();this.xAxisGraphicsContext.attr("transform",(0,Et.Iu)(0,s)),this.y1AxisGraphicsContext.attr("transform",(0,Et.Iu)(d?n:0,0)),this.y2AxisGraphicsContext.attr("transform",(0,Et.Iu)(d?0:n,0)),this.svgScrollable.attrs({x:0,width:e.viewport.width,height:e.viewport.height}),this.axisGraphicsContext.attr("transform",(0,Et.Iu)(r.left,r.top));var h=function(f){a.axisGraphicsContextScrollable.attr("transform",(0,Et.Iu)(f,r.top)),a.labelRegion.attr("transform",(0,Et.Iu)(f,r.top)),a.labelContainerRegion.attr("transform",(0,Et.Iu)(f,r.top)),a.labelBackgroundRegion.attr("transform",(0,Et.Iu)(f,r.top)),a.labelSeriesRegion.attr("transform",(0,Et.Iu)(f,r.top)),a.labelSeriesBackgroundRegion.attr("transform",(0,Et.Iu)(f,r.top))};h(u),e.isXScrollBarVisible?(this.svgScrollable.attrs({x:r.left,width:n}),h(c)):e.isYScrollBarVisible&&this.svgScrollable.attr("height",s+r.top),this.valueGridlines.attr("transform","translate(".concat(l?d?-o:0:d?0:o,")"))},i.centerHierarchyTicks=function(e,t){e.selectAll("g.tick").filter(function(a){return t.adjustedValues[a]!==ne.Pt}).each(function(a){var r=d3.select(this),n=r.attr("transform"),s=(0,Et.nd)(n);s&&+s.x>0&&r.attr("transform",(0,Et.Iu)(+s.x+t.categoryLabelMaxWidths[a]/2-t.categoryThickness/2+ot,+s.y)),s&&+s.y>0&&r.attr("transform",(0,Et.Iu)(+s.x,+s.y+t.categoryLabelMaxWidths[a]/2-t.categoryThickness/2+ot))})},i.xAxisWordBreak=function(e,t){var a=null;e.style("text-anchor","middle").attrs({dx:null,dy:null,transform:"rotate(0)",y:function(){if(null==a){var n=Le.b.getSvgMeasurementProperties(this),s=Le.b.estimateSvgTextHeight(n),o=Le.b.estimateSvgTextBaselineDelta(n);a=10+s-o}return"".concat(a,"px")}}).each(function(r){(0,Cn.lM)(this,xo(i.getAxisProps(t),r),t.height)})},i.orient=function(e,t,a){return delete e.node().__axis,pr(t.scale(),ne.Or[a]).tickArguments(t.tickArguments()).tickValues(t.tickValues()).tickFormat(t.tickFormat()).tickSize(t.tickSize()).tickSizeInner(t.tickSizeInner()).tickSizeOuter(t.tickSizeOuter()).tickPadding(t.tickPadding())},i.styleHierarchyTicks=function(e,t,a){e.selectAll("g.tick").filter(function(r){return t.adjustedValues[r]!==ne.Pt}).selectAll("line").data(function(r){return t.lineStyleInfo[r]}).join(function(r){return r.append("line")}).attrs({x1:function(n){return n.x1},y1:function(n){return n.y1},x2:function(n){return n.x2},y2:function(n){return n.y2}}).styles((0,ya.bc)(a))},i.AxisGraphicsContext=(0,Me.CH)("axisGraphicsContext"),i.HierarchicalStackCS=(0,Me.CH)("stack"),i.InteractivityGridlineClassSelector=(0,Me.CH)("interactivity-gridline"),i.TickTextSelector="g.tick > text",i.interactivityGridlinePadding=10,i.TickPaddingRotatedX=5,i.Y2TickSize=-6,i}(),lu=function(){function i(){this.navigationLayers=[],this.currentNavigationLayerIndex=0}return i.prototype.updateScrollCallbacks=function(e){this.scrollCallbacks=e},i.prototype.clearNavigationLayers=function(){this.navigationLayers=[]},i.prototype.addNavigationLayer=function(e){this.navigationLayers.push(e)},i.prototype.getFirstElement=function(){this.currentNavigationLayerIndex=0;var t,e=this.navigationLayers[this.currentNavigationLayerIndex].getFirstElement();return e&&(t=e.element?e.element:this.getNextDataPoint(e.targetCategoryIndex,e.targetSeriesIndex,Y.x0.NextSeries).element),{element:t}},i.prototype.getNextDataPoint=function(e,t,a){var r=this.composeLayerPointInfo(e,t);return this.getNextDataPointWithStartData(r,a,r)},i.prototype.getNextDataPointWithStartData=function(e,t,a){var r=this,n=e.categoryIndex,s=e.seriesIndex,o=this.navigationLayers[this.currentNavigationLayerIndex],l=o.getNextDataPoint(n,s,t),u=l.targetCategoryIndex,c=t===Y.x0.NextSeries||t===Y.x0.NextCategory,d=this.navigationLayers.length;if(d>1&&l.targetCategoryIndex!==n){var h=n,v=0,y=c?1:-1;do{switch(t){case Y.x0.NextSeries:case Y.x0.PreviousSeries:this.currentNavigationLayerIndex+=y,this.layerRollOverCheck(this.currentNavigationLayerIndex,d)?(this.currentNavigationLayerIndex=this.currentNavigationLayerIndex<0?d-1:0,l=(o=this.navigationLayers[this.currentNavigationLayerIndex]).getFirstElement(u,!c),_.isFinite(l.targetCategoryIndex)&&(u=l.targetCategoryIndex),h=u,v++):l=(o=this.navigationLayers[this.currentNavigationLayerIndex]).getFirstElement(h,!c);break;case Y.x0.NextCategory:case Y.x0.PreviousCategory:v=d;break;default:k.fF.assertNever(t)}}while(!l.element&&v<d&&(!this.layerRollOverCheck(this.currentNavigationLayerIndex+y,d)||v<d-1))}if(!l.element&&null!=u&&this.shouldScroll(u)){this.getPendingFocusElement=function(){if(r.getPendingFocusElement=void 0,t===Y.x0.NextSeries?r.currentNavigationLayerIndex=0:t===Y.x0.PreviousSeries&&(r.currentNavigationLayerIndex=d-1),!(l=(o=r.navigationLayers[r.currentNavigationLayerIndex]).getNextDataPoint(n,s,t)).element){var S=r.currentNavigationLayerIndex;do{r.currentNavigationLayerIndex++,r.currentNavigationLayerIndex>=r.navigationLayers.length&&(r.currentNavigationLayerIndex=0),l=r.navigationLayers[r.currentNavigationLayerIndex].getNextDataPoint(n,s,t)}while(!l.element&&r.currentNavigationLayerIndex!==S)}if(r.shouldFindNextPoint(l,e,a,c)){var m=r.composeLayerPointInfo(l.targetCategoryIndex,l.targetSeriesIndex);return r.getNextDataPointWithStartData(m,t,a).element}return l.element};var f=u-n;f<0?this.scrollCallbacks.scrollTo(u):this.scrollCallbacks.scrollBy(f)}else if(this.shouldFindNextPoint(l,e,a,c)){var p=this.composeLayerPointInfo(l.targetCategoryIndex,l.targetSeriesIndex);return this.getNextDataPointWithStartData(p,t,a)}return l},i.prototype.shouldScroll=function(e){return!!this.scrollCallbacks&&this.scrollCallbacks.shouldScrollTo(e)},i.prototype.layerRollOverCheck=function(e,t){return e>=t||e<0},i.prototype.composeLayerPointInfo=function(e,t){return{categoryIndex:e,seriesIndex:t,layerIndex:this.currentNavigationLayerIndex}},i.prototype.shouldFindNextPoint=function(e,t,a,r){if((!e.element||e.noShape)&&null!==e.targetCategoryIndex&&null!==e.targetSeriesIndex){var s=this.composeLayerPointInfo(e.targetCategoryIndex,e.targetSeriesIndex);switch(this.compareLayerPointInfo(a,s,r)){case 1:if(this.compareLayerPointInfo(t,s,r)>=0&&this.compareLayerPointInfo(a,t,r)>0)return!1;break;case 0:return!1;case-1:if(this.compareLayerPointInfo(a,t,r)>0||this.compareLayerPointInfo(t,s,r)>=0)return!1;break;default:k.fF.assertFail("Unexpected result from compareLayerPointInfo")}return!0}return!1},i.prototype.compareLayerPointInfo=function(e,t,a){return e.categoryIndex>t.categoryIndex?a?1:-1:e.categoryIndex<t.categoryIndex?a?-1:1:e.seriesIndex>t.seriesIndex?a?1:-1:e.seriesIndex<t.seriesIndex?a?-1:1:e.layerIndex>t.layerIndex?a?1:-1:e.layerIndex<t.layerIndex?a?-1:1:0},i}(),uu=R(38078),ks=function(){function i(e,t){this.options=e,this.scrollbar=t}return i.filterDataToViewport=function(e){var t,a=(t=e||{}).scrollScale,r=t.mainAxisScale,n=t.layers,s=t.axesLayout;if(e.scrollScale){var o=_t(a,e.extent.start),l=o+e.visibleCategoryCount,c=a.domain().slice(o,l);if(!_.isEqual(c,r.domain())){if(c&&c.length>0){for(var d=0,h=n;d<h.length;d++)h[d].setFilteredData(c[0],c[c.length-1]+1);r.domain(c);var y=s.axes,f=s.isXScrollBarVisible?y.x:y.y1;f.d3Axis.scale(r),f.scale(r),f.d3Axis.ticks(c.length),f.d3Axis.tickValues(c);var p=ou.getTickFormatter(f.d3Axis);f.values=_.map(c,function(A){return p(A)});var S=En(y);if(!_.isEmpty(S))for(var m=y.x.isCategoryAxis?ne.Or.bottom:s.axes.y1.orientation,b=Ki.getLeafHeight(e.axesLayout.tickLabelMargins,m,S.length),x=function(T){var P=S[T],D=Ct(P.scale),L=P.values,O=i.setLabelsAtEdges(c,L);if(P.d3Axis.ticks(c.length).tickValues(c).tickFormat(function(Pe){var se=L[O[c.indexOf(Pe)]];return se===ne.Pt?"":"".concat(se)}),0===T)return"continue";for(var H,B=[],E=[],j=[],Z=function(se){null!=H&&(B[H]=Ki.getMaxCategoryWidth(se,D),E[H]=Ki.getHierarchyLineStyleInfo({levelIndex:T,stackHeight:s.tickLabelMargins.stackHeight,leafHeight:b,categorySpanCount:se,categoryWidth:D,orientation:m}))},ve=0;ve<O.length;ve++){var fe=c[ve],re=O[ve];L[re]!==ne.Pt?(Z(fe-H),j[fe]=L[re],H=fe):j[fe]=ne.Pt}null!=H&&Z(c[O.length-1]-H+1),P.categoryLabelMaxWidths=B,P.lineStyleInfo=E,P.adjustedValues=j},C=0;C<S.length;C++)x(C)}return{startIndex:o,endIndex:l-1}}}},i.prototype.destroy=function(){this.scrollbar.remove()},i.prototype.render=function(e,t,a,r,n,s,o){var u,c,d,y,f,p,S,m,b,x,C,l=this,h=e.axesLayout,v=e.layers;if(this.axisScale=null,r||rn(h))if(this.options.axes.isYAxisCategorical){this.axisScale=h.axes.y1.scale,y=h.viewport.width,f=h.margin.top,x=h.axes.y1.innerPaddingRatio;var L=(m=h.axes.y1.categoryThickness)*(b=h.axes.y1.outerPaddingRatio);C=h.plotArea.height,S=Math.max(1,(0,Lt.Uy)((C-2*L)/m)),p=C}else{this.axisScale=h.axes.x.scale,y=h.margin.left;var A=null===(u=this.options.cartesianOptions)||void 0===u?void 0:u.chartType,T=!xa(A)||n,P=Ds(v,A);if(P.position===Hi.M.left&&T){var D=Ro(h).width;y+=(0,pi.lr)(P,D)}f=h.viewport.height,x=h.axes.x.innerPaddingRatio,L=(m=h.axes.x.categoryThickness)*(b=h.axes.x.outerPaddingRatio),C=h.plotArea.width,S=Math.max(1,(0,Lt.Uy)((C-2*L)/m)),p=C}if(!rn(h))return r&&(r.resetViewport(S),r.shouldLoadMoreData()&&r.loadMoreData()),this.scrollbar.remove(),void t((0,g.__assign)((0,g.__assign)({},e),{cartesianOptions:this.options.cartesianOptions}));var O=this.axisScale.copy();O.range([0,p]).paddingInner(.1).paddingOuter(0);var B=O(S-1)+O.bandwidth();this.scrollHandler=new Rd({visibleScale:this.axisScale,fullScale:O,onScroll:function(H){var Z=O(H);l.scrollbar.setExtent({start:Z,end:null}),l.scrollbar.refreshExtentAndVisual()}}),this.axisScale.range([0,C]).paddingInner(x).paddingOuter(b),this.scrollbar.setOrientation(h.isXScrollBarVisible),this.scrollbar.setScale(O,this.options.suppressBrush),this.scrollbar.scrollBarLength=p,this.scrollbar.setExtentLength(B),a||this.scrollbar.setExtent({start:0,end:null});var E={axesLayout:h,layers:v,categoryLoadMoreDataHandler:r,mainAxisScale:this.axisScale,renderDelegate:t,scrollScale:O,visibleCategoryCount:S,cartesianOptions:this.options.cartesianOptions,extent:this.scrollbar.getExtent()};this.scrollbar.render(y,f,function(){i.renderVisual((0,g.__assign)((0,g.__assign)({},E),{suppressAnimations:!0,extent:l.scrollbar.getExtent()})),o?.addDirectEditPlaceholderOutlines(),o?.refreshOutlines()},s,o),a&&r?this.scrollTo(null!==(d=null===(c=r.viewportDataRange)||void 0===c?void 0:c.startIndex)&&void 0!==d?d:0):i.renderVisual((0,g.__assign)((0,g.__assign)({},E),{extent:this.scrollbar.getExtent()}))},i.prototype.scrollDelta=function(e){this.scrollHandler.scrollDelta(e)},i.prototype.scrollTo=function(e){this.scrollHandler.scrollTo(e)},i.prototype.shouldScrollTo=function(e){if(!this.scrollHandler)return!1;var t=this.axisScale.domain();return!_.isEmpty(t)&&(e<t[0]||e>t[t.length-1])},i.prototype.setExtent=function(e){this.scrollbar.setExtent(e),this.scrollbar.refreshExtentAndVisual()},i.prototype.scrollBy=function(e){var t=this.axisScale.domain();_.isEmpty(t)||this.scrollHandler.scrollTo(t[0]+e)},i.prototype.clearRenderingTimeout=function(){this.scrollbar&&this.scrollbar.clearRenderingTimeout()},i.setLabelsAtEdges=function(e,t){if(e.length<=1||t[e[0]]!==ne.Pt)return e;var a=e[0],r=e.slice();if(a<t.length&&a>=0){for(;t[a]===ne.Pt&&a>=0;a--);r[0]=a}return r},i.renderVisual=function(e){var t=i.filterDataToViewport(e);if(t){if(e.categoryLoadMoreDataHandler){var a=e.categoryLoadMoreDataHandler;a.viewportDataRange=t,a.shouldLoadMoreData()&&a.loadMoreData()}e.renderDelegate(e)}},i.ScrollbarWidth=10,i}(),Rd=function(){function i(e){k.fF.assertValue(e,"options must be set"),k.fF.assertValue(e.visibleScale,"options.visibleScale must be set"),k.fF.assertValue(e.fullScale,"options.fullScale must be set"),k.fF.assertValue(e.onScroll,"options.onScroll must be set"),this.visibleScale=e.visibleScale,this.fullScale=e.fullScale,this.onScroll=e.onScroll;var t=uu.b$.valueOrDefault(e.timeout,i.defaultTimeoutMs);this.extendScrollTimeout=_.debounce(this.onTimeout,t),this.totalScrollDistance=0}return i.prototype.scrollDelta=function(e){if(!_.isEmpty(this.visibleScale.domain())){this.totalScrollDistance<0&&e>0||this.totalScrollDistance>0&&e<0?this.totalScrollDistance=e:this.totalScrollDistance+=e;var t=i.getStepSize(this.visibleScale);if(Math.abs(this.totalScrollDistance)>=t){this.extendScrollTimeout&&this.extendScrollTimeout.cancel();var a=this.getNewStartIndex(this.totalScrollDistance);this.scrollTo(a),this.totalScrollDistance=0}else this.extendScrollTimeout()}},i.prototype.scrollTo=function(e){var t=this.clampIndex(e);this.onScroll(t)},i.getStepSize=function(e){var t=_.map(e.domain(),e);if(t.length>1)return t[1]-t[0];var a=e.range();return a[1]-a[0]},i.prototype.getNewStartIndex=function(e){var t=e>=0;e=t?e:-e;var a=this.visibleScale,r=_.map(a.domain(),a),n=a.domain(),s=n[0],l=r[0]+e;return(t?1:-1)*(l>a.range()[1]?n.length:_t(a,l)-s)+s},i.prototype.clampIndex=function(e){var t=this.fullScale.domain(),a=_.head(t),r=_.last(t);return Math.max(a,Math.min(r,e))},i.prototype.onTimeout=function(){this.totalScrollDistance=0},i.defaultTimeoutMs=1e3,i}(),cu=function(){function i(e){this.settings=e,this.svgAxes=new ou(e),this.navigationHelper=new lu}return i.prototype.destroy=function(){var e,t;null===(e=this.scrollableAxes)||void 0===e||e.destroy(),null===(t=this.svgScrollbar)||void 0===t||t.remove(),this.scrollableAxes=void 0,this.svgScrollbar=void 0},i.prototype.update=function(e,t){var a;null===(a=this.svgScrollbar)||void 0===a||a.updateScrollbarOptions(t),this.svgAxes.update(e)},i.prototype.render=function(e,t,a,r,n,s,o,l,u){var c=this,d=this.options=o,v=d.trimOrdinalDataOnOverflow,y=d.categoryLoadMoreDataHandler,f=d.suppressAnimations,p=d.isHierarchicalAxis,S=d.formatMode,m=d.isSelected,b=d.viewMode,x=d.subSelectionHelper,C=d.preserveScrollPosition,A=d.navigationScrollCallbacks,T=this.options.multipleId||this.settings.multipleId;if(!u&&((u=Io({axesData:e,rendererSettings:this.settings,referenceLines:r,layers:a,viewport:n,playAxesRect:d.playAxesRect,trimOrdinalDataOnOverflow:v,axisZoom:t,rotateXTickLabels90:void 0})).plotArea.width<1||u.plotArea.height<1))return u;if(!this.settings.suppressBrush||!(n.height<1||n.width<1)){a.forEach(function(O,B){var E,j;0!==B&&u.axes.y2?j=2:(j=1,1===a.length&&u.axes.y2&&(j|=2)),null===(E=O.setAxesLayout)||void 0===E||E.call(O,{layout:u,trimOrdinalDataOnOverflow:v,axisType:j})}),t?.render({axesLayout:u,axesData:e,showTitlePlaceholders:m&&1===b});var P=u.axes.x.isCategoryAxis?u.axes.x:u.axes.y1;y?.setScale(P.scale);var D=function(B){return c.renderAxes((0,g.__assign)((0,g.__assign)({},B),{isHierarchicalAxis:p}),o.axesAnimationOptions,nu(e),s,l,m&&1===b,T)};k.fF.assert(function(){return!c.svgScrollbar&&!c.scrollableAxes||!(!c.svgScrollbar||!c.scrollableAxes)},"Expect `svgScrollbar` and `scrollableAxes` to have the same state");var L={axesLayout:u,layers:a,suppressAnimations:f,isHierarchicalAxis:p};return o.supportsScrolling?(this.svgScrollbar||(this.svgScrollbar=new Vd.x({scrollbarWidth:ks.ScrollbarWidth,onExtentUpdate:this.settings.onExtentUpdate}),this.scrollableAxes=new ks(this.settings,this.svgScrollbar),this.svgScrollbar.init(this.settings.container)),this.scrollableAxes.render(L,D,C,y,e.hasY2Role,S,x)):(this.destroy(),D((0,g.__assign)((0,g.__assign)({},L),{cartesianOptions:this.settings.cartesianOptions}))),this.navigationHelper.updateScrollCallbacks(o.supportsScrolling?A:void 0),this.eventsBoundForAxesLayout!==u&&(this.bindScrollWheelEvents(u,this.settings.container,S,x),this.bindTouchEvents(u,this.settings.container,S,x),this.eventsBoundForAxesLayout=u),u}},i.prototype.renderAxes=function(e,t,a,r,n,s,o){var l,u,c=this.svgAxes.renderAxes((0,g.__assign)((0,g.__assign)({},e),{axesAnimationOptions:t,axesFontProperties:a,shouldRenderGridLinesOnly:this.options.shouldRenderGridLinesOnly,useManagedTabIndex:n,showTitlePlaceholders:s,multipleId:o}));if(c?.navigationOptions&&this.settings.behavior){this.navigationHelper.clearNavigationLayers(),this.navigationHelper.addNavigationLayer(c.navigationOptions.helper);var d={isAxis:!0,navigationOptions:{helper:this.navigationHelper,navigationStrategy:c.navigationOptions.navigationStrategy,focusElement:null===(u=(l=this.navigationHelper).getPendingFocusElement)||void 0===u?void 0:u.call(l)},pointSourceKey:"cartesian-axis".concat(this.settings.multipleId||""),isHierarchicalAxis:e.isHierarchicalAxis};this.settings.interactivityService.bind(c.dataPoints,this.settings.behavior,c.behaviorOptions,d),this.settings.behavior.renderSelection(this.settings.interactivityService.hasSelection())}r(e)},i.prototype.getLayerContainer=function(){return this.svgAxes.getScrollableRegion()},i.prototype.getDataLabelContainers=function(){return this.svgAxes.getLabelsContainers()},i.prototype.getLabelContainerRegion=function(){return this.svgAxes.getLabelContainerRegion()},i.prototype.getSeriesLabelContainers=function(){return this.svgAxes.getSeriesLabelsContainers()},i.prototype.setExtent=function(e){var t;null===(t=this.scrollableAxes)||void 0===t||t.setExtent(e)},i.prototype.scrollDelta=function(e){var t;null===(t=this.scrollableAxes)||void 0===t||t.scrollDelta(e)},i.prototype.scrollTo=function(e){var t;null===(t=this.scrollableAxes)||void 0===t||t.scrollTo(e)},i.prototype.shouldScrollTo=function(e){var t;return null===(t=this.scrollableAxes)||void 0===t?void 0:t.shouldScrollTo(e)},i.prototype.scrollBy=function(e){var t;null===(t=this.scrollableAxes)||void 0===t||t.scrollBy(e)},i.prototype.clearRenderingTimeout=function(){var e;null===(e=this.scrollableAxes)||void 0===e||e.clearRenderingTimeout()},i.prototype.bindTouchEvents=function(e,t,a,r){var n=this,s={x:0,y:0};this.settings.eventManager.on(t.node(),"touchstart",function(){if(0===n.options.viewMode&&rn(e)){var l=d3.event.changedTouches[0];s.x=l.pageX,s.y=l.pageY}}),this.settings.eventManager.on(t.node(),"touchmove",function(){var o,l,u=null===(o=n.settings.hostServices)||void 0===o?void 0:o.tooltips();if(0===n.options.viewMode&&rn(e)&&!(u&&u.isTouchScreenOptimizedEnabled()&&u.visible())){a&&r?.onVisualScroll(),n.settings.tooltipService.hide();var c=d3.event,d=c.changedTouches[0],y=e.isXScrollBarVisible?s.x-d.pageX:s.y-d.pageY;n.settings.onScroll?n.settings.onScroll(y):null===(l=n.scrollableAxes)||void 0===l||l.scrollDelta(y),s.x=d.pageX,s.y=d.pageY,c.preventDefault()}})},i.prototype.bindScrollWheelEvents=function(e,t,a,r){var n=this;this.settings.eventManager.on(t.node(),"wheel",function(){var s;if(rn(e)){a&&r?.onVisualScroll(),n.settings.tooltipService.hide();var o=d3.event,l=o.deltaX,u=o.deltaY,c=Math.abs(l)>Math.abs(u)?l:u;if(n.settings.onScroll){if(n.options.isSmallMultiples&&!o.shiftKey)return;n.settings.onScroll(c)}else null===(s=n.scrollableAxes)||void 0===s||s.scrollDelta(c);o.preventDefault()}})},i}(),Id=R(58698),zo=R(11745),Eo=R(63972),Ms=R(20624),it=R(5381),zd=function(){function i(e,t,a,r,n,s,o,l,u,c,d){var h;this.cartesianOptions=e,this.visibilityHelper=t,this.chartAreaSvg=a,this.axesRenderer=r,this.element=n,this.hostServices=s,this.behavior=o,this.interactivityService=l,this.clearCatcher=u,this.initialViewportScale=d,this.dataPointNavigationHelper=new lu,null!==(h=this.cartesianOptions)&&void 0!==h&&h.dataPointLassoSelect&&!c&&(this.plotLassoManager=new zo.oW(!1),this.plotLassoManager.init([r.getLayerContainer(),u],a,this.hostServices,this.featureSwitches),this.lassoSelectionBehavior=new zo.lk(this.behavior),this.plotLassoManager.behaviors.push(this.lassoSelectionBehavior),this.plotLassoManager.setUiScale(this.initialViewportScale))}return Object.defineProperty(i.prototype,"featureSwitches",{get:function(){var t;return(null===(t=this.cartesianOptions)||void 0===t?void 0:t.featureSwitches)||{}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"chartType",{get:function(){var t;return null===(t=this.cartesianOptions)||void 0===t?void 0:t.chartType},enumerable:!1,configurable:!0}),i.prototype.attachToElement=function(e,t){this.element=e;var a=this.chartAreaSvg;a.attrs({width:t.width,height:t.height}),a.node().parentElement!==e.get(0)&&e.append(a.node())},i.prototype.render=function(e,t,a,r,n){var s;this.options=r,this.renderedPlotArea=a,this.cartesianData=t,this.layers=e,null===(s=this.plotLassoManager)||void 0===s||s.setUiScale(n),this.cartesianData&&(this.cartesianData.showIcon?this.visibilityHelper.updateVisibility({showIcon:this.cartesianData.showIcon,viewport:this.options.viewport}):(this.visibilityHelper.updateVisibility({showIcon:this.cartesianData.showIcon}),this.renderCartesianChart()))},i.prototype.destroy=function(){this.axesRenderer.destroy(),this.chartAreaSvg.html(null),(0,Re.q5)(this.element)},i.prototype.renderCartesianChart=function(){var e=this,t=this.options,a=!this.renderedPlotArea||this.renderedPlotArea.height!==t.chartAreaViewport.height||this.renderedPlotArea.width!==t.chartAreaViewport.width;this.renderedPlotArea=t.chartAreaViewport,this.axesRenderer.render(this.cartesianData.axesData,this.options.axisZoom,this.layers,this.cartesianData.referenceLines,this.options.chartAreaViewport,function(s){return e.renderPlotArea((0,g.__assign)((0,g.__assign)({},s),{resizeMode:t.resizeMode}))},(0,g.__assign)((0,g.__assign)({},t),{suppressAnimations:t.suppressAnimations||a}),void 0,this.options.axesLayout),this.dataPointNavigationHelper.updateScrollCallbacks(t.supportsScrolling?t.navigationScrollCallbacks:void 0)},i.prototype.getPlotAreaRect=function(e){return{left:e.margin.left+this.options.chartAreaMargins.left,top:e.margin.top+this.options.chartAreaMargins.top,width:e.plotArea.width,height:e.plotArea.height}},i.prototype.renderPlotArea=function(e){var t=e.axesLayout;(0,Re.Re)(this.options.background,this.element,this.getPlotAreaRect(t)),(0,he.xw)({graphicContext:this.axesRenderer.getLayerContainer(),axes:t.axes,viewport:t.plotArea,referenceLines:this.cartesianData.referenceLines}),this.renderLayers(e),(0,q.Zb)(this.cartesianData.trendLines,this.axesRenderer.getLayerContainer(),t.axes,t.plotArea,this.featureSwitches.onObject)},i.prototype.getReferenceLineLabels=function(e,t){return(0,he.TY)({axes:e,viewport:t,referenceLines:this.cartesianData.referenceLines,hostServices:this.hostServices,style:this.options.layerStyle})},i.prototype.getDataLabelLayoutOptions=function(e){var t=(0,it.n8)(this.chartType);return t.allowLeaderLines=t.allowLeaderLines||e.some(function(a){return a.enableLeaderLines}),t.shrinkLeaderLinesForBestFit=11!==this.chartType,t.drawLeaderLinesIgnoreOffset=11!==this.chartType,t},i.prototype.renderDataLabels=function(e){var t=this.behavior?this.renderLabelsWithInteractiveBehavior(e):this.renderLabelsWithoutInteractiveBehavior(e);return!_.isEmpty(t)||_.every(e.labelDataPointGroups,function(a){return _.isEmpty(a.labelDataPoints)})},i.prototype.renderLabelsWithoutInteractiveBehavior=function(e){var t,s=new Eo.nu({maximumOffset:ye.wh,startingOffset:ye.ki,attemptToMoveLabelsIntoViewport:!0}).layout(e.labelDataPointGroups,e.plotArea);return null!==(t=this.featureSwitches)&&void 0!==t&&t.labelEnhancementsM0?this.renderEnhancedLabels(s,e):this.drawLegacyLabelsAndBackgrounds(s,e),s},i.prototype.drawLegacyLabelsAndBackgrounds=function(e,t){var a=this.axesRenderer.getDataLabelContainers();return(0,it.gm)({labelContext:a.foreground,dataLabels:e,numeric:t.labelsAreNumeric,backgroundContext:a.background,formatMode:this.options.formatMode,onObject:this.featureSwitches.onObject})},i.prototype.drawLabelContainer=function(e,t){var a=t.labelsAreNumeric,r=this.axesRenderer.getLabelContainerRegion().foreground;return(0,it.AE)({labelGroupContext:r,labelContainers:e,numeric:a,formatMode:this.options.formatMode,onObject:this.featureSwitches.onObject})},i.prototype.renderEnhancedLabels=function(e,t){var o,a=this.labelInstanceTypeSplitter(e),r=a.labels,n=a.containers,s=this.axesRenderer.getLabelContainerRegion().foreground;return _.isEmpty(n)||(o=this.drawLabelContainer(n,t)),o=this.drawLegacyLabelsAndBackgrounds(r,t),_.isEmpty(n)&&((0,it.in)(s),(0,it.$J)(s)),o},i.prototype.renderLabelsWithInteractiveBehavior=function(e){var t,S,a=e.labelDataPointGroups,r=e.plotArea,n=e.suppressAnimations,s=e.animateLabels,o=e.labelsAreNumeric,l=this.options,u=l.formatMode,c=l.labelAnimationOptions,d=this.getDataLabelLayoutOptions(a),v=new Eo.nu(d).layout(a,r),y=this.axesRenderer.getDataLabelContainers(),f=y.foreground,p=y.background,m=(0,ut.ML)(v);if(this.renderLeaderLines(d,v),S=!m&&null!==(t=this.cartesianOptions)&&void 0!==t&&t.animator&&!n&&s?(0,it.Bf)({labelContext:f,dataLabels:v,duration:c.duration,numeric:o,easeType:c.ease,backgroundContext:p,formatMode:u,onObject:this.featureSwitches.onObject}):this.featureSwitches.labelEnhancementsM0?this.renderEnhancedLabels(v,e):this.drawLegacyLabelsAndBackgrounds(v,e),this.interactivityService&&(this.cartesianOptions.isLabelInteractivityEnabled||u)){var b={labelItems:S};this.interactivityService.bind(v,new Id.c,b,{isLabels:!0,pointSourceKey:"data-labels",formatMode:u})}return v},i.prototype.labelInstanceTypeSplitter=function(e){for(var t=[],a=[],r=0,n=e;r<n.length;r++){var s=n[r];(0,ut.CC)(s)?a.push(s):t.push(s)}return{labels:t,containers:a}},i.prototype.renderLeaderLines=function(e,t){var a=this.axesRenderer.getDataLabelContainers().foreground,r=e.allowLeaderLines?t.filter(function(n){return!_.isEmpty(n.leaderLinePoints)&&null!=n.identity}):[];(0,it.z8)(a,r,function(n){return n.identity.getKey()})},i.prototype.renderSeriesLabels=function(e,t,a,r,n){var s=this.axesRenderer.getSeriesLabelContainers(),o=s.seriesForeground,l=s.seriesBackground,u=new Eo.nu({maximumOffset:ye.wh,startingOffset:ye.ki,attemptToMoveLabelsIntoViewport:!0});(0,it.Sw)({labelContext:o,dataLabels:u.layout(e,t),backgroundContext:l,availableChartWidth:r,seriesLabelsSettings:a,plotArea:t,formatMode:n,onObject:this.featureSwitches.onObject})},i.prototype.renderLayers=function(e){var t=e.layers,a=e.axesLayout,r=e.suppressAnimations,n=e.resizeMode;k.fF.assertValue(t,"layers");var c,y,f,s=[],o=[],l=[],u=[],d=!0,h=a.axes,v=a.plotArea;r=r||_.some(t,function(P){return P.shouldSuppressAnimation&&P.shouldSuppressAnimation()});for(var p=!0,S=function(D){var L=D.render(r,n,m.options.formatMode);if(L){if(L.animateLabels||(p=!1),m.behavior&&(l=l.concat(L.dataPoints),u.push(L.behaviorOptions),L.navigationOptions&&(c?c.navigationOptions.navigationStrategy=Y.jN.CategoryFirst:(c={pointSourceKey:"cartesian-layer ".concat(m.options.multipleId||""),navigationOptions:{navigationStrategy:L.navigationOptions.navigationStrategy,helper:m.dataPointNavigationHelper}},m.dataPointNavigationHelper.clearNavigationLayers()),c.isHierarchicalAxis=m.options.isHierarchicalAxis,m.dataPointNavigationHelper.addNavigationLayer(L.navigationOptions.helper))),L.labelDataPointGroups)for(var B=0,E=L.labelDataPointGroups;B<E.length;B++)(j=E[B])&&s.push((0,g.__assign)((0,g.__assign)({},j),{labelDataPoints:(0,it.R1)(j.labelDataPoints||[]),labelOrientation:j.isTotal?Ms.B.Horizontal:L.labelOrientation}));else{var H=L.labelDataPoints||[];s.push((0,g.__assign)((0,g.__assign)({},H),{labelDataPoints:(0,it.R1)(H),maxNumberOfLabels:H.length,labelOrientation:L.labelOrientation}))}if(L.labelDataPointSeriesGroups)for(var Z=0,ve=L.labelDataPointSeriesGroups;Z<ve.length;Z++){var j;(j=ve[Z])&&o.push((0,g.__assign)((0,g.__assign)({},j),{labelDataPoints:(0,it.R1)(j.labelDataPoints||[]),labelOrientation:j.isTotal?Ms.B.Horizontal:L.labelOrientation}))}d=d&&L.labelsAreNumeric,m.lassoSelectionBehavior&&(void 0!==L.categorySubRangeCount&&(void 0===y?y=L.categorySubRangeCount:k.fF.assert(function(){return L.categorySubRangeCount===y},"categorySubRangeCount should match between layers")),void 0!==L.verticalCategoryAxis&&(void 0===f?f=L.verticalCategoryAxis:k.fF.assert(function(){return L.verticalCategoryAxis===f},"verticalCategoryAxis should match between layers")))}},m=this,b=0,x=t;b<x.length;b++)S(x[b]);var A=this.getReferenceLineLabels(h,v);_.isEmpty(A)||s.unshift({labelDataPoints:A,maxNumberOfLabels:A.length});var T={labelDataPointGroups:s,labelsAreNumeric:d,plotArea:v,suppressAnimations:r,isCombo:xa(this.chartType),animateLabels:p};this.noLabelsCanBeRendered=!this.renderDataLabels(T),this.renderSeriesLabels(o,v,Ds(t,this.chartType),Ro(a).width,this.options.formatMode),this.dataPointNavigationHelper.getPendingFocusElement&&c&&(c.navigationOptions.focusElement=this.dataPointNavigationHelper.getPendingFocusElement()),this.interactivityService&&this.interactivityService.bind(l,this.behavior,{layerOptions:u,clearCatcher:this.clearCatcher,root:this.chartAreaSvg,axesLayout:a,categorySubRangeCount:y,verticalCategoryAxis:f},c)},i}(),Ed=function(){function i(){var e;this.unSyncedLayout=[],this.maxMargin={top:0,bottom:0,left:0,right:0},this.axesRenderersByPosition=((e={})[2]=[],e[0]=[],e[1]=[],e)}return i.prototype.update=function(e,t,a,r,n,s,o){this.settings=e,this.coreMultiple=o,this.renderOptions=a,this.maxMargin={bottom:0,left:0,right:0,top:0},this.unSyncedLayout=[];var l=_.clone(this.getCoreMultipleData()),u=this.coreMultiple.layers;if(!this.shouldShareAxis()){for(var c=0,d=t;c<d.length;c++){var h=d[c],v=h.getData(),y=h.layers;v.axesData.x.showAxisTitle=!1,v.axesData.y.showAxisTitle=!1,v.axesData.y2.showAxisTitle=!1,l.axesData.y.sharedAxis||(v.axesData.x.show=!1),l.axesData.x.sharedAxis||(v.axesData.y.show=!1);var f=Io({axesData:v.axesData,rendererSettings:this.settings,referenceLines:v.referenceLines,layers:y,viewport:r,playAxesRect:this.renderOptions.playAxesRect,trimOrdinalDataOnOverflow:this.renderOptions.trimOrdinalDataOnOverflow,axisZoom:void 0,rotateXTickLabels90:!0});this.unSyncedLayout.push(f),f.margin.left>=this.maxMargin.left&&(this.maxMargin.left=f.margin.left),f.margin.right>=this.maxMargin.right&&(this.maxMargin.right=f.margin.right),f.margin.top>=this.maxMargin.top&&(this.maxMargin.top=f.margin.top),f.margin.bottom>=this.maxMargin.bottom&&(this.maxMargin.bottom=f.margin.bottom)}(l=_.clone(t[0].getData())).axesData.x.showAxisTitle=this.getCoreMultipleData().axesData.x.showAxisTitle,l.axesData.y.showAxisTitle=this.getCoreMultipleData().axesData.y.showAxisTitle,l.axesData.y.sharedAxis||(l.axesData.x.show=this.getCoreMultipleData().axesData.x.show,l.axesData.y.show=!1,l.axesData.y2&&(l.axesData.y2.show=!1,l.axesData.y2.showAxisTitle=this.getCoreMultipleData().axesData.y.showAxisTitle)),l.axesData.x.sharedAxis||(l.axesData.x.show=!1,l.axesData.y.show=this.getCoreMultipleData().axesData.y.show)}return this.generateSharedAxisLayout(l,u,r,n,s),this.unSyncedLayout},i.prototype.generateSharedAxisLayout=function(e,t,a,r,n){this.layout=Io({axesData:e.axesData,rendererSettings:this.settings,referenceLines:e.referenceLines,layers:t,viewport:a,playAxesRect:this.renderOptions.playAxesRect,trimOrdinalDataOnOverflow:this.renderOptions.trimOrdinalDataOnOverflow,axisZoom:void 0,rotateXTickLabels90:!0,forceMarginMin:this.shouldShareAxis()?void 0:(0,g.__assign)({},this.maxMargin)}),this.clearUnusedRenderers(r,n,this.layout.shouldRenderAxis,this.layout)},i.prototype.getCoreMultipleData=function(){return this.coreMultiple.getData()},i.prototype.shouldShareAxis=function(){return this.getCoreMultipleData().axesData.x.sharedAxis&&this.getCoreMultipleData().axesData.y.sharedAxis},i.prototype.clearUnusedRenderers=function(e,t,a,r){this.destroyUnusedRenderers(e=a.x||r.isXScrollBarVisible?e:0,2);var n=a.y||r.isYScrollBarVisible?t:0,s=this.shouldRenderYAxis(0,this.settings.data.y.switchAxisPosition)?0:1;this.destroyUnusedRenderers(n,s),this.destroyUnusedRenderers(a.y2||r.isYScrollBarVisible?t:0,0===s?1:0)},i.prototype.destroyUnusedRenderers=function(e,t){var a=this.axesRenderersByPosition[t];_.isEmpty(a)||a.length<=e||(a.slice(e,a.length).forEach(function(r){return r.destroy()}),this.axesRenderersByPosition[t]=a.slice(0,e))},i.prototype.calculateAxesLayout=function(e){return this.shouldShareAxis()||void 0===e?this.calculateSynchronizedAxesLayout():void 0!==e?this.calculateUnSynchronizedAxesLayout(e):this.layout},i.prototype.calculateSynchronizedAxesLayout=function(){var e=_.cloneDeep(this.layout);return(0,be.Zx)(this.layout,e),e.axes.x.scale=this.layout.axes.x.scale.copy(),e.axes.y1.scale=this.layout.axes.y1.scale.copy(),e.axes.y2&&(e.axes.y2.scale=this.layout.axes.y2.scale.copy()),e},i.prototype.calculateUnSynchronizedAxesLayout=function(e){var t,a=_.cloneDeep(this.unSyncedLayout[e]);(0,be.Zx)(this.unSyncedLayout[e],a);var r=a.axes.x,n=a.axes.y1,s=a.plotArea=this.layout.plotArea,o=this.getCoreMultipleData().axesData,l=this.layout.tickLabelMargins.axesOverflow,u=a.tickLabelMargins.axesOverflow;if(!o.y.sharedAxis){r.outerPadding=this.layout.axes.x.outerPadding,r.outerPaddingRatio=this.layout.axes.x.outerPaddingRatio,r.xLabelMaxWidth=this.layout.axes.x.xLabelMaxWidth,r.categoryThickness=this.layout.axes.x.categoryThickness,a.isXScrollBarVisible=this.layout.isXScrollBarVisible;var c=l.bottom+l.top-(u.bottom+u.top);if((d=n.scale).range(n.invertAxis?[1,s.height+c-1]:[s.height+c-1,1]),r.scale=this.layout.axes.x.scale.copy(),a.axes.y2)a.axes.y2.scale.range(n.invertAxis?[1,s.height+c-1]:[s.height+c-1,1]);a.margin.left=Math.max(this.maxMargin.left,a.margin.left),a.margin.right=Math.max(this.maxMargin.right,a.margin.right)}if(!o.x.sharedAxis){n.outerPadding=this.layout.axes.y1.outerPadding,n.outerPaddingRatio=this.layout.axes.y1.outerPaddingRatio,n.xLabelMaxWidth=this.layout.axes.y1.xLabelMaxWidth,n.categoryThickness=this.layout.axes.y1.categoryThickness,a.isYScrollBarVisible=this.layout.isYScrollBarVisible;var d,v=l.left+l.right-(u.left+u.right);if(r.scale.range(r.invertAxis?[s.width+v-1,1]:[1,s.width+v-1]),!o.x.show)if((0,ne._9)(d=n.scale))d.range([0,a.plotArea.height]),d.paddingOuter(n.outerPaddingRatio);else{var f=null!==(t=n.outerPadding)&&void 0!==t?t:0;d.range([a.plotArea.height-f,f])}a.margin.bottom=Math.max(this.maxMargin.bottom,a.margin.bottom),a.margin.top=Math.max(this.maxMargin.top,a.margin.top)}return a},i.prototype.renderAxes=function(e){if(!(e.viewport.height<1||e.viewport.width<1)){var t=Wt(e.element,e.viewport),a=this.getCoreMultipleData();this.getAxesRenderer(t.element,e.position,e.index,a).render(a.axesData,void 0,this.coreMultiple.layers,a.referenceLines,e.viewport,function(){},(0,g.__assign)((0,g.__assign)({},this.renderOptions),{supportsScrolling:this.shouldSupportScrolling(a,e.position),formatMode:this.settings.formatMode,isSelected:this.settings.isSelected,subSelectionHelper:void 0,multipleId:void 0,playAxesRect:void 0}),this.renderOptions.isSmallMultiples,this.updateAxesLayoutByPosition(e))}},i.prototype.scrollDelta=function(e,t){this.updateScrollState(function(a){return a.scrollDelta(e)},t)},i.prototype.scrollTo=function(e,t){this.updateScrollState(function(a){return a.scrollTo(e)},t)},i.prototype.scrollBy=function(e,t){this.updateScrollState(function(a){return a.scrollBy(e)},t)},i.prototype.updateScrollbarExtent=function(e,t){this.updateScrollState(function(a){return a.setExtent(e)},t)},i.prototype.updateScrollState=function(e,t){var a=this.getCoreMultipleData(),r=this.getScrollablePosition(a);k.fF.assertValue(r,"scrollablePosition");var n=this.axesRenderersByPosition[r];2!==r&&_.isEmpty(t)||_.isEmpty(n)||n.forEach(function(s,o){2!==r&&(o<t.startIndex||o>t.endIndex)||e(s)})},i.prototype.updateAxesLayoutByPosition=function(e){var t=e.position,a=e.viewport,r=this.calculateAxesLayout(),n=r.scrollHandleMargins;r.viewport=n?{width:a.width-(n.left+n.right),height:a.height-(n.top+n.bottom),scale:a.scale}:a,r.preferredPlotArea={width:0,height:0};var s=this.getCoreMultipleData();return 2===t?(r.margin=this.getMarginByPosition(r.margin,t,r.tickLabelMargins.axesOverflow),!s.axesData.y.sharedAxis&&s.axesData.y.show&&(r.margin.left=this.layout.margin.left,r.shouldRenderAxis.y=!1),s.axesData.x.sharedAxis||(r.margin.bottom=this.layout.margin.bottom),this.shouldShareAxis()&&(r.shouldRenderAxis.y=!1),r.shouldRenderAxis.y2=!1,r.shouldRenderAxis.y=!1,r.axisLabels.y=null,r.axisLabels.y2=null,r.plotArea.height=0,r):(r.plotArea.width=0,r.margin=this.getMarginByPosition(r.margin,t,r.tickLabelMargins.axesOverflow),r.shouldRenderAxis.x=!1,r.axisLabels.x=null,this.shouldRenderYAxis(t,this.settings.data.y.switchAxisPosition)?(r.axisLabels.y2=null,r.shouldRenderAxis.y2=!1):(r.shouldRenderAxis.y=!1,r.axisLabels.y=null),r)},i.prototype.destroy=function(){var e=this;this.executeActionByPosition(this.axesRenderersByPosition,function(t,a){_.isEmpty(t)||(t.forEach(function(r){return r.destroy()}),e.axesRenderersByPosition[a]=[])})},i.prototype.executeActionByPosition=function(e,t){for(var a in this.axesRenderersByPosition)t(e[a],a)},i.prototype.clearRenderingTimeout=function(){this.executeActionByPosition(this.axesRenderersByPosition,function(e){_.isEmpty(e)||e.forEach(function(t){return t.clearRenderingTimeout()})})},i.prototype.shouldRenderYAxis=function(e,t){return 0===e&&!t||1===e&&t},i.prototype.getMarginByPosition=function(e,t,a){var r=(0,be.ED)(a);return 2===t?(r.bottom=e.bottom,r.top=0,r):(r.left=0,r.right=0,0===t?r.left=e.left:1===t&&(r.right=e.right),r)},i.prototype.getScrollablePosition=function(e){var t;return this.layout.isYScrollBarVisible?null!==(t=e.axesData.y)&&void 0!==t&&t.switchAxisPosition?1:0:this.layout.isXScrollBarVisible?2:void 0},i.prototype.shouldSupportScrolling=function(e,t){return this.getScrollablePosition(e)===t},i.prototype.getAxesRenderer=function(e,t,a,r){var n=$(e.node()),s=n.data("CartesianAxesRenderer");if(s)s.update(r.axesData,r.scrollbarOptions);else{var o=(0,g.__assign)((0,g.__assign)({},this.settings),{container:e,multipleId:"".concat(a),behavior:new ru});o.data.useManagedTabIndex=!0,this.axesRenderersByPosition[t][a]=s=new cu(o),n.data("CartesianAxesRenderer",s)}return s},i}(),du=R(39071),hu="multiple",Hd=function(){function i(e,t,a,r,n,s,o,l,u,c,d,h){var v,y;this.interactivityService=t,this.getLocalizedString=a,this.cartesianOptions=n,this.layerStyle=s,this.viewMode=o,this.buildPlotAreaLayout=l,this.renderMultiple=u,this.adapterFactory=c,this.visualInstanceId=d,this.sharedAxisLayout=new Ed,this.gridLayout=new dr.Me(e,function(){return r.loadMoreData()},null===(v=this.cartesianOptions)||void 0===v?void 0:v.isScrollable,t,h,hu,null===(y=this.cartesianOptions)||void 0===y?void 0:y.featureSwitches),this.visibilityHelper=(0,iu.q)().visibilityHelper(e,i.IconClassName)}return i.prototype.render=function(e){var t=this;this.clearRenderingTimeout();var a=e.cartesianSmallMultipleFactory;this.options=e;var r=e.cartesianSmallMultipleFactory,n=this.adapterFactory(),s=n.getMultiplesSubheader(e.warnings);k.fF.assertValue(n,"smallMultipleAdapter");var l=this.multiplesLayout=n.getMultiplesLayout(e.warnings),u=l.showIcon;if(this.visibilityHelper.updateVisibility({showIcon:u,viewport:e.viewport}),!u){var d={categoryLoadMoreDataHandler:e.categoryLoadMoreDataHandler,playAxesRect:e.playAxesRect,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow,suppressAnimations:e.suppressAnimations,resizeMode:e.resizeMode,rowCount:l.rowCount,columnCount:l.columnCount,getCellBackgroundColor:function(v){return t.getColorFromMultipleObjects(v,qe.e0.smallMultiplesBackgroundColor,t.multiplesLayout.backgroundColor)},backgroundTransparency:l.backgroundTransparency,isHierarchicalAxis:e.isHierarchicalAxis,gridline:l.gridline,cellPadding:{top:l.rowPaddingInner,bottom:0,left:l.columnPaddingInner,right:0},outerPadding:{top:l.rowPaddingOuter,bottom:l.rowPaddingOuter,left:l.columnPaddingOuter,right:l.columnPaddingOuter}};return this.cellDimensions&&(this.cellDimensions.maxSubheaderHeight=void 0),this.renderGridLayout(a,e.viewport,function(v){return t.renderGridCell(r,v,e.background,e.playAxesRect,e.suppressAnimations,e.resizeMode,e.trimOrdinalDataOnOverflow,e.categoryLoadMoreDataHandler,e.isHierarchicalAxis,!0,e.formatMode)},function(v){return t.renderGridCellSubheader(v,r,s)},s,d,e.axisRendererSettings.axes.isYAxisCategorical)}},i.prototype.clearRenderingTimeout=function(){this.sharedAxisLayout.clearRenderingTimeout(),this.gridLayout.clearRenderingTimeout()},i.prototype.destroy=function(){this.gridLayout.destroy(),this.sharedAxisLayout.destroy()},i.prototype.onScroll=function(e){this.sharedAxisLayout.scrollDelta(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollDelta(e,this.getVisibleMultiples())},i.prototype.onExtentUpdate=function(e){this.sharedAxisLayout.updateScrollbarExtent(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.updateScrollbarExtent(e,this.getVisibleMultiples())},i.prototype.scrollTo=function(e){this.sharedAxisLayout.scrollTo(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollTo(e,this.getVisibleMultiples())},i.prototype.shouldScrollTo=function(e){return this.options.cartesianSmallMultipleFactory.shouldScrollTo(e,this.getVisibleMultiples())},i.prototype.scrollBy=function(e){this.sharedAxisLayout.scrollBy(e,this.gridLayout.getScrollPosition()),this.options.cartesianSmallMultipleFactory.scrollBy(e,this.getVisibleMultiples())},i.adjustAxesMarginsForShared=function(e,t,a){var r,n,s,o=e.axesMargins,l=e.titleMargins,u=e.scrollHandleMargins,c=e.shouldRenderAxis,d=e.axes;function h(S,m,b){return m||S&&null!=S.axisLabel&&b}var v=h(d?.y1,c.y,a.y),y=h(d?.y2,c.y2,a.y2),p={bottom:h(d?.x,c.x,a.x)?o.bottom:0,top:0,left:0,right:0};return t?(v&&(p.right=c.y?o.right:l.right),y&&(p.left=c.y2?o.left:l.left)):(v&&(p.left=c.y?o.left:l.left),y&&(p.right=c.y2?o.right:l.right)),{left:p.left+(null!==(r=u?.left)&&void 0!==r?r:0),right:p.right+(null!==(n=u?.right)&&void 0!==n?n:0),bottom:p.bottom+(null!==(s=u?.bottom)&&void 0!==s?s:0),top:0}},i.prototype.getVisibleMultiples=function(){var e=this.options.cartesianSmallMultipleFactory.getFrameCount(),t=this.gridLayout.getScrollPosition();return t?{startIndex:t.startIndex*this.multiplesLayout.columnCount,endIndex:Math.min(t.endIndex*this.multiplesLayout.columnCount,e)}:{startIndex:0,endIndex:0}},i.prototype.calculatePlotArea=function(e){var t,a,r=i.adjustAxesMarginsForShared(e,this.options.axesData.y.switchAxisPosition,su(this.options.axesData,void 0));this.gridLayout.updateHeaderMargins(r);var n=null!==(a=null===(t=this.adapterFactory())||void 0===t?void 0:t.getMultiplesSubheader(this.options.warnings))&&void 0!==a?a:kn(this.options.cartesianSmallMultipleFactory.getObjects(),this.layerStyle),s=(0,g.__assign)({},e.axesOverflow);if((!this.options.axesData.y.sharedAxis||!this.options.axesData.x.sharedAxis)&&this.sharedAxisLayout.getCoreMultipleData().axesData.valueAxis.show){var o=e.axesMargins;this.options.axesData.y.sharedAxis||(s.left=Math.max(o.left,s.left),s.right=Math.max(o.right,s.right)),this.options.axesData.x.sharedAxis||(s.bottom=Math.max(o.bottom,s.bottom),s.top=Math.max(o.top,s.top))}return this.cellDimensions=this.gridLayout.calculateCellDimensions(s,{titleWrap:n.titleWrap,subheaders:n.titleWrap?this.getFrameDisplayNames():void 0,subheaderFontProperties:n.fontProperties,subheaderLineHeight:n.height,subheaderMargin:n.margins},e),this.cellDimensions.plotAreaViewport},i.prototype.scrollRowsTo=function(e){k.fF.assertValue(this.gridLayout,"grid layout"),this.gridLayout.scrollTo(e)},i.prototype.getFrameDisplayNames=function(){var e=this.getLocalizedString("ListJoin_Separator"),t=this.options.cartesianSmallMultipleFactory.reader.getFrameDisplayNames();return t&&t.map(function(a){return a.join(e)})},i.prototype.renderGridLayout=function(e,t,a,r,n,s,o){var l,u;return(0,g.__awaiter)(this,void 0,void 0,function(){var c,d,h,v,y,f,C,T,P,D,L,O=this;return(0,g.__generator)(this,function(B){return c=this.getAxesRenderOptions(s),d=e.getFrameCount(),h=e.getCoreMultiple(),v=e.getShouldResetRowMultipleScrollPosition(),T=n.height+(C=n.margins).top+C.bottom,P={rowCount:y=s.rowCount,columnCount:f=s.columnCount,viewport:t,renderCell:function(j){return(0,g.__awaiter)(O,void 0,void 0,function(){return(0,g.__generator)(this,function(H){return a(j),[2,new Promise(function(Z){return Z()})]})})},renderCellSubheader:function(j){return(0,g.__awaiter)(O,void 0,void 0,function(){return(0,g.__generator)(this,function(H){return r(j),[2,new Promise(function(Z){return Z()})]})})},cellCount:d,headerMargins:{top:0,bottom:0,left:0,right:0},renderHeader:function(){},subheaderShow:n.show,subheaderHeight:(null===(l=this.cellDimensions)||void 0===l?void 0:l.maxSubheaderHeight)||T,subheaderLineHeight:n.height,subheaderPosition:1!==n.vertical?0:1,shouldResetScrollPosition:v,cellPadding:s.cellPadding,outerPadding:s.outerPadding,scrollPadding:5,getCellBackgroundColor:s.getCellBackgroundColor,backgroundTransparency:s.backgroundTransparency,gridLineSettings:s.gridline,getAllCells:function(){return e.multiples},manageTabIndexOnRowHeaderFooter:o,boldedSubheaders:n.labelBold},this.gridLayout.update(P),D=Math.ceil(d/f),this.sharedAxisLayout.update(this.options.axisRendererSettings,e.multiples,c,t,f,Math.max(D,y),h),P.renderHeader=function(E){return O.sharedAxisLayout.renderAxes(E)},P.headerMargins=this.cellDimensions.headerMargins,P.subheaderHeight=(null===(u=this.cellDimensions)||void 0===u?void 0:u.maxSubheaderHeight)||T,this.gridLayout.update(P),L=_.map(e.multiples,function(E){return E.getDataPoint()}),[2,this.gridLayout.render({calculatedCellDimensions:this.cellDimensions,dataToBind:L,pointSourceKey:"multiples",visualInstanceId:this.visualInstanceId,formatMode:this.options.formatMode,subSelectionHelper:this.options.subSelectionHelper})]})})},i.prototype.renderGridCellSubheader=function(e,t,a){var r,n=e.element,s=e.index,o=e.viewport;if(!_.isUndefined(s)){var l=1===a.horizontal?"center":2===a.horizontal?"right":"left",u=this.getSubheaderFontProperties(s,a.fontProperties);n.css((0,We.wB)(u)),n.css({padding:"".concat(a.margins.top,"px ").concat(a.margins.right,"px ").concat(a.margins.bottom,"px ").concat(a.margins.left,"px "),"text-align":l});var c=this.getLocalizedString("ListJoin_Separator"),d=this.options.cartesianSmallMultipleFactory.reader.getDisplayNameForFrame(s),h=d&&d.join("".concat(c));if(n.attr("title",h),n.attr("id","".concat(this.visualInstanceId,"-").concat(s)),n.empty(),a.titleWrap&&(null===(r=this.cellDimensions)||void 0===r?void 0:r.maxSubheaderHeight)>a.height+a.margins.top+a.margins.bottom)for(var v=(0,We.qk)(u),f=(0,Wi.ql)(h,v,Le.b.measureSvgTextWidth,o.width,dr.ji,null,!0),p=0;p<f.length;p++){var S=f[p],m=$("<div/>").text(S);p===f.length-1&&m.addClass("truncate"),n.append(m)}else n.text(h);if(this.interactivityService){var b=t.get(s),x=n.closest(du.bL.selector);e.styleSubheader(x,b,a.labelBold)}}},i.prototype.getSubheaderFontProperties=function(e,t){var a=this.getColorFromMultipleObjects(e,{objectName:cr.XG,propertyName:"fontColor"});return null==a?t:(0,We.ED)(t,{color:a})},i.prototype.getColorFromMultipleObjects=function(e,t,a){var r;if(null!=e){var n=null===(r=this.options.cartesianSmallMultipleFactory.reader.getFrameNode(e))||void 0===r?void 0:r.objects;if(n){var s=(0,le.W7)(n,t);if(s)return s}}return a},i.prototype.getAxesRenderOptions=function(e){var t=this;return(0,g.__assign)((0,g.__assign)({},e),{axesAnimationOptions:this.options.animationSettings,viewMode:this.viewMode,isSmallMultiples:!0,preserveScrollPosition:!0,navigationScrollCallbacks:{scrollTo:function(r){return t.scrollTo(r)},shouldScrollTo:function(r){return t.shouldScrollTo(r)},scrollBy:function(r){return t.scrollBy(r)}}})},i.prototype.renderGridCell=function(e,t,a,r,n,s,o,l,u,c,d){var h,v=t.viewport,y=e.get(t.index);if(2&y.getState())y.getRenderer().attachToElement(t.element,t.viewport);else{var f=Wt(t.element,v),p=f.element,S=null===(h=this.cartesianOptions.behaviorFactory)||void 0===h?void 0:h.create();y.initRenderer(this.buildPlotAreaLayout(!0,p,f.clearCatcher,t.element,S))}if(this.interactivityService){var m=t.element.closest(du.bL.selector);t.bindDataToGridCell(m,y,hu)}this.renderMultiple({multiple:y,viewport:v,background:a,axisZoom:void 0,chartAreaViewport:v,chartAreaMargins:{top:0,bottom:0,left:0,right:0},renderedViewport:v,playAxesRect:r,suppressAnimations:n,resizeMode:s,trimOrdinalDataOnOverflow:o,categoryLoadMoreDataHandler:l,isSharedAxis:!0,isHierarchicalAxis:u,preserveScrollPosition:c,supportsScrolling:!0,axesLayout:this.sharedAxisLayout.calculateAxesLayout(y.index),formatMode:d})},i.IconClassName="cartesianChartResponsiveIcon",i}(),ae=R(14577),vu=R(42359),Wd=R(1144),Gd=R(61289),Bo=R(82386),fu=function(){function i(){}return i.prototype.ensureValueGroupAtSeriesIndex=function(e,t,a){if(!e[t]){var r=this.getValueGroupName(a),n={identity:this.getSeriesIdentity(a),values:[],objects:this.getSeriesObjects(a),name:r};e[t]=n}return e[t]},i}(),jd=function(i){function e(t){var a=i.call(this)||this;return a.matrix=t,a}return(0,g.__extends)(e,i),e.prototype.setSource=function(t){t.source=this.matrix.columns.levels[0].sources[0]},e.prototype.getSeriesGroups=function(t,a){return t&&_.map(t,function(r){return _.isEmpty(r.children)?1:r.children.length})},e.prototype.getSeriesDataPoints=function(t){return _.filter(this.matrix.columns.root.children,function(r){return!r.isSubtotal})},e.prototype.getValueGroupName=function(t){return t.value||t.levelValues&&t.levelValues[0].value},e.prototype.getSeriesObjects=function(t){return t.objects},e.prototype.getSeriesIdentity=function(t){return t.identity},e.prototype.getSeriesSourceColumn=function(t,a){return void 0===a&&(a=null),_.create(t,{groupName:a})},e.prototype.createValueColumnForMeasure=function(t,a,r,n,s){if(!a[s]){var o={identity:this.getSeriesIdentity(t),values:[],source:this.getSeriesSourceColumn(r,n),objects:void 0};a[s]=o}return a[s]},e}(fu),Ud=function(i){function e(t){return i.call(this)||this}return(0,g.__extends)(e,i),e.prototype.setSource=function(t){},e.prototype.getSeriesGroups=function(t,a){return a?[a]:[]},e.prototype.getSeriesDataPoints=function(t){return t},e.prototype.getValueGroupName=function(t){return t.displayName},e.prototype.getSeriesObjects=function(t){return t.objects},e.prototype.getSeriesIdentity=function(t){},e.prototype.getSeriesSourceColumn=function(t,a){return t},e.prototype.createValueColumnForMeasure=function(t,a,r,n,s){if(!a[s]){var o={identity:this.getSeriesIdentity(t),values:[],source:this.getSeriesSourceColumn(r,n),objects:[]};a[s]=o}return a[s]},e}(fu),pu=function(){function i(e,t){var a=this;this.sourceDataView=e,this.formatStringPropId=t,k.fF.assert(function(){return e&&e.metadata&&!!e.matrix},"sourceDataView && sourceDataView.metadata && !!sourceDataView.matrix"),this.matrix=e.matrix,this.hasRowChildren=!_.isEmpty(this.matrix.rows.root.children),this.hasColChildren=!_.isEmpty(this.matrix.columns.root.children),this.hasSeries=this.hasColChildren&&!_.isEmpty(this.matrix.columns.levels)&&_.every(this.matrix.columns.levels[0].sources,function(n){return!n.isMeasure}),this.hasCategories=this.matrix.rows.levels.length>1&&this.hasRowChildren,this.objects=e.metadata.objects,this.frameCount=function(i){return i.rows.root.children?_.filter(i.rows.root.children,function(e){return!e.isSubtotal}).length:0}(this.matrix),this._frameDisplayNames=new Ia.o(function(){return a.getDisplayNameFromAllFrames()})}return i.create=function(e,t){return new i(e,t)},i.prototype.getObjects=function(){return this.objects},i.prototype.getFrameDisplayNames=function(){return this._frameDisplayNames.getValue()},i.prototype.hasFrames=function(){return this.matrix&&this.frameCount>0&&!_.isEmpty(this.matrix.rows.levels)&&!!this.getFrameSourceColumns()},i.prototype.getFrameCount=function(){return this.frameCount},i.prototype.getFrameSourceColumns=function(){return this.matrix.rows.levels[0].sources},i.prototype.getFrameNode=function(e){return this.matrix.rows.root.children[e]},i.prototype.getValueSources=function(e){return e?(0,Bo.vC)(this.matrix.rows.levels[this.hasCategories?1:0]):this.matrix.valueSources},i.prototype.buildCategoricals=function(e,t,a,r,n){var s=this,l=this.matrix.rows.root.children[e];k.fF.assert(function(){return!l.isSubtotal},"frame node should not be subtotal");var u=[];n.forEach(function(b,x){u[x]={shouldReadScopedValues:!b&&s.hasSeries}});var c=n.map(function(b){return s.hasSeries&&b?new jd(s.matrix):new Ud(s.matrix)});u.forEach(function(b){b.allValueSources=s.getValueSources(b.shouldReadScopedValues)});for(var d=0;d<c.length;d++){var h=this.findUniqueFilteredValueSourcesAndIndices(u[d].allValueSources,r&&r[d]),v=h[0],y=h[1];u[d].requiredValueSources=v,u[d].requiredValueSourcesIndices=y,c[d].setSource(t[d].values);var f=c[d].getSeriesDataPoints(v);u[d].seriesNodes=f;var p=c[d].getSeriesGroups(f,y.length);u[d].seriesGroups=p,u[d].valueGroups=Array(p.length)}(0,Bo.y9)(this.hasCategories?l.children:[l],function(b,x,C){var A;if(!b.isSubtotal){s.hasCategories&&function(i,e){k.fF.assertNonEmpty(i,"sourceCategoryHierarchicalGroupNodes"),k.fF.assertNonEmpty(e,"destinationCategories"),k.fF.assert(function(){return _.every(i,function(d){return 1===d.levelValues.length})&&i.length===e.length||1===i.length&&i[0].levelValues.length===e.length},"pre-condition: there should be one category column per matrix row level/level source for Category.");var a,r,t=_.last(i).objects,n=i[0];if(i.length>1){(r=new Array(i.length))[0]=n.levelValues[0].value;for(var s=n.identity.expr,o=1,l=i.length;o<l;o++)r[o]=(n=i[o]).levelValues[0].value,s=(0,Gn.xD)(s,n.identity.expr);a=(0,$r.TZ)(s)}else a=n.identity,r=_.map(n.levelValues,function(d){return d.value});for(var u=0,c=e.length;u<c;u++)e[u].identity.push(a),e[u].objects.push(t),e[u].values.push(r[u])}(C,a);for(var T=u.map(function(re){return re.shouldReadScopedValues?(0,Bo.Lr)(b):b.values}),P=0;P<u.length;P++)for(var D=u[P],L=0;L<D.seriesGroups.length;L++){for(var O=D.seriesNodes&&D.seriesNodes[L],B=D.seriesGroups[L],E=c[P].ensureValueGroupAtSeriesIndex(D.valueGroups,L,O),j=[],H=0;H<B;H++){var Z=L*B+H,ve=c[P].createValueColumnForMeasure(O,t[P].values,D.requiredValueSources[D.shouldReadScopedValues?Z:H],E.name,Z);s.hasSeries||(Z=D.requiredValueSourcesIndices[Z]);var fe=null===(A=T?.[P])||void 0===A?void 0:A[Z];_.isEmpty(D.requiredValueSources)||s.readValues(fe,ve,x),j.push(ve)}E.values=j}}});var m=this.hasSeries&&this.hasCategories&&_.isEmpty(u.filter(function(b){return!_.isEmpty(b.requiredValueSources)}));for(d=0;d<t.length;d++)(0,Wd.PO)(t[d].values,u[d].valueGroups),_.isEmpty(u[d].requiredValueSources)&&(n[d]?m||(t[d].values=void 0):t[d]=void 0)},i.prototype.findUniqueFilteredValueSourcesAndIndices=function(e,t){if(_.isEmpty(e))return[[],[]];for(var a=[],r=[],n={},s=function(u){var c=e[u];if(!_.isEmpty(t)&&!_.some(t,function(d){return c.roles[d]})||n[c.queryName])return"continue";a.push(u),r.push(c),n[c.queryName]=!0},o=0;o<e.length;o++)s(o);return[r,a]},i.prototype.readCategories=function(){var e=this.matrix.rows;if(k.fF.assert(function(){return e.levels.length<=1||2===e.levels.length&&e.levels[1].sources.length>=1||e.levels.length>=2&&_.every(e.levels,function(a){return 1===a.sources.length})},"Incorrect Levels/Sources count."),this.hasCategories){var t=[];return this.fillCategoriesMetadata(t),t}},i.prototype.fillCategoriesMetadata=function(e){var t=this;k.fF.assert(function(){return t.hasCategories},"No categories");for(var a=this.matrix.rows.levels,r=1;r<a.length;r++)for(var n=0,s=a[r].sources;n<s.length;n++)e.push({source:s[n],values:[],identity:[],objects:[]})},i.prototype.convertComboFrame=function(e){var t=Zl();return this.convertFrameInternal(e,t)},i.prototype.createEmptyCategorical=function(e){var t;return(t=e.values).push.apply(t,function(i){return _.isEmpty(i)?[]:_.map(i,function(e){return{identity:void 0,values:[],source:e,objects:[]}})}(this.matrix.valueSources)||[]),{metadata:this.sourceDataView.metadata,categorical:e}},i.prototype.convertFrame=function(e){return this.convertFrameInternal(e)[0]},i.prototype.checkValueRolesInList=function(e,t){for(var a=function(u){if(_.some(e,function(c){return u.roles[c]}))return{value:!0}},r=0,n=t;r<n.length;r++){var o=a(n[r]);if("object"==typeof o)return o.value}return!1},i.prototype.validateValueRoles=function(e){if(!_.isEmpty(e)){var t=this.checkValueRolesInList(e,this.matrix.valueSources),a=this.getValueSources(!0),r=a&&this.checkValueRolesInList(e,a);k.fF.assert(function(){return!(t&&r)},"valueRoles cannot exist in both")}},i.prototype.isForColumnValues=function(e){var t=Zl()[0];return _.isEmpty(e)||_.intersection(e,t).length>0},i.prototype.convertFrameInternal=function(e,t){var a=this,r=[],n=this.matrix,s=[];_.isEmpty(t)?s.push(!0):t.forEach(function(p){a.validateValueRoles(p),s.push(a.isForColumnValues(p))}),k.fF.assert(function(){var p;return _.size(null===(p=n?.rows)||void 0===p?void 0:p.levels)>=1},"matrix should have at least one level for Play fields");for(var o=[],l=_.isEmpty(t)?1:t.length,u=0;u<l;u++)o.push({categories:void 0,values:(0,Gd.Yv)()});if(!this.hasCategories){var c=[],d=!0;for(u=0;u<o.length;u++)if(s[u]){if(!_.isEmpty(n.valueSources)&&this.hasRowChildren){d=!1;break}(this.hasSeries||1===o.length)&&(c[u]=this.createEmptyCategorical(o[u]))}else if(!_.isEmpty(this.getValueSources(this.hasSeries))){d=!1;break}if(d)return c}var h=this.readCategories();this.buildCategoricals(e,o,h,t,s);for(var v=0,y=o;v<y.length;v++){var f=y[v];f&&(f.categories=h,r.push({metadata:this.sourceDataView.metadata,categorical:f}))}return r},i.prototype.readValues=function(e,t,a){t.values||(t.values=[]),e?(t.values[a]=e.value??null,void 0!==e.highlight&&(t.highlights||(t.highlights=[]),t.highlights[a]=e.highlight),void 0!==e.objects&&(t.objects||(t.objects=[]),t.objects[a]=e.objects),void 0!==e.highlightObjects&&(t.highlightObjects||(t.highlightObjects=[]),t.highlightObjects[a]=e.highlightObjects)):t.values[a]=null},i.prototype.getDisplayNameFromAllFrames=function(){for(var e=new Array(this.frameCount),t=0;t<this.frameCount;t++){var a=this.getDisplayNameForFrame(t);e[t]=a}return e},i.prototype.getDisplayNameForFrame=function(e){var t=this,a=this.getFrameNode(e),r=this.getFrameSourceColumns(),n=new Array(r.length);return r.forEach(function(s,o){k.fF.assertValue(a.levelValues,"level values should be defined for non subTotal nodes");var l=a.levelValues&&a.levelValues[o].value,u=new we.g({column:s,formatStringPropId:t.formatStringPropId,nullsAreBlank:!0,trailingZeroes:!0});n[o]=u.format(l)}),n},i.prototype.getSubtotals=function(){var e=_.find(this.matrix.rows.root.children,function(c){return c.isSubtotal});if(e){for(var t=_.size(e.values),a=_.size(this.matrix.valueSources),r=t-a,n={},s=0;s<a;s++){var o=this.matrix.valueSources[s].roles,l=(0,ne.eT)(e.values[r+s].value);for(var u in o)n[u]=l}return n}},i.prototype.getTopLevelAggregates=function(e){for(var a={},r=0,n=this.sourceDataView.metadata.columns;r<n.length;r++){var s=n[r];if(s.roles&&s.aggregates)for(var o=0,l=e;o<l.length;o++){var u=l[o];s.roles[u]&&(a[u]=a[u]||[]).push(s.aggregates)}}return _.isEmpty(a)?void 0:a},i}(),qd=function(){function i(e){e&&(this.interactivityService=e)}return i.prototype.initData=function(e){this.element=e.element,this.host=e.host,this.isMobileChart=e.interactivity&&e.interactivity.mobileTileInteractive},i.prototype.initRenderer=function(e){var t=this;k.fF.assertValue(e,"options"),k.fF.assert(function(){return!t.rendererInitialized},"renderer initialized multiple times"),this.svg=e.svg,this.interactivityService&&(this.playControl=new Qd(this.element,function(a){return t.moveToFrameAndRender(a)},this.isMobileChart),this.playControl.onPlay(function(){return t.play()})),this.rendererInitialized=!0},i.prototype.isRendererInitialized=function(){return this.rendererInitialized},i.prototype.setData=function(e,t){if(e){if(this.ridiculousFlagForPersistProperties&&e.metadata)return this.ridiculousFlagForPersistProperties=!1,this.playData;this.playData=e.matrix||e.categorical?function(i,e){var t,a,s,o,r=[],n=[],l=pu.create(i,qe.e0.formatString),u=l.getFrameCount(),c=l.getSubtotals();if(l.hasFrames()){var d=l.getFrameSourceColumns(),h=(0,we.EO)(o=d&&d[0],ae.il.general.formatString),v=void 0;if(o.type.numeric){var y=null===(t=l.getFrameNode(u-1))||void 0===t?void 0:t.value,f=null===(a=l.getFrameNode(0))||void 0===a?void 0:a.value,p=Math.abs(y-f);v=(0,we.Ue)({format:h,value:p,value2:0,columnType:o.type})}else v=(0,we.E3)(h,!0);for(var S=0,m=u;S<m;S++){var b=l.getFrameNode(S);if(!b.isSubtotal){var x=v.format(b.value),C=$("<div></div>").text(x).html();n.push({escapedText:C,text:x}),s=e(yu(S,l),{label:C,column:o,identity:b.identity,value:b.value,formattedValue:x},c),r.push(s)}}}else s=e(yu(0,l),void 0,c),r.push(s);return{allChartData:r,chartData:s,frameData:n,currentFrameIndex:n.length-1,labelData:th(n,o)}}(e,t):{frameData:[],allChartData:[],currentFrameIndex:0,chartData:void 0,labelData:{anyWordBreaks:!1,labelInfo:[]}}}else this.playData={frameData:[],allChartData:[],currentFrameIndex:0,chartData:void 0,labelData:{anyWordBreaks:!1,labelInfo:[]}};return this.lastViewport=void 0,this.playData},i.prototype.render=function(e,t,a){var r,n,s=this.playData,o=!this.lastViewport||this.lastViewport.height!==t.height||this.lastViewport.width!==t.width;if(this.lastViewport=t,o&&this.stop(),s)return null===(r=this.interactivityService)||void 0===r||r.applySelectionStateToData(s.chartData.dataPoints),this.updateCallout(t,a),o&&(null===(n=this.playControl)||void 0===n||n.rebuild(s,t,this.playControlWidth)),{allDataPoints:_.flatten(s.allChartData.map(function(l){return l.dataPoints})),viewModel:{data:this.playData,viewModel:e,viewport:t}}},i.prototype.updateCallout=function(e,t){var a=this.playData,r=a.frameData,n=a.currentFrameIndex,s=e.height,o=s-t.top-t.bottom,l=e.width,u=l-t.left-t.right,c=0,d=Math.min(s,1.3*l),h=Math.max(12,Math.round(d/7));h=Math.min(h,70);var v=[];if(n<r.length&&n>=0){var y={fontSize:Bi.FP.toString(h),text:r[n].text||"",fontFamily:ur.Wn.regular.css};(c=Le.b.estimateSvgTextHeight(y)-Le.b.estimateSvgTextBaselineDelta(y))<o&&(v=[Le.b.getTailoredTextOrDefault(y,u-2*i.calloutOffsetMultiplier*c)])}this.svg.selectAll(i.PlayCallout.selector).data(v).join(function(m){return m.append("text").classed(i.PlayCallout.class,!0)}).text(function(m){return m}).attrs({x:u-i.calloutOffsetMultiplier*c,y:function(){return c}}).styles({"font-size":"".concat(h,"px"),"text-anchor":"end"})},i.prototype.play=function(){var e=this.playData;if(this.isPlaying)this.stop();else if(this.playControl){this.isPlaying=!0,this.playControl.play();var t=this.playControl.getCurrentIndex();if(null==t)return;t=Math.round(t),e.currentFrameIndex=t>=e.allChartData.length-1?-1:t-1,this.playNextFrame(e)}},i.prototype.playNextFrame=function(e,t,a){var r=this;if(this.isPlaying){var n=e.currentFrameIndex+1;if(null!=t&&null!=a&&(n=Math.abs(a-t+1),t=n),n<e.allChartData.length&&n>-1){var s=this.host.tooltips();s&&s.hide({immediately:!0,isTouchEvent:!1}),e.currentFrameIndex=n,e.chartData=e.allChartData[n],this.renderDelegate(e.chartData),this.playControl.setFrame(n),n<e.allChartData.length&&window.setTimeout(function(){r.playNextFrame(e,t,a)},gu)}else this.stop()}else this.stop()},i.prototype.stop=function(){var e;null===(e=this.playControl)||void 0===e||e.pause(),this.isPlaying=!1},i.prototype.remove=function(){var e;null===(e=this.playControl)||void 0===e||e.remove(),d3.selectAll(i.PlayCallout.selector).remove()},i.prototype.setRenderFunction=function(e){this.renderDelegate=e},i.prototype.getCartesianExtents=function(e,t){return this.playData&&!_.isEmpty(this.playData.allChartData)&&!_.isEmpty(this.playData.frameData)&&function(i,e){for(var t={},a=!1,r=0,n=i.allChartData||[];r<n.length;r++){var s=n[r];if(!_.isEmpty(s?.dataPoints)){a=!0;var o=e(s);t={minY:d3.min([o.minY,t.minY]),maxY:d3.max([o.maxY,t.maxY]),minX:d3.min([o.minX,t.minX]),maxX:d3.max([o.maxX,t.maxX]),formatStringX:o.formatStringX||t.formatStringX,formatStringY:o.formatStringY||t.formatStringY}}}return a?t:null}(this.playData,t)||e},i.prototype.setPlayControlPosition=function(e){if(this.playControl){var t=this.playControl.getContainer();t.css("left",e.left?"".concat(e.left,"px"):""),t.css("top",e.top?"".concat(e.top,"px"):""),t.css("width",e.width?"".concat(e.width,"px"):""),this.playControlWidth=e.width}},i.prototype.moveToFrameAndRender=function(e){var t=this.playData;if(this.isPlaying=!0,t&&e>=0&&e<t.allChartData.length&&e!==t.currentFrameIndex){t.currentFrameIndex=e;var a=t.allChartData[e];t.chartData=a,this.renderDelegate(a)}this.isPlaying=!1},i.prototype.isCurrentlyPlaying=function(){return this.isPlaying},i.PlayCallout=(0,Me.CH)("play-callout"),i.calloutOffsetMultiplier=.3,i}(),Qd=function(){function i(e,t,a){this.isMobileChart=a,this.createSliderDOM(e),this.renderDelegate=t}return i.prototype.getContainer=function(){return this.playAxisContainer},i.prototype.remove=function(){this.playAxisContainer&&this.playAxisContainer.remove()},i.prototype.pause=function(){this.playButton.removeClass("pause").addClass("play")},i.prototype.play=function(){this.playButton.removeClass("play").addClass("pause")},i.prototype.getCurrentIndex=function(){if(this.noUiSlider)return Number(this.noUiSlider.get())},i.prototype.onPlay=function(e){this.playButtonCircle.off("click"),this.playButtonCircle.on("click",e)},i.prototype.setFrame=function(e){this.noUiSlider.set([e])},i.prototype.rebuild=function(e,t,a){var r=this;this.noUiSlider&&this.noUiSlider.destroy();var n=e.labelData,s=i.calculateSliderSize(n,a),o=this.getContainer();s.marginLeft>i.SliderMarginLeft&&(o.css("padding-left","".concat(s.marginLeft-i.SliderMarginLeft,"px")),o.css("box-sizing","border-box"));var l=this.updateSliderControl(e,s.width),u=i.adjustWidthRegardingLastItem(n,l,s.width);this.slider.css("width","".concat(u,"px")),this.noUiSlider.on("slide",function(){var c=r.getCurrentIndex();r.renderDelegate(c)}),this.noUiSlider.on("update",function(){return $(".noUi-target").removeClass("noUi-state-tap")})},i.prototype.updateSliderControl=function(e,t){var a=e.labelData,r=this.slider.get(0),n=e.frameData.length,s={start:n<=1?1:e.currentFrameIndex,step:1,range:{min:0,max:n<=1?1:n-1},animationDuration:gu},o=null,l=0;if(n>1){var u=i.createPipsFilterFn(e,t,a);l=u.skipStep,o={mode:"steps",density:Math.ceil(100/n),format:{to:function(d){return e.frameData[d].escapedText},from:function(d){return _.findIndex(e.frameData,function(h){return h.escapedText===d})}},filter:u.filter}}return s.pips=o,(0,Ll.create)(r,s),this.noUiSlider=r.noUiSlider,l},i.createPipsFilterFn=function(e,t,a){var r=_.max(_.map(a.labelInfo,function(c){return c.labelWidth})),n=1,s=1,l=r/(e.frameData.length>1?t/(e.frameData.length-1):t);return l>1.25?(s=Math.ceil(l),n=2):(l>1||a.anyWordBreaks)&&(n=2),{filter:function(d){return d%s==0?n:0},skipStep:s}},i.adjustWidthRegardingLastItem=function(e,t,a){if(_.isEmpty(e.labelInfo)||e.labelInfo.length<=1)return a;var r=e.labelInfo.length,n=Math.floor((r-1)/t)*t,l=e.labelInfo[n].labelWidth/2-(a+i.SliderMarginRight-a/r*(n+1));if(l>0){var u=i.SliderMaxMargin-i.SliderMarginRight;return a-(l>u?u:l)}return a},i.prototype.createSliderDOM=function(e){this.playAxisContainer=$('<div class="play-axis-container"></div>').appendTo(e).css("height","".concat(i.PlayControlHeight,"px")),this.playButtonCircle=$('<div class="button-container"></div>').appendTo(this.playAxisContainer),this.isMobileChart&&this.playButtonCircle.addClass("mobile-button-container"),this.playButton=$('<div class="play"></div>').appendTo(this.playButtonCircle),this.slider=$('<div class="sliders"></div>').attr("drag-resize-disabled","true").attr("rtl",("rtl"===document.dir).toString()).appendTo(this.playAxisContainer)},i.calculateSliderSize=function(e,t){var a=0;!_.isEmpty(e.labelInfo)&&e.labelInfo.length>1&&(a=_.head(e.labelInfo).labelWidth/2);var r=Math.max(a,i.SliderMarginLeft);return r=Math.min(i.SliderMaxMargin,r),{width:Math.max(t-r-i.SliderMarginRight,1),marginLeft:r}},i.SliderMarginLeft=44,i.SliderMarginRight=20,i.SliderMaxMargin=100,i.PlayControlHeight=80,i}(),gu=800,ni={duration:750,ease:d3.easeLinear};function yu(i,e){var t=e.convertFrame(i);return(0,vu.eC)(t.metadata,qe.e0.formatString,N.x.category,t.categorical)}function th(i,e){return{labelInfo:i.map(function(t){return{label:t.escapedText,labelWidth:(0,Wi.bY)(t.escapedText,Le.b.measureSvgTextWidth,{fontFamily:ur.Wn.regular.css,fontSize:Bi.FP.toString(14)})}}),anyWordBreaks:_.some(i,function(t){return(0,Wi.r)(t.escapedText)||t.escapedText.indexOf("-")>-1}),labelFieldName:e?.displayName}}function Su(i,e){var t,a,r,n,s,o,l;return void 0===e&&(e="Play"),k.fF.assertValue(i,"dataView"),null===(l=null===(o=null===(s=null===(n=null===(r=null===(a=null===(t=i.matrix)||void 0===t?void 0:t.rows)||void 0===a?void 0:a.levels)||void 0===r?void 0:r[0])||void 0===n?void 0:n.sources)||void 0===s?void 0:s[0])||void 0===o?void 0:o.roles)||void 0===l?void 0:l[e]}var ah=function(){function i(e,t,a,r){this.options=e,this.axes=t,this.isPlayAxis=a,this.adapterFactory=r}return i.prototype.init=function(e,t,a,r,n,s,o,l){this.initOptions=e,this.tooltipService=t,this.legend=a,this.axesData=r,this.interactivityService=n,this.layerStyle=s,this.rowLoadMoreDataHandler=o,this.eventManager=l},i.prototype.create=function(e){var t=new rh(this.options,this.axes,this.isPlayAxis,this.axesData,this.adapterFactory);return t.init(e,this.initOptions,this.tooltipService,this.legend,this.interactivityService,this.layerStyle,this.rowLoadMoreDataHandler,this.eventManager),t},i}(),ih=function(){function i(e,t,a,r,n){this.legend=e,this.data=t,this.viewport=a,this.interactivity=r,this.showTitlePlaceholder=n}return i.prototype.render=function(e,t,a){if(this.shouldRender()){var r=this.data;this.legend.setPosition(r.position),1===r.dataPoints.length&&!r.grouped&&((r=(0,be.ED)(r)).dataPoints=[]),this.legend.drawLegend({data:r,parentViewport:this.viewport,isHierarchicalAxis:e,formatMode:t,onObject:a,titleSliceUid:"".concat("legend","-").concat("title","-titleText"),showTitlePlaceholder:this.showTitlePlaceholder})}},i.prototype.shouldRender=function(){var e;return!(null!==(e=this.interactivity)&&void 0!==e&&e.mobileTileInteractive)},i.prototype.getMargin=function(){return this.legend.getMargins()},i.prototype.getPosition=function(){return this.legend.getPosition()},i.prototype.adjustChartArea=function(e){(0,ri.xz)(e,this.legend)},i.prototype.isRenderedLeftOrRight=function(){return this.legend.isVisible()&&(0,ri.cB)(this.legend.getPosition())},i}(),rh=function(){function i(e,t,a,r,n){this.cartesianOptions=e,this.axes=t,this.isPlayAxis=a,this.axesData=r,this.adapterFactory=n,this.viewMode=0,k.fF.assertValue(e,"CartesianChartLayout.cartesianOptions")}return Object.defineProperty(i.prototype,"featureSwitches",{get:function(){return this.cartesianOptions.featureSwitches||{}},enumerable:!1,configurable:!0}),i.prototype.init=function(e,t,a,r,n,s,o,l){var u,c;this.options=t,this.tooltipService=a,this.legend=r,this.interactivityService=n,this.layerStyle=s,this.element=e,this.rowLoadMoreDataHandler=o,this.eventManager=l,this.hostServices=t.host,this.gridContainer=$(document.createElement("div")).appendTo(this.element),this.gridContainer.addClass(i.GridContainerClassName),this.behavior=null===(u=this.cartesianOptions.behaviorFactory)||void 0===u?void 0:u.create(),this.visibilityHelper=(0,iu.q)().visibilityHelper(this.element,i.IconClassName);var d=d3.select(this.element.get(0)),h=this.chartAreaSvg=d.append("svg");h.classed(ca,!0),h.attr("name",this.getCartesianChartName()),h.style("position","absolute"),!(null===(c=t.featureSwitches)||void 0===c)&&c.onObject&&h.attr(U.oy,0),this.behavior&&(this.clearCatcher=(0,Y.EX)(h),this.categoricalAxisBehavior=new ru),this.viewMode=this.hostServices.getViewMode()},i.prototype.getCartesianChartName=function(){var e;switch(this.cartesianOptions.chartType){case 0:case 15:e="LineChart_ToolTip";break;case 1:e="AreaChart_ToolTip";break;case 2:e="StackedAreaChart_ToolTip";break;case 3:e="HundredPercentStackedAreaChart_ToolTip";break;case 4:e="ClusteredColumnChart_ToolTip";break;case 5:e="ColumnChart_ToolTip";break;case 6:e="ClusteredBarChart_ToolTip";break;case 7:e="BarChart_ToolTip";break;case 8:e="HundredPercentStackedBarChart_ToolTip";break;case 9:e="HundredPercentStackedColumnChart_ToolTip";break;case 10:e="RibbonChart_ToolTip";break;case 11:e="ScatterChart_ToolTip";break;case 12:e="WaterfallChart_ToolTip";break;case 13:e="LineClusteredColumnComboChart_ToolTip";break;case 14:e="LineStackedColumnComboChart_ToolTip";break;default:e="Chart"}return this.hostServices.getLocalizedString(e)},i.prototype.render=function(e,t,a,r,n,s,o,l,u,c,d,h,v){return(0,g.__awaiter)(this,void 0,void 0,function(){var y,f,S,m,b,x,C;return(0,g.__generator)(this,function(A){switch(A.label){case 0:return this.cartesianSmallMultipleFactory=e,this.viewportScale=t.scale,e.clearRenderingTimeout(),y=e.getCoreMultiple(),(f=y.getData())?(this.axesData=f.axesData,this.formatMode=c,this.isSelected=h,C=this.renderLegend(f.legendData,t,l,c,this.featureSwitches.onObject),m=C[1],this.chartAreaViewport={height:t.height-(S=C[0]).height,width:t.width-S.width,scale:t.scale},b=n.renderContainers(this.chartAreaViewport,this.axesData,this.isPlayAxis()?i.PlayAxisBottomMargin:0,this.featureSwitches),this.legendRenderer.adjustChartArea(n.context),this.positionChartArea(S,m,this.isPlayAxis(),b),x=this.calculatePlayAxisControlLayout(this.chartAreaViewport,S,this.legendRenderer.getPosition(),b),e.isSmallMultiples()?[3,1]:(this.cartesianSmallMultiplesLayout&&(this.cartesianSmallMultiplesLayout.destroy(),this.cartesianSmallMultiplesLayout=void 0),this.setGridContainerVisibility(!1),2&y.getState()||y.initRenderer(this.buildPlotAreaLayout(!1)),this.renderMultiple({multiple:y,viewport:t,background:r,axisZoom:n,chartAreaViewport:this.chartAreaViewport,chartAreaMargins:this.chartAreaMargins,renderedViewport:this.renderedPlotArea,playAxesRect:x,suppressAnimations:o,resizeMode:v,trimOrdinalDataOnOverflow:s,categoryLoadMoreDataHandler:a,isSharedAxis:!1,isHierarchicalAxis:l,preserveScrollPosition:u,supportsScrolling:!0,formatMode:c,isSelected:h,subSelectionHelper:d}),[3,3])):[2];case 1:return this.setGridContainerVisibility(!0),this.adjustGridContainer(this.chartAreaViewport),this.cartesianSmallMultiplesLayout=this.cartesianSmallMultiplesLayout||this.createSmallMultiplesLayout(),[4,this.cartesianSmallMultiplesLayout.render({viewport:this.chartAreaViewport,axisRendererSettings:this.getAxisRendererSettings(this.chartAreaSvg,!0,!1),cartesianSmallMultipleFactory:e,axesData:this.axesData,animationSettings:this.getAnimationOptions(!0),background:r,playAxesRect:x,suppressAnimations:!0,resizeMode:v,isHierarchicalAxis:l,trimOrdinalDataOnOverflow:s,categoryLoadMoreDataHandler:a,warnings:f.warningObjectCollection,formatMode:c,subSelectionHelper:d})];case 2:A.sent(),A.label=3;case 3:return this.featureSwitches.onObject&&d.addDirectEditPlaceholderOutlines(),[2]}})})},i.prototype.setGridContainerVisibility=function(e){this.gridContainer.css("display",e?"":"none")},i.prototype.scrollRowsTo=function(e){k.fF.assertValue(this.cartesianSmallMultiplesLayout,"multiple layout"),this.cartesianSmallMultiplesLayout.scrollRowsTo(e)},i.prototype.destroy=function(){this.cartesianSmallMultiplesLayout&&this.cartesianSmallMultiplesLayout.destroy()},i.prototype.positionChartArea=function(e,t,a,r){this.chartAreaMargins={top:0,bottom:0,left:0,right:0},(0,ri.nM)(t)&&(this.chartAreaMargins.left=e.width),(0,ri.RB)(t)&&(this.chartAreaMargins.top=e.height),a&&(this.chartAreaViewport.height-=i.PlayAxisBottomMargin),r&&(this.chartAreaViewport.height-=r.top+r.bottom,this.chartAreaViewport.width-=r.left+r.right,this.chartAreaMargins.left=(this.chartAreaMargins.left||0)+r.left,this.chartAreaMargins.top=(this.chartAreaMargins.top||0)+r.top),this.chartAreaSvg.attrs({width:this.chartAreaViewport.width,height:this.chartAreaViewport.height}).styles({"margin-top":this.chartAreaMargins.top?"".concat(this.chartAreaMargins.top,"px"):null,"margin-left":this.chartAreaMargins.left?"".concat(this.chartAreaMargins.left,"px"):null})},i.prototype.createSmallMultiplesLayout=function(){var e=this;return new Hd(this.gridContainer,this.interactivityService,function(t){return e.hostServices.getLocalizedString(t)},this.rowLoadMoreDataHandler,this.cartesianOptions,this.layerStyle,this.viewMode,this.buildPlotAreaLayout.bind(this),this.renderMultiple.bind(this),this.adapterFactory,this.hostServices.instanceId,this.eventManager)},i.prototype.adjustGridContainer=function(e){this.gridContainer.css({width:e.width,height:e.height}),this.legendRenderer.adjustChartArea(d3.select(this.gridContainer.get(0)))},i.prototype.getVisibleMultiples=function(){return this.cartesianSmallMultiplesLayout?this.cartesianSmallMultiplesLayout.getVisibleMultiples():{startIndex:0,endIndex:1}},i.prototype.isSmallMultiples=function(){var e,t;return null!==(t=null===(e=this.cartesianSmallMultipleFactory)||void 0===e?void 0:e.isSmallMultiples())&&void 0!==t&&t},i.prototype.renderMultiple=function(e){var t=this,a=(0,g.__assign)((0,g.__assign)({},e),{axesLayout:void 0,labelAnimationOptions:this.getLabelAnimationOptions(e.suppressAnimations),axesAnimationOptions:this.getAnimationOptions(e.suppressAnimations),layerStyle:this.layerStyle,viewMode:this.viewMode,shouldRenderGridLinesOnly:!1,isSmallMultiples:this.isSmallMultiples(),multipleId:e.multiple.getIndex().toString(),navigationScrollCallbacks:{scrollTo:function(o){return t.scrollTo(o)},shouldScrollTo:function(o){return t.shouldScrollTo(o)},scrollBy:function(o){return t.scrollBy(o)}}}),r=e.multiple.getData();e.isSharedAxis&&this.adjustOptionsForSharedAxis(a,e.viewport,e.axesLayout,r);var n=e.multiple.getRenderer();n.axesRenderer.update(r.axesData,r.scrollbarOptions),n.render(e.multiple.layers,r,e.renderedViewport,a,this.viewportScale),this.renderedPlotArea=n.renderedPlotArea},i.prototype.scrollTo=function(e){this.isSmallMultiples()?this.cartesianSmallMultiplesLayout.scrollTo(e):this.cartesianSmallMultipleFactory.scrollTo(e,this.getVisibleMultiples())},i.prototype.shouldScrollTo=function(e){return this.isSmallMultiples()?this.cartesianSmallMultiplesLayout.shouldScrollTo(e):this.cartesianSmallMultipleFactory.shouldScrollTo(e,this.getVisibleMultiples())},i.prototype.scrollBy=function(e){this.isSmallMultiples()?this.cartesianSmallMultiplesLayout.scrollBy(e):this.cartesianSmallMultipleFactory.scrollBy(e,this.getVisibleMultiples())},i.prototype.getLabelAnimationOptions=function(e){return this.isPlayAxis()?ni:this.getAnimationOptions(e)},i.prototype.getAnimationOptions=function(e){var t;return{ease:null===(t=this.cartesianOptions.animator)||void 0===t?void 0:t.getEasing(),duration:(0,tn.Mb)(this.cartesianOptions.animator,e)}},i.prototype.calculatePlotArea=function(e){if(this.isSmallMultiples()){var t=this.cartesianSmallMultiplesLayout.calculatePlotArea(e);return{width:t.width,height:t.height,scale:e.viewport.scale}}var a=e.viewport,r=e.axesMargins,n=a.width-(r.left+r.right);return{width:n-(e.showSeriesLabels?(0,pi.lr)(e.seriesLabelSettings,n):0),height:a.height-(r.top+r.bottom),scale:a.scale}},i.prototype.adjustOptionsForSharedAxis=function(e,t,a,r){r.axesData.y.sharedAxis&&r.axesData.x.sharedAxis?(a.shouldRenderAxis.x=!1,a.shouldRenderAxis.y=!1,a.shouldRenderAxis.y2=!1,a.margin=a.tickLabelMargins.axesOverflow,e.shouldRenderGridLinesOnly=!0):e.shouldRenderGridLinesOnly=!this.axesData.valueAxis.show,a.viewport=t,e.axesLayout=a},i.prototype.getAxisRendererSettings=function(e,t,a){var r=this;return this.axesData.useManagedTabIndex=!1,{axes:this.axes,container:e,cartesianOptions:this.cartesianOptions,data:this.axesData,interactivity:this.options.interactivity,interactivityService:this.interactivityService,behavior:this.categoricalAxisBehavior,calculatePlotArea:function(s){return r.calculatePlotArea(s)},hostServices:this.hostServices,tooltipService:this.tooltipService,eventManager:this.eventManager,formatMode:this.formatMode,isSelected:this.isSelected,onScroll:t?function(n){return r.cartesianSmallMultiplesLayout.onScroll(n)}:void 0,onExtentUpdate:t?function(n){return r.cartesianSmallMultiplesLayout.onExtentUpdate(n)}:void 0,suppressBrush:t?a:void 0}},i.prototype.calculatePlayAxisControlLayout=function(e,t,a,r){var n;if(this.isPlayAxis()){var s=r?.left||0,o=r?.bottom||0;n={left:(0,ri.nM)(a)?t.width:0,top:(0,ri.RB)(a)?t.height+e.height+o:e.height+o,height:i.PlayAxisBottomMargin,width:e.width+s}}return n},i.prototype.renderLegend=function(e,t,a,r,n){return this.legendRenderer=new ih(this.legend,e,t,this.options.interactivity,n&&1===this.viewMode&&this.isSelected),this.legendRenderer.render(a,r,n),[this.legendRenderer.getMargin(),this.legendRenderer.getPosition()]},i.prototype.buildPlotAreaLayout=function(e,t,a,r,n){return t||(t=this.chartAreaSvg),new zd(this.cartesianOptions,this.visibilityHelper,t,new cu(this.getAxisRendererSettings(t,e,e)),r||this.element,this.hostServices,n||this.behavior,this.interactivityService,a||this.clearCatcher,e,this.viewportScale)},i.IconClassName="cartesianChartResponsiveIcon",i.GridContainerClassName="cartesian-grid-container",i.PlayAxisBottomMargin=80,i}(),me=R(47287),Jt=R(58691),Fs=R(34644),bu=function(){function i(e){var t;this.options=e,k.fF.assertValue(e,"options:CartesianVisualConstructorOptions"),this._tooltipsEnabled=null!==(t=e.tooltipsEnabled)&&void 0!==t&&t}return Object.defineProperty(i.prototype,"activeData",{get:function(){var t;return null!==(t=this.clippedData)&&void 0!==t?t:this.data},enumerable:!1,configurable:!0}),i.prototype.hasData=function(){return!!this.data},Object.defineProperty(i.prototype,"featureSwitches",{get:function(){return this.options.featureSwitches||{}},enumerable:!1,configurable:!0}),i.prototype.initData=function(e){k.fF.assertValue(e,"options:CartesianVisualInitDataOptions"),this._currentViewport=e.viewport,this.dataInitOptions=e},i.prototype.initRenderer=function(e){k.fF.assertValue(e?.svg,"options:CartesianVisualInitRendererOptions"),this.renderOptions=e},Object.defineProperty(i.prototype,"tooltipsEnabledSafe",{get:function(){var t,a=null===(t=this.hostService)||void 0===t?void 0:t.tooltips();return this.tooltipsEnabled&&(!a||a?.enabled())},enumerable:!1,configurable:!0}),i.prototype.updateCurrentViewport=function(e){this._currentViewport=e.viewport,this._margin=e.margin},i.prototype.getLegendData=function(){var e;return null===(e=this.data)||void 0===e?void 0:e.legendData},Object.defineProperty(i.prototype,"margin",{get:function(){return this._margin},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return this.dataInitOptions.style},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"animationOptions",{get:function(){return this.dataInitOptions.animation},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentViewport",{get:function(){return this._currentViewport},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hostService",{get:function(){return this.dataInitOptions.host},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tooltipService",{get:function(){var t;return null===(t=this.dataInitOptions.services)||void 0===t?void 0:t.tooltips},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tooltipsEnabled",{get:function(){return this._tooltipsEnabled},set:function(t){this._tooltipsEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.dataInitOptions.element},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"cartesianVisualHost",{get:function(){return this.renderOptions.cartesianHost},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"animator",{get:function(){return this.renderOptions.animator},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"svg",{get:function(){return this.renderOptions.svg},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"availableWidth",{get:function(){return Math.max(0,this.currentViewport.width-(this.margin.left+this.margin.right))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"availableHeight",{get:function(){return Math.max(0,this.currentViewport.height-(this.margin.top+this.margin.bottom))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"interactivityService",{get:function(){return this.options.interactivityService},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"mobileTileInteractive",{get:function(){var t,a;return null!==(a=null===(t=this.dataInitOptions.interactivity)||void 0===t?void 0:t.mobileTileInteractive)&&void 0!==a&&a},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isVisualInteractive",{get:function(){var t,a;return null!==(a=null===(t=this.dataInitOptions.interactivity)||void 0===t?void 0:t.isVisualInteractive)&&void 0!==a&&a},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dragDataPoint",{get:function(){var t;return null===(t=this.dataInitOptions.interactivity)||void 0===t?void 0:t.dragDataPoint},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComboChart",{get:function(){return this.options.isComboChart},enumerable:!1,configurable:!0}),i.prototype.isYCategorical=function(){return!1},i.prototype.overrideXAxis=function(e){this.xAxisProperties=e},i.prototype.onClearSelection=function(){var e;null===(e=this.interactivityService)||void 0===e||e.clearSelection()},Object.defineProperty(i.prototype,"localizer",{get:function(){var t=this;return function(a){return t.hostService.getLocalizedString(a)}},enumerable:!1,configurable:!0}),i.prototype.getPreferredPlotArea=function(e){var n=e.outerPaddingRatio,o={height:this.availableHeight,width:this.availableWidth};if(this.options.isScrollable&&!e.isScalar){var l=e.categoryThickness*(e.categoryCount+2*(void 0===n?0:n));this.isYCategorical()?o.height=Math.max(l,o.height):o.width=Math.max(l,o.width)}return o},i}(),Vs=function(i){function e(t){var a=i.call(this,t)||this;return a.options=t,a.viewModelAdapterFactory=t.viewModelAdapterFactory,a}return(0,g.__extends)(e,i),e.prototype.updateCurrentViewport=function(t){i.prototype.updateCurrentViewport.call(this,t),this.updateViewModelAdapterAndData()},e.prototype.updateViewModelAdapterAndData=function(){this.viewModelAdapterFactory&&this.originalData&&(this.viewModelAdapter=this.viewModelAdapterFactory.create({data:this.originalData,dataView:this.dataView,viewport:this.currentViewport}),this.data=this.viewModelAdapter.getData())},e.prototype.addWarnings=function(t){var a;null===(a=this.viewModelAdapter)||void 0===a||a.addWarnings(t)},e}(bu),Ho=R(52083),Xn=R(7176),yi=R(44196),br=R(43906),xr=R(77558),Ge=R(382),nn=R(6444),sn=R(43286),Os=R(12198),xu=R(34519),Cu=R(45028),on=R(33948),Au=R(93907),Wo=R(43479),nh=[Ge.h.auto,Ge.h.outsideEnd,Ge.h.insideEnd,Ge.h.insideCenter,Ge.h.insideBase],sh=[Ge.h.auto,Ge.h.insideCenter,Ge.h.insideEnd,Ge.h.insideBase],Zn=(0,Me.CH)("series"),oh=[16,4,1,2],lh=[1,4,2],uh=[16],dh=[0,1],mi={seriesOrderReversed:!1,seriesOrderSorted:!1,stackedGapSize:0,stackedGapExplodes:!1,clusteredGapSize:0,clusteredGapOverlaps:!1,clusteredGapOverlapReverse:!1,ribbonGapSize:0},hh=0,wu=10,Du=5,Lu=75,_u=100;function Ns(i){return{strokeShow:!1,strokeColorMatch:!1,strokeTransparency:0,strokeWidth:1,strokeColor:J.v.getThemeColor(i,"foregroundNeutralSecondaryAlt"),strokePattern:qt.Dv.solid,outlineOnly:!1}}function Pu(i){return{fillMatchColor:!0,fillColor:J.v.getThemeColor(i,"backgroundNeutral"),fillTransparency:30,border:Ns(i)}}function Tu(i,e){if(e.stackedGapExplodes&&e.stackedGapSize>0){k.fF.assert(function(){return e.stackedGapExplodeStepSize>0},"stackedGapExplodeStepSize must be pre-computed via the converter.");var t=i.indexFromZeroValue*(i.value<0?-1:1)*e.stackedGapExplodeStepSize;i.position+=t,i.originalPosition+=t}}function vh(i){var t,e=this,a=this.activeData;if(k.fF.assertValue(a,"createLabelDataPoints this.activeData must be set"),null===(t=a.dataLabelsSettings)||void 0===t||!t.show)return[];var r=a.series,n=(0,lt.fI)(),s=r.map(function(o){var l=o.labelSettings?o.labelSettings:a.dataLabelsSettings;if(!l.show)return{labelDataPoints:[],maxNumberOfLabels:0};var c=100!==l.labelDensity&&a.isScalar?(0,it.SS)(e.availableWidth,l.labelDensity,4,Os.v.estimatedLabelWidth):o.data.length;return{labelDataPoints:o.data.filter(function(h){return!(null==h||null==h.value||a.hasHighlights&&!h.highlight)}).map(function(h){var v=fh.call(e,h,l,n,i,o);return h.labelDataPointContainerEnabled?(0,xu.U)({cartesianDataPoint:h,currentAxisProperties:e.valueAxis,currentSeries:o,enableValueDataLabel:l.enableValueDataLabel,formattersCache:n,isStacked100:e.isStacked100,labelDataPoint:v,percentOfTotal:h.value,seriesName:o.displayName,valueDataLabelSettings:l,valueShowBlankAs:l.showBlankAs,getOutsideLabelFill:function(f){return(0,on.j)(f.labelFill,!1,e.isComboChart,i)},getInsideLabelFill:function(f){return(0,on.j)(f.labelFill,!0,e.isComboChart,i)}}):v}),maxNumberOfLabels:c}});return a.isScalar?new Os.v(s,r,{width:this.availableWidth,height:this.availableHeight},this.valueAxis.scale).getSortedDataLabels():s}function fh(i,e,t,a,r){var n,s;e?.displayUnits===ye.In&&(e.precision=void 0);var o=(0,it.d6)(this.valueAxis,e);if(null!==(n=i.dynamicLabelValue)&&void 0!==n&&n.enabled)s=(0,ut.nU)(i.dynamicLabelValue,t,e,o,r,"Value"),!this.featureSwitches.labelEnhancementsM0&&this.featureSwitches.measureDrivenDataLabels&&""===s&&(s=void 0);else{var l=e?.displayUnits===ye.In?e.valueCustomFormatString:void 0,u=(0,sn.yE)(this.columnChartType,48)&&!this.featureSwitches.labelEnhancementsM0?ye.L0:l??i.labelFormatString,c=t.getOrCreate(u,e,o.units,o.getPrecision(!!u,r.type)),d=i.value;this.isStacked100&&this.featureSwitches.labelEnhancementsM0&&(d=i.originalValue),s=(0,it.Bw)(c.format(d))}var p,S,h=e.fontProperties,v=(0,We.qk)(h,s),y=Le.b.measureSvgTextWidth(v),f=Le.b.estimateSvgTextHeight(v,!0);return p=this.isClusteredOptimized?function(i){switch(i){case Ge.h.insideEnd:return[4];case Ge.h.insideCenter:return[1];case Ge.h.insideBase:return[2];case Ge.h.outsideEnd:return[16];default:return oh}}(e.position):function(i){switch(i){case Ge.h.insideEnd:return[4];case Ge.h.insideBase:return[2];case Ge.h.insideCenter:return[1];default:return lh}}(e.position),e.labelOverflow&&(p=function(i){var e=void 0,a=_.map(i,function(r){return function(n){switch(n){case 4:return 128;case 2:return 64;case 1:return 32;default:return e}}(r)}).filter(function(r){return r!==e});return i.concat(a)}(p)),S=this.isBar?i.value>=0?this.valueAxis.invertAxis?4:3:this.valueAxis.invertAxis?3:4:i.value>=0?this.valueAxis.invertAxis?2:1:this.valueAxis.invertAxis?1:2,{isPreferred:!1,text:s,textSize:{width:y,height:f},outsideFill:(0,on.j)(i.labelFill,!1,this.isComboChart,a),insideFill:(0,on.j)(i.labelFill,!0,this.isComboChart,a),parentType:1,parentShape:{rect:{left:this.layout.shapeLayout.x(i),top:this.layout.shapeLayout.y(i),width:this.layout.shapeLayout.width(i),height:this.layout.shapeLayout.height(i)},orientation:S,validPositions:p},identity:i.identity,fontProperties:h,hasBackground:e.enableBackground,backgroundColor:e.backgroundColor,backgroundTransparency:e.backgroundTransparency,transparency:e.transparency}}function ph(i){var t,e=this,a=this.activeData;if(k.fF.assertValue(a,"createTotalLabelDataPoints this.activeData must be set"),!this.isStackedOptimized||null===(t=a.totalLabelsSettings)||void 0===t||!t.show||this.isStacked100)return[];for(var r=_n(a.valuesMetadata),n=(0,we.EO)(r,N.p.general.formatString),s=(0,lt.fI)(),o=this.layout.shapeLayout,l=a.totalLabelsSettings,u=(0,it.d6)(this.valueAxis,l),c=[],d=function(f,p,S){if(0!==f){var m=a.totals[p],b=s.getOrCreate(m.dynamicFormatString||n,l,u.units,l.precision),x=(0,it.Bw)(b.format(f)),C=l.fontProperties,A=(0,We.qk)(C,x),T=l.showPositiveAndNegative?f:f>0?m.positive:m.negative,P={value:T,position:T<0?0:T,valueAbsolute:Math.abs(T),categoryIndex:m.categoryIndex,categoryValue:m.categoryValue,labelSettings:void 0,columnStyle:{fillColor:void 0,fillTransparency:0,border:Ns(i)},originalValue:void 0,originalPosition:void 0,key:void 0,seriesIndex:void 0,selected:void 0,identity:void 0,labelDataPointContainerEnabled:!1,indexFromZeroValue:e.data.layout.stackedGapExplodes?(f>0?m.positiveCount:m.negativeCount)-1:0};Tu(P,e.data.layout),c.push({isPreferred:!1,text:x,textSize:{width:Le.b.measureSvgTextWidth(A),height:Le.b.estimateSvgTextHeight(A,!0)},outsideFill:(0,on.j)(m?.labelFill,!1,e.isComboChart,i),insideFill:(0,on.j)(m?.labelFill,!0,e.isComboChart,i),parentType:1,parentShape:{rect:{left:o.x(P),top:o.y(P),width:o.width(P),height:o.height(P)},orientation:e.isBar?f>=0?S?4:3:S?3:4:f>=0?S?2:1:S?1:2,validPositions:uh},identity:void 0,fontProperties:C,hasBackground:l.enableBackground,backgroundColor:l.backgroundColor,backgroundTransparency:l.backgroundTransparency,isTotal:!0})}},h=0;h<a.totals.length;h++){var v=a.totals[h];v&&(a.totalLabelsSettings.showPositiveAndNegative?(d(v.positive,h,this.valueAxis.invertAxis),d(v.negative,h,this.valueAxis.invertAxis)):d(v.net,h,this.valueAxis.invertAxis))}return[{labelDataPoints:c,maxNumberOfLabels:2*a.totals.length,isTotal:!0}]}function gh(i){var e=this,t=this.activeData;if(k.fF.assertValue(t,"createUncertaintyLabels this.activeData must be set"),this.isStackedOptimized||_.isEmpty(_.filter(this.activeData.series,function(l){var u;return null===(u=l.uncertainty)||void 0===u?void 0:u.labels.show})))return[];var a=(0,lt.fI)(),r=this.layout.shapeLayout,n=this.layout.uncertaintyLayout,s=this.columnWidth/2,o=s/2;return t.series.map(function(l){var u=l.uncertainty;if(!u||!u.renderUncertainty||!u.labels.show)return{labelDataPoints:[],maxNumberOfLabels:0};var c=u.labels,h=c.fontProperties,v=(0,it.d6)(e.valueAxis,c),y=[];return l.data.forEach(function(f){if(null!=f&&null!=f.value&&(!t.hasHighlights||f.highlight)&&null!=f.uncertainty){for(var p=[],S=(0,yi.Ww)(f.value,f.uncertainty,c.errorFormat),m=[S.lower,S.upper],b=0;b<2;b++){var x=m[b],C=1===b;if(null!=(C?f.uncertainty.upper:f.uncertainty.lower)){var T=void 0;if(c.errorFormat===xr.K.relativePercentage)T=(0,yi.O2)(x,e.hostService);else{var P=f.labelFormatString,D=a.getOrCreate(P,c,v.units,v.getPrecision(!!P,l.type));T=(0,it.Bw)(D.format(x))}k.fF.assertValue(T,"label has no value -- columnUtil.createUncertaintyLabels");var L=(0,We.qk)(h,T),O=void 0,B=void 0;e.isBar?(O={x:C?n.upper(f):n.lower(f),y:r.y(f)+(f.drawThinner?o:s)},B=[C?8:4]):(O={x:r.x(f)+(f.drawThinner?o:s),y:C?n.upper(f):n.lower(f)},B=[C?1:2]),p.push({isPreferred:!1,text:T,textSize:{width:Le.b.measureSvgTextWidth(L)+ye.TS,height:Le.b.estimateSvgTextHeight(L,!0)},outsideFill:h.color?h.color:J.v.getThemeColor(i,ye.uQ),insideFill:h.color?h.color:J.v.getThemeColor(i,ye.pl),parentType:0,parentShape:{point:O,radius:0,validPositions:B},identity:void 0,fontProperties:h,hasBackground:c.enableBackground,backgroundColor:c.backgroundColor,backgroundTransparency:c.backgroundTransparency})}}_.isEmpty(p)||y.push.apply(y,p)}}),{labelDataPoints:y,maxNumberOfLabels:100}})}function Mu(i,e){if(0===i.length)return{min:0,max:10};var a=d3.min(i,function(n){return d3.min(n.data,function(s){return s.position-s.valueAbsolute})}),r=d3.max(i,function(n){return d3.max(n.data,function(s){return s.position})});return e&&(a=(0,Lt.W0)(a,1e-4),r=(0,Lt.W0)(r,1e-4)),{min:a,max:r}}function Fu(i,e,t,a,r){void 0===t&&(t=!1);var n=(0,lt.bT)({style:i,textClassName:"smallLightLabel",noColor:!0});return n.position=null,n.labelDensity=ye.go,n.labelOrientation=Ms.B.Horizontal,t?(n.enableBackground=!0,n.backgroundColor=J.v.getThemeColor(i,yt.U),n.backgroundTransparency=ye.r_):n.enableBackground=!1,n.enableTitleDataLabel=!1,e?(n.enableValueDataLabel=!1,n.enableDetailDataLabel=!0,n.detailContentType=Au.W.Percent):(n.enableValueDataLabel=!0,n.enableDetailDataLabel=!1),n.labelContainerMaxWidth=Cu.w9,n.labelContentLayout=function(i,e){return i&&!Kn(i)&&(Uo(i)||ln(i,e)||un(i))||jo(i)?Wo.v.MultiLine:Wo.v.SingleLine}(a,r),n}function Vu(i,e){return!ln(i,e)}function Ou(i,e){return Vu(i,e)?nh:sh}function ln(i,e){return(0,sn.yE)(i,16)&&(1!==e||un(i))}function un(i){return(0,sn.yE)(i,48)}function Kn(i){return(0,sn.yE)(i,2)}function jo(i){return(0,sn.yE)(i,4)}function Uo(i){return(0,sn.yE)(i,8)}var xh=function(){function i(e){var t;this.options=e,this.categories=[],this.existingTooltips=[],this.fillTransparency=0,k.fF.assertValue(e.dataView,"dataView"),k.fF.assertValue(e.style,"style"),this.reader=(0,yr.G)(e.dataView,{staticSeriesRoleNames:[N.x.y],colorOptions:{valueRole:N.x.y,visualStyle:e.style},formatStringProp:N.p.general.formatString,errorRangeProp:qe.Qx.errorRange}),this.seriesCount=this.reader.data.hasValues(i.valueRoleName)?this.reader.data.getSeriesCount():void 0,this.isStacked=ln(e.chartType,this.seriesCount);var a=(t=(0,St.xh)(e.dataView.categorical,me.gE.general.formatString,void 0)).categories,r=t.categoryFormatter;this.categories=a,this.categoryFormatter=r}return Object.defineProperty(i.prototype,"displayNames",{get:function(){if(!this._displayNames){var t=this.options.hostServices;this._displayNames={negative:t.getLocalizedString("Visual_TotalTooltipNegative"),positive:t.getLocalizedString("Visual_TotalTooltipPositive"),net:t.getLocalizedString("Visual_TotalTooltipNet"),simple:t.getLocalizedString("Visual_Total")}}return this._displayNames},enumerable:!1,configurable:!0}),i.create=function(e){return new i(e)},i.convert=function(e){return new i(e).convert()},Object.defineProperty(i.prototype,"staticObjects",{get:function(){return this.reader.objects.getStaticObjects()},enumerable:!1,configurable:!0}),i.prototype.convert=function(){var e,t,a,r,n=(e=this.options).dataView,s=e.style,o=e.multipleInfo,l=e.chartType,u=e.interactivityService,c=e.hostServices,d=e.isComboChart,h=e.supportsTotalLabels,v=null!==(a=n.metadata)&&void 0!==a?a:null,y=84===l,f=un(l),p=ja(v,!1),S=Li(p),m=Dn(null!==(r=this.options.isScalar)&&void 0!==r&&r,p),C=Ln(n.categorical,m).category.source,A=Fu(s,f,d,l,this.seriesCount);this.staticObjects&&(0,lt.AR)(this.staticObjects.labels,A,!Kn(l),s,d);var T=(0,g.__assign)((0,g.__assign)({},A),{show:!1});h&&this.staticObjects&&(0,lt.ww)(this.staticObjects.totals,T,!1,s,d),this.totalLabelsSettings=T,this.color=(0,le.W7)(this.staticObjects,me.gE.dataPoint.fill,s.colorPalette.dataColors.getColorByIndex(0).value),this.fillTransparency=(0,le.NA)(this.staticObjects,me.gE.dataPoint.fillTransparency,0),this.borderSettings=this.readBorderSettings(this.staticObjects,Ns(s),this.color),this.ribbonBandSettings=(0,g.__assign)({show:(0,le.NA)(this.staticObjects,me.gE.ribbonBands.show,y)},this.readRibbonSettings(void 0,this.color));var P=Hn(s);this.staticObjects&&((0,lt.FJ)(this.staticObjects.seriesLabels,P,s,d),P.defaultSeriesWidth=P.defaultSeriesWidth?-1:null,P.maxWidthPercentage=P.defaultSeriesWidth?-1:P.maxWidthPercentage),this.layout={seriesOrderReversed:(0,le.NA)(this.staticObjects,me.gE.layout.seriesOrderReversed,mi.seriesOrderReversed),seriesOrderSorted:(0,le.NA)(this.staticObjects,me.gE.layout.seriesOrderSorted,!!y||mi.seriesOrderSorted),stackedGapSize:(0,le.NA)(this.staticObjects,me.gE.layout.stackedGapSize,mi.stackedGapSize),stackedGapExplodes:(0,le.NA)(this.staticObjects,me.gE.layout.stackedGapExplodes,mi.stackedGapExplodes),clusteredGapSize:(0,le.NA)(this.staticObjects,me.gE.layout.clusteredGapSize,mi.clusteredGapSize),clusteredGapOverlaps:(0,le.NA)(this.staticObjects,me.gE.layout.clusteredGapOverlaps,mi.clusteredGapOverlaps),clusteredGapOverlapReverse:(0,le.NA)(this.staticObjects,me.gE.layout.clusteredGapOverlapReverse,mi.clusteredGapOverlapReverse),ribbonGapSize:(0,le.NA)(this.staticObjects,me.gE.layout.ribbonGapSize,mi.ribbonGapSize)},(d||f)&&(this.layout.stackedGapExplodes=!1),this.isStacked&&(this.layout.stackedGapSize=Math.min(this.layout.stackedGapSize,this.layout.stackedGapExplodes?wu:Du)),this.isStacked||(this.layout.clusteredGapSize=Math.min(this.layout.clusteredGapSize,this.layout.clusteredGapOverlaps?_u:Lu)),(!this.isStacked||this.layout.stackedGapSize>0)&&(this.borderSettings.outlineOnly=!1);var O=(t=this.getLegend()).legendData,B=t.seriesSources,E=O.dataPoints,j=this.createDataPoints({legend:E,defaultDataLabelsSettings:A,defaultSeriesSettings:P,totalLabelsSettings:T,isScalar:m,isCombo:!!d,categoryMetadata:C,multipleInfo:o}),H=j.series,Z=j.hasHighlights,ve=j.hasDynamicSeries,fe=Ou(l,H.length);(null==A.position||!_.includes(fe,A.position))&&(A.position=Ge.h.auto);for(var re=[],ge=0,Ae=E.length;ge<Ae;ge++)re.push(B[ge]);if((this.layout.seriesOrderSorted||this.isStacked&&this.layout.stackedGapSize>0||this.borderSettings.outlineOnly)&&function(i){for(var e=Array.from({length:i.categoryCount},function(){return[]}),t=Array.from({length:i.categoryCount},function(){return[]}),a=Array.from({length:i.categoryCount},function(){return 0}),r=i.isStacked&&i.layout.stackedGapSize>0&&!i.layout.seriesOrderSorted,n=function(y){for(var f=function(m){var b=y[m];if(b.highlight)return"continue";i.hasHighlights&&k.fF.assert(function(){return y[m+1].highlight},"next item must be a highlight data point"),(b.value>=0?e:t)[b.categoryIndex].push({data:b,dataHighlight:i.hasHighlights?y[m+1]:void 0}),b.value&&a[b.categoryIndex]++},p=0;p<y.length;p++)f(p)},s=0,o=i.series;s<o.length;s++)n(o[s].data);function u(v,y){var f;if(!(v.length<1)){v.sort(function(P,D){var L,O;return Math.abs(null!==(L=P.data.value)&&void 0!==L?L:0)-Math.abs(null!==(O=D.data.value)&&void 0!==O?O:0)}),i.layout.seriesOrderReversed&&v.reverse();for(var p=0,S=0,m=0;S<v.length;S++){var b=v[S],x=b.data,C=b.dataHighlight,A=p,T=null!==(f=x.value)&&void 0!==f?f:0;x.indexFromZeroValue=m,C&&(C.indexFromZeroValue=m),T&&m++,T>0?(x.position=p+=T,x.rank=v.length-S,x.seriesPosition=i.layout.seriesOrderReversed?y+S:v.length-S-1):(x.position=p,p+=T,x.rank=y+S+1,x.seriesPosition=i.layout.seriesOrderReversed?v.length-S:y+S),x.originalPosition=x.position,C&&(C.rank=x.rank,C.seriesPosition=x.seriesPosition,C.position=T>0?A+C.value:A,C.originalPosition=x.position)}}}function c(v){if(!(v.length<1))for(var y=0,f=0;y<v.length;y++){var p=v[y],S=p.data,m=p.dataHighlight;S.indexFromZeroValue=f,m&&(m.indexFromZeroValue=f),S.value&&f++}}for(var d=0;d<i.categoryCount;d++)r?(c(e[d]),c(t[d])):i.layout.seriesOrderSorted&&(u(e[d],t[d].length),u(t[d],e[d].length));var h=function(y){for(var f=a[y],p=0,S=function(T){T.countOfPointsInCategory=f,T.value&&(T.indexFromBottom=p,p++)},m=t[y].length-1;m>=0;m--)S(t[y][m].data);for(var b=0,x=e[y];b<x.length;b++)S(x[b].data)};for(d=0;d<i.categoryCount;d++)h(d)}({series:H,hasHighlights:Z,categoryCount:this.categories.length,layout:this.layout,isStacked:this.isStacked}),this.isStacked&&this.layout.stackedGapSize>0&&this.layout.stackedGapExplodes){for(var Pe=0,se=0,Se=H;se<Se.length;se++)for(var Ie=0,xe=(Fe=Se[se]).data;Ie<xe.length;Ie++)(Ne=xe[Ie]).highlight||(Pe=Math.max(Ne.valueAbsolute,Pe));this.layout.stackedGapExplodeStepSize=Pe*this.layout.stackedGapSize/100;for(var $e=0,je=H;$e<je.length;$e++)for(var et=0,Ve=(Fe=je[$e]).data;et<Ve.length;et++){var Ne;Tu(Ne=Ve[et],this.layout)}}for(var rt=1,_e=0;_e<this.categories.length;_e++)for(var vt=0,ze=H;vt<ze.length;vt++){var Fe=ze[vt];Fe?.data[_e]&&(Fe.data[_e].posinset=rt++)}if(this.ribbonBandSettings.show&&this.categories.length>=2&&function(i){for(var e=N.p.general.formatString,t=i.dataView.categorical.categories,a=Kn(i.chartType)&&!i.isScalar,r=function(u){var c=i.hasHighlights?_.filter(u.data,function(v){return v.highlight}):u.data;k.fF.assert(function(){return null!==u.ribbonBands},"ribbonBands must be created per each series in advance");for(var d=function(y){var f=c[y],p=c[y+1];if(!f.value||!p.value||f.categoryIndex!==p.categoryIndex-1)return"continue";if(a){var S=f;f=p,p=S}var m=[],b=i.reader.columns.getValueMetadataColumn(me.au.y,u.index),x=(0,G.BJ)((0,G.AD)(t,f.categoryIndex,e)),C=(0,G.BJ)((0,G.AD)(t,p.categoryIndex,e)),A=function(H){return"".concat(H," ").concat(u.displayName).concat(i.hasDynamicSeries?" ".concat(b.displayName):"")};m.push({displayName:A(x),value:(0,St.xq)(f.value,b,e,!1)}),m.push({displayName:A(C),value:(0,St.xq)(p.value,b,e,!1)});var T=p.value-f.value,P=(0,St.xq)(T,b,e,!1),D=(0,we.Z)("Percentage"),O=(0,we.WU)(T/f.value,D);if(m.push({displayName:"".concat(b.displayName," ").concat(i.hostServices.getLocalizedString("Change")),value:"".concat(P," (").concat(O,")")}),null!=f.rank&&null!=p.rank){m.push({displayName:"".concat(x," ").concat(u.displayName," ").concat(i.hostServices.getLocalizedString("RibbonChart_TooltipRank")),value:"".concat(f.rank)}),m.push({displayName:"".concat(C," ").concat(u.displayName," ").concat(i.hostServices.getLocalizedString("RibbonChart_TooltipRank")),value:"".concat(p.rank)});var B=p.rank-f.rank;if(0!==B){var E=B>0?"\u25bc".concat(B):"\u25b2".concat(-B);m.push({displayName:"".concat(i.hostServices.getLocalizedString("RibbonChart_TooltipRank")," ").concat(i.hostServices.getLocalizedString("Change")),value:E})}}u.ribbonBands.dataPoints.push({d1:f,d2:p,tooltipInfo:m})},h=0;h<c.length-1;h++)d(h)},n=0,s=i.series;n<s.length;n++)r(s[n])}({dataView:n,isScalar:m,chartType:l,series:H,hasHighlights:Z,hasDynamicSeries:ve,reader:this.reader,hostServices:c}),u){for(var kt=0,Ze=H;kt<Ze.length;kt++)u.applySelectionStateToData((Fe=Ze[kt]).data);u.applySelectionStateToData(O.dataPoints)}return(0,g.__assign)((0,g.__assign)({},j),{categories:this.categories,categoryFormatter:this.categoryFormatter,preferredCategoryWidth:S,hasY2Role:(0,Dt.c5)(n,"Y2"),valuesMetadata:re,legendData:O,categoryMetadata:C,isScalar:m,dataLabelsSettings:A,seriesLabelSettings:P,totalLabelsSettings:T,columnStyle:{fillColor:this.color,fillTransparency:this.fillTransparency,border:this.borderSettings},layout:this.layout,ribbonBands:this.ribbonBandSettings,strokeSettings:(0,Wn.kG)(s),dataPointsCount:rt})},i.prototype.createDataPoints=function(e){var t,r,n,s,o,l,u,c,d,h,v,y,f,p,S,a=this,m=(t=this.options).dataView,b=t.chartType,x=t.style,C=t.hostServices,A=un(b),T=e.multipleInfo,P=e.isCombo,D=e.defaultDataLabelsSettings,L=e.defaultSeriesSettings,O=e.isScalar,B=this.seriesCount,E=m.categorical,j=N.p.general.formatString,H=null!==(n=null===(r=E?.values)||void 0===r?void 0:r.grouped())&&void 0!==n?n:void 0,Z=this.categories.length,ve=[],fe=[],re=[];if(B<1||Z<1)return{series:ve,totals:fe,hasPositive:!1,hasNegative:!1,hasNetPositive:!1,hasNetNegative:!1,valuesMetadataBySeries:[],categoryIdentities:[],hasHighlights:!1,hasDynamicSeries:!1,multipleIdentity:void 0,categoryData:re};var je,et,Ve,ge=E.categories,Pe=Ut(_.isEmpty(ge)?null:_.last(ge).source),se=(0,ne.v9)(Pe),Se=[],Fe=[],Ie=[],xe=[],Ne=[],$e=!(!E.values||!E.values.source);T&&(et=_.first(T.sources).metadata.queryName,Ve=T.sources.map(function(ce){return(0,Tt.Y)(ce.metadata,ce.value,T.identity)}),je=(new Tt.dw).withColumnIdentity(T.identity,et,Ve).createSelectionId());for(var rt=!1,_e=this.reader.data.hasHighlights(),vt=0;vt<B;vt++){for(var ze=[],kt=[],Ze=0;Ze<Z;Ze++){var ct=this.getValueBySeriesAndCategory(vt,Ze),Nt=this.getFormatStringBySeriesAndCategory(vt,Ze);if(ze[Ze]={value:ct,formatString:Nt},_e){var Qe=this.getHighlightBySeriesAndCategory(vt,Ze),ea=this.getHighlightFormatStringBySeriesAndCategory(vt,Ze);kt[Ze]={value:Qe,formatString:ea},null!=ct&&null!=Qe&&!(ct>=0&&Qe>=0&&(0,Lt.bA)(ct,Qe)||ct<=0&&Qe<=0&&(0,Lt.bl)(ct,Qe))&&(rt=!0)}}Se.push(ze),_e&&Fe.push(kt)}rt&&!Vu(b,B)&&(rt=!1,_e=!1,Se=Fe);for(var Va=A?Nu(Z,B,function(ce,dt){return Se[ce][dt].value}):[],Gt=D.fontProperties.color,va=this.totalLabelsSettings.fontProperties.color,la=function(dt){var jt=dt,Ee=Oe.layout.seriesOrderReversed?B-dt-1:dt,qa=Oe.reader.labels.dynamicLabelReader.areDynamicValueLabelsEnabled(null===(s=Oe.options.featureSwitches)||void 0===s?void 0:s.labelEnhancementsM0,Ee,_e),pt=[],At=e.legend[Ee],ua=void 0,mt=(0,be.ED)(L);if(Oe.reader.data.hasSeries()||P){var ba,Kt=(ba=P&&!Oe.reader.data.hasSeries()?Oe.reader.objects.getValueMetadataObjects(i.valueRoleName,Ee):Oe.reader.objects.getSeriesDataObjects(Ee))&&ba.labels,Aa=ba&&ba.seriesLabels;(ua=(0,be.ED)(D)).show=D.show&&(null===(o=D.showByDefault)||void 0===o||o),Kt&&(0,lt.AR)(Kt,ua,void 0,x,P),mt.show=L.show&&(null===(l=L.showByDefault)||void 0===l||l),Aa&&(0,lt.FJ)(Aa,mt,x,P)}var li=Oe.reader.columns.getValueColumnBySeries(Ee),Mt=xe[Ee]=Oe.reader.columns.getValueMetadataColumn(i.valueRoleName,Ee),ui=_.findIndex(xe,Mt);-1!==ui&&(Ne[ui]?Ne[ui].usedInSeriesIndices.push(Ee):Ne[ui]={metadataColumn:Mt,usedInSeriesIndices:[Ee],valueSelector:(new Tt.dw).withMeasure(Mt.queryName,li).createSelectionId()});var nt=(0,Xn.nC)(Oe.isStacked?{}:Mt.objects,x,At.marker.color,Ee,(0,g.__assign)((0,g.__assign)({},D),{show:!1}),{isCombo:P,hideBand:!0,valueAxisHorizontal:Kn(b),staticObjects:Oe.staticObjects}),Fi=nt.hasUncertainty,ir=(0,g.__assign)((0,g.__assign)({displayName:At.label,key:"series".concat(Ee),index:Ee,data:pt,identity:At.identity,columnStyle:{fillColor:At.marker.color,fillTransparency:At.marker.transparency,border:At.marker.stroke}},Oe.ribbonBandSettings.show&&{ribbonBands:(0,g.__assign)((0,g.__assign)({},Oe.readRibbonSettings(Ee,At.marker.color)),{dataPoints:[]})}),{labelSettings:ua,uncertainty:nt,measureDisplayName:Mt.displayName,type:Mt.type,seriesLabelSettings:mt});ve.push(ir);for(var Vi=(0,Ho.yj)(E),Lr=(0,Ho.Rr)(E),aa=(0,we.Z)("Percentage"),Oi=!1,pn=function(Be){var Ea,rr,gn=(Ea=Se[Ee][Be]).value,fa=Ea.formatString,Da=(0,ne.eT)(gn);if(null==Da&&jt>0)return"continue";var Qa=Oe.categories[Be];if(se&&null!=Qa&&!(Qa instanceof Date))return"continue";var Ja,Ni=void 0;if(Qa instanceof Date?(k.fF.assert(function(){return se},"Metadata type and value type must match"),k.fF.assert(function(){return(0,nn.M4)(Qa)},"originalCategoryValue"),Ni=Qa.epochTimeStamp):Ni=Qa,O&&(null==Ni||isNaN(Ni)))return"continue";Fi&&(Ja=(0,Xn.PT)(Oe.reader.data,Be,Ee,Da));var Pr=Da<0;null!==(u=fe[Be])&&void 0!==u||(fe[Be]={positive:0,positiveCount:0,negative:0,negativeCount:0,net:0,categoryValue:Ni,categoryIndex:Be,dynamicFormatString:fa}),null!==(c=(p=fe[Be]).dynamicFormatString)&&void 0!==c||(p.dynamicFormatString=fa);var Tr=(0,ut.AO)({defaultColor:va,categoricalDataReader:Oe.reader,categoryIndex:Be,seriesIndex:jt}),eo=(0,ut.B8)(Tr)?Tr.color:Gt;Oe.totalLabelsSettings.fontProperties=(0,ut.Vv)(eo,Oe.totalLabelsSettings.fontProperties),fe[Be].labelFill=Tr.color;var kr=null==Da?null:Da*(A?Va[Be][Pr?"neg":"pos"]:1),La=Math.abs(kr),Ri=void 0;Pr?(Ri=fe[Be].negative,isNaN(La)||(fe[Be].negative-=La,fe[Be].negativeCount++,fe[Be].net-=La)):(isNaN(La)||(fe[Be].positive+=La,fe[Be].positiveCount++,fe[Be].net+=La),Ri=fe[Be].positive);var to=H&&H.length>Ee&&H[Ee].values?H[Ee]:null,ci=_.isEmpty(E.categories)?null:E.categories[0],rs=(rr=i.createIdentities(E,ci,Be,to,Oe.reader.columns.getValueColumn(i.valueRoleName,Ee),Mt,T,et,Ve)).identity,He=rr.identityKey;null!==(d=Ie[Be])&&void 0!==d||(Ie[Be]=function(){return ps(Be,ci)});var _a,nr,Si,yn,Ba=0===Vi?null:Lr;_e&&(_a=Oe.reader.data.getHighlight(i.valueRoleName,Be,Ee),nr=Oe.reader.data.getHighlightFormatString(i.valueRoleName,Be,Ee),yn=_a,null!==_a&&(Fi&&(Si=(0,Xn.PT)(Oe.reader.data,Be,Ee,_a,!0)),A&&(_a*=Va[Be][Pr?"neg":"pos"])));var Pa,Oa=ci?(0,G.AD)(m.categorical.categories,Be,j):void 0;Oe.options.tooltipsEnabled&&(Pa=new Xa.E4).withLazyValues(function(){var vi,ia=[];if(T){var mn=(0,Xa.Q6)(T.sources.map(function(us){return us.metadata}),T.sources.map(function(us){return us.value}),!0,(0,br.F)(j));mn&&ia.push(mn())}ci&&ia.push((0,G.bR)(Oa)),$e&&(!ci||ci.source!==E.values.source)&&ia.push({displayName:E.values.source.displayName,value:(0,St.xq)(H[Ee].name,E.values.source,j)});var or=function(gl){return(0,St.xq)(gl,Mt,j,!1,fa)};if(null!=Da){var os=or(Da),ls=A?"".concat(os," (").concat((0,we.WU)(La,aa),")"):os,Or={displayName:Mt.displayName,value:ls},Nr=nt.tooltips;if(Fi&&!_e&&Nr.show&&Nr.format===xr.K.range){var lr=(0,yi.kS)(Ja,kr,nt,or,C,{overrideDisplayName:Mt.displayName});k.fF.assert(function(){return void 0===lr||1===lr.length},"getUncertaintyTooltipItems() with 'range' format should return exactly one item"),_.isEmpty(lr)||(Or=lr[0])}ia.push(Or)}if(_e){var Rr=void 0;if(null!==yn&&null!==_a){var Ha=(0,we.WU)(_a,aa),zi=(0,St.xq)(yn,Mt,j,!1,nr);Rr=A?"".concat(zi," (").concat(Ha,")"):zi}if(or=function(gl){return(0,St.xq)(gl,Mt,j,!1,nr)},Rr)if(Nr=nt.tooltips,Fi&&Nr.show&&Nr.format===xr.K.range){var ei=(0,yi.kS)(Ja,kr,nt,or,C,{overrideDisplayName:Xa.I6.localizationOptions.highlightedValueDisplayName});k.fF.assert(function(){return void 0===ei||1===ei.length},"getUncertaintyTooltipItems() with 'range' format should return exactly one item"),_.isEmpty(ei)?ia.push({displayName:Xa.I6.localizationOptions.highlightedValueDisplayName,value:Rr}):ia.push(ei[0])}else ia.push({displayName:Xa.I6.localizationOptions.highlightedValueDisplayName,value:Rr})}if(Fi&&nt.tooltips.format!==xr.K.range){var xi=_e?Si:Ja;xi&&ia.push.apply(ia,(0,yi.kS)(xi,Da,nt,or,C,{hideMarker:!0}))}Ba&&null!=Ba.values[Be]&&ia.push({displayName:Ba.source.displayName,value:(0,St.xq)(Ba.values[Be],Ba.source,j,!1,(0,le.NA)(null===(vi=Ba.objects)||void 0===vi?void 0:vi[Be],j))}),(0,Xa.VT)(a.reader,ia,Be,$e?Ee:void 0,j);var fi=a.getTotalTooltip(Ee,Be,Pr,fe,xe,j);return fi&&ia.push(fi),ia});var sr=null!==(h=ve[jt].labelSettings)&&void 0!==h?h:D,Mr={defaultColor:Gt,seriesColor:ua?.fontProperties.color,categoricalDataReader:Oe.reader,categoryIndex:Be,seriesIndex:Ee},di=(0,ut.t$)(Mr),hi={dataPointLabelSettings:sr,defaultLabelSettings:D,categoricalDataReader:Oe.reader,categoryIndex:Be,seriesIndex:Ee,hasHighlights:_e,dynamicLabelsEnabledForSeries:qa,featureSwitches:Oe.options.featureSwitches},Fr=(0,ut.Xc)((0,g.__assign)((0,g.__assign)({},hi),{dataLabelFillColorOptions:Mr,detailPropertyId:me.mi.labels.dynamicLabelDetail,titlePropertyId:me.mi.labels.dynamicLabelTitle})),Vr=(0,ut.tI)((0,g.__assign)((0,g.__assign)({},hi),{valuePropertyId:me.mi.labels.dynamicLabelValue}));if(!Oi&&null!==(v=Oe.options.featureSwitches)&&void 0!==v&&v.labelEnhancementsM0&&!_.isEmpty(Fr)){var $a=Fr&&(null===(y=Fr.find(function(vi){return"Detail"===vi.role}))||void 0===y?void 0:y.dynamicLabel),ns=$a?.enabled&&null!=$a?.value;if(ns){var ao=un(b);(0,ut.hY)(C,ao,Vr?.enabled,ns,sr)}Oi=!0}var Ii=(0,g.__assign)({categoryValue:Ni,position:Ri,categoryIndex:Be,seriesIndex:jt,seriesPosition:Ee,labelSettings:sr,columnStyle:function(){if(a.reader.columns.hasDynamicSeries()||a.reader.columns.hasStaticSeries()||!a.reader.columns.hasCategories()||null==Be)return ir.columnStyle;var vi=a.reader.colors.createBySeries(Ee,Be),ia=a.reader.objects.getCategoryDataObjects(Be);return{fillColor:vi,fillTransparency:(0,le.NA)(ia,me.gE.dataPoint.fillTransparency,a.fillTransparency),border:a.readBorderSettings(ia,a.borderSettings,vi)}}(),selected:!1,originalValue:Da,originalPosition:Ri,labelFill:di.color,dynamicLabelValue:Vr,value:kr,valueAbsolute:La,indexFromZeroValue:Oe.isStacked?jt:0,uncertainty:Ja,identity:rs,key:He,labelFormatString:fa||Mt.format},Oe.options.featureSwitches.labelEnhancementsM0&&{appendedLabelContents:Fr,labelDataPointContainerEnabled:!0});if(null!==(f=re[Be])&&void 0!==f||(re[Be]=wo(Ii,Oa)),re[Be]&&((S=re[Be]).hasData||(S.hasData=null!=Ii.value)),pt.push((0,g.__assign)({get tooltipInfo(){return Pa?.getTooltipItems()},get formattedTooltip(){return Pa?.getFormattedTooltipItems()}},Ii)),_e){var ss=null!==_a?Math.abs(_a):0,bi=Tt.l0.createWithHighlight(rs);pt.push((0,g.__assign)((0,g.__assign)({get tooltipInfo(){return Pa?.getTooltipItems()},get formattedTooltip(){return Pa&&Pa.getFormattedTooltipItems()}},Ii),{value:_a,position:Ch(Ri,kr,_a,La,ss),valueAbsolute:ss,uncertainty:Si,highlight:!0,drawThinner:rt,identity:bi,key:bi.getKey(),pairKey:He,labelFormatString:nr||Mt.format}))}},_r=0;_r<Z;_r++)pn(_r)},Oe=this,sa=0;sa<B;sa++)la(sa);for(var Bt=!1,Ke=!1,Rt=!1,ta=!1,Ka=0,Zt=fe;Ka<Zt.length;Ka++){var I=Zt[Ka];I&&(Bt||(Bt=I.positive>0),Ke||(Ke=I.negative<0),Rt||(Rt=I.net>0),ta||(ta=I.net<0))}return this.hasNetPositive=Rt,this.hasNetNegative=ta,{series:ve,totals:fe,hasPositive:Bt,hasNegative:Ke,hasNetPositive:Rt,hasNetNegative:ta,valuesMetadataBySeries:Ne,categoryIdentities:Ie,hasHighlights:_e,hasDynamicSeries:$e,multipleIdentity:je,categoryData:re}},i.createIdentities=function(e,t,a,r,n,s,o,l,u){var c,d=e.originalCategories||[t],h=Tt.dw.builder().withCategory(d,a,null===(c=t?.source)||void 0===c?void 0:c.queryName,!0).withSeries(e.values,r,!0).withMeasure(s.queryName,n,a);o&&(h=h.withColumnIdentity(o.identity,l,u));var v=h.createSelectionId();return{identity:v,identityKey:v.getKey()}},i.prototype.getTotalTooltip=function(e,t,a,r,n,s){var o,l,u,c,d,h;if(this.options.tooltipsEnabled&&this.options.supportsTotalLabels&&this.totalLabelsSettings.show){if(null!==(o=(c=this.existingTooltips)[t])&&void 0!==o||(c[t]={}),this.totalLabelsSettings.showPositiveAndNegative){var v=a?"negative":"positive";return null!==(l=(d=this.existingTooltips[t])[v])&&void 0!==l||(d[v]={displayName:this.displayNames[v],value:(0,St.xq)(r[t][v],n[e],s,!1)}),this.existingTooltips[t][v]}return null!==(u=(h=this.existingTooltips[t]).net)&&void 0!==u||(h.net={displayName:this.hasNetPositive&&this.hasNetNegative?this.displayNames.net:this.displayNames.simple,value:(0,St.xq)(r[t].net,n[e],s,!1,r[t].dynamicFormatString)}),this.existingTooltips[t].net}},i.prototype.readRibbonSettings=function(e,t){var a=void 0===e,r=a?this.staticObjects:this.reader.objects.getSeriesDataObjects(e),n=a?Pu(this.options.style):this.ribbonBandSettings,s=(0,le.W7)(r,me.gE.ribbonBands.fillColor,n.fillColor),o=(0,le.NA)(r,me.gE.ribbonBands.fillMatchColor,n.fillMatchColor);return o&&t&&(s=t),{fillColor:s,fillMatchColor:o,fillTransparency:(0,le.NA)(r,me.gE.ribbonBands.fillTransparency,n.fillTransparency),border:(0,ya.QI)(r,{strokeShow:me.gE.ribbonBands.borderShow,strokeWidth:me.gE.ribbonBands.borderSize,strokeColor:me.gE.ribbonBands.borderColor,strokeColorMatch:me.gE.ribbonBands.borderColorMatchFill,strokeTransparency:me.gE.ribbonBands.borderTransparency},n.border,s)}},i.prototype.readBorderSettings=function(e,t,a){var r=(0,ya.QI)(e,{strokeShow:me.gE.dataPoint.borderShow,strokeWidth:me.gE.dataPoint.borderSize,strokeColor:me.gE.dataPoint.borderColor,strokeColorMatch:me.gE.dataPoint.borderColorMatchFill,strokeTransparency:me.gE.dataPoint.borderTransparency},t,a);return r.outlineOnly=(0,le.NA)(e,me.gE.dataPoint.borderOutlineOnly,t?.outlineOnly),r},i.prototype.getLegend=function(){var e,t,a,r,n,d,s=[],o=[],l=[],u=!1,c=null===(e=this.options.dataView)||void 0===e?void 0:e.categorical;if(c?.values){for(var h=this.reader.columns.getSeriesCount(N.x.y),v=0;v<h;v++){var y=this.reader.columns.getValueMetadataColumnBySeries(v),f=this.reader.objects.getSeriesDataObjects(v);o.push(y),l.push(f);var p=null!==(t=this.reader.colors.createBySeries(v))&&void 0!==t?t:this.color;s.push({marker:{show:!0,shape:Xt.ZO.circle,color:p,transparency:(0,le.NA)(f,me.gE.dataPoint.fillTransparency,this.fillTransparency),stroke:this.readBorderSettings(f,this.borderSettings,p)},label:this.reader.data.hasSeries()?(0,we.WU)(this.reader.data.getSeriesName(v),this.reader.objects.getSeriesFormatString(v)):(0,St.TO)(y,c.values,N.p.general.formatString),identity:this.reader.data.hasSeries()?this.reader.identities.createForSeries(v):this.reader.identities.createForValue(0),selected:!1,index:v}),void 0!==y.groupName&&(u=!0)}d=null!==(n=null===(r=null===(a=c.values)||void 0===a?void 0:a.source)||void 0===r?void 0:r.displayName)&&void 0!==n?n:""}return{legendData:(0,da.RS)(this.staticObjects,s,!0,d,u,this.options.style,void 0),seriesSources:o,seriesObjects:l}},i.prototype.getValueBySeriesAndCategory=function(e,t){return this.reader.data.getValue("Y",t,e)},i.prototype.getHighlightBySeriesAndCategory=function(e,t){return this.reader.data.getHighlight("Y",t,e)},i.prototype.getFormatStringBySeriesAndCategory=function(e,t){return this.reader.data.getFormatString("Y",t,e)},i.prototype.getHighlightFormatStringBySeriesAndCategory=function(e,t){return this.reader.data.getHighlightFormatString("Y",t,e)},i.valueRoleName=N.x.y,i}();function Ch(i,e,t,a,r){return t>0?i-(a-r):(null===t||0===t)&&e>0?i-a:i}function Nu(i,e,t){for(var a=[],r=0;r<i;r++){for(var n=0,s=0,o=0;o<e;o++){var l=(0,ne.eT)(t(o,r));l>0?n+=l:s-=l}var u=s+n;a[r]={pos:n?n/u/n:1,neg:s?s/u/s:1}}return a}var Ji=R(3665),ki=R(23465),Ot=R(57622),Ru=R(16122),Cr=R(96915),Dh=0,Lh=25;function _h(i){return{type:4,card:[Th.call(this,i.categoryAxisData),Ph.call(this,i.categoryAxisData),kh.call(this),Mh.call(this),Fh.call(this)].filter(function(e){return e})}}function Iu(i,e,t,a){var r=this,n=this.originalData;if(n&&this.dataView){var s=n.series.length,o=this.isClustered&&s>1,l=me.gE.layout;i.addGroup("layout",function(u){u.withDisplayName("Layout"),a?u.withDisabled(a,"perCategory"===t?"Visual_DisabledReason_AllCategoriesOnly_Plural":"Visual_DisabledReason_AllSeriesOnly_Plural"):u.addSimpleSlice("seriesOrderReversed",new F.bd({descriptor:l.seriesOrderReversed,value:n.layout.seriesOrderReversed}).build(),function(c){return c.withDisabled(s<2,"Visual_DisabledReason_MultiSeriesOnly_Singular")}).addSimpleSlice("seriesOrderSorted",new F.bd({descriptor:l.seriesOrderSorted,value:n.layout.seriesOrderSorted}).build(),function(c){return c.withDisabled(s<2,"Visual_DisabledReason_MultiSeriesOnly_Singular")}).addSimpleSlice("innerPadding",Oo(e,r.localizer)).addSimpleSlice("stackedGapSize",new F.JN({descriptor:l.stackedGapSize,value:n.layout.stackedGapSize,options:{minValue:{type:0,value:hh},maxValue:{type:1,value:n.layout.stackedGapExplodes?wu:Du},unitSymbol:n.layout.stackedGapExplodes?qi.t2:qi.e_},localize:r.localizer}).build(),function(c){return c.withHidden(r.isClustered).withDisabled(s<2,"Visual_DisabledReason_MultiSeriesOnly_Singular")}).addSimpleSlice("stackedGapExplodes",new F.bd({descriptor:l.stackedGapExplodes,value:n.layout.stackedGapExplodes}).build(),function(c){return c.withHidden(!r.supportsStackedGapExplode()).withCustomDescription("Visual_Spacing_Explode_Description_".concat(r.isColumn?"Columns":"Bars"))}).addSimpleSlice("clusteredGapSize",new F.JN({descriptor:l.clusteredGapSize,value:n.layout.clusteredGapSize,options:{minValue:{type:0,value:0},maxValue:{type:1,value:n.layout.clusteredGapOverlaps?_u:Lu},unitSymbol:qi.t2},localize:r.localizer}).build(),function(c){return c.withHidden(!o)}).addSimpleSlice("clusteredGapOverlaps",new F.bd({descriptor:l.clusteredGapOverlaps,value:n.layout.clusteredGapOverlaps}).build(),function(c){return c.withHidden(!o)}).addSimpleSlice("clusteredGapOverlapReverse",new F.bd({descriptor:l.clusteredGapOverlapReverse,value:n.layout.clusteredGapOverlapReverse}).build(),function(c){return c.withHidden(!o).withDisabled(!n.layout.clusteredGapOverlaps)})}).build()}}function Ph(){var i=this;if(this.dataView&&!this.isClustered&&!this.isComboChart){var e=this.originalData;if(e&&0!==e.series.length){var a=me.gE.ribbonBands,r=new F.CQ(new F.lg("ribbonChart"),"RibbonChart",[a.show,a.fillMatchColor,a.fillColor,a.fillTransparency,a.borderShow,a.borderColor,a.borderColorMatchFill,a.borderTransparency,a.borderSize,me.gE.layout.ribbonGapSize],this.localizer),n=function(o,l){o.addGroup("layout",function(u){u.withDisplayName("Layout"),l?u.withDisabled(!0,"Visual_DisabledReason_AllSeriesOnly_Plural"):u.addSimpleSlice("ribbonGapSize",new F.JN({descriptor:me.gE.layout.ribbonGapSize,value:e.layout.ribbonGapSize,options:{minValue:{type:0,value:Dh},maxValue:{type:1,value:Lh},unitSymbol:qi.t2},localize:i.localizer}).build())})};return r.withDescription("RibbonChart_Description").addTopLevelToggle("show",function(){var s;return new F.bd({descriptor:a.show,value:null===(s=e.ribbonBands)||void 0===s?void 0:s.show}).build()}),this.hasRibbonBands&&e.ribbonBands&&r.addGroup("applySettingsTo",function(s){s.withContainerDisabled(!1).withDisplayName("Apply_Settings_To").withCollapsible(!1),s.addContainer("series",function(o){o.withDisplayName("Series"),o.addContainerItem("all",i.localizer("All"),function(h){var v={containerBuilder:h,props:a,selector:null,panelGroupType:"allSeries"};Rs.call(i,v,e.ribbonBands),Is.call(i,v,e.ribbonBands.border,"Visual_MatchRibbonColor",!0),n(h)});for(var l=function(v){k.fF.assert(function(){return null!=v.ribbonBands},"series must have ribbonBands for ribbon charts"),o.addContainerItem(v.displayName,v.displayName,function(y){var f={containerBuilder:y,props:a,selector:(0,at.fd)(v.identity.getSelector()),panelGroupType:"perSeries"};Rs.call(i,f,v.ribbonBands),Is.call(i,f,v.ribbonBands.border,"Visual_MatchRibbonColor",!0),n(y,!0)})},u=0,c=e.series;u<c.length;u++)l(c[u])})}),r.build()}}}function Th(i){var e=this,t=this.originalData;if(t&&this.dataView){var a=t.series.length;if(0!==a){var r=me.gE.dataPoint,n=me.gE.layout;return new F.CQ(new F.lg("bars"),this.isColumn?"Role_DisplayName_Columns":"Visual_Bars_Title",[r.fill,r.fillTransparency,r.borderShow,r.borderColor,r.borderColorMatchFill,r.borderTransparency,r.borderSize,r.borderOutlineOnly,n.seriesOrderReversed,n.seriesOrderSorted,n.stackedGapSize,n.stackedGapExplodes,n.clusteredGapSize,n.clusteredGapOverlaps,n.clusteredGapOverlapReverse,N.p.categoryAxis.innerPadding],this.localizer).addGroup("applySettingsTo",function(s){return s.withContainerDisabled(!1).withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(o){o.withDisplayName(a>1?"Series":"Visual_Categories");var l=e.isColumn?"Visual_MatchColumnColor":"Visual_MatchBarColor";o.addContainerItem("all",e.localizer("All"),function(m){var b={containerBuilder:m,props:r,selector:null,panelGroupType:1===t.series.length?"allCategories":"allSeries"};Rs.call(e,b,e.data.columnStyle),Is.call(e,b,t.columnStyle.border,l),Iu.call(e,m,i,b.panelGroupType,!1)});var u=t.series,c="perSeries";if(1===u.length){var d=t.series[0],h=d.data.slice(0,Vo);if(h.length<2)return;var v=zl(h,t);u=_.map(h,function(m,b){var x,C;return(0,g.__assign)((0,g.__assign)({},d),{identity:(null===(C=null===(x=t.categoryIdentities)||void 0===x?void 0:x[m.categoryIndex])||void 0===C?void 0:C.call(x))||m.identity,columnStyle:m.columnStyle,displayName:v[b]})}),c="perCategory"}for(var y=function(b){o.addContainerItem(b.displayName,b.displayName,function(x){var C=(0,at.fd)(b.identity.getSelector());if(C){"perCategory"===c&&t.multipleIdentity&&(C=(0,at.d9)(C),k.fF.assert(function(){return!!C.data},"expect categories to have some data identity"),C.data.unshift((0,mr.Yp)([me.au.rows])));var A={containerBuilder:x,props:r,selector:C,panelGroupType:c};Rs.call(e,A,b.columnStyle),Is.call(e,A,b.columnStyle.border,l),Iu.call(e,x,i,c,!0)}})},f=0,p=u;f<p.length;f++)y(p[f])})}).build()}}}function Rs(i,e){var t=this,r=i.props,n=i.selector,s=i.panelGroupType,o=null==e.fillMatchColor||null==r.fillMatchColor,l="allCategories"===s&&o,u="allSeries"===s&&o;i.containerBuilder.addGroup("colors",function(c){return c.withDisplayName("Generic_Color").addSimpleSlice("fillMatchColor",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},r.fillMatchColor),{selector:n}),value:e.fillMatchColor}).build(),function(d){return d.withHidden(o)}).addSimpleSlice("fillColor",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)((0,g.__assign)((0,g.__assign)({},r.fill||r.fillColor),{selector:(0,g.__assign)((0,g.__assign)({},n),l&&{data:[(0,Cr.Ue)(1)]})}),l&&{altConstantValueSelector:null}),{instanceKind:l?3:1}),value:{value:e.fillColor}}).build(),function(d){return d.withDisabled(u||e.fillMatchColor,u?"Visual_Color_AllSeries_DisabledReason":"")}).addSimpleSlice("fillTransparency",F.JN.getTransparencySliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},r.fillTransparency),{selector:n}),value:e.fillTransparency,localize:t.localizer}).build())})}function Is(i,e,t,a){var r=this,s=i.props,o=i.selector;void 0===a&&(a=!1),i.containerBuilder.addGroup("border",function(l){l.withDisplayName("Visual_Border").addSlices((0,ya.Iq)({containerItemBuilder:l,descriptors:{strokeShow:s.borderShow,strokeColorMatch:s.borderColorMatchFill,strokeColor:s.borderColor,strokeTransparency:s.borderTransparency,strokeWidth:s.borderSize},selector:o,strokeData:e,featureSwitches:r.featureSwitches,localize:r.localizer}).map(function(u){return(0,Sr.cd)(u.getSimpleControlDescriptor(),s.borderColorMatchFill)&&u.withCustomDisplayName(t),u.build()})),a||l.addSimpleSlice("borderOutlineOnly",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},s.borderOutlineOnly),{selector:o}),value:e.outlineOnly}).build(),function(u){var c;return u.withHidden(r.isClustered||null!==o).withDisabled((null===(c=r.originalData)||void 0===c?void 0:c.layout.stackedGapSize)>0,"Visual_Border_OutlineOnly_DisabledReason")})}).build()}function kh(){var e,i=this,t=this.originalData,a=t.dataLabelsSettings,r=t.series.length,n=r>1||!t.categoryMetadata||this.isComboChart,s=t.dataLabelsSettings.position!==Ge.h.outsideEnd,o=Ou(this.columnChartType,r);a.position&&o.indexOf(a.position)<0&&(a.position=Ge.h.auto);var l=(0,g.__assign)((0,g.__assign)({},me.mi.labels),{position:me.mi.labels.labelPosition,precision:me.mi.labels.labelPrecision,displayUnits:me.mi.labels.labelDisplayUnits,labelBackgroundColor:me.mi.labels.backgroundColor,labelBackgroundTransparency:me.mi.labels.backgroundTransparency,showDynamicLabels:me.mi.labels.showDynamicLabels,dynamicLabelValue:me.mi.labels.dynamicLabelValue});this.isColumn||delete l.labelOrientation;var y,u=new F.CQ(new F.lg("labels"),"Visual_DataPointsLabels",l,this.localizer),c=(0,ut.DU)(this.featureSwitches,t.hasDynamicSeries,n,r,this.isComboChart,!0),d=zu.call(this,void 0,a,null,n,o,s,c),h=cn.call(this,!1),v={cardBuilder:u,dataLabelsProps:l,featureSwitches:this.featureSwitches,includeAltConstantValueSelector:!0,hostServices:this.hostService,options:d,individualSelector:h,showEnhancedLabelsFormattingOptions:!0,instanceId:"all"};if(null!==(e=this.featureSwitches)&&void 0!==e&&e.labelEnhancementsM0&&this.dataView){var f=(y=(0,yr.y)(this.dataView)).labels.dynamicLabelReader.getLabelFieldSourceTypes();Object.assign(v,{valueFieldSourceType:f.valueFieldSourceType,detailFieldSourceType:f.detailFieldSourceType,titleFieldSourceType:f.titleFieldSourceType,valueLabelPickerFallbackExpr:(0,ut.WA)(t.valuesMetadataBySeries,r,t.hasDynamicSeries),dataLabelPickerSeriesType:(0,ut.Nb)(r,t.hasDynamicSeries,this.isComboChart)})}return l.show&&u.addTopLevelToggle("show",function(){return new F.bd({descriptor:l.show,value:d.dataLabelsSettings.show}).build()}),u.addGroup("applySettingsTo",function(b){b.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(x){var C,A;if(x.withDisplayName("Series"),x.addContainerItem("all",i.localizer("All"),function(B){return(0,lt.WW)(v,B)}),n)for(var T=0;T<r;T++){var P=t.series[T],D=P.labelSettings?P.labelSettings:t.dataLabelsSettings;D.position&&o.indexOf(D.position)<0&&(D.position=Ge.h.auto);var L=P.identity.getSelector();if(Object.assign(v,{includeAltConstantValueSelector:!1,selector:t.hasDynamicSeries?(0,at.fd)(L):L,individualSelector:cn.call(i,!0),options:zu.call(i,void 0,D,L,void 0,o,s,t.hasDynamicSeries),displayDisabledSlices:(C={},C.labelOverflow=!0,C),instanceId:"sn-".concat(T)}),null!==(A=i.featureSwitches)&&void 0!==A&&A.labelEnhancementsM0){var O=y?y.labels.dynamicLabelReader.getLabelFieldSourceTypes(T):null;Object.assign(v,(0,g.__assign)((0,g.__assign)({},O?{valueFieldSourceType:O.valueFieldSourceType,detailFieldSourceType:O.detailFieldSourceType,titleFieldSourceType:O.titleFieldSourceType}:{}),{valueLabelPickerFallbackExpr:(0,ut.CH)(t.valuesMetadataBySeries,T),dataLabelPickerSeriesType:(0,ut.aC)(r,t.hasDynamicSeries,i.isComboChart)}))}x.addContainerItem(P.displayName,P.displayName,function(B){return(0,lt.WW)(v,B)})}})}),u.build()}function cn(i){return(0,lt.WD)({featureSwitches:this.featureSwitches,hasCategories:null!=_.first(this.originalData.categories),hasDynamicSeries:this.originalData.hasDynamicSeries,hasSeriesSelector:i})}function Mh(){var i,t=this.originalData.totalLabelsSettings;if(t&&!this.isClustered&&!this.isStacked100){var a=(0,g.__assign)((0,g.__assign)({},me.mi.totals),{precision:me.mi.totals.labelPrecision,displayUnits:me.mi.totals.labelDisplayUnits}),r=new F.CQ(new F.lg("totals"),"Visual_DataTotalLabels",a,this.localizer);if(!this.supportsTotalLabels()){var n=!(null===(i=this.data)||void 0===i||!i.multipleIdentity);return r.withDisabled(!0,n?"Visual_Totals_DisabledReason_SmallMultiples":"Visual_Totals_DisabledReason"),r.addTopLevelToggle("show",function(){return new F.bd({descriptor:a.show,value:!1}).build()}),r.build()}return(0,lt.XQ)({cardBuilder:r,dataLabelsProps:a,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:Vh.call(this,void 0,t),individualSelector:cn.call(this,!1),showEnhancedLabelsFormattingOptions:!1,instanceId:"all"})}}function Fh(){var i=this;if(!this.isStacked){var e=this.originalData;if(e&&e.series&&0!==e.series.length)return new F.CQ(new F.lg("errorBars"),"Visual_Error_Bars",qe.Qx,this.localizer,!0,!0).addGroup("applySettingsTo",function(t){return t.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("measure",function(a){a.withDisplayName("Series");for(var r=function(u){var c=_.first(u.usedInSeriesIndices);if(k.fF.assertValue(c,"lineChart - measure is not associated with any series"),null!=c&&null!==e.series[c]){var d=u.valueSelector.getSelector();a.addContainerItem(u.metadataColumn.queryName,u.metadataColumn.displayName,function(h){return(0,Ru.f)({localize:i.localizer,uncertainty:e.series[c].uncertainty,targetMeasure:u.metadataColumn.expr,measureSelector:d,dataPointSelector:(0,g.__assign)((0,g.__assign)({},d),{data:[(0,Cr.Ue)()],highlightMatching:1}),featureSwitches:i.featureSwitches,uncertaintyOptions:{isCombo:i.isComboChart,hideBand:!0}},h)})}},n=0,s=e.valuesMetadataBySeries;n<s.length;n++)r(s[n])})}).build()}}function zu(i,e,t,a,r,n,s){var o,l=!!t;return{enumeration:i,dataLabelsSettings:e,show:!0,position:!_.isEmpty(r),positionObject:r,labelOrientation:!this.isBar&&!l,displayUnits:!this.isStacked100,precision:!0,selector:t,showAll:a,fontSize:!0,fontFamily:!0,labelDensity:null===(o=this.data)||void 0===o?void 0:o.isScalar,labelOverflow:!l&&n,enableBackground:e.enableBackground,backgroundColor:e.backgroundColor,backgroundTransparency:e.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0,enableDynamicLabelPickers:!s,isStacked100:this.isStacked100}}function Vh(i,e){return{enumeration:i,dataLabelsSettings:e,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,showPositiveAndNegative:!0,enableBackground:e.enableBackground,backgroundColor:e.backgroundColor,backgroundTransparency:e.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}}function Oh(i){var a,r,t=_.first(i).visualObjects;if(t.length>0){a=t[0],a?.selectorsByColumn&&(r=(0,at.fd)((0,at.tV)(a.selectorsByColumn)));var n=1===this.data.series.length;switch(a.objectName){case"columns":return n&&this.data.categoryMetadata&&!this.data.hasDynamicSeries&&(r={data:[(0,Cr.Ue)(1)]}),(0,Pt.w3)(this.hostService,(0,g.__assign)((0,g.__assign)({},me.gE.dataPoint.borderColor),{selector:r}),(0,g.__assign)((0,g.__assign)({},me.gE.dataPoint.fill),{selector:r}),this.hostService.getLocalizedString("Visual_Border"));case"ribbon":return n&&this.data.categoryMetadata&&!this.data.hasDynamicSeries&&(r={data:[(0,Cr.Ue)(1)]}),(0,Pt.w3)(this.hostService,(0,g.__assign)((0,g.__assign)({},me.gE.ribbonBands.borderColor),{selector:r}),(0,g.__assign)((0,g.__assign)({},me.gE.ribbonBands.fillColor),{selector:r}),this.hostService.getLocalizedString("Visual_Border"));case"data-labels":var s=this.data.series.find(function(d){var h;return(0,at.Ic)(null===(h=d?.identity)||void 0===h?void 0:h.getSelectorsByColumn(),a.selectorsByColumn)});if(!s)return;var o=me.mi.labels,l=n?void 0:r,u={fontFamilyReference:(0,g.__assign)((0,g.__assign)({},o.fontFamily),{selector:l}),fontSizeReference:(0,g.__assign)((0,g.__assign)({},o.fontSize),{selector:l}),boldReference:(0,g.__assign)((0,g.__assign)({},o.bold),{selector:l}),italicReference:(0,g.__assign)((0,g.__assign)({},o.italic),{selector:l}),underlineReference:(0,g.__assign)((0,g.__assign)({},o.underline),{selector:l}),fontColorReference:(0,g.__assign)((0,g.__assign)({},o.color),{selector:l}),displayUnitsReference:(0,g.__assign)((0,g.__assign)({},o.labelDisplayUnits),{selector:l}),precisionReference:(0,g.__assign)((0,g.__assign)({},o.labelPrecision),{selector:l}),backgroundReference:(0,g.__assign)((0,g.__assign)({},o.backgroundColor),{selector:l})};return(0,Pt.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:n,individualSelector:cn.call(this,!n),selector:r,repetitionSelector:void 0,subSelectionStylesOptions:{precision:{defaultPrecision:this.getLabelUnitsAndPrecision().getPrecision(!1,s.type)}}},u);case"total-labels":var c=me.mi.totals;return(0,Pt.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:n,individualSelector:cn.call(this,!n),selector:r,repetitionSelector:void 0},{fontFamilyReference:c.fontFamily,fontSizeReference:c.fontSize,boldReference:c.bold,italicReference:c.italic,underlineReference:c.underline,fontColorReference:(0,g.__assign)((0,g.__assign)({},c.color),{selector:(0,ut.hm)(cn.call(this,!1),void 0,void 0)}),displayUnitsReference:c.labelDisplayUnits,precisionReference:c.labelPrecision,backgroundReference:c.backgroundColor});default:return}}}function Nh(i,e){if(!e){var r,a=_.first(i).visualObjects;if(!(a.length>0))return;r=a[0];var s,n=!this.showLabelPerSeries();!n&&!_.isEmpty(r.selectorsByColumn)&&(s=(0,at.fd)((0,at.tV)(r.selectorsByColumn)));var o=n?me.mi.labels.show:me.mi.labels.showSeries;switch(r.objectName){case"columns":case"ribbon":var l="ribbon"===r.objectName,u=(0,g.__assign)({},l?me.gE.ribbonBands.fillColor:me.gE.dataPoint.fill),c=[{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},u),{selector:this.data.series.length>1?s:void 0}),label:this.localizer(l?"Format_Ribbon":this.isBar?"Format_Bars":"Format_Columns")}];return this.supportsTotalLabels()&&c.unshift((0,g.__assign)((0,g.__assign)({type:2},me.mi.totals.show),{enabledLabel:this.localizer("Format_AddTotalLabels")})),c.unshift({type:0,excludedResetFormattingIds:[me.mi.totals.show,(0,g.__assign)((0,g.__assign)({},o),{selector:s})]},(0,g.__assign)((0,g.__assign)({type:2},o),{enabledLabel:this.localizer("Format_AddDataLabels"),selector:s})),c;default:return}}}function Rh(i){switch(d3.select(i).attr(U.Ez)){case"columns":var t=d3.select(i).datum();return Eu.call(this,t.seriesIndex);case"ribbon":return t=d3.select(i).datum(),Eu.call(this,t.d1.seriesIndex);case"data-labels":case"series-labels":var r=(0,ut.wT)(i,this.data.series);if(r)return r;default:return}}function Eu(i){var e,t=this.data.series;if(!_.isEmpty(t)&&i>=0){var a=t[i];return null===(e=a?.identity)||void 0===e?void 0:e.getSelectorsByColumn()}}function Ih(i,e){var t=[];if(this.featureSwitches.onObject&&1===e){var a=this.isComboChart?Qi.OA:me.mi,r=this.data.series.map(function(s){var o;return{selector:s.identity.getSelector(),value:null===(o=s.labelSettings)||void 0===o?void 0:o.show}}),n=[Ji.v.create(a.labels.backgroundColor,this.data.dataLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(a.labels.enableBackground,!0,{inheritSelector:!0})),ki.$.create(a.labels.backgroundColor,this.data.dataLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(a.labels.enableBackground,!0)),Ji.v.create(a.labels.showSeries,this.data.dataLabelsSettings.show,r).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(a.labels.showByDefault,!1),Ot.W.createBooleanDataViewObjectChange(a.labels.show,!0)).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("labels")),ki.$.create(a.labels.show,this.data.dataLabelsSettings.show).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("labels")),ki.$.create(a.totals.backgroundColor,this.data.totalLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(a.totals.enableBackground,!0)).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("totals")),Ji.v.create(me.gE.dataPoint.borderColor,this.data.columnStyle.border.strokeShow).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(me.gE.dataPoint.borderShow,!0,{inheritSelector:!0,required:!0}))];t=(0,g.__spreadArray)((0,g.__spreadArray)([],t,!0),ie.o.getDataViewObjectsBehaviorChanges(i,n),!0)}return t}var za=R(51995),Ma=R(64067),dn=R(80758),zh=function(){function i(e){k.fF.assert(function(){return e.columnWidth>0},"Columns should have a width"),k.fF.assert(function(){return e.categoryWidth>0},"Categories should have a width"),this.categoryAxisScale=e.categoryAxisScale,this.categoryWidth=e.categoryWidth,this.columnWidth=e.columnWidth,this.dataPoints=e.dataPoints,this.hasCategories=e.hasCategories,this.isBar=e.isBar,this.isClustered=e.isClustered,this.isScalar=e.isScalar,this.seriesLength=e.seriesLength}return i.prototype.queryRegion=function(e){var n,s,o,l,t=this,a=[],r=e.dataSpace;return(this.isScalar||this.hasCategories&&!_.some([r.bottom,r.left,r.right,r.top],function(u){return void 0===u}))&&(this.isBar?(this.isScalar?(n=r.bottom.value,s=r.top.value):(n=this.getAdjustedCategoryIndex(r.top.value,r.top.seriesIndex,this.seriesLength),s=this.getAdjustedCategoryIndex(r.bottom.value,r.bottom.seriesIndex,this.seriesLength)),o=r.left.value,l=r.right.value):(this.isScalar?(n=r.left.value,s=r.right.value):(n=this.getAdjustedCategoryIndex(r.left.value,r.left.seriesIndex,this.seriesLength),s=this.getAdjustedCategoryIndex(r.right.value,r.right.seriesIndex,this.seriesLength)),o=r.bottom.value,l=r.top.value),a=_.filter(this.dataPoints,function(u){return 0!==u.valueAbsolute&&n<=s&&o<=l&&(0,dn.WN)(n,s,t.getAreaCategoryBound(u,!1),t.getAreaCategoryBound(u,!0))&&(0,dn.WN)(o,l,t.getAreaValueLowerBound(u),t.getAreaValueUpperBound(u))})),a},i.prototype.getAreaValueLowerBound=function(e){return this.isClustered?Math.min(0,e.value):e.position-e.valueAbsolute},i.prototype.getAreaValueUpperBound=function(e){return this.isClustered?Math.max(0,e.value):e.position},i.prototype.getAreaCategoryBound=function(e,t){if(this.isScalar){this.isBar&&(t=!t);var a=t?this.columnWidth:0,r=this.isClustered?e.seriesIndex:0,n=this.categoryAxisScale(e.categoryValue)-this.categoryWidth/2;return Xe(this.categoryAxisScale,n+r*this.columnWidth+a,0,0,void 0).value}return this.getAdjustedCategoryIndex(e.categoryIndex,e.seriesIndex,this.seriesLength)},i.prototype.getAdjustedCategoryIndex=function(e,t,a){return this.isClustered?(k.fF.assert(function(){return void 0!==t},"Series index should be present when getting adjusted category index for a clustered chart."),e*a+t):e},i}(),Bu=(0,Me.CH)("ribbonChartLayer"),Hu=(0,Me.CH)("ribbonChartDefs"),Yo=(0,Me.CH)("ribbonChartSeries"),Xo=(0,Me.CH)("ribbonChartDataPoint");function Eh(i,e){var t=this,a=this.drawColumns(!i),r=this.data,n=this.xAxisProperties.isCategoryAxis&&0===this.xAxisProperties.innerPaddingRatio||this.yAxisProperties.isCategoryAxis&&0===this.yAxisProperties.innerPaddingRatio;this.mainGraphicsContext.attr("height",this.availableHeight).attr("width",this.availableWidth).classed("withCrispEdges",n);var s=function(){return t.mainGraphicsContext.selectAll(Xo.selector)};this.tooltipsEnabled&&!e?(this.tooltipService.addTooltip(a.eventGroup,function(v){var y;return null===(y=v.data)||void 0===y?void 0:y.tooltipInfo},function(v){var y;return(null===(y=v.data)||void 0===y?void 0:y.identity)&&[v.data.identity]}),this.hasRibbonBands&&this.tooltipService.addTooltip(s(),function(v){var y;return null===(y=v.data)||void 0===y?void 0:y.tooltipInfo},function(){return[Tt.l0.createNull()]})):(this.tooltipService.removeTooltips(a.eventGroup),this.hasRibbonBands&&this.tooltipService.removeTooltips(s()));var l,u,o=[];if(this.interactivityService){for(var c=0,d=r.series;c<d.length;c++)o=o.concat(d[c].data);l={datapoints:o,columnChartDrawInfo:a,hasHighlights:r.hasHighlights,root:this.mainGraphicsContext,showLabel:r.dataLabelsSettings.show,visualInstanceId:this.hostService.instanceId,hitTester:new zh({dataPoints:o,isScalar:r.isScalar,hasCategories:!!r.categoryIdentities&&r.categoryIdentities.length>0,isBar:this.isBar,isClustered:this.isClustered,categoryAxisScale:this.categoryAxis.scale,columnWidth:this.columnWidth,categoryWidth:this.categoryWidth,seriesLength:r.series.length}),useManagedTabIndex:this.useManagedTabIndex,ribbonSeriesSelection:this.mainGraphicsContext.selectAll(Yo.selector),style:this.style},u={navigationStrategy:r.series.length>1?Y.jN.CategoryFirst:Y.jN.CategoryOnly,helper:this}}return this.isMobileInteractiveLegend()&&Bh.call(this,!0),(0,Et.bL)(this.animationOptions),{dataPoints:o,behaviorOptions:l,navigationOptions:u,labelDataPoints:[],labelDataPointGroups:a.labelDataPointGroups,labelsAreNumeric:!0,labelOrientation:r.dataLabelsSettings.labelOrientation,animateLabels:a.animateLabels,categorySubRangeCount:this.isClustered?this.data.series.length:1,verticalCategoryAxis:this.isBar}}function Bh(i){void 0===i&&(i=!1);var t=void 0===this.lastInteractiveSelectedColumnIndex?fs(this.data.series):this.lastInteractiveSelectedColumnIndex;this.selectColumn(t,i)}function Wh(){var i=this;(0,Wn.H4)(this.mainGraphicsContext,this.data.strokeSettings);var e=this.mainGraphicsContext.selectAll(Zn.selector);if(this.usesUngroupedRenderer()){var t=_.flatten(this.activeData.series.map(function(a){return a.data}));return t.sort(function(a,r){var n=(a.highlight?1:0)-(r.highlight?1:0);if(n)return n;var s=a.seriesPosition-r.seriesPosition;return i.activeData.layout.clusteredGapOverlapReverse&&(s*=-1),s}),e.data([{data:t}],function(a){return"*"}).join(function(a){return a.append("g").classed(Zn.class,!0)})}return e.data(this.activeData.series,function(a){return a.key}).join(function(a){return a.append("g").classed(Zn.class,!0)}).styles({fill:function(r){return r.columnStyle.fillColor},"stroke-width":function(r){return $t.size(r.columnStyle.border,i.style)},stroke:function(r){return $t.color(r.columnStyle.border,i.style)}}).attr("role","listbox").attr("aria-label",function(a){return a.displayName})}var $t={opacity:function(e,t,a){return(0,Ma.TD)(t.isHighContrast?0:e.strokeTransparency)*(a?Vt.eU:1)},size:function(e,t){return t.isHighContrast?null:e.strokeShow?2*e.strokeWidth:0},color:function(e,t){return t.isHighContrast?null:e.strokeColor},optimized:function(e,t){return e===t?null:e},rectClipPath:function(e,t,a){var r;return null!==(r=e.columnStyle.border)&&void 0!==r&&r.strokeShow&&!t.isHighContrast?"".concat(a?"fill-box ":"","inset(0px)"):null},strokePattern:function(e,t,a,r){var n;if(null===(n=e.columnStyle.border)||void 0===n||!n.outlineOnly||e.highlight)return null;var s=a?[!1,!0,!1,!0]:[!0,!1,!0,!1],o=s[0],l=s[1],u=s[2],c=s[3],d=function(){a?o=!0:l=!0},h=function(){a?u=!0:c=!0};e.indexFromBottom===e.countOfPointsInCategory-1?r?h():d():0===e.indexFromBottom&&(r?d():h());var v=t.shapeLayout.width(e),y=t.shapeLayout.height(e),f="",p=function(m,b){f+=m?"".concat(b," 0 "):"0 ".concat(b," ")};return p(o,v),p(l,y),p(u,v),p(c,y),f}};function Uh(i){var e=this,t=this.activeData,a=this.style,r=function(i,e,t,a){void 0===a&&(a=!1);var r=e.selectAll(i.CS.selector).data(function(s){return a?_.filter(s.data,function(o){return!!o.value}):s.data},function(s){return s.key}),n=r.enter().append("rect").classed(i.CS.class,!0).classed("highlight",function(s){return!!s.highlight}).styles({"clip-path":function(o){return $t.rectClipPath(o,i.style,!1)},"-webkit-clip-path":function(o){return $t.rectClipPath(o,i.style,!0)}});return i.featureSwitches.onObject&&n.classed(U.cy,!0).attr(U.Ez,"columns").attr(U.QZ,3).each(function(s,o,l){U.O5.setDataForElement(l[o],{outlineRestrictionOptions:{margin:i.scaledMargin},getDisplayName:function(){return i.hostService.getLocalizedString(i.isBar?"MiniToolbar_Bars":"MiniToolbar_Columns",t.series[s.seriesIndex].displayName)}})}),{newShapes:n,updatedShapes:r.merge(n).style("fill",function(s){return s.columnStyle.fillColor!==t.series[s.seriesIndex].columnStyle.fillColor||i.usesUngroupedRenderer()?s.columnStyle.fillColor:null}).attr("aria-hidden",function(s){return!!s.highlight||null}).order(),removedShapes:r.exit()}}(this,i,t,!this.animator),n=r.updatedShapes,s=r.removedShapes;return n.interrupt(),this.interactivityService&&n.attrs({tabindex:0,focusable:!0,role:"option","aria-selected":function(l){return l.selected},"aria-label":function(l){return null!=l.value?l.value:"null"},"data-automation-type":"column-chart-rect"}).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()),this.usesUngroupedRenderer()?n.styles({"stroke-width":function(l){return $t.size(l.columnStyle.border,a)},stroke:function(l){return $t.color(l.columnStyle.border,a)},fill:function(l){return t.series[l.seriesIndex].columnStyle.fillColor}}):n.styles({"stroke-width":function(l){return $t.optimized($t.size(l.columnStyle.border,a),$t.size(t.series[l.seriesIndex].columnStyle.border,a))},stroke:function(l){return $t.optimized($t.color(l.columnStyle.border,a),$t.color(t.series[l.seriesIndex].columnStyle.border,a))}}),n.styles({"stroke-dasharray":function(l){return $t.strokePattern(l,e.layout,e.isColumn,e.valueAxis.invertAxis)},"clip-path":function(l){return $t.rectClipPath(l,a,!1)},"-webkit-clip-path":function(l){return $t.rectClipPath(l,a,!0)}}).attrs({"aria-setsize":t.dataPointsCount,"aria-posinset":function(l){return l.posinset}}),function(i,e,t){i.attrs({width:e.width,height:e.height,x:e.x,y:e.y}).styles({"fill-opacity":t?function(a){var r;return function(i,e,t){return(0,Vt.eR)(i.selected,i.highlight,e,t,(0,Ma.TD)(i.columnStyle.fillTransparency))}(a,null===(r=t.interactivityService)||void 0===r?void 0:r.hasSelection(),t.chart.activeData.hasHighlights)}:0,"stroke-opacity":t?function(a){var r;return $t.opacity(a.columnStyle.border,t.chart.style,(t.chart.activeData.hasHighlights||(null===(r=t.interactivityService)||void 0===r?void 0:r.hasSelection()))&&!a.highlight)}:0})}(n,this.layout.shapeLayout,{chart:this,interactivityService:this.interactivityService}),s.remove(),n}function Yh(i){var u,c,d,h,v,e=i.isBar,t=i.valueAxisProps,a=i.layout,r=i.columnWidth,n=i.interactivityService,s=this.activeData,l=s.hasHighlights;if(void 0!==t&&(c=_.filter(s.series,function(j){return j.uncertainty.renderUncertainty}),u=!_.isEmpty(c)),u){var b,x,C,y=n?.hasSelection(),f=r/2,p=t.scale.range(),S=t.scale,m=void 0;if(e){var A=function(H){return a.shapeLayout.y(H)+f-(H.drawThinner?f/2:0)};m=function(H){return"translate(".concat(S(H.value),", ").concat(A(H),")")},b=d3.line().x(a.uncertaintyLayout.lower).y(A),x=d3.line().x(a.uncertaintyLayout.upper).y(A),C=p[1]<p[0]}else{var T=function(H){return a.shapeLayout.x(H)+f-(H.drawThinner?f/2:0)};m=function(H){return"translate(".concat(T(H),", ").concat(S(H.value),")")},b=d3.line().x(T).y(a.uncertaintyLayout.lower),x=d3.line().x(T).y(a.uncertaintyLayout.upper),C=p[1]>p[0]}b.defined(function(j){var H;return null!=(null===(H=j?.uncertainty)||void 0===H?void 0:H.lower)&&(!l||j.highlight)}),x.defined(function(j){var H;return null!=(null===(H=j?.uncertainty)||void 0===H?void 0:H.upper)&&(!l||j.highlight)});var P=(0,Jt.B9)(this.mainGraphicsContext);d=(0,Jt.FZ)(P,c,function(j){return S},m,Math.min(10,r-2),l,y);var D=_.filter(c,function(j){return j.uncertainty.markers.show});if(_.isEmpty(D))P.selectAll(Jt.YU.selector).remove();else{var L=new za.Wo,O=this.mainGraphicsContext.selectAll("defs").data([1]).join("defs").attr("class",Jt.Ok.class),B=[];u&&(0,Jt.iD)(D,B),L.ensureMarkers(O,B);var E=(0,Jt.di)(P,c,x,b,C,L,y,l);h=P.selectAll(Jt.E6.selector),(v=function(H,Z){(0,Jt.xl)(E,x,b,C,L,H,Z)})(y,l)}}else(0,Jt.OY)(this.mainGraphicsContext);return{bars:d,markerPaths:h,updateActiveHighlightMarkers:v}}function qh(i,e){var t=this,a=this.style,r=this.scaledMargin,n=this.ribbonGapSize,s=this.layout,o=this.mainGraphicsContext,l=this.isColumn,u=this.interactivityService,c=this.hostService,d=this.hasRibbonBands?this.activeData.series:[],h=.7;i&&(i=null!=e);var v=function(C){var A=function(i,e,t,a){var f,p,S,m,r=i.shapeLayout,n=e.d1,s=e.d2,o=r.x(n),l=r.y(n),u=r.width(n),c=r.height(n),d=r.x(s),h=r.y(s),v=r.width(s),y=r.height(s);if(a){var b=o+u+t,x=d-t;f={x:b,y:l},p={x:b,y:l+c},S={x,y:h},m={x,y:h+y}}else{var C=l-t,A=h+y+t;f={x:o,y:C},p={x:o+u,y:C},S={x:d,y:A},m={x:d+v,y:A}}return{bottomLeft:f,topLeft:p,bottomRight:S,topRight:m}}(s,C,n,l),T=d3.interpolateNumber(A.bottomLeft.x,A.bottomRight.x),P=d3.interpolateNumber(A.bottomLeft.y,A.bottomRight.y),D="M".concat(A.bottomLeft.x,",").concat(A.bottomLeft.y);return D+=l?"C".concat(T(h),",").concat(A.bottomLeft.y," ").concat(T(1-h),",").concat(A.bottomRight.y," ").concat(A.bottomRight.x,",").concat(A.bottomRight.y):"C".concat(A.bottomLeft.x,",").concat(P(h)," ").concat(A.bottomRight.x,",").concat(P(1-h)," ").concat(A.bottomRight.x,",").concat(A.bottomRight.y),D+="L".concat(A.topRight.x,",").concat(A.topRight.y),T=d3.interpolateNumber(A.topRight.x,A.topLeft.x),P=d3.interpolateNumber(A.topRight.y,A.topLeft.y),(D+=l?"C".concat(T(h),",").concat(A.topRight.y," ").concat(T(1-h),",").concat(A.topLeft.y," ").concat(A.topLeft.x,",").concat(A.topLeft.y):"C".concat(A.topRight.x,",").concat(P(h)," ").concat(A.topLeft.x,",").concat(P(1-h)," ").concat(A.topLeft.x,",").concat(A.topLeft.y))+"L".concat(A.bottomLeft.x,",").concat(A.bottomLeft.y,"Z")},y=o.select(Bu.selector);y.empty()&&(y=o.append("g").classed(Bu.class,!0));var f=o.select(Hu.selector);f.empty()&&(f=o.append("defs").classed(Hu.class,!0));var p=function(C){return"".concat(c.instanceId,"-").concat(C.d1.categoryIndex,"-").concat(C.d1.seriesIndex)},S=f.selectAll("clipPath").data(_.flatMap(d,function(x){var C,A;return null!==(C=x.ribbonBands)&&void 0!==C&&C.border.strokeShow?null===(A=x.ribbonBands)||void 0===A?void 0:A.dataPoints:[]}),p),m=S.enter().append("clipPath").attr("id",p);m.append("path");var b=m.merge(S).select("path");(i?b.transition().duration(e.getDuration()):b.interrupt()).attr("d",v),S.exit().remove(),y.selectAll(Yo.selector).data(d,function(x){return x.key}).join(function(x){return x.append("g").classed(Yo.class,!0)}).styles({fill:function(C){return a.isHighContrast?a.colorPalette.backgroundNeutral.value:C.ribbonBands.fillColor},"fill-opacity":function(C){return function(i,e){return(0,Ma.TD)(i.fillTransparency)*(e?Vt.eU:Vt.Ko)}(C.ribbonBands,u?.hasSelection())},stroke:function(C){return $t.color(C.ribbonBands.border,a)},"stroke-width":function(C){return $t.size(C.ribbonBands.border,a)},"stroke-opacity":function(C){return $t.opacity(C.ribbonBands.border,a,u?.hasSelection())}}).each(function(x,C,A){k.fF.assert(function(){return void 0!==x.ribbonBands},"ribbonBands must be defined.");var T=x.ribbonBands.dataPoints;k.fF.assert(function(){return void 0!==T},"dataPoints must be defined.");var P=d3.select(A[C]).selectAll(Xo.selector).data(T,function(D){var L;return null!==(L=D.d1.pairKey)&&void 0!==L?L:D.d1.key}).join(function(D){return D.append("path").classed(Xo.class,!0)}).style("clip-path",function(D){return x.ribbonBands.border.strokeShow&&!a.isHighContrast?"url(#".concat(p(D),")"):null});t.featureSwitches.onObject&&P.classed(U.cy,!0).attr(U.Ez,"ribbon").attr(U.QZ,3).each(function(){U.O5.setDataForElement(this,{outlineRestrictionOptions:{margin:r},getDisplayName:function(){return c.getLocalizedString("MiniToolbar_Ribbon",x.displayName)},getRegionOutlines:function(){return[]}})}),(i?P.transition().duration(e.getDuration()):P.interrupt()).attr("d",v)})}var Qh=function(i){function e(t){var a=i.call(this,t)||this;return a.options=t,k.fF.assertValue(t.columnChartType,"columnChartType"),a}return(0,g.__extends)(e,i),Object.defineProperty(e.prototype,"columnChartType",{get:function(){return this.options.columnChartType},enumerable:!1,configurable:!0}),e.prototype.initRenderer=function(t){i.prototype.initRenderer.call(this,t),this.svg.classed(e.ClassName,!0),this.unclippedGraphicsContext=this.svg.append("g").classed("columnChartUnclippedGraphicsContext",!0),this.mainGraphicsContext=this.unclippedGraphicsContext.append("svg").classed("mainGraphicsContext",!0),this.useManagedTabIndex=t.useManagedTabIndex,this.interactivityService&&(this.mainGraphicsContext.attrs({"aria-label":this.localizer("Visual_Plot"),"data-automation-type":"mainGraphicsContext",role:"group"}).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()),t.useManagedTabIndex?(this.mainGraphicsContext.classed(Ts.rG.class,!0),this.mainGraphicsContext.attr(Yn.Rh,!0)):this.mainGraphicsContext.attrs({tabindex:0,focusable:!0}))},Object.defineProperty(e.prototype,"isBar",{get:function(){return Kn(this.columnChartType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isColumn",{get:function(){return jo(this.columnChartType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStacked",{get:function(){var a;return ln(this.columnChartType,null===(a=this.data)||void 0===a?void 0:a.series.length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStacked100",{get:function(){return un(this.columnChartType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClustered",{get:function(){return Uo(this.columnChartType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRibbonBands",{get:function(){var a;return(null===(a=this.data.ribbonBands)||void 0===a?void 0:a.show)&&!this.isComboChart},enumerable:!1,configurable:!0}),e.prototype.isYCategorical=function(){return this.isBar},e.sliceSeries=function(t,a,r){void 0===r&&(r=0);var n=[];if(t&&t.length>0)for(var s=0,o=t.length;s<o;s++)n[s]=(0,be.ED)(t[s]),n[s].data=t[s].data.filter(function(l){return l.categoryIndex>=r&&l.categoryIndex<a});return n},e.getInteractiveColumnChartDomElement=function(t){return t.children("svg").get(0)},e.prototype.setData=function(t,a){k.fF.assertValue(t,"dataViews");var n=Fu(this.style,this.isStacked100);if(this.data=this.originalData={categories:[],categoryFormatter:null,series:[],totals:[],valuesMetadata:[],categoryData:[],legendData:null,hasHighlights:!1,categoryMetadata:null,isScalar:!1,dataLabelsSettings:n,titleDataLabelsSettings:n,detailDataLabelsSettings:n,seriesLabelSettings:Hn(this.style),hasDynamicSeries:!1,columnStyle:{fillColor:void 0,fillTransparency:0,border:Ns(this.style)},layout:mi,ribbonBands:(0,g.__assign)({show:!1},Pu(this.style))},t.length>0){var s=this.dataView=t[0];if(s&&s.categorical){var o=s.categorical.categories,u=Ut(o&&o.length>0?o[0].source:null),c=(0,oe.n$)(s),d=(0,xt.PX)(s.metadata?s.metadata.objects:null,N.p.categoryAxis.axisType,u,void 0,c);this.converter=xh.create({dataView:s,style:this.style,isScalar:d,multipleInfo:a,chartType:this.columnChartType,interactivityService:this.interactivityService,tooltipsEnabled:this.tooltipsEnabled,hostServices:this.hostService,isComboChart:this.isComboChart,supportsTotalLabels:!a&&this.supportsTotalLabels(),featureSwitches:this.featureSwitches}),this.data=this.originalData=this.converter.convert()}}},e.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},e.prototype.getSeriesLabelsSettings=function(){return(0,be.ED)(this.data).seriesLabelSettings},e.prototype.getFormattingCards=function(t){return _h.call(this,t)},e.prototype.getSubSelectionStyles=function(t){return Oh.call(this,t)},e.prototype.getSubSelectionShortcuts=function(t,a){return Nh.call(this,t,a)},e.prototype.getSelectorsByColumnFromSubselectedElement=function(t){return Rh.call(this,t)},e.prototype.getDataViewObjectLayerChanges=function(t,a){return Ih.call(this,t,a)},e.prototype.showSeriesCard=function(){return!(this.isComboChart&&!this.data.hasY2Role)},e.prototype.showLabelPerSeries=function(){var t=this.originalData;return t.series.length>1||!t.categoryMetadata||this.isComboChart},e.prototype.calculateAxesProperties=function(t){var a,r,n,s,o,l,u,c,d;this.updateCurrentViewport(t);var h=null!==(n=null===(r=null===(a=this.data)||void 0===a?void 0:a.categories)||void 0===r?void 0:r.length)&&void 0!==n?n:0,v=this.data?Ua({data:this.data,availableWidth:Math.max(0,this.isBar?this.availableHeight:this.availableWidth),categoryCount:h,preferredCategoryWidth:null!==(o=null===(s=this.data)||void 0===s?void 0:s.preferredCategoryWidth)&&void 0!==o?o:null,domain:null===(u=bt(this.data.series,Ut(null===(l=this.data)||void 0===l?void 0:l.categoryMetadata),this.getVisualCategoryAxisIsScalar(),[t.categoryAxisOptions.includeDomain]))||void 0===u?void 0:u.domain,isScalar:this.getVisualCategoryAxisIsScalar(),cartesianOptions:this.options,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio,axisZoom:t.axisZoom}):Er(),y=this.adjustLayoutForScroll(this.data,h,t.trimOrdinalDataOnOverflow,v);this.updateCategoryLayout(v);var f=this.createCategoryAxis(t),p=this.createValueAxis(t),S=(null===(c=y.totalLabelsSettings)||void 0===c?void 0:c.show)&&this.supportsTotalLabels(),m=(null===(d=y.dataLabelsSettings)||void 0===d?void 0:d.show)&&this.isClusteredOptimized;if(S||m){var b=ga(Yt(this.adjustDomainForLabels(p),0,[!0,!0]),t.valueAxisOptions.includeDomain,Yt(p.scale.domain(),0));p=this.createValueAxis(t,b,!0)}return[this.isBar?p:f,this.isBar?f:p]},e.prototype.setAxesLayout=function(t){var a,r,n;this.updateCurrentViewport(t.layout),this.xAxisProperties=t.layout.axes.x,this.yAxisProperties=t.layout.axes.y1;var s=this.data?{categoryCount:_.isEmpty(this.categoryAxis.categoryIdentities)?0:this.categoryAxis.categoryIdentities.length,categoryThickness:this.categoryAxis.categoryThickness,outerPaddingRatio:this.categoryAxis.outerPaddingRatio,innerPaddingRatio:this.categoryAxis.innerPaddingRatio,isScalar:this.getVisualCategoryAxisIsScalar()}:Er();this.data=this.adjustLayoutForScroll(this.data,null!==(n=null===(r=null===(a=this.data)||void 0===a?void 0:a.categories)||void 0===r?void 0:r.length)&&void 0!==n?n:0,t.trimOrdinalDataOnOverflow,s),this.updateCategoryLayout(s)},e.prototype.getAxesDomains=function(t,a){var r,n,s={};if(!this.data)return s;if(a.categoryAxis&&this.data.isScalar){var o=bt(this.data.series,null!==(n=null===(r=this.data.categoryMetadata)||void 0===r?void 0:r.type)&&void 0!==n?n:Gi.Ge.fromDescriptor({text:!0}),this.data.isScalar,void 0);o&&(Ca(o.domain),s.categoryAxis=[o.domain[0],o.domain[1]])}if(a.valueAxis){var l=void 0;if(this.isStacked){var u=Mu(this.data.series,this.isStacked100);l=[u.min,u.max]}else l=Cs(this.data.series,t)||_i;var c=l[0],d=l[1];void 0!==c&&void 0!==d&&(s.valueAxis=[c,d])}return s},e.prototype.updateCategoryLayout=function(t){var a;a=this.getPreferredPlotArea(t),this.height=a.height,this.width=a.width,this.categoryLayout=t,this.applyInteractivity(),this.categoryBandScale=d3.scaleBand().range([0,this.categoryWidth]),this.isClusteredOptimized?(this.activeData.layout.clusteredGapSize&&(this.activeData.layout.clusteredGapOverlaps?this.categoryBandScale=d3.scaleBand().range([0,this.categoryWidth*(1-this.activeData.layout.clusteredGapSize/100)]):this.categoryBandScale.paddingInner(this.activeData.layout.clusteredGapSize/100)),this.categoryBandScale.domain(this.activeData.series.map(function(r){return r.index.toString()}))):this.categoryBandScale.domain(["0"])},e.prototype.adjustLayoutForScroll=function(t,a,r,n){if(this.clippedData=void 0,t&&!n.isScalar&&!this.options.isScrollable&&r){var s=Math.min(a,n.categoryCount);if(s!==a){var o=(0,be.ED)(t);o.series=e.sliceSeries(o.series,s),o.categories=o.categories.slice(0,s),o.categoryIdentities&&(o.categoryIdentities=o.categoryIdentities.slice(0,s)),this.clippedData=o}}return t},e.prototype.getLabelUnitsAndPrecision=function(){return(0,it.d6)(this.xAxisProperties,this.data.dataLabelsSettings)},e.prototype.adjustDomainForLabels=function(t){var a=this.activeData,r=t.dataDomain;if(r&&null!=r[0]&&null!=r[1]){var n=r[0].toString(),s=r[1].toString(),o="";a.series.length>0&&a.series[0].data.length>0&&(o=a.series[0].data[0].labelFormatString);var l=(0,lt.fI)(),u=(0,it.d6)(t,a.totalLabelsSettings),c=l.getOrCreate(o,a.totalLabelsSettings,u.units,a.totalLabelsSettings.precision),d=(0,it.Bw)(c.format(n)),h=(0,it.Bw)(c.format(s)),v=(0,We.qk)(a.totalLabelsSettings.fontProperties,d),y=(0,We.qk)(a.totalLabelsSettings.fontProperties,h),f=void 0,p=void 0,S=void 0;this.isBar?(f=Le.b.measureSvgTextWidth(v),p=Le.b.measureSvgTextWidth(y),S=t.invertAxis?-1:1):(f=Le.b.estimateSvgTextHeight(v),p=Le.b.estimateSvgTextHeight(y),S=t.invertAxis?1:-1);var m=t.scale,b=m(r[0])-S*(f+ye.FJ),x=m(r[1])+S*(p+ye.FJ),C=!1,A=!1;return a.totalLabelsSettings.showPositiveAndNegative?(C=a.hasPositive,A=a.hasNegative):(C=a.hasNetPositive,A=a.hasNetNegative),[A?m.invert(b):void 0,C?m.invert(x):void 0]}},e.prototype.isMobileInteractiveLegend=function(){return this.mobileTileInteractive&&!(this.data&&this.data.multipleIdentity)},e.prototype.getClosestColumnIndex=function(t){for(var a=0,r=Number.MAX_VALUE,n=this.getGlyphCenters(),s=0;s<n.length;s++){var o=Math.abs(t-n[s]);o<r&&(r=o,a=s)}return a},e.prototype.applyInteractivity=function(){var t=this;if(this.isMobileInteractiveLegend()){var a=function(){var o=d3.mouse(t.mainGraphicsContext.node()),c=t.getClosestColumnIndex(t.isColumn?o[0]:o[1]);t.selectColumn(c)},r=e.getInteractiveColumnChartDomElement(this.element);this.svg.on("click",a),d3.select(r).on("click",a).style("touch-action","none");var n=d3.drag().on("drag",a);this.svg.call(n),d3.select(r).call(n)}},e.prototype.selectColumn=function(t,a){void 0===a&&(a=!1),(a||this.lastInteractiveSelectedColumnIndex!==t)&&(function(i,e,t,a,r){var n=!r,s=i.selectAll(Zn.selector).selectAll("rect".concat(e));s.filter(function(l){return l.categoryIndex===t}).interrupt().style("fill-opacity",function(l){return Vt.Ko*(0,Ma.TD)(l.columnStyle.fillTransparency)});var o=s.filter(function(l){return(void 0===a||r||l.categoryIndex===a)&&l.categoryIndex!==t});(n?o.transition():o).style("fill-opacity",function(l){return Vt.eU*(0,Ma.TD)(l.columnStyle.fillTransparency)})}(this.mainGraphicsContext,this.CS.selector,t,this.lastInteractiveSelectedColumnIndex,a),this.moveHandle(t),this.cartesianVisualHost.updateLegend(this.createInteractiveLegendDataPoints(t)),this.lastInteractiveSelectedColumnIndex=t)},e.prototype.createInteractiveLegendDataPoints=function(t){var r,n,s,o,a=this,l=this.data;if(!l||_.isEmpty(l.series))return(0,da.Fe)(this.style);var u=N.p.general.formatString,c=null===(r=l.categories)||void 0===r?void 0:r[t],d=null!==(s=null===(n=l.categoryFormatter)||void 0===n?void 0:n.format(c))&&void 0!==s?s:c,h=null===(o=l.legendData)||void 0===o?void 0:o.dataPoints,v=l.series.map(function(y,f){var p,S=null===(p=a.converter)||void 0===p?void 0:p.getValueBySeriesAndCategory(f,t),m=l.valuesMetadata[f],b=h[f];return{marker:{show:!0,shape:Xt.ZO.circle,color:1===l.series.length?y.data.length>t&&y.data[t].columnStyle.fillColor:h.length>f&&b.marker.color,transparency:b.marker.transparency,stroke:b.marker.stroke},label:(0,St.TO)(m,a.dataView.categorical.values,u),category:d,measure:(0,we.WU)(S,(0,we.EO)(m,u)),identity:Tt.l0.createNull(),selected:!1,index:f}});return(0,g.__assign)((0,g.__assign)({},(0,da.Fe)(this.style)),{dataPoints:v})},e.prototype.render=function(t,a,r){return Eh.call(this,t,r)},e.prototype.usesUngroupedRenderer=function(){return this.data.layout.clusteredGapOverlaps&&this.data.layout.clusteredGapSize>0},e.prototype.getFirstElement=function(t,a){void 0===a&&(a=!1);var r=this.activeData.series;if(_.isEmpty(r))return null;var o,l,n=t??r[0].data[0].categoryIndex,s=a?this.findSeriesIndex(r.length-1,n,!1):this.findSeriesIndex(0,n,!0);return s>=0?(o=this.data.series[s].data[n],l=this.getDataPointElement(s,n)):s=a?r.length-1:0,{element:l,targetCategoryIndex:n,targetSeriesIndex:s,noShape:o&&0===o.valueAbsolute}},e.prototype.getNextDataPoint=function(t,a,r){switch(r){case Y.x0.NextCategory:t=e.findCategoryIndex(this.data.series[a].data,t,!0);break;case Y.x0.PreviousCategory:t=e.findCategoryIndex(this.data.series[a].data,t,!1);break;case Y.x0.NextSeries:(a=this.findSeriesIndex(a+1,t,!0))<0&&(t=e.loopIndex(t+1,this.data.categories.length),a=this.findSeriesIndex(0,t,!0));break;case Y.x0.PreviousSeries:(a=a>0?this.findSeriesIndex(a-1,t,!1):-1)<0&&(t=e.loopIndex(t-1,this.data.categories.length),a=this.findSeriesIndex(this.data.series.length-1,t,!1))}var n,s;if(k.fF.assert(function(){return a>=0||t>=0},"We expect that categoryIndex or seriesIndex will always be valid."),a>=0&&t>=0){var o=this.data.series[a].data;this.data.hasHighlights&&(o=o.filter(function(l){return!l.highlight})),n=o[t],s=this.getDataPointElement(a,t)}else if(t<0)switch(r){case Y.x0.NextCategory:t=e.loopIndex(t+1,this.data.categories.length);break;case Y.x0.PreviousCategory:t=e.loopIndex(t-1,this.data.categories.length);break;default:k.fF.assertFail("categoryIndex should not be less than 0 unless we are navigating on categories.")}else switch(r){case Y.x0.NextSeries:a=0;break;case Y.x0.PreviousSeries:a=this.data.series.length-1;break;default:k.fF.assertFail("seriesIndex should be less than 0 unless we are navigating on series")}return this.isInViewport(s)?{element:s,targetCategoryIndex:t,targetSeriesIndex:a,noShape:n&&0===n.valueAbsolute}:this.getNextDataPoint(t,a,r)},e.prototype.validateDirection=function(t){return this.isBar&&!this.getVisualCategoryAxisIsScalar()&&(t===Y.x0.NextSeries||t===Y.x0.PreviousSeries)&&(t=t===Y.x0.NextSeries?Y.x0.PreviousSeries:Y.x0.NextSeries),t},e.prototype.isInViewport=function(t){if(!t)return!0;var r=t.getBBox(),n=this.currentViewport;return r.y+r.height>0&&r.y<n.height&&r.x+r.width>0&&r.x<n.width},e.prototype.getDataPointElement=function(t,a){return this.mainGraphicsContext.selectAll(this.CS.selector).filter(function(n){return n.categoryIndex===a&&n.seriesIndex===t}).node()},e.prototype.findSeriesIndex=function(t,a,r){return(r?_.findIndex:_.findLastIndex)(this.data.series,function(s){return _.some(s.data,function(o){return o.categoryIndex===a&&null!=o.value})},t)},e.findCategoryIndex=function(t,a,r){var n=r?1:-1,s=_.findIndex(t,function(o){return o.categoryIndex===a});return s<0?s:t[s=e.loopIndex(s+n,t.length)].categoryIndex},e.loopIndex=function(t,a){return t>=a?0:t<0?a-1:t},e.prototype.getCategoryValueType=function(){return Ut(this.data.categoryMetadata)},e.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.isScalar},e.prototype.getSupportedCategoryAxisType=function(){var t,a=Ut(null===(t=this.data)||void 0===t?void 0:t.categoryMetadata);return(0,ne.c$)(a)?ht.w.categorical:ht.w.both},e.prototype.setFilteredData=function(t,a){var r=(0,be.ED)(this.data);r.series=e.sliceSeries(r.series,a,t),r.categories=r.categories.slice(t,a),this.clippedData=r},e.prototype.supportsTotalLabels=function(){return!(this.data&&this.data.multipleIdentity)&&this.isStacked&&!this.isStacked100},e.prototype.supportsTrendLine=function(){if(this.data.multipleIdentity)return!1;var a=(0,yr.y)(this.dataView),r=this.getVisualCategoryAxisIsScalar();return 12===this.columnChartType&&r&&a.data.hasValues("Y")},e.prototype.supportsStaticReferenceLines=function(){return this.data&&!this.isValueAxisIrregular()},e.prototype.isValueAxisIrregular=function(){var t,a;return(null===(t=this.data)||void 0===t?void 0:t.layout.stackedGapSize)>0&&(null===(a=this.data)||void 0===a?void 0:a.layout.stackedGapExplodes)&&this.isStacked},e.prototype.supportsStackedGapExplode=function(){return this.isStacked&&!this.isStacked100&&!this.isComboChart},e.prototype.getCartesianVisualCapabilities=function(){var t;return{supportsHierarchicalCategoryAxis:!0,isValueAxisIrregular:this.isValueAxisIrregular(),axesCapabilities:{categoryAxis:{domainAggregateRole:me.au.category,supportedDomainAggregates:null!==(t=this.data)&&void 0!==t&&t.isScalar?3:0},valueAxis:{domainAggregateRole:me.au.y,supportedDomainAggregates:84===this.columnChartType||this.isStacked?1:3}}}},e.prototype.getStaticSeriesRole=function(){return"Y"},Object.defineProperty(e.prototype,"CS",{get:function(){return jo(this.columnChartType)?{class:"column",selector:".column"}:{class:"bar",selector:".bar"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chartTypeOptimized",{get:function(){var a,r=this.columnChartType,n=ln(r,null===(a=this.data)||void 0===a?void 0:a.series.length);return 18!==r||n?20!==r||n?r:12:10},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStackedOptimized",{get:function(){return ln(this.chartTypeOptimized,2)||this.hasRibbonBands},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClusteredOptimized",{get:function(){return Uo(this.chartTypeOptimized)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueAxis",{get:function(){return this.isColumn?this.yAxisProperties:this.xAxisProperties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxis",{get:function(){return this.isColumn?this.xAxisProperties:this.yAxisProperties},enumerable:!1,configurable:!0}),e.prototype.createCategoryAxis=function(t,a){var r,n,s,o,l=this.activeData,u=(r=this.categoryLayout).isScalar,c=r.outerPaddingRatio,d=r.categoryThickness,h=t.axisZoom,v=t.innerPaddingRatio,y=(n=t.categoryAxisOptions).axis,f=n.includeDomain,p=Ra({pixelSpan:this.isColumn?this.width:this.height,domainOptions:bt(l.series,null!==(o=null===(s=l.categoryMetadata)||void 0===s?void 0:s.type)&&void 0!==o?o:Gi.Ge.fromDescriptor({text:!0}),u,[a??f]),axisZoom:h,metaDataColumn:l.categoryMetadata,formatString:(0,we.EO)(l.categoryMetadata,N.p.general.formatString),outerPadding:d*c,outerPaddingRatio:c,isCategoryAxis:!0,isScalar:u,isVertical:this.isBar,categoryThickness:d,useTickIntervalForDisplayUnits:!0,getValueFn:function(m,b){return Yi(l,m,b,u)},axis:(0,g.__assign)((0,g.__assign)({},y),{invertAxis:y.invertAxis&&u}),margin:this.margin,allowSingleScalarTick:u,preventNice:Ya(f),innerPaddingRatio:v,orientation:this.isColumn?ne.Or.bottom:y.switchAxisPosition?ne.Or.right:ne.Or.left});return p.categoryIdentities=l.categoryIdentities,this.categoryLayout.categoryThickness=p.categoryThickness,p},e.prototype.createValueAxis=function(t,a,r){var s,d,n=this,o=t.axisZoom,l=t.forcedTickCount,u=t.valueAxisOptions,c=u.axis;if(k.fF.assert(function(){return!(n.isBar&&void 0!==l)},"Cannot have bar chart as combo chart."),k.fF.assert(function(){return!(n.isClusteredOptimized&&n.isStacked100)},"Cannot have 100% clustered chart."),a??(a=u.includeDomain),this.isClusteredOptimized)d=Cs(this.activeData.series)||_i;else{var h=Mu(this.activeData.series,this.isStacked100);d=[h.min,h.max]}var v=ga(a,Yt(d,0)),y=Ra({pixelSpan:this.isColumn?this.availableHeight:this.width,domainOptions:v,zeroScalarDomain:dh,metaDataColumn:this.activeData.valuesMetadata,formatString:this.isStackedOptimized&&this.isStacked100?this.hostService.getLocalizedString("Percentage"):null!==(s=As(this.activeData.series))&&void 0!==s?s:(0,we.EO)(this.activeData.valuesMetadata[0],N.p.general.formatString),outerPadding:0,isScalar:!0,isVertical:this.isColumn,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,shouldClamp:Al(v?.domain,d),preventNice:Ya(v)||this.isValueAxisIrregular(),includeZero:oa(v),axisZoom:o,forcedTickCount:l,axis:c,margin:this.margin,skipAxisZoomUpdate:r,is100Pct:this.isStackedOptimized&&this.isStacked100,orientation:this.isColumn?c.switchAxisPosition?ne.Or.right:ne.Or.left:ne.Or.bottom});return y.isIrregular=this.isValueAxisIrregular(),this.isBar&&y.d3Axis.tickSizeInner(-this.availableHeight).tickSizeOuter(0),y},Object.defineProperty(e.prototype,"categoryWidth",{get:function(){return this.categoryLayout.categoryThickness*(1-this.categoryLayout.innerPaddingRatio)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnWidth",{get:function(){var a=this.activeData.series.length;return a>=2&&this.activeData.layout.clusteredGapSize>0&&this.activeData.layout.clusteredGapOverlaps?this.categoryWidth*(1+(a-1)*this.activeData.layout.clusteredGapSize/100)/a:this.categoryBandScale.bandwidth()},enumerable:!1,configurable:!0}),e.prototype.createLabelDataPoints=function(t){return vh.call(this,t)},e.prototype.createTotalLabelDataPoints=function(t){return ph.call(this,t)},e.prototype.createUncertaintyLabels=function(t){return gh.call(this,t)},Object.defineProperty(e.prototype,"ribbonGapSize",{get:function(){var a;return this.categoryLayout.categoryThickness*this.categoryLayout.innerPaddingRatio*(null!==(a=this.data.layout.ribbonGapSize)&&void 0!==a?a:0)/100},enumerable:!1,configurable:!0}),e.prototype.drawColumns=function(t){var a,r=this;k.fF.assertValue(this.activeData,"data should be defined"),this.glyphsCenters=null,this.layout=this.getColumnLayout();var o,l,c,s=!0,u=Wh.call(this);return this.animator&&t&&(o=(a=this.animator.animate({chart:this,series:u,valueAxisProps:this.isClusteredOptimized?this.valueAxis:void 0,isBar:this.isClusteredOptimized?this.isBar:void 0,columnWidth:this.isClusteredOptimized?this.columnWidth:void 0,layout:this.layout,interactivityService:this.interactivityService})).shapes,l=a.uncertaintyShapes,s=a.failed),s&&(l=Yh.call(this,{isBar:this.isBar,valueAxisProps:this.isStackedOptimized?void 0:this.valueAxis,layout:this.isStackedOptimized?void 0:this.layout,columnWidth:this.isStackedOptimized?void 0:this.columnWidth,interactivityService:this.isStackedOptimized?void 0:this.interactivityService}),o=Uh.call(this,u),this.isClusteredOptimized&&(0,Fs.LL)(this.mainGraphicsContext,[Zn,Jt.jx])),qh.call(this,t,this.animator),this.dragDataPoint&&(c=function(h){h.identity&&r.hostService.onDragStart({event:d3.event,data:{data:h.identity.getSelector()}})}),function(i,e){k.fF.assertValue(i,"columns"),e&&i.attr("draggable","true").on("dragstart",e)}(o,c),{eventGroup:this.mainGraphicsContext,shapesSelection:o,uncertaintyShapes:this.isClusteredOptimized?l:void 0,labelDataPointGroups:(0,g.__spreadArray)((0,g.__spreadArray)((0,g.__spreadArray)([],this.createLabelDataPoints(this.style),!0),this.createUncertaintyLabels(this.style),!0),this.createTotalLabelDataPoints(this.style),!0),animateLabels:!s}},Object.defineProperty(e.prototype,"scaledMargin",{get:function(){var a,r=null!==(a=this.currentViewport.scale)&&void 0!==a?a:1;return{top:this.margin.top*r,right:this.margin.right*r,bottom:this.margin.bottom*r,left:this.margin.left*r}},enumerable:!1,configurable:!0}),e.prototype.getGlyphCenters=function(){var t=this;if(!this.glyphsCenters&&this.activeData.series.length>0){var a=0;this.categoryLayout.isScalar||(a=this.categoryWidth/2),this.glyphsCenters=this.activeData.series[0].data.map(function(n){return t.categoryAxis.scale(t.categoryLayout.isScalar?n.categoryValue:n.categoryIndex)+a})}return this.glyphsCenters},e.prototype.moveHandle=function(t){var a,r=this.getGlyphCenters(),n=d3.select(".interactive-hover-line");if(!n.empty()&&!this.columnSelectionLineHandle&&(this.columnSelectionLineHandle=d3.select(n.node().parentElement)),!r||r.length<=1)null===(a=this.columnSelectionLineHandle)||void 0===a||a.remove();else{var s=r[t];this.columnSelectionLineHandle?(this.columnSelectionLineHandle.select("line").attrs(this.isColumn?{x1:s,x2:s}:{y1:s,y2:s}),this.columnSelectionLineHandle.select("circle").attrs(this.isColumn?{cx:s}:{cy:s})):(this.columnSelectionLineHandle=this.unclippedGraphicsContext.append("g"),this.columnSelectionLineHandle.append("line").classed("interactive-hover-line",!0).attrs(this.isColumn?{x1:s,x2:s,y1:0,y2:this.height}:{y1:s,y2:s,x1:0,x2:this.width}),this.columnSelectionLineHandle.append("circle").classed("drag-handle",!0).attrs(this.isColumn?{cx:s,cy:this.height}:{cy:s,cx:0}).attr("r","6px"))}},e.prototype.getColumnLayout=function(){var t=this,a=this.columnWidth,r=this.categoryLayout.isScalar,n=this.valueAxis.invertAxis,s=this.valueAxis.scale,o=this.categoryAxis.scale,l=r?this.categoryWidth/2:0,u=function(D){var L=D.catSize,O=D.catBase,B=D.valueSize,E=D.valueBase;return t.isColumn?{width:L,x:O,height:B,y:E}:{height:L,y:O,width:B,x:E}};if(this.isStackedOptimized){var c={catSize:function(D){return a},catBase:function(D){return o(r?D.categoryValue:D.categoryIndex)-l}},d=function(D,L){return D!==L},h=function(D){return d(d(D,t.isBar),n)},v=this.data.layout.stackedGapExplodes?0:this.data.layout.stackedGapSize,y=function(D){return D.indexFromZeroValue>0?v:0},f=function(D){return Math.abs(s(D.originalPosition-Math.abs(D.originalValue))-s(D.originalPosition))},S=function(D,L){void 0===L&&(L=!1);var O=L?D.originalPosition:D.position,E=Math.abs(s(O-Math.abs(L?D.originalValue:D.value))-s(O)),j=y(D);return 0===j?E:D.highlight?E*(1-Math.min(1,j/f(D))):Math.min(Math.max(1,E-j),E)},m=function(D,L){void 0===L&&(L=!1);var O=L?D.originalPosition:D.position,B=L?D.originalValue:D.value,E=s(d(n,t.isColumn)?O:O-Math.abs(B)),j=y(D);if(0===j)return E;if(!D.highlight||L||h(B<0)){if(!h(B<0))return E;E+=j}else{var H=function(D){return Math.abs(s(D.position-Math.abs(D.value))-s(D.position))}(D),Z=f(D);E-=j*((Z-H)/Z)}var ve=s(d(n,t.isColumn)?D.originalPosition-Math.abs(D.originalValue):D.originalPosition);return Math.min(E,ve)};return{shapeLayout:u((0,g.__assign)((0,g.__assign)({},c),{valueSize:function(D){return S(D)},valueBase:function(D){return m(D)}})),shapeLayoutWithoutHighlights:u((0,g.__assign)((0,g.__assign)({},c),{valueSize:function(D){return S(D,!0)},valueBase:function(D){return m(D,!0)}})),zeroShapeLayout:u((0,g.__assign)((0,g.__assign)({},c),{valueSize:function(D){return 0},valueBase:function(D){return s(D.value>=0?D.position-D.valueAbsolute:D.position)}}))}}var b=.5*a,x=b/2,C=s(0),A=function(D){return C+(0,ne.sc)(s,D,0)},T=function(D){return o(r?D.categoryValue:D.categoryIndex)+t.categoryBandScale("".concat(D.seriesPosition))-l};return{shapeLayout:u({catSize:function(D){return D.drawThinner?b:a},catBase:function(D){return T(D)+(D.drawThinner?x:0)},valueSize:function(D){return Math.abs((0,ne.sc)(s,0,D.value))},valueBase:this.isColumn?function(P){return A(n?Math.min(0,P.value):Math.max(0,P.value))}:function(P){return A(n?Math.max(0,P.value):Math.min(0,P.value))}}),shapeLayoutWithoutHighlights:u({catSize:function(D){return a},catBase:function(D){return T(D)},valueSize:function(D){return Math.abs((0,ne.sc)(s,0,D.originalValue))},valueBase:this.isColumn?function(P){return A(n?Math.min(0,P.originalValue):Math.max(0,P.originalValue))}:function(P){return A(n?Math.max(0,P.originalValue):Math.min(0,P.originalValue))}}),zeroShapeLayout:u({catSize:function(D){return D.drawThinner?b:a},catBase:function(D){return T(D)+(D.drawThinner?x:0)},valueSize:function(D){return 0},valueBase:this.isColumn?function(P){return C}:function(P){return A(n?Math.max(0,P.value):Math.min(0,P.value))}}),uncertaintyLayout:{lower:function(D){var L,O;if(null!=(null===(L=D.uncertainty)||void 0===L?void 0:L.lower))return s(null===(O=D.uncertainty)||void 0===O?void 0:O.lower)},upper:function(D){var L,O;if(null!=(null===(L=D.uncertainty)||void 0===L?void 0:L.upper))return s(null===(O=D.uncertainty)||void 0===O?void 0:O.upper)}}}},e.ClassName="columnChart",e}(Vs),X=R(69871),zs=R(42589),Jh=R(40006),Gu=R(80822),qn=R(94038),hn=R(37865),Sa=R(6714),Qn=R(17772),$h=R(66123),ju=(0,Me.CH)("tooltip-overlay"),Uu={min:1,max:20};function Zo(i){return void 0===i&&(i=!1),(0,g.__assign)({strokeShow:!0,strokeColor:void 0,strokeTransparency:0,strokeWidth:2,strokeLineJoin:No.t.round,strokePattern:qt.Dv.solid,strokeDashArray:qt.YU,strokeDashCap:qt.xm,strokeAutoScale:!1,markerProperties:{show:!1,showMarkerByDefault:!0,shape:Xt.ZO.circle,size:$h.$V,color:void 0,transparency:0,rotation:0,stroke:{strokeShow:!0,strokePattern:qt.Dv.solid,strokeColor:void 0,strokeTransparency:0,strokeWidth:void 0}},areaShow:i,areaColor:void 0,areaTransparency:60,areaMatchStrokeColor:!0},(0,Qn.aQ)())}function Es(i){return i.strokeWidth/2+3}function Ko(i,e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var a=(0,lt.bT)({style:i,labelColor:J.v.getThemeColor(i,ye.uQ),textClassName:"smallLightLabel"}).fontProperties;return(0,g.__assign)((0,g.__assign)({show:!1,showByDefault:!0},a),{bold:!1,italic:!1,underline:!1,position:Ge.h.auto,horizontalAlignment:Ai.D.center,minimumOffset:void 0,maximumOffset:void 0,labelDensity:ye.go,labelContainerMaxWidth:Cu.w9,labelContentLayout:Wo.v.SingleLine,optimizeLabelDisplay:!1,enableValueDataLabel:!t,fontProperties:a,displayUnits:0,precision:ye.NZ,valueCustomFormatString:ye.M3,enableTitleDataLabel:!1,titleFontProperties:a,titleLabelDisplayUnits:0,titleLabelPrecision:ye.NZ,titleCustomFormatString:ye.M3,enableDetailDataLabel:t,detailFontProperties:a,detailLabelDisplayUnits:0,detailLabelPrecision:ye.NZ,detailCustomFormatString:ye.M3,detailContentType:t?Au.W.Percent:void 0,leaderLine:(0,ut.sW)(i),enableBackground:e,backgroundColor:e?J.v.getThemeColor(i,yt.U):void 0,backgroundTransparency:e?ye.r_:void 0})}function Bs(i){return _.some(i.anomalyDetections,function(e){return!_.isEmpty(e.anomaliesCategoryIndex)})}function qo(i){return i.isAnomaly}function Yu(i){return i&&null!=i.points}function Xu(i,e,t){return Ar.convertSvgXToClientX(si(i,e),i.currentViewport.scale,t)}var Ar={convertSvgXToClientX:function(e,t,a){return e*t+a},convertSvgYToClientY:function(e,t,a){return e*t+a}};function Zu(i,e){return i.activeData.isScalar?e.categoryValue:e.categoryIndex}function si(i,e){return i.xAxisProperties.scale(Zu(i,e))+i.horizontalOffset}function $i(i,e){var t;return e.isY2?null===(t=i.y2AxisProperties)||void 0===t?void 0:t.scale(e.value):i.yAxisProperties.scale(i.isStackedArea?e.stackedValue:e.value)}function Ku(i,e){var t,a;return e.isY2?null===(t=i.y2AxisProperties)||void 0===t?void 0:t.scale(e.uncertainty.lower):null===(a=i.yAxisProperties)||void 0===a?void 0:a.scale(e.uncertainty.lower)}function qu(i,e){var t,a;return e.isY2?null===(t=i.y2AxisProperties)||void 0===t?void 0:t.scale(e.uncertainty.upper):null===(a=i.yAxisProperties)||void 0===a?void 0:a.scale(e.uncertainty.upper)}var Qu=function(){function i(e){this.options=e,k.fF.assertValue(e.dataView,"dataView"),k.fF.assertValue(e.style,"style");var t=e.dataView,a=ja(t.metadata);this.isScalar=Dn(this.options.isScalar,a);var r=Ln(t.categorical,this.isScalar).category;this.isDateTime=(0,ne.v9)(Ut(r.source,this.isScalar)),this.reader=(0,yr.G)(t,{staticSeriesRoleNames:this.valueRoleNames,colorOptions:{visualStyle:e.style,valueRole:this.primaryValueRole,ignoreDefaultColor:e.isComboChart,ignoreDefaultCategoryColor:!0},formatStringProp:X.zK.general.formatString,errorRangeProp:qe.Qx.errorRange})}return Object.defineProperty(i.prototype,"primaryValueRole",{get:function(){return this.options.isComboChart?Sa.R.Y2:Sa.R.Y},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryValueRole",{get:function(){return this.options.isComboChart?void 0:Sa.R.Y2},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueRoleNames",{get:function(){return[this.primaryValueRole,this.secondaryValueRole].filter(function(t){return t})},enumerable:!1,configurable:!0}),i.convert=function(e){return new i(e).convert()},Object.defineProperty(i.prototype,"staticObjects",{get:function(){return this.reader.objects.getStaticObjects()},enumerable:!1,configurable:!0}),i.prototype.convert=function(){var e,t,a,r,n,s,o,l,u,c,d,h,v,y,f,p,S,m,b,x,C,A,T,P,Ie,D=this.options,L=D.dataView,O=D.style,B=D.interactivityService,E=D.isStacked,j=D.isStacked100,H=D.isComboChart,Z=D.anomalyDetectionDataView,ve=D.tooltipsEnabled,fe=void 0===ve||ve,re=D.multipleInfo,ge=D.hostServices,Ae=ja(L.metadata),Pe=Ln(L.categorical,this.isScalar),se=Pe.category,Se=Pe.useScalarKeys,Fe=Pe.scalarKeys;Se&&((Ie=(0,be.ED)(se.source)).type={dateTime:!0});var ze,kt,Ze,ct,xe=X.zK.general.formatString,Ne=[],$e=[],je=[],et=[],Ve=L.categorical.values,rt=!(!Ve||!Ve.source),_e=Ko(O,H,j),vt=J.v.create(O);if(re){ze=_.first(re.sources).metadata.queryName,ct=re.sources.map(function(Mt){return(0,Tt.Y)(Mt.metadata,Mt.value,re.identity)}),kt=(new Tt.dw).withColumnIdentity(re.identity,ze,ct).createSelectionId();var Nt=(0,br.F)(xe);Ze=(0,G.ML)(_.map(re.sources,function(Mt){return Nt(Mt.value,Mt.metadata)}))}this.staticObjects&&(0,lt.AR)(this.staticObjects.labels,_e,void 0,O,H);var Qe=(0,g.__assign)((0,g.__assign)({},_e),{show:!1});this.options.supportsTotalLabels&&this.staticObjects&&(0,lt.ww)(this.staticObjects.totals,Qe,!1,O,H);var ea=null!==(e=Ve?.grouped())&&void 0!==e?e:void 0,Va=E&&Ve?.length>0?_.times(Ve[0].values.length,function(){return 0}):[],Gt=this.reader.data,va=this.reader.columns,la=Gt.hasCategories()?Gt.getCategoryCount():1,Oe=Gt.getSeriesCount();this.seriesColors=this.allocateSeriesColors(),this.staticLineStyle=this.readLineStyleFromObjects(null,O);var sa=va.getAllValueMetadataColumnsForRole(this.primaryValueRole);this.secondaryValueRole&&(sa=(0,g.__spreadArray)((0,g.__spreadArray)([],sa||[],!0),va.getAllValueMetadataColumnsForRole(this.secondaryValueRole)||[],!0));var Rt,Bt=[],Ke=[];Z&&this.isScalar&&!E&&!H&&(Rt=(0,Bn.Eb)(Z,L,O,xe),k.fF.assert(function(){return Rt.length===Oe},"anomalyDetections length should be the same as series count"));var ce,ta=(0,le.NA)(this.staticObjects,X.zK.layout.seriesOrderReversed,mi.seriesOrderReversed),Ka=this.getSeriesNames(),Zt=Hn(O),I=!1;if(_.some(this.valueRoleNames,function(Mt){return Gt.hasValues(Mt)})){var dt=this.reader.columns.getSeriesCount(this.primaryValueRole);if(I=!0,ce=rt?(0,St.xq)(Gt.getSeriesDisplayName(),va.getSeriesMetadataColumn(),xe):void 0,this.staticObjects){(0,lt.FJ)(this.staticObjects.seriesLabels,Zt,O,H);var Ee=function(i,e){var t=1;if(e)for(var a=e.length,r=0;r<a;r++){var n=ye.bN,o={text:e[r],fontFamily:i.family,fontSize:Bi.FP.fromPoint(i.size.pt),fontWeight:n.fontWeight},l=Le.b.measureSvgTextWidth(o)+2*ye.Bo;t=l>t?l:t}return t}(Zt.fontProperties,Ka);Zt.defaultSeriesWidth=Zt.defaultSeriesWidth?Ee:null,Zt.maxWidthPercentage=Zt.defaultSeriesWidth?Ee:Zt.maxWidthPercentage}for(var qa=[],pt=_e.fontProperties.color,At=j?Nu(la,Oe,function(Mt,ui){return Gt.getValueBySeries(ui,Mt)}):[],ua=function(ui){var nt=ta?Oe-ui-1:ui,Fi=mt.reader.labels.dynamicLabelReader.areDynamicValueLabelsEnabled(null===(t=mt.options.featureSwitches)||void 0===t?void 0:t.labelEnhancementsM0,nt),ir=nt>=dt,Vi=va.getValueColumnBySeries(nt),Lr=ea&&ea[nt],aa=qa[nt]=Vi.source,Oi=[],pn=Tt.dw.builder().withSeries(Ve,Lr,!0).withMeasure(aa.queryName).createSelectionId(),_r=pn.getKey(),wa=void 0,Be=(0,be.ED)(Zt);if(mt.reader.data.hasSeries()||H){var Ea=H&&!mt.reader.data.hasSeries()?mt.reader.objects.getValueMetadataObjectsBySeries(nt):mt.reader.objects.getSeriesDataObjects(nt),rr=Ea?.labels,gn=Ea?.seriesLabels;(wa=(0,be.ED)(_e)).show=_e.show&&(null===(a=_e.showByDefault)||void 0===a||a),rr&&(0,lt.AR)(rr,wa,void 0,O,H),Be.show=Zt.show&&(null===(r=Zt.showByDefault)||void 0===r||r),gn&&(0,lt.FJ)(gn,Be,O,H)}for(var La,fa=(0,Xn.nC)(aa.objects,O,mt.seriesColors[nt],nt,(0,g.__assign)((0,g.__assign)({},_e),{show:!1}),{isCombo:H,staticObjects:mt.staticObjects}),Da=fa.hasUncertainty,Qa=wa??_e,Ni=(null===(n=Vi.highlights)||void 0===n?void 0:n.length)>0,Ja=mt.readLineStyleFromObjects(nt,O),Pr=_.get(Rt,nt),Tr=Pr?new Bn.LO(ge,Pr,aa,xe):void 0,eo=!1,kr=function(He,Ba){var _a=se.values[He],nr=Se?null===(s=Fe.values[He])||void 0===s?void 0:s.min:_a,Si=(0,ne.eT)(Ni?Gt.getHighlightBySeries(He,nt):Gt.getValueBySeries(He,nt)),yn=Si<0,Oa=j?Si*At[He][yn?"neg":"pos"]:Si;if(mt.isScalar&&(null==nr||null==Oa)||mt.isDateTime&&null!=_a&&!(_a instanceof Date))return La=Ba,"continue";if(Ba++,null==Oa&&(ta?nt<Oe-1:nt>0))return La=Ba,"continue";var sr=Ni?Gt.getHighlightFormatStringBySeries(He,nt):Gt.getFormatStringBySeries(He,nt),Mr=Da?(0,Xn.PT)(Gt,He,nt,Oa):void 0,di=void 0,hi=void 0,Fr=se.source?(0,G.AD)(L.categorical.categories,He,xe):void 0;if(fe){if(di=[],re){var Vr=new Xa.E4;Vr.withMultipleColumnAndValues(re.sources.map(function(Ha){return Ha.metadata}),re.sources.map(function(Ha){return Ha.value}),!0,(0,br.F)(xe)),di.push.apply(di,Vr.getTooltipItems())}se.source&&di.push((0,G.bR)(Fr));var $a=function(zi){return(0,St.xq)(zi,aa,xe,!1,sr)};if(rt&&(!se.source||se.source!==Ve.source)&&di.push({displayName:Ve.source.displayName,value:(0,St.xq)(ea[nt].name,Ve.source,xe)}),null!=Oa){var ns={displayName:aa.displayName,value:mt.options.isStacked100?"".concat($a(Si)," (").concat((0,we.WU)(Oa,(0,we.Z)("Percentage")),")"):$a(Si)},ao=fa.tooltips;if(Da&&ao.show&&ao.format===xr.K.range){var Ii=(0,yi.kS)(Mr,Oa,fa,$a,ge,{overrideDisplayName:aa.displayName});k.fF.assert(function(){return void 0===Ii||1===Ii.length},"getUncertaintyTooltipItems() with 'range' format should return exactly one item or undefined when when bounds have not been set yet"),_.isEmpty(Ii)||(ns=Ii[0])}di.push(ns)}Da&&(H&&fa.tooltips.format!==xr.K.range?di.push.apply(di,null!==(o=(0,yi.kS)(Mr,Oa,fa,$a,ge,{hideMarker:!0}))&&void 0!==o?o:[]):(0,yi.$w)(Mr,Oa,fa,$a,ge)),(0,Xa.VT)(mt.reader,hi=[],He,rt?nt:void 0,xe);var ss=Tr?.getTooltipItems(He,sr);ss&&hi.push.apply(hi,ss),hi=_.isEmpty(hi)?void 0:hi}var bi=new Tt.dw,vi=null!==(l=L.categorical.originalCategories)&&void 0!==l?l:[se];Gt.hasCategories()&&(bi=bi.withCategory(vi,He,null===(c=null===(u=va.getCategoryColumn("Category"))||void 0===u?void 0:u.source)||void 0===c?void 0:c.queryName,!0)),rt&&(bi=bi.withSeries(Ve,Lr,!0)),re&&(bi=bi.withColumnIdentity(re.identity,ze,ct)),null!==(d=Ke[He])&&void 0!==d||(Ke[He]={positive:0,positiveCount:0,negative:0,negativeCount:0,net:0,categoryValue:mt.convertCategoryValue(nr,mt.isDateTime,Se),categoryIndex:He,dynamicFormatString:sr});var ia=Math.abs(Oa);isNaN(ia)||(yn?(Ke[He].net-=ia,Ke[He].net<Ke[He].negative&&(Ke[He].negative=Ke[He].net,Ke[He].negativeCount++)):(Ke[He].net+=ia,Ke[He].net>Ke[He].positive&&(Ke[He].positive=Ke[He].net,Ke[He].positiveCount++)));var mn={defaultColor:pt,seriesColor:wa?.fontProperties.color,categoricalDataReader:mt.reader,categoryIndex:He,seriesIndex:nt},or=(0,ut.t$)(mn),os={dataPointLabelSettings:Qa,defaultLabelSettings:_e,categoricalDataReader:mt.reader,categoryIndex:He,seriesIndex:nt,dynamicLabelsEnabledForSeries:Fi,featureSwitches:mt.options.featureSwitches},ls=(0,ut.Xc)((0,g.__assign)((0,g.__assign)({},os),{detailPropertyId:X.zK.labels.dynamicLabelDetail,titlePropertyId:X.zK.labels.dynamicLabelTitle,dataLabelFillColorOptions:mn})),Or=(0,ut.tI)((0,g.__assign)((0,g.__assign)({},os),{valuePropertyId:X.zK.labels.dynamicLabelValue}));if(!eo&&null!==(h=mt.options.featureSwitches)&&void 0!==h&&h.labelEnhancementsM0){var Nr=ls&&(null===(v=_.first(ls.filter(function(Ha){return"Detail"===Ha.role})))||void 0===v?void 0:v.dynamicLabel.enabled);(0,ut.hY)(ge,!1,Or?.enabled,Nr,Qa),eo=!0}E&&(Va[He]+=Oa);var Ha,zi,ei,xi,fi,lr=(0,g.__assign)({categoryValue:mt.convertCategoryValue(nr,mt.isDateTime,Se),value:Oa,originalValue:Si,categoryIndex:He,seriesIndex:nt,tooltipInfo:di,selected:!1,identity:bi.withMeasure(aa.queryName,va.getValueColumn(ir?Sa.R.Y2:Sa.R.Y,nt),He).createSelectionId(),key:JSON.stringify({series:_r,category:se&&!_.isEmpty(se.identity)&&se.identity[He]?se.identity[He].key:He}),labelFill:or.color,leaderLineColor:(0,ut.Zj)(_e.leaderLine.strokeColor,wa,mn,or),labelFormatString:sr||aa.format,labelSettings:Qa,uncertainty:Mr,additionalTooltipItems:hi,marker:(zi=X.zK.lineStyles.strokeColor,ei=null===(Ha=se.objects)||void 0===Ha?void 0:Ha[He],xi=ei&&vt.hasColorForProperty(ei,zi),fi=Object.create(Ja.markerProperties),fi.perCategoryStyle=!!xi,fi.transparency=Ja.strokeTransparency,fi.color=xi?vt.getColorForProperty(ei,zi,void 0):Ja.strokeColor,fi.show=!!xi||!!fi.show,fi.focusOnlySize=Es(Ja),fi.focusOnlyColor=Ja.strokeColor,fi),isY2:ir,dynamicLabelValue:Or,stackedValue:E?Va[He]:void 0},(null===(y=mt.options.featureSwitches)||void 0===y?void 0:y.labelEnhancementsM0)&&{appendedLabelContents:ls,labelDataPointContainerEnabled:!0});Oi[Ba]=lr,null!==(f=Ne[He])&&void 0!==f||(Ne[He]=wo(lr,Fr)),Ne[He]&&((P=Ne[He]).hasData||(P.hasData=null!=lr.value));var Rr=function(zi){var ei,xi=(new Tt.dw).withCategory(vi,He,null===(ei=se?.source)||void 0===ei?void 0:ei.queryName,!0);return!rt&&1===Oe&&xi.withMeasure(aa.queryName),zi&&re&&xi.withColumnIdentity(re.identity,ze,ct),xi};Gt.hasCategories()&&(null!==(p=$e[He])&&void 0!==p||($e[He]=Rr(!1).createSelectionId()),null!==(S=je[He])&&void 0!==S||(je[He]=Rr(!0).createSelectionId())),La=Ba},Ri=0,to=-1;Ri<la;Ri++)kr(Ri,to),to=La;var ci=_.findIndex(sa,aa);-1!==ci&&(null!==(m=Bt[ci])&&void 0!==m||(Bt[ci]={metadataColumn:aa,usedInSeriesIndices:[],valueSelector:(new Tt.dw).withMeasure(aa.queryName,Vi).createSelectionId()}),Bt[ci].usedInSeriesIndices.push(nt)),B?.applySelectionStateToData(_.filter(Oi,function(rs){return null!=rs})),(Oi.length>0||re?.isCoreMultiple)&&et.push({displayName:Ka[nt],key:_r,index:nt,xCol:Se?Ie:se.source,yCol:aa,data:Oi,identity:pn,selected:!1,uncertainty:fa,labelSettings:wa,seriesLabelSettings:Be,type:aa.type,measureDisplayName:aa.displayName,lineStyle:Ja,isY2:ir})},mt=this,ba=0;ba<Oe;ba++)ua(ba);this.addTotalTooltips(ta,et,Qe,Ke,qa)}var Kt=null===(x=null===(b=L.metadata)||void 0===b?void 0:b.dataReduction)||void 0===x?void 0:x.categorical;B?.applySelectionStateToData(et);var Aa=(0,le.NA)(this.staticObjects,X.zK.legend.legendMarkerRendering,hn._.markerCircleDefault),li=(0,le.NA)(this.staticObjects,X.zK.legend.matchLineColor,!0);return{series:et,totals:Ke,legendData:(0,da.pq)({dataView:L,allowLegendWithNoSeries:H,showByDefault:!0,staticSeriesRoleNames:H?["Y2"]:["Y","Y2"],style:O,ignoreDefaultColor:H,ignoreDefaultCategoryColor:!0,lineAndMarkerOptions:{renderLineStyle:!0,legendMarkerRendering:Aa,matchSeriesColor:li,defaultMarkerShape:Xt.ZO.longDash},featureSwitches:this.options.featureSwitches}),forecastLines:this.convertForecastLines(Ne,Se,$e,je),anomalyDetections:Rt,isScalar:this.isScalar,dataLabelsSettings:_e,totalLabelsSettings:Qe,seriesLabelSettings:Zt,hasDynamicSeries:rt,hasHighlights:!1,hasY2Role:(0,Dt.c5)(L,"Y2"),categoryMetadata:se.source,valuesMetadata:sa,valuesMetadataBySeries:Bt,preferredCategoryWidth:Li(Ae),scalarMetadata:Ie,scalarKeyCount:Se?Fe.values.length:void 0,categories:se.values,categoryData:Ne,seriesDisplayName:ce,hasValues:I,categoryIdentities:$e,multiplesCategoryIdentities:je,lineStyle:this.staticLineStyle,binnedLineSamplingApplied:!!(null!==(C=Kt?.metadata)&&void 0!==C&&C.binnedLineSample||null!==(A=Kt?.categories)&&void 0!==A&&A.binnedLineSample||null!==(T=Kt?.values)&&void 0!==T&&T.binnedLineSample),legendMarkerRendering:Aa,matchLineColor:li,multipleIdentity:kt,multipleDisplayName:Ze,layout:{seriesOrderReversed:ta}}},i.prototype.addTotalTooltips=function(e,t,a,r,n){var s,o,l,u,c=this.options,d=c.hostServices,v=c.tooltipsEnabled;if(c.isStacked&&d&&(void 0===v||v)&&a.show)for(var f=this.reader.data.getSeriesCount(),p=a.fontProperties.color,S=[],m=0;m<f;m++){var b=e?f-m-1:m;if(t[b])for(var x=0,C=t[b].data;x<C.length;x++){var A=C[x];if(A){var T=A.categoryIndex,P=(0,ut.AO)({defaultColor:p,categoricalDataReader:this.reader,categoryIndex:T,seriesIndex:b});r[T].labelFill=P.color;var D=(0,ut.B8)(P)?P.color:p;a.fontProperties=(0,ut.Vv)(D,a.fontProperties),null!==(s=S[T])&&void 0!==s||(S[T]={net:{displayName:d.getLocalizedString("Visual_Total"),value:(0,St.xq)(r[T].net,n[b],X.zK.general.formatString,!1)}});var L=S[T].net;null!==(o=A.tooltipInfo)&&void 0!==o||(A.tooltipInfo=[]),A.tooltipInfo.push(L),null!==(l=(u=A).additionalTooltipItems)&&void 0!==l||(u.additionalTooltipItems=[]),A.additionalTooltipItems.push(L)}}}},i.prototype.convertForecastLines=function(e,t,a,r){var n,s,o,l=this.options,u=l.dataView,v=l.forecastDataView;if(v&&this.isScalar&&!l.isStacked&&!l.isComboChart){for(var y=(0,gr.XB)(v,u,l.style,this.staticLineStyle),f=_.last(e),p=0,S=y;p<S.length;p++)for(var b=f.categoryIndex,x=0,C=S[p].points;x<C.length;x++){var A=C[x];A.point.x=this.convertCategoryValue(A.point.x,this.isDateTime,t),A.upperBound.x=this.convertCategoryValue(A.upperBound.x,this.isDateTime,t),A.lowerBound.x=this.convertCategoryValue(A.lowerBound.x,this.isDateTime,t);var T=A.point.x;T<=f.categoryValue||(null!==(n=e[++b])&&void 0!==n||(e[b]={categoryIndex:b,categoryValue:T,hasData:null!=A.point.y,hierarchyCategoryLevels:(0,G.AD)(u.categorical.categories,b,X.zK.general.formatString)}),null!==(s=a[b])&&void 0!==s||(a[b]=null),null!==(o=r[b])&&void 0!==o||(r[b]=null))}return y}},i.prototype.allocateSeriesColors=function(){for(var e=this.reader.data.getSeriesCount(),t=[],a=0;a<e;a++)t.push(this.reader.colors.createBySeries(a,void 0,yt.fA));return t},i.prototype.getSeriesNames=function(){var e=this,t=this.reader.data.getSeriesCount();return _.range(t).map(function(a){return e.reader.columns.hasDynamicSeries()?(0,we.WU)(e.reader.data.getSeriesName(a),e.reader.objects.getSeriesFormatString(a)):e.reader.columns.hasStaticSeries()?e.reader.data.getSeriesName(a):e.reader.data.getValueDisplayName(e.primaryValueRole)})},i.prototype.convertCategoryValue=function(e,t,a){if(e&&(t||a)){var r=e;return k.fF.assert(function(){return(0,nn.M4)(r)},"dateValue"),r.epochTimeStamp}return e},i.prototype.readLineStyleFromObjects=function(e,t){var a=X.zK.lineStyles,r=(0,le.NA)(this.staticObjects,X.zK.lineStyles.showSeries,!0),s=null!=e&&r?this.reader.objects.getSeriesDataObjects(e):this.staticObjects,o=this.staticLineStyle,l=o??Zo(this.options.isAreaChart);null!=e?k.fF.assert(function(){return null!=o},"If converting per-series line style, staticStyle must be defined"):k.fF.assert(function(){return null==o},"If converting static line style, staticStyle must be not-defined");var u=(0,g.__assign)((0,g.__assign)((0,g.__assign)({},(0,ya.QI)(s,a,l)),{markerProperties:null==e?(0,qn.RZ)(s,t):(0,qn.Yh)(this.reader,o.markerProperties,e,t,!r),areaShow:(0,le.NA)(s,a.areaShow,l.areaShow),areaColor:(0,le.W7)(s,a.areaColor,l.areaColor),areaTransparency:(0,le.NA)(s,a.areaTransparency,l.areaTransparency),areaMatchStrokeColor:(0,le.NA)(s,a.areaMatchStrokeColor,l.areaMatchStrokeColor)}),(0,Qn.RN)(s,a,l));return null!==e&&(u.strokeColor=this.seriesColors[e]),null!=e&&u.areaShow&&(u.areaShow=o.areaShow),u.areaMatchStrokeColor&&(u.areaColor=u.strokeColor),u},i}(),av=R(67918),iv=R(72250);function rv(){return{type:0,card:[uv.call(this),lv.call(this),nv.call(this),sv.call(this),ov.call(this),cv.call(this),dv.call(this)].filter(function(i){return i})}}function nv(){var e,t,i=this,a=this.originalData;if(a&&this.dataView){var r=a.series.length;if(0!==r){var n=(0,le.NA)(null===(t=null===(e=this.dataView)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.objects,X.qn.lineStyles.showSeries,!0);return new F.CQ(new F.lg("markers"),"Visual_Markers",Object.values(X.zK.markers).concat([X.zK.dataPoint.fill,X.zK.dataPoint.showAllDataPoints,X.zK.lineStyles.showSeries]),this.localizer).addTopLevelToggle("showMarkerTopLevel",function(){return new F.bd({descriptor:X.qn.lineStyles.showMarker,value:a.lineStyle.markerProperties.show}).build()}).addGroup("applySettingsTo",function(s){return s.withContainerDisabled(!n).withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(o){if(o.withDisplayName(r>1?"Series":"Visual_Categories").addContainerItem("all",i.localizer("All"),function(f){var p,S,m;if(Jo.call(i,{containerItemBuilder:f,listType:r>1?"staticPerSeries":"staticPerCategories",markerStyle:(0,g.__assign)((0,g.__assign)({},a.lineStyle.markerProperties),{color:null!==(S=null!==(p=a.lineStyle.markerProperties.color)&&void 0!==p?p:a.lineStyle.strokeColor)&&void 0!==S?S:null===(m=a.series[0])||void 0===m?void 0:m.lineStyle.strokeColor})}),!n){var b=[X.qn.lineStyles.lineChartType,X.qn.lineStyles.lineStyle,X.qn.lineStyles.strokeWidth,X.qn.lineStyles.strokeLineJoin,X.qn.lineStyles.showMarker,X.qn.lineStyles.showMarkerByDefault,X.qn.lineStyles.markerShape,X.qn.lineStyles.markerSize,X.qn.lineStyles.markerColor,X.qn.dataPoint.showAllDataPoints,X.qn.dataPoint.fill];f.addSimpleSlice("showSeriesLink",function(){return new F.ob({descriptor:X.qn.lineStyles.showSeries,value:function(){},ariaLabel:"Enable_This_Setting",type:"SeriesDialogLink",resetToDefaultDescriptors:b,warningIcon:!0}).build()},function(x){return x.withCustomDisplayName("Enable_This_Setting").withSuppressDisplayName(!0)})}}),1===r&&i.supportsPerCategoryMarker()){var l=function(i){for(var e=[],t=function(o){if(o&&i.categoryIdentities[o.categoryIndex])for(var l=0;l<i.series.length;l++){var c=_.findIndex(i.series[l].data,function(d){return d.categoryIndex===o.categoryIndex});if(c>=0){e.push({categoryIndex:o.categoryIndex,seriesIndex:l,dataPointIndex:c});break}}},a=0,r=i.categoryData;a<r.length;a++)t(r[a]);return e}(a),u=l.slice(0,Vo);if(u.length<2)return;var c=zl(u,a);u.forEach(function(f,p){var S,m=f.categoryIndex,b=f.seriesIndex,x=f.dataPointIndex,C=(0,g.__assign)((0,g.__assign)({},_.cloneDeep(a.lineStyle.markerProperties)),{color:null!==(S=a.series[b].data[x].marker.color)&&void 0!==S?S:a.series[b].lineStyle.strokeColor}),T=(0,at.fd)(a.categoryIdentities[m].getSelector());a.multipleIdentity&&(T=(0,at.d9)(T),k.fF.assert(function(){return!!T.data},"expect categories to have some data identity"),T.data.unshift((0,mr.Yp)([Sa.R.Rows]))),o.addContainerItem(c[p],c[p],function(P){return Jo.call(i,{containerItemBuilder:P,listType:"perCategory",markerStyle:C,selector:T})})})}if(r>1)for(var d=function(p){var S=(0,at.fd)(p.identity.getSelector());if(!S)return"continue";o.addContainerItem(p.displayName,p.displayName,function(m){return Jo.call(i,{containerItemBuilder:m,listType:"perSeries",markerStyle:p.lineStyle.markerProperties,selector:S})})},h=0,v=a.series;h<v.length;h++)d(v[h])})}).build()}}}function sv(){var e,i=this,t=this.originalData,a=t.dataLabelsSettings,r=t.series.length,n=r>1||!t.categoryMetadata||this.isComboChart,s=this.isStacked?[Ge.h.auto,Ge.h.insideCenter,Ge.h.insideEnd]:[Ge.h.auto,Ge.h.above,Ge.h.under];a.position&&s.indexOf(a.position)<0&&(a.position=Ge.h.auto);var v,o=(0,g.__assign)((0,g.__assign)({},X.qn.labels),{position:X.qn.labels.labelPosition,precision:X.qn.labels.labelPrecision,displayUnits:X.qn.labels.labelDisplayUnits,labelBackgroundColor:X.qn.labels.backgroundColor,labelBackgroundTransparency:X.qn.labels.backgroundTransparency,showDynamicLabels:X.qn.labels.showDynamicLabels,dynamicLabelValue:X.qn.labels.dynamicLabelValue,leaderLines:X.qn.labels.leaderLines,maximumOffset:X.qn.labels.maximumOffset,minimumOffset:X.qn.labels.minimumOffset}),l=new F.CQ(new F.lg("labels"),"Visual_DataPointsLabels",o,this.localizer),u=(0,ut.DU)(this.featureSwitches,t.hasDynamicSeries,n,r,this.isComboChart,!0),c=Ju.call(this,void 0,a,null,n,s,u),d=this.isComboChart?void 0:vn.call(this,!1),h={cardBuilder:l,dataLabelsProps:o,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:c,includeAltConstantValueSelector:!0,individualSelector:d,showEnhancedLabelsFormattingOptions:!0,instanceId:"all"};if(null!==(e=this.featureSwitches)&&void 0!==e&&e.labelEnhancementsM0&&this.dataView){var y=(v=(0,yr.y)(this.dataView)).labels.dynamicLabelReader.getLabelFieldSourceTypes();Object.assign(h,{valueFieldSourceType:y.valueFieldSourceType,detailFieldSourceType:y.detailFieldSourceType,titleFieldSourceType:y.titleFieldSourceType,valueLabelPickerFallbackExpr:(0,ut.WA)(t.valuesMetadataBySeries,r,t.hasDynamicSeries),dataLabelPickerSeriesType:(0,ut.Nb)(r,t.hasDynamicSeries,this.isComboChart)})}return l.withDescription("Visual_DataPointsLabelsDescription"),o.show&&l.addTopLevelToggle("show",function(){return new F.bd({descriptor:o.show,value:c.dataLabelsSettings.show}).build()}),l.addGroup("applySettingsTo",function(m){return m.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(b){var x,C;if(b.withDisplayName("Series"),b.addContainerItem("all",i.localizer("All"),function(O){return(0,lt.WW)(h,O)}),n)for(var A=0;A<r;A++){var T=t.series[A],P=null!==(x=T.labelSettings)&&void 0!==x?x:t.dataLabelsSettings;P.position&&s.indexOf(P.position)<0&&(P.position=Ge.h.auto);var D=T.identity.getSelector();if(Object.assign(h,{includeAltConstantValueSelector:!1,selector:t.hasDynamicSeries?(0,at.fd)(D):D,individualSelector:vn.call(i,!0),options:Ju.call(i,void 0,P,D,void 0,s,t.hasDynamicSeries),instanceId:"sn-".concat(A)}),null!==(C=i.featureSwitches)&&void 0!==C&&C.labelEnhancementsM0){var L=v?.labels.dynamicLabelReader.getLabelFieldSourceTypes(A);Object.assign(h,(0,g.__assign)((0,g.__assign)({},L?{valueFieldSourceType:L.valueFieldSourceType,detailFieldSourceType:L.detailFieldSourceType,titleFieldSourceType:L.titleFieldSourceType}:{}),{valueLabelPickerFallbackExpr:(0,ut.CH)(t.valuesMetadataBySeries,A),dataLabelPickerSeriesType:(0,ut.aC)(r,t.hasDynamicSeries,i.isComboChart)}))}b.addContainerItem(T.displayName,T.displayName,function(O){return(0,lt.WW)(h,O)})}})}),l.build()}function ov(){var i=this;if(this.showSeriesCard()){var e=this.originalData,t=e.seriesLabelSettings,a=this.showLabelPerSeries(),r=(0,g.__assign)((0,g.__assign)({},X.qn.seriesLabels),{show:{objectName:"seriesLabels",propertyName:"show"}}),n=new F.CQ(new F.lg("seriesLabels"),"Visual_SeriesLabels",r,this.localizer),s={cardBuilder:n,seriesLabelsProps:r,featureSwitches:this.featureSwitches,hostServices:this.hostService,seriesOptions:{enumeration:void 0,seriesLabelsSettings:t,selector:null,style:this.style,showAll:a}};return n.withDescription("Visual_SeriesDescription"),r.show&&n.addTopLevelToggle("show",function(){return new F.bd({descriptor:r.show,value:s.seriesOptions.seriesLabelsSettings.show}).build()}),n.addGroup("applySettingsTo",function(o){return o.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(l){var u;if(l.withDisplayName("Series").addContainerItem("all",i.localizer("All"),function(y){return(0,pi.eR)(s,y)}),i.showLabelPerSeries())for(var c=0,d=e.series;c<d.length;c++){var h=d[c],v=h.identity.getSelector();s.selector=e.hasDynamicSeries?(0,at.fd)(v):v,s.seriesOptions={enumeration:void 0,seriesLabelsSettings:null!==(u=h.seriesLabelSettings)&&void 0!==u?u:e.seriesLabelSettings,selector:v,style:i.style,showAll:void 0},l.addContainerItem(h.displayName,h.displayName,function(y){return(0,pi.eR)(s,y)})}})}).build()}}function lv(){var i=this,e=this.originalData;if(e&&e.series&&0!==e.series.length){var t=function(r){var n=r.lineStyle,s=r.selector;r.containerItemBuilder.addSimpleSlice("showSeries",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.areaShow),{selector:s}),value:n.areaShow}).build(),function(o){return o.withDisabled(!s).withCustomDisplayName("Visual_Show_Data_Labels_PerSeries")}).addGroup("colors",function(o){return o.withDisplayName("Generic_Color").addSimpleSlice("shadeAreaMatchStrokeColor",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.areaMatchStrokeColor),{selector:s}),value:n.areaMatchStrokeColor}).build()).addSimpleSlice("shadeAreaColor",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.areaColor),{selector:s}),value:{value:n.areaColor}}).build(),function(l){return l.withDisabled(n.areaMatchStrokeColor)}).addSimpleSlice("shadeAreaTransparency",F.JN.getTransparencySliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},X.qn.dataPoint.transparency),{selector:s}),value:n.areaTransparency,localize:i.localizer}).build())})};return new F.CQ(new F.lg("shadeArea"),"Visual_Shapes_ShadeArea",[X.qn.lineStyles.areaShow,X.qn.dataPoint.transparency,X.qn.lineStyles.areaColor,X.qn.lineStyles.areaMatchStrokeColor],this.localizer).addTopLevelToggle("shadeAreaShow",function(){return new F.bd({descriptor:X.qn.lineStyles.areaShow,value:i.data.lineStyle.areaShow}).build()}).addGroup("applySettingsTo",function(a){return a.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(r){if(r.withDisplayName("Series"),r.addContainerItem("all",i.localizer("All"),function(u){t.call(i,{containerItemBuilder:u,lineStyle:e.lineStyle})}),e.series.length>1)for(var n=function(c){r.addContainerItem(c.displayName,c.displayName,function(d){return t.call(i,{containerItemBuilder:d,lineStyle:c.lineStyle,selector:(0,at.fd)(c.identity.getSelector())})})},s=0,o=e.series;s<o.length;s++)n(o[s])})}).build()}}function uv(){var e,t,i=this,a=this.originalData;if(a&&a.series&&0!==a.series.length){var r=(0,le.NA)(null===(t=null===(e=this.dataView)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.objects,X.qn.lineStyles.showSeries,!0);return new F.CQ(new F.lg("lines"),"Visual_Lines",[X.qn.lineStyles.lineChartType,X.qn.lineStyles.interpolationStep,X.qn.lineStyles.interpolationSmooth,X.qn.lineStyles.interpolationSmoothParam,X.qn.lineStyles.strokeShow,X.qn.dataPoint.fill,X.qn.dataPoint.defaultColor,X.qn.lineStyles.lineStyle,X.qn.lineStyles.strokeWidth,X.qn.lineStyles.strokeLineJoin,X.qn.lineStyles.strokeTransparency,X.qn.lineStyles.strokeAutoScale,X.qn.lineStyles.strokeDashArray,X.qn.lineStyles.strokeDashCap,X.qn.layout.seriesOrderReversed],this.localizer).addGroup("applySettingsTo",function(n){return n.withDisplayName("Apply_Settings_To").withCollapsible(!1).withContainerDisabled(!r).addContainer("series",function(s){if(s.withDisplayName("Series").addContainerItem("all",i.localizer("All"),function(d){return $u.call(i,{containerItemBuilder:d,lineStyle:a.lineStyle})}),a.series.length>1)for(var o=function(h){s.addContainerItem(h.displayName,h.displayName,function(v){return $u.call(i,{containerItemBuilder:v,lineStyle:h.lineStyle,selector:(0,at.fd)(h.identity.getSelector())})})},l=0,u=a.series;l<u.length;l++)o(u[l])})}).build()}}function cv(){if(this.supportsTotalLabels()){var e=this.originalData.totalLabelsSettings;if(e){var t=(0,g.__assign)((0,g.__assign)({},X.qn.totals),{precision:X.qn.totals.labelPrecision,displayUnits:X.qn.totals.labelDisplayUnits}),a=new F.CQ(new F.lg("totals"),"Visual_DataTotalLabels",t,this.localizer).withDescription("Visual_DataTotalLabelsDescription");return(0,lt.XQ)({cardBuilder:a,dataLabelsProps:t,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:vv.call(this,void 0,e),individualSelector:vn.call(this,!1),showEnhancedLabelsFormattingOptions:!1})}}}function dv(){var i=this;if(!this.isAreaChart){var e=this.originalData;if(e&&e.series&&0!==e.series.length){var t=qe.N_.error;return new F.CQ(new F.lg("errorBars"),"Visual_Error_Bars",[t.enabled,t.errorRange,t.barShow,t.barMatchSeriesColor,t.barColor,t.barWidth,t.barBorderColor,t.barBorderSize,t.shadeShow,t.shadeBandStyle,t.shadeColor,t.shadeMatchSeriesColor,t.shadeTransparency,t.labelShow,t.labelFontFamily,t.labelFontSize,t.labelBold,t.labelItalic,t.labelUnderline,t.labelColor,t.labelMatchSeriesColor,t.labelFormat,t.labelBackground,t.labelBackgroundColor,t.labelBackgroundTransparency,t.markerShape,t.markerShow,t.markerSize,t.showMarkerByDefault,t.tooltipShow,t.tooltipFormat],this.localizer,!0,!0).addGroup("applySettingsTo",function(a){return a.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("measure",function(r){r.withDisplayName("Series");for(var n=function(c){var d=_.first(c.usedInSeriesIndices);if(k.fF.assertValue(d,"lineChart - measure is not associated with any series"),null!=d){var h=c.metadataColumn,v=e.series[d];if(null==v)return"continue";var y=c.valueSelector.getSelector(),f=i.isComboChart?(0,mr.Yp)([Sa.R.Rows,Sa.R.Category]):(0,Cr.Ue)(),p=(0,g.__assign)((0,g.__assign)({},y),{data:[f],highlightMatching:1});r.addContainerItem(h.queryName,h.displayName,function(S){return(0,Ru.f)({localize:i.localizer,uncertainty:v.uncertainty,targetMeasure:c.metadataColumn.expr,measureSelector:y,dataPointSelector:p,featureSwitches:i.featureSwitches},S)})}},s=0,o=e.valuesMetadataBySeries;s<o.length;s++)n(o[s])})}).build()}}}function hv(i,e){var t=this.originalData;if(t)switch(e.objectName){case gr.Po:if(this.supportsForecast()){var a=void 0;_.isEmpty(t.anomalyDetections)||(a=this.localizer("Visual_AnomalyDetection_WarningMessage_NoWithForecast")),(0,gr.$I)(i,t.forecastLines,this.style,a)}break;case Gu.xn:this.supportsAnomalyDetection()&&(0,av.HL)(this.hostService,this.data,this.dataView,i,t.anomalyDetections,this.style,t.isScalar,e.selectors)}}function Ju(i,e,t,a,r,n){return{enumeration:i,dataLabelsSettings:e,show:!0,position:!0,positionObject:r,displayUnits:!this.isStacked100,precision:!0,selector:t,showAll:a,fontSize:!0,fontFamily:!0,labelDensity:this.data.isScalar,enableBackground:e.enableBackground,backgroundColor:e.backgroundColor,backgroundTransparency:e.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0,enableDynamicLabelPickers:!n,isStacked100:this.isStacked100,leaderLines:!this.isStacked&&!this.isComboChart}}function vv(i,e){return{enumeration:i,dataLabelsSettings:e,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,enableBackground:e.enableBackground,backgroundColor:e.backgroundColor,backgroundTransparency:e.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0}}function fv(i,e){var t;if(!this.data)return[];var a=[];if(void 0===e||3===e)for(var n=0,s=this.data.series;n<s.length;n++){var o=s[n];if(o.lineStyle.markerProperties.show){var l=null===(t=o?.identity)||void 0===t?void 0:t.getSelectorsByColumn(),u=this.hostService.getLocalizedString("MiniToolbar_Markers",o.displayName);a.push(i.createVisualSubSelectionForSingleObject({objectName:"markers",subSelectionType:3,displayName:u,showUI:!0,selectorsByColumn:l}))}}return a}function pv(i){var e;switch(d3.select(i).attr(U.Ez)){case"area":case"lines":var a=d3.select(i).datum(),r=null===(e=a?.identity)||void 0===e?void 0:e.getSelectorsByColumn();if(r)return r;break;case"data-labels":case"series-labels":var n=(0,ut.wT)(i,this.data.series);if(n)return n;break;default:return}}function gv(i){var e,t,r=i.visualObjects[0].selectorsByColumn;if("markers"===i.visualObjects[0].objectName){var n=null===(e=this.activeData)||void 0===e?void 0:e.series;if(n)for(var s=0,o=n;s<o.length;s++){var l=o[s],u=null===(t=l.identity)||void 0===t?void 0:t.getSelectorsByColumn();if((0,at.Ic)(u,r))return Qo(l,this.viewModel)}}}function Qo(i,e){var t,a=e.renderContext.mainGraphicsPositionOverlay;if(a){var r=a.node();if(r){var n=r.getBoundingClientRect(),s=n.left,o=n.top,l=e.currentViewport,u=i.data,c=null!==(t=_.first(u))&&void 0!==t&&t.isY2?e.y2AxisProperties.scale:e.yAxisProperties.scale,d=l.scale,h=e.data.lineStyle.markerProperties.size*d,p=Math.max(h+1.2*h,10)*d;p%2==0&&++p;var S=1;if(u.length*p>l.width){var m=(0,it.SS)(l.width,50,4,p);S=Math.floor(u.length/m)}for(var b=[],x=0;x<u.length;x+=S){var C=u[x];C&&b.push({x:Math.floor(Xu(e,C,s)-p/2),y:Math.floor(Ar.convertSvgYToClientY(c(C.value),d,o)-p/2),width:p,height:p,type:1})}var A=e.data.multipleDisplayName;return[{id:A?"".concat(i.key).concat(A):i.key,outline:{type:0,outlines:b,clipPath:{type:1,x:s,y:o,height:e.availableHeight*d,width:e.availableWidth*d}}}]}}return[]}function yv(i){if("area"===i.visualObjects[0].objectName){var t=this.findSubSelectedAreaElement({x:d3.event.clientX,y:d3.event.clientY});return t?[t]:void 0}}function mv(i){var a,r,t=_.first(i).visualObjects;if(t.length>0){(a=t[0])&&a.selectorsByColumn&&(r=(0,at.fd)((0,at.tV)(a.selectorsByColumn)));var n=1===this.data.series.length;switch(a.objectName){case"lines":return r?(0,Pt.w3)(this.hostService,(0,g.__assign)((0,g.__assign)({},X.zK.lineStyles.strokeColor),{selector:r}),null):void k.fF.assertFail("LineChart - line subselection should never have no selector");case"area":return r?(0,Pt.w3)(this.hostService,void 0,(0,g.__assign)((0,g.__assign)({},X.zK.lineStyles.strokeColor),{selector:r})):void k.fF.assertFail("AreaChart - area subselection should never have no selector");case"markers":return r?(r=n?void 0:r,(0,Pt.w3)(this.hostService,void 0,(0,g.__assign)((0,g.__assign)({},X.zK.markers.color),{selector:r}))):void k.fF.assertFail("LineChart - marker subselection should never have no selector");case"data-labels":var s=this.data.series.find(function(y){var f;return(0,at.Ic)(null===(f=y?.identity)||void 0===f?void 0:f.getSelectorsByColumn(),a.selectorsByColumn)});if(!s)return;var o=n?void 0:r,l=this.getSeriesAxisProperties(s),u=(0,it.d6)(l,this.data.dataLabelsSettings),c=X.qn.labels,d={fontFamilyReference:(0,g.__assign)((0,g.__assign)({},c.fontFamily),{selector:o}),fontSizeReference:(0,g.__assign)((0,g.__assign)({},c.fontSize),{selector:o}),boldReference:(0,g.__assign)((0,g.__assign)({},c.bold),{selector:o}),italicReference:(0,g.__assign)((0,g.__assign)({},c.italic),{selector:o}),underlineReference:(0,g.__assign)((0,g.__assign)({},c.underline),{selector:o}),fontColorReference:(0,g.__assign)((0,g.__assign)({},c.color),{selector:o}),displayUnitsReference:(0,g.__assign)((0,g.__assign)({},c.labelDisplayUnits),{selector:o}),precisionReference:(0,g.__assign)((0,g.__assign)({},c.labelPrecision),{selector:o}),backgroundReference:(0,g.__assign)((0,g.__assign)({},c.backgroundColor),{selector:o})};return(0,Pt.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:n,individualSelector:vn.call(this,!n),selector:r,repetitionSelector:void 0,subSelectionStylesOptions:{precision:{defaultPrecision:u.getPrecision(!1,s.type)}}},d);case"total-labels":var v=X.qn.totals;return(0,Pt.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:n,individualSelector:vn.call(this,!n),selector:r,repetitionSelector:void 0},{fontFamilyReference:v.fontFamily,fontSizeReference:v.fontSize,boldReference:v.bold,italicReference:v.italic,underlineReference:v.underline,fontColorReference:(0,g.__assign)((0,g.__assign)({},v.color),{selector:(0,ut.hm)(vn.call(this,!1),void 0,void 0)}),displayUnitsReference:v.labelDisplayUnits,precisionReference:v.labelPrecision,backgroundReference:v.backgroundColor});default:return}}}function vn(i){return(0,lt.WD)({featureSwitches:this.featureSwitches,hasCategories:null!=_.first(this.originalData.categories),hasDynamicSeries:this.originalData.hasDynamicSeries,hasSeriesSelector:i})}function Sv(i,e){if(!e){var r,n,a=_.first(i).visualObjects;if(!(a.length>0))return;r=a[0],_.isEmpty(r.selectorsByColumn)||(n=(0,at.fd)((0,at.tV)(r.selectorsByColumn)));var s={key:"Delete",nextValue:!1};switch(r.objectName){case"lines":case"area":return n?[{type:0,excludedResetFormattingIds:[X.qn.labels.show,(0,g.__assign)((0,g.__assign)({},X.qn.labels.showSeries),{selector:n}),(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.showMarker),{selector:n}),{objectName:"seriesLabels",propertyName:"show",selector:n}]},(0,g.__assign)((0,g.__assign)({type:2},X.qn.labels.showSeries),{enabledLabel:this.localizer("Format_AddDataLabels"),selector:n}),(0,g.__assign)((0,g.__assign)({type:2},X.qn.lineStyles.showMarker),{enabledLabel:this.localizer("Format_AddMarkers"),selector:n,keyboardShortcuts:[s]}),(0,g.__assign)((0,g.__assign)({type:2},{objectName:"seriesLabels",propertyName:"show"}),{enabledLabel:this.localizer("Format_AddSeriesLabel"),selector:n}),{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.lineStyle),{selector:this.data.series.length>1?n:void 0}),label:this.localizer("Format_Line")}]:void k.fF.assertFail("LineChart - line subselection should never have no selector");case"markers":return n?[(0,g.__assign)((0,g.__assign)({type:2},X.qn.lineStyles.showMarker),{disabledLabel:this.localizer("Delete"),selector:n,keyboardShortcuts:[s]}),{type:0,excludedResetFormattingIds:[(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.showMarker),{selector:n})]},{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.markerShape),{selector:this.data.series.length>1?n:void 0}),label:this.localizer("Format_Markers")}]:void k.fF.assertFail("LineChart - marker subselection should never have no selector");default:return}}}function bv(i){var t,e=this,a=i.lineStyle,r=i.selector,n=i.containerItemBuilder,s=(0,ya.Iq)({containerItemBuilder:n,descriptors:{strokePattern:X.qn.lineStyles.lineStyle,strokeDashArray:X.qn.lineStyles.strokeDashArray,strokeAutoScale:X.qn.lineStyles.strokeAutoScale,strokeDashCap:X.qn.lineStyles.strokeDashCap,strokeLineJoin:X.qn.lineStyles.strokeLineJoin,strokeWidth:X.qn.lineStyles.strokeWidth},strokeData:a,selector:r,isSVGStroke:!0,featureSwitches:this.featureSwitches,localize:this.localizer});null===(t=s.find(function(o){return(0,Sr.cd)(o.getSimpleControlDescriptor(),X.zK.lineStyles.strokeLineJoin)}))||void 0===t||t.withDisabled(!a.strokeShow||a.interpolation===iv.Fu.smooth,"Visual_StrokeLineJoinDisabledReason"),n.addGroup("shape",function(o){return o.withDisplayName("Visual_Shape_Line").addSlices(s.map(function(l){return l.build()})).addSlices((0,Qn.Ie)({containerItemBuilder:n,descriptors:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles),{interpolation:X.qn.lineStyles.lineChartType}),interpData:a,selector:r,localize:e.localizer,featureSwitches:e.featureSwitches,disabledIfHasSelector:!0}).map(function(l){return l.build()}))})}function xv(i){var e,t,a,r=i.selector,n=i.lineStyle,s=i.containerItemBuilder,o=!r&&this.hasSingleStaticSeries,l=(0,ya.Iq)({containerItemBuilder:s,descriptors:{strokeColor:X.qn.dataPoint.fill,strokeTransparency:X.qn.lineStyles.strokeTransparency},strokeData:(0,g.__assign)((0,g.__assign)({},n),{strokeColor:o?null===(e=this.data.series[0])||void 0===e?void 0:e.lineStyle.strokeColor:n.strokeColor}),selector:r,colorSelector:o?(0,at.fd)(null===(t=this.data.series[0])||void 0===t?void 0:t.identity.getSelector()):r,featureSwitches:this.featureSwitches,localize:this.localizer});null===(a=l.find(function(u){return(0,Sr.cd)(u.getSimpleControlDescriptor(),X.zK.lineStyles.strokeColor)}))||void 0===a||a.withDisabled(!this.hasSingleStaticSeries&&!r,"Visual_Color_AllSeries_DisabledReason"),s.addGroup("colors",function(u){return u.withDisplayName("Generic_Color").addSlices(l.map(function(c){return c.build()}))})}function Cv(i){var e=this;this.isStacked&&null==i.selector&&(this.originalData.hasDynamicSeries||this.originalData.series.length>1)&&i.containerItemBuilder.addGroup("layout",function(t){return t.withDisplayName("Layout").addSimpleSlice("seriesOrderReversed",new F.bd({descriptor:X.qn.layout.seriesOrderReversed,value:e.data.layout.seriesOrderReversed}).build())})}function $u(i){var e=i.selector,t=i.lineStyle;i.containerItemBuilder.addSimpleSlice("showSeries",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},X.qn.lineStyles.strokeShow),{selector:e}),value:t.strokeShow}).build(),function(a){return a.withCustomDisplayName(e?"Visual_Show_Data_Labels_PerSeries":"Visual_ShowForAllSeries")}),bv.call(this,i),xv.call(this,i),Cv.call(this,i)}function Jo(i){var e=this,t=i.markerStyle,a=i.selector,r=i.listType;i.containerItemBuilder.addSimpleSlice("showMarker",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},X.zK.markers.show),{selector:a}),value:t.show}).build(),function(n){return n.withDisabled(!a).withHidden("perCategory"===r||"staticPerCategories"===r)}).addGroup("markers",function(n){return n.withDisplayName("Visual_Shape").withDisabled(!t.show||"perCategory"===r).addSimpleSlice("markerShape",new F.uY({descriptor:(0,g.__assign)((0,g.__assign)({},X.zK.markers.shape),{selector:a}),value:t.shape}).build()).addSimpleSlice("markerSize",new F.mu({descriptor:(0,g.__assign)((0,g.__assign)({},X.zK.markers.size),{selector:a}),value:t.size,options:{minValue:{type:0,value:Uu.min},maxValue:{type:1,value:Uu.max},unitSymbol:qi.e_}}).build()).addSimpleSlice("markerRotation",F.JN.getRotationSliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},X.zK.markers.rotation),{selector:a}),value:t.rotation,localize:e.localizer}).build(),function(s){return s.withHidden(!e.featureSwitches.newMarkerProperties||!(0,Xt.Cd)(t.shape))})}).addGroup("colors",function(n){return n.withDisplayName("Generic_Color").withDisabled(!t.show).addSimpleSlice("markerColor",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)({},"perCategory"===r?(0,g.__assign)((0,g.__assign)({},X.zK.dataPoint.fill),{instanceKind:1}):X.zK.markers.color),{selector:a}),value:{value:t.color}}).build()).addSimpleSlice("markerTransparency",F.JN.getTransparencySliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},X.zK.markers.transparency),{selector:a}),value:t.transparency,localize:e.localizer}).build(),function(s){return s.withHidden(!e.featureSwitches.newMarkerProperties)})}),this.featureSwitches.newMarkerProperties&&i.containerItemBuilder.addGroup("border",function(n){return n.withDisplayName("Visual_Border").withDisabled(!(0,Xt.nK)(t.shape)||!t.show||"perCategory"===r).addSlices((0,ya.Iq)({containerItemBuilder:n,descriptors:qe.$9,strokeData:t.stroke,selector:a,featureSwitches:e.featureSwitches,localize:e.localizer}).map(function(s){return s.build()}))})}function Av(i,e){if(!this.featureSwitches.onObject||1!==e)return[];var t=this.isComboChart?Qi.OA:X.qn,a=this.data.series.map(function(o){return{selector:o.identity.getSelector(),value:o.lineStyle.markerProperties.show}}),r=this.data.series.map(function(o){var l;return{selector:o.identity.getSelector(),value:null===(l=o.seriesLabelSettings)||void 0===l?void 0:l.show}}),n=this.data.series.map(function(o){var l;return{selector:o.identity.getSelector(),value:null===(l=o.labelSettings)||void 0===l?void 0:l.show}}),s=[Ji.v.create(t.lineStyles.showMarker,this.data.lineStyle.markerProperties.show,a).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(t.lineStyles.showMarkerByDefault,!1,{required:!0}),Ot.W.createBooleanDataViewObjectChange(t.lineStyles.showMarker,!0,{required:!0})).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("lineStyles",{required:!0})),ki.$.create(t.lineStyles.showMarker,this.data.lineStyle.markerProperties.show).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("lineStyles",{required:!0})),Ji.v.create(X.qn.seriesLabels.backgroundColor,this.data.seriesLabelSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(X.qn.seriesLabels.enableBackground,!0,{required:!0,inheritSelector:!0})),ki.$.create(X.qn.seriesLabels.backgroundColor,this.data.seriesLabelSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(X.qn.seriesLabels.enableBackground,!0,{required:!0})),Ji.v.create(X.qn.seriesLabels.show,this.data.seriesLabelSettings.show,r).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(X.qn.seriesLabels.showByDefault,!1,{required:!0}),Ot.W.createBooleanDataViewObjectChange(X.qn.seriesLabels.show,!0,{required:!0})).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("seriesLabels",{required:!0})),ki.$.create(X.qn.seriesLabels.show,this.data.seriesLabelSettings.show).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("seriesLabels",{required:!0})),Ji.v.create(t.labels.backgroundColor,this.data.dataLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(t.labels.enableBackground,!0,{inheritSelector:!0})),ki.$.create(t.labels.backgroundColor,this.data.dataLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(t.labels.enableBackground,!0)),Ji.v.create(t.labels.showSeries,this.data.dataLabelsSettings.show,n).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange(t.labels.showByDefault,!1),Ot.W.createBooleanDataViewObjectChange(t.labels.show,!0)).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("labels")),ki.$.create(t.labels.show,this.data.dataLabelsSettings.show).onToggleDisabled(Ot.W.createRevertToDefaultDataViewObjectChange("labels"))];return ie.o.getDataViewObjectsBehaviorChanges(i,s)}var Dv=function(){function i(e){this.dataPoints=e.dataPoints,this.isComboChart=e.isComboChart,this.isScalar=e.isScalar,this.hasCategories=e.hasCategories}return i.prototype.queryRegion=function(e){var t=this,a=[],r=e.dataSpace;return(this.isScalar||this.hasCategories&&void 0!==r.left&&void 0!==r.right)&&(a=_.filter(this.dataPoints,function(n){return(0,Lt.bl)(r.left.value,t.isScalar?n.categoryValue:n.categoryIndex)&&(0,Lt.bl)(t.isScalar?n.categoryValue:n.categoryIndex,r.right.value)&&(0,Lt.bl)(t.getBottom(r,n),n.value)&&(0,Lt.bl)(n.value,t.getTop(r,n))})),a},i.prototype.getBottom=function(e,t){return t.isY2||this.isComboChart&&e.bottom2?e.bottom2.value:e.bottom.value},i.prototype.getTop=function(e,t){return t.isY2||this.isComboChart&&e.top2?e.top2.value:e.top.value},i}(),Jn=(0,Me.CH)("line"),Hs=(0,Me.CH)("focus-element"),tc=(0,Me.CH)("position-rect"),el=(0,Me.CH)("cat"),$n=(0,Me.CH)("catArea"),ac=(0,Me.CH)("dot"),ic=(0,Me.CH)("point"),tl=(0,Me.CH)("circle-item"),Ws=(0,Me.CH)("marker-line"),al=(0,Me.CH)("interactivity-line"),il=(0,Me.CH)("selected-markers"),wr="path",Gs="circle",rc=(0,Me.CH)("selection-circle"),nc=(0,Me.CH)("selection-circles");function Rv(i,e){var t=this,a=this.getChartX(i);e.length>0&&sc.call(this,a),this.hoverLineContext.selectAll(tl.selector).data(_.filter(e,function(r){return r.showHoverlineDots&&null!=r.value})).join(function(r){return r.append(Gs).classed(tl.class,!0)}).attr("fill",function(r){return r.marker.color}).attr("r",Es(this.data.lineStyle)).attr("cx",a).attr("cy",function(r){return $i(t.viewModel,r)})}function Iv(){this.hoverLine.style("opacity",Et.OH),this.hoverLineContext.selectAll(tl.selector).remove()}function zv(){this.hoverLineContext=this.mainGraphicsSVG.append("g").classed("hover-line",!0),this.hoverLine=this.hoverLineContext.append("line").classed("interactive",this.mobileTileInteractive).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0).style("opacity",Et.OH).style("stroke",J.v.getThemeColor(this.style,"foregroundNeutralSecondary")),this.mobileTileInteractive&&(this.dragHandle=this.hoverLineContext.append("circle").attr("cx",0).attr("r","6px").classed("drag-handle",!0),this.hoverLineContext.append("g").classed(nc.class,!0))}function sc(i){this.hoverLine.attr("x1",i=i||0).attr("x2",i).attr("y1",0).attr("y2",this.availableHeight).style("opacity",1)}function Ev(i,e){var t=this;sc.call(this,i),this.mobileTileInteractive&&(this.dragHandle.attr("cx",i).attr("cy",this.availableHeight),this.hoverLineContext.select(nc.selector).selectAll(rc.selector).data(this.activeData.series,function(a){return a.identity.getKey()}).join(function(a){return a.append(Gs).classed(rc.class,!0)}).attr("r",Es(this.activeData.lineStyle)).attr("cx",i).attr("cy",function(a){return a.data[e]?$i(t.viewModel,a.data[e]):0}).style("opacity",function(a){return _.some(a.data,function(r){return!!r&&r.categoryIndex===e})?1:0}).style("fill",function(a){return a.lineStyle.strokeColor}))}function es(i){return i&&null!==i.value}function rl(i,e){return(e?_.findLast:_.find)(i.data,function(a,r,n){var s=e?n[r-1]:n[r+1];return null!=a&&null!=a.value&&null!=s&&null!=s.value})}var oc={findSubSelectedAreaElement:function(e,t){if(null!=e.renderContext.mainGraphicsSVG){var a=e.renderContext.mainGraphicsSVG.selectAll(Jn.selector).filter(function(n){return n.data.some(function(s){return es(s)})}).nodes(),r=function(i,e,t){for(var a,r=Number.MAX_VALUE,s=i.renderContext.mainGraphicsSVG.node().getBoundingClientRect(),o=s.left,l=s.top,u=0;u<t.length;u++){var d=Xv(e.x,t[u],function(v){return Ar.convertSvgXToClientX(v,i.currentViewport.scale,o)},function(v){return Ar.convertSvgYToClientY(v,i.currentViewport.scale,l)}).y,h=e.y-d;h>=-4&&r>(h=Math.abs(h))&&(r=h,a=u)}return a}(e,t,a);if(null!=r)return e.renderContext.mainGraphicsSVG.selectAll($n.selector).filter(function(n){return n.index===r}).node()}}};function Xv(i,e,t,a){for(var n,l,s=0,o=e.getTotalLength();n=e.getPointAtLength(l=s+o>>1),(0,Et.lO)(n),t&&(n.x=t(n.x)),a&&(n.y=a(n.y)),l!==o&&l!==s||n.x===i;)if(n.x>i)o=l;else{if(!(n.x<i))break;s=l}return n}function js(i,e){return i.renderContext.mainGraphicsContext.selectAll(Hs.selector).data(e?[e]:[]).join(function(t){return t.append(Gs).attr("class",Hs.class).attr("tabindex",0).attr("focusable",!0).attr("role","option").classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge())}).attr("aria-selected",function(t){return t.selected}).attr("aria-label",function(t){var a,r;if(qo(t))return i.hostService.getLocalizedString("Anomaly_ScreenReader_Hint");var n=!1;Bs(i.activeData)&&(n=_.some(i.activeData.anomalyDetections[0].anomaliesCategoryIndex,function(l){return l===t.categoryIndex}));var o=(0,Un.X)(t.tooltipInfo);return!(null===(a=t?.uncertainty)||void 0===a)&&a.upperTooltip&&(o+=" ".concat((0,Un.X)([t.uncertainty.upperTooltip]))),!(null===(r=t?.uncertainty)||void 0===r)&&r.lowerTooltip&&(o+=" ".concat((0,Un.X)([t.uncertainty.lowerTooltip]))),n&&(o+=" ".concat(i.hostService.getLocalizedString("AnomalyPoint_ScreenReader_Hint"))),o}).attr("cx",function(t){return si(i,t)}).attr("cy",function(t){return qo(t)?(0,zs.v8)(t,i.yAxisProperties.scale,i.activeData.anomalyDetections[0].marker.size):$i(i,t)}).attr("r",function(t){return qo(t)?(0,zs.bj)(i.activeData.anomalyDetections[0].marker.size):t.marker.show?t.marker.size*za.Wo.sizeRatio:t.marker.focusOnlySize}).style("fill","none")}var Zv=function(){function i(e,t,a){this.tooltipService=e,this.mainGraphicsSVG=t,this.supportsHoverLineTooltip=a,this.isHoverLineTooltipActive=!1,a&&(this.hoverLineTooltipOverlay=t.append("rect").classed(ju.class,!0))}return i.prototype.applyTooltips=function(e,t,a){!this.supportsHoverLineTooltip||e.activeData.binnedLineSamplingApplied&&e.activeData.hasDynamicSeries?this.applyPointTooltip(e,t,a):this.applyHoverLineTooltip(e,t,a)},i.prototype.removeTooltips=function(e,t){this.removePointTooltip(e),this.removeHoverLineTooltip(t)},i.prototype.applyHoverLineTooltip=function(e,t,a){this.removePointTooltip(e),this.hoverLineTooltipOverlay.attrs({x:0,width:e.availableWidth,height:e.availableHeight}),this.tooltipService.addTooltip(this.mainGraphicsSVG,function(s){var c,l=t.getCategoryIndexFromTooltipEvent(s,s.elementCoordinates[0]),u=a.getHoverLineDataForCategory(l);return u&&u.hasUncertainty&&(c=t.getYValueFromTooltipEvent(s.elementCoordinates[1],s.context)),i.getSeriesTooltipInfo(u,c)},function(n){return i.getCategoryIdentityForHoverLineTooltipEvent(t,a,n)},!0),this.mainGraphicsSVG.on("mouseout.hoverline",function(){return a.clearHoverLine()}),this.mainGraphicsSVG.on("touchmove.hoverline",function(){return a.clearHoverLine()}),this.setHoverLineTooltipActive(!0)},i.prototype.removeHoverLineTooltip=function(e){this.isHoverLineTooltipActive&&(e.clearHoverLine(),this.tooltipService.removeTooltips(this.mainGraphicsSVG),this.mainGraphicsSVG.on(".hoverline",null),this.setHoverLineTooltipActive(!1))},i.prototype.setHoverLineTooltipActive=function(e){this.isHoverLineTooltipActive=e},i.prototype.applyPointTooltip=function(e,t,a){this.removeHoverLineTooltip(a);var n=e.isComboChart?function(o){return i.getCategoryIdentityForHoverLineTooltipEvent(t,a,o)}:function(o){return o.data&&[o.data.identity]},s=function(l){var u;return null===(u=l.data)||void 0===u?void 0:u.tooltipInfo};this.tooltipService.addTooltip(e.interactivityLines,function(l){return t.getTooltipInfoForPoint(l,l.elementCoordinates[0])},n,!0),this.tooltipService.addTooltip(e.dots,s,n,!0),this.tooltipService.addTooltip(e.explicitDots,s,n,!0),this.tooltipService.addTooltip(e.focusElement,s,n,!0)},i.prototype.removePointTooltip=function(e){this.isHoverLineTooltipActive||(this.tooltipService.removeTooltips(e.interactivityLines),this.tooltipService.removeTooltips(e.dots),this.tooltipService.removeTooltips(e.explicitDots))},i.getCategoryIdentityForHoverLineTooltipEvent=function(e,t,a){var r;if(a){if(a.data&&Yu(a.data))return null;var s=e.getCategoryIndexFromTooltipEvent(a,a.elementCoordinates[0]);return t.getHoverLineIdentities(s,null===(r=a.data)||void 0===r?void 0:r.data)}},i.getSeriesTooltipInfo=function(e,t){var a,r,n,s,o;if(!e)return null;var l=e.dataPoints;if(_.isEmpty(l))return null;var u={show:!1,color:"#000000",transparency:100,shape:Xt.ZO.circle},c=!_.isEmpty(l)&&l[0].seriesDisplayName,d=[],h=function(H){return!(d.length>=i.MaxNumberOfItems||(d.push(H),0))},v=e.legendMarkerRendering,y=v!==hn._.markerOnly&&v!==hn._.markerCircleDefault,f=l[0].additionalTooltipItems,S=function(H){return y?H.line:void 0};if(l.every(function(j){return _.isEqual(j.additionalTooltipItems,f)})){var m=[];for(var b in l)if(null!=(x=l[b]).value){if(!h({header:x.category,subheader:x.multipleDisplayName,displayName:x.seriesName||x.measureDisplayName,value:null!==(n=null===(r=null===(a=x.uncertainty)||void 0===a?void 0:a.rangeTooltip)||void 0===r?void 0:r.value)&&void 0!==n?n:x.formattedValue,marker:x.marker,line:S(x)}))break;m.push(+b)}e.hasUncertainty&&(k.fF.assertValue(t,"expect to have VerticalPositionInfo if uncertainty information present"),d=function(i,e,t,a){k.fF.assert(function(){return i.length===t.length},"augmentTooltipInfoWitUncertainty -- expected length of tooltipItems and mapping array to be identical");for(var r=[],n=1/0,s=-1,o=0,l=t.length;o<l;o++)if((c=e[t[o]]).uncertainty)if(c.isY2)(d=Math.abs(c.value-a.y2.point))<a.y2.threshold?r.push(o):d<n&&(n=d,s=o);else{var d;(d=Math.abs(c.value-a.y.point))<a.y.threshold&&r.push(o),d<n&&(n=d,s=o)}var h=[];for(o=0,l=t.length;o<l;o++){var c=e[t[o]],v=i[o];if(_.includes(r,o)||s===o){var f=c.uncertainty;k.fF.assertValue(f,"added point as having error when no uncertainty info exists"),f.upperTooltip&&h.push((0,g.__assign)({header:c.category,subheader:c.multipleDisplayName},f.upperTooltip)),h.push(v),f.lowerTooltip&&h.push(f.lowerTooltip)}else h.push(v)}return h}(d,l,m,t));for(var C=0,A=f??[];C<A.length&&h({displayName:(T=A[C]).displayName,value:T.value,marker:u});C++);}else for(var P=0,D=l;P<D.length;P++){var x=D[P];if(d.length>=i.MaxNumberOfItems)break;if(null!=x.value){c&&h({header:x.category,subheader:x.multipleDisplayName,displayName:x.seriesDisplayName,value:x.seriesName,marker:x.marker,line:S(x)}),h({header:x.category,subheader:x.multipleDisplayName,displayName:c?x.measureActualDisplayName:x.measureDisplayName,value:x.formattedValue,marker:c?u:x.marker,line:c?void 0:S(x)});for(var L=0,O=null!==(s=x.additionalTooltipItems)&&void 0!==s?s:[];L<O.length&&h({header:x.category,subheader:x.multipleDisplayName,displayName:(T=O[L]).displayName,value:T.value,marker:u});L++);}}for(var B=0,E=null!==(o=e.additionalTooltipItems)&&void 0!==o?o:[];B<E.length;B++){var T;if(!h({header:l[0].category,subheader:l[0].multipleDisplayName,displayName:(T=E[B]).displayName,value:T.value,marker:u}))break}return 0===d.length?null:d},i.MaxNumberOfItems=15,i}(),Mi=X.zK.general.formatString,qv=function(i){function e(t){var a=i.call(this,t)||this;return a.options=t,a.pathXAdjustment=0,a.deferDragMoveOperation=(0,uu.S5)(function(){if(a.lastDragMoveXPosition&&a.data&&a.margin){var r=e.findCategoryIndex({pointX:a.lastDragMoveXPosition-a.margin.left,offsetX:0,categoryData:a.data.categoryData,currentViewport:a.currentViewport,scale:a.xAxisProperties.scale,categoryThickness:a.xAxisProperties.categoryThickness,isScalar:a.data.isScalar});a.selectColumn(r),a.lastDragMoveXPosition=void 0}}),a.tooltipsEnabledOnHost=t.tooltipsEnabled,a.markerRenderer=new za.Wo,a.anomalyNavigationHelper=new Jh.B,a}return(0,g.__extends)(e,i),e.getInteractiveLineChartDomElement=function(t){return t.children("svg").get(0)},e.createStackedValueDomain=function(t,a){if(k.fF.assertValue(t,"data"),0===t.length)return null;var r=[d3.min(t,function(s){return d3.min(s.data,function(o){return o&&o.stackedValue})}),d3.max(t,function(s){return d3.max(s.data,function(o){return o&&o.stackedValue})})];if(a){var n=1e-4;r[0]=(0,Lt.W0)(r[0],n),r[1]=(0,Lt.W0)(r[1],n)}return r},Object.defineProperty(e.prototype,"lineChartType",{get:function(){return this.options.lineChartType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAreaChart",{get:function(){return 2===this.lineChartType||16===this.lineChartType||32===this.lineChartType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStacked",{get:function(){return 16===this.lineChartType||32===this.lineChartType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStacked100",{get:function(){return 32===this.lineChartType},enumerable:!1,configurable:!0}),e.prototype.initRenderer=function(t){var a=this;if(i.prototype.initRenderer.call(this,t),this.svg.classed(e.ClassName,!0),this.mainGraphicsSVG=this.svg.append("svg").classed(e.lineChartSVGClassName,!0),this.svgDefs=this.mainGraphicsSVG.append("defs"),this.lineChartTooltipHelper=new Zv(this.tooltipService,this.mainGraphicsSVG,!this.isComboChart&&!this.mobileTileInteractive),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").attr("role","listbox").attr("aria-label",this.localizer("Visual_Plot")).attr("aria-live","polite").classed(e.MainGraphicsContextClassName,!0),this.mainGraphicsContext.append("g").attr("class",il.class),this.interactivityService&&(this.isComboChart?this.mainGraphicsContext.attr(Yn.Rh,!0):(t.useManagedTabIndex?this.mainGraphicsContext.classed(Ts.rG.class,!0).attr(Yn.Rh,!0):this.mainGraphicsContext.attr("tabindex",0).attr("focusable",!0),this.mainGraphicsContext.classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()))),zv.call(this),this.xAxisProperties={d3Axis:null,scale:null,valueType:null,formatter:null,graphicsContext:null,values:[],axisLabel:null,isCategoryAxis:!0},this.mobileTileInteractive){var n=e.getInteractiveLineChartDomElement(this.element),s=function(){a.lastDragMoveXPosition=d3.mouse(n)[0],a.deferDragMoveOperation()},o=d3.drag().on("drag",s);d3.select(n).style("touch-action","none").call(o).on("click",s)}},e.prototype.setData=function(t,a){var r,n,s;if(this.data=this.originalData={series:[],totals:[],legendData:(0,da.Fe)(this.style),isScalar:!1,dataLabelsSettings:Ko(this.style,this.isComboChart,this.isStacked100),seriesLabelSettings:Hn(this.style),hasDynamicSeries:!1,hasHighlights:!1,categories:[],categoryMetadata:void 0,valuesMetadata:[],categoryData:[],categoryIdentities:[],lineStyle:Zo(),binnedLineSamplingApplied:!1,legendMarkerRendering:hn._.markerCircleDefault,matchLineColor:!1,layout:{seriesOrderReversed:!1}},this.focusedDatum=void 0,_.isEmpty(t))this.dataView=void 0;else{var o=_.first(t);if(o?.categorical){this.dataView=o;var c,l=o.categorical.categories,u={text:!0};l&&!_.isEmpty(l)&&(l[0].source&&l[0].source.type&&(u=l[0].source.type),c=(0,xt.A8)(l[0]));var d=null===(r=this.hostService)||void 0===r?void 0:r.tooltips(),h=this.tooltipsEnabled=this.tooltipsEnabledOnHost&&(!d||d?.enabled());this.data=this.originalData=Qu.convert({dataView:o,style:this.style,isScalar:(0,xt.PX)(null!==(s=null===(n=o.metadata)||void 0===n?void 0:n.objects)&&void 0!==s?s:null,X.zK.categoryAxis.axisType,u,c,(0,oe.n$)(o)),interactivityService:this.interactivityService,isComboChart:this.isComboChart,tooltipsEnabled:h,forecastDataView:_.find(t,function(p){return(0,gr.Aq)(p)}),anomalyDetectionDataView:_.find(t,function(p){return(0,Bn.Ik)(p)}),isStacked:this.isStacked,isAreaChart:this.isAreaChart,isStacked100:this.isStacked100,multipleInfo:a,supportsTotalLabels:!a&&this.supportsTotalLabels(),featureSwitches:this.featureSwitches,hostServices:this.hostService});var y=this.data.categoryIdentities;this.suppressAnimation=e.shouldSuppressAnimations(this.previousCategoryIds,y),this.previousCategoryIds=y;var f=_.find(this.data.series,function(p){return p.data[0]});this.focusedDatum=f?.data[0]}}},e.shouldSuppressAnimations=function(t,a){var r;if(null!=t&&!(t.length>tn.dt||a.length>tn.dt))if(r=!1,0===t.length)r=!0;else for(var n=0,s=Math.min(t.length,a.length);n<s;n++)if(!Tt.l0.isEqual(t[n],a[n])){r=!0;break}return r},e.prototype.getCategoryDomain=function(t){var a;return bt(t.series,this.getCategoryValueType(),t.isScalar,[Yt(null===(a=e.getForecastDomain(t.forecastLines))||void 0===a?void 0:a.x,0)])},e.prototype.getAxesDomains=function(t,a){var r,n,s,o;if(!this.data)return{};var l=this.data,u={};if(a.categoryAxis&&l.isScalar){var c=this.getCategoryDomain(l);if(c){Ca(c.domain);var d=(r=c.domain)[0],h=r[1];void 0!==d&&void 0!==h&&(u.categoryAxis=[d,h])}}if(a.valueAxis||a.secondaryValueAxis){var v=null===(o=e.getForecastDomain(l.forecastLines))||void 0===o?void 0:o.y;if(a.valueAxis){var f=(n=ii(v,this.getValueDataDomain(t,!1)))[0],p=n[1];void 0!==f&&void 0!==p&&(u.valueAxis=[f,p])}if(a.secondaryValueAxis){var m=(s=ii(v,this.getValueDataDomain(t,!0)))[0],b=s[1];void 0!==m&&void 0!==b&&(u.secondaryValueAxis=[m,b])}}return u},e.prototype.getValueDataDomain=function(t,a){var r=e.getDataForValueAxis(this.data,a).seriesData;return this.isStacked?e.createStackedValueDomain(r,this.isStacked100):Cs(r,t)},e.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&(this.data.series.length>1||this.data.valuesMetadata.length>1))},e.prototype.setFilteredData=function(t,a){var r=(0,be.ED)(this.data);r.series=e.sliceSeries(r.series,t,a),r.categories=r.categories.slice(t,a),this.clippedData=r},e.getCategoryCount=function(t){var a;return(null===(a=t.series)||void 0===a?void 0:a.length)>0?t.series[0].data.length:0},e.prototype.getSeriesLabelsSettings=function(){return(0,be.ED)(this.data).seriesLabelSettings},e.getForecastDomain=function(t){if(!_.isEmpty(t)){for(var a=[],r=[],n=0,s=t;n<s.length;n++){var o=s[n];_.isEmpty(o.points)||(a.push.apply(a,_.map(o.points,function(l){return l.point.x})),r.push.apply(r,_.map(o.points,function(l){return l.point.y})),a.push.apply(a,_.map(o.points,function(l){return l.upperBound.x})),r.push.apply(r,_.map(o.points,function(l){return l.upperBound.y})),a.push.apply(a,_.map(o.points,function(l){return l.lowerBound.x})),r.push.apply(r,_.map(o.points,function(l){return l.lowerBound.y})))}return{x:d3.extent(a),y:d3.extent(r)}}},e.prototype.calculateAxesProperties=function(t){var r,n,s,o,l,a=this;this.updateCurrentViewport(t);var u=t.categoryAxisOptions,c=t.valueAxisOptions,d=e.getCategoryCount(this.data),h=this.data?Ua({data:this.data,availableWidth:this.availableWidth,categoryCount:d,preferredCategoryWidth:null!==(n=null===(r=this.data)||void 0===r?void 0:r.preferredCategoryWidth)&&void 0!==n?n:null,domain:null===(o=bt(this.data.series,Ut(null===(s=this.data)||void 0===s?void 0:s.categoryMetadata),this.getVisualCategoryAxisIsScalar(),[t.categoryAxisOptions.includeDomain]))||void 0===o?void 0:o.domain,isScalar:this.getVisualCategoryAxisIsScalar(),cartesianOptions:this.options,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio}):Er(),v=this.adjustLayoutForScroll(this.data,d,t.trimOrdinalDataOnOverflow,h),y=v.series,f=!1,p=this.data.valuesMetadata;if(_.some(y,function(ge){return ge.isY2})){var S=e.getDataForValueAxis(v,f=t.roleName===Sa.R.Y2);y=S.seriesData,p=S.valuesMetadata}var m=!_.isEmpty(v.series)&&v.series[0].xCol,b=!_.isEmpty(y)&&y[0].yCol,x=this.getAxesDomains(!1,{categoryAxis:!0,valueAxis:!f,secondaryValueAxis:f}),C=As(y),A=Yt(f?x.secondaryValueAxis:x.valueAxis,0);A=ga(c.includeDomain,A);var T=v.isScalar?ga(Yt(x.categoryAxis,0),u.includeDomain):this.getCategoryDomain(v),P=this.getPreferredPlotArea(h),D=function(Ae){var Pe,se="x"===Ae,Se="y"===Ae,Fe=se?u:c;return{pixelSpan:se?P.width:P.height,domainOptions:se?T:A,metaDataColumn:se?m:p,axisZoom:t.axisZoom,isScalar:Se||v.isScalar,isVertical:Se,isCategoryAxis:se,forcedTickCount:t.forcedTickCount,axis:(0,g.__assign)((0,g.__assign)({},Fe.axis),{invertAxis:Fe.axis.invertAxis&&(Se||v.isScalar)}),useTickIntervalForDisplayUnits:!0,margin:a.margin,includeZero:!!Se&&a.isStacked&&(null===(Pe=a.data)||void 0===Pe?void 0:Pe.series.length)>1&&oa(Fe.includeDomain),zeroScalarDomain:e.DefaultZeroScalarDomain,formatString:se?(0,we.EO)(m,Mi):a.isStacked100?a.hostService.getLocalizedString("Percentage"):C??(0,we.EO)(b,Mi),outerPadding:se&&v.isScalar?e.ScalarOuterPadding:0,outerPaddingRatio:se?h.outerPaddingRatio:0,categoryThickness:se?h.categoryThickness:void 0,allowSingleScalarTick:!!se&&v.isScalar,maxTickCount:se?v.scalarKeyCount:void 0,preventNice:se?!!v.isScalar&&Ya(T):Ya(A),shouldClamp:!Se&&void 0,isSecValueAxis:Se?f||a.isComboChart:void 0,is100Pct:Se&&a.isStacked100,getValueFn:se?function(Ie,xe){return Yi(v,Ie,xe,v.isScalar)}:void 0}},L=Ra(D("y")),O=!1,B=0,E=!1;if(L.dataDomain&&_.isNumber(L.dataDomain[0])&&_.isNumber(L.dataDomain[1])&&(O=(null===(l=v.totalLabelsSettings)||void 0===l?void 0:l.show)&&this.supportsTotalLabels(),B=e.getMaximumMarkerSize(v.series),E=_.some(v.anomalyDetections,function(ge){return-1!==ge.highestAnomalyPointIndex||-1!==ge.lowestAnomalyPointIndex})),O||B||E){k.fF.assert(function(){return!!L.dataDomain&&_.isNumber(L.dataDomain[0])&&_.isNumber(L.dataDomain[1])});var j=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],H=!1,Z=function(Ae){j=[Math.min(j[0],Ae[0]),Math.max(j[1],Ae[1])],H=!0};if(O){var ve=e.adjustDomainForLabels(L,v);ve.adjusted&&Z(ve.domain)}if(B){var fe=e.adjustDomainCommon(L,B);fe.adjusted&&Z(fe.domain)}E&&Z((0,Gu.LS)(L.dataDomain,L.scale,v.anomalyDetections)),H&&(L=Ra((0,g.__assign)((0,g.__assign)({},D("y")),{domainOptions:ga(c.includeDomain,A,Yt(j,0)),preventNice:!0})))}f?this.y2AxisProperties=L:this.yAxisProperties=L;var re=Ra(D("x"));return this.interactivityService&&!this.data.isScalar&&(re.categoryIdentities=_.map(v.categoryIdentities,function(ge){return function(){return ge}})),[re,L]},e.prototype.getCategoryValueType=function(){return Ut(this.data.scalarMetadata||this.data.categoryMetadata)},e.getDataForValueAxis=function(t,a){var n=t.valuesMetadata,s=a?{roles:{Y2:!0}}:{roles:{Y:!0}};return{seriesData:_.filter(t.series,function(o){return o.isY2===a}),valuesMetadata:_.filter(n,s)}},e.prototype.adjustLayoutForScroll=function(t,a,r,n){if(this.clippedData=void 0,t&&!t.isScalar&&!this.options.isScrollable&&r){var s=Math.min(a,n.categoryCount);a!==s&&((t=this.clippedData=(0,be.ED)(t)).series=e.sliceSeries(t.series,0,s),t.categories=t.categories.slice(0,s),t.categoryIdentities&&(t.categoryIdentities=t.categoryIdentities.slice(0,s)))}return t},e.prototype.setAxesLayout=function(t){this.updateCurrentViewport(t.layout),this.xAxisProperties=t.layout.axes.x,2&t.axisType&&(this.isComboChart?this.yAxisProperties=t.layout.axes.y2:this.y2AxisProperties=t.layout.axes.y2),1&t.axisType&&(this.yAxisProperties=t.layout.axes.y1);var a=this.data?{categoryCount:this.xAxisProperties.values.length,categoryThickness:this.xAxisProperties.categoryThickness,outerPaddingRatio:this.xAxisProperties.outerPaddingRatio,innerPaddingRatio:this.xAxisProperties.innerPaddingRatio,isScalar:this.getVisualCategoryAxisIsScalar()}:Er();this.data=this.adjustLayoutForScroll(this.data,e.getCategoryCount(this.data),t.trimOrdinalDataOnOverflow,a)},e.adjustDomainForLabels=function(t,a){var r=e.getCategoryCount(a)?a.series[0].data[0].labelFormatString:"",n=(0,lt.fI)(),s=(0,it.d6)(t,a.totalLabelsSettings),o=n.getOrCreate(r,a.totalLabelsSettings,s.units,a.totalLabelsSettings.precision),l=t.dataDomain[0].toString(),u=(0,it.Bw)(o.format(l)),c=(0,We.qk)(a.totalLabelsSettings.fontProperties,u),d=Le.b.estimateSvgTextHeight(c);return e.adjustDomainCommon(t,d+ye.FJ)},e.getMaximumMarkerSize=function(t){return t.length>0?d3.max(t,function(a){return a.lineStyle.markerProperties.show?a.lineStyle.markerProperties.size:0})*za.Wo.sizeRatio:0},e.adjustDomainCommon=function(t,a){var r=t.dataDomain,n=t.scale.domain(),s=t.scale,o=s(r[0])+a,l=s(r[1])-a,u=s.invert(o),c=s.invert(l);return Ft(n[0],n[1],u,c)},e.prototype.getFormattingCards=function(t){return rv.call(this,t)},e.prototype.getDisambiguationSubSelectables=function(t,a){return fv.call(this,t,a)},e.prototype.getSelectorsByColumnFromSubselectedElement=function(t){return pv.call(this,t)},e.prototype.getSubSelectionCustomOutlines=function(t){return gv.call(this,t)},e.prototype.getSubSelectionCustomElements=function(t){return yv.call(this,t)},e.prototype.getSubSelectionStyles=function(t){return mv.call(this,t)},e.prototype.getSubSelectionShortcuts=function(t,a){return Sv.call(this,t,a)},e.prototype.enumerateObjectInstances=function(t,a){return hv.call(this,t,a)},e.prototype.getDataViewObjectLayerChanges=function(t,a){return Av.call(this,t,a)},e.prototype.showSeriesCard=function(){return!(this.isComboChart&&!this.data.hasY2Role)},e.prototype.supportsTotalLabels=function(){return!(this.data&&this.data.multipleIdentity)&&16===this.lineChartType},e.prototype.supportsTrendLine=function(){return!this.data.multipleIdentity&&!this.isStacked&&this.getVisualCategoryAxisIsScalar()&&this.data.hasValues&&!(this.haveY2Data()&&!this.isComboChart)},e.prototype.supportsStaticReferenceLines=function(){return this.getVisualCategoryAxisIsScalar()},e.prototype.supportsForecast=function(){return!this.data.multipleIdentity&&!this.isStacked&&this.getVisualCategoryAxisIsScalar()&&this.data.hasValues&&1===this.data.series.length&&!this.hasLegend()},e.prototype.supportsAnomalyDetection=function(){return!this.data.multipleIdentity&&this.featureSwitches.daxTransformEnabled&&!this.isStacked&&this.data.hasValues},e.prototype.supportsPerCategoryMarker=function(){return!this.isComboChart},e.prototype.shouldSuppressAnimation=function(){return!!this.suppressAnimation},e.prototype.showLabelPerSeries=function(){var t=this.originalData;return t.series.length>1||!t.categoryMetadata||this.isComboChart},e.prototype.getSeriesAxisProperties=function(t){return t.isY2?this.y2AxisProperties:this.yAxisProperties},e.prototype.render=function(t,a,r){var n=this,s=this.suppressAnimation?0:(0,tn.Mb)(this.animator,t),o=this.viewModel;this.mainGraphicsPositionRect=this.mainGraphicsSVG.selectAll(tc.selector).data(function(u){return!n.lineChartTooltipHelper.hoverLineTooltipOverlay&&r?[u]:[]}).join("rect").attrs({x:0,width:0,height:0}).style("pointer-events","none").classed(tc.class,!0),(0,zs.WI)(this.data.anomalyDetections,this.mainGraphicsSVG,this.xAxisProperties.scale,this.yAxisProperties.scale,s,this.hostService,this.isVisualInteractive),this.anomalyNavigationHelper.update(Bs(this.data)?this.data.anomalyDetections[0].anomalies:[],this.clippedData,this.focusedDatum,function(u){return js(o,u)},this.mainGraphicsContext);var l=function(i,e,t){var a,r,n,s,o=i.renderContext,l=i.plotAreaHelper,u=i.lineChartTooltipHelper,c=i.tooltipInteractivity,d=i.markerRenderer,h=i.style,v=i.hostService,y=i.isStackedArea,f=i.isStacked100,p=i.currentViewport,S=i.interactivityService,m=i.mobileTileInteractive,b=i.featureSwitches,x=i.isComboChart,C=i.activeData;if(C){for(var A=C.isScalar,T=_.filter(C.series,function(I){var ce;return null===(ce=I.uncertainty)||void 0===ce?void 0:ce.renderUncertainty}),P=!_.isEmpty(T),D=!x,L=[],O=0,B=C.series;O<B.length;O++)L.push((E=B[O]).lineStyle.markerProperties);P&&(0,Jt.iD)(C.series,L),d.ensureMarkers(o.svgDefs,L);var j=i.yAxisProperties.scale,H=null===(a=i.y2AxisProperties)||void 0===a?void 0:a.scale,Z=S?.hasSelection(),ve=_.filter(C.series,function(I){return I.lineStyle.areaShow}),fe=ve.length>0;(C.categories.length*C.series.length>tn.dt||ma.M.isInternetExplorerOrEdge()&&_.some(L,function(I){return I.show})||fe)&&(e=0);var ge=function(ce){return si(i,ce)},Ae=function(ce){return $i(i,ce)},Pe=y?function(I){return j(I.stackedValue-I.value)}:function(I){return I.isY2?H(0):j(0)},se=[];_.forEach(C.series,function(I){se[I.index]=d3.line().x(ge).y(Ae).defined(function(ce){return es(ce)}).curve((0,Qn.By)(I.lineStyle))}),o.mainGraphicsContext.attr("aria-label","".concat(v.getLocalizedString("Visual_Plot")," ").concat(Bs(C)?v.getLocalizedString("Visual_Plot_ScreenReader_NavigateToAnomalies"):"").trim()),o.mainGraphicsSVG.attr("height",i.availableHeight).attr("width",i.availableWidth);var Se=o.mainGraphicsContext.selectAll($n.selector).data(ve,function(I){return I.identity.getKey()}).join(function(I){return I.append(wr).classed($n.class,!0)}).style("fill",function(I){return h.isHighContrast?J.v.getThemeColor(h,yt.U):I.lineStyle.areaColor}).style("pointer-events",t&&D?"auto":null).classed(U.cy,D).attr(U.Ez,"area").attr(U.QZ,3).each(function(I){U.O5.setDataForElement(this,{getDisplayName:function(){return v.getLocalizedString("MiniToolbar_Area",I.displayName)},getRegionOutlines:function(){for(var dt,Ee=o.mainGraphicsSVG.node().getBoundingClientRect(),qa=Ee.left,pt=Ee.top,Kt={type:1,x:Ee.x,y:Ee.y,height:Ee.height,width:Ee.width},Aa=p.scale,li=j.range(),Mt=_.min(li),ui=_.max(li),nt=[],Fi=function(i){for(var e=i.length,t=[],a=[],r=0;r<e;r++){var n=i[r];es(n)?(a.push(n),r===e-1&&t.push(a)):a.length>0&&(t.push(a),a=[])}return t}(I.data),ir=function(wa){var Be=wa.map(function(fa){return{x:Ar.convertSvgXToClientX(ge(fa),Aa,qa),y:Ar.convertSvgYToClientY(Ae(fa),Aa,pt)}}),Ea=[];Be.forEach(function(fa,Da){var Qa=_.clamp(Pe(wa[Da]),Mt,ui);Ea.unshift({x:fa.x,y:Ar.convertSvgYToClientY(Qa,Aa,pt)})});var rr=(0,g.__spreadArray)((0,g.__spreadArray)([],Be,!0),Ea,!0);nt.push({type:3,points:rr,clipPath:Kt})},Vi=0,Lr=Fi;Vi<Lr.length;Vi++)ir(Lr[Vi]);return[{id:"".concat("area","-").concat(I.index).concat(null!==(dt=i.data.multipleDisplayName)&&void 0!==dt?dt:""),outline:{type:0,outlines:nt}}]}})}).interrupt();if((e?Se.transition().ease(d3.easeLinear).duration(e):Se).attr("d",function(I){return d3.area().x(ge).y0(Pe).y1(Ae).defined(function(ce){return es(ce)}).curve((0,Qn.By)(I.lineStyle))(I.data)}),P){var Fe=(0,Jt.B9)(o.mainGraphicsContext),Ie=d3.area().x(ge).y0(function(I){return null!=I.uncertainty.lower?Ku(i,I):Ae(I)}).y1(function(I){return null!=I.uncertainty.upper?qu(i,I):Ae(I)}).defined(function(I){var ce,dt;return null!=(null===(ce=I?.uncertainty)||void 0===ce?void 0:ce.upper)||null!=(null===(dt=I?.uncertainty)||void 0===dt?void 0:dt.lower)}),xe=d3.line().x(ge).y(function(I){return Ku(i,I)}).defined(function(I){var ce;return null!=(null===(ce=I?.uncertainty)||void 0===ce?void 0:ce.lower)}),Ne=d3.line().x(ge).y(function(I){return qu(i,I)}).defined(function(I){var ce;return null!=(null===(ce=I?.uncertainty)||void 0===ce?void 0:ce.upper)});(0,Jt.EC)(Fe,T,Ne,xe,Ie,function(I,ce){return(0,Vt.eR)(I.selected,!1,Z,!1,(0,Ma.TD)(ce))}),(0,Jt.FZ)(Fe,T,function(I){return I.isY2?H:j},function(I){return"translate(".concat(ge(I),", ").concat(I.isY2?H(I.value):j(I.value),")")},10),(0,Jt.di)(Fe,T,Ne,xe,j.range()[1]>j.range()[0],d),(0,Jt.DI)(Fe)}else(0,Jt.OY)(o.mainGraphicsContext);var $e=o.mainGraphicsContext.selectAll(Jn.selector).data(_.filter(C.series,function(I){return I.lineStyle.strokeShow}),function(I){return I.identity.getKey()}).join(function(I){return I.append(wr).classed(Jn.class,!0)}).styles(function(I){return(0,ya.bc)(I.lineStyle,h)}).interrupt();(e?$e.transition().ease(d3.easeLinear).duration(e):$e).attr("d",function(I){return se[I.index](I.data)});var Ve,je=o.mainGraphicsContext.selectAll(Ws.selector).data(_.filter(C.series,function(I){return I.lineStyle.markerProperties.show}),function(I){return I.identity.getKey()}).join(function(I){return I.append(wr).classed(Ws.class,!0)}).style("stroke","#ffffff").style("stroke-width",2).style("stroke-opacity",0).attrs({"marker-start":function(ce){return d.getMarkerKey(ce.lineStyle.markerProperties)},"marker-mid":function(ce){return d.getMarkerKey(ce.lineStyle.markerProperties)},"marker-end":function(ce){return d.getMarkerKey(ce.lineStyle.markerProperties)}}).interrupt(),et=d3.line().x(ge).y(Ae).defined(function(I){return es(I)&&(!b.lineChartMarkerRendering||!I.marker.perCategoryStyle)});(e?je.transition().ease(d3.easeLinear).duration(e):je).attr("d",function(I){return et(I.data)}).style("opacity",function(I){return(0,Vt.eR)(I.selected,!1,Z,!1)}).style("pointer-events","none"),m||(Ve=o.mainGraphicsContext.selectAll(al.selector).data(_.filter(C.series,function(I){return rl(I)}),function(I){return I.identity.getKey()}).join(function(I){return I.append(wr).classed(al.class,!0).style("stroke-width",10).style("stroke-linejoin",No.t.round).attr(U.Ez,"lines").attr(U.Zx,"markers").attr(U.QZ,3).classed(U.cy,!fe||!D)}).attr("d",function(I){if(!A){var ce=rl(I);if(ce){var dt=_.findIndex(I.data,function(Ee){return Ee&&Ee.categoryIndex===ce.categoryIndex});if(dt>0&&dt<I.data.length){var jt=I.data.slice(dt);return se[I.index](jt)}}}return se[I.index](I.data)}).each(function(I){U.O5.setDataForElement(this,{getDisplayName:function(){return v.getLocalizedString("MiniToolbar_Line",I.displayName)},getRegionOutlines:function(){return Qo(I,i)}})}));var rt=o.mainGraphicsContext.selectAll(el.selector).data(C.series,function(I){return I.identity.getKey()}).join(function(I){return I.append("g").classed(el.class,!0)}),_e=rt.selectAll(ac.selector).data(function(I){return I.lineStyle.strokeShow?I.data.filter(function(ce,dt){return function(i,e){var t=i.data[e];if(null==t||null===t.value)return!1;var a=i.data[e-1],n=i.data[e+1];return!(null!=a&&null!==a.value||null!=n&&null!==n.value)}(I,dt)}):[]},function(I){return I.key}).join(function(I){return I.append(Gs).classed(ac.class,!0).classed(U.cy,!0).attr(U.Ez,"lines").attr(U.Zx,"markers").attr(U.QZ,3)}).style("fill",function(I){return I.marker.color}).style("fill-opacity",function(I){return I.marker.show?0:(0,Vt.eR)(I.selected,!1,Z,!1,(0,Ma.TD)(I.marker.transparency))}).each(function(){var ce=d3.select(this.parentNode).datum();U.O5.setDataForElement(this,{getDisplayName:function(){return v.getLocalizedString("MiniToolbar_Line",ce.displayName)},getRegionOutlines:function(){return Qo(ce,i)}})}),ze=_e.size(),kt=0;(e?_e.transition().duration(e):_e).attrs({cx:function(ce){return si(i,ce)},cy:function(ce){return $i(i,ce)},r:Es(C.lineStyle)}).on("end",function(){++kt===ze&&vt()}),e||vt();var Ze=rt.selectAll(ic.selector).data(function(I){return x?[]:_.filter(I.data,function(ce){return ce?.marker.perCategoryStyle&&null!=ce.value})},function(I){return I.key}).join(function(I){return I.append(wr).classed(ic.class,!0).style("pointer-events","none")}).attrs({transform:function(ce){var dt=b.lineChartMarkerRendering?ce.marker.size*za.Wo.sizeRatio:5;return"translate(".concat(si(i,ce),", ").concat($i(i,ce),") scale(").concat(2*dt,")")},d:function(ce){return(0,za.jM)(b.lineChartMarkerRendering?ce.marker.shape:Xt.ZO.circle,.5)}}).style("stroke-width",function(I){return b.lineChartMarkerRendering?2*(0,za.F)(I.marker.shape)/20:0});(e?Ze.transition().duration(e):Ze).style("fill",function(I){return I.marker.color}).style("stroke",function(I){return I.marker.color});var Nt,ct=function(i){return function(e){var a=i.renderContext.mainGraphicsContext,r=_.flatten(_.map(i.activeData.series,function(l){return _.filter(l.data,function(u){return u?.selected&&null!==u.value})})),n=_.map(r,function(l){return l.seriesIndex}),s=a.selectAll(il.selector).selectAll(wr).data(r,function(l){return l.key}).join(function(l){return l.append(wr).attr("pointer-events","none")}).attr("d",function(l){return l.marker.show?(0,za.jM)(l.marker.shape,l.marker.size*za.Wo.sizeRatio):(0,za.jM)(Xt.ZO.circle,l.marker.focusOnlySize)}).attr("transform",function(l){return"translate(".concat(si(i,l),",").concat($i(i,l),")")}).style("stroke-width",function(l){return(0,za.F)(l.marker.shape)}).style("stroke-opacity",1).style("stroke",function(l){return l.marker.focusOnlyColor}).style("fill",function(l){return l.marker.focusOnlyColor}),o=[];return a.selectAll(Jn.selector).each(function(l,u){o[u]=l.selected,l.selected=n.indexOf(l.index)>-1}).style("stroke-opacity",function(l,u){return(0,Vt.eR)(l.selected,!1,e&&!o[u],!1,(0,Ma.TD)(l.lineStyle.strokeTransparency))}),a.selectAll($n.selector).style("fill-opacity",function(l){return(0,Vt.eR)(l.selected,!1,e,!1,(0,Ma.TD)(l.lineStyle.areaTransparency))}),a.selectAll(Ws.selector).style("opacity",(0,Vt.eR)(!1,!1,e,!1)),(0,Jt.fM)(a.select(Jt.jx.selector),function(l,u){return(0,Vt.eR)(l.selected||n.indexOf(l.index)>-1,!1,e&&!o[l.index],!1,null!=u?(0,Ma.TD)(u):void 0)}),s}}(i);ct(Z),S&&(Nt=js(i,i.focusedDatum));var Qe=[],ea=[];if(!(null===(r=C.dataLabelsSettings)||void 0===r)&&r.show&&(Qe=Qe.concat(function(i){var e,t=(0,it.fI)(),a=i.activeData.series.map(function(r){var n,s,o=r.labelSettings||i.data.dataLabelsSettings;if(!o.show)return{labelDataPoints:[],maxNumberOfLabels:0};var l=100===o.labelDensity,u=(0,it.SS)(i.currentViewport.width,o.labelDensity,4,Os.v.estimatedLabelWidth),c=!l&&i.data.isScalar?u:r.data.length,d=r.isY2?i.y2AxisProperties:i.yAxisProperties,h=r.data.map(function(v,y){if(null!=v&&null!=v.value){var f=function(i,e,t,a,r,n,s,o){var l,u,c,d,m,x,h=i.isStackedArea,v=i.style,y=i.featureSwitches,f=r.fontProperties,p=e.isY2?null===(l=i.y2AxisProperties)||void 0===l?void 0:l.scale:i.yAxisProperties.scale,S=null!==(u=t.labelFill)&&void 0!==u?u:f.color,b=!1;r?.displayUnits===ye.In&&(r.precision=void 0);var C=(0,it.d6)(n,r);if(null!==(c=t.dynamicLabelValue)&&void 0!==c&&c.enabled)x=(0,ut.nU)(t.dynamicLabelValue,s,r,C,e,"Value"),!y.labelEnhancementsM0&&y.measureDrivenDataLabels&&""===x&&(x=void 0);else{var T=o&&!y.labelEnhancementsM0?ye.L0:(t.labelSettings.displayUnits===ye.In?t.labelSettings.valueCustomFormatString:void 0)??t.labelFormatString,P=s.getOrCreate(T,r,C.units,C.getPrecision(!!T,e.type)),D=t.value;o&&(D=t.originalValue),x=(0,it.Bw)(P.format(D))}var L=(0,We.qk)(f,x);if(h){var O=Math.max(t.stackedValue-t.value,p.domain()[0]),B=i.currentViewport.width,E=void 0;switch(r?.position){case Ge.h.insideCenter:E=[1];break;case Ge.h.insideEnd:E=[4];break;default:E=[1,4]}m={rect:{left:si(i,t)-B/2,top:p(Math.max(t.stackedValue,t.stackedValue-t.value)),width:B,height:Math.abs(p(t.stackedValue)-p(O))},orientation:t.value>=0?1:2,validPositions:E},b=!0}else{var j=e.lineStyle.markerProperties;switch(E=void 0,r?.position){case Ge.h.above:E=[1];break;case Ge.h.under:E=[2];break;default:E=100===r.labelDensity?[1]:function(i,e){var t=i.data,s=t[e].value,o=t[e-1]&&t[e-1].value,l=t[e+1]&&t[e+1].value,u=1,c=1;if(null==o?u=0:o>s?u=3:o<s&&(u=2),null===l?c=0:l>s?c=3:l<s&&(c=2),0===e)return 3===c?[2,1]:[1,2];if(e===t.length-1)return 3===u?[2,1]:[1,2];switch(u){case 0:switch(c){case 0:return[1,2,8,4];case 1:case 2:return[1,2,4,8];case 3:return[2,1,4,8]}case 1:switch(c){case 0:case 1:case 2:return[1,2,8,4];case 3:return[2,1,8,4]}case 3:switch(c){case 0:case 3:return[2,1,8,4];case 1:return[2,1,4,8];case 2:return[1,2,8,4]}case 2:switch(c){case 0:case 3:case 2:return[1,2,8,4];case 1:return[1,2,4,8]}}}(e,a)}m={point:{x:si(i,t),y:p(t.value)},radius:j.show?j.size:0,validPositions:E}}return{isPreferred:!1,text:x,textSize:{width:Le.b.measureSvgTextWidth(L)+ye.TS,height:Le.b.estimateSvgTextHeight(L,!0)},outsideFill:S??J.v.getThemeColor(v,ye.uQ),insideFill:S&&h?S:J.v.getThemeColor(v,ye.pl),parentType:b?1:0,parentShape:m,fontProperties:f,identity:t.identity,key:t.key,hasBackground:r.enableBackground,backgroundColor:r.backgroundColor,backgroundTransparency:r.backgroundTransparency,transparency:r.transparency,leaderLine:(0,g.__assign)((0,g.__assign)({},r.leaderLine),{strokeColor:null!==(d=t?.leaderLineColor)&&void 0!==d?d:r.leaderLine.strokeColor})}}(i,r,v,y,o,d,t,i.isStacked100);return v.labelDataPointContainerEnabled?(0,xu.U)({seriesName:r.displayName,labelDataPoint:f,enableValueDataLabel:o.enableValueDataLabel,valueShowBlankAs:o.showBlankAs,cartesianDataPoint:v,isStacked100:i.isStacked100,percentOfTotal:v.value,formattersCache:t,currentSeries:r,currentAxisProperties:d,valueDataLabelSettings:o,getOutsideLabelFill:function(S){var m;return null!==(m=S.labelFill)&&void 0!==m?m:J.v.getThemeColor(i.style,ye.uQ)},getInsideLabelFill:function(S){var m;return S.labelFill&&i.isStackedArea?null!==(m=S.labelFill)&&void 0!==m?m:S.labelSettings.fontProperties.color:J.v.getThemeColor(i.style,ye.pl)}}):f}}).filter(function(v){return v});return{labelDataPoints:h,maxNumberOfLabels:c,enableLeaderLines:o?.leaderLine.strokeShow,offset:{min:null!==(n=o?.minimumOffset)&&void 0!==n?n:ye.ki,max:null!==(s=o?.maximumOffset)&&void 0!==s?s:ye.wh}}});return new Os.v(a,i.activeData.series,i.currentViewport,i.yAxisProperties.scale,null===(e=i.y2AxisProperties)||void 0===e?void 0:e.scale).getSortedDataLabels()}(i))),null!==(n=C.seriesLabelSettings)&&void 0!==n&&n.show){var Va=C.seriesLabelSettings.position===Hi.M.right;ea=ea.concat(function(i,e,t){var a=i.isStackedArea,r=i.data.isScalar,n=Le.b.estimateSvgTextHeight(ye.bN),s=i.xAxisProperties.scale.domain()[0],o=i.xAxisProperties.scale.domain()[1];return i.activeData.series.map(function(l){var u,c=l.seriesLabelSettings||i.data.seriesLabelSettings;if(!c?.show)return{labelDataPoints:[],maxNumberOfLabels:0};var d=l.isY2?null===(u=i.y2AxisProperties)||void 0===u?void 0:u.scale:i.yAxisProperties.scale,h=d.domain()[0],v=d.domain()[1],y=c?c.fontProperties.size.px:0,f=!!c&&!!c.wordWrap,S=i.currentViewport.height-(y+n+(i.currentViewport.height-n-y)/2),m=[],b=function(B){var E;if(null!=B){var j=a?B.stackedValue:B.value;if(null!=j&&j>=h&&j<=v){var Z=(0,We.qk)(c.fontProperties,l.displayName);k.fF.assertValue(B.value,"seriesLabels - createLabelDataPoint called on a dataPoint with no value"),m.push({identity:B.identity,key:B.key,isPreferred:!1,text:l.displayName,textSize:{width:Le.b.measureSvgTextWidth(Z),height:Le.b.estimateSvgTextHeight(Z,!0)},outsideFill:null!==(E=c.seriesColor)&&void 0!==E?E:J.v.getThemeColor(i.style,ye.uQ),insideFill:c.seriesColor&&a?c.seriesColor:J.v.getThemeColor(i.style,ye.pl),parentType:0,parentShape:{point:{x:e,y:$i(i,B)},radius:l.lineStyle.markerProperties.show?l.lineStyle.markerProperties.size:0,validPositions:[512]},fontProperties:c.fontProperties,wordBreak:f&&(0,it.W1)(l.displayName,Z,i.availableSeriesLabelWidth,S,void 0,!0,!0).length>1,hasBackground:c.enableBackground,backgroundColor:c.backgroundColor,backgroundTransparency:c.backgroundTransparency})}}},x=l.data;if(!_.isEmpty(x)&&l.displayName){var C=t?_.last(_.compact(x)):_.first(_.compact(x));if(r){for(var A=0;A<x.length;A++){var T=x[A];if(null!=T&&null!=T.value&&T){var P=Zu(i,T);if(t?P>o:P>s){var L=-1;t&&0<=A-1?L=A-1:t||(L=A),L>=0&&b(x[L]);break}}}A===x.length&&b(C)}else b(C)}return{labelDataPoints:m,maxNumberOfLabels:1}})}(i,Va?i.availableWidth:0,Va))}if(null!==(s=C.totalLabelsSettings)&&void 0!==s&&s.show&&y&&!f&&(Qe=Qe.concat(function(i){var e=i.style,t=_n(i.data.valuesMetadata),a=(0,we.EO)(t,N.p.general.formatString),r=i.activeData,n=(0,it.fI)(),s=r.totalLabelsSettings,o=(0,it.d6)(i.yAxisProperties,s),l=s.fontProperties,u=r.totals.filter(function(c){return 0!==c?.net}).map(function(c){var d,h,v,y,f=c.net,p=n.getOrCreate(c.dynamicFormatString||a,s,o.units,s.precision),S=(0,it.Bw)(p.format(f)),m=(0,We.qk)(l,S),b=f>0?c.positive:c.negative,x={value:b,originalValue:void 0,stackedValue:b,categoryIndex:c.categoryIndex,categoryValue:c.categoryValue,labelSettings:void 0,key:void 0,identity:void 0,marker:void 0,seriesIndex:void 0,selected:!1},C=i.currentViewport.width;return{isPreferred:!1,text:S,textSize:{width:Le.b.measureSvgTextWidth(m),height:Le.b.estimateSvgTextHeight(m,!0)},outsideFill:null!==(h=null!==(d=c.labelFill)&&void 0!==d?d:l.color)&&void 0!==h?h:J.v.getThemeColor(e,ye.uQ),insideFill:null!==(y=null!==(v=c.labelFill)&&void 0!==v?v:l.color)&&void 0!==y?y:J.v.getThemeColor(e,ye.pl),parentType:1,parentShape:{rect:{left:si(i,x)-C/2,top:i.yAxisProperties.scale(b),width:C,height:0},orientation:f>=0?1:2,validPositions:[16]},identity:void 0,fontProperties:l,hasBackground:s.enableBackground,backgroundColor:s.backgroundColor,backgroundTransparency:s.backgroundTransparency,isTotal:!0}});return[{labelDataPoints:u,maxNumberOfLabels:r.totals.length}]}(i))),_.map(_.filter(T,function(I){return I.uncertainty.labels.show}),function(I){return I.uncertainty.labels})&&(Qe=Qe.concat(function(i){var e=i.style,t=i.hostService,a=_.filter(i.activeData.series,function(n){var s,o;return(null===(s=n.uncertainty)||void 0===s?void 0:s.renderUncertainty)&&(null===(o=n.uncertainty)||void 0===o?void 0:o.labels.show)});if(0===a.length)return[];var r=(0,it.fI)();return a.map(function(n){var o=n.uncertainty.labels,u=o.fontProperties,c=n.isY2?i.y2AxisProperties:i.yAxisProperties,d=(0,it.d6)(c,o),h=c.scale,v=[];return n.data.forEach(function(y){if(null!=y&&null!=y.value&&null!=y.uncertainty){for(var f=[],p=(0,yi.Ww)(y.value,y.uncertainty,o.errorFormat),S=[p.lower,p.upper],m=0;m<2;m++){var b=S[m],x=1===m,C=x?y.uncertainty.upper:y.uncertainty.lower;if(null!=C){var A=void 0;if(o.errorFormat===xr.K.relativePercentage)A=(0,yi.O2)(b,t);else{var T=y.labelFormatString,P=r.getOrCreate(T,o,d.units,d.getPrecision(!!T,n.type));A=(0,it.Bw)(P.format(b))}k.fF.assertValue(A,"label has no value -- lineChart.createUncertaintyLabels");var D=(0,We.qk)(u,A);f.push({isPreferred:!1,text:A,textSize:{width:Le.b.measureSvgTextWidth(D)+ye.TS,height:Le.b.estimateSvgTextHeight(D,!0)},outsideFill:u.color?u.color:J.v.getThemeColor(e,ye.uQ),insideFill:u.color?u.color:J.v.getThemeColor(e,ye.pl),parentType:0,parentShape:{point:{x:si(i,y),y:h(C)},radius:0,validPositions:[x?1:2]},identity:void 0,fontProperties:u,hasBackground:o.enableBackground,backgroundColor:o.backgroundColor,backgroundTransparency:o.backgroundTransparency})}}_.isEmpty(f)||v.push.apply(v,f)}}),{labelDataPoints:v,maxNumberOfLabels:100}})}(i))),!m){var la={availableHeight:i.availableHeight,availableWidth:i.availableWidth,isComboChart:x,activeData:i.activeData,interactivityLines:Ve,dots:_e,focusElement:Nt,explicitDots:Ze};u.removeTooltips(la,c),i.tooltipsEnabled&&!t&&u.applyTooltips(la,l,c)}(0,Fs.LL)(o.mainGraphicsContext,[$n,Jt.jx,Jn,Ws,al,el,il,Hs]);var Oe,sa,Bt,Ke=[];if(i.interactivityService&&!m){Oe=[];for(var Rt=0,ta=i.data.series;Rt<ta.length;Rt++){var E;Ke.push(E=ta[Rt]);var Ka=_.filter(E.data,function(ce){return ce});Oe.push.apply(Oe,Ka||[])}if(Bt=[],Bs(C)){var Zt=_.filter(C.anomalyDetections[0].anomalies,function(I){return I.isAnomaly});Bt.push.apply(Bt,Zt||[])}sa={interactivityLines:Ve,root:o.mainGraphicsContext,focusMarker:Nt,selectedMarkersCallback:ct,dots:_e,areas:Se,hoverLineTooltipOverlay:u.hoverLineTooltipOverlay,isHoverLineTooltipActive:u.isHoverLineTooltipActive,getCategoryIndex:function(ce,dt,jt){return l.getCategoryIndexFromSeriesAndPointX(ce,dt,jt=jt&&!u.isHoverLineTooltipActive)},categoryIdentities:C.categoryIdentities,hitTester:new Dv({dataPoints:Oe,isComboChart:x,isScalar:A,hasCategories:C.categoryIdentities.length>0}),onSelecting:v.onSelecting,anomalies:o.mainGraphicsSVG.selectAll(zs.ec.selector),anomalyNavigationHelper:i.anomalyNavigationHelper,onLineSubSelection:function(ce,dt,jt,Ee,qa){!function(i,e,t,a,r,n){var s,u,c,d,o=(0,an.bt)(),l=i.plotAreaHelper.getCategoryIndexFromSeriesAndPointX(e,t,!0);try{u=function(i,e,t){var a=i.renderContext.mainGraphicsSVG.node().getBoundingClientRect().left,r=_.find(e.data,function(n){return n&&n.categoryIndex===t});return Math.floor(Xu(i,r,a))}(i,e,l)}catch{return void k.fF.assertFail("Could not find data for categoryIndex in seriesData - getMarkerXPosition")}e.lineStyle.markerProperties.show&&Math.abs(u-o.x)<=e.lineStyle.markerProperties.size/2?(c="markers",d="MiniToolbar_Markers"):(c="lines",d="MiniToolbar_Line");var h=a.createVisualSubSelectionForSingleObject({objectName:c,subSelectionType:3,displayName:i.hostService.getLocalizedString(d,e.displayName),showUI:n,selectorsByColumn:null===(s=e.identity)||void 0===s?void 0:s.getSelectorsByColumn(),selectionOrigin:{x:r.clientX,y:r.clientY}});a.subSelect(h)}(i,ce,dt,jt,Ee,qa)},onDotSubSelection:function(ce,dt,jt,Ee){!function(i,e,t,a,r){var n,s,o;e.lineStyle.markerProperties.show?(s="markers",o="MiniToolbar_Markers"):(s="lines",o="MiniToolbar_Line");var l=t.createVisualSubSelectionForSingleObject({objectName:s,subSelectionType:3,displayName:i.hostService.getLocalizedString(o,e.displayName),showUI:r,selectorsByColumn:null===(n=e.identity)||void 0===n?void 0:n.getSelectorsByColumn(),selectionOrigin:{x:a.clientX,y:a.clientY}});t.subSelect(l)}(i,ce,dt,jt,Ee)},onAreaPointerMove:function(ce){!function(i,e){var t=new MouseEvent("pointerover",e),a=oc.findSubSelectedAreaElement(i,{x:e.clientX,y:e.clientY});a?.dispatchEvent(t)}(i,ce)}}}return{dataPoints:Oe?(0,g.__spreadArray)((0,g.__spreadArray)([],Ke,!0),Oe,!0):void 0,behaviorOptions:m?void 0:sa,labelDataPoints:m?[]:null,labelsAreNumeric:!m||null,labelDataPointGroups:Qe,labelDataPointSeriesGroups:ea,animateLabels:!1,anomalies:Bt,navigationOptions:i.navigationOptions}}function vt(){m&&function(i){if(0===i.length)return!1;for(var e=0,t=i.length;e<t;e++)if(i[e].data.length>0)return!0;return!1}(C.series)&&c.selectColumn(fs(C.series),!0)}}(o,s,r);return(0,gr.h8)(this.data.forecastLines,this.mainGraphicsSVG,this.xAxisProperties.scale,this.yAxisProperties.scale,s),(0,Et.bL)(this.dataInitOptions),l},Object.defineProperty(e.prototype,"navigationOptions",{get:function(){if(this.interactivityService)return{helper:this,navigationStrategy:this.data.isScalar?Y.jN.SeriesFirst:Y.jN.CategoryFirst}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewModel",{get:function(){var a;return{currentViewport:this.currentViewport,activeData:this.activeData,data:this.data,horizontalOffset:this.horizontalOffset,isComboChart:this.isComboChart,lineType:this.lineChartType,margin:this.margin,tooltipsEnabled:this.tooltipsEnabled,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,y2AxisProperties:this.y2AxisProperties,focusedDatum:this.focusedDatum,style:this.style,renderContext:{mainGraphicsSVG:this.mainGraphicsSVG,mainGraphicsContext:this.mainGraphicsContext,svgDefs:this.svgDefs,mainGraphicsPositionOverlay:(null===(a=this.lineChartTooltipHelper)||void 0===a?void 0:a.hoverLineTooltipOverlay)||this.mainGraphicsPositionRect},isStackedArea:this.isStacked,isStacked100:this.isStacked100,availableWidth:this.availableWidth-this.availableSeriesLabelWidth,availableHeight:this.availableHeight,availableSeriesLabelWidth:this.availableSeriesLabelWidth,hostService:this.hostService,markerRenderer:this.markerRenderer,interactivityService:this.interactivityService,navigationOptions:this.navigationOptions,lineChartTooltipHelper:this.lineChartTooltipHelper,tooltipInteractivity:this,plotAreaHelper:this,anomalyNavigationHelper:this.anomalyNavigationHelper,featureSwitches:this.featureSwitches,mobileTileInteractive:this.mobileTileInteractive}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSeriesLabelWidth",{get:function(){return(0,pi.lr)(this.activeData.seriesLabelSettings,this.availableWidth)},enumerable:!1,configurable:!0}),e.prototype.getFirstElement=function(t,a){var r;if(void 0===a&&(a=!1),null!=t){var s,n=a?_.findLast:_.find;return n(this.data.series,function(u){return s=n(u.data,function(c){return c&&c.categoryIndex===t&&null!=c.value})}),s&&-1===(null===(r=this.clippedData)||void 0===r?void 0:r.categories.indexOf(s.categoryValue))?{element:null,targetCategoryIndex:s.categoryIndex,targetSeriesIndex:s.seriesIndex}:s?(this.focusedDatum=s,{element:js(this.viewModel,s).node(),targetCategoryIndex:t,targetSeriesIndex:s.seriesIndex}):{element:null,targetCategoryIndex:t,targetSeriesIndex:a?this.data.series.length-1:0}}return{element:this.mainGraphicsContext.select(Hs.selector).node()}},e.prototype.getNextDataPoint=function(t,a,r){var n,s=this.focusedDatum;switch(r){case Y.x0.NextCategory:case Y.x0.PreviousCategory:var o=this.data.series[a];if(o){var l=o.data,u=_.findIndex(l,function(f){return f&&f.categoryIndex===t});s=this.pickNextAvailableIndex(l,u,a,r)}else s=void 0;break;case Y.x0.NextSeries:case Y.x0.PreviousSeries:var c=_.map(this.data.series,function(f){return _.find(f.data,function(p){return p&&p.categoryIndex===t})});s=this.pickNextAvailableIndex(c,a,t,r);break;default:k.fF.assertNever(r)}if(!s){var d=r===Y.x0.NextSeries||r===Y.x0.NextCategory?1:-1;t=e.incrementIndex(t,d,this.data.categories.length);var v=a;return(r===Y.x0.NextSeries||r===Y.x0.PreviousSeries)&&(v=d<0?this.data.series.length-1:0),{element:null,targetCategoryIndex:t,targetSeriesIndex:v}}return-1===(null===(n=this.clippedData)||void 0===n?void 0:n.categories.indexOf(s.categoryValue))?{element:null,targetCategoryIndex:s.categoryIndex,targetSeriesIndex:s.seriesIndex}:(this.focusedDatum=s,{element:js(this.viewModel,s).node(),targetCategoryIndex:s.categoryIndex,targetSeriesIndex:s.seriesIndex})},e.prototype.pickNextAvailableIndex=function(t,a,r,n){var s=n===Y.x0.NextCategory||n===Y.x0.PreviousCategory?this.rollToNextSeries:this.rollToNextCategory,o=n===Y.x0.NextSeries||n===Y.x0.NextCategory?1:-1,l=a;do{if((l+=o)>=t.length||l<0)return s.call(this,r,n);if(l===a)break}while(!t[l]||null==t[l].value);if(null!=t[l].value)return t[l]},e.prototype.rollToNextSeries=function(t,a){k.fF.assert(function(){return a===Y.x0.PreviousCategory||a===Y.x0.NextCategory},"expected a direction having to do with category");var n=a===Y.x0.PreviousCategory?_.findLast:_.find;return t=e.incrementIndex(t,a===Y.x0.PreviousCategory?-1:1,this.data.series.length),n(this.data.series[t].data,function(l){return l&&null!=l.value})},e.prototype.rollToNextCategory=function(t,a){k.fF.assert(function(){return a===Y.x0.PreviousSeries||a===Y.x0.NextSeries},"expected a direction having to do with series");var n=a===Y.x0.PreviousSeries?_.findLast:_.find;t=e.incrementIndex(t,a===Y.x0.PreviousSeries?-1:1,this.data.categories.length);var o=_.map(this.data.series,function(u){return _.find(u.data,function(c){return c&&c.categoryIndex===t})}),l=n(o,function(u){return u&&null!=u.value});return l||(l=n(o,function(u){return!!u})),l},e.incrementIndex=function(t,a,r){return(t+=a)>=r?t=0:t<0&&(t=r-1),t},e.prototype.getTooltipInfoForPoint=function(t,a){var r,n=t.data,s=this.getCategoryIndexFromSeriesAndPointX(n,a,!0,t.context);if(null!==(r=n?.data)&&void 0!==r&&r.length){var o=_.find(n.data,function(l){return l?.categoryIndex===s});if(o)return _.concat(o.tooltipInfo,o.additionalTooltipItems||[])}},e.isDataPointData=function(t){return t&&null!=t.categoryIndex},e.prototype.getCategoryIndexFromTooltipEvent=function(t,a){var r=t.data;if(!Yu(r))return e.isDataPointData(r)?r.categoryIndex:this.getCategoryIndexFromSeriesAndPointX(r,a,!1);k.fF.assertFail("should not receive pointer events for forecast lines")},e.prototype.getCategoryIndexFromSeriesAndPointX=function(t,a,r,n){var s=0,o=this.data.categoryData,l=this.xAxisProperties.scale;if(t&&!_.isEmpty(t.data)&&this.xAxisProperties){a=this.adjustPathXCoordinate(a,n);var c=rl(t,this.data.isScalar&&l.range()[1]<l.range()[0]);k.fF.assertValue(c,"If there is data on the tooltipEvent but no categoryIndex, there should always be two consecutive non-null values"),c&&(s=si(this.viewModel,c)),r&&(o=_.map(t.data,function(d){return wo(d,void 0)}))}return e.findCategoryIndex({pointX:a,offsetX:s,categoryData:o,currentViewport:this.currentViewport,scale:l,categoryThickness:this.xAxisProperties.categoryThickness,isScalar:this.data.isScalar})},e.prototype.getYValueFromTooltipEvent=function(t,a){var r,n,u,c,s=null===(r=this.yAxisProperties)||void 0===r?void 0:r.scale,o=null===(n=this.y2AxisProperties)||void 0===n?void 0:n.scale,l=this.currentViewport.scale;if((0,Lt.GG)(l,1,1e-5)||(t/=l),!a.classList.contains(ju.class)&&!a.classList.contains(e.lineChartSVGClassName)&&(t+=a.getBBox().y),s){var d=s.domain();u={point:s.invert(t),threshold:.1*(d[1]-d[0])}}return o&&(d=o.domain(),c={point:o.invert(t),threshold:.1*(d[1]-d[0])}),{y:u,y2:c}},e.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.isScalar},e.prototype.getSupportedCategoryAxisType=function(){var t,a,r=!1,n=null===(a=null===(t=this.dataView)||void 0===t?void 0:t.categorical)||void 0===a?void 0:a.categories;return _.isEmpty(n)||(r=n.some(function(s){var o,l=null===(o=s.source)||void 0===o?void 0:o.type;if(l){var u=(0,xt.A8)(s);return!(0,ne.c$)(l)||u&&!_.isEmpty(u.values)}})),r?ht.w.both:ht.w.categorical},e.sliceSeries=function(t,a,r){var n;return null!==(n=t?.map(function(s){var o=(0,be.ED)(s);return o.data=s.data.slice(a,r),o}))&&void 0!==n?n:[]},Object.defineProperty(e.prototype,"horizontalOffset",{get:function(){if(!this.data.isScalar){var a=this.xAxisProperties.scale;if((0,Fs._9)(a))return a.bandwidth()/2}return 0},enumerable:!1,configurable:!0}),e.prototype.getHoverLineDataForCategory=function(t){var a=this.createTooltipData(t);if(a)return Rv.call(this,t,a.dataPoints),a},e.prototype.getHoverLineIdentities=function(t,a){var r,n,s,o,l,u,c,d,h=null===(l=null===(o=this.data)||void 0===o?void 0:o.categoryIdentities)||void 0===l?void 0:l[t],v=null===(c=null===(u=this.data)||void 0===u?void 0:u.multiplesCategoryIdentities)||void 0===c?void 0:c[t],y=[],f=null===(d=_.find(a??[],function(p){return p?.categoryIndex===t}))||void 0===d?void 0:d.identity;return f&&(v.exclude=((r={})[1]=!0,r[0]=!1,r),h.exclude=((n={})[1]=!0,n[0]=!1,n),f.exclude=((s={})[1]=!1,s[0]=!0,s),y.push(f)),(v||h)&&y.push(v??h),y},e.prototype.clearHoverLine=function(){Iv.call(this)},e.prototype.selectColumn=function(t,a){if(void 0===a&&(a=!1),a||this.lastInteractiveSelectedColumnIndex!==t){this.lastInteractiveSelectedColumnIndex=t;var r=this.getChartX(t);this.setHoverLine(r,t);var n=this.createLegendDataPoints(t);n&&this.cartesianVisualHost.updateLegend(n)}},e.prototype.setHoverLine=function(t,a){Ev.call(this,t,a)},e.prototype.getChartX=function(t){var a=0;this.data.isScalar?t>=0&&t<this.data.categoryData.length&&(a=Math.max(0,this.xAxisProperties.scale(this.data.categoryData[t].categoryValue))):a=Math.max(0,this.xAxisProperties.scale(t));var r=Math.max.apply(Math,this.xAxisProperties.scale.range());return a=Math.min(a,r),this.horizontalOffset+(isNaN(a)?0:a)},e.findCategoryIndex=function(t){var a=t.offsetX,r=t.categoryData,n=t.scale,s=t.pointX,o=t.currentViewport.scale;(0,Lt.GG)(o,1,1e-5)||(s/=o),a&&(s+=a);var l=Xe(n,s,0,0,void 0).value;if(t.isScalar){var u=e.findClosestXAxisIndex(l,r,n);return u>=0?r[u].categoryIndex:-1}if(r[l]&&!r[l].hasData){for(var c=-1,d=l;d>0&&-1===c&&r[--d].hasData;)c=d;for(var h=-1,v=l,y=r.length-1;v<y&&-1===h&&r[++v].hasData;)h=v;var f=Math.abs(c-l),p=Math.abs(h-l);f<p?l=c:f>p?l=h:f===p&&(l=s>n(l)+t.categoryThickness/2?h:c)}return l},e.findClosestXAxisIndex=function(t,a,r){var n=r.domain(),s=[n[0],n[1]],o=-1;if(k.fF.assert(function(){return s[1]>=s[0]},"expected max extent to not be less than min"),s[0]>s[1])return o;var l=Number.MAX_VALUE;for(var u in a){var c=a[u].categoryValue;if(!(c<s[0]||c>s[1])){var d=Math.abs(t-c);d<l&&(l=d,o=parseInt(u,10))}}return o},e.prototype.findSubSelectedAreaElement=function(t){return oc.findSubSelectedAreaElement(this.viewModel,t)},e.prototype.createTooltipData=function(t){var a=this.data;if(a&&0!==a.series.length&&a.categories&&a.categoryData){var r=[];k.fF.assert(function(){return t<a.categoryData.length},"category index out of range (categoryData)"),k.fF.assert(function(){return t<a.categories.length},"category index out of range (categories)");for(var l,n=a.categoryData[t],s=!1,o=a.multipleDisplayName,u=0,c=a.series;u<c.length;u++){var d=c[u],h=this.data.isScalar?n?d.data.filter(function(b){return b.categoryValue===n.categoryValue})[0]:void 0:d.data[t],v=h?.originalValue;if(null!=v){var y=(0,we.WU)(v,h.labelFormatString||(0,we.EO)(d.yCol,Mi));r.push({category:(0,G.BJ)(n.hierarchyCategoryLevels),multipleDisplayName:o,measureDisplayName:d.displayName,measureActualDisplayName:d.measureDisplayName,formattedValue:this.isStacked100?"".concat(y," (").concat((0,we.WU)(h.value,this.hostService.getLocalizedString("Percentage")),")"):y,value:v,stackedValue:h.stackedValue,uncertainty:h.uncertainty,showHoverlineDots:!d.lineStyle.markerProperties.show,marker:(0,g.__assign)((0,g.__assign)({},(0,qn.lw)(d.lineStyle.markerProperties,a.legendMarkerRendering,Xt.ZO.longDash)),{color:(0,qn.XU)(d.lineStyle.markerProperties,d.lineStyle.strokeColor,a.legendMarkerRendering,a.matchLineColor)}),line:d.lineStyle,isY2:h.isY2,seriesDisplayName:a.hasDynamicSeries?a.seriesDisplayName:void 0,seriesName:a.hasDynamicSeries?d.displayName:void 0,additionalTooltipItems:a.hasDynamicSeries?h.additionalTooltipItems:void 0}),s||(s=!!h.uncertainty),!a.hasDynamicSeries&&!l&&(l=h.additionalTooltipItems)}}if(!_.isEmpty(a.forecastLines)&&n){d=_.head(a.series),k.fF.assertValue(d,"expected a line chart series when forecast is present");for(var f=0,p=a.forecastLines;f<p.length;f++){var S=p[f],m=_(S.points).filter(function(C){return C.point.x===n.categoryValue}).first();v=m?.point.y,null!=v&&r.push({category:(0,G.BJ)(n.hierarchyCategoryLevels),multipleDisplayName:o,measureDisplayName:S.displayName,measureActualDisplayName:this.originalData.valuesMetadata[0].displayName,formattedValue:(0,we.WU)(v,(0,we.EO)(d.yCol,Mi)),value:v,additionalTooltipItems:[{displayName:this.localizer("Visual_Confidence_Band_Upper"),value:(0,we.WU)(m.upperBound.y,(0,we.EO)(d.yCol,Mi))},{displayName:this.localizer("Visual_Confidence_Band_Lower"),value:(0,we.WU)(m.lowerBound.y,(0,we.EO)(d.yCol,Mi))}],showHoverlineDots:!0,marker:{show:!0,color:S.stroke.strokeColor,shape:Xt.ZO.circle},line:void 0})}}return{dataPoints:r,additionalTooltipItems:l,legendMarkerRendering:a.legendMarkerRendering,hasUncertainty:s}}},e.prototype.createLegendDataPoints=function(t){var r,n,s,o,a=this,l=this.data;if(l&&l.series&&!(l.series.length<1)){var u,c=l.categoryData[t];this.mobileTileInteractive&&c&&(this.data.isScalar?(u=c.categoryValue,(0,ne.v9)(this.xAxisProperties.valueType)&&(u=Ta.y3.fromTimeValue(u))):u=Yi(this.data,t,this.xAxisProperties.valueType,this.data.isScalar));var d=l.series.map(function(h,v){var f,y=h.data;if(a.mobileTileInteractive){var p=void 0;if(a.data.isScalar){if(c)for(var S=c.categoryValue,m=0,b=y;m<b.length;m++){var x=b[m];if(x.categoryValue===S){p=x;break}}}else p=y[t];f=p?.value}return{marker:{show:!0,shape:Xt.ZO.circle,color:h.lineStyle.strokeColor},label:(0,St.TO)(h.yCol,a.dataView.categorical.values,Mi),category:(0,we.WU)(u,(0,we.EO)(h.xCol,Mi)),measure:(0,we.WU)(f,(0,we.EO)(h.yCol,Mi)),identity:h.identity,selected:h.selected,index:v}});return(0,g.__assign)((0,g.__assign)({},(0,da.Fe)(this.style)),{title:(null===(o=null===(s=null===(n=null===(r=this.dataView)||void 0===r?void 0:r.categorical)||void 0===n?void 0:n.values)||void 0===s?void 0:s.source)||void 0===o?void 0:o.displayName)||"",dataPoints:d,grouped:l.hasDynamicSeries})}},e.prototype.adjustPathXCoordinate=function(t,a){ma.M.isFirefox()&&null!=a&&(this.pathXAdjustment=this.getPathXAdjustmentForFirefox(a)),ma.M.isInternetExplorerOrEdge()&&(this.pathXAdjustment=5);var r=this.currentViewport.scale;return t-this.pathXAdjustment*((0,Lt.GG)(r,1,1e-5)?1:r)},e.prototype.getPathXAdjustmentForFirefox=function(t){var a=t.getBoundingClientRect(),r=(0,Et.jL)(t);if(r.height>0&&r.width>0)return(a.width/this.currentViewport.scale-r.width)/2},Object.defineProperty(e.prototype,"hasSingleStaticSeries",{get:function(){return this.data&&!this.data.hasDynamicSeries&&this.hasSingleSeriesPerValueAxis()},enumerable:!1,configurable:!0}),e.prototype.getCartesianVisualCapabilities=function(){var t=this.data,a=!this.isStacked||this.hasSingleStaticSeries;return{supportsHierarchicalCategoryAxis:!0,axesCapabilities:{categoryAxis:{domainAggregateRole:Sa.R.Category,supportedDomainAggregates:t&&t.isScalar?t.scalarKeyCount?1:3:0},valueAxis:{domainAggregateRole:Sa.R.Y,supportedDomainAggregates:a?3:1},secondaryValueAxis:this.haveY2Data()||this.isComboChart?{domainAggregateRole:Sa.R.Y2,supportedDomainAggregates:a?3:1}:void 0}}},e.prototype.hasSingleSeriesPerValueAxis=function(){var t=this.data;if(!t||_.isEmpty(t.valuesMetadata))return!1;for(var a=!1,r=!1,n=0,s=t.valuesMetadata;n<s.length;n++){var l=s[n].roles;for(var u in l)if(l[u]){if(u===Sa.R.Y){if(a)return!1;a=!0}if(u===Sa.R.Y2){if(r)return!1;r=!0}}}return!0},e.prototype.getStaticSeriesRole=function(){return this.isComboChart?Sa.R.Y2:Sa.R.Y},e.prototype.haveY2Data=function(){var t;return _.some(null===(t=this.data)||void 0===t?void 0:t.series,function(a){return a?.isY2})},e.prototype.customizeLegendFormattingModelOptions=function(t){var a=this.originalData,r=a.legendMarkerRendering,n=r===hn._.markerCircleDefault;return(0,g.__assign)((0,g.__assign)({},t),{legendMarkerRendering:r,matchLineColor:r===hn._.markerOnly||n?a.matchLineColor:void 0})},e.prototype.getTelemetryInformation=function(){var t,r={};if(_.isEmpty(null===(t=this.data)||void 0===t?void 0:t.anomalyDetections)||(r.AnomalyDetections=!0),!_.isEmpty(r))return r},e.ClassName="lineChart",e.MainGraphicsContextClassName="mainGraphicsContext",e.lineChartSVGClassName="lineChartSVG",e.ScalarOuterPadding=10,e.DefaultZeroScalarDomain=[-1,1],e}(Vs),ef=function(i){function e(t){var a=i.call(this,t)||this;return a.maxDataValue=Number.MIN_VALUE,a.newDataInterval=0,a.duration=3e5,a}return(0,g.__extends)(e,i),e.prototype.initData=function(t){i.prototype.initData.call(this,t),this.data=this.defaultData},e.prototype.initRenderer=function(t){i.prototype.initRenderer.call(this,t),this.svg.classed("realTimeLineChart",!0).classed("cartesianChart",!0);var a=this.mainGraphicsSVG=this.svg.append("svg");a.classed("mainGraphicsSVG",!0),this.mainGraphicsContext=a.append("g").classed("mainGraphicsContext",!0)},Object.defineProperty(e.prototype,"defaultData",{get:function(){return{series:[],totals:[],legendData:(0,da.Fe)(this.style),isScalar:!1,dataLabelsSettings:Ko(this.style),hasDynamicSeries:!1,hasHighlights:!1,categories:[],categoryMetadata:void 0,valuesMetadata:[],categoryData:[],lineStyle:Zo(),layout:{seriesOrderReversed:!1}}},enumerable:!1,configurable:!0}),e.prototype.setData=function(t){var a;if(null!==(a=this.data)&&void 0!==a||(this.data=this.defaultData),!_.isEmpty(t)){var r=_.head(t);if(r.categorical){var s=ja(r.metadata).duration;s&&(this.duration=s);var o=r.categorical;this.removeOldData();var l=o.categories,u=Gi.Ge.fromDescriptor({text:!0});l&&l.length>0&&l[0].source&&l[0].source.type&&(u=l[0].source.type);var c=(0,xt._K)(r.metadata?r.metadata.objects:null,X.zK.categoryAxis.axisType,u),d=Qu.convert({dataView:r,style:this.style,isComboChart:!1,isScalar:c,tooltipsEnabled:!1,supportsTotalLabels:!1,featureSwitches:this.featureSwitches});this.mergeNewData(d),this.removeOldData(this.newDataInterval)}}},e.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||!_.isEmpty(this.data.series))},e.prototype.calculateAxesProperties=function(t){var r,a=this;this.updateCurrentViewport(t);var n=t.categoryAxisOptions,s=t.valueAxisOptions;if(this.newAxisData&&(this.axisData=this.newAxisData),this.data){var o=this.getAxesDomains(!1,{categoryAxis:!0,valueAxis:!0}),l=function(c){var d="x"===c,h="y"===c,v=d?n:s,y=d?a.data.categoryMetadata:a.containsEmptySeries()?void 0:a.data.series[0].yCol,f=Ra({pixelSpan:d?a.currentViewport.width:a.availableHeight,domainOptions:d?{domain:o.categoryAxis,type:0}:{domain:o.valueAxis,type:0},axisZoom:void 0,metaDataColumn:y,isScalar:!0,isCategoryAxis:d,isVertical:h,formatString:(0,we.EO)(y,N.p.general.formatString),outerPadding:d?10:0,useTickIntervalForDisplayUnits:!0,getValueFn:d?function(p,S){return Yi(a.data,p,S,!0)}:void 0,axis:Ps.AxisDataDefaults,margin:a.margin,preventNice:Ya(v.includeDomain),categoryThickness:null});return h&&f.d3Axis.tickSize(-t.viewport.width),f};this.xAxisProperties=l("x"),this.yAxisProperties=l("y"),this.newAxisData={x:this.xAxisProperties,y1:this.yAxisProperties}}return null!==(r=this.axisData)&&void 0!==r||(this.axisData=this.newAxisData),[this.xAxisProperties,this.yAxisProperties]},e.prototype.getAxesDomains=function(t,a){var r,n,s,o={};if(!this.data)return o;var l=this.truncateSeries();if(_.isEmpty(l))return o;if(a.categoryAxis){var u=bt(l,null!==(s=null===(n=null===(r=this.data)||void 0===r?void 0:r.categoryMetadata)||void 0===n?void 0:n.type)&&void 0!==s?s:Gi.Ge.fromDescriptor({text:!0}),!0,[Yt([this.getMinData()+this.newDataInterval,void 0],0,[!0,void 0])]);u&&(Ca(u.domain),o.categoryAxis=u.domain)}return a.valueAxis&&(o.valueAxis=po(l)),o},e.prototype.render=function(t){var a;if(!this.containsEmptySeries())return this.renderLines(),null===(a=this.animator)||void 0===a||a.refreshLastUpdate(),{dataPoints:[],behaviorOptions:{},labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:[],animateLabels:!1}},e.prototype.truncateSeries=function(){var t=this.getMinData(),a=this.data.series;return a?_.map(a,function(r){var n=(0,be.ED)(r);n.data=(0,be.ED)(n.data);var o=0;return _.findIndex(n.data,function(l){return l&&l.categoryValue>=t})>0&&o++,n.data=n.data.slice(o),n}):[]},e.prototype.removeOldData=function(t){if(void 0===t&&(t=0),!this.containsEmptySeries()){for(var a=this.getMinData(t),r=this.data,n=0,s=r.series;n<s.length;n++){var o=s[n],l=_.findIndex(o.data,function(c){return c&&c.categoryValue>a});l>0&&(o.data=o.data.slice(l))}var u=_.findIndex(r.categoryData,function(c){return c&&c.categoryValue>a});u>0&&(r.categoryData=this.data.categoryData.slice(u),r.categories=this.data.categories.slice(u))}},e.prototype.mergeNewData=function(t){if(k.fF.assertValue(t,"newData"),this.containsEmptySeries())return this.data=t,void(this.maxDataValue=this.getMaxData());this.data.series=e.mergeSeries(this.data.series,t.series,this.maxDataValue),e.mergeCategories(this.data,t,this.maxDataValue);var a=this.getMaxData();this.newDataInterval=this.maxDataValue&&a?a-this.maxDataValue:0,this.maxDataValue=a},e.prototype.getMaxData=function(){for(var t=0,a=0,r=this.data.series;a<r.length;a++){var n=r[a];n.data.length&&(t=Math.max(_.last(n.data).categoryValue,t))}return t},e.prototype.getMinData=function(t){return void 0===t&&(t=0),this.maxDataValue-this.duration-1.5*t},e.prototype.renderLines=function(){var t,a=this.axisData.x.scale,r=this.axisData.y1.scale,n=d3.line().x(function(s){return a(s.categoryValue)}).y(function(s){return r(s.value)});this.mainGraphicsSVG.attrs({x:0,height:this.availableHeight,width:this.availableWidth}),this.mainGraphicsContext.attr("transform",(0,Et.Iu)(0,0)),this.mainGraphicsContext.selectAll(".line").data(this.data.series,function(s){return s.identity.getKey()}).join(function(s){return s.append("path").classed("line",!0)}).style("stroke",function(s){return s.lineStyle.strokeColor}).attr("d",function(s){return n(s.data)}),null===(t=this.animator)||void 0===t||t.animate({mainGraphicsContext:this.mainGraphicsContext,interactivityService:null,xTranslation:a(a.domain()[0]+this.newDataInterval)-a(a.domain()[0])})},e.prototype.containsEmptySeries=function(){return!this.data||_.isEmpty(this.data.series)},e.mergeCategories=function(t,a,r){k.fF.assertValue(t,"existingChartData"),k.fF.assertValue(a,"newChartData");var s=_.findIndex(a.categories,function(o){return o&&o.categoryValue>r});s>-1?(t.categories=t.categories.concat(a.categories.slice(s)),t.categoryData=t.categoryData.concat(a.categoryData.slice(s))):(t.categories=a.categories,t.categoryData=a.categoryData)},e.mergeSeries=function(t,a,r){k.fF.assertValue(t,"existingSeries"),k.fF.assertValue(a,"newSeries");for(var n=[],s=0,o=a;s<o.length;s++){var l=o[s],u=_.find(t,function(v){return v.identity.equals(l.identity)});if(u){n.push(u);for(var c=0,d=l.data;c<d.length;c++){var h=d[c];h.categoryValue>r&&u.data.push(h)}}else n.push(l)}return n},e.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},e.prototype.getStaticSeriesRole=function(){return"Y"},e}(bu),nl=R(67165),ts=function(){return function(e,t){this.x=e||0,this.y=t||0}}(),as=R(86108),er=R(90700),Us=3500,lc=1e4;function uc(i,e,t,a){var r;return e.useMatrixDV?function(i,e,t){var a,r,n,s;if(i&&i.matrix&&(0!==_.size(i.matrix.valueSources)||0!==_.size(i.matrix.rows.levels))){for(var o=e.interactivityService,l=(0,lt.vc)(e.style,"smallLightLabel"),u=pc(null===(a=i?.metadata)||void 0===a?void 0:a.objects,l,e.style),c=function(i){var e,t,c,d,h,f,a=i.matrix,r=a.valueSources,n=!1,s=!1,o=[_.findIndex(r,function(D){return(0,Dt.nu)(D,"X")})],l=_.findIndex(r,function(D){return(0,Dt.nu)(D,"Y")}),u=_.findIndex(r,function(D){return(0,Dt.nu)(D,"Size")}),v="",y="";(o[0]>=0?v=(c=r[o[0]]).displayName:(f=yc(a.rows,ae.TL.x))&&(o=f.levelSourceIndices,v=(c=f.column).displayName,n=!0),l>=0)?y=(d=r[l]).displayName:(f=yc(a.rows,ae.TL.y))&&(l=f.levelSourceIndices[0],y=(d=f.column).displayName,s=!0);u>=0&&(h=r[u]);var S,p=_.find(a.rows.levels,function(D){return!_.isEmpty(D.sources)&&(0,Dt.nu)(D.sources[0],ae.TL.series)});p?S=a.rows.root:(p=_.find(a.columns.levels,function(D){return!_.isEmpty(D.sources)&&(0,Dt.nu)(D.sources[0],ae.TL.series)}))&&(S=a.columns.root);var m=null!==(t=null===(e=i?.metadata)||void 0===e?void 0:e.objects)&&void 0!==t?t:{},b=!1,x=!1;if(c){var C=c.type;b=_.size(o)<=1&&!(!C.integer&&!C.numeric),x=(0,le.NA)(m,N.p.categoryAxis.axisType)===ht.w.categorical||!b}if(n||s){var T=!!_.find(a.rows.levels,function(D){return(0,Dt.nu)(D.sources[0],ae.TL.category)});k.fF.assert(function(){return!T},"not expecting to find category level with x/y grouping")}var P=n?ae.TL.x:s?ae.TL.y:ae.TL.category;return{idx:{x:o,y:l,size:u},xCol:c,yCol:d,size:h,axesLabels:{x:v,y},xGroupMetadata:n?{isCategoricalAxis:x,isScalarType:b}:void 0,yGroupMetadata:s?{isCategoricalAxis:!1,isScalarType:!0}:void 0,seriesLevel:p,seriesNode:S,categoryLevel:_.find(a.rows.levels,function(D){return(0,Dt.nu)(D.sources[0],P)}),treatNullsAsZero:{x:(0,le.NA)(m,ae.il.categoryAxis.treatNullsAsZero,!1),y:(0,le.NA)(m,ae.il.valueAxis.treatNullsAsZero,!1)}}}(i),d=c.size,h=i.matrix.valueSources,v=[],y=0;y<h.length;y++)(0,Dt.nu)(h[y],"Tooltips")&&v.push(y);var f={colorHelper:J.v.create(e.style,ae.il.markers.color,(0,le.W7)(null===(r=i.metadata)||void 0===r?void 0:r.objects,ae.il.dataPoint.defaultColor),(0,le.W7)(null===(n=i.metadata)||void 0===n?void 0:n.objects,ae.il.markers.color)),metadata:c,hasDynamicSeries:(0,Dt.c5)(i,"Series"),tooltipsEnabled:e.tooltipsEnabled,sizeRange:d?.aggregates?{min:d.aggregates.minLocal||d.aggregates.min||0,max:d.aggregates.maxLocal||d.aggregates.max}:{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},dataLabelSettings:l,playFrameInfo:t,tooltipValuesIndices:v,gradientIndex:_.findIndex(h,function(x){return(0,Dt.nu)(x,"Gradient")}),staticObjProps:u,categoryMap:{},categoryMapNextIndex:0,categoryIdentities:[]},p=function(i,e){var t,a,r,n,s=[],o=i.matrix;if(!o.rows.root||0===_.size(o.rows.root.children))return{dataPointSeries:s};var d,l=e.metadata,u=l.seriesNode,c=-1!==l.idx.size?o.valueSources[l.idx.size]:void 0,h=mc(l);if(u){for(var v=function(b){var x=u.children[b];if(x.isSubtotal)return"continue";var C=Object.create(e.staticObjProps.marker);C.color=e.colorHelper.getColorForSeriesValue(x.objects,u.childIdentityFields,x.value,yt.fA),k.fF.assert(function(){return 1===_.size(l.seriesLevel.sources)},"Scatter should only have one series column");var A=l.seriesLevel.sources[0],T=x.levelValues.map(function(O){return{expr:A.expr,formattedValue:we.WU(O.value,A.format),value:O.value,identity:x.identity}});e.staticObjProps.showSeries&&(C.shape=(0,le.NA)(x.objects,ae.il.markers.shape,C.shape));var P={dataView:i,currentSeries:x,converterContext:e,seriesMarker:C,seriesIndex:b,valueColumnIds:h},D={identityKey:null!==(r=null===(a=x.identity)||void 0===a?void 0:a.key)&&void 0!==r?r:"",dataPoints:vc(P),marker:C,identity:(new Tt.dw).withColumnIdentity(x.identity,A.queryName,T).createSelectionId(),name:we.WU(x.value,(0,le.NA)(A.objects,ae.il.general.formatString))};if(s.push(D),!l.categoryLevel&&0===_.size(D.dataPoints)){var L=fc({seriesOptions:P,category:x,categoryMetadataColumns:[A],categoryIdentityFields:x.childIdentityFields,categoryFormatter:Ys(void 0,A)});L&&D.dataPoints.push(L)}},y=0;y<(null===(t=u.children)||void 0===t?void 0:t.length);y++)v(y);var f=i.matrix.rows.root.children,p=_.find(f,function(m){return m.isSubtotal});p&&(d=sl(l,p))}else{var S=Object.create(e.staticObjProps.marker);S.color=e.colorHelper.getColorForMeasure(null,null!==(n=c?.queryName)&&void 0!==n?n:"",yt.fA),s.push({identityKey:"",dataPoints:vc({dataView:i,converterContext:e,currentSeries:o.rows.root,seriesMarker:S,valueColumnIds:h}),marker:S}),l.categoryLevel?(f=i.matrix.rows.root.children,(p=_.find(f,function(x){return x.isSubtotal}))&&(d=sl(e.metadata,p))):!l.xGroupMetadata&&!l.yGroupMetadata&&(d=sl(l,i.matrix.rows.root.children[0]))}return{dataPointSeries:s,xSubtotal:d?.xSubtotal,ySubtotal:d?.ySubtotal}}(i,f),S=hc(p.dataPointSeries,c),m={dataView:i,colorHelper:f.colorHelper,style:e.style,formatStringProp:null,showByDefault:!0,markerShapePropIdentifier:ae.il.markers.shape,markerShowSeriesPropIdentifier:ae.il.bubbles.showSeries},b=f.hasDynamicSeries?null!==(s=f.metadata.xGroupMetadata)&&void 0!==s&&s.isCategoricalAxis?(0,da.Lk)(m):(0,da.PP)(m):(0,da.Fe)(e.style);return o&&(o.applySelectionStateToData(S),o.applySelectionStateToData(b.dataPoints)),(0,g.__assign)((0,g.__assign)((0,g.__assign)({xCol:c.xCol,yCol:c.yCol,axesLabels:c.axesLabels,size:c.size,hasCategory:!!(c.xGroupMetadata||c.yGroupMetadata||c.categoryLevel),dataPoints:S},p),{legendData:b,categoryIdentities:f.categoryIdentities,sizeRange:f.sizeRange,dataLabelsSettings:l,hasDynamicSeries:f.hasDynamicSeries,xGroupMetadata:c.xGroupMetadata,yGroupMetadata:c.yGroupMetadata,treatNullsAsZero:c.treatNullsAsZero}),u)}}(i,e,t):null!==(r=i.categorical)&&void 0!==r&&r.values?function(i,e,t,a){var r,n,s=(0,yr.G)(i,{colorOptions:{valueRole:"Size",visualStyle:e.style},formatStringProp:ae.il.general.formatString}),o=e.style,l=e.interactivityService,u=e.categoryAxisProperties,c=e.valueAxisProperties,d=i.categorical,h=(0,Ho.Rr)(d),v=[null],y=we.E3(null);(null===(r=d.categories)||void 0===r?void 0:r.length)>0&&(v=d.categories[0].values,y=we.Ue({format:we.EO(d.categories[0].source,ae.il.general.formatString),value:v[0],value2:v[v.length-1],columnType:s.data.getCategoryType("Category")}));var f=d.values,p=!!f.source,S=f.grouped(),m=function(i){var r,n,s,e=(0,Dt.a2)(i,"X"),t=(0,Dt.a2)(i,"Y"),a=(0,Dt.a2)(i,"Size"),o="",l="";if(i&&i.length){var u=i[0];e>=0&&(r=u.values[e].source,o=u.values[e].source.displayName),t>=0&&(n=u.values[t].source,l=u.values[t].source.displayName),a>=0&&(s=u.values[a].source)}return{idx:{x:[e],y:t,size:a},xCol:r,yCol:n,size:s,axesLabels:{x:o,y:l}}}(S),b=(0,lt.vc)(o,"smallLightLabel"),x=pc(null===(n=i?.metadata)||void 0===n?void 0:n.objects,b,o),C=function(i,e,t,a,r,n,s,o,l,u,c,d){var h,v,y,f,p,S,m=i.data.hasValues("X"),b=i.data.hasValues("Y"),x=a.categories;if(!m&&!b)return[];var C=[],A=t.idx,T=ae.il.general.formatString,P=e.source,D=e.grouped();k.fF.assert(function(){return _.size(A.x)<=1},"Categorical X axis is not supported with categorical data view and hence there should not be more than 1 column on X role");for(var L=_.isEmpty(x)?null:x[0],O=mc(t),B=function(Z,ve){var fe=D[Z],re=fe.values,ge=Xs(A.size,re),Ae=Object.create(u.marker);Ae.color=s?i.colors.createBySeries(Z,void 0,yt.fA):void 0,i.data.hasSeries()&&u.showSeries&&(Ae.shape=(0,le.NA)(i.objects.getSeriesDataObjects(Z),ae.il.markers.shape,Ae.shape));var Pe={identityKey:null!==(v=null===(h=fe?.identity)||void 0===h?void 0:h.key)&&void 0!==v?v:"",dataPoints:[],marker:Ae,identity:i.identities.createForSeries(Z,[ae.TL.size]),name:s?we.WU(i.data.getSeriesName(Z),i.objects.getSeriesFormatString()):void 0};C.push(Pe);for(var se=function(xe,Ne){var $e=m?(0,ne.eT)(i.data.getValue(ae.TL.x,xe,Z)):0,je=b?(0,ne.eT)(i.data.getValue(ae.TL.y,xe,Z)):0;if(null==$e||null==je)return"continue";var et=null!==(y=a.originalCategories)&&void 0!==y?y:[L],Ve=Tt.dw.builder().withCategory(et,xe,null===(f=L?.source)||void 0===f?void 0:f.queryName,!0).withSeries(e,fe,!0).withMeasures(O),rt=void 0;c?(rt=Ve.clone()).withColumnIdentity(c.identity,c.column.queryName,[{expr:c.column.expr,formattedValue:c.formattedValue,identity:c.identity,value:c.value}]):rt=Ve;var vt=rt.createSelectionId(),ze=new Xa.Rm(i.columns,T);if(d){var kt=(0,br.F)(T),Ze=(0,br.S)(T);ze.withColumnValueByIndex(L,xe,!0,kt),s&&ze.withColumnValue(P,fe.name,void 0,!0,kt);var ct=Xs(_.first(A.x),re),Nt=Xs(A.y,re);ze.withColumnValueByIndex(ct,xe,!1,Ze).withColumnValueByIndex(Nt,xe,!1,Ze).withColumnValueByIndex(ge,xe,!1,Ze).withColumnValueByIndex(l,xe,!1,Ze),c&&ze.withValue(c.column.displayName,c.label),ze.withAllValuesForRole("Tooltips",xe,Z,!1,Ze)}var Qe=Object.create(Pe.marker);Qe.size=(0,ne.eT)(i.data.getValue(ae.TL.size,xe,Z)),Qe.color=u.colorByCategory&&!s?i.colors.createByCategory(xe,yt.fA):i.colors.createBySeries(Z,xe,yt.fA),Pe.dataPoints.push({x:$e,y:je,xFormatString:m?i.data.getFormatString(ae.TL.x,xe,Z):void 0,yFormatString:b?i.data.getFormatString(ae.TL.y,xe,Z):void 0,marker:Qe,radius:ge?.values[xe],sourceGroupName:null===(p=ge?.source)||void 0===p?void 0:p.groupName,formattedCategory:new Ia.o(function(){return n.format(null!=x?r[xe]:fe.name)}),selected:!1,identity:vt,renderIdentity:null!==(S=Ve?.createSelectionId())&&void 0!==S?S:vt,tooltipInfo:function(){return ze.getTooltipItems()},labelFill:o.fontProperties.color,categoryIndex:xe,seriesIndex:Z})},Se=0,Fe=r.length;Se<Fe;Se++)se(Se)},E=0,j=D.length;E<j;E++)B(E);return C}(s,f,m,d,v,y,p,b,h,x,t,e.tooltipsEnabled),A=hc(C,m),T=p?(0,da.pq)({dataView:i,style:o,showByDefault:!0,simpleMarkerProp:ae.il.markers.shape}):(0,da.Fe)();return u&&null!==u.showAxisTitle&&!1===u.showAxisTitle&&(m.axesLabels.x=null),c&&null!==c.showAxisTitle&&!1===c.showAxisTitle&&(m.axesLabels.y=null),l&&(l.applySelectionStateToData(A),l.applySelectionStateToData(T.dataPoints)),(0,g.__assign)({xCol:m.xCol,yCol:m.yCol,axesLabels:m.axesLabels,size:m.size,hasCategory:s.data.hasCategories(),dataPoints:A,dataPointSeries:C,legendData:T,sizeRange:sf(S,m.idx.size),dataLabelsSettings:b,hasDynamicSeries:p,xSubtotal:a?.[ae.TL.x],ySubtotal:a?.[ae.TL.y]},x)}(i,e,t,a):void 0}var cc="foregroundDark";function dc(i){return{xCol:void 0,yCol:void 0,hasCategory:void 0,dataPoints:[],dataPointSeries:[],legendData:(0,da.Fe)(i),axesLabels:{x:"",y:""},sizeRange:{min:void 0,max:void 0},dataLabelsSettings:(0,lt.vc)(i,"smallLightLabel"),hasDynamicSeries:!1,plotAreaShadingSettings:{show:!1,upperShadingColor:{solid:{color:J.v.getDataColorByIndex(i,3)}},lowerShadingColor:{solid:{color:J.v.getDataColorByIndex(i,5)}},transparency:70},ratioLineSettings:{strokeShow:!1,strokeColor:i?J.v.getThemeColor(i,cc):void 0,strokeTransparency:0,strokeWidth:3,strokePattern:qt.Dv.dashed,strokeDashArray:qt.YU,strokeDashCap:qt.xm,strokeAutoScale:!1},marker:{show:!0,shape:Xt.ZO.circle,color:i.colorPalette.dataColors.getColorByIndex(0).value,transparency:0,rotation:0,stroke:{strokeShow:!1,strokeColor:i?J.v.getThemeColor(i,cc):void 0,strokeTransparency:0,strokeWidth:1,strokePattern:qt.Dv.solid},rangeType:er.Dl.deprecated,multiplier:as.Kf.min},dataVolume:Us,colorBorder:!1,colorByCategory:!1}}function hc(i,e){var t,a=_.reduce(i,function(r,n){return r.concat(n.dataPoints)},[]);return e.size&&!(null!==(t=e.xGroupMetadata)&&void 0!==t&&t.isCategoricalAxis)&&a.sort(rf),a}function rf(i,e){if(null!=i.radius&&null!=e.radius){var t=e.radius-i.radius;if(0!==t)return t}return e.identity.getKey().localeCompare(i.identity.getKey())}function sf(i,e){var t={};return i?.forEach(function(a){var n=function(i){var e={};return i&&(e.min=i.min??i.minLocal??d3.min(i.values),e.max=i.max??i.maxLocal??d3.max(i.values)),e}(Xs(e,a.values));(null==t.min||t.min>n.min)&&(t.min=n.min),(null==t.max||t.max<n.max)&&(t.max=n.max)}),t}function sl(i,e){k.fF.assert(function(){return!i.xGroupMetadata&&!i.yGroupMetadata},"Can not get subtotals when grouped on x/y");var t,a=i.idx.x,r=i.idx.y;k.fF.assert(function(){return _.size(a)<=1},"Categorical X is not supported without X groups and hence there should only be 1 X column");var s,n=_.first(a);return-1!==n&&(t=(0,ne.eT)(e.values[n].value)),-1!==r&&(s=(0,ne.eT)(e.values[r].value)),{xSubtotal:t,ySubtotal:s}}function vc(i){for(var e=[],t=function(i){var e,t,a,o,l,r=i.dataView,n=i.converterContext,s=i.currentSeries,u=null!==(t=null===(e=n.metadata.seriesLevel)||void 0===e?void 0:e.sources[0])&&void 0!==t?t:void 0,c=we.E3(null);if(null!==(a=n.metadata.xGroupMetadata)&&void 0!==a&&a.isCategoricalAxis){var d=r.matrix.rows;c=Ys((o=d.root.children)[0],(l=d.levels[0].sources)[0])}else s.children?(o=s.children,l=r.matrix.rows.levels.length>0?r.matrix.rows.levels[o[0].level].sources:void 0,u&&(c=Ys(o[0],l[0]))):u&&(0,Dt.nu)(u,"Category")&&(c=Ys((o=[s])[0],(l=[u])[0]));return{categories:o,categoryMetadataColumns:l,categoryFormatter:c}}(i),r=t.categoryFormatter,n=t.categoryMetadataColumns,s=0,o=t.categories??[];s<o.length;s++){var u=fc({seriesOptions:i,category:o[s],categoryMetadataColumns:n,categoryIdentityFields:i.currentSeries.childIdentityFields,categoryFormatter:r});u&&e.push(u)}return e}function Ys(i,e){return i?.levelValues?we.Ue({format:we.EO(e,ae.il.general.formatString),value:i.levelValues[0],value2:i.levelValues[_.size(i.values)-1],columnType:null}):we.E3(null)}function fc(i){var e,t,a,r,n,s;if(!i.category.isSubtotal){var T,o=i.seriesOptions,u=o.converterContext,c=o.seriesIndex,d=o.currentSeries,h=o.seriesMarker,v=u.metadata,y=o.dataView.matrix,f=v.idx.x,p=v.idx.y,S=v.idx.size,m=_.size(y.valueSources),b=v.xGroupMetadata,x=v.yGroupMetadata,C=_.first(f),A=0,P=ae.il.general.formatString;!b&&-1!==C&&(A=(0,ne.eT)(i.category.values[C].value),A=null!==(e=v.treatNullsAsZero)&&void 0!==e&&e.x&&null==A?0:A,T=(0,le.NA)(i.category.values[C].objects,P));var D=null==A?null:[A];b&&(k.fF.assert(function(){return-1!==C},"a found grouped-X should not have an unknown index"),D=_.map(f,function(Bt){var Ke,Rt;return null!==(Rt=null===(Ke=i.category.levelValues[Bt])||void 0===Ke?void 0:Ke.value)&&void 0!==Rt?Rt:void 0}));var B,L=0,O=null===(t=v.xGroupMetadata)||void 0===t?void 0:t.isCategoricalAxis;if(x||-1===p)x&&(k.fF.assert(function(){return-1!==p},"a found grouped-Y should not have an unknown index"),L=i.category.levelValues[p].value);else{var E=ol(O,c,m,p);L=(0,ne.eT)(i.category.values[E].value),L=null!==(a=v.treatNullsAsZero)&&void 0!==a&&a.y&&null==L?0:L,B=(0,le.NA)(i.category.values[E].objects,P)}if(null!=D&&null!=L){var H,j=Object.create(h);-1!==S&&(E=ol(O,c,m,S),j.size=(0,ne.eT)(i.category.values[E].value),H=(0,le.NA)(i.category.values[E].objects,P));var ve,Z=Tt.dw.builder();if(!_.isEmpty(i.categoryMetadataColumns)){for(var fe=_.last(i.categoryMetadataColumns),re=[],ge=0,Ae=i.category.levelValues;ge<Ae.length;ge++){var Pe=Ae[ge],se=i.categoryMetadataColumns[Pe.levelSourceIndex];re.push({expr:se.expr,formattedValue:we.WU(Pe.value,se.format),value:Pe.value,identity:i.category.identity})}Z.withColumnIdentity(i.category.identity,fe.queryName,re)}var Se=null!==(n=null===(r=u.metadata.seriesLevel)||void 0===r?void 0:r.sources[0])&&void 0!==n?n:void 0;Se&&(re=d.levelValues.map(function(Ke){return{expr:Se.expr,formattedValue:we.WU(Ke.value,Se.format),value:Ke.value,identity:d.identity}}),Z.withColumnIdentity(d.identity,Se.queryName,re));var Fe=i.seriesOptions.valueColumnIds;if(_.isEmpty(Fe)||Z.withMeasures(Fe),u.playFrameInfo){var Ie=u.playFrameInfo;ve=Z.clone(),Z.withColumnIdentity(Ie.identity,Ie.column.queryName,[re={expr:Ie.column.expr,formattedValue:Ie.formattedValue,identity:Ie.identity,value:Ie.value}])}var xe=Z.createSelectionId(),Ne=u.sizeRange;Ne.min>j.size&&(Ne.min=j.size),Ne.max<j.size&&(Ne.max=j.size),u.hasDynamicSeries||(u.staticObjProps.colorByCategory?j.color=u.colorHelper.getColorForSeriesValue(i.category.objects,i.categoryIdentityFields,i.category.value,yt.fA):i.category.objects&&(j.color=u.colorHelper.getColorForMeasure(i.category.objects,null!=u.metadata.size?u.metadata.size.queryName:"",yt.fA)));var je=(0,br.F)(P),et=function(){var Ke=i.category.levelValues;return _.isEmpty(Ke)?d.value:_.size(Ke)>1?(0,G.ML)(_.map(Ke,function(Rt,ta){return je(Rt.value,i.categoryMetadataColumns[ta])})):Ke[0].value},Ve=new Xa.E4;if(u.tooltipsEnabled){var rt=(0,br.S)(P),_e=i.category.levelValues,vt=_.size(i.categoryMetadataColumns)>1;!b&&!x&&(vt?Ve.withMultipleColumnAndValues(i.categoryMetadataColumns,_.map(_e,function(Ke){return Ke.value}),!0,je):_e&&Ve.withColumnValue(_.head(i.categoryMetadataColumns),_e[0].value,void 0,!0,je)),u.hasDynamicSeries&&Ve.withColumnValue(Se,d.value,void 0,!0,je),b&&u.metadata.xGroupMetadata.isCategoricalAxis?Ve.withMultipleColumnAndValues(i.categoryMetadataColumns,D,!0,je):Ve.withColumnValue(v.xCol,D[0],T,!1,rt),Ve.withColumnValue(v.yCol,L,B,!1,rt).withColumnValue(v.size,j.size,H,!1,rt);var ze=u.gradientIndex,kt=y.valueSources;if(ze>=0){var Ze=(0,le.NA)(i.category.values[ze].objects,P);Ve.withColumnValue(kt[ze],i.category.values[ze].value,Ze,!1,rt)}(Ie=u.playFrameInfo)&&Ve.withValue(Ie.column.displayName,Ie.label);for(var ct=0,Nt=u.tooltipValuesIndices;ct<Nt.length;ct++){var Qe=Nt[ct],ea=(Ze=(0,le.NA)(i.category.values[Qe].objects,P),ol(O,c,m,Qe));Ve.withColumnValue(kt[Qe],i.category.values[ea].value,Ze,!1,rt)}}var Va=_.size(D)>1?D.join(" "):D[0],Gt=O?Va:et(),va=u.categoryMap,la=String(Gt),Oe=va[la];if(void 0===Oe){va[la]=Oe=u.categoryMapNextIndex,u.categoryMapNextIndex=Oe+1;var sa=u.categoryIdentities;sa&&(sa[Oe]=function(){var Bt=Tt.dw.builder();if(!_.isEmpty(i.categoryMetadataColumns))for(var Ke=function(I){var ce=i.category.levelValues.map(function(dt){return{expr:I.expr,formattedValue:we.WU(dt.value,I.format),value:dt.value,identity:i.category.identity}});Bt.withColumnIdentity(i.category.identity,I.queryName,ce)},Rt=0,ta=i.categoryMetadataColumns;Rt<ta.length;Rt++)Ke(ta[Rt]);return Bt.withMeasures(Fe).createSelectionId()})}return{x:Va,y:L,marker:j,radius:j.size,xFormatString:T,yFormatString:B,formattedCategory:new Ia.o(function(){return i.categoryFormatter.format(et())}),selected:!1,identity:xe,renderIdentity:null!==(s=ve?.createSelectionId())&&void 0!==s?s:xe,tooltipInfo:function(){return Ve.getTooltipItems()},labelFill:u.dataLabelSettings.fontProperties.color,categoryIndex:Oe,seriesIndex:c||0}}}}function ol(i,e,t,a){return i&&null!=e?e*t+a:a}function pc(i,e,t){i??(i={});var a=J.v.create(t),r=dc(t),n=(0,le.W7)(i,{objectName:"dataPoint",propertyName:"defaultColor"});n&&(r.marker.color=n);var s=(0,qn.JO)(i,ae.il.markers,r.marker);s.rangeType=(0,le.NA)(i,ae.il.markers.rangeType,r.marker.rangeType),s.multiplier=(0,as.HN)((0,le.NA)(i,ae.il.bubbles.bubbleSize));var o={fillPointStyle:(0,le.NA)(i,ae.il.fillPoint.style,nl.f.fillOnly),colorBorder:(0,le.NA)(i,ae.il.colorBorder.show,r.colorBorder),colorByCategory:(0,le.NA)(i,ae.il.colorByCategory.show,r.colorByCategory),marker:s,plotAreaShadingSettings:{show:(0,le.NA)(i,ae.il.plotAreaShading.show,r.plotAreaShadingSettings.show),upperShadingColor:gc(a,i,ae.il.plotAreaShading.upperShadingColor,r.plotAreaShadingSettings.upperShadingColor),lowerShadingColor:gc(a,i,ae.il.plotAreaShading.lowerShadingColor,r.plotAreaShadingSettings.lowerShadingColor),transparency:(0,le.NA)(i,ae.il.plotAreaShading.transparency,r.plotAreaShadingSettings.transparency)},ratioLineSettings:(0,g.__assign)((0,g.__assign)({},(0,ya.QI)(i,ae.il.ratioLine,r.ratioLineSettings)),{strokeColor:a.getColorForPropertyWithDefaultColor(i,ae.il.ratioLine.strokeColor,r.ratioLineSettings.strokeColor)}),dataVolume:(0,le.NA)(i,ae.il.general.dataVolume,Us),showSeries:(0,le.NA)(i,ae.il.bubbles.showSeries,!0)},l=i.categoryLabels;return l&&e&&(0,lt.ww)(l,e,void 0,t),o}function gc(i,e,t,a){return{solid:{color:i.getColorForPropertyWithDefaultColor(e,t,a?.solid.color)}}}function yc(i,e){for(var t=0,a=i.levels.length;t<a;t++){var r=i.levels[t],n=_.chain(r.sources).map(function(s,o){return{levelSource:s,index:o}}).filter(function(s){return(0,Dt.nu)(s.levelSource,e)}).map(function(s){return s.index}).value();if(!_.isEmpty(n))return{levelIndex:t,levelSourceIndices:n,column:r.sources[_.first(n)]}}}function mc(i){var e=[];return!i.xGroupMetadata&&i.xCol&&e.push(i.xCol.queryName),!i.yGroupMetadata&&i.yCol&&e.push(i.yCol.queryName),i.size&&e.push(i.size.queryName),e}function Xs(i,e){return i>=0?e[i]:null}var ll=10;function vf(i){var e,t;return{type:2,card:[ff.call(this,i),this.isXAxisCategorical()?void 0:(0,lt.Zu)({cardName:"Visual_CategoryLabel",dataLabelSettings:null!==(t=null===(e=this.data)||void 0===e?void 0:e.dataLabelsSettings)&&void 0!==t?t:null,isShowCategory:void 0,localize:this.localizer,props:ae.CS.categoryLabels,revertToDefaultProps:ae.CS.categoryLabels,showBackground:!0,showValueColor:!0,style:this.style})].filter(function(a){return a})}}function ff(i){var t,a,r,n,e=this,s=this.originalData;if(s){var o=null!==(a=null===(t=s.dataPointSeries)||void 0===t?void 0:t.length)&&void 0!==a?a:0;if(0!==o){var l=(0,le.NA)(null===(n=null===(r=this.dataView)||void 0===r?void 0:r.metadata)||void 0===n?void 0:n.objects,ae.il.bubbles.showSeries,!0),u=new F.CQ(new F.lg("markers"),"Visual_Markers",Object.values(ae.il.markers).concat([ae.il.bubbles.bubbleSize,ae.il.bubbles.showSeries,ae.il.fillPoint.style,ae.il.dataPoint.showAllDataPoints,ae.il.dataPoint.defaultColor,ae.il.colorByCategory.show,ae.CS.categoryAxis.innerPadding,ae.il.colorBorder.show]),this.localizer);return u.addGroup("applySettingsTo",function(c){return c.withContainerDisabled(!l).withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(d){if(d.withDisplayName(o>1?"Series":"Visual_Categories").addContainerItem("all",e.localizer("All"),function(C){ul.call(e,{containerItemBuilder:C,marker:s.marker,selector:null,listType:"static"}),!l&&C.addSimpleSlice("showSeriesLink",function(){return new F.ob({descriptor:ae.il.bubbles.showSeries,value:function(){},ariaLabel:"Enable_This_Setting",type:"SeriesDialogLink",resetToDefaultDescriptors:[ae.il.markers.shape],warningIcon:!0}).build()},function(A){return A.withCustomDisplayName("Enable_This_Setting").withSuppressDisplayName(!0)})}),1===o){var h=s.dataPoints.slice(0,Vo);if(h.length<2)return;for(var v=function(A){var T=A.formattedCategory.getValue();d.addContainerItem(T,T,function(P){return ul.call(e,{containerItemBuilder:P,marker:A.marker,selector:(0,at.fd)(A.identity.getSelector()),listType:"perCategory"})})},y=0,f=h;y<f.length;y++)v(f[y])}if(o>1)for(var S=function(A){d.addContainerItem(A.name,A.name,function(T){return ul.call(e,{containerItemBuilder:T,marker:A.marker,selector:(0,at.fd)(A.identity.getSelector()),listType:"perSeries"})})},m=0,b=s.dataPointSeries;m<b.length;m++)S(b[m])})}),this.isXAxisCategorical()&&u.addGroup("spacing",function(c){return c.withDisplayName("Visual_Spacing").addSimpleSlice("innerPadding",Oo(i.categoryAxisData,e.localizer))}),u.build()}}}function pf(i){var a,r,t=_.first(i).visualObjects;if(t.length>0){(a=t[0])&&a.selectorsByColumn&&(r=(0,at.fd)((0,at.tV)(a.selectorsByColumn)));var n=this.originalData.fillPointStyle===nl.f.fillOnly,s=1===this.data.dataPointSeries.length;switch(a.objectName){case"markers":var o={data:[(0,Cr.Ue)(1)]};r=s?o:r;var l=(0,g.__assign)((0,g.__assign)({},ae.il.dataPoint.fill),{selector:r});return(0,Pt.w3)(this.hostService,n?void 0:l,n?l:void 0);case"category-labels":return(0,Pt.un)(this.hostService,{fontFamilyReference:ae.CS.categoryLabels.fontFamily,fontSizeReference:ae.CS.categoryLabels.fontSize,boldReference:ae.CS.categoryLabels.bold,italicReference:ae.CS.categoryLabels.italic,underlineReference:ae.CS.categoryLabels.underline,fontColorReference:ae.CS.categoryLabels.color,backgroundReference:ae.CS.categoryLabels.backgroundColor});default:return}}}function gf(i){if((0,F.n$)(i)&&"dataVolume"===i.name)return yf.call(this)}function yf(){if(this.originalData&&!this.playAxis&&!this.isXAxisCategorical())return{item:new F.vi({uidBuilder:new F.IN(new F.SS(new F.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"dataVolume"),control:new F.mu({descriptor:ae.il.general.dataVolume,value:this.originalData.dataVolume,options:{minValue:{type:0,value:Us},maxValue:{type:1,value:lc}}}).build(),localize:this.localizer}).withCustomDisplayName("Visual_DataVolumeModern").build(),revertToDefaultDescriptors:[ae.il.general.dataVolume]}}function mf(i){if(!(0,F.Qu)(i)){if("categoryAxis"===i.uid)return Sf.call(this,i);if("valueAxis"===i.uid)return bf.call(this,i)}}function Sf(i){var e=this,t=(0,g.__spreadArray)([],i.groups,!0);return t.forEach(function(a,r){(0,F.Qu)(a)||a.uid==="".concat("categoryAxis","-").concat("valuesScalar")&&(t[r]=Sc.call(e,a,!0))}),(0,g.__assign)((0,g.__assign)({},i),{revertToDefaultDescriptors:(0,g.__spreadArray)((0,g.__spreadArray)([],i.revertToDefaultDescriptors,!0),[ae.il.categoryAxis.treatNullsAsZero],!1),groups:t})}function bf(i){var e=this,t=(0,g.__spreadArray)([],i.groups,!0);return t.forEach(function(a,r){(0,F.Qu)(a)||a.uid==="".concat("valueAxis","-").concat("values")&&(t[r]=Sc.call(e,a,!1))}),(0,g.__assign)((0,g.__assign)({},i),{revertToDefaultDescriptors:(0,g.__spreadArray)((0,g.__spreadArray)([],i.revertToDefaultDescriptors,!0),[ae.il.valueAxis.treatNullsAsZero],!1),groups:t})}function Sc(i,e){var t=(0,g.__spreadArray)([],i.slices,!0),a=(0,F.Qs)(i),r=xf.call(this,a,e);return r&&t.push(r),(0,g.__assign)((0,g.__assign)({},i),{slices:t})}function xf(i,e){var t,a,r=this.originalData;if(r&&!(e?r.xGroupMetadata:r.yGroupMetadata))return new F.vi({control:{type:"ToggleSwitch",properties:{descriptor:(0,g.__assign)((0,g.__assign)({},e?ae.il.categoryAxis.treatNullsAsZero:ae.il.valueAxis.treatNullsAsZero),{selector:null}),value:!!(e?null!==(t=r.treatNullsAsZero)&&void 0!==t&&t.x:null!==(a=r.treatNullsAsZero)&&void 0!==a&&a.y)}},localize:this.localizer,uidBuilder:i.withSlice("showblankvalues")}).build()}function ul(i){var e=this,t=i.selector,a=i.marker,r=this.originalData,n=!!r.size,s={get:this.localizer,getOptional:this.localizer,format:this.localizer},o=_.map(er.Yu,function(l){return(0,g.__assign)((0,g.__assign)({},l),{displayName:l.displayName(s)})});i.containerItemBuilder.addGroup("shape",function(l){var u;return l.withDisplayName("Visual_Shape").addSimpleSlice("markerShape",new F.uY({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.markers.shape),{selector:t}),value:a.shape}).build(),function(c){return c.withDisabled("perCategory"===i.listType)}).addSimpleSlice("fillStyle",new F.uY({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.fillPoint.style),{selector:t}),value:r.fillPointStyle}).build(),function(c){return c.withDisabled(n||"static"!==i.listType).withHidden(e.featureSwitches.newMarkerProperties).withCustomDescriptionIf(function(){return n||!!t},"Visual_Scatter_Size_FormatOption_DisabledReason_FillPoint")}).addSimpleSlice("markerRangeType",new F.uY({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.markers.rangeType),{selector:t}),items:o,value:null!==(u=o.find(function(c){return c.value===r.marker.rangeType}))&&void 0!==u?u:{value:er.Dl.deprecated,displayName:e.localizer("Visual_MarkerRangeType_Deprecated")}}).build(),function(c){return c.withDisabled(!n||"static"!==i.listType)}).addSimpleSlice("markerSize",new F.JN({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.bubbles.bubbleSize),{selector:t}),value:(0,as.yn)(r.marker.multiplier),options:{minValue:{type:0,value:as.Ad.min},maxValue:{type:1,value:as.Ad.max}},localize:e.localizer}).build(),function(c){return c.withDisabled("static"!==i.listType)}).addSimpleSlice("markerRotation",F.JN.getRotationSliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.markers.rotation),{selector:t}),value:a.rotation,localize:e.localizer}).build(),function(c){return c.withHidden(!e.featureSwitches.newMarkerProperties||!(0,Xt.Cd)(a.shape))})}).addGroup("colors",function(l){return l.withDisplayName("Generic_Color").addSimpleSlice("colorByCategory",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.colorByCategory.show),{selector:null}),value:r.colorByCategory}).build(),function(u){return u.withCustomDisplayName("Visual_ColorByCategory").withHidden(r.hasDynamicSeries).withDisabled("static"!==i.listType,"Visual_DisabledReason_AllSeriesOnly_Singular")}).addSimpleSlice("markerColor",new F.BT({descriptor:(0,g.__assign)((0,g.__assign)((0,g.__assign)({},ae.il.markers.color),{selector:"static"===i.listType?{data:[(0,Cr.Ue)(1)]}:t,instanceKind:r.hasDynamicSeries||"perCategory"===i.listType?1:3}),"static"===i.listType&&{altConstantValueSelector:null}),value:{value:a.color}}).build(),function(u){return u.withCustomDisplayName("Generic_Color").withDisabled(r.hasDynamicSeries&&"static"===i.listType,"Visual_Color_AllSeries_DisabledReason")}).addSimpleSlice("markerTransparency",F.JN.getTransparencySliderBuilder({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.markers.transparency),{selector:t}),value:a.transparency,localize:e.localizer}).build(),function(u){return u.withDisabled(r.hasDynamicSeries&&"static"===i.listType,"Visual_Color_AllSeries_DisabledReason").withHidden(!e.featureSwitches.newMarkerProperties)})}).addGroup("border",function(l){l.withDisplayName("Visual_Border").withDisabled(!(0,Xt.nK)(a.shape)),e.featureSwitches.newMarkerProperties?l.withDisabled(!(0,Xt.nK)(a.shape)||"static"!==i.listType).addSlices((0,ya.Iq)({containerItemBuilder:l,descriptors:qe.$9,strokeData:a?.stroke,selector:t,featureSwitches:e.featureSwitches,localize:e.localizer}).map(function(u){return u.build()})):l.addSimpleSlice("colorBorder",new F.bd({descriptor:(0,g.__assign)((0,g.__assign)({},ae.il.colorBorder.show),{selector:null}),value:r.colorBorder}).build(),function(u){return u.withCustomDisplayName("Visual_ColorBorder").withCustomDescriptionIf(function(){return!n},"Visual_Scatter_Size_FormatOption_DisabledReason").withDisabled(!n||"static"!==i.listType).withHidden(e.featureSwitches.newMarkerProperties)})})}function Cf(i,e){var t,a,r=this.originalData;if(r)switch(e.objectName){case"plotAreaShading":this.isPlotSymmetryShadingSupported()?i.pushInstance({selector:null,objectName:"plotAreaShading",properties:{show:r.plotAreaShadingSettings.show,upperShadingColor:r.plotAreaShadingSettings.upperShadingColor,lowerShadingColor:r.plotAreaShadingSettings.lowerShadingColor,transparency:r.plotAreaShadingSettings.transparency}}):i.pushInstance({selector:null,objectName:"plotAreaShading",properties:{},disabledReason:this.localizer("Visual_Scatter_SymmetryShadingNotSupported")});break;case"ratioLine":null!==(t=r.xCol)&&void 0!==t&&t.isMeasure&&null!==(a=r.yCol)&&void 0!==a&&a.isMeasure&&i.pushInstance({selector:null,objectName:"ratioLine",properties:(0,ya.HM)(r.ratioLineSettings,qe.vi)});break;case"general":!this.playAxis&&!this.isXAxisCategorical()&&i.pushInstance({selector:null,objectName:"general",properties:{dataVolume:r.dataVolume},validValues:{dataVolume:{numberRange:{min:Us,max:lc}}}})}}function Af(i){for(var e=i.metadata,t=[],a=0,r=i.visualObjects;a<r.length;a++){var s=r[a].objectName,o=e?.visualObject;if(o&&"markers"===s){var u=d3.select(o).datum(),c=this.data.dataPointSeries[u.seriesIndex];if(c.dataPoints.length<=7)return wf.call(this,c);var h=this.getGroupBoundingRect(c.dataPoints,this.currentViewport.scale,this.renderer.mainGraphicsContext),v=o.getBoundingClientRect(),y=Math.max(v.height,ll),f=Math.max(v.width,ll);t.push(Df([h,{x:v.x,y:v.y,height:y,width:f}],c.identityKey,this.renderer.mainGraphicsContext,this.currentViewport,this.margin))}}return t}function wf(i){var e=[],t=this.renderer.mainGraphicsContext,a=this.currentViewport.scale,r=t.node().getBoundingClientRect(),n=r.left,s=r.top,o=t.node().getBBox(),l=o.x,u=o.y,c={type:1,x:n-l,y:s-u,height:this.availableHeight*a,width:this.availableWidth*a},d=i.dataPoints.map(function(v){var y=Math.max(2*v.geometry.size*a,ll);return{x:(v.geometry.x-l)*a-y/2+n,y:(v.geometry.y-u)*a-y/2+s,width:y,height:y,type:1,clipPath:c}});return e.push({id:i.identityKey,outline:{type:0,outlines:d}}),e}function Df(i,e,t,a,r){for(var n=t.node().getBoundingClientRect(),s=n.left,o=n.top,l=[],u=t.node().getBBox(),h=a.scale,v={type:1,x:s-u.x,y:o-u.y,height:(a.height-r.top-r.bottom)*h,width:(a.width-r.left-r.right)*h},y=0,f=i;y<f.length;y++){var p=f[y];l.push({x:p.x,y:p.y,width:p.width,height:p.height,type:1,clipPath:v})}return{id:e,outline:{type:0,outlines:l}}}function _f(i){var a,n,t=_.first(i).visualObjects;if(t.length>0)switch(a=t[0],_.isEmpty(a.selectorsByColumn)||(n=(0,at.fd)((0,at.tV)(a.selectorsByColumn))),a.objectName){case"markers":return[{type:0,excludedResetFormattingIds:[ae.CS.categoryLabels.show]},(0,g.__assign)((0,g.__assign)({type:2},ae.CS.categoryLabels.show),{enabledLabel:this.localizer("Visual_Add_CategoryLabel")}),(0,g.__assign)((0,g.__assign)({type:3},ae.il.markers.shape),{label:this.localizer("Visual_MarkerShape"),selector:n}),(0,g.__assign)((0,g.__assign)({type:3},ae.il.fillPoint.style),{label:this.localizer("Visual_MarkerStyle"),selector:void 0}),{type:1,destinationInfo:(0,g.__assign)((0,g.__assign)({},ae.il.markers.shape),{selector:n}),label:this.localizer("Format_Markers")}];case"category-labels":var s="".concat("Visual","-").concat("categoryLabels");return[(0,g.__assign)((0,g.__assign)({type:2},ae.CS.categoryLabels.show),{disabledLabel:this.localizer("Delete"),selector:void 0,keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:0,relatedResetFormattingIds:[ae.CS.categoryLabels.enableBackground],excludedResetFormattingIds:[ae.CS.categoryLabels.show]},{type:1,destinationInfo:{cardUid:s,groupUid:"".concat("categoryLabels","-").concat("values")},label:this.localizer("Format_Category_Labels")}];default:return}}function Pf(i){var e;switch(d3.select(i).attr(U.Ez)){case"markers":case"category-labels":var a=d3.select(i).datum(),r=this.data.dataPointSeries[a.seriesIndex],n=null===(e=r?.identity)||void 0===e?void 0:e.getSelectorsByColumn();if(n)return n}}function Tf(i,e){if(!this.featureSwitches.onObject||1!==e)return[];var r=[ki.$.create({objectName:"categoryLabels",propertyName:"backgroundColor"},this.data.dataLabelsSettings.enableBackground).onToggleEnabled(Ot.W.createBooleanDataViewObjectChange({objectName:"categoryLabels",propertyName:"enableBackground"},!0))];return ie.o.getDataViewObjectsBehaviorChanges(i,r)}var cl=R(92379),kf=function(){function i(e){this.dataPoints=e.dataPoints,this.margin=e.margin}return i.prototype.queryRegion=function(e){var t=this,a=(0,zo.g6)(e,!1);return this.adjustPositionRelativeToRoot(a),_.filter(this.dataPoints,function(n){if(void 0===n.marker.size)return t.isPointInRect(a,n.geometry);var s;switch(n.geometry.markerShape){case Xt.ZO.circle:s=cl.m.circleRectangleOverlap(a,{x:n.geometry.x,y:n.geometry.y},n.geometry.size);break;case Xt.ZO.square:s=t.isSquareMarkerIntersect(n.geometry,a);break;case Xt.ZO.diamond:s=t.isDiamondMarkerIntersect(n.geometry,a);break;case Xt.ZO.triangle:s=t.isTriangleMarkerIntersect(n.geometry,a);break;default:k.fF.assertFail("markers does not have this shape"),s=!1}return s})},i.prototype.isSquareMarkerIntersect=function(e,t){var a={left:e.x-e.size,right:e.x+e.size,top:e.y-e.size,bottom:e.y+e.size};return(0,dn.WN)(a.left,a.right,t.left,t.right)&&(0,dn.WN)(a.top,a.bottom,t.top,t.bottom)},i.prototype.isDiamondMarkerIntersect=function(e,t){if(!this.isSquareMarkerIntersect(e,t))return!1;if(this.isPointInRect(t,e))return!0;for(var r=[{x:e.x-e.size,y:e.y},{x:e.x,y:e.y-e.size},{x:e.x+e.size,y:e.y},{x:e.x,y:e.y+e.size}],s=[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom},{x:t.left,y:t.bottom}],o=[[s[0],s[1]],[s[1],s[2]],[s[3],s[2]],[s[0],s[3]]],l=0,u=[[r[0],r[1]],[r[1],r[2]],[r[0],r[3]],[r[3],r[2]]];l<u.length;l++)for(var c=u[l],d=0,h=o;d<h.length;d++){var v=h[d];if(cl.m.linesIntersect(c[0],c[1],v[0],v[1],!1))return!0}return this.isLassoInShape(e,t)},i.prototype.isPointInRect=function(e,t){return(0,Lt.bl)(e.left,t.x)&&(0,Lt.bl)(t.x,e.right)&&(0,Lt.bl)(e.top,t.y)&&(0,Lt.bl)(t.y,e.bottom)},i.prototype.isLassoInShape=function(e,t){var a={left:e.x-e.size,right:e.x+e.size,top:e.y-e.size,bottom:e.y+e.size};return(0,dn.WN)(t.left,t.right,a.left,a.right)&&(0,dn.WN)(t.top,t.bottom,a.top,a.bottom)},i.prototype.isTriangleMarkerIntersect=function(e,t){if(!this.isSquareMarkerIntersect(e,t))return!1;if(this.isPointInRect(t,e))return!0;for(var r=[{x:e.x-e.size,y:e.y+e.size},{x:e.x,y:e.y-e.size},{x:e.x+e.size,y:e.y+e.size}],s=[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom},{x:t.left,y:t.bottom}],o=[[s[0],s[1]],[s[1],s[2]],[s[3],s[2]],[s[0],s[3]]],l=0,u=[[r[0],r[1]],[r[1],r[2]],[r[0],r[2]]];l<u.length;l++)for(var c=u[l],d=0,h=o;d<h.length;d++){var v=h[d];if(cl.m.linesIntersect(c[0],c[1],v[0],v[1],!1))return!0}return this.isLassoInShape(e,t)},i.prototype.adjustPositionRelativeToRoot=function(e){e.left-=this.margin.left,e.top-=this.margin.top,e.right-=this.margin.left,e.bottom-=this.margin.top},i}(),tr=function(){function i(e,t){var a=this;this.hostChart=e,this.eventManager=t,this.mainGraphicsG=this.hostChart.svg.append("g").classed(i.MainGraphicsContext.class,!0).call(function(r){return e.mobileTileInteractive&&r.append("rect").classed("backgroundRect",!0).attrs({width:"100%",height:"100%"})}),this.mainGraphicsContext=this.mainGraphicsG.append("svg").attr("stroke-width","1").call(function(r){return a.hostChart.interactivityService&&r.attrs({tabindex:0,role:"listbox","aria-multiselectable":"true",focusable:"true","aria-label":a.hostChart.localizer("Visual_Plot")}).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge())})}return i.prototype.markerShapesHaveChanged=function(e){var t=_.map(e.data.dataPointSeries,function(s){return s.marker.shape}),a=this.previousMarkers;if(a)for(var r=0,n=Math.min(t.length,a.length);r<n;r++)if(t[r]!==a[r])return this.previousMarkers=t,!0;return this.previousMarkers=t,!1},i.calculateRadius=function(e,t,a,r,n){var s,o;void 0===n&&(n=1);var l=Math.min(a.height,a.width)/this.MarkerRefChartDim;if(null==e||null==t)return n*i.MarkerRadiusDefault;if(r===er.Dl.deprecated){var u=l*l,c={min:this.MarkerRefChartMinPixels*u,max:this.MarkerRefChartMaxPixels*u},d=(t={min:Math.min(t.min||0,0),max:Math.max(t.max||0,0)}).max-t.min,h=c.max-c.min,v=((e=Math.min(Math.max(e,t.min),t.max))-t.min)/(d||1);return k.fF.assert(function(){return v>=0&&v<=1},"valueRatio must be between 0 and 1"),n*Math.sqrt((c.min+v*h)/Math.PI)}r===er.Dl.auto&&(r=t.min>=0||t.max<=0?er.Dl.magnitude:er.Dl.dataRange),r===er.Dl.magnitude&&(e&&(e=Math.abs(e)),t={min:0,max:Math.max(null!==(s=Math.abs(t.max))&&void 0!==s?s:0,null!==(o=Math.abs(t.min))&&void 0!==o?o:0)});var S=((e=Math.min(Math.max(e,t.min),t.max))-t.min)/(t.max-t.min||1);return k.fF.assert(function(){return S>=0&&S<=1},"valueRatio must be between 0 and 1"),n*((i.MarkerRadiusMax-i.MarkerRadiusMin)*Math.sqrt(S)+i.MarkerRadiusMin)*l},i.prototype.render=function(e,t,a,r){var s,n=e.plotArea;if(this.mainGraphicsContext.attrs({width:n.width,height:n.height}).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()&&!!t),this.drawRatioLine(e),this.drawShadedBackground(e),e.suppressDataPointRendering)this.mainGraphicsContext.selectAll(i.MarkerSeriesGroupCS.selector).remove(),s=this.mainGraphicsContext.selectAll(i.MarkerCS.selector);else{var o=i.getXOfFirstCategory(e),l=!this.markerShapesHaveChanged(e)&&e.animation.duration>0,u=e.drawBubbles||l;s=this.mainGraphicsContext.selectAll(i.MarkerSeriesGroupCS.selector).data(u?[{identityKey:"",dataPoints:e.data.dataPoints,marker:{show:!0,color:void 0,shape:void 0}}]:e.data.dataPointSeries,function(c){return c.identityKey}).join(function(c){return c.append("g").classed(i.MarkerSeriesGroupCS.class,!0).attr("role","group")}).styles(function(c){return u?{}:{"stroke-opacity":i.getMarkerStrokeOpacity(!!e.data.size,e.data.colorBorder,e.hasSelection,!1),fill:c.marker.color,"fill-opacity":i.getMarkerFillOpacity(!!e.data.size,e.fillMarkers,e.hasSelection,!1)}}).selectAll(i.MarkerCS.selector).data(function(c){return c.dataPoints},function(c){return c.renderIdentity.getKey()}).join(function(c){var d;return c.append("path").classed(i.MarkerCS.class,!0).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()&&!!t).classed(U.cy,!0).attrs((d={},d[U.Ez]="markers",d[U.QZ]=3,d.transform=function(h){var v=e.xAxisProperties.scale(e.hasCategoricalAxis?h.categoryIndex:h.x)+o,y=e.yAxisProperties.scale(h.y);return"translate(".concat(v,",").concat(y,")")},d.tabindex=t?0:null,d.focusable=!!t||null,d.role="option",d)).style("opacity",0)},function(c){return l?c:c.interrupt()},function(c){return(l?c.transition().ease(e.animation.ease).duration(e.animation.duration).style("opacity",0).attr("r",0):c).remove()}).attrs(function(c){return i.updateMarkerGeometry(c,e,o),{d:(0,za.jM)(c.marker.shape,c.geometry.size),transform:"translate(".concat(c.geometry.x,",").concat(c.geometry.y,")"),"aria-selected":c.selected}}).styles({"stroke-opacity":function(d){return i.getMarkerStrokeOpacity(null!=d.marker.size,e.data.colorBorder,e.hasSelection,d.selected)},stroke:function(d){return i.getMarkerStrokeFill(d.marker,e.data.colorBorder)},fill:function(d,h,v){var y=d3.select(v[h].parentElement).datum();return u||y.marker.color!==d.marker.color?d.marker.color:null},"fill-opacity":function(d){return i.getMarkerFillOpacity(null!=d.marker.size,e.fillMarkers,e.hasSelection,d.selected)},opacity:l?void 0:null}).call(function(c){return(l?c.transition().ease(e.animation.ease).duration(e.animation.duration):c).style("opacity",1)}).each(function(c,d,h){var v,y;if(r){var f=a.getLocalizedString("MiniToolbar_Markers",null!==(y=null===(v=e.data.dataPointSeries[c.seriesIndex])||void 0===v?void 0:v.name)&&void 0!==y?y:a.getLocalizedString("All"));U.O5.setDataForElement(h[d],{getDisplayName:function(){return f}})}})}return this.hostChart.tooltipsEnabled&&this.hostChart.tooltipService.addTooltip(this.mainGraphicsContext,function(c){var d;return null===(d=c.data)||void 0===d?void 0:d.tooltipInfo()},function(c){var d;return(null===(d=c.data)||void 0===d?void 0:d.identity)&&[c.data.identity]}),(0,Et.bL)(e.animationOptions),k.fF.assert(function(){return null!=e.data.dataPointSeries},"dataPointSeries must be defined"),this.numSeries=e.data.dataPointSeries.length,this.scatterChartDataPoints=e.allData.dataPoints,{dataPointsSelection:s,eventGroup:this.mainGraphicsG,data:e.data,fillMarkers:e.fillMarkers,root:this.mainGraphicsContext,visualInstanceId:a.instanceId,eventManager:this.eventManager,onMarkerSubSelection:function(d,h,v,y,f){!function(i){var e,t,a=i.element,r=i.series,n=i.subSelectionHelper,s=i.d3Event,o=i.hostServices,l=i.showUI,u=null===(e=r.identity)||void 0===e?void 0:e.getSelectorsByColumn(),d=o.getLocalizedString("MiniToolbar_Markers",null!==(t=r.name)&&void 0!==t?t:o.getLocalizedString("All")),v=n.createVisualSubSelectionForSingleObject((0,g.__assign)({objectName:"markers",subSelectionType:3,displayName:d,showUI:l,selectorsByColumn:u,selectionOrigin:{x:s.clientX,y:s.clientY,offset:{x:15,y:15}}},a?{metadata:{visualObject:a}}:{}));n.subSelect(v)}({element:d,series:e.allData.dataPointSeries[h.seriesIndex],subSelectionHelper:v,d3Event:y,hostServices:a,showUI:f})},hitTester:new kf({dataPoints:e.data.dataPoints,margin:e.margin})}},i.prototype.getNextDataPoint=function(e,t,a){var r,n,c,d,s=this.mainGraphicsContext.selectAll(i.MarkerCS.selector),o=this.scatterChartDataPoints,l=e,u=t;switch(a){case Y.x0.PreviousCategory:case Y.x0.NextCategory:d=a===Y.x0.PreviousCategory?-1:1,c=_.sortBy(_.filter(o,function(y){return y.seriesIndex===t}),"categoryIndex");var h=d+_.findIndex(c,function(y){return y.categoryIndex===e});h>=c.length||h<0?(r=this.rollToNextSeries(o,t,a),l=r[0],u=r[1]):l=c[h].categoryIndex;break;case Y.x0.PreviousSeries:case Y.x0.NextSeries:d=a===Y.x0.PreviousSeries?-1:1,c=_.sortBy(_.filter(o,function(y){return y.categoryIndex===e}),"seriesIndex");var v=d+_.findIndex(c,function(y){return y.seriesIndex===t});v>=c.length||v<0?(n=this.rollToNextCategory(o,e,a),l=n[0],u=n[1]):u=c[v].seriesIndex}return{element:s.filter(function(y){return y.seriesIndex===u&&y.categoryIndex===l}).node(),targetCategoryIndex:l}},i.prototype.rollToNextSeries=function(e,t,a){k.fF.assert(function(){return a===Y.x0.PreviousCategory||a===Y.x0.NextCategory},"expected a direction having to do with category");for(var s,r=a===Y.x0.PreviousCategory?-1:1,n=a===Y.x0.PreviousCategory?_.last:_.first;_.isEmpty(s);)(t+=r)>=this.numSeries?t=0:t<0&&(t=this.numSeries-1),s=_.sortBy(_.filter(e,function(l){return l.seriesIndex===t}),function(l){return l.categoryIndex});return[n(s).categoryIndex,t]},i.prototype.rollToNextCategory=function(e,t,a){k.fF.assert(function(){return a===Y.x0.PreviousSeries||a===Y.x0.NextSeries},"expected a direction having to do with series");for(var o,r=d3.max(e,function(u){return u.categoryIndex})+1,n=a===Y.x0.PreviousSeries?-1:1,s=a===Y.x0.PreviousSeries?_.last:_.first;_.isEmpty(o);)(t+=n)>=r?t=0:t<0&&(t=r-1),o=_.sortBy(_.filter(e,function(u){return u.categoryIndex===t}),function(u){return u.seriesIndex});var l=s(o).seriesIndex;return[t,l]},i.prototype.getFirstElement=function(){return{element:this.mainGraphicsContext.selectAll(i.MarkerCS.selector).node()}},i.prototype.drawShadedBackground=function(e){var t=e.data.plotAreaShadingSettings,a=t.show&&e.supportsPlotAreaSymmetryShading,r=this.hostChart.svg.selectAll(i.PlotAreaShadingLayerCS.selector).data(a?[1]:[]).join(function(v){return v.insert("svg",":first-child").classed(i.PlotAreaShadingLayerCS.class,!0).style("pointer-events","none")}).attrs({height:e.plotArea.height,width:e.plotArea.width});if(a){var n=e.xAxisProperties.scale,s=e.yAxisProperties.scale,o=n.domain(),l=s.domain(),u=[Math.min(o[0],l[0]),Math.max(o[1],l[1])],c=[{x:n(u[0]),y:s(u[0])},{x:n(u[1]),y:s(u[1])}];this.drawArea(i.UpperShadingAreaCS,r,t.show?[[{x:c[0].x,y:c[0].y},{x:c[0].x,y:c[1].y}],[{x:c[1].x,y:c[1].y},{x:c[1].x,y:c[1].y}]]:[],t.upperShadingColor,t.transparency),this.drawArea(i.LowerShadingAreaCS,r,t.show?[[{x:c[0].x,y:c[0].y},{x:c[0].x,y:c[0].y}],[{x:c[1].x,y:c[0].y},{x:c[1].x,y:c[1].y}]]:[],t.lowerShadingColor,t.transparency)}},i.prototype.drawRatioLine=function(e){var t=e.data.ratioLineSettings,a=this.hostChart.svg.selectAll(i.RatioLineLayerCS.selector).data(t?.strokeShow?[1]:[]).join(function(v){return v.append("svg").classed(i.RatioLineLayerCS.class,!0)}).attrs({height:e.plotArea.height,width:e.plotArea.width});if(t?.strokeShow){var r=e.xAxisProperties.scale,n=e.yAxisProperties.scale,s=r.domain(),o=n.domain(),l=e.data.xSubtotal,u=e.data.ySubtotal,c=[];if(_.isFinite(l)&&_.isFinite(u))if(0!==l&&0!==u){var d=u/l;c=[{x:r(s[0]),y:n(s[0]*d)},{x:r(s[1]),y:n(s[1]*d)}]}else 0!==u?c=[{x:r(0),y:n(o[0])},{x:r(0),y:n(o[1])}]:0!==l&&(c=[{x:r(s[0]),y:n(0)},{x:r(s[1]),y:n(0)}]);var h=d3.line().x(function(v){return v.x}).y(function(v){return v.y});a.selectAll(i.RatioLineCS.selector).data([c]).join(function(v){return v.append("path").classed(i.RatioLineCS.class,!0)}).attr("d",function(v){return h(v)}).style("fill","none").styles((0,ya.bc)(t))}},i.getXOfFirstCategory=function(e){if(e.hasCategoricalAxis){var t=e.xAxisProperties.scale;if((0,Fs._9)(t))return t.bandwidth()/2}return 0},i.getMarkerFillOpacity=function(e,t,a,r){return e||t?a&&!r?.4:.85:0},i.getMarkerStrokeOpacity=function(e,t,a,r){return e&&t?1:a&&!r?.4:.85},i.getMarkerStrokeFill=function(e,t){if(null!=e.size&&t){var a=(0,Ma.WV)(e.color);return a?(0,Ma.Bx)((0,Ma._j)(a,63.75)):e.color}return e.color},i.updateMarkerGeometry=function(e,t,a){e.geometry={size:i.calculateRadius(e.radius,t.data.sizeRange,t.plotArea,t.data.marker.rangeType,t.data.marker.multiplier),markerShape:t.data.marker.shape,x:t.xAxisProperties.scale(t.hasCategoricalAxis?e.categoryIndex:e.x)+a,y:t.yAxisProperties.scale(e.y)}},i.prototype.drawArea=function(e,t,a,r,n){var s=d3.area().x0(function(o){return o[0].x}).y0(function(o){return o[0].y}).x1(function(o){return o[1].x}).y1(function(o){return o[1].y});t.selectAll(e.selector).data([a]).join(function(o){return o.append("path").classed(e.class,!0)}).attr("d",function(o){return s(o)}).styles({fill:r.solid.color,"fill-opacity":(0,Ma.TD)(n)})},i.MarkerCS=(0,Me.CH)("scatterMarker"),i.MainGraphicsContext=(0,Me.CH)("mainGraphicsContext"),i.MarkerSeriesGroupCS=(0,Me.CH)("scatterMarkerSeriesGroup"),i.PlotAreaShadingLayerCS=(0,Me.CH)("plotAreaShadingLayer"),i.UpperShadingAreaCS=(0,Me.CH)("upperShadingArea"),i.LowerShadingAreaCS=(0,Me.CH)("lowerShadingArea"),i.RatioLineLayerCS=(0,Me.CH)("ratioLineLayer"),i.RatioLineCS=(0,Me.CH)("ratioLine"),i.MarkerRefChartDim=300,i.MarkerRefChartMinPixels=4,i.MarkerRefChartMaxPixels=3e3,i.MarkerRadiusDefault=6,i.MarkerRadiusMax=30,i.MarkerRadiusMin=2,i}(),Ff=function(){function i(e,t){this.viewModel=e,this.hostChart=t}return i.prototype.remove=function(){this.hostChart.svg.selectAll(i.TraceLineCS.selector).remove(),this.hostChart.svg.selectAll(i.TraceBubbleCS.selector).remove()},i.prototype.render=function(e,t){var a=this.viewModel,r=a.viewModel,n=[];if(_.isEmpty(e)||r.suppressDataPointRendering)this.remove();else{for(var s=a.data.currentFrameIndex,o=[],l=0,u=e.length;l<u;l++){n[l]=[],o[l]=!1;for(var c=0,d=a.data.allChartData.length;c<d&&c<=s;c++){var h=_.find(a.data.allChartData[c].dataPoints,function(L){var B=e[l];return B.renderIdentity?L.renderIdentity.getKey()===B.renderIdentity.getKey():L.identity.getKey()===e[l].identity.getKey()});null!=h&&(h.frameIndex=c,n[l].push(h),c===s&&(o[l]=!0))}}var v=r.xAxisProperties.scale,y=r.yAxisProperties.scale,f=d3.line().x(function(L){return v(L.x)}).y(function(L){return y(L.y)}).defined(function(L){return null!==L.x&&null!==L.y}),p=[],S=[],m=!1,b=this.hostChart.svg.selectAll(i.TraceLineCS.selector).data(e,function(L){return L.renderIdentity.getKey()}).join(function(L){return L.append("path").classed(i.TraceLineCS.class,!0)}).each(function(L,O,B){var E=B[O],j=E.hasAttribute("d")?E.getTotalLength():0;p.push(j);var H=$("<svg><path></path></svg>"),Z=$("path",H);Z.attr("d",f(n[O]));var ve=n[O].length>0?Z.get()[0].getTotalLength():0;S.push(ve),m||(m=ve<j)});m?t?b.transition().ease(ni.ease).duration(ni.duration).attr("stroke-dashoffset",function(L,O){return p[O]-S[O]}).transition().ease(ni.ease).duration(1).delay(0).style("stroke",function(L){return tr.getMarkerStrokeFill(L.marker,!0)}).attrs({d:function(O,B){return f(n[B])},"stroke-dasharray":function(O,B){return"".concat(S[B]," ").concat(S[B])},"stroke-dashoffset":0}):b.style("stroke",function(L){return tr.getMarkerStrokeFill(L.marker,!0)}).attrs({d:function(O,B){return f(n[B])},"stroke-dasharray":function(O,B){return"".concat(S[B]," ").concat(S[B])},"stroke-dashoffset":0}):b.style("stroke",function(L){return tr.getMarkerStrokeFill(L.marker,!0)}).attrs({d:function(O,B){return f(n[B])},"stroke-dasharray":function(O,B){return"".concat(S[B]," ").concat(S[B])},"stroke-dashoffset":function(O,B){return S[B]-p[B]}}).call(function(L){return t?L.transition().ease(ni.ease).duration(ni.duration):L}).attr("stroke-dashoffset",0);for(var x=[],C=0;C<n.length;C++){var A=n[C],T=o[C]?A.slice(0,A.length-1):A;x=x.concat(T)}var P=tr.getXOfFirstCategory(r),D=this.hostChart.svg.selectAll(i.TraceBubbleCS.selector).data(x.sort(function(L,O){return O.marker.size-L.marker.size}),function(L){return L.renderIdentity.getKey()+L.x+L.y+L.marker.size}).join(function(L){return L.append("path").classed(i.TraceBubbleCS.class,!0).style("opacity",0)},function(L){return L},function(L){return L.transition().ease(ni.ease).duration(ni.duration).style("opacity",0).remove()}).attrs(function(L){return tr.updateMarkerGeometry(L,r,P),{d:(0,za.jM)(L.marker.shape,L.geometry.size),transform:"translate(".concat(L.geometry.x,",").concat(L.geometry.y,")")}}).styles({"stroke-opacity":function(O){return O.selected?.85:.4},stroke:function(O){return tr.getMarkerStrokeFill(O.marker,a.data.chartData.colorBorder)},fill:function(O){return O.marker.color},"fill-opacity":function(O){return null!=O.marker.size?.2+O.frameIndex/s*.6:0}}).call(function(L){return L.transition().ease(ni.ease).duration(ni.duration).style("opacity",1)});this.hostChart.tooltipsEnabled&&this.hostChart.tooltipService.addTooltip(D,function(L){var O;return null===(O=L.data)||void 0===O?void 0:O.tooltipInfo()},function(L){var O;return(null===(O=L.data)||void 0===O?void 0:O.identity)&&[L.data.identity]})}},i.TraceLineCS=(0,Me.CH)("traceLine"),i.TraceBubbleCS=(0,Me.CH)("traceBubble"),i}(),Vf=function(i){function e(t){return i.call(this,t)||this}return(0,g.__extends)(e,i),e.prototype.initRenderer=function(t){i.prototype.initRenderer.call(this,t),this.svg.classed("".concat(e.ClassName," ").concat("playChart"),!0),this.renderer=new tr(this,t.eventManager)},e.prototype.renderAtFrame=function(t){this.data=this.originalData=t,this.updateViewModelAdapterAndData(),this.cartesianVisualHost.triggerRender(!1)},e.prototype.setData=function(t){var r,n,s,a=this;if(this.data=dc(this.style),!(null===(r=this.playAxis)||void 0===r)&&r.isCurrentlyPlaying()&&this.playAxis.stop(),t.length>0){var o=t[0]||t[1];if(o){this.categoryAxisProperties=ja(o.metadata,!0),this.valueAxisProperties=wn(o.metadata,!0),this.dataView=o;var l={viewport:this.currentViewport,colors:this.style.colorPalette.dataColors,interactivityService:this.interactivityService,categoryAxisProperties:this.categoryAxisProperties,valueAxisProperties:this.valueAxisProperties,style:this.style,tooltipsEnabled:this.tooltipsEnabled,useMatrixDV:!0};if(Su(o)){this.playAxis||(this.playAxis=new qd(this.interactivityService),this.dataView&&Su(this.dataView)&&(k.fF.assertValue(this.playAxis,"playaxis"),this.playAxis.initData(this.dataInitOptions)));var u=this.playAxis.setData(o,function(d,h,v){return uc(d,(0,g.__assign)((0,g.__assign)({},l),{useMatrixDV:!1}),h,v)});this.mergeSizeRanges(u),this.data=u.chartData,this.playAxis.setRenderFunction(function(d){return a.renderAtFrame(d)})}else{null===(n=this.playAxis)||void 0===n||n.remove(),this.playAxis=null;var c=uc(o,l);c&&(this.data=c)}}}else null===(s=this.playAxis)||void 0===s||s.remove(),this.playAxis=null;this.originalData=this.data},e.prototype.mergeSizeRanges=function(t){var a,r;if(t?.chartData){for(var n=t.chartData.sizeRange,s=0,o=t.allChartData;s<o.length;s++){var u=o[s].sizeRange;null!=u.min&&(n.min=Math.min(null!==(a=n.min)&&void 0!==a?a:Number.POSITIVE_INFINITY,u.min)),null!=u.max&&(n.max=Math.max(null!==(r=n.max)&&void 0!==r?r:Number.NEGATIVE_INFINITY,u.max))}for(var c=0,d=t.allChartData;c<d.length;c++)d[c].sizeRange=n}},e.prototype.hasLegend=function(){var t;return null===(t=this.data)||void 0===t?void 0:t.hasDynamicSeries},e.prototype.enumerateObjectInstances=function(t,a){return Cf.call(this,t,a)},e.prototype.resolveFormattingPlaceholder=function(t){return gf.call(this,t)},e.prototype.customizeFormattingCard=function(t){return mf.call(this,t)},e.prototype.getFormattingCards=function(t){return vf.call(this,t)},e.prototype.supportsTrendLine=function(){var t=this.data;return!(!t||this.isXAxisCategorical()||this.playAxis)&&!t.size&&(t.hasCategory||t.hasDynamicSeries)&&!!t.xCol&&!!t.yCol},e.prototype.supportsStaticReferenceLines=function(){return this.data&&!this.isXAxisCategorical()},e.prototype.getAxisLocationForRole=function(t){return"X"===t?0:1},e.getExtents=function(t){var a,r={},n=t.dataPoints;if(_.isEmpty(n))return{minY:0,maxY:0,formatStringY:void 0,minX:0,maxX:0,formatStringX:void 0};var s=!!t.xGroupMetadata,o=s&&t.xGroupMetadata.isCategoricalAxis;return o||(r.minX=d3.min(n,function(l){return l.x}),r.maxX=d3.max(n,function(l){return l.x}),r.formatStringX=_.first(n).xFormatString),s&&!o&&(n=_.filter(n,function(l){return null!=l.x})),r.minY=d3.min(n,function(l){return l.y}),r.maxY=d3.max(n,function(l){return l.y}),r.formatStringY=null===(a=_.first(n))||void 0===a?void 0:a.yFormatString,r},e.prototype.calculateAxesProperties=function(t){var a=this;this.updateCurrentViewport(t);var r={minY:0,maxY:10,formatStringY:void 0,formatStringX:void 0,minX:0,maxX:10};this.playAxis?(r=this.playAxis.getCartesianExtents(r,e.getExtents),this.playAxisControlLayout=t.playAxisControlLayout):_.isEmpty(this.data.dataPoints)||(r=e.getExtents(this.data));var n=this.getAxesDomains(!1,{categoryAxis:!this.isXAxisCategorical(),valueAxis:!0}),s=function(l){var u,c,d,h,v="x"===l,y="y"===l,f=v?t.categoryAxisOptions:t.valueAxisOptions,p=v&&a.isXAxisCategorical(),S=p?{domain:_.uniq(_.map(a.data.dataPoints,function(C){return C.categoryIndex})),type:0}:ga(f.includeDomain,Yt(v?n.categoryAxis:n.valueAxis,0)),m=v?a.data.xCol:a.data.yCol,b=p?Ua({availableWidth:a.availableWidth,categoryCount:_.size(_.uniqBy(a.data.dataPoints,function(C){return C.categoryIndex})),preferredCategoryWidth:Li(ja(a.dataView.metadata)),domain:S.domain,isScalar:!a.isXAxisCategorical(),cartesianOptions:a.options,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio}):void 0,x=Ra({pixelSpan:v?a.availableWidth:a.availableHeight,domainOptions:S,metaDataColumn:m,axisZoom:t.axisZoom,zeroScalarDomain:e.DefaultZeroScalarDomain,isScalar:y||!p,isCategoryAxis:v,isVertical:y,formatString:(v?r.formatStringX:r.formatStringY)||(0,we.EO)(m,ae.il.general.formatString),outerPadding:null!==(u=b?.outerPaddingRatio)&&void 0!==u?u:0,categoryThickness:null!==(c=b?.categoryThickness)&&void 0!==c?c:void 0,innerPaddingRatio:null!==(d=b?.innerPaddingRatio)&&void 0!==d?d:void 0,outerPaddingRatio:null!==(h=b?.outerPaddingRatio)&&void 0!==h?h:void 0,forcedTickCount:t.forcedTickCount,useTickIntervalForDisplayUnits:!0,axis:f.axis,margin:a.margin,preventNice:p?void 0:Ya(S),getValueFn:p?function(C,A){var T=_.find(a.data.dataPoints,function(P){return P.categoryIndex===C});return T?.formattedCategory.getValue()}:void 0});return x.axisLabel=a.data.axesLabels[l],v&&(x.d3Axis.tickSizeInner(-a.availableHeight).tickSizeOuter(0),p&&(x.categoryIdentities=a.data.categoryIdentities)),x};return this.xAxisProperties=s("x"),this.yAxisProperties=s("y"),[this.xAxisProperties,this.yAxisProperties]},e.prototype.getAxesDomains=function(t,a){var r={},n=this.data;if(!n)return r;var s={minY:0,maxY:10,formatStringY:void 0,formatStringX:void 0,minX:0,maxX:10};return this.playAxis?s=this.playAxis.getCartesianExtents(s,e.getExtents):_.isEmpty(n.dataPoints)||(s=e.getExtents(n)),a.categoryAxis&&!this.isXAxisCategorical()&&(r.categoryAxis=[s.minX,s.maxX]),a.valueAxis&&(r.valueAxis=[s.minY,s.maxY]),r},e.prototype.setFilteredData=function(t,a){if(this.isXAxisCategorical()){var r=this.data=(0,be.ED)(this.originalData);r.dataPoints=_.filter(r.dataPoints,function(n){return n.categoryIndex>=t&&n.categoryIndex<a}),r.dataPointSeries=_.map(r.dataPointSeries,function(n){var s=(0,be.ED)(n);return s.dataPoints=_.filter(n.dataPoints,function(o){return o.categoryIndex>=t&&o.categoryIndex<a}),s})}},e.prototype.shouldSuppressAnimation=function(){var t,a;return(null===(a=null===(t=this.data)||void 0===t?void 0:t.dataPoints)||void 0===a?void 0:a.length)>e.NoAnimationThreshold},e.prototype.render=function(t,a,r){var n,s,o,l,u,c,d;if(this.data){this.playAxis&&!this.playAxis.isRendererInitialized()&&this.playAxis.initRenderer({svg:this.svg});var S,h=this.data,v=(0,tn.Mb)(this.animator,t),y=!!this.data.size,f={data:this.data,allData:this.originalData,currentViewport:this.currentViewport,drawBubbles:y,isPlay:!!this.playAxis,hasCategoricalAxis:this.isXAxisCategorical(),xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,plotArea:{width:this.availableWidth,height:this.availableHeight},margin:this.margin,hasSelection:null===(n=this.interactivityService)||void 0===n?void 0:n.hasSelection(),animation:null!==(s=this.playAxis)&&void 0!==s&&s.isCurrentlyPlaying()&&(this.mobileTileInteractive||v>0)?ni:{duration:v,ease:d3.easeCubicInOut},animationOptions:this.animationOptions,fillMarkers:!y&&h.fillPointStyle===nl.f.fillOnly,suppressDataPointRendering:1===a&&(null===(o=h.dataPoints)||void 0===o?void 0:o.length)>e.NoRenderResizeThreshold,supportsPlotAreaSymmetryShading:this.isPlotSymmetryShadingSupported()},p=this.renderer.render(f,this.interactivityService,this.hostService,r);if(this.mobileTileInteractive&&(p={data:p.data,dataPointsSelection:p.dataPointsSelection,eventGroup:p.eventGroup,root:p.root,host:this.cartesianVisualHost,mobileRoot:this.svg,visualDataInitOptions:this.dataInitOptions,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,background:d3.select(this.element.get(0)),visualInstanceId:p.visualInstanceId,eventManager:p.eventManager}),this.playAxis&&(k.fF.assertValue(this.playAxisControlLayout,"playAxisControlLayout"),this.playAxis.setPlayControlPosition(this.playAxisControlLayout),S=this.playAxis.render(f,this.currentViewport,this.margin),this.interactivityService&&(p.playOptions={traceLineRenderer:new Ff(S.viewModel,this)},null!==(l=this.interactivityService)&&void 0!==l&&l.hasSelection()))){var m=_.uniqBy(_.filter(S.allDataPoints,function(b){return b.selected}),function(b){return b.identity.getKey()});p.playOptions.traceLineRenderer.render(m,!t)}return{dataPoints:null!==(u=S?.allDataPoints)&&void 0!==u?u:h.dataPoints,behaviorOptions:p,navigationOptions:this.interactivityService?{helper:this.renderer,navigationStrategy:this.isXAxisCategorical()?Y.jN.CategoryFirst:this.data.hasDynamicSeries?Y.jN.SeriesFirst:Y.jN.CategoryOnly}:void 0,labelDataPoints:null!==(c=h.dataLabelsSettings)&&void 0!==c&&c.show||null!==(d=h.dataLabelsSettings)&&void 0!==d&&d.showCategory?Of(f,this.style):void 0,labelsAreNumeric:!1,animateLabels:!0}}},e.prototype.getCategoryValueType=function(){return Ut(this.data.xCol)},e.prototype.getSupportedCategoryAxisType=function(){var t;return null!==(t=this.data)&&void 0!==t&&t.xGroupMetadata?this.data.xGroupMetadata.isScalarType?ht.w.both:ht.w.categorical:ht.w.scalar},e.prototype.getVisualCategoryAxisIsScalar=function(){return!this.isXAxisCategorical()},e.prototype.getSubSelectionMetadata=function(t){return{visualObject:t}},e.prototype.getSubSelectionShortcuts=function(t){return _f.call(this,t)},e.prototype.getSubSelectionStyles=function(t){return pf.call(this,t)},e.prototype.getSubSelectionCustomOutlines=function(t){return Af.call(this,t)},e.prototype.getSelectorsByColumnFromSubselectedElement=function(t){return Pf.call(this,t)},e.prototype.getDataViewObjectLayerChanges=function(t,a){return Tf.call(this,t,a)},e.prototype.getGroupBoundingRect=function(t,a,r){var n,s,o,l=(n=r.node().getBoundingClientRect()).left,u=n.top,c=(s=r.node().getBBox()).x,d=s.y,h=(o=t.reduce(function(D,L){var O=L.geometry,B=O.size,E=O.x,j=O.y;return D.xMin=Math.min(E-B,D.xMin),D.yMin=Math.min(j-B,D.yMin),D.xMax=Math.max(E+B,D.xMax),D.yMax=Math.max(j+B,D.yMax),D},{xMin:Number.MAX_SAFE_INTEGER,yMin:Number.MAX_SAFE_INTEGER,xMax:Number.MIN_SAFE_INTEGER,yMax:Number.MIN_SAFE_INTEGER})).xMin,v=o.yMin,m=(o.xMax-h)*a,b=Math.round((o.yMax-v)*a+10),x=Math.round(m+10),A=(h-c)*a,T=Math.ceil((v-d)*a-5+u);return{x:Math.ceil(A-5+l),y:T,height:b,width:x}},e.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},e.prototype.getStaticSeriesRole=function(){},e.prototype.isXAxisCategorical=function(){var t,a;return null===(a=null===(t=this.data)||void 0===t?void 0:t.xGroupMetadata)||void 0===a?void 0:a.isCategoricalAxis},e.prototype.isPlotSymmetryShadingSupported=function(){var t,a;return!(this.isXAxisCategorical()||null!==(t=this.valueAxisProperties)&&void 0!==t&&t.logAxisScale||null!==(a=this.categoryAxisProperties)&&void 0!==a&&a.logAxisScale)},e.ClassName="scatterChart",e.NoAnimationThreshold=1e3,e.NoRenderResizeThreshold=1e3,e.DefaultZeroScalarDomain=[-1,1],e}(Vs);function Of(i,e){var t,a=i.data.dataLabelsSettings,r=a.fontProperties,n=null!==(t=function(i){var e=i.plotArea,t=e.width,a=e.height,r=new ts(t/2,a/2),n=function(i,e){var t=i/4,a=e/4;return[new ts(t,a),new ts(3*t,a),new ts(t,3*a),new ts(3*t,3*a)]}(t,a);return function(i,e,t){for(var o,a=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],r=[],n=t.xAxisProperties.scale,s=t.yAxisProperties.scale,l=0,u=t.data.dataPoints;l<u.length;l++){var c=u[l],d=n(c.x),h=s(c.y),v=zf(d,h,i);t.drawBubbles?r[v]||(r[v]=c.identity):(o=Ef(e[v].x,e[v].y,d,h))<a[v]&&(r[v]=c.identity,a[v]=o)}return _.filter(r,function(y){return!!y}).map(function(y){return y.getKey()})}(r,n,i)}(i))&&void 0!==t?t:[],s=r.color||J.v.getThemeColor(e,ye.uQ);return _.map(i.data.dataPoints,function(o){var l=o.formattedCategory.getValue(),u=(0,We.qk)(r,l);return{isPreferred:Bf(o.identity.getKey(),n),text:l,textSize:{width:Le.b.measureSvgTextWidth(u),height:Le.b.estimateSvgTextHeight(u)},outsideFill:s,insideFill:J.v.getThemeColor(e,ye.pl),parentType:0,parentShape:{point:{x:i.xAxisProperties.scale(o.x),y:i.yAxisProperties.scale(o.y)},radius:tr.calculateRadius(o.radius,i.data.sizeRange,i.plotArea,i.data.marker.rangeType,i.data.marker.multiplier),validPositions:[2,1,8,4,16,32,64,128]},identity:o.renderIdentity,fontProperties:r,leaderLine:{strokeColor:s,strokeWidth:1,strokeTransparency:50,strokePattern:qt.Dv.solid,strokeShow:!0},hasBackground:a.enableBackground,backgroundColor:a.backgroundColor,backgroundTransparency:a.backgroundTransparency,isCategory:!0}})}function zf(i,e,t){return i>t.x&&e<=t.y?0:i<=t.x&&e<=t.y?1:i<=t.x&&e>t.y?2:3}function Ef(i,e,t,a){return Math.sqrt((i-t)*(i-t)+(e-a)*(e-a))}function Bf(i,e){return _.some(e,function(t){return 0===i.localeCompare(t)})}var ha=R(5616),Hf=[Ge.h.auto,Ge.h.outsideEnd,Ge.h.insideEnd,Ge.h.insideCenter,Ge.h.insideBase],Wf=1,Gf=20;function jf(i){return{type:3,card:[Uf.call(this,i.categoryAxisData),Yf.call(this),Xf.call(this)].filter(function(e){return e})}}function Uf(i){var e=this,t=ha.wW.sentimentColors,a=this.originalData,r=a.sentimentColors,n=new F.CQ(new F.lg("sentimentColors"),"Role_DisplayName_Columns",(0,g.__spreadArray)((0,g.__spreadArray)([],_.values(t),!0),[ha.wW.valueAxis.totalsEnabled,ha.wW.categoryAxis.innerPadding],!1),this.localizer);return n.addGroup("colors",function(s){s.withDisplayName("Visual_Colors").addSimpleSlice("increaseFill",new F.BT({descriptor:t.increaseFill,value:{value:r.increaseFill.solid.color}}).build()).addSimpleSlice("decreaseFill",new F.BT({descriptor:t.decreaseFill,value:{value:r.decreaseFill.solid.color}}).build()).addSimpleSlice("otherFill",new F.BT({descriptor:t.otherFill,value:{value:r.otherFill.solid.color}}).build(),function(o){return o.withDisabled(!a.isBreakdown).withCustomDescription("Visual_Waterfall_Breakdown_OtherDescription")}),a.isBreakdown||s.addSimpleSlice("totalsEnabled",new F.bd({descriptor:ha.wW.valueAxis.totalsEnabled,value:e.isTotalsEnabled()}).build(),function(o){return o.withCustomDisplayName("Visual_Axis_Total_Column")}),e.isTotalsEnabled()&&s.addSimpleSlice("totalFill",new F.BT({descriptor:t.totalFill,value:{value:r.totalFill.solid.color}}).build())}),n.addGroup("spacing",function(s){s.withDisplayName("Visual_Spacing").addSimpleSlice("innerPadding",Oo(i,e.localizer))}),n.build()}function Yf(){var i=this,e=this.originalData,t=ha.wW.breakdown,a=new F.CQ(new F.lg("breakdown"),"Visual_Waterfall_Breakdown",t,this.localizer);return e.isBreakdown?(a.addGroup("breakdown",function(r){r.addSimpleSlice("maxBreakdowns",new F.JN({descriptor:t.maxBreakdowns,value:e.numberOfBreakdowns,localize:i.localizer,options:{minValue:{type:0,value:Wf},maxValue:{type:1,value:Math.min(Gf,e.totalBreakdownCategories)}}}).build(),function(n){return n.withCustomDisplayName("Visual_Waterfall_MaximumBreakdown")})}),a.build()):(a.withDisabled(!0,"Visual_BreakdownCard_DisabledReason"),a.build())}function Xf(){var i,e,t=ha.wW.labels,a=this.originalData,r=this.data.dataLabelsSettings,n={dataLabelsSettings:a.dataLabelsSettings,positionObject:Hf,show:!0,displayUnits:!0,precision:!0,fontSize:!0,fontFamily:!0,labelOrientation:!0,position:!0,enableBackground:r.enableBackground,backgroundColor:r.backgroundColor,backgroundTransparency:r.backgroundTransparency,style:this.style,bold:!0,italic:!0,underline:!0};r.position&&n.positionObject.indexOf(r.position)<0&&(r.position=Ge.h.auto);var o={cardBuilder:new F.CQ(new F.lg("labels"),"Visual_DataPointsLabels",t,this.localizer),dataLabelsProps:t,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:n,individualSelector:(0,lt.WD)({featureSwitches:this.featureSwitches,hasCategories:null!=_.first(a.categories),hasDynamicSeries:!1,hasSeriesSelector:!1})};if(a.isBreakdown){var l=null===(e=_.first(null===(i=_.first(a.series))||void 0===i?void 0:i.data))||void 0===e?void 0:e.identity.getSelector();l&&(o.repetitionSelector={metadata:l.metadata})}return(0,lt.XQ)(o)}function Zf(i,e){if(!e){var a=_.first(i).visualObjects;if(!(a.length>0))return;var n=this.localizer;switch(a[0].objectName){case"increase-fill":return Zs("Format_Increase_Fill",n);case"decrease-fill":return Zs("Format_Decrease_Fill",n);case"other-fill":return Zs("Format_Other_Fill",n);case"total-fill":return Zs("Format_Total_Fill",n);default:return}}}function Zs(i,e){var t=ha.wW.labels.show,a="".concat("Visual","-").concat("sentimentColors");return[{type:0,excludedResetFormattingIds:[t]},(0,g.__assign)((0,g.__assign)({type:2},t),{enabledLabel:e("Format_AddDataLabels")}),{type:1,destinationInfo:{cardUid:a},label:e(i)}]}function Kf(i){var t=_.first(i).visualObjects;if(t.length>0)switch(t[0].objectName){case"data-labels":return function(i){var e=ha.wW.labels;return(0,Pt.Jf)({hostServices:i,omitSelectorForSingleSeries:!0,individualSelector:!0,selector:void 0,repetitionSelector:void 0},{fontFamilyReference:e.fontFamily,fontSizeReference:e.fontSize,boldReference:e.bold,italicReference:e.italic,underlineReference:e.underline,fontColorReference:e.color,displayUnitsReference:e.labelDisplayUnits,precisionReference:e.labelPrecision})}(this.hostService);case"increase-fill":return(0,Pt.w3)(this.hostService,void 0,ha.wW.sentimentColors.increaseFill);case"decrease-fill":return(0,Pt.w3)(this.hostService,void 0,ha.wW.sentimentColors.decreaseFill);case"other-fill":return(0,Pt.w3)(this.hostService,void 0,ha.wW.sentimentColors.otherFill);case"total-fill":return(0,Pt.w3)(this.hostService,void 0,ha.wW.sentimentColors.totalFill);default:return}}var bc=(0,Me.CH)("waterfall-connector"),vl=(0,Me.CH)("column");function Jf(i,e){var t=this,a=this.clippedData.series[0].data,r=this.interactivityService&&this.interactivityService.hasSelection(),n=this.xAxisProperties.scale,s=this.yAxisProperties.scale,o=s.domain()[0],l=this.yAxisProperties.invertAxis,u=this.featureSwitches.onObject;this.mainGraphicsSVG.attr("height",this.availableHeight).attr("width",this.availableWidth),(0,Wn.H4)(this.mainGraphicsSVG,this.clippedData.strokeSettings);var c=this.mainGraphicsContext.selectAll(vl.selector).data(a,function(f){return f.key}).join(function(f){return f.append("rect").classed(vl.class,!0).classed("highlight",function(p){return p.highlight})}).style("fill",function(f){return f.color}).style("fill-opacity",function(f){return 1===f.barType?Vt.Ko:(0,Vt.eR)(f.selected,f.highlight,r,t.data.hasHighlights)}).attr("width",this.layout.categoryWidth).attr("x",function(f){return n(f.categoryIndex)}).attr("y",function(f){if(l){var p;return p=f.position<o?Math.abs(s(o)-s(f.value)):Math.abs(s(f.position)-s(f.position+f.value)),Ks(s,f.position,f.value)-p}return Ks(s,f.position,f.value)}).attr("height",function(f){return f.position<o?Math.abs(s(o)-s(f.value)):Math.abs(s(f.position)-s(f.position+f.value))});this.interactivityService&&c.attrs({tabindex:0,focusable:!0,"aria-label":function(p){return(0,Un.X)(p.tooltipInfo())},role:"option","aria-selected":function(p){return p.selected}}).classed(Vt.Pg,!ma.M.isInternetExplorerOrEdge()),u&&c.classed(U.cy,!0).attr(U.Ez,function(f){return function(i){switch(i){case 1:return"decrease-fill";case 0:return"increase-fill";case 3:return"other-fill";case 2:return"total-fill";default:k.fF.assertNever(i)}}(f.sentimentColorType)}).attr(U.CK,function(f){return function(i){switch(i){case 1:return"Visual_DecreaseFill";case 0:return"Visual_IncreaseFill";case 3:return"Visual_OtherFill";case 2:return"Visual_TotalFill";default:k.fF.assertNever(i)}}(f.sentimentColorType)}).attr(U.QZ,3),this.mainGraphicsContext.selectAll(bc.selector).data(a.slice(0,a.length-1),function(f){return f.key}).join(function(f){return f.append("line").classed(bc.class,!0)}).style("stroke",J.v.getThemeColor(this.style,"foregroundNeutralTertiary")).attrs({x1:function(p){return n(p.categoryIndex)},y1:function(p){return s(p.position+p.value)},x2:function(p){return n(p.categoryIndex+1)+t.layout.categoryWidth},y2:function(p){return s(p.position+p.value)}}),this.tooltipsEnabled&&this.tooltipService.addTooltip(c,function(f){return f.data&&f.data.tooltipInfo()},function(f){return f.data&&f.data.identity&&[f.data.identity]});var v,y,d=this.data.dataLabelsSettings,h=[];return(d&&d.show||d.showCategory)&&(h=this.createLabelDataPoints()),this.interactivityService&&(y={navigationStrategy:Y.jN.CategoryOnly,helper:this},v={root:this.mainGraphicsContext,bars:c,isBreakdown:this.data.isBreakdown,formatMode:e}),(0,Et.bL)(this.animationOptions),{dataPoints:this.data.series[0].data,behaviorOptions:v,navigationOptions:y,labelDataPoints:h,labelsAreNumeric:!0,labelOrientation:d.labelOrientation,animateLabels:!i}}function Ks(i,e,t){return t<0?i(e):i(e)-(i(0)-i(t))}function $f(i,e,t){return t<0?i(e)-(i(0)-i(t)):i(e)}var ap=function(i){function e(t){var a;return i.call(this,(0,g.__assign)((0,g.__assign)({},t),{tooltipsEnabled:null===(a=t.tooltipsEnabled)||void 0===a||a}))||this}return(0,g.__extends)(e,i),e.prototype.initRenderer=function(t){if(i.prototype.initRenderer.call(this,t),this.svg.classed(e.WaterfallClassName,!0),this.mainGraphicsSVG=this.svg.append("svg"),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").classed(e.MainGraphicsContextClassName,!0),this.interactivityService){var a=ma.M.isInternetExplorerOrEdge();this.mainGraphicsContext.attrs({tabindex:0,focusable:!0,role:"listbox","aria-multiselectable":!0,"aria-label":this.localizer("Visual_Plot")}).classed(Vt.Pg,!a)}},e.getDefaultWaterfallLabelSettings=function(t,a,r,n){return void 0===a&&(a=!1),{show:a,labelOrientation:Ms.B.Horizontal,position:Ge.h.auto,displayUnits:0,precision:ye.NZ,fontProperties:(0,lt.bT)({style:t,textClassName:"smallLightLabel",labelColor:r,fontSize:n}).fontProperties,enableBackground:!1,bold:!1,italic:!1,underline:!1}},e.doesDataLabelFitInShape=function(t,a,r){if(null==t||null===t.value)return!1;var n={text:r.labelText(t),fontFamily:ye.bN.fontFamily,fontSize:ye.bN.fontSize,fontWeight:ye.bN.fontWeight};if(Ks(a.scale,t.position,t.value)-ye.FJ>0)return!0;var o=Le.b.measureSvgTextWidth(n),l=Le.b.estimateSvgTextHeight(n),u=r.categoryWidth,c=Math.abs((0,ne.sc)(a.scale,Math.max(0,Math.abs(t.value)),0));return!(o>u||l>c)},e.prototype.setData=function(t){k.fF.assertValue(t,"dataViews");var a=this.getSentimentColorsFromObjects(null),r=e.DefaultBreakdowns,n=t.length>0?t[0]:void 0;if(this.data=this.originalData={series:[{data:[]}],categories:[],valuesMetadata:[],legendData:(0,da.Fe)(this.style),hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,positionMax:0,positionMin:0,dataLabelsSettings:e.getDefaultWaterfallLabelSettings(this.style,!1,void 0),sentimentColors:a,axesLabels:{x:null,y:null},numberOfBreakdowns:r,totalBreakdownCategories:0,totalsEnabled:true},n){if(this.dataView=n,n.metadata&&n.metadata.objects){var s=n.metadata.objects,o=s.labels;o&&(0,lt.ww)(o,this.data.dataLabelsSettings,!0,this.style),a=this.getSentimentColorsFromObjects(s),r=(0,le.NA)(s,ha.wW.breakdown.maxBreakdowns,e.DefaultBreakdowns)}(n.categorical||n.matrix)&&(this.data=this.originalData=Qc.convert({dataView:n,style:this.style,hostServices:this.hostService,dataLabelSettings:this.data.dataLabelsSettings,sentimentColors:a,interactivityService:this.interactivityService,tooltipsEnabled:this.tooltipsEnabled,numberOfBreakdowns:r}))}},e.prototype.getFormattingCards=function(t){return jf.call(this,t)},e.prototype.getSubSelectionShortcuts=function(t,a){return Zf.call(this,t,a)},e.prototype.getSubSelectionStyles=function(t){return Kf.call(this,t)},e.prototype.isTotalsEnabled=function(){var t,a;return null!==(a=null===(t=this.data)||void 0===t?void 0:t.totalsEnabled)&&void 0!==a&&a},e.prototype.hasLegend=function(){return!0},e.createClippedDataIfOverflowed=function(t,a){k.fF.assertValue(t,"createClippedDataIfOverflowed");var r=t.series[0].data;if(a<r.length){var n=(0,be.ED)(t);return n.series=[{data:r.slice(0,a)}],n.categories=t.categories.slice(0,a),n}return t},e.prototype.calculateAxesProperties=function(t){var r,a=this;this.updateCurrentViewport(t);var n=t.categoryAxisOptions,s=t.valueAxisOptions,o=this.clippedData=this.data,l=o.categories.length-(this.isTotalsEnabled()?0:1),u=this.getPreferredPlotArea({isScalar:!1,categoryCount:l,categoryThickness:ka,outerPaddingRatio:t.outerPaddingRatio}),c=Ua({availableWidth:u.width,categoryCount:l,preferredCategoryWidth:null!==(r=o?.preferredCategoryWidth)&&void 0!==r?r:null,domain:null,isScalar:!1,cartesianOptions:this.options,trimOrdinalDataOnOverflow:t.trimOrdinalDataOnOverflow,outerPaddingRatio:t.outerPaddingRatio,innerPaddingRatio:t.innerPaddingRatio});this.options.isScrollable||(o=this.clippedData=e.createClippedDataIfOverflowed(o,c.categoryCount));var d=Yt(this.getAxesDomains(!1,{valueAxis:!0}).valueAxis,0);d=ga(s.includeDomain,d);var h=function(S){var m,b="x"===S,x="y"===S,C=b?n:s,A=Ra({pixelSpan:b?u.width:u.height,domainOptions:b?bt(o.series,Ut(o.categoryMetadata),!1,[n.includeDomain]):d,metaDataColumn:b?o.categoryMetadata:o.valuesMetadata,axisZoom:void 0,zeroScalarDomain:x?e.DefaultZeroScalarDomain:void 0,isScalar:x,isVertical:x,isCategoryAxis:b,formatString:null!==(m=As(b?[]:a.data.series))&&void 0!==m?m:(0,we.EO)(b?o.categoryMetadata:o.valuesMetadata[0],N.p.general.formatString),outerPadding:x?0:c.categoryThickness*c.outerPaddingRatio,outerPaddingRatio:x?0:c.outerPaddingRatio,innerPaddingRatio:x?void 0:t.innerPaddingRatio,categoryThickness:x?void 0:c.categoryThickness,forcedTickCount:t.forcedTickCount,axis:(0,g.__assign)((0,g.__assign)({},C.axis),{invertAxis:C.axis.invertAxis&&x}),preventNice:Ya(b?C.includeDomain:d),useTickIntervalForDisplayUnits:!!x||void 0,getValueFn:b?function(T,P){return e.lookupXValue(o,T,P)}:void 0});return b&&(A.outerPaddingRatio=c.outerPaddingRatio,o.categoryIdentities&&(A.categoryIdentities=o.categoryIdentities)),A};this.xAxisProperties=h("x"),this.yAxisProperties=h("y");var v=(0,it.d6)(this.yAxisProperties,o.dataLabelsSettings),y=(0,lt.fI)(),f=this.xAxisProperties.categoryThickness*(1-t.innerPaddingRatio);return this.layout={categoryCount:c.categoryCount,categoryThickness:c.categoryThickness,isScalar:c.isScalar,outerPaddingRatio:c.outerPaddingRatio,categoryWidth:f,labelText:function(S){var b=y.getOrCreate(S.labelFormatString,o.dataLabelsSettings,v.units,v.getPrecision(!!S.labelFormatString,o.series[S.seriesIndex].type));return(0,lt.Gv)({label:b.format(S.value)})},labelLayout:e.getLabelLayoutXYForWaterfall(this.xAxisProperties,f,this.yAxisProperties,d?.domain),filter:function(S){return e.doesDataLabelFitInShape(S,a.yAxisProperties,a.layout)},style:{fill:function(S){return S.isLabelInside?J.v.getThemeColor(a.style,ye.pl):S.labelFill}}},[this.xAxisProperties,this.yAxisProperties]},e.getLabelLayoutXYForWaterfall=function(t,a,r,n){return{x:function(o){return t.scale(o.categoryIndex)+a/2},y:function(o){return e.getWaterfallLabelYPosition(r.scale,o,n)}}},e.getWaterfallLabelYPosition=function(t,a,r){var n=t(0)-t(Math.abs(a.value)),s=t(a.position),o=t(r[0]),l=t(a.position+a.value);if(a.value<0){var c=s+n+Le.b.estimateSvgTextHeight({text:a.labelText,fontFamily:ye.bN.fontFamily,fontSize:ye.bN.fontSize,fontWeight:ye.bN.fontWeight});if(o>c)return c}else{var d=s-n-ye.FJ;if(d>0)return d}return a.isLabelInside=!0,e.getWaterfallInsideLabelYPosition(s,l,o)},e.getWaterfallInsideLabelYPosition=function(t,a,r){return t=(t=t<0?0:t)>r?r:t,a=(a=a<0?0:a)>r?r:a,Math.abs(a-t)/2+Math.min(t,a)},e.prototype.getAxesDomains=function(t,a){var r={},n=this.activeData;return n&&a.valueAxis&&(r.valueAxis=[n.positionMin,n.positionMax]),r},e.lookupXValue=function(t,a,r){var n=t.series[0].data;return a===n.length-1?n[a].categoryValue:Yi(t,a,n[a].type||r,!1)},e.prototype.getVisualCategoryAxisIsScalar=function(){return!1},e.prototype.setFilteredData=function(t,a){var r=this.clippedData=(0,be.ED)(this.data);r.series=[{data:r.series[0].data.slice(t,a)}],r.categories=r.categories.slice(t,a)},e.prototype.render=function(t,a,r){return Jf.call(this,t,r)},e.prototype.getSupportedCategoryAxisType=function(){return ht.w.categorical},e.prototype.getFirstElement=function(){return _.isEmpty(this.clippedData.series)||_.isEmpty(this.clippedData.series[0].data)?{element:null}:{element:this.getHTMLElementFromCategoryIndex(this.clippedData.series[0].data[0].categoryIndex)}},e.prototype.getNextDataPoint=function(t,a,r){var s,n=t;do{switch(r){case Y.x0.NextCategory:t+=1,((this.isTotalsEnabled()||this.data.isBreakdown)&&t>=this.data.categories.length||!this.isTotalsEnabled()&&!this.data.isBreakdown&&t>=this.data.categories.length-1)&&(t=0);break;case Y.x0.PreviousCategory:(t-=1)<0&&(t=this.isTotalsEnabled()||this.data.isBreakdown?this.data.categories.length-1:this.data.categories.length-2);break;case Y.x0.NextSeries:case Y.x0.PreviousSeries:break;default:k.fF.assertNever(r)}s=this.data.series[a].data[t]}while(s&&0===s.value&&n!==t);return{element:this.getHTMLElementFromCategoryIndex(t),targetCategoryIndex:t}},e.prototype.getHTMLElementFromCategoryIndex=function(t){return this.mainGraphicsContext.selectAll(vl.selector).filter(function(a){return a.categoryIndex===t}).node()},e.prototype.getSentimentColorsFromObjects=function(t){var a=J.v.create(this.style);return{increaseFill:{solid:{color:a.getColorForPropertyWithDefaultColor(t,ha.wW.sentimentColors.increaseFill,J.v.getSentimentColor(this.style,"good"))}},decreaseFill:{solid:{color:a.getColorForPropertyWithDefaultColor(t,ha.wW.sentimentColors.decreaseFill,J.v.getSentimentColor(this.style,"bad"))}},totalFill:{solid:{color:a.getColorForPropertyWithDefaultColor(t,ha.wW.sentimentColors.totalFill,J.v.getDataColorByIndex(this.style,0))}},otherFill:{solid:{color:a.getColorForPropertyWithDefaultColor(t,ha.wW.sentimentColors.otherFill,J.v.getSentimentColor(this.style,"neutral"))}}}},e.prototype.createLabelDataPoints=function(){for(var t,a=[],r=this.data,n=this.xAxisProperties.scale,s=this.yAxisProperties.scale,o=this.yAxisProperties.invertAxis,l=s(0),u=r.series,c=(0,lt.fI)(),d=r.dataLabelsSettings,h=(0,it.d6)(this.yAxisProperties,d),v=0,y=u;v<y.length;v++)for(var f=y[v],p=0,S=f.data;p<S.length;p++){var m=S[p],b=m.labelFormatString,x=c.getOrCreate(b,this.data.dataLabelsSettings,h.units,h.getPrecision(!!b,f.type)),C=(0,ut.Bw)(x.format(m.value)),A=d.fontProperties,T=(0,We.qk)(A,C);a.push({isPreferred:!0,text:C,textSize:{width:Le.b.measureSvgTextWidth(T),height:Le.b.estimateSvgTextHeight(T,!0)},outsideFill:null!==(t=m.labelFill)&&void 0!==t?t:J.v.getThemeColor(this.style,ye.uQ),insideFill:J.v.getThemeColor(this.style,ye.pl),parentType:1,parentShape:{rect:{left:n(m.categoryIndex),top:o?$f(s,m.position,m.value):Ks(s,m.position,m.value),width:this.layout.categoryWidth,height:Math.abs(l-s(Math.abs(m.value)))},orientation:m.value>=0?o?2:1:o?1:2,validPositions:e.getValidPositions(d.position,m.value)},fontProperties:A,identity:void 0,hasBackground:d.enableBackground,backgroundColor:d.backgroundColor,backgroundTransparency:d.backgroundTransparency})}return a},e.getValidPositions=function(t,a){if(0===a)return e.validZeroLabelPosition;switch(t){case Ge.h.insideEnd:return[4];case Ge.h.insideCenter:return[1];case Ge.h.insideBase:return[2];case Ge.h.outsideEnd:return[16];default:return[16,4,1,2]}},e.prototype.getCartesianVisualCapabilities=function(){return{supportsHierarchicalCategoryAxis:!1}},e.prototype.getStaticSeriesRole=function(){},e.DefaultZeroScalarDomain=[0,1],e.DefaultBreakdowns=5,e.WaterfallClassName="waterfallChart",e.MainGraphicsContextClassName="mainGraphicsContext",e.validZeroLabelPosition=[16,8],e}(Vs);function qs(i,e){return{create:function(a){return i.viewModelAdapterFactory.createLayerAdapter(e,a)}}}var xc=function(e){return new Qh((0,g.__assign)((0,g.__assign)({},e),{columnChartType:function(t){switch(t){case 14:case 5:return 20;case 13:case 4:return 12;case 9:return 52;case 7:return 18;case 6:return 10;case 8:return 50;case 10:return 84;default:return k.fF.assertFail("Not supported"),20}}(e.chartType),isComboChart:xa(e.chartType),viewModelAdapterFactory:qs(e,4)}))},Cc=function(e){return new qv((0,g.__assign)((0,g.__assign)({},e),{lineChartType:function(t){switch(t){case 0:case 13:case 14:return 1;case 3:return 32;case 1:return 2;case 2:return 16;default:return k.fF.assertFail("Not supported"),1}}(e.chartType),isComboChart:xa(e.chartType),viewModelAdapterFactory:qs(e,0)}))},np=new(function(){function i(){}return i.prototype.getDataBoundReferenceLines=function(e,t,a){var r=[],n=[];if(e)if(e.matrix&&e.matrix.valueSources){var s=e.matrix;if(s.valueSources&&n.push.apply(n,e.matrix.valueSources||[]),s.rows&&s.rows.levels)for(var o=0,l=s.rows.levels;o<l.length;o++)n.push.apply(n,l[o].sources||[])}else if(e.categorical&&e.categorical.values){var c=_.head(e.categorical.values.grouped());if(c)for(var d=0,h=c.values;d<h.length;d++)n.push(h[d].source)}for(var y=0;y<n.length;y++){var f=n[y],p=J.v.getDataColorByIndex(a,y,yt.fA),S=(0,le.AO)(f.objects,"referenceLine"),m=this.getCartesianRoleKind(f,t);r.push.apply(r,(0,he.UL)(S,p,"referenceLine",m,a,void 0,f)||[])}return r},i.prototype.getCartesianRoleKind=function(e,t){var a=e.roles;if(t.getAxisLocationForRole&&a)for(var r in a)if(a[r])return t.getAxisLocationForRole(r);return 1},i}()),sp=function(){function i(){}return i.convert=function(e){var t,a=e.dataViews,r=e.layers,n=e.layerStyle,s=e.chartType,o=e.hasDataChanged,l=r.length>1&&!!(a[0]&&a[0].categorical&&a[0].categorical.values),u=n.colorPalette.dataColors;u.clearPreferredScale();for(var c=Ao(a),d=_.filter(a,gr.Aq),h=_.filter(a,q.Qp),v=_.filter(a,Bn.Ik),y=[],f=[],p=[],S=0,m=r.length;S<m;S++){var b=c[S],x=b?[b]:[];if(null!=d[S]&&x.push(d[S]),null!=v[S]&&x.push(v[S]),r[S].setData(x,e.multipleInfo),p.push(up(r[S],b,n,l,s)),f.push.apply(f,np.getDataBoundReferenceLines(b,r[S],n)||[]),Il(a,r,S)){var C=h[S];if(C){var T=(0,q.VP)(C,b,S>0,n);y.push.apply(y,T||[])}}m>1&&u.rotateScale()}var D,P=Vl.converter(_.head(a));if(_.isEmpty(a))D=new Ps({style:n,chartType:s});else{var L=a[0],O=L.metadata&&!_.isEmpty(null===(t=L.categorical)||void 0===t?void 0:t.categories)&&!!(0,xt.A8)(L.categorical.categories[0]),B=11===s;D=new Ps({chartType:s,valueAxisProperties:wn(L.metadata,B),y2AxisProperties:wn(L.metadata,B,"y2Axis"),categoryAxisProperties:ja(L.metadata,O||B),isValueAxisIrregular:Gc(a,r),style:n,hasY2Role:(0,Dt.c5)(L,"Y2")||a[1]&&(0,Dt.c5)(a[1],"Y2"),forceShowY2:P.show&&P.showOnValueSecAxis||!_.isEmpty(e.multipleInfo)&&xa(s),seriesLabelSettings:Ds(r,s,n),featureSwitches:e.featureSwitches}),o&&function(i,e,t,a,r){if(i&&i.length>0){var s=i[0].metadata;if(s){var o=Rl(i,a);e.push.apply(e,function(i,e,t,a){var r=J.v.getDataColorByIndex(e,0,yt.fA),n=[];if(t){var s=(0,le.AO)(i.objects,he.XC);n.push.apply(n,(0,he.UL)(s,r,he.XC,0,e,a,void 0)||[])}var o=(0,le.AO)(i.objects,he.Dk);return n.push.apply(n,(0,he.UL)(o,r,he.Dk,1,e)||[]),n}(s,t,o,r)||[])}}}(a,f,n,r,e.chartType)}return{legendData:(0,da.nh)(p,n),trendLines:y,referenceLines:f,axesData:D,warningObjectCollection:new Ue.tb,showIcon:!1,scrollbarOptions:{scrollbarWidth:ks.ScrollbarWidth},zoomData:P}},i}();function up(i,e,t,a,r){var n=i.getLegendData();if(n?.dataPoints.length>1)return n;var s=(0,da.pq)({dataView:e,showByDefault:!0,staticSeriesRoleNames:[i.getStaticSeriesRole()],style:t,allowLegendWithNoSeries:a},function(i){return 4===i||6===i||5===i||7===i||9===i||8===i||11===i||10===i}(r));return!n||s?.isGradientLegend?s:n}var dp=function(){function i(e){this.staticUpdateOptions=e}return i.prototype.create=function(e){return new hp(this.staticUpdateOptions,e)},i}(),hp=function(){function i(e,t){this.staticUpdateOptions=e,this.updateOptions=t}return i.prototype.apply=function(e,t){var a,v,r=this.staticUpdateOptions,n=r.layerInitDataOptions,s=r.updateGlobalAxesDomains,o=this.updateOptions,l=o.isSmallMultiples,u=o.reader,c=o.dataViews,d=o.updateOptions,h=o.requestedPerMultipleAxisDomains;if(l){v=xa(t)?u.convertComboFrame(e.index):[u.convertFrame(e.index)];for(var y=void 0,f=0;f<v.length;f++){var p=v[f],S=(0,vu.eC)(p.metadata,qe.e0.formatString,N.x.category,p.categorical,!!y);y?S.categorical.categories=y:y=null===(a=S.categorical)||void 0===a?void 0:a.categories,v[f]=S}}else v=c;e.hasInitializedData()||e.initData(n);var m=(0,g.__assign)((0,g.__assign)({},d),{dataViews:v,multipleInfo:l?this.buildMultipleInfo(e.index):void 0});e.update(m),h&&(h.categoryAxis||h.valueAxis||h.secondaryValueAxis)&&s(e.getAxesDomains(!0,h))},i.prototype.applySynchronizedAxes=function(e,t){var a=this.updateOptions.isSmallMultiples;k.fF.assert(function(){return a},"Should not apply synchronizedAxes to non-small multiples"),e.applySynchronizedDomains(t)},i.prototype.applyResize=function(e){e.resize(this.updateOptions.updateOptions.viewport)},i.prototype.buildMultipleInfo=function(e){var t=this;k.fF.assert(function(){return t.updateOptions.isSmallMultiples},"isSmallMultiples"),k.fF.assert(function(){return!!t.updateOptions.reader},"reader");var a=this.updateOptions.reader;if(a){var r=a.getFrameNode(e),n=a.getFrameSourceColumns().map(function(s,o){return{metadata:s,value:r.levelValues[o].value}});return{identity:r.identity,sources:n,isCoreMultiple:0===e}}},i}(),fl=function(){function i(e,t,a,r,n,s,o){this.smallMultiples=e,this.index=t,this.featureSwitches=a,this.layers=r,this.type=n,this.interactivityService=s,this.getLayerInitOptions=o,this.state=0}return i.create=function(e,t,a,r,n,s,o){return new i(e,t,a,n,s,r,o)},i.prototype.getDataPoint=function(){if(!this.dataPoint){var e=this.multipleInfo,t=_.first(e.sources).metadata.queryName,a=e.sources.map(function(n){return(0,Tt.Y)(n.metadata,n.value,e.identity)}),r=(new Tt.dw).withColumnIdentity(e.identity,t,a).createSelectionId();this.dataPoint={selected:!1,identity:r},this.interactivityService&&this.interactivityService.applySelectionStateToData([this.dataPoint])}return this.dataPoint},i.prototype.getIndex=function(){return this.index},i.prototype.isSelected=function(){return this.getDataPoint().selected},i.prototype.getState=function(){return this.state},i.prototype.initRenderer=function(e){var t=this;k.fF.assert(function(){return!(2&t.getState())},"`initRenderer` was called when there was already a renderer"),this.renderer=e;var a=this.getLayerInitOptions(e);this.layers.forEach(function(r){return r.initRenderer(a)}),this.state|=2},i.prototype.getRenderer=function(){var e=this;return k.fF.assert(function(){return!!(2&e.getState())},"`getRenderer` was called before a renderer was set"),this.renderer},i.prototype.initData=function(e){var t=this;k.fF.assert(function(){return!(1&t.getState())},"`initData` multiple times"),this.layers.forEach(function(a){var r;return null===(r=a.initData)||void 0===r?void 0:r.call(a,e)}),this.style=e.style,this.state|=1},i.prototype.update=function(e){var t=this;k.fF.assert(function(){return!!(1&t.getState())},"update was called before `initData`"),this.dataViews=e.dataViews,this.multipleInfo=e.multipleInfo,this.dataPoint=void 0,this.adapterFactory=e.adapterFactory;var a=this.layers;return this.responsiveData=void 0,this.data=sp.convert({layerStyle:this.style,chartType:this.type,dataViews:e.dataViews,layers:a,featureSwitches:this.featureSwitches,hasDataChanged:null!=e.operationKind,multipleInfo:e.multipleInfo}),this.data},i.prototype.isVisible=function(){return!!(2&this.state)},i.prototype.hasInitializedData=function(){return!!(1&this.state)},i.prototype.getMultipleInfo=function(){return this.multipleInfo},i.prototype.applySynchronizedDomains=function(e){var t=this.data&&this.data.axesData;if(e&&t){var a=function(d,h){d&&h.includeDomains.push(Yt(d,1))},r=t.categoryAxis,n=t.valueAxis,s=t.secondaryValueAxis,l=e.valueAxis,u=e.secondaryValueAxis;a(e.categoryAxis,r),r&&n&&(r.sharedAxis||!r.scaleToFit)&&(n.sharedAxis||!n.scaleToFit)&&(a(l,n),a(u,s))}},i.prototype.resize=function(e){if(this.adapterFactory&&this.data){var a=this.adapterFactory.createCartesianAdapter({cartesianData:this.data,dataView:this.dataViews[0],viewport:e,isCoreMultiple:!this.multipleInfo||this.multipleInfo.isCoreMultiple});this.responsiveData=a.getData()}},i.prototype.getCapabilities=function(){var e={domainAggregateRoles:[],supportedDomainAggregates:void 0},t={domainAggregateRoles:[],supportedDomainAggregates:void 0},a={domainAggregateRoles:[],supportedDomainAggregates:void 0};return this.layers.forEach(function(r){var n=r.getCartesianVisualCapabilities();if(n.axesCapabilities){var s=n.axesCapabilities,o=s.categoryAxis,l=s.valueAxis,u=s.secondaryValueAxis,c=function(h,v){!h||!h.domainAggregateRole||(v.domainAggregateRoles.push(h.domainAggregateRole),void 0===v.supportedDomainAggregates?v.supportedDomainAggregates=h.supportedDomainAggregates:v.supportedDomainAggregates&=h.supportedDomainAggregates)};k.fF.assertValue(o,"layerCategoryAxisCapabilities"),c(o,e),c(l,t),c(u,a)}else k.fF.log("All small-multiples layers must provide `axesCapabilities`")}),{axesCapabilities:{categoryAxis:_.isEmpty(e.domainAggregateRoles)?void 0:(0,g.__assign)((0,g.__assign)({},e),{domainAggregateRoles:_.uniq(e.domainAggregateRoles)}),valueAxis:_.isEmpty(t.domainAggregateRoles)?void 0:(0,g.__assign)((0,g.__assign)({},t),{domainAggregateRoles:_.uniq(t.domainAggregateRoles)}),secondaryValueAxis:_.isEmpty(a.domainAggregateRoles)?void 0:(0,g.__assign)((0,g.__assign)({},a),{domainAggregateRoles:_.uniq(a.domainAggregateRoles)})}}},i.prototype.getAxesDomains=function(e,t){for(var a={},r=0;r<this.layers.length;r++){var n=this.layers[r];if(n.getAxesDomains){var s=n.getAxesDomains(e,t);s.categoryAxis&&(a.categoryAxis=ii(a.categoryAxis||Ga,s.categoryAxis)),s.valueAxis&&(r>0&&xa(this.type)?a.secondaryValueAxis=ii(a.secondaryValueAxis||Ga,s.valueAxis):a.valueAxis=ii(a.valueAxis||Ga,s.valueAxis)),s.secondaryValueAxis&&(a.secondaryValueAxis=ii(a.secondaryValueAxis||Ga,s.secondaryValueAxis))}else k.fF.assertFail("getAxesDomains does not exist")}return a},i.prototype.getData=function(){return this.responsiveData||this.data},i.prototype.clearSelection=function(){for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].onClearSelection()},i.prototype.updateLayers=function(){this.layers.forEach(function(e){return e.render(!0)})},i.prototype.destroy=function(){var e=this;this.renderer&&(k.fF.assert(function(){return!!(2&e.getState())},"`destroy` was called before we had a renderer"),this.renderer.destroy())},i}(),vp=function(){function i(e,t,a,r){this.type=e,this.featureSwitches=t,this.layerFactory=a,this.getLayerInitRendererOptions=r,this.multiples=[]}return i.prototype.init=function(e,t){var a=this;this.rowLoadMoreDataHandler=new bn.J(e.host),this.updateFactory=new dp({layerInitDataOptions:e,updateGlobalAxesDomains:function(n){return a.updateGlobalAxesDomains(n)}}),this.interactivityService=t,this.multiples=[]},i.prototype.getObjects=function(){return this.reader?this.reader.getObjects():void 0},i.prototype.getCoreMultiple=function(){return this.coreMultiple||(this.coreMultiple=fl.create(this,0,this.featureSwitches,this.interactivityService,this.layerFactory(),this.type,this.getLayerInitRendererOptions)),this.coreMultiple},i.prototype.getShouldResetRowMultipleScrollPosition=function(){return this.shouldResetRowMultipleScrollPosition},i.prototype.get=function(e){var t=this;if(k.fF.assert(function(){return t.isSmallMultiples()||0===e},"Non-small multiples only supports 0 index"),!this.isSmallMultiples())return this.getCoreMultiple();if(k.fF.assertValue(this.multipleUpdate,"Can not get multiple value before having an update"),null==this.multipleUpdate)return this.getCoreMultiple();var a=this.multiples[e];if(!a)for(var r=function(l){k.fF.assert(function(){return l===t.multiples.length},"Multiples should only be added to the end"),a=n.multiples[l]=fl.create(n,l,n.featureSwitches,n.interactivityService,n.layerFactory(),n.type,n.getLayerInitRendererOptions);var u=n.multipleUpdate;u.apply(a,n.type),n.isSmallMultiples()&&u.applySynchronizedAxes(a,n.axesDomains),u.applyResize(a)},n=this,s=this.multiples.length;s<=e;s++)r(s);return a},i.prototype.clear=function(){this.getMultiples(!0).forEach(function(e){return e.destroy()}),this.multiples=[],this.coreMultiple=void 0,this.axesDomains=void 0,this.shouldResetRowMultipleScrollPosition=void 0,this.multipleUpdate=void 0},i.prototype.resize=function(e){this.getMultiples(!0).forEach(function(t){return t.resize(e)})},i.prototype.update=function(e){var t=e.dataViews;this.updateOptions=e;var a,r=this.isSmallMultiples(t);this.shouldResetRowMultipleScrollPosition=!e.preserveScrollPosition;var n=this.getCoreMultiple();r?(this.reader=pu.create(t[0],qe.e0.formatString),this.updateFactory.create({dataViews:e.dataViews,isSmallMultiples:r,reader:this.reader,requestedPerMultipleAxisDomains:void 0,updateOptions:e}).apply(n,this.type),(!e.preserveScrollPosition||e.formatMode)&&(this.lastUpdatedFrameIndex=0,this.axesDomains=void 0,this.requestPerMultipleAxisDomains=this.updateSynchronizedDomainsFromAggregates()),a=this.reader.getFrameCount(),this.rowLoadMoreDataHandler.updateDataView(e.dataViews[0]),this.rowLoadMoreDataHandler.onLoadMoreDataCompleted()):(this.reader=void 0,this.lastUpdatedFrameIndex=0,this.axesDomains=void 0,a=1,this.rowLoadMoreDataHandler.updateDataView(void 0),this.rowLoadMoreDataHandler.onLoadMoreDataCompleted()),this.multipleUpdate=this.updateFactory.create({dataViews:e.dataViews,isSmallMultiples:r,reader:this.reader,requestedPerMultipleAxisDomains:this.requestPerMultipleAxisDomains,updateOptions:e}),this.updateMultiples(a)},i.prototype.updateMultiples=function(e){for(var t=this,a=this.multiples,r=this.multipleUpdate,s=this.isSmallMultiples(this.updateOptions.dataViews),o=this.getCoreMultiple(),l=this.requestPerMultipleAxisDomains,u={startIndex:this.lastUpdatedFrameIndex,endIndex:e},c=function(y){var f=s?a[y]:o;!f&&l&&(k.fF.assert(function(){return y===a.length},"Multiples should only be added to the end"),f=a[y]=fl.create(d,y,d.featureSwitches,d.interactivityService,d.layerFactory(),d.type,d.getLayerInitRendererOptions)),f&&r.apply(f,d.type)},d=this,h=u.startIndex;h<u.endIndex;h++)c(h);this.getMultiples(!0).forEach(function(v){v&&(s&&r.applySynchronizedAxes(v,t.axesDomains),r.applyResize(v))}),this.lastUpdatedFrameIndex=u.endIndex},i.prototype.updateSynchronizedDomainsFromAggregates=function(){var e,d,t=this.getCoreMultiple(),r=t.getCapabilities().axesCapabilities,n=r.categoryAxis,s=r.valueAxis,o=r.secondaryValueAxis,l_categoryAxis=!!(2&n.supportedDomainAggregates),l_valueAxis=!!(2&s.supportedDomainAggregates),l_secondaryValueAxis=!!(o&&2&o.supportedDomainAggregates),u={categoryAxis:!!(1&n.supportedDomainAggregates),valueAxis:!!(1&s.supportedDomainAggregates),secondaryValueAxis:!!(o&&1&o.supportedDomainAggregates)};if(l_categoryAxis||l_valueAxis||l_secondaryValueAxis){var h=this.getTopLevelDomains(r);h&&(d={categoryAxis:l_categoryAxis?h.categoryAxis:void 0,valueAxis:l_valueAxis?h.valueAxis:void 0,secondaryValueAxis:l_secondaryValueAxis?h.secondaryValueAxis:void 0})}this.axesDomains=d;var v=null===(e=t.getData())||void 0===e?void 0:e.axesData,y=v&&!v.valueAxis.sharedAxis,f={categoryAxis:u.categoryAxis&&(!d||_.isEmpty(d.categoryAxis)),valueAxis:u.valueAxis&&(!d||_.isEmpty(d.valueAxis)||y),secondaryValueAxis:u.secondaryValueAxis&&(!d||_.isEmpty(d.secondaryValueAxis))};return _.every(f,function(p){return!p})?void 0:f},i.prototype.isSmallMultiples=function(e){return!(!e&&!this.updateOptions)&&Hr(e=e||this.updateOptions.dataViews)},i.prototype.clearSelection=function(e){this.getMultiples(!0).forEach(function(t){return t.clearSelection()}),this.executeActionForMultiplesInRange(function(t){return t.updateLayers()},e,!1)},i.prototype.checkIfNoLabelsCanBeRendered=function(){return _.every(this.getMultiples(),function(e){return e.isVisible()&&e.getRenderer().noLabelsCanBeRendered})},i.prototype.scrollTo=function(e,t){this.executeActionForMultiplesInRange(function(a){return a.getRenderer().axesRenderer.scrollTo(e)},t,!1)},i.prototype.shouldScrollTo=function(e,t){return!!this.getValueForFirstMultipleInRange(function(a){return a.getRenderer().axesRenderer.shouldScrollTo(e)},t,!1)},i.prototype.scrollBy=function(e,t){this.executeActionForMultiplesInRange(function(a){return a.getRenderer().axesRenderer.scrollBy(e)},t,!1)},i.prototype.scrollDelta=function(e,t){this.executeActionForMultiplesInRange(function(a){return a.getRenderer().axesRenderer.scrollDelta(e)},t,!1)},i.prototype.clearRenderingTimeout=function(){this.getMultiples().forEach(function(e){return e.isVisible()&&e.getRenderer().axesRenderer.clearRenderingTimeout()})},i.prototype.updateScrollbarExtent=function(e,t){this.executeActionForMultiplesInRange(function(a){return a.getRenderer().axesRenderer.setExtent(e)},t,!1)},i.prototype.executeActionForMultiplesInRange=function(e,t,a){var r=this.getMultiples(a,t);_.isEmpty(r)||r.forEach(function(n){return e(n)})},i.prototype.getValueForFirstMultipleInRange=function(e,t,a){var r=this.getMultiples(a,t);if(!_.isEmpty(r))return e(r[0])},i.prototype.getFrameCount=function(){return this.isSmallMultiples()?this.reader.getFrameCount():1},i.prototype.updateGlobalAxesDomains=function(e){var t=this.axesDomains=this.axesDomains||{};e.categoryAxis&&(t.categoryAxis=ii(t.categoryAxis||Ga,e.categoryAxis)),e.valueAxis&&(t.valueAxis=ii(t.valueAxis||Ga,e.valueAxis)),e.secondaryValueAxis&&(t.secondaryValueAxis=ii(t.secondaryValueAxis||Ga,e.secondaryValueAxis))},i.prototype.getTopLevelDomains=function(e){var t=this.reader;k.fF.assertValue(t,"this.reader");var o,l,u,a=e.categoryAxis,r=e.valueAxis,n=e.secondaryValueAxis,s=function(y){var f=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(var p in y)for(var m=function(T){var P=T.min,D=T.max;if(!(_.isDate(P)||_.isNumber(P)&&isFinite(P))||!(_.isDate(D)||_.isNumber(D)&&isFinite(D)))return"continue";k.fF.assert(function(){return!_.isDate(P)||(0,nn.M4)(P)},"If min is a date, it should implement DateWithEpochValue"),k.fF.assert(function(){return!_.isDate(D)||(0,nn.M4)(D)},"If max is a date, it should implement DateWithEpochValue"),(0,nn.M4)(P)&&(0,nn.M4)(D)&&(P=P.epochTimeStamp,D=D.epochTimeStamp),f=ii(f,[+P,+D])},b=0,x=y[p];b<x.length;b++)m(x[b]);return f};if(2&a.supportedDomainAggregates){var c=t.getTopLevelAggregates(a.domainAggregateRoles);o=c?s(c):void 0}if(2&r.supportedDomainAggregates){var d=t.getTopLevelAggregates(r.domainAggregateRoles);l=d?s(d):void 0}if(n&&2&n.supportedDomainAggregates){var h=n&&t.getTopLevelAggregates(n.domainAggregateRoles);u=h?s(h):void 0}return o||l||u?{categoryAxis:o,valueAxis:l,secondaryValueAxis:u}:void 0},i.prototype.getMultiples=function(e,t){void 0===e&&(e=!1);var a=[],r=this.isSmallMultiples();if(!r||e){var n=this.getCoreMultiple();n&&a.push(n)}if(r){var s=this.multiples;t&&(s=s.slice(t.startIndex,Math.min(t.endIndex,s.length))),a.push.apply(a,s)}return a},i}(),Fa=R(30053),fp_size=[{breakpoint:240,maxSizePt:9},{breakpoint:320,maxSizePt:12},{breakpoint:460,maxSizePt:16},{breakpoint:540,maxSizePt:24}],Dr=function(){function i(){this.lastViewportSeen=void 0,this.lastResolvedFontSizePt=void 0}return i.prototype.adjustFontSize=function(e,t){var a=this.resolveMaxFontSizePtForViewport(e);return a>=t.size.pt?t:this.copyWithNewFontSize(t,a)},i.prototype.getFontSizeSeriesLabelWarning=function(e,t){var a=this.getFontSizeLabelWarning(e.dataLabelsSettings,t.dataLabelsSettings);if(a)return a;if(e.series&&t.series){k.fF.assert(function(){return e.series.length===t.series.length},"Series are expected to be equal");for(var r=e.series,n=t.series,s=0;s<r.length;s++)if(a=this.getFontSizeLabelWarning(r[s].labelSettings,n[s].labelSettings))return a}},i.prototype.getFontSizeLabelWarning=function(e,t){if(e&&t){if(!_.isEqual(e.fontProperties.size,t.fontProperties.size))return{selector:null,warnings:[new Ue.er]};k.fF.assert(function(){return e.labelOverflow===t.labelOverflow},"Overflow switch should remain as is if no changes in label font size")}else k.fF.assert(function(){return e===t},"It's expected that both settings would be undefined / null")},i.prototype.resolveMaxFontSizePtForViewport=function(e){if(this.lastViewportSeen===e)return this.lastResolvedFontSizePt;for(var t=Bi.PR,a=0,r=fp_size;a<r.length;a++){var n=r[a];if(e.height<n.breakpoint||e.width<n.breakpoint){t=n.maxSizePt;break}}return this.lastViewportSeen=e,this.lastResolvedFontSizePt=t,t},i.prototype.copyWithNewFontSize=function(e,t){var a=Na.B.createFromPt(t);return(0,We.ED)(e,{size:a})},i}(),pp=function(){function i(e){this.responsiveFontHelper=new Dr,this.originalData=e.data,this.dataView=e.dataView,this.viewport=e.viewport}return i.prototype.getData=function(){var t,e=this.originalData;return t=Fa.a.shouldApplyResponsiveChanges(this.dataView,N.p)?this.applyResponsiveChanges(this.viewport,e):e,this.currentData=t,t},i.prototype.getCartesianChartLayerType=function(){return 4},i.prototype.addWarnings=function(e){var t=this.originalData,a=this.currentData;if(t&&a){var r=this.responsiveFontHelper.getFontSizeSeriesLabelWarning(t,a),n=this.responsiveFontHelper.getFontSizeLabelWarning(t.totalLabelsSettings,a.totalLabelsSettings);r&&e.addForVisualObject("labels",r),n&&e.addForVisualObject("totals",n)}},i.prototype.applyResponsiveChanges=function(e,t){var a=(0,be.ED)(t);return this.applyDataLabelFontSizesChanges(e,a),this.applySeriesDataLabelFontSizeChanges(e,a),this.applyTotalLabelFontSizesChanges(e,a),a},i.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=(0,be.ED)(t.dataLabelsSettings),this.updateLabelSettings(e,t.dataLabelsSettings)},i.prototype.applySeriesDataLabelFontSizeChanges=function(e,t){for(var a=t.series=(0,be.ED)(t.series),r=0;r<a.length;r++)if(a[r].labelSettings){var n=a[r]=(0,be.ED)(a[r]);n.labelSettings=(0,be.ED)(n.labelSettings),this.updateLabelSettings(e,n.labelSettings)}},i.prototype.applyTotalLabelFontSizesChanges=function(e,t){t.totalLabelsSettings&&(t.totalLabelsSettings=(0,be.ED)(t.totalLabelsSettings),this.updateLabelSettings(e,t.totalLabelsSettings))},i.prototype.updateLabelSettings=function(e,t){var a=t.fontProperties;t.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.fontProperties),a!==t.fontProperties&&(t.labelOverflow=!0)},i}(),gp=function(){function i(e){this.responsiveFontHelper=new Dr,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}return i.prototype.getData=function(){var t,e=this.originalData;return t=Fa.a.shouldApplyResponsiveChanges(this.dataView,N.p)?this.applyResponsiveChanges(this.viewport,e):e,this.currentData=t,t},i.prototype.getCartesianChartLayerType=function(){return 0},i.prototype.addWarnings=function(e){var t=this.originalData,a=this.currentData;if(t&&a){var r=this.responsiveFontHelper.getFontSizeSeriesLabelWarning(t,a),n=this.responsiveFontHelper.getFontSizeLabelWarning(t.totalLabelsSettings,a.totalLabelsSettings);r&&e.addForVisualObject("labels",r),n&&e.addForVisualObject("totals",n)}},i.prototype.applyResponsiveChanges=function(e,t){var a=(0,be.ED)(t);return this.applyDataLabelFontSizesChanges(e,a),this.applySeriesDataLabelFontSizeChanges(e,a),this.applyTotalLabelFontSizesChanges(e,a),a},i.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=(0,be.ED)(t.dataLabelsSettings),this.updateLabelSettings(e,t.dataLabelsSettings)},i.prototype.applySeriesDataLabelFontSizeChanges=function(e,t){for(var a=t.series=(0,be.ED)(t.series),r=0;r<a.length;r++)if(a[r].labelSettings){var n=a[r]=(0,be.ED)(a[r]);n.labelSettings=(0,be.ED)(n.labelSettings),this.updateLabelSettings(e,n.labelSettings)}},i.prototype.applyTotalLabelFontSizesChanges=function(e,t){t.totalLabelsSettings&&(t.totalLabelsSettings=(0,be.ED)(t.totalLabelsSettings),this.updateLabelSettings(e,t.totalLabelsSettings))},i.prototype.updateLabelSettings=function(e,t){t.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.fontProperties)},i}(),yp=function(){function i(e){this.responsiveFontHelper=new Dr,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}return i.prototype.getData=function(){var t,e=this.originalData;return t=Fa.a.shouldApplyResponsiveChanges(this.dataView,N.p)?this.applyResponsiveChanges(this.viewport,e):e,this.currentData=t,t},i.prototype.getCartesianChartLayerType=function(){return 2},i.prototype.addWarnings=function(e){var t=this.originalData,a=this.currentData;if(t&&a){var r=this.responsiveFontHelper.getFontSizeLabelWarning(t.dataLabelsSettings,a.dataLabelsSettings);r&&e.addForVisualObject("categoryLabels",r)}},i.prototype.applyResponsiveChanges=function(e,t){var a=(0,be.ED)(t);return this.applyDataLabelFontSizesChanges(e,a),a},i.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=(0,be.ED)(t.dataLabelsSettings),t.dataLabelsSettings.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.dataLabelsSettings.fontProperties)},i}(),mp=function(){function i(e){this.responsiveFontHelper=new Dr,this.originalData=e.data,this.viewport=e.viewport,this.dataView=e.dataView}return i.prototype.getData=function(){var t,e=this.originalData;return t=Fa.a.shouldApplyResponsiveChanges(this.dataView,N.p)?this.applyResponsiveChanges(this.viewport,e):e,this.currentData=t,t},i.prototype.getCartesianChartLayerType=function(){return 3},i.prototype.addWarnings=function(e){var t=this.originalData,a=this.currentData;if(t&&a){var r=this.responsiveFontHelper.getFontSizeLabelWarning(t.dataLabelsSettings,a.dataLabelsSettings);r&&e.addForVisualObject("labels",r)}},i.prototype.applyResponsiveChanges=function(e,t){var a=(0,be.ED)(t);return this.applyDataLabelFontSizesChanges(e,a),a},i.prototype.applyDataLabelFontSizesChanges=function(e,t){t.dataLabelsSettings=(0,be.ED)(t.dataLabelsSettings),t.dataLabelsSettings.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.dataLabelsSettings.fontProperties)},i}(),Sp=function(){function i(e,t){switch(this.layerType=e,e){case 4:this.adapter=new pp(t);break;case 0:this.adapter=new gp(t);break;case 2:this.adapter=new yp(t);break;case 3:this.adapter=new mp(t);break;default:k.fF.assertFail("Unsupported chart type for view model adapter")}}return i.prototype.getData=function(){return this.adapter.getData()},i.prototype.getCartesianChartLayerType=function(){return this.layerType},i.prototype.addWarnings=function(e){return this.adapter.addWarnings(e)},i}(),Ac=R(70700),oi_legendWidth=76,oi_legendHeight=58,oi_axesTitleWidth=128,oi_axesTitleHeight=58,oi_axesHeight=58,oi_axesMedWidth=128,oi_axesWidth=76,oi_maxWidthForMediumFont=180,oi_maxWidthForSmallFont=128;function wc(i,e){var t=i.warningObjectCollection,a={},r=i.legendData,n=e.legendData;if(i.showIcon)a.legend=new Ue.ni,a.categoryAxis=new Ue.Mk,a.valueAxis=new Ue.Mk;else{r.show!==n.show?a.legend=new Ue.ni:r.position!==n.position?a.legend=new Ue.TS:_.isEqual(r.fontProperties.size,n.fontProperties.size)||(a.legend=new Ue.p7("fontSize"));var s=i.axesData,o=e.axesData,l=s.categoryAxis,u=o.categoryAxis,c=!_.isEqual(l.labelFontProperties.size,u.labelFontProperties.size),d=!_.isEqual(l.titleFontProperties.size,u.titleFontProperties.size);l.show!==u.show?a.categoryAxis=new Ue.Mk:l.showAxisTitle!==u.showAxisTitle?a.categoryAxis=new Ue.fk:(c||d)&&(a.categoryAxis=new Ue.Dr(c?"fontSize":"titleFontSize"));var h=s.valueAxis,v=o.valueAxis,y=!_.isEqual(h.labelFontProperties.size,v.labelFontProperties.size),f=!_.isEqual(h.titleFontProperties.size,v.titleFontProperties.size);h.show!==v.show?a.valueAxis=new Ue.Mk:h.showAxisTitle!==v.showAxisTitle?a.valueAxis=new Ue.fk:(y||f)&&(a.valueAxis=new Ue.Dr(y?"fontSize":"titleFontSize"));var p=i.zoomData,S=e.zoomData;(p.showOnCategoryAxis!==S.showOnCategoryAxis||p.showOnValueAxis!==S.showOnValueAxis||p.showOnValueSecAxis!==S.showOnValueSecAxis)&&(a.zoom=new Ue.JG)}for(var m in a)t.addForVisualObject(m,{selector:null,warnings:[a[m]]})}var Ap=function(){function i(e){this.viewport=e.viewport,this.cartesianData=e.cartesianData,this.dataView=e.dataView,this.responsiveFontHelper=new Dr}return i.prototype.getData=function(){var e=Fa.a.getResponsiveVisualProperties(this.dataView,N.p),t=e.responsive,a=e.responsiveLegacy,r=this.cartesianData;return(t||a)&&(r=this.createResponsiveData(t,a)),r},i.prototype.getResponsiveSlice=function(e,t){var a=N.p.general,r=Fa.a.getResponsiveVisualProperties(e,N.p);return{item:new F.vi({uidBuilder:new F.IN(new F.SS(new F.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new F.bd({descriptor:a.responsive,value:r.responsive}).build(),localize:t}).build(),revertToDefaultDescriptors:[a.responsive]}},i.prototype.createResponsiveData=function(e,t){var a=Fa.a.cloneData(this.cartesianData);return e?(this.applyIconResponsiveChanges(a),this.applyLegendResponsiveChanges(this.viewport,a.legendData.position,a),this.applyAxesResponsiveChanges(this.viewport,a),this.applyZoomSliderResponsiveChanges(this.viewport,a),this.applyFontSizesChanges(this.viewport,a),a.scrollbarOptions=i.ScrollbarOptions):t&&function(i,e){(function(i,e){var t=e.axesData;if(i.height<=oi_axesTitleHeight&&(t.x.showAxisTitle=!1,t.y.showAxisTitle=!1,t.y2.showAxisTitle=!1),i.width<=oi_axesTitleWidth&&(t.y.showAxisTitle=!1,t.y2.showAxisTitle=!1),i.height<=oi_axesHeight&&(t.x.show=!1),i.width<=oi_axesWidth&&(t.y.show=!1,t.y2.show=!1),i.width<=oi_axesMedWidth&&(0,ri.cB)(e.legendData.position)&&(t.y.show=!1,t.y2.show=!1),i.width<=oi_maxWidthForMediumFont){var a={x:{tickLabels:9,title:9},y:{tickLabels:11,title:11},y2:{tickLabels:11,title:11}};i.width<=oi_maxWidthForSmallFont&&(a.y.tickLabels=9,a.y.title=9,a.y2.tickLabels=9,a.y2.title=9),t.x.titleFontProperties=(0,We.ED)(t.x.titleFontProperties,{size:Na.B.createFromPx(a.x.title)}),t.y.titleFontProperties=(0,We.ED)(t.y.titleFontProperties,{size:Na.B.createFromPx(a.y.title)}),t.y2.titleFontProperties=(0,We.ED)(t.y2.titleFontProperties,{size:Na.B.createFromPx(a.y2.title)}),t.x.labelFontProperties=(0,We.ED)(t.x.labelFontProperties,{size:Na.B.createFromPx(a.x.tickLabels)}),t.y.labelFontProperties=(0,We.ED)(t.y.labelFontProperties,{size:Na.B.createFromPx(a.y.tickLabels)}),t.y2.labelFontProperties=(0,We.ED)(t.y2.labelFontProperties,{size:Na.B.createFromPx(a.y2.tickLabels)})}})(i,e),function(i,e){var t=e.legendData.position,a=i.width<=oi_legendWidth&&(0,ri.cB)(t),r=i.height<=oi_legendHeight&&(0,ri.s0)(t);if((a||r)&&(e.legendData.show=!1),i.width<=oi_maxWidthForMediumFont){var s,n=e.legendData.fontProperties.size.pt;s=i.width<=oi_maxWidthForSmallFont?Math.min(n,ke.hD):Math.min(n,ke.vs),e.legendData.fontProperties=(0,We.ED)(e.legendData.fontProperties,{size:Na.B.createFromPt(s)})}}(i,e)}(this.viewport,a),wc(a,this.cartesianData),a},i.prototype.applyIconResponsiveChanges=function(e){e.showIcon=this.viewport.height<=50||this.viewport.width<=50},i.prototype.applyLegendResponsiveChanges=function(e,t,a){(e.width<210||e.height<100)&&(0,ri.cB)(t)&&(a.legendData.position=Ac.tV.Top),(e.height<70||e.width<80)&&(a.legendData.show=!1),a.legendData.useLargeArrowHitArea=!0},i.prototype.applyAxesResponsiveChanges=function(e,t){e.height<100&&(t.axesData.x.show=!1),e.width<210&&(t.axesData.y.showAxisTitle=!1,t.axesData.y2.showAxisTitle=!1),e.width<100&&(t.axesData.y.show=!1,t.axesData.y2.show=!1),e.height<145&&(t.axesData.x.showAxisTitle=!1)},i.prototype.applyZoomSliderResponsiveChanges=function(e,t){(e.height<150||e.width<280)&&(t.zoomData.showOnCategoryAxis=!1,t.zoomData.showOnValueAxis=!1,t.zoomData.showOnValueSecAxis=!1)},i.prototype.applyFontSizesChanges=function(e,t){t.legendData&&t.legendData.fontProperties&&(t.legendData.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.legendData.fontProperties));var a=t.axesData;a.x.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.x.labelFontProperties),a.x.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.x.titleFontProperties),a.y.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y.labelFontProperties),a.y.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y.titleFontProperties),a.y2.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y2.labelFontProperties),a.y2.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y2.titleFontProperties)},i.ScrollbarOptions={scrollbarWidth:8,scrollbarRadius:4,scrollbarClass:"responsive"},i}(),Dp=function(){function i(e,t){this.smallMultiplesOptions=t,this.cartesianData=e.cartesianData,this.dataView=e.dataView,this.isCoreMultiple=e.isCoreMultiple,this.responsiveFontHelper=new Dr}return i.prototype.getData=function(){var e=this.cartesianData;return this.smallMultiplesOptions.isSmallMultiples?(Fa.a.getResponsiveVisualProperties(this.dataView,N.p).responsive&&(e=this.applyResponsiveChanges(this.cartesianData,this.smallMultiplesOptions)),e):(k.fF.assertFail("Adapter does not support non-small multiples"),e)},i.prototype.getResponsiveSlice=function(e,t){},i.prototype.applyResponsiveChanges=function(e,t){var a=Fa.a.cloneData(e),r=function(i){var e=i.columns,t=i.rows;return{legendPositionHeight:120+30*t,legendPositionWidth:210+40*e,legendShowHeight:90+30*t,legendShowWidth:90+40*e,removeXAxisTitleHeight:165+30*t,removeXAxisHeight:120+30*t,removeYAxisTitleWidth:210+40*e,removeYAxisWidth:120+40*e}}(t),n=t.viewport;return this.applyAxesResponsiveChanges(r,n,a),this.applyLegendResponsiveChanges(r,n,a),this.applyFontSizeResponsiveChanges(n,a),this.isCoreMultiple&&wc(a,e),a},i.prototype.applyAxesResponsiveChanges=function(e,t,a){var r=t.height,n=t.width;r<e.removeXAxisTitleHeight&&(a.axesData.x.showAxisTitle=!1),r<e.removeXAxisHeight&&(a.axesData.x.show=!1,a.axesData.x.showAxisTitle=!1),n<e.removeYAxisTitleWidth&&(a.axesData.y.showAxisTitle=!1,a.axesData.y2.showAxisTitle=!1),n<e.removeYAxisWidth&&(a.axesData.y.show=!1,a.axesData.y2.show=!1,a.axesData.y.showAxisTitle=!1,a.axesData.y2.showAxisTitle=!1)},i.prototype.applyLegendResponsiveChanges=function(e,t,a){if(a.legendData.show){var n=t.height,s=t.width;(n<e.legendPositionHeight||s<e.legendPositionWidth)&&(0,ri.cB)(a.legendData.position)&&(a.legendData.position=Ac.tV.Top),(n<e.legendShowHeight||s<e.legendShowWidth)&&(a.legendData.show=!1),a.legendData.useLargeArrowHitArea=!0}},i.prototype.applyFontSizeResponsiveChanges=function(e,t){t.legendData&&t.legendData.fontProperties&&(t.legendData.fontProperties=this.responsiveFontHelper.adjustFontSize(e,t.legendData.fontProperties));var a=t.axesData;a.x.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.x.labelFontProperties),a.x.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.x.titleFontProperties),a.y.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y.labelFontProperties),a.y.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y.titleFontProperties),a.y2.labelFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y2.labelFontProperties),a.y2.titleFontProperties=this.responsiveFontHelper.adjustFontSize(e,a.y2.titleFontProperties)},i}(),Lp=function(){function i(e,t){this.layerType=e,this.layerData=t.data}return i.prototype.getData=function(){return this.layerData},i.prototype.getCartesianChartLayerType=function(){return this.layerType},i.prototype.addWarnings=function(e){},i}(),ar=120;function fn(i,e,t){return k.fF.assert(function(){return i[0]>=i[1]},"breakpoints must be [max, min]"),k.fF.assert(function(){return e[0]>=e[1]},"outputRange must be [max, min]"),d3.scaleLinear().range(e).domain(i).clamp(!0)(t)}function Pc(i){var e=i.rowCount,t=i.columnCount;return{showIconHeight:30*t,showIconWidth:40*e,showSubheaderHeight:80+50*e,gridlineRowUpperBreakpoint:ar+52*e,gridlineRowLowerBreakpoint:ar+32*e,gridlineColumnUpperBreakpoint:ar+62*t,gridlineColumnLowerBreakpoint:ar+42*t,removeGridLineHeight:32*e,removeGridLineWidth:42*t,paddingRowUpperBreakpoint:ar+130*e,paddingRowLowerBreakpoint:ar+30*e,paddingColumnUpperBreakpoint:ar+140*t,paddingColumnLowerBreakpoint:ar+40*t}}var Np=function(){function i(e){this.multiplesLayout=e.multiplesLayout,this.multiplesSubheader=e.multiplesSubheader,this.dataView=e.dataView,this.viewport=e.viewport,this.responsiveFontHelper=new Dr}return i.prototype.getMultiplesLayout=function(e){var t=this.multiplesLayout;return Fa.a.getResponsiveVisualProperties(this.dataView,N.p).responsive&&(t=this.applyResponsiveChanges(this.viewport,this.multiplesLayout,e)),t},i.prototype.getMultiplesSubheader=function(e){var t=this.multiplesSubheader;return Fa.a.getResponsiveVisualProperties(this.dataView,N.p).responsive&&(t=this.applySubheaderResponsiveChanges(this.viewport,t,e)),t},i.prototype.getResponsiveSlice=function(e,t){var a=N.p.general,r=Fa.a.getResponsiveVisualProperties(e,N.p);return{item:new F.vi({uidBuilder:new F.IN(new F.SS(new F.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new F.bd({descriptor:a.responsive,value:r.responsive}).build(),localize:t}).build(),revertToDefaultDescriptors:[a.responsive]}},i.prototype.applyResponsiveChanges=function(e,t,a){var r=Fa.a.cloneData(t),n=Pc(r);return this.applyIconResponsiveChanges(n,e,r),this.applyGridlinesResponsiveChanges(n,e,r),this.applyPaddingResponsiveChanges(n,e,r),this.updateResponsiveWarnings(r,t,a),r},i.prototype.applyIconResponsiveChanges=function(e,t,a){(t.height<e.showIconHeight||t.width<e.showIconWidth)&&(a.showIcon=!0)},i.prototype.applyGridlinesResponsiveChanges=function(e,t,a){var r=a.gridline;if(null!=r?.strokeWidth){var n=r.strokeWidth,s=r.strokeWidth;if(t.height<e.removeGridLineHeight||t.width<e.removeGridLineWidth)return void(r.strokeWidth=0);if(t.height<=e.gridlineRowLowerBreakpoint||t.width<=e.gridlineColumnLowerBreakpoint)return void(r.strokeWidth=1);t.height<e.gridlineRowUpperBreakpoint&&(s=Math.ceil(fn([e.gridlineRowUpperBreakpoint,e.gridlineRowLowerBreakpoint],[r.strokeWidth,1],t.height))),t.width<e.gridlineColumnUpperBreakpoint&&(n=Math.ceil(fn([e.gridlineColumnUpperBreakpoint,e.gridlineColumnLowerBreakpoint],[r.strokeWidth,1],t.width))),r.strokeWidth=Math.min(n,s)}},i.prototype.applyPaddingResponsiveChanges=function(e,t,a){if(a.advancedPaddingOptions||0!==a.gridPadding){if(t.height<e.paddingRowUpperBreakpoint){var r=[e.paddingRowUpperBreakpoint,e.paddingRowLowerBreakpoint];a.rowPaddingOuter=a.rowPaddingOuter&&Math.ceil(fn(r,[a.rowPaddingOuter,1],t.height)),a.rowPaddingInner=a.rowPaddingInner&&Math.ceil(fn(r,[a.rowPaddingInner,1],t.height))}t.width<e.paddingColumnUpperBreakpoint&&(r=[e.paddingColumnUpperBreakpoint,e.paddingColumnLowerBreakpoint],a.columnPaddingOuter=a.columnPaddingOuter&&Math.ceil(fn(r,[a.columnPaddingOuter,1],t.width)),a.columnPaddingInner=a.columnPaddingInner&&Math.ceil(fn(r,[a.columnPaddingInner,1],t.width)))}},i.prototype.applySubheaderResponsiveChanges=function(e,t,a){var r=Fa.a.cloneData(t),n=Pc(this.multiplesLayout);return e.height<n.showSubheaderHeight&&(r.show=!1),r.show&&r.fontProperties&&(r.fontProperties=this.responsiveFontHelper.adjustFontSize(e,r.fontProperties),r.height=r.fontProperties.size.px+r.margins.top+r.margins.bottom),this.updateSubheaderResponsiveWarnings(r,t,a),r},i.prototype.updateResponsiveWarnings=function(e,t,a){var r,n,s=a,o={};for(var l in e.showIcon?o.subheader=new Ue.lC:((e.rowPaddingInner!==t.rowPaddingInner||e.rowPaddingOuter!==t.rowPaddingOuter||e.columnPaddingInner!==t.columnPaddingInner||e.columnPaddingOuter!==t.columnPaddingOuter)&&(o.smallMultiplesLayout=new Ue.e),(null===(r=e.gridline)||void 0===r?void 0:r.strokeWidth)!==(null===(n=t.gridline)||void 0===n?void 0:n.strokeWidth)&&(o.smallMultiplesLayout=new Ue.IX)),o)s.addForVisualObject(l,{selector:null,warnings:[o[l]]})},i.prototype.updateSubheaderResponsiveWarnings=function(e,t,a){var r=a,n={};for(var s in e.show!==t.show&&(n.subheader=new Ue.lC),_.isEqual(e.fontProperties.size,t.fontProperties.size)||(n.subheader=new Ue.W0),n)r.addForVisualObject(s,{selector:null,warnings:[n[s]]})},i}(),Rp=function(){function i(){}return i.prototype.createCartesianAdapter=function(e){return this.isSmallMultiples()?new Dp(e,this.smallMultiplesOptions):new Ap(e)},i.prototype.createLayerAdapter=function(e,t){return this.isSmallMultiples()?new Lp(e,t):new Sp(e,t)},i.prototype.setSmallMultiplesOptions=function(e){this.smallMultiplesOptions=e},i.prototype.createSmallMultiplesAdapter=function(e){if(this.isSmallMultiples())return new Np(e);k.fF.assertFail("Can not get SmallMultiplesAdapter for non-small multiples")},i.prototype.isSmallMultiples=function(){return this.smallMultiplesOptions&&this.smallMultiplesOptions.isSmallMultiples},i}(),Ip=function(){function i(e){var a,t=this;this.options=e,k.fF.assertValue(e,"CartesianConstructorOptions"),this.axes=new Ki(null!==(a=e.isScrollable)&&void 0!==a&&a,ks.ScrollbarWidth,this.trimOrdinalDataOnOverflow),this.viewModelAdapterFactory=new Rp,this.layoutBuilder=new ah(e,this.axes,function(){return t.isPlayAxis()},function(){return t.smallMultiplesViewModelAdapter}),this.multiples=new vp(this.chartType,this.featureSwitches,function(){return function(i){switch(i.chartType){case 1:case 0:case 2:case 3:return[Cc(i)];case 15:return[new ef((0,g.__assign)((0,g.__assign)({},i),{isScrollable:!1}))];case 11:return[new Vf((0,g.__assign)((0,g.__assign)({},i),{viewModelAdapterFactory:qs(i,2)}))];case 12:return[new ap((0,g.__assign)((0,g.__assign)({},i),{viewModelAdapterFactory:qs(i,3)}))];case 5:case 4:case 9:case 7:case 6:case 8:case 10:return[xc(i)];case 13:case 14:return[xc(i),Cc(i)];default:return k.fF.assertFail("Unknown CartesianChartType enum value"),[]}}((0,g.__assign)((0,g.__assign)({},t.options),{viewModelAdapterFactory:t.viewModelAdapterFactory,interactivityService:t.interactivityService}))},function(r){return t.getLayerRendererInitOptions(r)})}return Object.defineProperty(i.prototype,"featureSwitches",{get:function(){return this.options.featureSwitches||{}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"chartType",{get:function(){return this.options.chartType},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trimOrdinalDataOnOverflow",{get:function(){var t;return null===(t=this.options.trimOrdinalDataOnOverflow)||void 0===t||t},enumerable:!1,configurable:!0}),i.prototype.init=function(e){var a,t=this;k.fF.assertValue(e,"CartesianChart.init(options)"),this.visualInitOptions=e;var r=e.element;this.currentViewport=e.viewport,this.hostServices=e.host,this.eventManager=new Sn.B(d3.select(r.get(0))),this.categoryLoadMoreDataHandler=new kc(null,this.hostServices),this.options.behaviorFactory&&(this.interactivityService=(0,Y.ub)(this.hostServices,this.featureSwitches)),this.tooltipService=(0,zt.r)(e.host);var n=this.visualInitOptions.style,s=(0,be.ED)(n);s.colorPalette=(0,be.ED)(n.colorPalette),s.colorPalette.dataColors=new Tc(n.colorPalette.dataColors),this.layerStyle=s;var o=new Ps({style:n,chartType:this.chartType});this.axisZoom=new Vl(r,this.hostServices,this.axes.isScrollable&&!!e.interactivity,this.featureSwitches),this.axes.init({axesData:o,axisZoom:this.axisZoom,interactivityService:this.interactivityService}),this.legend=(0,ke.OG)(r,e.interactivity&&e.interactivity.mobileTileInteractive,12!==this.chartType?this.interactivityService:void 0,this.axes.isScrollable,void 0,n,this.hostServices);var l=(0,be.ED)(e);if(l.style=s,l.services={tooltips:this.tooltipService},this.multiples.init(l,this.interactivityService),this.layoutBuilder.init(e,this.tooltipService,this.legend,o,this.interactivityService,this.layerStyle,this.multiples.rowLoadMoreDataHandler,this.eventManager),this.layout=this.layoutBuilder.create(this.visualInitOptions.element),this.isMobileChart=e.interactivity&&e.interactivity.mobileTileInteractive,this.featureSwitches.onObject){var c=(null===(a=this.hostServices)||void 0===a?void 0:a.getSubSelectionService())??te.D.createWithDefaultHost();this.subSelectionHelper=U.O5.createHtmlSubselectionHelper({hostElement:r.get(0),hostServices:this.hostServices,renderer:c,targetSource:"format",scale:function(){return t.currentViewport.scale},selectorCallback:function(h){return t.getSelectorsByColumnSubSelection(h)},customOutlineCallback:function(h){return t.getSubSelectionCustomOutlines(h)},customElementCallback:function(h){return t.getSubSelectionCustomElements(h)},subSelectionMetadataCallback:function(h){return t.getSubSelectionMetadata(h)}}),this.interactivityService.setSubSelectionHelper(this.subSelectionHelper)}},i.prototype.isPlayAxis=function(){return!(!this.dataViews||!this.dataViews[0])&&11===this.chartType&&(this.options.animator||this.isMobileChart)&&(0,Dt.c5)(this.dataViews[0],"Play")},i.prototype.is100Stacked=function(){return 8===this.chartType||9===this.chartType||3===this.chartType},i.prototype.updateInternal=function(e,t){var a;return(0,g.__awaiter)(this,void 0,void 0,function(){var r,n,s,o,l,u,c,d,h,v,p,S,m,b,C,A,T,P;return(0,g.__generator)(this,function(D){switch(D.label){case 0:return r=this.dataViews=e.dataViews,n=this.featureSwitches.onObject&&e.formatMode,s=e.operationKind===Wa.su.Append||null!=e.resizeMode||n,this.currentViewport=e.viewport,r?(l=this.multiples.isSmallMultiples(r),(u=l&&r[0])?(h=Xi(c=u.metadata.objects,d=this.layerStyle),v=kn(c,d),this.viewModelAdapterFactory.setSmallMultiplesOptions({viewport:this.currentViewport,isSmallMultiples:l,columns:h.columnCount,rows:h.rowCount}),this.smallMultiplesViewModelAdapter=this.viewModelAdapterFactory.createSmallMultiplesAdapter({dataView:u,multiplesLayout:h,multiplesSubheader:v,viewport:this.currentViewport})):(this.viewModelAdapterFactory.setSmallMultiplesOptions({viewport:this.currentViewport,isSmallMultiples:l,columns:void 0,rows:void 0}),this.smallMultiplesViewModelAdapter=void 0),l!==this.multiples.isSmallMultiples()&&this.multiples.clear(),null!=t?(p=this.multiples.getCoreMultiple(),S=p.layers,_.isEmpty(r)||(m=Ao(r),this.cartesianVisualCapabilities=i.getCartesianVisualCapabilities(S),l&&this.cartesianVisualCapabilities&&(this.cartesianVisualCapabilities.supportsHierarchicalCategoryAxis=!1),2===(o=this.categoryAxisRenderMode=i.getRenderMode(m,this.cartesianVisualCapabilities))&&(r=r.map(function(L){return(0,G.Zy)(L,N.p.general.formatString,N.x.category)}))),this.multiples.update({dataViews:r,operationKind:t,viewport:this.currentViewport,adapterFactory:this.viewModelAdapterFactory,preserveScrollPosition:s,formatMode:n}),this.cartesianData=this.originalCartesianData=p.getData()):(this.multiples.resize(this.currentViewport),this.cartesianData=this.multiples.getCoreMultiple().getData()),null==t&&this.cartesianData&&this.cartesianData.axesData?this.axes.updateResize(this.cartesianData.axesData,this.cartesianData.scrollbarOptions.scrollbarWidth):null!=t&&(_.isEmpty(r)||((b=r[0]).metadata&&(this.background={image:(0,le.NA)(b.metadata.objects,N.p.plotArea.image),transparency:(0,le.NA)(b.metadata.objects,N.p.plotArea.transparency,(0,Re.x6)())}),this.categoryLoadMoreDataHandler.update(o,l),this.axes.update(b.categorical?b.categorical.categories:null,this.cartesianData.axesData,o,this.cartesianData.scrollbarOptions.scrollbarWidth)),this.categoryLoadMoreDataHandler.onLoadMoreDataCompleted()),this.cartesianData&&this.cartesianData.zoomData&&this.axisZoom.update({dataViews:r,zoomData:this.cartesianData.zoomData,hasSmallMultiples:l,hasScalarCategoryAxis:this.categoryAxisIsScalar().isScalar,hasYAxisCategorical:this.axes.isYAxisCategorical}),[4,this.render(!this.hasSetData||e.suppressAnimations||l,s,e.resizeMode)]):[2];case 1:return D.sent(),this.isDestroyed||(this.hasSetData=this.hasSetData||!_.isEmpty(r),this.updateWarnings(null===(a=this.cartesianData)||void 0===a?void 0:a.warningObjectCollection),C=e.type&Wa.EP.Data||e.type&Wa.EP.ResizeEnd||e.type&Wa.EP.FormattingSubSelectionChange,A=e.type&Wa.EP.FormattingSubSelectionChange,this.subSelectionHelper&&C&&(this.subSelectionHelper.updateOutlinesFromSubSelections(e.subSelections,!0),this.hostServices.alertScreenReader&&A&&(T=this.subSelectionHelper.getLabelsFromSubSelections(e.subSelections,["aria-label"]),(P=T?.length&&T.join(" "))&&this.hostServices.alertScreenReader(P)))),[2]}})})},i.getCartesianVisualCapabilities=function(e){for(var t,a=0,r=e.length;a<r;a++){var s=e[a].getCartesianVisualCapabilities();t?t.supportsHierarchicalCategoryAxis&&(t.supportsHierarchicalCategoryAxis=s.supportsHierarchicalCategoryAxis):t=(0,be.ED)(s)}return t},i.getRenderMode=function(e,t){for(var a,r=0,n=e;r<n.length;r++){var s=n[r];if(null!=s){var o=new pl(s,t?.supportsHierarchicalCategoryAxis).getRenderModes();a=a?_.intersection(a,o):o,k.fF.assert(function(){return!_.isEmpty(a)},"Could not find a valid render mode for all layers")}}return _.head(a)},i.prototype.isSmallMultiples=function(){return Hr(this.dataViews)},i.prototype.showSmallMultiplesCard=function(){return this.isSmallMultiples()},i.prototype.showSubheaderCard=function(){return this.isSmallMultiples()},Object.defineProperty(i.prototype,"hasHierarchicalAxisRenderMode",{get:function(){return 3===this.categoryAxisRenderMode},enumerable:!1,configurable:!0}),i.prototype.render=function(e,t,a){return(0,g.__awaiter)(this,void 0,void 0,function(){return(0,g.__generator)(this,function(r){return[2,this.layout.render(this.multiples,this.currentViewport,this.categoryLoadMoreDataHandler,this.background,this.axisZoom,this.trimOrdinalDataOnOverflow,e,this.hasHierarchicalAxisRenderMode,t,this.formatMode,this.subSelectionHelper,this.isSelected,a)]})})},i.prototype.updateWarnings=function(e){var t,a,r,n,s;if(!_.isEmpty(this.dataViews)&&e){var o=this.dataViews,l=(0,De.b)(o,!1,!1,!1,["Tooltips"],!0);if(_.isEmpty(l)||e.add.apply(e,l||[]),this.axes.addWarnings(e),this.multiples.checkIfNoLabelsCanBeRendered()){var u={selector:null,warnings:[new Ue.we]};e.addForVisualObject("labels",u)}else{e.removeForVisualObject("labels");for(var d=0,h=null===(a=this.multiples.getCoreMultiple())||void 0===a?void 0:a.layers;d<h.length;d++){var v=h[d];null===(r=v.addWarnings)||void 0===r||r.call(v,e)}}for(var y=[],f=null===(n=this.cartesianVisualCapabilities)||void 0===n?void 0:n.supportsHierarchicalCategoryAxis,p=0,S=o;p<S.length;p++)new pl(S[p],f).addObjectWarnings(y);var b=function(C,A){var T=Jr(C);T[0]>=T[1]&&e.addForVisualObject(A,{selector:null,warnings:[new Ue.Dm]})};!(null===(s=this.originalCartesianData)||void 0===s)&&s.axesData&&(b(this.originalCartesianData.axesData.valueAxis,"valueAxis"),b(this.originalCartesianData.axesData.categoryAxis,"categoryAxis"),b(this.originalCartesianData.axesData.secondaryValueAxis,"y2Axis")),_.isEmpty(y)||(t=this.cartesianData.warningObjectCollection).addForVisualObject.apply(t,(0,g.__spreadArray)(["categoryAxis"],y||[],!1)),this.hostServices.setWarnings(this.cartesianData.warningObjectCollection.complete())}},i.prototype.update=function(e){return(0,g.__awaiter)(this,void 0,void 0,function(){return(0,g.__generator)(this,function(t){switch(t.label){case 0:return this.featureSwitches.onObject&&e.formatMode!==this.formatMode&&(this.subSelectionHelper.setFormatMode(e.formatMode),this.interactivityService.setFormatMode(e.formatMode),this.formatMode=e.formatMode),null==e.resizeMode?[3,2]:[4,this.updateInternal(e)];case 1:return t.sent(),[3,4];case 2:return[4,this.updateInternal(e,null!=e.operationKind?e.operationKind:Wa.su.Create)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},i.prototype.destroy=function(){this.isDestroyed=!0,this.multiples&&this.multiples.clear(),this.layout&&this.layout.destroy(),this.axisZoom&&(this.axisZoom.destroy(),this.axisZoom=void 0)},i.prototype.onViewModeChanged=function(e){this.layout.viewMode=e},i.prototype.onSelectionStateChanged=function(e){if(this.isSelected=e,this.cartesianData&&this.multiples&&this.dataViews){var t=!this.hasSetData||this.multiples.isSmallMultiples(this.dataViews);this.render(t,!0)}},i.prototype.scrollTo=function(e){var t=this.layout.getVisibleMultiples();this.multiples.scrollTo(e,t)},i.prototype.scrollRowsTo=function(e){this.layout.scrollRowsTo(e)},i.prototype.isComboChart=function(){return xa(this.chartType)},i.prototype.enumerateObjectInstances=function(e){var t,a=new Te.G,r=this.getLayers();if(e.objectName===he.XC){var n=this.categoryAxisIsScalar().isScalar;if(Rl(this.dataViews,r)&&n){var s=Br(r);this.enumerateReferenceLines(a,e.objectName,s)}}else e.objectName===he.Dk?this.enumerateReferenceLines(a,e.objectName):"referenceLine"===e.objectName?function(i,e,t){return ws(function(a){return!a.isStacked},i,e,void 0)}(this.dataViews,r)&&this.enumerateReferenceLines(a,e.objectName):"trend"===e.objectName&&Il(this.dataViews,r)&&(0,q.md)(a,this.originalCartesianData.trendLines,this.layerStyle);for(var o=0,l=r;o<l.length;o++){var u=l[o];null===(t=u.enumerateObjectInstances)||void 0===t||t.call(u,a,e)}return a.complete()},i.prototype.getSelectorsByColumnSubSelection=function(e){for(var a=0,r=this.getLayers();a<r.length;a++){var n=r[a];if(n.getSelectorsByColumnFromSubselectedElement){var s=n.getSelectorsByColumnFromSubselectedElement(e);if(s)return s}}return{}},i.prototype.getSubSelectionCustomOutlines=function(e){return _d.call(this,e)},i.prototype.getSubSelectionCustomElements=function(e){return Pd.call(this,e)},i.prototype.getSubSelectionMetadata=function(e){return Td.call(this,e)},i.prototype.getSubSelectionStyles=function(e){return kd.call(this,e)},i.prototype.getSubSelectionShortcuts=function(e,t){return Md.call(this,e,t)},i.prototype.getSubSelectables=function(e){return Fd.call(this,e)},i.prototype.getNextSubSelectable=function(e,t){return this.subSelectionHelper.getNextSubSelectable(e,t)},i.prototype.getFormattingModel=function(){return bd.call(this)},i.prototype.resolveFormattingPlaceholder=function(e){if((0,F.n$)(e)){if("responsive"===e.name)return this.getResponsiveSlice();for(var a=0,r=this.getLayers();a<r.length;a++){var n=r[a],s=n.resolveFormattingPlaceholder&&n.resolveFormattingPlaceholder(e);if(s)return s}}},Object.defineProperty(i.prototype,"localizer",{get:function(){var t=this;return function(a){return t.hostServices.getLocalizedString(a)}},enumerable:!1,configurable:!0}),i.prototype.getResponsiveSlice=function(){var e=this.dataViews&&this.dataViews[0];if(e){if(this.smallMultiplesViewModelAdapter)return this.smallMultiplesViewModelAdapter.getResponsiveSlice(e,this.localizer);if(this.viewModelAdapterFactory)return this.viewModelAdapterFactory.createCartesianAdapter({cartesianData:void 0,dataView:e,viewport:void 0,isCoreMultiple:void 0}).getResponsiveSlice(e,this.localizer)}},i.prototype.getTelemetryInformation=function(){var e={};if(this.isSmallMultiples()){var t=Xi(this.dataViews[0].metadata.objects,this.layerStyle);k.fF.assertValue(t,"getTelemetryInformation - NULL layout"),e.smallMultiples={layout:{type:t.layoutType,rows:t.rowCount,columns:t.columnCount}}}for(var a=this.getLayers(),r=0;r<a.length;r++){var n=a[r];if(_.isFunction(n.getTelemetryInformation)){var s=n.getTelemetryInformation();s&&(e[r.toString()]=s)}}if(!_.isEmpty(e))return e},i.prototype.getLayers=function(){var e=this.multiples.getCoreMultiple();return 1&e.getState()?e.layers:[]},i.prototype.enumerateReferenceLines=function(e,t,a){var r,n;if(null!==(r=this.originalCartesianData)&&void 0!==r&&r.referenceLines&&null!==(n=this.originalCartesianData)&&void 0!==n&&n.axesData){var s=J.v.getDataColorByIndex(this.layerStyle,0,yt.fA),o=_.filter(this.originalCartesianData.referenceLines,function(l){return l.type===t});(0,he.Dr)(e,o,s,t,this.originalCartesianData.axesData.isValueAxisIrregular,a)}},i.prototype.shouldShowLegendCard=function(){var e,t;if(_.isEmpty(this.dataViews)||null===(e=this.cartesianData)||void 0===e||!e.legendData)return!1;if(this.cartesianData.legendData.isGradientLegend)return!0;var a=null===(t=this.multiples.getCoreMultiple())||void 0===t?void 0:t.layers;if(a&&this.dataViews)for(var r=a.length,n=0,s=0;s<r;s++){if(a[s].hasLegend())return!0;var o=this.dataViews[s];if(o&&o.categorical&&o.categorical.values&&o.categorical.values.length>0&&++n>1)return!0}return!1},i.prototype.isLogAxisScaleAllowed=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var a=this.axes.isYAxisCategorical;return this.axes.isLogScaleAllowed(e?a?0:t?2:1:a?1:0)},i.prototype.categoryAxisIsScalar=function(){var e;if(!this.originalCartesianData)return{isScalar:void 0,supportedType:void 0};var t=this.originalCartesianData.axesData.categoryAxis,a=this.hasHierarchicalAxisRenderMode?ht.w.categorical:ht.w.both,r=!1,n=null===(e=this.multiples.getCoreMultiple())||void 0===e?void 0:e.layers;return a===ht.w.both&&n&&n[0].getSupportedCategoryAxisType&&((a=n[0].getSupportedCategoryAxisType())===ht.w.scalar?r=!0:(r=Dn(a===ht.w.both,t))&&(r=n&&n[0].getVisualCategoryAxisIsScalar?n[0].getVisualCategoryAxisIsScalar():0===this.categoryAxisRenderMode)),{isScalar:r,supportedType:a}},i.prototype.onClearSelection=function(){this.hasSetData&&this.multiples.clearSelection(this.layout.getVisibleMultiples())},i.prototype.onRestoreSelection=function(e){return!!this.interactivityService&&this.interactivityService.restoreSelection(e.selection)},i.prototype.getLayerRendererInitOptions=function(e){var a,t=this;return{animator:null===(a=e.cartesianOptions)||void 0===a?void 0:a.animator,svg:e.axesRenderer.getLayerContainer(),cartesianHost:{updateLegend:function(n){return t.legend.drawLegend({data:n,parentViewport:t.currentViewport,isHierarchicalAxis:t.hasHierarchicalAxisRenderMode,onObject:t.featureSwitches.onObject,titleSliceUid:"".concat("legend","-").concat("title","-titleText")})},triggerRender:function(n){return t.render(n,!1)}},eventManager:this.eventManager,useManagedTabIndex:this.useManagedTabIndex()}},i.prototype.useManagedTabIndex=function(){return this.isSmallMultiples()},i.prototype.onDataViewObjectChanged=function(e,t){var c,r=function(i,e){if(i[0].objectName===cr.Xi){var t=qe.N_.smallMultiplesLayout.rowCount,a=qe.N_.smallMultiplesLayout.columnCount,r=i[0].propertyValue;if(i[0].propertyName===t.propertyName){var n=vr({rowCount:r,columnCount:e.columnCount});i.push({objectName:a.objectName,propertyName:a.propertyName,propertyValue:Math.min(n.maxColumnCount,e.columnCount),propertyType:{integer:!0}})}else i[0].propertyName===a.propertyName&&(n=vr({rowCount:e.rowCount,columnCount:r}),i.push({objectName:t.objectName,propertyName:t.propertyName,propertyValue:Math.min(n.maxRowCount,e.rowCount),propertyType:{integer:!0}}))}return i}(e,Xi(this.dataViews[0].metadata.objects,this.layerStyle));if(!this.featureSwitches.onObject||1!==t)return r;for(var s=[],o=0,l=this.getLayers();o<l.length;o++){var u=l[o];u.getDataViewObjectLayerChanges&&s.push(u.getDataViewObjectLayerChanges(r,t))}if(_.isEmpty(s))return r;if(s.length>1){for(var d=[],h=[],v=0;v<s.length;v++){h[v]=[];for(var y=0,f=s[v];y<f.length;y++){var p=f[y];p.required?d.push(p):h[v].push(p)}}for(var S=h[0],m=1;m<h.length;m++)S=_.intersectionWith(S,h[m],_.isEqual);c=ie.o.applyDataViewObjectsBehaviorChanges(e,(0,g.__spreadArray)((0,g.__spreadArray)([],S,!0),d,!0))}else c=ie.o.applyDataViewObjectsBehaviorChanges(r,_.first(s));return c},i}(),pl=function(){function i(e,t){this.processDataView(e,t)}return i.prototype.processDataView=function(e,t){if(this.renderModes=[],e&&e.metadata&&e.categorical&&!_.isEmpty(e.categorical.categories)){var a=e.metadata,r=e.categorical.categories,n=_.head(r),s=xt.A8(n),o=(0,oe.n$)(e),l=xt.PX(a.objects,N.p.categoryAxis.axisType,n.source.type,s,o);if(o){var u=i.areNonLeafLevelsFilteredToUniqueValue(r),c=(0,le.NA)(a.objects,N.p.categoryAxis.concatenateLabels,!0);if(!u||!c&&t){var d=_.some(e.categorical.categories,function(v){return v.source&&v.source.identityExprs}),h=t&&!c&&d;this.renderModes.unshift(2),h&&this.renderModes.unshift(3),!c&&!d&&(this.warnings=[{selector:null,warnings:[new Ue.Tr]}])}else this.renderModes.unshift(1);l&&this.renderModes.unshift(0)}else this.renderModes.unshift(1),l&&this.renderModes.unshift(0)}else this.renderModes.push(2)},i.prototype.getRenderMode=function(){return _.head(this.renderModes)},i.prototype.getRenderModes=function(){return this.renderModes},i.prototype.addObjectWarnings=function(e){k.fF.assertValue(e,"warnings"),this.warnings&&e.push.apply(e,this.warnings||[])},i.areNonLeafLevelsFilteredToUniqueValue=function(e){if(_.isEmpty(e))return!1;for(var t=e.length-1,a=0;a<t;a++){var r=e[a].source;if(!r||!(0,le.NA)(r.objects,N.p.filters.filteredToUniqueValue,!1))return!1}return!0},i}(),Tc=function(){function i(e){this.palette=e,this.clearPreferredScale()}return i.prototype.getAllColors=function(){return this.palette.getAllColors()},i.prototype.getColorScaleByKey=function(e){return this.setPreferredScale(e),this.preferredScale},i.prototype.getNewColorScale=function(){return this.preferredScale},i.prototype.getColorByIndex=function(e){return this.palette.getColorByIndex(e)},i.prototype.getSentimentColors=function(){return this.palette.getSentimentColors()},i.prototype.getGradientColors=function(){return this.palette.getGradientColors()},i.prototype.getBasePickerColors=function(){return this.palette.getBasePickerColors()},i.prototype.clearPreferredScale=function(){this.preferredScale=this.palette.getNewColorScale(),this.rotated=!1},i.prototype.rotateScale=function(){this.preferredScale=this.preferredScale.clone(),this.preferredScale.clearAndRotateScale(),this.rotated=!0},i.prototype.setPreferredScale=function(e){this.rotated||(this.preferredScale=this.palette.getColorScaleByKey(e))},i}(),kc=function(){function i(e,t){this.loadMoreThreshold=1,this.enabled=!1,k.fF.assertValue(t,"hostServices"),this.hostServices=t,this.setScale(e)}return i.prototype.update=function(e,t){this.enabled=!t&&0!==e},i.prototype.resetViewport=function(e){this.viewportDataRange={startIndex:0,endIndex:e}},i.prototype.setScale=function(e){var t=e&&e.domain&&e.domain().length;t&&(this.loadMoreThresholdIndex=t-1-this.loadMoreThreshold)},i.prototype.isLoadingMoreData=function(){return this.loadingMoreData},i.prototype.onLoadMoreDataCompleted=function(){this.loadingMoreData=!1},i.prototype.shouldLoadMoreData=function(){var e=this.viewportDataRange;return!(!this.enabled||!e||this.isLoadingMoreData())&&e.endIndex>=this.loadMoreThresholdIndex},i.prototype.loadMoreData=function(){var e=this;return k.fF.assert(function(){return e.shouldLoadMoreData()},"unexpected call to loadMoreData"),this.isLoadingMoreData()?bn.G.WaitingForData:(this.loadingMoreData=!0,this.hostServices.loadMoreData(),bn.G.TriggeredLoadMore)},i}()},58778:function(Ei,pa,R){"use strict";R.d(pa,{B:function(){return J}});var wt=R(62458),g=R(38078),N="BubblingEventListeners",xt="BubblingEventManager",J=function(){function U(te){this.root=te,this.registeredBubblingEvents={},this.registeredCapturedEvents={},this.rootNode=te.node(),(0,g.aT)(this.rootNode,xt,this)}return U.prototype.ensureEventRegistered=function(te,q){var Re=this,ke=q?this.registeredCapturedEvents:this.registeredBubblingEvents;if(!ke[te]){ke[te]=!0;var Y=q?Te:he,zt="".concat(te,".").concat(xt);q&&(zt+="Capture"),this.root.on(zt,function(){Y(Re.root)},q)}},U.prototype.on=function(te,q,Re,ke){var Y=function(U){var te=U.indexOf(".");return-1===te?U:U.substr(0,te)}(q);this.ensureEventRegistered(Y,!!ke);var zt=ie(te,!0);if(zt){var ht=zt[Y];ht||(zt[Y]=ht={bubbling:{},captured:{}}),(ke?ht.captured:ht.bubbling)[q]=Re}},U}();function ie(U,te){var q=(0,g.aT)(U,N);if(!q){if(!te)return;(0,g.aT)(U,N,q={})}return q}function oe(U){for(var te in U){var q=U[te];q&&q()}}function De(U,te){for(var q=U.node(),Re=d3.event,ke=Re.target;ke;){var Y=ie(ke,!1);if(Y){var zt=Y[Re.type];zt&&te(zt)}if(ke===q)break;wt.fF.assert(function(){return!(0,g.aT)(ke,xt)},"BubblingEventManagers cannot overlap"),ke=ke.parentElement}}function Te(U){var te=[];De(U,function(Re){var ke=Re.captured;ke&&te.push(ke)});for(var q=te.length;q-- >0;)oe(te[q])}function he(U){De(U,function(te){var q=te.bubbling;q&&oe(q)})}},60810:function(Ei,pa,R){"use strict";R.d(pa,{G:function(){return wt},J:function(){return g}});var wt=function(N){return N[N.NoOperation=0]="NoOperation",N[N.WaitingForData=1]="WaitingForData",N[N.TriggeredLoadMore=2]="TriggeredLoadMore",N}({}),g=function(){function N(xt){this.hostServices=xt,this.waitingForData=!1}return N.prototype.shouldLoadMoreData=function(){return this.shouldLoadMoreDataInternal()===wt.TriggeredLoadMore},N.prototype.isLoadingMoreData=function(){return this.waitingForData},N.prototype.updateDataView=function(xt){this.dataView=xt},N.prototype.loadMoreData=function(){var xt=this.shouldLoadMoreDataInternal();return xt===wt.TriggeredLoadMore&&(this.hostServices.loadMoreData(),this.waitingForData=!0),xt},N.prototype.onLoadMoreDataCompleted=function(){this.waitingForData=!1},N.prototype.shouldLoadMoreDataInternal=function(){if(!this.dataView)return wt.NoOperation;var xt=this.dataView.metadata;return this.waitingForData?wt.WaitingForData:xt&&xt.segment?wt.TriggeredLoadMore:wt.NoOperation},N}()},79476:function(Ei,pa,R){"use strict";R.d(pa,{ao:function(){return U},fS:function(){return N},oY:function(){return he}});var wt=R(19377);function N(te,q){return null!=te&&null!=q&&te.x===q.x&&te.y===q.y}function he(te,q,Re){var ke=(q.y-te.y)*(Re.x-q.x)-(q.x-te.x)*(Re.y-q.y);return 0===ke?wt.i.Colinear:ke>0?wt.i.Clockwise:wt.i.Counterclockwise}function U(te,q,Re){return Re.x<=Math.max(te.x,q.x)&&Re.x>=Math.min(te.x,q.x)&&Re.y<=Math.max(te.y,q.y)&&Re.y>=Math.min(te.y,q.y)}},92379:function(Ei,pa,R){"use strict";R.d(pa,{m:function(){return xt}});var wt=R(19377),g=R(79476),N=R(80758),xt=function(){function J(G){G&&(this.polygonPoints=this.convertArrayPathToPoints(G))}return J.fromPolygonPoints=function(G){var ie=new J(null);return ie.polygonPoints=G,ie},J.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},J.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},J.prototype.contains=function(G){var oe={x:G.left+G.width,y:G.top},De={x:G.left,y:G.top+G.height},Te={x:G.left+G.width,y:G.top+G.height};return this.inside({x:G.left,y:G.top})&&this.inside(oe)&&this.inside(De)&&this.inside(Te)},J.prototype.conflicts=function(G){if(!this.isConflictWithBoundingBox(G))return!1;var oe={x:G.left+G.width/2,y:G.top},De={x:G.left+G.width,y:G.top},Te={x:G.left,y:G.top+G.height},he={x:G.left+G.width/2,y:G.top+G.height},U={x:G.left+G.width,y:G.top+G.height},te={x:G.left,y:G.top+G.height/2},q={x:G.left+G.width,y:G.top+G.height/2};return this.inside({x:G.left,y:G.top})||this.inside(oe)||this.inside(De)||this.inside(Te)||this.inside(he)||this.inside(U)||this.inside(te)||this.inside(q)},J.prototype.lineIntersectionPoint=function(G,ie){for(var oe=0;oe<this.polygonPoints.length;oe++){var he=this.getLineIntersection(G,ie,this.polygonPoints[oe],oe===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[oe+1]);if(null!==he)return he}return null},J.calculateAbsolutePolygonArea=function(G){var ie,oe=1,De=0;for(ie=0;ie<G.length;ie++)De+=G[ie].x*G[oe].y-G[oe].x*G[ie].y,oe=(oe+1)%G.length;return.5*De},J.prototype.overlapPath=function(G){if(this.inside({x:G[0],y:G[1]}))return!0;var ie=new J(G);if(ie.inside(this.polygonPoints[0]))return!0;for(var oe=0;oe<this.polygonPoints.length;oe++)if(ie.lineIntersectionPoint(this.polygonPoints[oe],this.polygonPoints[(oe+1)%this.polygonPoints.length]))return!0;return!1},J.prototype.inside=function(G){for(var ie=G.x,oe=G.y,De=!1,Te=0,he=this.polygonPoints.length-1;Te<this.polygonPoints.length;he=Te++){var U=this.polygonPoints[Te].x,te=this.polygonPoints[Te].y,Re=this.polygonPoints[he].y;te>oe!=Re>oe&&ie<(this.polygonPoints[he].x-U)*(oe-te)/(Re-te)+U&&(De=!De)}return De},J.translateX=function(G,ie){for(var oe=new Float64Array(2*G.polygonPoints.length),De=0;De<G.polygonPoints.length;De++)oe[2*De]=G.polygonPoints[De].x+ie,oe[2*De+1]=G.polygonPoints[De].y;return new J(oe)},J.polygonBoundsOverlap=function(G,ie){var oe=(0,N.WN)(J.getPolyBoundLeft(G),J.getPolyBoundRight(G),J.getPolyBoundLeft(ie),J.getPolyBoundRight(ie)),De=(0,N.WN)(J.getPolyBoundLower(G),J.getPolyBoundUpper(G),J.getPolyBoundLower(ie),J.getPolyBoundUpper(ie));return oe&&De},J.circleRectangleOverlap=function(G,ie,oe){var De=Math.max(G.left,Math.min(ie.x,G.right)),Te=Math.min(G.bottom,Math.max(ie.y,G.top)),he=De-ie.x,U=Te-ie.y;return he*he+U*U<=oe*oe},J.linesIntersect=function(G,ie,oe,De,Te){void 0===Te&&(Te=!0);var he=(0,g.oY)(G,ie,oe),U=(0,g.oY)(G,ie,De),te=(0,g.oY)(oe,De,G),q=(0,g.oY)(oe,De,ie);return he!==U&&te!==q||!!Te&&!!(he===wt.i.Colinear&&(0,g.ao)(G,ie,oe)||U===wt.i.Colinear&&(0,g.ao)(G,ie,De)||te===wt.i.Colinear&&(0,g.ao)(oe,De,G)||q===wt.i.Colinear&&(0,g.ao)(oe,De,ie))},J.resize=function(G,ie){if(0===ie)return G;for(var oe=J.calculateAbsolutePolygonArea(G.polygonPoints)>0,Te=_.clone(ie>0&&!0===oe||ie<0&&!1===oe?G.polygonPoints.reverse():G.polygonPoints),he=G.absoluteCentroid(),U=[],te=0;te<Te.length;te++){var q=Te[te],Re=Te[(te+1)%Te.length],ke=Re.y-q.y,Y=void 0;0!==ke&&(Y=-(Re.x-q.x)/ke);var zt=0;_.isUndefined(Y)||(zt=(q.y<Re.y?-1:1)*Math.sqrt(ie*ie/(1+Y*Y)));var ht=0;0===zt?ht=(q.x>Re.x?-1:1)*ie:_.isUndefined(Y)||(ht=Y*zt);var Ue={x:q.x+zt,y:q.y+ht},yt={x:0,y:0};0===Y?(yt.x=Ue.x,yt.y=Ue.y+10):_.isUndefined(Y)||(yt.x=Ue.x+10,yt.y=Ue.y-10/Y);var k=(Ue.x-yt.x)*(he.y-q.y)-(Ue.y-yt.y)*(he.x-q.x);if(0!==k){var be={x:((Ue.x*yt.y-Ue.y*yt.x)*(he.x-q.x)-(Ue.x-yt.x)*(he.x*q.y-he.y*q.x))/k,y:((Ue.x*yt.y-Ue.y*yt.x)*(he.y-q.y)-(Ue.y-yt.y)*(he.x*q.y-he.y*q.x))/k};isFinite(be.x)&&isFinite(be.y)&&U.push(be)}}return J.fromPolygonPoints(U)},J.getPolyBoundLeft=function(G){var ie;return null===(ie=_.minBy(G.polygonPoints,function(oe){return oe.x}))||void 0===ie?void 0:ie.x},J.getPolyBoundRight=function(G){var ie;return null===(ie=_.maxBy(G.polygonPoints,function(oe){return oe.x}))||void 0===ie?void 0:ie.x},J.getPolyBoundUpper=function(G){var ie;return null===(ie=_.maxBy(G.polygonPoints,function(oe){return oe.y}))||void 0===ie?void 0:ie.y},J.getPolyBoundLower=function(G){var ie;return null===(ie=_.minBy(G.polygonPoints,function(oe){return oe.y}))||void 0===ie?void 0:ie.y},J.prototype.isConflictWithBoundingBox=function(G){return(0,N.HL)(this.absoluteBoundingRect(),G)},J.prototype.calculatePolygonCentroid=function(){var G,ie,oe,De,Te,he;for(G=J.calculateAbsolutePolygonArea(this.polygonPoints),oe=De=0,he=1,Te=0;Te<this.polygonPoints.length;Te++)oe+=(this.polygonPoints[Te].x+this.polygonPoints[he].x)*(ie=this.polygonPoints[Te].x*this.polygonPoints[he].y-this.polygonPoints[he].x*this.polygonPoints[Te].y),De+=(this.polygonPoints[Te].y+this.polygonPoints[he].y)*ie,he=(he+1)%this.polygonPoints.length;return{x:oe/=6*G,y:De/=6*G}},J.prototype.calculateBoundingRect=function(){for(var G=Number.POSITIVE_INFINITY,ie=Number.POSITIVE_INFINITY,oe=Number.NEGATIVE_INFINITY,De=Number.NEGATIVE_INFINITY,Te=0,he=this.polygonPoints;Te<he.length;Te++){var U=he[Te];U.x<G?G=U.x:U.x>oe&&(oe=U.x),U.y<ie?ie=U.y:U.y>De&&(De=U.y)}return{left:G,top:ie,width:oe-G,height:De-ie}},J.prototype.getLineIntersection=function(G,ie,oe,De){var Te=G.x,he=G.y,q=oe.x,Re=oe.y,zt=ie.x-Te,ht=ie.y-he,Ue=De.x-q,yt=De.y-Re,k=(-ht*(Te-q)+zt*(he-Re))/(-Ue*ht+zt*yt),be=(Ue*(he-Re)-yt*(Te-q))/(-Ue*ht+zt*yt);return k>=0&&k<=1&&be>=0&&be<=1?{x:Te+be*zt,y:he+be*ht}:null},J.prototype.convertArrayPathToPoints=function(G){for(var ie=[],oe=0;oe<G.length;oe+=2)ie.push({x:G[oe],y:G[oe+1]});return ie},J}()},34644:function(Ei,pa,R){"use strict";R.d(pa,{Ad:function(){return g},LL:function(){return xt},_9:function(){return N}});var wt=R(62458);function g(J){switch(J){case"linear":return d3.easeLinear;case"cubic-in-out":return d3.easeCubicInOut;case"cubic-out":return d3.easeCubicOut;case"back":return d3.easeBack;default:wt.fF.assertNever(J)}return d3.easeCubicInOut}function N(J){return!!J.bandwidth}function xt(J,G){var ie=J.selectAll(_.map(G,function(oe){return oe.selector}).join(", ")).nodes();ie.sort(function(oe,De){for(var Te=0,he=0;he<G.length;he++)Te+=+d3.select(oe).classed(G[he].class)*he,Te-=+d3.select(De).classed(G[he].class)*he;return Te}),d3.selectAll(ie).order()}},19377:function(Ei,pa,R){"use strict";R.d(pa,{i:function(){return wt}});var wt=function(g){return g[g.Clockwise=0]="Clockwise",g[g.Counterclockwise=1]="Counterclockwise",g[g.Colinear=2]="Colinear",g}({})}}]);