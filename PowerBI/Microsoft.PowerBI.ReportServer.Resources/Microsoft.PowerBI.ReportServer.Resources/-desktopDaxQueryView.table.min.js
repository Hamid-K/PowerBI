"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["table"],{87914:function(Fe,fe,E){E.d(fe,{yv:function(){return D},zf:function(){return O}});var O=9,D=250},44102:function(Fe,fe,E){E.d(fe,{AT:function(){return r},Xg:function(){return le},fw:function(){return ee}});var O=E(81337),L=E(66232),D=E(62458),Z=E(87914),ie=E(93340),re="unselectable";function ee(V,v){if(V)for(var u=0,x=V;u<x.length;u++)(0,x[u])(v)}var M=function(){function V(v,u){this._owner=v,this._direction=u,this._timerHandle=void 0,this.createView();var x=this;this._element.addEventListener("mousedown",function(z){x.onMouseDown(z)}),$(this._element).addClass(re),$(this._svg).addClass(re),$(this._polygon).addClass(re)}return Object.defineProperty(V.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),V.prototype.createView=function(){var v="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(v,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",V.ARROW_COLOR),this._svg=document.createElementNS(v,"svg");var u=this._svg.style;u.position="absolute",u.left="0px",u.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=j.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},V.prototype.onMouseDown=function(v){var u=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){v.cancelBubble=!0;var x=this;this._mouseUpWrapper=function(z){x.onMouseUp(z)},j.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){u.onMouseDown(v)},100),v.preventDefault&&v.preventDefault()},V.prototype.onMouseUp=function(v){clearTimeout(this._timerHandle),j.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},V.prototype.arrange=function(v,u,x){var z=Math.min(v,u);this._polygon.setAttributeNS(null,"transform","translate("+(v-z)/2+", "+(u-z)/2+") scale("+z/16+") rotate("+x+",8,8)"),this._svg.setAttributeNS(null,"width",v+"px"),this._svg.setAttributeNS(null,"height",u+"px"),(0,ie.Py)(this._element,v),(0,ie.Iw)(this._element,u)},V.MIN_WIDTH=26,V.ARROW_COLOR="#404040",V}(),j=function(){function V(v,u,x,z){this.isModern=x,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(v,u);var U=this;this._element.addEventListener("mousedown",function(W){U.onBackgroundMouseDown(W)}),this._element.addEventListener("pointerdown",function(W){(0,L.n)(W)}),this._element.addEventListener("dblclick",function(W){(0,L.n)(W)}),this._middleBar.addEventListener("mousedown",function(W){U.onMiddleBarMouseDown(W)}),this._middleBar.addEventListener("pointerdown",function(W){(0,L.n)(W)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(re),this.onScrollBehavior=z}return V.prototype.scrollBy=function(v,u){this.scrollTo(this.viewMin+v,u)},V.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},V.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},V.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},V.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(V.prototype,"width",{get:function(){return this._width},set:function(u){this._width=u,this._element.style.width=u,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"height",{get:function(){return this._height},set:function(u){this._height=u,this._element.style.height=u,this.invalidateArrange()},enumerable:!1,configurable:!0}),V.prototype.refresh=function(){D.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(V.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),V.prototype._scrollSmallIncrement=function(v){this.scrollBy(this.smallIncrement*v)},Object.defineProperty(V.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),V.prototype.show=function(v){this._visible=v,this.element.style.visibility=v?"visible":"hidden",this.invalidateArrange()},V.prototype._getMouseOffset=function(v){return void 0!==v.offsetX?{x:v.offsetX,y:v.offsetY}:void 0!==v.layerX?{x:v.layerX,y:v.layerY}:{x:v.screenX,y:v.screenY}},V.prototype._getOffsetXDelta=function(v){return(v.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},V.prototype._getOffsetYDelta=function(v){return(v.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},V.prototype._getOffsetXTouchDelta=function(v){return this._getMouseOffset(v).x-this._offsetTouchPrevPos.x},V.prototype._getOffsetYTouchDelta=function(v){return this._getMouseOffset(v).y-this._offsetTouchPrevPos.y},V.prototype.onTouchStart=function(v){1===v.touches.length&&this.onTouchMouseDown(v.touches[0])},V.prototype.onTouchMove=function(v){1===v.touches.length&&(v.preventDefault&&v.preventDefault(),this.onTouchMouseMove(v.touches[0]))},V.prototype.onTouchEnd=function(v){this.onTouchMouseUp(1===v.touches.length?v.touches[0]:v,!0)},V.prototype.onTouchMouseDown=function(v){!this._allowMouseDrag&&v.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},V.prototype._getOffsetTouchDelta=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},V.prototype.onTouchMouseMove=function(v){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(v));var u=this._getOffsetTouchDelta(v);0!==u&&(this.scrollBy(-u/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(v)),v.preventDefault&&v.preventDefault(),v.cancelBubble=!0}},V.prototype.onTouchMouseUp=function(v,u){if(this._touchStarted&&this._offsetTouchStartPos){var x=this._getMouseOffset(v);!u&&(Math.abs(this._offsetTouchStartPos.x-x.x)>3||Math.abs(this._offsetTouchStartPos.y-x.y)>3)&&(v.preventDefault&&v.preventDefault(),v.cancelBubble=!0)}this._touchStarted=!1},V.prototype.createView=function(v,u){this._element=document.createElement("div"),this._element.className=V.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(Z.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===u&&v.appendChild(this._element),this.isModern||(this._minButton=new M(this,-1),this._maxButton=new M(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=V.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(Z.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},V.prototype.scrollTo=function(v,u){var x=Math.min(this.max-this.viewSize,Math.max(this.min,v));(x=Math.max(this.min,x))!==this.viewMin&&(this.viewMin=x,u||ee(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},V.prototype._scrollByPage=function(v){D.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},V.prototype._getRunningSize=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},V.prototype._getOffsetDelta=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},V.prototype.scroll=function(v){var u=this._getOffsetDelta(v)/this._getRunningSize(!0)*(this.max-this.min);if(u<0){if(this._getScreenMousePos(v)>=this._screenMaxMousePos)return}else if(u>0&&this._getScreenMousePos(v)<=this._screenMinMousePos)return;this.scrollBy(u)},Object.defineProperty(V.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),V.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},V.prototype._calculateButtonWidth=function(){return D.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},V.prototype._calculateButtonHeight=function(){return D.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},V.prototype._getMinButtonAngle=function(){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},V.prototype._getMaxButtonAngle=function(){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},V.prototype._setMaxButtonPosition=function(){D.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},V.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},V.prototype.onHoldBackgroundMouseDown=function(v){var u=this;this._timerHandle=setTimeout(function(){u.onBackgroundMouseDown(v)},this._timerHandle?V.ScrollbarBackgroundMousedownHoldDelay:V.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},V.prototype.onBackgroundMouseDown=function(v){var u=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(v.cancelBubble=!0,this._backgroundMouseUpWrapper=function(x){u.onBackgroundMouseUp(x)},V.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(v),this.refresh(),this.onHoldBackgroundMouseDown(v),v.preventDefault&&v.preventDefault()},V.prototype.onBackgroundMouseUp=function(v){clearTimeout(this._timerHandle),this._timerHandle=void 0,V.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},V.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},V.prototype.onMiddleBarMouseDown=function(v){v.cancelBubble=!0,this._screenPrevMousePos={x:v.screenX,y:v.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(v)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(v)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(v)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(v)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,ie.df)(this.element)*this.getPinchZoomY();var u=this;this._middleBarMouseMoveWrapper=function(x){u.onMiddleBarMouseMove(x)},V.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(x){u.onMiddleBarMouseUp(x)},V.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),v.preventDefault&&v.preventDefault()},V.prototype.onMiddleBarMouseMove=function(v){this._screenPrevMousePos&&(this.scroll(v),this.refresh(),this._screenPrevMousePos={x:v.screenX,y:v.screenY})},V.prototype.onMiddleBarMouseUp=function(v){this._screenPrevMousePos=void 0,V.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,V.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,v.preventDefault&&v.preventDefault()},V.prototype._getScreenContextualLeft=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},V.prototype._getScreenContextualRight=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},V.prototype.onMouseWheel=function(v){v&&this.mouseWheel(v)},V.prototype.mouseWheel=function(v){this.visible&&(v<0?v=Math.min(-V.MouseWheelRange,v):v>0&&(v=Math.max(V.MouseWheelRange,v)),this.scrollBy(-v/V.MouseWheelRange*this.smallIncrement))},V.prototype._getScreenMousePos=function(v){return D.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},V.addDocumentMouseUpEvent=function(v){document.addEventListener("mouseup",v)},V.removeDocumentMouseUpEvent=function(v){document.removeEventListener("mouseup",v)},V.addDocumentMouseMoveEvent=function(v){document.addEventListener("mousemove",v)},V.removeDocumentMouseMoveEvent=function(v){document.removeEventListener("mousemove",v)},V.DefaultScrollbarWidth="15px",V.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,V.ScrollbarBackgroundMousedownHoldDelay=50,V.MouseWheelRange=120,V.className="scroll-bar-div",V.barClassName="scroll-bar-part-bar",V.arrowClassName="scroll-bar-part-arrow",V}(),le=function(V){function v(u,x,z,U){var W=V.call(this,u,x,z,U)||this;return W.height=j.DefaultScrollbarWidth,W}return(0,O.__extends)(v,V),v.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,M.MIN_WIDTH))},v.prototype._calculateButtonHeight=function(){return this.actualHeight},v.prototype._getMinButtonAngle=function(){return-180},v.prototype._getMaxButtonAngle=function(){return 0},v.prototype._setMaxButtonPosition=function(){(0,ie.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},v.prototype.refresh=function(){this.arrange();var u=this.actualWidth-2*this.actualButtonWidth-2,x=this.viewSize/(this.max-this.min)*u;x<this.MIN_BAR_SIZE&&(u-=this.MIN_BAR_SIZE-x,x=this.MIN_BAR_SIZE),u<0&&(u=0,x=0),x=Math.min(x,u);var z=this.viewMin/(this.max-this.min)*u;(0,ie.Py)(this.middleBar,x),(0,ie.Iw)(this.middleBar,this.actualHeight);var U=this.actualButtonWidth+1+z;this.isModern?this.middleBar.style.transform="translateX(".concat(U,"px)"):(0,ie.hn)(this.middleBar,U)},v.prototype.show=function(u){u!==this.visible&&(V.prototype.show.call(this,u),u?this.element.style.height=this.height:(0,ie.Iw)(this.element,0))},v.prototype._scrollByPage=function(u){var x;if(this.isModern){var z=window.getComputedStyle(this.middleBar);x=new WebKitCSSMatrix(z.transform).m41}else x=this.middleBar.offsetLeft;var S=void 0===u.offsetX?u.layerX:u.offsetX;S>x+this.middleBar.offsetWidth?this.scrollPageDown():S<x&&this.scrollPageUp()},v.prototype._getRunningSize=function(u){var x=this.actualWidth;if(u){var U=(x-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));U<this.MIN_BAR_SIZE&&(x-=this.MIN_BAR_SIZE-U)}return x},v.prototype._getOffsetDelta=function(u){return this._getOffsetXDelta(u)},v.prototype._getOffsetTouchDelta=function(u){return this._getOffsetXTouchDelta(u)},v.prototype._getScreenContextualLeft=function(u){return u.getBoundingClientRect().left},v.prototype._getScreenContextualRight=function(u){return u.getBoundingClientRect().right},v.prototype._getScreenMousePos=function(u){return u.screenX},v}(j),r=function(V){function v(u,x,z,U){var W=V.call(this,u,x,z,U)||this;return W.width=j.DefaultScrollbarWidth,W}return(0,O.__extends)(v,V),v.prototype._calculateButtonWidth=function(){return this.actualWidth},v.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,M.MIN_WIDTH))},v.prototype._getMinButtonAngle=function(){return-90},v.prototype._getMaxButtonAngle=function(){return 90},v.prototype._setMaxButtonPosition=function(){(0,ie.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},v.prototype.refresh=function(){this.arrange();var u=this.actualHeight-2*this.actualButtonHeight-2,x=this.viewSize/(this.max-this.min)*u;x<this.MIN_BAR_SIZE&&(u-=this.MIN_BAR_SIZE-x,x=this.MIN_BAR_SIZE),u<0&&(u=0,x=0);var z=this.viewMin/(this.max-this.min)*u;(0,ie.Py)(this.middleBar,this.actualWidth),(0,ie.Iw)(this.middleBar,x);var U=this.actualButtonHeight+1+z;this.isModern?this.middleBar.style.transform="translateY(".concat(U,"px)"):(0,ie.FX)(this.middleBar,U)},v.prototype.show=function(u){u!==this.visible&&(V.prototype.show.call(this,u),u?this.element.style.width=this.width:(0,ie.Py)(this.element,0))},v.prototype._scrollByPage=function(u){var x;if(this.isModern){var z=window.getComputedStyle(this.middleBar);x=new WebKitCSSMatrix(z.transform).m42}else x=this.middleBar.offsetTop;var S=void 0===u.offsetY?u.layerY:u.offsetY;S>x+this.middleBar.offsetHeight?this.scrollPageDown():S<x&&this.scrollPageUp()},v.prototype._getRunningSize=function(u){var x=this.actualHeight;if(u){var U=(x-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));U<this.MIN_BAR_SIZE&&(x-=this.MIN_BAR_SIZE-U)}return x},v.prototype._getOffsetDelta=function(u){return this._getOffsetYDelta(u)},v.prototype._getOffsetTouchDelta=function(u){return this._getOffsetYTouchDelta(u)},v.prototype._getScreenContextualLeft=function(u){return u.getBoundingClientRect().top},v.prototype._getScreenContextualRight=function(u){return u.getBoundingClientRect().bottom},v.prototype._getScreenMousePos=function(u){return u.screenY},v}(j)},73889:function(Fe,fe,E){E.d(fe,{Y:function(){return O}});var O=function(L){return L[L.Matrix=0]="Matrix",L[L.Table=1]="Table",L[L.PivotTable=2]="PivotTable",L[L.TableEx=3]="TableEx",L}({})},71090:function(Fe,fe,E){E.d(fe,{Ds:function(){return u},Ed:function(){return n},Eo:function(){return b},F2:function(){return e},Hw:function(){return V},JM:function(){return X},LU:function(){return s},Mh:function(){return ee},NA:function(){return g},OM:function(){return xe},P$:function(){return y},Pr:function(){return U},QM:function(){return pe},R9:function(){return Y},Sl:function(){return le},TV:function(){return j},Vz:function(){return i},WA:function(){return W},YR:function(){return a},Yo:function(){return R},Zk:function(){return t},b:function(){return M},bn:function(){return Z},dG:function(){return o},dm:function(){return v},en:function(){return z},f:function(){return S},fG:function(){return m},iC:function(){return r},jv:function(){return we},lN:function(){return c},mQ:function(){return N},qT:function(){return D},rJ:function(){return d},rx:function(){return p},rz:function(){return x},s$:function(){return k},s0:function(){return K},sR:function(){return L},uX:function(){return re},uZ:function(){return C},wH:function(){return B},wd:function(){return h},yF:function(){return ie},ye:function(){return l},z7:function(){return ue},zq:function(){return Q}});var O=E(38265),L=.8,D="TableTotalLabel",Z="Format_AddTotalLabel",ie="Visual_LabelText_Value",re="Row_Selection",ee="SelectRow",M="Row_Selected",j="Row_Unselected",le="Additional_Conditional_Formatting",r="DecompositionTree_ScrollLevelUp_Tooltip",V="DecompositionTree_ScrollLevelDown_Tooltip",v="Scroll_Left",u="Scroll_Right",x="tablixDiv",z="tablixCellContentElement",U="tablixCellContentHost",W="tablixWrappingContainer",S="tablixHeader",N="tablixColumnHeaderLeaf",K="tablixValueNumeric",Y="tablixValueTotal",g="powervisuals-glyph tablixUrlIconGlyph",s="tablixValueUrlIcon",n="tablixImageContainer",b="matrixRowHeaderLeaf",k="tableFooterCell",X="tableBodyCell",Q="tableBodyCellBottom",ue="tablixAlignLeft",pe="tablixAlignCenter",xe="tablixAlignRight",we="&nbsp;",B="px",p="tablixSortIconContainer",a=10,d=5,y=5,m=5,h=1,o=O.Wn.regular.css,e=O.Wn.regular.css,t=O.Wn.bold.css,i=O.Wn.glyphs.css,l="#333",c="#666",C=Number.POSITIVE_INFINITY,R=.71},16324:function(Fe,fe,E){E.d(fe,{Vz:function(){return p},dk:function(){return B}});var O=E(81337),L=E(62458),D=E(41640),Z=E(32041),ie=E(64329),re=E(81671),ee=E(93414),M=E(93340),j=function(){function o(e,t,i){this._scrollable=!1,this._presenter=e,this.extension=t,this._presenter.initialize(this),this._row=i,this.item=null,this.type=null,this._horizontalOffset=0,this._verticalOffset=0,this._colSpan=1,this._rowSpan=1,this._containerWidth=-1,this._containerHeight=-1,this.contentHeight=this.contentWidth=0,this.position=new M.ri}return o.prototype.unfixRowHeight=function(){this._row.unfixSize()},Object.defineProperty(o.prototype,"colSpan",{get:function(){return this._colSpan},set:function(t){this._colSpan!==t&&(this._presenter.onColumnSpanChanged(t),this._colSpan=t,this._presenter.onContainerWidthChanged(-1))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"rowSpan",{get:function(){return this._rowSpan},set:function(t){this._rowSpan!==t&&(this._presenter.onRowSpanChanged(t),this._rowSpan=t,this._row.unfixSize())},enumerable:!1,configurable:!0}),o.prototype.getCellSpanningHeight=function(){return this._row.getCellSpanningHeight(this)},Object.defineProperty(o.prototype,"textAlign",{get:function(){return this._textAlign},set:function(t){t!==this._textAlign&&(this._presenter.onTextAlignChanged(t),this._textAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"horizontalOffset",{get:function(){return this._horizontalOffset},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"verticalOffset",{get:function(){return this._verticalOffset},enumerable:!1,configurable:!0}),o.prototype.isScrollable=function(){return this._scrollable},o.prototype.clear=function(){this.isScrollable()&&this.initializeScrolling(),this._presenter.onClear(),this.setContainerWidth(-1),this.setContainerHeight(-1),this.contentHeight=this.contentWidth=0},o.prototype.initializeScrolling=function(){this._presenter.onInitializeScrolling(),this._horizontalOffset=0,0!==this._verticalOffset&&(this._verticalOffset=0),1===this.colSpan&&this.setContainerWidth(-1),1===this.rowSpan&&this.setContainerHeight(-1)},o.prototype.prepare=function(e){this.isScrollable()&&this.initializeScrolling(),this._scrollable=e},o.prototype.scrollVertically=function(e,t){var i=Math.ceil(-e*t);this._verticalOffset=i,this.isScrollable()?(this._presenter.onVerticalScroll(e,i),this.setContainerHeight(e+i)):this.setContainerHeight(this._row.getCellSpanningHeight(this)+i)},o.prototype.scrollHorizontally=function(e,t){this.isScrollable()&&(this._presenter.onHorizontalScroll(e,t),this.setContainerWidth(e+t))},o.prototype.setContainerWidth=function(e){e!==this._containerWidth&&(this._containerWidth=e,this._presenter.onContainerWidthChanged(e))},Object.defineProperty(o.prototype,"containerWidth",{get:function(){return this._containerWidth},enumerable:!1,configurable:!0}),o.prototype.setContainerHeight=function(e){if(e<0&&(e=-1),e!==this._containerHeight){this._containerHeight=e;var t=this._row.owner.owner,i=t.getBinder();t.wordWrapRowHeaders&&null!=i.applyWordWrapping&&-1!==e&&1===this.type&&!this.position.column.isLast&&i.applyWordWrapping(this.item,this),this._presenter.onContinerHeightChanged(e)}},Object.defineProperty(o.prototype,"containerHeight",{get:function(){return this._containerHeight},enumerable:!1,configurable:!0}),o.prototype.applyStyle=function(e){e&&(e.applyStyle(this),this.contentHeight+=e.getExtraBottom()+e.getExtraTop(),this.contentWidth+=e.getExtraLeft()+e.getExtraRight())},o.prototype.enableHorizontalResize=function(e,t){this._presenter.enableHorizontalResize(e,t)},o.prototype.isColumnResizing=function(){return this._column&&this._column.isResizing()},o}(),le=function(){function o(e,t){this._presenter=e,this._presenter.initialize(this),this._containerWidth=-1,this._width=-1,this._sizeFixed=!1,this._aligningWidth=-1,this._fixedToAligningWidth=!1,this._items=[],this._itemType=null,this._footerCell=null,this.isColumnResizing=!1}return o.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedColumnHeaders=[],this._realizedCornerCells=[],this._realizedBodyCells=[]},Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),o.prototype.getType=function(){return this._realizedCornerCells.length>0?0:2},o.prototype.getColumnHeadersOrCorners=function(){return this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders},o.prototype.columnHeadersOrCornersEqual=function(e,t,i){if(this._items.length!==t.length)return!1;for(var l=this._items.length,c=0;c<l;c++)if(!this.columnHeaderOrCornerEquals(this._itemType,this._items[c],e,t[c].item,i))return!1;return!0},Object.defineProperty(o.prototype,"itemType",{get:function(){return this._itemType},enumerable:!1,configurable:!0}),o.prototype.getLeafItem=function(){return 0===this._items.length?null:this._items[this._items.length-1]},o.prototype.columnHeaderOrCornerEquals=function(e,t,i,l,c){if(e!==i)return!1;if(0===e){if(!c.cornerCellItemEquals(t,l))return!1}else if(!c.headerItemEquals(t,l))return!1;return!0},o.prototype.OnLeafRealized=function(e){var t=this.getType(),i=this.getColumnHeadersOrCorners();if(this.columnHeadersOrCornersEqual(t,i,e))this.clearSpanningCellsWidth(this._realizedColumnHeaders);else{var l=i.length;this._items=[];for(var c=0;c<l;c++)this._items.push(i[c].item);this._itemType=t,this.clearSize()}},o.prototype.clearSpanningCellsWidth=function(e){for(var t=0,i=e;t<i.length;t++){var l=i[t];l.colSpan>1&&l.setContainerWidth(-1)}},o.prototype.addCornerCell=function(e){e._column=this,this._realizedCornerCells.push(e),e.setContainerWidth(this._containerWidth)},o.prototype.addRowHeader=function(e){e._column=this,this._realizedRowHeaders.push(e),e.setContainerWidth(this._containerWidth)},o.prototype.addColumnHeader=function(e,t){e._column=this,this._realizedColumnHeaders.push(e),t&&e.setContainerWidth(this._containerWidth)},o.prototype.addBodyCell=function(e){e._column=this,this._realizedBodyCells.push(e),e.setContainerWidth(this._containerWidth)},Object.defineProperty(o.prototype,"footer",{get:function(){return this._footerCell},set:function(t){this._footerCell=t,t._column=this,t.setContainerWidth(this._containerWidth)},enumerable:!1,configurable:!0}),o.prototype.isResizing=function(){return this.isColumnResizing},o.prototype.onResize=function(e){this.isColumnResizing=!0,e!==this.getContentContextualWidth()&&(this._containerWidth=e,this.setContainerWidth(this._containerWidth),this._sizeFixed=!0,this._fixedToAligningWidth=!1,this._aligningWidth=-1)},o.prototype.onResizeEnd=function(e){this.isColumnResizing=!1;var t=this.owner._presenter;t&&t.invokeColumnResizeEndCallback(this,e)},o.prototype.fixSize=function(){var e=-1!==this._aligningWidth;this._sizeFixed&&e===this._fixedToAligningWidth&&!e||(this.setContainerWidth(-1===this._aligningWidth?this._containerWidth:this._aligningWidth),this._sizeFixed=!0,this._fixedToAligningWidth=-1!==this._aligningWidth)},o.prototype.clearSize=function(){this._containerWidth=-1,this.setContainerWidth(this._containerWidth),this._sizeFixed=!1},o.prototype.getContentContextualWidth=function(){return this._containerWidth},o.prototype.getCellIContentContextualWidth=function(e){return this._presenter.getCellWidth(e)},o.prototype.getContextualWidth=function(){return(-1===this._width||-1===this._containerWidth)&&(this._width=this._presenter.getWidth()),this._width},o.prototype.calculateSize=function(){if(this._sizeFixed)return this._containerWidth;var e=0,t=this._presenter.getPersistedWidth();if(null!=t){e=t;for(var i=0,l=this._realizedColumnHeaders.length;i<l-1;i++)1===(c=this._realizedColumnHeaders[i]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(c)));return this._containerWidth=e}for(var C=0,R=this._realizedColumnHeaders;C<R.length;C++)1===(c=R[C]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(c)));for(var T=0,f=this._realizedRowHeaders;T<f.length;T++)1===(c=f[T]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(c)));for(var F=0,A=this._realizedCornerCells;F<A.length;F++){var c=A[F];e=Math.max(e,this._presenter.getCellWidth(c))}for(var te=0,ae=this._realizedBodyCells;te<ae.length;te++)c=ae[te],e=Math.max(e,this._presenter.getCellWidth(c));return null!==this._footerCell&&1===this._footerCell.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(this._footerCell))),this._containerWidth=e},o.prototype.setAligningContextualWidth=function(e){this._aligningWidth=e},o.prototype.getAligningContextualWidth=function(){return this._aligningWidth},o.prototype.setContainerWidth=function(e){for(var t=0,i=this._realizedColumnHeaders;t<i.length;t++)1===(l=i[t]).colSpan&&l.setContainerWidth(e);for(var c=0,C=this._realizedRowHeaders;c<C.length;c++)1===(l=C[c]).colSpan&&l.setContainerWidth(e);for(var R=0,T=this._realizedCornerCells;R<T.length;R++)(l=T[R]).setContainerWidth(e);for(var f=0,F=this._realizedBodyCells;f<F.length;f++){var l;(l=F[f]).setContainerWidth(e)}null!==this._footerCell&&1===this._footerCell.colSpan&&this._footerCell.setContainerWidth(e),this._width=e},o.prototype.getTablixCell=function(){var e=this._realizedColumnHeaders.length>0?this._realizedColumnHeaders:this._realizedCornerCells;return e[e.length-1]},o.prototype.getIndex=function(e){return e.realizedColumns.indexOf(this)},o.prototype.getHeaders=function(){return this._realizedColumnHeaders},o.prototype.getOtherDimensionHeaders=function(){return this._realizedRowHeaders},o.prototype.getCellContextualSpan=function(e){return e.colSpan},o.prototype.getOtherDimensionOwner=function(e){return e._row},o}(),r=function(){function o(e){this._containerHeight=-1,this._presenter=e,this._presenter.initialize(this),this._allocatedCells=[],this._heightFixed=!1,this._containerHeight=-1,this._height=-1}return o.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedBodyCells=[],this._realizedCornerCells=[],this._realizedColumnHeaders=[],this._realizedCellsCount=0},Object.defineProperty(o.prototype,"presenter",{get:function(){return this._presenter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),o.prototype.releaseUnusedCells=function(e){this.releaseCells(e,this._realizedCellsCount)},o.prototype.releaseAllCells=function(e){this.releaseCells(e,0)},o.prototype.releaseCells=function(e,t){for(var i=this._allocatedCells,l=i.length,c=t;c<l;c++){var C=i[c];e._unbindCell(C),C.clear()}},o.prototype.moveScrollableCellsToEnd=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;i<t+e;i++){var l=this._allocatedCells[i];this._presenter.onRemoveCell(l),this._presenter.onAppendCell(l),this._allocatedCells.push(l)}this._allocatedCells.splice(t,e)},o.prototype.moveScrollableCellsToStart=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;i<t+e;i++){var l=this._allocatedCells.pop();this._presenter.onRemoveCell(l),this._presenter.onInsertCellBefore(l,this._allocatedCells[t]),this._allocatedCells.splice(t,0,l)}},o.prototype.getOrCreateCornerCell=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.addCornerCell(t),this._realizedCornerCells.push(t),t.setContainerHeight(this._containerHeight),t},o.prototype.getOrCreateRowHeader=function(e,t,i){var l=this.getOrCreateCell();return l.prepare(t),e.addRowHeader(l),this._realizedRowHeaders.push(l),i&&l.setContainerHeight(this._containerHeight),l},o.prototype.getOrCreateColumnHeader=function(e,t,i){var l=this.getOrCreateCell();return l.prepare(t),e.addColumnHeader(l,i),this._realizedColumnHeaders.push(l),l.setContainerHeight(this._containerHeight),l},o.prototype.getOrCreateBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.addBodyCell(i),this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},o.prototype.getOrCreateFooterRowHeader=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.footer=t,this._realizedRowHeaders.push(t),t.setContainerHeight(this._containerHeight),t},o.prototype.getOrCreateFooterBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.footer=i,this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},o.prototype.getRowHeaderLeafIndex=function(){for(var e=-1,t=this._allocatedCells.length,i=0;i<t&&1===this._allocatedCells[i].type;i++)e++;return e},o.prototype.getAllocatedCellAt=function(e){return this._allocatedCells[e]},o.prototype.moveCellsBy=function(e){if(0!==this._allocatedCells.length)if(e>0)for(var t=this._allocatedCells[0],i=0;i<e;i++){var l=this.createCell(this);this._presenter.onInsertCellBefore(l,t),this._allocatedCells.unshift(l),t=l}else{for(e=-e,i=0;i<e;i++)this._presenter.onRemoveCell(this._allocatedCells[i]);this._allocatedCells.splice(0,e)}},o.prototype.getRealizedCellCount=function(){return this._realizedCellsCount},o.prototype.getRealizedHeadersCount=function(){return this._realizedRowHeaders.length},o.prototype.getRealizedHeaderAt=function(e){return this._realizedRowHeaders[e]},o.prototype.getTablixCell=function(){var e;return(e=this._realizedRowHeaders.length>0?this._realizedRowHeaders:this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders)[e.length-1]},o.prototype.getOrCreateEmptySpaceCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e&&(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)),e},o.prototype.createCell=function(e){var t=this._presenter.createCellPresenter(this._owner.owner.layoutManager.getLayoutKind());return new j(t,t,this)},o.prototype.getOrCreateCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e?(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)):(e.colSpan=1,e.rowSpan=1),this._realizedCellsCount=this._realizedCellsCount+1,e},o.prototype.isResizing=function(){return!1},o.prototype.onResize=function(e){e!==this.getContentContextualWidth()&&(this._containerHeight=e,this.setContentHeight(),this._heightFixed=!0,this.setAligningContextualWidth(-1))},o.prototype.onResizeEnd=function(e){},o.prototype.fixSize=function(){this.setContentHeight(),this._heightFixed=!0},o.prototype.unfixSize=function(){this._heightFixed=!1,this._height=-1},o.prototype.getContentContextualWidth=function(){return this._containerHeight},o.prototype.getCellIContentContextualWidth=function(e){return this.presenter.getCellContentHeight(e)},o.prototype.getCellSpanningHeight=function(e){var t=this.getContextualWidth();if(e.rowSpan>1)for(var i=this.getIndex(this.owner),l=this.owner.realizedRows,c=1;c<e.rowSpan;c++)t+=l[c+i].getContextualWidth();return t},o.prototype.getContextualWidth=function(){return(-1===this._height||-1===this._containerHeight)&&(this._height=this._presenter.getHeight()),this._height},o.prototype.sizeFixed=function(){return this._heightFixed},o.prototype.calculateSize=function(){if(this._heightFixed)return this._containerHeight;for(var e=0,t=this._realizedRowHeaders.length,i=0;i<t;i++)1===(l=this._realizedRowHeaders[i]).rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(l)));for(t=this._realizedCornerCells.length,i=0;i<t;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedCornerCells[i]));for(t=this._realizedColumnHeaders.length,i=0;i<t;i++){var l;1===(l=this._realizedColumnHeaders[i]).rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(l)))}for(t=this._realizedBodyCells.length,i=0;i<t;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedBodyCells[i]));return this._containerHeight=e},o.prototype.setAligningContextualWidth=function(e){},o.prototype.getAligningContextualWidth=function(){return-1},o.prototype.setContentHeight=function(){for(var e=this._realizedRowHeaders.length,t=e-1;t>=0;t--)-1!==(i=this._realizedRowHeaders[t]).containerHeight&&i._row.sizeFixed()||(i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i)));for(var l=0,c=this._realizedCornerCells;l<c.length;l++)-1!==(i=c[l]).containerHeight&&i._row.sizeFixed()||i.setContainerHeight(this._containerHeight);for(var C=0,R=this._realizedColumnHeaders;C<R.length;C++)-1!==(i=R[C]).containerHeight&&i._row.sizeFixed()||(i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i)));e=this._realizedBodyCells.length;for(var T=0,f=this._realizedBodyCells;T<f.length;T++){var i;-1!==(i=f[T]).containerHeight&&i._row.sizeFixed()||i.setContainerHeight(this._containerHeight)}this._height=-1},o.prototype.getIndex=function(e){return e.realizedRows.indexOf(this)},o.prototype.getHeaders=function(){return this._realizedRowHeaders},o.prototype.getOtherDimensionHeaders=function(){return this._realizedColumnHeaders},o.prototype.getCellContextualSpan=function(e){return e.rowSpan},o.prototype.getOtherDimensionOwner=function(e){return e._column},o}(),V=function(){function o(e){this._presenter=e,this._footerRow=null}return o.prototype.initialize=function(e,t,i){this._owner=e,this._presenter.initialize(this,t,i,e),this.fillColumnsProportionally=!1,this._realizedRows=[],this._realizedColumns=[],this._emptySpaceHeaderCell=null,this._emptyFooterSpaceCell=null},Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fillColumnsProportionally",{get:function(){return this._fillColumnsProportionally},set:function(t){this._fillColumnsProportionally!==t&&(this._fillColumnsProportionally=t,this._presenter.onFillColumnsProportionallyChanged(t))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"realizedColumns",{get:function(){return this._realizedColumns},set:function(t){this._realizedColumns=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"realizedRows",{get:function(){return this._realizedRows},set:function(t){this._realizedRows=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"footerRow",{get:function(){return this._footerRow},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"emptySpaceHeaderCell",{get:function(){return this._emptySpaceHeaderCell},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"emptySpaceFooterCell",{get:function(){return this._emptyFooterSpaceCell},enumerable:!1,configurable:!0}),o.prototype.ShowEmptySpaceCells=function(e,t){0!==this._realizedRows.length&&(0!==this._realizedRows.length&&!this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell=this._realizedRows[0].getOrCreateEmptySpaceCell(),this._emptySpaceHeaderCell.rowSpan=e,this._emptySpaceHeaderCell.colSpan=1,this._emptySpaceHeaderCell.setContainerWidth(t)),this._footerRow&&null===this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell=this._footerRow.getOrCreateEmptySpaceCell(),this._emptyFooterSpaceCell.rowSpan=1,this._emptyFooterSpaceCell.colSpan=1,this._emptyFooterSpaceCell.setContainerWidth(t)))},o.prototype.HideEmptySpaceCells=function(){this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell.clear(),this._emptySpaceHeaderCell=null),this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell.clear(),this._emptyFooterSpaceCell=null)},o.prototype.onStartRenderingSession=function(e){e&&(this.clearRows(),this.clearColumns())},o.prototype.onStartRenderingIteration=function(){this.initializeRows(),this.initializeColumns()},o.prototype.onEndRenderingIteration=function(){var e=this._rows;if(void 0!==e)for(var t=e.length,i=0;i<t;i++)e[i].releaseUnusedCells(this._owner);this._footerRow&&this._footerRow.releaseUnusedCells(this._owner)},o.prototype.getOrCreateRow=function(e){var t=this._rows[e];return void 0===t&&((t=new r(this._presenter.createRowPresenter())).initialize(this),this._presenter.onAppendRow(t),this._rows[e]=t),void 0===this._realizedRows[e]&&(this._realizedRows[e]=t),t},o.prototype.getOrCreateFootersRow=function(){return null===this._footerRow&&(this._footerRow=new r(this._presenter.createRowPresenter()),this._footerRow.initialize(this),this._presenter.onAddFooterRow(this._footerRow)),this._footerRow},o.prototype.moveRowsToEnd=function(e,t){for(var i=0;i<t;i++){var l=this._rows[i+e];L.fF.assertValue(l,"Invalid Row Index"),l.unfixSize(),this._presenter.onRemoveRow(l),this._presenter.onAppendRow(l),this._rows.push(l)}this._rows.splice(e,t)},o.prototype.moveRowsToStart=function(e,t){var i=this._rows[e];L.fF.assertValue(i,"Invalid Row Index");for(var l=0;l<t;l++){var c=this._rows.pop();c.unfixSize(),this._presenter.onRemoveRow(c),this._presenter.onInsertRowBefore(c,i),this._rows.splice(e+l,0,c)}},o.prototype.moveColumnsToEnd=function(e,t){for(var c=Math.max(this._columns[this._rows[0]._realizedCornerCells.length]._realizedColumnHeaders.length-1,0);c<this._rows.length;c++)this._rows[c].moveScrollableCellsToEnd(t);for(c=0;c<t;c++)this._columns.push(this._columns[c+e]);this._columns.splice(e,t)},o.prototype.moveColumnsToStart=function(e,t){for(var c=Math.max(this._columns[this._rows[0]._realizedCornerCells.length]._realizedColumnHeaders.length-1,0);c<this._rows.length;c++)this._rows[c].moveScrollableCellsToStart(t);for(c=0;c<t;c++){var C=this._columns.pop();this._columns.splice(e+c,0,C)}},o.prototype.getOrCreateColumn=function(e){var t=this._columns[e];return void 0===t&&((t=new le(this._presenter.createColumnPresenter(e),e)).initialize(this),this._columns[e]=t),void 0===this._realizedColumns[e]&&(this._realizedColumns[e]=t),t},o.prototype.initializeColumns=function(){this._columns||(this._columns=[]);for(var e=this._columns.length,t=0;t<e;t++)this._columns[t].initialize(this);this._realizedColumns=[]},o.prototype.clearColumns=function(){this._columns=null,this._realizedColumns=null},o.prototype.initializeRows=function(){var e=this._owner.rowDimension.hasFooter()&&null!==this._footerRow;this._realizedRows=[],this._rows||(this._rows=[]);for(var t=this._rows,i=t.length,l=0;l<i;l++)t[l].initialize(this);e&&(this._footerRow||this.getOrCreateFootersRow(),this._footerRow.initialize(this))},o.prototype.clearRows=function(){var e=this._rows;if(e){for(var t=e.length,i=0;i<t;i++)e[i].releaseAllCells(this._owner);this._footerRow&&this._footerRow.releaseAllCells(this._owner),this._presenter.onClear(),this._footerRow=null,this._rows=null,this._realizedRows=null}},o.prototype.getWidth=function(){return this._presenter.getWidth()},o.prototype.getHeight=function(){return this._presenter.getHeight()},o}(),v=E(42737),u="unselectable",x=function(o){function e(t,i,l){var c=o.call(this,i,l)||this;return c._cell=t,c}return(0,O.__extends)(e,o),Object.defineProperty(e.prototype,"cell",{get:function(){return this._cell},enumerable:!1,configurable:!0}),e.prototype._hotSpot=function(t){return t.x>=this.element.getBoundingClientRect().right-v.A.resizeHandleSize},e}(v.A),z=function(){function o(e,t){this._tableCell=null,this._contentElement=(0,M.wC)(),this._contentHost=(0,M.wC)(),this.layoutKind=t,this._contentElement.appendChild(this._contentHost),this._resizer=null}return o.prototype.initialize=function(e){this._owner=e},Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),o.prototype.registerTableCell=function(e){this._tableCell=e,e.appendChild(this._contentElement)},Object.defineProperty(o.prototype,"tableCell",{get:function(){return this._tableCell},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contentElement",{get:function(){return this._contentElement},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!1,configurable:!0}),o.prototype.registerClickHandler=function(e){this._contentElement.onclick=e},o.prototype.unregisterClickHandler=function(){this._contentElement.onclick=null},o.prototype.onContainerWidthChanged=function(e){(0,M.Py)(this._contentElement,e)},o.prototype.onContinerHeightChanged=function(e){(0,M.Iw)(this._contentElement,e)},o.prototype.onColumnSpanChanged=function(e){this._tableCell.colSpan=e},o.prototype.onRowSpanChanged=function(e){this._tableCell.rowSpan=e},o.prototype.onTextAlignChanged=function(e){this._tableCell.style.textAlign=e},o.prototype.onClear=function(){this._contentHost.className="",this._tableCell.className=""},o.prototype.onHorizontalScroll=function(e,t){(0,M.hn)(this._contentHost,t),(0,M.Py)(this._contentHost,e)},o.prototype.onVerticalScroll=function(e,t){(0,M.FX)(this._contentHost,t),(0,M.Iw)(this._contentHost,e)},o.prototype.onInitializeScrolling=function(){(0,M.hn)(this._contentHost,0),(0,M.FX)(this._contentHost,0),(0,M.Py)(this._contentHost,-1),(0,M.Iw)(this._contentHost,-1)},o.prototype.enableHorizontalResize=function(e,t){e!==(null!==this._resizer)&&(e?(this._resizer=new x(this._owner,this._tableCell,t),this._resizer.initialize()):(this._resizer.uninitialize(),this._resizer=null))},o.prototype.disableDragResize=function(){this._tableCell.setAttribute(o._dragResizeDisabledAttributeName,"true")},o._dragResizeDisabledAttributeName="drag-resize-disabled",o}(),U=function(){function o(e){this._tableRow=null,this._fitProportionally=e}return o.prototype.initialize=function(e){this._row=e},o.prototype.createCellPresenter=function(e){return new z(this._fitProportionally,e)},o.prototype.registerRow=function(e){this._tableRow=e},o.prototype.onAppendCell=function(e){var t=e._presenter;if(null===t.tableCell){var i=this._tableRow.insertCell(-1);t.registerTableCell(i)}else this._tableRow.appendChild(t.tableCell)},o.prototype.onInsertCellBefore=function(e,t){L.fF.assertValue(t._presenter.tableCell,"refTableCell");var i=e._presenter;if(null===i.tableCell){var l=this._tableRow.insertCell(Math.max(0,t._presenter.tableCell.cellIndex-1));i.registerTableCell(l)}else this._tableRow.insertBefore(e._presenter.tableCell,t._presenter.tableCell)},o.prototype.onRemoveCell=function(e){this._tableRow.removeChild(e._presenter.tableCell)},o.prototype.getHeight=function(){return this.getCellHeight(this._row.getTablixCell())},o.prototype.getCellHeight=function(e){return L.fF.assertFail("PureVirtualMethod: TablixRowPresenter.getCellHeight"),-1},o.prototype.getCellContentHeight=function(e){return L.fF.assertFail("PureVirtualMethod: TablixRowPresenter.getCellHeight"),-1},Object.defineProperty(o.prototype,"tableRow",{get:function(){return this._tableRow},enumerable:!1,configurable:!0}),o}(),W=function(o){function e(t,i){return o.call(this,i)||this}return(0,O.__extends)(e,o),e.prototype.getCellHeight=function(t){return t.containerHeight},e.prototype.getCellContentHeight=function(t){return t.contentHeight},e}(U),S=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),e.prototype.getCellHeight=function(t){return t.containerHeight},e.prototype.getCellContentHeight=function(t){return t.contentHeight},e}(U),N=function(){function o(){}return o.prototype.initialize=function(e){this._column=e},o.prototype.getWidth=function(){var e=this.getPersistedWidth();return null==e&&(e=this.getCellWidth(this._column.getTablixCell())),e},o.prototype.getPersistedWidth=function(){return L.fF.assertFail("PureVirtualMethod: TablixColumnPresenter.getPersistedWidth"),-1},o.prototype.getCellWidth=function(e){return L.fF.assertFail("PureVirtualMethod: TablixColumnPresenter.getCellWidth"),-1},o}(),K=function(o){function e(t){var i=o.call(this)||this;return i._gridPresenter=t,i}return(0,O.__extends)(e,o),e.prototype.getPersistedWidth=function(){return this._gridPresenter.sizeComputationManager.cellWidth},e.prototype.getCellWidth=function(t){return this._gridPresenter.sizeComputationManager.cellWidth},e}(N),Y=function(o){function e(t,i){var l=o.call(this)||this;return l._gridPresenter=t,l}return(0,O.__extends)(e,o),e.prototype.getPersistedWidth=function(){return this._gridPresenter.getPersistedColumnWidth(this._column)},e.prototype.getCellWidth=function(t){return t._presenter?t.contentWidth:0},e}(N),g=function(){function o(e){this._table=(0,M.W_)(),this._table.className=u,this._footerTable=(0,M.W_)(),this._footerTable.className=u,this._columnWidthManager=e}return o.prototype.initialize=function(e,t,i,l){this._owner=e,t.appendChild(this._table),i.appendChild(this._footerTable)},o.prototype.getWidth=function(){return L.fF.assertFail("PureVirtualMethod: TablixGridPresenter.getWidth"),-1},o.prototype.getHeight=function(){return L.fF.assertFail("PureVirtualMethod: TablixGridPresenter.getHeight"),-1},o.prototype.getScreenToCssRatioX=function(){return 1},o.prototype.getScreenToCssRatioY=function(){return 1},o.prototype.createRowPresenter=function(){return L.fF.assertFail("PureVirtualMethod: TablixGridPresenter.createRowPresenter"),null},o.prototype.createColumnPresenter=function(e){return L.fF.assertFail("PureVirtualMethod: TablixGridPresenter.createColumnPresenter"),null},o.prototype.onAppendRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._table.insertRow(-1);t.registerRow(i)}else this._table.tBodies[0].appendChild(e.presenter.tableRow)},o.prototype.onInsertRowBefore=function(e,t){L.fF.assertValue(t.presenter.tableRow,"refTableRow");var i=e.presenter;if(null===i.tableRow){var l=this._table.insertRow(Math.max(0,t.presenter.tableRow.rowIndex-1));i.registerRow(l)}else this._table.tBodies[0].insertBefore(e.presenter.tableRow,t.presenter.tableRow)},o.prototype.onRemoveRow=function(e){this._table.tBodies[0].removeChild(e.presenter.tableRow)},o.prototype.onAddFooterRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._footerTable.insertRow(-1);t.registerRow(i)}else this._footerTable.tBodies[0].appendChild(e.presenter.tableRow)},o.prototype.onClear=function(){(0,M.D4)(this._table),(0,M.D4)(this._footerTable)},o.prototype.onFillColumnsProportionallyChanged=function(e){e?(this._table.style.width="100%",this._footerTable.style.width="100%"):(this._table.style.width="auto",this._footerTable.style.width="auto")},o.prototype.invokeColumnResizeEndCallback=function(e,t){this._columnWidthManager&&this._columnWidthManager.onColumnWidthChanged(re.K.getColumnQueryName(e),t)},o.prototype.getPersistedColumnWidth=function(e){if(this._columnWidthManager)return this._columnWidthManager.getPersistedColumnWidth(re.K.getColumnQueryName(e))},o}(),s=function(o){function e(t){var i=o.call(this)||this;return i._sizeComputationManager=t,i}return(0,O.__extends)(e,o),e.prototype.createRowPresenter=function(){return new W(this,this._owner.fillColumnsProportionally)},e.prototype.createColumnPresenter=function(t){return new K(this)},Object.defineProperty(e.prototype,"sizeComputationManager",{get:function(){return this._sizeComputationManager},enumerable:!1,configurable:!0}),e.prototype.getWidth=function(){return this._sizeComputationManager.gridWidth},e.prototype.getHeight=function(){return this._sizeComputationManager.gridHeight},e}(g),n=function(o){function e(t){return o.call(this,t)||this}return(0,O.__extends)(e,o),e.prototype.createRowPresenter=function(){return new S(this._owner.fillColumnsProportionally)},e.prototype.createColumnPresenter=function(t){return new Y(this,t)},e.prototype.getWidth=function(){return(0,M.mx)(this._table)},e.prototype.getHeight=function(){return(0,M.Uy)(this._table)},e}(g),b=function(){function o(){}return Object.defineProperty(o.prototype,"visibleWidth",{get:function(){return this._viewport?this._viewport.width:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"visibleHeight",{get:function(){return this._viewport?this._viewport.height:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gridWidth",{get:function(){return this.visibleWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gridHeight",{get:function(){return this.visibleHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"rowHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cellWidth",{get:function(){return this._cellWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cellHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contentWidth",{get:function(){return this._cellWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contentHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),o.prototype.updateColumnCount=function(e){this._columnCount=e},o.prototype.updateRowHeight=function(e){this._cellHeight=e},o.prototype.updateScalingFactor=function(e){this._scalingFactor=e,this._cellWidth=this.computeColumnWidth(this._columnCount)},o.prototype.updateViewport=function(e){this._viewport=e,this._cellWidth=this.computeColumnWidth(this._columnCount),this._cellHeight=this.computeColumnHeight()},o.prototype.computeColumnWidth=function(e){var t=this._scalingFactor;t||(t=1);var l=Math.floor(this._viewport.width/(t*o.TablixMinimumColumnWidth));return this.fitToColumnCount(l,e)},o.prototype.computeColumnHeight=function(){if(!this.hasImageContent)return this._cellHeight;var e=this._viewport.width;return e<=250?20:e<=510?51:e<=770?52:void L.fF.assertFail("Fixed size is only for viewport up to 770px width.")},o.prototype.fitToColumnCount=function(e,t){var i=Math.min(e,t);return Math.floor(this._viewport.width/i)},o.TablixMinimumColumnWidth=75,o}(),H=function(){function o(e,t,i){this._owner=e,this._grid=t,this._lastScrollOffset=null,this._isScrolling=!1,this._fixedSizeEnabled=!0,this._done=!1,this._realizationManager=i}return Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},set:function(t){this._owner=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"realizationManager",{get:function(){return this._realizationManager},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fixedSizeEnabled",{get:function(){return this._fixedSizeEnabled},set:function(t){this._fixedSizeEnabled=t},enumerable:!1,configurable:!0}),o.prototype.onCornerCellRealized=function(e,t,i){this._realizationManager.onCornerCellRealized(e,t)},o.prototype.onHeaderRealized=function(e,t,i){this._realizationManager.onHeaderRealized(e,t,i)},Object.defineProperty(o.prototype,"needsToRealize",{get:function(){return this._realizationManager.needsToRealize},enumerable:!1,configurable:!0}),o.prototype.getVisibleSizeRatio=function(){return 1-this.dimension.getFractionScrollOffset()},Object.defineProperty(o.prototype,"alignToEnd",{get:function(){return this._alignToEnd},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0}),o.prototype._requiresMeasure=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._requiresMeasure"),!0},o.prototype.startScrollingSession=function(){this._isScrolling=!0},o.prototype.endScrollingSession=function(){this._isScrolling=!1},o.prototype.isScrolling=function(){return this._isScrolling},o.prototype.isResizing=function(){return!1},o.prototype.getOtherHierarchyContextualHeight=function(){var t=this.dimension.otherDimension.getDepth(),i=0,l=this._getRealizedItems();if(l.length>0)for(var c=0;c<t;c++)i+=l[c].getContextualWidth();return i},o.prototype._isAutoSized=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._isAutoSized"),!1},o.prototype.onStartRenderingSession=function(){this._measureEnabled=this._requiresMeasure(),this._gridOffset=this.dimension.otherDimension.getDepth()},o.prototype.onEndRenderingSession=function(){this._realizationManager.onEndRenderingSession(),this._alignToEnd=!1,this._done=!1,this._measureEnabled=!0,this._sendDimensionsToControl()},o.prototype._sendDimensionsToControl=function(){L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._sendDimensionsToControl")},Object.defineProperty(o.prototype,"measureEnabled",{get:function(){return this._measureEnabled},enumerable:!1,configurable:!0}),o.prototype.getFooterContextualWidth=function(){return 0},o.prototype.onStartRenderingIteration=function(e,t){this._measureEnabled&&!this._done&&(this._contextualWidthToFill=(t-this.otherScrollbarContextualWidth)*this.getGridScale()-this.getFooterContextualWidth()),this._realizationManager.onStartRenderingIteration(),e?this._lastScrollOffset=null:null!==this._lastScrollOffset&&this.swapElements()},Object.defineProperty(o.prototype,"allItemsRealized",{get:function(){return this.getRealizedItemsCount()-this._gridOffset===this.dimension.getItemsCount()||0===this.dimension.getItemsCount()},enumerable:!1,configurable:!0}),o.prototype.onEndRenderingIteration=function(){if(!this._done){if(!this._measureEnabled)return this._lastScrollOffset=this.dimension.scrollOffset,void(this._done=!0);var l,e=this.getGridContextualWidth(),t=(0,D.bA)(e,this._contextualWidthToFill,o._pixelPrecision),i=this.allItemsRealized;l=t?this.scrollForwardToAlignEnd(e):this.scrollBackwardToFill(e),this._realizationManager.onEndRenderingIteration(e,t);var c=this.dimension.scrollbar.visible;this.updateScrollbar(e),this._done=(t||i)&&this.dimension.scrollbar.visible===c&&(0,D.GG)(l,this.dimension.scrollOffset,o._scrollOffsetPrecision),this.dimension.scrollOffset=l,this._lastScrollOffset=this.dimension.scrollOffset}},o.prototype.getScrollDeltaWithinPage=function(){if(null!==this._lastScrollOffset){var e=this.dimension.getIntegerScrollOffset()-Math.floor(this._lastScrollOffset);if(Math.abs(e)<this.getRealizedItemsCount()-this.dimension.otherDimension.getDepth())return e}return null},o.prototype.swapElements=function(){var e=this.getScrollDeltaWithinPage();if(null!==e){var t=this.dimension.otherDimension.getDepth();Math.abs(e)<this.getRealizedItemsCount()-t&&(e>0?this._moveElementsToBottom(t,e):e<0&&this._moveElementsToTop(t,-e))}},o.prototype._getRealizedItems=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._getRealizedItems"),null},o.prototype.getRealizedItemsCount=function(){return this._getRealizedItems().length},o.prototype._moveElementsToBottom=function(e,t){L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._moveElementsToBottom")},o.prototype._moveElementsToTop=function(e,t){L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._moveElementsToTop")},o.prototype.isScrollingWithinPage=function(){return null!==this.getScrollDeltaWithinPage()},o.prototype.getGridContextualWidth=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getGridContextualWidth"),0},o.prototype.updateScrollbar=function(e){var t=this.dimension.scrollbar;t.viewMin=this.dimension.scrollOffset,t.min=0,t.max=this.dimension.getItemsCount(),t.viewSize=this.getViewSize(e),this.dimension.scrollbar.show(this.canScroll(e))},o.prototype.getViewSize=function(e){var t=this.getRealizedItemsCount();if(0===t)return 0;for(var i=this._gridOffset,l=0,c=0,R=this._contextualWidthToFill-this.getOtherHierarchyContextualHeight(),T=this.getMeaurementError(e),f=i;f<t;f++){var F;F=f===i?this.getVisibleSizeRatio():1;var A=this.getItemContextualWidthWithScrolling(f)*T;if(l+=F,(0,D.aP)(c+=A,R,o._pixelPrecision)){l-=(c-R)/A*F;break}}return l},o.prototype.isScrollableHeader=function(e,t,i){if(0!==i||0===this.dimension.getFractionScrollOffset())return!1;var l=this.dimension._hierarchyNavigator;if(l.isLeaf(e))return!0;var c=e,C=t;do{if(C=l.getChildren(c),void 0===(c=this.dimension.getFirstVisibleItem(l.getLevel(c)+1)))break;if(!l.isLastItem(c,C))return!1}while(!l.isLeaf(c));return!0},o.prototype.reachedEnd=function(){return this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},o.prototype.scrollBackwardToFill=function(e){var t=this.dimension.scrollOffset;if(this.reachedEnd()){var i=this._contextualWidthToFill-e;if(this.dimension.getItemsCount()>0){var l=e/(this.getRealizedItemsCount()-this.dimension.getFractionScrollOffset());t=this.dimension.getValidScrollOffset(Math.floor(this.dimension.scrollOffset-i/l))}this._alignToEnd=!(0,D.GG)(t,this.dimension.scrollOffset,o._scrollOffsetPrecision)}return t},o.prototype.getItemContextualWidth=function(e){var t=this._getRealizedItems();return e>=t.length?null:t[e].getContextualWidth()},o.prototype.getItemContextualWidthWithScrolling=function(e){return this.getSizeWithScrolling(this.getItemContextualWidth(e),e)},o.prototype.getSizeWithScrolling=function(e,t){return e*(this._gridOffset===t?this.getVisibleSizeRatio():1)},o.prototype.getGridContextualWidthFromItems=function(){for(var e=this.getRealizedItemsCount(),t=0,i=0;i<e;i++)t+=this.getItemContextualWidthWithScrolling(i);return t},o.prototype.getMeaurementError=function(e){return e/this.getGridContextualWidthFromItems()},o.prototype.scrollForwardToAlignEnd=function(e){var t=this.dimension.scrollOffset;if(this._alignToEnd){var i=(0,D.GG)(e,this._contextualWidthToFill,o._pixelPrecision);if(!i)for(var l=this.getRealizedItemsCount(),c=this._gridOffset,C=e-this._contextualWidthToFill,R=this.getMeaurementError(e),T=c;T<l;T++){var f=this.getItemContextualWidth(T)*R;if(!(0,D.Po)(f,C,o._pixelPrecision)){var F=c===T?1-this.dimension.getFractionScrollOffset():1;t=this.dimension.getValidScrollOffset(this.dimension.scrollOffset+(T-c)+C*F/f);break}C-=f}this._alignToEnd=!i}return t},Object.defineProperty(o.prototype,"dimension",{get:function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.dimension"),null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"otherLayoutManager",{get:function(){return this.dimension.otherDimension.layoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contextualWidthToFill",{get:function(){return this._contextualWidthToFill},enumerable:!1,configurable:!0}),o.prototype.getGridScale=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getGridScale"),0},Object.defineProperty(o.prototype,"otherScrollbarContextualWidth",{get:function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.otherScrollbarContextualWidth"),0},enumerable:!1,configurable:!0}),o.prototype.getActualContextualWidth=function(e){return this._isAutoSized()&&!this.canScroll(e)?e:this._contextualWidthToFill},o.prototype.canScroll=function(e){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.canScroll"),!1},o.prototype.calculateSizes=function(){this.fixedSizeEnabled&&(this.calculateContextualWidths(),this.calculateSpans())},o.prototype._calculateSize=function(e){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._calculateSize"),null},o.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=e.length,i=0;i<t;i++){var l=e[i];this.measureEnabled&&l.setAligningContextualWidth(-1),this._calculateSize(l)}},o.prototype.calculateSpans=function(){this.measureEnabled&&(this.updateNonScrollableItemsSpans(),this.updateScrollableItemsSpans())},o.prototype.updateNonScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=e.length,l=this.dimension.getDepth();l<t;l++){var c=e[l];this.updateSpans(c,c.getHeaders(),!1)}},o.prototype.updateScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=Math.min(this.dimension.getDepth(),e.length),i=0;i<t;i++){var l=e[i];this.updateSpans(l,l.getOtherDimensionHeaders(),!0)}},o.prototype.fixSizes=function(){if(this.fixedSizeEnabled)for(var e=this._getRealizedItems(),i=e.length-1;i>=0;i--)e[i].fixSize()},o.prototype.updateSpans=function(e,t,i){for(var l=this._getRealizedItems(),c=t.length,C=0;C<c;C++){var R=t[C],T=e.getOtherDimensionOwner(R),f=T.getCellContextualSpan(R);if(f>1)for(var F=0,A=T.getIndex(this._grid),te=0;te<f;te++){var ae=l[te+A],J=ae.getContentContextualWidth();i&&0===C&&0===te&&(J=Math.floor((1-this.dimension.getFractionScrollOffset())*J)),F+=J,te===f-1&&this.updateLastChildSize(R,ae,F)}}},o.prototype.updateLastChildSize=function(e,t,i){var l=t.getCellIContentContextualWidth(e)-i;l>0&&t.setAligningContextualWidth(Math.max(t.getAligningContextualWidth(),l+t.getContentContextualWidth()))},o._pixelPrecision=1.0001,o._scrollOffsetPrecision=.01,o}(),k=function(){function o(e,t,i){this.column=e,this.item=e.getLeafItem(),this.itemType=e.itemType,this.startColumnWidth=t,this.resizingDelta=0,this.animationFrame=null,this.scale=i}return o.prototype.getNewSize=function(){return this.startColumnWidth+this.resizingDelta},o}(),X=function(o){function e(t,i,l){var c=o.call(this,t,i,l)||this;return l.owner=c,c.fillProportionally=!1,c._resizeState=null,c}return(0,O.__extends)(e,o),Object.defineProperty(e.prototype,"dimension",{get:function(){return this.owner.owner.columnDimension},enumerable:!1,configurable:!0}),e.prototype.isResizing=function(){return null!==this._resizeState},Object.defineProperty(e.prototype,"fillProportionally",{get:function(){return this._grid.fillColumnsProportionally},set:function(i){this._grid.fillColumnsProportionally=i},enumerable:!1,configurable:!0}),e.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioX()},Object.defineProperty(e.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?(0,M.mx)(this.dimension.otherDimension.scrollbar.element):0},enumerable:!1,configurable:!0}),e.prototype._getRealizedItems=function(){return this._grid.realizedColumns||(this._grid.realizedColumns=[]),this._grid.realizedColumns},e.prototype._moveElementsToBottom=function(t,i){this._grid.moveColumnsToEnd(t,i)},e.prototype._moveElementsToTop=function(t,i){this._grid.moveColumnsToStart(t,i)},e.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()||this.isScrolling()||this.isResizing()},e.prototype.getGridContextualWidth=function(){return this._grid.getWidth()},e.prototype.getFirstVisibleColumn=function(){return this._grid.realizedColumns[this._gridOffset]},e.prototype._isAutoSized=function(){return this.owner.owner.autoSizeWidth},e.prototype.applyScrolling=function(){var t=this.dimension.getFractionScrollOffset(),i=0,l=this.getFirstVisibleColumn();if(void 0!==l){i=l.getContextualWidth();var c=Math.ceil(-i*t);this.scroll(l,i,c)}},e.prototype.scroll=function(t,i,l){this.scrollCells(t._realizedColumnHeaders,i,l),this.scrollBodyCells(this._grid.realizedRows,i,l),null!==t.footer&&t.footer.scrollHorizontally(i,l)},e.prototype.scrollCells=function(t,i,l){for(var c=t.length,C=0;C<c;C++)t[C].scrollHorizontally(i,l)},e.prototype.scrollBodyCells=function(t,i,l){for(var C,R,c=t.length,T=0;T<c;T++)void 0!==(C=t[T]._realizedBodyCells)&&void 0!==(R=C[0])&&R.scrollHorizontally(i,l)},e.prototype.onStartResize=function(t,i,l){this._resizeState=new k(t._column,t._column.getContentContextualWidth(),(0,M.df)(this.owner.owner.container))},e.prototype.onResize=function(t,i,l){var c=this;this.isResizing()&&(this.owner.owner.wordWrapColumnHeaders&&t.unfixRowHeight(),this._resizeState.resizingDelta=Math.round(Math.max(i/this._resizeState.scale,e.minColumnWidth-this._resizeState.startColumnWidth)),null===this._resizeState.animationFrame&&(this._resizeState.animationFrame=requestAnimationFrame(function(){return c.performResizing()})))},e.prototype.onEndResize=function(t){this.isResizing()&&null!==this._resizeState.animationFrame&&this.performResizing(),this.endResizing(),this._resizeState=null},e.prototype.onReset=function(t){this.owner.owner.wordWrapColumnHeaders&&t.unfixRowHeight(),this._resizeState=new k(t._column,-1,1),t._column.clearSize(),this.endResizing(),this.owner.owner.refresh(!1),this._resizeState=null},e.prototype.updateItemToResizeState=function(t){if(null!==this._resizeState)for(var i=t.length,l=this.owner.owner.hierarchyNavigator,C=this.otherLayoutManager.dimension.getDepth();C<i;C++){var R=t[C];if(R.columnHeaderOrCornerEquals(this._resizeState.itemType,this._resizeState.item,R.itemType,R.getLeafItem(),l)&&R!==this._resizeState.column){this._resizeState.column=R,R.onResize(this._resizeState.getNewSize());break}}},e.prototype.performResizing=function(){if(null!==this._resizeState){this._resizeState.animationFrame=null;var t=this._resizeState.getNewSize();this._resizeState.column.onResize(t),this.owner.owner.refresh(!1)}},e.prototype.endResizing=function(){if(null!==this._resizeState){var t=this._resizeState.getNewSize();this._resizeState.column.onResizeEnd(t)}},e.prototype._sendDimensionsToControl=function(){var t=this.getGridContextualWidth(),i=this.getActualContextualWidth(t),l=this.getOtherHierarchyContextualHeight(),c=this.getGridScale();this.owner.owner.updateColumnDimensions(l/c,(i-l)/c,this.getViewSize(t))},e.prototype.getEstimatedHeaderWidth=function(t,i){return L.fF.assertFail("PureVirtualMethod: ColumnLayoutManager.getEstimatedHeaderWidth"),-1},e.prototype.getEstimatedBodyCellWidth=function(t){return L.fF.assertFail("PureVirtualMethod: ColumnLayoutManager.getEstimatedBodyCellWidth"),-1},e.minColumnWidth=10,e}(H),Q=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),e.prototype.getEstimatedHeaderWidth=function(t,i){return this.ignoreColumn(i)?0:this.owner.getCellWidth(void 0)},e.prototype.getEstimatedBodyCellWidth=function(t){return this.owner.getCellWidth(void 0)},e.prototype.canScroll=function(t){return!1},e.prototype._calculateSize=function(t){var i=t.getIndex(this._grid),l=0;return this.ignoreColumn(i)||(l=this.owner.getContentWidth(void 0)),t.onResize(l),t.onResizeEnd(l),l},e.prototype.ignoreColumn=function(t){return 0===t&&!this.owner.binder.hasRowGroups()},e}(X),se=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),e.prototype.getEstimatedHeaderWidth=function(t,i){return this.owner.getEstimatedTextWidth(t)},e.prototype.getEstimatedBodyCellWidth=function(t){return this.owner.getEstimatedTextWidth(t)},e.prototype.calculateContextualWidths=function(){for(var t=this._getRealizedItems(),i=[],l=0,c=t.length;l<c;l++){var C=t[l];this.measureEnabled&&C.setAligningContextualWidth(-1);var R=re.K.getColumnQueryName(C);null!=R&&i.push({queryName:R,width:this._calculateSize(C),isFixed:!1})}this.owner.columnWidthsToPersist=i},e.prototype.canScroll=function(t){return!(0,D.GG)(this.dimension.scrollOffset,0,H._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||(0,D.aP)(t,this._contextualWidthToFill,H._pixelPrecision)},e.prototype._calculateSize=function(t){return t.calculateSize()},e}(X),ue=function(o){function e(t,i,l){var c=o.call(this,t,i,l)||this;return l.owner=c,c}return(0,O.__extends)(e,o),Object.defineProperty(e.prototype,"dimension",{get:function(){return this.owner.owner.rowDimension},enumerable:!1,configurable:!0}),e.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioY()},Object.defineProperty(e.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?(0,M.Uy)(this.dimension.otherDimension.scrollbar.element):0},enumerable:!1,configurable:!0}),e.prototype.startScrollingSession=function(){o.prototype.startScrollingSession.call(this)},e.prototype._getRealizedItems=function(){return this._grid.realizedRows||(this._grid.realizedRows=[]),this._grid.realizedRows},e.prototype._moveElementsToBottom=function(t,i){this._grid.moveRowsToEnd(t,i)},e.prototype._moveElementsToTop=function(t,i){this._grid.moveRowsToStart(t,i)},e.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()&&!this.otherLayoutManager.isResizing()||this.isScrolling()&&this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},e.prototype.getGridContextualWidth=function(){return this._grid.getHeight()},e.prototype.getFirstVisibleRow=function(){return this._grid.realizedRows[this._gridOffset]},e.prototype._isAutoSized=function(){return this.owner.owner.autoSizeHeight},e.prototype.applyScrolling=function(){var t=this.dimension.getFractionScrollOffset(),i=0,l=this.getFirstVisibleRow();l&&(i=l.getContextualWidth(),this.scroll(l,i,t))},e.prototype.scroll=function(t,i,l){this.scrollCells(t._realizedRowHeaders,i,l),this.scrollCells(t._realizedBodyCells,i,l)},e.prototype.scrollCells=function(t,i,l){for(var c=t.length,C=0;C<c;C++)t[C].scrollVertically(i,l)},e.prototype.getFooterContextualWidth=function(){return this.owner.owner.rowDimension.hasFooter()&&this.owner.grid.footerRow?this.owner.grid.footerRow.getContextualWidth():0},e.prototype.calculateContextualWidths=function(){if(o.prototype.calculateContextualWidths.call(this),this.fixedSizeEnabled){var t=this._grid.footerRow;t&&this._calculateSize(t)}},e.prototype.fixSizes=function(){o.prototype.fixSizes.call(this),this.fixedSizeEnabled&&this._grid.footerRow&&this._grid.footerRow.fixSize()},e.prototype._sendDimensionsToControl=function(){var t=this.getGridContextualWidth(),i=this.getActualContextualWidth(t),l=this.getOtherHierarchyContextualHeight(),c=this.getGridScale();this.owner.owner.updateRowDimensions(l/c,(i-l)/c,t/c,this.getViewSize(t),this._grid.footerRow?this._grid.footerRow.getContextualWidth()/c:0)},e.prototype.getEstimatedHeaderWidth=function(t,i){return L.fF.assertFail("PureVirtualMethod: RowLayoutManager.getEstimatedHeaderWidth"),-1},e}(H),pe=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),e.prototype.getEstimatedHeaderWidth=function(t,i){return this.getHeaderWidth(i)},e.prototype.canScroll=function(t){return!1},e.prototype._calculateSize=function(t){return t.calculateSize()},e.prototype.getHeaderWidth=function(t){return 0!==t||this.owner.binder.hasRowGroups()?this.owner.getEstimatedTextWidth(void 0):0},e}(ue),xe=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),e.prototype.getEstimatedHeaderWidth=function(t,i){return this.owner.getEstimatedTextWidth(t)},e.prototype.canScroll=function(t){return!(0,D.GG)(this.dimension.scrollOffset,0,H._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||(0,D.aP)(t,this._contextualWidthToFill,H._pixelPrecision)},e.prototype._calculateSize=function(t){return t.calculateSize()},e}(ue),we=function(){function o(e,t,i,l){this._allowHeaderResize=!0,this._binder=e,this._grid=t,this._columnLayoutManager=i,this._rowLayoutManager=l,this._columnWidthsToPersist=[]}return o.prototype.initialize=function(e){this._owner=e,this._container=e.container,this._gridHost=e.contentHost,this._footersHost=e.footerHost,this._grid.initialize(e,this._gridHost,this._footersHost)},Object.defineProperty(o.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"binder",{get:function(){return this._binder},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"columnWidthsToPersist",{get:function(){return this._columnWidthsToPersist},set:function(t){this._columnWidthsToPersist=t},enumerable:!1,configurable:!0}),o.prototype.getTablixClassName=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getTablixClassName"),null},o.prototype.getLayoutKind=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getLayoutKind"),null},o.prototype.getOrCreateColumnHeader=function(e,t,i,l){var c=this.owner.hierarchyNavigator,C=this._grid.getOrCreateRow(i),R=this._grid.getOrCreateColumn(l+this._columnLayoutManager._gridOffset),T=c.isLeaf(e),f=C.getOrCreateColumnHeader(R,this._columnLayoutManager.isScrollableHeader(e,t,l),T),F=c.getLevel(e);f.position.row.index=f.position.row.indexInSiblings=F,f.position.row.isFirst=0===F,f.position.row.isLast=T;var A=c.getIndex(e);return f.position.column.index=f.position.column.indexInSiblings=A,f.position.column.isFirst=c.areAllParentsFirst(e,t),f.position.column.isLast=c.areAllParentsLast(e,t),this.enableCellHorizontalResize(T,f),f},o.prototype.getOrCreateRowHeader=function(e,t,i,l){var c=this.owner.hierarchyNavigator,C=this._grid.getOrCreateRow(i+this._rowLayoutManager._gridOffset),R=this._grid.getOrCreateColumn(l),T=c.isLeaf(e),f=this._rowLayoutManager.isScrollableHeader(e,t,i);0===C.getRealizedCellCount()&&this.alignRowHeaderCells(e,C);var F=C.getOrCreateRowHeader(R,f,c.isLeaf(e)),A=c.getIndex(e);F.position.row.index=F.position.row.indexInSiblings=A,F.position.row.isFirst=c.areAllParentsFirst(e,t),F.position.row.isLast=c.areAllParentsLast(e,t);var te=c.getLevel(e);return F.position.column.index=F.position.column.indexInSiblings=te,F.position.column.isFirst=0===te,F.position.column.isLast=T,F.enableHorizontalResize(!1,this._columnLayoutManager),F},o.prototype.getOrCreateCornerCell=function(e,t,i){var l=this._grid.getOrCreateRow(i),c=this._grid.getOrCreateColumn(t),R=i===this._columnLayoutManager.dimension.getDepth()-1,T=l.getOrCreateCornerCell(c),f=i;T.position.row.index=T.position.row.indexInSiblings=f,T.position.row.isFirst=0===f,T.position.row.isLast=R;var F=t;return T.position.column.index=T.position.column.indexInSiblings=F,T.position.column.isFirst=0===F,T.position.column.isLast=F===this._rowLayoutManager.dimension.getDepth()-1,this.enableCellHorizontalResize(R,T),T},o.prototype.getOrCreateBodyCell=function(e,t,i,l,c){var C,R=this._grid.getOrCreateRow(l+this._rowLayoutManager._gridOffset),T=this._grid.getOrCreateColumn(c+this._columnLayoutManager._gridOffset);C=0===R._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset()||this._rowLayoutManager.isScrollableHeader(t,i,l);var f=R.getOrCreateBodyCell(T,C);return f.position=e.position,f.enableHorizontalResize(!1,this._columnLayoutManager),f},o.prototype.getOrCreateFooterBodyCell=function(e,t){var i,l=this._grid.getOrCreateFootersRow(),c=this._grid.getOrCreateColumn(t+this._columnLayoutManager._gridOffset);i=0===l._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset();var C=l.getOrCreateFooterBodyCell(c,i);return C.position=e.position,C.enableHorizontalResize(!1,this._columnLayoutManager),C},o.prototype.getOrCreateFooterRowHeader=function(e,t){var i=this._grid.getOrCreateFootersRow(),l=this._grid.getOrCreateColumn(0),c=i.getOrCreateFooterRowHeader(l);return c.position=void 0,c.enableHorizontalResize(!1,this._columnLayoutManager),c},o.prototype.getVisibleWidth=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getVisibleWidth"),-1},o.prototype.getVisibleHeight=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getVisibleHeight"),-1},o.prototype.updateColumnCount=function(e,t){L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.updateColumnCount")},o.prototype.updateViewport=function(e){L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.updateViewport")},o.prototype.getEstimatedRowHeight=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getEstimatedRowHeight"),-1},o.prototype.getCellWidth=function(e){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getCellWidth"),-1},o.prototype.getContentWidth=function(e){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getContentWidth"),-1},o.prototype.adjustContentSize=function(e){},o.prototype.alignRowHeaderCells=function(e,t){var i=t.getRowHeaderLeafIndex();if(-1!==i){var c=this._owner.rowDimension.getFirstVisibleChildLeaf(e);this.owner.hierarchyNavigator.headerItemEquals(c,t.getAllocatedCellAt(i).item)&&t.moveCellsBy(this.owner.hierarchyNavigator.getLevel(c)-this.owner.hierarchyNavigator.getLevel(e)-i)}},Object.defineProperty(o.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"rowLayoutManager",{get:function(){return this._rowLayoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"columnLayoutManager",{get:function(){return this._columnLayoutManager},enumerable:!1,configurable:!0}),o.prototype.showEmptySpaceHeader=function(){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.showEmptySpaceHeader"),!1},o.prototype.onStartRenderingSession=function(e,t,i){if(this.showEmptySpaceHeader()){var l=this._grid.emptySpaceHeaderCell;l&&this._binder.unbindEmptySpaceHeaderCell(l),(l=this._grid.emptySpaceFooterCell)&&this._binder.unbindEmptySpaceFooterCell(l),this._grid.HideEmptySpaceCells()}this._scrollingDimension=e,this._scrollingDimension&&this._scrollingDimension.layoutManager.startScrollingSession(),this._rowLayoutManager.onStartRenderingSession(),this._columnLayoutManager.onStartRenderingSession(),this._grid.onStartRenderingSession(i),(this._columnLayoutManager.measureEnabled||this._rowLayoutManager.measureEnabled)&&this.measureSampleText(t)},o.prototype.onEndRenderingSession=function(){if(this._rowLayoutManager.onEndRenderingSession(),this._columnLayoutManager.onEndRenderingSession(),this._scrollingDimension&&this._scrollingDimension.layoutManager.endScrollingSession(),this._scrollingDimension=null,this.showEmptySpaceHeader()){var e=this._columnLayoutManager.contextualWidthToFill-this._columnLayoutManager.getGridContextualWidth();if(e>0){this._grid.ShowEmptySpaceCells(this._owner.columnDimension.getDepth(),e);var t=this._grid.emptySpaceHeaderCell;t&&this._binder.bindEmptySpaceHeaderCell(t),(t=this._grid.emptySpaceFooterCell)&&this._binder.bindEmptySpaceFooterCell(t)}}},o.prototype.onStartRenderingIteration=function(e){this._rowLayoutManager.onStartRenderingIteration(e,this.getVisibleHeight()),this._columnLayoutManager.onStartRenderingIteration(e,this.getVisibleWidth()),this._grid.onStartRenderingIteration()},o.prototype.onEndRenderingIteration=function(){return this._grid.onEndRenderingIteration(),this._columnLayoutManager.calculateSizes(),this._rowLayoutManager.calculateSizes(),this._columnLayoutManager.fixSizes(),this._rowLayoutManager.fixSizes(),this._columnLayoutManager.updateItemToResizeState(this._grid.realizedColumns),this._columnLayoutManager.applyScrolling(),this._rowLayoutManager.applyScrolling(),this._columnLayoutManager.onEndRenderingIteration(),this._rowLayoutManager.onEndRenderingIteration(),this._columnLayoutManager.done&&this._rowLayoutManager.done},o.prototype.onCornerCellRealized=function(e,t){var i=this.owner.hierarchyNavigator.isColumnHierarchyLeaf(e),l=this.owner.hierarchyNavigator.isRowHierarchyLeaf(e);i&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onCornerCellRealized(e,t,i),this._rowLayoutManager.onCornerCellRealized(e,t,l)},o.prototype.onRowHeaderRealized=function(e,t){var l=this._owner.hierarchyNavigator.isLeaf(e);t.colSpan>1&&t.setContainerWidth(-1),this._rowLayoutManager.onHeaderRealized(e,t,l)},o.prototype.onRowHeaderFooterRealized=function(e,t){},o.prototype.onColumnHeaderRealized=function(e,t){var l=this._owner.hierarchyNavigator.isLeaf(e);l&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onHeaderRealized(e,t,l)},o.prototype.onBodyCellRealized=function(e,t){},o.prototype.onBodyCellFooterRealized=function(e,t){},o.prototype.setAllowHeaderResize=function(e){this._allowHeaderResize=e},o.prototype.enableCellHorizontalResize=function(e,t){t.enableHorizontalResize(e&&this._allowHeaderResize,this._columnLayoutManager)},o.prototype.getEstimatedTextWidth=function(e){return L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getEstimatedTextWidth"),-1},o.prototype.measureSampleText=function(e){L.fF.assertFail("PureVirtualMethod: TablixLayoutManager.measureSampleText")},o}(),B=function(o){function e(t,i,l,c,C){var R=this,T=new Q(null,l,C),f=new pe(null,l,c);return R=o.call(this,t,l,T,f)||this,T.owner=R,f.owner=R,R._sizeComputationManager=i,R}return(0,O.__extends)(e,o),e.createLayoutManager=function(t){var i=new b;return new e(t,i,new V(new s(i)),new d(t),new y(t))},e.prototype.getTablixClassName=function(){return"tablixDashboard"},e.prototype.getLayoutKind=function(){return 1},e.prototype.showEmptySpaceHeader=function(){return!1},e.prototype.measureSampleText=function(t){var i=Z.b.getSvgMeasurementProperties(t);this._characterHeight=Z.b.estimateSvgTextHeight(i),this._sizeComputationManager.updateRowHeight(this._characterHeight);var l=ie.FP.toPoint(parseFloat(i.fontSize));this._sizeComputationManager.updateScalingFactor((0,D.GW)(l/ee.L,.05))},e.prototype.getVisibleWidth=function(){return this._sizeComputationManager.visibleWidth},e.prototype.getVisibleHeight=function(){return this._sizeComputationManager.visibleHeight},e.prototype.getCellWidth=function(t){return this._sizeComputationManager.cellWidth},e.prototype.getContentWidth=function(t){return this._sizeComputationManager.contentWidth},e.prototype.getEstimatedTextWidth=function(t){return this._sizeComputationManager.contentWidth},e.prototype.adjustContentSize=function(t){this._sizeComputationManager.hasImageContent=t},e.prototype.updateColumnCount=function(t,i){var C=(t?t.getDepth():0)+(i?i.getItemsCount():0);this.binder.hasRowGroups()||C--,this._sizeComputationManager.updateColumnCount(C)},e.prototype.updateViewport=function(t){this._sizeComputationManager.updateViewport(t)},e.prototype.getEstimatedRowHeight=function(){return this._characterHeight},e}(we),p=function(o){function e(t,i,l,c){var C,R=new se(null,i,c),T=new xe(null,i,l);return C=o.call(this,t,i,R,T)||this,R.owner=C,T.owner=C,C}return(0,O.__extends)(e,o),e.createLayoutManager=function(t,i){return new e(t,new V(new n(i)),new d(t),new y(t))},e.prototype.getTablixClassName=function(){return"tablixCanvas"},e.prototype.getLayoutKind=function(){return 0},e.prototype.measureSampleText=function(t){var i=(0,M.wC)();i.style.cssFloat="left",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.lineHeight="normal",t.appendChild(i);var l=document.createTextNode("a");i.appendChild(l),this.characterWidth=(0,M.mx)(i),this.characterHeight=(0,M.Uy)(i),i.removeChild(l),t.removeChild(i)},e.prototype.showEmptySpaceHeader=function(){return!this._columnLayoutManager.fillProportionally},e.prototype.getVisibleWidth=function(){return this._columnLayoutManager.measureEnabled?this._owner.autoSizeWidth&&this._owner.maxWidth?this._owner.maxWidth:(0,M.mx)(this._container):-1},e.prototype.getVisibleHeight=function(){return this._rowLayoutManager.measureEnabled?this._owner.autoSizeHeight&&this._owner.maxHeight?this._owner.maxHeight:(0,M.Uy)(this._container):-1},e.prototype.getCellWidth=function(t){return t.containerWidth},e.prototype.getContentWidth=function(t){return t.contentWidth},e.prototype.getEstimatedTextWidth=function(t){return t?t.length*this.characterWidth:0},e.prototype.updateColumnCount=function(t,i){},e.prototype.updateViewport=function(t){},e.prototype.getEstimatedRowHeight=function(){return this.characterHeight},e}(we),a=function(){function o(e){this._binder=e,this._adjustmentFactor=1}return o.prototype._getOwner=function(){return L.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getOwner"),null},Object.defineProperty(o.prototype,"binder",{get:function(){return this._binder},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"adjustmentFactor",{get:function(){return this._adjustmentFactor},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"itemsToRealizeCount",{get:function(){return this._itemsToRealizeCount},set:function(t){this._itemsToRealizeCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"itemsEstimatedContextualWidth",{get:function(){return this._itemsEstimatedContextualWidth},set:function(t){this._itemsEstimatedContextualWidth=t},enumerable:!1,configurable:!0}),o.prototype.onStartRenderingIteration=function(){var e=this._getOwner();e.measureEnabled&&!e.done&&this._getEstimatedItemsToRealizeCount(),this._realizedLeavesCount=0},o.prototype.onEndRenderingIteration=function(e,t){!t&&!this._getOwner().allItemsRealized&&(this._adjustmentFactor*=this._getSizeAdjustment(e))},o.prototype.onEndRenderingSession=function(){this._adjustmentFactor=1},o.prototype.onCornerCellRealized=function(e,t){},o.prototype.onHeaderRealized=function(e,t,i){i&&this._realizedLeavesCount++},Object.defineProperty(o.prototype,"needsToRealize",{get:function(){return this._realizedLeavesCount<this._itemsToRealizeCount},enumerable:!1,configurable:!0}),o.prototype._getEstimatedItemsToRealizeCount=function(){L.fF.assertFail("PureVirtualMethod: TablixDimensionRealizationManager._calculateItemsToRealize")},o.prototype._getSizeAdjustment=function(e){return L.fF.assertFail("PureVirtualMethod: TablixDimensionRealizationManager._getSizeAdjustment"),1},o}(),d=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),Object.defineProperty(e.prototype,"owner",{set:function(i){this._owner=i},enumerable:!1,configurable:!0}),e.prototype._getOwner=function(){return this._owner},e.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateRowsToRealizeCount()},e.prototype.estimateRowsToRealizeCount=function(){L.fF.assertValue(this._owner,"_owner"),this.itemsToRealizeCount=this._owner.dimension.model?this._owner.alignToEnd?this._owner.dimension.getItemsCount()-this._owner.dimension.getIntegerScrollOffset()+1:Math.ceil(this._owner.contextualWidthToFill/(this._owner.owner.getEstimatedRowHeight()*this.adjustmentFactor)+this._owner.dimension.getFractionScrollOffset())-this._owner.otherLayoutManager.dimension.getDepth()+1:0},e.prototype.getEstimatedRowHierarchyWidth=function(){if(!this._owner.dimension.model||0===this._owner.dimension.getItemsCount())return 0;var t=new m;this.updateRowHiearchyEstimatedWidth(this._owner.dimension.model,this._owner.dimension._hierarchyNavigator.getIndex(this._owner.dimension.getFirstVisibleItem(0)),t);for(var i=t.items,l=i.length,c=0,C=0;C<l;C++){var R=i[C];c+=0!==R.maxNonLeafWidth?R.maxNonLeafWidth:R.maxLeafWidth}return c},e.prototype.updateRowHiearchyEstimatedWidth=function(t,i,l){if(!(i<0))for(var c=this._owner.owner.owner.hierarchyNavigator,C=this.binder,R=c.getCount(t),T=i;T<R;T++){if(l.leafCount===this.itemsToRealizeCount)return;var f=c.getAt(t,T),F=C.getHeaderLabel(f),A=this._owner.getEstimatedHeaderWidth(F,i),te=c.isLeaf(f),ae=c.getLevel(f),J=l.items[ae];J||(J=new h,l.items[ae]=J),te?(J.maxLeafWidth=Math.max(J.maxLeafWidth,A),l.leafCount=l.leafCount+1):(J.maxNonLeafWidth=Math.max(J.maxNonLeafWidth,A),this.updateRowHiearchyEstimatedWidth(c.getChildren(f),this._owner.dimension.getFirstVisibleChildIndex(f),l))}},e.prototype._getSizeAdjustment=function(t){return t/((this._owner.getRealizedItemsCount()-this._owner.dimension.getFractionScrollOffset())*this._owner.owner.getEstimatedRowHeight())},e}(a),y=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return(0,O.__extends)(e,o),Object.defineProperty(e.prototype,"owner",{set:function(i){this._owner=i},enumerable:!1,configurable:!0}),e.prototype._getOwner=function(){return this._owner},e.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateColumnsToRealizeCount(this.getEstimatedRowHierarchyWidth())},Object.defineProperty(e.prototype,"rowRealizationManager",{get:function(){return this._owner.otherLayoutManager.realizationManager},enumerable:!1,configurable:!0}),e.prototype.getEstimatedRowHierarchyWidth=function(){return this._owner.otherLayoutManager.done?this._owner.getOtherHierarchyContextualHeight():this.rowRealizationManager.getEstimatedRowHierarchyWidth()*this.adjustmentFactor},e.prototype.estimateColumnsToRealizeCount=function(t){var i=this._owner.contextualWidthToFill-t;if(this._owner.dimension.model&&!(0,D.bl)(i,0,H._pixelPrecision)){var l=this.binder,c=this._owner.owner.owner.hierarchyNavigator,C=this._owner.dimension.getIntegerScrollOffset(),R=this._owner.dimension.getItemsCount(),T=R-C,f=this._owner.otherLayoutManager.dimension.getIntegerScrollOffset(),F=this._owner.otherLayoutManager.dimension.getItemsCount();if(this.itemsEstimatedContextualWidth=0,this._owner.alignToEnd)this.itemsToRealizeCount=T;else{for(var A=C;A<R;A++){if((0,D.bA)(this.itemsEstimatedContextualWidth,i,H._pixelPrecision))return void(this.itemsToRealizeCount=A-C);var ae,te=0;ae=A===C?this._owner.getVisibleSizeRatio():1;var J=c.getLeafAt(this._owner.dimension.model,A),ne=l.getHeaderLabel(J);te=Math.max(te,this._owner.getEstimatedHeaderWidth(ne,A));for(var he=f;he<F;he++){var de=c.getIntersection(c.getLeafAt(this._owner.otherLayoutManager.dimension.model,he),J);ne=l.getCellContent(de),te=Math.max(te,this._owner.getEstimatedBodyCellWidth(ne))}this.itemsEstimatedContextualWidth+=te*ae*this.adjustmentFactor}this.itemsToRealizeCount=T}}else this.itemsToRealizeCount=0},e.prototype._getSizeAdjustment=function(t){return t/(this.getEstimatedRowHierarchyWidth()+this.itemsEstimatedContextualWidth)},e}(a),m=function(){return function(){this.items=[],this.leafCount=0}}(),h=function(){return function(){this.maxLeafWidth=0,this.maxNonLeafWidth=0}}()},42737:function(Fe,fe,E){E.d(fe,{A:function(){return L}});var O=E(62458),L=function(){function D(Z,ie){this._element=Z,this._handler=ie,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return D.addDocumentMouseUpEvent=function(Z){document.addEventListener("mouseup",Z)},D.removeDocumentMouseUpEvent=function(Z){document.removeEventListener("mouseup",Z)},D.addDocumentMouseMoveEvent=function(Z){document.addEventListener("mousemove",Z)},D.removeDocumentMouseMoveEvent=function(Z){document.removeEventListener("mousemove",Z)},D.getMouseCoordinates=function(Z){return{x:Z.pageX,y:Z.pageY}},D.getMouseCoordinateDelta=function(Z,ie){return{x:ie.x-Z.x,y:ie.y-Z.y}},D.prototype.initialize=function(){var Z=this;this._elementMouseDownWrapper=function(ie){return Z.onElementMouseDown(ie)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(ie){return Z.onElementMouseMove(ie)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(ie){return Z.onElementMouseOut(ie)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(ie){return Z.onElementMouseDoubleClick(ie)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},D.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(D.prototype,"cell",{get:function(){return O.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),D.prototype._hotSpot=function(Z){return O.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},D.prototype.onElementMouseDown=function(Z){var ie=this,re=D.getMouseCoordinates(Z);this._hotSpot(re)&&(Z.cancelBubble=!0,this._startMousePosition=re,this._documentMouseMoveWrapper=function(ee){return ie.onDocumentMouseMove(ee)},D.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(ee){return ie.onDocumentMouseUp(ee)},D.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=D.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},D.prototype.onElementMouseMove=function(Z){this._startMousePosition||(this._hotSpot(D.getMouseCoordinates(Z))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=D.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},D.prototype.onElementMouseOut=function(Z){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},D.prototype.onElementMouseDoubleClick=function(Z){this._hotSpot(D.getMouseCoordinates(Z))&&this._handler.onReset(this.cell)},D.prototype.onDocumentMouseMove=function(Z){if(this._startMousePosition){var ie=D.getMouseCoordinateDelta(this._startMousePosition,D.getMouseCoordinates(Z));this._handler.onResize(this.cell,ie.x,ie.y),Z.preventDefault()}},D.prototype.onDocumentMouseUp=function(Z){this._startMousePosition=null,D.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,D.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),Z.preventDefault&&Z.preventDefault(),this._handler.onEndResize(this.cell)},D.resizeHandleSize=4,D.resizeCursor="e-resize",D}()},93340:function(Fe,fe,E){E.d(fe,{AB:function(){return we},Av:function(){return l},Ch:function(){return p},D4:function(){return V},D6:function(){return C},DM:function(){return xe},FX:function(){return v},G9:function(){return ue},Hd:function(){return ne},Hx:function(){return y},Iw:function(){return x},MN:function(){return h},Or:function(){return t},Pb:function(){return Y},Py:function(){return z},R5:function(){return se},RP:function(){return o},Uy:function(){return W},W_:function(){return k},Y1:function(){return i},Y4:function(){return f},aP:function(){return pe},df:function(){return N},ey:function(){return Q},hn:function(){return u},jG:function(){return H},jT:function(){return he},mx:function(){return U},om:function(){return g},pW:function(){return F},qZ:function(){return s},ri:function(){return b},ut:function(){return K},v4:function(){return B},vU:function(){return d},wC:function(){return X},wX:function(){return e},x7:function(){return c},xl:function(){return a}});var O=E(54522),L=E(91358),D=E(44977),Z=E(38308),ie=E(62458),re=E(6444),ee=E(64329),M=E(48066),j=E(28326),le=E(42737),r=E(71090);function V(w){if(w)for(;w.hasChildNodes();)w.removeChild(w.firstChild)}function v(w,P){w.style.top=P+"px"}function u(w,P){w.style.left=P+"px"}function x(w,P){w.style.height=S(P)?"":P+"px"}function z(w,P){w.style.width=S(P)?"":P+"px"}function U(w){return w.offsetWidth}function W(w){return w.offsetHeight}function S(w){return-1===w}function N(w){var P=w.offsetWidth;return 0===P?1:w.getBoundingClientRect().width/P}function K(w,P){var I=w.getBoundingClientRect(),G=N(w);return{x:(P.pageX-I.left)/G,y:(P.pageY-I.top)/G}}var Y=function(w){return w[w.Outline=0]="Outline",w[w.Gridline=1]="Gridline",w}({}),g=function(){function w(P,I){this.applyParams(!0,P,I)}return w.prototype.applyParams=function(P,I,G,q){P?(this.weight=I??0,this.color=G??"black",this.type=q??Y.Gridline):(this.weight=0,this.color="black",this.type=Y.Gridline)},w.prototype.getCSS=function(){var P=[];return _.isNumber(this.weight)&&(P.push(this.weight+r.wH),this.color&&P.push(this.color),P.push("solid")),P.join(" ")},w.prototype.getPriority=function(P){return this===P.top||this===P.bottom?this.type===Y.Outline?2:0:this===P.right||this===P.left?this.type===Y.Outline?3:1:-1},w.prototype.getShadowCss=function(P,I){var q=this.weight?this.weight+5:0,me="inset ";if(this===P.left)me+=q+r.wH+" 0";else if(this===P.right)me+="-"+Math.min(q,I+5)+r.wH+" 0";else if(this===P.top)me+="0 "+q+r.wH;else{if(this!==P.bottom)return"";me+="0 -"+q+r.wH}return me+" 0 -".concat(5,"px ")+this.color},w}(),s=function(){function w(P,I){void 0===P&&(P=r.YR),void 0===I&&(I=r.rJ),this.borders={},this.paddings={top:0,left:P,bottom:0,right:I},this.fontColor="",this.fontFamily="",this.backColor=""}return w.prototype.applyStyle=function(P){var G=P.extension.contentHost.style;G.fontFamily=this.fontFamily,G.fontSize=this.fontSize?ee.FP.toString(this.fontSize.px):void 0,G.fontWeight=this.fontWeight,G.fontStyle=this.fontStyle,G.textDecoration=this.textDecoration,G.color=this.fontColor,G.backgroundColor=this.backColor,G.boxShadow=this.getBoxShadow(),G.border="none",G.paddingTop=this.getPaddingTop(),G.paddingRight=this.getPaddingRight(),G.paddingBottom=this.getPaddingBottom(),G.paddingLeft=this.getPaddingLeft(),G.maxWidth=this.maxWidth},w.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+r.wH},w.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+r.wH},w.prototype.getPaddingRight=function(){return(this.paddings.right??r.rJ)+(null==this.borders.right?0:this.borders.right.weight)+r.wH},w.prototype.getPaddingLeft=function(){return(this.paddings.left??r.YR)+(null==this.borders.left?0:this.borders.left.weight)+r.wH},w.prototype.getBoxShadow=function(P){var I,G,q,oe,me,Me,Se,Te,_e=[];return(null===(I=this.borders.left)||void 0===I?void 0:I.type)===Y.Outline&&0!==this.borders.left.weight&&_e.push(this.borders.left.getShadowCss(this.borders)),(null===(G=this.borders.right)||void 0===G?void 0:G.type)===Y.Outline&&0!==this.borders.right.weight&&0!==P&&_e.push(this.borders.right.getShadowCss(this.borders,P)),(null===(q=this.borders.bottom)||void 0===q?void 0:q.type)===Y.Outline&&0!==this.borders.bottom.weight&&_e.push(this.borders.bottom.getShadowCss(this.borders)),(null===(oe=this.borders.top)||void 0===oe?void 0:oe.type)===Y.Outline&&0!==this.borders.top.weight&&_e.push(this.borders.top.getShadowCss(this.borders)),(null===(me=this.borders.left)||void 0===me?void 0:me.type)===Y.Gridline&&0!==this.borders.left.weight&&_e.push(this.borders.left.getShadowCss(this.borders)),(null===(Me=this.borders.right)||void 0===Me?void 0:Me.type)===Y.Gridline&&0!==this.borders.right.weight&&0!==P&&_e.push(this.borders.right.getShadowCss(this.borders,P)),(null===(Se=this.borders.bottom)||void 0===Se?void 0:Se.type)===Y.Gridline&&0!==this.borders.bottom.weight&&_e.push(this.borders.bottom.getShadowCss(this.borders)),(null===(Te=this.borders.top)||void 0===Te?void 0:Te.type)===Y.Gridline&&0!==this.borders.top.weight&&_e.push(this.borders.top.getShadowCss(this.borders)),_e.join(", ")},w.prototype.setAttributes=function(P,I,G,q,oe){if(P["padding-top"]=this.getPaddingTop(),P["padding-right"]=this.getPaddingRight(),P["padding-bottom"]=this.getPaddingBottom(),P["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(P["font-family"]=this.fontFamily),null!=this.fontSize&&(P["font-size"]=ee.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(P["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(P["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(P["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(P.color=this.fontColor),_.isEmpty(this.backColor)||(P["background-color"]=this.backColor),q||!I&&!G){var me=parseFloat(this.getPaddingLeft()),Me=parseFloat(this.getPaddingRight()),Se=this.getRightBorderMax(oe,me,Me),Te=this.getBoxShadow(Se);_.isEmpty(Te)||(P["box-shadow"]=Te)}_.isEmpty(this.maxWidth)||(P["max-width"]=this.maxWidth),(I||G)&&(P["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",P["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",P["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",P["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},w.prototype.getRightBorderMax=function(P,I,G){if(null==P)return G;var q=Math.max(P-I,0);return Math.min(G,q)},w.prototype.getAttributes=function(P,I,G,q){var oe={};return this.setAttributes(oe,P,I,G,q),oe},w.prototype.getExtraTop=function(){var P=0;return this.paddings.top&&(P+=this.paddings.top),this.borders.top&&(P+=this.borders.top.weight),P},w.prototype.getExtraBottom=function(){var P=0;return this.paddings.bottom&&(P+=this.paddings.bottom),this.borders.bottom&&(P+=this.borders.bottom.weight),P},w.prototype.getExtraRight=function(){var P=0;return this.paddings.right&&(P+=this.paddings.right),this.borders.right&&(P+=this.borders.right.weight),P},w.prototype.getExtraLeft=function(){var P=0;return this.paddings.left&&(P+=this.paddings.left),this.borders.left&&(P+=this.borders.left.weight),P},w}(),n=function(){return function(){}}(),b=function(){function w(){this.row=new n,this.column=new n}return w.prototype.isMatch=function(P){return this.column.index===P.column.index&&this.row.index===P.row.index},w}(),H=function(){function w(P,I,G,q,oe,me,Me,Se,Te,_e,Ve){this.dataPoint=P,this.objects=I,this.isRowSubTotal=G,this.isColumnSubTotal=q,this.isRowGrandTotal=oe,this.isColumnGrandTotal=me,this.isBlankRow=Me,this.columnMetadata=Se,this.formatter=Te,this.tooltipFormatter=_e,this.type=Ve,this.position=new b,this.cachedTextContent=Te?this.formatter.format(P,I):null!=this.dataPoint?P:""}return Object.defineProperty(w.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isKpi",{get:function(){return this.columnMetadata&&i(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(w,P){ie.fF.assertValue(w,"kpi"),ie.fF.assertValue(P,"kpiValue");var I=(0,L.sq)(w,P)||"";return(0,Z.hi)().addClass(I).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,O.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,O.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isValidUrl",{get:function(){return h(this.columnMetadata,this.textContent)!==M.av.NONE},enumerable:!1,configurable:!0}),w.prototype.isMatch=function(P){return this.position.isMatch(P.position)&&this.backColor===P.backColor},w}();function k(){return document.createElement("table")}function X(){var w=document.createElement("div");return w.className=r.rz,w}function Q(w){w.extension.contentElement.className=r.rz+" "+r.en,w.extension.contentHost.className=r.rz+" "+r.Pr}function se(w,P){w.extension.contentHost.className+=" "+P}function ue(w){w.extension.contentHost.className="",w.extension.contentHost.style.cssText=""}function pe(w){w.extension.contentHost.textContent="",w.extension.contentHost.removeAttribute("title"),w.contentHeight=w.contentWidth=0,V(w.extension.contentHost)}function xe(w,P,I){we(w,P),B(w,I||P)}function we(w,P){P.textContent=(0,D.PC)(w)}function B(w,P){P.title=w}function p(w,P){var I=X();return w.appendChild(I),P&&(I.textContent=P),I}function a(w){var I=w.offsetX;return I>=0&&I<w.target.offsetWidth-le.A.resizeHandleSize}function d(w,P,I){var G=null;0===P.childElementCount?(G=document.createElement("a"),P.appendChild(G)):G=P.children[0],G.href=w,G.target="_blank",G.rel="noopener noreferrer",G.title=w,null!=I?(G.className=r.NA+" "+I,$(P).addClass(r.LU)):G.innerText=w}function y(w,P,I){var G=X(),q=document.createElement("img");G.style.height=I+"px",G.style.width="100%",G.style.textAlign="center",q.src=w,q.style.maxHeight="100%",q.style.maxWidth="100%",G.appendChild(q),P.appendChild(G),P.title=w}function h(w,P){return(0,O.cR)(w)?(0,M.MN)(P):M.av.NONE}function o(w){switch(w){case M.av.file:case M.av.ftp:return"page2";case M.av.mailto:return"mail";case M.av.news:return"link";case M.av.telnet:return"pc1";case M.av.http:case M.av.https:return"link";default:return null}}function e(w,P,I){return t(w,P)&&(0,M.gU)(I)}function t(w,P){return(0,O.pt)(P)&&!w.isSubtotal&&!!w.identity}function i(w,P){return!(!w||void 0===P||!(0,L.sq)(w,P))}function l(w,P){return{sortDescriptors:[{queryName:w,sortDirection:P}]}}function c(w){return 2===w?1:2}function C(w,P){var I=X();w?(I.appendChild(R(w,!0)),I.appendChild(R(c(w),!1))):I.appendChild(R(2,!1));var G=X();return I.appendChild(G),P.appendChild(I),G}function R(w,P){var I=document.createElement("i");return I.className=r.rx+" "+(P?"sorted":"future")+" "+(1===w?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),I}function f(w){(function(w){for(var P=0,I=w.extension.contentElement.childElementCount;P<I;P++)if(w.extension.contentElement.children.item(P).classList.contains(r.rx))return!0;return!1})(w)&&$(w.extension.contentElement).find("."+r.rx).remove()}function F(w){return ie.fF.assert(function(){return!(w instanceof Date)||(0,re.M4)(w)},"dates should implement DateWithEpochValue"),(0,re.M4)(w)&&(w=j.y3.fromDateWithEpochValue(w).toString()),String(w)}function ne(w){return w+2}function he(w){return w+2}},81671:function(Fe,fe,E){E.d(fe,{K:function(){return ie}});var O=E(55007),L=E(62458),D=E(82755),Z=E(74304),ie=function(){function re(ee,M,j,le){this.columnWidthObjects={},this.isMatrix=M,this.updateDataView(ee,le),this.hostPersistCallBack=j,this.visualObjectInstancesToPersist={merge:[],remove:[]}}return re.prototype.updateDataView=function(ee,M){this.previousDataView=this.currentDataView,this.previousAutoColumnSizePropertyValue=this.previousDataView?O.FX.PropGeneralAutoSizeColumns.getValue(Z.U.getMetadataObjects(this.previousDataView)):void 0,this.currentDataView=ee,this.currentAutoColumnSizePropertyValue=this.currentDataView?O.FX.PropGeneralAutoSizeColumns.getValue(Z.U.getMetadataObjects(this.currentDataView)):void 0,this.matrixLeafNodes=M,this.updateColumnsMetadata(),this.updateTablixColumnWidths()},re.prototype.updateColumnsMetadata=function(){this.columnWidthObjects={},this.isMatrix?this.updateMatrixColumnsMetadata():this.updateTableColumnsMetadata()},re.prototype.updateTableColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.table)for(var ee=this.currentDataView.table.columns,M=0,j=ee.length;M<j;M++){var le=ee[M].queryName;le&&(this.columnWidthObjects[le]={queryName:le,width:void 0,isFixed:!1})}},re.prototype.updateMatrixColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.matrix&&this.currentDataView.matrix.rows)for(var ee=0,M=this.currentDataView.matrix.rows.levels.length;ee<M;ee++){var j=this.currentDataView.matrix.rows.levels[ee];1===j.sources.length&&(le=j.sources[0].queryName)&&(this.columnWidthObjects[le]={queryName:le,width:void 0,isFixed:!1})}if(this.matrixLeafNodes)for(ee=0,M=this.matrixLeafNodes.length;ee<M;ee++){var le;(le=this.matrixLeafNodes[ee].queryName)&&(this.columnWidthObjects[le]={queryName:le,width:void 0,isFixed:!1})}},re.prototype.updateTablixColumnWidths=function(){var ee=this.currentDataView&&this.currentDataView.metadata&&this.currentDataView.metadata.columns;if(ee){if(this.shouldClearAllColumnWidths())return void this.autoSizeAllColumns();this.deserializeColumnsWidth(ee)}},re.prototype.autoSizeAllColumns=function(){for(var ee in this.columnWidthObjects)this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(ee,void 0));this.callHostToPersist()},re.prototype.deserializeColumnsWidth=function(ee){for(var M in this.columnWidthObjects)this.columnWidthObjects[M].isFixed=!this.currentAutoColumnSizePropertyValue,this.columnWidthObjects[M].width=void 0;for(var j=0,le=ee.length;j<le;j++){var r=ee[j],V=r.queryName,v=(0,D.NA)(r.objects,re.columnWidthProp);this.columnWidthObjects.hasOwnProperty(V)&&null!=v&&(this.columnWidthObjects[V].width=v,this.columnWidthObjects[V].isFixed=!0)}},re.prototype.shouldClearAllColumnWidths=function(){return null!=this.previousDataView&&!1===this.previousAutoColumnSizePropertyValue&&null!=this.currentDataView&&!0===this.currentAutoColumnSizePropertyValue},re.getColumnQueryName=function(ee){var M=ee.getTablixCell();switch(M.type){case 0:return null==M.item||null==M.item.metadata?void 0:M.item.metadata.queryName;case 2:return L.fF.assert(function(){return null!=M.item},"Tablix Column without a ColumnMetadata"),M.item.queryName;default:return void L.fF.assertFail("getColumnQueryName called with cellType: "+M.type)}},re.prototype.getColumnWidthObjects=function(){return this.columnWidthObjects},re.prototype.getFixedColumnWidthObjects=function(){var ee={};for(var M in this.columnWidthObjects){var j=this.columnWidthObjects[M];j.isFixed&&(ee[M]=j)}return ee},re.prototype.getPersistedColumnWidth=function(ee){var M=this.columnWidthObjects[ee];return M&&M.width},re.prototype.callHostToPersist=function(){this.hostPersistCallBack&&this.hostPersistCallBack(this.visualObjectInstancesToPersist),this.visualObjectInstancesToPersist={merge:[],remove:[]}},re.prototype.onColumnWidthChanged=function(ee,M){if(null!=ee&&null!=this.columnWidthObjects[ee]){var j=this.columnWidthObjects[ee];-1===M?(j.width=void 0,j.isFixed=!this.currentAutoColumnSizePropertyValue,this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(j.queryName,void 0)),this.callHostToPersist()):(j.width=M,j.isFixed=!0,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(ee,M)),this.callHostToPersist())}},re.prototype.onColumnsRendered=function(ee){for(var M={},j=0,le=ee.length;j<le;j++){var V=ee[j].width;null==M[r=ee[j].queryName]?M[r]={queryName:r,width:V,isFixed:!1}:V>M[r].width&&(M[r].width=V)}var v=!1;for(var r in this.columnWidthObjects)if(M[r]){var u=this.columnWidthObjects[r];u.isFixed&&null==u.width&&(u.width=M[r].width,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(r,u.width)),v=!0)}return v&&this.callHostToPersist(),v},re.prototype.generateColumnWidthObjectToPersist=function(ee,M){return{selector:{metadata:ee},objectName:"general",properties:{columnWidth:M}}},re.columnWidthProp={objectName:"general",propertyName:"columnWidth"},re}()},93414:function(Fe,fe,E){E.d(fe,{d:function(){return Y},L:function(){return K}});var O=E(64329),L=E(93340),D=E(71090),Z=E(81337),ie=E(62458),re=E(44102),ee=function(){function g(s){this._scrollStep=.1,this._owner=s,this._hierarchyNavigator=s.hierarchyNavigator,this._binder=s.getBinder(),this._tablixLayoutManager=s.layoutManager,this.scrollOffset=0}return g.prototype._onStartRenderingIteration=function(){this.updateScrollPosition()},g.prototype._onEndRenderingIteration=function(){},g.prototype.getValidScrollOffset=function(s){return Math.min(Math.max(s,0),Math.max(this.getItemsCount()-this._scrollStep,0))},g.prototype.makeScrollOffsetValid=function(){this.scrollOffset=this.getValidScrollOffset(this.scrollOffset)},g.prototype.getIntegerScrollOffset=function(){return Math.floor(this.scrollOffset)},g.prototype.getFractionScrollOffset=function(){return this.scrollOffset-this.getIntegerScrollOffset()},Object.defineProperty(g.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!1,configurable:!0}),g.prototype.getFirstVisibleItem=function(s){return this._scrollItems[s]},g.prototype.getFirstVisibleChild=function(s){return this._hierarchyNavigator.getAt(this._hierarchyNavigator.getChildren(s),this.getFirstVisibleChildIndex(s))},g.prototype.getFirstVisibleChildIndex=function(s){var n=this.getFirstVisibleItem(this._hierarchyNavigator.getLevel(s)+1);return void 0===n||void 0!==n&&this._hierarchyNavigator.getParent(n)!==s?0:this._hierarchyNavigator.getIndex(n)},g.prototype._initializeScrollbar=function(s,n,b){var H=this;this._scrollbar=this._createScrollbar(s,b),this._scrollbar._onscroll.push(function(k){return H.onScroll()})},g.prototype.getItemsCount=function(){return this.model?this._hierarchyNavigator.getLeafCount(this.model):0},g.prototype.getDepth=function(){return this.modelDepth},g.prototype.onScroll=function(){this.scrollOffset=this._scrollbar.viewMin,this._owner._onScrollAsync(this)},Object.defineProperty(g.prototype,"otherDimension",{get:function(){return this._otherDimension},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!1,configurable:!0}),g.prototype._createScrollbar=function(s,n){return ie.fF.assertFail("PureVirtualMethod: TablixDimension._createScrollbar"),null},g.prototype.updateScrollPosition=function(){if(this._scrollItems=[],this.model){var s=this.getIntegerScrollOffset(),n=this._hierarchyNavigator.getLeafAt(this.model,s);if(n)do{this._scrollItems[this._hierarchyNavigator.getLevel(n)]=n,n=this._hierarchyNavigator.getParent(n)}while(null!==n)}},g}(),M=function(g){function s(n){var b=g.call(this,n)||this;return b._layoutManager=b._tablixLayoutManager.rowLayoutManager,b._footer=null,b}return(0,Z.__extends)(s,g),s.prototype.setFooter=function(n){this._footer=n,this._owner.updateFooterVisibility()},s.prototype.hasFooter=function(){return null!==this._footer},s.prototype._render=function(){var n=this.getFirstVisibleItem(0);this.hasFooter()&&(this.addFooterRowHeader(this._footer),this.addFooterBodyCells(this._footer)),void 0!==n&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(n))},s.prototype._createScrollbar=function(n,b){return new re.AT(n,b)},s.prototype.addNodes=function(n,b,H,k){for(var X=this._hierarchyNavigator.getCount(n),Q=k;Q<X;Q++){if(!this._layoutManager.needsToRealize)return;var se=this._hierarchyNavigator.getAt(n,Q);b+=this.addNode(se,n,b,H).rowSpan}},s.prototype.getFirstVisibleChildLeaf=function(n){for(var b=n;!this._hierarchyNavigator.isLeaf(b);)b=this.getFirstVisibleChild(b);return b},s.prototype.bindRowHeader=function(n,b){this._binder.bindRowHeader(n,b)},s.prototype.addNode=function(n,b,H,k){var X,Q=this._tablixLayoutManager.getOrCreateRowHeader(n,b,H,this._hierarchyNavigator.getLevel(n)),se=this.rowHeaderMatch(n,Q);return se||(this._owner._unbindCell(Q),Q.type=1,Q.item=n),this._hierarchyNavigator.isLeaf(n)?(Q.colSpan=k-this._hierarchyNavigator.getLevel(n),Q.rowSpan=1,se||this.bindRowHeader(n,Q),this._tablixLayoutManager.onRowHeaderRealized(n,Q),this.addBodyCells(n,b,H)):(X=this._layoutManager.getRealizedItemsCount(),this.addNodes(this._hierarchyNavigator.getChildren(n),H,k,this.getFirstVisibleChildIndex(n)),Q.colSpan=1,Q.rowSpan=this._layoutManager.getRealizedItemsCount()-X+1,se||this.bindRowHeader(n,Q),this._tablixLayoutManager.onRowHeaderRealized(n,Q)),Q},s.prototype.rowHeaderMatch=function(n,b){var H=b.item;return 1===b.type&&H&&this._hierarchyNavigator.headerItemEquals(n,H)},s.prototype.addBodyCells=function(n,b,H){for(var k=this._otherDimension.getIntegerScrollOffset(),X=this._otherDimension._layoutManager.getRealizedItemsCount()-this.getDepth(),Q=this._hierarchyNavigator,se=this._otherDimension.model,ue=this._tablixLayoutManager,pe=0;pe<X;pe++){var xe=Q.getIntersection(n,Q.getLeafAt(se,k+pe)),we=ue.getOrCreateBodyCell(xe,n,b,H,pe);this.bindBodyCell(xe,we),ue.onBodyCellRealized(xe,we)}},s.prototype.bindBodyCell=function(n,b){this.bodyCelMatch(n,b)||(this._owner._unbindCell(b),b.type=3,b.item=n,this._binder.bindBodyCell(n,b))},s.prototype.addFooterRowHeader=function(n){var b=this._tablixLayoutManager.getOrCreateFooterRowHeader(n,this.model);b.colSpan=this.getDepth(),this.rowHeaderMatch(n,b)||(this._owner._unbindCell(b),b.type=1,b.item=n,this.bindRowHeader(n,b),this._tablixLayoutManager.onRowHeaderFooterRealized(n,b))},s.prototype.addFooterBodyCells=function(n){for(var b=this._otherDimension.getIntegerScrollOffset(),H=this._otherDimension.layoutManager.getRealizedItemsCount()-this.getDepth(),k=this._tablixLayoutManager,X=0;X<H;X++){var Q=this._hierarchyNavigator.getLeafAt(this._otherDimension.model,b+X),se=this._hierarchyNavigator.getIntersection(n,Q),ue=k.getOrCreateFooterBodyCell(se,X);this.bindBodyCell(se,ue),k.onBodyCellFooterRealized(se,ue)}},s.prototype.bodyCelMatch=function(n,b){var H=b.item;return 3===b.type&&H&&this._hierarchyNavigator.bodyCellItemEquals(n,H)},s}(ee),j=function(g){function s(n){var b=g.call(this,n)||this;return b._layoutManager=b._tablixLayoutManager.columnLayoutManager,b}return(0,Z.__extends)(s,g),s.prototype._render=function(){var n=this.getFirstVisibleItem(0);void 0!==n&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(n))},s.prototype._createScrollbar=function(n,b){var H=new re.Xg(n,b);return H.smallIncrement=.2,H},s.prototype.addNodes=function(n,b,H,k){for(var X=this._hierarchyNavigator.getCount(n),Q=k;Q<X;Q++){if(!this._layoutManager.needsToRealize)return;b+=this.addNode(this._hierarchyNavigator.getAt(n,Q),n,b,H).colSpan}},s.prototype.addNode=function(n,b,H,k){var X=this._tablixLayoutManager.getOrCreateColumnHeader(n,b,this._hierarchyNavigator.getLevel(n),H),Q=this.columnHeaderMatch(n,X);if(Q||(this._owner._unbindCell(X),X.type=2,X.item=n),this._hierarchyNavigator.isLeaf(n))X.rowSpan=k-this._hierarchyNavigator.getLevel(n);else{var se=this._layoutManager.getRealizedItemsCount();this.addNodes(this._hierarchyNavigator.getChildren(n),H,k,this.getFirstVisibleChildIndex(n));var ue=this._hierarchyNavigator.getChildrenLevelDifference(n);X.rowSpan=ue===1/0?1:ue,X.colSpan=this._layoutManager.getRealizedItemsCount()-se+1}return Q||this._binder.bindColumnHeader(n,X),this._tablixLayoutManager.onColumnHeaderRealized(n,X),X},s.prototype.columnHeaderMatch=function(n,b){var H=b.item;return!this._owner.wordWrapColumnHeaders&&2===b.type&&H&&this._hierarchyNavigator.headerItemEquals(n,H)},s}(ee),le=function(){function g(s,n){this.x=s||0,this.y=n||0}return g.prototype.offset=function(s,n){this.x+=s,this.y+=n},g}(),r=function(g){function s(n,b,H,k){var X=g.call(this,n,b)||this;return X.width=H||0,X.height=k||0,X}return(0,Z.__extends)(s,g),Object.defineProperty(s.prototype,"point",{get:function(){return new le(this.x,this.y)},enumerable:!1,configurable:!0}),s.prototype.contains=function(n){return s.contains(this,n)},s.contains=function(n,b){return!(!b||s.isEmpty(n))&&n.x<=b.x&&b.x<n.x+n.width&&n.y<=b.y&&b.y<n.y+n.height},s.isEmpty=function(n){return!(void 0!==n&&n.width>=0&&n.height>=0)},s}(le),V=function(g){return g[g.NoClick=0]="NoClick",g[g.LeftClick=1]="LeftClick",g[g.RightClick=2]="RightClick",g[g.CenterClick=3]="CenterClick",g}({}),v=function(){function g(s,n,b,H,k){this._x=s,this._y=n,this.isMouseButtonDown=b,this._dx=H||0,this._dy=k||0}return Object.defineProperty(g.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"dx",{get:function(){return this._dx},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"dy",{get:function(){return this._dy},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isMouseDown",{get:function(){return this.isMouseButtonDown},enumerable:!1,configurable:!0}),g}(),u=function(){function g(){this.touchList=[],this.swipeDirection=2,this.matchingDirectionCount=0,this.lockThreshold=!0,this.scrollThreshold=!0,this.lastTouchEvent=new v(0,0,!1)}return Object.defineProperty(g.prototype,"lastEvent",{get:function(){return this.lastTouchEvent},enumerable:!1,configurable:!0}),g.prototype.addTouchRegion=function(s,n,b){var H={lastPoint:new v(0,0,!1),handler:n,region:s,converter:b};this.touchList=this.touchList.concat([H])},g.prototype.upAllTouches=function(){var s,n;n=this.touchList.length;for(var b=0;b<n;b++)this.touchList[b].lastPoint.isMouseDown&&(s=this.touchList[b].converter.getPixelToItem(this.touchList[b].lastPoint.x,this.touchList[b].lastPoint.y,0,0,!1),this.touchList[b].handler.touchEvent(s)),this.touchList[b].lastPoint=new v(this.touchList[b].lastPoint.x,this.touchList[b].lastPoint.y,!1);this.lastTouchEvent=new v(0,0,!1)},g.prototype.touchEvent=function(s){var n,b,H=0,k=0,X=0,Q=0,se=0,ue=null;n=this._getActive(),!this.lastTouchEvent.isMouseDown&&s.isMouseDown&&(n=this._findRegions(s)),this.lastTouchEvent=new v(s.x,s.y,s.isMouseDown,X=this.lastTouchEvent.x-s.x,Q=this.lastTouchEvent.y-s.y),b=n.length;for(var pe=0;pe<b;pe++)H=s.x-n[pe].region.point.x,k=s.y-n[pe].region.point.y,n[pe].lastPoint.isMouseDown&&s.isMouseDown?(X=H-n[pe].lastPoint.x,Q=k-n[pe].lastPoint.y,se=Math.abs(180/Math.PI*Math.atan(Q/X)),this.scrollThreshold&&(this.lockThreshold&&this.matchingDirectionCount>5?1===this.swipeDirection?Q=0:0===this.swipeDirection&&(X=0):se<20?(Q=0,1===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=1)):(se=Math.abs(180/Math.PI*Math.atan(X/Q)))<20?(X=0,0===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=0)):2===this.swipeDirection?this.matchingDirectionCount++:(this.swipeDirection=2,this.matchingDirectionCount=1))):(X=0,Q=0,this.swipeDirection=2,this.matchingDirectionCount=0),n[pe].lastPoint=new v(H,k,s.isMouseDown,X,Q),ue=n[pe].converter.getPixelToItem(H,k,X,Q,s.isMouseDown),n[pe].handler.touchEvent(ue)},g.prototype._findRegions=function(s){var b,n=[];b=this.touchList.length;for(var H=0;H<b;H++)this.touchList[H].region.contains(new le(s.x,s.y))&&(n=n.concat([this.touchList[H]]));return n},g.prototype._getActive=function(){var n,s=[];n=this.touchList.length;for(var b=0;b<n;b++)this.touchList[b].lastPoint.isMouseDown&&(s=s.concat([this.touchList[b]]));return s},g}(),U=function(){function g(s){this.manager=s,this.touchPanel=null,this.scale=1,this.documentCallbacksWrapper=null,this.panelCallbacksWrapper=null,this.sliding=!1}return g.prototype.initTouch=function(s,n){s.style.setProperty("-ms-touch-action","pinch-zoom"),this.touchReferencePoint=n,this.touchPanel=s,this.startTouchPanelEvents()},g.prototype.startTouchPanelEvents=function(){var s=this;"ontouchmove"in this.touchPanel&&(this.panelCallbacksWrapper={startCallback:function(b){return s.onTouchStart(b)},endCallback:function(b){return s.onTouchEnd(b)}},this.touchPanel.addEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.addEventListener("touchend",this.panelCallbacksWrapper.endCallback))},g.prototype.clearTouchPanelEvents=function(){null!==this.panelCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(this.touchPanel.removeEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.removeEventListener("touchend",this.panelCallbacksWrapper.endCallback)),this.panelCallbacksWrapper=null)},g.prototype.getXYByClient=function(s,n,b){var H=b.left,k=b.top;void 0!==window.scrollX&&(H+=window.scrollX,k+=window.scrollY);var X=new le(0,0);return X.offset(s-H,n-k),X},g.prototype.onTouchStart=function(s){if(1===s.touches.length){s.cancelBubble=!0;var n=s.touches[0];this.touchStartTime=(new Date).getTime(),this.touchStartPageY=n.pageY,this.onTouchMouseDown(n)}},g.prototype.onTouchMove=function(s){if(1===s.touches.length){s.preventDefault&&s.preventDefault();var n=s.touches[0];this.touchLastPageY=n.pageY,this.touchLastPageX=n.pageX,this.sliding||this.onTouchMouseMove(n)}},g.prototype.onTouchEnd=function(s){this.clearTouchDocumentEvents();var n=this.getSwipeInfo();this.didUserSwipe(n)?this.startSlideAffect(n):this.sliding||this.upAllTouches()},g.prototype.onTouchMouseDown=function(s){this.scale=(0,L.df)(this.touchPanel),document.getSelection().removeAllRanges(),this.rect=(this.touchReferencePoint?this.touchReferencePoint:this.touchPanel).getBoundingClientRect(),this.startTouchDocumentEvents()},g.prototype.startTouchDocumentEvents=function(){var s=this;"ontouchmove"in this.touchPanel&&(this.documentCallbacksWrapper={moveCallback:function(b){return s.onTouchMove(b)},endCallback:function(b){return s.onTouchEnd(b)}},document.addEventListener("touchend",this.documentCallbacksWrapper.endCallback),document.addEventListener("touchmove",this.documentCallbacksWrapper.moveCallback))},g.prototype.onTouchMouseMove=function(s){var n,b,H=this.rect,k=null!==H&&s.which!==V.NoClick;!k||this.sliding||(b=this.getXYByClient(s.pageX,s.pageY,H),n=new v(b.x/this.scale,b.y/this.scale,k),this.manager.touchEvent(n),s.preventDefault?s.preventDefault():"returnValue"in s&&(s.returnValue=!1))},g.prototype.getSwipeInfo=function(){var s=(new Date).getTime(),b=this.touchLastPageY-this.touchStartPageY;return{direction:b<0?-1:1,distance:b,endTime:s,time:s-this.touchStartTime}},g.prototype.didUserSwipe=function(s){return s.time<600&&s.distance*s.direction>80},g.prototype.startSlideAffect=function(s){var n=this;if(!this.sliding&&null!==this.rect){this.sliding=!0;var b=this.getXYByClient(this.touchLastPageX,this.touchLastPageY,this.rect);this.slide(b,300,s),requestAnimationFrame(function(){n.didUserChangeDirection(s)||n.slide(b,200,s),n.clearSlide()})}},g.prototype.didUserChangeDirection=function(s){return!(this.touchStartTime<=s.endTime)&&(this.touchLastPageY-this.touchStartPageY<0?-1:1)!==s.direction},g.prototype.slide=function(s,n,b){s.y+=n*b.direction+(this.touchStartTime>b.endTime?this.touchLastPageY-this.touchStartPageY:0);var k=new v(s.x/this.scale,s.y/this.scale,!0);this.manager.touchEvent(k)},g.prototype.clearSlide=function(){this.sliding=!1,this.upAllTouches()},g.prototype.upAllTouches=function(){null===this.documentCallbacksWrapper&&(this.rect=null,this.manager.upAllTouches())},g.prototype.clearTouchDocumentEvents=function(){null!==this.documentCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(document.removeEventListener("touchmove",this.documentCallbacksWrapper.moveCallback),document.removeEventListener("touchend",this.documentCallbacksWrapper.endCallback)),this.documentCallbacksWrapper=null)},g.prototype.clearAllTouchEvents=function(){this.clearTouchDocumentEvents(),this.clearTouchPanelEvents()},g}(),W=function(){function g(s){this.dim=s,this.averageSize=1,this.handlers=null,this.tablixControl=null}return Object.defineProperty(g.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),g.prototype.setScrollDensity=function(s){this.averageSize=s},g.prototype.resize=function(s,n,b,H){this.dim.x=s,this.dim.y=n,this.dim.width=b,this.dim.height=H},g.prototype.getPixelToItem=function(s,n,b,H,k){return new v(s*this.averageSize,0,k,-b*this.averageSize,0)},g.prototype.touchEvent=function(s){var n=[];n[0]=this.tablixControl,n[1]=s.dx,n[2]=s.dy,this.handlers&&(0,re.fw)([this.handlers],n)},g.prototype.setHandler=function(s,n){this.handlers=n,this.tablixControl=s},g}(),S=function(){function g(s){this.dim=s,this.averageSize=30,this.handlers=null,this.tablixControl=null}return Object.defineProperty(g.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),g.prototype.setScrollDensity=function(s){this.averageSize=s},g.prototype.resize=function(s,n,b,H){this.dim.x=s,this.dim.y=n,this.dim.width=b,this.dim.height=H},g.prototype.getPixelToItem=function(s,n,b,H,k){return new v(0,n*this.averageSize,k,0,-H*this.averageSize)},g.prototype.touchEvent=function(s){var n=[];n[0]=this.tablixControl,n[1]=s.dx,n[2]=s.dy,this.handlers&&(0,re.fw)([this.handlers],n)},g.prototype.setHandler=function(s,n){this.handlers=n,this.tablixControl=s},g}(),N=function(){function g(s){this.dim=s,this.averageSizeX=g.DefaultAverageSizeX,this.averageSizeY=g.DefaultAverageSizeY,this.handlers=null,this.tablixControl=null}return Object.defineProperty(g.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),g.prototype.setScrollDensity=function(s,n){this.averageSizeX=s,this.averageSizeY=n},g.prototype.resize=function(s,n,b,H){var k=this.dim;k.x=s,k.y=n,k.width=b,k.height=H},g.prototype.getPixelToItem=function(s,n,b,H,k){return new v(s*this.averageSizeX,n*this.averageSizeY,k,-b*this.averageSizeX,-H*this.averageSizeY)},g.prototype.touchEvent=function(s){this.handlers&&(0,re.fw)([this.handlers],[this.tablixControl,s.dx,s.dy])},g.prototype.setHandler=function(s,n){this.handlers=n,this.tablixControl=s},g.DefaultAverageSizeX=30,g.DefaultAverageSizeY=30,g}(),K=O.Gj,Y=function(){function g(s,n,b,H,k){var X=this;this.scrollBarElementWidth=9,this.options=k;var Q=k.interactive;this.isTouchEnabled=Q&&k.enableTouchSupport,this.mainDiv=(0,L.wC)(),this.mainDiv.classList.add(g.TablixTableAreaClassName),this.footerDiv=(0,L.wC)(),this.footerDiv.classList.add(g.TablixFooterClassName),this.gridDimensions={},this.containerElement=(0,L.wC)(),this.className=n.getTablixClassName(),this.autoSizeWidth=!1,this.autoSizeHeight=!1,this.fontFamily=D.dG,this.fontColor=D.ye,this.fontSize=k.fontSize,H.className=g.TablixContainerClassName,H.appendChild(this.containerElement),this.containerElement.addEventListener("wheel",function(se){X.onWheel(se)}),this.containerElement.appendChild(this.mainDiv),this.containerElement.appendChild(this.footerDiv),this.isTouchEnabled&&(this.InitializeTouchSupport(),this.bindTouchEvents()),this.controlLayoutManager=n,this.controlLayoutManager.initialize(this),this.hierarchyTablixNavigator=s,this.binder=b,this.columnDim=new j(this),this.rowDim=new M(this),this.columnDim._otherDimension=this.rowDimension,this.rowDim._otherDimension=this.columnDimension,this.InitializeScrollbars(),Q||(this.scrollbarWidth=0),this.updateHorizontalPosition(),this.updateVerticalPosition(),this.updateFooterVisibility(),this.lastRenderingArgs={}}return g.prototype.InitializeTouchSupport=function(){this.isTouchEventsBound=!1,this.touchManager=new u,this.touchInterpreter=new U(this.touchManager),this.footerTouchInterpreter=new U(this.touchManager),this.columnTouchDelegate=new W(new r),this.rowTouchDelegate=new S(new r),this.bodyTouchDelegate=new N(new r),this.footerTouchDelegate=new W(new r),this.columnTouchDelegate.setHandler(this,this.onTouchEvent),this.rowTouchDelegate.setHandler(this,this.onTouchEvent),this.bodyTouchDelegate.setHandler(this,this.onTouchEvent),this.footerTouchDelegate.setHandler(this,this.onTouchEvent),this.touchManager.addTouchRegion(this.columnTouchDelegate.dimension,this.columnTouchDelegate,this.columnTouchDelegate),this.touchManager.addTouchRegion(this.rowTouchDelegate.dimension,this.rowTouchDelegate,this.rowTouchDelegate),this.touchManager.addTouchRegion(this.bodyTouchDelegate.dimension,this.bodyTouchDelegate,this.bodyTouchDelegate),this.touchManager.addTouchRegion(this.footerTouchDelegate.dimension,this.footerTouchDelegate,this.footerTouchDelegate)},g.prototype.unBindTouchEvents=function(){this.isTouchEventsBound&&(this.touchInterpreter.clearAllTouchEvents(),this.footerTouchInterpreter.clearAllTouchEvents(),this.isTouchEventsBound=!1)},g.prototype.bindTouchEvents=function(){this.isTouchEventsBound||(this.touchInterpreter.initTouch(this.mainDiv,null),this.footerTouchInterpreter.initTouch(this.footerDiv,this.mainDiv),this.isTouchEventsBound=!0)},g.prototype.InitializeScrollbars=function(){this.rowDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var s=this.rowDim.scrollbar.element.style;s.position="absolute",s.top="0"+g.UnitOfMeasurement,s.right="0"+g.UnitOfMeasurement,this.rowDim.scrollbar.width=this.scrollBarElementWidth+g.UnitOfMeasurement,this.rowDim.scrollbar.show(!0),this.columnDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var n=this.columnDim.scrollbar.element.style;n.position="absolute",n.left="0"+g.UnitOfMeasurement,n.bottom="0"+g.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+g.UnitOfMeasurement,this.columnDim.scrollbar.show(!1)},g.prototype.toggleTouchBindings=function(s){this.isTouchEnabled&&(s?this.bindTouchEvents():this.unBindTouchEvents())},Object.defineProperty(g.prototype,"container",{get:function(){return this.containerElement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"contentHost",{get:function(){return this.mainDiv},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"footerHost",{get:function(){return this.footerDiv},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"className",{set:function(n){this.containerElement.className=n},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"hierarchyNavigator",{get:function(){return this.hierarchyTablixNavigator},enumerable:!1,configurable:!0}),g.prototype.getBinder=function(){return this.binder},Object.defineProperty(g.prototype,"autoSizeWidth",{get:function(){return this._autoSizeWidth},set:function(n){this._autoSizeWidth=n,n||(this.containerElement.style.minWidth=this.containerElement.style.maxWidth="none")},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"autoSizeHeight",{get:function(){return this._autoSizeHeight},set:function(n){n||(this.containerElement.style.minHeight=this.containerElement.style.maxHeight="none")},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"maxWidth",{get:function(){return this.maximumWidth},set:function(n){this.maximumWidth=n,this.containerElement.style.maxWidth=this.maximumWidth+g.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"viewport",{get:function(){return this.viewPort},set:function(n){this.viewPort=n,this.containerElement.style.width=this.viewPort.width+g.UnitOfMeasurement,this.containerElement.style.height=this.viewPort.height+g.UnitOfMeasurement,this.rowDim.scrollbar.invalidateArrange(),this.columnDim.scrollbar.invalidateArrange(),this.controlLayoutManager.updateViewport(this.viewPort)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"maxHeight",{get:function(){return this.maximumHeight},set:function(n){this.maximumHeight=n,this.containerElement.style.maxHeight=this.maximumHeight+g.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"minWidth",{get:function(){return this.minimumWidth},set:function(n){this.minimumWidth=n,this.containerElement.style.minWidth=this.minimumWidth+g.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"minHeight",{get:function(){return this.minimumHeight},set:function(n){this.minimumHeight=n,this.containerElement.style.minHeight=this.minimumHeight+g.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"fontSize",{get:function(){return this.textFontSize},set:function(n){this.textFontSize=n||g.DefaultFontSize,this.containerElement.style.fontSize=this.textFontSize},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"fontFamily",{get:function(){return this.textFontFamily},set:function(n){this.textFontFamily=n,this.containerElement.style.fontFamily=n},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"fontColor",{get:function(){return this.textFontColor},set:function(n){this.textFontColor=n,this.containerElement.style.color=n},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"scrollbarWidth",{set:function(n){this.scrollBarElementWidth=n,this.rowDim.scrollbar.width=this.scrollBarElementWidth+g.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+g.UnitOfMeasurement},enumerable:!1,configurable:!0}),g.prototype.getIsTouchEventsBound=function(){return!!this.isTouchEventsBound},g.prototype.updateModels=function(s,n,b){this.rowDim.model=n,this.rowDim.modelDepth=this.hierarchyNavigator.getRowHierarchyDepth(),this.columnDim.model=b,this.columnDim.modelDepth=this.hierarchyNavigator.getColumnHierarchyDepth(),s&&(this.rowDim.scrollOffset=0,this.columnDim.scrollOffset=0),this.layoutManager.updateColumnCount(this.rowDim,this.columnDim)},g.prototype.updateColumnDimensions=function(s,n,b){var H=this.gridDimensions;H.columnCount=b,H.rowHierarchyWidth=s,H.columnHierarchyWidth=n},g.prototype.updateRowDimensions=function(s,n,b,H,k){var X=this.gridDimensions;X.rowCount=H,X.rowHierarchyHeight=n,X.rowHierarchyContentHeight=b,X.columnHierarchyHeight=s,X.footerHeight=k},g.prototype.updateTouchDimensions=function(){var s=this.gridDimensions;this.columnTouchDelegate.resize(s.rowHierarchyWidth,0,s.columnHierarchyWidth,s.columnHierarchyHeight),this.columnTouchDelegate.setScrollDensity(s.columnCount/s.columnHierarchyWidth),this.rowTouchDelegate.resize(0,s.columnHierarchyHeight,s.rowHierarchyWidth,s.rowHierarchyHeight),this.rowTouchDelegate.setScrollDensity(s.rowCount/s.rowHierarchyHeight),this.bodyTouchDelegate.resize(s.rowHierarchyWidth,s.columnHierarchyHeight,s.columnHierarchyWidth,s.rowHierarchyHeight),this.bodyTouchDelegate.setScrollDensity(s.columnCount/s.columnHierarchyWidth,s.rowCount/s.rowHierarchyHeight),this.footerTouchDelegate.resize(s.rowHierarchyWidth,s.columnHierarchyHeight+s.rowHierarchyHeight,s.columnHierarchyWidth,s.footerHeight),this.footerTouchDelegate.setScrollDensity(s.columnCount/s.columnHierarchyWidth)},g.prototype.onWheel=function(s){this.determineDimensionToScroll(s,function(n,b){n.scrollbar.onMouseWheel(-1*b)}),0===this.options.layoutKind&&s.preventDefault()},g.prototype.determineDimensionToScroll=function(s,n){this.rowDim.scrollbar.visible?(s.deltaY&&n(this.rowDim,s.deltaY),s.deltaX&&this.columnDim.scrollbar.visible&&n(this.columnDim,s.deltaX)):this.columnDim.scrollbar.visible&&(s.deltaX?n(this.columnDim,s.deltaX):s.deltaY&&n(this.columnDim,s.deltaY))},Object.defineProperty(g.prototype,"layoutManager",{get:function(){return this.controlLayoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"columnDimension",{get:function(){return this.columnDim},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"rowDimension",{get:function(){return this.rowDim},enumerable:!1,configurable:!0}),g.prototype.refresh=function(s){this.render(s,null)},g.prototype._onScrollAsync=function(s){var n=this;requestAnimationFrame(function(){n.performPendingScroll(s)})},g.prototype.performPendingScroll=function(s){this.render(!1,s)},g.prototype.updateHorizontalPosition=function(){this.rowDim.scrollbar.visible?(this.columnDim.scrollbar.element.style.right=this.scrollBarElementWidth+g.UnitOfMeasurement,this.footerDiv.style.right=this.scrollBarElementWidth+g.UnitOfMeasurement,this.mainDiv.style.right=this.scrollBarElementWidth+g.UnitOfMeasurement):(this.columnDim.scrollbar.element.style.right="0"+g.UnitOfMeasurement,this.mainDiv.style.right="0"+g.UnitOfMeasurement,this.footerDiv.style.right="0"+g.UnitOfMeasurement)},g.prototype.updateFooterVisibility=function(){(this.rowDim.hasFooter()?"block"!==this.footerDiv.style.display:"none"!==this.footerDiv.style.display)&&(this.footerDiv.style.display=this.rowDim.hasFooter()?"block":"none")},g.prototype.updateVerticalPosition=function(){var s=this.rowDim.scrollbar.visible,n=1===this.controlLayoutManager.getLayoutKind();if(s||n){var H=this.footerDiv.offsetHeight,k=0,X=0;this.columnDim.scrollbar.visible&&(H+=this.scrollBarElementWidth,k+=this.scrollBarElementWidth,X=this.scrollBarElementWidth),this.mainDiv.style.bottom=H+g.UnitOfMeasurement,this.rowDim.scrollbar.element.style.bottom=X+g.UnitOfMeasurement,this.footerDiv.style.bottom=k+g.UnitOfMeasurement,this.footerDiv.style.removeProperty("top")}else this.footerDiv.style.top=this.gridDimensions.rowHierarchyContentHeight+g.UnitOfMeasurement,this.footerDiv.style.removeProperty("bottom"),this.mainDiv.style.removeProperty("bottom")},g.prototype.alreadyRendered=function(s){return!(s!==this.lastRenderingArgs.scrollingDimension||this.rowDimension.scrollOffset!==this.lastRenderingArgs.rowScrollOffset||this.columnDimension.scrollOffset!==this.lastRenderingArgs.columnScrollOffset)},g.prototype.render=function(s,n){if(this.columnDim.makeScrollOffsetValid(),this.rowDim.makeScrollOffsetValid(),s||null===n)this.lastRenderingArgs={};else if(this.alreadyRendered(n))return;var b=!1;this.renderIterationCount=0,this.controlLayoutManager.onStartRenderingSession(n,this.mainDiv,s);var H=this.binder;H.onStartRenderingSession();for(var k=this.gridDimensions.footerHeight,X=this.gridDimensions.rowHierarchyHeight,Q=this.gridDimensions.rowHierarchyContentHeight;!b&&this.renderIterationCount<g.MaxRenderIterationCount;){var se=this.columnDim.scrollbar.visible,ue=this.rowDim.scrollbar.visible;this.columnDim._onStartRenderingIteration(),this.rowDim._onStartRenderingIteration(),this.controlLayoutManager.onStartRenderingIteration(s),this.renderCorner(),this.columnDim._render(),this.rowDim._render(),b=this.controlLayoutManager.onEndRenderingIteration(),this.columnDim._onEndRenderingIteration(),this.rowDim._onEndRenderingIteration(),se!==this.columnDim.scrollbar.visible&&this.updateVerticalPosition(),ue!==this.rowDim.scrollbar.visible&&this.updateHorizontalPosition(),this.renderIterationCount++}this.controlLayoutManager.onEndRenderingSession(),H.onEndRenderingSession(),this.isTouchEnabled&&this.updateTouchDimensions(),this.lastRenderingArgs.rowScrollOffset=this.rowDimension.scrollOffset,this.lastRenderingArgs.columnScrollOffset=this.columnDimension.scrollOffset,this.updateContainerDimensions();var pe=this.lastRenderingArgs;pe.rowScrollOffset=this.rowDimension.scrollOffset,pe.columnScrollOffset=this.columnDimension.scrollOffset,pe.scrollingDimension=n,(k!==this.gridDimensions.footerHeight||X!==this.gridDimensions.rowHierarchyHeight||Q!==this.gridDimensions.rowHierarchyContentHeight)&&this.updateVerticalPosition(),this.options.interactive&&(this.columnDim.scrollbar.refresh(),this.rowDim.scrollbar.refresh())},g.prototype.updateContainerDimensions=function(){var s=this.gridDimensions;this._autoSizeWidth&&(this.containerElement.style.width=s.rowHierarchyWidth+s.columnHierarchyWidth+(this.rowDim.scrollbar.visible?this.scrollBarElementWidth:0)+g.UnitOfMeasurement),this._autoSizeHeight&&(this.containerElement.style.height=s.columnHierarchyHeight+s.rowHierarchyHeight+s.footerHeight+(this.columnDim.scrollbar.visible?this.scrollBarElementWidth:0)+g.UnitOfMeasurement)},g.prototype.cornerCellMatch=function(s,n){var b=n.item;return 0===n.type&&b&&this.hierarchyTablixNavigator.cornerCellItemEquals(s,b)},g.prototype.renderCorner=function(){for(var s=this.columnDim.getDepth(),n=this.rowDim.getDepth(),b=0;b<s;b++)for(var H=0;H<n;H++){var k=this.hierarchyTablixNavigator.getCorner(H,b),X=this.controlLayoutManager.getOrCreateCornerCell(k,H,b);this.cornerCellMatch(k,X)||(this._unbindCell(X),X.type=0,X.item=k,this.binder.bindCornerCell(k,X)),this.controlLayoutManager.onCornerCellRealized(k,X)}},g.prototype._unbindCell=function(s){switch(s.type){case 3:this.binder.unbindBodyCell(s.item,s);break;case 2:this.binder.unbindColumnHeader(s.item,s);break;case 1:this.binder.unbindRowHeader(s.item,s);break;case 0:this.binder.unbindCornerCell(s.item,s)}s.item=null,s.type=null},g.prototype.onTouchEvent=function(s){var n,b,H;s&&s.length>0&&"columnDim"in s[0]&&"rowDim"in s[0]&&(n=(H=s[0]).columnDim.scrollbar.visible?s[1]:0,b=H.rowDim.scrollbar.visible?s[2]:0,H.columnDim.scrollbar.viewMin=Math.max(0,H.columnDim.scrollbar.viewMin+n),H.columnDim.scrollOffset=Math.max(0,H.columnDim.scrollOffset+n),H.rowDim.scrollbar.viewMin=Math.max(0,H.rowDim.scrollbar.viewMin+b),H.rowDim.scrollOffset=Math.max(0,H.rowDim.scrollOffset+b),H._onScrollAsync(0===n?H.rowDim:0===b?H.columnDim:null))},g.UnitOfMeasurement="px",g.TablixContainerClassName="tablixContainer",g.TablixTableAreaClassName="tablixTableArea",g.TablixFooterClassName="tableFooterArea",g.DefaultFontSize=O.FP.fromPoint(K),g.MaxRenderIterationCount=10,g}()},74304:function(Fe,fe,E){E.d(fe,{U:function(){return xe}});var O=E(81337),L=E(67016),D=E(2142),Z=E(85196),ie=E(84183),re=E(54522),ee=E(56707),M=E(85028),j=E(32105),le=E(33024),r=E(55007),V=E(85308),v=E(62458),u=E(56578),x=E(64329),z=E(82755),U=E(76045),W=E(91059),S=E(96915),N=E(82386),K=E(86878),g=E(72489),s=E(71090),n=E(73889),b=E(66842),H=E(40845),k=10,xe=function(){function B(p){this.tablixProperties=new r.FX(p)}return B.getMetadataObjects=function(p){return p&&p.metadata?p.metadata.objects:null},B.prototype.enumerateObjectRepetition=function(p,a,d,y){var m,h,o,e,t,i,l;v.fF.assertValue(p,"enumeration should be defined"),v.fF.assertValue(a,"dataView can't be undefined");var C,c=this.getSelectorData(d);switch(d){case n.Y.Table:case n.Y.TableEx:C=this.getTableColumnMetadata(a);break;case n.Y.Matrix:case n.Y.PivotTable:C=this.getMatrixValuesColumnMetadata(a);break;default:return void v.fF.assertNever(d)}if(C){C=_.uniq(C);for(var R=d===n.Y.PivotTable||d===n.Y.TableEx,T=0,f=C;T<f.length;T++){var F=f[T],A=null===(l=F.type.misc)||void 0===l?void 0:l.sparkline;if(R){var ae={containerName:F.displayName,selector:this.getSelector(F.queryName,c),allowOverrideSubtotalMatching:!0,objects:(h={},h[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},h)};if(p.push(ae),!A){var J={containerName:F.displayName,selector:this.getSelector(F.queryName,c),allowOverrideSubtotalMatching:!0,objects:(o={},o[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},o)};p.push(J)}if(F.type.numeric&&!A){var ne={containerName:F.displayName,selector:this.getSelector(F.queryName),objects:(e={},e[r.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[r.FX.PropColumnFormattingDataBars.propertyName]},e)};p.push(ne)}var he={containerName:F.displayName,selector:this.getSelector(F.queryName,c),altStaticSelector:this.getSelector(F.queryName),allowOverrideSubtotalMatching:!0,objects:(t={},t[r.FX.PropValuesIcon.objectName]={formattingProperties:[r.FX.PropValuesIcon.propertyName]},t)};if(p.push(he),R&&y?.conditionalTablixWebURL&&!(0,re.cR)(F)&&!A){var de={containerName:F.displayName,selector:this.getSelector(F.queryName,c),allowOverrideSubtotalMatching:!0,objects:(i={},i[r.FX.PropValuesWebURL.objectName]={formattingProperties:[r.FX.PropValuesWebURL.propertyName]},i)};p.push(de)}}else{if(!F.isMeasure||!F.type.numeric)continue;var te={containerName:F.displayName,selector:this.getSelector(F.queryName,c),objects:(m={},m[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},m)};p.push(te)}}}},B.prototype.getSelectorData=function(p){switch(p){case n.Y.Table:return[(0,W.Yp)(["Values"])];case n.Y.TableEx:return[(0,S.Ue)(1)];case n.Y.Matrix:return[(0,W.Yp)(["Rows","Columns"])];case n.Y.PivotTable:return[(0,S.Ue)(1)];default:return void v.fF.assertNever(p)}},B.prototype.getConditionalFormattingSelector=function(p,a,d){void 0===d&&(d=!0);var y=d?this.getSelectorData(p):void 0;return this.getSelector(a,y)},B.prototype.getSelector=function(p,a){var d={metadata:p};return a&&(d.data=a),d},B.prototype.getFormattingModel=function(p,a,d,y,m,h,o){void 0===m&&(m=!1),v.fF.assertValue(d,"dataView can't be undefined");var l,e=B.getMetadataObjects(d),t=a,i=a,c=this.getColumnsMetadata(d,y);l=y===n.Y.Table?this.shouldShowTableTotalsOption(d)&&r.FX.PropGeneralTableTotals.getValue(e):this.shouldShowColumnSubtotalsOption(d)&&r.FX.PropGeneralMatrixColumnSubtotals.getValue(e)||this.shouldShowRowSubtotalsOption(d)&&r.FX.PropGeneralMatrixRowSubtotals.getValue(e);var C=this.getTablixTextClassProperties(o),R=new u.Nq(this.getStylePresetCard(p,t,y,h),this.getGridCard(p,a,y,e,C,h),this.getBlankRowCard(p,t,y,h),this.getValueCard(p,a,y,e,h),this.getColumnHeadersCard(p,a,y,h),this.getRowHeadersCard(p,t,y,e,m,h),this.getTotalsCard(p,i,y,h),this.getColumnSubtotalCard(p,t,d,y,l,h),this.getRowSubTotalsCard(p,t,d,y,l,h),this.getColumnGrandTotalsCard(p,t,y),this.getRowGrandTotalsCard(p,t,y),this.getColumnFormattingCard(p,a,c,y),this.getCellColumnCard(p,y,d,h),this.getUrlIconCard(p,a,y),this.getImageSizeCard(p,a,y,h),this.getSparklinesCard(c,p,y)),T=this.getMatrixRowsColumnMetadata(d),f=this.getMatrixColumnsColumnMetadata(d),F=h.a11yShowAsMatrix?this.getAccessibilityCardNew(T,f,c,p,i,y):this.getAccessibilityCard(c,p,i,y);return F&&R.addCards(F),R.build()},B.prototype.getLayoutSlice=function(p,a){return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new u.uY({descriptor:L.t.general.layout,value:p.general.layout}).build(),localize:a}).build()},B.prototype.getIndentationSlice=function(p,a){if(p.general.layout===b.t.Compact){var d=p.rowHeaders;return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(d,a).build(),localize:a}).build()}},B.prototype.getRepeatRowHeadersSlice=function(p,a){if(p.general.layout!==b.t.Compact)return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new u.bd({descriptor:L.t.rowHeaders.repeatRowHeaders,value:p.rowHeaders.repeatRowHeaders}).build(),localize:a}).build()},B.prototype.getStylePresetCard=function(p,a,d,y){var m=this,h="StylePresets";y.matrixLayouts&&d===n.Y.PivotTable&&(h="Layout_And_StylePresets");var o=function(i){return p.getLocalizedString(i)},e=new u.CQ(new u.lg("stylePreset"),h,[L.t.general.layout,L.t.rowHeaders.steppedLayoutIndentation,L.t.rowHeaders.repeatRowHeaders],o);return e.addGroup(void 0,function(t){if(t.addSlicePlaceholder((0,u.E0)("stylePreset")),y.matrixLayouts&&d===n.Y.PivotTable){var i=m.getLayoutSlice(a,o),l=m.getIndentationSlice(a,o),c=m.getRepeatRowHeadersSlice(a,o);t.addSlice(i),l&&t.addSlice(l),c&&t.addSlice(c)}}),e.build()},B.prototype.getBlankRowCard=function(p,a,d,y){if(y.matrixLayouts&&d===n.Y.PivotTable){var m=function(t){return p.getLocalizedString(t)},h=L.t.blankRows,o=new u.CQ(new u.lg("blankRows"),"Visual_Blank_Rows",h,m).addTopLevelToggle("blankRow",function(){return new u.bd({descriptor:h.showBlankRows,value:a.blankRows.showBlankRows}).build()});return o.addGroup("colors",function(e){e.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new u.BT({descriptor:h.blankRowColor,value:{value:a.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new u.JN({descriptor:h.blankRowTransparency,value:a.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:le.t2},localize:m}).build(),function(t){return t.withCustomDisplayName("Transparency")})}),o.addGroup("border",function(e){e.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new u.bd({descriptor:h.showBorder,value:a.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new u.uY({descriptor:h.borderPosition,value:a.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new u.BT({descriptor:h.borderColor,value:{value:a.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new u.JN({descriptor:h.borderTransparency,value:a.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:le.t2},localize:m}).build(),function(t){return t.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new u.mu({descriptor:h.borderWidth,value:a.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:k},unitSymbol:le.e_}}).build(),function(t){return t.withCustomDisplayName("Visual_General_Properties_Width")})}),o.build()}},B.prototype.getGridCard=function(p,a,d,y,m,h){var o=function(I){return p.getLocalizedString(I)},e=d===n.Y.TableEx?D.Z.grid:L.t.grid,t=d===n.Y.TableEx?D.Z.values:L.t.values,i=t.outlineStyle,l=t.outlineWeight,c=t.outlineColor,C=d===n.Y.TableEx?D.Z.columnHeaders:L.t.columnHeaders,R=C.outlineStyle,T=C.outlineWeight,f=C.outlineColor,F=d===n.Y.TableEx?D.Z.total:L.t.total,A=F.outlineStyle,te=F.outlineWeight,ae=F.outlineColor,J=L.t.rowHeaders,ne=J.outlineStyle,he=J.outlineWeight,de=J.outlineColor,Re=e.outlineStyle,ge=(0,O.__rest)(e,["imageHeight","imageWidth","outline","outlineStyle"]);ge=(0,O.__assign)((0,O.__assign)({},ge),{outlineStyle:Re,valuesOutlineStyle:i,valuesOutlineWeight:l,valuesOutlineColor:c,columnHeadersOutlineStyle:R,columnHeadersOutlineWeight:T,columnHeadersOutlineColor:f}),d===n.Y.TableEx&&(ge=(0,O.__assign)((0,O.__assign)({},ge),{totalsOutlineStyle:A,totalsOutlineColor:ae,totalsOutlineWeight:te})),d===n.Y.PivotTable&&(ge=(0,O.__assign)((0,O.__assign)({},ge),{rowHeaderOutlineStyle:ne,rowHeaderOutlineWeight:he,rowHeaderOutlineColor:de}));var be=a.grid,w=new u.CQ(new u.lg("grid"),"Visual_Grid",ge,o);return w.addGroup("gridHorizontal",function(P){P.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new u.bd({descriptor:ge.gridHorizontal,value:be.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new u.BT({descriptor:ge.gridHorizontalColor,value:{value:be.gridHorizontalColor}}).build()},function(I){return I.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new u.mu({descriptor:ge.gridHorizontalWeight,value:be.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:k}}}).build(),function(I){return I.withCustomDisplayName("Visual_General_Properties_Width")})}),w.addGroup("gridVertical",function(P){P.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new u.bd({descriptor:ge.gridVertical,value:be.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new u.BT({descriptor:ge.gridVerticalColor,value:{value:be.gridVerticalColor}}).build()},function(I){return I.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new u.mu({descriptor:ge.gridVerticalWeight,value:be.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:k}}}).build(),function(I){return I.withCustomDisplayName("Visual_General_Properties_Width")})}),w.addGroup("border",function(P){P.withDisplayName("Visual_Border").addContainer("outline",function(I){I.withDisplayName("Section"),I.addContainerItem("all",o("All"),function(G){G.addSimpleSlice("outlineStyle",function(){return new u.oM({descriptor:ge.outlineStyle,value:be.outline}).build()},function(q){return q.withCustomDisplayName("Visual_Border_Position")}),G.addSimpleSlice("outlineColor",function(){return new u.BT({descriptor:ge.outlineColor,value:{value:be.outlineColor}}).build()},function(q){return q.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new u.mu({descriptor:ge.outlineWeight,value:be.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:k}}}).build(),function(q){return q.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",o("Visual_Tablix_ColumnHeader"),function(G){var q=a.columnHeaders;G.addSimpleSlice("outlineStyleColumnHeaders",function(){return new u.oM({descriptor:R,value:q.outline}).build()},function(oe){return oe.withCustomDisplayName("Visual_Border_Position")}),G.addSimpleSlice("outlineColorColumnHeaders",function(){return new u.BT({descriptor:f,value:{value:q.outlineColor}}).build()},function(oe){return oe.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new u.mu({descriptor:T,value:q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:k}}}).build(),function(oe){return oe.withCustomDisplayName("Visual_General_Properties_Width")})}),d===n.Y.PivotTable&&I.addContainerItem("rowHeaders",o("Visual_Tablix_RowHeaders"),function(G){var q=a.rowHeaders;G.addSimpleSlice("outlineStyleRowHeaders",function(){return new u.oM({descriptor:ne,value:q.outline}).build()},function(oe){return oe.withCustomDisplayName("Visual_Border_Position")}),G.addSimpleSlice("outlineColorRowHeaders",function(){return new u.BT({descriptor:de,value:{value:q.outlineColor}}).build()},function(oe){return oe.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new u.mu({descriptor:he,value:q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:k}}}).build(),function(oe){return oe.withCustomDisplayName("Visual_General_Properties_Width")})}),I.addContainerItem("values",o("Visual_Tablix_ValuesSection"),function(G){var q=a.values;G.addSimpleSlice("outlineStyleValues",function(){return new u.oM({descriptor:i,value:q.outline}).build()},function(oe){return oe.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new u.BT({descriptor:c,value:{value:q.outlineColor}}).build()},function(oe){return oe.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new u.mu({descriptor:l,value:q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:k}}}).build(),function(oe){return oe.withCustomDisplayName("Visual_General_Properties_Width")})}),d===n.Y.TableEx&&I.addContainerItem("outline-totals",o("Visual_Tablix_TotalsSection"),function(G){var q=a.total;G.addSimpleSlice("outlineStyleTotals",function(){return new u.oM({descriptor:A,value:q.outline}).build()},function(oe){return oe.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new u.BT({descriptor:ae,value:{value:q.outlineColor}}).build()},function(oe){return oe.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new u.mu({descriptor:te,value:q.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:k}}}).build(),function(oe){return oe.withCustomDisplayName("Visual_General_Properties_Width")})})})}),w.addGroup("options",function(P){P.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new u.mu({descriptor:ge.rowPadding,value:be.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new u.mu({descriptor:ge.textSize,value:r.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,y,m.fontSizeOverrideFn,m.labelFontProperties.size&&m.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(I){return I.withCustomDisplayName("Global_Font_Size")})}),w.build()},B.prototype.getValueCard=function(p,a,d,y,m){var T=(0,O.__rest)(d===n.Y.TableEx?D.Z.values:L.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),f=a.values,F=new u.CQ(new u.lg("values"),"Visual_Tablix_Values",T,function(J){return p.getLocalizedString(J)}),te=(new u.UN).withFontFamily({descriptor:T.fontFamily,value:f.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:f.fontSize.pt}).withBold({descriptor:T.bold,value:f.bold}).withItalic({descriptor:T.italic,value:f.italic}).withUnderline({descriptor:T.underline,value:f.underline}).build();return F.addGroup("values",function(ae){ae.withDisplayName("Visual_Tablix_Values"),(d===n.Y.PivotTable||d===n.Y.TableEx)&&ae.addCompositeSlice("font","Font",te),ae.addSimpleSlice("fontColorPrimary",function(){return new u.BT({descriptor:T.fontColorPrimary,value:{value:f.fontColorPrimary}}).build()},function(J){return J.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new u.BT({descriptor:T.backColorPrimary,value:{value:f.backColorPrimary}}).build()},function(J){return J.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new u.BT({descriptor:T.fontColorSecondary,value:{value:f.fontColorSecondary}}).build()},function(J){return J.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new u.BT({descriptor:T.backColorSecondary,value:{value:f.backColorSecondary}}).build()},function(J){return J.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new u.bd({descriptor:T.wordWrap,value:f.wordWrap}).build(),function(J){return J.withCustomDisplayName("TextWrap")})}),d===n.Y.PivotTable&&F.addGroup("options",function(ae){ae.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new u.bd({descriptor:T.valuesOnRow,value:r.FX.PropValuesOnRow.setInstanceProperty(void 0,y)}).build(),function(J){return J.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),F.build()},B.prototype.getColumnHeadersCard=function(p,a,d,y){var l=(0,O.__rest)(d===n.Y.TableEx?D.Z.columnHeaders:L.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),c=a.columnHeaders,C=new u.CQ(new u.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",l,function(F){return p.getLocalizedString(F)}),T=(new u.UN).withFontFamily({descriptor:l.fontFamily,value:c.fontFamily}).withFontSizeProperties({descriptor:l.fontSize,value:c.fontSize.pt}).withBold({descriptor:l.bold,value:c.bold}).withItalic({descriptor:l.italic,value:c.italic}).withUnderline({descriptor:l.underline,value:c.underline}).build();return C.addGroup("text",function(f){f.withDisplayName("Text"),(d===n.Y.PivotTable||d===n.Y.TableEx)&&f.addCompositeSlice("font","Font",T),f.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:l.fontColor,value:{value:c.fontColor}}).build()},function(A){return A.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:l.backColor,value:{value:c.backColor}}).build()},function(A){return A.withCustomDisplayName("Background_Color")}),(d===n.Y.Table||d===n.Y.TableEx||d===n.Y.PivotTable)&&f.addSimpleSlice("alignment",new u.Gp({descriptor:l.alignment,value:c.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(A){return A.withCustomDisplayName("Visual_TextAlignment_Header")}),d===n.Y.PivotTable&&f.addSimpleSlice("titleAlignment",new u.Gp({descriptor:l.titleAlignment,value:a.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(d===n.Y.Table||d===n.Y.TableEx||d===n.Y.PivotTable)&&f.addSimpleSlice("wordWrap",new u.bd({descriptor:l.wordWrap,value:c.wordWrap}).build(),function(A){return A.withCustomDisplayName("TextWrap")})}),(d===n.Y.PivotTable||d===n.Y.TableEx)&&C.addGroup("options",function(f){f.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new u.bd({descriptor:l.autoSizeColumnWidth,value:a.general.autoSizeColumnWidth}).build(),function(F){return F.withCustomDisplayName("Visual_AutoSize_Width")})}),C.build()},B.prototype.getRowHeadersCard=function(p,a,d,y,m,h){var o=this;if(void 0===m&&(m=!1),d===n.Y.PivotTable){var e=function(ne){return p.getLocalizedString(ne)},T=(0,O.__rest)(L.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),f=L.t.values.bandedRowHeaders;d===n.Y.PivotTable&&(T=(0,O.__assign)((0,O.__assign)({},T),{bandedRowHeaders:f}));var F=a.rowHeaders,A=new u.CQ(new u.lg("rowHeaders"),"Visual_Tablix_RowHeaders",T,e),ae=(new u.UN).withFontFamily({descriptor:T.fontFamily,value:F.fontFamily}).withFontSizeProperties({descriptor:T.fontSize,value:F.fontSize.pt}).withBold({descriptor:T.bold,value:F.bold}).withItalic({descriptor:T.italic,value:F.italic}).withUnderline({descriptor:T.underline,value:F.underline}).build();return A.addGroup("text",function(J){J.withDisplayName("Text"),(d===n.Y.PivotTable||d===n.Y.TableEx)&&J.addCompositeSlice("font","Font",ae),J.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:T.fontColor,value:{value:F.fontColor}}).build()},function(ne){return ne.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:T.backColor,value:{value:F.backColor}}).build()},function(ne){return ne.withCustomDisplayName("Background_Color")}),d===n.Y.PivotTable&&J.addSimpleSlice("bandedRowHeaders",new u.bd({descriptor:T.bandedRowHeaders,value:r.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,y)}).build()),J.addSimpleSlice("alignment",new u.Gp({descriptor:T.alignment,value:F.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new u.bd({descriptor:T.wordWrap,value:F.wordWrap}).build(),function(ne){return ne.withCustomDisplayName("TextWrap")})}),d===n.Y.PivotTable&&m&&A.addGroup("expandCollapseButtons",function(J){J.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),J.addTopLevelToggle("showExpandCollapseButtons",function(){return new u.bd({descriptor:T.showExpandCollapseButtons,value:F.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new u.BT({descriptor:T.expandCollapseButtonsColor,value:{value:F.expandCollapseButtonsColor}}).build()},function(ne){return ne.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new u.mu({descriptor:T.expandCollapseButtonsSize,value:F.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(ne){return ne.withCustomDisplayName("Visual_BubbleSize")})}),h.matrixLayouts||A.addGroup("options",function(J){J.withDisplayName("Desktop_FileMenu_Options"),J.addSimpleSlice("stepped",new u.bd({descriptor:T.stepped,value:F.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",o.getIndentationSliderBuilder(F,e).build())}),A.build()}},B.prototype.getIndentationSliderBuilder=function(p,a){return new u.JN({descriptor:L.t.rowHeaders.steppedLayoutIndentation,value:p.steppedLayoutIndentation,localize:a,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},B.prototype.getTotalsCard=function(p,a,d,y){if(d===n.Y.TableEx){var i=(0,O.__rest)(d===n.Y.TableEx?D.Z.total:L.t.total,["outlineStyle","outlineWeight","outlineColor"]),l=a.total,c=new u.CQ(new u.lg("totals"),"Visual_Totals",i,function(f){return p.getLocalizedString(f)}),R=(new u.UN).withFontFamily({descriptor:i.fontFamily,value:l.fontFamily}).withFontSizeProperties({descriptor:i.fontSize,value:l.fontSize.pt}).withBold({descriptor:i.bold,value:l.bold}).withItalic({descriptor:i.italic,value:l.italic}).withUnderline({descriptor:i.underline,value:l.underline}).build();return c.addGroup("values",function(T){var f;T.withDisplayName("Visual_Tablix_Values"),d===n.Y.TableEx?(T.addTopLevelToggle("gridVertical",function(){return new u.bd({descriptor:i.totals,value:a.general.totals}).build()}),f=a.general.totals):f=!0,f&&T.addSimpleSlice("totalLabel",new u.fq({descriptor:i.label,value:l.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",R),T.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:i.fontColor,value:{value:l.fontColor}}).build()},function(F){return F.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:i.backColor,value:{value:l.backColor}}).build()},function(F){return F.withCustomDisplayName("Background_Color")})}),c.build()}},B.prototype.getColumnGrandTotalsCard=function(p,a,d){if(d!==n.Y.TableEx){var e=(0,O.__rest)(L.t.columnTotal,["outlineStyle","outline"]),t=a.columnGrandTotal,i=new u.CQ(new u.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",e,function(R){return p.getLocalizedString(R)}),c=(new u.UN).withFontFamily({descriptor:e.fontFamily,value:t.fontFamily}).withFontSizeProperties({descriptor:e.fontSize,value:t.fontSize.pt}).withBold({descriptor:e.bold,value:t.bold}).withItalic({descriptor:e.italic,value:t.italic}).withUnderline({descriptor:e.underline,value:t.underline}).build();return i.addGroup("values",function(C){C.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",c).addSimpleSlice("fontColor",function(){return new u.BT({descriptor:e.fontColor,value:{value:t.fontColor}}).build()},function(R){return R.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:e.backColor,value:{value:t.backColor}}).build()},function(R){return R.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:e.applyToHeaders,value:t.applyToHeaders}).build())}),i.build()}},B.prototype.getRowGrandTotalsCard=function(p,a,d){if(d!==n.Y.TableEx){var e=(0,O.__rest)(L.t.rowTotal,["outlineStyle","outline"]),t=a.rowGrandTotal,i=new u.CQ(new u.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",e,function(R){return p.getLocalizedString(R)}),c=(new u.UN).withFontFamily({descriptor:e.fontFamily,value:t.fontFamily}).withFontSizeProperties({descriptor:e.fontSize,value:t.fontSize.pt}).withBold({descriptor:e.bold,value:t.bold}).withItalic({descriptor:e.italic,value:t.italic}).withUnderline({descriptor:e.underline,value:t.underline}).build();return i.addGroup("values",function(C){C.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",c).addSimpleSlice("fontColor",function(){return new u.BT({descriptor:e.fontColor,value:{value:t.fontColor}}).build()},function(R){return R.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:e.backColor,value:{value:t.backColor}}).build()},function(R){return R.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:e.applyToHeaders,value:t.applyToHeaders}).build())}),i.build()}},B.prototype.addAltTextGroup=function(p,a,d,y,m,h){_.isEmpty(y)||p.addGroup(a,function(o){o.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),o.addContainer("measure",function(e){e.withDisplayName(d);for(var t=function(R){var T;h===Z.r.rows||h===Z.r.columns?T={data:[(0,W.Yp)([h])]}:h===Z.r.values?T={data:[(0,S.Ue)(0)],metadata:R.queryName}:v.fF.assertFail("unexpected role"),e.addContainerItem(R.queryName,R.displayName,function(f){return f.addSimpleSlice("altTextColumns",new u.k0({descriptor:(0,O.__assign)((0,O.__assign)({},m.altTextColumns),{selector:T,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},i=0,l=y;i<l.length;i++)t(l[i])})})},B.prototype.getAccessibilityCardNew=function(p,a,d,y,m,h){v.fF.assert(function(){return h===n.Y.TableEx||h===n.Y.PivotTable});var o=h===n.Y.TableEx?D.Z.accessibility:L.t.accessibility,e=_.filter(p,re.pt),t=_.filter(a,re.pt),i=_.filter(d,re.pt),l=_.filter(d,function(T){return T.type.text}).map(function(T){return{displayName:T.displayName,value:T.queryName}});if(!(_.isEmpty(e)&&_.isEmpty(t)&&_.isEmpty(i))||h!==n.Y.PivotTable&&!_.isEmpty(l)){var C=new u.CQ(new u.lg("accessibility"),"Accessibility",h===n.Y.TableEx?[o.altTextColumns,o.rowWithReferenceText]:[o.altTextColumns],function(f){return y.getLocalizedString(f)});if(this.addAltTextGroup(C,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",e,o,Z.r.rows),this.addAltTextGroup(C,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",t,o,Z.r.columns),this.addAltTextGroup(C,"AltTextValues","Image_Alt_Text_Values",i,o,Z.r.values),h===n.Y.TableEx&&!_.isEmpty(l)){var R={displayName:y.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};l.unshift(R),C.addGroup("rowWithReferenceText",function(T){var f;T.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),T.addSimpleSlice("rowWithReferenceText",new u.uY({descriptor:(0,O.__assign)({},o.rowWithReferenceText),items:l,value:null!==(f=_.find(l,function(F){return F.value===m.rowWithReferenceText.rowWithReferenceText}))&&void 0!==f?f:l[0]}).build())})}return C.build()}},B.prototype.getAccessibilityCard=function(p,a,d,y){if(y===n.Y.TableEx){var m=D.Z.accessibility,h=_.filter(p,re.pt),o=_.filter(p,function(l){return l.type.text}).map(function(l){return{displayName:l.displayName,value:l.queryName}});if(!_.isEmpty(h)||!_.isEmpty(o)){var t=new u.CQ(new u.lg("accessibility"),"Accessibility",[m.altTextColumns,m.rowWithReferenceText],function(c){return a.getLocalizedString(c)});if(_.isEmpty(h)||t.addGroup("AltTextValues",function(l){l.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),l.addContainer("measure",function(c){c.withDisplayName("Image_Alt_Text_Values");for(var C=function(A){c.addContainerItem(A.queryName,A.displayName,function(te){return te.addSimpleSlice("altTextColumns",new u.k0({descriptor:(0,O.__assign)((0,O.__assign)({},m.altTextColumns),{selector:{data:[(0,S.Ue)(0)],metadata:A.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},R=0,T=h;R<T.length;R++)C(T[R])})}),!_.isEmpty(o)){var i={displayName:a.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};o.unshift(i),t.addGroup("rowWithReferenceText",function(l){var c;l.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),l.addSimpleSlice("rowWithReferenceText",new u.uY({descriptor:(0,O.__assign)({},m.rowWithReferenceText),items:o,value:null!==(c=_.find(o,function(C){return C.value===d.rowWithReferenceText.rowWithReferenceText}))&&void 0!==c?c:o[0]}).build())})}return t.build()}}},B.prototype.getRowSubTotalsCard=function(p,a,d,y,m,h){var o=this;if(m||y===n.Y.PivotTable){var e=B.getMetadataObjects(d),t=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,e),i=function(f){return p.getLocalizedString(f)},l=L.t.subTotals,c=(0,O.__assign)((0,O.__assign)({},a.subtotals),a.rowSubtotals),C=new u.CQ(new u.lg("rowSubTotal"),"Visual_SubtotalRow",[l.rowSubtotalsLabel,l.rowSubtotals,l.rowSubtotalsPosition,l.perRowLevel,l.levelSubtotalEnabled,l.levelSubtotalLabel,l.fontColor,l.backColor,l.fontSize,l.fontFamily,l.bold,l.italic,l.underline,l.applyToHeaders],i);C.addTopLevelToggle("rowSubtotals",function(){return new u.bd({descriptor:l.rowSubtotals,value:a.general.rowSubtotals}).build()});var R=0;return C.addGroup("applySettingsTo",function(T){T.withContainerDisabled(!t).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new u.bd({descriptor:l.perRowLevel,value:t}).build(),function(f){return f.withDisabled(!o.shouldShowRowSubtotalsOption(d)).withCustomDescriptionIf(function(){return!o.shouldShowRowSubtotalsOption(d)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(f){f.withDisplayName("Visual_Tablix_Row_Level"),f.addContainerItem("all",i("All"),function(de){return o.getRowSubtotalContainers(a,de,i,h,l,c,void 0,e)});for(var F=0,A=d.matrix.rows.levels;F<A.length;F++)for(var ae=function(ce){if(!ce.isMeasure){var Ce={metadata:ce.queryName};f.addContainerItem(ce.displayName,ce.displayName,function(ze){return o.getRowSubtotalContainers(a,ze,i,h,l,c,Ce,ce.objects,R)}),R++}},J=0,ne=A[F].sources;J<ne.length;J++)ae(ne[J])})}),C.build()}},B.prototype.getRowSubtotalContainers=function(p,a,d,y,m,h,o,e,t){var i=o?r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(e,!0):r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(e,!0),l=o?"":d(s.qT),c=o?m.levelSubtotalLabel:m.rowSubtotalsLabel;a.addGroup("rows",function(C){C.withDisplayName("Role_DisplayName_Rows"),C.addSimpleSlice("levelSubtotalEnabled",new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},m.levelSubtotalEnabled),{selector:o}),value:r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,e)}).build(),function(R){return R.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!o)}).addSimpleSlice("rowSubtotalsLabel",new u.fq({descriptor:(0,O.__assign)((0,O.__assign)({},c),{selector:o}),value:i||l,placeholder:""}).build(),function(R){return R.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(o?"rowSubtotalsPositionSeries".concat(t):"rowSubtotalsPositionAll",new u.uY({descriptor:m.rowSubtotalsPosition,value:p.subtotals.rowSubtotalsPosition}).build(),function(R){return R.withCustomDisplayName("Visual_Position").withDisabled(!!o||y.matrixLayouts&&p.general.layout===b.t.Tabular)})}),a.addGroup("values",function(C){if(C.withDisplayName("Visual_Tablix_Values"),o)C.withDisabled(!0,"");else{var R={id:"Row"},f=(new u.UN).withFontFamily({descriptor:(0,O.__assign)((0,O.__assign)({},m.fontFamily),{selector:R}),value:h.fontFamily}).withFontSizeProperties({descriptor:(0,O.__assign)((0,O.__assign)({},m.fontSize),{selector:R}),value:h.fontSize.pt}).withBold({descriptor:(0,O.__assign)((0,O.__assign)({},m.bold),{selector:R}),value:h.bold}).withItalic({descriptor:(0,O.__assign)((0,O.__assign)({},m.italic),{selector:R}),value:h.italic}).withUnderline({descriptor:(0,O.__assign)((0,O.__assign)({},m.underline),{selector:R}),value:h.underline}).build();C.addCompositeSlice("font","Font",f).addSimpleSlice("fontColor",function(){var F={value:h.fontColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},m.fontColor),{selector:R}),value:F}).build()},function(F){return F.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var F={value:h.backColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},m.backColor),{selector:R}),value:F}).build()},function(F){return F.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},m.applyToHeaders),{selector:R}),value:h.applyToHeaders}).build())}})},B.prototype.getColumnSubtotalCard=function(p,a,d,y,m,h){var o=this;if(m||y===n.Y.PivotTable||this.shouldShowColumnSubtotalsOption(d)){var e=B.getMetadataObjects(d),t=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(e),i=function(T){return p.getLocalizedString(T)},l=L.t.subTotals,c=(0,O.__assign)((0,O.__assign)({},a.subtotals),a.columnSubtotals),C=new u.CQ(new u.lg("columnSubTotal"),"Visual_SubtotalColumn",[l.columnSubtotals,l.columnSubtotalsLabel,l.perColumnLevel,l.levelSubtotalEnabled,l.levelSubtotalLabel,l.fontColor,l.backColor,l.fontSize,l.fontFamily,l.bold,l.italic,l.underline,l.applyToHeaders],i);return C.addTopLevelToggle("columnSubtotals",function(){return new u.bd({descriptor:l.columnSubtotals,value:a.general.columnSubtotals}).build()}),C.addGroup("applySettingsTo",function(R){R.withContainerDisabled(!t).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new u.bd({descriptor:l.perColumnLevel,value:t}).build(),function(T){return T.withDisabled(!o.shouldShowColumnSubtotalsOption(d)).withCustomDescriptionIf(function(){return!o.shouldShowColumnSubtotalsOption(d)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(T){T.withDisplayName("Visual_Tablix_Column_Level"),T.addContainerItem("all",i("All"),function(he){return o.getColumnSubtotalContainers(he,i,h,l,c,void 0,e)});for(var f=0,F=d.matrix.columns.levels;f<F.length;f++)for(var te=function(de){if(!de.isMeasure){var ce={metadata:de.queryName};T.addContainerItem(de.displayName,de.displayName,function(Ce){return o.getColumnSubtotalContainers(Ce,i,h,l,c,ce,de.objects)})}},ae=0,J=F[f].sources;ae<J.length;ae++)te(J[ae])})}),C.build()}},B.prototype.getColumnSubtotalContainers=function(p,a,d,y,m,h,o){var e=a(s.qT),t=h?r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(o,!0):r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(o,!0),i=h?y.levelSubtotalLabel:y.columnSubtotalsLabel;p.addGroup("columns",function(l){l.withDisplayName("Role_DisplayName_Columns"),l.addSimpleSlice("levelSubtotalEnabled",new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},y.levelSubtotalEnabled),{selector:h}),value:r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,o)}).build(),function(c){return c.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!h)}).addSimpleSlice("columnSubtotalsLabel",new u.fq({descriptor:(0,O.__assign)((0,O.__assign)({},i),{selector:h}),value:t||e,placeholder:""}).build(),function(c){return c.withCustomDisplayName("Visual_Subtotal_Label")})}),p.addGroup("values",function(l){if(l.withDisplayName("Visual_Tablix_Values"),h)l.withDisabled(!0,"");else{var c={id:"Column"},R=(new u.UN).withFontFamily({descriptor:(0,O.__assign)((0,O.__assign)({},y.fontFamily),{selector:c}),value:m.fontFamily}).withFontSizeProperties({descriptor:(0,O.__assign)((0,O.__assign)({},y.fontSize),{selector:c}),value:m.fontSize.pt}).withBold({descriptor:(0,O.__assign)((0,O.__assign)({},y.bold),{selector:c}),value:m.bold}).withItalic({descriptor:(0,O.__assign)((0,O.__assign)({},y.italic),{selector:c}),value:m.italic}).withUnderline({descriptor:(0,O.__assign)((0,O.__assign)({},y.underline),{selector:c}),value:m.underline}).build();l.addCompositeSlice("font","Font",R).addSimpleSlice("fontColor",function(){var T={value:m.fontColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},y.fontColor),{selector:c}),value:T}).build()},function(T){return T.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var T={value:m.backColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},y.backColor),{selector:c}),value:T}).build()},function(T){return T.withCustomDisplayName("Background_Color")}),l.addSimpleSlice("applyToHeaders",new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},y.applyToHeaders),{selector:c}),value:m.applyToHeaders}).build())}})},B.prototype.getColumnFormattingCard=function(p,a,d,y){if(!_.isEmpty(d)){var e=(0,O.__rest)(y===n.Y.TableEx?D.Z.columnFormatting:L.t.columnFormatting,["dataBars"]),t=a.columnFormatting,i=new u.CQ(new u.lg("columnFormatting"),"Visual_Tablix_Specific_Column",e,function(c){return p.getLocalizedString(c)});return i.withDescription("Visual_Matrix_SpecificColumn_Description"),i.addGroup("columns",function(l){l.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(c){c.withDisplayName("Series");for(var C=function(A){var te=A&&A.objects;c.addContainerItem(A.queryName,A.displayName,function(ae){ae.addSimpleSlice(e.styleHeader,new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},e.styleHeader),{selector:{metadata:A.queryName}}),value:t[A.queryName].styleHeader}).build()),y===n.Y.PivotTable&&ae.addSimpleSlice(e.styleSubtotals,new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},e.styleSubtotals),{selector:{metadata:A.queryName}}),value:r.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,te)}).build()),ae.addSimpleSlice(e.styleTotal,new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},e.styleTotal),{selector:{metadata:A.queryName}}),value:t[A.queryName].styleTotal}).build()).addSimpleSlice(e.styleValues,new u.bd({descriptor:(0,O.__assign)((0,O.__assign)({},e.styleValues),{selector:{metadata:A.queryName}}),value:t[A.queryName].styleValues}).build()),ae.addGroup("values",function(J){if(J.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var he={value:t[A.queryName].fontColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},e.fontColor),{selector:{metadata:A.queryName}}),value:he}).build()},function(he){return he.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var he={value:t[A.queryName].backColor};return new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},e.backColor),{selector:{metadata:A.queryName}}),value:he}).build()},function(he){return he.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new u.Gp({descriptor:(0,O.__assign)((0,O.__assign)({},e.alignment),{selector:{metadata:A.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:t[A.queryName].alignment}).build()),A.type.numeric&&(y===n.Y.PivotTable||y===n.Y.TableEx)){var ne=A&&A.objects;J.addSimpleSlice("labelDisplayUnits",new u.uY({descriptor:(0,O.__assign)((0,O.__assign)({},e.labelDisplayUnits),{selector:{metadata:A.queryName}}),value:r.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,ne)}).build()).addSimpleSlice("labelPrecision",new u.mu({descriptor:(0,O.__assign)((0,O.__assign)({},e.labelPrecision),{selector:{metadata:A.queryName}}),value:r.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,ne),options:{minValue:{type:0,value:0},maxValue:{type:1,value:ee.vo}}}).build())}})})},R=0,T=d;R<T.length;R++)C(T[R])})}),i.build()}},B.prototype.getCellColumnCard=function(p,a,d,y){var o=(0,D.k)().objects,e=[];return this.enumerateObjectRepetition(e,d,a,y),(0,ie.Z)(e,function(i){return p.getLocalizedString(i)},o,"Cell_Elements","Visual_Matrix_CellElements_Description")},B.prototype.getUrlIconCard=function(p,a,d){var y=d===n.Y.TableEx?D.Z.values.urlIcon:L.t.values.urlIcon,m=a,h=L.t.columnHeaders.urlIcon,o=L.t.rowHeaders.urlIcon,t=new u.CQ(new u.lg("urlIcon"),"Visual_Tablix_UrlIcon",[y,h,o],function(l){return p.getLocalizedString(l)});return t.addGroup("urlIcon",function(i){(d===n.Y.Table||d===n.Y.TableEx||d===n.Y.PivotTable)&&i.addSimpleSlice("values",new u.bd({descriptor:y,value:a.values.urlIcon}).build(),function(l){return l.withCustomDisplayName("Visual_Tablix_Values")}),d===n.Y.PivotTable&&i.addSimpleSlice("columnheaders",new u.bd({descriptor:h,value:m.columnHeaders.urlIcon}).build(),function(l){return l.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new u.bd({descriptor:o,value:m.rowHeaders.urlIcon}).build(),function(l){return l.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),t.build()},B.prototype.getImageSizeCard=function(p,a,d,y){var m=d===n.Y.TableEx?D.Z.grid.imageHeight:L.t.grid.imageHeight,h=d===n.Y.TableEx?D.Z.grid.imageWidth:L.t.grid.imageWidth,e=new u.CQ(new u.lg("imageHeight"),"Visual_Tablix_ImageSize",[m,h],function(i){return p.getLocalizedString(i)});return e.addGroup("imageHeight",function(t){t.addSimpleSlice("imageHeight",new u.mu({descriptor:m,value:a.grid.imageHeight,options:{minValue:{type:0,value:B.ImageSizeMin},maxValue:{type:1,value:B.ImageSizeMax},unitSymbol:le.e_}}).build()),y.tablixImageWidth&&t.addSimpleSlice("imageWidth",new u.mu({descriptor:h,value:a.grid.imageWidth,options:{minValue:{type:0,value:B.ImageSizeMin},maxValue:{type:1,value:B.ImageSizeMax},unitSymbol:le.e_}}).build())}),e.build()},B.prototype.getSparklinesCard=function(p,a,d){var y=this;if(!_.isEmpty(p)&&this.hasSparklines(p)){var m=function(e){return a.getLocalizedString(e)},h=d===n.Y.TableEx?D.Z.sparklines:L.t.sparklines;return new u.CQ(new u.lg("sparklines"),"Sparkline_Label",h,m).addGroup("columns",function(o){return o.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){var t;e.withDisplayName("Sparkline_Singular_Label");for(var i=function(T){if(!(null===(t=T.type.misc)||void 0===t?void 0:t.sparkline))return"continue";var F=T?.objects,A={metadata:T.queryName};e.addContainerItem(T.queryName,T.displayName,function(te){var ae=r.FX.PropSparklinesChartType.setInstanceProperty(void 0,F);te.addGroup("sparklines",function(J){return J.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new u.uY({descriptor:(0,O.__assign)((0,O.__assign)({},h.chartType),{selector:A}),value:ae}).build()).addSimpleSlice("dataColor",new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},h.dataColor),{selector:A}),value:{value:y.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,F).solid.color}}).build()).addSimpleSlice("strokeWidth",new u.JN({descriptor:(0,O.__assign)((0,O.__assign)({},h.strokeWidth),{selector:A}),value:r.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,F),localize:m,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(ne){return ne.withHidden(ae!==V.U.line)})}),ae===V.U.line&&te.addGroup("markers",function(J){var ne=r.FX.PropSparklinesMarkerType.getValue(F);J.withDisplayName("Marker").addSimpleSlice("markers",new u.oM({descriptor:(0,O.__assign)((0,O.__assign)({},h.markers),{selector:A}),value:ne}).build()),null!=ne&&0!==ne&&J.addSimpleSlice("markerColor",new u.BT({descriptor:(0,O.__assign)((0,O.__assign)({},h.markerColor),{selector:A}),value:{value:y.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,F).solid.color}}).build()).addSimpleSlice("markerShape",new u.uY({descriptor:(0,O.__assign)((0,O.__assign)({},h.markerShape),{selector:A}),value:r.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,F)}).build()).addSimpleSlice("markerSize",new u.JN({descriptor:(0,O.__assign)((0,O.__assign)({},h.markerSize),{selector:A}),value:r.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,F),localize:m,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},l=0,c=p;l<c.length;l++)i(c[l])})}).build()}},B.prototype.hasSparklines=function(p){for(var a,d=0,y=p;d<y.length;d++)if(null===(a=y[d].type.misc)||void 0===a?void 0:a.sparkline)return!0;return!1},B.prototype.enumerateObjectInstances=function(p,a,d,y,m,h,o,e){void 0===h&&(h={}),void 0===o&&(o=!1),v.fF.assertValue(d,"dataView can't be undefined");var l,t=B.getMetadataObjects(d),i=this.getTablixTextClassProperties(e);switch(l=y===n.Y.Table?this.shouldShowTableTotalsOption(d)&&r.FX.PropGeneralTableTotals.getValue(t):this.shouldShowColumnSubtotalsOption(d)&&r.FX.PropGeneralMatrixColumnSubtotals.getValue(t)||this.shouldShowRowSubtotalsOption(d)&&r.FX.PropGeneralMatrixRowSubtotals.getValue(t),p.objectName){case r.FX.ObjectGeneral:this.enumerateGeneralOptions(a,t,y,d);break;case r.FX.ObjectGrid:this.enumerateGridOptions(a,t,y,i,h);break;case r.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(a,t,y,i,h);break;case r.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(a,t,y,o,i,h);break;case r.FX.ObjectValues:this.enumerateValuesOptions(a,t,y,i,h);break;case r.FX.ObjectTotal:y===n.Y.TableEx?this.enumerateTotalOptions(a,t,n.Y.TableEx,m,h,i):l&&(y===n.Y.Table?this.enumerateTotalOptions(a,t,n.Y.TableEx,m,h,i):this.enumerateGrandTotalOptions(a,t,y,i));break;case r.FX.ObjectColumnTotal:y===n.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(a,t,i,h);break;case r.FX.ObjectRowTotal:y===n.Y.PivotTable&&this.enumerateRowGrandTotalOptions(a,t,i,h);break;case r.FX.ObjectSubTotals:(l||y===n.Y.PivotTable)&&this.enumerateSubTotalsOptions(a,t,y,d,m,h,i);break;case r.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(a,this.getColumnsMetadata(d,y),y);break;case r.FX.ObjectSparklines:this.enumerateSparklines(a,this.getColumnsMetadata(d,y))}},B.prototype.getColumnsMetadata=function(p,a){switch(a){case n.Y.Table:case n.Y.TableEx:return this.getTableColumnMetadata(p);case n.Y.Matrix:case n.Y.PivotTable:return this.getMatrixValuesColumnMetadata(p);default:return void v.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+a)}},B.prototype.getTableColumnMetadata=function(p){if(p&&p.table&&!_.isEmpty(p.table.columns))return p.table.columns},B.prototype.getMatrixRowsColumnMetadata=function(p){if(p&&p.matrix&&!_.isEmpty(p.matrix.rows)){for(var a=[],d=0,y=p.matrix.rows.levels;d<y.length;d++)for(var h=0,o=y[d].sources;h<o.length;h++)a.push(o[h]);return a}},B.prototype.getMatrixColumnsColumnMetadata=function(p){if(p&&p.matrix&&!_.isEmpty(p.matrix.columns)){for(var a=[],d=0,y=p.matrix.columns.levels;d<y.length;d++)for(var h=0,o=y[d].sources;h<o.length;h++)a.push(o[h]);return a}},B.prototype.getMatrixValuesColumnMetadata=function(p){if(p&&p.matrix&&!_.isEmpty(p.matrix.valueSources))return p.matrix.valueSources},B.prototype.createVisualObjectInstance=function(p,a,d){void 0===a&&(a=null);var y={selector:a,objectName:p,properties:{}};return null!=d&&(y.displayName=d),y},B.prototype.enumerateGeneralOptions=function(p,a,d,y){var m=this.createVisualObjectInstance(r.FX.ObjectGeneral);switch(d){case n.Y.Table:r.FX.PropGeneralAutoSizeColumns.setInstanceProperty(m,a),r.FX.PropGeneralTextSize.setInstanceProperty(m,a),this.shouldShowTableTotalsOption(y)&&r.FX.PropGeneralTableTotals.setInstanceProperty(m,a);break;case n.Y.Matrix:r.FX.PropGeneralAutoSizeColumns.setInstanceProperty(m,a),r.FX.PropGeneralTextSize.setInstanceProperty(m,a),this.shouldShowRowSubtotalsOption(y)&&r.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(m,a),this.shouldShowColumnSubtotalsOption(y)&&r.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(m,a)}p.pushInstance(m)},B.prototype.enumerateGridOptions=function(p,a,d,y,m){var h=this.createVisualObjectInstance(r.FX.ObjectGrid),o=y.labelFontProperties.size&&y.labelFontProperties.size.pt,e=r.FX.PropGridVertical.getValue(a);r.FX.PropGridVertical.setInstanceProperty(h,a),e&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(h,a),r.FX.PropGridVerticalWeight.setInstanceProperty(h,a));var t=d===n.Y.Table||d===n.Y.TableEx,i=(t?r.FX.PropGridHorizontalTable:r.FX.PropGridHorizontalMatrix).getValue(a);(t?r.FX.PropGridHorizontalTable:r.FX.PropGridHorizontalMatrix).setInstanceProperty(h,a),i&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(h,a),r.FX.PropGridHorizontalWeight.setInstanceProperty(h,a)),r.FX.PropGridRowPadding.setInstanceProperty(h,a),(d===n.Y.PivotTable||d===n.Y.TableEx)&&r.FX.PropGridOutlineStyle.setInstanceProperty(h,a,this.outlineOverrideFn,r.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(h,a),r.FX.PropGridOutlineWeight.setInstanceProperty(h,a),(d===n.Y.PivotTable||d===n.Y.TableEx)&&r.FX.PropGridPivotTableTextSize.setInstanceProperty(h,a,y.fontSizeOverrideFn,o),r.FX.PropGridImageHeight.setInstanceProperty(h,a),p.pushInstance(h)},B.prototype.enumerateColumnHeadersOptions=function(p,a,d,y,m){var h=this.createVisualObjectInstance(r.FX.ObjectColumnHeaders),o=y.labelFontProperties.size&&y.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(h,a,y.fontColorOverrideFn,y.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(h,a),d===n.Y.PivotTable||d===n.Y.TableEx){var t=this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(a),a,r.UR);r.FX.PropColumnsOutlineStyle.setInstanceProperty(h,a,this.outlineOverrideFn,t);var i=this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(a),a);r.FX.PropColumnsOutlineWeight.setInstanceProperty(h,a,this.outlineOverrideFn,i);var l=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(a),a);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(h,a,this.outlineOverrideFn,l),r.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(h,a),r.FX.PropColumnsFontFamily.setInstanceProperty(h,a,y.fontFamilyOverrideFn,y.labelFontProperties.family),r.FX.PropColumnsFontSize.setInstanceProperty(h,a,y.fontSizeOverrideFn,o),r.FX.PropColumnsBold.setInstanceProperty(h,a),r.FX.PropColumnsItalic.setInstanceProperty(h,a),r.FX.PropColumnsUnderline.setInstanceProperty(h,a),r.FX.PropColumnsAlignment.setInstanceProperty(h,a)}else r.FX.PropColumnsOutline.setInstanceProperty(h,a);d===n.Y.PivotTable&&(r.FX.PropColumnsAlignmentTitle.setInstanceProperty(h,a),r.FX.PropColumnsUrlIcon.setInstanceProperty(h,a)),(d===n.Y.Table||d===n.Y.TableEx||d===n.Y.PivotTable)&&r.FX.PropColumnsWordWrap.setInstanceProperty(h,a),p.pushInstance(h)},B.prototype.enumerateRowHeadersOptions=function(p,a,d,y,m,h){void 0===y&&(y=!1);var o=this.createVisualObjectInstance(r.FX.ObjectRowHeaders),e=m.labelFontProperties.size&&m.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(o,a,m.fontColorOverrideFn,m.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(o,a),d===n.Y.PivotTable||d===n.Y.TableEx){var i=this.ensureOutline(r.FX.PropRowsOutlineStyle.getValue(a),a,r.Pi);r.FX.PropRowsOutlineStyle.setInstanceProperty(o,a,this.outlineOverrideFn,i)}else r.FX.PropRowsOutline.setInstanceProperty(o,a);if(d===n.Y.PivotTable){var l=this.ensureOutlineWeight(r.FX.PropRowsOutlineWeight.getValue(a),a);r.FX.PropRowsOutlineWeight.setInstanceProperty(o,a,this.outlineOverrideFn,l);var c=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(a),a);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(o,a,this.outlineOverrideFn,c),r.FX.PropRowsSteppedLayout.setInstanceProperty(o,a)&&r.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(o,a),r.FX.PropRowsUrlIcon.setInstanceProperty(o,a),r.FX.PropGeneralMatrixLayout.setInstanceProperty(o,a)!==b.t.Compact&&r.FX.PropRowsRepeatRowHeaders.setInstanceProperty(o,a)}(d===n.Y.Matrix||d===n.Y.PivotTable)&&r.FX.PropRowsWordWrap.setInstanceProperty(o,a),(d===n.Y.PivotTable||d===n.Y.TableEx)&&(r.FX.PropRowsFontFamily.setInstanceProperty(o,a,m.fontFamilyOverrideFn,m.labelFontProperties.family),r.FX.PropRowsFontSize.setInstanceProperty(o,a,m.fontSizeOverrideFn,e),r.FX.PropRowsBold.setInstanceProperty(o,a),r.FX.PropRowsItalic.setInstanceProperty(o,a),r.FX.PropRowsUnderline.setInstanceProperty(o,a),r.FX.PropRowsAlignment.setInstanceProperty(o,a)),d===n.Y.PivotTable&&y&&(r.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(o,a),r.FX.PropRowsShowExpandCollapseButtons.getValue(a)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(o,a),r.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(o,a))),p.pushInstance(o)},B.prototype.enumerateValuesOptions=function(p,a,d,y,m){var h=this.createVisualObjectInstance(r.FX.ObjectValues),o=y.labelFontProperties.size&&y.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(h,a,y.fontColorOverrideFn,y.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(h,a),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(h,a),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(h,a),d===n.Y.PivotTable&&(r.FX.PropValuesBandedRowHeaders.setInstanceProperty(h,a),r.FX.PropValuesOnRow.setInstanceProperty(h,a)),d===n.Y.PivotTable||d===n.Y.TableEx){var t=this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(a),a,r.IC);r.FX.PropValuesOutlineStyle.setInstanceProperty(h,a,this.outlineOverrideFn,t);var i=this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(a),a);r.FX.PropValuesOutlineWeight.setInstanceProperty(h,a,this.outlineOverrideFn,i);var l=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(a),a);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(h,a,this.outlineOverrideFn,l)}else r.FX.PropValuesOutline.setInstanceProperty(h,a);(d===n.Y.Table||d===n.Y.TableEx||d===n.Y.PivotTable)&&r.FX.PropValuesUrlIcon.setInstanceProperty(h,a),(d===n.Y.PivotTable||d===n.Y.TableEx)&&(r.FX.PropValuesWordWrap.setInstanceProperty(h,a),r.FX.PropValuesFontFamily.setInstanceProperty(h,a,y.fontFamilyOverrideFn,y.labelFontProperties.family),r.FX.PropValuesFontSize.setInstanceProperty(h,a,y.fontSizeOverrideFn,o),r.FX.PropValuesBold.setInstanceProperty(h,a),r.FX.PropValuesItalic.setInstanceProperty(h,a),r.FX.PropValuesUnderline.setInstanceProperty(h,a)),p.pushInstance(h)},B.prototype.enumerateTotalOptions=function(p,a,d,y,m,h){var o=this.createVisualObjectInstance(r.FX.ObjectTotal),e=h.boldLabelFontProperties.size&&h.boldLabelFontProperties.size.pt;if(d!==n.Y.TableEx||r.FX.PropTotalTableExTotals.setInstanceProperty(o,a)){if(d===n.Y.TableEx){var i=r.FX.PropTotalTableExTotalLabel.getValue(a,!0)||y(s.qT);o.properties[r.FX.PropTotalTableExTotalLabel.propertyName]=i}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(o,a,h.fontColorOverrideFn,h.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(o,a),d===n.Y.PivotTable||d===n.Y.TableEx){var c=this.ensureOutline(r.FX.PropTotalOutlineStyle.getValue(a),a,r.Sc);r.FX.PropTotalOutlineStyle.setInstanceProperty(o,a,this.outlineOverrideFn,c)}else r.FX.PropTotalOutline.setInstanceProperty(o,a);if(d===n.Y.TableEx){var C=this.ensureOutlineWeight(r.FX.PropTotalOutlineWeight.getValue(a),a);r.FX.PropTotalOutlineWeight.setInstanceProperty(o,a,this.outlineOverrideFn,C);var R=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(a),a);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(o,a,this.outlineOverrideFn,R)}(d===n.Y.PivotTable||d===n.Y.TableEx)&&(r.FX.PropTotalFontFamily.setInstanceProperty(o,a,h.fontFamilyOverrideFn,h.boldLabelFontProperties.family),r.FX.PropTotalFontSize.setInstanceProperty(o,a,h.fontSizeOverrideFn,e),r.FX.PropTotalBold.setInstanceProperty(o,a),r.FX.PropTotalItalic.setInstanceProperty(o,a),r.FX.PropTotalUnderline.setInstanceProperty(o,a))}p.pushInstance(o)},B.prototype.enumerateGrandTotalOptions=function(p,a,d,y){if(d!==n.Y.PivotTable){var m=this.createVisualObjectInstance(r.FX.ObjectTotal),h=y.boldLabelFontProperties.size&&y.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(m,a,y.fontColorOverrideFn,y.boldLabelFontProperties.color),r.FX.PropGrandTotalFontFamily.setInstanceProperty(m,a),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(m,a),r.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(m,a),d===n.Y.TableEx&&(r.FX.PropGrandTotalFontFamily.setInstanceProperty(m,a,y.fontFamilyOverrideFn,y.boldLabelFontProperties.family),r.FX.PropGrandTotalFontSize.setInstanceProperty(m,a,y.fontSizeOverrideFn,h),r.FX.PropGrandTotalBold.setInstanceProperty(m,a),r.FX.PropGrandTotalItalic.setInstanceProperty(m,a),r.FX.PropGrandTotalUnderline.setInstanceProperty(m,a)),p.pushInstance(m)}},B.prototype.enumerateColumnGrandTotalOptions=function(p,a,d,y){var m=this.createVisualObjectInstance(r.FX.ObjectColumnTotal),h=d.boldLabelFontProperties.size&&d.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(m,a,d.fontColorOverrideFn,d.boldLabelFontProperties.color),r.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(m,a),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(m,a),r.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(m,a),r.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(m,a,d.fontFamilyOverrideFn,d.boldLabelFontProperties.family),r.FX.PropColumnGrandTotalFontSize.setInstanceProperty(m,a,d.fontSizeOverrideFn,h),r.FX.PropColumnGrandTotalBold.setInstanceProperty(m,a),r.FX.PropColumnGrandTotalItalic.setInstanceProperty(m,a),r.FX.PropColumnGrandTotalUnderline.setInstanceProperty(m,a),p.pushInstance(m)},B.prototype.enumerateRowGrandTotalOptions=function(p,a,d,y){var m=this.createVisualObjectInstance(r.FX.ObjectRowTotal),h=d.boldLabelFontProperties.size&&d.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(m,a,d.fontColorOverrideFn,d.boldLabelFontProperties.color),r.FX.PropRowGrandTotalFontFamily.setInstanceProperty(m,a),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(m,a),r.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(m,a),r.FX.PropRowGrandTotalFontFamily.setInstanceProperty(m,a,d.fontFamilyOverrideFn,d.boldLabelFontProperties.family),r.FX.PropRowGrandTotalFontSize.setInstanceProperty(m,a,d.fontSizeOverrideFn,h),r.FX.PropRowGrandTotalBold.setInstanceProperty(m,a),r.FX.PropRowGrandTotalItalic.setInstanceProperty(m,a),r.FX.PropRowGrandTotalUnderline.setInstanceProperty(m,a),p.pushInstance(m)},B.prototype.enumerateSubTotalsOptions=function(p,a,d,y,m,h,o){var i,l,c,e=!1,t=!1;if(d===n.Y.PivotTable){v.fF.assertValue(m,"enumerateSubTotalsOptions - localizer"),i=m(s.qT);var C=this.createVisualObjectInstance(r.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(y)&&(e=r.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(C,a)),e&&(l=r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(a,!0)||i,C.properties[r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=l),p.pushInstance(C)}if(this.enumerateSubtotalsFontProperties(p,a,o,h,d,"Row"),e){C=this.createVisualObjectInstance(r.FX.ObjectSubTotals),r.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(C,a),p.pushInstance(C),C=this.createVisualObjectInstance(r.FX.ObjectSubTotals);var R=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(C,a);p.pushInstance(C,!1),R&&this.enumeratePerLevelSubtotals(p,y.matrix.rows.levels,l,m)}d===n.Y.PivotTable&&(C=this.createVisualObjectInstance(r.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(y)&&(t=r.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(C,a)),t&&(c=r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(a,!0)||i,C.properties[r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=c),p.pushInstance(C,!1)),this.enumerateSubtotalsFontProperties(p,a,o,h,d,"Column"),t&&(C=this.createVisualObjectInstance(r.FX.ObjectSubTotals),R=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(C,a),p.pushInstance(C,!1),v.fF.assert(function(){return!_.isEmpty(y.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),R&&this.enumeratePerLevelSubtotals(p,y.matrix.columns.levels,c,m))},B.prototype.enumerateSubtotalsFontProperties=function(p,a,d,y,m,h){var e=this.createVisualObjectInstance(r.FX.ObjectSubTotals,h?{id:h}:void 0),t=d.boldLabelFontProperties.size&&d.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(e,a,d.fontColorOverrideFn,d.boldLabelFontProperties.color,h),r.FX.PropSubTotalsFontFamily.setInstanceProperty(e,a,void 0,void 0,h),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(e,a,void 0,void 0,h),m===n.Y.PivotTable&&(r.FX.PropSubTotalsFontFamily.setInstanceProperty(e,a,d.fontFamilyOverrideFn,d.boldLabelFontProperties.family,h),r.FX.PropSubTotalsFontSize.setInstanceProperty(e,a,d.fontSizeOverrideFn,t,h),r.FX.PropSubTotalsBold.setInstanceProperty(e,a,void 0,void 0,h),r.FX.PropSubTotalsItalic.setInstanceProperty(e,a,void 0,void 0,h),r.FX.PropSubTotalsUnderline.setInstanceProperty(e,a,void 0,void 0,h),r.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(e,a,void 0,void 0,h)),p.pushInstance(e)},B.prototype.enumeratePerLevelSubtotals=function(p,a,d,y){v.fF.assert(function(){return!_.isEmpty(a)},"enumeratePerLevelSubtotals: Empty levels");for(var m=0,h=a;m<h.length;m++)for(var e=0,t=h[m].sources;e<t.length;e++){var i=t[e];if(!i.isMeasure){var l=this.createVisualObjectInstance(r.FX.ObjectSubTotals,{metadata:i.queryName},i.displayName);r.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(l,i.objects),p.pushInstance(l,!1),l=this.createVisualObjectInstance(r.FX.ObjectSubTotals,{metadata:i.queryName},y("Visual_PivotTable_TotalLabel",i.displayName));var c=r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(i.objects,!0)||d;l.properties[r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=c,p.pushInstance(l,!1)}}},B.prototype.enumerateColumnFormattingOptions=function(p,a,d){if(!_.isEmpty(a))for(var y=0,m=a;y<m.length;y++){var h=m[y];p.pushContainer({displayName:h.displayName});var o=h&&h.objects,e=this.createVisualObjectInstance(r.FX.ObjectColumnFormatting,{metadata:h.queryName});h.type.numeric&&(d===n.Y.PivotTable||d===n.Y.TableEx)&&(r.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(e,o),r.FX.PropColumnFormattingPrecision.setInstanceProperty(e,o),r.FX.PropColumnFormattingPrecision.setInstanceValidValues(e,{numberRange:{min:0,max:ee.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(e,o),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(e,o),(d===n.Y.PivotTable||d===n.Y.TableEx)&&r.FX.PropColumnFormattingAlignment.setInstanceProperty(e,o),r.FX.PropColumnFormattingStyleHeader.setInstanceProperty(e,o),r.FX.PropColumnFormattingStyleValues.setInstanceProperty(e,o),(d===n.Y.Matrix||d===n.Y.PivotTable)&&r.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(e,o),r.FX.PropColumnFormattingStyleTotal.setInstanceProperty(e,o),p.pushInstance(e),p.popContainer()}},B.prototype.enumerateSparklines=function(p,a){var d;if(!_.isEmpty(a))for(var y=0,m=a;y<m.length;y++){var h=m[y];if(null===(d=h.type.misc)||void 0===d?void 0:d.sparkline){p.pushContainer({displayName:h.displayName});var e=h&&h.objects,t=this.createVisualObjectInstance(r.FX.ObjectSparklines,{metadata:h.queryName});if(r.FX.PropSparklinesChartType.setInstanceProperty(t,e),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(t,e),r.FX.PropSparklinesChartType.getValue(e)===V.U.line){r.FX.PropSparklinesStrokeWidth.setInstanceProperty(t,e),r.FX.PropSparklinesStrokeWidth.setInstanceValidValues(t,{numberRange:{min:1,max:4}}),r.FX.PropSparklinesMarkerType.setInstanceProperty(t,e);var i=r.FX.PropSparklinesMarkerType.getValue(e);null!=i&&0!==i&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(t,e),r.FX.PropSparklinesMarkerSize.setInstanceProperty(t,e),r.FX.PropSparklinesMarkerSize.setInstanceValidValues(t,{numberRange:{min:3,max:5}}),r.FX.PropSparklinesMarkerShape.setInstanceProperty(t,e))}p.pushInstance(t),p.popContainer()}}},B.prototype.getTableObjects=function(p){var a=B.getMetadataObjects(p),d=r.FX.PropGeneralTextSize.getValue(a),y=null!=d?j.B.createFromPt(+d):void 0,m={general:{autoSizeColumnWidth:r.FX.PropGeneralAutoSizeColumns.getValue(a),textSize:y,totals:r.FX.PropGeneralTableTotals.getValue(a)}};m.grid={gridVertical:r.FX.PropGridVertical.getValue(a),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(a),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(a),gridHorizontal:r.FX.PropGridHorizontalTable.getValue(a),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(a),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(a),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(a),outlineWeight:r.FX.PropGridOutlineWeight.getValue(a),rowPadding:r.FX.PropGridRowPadding.getValue(a),imageHeight:r.FX.PropGridImageHeight.getValue(a)},m.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(a),backColor:this.tablixProperties.PropColumnsBackColor.getValue(a),outline:r.FX.PropColumnsOutline.getValue(a),wordWrap:r.FX.PropColumnsWordWrap.getValue(a)},m.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(a),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(a),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(a),outline:r.FX.PropValuesOutline.getValue(a),urlIcon:r.FX.PropValuesUrlIcon.getValue(a)},m.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(a),backColor:this.tablixProperties.PropTotalBackColor.getValue(a),outline:r.FX.PropTotalOutline.getValue(a)},m.columnFormatting={},m.formatters={};var h=this.getTableColumnMetadata(p);if(h)for(var o=0,e=h;o<e.length;o++){var t=e[o],i=t&&t.objects;m.columnFormatting[t.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(i),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(i),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(i),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(i),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(i)},m.formatters[t.queryName]=new g.g({column:t,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1})}return m},B.prototype.getMatrixObjects=function(p){var a=B.getMetadataObjects(p),d=r.FX.PropGeneralTextSize.getValue(a),y=null!=d?j.B.createFromPt(+d):void 0,m={general:{autoSizeColumnWidth:r.FX.PropGeneralAutoSizeColumns.getValue(a),textSize:y,rowSubtotals:r.FX.PropGeneralMatrixRowSubtotals.getValue(a),columnSubtotals:r.FX.PropGeneralMatrixColumnSubtotals.getValue(a),layout:r.FX.PropGeneralMatrixLayout.getValue(a)}};m.grid={gridVertical:r.FX.PropGridVertical.getValue(a),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(a),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(a),gridHorizontal:r.FX.PropGridHorizontalMatrix.getValue(a),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(a),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(a),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(a),outlineWeight:r.FX.PropGridOutlineWeight.getValue(a),rowPadding:r.FX.PropGridRowPadding.getValue(a),imageHeight:r.FX.PropGridImageHeight.getValue(a)},m.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(a),backColor:this.tablixProperties.PropColumnsBackColor.getValue(a),outline:r.FX.PropColumnsOutline.getValue(a)},m.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(a),backColor:this.tablixProperties.PropRowsBackColor.getValue(a),outline:r.FX.PropRowsOutline.getValue(a),wordWrap:r.FX.PropRowsWordWrap.getValue(a),repeatRowHeaders:r.FX.PropRowsRepeatRowHeaders.getValue(a)},m.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(a),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(a),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(a),outline:r.FX.PropValuesOutline.getValue(a)},m.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(a),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(a),applyToHeaders:r.FX.PropGrandTotalApplyToHeaders.getValue(a)},m.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(a),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(a)},m.columnFormatting={},m.formatters={};var h=this.getMatrixValuesColumnMetadata(p);if(h)for(var o=0,e=h;o<e.length;o++){var t=e[o],i=t&&t.objects;m.columnFormatting[t.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(i),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(i),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(i),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(i),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(i),styleSubTotals:r.FX.PropColumnFormattingStyleSubtotals.getValue(i)},m.formatters[t.queryName]=new g.g({column:t,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(p.matrix.rows,m.formatters),this.addMatrixHierarchyColumnsFormatters(p.matrix.columns,m.formatters),m},B.prototype.addMatrixHierarchyColumnsFormatters=function(p,a,d){if(p){v.fF.assertValue(p.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var y=0,m=p.levels;y<m.length;y++){var h=m[y];v.fF.assertValue(h.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var o=0,e=h.sources;o<e.length;o++){var t=e[o];if(!t.isMeasure){var i=t.queryName;a[i]=new g.g({column:t,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1}),d&&(d[i]=new g.g({column:t,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},B.prototype.addMatrixHierarchySubtotalLabels=function(p,a,d,y){if(p){v.fF.assertValue(p.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var m=0,h=p.levels;m<h.length;m++){var o=h[m];v.fF.assertValue(o.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var e=void 0,t=0,i=o.sources;t<i.length;t++){var l=i[t];l.isMeasure||(y&&(e=r.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(l.objects)),e||(e=d),a[l.queryName]={subtotalLabel:e})}}}},B.prototype.getPivotTableObjects=function(p,a,d,y,m,h){var o,e,t,i,l,c,C,R,T;void 0===h&&(h=!1);var f=B.getMetadataObjects(p),F=this.getTablixTextClassProperties(y),A=F.labelFontProperties.size&&F.labelFontProperties.size.pt,te=F.boldLabelFontProperties.size&&F.boldLabelFontProperties.size.pt,ae=r.FX.PropGridPivotTableTextSize.getValue(f,void 0,F.fontSizeOverrideFn,A),J=null!=ae?j.B.createFromPt(+ae):void 0,ne=r.FX.PropColumnsFontSize.getValue(f,void 0,F.fontSizeOverrideFn,A),he=null!=ne?j.B.createFromPt(+ne):void 0,de=r.FX.PropRowsFontSize.getValue(f,void 0,F.fontSizeOverrideFn,A),ce=null!=de?j.B.createFromPt(+de):void 0,Ce=r.FX.PropRowsExpandCollapseButtonsSize.getValue(f),ze=null!=Ce?j.B.createFromPt(+Ce):void 0,Re=r.FX.PropRowsExpandCompositeHierarchy.getValue(f),ge=r.FX.PropValuesFontSize.getValue(f,void 0,F.fontSizeOverrideFn,A),be=null!=ge?j.B.createFromPt(+ge):void 0,w=r.FX.PropGrandTotalFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te),I=(null!=w&&j.B.createFromPt(+w),r.FX.PropColumnGrandTotalFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te,void 0,["Column"])),G=null!=I?j.B.createFromPt(+I):void 0,q=r.FX.PropRowGrandTotalFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te,void 0,["Row"]),oe=null!=q?j.B.createFromPt(+q):void 0,me=r.FX.PropSubTotalsFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te),Se=(null!=me&&j.B.createFromPt(+me),r.FX.PropSubTotalsFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te,"Row")),Te=null!=Se?j.B.createFromPt(+Se):void 0,_e=r.FX.PropSubTotalsFontSize.getValue(f,void 0,F.fontSizeOverrideFn,te,"Column"),Ve=null!=_e?j.B.createFromPt(+_e):void 0,Xe=a(s.qT),Ne=r.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(f)||Xe,ke=r.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(f)||Xe,He=r.FX.PropRowsSteppedLayout.getValue(f),We=r.FX.PropGeneralMatrixLayout.getValue(f)||(He?b.t.Compact:b.t.Outline);m.matrixLayouts&&(He=We===b.t.Compact);var Ye={showBlankRows:r.FX.PropBlankRowsShowBlankRows.getValue(f),blankRowColor:null!==(o=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(f))&&void 0!==o?o:this.tablixProperties.PropValuesBackColorPrimary.getValue(f),blankRowTransparency:r.FX.PropBlankRowsTransparency.getValue(f),showBorder:r.FX.PropBlankRowsShowBorder.getValue(f),borderPosition:null!==(e=r.FX.PropBlankRowsBorderPosition.getValue(f))&&void 0!==e?e:"Top",borderColor:null!==(t=this.tablixProperties.PropBlankRowsBorderColor.getValue(f))&&void 0!==t?t:y.colorPalette.foregroundNeutralSecondary.value,borderTransparency:r.FX.PropBlankRowsBorderTransparency.getValue(f),borderWidth:r.FX.PropBlankRowsBorderWidth.getValue(f)},je={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.boldLabelFontProperties.color,"Row"),fontFamily:r.FX.PropSubTotalsFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.boldLabelFontProperties.family,"Row"),fontSize:Te,bold:r.FX.PropSubTotalsBold.getValue(f,void 0,void 0,void 0,"Row"),italic:r.FX.PropSubTotalsItalic.getValue(f,void 0,void 0,void 0,"Row"),underline:r.FX.PropSubTotalsUnderline.getValue(f,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(f,void 0,void 0,void 0,"Row"),applyToHeaders:r.FX.PropSubTotalsApplyToHeaders.getValue(f,void 0,void 0,void 0,"Row")},Ke={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.boldLabelFontProperties.color,"Column"),fontFamily:r.FX.PropSubTotalsFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.boldLabelFontProperties.family,"Column"),fontSize:Ve,bold:r.FX.PropSubTotalsBold.getValue(f,void 0,void 0,void 0,"Column"),italic:r.FX.PropSubTotalsItalic.getValue(f,void 0,void 0,void 0,"Column"),underline:r.FX.PropSubTotalsUnderline.getValue(f,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(f,void 0,void 0,void 0,"Column"),applyToHeaders:r.FX.PropSubTotalsApplyToHeaders.getValue(f,void 0,void 0,void 0,"Column")},Ze={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:r.FX.PropColumnGrandTotalFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.boldLabelFontProperties.family,void 0,["Column"]),fontSize:G,bold:r.FX.PropColumnGrandTotalBold.getValue(f),italic:r.FX.PropColumnGrandTotalItalic.getValue(f),underline:r.FX.PropColumnGrandTotalUnderline.getValue(f),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(f),applyToHeaders:r.FX.PropColumnGrandTotalApplyToHeaders.getValue(f)},Qe={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:r.FX.PropRowGrandTotalFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.boldLabelFontProperties.family,void 0,["Row"]),fontSize:oe,bold:r.FX.PropRowGrandTotalBold.getValue(f),italic:r.FX.PropRowGrandTotalItalic.getValue(f),underline:r.FX.PropRowGrandTotalUnderline.getValue(f),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(f),applyToHeaders:r.FX.PropRowGrandTotalApplyToHeaders.getValue(f)},ve={general:{autoSizeColumnWidth:r.FX.PropColumnPivotTableAutoSizeColumns.getValue(f),textSize:J,rowSubtotals:r.FX.PropSubTotalsPivotTableRowSubtotals.getValue(f),columnSubtotals:r.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(f),layout:We},grid:{gridVertical:r.FX.PropGridVertical.getValue(f),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(f),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(f),gridHorizontal:r.FX.PropGridHorizontalMatrix.getValue(f),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(f),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(f),outline:r.FX.PropGridOutlineStyle.getValue(f)||r.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(f),outlineWeight:r.FX.PropGridOutlineWeight.getValue(f),rowPadding:r.FX.PropGridRowPadding.getValue(f),imageHeight:r.FX.PropGridImageHeight.getValue(f),imageWidth:r.FX.PropGridImageWidth.getValue(f)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.labelFontProperties.color),fontFamily:r.FX.PropColumnsFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.labelFontProperties.family),fontSize:he,bold:r.FX.PropColumnsBold.getValue(f),italic:r.FX.PropColumnsItalic.getValue(f),underline:r.FX.PropColumnsUnderline.getValue(f),backColor:this.tablixProperties.PropColumnsBackColor.getValue(f),outline:this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(f),f,r.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(f),f),urlIcon:r.FX.PropColumnsUrlIcon.getValue(f),wordWrap:r.FX.PropColumnsWordWrap.getValue(f),alignment:r.FX.PropColumnsAlignment.getValue(f),titleAlignment:r.FX.PropColumnsAlignmentTitle.getValue(f)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(f,void 0,F.fontColorOverrideFn,F.labelFontProperties.color),fontFamily:r.FX.PropRowsFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.labelFontProperties.family),fontSize:ce,bold:r.FX.PropRowsBold.getValue(f),italic:r.FX.PropRowsItalic.getValue(f),underline:r.FX.PropRowsUnderline.getValue(f),backColor:this.tablixProperties.PropRowsBackColor.getValue(f),outline:this.ensureOutline(r.FX.PropRowsOutlineStyle.getValue(f),f,r.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(r.FX.PropRowsOutlineWeight.getValue(f),f),steppedLayout:He,steppedLayoutIndentation:r.FX.PropRowsSteppedLayoutIndentation.getValue(f),urlIcon:r.FX.PropRowsUrlIcon.getValue(f),wordWrap:r.FX.PropRowsWordWrap.getValue(f),alignment:r.FX.PropRowsAlignment.getValue(f),showExpandCollapseButtons:!!d&&r.FX.PropRowsShowExpandCollapseButtons.getValue(f),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(f),expandCollapseButtonsSize:ze,expandCompositeHierarchy:Re,repeatRowHeaders:r.FX.PropRowsRepeatRowHeaders.getValue(f),legacyStyleDisabled:r.FX.PropRowsLegacyStyleDisabled.getValue(f)},values:{fontFamily:r.FX.PropValuesFontFamily.getValue(f,void 0,F.fontFamilyOverrideFn,F.labelFontProperties.family),fontSize:be,bold:r.FX.PropValuesBold.getValue(f),italic:r.FX.PropValuesItalic.getValue(f),underline:r.FX.PropValuesUnderline.getValue(f),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(f,void 0,F.fontColorOverrideFn,F.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(f),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(f),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(f),bandedRowHeaders:r.FX.PropValuesBandedRowHeaders.getValue(f),outline:this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(f),f,r.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(f),f),urlIcon:r.FX.PropValuesUrlIcon.getValue(f),wordWrap:r.FX.PropValuesWordWrap.getValue(f),valuesOnRow:r.FX.PropValuesOnRow.getValue(f)},columnGrandTotal:Ze,rowGrandTotal:Qe,subtotals:{rowSubtotalsPosition:We===b.t.Tabular?H.I:r.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(f),rowSubtotalsLabel:Ne,columnSubtotalsLabel:ke},rowSubtotals:je,columnSubtotals:Ke,blankRows:Ye,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ae=this.getMatrixValuesColumnMetadata(p);if(Ae)for(var De=0,Ge=Ae;De<Ge.length;De++){var Pe=Ge[De],ye=Pe&&Pe.objects;ve.columnFormatting[Pe.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(ye),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(ye),alignment:r.FX.PropColumnFormattingAlignment.getValue(ye),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(ye),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(ye),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(ye),styleSubTotals:r.FX.PropColumnFormattingStyleSubtotals.getValue(ye),dataBarsSettings:r.FX.PropColumnFormattingDataBars.getValue(ye),icon:r.FX.PropValuesIcon.getValue(ye)};var Ie=void 0,Ee=void 0;if(Pe.type.numeric&&(Ie=r.FX.PropColumnFormattingDisplayUnits.getValue(ye),Ee=r.FX.PropColumnFormattingPrecision.getValue(ye)),ve.formatters[Pe.queryName]=new g.g({column:Pe,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Ie,precision:Ee,trailingZeroes:!0}),ve.tooltipFormatters[Pe.queryName]=new g.g({column:Pe,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Ie,precision:Ee,trailingZeroes:!0}),null!==(i=Pe.type.misc)&&void 0!==i&&i.sparkline){var Je=r.FX.PropSparklinesChartType.getValue(ye),Ue=new we(Pe.displayName,Pe.type,a);ve.formatters[Pe.queryName]=Ue,ve.tooltipFormatters[Pe.queryName]=Ue,ve.sparklines[Pe.queryName]={chartType:Je,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(ye).solid.color,strokeWidth:r.FX.PropSparklinesStrokeWidth.getValue(ye),marker:{show:!0,typeFlags:r.FX.PropSparklinesMarkerType.getValue(ye),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(ye).solid.color,size:r.FX.PropSparklinesMarkerSize.getValue(ye),shape:r.FX.PropSparklinesMarkerShape.getValue(ye)}}}}h&&(ve.annotationFormatting={columnHeaders:{}},_.forEach(null===(l=p.metadata)||void 0===l?void 0:l.columns,function(Le){var Be;if(null!==(Be=Le.objects)&&void 0!==Be&&Be.annotations){var Oe=(0,z.NA)(Le.objects,L.t.annotations.highlights);Oe&&(null!=Oe.backColor||!0===Oe.emphasizeText)&&(ve.annotationFormatting.columnHeaders[Le.queryName]={backColor:Oe.backColor,bold:Oe.emphasizeText})}}),_.isEmpty(ve.annotationFormatting.columnHeaders)&&(ve.annotationFormatting=void 0));var $e=r.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(f),qe=r.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(f);return this.addMatrixHierarchySubtotalLabels(null===(c=p?.matrix)||void 0===c?void 0:c.rows,ve.columnFormatting,Ne,$e),this.addMatrixHierarchySubtotalLabels(null===(C=p?.matrix)||void 0===C?void 0:C.columns,ve.columnFormatting,ke,qe),this.addMatrixHierarchyColumnsFormatters(null===(R=p?.matrix)||void 0===R?void 0:R.rows,ve.formatters,ve.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(T=p?.matrix)||void 0===T?void 0:T.columns,ve.formatters,ve.tooltipFormatters),ve},B.prototype.getTableExObjects=function(p,a,d,y){var m,h=B.getMetadataObjects(p),o=this.getTablixTextClassProperties(d),e=o.labelFontProperties.size&&o.labelFontProperties.size.pt,t=o.boldLabelFontProperties.size&&o.boldLabelFontProperties.size.pt,i=r.FX.PropGridPivotTableTextSize.getValue(h),l=null!=i?j.B.createFromPt(+i):void 0,c=r.FX.PropColumnsFontSize.getValue(h,void 0,o.fontSizeOverrideFn,e),C=null!=c?j.B.createFromPt(+c):void 0,R=r.FX.PropValuesFontSize.getValue(h,void 0,o.fontSizeOverrideFn,e),T=null!=R?j.B.createFromPt(+R):void 0,f=r.FX.PropTotalFontSize.getValue(h,void 0,o.fontSizeOverrideFn,t),F=null!=f?j.B.createFromPt(+f):void 0,A=r.FX.ProprowWithReferenceText.getValue(h),te={general:{autoSizeColumnWidth:r.FX.PropColumnPivotTableAutoSizeColumns.getValue(h),textSize:l,totals:r.FX.PropTotalTableExTotals.getValue(h)}};te.grid={gridVertical:r.FX.PropGridVertical.getValue(h),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(h),gridVerticalWeight:r.FX.PropGridVerticalWeight.getValue(h),gridHorizontal:r.FX.PropGridHorizontalTable.getValue(h),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(h),gridHorizontalWeight:r.FX.PropGridHorizontalWeight.getValue(h),outline:r.FX.PropGridOutlineStyle.getValue(h)||r.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(h),outlineWeight:r.FX.PropGridOutlineWeight.getValue(h),rowPadding:r.FX.PropGridRowPadding.getValue(h),imageHeight:r.FX.PropGridImageHeight.getValue(h),imageWidth:r.FX.PropGridImageWidth.getValue(h)},te.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(h,void 0,o.fontColorOverrideFn,o.labelFontProperties.color),fontFamily:r.FX.PropColumnsFontFamily.getValue(h,void 0,o.fontFamilyOverrideFn,o.labelFontProperties.family),fontSize:C,bold:r.FX.PropColumnsBold.getValue(h),italic:r.FX.PropColumnsItalic.getValue(h),underline:r.FX.PropColumnsUnderline.getValue(h),backColor:this.tablixProperties.PropColumnsBackColor.getValue(h),outline:this.ensureOutline(r.FX.PropColumnsOutlineStyle.getValue(h),h,r.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(h),h),outlineWeight:this.ensureOutlineWeight(r.FX.PropColumnsOutlineWeight.getValue(h),h),wordWrap:r.FX.PropColumnsWordWrap.getValue(h),alignment:r.FX.PropColumnsAlignment.getValue(h)},te.values={fontFamily:r.FX.PropValuesFontFamily.getValue(h,void 0,o.fontFamilyOverrideFn,o.labelFontProperties.family),fontSize:T,bold:r.FX.PropValuesBold.getValue(h),italic:r.FX.PropValuesItalic.getValue(h),underline:r.FX.PropValuesUnderline.getValue(h),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(h,void 0,o.fontColorOverrideFn,o.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(h),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(h),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(h),outline:this.ensureOutline(r.FX.PropValuesOutlineStyle.getValue(h),h,r.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(h),h),outlineWeight:this.ensureOutlineWeight(r.FX.PropValuesOutlineWeight.getValue(h),h),urlIcon:r.FX.PropValuesUrlIcon.getValue(h),wordWrap:r.FX.PropValuesWordWrap.getValue(h)};var ae=r.FX.PropTotalTableExTotalLabel.getValue(h);te.total={totalLabel:ae||a(s.qT),totalPlaceholderLabel:a(s.bn),isDefaultTotalLabel:!ae,fontFamily:r.FX.PropTotalFontFamily.getValue(h,void 0,o.fontFamilyOverrideFn,o.boldLabelFontProperties.family),fontSize:F,bold:r.FX.PropTotalBold.getValue(h),italic:r.FX.PropTotalItalic.getValue(h),underline:r.FX.PropTotalUnderline.getValue(h),fontColor:this.tablixProperties.PropTotalFontColor.getValue(h,void 0,o.fontColorOverrideFn,o.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(h),outline:this.ensureOutline(r.FX.PropTotalOutlineStyle.getValue(h),h,r.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(h),h),outlineWeight:this.ensureOutlineWeight(r.FX.PropTotalOutlineWeight.getValue(h),h)},te.columnFormatting={},te.formatters={},te.tooltipFormatters={},te.sparklines={};var J=this.getTableColumnMetadata(p);if(J)for(var ne=0,he=J;ne<he.length;ne++){var de=he[ne];if(de){var ce=de.objects,Ce=de.queryName;te.columnFormatting[Ce]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(ce),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(ce),alignment:r.FX.PropColumnFormattingAlignment.getValue(ce),styleHeader:r.FX.PropColumnFormattingStyleHeader.getValue(ce),styleValues:r.FX.PropColumnFormattingStyleValues.getValue(ce),styleTotal:r.FX.PropColumnFormattingStyleTotal.getValue(ce),dataBarsSettings:r.FX.PropColumnFormattingDataBars.getValue(ce),icon:r.FX.PropValuesIcon.getValue(ce)};var ze=void 0,Re=void 0;if(de.type.numeric&&(ze=r.FX.PropColumnFormattingDisplayUnits.getValue(ce),Re=r.FX.PropColumnFormattingPrecision.getValue(ce)),te.formatters[Ce]=new g.g({column:de,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:ze,precision:Re,trailingZeroes:!0}),te.tooltipFormatters[Ce]=new g.g({column:de,formatStringPropId:r.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:ze,precision:Re,trailingZeroes:!0}),null!==(m=de.type.misc)&&void 0!==m&&m.sparkline){var ge=r.FX.PropSparklinesChartType.getValue(ce),be=new we(de.displayName,de.type,a);te.formatters[Ce]=be,te.tooltipFormatters[Ce]=be,te.sparklines[Ce]={chartType:ge,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(ce).solid.color,strokeWidth:r.FX.PropSparklinesStrokeWidth.getValue(ce),marker:{show:!0,typeFlags:r.FX.PropSparklinesMarkerType.getValue(ce),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(ce).solid.color,size:r.FX.PropSparklinesMarkerSize.getValue(ce),shape:r.FX.PropSparklinesMarkerShape.getValue(ce)}}}}}return te.rowWithReferenceText={rowWithReferenceText:A},te},B.prototype.ensureOutline=function(p,a,d){var y;return null!==(y=p??r.FX.PropGridOutlineStyle.getValue(a))&&void 0!==y?y:d},B.prototype.ensureOutlineWeight=function(p,a){return p??r.FX.PropGridOutlineWeight.getValue(a)},B.prototype.outlineOverrideFn=function(p,a){return!!(0,z.NA)(p,a)},B.prototype.ensureOutlineColor=function(p,a){return p??this.tablixProperties.PropGridOutlineColor.getValue(a)},B.getTextSizeInPx=function(p){return x.FP.toString(p.px)},B.prototype.shouldShowTableTotalsOption=function(p){return!(p&&p.table&&!_.isEmpty(p.table.columns)&&_.some(p.table.columns,function(d){return d.discourageAggregationAcrossGroups}))},B.prototype.shouldShowRowSubtotalsOption=function(p){return!(!p||(0,N.be)(p.matrix)<1||this.isDiscourageAggregationAcrossGroups(p.matrix.rows.levels))},B.prototype.shouldShowColumnSubtotalsOption=function(p){if(!p||!p.matrix||(0,N.pr)(p.matrix.columns)<1)return!1;var a=p.matrix.columns.levels;return p.matrix.valueSources.length>1&&(a=_.initial(a)),!this.isDiscourageAggregationAcrossGroups(a)},B.prototype.isDiscourageAggregationAcrossGroups=function(p){var a=_.last(p);return a&&_.some(a.sources,function(d){return d.discourageAggregationAcrossGroups})},B.prototype.getTablixTextClassProperties=function(p){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,M.m)(p,"label"),boldLabelFontProperties:(0,M.m)(p,"boldLabel")}},B.prototype.fontSizeOverridePredicate=function(){var p=this;return function(a,d,y){var m=(0,z.RK)(a,d.objectName),h=(0,z.RK)(a,r.FX.ObjectGrid),o=(0,z.RK)(a,r.FX.ObjectValues),e=(0,z.RK)(a,r.FX.ObjectSubTotals),t=p.gridDependentObject(d.objectName),i=(0,U.N)(h,"textSize",void 0)&&!(0,U.N)(m,d.propertyName,void 0,y),l=p.valuesDependentObject(d.objectName),c=(0,U.N)(o,"fontSize",void 0)&&!(0,U.N)(m,d.propertyName,void 0,y),C=p.subTotalsDependentObject(d.objectName),R=p.getSubTotalsValue(d.objectName,e,"fontSize",void 0)&&!(0,U.N)(m,d.propertyName,void 0,y),f=!!(0,U.N)(m,d.objectName===r.FX.ObjectGrid?"textSize":"fontSize",void 0,y);return t&&i||l&&c||C&&R||f}},B.prototype.fontFamilyOverridePredicate=function(){var p=this;return function(a,d,y){var m=(0,z.RK)(a,d.objectName),h=(0,z.RK)(a,r.FX.ObjectValues),o=(0,z.RK)(a,r.FX.ObjectSubTotals),e=p.valuesDependentObject(d.objectName),t=(0,U.N)(h,"fontFamily",void 0)&&!(0,U.N)(m,d.propertyName,void 0),i=p.subTotalsDependentObject(d.objectName),l=p.getSubTotalsValue(d.objectName,o,"fontFamily",void 0)&&!(0,U.N)(m,d.propertyName,void 0,y),c=!!(0,U.N)(m,"fontFamily",void 0,y);return e&&t||i&&l||c}},B.prototype.fontColorOverridePredicate=function(){return function(p,a,d){var y=(0,z.RK)(p,a.objectName),m=a.objectName===r.FX.ObjectValues?"fontColorPrimary":"fontColor",h=(0,U.N)(y,m);return!!(0,U.N)(y,m,h,d)}},B.prototype.gridDependentObject=function(p){return this.valuesDependentObject(p)||p===r.FX.ObjectRowHeaders||p===r.FX.ObjectColumnHeaders||p===r.FX.ObjectValues},B.prototype.valuesDependentObject=function(p){return this.subTotalsDependentObject(p)||p===r.FX.ObjectSubTotals},B.prototype.subTotalsDependentObject=function(p){return p===r.FX.ObjectTotal||p===r.FX.ObjectRowTotal||p===r.FX.ObjectColumnTotal},B.prototype.getSubTotalsValue=function(p,a,d,y){var m=p===r.FX.ObjectRowTotal?"Row":p===r.FX.ObjectColumnTotal?"Column":void 0;return y=y??(0,U.N)(a,d),(0,U.N)(a,d,y,m)},B.ImageSizeMin=8,B.ImageSizeMax=512,B}(),we=function(){function B(p,a,d){this.displayName=p,this.sparklineType=a,this.localizer=d}return B.prototype.format=function(p,a){var d=function(B,p,a){if(a){var d=a.points;if(d=_.filter(d,function(C){return null!=C.x&&null!=C.y}),!_.isEmpty(d)){var y=_.size(d);if(1===y)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[B,a.lowY]};var m=p.misc.sparkline.groupingType;if(m&&(m.numeric||m.dateTime||m.temporal)){var o=d[0].y,e=d[y-1].y;if(!_.some(d,function(C){return C.y!==o}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[B,o]};if((0,K.JM)(_.map(d,function(C){return C.x}),_.map(d,function(C){return C.y}),!0).rSquared>.5){var c,l="Sparkline_Tooltip_ScalarTrend";return l+=e>o?"Up":"Down",0!==o?(c=100*(e-o)/o,l+="Percent"):(c=e-o,l+="Value"),{key:l,parameters:[B,+Math.abs(c).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[B,a.lowY,a.highY]}}return a.lowY===a.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[B,a.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[B,a.lowY,a.highY]}}}}(this.displayName,this.sparklineType,p);if(d)return this.localizer.apply(this,(0,O.__spreadArray)([d.key],d.parameters,!1))},B}()},72687:function(Fe,fe,E){E.r(fe),E.d(fe,{Table:function(){return U}});var O=E(54522),L=E(28579),D=E(55007),Z=E(62458),ie=E(39681),re=E(46135),ee=E(99318),M=E(16324),j=E(93340),le=E(71090),r=E(73889),V=E(81671),v=E(93414),u=E(74304),x=E(44245),z=function(){function W(S,N,K,Y){this.tableDataView=S,this.isDataComplete=N,this.formatters=K,this.tablixProperties=Y,Z.fF.assertValue(S,"tableDataView"),Z.fF.assertValue(K,"formatters")}return W.prototype.getColumnHierarchyDepth=function(){return 1},W.prototype.getRowHierarchyDepth=function(){return 1},W.prototype.getLeafCount=function(S){return S.length},W.prototype.getLeafAt=function(S,N){return S[N]},W.prototype.getParent=function(S){return null},W.prototype.getIndex=function(S){return S?this.isRow(S)?S.index:this.getColumnIndex(S):-1},W.prototype.isRow=function(S){return!!S&&(void 0!==S.index&&void 0!==S.values)},W.prototype.getColumnIndex=function(S){return W.getIndex(this.tableDataView.columns,S)},W.prototype.isLeaf=function(S){return!0},W.prototype.isRowHierarchyLeaf=function(S){return!1},W.prototype.isColumnHierarchyLeaf=function(S){return!0},W.prototype.isFirstItem=function(S,N){return S===N[0]},W.prototype.areAllParentsFirst=function(S,N){return this.isFirstItem(S,N)},W.prototype.isLastItem=function(S,N){return Z.fF.assertValue(S,"item"),(N===this.tableDataView.columns||this.isDataComplete)&&S===_.last(N)},W.prototype.areAllParentsLast=function(S,N){return this.isLastItem(S,N)},W.prototype.getChildren=function(S){return null},W.prototype.getChildrenLevelDifference=function(S){return 1/0},W.prototype.getCount=function(S){return S.length},W.prototype.getAt=function(S,N){return S[N]},W.prototype.getLevel=function(S){return 0},W.prototype.getIntersection=function(S,N){var K,Y,g=!1,s=new j.ri,n=W.getIndex(this.tableDataView.columns,N);if(s.column.index=n,s.column.isFirst=0===n,s.column.isLast=n===this.tableDataView.columns.length-1,null!=S.totalCells)g=!0,K=S.totalCells[n],Y=S.objects&&S.objects[n];else{var H=S,k=H.index;s.row.index=k,s.row.isFirst=0===k,s.row.isLast=this.isDataComplete&&k===this.tableDataView.rows.length-1,K=H.values[n],Y=H.values.objects&&H.values.objects[n]}var X=new j.jG(K,Y,!1,!1,g,!1,!1,N,this.formatters[N.queryName]);if(X.position=s,S&&S.values){var se=S.values.objects;if(se){var ue=se[n];ue&&(X.backColor=this.tablixProperties.PropValuesBackColor.getValue(ue))}}return X},W.prototype.getCorner=function(S,N){return null},W.prototype.headerItemEquals=function(S,N){return S===N||(S.displayName&&N.displayName?(0,ee.Mw)(S,N):!(!this.isRow(S)||!this.isRow(N))&&S.index===N.index)},W.prototype.bodyCellItemEquals=function(S,N){return S.isMatch(N)},W.prototype.cornerCellItemEquals=function(S,N){return!0},W.prototype.update=function(S,N,K){this.tableDataView=S,this.isDataComplete=N,this.formatters=K},W.getIndex=function(S,N){for(var K=0,Y=S.length;K<Y;K++){var g=S[K];if(null!=g.index&&null!=N.index&&g.index===N.index)return K;if(N===S[K])return K}return-1},W}(),U=function(){function W(S){this.isTouchDisabled=S&&S.isTouchDisabled}return W.prototype.init=function(S){this.element=S.element,this.updateViewport(S.viewport),this.isInteractive=S.interactivity&&null!=S.interactivity.selection,this.getLocalizedString=S.host.getLocalizedString.bind(S.host),this.hostServices=S.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1,this.style=S.style,this.tablixPropertyManager=new u.U(this.style)},W.converter=function(S,N){var K=S.table;Z.fF.assertValue(K,"table"),Z.fF.assertValue(K.rows,"table.rows");var Y=(0,ie.ED)(K);Y.visualRows=[];for(var g=0;g<K.rows.length;g++)Y.visualRows.push({index:g,values:K.rows[g]});return Y.formattingProperties=N.getTableObjects(S),Y},W.prototype.onResizing=function(S){this.updateViewport(S)},W.prototype.getColumnWidthManager=function(){return this.columnWidthManager},W.prototype.onDataChanged=function(S){Z.fF.assertValue(S,"options");var N=S.dataViews;if(N&&N.length>0){var K=this.dataView;if(this.dataView=N[0],this.persistingObjects)return void(this.persistingObjects=!1);var Y=W.converter(this.dataView,this.tablixPropertyManager);S.operationKind===re.su.Append?(this.createOrUpdateHierarchyNavigator(Y),this.tablixControl.updateModels(!1,Y.visualRows,Y.columns),this.refreshControl(!1)):(this.createOrUpdateHierarchyNavigator(Y),this.createColumnWidthManager(),this.createOrUpdateTablixControl(Y),this.updateInternal(K,Y))}this.waitingForData=!1,this.waitingForSort=!1},W.prototype.createColumnWidthManager=function(){var S=this;this.columnWidthManager?this.columnWidthManager.updateDataView(this.dataView):this.columnWidthManager=new V.K(this.dataView,!1,function(N){return S.persistColumnWidths(N)})},W.prototype.persistColumnWidths=function(S){this.persistingObjects=!0,this.hostServices.persistProperties(S)},W.prototype.updateViewport=function(S){this.currentViewport=S,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},W.prototype.refreshControl=function(S){(this.element.is(":visible")||1===this.getLayoutKind())&&this.tablixControl.refresh(S)},W.prototype.getLayoutKind=function(){return this.isInteractive?0:1},W.prototype.createOrUpdateHierarchyNavigator=function(S){var N=!this.dataView.metadata.segment;if(this.tablixControl)this.hierarchyNavigator.update(S,N,S.formattingProperties.formatters);else{var K=new z(S,N,S.formattingProperties.formatters,this.tablixPropertyManager.tablixProperties);this.hierarchyNavigator=K}},W.prototype.createOrUpdateTablixControl=function(S){this.tablixControl?this.tablixControl.getBinder().updateDataView(S):this.tablixControl=this.createControl(this.hierarchyNavigator,S)},W.prototype.createControl=function(S,N){var K=this,Y=this.getLayoutKind(),g=N.formattingProperties.general.textSize,n=new x.Yc({onBindRowHeader:function(Q){return K.onBindRowHeader(Q)},onColumnHeaderClick:function(Q,se){return K.onColumnHeaderClick(Q,se)},layoutKind:Y,columnWidthManager:this.columnWidthManager,tablixProperties:this.tablixPropertyManager.tablixProperties},N),b=1===Y?M.dk.createLayoutManager(n):M.Vz.createLayoutManager(n,this.columnWidthManager),H=document.createElement("div");this.element.append(H);var k={interactive:this.isInteractive,enableTouchSupport:!this.isTouchDisabled,layoutKind:Y,fontSize:u.U.getTextSizeInPx(g)};return new v.d(S,b,n,H,k)},W.prototype.updateInternal=function(S,N){var K=this,Y=N.formattingProperties.general.textSize;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize((0,O.Gr)(this.dataView)),this.tablixControl.fontSize=u.U.getTextSizeInPx(Y),this.tablixControl.wordWrapColumnHeaders=N.formattingProperties.columnHeaders.wordWrap,this.verifyHeaderResize(),this.tablixControl.updateModels(!0,N.visualRows,N.columns);var g=this.createTotalsRow(this.dataView);this.tablixControl.rowDimension.setFooter(g),this.tablixControl.viewport=this.currentViewport;var s=this.shouldClearControl(S,this.dataView);setTimeout(function(){K.refreshControl(s);var n=K.columnWidthManager.onColumnsRendered(K.tablixControl.layoutManager.columnWidthsToPersist);K.persistingObjects&&!n&&(K.persistingObjects=!1)},0)},W.prototype.shouldClearControl=function(S,N){return!(this.waitingForSort&&S&&N&&(0,ee.C0)(S.metadata,N.metadata))},W.prototype.createTotalsRow=function(S){if(!D.FX.PropGeneralTableTotals.getValue(S.metadata.objects))return null;var N=S.table.totals;if(!N||0===N.length)return null;for(var K=[],g=0,s=S.table.columns.length;g<s;++g){var n=N[g];K.push(null!=n?n:0===g?this.getLocalizedString("TableTotalLabel"):"")}return{totalCells:K,objects:S.table.totals.objects}},W.prototype.onBindRowHeader=function(S){this.needsMoreData(S)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},W.prototype.onColumnHeaderClick=function(S,N){this.waitingForSort=!0,this.hostServices.onCustomSort((0,j.Av)(S,N))},W.prototype.needsMoreData=function(S){if(this.waitingForData||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var K=this.tablixControl.rowDimension.getItemsCount()*le.sR;return this.hierarchyNavigator.getIndex(S)>=K},W.prototype.enumerateObjectInstances=function(S){var N=new L.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(S,N,this.dataView,r.Y.Table),N.complete()},W.prototype.enumerateObjectRepetition=function(){var S=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(S,this.dataView,r.Y.Table),S},W.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},W.prototype.onViewModeChanged=function(S){this.tablixControl&&this.tablixControl.toggleTouchBindings(1!==S),this.updateViewport(this.currentViewport)},W.prototype.verifyHeaderResize=function(){var S=this.shouldAllowHeaderResize();S!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=S,this.tablixControl.layoutManager.setAllowHeaderResize(S))},W}()},44245:function(Fe,fe,E){E.d(fe,{Yc:function(){return v},aV:function(){return le},cP:function(){return r},ji:function(){return V}});var O=E(54522),L=E(55007),D=E(40550),Z=E(32041),ie=E(64329),re=E(48066),ee=E(66001),M=E(93340),j=E(71090);function le(u,x,z,U,W){var S,N;x.fontFamily=j.F2,x.fontColor=j.lN,x.borders.bottom=new M.om(L.FX.PropGridOutlineWeight.defaultValue,W.PropGridOutlineColor.getValue(null));var K=z.grid,Y=z.columnHeaders,n=z.total.outline,b=Y.outline,H=z.values.outline,k=null!==(S=Y.outlineWeight)&&void 0!==S?S:K.outlineWeight,X=null!==(N=Y.outlineColor)&&void 0!==N?N:K.outlineColor;x.borders.top=new M.om,x.borders.top.applyParams((0,D.yo)(b),k,X,M.Pb.Outline),x.borders.bottom=new M.om,x.borders.bottom.applyParams((0,D.mv)(b),k,X,M.Pb.Outline),x.borders.left=new M.om,u.column.isFirst&&(x.borders.left.applyParams((0,D.fs)(b),k,X,M.Pb.Outline),!(0,D.fs)(b)&&((0,D.fs)(n)||(0,D.fs)(H))&&(x.paddings.left+=k)),x.borders.right=new M.om,u.column.isLast?(x.borders.right.applyParams((0,D.BK)(b),k,X,M.Pb.Outline),!(0,D.BK)(b)&&((0,D.BK)(n)||(0,D.BK)(H))&&(x.paddings.right+=k)):x.borders.right.applyParams(K.gridVertical,K.gridVerticalWeight,K.gridVerticalColor,M.Pb.Gridline),x.fontColor=U&&U.styleHeader&&U.fontColor?U.fontColor:Y.fontColor,x.backColor=U&&U.styleHeader&&U.backColor?U.backColor:Y.backColor,x.paddings.top=x.paddings.bottom=K.rowPadding}function r(u,x,z,U,W,S){var N,K;u.row.isLast||(z.borders.bottom=new M.om(L.FX.PropGridHorizontalWeight.defaultValue,S.PropGridHorizontalColor.getValue(null)));var Y=U.grid,g=U.values,b=U.total.outline,H=g.outline,k=U.columnHeaders.outline,X=null!==(N=g.outlineWeight)&&void 0!==N?N:Y.outlineWeight,Q=null!==(K=g.outlineColor)&&void 0!==K?K:Y.outlineColor;z.borders.top=new M.om,u.row.isFirst&&z.borders.top.applyParams((0,D.yo)(H),X,Q,M.Pb.Outline),z.borders.bottom=new M.om,u.row.isLast?z.borders.bottom.applyParams((0,D.mv)(H),X,Q,M.Pb.Outline):z.borders.bottom.applyParams(Y.gridHorizontal,Y.gridHorizontalWeight,Y.gridHorizontalColor,M.Pb.Gridline),z.borders.left=new M.om,u.column.isFirst&&(z.borders.left.applyParams((0,D.fs)(H),X,Q,M.Pb.Outline),!(0,D.fs)(H)&&((0,D.fs)(b)||(0,D.fs)(k))&&(z.paddings.left+=X)),z.borders.right=new M.om,u.column.isLast?(z.borders.right.applyParams((0,D.BK)(H),X,Q,M.Pb.Outline),!(0,D.BK)(H)&&((0,D.BK)(b)||(0,D.BK)(k))&&(z.paddings.right+=X)):z.borders.right.applyParams(Y.gridVertical,Y.gridVerticalWeight,Y.gridVerticalColor,M.Pb.Gridline),z.fontColor=x.fontColor?x.fontColor:W&&W.styleValues&&W.fontColor?W.fontColor:u.row.index%2==0?g.fontColorPrimary:g.fontColorSecondary,z.backColor=x.backColor?x.backColor:W&&W.styleValues&&W.backColor?W.backColor:u.row.index%2==0?g.backColorPrimary:g.backColorSecondary,z.paddings.top=z.paddings.bottom=Y.rowPadding}function V(u,x,z,U,W,S){var N,K;z.fontFamily=j.Zk,z.borders.top=new M.om(L.FX.PropGridOutlineWeight.defaultValue,S.PropGridOutlineColor.getValue(null));var se,ue,Y=U.total,g=U.grid,b=Y.outline,H=U.values.outline,k=U.columnHeaders.outline,X=null!==(N=Y.outlineWeight)&&void 0!==N?N:g.outlineWeight,Q=null!==(K=Y.outlineColor)&&void 0!==K?K:g.outlineColor;z.borders.top=new M.om,z.borders.top.applyParams((0,D.yo)(b),X,Q,M.Pb.Outline),z.borders.bottom=new M.om,z.borders.bottom.applyParams((0,D.mv)(b),X,Q,M.Pb.Outline),z.borders.left=new M.om,u.column.isFirst&&(z.borders.left.applyParams((0,D.fs)(b),X,Q,M.Pb.Outline),!(0,D.fs)(b)&&((0,D.fs)(H)||(0,D.fs)(k))&&(z.paddings.left+=X)),z.borders.right=new M.om,u.column.isLast?(z.borders.right.applyParams((0,D.BK)(b),X,Q,M.Pb.Outline),!(0,D.BK)(b)&&((0,D.BK)(H)||(0,D.BK)(k))&&(z.paddings.right+=X)):z.borders.right.applyParams(g.gridVertical,g.gridVerticalWeight,g.gridVerticalColor,M.Pb.Gridline),W&&W.styleTotal&&(se=W.fontColor,ue=W.backColor),z.fontColor=x.fontColor||se||Y.fontColor,z.backColor=x.backColor||ue||Y.backColor,z.paddings.top=z.paddings.bottom=g.rowPadding}var v=function(){function u(x,z){this.options=x,z&&this.updateDataView(z)}return u.prototype.updateDataView=function(x){this.tableDataView=x,this.formattingProperties=x.formattingProperties,this.updateTextHeights(),this.rowHeight=this.hasImage()?Math.max(this.textHeightValue,this.formattingProperties.grid.imageHeight):this.textHeightValue},u.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:j.F2,fontSize:ie.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:j.dG,fontSize:ie.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:j.Zk,fontSize:ie.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(Z.b.measureSvgTextHeight(this.textPropsTotal,"a"))},u.prototype.hasImage=function(){return _.some(this.tableDataView.columns,function(x){return(0,O.pt)(x)})},u.prototype.getColumnFormatting=function(x){return this.formattingProperties.columnFormatting[x.queryName]},u.prototype.onStartRenderingSession=function(){},u.prototype.onEndRenderingSession=function(){},u.prototype.bindRowHeader=function(x,z){z.contentHeight=x.totalCells?this.textHeightTotal:this.rowHeight,(0,M.G9)(z),this.options.onBindRowHeader&&this.options.onBindRowHeader(x)},u.prototype.unbindRowHeader=function(x,z){},u.prototype.bindColumnHeader=function(x,z){var U=this;z.extension.disableDragResize(),(0,M.ey)(z),(0,M.R5)(z,j.f),(0,M.R5)(z,j.mQ);var W=new M.qZ;le(z.position,W,this.formattingProperties,this.getColumnFormatting(x),this.options.tablixProperties);var S=z.extension.contentHost;(S=(0,M.Ch)(S)).classList.add(j.WA);var K,N=this.getWordWrappingWidth(x.queryName,z,W);null!=N&&(K=this.getWordWrappingLines(x.displayName,N));var Y=K&&K.length>1;if(Y){z.contentHeight=K.length*this.textHeightHeader;for(var g=0,s=K.length;g<s-1;g++)(0,M.Ch)(S,K[g]);S=(0,M.Ch)(S)}else z.contentHeight=this.textHeightHeader;this.sortIconsEnabled()&&(S=(0,M.D6)(x.sort,S),x.sort&&!Y&&(z.contentWidth=this.fontSizeHeader+j.fG));var n=x.displayName;if(Y){var b=_.last(K);(0,M.AB)(b,S),(0,M.v4)(n,z.extension.contentHost),z.contentWidth=N}else(0,M.DM)(n,S,z.extension.contentHost),z.contentWidth+=Z.b.measureSvgTextWidth(this.textPropsHeader,n);z.contentWidth=Math.ceil(z.contentWidth),this.options.onColumnHeaderClick&&z.extension.registerClickHandler(function(X){if((0,M.xl)(X)){var Q=(0,M.x7)(x.sort);U.options.onColumnHeaderClick(x.queryName?x.queryName:x.displayName,Q)}}),z.applyStyle(W)},u.prototype.getWordWrappingLines=function(x,z){return(0,ee.ql)(x,this.textPropsHeader,Z.b.measureSvgTextWidth,z,j.uZ,void 0,!0)},u.prototype.getWordWrappingWidth=function(x,z,U){var W;if(this.formattingProperties.columnHeaders.wordWrap&&0===this.options.layoutKind&&(z.isColumnResizing()&&z.containerWidth>=0?W=z.containerWidth:this.options.columnWidthManager&&(W=this.options.columnWidthManager.getPersistedColumnWidth(x)),null!=W))return Math.max(0,W-(U.getExtraLeft()+U.getExtraRight()))},u.prototype.unbindColumnHeader=function(x,z){(0,M.G9)(z),(0,M.aP)(z),this.sortIconsEnabled()&&(0,M.Y4)(z),this.options.onColumnHeaderClick&&z.extension.unregisterClickHandler()},u.prototype.bindBodyCell=function(x,z){(0,M.ey)(z),this.setBodyContent(x,z),z.contentWidth=Math.ceil(z.contentWidth),x.isTotal?((0,M.R5)(z,j.R9),(0,M.R5)(z,j.s$)):(0,M.R5)(z,x.position.row.isLast?j.zq:j.JM),x.isNumeric&&(0,M.R5)(z,j.s0);var U=new M.qZ;x.isTotal?V(z.position,x,U,this.formattingProperties,this.getColumnFormatting(x.columnMetadata),this.options.tablixProperties):r(z.position,x,U,this.formattingProperties,this.getColumnFormatting(x.columnMetadata),this.options.tablixProperties),z.applyStyle(U)},u.prototype.setBodyContent=function(x,z){var U=z.extension.contentHost,W=this.formattingProperties.grid.imageHeight,S=x.textContent;z.contentHeight=x.isTotal?this.textHeightTotal:x.isImage?W:this.textHeightValue;var N=(0,M.MN)(x.columnMetadata,x.textContent);if(N!==re.av.NONE){var K=this.formattingProperties.values.urlIcon,Y=void 0;return K&&(Y=(0,M.RP)(N)),K&&null!=Y?(0,M.vU)(S,U,Y):(0,M.vU)(S,U),void(z.contentWidth=K?this.fontSizeValue:Z.b.measureSvgTextWidth(this.textPropsValue,S))}if(x.isImage&&(0,re.gU)(S))return(0,M.Hx)(S,U,W),void(z.contentWidth=W*j.wd);var g=x.kpiContent;return g?($(U).append(g),void(z.contentWidth=this.fontSizeValue)):S?((0,M.DM)(S,U),void(z.contentWidth=Z.b.measureSvgTextWidth(x.isTotal?this.textPropsTotal:this.textPropsValue,S))):((0,M.DM)(" ",U),void(z.contentWidth=0))},u.prototype.unbindBodyCell=function(x,z){(0,M.G9)(z),(0,M.aP)(z)},u.prototype.bindCornerCell=function(x,z){z.contentWidth=0},u.prototype.unbindCornerCell=function(x,z){},u.prototype.bindEmptySpaceHeaderCell=function(x){},u.prototype.unbindEmptySpaceHeaderCell=function(x){},u.prototype.bindEmptySpaceFooterCell=function(x){},u.prototype.unbindEmptySpaceFooterCell=function(x){},u.prototype.getHeaderLabel=function(x){return x?x.displayName:""},u.prototype.getCellContent=function(x){return x},u.prototype.hasRowGroups=function(){return!1},u.prototype.sortIconsEnabled=function(){return 0===this.options.layoutKind},u}()}}]);