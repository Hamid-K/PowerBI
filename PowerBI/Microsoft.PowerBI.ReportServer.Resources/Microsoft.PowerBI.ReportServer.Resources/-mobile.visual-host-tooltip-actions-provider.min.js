"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["visual-host-tooltip-actions-provider"],{22005:function(R,j,i){i.r(j),i.d(j,{VisualHostTooltipActionsProviderModule:function(){return Y}});var g=i(81337),V=i(48145),C=i(91120),D=i(77200),P=i(10861),M=i(54952),b=i(26898),E=i(13363),z=i(83008),H=i(11494),O=i(39503),U=i(66977),F=i(8082),I=i(28894),x=i(24921),N=i(62458),J=i(46544),n=i(50423),B=function(){function o(t,e,s,u,l,a,v,d,c,r,p,m,f,h){this.conceptualSchemaProxy=t,this.contextActivityService=e,this.drill=s,this.dataSources=u,this.eventBridge=l,this.explorationCapabilities=a,this.explorationExtensibility=v,this.explorationNavigation=d,this.lazyScoped=c,this.pluginOps=r,this.telemetryService=p,this.viewModeState=m,this.visualAuthoring=f,this.runningVisualService=h}return o.prototype.createTooltipCommands=function(t,e,s){return(0,g.mG)(this,void 0,void 0,function(){var u,l,v,d,c,r,p,m,f,h,S;return(0,g.Jh)(this,function(y){switch(y.label){case 0:return u=this.runningVisualService.getVisual(e),l=[],this.viewModeState.getConfig().displayOptions.enableMobileInsights?(v=this.explorationExtensibility.getCommandsDisplayOptions(e.name),[4,this.getInsights(t,e,s,v,"ExplainAnomalies")]):[3,2];case 1:d=y.sent(),this.fillAnomaly(d,l),y.label=2;case 2:return c=t.identities&&t.identities.filter(function(Q){var T;return!(null!==(T=Q.exclude)&&void 0!==T&&T[1])}),r=new x.Ue(e,c,t.roles,this.drill,this.visualAuthoring,u,this.contextActivityService,{source:"Tooltip"},"DrillUp"),[4,(p=new x.ab(e,c,t.roles,this.dataSources,this.drill,this.visualAuthoring,u,this.contextActivityService,{source:"Tooltip"},"DrillDown")).isVisible()];case 3:return m=y.sent(),[4,r.isVisible()];case 4:return f=y.sent(),(m||f)&&(l.push({command:r,enabled:f}),l.push({command:p,enabled:m})),h=s?new x.dl(e,c,"TooltipActions",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,s,this.telemetryService,this.contextActivityService,{source:"Tooltip"},"Drillthrough"):void 0,(S=h)?[4,this.isDrillthroughEnabled(h)]:[3,6];case 5:S=y.sent(),y.label=6;case 6:return S&&l.push({command:h,enabled:!0}),this.commands=l,[2]}})})},o.prototype.resetTooltipActions=function(){this.commands=[]},o.prototype.getInsights=function(t,e,s,u,l){return(0,g.mG)(this,void 0,void 0,function(){var a,v,d,c;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return a=[],s?(_.size(t.coordinates)>1&&(v={x:t.coordinates[0],y:t.coordinates[1]}),[4,(d=new x.Ys(e,t.identities,v,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.explorationCapabilities,this.explorationNavigation,this.lazyScoped,this.viewModeState,s,l,this.contextActivityService,{source:"Tooltip"},u)).isVisible()]):[2,a];case 1:return r.sent()?[4,d.getChildren()]:[3,3];case 2:c=r.sent(),a=c,r.label=3;case 3:return[2,a]}})})},o.prototype.fillAnomaly=function(t,e){if(!_.isEmpty(t)){N.fF.assert(function(){return 1===t.length},"Only 1 anomaly allowed");var s=_.first(t);s.glyph="pbi-glyph-anomaly",s.defaultTitleKey="ExplainAnomaly",e.push({command:s,enabled:!0})}},o.prototype.isDrillthroughEnabled=function(t){return(0,g.mG)(this,void 0,void 0,function(){return(0,g.Jh)(this,function(s){switch(s.label){case 0:return[4,t.isVisible()];case 1:return[2,s.sent()]}})})},o.prototype.updateAndGetTooltipCommands=function(){return this.commands},o.\u0275fac=function(e){return new(e||o)(n.\u0275\u0275inject(b.i),n.\u0275\u0275inject(M.r),n.\u0275\u0275inject(E.s),n.\u0275\u0275inject(z.D),n.\u0275\u0275inject(H.J),n.\u0275\u0275inject(V.U),n.\u0275\u0275inject(C.W),n.\u0275\u0275inject(O.z),n.\u0275\u0275inject(I.H),n.\u0275\u0275inject(U.f),n.\u0275\u0275inject(J.y0),n.\u0275\u0275inject(D.kc),n.\u0275\u0275inject(P.$8),n.\u0275\u0275inject(F.s))},o.\u0275prov=n.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),W={provide:"visualHostTooltipActionsProvider",useFactory:function(o,t,e,s,u,l,a,v,d,c,r,p,m,f){return new Promise(function(h){h(new B(o,t,e,s,u,l,a,v,d,c,r,p,m,f))})},deps:[b.i,M.r,E.s,z.D,H.J,V.U,C.W,O.z,I.H,U.f,J.y0,D.kc,P.$8,F.s]},$=i(77476),K=i(52910),L=i(77906),Y=function(){function o(){}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=n.\u0275\u0275defineInjector({providers:[W],imports:[$.CommonModule,K.O,L.N]}),o}()}}]);