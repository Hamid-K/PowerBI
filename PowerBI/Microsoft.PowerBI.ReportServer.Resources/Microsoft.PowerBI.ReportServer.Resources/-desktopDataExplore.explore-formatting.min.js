(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["explore-formatting"],{84631:function(dt,We,C){"use strict";C.d(We,{CZ:function(){return K},IA:function(){return Ne},MM:function(){return Ae},QZ:function(){return _e},XB:function(){return Je},_1:function(){return Re},vX:function(){return H},xK:function(){return te},yY:function(){return xe},zB:function(){return ae}});var A=C(52083),p=C(62458),b=C(94419),S=C(4829);function H(ue){return{solid:{color:te(ue,(0,A.d9)())}}}function te(ue,z){p.fF.assertValue(z,"gradientSettings");var ie,ge,ye,G={color:(0,b.$_)(z.minColor,"minColor")},fe=z.minValue;if(null!=fe&&(ie=(0,b.tx)(fe)),z.diverging){ge={color:(0,b.$_)(z.midColor,"midColor")};var be=z.midValue;null!=be&&(ye=(0,b.tx)(be))}var Ct,ht={color:(0,b.$_)(z.maxColor,"maxColor")},Vt=z.maxValue;null!=Vt&&(Ct=(0,b.tx)(Vt));var it,wt=z.nullStrategy,X=z.nullColor,nt={};return it=z.diverging?nt.linearGradient3={min:G,mid:ge,max:ht}:nt.linearGradient2={min:G,max:ht},ie&&(it.min.value=ie),ye&&(it.mid.value=ye),Ct&&(it.max.value=Ct),wt&&(it.nullColoringStrategy={strategy:(0,b.fL)(wt)},wt===S.Sx&&(it.nullColoringStrategy.color=(0,b.$_)(X,"nullColor"))),(0,b.x5)(ue,nt)}function xe(ue,z,G){var ie;switch(G){case"number":ie={condition:(0,b.qu)(3,ue,(0,b.tx)(0)),value:(0,b.fL)(z)};break;case"text":ie={condition:(0,b.qu)(0,ue,(0,b.fL)("")),value:(0,b.fL)(z)};break;default:p.fF.assertNever(G)}return{solid:{color:(0,b.u7)([ie])}}}var ae="CircleHigh",Ne="Before",_e="Top";function Je(ue,z){switch(void 0===z&&(z="number"),z){case"number":return{kind:"Icon",value:(0,b.u7)([K(ue,67,100,!0,(0,b.fL)("CircleHigh")),K(ue,33,67,!1,(0,b.fL)("SignMedium")),K(ue,0,33,!1,(0,b.fL)("SignLow"))]),layout:(0,b.fL)(Ne),verticalAlignment:(0,b.fL)(_e)};case"text":return{kind:"Icon",value:(0,b.u7)([Re(ue,(0,b.fL)("CircleHigh")),Re(ue,(0,b.fL)("SignMedium")),Re(ue,(0,b.fL)("SignLow"))]),layout:(0,b.fL)(Ne),verticalAlignment:(0,b.fL)(_e)};default:p.fF.assertNever(z)}}function K(ue,z,G,ie,fe){var ge,ye;return z>0&&(ge=(0,b.qu)(2,ue,b.LE.overRangeOf(ue,z/100))),G<100&&(ye=(0,b.qu)(ie?4:3,ue,b.LE.overRangeOf(ue,G/100))),{condition:ge&&ye?(0,b.xD)(ge,ye):ge||ye,value:fe}}function Re(ue,z){return{condition:(0,b.qu)(0,ue,(0,b.fL)("")),value:z}}function Ae(ue,z,G,ie,fe){var ge,ye;return null!==z&&(ge=(0,b.qu)(2,ue,(0,b.tx)(z))),null!==G&&(ye=(0,b.qu)(ie?4:3,ue,(0,b.tx)(G))),{condition:ge&&ye?(0,b.xD)(ge,ye):ge||ye,value:fe}}},26902:function(dt,We,C){"use strict";C.d(We,{L6:function(){return Ne},aI:function(){return ae},ac:function(){return K},dw:function(){return Ae},uz:function(){return Je}});var A=C(40812),p=C(64067),b=C(62458),S=C(94419),H=C(59897),te=C(80777),xe={totalMatchingOption:1,reverseDirection:!1,hideText:!1};function ae(z,G){return b.fF.assertValue(z,"visual"),b.fF.assertValue(G,"repetition"),Ne(Re(z.objects,G))}function Ne(z){if(!z)return xe;var G,ie=z.minValue;ie&&(G=ie.value);var fe,ge=z.maxValue;ge&&(fe=ge.value);var ye=1,be=z.totalMatchingOption;return be&&(ye=be.value),{minValue:G,maxValue:fe,positiveColor:_e(z.positiveColor),negativeColor:_e(z.negativeColor),axisColor:_e(z.axisColor),reverseDirection:z.reverseDirection.value,hideText:z.hideText.value,totalMatchingOption:ye}}function _e(z){var G=z.solid.color;return(0,p.A7)(G.value)?{solid:{color:G.value}}:null}function Je(){return K(xe,te.Ge.fromPrimitiveTypeAndCategory(12))}function K(z,G){var ie,fe,ge;return b.fF.assertValue(z,"dataBars"),b.fF.assertValue(G,"valueType"),void 0!==z.minValue&&(ie=ue(z.minValue,G)),void 0!==z.maxValue&&(fe=ue(z.maxValue,G)),void 0!==z.totalMatchingOption&&(ge=(0,S.cA)(z.totalMatchingOption)),{minValue:ie,maxValue:fe,positiveColor:(0,H.EV)(z.positiveColor&&z.positiveColor.solid.color,"maxColor"),negativeColor:(0,H.EV)(z.negativeColor&&z.negativeColor.solid.color,"minColor"),axisColor:(0,H.EV)(z.axisColor&&z.axisColor.solid.color,"foreground"),reverseDirection:(0,S.O7)(z.reverseDirection),hideText:(0,S.O7)(z.hideText),totalMatchingOption:ge}}function Re(z,G){return b.fF.assertValue(G,"objectRepetition"),(0,A.OT)(z,G)}function Ae(z,G){return b.fF.assertValue(G,"objectRepetition"),void 0!==Re(z,G)}function ue(z,G){if(b.fF.assert(function(){return G.integer||G.numeric},"databars only supports numeric SQExprs"),G.integer){var ie=Math.round(z);return(0,S.cA)(ie)}return 2===G.primitiveType?(0,S.gH)(z):(b.fF.assert(function(){return 259===G.extendedType},"Unexpected data type."),(0,S.tx)(z))}},66609:function(dt,We,C){"use strict";C.d(We,{Iq:function(){return _e},MO:function(){return Ae},Y9:function(){return K},b:function(){return Ne},p$:function(){return Je}});var ae,A=C(81337),p=C(57871),b=C(9480),S=C(78417),H=C(72489),te=C(20590),xe=C(64466),Ne=((ae={})[b.t.Dynamic]={displayOption:0,width:p.Z9,height:p.LU},ae[b.t.Standard]={displayOption:1,width:p.Z9,height:p.LU},ae[b.t.Widescreen]={displayOption:1,width:p.$z,height:p.az},ae[b.t.Cortana]={displayOption:3,width:p.yL,height:p.QZ},ae[b.t.Letter]={displayOption:1,width:p.lr,height:p.to},ae[b.t.Tooltip]={displayOption:1,width:p.R6,height:p.h8},ae[b.t.Custom]={displayOption:3,width:p.Z9,height:p.LU},ae);function _e(z,G){for(var ie=[],fe=0,ge=z;fe<ge.length;fe++){var ye=ge[fe];ie.push((0,A.__assign)((0,A.__assign)({},ye),{value:"".concat(ye.value),displayName:(0,te.Gf)(ye.displayName,G),label:ye.label?(0,te.Gf)(ye.label,G):null}))}return ie}function Je(z){void 0===z&&(z=!1);for(var ie=[],fe=0,ge=(0,H.p$)(z);fe<ge.length;fe++){var ye=ge[fe];ie.push({displayName:ye.title,value:ye.value.toString()})}return ie}function K(z,G){return function(z,G,ie){if(0===z.displayOption)return b.t.Dynamic;if(z.width===p.Z9&&z.height===p.LU)return b.t.Standard;if(z.width===p.$z&&z.height===p.az)return b.t.Widescreen;if(xe.s.isCortanaPageSize(z)){var fe=(0,S.Ae)(G,ie.name);return-1!==fe&&G.pods[fe].cortanaEnabled?b.t.Cortana:b.t.Custom}return z.width===p.lr&&z.height===p.to?b.t.Letter:function(z){return z.width===p.R6&&z.height===p.h8}(z)?b.t.Tooltip:b.t.Custom}(z,G.getCurrentExploration(),G.getCurrentSection())}function Ae(z){return Ne[z]}},78432:function(dt,We,C){"use strict";C.d(We,{An:function(){return K},Aw:function(){return fe},D1:function(){return ie},H8:function(){return Ct},Ky:function(){return ve},LF:function(){return Ae},N6:function(){return it},UV:function(){return ue},Wx:function(){return ge},ce:function(){return ft},hy:function(){return ye},m7:function(){return wt},nB:function(){return Je},nH:function(){return Vt},so:function(){return Ze},um:function(){return G},w7:function(){return z},wW:function(){return ht},zS:function(){return X},zh:function(){return Re}});var A=C(81337),p=C(9215),b=C(61617),S=C(50550),H=C(62458),te=C(32379),xe=C(10746),ae=C(5265),Ne=C(80981),_e="___",Je="container-object-name";function K(I,M){switch(I){case"VisualizationPane_Section_Analytics":return"VisualizationPane_Section_Analytics";case"Button":return"Button";case"Format_Label_General":return M.featureSwitches.onObject?"Properties":"Format_Label_General";case"Group":return"Group";case"Image":return"Image";case"Page":return"Page";case"BasicShape_ToolTip":return"BasicShape_ToolTip";case"Visual":return"Visual";default:H.fF.assertNever(I)}}function Re(I){var M="".concat(_e).concat(I.objectName).concat(_e).concat(I.propertyName);return(0,b.$Q)(M,I.selector)}function Ae(I,M){return"".concat(M,"-").concat(I)}function ue(I,M){return I.substring(M.length+1)}function z(I,M){var Q=M[I.objectName],Y=Q?.properties[I.propertyName];return Y}function G(I,M){var Q=null;if(I){if((0,p.q4)(I))return K("Group",M);Q=I.config.singleVisual.visualType}switch(Q){case"actionButton":return K("Button",M);case"image":return K("Image",M);case"shape":return K("BasicShape_ToolTip",M);default:return K("Visual",M)}}function ie(I){var M=I?.config.singleVisual;return!M||(0,Ne.xj)(M)}function fe(I,M,Q){void 0===Q&&(Q=!1);for(var Y=0,he=M;Y<he.length;Y++){var ee=he[Y],Te=I[ee.objectName],Se=!0,Ee=ee.selector;if(Te){for(var at=0,Ke=Te;at<Ke.length;at++){var je=Ke[at];(Ee&&((0,te.fS)(je.selector,Ee)||_.has(ee,"altConstantValueSelector")&&(0,te.fS)(je.selector,ee.altConstantValueSelector))||Q&&je.selector||!Ee&&!Q)&&delete je.properties[ee.propertyName],Se=Se&&_.isEmpty(je.properties)}Se&&delete I[ee.objectName]}}}function ge(I){var M={},Q={};I.forEach(function(ee){ee.canvasItems.forEach(function(Te){var Se=Te.name;Q[Se]=Te,M[Se]||(M[Se]=[]),M[Se].push(ee)})});var Y=[];for(var he in M)Y.push({canvasItem:Q[he],descriptors:M[he].map(function(ee){return(0,A.__assign)((0,A.__assign)({},ee),{canvasItems:void 0})})});return Y}function ye(I,M,Q,Y){return I===M&&(0,te.fS)(Q,Y)}function ht(I,M,Q,Y){if(!I||!M)return!1;for(var he=function(Ke){var je=M[Ke.objectName];if(je)for(var Ve=0,mt=je;Ve<mt.length;Ve++){var Ft=mt[Ve];if(Y){if(!Ft.properties[Ke.propertyName])continue;if(!Ke.selector||(0,te.fS)(Ft.selector,Ke.selector)||(0,te.fS)(Ft.selector,Ke.altConstantValueSelector))return{value:!0}}else if(Ft.properties[Ke.propertyName])return{value:!0}}if(Q&&_.find(Q.changes,function(Ye){return Ye.objectName===Ke.objectName&&Ye.propertySlice.name===Ke.propertyName}))return{value:!0}},ee=0,Te=I;ee<Te.length;ee++){var Ee=he(Te[ee]);if("object"==typeof Ee)return Ee.value}return!1}function Ct(I){return{objectName:I.objectName,propertyName:I.propertySlice.name,propertyValue:I.propertySlice.value,propertyType:I.propertySlice.type,altConstantValueSelector:I.propertySlice.altConstantValueSelector,selector:I.propertySlice.selector}}function Vt(I,M){var Y={objectName:M.objectName,propertySlice:{name:M.propertyName,value:M.propertyValue,type:M.propertyType,altConstantValueSelector:M.altConstantValueSelector,selector:M.selector},hasDynamicExpressionSupport:!1};return Y.hasDynamicExpressionSupport=function(I,M){var Q=I.config.singleVisual.query,he=(0,ae.NA)(I.config.singleVisual.objects,{objectName:M.objectName,propertyName:M.propertySlice.name},M.propertySlice.selector);return!(!he||!(0,xe.oA)(he,M.propertySlice.selector,Q?Q.defn.select():(0,S.bv)()).length)}(I,Y),Y}function wt(I,M,Q,Y){var he=Y.visualPlugin&&Y.visualPlugin.capabilities(Q);if(he&&he.supportsSynchronizingFilterState){var ee=he.objects[I];if(ee){var Te=ee.properties[M];if(Te&&Te.filterState)return!0}}return!1}function X(I,M){I&&I.syncFilterState(M)}function it(I){return void 0!==I.reference}function ve(I){return I.isTopLevelToggle}function Ze(I){var M=I.visualObjects,Q=_.some(M,function(Y){return"visual-area"===Y.objectName});return Q&&M.length>1&&H.fF.assertFail("Visual area sub selectable should only have one visual object"),Q}function ft(I){var M=[],Q=I.control.type;switch(Q){case"MarginPadding":var Y=I.control.properties,he=Pt(I);M=[Dt(Y.top,he),Dt(Y.bottom,he),Dt(Y.left,he),Dt(Y.right,he)];break;case"FontControl":var ee=I.control.properties,Te=Pt(I);ee.fontSize&&M.push(Dt(ee.fontSize,Te)),ee.fontFamily&&M.push(function(I,M){return(0,A.__assign)((0,A.__assign)({},M),{control:{type:"FontPicker",properties:I},uid:Re(I.descriptor)})}(ee.fontFamily,Te)),ee.bold&&M.push(qt(ee.bold,Te)),ee.italic&&M.push(qt(ee.italic,Te)),ee.underline&&M.push(qt(ee.underline,Te));break;default:H.fF.assertNever(Q)}return M}function Pt(I){return{aliasNames:[],description:"",displayName:"",conditionalFormattingObjects:void 0,conditionalFormattingWarning:void 0,control:void 0,disabled:I.disabled,hidden:I.hidden,disabledReason:I.disabledReason,groupUid:I.groupUid,infoIconText:void 0,originSource:I.originSource,pivotSource:I.pivotSource,placeHolderText:void 0,saveCallback:void 0,showChangeIndicator:I.showChangeIndicator,suppressDisplayName:I.suppressDisplayName,uid:void 0,warningMessage:void 0}}function Dt(I,M){return(0,A.__assign)((0,A.__assign)({},M),{control:{type:"NumUpDown",properties:I},uid:Re(I.descriptor)})}function qt(I,M){return(0,A.__assign)((0,A.__assign)({},M),{control:{type:"ToggleSwitch",properties:I},uid:Re(I.descriptor)})}},24408:function(dt,We,C){"use strict";C.d(We,{BT:function(){return Vt},Cc:function(){return ve},Ke:function(){return Pt},OR:function(){return fe},OY:function(){return it},QI:function(){return Ze},TW:function(){return ie},WN:function(){return qt},X_:function(){return G},Yb:function(){return ue},Yl:function(){return z},cn:function(){return Dt},ht:function(){return ye},mI:function(){return ft},oE:function(){return X},qb:function(){return Ct},sH:function(){return wt},vw:function(){return ge},yp:function(){return nt}});var A=C(81337),p=C(67746),b=C(66609),S=C(61903),H=C(60637),te=C(93187),xe=C(33024),ae=C(62458),Ne=C(64329),_e=C(32379),Je=C(36998),K=C(28488),Re=C(58702),Ae=C(80777);function ue(W,I){return W?W+"-"+I:I}function z(W,I){return ae.fF.assertValue(I,"containerIndex"),(0,S.g4)([W,I.toString()])}function G(W){if(ae.fF.assertValue(W,"invalid slice"),W.numericValueOptions)return W.numericValueOptions;var I=ie(W);if(I===p.iR||I===p.Y4)switch(W.name){case"weight":return{unitSymbol:xe.tQ,minValue:0,maxValue:50};case"angle":case"startAngle":return{unitSymbol:xe.g,minValue:0,maxValue:360};case"textSize":case"fontSize":case"categoryLabelFontSize":case"dataLabelFontSize":case"levelSubtitleFontSize":case"levelTitleFontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":case"expandCollapseButtonsSize":case"headerFontSize":case"cardFontSize":case"questionFontSize":case"restatementFontSize":return{unitSymbol:xe.tQ,minValue:Ne.Gj,maxValue:Ne.PR};case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"barWeight":return{unitSymbol:"",minValue:1,maxValue:10};case"rowPadding":case"cardPadding":return{unitSymbol:"",minValue:0,maxValue:20};case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":case"steppedLayoutIndentation":return{unitSymbol:"",minValue:0,maxValue:40};case"imageHeight":return{unitSymbol:"",minValue:24,maxValue:150};case"borderThickness":case"markerShapeSize":return{unitSymbol:"",minValue:0,maxValue:10};case"preferredCategoryWidth":return{unitSymbol:"",minValue:20,maxValue:180};case"strokeWidth":return{unitSymbol:"",minValue:0,maxValue:12};case"gridlineThickness":return{unitSymbol:"",minValue:1,maxValue:4};case"markerSize":return{unitSymbol:"",minValue:5,maxValue:20};case"innerRadiusRatio":return{unitSymbol:"",minValue:0,maxValue:95};case"borderWidth":case"radius":return{unitSymbol:xe.e_,minValue:0,maxValue:30};case"explode":return{unitSymbol:xe.t2,minValue:0,maxValue:50};case"bubbleSize":return{unitSymbol:"",minValue:-25,maxValue:100};case"dataBarWidthPercent":return{unitSymbol:xe.t2,minValue:50,maxValue:150};case"shadowSpread":case"shadowBlur":case"shadowDistance":return{unitSymbol:xe.e_,minValue:0,maxValue:100};default:return{unitSymbol:xe.t2,minValue:0,maxValue:100}}}function ie(W){if(null==W.type&&null==W.save&&_.isFunction(W.value))return"linkButton";if(null==W.type)return null;var I=function(W){ae.fF.assertValue(W,"sliceType");var I=Ae.Ge.fromDescriptor(W);if(0!==I.extendedType){var M=I.formatting||I.misc;if(M)return function(W){for(var I in W)if(!0===W[I])return I;return null}(M)}return Object.keys(W)[0]}(W.type);switch(I){case"alignment":return"alignment";case"numericUnitSelection":return"numericUnitSelection";case"fontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":return p.Y4;case"fontFamily":return"fontPicker";case"altText":return p.Kx;case"webUrl":return"text"}if(W.selectionOptions)return W.selectionOptions.some(function(M){return M.icon})?"propertyPaneSelection":"flagsEnumeration"===I?p.k8:p.Y1;switch(W.name){case"lineTransparency":case"transparency":case"angle":case"shapeAngle":case"textAngle":case"imageHeight":case"steppedLayoutIndentation":case"percentile":case"preferredCategoryWidth":case"maxMarginFactor":case"innerPadding":case"labelDensity":case"bubbleSize":case"backgroundTransparency":case"innerRadiusRatio":case"startAngle":case"borderWidth":case"explode":case"radius":case"dataBarWidthPercent":case"barsPerLevel":case"shadowBlur":case"shadowSpread":case"shadowDistance":case"markerShapeSize":case H.DQ.bubbleRadius:case H.DQ.minBubbleRadius:case H.DQ.maxRadius:case H.DQ.mapTransparency:case H.DQ.strokeTransparency:case H.DQ.blur:case H.DQ.unselectedTransparency:case H.DQ.bubbleStrokeWidth:case H.DQ.height:case H.DQ.thickness:case"gridLineWidth":case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":case"shadeTransparency":case te.Mn.arrowheadSize:case te.Mn.speechBubbleHeight:case te.Mn.speechBubbleTailAngle:case te.Mn.chevronAngle:case te.Mn.hexagonSlant:case te.Mn.octagonSnipSize:case te.Mn.parallelogramSlant:case te.Mn.rectangleRoundedCurve:case te.Mn.shapeRounding:case te.Mn.arrowStemWidth:case te.Mn.tabCutCornerSnipSizeTopRight:case te.Mn.tabCutCornerSnipSizeTop:case te.Mn.tabCutCornerSnipSizeBottom:case te.Mn.tabRoundCornerTopRight:case te.Mn.tabRoundCornerTop:case te.Mn.tabRoundCornerBottom:case te.Mn.trapezoidSlant:case te.Mn.isocelesTriangleTipPosition:return p.iR;case"gradientBar":return"gradientBar";case"expander":return"container";case"weight":case"textSize":case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"rowPadding":case"barWeight":case"cardPadding":case"borderThickness":case"strokeWidth":case"gridlineThickness":case"markerSize":return p.Y4}return W.numericValueOptions?p.Y4:I}function fe(W){var I=ie(W);return I===p.iR||"fill"===I}function ge(W,I){if(null!=I&&_.isNumber(I))for(var M=I.toString(),Q=0,Y=W;Q<Y.length;Q++){var he=Y[Q];if(he.value===I)break;if(he.value===M)return M}return I}function ye(W,I){if(W.selectedContainers)if(_.isEmpty(I.containers))W.selectedContainers[I.name]=void 0;else{var Q,M=W.selectedContainers[I.name];Q=M?_.find(I.containers,function(Y){return Y.value===M}):_.head(I.containers),I.selectedContainer=Q}}function Ct(W,I,M){if(W instanceof Je.L){var Q=W;return M?{title:Q.getTitle(I),message:null,detail:null}:{title:Q.getMessage(I),message:null,detail:null}}return W.getMessages(I)}function Vt(W,I,M){for(var Q=0,Y=W;Q<Y.length;Q++){var he=Y[Q];if(he&&he.warnings)for(var ee=0,Te=he.warnings;ee<Te.length;ee++){var Se=Te[ee];if(Se instanceof Je.L&&Se.propertyId.propertyName===M&&(!Se.selector&&!Se.selector||(0,_e.fS)(Se.selector,I)))return Se}}}function wt(W,I){var M=Ae.Ge.fromDescriptor(W);if(!M.variant)return W;ae.fF.assertValue(I,"propertyTypes");for(var Q=Ae.Ge.fromDescriptor(I),Y=0,he=M.variant;Y<he.length;Y++)if(Q.isCompatibleFrom(he[Y]))return I}function X(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function nt(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function it(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function ve(W,I){var M=W.validValues;return M&&M[I]}function Ze(W){return!_.isArray(W)}function ft(W,I,M){var Q;return(0,A.__awaiter)(this,void 0,void 0,function(){var Y,he,ee;return(0,A.__generator)(this,function(Se){switch(Se.label){case 0:Y={displayName:M.get("PersonalizeVisual_DefaultPerspective"),value:""},he=W.get().map(function(Ee){var Ke=Ee.dsr;return{type:Ee.type,objectId:Ke?.dbName}}),Se.label=1;case 1:return Se.trys.push([1,3,,4]),[4,I.get(he).toPromise()];case 2:return ee=(null===(Q=Se.sent())||void 0===Q?void 0:Q.perspectiveIds)||[],[3,4];case 3:return Se.sent(),ee=[],[3,4];case 4:return[2,(0,A.__spreadArray)([Y],ee.map(function(Ee){return{displayName:Ee,value:Ee}}),!0)]}})})}function Pt(W){return!!W&&(0!==Ae.Ge.fromDescriptor(W.type).extendedType||(0,Re.JY)(W.type))}function Dt(W){return(0,A.__awaiter)(this,void 0,void 0,function(){var I,M,Q,Y,he,ee,Te,Se,Ee,at,Ke,je,Ve,mt,Ft,Ye,jt,Ht;return(0,A.__generator)(this,function(vr){switch(vr.label){case 0:return M=W.instance,Q=W.propertyName,he=W.visualType,(Y=W.paneServices)||(Y={}),ee=Y.bookmarkService,Te=Y.dataSourcesService,Se=Y.explorationNavigation,Ee=Y.localizationService,at=Y.perspectivesService,Ke=Y.visualStylePresetService,ae.fF.assertValue(I=W.propertyType,"propertyType"),ae.fF.assertValue(M,"instance"),(je=I.enum||I.flagsEnum)?[3,7]:((Ve=I.formatting)&&(Ve.labelDisplayUnits?je=(0,K.i)((0,b.p$)()):Ve.displayUnitsWithoutAuto?je=(0,K.i)((0,b.p$)(!0)):Ve.stylePreset&&(je=Ke.getEnumFromName(he,M.properties.name))),(mt=I.reference)?mt.bookmark?(ae.fF.assertValue(ee,"bookmarks not implemented here"),ae.fF.assertValue(Ee,"localizationService is missing"),ee&&(je=(0,K.i)(X(ee.getAllBookmarks()))),[3,7]):[3,1]:[3,7]);case 1:return mt.bookmarkGroup?(ae.fF.assertValue(ee,"bookmarks not implemented here"),ae.fF.assertValue(Ee,"localizationService is missing"),ee&&(je=(0,K.i)(nt(ee.getBookmarkGroups()))),[3,7]):[3,2];case 2:return mt.section?(ae.fF.assertValue(Se,"explorationNavigation not implemented here"),ae.fF.assertValue(Ee,"localizationService is missing"),Se&&(je=(0,K.i)(it(Se.getAllSections()))),[3,7]):[3,3];case 3:return mt.perspective?(ae.fF.assertValue(Te,"dataSourcesService is missing"),ae.fF.assertValue(at,"perspectivesService is missing"),ae.fF.assertValue(Ee,"localizationService is missing"),Te&&at&&Ee?(Ft=K.i,[4,ft(Te,at,Ee)]):[3,5]):[3,6];case 4:je=Ft.apply(void 0,[vr.sent()]),vr.label=5;case 5:return[3,7];case 6:ae.fF.assertFail("Unknown refType"),vr.label=7;case 7:return je?((Ye=ve(M,Q))&&(jt=void 0,Ze(Ye)?(jt=Ye.filterValues,Ye.mergeValues&&(Ht=(0,A.__spreadArray)((0,A.__spreadArray)([],Ye.mergeValues||[],!0),je.members()||[],!0),je=(0,K.i)(Ht))):jt=Ye,jt&&(je=(0,K.i)(je.members(jt)))),[2,(0,b.Iq)(je.members(),Ee)]):[2]}})})}function qt(W){return!!W.items}},2863:function(dt,We,C){"use strict";C.d(We,{v:function(){return b}});var A=C(3579);function b(S,H,te){var xe=(0,A.s)(S);return H.isCustomVisual(xe)||te.isTrustedVisual(xe)}},7989:function(dt,We,C){"use strict";C.r(We),C.d(We,{ExploreFormattingModule:function(){return ol}});var Ae,ue,A=C(77476),p=C(81337),b=C(62458),S=C(56578),H=C(48708),te=C(47998),xe=C(61193),ae=C(66123),Ne=C(33024),_e=C(2241),Je=C(51490),K=C(80822),Re=C(90120),z=((Ae={}).anomalyDetection={objectName:"anomalyDetection",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_AnomalyDetection"},Ae.forecast={objectName:"forecast",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Forecast"},Ae.plotAreaShading={objectName:"plotAreaShading",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_SymmetryShading"},Ae.ratioLine={objectName:"ratioLine",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_RatioLine"},Ae.referenceLine={objectName:"referenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line"},Ae.trend={objectName:"trend",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Trend_Line"},Ae.xAxisReferenceLine={objectName:"xAxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_X"},Ae.y1AxisReferenceLine={objectName:"y1AxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_Y"},Ae),G="show",ie="referenceLine",fe="measure",ge="type",ye="percentile",be="unknown",ht=((ue={}).Min=ie+"-minLine",ue.Max=ie+"-maxLine",ue.Average=ie+"-averageLine",ue.Median=ie+"-medianLine",ue.Percentile=ie+"-percentileLine",ue),Vt={units:"Unit",forecastLength:"ForecastLength",ignoreLast:"IgnoreLast",confidenceInterval:"ConfidenceLevel",seasonality:"MaxSeasonality"},wt={sensitivity:K.DM,explainBy:K.Bx},X=C(60661),nt=C(28579),it=C(47006),ve=C(5265),Ze=C(74082),ft=C(45413),Pt=C(45334),Dt=C(58295);function qt(a,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return a?(r={objectName:e},a.enumerateObjectInstancesAsync?[4,a.enumerateObjectInstancesAsync(r)]:[3,2]):[2];case 1:return t=i.sent(),[3,3];case 2:a.enumerateObjectInstances&&(t=a.enumerateObjectInstances(r)),i.label=3;case 3:return[2,nt.G.normalize(t)]}})})}function W(a){var e;return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return a.getFormattingModelAsync?[4,a.getFormattingModelAsync()]:[3,2];case 1:return r=n.sent(),[3,3];case 2:r=null===(e=a.getFormattingModel)||void 0===e?void 0:e.call(a),n.label=3;case 3:return(t=r)?(i=_.filter(t.cards,function(o){return o.analyticsPane}),b.fF.assert(function(){return _.every(i,function(o){return!(0,S.Qu)(o)})},"Analytics pane does not support Placeholder cards."),[2,i]):[2]}})})}function I(a,e,t,r){var i,n=null===(i=a?.config)||void 0===i?void 0:i.singleVisual;if(!n?.query)return[];var o=r.capabilities(n.visualType);if(!o||!o.objects)return[];var s=[];o.objects[it.Dk]&&s.push(1),o.objects[it.XC]&&s.push(0);for(var l=[],u=(0,X.d$)(a,r)||[],c=n.query.defn.select(),d=function(g){if(_.some(s,function(N){return N===g.cartesianKind}))for(var D=function(V){if(!(0,Dt.k)(V))return"continue";var P=_.find(c,function(E){return(0,ft.fS)(V,E.expr)}),O=t.getDisplayName(V,e,o,P.name,n.columnProperties);l.push({displayName:O,value:P.name,selectExpr:P})},T=0,q=n.query.tryGetExprs(g.name)||[];T<q.length;T++)D(q[T])},v=0,h=u;v<h.length;v++)d(h[v]);return l}function Q(a,e,t,r,i,n,o,s){var l;return(0,p.__awaiter)(this,void 0,void 0,function(){var u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return null!==(l=i.objects)&&void 0!==l&&l[a]?(b.fF.assert(function(){var g;return 1===(null===(g=_.find(z,function(y){return y.objectName===a}))||void 0===g?void 0:g.maxInstances)},"Expect this be called only for cards that support maximum 1 instance"),[4,qt(r,a)]):[2];case 1:return u=m.sent(),_.isEmpty(u?.instances)?[2]:(c=s??G,b.fF.assert(function(){return 1===u.instances.length},a+" supports maximum 1 instance but there are "+u.instances.length),v=(d=u.instances[0]).properties[c],(h=new S.CQ(new S.lg(e),t,o,n)).addTopLevelToggle("show",function(){return new S.bd({descriptor:{objectName:a,propertyName:c,selector:d.selector},value:v}).build()}),f=!1,_.isEmpty(d.disabledReason)||(h.withDisabledLocalized(!0,d.disabledReason),f=!0),[2,{cardBuilder:h,objectInstance:d,disableCard:f}])}})})}function Y(a,e,t,r,i,n){if(r.objects[e])for(var o={objectName:e,selector:t.selector,altConstantValueSelector:t.altConstantValueSelector,propertyName:void 0,propertyTypes:void 0},s=function(v){var h=v.propertyName;if(!_.has(r.objects[e].properties,h)||!_.has(t.properties,h))return"continue";var f=(0,p.__assign)((0,p.__assign)({},o),{propertyName:h,propertyTypes:t.propertyTypes?t.propertyTypes[h]:void 0}),m=v.customDisplayNameKey?function(N){N.withCustomDisplayName(v.customDisplayNameKey)}:void 0,g=t.properties[h];if("color"===v.type)a.addSimpleSlice(v.sliceName,function(){var N,P={value:null===(N=g.solid)||void 0===N?void 0:N.color};return new S.BT({descriptor:f,value:P}).build()},m);else if("enumeration"===v.type)a.addSimpleSlice(v.sliceName,function(){return new S.uY({descriptor:f,value:g}).build()},m);else if("toggle"===v.type)a.addSimpleSlice(v.sliceName,function(){return new S.bd({descriptor:f,value:g}).build()});else if("slider"===v.type||"transparency"===v.type){var y,D,T;if("transparency"===v.type)y=Ne.t2,D={type:0,value:0},T={type:1,value:100};else if("slider"===v.type){var q=v.options;y=q?.unitSymbol,D=null!=q?.min?{type:0,value:q.min}:void 0,T=null!=q?.max?{type:1,value:q.max}:void 0}a.addSimpleSlice(v.sliceName,function(){return new S.JN({descriptor:f,value:g,options:{unitSymbol:y,minValue:D,maxValue:T},localize:i}).build()},m)}else if("numUpDown"===v.type){var F=v?.options;a.addSimpleSlice(v.sliceName,function(){return new S.mu({descriptor:f,value:g,options:{unitSymbol:F.unitSymbol,unitSymbolAfterInput:F.unitSymbolAfterInput,minValue:null!=F?.min?{type:0,value:F.min}:void 0,maxValue:null!=F?.max?{type:1,value:F.max}:void 0},placeholderText:i(F.placeholderTextKey)}).build()})}},l=0,u=n;l<u.length;l++)s(u[l])}function he(a,e,t,r){var i=function(a,e){var t,r,i,n,o,s=null!==(i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.objects)&&void 0!==i?i:{};if(null===(n=z[a])||void 0===n||!n.supportsUserDefinedInstances)return null;for(var u=0,c=0,d=s[a]??[];c<d.length;c++){var h=null===(o=d[c].selector)||void 0===o?void 0:o.id,f=null!=h?parseInt(h,10):0;u=Math.max(u,f)}return{id:(u+1).toString()}}(a,t),n={merge:[{objectName:a,selector:i,properties:{show:!0}}]};if(null!=e){var o=je(a,t,e,r);n.merge[0].properties.displayName=o}return n}function ee(a,e,t,r){return he(a,r.get(e),t,r)}function Te(a,e){return{objectName:a,selector:e,properties:{}}}function Se(a,e,t,r){var i={removeObject:[]};i.removeObject.push(Te(a,e)),r.persistProperties(i,t,!0)}function Ee(a,e){var t;if(a){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r){var i=(0,ve.NA)(r.objects,{objectName:a.objectName,propertyName:"transform"},a.selector);return i?.parameters&&(i.parameters=_.filter(i.parameters,function(n){return!!n})),i}}}function at(a,e){if(e){var t=_.find(e.parameters,function(r){return r.name===a});if(!t)return;if((0,Ze.S9)(t.expr))return t.expr.value;b.fF.assertFail("Expect this only be called for parameters of analytics transforms that has SQConstant expressions with numeric value type")}}function je(a,e,t,r){var i,l,n=null!==(i=e.config.singleVisual.objects)&&void 0!==i?i:{},s=_.map(n[a],function(c){var d=c.properties.displayName;if(d)return Pt.m.getPrimitiveValuesFromSQConstantExpr(d)}).filter(function(c){return!!c}),u=1;do{l=r.format("AnalyticsPane_New_Instance_Default_Format",[t,u]),u++}while(_.includes(s,l));return l}var Ve=C(40702),mt=C(92194),Ft=C(22733),Ye=C(47508),jt=C(64869),Ce=C(94419),Lt=C(4633),w=C(50423),zt=C(26898),Nt=C(83008),ut=C(66890),ot=C(9380),et=C(65181),It=C(8082),bt=C(29866),Qe=K.xn,Yi={numeric:!0},dr=function(){function a(e,t,r,i,n,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=n,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return a.prototype.enumerateAnomalyCard=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,v,h,f,m,g,y,D,T,q,F=this;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return this.featureSwitchService.featureSwitches.daxTransformEnabled&&r.objects[Qe]?[4,this.conceptualSchemaProxy.get(this.dataSources.get())]:[2];case 1:return i=N.sent(),(n=function(e,t,r){var i=(0,X.Xf)(e);if(!i)return{shouldInclude:!1};if((0,X.iv)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_VC")};if((0,X.tL)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_Hidden")};var o=(0,X.oJ)(e);if(!_.every(o,function(v){return Pt.m.isExprValidForAnalysisTransform(v.expr)}))return{shouldInclude:!1};if(!_.every(t.schemas,function(e){return _.some(e.capabilities.transformCapabilities.supportedTransforms,function(t){return t===mt.Xp})&&!e.isMultiDimensionalModel}))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_ErrorMessage_NotSupport")};var l=function(a){if(a===Ye.L.lineChart.name)return Ft.x.category;b.fF.assertFail("Unsupported visual type for anomalies: "+a)}(e.config.singleVisual.visualType),u=i.tryGetExprs(l);if(!(0,K.h_)(u,t)&&!(0,jt._T)(t,i.defn,i.projections,l)){var c=r.get("Role_DisplayName_Axis");return{shouldInclude:!0,warningText:r.format("Visual_AnomalyDetection_WarningMessage_CategoryNotDateTime",c)}}return{shouldInclude:!0}}(e,i,this.localizationService)).shouldInclude?(o=(0,p.__spreadArray)((0,p.__spreadArray)([G,K.DM,K.Bx],Object.values(ae.m6),!0),[K.MA.confidenceBandShow,K.MA.confidenceBandColor,K.MA.confidenceBandStyle,K.MA.transparency],!1),[4,Q(Qe,"anomaly","Insights_TitleKey",t,r,s=function(P){return F.localizationService.get(P)},_.map(o,function(V){return{objectName:Qe,propertyName:V}}))]):[2];case 2:return(l=N.sent())?(u=l.cardBuilder,l.disableCard?((c=u.build()).analyticsPane=!0,[2,c]):_.isEmpty(n.warningText)?(h=l.objectInstance,f=(0,H.Ue)(),q=(0,Je.yF)(h.properties,(0,Je.EL)(f),Re.v.create(f)),m=q.marker,g=q.band,y=function(P){return{objectName:Qe,selector:h.selector,altConstantValueSelector:h.altConstantValueSelector,propertyName:P,propertyTypes:h.propertyTypes?h.propertyTypes[P]:void 0}},D=this.featureSwitchService.featureSwitches.newMarkerProperties,u.addGroup("options",function(V){var P;return V.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("sensitivity",function(){return S.JN.getTransparencySliderBuilder({descriptor:{objectName:Qe,propertyName:K.DM},value:Zi(Ee(h,e)),localize:s}).build()},function(O){return O.withCustomDisplayName("Visual_AnomalyDetection_Sensitivity")}).addSimpleSlice("explainBy",new S.k0({descriptor:{objectName:Qe,propertyName:K.Bx},value:{newExpr:_.map(null===(P=Xi(h,e))||void 0===P?void 0:P.exprs,function(O){return{expr:O}})},validators:{field:{kind:0}},allowMultipleValues:!0}).build(),function(O){return O.withCustomDisplayName("Role_DisplayName_ExplainBy")})}).addGroup("markers",function(V){D&&V.addTopLevelToggle("markerShow",function(){return new S.bd({descriptor:y(ae.m6.show),value:m.show}).build()}),V.withDisplayName("Visual_Shape").addSimpleSlice("markerShape",new S.uY({descriptor:y(ae.m6.shape),value:m.shape}).build()).addSimpleSlice("markerSize",new S.mu({descriptor:y(ae.m6.size),value:m.size,options:{minValue:{type:0,value:0},maxValue:{type:1,value:10},unitSymbol:Ne.e_}}).build()).addSimpleSlice("markerRotation",S.JN.getRotationSliderBuilder({descriptor:y(ae.m6.rotation),value:m.rotation,localize:s}).build(),function(P){return P.withHidden(!D||!(0,xe.Cd)(m.shape))})}).addGroup("colors",function(V){return V.withDisabled(!m.show).withDisplayName("Generic_Color").addSimpleSlice("markerColor",new S.BT({descriptor:y(ae.m6.color),value:{value:m.color}}).build()).addSimpleSlice("markerTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(ae.m6.transparency),value:m.transparency,localize:s}).build(),function(P){return P.withHidden(!D)})}),D&&u.addGroup("border",function(V){return V.withDisplayName("Visual_Border").withDisabled(!(0,xe.nK)(m.shape)||!m.show).addSlices((0,_e.Iq)({containerItemBuilder:V,descriptors:{strokeShow:y(ae.m6.strokeShow),strokeColorMatch:y(ae.m6.strokeColorMatch),strokeColor:y(ae.m6.strokeColor),strokeTransparency:y(ae.m6.strokeTransparency),strokeWidth:y(ae.m6.strokeWidth)},strokeData:m.stroke,selector:h.selector,featureSwitches:F.featureSwitchService.featureSwitches,localize:s}).map(function(P){return P.build()}))}),u.addGroup("expectedrange",function(V){V.withDisplayName("Visual_AnomalyDetection_ExpectedRange"),D&&V.addTopLevelToggle("markerBorderShow",function(){return new S.bd({descriptor:y(K.MA.confidenceBandShow),value:g.show}).build()}),V.addSimpleSlice("confidenceBandStyle",new S.uY({descriptor:y(K.MA.confidenceBandStyle),value:g.style,filterValues:D?[te.X$.fill,te.X$.line]:[te.X$.fill,te.X$.line,"none"]}).build()).addSimpleSlice("confidenceBandColor",new S.BT({descriptor:y(K.MA.confidenceBandColor),value:{value:g.color}}).build()).addSimpleSlice("confidenceBandTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(K.MA.transparency),value:g.transparency,localize:s}).build())}),(T=u.build()).analyticsPane=!0,[2,T]):(u.withDisabledLocalized(!0,n.warningText),(v=u.build()).analyticsPane=!0,[2,v])):[2]}})})},a.prototype.checkAddRemoveInstance=function(e,t,r){return e===Qe&&t.name===G&&(t.value?this.addInstance(r):Se(e,t.selector,r,this.visualAuthoringService),!0)},a.prototype.saveGroupSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Qe,t,r)];case 1:return(i=n.sent())&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!i]}})})},a.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Qe]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters)){var i=r.parameters,n=hr().expr;if(_.some(i,function(o){return o.name===K.DM&&!(0,ft.fS)(o.expr,n)}))return!0}return!1},a.prototype.revertAnomalyDetectionSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Qe]);if(i){if(_.some(r,function(d){return d.objectName===Qe&&d.propertyName===G}))return void Se(Qe,i.selector,e,this.visualAuthoringService);for(var n=i.properties.transform,o=K.DM,s=0,l=r;s<l.length;s++)if(l[s].propertyName===o){var c=_.findIndex(n?.parameters,function(d){return d.name===o});c>=0&&(n.parameters[c]=hr())}}}},a.prototype.getObjectDefinitions=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var n=i[r],o=n.properties[K.Bx];if(o&&_.isEmpty(o.exprs)){var s=(0,p.__assign)({},n.properties);delete s[K.Bx],t.push((0,p.__assign)((0,p.__assign)({},n),{properties:s}))}else t.push(n)}return t},a.prototype.addInstance=function(e){var t=ee(Qe,z.anomalyDetection.displayNameBaseKey,e,this.localizationService);b.fF.assert(function(){var s;return 1===(null===(s=t?.merge)||void 0===s?void 0:s.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;b.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getBoundMeasure(e),b.fF.assertValue(i.metadata,"new anomaly detecton instance selector should have metadata");var n=hr();r.properties.transform={algorithm:K.vb,parameters:[n]},r.properties[K.Bx]={exprs:[]},this.telemetryService.logEvent(Ve.Yu,{objectName:Qe}),this.visualAuthoringService.persistProperties(t,e,!0)},a.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(c){return _.includes(wt,c.propertySlice.name)})?[4,qt(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=u.sent(),_.isEmpty(o?.instances)?[2]:(b.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance but there are "+o.instances.length),s=o.instances[0],b.fF.assert(function(){return _.size(t)<=2},"At most 2 slice changes since there are only 2 slices in the Apply group"),l={merge:[]},_.forEach(t,function(c){var d=c.propertySlice;if(d.name===K.DM){var v=Ee(s,r);if(v){var h=function(a){return a/100}(d.value),f=qr(h);l.merge.push({objectName:Qe,selector:s.selector,properties:{transform:{algorithm:v.algorithm,parameters:[f]}}})}}else if(d.name===K.Bx){var m=d.value,g=m?.newExpr;l.merge.push({objectName:K.xn,properties:{explainBy:{exprs:_.map(g,function(y){return y.expr}),kind:"ExprList"}},selector:s.selector})}}),[2,l])}})})},a.prototype.getBoundMeasure=function(e){var t=(0,X.Xf)(e);b.fF.assertValue(t,"visualContainer should have a query");for(var i=0,n=(0,X.d$)(e,this.visualPluginService)??[];i<n.length;i++){var o=n[i];if(1===o.cartesianKind){var s=t.getQueryRefByProjectionIndex(o.name,0);if(s)return s}}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function Xi(a,e){var t;if(a){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r)return(0,ve.NA)(r.objects,K.XZ,a.selector)}}function hr(){return qr(K.z$)}function Zi(a){var e=at(K.DM,a);return null==e&&(e=K.z$),function(a){if(null!=a)return Math.round(100*a)}(e)}function qr(a){var e=(0,ve.Lo)(a,Yi);return b.fF.assert(function(){return e instanceof Ce.Il&&(0,Ze.VC)(e)},"encoded value for transform sensitivity parameter should be a constant"),{name:K.DM,expr:e}}var Ot,Qt,$t,fr,a,Rr=C(20114),Kt=C(40253),De=C(21571),ke=C(14599),ui=C(17772),Fr=C(69871),Oe=C(82173),le=Vt,Ur=((Ot={})[le.units]=Kt.xm,Ot[le.forecastLength]=10,Ot[le.ignoreLast]=0,Ot[le.confidenceInterval]=Rr.s$,Ot[le.seasonality]=void 0,Ot),Nr=((Qt={})[le.units]={enumeration:Kt.dt},Qt[le.forecastLength]={numeric:!0},Qt[le.ignoreLast]={numeric:!0},Qt[le.confidenceInterval]={enumeration:Rr.dt},Qt[le.seasonality]={numeric:!0},Qt),kr=(($t={})[le.forecastLength]=1,$t[le.ignoreLast]=0,$t[le.seasonality]=1,$t),mr=((fr={})[le.forecastLength]=2e9,fr[le.ignoreLast]=500,fr[le.seasonality]=2e9,fr),ar={units:{objectName:Oe.Po,propertyName:le.units},forecastLength:{objectName:Oe.Po,propertyName:le.forecastLength},ignoreLast:{objectName:Oe.Po,propertyName:le.ignoreLast},seasonality:{objectName:Oe.Po,propertyName:le.seasonality},confidenceInterval:{objectName:Oe.Po,propertyName:le.confidenceInterval}},Gr=_.map(ar,function(a){return a.propertyName}),ci=(a={},_.forEach(Kt.dt.members(),function(e,t){a[e.value]=t}),a),gr=function(){function a(e,t,r,i,n,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=n,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return a.prototype.enumerateForecastCard=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,c,d,v,h,f=this;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return r.objects[Oe.Po]?[4,this.querySupportsForecasting(e)]:[2];case 1:return m.sent()?[4,Q(Oe.Po,"forecast","Visual_Forecast",t,r,n=function(y){return f.localizationService.get(y)},(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],Object.values((0,ke.pN)(Oe.Po,ke.ZB)),!0),Object.values((0,ke.pN)(Oe.Po,ke.PK)),!0),_.map((0,p.__spreadArray)([le.units,le.forecastLength,le.ignoreLast,le.seasonality,le.confidenceInterval,"displayName","matchSeriesInterpolation","interpolation","interpolationStep","interpolationSmooth","interpolationSmoothParam"],Object.keys(ke.iQ),!0),function(g){return{objectName:Oe.Po,propertyName:g}}),!0),"show")]:[2];case 2:return(o=m.sent())?((0,X.iv)(e)?o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_VC"):(0,X.tL)(e)&&o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_Hidden"),s=o.cardBuilder,o.disableCard?((l=s.build()).analyticsPane=!0,[2,l]):(u=o.objectInstance,[4,this.conceptualSchemaProxy.get(this.dataSources.get())])):[2];case 3:return c=m.sent(),d=Ee(u,e),v=Tr(le.units,d),s.addGroup("options",function(g){g.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("units",function(){var y=f.getPossibleUnits(e,c);return new S.uY({items:y,descriptor:ar.units,value:_.find(y,function(D){return D.value===v})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Units").withInfoIconText(f.localizationService.format("AnalyticsPane_Forecast_Units_Apply_To_Properties_InfoText",[f.localizationService.get("Visual_Forecast_Parameter_ForecastLength"),f.localizationService.get("Visual_Forecast_Parameter_IgnoreLength")]))}).addSimpleSlice("forecastLength",function(){var y=Tr(le.forecastLength,d);return new S.mu({descriptor:ar.forecastLength,value:y,options:{minValue:{type:0,value:kr[le.forecastLength]},maxValue:{type:1,value:mr[le.forecastLength]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ForecastLength")}).addSimpleSlice("ignoreLast",function(){var y=Tr(le.ignoreLast,d);return new S.mu({descriptor:ar.ignoreLast,value:y,options:{minValue:{type:0,value:kr[le.ignoreLast]},maxValue:{type:1,value:mr[le.ignoreLast]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_IgnoreLength")}).addSimpleSlice("seasonality",function(){var y=Tr(le.seasonality,d);return new S.mu({descriptor:ar.seasonality,value:y,options:{unitSymbol:"Visual_Forecast_Units_Point",unitSymbolAfterInput:!0,minValue:{type:0,value:kr[le.seasonality]},maxValue:{type:1,value:mr[le.seasonality]}},placeholderText:f.localizationService.get("Visual_Auto")}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Seasonality")}).addSimpleSlice("confidenceInterval",function(){var y=Tr(le.confidenceInterval,d),D=vi(Rr.dt.members(),f.localizationService);return new S.uY({items:D,descriptor:ar.confidenceInterval,value:_.find(D,function(T){return T.value===y})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ConfidenceInterval")})}).addGroup("forecastline",function(g){return g.withDisplayName("Visual_Forecast_Line").addSlices((0,_e.Iq)({containerItemBuilder:g,descriptors:(0,p.__assign)((0,p.__assign)({},(0,ke.pN)(Oe.Po,ke.ZB)),{strokeShow:null}),strokeData:(0,_e.AF)(u.properties,ke.ZB,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:n,isSVGStroke:!0}).map(function(y){return y.build()})).addSimpleSlice("matchSeriesInterpolation",new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},Fr.qn.forecast.matchSeriesInterpolation),{selector:u.selector}),value:u.properties.matchSeriesInterpolation}).build()).addSlices((0,ui.Ie)({containerItemBuilder:g,descriptors:Fr.qn.forecast,interpData:(0,ui.Bs)(u.properties,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:n}).map(function(y){return y.withDisabled(!0===u.properties.matchSeriesInterpolation).build()}))}),s.addGroup("confidenceLine",function(g){return g.withDisplayName("Visual_Forecast_Confidence_Lines").addSlices((0,_e.Iq)({containerItemBuilder:g,descriptors:(0,ke.pN)(Oe.Po,ke.PK),strokeData:(0,_e.AF)(u.properties,ke.PK,{},void 0,u.properties.lineColor.solid.color),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:n,isSVGStroke:!0}).map(function(y){return y.build()}))}).addGroup("confidenceArea",function(g){g.withDisplayName("Visual_Forecast_Confidence_Shade").addTopLevelToggle("bandAreaShow",function(){return new S.bd({descriptor:{objectName:Oe.Po,propertyName:"bandAreaShow",selector:u.selector},value:u.properties.bandAreaShow}).build()}),Y(g,Oe.Po,u,r,n,[{type:"toggle",sliceName:"bandAreaMatchColor",propertyName:"bandAreaMatchColor"},{type:"color",sliceName:"bandAreaColor",propertyName:"bandAreaColor"},{type:"transparency",sliceName:"bandAreaTransparency",propertyName:"bandAreaTransparency"}])}),s.addGroup("tooltipTitle",function(g){g.withDisplayName("Visual_Forecast_Tooltip_Title").addSimpleSlice("titleText",new S.fq({descriptor:{objectName:Oe.Po,propertyName:"displayName",selector:u.selector},value:u.properties.displayName,placeholder:""}).build(),function(y){return y.withCustomDisplayName("Visual_Title_Text")})}),(h=s.build()).analyticsPane=!0,[2,h]}})})},a.prototype.checkAddRemoveInstance=function(e,t,r){return e===Oe.Po&&"show"===t.name&&(t.value?this.addInstance(r):Se(e,t.selector,r,this.visualAuthoringService),!0)},a.prototype.saveGroupSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return _.some(t,function(o){return o.objectName!==Oe.Po})||e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Oe.Po,t,r)];case 1:return i=n.sent(),t&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!t]}})})},a.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Oe.Po]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters))for(var i=r.parameters,n=pi(),o=function(v){var h=_.find(n,function(f){return f.name===v.name});return b.fF.assertValue(h||v.name===le.seasonality,"every forecast parameter should have a matching default value"),h?(0,ft.fS)(v.expr,h.expr)?void 0:{value:!0}:{value:v.name===le.seasonality&&!!v.expr}},s=0,l=i||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return!1},a.prototype.revertForecastSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Oe.Po]);if(i){if(_.some(r,function(c){return c.objectName===Oe.Po&&"show"===c.propertyName}))return void Se(Oe.Po,i.selector,e,this.visualAuthoringService);for(var n=i.properties.transform,o=function(d){var v=d.propertyName;if(_.includes(Gr,v)){var h=_.findIndex(n?.parameters,function(m){return m.name===v});if(h>=0){var f=n.parameters[h];n.parameters[h]=ea(f.name),(!n.parameters[h]||!f.expr)&&n.parameters.splice(h)}}},s=0,l=r;s<l.length;s++)o(l[s])}}},a.prototype.querySupportsForecasting=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return(0,X.Xf)(e)?(t=this.getForecastBoundMeasure(e),_.isEmpty(t)?[2,!1]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]):[2,!1];case 1:return r=n.sent(),i=(0,X.oJ)(e),[2,_.every(i,function(o){return Pt.m.isExprValidForAnalysisTransform(o.expr)&&!o.expr.hasGroupOnKeys(r)})]}})})},a.prototype.addInstance=function(e){var t=ee(Oe.Po,z.forecast.displayNameBaseKey,e,this.localizationService);b.fF.assert(function(){var o;return 1===(null===(o=t?.merge)||void 0===o?void 0:o.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;b.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getForecastBoundMeasure(e);var n=pi();r.properties.transform={algorithm:"Forecast",parameters:n},this.telemetryService.logEvent(Ve.Yu,{objectName:Oe.Po}),this.visualAuthoringService.persistProperties(t,e,!0)},a.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(v){return _.includes(Vt,v.propertySlice.name)})?[4,qt(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=d.sent(),_.isEmpty(o?.instances)?[2]:(b.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance. If there is object enumeration, it should contain exactly 1 instance"),(l=Ee(s=o.instances[0],r))?(u=[],_.forEach(_.values(Vt),function(v){var h=_.find(t,function(y){return y.propertySlice.name===v}),f=h?function(a,e){return b.fF.assertValue(e,"sliceValue must be defined"),a===le.units?ta(e):a===le.confidenceInterval?ra(e):e}(v,h.propertySlice.value):at(v,l);if(null!=f){var g=(0,ve.Lo)(f,Nr[v]);b.fF.assert(function(){return g instanceof Ce.Il&&(0,Ze.VC)(g)},"encoded value for transform parameter should be a constant"),u.push({name:v,expr:g})}}),[2,{merge:[{objectName:Oe.Po,selector:s.selector,properties:{transform:{algorithm:l.algorithm,parameters:u}}}]}]):[2])}})})},a.prototype.getPossibleUnits=function(e,t){var r=e.config.singleVisual,i=this.visualPluginService.capabilities(r.visualType),n=_.find(i.dataRoles,function(D){return 0===D.cartesianKind}),o=!1,s=!1;if(n){var l=r.query.defn,u=r.query.projections,c=n.name;if(!u[c])return;for(var v=function(T){var q=_.find(l.select(),function(N){return T.queryRef===N.name});b.fF.assertValue(q,"select in projections should be present in query");var F=q.expr.getMetadata(t);o=o||F.type.dateTime},h=0,f=u[c].all();h<f.length;h++)v(f[h]);s=(0,jt._T)(t,l,u,c)}var g=Kt.dt.members();if(o||s)return vi(g,this.localizationService);var y=_.find(g,function(D){return D.value===Kt.xm});return b.fF.assertValue(y,'"point" should be an available unit'),vi([y],this.localizationService)},a.prototype.getForecastBoundMeasure=function(e){var t,r,i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.query;if(!i)return"";for(var o=function(v){if(1===v.cartesianKind){var h=i.defn.select(),f=i.tryGetExprs(v.name)||[];if(1!==_.size(f))return{value:""};var m=_.find(h,function(g){return(0,ft.fS)(f[0],g.expr)});if(m)return{value:m.name}}},s=0,l=(0,X.d$)(e,this.visualPluginService)||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return""},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function pi(){var a=_.map(Ur,function(e,t){return ea(t)});return _.filter(a,function(e){return!!e})}function ea(a){var e=Ur[a],t=e;if(null!=t){a===le.units?t=ta(e):a===le.confidenceInterval&&(t=ra(e));var i=(0,ve.Lo)(t,Nr[a]);return b.fF.assert(function(){return i instanceof Ce.Il&&(0,Ze.VC)(i)},"encoded value for transform parameter should be a constant"),{name:a,expr:i}}}function Tr(a,e){var t=at(a,e);return null==t?Ur[a]:a===le.units?function(a){return _.findKey(ci,function(e){return e===a})}(t):a===le.confidenceInterval?function(a){return 100*a+"%"}(t):t}function ta(a){return ci[a]}function ra(a){return parseFloat(a)/100}function vi(a,e){return _.map(a,function(t){return{value:t.value,displayName:(0,De.G)(t.displayName,e)}})}var me,ze,Me=C(57871);!function(a){a.MinContainerWidth=Me.A6,a.MinContainerHeight=Me.Q$,a.MaxPrecision=15,a.SliceNameAxisStart="axisStart",a.SliceNameAxisEnd="axisEnd",a.SliceNameStart="start",a.SliceNameEnd="end",a.SliceNameInvertAxis="invertAxis",a.SliceNameSecStart="secStart",a.SliceNameSecEnd="secEnd",a.SliceNameSecInvertAxis="secInvertAxis",a.PlotAreaCardName="plotArea",a.ImageSliceName="image",a.MapSliceName="map",a.ImageFitSliceName="scaling",a.TransparencySliceName="transparency"}(me||(me={})),function(a){a.DisplayAreaName="displayArea",a.PageRefreshCardName="pageRefresh",a.PageSizeCardName="pageSize",a.PageSizeTypeName="pageSizeTypes",a.PageSizeWidthName="pageSizeWidth",a.PageSizeHeightName="pageSizeHeight",a.PageBackgroundColor="color",a.PageInformationCardName="pageInformation",a.PageInformationName="pageInformationName",a.PageInformationQnaPodEnabled="pageInformationQnaPodEnabled",a.PageInformationAltName="pageInformationAltName",a.PageInformationType="pageInformationType",a.PageBackgroundImage="image",a.PageBackgroundTransparency="transparency",a.PageBackgroundRevertToDefault="revertToDefault",a.PageBackgroundCardName="background",a.OutspaceBackgroundCardName="outspace",a.OutspacePaneCardName="outspacePane",a.FilterCardName="filterCard",a.PageSizeUnits={Pixels:"px"},a.PersonalizeVisual="personalizeVisual"}(ze||(ze={}));var nr,or,di=C(3579),oe=C(2529),yr=C(57521),ia=C(32379),Wr=C(13702),Bt=["Min","Max","Average","Median","Percentile"],Hr=["ConstantX","ConstantY1"],aa=((nr={}).Min=function(a){return(0,Ce.m_)(a,3)},nr.Max=function(a){return(0,Ce.m_)(a,4)},nr.Average=function(a){return(0,Ce.m_)(a,1)},nr.Median=function(a){return(0,Ce.m_)(a,6)},nr.Percentile=function(a,e){var t=parseFloat(e);return t=_.isNaN(t)?0:Math.min(Math.max(0,t),100),(0,Ce.Pe)(a,t/100,!1)},nr),Tn=[oe.tZ,oe.KZ,oe.oB,oe.FK,oe.yl,oe.Zs,oe.nR,oe.G5,oe.UD,oe.XI,oe.pw],na=((or={}).Min="Visual_Min_Reference_Line",or.Max="Visual_Max_Reference_Line",or.Average="Visual_Average_Reference_Line",or.Median="Visual_Median_Reference_Line",or.Percentile="Visual_Percentile_Reference_Line",or),Et=ie,Kr=function(){function a(e,t,r,i,n,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.displayNameService=r,this.featureSwitchService=i,this.localizationService=n,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l,this.visualToUserUnknownLineInstancesMap={}}return a.prototype.getReferenceLineInstancesInfo=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!1)];case 1:return[2,n.sent()]}})})},a.prototype.getReferenceAndConstantLinesInfo=function(e,t,r,i){var n;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,T,q,F,V,P,O,E,L,B,x;return(0,p.__generator)(this,function(j){switch(j.label){case 0:return r.objects?(o=(0,X.GQ)(e),s=(0,X.oJ)(e),l=!1,u={},v=!1,h=!1,r.objects[Et]?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[3,3]):[2];case 1:return f=j.sent(),d=I(e,f,this.displayNameService,this.visualPluginService),_.isEmpty(d)?[3,3]:[4,ca(t,Et)];case 2:c=j.sent(),(l=!_.isEmpty(c))&&(m=function(a,e){for(var t=!1,r=!1,i=0,n=e||[];i<n.length;i++){var s=n[i].selectExpr.expr.getTargetSchemaName(),l=a.schema(s),u=l?.capabilities;if(u?.supportsMedian&&(t=!0),u?.supportsPercentile&&(r=!0),t&&r)break}return{supportsMedian:t,supportsPercentile:r}}(f,d),v=m.supportsMedian,h=m.supportsPercentile,u=null!==(n=_.chain(c).map(function(R){return sa(R,!R.properties[oe.$Z],o,s)}).groupBy(function(R){return R.type}).value())&&void 0!==n?n:{}),j.label=3;case 3:g=!1,y=!1,T=function(k){var re,ne,J;return(0,p.__generator)(this,function(se){switch(se.label){case 0:return re=Mt(k),r.objects[re]?[4,ca(t,re)]:[3,2];case 1:ne=se.sent(),J=!_.isEmpty(ne),"ConstantX"===k?g=J:y=J,J&&(u[k]=_.map(ne,function(we){return{visualObjectInstance:we,isDefaultInstance:!we.properties[oe.$Z],type:k}})),se.label=2;case 2:return[2]}})},q=0,F=i?Hr:[],j.label=4;case 4:return q<F.length?[5,T(F[q])]:[3,7];case 5:j.sent(),j.label=6;case 6:return q++,[3,4];case 7:if(!l&&!g&&!y)return[2];for(V=[],O=0,E=(0,p.__spreadArray)((0,p.__spreadArray)([],Hr,!0),Bt,!0);O<E.length;O++)("ConstantX"!==(L=E[O])||g)&&("ConstantY1"===L&&!y||_.includes(Bt,L)&&!l||"Median"===L&&!v||"Percentile"===L&&!h||(B=u[L],_.isEmpty(B)&&_.includes(Bt,L)&&(P||(P=_.find(u[be],function(R){return R.isDefaultInstance})),P||(P=sa(c[0],!0,o,s)),(x=_.cloneDeep(P)).type=L,B=[x]),V.push([L,B])));return b.fF.assert(function(){return _.every(V,function(R){return _.size(R[1])>=1})},"We should return at least 1 instance for each of the supported reference or constant reference line types, if no real instance, then return a default one."),[2,{groupedInstances:V,validMeasures:d}]}})})},a.prototype.createReferenceLineCard=function(e,t,r,i,n,o){var s=this,l=new S.lg(e),u=function(h){return s.localizationService.get(h)},c=[],d=new S.CQ(l,t,void 0,u,!1).addGroup(void 0,function(v){for(var h={uid:e+"-container",containerItems:[],displayName:s.localizationService.get("Apply_Settings_To"),isEditable:!0},f=0,m=r??[];f<m.length;f++){var g=m[f],y=g.type,D=ua(y),T=oa(g),q=g.visualObjectInstance.selector,F={displayName:T,groups:[],uid:"".concat(y,"-").concat(q?.id||be)};h.containerItems.push(F);var N={objectName:Mt(y),propertyName:void 0,propertyTypes:void 0,selector:q,altConstantValueSelector:g.visualObjectInstance.altConstantValueSelector},V=q?.id.includes(be),P=V||g.isDefaultInstance;if(o){var O={value:be,displayName:s.localizationService.get("Choose_A_Type")},E=Pn(l,D,y,O,o,N,u);P&&!V&&(E.group.disabled=!0),F.groups.push(E.group),c.push.apply(c,E.descriptors)}var L=In(l,y,g,n,N,D,u);L&&(P&&(L.group.disabled=!0),F.groups.push(L.group),c.push.apply(c,L.descriptors));var B=xn.call(s,l,y,g,i,N,D,u);P&&(B.group.disabled=!0),F.groups.push(B.group),c.push.apply(c,B.descriptors);var x=An(l,y,g,i,N,s.localizationService,u);x&&(P&&(x.group.disabled=!0),F.groups.push(x.group),c.push.apply(c,x.descriptors));var j=jn(l,g,i,N,u);P&&(j.group.disabled=!0),F.groups.push(j.group),c.push.apply(c,j.descriptors)}v.withContainer(h)}).build();return d.analyticsPane=!0,d.revertToDefaultDescriptors=c,d},a.prototype.enumerateReferenceAndConstantLineCards=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!0)];case 1:return i=n.sent(),_.isEmpty(i?.groupedInstances)?[2]:this.featureSwitchService.featureSwitches.onObject?[4,this.enumerateReferenceAndConstantLineCardsV2(e,i,r)]:[3,3];case 2:case 4:return[2,n.sent()];case 3:return[4,this.enumerateReferenceAndConstantLineCardsV1(e,i,r)]}})})},a.prototype.checkAddRemoveRenameInstance=function(e,t,r){var i,n,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,D,T,q,F,N;return(0,p.__generator)(this,function(V){switch(V.label){case 0:if("editable-container-object-name"!==e)return[2,!1];if(l=t.value,b.fF.assert(function(){var P,O,E;return(_.isEmpty(null===(P=l.itemUpdates)||void 0===P?void 0:P.adds)?0:_.size(l.itemUpdates.adds))+(_.isEmpty(null===(O=l.itemUpdates)||void 0===O?void 0:O.deletes)?0:_.size(l.itemUpdates.deletes))+(_.isEmpty(null===(E=l.itemUpdates)||void 0===E?void 0:E.renames)?0:_.size(l.itemUpdates.renames))<=1},"Expect only one add/delete/rename at a time"),_.isEmpty(null===(i=l.itemUpdates)||void 0===i?void 0:i.adds))return[3,2];if(u=void 0,(c=_.findKey(ht,function(P){return _.includes(t.name,P)}))?u=c:_.includes(t.name,z.xAxisReferenceLine.objectName)?u="ConstantX":_.includes(t.name,z.y1AxisReferenceLine.objectName)&&(u="ConstantY1"),null==u){T=this.visualToUserUnknownLineInstancesMap[d=r.name]||[],v=_.map(T,function(P){return P.displayName}),h=0,f=void 0;do{h++,f=this.localizationService.format("UserUnknown_Line_Format",[h])}while(_.includes(v,f));return m={id:"".concat(be,"-").concat(h)},T.push({displayName:f,selector:m}),this.visualToUserUnknownLineInstancesMap[d]=T,[2,!0]}return[4,this.addLineInstance(u,r)];case 1:return V.sent(),[2,!0];case 2:return(y=_.first(null===(n=l.itemUpdates)||void 0===n?void 0:n.deletes))?(s=pa(y))===be?(this.removeUserUnknownLine(r.name,y.displayName),[2,!0]):(N=Mt(s),[2,this.deleteInstance(N,r,y.displayName)]):(D=_.first(null===(o=l.itemUpdates)||void 0===o?void 0:o.renames))?(s=pa(D.item))===be?(T=this.visualToUserUnknownLineInstancesMap[r.name],q=_.find(T,function(P){return P.displayName===D.item.displayName}),F=(0,De.G)(D.newDisplayName,this.localizationService),q.displayName=F,[2,!0]):(N=Mt(s),[2,this.renameInstance(N,r,D)]):[2,!1]}})})},a.prototype.tryHandleReferenceLineSpecialSave=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return e===z.xAxisReferenceLine.objectName&&t.name===oe.rS&&_.isBoolean(t.value)?(void 0,i=t.value?_.find(yr.dt.members(),function(c){return c.value!==yr.YP}).value:yr.YP,(s={objectName:e,selector:t.selector,properties:{}}).properties[t.name]=i,[2,{isHandled:!0,persistChanges:{merge:[s]}}]):(n=_.findKey(ht,function(c){return c===e}))&&(t.name===fe||t.name===ye)&&t.selector?(s=function(a,e,t){var r=e.name===fe,i=e.name===ye;if(b.fF.assert(function(){return r||i},"Expect the given slice to be for changing measure selection or changing percentile value"),r||i){var o,n=r?e.value:e.selector.metadata;if(b.fF.assertValue(n,"The slice is for measure or percentile, in either case it should have an associated measure"),i)o=e.value;else if("Percentile"===a&&r){var s=(0,X.GQ)(t),l=_.find(s[ie],function(u){return(0,ia.fS)(u.selector,e.selector)});b.fF.assertValue(l,"It is changing measure selection of a percentile line, expect the given visual has a matching percentile object"),o=l?(100*l.properties.value.k).toString():"90"}return la(a,e.selector,r,n,o,t)}}(n,t,r),[2,{isHandled:!0,persistChanges:{merge:[s]}}]):t.name!==ge?[3,2]:[4,this.tryGetLineTypeChange(e,t,r)];case 1:return l=u.sent(),[2,{isHandled:!0,persistChanges:l?.persistChanges,newPropertyChanges:l?.newPropertyChanges}];case 2:return[2,{isHandled:!1}]}})})},a.prototype.tryGetLineTypeChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,c,d,v,h,f,m,g,y,D,T;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return t.selector.id.startsWith(be)?(i=_.find(this.visualToUserUnknownLineInstancesMap[r.name],function(N){return N.selector.id===t.selector.id}),this.removeUserUnknownLine(r.name,n=i.displayName),o=this.localizationService.get("UserUnknown_Line_Format"),s=new RegExp("^".concat(o," \\d+$")).test(n),[4,this.getAddLineInstanceChanges(t.value,r,s?void 0:n)]):[3,2];case 1:return[2,{persistChanges:{merge:F.sent()}}];case 2:return"xAxisReferenceLine"===e?c="ConstantX":"y1AxisReferenceLine"===e?c="ConstantY1":(d=_.findKey(ht,function(N){return _.includes(e,N)}),c=d),(v=t.value)===c?[2,{}]:(h=(0,X.GQ)(r),f=Mt(c),m=_.find(h[f],function(N){return N.selector.id===t.selector.id}),g=this.checkDefaultDisplayName(c,m,r),y=_.includes(Hr,c),D=_.includes(Hr,v),y||D?[4,this.getModifyCrossObjectLineTypeChange(m,r,c,v,g)]:[3,4]);case 3:return[2,{persistChanges:(T=F.sent()).persistChanges,newPropertyChanges:T.newPropertyChanges}];case 4:return[2,{persistChanges:{merge:[this.getModifyReferenceLineTypeChange(t.selector,v,g,r)]}}]}})})},a.prototype.getModifyReferenceLineTypeChange=function(e,t,r,i){b.fF.assertValue(e,"Expect selector to be defined");var n=e.metadata;b.fF.assertValue(n,"Expect measureName to be defined");var o={objectName:Et,selector:e,properties:{}},s="Percentile"===t?"90":void 0,u=(0,aa[t])((0,Ce.xA)(n),s);if(o.properties.value=u,r){var c=this.getLineDisplayName(t,i);o.properties.displayName=je(Mt(t),i,c,this.localizationService)}return o},a.prototype.getModifyCrossObjectLineTypeChange=function(e,t,r,i,n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return o=Mt(r),s=Qr(e),l=Te(o,e.selector),[4,this.getAddLineInstanceChanges(i,t,n?void 0:s)];case 1:return u=m.sent(),d=e.properties,v=[],_.forEach(Object.keys(d),function(g){Tn.includes(g)&&v.push({propertyName:g,value:d[g]})}),h={merge:u,removeObject:[l]},_.isEmpty(v)?[2,{persistChanges:h}]:(f={objectName:Mt(i),selector:u[0].selector,properties:{}},_.forEach(v,function(g){f.properties[g.propertyName]=g.value}),[2,{persistChanges:h,newPropertyChanges:f}])}})})},a.prototype.getAddLineInstanceChanges=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return i=Mt(e),n=this.getLineDisplayName(e,t),o=he(i,n,t,this.localizationService),b.fF.assert(function(){var v;return 1===(null===(v=o?.merge)||void 0===v?void 0:v.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item"),r&&(o.merge[0].properties.displayName=r),_.includes(Bt,e)?(b.fF.assertValue(s=o.merge[0].selector,"referenceLine addInstance merge change should have a defined selector"),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:l=d.sent(),u=I(t,l,this.displayNameService,this.visualPluginService),_.isEmpty(u)||(c=la(e,s,!0,u[0].value,"Percentile"===e?"90":void 0,t))&&o.merge.push(c),d.label=2;case 2:return this.telemetryService.logEvent(Ve.Yu,{objectName:e}),[2,o.merge]}})})},a.prototype.removeUserUnknownLine=function(e,t){var r=this.visualToUserUnknownLineInstancesMap[e];r=_.filter(r,function(i){return i.displayName!==t}),this.visualToUserUnknownLineInstancesMap[e]=r},a.prototype.addLineInstance=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getAddLineInstanceChanges(e,t)];case 1:return r=i.sent(),this.visualAuthoringService.persistProperties({merge:r},t,!0),[2]}})})},a.prototype.deleteInstance=function(e,t,r){var i=(0,X.GQ)(t),n=_.find(i[e],function(o){return Qr(o)===r});return!!n&&(Se(e,n.selector,t,this.visualAuthoringService),!0)},a.prototype.renameInstance=function(e,t,r){var i=(0,X.GQ)(t),n=_.find(i[e],function(l){return Qr(l)===r.item.displayName});return!!n&&(this.visualAuthoringService.persistProperties({merge:[{objectName:e,selector:n.selector,properties:{displayName:r.newDisplayName}}]},t,!0),!0)},a.prototype.enumerateReferenceAndConstantLineCardsV2=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,f,m,g,T=this;return(0,p.__generator)(this,function(q){return _.isEmpty(t?.groupedInstances)?[2]:(i=_.map(t.groupedInstances,function(F){return F[0]}),n=_.map(i,function(F){return{value:F,displayName:T.getLineDisplayName(F,e)}}),o=this.localizationService.get("ReferenceLine"),s=[],_.forEach(t.groupedInstances,function(F){return s.push.apply(s,F[1])}),l=_.filter(s,function(F){return!F.isDefaultInstance}),u=this.visualToUserUnknownLineInstancesMap[e.name],c=_.size(l),d=_.size(u),v=c+d,h=_.sortBy(l,function(F){return oa(F)}),f=[],_.forEach(u,function(F){var N,V={visualObjectInstance:{objectName:"referenceLine",properties:(N={},N[oe.ss]=F.displayName,N),selector:F.selector},isDefaultInstance:!1,type:be};f.push(V)}),h.push.apply(h,_.sortBy(f,function(F){return F.visualObjectInstance.properties.displayName})),0===v&&((m=(0,p.__assign)({},s[0])).type=be,h.push(m)),g=v>0?this.localizationService.format("NamePattern_Bracket",[o,v]):o,[2,[this.createReferenceLineCard("referenceLine",g,h,r,t.validMeasures,n)]])})})},a.prototype.enumerateReferenceAndConstantLineCardsV1=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){for(i=[],n=0,o=t.groupedInstances;n<o.length;n++)l=(s=o[n])[0],u=s[1],!_.isEmpty(u)&&(c=this.getLineDisplayName(l,e),d=_.size(_.filter(u,function(g){return!g.isDefaultInstance})),v=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c,h=On(l),f=this.createReferenceLineCard(h,v,u,r,t.validMeasures),i.push(f));return[2,i]})})},a.prototype.getLineDisplayName=function(e,t){var r;if("ConstantX"===e||"ConstantY1"===e){var i=Mt(e),n=(0,di.s)(t),o=this.visualPluginService.capabilities(n);return(null===(r=o.objects[i])||void 0===r?void 0:r.displayName)?(0,De.G)(o.objects[i].displayName,this.localizationService):this.localizationService.get("ConstantX"===e?"Visual_Reference_Line_X":"Visual_Reference_Line_Y")}if(_.includes(Bt,e))return this.localizationService.get(na[e]);b.fF.assertFail("should always return a displayName key")},a.prototype.checkDefaultDisplayName=function(e,t,r){var i=Qr(t).toLocaleLowerCase(),n=this.getLineDisplayName(e,r).toLocaleLowerCase();return new RegExp("^".concat(n," \\d+$")).test(i)},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Wr.O),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function Qr(a){return Ce.jz.getTextValue(a.properties[oe.ss])}function oa(a){return a.visualObjectInstance.properties.displayName}function fi(a){return ua(a)}function Pn(a,e,t,r,i,n,o){return{group:new S.mQ(new S.SS(a,"type"),o).addSimpleSlice(ge,function(){var l=t!==be?_.find(i,function(u){return u.value===t}):r;return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},n),{objectName:e,propertyName:ge}),items:i,value:l}).build()},function(l){l.withCustomDisplayName("Type")}).build(),descriptors:[{objectName:e,propertyName:ge}]}}function In(a,e,t,r,i,n,o){if(_.includes(Bt,e)){var s=t.visualObjectInstance.propertyTypes;return{group:new S.mQ(new S.SS(a,"measure"),o).withDisplayName("Series").addSimpleSlice(fe,function(){var u=t.isDefaultInstance?r[0]:_.find(r,function(c){return c.value===t.measureName});return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},i),{objectName:n,propertyTypes:s?s[fe]:void 0,propertyName:fe}),items:r,value:u}).build()},function(u){u.withCustomDisplayName("Series")}).build(),descriptors:[{objectName:n,propertyName:fe}]}}}function xn(a,e,t,r,i,n,o){var s,l,u=[],c=t.visualObjectInstance,d=c.propertyTypes,v=new S.mQ(new S.SS(a,"line"),o).withDisplayName("Visual_Shape_Line");!t.isDefaultInstance&&"Percentile"===e&&v.addSimpleSlice(ye,function(){return b.fF.assert(function(){return null!=t.percentileValue},"percentileValue should be calculated already"),S.JN.getTransparencySliderBuilder({descriptor:(0,p.__assign)((0,p.__assign)({},i),{objectName:n,propertyTypes:d?d[fe]:void 0,propertyName:ye}),value:t.percentileValue,localize:o}).build()},function(T){T.withCustomDisplayName("Visual_Reference_Line_Percentile")}),u.push({objectName:n,propertyName:ye});var h=oe.S3,f=(0,p.__assign)((0,p.__assign)({},i),{propertyTypes:d?d[h]:void 0,propertyName:oe.S3,instanceKind:c.propertyInstanceKind&&c.propertyInstanceKind[oe.S3]});"ConstantX"===e&&(v.addSimpleSlice(oe.S3,function(){return d&&d[h]&&d[h].dateTime?new S.hz({descriptor:f,value:c.properties[h],placeholder:""}).build():new S.fq({descriptor:f,value:c.properties[h],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName})),"ConstantY1"===e&&(v.addSimpleSlice(oe.S3,function(){return new S.fq({descriptor:f,value:c.properties[oe.S3],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName}));var m=c.objectName;if(r.objects[m]){var g=(0,ke.pN)(c.objectName,ke.vi),y=(0,_e.Iq)({containerItemBuilder:v,descriptors:g,strokeData:(0,_e.AF)(c.properties,ke.vi,it.xs,null===(l=null===(s=c.properties.lineColor)||void 0===s?void 0:s.solid)||void 0===l?void 0:l.color),selector:c.selector,featureSwitches:this.featureSwitchService.featureSwitches,localize:o,isSVGStroke:!0});v.addSlices(y.map(function(T){return T.build()})),u.push.apply(u,Object.values(g));var D=[{type:"enumeration",sliceName:"position",propertyName:oe.FK}];Y(v,m,c,r,o,D),u.push.apply(u,_.map(D,function(T){return{objectName:m,propertyName:T.propertyName}}))}return{group:v.build(),descriptors:u}}function An(a,e,t,r,i,n,o){var s,l=t.visualObjectInstance;if("ConstantX"===e&&l.properties.hasOwnProperty(oe.rS)&&_.has(r.objects[i.objectName].properties,oe.rS)){var u=new S.mQ(new S.SS(a,"shadeArea"),o),c=_.find(yr.dt.members(),function(y){return y.value===yr.YP}),v=l.properties[oe.rS]!==c.value;u.withDisplayName("Visual_Shapes_ShadeArea").addTopLevelToggle("shadeAreaShow",function(){return new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},i),{propertyName:oe.rS}),value:v}).build()});var h=_.chain(yr.dt.members()).filter(function(y){return y.value!==c.value}).map(function(y){return{value:y.value,displayName:(0,De.G)(y.displayName,n)}}).value(),f=l;v||((f=(0,p.__assign)({},l)).properties=(0,p.__assign)({},l.properties),f.properties[oe.rS]=null===(s=_.first(h))||void 0===s?void 0:s.value,_.has(f.properties,oe.HO)||(f.properties[oe.HO]={solid:{color:"#000"}}),_.has(f.properties,oe.af)||(f.properties[oe.af]=0));var m=f.properties[oe.rS];u.addSimpleSlice("shadePosition",function(){return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},i),{propertyName:oe.rS}),items:h,value:_.find(h,function(y){return y.value===m})}).build()},function(y){y.withCustomDisplayName("Visual_Position")}),Y(u,f.objectName,f,r,o,[{type:"color",sliceName:"shadeColor",propertyName:oe.HO,customDisplayNameKey:"Generic_Color"},{type:"transparency",sliceName:"shadeTransparency",propertyName:oe.af,customDisplayNameKey:"Transparency"}]);var g=[];return g.push({objectName:i.objectName,propertyName:oe.rS}),g.push({objectName:l.objectName,propertyName:oe.HO}),g.push({objectName:l.objectName,propertyName:oe.af}),{group:u.build(),descriptors:g}}}function jn(a,e,t,r,i){var n=[],o=new S.mQ(new S.SS(a,"dataLabel"),i),s=e.visualObjectInstance,l=s.properties.dataLabelShow;o.withDisplayName("Visual_Reference_Line_Data_Label").addTopLevelToggle("dataLabelShow",function(){return new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},r),{propertyName:oe.yl}),value:l}).build()}),n.push({objectName:r.objectName,propertyName:oe.yl});var u=[{type:"enumeration",sliceName:"dataLabelHorizontalPosition",propertyName:oe.nR},{type:"enumeration",sliceName:"dataLabelVerticalPosition",propertyName:oe.G5},{type:"enumeration",sliceName:"dataLabelText",propertyName:oe.Zs,customDisplayNameKey:"Style"},{type:"color",sliceName:"dataLabelColor",propertyName:oe.UD},{type:"enumeration",sliceName:"dataLabelDisplayUnits",propertyName:oe.XI},{type:"numUpDown",sliceName:"dataLabelDecimalPoints",propertyName:oe.pw,options:{min:0,max:me.MaxPrecision,placeholderTextKey:"Visual_Auto"}}],c=s.objectName;l?Y(o,c,s,t,i,u):o.addSimpleSlice("dataLabelNotAvailableMessage",function(){return new S.G_({descriptor:{objectName:c,selector:s.selector,propertyName:void 0},value:i("AnalyticsPane_DataLabelGroup_NotAvailable_Message")}).build()}),n.push.apply(n,_.map(u,function(v){return{objectName:c,propertyName:v.propertyName}}));var d=o.build();return l||(d.slices[0].disabled=!0),{group:d,descriptors:n}}function sa(a,e,t,r){b.fF.assertValue(a,"instance must be defined");var i=(0,ve.NA)(t,{objectName:Et,propertyName:oe.S3},a.selector),n=a;e&&((n=_.cloneDeep(a)).properties||(n.properties={}),n.properties[oe.$Z]=!1,n.properties[oe.ss]="",n.properties[oe.yl]=!1,n.selector=null);var o=i;if(!o||!(0,Ze.iV)(o)&&!(0,Ze.T5)(o))return{visualObjectInstance:n,isDefaultInstance:e,type:void 0};var s=o.arg;if(!s)return{visualObjectInstance:n,isDefaultInstance:e,type:void 0};var c,d,l=r.withName(s.expressionName),u=l?l.name:void 0;return!e&&(0,Ze.T5)(o)?(c=100*o.k,d="Percentile"):(0,Ze.X5)(o)?d="Min":(0,Ze.lg)(o)?d="Max":(0,Ze.Xx)(o)?d="Median":(0,Ze.Ny)(o)&&(d="Average"),{visualObjectInstance:n,isDefaultInstance:e,type:d,measureName:u,percentileValue:c}}function la(a,e,t,r,i,n){b.fF.assert(function(){return null!=a},"Expect referenceLineType to be defined"),b.fF.assertValue(e,"Expect selector to be defined"),b.fF.assertValue(r,"Expect measureName to be defined"),b.fF.assertAnyValue(i,"");var o={objectName:Et,selector:e,properties:{}};if(!t||o.selector.metadata!==r){if(o.selector.metadata!==r){var s=(0,X.GQ)(n);s&&(0,ve.xl)(s,Et,o.selector,{id:o.selector.id,metadata:r}),o.selector.metadata=r}var u=(0,aa[a])((0,Ce.xA)(r),i);return o.properties.value=u,o}}function Mt(a){return"ConstantX"===a?z.xAxisReferenceLine.objectName:"ConstantY1"===a?z.y1AxisReferenceLine.objectName:_.includes(Bt,a)?Et:a===be?Et+"-default":void b.fF.assertFail("should always return an objectName")}function ua(a){return"ConstantX"===a?z.xAxisReferenceLine.objectName:"ConstantY1"===a?z.y1AxisReferenceLine.objectName:_.includes(Bt,a)?ht[a]:a===be?Et+"-default":void b.fF.assertFail("should always return an objectName")}function On(a){if("ConstantX"===a)return"xAxisReferenceLine";if("ConstantY1"===a)return"y1AxisReferenceLine";if(_.includes(Bt,a)){if("Min"===a)return"referenceLine-minLine";if("Max"===a)return"referenceLine-maxLine";if("Average"===a)return"referenceLine-averageLine";if("Median"===a)return"referenceLine-medianLine";if("Percentile"===a)return"referenceLine-percentileLine"}b.fF.assertFail("should always return card name")}function ca(a,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,qt(a,e)];case 1:return(t=i.sent())?(r=nt.G.normalize(t),[2,r?.instances]):[2]}})})}function pa(a){return a.uid.split("-")[0]}var Z=C(9215),mi=C(92783),gi=new w.InjectionToken("FormattingObjectDefinitionsService"),Mn=C(6426),sr=C(93599),ce=C(78432),qe=C(24408),st=C(50550),Yt=C(28488),gt=C(80777),$r=C(54766),U=C(67746),va=C(84631),da=C(26902),Pe=C(20590),yi=C(40812),Si=C(10746),_i=function(){function a(e,t,r){this.conceptualSchemaProxy=e,this.featureSwitchService=t,this.localizationService=r}return a.prototype.populateConditionalFormattingCard=function(e,t){b.fF.assertValue(t,"populateConditionaFormattingCard: empty options"),b.fF.assertValue(t.enumerateObjectRepetition,"populateConditionaFormattingCard: null options.enumerateObjectRepetition");var r=t.enumerateObjectRepetition();if(!_.isEmpty(r)){var i=U.T9,n=(0,Pe.Gf)((0,De.V)("PropertyPane_ConditionalFormatting_CardTitle"),this.localizationService),o=e.cards.withName(i);o||(o={name:i,id:qe.Yb(t.visualType,i),index:t.cardIndexCounter,displayName:n,slices:(0,st.bv)(),footer:[],mainShow:null,isDirty:!1},this.addConditionalFormattingContainers(o,r,t).then(function(){qe.ht(t,o),e.cards.push(o)}))}},a.prototype.addConditionalFormattingContainers=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:b.fF.assertValue(e,"populateConditionalFormattingContainers: card"),b.fF.assertNonEmpty(t,"populateConditionalFormattingContainers: repetitions"),b.fF.assertValue(r,"populateConditionalFormattingContainers: options"),b.fF.assertValue(r.objectDescriptors,"populateConditionalFormattingContainers: options.objectDescriptors"),i=(0,yi.sd)(t,r.objectDescriptors),n=function(v){var h,f,m,g,y;return(0,p.__generator)(this,function(D){switch(D.label){case 0:return h=v.selector,(f=v.containerName)?(e.containers||(e.containers=(0,st.bv)()),(m=_.find(e.containers,function(T){return T.displayName===f}))||(y=qe.Yl(e.name,g=e.containers.length),m={name:y,displayName:f,value:y,selector:h,containerIndex:g,isDisabled:!1,slices:(0,st.bv)()},e.containers.push(m)),[4,o.addConditionalFormattingSlices(r,m,v)]):[2,"continue"];case 1:return D.sent(),[2]}})},o=this,s=0,l=i,c.label=1;case 1:return s<l.length?[5,n(l[s])]:[3,4];case 2:c.sent(),c.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},a.prototype.addConditionalFormattingSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return[4,this.getConditionalFormattingSliceProperties({conceptualSchemaProxy:this.conceptualSchemaProxy,conditionalFormattingDialogLauncherFactory:e.conditionalFormattingDialogLauncherFactory,dataBarsDialogLauncherFactory:e.dataBarsDialogLauncherFactory,dataSourcesService:e.dataSourcesService,featureSwitchService:this.featureSwitchService,visualAuthoring:e.visualAuthoring},e.visualContainer,e.objectDefinitions,t.displayName,e.visualStyle,r)];case 1:return n=u.sent(),s=n.isApplied,t.slices.push({name:r.propertyId.propertyName,displayName:(o=n.toggleButton).displayName,description:o.description,type:{bool:!0},selector:r.selector,value:o.value,show:!0,placeholder:o.description,isValid:!0,isDisabled:!1,save:function(d,v,h,f,m,g,y){return o.saveCallback(d,v,h,m,g,y)},suppressUndoRedoRegister:!0}),s&&t.slices.push({name:"dialogLauncher",displayName:s.displayName,type:void 0,value:s.value,show:!0,placeholder:s.placeholder,isValid:!0,isDisabled:!1,save:void 0}),[2]}})})},a.prototype.getConditionalFormattingSliceProperties=function(e,t,r,i,n,o){var s=this;b.fF.assertValue(e,"getConditionalFormattingSliceProperties: services"),b.fF.assertValue(o,"getConditionalFormattingSliceProperties: repetitionMetadata");var l=o.selector;b.fF.assertValue(l,"getConditionalFormattingSliceProperties: selector"),b.fF.assertValue(l.metadata,"getConditionalFormattingSliceProperties: selector.metadata"),b.fF.assertValue(o.propertyId,"getConditionalFormattingSliceProperties: propertyId");var u=o.propertyDescriptor;b.fF.assertValue(o.propertyDescriptor,"getConditionalFormattingSliceProperties: propertyDescriptor");var c=e.conceptualSchemaProxy,d=e.dataSourcesService;b.fF.assertValue(c,"getConditionalFormattingSliceProperties: conceptualSchemaProxy"),b.fF.assertValue(d,"getConditionalFormattingSliceProperties: dataSourcesService");var v=t&&t.config&&t.config.singleVisual&&t.config.singleVisual.query;b.fF.assertValue(v,"getConditionalFormattingSliceProperties: non-query Visual");var h=v.defn.select().withName(l.metadata);if(h){var f,V,P,E,m=e.featureSwitchService.featureSwitches,g=u.type,y=g.fill,D=g.icon,T=u.type.misc,q=m?.conditionalTablixWebURL,F=q&&!!T&&T.webUrl,N=g.dataBars&&m?.dataBarsUpdate;if(y||D||F||N){var O=(0,yi.OT)(r,o);f=void 0!==O,P=function(){return(0,p.__awaiter)(s,void 0,void 0,function(){var B,x,j,R;return(0,p.__generator)(this,function(k){switch(k.label){case 0:return[4,e.conditionalFormattingDialogLauncherFactory()];case 1:return B=k.sent(),[4,this.showConditionalFormattingDialog(t,B,i,h.expr,o,O,n)];case 2:return(x=k.sent())&&(j=(0,$r.PU)(x.propertyDefinition,o.propertyDescriptor,!1),R=(0,$r.L1)(x.selector),e.visualAuthoring.setPropertyDefinition(t,o.propertyId,o.selector,j,R)),[2]}})})},V=function(B,x,j){return(0,p.__awaiter)(s,void 0,void 0,function(){var R,k,re,ne,J,se;return(0,p.__generator)(this,function(we){switch(we.label){case 0:return(0,Z.Vz)(j)?(R=e.featureSwitchService.featureSwitches.useModernFormatPane,k=x.value,re=d.get(),[4,c.get(re)]):[2];case 1:return ne=we.sent(),J=h.expr.getMetadata(ne),se=J&&1===J.kind&&J.type.numeric,N?(this.toggleDataBars(j,x.value,o,e),[2]):(!1===k||(y||D)&&se?this.toggleConditionalFormatting(j,k,o,e.visualAuthoring):P().then(function(){void 0===(0,yi.OT)(r,o)&&!R&&(x.value=!1)}),[2])}})})}}else{if(!g.dataBars)return void b.fF.assertFail("addConditionalFormattingSlices: Unexpected property type ("+JSON.stringify(g)+")");f=(0,da.dw)(r,o),V=function(B,x,j){(0,Z.Vz)(j)&&s.toggleDataBars(j,x.value,o,e)},P=function(){return(0,p.__awaiter)(s,void 0,void 0,function(){var B,x,j;return(0,p.__generator)(this,function(R){switch(R.label){case 0:return B=d.get(),[4,c.get(B)];case 1:return x=R.sent(),[4,e.dataBarsDialogLauncherFactory()];case 2:return j=R.sent(),this.showDataBarsDialog(n,j,i,t,o,h.expr,x),[2]}})})}}return E={toggleButton:{displayName:(0,Pe.Gf)(u.displayName,this.localizationService),description:(0,Pe.Gf)(u.description,this.localizationService),placeholder:(0,Pe.Gf)(u.placeHolderText,this.localizationService),value:!!f,saveCallback:V}},f&&(E.isApplied={displayName:(0,Pe.Gf)((0,De.V)("PropertyPane_ConditionalFormatting_DialogLauncherSliceTitle"),this.localizationService),placeholder:(0,Pe.Gf)(u.placeHolderText,this.localizationService),value:P}),E}},a.prototype.addDialogLauncherToSlice=function(e,t,r,i,n,o,s,l,u){var c=this;l.linkButtonAction=function(){return(0,p.__awaiter)(c,void 0,void 0,function(){var h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,t()];case 1:return h=f.sent(),[4,this.showConditionalFormattingDialogForSliceAndSave(e,l,h,r,n,o,s.displayName,l.name,i,u)];case 2:return f.sent(),[2]}})})},l.linkButtonDisplayName=(0,Pe.Gf)((0,De.V)("PropertyPane_ConditionalFormatting_DialogLauncherSliceTitle"),this.localizationService)},a.prototype.toggleConditionalFormatting=function(e,t,r,i){b.fF.assertValue(e,"toggleConditionalFormatting: visualContainer"),b.fF.assertValue(r,"toggleConditionalFormatting: repetition"),b.fF.assertValue(r.selector,"toggleConditionalFormatting: repetition.selector"),b.fF.assertValue(r.selector.metadata,"toggleConditionalFormatting: repetition.selector.metadata");var n=r.propertyDescriptor.type,o=r.propertyDescriptor.type.misc;b.fF.assertValue(n,"toggleConditionalFormatting - propertyType");var l,s=(0,Ce.xA)(r.selector.metadata);n.fill?l=(0,va.vX)(s):n.icon?l=(0,va.XB)(s):o&&o.webUrl?l=(0,Ce.IF)():b.fF.assertFail("Attempt to toggle Conditional Formatting for an unsupported type: "+JSON.stringify(n)),t?i.setPropertyDefinition(e,r.propertyId,r.selector,l):i.removePropertyDefinition(e,r.propertyId,r.selector)},a.prototype.showConditionalFormattingDialogForSliceAndSave=function(e,t,r,i,n,o,s,l,u,c){return(0,p.__awaiter)(this,void 0,void 0,function(){var d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return[4,this.getConditionalFormattingDialogResult(r,i,n,o,s,l,u,c)];case 1:return(d=v.sent())?(e.undoRedo.register("Save conditional formatting",function(){t.dynamicExpressionSupport&&(t.dynamicExpressionSupport.isSet=!0),t.value=(0,$r.PU)(d.propertyDefinition,d.repetition.propertyDescriptor,!1),t.save(d.repetition.propertyId.objectName,t,i,e),e.visualAuthoring.raiseVisualContainerChanged(i)}),[2]):[2]}})})},a.prototype.getConditionalFormattingDialogResult=function(e,t,r,i,n,o,s,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,v,h,f,m,g,y;return(0,p.__generator)(this,function(D){switch(D.label){case 0:return u=s.propertyId?s:{selector:(y=s).selector,propertyDescriptor:i,propertyId:{objectName:y.objectName,propertyName:o}},b.fF.assert(function(){return!u.allowOverrideSubtotalMatching},"Conditional formatting dialog shwon from Slices does not support customizing Total matching"),f=t&&t.config.singleVisual.query,(v=u.selector)&&v.metadata?(m=f.defn.select().withName(v.metadata),h=m?m.expr:f.defn.select()[0].expr):f&&!_.isEmpty(f.defn.select())&&(h=f.defn.select()[0].expr),[4,this.showConditionalFormattingDialog(t,e,n,h,u,r,l)];case 1:return(g=D.sent())?[2,(0,p.__assign)({repetition:u},g)]:[2]}})})},a.prototype.showConditionalFormattingDialog=function(e,t,r,i,n,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(l){return b.fF.assertValue(e,"showConditionalFormattingDialog: visualContainer"),b.fF.assertValue(t,"showConditionalFormattingDialog: dialogLauncher"),b.fF.assertValue(n,"repetition"),[2,t.show(e,r,i,n,o,s)]})})},a.prototype.toggleDataBars=function(e,t,r,i){b.fF.assertValue(e,"toggleDataBars: visualContainer"),b.fF.assertValue(r,"toggleDataBars: repetition"),b.fF.assertValue(r.propertyId,"toggleDataBars: propertyId"),b.fF.assertValue(r.selector,"toggleDataBars: selector"),b.fF.assertValue(r.selector.metadata,"toggleDataBars: selector.metadata"),b.fF.assertValue(i,"toggleDataBars: services"),b.fF.assertValue(i.visualAuthoring,"toggleDataBars: services.visualAuthoring");var n=i.visualAuthoring;if(t){var o=(0,da.uz)();n.addDataBars(e,r,o)}else n.removeDataBars(e,r)},a.prototype.showDataBarsDialog=function(e,t,r,i,n,o,s){b.fF.assertValue(t,"showDataBarsDialog: dialogLauncher");var l=o.getMetadata(s).type;t.show(i,r,n,e.colorPalette,l,!0)},a.prototype.updateDynamicExpressionSupportForSlice=function(e,t,r,i,n,o,s,l,u,c,d){var h,f,v=this;b.fF.assertValue(e,"generateDynamicExpressionSupportForSlice() missing instance");var m=3===(null===(h=e.propertyInstanceKind)||void 0===h?void 0:h[t]);if(b.fF.assert(function(){return m},"only to be called if slice needs dynamicExpressionSupport"),m){var g=_.clone(i);g.type=r;var y=null===(f=u.visualContainer)||void 0===f?void 0:f.config.singleVisual.query,D=!1,T=(0,ve.NA)(n,{objectName:e.objectName,propertyName:t},e.selector);if(T&&(0,Si.oA)(T,e.selector,y?y.defn.select():(0,st.bv)()).length){D=!0;var F=qe.BT(l,o.selector,t);F&&(o.isValid=!1,o.warningMessage=qe.qb(F,s,!1))}var N=(0,H.Ue)();u.themeService&&u.explorationNavigation&&(N=u.themeService.getVisualStyle(u.explorationNavigation.getCurrentExploration().themeCollection)),o.dynamicExpressionSupport={isSet:D,instance:e,propertyDescriptor:g,objectDisplayName:c,edit:function(){return(0,p.__awaiter)(v,void 0,void 0,function(){return(0,p.__generator)(this,function(P){switch(P.label){case 0:return u.conditionalFormattingDialogLauncher?[4,this.showConditionalFormattingDialogForSliceAndSave(u,o,u.conditionalFormattingDialogLauncher,u.visualContainer,T,g,d??c,o.name,e,N)]:[2];case 1:return P.sent(),[2]}})})}}}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(et.o))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}),a}(),Sr=C(28894),Yr=C(59897);function Bn(a){if((0,Yr.Gl)(a.type))return(0,Yr.AG)(a.type.fill.solid.color)}function ct(a,e){return{objectName:e,propertyName:a.name,selector:a.selector,propertyTypes:a.type,instanceKind:a.dynamicExpressionSupport?3:void 0,altConstantValueSelector:a.altConstantValueSelector}}function bi(a,e){var t,r,i,n,o,s,l,u,c,d,v,h,f,m,g;if(a){var y=function(a){var e=qe.TW(a);switch(e){case"alignment":return"AlignmentGroup";case"fill":return"ColorPicker";case"fontPicker":return"FontPicker";case"image":return"ImageUpload";case"numeric":case"numericSelection":case"numericUnitSelection":return"NumUpDown";case"selection":case"propertyPaneSelection":return"Dropdown";case"slider":return"Slider";case"bool":return"ToggleSwitch";case"geoJson":return"ShapeMapSelector";case"gradientBar":return"GradientBar";case"duration":return"DurationPicker";case"dateTime":return"DatePicker";case"text":return"TextInput";case"textarea":return"TextArea";case"readOnlyText":return"ReadOnlyText";case"linkButton":return"Link";case"flagsSelection":return"FlagsSelection";default:b.fF.assertNever(e)}}(a),D={displayName:a.displayName,description:a.description,uid:e+"-"+a.name};switch(a.showLinkButtonOnly&&(y="Link",D=(0,p.__assign)((0,p.__assign)({},D),{displayName:a.linkButtonDisplayName})),y){case"ColorPicker":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"ColorPicker",properties:{descriptor:ct(a,e),value:a.value,isNoFillItemSupported:Bn(a)}}});case"Dropdown":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"Dropdown",properties:{descriptor:ct(a,e),items:a.selectionOptions,value:null!==(t=_.find(a.selectionOptions,function(O){return O.value===a.value}))&&void 0!==t?t:a.selectionOptions[0]}}});case"DurationPicker":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"DurationPicker",properties:{descriptor:ct(a,e),value:a.value,validators:a.validators}}});case"GradientBar":return(0,p.__assign)((0,p.__assign)({},D),{suppressDisplayName:!0,control:{type:"GradientBar",properties:{descriptor:ct(a,e),value:a.value}}});case"Slider":case"NumUpDown":var T=null!==(i=null===(r=a.numericValueOptions)||void 0===r?void 0:r.minValue)&&void 0!==i?i:null===(n=a.validators)||void 0===n?void 0:n.min,q=null!==(s=null===(o=a.numericValueOptions)||void 0===o?void 0:o.maxValue)&&void 0!==s?s:null===(l=a.validators)||void 0===l?void 0:l.max;return b.fF.assert(function(){return _.isUndefined(T)||_.isNumber(T)},"minValue must be a number"),b.fF.assert(function(){return _.isUndefined(q)||_.isNumber(q)},"maxValue must be a number"),(0,p.__assign)((0,p.__assign)({},D),{control:{type:y,properties:{descriptor:ct(a,e),value:a.value,options:{unitSymbol:null===(u=a.numericValueOptions)||void 0===u?void 0:u.unitSymbol,minValue:{type:0,value:T},maxValue:{type:1,value:q}},placeholderText:a.placeholder}}});case"TextArea":case"TextInput":var F={};return!(null===(c=a.validators)||void 0===c)&&c.required&&(F.required={type:2}),!(null===(d=a.validators)||void 0===d)&&d.pattern&&(F.pattern={type:3,regex:a.validators.pattern}),!(null===(v=a.validators)||void 0===v)&&v.dashArray&&(F.dashArray={type:4}),!(null===(h=a.validators)||void 0===h)&&h.maxLength&&(F.maxLength={type:5,value:a.validators.maxLength}),(0,p.__assign)((0,p.__assign)({},D),{control:{type:y,properties:{descriptor:ct(a,e),value:a.value,placeholder:null!==(f=a.placeholder)&&void 0!==f?f:"",validators:F}}});case"ToggleSwitch":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"ToggleSwitch",properties:{descriptor:ct(a,e),value:a.value}}});case"AlignmentGroup":var N=void 0;switch(a.name){default:b.fF.assertFail('Unexpected alignment group name "'.concat(a.name,'"'));case"horizontalAlignment":N="horizontalAlignment";break;case"verticalAlignment":N="verticalAlignment"}return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"AlignmentGroup",properties:{descriptor:ct(a,e),mode:N,value:a.value}}});case"ImageUpload":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"ImageUpload",properties:{descriptor:ct(a,e),value:a.value}}});case"ShapeMapSelector":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"ShapeMapSelector",properties:{descriptor:ct(a,e),value:{type:a.value.type,name:a.value.name,content:a.value.content}}}});case"DatePicker":var V=null===(m=a.validators)||void 0===m?void 0:m.min,P=null===(g=a.validators)||void 0===g?void 0:g.max;return b.fF.assert(function(){return _.isUndefined(V)||_.isDate(V)},"minValue must be a Date"),b.fF.assert(function(){return _.isUndefined(P)||_.isDate(P)},"maxValue must be a Date"),(0,p.__assign)((0,p.__assign)({},D),{control:{type:"DatePicker",properties:{descriptor:ct(a,e),value:a.value,validators:{min:{type:0,value:V},max:{type:1,value:P}},placeholder:a.placeholder}}});case"FontPicker":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"FontPicker",properties:{descriptor:ct(a,e),value:a.value}}});case"ReadOnlyText":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"ReadOnlyText",properties:{descriptor:ct(a,e),value:a.value}}});case"Link":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"Link",properties:{descriptor:ct(a,e),value:a.linkButtonAction}},suppressDisplayName:a.showLinkButtonOnly});case"FlagsSelection":return(0,p.__assign)((0,p.__assign)({},D),{control:{type:"FlagsSelection",properties:{descriptor:ct(a,e),items:a.selectionOptions,value:a.value}}});default:b.fF.assertNever(y)}}}var Ie=C(40474),ha=C(82834);function Vr(a,e,t,r){if(b.fF.assertValue(a,"formatPainter.copyFormatObjects - sourceDescriptors should exist"),b.fF.assertValue(e,"formatPainter.copyFormatObjects - destinationDescriptors should exist"),b.fF.assertAnyValue(t,"formatPainter.copyFormatObjects - sourceObjects can be undefined"),b.fF.assertAnyValue(r,"formatPainter.copyFormatObjects - destinationObjects can be undefined"),t===r)return r;for(var i in r=r||{},a){var n=a[i],o=e[i];if(o&&!n.suppressFormatPainterCopy&&!o.suppressFormatPainterCopy){var s=t&&t[i],l=r&&r[i];for(var u in n.properties){var c=n.properties[u],d=o.properties[u];if(d&&!c.suppressFormatPainterCopy&&!d.suppressFormatPainterCopy&&_.isEqual(c.type,d.type)){if(l)for(var v=0,h=l;v<h.length;v++)(0,ha.Ow)(f=h[v],u);if(s)for(var m=0,g=s;m<g.length;m++){var f;(f=g[m]).properties[u]&&((0,ve.zx)(r,i,f.selector).properties[u]=f.properties[u])}}}}}return(0,ve.u4)(r)}var _r=C(52083),En=C(48066),ya=C(52967),Xr=C(18231);function Zr(a,e,t,r,i){var n,o,s,l,u,c;if(e.name!==U.tV)if(e.name!==U.Kp)if((0,ha.e4)(e.name)){var q,T=e.type;q=(0,ve.e4)(e.value)?e.value:T.image?function(a,e,t,r,i,n){if(!a||_.isEmpty(a.name))return{name:(0,Ce.fL)(""),url:(0,Ce.fL)("")};var o,s=!0;if(a.scaling){var l=(0,ve.NA)(i,{objectName:e,propertyName:t},r);s=!l||(0,ft.fS)(l.name,(0,Ce.fL)(""))||(0,ft.fS)(l.scaling,(0,Ce.fL)(a.scaling))}if(s&&n)o=n.add(a.name,1,Xr.Ut.Image,{content:a.url});else{var u=(0,ve.NA)(i,{objectName:e,propertyName:t},r);u&&(o=u.url)}var c={name:(0,Ce.fL)(a.name),url:o};return a.scaling&&(c.scaling=(0,Ce.fL)(a.scaling)),c}(e.value,a,e.name,e.selector,t,r.resourceRegistration):T.geoJson?function(a,e){if(a){var t;if(a.type===ya.c1)e.add(a.name,2,Xr.Ut.ShapeMap),t=(0,Ce.nF)(Xr.IG,2,a.name);else if(a.type===ya.BD&&a.content){var r=(0,En.wo)(a.content);t=e.add(a.name,1,Xr.Ut.ShapeMap,{content:r})}else t=a.content?(0,Ce.fL)(a.content):(0,Ce.IF)();return{name:(0,Ce.fL)(a.name),type:(0,Ce.fL)(a.type),content:t}}}(e.value,r.resourceRegistration):T.filter&&null===e.value?null:(0,ve.Lo)(e.value,T),!gt.Ge.fromDescriptor(e.type).text&&""===q&&(q=null);var N=e.selector;void 0!==e.altConstantValueSelector&&(null==e.value?i||(N=e.altConstantValueSelector):(0,Si.oA)(q,N,(0,st.bv)()).length?(0,ve.E2)(t,a,e.altConstantValueSelector,e.name):N=e.altConstantValueSelector),function(a,e,t,r,i){if(null!=a){if(null!=r?.order){var n=(0,ve.GQ)(i,e,r,{skipOrder:!0});if(n.length){b.fF.assert(function(){return 1===n.length},"expected one match when updating order");var o=_.first(n).selector;o.order!==r.order&&((0,ve.xl)(i,e,o,r),(0,ve.dM)(i,{objectName:e,propertyName:t},r))}}(function(a,e,t,r){a===U.De&&e===U.di&&((0,ve.zx)(t,a,null).properties[U.Ll]=r)})(e,t,i,a),(0,ve.zx)(i,e,r).properties[t]=a}else(0,ve.E2)(i,e,r,t)}(q,a,e.name,N,t)}else b.fF.assertFail("Invalid property name");else for(var d=t[a],v=null!==(l=null===(s=r.explorationNavigation)||void 0===s?void 0:s.getAllSections())&&void 0!==l?l:[],h=null===(u=r.explorationNavigation)||void 0===u?void 0:u.getCurrentSection(),f=Ie.C7,m=0,g=v;m<g.length;m++){var y=g[m];if(y!==h){var D=y.objects=null!==(c=y.objects)&&void 0!==c?c:{};d?Vr(((n={})[a]=f[a],n),f,((o={})[a]=d,o),D):delete D[a]}}else delete t[a]}var Di=function(e,t,r,i,n,o,s){if((0,Z.Vz)(r)){var l=r.config.singleVisual.visualType;if(i.telemetryService&&function(a,e,t,r){var i,n,o,s,l,u,c,d,v,h=e.name;if(a===U.jA&&h===U.di&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t}),a===U.LG&&h===U.di&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t}),a===U.hz&&h===U.i$&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t}),a===U.$l&&h===U.ns&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t}),a===U.Rz&&h===U.Il){var f=null===(o=null===(n=null===(i=e.value)||void 0===i?void 0:i.solid)||void 0===n?void 0:n.color)||void 0===o?void 0:o.rule;_.isEmpty(f)||r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t})}a===U.jA&&h===U.Il&&(f=null===(u=null===(l=null===(s=e.value)||void 0===s?void 0:s.solid)||void 0===l?void 0:l.color)||void 0===u?void 0:u.rule,_.isEmpty(f)||r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t})),a===U.e4&&h===U.Il&&(f=null===(v=null===(d=null===(c=e.value)||void 0===c?void 0:c.solid)||void 0===d?void 0:d.color)||void 0===v?void 0:v.rule,_.isEmpty(f)||r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t})),(a===U.Rz||a===U.ve)&&h===U.xh&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,newValue:e.value,visualType:t}),(a===U.Rz||a===U.ve)&&h===U.es&&r.logEvent(Ve.Lo,{objectName:a,propertyName:h,visualType:t})}(e,t,l,i.telemetryService),e===U.ph)!function(a,e){var t=e.config.singleVisual.objects;t||(e.config.singleVisual.objects=t={}),(0,_r._8)(a.name,a.value,t)}(t,r);else{var u=r.config.singleVisual.objects;if(u||(r.config.singleVisual.objects=u={}),s){var c=i.visualPlugin&&i.visualPlugin.capabilities(l);if(c&&c.supportsSynchronizingFilterState){var d=c.objects[e];if(d){var v=d.properties[t.name];if(v&&v.filterState){var h=i.visualSync;h&&h.syncFilterState(r)}}}}Zr(e,t,u,i,o),r.config.singleVisual.autoSelectVisualType=void 0}}},Qn=C(35598),Sa=C(21728),Jr=C(55133),$n=C(1521),Yn=C(29324),Xn=C(96915),qi=C(17966),Xt=C(39503),Fi=C(17328),ei=C(84281),_a=C(4877),Pr=C(67660),Ir=C(72262),xr=C(69866),Zn=[me.SliceNameAxisStart,me.SliceNameAxisEnd,me.SliceNameStart,me.SliceNameEnd,me.SliceNameSecStart,me.SliceNameSecEnd],Ni=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.conditionalFormattingUtilsService=r,this.dataSources=i,this.explorationNavigation=n,this.featureSwitchService=o,this.formFactor=s,this.itemPicker=l,this.lazyScoped=u,this.localizationService=c,this.runningVisuals=d,this.selectionService=v,this.telemetryService=h,this.themeService=f,this.undoRedo=m,this.visualAuthoring=g,this.visualPlugin=y,this.visualStylePresetService=D,this.hasServicesLoaded=this.loadServices()}return a.prototype.loadServices=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return this.conditionalFormattingDialogLauncher?[3,2]:(e=this,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:e.conditionalFormattingDialogLauncher=r.sent(),r.label=2;case 2:return this.dataBarsDialogLauncher?[3,4]:(t=this,[4,this.lazyScoped.get("dataBarsDialogLauncherService")]);case 3:t.dataBarsDialogLauncher=r.sent(),r.label=4;case 4:return[2]}})})},a.prototype.getFormattingModel=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,p.__generator)(this,function(r){return[2,this.hasServicesLoaded.then(function(){return(0,p.__awaiter)(t,void 0,void 0,function(){var i,n;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return[4,this.getPropertyPaneViewModel(e)];case 1:return i=o.sent(),n={cards:[]},e&&i&&(n.cards=this.createCards(i,e.config.singleVisual.visualType)),[2,n]}})})})]})})},a.prototype.convertLegacyToModernCards=function(e,t){var r=this;return e.reduce(function(i,n){var o,s;if(n.name===U.T9)s=r.getConditionalFormattingCard();else{var l=r.createNormalGroup(n);s={displayName:n.displayName,uid:n.id,description:n.description,disabled:!1,groups:0!==l.slices.length||l.container?[l]:[],topLevelToggle:r.getTopLevelToggle(n),revertToDefaultDescriptors:null!==(o=n.customRevertToDefaultDescriptors)&&void 0!==o?o:r.getRevertToDefaultDescriptor(n.name,t),analyticsPane:n.analyticsPane}}return s&&i.push(s),i},[])},a.prototype.createCards=function(e,t){var r=this.visualPlugin.capabilities(t).objects;return this.convertLegacyToModernCards(e.cards,r)},a.prototype.getConditionalFormattingCard=function(){var e=this,t=Sa.UP.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);if((0,Z.Vz)(t)){var r=this.runningVisuals.getVisual(t);if(r&&r.getAdapter()){var i=r.getAdapter(),n=i.enumerateObjectRepetition&&i.enumerateObjectRepetition();if(!n)return;var u=this.visualPlugin.capabilities(t.config.singleVisual.visualType).objects;return(0,Yn.Z)(n,function(v){return e.localizationService.get(v)},u,"FieldWell_ConditionalFormatting","")}}},a.prototype.getRevertToDefaultDescriptor=function(e,t){var r,i=null===(r=t[e])||void 0===r?void 0:r.properties;if(i)return Object.keys(i).map(function(n){return{objectName:e,propertyName:n}})},a.prototype.getTopLevelToggle=function(e){var t=e?bi(e.mainShow,e.name):void 0;return t&&(t.displayName=void 0,t.description=void 0,t.suppressDisplayName=!0),t},a.prototype.createNormalGroup=function(e){for(var t,r={displayName:void 0,uid:e.id+"-group",slices:[],disabled:!1},i={},n=0,o=e.slices;n<o.length;n++){var s=o[n],l=bi(s,null!==(t=s.customObjectName)&&void 0!==t?t:e.name);void 0===i[s.name]?i[s.name]=0:(i[s.name]++,l.uid="".concat(l.uid,"-").concat(i[s.name])),l&&r.slices.push(l)}return r.container=e.containers?this.createContainers(e,r.uid):void 0,r},a.prototype.createContainers=function(e,t){var r=t+"-container";return{displayName:e.containersLabel,description:e.containersTooltip,containerItems:e.containers.map(function(n){return{displayName:n.displayName,slices:n.slices.reduce(function(o,s){var l,u=bi(s,null!==(l=s.customObjectName)&&void 0!==l?l:e.name);return u&&o.push(u),o},[]),disabled:n.isDisabled,uid:r+n.displayName}}),isEditable:e.containersEditable,uid:r}},a.prototype.getPropertyPaneViewModel=function(e,t,r,i,n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,F,V;return(0,p.__generator)(this,function(P){switch(P.label){case 0:return e?(s=this.formFactor.getCurrentLayout(),l={height:Jr.aW,width:Jr.Co},u=e.layouts.withId(s).position,c=(0,X.hP)(u,s,e.parentGroup),d={x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height)},v=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),h=1===s?l:this.explorationNavigation.getCurrentSection().size,(f=this.runningVisuals.getVisual(e))&&f.getAdapter()?(g=(m=e.config.singleVisual).visualType,y=f.getAdapter(),D=m.objects,(T=this.visualPlugin.capabilities(g))&&T.objects?(q=m.evaluatedObjects&&m.evaluatedObjects.title,F=function(a,e){if(e&&e.config&&e.config.singleVisual){var t=e.config.singleVisual,r=a.capabilities(e.config.singleVisual.visualType),i=(0,_r.Zn)(r.objects);if(i&&i.inputRole){var n=void 0;return null!=t&&null!=(n=t.query)&&null!=n.projections&&null!=n.projections[i.inputRole]&&(0,Qn.mx)(i.conditions,n.projections,(0,X.i1)(n))}return!1}}(this.visualPlugin,e),V={visual:y,dataBarsDialogLauncher:this.dataBarsDialogLauncher,conditionalFormattingDialogLauncher:this.conditionalFormattingDialogLauncher,capabilities:T,visualConfig:m,visualContainer:e,visualTitle:q,visualObjectDefns:D,visualContainerPosition:d,showGradientCard:F,selectedContainers:t,selectedVisualType:g,shouldIncludeObject:function(E){return!E||1===E},localizationService:this.localizationService,dataSourcesService:this.dataSources,visualAuthoring:this.visualAuthoring,visualStyle:v,runningVisual:this.runningVisuals.getVisual(e),sectionSize:h,canvasLayout:s,excludeObjectRepetition:r,disabledSliceTypes:n,excludeConditionalFormattingCard:i},f&&y===f.getAdapter()?[4,this.createViewModelForVisual(V)]:[3,2]):[3,2]):[3,2]):[3,3];case 1:o=P.sent(),P.label=2;case 2:return[3,4];case 3:o=this.createEmptyViewModel(),P.label=4;case 4:return[2,o]}})})},a.prototype.createViewModelForVisual=function(e){var t=this.createEmptyViewModel();return this.populatePaneForVisual(t,e)},a.prototype.createEmptyViewModel=function(){return{selectedVisualType:null,cards:(0,st.bv)()}},a.prototype.populatePaneForVisual=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return r=function(a){var e=this;return{dataBarsDialogLauncherFactory:function(){return(0,p.__awaiter)(e,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,a.dataBarsDialogLauncher]})})},conditionalFormattingDialogLauncherFactory:function(){return(0,p.__awaiter)(e,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,a.conditionalFormattingDialogLauncher]})})},objectDescriptors:a.capabilities.objects,objectDefinitions:a.visualObjectDefns,shouldIncludeObject:a.shouldIncludeObject,dataSourcesService:a.dataSourcesService,enumerateObjectInstances:function(i){return(0,p.__awaiter)(e,void 0,void 0,function(){var n,o;return(0,p.__generator)(this,function(s){return a.visual?(o={objectName:i},(n=a.visual).enumerateObjectInstancesAsync?[2,n.enumerateObjectInstancesAsync(o)]:n.enumerateObjectInstances?[2,n.enumerateObjectInstances(o)]:[2]):[2]})})},enumerateObjectRepetition:function(){if(a.visual&&a.visual.enumerateObjectRepetition)return a.visual.enumerateObjectRepetition()},showGradientCard:a.showGradientCard,selectedContainers:a.selectedContainers,save:Di,visualType:a.visualConfig.visualType,visualContainer:a.visualContainer,visualWarningCollection:a.runningVisual&&a.runningVisual.getWarnings(),localizationService:a.localizationService,visualStyle:a.visualStyle,cardIndexCounter:0,disabledSliceTypes:a.disabledSliceTypes,excludeConditionalFormattingCard:a.excludeConditionalFormattingCard}}(t),[4,this.populatePane(e,r)];case 1:return i.sent(),e.cards=(0,st.z8)(_.sortBy(e.cards,function(n){return n.index})),e.selectedVisualType=t.selectedVisualType,this.addValidation(e,t.sectionSize),[2,e]}})})},a.prototype.populatePane=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n=this;return(0,p.__generator)(this,function(o){for(i in b.fF.assertValue(e,"model"),b.fF.assertValue(t,"options"),b.fF.assertValue(t.objectDescriptors,"options.objectDescriptors"),e.selectedContainers=t.selectedContainers,r=[],t.objectDescriptors)r.push(this.populateCard(e,t,i,t.cardIndexCounter++));return[2,Promise.allSettled(r).then(function(){t.showGradientCard&&!e.cards.withName(U.ph)&&n.populateGradientCard(e,t.objectDefinitions,!1,t,t.cardIndexCounter++),t.enumerateObjectRepetition&&!t.excludeConditionalFormattingCard&&(n.conditionalFormattingUtilsService.populateConditionalFormattingCard(e,t),t.cardIndexCounter++);var s=e.cards.withName(U.LQ);s&&(s.index=-2);var l=e.cards.withName(U.H);return l&&(l.index=-1),e})]})})},a.prototype.populateCard=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return(n=t.objectDescriptors[r])?t.shouldIncludeObject&&!t.shouldIncludeObject(n.objectCategory)?[2]:[4,t.enumerateObjectInstances(r)]:[2];case 1:return o=c.sent(),!(s=nt.G.normalize(o))||_.isEmpty(s.instances)?(t.showGradientCard&&"dataPoint"===r&&this.populateGradientCard(e,t.objectDefinitions,!1,t,i),[2]):((l=e.cards.withName(r))||(u=!!(t.objectDefinitions&&t.objectDefinitions[r]&&t.objectDefinitions[r].length>0),l={name:r,id:qe.Yb(t.visualType,r),index:i,displayName:(0,Pe.Gf)(n.displayName,this.localizationService)||r,description:(0,Pe.Gf)(n.description,this.localizationService),slices:(0,st.bv)(),footer:[],mainShow:null,isDirty:u},e.cards.push(l)),[4,this.addSlices(l,s,n,t)]);case 2:return c.sent(),qe.ht(t,l),l.name!==U.LQ&&this.addFooterSlicesToCard(l,t),[2]}})})},a.prototype.addFooterSlicesToCard=function(e,t){var r=U.tV;if(!_.some(e.footer,function(o){return o.name===r})){if(e.name===U.Z0){var i={applyToAllPages:!0};e.footer.push({value:e.isDirty,name:U.Kp,displayName:"",type:i,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,U.Kp,i,t.disabledSliceTypes),save:t.save})}var n={revertToDefault:!0};e.footer.push({value:e.isDirty,name:r,displayName:"",type:n,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,r,n,t.disabledSliceTypes),save:t.save})}},a.prototype.getShowSliceValue=function(e,t,r){if(e.name===me.PlotAreaCardName&&r){var i=r.properties[me.ImageSliceName];if(i&&(t===me.ImageFitSliceName||t===me.TransparencySliceName))return null!=i.url}return!0},a.prototype.populateGradientCard=function(e,t,r,i,n){var o=(0,_r.Vn)(t);if(o){var s=this.createGradientCard(e,o,r,i,n);e.cards.push(s),this.addFooterSlicesToCard(s,i)}},a.prototype.addSlices=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:b.fF.assertValue(e,"propertyPaneCard"),b.fF.assertValue(t,"enumeration"),b.fF.assertValue(r,"objectDescriptor"),n=i.isDisabled,t.containerInfo&&!_.isEmpty(t.containers)&&(e.containersLabel=(0,Pe.Gf)(t.containerInfo.containersLabel,this.localizationService),e.containersTooltip=(0,Pe.Gf)(t.containerInfo.containersTooltip,this.localizationService)),o=0,s=t.instances,f.label=1;case 1:return o<s.length?(u=r.properties,c=(l=s[o]).properties,null==l.containerIdx?[3,3]:(d=nt.G.getContainerForInstance(t,l),v=qe.Yl(e.name,l.containerIdx),h={name:v,displayName:(0,Pe.Gf)(d.displayName,this.localizationService),value:v,selector:l.selector,containerIndex:l.containerIdx,isDisabled:!1,slices:(0,st.bv)()},e.containers||(e.containers=(0,st.bv)()),[4,this.createSlices(l,u,i,c,e,n,h.slices,h.displayName)])):[3,6];case 2:return f.sent(),e.containers.push(h),[3,5];case 3:return[4,this.createSlices(l,u,i,c,e,n,e.slices)];case 4:f.sent(),f.label=5;case 5:return o++,[3,1];case 6:return[2]}})})},a.prototype.createSlices=function(e,t,r,i,n,o,s,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,c,d,v,h,f,m,g,y;return(0,p.__generator)(this,function(T){switch(T.label){case 0:for(g in d=this.getPropertyWarning(c=(u=r.visualWarningCollection&&r.visualWarningCollection.visualObjectWarnings)&&u[n.name]||[]),v=function(F){var N,V,P,O,E,L,B,j,k,re,ne,we,$e,Ue,Le,St;return(0,p.__generator)(this,function(vt){switch(vt.label){case 0:return qe.Ke(N=t[F])?(V=e.selector?e.displayName:void 0,P=(0,Pe.Gf)(N.displayName,h.localizationService),O=(0,Pe.Gf)(N.description,h.localizationService),E=(0,Pe.Gf)(N.placeHolderText,h.localizationService),L=F===me.ImageSliceName||F===me.MapSliceName?"":V||P||F,B=gt.Ge.fromDescriptor(N.type),[4,qe.cn({propertyType:B,instance:e,propertyName:F,paneServices:{bookmarkService:h.bookmarkService,dataSourcesService:h.dataSources,explorationNavigation:h.explorationNavigation,localizationService:h.localizationService,visualStylePresetService:h.visualStylePresetService},visualType:r.visualType})]):[2,"continue"];case 1:return j=vt.sent(),k=h.getPropertyDescriptorType(N.type,e.propertyTypes&&e.propertyTypes[F]),re=h.getPropertyValue(i[F],j,k,F,r),"strictSingleSelect"===(ne={name:F,displayName:L,description:O,type:k,selector:e.selector,altConstantValueSelector:e.altConstantValueSelector,value:re,show:h.getShowSliceValue(n,F,e),placeholder:E,isValid:!0,isDisabled:o||h.isSliceDisabled(n,F,k,r.disabledSliceTypes),containerIndex:e.containerIdx,save:r.save,selectionOptions:j}).name&&h.shouldDisableStrictSelectionDueToMappedColumn(r.visualContainer,ne),e.propertyInstanceKind&&3===e.propertyInstanceKind[F]&&h.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(e,F,k,N,r.objectDefinitions,ne,r.localizationService,c,{featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation,visualContainer:r.visualContainer,conditionalFormattingDialogLauncher:h.conditionalFormattingDialogLauncher},n.displayName,ne.selector?l:void 0),(we=h.getNumericValueOptionsFromValidValues(e,ne)||qe.X_(ne))&&(ne.numericValueOptions=we),h.configureValidators(e,ne),F===U.di?(d&&(ne.warningMessage=qe.qb(d,r.localizationService,!0)),n.mainShow=ne):s.push(ne),(!!($e=(0,ve.NA)(r.objectDefinitions,{objectName:"dataPoint",propertyName:"fill"},{data:[(0,Xn.Ue)(1)]}))||h.featureSwitchService&&h.featureSwitchService.featureSwitches.cartesianConditionalFormatting)&&e.propertyInstanceKind&&e.propertyInstanceKind[F]&&(1&(Ue=e.propertyInstanceKind[F])||(ne.showLinkButtonOnly=!0),2===Ue&&r.conditionalFormattingDialogLauncherFactory&&(b.fF.assert(function(){return!(2===Ue&&void 0!==e.altConstantValueSelector)},"Rule-only property kind with alt selector is not supported."),Le={featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation},St=h.themeService.getVisualStyle(h.explorationNavigation.getCurrentExploration().themeCollection),h.conditionalFormattingUtilsService.addDialogLauncherToSlice(Le,r.conditionalFormattingDialogLauncherFactory,r.visualContainer,e,$e,N,n,ne,St))),[2]}})},h=this,m=[],f=i)m.push(g);y=0,T.label=1;case 1:return y<m.length?(g=m[y])in f?[5,v(g)]:[3,3]:[3,4];case 2:T.sent(),T.label=3;case 3:return y++,[3,1];case 4:return d&&!n.mainShow&&(n.mainShow=this.createWarningPlaceHolderSlice(qe.qb(d,r.localizationService,!0),e,r,o)),[2]}})})},a.prototype.configureValidators=function(e,t){var r,i=gt.Ge.fromDescriptor(t.type);i.numeric?(r=this.getVisualObjectValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.numberRange):i.duration&&(r=this.getDurationPickerValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.durationRange)},a.prototype.shouldDisableStrictSelectionDueToMappedColumn=function(e,t){var r,i,n,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return s=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(s)];case 1:return(l=v.sent())?(!(u=null===(o=null===(n=null===(i=null===(r=e?.config)||void 0===r?void 0:r.singleVisual)||void 0===i?void 0:i.query)||void 0===n?void 0:n.defn)||void 0===o?void 0:o.select())&&u?.length>1||(d=Pt.m.getConceptualParameterMetadata(u[0].expr,l),1===d?.kind&&!d?.supportsMultipleValues&&(t.isDisabled=!0)),[2]):[2]}})})},a.prototype.getVisualObjectValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.numberRange&&_.isNumber(i.numberRange.max)&&_.isNumber(i.numberRange.min))return i}},a.prototype.getDurationPickerValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.durationRange)return i}},a.prototype.getNumericValueOptionsFromValidValues=function(e,t){var r=gt.Ge.fromDescriptor(t.type);if(r.integer||r.formatting&&r.formatting.fontSize){var i=this.getVisualObjectValidationOptionsFromValidValues(e,t.name);if(i&&i.numberRange)return{minValue:i.numberRange.min,maxValue:i.numberRange.max,unitSymbol:i.unitSymbol||""}}},a.prototype.getPropertyDescriptorType=function(e,t){var r=gt.Ge.fromDescriptor(e);if(!r.variant)return e;b.fF.assertValue(t,"propertyTypes");for(var i=gt.Ge.fromDescriptor(t),n=0,o=r.variant;n<o.length;n++)if(i.isCompatibleFrom(o[n]))return t},a.prototype.getPropertyValue=function(e,t,r,i,n){if(null==e)return e;if(t)return qe.vw(t,e);if(!r.numeric||_.isFinite(parseFloat(e))){if(this.isFillProperty(r)){var o=e&&e.solid?e.solid.color:e;e={value:(0,$n.SW)(o&&o.toString())}}return r.formatting&&r.formatting.stylePreset&&(b.fF.assertValue(n.visualType,"propertyPaneViewModelFactory.getPropertyValue - visualType should exist to set a stylePreset"),e={visualType:n.visualType,stylePresetName:e}),e}},a.prototype.getPropertyWarning=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.warnings)for(var n=0,o=i.warnings;n<o.length;n++)return o[n]}},a.prototype.createWarningPlaceHolderSlice=function(e,t,r,i){var n="warningPlaceHolder";return{name:n,displayName:"",type:null,selector:t.selector,value:"",show:!0,placeholder:n,isValid:!0,isDisabled:i,containerIndex:t.containerIdx,save:r.save,warningMessage:e}},a.prototype.createGradientCard=function(e,t,r,i,n){var o=e.cards.withName(U.ph);o||(o={name:U.ph,id:qe.Yb(i.visualType,U.ph),index:n,displayName:(0,Pe.Gf)((0,De.V)("Visual_DataPoint"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_DataPointDescription"),this.localizationService),slices:(0,st.bv)(),footer:[],mainShow:null,isDirty:r});var s=this.itemPicker.getDataColors().getGradientColors(),l=(0,_r.Ym)(t),u="diverging",c={bool:!0};return o.slices.push({value:l.diverging,name:u,displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_Diverging"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_DivergingDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),u="gradientBar",c={none:!0},o.slices.push({value:(0,_r.Kj)(l,s),name:u,displayName:"gradientBar",type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.minColor||s.minColor.value},name:u="minColor",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MinColor"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MinColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:{value:l.midColor||s.midColor.value},name:u="midColor",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MidColor"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MidColorDescription"),this.localizationService),type:{fill:{solid:{color:!0}}},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.maxColor||s.maxColor.value},name:u="maxColor",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MaxColor"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MaxColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={numeric:!0},o.slices.push({value:l.minValue,name:u="minValue",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MinValue"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MinValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:l.midValue,name:u="midValue",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MidValue"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MidValueDescription"),this.localizationService),type:{numeric:!0},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={numeric:!0},o.slices.push({value:l.maxValue,name:u="maxValue",displayName:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MaxValue"),this.localizationService),description:(0,Pe.Gf)((0,De.V)("Visual_Gradient_MaxValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o},a.prototype.isFillProperty=function(e){return null!=e.fill},a.prototype.isSliceDisabled=function(e,t,r,i){return null!=e.mainShow&&!1===e.mainShow.value&&!this.isSliceAlwaysEnabled(t)||!!i?.some(function(n){return!!r[n]})},a.prototype.isSliceAlwaysEnabled=function(e){switch(e){case U.di:case U.b4:case U.tV:case me.SliceNameStart:case me.SliceNameEnd:case me.SliceNameInvertAxis:case me.SliceNameSecStart:case me.SliceNameSecEnd:case me.SliceNameSecInvertAxis:case U.V1:case U.jv:case U.Kp:return!0;default:return!1}},a.prototype.addValidation=function(e,t){for(var r=0,i=e.cards;r<i.length;r++){var n=i[r];switch(n.name){case U.rR:case U.$l:case U.mn:this.setAxisValidationLimitations(n);break;case U.LQ:this.setGeneralValidationLimitations(n,t);break;default:for(var o=0,s=n.slices;o<s.length;o++)this.setSliceValidation(s[o])}if(!_.isEmpty(n.containers))for(var u=0,c=n.containers;u<c.length;u++)for(var v=0,h=c[u].slices;v<h.length;v++)this.setSliceValidation(h[v])}return e},a.prototype.setSliceValidation=function(e){var t=gt.Ge.fromDescriptor(e.type);t.misc&&t.misc.webUrl&&(e.validators||(e.validators={}),e.validators.url=!0),(t.numeric||t.integer||t.dateTime)&&"indicatorPrecision"===e.name&&(e.validators={max:me.MaxPrecision})},a.prototype.setGeneralValidationLimitations=function(e,t){for(var r=0,i=e.slices;r<i.length;r++){var n=i[r],o=n.name;switch(n.validators={},o){case U.Lu:var s=e.slices.withName(U.X),l=parseFloat(s.value);n.validators.max=t.width-l,n.validators.min=me.MinContainerWidth,n.validators.integer=!0,n.validators.required=!0;break;case U.oU:var u=e.slices.withName(U.Y),c=parseFloat(u.value);n.validators.max=t.height-c,n.validators.min=me.MinContainerHeight,n.validators.integer=!0,n.validators.required=!0;break;case U.X:var d=e.slices.withName(U.Lu),v=parseFloat(d.value);n.validators.max=t.width-v,n.validators.min=0,n.validators.integer=!0,n.validators.required=!0;break;case U.Y:var h=e.slices.withName(U.oU),f=parseFloat(h.value);n.validators.max=t.height-f,n.validators.min=0,n.validators.integer=!0,n.validators.required=!0}}},a.prototype.setAxisValidationLimitations=function(e){for(var t=0,r=e.slices;t<r.length;t++){var i=r[t],n=i.name;if(_.includes(Zn,n)){var o=gt.Ge.fromDescriptor(i.type);i.validators={};for(var s=0,l=e.slices;s<l.length;s++){var u=l[s];if(n===me.SliceNameStart&&u.name===me.SliceNameEnd||n===me.SliceNameSecStart&&u.name===me.SliceNameSecEnd||n===me.SliceNameAxisStart&&u.name===me.SliceNameAxisEnd)if(o.dateTime)i.validators.max=u.value;else{var c=parseFloat(u.value);i.validators.max=_.isFinite(c)?c:void 0,i.validators.decimal=!0}else(n===me.SliceNameEnd&&u.name===me.SliceNameStart||n===me.SliceNameSecEnd&&u.name===me.SliceNameSecStart||n===me.SliceNameAxisEnd&&u.name===me.SliceNameAxisStart)&&(o.dateTime?i.validators.min=u.value:(c=parseFloat(u.value),i.validators.min=_.isFinite(c)?c:void 0,i.validators.decimal=!0))}}else this.setSliceValidation(i)}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(qi.F),w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(_i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(Fi.F),w.\u0275\u0275inject(_a.a),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Ir.z),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(Pr.f),w.\u0275\u0275inject(ei.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(xr.A))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Ti=function(){function a(e,t,r,i,n,o,s,l,u){this.conditionalFormattingUtilsService=e,this.featureSwitchService=t,this.lazyScoped=r,this.legacyVisualFormattingService=i,this.localizationService=n,this.referenceLineHelper=o,this.undoRedoService=s,this.visualAuthoring=l,this.visualPluginService=u}return a.prototype.getFormattingCards=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s=this;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return[4,this.buildAnalyticsCards(e,i,t,r)];case 1:return n=l.sent(),_.isEmpty(n)?[2]:(o=_.map(n,function(u,c){return s.convertToPropertyPaneCard(u,c)}),[2,this.legacyVisualFormattingService.convertLegacyToModernCards(o,i.objects)])}})})},a.prototype.getPropertyDisplayName=function(e,t){if(b.fF.assertValue(e,"propertyName must be defined"),b.fF.assertAnyValue(t,"propertyDescriptor is allowed to have any value"),t){var r=(0,De.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r}},a.prototype.getNonReferenceCardDisplayName=function(e,t,r){var n=1!==Vi(e)&&r>0,o=_.find(z,function(l){return l.objectName===e}),s=o?this.localizationService.get(o.displayNameBaseKey):this.getObjectDisplayName(e,t);return n?this.localizationService.format("NamePattern_Bracket",[s,r]):s},a.prototype.getObjectDisplayName=function(e,t){var r=(0,De.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r},a.prototype.getTargetAnalyticsObjects=function(e){var t={};for(var r in e.objects||{})2===e.objects[r].objectCategory&&!_.includes(["forecast","anomalyDetection"],r)&&(t[r]=e.objects[r]);return t},a.prototype.buildAnalyticsCards=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:if(n=this.getTargetAnalyticsObjects(t),_.isEmpty(n))return[2];for(u in o=[],l=[],s=n)l.push(u);c=0,f.label=1;case 1:return c<l.length?(u=l[c])in s?(d=u)!==ie?[3,3]:[4,this.buildReferenceLineCards(e,t,i,r)]:[3,5]:[3,6];case 2:return v=f.sent(),o.push.apply(o,v??[]),[3,5];case 3:return[4,this.buildNonReferenceLineCard(d,t.objects[d],e,i,r)];case 4:(h=f.sent())&&o.push(h),f.label=5;case 5:return c++,[3,1];case 6:return[2,o]}})})},a.prototype.buildReferenceLineCards=function(e,t,r,i){var n;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return(o=null===(n=t.objects)||void 0===n?void 0:n[ie])?[4,this.referenceLineHelper.getReferenceLineInstancesInfo(e,r,t)]:[2];case 1:if(s=g.sent(),_.isEmpty(s?.groupedInstances))return[2];l=s.validMeasures,u=[],c=0,d=s.groupedInstances,g.label=2;case 2:return c<d.length?[4,this.buildReferenceLineCard((v=d[c])[0],v[1],l,o,e,i)]:[3,5];case 3:m=g.sent(),u.push(m),g.label=4;case 4:return c++,[3,2];case 5:return[2,u]}})})},a.prototype.buildReferenceLineCard=function(e,t,r,i,n,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return b.fF.assert(function(){return!_.isEmpty(t)},"Expect the given typedLineInstances NOT to be empty"),b.fF.assert(function(){return!_.isEmpty(r)},"Expect the given validMeasures NOT to be empty"),b.fF.assertValue(i,"Expect the given objectDescriptor to be defined"),[4,this.buildAnalyticsCard(ie,i,{type:e,instances:t,validMeasures:r},n,o)];case 1:return s=l.sent(),b.fF.assertValue(s,"No undefined legacy reference line card should be created"),[2,s]}})})},a.prototype.buildNonReferenceLineCard=function(e,t,r,i,n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return[4,qt(i,e)];case 1:return o=l.sent(),s=nt.G.normalize(o),_.isEmpty(s?.instances)?[2]:[4,this.buildAnalyticsCard(e,t,{instances:s.instances},r,n)];case 2:return[2,l.sent()]}})})},a.prototype.buildAnalyticsCard=function(e,t,r,i,n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,N,V,P;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return _.isEmpty(r.instances)?[2]:(function(a){return a.hasOwnProperty("validMeasures")}(r)?(u=r.validMeasures,o=fi(l=r.type),c=this.localizationService.get(na[l]),d=_.size(_.filter(r.instances,function(E){return!E.isDefaultInstance})),s=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c):(o=e,d=_.size(_.filter(r.instances,function(E){return!!E.properties[G]})),s=this.getNonReferenceCardDisplayName(e,t,d)),v=t.properties,h={objectName:e,id:o,displayName:s,description:(0,De.G)(t.description,this.localizationService),instances:[],defaultInstance:null,maxInstances:Vi(e),supportsUserDefinedInstances:ro(e)},f=i.config.singleVisual,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:m=O.sent(),g={conditionalFormattingDialogLauncher:m,conditionalFormattingUtilsService:this.conditionalFormattingUtilsService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,objectDefinitions:f.objects,visualAuthoring:this.visualAuthoring,visualContainer:i,visualPlugin:this.visualPluginService,visualWarningCollection:n.getWarnings(),undoRedo:this.undoRedoService},y=function(L){var B,x,j,R;return(0,p.__generator)(this,function(k){switch(k.label){case 0:return B=void 0,x=void 0,ba(L)?(x=L.visualObjectInstance,j=L.isDefaultInstance,B={instance:L,validMeasures:u}):(j=!(x=L).properties[G],B=L),b.fF.assert(function(){return!j||!h.defaultInstance},'Each object should NOT have multiple instances with "show" property being false'),R=x.disabledReason,_.isEmpty(R)?[4,D.addInstanceToCard(h,B,l,j,e,v,g)]:(h.readOnly=!0,h.warningText=R,[2,{value:h}]);case 1:return k.sent(),[2]}})},D=this,T=0,q=r.instances,O.label=2;case 2:return T<q.length?[5,y(q[T])]:[3,5];case 3:if("object"==typeof(N=O.sent()))return[2,N.value];O.label=4;case 4:return T++,[3,2];case 5:return h.defaultInstance?[3,7]:(P=ba(V=r.instances[0])?{instance:V,validMeasures:u}:V,[4,this.addInstanceToCard(h,P,l,!0,e,v,g)]);case 6:O.sent(),O.label=7;case 7:return[2,h]}})})},a.prototype.addInstanceToCard=function(e,t,r,i,n,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,y,D,T,q;return(0,p.__generator)(this,function(F){switch(F.label){case 0:for(m in l=Ca(t)?t.instance.visualObjectInstance:t,c=i?null:l.selector,d=(u=l.properties).displayName,v={slices:[],displayName:_.isString(d)&&!_.isEmpty(d)?d:e.displayName,selector:c,type:r},Ca(t)&&this.buildReferenceLineSpecialSlices(e,v,t,i),f=[],h=u)f.push(m);g=0,F.label=1;case 1:return g<f.length?(m=f[g])in h?(D=u[y=m],function(a,e,t){var r=["displayName","type",G];return a===ie&&r.push("value"),!_.includes(r,e)&&qe.Ke(t)}(n,y,T=o[y])?[4,this.buildSlice(n,y,T,D,v.displayName,l,i,s)]:[3,3]):[3,3]:[3,4];case 2:q=F.sent(),v.slices.push(q),F.label=3;case 3:return g++,[3,1];case 4:return i?e.defaultInstance=v:e.instances.push(v),[2]}})})},a.prototype.buildSlice=function(e,t,r,i,n,o,s,l){var u,c,d;return(0,p.__awaiter)(this,void 0,void 0,function(){var v,h,f,m,g,D,T,q;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return v=this.getSliceDisplayName(t,r,o),h=this.getPropertyTypeDescriptor(t,r,o),[4,this.getSliceValue(t,r,i,o)];case 1:return q=F.sent(),f=q.value,m=q.selectionOptions,g={name:t,displayName:v,description:(0,De.G)(r.description,this.localizationService),type:h,selector:o.selector,value:f,show:!0,placeholder:(0,De.G)(r.placeHolderText,this.localizationService),isValid:!0,isDisabled:s,containerIndex:o.containerIdx,selectionOptions:m},h.fill&&(g.value={value:g.value}),3===(null===(u=o.propertyInstanceKind)||void 0===u?void 0:u[t])&&(D=(null===(d=null===(c=l.visualWarningCollection)||void 0===c?void 0:c.visualObjectWarnings)||void 0===d?void 0:d[e])||[],l.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(o,t,h,r,l.objectDefinitions,g,l.localizationService,D,l,n)),(T=qe.X_(g))&&(g.numericValueOptions=T),g.isPropertyTitleWidthStretch=qe.OR(g),function(a){a.name===oe.pw&&(a.validators={max:me.MaxPrecision})}(g),[2,g]}})})},a.prototype.buildReferenceLineSpecialSlices=function(e,t,r,i){if(!i){var n=r.instance,o={displayName:this.localizationService.get("Series"),name:"measure",customObjectName:fi(t.type),show:!0,isDisabled:i,isValid:!0,placeholder:this.localizationService.get("Visual_Reference_Line_Measure_Default"),selectionOptions:r.validMeasures,value:n.measureName,selector:n.visualObjectInstance.selector,type:{enumeration:(0,Yt.i)([])}};t.slices.push(o);var s=n.percentileValue;if(null!=s){var l={displayName:this.localizationService.get("Visual_Reference_Line_Percentile"),name:"percentile",customObjectName:fi(t.type),show:!0,isDisabled:!1,isValid:!0,placeholder:void 0,value:s,selector:n.visualObjectInstance.selector,type:{numeric:!0}};l.numericValueOptions=qe.X_(l),l.isPropertyTitleWidthStretch=qe.OR(l),t.slices.push(l)}}},a.prototype.getSliceDisplayName=function(e,t,r){var i=r.selector?r.displayName:void 0;return _.isEmpty(i)?this.getPropertyDisplayName(e,t):i},a.prototype.getSliceValue=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return n=r,[4,qe.cn({propertyType:gt.Ge.fromDescriptor(t.type),instance:i,propertyName:e})];case 1:return(o=l.sent())&&(n=qe.vw(o,r)),s=n,"color"!==e&&n?.solid&&t.type.fill&&(s=r.solid.color),[2,{value:s,selectionOptions:o}]}})})},a.prototype.getPropertyTypeDescriptor=function(e,t,r){var i,n=null===(i=r.propertyTypes)||void 0===i?void 0:i[e],o=qe.sH(t.type,n),s=t.type.variant;return s&&(o=(0,p.__assign)((0,p.__assign)({},o),{variant:s})),o},a.prototype.convertToPropertyPaneCard=function(e,t){var r={name:e.objectName,displayName:e.displayName,description:e.description,id:e.id,slices:(0,st.z8)([]),footer:[],mainShow:void 0,isDirty:!1,index:t,analyticsPane:!0,customRevertToDefaultDescriptors:[]},i=_.size(e.instances);if(1===e.maxInstances){var n=1===i?e.instances[0]:e.defaultInstance;b.fF.assertValue(n,"If maxInstances===1, one instance must be found to show the UI, be it a default instance or a real instance");var o=(0,st.z8)(n?.slices||[]);r.slices=o,r.mainShow={displayName:void 0,isDisabled:!!e.readOnly,isValid:!0,name:G,save:_.noop,show:!0,type:{bool:!0},value:n!==e.defaultInstance,placeholder:null},_.forEach(o,function(u){var c;r.customRevertToDefaultDescriptors.push({objectName:null!==(c=u.customObjectName)&&void 0!==c?c:e.objectName,propertyName:u.name})}),r.customRevertToDefaultDescriptors.push({objectName:e.objectName,propertyName:G})}else{var s=[];_.forEach(i>0?e.instances:[e.defaultInstance],function(u,c){var d={name:void 0,displayName:u===e.defaultInstance?void 0:u.displayName,value:void 0,isDisabled:u===e.defaultInstance,slices:(0,st.z8)(u.slices||[]),selector:u.selector,containerIndex:c};s.push(d),_.forEach(d.slices,function(v){var h;r.customRevertToDefaultDescriptors.push({objectName:null!==(h=v.customObjectName)&&void 0!==h?h:e.objectName,propertyName:v.name})})}),r.containersLabel=this.localizationService.get("Apply_Settings_To"),r.containersTooltip=null,r.containersEditable=!0,r.containers=(0,st.z8)(s),r.selectedContainer=_.first(r.containers)}return r},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(_i),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(Ni),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Kr),w.\u0275\u0275inject(ei.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function Vi(a){var e=_.find(z,function(t){return t.objectName===a});return e?e.maxInstances:1}function ro(a){var e=_.find(z,function(t){return t.objectName===a});return!!e&&e.supportsUserDefinedInstances}function ba(a){return a.hasOwnProperty("visualObjectInstance")}function Ca(a){return a.hasOwnProperty("validMeasures")}var oo=C(58702),wa=function(){function a(e,t,r,i,n,o,s,l){this.anomalyDetectionHelper=e,this.forecastHelper=t,this.legacyAnalyticsFormattingService=r,this.localizationService=i,this.referenceLineHelper=n,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return a.prototype.saveChangedSlicesToDefinition=function(e,t,r){return void 0===r&&(r=!1),(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return(0,Z.Vz)(t)?(i=e[0].groupDisplayName,_.isEmpty(i)?[3,2]:(n=e[0].objectName,b.fF.assert(function(){return e.every(function(u){return u.objectName===n})},"all the changes should have same object"),b.fF.assert(function(){return e.every(function(u){return u.groupDisplayName===i})},"all the changes should have same groupDisplayName"),[4,this.handleGroupSlicesSave(n,i,e,t)])):[2,!1];case 1:return[2,l.sent()];case 2:return b.fF.assert(function(){return 1===_.size(e)},"Expect saveObject to have 1 single change when it is not from a grouped save"),(o=e[0]).propertySlice.type.errorRange?[2,this.saveSliceExpression(o.objectName,o.propertySlice,t)]:[2,this.saveSliceValue(o.objectName,o.propertySlice,t,!!r)];case 3:return[2]}})})},a.prototype.saveSliceExpression=function(e,t,r){var i=t.value;b.fF.assert(function(){return void 0===i||i instanceof Ce.Il||(0,oo.hl)(i)},"Slice value is not a valid expression");var n={objectName:e,propertyName:t.name},o=t.selector;return void 0===i?this.visualAuthoringService.removePropertyDefinition(r,n,o,!0):this.visualAuthoringService.setPropertyDefinition(r,n,o,i,void 0,!0),!0},a.prototype.saveSliceValue=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,c,d,v,h=this;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.checkAddRemoveRenameInstance(e,t,r,i)];case 1:return f.sent()?[2,!0]:"editable-container-object-name"===e?[2,!1]:[4,this.referenceLineHelper.tryHandleReferenceLineSpecialSave(e,t,r)];case 2:return(s=f.sent()).isHandled?(n=s.persistChanges,o=s.newPropertyChanges):(n={merge:[],remove:[]},l={objectName:e,selector:t.selector,properties:{}},c=gt.Ge.fromDescriptor(u=t.type),d=t.value,!c.text&&""===d&&(d=null),null==d||d instanceof Ce.jz&&null==d.value?(l.properties[t.name]=d,n.remove.push(l)):(u.variant&&!(d instanceof Ce.Il)&&(d=(0,ve.Lo)(d,u)),l.properties[t.name]=d,n.merge.push(l))),(v=!(_.isEmpty(n?.merge)&&_.isEmpty(n?.replace)&&_.isEmpty(n?.remove)&&_.isEmpty(n?.removeObject)))&&this.visualAuthoringService.persistProperties(n,r,!0),o&&_.forEach(o.properties,function(m,g){h.visualAuthoringService.setPropertyDefinition(r,{objectName:o.objectName,propertyName:g},o.selector,m,void 0,!0)}),[2,v]}})})},a.prototype.handleGroupSlicesSave=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return e!==Oe.Po?[3,2]:[4,this.forecastHelper.saveGroupSlices(t,r,i)];case 1:case 3:return[2,n.sent()];case 2:return e!==Qe?[3,4]:[4,this.anomalyDetectionHelper.saveGroupSlices(t,r,i)];case 4:return[2,!1]}})})},a.prototype.checkAddRemoveRenameInstance=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.referenceLineHelper.checkAddRemoveRenameInstance(e,t,r)];case 1:return n.sent()||this.forecastHelper.checkAddRemoveInstance(e,t,r)||this.anomalyDetectionHelper.checkAddRemoveInstance(e,t,r)||this.checkAddRemoveNormalInstance(e,t,r,i)?[2,!0]:[2,!1]}})})},a.prototype.checkAddRemoveNormalInstance=function(e,t,r,i){if(i||z[e])return 1===(i?Vi(e):z[e].maxInstances)&&t.name===G&&(t.value?this.addNormalInstance(e,r,i):Se(e,t.selector,r,this.visualAuthoringService),!0)},a.prototype.addNormalInstance=function(e,t,r){var i;if(b.fF.assert(function(){return e!==ie&&e!==Oe.Po&&e!==Qe},"Expect this NOT be called for reference line or forecast"),r){var n=this.visualPluginService.capabilities(t.config.singleVisual.visualType),s=this.legacyAnalyticsFormattingService.getPropertyDisplayName(e,n.objects[e].properties.displayName);i=he(e,s,t,this.localizationService)}else{var l=_.find(z,function(u){return u.objectName===e}).displayNameBaseKey;i=ee(e,l,t,this.localizationService)}this.telemetryService.logEvent(Ve.Yu,{objectName:e}),this.visualAuthoringService.persistProperties(i,t,!0)},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(dr),w.\u0275\u0275inject(gr),w.\u0275\u0275inject(Ti),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Kr),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),xt=C(66609),Da=C(36998),Pi=function(){function a(e,t,r,i,n,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.featureSwitchService=r,this.lazyScoped=i,this.conditionalFormattingUtilService=n,this.explorationNavigation=o,this.themeService=s,this.visualAuthoring=l}return a.prototype.getDynamicExpressionSupportObjectForSlice=function(e){var t=this,r=e.containerSliceDisplayName,i=e.descriptor,n=e.objectDefinitions,o=e.objectDisplayName,s=e.propertyDescriptor,l=e.propertyTypeDescriptor,u=e.warning,c=e.canvasItem;if(!c||!(0,Z.Vz)(c))return b.fF.assertFail("visualContainer should exist"),{dynamicExpressionSupport:void 0,warningMessage:void 0};var f,d=i.objectName,v=i.propertyName,h=i.selector,g=_.clone(s);g.type=l;var D=c.config.singleVisual.query,T=!1,q=(0,ve.NA)(n,{objectName:d,propertyName:v},h);return q&&(0,Si.oA)(q,h,D?D.defn.select():(0,st.bv)()).length&&(T=!0,u&&(f=this.getDataBoundExprWarning(u,i))),{warningMessage:f,dynamicExpressionSupport:{isSet:T,showDialog:function(){return t.showConditionalFormattingDialogForSlice(c,q,g,r??o,v,i)}}}},a.prototype.getDataBoundExprWarning=function(e,t){if(e instanceof Da.L&&e.propertyId.propertyName===t.propertyName&&(!e.selector&&!t.selector||(0,ia.fS)(e.selector,t.selector)))return e},a.prototype.getConditionalFormattingSliceProperties=function(e,t,r){var i=this;if(r&&(0,Z.Vz)(r)){var n=r.config.singleVisual.objects,o=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),l=this.conditionalFormattingUtilService.getConditionalFormattingSliceProperties({conceptualSchemaProxy:this.conceptualSchemaProxy,conditionalFormattingDialogLauncherFactory:function(){return i.lazyScoped.get("conditionalFormattingDialogLauncherService")},dataBarsDialogLauncherFactory:function(){return i.lazyScoped.get("dataBarsDialogLauncherService")},dataSourcesService:this.dataSourcesService,featureSwitchService:this.featureSwitchService,visualAuthoring:this.visualAuthoring},r,n,e,o,t);if(l)return(0,p.__assign)((0,p.__assign)({},l),{toggleButton:(0,p.__assign)((0,p.__assign)({},l.toggleButton),{saveCallback:function(d){return i.saveConditionalFormattingControlProperties(d,l.toggleButton.saveCallback,[r])}})})}else b.fF.assertFail("visualContainer should exist")},a.prototype.saveConditionalFormattingControlProperties=function(e,t,r){b.fF.assert(function(){return 1===_.size(e.changes)},"Expect this NOT be called when there are multiple changes in the save object");for(var i=e.changes[0].objectName,n=e.changes[0].propertySlice,o=0,s=r;o<s.length;o++)t(i,n,s[o])},a.prototype.showConditionalFormattingDialogForSlice=function(e,t,r,i,n,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return s=this.explorationNavigation.getCurrentExploration(),l=this.themeService.getVisualStyle(s.themeCollection),[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")];case 1:return u=v.sent(),[4,this.conditionalFormattingUtilService.getConditionalFormattingDialogResult(u,e,t,r,i,n,o,l)];case 2:return!(c=v.sent())||_.isUndefined(c.propertyDefinition)?[2,{value:void 0,shouldSave:!1}]:[2,{value:(0,$r.PU)(c.propertyDefinition,c.repetition.propertyDescriptor,!1),shouldSave:!0}]}})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(_i),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(Pr.f),w.\u0275\u0275inject(ut.$8))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),qa=C(58938),Fa=function(){function a(){this._fieldPickerAllStaticSeriesValue=new Map}return a.prototype.cleanFieldPickerStaticSeries=function(e,t){if("FieldPicker"===e.control.type){var r=e.control.properties;if(!r.dataLabelPickerType)return;var n=r.dataLabelPickerType.dataLabelRole;!r.value&&2===r.dataLabelPickerType.seriesType&&t&&(0,Z.Vz)(t)&&this.clearAllStaticSeriesValue(n,t.name)}},a.prototype.updateFieldPickerControlValue=function(e,t,r,i){var s=(0,ve.NA)(r,{objectName:t.objectName,propertyName:t.propertyName},t.selector);e.splitValuesIntoInstances?this.splitFieldPickerPropsIntoInstances(t,r,e):e.unwrapExprOnGet&&this.wrapPropertyValueForFieldPicker(e,s),i&&(0,Z.Vz)(i)&&this.updateFieldPickerControlFallbackExpression(e,s,i),this.setFallbackExpressionAsDisplayedValue(e)},a.prototype.wrapPropertyValueForFieldPicker=function(e,t){e.value=t?{newExpr:{expr:t}}:void 0},a.prototype.splitFieldPickerPropsIntoInstances=function(e,t,r){var o=(0,ve.hz)(t,{objectName:e.objectName,propertyName:e.propertyName},e.selector);if(o){for(var s=_.sortBy(Object.keys(o),function(v){var h;return null===(h=o[v].selector)||void 0===h?void 0:h.order}),l=[],u=0,c=s;u<c.length;u++){var d=c[u];l.push({expr:o[d].value,metadata:d})}b.fF.assert(function(){return!!l.length},"expect at least one expr to add"),r.value={newExpr:l}}else r.value=void 0},a.prototype.updateFieldPickerControlFallbackExpression=function(e,t,r){if(e.dataLabelPickerType&&[2,3].includes(e.dataLabelPickerType.seriesType)){var n=r.name,o=e.dataLabelPickerType.seriesType,s=e.dataLabelPickerType.dataLabelRole;if(2===o)return void(e.value?this.setAllStaticSeriesValue(s,t,n):this.clearAllStaticSeriesValue(s,n));3===o&&(e.fallbackExpr=this.allStaticSeriesHasValueForRole(s,n)?this.getAllStaticSeriesValue(s,n):e.fallbackExpr)}},a.prototype.setFallbackExpressionAsDisplayedValue=function(e){var t;!e.value&&e.fallbackExpr?(e.value={newExpr:{expr:e.fallbackExpr}},e.allowClear=null!==(t=e.allowClear)&&void 0!==t&&t):e.fallbackExpr&&(e.allowClear=!0)},a.prototype.allStaticSeriesHasValueForRole=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.has(r)},a.prototype.getAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.get(r)},a.prototype.setAllStaticSeriesValue=function(e,t,r){var i=this.createFieldPickerSeriesValueKey(e,r);this._fieldPickerAllStaticSeriesValue.set(i,t)},a.prototype.clearAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);this._fieldPickerAllStaticSeriesValue.delete(r)},a.prototype.createFieldPickerSeriesValueKey=function(e,t){return"".concat(e,"-").concat(t)},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac=function(t){return new(t||a)}}),a}();function ti(a,e,t){return(0,p.__assign)((0,p.__assign)({},qe.qb(a,e,!!t)),{source:a})}var jr=function(){function a(e,t,r,i,n,o,s,l){this.bookmarkService=e,this.conditionalFormattingService=t,this.dialogService=r,this.explorationNavigationService=i,this.fieldPickerTransformationService=n,this.localizationService=o,this.visualAuthoringService=s,this.visualStylePresetService=l}return a.prototype.transformFormattingSlice=function(e){var r=e.objectDescriptors,i=e.visualType,o=e.dynamicExpressionSupportOptions,s=this.applyBasicTransformation(e.formattingSlice,e.visualObjects,r,o);return this.applyControlSpecificTransformation(s,r,i,o?.canvasItem)},a.prototype.applyBasicTransformation=function(e,t,r,i){if(!(0,S.IW)(e)){var o=ce.w7(e.control.properties.descriptor,r),s=e.displayName,l=e.description;!s&&!e.suppressDisplayName&&o&&(s=(0,De.G)(o.displayName,this.localizationService)),!l&&o&&o.description&&(l=(0,De.G)(o.description,this.localizationService));var u=void 0;o&&o.placeHolderText&&(u=(0,De.G)(o.placeHolderText,this.localizationService));var c=this.getDynamicExpressionSupportObjectsForSlice(e,i),d=c?.warningMessage,v=void 0;d&&(v=ti(d,this.localizationService));var h=(e=this.fillRuleOnlySliceValue(e,t,i?.canvasItem)).aliasNames;return c&&(h=(0,p.__spreadArray)((0,p.__spreadArray)([],h=h??[],!0),[this.localizationService.get("FieldWell_ConditionalFormatting")],!1)),(0,p.__assign)((0,p.__assign)({},e),{displayName:s,placeHolderText:u,description:l,conditionalFormattingWarning:v,conditionalFormattingObjects:c?c.dynamicExpressionSupport:void 0,aliasNames:h})}return e},a.prototype.fillRuleOnlySliceValue=function(e,t,r){if("ConditionalFormattingControl"===e.control.type||(0,S.IW)(e))return e;var i=e.control.properties.descriptor;if(2!==i.instanceKind)return e;b.fF.assert(function(){return void 0===e.control.properties.value},"A RuleOnly Slice shouldn't have a value in Formatting Model");var s=(0,ve.NA)(t,{objectName:i.objectName,propertyName:i.propertyName},i.selector);if(""===s?.value){if("FieldPicker"===e.control.type){var l=e.control.properties,u=l?.fallbackExpr;l.value=u?{newExpr:{expr:u}}:l.value,this.fieldPickerTransformationService.cleanFieldPickerStaticSeries(e,r)}return e}var c=(0,p.__assign)((0,p.__assign)({},e),{control:(0,p.__assign)((0,p.__assign)({},e.control),{properties:(0,p.__assign)((0,p.__assign)({},e.control.properties),{value:s})})}),d=c.control;return"FieldPicker"===d.type&&this.fieldPickerTransformationService.updateFieldPickerControlValue(d.properties,i,t,r),c},a.prototype.transformConditionalFormattingControl=function(e,t){var r=this,i=e.control;if("ConditionalFormattingControl"!==i.type)return b.fF.assertFail("Unexpected slice type"),e;var n=this.conditionalFormattingService.getConditionalFormattingSliceProperties(e.displayName,i.properties.value,t);if(n){var o=n.toggleButton,s=n.isApplied,l={isSet:!1,isDisabled:!s,showDialog:function(){return(0,p.__awaiter)(r,void 0,void 0,function(){return(0,p.__generator)(this,function(c){return[2,s&&s.value()]})})}};return(0,p.__assign)((0,p.__assign)({},e),{displayName:o.displayName,description:o.description,control:{type:"ToggleSwitch",properties:{descriptor:e.control.properties.descriptor,value:o.value}},conditionalFormattingObjects:l,saveCallback:o.saveCallback})}},a.prototype.getDynamicExpressionSupportObjectsForSlice=function(e,t){if(t){var r=t.formattingDescriptor;if("ErrorRangeControl"!==e.control.type&&"FieldPicker"!==e.control.type&&(3===r.instanceKind||2===r.instanceKind)){var s=t.formattingModelWarnings;return this.conditionalFormattingService.getDynamicExpressionSupportObjectForSlice({containerSliceDisplayName:t.containerSliceDisplayName,descriptor:r,objectDefinitions:t.formattingObjectOptions.objectDefinitions,objectDisplayName:t.conditionalFormattingDisplayName,propertyDescriptor:t.propertyDescriptor,propertyTypeDescriptor:t.type,warning:s&&s[r.objectName],canvasItem:t.canvasItem})}}},a.prototype.applyControlSpecificTransformation=function(e,t,r,i){switch(e.control.type){case"Dropdown":return this.transformDropdowns(e,t,r);case"FlagsSelection":return this.transformFlagsSelection(e,t,r);case"MarginPadding":case"NumUpDown":case"Slider":return this.transformControlsWithUnit(e);case"ConditionalFormattingControl":return this.transformConditionalFormattingControl(e,i);case"SeriesDialogLink":return this.transformSeriesDialogLink(e,i);case"ColorPicker":case"FontControl":return this.transformControlWithAliasNames(e);default:return e}},a.prototype.transformSeriesDialogLink=function(e,t){var r=this,i=e.control;if("SeriesDialogLink"!==i.type)return e;var n=i.properties,o=this.localizationService;return(0,p.__assign)((0,p.__assign)({},e),{control:(0,p.__assign)((0,p.__assign)({},i),{type:"Link",properties:(0,p.__assign)((0,p.__assign)({},i.properties),{value:function(){return(0,p.__awaiter)(r,void 0,void 0,function(){var c;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return[4,this.dialogService.showConfirmationDialog({title:o.get("Enable_This_Setting"),message:o.get("Format_Series_Toggle_Upgrade"),okButtonText:o.get("Restore_And_Enable"),cancelButtonText:o.get("Discard_And_Enable")},{maxWidth:450,maxHeight:225}).afterClosed().toPromise()];case 1:return 1===(c=h.sent())?[2,!0]:2===c?(n.resetToDefaultDescriptors&&t&&(0,Z.Vz)(t)&&(ce.Aw(t.config.singleVisual.objects,n.resetToDefaultDescriptors,!0),this.visualAuthoringService.raiseCanvasItemChanged(t)),[2,!0]):[2,!1]}})})}})})})},a.prototype.transformControlsWithUnit=function(e){if(this.localizationService.currentLanguageLocale.startsWith("en-"))return e;switch(e.control.type){case"NumUpDown":case"Slider":return this.transformNumUpDownControl(e);case"MarginPadding":return this.transformMarginPaddingControl(e);default:return e}},a.prototype.transformControlWithAliasNames=function(e){var t,i=null!==(t=e.aliasNames)&&void 0!==t?t:[];switch(e.control.type){case"ColorPicker":var n=this.localizationService.get("Generic_Color");return i.push(n),(0,p.__assign)((0,p.__assign)({},e),{aliasNames:i});case"FontControl":var o=this.localizationService.get("Role_DisplayName_Size");return i.push(o),(0,p.__assign)((0,p.__assign)({},e),{aliasNames:i});default:return e}},a.prototype.transformNumUpDownControl=function(e){var t,r=e.control;if("Slider"!==r.type&&"NumUpDown"!==r.type)return e;var i=null===(t=r.properties.options)||void 0===t?void 0:t.unitSymbol;if(!i)return e;var n=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(i)]);return(0,p.__assign)((0,p.__assign)({},e),{displayName:n,control:(0,p.__assign)((0,p.__assign)({},r),{properties:(0,p.__assign)((0,p.__assign)({},r.properties),{options:(0,p.__assign)((0,p.__assign)({},r.properties.options),{unitSymbol:void 0})})})})},a.prototype.transformMarginPaddingControl=function(e){var t,r,i=e.control;if("MarginPadding"!==i.type)return e;var n=i.properties,o=null===(r=null===(t=n.top)||void 0===t?void 0:t.options)||void 0===r?void 0:r.unitSymbol;if(!o)return e;var s=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(o)]),l={},u=function(v){var h=v,f=n[h];if(!f)return"continue";b.fF.assert(function(){return o===f.options.unitSymbol},"MarginPadding, all dimensions should have same unit"),l[h]=(0,p.__assign)((0,p.__assign)({},f),{options:(0,p.__assign)((0,p.__assign)({},f.options),{unitSymbol:void 0})})};for(var c in n)u(c);return(0,p.__assign)((0,p.__assign)({},e),{displayName:s,control:(0,p.__assign)((0,p.__assign)({},i),{properties:l})})},a.prototype.transformDropdowns=function(e,t,r){var i,n,o=e.control;if("Dropdown"!==o.type)return e;var s=o.properties;if(qe.WN(s))return e;var l=s.descriptor,u=s.filterValues,c=s.mergeValues,d=s.value,v=ce.w7(l,t);b.fF.assertValue(v,"Need property descriptor to resolve EnumDropdown");var h=gt.Ge.fromDescriptor(v.type),f={objectName:l.objectName,properties:(i={},i[l.propertyName]=d,i),selector:l.selector};(u||c)&&(f.validValues=((n={})[l.propertyName]={filterValues:u,mergeValues:c},n));var g=this.getSelectionOptions({propertyType:h,instance:f,propertyName:l.propertyName,visualType:r}),y="".concat(d),D=g?.find(function(N){return N.value===d||N.value===y});b.fF.assertValue(D,"selectedEnum");var T=(0,p.__assign)((0,p.__assign)({},s),{items:g,value:D}),q=T;q.filterValues=void 0,q.mergeValues=void 0;var F={type:"Dropdown",properties:T};return(0,p.__assign)((0,p.__assign)({},e),{control:F})},a.prototype.transformFlagsSelection=function(e,t,r){var i,n=e.control;if("FlagsSelection"!==n.type)return e;var o=n.properties;if(function(a){return!!a.items}(o))return e;var s=o.descriptor,l=o.value,u=ce.w7(s,t);b.fF.assertValue(u,"Need property descriptor to resolve EnumFlagsSelection");var c=gt.Ge.fromDescriptor(u.type),d={objectName:s.objectName,properties:(i={},i[s.propertyName]=l,i),selector:s.selector},h=this.getSelectionOptions({propertyType:c,instance:d,propertyName:s.propertyName,visualType:r}),f="".concat(l),g={type:"FlagsSelection",properties:(0,p.__assign)((0,p.__assign)({},o),{items:h,value:f})};return(0,p.__assign)((0,p.__assign)({},e),{control:g})},a.prototype.getSelectionOptions=function(e){var t=e.propertyType,r=e.instance,i=e.propertyName,n=e.visualType,o=this.bookmarkService,s=this.explorationNavigationService,l=this.localizationService,u=this.visualStylePresetService;b.fF.assertValue(t,"propertyType"),b.fF.assertValue(r,"instance");var c=t.enum||t.flagsEnum;if(!c){var d=t.formatting;d&&(d.labelDisplayUnits?c=(0,Yt.i)((0,xt.p$)()):d.displayUnitsWithoutAuto?c=(0,Yt.i)((0,xt.p$)(!0)):d.stylePreset&&(c=u.getEnumFromName(n,r.properties.name)));var v=t.reference;v&&(v.bookmark?(b.fF.assertValue(o,"bookmarks not implemented here"),b.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Yt.i)(qe.oE(o.getAllBookmarks())))):v.bookmarkGroup?(b.fF.assertValue(o,"bookmarks not implemented here"),b.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Yt.i)(qe.yp(o.getBookmarkGroups())))):v.section?(b.fF.assertValue(s,"explorationNavigation not implemented here"),b.fF.assertValue(l,"localizationService is missing"),s&&(c=(0,Yt.i)(qe.OY(s.getAllSections())))):b.fF.assertFail(v.perspective?"Perspectives must be set directly in `values`":"Unknown refType"))}if(c){var h=qe.Cc(r,i);if(h){var f=void 0;if(qe.QI(h)){if(f=h.filterValues,h.mergeValues){var m=(0,p.__spreadArray)((0,p.__spreadArray)([],h.mergeValues||[],!0),c.members()||[],!0);c=(0,Yt.i)(m)}}else f=h;f&&(c=(0,Yt.i)(c.members(f)))}return(0,xt.Iq)(c.members(),l)}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(qi.F),w.\u0275\u0275inject(Pi),w.\u0275\u0275inject(qa.x),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(Fa),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(xr.A))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),ri=C(66977),ii_propertyNames_upperShadingColor="upperShadingColor",ii_propertyNames_lowerShadingColor="lowerShadingColor",ii_propertyNames_transparency="transparency",Ii=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f){this.analyticsPaneSaveService=e,this.anomalyDetectionHelper=t,this.featureSwitchService=r,this.forecastHelper=i,this.formattingSliceTransformerService=n,this.legacyAnalyticsFormattingService=o,this.localizationService=s,this.referenceLineHelper=l,this.runningVisualService=u,this.selectionService=c,this.visualAuthoring=d,this.visualPluginService=v,this.visualPluginOperationsService=h,this.formattingObjectDefinitionsService=f}return a.prototype.getFormattingModel=function(e){var t;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D;return(0,p.__generator)(this,function(T){switch(T.label){case 0:return r=[],i={cards:[]},e?(0,Z.q4)(e)||(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)||ce.D1(e)?[2,i]:(o=this.visualPluginService.capabilities((n=e.config.singleVisual).visualType))?(s=this.runningVisualService.getVisual(e))&&(s.getHasPendingChanges()||s.getErrorInfo())?[2,i]:(l=s?.getAdapter(),l?this.visualPluginService.isCustomVisual(n.visualType)?[4,W(l)]:[3,4]:[2,i]):[2,i]:[2,{cards:r}];case 1:return(u=T.sent())?[3,3]:[4,this.legacyAnalyticsFormattingService.getFormattingCards(e,s,l,o)];case 2:u=T.sent(),T.label=3;case 3:return r.push.apply(r,u??[]),[3,10];case 4:return[4,this.enumerateTrendLineCard(l,o)];case 5:return(c=T.sent())&&r.push(c),[4,this.referenceLineHelper.enumerateReferenceAndConstantLineCards(e,l,o)];case 6:return(d=T.sent())&&r.push.apply(r,d||[]),[4,this.enumerateSymmetricShadingCard(l,o)];case 7:return(v=T.sent())&&r.push(v),[4,this.enumerateRatioLineCard(l,o)];case 8:return(h=T.sent())&&r.push(h),m=(f=r.push).apply,g=[r],[4,W(l)];case 9:m.apply(f,g.concat([null!==(t=T.sent())&&void 0!==t?t:[]])),T.label=10;case 10:return[4,this.forecastHelper.enumerateForecastCard(e,l,o)];case 11:return(y=T.sent())&&r.push(y),[4,this.anomalyDetectionHelper.enumerateAnomalyCard(e,l,o)];case 12:return(D=T.sent())&&r.push(D),[2,_.isEmpty(r)?i:{cards:r.map(function(q){return(0,p.__assign)((0,p.__assign)({},q),{analyticsPane:!0})})}]}})})},a.prototype.getObjectDescriptors=function(e){if((0,Z.q4)(e))return{};var r=this.visualPluginService.capabilities(e.config.singleVisual.visualType);return r?_.pickBy(r.objects,function(i,n){return 2===i.objectCategory}):{}},a.prototype.getObjectDefinitions=function(e,t){var i,r=this;if((0,Z.q4)(e))return{};var s,n=e.config.singleVisual,o=null===(i=this.visualPluginService.capabilities(n.visualType))||void 0===i?void 0:i.objects;if(!o)return{};s=t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getObjectDefinitions(e):n.objects;var l={};return _.forEach(s,function(u,c){var d;2===(null===(d=o[c])||void 0===d?void 0:d.objectCategory)&&(l[c]=c!==Qe?u:r.anomalyDetectionHelper.getObjectDefinitions(u))}),l},a.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"VisualizationPane_Section_Analytics",itemTypeDisplayName:(0,ce.um)(e,this.featureSwitchService)}},a.prototype.getFormatPaneSliceTransform=function(e){var t=this,r=(0,di.s)(e),i=(0,Z.Vz)(e)?(0,X.GQ)(e):void 0;return function(n,o,s){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:n,objectDescriptors:o,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:s})}},a.prototype.saveProperties=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return(0,Z.q4)(t)?(b.fF.assertFail("Analytics pane does not support VisualContainerGroup"),[3,3]):[3,1];case 1:return i=!1,n=e[0].objectName,b.fF.assert(function(){return e.every(function(l){return l.objectName===n})},"all the changes should have same object"),this.visualPluginService.isCustomVisual(t.config.singleVisual.visualType)&&n!==Oe.Po&&n!==Qe&&(i=!0),[4,this.analyticsPaneSaveService.saveChangedSlicesToDefinition(e,t,i)];case 2:s.sent()&&this.visualAuthoring.raiseVisualContainerChanged(t,{parentContextActivity:r}),s.label=3;case 3:return[2]}})})},a.prototype.getRevertToDefaultEnabled=function(e,t,r){var i=this.getObjectDefinitions(e);return!!i&&!!((0,ce.wW)(t,i,r)||this.forecastHelper.hasParameterWithNonDefaultValue(i)||this.anomalyDetectionHelper.hasParameterWithNonDefaultValue(i))},a.prototype.getModelUnavailableInformation=function(e){if(e&&(0,Z.Vz)(e)){var t=this.runningVisualService.getVisual(e);if(t?.getHasPendingChanges())return{messageKey:"AnalyticsPane_Disabled_Paused"}}return{messageKey:"AnalyticsPane_Unavailable",learnMoreLink:"https://go.microsoft.com/fwlink/?LinkID=825117",imageName:"".concat((0,Mn.Xr)(),"/images/RecommendedCharts.svg")}},a.prototype.revertVisualSlicesToDefinitions=function(e,t){for(var r=[],n=0,o=(0,ce.Wx)(e);n<o.length;n++){var s=o[n],l=s.canvasItem;r.push(l);var u=s.descriptors;if((0,Z.Vz)(l)){var c=l.config.singleVisual,d=c.objects;if(!d){c.objects={};continue}this.forecastHelper.revertForecastSpecialDefinitions(l,d,u),this.anomalyDetectionHelper.revertAnomalyDetectionSpecialDefinitions(l,d,u),(0,ce.Aw)(d,u)}}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},a.prototype.shouldShowGroupChangeIndicator=function(){return!1},a.prototype.shouldShowSliceChangeIndicator=function(){return!1},a.prototype.enumerateTrendLineCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d,v=this;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return i=function(m){return v.localizationService.get(m)},n=[],o=[{type:"toggle",sliceName:"combineSeries",propertyName:mi.Kx},{type:"toggle",sliceName:"useHighlightValues",propertyName:mi.$B}],s=(0,ke.pN)(r=mi.s4,ke.vi),n.push.apply(n,Object.values(s)),n.push.apply(n,_.map(o,function(f){return{objectName:r,propertyName:f.propertyName}})),[4,Q(r,"trendLine","Visual_Trend_Line",e,t,i,n,"show")];case 1:return(l=h.sent())?(u=l.objectInstance,(c=l.cardBuilder).addGroup(void 0,function(f){var m,g;f.addSlices((0,_e.Iq)({containerItemBuilder:f,descriptors:s,strokeData:(0,_e.AF)(u.properties,ke.vi,{},null===(g=null===(m=u.properties.lineColor)||void 0===m?void 0:m.solid)||void 0===g?void 0:g.color),selector:u.selector,featureSwitches:v.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(y){return y.build()})),Y(f,r,u,t,i,o)}),(d=c.build()).analyticsPane=!0,[2,d]):[2]}})})},a.prototype.enumerateSymmetricShadingCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,po(e,t,"plotAreaShading","plotAreaShading","Visual_Scatter_SymmetryShading",[{type:"color",sliceName:"upperShadingColor",propertyName:ii_propertyNames_upperShadingColor},{type:"color",sliceName:"lowerShadingColor",propertyName:ii_propertyNames_lowerShadingColor},{type:"transparency",sliceName:"transparency",propertyName:ii_propertyNames_transparency}],this.localizationService)];case 1:return[2,n.sent()]}})})},a.prototype.enumerateRatioLineCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d=this;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return i=function(f){return d.localizationService.get(f)},n=[],o=(0,ke.pN)("ratioLine",ke.vi),n.push.apply(n,Object.values(o)),[4,Q("ratioLine","ratioLine","Visual_Scatter_RatioLine",e,t,i,n,"show")];case 1:return(s=v.sent())?(l=s.objectInstance,(u=s.cardBuilder).addGroup(void 0,function(h){var f,m;return h.addSlices((0,_e.Iq)({containerItemBuilder:h,descriptors:o,strokeData:(0,_e.AF)(l.properties,ke.vi,{},null===(m=null===(f=l.properties.lineColor)||void 0===f?void 0:f.solid)||void 0===m?void 0:m.color),selector:l.selector,featureSwitches:d.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(g){return g.build()}))}),(c=u.build()).analyticsPane=!0,[2,c]):[2]}})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(wa),w.\u0275\u0275inject(dr),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(gr),w.\u0275\u0275inject(jr),w.\u0275\u0275inject(Ti),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Kr),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Ir.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(ri.f),w.\u0275\u0275inject(gi,8))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function po(a,e,t,r,i,n,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return l=function(g){return o.get(g)},(u=_.map(n,function(m){return{objectName:t,propertyName:m.propertyName}})).push({objectName:t,propertyName:s||G}),[4,Q(t,r,i,a,e,l,u,s)];case 1:return(c=f.sent())?(d=c.objectInstance,(v=c.cardBuilder).addGroup(void 0,function(m){Y(m,t,d,e,l,n)}),(h=v.build()).analyticsPane=!0,[2,h]):[2]}})})}var At=C(15580),pe=C(80981),Na=C(21002),vo=C(92129),Ta=C(84668),ho=C(68082),xi=C(90006),fo=C(7119),mo=C(77896),go=C(28326),Va=C(98776),yo=C(52364),So=C(40645),ai=function(){function a(e,t,r,i){this.cultureService=e,this.formatStringConverterService=t,this.cultureSettingsService=r,this.cultureFormattingService=i,this.allCurrencyFormats=null,this.cultureSettingsService&&this.cultureFormattingService?this.useTypescriptService=!1:(this.useTypescriptService=!0,this.cultureService.initialize())}return a.prototype.updateCultureFormatUtils=function(){var e;this.useTypescriptService?e=this.cultureService.getFormatInfo():this.useTypescriptService||(e=this.cultureSettingsService.getFormatInfo()),this.formatUtil=new Va.c(e)},a.prototype.cloneFormatInfo=function(e){if(!e)return null;var t={formatString:e.formatString,format:e.format,accuracy:e.accuracy,thousandSeparator:e.thousandSeparator};if(e.currencyFormat){var r=e.currencyFormat;t.currencyFormat={culture:r.culture,currencySymbol:r.currencySymbol,positivePattern:r.positivePattern,negativePattern:r.negativePattern}}if(e.dateTimeCustomFormat){var n=e.dateTimeCustomFormat;t.dateTimeCustomFormat={culture:n.culture,formatGroup:n.formatGroup,formatString:n.formatString}}return t},a.prototype.updateFormatUponDataTypeChange=function(e,t){this.updateCultureFormatUtils();var r=this.cloneFormatInfo(t);return this.formatUtil.updateFormatUponDataTypeChange(e,r)},a.prototype.changeFormat=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.changeFormat(e,i,r)},a.prototype.setThousandsSeparator=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.setThousandsSeparator(e,i,r)},a.prototype.toggleThousandsSeparator=function(e,t){this.updateCultureFormatUtils();var r=this.cloneFormatInfo(t);return this.formatUtil.toggleThousandsSeparator(e,r)},a.prototype.setAccuracy=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(t);return this.formatUtil.setAccuracy(e,i,r)},a.prototype.setDateTimeFormat=function(e,t,r,i,n){this.updateCultureFormatUtils();var o=this.cloneFormatInfo(t);return this.formatUtil.setDateTimeFormat(e,o,r,i,n)},a.prototype.setCurrencyFormat=function(e,t,r,i,n,o,s){this.updateCultureFormatUtils();var l=this.cloneFormatInfo(t);return this.formatUtil.setCurrencyFormat(e,l,r,i,n,o,s)},a.prototype.setCurrencyFormatWithCulture=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return this.allCurrencyFormats?[3,2]:(n=this,[4,this.cultureService.getAllCurrencySymbolCustomFormatItemsInfoAsync()]);case 1:n.allCurrencyFormats=s.sent(),s.label=2;case 2:if(!(o=this.allCurrencyFormats.find(function(l){return l.culture===i})))throw"Cannot find selected currency format option based on selected value";return[2,this.setCurrencyFormat(e,t,r,o.culture,o.symbol,o.positivePattern,o.negativePattern)]}})})},a.prototype.setCustomFormatString=function(e,t,r){this.updateCultureFormatUtils();var i=this.cloneFormatInfo(r);return this.formatUtil.setCustomFormatString(e,t,i)},a.prototype.getAllCurrencySymbolCustomFormatItemsInfo=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return this.updateCultureFormatUtils(),this.useTypescriptService?[4,this.cultureService.getAllCurrencySymbolCustomFormatItemsInfoAsync()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,this.cultureSettingsService.getAllCurrencySymbolCustomFormatItemsInfo()]}})})},a.prototype.getAllCustomFormats=function(){return this.updateCultureFormatUtils(),this.useTypescriptService?this.cultureService.getAllCustomFormats():this.cultureSettingsService.getAllCustomFormats()},a.prototype.getAllDateTimeFormatItemsInfo=function(){return this.updateCultureFormatUtils(),this.useTypescriptService?this.cultureService.getAllDateTimeFormatItemsInfo():this.cultureSettingsService.getAllDateTimeFormatItemsInfo()},a.prototype.formatWithVBAString=function(e,t){if(this.updateCultureFormatUtils(),this.useTypescriptService){var r=this.formatStringConverterService.VBAToDotNet(e);return Promise.resolve(go.dx.formatValue(t,r))}return this.cultureFormattingService.formatWithVBAString(e,t)},a.prototype.convertVBAToDAX=function(e){return this.updateCultureFormatUtils(),this.useTypescriptService?Promise.resolve(this.formatStringConverterService.VBAToDotNet(e)):this.cultureFormattingService.convertVBAToDAX(e)},a.prototype.convertDotNetToVBA=function(e){return this.updateCultureFormatUtils(),this.useTypescriptService?Promise.resolve(this.formatStringConverterService.DotNetToVBA(e)):this.cultureFormattingService.convertDotNetToVBA(e)},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(yo.t),w.\u0275\u0275inject(So.z),w.\u0275\u0275inject(mo.e,8),w.\u0275\u0275inject(fo.e,8))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}),a}(),Fo=function(){function a(e){this.formatInfoService=e}return a.prototype.getApplicableDateTimeFormats=function(e){switch(e){case"Date":return this.getAllDateFormats();case"DateTime":return(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],this.getAllDateFormats(),!0),this.getAllDateTimeFormats(),!0),this.getAllTimeFormats(),!0);case"Time":return this.getAllTimeFormats();default:return[]}},a.prototype.getApplicableCommonDateTimeFormats=function(e){return"DateTime"===e?this.getCommonDateTimeFormats():[]},a.prototype.getApplicableCustomDateTimeFormats=function(){return this.getAllCustomFormats()},a.prototype.getAllCustomFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return xa(t)})},a.prototype.getAllDateFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return Pa(t)})},a.prototype.getAllTimeFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return Ia(t)})},a.prototype.getAllDateTimeFormats=function(){var e=this.getAllFormats();return _.filter(e,function(t){return function(a){return!Pa(a)&&!Ia(a)&&!xa(a)}(t)})},a.prototype.getAllFormats=function(){return this.cachedAllFormats||(this.cachedAllFormats=this.formatInfoService.getAllDateTimeFormatItemsInfo()),this.cachedAllFormats},a.prototype.getCommonDateTimeFormats=function(){var e,t,r,i,n,o,s,l=this;if(this.cachedCommonDateTimeFormats)return this.cachedCommonDateTimeFormats;this.cachedCommonDateTimeFormats=[];var u=0,c=0,d=0,v=0,h=0,f=0,m=[],g=[],y=[],D=[],T=[],q=[],F=[];return this.getAllFormats().forEach(function(V,P){0===P||1===P?l.cachedCommonDateTimeFormats.push(V):"LongDate"===V.pattern&&u<2?(m.push(V),u++):"ShortDate"===V.pattern&&c<2?(g.push(V),c++):"YearMonth"===V.pattern&&d<1?(y.push(V),d++):"MonthDay"===V.pattern&&v<1?(D.push(V),v++):"LongTime"===V.pattern&&h<4?(T.push(V),h++):"ShortTime"===V.pattern&&f<4?(q.push(V),f++):"YearYYYY"===V.pattern&&F.push(V)}),(e=this.cachedCommonDateTimeFormats).push.apply(e,m||[]),(t=this.cachedCommonDateTimeFormats).push.apply(t,g||[]),(r=this.cachedCommonDateTimeFormats).push.apply(r,y||[]),(i=this.cachedCommonDateTimeFormats).push.apply(i,D||[]),(n=this.cachedCommonDateTimeFormats).push.apply(n,T||[]),(o=this.cachedCommonDateTimeFormats).push.apply(o,q||[]),(s=this.cachedCommonDateTimeFormats).push.apply(s,F||[]),this.cachedCommonDateTimeFormats},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(ai))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}),a}();function Pa(a){return"LongDate"===a.pattern||"ShortDate"===a.pattern||"DMYDate"===a.pattern||"MonthDay"===a.pattern||"YearMonth"===a.pattern||"YearMM"===a.pattern||"YearYY"===a.pattern||"YearYYYY"===a.pattern}function Ia(a){return"LongTime"===a.pattern||"ShortTime"===a.pattern}function xa(a){return"Custom"===a.pattern}var Vo=C(61561),Po=function(){function a(e,t){this.localizationService=e,this.formatInfoService=t}return a.prototype.getAllSupportedCurrencyFormats=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return this.cachedAllCurrencyFormatInfo?[2,this.cachedAllCurrencyFormatInfo]:[4,this.formatInfoService.getAllCurrencySymbolCustomFormatItemsInfo()];case 1:return e=r.sent(),this.cachedAllCurrencyFormatInfo=[],this.cachedAllCurrencyFormatInfo.push(this.createGeneralCurrencyFormat()),(t=this.cachedAllCurrencyFormatInfo).push.apply(t,e),[2,this.cachedAllCurrencyFormatInfo]}})})},a.prototype.getCommonSupportedCurrencyFormats=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return this.cachedCommonCurrencyFormatInfo?[2,this.cachedCommonCurrencyFormatInfo]:[4,this.formatInfoService.getAllCurrencySymbolCustomFormatItemsInfo()];case 1:return e=r.sent(),this.cachedCommonCurrencyFormatInfo=[],this.cachedCommonCurrencyFormatInfo.push(this.createGeneralCurrencyFormat()),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return null===i.culture&&"\xa5"===i.symbol})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"en-GB"===i.culture})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"en-US"===i.culture})),this.cachedCommonCurrencyFormatInfo.push(_.find(e,function(i){return"fr-CH"===i.culture})),(t=this.cachedCommonCurrencyFormatInfo).push.apply(t,_.filter(e,function(i){return null===i.culture&&"\u20ac"===i.symbol})),this.cachedCommonCurrencyFormatInfo=_.compact(this.cachedCommonCurrencyFormatInfo),[2,this.cachedCommonCurrencyFormatInfo]}})})},a.prototype.createGeneralCurrencyFormat=function(){return{formatType:"CurrencyGeneral",culture:null,displayLabel:this.localizationService.get("Format_Label_Currency_General"),symbol:"$",positivePattern:0,negativePattern:0}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(ai))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}),a}(),Io=C(91836),Aa=function(){function a(e,t){this.formatInformationParserService=e,this.formatInformationService=t,this.cache=new Map}return a.prototype.getFormatInformation=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return n=this.cache.get(e.name),o=n?.get(t),s=null===(r=(0,X.PQ)(e))||void 0===r?void 0:r.columnProperties,l=null===(i=s?.[t])||void 0===i?void 0:i.formatString,(u=null!=o)&&!ja(o.formatStringDotNet,l)&&(u=!1),u?[2,o]:[3,1];case 1:return[4,this.updateCacheInternal(e,t,l)];case 2:return[2,d.sent()]}})})},a.prototype.updateCache=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){return[2,this.updateCacheInternal(e,t,r,i)]})})},a.prototype.updateCacheFromFormatInformation=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.updateCacheInternal(e,t,r?.formatString,r)];case 1:return[2,n.sent().formatStringVBA]}})})},a.prototype.updateCacheInternal=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return n=this.cache.get(e.name),_.isEmpty(r)&&null==i?(n&&n.delete(t),[2]):(null==n&&this.cache.set(e.name,n=new Map),[4,this.formatInformationService.convertDotNetToVBA(r)]);case 1:return o=c.sent(),null==i?[3,2]:(l=i,[3,4]);case 2:return[4,this.formatInformationParserService.tryParseVBAFormatString(o)];case 3:l=c.sent(),c.label=4;case 4:return s=l,b.fF.assert(function(){return ja(r,s.formatString)},"after .NET->VBA->FormatInformation conversion, original .NET string is changed"),n.set(t,u={formatStringVBA:o,formatStringDotNet:r,formatInformation:s}),[2,u]}})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(Io.Z),w.\u0275\u0275inject(ai))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function ja(a,e){return(a??"")===(e??"")}var xo=C(27980),tt="visualLevelFormat",br="customFormatString",Ai="formatOptions",ji="currencyFormats",zi="percentageOn",Oi="thousandSeparatorOn",Mi="decimalPoints",zr="visualFieldDataType",jo=[{type:"General",displayLabelKey:"Format_Label_General"},{type:"CurrencyGeneral",displayLabelKey:"Format_Label_Currency"},{type:"DateTimeGeneralPattern",displayLabelKey:"Format_Label_DateTime"},{type:"NumberDecimal",displayLabelKey:"DataType_Label_Number"},{type:"NumberWhole",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Percentage",displayLabelKey:"Format_Label_Percentage"},{type:"Scientific",displayLabelKey:"Format_Label_Scientific"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],zo=[{type:"WholeNumber",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Number",displayLabelKey:"DataType_Label_Number"},{type:"Currency",displayLabelKey:"DataType_Label_Currency"},{type:"DateTime",displayLabelKey:"DataType_Label_Date_Time"},{type:"Date",displayLabelKey:"DaxTemplates_DateField"},{type:"Time",displayLabelKey:"DataType_Label_Time"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],Oo=[{objectName:tt,propertyName:br},{objectName:tt,propertyName:Ai},{objectName:tt,propertyName:ji},{objectName:tt,propertyName:zi},{objectName:tt,propertyName:Oi},{objectName:tt,propertyName:Mi},{objectName:tt,propertyName:zr}],Oa=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h){this.conceptualSchemaProxy=e,this.currencyFormatService=t,this.dateTimeFormatService=r,this.dataSourcesService=i,this.displayNameService=n,this.featureSwitchService=o,this.formatInformationCacheService=s,this.formatInformationService=l,this.lazyScoped=u,this.localizationService=c,this.visualAuthoringService=d,this.visualAuthoringOperationsService=v,this.dataModelService=h}return a.prototype.getVisualLevelFormatStringCard=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,v,h,f,m,g,y,D,T=this;return(0,p.__generator)(this,function(q){switch(q.label){case 0:i=new S.lg("visualLevelFieldsFormat"),n=new S.CQ(i,"Visual_Level_Fields_Formatting",Oo,function(F){return T.localizationService.get(F)},!0),o=function(a){var e=(0,X.oJ)(a),t=(0,X.Ml)(a),r=[];_.isEmpty(e)||_.forEach(t,function(n,o){_.forEach(n.all(),function(s){var l=(0,st.rC)(e,s.queryRef);l&&r.push({select:l,isHidden:s.hidden})})});var i=_.groupBy(r,function(n){return n.select.name});return b.fF.assert(function(){return _.every(i,function(n){if(_.size(n)<=1)return!0;var o=n[0].isHidden;return _.every(n,function(s){return s.isHidden===o})})},"We expect all projections corresponding to the same select has the same isHidden value. Now some projections of the same select has different isHidden values. Either the assumption is changed, or there is a bug."),_.uniqBy(r,function(n){return n.select.name})}(e),s=[],l=0,u=o,q.label=1;case 1:return l<u.length?[4,this.formatInformationCacheService.getFormatInformation(e,u[l].select.name)]:[3,4];case 2:v=q.sent(),s.push(v),q.label=3;case 3:return l++,[3,1];case 4:return h=[],_.find(s,function(F){var N;return Bi(null===(N=F?.formatInformation)||void 0===N?void 0:N.format)})?[4,this.currencyFormatService.getCommonSupportedCurrencyFormats()]:[3,7];case 5:return f=q.sent(),[4,this.currencyFormatService.getAllSupportedCurrencyFormats()];case 6:m=q.sent(),g=_.uniqBy((0,p.__spreadArray)((0,p.__spreadArray)([],f??[],!0),m??[],!0),Ma),h.push.apply(h,g),q.label=7;case 7:return y=null===(r=(0,X.PQ)(e))||void 0===r?void 0:r.columnProperties,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 8:return D=q.sent(),n.addGroup("visualSelects",function(F){F.withDisplayName("Apply_Settings_To").withCollapsible(!1),F.addContainer("visual-fields-container",function(N){_.forEach(o,function(V,P){var O=V.select.name,E=V.select.expr,L=T.displayNameService.getDisplayName(E,D,t,O,y,{includeHierarchyName:!0,includeVariationSource:!0});N.addContainerItem(O,L,function(B){V.isHidden&&B.withIcon("hide3"),B.withGroups([T.getSingleFieldFormatGroup(i,e,O,E,s[P],D,h)])})})})}),[2,n.build()]}})})},a.prototype.saveSlice=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return e!==tt?[2]:(0,Z.Vz)(r)?t.name===br?[2,this.saveVisualLevelFormatStringSlice(t,r)]:t.name===Ai?[2,this.saveVisualLevelFormatOptionsSlice(t,r)]:t.name===ji?[2,this.saveVisualLevelCurrencyFormatOptionsSlice(t,r)]:t.name===Oi?[2,this.saveVisualLevelThousandSeparatorSlice(t,r)]:t.name===zi?[2,this.saveVisualLevelPercentageSlice(t,r)]:t.name===Mi?[2,this.saveVisualLevelDecimalPointsSlice(t,r)]:t.name===zr?[2,this.saveVisualLevelFieldDataTypeSlice(t,r)]:[2]:(b.fF.assertFail("Expect visualLevelFormatStringFormattingHelper.saveSlice to be called only for a visual container"),[2])})})},a.prototype.resetProperty=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return t!==br?[3,1]:(this.visualAuthoringOperationsService.removeAllVisualLevelFormatStrings(e),[3,3]);case 1:return t!==zr?[3,3]:[4,this.visualAuthoringService.getVisualCalcDaxParserServiceContext(e)];case 2:r=i.sent(),this.visualAuthoringOperationsService.removeAllVisualLevelUserSetDataTypes(e,r),i.label=3;case 3:return[2]}})})},a.prototype.saveVisualLevelFieldDataTypeSlice=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,l=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return i=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(i)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=(0,xi.F)(n=e.value),[4,this.visualAuthoringService.updateVisualCalculationDataType(t,i,o)]);case 1:return u.sent()?[2,this.saveSliceWithFormatInformationUpdate(e,t,function(c){return l.formatInformationService.updateFormatUponDataTypeChange((0,xi.F)(n),c.formatInformation)})]:[2]}})})},a.prototype.saveVisualLevelFormatStringSlice=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,c;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return n=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(n)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=e.value,[4,this.getFieldTypeAndFormatInfo(t,n)]);case 1:return s=d.sent(),l=s?.formatInformation,u="Custom"===l?.format&&"Custom"===(null===(i=l?.dateTimeCustomFormat)||void 0===i?void 0:i.formatGroup),c=u?function(a){var e=La(a);return(0,p.__assign)((0,p.__assign)({},e),{dateTimeCustomFormat:{culture:null,formatGroup:"Custom",formatString:e.formatString}})}(o):La(o),this.formatInformationCacheService.updateCache(t,n,o,c),this.visualAuthoringService.setVisualLevelFormatString(t,n,o,!0),[2]}})})},a.prototype.saveVisualLevelFormatOptionsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(n){var o,s,c,l=JSON.parse(e.value),u=l.formatType;return c=function(a){var e=a.formatType;return"DateTimeGeneralPattern"===e||"DateTimeCustom"===e||"Custom"===e&&"Custom"===a.dateTimePattern}(l)?r.formatInformationService.setDateTimeFormat(n.valueType.primitiveType,n.formatInformation,u,l.dateTimePattern,null!==(o=l.formatString)&&void 0!==o?o:null===(s=n.formatInformation)||void 0===s?void 0:s.formatString):r.formatInformationService.changeFormat(n.valueType.primitiveType,n.formatInformation,u),c})]})})},a.prototype.saveVisualLevelCurrencyFormatOptionsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(n){var o=JSON.parse(e.value);return r.formatInformationService.setCurrencyFormat(n.valueType.primitiveType,n.formatInformation,o.formatType,o.culture,o.symbol,o.positivePattern,o.negativePattern)})]})})},a.prototype.saveVisualLevelThousandSeparatorSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(n){return r.formatInformationService.setThousandsSeparator(n.valueType.primitiveType,n.formatInformation,e.value)})]})})},a.prototype.saveVisualLevelPercentageSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(n){var o=JSON.parse(e.value);return r.formatInformationService.changeFormat(n.valueType.primitiveType,n.formatInformation,o?"Percentage":"General")})]})})},a.prototype.saveVisualLevelDecimalPointsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(n){return r.formatInformationService.setAccuracy(n.valueType.primitiveType,n.formatInformation,e.value)})]})})},a.prototype.saveSliceWithFormatInformationUpdate=function(e,t,r){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return n=null===(i=e.selector)||void 0===i?void 0:i.metadata,_.isEmpty(n)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):[4,this.getFieldTypeAndFormatInfo(t,n)];case 1:return o=l.sent(),b.fF.assert(function(){return null!=o&&null!=o?.valueType},"Expect the matching field has data type and format info"),o&&null!=o?.valueType?(s=r(o),[4,this.formatInformationCacheService.updateCacheFromFormatInformation(t,n,s)]):[2];case 2:return l.sent(),this.visualAuthoringService.setVisualLevelFormatString(t,n,s?.formatString,!0),[2]}})})},a.prototype.getSingleFieldFormatGroup=function(e,t,r,i,n,o,s){var u,l=this,c=new S.mQ(new S.SS(e,"singleFieldVisualLevelFormatGroup"),function(f){return l.localizationService.get(f)});c.withDisplayName("Format_Options");var d=null===(u=i.getMetadata(o))||void 0===u?void 0:u.type;if(b.fF.assert(function(){return null!=d},"Expect the field ".concat(r," to have a data type")),this.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport){var v=(0,xi.m)(d?.primitiveType)||"Number";this.checkToAddDataTypesDropdown(c,i,r,v);var h=n?.formatInformation;this.addFormatsDropdown(c,r,v,h),this.checkToAddCurrencyFormats(c,r,h,s),this.checkToAddNumericFormatControls(c,r,v,h),"Custom"===h?.format&&this.addCustomFormatStringSlices(c,t,r,d,"Visual_FormatCode")}else this.addCustomFormatStringSlices(c,t,r,d,"Format");return c.build()},a.prototype.addCustomFormatStringSlices=function(e,t,r,i,n){var s,l,o=this,u=function(a){var e;return a?.bool||a?.text||!(null===(e=a?.misc)||void 0===e||!e.sparkline)}(i);b.fF.assert(function(){return!u||!o.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport},"If the field does not support custom format string, we do not expect this function to be called when visualLevelFormatStringFullSupport is on"),u&&e.addSimpleSlice("noCustomFormatSupportMessage",function(){return new S.G_({descriptor:{objectName:tt,selector:{metadata:r},propertyName:void 0},value:o.localizationService.get("CustomFormatString_Disabled_For_CertainTypedFields")}).build()});var c=null===(s=(0,X.PQ)(t))||void 0===s?void 0:s.columnProperties;e.addSimpleSlice("singleFieldVisualLevelFormatString",new S.fq({descriptor:{objectName:tt,propertyName:br,selector:{metadata:r}},value:null===(l=c?.[r])||void 0===l?void 0:l.formatString,placeholder:"Auto",validators:{maxLength:{type:5,value:255}}}).build(),function(d){d.withCustomDisplayName(n),u&&d.withDisabled(!0)}),function(a,e){a.addSimpleSlice("singleFieldVisualLevelFormatStringLearnMoreLink",new S.Vc({descriptor:{objectName:tt,selector:{metadata:e},propertyName:void 0},value:function(){window.open("https://go.microsoft.com/fwlink/p/?LinkId=2099021","_blank")}}).build(),function(t){return t.withCustomDisplayName("LearnMore").withSuppressDisplayName(!0)})}(e,r)},a.prototype.checkToAddDataTypesDropdown=function(e,t,r,i){if((0,Ze.jX)(t)){var n=this.getDataTypeDropdownItems(),o=_.find(n,function(s){return s.value===i});e.addSimpleSlice("dataTypeOptions",function(){return new S.uY({items:n,descriptor:{objectName:tt,propertyName:zr,selector:{metadata:r}},value:o}).build()},function(s){s.withCustomDisplayName("DataType_Title")})}},a.prototype.addFormatsDropdown=function(e,t,r,i){var n=this.getFieldFormatOptions(r),o=_.map(n,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=_.findIndex(n,function(u){return function(a,e){return b.fF.assert(function(){return null!=e},"the given formatOption comes from the main format options dropdown and should never be null"),null!=a&&(b.fF.assert(function(){return"CurrencyCustom"!==e.formatString},"We do not expect the main format options dropdown to have CurrencyCustom"),(Bi(a.format)?"CurrencyGeneral":a.format)===e.formatType&&(!a.dateTimeCustomFormat||("Custom"===a.format?"Custom"===e.formatType:a.dateTimeCustomFormat.formatGroup===e.dateTimePattern&&a.dateTimeCustomFormat.formatString===e.formatString)))}(i,u)}),l=-1!==s?o[s]:null;e.addSimpleSlice("formatOptions",function(){return new S.uY({items:o,descriptor:{objectName:tt,propertyName:Ai,selector:{metadata:t}},value:l}).build()},function(u){u.withCustomDisplayName("Format")})},a.prototype.checkToAddCurrencyFormats=function(e,t,r,i){var n=r?.format;if(Bi(n)){var o=_.map(i,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=function(a){return"".concat(Rt(a.culture),"-").concat(Rt(a.currencySymbol),"-").concat(Rt(a.negativePattern),"-").concat(Rt(a.positivePattern))}(r?.currencyFormat),l=_.findIndex(i,function(u){return Ma(u)===s});e.addSimpleSlice("currencyFormats",function(){return new S.uY({items:o,descriptor:{objectName:tt,propertyName:ji,selector:{metadata:t}},value:o[l]}).build()},function(u){u.withCustomDisplayName("Properties_Currency_Format")})}},a.prototype.checkToAddNumericFormatControls=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,p.__generator)(this,function(o){return(0,Va.R)(r,i,this.dateTimeFormatService)?(e.addSimpleSlice("percentageFormat",function(){return new S.bd({descriptor:Li(t,zi),value:"Percentage"===i?.format}).build()},function(s){s.withCustomDisplayName("Properties_Percentage_Format")}),e.addSimpleSlice("thousandSeparatorFormat",function(){return new S.bd({descriptor:Li(t,Oi),value:i?.thousandSeparator}).build()},function(s){s.withCustomDisplayName("Properties_Thousands_Separator")}),e.addSimpleSlice("decimalPoints",function(){return new S.mu({descriptor:Li(t,Mi),value:i?.accuracy,options:{minValue:{type:0,value:0},maxValue:{type:1,value:15}},placeholderText:n.localizationService.get("Visual_Auto")}).build()},function(s){s.withCustomDisplayName("Properties_Decimal_Places")}),[2]):[2]})})},a.prototype.getFieldFormatOptions=function(e){var o,t=this,r={formatType:"Custom",displayLabel:this.localizationService.get("Custom")},i={formatType:"Custom",displayLabel:this.localizationService.get("Custom"),dateTimePattern:"Custom"},n=!function(a){return"Text"===a||"Boolean"===a}(e);if(function(a){return"Date"===a||"DateTime"===a||"Time"===a}(e)){var s=this.dateTimeFormatService.getApplicableCommonDateTimeFormats(e),l=this.dateTimeFormatService.getApplicableDateTimeFormats(e),u=(0,p.__spreadArray)((0,p.__spreadArray)([],s,!0),l,!0);b.fF.assert(function(){return null==_.find(u,function(v){return"Dynamic"===v.formatType})},"We do not expect a dateTime format item is in type Dynamic"),o=function(a){return _.map(a,function(e){return{formatType:e.formatType,displayLabel:e.displayLabel,formatString:e.formatString,dateTimePattern:e.pattern}})}(u),n&&(_.remove(o,function(v){return"Custom"===v.formatType}),o.unshift(i))}else{var c=this.dataModelService.getCompatibleFormats([e]);c=_.filter(c,function(v){return"Dynamic"!==v}),o=_.compact(_.map(c,function(v){var h=_.find(jo,function(f){return f.type===v});if(b.fF.assert(function(){return null!=h||"Custom"===v},"We expect to haven an entry for format type ".concat(v)),h)return{formatType:v,displayLabel:t.localizationService.get(h.displayLabelKey)}})),n&&o.push(r)}n||_.remove(o,function(v){return"Custom"===v.formatType});var d=_.uniqBy(o,function(v){return function(a){return"".concat(a.formatType,"-").concat(Rt(a.formatString))}(v)});return d},a.prototype.getFieldTypeAndFormatInfo=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return i=(0,X.oJ)(e),(n=_.find(i,function(c){return c.name===t}))?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[2];case 1:return o=u.sent(),s=null===(r=n.expr.getMetadata(o))||void 0===r?void 0:r.type,b.fF.assert(function(){return null!=s},"We expect the valueType of the field matching the given givenName to be defined"),[4,this.formatInformationCacheService.getFormatInformation(e,t)];case 2:return l=u.sent(),[2,{valueType:s,formatInformation:l?.formatInformation}]}})})},a.prototype.getDataTypeDropdownItems=function(){var e=this;return this.dataTypeDropdownItems||(this.dataTypeDropdownItems=_.map(zo,function(t){return{value:t.type,displayName:e.localizationService.get(t.displayLabelKey),label:t.displayLabelKey}})),this.dataTypeDropdownItems},a.prototype.getVisualCalcService=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e;return(0,p.__generator)(this,function(t){switch(t.label){case 0:return null!=this.visualCalcServiceInternal?[3,2]:(e=this,[4,this.lazyScoped.get(Vo.w)]);case 1:e.visualCalcServiceInternal=t.sent(),t.label=2;case 2:return[2,this.visualCalcServiceInternal]}})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Po),w.\u0275\u0275inject(Fo),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Wr.O),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(Aa),w.\u0275\u0275inject(ai),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(xo.Q),w.\u0275\u0275inject(ho.n))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function Ma(a){return"".concat(Rt(a.culture),"-").concat(Rt(a.symbol),"-").concat(Rt(a.negativePattern),"-").concat(Rt(a.positivePattern))}function Li(a,e){return{objectName:tt,propertyName:e,selector:{metadata:a}}}function Bi(a){return"CurrencyGeneral"===a||"CurrencyCustom"===a}function La(a){return{formatString:_.isEmpty(a)?void 0:a,format:"Custom",thousandSeparator:!1,currencyFormat:null,dateTimeCustomFormat:null}}function Rt(a){return a??""}var Qo=[U.X,U.Y,U.Lu,U.oU,U.f4,U.Zp];function Ba(a,e,t,r){var i=e.layouts.withId(r),n=_.cloneDeep(i.position);b.fF.assertValue(n,"VisualContainer.position");var o=parseInt(a.value,10);if(!isNaN(o)&&null!=o){if(a.name===U.X)if(1!==r){var s=(0,X.P4)((0,p.__assign)((0,p.__assign)({},n),{x:o}),e);n.x=s.x}else n.x=o;else a.name===U.Y?1!==r?(s=(0,X.P4)((0,p.__assign)((0,p.__assign)({},n),{y:o}),e),n.y=s.y):n.y=o:a.name===U.Lu?n.width=o:a.name===U.oU&&(n.height=o);t.layoutAuthoring?t.layoutAuthoring.moveCanvasItemFromContract(e,n):b.fF.assertFail("layoutAuthoring should be provided for saving General slice")}}function Ea(a){return a.queryOptions||(a.queryOptions={}),a.queryOptions}function Ra(a,e){void 0===e&&(e=!0);var t=a.getCurrentSection();return _.chain(a.getAllSections()).filter(function(i){return!(!(1&i.type)||e&&i.name===t.name)}).map(function(i){return i.name}).value()}var ns=[U.X,U.Y,U.Lu,U.oU];function Ua(a){if(a)return ka(a&&a.getWarnings())}function ka(a){var e=a&&a.visualObjectWarnings;if(e){var t=_.reduce(e,function(r,i,n){var o=_.first(i),s=o&&_.first(o.warnings);return s&&(r[n]=s),r},{});return _.isEmpty(t)?void 0:t}}var Ga=C(18659),Wa=C(28340),Ha=C(42145),Ka=C(18664),Ei=C(45545),Qa=C(34021),$a=C(92374),ls=C(47316),Cr=C(79154),Ri=C(48145),us=C(77200),Ya=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,T,q){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.dataSourcesService=r,this.displayNameService=i,this.explorationCapabilitiesService=n,this.explorationNavigationService=o,this.featureSwitchService=s,this.formattingSliceTransformerService=l,this.formFactorService=u,this.lazyScopedProvider=c,this.localizationService=d,this.runningVisualService=v,this.themeService=h,this.viewModeStateService=f,this.visualAuthoring=m,this.visualPluginOperationsService=g,this.visualPluginService=y,this.visualStylePresetService=D,this.visualLevelFormatStringHelperService=T,this.formattingObjectDefinitionsService=q}return a.prototype.getCardBuildingOptions=function(e,t){var r=this.explorationNavigationService.getCurrentExploration(),i=this.explorationCapabilitiesService.getCapabilities();if((0,Z.Vz)(e)){var n=pe.XW,o=e.config.singleVisual.evaluatedObjects,s=pe.fU,l=e.config.singleVisual,u=l.visualType,c=this.visualPluginService.capabilities(l.visualType),v=this.visualPluginOperationsService,h={isScriptVisual:this.visualPluginService.isScriptVisual(u),isAnalysisVisual:v.isAnalysisVisual(u),isQueryVisual:v.isQueryVisual(u),isQnaVisual:v.isQnaVisual(u)},f=this.themeService.getVisualStyle(r.themeCollection);return{allowConditionalFormatting:!(h.isScriptVisual||h.isAnalysisVisual||h.isQnaVisual),capabilities:c,container:e,descriptors:n,exploration:r,evaluatedObjects:o,explorationCapabilities:i,featureSwitches:t,props:s,visualKind:h,visualStyle:f,isQueryVisualWithoutData:(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)}}return{allowConditionalFormatting:!1,container:e,descriptors:n=pe.XW,exploration:r,evaluatedObjects:o=e.evaluatedObjects,explorationCapabilities:i,featureSwitches:t,props:s=Ga.fU}},a.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,Z.q4)(e))return{messageKey:void 0};if((0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if((0,ce.D1)(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},a.prototype.getFormattingModel=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,n,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return e?[4,this.featureSwitchService.getFeatureSwitches()]:[2,{cards:[]}];case 1:if(t=m.sent(),r=this.getCardBuildingOptions(e,t),i=(0,Z.Vz)(e),(0,Z.Vz)(e)){if((n=r.isQueryVisualWithoutData)&&!t.onObject||(0,ce.D1)(e))return[2,{cards:[]}];if(null==((f=this.runningVisualService.getVisual(e))&&f.getAdapter())&&!n||f&&f.getHasPendingChanges()||f&&f.getErrorInfo())return[2,{cards:[]}]}return l=S.Nq.bind,(u=!t.onObject)?[4,this.getPropertiesCard(r)]:[3,3];case 2:u=m.sent(),m.label=3;case 3:return c=[void 0,u],(d=!t.onObject&&i)?[4,this.getTitleCard(r,t)]:[3,5];case 4:d=m.sent(),m.label=5;case 5:return c=c.concat([d,!t.onObject&&this.getEffectsCard(r)]),(v=t.visualLevelFormatStringConsumption&&t.visualLevelFormatStringAuthoring&&t.visualCalculationsAuthoring)?[4,this.getVisualLevelFormattingCard(r)]:[3,7];case 6:v=m.sent(),m.label=7;case 7:return c=c.concat([v,this.getHeaderIconsCard(r),this.getTooltipsCard(r),this.getAltTextCard(r)]),(h=t.onObject)?[4,this.getAdvancedOptionsCard(r)]:[3,9];case 8:h=m.sent(),m.label=9;case 9:return s=new(l.apply(S.Nq,c.concat([h]))),i&&(f=this.runningVisualService.getVisual(e),s.withWarnings(Ua(f))),[2,s.build()]}})})},a.prototype.getObjectDefinitions=function(e,t){if(e)return(0,Z.Vz)(e)?function(a,e){var t,r;return(0,X.jt)([e])||(0,X.Wu)([e])?(0,p.__assign)((0,p.__assign)({},a??{}),((t={})[tt]=[{properties:(r={},r[br]={},r[zr]={},r)}],t)):a}(t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getVcObjectDefinitions(e):e.config.singleVisual.vcObjects,e):e.objects},a.prototype.getObjectDescriptors=function(e){return(0,Z.Vz)(e)?pe.XW:Ga.C7},a.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ce.um)(e,this.featureSwitchService)}},a.prototype.saveProperties=function(e,t,r,i){var n=this,o=this.formFactorService.getCurrentLayout();if((0,Z.Vz)(r)){if(this.featureSwitchService.featureSwitches.onObject){var s=this.runningVisualService.getVisual(r);b.fF.assert(function(){return _.every(e,function(f){return null!=f.visualUpdateSource})},"All changes should have a visual update source");var l=[],u=_.groupBy(e,function(f){return f.visualUpdateSource});for(var c in u){var v=u[c].map(function(f){return(0,ce.H8)(f)});l.push.apply(l,s.onDataViewObjectChanged(v,+c,!1))}b.fF.assertNonEmpty(l,"There should be at least one visual object change"),l.map(function(f){return(0,ce.nH)(r,f)}).forEach(function(f){return n.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)})}else e.forEach(function(f){n.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}else e.forEach(function(f){n.saveVisualContainerGroupProperties(f.objectName,t,r,f.propertySlice,o)}),t.visualAuthoring.raiseVisualContainerGroupChanged(r)},a.prototype.saveVisualContainerProperties=function(e,t,r,i,n){!function(a,e,t,r,i,n){if((0,Z.Vz)(t)){var o=t.config.singleVisual;r.telemetryService&&function(a,e,t,r){var i=e.name;if(a!==U.LQ||i!==U.f4&&i!==U.Zp)if(a===U.yD){var s=void 0;"type"===i?s=""+e.value:"section"===i&&(s=e.value===At.pJ?At.pJ:"custom"),r.logEvent(Ve.Lo,{objectName:a,propertyName:i,newValue:s,visualType:t})}else a===tt&&i===br&&r.logEvent(Ve.Lo,{objectName:a,propertyName:i,newValue:"Custom",visualType:t});else r.logEvent(Ve.Lo,{objectName:a,propertyName:i,newValue:e.value,visualType:t})}(a,e,o.visualType,r.telemetryService),a===U.H&&function(a,e){var t,r=e.visualStylePresetService,i=e.themeService;if(r&&i){var n=null===(t=a.evaluatedObjects)||void 0===t?void 0:t.stylePreset,s=r.getStylePreset(a.visualType,n&&n.name);if(s){var l=i.getVisualStyle({}),u=s.evaluate(l);(0,ve.Gc)(a.objects,u),(0,ve.Gc)(a.vcObjects,u)}}}(o,r),a===U.TY&&function(a){if(a.evaluatedObjects){var e=a.evaluatedObjects.dropShadow;if(e&&e.preset&&e.preset!==pe.$g){var t=(0,Na.X2)(e.preset,e.position);if(t){var r=(0,Ce.cA)(t.angle),i=(0,Ce.cA)(t.shadowDistance),n=(0,Ce.cA)(t.shadowBlur),o=(0,Ce.cA)(t.shadowSpread),s=(0,Ce.cA)(t.transparency);(0,ve.sO)(a.vcObjects,{objectName:U.TY,propertyName:"angle"},null,r),(0,ve.sO)(a.vcObjects,{objectName:U.TY,propertyName:"shadowDistance"},null,i),(0,ve.sO)(a.vcObjects,{objectName:U.TY,propertyName:"shadowBlur"},null,n),(0,ve.sO)(a.vcObjects,{objectName:U.TY,propertyName:"shadowSpread"},null,o),(0,ve.sO)(a.vcObjects,{objectName:U.TY,propertyName:"transparency"},null,s)}}}}(o),a===tt?n.saveSlice(a,e,t):a===U.LQ&&function(a){return _.includes(Qo,a.name)}(e)?function(a,e,t,r){var i=e.config.singleVisual;a.name===U.f4?Ea(i).allowBinnedLineSample=!!a.value:a.name===U.Zp?Ea(i).allowOverlappingPointsSample=!!a.value:Ba(a,e,t,r)}(e,t,r,i):(o.vcObjects=o.vcObjects||{},Zr(a,e,o.vcObjects,r),o.autoSelectVisualType=void 0)}}(e,i,r,t,n,this.visualLevelFormatStringHelperService)},a.prototype.saveVisualContainerGroupProperties=function(e,t,r,i,n){!function(a,e,t,r,i){(0,Z.q4)(t)&&(a===U.LQ&&function(a){return _.includes(ns,a.name)}(e)?Ba(e,t,r,i):(t.objects=t.objects||{},Zr(a,e,t.objects,r)))}(e,i,r,t,n)},a.prototype.revertVisualSlicesToDefinitions=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:r=[],i=(0,ce.Wx)(e),n=0,o=i,v.label=1;case 1:return n<o.length?(r.push(l=(s=o[n]).canvasItem),u=s.descriptors,c=void 0,(0,Z.Vz)(l)?((c=(d=l.config.singleVisual).vcObjects)||(d.vcObjects=c={}),[4,this.resetVisualProperty(l,u)]):[3,3]):[3,6];case 2:return v.sent(),[3,4];case 3:(c=l.objects)||(l.objects=c={}),v.label=4;case 4:(0,ce.Aw)(c,u),v.label=5;case 5:return n++,[3,1];case 6:return this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t}),[2]}})})},a.prototype.resetVisualProperty=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n;return(0,p.__generator)(this,function(o){switch(o.label){case 0:r=0,i=t,o.label=1;case 1:return r<i.length?(n=i[r]).objectName!==tt?[3,3]:[4,this.visualLevelFormatStringHelperService.resetProperty(e,n.propertyName)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},a.prototype.resolvePlaceholder=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,p.__generator)(this,function(s){switch(s.label){case 0:if(!(0,S.Xo)(e))return[3,9];switch(e.name){case"actions":return[3,1];case"title":return[3,3];case"sizeAndStyle":return[3,5]}return[3,7];case 1:return[4,this.resolveActionCardPlaceholder(t,e.suppressDefaultValue)];case 2:return r=s.sent(),[3,8];case 3:return[4,this.resolveTitleCardPlaceholder(t)];case 4:return r=s.sent(),[3,8];case 5:return[4,this.resolveVisualSizeAndStyleCardPlaceholder(t)];case 6:return r=s.sent(),[3,8];case 7:b.fF.assertNever(e.name),s.label=8;case 8:return b.fF.assert(function(){return!!r||e.suppressDefaultValue},"Expected either a placeholder or default value being suppressed"),[2,r];case 9:return(0,S.G8)(e)?(b.fF.assertNever(e.name),[3,15]):[3,10];case 10:return(0,S.Kw)(e)?"stylePreset"===(n=void 0,e.name)?[3,11]:[3,13]:[3,15];case 11:return[4,this.resolveStylePresetSlicePlaceholder(t)];case 12:return n=s.sent(),[3,14];case 13:b.fF.assertNever(e.name),s.label=14;case 14:return[2,n];case 15:return b.fF.assertFail("Unexpected host placeholder"),[2]}})})},a.prototype.resolveActionCardPlaceholder=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var n,o,s,l,u,d,v,h,f,m,g,y,D=this;return(0,p.__generator)(this,function(T){switch(T.label){case 0:return(0,Z.q4)(e)?[2,this.resolveActionCardPlaceholderDefault(t)]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return n=T.sent(),o=e.config.singleVisual.evaluatedObjects,s=pe.fU.visualLink,u=(l=e.config.singleVisual).visualType,this.visualPluginService.capabilities(l.visualType).supportsVisualLink?(d=pe.eJ,v=null!==(r=o?.visualLink)&&void 0!==r?r:{show:!1,type:d},h=null!==(i=v.type)&&void 0!==i?i:d,f=pe.Dy.members().map(function(q){return q.value}),n.applyAllSlicersButton||(h!==pe.cy&&_.remove(f,function(q){return q===pe.cy}),h!==pe.WM&&_.remove(f,function(q){return q===pe.WM})),h!==pe.d8&&h!==pe.Ol&&(!n.drillthroughButtonGA&&(u===Ye.L.basicShape.name||u===Ye.L.image.name)&&_.remove(f,function(q){return q===pe.d8}),!n.navAndDrillthroughActionTypes&&u===Ye.L.actionButton.name&&_.remove(f,function(q){return q===pe.d8||q===pe.Ol})),(u===Ye.L.basicShape.name||u===Ye.L.image.name)&&_.remove(f,function(q){return q===pe.Ol}),(g=v.type===pe.Ol)?[4,this.lazyScopedProvider.get("drillthrough")]:[3,3]):[2,this.resolveActionCardPlaceholderDefault(t)];case 2:g=T.sent(),T.label=3;case 3:return m=g,[2,{item:y=new S.CQ(new S.lg("action"),"Visual_VisualLink",[s.show,s.type,s.bookmark,s.navigationSection,s.drillthroughSection,s.webUrl,s.suppressDefaultTooltip,s.showDefaultTooltip,s.tooltip,s.enabledTooltip,s.disabledTooltip],function(q){return D.localizationService.get(q)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:s.show,value:!!v.show}).build()}).addGroup("action",function(q){var F,N;q.withDisplayName("Visual_VisualLink").addSimpleSlice("type",new S.uY({descriptor:s.type,value:h,filterValues:f}).build());var P,V=[{displayName:function(Le){return Le.get("None")},value:pe.Qi}],O=v.type===pe.rp,E=pe.Qi;if(O){var L=D.bookmarkService.getAllBookmarks(),B=_.map(L,function(Fe){return Fe.name});P=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(V,function(Fe){return Fe.value}),!0),B||[],!0);var x=v.bookmark;x&&-1!==P.indexOf(x)&&(E=x)}q.addSimpleSlice("bookmark",new S.uY({descriptor:s.bookmark,value:E,mergeValues:V,filterValues:P}).build(),function(Fe){return Fe.withDisabled(!O)});var j={displayName:function(Le){return Le.get("None")},value:pe.z1};if(v.type===pe.d8||v.type===pe.Ol){var R=[j],k=D.explorationNavigationService,re=k.getAllSections(),ne=k.getCurrentSection();if(v.type===pe.d8){var J=_.map(re,function(Fe){return Fe.name}),se=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(R,function(Fe){return Fe.value}),!0),_.filter(J,function(Fe){return Fe!==ne.name}),!0),we=null!==(F=v.navigationSection)&&void 0!==F?F:j.value;q.addSimpleSlice("pageNavigationDestination",new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},s.navigationSection),{instanceKind:n.drillthroughButtonGA?3:1}),value:we,filterValues:se,mergeValues:R}).build())}else if(v.type===pe.Ol){var $e=_.filter(re,function(Le){return m&&!_.isEmpty(m.getDrillthroughParameters(Le.name))}),Xe=_.map($e,function(Le){return Le.name}),Ue=(se=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(R,function(Le){return Le.value}),!0),_.filter(Xe,function(Le){return Le!==ne.name}),!0),null!==(N=v.drillthroughSection)&&void 0!==N?N:j.value);q.addSimpleSlice("drillthroughDestination",new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},s.drillthroughSection),{instanceKind:n.drillthroughButtonGA?3:1}),value:Ue,filterValues:se,mergeValues:R}).build())}}else q.addSimpleSlice("defaultDestination",new S.uY({descriptor:s.drillthroughSection,value:(0,p.__assign)((0,p.__assign)({},j),{displayName:D.localizationService.get("None")}),items:[j]}).build(),function(Fe){return Fe.withDisabled(!0)});q.addSimpleSlice("webUrl",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.webUrl),{instanceKind:3}),value:v.webUrl,placeholder:""}).build(),function(Fe){return Fe.withDisabled(v.type!==pe.ZS)})}).addGroup("tooltip",function(q){var F;q.withDisplayName("Tooltip");var N=null===(F=v.showDefaultTooltip)||void 0===F||F,V=n.showDefaultTooltip?!N:!!v.suppressDefaultTooltip;n.suppressDefaultTooltip&&(n.showDefaultTooltip?q.addTopLevelToggle("showDefaultTooltip",function(){return new S.bd({descriptor:s.showDefaultTooltip,value:N}).build()}):q.addSimpleSlice("suppressDefaultTooltip",new S.bd({descriptor:s.suppressDefaultTooltip,value:!!v.suppressDefaultTooltip}).build())),v.type!==pe.Ol?q.addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.tooltip),{instanceKind:3}),value:v.tooltip,placeholder:v.tooltipPlaceholderText}).build(),function(P){return P.withCustomDisplayName("Text").withDisabled(V)}):q.addSimpleSlice("enabledText",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.enabledTooltip),{instanceKind:n.drillthroughButtonGA?3:1}),value:v.enabledTooltip,placeholder:""}).build(),function(P){return P.withCustomDisplayName("Enabled_Text").withDisabled(V)}).addSimpleSlice("disabledText",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.disabledTooltip),{instanceKind:n.drillthroughButtonGA?3:1}),value:v.disabledTooltip,placeholder:""}).build(),function(P){return P.withCustomDisplayName("Disabled_Text").withDisabled(V)})}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:y.revertToDefaultDescriptors}]}})})},a.prototype.resolveTitleCardPlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return(0,Z.q4)(e)?[2]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=n.sent(),r=this.getCardBuildingOptions(e,t),b.fF.assert(function(){return!1===r.isQueryVisualWithoutData},"Expected query visual to have data"),[4,this.getTitleCard(r,t)];case 2:return[2,{item:i=n.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},a.prototype.resolveVisualSizeAndStyleCardPlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=n.sent(),r=this.getCardBuildingOptions(e,t),[4,this.getVisualSizeAndStyleCard(r)];case 2:return[2,{item:i=n.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},a.prototype.resolveStylePresetSlicePlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,i,n,s,l,c=this;return(0,p.__generator)(this,function(d){return(0,Z.Vz)(e)&&(s=this.visualStylePresetService.getStylePreset((t=e.config.singleVisual).visualType,(n=(i=t.evaluatedObjects)&&i.stylePreset)&&n.name))?(l=pe.fU.stylePreset,[2,{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("stylePreset"),"style"),"layout"),control:new S.uY({descriptor:l.name,value:s.name}).build(),localize:function(h){return c.localizationService.get(h)}}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:[l.name]}]):[2]})})},a.prototype.resolveActionCardPlaceholderDefault=function(e){var t,r,i=this;if(!e){var n={objectName:"defaultVisualLinkObject",propertyName:"defaultVisualLinkProperty"},o=((t={})[n.objectName]={properties:(r={},r[n.propertyName]={type:{bool:!0}},r)},t);return{item:new S.CQ(new S.lg("action"),"Visual_VisualLink",[n],function(s){return i.localizationService.get(s)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:n,value:!1}).build()}).withDisabled(!0,"Visual_VisualLink_DisabledReason").build(),objectDescriptors:o,revertToDefaultDescriptors:[n]}}},a.prototype.addAdvancedOptionsGroup=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,s,l,u,c,d,v,h,f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return n=e.evaluatedObjects,s=pe.fU.general,(0,Z.Vz)(i=e.container)?(u=(l=e).capabilities,c=n,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),v=d.schema(void 0).capabilities,h=i.config.singleVisual,(f=v.supportsBinnedLineSample)&&(f=function(a,e,t,r){if(!a?.query||!e||!e.dataViewMappings)return!1;var i=a.query,n=(0,X.i1)(i),o=(0,vo.Lo)(i.projections,e.dataViewMappings,n,r,e.objects,a.objects,i.defn.select(),t);return _.some(o.supportedMappings,function(s){var l=!1;return(0,Ta.oF)(s,{visitRole:function(c){},visitReduction:function(c){l=l||!!c.binnedLineSample}}),l})}(h,u,d,e.featureSwitches)),(m=v.supportsOverlappingPointsSample)&&(m=function(a){return!(!a||!a.dataViewMappings)&&_.some(a.dataViewMappings,function(e){var t=!1;return(0,Ta.oF)(e,{visitRole:function(i){},visitReduction:function(i){t=t||!!i.overlappingPointsSample}}),t})}(u)),t.addGroup("advancedOptions",function(y){var D=c&&c.general;y.withDisplayName(r).addSlicePlaceholder((0,S.Q)("responsive")).addSimpleSlice("keepLayerOrder",new S.bd({descriptor:s.keepLayerOrder,value:!(!D||!D.keepLayerOrder)}).build()),f?y.addSimpleSlice("highDensitySampling",new S.bd({descriptor:s.allowBinnedLineSample,value:!(h.queryOptions&&!1===h.queryOptions.allowBinnedLineSample)}).build(),function(T){l.isQueryVisualWithoutData&&T.withDisabled(!0,"Add_Data_To_Format")}):m&&y.addSimpleSlice("overlappingPointSampling",new S.bd({descriptor:s.allowOverlappingPointsSample,value:!(!m||h.queryOptions&&!1===h.queryOptions.allowOverlappingPointsSample)}).build(),function(T){l.isQueryVisualWithoutData&&T.withDisabled(!0,"Add_Data_To_Format")}),l.isQueryVisualWithoutData||y.addSlicePlaceholder((0,S.Q)("dataVolume"))}),g.label=2;case 2:return[2]}})})},a.prototype.addSizeSlices=function(e,t,r,i){var o=t.evaluatedObjects,s=t.props,l=s.general,u={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("height",function(){return new S.mu({descriptor:l.height,value:u.height,options:{minValue:{type:0,value:me.MinContainerHeight},maxValue:{type:1,value:r.height-u.y},required:{type:2}}}).build()}).addSimpleSlice("width",function(){return new S.mu({descriptor:l.width,value:u.width,options:{minValue:{type:0,value:me.MinContainerWidth},maxValue:{type:1,value:r.width-u.x},required:{type:2}}}).build()}).addSimpleSlice("lockAspect",function(){var d=o&&o[s.lockAspect.show.objectName];return new S.bd({descriptor:s.lockAspect.show,value:!(!d||!d.show)}).build()},function(c){return c.withCustomDisplayName("VisualContainer_Properties_LockAspect")})},a.prototype.addPositionSlices=function(e,t,r,i){var s=t.props.general,l={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("horizontal",function(){return new S.mu({descriptor:s.x,value:l.x,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.width-l.width},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Horizontal")}).addSimpleSlice("vertical",function(){return new S.mu({descriptor:s.y,value:l.y,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.height-l.height},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Vertical")})},a.prototype.addPaddingSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,s,l,u,c,d,v,h,f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return r=(m=t).evaluatedObjects,n=m.container,s=m.props.padding,u=(i=m.capabilities).suppressDefaultTitle,!1!==(l=r?.title||{}).show||null==l.text?(c=n.config.singleVisual,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),l=this.displayNameService.getVisualTitle(c,d,i,l),g.label=2;case 2:return v=!!l.text&&(l.show||!(0,At.xj)(l,u)),h=(0,X.hp)(r?.padding,i,v),f={minValue:{type:0,value:0},maxValue:{type:1,value:20},unitSymbol:Ne.e_},e.addCompositeSlice("padding","Visual_Padding",(new S.uM).withTop({descriptor:s.top,value:h.top,options:f}).withBottom({descriptor:s.bottom,value:h.bottom,options:f}).withLeft({descriptor:s.left,value:h.left,options:f}).withRight({descriptor:s.right,value:h.right,options:f}).build(),function(y){return y.withSuppressDisplayName(!0)}),[2]}})})},a.prototype.addGeneralSizeGroups=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,c,d,h,f=this;return(0,p.__generator)(this,function(m){return r=e.container,i=e.featureSwitches,n=this.formFactorService.getCurrentLayout(),o=r.layouts.withId(n).position,s=(0,X.hP)(o,n,r.parentGroup),l={x:Math.floor(s.x),y:Math.floor(s.y),width:Math.floor(s.width),height:Math.floor(s.height)},1===this.formFactorService.getCurrentLayout()?c={height:Jr.aW,width:Jr.Co}:(d=this.explorationNavigationService.getCurrentSection(),c=d.size),e.featureSwitches.onObject?t.addGroup("sizeAndPosition",function(g){g.withDisplayName("Visual_Size_And_Position"),f.addSizeSlices(g,e,c,l),f.addPositionSlices(g,e,c,l)}):t.addGroup("size",function(g){g.withDisplayName("Visual_BubbleSize"),f.addSizeSlices(g,e,c,l)}).addGroup("position",function(g){g.withDisplayName("Visual_Position"),f.addPositionSlices(g,e,c,l)}),i.vcPadding&&(0,Z.Vz)(r)&&(h=e.isQueryVisualWithoutData,t.addGroup("padding",function(g){return(0,p.__awaiter)(f,void 0,void 0,function(){return(0,p.__generator)(this,function(y){switch(y.label){case 0:return g.withDisplayName("Visual_Padding"),h?[3,2]:[4,this.addPaddingSlice(g,e)];case 1:return y.sent(),[3,3];case 2:g.withDisabled(!0,"Add_Data_To_Format"),y.label=3;case 3:return[2]}})})})),[2]})})},a.prototype.addGeneralStyleGroups=function(e,t){var r,i=this,n=e.allowConditionalFormatting,o=e.container,s=e.evaluatedObjects,u=e.props.background,c=pe.fU.border,d=pe.fU.dropShadow,v=function(y){return i.localizationService.get(y)};if(t.addGroup("background",function(g){var y=s&&s[u.show.objectName];g.withDisplayName("Visual_Background"),(0,Z.Vz)(o)&&e.isQueryVisualWithoutData?g.withDisabled(!0,"Add_Data_To_Format"):g.addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:y&&null!=y.show?y.show:(0,Ei.kB)()}).build()}).addSimpleSlice("color",function(){var q,N={value:null===(q=(y&&null!=y.color?y.color:(0,Ei.WO)()).solid)||void 0===q?void 0:q.color};return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},u.color),{instanceKind:n&&3}),value:N}).build()}).addSimpleSlice("transparency",function(){var q=y&&null!=y.transparency?y.transparency:(0,Ei.x6)();return S.JN.getTransparencySliderBuilder({descriptor:u.transparency,value:q,localize:v}).build()})}),(0,Z.Vz)(o)){var h=(r=e).evaluatedObjects,f=r.visualStyle,m=r.isQueryVisualWithoutData;t.addGroup("visualBorder",function(g){var y,D,T=h&&h.border||{},q=(0,Qa.O4)();g.withDisplayName("VisualBorder"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var F;return new S.bd({descriptor:c.show,value:null!==(F=T.show)&&void 0!==F?F:q.show}).build()}).addSimpleSlice("color",function(){var F,N=null!==(F=T.color)&&void 0!==F?F:q.color,V=N&&N.solid&&N.solid.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.color),{instanceKind:n&&3}),value:void 0!==V?{value:V}:void 0}).build()}).addSimpleSlice("roundedCorners",new S.JN({descriptor:c.radius,value:null!==(y=T.radius)&&void 0!==y?y:q.radius,options:{minValue:{type:0,value:0},maxValue:{type:1,value:30},unitSymbol:Ne.e_},localize:v}).build(),function(F){return F.withCustomDisplayName("VisualContainer_Border_RoundedCorners")}),i.featureSwitchService.featureSwitches.visualBorderWidth&&g.addSimpleSlice("width",new S.mu({descriptor:c.width,value:null!==(D=T.width)&&void 0!==D?D:Qa.GC,options:{minValue:{type:0,value:1},maxValue:{type:1,value:99},unitSymbol:Ne.e_}}).build(),function(F){return F.withCustomDisplayName("Visual_General_Properties_Width")}))}).addGroup("shadow",function(g){var y,D,T,q,F,N,V,P,O=h&&h.dropShadow||{},E=(0,Na.O4)(O,f);g.withDisplayName("Visual_DropShadow"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var B;return new S.bd({descriptor:d.show,value:null!==(B=O.show)&&void 0!==B?B:E.show}).build()}).addSimpleSlice("color",function(){var B,x=null!==(B=O.color)&&void 0!==B?B:E.color,j=x&&x.solid&&x.solid.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},d.color),{instanceKind:n&&3}),value:void 0!==j?{value:j}:void 0}).build()}).addSimpleSlice("offset",new S.uY({descriptor:d.position,value:null!==(y=O.position)&&void 0!==y?y:E.position}).build(),function(B){return B.withCustomDisplayName("Offset")}).addSimpleSlice("position",new S.uY({descriptor:d.preset,value:null!==(D=O.preset)&&void 0!==D?D:E.preset}).build(),function(B){return B.withCustomDisplayName("Visual_Position")}),(null!==(T=O.preset)&&void 0!==T?T:E.preset)===pe.$g&&g.addSimpleSlice("size",new S.JN({descriptor:d.shadowSpread,value:null!==(q=O.shadowSpread)&&void 0!==q?q:E.shadowSpread,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Ne.e_},localize:v}).build()).addSimpleSlice("blur",new S.JN({descriptor:d.shadowBlur,value:null!==(F=O.shadowBlur)&&void 0!==F?F:E.shadowBlur,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Ne.e_},localize:v}).build()).addSimpleSlice("angle",S.JN.getRotationSliderBuilder({descriptor:d.angle,value:null!==(N=O.angle)&&void 0!==N?N:E.angle,localize:v}).build()).addSimpleSlice("distance",new S.JN({descriptor:d.shadowDistance,value:null!==(V=O.shadowDistance)&&void 0!==V?V:E.shadowDistance,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Ne.e_},localize:v}).build()).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:d.transparency,value:null!==(P=O.transparency)&&void 0!==P?P:E.transparency,localize:v}).build()))})}},a.prototype.getPropertiesCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,n,o,s,l,u=this;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return s=[(r=(t=e.props).general).height,r.width,t.lockAspect.show,r.x,r.y,(o=(i=pe.fU).padding).top,o.bottom,o.left,o.right,(n=i.general).keepLayerOrder,n.allowBinnedLineSample,n.allowOverlappingPointsSample],l=new S.CQ(new S.lg("properties"),"Properties",s,function(d){return u.localizationService.get(d)}),[4,this.addGeneralSizeGroups(e,l)];case 1:return c.sent(),[4,this.addAdvancedOptionsGroup(e,l,"AdvancedOptions")];case 2:return c.sent(),[2,l.build()]}})})},a.prototype.getAdvancedOptionsCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o=this;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return i=[(r=pe.fU.general).keepLayerOrder,r.allowBinnedLineSample,r.allowOverlappingPointsSample],n=new S.CQ(new S.lg("advancedOptions"),"AdvancedOptions",i,function(l){return o.localizationService.get(l)}),[4,this.addAdvancedOptionsGroup(e,n)];case 1:return s.sent(),[2,n.build()]}})})},a.prototype.getTitleCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,F,N,V,P=this;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return r=e.allowConditionalFormatting,(0,Z.q4)(i=e.container)||(n=e).isQueryVisualWithoutData?[2]:(u=n.visualStyle,c=(o=n.props).title,d=o.divider,v=o.subTitle,h=o.spacing,f=(l=n.evaluatedObjects)&&l.title||{},m=l&&l.subTitle||{},g=i.config.singleVisual,y=(s=n.capabilities).suppressDefaultTitle,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]);case 1:return D=O.sent(),null==f.text&&(f=this.displayNameService.getVisualTitle(g,D,s,f)),t.vcPadding&&null==m.text&&(m=this.displayNameService.getVisualSubTitle(g,D,s,m))&&f?.isGeneratedText&&m?.isGeneratedText&&(f.text=f.titleComponents.title,m.text=m.titleComponents.subtitle),T=Re.v.create(u),q=(0,Ka.Zi)(f,{size:"fontSize",family:"fontFamily",color:"fontColor"},T,u,void 0,X.Hf,X.o8),F=(new S.UN).withFontFamily({descriptor:c.fontFamily,value:q.family}).withFontSizeProperties({descriptor:c.fontSize,value:q.size.pt}).withBold({descriptor:c.bold,value:f.bold||!1}).withItalic({descriptor:c.italic,value:f.italic||!1}).withUnderline({descriptor:c.underline,value:f.underline||!1}),N=F.build(),(V=new S.CQ(new S.lg("title"),"Title",[c.show,c.text,c.heading,c.fontFamily,c.fontSize,c.bold,c.italic,c.underline,c.fontColor,c.background,c.alignment,c.titleWrap,v.show,v.text,v.heading,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,v.fontColor,v.alignment,v.titleWrap,d.show,d.ignorePadding,d.color,d.width,d.style,h.customizeSpacing,h.spaceBelowSubTitle,h.spaceBelowTitle,h.spaceBelowTitleArea,h.verticalSpacing],function(E){return P.localizationService.get(E)})).withDescription("Visual_TitleDescription").addTopLevelToggle("show",function(){return new S.bd({descriptor:c.show,value:f.show||!(0,At.xj)(f,y)}).build()},function(E){return E.withNoDefaultImpact(y)}),V.addGroup("text",function(E){t.vcPadding&&E.withDisplayName("Title"),E.addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},c.text),{instanceKind:r&&3}),placeholder:"",value:f.text||""}).build(),function(L){return L.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:c.heading,value:f.heading||X.PY}).build(),function(L){return L.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",N).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.fontColor),{instanceKind:r&&3}),value:{value:q.color}}).build(),function(L){return L.withCustomDisplayName("Text_Color")}).addSimpleSlice("backgroundColor",function(){var L,B,x=null===(B=null===(L=f.background)||void 0===L?void 0:L.solid)||void 0===B?void 0:B.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.background),{instanceKind:r&&3}),value:{value:x},isNoFillItemSupported:!0}).build()},function(L){return L.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:c.alignment,value:f.alignment||$a.D.left,mode:"horizontalAlignment"}).build(),function(L){return L.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:c.titleWrap,value:!!f.titleWrap}).build(),function(L){return L.withCustomDisplayName("TextWrap")})}),t.vcPadding?[4,this.getSubTitleGroup(e,t,V,m)]:[3,3];case 2:O.sent(),this.getDividerGroup(e,V),this.getSpacingGroup(e,V),O.label=3;case 3:return[2,V.build()]}})})},a.prototype.getSubTitleGroup=function(e,t,r,i){var n;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,c,d,v,h,f,m,g,y,D,T;return(0,p.__generator)(this,function(q){switch(q.label){case 0:return o=e.allowConditionalFormatting,(0,Z.q4)(s=e.container)?[2]:(c=(l=e).capabilities,d=l.evaluatedObjects,v=l.visualStyle,h=l.props.subTitle,i?[3,2]:(f=s.config.singleVisual,null!=(i=d&&d.subTitle||{}).text?[3,2]:[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]));case 1:m=q.sent(),(i=this.displayNameService.getVisualTitle(f,m,c,i))&&(i.text=null===(n=i?.titleComponents)||void 0===n?void 0:n.subtitle),q.label=2;case 2:return g=Re.v.create(v),y=(0,Ka.Zi)(i,{size:"fontSize",family:"fontFamily",color:"fontColor"},g,v,X.uz,X.Zq,X.o8),D=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:y.family}).withFontSizeProperties({descriptor:h.fontSize,value:y.size.pt}).withBold({descriptor:h.bold,value:i.bold||!1}).withItalic({descriptor:h.italic,value:i.italic||!1}).withUnderline({descriptor:h.underline,value:i.underline||!1}),T=D.build(),r.addGroup("subtitle",function(F){F.withDisplayName("Visual_SubTitle").addTopLevelToggle("show",function(){return new S.bd({descriptor:h.show,value:i.show||!1}).build()}).addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},h.text),{instanceKind:o&&3}),placeholder:"",value:i.text||""}).build(),function(N){return N.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:h.heading,value:i.heading||X.AS}).build(),function(N){return N.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",T).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},h.fontColor),{instanceKind:o&&3}),value:{value:y.color}}).build(),function(N){return N.withCustomDisplayName("Text_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:h.alignment,value:i.alignment||$a.D.left,mode:"horizontalAlignment"}).build(),function(N){return N.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:h.titleWrap,value:!!i.titleWrap}).build(),function(N){return N.withCustomDisplayName("TextWrap")})}),[2]}})})},a.prototype.getDividerGroup=function(e,t){var r,i=(r=e).allowConditionalFormatting,n=r.visualStyle,l=e.evaluatedObjects,u=e.props.divider,c=l&&l.divider||{};t.addGroup("divider",function(d){d.withDisplayName("Visual_Divider").addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:c.show||!1}).build()}).addSimpleSlice("color",function(){var v,h=void 0!==c.color?{value:null===(v=c.color.solid)||void 0===v?void 0:v.color}:{value:n.colorPalette.foregroundNeutralSecondary.value};return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},u.color),{instanceKind:i&&3}),value:h}).build()}).addSimpleSlice("style",new S.uY({descriptor:u.style,value:c.style||ls.Dv.solid}).build()).addSimpleSlice("width",function(){return new S.mu({descriptor:u.width,value:c.width||1,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10},required:{type:2},unitSymbol:Ne.e_}}).build()}).addSimpleSlice("ignorePadding",new S.bd({descriptor:u.ignorePadding,value:!1!==c.ignorePadding}).build())})},a.prototype.getSpacingGroup=function(e,t){var n=e.evaluatedObjects,o=e.props.spacing,s=n&&n.subTitle||{},l=n&&n.divider||{},u=n&&n.spacing||{},h={minValue:{type:0,value:0},maxValue:{type:1,value:10},required:{type:2},unitSymbol:Ne.e_};t.addGroup("spacing",function(f){f.withDisplayName("Visual_Spacing").addSimpleSlice("customizeSpacing",function(){var m;return new S.bd({descriptor:o.customizeSpacing,value:null!==(m=u.customizeSpacing)&&void 0!==m&&m}).build()}),u.customizeSpacing?(f.addSimpleSlice("spaceBelowTitle",function(){return new S.mu({descriptor:o.spaceBelowTitle,value:(0,X.h4)(X.hs.Title,u),options:h}).build()}),s.show&&f.addSimpleSlice("spaceBelowSubTitle",function(){return new S.mu({descriptor:o.spaceBelowSubTitle,value:(0,X.h4)(X.hs.SubTitle,u),options:h}).build()}),l.show&&f.addSimpleSlice("spaceBelowTitleArea",function(){return new S.mu({descriptor:o.spaceBelowTitleArea,value:(0,X.h4)(X.hs.Divider,u),options:h}).build()})):f.addSimpleSlice("verticalSpacing",function(){var m;return new S.mu({descriptor:o.verticalSpacing,value:null!==(m=u.verticalSpacing)&&void 0!==m?m:5,options:h}).build()})})},a.prototype.getVisualSizeAndStyleCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,n,o,s,l,u,c=this;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return r=(t=e.props).general,i=t.background,n=pe.fU.padding,o=pe.fU.border,s=pe.fU.dropShadow,l=function(h){return c.localizationService.get(h)},u=new S.CQ(new S.lg("sizeAndStyle"),"Visual_Size_And_Style",[r.height,r.width,t.lockAspect.show,r.x,r.y,n.top,n.bottom,n.left,n.right,i.show,i.color,i.transparency,o.show,o.color,o.radius,o.width,s.show,s.color,s.transparency,s.position,s.preset,s.shadowSpread,s.shadowBlur,s.angle,s.shadowDistance],l),[4,this.addGeneralSizeGroups(e,u)];case 1:return d.sent(),this.addGeneralStyleGroups(e,u),[2,u.build()]}})})},a.prototype.getEffectsCard=function(e){var t=this,r=e.props.background,i=pe.fU.border,n=pe.fU.dropShadow,s=new S.CQ(new S.lg("effects"),"VisualFormatting_Effects",[r.show,r.color,r.transparency,i.show,i.color,i.radius,i.width,n.show,n.color,n.transparency,n.position,n.preset,n.shadowSpread,n.shadowBlur,n.angle,n.shadowDistance],function(u){return t.localizationService.get(u)});return this.addGeneralStyleGroups(e,s),s.build()},a.prototype.getHeaderIconsCard=function(e){var r,i,t=this,o=e.evaluatedObjects,s=e.exploration,l=e.explorationCapabilities,u=e.featureSwitches;if(!(0,Z.q4)(e.container)){var c=e,d=c.props,v=d.visualHeader,h=d.visualHeaderTooltip,f=o,m=f&&f.visualHeader||{},y=l.visualContainerOptions.useStylableHeader,D=s.settings,T=null!==(r=D?.useEnhancedTooltips)&&void 0!==r?r:u?.forceEnhancedTooltips,q=function(O){return t.localizationService.get(O)},F=new S.CQ(new S.lg("headerIcons"),"VisualContainer_HeaderIcons",[v.show,v.background,v.border,v.foreground,v.transparency,v.showVisualInformationButton,v.showVisualWarningButton,v.showVisualErrorButton,v.showDrillRoleSelector,v.showDrillUpButton,v.showDrillToggleButton,v.showDrillDownLevelButton,v.showDrillDownExpandButton,v.showPinButton,v.showFocusModeButton,v.showSeeDataLayoutToggleButton,v.showOptionsMenu,v.showFilterRestatementButton,v.showTooltipButton,v.showCommentButton,v.showPersonalizeVisualButton,v.showCopyVisualImageButton,v.showSmartNarrativeButton,v.showSetAlertButton,v.showFollowVisualButton,h.type,h.section,h.text,h.fontFamily,h.fontSize,h.bold,h.italic,h.underline,T?h.themedTitleFontColor:h.titleFontColor,T?h.themedBackground:h.background,h.transparency],q),N={show:!0,background:{solid:{color:"#FFF"}},border:{solid:{color:"#FFF"}},transparency:0,foreground:{solid:{color:"#333"}},showVisualInformationButton:!0,showVisualWarningButton:!0,showVisualErrorButton:!0,showDrillRoleSelector:!0,showDrillUpButton:!0,showDrillToggleButton:!0,showDrillDownLevelButton:!0,showDrillDownExpandButton:!0,showPinButton:!0,showFocusModeButton:!0,showSeeDataLayoutToggleButton:!0,showOptionsMenu:!0,showTooltipButton:!1,showFilterRestatementButton:!0,showCommentButton:!0,showPersonalizeVisualButton:!0,showCopyVisualImageButton:!0,showSmartNarrativeButton:!1,showSetAlertButton:!0,showFollowVisualButton:!1};if(F.withDescription("VisualHeader_Toggle_Description").addTopLevelToggle("show",function(){var P;return new S.bd({descriptor:v.show,value:null!==(P=m.show)&&void 0!==P?P:N.show}).build()}),y){var V=null!==(i=m.showTooltipButton)&&void 0!==i?i:N.showTooltipButton;F.addGroup("colors",function(P){var O,E,L=null!==(O=m.background)&&void 0!==O?O:N.background;P.withDisplayName("Visual_Colors").addSimpleSlice("background",function(){var B,j={value:null===(B=L.solid)||void 0===B?void 0:B.color};return new S.BT({descriptor:v.background,value:j}).build()},function(B){return B.withCustomDisplayName("Visual_Background")}).addSimpleSlice("border",function(){var B,x,j=m.border;void 0===j&&(j=m.background),void 0===j&&(j=N.border);var k={value:null===(x=(null!==(B=m.border)&&void 0!==B?B:N.border).solid)||void 0===x?void 0:x.color};return new S.BT({descriptor:v.border,value:k}).build()}).addSimpleSlice("icon",function(){var B,x,R={value:null===(x=(null!==(B=m.foreground)&&void 0!==B?B:N.foreground).solid)||void 0===x?void 0:x.color};return new S.BT({descriptor:v.foreground,value:R}).build()},function(B){return B.withCustomDisplayName("Icon")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:null!==(E=m.transparency)&&void 0!==E?E:N.transparency,localize:q}).build()).build()}).addGroup("icons",function(P){var O,E,L,B,x,j,R,k,re,ne,J,se,we,$e,Xe,Ue,Fe,Le,St,vt;P.withDisplayName("Visual_Tablix_Icons").addSimpleSlice("showVisualInformationButton",new S.bd({descriptor:v.showVisualInformationButton,value:null!==(E=m.showVisualInformationButton)&&void 0!==E?E:N.showVisualInformationButton}).build(),function(Be){return Be.withCustomDisplayName("VisualHeader_ShowVisualInformationButtonLabel")}).addSimpleSlice("showVisualWarningButton",new S.bd({descriptor:v.showVisualWarningButton,value:null!==(L=m.showVisualWarningButton)&&void 0!==L?L:N.showVisualWarningButton}).build(),function(Be){return Be.withCustomDisplayName("VisualHeader_ShowVisualWarningButtonLabel")}).addSimpleSlice("showVisualErrorButton",new S.bd({descriptor:v.showVisualErrorButton,value:null!==(B=m.showVisualErrorButton)&&void 0!==B?B:N.showVisualErrorButton}).build(),function(Be){return Be.withCustomDisplayName("VisualHeader_ShowVisualErrorButtonLabel")}).addSimpleSlice("showDrillRoleSelector",new S.bd({descriptor:v.showDrillRoleSelector,value:null!==(x=m.showDrillRoleSelector)&&void 0!==x?x:N.showDrillRoleSelector}).build()).addSimpleSlice("showDrillUpButton",new S.bd({descriptor:v.showDrillUpButton,value:null!==(j=m.showDrillUpButton)&&void 0!==j?j:N.showDrillUpButton}).build(),function(Be){return Be.withCustomDisplayName("DrillUp")}).addSimpleSlice("showDrillToggleButton",new S.bd({descriptor:v.showDrillToggleButton,value:null!==(R=m.showDrillToggleButton)&&void 0!==R?R:N.showDrillToggleButton}).build(),function(Be){return Be.withCustomDisplayName("DrillDown")}).addSimpleSlice("showDrillDownLevelButton",new S.bd({descriptor:v.showDrillDownLevelButton,value:null!==(k=m.showDrillDownLevelButton)&&void 0!==k?k:N.showDrillDownLevelButton}).build(),function(Be){return Be.withCustomDisplayName("DrillDownLevel")}).addSimpleSlice("showDrillDownExpandButton",new S.bd({descriptor:v.showDrillDownExpandButton,value:null!==(re=m.showDrillDownExpandButton)&&void 0!==re?re:N.showDrillDownExpandButton}).build(),function(Be){return Be.withCustomDisplayName("DrillDownLevelGrouped")}).addSimpleSlice("showPinButton",new S.bd({descriptor:v.showPinButton,value:null!==(ne=m.showPinButton)&&void 0!==ne?ne:N.showPinButton}).build(),function(Be){return Be.withCustomDisplayName("ReportContainer_Pin")}).addSimpleSlice("showFocusModeButton",new S.bd({descriptor:v.showFocusModeButton,value:null!==(J=m.showFocusModeButton)&&void 0!==J?J:N.showFocusModeButton}).build(),function(Be){return Be.withCustomDisplayName("FocusModeVisual_ToolTip")}).addSimpleSlice("showSeeDataLayoutToggleButton",new S.bd({descriptor:v.showSeeDataLayoutToggleButton,value:null!==(se=m.showSeeDataLayoutToggleButton)&&void 0!==se?se:N.showSeeDataLayoutToggleButton}).build(),function(Be){return Be.withCustomDisplayName("VisualHeader_ShowSeeDataLayoutToggleButtonLabel")}).addSimpleSlice("showOptionsMenu",new S.bd({descriptor:v.showOptionsMenu,value:null!==(we=m.showOptionsMenu)&&void 0!==we?we:N.showOptionsMenu}).build(),function(Be){return Be.withCustomDisplayName("Options_Menu")}).addSimpleSlice("showFilterRestatementButton",new S.bd({descriptor:v.showFilterRestatementButton,value:null!==($e=m.showFilterRestatementButton)&&void 0!==$e?$e:N.showFilterRestatementButton}).build(),function(Be){return Be.withCustomDisplayName("Filter")}).addSimpleSlice("showTooltipButton",new S.bd({descriptor:v.showTooltipButton,value:V}).build(),function(Be){return Be.withCustomDisplayName("VisualContainer_HelpTooltip")}),l.annotationsEnabled&&P.addSimpleSlice("showCommentButton",new S.bd({descriptor:v.showCommentButton,value:null!==(Xe=m.showCommentButton)&&void 0!==Xe?Xe:N.showCommentButton}).build());var _t=(O=c.visualKind).isQueryVisual,li=function(a,e,t,r){return!!(a&&e&&t&&t.settings)&&!e.disableInlineExplore&&t.settings.allowInlineExploration&&r}(u,l,s,_t||O.isQnaVisual);li&&P.addSimpleSlice("showPersonalizeVisualButton",new S.bd({descriptor:v.showPersonalizeVisualButton,value:null!==(Ue=m.showPersonalizeVisualButton)&&void 0!==Ue?Ue:N.showPersonalizeVisualButton}).build()),u.copyVisualImage&&u.exportVisualImageTenantEnabled&&P.addSimpleSlice("showCopyVisualImageButton",new S.bd({descriptor:v.showCopyVisualImageButton,value:null!==(Fe=m.showCopyVisualImageButton)&&void 0!==Fe?Fe:N.showCopyVisualImageButton}).build()),u.smartNarrativeVisualContainterButton&&P.addSimpleSlice("showSmartNarrativeButton",new S.bd({descriptor:v.showSmartNarrativeButton,value:null!==(Le=m.showSmartNarrativeButton)&&void 0!==Le?Le:N.showSmartNarrativeButton}).build()),u.reflexPBIVisualToolbarEntry&&P.addSimpleSlice("showSetAlertButton",new S.bd({descriptor:v.showSetAlertButton,value:null!==(St=m.showSetAlertButton)&&void 0!==St?St:N.showSetAlertButton}).build()),u.reflexPBIFollowVisual&&P.addSimpleSlice("showFollowVisualButton",new S.bd({descriptor:v.showFollowVisualButton,value:null!==(vt=m.showFollowVisualButton)&&void 0!==vt?vt:N.showFollowVisualButton}).build())}),V&&F.addGroup("helpTooltip",function(P){var O=(0,p.__assign)({type:Wa.xv,show:!0,text:void 0,section:pe.F},f&&f.visualHeaderTooltip||{}),E=c.visualStyle,L=t.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,B=(0,Ha.UM)(E,T,L,O);P.withDisplayName("VisualContainer_HelpTooltip");var x=B.titleFontProperties,j=[{displayName:function(se){return se.get("None")},value:pe.F}],R=Ra(t.explorationNavigationService)||[],k=(0,p.__spreadArray)((0,p.__spreadArray)([],R,!0),_.map(j,function(J){return J.value}),!0),re=0===R.length;P.addSimpleSlice("type",new S.uY({descriptor:h.type,value:O.type}).build()).addSimpleSlice("section",new S.uY({descriptor:h.section,value:O.section,mergeValues:j,filterValues:k}).build(),function(J){return J.withDisabled(re||O.type!==Wa.Xz)});var ne=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:x.family}).withFontSizeProperties({descriptor:h.fontSize,value:x.size.pt}).withBold({descriptor:h.bold,value:x.weight===Cr.en}).withItalic({descriptor:h.italic,value:x.style===Cr.BF}).withUnderline({descriptor:h.underline,value:x.textDecoration===Cr.f0});P.addSimpleSlice("tooltipText",new S.Jr({descriptor:h.text,placeholder:"VisualContainer_HelpTooltip_TextPlaceholder",value:O.text,localize:function(se){return t.localizationService.get(se)}}).build()).addCompositeSlice("font","Font",ne.build()).addSimpleSlice("textColor",function(){return new S.BT({descriptor:T?h.themedTitleFontColor:h.titleFontColor,value:{value:x.color}}).build()}).addSimpleSlice("background",function(){var se=B.background;return new S.BT({descriptor:T?h.themedBackground:h.background,value:{value:se&&se.solid&&se.solid.color},isNoFillItemSupported:!0}).build()},function(J){return J.withCustomDisplayName("Background_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:h.transparency,value:B.transparency,localize:q}).build())})}return F.build()}},a.prototype.getTooltipsCard=function(e){var r,t=this,n=e.evaluatedObjects,o=e.exploration,s=e.featureSwitches;if(!(0,Z.q4)(e.container)){var l=e;if(!l.isQueryVisualWithoutData){var c=l.capabilities.tooltips;if(c){var T,v=l.props.visualTooltip,f=n&&n.visualTooltip,m=o.settings,g=null!==(r=m?.useEnhancedTooltips)&&void 0!==r?r:s?.forceEnhancedTooltips,y=function(j){return t.localizationService.get(j)},D=new S.CQ(new S.lg("tooltips"),"Role_DisplayName_Tooltips",[v.show,v.type,v.section,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,g?v.themedTitleFontColor:v.titleFontColor,g?v.themedValueFontColor:v.valueFontColor,v.actionFontColor,g?v.themedBackground:v.background,v.transparency],y);T=f&&void 0!==f.show?!!f.show:void 0===c.showByDefault||!!c.showByDefault,D.addTopLevelToggle("show",function(){return new S.bd({descriptor:v.show,value:T}).build()});var q=c.supportedTypes;if(null!=q){var F=l.visualStyle,N=this.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,V=(0,Ha.UM)(F,g,N,f),P=V.titleFontProperties,O=V.valueFontProperties,E=V.actionFontProperties;D.addGroup("options",function(x){var j,k=(j=function(a,e,t,r){var n,i=[];for(var o in a)if(a[o]){var l=e[o];i.push(l),l===t&&(n=l)}return b.fF.assert(function(){return!_.isEmpty(i)},"No valid values were found"),void 0===n&&(n=r,b.fF.assert(function(){return _.some(i,function(u){return u===r})},"Default value is not supported")),{selectedValue:n,validValues:i}}(q,{default:At.gA,canvas:At.Xz},f&&f.type,q.canvas?At.Xz:At.gA),j.selectedValue),re=j.validValues,ne=[{displayName:function($e){return $e.get("Visual_Auto")},value:At.pJ}],J=(0,p.__spreadArray)((0,p.__spreadArray)([],Ra(t.explorationNavigationService)||[],!0),_.map(ne,function(we){return we.value}),!0),se=f&&f.section||At.pJ;x.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("type",new S.uY({descriptor:v.type,value:k,filterValues:re}).build()).addSimpleSlice("section",new S.uY({descriptor:v.section,value:se,mergeValues:ne,filterValues:J}).build(),function(we){return we.withDisabled(k!==At.Xz)})});var B=(new S.UN).withFontFamily({descriptor:v.fontFamily,value:P.family}).withFontSizeProperties({descriptor:v.fontSize,value:P.size.pt}).withBold({descriptor:v.bold,value:P.weight===Cr.en}).withItalic({descriptor:v.italic,value:P.style===Cr.BF}).withUnderline({descriptor:v.underline,value:P.textDecoration===Cr.f0}).build();return s.defaultTooltipFormatting&&D.addGroup("text",function(x){x.withDisplayName("Text").addCompositeSlice("font","Font",B).addSimpleSlice("labelColor",function(){return new S.BT({descriptor:g?v.themedTitleFontColor:v.titleFontColor,value:{value:P.color}}).build()},function(j){return j.withCustomDisplayName("Role_DisplayName_LabelColor")}).addSimpleSlice("valueColor",function(){return new S.BT({descriptor:g?v.themedValueFontColor:v.valueFontColor,value:{value:O.color}}).build()},function(j){return j.withCustomDisplayName("Value_Color")}),g&&x.addSimpleSlice("drillTextAndIconColor",new S.BT({descriptor:v.actionFontColor,value:{value:E.color}}).build(),function(j){return j.withCustomDisplayName("Visual_Action_FontColor")})}).addGroup("background",function(x){x.withDisplayName("Visual_Background").addSimpleSlice("color",function(){var R=V.background;return new S.BT({descriptor:g?v.themedBackground:v.background,value:{value:R&&R.solid&&R.solid.color},isNoFillItemSupported:!0}).build()},function(j){return j.withCustomDisplayName("Generic_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:V.transparency,localize:y}).build())}),D.build()}}}}},a.prototype.getAltTextCard=function(e){var t=this,r=e.allowConditionalFormatting,i=e.evaluatedObjects,o=e.props.general,s=new S.CQ(new S.lg("altText"),"Visual_General_Properties_Description",[o.altText],function(l){return t.localizationService.get(l)});return s.addGroup(void 0,function(l){l.addSimpleSlice("altText",function(){var u=i&&i[o.altText.objectName],c=u&&u.altText||"";return new S.Jr({descriptor:(0,p.__assign)((0,p.__assign)({},o.altText),{instanceKind:r&&3}),value:c,placeholder:"Visual_General_Properties_Description_Placeholder",localize:function(v){return t.localizationService.get(v)}}).build()})}),s.build()},a.prototype.getVisualLevelFormattingCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(n){return(0,Z.q4)(t=e.container)||!(r=e).visualKind.isQueryVisual||r.isQueryVisualWithoutData?[2]:[2,this.visualLevelFormatStringHelperService.getVisualLevelFormatStringCard(t,r.capabilities)]})})},a.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,Z.Vz)(e)){var n=e.config.singleVisual;r=n.visualType,i=n.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(qi.F),w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Wr.O),w.\u0275\u0275inject(Ri.U),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(jr),w.\u0275\u0275inject(Fi.F),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Pr.f),w.\u0275\u0275inject(us.kc),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(ri.f),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(xr.A),w.\u0275\u0275inject(Oa),w.\u0275\u0275inject(gi,8))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),ni=C(30794),de=C(14172),lr=C(61617),wr=C(89535),cs=C(2863),ps=C(21302),vs=C(78778),Xa=C(29804),Za=C(22921),oi=[{objectName:pe.fU.stylePreset.name.objectName,descriptor:pe.XW.stylePreset}],Ja=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f,m){this.analyticsFormattingService=e,this.dataSources=t,this.explorationNavigation=r,this.featureSwitchService=i,this.formattingSliceTransformerService=n,this.formFactor=o,this.legacyVisualFormattingService=s,this.localizationService=l,this.modernDialogService=u,this.runningVisualService=c,this.selectionService=d,this.visualAuthoring=v,this.visualPluginOperationsService=h,this.visualPluginService=f,this.formattingObjectDefinitionsService=m}return a.prototype.getFormattingModel=function(e){var t;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return(0,Z.q4)(e)?(i={cards:[]},this.featureSwitchService.featureSwitches.onObject&&(r=this.getVisualSizeAndStylePlaceholder(),i.cards.push(r)),[2,i]):[3,1];case 1:return[4,this.getVisualFormatPaneViewModel(e)];case 2:return i=s.sent(),!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting()?[2,i]:[3,3];case 3:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 4:return n=s.sent(),[2,(0,p.__assign)((0,p.__assign)({},i),{cards:(0,p.__spreadArray)((0,p.__spreadArray)([],i.cards,!0),null!==(t=n?.cards)&&void 0!==t?t:[],!0)})]}})})},a.prototype.getPivotDisplayName=function(e){return ce.um(e,this.featureSwitchService)},a.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:this.getPivotDisplayName(e)}},a.prototype.saveProperties=function(e,t,r,i){if((0,Z.q4)(r))b.fF.assertFail("Visual pivot does not support VisualContainerGroup");else{this.formFactor.getCurrentLayout();if(this.featureSwitchService&&this.featureSwitchService.featureSwitches.updateFormattingPaneObjects){var o=(0,Xa.z)(),s=this.runningVisualService.getVisual(r),l=r.config.singleVisual.visualType,u=[];b.fF.assert(function(){return _.every(e,function(y){return null!=y.visualUpdateSource})},"All changes should have a visual update source");var c=_.groupBy(e,function(y){return y.visualUpdateSource});for(var d in c){var h=c[d].map(function(y){return ce.H8(y)});u.push.apply(u,s.onDataViewObjectChanged(h,+d,!0))}b.fF.assertNonEmpty(u,"There should be at least one visual object change");var m,f=u.map(function(y){return ce.nH(r,y)});_.forEach(f,function(y){m||(m=ce.m7(y.objectName,y.propertySlice.name,l,t)),Di(y.objectName,y.propertySlice,r,t,0,y.hasDynamicExpressionSupport)}),m&&ce.zS(t.visualSync,r);var g=(0,Xa.z)();b.fF.assert(function(){return g-o<50},"Updating multiple object definitions should not take more than 50 milliseconds")}else _.forEach(e,function(y){Di(y.objectName,y.propertySlice,r,t,0,y.hasDynamicExpressionSupport,!0)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}},a.prototype.revertVisualSlicesToDefinitions=function(e,t){this.revertVisualBasedSlicesToDefinitions(e,t),this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&this.analyticsFormattingService.revertVisualSlicesToDefinitions(e,t)},a.prototype.revertVisualBasedSlicesToDefinitions=function(e,t){for(var r=[],n=0,o=(0,ce.Wx)(e);n<o.length;n++){var s=o[n],l=s.canvasItem;r.push(l);var u=s.descriptors,c=void 0;if((0,Z.Vz)(l)){var d=l.config.singleVisual;(c=d.objects)||(d.objects=c={});var v=d.vcObjects;if(v){for(var h=[],f=function(q){var F=u.findIndex(function(V){return V.objectName===q.objectName});if(-1===F)return"continue";var N=u.splice(F,1)[0];h.push(N)},m=0,g=oi;m<g.length;m++)f(g[m]);_.isEmpty(h)||ce.Aw(v,h)}}else(c=l.objects)||(l.objects=c={});if((0,Z.Vz)(l)){if(l.config.singleVisual.visualType===Ye.L.shapeMap.name){var D=u.findIndex(function(T){return T.objectName===Za.L.dataPoint.fillRule.objectName&&T.propertyName===Za.L.dataPoint.fillRule.propertyName});D>-1&&(u.splice(D,1),(0,_r._8)("revertToDefault",!1,c))}ce.Aw(c,u)}else ce.Aw(c,u)}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},a.prototype.getObjectDescriptors=function(e){var t=this.getVisualObjectDescriptors(e);if(!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting())return t;var r=this.analyticsFormattingService.getObjectDescriptors(e);return(0,p.__assign)((0,p.__assign)({},t),r)},a.prototype.getVisualObjectDescriptors=function(e){if((0,Z.q4)(e))return{};for(var n=(0,p.__assign)({},this.visualPluginService.capabilities(e.config.singleVisual.visualType).objects),o=function(d){b.fF.assert(function(){return!n[d.objectName]},"Existing descriptor"),n[d.objectName]=d.descriptor},s=0,l=oi;s<l.length;s++)o(l[s]);return n},a.prototype.getObjectDefinitions=function(e,t){var i,r=this.getVisualObjectDefinitions(e,t);return this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&(i=this.analyticsFormattingService.getObjectDefinitions(e,t)),r&&i?(0,p.__assign)((0,p.__assign)({},r),i):r||i||void 0},a.prototype.getVisualObjectDefinitions=function(e,t){if(!(0,Z.q4)(e)){var r=void 0,i=void 0;if(t&&this.formattingObjectDefinitionsService)r=this.formattingObjectDefinitionsService.getObjectDefinitions(e),i=this.formattingObjectDefinitionsService.getVcObjectDefinitions(e);else{var n=e.config.singleVisual;r=n.objects,i=n.vcObjects}if(i){for(var o=!1,s=(0,p.__assign)({},r||{}),l=0,u=oi;l<u.length;l++){var d=u[l].objectName,v=i[d];v&&(o=!0,s[d]=v)}if(o)return s}return r}},a.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,Z.Vz)(e)){var n=e.config.singleVisual;r=n.visualType,i=n.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},a.prototype.resolvePlaceholder=function(e,t){if(!(0,Z.q4)(t)){var r=this.runningVisualService.getVisual(t),i=this.getVisualAdapter(r),n=i&&i.resolveFormattingPlaceholder&&i.resolveFormattingPlaceholder(e);return n?(0,p.__assign)((0,p.__assign)({},n),{objectDescriptors:this.getObjectDescriptors(t)}):e.suppressDefaultValue?void b.fF.assertFail("Expected either a placeholder or default value being suppressed"):this.resolvePlaceholderDefault(e)}b.fF.assertFail("Unexpected placeholder")},a.prototype.resolvePlaceholderDefault=function(e){if((0,S.ie)(e))b.fF.assertNever(e.name);else if((0,S.LY)(e))b.fF.assertNever(e.name);else if((0,S.n$)(e))switch(e.name){case"responsive":return this.resolveResponsivePlaceholder();case"dataVolume":return;default:b.fF.assertNever(e.name)}else b.fF.assertFail("Unexpected placeholder type")},a.prototype.resolveResponsivePlaceholder=function(){var e=this,t=Ft.p.general.responsive,r={general:{properties:{responsive:ke.iD.responsive}}};return{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new S.bd({descriptor:t,value:!1}).build(),localize:function(n){return e.localizationService.get(n)}}).withDisabled(!0).build(),objectDescriptors:r,revertToDefaultDescriptors:[t]}},a.prototype.getVisualAdapter=function(e){return e&&e.getAdapter()},a.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,Z.q4)(e))return{messageKey:void 0};if((0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if(ce.D1(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},a.prototype.getVisualFormatPaneViewModel=function(e){var t,r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return ce.D1(e)?[2,{cards:[]}]:(o=(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))?[3,6]:(n=this.runningVisualService.getVisual(e),null==(s=this.getVisualAdapter(n))||n.getHasPendingChanges()||n.getErrorInfo()?[2,{cards:[]}]:n&&n.getType()===e.config.singleVisual.visualType?s.getFormattingModelAsync?[4,s.getFormattingModelAsync()]:[3,2]:[3,5]);case 1:return u=m.sent(),[3,3];case 2:u=null===(t=s.getFormattingModel)||void 0===t?void 0:t.call(s),m.label=3;case 3:return(i=u)?[3,5]:[4,this.legacyVisualFormattingService.getFormattingModel(e)];case 4:i=m.sent(),m.label=5;case 5:i=this.filterOutAnalyticsCards(i),m.label=6;case 6:if(this.featureSwitchService.featureSwitches.onObject)c=this.getTitlePlaceholder(),d=this.getVisualSizeAndStylePlaceholder(),i=(0,p.__assign)((0,p.__assign)({},i||{}),{cards:(0,p.__spreadArray)((0,p.__spreadArray)([d],o?[]:[c],!0),null!==(r=i?.cards)&&void 0!==r?r:[],!0)});else if(!i||0===i.cards.length)return[2,{cards:[]}];return o||(v=this.getFormattingModelMessage(e),h=Ua(n),f=n&&n.getWarnings$().pipe((0,de.U)(function(g){return ka(g)})),(v||h)&&(i=(0,p.__assign)((0,p.__assign)({},i),{warnings:h,warnings$:f}))),[2,i]}})})},a.prototype.getTitlePlaceholder=function(){return(0,S.UH)("title")},a.prototype.isInMobileFormatting=function(){return 1===this.formFactor.getCurrentLayout()},a.prototype.getVisualSizeAndStylePlaceholder=function(){return(0,S.UH)("sizeAndStyle")},a.prototype.filterOutAnalyticsCards=function(e){if(e){var t=e.cards.filter(function(r){return!r.analyticsPane});return(0,p.__assign)((0,p.__assign)({},e),{cards:t})}},a.prototype.getFormattingModelMessage=function(e){if(!(0,Z.q4)(e)){var t=e.config.singleVisual.visualType,r=this.featureSwitchService.featureSwitches.shapeVisual,i=this.formFactor.getCurrentLayout();if("basicShape"===t&&r&&1!==i){var n=this.createShowDialogServices();return{messageKey:"ConvertShape_PropPaneMessage",action:{key:"Convert",fn:function(){return a.showDialog(t,n,vs.al)}}}}}},a.prototype.createShowDialogServices=function(){return{dataSources:this.dataSources,explorationNavigation:this.explorationNavigation,localizationService:this.localizationService,modernDialogService:this.modernDialogService,selection:this.selectionService,visualAuthoring:this.visualAuthoring}},a.showDialog=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,g,y,D,T,q,F;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return"basicShape"===(s=[],l=[],e)&&(i="ConvertShape_DialogConvertAll",n="ConvertShape_DialogTitle",o="ConvertShape_DialogMessage",s=t.explorationNavigation.getAllVisualContainers(e),l.push("basicShape"),u="shape",c="340px"),d={convertAll:{label:i}},v=t.localizationService.get("Undo"),h={titleText:n,messageTemplate:t.localizationService.format(o,"<b>"+v+"</b>"),okButtonText:"Convert",cancelButtonText:"Cancel_ButtonText",checkboxes:d},[4,t.modernDialogService.openHostDialog({dialogName:"CheckboxDialog",componentName:r,bindings:h,config:{panelClass:["checkbox-dialog"],width:c,autoFocus:!0}})];case 1:return[4,N.sent().afterClosed().toPromise()];case 2:if(!(g=N.sent())||0!==g.result)return[2];if(y=[],g.checkboxes.convertAll)y=s;else for(D=Sa.UP.getSelectedCanvasItems(t.selection),T=0,q=D;T<q.length;T++)(0,Z.Vz)(F=q[T])&&l.includes(F.config.singleVisual.visualType)&&y.push(F);return t.visualAuthoring.convertMultiple(y,t.dataSources.get(),u),[2]}})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(Ii),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(jr),w.\u0275\u0275inject(Fi.F),w.\u0275\u0275inject(Ni),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(qa.x),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Ir.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(ri.f),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(gi,8))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),en=C(63387),tn=C(64370),rn=C(29748),an=C(42587),fs=C(75570),nn=C(2911);function ms(a,e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d,v,h,m,g,D,T,q,V,P,O,E=this;return(0,p.__generator)(this,function(L){switch(L.label){case 0:return r=[],i=a.dataSourcesService,n=a.conceptualSchemaProxy,o=a.localizationService,s=a.changeDetectionMeasure,l=a.telemetryService,b.fF.assert(function(){return!!i},"options.dataSourcesService should not be null or undefined for CDM propertypane card"),b.fF.assert(function(){return!!n},"options.conceptualSchemaProxy should not be null or undefined for CDM propertypane card"),b.fF.assert(function(){return!!s},"options.changeDetectionMeasure should not be null or undefined for CDM propertypane card"),u=i.get(),[4,n.get(u)];case 1:if(!(c=L.sent()))return[2,[]];for(d=!1,v=0,h=c.schemas;v<h.length;v++)for(m=0,g=h[v].entities;m<g.length;m++)for(D=function(x){if(x.measure&&x.measure.changeDetectionMetadata){var j=(0,nn.bW)(x.measure.changeDetectionMetadata.refreshInterval),R=(0,nn.ei)(j);b.fF.assert(function(){return 1===R.length}," Expecting only 1 ISODurationString");var k=(0,fs.u6)(R[0],o);return r=r.concat(t.getMeasureAndCheckEverySlices(x.name,k,o,e)),d=!0,"break"}},T=0,q=g[m].properties;T<q.length&&"break"!==D(q[T]);T++);return a.explorationCapabilities.getCapabilities().disableChangeDetectionDialog||(V=function(){return(0,p.__awaiter)(E,void 0,void 0,function(){return(0,p.__generator)(this,function(x){return l.logEvent(Ve._m,{launchPoint:"PropertyPane"}),s.showDialog(),[2]})})},P=(0,Pe.Gf)((0,De.V)(d?"ChangeDetectionEditLink":"ChangeDetectionAddLink"),a.localizationService),O=o.get(d?"Link_Button_Edit_Aria_Value":"Link_Button_Add_Aria_Value"),r.push(t.getAddCDMDialogSlice(P,e,V,O))),[2,r]}})})}function gs(a,e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(r){switch(r.label){case 0:return[4,ms(a,e,{getAddCDMDialogSlice:ys,getMeasureAndCheckEverySlices:Ss})];case 1:return[2,r.sent()]}})})}function ys(a,e,t,r){var i=Ie.js.pageRefresh.dialogLauncher;return(new S.q6).withDisplayName(a,void 0,!0).withUid(i).withDisabled(e).withControlProperties(new S.Vc({descriptor:i,value:t,ariaLabel:r}).build()).build()}function Ss(a,e,t,r){var i=Ie.js.pageRefresh.measure,n=(new S.q6).withDisplayName(t.get("NewMeasureName")).withUid(i).withDisabled(r).withControlProperties(new S.G_({descriptor:i,value:a}).build()).build(),o=Ie.js.pageRefresh.checkEvery;return[n,(new S.q6).withDisplayName(t.get("CheckEvery")).withUid(o).withDisabled(r).withControlProperties(new S.G_({descriptor:o,value:e}).build()).build()]}var _s=C(14463),Ut=C(6236),bs=C(68507),He=C(9480),Ge=C(8590),Or=C(78417),Ui=C(73795),Zt=C(64329),Mr=C(49977),Cs=C(28199),on=C(41114),sn="PBI.Data.GetPerspectives",ln=on.cx[sn]=(0,on.b1)(sn),ws=C(80688),Ds=C(60225),ki=C(48787),qs=C(17653),Dr=C(57243),Fs=C(81213),Ns=function(){function a(e,t,r,i){this.errorService=e,this.localizationService=t,this.perspectivesReader=r,this.telemetryService=i,this.perspectivesCache={}}return a.prototype.get=function(e){var t=this,i=e.filter(function(u){return"dsr"===u.type})[0];if(!i){this.telemetryService.startEvent(ln,{dataSourceObjectId:""}).reject({errorMessage:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),errorCode:"NoValidDataSourceProvided",errorSource:"PowerBI"});var n={message:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),code:"NoValidDataSourceProvided",details:{source:"PowerBI"}};return(0,Ds._)(n)}var o=this.telemetryService.startEvent(ln,{dataSourceObjectId:i.objectId}),s=this.perspectivesCache[i.objectId];if(s)return s;var l=this.perspectivesReader.get(i).pipe((0,ki.q)(1),(0,qs.b)(function(){return o.resolve()},function(u){t.perspectivesCache[i.objectId]=void 0,o.reject({errorMessage:u.message,errorCode:u.code,errorSource:"PowerBI"}),t.errorService.error(u.message,u.code,u.details)}),(0,Dr.d)(1));return this.perspectivesCache[i.objectId]=l,l},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(Fs.T),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(ws.c),w.\u0275\u0275inject(Lt.y0))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"}),a}(),Ts=C(84669),Vs=C(28016),un=C(11494),Ps=C(52298),cn=C(16524),pn=C(18363),vn=C(69071),si="linkType-",fn=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,F,N,V,P,O,E,L,B){var x=this;this.promiseFactory=e,this.aggrOps=t,this.canvasScale=r,this.changeDetectionMeasure=i,this.conceptualSchemaProxy=n,this.contextActivityService=o,this.dataSources=s,this.displayNameService=l,this.eventBridge=u,this.explorationCapabilities=c,this.explorationNavigation=d,this.featureSwitchService=v,this.formattingSliceTransformerService=h,this.layoutAuthoring=f,this.lazyScoped=m,this.linguisticSchemaProxy=g,this.localizationService=y,this.perspectivesService=D,this.resourceLoader=T,this.resourceRegistration=q,this.telemetryService=F,this.themeService=N,this.undoRedo=V,this.visualAuthoring=P,this.visualPlugin=O,this.visualStylePresetService=E,this.visualSync=L,this.trustedVisualService=B,this.eventsSubscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(Ge.yVh,function(){x.previousSizeType=void 0,x.sectionCustomWidth=void 0,x.sectionCustomHeight=void 0;var j=x.explorationNavigation.getCurrentSection();x.isCustomPageSize=(0,xt.Y9)(j.size,x.explorationNavigation)===He.t.Custom}),this.linkFieldTypeAsCategorized={value:"categorized",displayName:this.localizationService.get("LinkField_AsAggregationDisabledText")},this.linkFieldTypeAsSummarized={value:"summarized",displayName:this.localizationService.get("LinkField_AsAggregationEnabledText")},this.pageTypeOptions=[{displayName:this.localizationService.get("Standard"),value:0},{displayName:this.localizationService.get("Tooltip"),value:1},{displayName:this.localizationService.get("Drillthrough_OneWord"),value:2}]}return a.prototype.ngOnDestroy=function(){this.eventsSubscriptionManager.unsubscribeAll()},a.prototype.getFormattingModel=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t,r,i,n,o,s,l,c,v,h,f,m,g;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return t={cards:e=[]},r=this.explorationNavigation.getCurrentSection(),i=this.dataSources.get(),r&&i?[4,this.conceptualSchemaProxy.get(i)]:[3,6];case 1:return n=y.sent(),o=_.map(n.schemas,function(D){return D.capabilities}).filter(function(D){return!!D}),l=(s=e).push,[4,this.populatePageInformation(r)];case 2:return l.apply(s,[y.sent()]),e.push(this.populateCanvasSettings(r)),e.push(this.populateCanvasBackground(r)),e.push(this.populateWallpaper(r)),e.push(this.populateFilterPane(r)),e.push(this.populateFilterCard(r)),this.explorationCapabilities.getCapabilities().disableInlineExplore?[3,4]:(c=this.explorationNavigation.getCurrentExploration())&&c.settings&&c.settings.allowInlineExploration?(h=(v=e).push,[4,this.populatePersonalizeVisual(r)]):[3,4];case 3:h.apply(v,[y.sent()]),y.label=4;case 4:return this.featureSwitchService.featureSwitches.realTimeRefresh&&!this.featureSwitchService.featureSwitches.realTimeRefreshDisabled&&_.some(o,function(D){return D.supportsFastRefresh})?(f=_.some(o,function(D){return D.supportChangeDetectionMeasureRefresh}),g=(m=e).push,[4,this.populatePageRefresh(r,f)]):[3,6];case 5:g.apply(m,[y.sent()]),y.label=6;case 6:return[2,t]}})})},a.prototype.getObjectDescriptors=function(){return Ie.C7},a.prototype.saveProperties=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,m,g,y,D,T,q,F,V,P,O,E,L,B,j,R;return(0,p.__generator)(this,function(J){switch(J.label){case 0:return b.fF.assert(function(){return 1===_.size(e)},"We do not support saving multiple property changes to the page right now. Add your support if need."),1!==_.size(e)?[2]:(i=e[0].objectName,n=e[0].propertySlice,o=this.getPagePropertyPaneSaveServices(),s=this.explorationNavigation.getCurrentExploration(),l=this.explorationNavigation.getCurrentSection(),n.name!==ze.PageSizeTypeName?[3,2]:(u=n.value,T=this.savePageProperties(n,i,t,o),this.isCustomPageSize=u===He.t.Custom,u!==He.t.Tooltip&&(this.previousSizeType=u),this.isCustomPageSize&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height),c=this.checkIfPageInformationTypeNeedsUpdate(u,l),d=void 0,c&&(v=!this.featureSwitchService.featureSwitches.onObject||(null===(r=_.find(this.pageTypeOptions,function(se){return 1===se.value}))||void 0===r?void 0:r.value),h=(0,p.__assign)((0,p.__assign)({},n),{name:ze.PageInformationType,value:v}),d=this.savePageProperties(h,ze.PageInformationCardName,t,o)),[4,Promise.all([d,T])]));case 1:return[2,(B=J.sent()).every(function(se){return se})];case 2:return n.name===ze.PageInformationType&&_.isEmpty(l.visualContainers)?(m=void 0,this.featureSwitchService.featureSwitches.onObject?(g=n.value,b.fF.assert(function(){return null!=g},"propertyPaneSlice.value for page type cannot be null"),m=1===g):m=n.value,y=this.savePageProperties(n,i,t,o),D=(0,xt.Y9)(l.size,this.explorationNavigation),m?(this.isCustomPageSize=!1,null==this.previousSizeType&&(this.previousSizeType=D),D===He.t.Custom&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height)):this.isCustomPageSize=this.previousSizeType?this.previousSizeType===He.t.Custom:D===He.t.Custom,T=void 0,q=void 0,F=void 0,this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,m,l,o)?(V=m?He.t.Tooltip:this.previousSizeType,P=(0,p.__assign)((0,p.__assign)({},n),{name:ze.PageSizeTypeName,value:V}),[4,this.savePageProperties(P,O=ze.PageSizeCardName,t,o)]):[3,4]):[3,6];case 3:T=J.sent(),!m&&this.previousSizeType===He.t.Custom&&(null!=this.sectionCustomWidth&&l.size.width!==this.sectionCustomWidth&&(E=(0,p.__assign)((0,p.__assign)({},n),{name:ze.PageSizeWidthName,value:this.sectionCustomWidth}),q=this.savePageProperties(E,O,t,o)),null!=this.sectionCustomHeight&&l.size.height!==this.sectionCustomHeight&&(L=(0,p.__assign)((0,p.__assign)({},n),{name:ze.PageSizeHeightName,value:this.sectionCustomHeight}),F=this.savePageProperties(L,O,t,o))),J.label=4;case 4:return[4,Promise.all([y,q,F])];case 5:return B=J.sent(),[2,T&&B.every(function(se){return se})];case 6:return n.name===ze.PageSizeWidthName&&(j=n.value,(null==this.sectionCustomWidth||j!==this.sectionCustomWidth)&&(this.sectionCustomWidth=j)),n.name===ze.PageSizeHeightName&&(R=n.value,(null==this.sectionCustomHeight||R!==this.sectionCustomHeight)&&(this.sectionCustomHeight=R)),n.name!==Ie.js.pageInformation.pageInformationDrillthroughKeepAllFilters.propertyName?[3,8]:[4,this.saveDrillthroughFilterPassingModeUpdate(n.value,s,l)];case 7:return J.sent(),[2,!0];case 8:return n.name!==Ie.js.pageInformation.pageInformationDrillthroughCrossReportEnabled.propertyName?[3,10]:[4,this.saveDrillthroughCrossReportModeUpdate(n.value,s,l)];case 9:return J.sent(),[2,!0];case 10:return n.name!==Ie.js.pageInformation.pageInformationDrillthroughFields.propertyName?[3,12]:[4,this.saveDrillthroughFieldsUpdate(n.value,l)];case 11:return[2,J.sent()];case 12:return e[0].uid.includes(si)?(this.saveLinkFieldLinkTypeUpdate(l,e[0]),[2,!0]):[4,this.savePageProperties(n,i,t,o)];case 13:return[2,J.sent()]}})})},a.prototype.saveDrillthroughFilterPassingModeUpdate=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.lazyScoped.get(Mr.Sz)];case 1:return n.sent().setDrillthroughFilterPassingMode(t,r,e),[2]}})})},a.prototype.saveDrillthroughCrossReportModeUpdate=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return[4,this.lazyScoped.get(Mr.Sz)];case 1:return n.sent().setCrossReportDrillthrough(t,r,e),[2]}})})},a.prototype.saveDrillthroughFieldsUpdate=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n;return(0,p.__generator)(this,function(o){return(r=e.fromUpdate)?"add"===r.type?[2,!0]:(i=!1,"delete"===r.type?(n=r.deleted.metadata.boundFilter,_.isEmpty(n)||(i=(0,Ui.ku)(n,1,t,this.visualAuthoring)),[2,i]):[2,!1]):[2]})})},a.prototype.saveLinkFieldLinkTypeUpdate=function(e,t){var r=t.uid,i=r.lastIndexOf(si),n=r.substring(i+9),o=_.find(e.filters,function(u){return u.name===n});o&&this.visualAuthoring.setLinkFieldAsAggregation(o,{scopeType:1,container:e},t.propertySlice.value===this.linkFieldTypeAsSummarized.value)},a.prototype.checkIfSizeTypeNeedsUpdate=function(e,t,r,i){if(!_.isEmpty(r.visualContainers))return!1;var o=void 0!==e,s=(0,xt.Y9)(r.size,i.explorationNavigation);return!!(t&&s!==He.t.Tooltip||!t&&o&&s!==e)},a.prototype.checkIfPageInformationTypeNeedsUpdate=function(e,t){return!(e!==He.t.Tooltip||1===t.type)},a.prototype.revertPageSliceDefinitions=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,n,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return t=this.explorationNavigation.getCurrentExploration(),r=this.explorationNavigation.getCurrentSection(),(0,ce.Aw)(i=r.objects||{},e),r.objects=i,[4,this.lazyScoped.get(Mr.Sz)];case 1:return n=l.sent(),o=Ie.js.pageInformation.pageInformationType,s=Ie.js.pageSize.pageSizeTypes,e&&e.some(function(u){return u.objectName===o.objectName})?[4,this.setPageInformationDefaultValues(t,r,n)]:[3,3];case 2:l.sent(),l.label=3;case 3:return e&&e.some(function(u){return u.objectName===s.objectName})?[4,this.setPageSizeDefaultValues(t,r,n)]:[3,5];case 4:l.sent(),l.label=5;case 5:return this.eventBridge.publishToChannel(Ge.H8N,r),[2]}})})},a.prototype.setPageInformationDefaultValues=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(n){switch(n.label){case 0:return 0===t.type?[3,2]:(gn(0,r,e,t,this.featureSwitchService.featureSwitches.onObject),this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,!1,t,this.getPagePropertyPaneSaveServices())?[4,this.setPageSizeDefaultValues(e,t,r)]:[3,2]);case 1:n.sent(),n.label=2;case 2:return e&&e.pods?[4,(0,Or.QU)(e,t.name,this.linguisticSchemaProxy)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}})})},a.prototype.setPageSizeDefaultValues=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return mn(He.t.Widescreen,t.size,this.eventBridge,r,this.canvasScale.getDisplayOption()),this.isCustomPageSize=!1,this.previousSizeType=i=He.t.Widescreen,this.checkIfPageInformationTypeNeedsUpdate(i,t)?[4,this.setPageInformationDefaultValues(e,t,r)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},a.prototype.getObjectDefinitions=function(){var e=this.explorationNavigation.getCurrentSection();return e?.objects},a.prototype.getRevertToDefaultMetadata=function(){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ce.An)("Page",this.featureSwitchService)}},a.prototype.isPageInformationDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection();if(1&e.type||2&e.type)return!0;var t=this.explorationNavigation.getCurrentExploration();return!(!t||!t.pods)},a.prototype.isPageSizeDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection(),t=(0,xt.Y9)(e.size,this.explorationNavigation),r=(0,xt.MO)(He.t.Widescreen);return!(!this.isCustomPageSize&&t===He.t.Widescreen&&e.size.width===r.width&&e.size.height===r.height)},a.prototype.getRevertToDefaultEnabled=function(e,t){var r=this.getObjectDefinitions();if((0,ce.wW)(e,r,t))return!0;var i=Ie.js.pageInformation.pageInformationType;if(e&&e.some(function(l){return l.objectName===i.objectName})&&this.isPageInformationDefaultValuesChanged())return!0;var o=Ie.js.pageSize.pageSizeTypes;return!(!e||!e.some(function(l){return l.objectName===o.objectName})||!this.isPageSizeDefaultValuesChanged())},a.prototype.populatePageInformation=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,F=this;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return t=function(P){return F.localizationService.get(P)},l=[i=(r=Ie.js.pageInformation).pageInformationName,n=r.pageInformationType,o=r.pageInformationQnaPodEnabled,s=r.pageInformationAltName],this.featureSwitchService.featureSwitches.onObject&&l.push.apply(l,[r.pageInformationDrillthroughKeepAllFilters,r.pageInformationDrillthroughCrossReportEnabled,r.pageInformationDrillthroughFields,r.pageInformationDrillthroughLinkFieldsLinkTypes]),u=new S.lg("pageInformation"),c=new S.CQ(u,"PagePropertyPane_PageInformation",l,t).build(),d=this.explorationNavigation.getCurrentExploration(),[4,(0,Or._3)(d,e.name,this.linguisticSchemaProxy,this.promiseFactory)];case 1:return v=N.sent(),h=new S.mQ(new S.SS(u,"pageInformation"),t).addSimpleSlice(i.propertyName,new S.fq({descriptor:i,value:e.displayName,placeholder:"",validators:{required:{type:2}}}).build(),function(V){return V.withCustomDisplayName("Name")}),this.featureSwitchService.featureSwitches.onObject||(h.addSimpleSlice(n.propertyName,new S.bd({descriptor:n,value:!!(1&e.type)}).build(),function(V){return V.withCustomDisplayName("Allow_As_Tooltip").withCustomDescription("PagePropertyPane_PageInformation_Tooltip_Description")}),h.addSimpleSlice(o.propertyName,new S.bd({descriptor:o,value:!!v}).build(),function(V){return V.withCustomDisplayName("Allow_Qna").withCustomDescription("PagePropertyPane_PageInformation_PodEnabled_Description")}),v&&h.addSimpleSlice(s.propertyName,new S.Jr({descriptor:s,value:v.altNames?v.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:t}).build(),function(V){return V.withCustomDisplayName("Page_Synonyms")}),c.groups.push(h.build())),this.featureSwitchService.featureSwitches.onObject?(f=function(a,e){for(var t,r=1===e.type?2:1,i=[],n=0,o=null!==(t=a.pods)&&void 0!==t?t:[];n<o.length;n++){var s=o[n];if(s.type===r&&s.boundSection===e.name)for(var l=0,u=s.parameters;l<u.length;l++){var c=u[l];c.fieldExpr&&i.push(c)}}return i}(d,e),[4,this.getLinkParameterFilterDisplayNameMappings(f,e)]):[3,5];case 2:return m=N.sent(),g=this.getDrillthroughTooltipControlSettings(d,e),this.addDefaultGroupDrillthroughRelatedSlices(e,f,g,h),c.groups.push(h.build()),D=null==(y=e.type)||0===y,b.fF.assert(function(){return!(D&&!_.isEmpty(f))},"A section in null/Regular type and has drillthrough content should've been upgraded to Drillthrough type already!"),1===y||2===y?[4,this.getLinkFieldsLinkTypeGroup(f,m,g,u,t)]:[3,4];case 3:T=N.sent(),c.groups.push(T),N.label=4;case 4:q=this.getQnaGroup(v,u,t),c.groups.push(q),N.label=5;case 5:return[2,c]}})})},a.prototype.addDefaultGroupDrillthroughRelatedSlices=function(e,t,r,i){var n=this;if(this.featureSwitchService.featureSwitches.onObject){var o=null!=e.type?e.type:0,s=Ie.js.pageInformation,l=s.pageInformationType,u=s.pageInformationDrillthroughKeepAllFilters,c=s.pageInformationDrillthroughCrossReportEnabled,d=s.pageInformationDrillthroughFields;if(i.addSimpleSlice(l.propertyName,new S.uY({descriptor:l,items:this.pageTypeOptions,value:_.find(this.pageTypeOptions,function(f){return f.value===o})}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_PageType").withCustomDescription("PagePropertyPane_PageType_Tooltip")}),1===o||2===o){i.addSimpleSlice(u.propertyName,new S.bd({descriptor:u,value:r.keepAllFilters.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_KeepAllFilters").withCustomDescription(r.keepAllFilters.tooltip,!1).withDisabled(r.keepAllFilters.disabled)}),2===o&&i.addSimpleSlice(c.propertyName,new S.bd({descriptor:c,value:r.crossReportDrillthrough.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_CrossReportDrillthrough").withCustomDescription(r.crossReportDrillthrough.tooltip,!1)});var h={control:{type:"FieldPicker",properties:{descriptor:d,value:{newExpr:_.map(t,function(f){return{expr:f.fieldExpr,metadata:{boundFilter:f.boundFilter}}}),fromUpdate:{type:"initialize"}},validators:void 0,allowMultipleValues:!0,disallowReplaceItems:!0,getDropExprStrategy:{getDropExpr:function(m,g){return(0,p.__awaiter)(n,void 0,void 0,function(){return(0,p.__generator)(this,function(y){switch(y.label){case 0:return[4,this.tryCreateDrillthroughFilter(e,m)];case 1:return[2,y.sent()]}})})},getDroppedExprChildren:function(m,g,y,D){}}}},displayName:r.linkFieldsDropZoneTitle,uid:i.uidBuilder.withSlice(d.propertyName).build()};i.addSlice(h)}}},a.prototype.getLinkParameterFilterDisplayNameMappings=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return _.isEmpty(e)?[2,{}]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return r=o.sent(),i={},_.forEach(e,function(s){var l=_.find(t.filters,function(c){return c.name===s.boundFilter}),u=(0,Ui.eW)(l,{scopeType:1,container:t},r,n.aggrOps,n.displayNameService,n.localizationService,n.visualPlugin);i[s.name]=u}),[2,i]}})})},a.prototype.getLinkFieldsLinkTypeGroup=function(e,t,r,i,n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return o=new S.mQ(new S.SS(i,"pageInformationDrillthroughLinkFieldsLinkTypes"),n).withDisplayName(r.linkFieldsLinkTypeGroupTitle,!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=u.sent(),_.forEach(e,function(c){var h,d=!0,v=!0,f=c.fieldExpr;(0,Ze.kb)(f)?(h=!0,d=!1):Pt.m.discourageAggregation(f,s)?(h=!1,v=!1):h=c.asAggregation;var m=[];d&&m.push(l.linkFieldTypeAsCategorized),v&&m.push(l.linkFieldTypeAsSummarized),o.addSimpleSlice(si+c.boundFilter,new S.uY({descriptor:Ie.js.pageInformation.pageInformationDrillthroughLinkFieldsLinkTypes,items:m,value:h?l.linkFieldTypeAsSummarized:l.linkFieldTypeAsCategorized}).build(),function(D){b.fF.assert(function(){return!_.isEmpty(t[c.name])},"there should be a corresponding filter display name for parameter "+c.name);var q=l.localizationService.format("PagePropertyPane_LinkField_LinkType_FieldName",t[c.name]);D.withCustomDisplayName(q,!1)})}),_.isEmpty(e)&&o.withDisabled(!0,void 0),[2,o.build()]}})})},a.prototype.getQnaGroup=function(e,t,r){var i=Ie.js.pageInformation,n=i.pageInformationQnaPodEnabled,o=i.pageInformationAltName;return new S.mQ(new S.SS(t,"pageInformationQnaPodEnabled"),r).withDisplayName("Allow_Qna").addTopLevelToggle(n.propertyName,function(){return new S.bd({descriptor:n,value:!!e}).build()}).addSimpleSlice(o.propertyName,new S.Jr({descriptor:o,value:e?.altNames?e.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:r}).build(),function(l){return l.withDisabled(!e).withCustomDisplayName("Page_Synonyms")}).build()},a.prototype.populateCanvasSettings=function(e){var t,r=this,i=function(g){return r.localizationService.get(g)},n=(t=Ie.js.pageSize).pageSizeTypes,o=t.pageSizeHeight,s=t.pageSizeWidth,l=Ie.js.displayArea.verticalAlignment,u=new S.CQ(new S.lg("pageSize"),"Canvas_Settings",[n,o,s,l],i),c=this.isCustomPageSize?He.t.Custom:(0,xt.Y9)(e.size,this.explorationNavigation),d=(0,xt.Iq)(He.D.members(),this.localizationService);c===He.t.Dynamic&&d.unshift({value:He.t.Dynamic,displayName:i("PagePropertyPane_PageSizeType_Dynamic")});var v=this.explorationNavigation.getCurrentExploration(),h=e.evaluatedObjects&&e.evaluatedObjects.displayArea,f=h&&h.verticalAlignment;return void 0===f&&(f=v&&v.evaluatedObjects&&v.evaluatedObjects.section&&v.evaluatedObjects.section.verticalAlignment),void 0===f&&(f=bs.XN),u.addGroup("pageSize",function(m){m.addSimpleSlice(n.propertyName,new S.uY({descriptor:n,items:d,value:d.find(function(g){return g.value===c})}).build(),function(g){return g.withCustomDisplayName("Type")}).addSimpleSlice(o.propertyName,new S.mu({descriptor:o,value:e.size.height,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeHeight").withDisabled(c!==He.t.Custom)}).addSimpleSlice(s.propertyName,new S.mu({descriptor:s,value:e.size.width,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeWidth").withDisabled(c!==He.t.Custom)}).addSimpleSlice(l.propertyName,new S.uY({descriptor:l,value:f}).build(),function(g){return g.withCustomDisplayName("Visual_Alignment_Vertical")})}).build()},a.prototype.populateCanvasBackground=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[ze.PageBackgroundCardName],n=Me.tb,o=Me.nW,s=(0,Yr.Gl)(i?.color)?i.color.solid.color:n,l=Ie.js.background,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("background"),"Canvas_Background",[u,c,d],r).withDescription("Area_Beneath_Visual").addGroup("background",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},a.prototype.populateWallpaper=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[ze.OutspaceBackgroundCardName],n=Me.hH,o=Me.Dd,s=(0,Yr.Gl)(i?.color)?i.color.solid.color:n,l=Ie.js.outspace,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("outspace"),"PagePropertyPane_Outspace",[u,c,d],r).withDescription("Area_Behind_Canvas").addGroup("outspace",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},a.prototype.populatePageRefresh=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,q=this;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return r=function(V){return q.localizationService.get(V)},n=(i=e.evaluatedObjects&&e.evaluatedObjects.pageRefresh||{show:!1,duration:Me.oK,refreshType:Ut.wO}).show||!1,s=(o=Ie.js.pageRefresh).show,l=o.refreshType,u=o.duration,c=o.dialogLauncher,d=o.measure,v=o.checkEvery,h=new S.CQ(new S.lg("pageRefresh"),"PageRefresh",[s,l,u,c,d,v],r),f=i.duration||Me.oK,m=i.refreshType||Ut.wO,t||(m=Ut.wO),y=t?[Ut.wO,Ut.kj]:[Ut.wO],(g=this.featureSwitchService.featureSwitches.changeDetection)&&m===Ut.kj?[4,gs({localizationService:this.localizationService,dataSourcesService:this.dataSources,changeDetectionMeasure:this.changeDetectionMeasure,conceptualSchemaProxy:this.conceptualSchemaProxy,explorationCapabilities:this.explorationCapabilities,telemetryService:this.telemetryService},!n)]:[3,2];case 1:D=F.sent(),F.label=2;case 2:return[2,h.addTopLevelToggle(s.propertyName,function(){return new S.bd({descriptor:s,value:n}).build()}).addGroup("pageRefresh",function(N){g?m===Ut.wO?(q.createRefreshTypeSlice(N,l,"".concat(m),y),q.createDurationSlice(N,u,f)):q.createRefreshTypeSlice(N,l,"".concat(m),y):q.createDurationSlice(N,u,f),g&&m===Ut.kj&&N.addSlices(D)}).build()]}})})},a.prototype.createDurationSlice=function(e,t,r){e.addSimpleSlice(t.propertyName,new S.Cv({descriptor:t,value:r,validators:{min:"PT1S",max:"P24D",integer:!0}}).build(),function(i){return i.withCustomDisplayName("AutoPageRefreshInterval")})},a.prototype.createRefreshTypeSlice=function(e,t,r,i){e.addSimpleSlice(t.propertyName,new S.uY({descriptor:t,value:r,filterValues:i}).build(),function(n){return n.withCustomDisplayName("AutoPageRefreshType")})},a.prototype.populatePersonalizeVisual=function(e){var t,r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,f=this;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return i=function(y){return f.localizationService.get(y)},o=(n=Ie.js.personalizeVisual).show,s=n.perspectiveRef,l=n.applyToAllPages,u=new S.CQ(new S.lg("personalizeVisual"),"VisualHeader_ShowPersonalizeVisualButton",[o,s,l],i),c=null===(r=null===(t=e.evaluatedObjects)||void 0===t?void 0:t.personalizeVisual)||void 0===r?void 0:r.perspectiveRef,[4,(0,qe.mI)(this.dataSources,this.perspectivesService,this.localizationService)];case 1:return d=m.sent(),v=null!=c&&_.find(d,function(g){return g.value===c}),h=v?.value||"",[2,u.addTopLevelToggle(o.propertyName,function(){var g,y,D;return new S.bd({descriptor:o,value:null===(D=null===(y=null===(g=e?.evaluatedObjects)||void 0===g?void 0:g.personalizeVisual)||void 0===y?void 0:y.show)||void 0===D||D}).build()}).addGroup("personalizeVisual",function(g){g.addSimpleSlice(s.propertyName,new S.uY({descriptor:s,items:d,value:_.find(d,function(y){return y.value===h})}).build(),function(y){return y.withCustomDisplayName("PersonalizeVisual_PerspectivePropertyName")}).addSimpleSlice(l.propertyName,new S.Vc({descriptor:l,value:function(){return f.onApplyToAllPages(l)}}).build(),function(y){return y.withCustomDisplayName("PagePropertyPane_ApplyToAllPages").withSuppressDisplayName(!0)})}).build()]}})})},a.prototype.onApplyToAllPages=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(r){return this.saveProperties([{objectName:e.objectName,uid:"applyToAllPagesUid",propertySlice:{name:e.propertyName,type:{applyToAllPages:!0},value:!1},hasDynamicExpressionSupport:!1,formattingSource:"Page",visualUpdateSource:0}],{contextActivityService:this.contextActivityService,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,layoutAuthoring:this.layoutAuthoring,localizationService:this.localizationService,resourceLoader:this.resourceLoader,resourceRegistration:this.resourceRegistration,telemetryService:this.telemetryService,themeService:this.themeService,undoRedo:this.undoRedo,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visualStylePresetService:this.visualStylePresetService,visualSync:this.visualSync,trustedVisualService:this.trustedVisualService}),[2]})})},a.prototype.populateFilterPane=function(e){var t=this,r=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),i=e.evaluatedObjects&&e.evaluatedObjects.outspacePane,n=function(F){return t.localizationService.get(F)},o=Ie.js.outspacePane,s=o.fontFamily,l=o.titleSize,u=o.foregroundColor,c=o.inputBoxColor,d=o.headerSize,v=o.searchTextSize,h=o.border,f=o.borderColor,m=o.backgroundColor,g=o.transparency,y=o.width,D=o.checkboxAndApplyColor;return new S.CQ(new S.lg("outspacePane"),"Exploration_FilterPane",[s,l,u,c,d,v,h,f,m,g,y,D],n).addGroup("text",function(q){var F=i&&null!=i.foregroundColor?i.foregroundColor.solid.color:r.colorPalette.foreground.value;q.withDisplayName("Text").addCompositeSlice(s.propertyName,"Font",(new S.UN).withFontFamily({descriptor:s,value:i&&null!=i.fontFamily?"".concat(i.fontFamily):Me.h9}).withFontSizeProperties({descriptor:l,value:i&&null!=i.titleSize?i.titleSize:Me.Db,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj}}}).build()).addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(q){var F=i&&null!=i.inputBoxColor?i.inputBoxColor.solid.color:i&&null!=i.backgroundColor?i.backgroundColor.solid.color:Me.$U;q.withDisplayName("Input").addSimpleSlice(c.propertyName,new S.BT({descriptor:c,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("header",function(q){q.withDisplayName("ThemeDialog_SubSection_Header").addSimpleSlice(d.propertyName,new S.mu({descriptor:d,value:i&&null!=i.headerSize?i.headerSize:Me.SC,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(F){return F.withCustomDisplayName("PagePropertyPane_OutspacePane_HeaderSize")})}).addGroup("searchbox",function(q){q.withDisplayName("SearchBox").addSimpleSlice(v.propertyName,new S.mu({descriptor:v,value:i&&null!=i.searchTextSize?i.searchTextSize:Me.D6,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(F){return F.withCustomDisplayName("PagePropertyPane_OutspacePane_SearchTextSize")})}).addGroup("border",function(q){var F=i&&null!=i.borderColor?i.borderColor.solid.color:Me.JW;q.withDisplayName("Visual_Border").addTopLevelToggle(h.propertyName,function(){return new S.bd({descriptor:h,value:i&&null!=i.border?i.border:Me.zH}).build()}).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(q){var F,N=i&&null!=i.backgroundColor?i.backgroundColor.solid.color:r.colorPalette.background.value;q.withDisplayName("Visual_Background").addSimpleSlice(m.propertyName,new S.BT({descriptor:m,value:{value:N}}).build(),function(V){return V.withCustomDisplayName("Generic_Color")}).addSimpleSlice(g.propertyName,S.JN.getTransparencySliderBuilder({descriptor:g,value:null!==(F=i?.transparency)&&void 0!==F?F:Me.yX,localize:n}).build(),function(V){return V.withCustomDisplayName("Transparency")})}).addGroup("options",function(q){var F=i&&null!=i.checkboxAndApplyColor?i.checkboxAndApplyColor.solid.color:Me.mC;q.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice(y.propertyName,new S.mu({descriptor:y,value:i&&null!=i.width?i.width:Me.vg,options:{maxValue:{type:1,value:Me.Xj},minValue:{type:0,value:Me.AA},unitSymbol:"Numeric_Pixel"}}).build(),function(N){return N.withCustomDisplayName("Pane_Width")}).addSimpleSlice(D.propertyName,new S.BT({descriptor:D,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Apply_And_Checkboxes").withCustomDescription("Apply_And_Checkboxes_Tooltip")})}).build()},a.prototype.populateFilterCard=function(e){var t=this,r=function(s){return t.localizationService.get(s)},i=Ie.js.filterCard;return new S.CQ(new S.lg("filterCard"),"PagePropertyPane_FilterCards",[i.fontFamily,i.textSize,i.foregroundColor,i.inputBoxColor,i.border,i.borderColor,i.backgroundColor,i.transparency],r).addGroup("applySettingsTo",function(o){o.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("state",function(s){s.withDisplayName("State").addContainerItem("default",r("Default"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!1)}).addContainerItem("applied",r("PagePropertyPane_FilterCards_Applied"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!0)})})}).build()},a.prototype.generateFilterCardContainerItemBuilder=function(e,t,r){var i=this,n=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),o=function(v){return i.localizationService.get(v)},s=t.evaluatedObjects&&t.evaluatedObjects.filterCard,l=r?Me.ZF:Me.Kc,u={id:l},c=s&&s.$instances&&s.$instances[l];e.addGroup("text",function(d){var v=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.fontFamily),{selector:u}),h=c&&null!=c.foregroundColor?c.foregroundColor.solid.color:n.colorPalette.foreground.value,f=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.foregroundColor),{selector:u});d.withDisplayName("Text").addCompositeSlice(v.propertyName,"Font",(new S.UN).withFontFamily({descriptor:v,value:c&&null!=c.fontFamily?"".concat(c.fontFamily):Me.h9}).withFontSizeProperties({descriptor:(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.textSize),{selector:u}),value:c&&null!=c.textSize?c.textSize:Me.JM,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj}}}).build()).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:h}}).build(),function(m){return m.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(d){var v=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.inputBoxColor),{selector:u}),h=c&&null!=c.inputBoxColor?c.inputBoxColor.solid.color:Me.NC;d.withDisplayName("Input").addSimpleSlice(v.propertyName,new S.BT({descriptor:v,value:{value:h}}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("border",function(d){var v=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.border),{selector:u}),h=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.borderColor),{selector:u}),f=c&&null!=c.borderColor?c.borderColor.solid.color:Me.bm;d.withDisplayName("Visual_Border").addTopLevelToggle(v.propertyName,function(){return new S.bd({descriptor:v,value:c&&null!=c.border?c.border:Me.HX}).build()}).addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(d){var v,h=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.backgroundColor),{selector:u}),f=c&&null!=c.backgroundColor?c.backgroundColor.solid.color:n.colorPalette.background.value,m=(0,p.__assign)((0,p.__assign)({},Ie.js.filterCard.transparency),{selector:u});d.withDisplayName("Visual_Background").addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(g){return g.withCustomDisplayName("Generic_Color")}).addSimpleSlice(m.propertyName,S.JN.getTransparencySliderBuilder({descriptor:m,value:null!==(v=c?.transparency)&&void 0!==v?v:Me.$V,localize:o}).build(),function(g){return g.withCustomDisplayName("Transparency")})})},a.prototype.getFormatPaneSliceTransform=function(){var e=this;return function(t,r,i){return e.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:t,objectDescriptors:r,visualType:void 0,visualObjects:void 0,dynamicExpressionSupportOptions:i})}},a.prototype.getPagePropertyPaneSaveServices=function(){return{canvasScale:this.canvasScale,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,lazyScoped:this.lazyScoped,linguisticSchemaProxy:this.linguisticSchemaProxy,promiseFactory:this.promiseFactory,telemetryService:this.telemetryService,undoRedo:this.undoRedo}},a.prototype.getDrillthroughTooltipControlSettings=function(e,t){return an.F(e,t,an.j(t.type,this.localizationService,!0),!1)},a.prototype.tryCreateDrillthroughFilter=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,(0,Ui.uE)(1,e,!0,this.dataSources,t,this.visualAuthoring,!1)];case 1:return r=i.sent(),_.isEmpty(r)?[2]:[2,{expr:t,metadata:{boundFilter:r}}]}})})},a.prototype.savePageProperties=function(e,t,r,i){var n,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,D,T;return(0,p.__generator)(this,function(q){return s=i.explorationNavigation.getCurrentExploration(),l=i.explorationNavigation.getCurrentSection(),u=l.size,c=i.canvasScale.getDisplayOption(),d=i.promiseFactory.defer(),e.name===ze.PageInformationName?(e.value?(v={sectionNewName:e.value,sectionIndex:_.indexOf(s.sections,l)},i.eventBridge.publishToChannel(Ge.HOc,v)):e.value=l.displayName,d.resolve(!1)):e.name===ze.PageInformationQnaPodEnabled?e.value?i.undoRedo.register("ReportPagePodEnabled",function(){(0,Or.k9)(s,l,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):i.undoRedo.register("ReportPagePodDisabled",function(){(0,Or.QU)(s,l.name,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):e.name===ze.PageInformationAltName?(h=e.value.split(/[,\n]/).map(function(F){return F.trim()}).filter(function(F){return!_.isEmpty(F)}),i.undoRedo.register("UpdateLinguisticAltNames",function(){(0,Or.XY)(s,l,h,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})})):e.name===ze.PageInformationType?((f=r.featureSwitchService.featureSwitches.onObject)?(m=e.value,b.fF.assert(function(){return null!=m},"propertyPaneSlice.value for page type cannot be null")):m=e.value?1:0,i.lazyScoped.get(Mr.Sz).then(function(F){var N;gn(m,F,s,l,f),0===m?N="regular":2===m?N="drillthrough":1===m?N="tooltip":b.fF.assertFail("unhandled type "+m),i.telemetryService.logEvent(Ve.Lo,{objectName:ze.PageInformationCardName,propertyName:e.name,newValue:N,visualType:"page"}),d.resolve(!1)})):e.name===ze.PageSizeTypeName?i.lazyScoped.get(Mr.Sz).then(function(F){mn(e.value,u,i.eventBridge,F,c),d.resolve(!1)}):e.name===ze.PageSizeWidthName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Ge.qHu,{width:parseInt(y,10),height:u.height,displayOption:c}),d.resolve(!1)):e.name===ze.PageSizeHeightName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Ge.qHu,{width:u.width,height:parseInt(y,10),displayOption:c}),d.resolve(!1)):t===ze.PageBackgroundCardName?(ur("UpdateCanvasBackground",t,e,r,i),d.resolve(!0)):t===ze.OutspaceBackgroundCardName?(ur("UpdateOutspaceBackground",t,e,r,i),d.resolve(!0)):t===ze.OutspacePaneCardName?(ur("UpdateOutspacePaneBackground",t,e,r,i),d.resolve(!0)):t===ze.FilterCardName?(ur("UpdateFilterCard",t,e,r,i),d.resolve(!0)):t===ze.DisplayAreaName?(ur("UpdateDisplayAreaAlignment",t,e,r,i),d.resolve(!0)):t===ze.PageRefreshCardName?(ur("UpdatePageRefresh",t,e,r,i),(y=e.value)&&i.telemetryService.logEvent(Ve.Lo,{objectName:ze.PageRefreshCardName,propertyName:e.name,newValue:y.toString(),visualType:"page"}),d.resolve(!0)):t===ze.PersonalizeVisual&&(ur("UpdatePersonalizeVisual",t,e,r,i),D="applyToAllPages"in e.type&&!(null===(n=e.type)||void 0===n||!n.applyToAllPages),T=!D&&("reference"in e.type&&null!==(o=e.type.reference)&&void 0!==o&&o.perspective?""===e.value:!(!("revertToDefault"in e.type)||!e.type.revertToDefault)||void 0),i.telemetryService.logEvent(Ve.gW,{isDefault:T,isApplyToAllPages:D}),d.resolve(!0)),[2,d.promise]})})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(_s.t),w.\u0275\u0275inject(Cs.C),w.\u0275\u0275inject(Ts.Z),w.\u0275\u0275inject(Vs.C),w.\u0275\u0275inject(zt.i),w.\u0275\u0275inject(rn.r),w.\u0275\u0275inject(Nt.D),w.\u0275\u0275inject(Wr.O),w.\u0275\u0275inject(un.J),w.\u0275\u0275inject(Ri.U),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(jr),w.\u0275\u0275inject(en.U),w.\u0275\u0275inject(Sr.H),w.\u0275\u0275inject(Ps.e),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Ns),w.\u0275\u0275inject(pn.l6),w.\u0275\u0275inject(cn.j),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(Pr.f),w.\u0275\u0275inject(ei.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(xr.A),w.\u0275\u0275inject(tn.M),w.\u0275\u0275inject(vn.t))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function ur(a,e,t,r,i){var n=i.explorationNavigation.getCurrentSection();i.undoRedo.register(a,function(){var o=n.objects||{};Zr(e,t,o,r),n.objects=o}),i.eventBridge.publishToChannel(Ge.H8N,n)}function mn(a,e,t,r,i){var n=(0,xt.MO)(a);a===He.t.Custom&&0!==i&&(n=e),t.publishToChannel(Ge.qHu,n);var o=a===He.t.Tooltip;!o&&(1===i||a===He.t.Custom)||r.setCanvasDisplay(o?3:1)}function gn(a,e,t,r,i){e.setSectionType(t,r,a),(i?2===a:null==a||0===a)||e.setCrossReportDrillthrough(t,r,!1,!1)}var Gi="editable-container-object-name",xs=function(){function a(){this.referencedDescriptors=[],this.revertToDefaultDescriptors=[],this.revertToDefaultProperties=new Set}return a.prototype.addDescriptors=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(_.isEmpty(t))return this;(e=this.revertToDefaultDescriptors).push.apply(e,t||[]);for(var i=0,n=t;i<n.length;i++){var s=this.getDescriptorString(n[i]);this.revertToDefaultProperties.add(s)}return this},a.prototype.getDescriptors=function(){return this.revertToDefaultDescriptors},a.prototype.getDescriptorString=function(e){return"".concat(e.objectName,"-").concat(e.propertyName)},a.prototype.hasDescriptor=function(e){var t=this.getDescriptorString(e);return this.revertToDefaultProperties.has(t)},a.prototype.hasDescriptors=function(){return!_.isEmpty(this.revertToDefaultDescriptors)},a.prototype.addReferencedDescriptor=function(e){this.referencedDescriptors.push(e)},a.prototype.validateRevertToDefaultDescriptors=function(){if(this.hasDescriptors())for(var t=0,r=this.referencedDescriptors;t<r.length;t++){var i=r[t];this.hasDescriptor(i)||b.fF.assertFail("Descriptor '".concat(this.getDescriptorString(i),"' is missing from RevertToDefault"))}},a}(),yn=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v,h,f,m,g,y,D,T,q,F){this.propertyChangeIndicatorService=e,this.analyticsFormattingService=i,this.canvasItemFormattingService=n,this.conditionalFormattingService=o,this.contextActivityService=s,this.featureSwitchService=l,this.localizationService=u,this.pageFormattingService=c,this.visualFormattingService=d,this.containerSelectionChangedSubject=new ni.xQ,this.selectedContainerItems=new Map,this.selectedListEditorItems=new Map,this.saveServices={contextActivityService:s,explorationNavigation:t,featureSwitchService:l,layoutAuthoring:r,localizationService:u,resourceLoader:v,resourceRegistration:h,telemetryService:f,themeService:m,undoRedo:y,visualAuthoring:D,visualPlugin:T,visualStylePresetService:q,visualSync:F,trustedVisualService:g}}return a.prototype.getFormattingOptions=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,s,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:switch(t){case"Visual":return[3,1];case"Format_Label_General":return[3,3];case"Page":return[3,5];case"Analytics":return[3,7]}return[3,9];case 1:return[4,this.visualFormattingService.getFormattingModel(e)];case 2:return r=c.sent(),i=this.visualFormattingService.getObjectDescriptors(e),n=this.visualFormattingService.getFormatPaneSliceTransform(e),[3,10];case 3:return[4,this.canvasItemFormattingService.getFormattingModel(e)];case 4:return r=c.sent(),i=this.canvasItemFormattingService.getObjectDescriptors(e),n=this.canvasItemFormattingService.getFormatPaneSliceTransform(e),[3,10];case 5:return[4,this.pageFormattingService.getFormattingModel()];case 6:return r=c.sent(),i=this.pageFormattingService.getObjectDescriptors(),n=this.pageFormattingService.getFormatPaneSliceTransform(),[3,10];case 7:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 8:return r=c.sent(),i=this.analyticsFormattingService.getObjectDescriptors(e),n=this.analyticsFormattingService.getFormatPaneSliceTransform(e),[3,10];case 9:b.fF.assertNever(t),c.label=10;case 10:return s={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:e?new wr.lD(e,function(d){return d===e||d&&e&&e.name===d.name}):void 0},r?(l=this.getObjectDefinitions(t,e),[4,this.updateFormattingContract(e,{objectDefinitions:l,objectDescriptors:i,originSource:t},r,n,s,t)]):[2,s];case 11:return c.sent(),[2,s]}})})},a.prototype.getRevertToDefaultMetadata=function(e,t){if(!t)return{formattingSettingsString:void 0,itemTypeDisplayName:void 0};switch(t){case"Visual":return this.visualFormattingService.getRevertToDefaultMetadata(e);case"Format_Label_General":return this.canvasItemFormattingService.getRevertToDefaultMetadata(e);case"Page":return this.pageFormattingService.getRevertToDefaultMetadata();case"Analytics":return this.analyticsFormattingService.getRevertToDefaultMetadata(e);default:b.fF.assertNever(t)}},a.prototype.getContainerChanged$=function(){return this.containerSelectionChangedSubject.asObservable()},a.prototype.updateFormattingContract=function(e,t,r,i,n,o){var s;return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,D=this;return(0,p.__generator)(this,function(T){switch(T.label){case 0:l=[],u=i,c=o,d=[],v=0,h=function(F){var N,V,P,O,E,L,B,x,j,k,re,ne,J,se,we,$e;return(0,p.__generator)(this,function(Xe){switch(Xe.label){case 0:return V=t,P=new xs,(0,S.Qu)(F)?[4,f.resolvePlaceholder(F,e)]:[3,2];case 1:if(!(O=Xe.sent()))return[2,"continue"];if(N=O.item,V={objectDescriptors:O.objectDescriptors,objectDefinitions:f.getObjectDefinitions(E=O.originSource,e),originSource:E},L=O.revertToDefaultDescriptors){for(B=[],x=0,j=L;x<j.length;x++)B.push((0,p.__assign)((0,p.__assign)({},j[x]),{originSource:E}));P.addDescriptors.apply(P,B)}return[3,3];case 2:(N=F).analyticsPane&&(V=(0,p.__assign)((0,p.__assign)({},V),{originSource:"Analytics"})),P.addDescriptors.apply(P,(null!==(s=N.revertToDefaultDescriptors)&&void 0!==s?s:[]).map(function(Ue){return(0,p.__assign)((0,p.__assign)({},Ue),{originSource:V.originSource})})),Xe.label=3;case 3:return k=ce.LF(N.uid,c),re=r.warnings,ne=r.warnings$,[4,f.getFormattingGroupsContract(e,V,N.groups,f.getDisabledState(N.topLevelToggle),k,N.displayName,i,void 0,void 0,P,re,o,[])];case 4:return J=Xe.sent(),se=N.topLevelToggle?f.getSimpleFormattingSlice(e,V,N.topLevelToggle,!!N.disabled,N.displayName,u,void 0,P,re):void 0,we=P.getDescriptors(),d.push.apply(d,we),$e=(0,p.__assign)((0,p.__assign)({},N),{pivotSource:c,uid:k,warningMessage:f.getCardWarning(re,N,J,se),warningMessage$:ne&&ne.pipe((0,de.U)(function(Ue){return D.getCardWarning(Ue,N,J,se)})),topLevelToggle:se?(0,p.__assign)((0,p.__assign)({},se),{isTopLevelToggle:!0,originSource:V.originSource}):void 0,revertToDefaultDescriptors:we,originSource:V.originSource,index:v++,groupUids:J.map(function(Ue){return Ue.uid}),groups:J}),l.push($e),P.validateRevertToDefaultDescriptors(),[2]}})},f=this,m=0,g=r.cards,T.label=1;case 1:return m<g.length?[5,h(g[m])]:[3,4];case 2:T.sent(),T.label=3;case 3:return m++,[3,1];case 4:return this.normalize(l,n),n.revertToDefaultDescriptors=d,[2]}})})},a.prototype.normalize=function(e,t){for(var r,i,n=0,o=0,s=e;o<s.length;o++){var l=s[o];t.cards[l.uid]=l;for(var u=l.originSource,c=function(m){for(var y=[],D=0,T=m.slices?(0,p.__spreadArray)([],m.slices,!0):[];D<T.length;D++){var q=T[D],F=(0,lr.O7)(q),N=(0,lr.$Q)(q.uid,F);t.slices[N]&&(q.uid="".concat(q.uid,"___").concat(n++,"___"),N=(0,lr.$Q)(q.uid,F));var V=(0,p.__assign)((0,p.__assign)({},q),{groupUid:m.uid,originSource:null!==(r=q.originSource)&&void 0!==r?r:u});t.slices[N]=V;for(var O=0,E=(0,S.IW)(V)?ce.ce(V):[V];O<E.length;O++){var L=E[O],B=ce.zh(L.control.properties.descriptor);t.slices[B]=L}y.push({uid:V.uid,selector:F})}delete m.slices,b.fF.assert(function(){return!t.groups[m.uid]},"duplicate group uid ".concat(m.uid)),t.groups[m.uid]=(0,p.__assign)((0,p.__assign)({},m),{originSource:null!==(i=m.originSource)&&void 0!==i?i:u,sliceIds:y})},d=0,v=l.groups;d<v.length;d++)c(v[d]);delete l.groups}},a.prototype.getModelUnavailableInformation=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getModelUnavailableInformation(t);case"Format_Label_General":return this.canvasItemFormattingService.getModelUnavailableInformation(t);case"Page":return{messageKey:void 0};case"Analytics":return this.analyticsFormattingService.getModelUnavailableInformation(t);default:b.fF.assertNever(e)}},a.prototype.getFormattingModelMessage=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getFormattingModelMessage(t);case"Format_Label_General":case"Page":case"Analytics":return;default:b.fF.assertNever(e)}},a.prototype.getObjectDefinitions=function(e,t,r){switch(e){case"Visual":return this.visualFormattingService.getObjectDefinitions(t,r);case"Format_Label_General":return this.canvasItemFormattingService.getObjectDefinitions(t,r);case"Page":return this.pageFormattingService.getObjectDefinitions();case"Analytics":return this.analyticsFormattingService.getObjectDefinitions(t,r);default:b.fF.assertNever(e)}},a.prototype.getRevertToDefaultEnabled=function(e,t,r){if(_.isEmpty(t))return!1;var i=_.groupBy(t,function(u){return u.originSource}),n=!1;for(var o in i){var s=o;switch(s){case"Visual":case"Format_Label_General":var l=this.getObjectDefinitions(s,e,!0);n=ce.wW(t,l,r,this.featureSwitchService.featureSwitches.onObject);break;case"Page":n=this.pageFormattingService.getRevertToDefaultEnabled(t,r);break;case"Analytics":n=this.analyticsFormattingService.getRevertToDefaultEnabled(e,t??[],r);break;default:b.fF.assertNever(s)}if(n)break}return n},a.prototype.getSliceShowChangeIndicator=function(e,t,r){var i=t.originSource;switch(i){case"Visual":case"Format_Label_General":case"Page":return this.shouldShowSliceChangeIndicator(e,t,r);case"Analytics":return this.analyticsFormattingService.shouldShowSliceChangeIndicator();default:b.fF.assertNever(i)}},a.prototype.shouldShowSliceChangeIndicator=function(e,t,r){var n=this.getObjectDefinitions(t.originSource,e,!0);return this.propertyChangeIndicatorService&&this.propertyChangeIndicatorService.shouldShowSliceChangeIndicator(r,n)},a.prototype.getCardWarning=function(e,t,r,i){var n;if(e){var o=e[t.uid];o&&!(o instanceof Da.L)&&(n=o)}if(i&&i.warningMessage&&(n=i.warningMessage.source),!n){var s=r.find(function(l){return!!l.warningMessage});s&&s.warningMessage&&(n=s.warningMessage.source)}if(n)return ti(n,this.localizationService,!0)},a.prototype.getGroupWarning=function(e,t){var r;if(t&&t.warningMessage&&(r=t.warningMessage.source),!r){var i=e.find(function(n){return!!n.warningMessage});i&&(r=i.warningMessage.source)}if(r)return ti(r,this.localizationService,!0)},a.prototype.getSliceWarning=function(e,t,r){if(e.conditionalFormattingWarning)return e.conditionalFormattingWarning;var i=this.getWarningForDescriptor(r,t);return i?ti(i,this.localizationService):void 0},a.prototype.resolvePlaceholder=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return(0,S.Dw)(e)?[4,this.canvasItemFormattingService.resolvePlaceholder(e,t)]:[3,2];case 1:return[2,(r=i.sent())?(0,p.__assign)((0,p.__assign)({},r),{originSource:"Format_Label_General"}):void 0];case 2:if((0,S.d5)(e))return[2,(r=this.visualFormattingService.resolvePlaceholder(e,t))?(0,p.__assign)((0,p.__assign)({},r),{originSource:"Visual"}):void 0];b.fF.assertFail("Unexpected placeholder type"),i.label=3;case 3:return[2]}})})},a.prototype.getFormattingGroupsContract=function(e,t,r,i,n,o,s,l,u,c,d,v,h){var f;return(0,p.__awaiter)(this,void 0,void 0,function(){var m,g,y,D,T,q,F,N;return(0,p.__generator)(this,function(P){switch(P.label){case 0:m=[],g=s,y=_.cloneDeep(h),T=function(E){var L,B,x,j,R,k,re,ne,J,we,$e,Xe,Ue,Fe,Le,St,vt,rr,_t,Tt,li;return(0,p.__generator)(this,function(ir){switch(ir.label){case 0:return B=t,(0,S.Qu)(E)?[4,q.resolvePlaceholder(E,e)]:[3,2];case 1:if(!(x=ir.sent()))return[2,"continue"];if(L=x.item,j=x.originSource,R=x.objectDescriptors,k=x.revertToDefaultDescriptors){for(re=[],ne=0,J=k;ne<J.length;ne++)re.push((0,p.__assign)((0,p.__assign)({},J[ne]),{originSource:j}));c.addDescriptors.apply(c,re)}return B={objectDescriptors:R,objectDefinitions:q.getObjectDefinitions(j,e),originSource:j},[3,3];case 2:L=E,ir.label=3;case 3:return D=L.displayName?"".concat(o," - ").concat(L.displayName):"".concat(o),we=[],$e=[],Xe=null===(f=L.inheritDisabled)||void 0===f||f,Ue=Xe&&i||L.disabled,Fe=B.originSource,Le=L.topLevelToggle?q.getSimpleFormattingSlice(e,B,L.topLevelToggle,Ue,D,g,void 0,c,d):void 0,L.topLevelToggle=Le,L.container&&L.container.containerItems.length>0?[4,q.convertFormattingContainers(e,B,L.container,n,L.uid,Ue||q.getDisabledState(L.topLevelToggle),s,D,L.containerDisabled,c,d,v,h)]:[3,5];case 4:St=ir.sent(),we=St.slices,$e=St.groups,ir.label=5;case 5:return L.container=void 0,[4,q.getFormattingSliceContracts(e,B,L.slices,Ue||q.getDisabledState(L.topLevelToggle),D,s,u,c,d,L.uid,v)];case 6:return vt=ir.sent(),rr=!!L.displayName&&(!!_.isUndefined(L.collapsible)||L.collapsible),_t=_.concat(vt,we),Tt=q.getGroupWarning(_t,Le),li=(0,p.__assign)((0,p.__assign)({},L),{collapsible:rr,disableInteractivity:l?.disableInteractivity,warningMessage:Tt,disabled:Ue,originSource:Fe,cardUid:n,pivotSource:v,sliceIds:_t.map(function(Be){return{uid:Be.uid,selector:(0,lr.O7)(Be)}}),slices:_t,parentContainers:y,topLevelToggle:Le?(0,p.__assign)((0,p.__assign)({},Le),{isTopLevelToggle:!0,originSource:Fe}):void 0}),m.push(li),m=_.concat(m,$e),b.fF.assert(function(){return L.sliceWithContainer||!(vt.length>0&&we.length>0)},"we don't have proper UI for supporting containers and slices in same group"),[2]}})},q=this,F=0,N=r,P.label=1;case 1:return F<N.length?[5,T(N[F])]:[3,4];case 2:P.sent(),P.label=3;case 3:return F++,[3,1];case 4:return[2,m]}})})},a.prototype.convertFormattingContainers=function(e,t,r,i,n,o,s,l,u,c,d,v,h){return(0,p.__awaiter)(this,void 0,void 0,function(){var f,m,g,y,D,T,q,F,N,V,P,O,E,L,B,x;return(0,p.__generator)(this,function(j){switch(j.label){case 0:if(r.containerItems.length<=0)return[2];f=[],m=this.getContainerDropdownDescriptor(i,r.uid,r.isEditable),g=m.propertyName,r.isEditable?(V=r.containerItems.map(function(R,k){return{displayName:R.displayName,value:k,uid:R.uid}}),y=this.getSelectedListEditorItemIndex(g),V=_.filter(V,function(R){return!_.isEmpty(R.displayName)}),_.isEmpty(V)&&(y=0),D={displayName:r.displayName,disabled:o,control:{type:"ListEditor",properties:{descriptor:(0,p.__assign)((0,p.__assign)({},m),{type:{}}),value:{items:V,selectedItem:V[y]}}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,pivotSource:v,groupUid:n},f.push(D)):(T=this.getSelectedContainerItemName(g),V=r.containerItems.map(function(R,k){var re={displayName:R.displayName,value:R.displayName,icon:R.icon?{glyph:R.icon}:void 0};return 0===k&&(F=re,N=0),R.defaultSelected&&(F=re,N=k),(0===k&&null===T||T===R.displayName)&&(q=re),re}),(y=_.findIndex(r.containerItems,function(R){return R.displayName===T}))<0&&(y=N,q=F),P={displayName:r.displayName,disabled:o||!!u,control:{type:"Dropdown",properties:{descriptor:(0,p.__assign)((0,p.__assign)({},m),{type:{}}),items:V,value:q}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,groupUid:n,pivotSource:v},f.push(P)),O=[],E=this.featureSwitchService.featureSwitches.onObject,L=function(k){var re,ne,se,we,$e,Xe,Ue,Fe,Le,St,vt,rr;return(0,p.__generator)(this,function(_t){switch(_t.label){case 0:return E||k===y?(ne=k!==y,se=(re=r.containerItems[k]).disabled,we=o||se,$e=(0,p.__spreadArray)((0,p.__spreadArray)([],h,!0),[{containerName:g,value:re.displayName}],!1),Xe={groups:[],slices:[]},re.container?[4,B.convertFormattingContainers(e,t,re.container,i,re.container.uid,o,s,l,u,c,d,v,$e)]:[3,2]):[2,"continue"];case 1:Xe=_t.sent(),_t.label=2;case 2:return(Ue=re.slices)?[4,B.getFormattingSliceContracts(e,t,Ue,we,l,s,r.displayName,c,d,n,v)]:[3,4];case 3:return Le=_t.sent(),[3,5];case 4:Le=[],_t.label=5;case 5:return Fe=(Fe=Le).concat(Xe.slices),f=_.concat(f,_.map(Fe,function(Tt){return(0,p.__assign)((0,p.__assign)({},Tt),{hidden:Tt.hidden||ne})})),(St=re.groups)?[4,B.getFormattingGroupsContract(e,t,St,we,i,l,s,se?{disableInteractivity:!0,collapsed:!0}:void 0,r.displayName,c,d,v,$e)]:[3,7];case 6:return rr=_t.sent(),[3,8];case 7:rr=[],_t.label=8;case 8:return vt=(vt=rr).concat(Xe.groups),O=_.concat(O,_.map(vt,function(Tt){return(0,p.__assign)((0,p.__assign)({},Tt),{uid:E?(0,lr.aO)(Tt.uid,k):Tt.uid,hidden:ne||Tt.hidden})})),[2]}})},B=this,x=0,j.label=1;case 1:return x<r.containerItems.length?[5,L(x)]:[3,4];case 2:j.sent(),j.label=3;case 3:return x++,[3,1];case 4:return[2,{slices:f,groups:O}]}})})},a.prototype.getSelectedContainerItemName=function(e){return this.selectedContainerItems.has(e)||this.selectedContainerItems.set(e,null),this.selectedContainerItems.get(e)},a.prototype.getSelectedListEditorItemIndex=function(e){return this.selectedListEditorItems.has(e)||this.selectedListEditorItems.set(e,0),this.selectedListEditorItems.get(e)},a.prototype.getContainerDropdownDescriptor=function(e,t,r){return{objectName:r?Gi:ce.nB,propertyName:e+"-"+t+"-container"}},a.prototype.getFormattingSliceContracts=function(e,t,r,i,n,o,s,l,u,c,d){return(0,p.__awaiter)(this,void 0,void 0,function(){var v,h,f,m,g,y,D,T,q,F,N,V,O;return(0,p.__generator)(this,function(E){switch(E.label){case 0:if(!r)return[2,[]];v=[],h=0,f=r,E.label=1;case 1:return h<f.length?(g=void 0,y=t,(0,S.Qu)(m=f[h])?[4,this.resolvePlaceholder(m,e)]:[3,3]):[3,6];case 2:if(!(D=E.sent()))return[3,5];if(g=D.item,y={objectDescriptors:D.objectDescriptors,objectDefinitions:this.getObjectDefinitions(T=D.originSource,e),originSource:D.originSource},q=D.revertToDefaultDescriptors){for(F=[],N=0,V=q;N<V.length;N++)F.push((0,p.__assign)((0,p.__assign)({},V[N]),{originSource:T}));l.addDescriptors.apply(l,F)}return[3,4];case 3:g=m,E.label=4;case 4:(O=this.getFormattingSliceContract(e,y,g,i,n,o,s,l,u,c,d))&&v.push(O),E.label=5;case 5:return h++,[3,1];case 6:return[2,v]}})})},a.prototype.getDisabledState=function(e){return!!e&&!e.control.properties.value},a.prototype.getFormattingSliceContract=function(e,t,r,i,n,o,s,l,u,c,d){var v;if((0,S.IW)(r)){var f=this.getCompositeFormattingSlice(e,t,r,i,o,l,u);f&&(v=(0,p.__assign)((0,p.__assign)({},f),{pivotSource:d,groupUid:c}))}else{var g=this.getSimpleFormattingSlice(e,t,r,i,n,o,s,l,u);g&&(v=(0,p.__assign)((0,p.__assign)({},g),{pivotSource:d,groupUid:c}))}return v},a.prototype.getSimpleFormattingSlice=function(e,t,r,i,n,o,s,l,u){var c=t.objectDescriptors,d=t.originSource,v=r.control.properties.descriptor;_.isEmpty(v.propertyName)||l.addReferencedDescriptor((0,p.__assign)((0,p.__assign)({},v),{originSource:d}));var h=ce.w7(v,c),f=this.getTypeFromObjectDescriptor(v,h),g=o(r,c,{conditionalFormattingDisplayName:n,containerSliceDisplayName:s,formattingDescriptor:v,formattingModelWarnings:u,formattingObjectOptions:t,propertyDescriptor:h,type:f,canvasItem:e});if(g){var y=this.getSliceShowChangeIndicator(e,t,v),D=this.getFormattingDescriptorContract({formattingDescriptor:v,type:f}),T=this.getSliceWarning(g,v,u),q=g.control,F=(0,p.__assign)((0,p.__assign)({},q),{properties:(0,p.__assign)((0,p.__assign)({},q.properties),{descriptor:D})});return(0,p.__assign)((0,p.__assign)({},g),{disabled:i||g.disabled,control:F,warningMessage:T,showChangeIndicator:y,originSource:d})}},a.prototype.getCompositeFormattingSlice=function(e,t,r,i,n,o,s){var l=t.objectDescriptors,u=t.originSource;if(r=n(r,l,void 0)){var c=r.control;b.fF.assertValue(r.displayName,"Composite controls must specify a display name");var d,v=!1,h=c.properties,f={};for(var m in h){var g=m,y=h[g];if(y){var D=y.descriptor;_.isEmpty(D.propertyName)||o.addReferencedDescriptor((0,p.__assign)((0,p.__assign)({},D),{originSource:u}));var T=ce.w7(y.descriptor,l),q=y.descriptor;!v&&this.getSliceShowChangeIndicator(e,t,q)&&(v=!0);var F=this.getTypeFromObjectDescriptor(q,T),N=this.getFormattingDescriptorContract({formattingDescriptor:q,type:F});d=d||this.getSliceWarning(r,q,s),f[g]=(0,p.__assign)((0,p.__assign)({},y),{descriptor:N})}}var V=(0,p.__assign)((0,p.__assign)({},c),{properties:f});return(0,p.__assign)((0,p.__assign)({},r),{disabled:i||r.disabled,control:V,warningMessage:d,showChangeIndicator:v,originSource:u})}},a.prototype.getWarningForDescriptor=function(e,t){if(e){var r=e[t.objectName];if(r){var i=this.conditionalFormattingService.getDataBoundExprWarning(r,t);if(i)return i;if(this.featureSwitchService.featureSwitches.onObject){var n=r.propertyName;if(n&&n===t.propertyName)return r}}}},a.prototype.getFormattingDescriptorContract=function(e){var r=e.type;return(0,p.__assign)((0,p.__assign)({},e.formattingDescriptor),{type:r})},a.prototype.getTypeFromObjectDescriptor=function(e,t){var r,i=(0,qe.sH)(t?.type||{},e.propertyTypes),n=null===(r=t?.type)||void 0===r?void 0:r.variant;return n&&(i=(0,p.__assign)((0,p.__assign)({},i),{variant:n})),i},a.prototype.createSaveFormattingSlicesActivity=function(e){return this.contextActivityService.createActivity((0,p.__assign)({name:"Save Formatting Slices"},e))},a.prototype.createChangeFormatActivity=function(e,t,r,i,n,o,s){return s.createChildActivity({name:"Change Format",data:(0,p.__assign)({propertyName:n,objectName:i},o),visualName:e,visualType:t,uid:r})},a.prototype.revertToDefault=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(g){switch(g.label){case 0:if(t)for(i=0,n=Array.from(this.selectedContainerItems.keys());i<n.length;i++)(o=n[i]).startsWith(t)&&this.selectedContainerItems.delete(o);else this.selectedContainerItems.clear();for(c in s=_.groupBy(e,function(y){return y.originSource}),u=[],l=s)u.push(c);d=0,g.label=1;case 1:if(!(d<u.length))return[3,10];if(!((c=u[d])in l))return[3,9];switch(f=s[v=c],h=v){case"Page":return[3,2];case"Analytics":return[3,4];case"Visual":return[3,5];case"Format_Label_General":return[3,6]}return[3,8];case 2:return[4,this.pageFormattingService.revertPageSliceDefinitions(f)];case 3:return g.sent(),[3,9];case 4:return this.analyticsFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 5:return this.visualFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 6:return[4,this.canvasItemFormattingService.revertVisualSlicesToDefinitions(f,r)];case 7:return g.sent(),[3,9];case 8:b.fF.assertNever(h),g.label=9;case 9:return d++,[3,1];case 10:return[2]}})})},a.prototype.changeContainerDropdownValue=function(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r];this.selectedContainerItems.set(n.containerName,n.value)}this.containerSelectionChangedSubject.next({canvasItems:t})},a.prototype.saveFormattingSlicesValue=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,c,d,v,h,f,m,g,y;return(0,p.__generator)(this,function(D){switch(D.label){case 0:i=this.createSaveFormattingSlicesActivity(t),D.label=1;case 1:return D.trys.push([1,7,,8]),n=[],"No Telemetry"!==t.source&&((o=null===(r=e[0].canvasItems)||void 0===r?void 0:r[0])?(0,cs.v)(o,this.saveServices.visualPlugin,this.saveServices.trustedVisualService)||(n=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o)):"Pane"===t.source&&(n=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o))),1===_.size(e)&&e[0].objectName===ce.nB?(this.changeContainerDropdownValue([{containerName:(d=(c=e[0]).propertySlice).name,value:d.value}],v=c.canvasItems),[2]):1===_.size(e)&&e[0].objectName===Gi?(d=(c=e[0]).propertySlice,v=c.canvasItems,this.isEditableContainerWithSelectionChangeOnly(e)&&this.containerSelectionChangedSubject.next({canvasItems:v}),h=d.value,f=_.filter(h.items,function(T){var q;return!_.find(null===(q=h.itemUpdates)||void 0===q?void 0:q.deletes,function(F){return F.displayName===T.displayName})}),m=_.isEmpty(f)?0:_.findIndex(f,function(T){return _.isEqual(T.value,h.selectedItem.value)}),b.fF.assert(function(){return m>=0},"Expect the selected index of EditableContainer always >=0"),[4,this.saveProperties(e,i)]):[3,3];case 2:return D.sent(),m>=0&&this.selectedListEditorItems.get(d.name)!==m&&this.selectedListEditorItems.set(d.name,m),[2];case 3:return D.trys.push([3,5,,6]),[4,this.saveProperties(e,i)];case 4:return D.sent(),n.forEach(function(T){return T.resolve()}),[3,6];case 5:throw g=D.sent(),n.forEach(function(T){return T.reject(g)}),g;case 6:return i.resolve(),[3,8];case 7:throw y=D.sent(),i.reject(y),y;case 8:return[2]}})})},a.prototype.createChangeFormatContextActivitiesFromChanges=function(e,t,r,i){var n=this;return e.map(function(o){var s,l,u=o.objectName,c=null===(s=o.propertySlice)||void 0===s?void 0:s.name,d=null!==(l=i?.name)&&void 0!==l?l:void 0,v=i&&(0,di.s)(i);return n.createChangeFormatActivity(d,v,o.uid,u,c,t,r)})},a.prototype.isEditableContainerWithSelectionChangeOnly=function(e){var t,r,i;if(_.size(e)>1||e[0].objectName!==Gi)return!1;var n=e[0].propertySlice,o=n.value;return!!(_.isEmpty(null===(t=o.itemUpdates)||void 0===t?void 0:t.adds)&&_.isEmpty(null===(r=o.itemUpdates)||void 0===r?void 0:r.deletes)&&_.isEmpty(null===(i=o.itemUpdates)||void 0===i?void 0:i.renames))&&this.selectedListEditorItems.get(n.name)!==_.findIndex(o.items,function(u){return _.isEqual(u.value,o.selectedItem.value)})},a.prototype.saveProperties=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n,o;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return o=_.partition(e,function(l){return"Page"===l.formattingSource}),r=o[0],i=o[1],_.isEmpty(r)?[3,2]:[4,this.pageFormattingService.saveProperties(r,this.saveServices)];case 1:s.sent(),s.label=2;case 2:return _.isEmpty(i)?[3,4]:(n=i.map(function(l){var u=_.some(oi,function(c){return l.objectName===c.objectName});return(0,p.__assign)((0,p.__assign)({},l),{formattingSource:u?"Format_Label_General":l.formattingSource})}),[4,this.saveCanvasProperties(n,t)]);case 3:s.sent(),s.label=4;case 4:return[2]}})})},a.prototype.saveCanvasProperties=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,n=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return r=_.groupBy(e,function(s){return s.formattingSource}),i=[],this.saveServices.undoRedo.register("SaveFormattingValues",function(){for(var s in r)for(var c=0,d=n.getChangesPerCanvasItem(r[s]);c<d.length;c++){var v=d[c];switch(s){case"Format_Label_General":n.canvasItemFormattingService.saveProperties(v.changes,n.saveServices,v.canvasItem,t);break;case"Visual":n.visualFormattingService.saveProperties(v.changes,n.saveServices,v.canvasItem,t);break;case"Analytics":i.push(n.analyticsFormattingService.saveProperties(v.changes,v.canvasItem,t))}}}),[4,Promise.all(i)];case 1:return o.sent(),[2]}})})},a.prototype.getChangesPerCanvasItem=function(e){var t={},r={};e.forEach(function(o){o.canvasItems.forEach(function(s){var l=s.name;r[l]=s,t[l]||(t[l]=[]);var u=(0,p.__assign)({},o);t[l]=(0,p.__spreadArray)((0,p.__spreadArray)([],t[l],!0),[u],!1)})});var i=[];for(var n in t)i.push({canvasItem:r[n],changes:t[n].map(function(o){return(0,p.__assign)((0,p.__assign)({},o),{canvasItems:void 0})})});return i},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(ps.Ol,8),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(en.U),w.\u0275\u0275inject(Ii),w.\u0275\u0275inject(Ya),w.\u0275\u0275inject(Pi),w.\u0275\u0275inject(rn.r),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(fn),w.\u0275\u0275inject(Ja),w.\u0275\u0275inject(pn.l6),w.\u0275\u0275inject(cn.j),w.\u0275\u0275inject(Lt.y0),w.\u0275\u0275inject(Pr.f),w.\u0275\u0275inject(vn.t),w.\u0275\u0275inject(ei.z),w.\u0275\u0275inject(ut.$8),w.\u0275\u0275inject(bt.D),w.\u0275\u0275inject(xr.A),w.\u0275\u0275inject(tn.M))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),Jt=C(63057),As=C(37272),cr=C(82762),Wi=C(38860),yt=C(11547),kt=C(59973),er=C(83317),Lr=C(23558),Sn=C(22318),js=C(6663),rt=C(81905),zs=C(73805),Os=C(91615),Ms=C(95281),tr=C(85732),Gt=C(77526),Wt=function(e){return e},_n=function(){function a(){}return a.prototype.create=function(){return new ks},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac=function(t){return new(t||a)}}),a}(),ks=function(a){function e(){var t=a.call(this)||this;return t.setState({cards:void 0,groups:void 0,slices:void 0,revertToDefaultDescriptors:[],canvasItem:void 0}),t.state$.pipe((0,ki.q)(1)).subscribe(function(r){b.fF.assert(function(){return void 0===r.cards&&void 0===r.groups&&void 0===r.slices},"FormattingStore: state should be empty")}),t}return(0,p.__extends)(e,a),e.prototype.getViewModel$=function(){return this.select(Wt).pipe((0,kt.h)(function(t){return!(void 0===t.cards&&void 0===t.groups&&void 0===t.slices)}))},e.prototype.selectAllCards=function(){return this.select((0,tr.P1)(Wt,function(e){return e.cards}))},e.prototype.selectTopLevelToggle=function(t,r){return this.select(function(e,t){return(0,tr.P1)(Wt,function(r){var i,n=function(s){return(ce.hy(s.uid,e,(0,lr.O7)(s),t)||ce.zh(s.control.properties.descriptor)===e)&&(i=s,!0)};return r.cards&&Object.keys(r.cards).forEach(function(o){var l=r.cards[o].topLevelToggle;l&&n(l)&&(i=l)}),i||r.groups&&Object.keys(r.groups).forEach(function(o){var l=r.groups[o].topLevelToggle;l&&n(l)&&(i=l)}),i})}(t,r)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectGroup=function(t){return this.select(function(e){return(0,tr.P1)(Wt,function(t){return t.groups&&t.groups[e]})}(t)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectSlice=function(t,r){return this.select(function(e,t){return(0,tr.P1)(Wt,function(r){var i=(0,lr.$Q)(e,t);return r.slices&&r.slices[i]})}(t,r)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectCard=function(t){return this.select(function(e){return(0,tr.P1)(Wt,function(t){return t.cards&&t.cards[e]})}(t)).pipe((0,Gt.x)(_.isEqual))},e.prototype.getChartElementsContract$=function(){var t=this,r=(0,tr.P1)(Wt,function(i){return t.getChartElementsFormatContract(i)});return this.select(r).pipe((0,Gt.x)(_.isEqual))},e.prototype.getCanvasItem$=function(){var t=(0,tr.P1)(Wt,function(r){return r.canvasItem});return this.select(t).pipe((0,Gt.x)())},e.prototype.getChartElementsFormatContract=function(t){var r=[];return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&"Visual"===l.pivotSource&&r.push({formattingSource:l.originSource,displayName:l.displayName,description:l.description,checked:l.topLevelToggle.control.properties.value,uid:l.topLevelToggle.uid,descriptor:l.topLevelToggle.control.properties.descriptor,disabled:l.disabled,disabledReason:l.disabledReason,isAnalyticsPane:l.analyticsPane,warningMessage$:l.warningMessage$})}}(t.cards),_.isEmpty(r)?void 0:{items:r}},e.prototype.getCardTopLevelToggleUids$=function(){var t=this,r=(0,tr.P1)(Wt,function(i){return t.getCardTopLevelToggleUids(i)});return this.select(r).pipe((0,Gt.x)(_.isEqual))},e.prototype.getCardTopLevelToggleUids=function(t){var r=new Set;return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&r.add(l.topLevelToggle.uid)}}(t.cards),r},e}(Ms.m1),Gs=C(3307),Ws=C(21024),Hs=C(56083),bn=function(){function a(e,t,r){var i=this;this.localizationService=e,this.paneVisibilityService=t,this.tutorialPopupService=r,this.localCache={},this.destroy$=new ni.xQ,this.paneVisibilityService.getPanes$().pipe((0,Gs.T)(1),(0,kt.h)(function(n){return _.every(Object.values(n),function(o){return!o.isPaneVisible})}),(0,er.R)(this.destroy$)).subscribe(function(){i.startFormattingTutorial("PaneMoveTutorial")})}return a.prototype.startFormattingTutorial=function(e,t){switch(e){case"AnalyticsPaneMoveTutorial":this.localCache.AnalyticsPaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getAnalyticsPaneMoveTutorial(t));break;case"FieldPickerTutorial":this.localCache.FieldPickerTutorial||this.tutorialPopupService.startTutorial(this.getFieldPickerTutorial());break;case"DrillthroughTutorial":this.localCache.DrillthroughTutorial||this.tutorialPopupService.startTutorial(this.getDrillthroughPaneMoveTutorial());break;case"PaneMoveTutorial":this.localCache.PaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getPaneMoveTutorial());break;default:b.fF.assertFail("Unknown formatting tutorial type")}this.localCache[e]=!0},a.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},a.prototype.getPaneMoveTutorial=function(){var e,t="onObjectPaneMoveTutorial",r='ribbon [data-unique-id="view"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Title"),text:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},a.prototype.getAnalyticsPaneMoveTutorial=function(e){var t;b.fF.assertAnyValue(!!e,"options should be provided in the case of AnalyticsPaneMoveTutorial");var r="onObjectAnalyticsFormattingTutorial",i=e.selector;return{itemKeys:[r],items:(t={},t[r]={title:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Title"),text:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:r,canShow:function(){return!!$(i)},attachTo:function(){return $(i)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,offset:e.offset,arrowOffset:e.arrowOffset,closeOnBackdropClick:!0},t),isSequentialTutorial:!1}},a.prototype.getFieldPickerTutorial=function(){var e,t="onObjectFieldPickerTutorial",r="build-field-well field-picker-modern pbi-drag-drop-picker span div.selfAndChildrenContent";return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_FieldWell_Title"),text:this.localizationService.get("TutorialPopup_FieldWell_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r).first()},attachTo:function(){return $(r).first()},customClass:"trident no-icon big-popup",modalButtonClassOverride:"hidden",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},a.prototype.getDrillthroughPaneMoveTutorial=function(){var e,t="onObjectDrillthroughTutorial",r='[data-unique-id="Page-pageInformation"] [data-testid="formatting-card-button"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Title"),text:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(Ws.r),w.\u0275\u0275inject(Hs.yU))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}();function Hi(a){return void 0!==a?_.omit(a,"deferredStatus"):void 0}function Qs(a,e){return void 0!==a?(0,p.__assign)((0,p.__assign)({},a),{deferredStatus:e}):void 0}var Ki="page",Qi=function(){function a(e,t,r,i,n,o,s,l,u,c,d,v){this.sliceCustomizationService=e,this.eventBridge=t,this.explorationNavigationService=r,this.explorationCapabilities=i,this.featureSwitchService=n,this.formattingModelService=o,this.formattingStoreFactory=s,this.formattingTutorialService=l,this.runningVisual=u,this.selectionService=c,this.visualPluginOperationsService=d,this.visualPluginService=v,this.updateCounter=0,this.currentUpdateIds=new Map,this.formattingStores=new Map,this.destroy$=new ni.xQ;var h=this.selectionService.selectedElements$.pipe((0,de.U)(function(f){var m;return null!==(m=f?.reduce(function(g,y){var D=y.canvasItem;return D&&g.push(D),g},[]))&&void 0!==m?m:[]}),(0,Dr.d)(1));this.initUpdateHandlers(h),this.initPauseHandlers(h)}return a.prototype.initUpdateHandlers=function(e){var h,t=this,r=function(){t.updateStateInt(t.getNonVisualUpdateSources(),void 0)},n=function(j){j.forEach(function(R){return function(j){t.updateStateInt(t.getVisualUpdateSources(),j)}(R)})},o=this.formattingModelService.getContainerChanged$().pipe((0,de.U)(function(x){return x.canvasItems})),s=this.eventBridge.on(Ge.wAN),l=this.eventBridge.on(Ge.WJC).pipe((0,kt.h)(function(x){return!!x.allowInlineExplorationChanged})),u=this.eventBridge.on(Ge.TTT),c=this.eventBridge.on(Ge.jsX),d=this.explorationNavigationService.sections$,v=this.eventBridge.on(Os.kx);(0,Jt.T)(s,l,u,c,d,v,o.pipe((0,kt.h)(function(x){return _.isEmpty(x)}))).pipe((0,er.R)(this.destroy$)).subscribe(function(){void 0===h&&(h=setTimeout(function(){r(),clearTimeout(h),h=void 0},100))});var P,m=this.eventBridge.on(Ge.Of1).pipe((0,Lr.M)(e),(0,de.U)(function(x){var j=x[0];return x[1].filter(function(k){return(0,Z.Vz)(k)&&j.affectContainer(k)})})),g=this.eventBridge.on(Ge.jCS).pipe((0,Lr.M)(e),(0,de.U)(function(x){var j=x[0];return x[1].filter(function(k){return(0,Z.Vz)(k)&&j.affectContainer(k)&&(0,sr.LR)(t.visualPluginService,t.visualPluginOperationsService,k)})})),y=(0,Jt.T)(g,m),D=this.eventBridge.on(Ge.D1A),T=this.eventBridge.on(Ge.DSN),q=(0,Jt.T)(D,T).pipe((0,er.R)(this.destroy$),(0,de.U)(function(x){return[x]})),F=this.eventBridge.on(Ge.KD7).pipe((0,de.U)(function(x){return x.changedItems})),N=e.pipe((0,er.R)(this.destroy$),(0,Sn.O)([]),(0,js.G)(),(0,de.U)(function(x){var k=_.difference(x[1],x[0]);return _.isEmpty(k)?[]:k})),V=new Map;(0,Jt.T)(y,F,o,N,q).pipe((0,er.R)(this.destroy$),(0,kt.h)(function(x){return!_.isEmpty(x)})).subscribe(function(x){x.forEach(function(j){V.set(j.name,j)}),void 0===P&&(P=setTimeout(function(){n(Array.from(V.values())),V.clear(),clearTimeout(P),P=void 0},100))}),this.destroy$.subscribe(function(){void 0!==P&&(clearTimeout(P),P=void 0),void 0!==h&&(clearTimeout(h),h=void 0)});var E=this.eventBridge.on(Ge.CCe),L=this.eventBridge.on(Ge.$$f);(0,Jt.T)(E,L).pipe((0,er.R)(this.destroy$)).pipe((0,Lr.M)(e)).subscribe(function(x){var R=x[1];r(),n(R)})},a.prototype.initPauseHandlers=function(e){var t=this,r=e.pipe((0,de.U)(function(o){return o.reduce(function(s,l){return s.push(l.name),s},[])})),i=this.eventBridge.on(Ge.KD7).pipe((0,er.R)(this.destroy$)),n=this.eventBridge.on(Ge.D1A).pipe((0,er.R)(this.destroy$));i.pipe((0,Lr.M)(r)).subscribe(function(o){var l=o[1],c=o[0].changedItems.filter(function(v){return!(0,sr.LR)(t.visualPluginService,t.visualPluginOperationsService,v)}).map(function(v){return v.name}),d=_.intersection(l,c);_.isEmpty(d)||t.pauseUpdatesForVisualContainers(d)}),n.subscribe(function(o){t.pauseUpdatesPromise&&t.resumeUpdateForVisualContainers([o.name])}),r.subscribe(function(o){var s=new Set(o);if(Array.from(t.formattingStores.keys()).forEach(function(f){if(!s.has(f)&&f!==Ki){var m=t.formattingStores.get(f);t.formattingStores.delete(f),m.ngOnDestroy()}}),t.pauseUpdatesPromise){for(var c=[],d=0,v=Array.from(t.pausedContainerNames.values());d<v.length;d++){var h=v[d];s.has(h)||c.push(h)}t.resumeUpdateForVisualContainers(c)}})},a.prototype.pauseUpdatesForVisualContainers=function(e){var t=this,r=this.pausedContainerNames=this.pausedContainerNames||new Set;e.forEach(function(i){return r.add(i)}),this.pauseUpdatesPromise||(this.pauseUpdatesPromise=new Promise(function(i){return t.pauseUpdatesResolver=i}))},a.prototype.resumeUpdateForVisualContainers=function(e){var t=this.pausedContainerNames;b.fF.assertValue(t,"pausedContainers"),e.forEach(function(r){return t.delete(r)}),0===t.size&&(this.pauseUpdatesResolver(),this.pauseUpdatesResolver=void 0,this.pauseUpdatesPromise=void 0,this.pausedContainerNames=void 0)},a.prototype.getViewModelIntl=function(e){return this.getStore$(e).pipe((0,rt.w)(function(t){return t.getViewModel$()}))},a.prototype.selectAllCardsIntl=function(e){return this.getStore$(e).pipe((0,rt.w)(function(t){return t.selectAllCards()}))},a.prototype.selectTopLevelToggleIntl=function(e,t,r){return this.getStore$(r).pipe((0,rt.w)(function(i){return i.selectTopLevelToggle(e,t)}))},a.prototype.selectGroupIntl=function(e,t){return this.getStore$(t).pipe((0,rt.w)(function(r){return r.selectGroup(e).pipe((0,de.U)(function(i){return Hi(i)}))}))},a.prototype.selectSliceIntl=function(e,t,r){return this.getStore$(r).pipe((0,rt.w)(function(i){return i.selectSlice(e,t).pipe((0,de.U)(function(n){return Hi(n)}))}))},a.prototype.selectCardIntl=function(e,t){return this.getStore$(t).pipe((0,rt.w)(function(r){return r.selectCard(e).pipe((0,de.U)(function(i){return Hi(i)}))}))},a.prototype.getChartElementsContractIntl=function(e){return this.getStore$(e).pipe((0,rt.w)(function(t){return t.getChartElementsContract$()}))},a.prototype.getCardTopLevelToggleUidsIntl=function(e){return this.getStore$(e).pipe((0,rt.w)(function(t){return t.getCardTopLevelToggleUids$()}))},a.prototype.getSubSelectablesIntl=function(e){var t=this;return e.pipe((0,rt.w)(function(r){if(1===r.type)return As.E;var i=r.canvasItem,n=(0,Jt.T)(t.eventBridge.on(Ge.D1A),t.eventBridge.on(Ge.DSN)).pipe((0,kt.h)(function(u){return u.name===i.name})),o=t.eventBridge.on(Ge.KD7).pipe((0,kt.h)(function(u){return _.some(u.changedItems,function(c){return c.name===i.name})})),s=t.eventBridge.on(Ge.jCS).pipe((0,kt.h)(function(u){return(0,Z.Vz)(i)&&u.affectContainer(i)}));return(0,Jt.T)(o,n,s).pipe((0,Sn.O)({}),(0,zs.h)({})).pipe((0,rt.w)(function(u){return(0,Z.Vz)(i)?t.runningVisual.getVisual$(i).pipe((0,rt.w)(function(d){return d?(0,cr.D)(d.getSubSelectables()):[]})):[]}))}),(0,Dr.d)({bufferSize:1,refCount:!0}))},a.prototype.getFor=function(e){var t=this,r=(0,Wi.b)(e)?e:(0,yt.of)(e);return{getCardTopLevelToggleUids$:function(){return t.getCardTopLevelToggleUidsIntl(r)},getChartElementsContract$:function(){return t.getChartElementsContractIntl(r)},getViewModel$:function(){return t.getViewModelIntl(r)},selectAllCards:function(){return t.selectAllCardsIntl(r)},selectCard:function(n){return t.selectCardIntl(n,r)},selectGroup:function(n){return t.selectGroupIntl(n,r)},selectSlice:function(n){var o=ce.zh(n);return t.selectSliceIntl(o,void 0,r)},selectTopLevelToggle:function(n){var o=ce.zh(n);return t.selectTopLevelToggleIntl(o,void 0,r)},getSubSelectables$:function(){return t.getSubSelectablesIntl(r)}}},a.prototype.getRevertToDefaultMetadata=function(e,t){return this.formattingModelService.getRevertToDefaultMetadata(e,t)},a.prototype.changeContainerDropdownValue=function(e,t){this.formattingModelService.changeContainerDropdownValue(e,t)},a.prototype.getFormattingStoreForCanvasItem=function(e){var t;return this.formattingStores.has(t=1===e.type?Ki:e.canvasItem.name)||this.formattingStores.set(t,this.formattingStoreFactory.create()),this.formattingStores.get(t)},a.prototype.getStore$=function(e){var t=this;return e.pipe((0,de.U)(function(r){return t.getFormattingStoreForCanvasItem(r)}))},a.prototype.updateStateInt=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u,c,d;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return _.isEmpty(e)?[2]:(i=1===e.length&&"Page"===e[0]?Ki:t.name,n=this.updateCounter++,this.currentUpdateIds.set(i,n),this.pauseUpdatesPromise?[4,this.pauseUpdatesPromise]:[3,2]);case 1:if(h.sent(),this.currentUpdateIds.get(i)!==n)return[2];h.label=2;case 2:o={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:t?new wr.lD(t,function(f){return f===t||f&&t&&t.name===f.name}):void 0},s=this.featureSwitchService.featureSwitches.onObject,l=function(m){var g,y,D,T,q,F,N,V,P,O,E,B;return(0,p.__generator)(this,function(x){switch(x.label){case 0:return b.fF.assert(function(){return!s||"Analytics"!==m},"Should not be asking for Analytics with OnObject (it is part of Visuals)"),g=function(R,k){for(var re={},ne=0,J=Object.keys(R);ne<J.length;ne++){var se=J[ne];re[se]=Qs(R[se],k)}return re},[4,u.formattingModelService.getFormattingOptions(t,m)];case 1:for(B=x.sent(),y=B.cards,D=B.groups,T=B.slices,q=B.revertToDefaultDescriptors,u.featureSwitchService.featureSwitches.interactiveMobileCanvas&&(null===(r=u.sliceCustomizationService)||void 0===r||r.customizeSliceOptions(T)),F=g(y,1),N=g(D,1),V=g(T,1),P=0,O=Object.keys(F);P<O.length;P++)F[E=O[P]]=(0,p.__assign)((0,p.__assign)({},y[E]),{deferredStatus:1});return b.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.cards),_.keys(F)))},"Expected no cards to have duplicate uids"),b.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.groups),_.keys(N)))},"Expected no groups to have duplicate uids"),o.cards=(0,p.__assign)((0,p.__assign)({},o.cards),F),o.groups=(0,p.__assign)((0,p.__assign)({},o.groups),N),o.slices=(0,p.__assign)((0,p.__assign)({},o.slices),V),o.revertToDefaultDescriptors=(0,p.__spreadArray)((0,p.__spreadArray)([],o.revertToDefaultDescriptors,!0),q,!0),[2]}})},u=this,c=0,d=e,h.label=3;case 3:return c<d.length?[5,l(d[c])]:[3,6];case 4:h.sent(),h.label=5;case 5:return c++,[3,3];case 6:return this.currentUpdateIds.get(i)!==n||(this.updateFormattingContract(o,t),this.currentUpdateIds.delete(i)),[2]}})})},a.prototype.getVisualUpdateSources=function(){var e=["Format_Label_General","Visual"];return this.featureSwitchService.featureSwitches.onObject||e.push("Analytics"),e},a.prototype.getNonVisualUpdateSources=function(){return["Page"]},a.prototype.updateFormattingContract=function(e,t){var r=this.getFormattingOptions(t);this.getFormattingStoreForCanvasItem(r).setState(e)},a.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},a.prototype.saveValues=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,n,o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:i=e.changes.some(function(v){return"Page"===v.formattingSource}),n=[],o=function(h){var f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return h.conditionalFormatting?(b.fF.assert(function(){return!h.canvasItems||1===h.canvasItems.length},"Conditional formatting is only supported for single canvas item or page formatting"),f=s.getFormattingOptions(null===(r=h.canvasItems)||void 0===r?void 0:r[0]),[4,s.getFor(f).selectSlice({objectName:h.objectName,propertyName:h.propertySlice.name,selector:h.propertySlice.selector}).pipe((0,ki.q)(1)).toPromise()]):[3,2];case 1:if((m=g.sent())&&m.saveCallback)return m.saveCallback(e),[2,"continue"];g.label=2;case 2:return n.push(h),[2]}})},s=this,l=0,u=e.changes,d.label=1;case 1:return l<u.length?[5,o(u[l])]:[3,4];case 2:d.sent(),d.label=3;case 3:return l++,[3,1];case 4:return _.isEmpty(n)?[2]:(e.changes=n,[4,this.formattingModelService.saveFormattingSlicesValue(e.changes,t)]);case 5:return d.sent(),i&&this.updateStateInt(["Page"],void 0),[2]}})})},a.prototype.isEditableContainerWithSelectionChangeOnly=function(e){return this.formattingModelService.isEditableContainerWithSelectionChangeOnly(e.changes)},a.prototype.revertToDefault=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,this.formattingModelService.revertToDefault(e,t,r)]})})},a.prototype.getRevertToDefaultEnabled=function(e,t,r){return this.formattingModelService.getRevertToDefaultEnabled(e,t,r)},a.prototype.getModelUnavailableInformation=function(e,t){return this.formattingModelService.getModelUnavailableInformation(e,t)},a.prototype.getFormattingModelMessage=function(e,t){return this.formattingModelService.getFormattingModelMessage(e,t)},a.prototype.startFormattingTutorial=function(e,t){this.explorationCapabilities.getCapabilities().disableFormattingTutorial||this.formattingTutorialService.startFormattingTutorial(e,t)},a.prototype.getFormattingOptions=function(e){return e?{type:0,canvasItem:e}:{type:1}},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(wr.Kj,8),w.\u0275\u0275inject(un.J),w.\u0275\u0275inject(Xt.z),w.\u0275\u0275inject(Ri.U),w.\u0275\u0275inject(ot.vZ),w.\u0275\u0275inject(yn),w.\u0275\u0275inject(_n),w.\u0275\u0275inject(bn),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Ir.z),w.\u0275\u0275inject(ri.f),w.\u0275\u0275inject(bt.D))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),$s={provide:"formattingService",useFactory:function(a){return Promise.resolve(a)},deps:[Qi]},lt=C(59017),pt=C(64560),Xs=C(5838),Zs=C(44104),Js=C(19650),pr=C(92755);function Cn(a){return a.flatMap(function(e){return function(a){var e=[];switch(a.type){case 8:e.push.apply(e,Cn(a.shortcuts));break;case 0:a.relatedResetFormattingIds&&e.push.apply(e,a.relatedResetFormattingIds);break;case 2:a.relatedToggledFormattingIds&&e.push.apply(e,a.relatedToggledFormattingIds);case 3:case 6:e.push(a);break;case 9:e.push.apply(e,a.referencesAndValues);break;case 4:case 1:case 5:case 7:case 10:break;default:b.fF.assertNever(a)}return e}(e)})}var rl=C(86940),wn=function(){function a(e,t,r,i,n,o,s){this.formattingService=e,this.injector=t,this.itemPickerService=r,this.localizationService=i,this.overlay=n,this.runningVisual=o,this.selectionService=s,this.destroy$=new ni.xQ}return a.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},a.prototype.openColorPicker=function(e,t,r,i){var n=this;if(e){var o=e&&e.properties,s=o&&o.conditionalFormattingObjects,l=e.resolvedValue;return(0,Zs.Z)({itemPickerService:this.itemPickerService,localizationService:this.localizationService,overlay:this.overlay,injector:this.injector,connectedTo:t,isNoFillItemSupported:!1,backDropClass:"invisible-backdrop",conditionalFormattingOptions:!!s&&{showDialog:function(){(0,cr.D)(s.showDialog()).subscribe(function(h){h&&h.shouldSave&&n.saveChanges([h.value],e.instances,i)})},isSet:s.isSet},setColor:function(h){if(h&&(h.value!==l?.value||s?.isSet)){var f=[];s?.isSet&&f.push(null),f.push(h),n.saveChanges(f,e.instances,i)}},closed:r,color:l,defaultColor:void 0,overlayHeight:s?400:362,overlayWidth:310})}},a.prototype.onControlClicked=function(e,t,r){var i=t.key;switch(i){case"horizontalAlignment":var n=e.horizontalAlignment;if(!n)return;var o=this.getAlignmentSaveValue(t.value,n.instances);return this.saveChanges([o],n.instances,r);case"increaseFontSize":return this.adjustFontSize(1,e,r);case"decreaseFontSize":return this.adjustFontSize(-1,e,r);case"decreaseDecimal":return this.adjustDecimal(-1,e,r);case"increaseDecimal":return this.adjustDecimal(1,e,r);case"background":case"fill":case"fontColor":case"stroke":case"border":case"grid":b.fF.assertFail("".concat(i," should not be handled here"));break;case"height":case"width":case"displayUnits":case"wordWrap":case"bold":case"italic":case"fontSize":case"underline":case"fontFamily":return(s=e[i])?this.saveChanges([t.value],s.instances,r):void 0;case"shadow":var s;return(s=e[i])?this.saveShadowChanges(t.value,e,r):void 0;default:b.fF.assertNever(i)}},a.prototype.adjustDecimal=function(e,t,r){var i=t.precision,n=i&&i.properties;if(n){var o=_.compact(_.map(i.instances,function(s){var l;if(!s.disabled||s.overrideDisabled){var u=_.isNumber(i.resolvedValue)?i.resolvedValue:null!==(l=n.defaultPrecision)&&void 0!==l?l:0,c=Math.max(0,u+=e);return(0,pr.ks)(c,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}}));if(!_.isEmpty(o))return this.formattingService.saveValues({changes:o},r)}},a.prototype.adjustFontSize=function(e,t,r){var i,n,o,s,l=t.fontSize,u=l&&l.properties;if(u){var c=null==(null===(n=null===(i=u.options)||void 0===i?void 0:i.minValue)||void 0===n?void 0:n.value)?wr.r4:u.options.minValue.value,d=null==(null===(s=null===(o=u.options)||void 0===o?void 0:o.maxValue)||void 0===s?void 0:s.value)?wr.YR:u.options.maxValue.value,v=_.map(l.instances,function(h){if(!h.disabled||h.overrideDisabled){var f=h.currentValue,m=Math.min(Math.max(f+e,c),d);if(m!==f)return(0,pr.ks)(m,h.descriptor,h.uid,h.formattingSource,[h.canvasItem],1)}});if(v=_.compact(v),!_.isEmpty(v))return this.formattingService.saveValues({changes:v},r)}},a.prototype.saveChanges=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(n){return i=_.flatten(_.map(e,function(o){return _.compact(_.map(t,function(s){return s.disabled&&!s.overrideDisabled?void 0:(0,pr.ks)(o,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}))})),_.isEmpty(i)?[2]:[2,this.formattingService.saveValues({changes:i},r)]})})},a.prototype.getAlignmentSaveValue=function(e,t){var r=t[0].descriptor.type;if(b.fF.assert(function(){return _.every(t,function(n){return n.descriptor.type===r})},"MiniToolbar alignment - expected all the descriptors to have same property type"),gt.Ge.isValueTypeDescriptor(r)){var i=gt.Ge.fromDescriptor(r);if(i.enum===Js.K)return wr.y5[e];if(i.formatting.alignment)return e;b.fF.assertFail("MiniToolbar alignment - unexpected descriptor property type")}else b.fF.assertFail("MiniToolbar alignment - not a value type descriptor")},a.prototype.saveShadowChanges=function(e,t,r){var s=t.shadowPreset.instances,l=t.shadowPosition.instances,u=t.shadow.instances;b.fF.assert(function(){return s.length===l.length&&s.length===u.length},"shadow - expected all the instances to have same length");for(var c=[],d=function(f){if(u[f].disabled)return"continue";var m=u[f],g=s[f],y=l[f],D=e.shadowPreset,T=e.shadowPosition,q=e.shadow,F=g.descriptor,N=y.descriptor,V=m.descriptor,P=g.uid,O=y.uid,E=m.uid,L=g.formattingSource,B=y.formattingSource,x=m.formattingSource,j=m.canvasItem;b.fF.assert(function(){return j===g.canvasItem&&j===y.canvasItem},"shadow - expected all the instances to have same canvasItem");var R=(0,pr.ks)(D,F,P,L,[j],1),k=(0,pr.ks)(T,N,O,B,[j],1),re=(0,pr.ks)(q,V,E,x,[j],1);c.push(re,k,R)},v=0;v<u.length;v++)d(v);if(!_.isEmpty(c))return this.formattingService.saveValues({changes:c},r)},a.prototype.getSubSelectionStyleShortcutsForNonCanvasItems$=function(e){return this.getMenuItems$(e,void 0,void 0,void 0).pipe((0,de.U)(function(r){return{items:_.flatten(r)}}))},a.prototype.getSubSelectionStyleShortcutsForCanvasItems$=function(e){var t=this;return((0,Wi.b)(e)?e:(0,yt.of)(e)).pipe((0,rt.w)(function(i){var n,o=(n=(0,Z.rQ)(i))[0],s=n[1];if(_.isEmpty(o)||!_.isEmpty(s))return(0,yt.of)({items:[]});var l=_.map(o,function(u){var c=t.runningVisual.getVisual$(u),v=t.getActiveSubSelectables$(t.formattingService.getFor({type:0,canvasItem:u}),u);return(0,lt.aj)([c,v]).pipe((0,rt.w)(function(h){var f=h[0],m=h[1],g=(0,lt.aj)(_.compact(_.map(m,function(D){return f&&(0,cr.D)(f.getSubSelectionStyles([D]))}))),y=(0,lt.aj)(_.compact(_.map(m,function(D){return f&&(0,cr.D)(f.getSubSelectionShortcuts([D],void 0))})));return(0,lt.aj)([g,y]).pipe((0,de.U)(function(D){var q=D[1];return{canvasItem:u,visual:f,subSelectionStyles:_.compact(D[0]),subSelectionShortcuts:_.compact(_.flatten(q))}}))}))});return(0,lt.aj)(l).pipe((0,rt.w)(function(u){var c=_.map(u,function(d){return t.getMenuItems$(d.subSelectionShortcuts,d.canvasItem,d.subSelectionStyles,d.visual)});return(0,lt.aj)(c).pipe((0,de.U)(function(d){return{items:_.flatten(d)}}))}))}),(0,Dr.d)({bufferSize:1,refCount:!0}))},a.prototype.getSubSelectionStylesSlices$=function(e){var t=(0,Wi.b)(e)?e:(0,yt.of)(e);return this.getSubSelectionStylesForMultipleVisuals$(t)},a.prototype.getSubSelectionStylesForMultipleVisuals$=function(e){var t=this;return e.pipe((0,rt.w)(function(r){var i,n=(i=(0,Z.rQ)(r))[0],o=i[1];if(_.isEmpty(n)||!_.isEmpty(o))return(0,yt.of)({});if(1===n.length)return t.getVisualSubSelectionStylesSlicesForSingleVisual$(n[0]);var s=_.map(n,function(l){return{canvasItem:l,subSelectionStyles$:t.getVisualAreaSubSelectionStyles$(l)}});return t.getSubSelectionSlicesFromStyles$(s)}),(0,Dr.d)({bufferSize:1,refCount:!0}),(0,Gt.x)(function(r,i){return _.isEqual(r,i)}))},a.prototype.getActiveSubSelectables$=function(e,t){var r=e.getSubSelectables$().pipe((0,de.U)(function(o){return o.find(function(s){return(0,ce.so)(s)})})),i=this.selectionService.getSubSelections$(t).pipe((0,de.U)(function(o){return _.map(o,function(s){return s.visualSubSelection})}));return(0,lt.aj)([r,i]).pipe((0,de.U)(function(o){var s=o[0],l=o[1];return _.isEmpty(l)?s?[s]:[]:l}))},a.prototype.getVisualSubSelectionStylesSlicesForSingleVisual$=function(e){var t=this,i=this.getActiveSubSelectables$(this.formattingService.getFor({type:0,canvasItem:e}),e),n=this.runningVisual.getVisual$(e),o=(0,lt.aj)([i,n]).pipe((0,rt.w)(function(s){var l=s[0],u=s[1];if(!u)return(0,yt.of)([]);var c=_.map(l,function(d){return(0,ce.so)(d)?t.getVisualAreaSubSelectionStyles$(e):(0,cr.D)(u.getSubSelectionStyles([d]))});return(0,lt.aj)(c).pipe((0,de.U)(function(d){return _.compact(_.flatten(d))}))}));return this.getSubSelectionSlicesFromStyles$([{subSelectionStyles$:o,canvasItem:e}])},a.prototype.getVisualAreaSubSelectionStyles$=function(e){var t=this.runningVisual.getVisual$(e),i=this.formattingService.getFor({type:0,canvasItem:e}).getSubSelectables$();return(0,lt.aj)([i,t]).pipe((0,rt.w)(function(n){var o=n[0],s=n[1];if(!s)return(0,yt.of)([]);var l=_.map(o,function(u){return(0,cr.D)(s.getSubSelectionStyles([u])).pipe((0,de.U)(function(c){if(c){if((0,ce.so)(u))return c;if(1===c.type||2===c.type)return{fontColor:"fontColor"in c?c.fontColor:void 0,fontFamily:"fontFamily"in c?c.fontFamily:void 0,fontSize:"fontSize"in c?c.fontSize:void 0,bold:"bold"in c?c.bold:void 0,italic:"italic"in c?c.italic:void 0,underline:"underline"in c?c.underline:void 0,type:c.type}}}))});return(0,lt.aj)(l).pipe((0,de.U)(function(u){return _.compact(u)}))}))},a.prototype.getSubSelectionSlicesFromStyles$=function(e){var t=this,r=_.map(e,function(i){var n=i.canvasItem;return i.subSelectionStyles$.pipe((0,de.U)(function(s){return _.map(s,function(l){return{subSelectionStyle:l,canvasItem:n}})}))});return(0,lt.aj)(r).pipe((0,rt.w)(function(i){for(var n=(0,yt.of)({}),s=function(f,m){n=n.pipe((0,rt.w)(function(g){return t.getBoundSubSelectionStylesSlices$(f,g,m)}))},l=0,u=_.flatten(i);l<u.length;l++){var c=u[l];s(c.subSelectionStyle,c.canvasItem)}return n}))},a.prototype.getBoundSubSelectionStylesSlices$=function(e,t,r){var i=this,n={type:0,canvasItem:r},o=e??{},s=_.map(Object.keys(o),function(l){var u=o[l];if("type"!==l&&u&&(0,ce.N6)(u)){var c=u.reference;return c?i.mergeSliceAndTopLevelToggle(i.formattingService.getFor(n),c).pipe((0,de.U)(function(d){if(d)return i.getSubSelectionStylesSlices(d,u,l,t,r)})):(0,yt.of)(void 0)}return(0,yt.of)(void 0)});return(0,lt.aj)(s).pipe((0,de.U)(function(l){return l.reduce(function(u,c){return c&&(u=(0,p.__assign)((0,p.__assign)({},u),c)),u},t)}),(0,Dr.d)({bufferSize:1,refCount:!0}))},a.prototype.getSubSelectionStylesSlices=function(e,t,r,i,n){var o,s,l,u,c,d,v,h={};switch(r){case"background":case"color":case"fill":case"fontColor":case"stroke":var f=!0,m=this.resolveBaseProperties(e,t,null===(o=i[r])||void 0===o?void 0:o.properties,f);h[r]=this.getStylesForColorPicker(e,m,i[r],n,f);break;case"horizontalAlignment":m=this.resolveBaseProperties(e,t,null===(s=i[r])||void 0===s?void 0:s.properties),h[r]=this.getStylesForAlignmentGroup(e,m,i[r],n);break;case"fontSize":case"height":case"width":case"precision":m=this.resolveBaseProperties(e,t,null===(l=i[r])||void 0===l?void 0:l.properties),h[r]=this.getStylesForNumUpDown(e,m,t,i[r],n);break;case"fontFamily":m=this.resolveBaseProperties(e,t,null===(u=i[r])||void 0===u?void 0:u.properties),h[r]=this.getStylesForFontFamily(e,m,i,n);break;case"shadowPreset":case"shadowPosition":case"style":case"displayUnits":m=this.resolveBaseProperties(e,t,null===(c=i[r])||void 0===c?void 0:c.properties),h[r]=this.getStylesForDropdown(e,m,i[r],n);break;case"bold":case"italic":case"underline":case"shadow":case"grid":case"wordWrap":m=this.resolveBaseProperties(e,t,null===(d=i[r])||void 0===d?void 0:d.properties),h[r]=this.getStylesForToggleSwitch(e,m,i[r],n);break;case"border":m=this.resolveBaseProperties(e,t,null===(v=i[r])||void 0===v?void 0:v.properties),h[r]=this.getStylesForFlagsSelection(e,m,i[r],n);break;default:b.fF.assertNever(r)}return h},a.prototype.getIdentifierForSlice=function(e,t,r,i,n){return{currentValue:t,descriptor:r,formattingSource:e.originSource,uid:e.uid,canvasItem:i,disabled:e.disabled,overrideDisabled:n}},a.prototype.resolveBaseProperties=function(e,t,r,i){return void 0===i&&(i=!1),{disabled:e.disabled&&(!r||r.disabled)&&!i,label:t.label}},a.prototype.getStylesForColorPicker=function(e,t,r,i,n){var o=e.control;if("ColorPicker"!==o.type||(0,S.IW)(e)||ce.Ky(e))return b.fF.assertFail("Expected a ColorPicker type to get color properties."),r;var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,i,n),r?.instances),l=this.resolveValue(o.properties.value,r?.resolvedValue);return{instances:s,properties:(0,p.__assign)((0,p.__assign)({},t),{conditionalFormattingObjects:r?void 0:e.conditionalFormattingObjects}),resolvedValue:l}},a.prototype.getStylesForNumUpDown=function(e,t,r,i,n){var o=e.control;if("NumUpDown"===o.type&&!(0,S.IW)(e)){var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,n),i?.instances),l=this.resolveValue(o.properties.value,i?.resolvedValue);return{instances:s,properties:(0,p.__assign)((0,p.__assign)({},t),{options:o.properties.options,defaultPrecision:r.defaultPrecision}),resolvedValue:l}}b.fF.assertFail("Expected a NumUpDown type to get spin button properties")},a.prototype.getStylesForAlignmentGroup=function(e,t,r,i){var n=e.control;if("AlignmentGroup"!==n.type||(0,S.IW)(e))return b.fF.assertFail("Expected a AlignmentGroup type to get alignment properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,n.properties.value,e.control.properties.descriptor,i),r?.instances),s=r?r.resolvedValue===n.properties.value?n.properties.value:void 0:n.properties.value;return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},a.prototype.getStylesForDropdown=function(e,t,r,i){var n=e.control;if("Dropdown"!==n.type||(0,S.IW)(e)||!(0,qe.WN)(n.properties))return b.fF.assertFail("Expected a Dropdown type to get Dropdown properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,n.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(n.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)((0,p.__assign)({},t),{items:n.properties.items}),resolvedValue:s}},a.prototype.getStylesForFlagsSelection=function(e,t,r,i){var n=e.control;if("FlagsSelection"!==n.type||(0,S.IW)(e))return b.fF.assertFail("Expected a FlagsSelection type to get FlagsSelection properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,n.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(n.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},a.prototype.getStylesForToggleSwitch=function(e,t,r,i){var n=e.control;if("ToggleSwitch"!==n.type||(0,S.IW)(e))return b.fF.assertFail("Expected a ToggleSwitch type to get toggle button properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,n.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(n.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},a.prototype.getStylesForFontFamily=function(e,t,r,i){var n=e.control;if("FontPicker"!==n.type||(0,S.IW)(e))return b.fF.assertFail("Expected a FontPicker type to get Font Family properties"),r.fontFamily;var o=r.fontFamily,s=this.resolveInstances(this.getIdentifierForSlice(e,n.properties.value,e.control.properties.descriptor,i),o?.instances),l=this.resolveValue(n.properties.value,o?.resolvedValue);return{instances:s,properties:(0,p.__assign)({},t),resolvedValue:l}},a.prototype.resolveValue=function(e,t){return void 0!==t?_.isEqual(t,e)?e:null:e},a.prototype.resolveInstances=function(e,t){return t?(0,p.__spreadArray)((0,p.__spreadArray)([],t,!0),[e],!1):[e]},a.prototype.mergeSliceAndTopLevelToggle=function(e,t){var r=e.selectSlice(t),i=e.selectTopLevelToggle(t).pipe((0,kt.h)(function(n){return!!n}));return(0,Jt.T)(r,i)},a.prototype.getMenuItems$=function(e,t,r,i){for(var n=this.formattingService.getFor(t?{type:0,canvasItem:t}:{type:1}),o=[],s=!1,l=0,u=e??[];l<u.length;l++){var c=u[l];if(!c.suppressOnUI){var d=void 0;switch(c.type){case 0:case 10:d=this.getResetShortcut$(c,e.some(function(v){return 4===v.type}),t,e,r,n);break;case 1:d=this.getNavigateShortcut$(c,t,n);break;case 2:d=this.getToggleShortcut$(c,t,n);break;case 3:d=this.getPickerShortcut$(c,t,n);break;case 5:d=this.getCustomActionShortcut$(c,t);break;case 4:s||(s=!0,d=this.getSortShortcut$(c,t,e,i));break;case 6:d=this.getConditionalFormattingShortcut$(c,t,n);break;case 7:d=this.getDivider$();break;case 8:d=this.getSubMenuShortcut$(c,t,n);break;case 9:d=this.getSetValueShortcut$(c,t)}d&&o.push(d)}}return(0,lt.aj)(o).pipe((0,de.U)(function(v){return _.flatten(v).filter(function(h){return!!h})}),(0,Gt.x)(function(v,h){return _.isEqual(v,h)}))},a.prototype.getResetShortcut$=function(e,t,r,i,n,o){var d,s=this,l=this.isResetSortDisabled(t,r),c=Cn(i);return n&&_.forEach(n,function(v){c.push.apply(c,function(a){var e=[];switch(a.type){case 2:a.displayUnits&&e.push(a.displayUnits.reference),a.precision&&e.push(a.precision.reference);case 1:a.background&&e.push(a.background.reference),a.horizontalAlignment&&e.push(a.horizontalAlignment.reference),a.wordWrap&&e.push(a.wordWrap.reference),"fontSize"in a&&a.fontSize&&e.push(a.fontSize.reference),"fontFamily"in a&&a.fontFamily&&e.push(a.fontFamily.reference),"bold"in a&&a.bold&&e.push(a.bold.reference),"italic"in a&&a.italic&&e.push(a.italic.reference),"underline"in a&&a.underline&&e.push(a.underline.reference),e.push(a.fontColor.reference);break;case 3:a.color&&e.push(a.color.reference),a.fill&&e.push(a.fill.reference),a.stroke&&e.push(a.stroke.reference),a.style&&e.push(a.style.reference),a.width&&e.push(a.width.reference);break;default:b.fF.assertNever(a)}return e}(v))}),(d=0===e.type?pr.cY(o,c,e.excludedResetFormattingIds):o.getViewModel$().pipe((0,de.U)(function(v){return v.revertToDefaultDescriptors}))).pipe((0,de.U)(function(v){return s.formattingService.getRevertToDefaultEnabled(r,v)})).pipe((0,Lr.M)(d),(0,de.U)(function(v){var h=v[0];return{type:pt.iB.Button,data:{type:0,revertToDefaultDescriptors:v[1],canvasItem:r},text:s.localizationService.get("Reset_To_Default"),disabled:!h&&l,icon:{type:0,glyph:"glyphicon pbi-glyph-reset"}}}))},a.prototype.isResetSortDisabled=function(e,t){var r=!0;if(e){var i=t.config.singleVisual,n=i.query;if(n){var o=n.defn.orderBy(),s=(0,X.II)(t),l=i.hasDefaultSort;r=s&&void 0===l||l||_.isEmpty(o)}}return r},a.prototype.getNavigateShortcut$=function(e,t,r){return r.selectAllCards().pipe((0,de.U)(function(n){return _.isEmpty(n)})).pipe((0,de.U)(function(n){return{type:pt.iB.Button,data:{type:1,shortcut:e,canvasItem:t},text:e.label,disabled:n,icon:{type:2,name:Xs.z.ChartStylesGallery_20}}}))},a.prototype.getToggleSwitch$=function(e,t){return this.mergeSliceAndTopLevelToggle(t,e).pipe((0,de.U)(function(r){return r?.control.properties}))},a.prototype.getToggleShortcut$=function(e,t,r){var i=this,n=e.relatedToggledFormattingIds,o=e.selector,s=this.getToggleSwitch$(e,r),l=(0,lt.aj)((0,p.__spreadArray)([s],(n??[]).map(function(u){return i.getToggleSwitch$(u,r)}),!0)).pipe((0,de.U)(function(u){return u.every(function(c){return c?.value})}));return(0,lt.aj)([s,l]).pipe((0,de.U)(function(u){var d=u[1];if(u[0]){var v=d?e.disabledLabel:e.enabledLabel;if(v){var h=n?n.map(function(g){return(0,p.__assign)((0,p.__assign)({},g),{nextValue:!d,selector:g.selector})}):[],m=(0,p.__assign)((0,p.__assign)({type:2,nextValue:!d},{objectName:e.objectName,propertyName:e.propertyName}),{selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"},relatedToggledFormattingIds:h});return{type:pt.iB.Button,data:{type:2,shortcut:m,canvasItem:t},text:v}}}}))},a.prototype.getConditionalFormattingShortcut$=function(e,t,r){var i=e.objectName,n=e.propertyName,o=e.selector,s=e.label;return r.selectSlice(e).pipe((0,de.U)(function(u){if(u)return{type:pt.iB.Button,data:{type:6,shortcut:{type:6,nextValue:!u.control.properties.value,objectName:i,propertyName:n,selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},canvasItem:t},text:s}}))},a.prototype.getPickerShortcut$=function(e,t,r){var i=this;return r.selectSlice(e).pipe((0,de.U)(function(o){return o&&o.control.properties})).pipe((0,de.U)(function(o){if(o&&!_.isEmpty(o.items))return{type:pt.iB.SubMenu,text:e.label,menu:{items:_.map(o.items,function(l,u){return function(u,c){return{type:pt.iB.Button,data:{type:3,shortcut:e,index:c,canvasItem:t},text:(0,De.G)(u.displayName,i.localizationService),checkable:!0,checked:_.isEqual(u,o.value)}}(l,u)})}}}))},a.prototype.getSubMenuShortcut$=function(e,t,r){var i=this,o=_.map(e.shortcuts,function(s){return function(l){switch(l.type){case 1:return i.getNavigateShortcut$(l,t,r);case 2:return i.getToggleShortcut$(l,t,r).pipe((0,de.U)(function(d){var v;if(d)return(0,p.__assign)((0,p.__assign)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 6:return i.getConditionalFormattingShortcut$(l,t,r).pipe((0,de.U)(function(d){var v;if(d)return(0,p.__assign)((0,p.__assign)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 7:return i.getDivider$()}}(s)});return(0,lt.aj)(o).pipe((0,de.U)(function(s){return{type:pt.iB.SubMenu,text:e.label,menu:{items:s.filter(function(l){return!!l})}}}))},a.prototype.getSortShortcut$=function(e,t,r,i){var o,s,n=this;return(!_.isEmpty(r)&&i?.sortServices?(0,cr.D)(i.sortServices.getSortableGroups()):(0,yt.of)([])).pipe((0,de.U)(function(c){var d=c.find(function(F){return F.key===e.key}),v=[];if(d){(s=d.fields.find(function(F){return F.active}))&&(o=d);for(var h=0,f=d.fields;h<f.length;h++){var m=f[h];v.push({type:pt.iB.Button,data:{type:4,sortGroup:d,sortField:m,sortDirection:s&&s.sortDirection?s.sortDirection:m.sortDirection?m.sortDirection:2,isSortField:!0,canvasItem:t},text:n.localizationService.format("Sort_SortBy",m.displayName),checkable:!0,checked:m.active})}}if(!_.isEmpty(v)){var g=v.length>1&&!s,y=void 0,D=void 0;if(1!==v.length||s)y=o,D=s;else{var T=v[0].data;y=T.sortGroup,D=T.sortField}var q=[{type:pt.iB.Button,data:{type:4,sortGroup:y,sortField:D,sortDirection:2,isSortField:!1,canvasItem:t},text:n.localizationService.get("Sort_Desc"),checkable:!0,checked:2===s?.sortDirection,disabled:g},{type:pt.iB.Button,data:{type:4,sortGroup:y,sortField:D,sortDirection:1,isSortField:!1,canvasItem:t},text:n.localizationService.get("Sort_Asc"),checkable:!0,checked:1===s?.sortDirection,disabled:g}];return{type:pt.iB.SubMenu,text:e.label,menu:{items:(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],v,!0),[{type:pt.iB.Divider}],!1),q,!0)}}}}))},a.prototype.getCustomActionShortcut$=function(e,t){return(0,yt.of)({type:pt.iB.Button,data:{type:5,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon},disabled:e.disabled})},a.prototype.getSetValueShortcut$=function(e,t){return(0,yt.of)({type:pt.iB.Button,data:{type:9,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon}})},a.prototype.getDivider$=function(){return(0,yt.of)({type:pt.iB.Divider})},a.\u0275fac=function(t){return new(t||a)(w.\u0275\u0275inject(Qi),w.\u0275\u0275inject(w.Injector),w.\u0275\u0275inject(_a.a),w.\u0275\u0275inject(et.o),w.\u0275\u0275inject(rl._),w.\u0275\u0275inject(It.s),w.\u0275\u0275inject(Ir.z))},a.\u0275prov=w.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac}),a}(),al={provide:C(87644).VO,useFactory:function(a){return Promise.resolve(a)},deps:[wn]},ol=function(){function a(){}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=w.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=w.\u0275\u0275defineInjector({providers:[dr,gr,Kr,Ii,wa,Ya,Pi,Fa,yn,Qi,$s,jr,_n,bn,wn,al,Ti,Ni,fn,Ja,Aa,Oa],imports:[A.CommonModule]}),a}()},42587:function(dt,We,C){"use strict";C.d(We,{F:function(){return b},j:function(){return p}});var A=C(78417);function p(S,H,te){return void 0===te&&(te=!1),1===S?{paneTitle:H.get("Tooltip"),paneTitleTooltip:H.get("Drillthrough_TooltipTitleTooltip"),linkFieldsDropZoneTitle:H.get(te?"PagePropertyPane_LinkFieldsDropZoneTitle_Tooltip":"DrillthroughLinks_Tooltip_Fields"),dropZoneText:H.get("FieldDropZone_TooltipLink_Watermark"),keepAllFiltersLabel:H.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:H.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip"),keepAllFiltersToggleForcedOnTooltip:H.format("Drillthrough_KeepAllFiltersForcedOnForTooltip_Tooltip",[H.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip")]),crossReportDrillthroughLabel:H.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:H.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:H.get("DrillthroughLinks_LinkTypeGroup_Tooltip")}:{paneTitle:H.get("Drillthrough"),paneTitleTooltip:H.get("Drillthrough_DrillthroughTitleTooltip"),linkFieldsDropZoneTitle:H.get(te?"PagePropertyPane_LinkFieldsDropZoneTitle_Drillthrough":"DrillthroughLinks_Drillthrough_Fields"),dropZoneText:H.get("FieldDropZone_DrillthroughLink_Watermark"),keepAllFiltersLabel:H.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:H.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip"),keepAllFiltersToggleForcedOnTooltip:H.format("Drillthrough_KeepAllFiltersForcedOnForDrillthrough_Tooltip",[H.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip")]),crossReportDrillthroughLabel:H.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:H.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:H.get("DrillthroughLinks_LinkTypeGroup_Drillthrough")}}function b(S,H,te,xe){var ae=(0,A.Dt)(S,H),Ne=(0,A.LM)(S,H)||ae,_e=!H||ae,ue=!!H&&2===H.type||xe&&!!H&&(void 0===H.type||0===H.type);return{keepAllFilters:{disabled:_e,value:Ne,tooltip:_e&&Ne?te.keepAllFiltersToggleForcedOnTooltip:te.keepAllFiltersTooltip},crossReportDrillthrough:{show:ue,disabled:!H,value:!!ue&&(0,A.aQ)(S,H),tooltip:te.crossReportDrillthroughTooltip},linkFieldsDropZoneTitle:te.linkFieldsDropZoneTitle,linkFieldsLinkTypeGroupTitle:te.linkFieldsLinkTypeGroupTitle}}},40702:function(dt,We,C){"use strict";C.d(We,{$0:function(){return Je},Es:function(){return Ke},G5:function(){return H},Lo:function(){return Te},Sd:function(){return Ze},TS:function(){return it},V1:function(){return X},Y$:function(){return G},Yu:function(){return I},_Z:function(){return ue},_m:function(){return Ft},cF:function(){return b},gW:function(){return jt},jG:function(){return Ve},lG:function(){return xe},rU:function(){return Ne},yw:function(){return Re}});var A=C(41114),p="PBI.ExploreUIAuthoring.ContextMenuButtonClicked",b=A.cx[p]=(0,A.b1)(p),S="PBI.ExploreUIAuthoring.RevertToDefaultClicked",H=A.cx[S]=(0,A.b1)(S),te="PBI.ExploreUIAuthoring.ExpansionButtonClicked",xe=A.cx[te]=(0,A.b1)(te),ae="PBI.ExploreUIAuthoring.FormattingPaneSearch",Ne=A.cx[ae]=(0,A.b1)(ae),_e="PBI.ExploreUIAuthoring.InsertSection",Je=A.cx[_e]=(0,A.b1)(_e),K="PBI.ExploreUIAuthoring.DeleteSection",Re=A.cx[K]=(0,A.b1)(K),Ae="PBI.ExploreUIAuthoring.VisualSession",ue=A.cx[Ae]=(0,A.b1)(Ae,{logExpAssignment:!0}),z="PBI.ExploreUIAuthoring.ReorderTabOrderByPosition",G=A.cx[z]=(0,A.b1)(z),ie="PBI.ReportCreationCopilot.RunSuggestQueries",ge=(A.cx[ie]=(0,A.b1)(ie),"PBI.AuthoringCopilotCreatePage.RunSuggestQueries"),be=(A.cx[ge]=(0,A.b1)(ge),"PBI.ReportCreationCopilot.PageValidation"),Ct=(A.cx[be]=(0,A.b1)(be),"PBI.ReportCreationCopilot.VisualValidation"),wt=(A.cx[Ct]=(0,A.b1)(Ct),"PBI.EX.ChangeFieldWell"),X=A.cx[wt]=(0,A.b1)(wt),nt="PBI.EX.ChangeAggregation",it=A.cx[nt]=(0,A.b1)(nt),ve="PBI.EX.RemoveConditionalFormatting",Ze=A.cx[ve]=(0,A.b1)(ve),ft="PBI.EX.RemoveDataBars",Dt=(A.cx[ft]=(0,A.b1)(ft),"PBI.EX.AnalyticsPane.Open"),W=(A.cx[Dt]=(0,A.b1)(Dt),"PBI.EX.AnalyticsPane.AddInstance"),I=A.cx[W]=(0,A.b1)(W),M="PBI.EX.AnalyticsPane.RemoveInstance",Y=(A.cx[M]=(0,A.b1)(M),"PBI.EX.AnalyticsPane.ForecastParameterUpdated"),ee=(A.cx[Y]=(0,A.b1)(Y),"PBI.EX.PropertyPane.OnValueChanged"),Te=A.cx[ee]=(0,A.b1)(ee),Se="PBI.EX.DrillthroughPane.ChangeLink",at=(A.cx[Se]=(0,A.b1)(Se),"PBI.EX.NavigateAndSelectVisual"),Ke=A.cx[at]=(0,A.b1)(at),je="PBI.EX.FieldWellAbnormalRename",Ve=A.cx[je]=(0,A.b1)(je),mt="PBI.EX.LaunchChangeDetectionDialog",Ft=A.cx[mt]=(0,A.b1)(mt),Ye="PBI.EX.PersonalizeVisual.ChangePerspective",jt=A.cx[Ye]=(0,A.b1)(Ye),Ht="PBI.ReportCreationCopilot.FeedbackLoop.UserResponse",Br=(A.cx[Ht]=(0,A.b1)(Ht),"PBI.ReportCreationCopilot.FeedbackLoop"),Ce=(A.cx[Br]=(0,A.b1)(Br),"PBI.ReportCreationCopilot.UserResponse"),w=(A.cx[Ce]=(0,A.b1)(Ce),"PBI.ReportCreationCopilot.StageCompleted"),Nt=(A.cx[w]=(0,A.b1)(w),"PBI.ReportCreationCopilot.TerminalAPIError"),ot=(A.cx[Nt]=(0,A.b1)(Nt),"PBI.ReportCreationCopilot.TerminalAgentError"),It=(A.cx[ot]=(0,A.b1)(ot),"PBI.ReportCreationCopilot.EnsureComplete"),Qe=(A.cx[It]=(0,A.b1)(It),"PBI.CopilotReportAuthoring.Authoring"),dr=(A.cx[Qe]=(0,A.b1)(Qe),"PBI.CopilotReportAuthoring.CreatePage"),hr=(A.cx[dr]=(0,A.b1)(dr),"PBI.Copilot.PageCreationTool"),Er=(A.cx[hr]=(0,A.b1)(hr),"PBI.CopilotReportAuthoring.SuggestTopics"),qr=(A.cx[Er]=(0,A.b1)(Er),"PBI.CopilotReportAuthoring.SummarizeDataset"),Kt=(A.cx[qr]=(0,A.b1)(qr),"PBI.CopilotReportAuthoring.CloseButtonClicked"),ke=(A.cx[Kt]=(0,A.b1)(Kt),"PBI.CopilotReportAuthoring.ValidateVisual"),Fr=(A.cx[ke]=(0,A.b1)(ke),"PBI.CopilotReportAuthoring.ValidateVisualAdHocQuery"),Ot=(A.cx[Fr]=(0,A.b1)(Fr),"PBI.CopilotScenario.Summary.Generated"),$t=(A.cx[Ot]=(0,A.b1)(Ot),"PBI.CopilotScenario.Answer.Generated"),le=(A.cx[$t]=(0,A.b1)($t),"PBI.CopilotScenario.Forecast.Generated"),Nr=(A.cx[le]=(0,A.b1)(le),"PBI.CopilotReportAuthoring.ValidateField"),mr=(A.cx[Nr]=(0,A.b1)(Nr),"PBI.ExploreCopilot.CopilotReferenceClicked"),Gr=(A.cx[mr]=(0,A.b1)(mr),"PBI.ExploreCopilot.CopilotReferenceHovered"),gr=(A.cx[Gr]=(0,A.b1)(Gr),"PBI.Copilot.OpenCopilotPaneEditModeFS");A.cx[gr]=(0,A.b1)(gr)},90617:function(){window.onObjectSprite={icons:[{type:"svg",id:"PBIData_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 q -110 0 -202 -14 q -92 -14 -166 -37 q -74 -22 -129 -49 q -56 -27 -93 -53 q -38 -26 -57 -48 q -19 -21 -19 -33 v -1250 q 0 -45 49 -91 q 49 -46 137 -83 q 88 -36 211 -59 q 122 -23 269 -23 q 147 0 270 23 q 122 23 210 59 q 88 37 137 83 q 49 46 49 91 v 1250 q 0 12 -19 33 q -19 22 -56 48 q -38 26 -93 53 q -56 27 -130 49 q -74 23 -166 37 q -92 14 -202 14 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIFormat_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"AudioBookmark_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1473 l -512 372 v -1691 h 1024 v 1691 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LaunchSelectionPane_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 922 h 922 v 102 h -819 v 819 h 819 v 103 h -922 m 922 -1526 v 399 h -307 v -717 h 1229 v 1127 h -12 m -265 307 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 1894 v -921 h 870 v 921 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 1946 h -922 v -1024 h 922 v 102 h -819 v 819 h 819 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1024 819 h -256 v -665 h 1126 v 1024 h -18 l -852 -758 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1843 205 h -1024 v 614 h -102 v -717 h 1229 v 1127 h -12 l -116 -103 h 25 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1440 1560 l -262 262 v -991 l 735 654 h -325 l 198 425 l -150 70 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1669 1536 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPerformanceAnalyzer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1895 1249 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -1004 732 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 m 1177 103 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 m -614 -359 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 m 921 512 v 102 h -307 v -307 h 102 v 205 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1587 q 0 85 22 162 q 21 77 61 145 h -698 v -1740 h 1332 v 665 h -461 v 270 q -58 42 -105 96 q -48 54 -81 118 q -34 64 -52 135 q -18 72 -18 149 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 973 1587 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1029 1843 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1587 1997 q -85 0 -159 -33 q -75 -32 -130 -88 q -56 -55 -88 -130 q -32 -74 -32 -159 q 0 -85 32 -160 q 32 -74 88 -130 q 55 -55 130 -87 q 74 -32 159 -32 q 85 0 160 32 q 74 32 130 87 q 55 56 88 130 q 32 75 32 160 q 0 85 -32 159 q -33 75 -88 130 q -56 56 -130 88 q -75 33 -160 33 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1843 1536 v 102 h -307 v -307 h 102 v 205 m 257 -287 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -446 835 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBISyncSlicer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 m -820 -1232 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 m 927 -512 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 m 888 256 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 922 1395 l 307 254 v 245 h -1075 v -614 h 102 v -70 q 145 70 307 70 q 99 0 189 -25 q 90 -25 170 -71 m 358 -723 h 614 v 461 h -710 q 38 -66 62 -140 q 23 -73 31 -154 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1894 154 v 307 h -614 v -307 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1093 1536 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 102 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1997 1075 v 181 l -307 256 v 485 h -308 v -485 l -307 -256 v -181 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1126 0 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIBuild_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z m1280-103q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"},{type:"path",className:"OfficeIconColors_m20",d:"M1792 736v-173h-512v-409h-512v716h-512v1024h768v-945l3-13q12-39 59-78 47-39 121-70 74-32 172-51 96-20 208-20 111 0 205 19z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z"},{type:"path",className:"OfficeIconColors_m20",d:"M1452 1989q62 8 135 8 73 0 136-7 62-8 112-20 50-13 86-28 36-16 55-32l21-17v-860l-2-9q-8-28-41-55-34-28-87-50-54-22-125-35-71-14-155-14-81 0-151 14-71 13-125 35-54 21-88 48-34 27-43 54l-2 9v863l20 17q19 16 55 32 35 15 86 27 50 12 113 20z"},{type:"path",className:"OfficeIconColors_m210",d:"M1587 819q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAddToChart_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95-10-1-20 0-60 0-104 20-44 19-77 52-33 33-58 75-26 42-51 87l-9 16q-27 41-62 73-35 32-73 56-38 23-77 40-40 16-77 26-87 26-179 29 23 47 73 80 49 32 110 53 60 21 125 33 65 11 121 17 55 5 94 6 38 1 45 1 80 0 165-27 84-27 153-77 69-50 113-122 44-72 44-161 0-12-1-24 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z m-835 754q-31-31-74-50 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46l-15 13q-19-46-52-77z m-398 495q-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64-69 24-144 24z m870-64h-354v111h354v355h111v-355h355v-111h-355v-354h-111v354z"},{type:"path",className:"OfficeIconColors_m26",d:"M754 1520q-69 24-144 24-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64z"},{type:"path",className:"OfficeIconColors_m25",d:"M808 975q62 0 113 19 51 19 87 55 36 35 56 87 20 51 20 116 0 89-44 161-44 72-113 122-69 50-153 77-85 27-165 27-7 0-45-1-39-1-94-6-56-6-121-17-65-12-125-33-61-21-110-53-50-33-73-80 92-3 179-29 37-10 77-26 39-17 77-40 38-24 73-56 35-32 62-73l9-16q25-45 51-87 25-42 58-75 33-33 77-52 44-20 104-20z m-198 569q75 0 144-24 68-24 121-64 52-41 83-94 31-53 31-110 0-89-46-135-47-47-135-47-38 0-65 11-27 11-49 34-23 22-44 57-22 34-48 80l-14 25q-30 45-67 81-37 35-77 62-40 27-82 47-42 20-82 33 38 11 80 20 42 8 85 14 43 5 85 8 42 2 80 2z"},{type:"path",className:"OfficeIconColors_m20",d:"M1060 1126l15-13q25-24 48-46 24-24 49-48 25-24 46-45 109-108 190-195 80-88 138-156 57-69 94-120 37-52 60-89 22-38 32-62 10-24 14-38-21 6-67 29-46 22-124 79-79 57-195 157-116 100-276 261-45 45-82 86-36 38-68 73 43 18 74 50 33 32 52 77z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95 50 3 93 19 7 3 13 5 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46 0 0-1 0-10 9-14 13 2 5 4 10 16 42 19 92 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z"},{type:"path",className:"OfficeIconColors_m27",d:"M1126 1480h354v-354h111v354h355v111h-355v355h-111v-355h-354v-111z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAnomalyExplain_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5\r\n\tL2,9.709V18H11.721z M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"},{type:"path",className:"OfficeIconColors_m22",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5L2,9.709V18H11.721z"},{type:"path",className:"OfficeIconColors_m26",d:"M17.819,12.007c-1.072-0.672-2.566-0.672-3.639,0c-0.948,0.596-1.537,1.519-1.659,2.6\r\n\tc-0.119,1.065,0.246,2.11,1.004,2.866c0.252,0.252,0.68,0.59,1.094,0.916c0.361,0.285,0.732,0.577,1.048,0.858L16,19.544\r\n\tl0.333-0.297c0.315-0.281,0.687-0.573,1.048-0.858c0.414-0.326,0.842-0.664,1.094-0.916c0.758-0.756,1.123-1.801,1.004-2.866\r\n\tC19.356,13.525,18.768,12.603,17.819,12.007z"},{type:"path",className:"OfficeIconColors_m20",d:"M16,13.5c0.828,0,1.5,0.672,1.5,1.5s-0.672,1.5-1.5,1.5c-0.828,0-1.5-0.672-1.5-1.5S15.172,13.5,16,13.5z"},{type:"path",className:"OfficeIconColors_m25",d:"M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"}],viewBox:"0 0 20 20"},{type:"svg",id:"PBINewQuickMeasure_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m 819 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 m -424 410 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 m 1280 -716 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 m 416 921 h -205 v -205 h 205 m 0 -102 h -205 v -205 h 205 m -615 512 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1690 154 v 1740 h -1332 v -614 l 738 -973 h -210 l 114 -153 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1382 461 v 205 h -558 l 155 -205 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 410 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 1024 h -205 v -205 h 205 m 0 512 h -205 v -205 h 205 m -615 205 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 71 1178 l 205 -615 h -193 l 256 -512 h 480 l -307 410 h 205 l -538 717 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m -308 512 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPageVisuals_20",children:[{type:"path",className:"OfficeIconColors_m20",d:"M17.5 7V5.49805H12.5V1.50391H7.5V8.49609H2.5V18.4961H10V8C10 7.44772 10.4477 7 11 7H17.5Z"},{type:"path",className:"OfficeIconColors_m22",d:"M17.998 7V5H12.998V0.996094H7.00195V7.99805H2.00195V19.0039H10V17.998H7.99805V2.00195H12.002V7H12.998V5.99609H17.002V7H17.998ZM2.99805 9.00391H7.00195V17.998H2.99805V9.00391Z"},{type:"path",className:"OfficeIconColors_m25",d:"M18 9H12V19H18V9ZM12 8H18C18.5523 8 19 8.44772 19 9V19C19 19.5523 18.5523 20 18 20H12C11.4477 20 11 19.5523 11 19V9C11 8.44772 11.4477 8 12 8Z"},{type:"path",className:"OfficeIconColors_m20",d:"M18 9H12V19H18V9Z"},{type:"path",className:"OfficeIconColors_m25",d:"M16 18H14V17H16V18Z"}],viewBox:"0 0 20 20"},{type:"svg",id:"addchartplaceholder_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 205 1331 h 205 v 103 h -308 v -308 h 103 m -103 -1024 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 512 -307 h -205 v -103 h 205 m 307 103 h -205 v -103 h 205 m 307 103 h -205 v -103 h 308 v 205 h -103 m 615 410 v 1229 h -1332 v -820 h 410 v -716 h 512 v 307 m -512 512 h -307 v 614 h 307 m 410 -1331 h -308 v 1331 h 308 m 409 -1024 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 512 1434 h -410 v -1332 h 1332 v 205 h -512 v 717 h -410 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 102 1434 v -308 h 103 v 205 h 205 v 103 m -308 -1332 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 307 -307 v -103 h 205 v 103 m 102 0 v -103 h 205 v 103 m 307 0 h -205 v -103 h 308 v 205 h -103 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1075 1894 h -409 v -716 h 409 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1126 1126 v 820 h -512 v -820 m 410 103 h -307 v 614 h 307 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1485 768 h 409 v 1126 h -409 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1946 717 v 1229 h -512 v -1229 m 409 102 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1485 1894 h -410 v -1433 h 410 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 410 v 1536 h -512 v -1536 m 410 102 h -308 v 1331 h 308 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Paste_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1842 q 0 1 1 1 h 613 v 103 h -717 v -1639 h 466 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 h 466 v 410 h -103 v -307 h -204 v 307 h -820 v -307 h -204 m 307 204 h 614 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 m 1331 409 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 h -666 v -1536 h 457 l 8 -41 q 7 -36 26 -66 q 18 -29 45 -51 q 26 -22 60 -34 q 33 -12 70 -12 q 41 0 75 13 q 34 14 60 37 q 25 24 42 55 q 17 32 25 67 l 7 32 h 457 v 359 h -666 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 666 512 h -154 v 1229 h 512 v 153 h -666 v -1536 h 308 m 1024 0 v 359 h -154 v -205 h -154 v -154 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1024 1946 h -717 v -1639 h 359 v 103 h -256 v 1432 q 0 1 1 1 h 613 m 614 -1433 h -256 v -103 h 359 v 410 h -103 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 307 v 410 h -820 v -410 h 159 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 m 56 307 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 v 204 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1178 1997 v -1127 h 819 v 1127 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 819 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CustomFieldGraphicalIndicatorGreenPlus_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"powermap_newtour_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"suggestLightningBolt_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M614 410l308-410h-615l-307 614h205l-205 615h205l614-819h-205z m0 102l-460 614h-12l205-614h-181l204-410h347l-307 410h204z m-409 1434v-615h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638z m1126-1332v1229h410v-1229h-410z"},{type:"path",className:"OfficeIconColors_m20",d:"M205 1331h0v615h0v-615z m1638 615h0v-1434h0v1434z m-512-1434v-410h0v410h0z m-435-307l-77 103h205l-205 273v1262h410v-1638h-333z m-179 512l0 0v102h0v-102z m-154 205l-256 342v579h410v-921h-154z m768-308h410v1229h-410v-1229z"},{type:"path",className:"OfficeIconColors_m22",d:"M205 1331h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638v-615z m1536-717h-410v1229h410v-1229z"},{type:"path",className:"OfficeIconColors_m212",d:"M614 512l-460 614h-12l205-614h-181l204-410h347l-307 410h204z"},{type:"path",className:"OfficeIconColors_m211",d:"M922 0l-308 410h205l-614 819h-205l205-615h-205l307-614h615z m-768 1126l460-614h-204l307-410h-347l-204 410h181l-205 614h12z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"GrowFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 m 1108 157 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1873 512 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ShrinkFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 m -507 1433 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1371 1638 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Bold_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Italic_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Underline_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 234 -614 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 79 v 144 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 l 58 59 q 15 -12 38 -28 q 22 -16 50 -30 q 27 -13 58 -23 q 30 -9 62 -9 q 11 0 21 1 q 9 2 20 4 q 69 18 113 63 q 43 45 67 105 q 24 60 33 128 q 9 69 9 135 q 0 55 -4 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -19 -74 -37 -144 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -29 -9 -52 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -691 689 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 269 921 l 644 -644 l 542 542 l -644 644 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1331 652 q 27 -25 58 -44 q 26 -17 60 -31 q 33 -14 68 -14 q 18 0 33 4 q 55 14 90 50 q 34 37 54 85 q 19 48 26 103 q 7 55 7 107 q 0 44 -3 82 q -3 38 -6 65 q -5 39 -16 78 q -12 39 -26 71 q -16 37 -34 72 q -16 -59 -30 -115 q -12 -48 -23 -100 q -12 -52 -17 -89 q -8 -57 -15 -89 q -8 -32 -14 -49 q -7 -19 -14 -26 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1536 512 q 69 18 112 63 q 43 45 68 105 q 24 60 33 129 q 8 69 8 134 q 0 55 -3 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -20 -75 -38 -145 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -28 -9 -51 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -127 -103 q 23 -10 45 -14 q 21 -3 40 -3 q 7 0 17 0 q 10 1 21 2 q 10 1 20 4 q 9 3 15 7 l 31 25 q 10 8 21 20 q 10 13 21 35 q 11 23 22 59 q 10 37 19 93 q 0 -298 -143 -333 q -10 -2 -16 -2 q -15 0 -31 4 q -16 5 -31 13 q -20 6 -46 19 q -26 14 -55 31 l -71 -57 q 34 -31 73 -56 q 33 -21 75 -39 q 41 -17 86 -17 q 18 0 41 5 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1510 819 l -691 689 l -585 -586 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 223 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FontColorNoPreview_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 2048 h -2048 v -512 h 2048 m -589 -102 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1459 1434 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Centered_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"RightAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LeftAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WrapText_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 m -1241 -697 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 584 429 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"IncreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 m 1024 297 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 m 1341 -1374 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 860 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"DecreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 m 1178 -721 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 m -625 343 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 614 860 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TableBorderColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 80 -85 v -1280 h 1376 l -84 85 h -1207 v 1109 h 412 l -27 86 m 272 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 46 0 87 17 q 41 17 72 46 q 30 30 48 69 q 17 39 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 m 914 -1115 l 195 190 l 46 -44 q 19 -18 30 -43 q 10 -25 10 -52 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 m -709 724 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -485 856 q -13 -60 -57 -103 q -45 -43 -107 -56 l -77 239 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 577 1365 l -27 86 h -470 v -1280 h 1376 l -84 85 h -1207 v 1109 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1863 263 q 26 26 40 59 q 13 33 13 67 q 0 35 -13 67 q -14 32 -40 58 l -759 768 q -6 -19 -12 -41 q -7 -21 -16 -44 q -9 -22 -23 -45 q -14 -22 -36 -43 q -14 -13 -34 -25 q -20 -11 -43 -21 q -23 -10 -47 -19 q -24 -8 -44 -14 l 694 -703 q 26 -34 58 -60 q 27 -23 62 -42 q 35 -19 77 -19 q 29 0 60 12 q 31 13 63 45 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 853 1031 q 10 2 35 13 q 24 11 50 25 q 30 16 64 36 q 45 43 70 89 q 25 47 37 88 l -358 98 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1898 232 q 32 32 49 71 q 17 40 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 l 138 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 44 0 85 15 q 41 15 73 46 m -965 785 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -726 936 l 241 -80 q -13 -60 -57 -103 q -45 -43 -107 -56 m 951 -610 q 19 -19 30 -44 q 10 -24 10 -51 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 l -44 43 l 195 190 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 285 -683 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 l 26 27 q 11 -12 32 -32 q 21 -20 49 -39 q 28 -19 62 -33 q 34 -13 70 -13 q 7 0 14 0 q 6 1 13 2 q 59 10 101 41 q 41 32 68 77 q 27 46 43 101 q 15 56 23 112 q 7 57 9 111 q 2 54 2 97 v 37 q 0 41 -7 88 q -8 48 -19 96 q -11 48 -24 92 q -14 45 -25 79 q -11 34 -19 54 q -8 21 -9 21 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -3 -5 -7 -10 q -4 -5 -8 -9 l -663 657 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 316 853 l 623 -622 l 537 537 l -623 622 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1237 498 q 25 -30 56 -55 q 26 -20 61 -38 q 34 -17 73 -17 q 5 0 11 0 q 5 1 11 2 q 49 8 84 34 q 34 27 57 65 q 23 39 37 85 q 13 47 20 94 q 6 48 8 93 q 2 46 2 82 v 54 q 0 49 -5 92 q -6 44 -13 76 q -8 39 -18 71 q -12 -89 -23 -165 q -5 -32 -11 -65 q -6 -32 -12 -60 q -6 -27 -11 -48 q -6 -21 -12 -30 q -8 -12 -24 -22 q -17 -9 -34 -16 q -20 -8 -42 -14 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1461 363 q 58 10 99 41 q 40 31 67 76 q 27 45 43 99 q 16 55 24 111 q 8 57 10 110 q 2 54 2 97 v 33 q 0 41 -7 89 q -7 48 -18 97 q -11 49 -23 94 q -13 46 -24 81 q -12 35 -20 56 q -8 22 -10 22 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -9 -14 -19 -22 q -11 -8 -21 -12 q -11 -4 -23 -5 l -45 -46 q 30 -16 53 -21 q 23 -5 40 -5 q 14 0 30 8 q 15 8 30 22 q 14 14 26 33 q 11 19 16 40 q -4 -63 -14 -123 q -11 -60 -32 -107 q -21 -46 -54 -75 q -33 -28 -81 -28 q -26 0 -53 14 q -27 14 -50 31 l 3 3 q -25 22 -59 62 l -65 -66 q 31 -36 67 -65 q 31 -24 71 -45 q 40 -20 86 -20 q 13 0 27 3 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1513 768 l -663 657 l -565 -572 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CommonControlChevronDown_12",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"GridCard_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1920 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BorderDrawToolGrid_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1005 1124 q -43 -76 -119 -119 l -71 188 m 1034 -887 l -144 -145 l -760 760 q 92 54 145 144 m 848 -847 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 m -1695 834 h 365 l -40 102 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -717 v 717 h 210 l -102 102 h -108 v 108 l -102 102 v -210 h -717 m 0 -819 v 717 h 717 v -717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 819 1634 q 240 -270 448 -482 q 59 -60 119 -120 q 60 -59 118 -113 q 57 -53 111 -99 q 53 -46 99 -80 q 46 -33 83 -52 q 36 -19 60 -19 q 8 0 12 1 q 41 11 68 28 q 26 17 41 37 q 15 20 21 41 q 6 22 6 42 q 0 17 -3 32 q -3 16 -7 27 q -4 13 -9 25 l -958 950 m -478 -60 h -396 v -1638 h 1638 v 312 q -58 8 -109 33 q -51 25 -93 67 l -921 921 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 922 1024 h -768 v -102 h 768 v -768 h 102 v 768 h 210 l -102 102 h -108 v 108 l -102 102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 530 1843 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -1536 v 1536 h 365 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 836 1609 q 77 27 134 84 q 56 57 83 133 l -362 145 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1065 921 q 92 54 145 144 l 759 -759 l -144 -145 m -890 1032 l 190 -69 q -43 -76 -119 -119 m 1052 -787 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesNone_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesVertical_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 0 v 1920 h -1792 v -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 1792 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 -896 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesHorizontal_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1792 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 1536 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesBoth_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 0 v 1920 h -1920 v -1920 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m -1792 1920 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1856 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 128 v -128 h 1920 v 128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopAndThickBottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m 0 1920 h -1920 v -256 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1792 h -1920 v -1728 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -1792 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 896 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m 0 384 h -128 v -126 h 128 m 0 382 h -128 v -128 h 128 m 512 -256 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1664 v 256 h -1920 v -256 m 1920 -1664 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1856 h -1920 v -1856 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m 1792 256 v 128 h -128 v -128 m 0 256 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m -1792 -1408 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 1024 -1280 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -128 256 h 128 v 126 h -128 m 0 132 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 640 -768 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1792 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BoxBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -1664 v 1664 h 1664 m -768 -768 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m -128 258 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 768 -768 v 128 h -128 v -128 m -256 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 1792 v -1664 h -1664 v 1664 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"NoBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WebGetLink_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"},{type:"path",className:"OfficeIconColors_m233",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CreateCustomAction_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 m -1136 -409 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1620 870 l -990 1024 h -173 l 424 -716 h -488 l 41 -77 h 257 v -410 h 410 v -384 h -240 l 82 -153 h 472 l -363 716 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 0 410 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"List_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 154 h 409 v 409 h -409 m 0 819 h 409 v 410 h -409 m 0 -1024 h 409 v 410 h -409 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ChartStylesGallery_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Gear_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1984 907 v 234 l -298 125 l -11 24 q -20 51 -47 95 q -28 45 -61 87 l -17 21 l 32 321 l -207 111 l -250 -204 l -27 3 q -18 2 -36 3 q -19 1 -38 1 q -24 0 -47 -2 q -24 -1 -47 -5 l -26 -4 l -258 197 l -203 -117 l 41 -321 l -16 -22 q -61 -77 -95 -164 l -11 -24 l -298 -125 v -234 l 298 -125 l 11 -24 q 20 -51 48 -96 q 27 -44 60 -86 l 17 -21 l -32 -321 l 207 -111 l 250 204 l 27 -3 q 18 -2 37 -3 q 18 -1 37 -1 q 24 1 48 2 q 23 1 46 5 l 26 4 l 258 -197 l 203 117 l -41 321 l 16 22 q 61 77 95 164 l 11 24 m -662 562 q 66 0 125 -25 q 58 -25 102 -69 q 43 -43 68 -102 q 25 -58 25 -124 q 0 -66 -25 -125 q -25 -58 -68 -102 q -44 -43 -102 -68 q -59 -25 -125 -25 q -66 0 -124 25 q -59 25 -102 68 q -44 44 -69 102 q -25 59 -25 125 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"}],viewBox:"0,0,2048,2048"},{type:"png",id:"Copilot_80",base64String:"iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABeASURBVHgB7VxdjF3XVV5rn3tnxjOOPaakTdIEXxcaoFXJ5IEf04DHlahUHshEpVJURGwjiiIQSioVib7gMVLVF0qcFlQqHjxWgxrUBk8eKiGB6nFpQgWq6jwUqUCZm5akIW3iGzfxnbn3nL1Zv/ucO048d+yZvHS2fXz+/77zrbW+tfa+Bthtu2237bbdttt2227bbT+ODWEb2+Gn0wJAOkZXnaMLd1JKst1m2pL8tX8AIu30h5DjZH8aPXbDNap+CS8//QJc+sYPYfjyGh2DvLsXEC+0WmH5tacOn4U3qW0LgHP/NJzHIp1BwI5saICUGijothqJvNgAanQ52SMmAlp3lr0BPHf2P9Owtw5IN+QbyJwOCwFlQsSVooATvZXDXdjhdsMA/vyX1x4KAKeb25h5I6wDxQJtbryU2yffgHpefYJttjlPFYH3g7//L2DwdA+BRniFIqQQEoYQaAWTYFjg6kQrvu+Ff9xZEFtwA+0d5147OVyrFkc2vg7bGhhlkHw970+NdajBFg7bNV/5l+eJgQoes04Zx8wTEGW5IDtGmtP+Q/R6Z+jgo7CD7boZeMffXT5OD3nGLxCTX9A9GI4AaFs2mGpS28smWj/QRt8YXx1C77Fv5yOKQsw10bwBJM15u6ALMm+10tHu8i+uwA6162LgLWcudaph9cjG7Q6UsIneMxIqiCOwjbhA+ovJTJF2jH7MJmtpWvu3/+NDkrCNgBIACbyCmFeEhv9jUGXOx9F2QApssAI71K4LwKpM5ypIs+ah0LDQv0lBkUUnGdSxwbbrIp+fInsscZt6uu9FO5dmgwTr3+7JxyA/R6wDNAayyaaihajmKz4wszEFeaxjdLWHYYfalk149q9fPE4vcCYm8UMMAUalD1rQlBcXBiaHVc+lEwRgWZZJgLZgkYGVk/mgii5IGED5ncswfPpFMdlWCxU8ChytQphI/o+ZaYASuEnAk7AsINL1jnYfe88K7EDbMgNTqk6WJSp91M0ZCwGy8xNGJRSdIdQSNpFPihhHozPGRlCROR9bRREofA8GsfzvHzFAYq7q94iBDKT6QDNlOo+OiQVKaE5CQwWSLjQPO2TGWwJw32e+fzLF1GEaQeQPKxFS7dXILGYYfSUHEoKOlqIGjegbdb9ZASp7Y9R1onjkrVdKgB/0GTBiV0ISyuL/sgnzvGVsI1YmApNAS8BzdCbiEdihFrZ0dKyOM7X0JStGhDcSggxPhbzu2wTaWLEh8x9CQ5c13jLCcg6ArfP1+BqCHC0Tl2SKL/YtYDBwxMBCIzAHCjbn0AqJo0iiZZtombhOaEcC26b5zsOrs7ADbWwG3vTpVQIvdnjZImMyL+9sS4GA9KgqAGGWy6wtkh4bJS6r71PXieIYzVeyz5KPAHKX4fNXJDBopKUA4tHVWMgbIoFKoMlyKsxsCzdhdgshrVUVR+Ml2OY2NoAEz8mco1rwyAFAIIyqWKTpTsEFJVaABo8kqx6Xg7kARFPMdhxineMNnhtYlGUWEhTELAMPGazIQaNVqOkyiMFB1DmDGAN7jhab8RJscxsrCs9+ZnWeXvUr6tcZAWWRoYKYk62kbk+iih1Tg+bBRuKEA0qMyxHIABcvyW34vQj9r1ZQkJmy72u3OHjoMvk9FPMU89UpEkOhFQxYFOaB+kRm5aW9U9U7uouHerCNbSwGtsOVY8kiKmi8EJMzk5RjFCTPHpxtYCmrm3rSAoAlbxp7UH0o1h8ATTWuP8dRN4DqPjVhE8sElkXabLrEQjFd1G1qxkRV+5QBD1yO7YfoJqdgG9umDOw88s3Ztal4Se1KQbGga+tRWeVEcsYZGDCyXDNTVbPJFSskqJt0NgP88IlpwH6AVpsm1n1tlCgMFhygXUDFkZfZKEwsZDn7wsJY6ZEZ8JU0ke7uffzWLmxT25yBM1cWJtzygoMYc3BAZxfmioCBaaC5L1RgsAmkJydi0gacZzPrL7QhvRZEMEt9wFI44a+BIldQJqbkphtMyjAjNTrrF+LEOOAs3eX87CcvHe19/EAXtqFtCmAIa/cW7EtStARh1CRHmGY0xI0gB9vvZqumayastZrg1+ND6HaXvztlFRfwHFeRFrPUcoxEWmWcmy9pGzdhkzbGRHmwwIzEgwT96k2femmJUr9TvY/eGJDXNOG5M+dm+zB1SUOlpxmjJmkma6LaQnPeBpBNUkK2RmpsXKfJWAArjpKM+e4Tt1PpaorNt9duFcsUdS8UE6lHZtsjAQglf3qaMwVKmeu2d04Vsx9stY7twzA3EUJHPnVAfyKde+ijW3ZiuLgvQa+GArtVjM/Sp1k5vHjTCmzSrsnAqogLbVhTO0uxAUh+6RHJYdEWG6bsCYY8NTFRIrhcz7WfnpvUMer1Bj9qw/pLkyyUH52ZnljsLt89VuT894+tnkzD9HAclrPM6WS2oMtBJHr24nmCudeSfjl7Ei9GnvznP3mlG6t46v1/eWAJrgfANg7vTfbd5BmEeQqGO3+oHwXrqqj6uzDCQNSgAZnNFpfMt1pVho+5/PwM7158+Su/cuplGK997Y/+4/za2vo82St/agIrSL5TgxegCaquS+4Iyb2HKAIVU1oLSh269JnlB186svA3bzkBWwWwFfrzUIOEnq6OyBKBQgMIFjWgSf2a1bfUNQpgeLX5ZxFuJZ0rL0wtXf7q4VMwLni/941HYn9wRBLEVNDVFKzKQIsyFcZABzRmgP2tLLPF0YKaqIbjj//uC8/c//lbTm+89xv6wHu+8Nl54sT5/K58LYnCVilgxgRlzIhcyRc1fSjmEBUcbJi/lw8J+WC1Q16v1gt46tEjh9a+Pl5fxr/ef75Thsn/EYAYNK75yHJhLKQpCivRj6EIkyp5mgD6eXXZXosXUVJ0C3RqKbG3Z7B+6L7lUSH+hgxstdeOuUXWmQaM+jw0887rIMUEAVBQySbf1IS1ksnpnl6flUbcE5fHBU8eiMproVzjUEu3oTSPQFIEKFQTcNy7RN4ceV0+pJozCtvoeFmXK7kpI7h5JdQCr5pPnO2HcBw2dKC9IYBtXJt3f2rgWBhOkAVwliGuYMyU8z64Kno3ZQ96wPFlLZM9CVto7eFgHoVZ/OEqqh9Svid+kNgs3lA6AoiZ7H+l2krHuU8UD69lkJxHWRbf8OHBTJnOODIWgAvnFjvrsN4ZNU0FK2MKmX3GyhF5oymeOz81Eqs7GKDWX8maGGphgSRTVmDM9q0PnZsbxOpgAV4D0lJ4mWVRod8QCi9UAEsBBjGIn6Qqm4AVmLM5E/cwDK5N6WNo7wDctfEZXp+Bxdp8W0EyEAwozTik0wPk1vwxk4sD1Afkm0d/DNF0GMwFNkWEoKoPGOy6tHjhzAc+14UxG32iIwFLLgBK7Vofs6RYVtRcAv+m5P1oD7FSwKNgw3TnvmR+EwDP9C2v0jtg03IY8kNjAVgUa/e2vICCKjnrl8+Mc1HscgSCmWw2ez5efHNMNcCuwmpA62i8NfMtYLig7Kr8u2hkD9ofU1l44LSRKomplGjPzCu05Mtfn6Ox4OS+UJ/Gi+n+Ph6RxwJwBgdzzOwAdTrbkCweHJogCJuwGYldvqD168iLJetwchbrPcBiIeW3KzBmW73/C51BVc37C1aq2ziX04+FLrOS+jyat4R5SbQfszFqJJaQkmQwg1PFjNiCibmvRr3zGgB+5MvH5wKuH8yByKKmOlQ1W0Rnkn6vYMGgLkXZNmyatvlPO9frEug+BnF18f1fughjtqoazgd5An6FCtTdFOILmZV6TzFZFNMVEwxSCyIGCoyVemUBUf2fshAtJ9J6b7Y0fuDepgDua5WdmCrM2UVD26F/BWaOVli00OE+zGVp/vrSE+fdnNgAFzzgYGY0XoAttBZW94pYppChtlbIC1fCwigyRgMZaz1NdyJoBGbfx9xHYRy/SbQMXtior+tFN4sn+k7w7KYATobBXdIdJoEec4RtgCi4GQisrbOMMXP39drXhca6RWPJ7xV/FNOO8SxsCcByvhJJUoj7EJ+XI69TO3I5BqQLm4AK0rGKJt091Ws6o5BVLeRxJynrDjqyuymAe4H8X0hNQKAGxOYhuSm7T4ORIAMujEGlCvf+WoBWfxjVeGqf2Pv937iwAmO279//2Xky21mV7Ro8NE3UwlslwLFuK5L1H/I90eSKpnoMJ1hsBVWL0EgLXEMkq3OA5ioXNwVwGgedpN8mS4DMHM3mEmSbjPwOkntn81R9mh8lyFOmzEJI9r2NwVLng7gl86VazbGYWCcUaE5ewJOeVImpDE6RBDjJjIKApm8VIPvCbL4c6WqlqrYBWOOoPpCOfGYMANc7YH7LzrfesyTFTYCGL9MDajniTBTD1GMKzMOsEP0ffikzCzOaLcqXOI+h4u8nPk+GEHFQYGiwEPmSrK6ooUNzYgVMQZbAoembgBUBs2LcGG9V0fD7F13YDMCpMNifovq2nFUos7wqlTMKzYUbfi9HVjd1gCxb6kqbeR1jLu+L4w+7ePXDn5irUtWRWwahjgQMNVBjHQRRdxyFteoiICbxeynY9wzZfJkuBTTrTZh9oA124vyle/cXP7C5CU/CwM2t9oEqO1weqbsNyUex1ccq6OI3NEhk/ziSJAHkyhwfceF9R7/VhTFbVbTmQ4zMJVChXEhZgP2ediIUmreScGZ20l7Zl0AzDulckccJqgPFR4t2SI3+RWgkI1ooQnxdiXUVgHtwWPuq/NJ1ghPMBMEGsWmwUCxFPtRRpE7dMOWharVWNH+KYRm20EKr/C3u2OBRIUXUao76vUKUVMiD6zyIaLFAsw9UCWP2E2QshbyVqUZL2pLIhFxUUCzTk2MBOAXDLn2rg5BTOBwtWYGZKmSfCI2UrBF09Mu5GzDhPJrq0cXLABdgzNZ/cLFTlfGo6V8ewcmuUEAM7A9DRFcfXPtLZjRa8q4sB+aHtuqLJHbZdjSZTCaqnTHmnqri9d3M1QwM6xfptM5o9BV2iRQJ7vzrIoPrae27AS88pFqmQO0KUOWNa6zuu977/PjZB8C8Jg1RewcsTTNSCfPIupNG2STDk4KWroRh4gudfV5M9Sdj+dCoF9moO9QqTXr2zscf6I4HIJYrdIkFMHPQvMJ0YdM0PX0DYxV6xLcAgQZs7T9z6qYvK3RcgS00bKV7mXU8iMsuLAO80OeqOXlcR0JhnASRFEzCNEDL6ZsWFKRPBqy0i7Wn9qzqjZ/zKgCLMp5tt8tFepD96qeg+V2wGQhypQJGzNYzlWZAUZ8XkglqC/Bh/GEW5+fmO1UcLBShDdJxjCpB5QWjyybaU7Ffo5KWxH2pTQtIlXYMWwcEm3Clvk+A2+ik6jfmNTrnLIwL4N1Hu73vPPXW0/SdFkMwPzZ6aWVUrNWSs8oZlwsHvr2u7ko1ifcRIx59y+FXuzBmu+W2t51sTdLJMap84SFXksLaqE0veaJVnchsMUaFIkZLZYNkqSkFU1jBhViq7SJlL61dNfDK2x//wxUYF0BuP/3eF089/7WfOERmcAwbyqih89i/uf6zgfhJRhCA9X0psDXAIZu1DNG4ODGxZxHGbE/9wj0nZ2anj3PYFZuS5EFCpVaW+XYMVlRbkPDOj8FyLKqpohb9OEtlwePFAzD50ijnZ6qYn8ZrqoQ37BO57Z6Xj1/6+sw36es9TJftuDqpA4MLTAAYLW+h13ZDFvSerouBnyp+OS4CrMNmbXV+frbXr86sDWBh3803iW4xime2Sc4h4EiWgeKooxdTCK4Q1Zn5GCgjsCVnGlBis5xvUsbcX4Br+2mEMdprTxcL7VY4giV1NIc0m02Z/ymnO1Dt6djglnx3qRcwkDJ6l1KgQfsifO+Os/DS/p6U79aoDFXynK+hyyVt6/dbs2uDarY/gCP9PiwQeLM4NQN33vNu6cvQ6gBqjh91XX4mwIUoKTMHCdIaKYIQk3Wgu3AfoWeuOgsV9Jq7BMYgrou3V1f6Bw4sL/ZuCMDNWjr3oTkowkP0NsegpCcZ0p2HhOCQnn7A6zLXbXk9gsz5WFlOabiesE/EXJMppf46IgEI+25/G9z2rp/SZFABZHapnmewom23ESTJljWshiTDsUV1SQ+W2WxOQGU0AuQiHDTV2fK+z//pfdd69xv6rZw3vO+LrOVOpCd++xli1yNS6lXZrzS0LMSzt0bI88nqHzLYMtXCSNmx//b9ar6NPj79LRjqUH1hu3aEoMwBvIImLjmgAVYpQhhSdnYaKBpzA5XvE+OmRY6tjdLfDMgPfuk0seqEAFhFVr4y4B7ywH07cAREz7ERTKvb+FWd2tMTsPet0wKgTC2KqAxmPSWeoKjsGLohL+tx1BGSt6V8fCtfiyYCtfA5HdfSCVolVjDcNM3cVgAFxN/5hyUy47PyMyMBMdkvGZIxBTZMtfRnAgmJMoApzdw8DfzCDpgEBQUTkUuCBBQ4mLSucweVQawUsFZeRgGLJjvWrk/ElvNBP0YrLh1YWtx0VNi2mPBVraTe+5geEBBlwEDSfh8JKIqUmGwONKJnGW+RbsmGGrKt7rvjJgVNfZVHYPFr+hMVz0TUS4iqkREcWnWReqr7w2CBI1lWnixRj2D6XutHoJWys+O86rYzUB7oD5YvwoA6YIb0hCWhVBoLK2eigSqmrb6IwUv1YQJkRSv7Du4VU3OzQ2OfTK3KWENI87Iyh9ftuMrYxcfRl2MWGhv1WpUeZ9uTbBdz7+75q8WVcd51RwCUVsVlYVuZ1OGXBqAzsAZPKcfVFGWh9A7xrr137BX2caml6bfcTGmfvHAK7P8cRPNnLfWJWIOP6Of7toZ/rMGWaXHc19w5ANeqJ0WiOIjqE7kKaiZt+yr+RRipGHr+qtKEgknLQO47OFO/aGgEjZb5t7bMDZAqBwxjKtagUyrZ1oCiYMlxqQYyZabSvtU9n/rkWObLbWd8ILf1qYtQ9F8hpu0nAB24JL7Q19ls6ZmrkkgnAJLQIN/OQPI0/fZJBSOozlM/p4VOT+lQf2sMOixVfaQcn9BGYqDJJLB+YPuJow3rruskYN3/8OmtvOaOMRAXl3swqFZI1qAwkE24BDRTRmdfIvAkESFwSgaPwK0IjD23TsHEbFBGsYmGhrkFM0fzhTnyjvpJaDBSuo+hjrj5/GSSh1lK+1anP/EXp7fynjvHQG4V5ZEV1/AYuKiRWKWN+MRkpssJSUm4lLxOePD8J39uWnyf/ucHIFUYqQFIYS9aloFJB1EYD7m4EhFzpLXoazWsJN3FlsopL7EhnFk3hz+HLbad84HcrgzPCgOHFokZRGGgmC4OyUcOiH3DIW0eEhMpnWM28m879r9zUnRd9mmm/7KjD+IXzQ9qAEhB/F5yNtaRmL6Y+USZ2sbeZkAJ8MyePzu9BFtsOwognl7pEWAXc37M4FmezEANS60j8HzATKyUfXt/ZgpaM8kAS7UcoSk0nL9G4godPA4UyaNtEJnD5zfMvKrNfCQaV70JDPddzzvurAlzK9MyTXMm8JKYLflCAW2o07CsJ2birb8+remVjGmXTiGNwjqIQP9DAf7tv1S3glaeC+kx11EA1GuH1mNPekiGfuUuXvsZc6rL0FwF+yh+7HQXrqPtPIBX4FGS9cf5vwoguYKZcQ3gBmbCvLz/PZM4OVtoWYmfTkrIUctYwSKrdOhWmjUUMjpD/KD9ojQl78tRtHWQXtJefMg/VbHiW8JT7T/+3BJcZ9uWctZmbfDhX50jNM4PyzTLkmXADKzU9wmQ5Pt4DjMF/uwDB2ByNnjnLFgVx6otoGmcBYZc3kouVdDTN7D6IJiM0fJX0sEGNmSGZsXDEw/+7aNwA+1NAZBb//75Tn+9Ok8+rpN9H9cAS8QB+UacKeBOBm//BrdcF5kwa7rKI61Wn7WSo4aZZJSQR1+9gkdh/UWiXLNL559of2RpBW6wvWkAevvf3/y148MBHCMA7yImHgh7C9j/7km4+ZemoTWFr/eEqdGflTeCAZN/NWssTDE0zdN+4yMdSs9GDmgJzrZOPLal0RC7bbfttt2223bbbtttu223bWz/D8F4Mx2kB0G2AAAAAElFTkSuQmCC"}]}},5838:function(dt,We,C){"use strict";C.d(We,{$:function(){return ht},z:function(){return ye()}}),C(90617),C(52601);var b=C(25834),S=C.n(b),H=C(59215),te=C.n(H),xe=C(51269),ae=C.n(xe),Ne=C(53581),_e=C.n(Ne),Je=C(76902),K=C.n(Je),Re=C(9382),Ae=C.n(Re),ue=C(59419),z=C.n(ue),G={};G.styleTagTransform=Ae(),G.setAttributes=_e(),G.insert=ae().bind(null,"head"),G.domAPI=te(),G.insertStyleElement=K(),S()(z(),G),z()&&z().locals&&z();var ge=C(3013),ye=C.n(ge),be="onObjectSprite",ht={name:be,sprite:window[be]}},3013:function(dt){dt.exports={PBIData_20:"PBIData_20",PBIFormat_20:"PBIFormat_20",AudioBookmark_20:"AudioBookmark_20",LaunchSelectionPane_20:"LaunchSelectionPane_20",PBIPerformanceAnalyzer_20:"PBIPerformanceAnalyzer_20",PBISyncSlicer_20:"PBISyncSlicer_20",PBIBuild_20:"PBIBuild_20",PBIAddToChart_20:"PBIAddToChart_20",PBIAnomalyExplain_20:"PBIAnomalyExplain_20",PBINewQuickMeasure_20:"PBINewQuickMeasure_20",PBIPageVisuals_20:"PBIPageVisuals_20",addchartplaceholder_20:"addchartplaceholder_20",Paste_20:"Paste_20",CustomFieldGraphicalIndicatorGreenPlus_20:"CustomFieldGraphicalIndicatorGreenPlus_20",powermap_newtour_20:"powermap_newtour_20",suggestLightningBolt_20:"suggestLightningBolt_20",GrowFont_20:"GrowFont_20",ShrinkFont_20:"ShrinkFont_20",Bold_20:"Bold_20",Italic_20:"Italic_20",Underline_20:"Underline_20",FillColorSplitDropdown_20:"FillColorSplitDropdown_20",FontColorNoPreview_20:"FontColorNoPreview_20",Centered_20:"Centered_20",RightAlign_20:"RightAlign_20",LeftAlign_20:"LeftAlign_20",WrapText_20:"WrapText_20",IncreaseDecimal_20:"IncreaseDecimal_20",DecreaseDecimal_20:"DecreaseDecimal_20",TableBorderColorSplitDropdown_24:"TableBorderColorSplitDropdown_24",FillColorSplitDropdown_24:"FillColorSplitDropdown_24",CommonControlChevronDown_12:"CommonControlChevronDown_12",GridCard_24:"GridCard_24",BorderDrawToolGrid_20:"BorderDrawToolGrid_20",AccessGridlinesNone_16:"AccessGridlinesNone_16",AccessGridlinesVertical_16:"AccessGridlinesVertical_16",AccessGridlinesHorizontal_16:"AccessGridlinesHorizontal_16",AccessGridlinesBoth_16:"AccessGridlinesBoth_16",TopBorder_16:"TopBorder_16",TopAndThickBottomBorder_16:"TopAndThickBottomBorder_16",BottomBorder_16:"BottomBorder_16",BoxBorder_16:"BoxBorder_16",NoBorder_16:"NoBorder_16",WebGetLink_16:"WebGetLink_16",CreateCustomAction_20:"CreateCustomAction_20",List_20:"List_20",ChartStylesGallery_20:"ChartStylesGallery_20",Gear_16:"Gear_16",Copilot_80:"Copilot_80"}},59419:function(dt,We,C){var A=C(51968),b=C(20806)(A);b.push([dt.id,"",""]),dt.exports=b}}]);