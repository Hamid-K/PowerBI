"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["contract-validator"],{73566:function(W,I,d){d.d(I,{E:function(){return N}});var C=d(77476),S=d(9398),R=d(82156),h=d(8483),y=d(50423),N=function(){function g(){}return g.\u0275fac=function(F){return new(F||g)},g.\u0275mod=y.\u0275\u0275defineNgModule({type:g}),g.\u0275inj=y.\u0275\u0275defineInjector({imports:[C.CommonModule,R.N,S.Bz.forChild(h.Vc)]}),g}()},8483:function(W,I,d){d.d(I,{Vc:function(){return y},yO:function(){return R}});var C=d(50423),S=d(76072),R=new C.InjectionToken("JsonSchemaValidationService"),h={loadChildren:function(){return d.e("json-schema-validation-lazy").then(d.bind(d,98909)).then(function(g){return g.JsonSchemaValidationLazyModule})}};S.E.addLazyLoadForLegacyMapping("@powerbi/JsonSchemaValidation/lazy/json-schema-validation-lazy-module#JsonSchemaValidationLazyModule",h.loadChildren);var y=[{path:"dummy-json-schema-validation-lazy",loadChildren:h.loadChildren}]},13627:function(W,I,d){d.r(I),d.d(I,{ReportDefinitionContractValidatorModule:function(){return ce}});var C=d(77476),S=d(73566),R=d(82156),h=d(9215),o=d(38504);function P(e,a,n,r){void 0===r&&(r=50);var t=[];return(null==e||0===e.length||e.length>r)&&t.push({type:o.sw,level:o.qB.Error,code:a??o.GS.GenericHasInvalidName,localizationArgs:n}),t}var E=d(81337);function T(e,a,n){if(null==e)return[];for(var r=[],t=new Set,i=new Set,s=0,u=e;s<u.length;s++){var l=u[s];if(void 0!==l){if(t.has(l)&&!i.has(l)){r.push({type:o.sw,level:o.qB.Error,code:a??o.GS.GenericHasDuplicateNames,localizationArgs:(0,E.__assign)({fieldName:l},n)}),i.add(l);continue}t.add(l)}}return r}var te=d(60661),V=d(50423),ue=d(29866),oe=function(){function e(a){this.visualPluginService=a}return e.prototype.validate=function(a,n,r){void 0===n&&(n=!0);var t=r?.createChildActivity({name:"ReportContractValidationStep"}),i=[];if(i.push.apply(i,function(e,a){return void 0===a&&(a=!0),null==e.activeSectionIndex||e.activeSectionIndex<0||e.activeSectionIndex>=e.sections.length?(a&&(e.activeSectionIndex=0),[{type:o.sw,level:o.qB.Warning,code:o.GS.ReportHasInvalidActiveSectionIndex}]):[]}(a)),i.push.apply(i,function(e){var a=[];return _.isEmpty(e)&&a.push({type:o.sw,level:o.qB.Error,code:o.GS.ReportHasNoPages}),a}(a.sections)),!_.isEmpty(a.filters)){for(var s=0,u=a.filters;s<u.length;s++){var l=u[s];i.push.apply(i,P(l.name,o.GS.ReportHasInvalidFilterName,{fieldName:l.name}))}i.push.apply(i,T(_.map(a.filters,function(p){return p.name}),o.GS.ReportHasDuplicateFilterNames))}i.push.apply(i,T(_.map(a.pods,function(p){return p.name}),o.GS.ReportHasDuplicatePageBindingNames)),i.push.apply(i,T(_.map(a.sections,function(p){return p.name}),o.GS.ReportHasDuplicateSectionNames));for(var c=0,f=a.sections;c<f.length;c++){var v=this.validatePage(f[c],n);null!=v&&i.push.apply(i,v)}if(t?.setProperty("errorCodes",_.map(i,function(p){return p.code})),t?.resolve(),0!==i.length)return i},e.prototype.validatePage=function(a,n){void 0===n&&(n=!0);var r=[];if(r.push.apply(r,P(a.name,o.GS.PageHasInvalidName,{pageName:a.name})),!_.isEmpty(a.filters)){for(var t=0,i=a.filters;t<i.length;t++){var s=i[t];r.push.apply(r,P(s.name,o.GS.PageHasInvalidFilterName,{fieldName:s.name,pageName:a.name}))}r.push.apply(r,T(_.map(a.filters,function(v){return v.name}),o.GS.PageHasDuplicateFilterNames,{pageName:a.name}))}r.push.apply(r,function(e){if(null==e.relationships)return[];for(var a=[],n=new Set,r=new Set,t=0,i=e.visualContainers;t<i.length;t++)r.add(i[t].name);for(var u=0,l=e.relationships;u<l.length;u++){var c=l[u];!n.has(c.source.name)&&!r.has(c.source.name)&&(n.add(c.source.name),a.push({type:o.sw,level:o.qB.Warning,code:o.GS.PageHasInvalidVisualInteractions,localizationArgs:{fieldName:c.source.name,pageName:e.name}})),!n.has(c.target.name)&&!r.has(c.target.name)&&(n.add(c.target.name),a.push({type:o.sw,level:o.qB.Warning,code:o.GS.PageHasInvalidVisualInteractions,localizationArgs:{fieldName:c.target.name,pageName:e.name}}))}return a}(a)),r.push.apply(r,function(e){return 0===e.size.displayOption?[]:null==e.size.height||null==e.size.width?[{type:o.sw,level:o.qB.Error,code:o.GS.PageHasInvalidPageDisplayOption,localizationArgs:{pageName:e.name}}]:[]}(a));var u=function(e){var a=[],n=new Set,r=function t(i){if(!n.has(i.name)&&(n.add(i.name),a.push(i),(0,h.q4)(i)))for(var s=0,u=i.children;s<u.length;s++)t(u[s])};return null!=e.visualContainerGroups?_.forEach(e.visualContainerGroups,function(t){return r(t)}):_.forEach(e.visualContainers,function(t){return r(t)}),a}(a);r.push.apply(r,T(_.map(u,function(v){return v.name}),o.GS.PageHasDuplicateVisualNames,{pageName:a.name}));for(var l=0,c=u;l<c.length;l++){var m=this.validateCanvasItem(c[l],a.name);null!=m&&r.push.apply(r,m)}if(0!==r.length)return r},e.prototype.validateCanvasItem=function(a,n){var r=[];if(r.push.apply(r,P(a.name,o.GS.VisualHasInvalidName,{visualName:a.name,pageName:n})),(0,h.Vz)(a)){if(!_.isEmpty(a.filters)){for(var t=0,i=a.filters;t<i.length;t++){var s=i[t];r.push.apply(r,P(s.name,o.GS.VisualHasInvalidFilterName,{fieldName:s.name,visualName:a.name,pageName:n}))}r.push.apply(r,T(_.map(a.filters,function(u){return u.name}),o.GS.VisualHasDuplicateFilterNames,{pageName:n,visualName:a.name}))}r.push.apply(r,function(e,a){var n=(0,te.oJ)(e);if(_.isEmpty(n))return[];var r=_.map(n,function(t){return t.name});return a.visualName=e.name,T(r,o.GS.VisualHasDuplicateQueryRefs,a)}(a,{pageName:n})),r.push.apply(r,function(e,a,n){var r,t,i,s=[];if(null==(null===(r=a.config.singleVisual.query)||void 0===r?void 0:r.expansionStates))return s;var u=e.capabilities(a.config.singleVisual.visualType);if(null==u)return s;for(var l=0,c=null===(t=a.config.singleVisual.query)||void 0===t?void 0:t.expansionStates;l<c.length;l++)for(var v=function(w){null==(null===(i=u.dataRoles)||void 0===i?void 0:i.find(function(me){return me.name===w}))&&s.push({type:o.sw,level:o.qB.Error,code:o.GS.VisualHasInvalidExpansionStateRole,localizationArgs:(0,E.__assign)({fieldName:w,visualName:a.name},n)})},p=0,D=c[l].roles;p<D.length;p++)v(D[p]);return s}(this.visualPluginService,a,{pageName:n})),r.push.apply(r,function(e,a){var n,r,t=[];if(null==(null===(n=e.config.singleVisual.query)||void 0===n?void 0:n.expansionStates))return t;var i=[];for(var s in e.config.singleVisual.query.projections)i.push.apply(i,null!==(r=e.config.singleVisual.query.projections[s].getQueryRefs())&&void 0!==r?r:[]);for(var u=0,l=e.config.singleVisual.query.expansionStates;u<l.length;u++)for(var f=0,m=l[u].levels;f<m.length;f++){var v=m[f];i.includes(v.queryRefs[0])||t.push({type:o.sw,level:o.qB.Error,code:o.GS.VisualHasInvalidExpansionStateField,localizationArgs:(0,E.__assign)({fieldName:v.queryRefs[0],visualName:e.name},a)})}return t}(a,{pageName:n}))}if(0!==r.length)return r},e.prototype.isContractValidationResult=function(a){return a.type===o.sw},e.\u0275fac=function(n){return new(n||e)(V.\u0275\u0275inject(ue.D))},e.\u0275prov=V.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),le=d(61032),ce=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=V.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=V.\u0275\u0275defineInjector({providers:[R.N.withLazyService(le.ig,oe)],imports:[C.CommonModule,R.N,S.E]}),e}()}}]);