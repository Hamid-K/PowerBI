"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["extension-host-artifact-update"],{73582:function(et,T,a){a.r(T),a.d(T,{ExtensionHostArtifactUpdateModule:function(){return Q}});var P=a(77476),u=a(60756),s=a(85732),x=a(14172),W=a(77526),$=a(6663),k=a(17653),R=a(79078),h=a(73471),V=a(60397),S=a(17899),B=a(82618),H=(0,s.PH)("[Extension Host Artifact Update] Subscribe Artifact Update",(0,s.Ky)()),O=(0,s.PH)("[Extension Host Artifact Update] Unsubscribe Artifact Update",(0,s.Ky)()),G=a(8894),F="extensionHostArtifactUpdate",l=(0,G.H)({selectId:function(d){return d.subscriptionId}}),K={artifactUpdateSubscriptions:l.getInitialState()},N=(0,s.ZF)(F),X=(0,s.P1)(N,function(e){return l.getSelectors().selectAll(e.artifactUpdateSubscriptions)}),p=a(50423),Z=function(){function e(d,n,f){var o=this;this.actions$=d,this.messageBroker=n,this.store=f,this.onSubscribeArtifactUpdateReceived$=(0,S.Av)(this.actions$,this.messageBroker,h.Vm.subscribeArtifactUpdate,function(i){var r=i.iframeId,g=i.workspaceObjectId,j=(0,R.Z)();return o.store.dispatch(H({subscriptionId:j,iframeId:r,workspaceObjectId:g})),h.Vm.subscribeArtifactUpdate.resolve({subscriptionId:j})}),this.onUnsubscribeArtifactUpdateReceived$=(0,u.GW)(function(){return o.actions$.pipe((0,S.pR)(h.Vm.unsubscribeArtifactUpdate),(0,x.U)(function(i){return O({subscriptionId:i.subscriptionId})}))}),this.pushArtifactUpdate$=(0,u.GW)(function(){return o.store.select(B.Fe).pipe((0,W.x)(),(0,$.G)(),(0,u.IC)(function(){return o.store.select(X)}),(0,x.U)(function(i){for(var r=i[0],g=r[0],j=r[1],C=[],z=function(_,tt,b){var I=[],m=g[b],E=j[b];m&&E&&(E.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"add",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),m.forEach(function(t){var c=E.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"remove",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),E.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&t.lastUpdatedDate&&c&&c.objectId&&c.artifactType&&c.lastUpdatedDate&&c.lastUpdatedDate.getTime()!==t.lastUpdatedDate.getTime()&&I.push({changeType:"edit",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})})),I.length>0&&C.push(h.Vm.onArtifactUpdate({subscriptionId:_,changes:I})(tt))},y=0,M=i[1];y<M.length;y++){var A=M[y];z(A.subscriptionId,A.iframeId,A.workspaceObjectId)}return C}),(0,k.b)(function(i){i.forEach(function(r){o.messageBroker.send(r)})}))},{dispatch:!1})}return e.\u0275fac=function(n){return new(n||e)(p.\u0275\u0275inject(u.eX),p.\u0275\u0275inject(V.u),p.\u0275\u0275inject(s.yh))},e.\u0275prov=p.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),D=a(36012);function L(e,d){return(0,s.Lq)(K,(0,D.P)(H,function(n,f){n.artifactUpdateSubscriptions=l.upsertOne({subscriptionId:f.subscriptionId,iframeId:f.iframeId,workspaceObjectId:f.workspaceObjectId},n.artifactUpdateSubscriptions)}),(0,D.P)(O,function(n,f){n.artifactUpdateSubscriptions=l.removeOne(f.subscriptionId,n.artifactUpdateSubscriptions)}))(e,d)}var Q=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=p.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=p.\u0275\u0275defineInjector({imports:[P.CommonModule,s.Aw.forFeature(F,L),u.sQ.forFeature([Z])]}),e}()}}]);