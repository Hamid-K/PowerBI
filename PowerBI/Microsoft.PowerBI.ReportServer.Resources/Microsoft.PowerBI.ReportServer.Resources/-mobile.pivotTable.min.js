"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["pivotTable"],{52073:function(Fe,Me,B){function Q(K,m){var H=m.getHierarchyDepth(),n=m.getChildren(K);if(!_.isEmpty(n))for(var s=0,p=n;s<p.length;s++)H=Math.min(H,m.getLevel(p[s]));return H-m.getLevel(K)}function de(K,m){return m.isLeaf(K)?K:de(_.head(m.getChildren(K)),m)}function se(K,m){return void 0!==m.getLeafIndex(K)?K:se(_.head(m.getChildren(K)),m)}function te(K,m){return m.isLeaf(K)?K:te(_.last(m.getChildren(K)),m)}function Y(K,m){return void 0!==m.getLeafIndex(K)?K:Y(_.last(m.getChildren(K)),m)}function D(K,m){return m.getLeafIndex(de(K,m))}function W(K,m){return m.getLeafIndex(se(K,m))}function X(K,m){return m.getLeafIndex(te(K,m))}function z(K,m){return m.getLeafIndex(Y(K,m))}B.d(Me,{LF:function(){return D},O3:function(){return z},hG:function(){return W},oj:function(){return te},pA:function(){return X},zG:function(){return Q}})},15366:function(Fe,Me,B){B.d(Me,{AV:function(){return b},DJ:function(){return F},DX:function(){return k},EO:function(){return K},FA:function(){return V},MN:function(){return D},Ms:function(){return W},Sv:function(){return p},_E:function(){return n},hw:function(){return z},sB:function(){return O},sW:function(){return s},yl:function(){return H}});var Q=B(81337),de=B(62458),se=B(52073),te=B(7911),Y=B(44404),D=10,W=50,z=20,K=20,H=function(){function R(){}return R.getAncestorsToMeasure=function(u,c){for(var d=[];;){var l=c.getParent(u);if(!l||!c.isLastItem(u,c.getChildren(l)))break;d.push({node:l,size:-1}),u=l}return d},R.getSizeDifference=function(u,c,d,l){for(var h=0,y=0,g=u;y<g.length;y++)h=Math.max(h,this.getItemSizeDifference(g[y],c,d,l));return h},R.getItemSizeDifference=function(u,c,d,l){for(var y=0,g=(0,se.LF)(u.node,d);g<=c;g++)if((y+=l(g))>=u.size)return 0;return u.size-y},R.getPageIndex=function(u,c){return Math.floor(u/c)},R.itemRangeToPageRange=function(u,c,d){var l=this.getPageIndex(u,d),h=this.getPageIndex(c,d);if(l===h)return[{pageIndex:l,startIndex:u%d,endIndex:c%d}];var y=[];y.push({pageIndex:l,startIndex:u%d,endIndex:d-1});for(var g=l+1;g<h;g++)y.push({pageIndex:g,startIndex:0,endIndex:d-1});return y.push({pageIndex:h,startIndex:0,endIndex:c%d}),y},R}(),n=function(){function R(){}return R.linesOverlapVertically=function(u,c,d,l){return!(d>u+c||d+l<u)},R.isRowMeasured=function(u,c){return this.getMeasuredRowCount(c)>u},R.getMeasuredRowCount=function(u){var c=u.getPageRows();return _.isEmpty(c)?0:(c.length-1)*z+_.last(c).getRowHeights().length},R.remeasureRows=function(u,c,d,l,h,y,g){for(var a=0,e=H.itemRangeToPageRange(l,h,z);a<e.length;a++){var t=e[a];g.measurePage(g.getPageRows()[t.pageIndex],u,c,d,l,y,K,t.startIndex,t.endIndex-t.startIndex+1)}},R.getVisibleRowStart=function(u,c,d){var l=d.getRowHeight(u.firstLeafIndex);return{rowIndex:u.firstLeafIndex,visibleHeight:l-c+u.firstLeafTop}},R.getVisibleRange=function(u,c,d,l,h){var y=this.getVisiblePageRange(u,c,d);if(!y)return null;var g=this.getFirstVisibleIndex(y.firstPageRow,y.firstPageIndex,y.firstPageTop,u,c);if(null!=g){var a,P=this.getLastVisibleIndex(y.lastPageRow,y.lastPageIndex,y.lastPageTop,u,c);if(null!=P)return null!=l&&l>=0&&null!=h&&h>=0&&(a=Math.max(P,g.leafIndex+l-1),a=Math.min(a,h)),{firstLeafIndex:g.leafIndex,firstLeafTop:g.top,lastLeafIndex:a??P}}},R.getVisiblePageRange=function(u,c,d){for(var l=0,h=0,y=null,P=0,a=d.getPageRows();P<a.length;P++){var e=a[P],t=e.getHeight();if(this.linesOverlapVertically(l,t,u,c))y?(y.lastPageRow=e,y.lastPageIndex=h,y.lastPageTop=l):y={firstPageRow:e,firstPageIndex:h,firstPageTop:l,lastPageRow:e,lastPageIndex:h,lastPageTop:l};else if(y)break;l+=t,h++}return y},R.getFirstVisibleIndex=function(u,c,d,l,h){for(var y=0,g=d,a=0,e=u.getRowHeights();a<e.length;a++){var t=e[a];if(this.linesOverlapVertically(g,t,l,h))return{leafIndex:c*z+y,top:g};g+=t,y++}},R.getLastVisibleIndex=function(u,c,d,l,h){for(var P,y=0,g=d,a=0,e=u.getRowHeights();a<e.length;a++){var t=e[a];this.linesOverlapVertically(g,t,l,h)&&(P=c*z+y),g+=t,y++}return P},R.getBounds=function(u,c){var d=H.getPageIndex(u,z);if(!(d>=c.getPageRows().length)){for(var l=c.getPageRows()[d],h=c.getPageRowTop(l),y=u%z,g=0;g<y;g++)h+=l.getRowHeights()[g];return{top:h,height:l.getRowHeights()[y]}}},R.getOffset=function(u,c){var d=this.getBounds(u.rowIndex,c);return d?u.alignBottom?u.visibleHeight>=d.height?d.top+d.height:d.top+u.visibleHeight:u.visibleHeight>=d.height?d.top:d.top+d.height-u.visibleHeight:0},R}(),s=function(){function R(){}return R.linesOverlapHorizontally=function(u,c,d,l){return!(d>u+c||d+l<u)},R.isColumnMeasured=function(u,c){return this.getMeasuredColumnCount(c)>u},R.getMeasuredColumnCount=function(u){var c=u.getPageColumns();return _.isEmpty(c)?0:(c.length-1)*D+_.last(c).getColumnWidths().length},R.remeasureColumn=function(u,c,d,l,h,y){var g=y.getPageColumn(u,c,d,l,h);y.measurePage(g,c,d,l,h,W,u%D,1)},R.getVisibleColumnStart=function(u,c,d){var l=d.getColumnWidth(u.firstLeafIndex);return{columnIndex:u.firstLeafIndex,visibleWidth:l-c+u.firstLeafLeft}},R.getVisibleRange=function(u,c,d,l,h){var y=this.getVisiblePageRange(u,c,d);if(!y)return null;var g=this.getFirstVisibleIndex(y.firstPageColumn,y.firstPageIndex,y.firstPageLeft,u,c);if(null!=g){var a,P=this.getLastVisibleIndex(y.lastPageColumn,y.lastPageIndex,y.lastPageLeft,u,c);if(null!=P)return null!=l&&l>=0&&null!=h&&h>=0&&(a=Math.max(P,g.leafIndex+l-1),a=Math.min(a,h)),{firstLeafIndex:g.leafIndex,firstLeafLeft:g.left,lastLeafIndex:a??P}}},R.getVisiblePageRange=function(u,c,d){for(var l=0,h=0,y=null,g=0,P=d.getPageColumns();g<P.length;g++){var a=P[g],e=a.getWidth();if(this.linesOverlapHorizontally(l,e,u,c))y?(y.lastPageColumn=a,y.lastPageIndex=h,y.lastPageLeft=l):y={firstPageColumn:a,firstPageIndex:h,firstPageLeft:l,lastPageColumn:a,lastPageIndex:h,lastPageLeft:l};else if(y)break;l+=e,h++}return y},R.getFirstVisibleIndex=function(u,c,d,l,h){for(var y=0,g=d,a=0,e=u.getColumnWidths();a<e.length;a++){var t=e[a];if(this.linesOverlapHorizontally(g,t,l,h))return{leafIndex:c*D+y,left:g};g+=t,y++}return null},R.getLastVisibleIndex=function(u,c,d,l,h){for(var P,y=0,g=d,a=0,e=u.getColumnWidths();a<e.length;a++){var t=e[a];this.linesOverlapHorizontally(g,t,l,h)&&(P=c*D+y),g+=t,y++}return P},R.getBounds=function(u,c){var d=H.getPageIndex(u,D);if(!(d>=c.getPageColumns().length)){for(var l=c.getPageColumns()[d],h=c.getPageColumnLeft(l),y=u%D,g=l.getColumnWidths(),P=0;P<y;P++)h+=g[P];return{left:h,width:g[y]}}},R.getOffset=function(u,c){var d=this.getBounds(u.columnIndex,c);return d?u.alignRight?u.visibleWidth>=d.width?d.left+d.width:d.left+u.visibleWidth:u.visibleWidth>=d.width?d.left:d.left+d.width-u.visibleWidth:0},R}(),p=function(){function R(u,c){this.pageColumns=[],this.measureElement=u,this.sizeManager=c}return R.prototype.canAddPageColumn=function(u){return this.pageColumns.length<this.getMaxPageColumnCount(u)},R.prototype.getMaxPageColumnCount=function(u){return Math.ceil(u.getHierarchyLeafCount()/D)},R.prototype.getPageColumns=function(){return this.pageColumns},R.prototype.getPageColumnStartIndex=function(u){var c=this.pageColumns.indexOf(u);return-1===c?-1:c*D},R.prototype.getPageColumnLeft=function(u){for(var c=0,d=0,l=this.pageColumns;d<l.length;d++){var h=l[d];if(u===h)break;c+=h.getWidth()}return c},R.prototype.getColumnsWidth=function(){for(var u=0,c=0,d=this.pageColumns;c<d.length;c++)u+=d[c].getWidth();return u},R.prototype.clear=function(){this.pageColumns=[]},R.prototype.measureNextPage=function(u,c,d,l){var h=new te.VG;this.getPageColumns().push(h),this.measurePage(h,u,c,d,l,W)},R.prototype.getWidestCellBindingString=function(u,c,d,l,h,y,g){for(var P={item:null,width:-1},a=0;a<y;a++)this.updateWidestItemFromBodyCell(l.getHierarchyLeafAt(a+g),u,d,l,P);if(c){var e=l.getFloatingHierarchyLeafCount();for(a=0;a<e;a++)this.updateWidestItemFromBodyCell(l.getFloatingHierarchyLeafAt(a),u,d,l,P)}var i,t=d.getApproximateColumnHeaderWidth(u);return t>P.width&&(P.item=u,P.width=t),i=P.item===u?d.getColumnHeaderBinding(P.item,!0):d.getBodyCellBinding(P.item,!0),te.bG.build(i,R.measureRequiredStyle)},R.prototype.measurePage=function(u,c,d,l,h,y,g,P){var a=this.getPageColumnStartIndex(u);void 0===g&&(g=0),void 0===P&&(P=Math.min(l.getHierarchyLeafCount()-a,D)+g);for(var e=Math.min(d.getHierarchyLeafCount()-h,y),t="",i=d.getFloatingHierarchyItems(),o=0;o<P;o++){var f=l.getHierarchyLeafAt(o+g+a);void 0===(u.getColumnWidths()[o+g]=this.sizeManager.getColumnWidth(f))&&(t+=this.getWidestCellBindingString(f,i,c,d,l,e,h))}if(t){this.measureElement.insertAdjacentHTML("beforeend",t);var w=this.measureElement.firstChild;for(o=0;o<P;o++)void 0===u.getColumnWidths()[o+g]&&(u.getColumnWidths()[o+g]=w.offsetWidth+1,w=w.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(u,c,l,a,g,P)}},R.prototype.updateWidestItemFromBodyCell=function(u,c,d,l,h){var y=l.getIntersection(u,c),g=d.getApproximateBodyCellWidth(y);g>h.width&&(h.item=y,h.width=g)},R.prototype.adjustItemsWidth=function(u,c,d,l,h,y){for(var g=0;g<y;g++){var P=d.getHierarchyLeafAt(g+h+l);void 0===this.sizeManager.getColumnWidth(P)&&this.adjustItemWidth(u,g+h,l,c,d,P)}},R.prototype.adjustItemWidth=function(u,c,d,l,h,y){var g=this,P=H.getAncestorsToMeasure(y,h);_.isEmpty(P)||(this.measureAncestors(P,l),u.getColumnWidths()[c]+=H.getSizeDifference(P,c+d,h,function(a){return g.getColumnWidth(a)}))},R.prototype.measureAncestors=function(u,c){for(var d="",l=0,h=u;l<h.length;l++){var g=c.getColumnHeaderBinding(h[l].node,!0);d+=te.bG.build(g,R.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",d);for(var P=this.measureElement.firstChild,a=0,e=u;a<e.length;a++)e[a].size=P.offsetWidth+1,P=P.nextSibling;this.measureElement.innerHTML=""},R.prototype.getColumnWidth=function(u,c,d,l,h){return this.getPageColumn(u,c,d,l,h).getColumnWidths()[u%D]},R.prototype.setColumnWidth=function(u,c){this.getPageColumn(u).getColumnWidths()[u%D]=c},R.prototype.getPageColumn=function(u,c,d,l,h){var y=this.getPageIndex(u);if(c&&y>=this.pageColumns.length)for(var g=y-this.pageColumns.length+1,P=0;P<g;P++)this.measureNextPage(c,d,l,h);return this.pageColumns[y]},R.prototype.getPageIndex=function(u){return H.getPageIndex(u,D)},R.prototype.getLastMeasuredIndex=function(){var u=this.pageColumns.length;if(0===u)return-1;var c=_.last(this.pageColumns);return(u-1)*D+(c.getColumnWidths().length-1)},R.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},R}(),I=function(){function R(u,c,d,l){this.pageRows=[],this.measureElement=u,this.columnWidthMeasureManager=c,this.rowLevelWidthMeasureManager=d,this.sizeManager=l}return R.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},R.prototype.clearFloatingRows=function(){this.floatingPageRow=new te.BJ},R.prototype.ensureLastPageComplete=function(u,c,d,l,h,y){if(0===this.pageRows.length)return-1;var P=this.pageRows.length-1,a=this.pageRows[P],e=a.getRowHeights().length;return e<z&&this.gotMoreRows(a,c)&&(this.measurePage(a,u,c,d,l,h,y,a.getRowHeights().length-1),a.getRowHeights().length>e)?P:-1},R.prototype.measureNextPage=function(u,c,d,l,h){var y=new te.BJ;this.getPageRows().push(y),this.measurePage(y,u,c,d,l,h,K)},R.prototype.measureFloatingRows=function(u,c,d,l,h,y,g){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var P=c.getFloatingHierarchyItems();if(!_.isEmpty(P)){for(var a=Math.min(d.getHierarchyLeafCount()-h,K),e="",t=c.getFloatingHierarchyLeafCount(),i=0;i<t;i++){var o=c.getFloatingHierarchyLeafAt(i);this.floatingPageRow.getRowHeights()[i]=this.sizeManager.getRowHeight(o),void 0===this.floatingPageRow.getRowHeights()[i]&&(e+=this.getHeighestCellBindingString(o,u,c,d,a,h,l,y,g))}if(e){this.measureElement.insertAdjacentHTML("beforeend",e);var f=this.measureElement.firstChild;for(i=0;i<t;i++)void 0===this.floatingPageRow.getRowHeights()[i]&&(this.floatingPageRow.getRowHeights()[i]=f.offsetHeight,f=f.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,u,c,0,0,t)}}}},R.prototype.getPageIndex=function(u){return H.getPageIndex(u,z)},R.prototype.getMeasureRequiredStyle=function(u){return{"box-sizing":"border-box",width:(0,Y.S)(u)}},R.prototype.gotMoreRows=function(u,c){return c.getHierarchyLeafCount()-this.getPageRowStartIndex(u)-u.getRowHeights().length>0},R.prototype.measurePage=function(u,c,d,l,h,y,g,P,a){var e=this.getPageRowStartIndex(u);void 0===P&&(P=0),void 0===a&&(a=Math.min(d.getHierarchyLeafCount()-e,z)-P);for(var t=Math.min(l.getHierarchyLeafCount()-y,g),i="",o=0;o<a;o++){var f=d.getHierarchyLeafAt(o+P+e);void 0===(u.getRowHeights()[o+P]=this.sizeManager.getRowHeight(f))&&(i+=this.getHeighestCellBindingString(f,c,d,l,t,y,h))}if(i){this.measureElement.insertAdjacentHTML("beforeend",i);var w=this.measureElement.firstChild;for(o=0;o<a;o++)void 0===u.getRowHeights()[o+P]&&(u.getRowHeights()[o+P]=w.offsetHeight,w=w.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(u,c,d,e,P,a)}},R.prototype.getHeighestCellBindingString=function(u,c,d,l,h,y,g,P,a){for(var e={item:null,width:-1,height:-1},t=0;t<h;t++){var i=l.getHierarchyLeafAt(t+y),o=d.getIntersection(u,i),f=this.columnWidthMeasureManager.getColumnWidth(t+y,c,d,l,g),M=c.getApproximateBodyCellHeight(o,f);M>e.height&&(e.item=o,e.width=f,e.height=M)}var j,w=this.getItemWidth(u,d),T=c.getApproximateRowHeaderHeight(u,w);return T>e.height&&(e.item=u,e.height=T,e.width=w),j=e.item===u?c.getRowHeaderBinding(e.item,!0):c.getBodyCellBinding(e.item,!0,void 0,void 0,void 0,P,void 0,a),te.bG.build(j,this.getMeasureRequiredStyle(e.width))},R.prototype.getItemWidth=function(u,c){return de.fF.assertFail("abstract method"),0},R.prototype.adjustItemsHeight=function(u,c,d,l,h,y){de.fF.assertFail("abstract method")},R.prototype.getMaxPageRowCount=function(u){return Math.ceil(u.getHierarchyLeafCount()/z)},R.prototype.getPageRows=function(){return this.pageRows},R.prototype.getFloatingPageRow=function(){return this.floatingPageRow},R.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},R.prototype.canAddPageRow=function(u){return this.pageRows.length<this.getMaxPageRowCount(u)},R.prototype.getPageRowStartIndex=function(u){if(u===this.floatingPageRow)return 0;var c=this.pageRows.indexOf(u);return-1===c?-1:c*z},R.prototype.getPageRowTop=function(u){if(u===this.floatingPageRow)return 0;for(var c=0,d=0,l=this.pageRows;d<l.length;d++){var h=l[d];if(u===h)break;c+=h.getHeight()}return c},R.prototype.getRowsHeight=function(){for(var u=0,c=0,d=this.pageRows;c<d.length;c++)u+=d[c].getHeight();return u},R.prototype.getRowHeight=function(u,c,d,l,h,y){return this.getPageRow(u,c,d,l,y).getRowHeights()[u%z]},R.prototype.getFloatingRowHeight=function(u){return this.floatingPageRow.getRowHeights()[u]},R.prototype.getPageRow=function(u,c,d,l,h,y){var g=this.getPageIndex(u);if(c&&g>this.pageRows.length)for(var P=g-this.pageRows.length+1,a=0;a<P;a++)this.measureNextPage(c,d,l,h,y);return this.pageRows[g]},R.prototype.getLastMeasuredIndex=function(){var u=this.pageRows.length;if(0===u)return-1;var c=_.last(this.pageRows);return(u-1)*z+(c.getRowHeights().length-1)},R}(),F=function(R){function u(){return null!==R&&R.apply(this,arguments)||this}return(0,Q.ZT)(u,R),u.prototype.getItemWidth=function(c,d){return this.rowLevelWidthMeasureManager.getWidth(d.getLevel(c),(0,se.zG)(c,d))},u.prototype.adjustItemsHeight=function(c,d,l,h,y,g){for(var P=0;P<g;P++){var a=l.getHierarchyLeafAt(P+y+h);void 0===this.sizeManager.getRowHeight(a)&&this.adjustItemHeight(c,P+y,h,d,l,a)}},u.prototype.adjustItemHeight=function(c,d,l,h,y,g){var P=this,a=H.getAncestorsToMeasure(g,y);_.isEmpty(a)||(this.measureAncestors(a,h,y),c.getRowHeights()[d]+=H.getSizeDifference(a,l+d,y,function(e){return c===P.getFloatingPageRow()?P.getFloatingRowHeight(e):P.getRowHeight(e)}))},u.prototype.measureAncestors=function(c,d,l){for(var h="",y=0,g=c;y<g.length;y++){var a=d.getRowHeaderBinding((P=g[y]).node,!0);h+=te.bG.build(a,this.getMeasureRequiredStyle(this.getItemWidth(P.node,l)))}this.measureElement.insertAdjacentHTML("beforeend",h);for(var e=this.measureElement.firstChild,t=0,i=c;t<i.length;t++){var P;(P=i[t]).size=e.offsetHeight,e=e.nextSibling}this.measureElement.innerHTML=""},u}(I),b=function(R){function u(){return null!==R&&R.apply(this,arguments)||this}return(0,Q.ZT)(u,R),u.prototype.getItemWidth=function(c,d){return this.rowLevelWidthMeasureManager.getLevelWidth(d.getLevel(c))},u.prototype.adjustItemsHeight=function(c,d,l,h,y,g){},u}(I),O=function(){function R(u,c,d,l){this.columnLevelHeights=[],this.measureElement=u,this.columnWidthMeasureManager=c,this.rowLevelWidthMeasureManager=d,this.sizeManager=l}return R.prototype.clear=function(){this.columnLevelHeights=[]},R.prototype.getMeasureRequiredStyle=function(u){return{"box-sizing":"border-box",width:(0,Y.S)(u)}},R.prototype.measure=function(u,c,d,l,h,y,g){if(0===this.columnLevelHeights.length){for(var P={done:!1,levels:[],spanningHeaders:[],leafCount:0},a=d.getHierarchyDepth(),e=c.getHierarchyDepth(),t=0;t<a;t++)(void 0===g||g===t)&&(this.columnLevelHeights[t]=this.sizeManager.getColumnLevelHeight(c.getCorner(e-1,t))),P.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var i=d.getHierarchyItems();i&&this.getHeighestColumnHeaders(i,P,u,c,d,l,h,y);for(var o=0;o<e;o++)for(var f=0;f<a;f++)if(void 0===this.columnLevelHeights[f]){var M=c.getCorner(o,f),w=this.rowLevelWidthMeasureManager.getLevelWidth(o),T=u.getApproximateCornerCellHeight(M,w);T>P.levels[f].largestItemHeight&&(P.levels[f].isHeader=!1,P.levels[f].largestItem=M,P.levels[f].largestItemHeight=T,P.levels[f].largestItemWidth=w)}for(var j="",L=0,re=P.levels;L<re.length;L++)if((A=re[L]).largestItem){var ie=this.getMeasureRequiredStyle(A.largestItemWidth);if(A.isHeader){var ee=u.getColumnHeaderBinding(A.largestItem,!0);j+=te.bG.build(ee,ie)}else ee=u.getCornerCellBinding(A.largestItem,!0),j+=te.bG.build(ee,ie)}if(j){this.measureElement.insertAdjacentHTML("beforeend",j);for(var ne=this.measureElement.firstChild,ae=0,le=0,ue=P.levels;le<ue.length;le++){var A;(A=ue[le]).largestItem&&((void 0===g||g===ae)&&(this.columnLevelHeights[ae]=ne.offsetHeight),ne=ne.nextSibling),ae++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(P,u,c,d,l)}}},R.prototype.adjustLevelHeightsFromSpanningHeaders=function(u,c,d,l,h){for(var y="",g=0,P=u.spanningHeaders;g<P.length;g++)if(u.levels[(a=P[g]).levelToAdjust].largestItem){var e=this.getMeasureRequiredStyle(this.getHeaderWidth(a.item,c,d,l,h)),t=c.getColumnHeaderBinding(a.item,!0);y+=te.bG.build(t,e)}if(y){this.measureElement.insertAdjacentHTML("beforeend",y);for(var i=this.measureElement.firstChild,o=0,f=u.spanningHeaders;o<f.length;o++){var a;u.levels[(a=f[o]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(a.item,a.level,a.levelToAdjust,i.offsetHeight,l),i=i.nextSibling)}this.measureElement.innerHTML=""}},R.prototype.adjustLevelFromSpanningHeader=function(u,c,d,l,h){for(var y=0,g=c;g<=d;g++)y+=this.getLevelHeight(g);l>y&&(this.columnLevelHeights[d]+=l-y)},R.prototype.getHeighestColumnHeaders=function(u,c,d,l,h,y,g,P){for(var a=0,e=u;a<e.length;a++){var t=e[a];if(c.done)return;var i=h.isLeaf(t),o=h.getLevel(t),f=(0,se.zG)(t,h),M=(0,se.pA)(t,h)>=g;if(M)if(1===f){if(void 0===this.columnLevelHeights[o]){var w=this.getHeaderWidth(t,d,l,h,y),T=d.getApproximateColumnHeaderHeight(t,w);T>c.levels[o].largestItemHeight&&(c.levels[o].largestItem=t,c.levels[o].largestItemHeight=T,c.levels[o].largestItemWidth=w)}}else c.spanningHeaders.push({item:t,level:o,levelToAdjust:f+o-1});var j=h.getChildren(t);j&&this.getHeighestColumnHeaders(j,c,d,l,h,y,g,P),i&&M&&c.leafCount++,c.leafCount===P&&(c.done=!0)}},R.prototype.getHeadersHeight=function(){for(var u=0,c=0,d=this.columnLevelHeights;c<d.length;c++)u+=d[c];return u},R.prototype.getLevelTop=function(u){for(var c=0,d=0;d<u;d++)c+=this.columnLevelHeights[d];return c},R.prototype.getLevelHeight=function(u){return this.columnLevelHeights[u]},R.prototype.getHeaderWidth=function(u,c,d,l,h){for(var y=(0,se.LF)(u,l),g=(0,se.pA)(u,l),P=0,a=y;a<=g;a++)P+=this.columnWidthMeasureManager.getColumnWidth(a,c,d,l,h);return P},R}(),k=function(){function R(u,c){this.rowLevelWidths=[],this.measureElement=u,this.sizeManager=c}return R.prototype.clear=function(){this.rowLevelWidths=[]},R.prototype.measure=function(u,c,d,l,h,y){if(0===this.rowLevelWidths.length||void 0!==y){for(var g={done:!1,levels:[],spanningHeaders:[],leafCount:0},P=c.getHierarchyDepth(),a=d.getHierarchyDepth(),e=0;e<P;e++)(void 0===y||y===e)&&(this.rowLevelWidths[e]=this.sizeManager.getRowLevelWidth(c.getCorner(e,a-1))),g.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(c.getHierarchyItems(),g,u,c,l,h);var t=c.getFloatingHierarchyItems();_.isEmpty(t)||(g.done=!1,g.leafCount=0,this.getWidestRowHeaders(t,g,u,c,-1,c.getFloatingHierarchyLeafCount()));for(var i=0;i<a;i++)for(var o=0;o<P;o++)if(void 0===this.rowLevelWidths[o]){var f=c.getCorner(o,i),M=u.getApproximateCornerCellWidth(f);M>g.levels[o].largestItemWidth&&(g.levels[o].isHeader=!1,g.levels[o].largestItem=f,g.levels[o].largestItemWidth=M)}for(var w="",T=0,j=g.levels;T<j.length;T++)if((L=j[T]).largestItem)if(L.isHeader){var re=u.getRowHeaderBinding(L.largestItem,!0);w+=te.bG.build(re,R.measureRequiredStyles)}else re=u.getCornerCellBinding(L.largestItem,!0),w+=te.bG.build(re,R.measureRequiredStyles);if(w){this.measureElement.insertAdjacentHTML("beforeend",w);for(var A=this.measureElement.firstChild,ie=0,ee=0,ne=g.levels;ee<ne.length;ee++){var L;(L=ne[ee]).largestItem&&((void 0===y||y===ie)&&(this.rowLevelWidths[ie]=A.offsetWidth+1),A=A.nextSibling),ie++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(g,u,c)}}},R.prototype.adjustLevelWidthsFromSpanningHeaders=function(u,c,d){for(var l="",h=0,y=u.spanningHeaders;h<y.length;h++)if(u.levels[(g=y[h]).levelToAdjust].largestItem){var P=c.getRowHeaderBinding(g.item,!0);l+=te.bG.build(P,R.measureRequiredStyles)}if(l){this.measureElement.insertAdjacentHTML("beforeend",l);for(var a=this.measureElement.firstChild,e=0,t=u.spanningHeaders;e<t.length;e++){var g;u.levels[(g=t[e]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(g.item,g.level,g.levelToAdjust,a.offsetWidth,d),a=a.nextSibling)}this.measureElement.innerHTML=""}},R.prototype.adjustLevelWidthFromSpanningHeader=function(u,c,d,l,h){for(var y=0,g=c;g<=d;g++)y+=this.getLevelWidth(g);l>y&&(this.rowLevelWidths[d]+=l-y)},R.prototype.getWidestRowHeaders=function(u,c,d,l,h,y){for(var g=0,P=u;g<P.length;g++){var a=P[g];if(c.done)return;var e=l.isLeaf(a),t=l.getLevel(a),i=(0,se.zG)(a,l),o=(0,se.pA)(a,l)>=h;if(o)if(1===i){if(void 0===this.rowLevelWidths[t]){var f=d.getApproximateRowHeaderWidth(a);f>c.levels[t].largestItemWidth&&(c.levels[t].largestItem=a,c.levels[t].largestItemWidth=f)}}else c.spanningHeaders.push({item:a,level:t,levelToAdjust:i+t-1});var M=l.getChildren(a);M&&this.getWidestRowHeaders(M,c,d,l,h,y),e&&o&&c.leafCount++,c.leafCount===y&&(c.done=!0)}},R.prototype.getHeadersWidth=function(){for(var u=0,c=0,d=this.rowLevelWidths;c<d.length;c++)u+=d[c];return u},R.prototype.getLevelLeft=function(u){for(var c=0,d=0;d<u;d++)c+=this.rowLevelWidths[d];return c},R.prototype.getLevelWidth=function(u){return this.rowLevelWidths[u]},R.prototype.setLevelWidth=function(u,c){this.rowLevelWidths[u]=c},R.prototype.getWidth=function(u,c){for(var d=0,l=u;l<u+c;l++)d+=this.getLevelWidth(l);return d},R.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},R}(),V=function(){function R(u,c){this.measureElement=u,this.sizeManager=c}return R.prototype.clear=function(){this.width=void 0},R.prototype.getHeaderBindingString=function(u,c){var d=c.getRowHeaderBinding(u,!0);return te.bG.build(d,k.measureRequiredStyles)},R.prototype.measure=function(u,c,d,l,h,y){if((void 0===this.width||void 0!==y)&&(this.width=this.sizeManager.getRowLevelWidth(c.getCorner(0,d.getHierarchyDepth()-1)),void 0===this.width)){for(var g="",P=Math.min(c.getHierarchyLeafCount()-l,h),a=0;a<P;a++)g+=this.getHeaderBindingString(c.getHierarchyLeafAt(a+l),u);var e=c.getFloatingHierarchyItems();if(!_.isEmpty(e)){var t=c.getFloatingHierarchyLeafCount();for(a=0;a<t;a++)g+=this.getHeaderBindingString(c.getFloatingHierarchyLeafAt(a),u)}if(c.getHierarchyDepth()>0)for(a=0;a<d.getHierarchyDepth();a++){var i=c.getCorner(0,a),o=u.getCornerCellBinding(i,!0);g+=te.bG.build(o,k.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",g);for(var f=this.measureElement.firstChild,M=0;f;)M=Math.max(M,f.offsetWidth+1),f=f.nextSibling;this.measureElement.innerHTML="",this.width=M}},R.prototype.getHeadersWidth=function(){return this.width},R.prototype.getLevelWidth=function(u){return this.width},R.prototype.setLevelWidth=function(u,c){this.width=c},R.prototype.getLevelLeft=function(u){return 0},R}()},79465:function(Fe,Me,B){B.d(Me,{BM:function(){return Q},aP:function(){return Y},p0:function(){return de},xU:function(){return te},y2:function(){return se}});var Q=function(D){return D[D.Incremental=0]="Incremental",D[D.ClearRendering=1]="ClearRendering",D[D.ClearMeasurement=2]="ClearMeasurement",D[D.ClearMeasurementOnly=3]="ClearMeasurementOnly",D[D.ResizeColumn=4]="ResizeColumn",D}({}),de=function(D){return D[D.Header=0]="Header",D[D.Body=1]="Body",D[D.Footer=2]="Footer",D[D.FooterHeader=3]="FooterHeader",D[D.MatrixRowHeader=4]="MatrixRowHeader",D[D.MatrixCorner=5]="MatrixCorner",D}({}),se=function(D){return D[D.Table=0]="Table",D[D.Matrix=1]="Matrix",D}({}),te=function(D){return D[D.Blocked=0]="Blocked",D[D.Stepped=1]="Stepped",D}({}),Y=function(D){return D[D.Prefix=0]="Prefix",D[D.Main=1]="Main",D}({})},44404:function(Fe,Me,B){B.d(Me,{S:function(){return de}});var Q=B(62458);function de(se){return Q.fF.assertValue(null!=se,"value should be defined"),0===se?se.toString():se+"px"}},7911:function(Fe,Me,B){B.d(Me,{BJ:function(){return Y},VG:function(){return te},bG:function(){return D}});var Q=B(55007),de=B(62458),se=B(79602),te=function(){function W(){this.columnWidths=[]}return W.prototype.getColumnWidths=function(){return this.columnWidths},W.prototype.getWidth=function(){return _.sum(this.columnWidths)},W}(),Y=function(){function W(){this.rowHeights=[]}return W.prototype.getRowHeights=function(){return this.rowHeights},W.prototype.getHeight=function(){return _.sum(this.rowHeights)},W.prototype.clear=function(){this.rowHeights=[]},W}(),D=function(){function W(){}return W.build=function(X,z){if(void 0===z&&(z={}),null===X.tagName)return X.content;var K=X.tagName||"div",m="<"+K+" "+this.buildAttributes(X.attributes)+this.buildClassNames(X.classNames)+this.buildStyles(X.styleProperties,z)+">";if(_.isEmpty(X.children))null!=X.content&&(m+=X.content);else for(var H=0,n=X.children;H<n.length;H++)m+=W.build(n[H],null);return m+"</"+K+">"},W.buildMultiple=function(X){return _.map(X,function(z){return W.build(z)}).join("")},W.buildAttributes=function(X){var z="";if(X)for(var K in X)z+=K+"="+Q.u3+X[K]+Q.u3;return z},W.buildClassNames=function(X){if(!X||0===X.length)return"";for(var z='class="',K=0,m=X;K<m.length;K++)z+=m[K]+" ";return z+'"'},W.buildStyles=function(X,z){var K=!_.isEmpty(z),m=!_.isEmpty(X);if(!K&&!m)return"";var H="style="+Q.u3;if(m)for(var n in X)H+=n+":"+X[n]+";";if(K)for(var s in z)H+=s+":"+z[s]+";";return H+Q.u3},W.attachEventHandlers=function(X,z){if(z.clickHandler&&X.addEventListener("click",function(m){return z.clickHandler(m)}),z.contextMenuHandler&&X.addEventListener("contextmenu",function(m){return z.contextMenuHandler(m)}),z.scrollHandler&&se.l.runOutsideAngular(function(){X.addEventListener("scroll",function(m){return z.scrollHandler(m)})}),!_.isEmpty(z.children)){de.fF.assert(function(){return z.children.length===X.childNodes.length},"Element children mismatch");for(var K=0;K<z.children.length;K++)null!==z.children[K].tagName&&W.attachEventHandlers(X.childNodes[K],z.children[K])}},W.attachEventHandlersMultiple=function(X,z){var K=X;z.forEach(function(m){W.attachEventHandlers(K,m),K=K.nextElementSibling})},W}()},24133:function(Fe,Me,B){B.d(Me,{d:function(){return P}});var Q=B(81337),de=B(11034),se=B(62458),te=B(59107),Y=B(98094),D=B(79602),W=B(44102),X=B(93340),z=B(71090),K=B(52073),m=B(15366),H=B(44404),n=B(87914),s=B(79465),p=B(11184),I=function(){function a(e,t,i){this.onFocusChangedHandler=e,this.isA11yTable=t,this.isA11yMatrix=i}return Object.defineProperty(a.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),a.prototype.updateMeasureManagers=function(e,t){this.rowHeightMeasureManager=e,this.columnWidthMeasureManager=t},a.prototype.setAsFocusTableEx=function(e,t,i,o){se.fF.assert(function(){return null!=e||i!==s.p0.Body},"body cells need row index"),i===s.p0.Header?this.currentFocus=o?{columnHeader:o}:{columnHeader:[t]}:i===s.p0.Body?this.currentFocus={bodyCell:{rowIndex:e,columnIndex:t}}:i===s.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:e??0,columnIndex:t}}:i===s.p0.FooterHeader?this.currentFocus={floatingRowHeader:e}:i===s.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:t,columnLevel:e}}:i===s.p0.MatrixRowHeader?this.currentFocus=o?{rowHeader:o}:{rowHeader:[e]}:se.fF.assertNever(i),this.updateFocusedItem()},a.prototype.updateFocusedItem=function(){if(se.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var e=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);se.fF.assertValue(e,"row leaf not found"),se.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(e=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),se.fF.assertValue(e,"row leaf not found"),se.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):se.fF.assertFail("unexpected focus state");se.fF.assertValue(this.currentFocus,"Undefined focused item")}},a.prototype.moveFocus=function(e,t,i,o,f,M){se.fF.assertValue(this.currentFocus,"No initial focus");var w=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(e,t,f,o):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(e,t,f,M):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(e,t,o):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(e,t):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(e,t):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(e,t)),se.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=w},a.prototype.moveBodyCellFocusTableEx=function(e,t,i,o){var f=this.currentFocus.bodyCell.rowIndex,M=this.currentFocus.bodyCell.columnIndex,w=this.rowNavigator.getFloatingHierarchyLeafCount()>0,T=-1===M,j=this.rowHeightMeasureManager.getPageRows().length,L=_.last(this.rowHeightMeasureManager.getPageRows()),re=(j-1)*m.hw+(L.getRowHeights().length-1),A=this.columnWidthMeasureManager.getPageColumns().length,ie=_.last(this.columnWidthMeasureManager.getPageColumns()),ee=(A-1)*m.MN+(ie.getColumnWidths().length-1);if(t){if("home"===e)return o?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return o?this.getBottomRightCell():w?{floatingBodyCell:{rowIndex:0,columnIndex:ee}}:{bodyCell:{rowIndex:re,columnIndex:ee}};if("up"===e)return o?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(M))[0]]}:T?{bodyCell:{rowIndex:0,columnIndex:M}}:{columnHeader:[M]};if("down"===e)return T||!w?{bodyCell:{rowIndex:re,columnIndex:M}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:M}};if("left"===e)return o?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))[0]]}:{bodyCell:{rowIndex:f,columnIndex:0}};if("right"===e)return{bodyCell:{rowIndex:f,columnIndex:ee}}}else{if("home"===e){if(o){var ne=this.rowNavigator.getHierarchyLeafAt(f),ae=this.rowNavigator.getLeafAncestorAtLevel(ne,0);return{rowHeader:this.rowNavigator.getPathIndices(ae)}}return{bodyCell:{rowIndex:f,columnIndex:0}}}if("end"===e)return o?{bodyCell:{rowIndex:f,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:f,columnIndex:ee}};if("pageup"===e&&i)return{bodyCell:{rowIndex:ue=Math.max(this.prevNonblankRowIndex(f-i+1),0),columnIndex:M}};if("pagedown"===e&&i){var ge=this.prevNonblankRowIndex(re+1);return{bodyCell:{rowIndex:ue=Math.min(this.nextNonblankRowIndex(f+i-1),ge),columnIndex:M}}}if("up"===e)return(ue=this.prevNonblankRowIndex(f))<0?T?{bodyCell:{rowIndex:0,columnIndex:M}}:o&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(M))}:{columnHeader:[M]}:{bodyCell:{rowIndex:ue,columnIndex:M}};if("down"===e){var ue;if(!((ue=this.nextNonblankRowIndex(f))>re))return{bodyCell:{rowIndex:ue,columnIndex:M}};if(T||!w&&!o)return{bodyCell:{rowIndex:re,columnIndex:M}};if(!o||w)return{floatingBodyCell:{rowIndex:0,columnIndex:M}}}if("left"===e)return o&&0===M?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))}:{rowHeader:[f]}:{bodyCell:{rowIndex:f,columnIndex:Math.max(M-1,-1)}};if("right"===e)return{bodyCell:{rowIndex:f,columnIndex:Math.min(M+1,ee)}}}return this.currentFocus},a.prototype.moveRowHeaderFocusTableEx=function(e,t,i,o){var f,M=this.columnWidthMeasureManager.getLastMeasuredIndex(),w=this.columnNavigator.getHierarchyDepth(),T=this.currentFocus.rowHeader,j=this.rowNavigator.getNodeFromPath(T),L=this.rowNavigator instanceof p.S?0:this.rowNavigator.getLevel(j),re=this.rowNavigator.getItemsByLevel(L),A=re.indexOf(j),ie=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:L,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(L)}else{if("left"===e&&T.length>1)return{rowHeader:_.dropRight(T,1)};if("right"===e){if(null!==(f=this.previousFocus)&&void 0!==f&&f.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var ee=this.rowNavigator.getLeafIndex(j);if(void 0===ee)return{rowHeader:(0,Q.ev)((0,Q.ev)([],T||[],!0),[0],!1)};if(M>-1)return{bodyCell:{rowIndex:ee,columnIndex:0}}}if("up"===e)return(ne=this.prevNonblankHeaderRowIndex(A,re))>=0?{rowHeader:this.rowNavigator.getPathIndices(re[ne])}:{cornerCell:{rowLevel:L,columnLevel:w-1}};if("down"===e){if((ne=this.nextNonblankHeaderRowIndex(A,re))<=re.length-1)return{rowHeader:this.rowNavigator.getPathIndices(re[ne])};if(ie)return{floatingRowHeader:0}}if("pagedown"===e){var ae=this.rowHeightMeasureManager.getLastMeasuredIndex(),le=(0,K.hG)(this.currentFocus.item,this.rowNavigator),ue=this.nextNonblankRowIndex(le+i-1),ge=this.prevNonblankRowIndex(ae+1),ce=Math.min(ue,ge),Ce=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(ce));if(this.rowNavigator.isLeaf(j)||this.rowNavigator instanceof p.S)return{rowHeader:Ce};var be=_.take(Ce,Math.min(this.currentFocus.rowHeader.length,Ce.length)),ne=this.nextNonblankHeaderRowIndex(A,re);return _.isEqual(be,this.currentFocus.rowHeader)&&ne<=re.length-1?{rowHeader:this.rowNavigator.getPathIndices(re[ne])}:{rowHeader:be}}if("pageup"===e&&(le=(0,K.hG)(this.currentFocus.item,this.rowNavigator),ce=Math.max(this.prevNonblankRowIndex(le-i+1),0),Ce=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(ce)),(be=_.take(Ce,Math.min(this.currentFocus.rowHeader.length,Ce.length)))!==this.currentFocus.rowHeader))return{rowHeader:be}}return T.length>1&&(t&&"left"===e||"home"===e)?{rowHeader:[T[0]]}:t&&"right"===e||"end"===e?{bodyCell:{rowIndex:(0,K.hG)(j,this.rowNavigator),columnIndex:M}}:this.currentFocus},a.prototype.moveColumnHeaderFocusTableEx=function(e,t,i){var o,f=this.currentFocus.columnHeader[0],M=this.rowNavigator.getFloatingHierarchyLeafCount()>0,w=this.rowHeightMeasureManager.getPageRows().length,T=_.last(this.rowHeightMeasureManager.getPageRows()),j=T?(w-1)*m.hw+(T.getRowHeights().length-1):-1,L=this.columnWidthMeasureManager.getPageColumns().length,re=_.last(this.columnWidthMeasureManager.getPageColumns()),A=(L-1)*m.MN+(re.getColumnWidths().length-1),ie=this.currentFocus.columnHeader,ee=this.columnNavigator.getNodeFromPath(ie),ne=this.columnNavigator.getLevel(ee),ae=this.rowNavigator.getHierarchyDepth();if(t){if("home"===e)return i?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e){if(i)return this.getBottomRightCell();if(M)return{floatingBodyCell:{rowIndex:0,columnIndex:A}};if(-1!==j)return{bodyCell:{rowIndex:j,columnIndex:A}}}if("down"===e){var le=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(ee):f;return this.getBottomFooterBodyCell(le,j)}if("up"===e)return{columnHeader:[ie[0]]}}else{if("up"===e&&i&&this.columnNavigator.hasHierarchy()&&ie.length>1)return{columnHeader:_.dropRight(ie,1)};if("down"===e){if(i){if(null!==(o=this.previousFocus)&&void 0!==o&&o.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var ue=this.columnNavigator.getLeafIndex(ee);if(!this.columnNavigator.isLeaf(ee))return{columnHeader:(0,Q.ev)((0,Q.ev)([],this.currentFocus.columnHeader,!0),[0],!1)};if(j>=0)return{bodyCell:{rowIndex:0,columnIndex:ue}};if(M)return{floatingBodyCell:{rowIndex:0,columnIndex:ue}}}if(-1!==j)return{bodyCell:{rowIndex:0,columnIndex:f}}}var ge=this.columnNavigator.getItemsByLevel(ne),ce=ge.indexOf(ee);if("left"===e)return i?ce>0?{columnHeader:this.columnNavigator.getPathIndices(ge[ce-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:ae-1,columnLevel:ne}}:{cornerCell:{rowLevel:0,columnLevel:ne}}:{columnHeader:[Math.max(f-1,0)]};if("right"===e)return i&&-1!==ce?{columnHeader:this.columnNavigator.getPathIndices(ge[Math.min(ce+1,ge.length-1)])}:{columnHeader:[Math.min(f+1,A)]}}return"home"===e||t&&"left"===e?i?{cornerCell:{rowLevel:0,columnLevel:ne}}:{columnHeader:[0]}:"end"===e||t&&"right"===e?i?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[A]}:this.currentFocus},a.prototype.moveCornerCellFocusTableEx=function(e,t){var i=this.currentFocus.cornerCell.rowLevel,o=this.currentFocus.cornerCell.columnLevel,f=this.rowNavigator.getItemsByLevel(i),M=this.columnNavigator.getItemsByLevel(o),w=this.rowNavigator.getHierarchyLeafCount(),T=this.rowNavigator.getHierarchyDepth(),j=this.columnNavigator.getHierarchyDepth(),L=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:i,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(i)}else{if("up"===e&&o>0)return{cornerCell:{rowLevel:i,columnLevel:o-1}};if("down"===e){if(o<j-1)return{cornerCell:{rowLevel:i,columnLevel:o+1}};if(w>0)return{rowHeader:this.rowNavigator.getPathIndices(f[0])};if(L)return{floatingRowHeader:0}}if("right"===e){if(i<T-1)return{cornerCell:{rowLevel:i+1,columnLevel:o}};if(!_.isEmpty(M))return{columnHeader:this.columnNavigator.getPathIndices(M[0])}}if("left"===e&&i>0)return{cornerCell:{rowLevel:i-1,columnLevel:o}}}return i>0&&("home"===e||t&&"left"===e)?{cornerCell:{rowLevel:0,columnLevel:o}}:"end"===e||t&&"right"===e?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},a.prototype.moveFloatingRowHeaderFocusTableEx=function(e,t){var i=this.rowNavigator.getHierarchyLeafCount(),o=this.columnWidthMeasureManager.getLastMeasuredIndex(),f=this.columnNavigator.getHierarchyDepth(),M=this.currentFocus.floatingRowHeader;if(se.fF.assert(function(){return o>-1},"There can not be Floating rows without column headers"),t){if("home"===e||"up"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("down"===e&&M<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===e)return{floatingBodyCell:{rowIndex:M,columnIndex:0}};if("up"===e){if(M>0)return{floatingRowHeader:M-1};if(i>0){var w=this.rowNavigator.getItemsByLevel(0),T=this.prevNonblankHeaderRowIndex(w.length,w);return{rowHeader:this.rowNavigator.getPathIndices(w[T])}}return{cornerCell:{rowLevel:0,columnLevel:f-1}}}if("down"===e&&M<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:M+1}}return t&&"right"===e||"end"===e?{floatingBodyCell:{rowIndex:M,columnIndex:o}}:this.currentFocus},a.prototype.moveFloatingBodyCellFocusTableEx=function(e,t){var i=this.currentFocus.floatingBodyCell.columnIndex,o=this.currentFocus.floatingBodyCell.rowIndex,f=-1===i,M=this.rowHeightMeasureManager.getPageRows().length,w=_.last(this.rowHeightMeasureManager.getPageRows()),T=w?(M-1)*m.hw+(w.getRowHeights().length-1):-1,j=this.columnWidthMeasureManager.getPageColumns().length,L=_.last(this.columnWidthMeasureManager.getPageColumns()),re=(j-1)*m.MN+(L.getColumnWidths().length-1);if(t){if("home"===e)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:re}};if("up"===e){if(this.isA11yMatrix){var A=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(i),0);return{columnHeader:[this.columnNavigator.getIndex(A)]}}return f?{bodyCell:{rowIndex:0,columnIndex:i}}:{columnHeader:[i]}}if("down"===e)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:i}};if("left"===e)return this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===e)return{floatingBodyCell:{rowIndex:o,columnIndex:re}}}else{if("home"===e)return this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===e)return{floatingBodyCell:{rowIndex:0,columnIndex:re}};if("up"===e)return 0===o?T>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(T+1),columnIndex:i}}:(A=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(i),0),{columnHeader:[this.columnNavigator.getIndex(A)]}):{floatingBodyCell:{rowIndex:o-1,columnIndex:i}};if("down"===e&&o<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:o+1,columnIndex:i}};if("left"===e)return 0===i&&this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:o,columnIndex:Math.max(i-1,0)}};if("right"===e)return{floatingBodyCell:{rowIndex:o,columnIndex:Math.min(i+1,re)}}}return this.currentFocus},a.prototype.getBottomRightCell=function(){var e=this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.columnWidthMeasureManager.getLastMeasuredIndex(),i=this.rowNavigator.getHierarchyLeafCount()-1;return e>0?{floatingBodyCell:{rowIndex:e-1,columnIndex:t}}:{bodyCell:{rowIndex:i,columnIndex:t}}},a.prototype.getLastMatrixColumnCell=function(e){var t=this.columnNavigator.getHierarchyLeafCount(),i=this.columnNavigator.getHierarchyLeafAt(t-1),o=this.columnNavigator.getPathIndices(i);return{columnHeader:_.dropRight(o,o.length-(e+1))}},a.prototype.getFirstColumnLeafFromAncestor=function(e){return this.columnNavigator.isLeaf(e)?this.columnNavigator.getLeafIndex(e):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(e)[0])},a.prototype.getBottomFooterBodyCell=function(e,t){var i=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==e&&i?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:e}}:-1===t?this.currentFocus:{bodyCell:{rowIndex:t,columnIndex:e}}},a.prototype.getBottomFooterHeaderCell=function(e){var t=this.rowNavigator.getItemsByLevel(e);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(t[t.length-1])}},a.prototype.prevNonblankRowIndex=function(e){for(var t=e-1;t>=0;t--)if(!this.rowNavigator.isBlankRow(t))return t;return-1},a.prototype.nextNonblankRowIndex=function(e){for(var t=this.rowNavigator.getHierarchyLeafCount(),i=e+1;i<t;i++)if(!this.rowNavigator.isBlankRow(i))return i;return t+1},a.prototype.prevNonblankHeaderRowIndex=function(e,t){for(var i=e-1;i>=0;i--)if(!this.rowNavigator.isBlank(t[i]))return i;return-1},a.prototype.nextNonblankHeaderRowIndex=function(e,t){for(var i=e+1;i<t.length;i++)if(!this.rowNavigator.isBlank(t[i]))return i;return t.length},a}(),F=B(52287),b=function(){function a(e,t,i,o,f,M){var w=this;this.isA11yMatrix=M,this.elementOriginalCursor=t?.style.cursor,this.verticalResizeHandler=i,this.horizontalResizeHandler=o,(i||o)&&(t.addEventListener("mousedown",function(T){return t.closest("[".concat(F.y3,"=true]"))?null:w.onMouseDown(e,t,T)}),t.addEventListener("mousemove",function(T){return t.closest("[".concat(F.y3,"=true]"))?null:w.onMouseMove(t,T)}),t.addEventListener("dblclick",function(T){return t.closest("[".concat(F.y3,"=true]"))?null:w.onDoubleClick(e,t,T)})),f&&t.addEventListener("click",function(T){return w.onClick(e,t,T,f)})}return a.prototype.onMouseDown=function(e,t,i){var o=this.getActiveHandler(t,i);if(o){this.resizing=!0,this.startMousePosition=a.getMouseCoordinates(i);var f=(0,X.df)(t);this.initializeDocumentEvents(t,o,f),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(t,i)),o.onStartResize(e)}else this.resizing=!1},a.prototype.onMouseMove=function(e,t){this.startMousePosition||(e.style.cursor=this.getCursor(e,t))},a.prototype.onDoubleClick=function(e,t,i){var o=this.getActiveHandler(t,i);o&&o.onReset(e)},a.prototype.onClick=function(e,t,i,o){this.isA11yMatrix&&!t.closest("[".concat(F.y3,"=true]"))&&i.stopPropagation(),!this.resizing&&o&&o(e,i)},a.prototype.getActiveHandler=function(e,t){return this.isMouseOnVerticalHandle(e,a.getMouseCoordinates(t))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(e,a.getMouseCoordinates(t))?this.horizontalResizeHandler:null},a.prototype.getCursor=function(e,t){return this.isMouseOnVerticalHandle(e,a.getMouseCoordinates(t))?"col-resize":this.isMouseOnHorizontalHandle(e,a.getMouseCoordinates(t))?"row-resize":this.elementOriginalCursor},a.prototype.initializeDocumentEvents=function(e,t,i){var o=this;this.documentMouseMoveListener=function(f){f.preventDefault(),t.onResize(a.getMouseCoordinatesDelta(o.startMousePosition,a.getMouseCoordinates(f),i))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(f){f.preventDefault(),document.removeEventListener("mousemove",o.documentMouseMoveListener),o.documentMouseMoveListener=null,document.removeEventListener("mouseup",o.documentMouseUpListener),o.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=o.documentOriginalCursor,o.documentOriginalCursor=void 0),o.startMousePosition=null,t.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},a.prototype.isMouseOnVerticalHandle=function(e,t){return!!this.verticalResizeHandler&&t.x>=e.getBoundingClientRect().right-a.HandleSize},a.prototype.isMouseOnHorizontalHandle=function(e,t){return!!this.horizontalResizeHandler&&t.y>=e.getBoundingClientRect().bottom-a.HandleSize},a.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},a.getMouseCoordinatesDelta=function(e,t,i){return t&&e?{x:(t.x-e.x)/i,y:(t.y-e.y)/i}:{x:0,y:0}},a.HandleSize=4,a}(),O=function(){function a(e,t,i){this.a11yTableFS=t,this.a11yMatrixFS=i,this.control=e}return a.prototype.onStartResize=function(e){var t=(0,K.oj)(e,this.control.getColumnNavigator()),i=this.control.getColumnNavigator().getLeafIndex(t);this.resizeState={leafToResize:t,leafToResizeIndex:i,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(i)}},a.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),i=m._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),o=m.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(i&&o){var f=Math.max(this.resizeState.originalWidth+e.x,b.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,f),m._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,i.lastLeafIndex,o.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ResizeColumn)}}},a.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.leafToResize,t=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),i=this.resizeState.originalWidth;this.resizeState=void 0;var o=this.control.getViewport(),f=m._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(f&&t!==i){this.control.getSizeManager().setColumnWidth(e,t);var M=m._E.getVisibleRowStart(f,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,M)}}},a.prototype.onReset=function(e){var t=this.control.getViewport(),i=m._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(i){var o=(0,K.oj)(e,this.control.getColumnNavigator()),f=this.control.getColumnNavigator().getLeafIndex(o);this.control.getSizeManager().setColumnWidth(o,void 0),m.sW.remeasureColumn(f,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,this.control.getColumnWidthMeasureManager());var M=m._E.getVisibleRowStart(i,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,M)}},a}(),R=function(){function a(e,t){this.a11yMatrixFS=t,this.control=e}return a.prototype.onStartResize=function(e){var t=this.getLevelToResize(e);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(t,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:t,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(t)}},a.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),i=m._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),o=m.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(i){var f=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+e.x,b.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,f),m._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,i.lastLeafIndex,o?o.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ResizeColumn)}}},a.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.cornerCellToResize,t=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),i=this.resizeState.originalWidth;this.resizeState=void 0;var o=this.control.getViewport(),f=m._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(f&&t!==i){this.control.getSizeManager().setRowLevelWidth(e,t);var M=m._E.getVisibleRowStart(f,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,M)}}},a.prototype.onReset=function(e){var t=this.control.getViewport(),i=m._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(i){var o=this.getLevelToResize(e),f=this.control.getRowNavigator().getCorner(o,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(f,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,m.Ms,o);var M=m._E.getVisibleRowStart(i,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.Incremental,M)}},a.prototype.getLevelToResize=function(e){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(e)},a.prototype.getMaxWidth=function(e){for(var t=this.control.getClientWidth(),i=0;i<e;i++)t-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(i);return t},a}(),u=B(57470),c=B(7911),d=function(){function a(e,t,i,o,f,M,w,T,j,L,re,A,ie){var ne,ee=this;this.element=e,this.prefixCellClickHandler=t,this.prefixCellContextMenuHandler=i,this.mainCellClickHandler=o,this.mainCellContextMenuHandler=f,this.interactionHandler=M,this.section=w,this.renderType=T,this.onObject=j,this.enableCalculationHighlight=L,this.isRenderStable=re,this.showTotalPlaceHolders=A,this.showAsTableNativeMenu=ie,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(ae){var le,ue,ge=ae.target,ce=ee.getItemByElement(ge);ce&&(ee.isPrefixCell(ge)?null===(le=ee.prefixCellClickHandler)||void 0===le||le.call(ee,ce,ae,void 0,ee.section):null===(ue=ee.mainCellClickHandler)||void 0===ue||ue.call(ee,ce,ae,void 0,ee.section))}),this.element.addEventListener("contextmenu",function(ae){var le,ue,ge=ae.target,ce=ee.getItemByElement(ge);!ce||ie||(ee.isPrefixCell(ge)?null===(le=ee.prefixCellContextMenuHandler)||void 0===le||le.call(ee,ce,ae):null===(ue=ee.mainCellContextMenuHandler)||void 0===ue||ue.call(ee,ce,ae))}),this.renderType===s.y2.Table&&this.element.addEventListener("change",function(ae){var le,ue=d3.select(ae.target).attr("checkbox-rowindex");null!=ue&&(null===(le=ee.mainCellClickHandler)||void 0===le||le.call(ee,void 0,void 0,+ue,ee.section))}),null===(ne=this.interactionHandler)||void 0===ne||ne.setTooltipDelegate(function(ae){return ee.getItemByElement(ae.context)},this.element,this.getRegion.bind(this),!ie,function(ae){return ee.shouldHideDefaultTooltip(ae.context)})}return a.prototype.update=function(e,t,i,o){var f=this.rowHeightMeasureManager.getLastMeasuredIndex(),M=this.columnWidthMeasureManager.getLastMeasuredIndex(),w=m._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager,m.hw,f),T=m.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager,m.MN,M);if(this.section!==s.p0.Body||w){var j,L,re;switch(T||(T={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case s.p0.Header:j=[0,o.getHierarchyDepth()-1],L=this.rowHeightMeasureManager.getPageRows(),re=this.columnWidthMeasureManager.getPageColumns();break;case s.p0.Body:j=[w.firstLeafIndex,w.lastLeafIndex],L=this.rowHeightMeasureManager.getPageRows(),re=this.columnWidthMeasureManager.getPageColumns();break;case s.p0.Footer:j=[0,i.getFloatingHierarchyLeafCount()-1],L=[this.rowHeightMeasureManager.getFloatingPageRow()],re=this.columnWidthMeasureManager.getPageColumns();break;default:se.fF.assertNever(this.section)}this.renderMeta={viewport:e,binder:t,rowNavigator:i,columnNavigator:o,visibleRowRange:j,visibleColumnRange:[T.firstLeafIndex,T.lastLeafIndex],pageRows:L,pageColumns:re},this.updateRendering()}},a.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e},a.prototype.setRepeatRowHeaders=function(e){this.repeatRowHeaders=e},a.prototype.setRowWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(t+=e),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",t+"px")},a.prototype.updateBodyLeft=function(){var e=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",e+"px")},a.prototype.shouldHideDefaultTooltip=function(e){var i=u.M.getFirstMatchingAncestor(e,function(w){return w.matches(".prefix-cell")||w.matches(".main-cell")},this.element,!0);if(!i)return!0;var f,o=d3.select(i);return!o.select(".tablixUrlIconGlyph").node()&&(!(f=o.classed("pivotTableCellWrap")||o.classed("pivotTableCellNoWrap")?o.node():o.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||f.scrollHeight===f.clientHeight&&f.scrollWidth===f.clientWidth)},a.prototype.updateMeasureManagers=function(e,t,i,o,f){this.rowHeaderType=e,this.rowHeightMeasureManager=t,this.columnWidthMeasureManager=i,this.rowLevelWidthMeasureManager=o,this.columnLevelHeightMeasureManager=f},a.prototype.scrollToX=function(e){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-e+"px"),this.xPosition=e},a.prototype.onColumnResize=function(){var e=this;d3.select(this.element).selectAll(".row").each(function(){var t=e.getRowIndex(this),i=e.getRowHeight(t),o=e.getRowTop(t);d3.select(this).style("height",i+"px").style("top",o+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),i=e.getColumnIndex(this),o=e.isFillerCell(this),f=o?0:e.getPrefixCellHeight(t,i),M=o?0:e.getPrefixCellWidth(t,i),w=e.getPrefixCellLeft(t,i),T=parseFloat(d3.select(this).style("--padding-left")),j=parseFloat(d3.select(this).style("--padding-right")),L=e.getAdjustedPaddings(M,T,j),re=L[0],A=L[1];d3.select(this).style("height",f+"px").style("width",M+"px").style("left",w+"px").style("padding-left",re+"px").style("padding-right",A+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),i=e.getColumnIndex(this),o=e.getMainCellHeight(t,i),f=e.getMainCellWidth(t,i),M=e.getMainCellLeft(t,i),w=parseFloat(d3.select(this).style("--padding-left")),T=parseFloat(d3.select(this).style("--padding-right")),j=e.getAdjustedPaddings(f,w,T),L=j[0],re=j[1];d3.select(this).style("height",o+"px").style("width",f+"px").style("left",M+"px").style("padding-left",L+"px").style("padding-right",re+"px")}),this.adjustHeaders()},a.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},a.prototype.getElementByIndex=function(e,t,i){var o=i===s.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(e,'"] ').concat(o,'[column-index="').concat(t,'"]')).node()},a.prototype.getItemByElement=function(e){if(this.isRenderStable()){var t=this.getRowIndex(e);if(null!=t){var i=this.getColumnIndex(e);if(null!=i){var o=this.isPrefixCell(e);return this.getCellItem(t,i,o)}}}},a.prototype.updateRendering=function(){var e=this,t=[],i=[];this.clearUnusedElements(),this.setGroupLocations(t,i),t.forEach(function(o){return e.insertRowGroup(o)}),i.forEach(function(o){return e.insertCellGroup(o)}),this.scrollToX(this.xPosition),this.adjustHeaders()},a.prototype.clearUnusedElements=function(){var e=this;for(var t in this.viewSync)if(+t<this.renderMeta.visibleRowRange[0]||+t>this.renderMeta.visibleRowRange[1])delete this.viewSync[t];else for(var i in this.viewSync[t])+i>=0&&(+i<this.renderMeta.visibleColumnRange[0]||+i>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[t][i];d3.select(this.element).selectAll(".row").filter(function(){var o=e.getRowIndex(this);return o<e.renderMeta.visibleRowRange[0]||o>e.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var o=e.getColumnIndex(this);return o<e.renderMeta.visibleColumnRange[0]||o>e.renderMeta.visibleColumnRange[1]}).remove()},a.prototype.setGroupLocations=function(e,t){for(var i,o=this.renderMeta.visibleRowRange[0];o<=this.renderMeta.visibleRowRange[1];o++)if(this.viewSync[o]){i=!1;var M=void 0;this.viewSync[o][-1]||t.push({rowIndex:o,columnStart:-1,columnEnd:-1});for(var f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[o][f]?M=!1:(M?_.last(t).columnEnd++:(t.push({rowIndex:o,columnStart:f,columnEnd:f}),M=!0),this.viewSync[o][f]=!0)}else for(i?_.last(e).rowEnd++:(e.push({rowStart:o,rowEnd:o}),i=!0),this.viewSync[o]={"-1":!0},f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[o][f]=!0},a.prototype.insertRowGroup=function(e){for(var i,t=this,o=d3.select(this.element).selectAll(".row").nodes(),f=o.length-1;f>=0;f--){se.fF.assert(function(){return t.section===s.p0.Body},"header and footer should never insert additional row groups");var M=this.getRowIndex(o[f]);if(e.rowStart>M){i=o[f];break}}var T,w=this.getRowGroupBindings(e.rowStart,e.rowEnd);i?(i.insertAdjacentHTML("afterend",c.bG.buildMultiple(w)),T=i.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",c.bG.buildMultiple(w)),T=_.first(this.element.children)),c.bG.attachEventHandlersMultiple(T,w)},a.prototype.insertCellGroup=function(e){var t;se.fF.assert(function(){return-1!==e.columnStart},"cell group insertion of prefix cells is not supported");for(var o=d3.select(this.element).select('[row-index="'.concat(e.rowIndex,'"]')).select(".scrollable-cells-container"),f=o.node(),M=o.selectAll(".prefix-cell").nodes(),w=o.selectAll(".main-cell").nodes(),T=w.length-1;T>=0;T--){var j=this.getColumnIndex(w[T]);if(e.columnStart>j){t=w[T];break}}!t&&!_.isEmpty(M)&&(t=_.last(M));var re,L=this.getMainBindings(e.rowIndex,e.columnStart,e.columnEnd);t?(t.insertAdjacentHTML("afterend",c.bG.buildMultiple(L)),re=t.nextElementSibling):(f.insertAdjacentHTML("afterbegin",c.bG.buildMultiple(L)),re=_.first(f.children)),c.bG.attachEventHandlersMultiple(re,L)},a.prototype.getRowGroupBindings=function(e,t){for(var i,o=[],f=e;f<=t;f++){var M=this.getRowHeight(f),w=this.getRowTop(f),T=!1,j=0;this.renderMeta.binder.blankRowsEnabled()&&(T=this.renderMeta.rowNavigator.isBlankRow(f),j=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(f));var L={classNames:["row"],attributes:{role:"row","row-index":f.toString()},styleProperties:{position:"absolute",height:M+"px",width:"100%",top:w+"px","pointer-events":"none"},children:[]};T?L.attributes["aria-hidden"]="true":L.attributes["aria-rowindex"]=(this.getAriaRowIndex(f)-j).toString();var re=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),A=this.columnWidthMeasureManager.getColumnsWidth(),ie=this.getPrefixBindings(f),ee=this.getMainBindings(f,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===s.y2.Matrix&&(i=L.children).push.apply(i,ie);var ae={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:re+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:A+"px"},children:this.unfrozenRowHeaders||this.renderType===s.y2.Table?(0,Q.ev)((0,Q.ev)([],ie,!0),ee,!0):ee}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===s.y2.Matrix&&(ae.attributes[F.oy]=(0).toString()),L.children.push(ae),o.push(L)}return o},a.prototype.getPrefixBindings=function(e){for(var t=[],i=this.renderMeta.rowNavigator.getHierarchyDepth(),o=0;o<i;o++){var f=this.getPrefixCellBinding(e,o);t.push(f)}return t},a.prototype.getMainBindings=function(e,t,i){for(var o=[],f=t;f<=i;f++){var M=this.getMainCellBinding(e,f);o.push(M)}return o},a.prototype.adjustCellBindingPadding=function(e,t){var i=parseFloat(e.styleProperties["padding-left"]),o=parseFloat(e.styleProperties["padding-right"]);isNaN(i)&&(i=0),isNaN(o)&&(o=0);var f=this.getAdjustedPaddings(t,i,o),w=f[1];e.styleProperties["padding-left"]=f[0]+"px",e.styleProperties["padding-right"]=w+"px",e.styleProperties["--padding-left"]=i.toString(),e.styleProperties["--padding-right"]=o.toString()},a.prototype.getAdjustedPaddings=function(e,t,i){var o=Math.max(e-t,0),f=Math.min(i,o);return[Math.min(t,e),f]},a.prototype.getRowIndex=function(e){var i=u.M.getFirstMatchingAncestor(e,function(f){return f.matches("[row-index]")},this.element,!0);return i&&+i.getAttribute("row-index")},a.prototype.getColumnIndex=function(e){var i=u.M.getFirstMatchingAncestor(e,function(f){return f.matches("[column-index]")},this.element,!0);return i&&+i.getAttribute("column-index")},a.prototype.isPrefixCell=function(e){return!!u.M.getFirstMatchingAncestor(e,function(f){return f.matches(".prefix-cell")},this.element,!0)},a.prototype.getRegion=function(e){return this.isPrefixCell(e)?s.aP.Prefix:s.aP.Main},a.prototype.isFillerCell=function(e){return!!u.M.getFirstMatchingAncestor(e,function(f){return f.matches(".filler-cell")},this.element,!0)},a.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},a.prototype.getAriaColIndex=function(e,t){return t?e+1:e+1+this.renderMeta.rowNavigator.getHierarchyDepth()},a.prototype.getColumnWidth=function(e,t){return t?this.rowLevelWidthMeasureManager.getLevelWidth(e):this.columnWidthMeasureManager.getPageColumns()[m.yl.getPageIndex(e,m.MN)].getColumnWidths()[e%m.MN]},a.prototype.getColumnLeft=function(e,t){if(t)return this.rowLevelWidthMeasureManager.getLevelLeft(e);var o=this.columnWidthMeasureManager.getPageColumns()[m.yl.getPageIndex(e,m.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(o)+_.sum(o.getColumnWidths().slice(0,e%m.MN))},a}(),l=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,Q.ZT)(e,a),e.prototype.setResizeHandlers=function(t,i){this.columnWidthResizeHandler=t,this.rowLevelWidthResizeHandler=i},e.prototype.adjustHeaders=function(){var t=this;for(var i in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var w=t.getRowIndex(this),T=t.getColumnIndex(this),j=t.getMainCellWidth(w,T),L=T===t.renderMeta.visibleColumnRange[0],re=d3.select(this).classed("secondary-columnheader")&&!L;if(d3.select(this).classed("visually-hidden",re),L&&!d3.select(this).classed("last-secondary-columnheader")){var A=t.getColumnHeaderOffset(T),ie=j-A;d3.select(this).style("transform","translateX(".concat(A,"px)")),d3.select(this).style("width",ie+"px")}else re||(d3.select(this).style("transform",null),d3.select(this).style("width",j+"px"))}),this.viewSync)for(var o in this.viewSync[i])if("resizable"!==this.viewSync[i][o]){if("-1"===o)d3.select(this.element).select('[row-index="'.concat(i,'"]')).selectAll(".prefix-cell").each(function(){if(!t.isFillerCell(this)){var w=t.getItemByElement(this);new b(w,this,t.rowLevelWidthResizeHandler,null,t.prefixCellClickHandler,!0)}});else{var f=this.getElementByIndex(i,o,s.aP.Main);if(!this.isFillerCell(f)){var M=this.getItemByElement(f);new b(M,f,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[i][o]="resizable"}},e.prototype.getPrefixCellBinding=function(t,i){var o=i,f=t,M=this.rowLevelWidthMeasureManager.getLevelLeft(o),w=this.columnLevelHeightMeasureManager.getLevelHeight(f),T=this.rowLevelWidthMeasureManager.getLevelWidth(o),j=this.renderMeta.rowNavigator.getCorner(o,f),L=this.renderMeta.binder.getCornerCellBinding(j,!1,!0,this.onObject,T);return L.classNames||(L.classNames=[]),L.attributes||(L.attributes={}),L.styleProperties||(L.styleProperties={}),L.classNames.push("prefix-cell"),L.attributes.role="columnheader",L.attributes["column-index"]=i.toString(),L.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),null==L.attributes.tabindex&&(L.attributes.tabindex="0"),L.styleProperties.position="absolute",L.styleProperties.left=M+"px",L.styleProperties.height=w+"px",L.styleProperties.width=T+"px",L.styleProperties["box-sizing"]="border-box",L.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(L,T),L},e.prototype.getMainCellBinding=function(t,i){var o=t,M=this.columnWidthMeasureManager.getPageColumns()[m.yl.getPageIndex(i,m.MN)],j=this.columnWidthMeasureManager.getPageColumnLeft(M)+_.sum(M.getColumnWidths().slice(0,i%m.MN));this.unfrozenRowHeaders&&(j+=this.rowLevelWidthMeasureManager.getHeadersWidth());var L=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),re=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(L,o,!0);if(!re)return{attributes:{role:"columnheader","column-index":i.toString(),"aria-colindex":this.getAriaColIndex(i,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:j+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var ee,ie=this.renderMeta.columnNavigator.getHierarchyLeafAt(i+1);ie&&(ee=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(ie,o,!0)),ee===re&&(ee=void 0);var ne=this.getMainCellHeight(t,i),ae=this.getMainCellWidth(t,i),le=this.renderMeta.binder.getColumnHeaderBinding(re,!1,!0,this.onObject,ee,ae),ue=this.renderMeta.columnNavigator.isLeaf(re),ge=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(re),ce=this.renderMeta.columnNavigator.getNodeLeafCount(re)-(i-ge),Ce=!ue&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(re)===i,be=!ue&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(re)!==i,He=be&&1===ce;return le.classNames||(le.classNames=[]),le.attributes||(le.attributes={}),le.styleProperties||(le.styleProperties={}),le.classNames.push("main-cell"),Ce&&le.classNames.push("primary-columnheader"),be&&le.classNames.push("secondary-columnheader"),He&&le.classNames.push("last-secondary-columnheader"),le.attributes.role="columnheader",le.attributes["column-index"]=i.toString(),le.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),le.attributes.tabindex="0",le.styleProperties.position="absolute",le.styleProperties.left=j+"px",le.styleProperties.width=ae+"px",le.styleProperties.height=ne+"px",le.styleProperties["box-sizing"]="border-box",le.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(le,ae),le},e.prototype.getAriaRowIndex=function(t){return t+1},e.prototype.getRowHeight=function(t){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getRowTop=function(t){return this.columnLevelHeightMeasureManager.getLevelTop(t)},e.prototype.getPrefixCellWidth=function(t,i){return this.rowLevelWidthMeasureManager.getLevelWidth(i)},e.prototype.getPrefixCellHeight=function(t,i){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getPrefixCellLeft=function(t,i){return this.rowLevelWidthMeasureManager.getLevelLeft(i)},e.prototype.getMainCellWidth=function(t,i){var o=this,f=t,M=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),w=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(M,f),T=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(w),j=this.renderMeta.columnNavigator.getNodeLeafCount(w)-(i-T),L=this.columnWidthMeasureManager.getLastMeasuredIndex(),re=Math.min(i+j-1,L);return _.sum(_.range(i,re+1).map(function(A){return o.columnWidthMeasureManager.getColumnWidth(A)}))},e.prototype.getMainCellHeight=function(t,i){var o=this,f=t,M=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),w=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(M,f),T=(0,K.zG)(w,this.renderMeta.columnNavigator);return _.sum(_.range(t,f+T-1+1).map(function(L){return o.columnLevelHeightMeasureManager.getLevelHeight(L)}))},e.prototype.getMainCellLeft=function(t,i){var f=this.columnWidthMeasureManager.getPageColumns()[m.yl.getPageIndex(i,m.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(f)+_.sum(f.getColumnWidths().slice(0,i%m.MN))},e.prototype.getCellItem=function(t,i,o){if(o)return this.renderMeta.rowNavigator.getCorner(i,t);var w=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(w,t)},e.prototype.getColumnHeaderOffset=function(t){return this.renderMeta.viewport.left-this.getColumnLeft(t,!1)},e}(d),h=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,Q.ZT)(e,a),e.prototype.scrollToY=function(t){this.element.style.top=-t+"px"},e.prototype.adjustHeaders=function(){if(this.rowHeaderType!==s.xU.Stepped&&!this.repeatRowHeaders){var t=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var i=t.getRowIndex(this),o=t.getColumnIndex(this),f=t.getPrefixCellHeight(i,o),M=i===t.renderMeta.visibleRowRange[0],w=d3.select(this).classed("secondary-rowheader")&&!M;if(d3.select(this).classed("visually-hidden",w),M&&!d3.select(this).classed("last-secondary-rowheader")){var T=t.getRowHeaderOffset(i),j=f-T;d3.select(this).style("transform","translateY(".concat(T,"px)")),d3.select(this).style("height",j+"px")}else w||(d3.select(this).style("transform",null),d3.select(this).style("height",f+"px"))})}},e.prototype.getPrefixCellBinding=function(t,i){var T,o=i,f=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),M=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(f,o,!0),w=this.rowLevelWidthMeasureManager.getLevelLeft(o);if(!M)return{attributes:{role:"rowheader","column-index":i.toString(),"aria-colindex":this.getAriaColIndex(i,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:w+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===s.y2.Table){var j=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),L=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());T=L?this.renderMeta.rowNavigator.getIntersection(j,L):void 0}var A,re=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1);re&&(A=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(re,o,!0)),A===M&&(A=void 0);var ie=this.getPrefixCellWidth(t,i),ee=this.getPrefixCellHeight(t,i),ne=this.renderMeta.rowNavigator.isLeaf(M),ae=this.rowHeaderType===s.xU.Stepped,le=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(M),ue=this.renderMeta.rowNavigator.getNodeLeafCount(M)-(t-le),ge=!ne&&!ae&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(M)===t,ce=!ne&&!ae&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(M)!==t,Ce=ce&&1===ue,be=this.renderType===s.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():ie,He=be+"px",me=this.renderMeta.binder.getRowHeaderBinding(M,!1,this.onObject,!1,T,A,be,this.repeatRowHeaders?f:void 0,ce);if(me.classNames||(me.classNames=[]),me.attributes||(me.attributes={}),me.styleProperties||(me.styleProperties={}),me.classNames.push("prefix-cell"),ge&&me.classNames.push("primary-rowheader"),ce&&me.classNames.push("secondary-rowheader"),Ce&&me.classNames.push("last-secondary-rowheader"),me.attributes["column-index"]=i.toString(),me.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),me.attributes.tabindex="0",me.styleProperties.position="absolute",me.styleProperties.left=w+"px",me.styleProperties.height=ee+"px",me.styleProperties.width=He,me.styleProperties["box-sizing"]="border-box",me.styleProperties["pointer-events"]=this.renderType===s.y2.Table?"none":"auto",this.renderType===s.y2.Table){var Le=M===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),Oe=this.renderMeta.rowNavigator.isLastItem(M,this.renderMeta.rowNavigator.getHierarchyItems()),Ae=this.renderMeta.binder.getBorderInfo(Le,Oe,!0,!0,!0,s.p0.Body);me.styleProperties["--outline-top"]=Ae.weightTop+1+"px",me.styleProperties["--outline-right"]=Ae.weightRight+1+"px",me.styleProperties["--outline-bottom"]=Ae.weightBottom+1+"px",me.styleProperties["--outline-left"]=Ae.weightLeft+1+"px",me.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(me,ie),me},e.prototype.getMainCellBinding=function(t,i){var o=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),M=this.renderMeta.rowNavigator.getIntersection(o,f),w=this.getRowHeight(t),T=this.getColumnWidth(i,!1),j=this.getColumnLeft(i,!1);this.unfrozenRowHeaders&&(j+=this.rowLevelWidthMeasureManager.getHeadersWidth());var L=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1),re=L&&this.renderMeta.rowNavigator.getIntersection(L,f),A=this.renderMeta.binder.getBodyCellBinding(M,!1,w,T,!0,this.onObject,re,this.showTotalPlaceHolders);return A.classNames||(A.classNames=[]),A.attributes||(A.attributes={}),A.styleProperties||(A.styleProperties={}),A.classNames.push("main-cell"),A.attributes.role="gridcell",A.attributes["column-index"]=i.toString(),A.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),A.attributes.tabindex="0",A.styleProperties.position="absolute",A.styleProperties["box-sizing"]="border-box",A.styleProperties.height="100%",A.styleProperties.width=T+"px",A.styleProperties.left=j+"px",A.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(A,T),A},e.prototype.getAriaRowIndex=function(t){return t+1+this.renderMeta.columnNavigator.getHierarchyDepth()},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getPageRows()[m.yl.getPageIndex(t,m.hw)].getRowHeights()[t%m.hw]},e.prototype.getRowTop=function(t){var o=this.rowHeightMeasureManager.getPageRows()[m.yl.getPageIndex(t,m.hw)];return this.rowHeightMeasureManager.getPageRowTop(o)+_.sum(o.getRowHeights().slice(0,t%m.hw))},e.prototype.getPrefixCellWidth=function(t,i){var o=this;if(this.rowHeaderType===s.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var f=i,M=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),w=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(M,f),T=(0,K.zG)(w,this.renderMeta.rowNavigator);return _.sum(_.range(f,f+T-1+1).map(function(L){return o.rowLevelWidthMeasureManager.getLevelWidth(L)}))},e.prototype.getPrefixCellHeight=function(t,i){var o=this;if(this.renderType===s.y2.Table||this.rowHeaderType===s.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(t);var f=i,M=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),w=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(M,f),T=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(w),j=this.renderMeta.rowNavigator.getNodeLeafCount(w)-(t-T),L=this.rowHeightMeasureManager.getLastMeasuredIndex(),re=Math.min(t+j-1,L);return _.sum(_.range(t,re+1).map(function(A){return o.rowHeightMeasureManager.getRowHeight(A)}))},e.prototype.getPrefixCellLeft=function(t,i){return this.getColumnLeft(i,!0)},e.prototype.getMainCellWidth=function(t,i){return this.getColumnWidth(i,!1)},e.prototype.getMainCellHeight=function(t,i){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,i){return this.getColumnLeft(i,!1)},e.prototype.getCellItem=function(t,i,o){if(o){var f=i,M=this.renderMeta.rowNavigator.getHierarchyLeafAt(t);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(M,f)}var w=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),T=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.rowNavigator.getIntersection(w,T)},e.prototype.getRowHeaderOffset=function(t){return this.renderMeta.viewport.top-this.getRowTop(t)},e}(d),y=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,Q.ZT)(e,a),e.prototype.adjustHeaders=function(){for(var o=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),f=0,M=d3.select(this.element).selectAll(".row").nodes().reverse();f<M.length;f++)d3.select(M[f]).attr("aria-rowindex",o--)},e.prototype.getPrefixCellBinding=function(t,i){var o=this.rowHeightMeasureManager.getFloatingRowHeight(t),f=this.rowLevelWidthMeasureManager.getHeadersWidth(),M=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),w=this.renderMeta.binder.getRowHeaderBinding(M,!1,this.onObject,!0,void 0,void 0,f);return w.classNames||(w.classNames=[]),w.attributes||(w.attributes={}),w.styleProperties||(w.styleProperties={}),w.classNames.push("prefix-cell"),w.attributes.role="rowheader",w.attributes["column-index"]=i.toString(),w.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),w.attributes.tabindex="0",w.styleProperties.position="absolute",w.styleProperties.left="0",w.styleProperties.height=o+"px",w.styleProperties.width=f+"px",w.styleProperties["box-sizing"]="border-box",w.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(w,f),w},e.prototype.getMainCellBinding=function(t,i){var o=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),M=this.renderMeta.rowNavigator.getIntersection(o,f),w=this.getRowHeight(t),T=this.getColumnWidth(i,!1),j=this.getColumnLeft(i,!1);this.unfrozenRowHeaders&&(j+=this.rowLevelWidthMeasureManager.getHeadersWidth());var L=this.renderMeta.binder.getBodyCellBinding(M,!1,w,T,!0,this.onObject,void 0,this.showTotalPlaceHolders);return L.classNames||(L.classNames=[]),L.attributes||(L.attributes={}),L.styleProperties||(L.styleProperties={}),L.classNames.push("main-cell"),L.attributes.role="gridcell",L.attributes["column-index"]=i.toString(),L.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),L.attributes.tabindex="0",L.styleProperties.position="absolute",L.styleProperties["box-sizing"]="border-box",L.styleProperties.height="100%",L.styleProperties.width=T+"px",L.styleProperties.left=j+"px",L.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(L,T),L},e.prototype.getAriaRowIndex=function(t){return-1},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[t]},e.prototype.getRowTop=function(t){var i=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(i)+_.sum(i.getRowHeights().slice(0,t))},e.prototype.getPrefixCellWidth=function(t,i){return this.rowLevelWidthMeasureManager.getHeadersWidth()},e.prototype.getPrefixCellHeight=function(t,i){return this.rowHeightMeasureManager.getFloatingRowHeight(t)},e.prototype.getPrefixCellLeft=function(t,i){return 0},e.prototype.getMainCellWidth=function(t,i){return this.getColumnWidth(i,!1)},e.prototype.getMainCellHeight=function(t,i){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,i){return this.getColumnLeft(i,!1)},e.prototype.getCellItem=function(t,i,o){if(o)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t);var f=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),M=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.rowNavigator.getIntersection(f,M)},e}(d),g=function(a){return a[a.Default=0]="Default",a[a.ColumnResizing=1]="ColumnResizing",a[a.RowLevelResizing=2]="RowLevelResizing",a}({}),P=function(){function a(e,t,i,o,f,M,w,T,j,L,re,A,ie,ee,ne){var ae=this;this.hostServices=T,this.visualStyle=j,this.showTotalPlaceHolders=ie,this.subSelectionHelper=ee,this.showAsTableNativeMenu=ne,this.unfrozenRowHeaders=!1,this.isA11yTable=o,this.isA11yMatrix=f,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=M,this.enableCalculationHighlighting=w,this.sizeManager=t,this.scrollingEnabled=i.scrollingEnabled;var le=T.getLocalizedString(z.iC),ue=T.getLocalizedString(z.Hw),ge=T.getLocalizedString(z.dm),ce=T.getLocalizedString(z.Ds),Ce=A?"interactive-grid":"",be="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(le,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(ue,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(ge,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(ce,"</button>\n                    <div role='grid' class='").concat(Ce," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");e.insertAdjacentHTML("beforeend",be),this.element=e.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(F.oy,(0).toString()),this.midViewport.setAttribute(F.oy,(0).toString()),this.botViewport.setAttribute(F.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var He,Se;null===(He=ae.rowScrollbar)||void 0===He||He.scrollPageUp();var me=ae.getViewport(),Le=m._E.getVisibleRange(me.top,me.height,ae.rowHeightMeasureManager,m.hw,null===(Se=ae.rowHeightMeasureManager)||void 0===Se?void 0:Se.getLastMeasuredIndex());L(Le.firstLeafIndex,Le.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var He,Se;null===(He=ae.rowScrollbar)||void 0===He||He.scrollPageDown();var me=ae.getViewport(),Le=m._E.getVisibleRange(me.top,me.height,ae.rowHeightMeasureManager,m.hw,null===(Se=ae.rowHeightMeasureManager)||void 0===Se?void 0:Se.getLastMeasuredIndex());L(Le.firstLeafIndex,Le.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var He,Se;null===(He=ae.columnScrollbar)||void 0===He||He.scrollPageUp();var me=ae.getViewport(),Le=m.sW.getVisibleRange(me.left,me.width,ae.columnWidthMeasureManager,m.MN,null===(Se=ae.rowHeightMeasureManager)||void 0===Se?void 0:Se.getLastMeasuredIndex());re(Le.firstLeafIndex,Le.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var He,Se;null===(He=ae.columnScrollbar)||void 0===He||He.scrollPageDown();var me=ae.getViewport(),Le=m.sW.getVisibleRange(me.left,me.width,ae.columnWidthMeasureManager,m.MN,null===(Se=ae.rowHeightMeasureManager)||void 0===Se?void 0:Se.getLastMeasuredIndex());re(Le.firstLeafIndex,Le.lastLeafIndex)}),this.options=i,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(He){return ae.onClick(He)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new O(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new R(this,!0)),$(this.element).on(de.BZ,function(){return ae.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(He){return ae.onKeyDown(He)}),this.keyUpState=g.Default,this.element.addEventListener("keyup",function(){return ae.onKeyUp()}),this.focusManager=new I(function(){return ae.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),i.scrollingEnabled&&this.attachScrollEventHandlers()}return a.prototype.onShowTotalPlaceHoldersChanged=function(e){e!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=e,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=e),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=e),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=e))},a.prototype.updateOptions=function(e){this.options=e},a.prototype.attachScrollEventHandlers=function(){var e=this;D.l.runOutsideAngular(function(){e.midViewport.style.overflowY="auto",e.midViewport.addEventListener("scroll",function(){return e.scrollTo(null,e.midViewport.scrollTop)}),e.innerContainer.addEventListener("wheel",function(t){var i;performance.now()-e.prevHorizontalWheelTime>100&&(e.propagateWheel=void 0),clearInterval(e.momentumScrollHandle);var o=!t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY);if(!e.propagateWheel&&!o){var f=t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY)?t.deltaY:t.deltaX,M=Math.max(Math.min(f,a.ScrollDeltaMax),-a.ScrollDeltaMax),w=e.scrollBy(M,0);null!==(i=e.propagateWheel)&&void 0!==i||(e.propagateWheel=!w),e.propagateWheel||(t.stopPropagation(),t.preventDefault()),e.prevHorizontalWheelTime=performance.now()}}),e.innerContainer.addEventListener("touchstart",function(t){clearInterval(e.momentumScrollHandle),e.propagateTouch=t.touches.length>1||void 0,e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY}),e.innerContainer.addEventListener("touchmove",function(t){var i,o;if(!e.propagateTouch){var f=e.touchPreviousX-t.touches[0].clientX,M=e.touchPreviousY-t.touches[0].clientY;if(null!==(i=e.propagateTouch)&&void 0!==i||(e.propagateTouch=0===f||Math.abs(f)<=Math.abs(M)||void 0),!e.propagateTouch){e.touchDeltaX=Math.max(Math.min(f,a.ScrollDeltaMax),-a.ScrollDeltaMax),e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY;var w=e.scrollBy(e.touchDeltaX,0);null!==(o=e.propagateTouch)&&void 0!==o||(e.propagateTouch=!w),e.propagateTouch||(t.stopPropagation(),t.preventDefault())}}}),e.innerContainer.addEventListener("touchend",function(){if(!e.propagateTouch){var t=e.renderIteration;e.momentumScrollHandle=setInterval(function(i){i[0]+=1/120;var o=e.touchDeltaX*(1-d3.easeCircleOut(i[0]));t!==e.renderIteration||i[0]>=120||Math.abs(o)<1?clearInterval(e.momentumScrollHandle):e.scrollBy(o,0)},1e3/60,[0])}})})},a.prototype.onFocusManagerEnter=function(){var e;null===(e=this.hostServices.telemetry())||void 0===e||e.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},a.prototype.onKeyUp=function(){switch(this.keyUpState){case g.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=g.Default;break;case g.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=g.Default;break;case g.Default:break;default:se.fF.assertNever(this.keyUpState)}},a.prototype.onKeyDown=function(e){var t=this;if(this.renderLock||this.keyboardLock)return e.stopPropagation(),void e.preventDefault();this.updateFocus();var i=e.code||e.key,o=e.shiftKey,f=te.M.isCtrlOrMeta(e),M=e.altKey,w=this.isA11yTable,T=this.isA11yMatrix;if("Escape"!==i&&"Esc"!==i&&"Tab"!==i){if("ArrowRight"===i||"Right"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=g.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=g.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&1===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!1)}else t.focusManager.moveFocus("right",f,w,T)});if("ArrowLeft"===i||"Left"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=g.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=g.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&0===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!0)}else t.focusManager.moveFocus("left",f,w,T)});if("ArrowUp"===i||"Up"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o&&!f){if(w){var j=t.focusManager.CurrentFocus;t.focusManager.moveFocus("up",f,w,T);var L=t.focusManager.CurrentFocus;t.selectFocus(e,j),t.selectFocus(e,L)}}else t.focusManager.moveFocus("up",f,w,T)});if("ArrowDown"===i||"Down"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o&&!f){if(w){var j=t.focusManager.CurrentFocus;t.focusManager.moveFocus("down",f,w,T);var L=t.focusManager.CurrentFocus;t.selectFocus(e,j),t.selectFocus(e,L)}}else t.focusManager.moveFocus("down",f,w,T)});if("Home"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("home",f,w,T)});if("End"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("end",f,w,T)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pagedown",f,w,T,t.getNumberOfVisibleRows())});if("PageUp"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pageup",f,w,T,t.getNumberOfVisibleRows())})}if("F10"===i&&o)return f?void 0:(e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.showContextMenuForFocus(e)}));if("Enter"===i||"Space"===i||"Spacebar"===i||" "===i)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.selectFocus(e,t.focusManager.CurrentFocus)});if("KeyO"===i&&f&&M)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.activateCellContent()});if(("KeyC"===i||"c"===i)&&f&&o)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.options.whitespaceClickHandler(null,!0)})}},a.prototype.runIfFrameReady=function(e){return(0,Q.mG)(this,void 0,void 0,function(){return(0,Q.Jh)(this,function(t){switch(t.label){case 0:return this.keyboardLock=!0,e(),[4,this.requestAnimationFrameAsync()];case 1:return t.sent(),this.keyboardLock=!1,[2]}})})},a.prototype.notifyVisual=function(e){e.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item,e.bodyCell.rowIndex):e.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(e.item):e.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(e.item):e.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(e.item):e.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item):void 0!==e.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(e.item)},a.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e,this.topRenderer.setUnfrozenRowHeaders(e),this.midRenderer.setUnfrozenRowHeaders(e),this.botRenderer.setUnfrozenRowHeaders(e)},a.prototype.setRepeatRowHeaders=function(e){this.topRenderer.setRepeatRowHeaders(e),this.midRenderer.setRepeatRowHeaders(e),this.botRenderer.setRepeatRowHeaders(e)},a.prototype.onFocusChanged=function(){var e,t=this.focusManager.CurrentFocus;se.fF.assertValue(t,"No current focus"),this.notifyVisual(t);var o,f,M,w,T,j,ue,ge,i=this.getViewport();if(t.bodyCell)t.bodyCell.columnIndex>=0&&(w=t.bodyCell.columnIndex),o=t.bodyCell.rowIndex;else if(t.rowHeader){var L=m._E.getVisibleRange(i.top,i.height,this.rowHeightMeasureManager),re=(0,K.hG)(t.item,this.rowNavigator),A=(0,K.O3)(t.item,this.rowNavigator);re<=L.firstLeafIndex||A-re+1>=L.lastLeafIndex-L.firstLeafIndex+1?(o=re,f=!1):(o=Math.min(A,this.rowHeightMeasureManager.getLastMeasuredIndex()),f=!0)}else if(t.columnHeader){var ne=m.sW.getVisibleRange(i.left,i.width,this.columnWidthMeasureManager);re=(0,K.hG)(t.item,this.columnNavigator),A=(0,K.O3)(t.item,this.columnNavigator),re<=ne.firstLeafIndex||A-re+1>=ne.lastLeafIndex-ne.firstLeafIndex+1?(w=re,j=!1):(w=Math.min(A,this.columnWidthMeasureManager.getLastMeasuredIndex()),j=!0)}else t.floatingBodyCell&&(w=t.floatingBodyCell.columnIndex);if(void 0!==o&&this.rowScrollbar.visible&&(L=m._E.getVisibleRange(i.top,i.height,this.rowHeightMeasureManager))&&(o<=L.firstLeafIndex?M={rowIndex:o,visibleHeight:Number.MAX_VALUE,alignBottom:f??!1}:o>=L.lastLeafIndex&&(M={rowIndex:o,visibleHeight:Number.MAX_VALUE,alignBottom:f??!0})),void 0!==w&&this.columnScrollbar.visible&&(ne=m.sW.getVisibleRange(i.left,i.width,this.columnWidthMeasureManager))&&(w<=ne.firstLeafIndex?T=this.unfrozenRowHeaders&&0===w&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:w,visibleWidth:Number.MAX_VALUE,alignRight:j??!1}:w>=ne.lastLeafIndex&&(T={columnIndex:w,visibleWidth:Number.MAX_VALUE,alignRight:j??!0})),M&&(ue=m._E.getOffset(M,this.rowHeightMeasureManager),M.alignBottom&&(ue-=this.rowScrollbar.viewSize)),T&&(ge=m.sW.getOffset(T,this.columnWidthMeasureManager),T.alignRight&&(ge-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(ge+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(t.cornerCell||t.rowHeader||t.floatingRowHeader)){var ce=this.getFocusedCell(t),Ce=ce.offsetLeft,be=ce.offsetWidth;ge=Ce<this.columnScrollbar.viewMin||be>this.columnScrollbar.viewSize?Ce:Ce+be>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?Ce-this.columnScrollbar.viewSize:null}this.scrollTo(ge,ue),null===(e=this.getFocusedCell(t))||void 0===e||e.focus({preventScroll:!0})},a.prototype.getFocusedCell=function(e){var t,i;if(e.bodyCell)return-1===e.bodyCell.columnIndex?this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,0,s.aP.Prefix):this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,e.bodyCell.columnIndex,s.aP.Main);if(e.columnHeader){var o=e.item,f=this.columnNavigator.getLevel(o),M=void 0;return M=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(o):null!==(t=this.rowNavigator.getLeafIndex(o))&&void 0!==t?t:this.rowNavigator.getIndexOfFirstLeaf(o),this.topRenderer.getElementByIndex(f,M,s.aP.Main)}if(e.rowHeader){var w=e.item;return f=null!==(i=this.columnNavigator.getLeafIndex(w))&&void 0!==i?i:this.columnNavigator.getIndexOfFirstLeaf(w),M=this.steppedLayout?0:this.rowNavigator.getLevel(w),this.midRenderer.getElementByIndex(f,M,s.aP.Prefix)}return e.cornerCell?this.topRenderer.getElementByIndex(e.cornerCell.columnLevel,e.cornerCell.rowLevel,s.aP.Prefix):e.floatingBodyCell?this.botRenderer.getElementByIndex(e.floatingBodyCell.rowIndex,e.floatingBodyCell.columnIndex,s.aP.Main):null!=e.floatingRowHeader?this.botRenderer.getElementByIndex(e.floatingRowHeader,0,s.aP.Prefix):void se.fF.assertFail("Unexpected focused item")},a.prototype.getCurrentFocusBoundingRect=function(){var e=document.activeElement;if(e){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:0,left:0,width:0,height:0}},a.prototype.selectFocus=function(e,t){var i=t.item,o=this.createMouseEvent(e);t.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(i,o,t.bodyCell.rowIndex,s.p0.Body):t.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(i,o,void 0,s.p0.Footer):t.rowHeader||void 0!==t.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(i,o):t.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(i,o):t.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(i,o):se.fF.assertFail("Unexpected focused item")},a.prototype.activateCellContent=function(){var t=document.activeElement;if(t&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var i=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(t,i)}},a.prototype.createSimpleMouseClickEvent=function(){var e=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:e.left,clientY:e.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},a.prototype.createMouseEvent=function(e){var t=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:t.left,clientY:t.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey})},a.prototype.showContextMenuForFocus=function(e){var t,i=this.focusManager.CurrentFocus;if(-1!==(null===(t=i.bodyCell)||void 0===t?void 0:t.columnIndex)){se.fF.assertValue(i&&i.item,"Keyboard Selection triggered with no focused cell");var o=i.item,f=this.getCurrentFocusBoundingRect(),M=new MouseEvent("contextmenu",{clientX:f.left,clientY:f.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey});i.bodyCell||i.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(o,M):i.rowHeader||void 0!==i.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(o,M):i.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(o,M):i.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(o,M):se.fF.assertFail("Unexpected focused item")}},a.prototype.onClick=function(e){var t=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),i=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(t>=this.width&&i>=this.height)){var o=(0,X.ut)(this.element,e);(o.x>t||o.y>i)&&this.options.whitespaceClickHandler(e)}},a.prototype.initializeScrollbars=function(){var e=this;this.columnScrollbar=new W.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,H.S)(n.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar=new W.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,H.S)(n.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},a.prototype.setSteppedLayout=function(e){if(e!==this.steppedLayout){this.steppedLayout=e;var t=e?s.xU.Stepped:s.xU.Blocked;this.columnWidthMeasureManager=new m.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new m.FA(this.measureElement,this.sizeManager):new m.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new m.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new m.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new m.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},a.prototype.createRenderers=function(){var e=this,t=this.isA11yTable?s.y2.Table:s.y2.Matrix;this.topRenderer=new l(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,s.p0.Header,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new h(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,s.p0.Body,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new y(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,s.p0.Footer,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},a.prototype.setWidth=function(e){this.width=e,this.element.style.width=(0,H.S)(this.width),this.columnScrollbar.invalidateArrange()},a.prototype.setHeight=function(e){this.height=e,this.element.style.height=(0,H.S)(this.height),this.rowScrollbar.invalidateArrange()},a.prototype.getWidth=function(){return this.width},a.prototype.getHeight=function(){return this.height},a.prototype.setClassName=function(e){this.element.className=e},a.prototype.setColumnNavigator=function(e){this.columnNavigator=e,this.focusManager.columnNavigator=e},a.prototype.setRowNavigator=function(e){this.rowNavigator=e,this.focusManager.rowNavigator=e},a.prototype.setBinder=function(e){this.binder=e},a.prototype.getSteppedLayout=function(){return this.steppedLayout},a.prototype.getColumnNavigator=function(){return this.columnNavigator},a.prototype.getRowNavigator=function(){return this.rowNavigator},a.prototype.getSizeManager=function(){return this.sizeManager},a.prototype.getBinder=function(){return this.binder},a.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},a.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},a.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},a.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},a.prototype.getTopRenderer=function(){return this.topRenderer},a.prototype.getMidRenderer=function(){return this.midRenderer},a.prototype.getBotRenderer=function(){return this.botRenderer},a.prototype.getViewport=function(){var e=this.columnScrollbar.viewMin,t=this.rowScrollbar.viewMin,i=this.columnScrollbar.viewSize,o=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(e=Math.max(e-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),i-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:e,top:t,width:i=Math.max(i,0),height:o=Math.max(o,0)}},a.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?n.zf:0)},a.prototype.storeFocus=function(){var t,i,o,f,e=document.activeElement;if(this.topViewport.contains(e))this.topRenderer.isPrefixCell(e)?(t=this.topRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),o=s.p0.Header,f=s.aP.Prefix):(t=this.topRenderer.getRowIndex(e),i=this.topRenderer.getColumnIndex(e),o=s.p0.Header,f=s.aP.Main);else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?(t=this.midRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),o=s.p0.Body,f=s.aP.Prefix):(t=this.midRenderer.getRowIndex(e),i=this.midRenderer.getColumnIndex(e),o=s.p0.Body,f=s.aP.Main);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?(t=this.botRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),o=s.p0.Footer,f=s.aP.Prefix):(t=this.botRenderer.getRowIndex(e),i=this.botRenderer.getColumnIndex(e),o=s.p0.Footer,f=s.aP.Main);else if(this.isA11yTable){var w=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(w),i=this.topRenderer.getColumnIndex(w),o=s.p0.Header,f=s.aP.Main}else{var T=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(T),i=this.topRenderer.getColumnIndex(T),o=s.p0.Header,f=s.aP.Prefix}this.tempFocus={rowIndex:t,columnIndex:i,section:o,region:f}},a.prototype.restoreFocus=function(){var t,e=this;se.fF.assert(function(){return!!e.tempFocus},"tempFocus must be defined"),this.tempFocus.section===s.p0.Header?t=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===s.p0.Body?t=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,s.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===s.p0.Footer&&(t=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),t||(this.updateFocus(),t=this.getFocusedCell(this.focusManager.CurrentFocus)),t.focus({preventScroll:!0})},a.prototype.updateFocus=function(){var t,i,o,f,e=document.activeElement;if(this.topViewport.contains(e))if(this.topRenderer.isPrefixCell(e))t=this.topRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),o=this.isA11yTable?s.p0.Header:s.p0.MatrixCorner;else{var w=this.topRenderer.getItemByElement(e);o=s.p0.Header,f=this.columnNavigator.getPathIndices(w)}else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.midRenderer.getRowIndex(e),i=-1,o=s.p0.Body):(w=this.midRenderer.getItemByElement(e),o=s.p0.MatrixRowHeader,f=this.rowNavigator.getPathIndices(w)):(t=this.midRenderer.getRowIndex(e),i=this.midRenderer.getColumnIndex(e),o=s.p0.Body);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.botRenderer.getRowIndex(e),i=-1,o=s.p0.Footer):(t=this.botRenderer.getRowIndex(e),o=s.p0.FooterHeader):(t=this.botRenderer.getRowIndex(e),i=this.botRenderer.getColumnIndex(e),o=s.p0.Footer);else if(this.isA11yTable){var T=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(T),i=this.topRenderer.getColumnIndex(T),o=s.p0.Header}else{var j=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(j),i=this.topRenderer.getColumnIndex(j),o=s.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(t,i,o,f)},a.prototype.scrollBy=function(e,t){if(this.renderLock)return!1;var i,o;if(e){var f=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(e,!0),this.columnScrollbar.refresh(),i=f!==this.columnScrollbar.viewMin}if(t){var w=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(t,!0),this.rowScrollbar.refresh(),o=w!==this.rowScrollbar.viewMin}return!(!i&&!o||(this.refresh(),0))},a.prototype.scrollTo=function(e,t){this.renderLock||(null!=e&&(this.columnScrollbar.scrollTo(e,!0),this.columnScrollbar.refresh()),null!=t&&(this.rowScrollbar.scrollTo(t,!0),this.rowScrollbar.refresh()),this.refresh())},a.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var e=this.getViewport(),t=this.columnScrollbar.viewMin,i=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(t),this.midRenderer.scrollToX(t),this.botRenderer.scrollToX(t),this.midViewport.scrollTop=i,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator)}},a.prototype.renderAsync=function(e,t,i){return(0,Q.mG)(this,void 0,void 0,function(){var o,f,M,w,T;return(0,Q.Jh)(this,function(j){switch(j.label){case 0:return o=++this.renderIteration,e===s.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(t,i,o)];case 1:return T=j.sent(),f=T[0],M=T[1],o!==this.renderIteration||(this.unlockRendering(),(w=this.element.contains(document.activeElement))&&this.storeFocus(),(e===s.BM.ClearRendering||e===s.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(f,M),e===s.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),w&&(e===s.BM.ClearRendering||e===s.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},a.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},a.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},a.prototype.measureAsync=function(e,t,i){return(0,Q.mG)(this,void 0,void 0,function(){var o,f,M,w,T,j,L;return(0,Q.Jh)(this,function(re){switch(re.label){case 0:if(T=this.getViewport(),e?w=e.rowIndex:(j=m._E.getVisibleRange(T.top,T.height,this.rowHeightMeasureManager),w=j?j.firstLeafIndex:0),t?M=t.columnIndex:(L=m.sW.getVisibleRange(T.left,T.width,this.columnWidthMeasureManager),M=L?L.firstLeafIndex:0),M=Math.max(0,Math.floor(M-m.EO/2)),!t)return[3,4];re.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&t.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,w),[4,this.setTimeoutAsync()]):[3,3];case 2:return re.sent(),i!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return o=m.sW.getOffset(t,this.columnWidthMeasureManager),t.alignRight&&(o-=this.columnScrollbar.viewSize),[3,5];case 4:o=this.columnScrollbar.viewMin,re.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-o<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,w),[4,this.setTimeoutAsync()]):[3,7];case 6:return re.sent(),i!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,w,m.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,w,M,m.EO),!e)return[3,11];re.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&e.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,w,M),[4,this.setTimeoutAsync()]):[3,10];case 9:return re.sent(),i!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return f=m._E.getOffset(e,this.rowHeightMeasureManager),e.alignBottom&&(f-=this.rowScrollbar.viewSize),[3,12];case 11:f=this.rowScrollbar.viewMin,re.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-f<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,w,M),[4,this.setTimeoutAsync()]):[3,14];case 13:return re.sent(),i!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,w,M,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,w,M,m.EO),this.measurePageColumnsAsync(w,i),this.measurePageRowsAsync(w,M,i),[2,[o,f]]}})})},a.prototype.updateAria=function(){var e=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",e),d3.select(this.innerContainer).attr("aria-colcount",t)},a.prototype.setTimeoutAsync=function(e){return void 0===e&&(e=0),(0,Q.mG)(this,void 0,void 0,function(){return(0,Q.Jh)(this,function(t){return[2,new Y.J(function(i){return D.l.setTimeout(function(){return i()},e)})]})})},a.prototype.requestAnimationFrameAsync=function(){return(0,Q.mG)(this,void 0,void 0,function(){return(0,Q.Jh)(this,function(e){return[2,new Y.J(function(t){return D.l.requestAnimationFrame(function(){return t()})})]})})},a.prototype.getVisibleRowStart=function(){var e=this.getViewport(),t=m._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);return t?m._E.getVisibleRowStart(t,e.top,this.rowHeightMeasureManager):null},a.prototype.getVisibleColumnStart=function(){var e=this.getViewport(),t=m.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager);return t?m.sW.getVisibleColumnStart(t,e.left,this.columnWidthMeasureManager):null},a.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},a.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},a.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},a.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,H.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var e=(0,H.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=e},a.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var e=this.rowHeightMeasureManager.getFloatingRowHeights(),t=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-e,i=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),o=this.rowHeightMeasureManager.getRowsHeight(),f=this.columnWidthMeasureManager.getColumnsWidth(),M=this.options.scrollingEnabled&&o>0&&o>t,w=this.options.scrollingEnabled&&f>0&&f>i;!M&&w&&o>0&&(M=o>t-n.zf),!w&&M&&f>0&&(w=f>i-n.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=M?this.rowScrollbar.width:(0,H.S)(0);var j,L,T=w?n.zf:0;o>t-T?(j=T+e,L=T):(j=t+e-o,L=t-o),this.midViewport.style.bottom=(0,H.S)(j),this.botViewport.style.bottom=(0,H.S)(L),this.rowScrollbar.show(M),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=w?n.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(w),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=M?n.zf+"px":"0",this.columnScrollbar.refresh()},a.prototype.getBodyCellWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-e,t)},a.prototype.measurePageColumnsAsync=function(e,t){return(0,Q.mG)(this,void 0,void 0,function(){return(0,Q.Jh)(this,function(i){switch(i.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(i.sent(),t!==this.renderIteration)return[2];i.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return i.sent(),t!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},a.prototype.measurePageRowsAsync=function(e,t,i){return(0,Q.mG)(this,void 0,void 0,function(){return(0,Q.Jh)(this,function(o){switch(o.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(o.sent(),i!==this.renderIteration)return[2];o.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e,t),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return o.sent(),i!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},a.prototype.updateScrollRegionWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth(),i=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?t+e:t,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?i:i-e,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},a.prototype.updateScrollRegionHeight=function(){var e=this.rowHeightMeasureManager.getRowsHeight(),t=this.midViewport.clientHeight,i=(0,H.S)(Math.max(e,t));this.innerBodyCellContainer.style.height=i,this.rowScrollbar.max=e,this.rowScrollbar.viewSize=t,this.rowScrollbar.refresh()},a.prototype.getNumberOfVisibleRows=function(){var e=this.getViewport(),t=m._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);if(t)return Math.max(0===t.firstLeafIndex?t.lastLeafIndex-t.firstLeafIndex:t.lastLeafIndex-t.firstLeafIndex-1,1)},a.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},a.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},a.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},a.prototype.destroy=function(){this.renderIteration=NaN},a.ScrollDeltaMax=200,a}()},91468:function(Fe,Me,B){B.d(Me,{CQ:function(){return d},D2:function(){return h},JT:function(){return R},K2:function(){return F},Km:function(){return i},Kq:function(){return re},MO:function(){return O},Nk:function(){return j},Od:function(){return w},Ps:function(){return y},RD:function(){return e},RP:function(){return a},TQ:function(){return T},VM:function(){return s},X1:function(){return V},aY:function(){return L},do:function(){return u},jv:function(){return f},kJ:function(){return l},n2:function(){return I},qk:function(){return k},rP:function(){return M},s$:function(){return b},tO:function(){return t},wV:function(){return p},x9:function(){return c}});var Q=B(18664),de=B(91358),se=B(32105),te=B(19650),Y=B(62458),D=B(32041),W=B(48066),X=B(38078),z=B(66001),K=B(7911),m=B(93340),H=B(71090),n="0.3",s="cell-interactive",p="pivotTableCellNoWrap",I="pivotTableCellWrap",F=5,b=5,O=5;function k(A){return A.insertAdjacentHTML("beforeend",K.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),A.lastChild}function V(A,ie){return _.isEmpty(A)?0:D.b.measureSvgTextWidth(ie,A)}function R(A,ie){if(_.isEmpty(A))return 0;var ee=0;return A.split("\n").forEach(function(ne){var ae=V(ne,ie);ae>ee&&(ee=ae)}),ee}function u(A,ie,ee){return _.isEmpty(A)?[A]:(A=A.trim(),(0,z.ql)(A,ee,D.b.measureSvgTextWidth,ie,H.uZ,void 0,!0,!0))}function c(A,ie){return Math.max(0,A-(ie.getExtraLeft()+ie.getExtraRight()))}function d(A){A.opacity=n}function l(A,ie){return Y.fF.assertValue(A,"kpi"),Y.fF.assertValue(ie,"kpiValue"),K.bG.build({content:"",classNames:[(0,de.sq)(A,ie)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function h(A,ie,ee,ne){var ae={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:A,referrerpolicy:"no-referrer"},contextMenuHandler:function(ue){ue.stopPropagation()}};return null!=ne&&(ae.attributes.alt=ne),{children:[ae],classNames:[H.Ed],styleProperties:{height:ie+"px",width:ee+"px"},attributes:null}}function y(A,ie,ee,ne){Y.fF.assertValue(A,"undefined iconSettings");var ae={attributes:{},styleProperties:{},classNames:["flex-container"]},le=function(A,ie,ee){Y.fF.assertValue(A,"undefined icon");var ne=ie+"px";return null===A.value?{tagName:"div",styleProperties:{height:ne,width:ne},attributes:{},classNames:null}:(Y.fF.assertValue(A.value,"Undefined icon value"),A.value.svgId?{tagName:"svg",attributes:{height:ne,width:ne,role:"img","aria-label":ee.getLocalizedString(A.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+A.value.svgId},classNames:null,styleProperties:{}}]}:null!=A.value.url?{tagName:"img",classNames:null,styleProperties:{height:ne,width:ne},attributes:{src:(0,X.HZ)(A.value.url),referrerpolicy:"no-referrer"}}:void Y.fF.assertFail("Unrecognized icon value"))}(A,ie,ne);switch(ee.classNames.push("stretching-content"),A.layout){case"IconOnly":ee.children=[le],P(A,ee),ae.children=[ee];break;case"After":P(A,le),ae.children=[ee,le];break;default:P(A,le),ae.children=[le,ee]}return ae}function P(A,ie){ie.classNames||(ie.classNames=[]);var ee=ie.classNames;switch(ee.push("tablixIcon"),A.layout){case"IconOnly":break;case"Before":ee.push("before");break;default:ee.push("after")}switch(A.verticalAlignment){case"Bottom":ee.push("bottom");break;case"Middle":ee.push("middle");break;default:ee.push("top")}}function a(A,ie){return A?(0,m.RP)(ie):null}function e(A,ie,ee,ne,ae,le){var ue={tagName:"a",classNames:[],styleProperties:{},attributes:{href:ie,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(ce){ce.stopPropagation(),ne(ie,ce)},contextMenuHandler:function(ce){ce.stopPropagation()}};return"string"==typeof A?ue.content=A:ue.children=[A],ee&&(ue.content=void 0,ue.children=void 0,ue.classNames.push(H.NA,ee),ue.attributes["aria-label"]=ie),ae&&(ue.styleProperties.color="inherit"),le&&(ue.attributes.title=ie),ue}function t(A){return A-1}function i(A,ie,ee,ne,ae,le,ue){var ge,ce={};return ie&&(ge=A?["powervisuals-glyph","sort-icon",o(A)]:ee?["powervisuals-glyph","sort-icon",o(ne),"future"]:["sort-icon"]),!A&&ee?ce["aria-label"]=ue.getLocalizedString("Field_Sorting_Possible"):ce["aria-hidden"]="true",{content:H.jv,attributes:ce,styleProperties:{"font-size":le,bottom:ae+"px"},classNames:ge}}function o(A){switch(A){case 1:return"caret-up";case 2:return"caret-down"}}function f(A,ie){return(0,m.MN)(A,ie)!==W.av.NONE}function M(A){return A&&A.replace(/&#10;/g,"<BR />")}function w(A,ie){A.size&&8.52===A.size.px&&(A=(0,Q.ED)(A,{size:se.B.createFromPx(8)}));var ee={measuredFontHeight:null,textProperties:(0,Q.qk)(A),fontProperties:A};return ie.addItem(ee),ee}function T(A,ie,ee){return w((0,Q.ED)(A.fontProperties,ie),ee)}function j(A,ie,ee){var ne=A.fontProperties;ne.family&&(ie.fontFamily=ne.family),ne.size&&(ie.fontSize=ne.size),ne.weight&&(ie.fontWeight=ne.weight),ne.style&&(ie.fontStyle=ne.style),ne.textDecoration&&ee&&(ie.textDecoration=ne.textDecoration)}function L(A,ie,ee){if(Y.fF.assertValue(ie,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==A||A===te.H.auto){if(!ee)return;A=ee}switch(A){case te.H.left:return void ie.push(H.z7);case te.H.center:return void ie.push(H.QM);case te.H.right:return void ie.push(H.OM);default:return}}var re=function(){function A(){this.items=[]}return A.prototype.addItem=function(ie){this.items.push(ie)},A.prototype.measureAll=function(ie){if(!_.isEmpty(this.items)){for(var ee=[],ne=0,ae=this.items;ne<ae.length;ne++){var ue={content:"a",classNames:null,styleProperties:(0,Q.wB)(ae[ne].fontProperties),attributes:null};ee.push(K.bG.build(ue,null))}var ge=ee.join("");ie.insertAdjacentHTML("beforeend",ge);for(var Ce,ce=!0,be=0,He=this.items;be<He.length;be++)ce?(ce=!1,Ce=ie.firstChild):Ce=Ce.nextSibling,He[be].measuredFontHeight=Math.ceil(Ce.offsetHeight);ie.innerHTML=""}},A}()},59151:function(Fe,Me,B){B.d(Me,{P:function(){return de}});var Q=B(55007);function de(se,te,Y){for(var D={remove:[],merge:[]},W=0,X=se;W<X.length;W++){var z=X[W],K={selector:z.selector,objectName:Q.FX.PropColumnWidthValue.objectName,properties:{}};K.properties[Q.FX.PropColumnWidthValue.propertyName]=z.value,null==z.value?D.remove.push(K):D.merge.push(K)}te.persistProperties(D,Y)}},93568:function(Fe,Me,B){B.d(Me,{$H:function(){return c},B0:function(){return p},aV:function(){return I},cP:function(){return F},qW:function(){return u}});var Q=B(1521),de=B(79154),se=B(54522),te=B(55007),Y=B(40550),D=B(62458),W=B(32041),X=B(64329),z=B(48066),K=B(66001),m=B(93340),H=B(71090),n=B(13375),s=B(64067);function p(d,l,h,y,g,P,a,e){var t,i,o,f,M;void 0===P&&(P=!1),void 0===a&&(a=!1);var w=g.grid,T=g.rowHeaders,j=g.values,L=g.columnHeaders,re=null!==(t=g.grandTotal)&&void 0!==t?t:g.rowGrandTotal,A=g.subtotals||{},ie=g.rowSubtotals||{},ee=null!==(i=T.outlineWeight)&&void 0!==i?i:w.outlineWeight,ne=null!==(o=T.outlineColor)&&void 0!==o?o:w.outlineColor;h.paddings.top=h.paddings.bottom=w.rowPadding;var ae=n.hc.isNodeGrandTotal(l);h.borders.top=new m.om,(d.row.isFirst&&!y||y&&0===l.leafIndex)&&(h.borders.top.applyParams((0,Y.yo)(T.outline),ee,ne,m.Pb.Outline),!(0,Y.yo)(T.outline)&&(0,Y.yo)(j.outline)&&(h.paddings.top+=ee)),h.borders.bottom=new m.om,d.row.isLast&&(!y||y&&d.column.isLast&&!g.general.rowSubtotals)||y&&d.row.isFirst&&l.isSubtotal?(h.borders.bottom.applyParams((0,Y.mv)(T.outline),ee,ne,m.Pb.Outline),!(0,Y.mv)(T.outline)&&(0,Y.mv)(j.outline)&&(h.paddings.bottom+=ee)):h.borders.bottom.applyParams(w.gridHorizontal,w.gridHorizontalWeight,w.gridHorizontalColor,m.Pb.Gridline),h.borders.left=new m.om,(y||d.column.isFirst)&&(h.borders.left.applyParams((0,Y.fs)(T.outline),ee,ne,m.Pb.Outline),!(0,Y.fs)(T.outline)&&(0,Y.fs)(L.outline)&&(h.paddings.left+=ee)),h.borders.right=new m.om;var le=y||d.column.isLast;if(le?h.borders.right.applyParams((0,Y.BK)(T.outline),ee,ne,m.Pb.Outline):h.borders.right.applyParams(w.gridVertical,w.gridVerticalWeight,w.gridVerticalColor,m.Pb.Gridline),l.isBlankRow&&O(h,g),re.applyToHeaders&&ae)h.fontColor=re.fontColor||T.fontColor,h.backColor=re.backColor||T.backColor;else{var ge=P&&(j.fontColorPrimary!==j.fontColorSecondary||j.backColorPrimary!==j.backColorSecondary)&&(a||le),ce=null!==(f=ie.fontColor)&&void 0!==f?f:A.fontColor,He=ge&&!(l.hasSubtotalStyle&&ce)&&!(ae&&re.fontColor),Se=null!==(M=ie.backColor)&&void 0!==M?M:A.backColor,Oe=ge&&!(l.hasSubtotalStyle&&Se)&&!(ae&&re.backColor),Ae=void 0;(He||Oe)&&(Ae=e??k(l.position,g.general,Se)),h.fontColor=He?V(Ae,j):T.fontColor,h.backColor=l.isBlankRow?b(l.isBlankRow,g):Oe?R(Ae,j):T.backColor}}function I(d,l,h,y){var g,P,a,e,t,i=y.grid,o=y.columnHeaders,f=y.values,M=null!==(g=y.grandTotal)&&void 0!==g?g:y.columnGrandTotal,w=null!==(P=o.outlineWeight)&&void 0!==P?P:i.outlineWeight,T=null!==(a=o.outlineColor)&&void 0!==a?a:i.outlineColor,j=y.columnFormatting[l.queryName],L=null===(t=null===(e=y.annotationFormatting)||void 0===e?void 0:e.columnHeaders)||void 0===t?void 0:t[l.queryName],re=n.hc.isNodeGrandTotal(l);h.fontColor=j&&j.styleHeader&&j.fontColor?j.fontColor:M.applyToHeaders&&re&&M.fontColor||o.fontColor,h.backColor=L&&L.backColor?L.backColor:j&&j.styleHeader&&j.backColor?j.backColor:M.applyToHeaders&&re&&M.backColor||o.backColor,L&&L.bold&&(h.fontWeight=de.en),h.paddings.top=h.paddings.bottom=i.rowPadding,h.borders.top=new m.om,d.row.isFirst&&h.borders.top.applyParams((0,Y.yo)(o.outline),w,T,m.Pb.Outline),h.borders.bottom=new m.om,d.row.isLast?h.borders.bottom.applyParams((0,Y.mv)(o.outline),w,T,m.Pb.Outline):h.borders.bottom.applyParams(i.gridHorizontal,i.gridHorizontalWeight,i.gridHorizontalColor,m.Pb.Gridline),h.borders.left=new m.om,d.column.isFirst&&!(0,Y.fs)(o.outline)&&(0,Y.fs)(f.outline)&&(h.paddings.left+=w),h.borders.right=new m.om,d.column.isLast?(h.borders.right.applyParams((0,Y.BK)(o.outline),w,T,m.Pb.Outline),!(0,Y.BK)(o.outline)&&(0,Y.BK)(f.outline)&&(h.paddings.right+=w)):h.borders.right.applyParams(i.gridVertical,i.gridVerticalWeight,i.gridVerticalColor,m.Pb.Gridline)}function F(d,l,h,y,g,P){var a,e,t,i,o,f,M,w,T,j=g.grid,L=g.values,re=g.rowHeaders,A=g.columnHeaders,ie=g.rowSubtotals||{},ee=g.columnSubtotals||{},ne=g.subtotals||{},ae=null!==(a=L.outlineWeight)&&void 0!==a?a:j.outlineWeight,le=null!==(e=L.outlineColor)&&void 0!==e?e:j.outlineColor;h.paddings.top=h.paddings.bottom=j.rowPadding,h.borders.top=new m.om,d.row.isFirst&&(h.borders.top.applyParams((0,Y.yo)(L.outline),ae,le,m.Pb.Outline),!(0,Y.yo)(L.outline)&&(0,Y.yo)(re.outline)&&(h.paddings.top+=ae)),h.borders.bottom=new m.om,d.row.isLast&&(!y||y&&!g.general.rowSubtotals)||y&&l.isRowGrandTotal?(h.borders.bottom.applyParams((0,Y.mv)(L.outline),ae,le,m.Pb.Outline),!(0,Y.mv)(L.outline)&&(0,Y.mv)(re.outline)&&(h.paddings.bottom+=ae)):h.borders.bottom.applyParams(j.gridHorizontal,j.gridHorizontalWeight,j.gridHorizontalColor),h.borders.left=new m.om,d.column.isFirst&&h.borders.left.applyParams((0,Y.fs)(L.outline),ae,le,m.Pb.Outline),h.borders.right=new m.om,d.column.isLast?(h.borders.right.applyParams((0,Y.BK)(L.outline),ae,le,m.Pb.Outline),!(0,Y.BK)(L.outline)&&(0,Y.BK)(A.outline)&&(h.paddings.right+=ae)):h.borders.right.applyParams(j.gridVertical,j.gridVerticalWeight,j.gridVerticalColor,m.Pb.Gridline),null!==(t=l.rowItem)&&void 0!==t&&t.isBlankRow&&O(h,g);var ge,ce,Ce,be,ue=l.columnMetadata&&g.columnFormatting[l.columnMetadata.queryName];ue&&(l.isGrandTotal?(ce=ue.styleTotal&&ue.fontColor,ge=ue.styleTotal&&ue.backColor):l.hasSubtotalStyle?(ce=ue.styleSubTotals&&ue.fontColor,ge=ue.styleSubTotals&&ue.backColor):(ce=ue.styleValues&&ue.fontColor,ge=ue.styleValues&&ue.backColor)),l.hasColumnSubtotalStyle?(Ce=null!==(i=ee.fontColor)&&void 0!==i?i:ne.fontColor,be=null!==(o=ee.backColor)&&void 0!==o?o:ne.backColor):l.hasRowSubtotalStyle?(Ce=null!==(f=ie.fontColor)&&void 0!==f?f:ne.fontColor,be=null!==(M=ie.backColor)&&void 0!==M?M:ne.backColor):(Ce=ne.fontColor,be=ne.backColor);var He=P??k(l.position,g.general,be??ie.backColor),Se=V(He,L),me=R(He,L),Le=b(null===(w=l.rowItem)||void 0===w?void 0:w.isBlankRow,g);if(l.isGrandTotal){var Oe=null!==(T=g.grandTotal)&&void 0!==T?T:l.isColumnGrandTotal?g.columnGrandTotal:g.rowGrandTotal;h.fontColor=l.fontColor||ce||Oe.fontColor||Ce||Se,h.backColor=l.backColor||ge||Oe.backColor||be||Le||me}else l.hasSubtotalStyle?(h.fontColor=l.fontColor||ce||Ce||Se,h.backColor=l.backColor||ge||be||Le||me):(h.fontColor=l.fontColor||ce||Se,h.backColor=l.backColor||ge||Le||me)}function b(d,l){var h,y,g;if(d){var P=null===(h=l.blankRows)||void 0===h?void 0:h.blankRowTransparency;g=null===(y=l.blankRows)||void 0===y?void 0:y.blankRowColor,null!=P&&(g=(0,Q.Et)(g,(0,s.TD)(P)))}return g}function O(d,l){var h,y,g,P,a;if(null!==(h=l?.blankRows)&&void 0!==h&&h.showBorder){var e=null===(y=l?.blankRows)||void 0===y?void 0:y.borderPosition,t=null===(g=l?.blankRows)||void 0===g?void 0:g.borderWidth,i=null===(P=l?.blankRows)||void 0===P?void 0:P.borderTransparency,o=null===(a=l?.blankRows)||void 0===a?void 0:a.borderColor;null!=o&&null!=i&&(o=(0,Q.Et)(o,(0,s.TD)(i))),("Top"===e||"TopAndBottom"===e)&&(d.borders.top.color=o,d.borders.top.weight=t),("Bottom"===e||"TopAndBottom"===e)&&(d.borders.bottom.color=o,d.borders.bottom.weight=t)}}function k(d,l,h){var y;return(y=l.rowSubtotals&&h?d.row.indexInSiblings:d.row.index)<0||y%2==0}function V(d,l){return d?l.fontColorPrimary:l.fontColorSecondary}function R(d,l){return d?l.backColorPrimary:l.backColorSecondary}function u(d,l,h,y){var g,P,a=y.grid,e=y.columnHeaders,t=y.rowHeaders,i=null!==(g=e.outlineWeight)&&void 0!==g?g:a.outlineWeight,o=null!==(P=e.outlineColor)&&void 0!==P?P:a.outlineColor;l.fontColor=e.fontColor||t.fontColor,l.backColor=e.backColor||t.backColor,l.paddings.top=l.paddings.bottom=a.rowPadding,l.borders.top=new m.om,d.row.isFirst&&l.borders.top.applyParams((0,Y.yo)(e.outline),i,o,m.Pb.Outline),l.borders.bottom=new m.om,d.row.isLast?l.borders.bottom.applyParams((0,Y.mv)(e.outline),i,o,m.Pb.Outline):l.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,m.Pb.Gridline),l.borders.left=new m.om,(d.column.isFirst||h)&&(l.borders.left.applyParams((0,Y.fs)(e.outline),i,o,m.Pb.Outline),!(0,Y.fs)(e.outline)&&(0,Y.fs)(t.outline)&&(l.paddings.left+=i)),l.borders.right=new m.om,l.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,m.Pb.Gridline)}var c=function(){function d(l,h){this.hierarchyNavigator=l,this.options=h}return d.prototype.onDataViewChanged=function(l){this.formattingProperties=l,this.updateTextHeights()},d.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:H.F2,fontSize:X.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(W.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:H.dG,fontSize:X.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(W.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:H.Zk,fontSize:X.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(W.b.measureSvgTextHeight(this.textPropsTotal,"a"))},d.prototype.onStartRenderingSession=function(){},d.prototype.onEndRenderingSession=function(){},d.prototype.bindRowHeader=function(l,h){(0,m.ey)(h);var y=this.options.tablixProperties,g=new m.qZ;this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(l)&&((0,m.R5)(h,H.Eo),g.borders.right=new m.om(te.FX.PropGridOutlineWeight.defaultValue,y.PropGridOutlineColor.getValue(null))),l.isSubtotal&&(g.paddings.left=H.P$),h.contentWidth=0,this.bindHeader(l,h,h.extension.contentHost,this.hierarchyNavigator.getRowHeaderMetadataColumn(l),g),h.contentWidth=Math.ceil(h.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(l),p(h.position,l,g,!1,this.formattingProperties),h.applyStyle(g)},d.prototype.unbindRowHeader=function(l,h){(0,m.G9)(h),(0,m.aP)(h)},d.prototype.bindColumnHeader=function(l,h){(0,m.ey)(h);var y=new m.qZ,g=this.options.tablixProperties,P=!1,a=h.extension.contentHost;if((a=(0,m.Ch)(a)).classList.add(H.WA),h.contentWidth=0,this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(l)){if(y.borders.bottom=new m.om(te.FX.PropGridOutlineWeight.defaultValue,g.PropGridOutlineColor.getValue(null)),(0,m.R5)(h,H.mQ),(0,m.R5)(h,H.s0),this.options.showSortIcons){var t=this.getSortableHeaderColumnMetadata(l);t&&(this.registerColumnHeaderClickHandler(t,h),a=(0,m.D6)(t.sort,a),t.sort&&(h.contentWidth=this.fontSizeHeader+H.fG))}l.isSubtotal&&l.parent&&l.parent.children.length>1&&l.parent.children[0].isSubtotal&&(P=!0)}h.extension.disableDragResize(),this.bindHeader(l,h,a,this.hierarchyNavigator.getColumnHeaderMetadataColumn(l),y,P),h.contentWidth=Math.ceil(h.contentWidth),I(h.position,l,y,this.formattingProperties),h.applyStyle(y)},d.prototype.unbindColumnHeader=function(l,h){(0,m.G9)(h),(0,m.aP)(h),this.getSortableHeaderColumnMetadata(l)&&this.unregisterColumnHeaderClickHandler(h),this.options.showSortIcons&&(0,m.Y4)(h)},d.prototype.bindHeader=function(l,h,y,g,P,a){(0,m.R5)(h,H.f),P.fontFamily=H.F2,P.fontColor=H.lN;var e=this.formattingProperties.grid.imageHeight;if(h.contentHeight=(0,se.pt)(g)?e:l.hasSubtotalStyle?this.textHeightTotal:this.textHeightValue,l.hasSubtotalStyle&&((0,m.R5)(h,H.R9),P.fontFamily=H.Zk),l.isSubtotal&&!a)return(0,m.DM)(this.options.totalLabel,y,h.extension.contentHost),void(h.contentWidth=W.b.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var t=this.getHeaderLabel(l);if(t)return(0,m.MN)(g,t)!==z.av.NONE?((0,m.vU)(t,y),void(h.contentWidth+=W.b.measureSvgTextWidth(this.textPropsHeader,t))):(0,se.pt)(g)&&(0,z.gU)(t)?((0,m.Hx)(l.valueFormatted,y,e),void(h.contentWidth+=e*H.wd)):((0,m.DM)(t,y,h.extension.contentHost),void(h.contentWidth+=W.b.measureSvgTextWidth(l.hasSubtotalStyle?this.textPropsTotal:this.textPropsHeader,t)));y.innerHTML=H.jv},d.prototype.applyWordWrapping=function(l,h){if(D.fF.assertValue(h,"applyWordWrapping - Undefined cell"),D.fF.assert(function(){return null!=h.containerWidth&&-1!==h.containerWidth},"applyWordWrapping - Undefined width"),D.fF.assert(function(){return null!=h.containerHeight&&-1!==h.containerHeight},"applyWordWrapping - Undefined height"),1===h.type){var y=this.hierarchyNavigator.getRowHeaderMetadataColumn(l);if(!(0,se.cR)(y)&&!(0,se.pt)(y)){var g=h.extension.contentHost;(0,m.D4)(g);var P=l.valueFormatted,a=new m.qZ;p(l.position,l,a,!1,this.formattingProperties);for(var e=h.containerWidth-(a.getExtraRight()+a.getExtraLeft()),t=h.containerHeight-(a.getExtraTop()+a.getExtraBottom()),i=Math.floor(t/this.textHeightHeader),f=0,M=(0,K.ql)(P,this.textPropsHeader,W.b.measureSvgTextWidth,e,i,null,!0);f<M.length;f++)(0,m.Ch)(g,M[f])}}},d.prototype.registerColumnHeaderClickHandler=function(l,h){var y=this;this.options.onColumnHeaderClick&&h.extension.registerClickHandler(function(a){if((0,m.xl)(a)){var e=(0,m.x7)(l.sort);y.options.onColumnHeaderClick(l.queryName?l.queryName:l.displayName,e)}})},d.prototype.unregisterColumnHeaderClickHandler=function(l){this.options.onColumnHeaderClick&&l.extension.unregisterClickHandler()},d.prototype.bindBodyCell=function(l,h){(0,m.ey)(h);var y=new m.qZ;h.contentHeight=this.textHeightValue;var g=l.kpiContent;if(g)$(h.extension.contentHost).append(g),h.contentWidth=this.fontSizeValue;else{var P=this.textPropsValue;(0,m.R5)(h,H.s0),l.isTotal&&((0,m.R5)(h,H.R9),y.fontFamily=H.Zk,h.contentHeight=this.textHeightTotal,P=this.textPropsTotal);var a=l.textContent;a&&((0,m.DM)(a,h.extension.contentHost),h.contentWidth=W.b.measureSvgTextWidth(P,a))}h.contentWidth=Math.ceil(h.contentWidth),F(h.position,l,y,!1,this.formattingProperties),h.applyStyle(y)},d.prototype.unbindBodyCell=function(l,h){(0,m.G9)(h),(0,m.aP)(h)},d.prototype.bindCornerCell=function(l,h){(0,m.ey)(h);var y=this.options.tablixProperties,g=new m.qZ;g.fontFamily=H.F2,g.fontColor=H.lN,h.contentHeight=this.textHeightHeader,h.contentWidth=0;var P=h.extension.contentHost;if((P=(0,m.Ch)(P)).classList.add(H.WA),l.isColumnHeaderLeaf&&((0,m.R5)(h,H.mQ),g.borders.bottom=new m.om(te.FX.PropGridOutlineWeight.defaultValue,y.PropGridOutlineColor.getValue(null)),this.options.showSortIcons)){var a=this.getSortableCornerColumnMetadata(l);a&&(this.registerColumnHeaderClickHandler(a,h),P=(0,m.D6)(a?a.sort:void 0,P),a.sort&&(h.contentWidth=this.fontSizeHeader+H.fG))}(0,m.DM)(l.displayName,P,h.extension.contentHost),h.contentWidth+=W.b.measureSvgTextWidth(this.textPropsHeader,l.displayName),h.contentWidth=Math.ceil(h.contentWidth),l.isRowHeaderLeaf&&(0,m.R5)(h,H.Eo),(0,m.R5)(h,H.f),u(h.position,g,!1,this.formattingProperties),h.applyStyle(g),h.extension.disableDragResize()},d.prototype.unbindCornerCell=function(l,h){(0,m.G9)(h),(0,m.aP)(h),this.options.showSortIcons&&(0,m.Y4)(h),l.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(h)},d.prototype.bindEmptySpaceHeaderCell=function(l){},d.prototype.unbindEmptySpaceHeaderCell=function(l){},d.prototype.bindEmptySpaceFooterCell=function(l){},d.prototype.unbindEmptySpaceFooterCell=function(l){},d.prototype.getHeaderLabel=function(l){return l.valueFormatted},d.prototype.getCellContent=function(l){return l.textContent||""},d.prototype.hasRowGroups=function(){var l=this.hierarchyNavigator.getRowHierarchy();return!(!l||!l.levels||0===l.levels.length)},d.prototype.getSortableCornerColumnMetadata=function(l){if(l.isColumnHeaderLeaf)return l.metadata},d.prototype.getSortableHeaderColumnMetadata=function(l){var h=this.hierarchyNavigator.getRowHierarchy();if(!h||!h.levels||0===h.levels.length)return null;var y=this.hierarchyNavigator.getValueSources(),g=y&&y.length>1,P=this.hierarchyNavigator.getColumnHierarchy(),a=P?P.levels.length:0;g?a--:1===a&&P.levels[0]&&P.levels[0].sources&&P.levels[0].sources[0]&&P.levels[0].sources[0].roles&&P.levels[0].sources[0].roles.Values&&(a=0);var e=-1;return 0===a?e=l.levelSourceIndex:l.isSubtotal&&(g?l.parent&&0===l.parent.level&&(e=l.levelSourceIndex):0===l.level&&(e=l.levelSourceIndex)),-1!==e?y[e=e||0]:null},d}()},13375:function(Fe,Me,B){B.d(Me,{aD:function(){return K},hc:function(){return m}});var Q=B(81337),de=B(62458),se=B(39681),te=B(38078),Y=B(93340),D=B(29043),W=B(66842),X=B(40845),z=function(H){function n(s,p,I,F,b,O,k,V){var u,c,d,l,R=this;if(I)for(d=I;d.parent;)d=d.parent;if(F)for(l=F;l.parent;)l=l.parent;var h=l&&!!l.isSubtotal,y=!h&&F&&!!F.isSubtotal,g=d&&!!d.isSubtotal,P=!g&&I&&!!I.isSubtotal,a=I.isBlankRow;return _.isString(s)&&!(null===(c=null===(u=b?.type)||void 0===u?void 0:u.misc)||void 0===c)&&c.sparkline&&(s=(0,D.th)(s,O)),(R=H.call(this,s,p,P,y,g,h,a,b,k,V,0)||this).rowItem=I,R.columnItem=F,R.hasRowSubtotalStyle=I&&I.hasSubtotalStyle,R.hasColumnSubtotalStyle=F&&F.hasSubtotalStyle,R.hasSubtotalStyle=R.hasRowSubtotalStyle||R.hasColumnSubtotalStyle,R}return(0,Q.ZT)(n,H),Object.defineProperty(n.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),n}(Y.jG);function K(H,n,s,p,I,F,b,O,k,V){void 0===b&&(b=!0);var R=new m(p,I,F,V,!0);return b&&R.update(H,!1,!1,!1,n,!0,s,O,k,void 0,void 0,!1),R}var m=function(){function H(n,s,p,I,F){this.tablixProperties=s,this.hostServices=p,this.expandCompositeHierarchy=I,this.modernRowHeaderStyle=F,this.compositeGroupSeparator=n}return H.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},H.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},H.prototype.getLeafCount=function(n){var s=this.getMatrixHierarchy(n);return s?s.leafNodes.length:0},H.prototype.getLeafAt=function(n,s){var p=this.getMatrixHierarchy(n);return p?p.leafNodes[s]:null},H.prototype.getLeafIndex=function(n){return de.fF.assertValue(n,"item"),n.leafIndex},H.prototype.getParent=function(n){return de.fF.assertValue(n,"item"),0===n.level?null:n.parent},H.prototype.getIndex=function(n){return de.fF.assertValue(n,"item"),n?n.index:-1},H.prototype.isLeaf=function(n){return de.fF.assertValue(n,"item"),!n.children||0===n.children.length},H.prototype.isRowHierarchyLeaf=function(n){return!0},H.prototype.isColumnHierarchyLeaf=function(n){return!1},H.prototype.isFirstItem=function(n,s){return n===_.head(s)},H.prototype.areAllParentsFirst=function(n,s){if(!n)return!1;var p=this.getParent(n);return p?this.isFirstItem(n,n.siblings)&&this.areAllParentsFirst(p,p.siblings):this.isFirstItem(n,n.siblings)},H.prototype.isLastItem=function(n,s){if(de.fF.assertValue(n,"item"),n!==_.last(s))return!1;if(!this.isItemRow(n)||this.isDataComplete)return!0;for(var p=n.parent;p;){if(p!==_.last(p.siblings))return!0;p=p.parent}return!1},H.prototype.isItemRow=function(n){if(!n)return!1;for(var s=n;s.parent;)s=s.parent;return s.siblings===this.rowHierarchy.root.children},H.prototype.areAllParentsLast=function(n,s){if(!n)return!1;var p=this.getParent(n);return p?this.isLastItem(n,n.siblings)&&this.areAllParentsLast(p,p.siblings):this.isLastItem(n,n.siblings)},H.prototype.getChildren=function(n){return de.fF.assertValue(n,"item"),n.children},H.prototype.getChildrenLevelDifference=function(n){var s=1/0,p=this.getChildren(n);if(!_.isEmpty(p))for(var I=0,F=p.length;I<F;I++)s=Math.min(s,p[I].level-n.level);return s},H.prototype.getCount=function(n){return de.fF.assertValue(n,"items"),n.length},H.prototype.getAt=function(n,s){return de.fF.assertValue(n,"items"),n[s]},H.prototype.getLevel=function(n){return de.fF.assertValue(n,"item"),n.level},H.prototype.getRowLeafIndex=function(n){return this.isSteppedLayout&&n.isSubtotal?n.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?n.parent.leafIndex:n.leafIndex:this.valuesOnRow?n.levelSourceIndex:-1:n.leafIndex},H.prototype.getIntersection=function(n,s){de.fF.assertValue(n,"rowItem"),de.fF.assertValue(s,"columnItem");var p,F,I=s.leafIndex;if(p=n.values?n.values[s.leafIndex]:void 0){var b=this.valueSources[p.valueSourceIndex||0],O=b.queryName;F=new z(p.value,p.objects,n,s,b,this.hostServices,this.formatters[O],this.tooltipFormatters[O])}else F=new z(void 0,void 0,n,s,void 0,this.hostServices,void 0,void 0);var R=this.getRowLeafIndex(n);return F.position.row.index=R,F.position.row.indexInSiblings=n.siblings.indexOf(n),F.position.row.isFirst=0===R,F.position.row.isLast=this.isDataComplete&&R===this.rowHierarchy.leafNodes.length-1,F.position.column.index=I,F.position.column.indexInSiblings=s.siblings.indexOf(s),F.position.column.isFirst=0===I,F.position.column.isLast=I===this.columnHierarchy.leafNodes.length-1,p&&p.objects&&(F.backColor=(0,te.HZ)(this.tablixProperties.PropValuesBackColor.getValue(p.objects)),F.fontColor=(0,te.HZ)(this.tablixProperties.PropValuesFontColor.getValue(p.objects))),F},H.prototype.getCorner=function(n,s){de.fF.assert(function(){return n>=0},"rowLevel"),de.fF.assert(function(){return s>=0},"columnLevel");var F,p=this.columnHierarchy.levels,I=this.rowHierarchy.levels;if((s===p.length-1||0===p.length)&&(F=I[n])){var b=n===I.length-1,O=this.valuesOnRow&&b;return{metadata:1===F.sources.length||F.sources.length>1&&O?F.sources[0]:null,displayName:O?"":_.map(F.sources,function(R){return R.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:b,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}}if(n===I.length-1&&(F=p[s])){var V=F.sources.filter(function(u){return!u.isMeasure});return{metadata:1===F.sources.length?F.sources[0]:null,displayName:_.map(V,function(u){return u.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}},H.prototype.calculateCornerCellPosition=function(n,s){var p=new Y.ri,I=s;p.row.index=p.row.indexInSiblings=I,p.row.isFirst=0===I;var F=this.getColumnHierarchyDepth();p.row.isLast=s===F-1;var b=n;p.column.index=p.column.indexInSiblings=b,p.column.isFirst=0===b;var O=this.getRowHierarchyDepth();return p.column.isLast=b===O-1,p},H.prototype.headerItemEquals=function(n,s){return!(!n||!s)&&n===s},H.prototype.bodyCellItemEquals=function(n,s){return n.position.isMatch(s.position)},H.prototype.cornerCellItemEquals=function(n,s){return!(!n||!s)&&n.displayName===s.displayName&&n.isColumnHeaderLeaf===s.isColumnHeaderLeaf&&n.isRowHeaderLeaf===s.isRowHeaderLeaf&&n.metadata===s.metadata},H.prototype.getColumnHierarchy=function(){return this.columnHierarchy},H.prototype.getRowHierarchy=function(){return this.rowHierarchy},H.prototype.getValueSources=function(){return this.valueSources},H.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},H.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},H.prototype.update=function(n,s,p,I,F,b,O,k,V,R,u,c){var d=this;de.fF.assertValue(n,"matrix"),this.isSteppedLayout=s,this.valuesOnRow=p,this.areRowSubtotalsBefore=I,this.isDataComplete=F,this.valueSources=n.valueSources,this.formatters=O,this.tooltipFormatters=k||{},this.subtotalByColumn=V||{},this.multipleValueSources=n.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(n.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,c,R,u),(b=b||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(n.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,u,this.areRowSubtotalsBefore,function(l,h){return d.calculateRowHeaderPosition(l,h)}),b&&(this.updateHierarchy(this.columnHierarchy,!1,u,!1,function(l,h){return d.calculateColumnHeaderPosition(l,h)}),this.updateStaticColumnHeaders(this.columnHierarchy))},H.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},H.prototype.removeValueNodesFromColumnHierarchy=function(n){de.fF.assertValue(n,"nodes");for(var s=0,p=n;s<p.length;s++){var I=p[s];if(!I.parent&&this.isLeaf(I))return n.length=0,void n.push({level:0});this.isLeaf(I.children[0])?I.children=void 0:this.removeValueNodesFromColumnHierarchy(I.children)}},H.prototype.addValueNodesToRowHierarchy=function(n,s){for(var p=this.getRowHierarchyDepth(),I=this.valueSources.length,F=n.length,b=0;b<F;b++){var O=n[b];if(this.isLeaf(O)){var k=void 0,V=void 0,R=void 0;if(this.isSteppedLayout&&O.isSubtotal||!s?(n.splice(b,1),k=n,V=b,R=O.level,F=F-1+I,b=b-1+I):(O.children=[],k=O.children,V=0,R=p),!O.isBlankRow)for(var u=0;u<I;u++){var c=this.createRowValueNode(u,I,O,R);k.splice(V++,0,c)}O.values=null}else this.addValueNodesToRowHierarchy(O.children,s)}},H.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},H.prototype.createRowValueNode=function(n,s,p,I){var F={level:I,levelSourceIndex:n,isSubtotal:p.isSubtotal,hasSubtotalStyle:!!p.hasSubtotalStyle,values:{}},b=0,O=0;for(var k in p.values)b%s===n&&(F.values[O++]=p.values[b]),b++;return F},H.prototype.createBlankRowValueNode=function(n){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(n),function(p){return p.valueSourceIndex}).map(function(p){return{value:"",valueSourceIndex:p,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},H.prototype.needsBlankRow=function(n,s,p){return!n.isSubtotal||s===X.we&&p!==W.t.Compact},H.prototype.findValues=function(n){if(n.values)return n.values;var s=_.first(n.children);return s?this.findValues(s):void 0},H.prototype.wrapHierarchy=function(n,s,p,I,F,b){var k,O=this;return k={levels:this.wrapLevels(n.levels,s),root:{children:this.wrapNodes(n.root.children,n,s,p)}},I&&k.root.children.length>0&&(k.root.children=_.flatMap(k.root.children,function(V){return O.needsBlankRow(V,F,b)?[V,O.createBlankRowValueNode(V)]:[V]})),k.leafNodes=[],k},H.prototype.wrapLevels=function(n,s){if(n){for(var p=[],I=0,F=n;I<F.length;I++){var b=F[I],O=(0,se.ED)(b);if(p.push(O),b.sources.length>1&&s){for(var k=1;k<b.sources.length;k++)p.push({sources:[b.sources[k]]});O.sources.splice(1,O.sources.length-1)}}return p}},H.prototype.wrapNodes=function(n,s,p,I){if(n){for(var F=[],b=0,O=n;b<O.length;b++){var k=O[b],V=(0,se.ED)(k);if(k.isCollapsed&&!_.isEmpty(k.children)){var R=_.find(k.children,function(g){return g.isSubtotal});R&&(V.values=R.values),V.children=null,V.hasSubtotalStyle=!0}else{if(V.isSubtotal){var u=s.levels[V.level||0];if(1===u.sources.length&&!1===this.subtotalByColumn[u.sources[0].queryName])continue}V.hasSubtotalStyle=!!k.isSubtotal||I&&!_.isEmpty(k.children),V.children=this.wrapNodes(k.children,s,p,I)}if(!_.isEmpty(V.levelValues)&&V.levelValues.length>1&&p){for(var c=V.children,d=V,l=1;l<V.levelValues.length;l++){var h=(0,se.ED)(V),y=V.levelValues[l];y.levelSourceIndex=0,h.levelValues=[y],h.level+=l,h.isCollapsed=!0,h.children=void 0,d.isCollapsed=!1,d.children=[h],d=h}_.isEmpty(c)||(d.children=c,d.isCollapsed=!1),d.values=V.values,V.values=void 0,V.levelValues.splice(1,V.levelValues.length-1)}F.push(V)}return F}},H.prototype.updateHierarchy=function(n,s,p,I,F){n.leafNodes.length>0&&(n.leafNodes.length=0),n.root.children&&this.updateRecursive(n,n.root.children,null,n.leafNodes,s,p,I,F)},H.prototype.createEmptyNode=function(n){return void 0===n&&(n=0),{level:n,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},H.prototype.updateRecursive=function(n,s,p,I,F,b,O,k){for(var V,R=function(h,y){var g=s[h];if(g.siblings=s,n===u.rowHierarchy&&!g.isCollapsed&&!_.isEmpty(g.children)&&b===W.t.Outline&&!O&&g.children.unshift(u.createEmptyNode(g.children[0].level)),p&&(g.parent=p),V=n===u.rowHierarchy&&u.isSteppedLayout&&g.isSubtotal&&void 0!==g.levelSourceIndex?_.last(n.levels):n.levels[g.level],g.hierarchyLevel=V,V)if(g.levelValues){for(var P=[],a=[],e=0,t=g.levelValues;e<t.length;e++){var i=t[e],M=i.value;P.push(u.formatters[(o=V.sources[i.levelSourceIndex||0]).queryName].format(M,null));var w=u.tooltipFormatters[o.queryName];w&&a.push(w.format(M,null))}de.fF.assert(function(){return P.length===a.length||_.isEmpty(a)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),g.valueFormatted=P.join(u.compositeGroupSeparator),g.tooltipValueFormatted=_.isEmpty(a)?void 0:a.join(u.compositeGroupSeparator),g.queryName=1!==V.sources.length?void 0:V.sources[0].queryName}else{var o;g.valueFormatted=(o=V.sources[g.levelSourceIndex||0]).displayName,g.tooltipValueFormatted=o.displayName,g.queryName=o.queryName}g.index=h,_.isEmpty(g.children)?(!F||!g.isSubtotal||!O&&g.parent&&!g.parent.isSubtotal||u.valuesOnRow&&g.parent)&&(g.leafIndex=I.length,I.push(g)):(F&&(g.leafIndex=I.length,I.push(g)),u.updateRecursive(n,g.children,g,I,F,b,O,k),F&&(de.fF.assertAnyValue(_.every(g.children,function(T){return _.isEqual(T.hierarchyLevel,g.children[0].hierarchyLevel)}),"Children may come from different levels"),(!u.hasMultipleValueSources()||_.some(g.children,function(T){return _.some(T.hierarchyLevel.sources,function(j){return!j.isMeasure})}))&&(g.hasSubtotalStyle=!0))),g.position=k(g,s)},u=this,c=0,d=s.length;c<d;c++)R(c)},H.prototype.updateStaticColumnHeaders=function(n){var s=n.leafNodes;if(s&&s.length>0){if(!s[0].identity&&this.valuesOnRow&&1===s.length)return;for(var p=0,I=s.length;p<I;p++){var F=s[p];if(!F.identity&&_.isEmpty(F.levelValues)){var O=n.levels[F.level].sources[F.levelSourceIndex?F.levelSourceIndex:0];O&&(F.valueFormatted=O.displayName)}}}},H.prototype.getMatrixHierarchy=function(n){var s=this.rowHierarchy.root.children;if(s&&n===s)return this.rowHierarchy;var p=this.columnHierarchy.root.children;return p&&n===p?this.columnHierarchy:null},H.prototype.calculateRowHeaderPosition=function(n,s){var p=new Y.ri;p.row.index=this.getRowLeafIndex(n),p.row.indexInSiblings=this.getIndex(n),p.row.isFirst=this.areAllParentsFirst(n,s),p.row.isLast=this.areAllParentsLast(n,s);var I=this.getLevel(n);return p.column.index=p.column.indexInSiblings=I,p.column.isFirst=0===I,p.column.isLast=this.isLeaf(n),p},H.prototype.calculateColumnHeaderPosition=function(n,s){var p=new Y.ri,I=this.getLevel(n);p.row.index=p.row.indexInSiblings=I,p.row.isFirst=0===I,p.row.isLast=this.isLeaf(n);var F=this.getIndex(n);return p.column.index=p.column.indexInSiblings=F,p.column.isFirst=this.areAllParentsFirst(n,s),p.column.isLast=this.areAllParentsLast(n,s),p},H.prototype.getRowHeaderMetadataColumn=function(n){var s=this.getRowHeaderMetadataColumns(n);return s&&s[0]},H.prototype.getRowHeaderMetadataColumns=function(n){if(n&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,n.level)},H.prototype.getColumnHeaderMetadataColumn=function(n){var s=this.getColumnHeaderMetadataColumns(n);return s&&s[0]},H.prototype.getColumnHeaderMetadataColumns=function(n){if(n&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,n.level)},H.prototype.getHierarchyMetadataColumns=function(n,s){if(n&&n.levels&&!(n.levels.length<s)){var p=n.levels[s];if(p&&p.sources&&0!==p.sources.length)return p.sources}},H.isNodeGrandTotal=function(n){if(n){for(var s=n;s.parent;)s=s.parent;return s.isSubtotal}return!1},H}()},32771:function(Fe,Me,B){B.d(Me,{JF:function(){return X},az:function(){return W}});var Q=B(81337),de=B(90120),se=B(34021),te=B(44783),Y=B(62458),D=B(38078);function W(K,m,H){if(Y.fF.assertValue(K,"getColumnDataBarsSettings: column"),m){var s,p,n=K.aggregates;if(null!=m.minValue?s=m.minValue:n&&null!=n.min&&_.isNumber(n.min)&&(s=n.min),null!=m.maxValue?p=m.maxValue:n&&null!=n.max&&_.isNumber(n.max)&&(p=n.max),!(null==s||null==p||s>p)){var I=null!=m.minValue,F=null!=m.maxValue;return s>=0&&p>0&&!I&&(s=0),s<0&&p<0&&!F&&(p=0),{min:s,max:p,range:p-s,zeroPosition:0===s&&0===p?.5:s>=0&&p>0&&I?0:s<0&&p<=0&&F?1:(0-s)/(p-s),positiveColor:(0,D.HZ)(de.v.getFillColor(H,m.positiveColor,te.U)),negativeColor:(0,D.HZ)(de.v.getFillColor(H,m.negativeColor,te.U)),axisColor:(0,D.HZ)(de.v.getFillColor(H,m.axisColor,te.fA)),hideText:!!m.hideText,reverseDirection:!!m.reverseDirection,strokeSettings:(0,Q.pi)((0,Q.pi)({},(0,se.kG)(H)),{width:1}),totalMatching:m.totalMatchingOption}}}}function X(K,m,H,n,s){var p,I=H.getExtraLeft()+"px",F=H.getExtraRight()+"px",b=H.getExtraTop()+"px",O=H.getExtraBottom()+"px",k={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:I,right:F,top:b,bottom:O}},V=[],R=function(K,m,H){if(null!=m&&_.isNumber(m)&&0!==m){var F,b,O,n=K.min,s=K.max,p=K.range,I=K.zeroPosition;if(m>=s){if(1===I)return;m=s}else if(m<=n){if(0===I)return;m=n}if(0===p?(F=b=I,O=K.positiveColor):m>0?(F=I,b=(m-n)/p,O=K.positiveColor):(F=(m-n)/p,b=I,O=K.negativeColor),K.reverseDirection){var k=F;F=1-b,b=1-k}var V=100*(b-F);H?.push((m>=0?"":"-")+Math.round(V)+"%");var R={left:100*F+"%",width:V+"%",background:O},u=K.strokeSettings;return u&&u.visible&&(R.outline="".concat(u.width,"px solid ").concat(u.color),R["outline-offset"]="-".concat(u.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:R}}}(m,n,V);R&&k.children.push(R);var d,u=m.zeroPosition;m.reverseDirection&&(u=1-u),k.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+b,bottom:"-"+O,left:100*u+"%","border-left-color":m.axisColor}}),s&&(d={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:s.getLocalizedString("Data_Bar_Percentage",null!==(p=V[0])&&void 0!==p?p:"0%")});var l=K.styleProperties;return l.position="absolute",l.left=I,l.right=F,l.top=b,l.bottom=O,d?{children:[k,K,d],classNames:[],attributes:{},styleProperties:{}}:{children:[k,K],classNames:[],attributes:{},styleProperties:{}}}},21242:function(Fe,Me,B){B.d(Me,{Ak:function(){return s},IP:function(){return F},JW:function(){return X},MX:function(){return H},d4:function(){return te},kH:function(){return Y},mM:function(){return n},p_:function(){return I},re:function(){return z}});var Q=B(81337),de=B(13375);function se(b,O,k,V){var R,u,c,d,l,h;void 0===k&&(k=!0);var y=b.columnItem,g=b.rowItem,P=0,a={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},e=g&&!_.isEmpty(g.values),t=g&&m(g,O,k,V);t&&((R=a.displayNameParts).push.apply(R,t.displayNameParts||[]),(u=a.valueParts).push.apply(u,t.valueParts||[]),(c=a.headerParts).push.apply(c,_.map(t.valueParts,function(){return!0})),a.concatenatedParts.push(_.map(t.displayNameParts,function(){return P++})));var i=y&&m(y,O,k,V);if(i&&((d=a.displayNameParts).push.apply(d,i.displayNameParts||[]),(l=a.valueParts).push.apply(l,i.valueParts||[]),(h=a.headerParts).push.apply(h,_.map(i.valueParts,function(){return!0})),a.concatenatedParts.push(_.map(i.displayNameParts,function(){return P++}))),e)if(a.displayNameParts.push(b.columnMetadata.displayName),a.concatenatedParts.push([P++]),a.headerParts.push(!1),b.isKpi){var o={metadata:b.columnMetadata.kpi,value:b.tooltipContent};(a.otherType[a.displayNameParts.length-1]={}).kpiValue=o,a.valueParts.push(b.tooltipContent)}else _.isEmpty(b.tooltipContent)||a.valueParts.push(b.tooltipContent);return a}function te(b,O,k){if(b)return k?[{displayName:"",value:b.tooltipContent}]:function(b){for(var O=[],k=function(d){var l=_.filter(b.displayNameParts,function(P,a){return-1!==d.indexOf(a)}),h=_.filter(b.valueParts,function(P,a){return-1!==d.indexOf(a)});if((l.length>0||h.length>0)&&(O.push({displayName:l.join(" "),value:h.join(" ")}),b.otherType)){var y=_.first(d);if(_.has(b.otherType,String(y))){var g=O.length-1;delete O[g].value,O[g]=(0,Q.pi)((0,Q.pi)({},O[g]),b.otherType[y])}}},V=0,R=b.concatenatedParts;V<R.length;V++)k(R[V]);return O}(se(b,O))}function Y(b,O,k,V){for(var R=[],u=0,c=b;u<c.length;u++)R.push(se(c[u],V));var l=0,h=O.getHierarchyLeafCount()*k.getHierarchyLeafCount();return 0!==h&&(l=Math.round(b.length/h*100)),(0,Q.pi)({coveragePercentage:l},D(R))}function D(b){for(var O={headers:_.uniq(_.flatten(_.map(b,function(i){return i.displayNameParts}))),isHeader:{},values:[]},k=O.values,V=O.headers,R=O.isHeader,u={},c=0;c<V.length;c++)u[V[c]]=c;for(var d=0,l=b;d<l.length;d++){var h=l[d],y=_.fill(new Array(V.length),"");for(c=0;c<h.displayNameParts.length;c++){var a=u[h.displayNameParts[c]];y[a]=h.valueParts[c],h.headerParts&&(O.isHeader[a]=h.headerParts[c])}k.push(y)}if(!_.isEmpty(b)&&b[0].headerParts)for(var e=function(o){for(var f=k[o],M=[],w=o+1;w<k.length;w++)_.every(k[w],function(ce,Ce){return R[Ce]&&ce===f[Ce]||!R[Ce]&&(""===ce||""===f[Ce])})&&M.push(w);if(M.length>0)for(var L=_.reduce(f,function(ce,Ce,be){return""===Ce&&ce.push(be),ce},[]),re=0,A=M;re<A.length;re++){var ee=k[A[re]];for(w=0;w<L.length;w++){var ne=L[w],ae=ee[ne];""!==ae&&(f[ne]=ae,L.splice(w,1),w--)}}M.sort(function(ce,Ce){return Ce-ce});for(var le=0,ue=M;le<ue.length;le++)k.splice(ue[le],1)},t=0;t<k.length;t++)e(t);return O}function X(b,O){if(b)return O?[{displayName:"",value:b.displayName}]:[{displayName:b.displayName}]}function z(b,O,k,V,R,u){if(b){if(u)return[{displayName:"",value:b.isSubtotal||de.hc.isNodeGrandTotal(b)?V:b.tooltipValueFormatted}];if(de.hc.isNodeGrandTotal(b))return k(b)?[{displayName:b.tooltipValueFormatted}]:[{displayName:V}];var d=[],l=function(b,O){var k=H(b,O),V=k.displayNameParts,R=k.valueParts;if(V.length>0||R.length>0)return{displayName:V.join(" "),value:R.join(" ")}}(b,R);return l&&d.push(l),O(b)&&d.push({displayName:R,value:b.valueFormatted}),d}}function m(b,O,k,V){void 0===k&&(k=!0);var R=p(b),u=b.queryName,c=_.find(R,function(d){return d.queryName===u});return c&&c.isMeasure&&(b=b.parent),H(b,O,k,V)}function H(b,O,k,V){void 0===k&&(k=!0);for(var R=[],u=[];b;)if(k&&b.isSubtotal)b=b.parent;else{var c=p(b);if(!_.isEmpty(c)){for(var d=[],l=0,h=c;l<h.length;l++){var y=h[l];d.push(y.isMeasure?O:y.displayName)}R.push(d.join(" ")),_.every(c,function(g){return g.isMeasure})?u.push(c[0].displayName):u.push(b.isSubtotal?V:b.tooltipValueFormatted)}b=b.parent}return{displayNameParts:R=R.reverse(),valueParts:u=u.reverse()}}function n(b,O,k,V,R){var u=s(k,V,b,O),c=0,d=k.getHierarchyLeafCount()*V.getHierarchyLeafCount();0!==d&&(c=Math.round(u.length/d*100));for(var l=[],h=0,y=u;h<y.length;h++)l.push(se(y[h],R));return(0,Q.pi)({coveragePercentage:c},D(l))}function s(b,O,k,V){_.isEmpty(k)&&(k=b.getHierarchyItems()),_.isEmpty(V)&&(V=O.getHierarchyItems());var R=[];b.getLeaves(k,R),R=_.filter(R,function(a){return!a.isSubtotal});var u=[];O.getLeaves(V,u),u=_.filter(u,function(a){return!a.isSubtotal});for(var c=[],d=0,l=R;d<l.length;d++)for(var h=l[d],y=0,g=u;y<g.length;y++)c.push(b.getIntersection(h,g[y]));return c.filter(function(a){return!a.isSubtotal&&!a.isGrandTotal})}function p(b){var O=b.hierarchyLevel&&b.hierarchyLevel.sources;return _.isEmpty(O)?[]:_.every(O,function(k){return k.isMeasure})?[O[b.levelSourceIndex||0]]:O}function I(b){return{displayNameParts:[b.displayName],valueParts:[null]}}function F(b,O){for(var k=[],V=0;V<b.displayNameParts.length;V++){var R=b.displayNameParts[V],u=b.valueParts[V];null!=u&&(R+=": "+u),k.push(R)}if(!_.isEmpty(O))for(var c=0,d=O;c<d.length;c++)k.push(d[c]);return k.join(". ")}},29043:function(Fe,Me,B){B.d(Me,{MV:function(){return n},th:function(){return m},wJ:function(){return H}});var Q=B(53197),de=B(90120),se=B(51995),te=B(85308),Y=B(58520),D=B(45296),W=B(44783),X=B(62458),z=B(43286),K=52;function m(b,O){var t,k={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(b)){var V;try{V=JSON.parse(b)}catch{return}var R=+V.yl,u=+V.yh,d=+V.xl,l=+V.xh,h=null!=V.md?+V.md:void 0;_.size(V.p)>K&&O.setWarnings([new D.El]);for(var y=0,g=V.p;y<g.length;y++){var P=g[y];k.points.push({x:null!=P[0]?+P[0]:void 0,y:null!=P[1]?(t=+P[1],t*(u-R)/100+R):void 0})}return{points:_.filter(k.points,function(e){return _.isFinite(e.x)&&(null!=e.y||_.isFinite(e.y))}),lowX:d,highX:l,lowY:R,highY:u,minXDifference:h}}}function H(b,O,k){var V;X.fF.assertValue(b,"sparkline"),X.fF.assertValue(null===(V=O?.misc)||void 0===V?void 0:V.sparkline,"invalid type for sparkline"),X.fF.assertValue(k,"style");var R=O.misc.sparkline.groupingType;return{chartType:b.chartType,dataColor:k.isHighContrast?de.v.getThemeColor(k,W.fA):b.dataColor,strokeWidth:b.strokeWidth,marker:{show:!0,typeFlags:b.marker.typeFlags,color:k.isHighContrast?de.v.getThemeColor(k,W.fA):b.marker.color,size:b.marker.size,shape:b.marker.shape},isScalar:R&&!!(R.numeric||R.dateTime||R.temporal)}}function n(b,O,k,V,R,u,c,d){var l;if(null!=V){var a=u-k.getExtraLeft()-k.getExtraRight()-(d?d+5:0),e=R-k.getExtraTop()-k.getExtraBottom();a-O.strokeWidth>1&&e-O.strokeWidth>1&&(l=O.chartType===te.U.line?function(b,O,k,V){var o,u=b.dataColor,c=b.strokeWidth,d=b.marker,l=d.color,h=d.size,y=d.shape,g=d.typeFlags,P=b.isScalar,a=(0,z.Js)(g),e=0===a||1===a&&(0,z.yE)(g,Y.qC),t=Math.max(c,2)+(e?0:Math.ceil(h/2)),i=V.points;o=P?d3.scaleLinear().domain([V.lowX,V.highX]).range([t,O-t]):d3.scalePoint().domain(_.map(_.range(V.lowX,V.highX+1),function(ne){return ne.toString()})).range([t,O-t]);var L,re,f=d3.scaleLinear().domain(d3.extent(i,function(ne){return ne.y})).range([k-t,t]),M=d3.line().x(function(ne){return o(ne.x)}).y(function(ne){return f(ne.y)}),w=_.filter(i,function(ne){return null!=ne.y}),j={tagName:"path",attributes:{d:M(w)},classNames:[],styleProperties:{stroke:u,"stroke-width":c.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},A=function(b,O){var k=O.marker.typeFlags,V=d3.extent(b,function(c){return c.y}),R=V[0],u=V[1];return _.filter(b,function(c,d){var l,h;return null!=c.y&&(!!(0,z.yE)(k,Y.$6)||(0,z.yE)(k,Y.Ps)&&0===d||(0,z.yE)(k,Y.Z$)&&d===b.length-1||(0,z.yE)(k,Y.pd)&&c.y<0||(0,z.yE)(k,Y.Zc)&&c.y===u||(0,z.yE)(k,Y.O3)&&c.y===R||(0,z.yE)(k,Y.qC)&&null==(null===(l=b[d-1])||void 0===l?void 0:l.y)&&null==(null===(h=b[d+1])||void 0===h?void 0:h.y))})}(w,b);if(!_.isEmpty(A)){var ie="markerKey".concat(h).concat(l).concat(y);L={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:ie,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:h.toString(),markerWidth:h.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,se.F)(y).toString(),"stroke-opacity":"1",stroke:l,fill:l},attributes:{d:(0,se.Ar)(y)}}]}]},re={tagName:"path",attributes:{d:M(A)},classNames:[],styleProperties:{stroke:u,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(ie,")"),"marker-mid":"url(#".concat(ie,")"),"marker-end":"url(#".concat(ie,")")}}}return{tagName:"svg",children:re?[L,j,re]:[j],classNames:[],styleProperties:{},attributes:{height:k+"px",width:O+"px"}}}(O,a,e,V):function(b,O,k,V){var y,R=b.dataColor,u=b.isScalar,c=V.points,d=[V.lowX,V.highX],l=function(b,O,k,V,R){if(_.isEmpty(b))return 0;var d,l=V[V.length-1]-V[0];return R&&V&&V.length>1?(0!==l?(X.fF.assert(function(){return null!=O},"minXDifference cannot be null for scalar plotted as columns"),d=k*(O/(l+O))):d=k,d=Math.max(d,2)):d=k/(l+1),.8*d}(c,V.minXDifference,O,d,u),h=l/2;y=u?d3.scaleLinear().domain(d).range([h,O-h]):d3.scalePoint().domain(_.map(_.range(V.lowX,V.highX+1),function(t){return t.toString()})).range([h,O-h]);var g=d3.extent(c,function(t){return t.y});g[0]=Math.min(0,g[0]),g[1]=Math.max(0,g[1]);var P=d3.scaleLinear().domain(g).range([k,0]),a=P(0),e=l.toString();return{tagName:"svg",children:_.chain(c).filter(function(t){return null!=t.y}).map(function(t){var i=(y(t.x)-h).toString(),o=(a+(0,Q.sc)(P,Math.max(0,t.y),0)).toString(),f=Math.abs((0,Q.sc)(P,0,t.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:R},attributes:{x:i,y:o,width:e,height:f}}}).value(),classNames:[],styleProperties:{},attributes:{height:k+"px",width:O+"px"}}}(O,a,e,V))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(c&&"Before"!==c.layout?[l,b]:[b,l],function(o){return!!o})}}},74764:function(Fe,Me,B){B.r(Me),B.d(Me,{PivotTable:function(){return Le}});var Q=B(81337),de=B(80065),se=B(82755),te=B(46135),Y=B(79465),D=B(57419),W=B(59107),X=B(15366),z=B(32379),K=B(31198),m=B(40739),H=B(62458),n=B(52287),s=B(21242),p=B(13375),I=B(85196),F=B(26543),b=function(){function U(r,v,C,S){this.tooltipService=r,this.selectionManager=v,this.valueLabel=C,this.totalLabel=S,this.tooltipsEnabled=!0}return U.prototype.getHandlerTop=function(){var r=this,v=function(E){return E.isSubtotal&&!r.rowHierarchyNavigator.valuesOnRowApplied()&&r.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(E)},C=function(E){return r.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(E)},S=I.r.columns;return{addTooltip:null,removeTooltip:function(E,N){return r.removeTooltip(N)},isTooltipEnabled:null,setTooltipDelegate:function(E,N,G,J,Z){return r.setTooltipDelegateTop(E,N,G,v,C,S,J,Z)},isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},U.prototype.getHandlerMidOrBot=function(){var r=this,v=function(E){return E.isSubtotal&&r.rowHierarchyNavigator.valuesOnRowApplied()&&r.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(E)},C=function(E){return r.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(E)},S=I.r.rows;return{addTooltip:null,removeTooltip:function(E,N){return r.removeTooltip(N)},isTooltipEnabled:null,setTooltipDelegate:function(E,N,G,J,Z){return r.setTooltipDelegateMidOrBot(E,N,G,v,C,S,J,Z)},isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},U.prototype.getRowHeaderHandler=function(){var r=this;return this.getHeaderHandler(function(v){return v.isSubtotal&&r.rowHierarchyNavigator.valuesOnRowApplied()&&r.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(v)},function(v){return r.rowHierarchyNavigator.isRowHeaderMultiValueSubtotal(v)},I.r.rows)},U.prototype.getColumnHeaderHandler=function(){var r=this;return this.getHeaderHandler(function(v){return v.isSubtotal&&!r.rowHierarchyNavigator.valuesOnRowApplied()&&r.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(v)},function(v){return r.columnHierarchyNavigator.isColumnHeaderMultiValueSubtotal(v)},I.r.columns)},U.prototype.getBodyHandler=function(){var r=this;return{addTooltip:function(C,S){return r.addBodyTooltip(C,S)},removeTooltip:function(C,S){return r.removeTooltip(S)},isTooltipEnabled:function(C){return r.tooltipsEnabled},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},U.prototype.onDataViewChanged=function(r,v){this.rowHierarchyNavigator=r,this.columnHierarchyNavigator=v},U.prototype.addBodyTooltip=function(r,v){var C=this,S=d3.select(v);this.tooltipService.addTooltip(S,function(){return(0,s.d4)(r,C.valueLabel,!C.tooltipsEnabled)},function(){var x=C.getItemSelectionId(r,I.r.values,void 0);return x&&[x]})},U.prototype.getCornerHandler=function(){var r=this;return{addTooltip:function(C,S){return r.addCornerTooltip(C,S)},removeTooltip:function(C,S){return r.removeTooltip(S)},isTooltipEnabled:function(C){return r.tooltipsEnabled&&!_.isEmpty(C.displayName)},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},U.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},U.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},U.prototype.setTooltipsEnabled=function(r){this.tooltipsEnabled=r},U.prototype.addHeaderTooltip=function(r,v,C,S,x){var E,G,J,N=this,Z=d3.select(v),q=null===(J=(G=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===J?void 0:J.call(G),oe=((E={})[0]=!q,E);this.tooltipService.addTooltip(Z,function(){return(0,s.re)(r,C,S,N.totalLabel,N.valueLabel)},function(){var he=N.getItemSelectionId(r,x,oe);return he&&[he]})},U.prototype.addCornerTooltip=function(r,v){var C=this,S=d3.select(v);this.tooltipService.addTooltip(S,function(){return(0,s.JW)(r)},function(){var x=C.getItemSelectionId(r,void 0,void 0);return x&&[x]})},U.prototype.getHeaderHandler=function(r,v,C){var S=this;return{addTooltip:function(E,N){return S.addHeaderTooltip(E,N,r,v,C)},removeTooltip:function(E,N){return S.removeTooltip(N)},isTooltipEnabled:function(E){return S.tooltipsEnabled&&void 0!==E.valueFormatted},setTooltipDelegate:null,isTooltipEnabledGeneric:function(){return S.tooltipsEnabled}}},U.prototype.removeTooltip=function(r){var v=d3.select(r);this.tooltipService.removeTooltips(v)},U.prototype.getItemSelectionId=function(r,v,C){if(r){var S=this.selectionManager.createSelectorsByColumn(r),x=S&&F.l0.fromSelectorsByColumnAndRoles(S,v);return x&&C&&(x.exclude=(0,Q.pi)((0,Q.pi)({},x.exclude),C??{})),x}},U.prototype.setTooltipDelegateTop=function(r,v,C,S,x,E,N,G){var J,q,oe,Z=this,he=d3.select(v),ye=null===(oe=(q=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===oe?void 0:oe.call(q),Re=((J={})[0]=!ye,J);this.tooltipService.addTooltip(he,function(fe){return!Z.tooltipsEnabled&&G(fe)?null:C(fe.context)===Y.aP.Prefix?(0,s.JW)(r(fe),!Z.tooltipsEnabled):(0,s.re)(r(fe),S,x,Z.totalLabel,Z.valueLabel,!Z.tooltipsEnabled)},function(fe){return Z.tooltipsEnabled?C(fe.context)===Y.aP.Prefix?(we=Z.getItemSelectionId(r(fe),void 0,void 0))&&[we]:(we=Z.getItemSelectionId(r(fe),E,Re))&&[we]:null;var we},!0,!0,N)},U.prototype.setTooltipDelegateMidOrBot=function(r,v,C,S,x,E,N,G){var J,q,oe,Z=this,he=d3.select(v),ye=null===(oe=(q=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===oe?void 0:oe.call(q),Re=((J={})[0]=!ye,J);this.tooltipService.addTooltip(he,function(fe){return!Z.tooltipsEnabled&&G(fe)?null:C(fe.context)===Y.aP.Prefix?(0,s.re)(r(fe),S,x,Z.totalLabel,Z.valueLabel,!Z.tooltipsEnabled):(0,s.d4)(r(fe),Z.valueLabel,!Z.tooltipsEnabled)},function(fe){return Z.tooltipsEnabled?C(fe.context)===Y.aP.Prefix?(we=Z.getItemSelectionId(r(fe),E,Re))&&[we]:(we=Z.getItemSelectionId(r(fe),I.r.values,void 0))&&[we]:null;var we},!0,!0,N)},U}(),O=B(28579),k=B(54522),V=B(44977),R=B(32105),u=B(55007),c=B(40550),d=B(19650),l=B(64067),h=B(79154),y=B(48066),g=B(38078),P=B(58702),a=B(7911),e=B(93340),t=B(71090),i=B(93568),o=B(91468),f=B(32771),M=B(29043),w=B(76797),T=B(59784),j=B(66842),L=B(67016),re=function(){function U(r,v,C,S,x,E){this.selectionManager=v,this.sortingManager=C,this.hostServices=S,this.isA11yMatrix=E,this.specificColumnHeaderFontInfo={},this.binderOptions=r,this.measureElement=(0,o.qk)(x),this.legacyTooltipsEnabled=!0}return U.prototype.setFormatMode=function(r){this.formatMode=r},U.prototype.setRowNavigator=function(r){this.rowNavigator=r},U.prototype.setColumnNavigator=function(r){this.columnNavigator=r},U.prototype.getRowHeaderBinding=function(r,v,C,S,x,E,N,G,J){var Z=this;this.binderOptions.onBindRowHeader&&!v&&this.binderOptions.onBindRowHeader(r);var ye,Re,q=r.hierarchyLevel&&r.hierarchyLevel.sources,oe=q&&q.length>1,he=(0,g.HZ)(this.getRowHeaderLabel(r));if(this.formattingProperties.rowHeaders.wordWrap&&(he=(0,o.rP)(he)),_.isEmpty(he)&&(he=t.jv),!oe){var fe=this.rowNavigator.getRowHeaderMetadataColumn(r),we=(0,e.MN)(fe,he);if(we!==y.av.NONE){var xe=(0,g.HZ)(r.valueFormatted);Re=(0,o.RP)(this.formattingProperties.rowHeaders.urlIcon,we),ye=(0,o.RD)(he,xe,Re,function(Ge,je){return Z.binderOptions.onHyperlinkClicked(Ge,je)})}else if((0,e.Or)(r,fe)){var Te=u.FX.PropAltTextValue.getValue(r.objects),Ie=this.formattingProperties.grid;ye=(0,o.D2)(he,Ie.imageHeight,Ie.imageWidth,Te)}}ye=ye?{children:[ye],classNames:[],styleProperties:{},attributes:{}}:{content:he,classNames:[],styleProperties:{},attributes:{}};var ve,Pe,pe=this.getExpandCollapseButtonBinding(r,J),Ne=this.formattingProperties.rowHeaders.steppedLayout;if(!v&&this.selectionManager.isRowHeaderIndicatorOn(r,Ne)){var Ve=this.getBorderInfo(r.position.row.isFirst,r.position.row.isLast,r.position.column.isFirst,r.position.column.isLast,!0,Y.p0.MatrixRowHeader),ke=E&&this.selectionManager.isRowHeaderIndicatorOn(E,Ne);Pe={attributes:{},classNames:[],styleProperties:{width:"100%",top:Ve.weightTop+"px",bottom:ke?"0":Ve.weightBottom+"px",left:Ve.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},this.selectionManager.getIndicatorStyle()===w.D.RowHeader?Pe.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):Pe.children[0].attributes["aria-hidden"]="true"}pe||Pe?(ve={attributes:{},classNames:[],styleProperties:{},children:[ye]},pe&&(ye.classNames.push("expandableContent"),ve.classNames.push("expandableCell"),ve.children.unshift(pe)),Pe&&ve.children.push(Pe)):ve=ye;var _e,De=!_.isEmpty(he?.trim());return G&&((_e=new e.ri).row=G.position.row,_e.column=r.position.column),_.assign(ve.styleProperties,this.getRowHeaderStyleAttributes(r,v,De,N,G,_e)),this.addRowHeaderClasses(r,!!Re,ye.classNames,ve.classNames),this.isA11yMatrix&&(ve.attributes||(ve.attributes={}),ve.attributes.role="rowheader"),C&&(null!=r.children?(ve.classNames.push(n.cy),ve.attributes[n.Ez]="".concat("rowHeaders"),ve.attributes[n.QZ]="".concat(1),ve.attributes[n.CK]="Visual_Tablix_RowHeaders"):r.isSubtotal&&(r.position.row.isFirst?(ve.classNames.push(n.cy),ve.attributes[n.Ez]="".concat("total-row"),ve.attributes[n.QZ]="".concat(1),ve.attributes[n.CK]="Visual_Tablix_Matrix_Row_TotalGrand"):(ve.classNames.push(n.cy),ve.attributes[n.Ez]="".concat("subtotal-row-labels"),ve.attributes[n.QZ]="".concat(1),ve.attributes[n.CK]="Visual_Subtotal_Label",ve.attributes[n.kv]=JSON.stringify({reference:L.t.subTotals.rowSubtotalsLabel,style:3}).replace(/\"/g,"&quot;")))),ve},U.prototype.getExpandCollapseButtonBinding=function(r,v){var C=this,S=this.getRowsExpandCollapseButtonSize(r);if(0!==S){var x,E,N=["expandCollapseButton"];if(void 0===r.isCollapsed||v)x="";else{var G=r.isCollapsed?"pbi-glyph-explore-content-single":"pbi-glyph-collapse-content-single",J=this.hostServices.getLocalizedString(r.isCollapsed?"FieldListProperty_Collapsed":"FieldListProperty_Expanded");x='<i role="button" aria-label="'.concat(J,'" class="glyphicon ').concat(G,'"></i>'),this.isExpandCollapseEnabled?(N.push("clickable"),E=function(q){C.binderOptions.onRowHeaderExpansionChange(r,!r.isCollapsed),q.stopPropagation()}):N.push("disabled")}return{content:x,classNames:N,styleProperties:{width:S+t.wH,height:S+t.wH,color:this.formattingProperties.rowHeaders.expandCollapseButtonsColor,"font-size":this.expandCollapseButtonFontInfo.fontProperties.size.px+t.wH},attributes:{},clickHandler:E}}},U.prototype.getRowsExpandCollapseButtonSize=function(r){return this.formattingProperties.rowHeaders.showExpandCollapseButtons&&r.hierarchyLevel&&(r.hierarchyLevel.canBeExpanded||r.level&&this.formattingProperties.rowHeaders.steppedLayout)?this.expandCollapseButtonFontInfo.measuredFontHeight:0},U.prototype.getColumnHeaderBinding=function(r,v,C,S,x,E){var N=(0,g.HZ)(this.getColumnHeaderLabel(r));this.formattingProperties.columnHeaders.wordWrap&&(N=(0,o.rP)(N)),_.isEmpty(N)&&(N=t.jv);var G=!_.isEmpty(N?.trim()),J=this.getColumnHeaderStyle(r,this.getColumnHeaderFontInfo(r),v,G),Z=J.getExtraBottom();r.position.row.isLast&&(J.paddings.bottom+=(0,o.tO)(this.glyphFontInfo.measuredFontHeight));var he,q=this.columnNavigator.getColumnHeaderMetadataColumn(r),oe=(0,e.MN)(q,N),Re={tagName:"div",content:N,attributes:{},classNames:[this.formattingProperties.columnHeaders.wordWrap?o.n2:o.wV],styleProperties:{}};if(oe!==y.av.NONE){var fe=(0,g.HZ)(r.valueFormatted);he=(0,o.RP)(this.formattingProperties.columnHeaders.urlIcon,oe),Re=(0,o.RD)(Re,fe,he,this.binderOptions.onHyperlinkClicked)}else if((0,e.Or)(r,q)){var we=u.FX.PropAltTextValue.getValue(r.objects),xe=this.formattingProperties.grid;Re=(0,o.D2)(N,xe.imageHeight,xe.imageWidth,we)}var Te=this.getColumnHeaderClasses(r,!!he),Ie={};S&&(Te.push(n.cy),Ie[n.QZ]="".concat(1),Ie[n.Ez]="".concat("columnHeaders"),Ie[n.CK]="Visual_Tablix_ColumnHeaders");var ve={tagName:"div",children:[Re],classNames:Te,styleProperties:this.getColumnHeaderStyleAttributes(r,J,E),attributes:Ie};if(r.position.row.isLast){var pe=this.binderOptions.sortingEnabled&&this.sortingManager.isColumnHeaderSortable(r),Pe=this.sortingManager.getColumnHeaderSortDirection(r),Ne=(0,o.Km)(Pe,this.binderOptions.sortIconEnabled,pe,T.S.getNextSortDirection(Pe,q),Z,this.glyphFontInfo.textProperties.fontSize,this.hostServices);ve.children.push(Ne),1===Pe?ve.attributes["aria-sort"]="ascending":2===Pe&&(ve.attributes["aria-sort"]="descending")}if(!v&&this.selectionManager.isColumnHeaderIndicatorOn(r)){var Ve=this.getBorderInfo(r.position.row.isFirst,r.position.row.isLast,!1,r.position.column.isLast,!0,Y.p0.Header),ke=x&&this.selectionManager.isColumnHeaderIndicatorOn(x),De={attributes:{},classNames:[],styleProperties:{height:"5px",left:Ve.weightLeft+"px",right:ke?"0":Ve.weightRight+"px",bottom:Ve.weightBottom+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"0",y1:"2",x2:"100%",y2:"2",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"0",y1:"4",x2:"100%",y2:"4",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}}]}]};this.selectionManager.getIndicatorStyle()===w.D.ColumnHeader?De.children[0].attributes["aria-label"]=this.hostServices.getLocalizedString("Visual_DataPoint_Selected"):De.children[0].attributes["aria-hidden"]="true",ve.children.push(De)}return ve},U.prototype.getBodyCellBinding=function(r,v,C,S,x,E,N){var J,G=(0,g.HZ)(this.getBodyCellContent(r)),Z=!_.isEmpty(G?.trim()),q=this.getBodyCellStyle(r,this.getBodyCellFontInfo(r),v,Z);this.formattingProperties.values.underline&&Z&&(q.textDecoration=h.f0);var xe,oe=r.columnMetadata,he=oe&&this.columnsDataBarsSettings[oe.queryName],ye=this.shouldApplyDataBars(he,r),Re=oe&&this.formattingProperties.columnFormatting[oe.queryName],fe=(0,P.TS)(Re&&Re.icon,r.icon),we=r.hyperlink;if(fe&&"IconOnly"===fe.layout)G="";else if(_.isEmpty(G)&&(G=t.jv),r.isKpi)G=(0,o.kJ)(r.columnMetadata.kpi,r.textContent);else if(ye&&he.hideText)G=v?t.jv:"";else{this.formattingProperties.values.wordWrap&&(G=(0,o.rP)(G));var Te=(0,e.MN)(r.columnMetadata,G);if(Te!==y.av.NONE)J=(0,o.RP)(this.formattingProperties.values.urlIcon,Te),xe=(0,o.RD)(G,(0,g.HZ)(r.textContent),J,this.binderOptions.onHyperlinkClicked),we=void 0;else if(this.isImage(r)){var Ie=g.b$.encodeUriForImageDataSvg(r.textContent),ve=this.formattingProperties.grid;xe=(0,o.D2)(Ie,ve.imageHeight,ve.imageWidth,(0,g.HZ)(r.altText))}else this.isSparkline(r)&&(G=v?t.jv:"")}this.binderOptions.hyperlinksEnabled&&(xe||""!==G&&G!==t.jv)&&we&&(0,y.MN)(we)!==y.av.NONE&&(xe=(0,o.RD)(xe||G,(0,g.HZ)(we),null,this.binderOptions.onHyperlinkClicked,!0,!0));var Pe,We,pe={tagName:"div",classNames:[],styleProperties:{},attributes:{}};if(xe?pe.children=[xe]:pe.content=G,xe=pe,fe&&(Pe=this.getBodyCellFontInfo(r).measuredFontHeight,pe=(0,o.Ps)(fe,Pe,xe,this.hostServices)),ye&&!v&&(pe=(0,f.JF)(pe,he,q,r.dataPoint,this.hostServices)),!v&&this.isSparkline(r)&&(H.fF.assert(function(){return null!=C&&null!=S},"height and width should be defined for sparkline rendering"),pe=(0,M.MV)(pe,this.sparklineSettings[r.columnMetadata.queryName],q,r.dataPoint,C,S,fe,Pe)),this.isA11yMatrix&&(r.fontColor||r.backColor)){var Ee=this.hostServices.getLocalizedString(t.Sl);_.isEmpty(pe.children)?pe={attributes:{},classNames:[],styleProperties:{},children:[pe,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Ee}]}:pe.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Ee})}if(this.isA11yMatrix&&!v&&this.selectionManager.isBodyCellIndicatorOn(r)){var Be=this.formattingProperties.rowHeaders.steppedLayout,De=this.getBorderInfo(r.position.row.isFirst,r.position.row.isLast&&(!Be||Be&&!this.formattingProperties.general.rowSubtotals)||Be&&r.isRowGrandTotal,r.position.column.isFirst,r.position.column.isLast,!0,Y.p0.Body),_e=N&&this.selectionManager.isBodyCellIndicatorOn(N);We={attributes:{},classNames:[],styleProperties:{width:"100%",top:De.weightTop+"px",bottom:_e?"0":De.weightBottom+"px",left:De.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{"aria-label":this.hostServices.getLocalizedString("Visual_DataPoint_Selected"),height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]},pe.content?pe={attributes:{},classNames:[],styleProperties:{},children:[pe,We]}:(pe.children||(pe.children=[]),pe.children.push(We))}return E&&(r.isGrandTotal?(pe.classNames.push(n.cy),pe.attributes[n.QZ]="".concat(1),r.isColumnGrandTotal?(pe.attributes[n.Ez]="".concat("total-column"),pe.attributes[n.CK]="Visual_TotalColumn"):(pe.attributes[n.Ez]="".concat("total-row"),pe.attributes[n.CK]="Visual_TotalRow")):(r.isRowSubTotal||r.isColumnSubTotal)&&(pe.classNames.push(n.cy),pe.attributes[n.QZ]="".concat(1),r.isColumnSubTotal?(pe.attributes[n.Ez]="".concat("subtotal-column"),pe.attributes[n.CK]="Visual_SubtotalColumn"):(pe.classNames.push(n.cy),pe.attributes[n.Ez]="".concat("subtotal-row"),pe.attributes[n.CK]="Visual_SubtotalRow"))),this.addBodyCellClasses(r,!!J,xe.classNames,pe.classNames),this.addBodyCellStyleAttributes(r,q,xe.styleProperties,pe.styleProperties,S),pe},U.prototype.getCornerCellBinding=function(r,v,C,S,x){var E=(0,g.HZ)(this.getCornerCellLabel(r)),N={},G=this.getCornerCellClasses(r);S&&(G.push(n.cy),N[n.Ez]="".concat("columnHeaders"),N[n.QZ]="".concat(1),N[n.CK]="Visual_Tablix_ColumnHeaders"),N.columnLevel=this.rowNavigator.getColumnLevel(r).toString(),N.rowLevel=this.rowNavigator.getRowLevel(r).toString(),this.formattingProperties.columnHeaders.wordWrap&&(E=(0,o.rP)(E)),_.isEmpty(E)&&(E=t.jv);var J=!_.isEmpty(E?.trim()),Z=this.getCornerCellStyle(r,this.getCornerCellFontInfo(),v,J);if(r.position.row.isLast){var q=this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(r),oe=this.sortingManager.getCornerSortDirection(r),ye=(0,o.Km)(oe,this.binderOptions.sortIconEnabled,q,oe??1,Z.getExtraBottom(),this.glyphFontInfo.textProperties.fontSize,this.hostServices);E+=a.bG.build(ye),Z.paddings.bottom+=(0,o.tO)(this.glyphFontInfo.measuredFontHeight),1===oe?N["aria-sort"]="ascending":2===oe&&(N["aria-sort"]="descending")}return{content:E,classNames:G,styleProperties:Z.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,x),attributes:N}},U.prototype.getApproximateRowHeaderWidth=function(r){var v,C,S,x,Z,E=this.rowNavigator.getRowHeaderMetadataColumn(r),N=this.getRowHeaderLabel(r),G=(0,e.MN)(E,N),J=this.rowHeaderFontInfo.fontProperties.size.px;if(G!==y.av.NONE&&(0,o.RP)(this.formattingProperties.rowHeaders.urlIcon,G))Z=J;else if((0,e.Or)(r,E))Z=this.formattingProperties.grid.imageWidth;else{var q=this.getRowHeaderFontInfo(r),oe=this.getRowHeaderStyle(r,q,!0,!0,void 0,void 0);Z=(this.formattingProperties.rowHeaders.wordWrap?(0,o.JT)(N,q.textProperties):(0,o.X1)(N,q.textProperties))+(null!==(C=null===(v=oe.borders.left)||void 0===v?void 0:v.weight)&&void 0!==C?C:0)+(null!==(x=null===(S=oe.borders.right)||void 0===S?void 0:S.weight)&&void 0!==x?x:0)}var fe=this.getRowsExpandCollapseButtonSize(r);return fe>0&&(Z+=fe+o.s$),Z},U.prototype.getApproximateColumnHeaderWidth=function(r){var v,C,S,x,E=this.columnNavigator.getColumnHeaderMetadataColumn(r),N=this.getColumnHeaderLabel(r),G=(0,e.MN)(E,N);if(G!==y.av.NONE&&(0,o.RP)(this.formattingProperties.columnHeaders.urlIcon,G))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(r,E))return this.formattingProperties.grid.imageWidth;var J=this.getColumnHeaderFontInfo(r),Z=this.getColumnHeaderStyle(r,J,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,o.JT)(N,J.textProperties):(0,o.X1)(N,J.textProperties))+(null!==(C=null===(v=Z.borders.left)||void 0===v?void 0:v.weight)&&void 0!==C?C:0)+(null!==(x=null===(S=Z.borders.right)||void 0===S?void 0:S.weight)&&void 0!==x?x:0)},U.prototype.getApproximateBodyCellWidth=function(r){var v,C,S,x,E=0;if(r.icon){if(E=this.getBodyCellFontInfo(r).measuredFontHeight,"IconOnly"===r.icon.layout)return E;E+=o.MO}if(r.isKpi)return E+this.valueFontInfo.fontProperties.size.px;var N=r.columnMetadata&&this.columnsDataBarsSettings[r.columnMetadata.queryName];if(this.shouldApplyDataBars(N,r)&&N.hideText)return E;var G=this.getBodyCellContent(r);if(this.isUrlIcon(r,G))return E+this.valueFontInfo.fontProperties.size.px;if(this.isImage(r))return E+this.formattingProperties.grid.imageWidth;if(this.isSparkline(r))return E;var J=this.getBodyCellFontInfo(r),Z=this.getBodyCellStyle(r,J,!0,!0);return E+(this.formattingProperties.values.wordWrap?(0,o.JT)(G,J.textProperties):(0,o.X1)(G,J.textProperties))+(null!==(C=null===(v=Z.borders.left)||void 0===v?void 0:v.weight)&&void 0!==C?C:0)+(null!==(x=null===(S=Z.borders.right)||void 0===S?void 0:S.weight)&&void 0!==x?x:0)},U.prototype.getApproximateCornerCellWidth=function(r){var v,C,S,x,E=this.getCornerCellFontInfo(),N=this.getCornerCellStyle(r,E,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,o.JT)(this.getCornerCellLabel(r),E.textProperties):(0,o.X1)(this.getCornerCellLabel(r),E.textProperties))+(null!==(C=null===(v=N.borders.left)||void 0===v?void 0:v.weight)&&void 0!==C?C:0)+(null!==(x=null===(S=N.borders.right)||void 0===S?void 0:S.weight)&&void 0!==x?x:0)},U.prototype.getApproximateRowHeaderHeight=function(r,v){var C,S,x,E,Z,N=this.rowNavigator.getRowHeaderMetadataColumn(r),G=this.getRowHeaderLabel(r),J=(0,e.MN)(N,G),q=this.getRowsExpandCollapseButtonSize(r);if(J!==y.av.NONE&&(0,o.RP)(this.formattingProperties.rowHeaders.urlIcon,J))Z=this.rowHeaderFontInfo.fontProperties.size.px;else if((0,e.Or)(r,N))Z=this.formattingProperties.grid.imageHeight;else{var oe,he=this.getRowHeaderFontInfo(r);v-=this.getRowsExpandCollapseButtonSize(r);var ye=this.getRowHeaderStyle(r,he,!0,!0,void 0,void 0);oe=this.formattingProperties.rowHeaders.wordWrap?(0,o.do)(G,(0,o.x9)(v,ye),he.textProperties).length:1;var Re=null!==(S=null===(C=ye.borders.top)||void 0===C?void 0:C.weight)&&void 0!==S?S:0,fe=null!==(E=null===(x=ye.borders.bottom)||void 0===x?void 0:x.weight)&&void 0!==E?E:0;Z=he.measuredFontHeight*oe+Re+fe}return void 0===r.isCollapsed?Z:Math.max(q,Z)},U.prototype.getApproximateColumnHeaderHeight=function(r,v){var C,S,x,E,N=this.columnNavigator.getColumnHeaderMetadataColumn(r),G=this.getColumnHeaderLabel(r),J=(0,e.MN)(N,G);if(J!==y.av.NONE&&(0,o.RP)(this.formattingProperties.columnHeaders.urlIcon,J))return this.columnHeaderFontInfo.fontProperties.size.px;if((0,e.Or)(r,N))return this.formattingProperties.grid.imageHeight;var Z,q=this.getColumnHeaderFontInfo(r),oe=this.getColumnHeaderStyle(r,q,!0,!0);Z=this.formattingProperties.columnHeaders.wordWrap?(0,o.do)(G,(0,o.x9)(v,oe),q.textProperties).length:1;var he=null!==(S=null===(C=oe.borders.top)||void 0===C?void 0:C.weight)&&void 0!==S?S:0,ye=null!==(E=null===(x=oe.borders.bottom)||void 0===x?void 0:x.weight)&&void 0!==E?E:0;return q.measuredFontHeight*Z+he+ye},U.prototype.getApproximateBodyCellHeight=function(r,v){var C,S,x,E,N=this.getBodyCellFontInfo(r);if(r.icon&&"IconOnly"===r.icon.layout)return N.measuredFontHeight;if(r.isKpi)return this.valueFontInfo.fontProperties.size.px;var G=this.getBodyCellContent(r);if(this.isUrlIcon(r,G))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(r))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(r))return N.measuredFontHeight;var J,Z=this.getBodyCellStyle(r,N,!0,!0);this.formattingProperties.values.wordWrap&&null!=v?(r.icon&&(v-=N.measuredFontHeight+o.MO),J=(0,o.do)(G,(0,o.x9)(v,Z),N.textProperties).length):J=1;var q=null!==(S=null===(C=Z.borders.top)||void 0===C?void 0:C.weight)&&void 0!==S?S:0,oe=null!==(E=null===(x=Z.borders.bottom)||void 0===x?void 0:x.weight)&&void 0!==E?E:0;return N.measuredFontHeight*J+q+oe},U.prototype.getApproximateCornerCellHeight=function(r,v){var C,S,x,E,N,G=this.getCornerCellFontInfo(),J=this.getCornerCellStyle(r,G,!0,!0);N=this.formattingProperties.columnHeaders.wordWrap?(0,o.do)(this.getCornerCellLabel(r),(0,o.x9)(v,J),G.textProperties).length:1;var Z=null!==(S=null===(C=J.borders.top)||void 0===C?void 0:C.weight)&&void 0!==S?S:0,q=null!==(E=null===(x=J.borders.bottom)||void 0===x?void 0:x.weight)&&void 0!==E?E:0;return G.measuredFontHeight*N+Z+q},U.prototype.blankRowsEnabled=function(){return this.formattingProperties.blankRows.showBlankRows},U.prototype.getSectionProperties=function(r){var v;switch(r){case Y.p0.Header:v=this.formattingProperties.columnHeaders;break;case Y.p0.Body:v=this.formattingProperties.values;break;case Y.p0.MatrixRowHeader:v=this.formattingProperties.rowHeaders;break;default:H.fF.assertNever(r)}return v},U.prototype.getBorderInfo=function(r,v,C,S,x,E){var N,G,J,Z,Re,fe,we,xe,Te,Ie,ve,pe,q=0,oe=0,he=0,ye=0,Pe=this.getSectionProperties(E),Ne=null!==(N=Pe.outlineWeight)&&void 0!==N?N:this.formattingProperties.grid.outlineWeight,Ee=null!==(G=Pe.outlineColor)&&void 0!==G?G:this.formattingProperties.grid.outlineColor,We=null===(J=this.formattingProperties.grid)||void 0===J?void 0:J.gridHorizontalColor,Be=null===(Z=this.formattingProperties.grid)||void 0===Z?void 0:Z.gridVerticalColor,ze=(0,l.ok)("#FFFFFF",.7,We),Ve=(0,l.ok)("#FFFFFF",.7,Be);return r&&(0,c.yo)(Pe.outline)&&(q=Ne,Re=e.Pb.Outline,Te=Ee),S&&(0,c.BK)(Pe.outline)?(oe=Ne,fe=e.Pb.Outline,Ie=Ee):!S&&this.formattingProperties.grid.gridVertical&&(oe=this.formattingProperties.grid.gridVerticalWeight,fe=e.Pb.Gridline,Ie=this.selectionManager.isSelectionEmpty()?Be:Ve),v&&(0,c.mv)(Pe.outline)?(he=Ne,we=e.Pb.Outline,ve=Ee):!v&&this.formattingProperties.grid.gridHorizontal&&(he=this.formattingProperties.grid.gridHorizontalWeight,we=e.Pb.Gridline,ve=x?We:ze),C&&(0,c.fs)(Pe.outline)&&(ye=Ne,xe=e.Pb.Outline,pe=Ee),{weightTop:q,weightRight:oe,weightBottom:he,weightLeft:ye,typeTop:Re,typeRight:fe,typeBottom:we,typeLeft:xe,colorTop:Te,colorRight:Ie,colorBottom:ve,colorLeft:pe}},U.prototype.isUrlIcon=function(r,v){var C=(0,e.MN)(r.columnMetadata,v);return C!==y.av.NONE&&!!(0,o.RP)(this.formattingProperties.values.urlIcon,C)},U.prototype.getColumnHeaderFontInfo=function(r){return p.hc.isNodeGrandTotal(r)?this.grandTotalColumnHeaderFontInfo:r.hasSubtotalStyle?this.subtotalColumnHeaderFontInfo:this.specificColumnHeaderFontInfo[r.queryName]||this.columnHeaderFontInfo},U.prototype.getRowHeaderFontInfo=function(r){return p.hc.isNodeGrandTotal(r)?this.grandTotalRowHeaderFontInfo:r.hasSubtotalStyle?this.subtotalRowHeaderFontInfo:this.rowHeaderFontInfo},U.prototype.getBodyCellFontInfo=function(r){return r.isColumnGrandTotal?this.columnGrandTotalFontInfo:r.isRowGrandTotal?this.rowGrandTotalFontInfo:r.isColumnSubTotal?this.columnSubtotalFontInfo:r.isRowSubTotal||r.hasSubtotalStyle?this.rowSubtotalFontInfo:this.valueFontInfo},U.prototype.getCornerCellFontInfo=function(){return this.columnHeaderFontInfo},U.prototype.addRowHeaderClasses=function(r,v,C,S){var E,x=this.formattingProperties.rowHeaders;if(C.push(x.wordWrap?o.n2:o.wV),v&&C.push(t.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&w.l.hasIdentity(r)&&S.push(o.VM),v&&(E=d.H.center),(0,o.aY)(x.alignment,C,E),this.isA11yMatrix){var N=this.formattingProperties.rowHeaders.steppedLayout;this.selectionManager.isRowHeaderHighlighted(r)?(this.selectionManager.isRowHeaderIndicatorOn(r,N)||this.selectionManager.isRowHeaderDarkened(r))&&S.push("cell-selected"):S.push("cell-unselected")}},U.prototype.getColumnHeaderClasses=function(r,v){var C=[],S=this.formattingProperties.columnHeaders,x=this.formattingProperties.columnFormatting[r.queryName];v&&C.push(t.LU);var J,E=w.l.hasIdentity(r),N=this.sortingManager.isColumnHeaderSortable(r);return H.fF.assert(function(){return!(E&&N)},"getColumnHeaderClasses: header selectable and sortable"),this.binderOptions.interactivityIndicatorEnabled&&(this.binderOptions.selectionEnabled&&E&&!N||this.binderOptions.sortingEnabled&&N&&!E)&&C.push(o.VM),v&&(J=d.H.center),(0,o.aY)(x&&x.styleHeader&&x.alignment||S.alignment,C,J),this.isA11yMatrix&&(this.selectionManager.isColumnHeaderHighlighted(r)?(this.selectionManager.isColumnHeaderIndicatorOn(r)||this.selectionManager.isColumnHeaderDarkened(r))&&C.push("cell-selected"):C.push("cell-unselected")),C},U.prototype.addBodyCellClasses=function(r,v,C,S){C.push(this.formattingProperties.values.wordWrap?o.n2:o.wV),v&&C.push(t.LU),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.selectionEnabled&&!r.isRowAndColumnGrandTotal&&!r.isBlankRow&&S.push(o.VM);var x,J,N=this.formattingProperties.columnFormatting[r.columnMetadata&&r.columnMetadata.queryName];N&&(r.isGrandTotal?N.styleTotal:r.hasSubtotalStyle?N.styleSubTotals:N.styleValues)&&(x=N.alignment),v?J=d.H.center:!r.isKpi&&r.isNumeric&&(J=d.H.right),(0,o.aY)(x,C,J),this.isA11yMatrix&&(this.selectionManager.isBodyCellHighlighted(r)?!this.selectionManager.isSelectionEmpty()&&this.selectionManager.isBodyCellHighlighted(r)&&S.push("cell-selected"):S.push("cell-unselected"))},U.prototype.getCornerCellClasses=function(r){var v=[];v.push(this.formattingProperties.columnHeaders.wordWrap?o.n2:o.wV),this.binderOptions.interactivityIndicatorEnabled&&this.binderOptions.sortingEnabled&&this.sortingManager.isCornerSortable(r)&&v.push(o.VM);var C=this.formattingProperties.columnHeaders.titleAlignment;return C===d.H.auto&&(C=this.formattingProperties.columnHeaders.alignment),(0,o.aY)(C,v),v},U.prototype.getSteppedLayoutIndentation=function(r){return this.rowNavigator.getLevel(r)*this.formattingProperties.rowHeaders.steppedLayoutIndentation},U.prototype.getRowHeaderStyle=function(r,v,C,S,x,E){var Z,N=E??r.position,G=new e.qZ(o.K2,o.K2);if(this.formattingProperties.rowHeaders.underline&&S&&(G.textDecoration=h.f0),N.column.isLast&&(G.borders.right=new e.om(u.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),G.fontColor=t.lN,this.formattingProperties.blankRows.showBlankRows){var q=this.rowNavigator.getAncestor(r),oe=this.formattingProperties.general.layout===j.t.Compact?this.rowNavigator.getLeafIndex(q):this.rowNavigator.getIndexOfFirstLeaf(q);Z=(N.row.index-oe)%2!=0}(0,i.B0)(N,x??r,G,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,this.formattingProperties.values.bandedRowHeaders,!!x,Z),(0,o.Nk)(v,G,S);var he=this.formattingProperties.columnFormatting[r.queryName],ye=he&&he.styleHeader,Re=p.hc.isNodeGrandTotal(r)&&this.formattingProperties.rowGrandTotal.applyToHeaders,fe=r.hasSubtotalStyle&&this.formattingProperties.rowSubtotals.applyToHeaders;return ye&&he.fontColor?G.fontColor=he.fontColor:Re&&this.formattingProperties.rowGrandTotal.fontColor?G.fontColor=this.formattingProperties.rowGrandTotal.fontColor:fe&&this.formattingProperties.rowSubtotals.fontColor&&(G.fontColor=this.formattingProperties.rowSubtotals.fontColor),ye&&he.backColor?G.backColor=he.backColor:Re&&this.formattingProperties.rowGrandTotal.backColor?G.backColor=this.formattingProperties.rowGrandTotal.backColor:fe&&this.formattingProperties.rowSubtotals.backColor&&(G.backColor=this.formattingProperties.rowSubtotals.backColor),this.formattingProperties.rowHeaders.steppedLayout&&(G.paddings.left+=this.getSteppedLayoutIndentation(r)),G},U.prototype.getRowHeaderStyleAttributes=function(r,v,C,S,x,E){return this.getRowHeaderStyle(r,this.getRowHeaderFontInfo(r),v,C,x,E).getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,S)},U.prototype.getColumnHeaderStyle=function(r,v,C,S){var x=new e.qZ(o.K2,o.K2);r.position.row.isLast&&(x.borders.bottom=new e.om(u.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),x.fontColor=t.lN,(0,i.aV)(r.position,r,x,this.formattingProperties),(0,o.Nk)(v,x,S);var N=this.formattingProperties.columnFormatting[r.queryName],G=N&&N.styleHeader,J=p.hc.isNodeGrandTotal(r)&&this.formattingProperties.columnGrandTotal.applyToHeaders,Z=r.hasSubtotalStyle&&this.formattingProperties.columnSubtotals.applyToHeaders;return G&&N.fontColor?x.fontColor=N.fontColor:J&&this.formattingProperties.columnGrandTotal.fontColor?x.fontColor=this.formattingProperties.columnGrandTotal.fontColor:Z&&this.formattingProperties.columnSubtotals.fontColor&&(x.fontColor=this.formattingProperties.columnSubtotals.fontColor),G&&N.backColor?x.backColor=N.backColor:J&&this.formattingProperties.columnGrandTotal.backColor?x.backColor=this.formattingProperties.columnGrandTotal.backColor:Z&&this.formattingProperties.columnSubtotals.backColor&&(x.backColor=this.formattingProperties.columnSubtotals.backColor),this.formattingProperties.columnHeaders.underline&&S&&(x.textDecoration=h.f0),x},U.prototype.getColumnHeaderStyleAttributes=function(r,v,C){var S=v.getAttributes(!1,this.isA11yMatrix,this.isA11yMatrix,C);return this.isA11yMatrix||this.selectionManager.isColumnHeaderHighlighted(r)||(0,o.CQ)(S),S},U.prototype.getBodyCellStyle=function(r,v,C,S){var E,x=new e.qZ(o.K2,o.K2);if(this.formattingProperties.blankRows.showBlankRows){var N=this.rowNavigator.getAncestor(r.rowItem),G=this.formattingProperties.general.layout===j.t.Compact?this.rowNavigator.getLeafIndex(N):this.rowNavigator.getIndexOfFirstLeaf(N);E=(r.position.row.index-G)%2!=0}return(0,i.cP)(r.position,r,x,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties,E),(0,o.Nk)(v,x,S),x},U.prototype.addBodyCellStyleAttributes=function(r,v,C,S,x){v.setAttributes(S,!1,this.isA11yMatrix,this.isA11yMatrix,x),S.position="relative",this.isA11yMatrix||this.selectionManager.isBodyCellHighlighted(r)||(0,o.CQ)(S)},U.prototype.getCornerCellStyle=function(r,v,C,S){var x=new e.qZ(o.K2,o.K2);return x.fontColor=t.lN,this.formattingProperties.columnHeaders.underline&&S&&(x.textDecoration=h.f0),r.position.row.isLast&&(x.borders.bottom=new e.om(u.FX.PropGridOutlineWeight.defaultValue,this.binderOptions.tablixProperties.PropGridOutlineColor.getValue(null))),(0,i.qW)(r.position,x,this.formattingProperties.rowHeaders.steppedLayout,this.formattingProperties),(0,o.Nk)(v,x,S),x},U.prototype.getColumnHeaderLabel=function(r){return this.getHeaderContent(r,this.columnNavigator.getColumnHeaderMetadataColumn(r),this.columnNavigator.isColumnHeaderMultiValueSubtotal(r),this.formattingProperties.columnHeaders.wordWrap)},U.prototype.getRowHeaderLabel=function(r){return this.getHeaderContent(r,this.rowNavigator.getRowHeaderMetadataColumn(r),this.rowNavigator.isRowHeaderMultiValueSubtotal(r),this.formattingProperties.rowHeaders.wordWrap)},U.prototype.getBodyCellContent=function(r){return this.formattingProperties.values.wordWrap?r.textContent:(0,V.PC)(r.textContent)},U.prototype.getCornerCellLabel=function(r){return this.formattingProperties.columnHeaders.wordWrap?r.displayName:(0,V.PC)(r.displayName)},U.prototype.getHeaderContent=function(r,v,C,S){if(r.isSubtotal&&!C){var x=this.formattingProperties.columnFormatting[v.queryName],E=x?x.subtotalLabel:this.binderOptions.defaultTotalLabel;return S?E:(0,V.PC)(E)}var N=r.valueFormatted;return(0,o.jv)(v,N)?N:N&&(0,e.wX)(r,v,N)?g.b$.encodeUriForImageDataSvg(N):S?N:(0,V.PC)(N)},U.prototype.onDataViewChanged=function(r,v,C,S,x){var N,E=this;this.formattingProperties=v,this.legacyTooltipsEnabled=S,this.isExpandCollapseEnabled=!!x;var G=v.general.textSize,J=new o.Kq,Z={},q={},oe={};Z.family=v.columnHeaders.fontFamily||t.F2,Z.size=v.columnHeaders.fontSize||G,v.columnHeaders.bold&&(Z.weight=h.en),v.columnHeaders.italic&&(Z.style=h.BF),v.columnHeaders.underline&&(Z.textDecoration=h.f0),this.columnHeaderFontInfo=(0,o.Od)(Z,J),this.specificColumnHeaderFontInfo={};var he=null===(N=this.formattingProperties.annotationFormatting)||void 0===N?void 0:N.columnHeaders;he&&_.forEach(he,function(We,Be){var ze=(0,Q.pi)({},Z);(We.bold||v.columnHeaders.bold)&&(ze.weight=h.en),E.specificColumnHeaderFontInfo[Be]=(0,o.Od)(ze,J)}),oe.family=v.rowHeaders.fontFamily||t.F2,oe.size=v.rowHeaders.fontSize||G,v.rowHeaders.bold&&(oe.weight=h.en),v.rowHeaders.italic&&(oe.style=h.BF),v.rowHeaders.underline&&(oe.textDecoration=h.f0),this.rowHeaderFontInfo=(0,o.Od)(oe,J),this.expandCollapseButtonFontInfo=(0,o.Od)({family:"PowrMDL2",size:v.rowHeaders.expandCollapseButtonsSize||this.rowHeaderFontInfo.fontProperties.size},J),q.family=v.values.fontFamily||t.dG,q.size=v.values.fontSize||G,v.values.bold&&(q.weight=h.en),v.values.italic&&(q.style=h.BF),v.values.underline&&(q.textDecoration=h.f0),this.valueFontInfo=(0,o.Od)(q,J),this.columnSubtotalFontInfo=this.getSubtotalFontInfo(v.columnSubtotals,J),this.rowSubtotalFontInfo=this.getSubtotalFontInfo(v.rowSubtotals,J),this.columnGrandTotalFontInfo=this.getGrandTotalFontInfo(v.columnGrandTotal,J,this.columnSubtotalFontInfo),this.rowGrandTotalFontInfo=this.getGrandTotalFontInfo(v.rowGrandTotal,J,this.rowSubtotalFontInfo);var Re=this.columnHeaderFontInfo.fontProperties.family===t.F2,fe=this.rowHeaderFontInfo.fontProperties.family===t.F2;this.subtotalColumnHeaderFontInfo=v.columnSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,o.TQ)(this.columnSubtotalFontInfo,{},J):(0,o.TQ)(this.columnHeaderFontInfo,U.applyBold(Re),J),this.subtotalRowHeaderFontInfo=v.rowSubtotals.applyToHeaders?this.subtotalRowHeaderFontInfo=(0,o.TQ)(this.rowSubtotalFontInfo,{},J):(0,o.TQ)(this.rowHeaderFontInfo,U.applyBold(fe),J),this.grandTotalColumnHeaderFontInfo=v.columnGrandTotal.applyToHeaders?(0,o.TQ)(this.columnGrandTotalFontInfo,{},J):(0,o.TQ)(this.columnHeaderFontInfo,U.applyBold(Re),J),this.grandTotalRowHeaderFontInfo=v.rowGrandTotal.applyToHeaders?(0,o.TQ)(this.rowGrandTotalFontInfo,{},J):(0,o.TQ)(this.rowHeaderFontInfo,U.applyBold(fe),J),this.glyphFontInfo=(0,o.Od)({family:t.Vz,size:R.B.createFromPt((v.columnHeaders.fontSize||G).pt*t.Yo),lineHeight:"100%"},J),J.measureAll(this.measureElement),this.columnsDataBarsSettings={};var we=v.columnFormatting;if(we&&r&&r.matrix&&!_.isEmpty(r.matrix.valueSources))for(var xe=0,Te=r.matrix.valueSources;xe<Te.length;xe++)(ve=(Ie=Te[xe]).queryName)&&we[ve]&&(this.columnsDataBarsSettings[ve]=(0,f.az)(Ie,we[ve].dataBarsSettings,C));this.sparklineSettings={};var pe=v.sparklines;if(pe&&r&&r.matrix&&!_.isEmpty(r.matrix.valueSources))for(var Pe=0,Ne=r.matrix.valueSources;Pe<Ne.length;Pe++){var Ie,ve;(ve=(Ie=Ne[Pe]).queryName)&&pe[ve]&&(this.sparklineSettings[ve]=(0,M.wJ)(pe[ve],Ie.type,C))}},U.prototype.getGrandTotalFontInfo=function(r,v,C){var S={},x=r.fontFamily;return S.family=x,S.size=r.fontSize,r.bold&&x&&(S.weight=h.en),r.italic&&(S.style=h.BF),r.underline&&(S.textDecoration=h.f0),(0,o.TQ)(C,S,v)},U.prototype.shouldApplyDataBars=function(r,v){if(!r||!_.isNumber(v.dataPoint))return!1;var C=v.isTotal||v.hasSubtotalStyle;switch(r.totalMatching){case 0:return!0;case 1:case void 0:return!C;case 2:return C;default:return H.fF.assertNever(r.totalMatching),!C}},U.prototype.isImage=function(r){return(0,k.pt)(r.columnMetadata)},U.prototype.isSparkline=function(r){var v,C=r.columnMetadata,S=null===(v=C?.type)||void 0===v?void 0:v.misc;return null!=S&&null!=S.sparkline},U.applyBold=function(r){return{family:r?t.Zk:void 0,weight:r?void 0:h.en}},U.prototype.getSubtotalFontInfo=function(r,v){var S,C=r.fontFamily;C||this.valueFontInfo.fontProperties.family!==t.dG?S=!0:this.valueFontInfo.fontProperties.family===t.dG&&(C=t.Zk);var x={};return x.family=C,x.size=r.fontSize,r.bold&&S&&(x.weight=h.en),r.italic&&(x.style=h.BF),r.underline&&(x.textDecoration=h.f0),(0,o.TQ)(this.valueFontInfo,x,v)},U.prototype.setHorizontalBorderXPositions=function(r,v){var C="0",S="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[C,S];switch(v){case Y.p0.Header:C="0",S="100%";break;case Y.p0.Body:C=r.toString();break;case Y.p0.MatrixRowHeader:C="0",S=r.toString();break;default:H.fF.assertFail("this should never be the case")}return[C,S]},U.prototype.setVerticalBorderYPositions=function(r,v){var C="0",S="100%";if(this.formattingProperties.rowHeaders.steppedLayout)return[C,S];switch(v){case Y.p0.Header:C="0",S="100%";break;case Y.p0.Body:break;case Y.p0.MatrixRowHeader:C="0",S=r.toString();break;default:H.fF.assertFail("this should never be the case")}return[C,S]},U}(),A=B(31577),ie=B(82386),ee=B(59151),ne=function(){function U(r){this.hostServices=r}return U.prototype.onDataViewChanged=function(r,v,C,S){this.columnHierarchy=r,this.valueSources=v,this.metatdataObjects=C,this.valuesOnRowApplied=S,this.hasColumnGrouping=(0,ie.pr)(this.columnHierarchy)>0,this.hasMultiMeasureOnColumns=!_.isEmpty(this.valueSources)&&this.valueSources.length>1&&!this.valuesOnRowApplied,this.headerPendingChanges=[],this.cornerPendingChanges=[]},U.prototype.getNodeSelector=function(r){if(H.fF.assertValue(r,"PivotTableSizeManager.getNodeSelector: header"),!this.hasColumnGrouping){if(r.queryName)return{metadata:r.queryName};if(this.valuesOnRowApplied)return null}for(var v={};r;){if(this.hasMultiMeasureOnColumns&&r.level===this.columnHierarchy.levels.length-1)v.metadata=r.queryName;else if(r.isSubtotal){for(var C=[],x=0,E=this.columnHierarchy.levels[r.level].sources;x<E.length;x++){var N=E[x];_.isEmpty(N.identityExprs)||C.push.apply(C,N.identityExprs||[])}_.isEmpty(C)||(v.data=[(0,A.ms)(C)])}else r.identity&&(v.data?v.data.splice(0,0,r.identity):v.data=[r.identity]);r=r.parent}return v},U.prototype.getCornerSelector=function(r){if(H.fF.assertValue(r,"PivotTableSizeManager.getCornerSelector: corner"),r.metadata&&r.metadata.queryName)return{metadata:r.metadata.queryName}},U.prototype.getHeaderPendingChange=function(r){return _.find(this.headerPendingChanges,function(v){return w.l.areHeadersEqual(v.cell,r)})},U.prototype.getCornerPendingChange=function(r){return _.find(this.cornerPendingChanges,function(v){return w.l.areCornerItemsEqual(v.cell,r)})},U.prototype.queueHeaderPendingChange=function(r,v){var C=this.getHeaderPendingChange(r);C?C.width=v:this.headerPendingChanges.push({cell:r,width:v})},U.prototype.queueCornerPendingChange=function(r,v){var C=this.getCornerPendingChange(r);C?C.width=v:this.cornerPendingChanges.push({cell:r,width:v})},U.prototype.getColumnWidth=function(r){H.fF.assertValue(r,"PivotTableSizeManager.getColumnWidth: header");var C,v=this.getHeaderPendingChange(r);return v?v.width:(this.hasColumnGrouping?C=r.objects:r.queryName?C=this.valueSources[r.levelSourceIndex||0].objects:this.valuesOnRowApplied&&(C=this.metatdataObjects),u.FX.PropColumnWidthValue.getValue(C))},U.prototype.setColumnWidth=function(r,v){var C=this.getNodeSelector(r);this.queueHeaderPendingChange(r,v),(0,ee.P)([{selector:C,value:v}],this.hostServices,!1)},U.prototype.getRowHeight=function(r){},U.prototype.setRowHeight=function(r,v){},U.prototype.getRowLevelWidth=function(r){H.fF.assertValue(r,"PivotTableSizeManager.getRowLevelWidth: cornerCell");var v=this.getCornerPendingChange(r);return v?v.width:r.metadata&&r.metadata.objects?u.FX.PropColumnWidthValue.getValue(r.metadata.objects):void 0},U.prototype.setRowLevelWidth=function(r,v){var C=this.getCornerSelector(r);C&&(this.queueCornerPendingChange(r,v),(0,ee.P)([{selector:C,value:v}],this.hostServices,!1))},U.prototype.getColumnLevelHeight=function(r){},U.prototype.setColumnLevelHeight=function(r,v){},U.prototype.setMissingWidths=function(r,v){for(var C=[],S=0,x=r;S<x.length;S++){var E=x[S],N=E.node,G=E.width;null==this.getColumnWidth(N)&&(this.queueHeaderPendingChange(N,G),C.push({selector:this.getNodeSelector(N),value:G}))}for(var J=0,Z=v;J<Z.length;J++){var q=Z[J],oe=q.corner,he=(G=q.width,this.getCornerSelector(oe));he&&null==this.getRowLevelWidth(oe)&&(this.queueCornerPendingChange(oe,G),C.push({selector:he,value:G}))}_.isEmpty(C)||(0,ee.P)(C,this.hostServices,!0)},U.prototype.clearWidths=function(r,v){for(var C=[],S=0,x=r;S<x.length;S++){var E=x[S];null!=this.getColumnWidth(E)&&C.push({selector:this.getNodeSelector(E),value:void 0}),this.queueHeaderPendingChange(E,void 0)}for(var N=0,G=v;N<G.length;N++){var J=G[N];null!=this.getRowLevelWidth(J)&&C.push({selector:this.getCornerSelector(J),value:void 0}),this.queueCornerPendingChange(J,void 0)}_.isEmpty(C)||(0,ee.P)(C,this.hostServices,!0)},U}(),ae=B(11184),le=B(98094),ue=B(48645),ge=B(86900),ce=B(24133),Ce=B(73889),be=B(74304),He=B(40845),Se=B(12913),Le=function(){function U(r,v){void 0===r&&(r=(0,K.DH)()),this.options=r,this.annotationHighlightElementToRegionIdMap=new Map,this.featureSwitches=v||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.showAsTableNativeMenuEnabled=this.options.showAsTableNativeMenuEnabled,this.tooltipType=0,this.asyncSerializer=new D.W,this.supportsOnObject=!!this.featureSwitches.onObject,this.enableCalculationHighlighting=!!this.featureSwitches.enableCalculationHighlighting,this.numFontDelays=0}return U.prototype.init=function(r){var C,v=this;this.currentViewport=r.viewport,this.element=r.element,this.hostServices=r.host,this.waitingForData=!1,this.style=r.style,this.tablixPropertyManager=new be.U(this.style),this.selectionManager=new w.l(this.hostServices,this.featureSwitches),this.sortingManager=new T.S(this.hostServices),this.sizeManager=new ne(this.hostServices),this.tooltipService=(0,m.r)(r.host),this.valueLabel=this.hostServices.getLocalizedString(t.yF),this.totalLabel=this.hostServices.getLocalizedString(t.qT);var x=(null===(C=this.hostServices)||void 0===C?void 0:C.getSubSelectionService())??ge.D.createWithDefaultHost(),E=new ue.y(x);this.enableCalculationHighlighting&&(this.annotationHelper=n.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:E,targetSource:"annotation",scale:function(){return v.currentViewport.scale},customElementRegionOutlineIdCallback:function(G){return v.getAnnotationHighlightElementSubSelectionOutlineRegionId(G)},customScrollCallbacks:{onScrollStart:function(){return v.annotationHighlightOnScrollStart()},onScrollEnd:function(){return v.annotationHighlightOnScrollEnd()}}})),this.supportsOnObject&&(this.subSelectionHelper=n.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:E,targetSource:"format",scale:function(){return v.currentViewport.scale}}))},U.prototype.update=function(r){return(0,Q.mG)(this,void 0,void 0,function(){var v=this;return(0,Q.Jh)(this,function(C){switch(C.label){case 0:return[4,this.asyncSerializer.enqueue(function(){return(0,Q.mG)(v,void 0,void 0,function(){var S,x,E,N,G,J,Z;return(0,Q.Jh)(this,function(q){switch(q.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new le.J(function(oe){return setTimeout(oe,500)})]:[3,2];case 1:return q.sent(),this.numFontDelays++,[3,0];case 2:return r.type&te.EP.Data?[4,this.onDataViewChanged(r.dataViews,r.operationKind,r.viewport)]:[3,4];case 3:q.sent(),q.label=4;case 4:return this.pivotTableControl&&r.type&te.EP.Resize?(S=this.getVisibleRowStart(this.getPreviousVisibleRowStart(),!1),x=this.getVisibleColumnStart(this.getPreviousVisibleColumnStart()),this.pivotTableControl.setWidth(r.viewport.width),this.pivotTableControl.setHeight(r.viewport.height),[4,this.renderControl(Y.BM.Incremental,S,x)]):[3,6];case 5:q.sent(),q.label=6;case 6:return this.supportsOnObject?r.formatMode===this.formatMode?[3,8]:(this.formatMode=r.formatMode,this.subSelectionHelper.setFormatMode(r.formatMode),r.formatMode?(this.element.get(0).setAttribute(n.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(n.y3),this.pivotTableControl&&this.pivotTableControl instanceof ce.d?(this.pivotTableControl.getBinder().setFormatMode(r.formatMode),[4,this.pivotTableControl.renderAsync(Y.BM.ClearRendering)]):[3,8]):[3,8];case 7:q.sent(),q.label=8;case 8:return this.enableCalculationHighlighting&&(this.allowAnnotationHighlights=r.allowAnnotationHighlights),E=r.type&te.EP.Data||r.type&te.EP.Resize||r.type&te.EP.FormattingSubSelectionChange,N=r.type&te.EP.FormattingSubSelectionChange,this.subSelectionHelper&&E&&(this.subSelectionHelper.updateOutlinesFromSubSelections(r.subSelections,!0),this.hostServices.alertScreenReader&&N&&(G=this.subSelectionHelper.getLabelsFromSubSelections(r.subSelections,["aria-label"]),(J=G?.length&&G.join(" "))&&this.hostServices.alertScreenReader(J))),Z=r.type&te.EP.Data||r.type&te.EP.Resize,this.annotationHelper&&Z&&this.allowAnnotationHighlights&&this.updateOutlinesFromAnnotations(),[2]}})})})];case 1:return C.sent(),[2]}})})},U.prototype.hasNoColumnData=function(){var r,v,C,S,x=null===(S=null===(C=null===(v=null===(r=this.dataView)||void 0===r?void 0:r.matrix)||void 0===v?void 0:v.columns)||void 0===C?void 0:C.root)||void 0===S?void 0:S.children;return!x||!_.some(x,function(E){return!E?.isSubtotal})},U.prototype.updatePersistedWidths=function(r){var v=u.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!v&&this.pivotTableControl){if(this.hasNoColumnData())return;for(var C=[],S=this.columnHierarchyNavigator.getHierarchyLeafNodes(),E=0,N=0,G=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();N<G.length;N++)for(var q=0,oe=G[N].getColumnWidths();q<oe.length;q++)C.push({node:S[E],width:oe[q]}),E++;for(var ye=[],Re=this.rowHierarchyNavigator.getHierarchyDepth(),fe=this.columnHierarchyNavigator.getHierarchyDepth(),we=0;we<Re;we++)ye.push({corner:this.rowHierarchyNavigator.getCorner(we,fe-1),width:this.pivotTableControl.getRowLevelWidthMeasureManager().getLevelWidth(we)});this.sizeManager.setMissingWidths(C,ye)}else if(v&&r&&r.metadata&&r.metadata.objects&&!u.FX.PropColumnPivotTableAutoSizeColumns.getValue(r.metadata.objects)){S=this.columnHierarchyNavigator.getHierarchyLeafNodes();var xe=[];for(Re=this.rowHierarchyNavigator.getHierarchyDepth(),fe=this.columnHierarchyNavigator.getHierarchyDepth(),we=0;we<Re;we++)xe.push(this.rowHierarchyNavigator.getCorner(we,fe-1));this.sizeManager.clearWidths(S,xe)}},U.prototype.onDataViewChanged=function(r,v,C){return(0,Q.mG)(this,void 0,void 0,function(){var S,x,E,N=this;return(0,Q.Jh)(this,function(G){switch(G.label){case 0:return this.setExpandCollapseEnabled(),_.isEmpty(r)?[3,5]:(S=this.dataView,this.dataView=r[0],x=!this.dataView.metadata.segment,this.formattingProperties=this.tablixPropertyManager.getPivotTableObjects(this.dataView,function(J){for(var Z,q=[],oe=1;oe<arguments.length;oe++)q[oe-1]=arguments[oe];return(Z=N.hostServices).getLocalizedString.apply(Z,(0,Q.ev)([J],q||[],!1))},this.expandCollapseEnabled,this.style,this.featureSwitches,this.featureSwitches.enableCalculationHighlighting),this.formatters=this.formattingProperties.formatters,this.tooltipFormatters=this.formattingProperties.tooltipFormatters,E=this.shouldApplyValuesOnRow(),v!==te.su.Append?[3,2]:[4,this.onAppendDataView(S,E,x)]);case 1:return G.sent(),[3,4];case 2:return[4,this.onNewDataView(S,C,E,x)];case 3:G.sent(),G.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),G.label=6;case 6:return this.waitingForData=!1,[2]}})})},U.prototype.destroy=function(){var r;null===(r=this.pivotTableControl)||void 0===r||r.destroy()},U.prototype.onAppendDataView=function(r,v,C){return(0,Q.mG)(this,void 0,void 0,function(){var S,x,E,N,G,J;return(0,Q.Jh)(this,function(Z){switch(Z.label){case 0:return this.pivotTableControl.setUnfrozenRowHeaders(u.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(u.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),S=this.rowHierarchyNavigator.getHierarchyLeafCount(),x=this.getPreviousVisibleRowStart(),E=this.getPreviousVisibleColumnStart(),this.updateHierarchyNavigators(this.formattingProperties.rowHeaders.steppedLayout,v,this.formattingProperties.subtotals.rowSubtotalsPosition===He.we,C,r.matrix.rows.root!==this.dataView.matrix.rows.root),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),N=this.formattingProperties.rowHeaders.steppedLayout,G=this.matrixNavigator.getColumnHierarchy(),J=this.matrixNavigator.getValueSources(),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),G,J,N,v),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),S>this.rowHierarchyNavigator.getHierarchyLeafCount()||!_.isEqual(r.metadata.columns,this.dataView.metadata.columns)?[4,this.renderControl(Y.BM.ClearMeasurement,this.getVisibleRowStart(x,!1),this.getVisibleColumnStart(E))]:[3,2];case 1:return Z.sent(),[3,4];case 2:return[4,this.renderControl(Y.BM.ClearRendering,null,null)];case 3:Z.sent(),Z.label=4;case 4:return[2]}})})},U.prototype.onNewDataView=function(r,v,C,S){return(0,Q.mG)(this,void 0,void 0,function(){var x,E,N,G,J,Z;return(0,Q.Jh)(this,function(oe){switch(oe.label){case 0:return x=this.formattingProperties.rowHeaders.steppedLayout,E=this.getPreviousVisibleRowStart(),N=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(x,C,this.formattingProperties.subtotals.rowSubtotalsPosition===He.we,S,this.formattingProperties.rowHeaders.expandCompositeHierarchy),this.pivotTableControl.setUnfrozenRowHeaders(u.FX.PropUnfrozenRowHeaders.getValue(this.dataView.metadata.objects)),this.pivotTableControl.setRepeatRowHeaders(u.FX.PropRowsRepeatRowHeaders.getValue(this.dataView.metadata.objects)),G=this.matrixNavigator.getColumnHierarchy(),J=this.matrixNavigator.getValueSources(),this.sizeManager.onDataViewChanged(G,J,this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,C),this.sortingManager.onDataViewChanged(this.matrixNavigator.getRowHierarchy(),G,J,x,C),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(v.width),this.pivotTableControl.setHeight(v.height),Z=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&Z&&Z.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.onDataViewChanged(this.dataView,this.formattingProperties,this.style,0===this.tooltipType,this.expandCollapseEnabled&&"interactive"===this.options.expandCollapse.buttonsOption),[4,this.renderControl(Y.BM.ClearMeasurement,this.getVisibleRowStart(E,T.S.hasSortingChanged(r,this.dataView)),this.getVisibleColumnStart(N))];case 1:return oe.sent(),this.updatePersistedWidths(r),[2]}})})},U.prototype.onVerticalScrollButtonClick=function(r,v){var C=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(r),this.getScrollRowIndex(v));this.hostServices.alertScreenReader(C)},U.prototype.onHorizontalScrollButtonClick=function(r,v){var C=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(r),this.getScrollColumnIndex(v));this.hostServices.alertScreenReader(C)},U.prototype.getScrollRowIndex=function(r){return 0===r?1:this.pivotTableControl.getMidRenderer().getAriaRowIndex(r)},U.prototype.getScrollColumnIndex=function(r){return 0===r?1:this.pivotTableControl.getMidRenderer().getAriaColIndex(r,!1)},U.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},U.prototype.onRestoreSelection=function(r){var v=this.selectionManager.restoreSelectionState(r.selection,this.matrixNavigator);return this.renderSelection(),v},U.prototype.shouldApplyValuesOnRow=function(){var r=this.dataView.matrix,v=r.valueSources,C=r.columns.levels;if(_.isEmpty(C))return!1;var S=C[0].sources;return this.formattingProperties.values.valuesOnRow&&v.length>1&&!(_.find(S,function(x){return x.isMeasure})&&_.find(S,function(x){return!x.isMeasure}))},U.prototype.updateHierarchyNavigators=function(r,v,C,S,x){this.matrixNavigator.update(this.dataView.matrix,r,v,C,S,x,this.formatters,this.tooltipFormatters,this.getSubtotalByColumn(),this.formattingProperties.subtotals.rowSubtotalsPosition,this.featureSwitches.matrixLayouts?this.formattingProperties.general.layout:void 0,this.formattingProperties.blankRows.showBlankRows),this.rowHierarchyNavigator.setHierarchy(this.matrixNavigator.getRowHierarchy()),this.columnHierarchyNavigator.setHierarchy(this.matrixNavigator.getColumnHierarchy())},U.prototype.getSubtotalByColumn=function(){for(var r={},v=this.dataView.metadata.objects,C=u.FX.PropSubTotalsPivotTableRowSubtotals.getValue(v),S=u.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(v),x=u.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(v),E=u.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(v),N=0,G=this.dataView.metadata.columns;N<G.length;N++){var J=G[N],Z=void 0,q=void 0;if(J.roles){if(J.roles[I.r.rows])Z=C,q=S;else{if(!J.roles[I.r.columns])continue;Z=x,q=E}r[J.queryName]=Z&&(!q||u.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.getValue(J.objects))}}return r},U.prototype.renderControl=function(r,v,C){return this.pivotTableControl.renderAsync(r,v,C)},U.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var r=this.pivotTableControl.getVisibleRowStart();if(!r)return null;var v=this.rowHierarchyNavigator.getHierarchyLeafAt(r.rowIndex);return v?{item:v,offset:r.visibleHeight}:null}},U.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var r=this.pivotTableControl.getVisibleColumnStart();if(!r)return null;var v=this.columnHierarchyNavigator.getHierarchyLeafAt(r.columnIndex);return v?{item:v,offset:r.visibleWidth}:null}},U.prototype.getSubSelectionShortcuts=function(r){if(this.supportsOnObject)for(var x=0,E=_.first(r).visualObjects;x<E.length;x++){var N=E[x];switch(_.isEmpty(N.selectorsByColumn)||(0,z.tV)(N.selectorsByColumn),N.objectName){case"columnHeaders":return[{type:0},(0,Q.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Column_Subtotals")},L.t.subTotals.columnSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"rowHeaders":return[{type:0,excludedResetFormattingIds:[L.t.rowHeaders.showExpandCollapseButtons,L.t.subTotals.rowSubtotals]},(0,Q.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_ExpandCollapse")},L.t.rowHeaders.showExpandCollapseButtons),(0,Q.pi)({type:2,enabledLabel:this.hostServices.getLocalizedString("Add_Row_Subtotals")},L.t.subTotals.rowSubtotals),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowHeaders"),groupUid:"".concat("rowHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Row_Headers")}];case"subtotal-row":return[{type:0},(0,Q.pi)({type:3,label:this.hostServices.getLocalizedString("Visual_Position")},L.t.subTotals.rowSubtotalsPosition),{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotals")}];case"subtotal-row-labels":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowSubTotal")},label:this.hostServices.getLocalizedString("Format_Row_Subtotal_Label")}];case"subtotal-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnSubTotal")},label:this.hostServices.getLocalizedString("Format_Column_Subtotals")}];case"total-column":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnTotal"),groupUid:"".concat("columnTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}];case"total-row":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("rowTotal"),groupUid:"".concat("rowTotal","-").concat("values")},label:this.hostServices.getLocalizedString("Format_Grand_Total_Row")}]}}},U.prototype.getSubSelectionStyles=function(r){if(this.supportsOnObject){var S,x,C=_.first(r).visualObjects;if(!(C.length>0))return;switch(S=C[0],_.isEmpty(S.selectorsByColumn)||(x=(0,z.tV)(S.selectorsByColumn)),S.objectName){case"columnHeaders":var E=(0,de.RM)(this.hostServices,{boldReference:L.t.columnHeaders.bold,italicReference:L.t.columnHeaders.italic,underlineReference:L.t.columnHeaders.underline,fontColorReference:L.t.columnHeaders.fontColor,fontFamilyReference:L.t.columnHeaders.fontFamily,fontSizeReference:L.t.columnHeaders.fontSize,backgroundReference:L.t.columnHeaders.backColor,horizontalAlignmentReference:L.t.columnHeaders.alignment,wordWrapReference:L.t.columnHeaders.wordWrap});return(0,Q.pi)({type:1},E);case"rowHeaders":var N=(0,de.RM)(this.hostServices,{boldReference:L.t.rowHeaders.bold,italicReference:L.t.rowHeaders.italic,underlineReference:L.t.rowHeaders.underline,fontColorReference:L.t.rowHeaders.fontColor,fontFamilyReference:L.t.rowHeaders.fontFamily,fontSizeReference:L.t.rowHeaders.fontSize,backgroundReference:L.t.rowHeaders.backColor,horizontalAlignmentReference:L.t.rowHeaders.alignment,wordWrapReference:L.t.rowHeaders.wordWrap});return(0,Q.pi)({type:1},N);case"subtotal-row":x={id:"Row"};var G=(0,de.RM)(this.hostServices,{boldReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.bold),{selector:x}),italicReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.italic),{selector:x}),underlineReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.underline),{selector:x}),fontColorReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontColor),{selector:x}),fontFamilyReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontFamily),{selector:x}),fontSizeReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontSize),{selector:x}),backgroundReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.backColor),{selector:x})});return(0,Q.pi)({type:1},G);case"subtotal-column":x={id:"Column"};var J=(0,de.RM)(this.hostServices,{boldReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.bold),{selector:x}),italicReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.italic),{selector:x}),underlineReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.underline),{selector:x}),fontColorReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontColor),{selector:x}),fontFamilyReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontFamily),{selector:x}),fontSizeReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.fontSize),{selector:x}),backgroundReference:(0,Q.pi)((0,Q.pi)({},L.t.subTotals.backColor),{selector:x})});return(0,Q.pi)({type:1},J);case"total-column":var Z=(0,de.RM)(this.hostServices,{boldReference:L.t.columnTotal.bold,italicReference:L.t.columnTotal.italic,underlineReference:L.t.columnTotal.underline,fontColorReference:L.t.columnTotal.fontColor,fontFamilyReference:L.t.columnTotal.fontFamily,fontSizeReference:L.t.columnTotal.fontSize,backgroundReference:L.t.columnTotal.backColor});return(0,Q.pi)({type:1},Z);case"total-row":var q=(0,de.RM)(this.hostServices,{boldReference:L.t.rowTotal.bold,italicReference:L.t.rowTotal.italic,underlineReference:L.t.rowTotal.underline,fontColorReference:L.t.rowTotal.fontColor,fontFamilyReference:L.t.rowTotal.fontFamily,fontSizeReference:L.t.rowTotal.fontSize,backgroundReference:L.t.rowTotal.backColor});return(0,Q.pi)({type:1},q)}}},U.prototype.getVisibleRowStart=function(r,v){if(!r||0===this.pivotTableControl.getViewport().top)return null;if(v)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var C=w.l.getMatchingHeader(r.item,this.rowHierarchyNavigator.getHierarchyItems());if(!C)return null;var S=this.rowHierarchyNavigator.getLeafIndex(C);return void 0===S?null:{rowIndex:S,visibleHeight:r.offset}},U.prototype.getVisibleColumnStart=function(r){if(!r||0===this.pivotTableControl.getViewport().left)return null;var v=w.l.getMatchingHeader(r.item,this.columnHierarchyNavigator.getHierarchyItems());return v&&this.columnHierarchyNavigator.isLeaf(v)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(v),visibleWidth:r.offset}:null},U.prototype.renderSelection=function(){this.pivotTableControl.renderAsync(Y.BM.ClearRendering).catch(function(r){return Se.f.error(r)})},U.prototype.createOrUpdateControlAndNavigators=function(r,v,C,S,x){var E=this,N=this.hostServices.getLocalizedString("ListJoin_Separator");if(this.matrixNavigator||(this.matrixNavigator=new p.hc(N,this.tablixPropertyManager.tablixProperties,this.hostServices,x,this.isModernRowHeaderStyle())),this.rowHierarchyNavigator?r?this.rowHierarchyNavigator instanceof ae.S||(this.rowHierarchyNavigator=new ae.S(this.matrixNavigator)):this.rowHierarchyNavigator instanceof ae.S&&(this.rowHierarchyNavigator=new ae.Q(this.matrixNavigator)):(this.rowHierarchyNavigator=r?new ae.S(this.matrixNavigator):new ae.Q(this.matrixNavigator),this.columnHierarchyNavigator=new ae.Q(this.matrixNavigator)),this.updateHierarchyNavigators(r,v,C,S,!0),this.pivotTableControl)this.pivotTableControl.getSteppedLayout()!==r&&this.switchRowHeadersLayout(r);else{var G={onBindRowHeader:function(oe){E.onBindRowHeader(oe)},onHyperlinkClicked:function(oe,he){return E.onHyperlinkClicked(oe,he)},onRowHeaderExpansionChange:function(oe,he){return E.onHeaderExpansionChange(oe,[I.r.rows],he)},defaultTotalLabel:this.totalLabel,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties},J=document.createElement("div");J.className="pivotTableContainer",this.element.append(J),this.binder=new re(G,this.selectionManager,this.sortingManager,this.hostServices,J,!0);var Z=this.supportsOnObject;this.pivotTableControl=new ce.d(J,this.sizeManager,this.createControlOptions(),!1,!0,Z,this.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,void 0,void 0,this.showAsTableNativeMenuEnabled),this.pivotTableControl.setClassName("pivotTable"),this.switchRowHeadersLayout(r),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.binder.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},U.prototype.isModernRowHeaderStyle=function(){var r;return!(!this.featureSwitches.matrixLayouts||null===(r=this.formattingProperties.rowHeaders)||void 0===r||!r.legacyStyleDisabled)},U.prototype.createControlOptions=function(){var r=this,v=this.options.scrolling.enabled,C=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=new b(this.tooltipService,this.selectionManager,this.valueLabel,this.totalLabel));var S=this.interactionManager,x="interactive"===this.options.expandCollapse.buttonsOption,N=null;S&&(N=S.getHandlerTop());var G=null;return S&&(G=S.getHandlerMidOrBot()),this.options.selection.enabled?{rowHeaderClickHandler:function(q,oe){return!r.formatMode&&r.onItemClick(q,oe,w.D.RowHeader)},rowHeaderContextMenuHandler:function(q,oe){return!r.formatMode&&r.onItemContextMenu(q,w.D.RowHeader,oe,I.r.rows)},rowHeaderInteractionHandler:null,rowHeaderFocusHandler:function(q){return r.onRowHeaderFocus(q)},rowHeaderExpandCollapseHandler:x?function(Z,q){return r.onHeaderExpansionChange(Z,[I.r.rows],q)}:null,columnHeaderClickHandler:function(q,oe){return!r.formatMode&&r.onItemClick(q,oe,w.D.ColumnHeader)},columnHeaderContextMenuHandler:function(q,oe){return!r.formatMode&&r.onItemContextMenu(q,w.D.ColumnHeader,oe,I.r.columns)},columnHeaderInteractionHandler:this.formatMode?null:N,columnHeaderFocusHandler:function(q){return r.onColumnHeaderFocus(q)},bodyCellClickHandler:function(q,oe){return!r.formatMode&&r.onItemClick(q,oe,w.D.BodyCell)},bodyCellContextMenuHandler:function(q,oe){return!r.formatMode&&r.onItemContextMenu(q,w.D.BodyCell,oe,I.r.values)},bodyCellInteractionHandler:this.formatMode?null:G,bodyCellFocusHandler:function(q){return null},cornerCellClickHandler:function(q,oe){return!r.formatMode&&r.onCornerCellClick(q,oe)},cornerCellContextMenuHandler:function(q,oe){return!r.formatMode&&r.onCornerCellContextMenu(q,oe)},cornerCellInteractionHandler:null,cornerCellFocusHandler:function(q){return r.onCornerCellFocus(q)},cellContentActivationHandler:function(q,oe){return!r.formatMode&&r.onContentActivation(q,oe)},whitespaceClickHandler:function(q,oe){return!r.formatMode&&r.onWhitespaceClick(oe)},scrollingEnabled:v,columnResizingEnabled:C,rowLevelResizingEnabled:C,onScroll:function(){return r.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:x?function(Z,q){return r.onHeaderExpansionChange(Z,[I.r.rows],q)}:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:N,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:G,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:v,columnResizingEnabled:C,rowLevelResizingEnabled:C,onScroll:function(){return r.onScroll()}}},U.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip(),this.supportsOnObject&&this.subSelectionHelper&&this.formatMode&&(this.subSelectionHelper.onVisualScroll(),this.subSelectionHelper.clearHoveredOutline()),this.enableCalculationHighlighting&&this.annotationHelper&&this.allowAnnotationHighlights&&this.annotationHelper.onVisualScroll()},U.prototype.onWhitespaceClick=function(r){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),r){var v=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(v)}},U.prototype.onHyperlinkClicked=function(r,v){this.hostServices.onHyperlinkClick(r,v)},U.prototype.onItemClick=function(r,v,C){if(!this.selectionManager.isDrillingEnabled(r,v,C))if(C===w.D.ColumnHeader&&this.sortingManager.isColumnHeaderSortable(r))this.options.sorting.enabled&&this.sortingManager.sortColumnHeader(r);else{var S=w.l.getMatchingItem(r,C,this.rowHierarchyNavigator.getHierarchyItems(),this.columnHierarchyNavigator.getHierarchyItems(),this.rowHierarchyNavigator),x=W.M.isCtrlOrMeta(v)||1===this.hostServices.dataMultiSelectMode()?3:0;S&&(this.selectionManager.select(S,C,x),this.renderSelection())}},U.prototype.onRowHeaderFocus=function(r){(0,s.MX)(r,this.valueLabel,!1,this.totalLabel);var C=[],S=this.rowHierarchyNavigator.getExpansionState(r);if(!this.pivotTableControl.getSteppedLayout()&&1!==S){var x=this.rowHierarchyNavigator.getNodeLeafCount(r);x>1&&C.push(this.hostServices.getLocalizedString("SpansXRows",x))}if(this.rowHierarchyNavigator.isMultiLevelHierarchy()){var E=this.getHierarchyLevelInfo(r);C.push(E)}if(this.rowHierarchyNavigator.getLevel(r)>0){var N=this.rowHierarchyNavigator.getParent(r).children.length,G=this.rowHierarchyNavigator.getIndex(r)+1;this.pivotTableControl.getSteppedLayout()&&(N-=1,G-=1),C.push(this.hostServices.getLocalizedString("Generic_ListPosition",G,N))}this.hostServices.alertScreenReader((0,s.IP)({displayNameParts:[],valueParts:[]},C))},U.prototype.onColumnHeaderFocus=function(r){(0,s.MX)(r,this.valueLabel,!1,this.totalLabel);var C=[],S=this.columnHierarchyNavigator.getNodeLeafCount(r);if(S>1&&C.push(this.hostServices.getLocalizedString("SpansXColumns",S)),this.columnHierarchyNavigator.isMultiLevelHierarchy()){var x=this.getHierarchyLevelInfo(r);C.push(x)}if(this.columnHierarchyNavigator.getLevel(r)>0){var E=this.columnHierarchyNavigator.getParent(r).children.length,N=this.columnHierarchyNavigator.getIndex(r)+1;C.push(this.hostServices.getLocalizedString("Generic_ListPosition",N,E))}this.hostServices.alertScreenReader((0,s.IP)({displayNameParts:[],valueParts:[]},C))},U.prototype.onHeaderExpansionChange=function(r,v,C){var S=this.selectionManager.createSelectorsByColumn(r),x=this.selectionManager.getHierarchyNodeIndex(r);this.hostServices.setNodeExpansionState({dataRoles:v,data:S,isCollapse:C,nodeIndex:x})},U.prototype.onItemContextMenu=function(r,v,C,S){var x;C.stopPropagation(),C.preventDefault(),this.selectionManager.onItemContextMenu(r,v,C,[S],u.FX.PropUnfrozenRowHeaders.getValue(null===(x=this.dataView)||void 0===x?void 0:x.metadata.objects))},U.prototype.onCornerCellClick=function(r,v){this.options.sorting.enabled&&this.sortingManager.isCornerSortable(r)&&this.sortingManager.sortCorner(r)},U.prototype.onCornerCellContextMenu=function(r,v){},U.prototype.onCornerCellFocus=function(r){(0,s.p_)(r),this.hostServices.alertScreenReader((0,s.IP)({displayNameParts:[],valueParts:[]}))},U.prototype.onContentActivation=function(r,v){H.fF.assertValue(r,"onContentActivated - null cellElement");var C=r.querySelector("a");C&&C.dispatchEvent(v)},U.prototype.switchRowHeadersLayout=function(r){this.pivotTableControl.setSteppedLayout(r),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.binder.setRowNavigator(this.rowHierarchyNavigator)},U.prototype.onBindRowHeader=function(r){this.needsMoreData(r)&&(setTimeout(this.hostServices.loadMoreData),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},U.prototype.needsMoreData=function(r){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var C=this.rowHierarchyNavigator.getHierarchyLeafCount()*U.preferredLoadMoreThreshold;return this.rowHierarchyNavigator.getLeafIndex(r)>=C},U.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,Ce.Y.PivotTable,this.expandCollapseEnabled,this.featureSwitches,this.style)},U.prototype.enumerateObjectInstances=function(r){var v=this,C=new O.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(r,C,this.dataView,Ce.Y.PivotTable,function(S){for(var x,E=[],N=1;N<arguments.length;N++)E[N-1]=arguments[N];return(x=v.hostServices).getLocalizedString.apply(x,(0,Q.ev)([S],E||[],!1))},this.featureSwitches,this.expandCollapseEnabled,this.style),C.complete()},U.prototype.enumerateObjectRepetition=function(){var r=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(r,this.dataView,Ce.Y.PivotTable,this.featureSwitches),r},U.prototype.getHierarchyLevelInfo=function(r){return"".concat(this.hostServices.getLocalizedString("Level")," ").concat(this.rowHierarchyNavigator.getLevel(r)+1)},U.prototype.setExpandCollapseEnabled=function(){this.expandCollapseEnabled=this.hostServices.canExpandCollapse([I.r.rows])&&"hidden"!==this.options.expandCollapse.buttonsOption},U.prototype.getSubSelectables=function(r){return this.subSelectionHelper.getAllSubSelectables(r)},U.prototype.updateOutlinesFromAnnotations=function(){var r=this;this.annotationHighlightElementToRegionIdMap.clear(),this.annotationHelper.hideAllOutlines(!0);var v=function(U){var r;if(U){var v={};return _.forEach(null===(r=U.metadata)||void 0===r?void 0:r.columns,function(C){var S;if(null!==(S=C.objects)&&void 0!==S&&S.annotations){var x=C.queryName,E=(0,se.NA)(C.objects,L.t.annotations.highlights);x&&E&&(v[x]=E)}}),v}}(this.dataView);if(_.isEmpty(v))this.annotationHelper.renderOutlines();else{var C=this.pivotTableControl,S=C.getViewport(),x=X.sW.getVisibleRange(S.left,S.width,C.getColumnWidthMeasureManager());if(x){var E=X._E.getVisibleRange(S.top,S.height,C.getRowHeightMeasureManager());if(E){var N=C.getMidRenderer(),J=function(U,r,v,C){for(var S,x=new Set(U),E={},N=r.firstLeafIndex;N<=r.lastLeafIndex;N++)for(var G=v.firstLeafIndex;G<=v.lastLeafIndex;G++){var J=C.getElementByIndex(G,N,Y.aP.Main);if(J){var Z=C.getItemByElement(J),q=null===(S=Z?.columnMetadata)||void 0===S?void 0:S.queryName;if(q&&x.has(q)){var oe=E[q];null==oe&&(E[q]=oe=[]),oe.push(J)}}}return E}(_.keys(v),x,E,N);_.forEach(J,function(Z,q){_.forEach(Z,function(ye){r.annotationHighlightElementToRegionIdMap.set(ye,"".concat("fullColumn","_").concat(q))});var oe={showHandles:!1,thickness:2},he=v[q].color;he&&(oe.color=he),r.annotationHelper.updateOutlinesFromSubSelectionElements(Z,2,oe)}),this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}else this.annotationHelper.renderOutlines()}},U.prototype.getAnnotationHighlightElementSubSelectionOutlineRegionId=function(r){var v=this.annotationHighlightElementToRegionIdMap.get(r);return H.fF.assert(function(){return null!=v},"the given element should have an entry in this.annotationHighlightElementToRegionIdMap"),v},U.prototype.annotationHighlightOnScrollStart=function(){this.annotationHelper.hideAllOutlines()},U.prototype.annotationHighlightOnScrollEnd=function(){this.updateOutlinesFromAnnotations()},U.preferredLoadMoreThreshold=.8,U}()},11184:function(Fe,Me,B){B.d(Me,{Q:function(){return te},S:function(){return Y}});var Q=B(81337),de=B(55007),se=B(62458),te=function(){function D(W){this.matrixNavigator=W}return D.prototype.setHierarchy=function(W){this.hierarchy=W,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},D.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},D.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},D.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},D.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},D.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},D.prototype.getHierarchyLeafAt=function(W){return this.hierarchy.leafNodes[W]},D.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},D.prototype.getFloatingHierarchyLeafAt=function(W){return this.floatingLeaves[W]},D.prototype.isBlank=function(W){return W.isBlankRow},D.prototype.isBlankRow=function(W){return this.getHierarchyLeafAt(W).isBlankRow},D.prototype.numberOfBlankRowsBefore=function(W){var X=this.getHierarchyLeafAt(W),z=this.getAncestor(X);return Math.floor(z.index/2)},D.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},D.prototype.getFloatingHierarchyItems=function(){return null},D.prototype.getLeafIndex=function(W){return this.matrixNavigator.getLeafIndex(W)},D.prototype.isLeaf=function(W){return this.matrixNavigator.isLeaf(W)},D.prototype.isLastItem=function(W,X){return this.matrixNavigator.isLastItem(W,X)},D.prototype.getAncestor=function(W){for(;W.parent;)W=W.parent;return W},D.prototype.getParent=function(W){return this.matrixNavigator.getParent(W)},D.prototype.getIndex=function(W){return this.matrixNavigator.getIndex(W)},D.prototype.getNodeLeafCount=function(W){var X=this;return this.isLeaf(W)?1:_.sum(_.map(W.children,function(z){return X.getNodeLeafCount(z)}))},D.prototype.getIndexOfFirstLeaf=function(W){for(;!_.isEmpty(W.children);)W=W.children[0];return this.getLeafIndex(W)},D.prototype.getPathIndices=function(W){for(var X=[this.getIndex(W)],z=this.getParent(W);z;)X=(0,Q.ev)([this.getIndex(z)],X||[],!0),z=this.getParent(z);return X},D.prototype.getNodeFromPath=function(W){var X=this.hierarchy.levels.length||1;if(!(_.isEmpty(W)||W.length>X)){for(var z=this.hierarchy.root,K=0,m=W;K<m.length;K++)if(!(z=z.children[m[K]]))return;return z}},D.prototype.getLeafAncestorAtLevel=function(W,X,z){if(se.fF.assertValue(W,"Undefined leaf node"),se.fF.assert(function(){return X>=0},"Invalid target level"),!(X>this.getLevel(W))){for(var K=W;this.getLevel(K)>X;){if(K=this.getParent(K),z&&this.getLevel(K)<X)return;se.fF.assertValue(K,"reached root without finding a matching ancestor")}return K}},D.prototype.getItemsByLevel=function(W){var X=[];return this.findLevelItems(W,this.hierarchy.root,-1,X),X},D.prototype.findLevelItems=function(W,X,z,K){if(!_.isEmpty(X.children))for(var m=z+1,H=0,n=X.children;H<n.length;H++){var s=n[H];m===W||m+this.matrixNavigator.getChildrenLevelDifference(s)>W?K.push(s):m<W&&this.findLevelItems(W,s,m,K)}},D.prototype.getExpansionState=function(W){return W.isCollapsed?1:!1===W.isCollapsed?0:2},D.prototype.getChildren=function(W){return this.matrixNavigator.getChildren(W)},D.prototype.getLevel=function(W){return this.matrixNavigator.getLevel(W)},D.prototype.getIntersection=function(W,X){var z=this.matrixNavigator.getIntersection(W,X);return z&&z.objects&&(z.icon=de.FX.PropValuesIcon.getValue(z.objects),z.hyperlink=de.FX.PropValuesWebURL.getValue(z.objects),z.altText=de.FX.PropAltTextValue.getValue(z.objects)),z},D.prototype.getCorner=function(W,X){return this.matrixNavigator.getCorner(W,X)},D.prototype.getRowLevel=function(W){return W.rowLevel},D.prototype.getColumnLevel=function(W){return W.columnLevel},D.prototype.getRowHeaderMetadataColumn=function(W){return this.matrixNavigator.getRowHeaderMetadataColumn(W)},D.prototype.getRowHeaderMetadataColumns=function(W){return this.matrixNavigator.getRowHeaderMetadataColumns(W)},D.prototype.getColumnHeaderMetadataColumn=function(W){return this.matrixNavigator.getColumnHeaderMetadataColumn(W)},D.prototype.getColumnHeaderMetadataColumns=function(W){return this.matrixNavigator.getColumnHeaderMetadataColumns(W)},D.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},D.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},D.prototype.isColumnHeaderMultiValueSubtotal=function(W){return W.isSubtotal&&W.parent&&W.parent.isSubtotal},D.prototype.isRowHeaderMultiValueSubtotal=function(W){return this.valuesOnRowApplied()&&W.parent&&W.parent.isSubtotal},D.prototype.getLeaves=function(W,X){if(!_.isEmpty(W))for(var z=0,K=W;z<K.length;z++){var m=K[z];this.isLeaf(m)?X.push(m):this.getLeaves(this.getChildren(m),X)}},D.prototype.getColumnIndexFromQueryName=function(W){return null},D}(),Y=function(D){function W(){return null!==D&&D.apply(this,arguments)||this}return(0,Q.ZT)(W,D),W.prototype.getIntersection=function(X,z){return this.isLeaf(X)||_.isEmpty(X.children)||!X.children[0].isSubtotal||this.valuesOnRowApplied()?D.prototype.getIntersection.call(this,X,z):D.prototype.getIntersection.call(this,X.children[0],z)},W.prototype.getChildren=function(X){return se.fF.assertValue(X,"item"),!_.isEmpty(X.children)&&X.children[0].isSubtotal?X.children.slice(1):X.children},W.prototype.getHierarchyDepth=function(){return D.prototype.getHierarchyDepth.call(this)>0?1:0},W.prototype.getCorner=function(X,z){var K=z===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return D.prototype.getCorner.call(this,K,z)},W.prototype.getFloatingHierarchyItems=function(){var X=this.getHierarchyItems();if(_.isEmpty(X))return null;for(var z=0,K=[];;){var m=X[z];if(!m||!m.isSubtotal)break;K.push(m),z++}return _.isEmpty(K)?null:K},W.prototype.isRowHeaderMultiValueSubtotal=function(X){return this.valuesOnRowApplied()&&X.isSubtotal},W.prototype.getLeaves=function(X,z){if(!_.isEmpty(X))for(var K=0,m=X;K<m.length;K++){var H=m[K];z.push(H),this.getLeaves(this.getChildren(H),z)}},W.prototype.getPathIndices=function(X){return[this.getLeafIndex(X)]},W.prototype.getNodeFromPath=function(X){if(1===X.length)return this.getHierarchyLeafAt(X[0])},W.prototype.getItemsByLevel=function(X){return se.fF.assert(function(){return 0===X},"Stepped PivotTable rows hierarchy has 1 level"),(0,Q.ev)([],this.getHierarchyLeafNodes()||[],!0)},W.prototype.getLeafAncestorAtLevel=function(X,z){return se.fF.assert(function(){return 0===z},"Stepped PivotTable rows hierarchy has 1 level"),se.fF.assertValue(X,"Undefined leaf node"),X},W}(te)},76797:function(Fe,Me,B){B.d(Me,{D:function(){return z},l:function(){return m}});var Q=B(81337),de=B(85196),se=B(66232),te=B(62458),Y=B(78843),D=B(93340),W=B(71090),X=B(21242),z=function(H){return H[H.RowHeader=0]="RowHeader",H[H.ColumnHeader=1]="ColumnHeader",H[H.BodyCell=2]="BodyCell",H}({});function K(H){return 0===H.type}var m=function(){function H(n,s){this.hostServices=n,this.featureSwitches=s,this.clearLocal()}return H.prototype.onItemContextMenu=function(n,s,p,I,F){var b;(0,se.n)(p),!this.isEmpty()&&this.isItemSelected(n,!0)?(b=this.selectedItems,s=this.selectionMode):b=[n];var O=this.createContextMenuArgs(n,s,b,p,I,F);O&&this.hostServices.onContextMenu(O)},H.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},H.prototype.isDrillingEnabled=function(n,s,p){var I=this.createSelectingArgs(n,p,s);return this.hostServices.onSelecting(I),1===I.action},H.prototype.select=function(n,s,p){this.updateSelection(n,s,p,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(n)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,p))},H.prototype.getSelectionScreenReaderMessage=function(n){var s,p,I;switch(this.indicatorStyle){case z.RowHeader:p=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n));var F=1===this.rowHierarchyNavigator.getExpansionState(n);s=_.isEmpty(this.selectedItems)?!p||n.isSubtotal||F?"Row_Group_Unselected":"Row_Unselected":!p||n.isSubtotal||F?"Row_Group_Selected":"Row_Selected";break;case z.ColumnHeader:I=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n)),s=_.isEmpty(this.selectedItems)?I&&!n.isSubtotal?"Column_Unselected":"Column_Group_Unselected":I&&!n.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case z.BodyCell:p=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.rowItem)),I=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.columnItem)),s=_.isEmpty(this.selectedItems)?p&&I&&!n.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":p&&I&&!n.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:s="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(s)},H.prototype.getIndicatorStyle=function(){return this.indicatorStyle},H.prototype.updateSelection=function(n,s,p,I){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in n&&(n.isRowAndColumnGrandTotal||n.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!I&&s!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(n))if(this.isItemSelected(n,I)){if(I)return!1;1===this.selectedItems.length&&1!==p?this.clearLocal():3===p?this.unselectItem(n):0===p&&(this.selectedItems=[n])}else(0===p||s!==this.selectionMode)&&this.clearLocal(),this.selectionMode=s,this.indicatorStyle=s,this.selectedItems.push(n),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[n]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return n.isRowGrandTotal?this.indicatorStyle=z.ColumnHeader:n.isColumnGrandTotal&&(this.indicatorStyle=z.RowHeader),!0},H.prototype.isRowHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,p=this.selectedItems;s<p.length;s++)if(this.isRowHeaderOnSelectedPath(p[s],n))return!0;return!1},H.prototype.isColumnHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,p=this.selectedItems;s<p.length;s++)if(this.isColumnHeaderOnSelectedPath(p[s],n))return!0;return!1},H.prototype.isRowHeaderIndicatorOn=function(n,s){var p=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(b){return p.isRowHeaderOnSelectedPath(b,n,!0,!s)})&&!(this.indicatorStyle===z.ColumnHeader)},H.prototype.isRowHeaderDarkened=function(n){var s=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(F){return s.isRowHeaderOnSelectedPath(F,n,!0,!1)})&&this.indicatorStyle===z.RowHeader},H.prototype.isColumnHeaderIndicatorOn=function(n){var s=this;if(!this.featureSwitches.a11yMatrix)return!1;var p=this.columnHierarchyNavigator.isLeaf(n),I=_.some(this.selectedItems,function(b){return s.isColumnHeaderOnSelectedPath(b,n)});return p&&I&&!(this.indicatorStyle===z.RowHeader)},H.prototype.isColumnHeaderDarkened=function(n){var s=this;return _.some(this.selectedItems,function(F){return s.isColumnHeaderOnSelectedPath(F,n)})&&!(this.indicatorStyle===z.RowHeader)},H.prototype.isBodyCellHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,p=this.selectedItems;s<p.length;s++)if(this.isBodyCellOnSelectedPath(p[s],n))return!0;return!1},H.prototype.isBodyCellIndicatorOn=function(n){if(this.isEmpty())return!1;for(var s=0,p=this.selectedItems;s<p.length;s++)if(this.isBodyCellOnSelectedPath(p[s],n)&&this.indicatorStyle===z.BodyCell)return!0;return!1},H.prototype.isRowHeaderOnSelectedPath=function(n,s,p,I){return this.indicatorStyle===z.ColumnHeader||(F=K(n)?n.rowItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(F),s,p,I));var F},H.prototype.isColumnHeaderOnSelectedPath=function(n,s){return this.indicatorStyle===z.RowHeader||(p=K(n)?n.columnItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(p),s));var p},H.prototype.isBodyCellOnSelectedPath=function(n,s){return this.isRowHeaderOnSelectedPath(n,s.rowItem)&&this.isColumnHeaderOnSelectedPath(n,s.columnItem)},H.prototype.isOnSelectedPath=function(n,s,p,I){if(!n||n===s)return!0;var F=n;if(!p)for(;F;){if(F===s)return!0;F=F.parent}if(F=s,!I)for(;F;){if(F===n)return!0;F=F.parent}return!1},H.prototype.onDataViewChanged=function(n,s){this.rowHierarchyNavigator=n,this.columnHierarchyNavigator=s;var p=n&&n.getHierarchyItems(),I=s&&s.getHierarchyItems();if(!this.isEmpty()){for(var F=[],b=0,O=this.selectedItems;b<O.length;b++){var k=O[b],V=H.getMatchingItem(k,this.selectionMode,p,I,n);F.push(V||k)}this.selectedItems=F}},H.getMatchingItem=function(n,s,p,I,F){if(n.isBlankRow)return null;switch(s){case z.RowHeader:return this.getMatchingHeader(n,p);case z.ColumnHeader:return this.getMatchingHeader(n,I);case z.BodyCell:var b=n,O=this.getMatchingHeader(b.rowItem,p),k=this.getMatchingHeader(b.columnItem,I);return O&&k?F.getIntersection(O,k):null}},H.getMatchingHeader=function(n,s){if(s)for(var p=0,I=s;p<I.length;p++){var F=I[p];if(this.areHeadersEqual(n,F))return F;var b=this.getMatchingHeader(n,F.children);if(b)return b}return null},H.areHeadersEqual=function(n,s){if(te.fF.assert(function(){return!!n&&!!s},"items cannot be null"),(0,Y.fS)(n.identity,s.identity)&&n.queryName===s.queryName){if(!n.parent&&!s.parent)return!0;if(n.parent&&s.parent)return this.areHeadersEqual(n.parent,s.parent)}return!1},H.getMatchingItemById=function(n,s,p,I,F){var b=_.keys(n.dataMap),O=_.chain(F.getColumnHierarchy().levels).filter(function(u){return!u.sources[0].isMeasure}).map(function(u){return u.sources[0].queryName}).filter(function(u){return _.includes(b,u)}).value(),k=_.chain(F.getRowHierarchy().levels).map(function(u){return u.sources[0].queryName}).filter(function(u){return _.includes(b,u)}).value();switch(s){case z.RowHeader:return this.getMatchingHeaderById(n,k,p);case z.ColumnHeader:return this.getMatchingHeaderById(n,O,I);case z.BodyCell:var V=this.getMatchingHeaderById(n,k,p),R=this.getMatchingHeaderById(n,O,I);return V&&R?F.getIntersection(V,R):null}},H.getMatchingHeaderById=function(n,s,p){if(p)for(var I=0,F=p;I<F.length;I++)for(var b=F[I],O=function(d,l){var h=s[d];if(k.headerMatchesId(n,h,b)){if(1===l)return{value:b};te.fF.assertAnyValue(b.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var y=k.getMatchingHeaderById(n,_.filter(s,function(g){return g!==h}),b.children);if(y)return{value:y}}},k=this,V=0,R=s.length;V<R;V++){var u=O(V,R);if("object"==typeof u)return u.value}return null},H.headerMatchesId=function(n,s,p){return te.fF.assert(function(){return!!n&&!!p},"items cannot be null"),!!(s===p.queryName&&n.dataMap&&n.dataMap[s]&&(0,Y.fS)(_.head(n.dataMap[s]),p.identity))},H.areCornerItemsEqual=function(n,s){return!(!n.metadata||!s.metadata)&&n.metadata.queryName===s.metadata.queryName},H.prototype.clearLocal=function(){this.selectedItems=[]},H.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},H.prototype.restoreSelectionState=function(n,s){if(this.clearLocal(),_.isEmpty(n))return!0;for(var p=!1,I=this.selectedItems,F=0,b=n;F<b.length;F++){var O=b[F],k=this.determineSelectionModeFromIds(O,s);if(null!=k){this.selectionMode=k,this.indicatorStyle=k;var V=H.getMatchingItemById(O,k,s.getRowHierarchy().root.children,s.getColumnHierarchy().root.children,s);V&&(I.push(V),p=!0,V.isRowGrandTotal?this.indicatorStyle=z.ColumnHeader:V.isColumnGrandTotal&&(this.indicatorStyle=z.RowHeader))}}return p},H.prototype.determineSelectionModeFromIds=function(n,s){if(!n)return this.selectionMode;var p=_.map(s.getColumnHierarchy().levels,function(k){return k.sources[0].queryName}),I=!1,F=_.map(s.getRowHierarchy().levels,function(k){return k.sources[0].queryName}),b=!1;for(var O in n.dataMap)if(_.includes(p,O))I=!0;else{if(!_.includes(F,O))return;b=!0}return I&&b?z.BodyCell:I?z.ColumnHeader:b?z.RowHeader:void 0},H.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},H.prototype.isItemSelected=function(n,s){void 0===s&&(s=!1);for(var p=K(n)?n:void 0,I=0,F=this.selectedItems;I<F.length;I++){var b=F[I];if(K(b)&&p){if(this.areBodyCellsEqual(b,p))return!0}else if(b===n)return!0}return!(!s||this.isEmpty()||!p)&&this.isBodyCellHighlighted(p)},H.prototype.unselectItem=function(n){var s=this;K(n)?_.remove(this.selectedItems,function(p){return s.areBodyCellsEqual(p,n)}):_.pull(this.selectedItems,n)},H.prototype.areBodyCellsEqual=function(n,s){return n.rowItem===s.rowItem&&n.columnItem===s.columnItem},H.prototype.getEffectiveSelectedHeader=function(n){return n&&!n.identity&&n.parent?this.getEffectiveSelectedHeader(n.parent):n},H.prototype.getEffectiveSelectedNodes=function(n){return n.parent?[this.getEffectiveSelectedHeader(n)]:n.identity?[n]:n.siblings},H.getRoleNames=function(n){switch(n){case z.ColumnHeader:return[de.r.columns];case z.RowHeader:return[de.r.rows];case z.BodyCell:return[de.r.values];default:te.fF.assertFail("unexpected PivotTableSelectionMode")}},H.prototype.createSelectingArgs=function(n,s,p){return{type:0,visualObjects:this.getVisualObjects([n]),position:H.getMouseEventPosition(p),dataRoles:H.getRoleNames(s)}},H.prototype.createSelectArgs=function(n,s){for(var p=[],I=0,F=n;I<F.length;I++){var O=this.createSelectorsByColumn(F[I]);O&&p.push({objectName:"",selectorsByColumn:O})}return{type:0,visualObjects:this.getVisualObjects(n),selectionMode:s}},H.prototype.getVisualObjects=function(n){for(var s=[],p=0,I=n;p<I.length;p++){var b=this.createSelectorsByColumn(I[p]);b&&s.push({objectName:"",selectorsByColumn:b})}return s},H.prototype.createContextMenuArgs=function(n,s,p,I,F,b){for(var k,V,R,u,c,d,O=this,l=[],h=0,y=p;h<y.length;h++){var P=this.createSelectorsByColumn(y[h]);P&&l.push(P)}var t,a={dataRoles:F,data:l,position:H.getMouseEventPosition(I)};if(K(n)||(a.nodeIndex=this.getHierarchyNodeIndex(n)),(_.isEmpty(l)||l.every(function(f){return _.isEmpty(f.dataMap)}))&&K(n)&&n.isRowAndColumnGrandTotal){var e=null===(R=null===(V=null===(k=n.columnMetadata)||void 0===k?void 0:k.type)||void 0===V?void 0:V.misc)||void 0===R?void 0:R.sparkline;return a.copyArgs={singleValue:function(){return e?n.textContent:String(n.dataPoint)}},a}if(K(n))if(null===(d=null===(c=null===(u=n.columnMetadata)||void 0===u?void 0:u.type)||void 0===c?void 0:c.misc)||void 0===d?void 0:d.sparkline)t=n.textContent;else{var o=n.dataPoint;null!=o&&(t=(0,D.pW)(o))}else t=n.tooltipValueFormatted;return a.copyArgs={grid:function(){return O.generateGridCopyCallback(p,s)}},void 0!==t&&(a.copyArgs.singleValue=function(){return String(t)}),this.featureSwitches.a11yShowAsMatrix&&(a.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,Q.mG)(O,void 0,void 0,function(){return(0,Q.Jh)(this,function(M){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,Q.mG)(O,void 0,void 0,function(){return(0,Q.Jh)(this,function(M){return[2,!b]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,Q.mG)(O,void 0,void 0,function(){return(0,Q.Jh)(this,function(M){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,Q.mG)(O,void 0,void 0,function(){return(0,Q.Jh)(this,function(M){return[2,b]})})}}]),a},H.prototype.generateGridCopyCallback=function(n,s){var F,p=n.slice(),I=[];switch(s){case z.BodyCell:p=this.collectSelectedBodyNodes(p),F=(0,X.kH)(p,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),I.push.apply(I,(0,Q.ev)([F.headers],F.values||[],!1));break;case z.ColumnHeader:for(var b=[],O=0,k=p;O<k.length;O++){var V=k[O];this.columnHierarchyNavigator.isLeaf(V)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(V).isMeasure?b.push.apply(b,V.siblings||[]):b.push(V)}F=(0,X.mM)([],p=b,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),I.push.apply(I,(0,Q.ev)([F.headers],F.values||[],!1));break;case z.RowHeader:F=(0,X.mM)(p,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(W.yF)),I.push.apply(I,(0,Q.ev)([F.headers],F.values||[],!1));break;default:te.fF.assertNever(s)}return{grid:I,coveragePercentage:F?F.coveragePercentage:void 0}},H.prototype.getHierarchyNodeIndex=function(n){for(var s=[];n&&null!=n.index;)s.splice(0,0,n.index),n=n.parent;return s},H.prototype.collectSelectedBodyNodes=function(n){for(var s=[],p=0,I=n;p<I.length;p++){var F=I[p];if(!F.isSubtotal&&F.columnItem.identity&&F.rowItem.identity)s.push(F);else{var b=[],O=[];F.isRowGrandTotal||(b=this.getEffectiveSelectedNodes(F.rowItem)),F.isColumnGrandTotal||(O=this.getEffectiveSelectedNodes(F.columnItem));var k=(0,X.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,b,O);s.push.apply(s,k||[])}}for(var V=0;V<s.length;V++)for(var R=s[V],u=V+1;u<s.length;u++)_.isEqual(R,s[u])&&(s.splice(u,1),u--);return s},H.prototype.createSelectorsByColumn=function(n){return K(n)?this.createSelectorsByColumnForBodyCell(n):this.createSelectorsByColumnForHeader(n)},H.prototype.createSelectorsByColumnForHeader=function(n){var s=n.queryName,p={};return H.addHeaderIdentities(n,p)?{dataMap:p,metadata:[s]}:void 0},H.prototype.createSelectorsByColumnForBodyCell=function(n){var s,p={},I=H.addHeaderIdentities(n.rowItem,p),F=H.addHeaderIdentities(n.columnItem,p),b=null===(s=n.columnMetadata)||void 0===s?void 0:s.queryName;return te.fF.assert(function(){return I||F||!!b},"Must have a row or column identity or column metadata"),{dataMap:p,metadata:b?[b]:void 0}},H.addHeaderIdentities=function(n,s){for(var p=[];n;)n.identity&&p.splice(0,0,n),n=n.parent;for(var I=0,F=p;I<F.length;I++){var b=F[I];s[b.queryName]=[b.identity]}return p.length>0},H.hasIdentity=function(n){return H.addHeaderIdentities(n,{})},H.getMouseEventPosition=function(n){return{x:n.clientX,y:n.clientY}},H}()},59784:function(Fe,Me,B){B.d(Me,{S:function(){return de}});var Q=B(76797),de=function(){function se(te){this.hostServices=te}return se.prototype.onDataViewChanged=function(te,Y,D,W,X){this.isSteppedLayout=W,this.valuesOnRowApplied=X,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(te),this.valueSources=D,this.hasRows=te&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=Y&&!_.isEmpty(Y.levels),this.measureCount=D?D.length:0},se.hasSortingChanged=function(te,Y){if(!te||!Y)return!1;var D=te.metadata.columns;if(_.isEmpty(D))return!1;var W=Y.metadata.columns;if(_.isEmpty(W))return!1;for(var X=function(s){var p=_.find(D,function(I){return s.queryName===I.queryName});if(p&&s.sort!==p.sort)return{value:!0}},z=0,K=W;z<K.length;z++){var H=X(K[z]);if("object"==typeof H)return H.value}return!1},se.prototype.isCornerSortable=function(te){return this.hasRows&&null!=te.metadata&&te.position.row.isLast&&(!this.valuesOnRowApplied||!te.position.column.isLast)},se.prototype.getNonMeasureRowLevels=function(te){if(this.valuesOnRowApplied){var Y=[];return Y.push.apply(Y,te.levels||[]),Y.pop(),Y}return te.levels},se.prototype.isColumnHeaderSortable=function(te){var Y=Q.l.hasIdentity(te);return this.hasRows&&this.measureCount>0&&!Y&&te.position.row.isLast&&!this.valuesOnRowApplied},se.prototype.getCornerSortDirection=function(te){if(!this.isCornerSortable(te))return null;if(this.isSteppedLayout){for(var Y=null,D=0,W=this.nonMeasureRowLevels;D<W.length;D++){var X=W[D];if(1!==X.sources.length)return null;var z=X.sources[0].sort;if(null==z)return null;if(null!==Y){if(z!==Y)return null}else Y=z}return Y}return this.nonMeasureRowLevels[te.position.column.index].sources[0].sort},se.prototype.getColumnHeaderSortDirection=function(te){return this.isColumnHeaderSortable(te)?this.getMeasureSortDirection(this.getMeasureQueryName(te)):null},se.prototype.getMeasureQueryName=function(te){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:te.queryName},se.prototype.sortCorner=function(te){var W,Y=this.getCornerSortDirection(te),D=se.getNextSortDirection(Y);if(this.isSteppedLayout){W=[];for(var X=0,z=this.nonMeasureRowLevels;X<z.length;X++)W.push({queryName:z[X].sources[0].queryName,sortDirection:D})}else W=[{queryName:te.metadata.queryName,sortDirection:D}];this.hostServices.onCustomSort({sortDescriptors:W,suppressAnnouncements:!0})},se.prototype.sortColumnHeader=function(te){var Y=this.getColumnHeaderSortDirection(te),D=this.getMeasureColumn(this.getMeasureQueryName(te));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(te),sortDirection:se.getNextSortDirection(Y,D)}],suppressAnnouncements:!0})},se.getNextSortDirection=function(te,Y){return void 0===te?se.getDefaultSortDirection(Y):1===te?2:1},se.getDefaultSortDirection=function(te){return te&&te.isMeasure&&te.type&&te.type.numeric&&!te.type.temporal?2:1},se.prototype.getMeasureSortDirection=function(te){var Y=this.getMeasureColumn(te);if(null!=Y)return Y.sort},se.prototype.getMeasureColumn=function(te){return _.find(this.valueSources,function(Y){return Y.queryName===te})},se}()}}]);