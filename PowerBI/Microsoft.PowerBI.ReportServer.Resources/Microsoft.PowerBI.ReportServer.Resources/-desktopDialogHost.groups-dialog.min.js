"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["groups-dialog"],{70049:function(ce,X,g){g.d(X,{P:function(){return j},d:function(){return J}});var m=g(37419),u=g(73449),J={leading:!0,trailing:!1};function j(B,w){return void 0===w&&(w=J),function(S){return S.lift(new W(B,!!w.leading,!!w.trailing))}}var W=function(){function B(S,f,C){this.durationSelector=S,this.leading=f,this.trailing=C}return B.prototype.call=function(f,C){return C.subscribe(new Y(f,this.durationSelector,this.leading,this.trailing))},B}(),Y=function(B){function w(f,C,h,O){var T;return(T=B.call(this,f)||this).destination=f,T.durationSelector=C,T._leading=h,T._trailing=O,T._hasValue=!1,T}(0,m.Z)(w,B);var S=w.prototype;return S._next=function(C){this._hasValue=!0,this._sendValue=C,this._throttled||(this._leading?this.send():this.throttle(C))},S.send=function(){var h=this._sendValue;this._hasValue&&(this.destination.next(h),this.throttle(h)),this._hasValue=!1,this._sendValue=void 0},S.throttle=function(C){var h=this.tryDurationSelector(C);h&&this.add(this._throttled=(0,u.ft)(h,new u.IY(this)))},S.tryDurationSelector=function(C){try{return this.durationSelector(C)}catch(h){return this.destination.error(h),null}},S.throttlingDone=function(){var C=this._throttled,h=this._trailing;C&&C.unsubscribe(),this._throttled=void 0,h&&this.send()},S.notifyNext=function(){this.throttlingDone()},S.notifyComplete=function(){this.throttlingDone()},w}(u.Ds)},55862:function(ce,X,g){g.d(X,{p:function(){return W}});var m=g(37419),u=g(47875),J=g(96721),j=g(70049);function W(S,f,C){return void 0===f&&(f=J.P),void 0===C&&(C=j.d),function(h){return h.lift(new Y(S,f,C.leading,C.trailing))}}var Y=function(){function S(C,h,O,T){this.duration=C,this.scheduler=h,this.leading=O,this.trailing=T}return S.prototype.call=function(h,O){return O.subscribe(new B(h,this.duration,this.scheduler,this.leading,this.trailing))},S}(),B=function(S){function f(h,O,T,U,pe){var o;return(o=S.call(this,h)||this).duration=O,o.scheduler=T,o.leading=U,o.trailing=pe,o._hasTrailingValue=!1,o._trailingValue=null,o}(0,m.Z)(f,S);var C=f.prototype;return C._next=function(O){this.throttled?this.trailing&&(this._trailingValue=O,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(w,this.duration,{subscriber:this})),this.leading?this.destination.next(O):this.trailing&&(this._trailingValue=O,this._hasTrailingValue=!0))},C._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},C.clearThrottle=function(){var O=this.throttled;O&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),O.unsubscribe(),this.remove(O),this.throttled=null)},f}(u.L);function w(S){S.subscriber.clearThrottle()}},82584:function(ce,X,g){g.r(X),g.d(X,{GroupsDialogModule:function(){return ln}});var m=g(81337),u=g(62458),J={min:1,max:1e6,step:1},j=864e5,W=[11,10,9,8,6,4];function f(l){switch(l.primitiveType){case 4:return{min:1,max:1e18,step:1};case 2:return{min:1e-4,max:1e14,step:1e-4};case 3:return{min:1e-300,max:1e300,step:"any"};default:return u.fF.assertFail("Unsupported numeric primitiveType:"+l.primitiveType),{min:1,max:1e18,step:1}}}function C(l,t){switch(l){case 4:return u.fF.assert(function(){return!!t},"Should not call with BinUnit.Year if not allowing approx value."),365*j;case 6:return u.fF.assert(function(){return!!t},"Should not call with BinUnit.Month if not allowing approx value."),30*j;case 8:return j;case 9:return 36e5;case 10:return 6e4;case 11:return 1e3;default:return u.fF.assertFail("Unexpected time unit "+l),1}}function h(l,t){void 0===t&&(t=!1);var e=t?W:W.filter(function(a){return 4!==a&&6!==a});u.fF.assert(function(){return e.length>0},"Expect there is at least one unit to check.");var i,n=C(e[0],t);if(l<n)return e[0];for(i=1;i<e.length;i++){var r=C(e[i],t);if(l>=n&&l<r)return e[i-1];n=r}return e[i-1]}function U(l,t){var e=t.min,n=t.max;if(l<e)return e;if(l>n)return n;var i=t.step;if(_.isString(i))return l;var r=function(l){var t=l.step;if("string"!=typeof t){var e=Math.floor(Math.log(t)/Math.log(.1));return u.fF.assert(function(){return t<10},"Expect step < 10"),u.fF.assert(function(){return t*Math.pow(10,e)==1},"Expect binSizeRange.step is a power of 0.1, such as 0.001"),e}}(t),a=i,c=e+Math.floor((l-e)/a)*a;return null!=r?parseFloat(c.toFixed(r)):c}var o=g(50423),v=g(17174),V=g(42233),Oe=g(72489),N=g(94419),z=g(35510),le=g(30794),Ue=g(59787),ae=g(59017),ke=g(11547),He=g(23558),L=g(83317),H=g(77526),K=g(59973),Z=g(14172),ge=g(83008),ye=g(81213),de=g(28149),Me=g(28894),Ce=g(65181),A=g(77476),fe=g(59968),Q=g(45074),Ae=["resetToOptimalElement"];function je(l,t){if(1&l&&(o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"pbi-form-field",3),o.\u0275\u0275element(2,"label",4)(3,"input",5),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"pbi-form-field",3),o.\u0275\u0275element(5,"label",6)(6,"input",7),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()),2&l){var e=t.ngIf;o.\u0275\u0275advance(3),o.\u0275\u0275property("value",null==e.rangeDisplay?null:e.rangeDisplay.min),o.\u0275\u0275advance(3),o.\u0275\u0275property("value",null==e.rangeDisplay?null:e.rangeDisplay.max)}}var We=function(t){return{rangeDisplay:t}};function Ke(l,t){if(1&l&&(o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275template(1,je,7,2,"ng-container",1),o.\u0275\u0275pipe(2,"async"),o.\u0275\u0275elementContainerEnd()),2&l){var e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",o.\u0275\u0275pureFunction1(3,We,o.\u0275\u0275pipeBind1(2,1,e.fieldValueRangHint$)))}}function Qe(l,t){if(1&l&&o.\u0275\u0275element(0,"input",12),2&l){var e=o.\u0275\u0275nextContext(2);o.\u0275\u0275propertyInterpolate("min",e.staticBySizeOrByCountInfo.bySize.valueRange.min),o.\u0275\u0275propertyInterpolate("max",e.staticBySizeOrByCountInfo.bySize.valueRange.max),o.\u0275\u0275propertyInterpolate("step",e.staticBySizeOrByCountInfo.bySize.valueRange.step),o.\u0275\u0275property("formControlName",e.formControlNames.binSizeInput)}}function Xe(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"option",17),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),2&l){var e=t.$implicit;o.\u0275\u0275property("ngValue",e.unit),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(e.displayName)}}function Je(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"div",13),o.\u0275\u0275element(1,"input",14),o.\u0275\u0275elementStart(2,"select",15),o.\u0275\u0275template(3,Xe,2,2,"option",16),o.\u0275\u0275elementEnd()()),2&l){var e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275propertyInterpolate("min",e.staticBySizeOrByCountInfo.bySize.valueRange.min),o.\u0275\u0275propertyInterpolate("max",e.staticBySizeOrByCountInfo.bySize.valueRange.max),o.\u0275\u0275propertyInterpolate("step",e.staticBySizeOrByCountInfo.bySize.valueRange.step),o.\u0275\u0275property("formControlName",e.formControlNames.binSizeInput),o.\u0275\u0275advance(1),o.\u0275\u0275property("formControlName",e.formControlNames.binSizeUnitSelection),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",e.staticBySizeOrByCountInfo.bySize.applicableUnits)}}function Ye(l,t){if(1&l&&(o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275element(1,"legend",8),o.\u0275\u0275pipe(2,"async"),o.\u0275\u0275elementStart(3,"pbi-form-field",3),o.\u0275\u0275element(4,"label",9),o.\u0275\u0275template(5,Qe,1,4,"input",10),o.\u0275\u0275template(6,Je,4,6,"div",11),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()),2&l){var e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("localize",o.\u0275\u0275pipeBind1(2,3,e.descriptionHintOptimalBinSize$)?"BinsDialog_ModeBySize_Description_WithDefault":"BinsDialog_ModeBySize_Description"),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngIf",!((null==e.staticBySizeOrByCountInfo.bySize.applicableUnits?null:e.staticBySizeOrByCountInfo.bySize.applicableUnits.length)>0)),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",(null==e.staticBySizeOrByCountInfo.bySize.applicableUnits?null:e.staticBySizeOrByCountInfo.bySize.applicableUnits.length)>0)}}function Ze(l,t){if(1&l&&(o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275element(1,"legend",8),o.\u0275\u0275pipe(2,"async"),o.\u0275\u0275elementStart(3,"pbi-form-field",3),o.\u0275\u0275element(4,"label",18)(5,"input",19),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"pbi-form-field",3),o.\u0275\u0275element(7,"label",20)(8,"input",21),o.\u0275\u0275pipe(9,"async"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()),2&l){var e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("localize",o.\u0275\u0275pipeBind1(2,6,e.descriptionHintOptimalBinCount$)?"BinsDialog_ModeByCount_Description_WithDefault":"BinsDialog_ModeByCount_Description"),o.\u0275\u0275advance(4),o.\u0275\u0275propertyInterpolate("min",e.staticBySizeOrByCountInfo.byCount.valueRange.min),o.\u0275\u0275propertyInterpolate("max",e.staticBySizeOrByCountInfo.byCount.valueRange.max),o.\u0275\u0275propertyInterpolate("step",e.staticBySizeOrByCountInfo.byCount.valueRange.step),o.\u0275\u0275property("formControlName",e.formControlNames.binsCountInput),o.\u0275\u0275advance(3),o.\u0275\u0275property("value",o.\u0275\u0275pipeBind1(9,8,e.binByCountModeBinSizeHint$))}}function qe(l,t){1&l&&o.\u0275\u0275element(0,"button",22,23)}var et={min:1,max:1e9,step:1},tt={min:1,max:1e6,step:1},nt={size:10,unit:0},ot={size:1,unit:9},he=function(){function l(t,e,n,i,r,a){this.rootFormGroup=t,this.dataSourcesService=e,this.errorService=n,this.groupAuthoringService=i,this.lazyScopedProviderModern=r,this.localizationService=a,this.formControlNames={binsCountInput:"binsCountInput",binSizeInput:"binSizeInput",binSizeUnitSelection:"binSizeUnitSelection"},this.binMode$=new z.X(void 0),this.fieldValueRange$=new z.X(void 0),this.optimalBinCount$=new z.X(void 0),this.optimalBinSizeUnit$=new z.X(void 0),this.descriptionHintOptimalBinCountInternal$=new z.X(void 0),this.descriptionHintOptimalBinSizeInternal$=new z.X(void 0),this.binByCountModeBinSizeHintInternal$=new z.X(void 0),this.showResetToOptimalInternal$=new z.X(void 0),this.loadingOptimalValuesDone$=new z.X(!1),this.destroy$=new le.xQ}return Object.defineProperty(l.prototype,"resetToOptimalElementRef",{set:function(e){var n=this;e&&(this.resetToOptimalElement=e.nativeElement,(0,Ue.R)(this.resetToOptimalElement,"click").pipe((0,He.M)(this.binMode$,this.optimalBinCount$,this.optimalBinSizeUnit$),(0,L.R)(this.destroy$)).subscribe(function(i){var a=i[1],s=i[2],c=i[3];1===a&&null!=s&&(n.descriptionHintOptimalBinCountInternal$.next(!0),n.binsCountInput.setValue(s)),0===a&&null!=c&&(n.descriptionHintOptimalBinSizeInternal$.next(!0),n.setBinSizeControlValues(c))}))},enumerable:!1,configurable:!0}),l.prototype.ngOnInit=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var t,e,n=this;return(0,m.__generator)(this,function(i){switch(i.label){case 0:return u.fF.assert(function(){return!!n.binningColumnInfo},"Expect this.groupColumnInfo is provided."),this.setStaticBySizeOrByCountInfo(),this.initializeFormGroupAndControls(),this.descriptionHintOptimalBinCount$=this.descriptionHintOptimalBinCountInternal$.pipe((0,H.x)(),(0,L.R)(this.destroy$)),this.descriptionHintOptimalBinSize$=this.descriptionHintOptimalBinSizeInternal$.pipe((0,H.x)(),(0,L.R)(this.destroy$)),this.showResetToOptimal$=this.showResetToOptimalInternal$.pipe((0,H.x)(),(0,L.R)(this.destroy$)),this.binByCountModeBinSizeHint$=this.binByCountModeBinSizeHintInternal$.pipe((0,H.x)(),(0,L.R)(this.destroy$)),this.binningColumnInfo.supportBinByCountMode&&((0,ae.aj)([this.binsCountInput.valueChanges,this.fieldValueRange$]).pipe((0,K.h)(function(r){return!!r[1]}),(0,Z.U)(function(r){return function(l,t,e,n,i){var r,a;if(null==l||l<t.min||l>t.max||Se(t,l)||!e)return"";var p=function(l,t,e,n){if(!(null==e||e<=0||null==l||null==t))switch(n){case 1:return{size:(t-l)/e,unit:0};case 2:var a=(t.getTime()-l.getTime())/e,s=h(a,!1);return{size:a/C(s,!1),unit:s};default:u.fF.assertFail("Unexpected group data type: "+n)}}(null===(r=e.min)||void 0===r?void 0:r.value,null===(a=e.max)||void 0===a?void 0:a.value,l,n),d=p?{value:p.size,formatString:"G"}:void 0,y=ne(d);if(2===n&&null!=d?.value){var M=function(l,t){switch(l){case 4:return t.get("TimeUnit_Years");case 6:return t.get("TimeUnit_Months");case 8:return t.get("TimeUnit_Days");case 9:return t.get("TimeUnit_Hours");case 10:return t.get("TimeUnit_Minutes");case 11:return t.get("TimeUnit_Seconds");default:u.fF.assertFail("Unexpected BinUnit "+l)}}(p.unit,i);return y+" "+M}return y}(r[0],n.staticBySizeOrByCountInfo.byCount.valueRange,r[1],n.binningColumnInfo.groupDataType,n.localizationService)}),(0,H.x)(),(0,L.R)(this.destroy$)).subscribe(function(r){n.binByCountModeBinSizeHintInternal$.next(r)}),null!=(t=this.binningColumnInfo.binCount)&&this.binsCountInput.setValue(t)),e=this.binningColumnInfo.binSizeUnit,null!=e?.size&&this.setBinSizeControlValues(e),(0,ae.aj)([this.binMode$,this.optimalBinCount$,this.loadingOptimalValuesDone$]).pipe((0,K.h)(function(r){return 1===r[0]}),(0,L.R)(this.destroy$)).subscribe(function(r){var s=r[1],c=r[2];u.fF.assertValue(n.binsCountInput,"Expect this.binsCountInput to be defined when binMode is binByCount"),n.showResetToOptimalInternal$.next(null!=s),null!=s&&(null==n.binsCountInput.value||"VALID"!==n.binsCountInput.status)&&(n.binsCountInput.setValue(s),n.descriptionHintOptimalBinCountInternal$.next(!0)),c&&null==s&&(null==n.binsCountInput.value||"VALID"!==n.binsCountInput.status)&&n.binsCountInput.setValue(10)}),(0,ae.aj)([this.binMode$,this.optimalBinSizeUnit$,this.loadingOptimalValuesDone$]).pipe((0,K.h)(function(r){return 0===r[0]}),(0,L.R)(this.destroy$)).subscribe(function(r){var s=r[1],c=r[2];n.showResetToOptimalInternal$.next(null!=s),null!=s&&(null==n.binSizeInput.value||"VALID"!==n.binSizeInput.status)&&n.setBinSizeControlValues(s),c&&null==s&&(null==n.binSizeInput.value||"VALID"!==n.binSizeInput.status)&&(2===n.binningColumnInfo.groupDataType?n.setBinSizeControlValues(ot):1===n.binningColumnInfo.groupDataType&&n.setBinSizeControlValues(nt))}),this.binningColumnInfo.supportBinByCountMode?(this.fieldValueRangHint$=this.fieldValueRange$.pipe((0,K.h)(function(r){return!!r}),(0,Z.U)(function(r){return{min:ne(r.min),max:ne(r.max)}}),(0,L.R)(this.destroy$)),[4,this.loadAggregatesAndOptimals()]):[3,2];case 1:return i.sent(),this.loadingOptimalValuesDone$.next(!0),[3,3];case 2:this.loadingOptimalValuesDone$.next(!0),this.fieldValueRangHint$=(0,ke.of)(void 0),i.label=3;case 3:return[2]}})})},l.prototype.ngOnChanges=function(t){t.hasOwnProperty("binMode")&&this.binMode$.next(t.binMode.currentValue)},l.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.binsCountInput&&this.binsFormGroup.removeControl(this.formControlNames.binsCountInput),this.binsFormGroup.removeControl(this.formControlNames.binSizeInput),this.binSizeUnitSelection&&this.binsFormGroup.removeControl(this.formControlNames.binSizeUnitSelection)},l.prototype.getDefinition=function(){var t,n,e=(0,N.Oh)((0,N.nw)(this.binningColumnInfo.schemaName,this.binningColumnInfo.entityName),this.binningColumnInfo.sourcePropertyName);switch(this.binMode){case 0:n=(0,N.GW)(e,this.binSizeInput.value,(0,V.qW)(null===(t=this.binSizeUnitSelection)||void 0===t?void 0:t.value));break;case 1:n=(0,N.fP)((0,N.h5)(e,this.binsCountInput.value),"Min");break;default:u.fF.assertFail("Unhandled bin mode "+this.binMode)}return{groupedColumns:[e],binItem:n}},l.prototype.logTelemetryOnCommit=function(){var t,e,n,r=this.binningColumnInfo.isNew?"Create":"Update";switch(this.binMode){case 0:return void this.groupAuthoringService.telemetry.logBinBySizeActionTelemetry(r,"Dialog",this.binningColumnInfo.valueType,this.binSizeInput.value,null===(t=this.binSizeUnitSelection)||void 0===t?void 0:t.value);case 1:return void this.groupAuthoringService.telemetry.logBinByCountActionTelemetry(r,"Dialog",this.binningColumnInfo.valueType,this.binsCountInput.value,null!=(null===(e=this.fieldValueRange$.value)||void 0===e?void 0:e.min)?ne(this.fieldValueRange$.value.min):void 0,null!=(null===(n=this.fieldValueRange$.value)||void 0===n?void 0:n.max)?ne(this.fieldValueRange$.value.max):void 0);default:u.fF.assertFail("Unhandled bin mode "+this.binMode)}},l.prototype.setStaticBySizeOrByCountInfo=function(){var t;switch(this.binningColumnInfo.groupDataType){case 1:t={valueRange:f(this.binningColumnInfo.valueType),applicableUnits:[]};break;case 2:t={valueRange:tt,applicableUnits:[{unit:4,displayName:this.localizationService.get("TimeUnit_Years")},{unit:6,displayName:this.localizationService.get("TimeUnit_Months")},{unit:8,displayName:this.localizationService.get("TimeUnit_Days")},{unit:9,displayName:this.localizationService.get("TimeUnit_Hours")},{unit:10,displayName:this.localizationService.get("TimeUnit_Minutes")},{unit:11,displayName:this.localizationService.get("TimeUnit_Seconds")}]};break;default:u.fF.assertFail("Expect the binning column GroupDataType to be Number/DateTime")}this.staticBySizeOrByCountInfo={bySize:t},this.binningColumnInfo.supportBinByCountMode&&(this.staticBySizeOrByCountInfo.byCount={valueRange:et})},l.prototype.initializeFormGroupAndControls=function(){var t=this;if(u.fF.assert(function(){var i;return!(null===(i=t.staticBySizeOrByCountInfo)||void 0===i||!i.bySize)},"Expect staticBySizeInfo to be defined already"),u.fF.assert(function(){var i;return!t.binningColumnInfo.supportBinByCountMode||!(null===(i=t.staticBySizeOrByCountInfo)||void 0===i||!i.byCount)},"Expect staticByCountInfo to be defined already if it supports binByCount mode"),this.binsFormGroup=this.rootFormGroup.control,u.fF.assert(function(){return t.binningColumnInfo.supportBinByCountMode||0===t.binMode},"When supportBinByCountMode is false, expect binMode to be binBySize"),this.binningColumnInfo.supportBinByCountMode){var e=this.staticBySizeOrByCountInfo.byCount.valueRange;this.binsCountInput=new v.p4(void 0,[v.kI.required,v.kI.min(e.min),v.kI.max(e.max),be(this.staticBySizeOrByCountInfo.byCount.valueRange)]),this.binsFormGroup.addControl(this.formControlNames.binsCountInput,this.binsCountInput)}var n=this.staticBySizeOrByCountInfo.bySize.valueRange;this.binSizeInput=new v.p4(void 0,[v.kI.required,v.kI.min(n.min),v.kI.max(n.max),be(this.staticBySizeOrByCountInfo.bySize.valueRange)]),this.binsFormGroup.addControl(this.formControlNames.binSizeInput,this.binSizeInput),_.isEmpty(this.staticBySizeOrByCountInfo.bySize.applicableUnits)||(this.binSizeUnitSelection=new v.p4,this.binsFormGroup.addControl(this.formControlNames.binSizeUnitSelection,this.binSizeUnitSelection)),this.binMode$.pipe().subscribe(function(i){var r,a,s;1===i&&(t.binsCountInput.enable(),t.binSizeInput.disable(),null===(r=t.binSizeUnitSelection)||void 0===r||r.disable()),0===i&&(t.binSizeInput.enable(),null===(a=t.binSizeUnitSelection)||void 0===a||a.enable(),null===(s=t.binsCountInput)||void 0===s||s.disable())})},l.prototype.loadAggregatesAndOptimals=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var t,e,i,r,a=this;return(0,m.__generator)(this,function(s){switch(s.label){case 0:u.fF.assert(function(){return!!a.binningColumnInfo},"Expect this.groupColumnInfo already set."),t=(0,N.Oh)((0,N.nw)(this.binningColumnInfo.schemaName,this.binningColumnInfo.entityName),this.binningColumnInfo.sourcePropertyName),(0,V.MF)(this.dataSourcesService),e=this.dataSourcesService.get(),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this.lazyScopedProviderModern.get("groupQueryService")];case 2:return[4,s.sent().getAggregatesForColumn(t,e)];case 3:return i=s.sent(),this.fieldValueRange$.next({min:i?.min,max:i?.max}),this.setOptimalValues(i),[3,5];case 4:return r=s.sent(),(0,V.iA)(this.errorService,r,this.localizationService),[3,5];case 5:return[2]}})})},l.prototype.setOptimalValues=function(t){var n,i,e=this;if(u.fF.assert(function(){return!!e.binningColumnInfo},"Expect this.groupColumnInfo already set."),t){var r=function(l){if(!(null==l||l<0)){if(0===l)return 1;var t=Math.ceil(2*Math.pow(l,1/3));return t>l?l:t}}(t.count);if(null!=r&&this.optimalBinCount$.next(r),r){var a=function(l,t){switch(l){case 1:return f(t);case 2:return J;default:return void u.fF.assertFail("Unexpected groupDataType: "+l)}}(this.binningColumnInfo.groupDataType,this.binningColumnInfo.valueType),s=function(l,t,e,n,i){if(null!=l&&null!=t&&e)switch(i){case 1:return function(l,t){return{size:U(l,t),unit:0}}((t-l)/e,n);case 2:return function(l,t){var e=h(l,!0);return{size:U(l/C(e,!0),t),unit:e}}((t.getTime()-l.getTime())/e,n);default:return void u.fF.assertFail("Unexpected group data type: "+i)}}(null===(n=t.min)||void 0===n?void 0:n.value,null===(i=t.max)||void 0===i?void 0:i.value,r,a,this.binningColumnInfo.groupDataType);s&&this.optimalBinSizeUnit$.next(s)}}},l.prototype.setBinSizeControlValues=function(t){if(this.binSizeInput.setValue(t.size),this.binSizeUnitSelection){var e=_.find(this.staticBySizeOrByCountInfo.bySize.applicableUnits,function(n){return n.unit===t.unit});this.binSizeUnitSelection.setValue(e?.unit)}},l.\u0275fac=function(e){return new(e||l)(o.\u0275\u0275directiveInject(v.sg),o.\u0275\u0275directiveInject(ge.D),o.\u0275\u0275directiveInject(ye.T),o.\u0275\u0275directiveInject(de.RD),o.\u0275\u0275directiveInject(Me.H),o.\u0275\u0275directiveInject(Ce.o))},l.\u0275cmp=o.\u0275\u0275defineComponent({type:l,selectors:[["groups-bins-pane"]],viewQuery:function(e,n){var i;(1&e&&o.\u0275\u0275viewQuery(Ae,5,o.ElementRef),2&e)&&(o.\u0275\u0275queryRefresh(i=o.\u0275\u0275loadQuery())&&(n.resetToOptimalElementRef=i.first))},inputs:{binMode:"binMode",binningColumnInfo:"binningColumnInfo"},features:[o.\u0275\u0275ProvidersFeature([]),o.\u0275\u0275NgOnChangesFeature],decls:6,vars:7,consts:[[1,"twoColumnSection",3,"formGroup"],[4,"ngIf"],["class","resetToOptimalElement pbi-fluent-button","localize","Reset_To_Default",4,"ngIf"],[1,"cell"],["pbiLabel","","for","min-range-display","localize","GroupsDialog_ColumnMinValue"],["id","min-range-display","pbiInput","","readonly","","spellcheck","false",3,"value"],["pbiLabel","","for","max-range-display","localize","GroupsDialog_ColumnMaxValue"],["id","max-range-display","pbiInput","","readonly","","spellcheck","false",3,"value"],[1,"overallDescription",3,"localize"],["pbiLabel","","for","value-range-input-mode-zero","localize","GroupsDialog_BinSize"],["pbiInput","","id","value-range-input-mode-zero","type","number","required","","spellcheck","false",3,"formControlName","min","max","step",4,"ngIf"],["tabindex","-1","pbiInput","","class","compositeControl",4,"ngIf"],["pbiInput","","id","value-range-input-mode-zero","type","number","required","","spellcheck","false",3,"formControlName","min","max","step"],["tabindex","-1","pbiInput","",1,"compositeControl"],["type","number","required","","spellcheck","false",3,"formControlName","min","max","step"],[3,"formControlName"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["pbiLabel","","for","value-range-input-mode-one","localize","GroupsDialog_BinCount"],["pbiInput","","id","value-range-input-mode-one","type","number","required","","spellcheck","false",3,"formControlName","min","max","step"],["pbiLabel","","for","size-hint-input","localize","GroupsDialog_BinSize"],["pbiInput","","id","size-hint-input","readonly","","spellcheck","false",3,"value"],["localize","Reset_To_Default",1,"resetToOptimalElement","pbi-fluent-button"],["resetToOptimalElement",""]],template:function(e,n){1&e&&(o.\u0275\u0275elementStart(0,"form",0),o.\u0275\u0275template(1,Ke,3,5,"ng-container",1),o.\u0275\u0275template(2,Ye,7,5,"ng-container",1),o.\u0275\u0275template(3,Ze,10,10,"ng-container",1),o.\u0275\u0275template(4,qe,2,0,"button",2),o.\u0275\u0275pipe(5,"async"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275property("formGroup",n.binsFormGroup),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.binningColumnInfo.supportBinByCountMode),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",0===n.binMode),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",1===n.binMode),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",o.\u0275\u0275pipeBind1(5,5,n.showResetToOptimal$)))},dependencies:[A.NgForOf,A.NgIf,fe.X,Q.bP,Q.ug,Q.nm,v._Y,v.YN,v.Kr,v.Fj,v.wV,v.EJ,v.JJ,v.JL,v.Q7,v.qQ,v.Fd,v.sg,v.u,A.AsyncPipe],styles:['.groupsDialogContent[_ngcontent-%COMP%]{width:720px;height:480px;display:flex;flex-direction:column}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection{display:grid;grid-template-columns:1fr 1fr;grid-gap:12px 12px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell{display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select{padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input{vertical-align:middle;margin:0;padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input[readonly]{background-color:var(--colorNeutralBackgroundDisabled);color:var(--colorNeutralForegroundDisabled);pointer-events:none}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input::selection{background:var(--colorNeutralBackgroundInverted);color:var(--colorNeutralForegroundInverted)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-size:var(--sm-font-size, 12px)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-weight:var(--font-weight-normal, 500)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls{flex:1;display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls [pbiInput], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls [pbiInput]{flex:1}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown{width:100%}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button{border:1px solid var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button[disabled], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button[disabled]{background-color:var(--colorNeutralBackgroundDisabled)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button .pbi-dropdown-trigger-container, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button .pbi-dropdown-trigger-container{margin:0;padding:4px 8px}.groupsDialogContent[_ngcontent-%COMP%]   .topSection[_ngcontent-%COMP%]{margin-bottom:12px}.groupsDialogContent[_ngcontent-%COMP%]   groups-list-pane[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]   groups-bins-pan[_ngcontent-%COMP%]{flex:1}','.twoColumnSection[_ngcontent-%COMP%]   .overallDescription[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:3;margin-top:20px}.twoColumnSection[_ngcontent-%COMP%]   .resetToOptimalElement[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin-top:-4px;grid-column-start:1;width:fit-content}.twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]{flex:1;display:flex}.twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1}.twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:fit-content}html:not([dir="rtl"])[_nghost-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .compositeControl[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{margin-right:8px}'],changeDetection:0}),l}();function ne(l){return l?(0,Oe.WU)(l.value,l.formatString):(0,Oe.WU)(null)}function be(l){return function(t){return Se(l,t.value)?{valueNotInteger:!0}:null}}function Se(l,t){var e=l.step;return _.isNumber(e)&&_.isInteger(e)&&!_.isInteger(t)}var at=g(14815),oe=g(21661),ut=function(){function l(t,e){u.fF.assertValue(t,"getItems"),this.selectedItems=[],this.getItems=t,this.onSelectionChanged=e??_.noop}return Object.defineProperty(l.prototype,"lastSelected",{get:function(){return _.last(this.selectedItems)},enumerable:!1,configurable:!0}),l.prototype.getSelectedItems=function(){return(0,m.__spreadArray)([],this.selectedItems||[],!0)},l.prototype.select=function(t){this.selectInternal(t)&&this.onSelectionChanged(this.selectedItems)},l.prototype.selectRange=function(t){for(var e=!1,n=0,i=t;n<i.length;n++)e=this.selectInternal(i[n])||e;e&&this.onSelectionChanged(this.selectedItems)},l.prototype.selectAll=function(){this.selectRange(this.getItems())},l.prototype.toggle=function(t){t.isSelected?(t.isSelected=!1,this.selectedItems.splice(this.selectedItems.indexOf(t),1)):(t.isSelected=!0,this.selectedItems.push(t)),this.onSelectionChanged(this.selectedItems)},l.prototype.clear=function(){for(var t=!_.isEmpty(this.selectedItems),e=0,n=this.selectedItems;e<n.length;e++)n[e].isSelected=!1;this.selectedItems.splice(0),t&&this.onSelectionChanged([])},l.prototype.selectInternal=function(t){return!t.isSelected&&(t.isSelected=!0,this.selectedItems.push(t),!0)},l}(),pt=function(l){function t(){return null!==l&&l.apply(this,arguments)||this}return(0,m.__extends)(t,l),Object.defineProperty(t.prototype,"position",{get:function(){return this.getContainer().scrollTop()},set:function(n){var i=this.getContainer();i.scrollTop()!==n&&i.scrollTop(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){var n=this.getContainer()[0];return n?n.scrollHeight:void 0},enumerable:!1,configurable:!0}),t.prototype.getNewIndexOnKeyDown=function(e,n,i){switch(i.keyCode){case $.ui.keyCode.UP:return i.scrollHandled=!0,Math.min(Math.max(e-1,0),n);case $.ui.keyCode.DOWN:return Math.min(e+1,n)}},t.prototype.getRange=function(e,n){void 0===n&&(n=!1);var i=e.offset();if(i){var r=n?e.outerHeight():e.innerHeight();return{min:i.top,max:i.top+r,size:r}}return null},t.prototype.getDefaultOverscroll=function(){return 0},t}(function(){function l(t,e,n){void 0===n&&(n=!0),u.fF.assertValue(t,"containerSelector"),u.fF.assertValue(e,"itemsSelector"),this.containerSelector=t,this.itemsSelector=e,this.includeDescendants=n}return Object.defineProperty(l.prototype,"position",{get:function(){},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"max",{get:function(){},enumerable:!1,configurable:!0}),l.prototype.scrollItemIntoView=function(t,e,n){var i=this.getContainer(),r=this.getRange(i),a=this.getItems(),s=a[t];if(s){var c=0===t,p=t===a.length-1,d=this.getRange($(s),!0);if(c?e=0:p?e=n||0:null==e&&(e=this.getDefaultOverscroll()),r&&d){var y=this.calculatePositionDelta(r,d,e);this.position=this.position+y}}},l.prototype.getPageDownItemIndex=function(t){var e=this.getRange(this.getContainer());if(e){var n=this.getItems();if(0===n.length)return-1;for(var i=0,r=t;r<n.length-1;r++)if((i+=this.getRange(n.eq(r)).size)>e.size)return r;return n.length-1}return-1},l.prototype.getPageUpItemIndex=function(t){var e=this.getRange(this.getContainer());if(e){var n=this.getItems();if(0===n.length)return-1;for(var i=0,r=t;r>0;r--)if((i+=this.getRange(n.eq(r)).size)>e.size)return r;return 0}return-1},l.prototype.retainPosition=function(t){var e=this.position;try{t()}finally{this.position=e}},l.prototype.handleKeyDown=function(t,e,n){var i=!0,r=t,s=this.getItems().length-1;switch(e.keyCode){case $.ui.keyCode.PAGE_UP:var c=this.getPageUpItemIndex(t);r=Math.max(c,0);break;case $.ui.keyCode.PAGE_DOWN:var p=this.getPageDownItemIndex(t);r=Math.min(p,s);break;case $.ui.keyCode.END:r=s;break;case $.ui.keyCode.HOME:r=0;break;default:i=void 0!==(r=this.getNewIndexOnKeyDown(t,s,e))}return void 0!==r&&r!==t&&(n(r),this.scrollItemIntoView(r)),i},l.prototype.onScroll=function(t){var e=this;this.getContainer().scroll(function(){t(e.position/e.max)})},l.prototype.getNewIndexOnKeyDown=function(t,e,n){},l.prototype.getRange=function(t,e){void 0===e&&(e=!1)},l.prototype.getDefaultOverscroll=function(){},l.prototype.getContainer=function(){return $(this.containerSelector)},l.prototype.getItems=function(){return this.retrieveItems()},l.prototype.retrieveItems=function(){return this.includeDescendants?this.getContainer().find(this.itemsSelector):this.getContainer().children(this.itemsSelector)},l.prototype.calculatePositionDelta=function(t,e,n){return e.min<t.min?-(t.min-e.min+n):e.max>t.max?e.max-t.max+n:0},l}()),Ie=g(59107),De=function(){function l(t,e,n,i,r,a,s){void 0===i&&(i=!0),this._hasFocus=!1,this.selection=function(l,t){return new ut(l,t)}(t,r),this.scrollHelper=s??new pt(e,n,!0),this.getVisibleNodes=t,this.allowMultiSelect=i,this.onFocusedItemChanged=a??_.noop}return l.prototype.hasFocus=function(){return this._hasFocus},l.prototype.onNodeClick=function(t,e){var n=e.shiftKey,i=Ie.M.isCtrlOrMeta(e);n&&i?this.shiftSelect(t):n?(this.selection.clear(),this.shiftSelect(t)):i?this.selection.toggle(t):_.isEqual(this.selection.getSelectedItems(),[t])||(this.selection.clear(),this.selection.select(t)),n||(this.shiftSelectionStartNode=t),this.focus(t),e.preventDefault(),e.stopPropagation()},l.prototype.onBackgroundClick=function(t){this.selection.clear(),t.stopPropagation()},l.prototype.onFocus=function(){this.focus(this.getFocusedNode()||this.getVisibleNodes()[0]),this._hasFocus=!0},l.prototype.onBlur=function(){this.getVisibleNodes().map(function(t){return t.isFocused=!1}),this._hasFocus=!1,this.onFocusedItemChanged(void 0)},l.prototype.onKeyDown=function(t){var e=this,n=t.shiftKey,i=Ie.M.isCtrlOrMeta(t),r=!1,a=this.lastFocusedNode;if(i&&"KeyA"===t.code&&this.allowMultiSelect)this.selection.selectAll(),r=!0;else if("Escape"===t.code)this.selection.clear(),r=!0;else if("Space"===t.code&&a){if(i&&n){if(this.shiftSelectionStartNode){var s=this.getVisibleNodes(),c=this.getNodesInRange(s,this.shiftSelectionStartNode,a);this.selection.selectRange(c)}}else i?this.selection.toggle(a):this.selection.select(a);r=!0}else if("ArrowLeft"===t.code&&a){if(a.isExpanded)this.setExpandValue(a,!1);else if(a.parent){var p=a.parent;this.selectAndScrollTo([p]),this.focus(p)}r=!0}else if("ArrowRight"===t.code&&a){if(!_.isEmpty(a.children))if(a.isExpanded){var d=a.children[0];this.selectAndScrollTo([d]),this.focus(d)}else this.setExpandValue(a,!0);r=!0}else if(a){var y=this.getVisibleNodes(),M=y.indexOf(a);u.fF.assert(function(){return M>=0},"expect the last focused node exists in visible nodes list"),r=!0,M>=0&&(r=this.scrollHelper.handleKeyDown(M,t,function(I){var b=y[I];e.allowMultiSelect?n&&i?e.shiftSelect(b):n?(e.selection.clear(),e.shiftSelect(b)):i||(e.selection.clear(),e.selection.select(b)):(e.selection.clear(),e.selection.select(b)),n||(e.shiftSelectionStartNode=b),e.focus(b)}))}r&&(t.stopPropagation(),t.preventDefault())},l.prototype.toggleExpandCollapse=function(t,e){this.setExpandValue(t,!t.isExpanded),e&&e.stopPropagation()},l.prototype.selectAndScrollTo=function(t){var e=this;this.selection.clear(),this.selection.selectRange(t),requestAnimationFrame(function(){var i=e.getVisibleNodes().indexOf(t[0]);e.scrollHelper.scrollItemIntoView(i,30)})},l.prototype.syncManagedNodes=function(t){var e=this;this.hasNode(t,this.shiftSelectionStartNode)||(this.shiftSelectionStartNode=void 0),this.hasNode(t,this.lastFocusedNode)||(this.lastFocusedNode=void 0),this.selection.clear();var n=[];_.forEach(t,function(i){e.collectSelectedNodes(i,n)}),_.forEach(n,function(i){i.isSelected=!1}),this.selection.selectRange(n)},l.prototype.shiftSelect=function(t){var e,n=this.getVisibleNodes(),i=null!==(e=this.shiftSelectionStartNode)&&void 0!==e?e:_.first(n);this.selection.selectRange(this.getNodesInRange(n,i,t))},l.prototype.collectSelectedNodes=function(t,e){var n=this;u.fF.assertValue(e,"selected must not be null"),t&&(t.isSelected&&e.push(t),_.forEach(t.children,function(i){n.collectSelectedNodes(i,e)}))},l.prototype.hasNode=function(t,e){for(var n=0,i=t??[];n<i.length;n++){var r=i[n];if(r===e)return!0;if(this.hasNode(r.children,e))return!0}return!1},l.prototype.getNodesInRange=function(t,e,n){var i,r=t.indexOf(e),a=t.indexOf(n),s=Math.min(r,a),c=Math.max(r,a);if(s>-1){i=[];for(var p=s;p<=c;p++)i.push(t[p])}return i},l.prototype.focus=function(t){t&&(this.getVisibleNodes().map(function(e){return e.isFocused=!1}),t.isFocused=!0,this.lastFocusedNode=t,this.onFocusedItemChanged(t))},l.prototype.getFocusedNode=function(){var t=this.getVisibleNodes();return _.find(t,function(n){return n.isSelected})??_.find(t,function(n){return n.isFocused})},l.prototype.setExpandValue=function(t,e){var n;t.isExpanded!==e&&(t.isExpanded=e,!t.isExpanded&&(null===(n=this.shiftSelectionStartNode)||void 0===n?void 0:n.parent)===t&&(this.shiftSelectionStartNode=t))},l}(),gt=g(73221),dt=g(63057),xe=g(6663),we=g(17653),Ct=g(55862),ie=g(74082),Te=g(64647),ft=g(37534),ht=g(56011),mt=g(86663),vt=g(36858),_t=g(85102),Pt=["allGroupsListContainer"],Ge=function(t,e,n){return{"role-missing":t,"role-selected":e,"role-focused":n}};function Ot(l,t){if(1&l){var e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"li",18),o.\u0275\u0275listener("click",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(c.paneNodeClicked.fn({$event:r,type:"ungrouped",node:s}))}),o.\u0275\u0275elementStart(1,"span",19),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd()()}if(2&l){var n=t.$implicit;o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction3(4,Ge,n.isMissingInData,n.isSelected,n.isFocused)),o.\u0275\u0275attribute("aria-selected",n.isSelected),o.\u0275\u0275advance(1),o.\u0275\u0275property("pbiTooltip",n.displayValue),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(n.displayValue)}}function yt(l,t){1&l&&o.\u0275\u0275element(0,"span",20)}function Mt(l,t){if(1&l){var e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"li",28),o.\u0275\u0275listener("click",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext(3);return o.\u0275\u0275resetView(c.paneNodeClicked.fn({$event:r,type:"grouped",node:s}))}),o.\u0275\u0275elementStart(1,"span",19),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd()()}if(2&l){var n=t.$implicit;o.\u0275\u0275propertyInterpolate1("id","rightPaneNode",n.id,""),o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction3(5,Ge,n.isMissingInData,n.isSelected,n.isFocused)),o.\u0275\u0275attribute("aria-selected",n.isSelected),o.\u0275\u0275advance(1),o.\u0275\u0275property("pbiTooltip",n.displayValue),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(n.displayValue)}}function bt(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"ul",26),o.\u0275\u0275template(1,Mt,3,9,"li",27),o.\u0275\u0275elementEnd()),2&l){var e=o.\u0275\u0275nextContext().$implicit;o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",e.children)}}var St=function(t,e,n){return{"role-expanded":t,"role-selected":e,"role-focused":n}};function It(l,t){if(1&l){var e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"li",21),o.\u0275\u0275listener("click",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(c.paneNodeClicked.fn({$event:r,type:"grouped",node:s}))}),o.\u0275\u0275elementStart(1,"div",22)(2,"pbi-icon",23),o.\u0275\u0275listener("click",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(c.collapseExpandClicked.fn({$event:r,node:s}))}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"editable-label",24),o.\u0275\u0275listener("cancel",function(){var a=o.\u0275\u0275restoreView(e).$implicit,s=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(s.cancelEditNameAndFocus(a))})("dblclick",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(c.startEditName(s,r))})("onBlur",function(r){var s=o.\u0275\u0275restoreView(e).$implicit,c=o.\u0275\u0275nextContext();return o.\u0275\u0275resetView(c.rename(s,r.newName))}),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(4,bt,2,1,"ul",25),o.\u0275\u0275elementEnd()}if(2&l){var n=t.$implicit;o.\u0275\u0275propertyInterpolate1("id","rightPaneNode",n.id,""),o.\u0275\u0275attribute("aria-selected",n.isSelected)("aria-expanded",n.isExpanded),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction3(10,St,n.isExpanded,n.isSelected,n.isFocused)),o.\u0275\u0275advance(2),o.\u0275\u0275property("displayName",n.displayValue)("disableClick",!0)("editable",n.isEditingName)("inputMatchLabelWidth",!1)("customTooltip",!1),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.isExpanded)}}var me=function(l){function t(e,n,i,r,a,s,c){var p=l.call(this)||this;return p.rootFormGroup=e,p.dataSourcesService=n,p.errorService=i,p.groupAuthoringService=r,p.highContrastCssGenerationService=a,p.lazyScopedProviderModern=s,p.localizationService=c,p.loadColumnValuesCompleted$=new z.X(void 0),p.includeOtherGroupToggleControlName="includeOtherGroupToggle",p.collapseExpandClicked=p.createEventAdapter(),p.paneFocused=p.createEventAdapter(),p.paneBlured=p.createEventAdapter(),p.paneBackgroundClicked=p.createEventAdapter(),p.paneNodeClicked=p.createEventAdapter(),p.ungroupedInternal$=new z.X(void 0),p.groupedInternal$=new z.X(void 0),p.selectedUngroupedInternal$=new z.X([]),p.selectedGroupedInternal$=new z.X([]),p.focusedUngroupedInternal$=new le.xQ,p.focusedGroupedInternal$=new le.xQ,p.specialValidators=[],p.lastNodeId=0,p.initializeHighContrastRules(),p}return(0,m.__extends)(t,l),Object.defineProperty(t.prototype,"_vs",{set:function(n){var i=this;this.ungroupedPaneVirtualScroll=n,n&&n.scrolledIndexChange.pipe((0,xe.G)(),(0,K.h)(function(r){return!(r[1]<=r[0])&&n.getRenderedRange().end===n.getDataLength()}),(0,L.R)((0,dt.T)(this.onDestroy$,this.loadColumnValuesCompleted$.pipe((0,K.h)(function(r){return!!r}))))).subscribe(function(r){i.loadUngroupedColumnValues(!0,!0)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupsListContainerElementRef",{set:function(n){n&&(this.groupsListContainerElement=n.nativeElement)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var e;return(0,m.__generator)(this,function(i){switch(i.label){case 0:return this.includeOtherGroupToggle=new v.p4(void 0),this.listFormGroup=this.rootFormGroup.control,this.listFormGroup.addControl(this.includeOtherGroupToggleControlName,this.includeOtherGroupToggle),this.otherGroupNode=this.getDefaultOtherGroupNode(),this.grouped$=this.groupedInternal$.pipe(),this.ungrouped$=this.ungroupedInternal$.pipe(),this.setupEventRelatedPipes(),this.setupPaneHelpers(),this.setupCanGroupUngroup(),this.checkToEnforceIncludeOtherGroup(),this.loadExistingGroups(),e=Bt.createValidator(this.groupedInternal$,this.onDestroy$),this.specialValidators.push(e),this.listFormGroup.addValidators(e),this.listFormGroup.updateValueAndValidity(),[4,this.loadUngroupedColumnValues(!1)];case 1:return i.sent(),[2]}})})},t.prototype.ngOnDestroy=function(){return this.listFormGroup.removeControl(this.includeOtherGroupToggleControlName),this.listFormGroup.removeValidators(this.specialValidators),l.prototype.ngOnDestroy.call(this)},t.prototype.learnMoreAboutOtherGroup=function(){window.open("https://go.microsoft.com/fwlink/?LinkId=828994","_blank")},t.prototype.onPaneKeyDown=function(e,n){if("ungrouped"===e&&!n.ctrlKey&&!n.shiftKey&&this.clearPaneSelection("grouped"),"grouped"===e&&"F2"===n.code){var i=_.find(this.groupedInternal$.value,function(a){return a.isFocused});if(i)return void this.startEditName(i,n)}this.getTreeHelper(e).onKeyDown(n)},t.prototype.group=function(){var n,i,r,d,e=this,a=(0,m.__spreadArray)([],null!==(n=this.groupedInternal$.value)&&void 0!==n?n:[],!0),s=(0,m.__spreadArray)([],null!==(i=this.ungroupedInternal$.value)&&void 0!==i?i:[],!0),c=null!==(r=this.ungroupedTreeHelper.selection.getSelectedItems())&&void 0!==r?r:[],p=_.filter(this.groupedTreeHelper.selection.getSelectedItems(),function(P){return!(R(P)&&P.isOther||R(P?.parent)&&P.parent.isOther)}),y=!1;if(!_.isEmpty(p)){var M=_.last(p),I=_.filter(p,function(P){return R(P)}),b=_.size(I);1===b?d=I[0]:b>1?(d=this.mergeGroups(I),a=_.without.apply(_,(0,m.__spreadArray)([a],I,!1)),y=!0):(1===p.length||_.every(p,function(P){return P.parent===M.parent}))&&(d=M.parent);var D=_.filter(p,function(P){return se(P)&&P.parent!==d});_.forEach(_.groupBy(D,function(P){return P.parent.displayValue}),function(P){var G=_.first(P).parent;e.updateGroupChildrenAndFixName(G,a,function(){G.children=_.without.apply(_,(0,m.__spreadArray)([G.children],D,!1))}),_.isEmpty(G.children)&&(a=_.without(a,G))}),s.push.apply(s,D),c.push.apply(c,D)}if(!_.isEmpty(c)){if(!d){if(!this.validateCanCreateGroup())return;d=this.createGroupWithEmptyChildren(c),y=!0}this.updateGroupChildrenAndFixName(d,a,function(){s=_.without.apply(_,(0,m.__spreadArray)([s],c,!1)),d.children=_.concat.apply(_,(0,m.__spreadArray)([d.children],c,!1)),q(d.children),_.forEach(c,function(P){P.parent=d})}),d.isExpanded=!0}y&&(a.push(d),this.ensureGroupHasUniqueName(d,a),q(a)),this.groupedInternal$.next(a),this.ungroupedInternal$.next(s),this.groupedTreeHelper.selectAndScrollTo(y?[d]:c),this.loadColumnValuesCompleted$.value||this.loadUngroupedColumnValues(!0)},t.prototype.ungroup=function(){for(var e,n,i=(0,m.__spreadArray)([],null!==(e=this.groupedInternal$.value)&&void 0!==e?e:[],!0),r=(0,m.__spreadArray)([],null!==(n=this.ungroupedInternal$.value)&&void 0!==n?n:[],!0),a=this.groupedTreeHelper.selection.getSelectedItems(),s=_.filter(a,function(x){return R(x)}),c=_.filter(a,function(x){return se(x)}),p=_.groupBy(c,function(x){return x.parent.displayValue}),d=_.find(i,function(x){return x.isOther}),y=!(this.forceIncludeOtherGroup||!_.find(s,function(x){return x.isOther})&&!_.find(c,function(x){return x.parent.isOther})),M=[],I=y?[d]:[],b=function(F){if(F.isOther)return"continue";var k=!!_.find(s,F),ee=p[F.displayValue],te=_.size(ee);k&&0===te||te===F.children.length?(I.push(F),M.push.apply(M,F.children)):te>0&&(D.updateGroupChildrenAndFixName(F,i,function(){F.children=_.without.apply(_,(0,m.__spreadArray)([F.children],ee,!1))}),M.push.apply(M,ee))},D=this,P=0,G=i;P<G.length;P++)b(G[P]);i=_.without.apply(_,(0,m.__spreadArray)([i],I,!1)),_.forEach(M,function(x){x.parent=void 0}),r.push.apply(r,M),q(r),this.groupedInternal$.next(i),this.ungroupedInternal$.next(r),y&&this.includeOtherGroupToggle.setValue(!1),this.ungroupedTreeHelper.selectAndScrollTo(M)},t.prototype.logTelemetryOnCommit=function(e){this.groupAuthoringService.telemetry.logGroupActionTelemetry(this.groupingListInfo.existing?"Update":"Create","Dialog",this.groupingListInfo.sourceProperty,e,_.size(this.ungroupedInternal$.value))},t.prototype.getDefinition=function(){var e=this,n={groupedColumns:[(0,N.Oh)((0,N.nw)(this.groupingListInfo.schema,this.groupingListInfo.entity.name),this.groupingListInfo.sourceProperty.name)],groupItems:[]};(0,V.lB)(n.groupItems,this.localizationService);for(var i=0,r=this.groupedInternal$.value;i<r.length;i++){var a=r[i],s={name:a.value};if(!a.isOther){var c=_.map(a.children,function(p){return[(0,N.kQ)(p.value,e.groupingListInfo.sourcePropertyValueType)]});s.expression=(0,N.Sh)(n.groupedColumns,c)}n.groupItems.push(s)}return n},t.prototype.startEditName=function(e,n){e.isEditingName=!0,n.stopPropagation(),n.preventDefault()},t.prototype.cancelEditNameAndFocus=function(e){var n=this;e.isEditingName=!1,setTimeout(function(){n.groupsListContainerElement.focus()})},t.prototype.rename=function(e,n){_.isEmpty(_.trim(n))?this.cancelEditNameAndFocus(e):(e.value=this.getUniqueNewName(e,this.groupedInternal$.value,n||e.value),e.displayValue=e.value,e.isEditingName=!1,e.isOther?this.ensureOtherGroupDislayNameRules(e):(q(this.groupedInternal$.value),this.groupedTreeHelper.selectAndScrollTo([e])))},t.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-selected, .themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-selected *:not(pbi-icon)","{ background-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-selected, .themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-selected *","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer li.role-selected::marker","{ color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer li.role-selected.role-missing::marker","{ color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-focused","{ outline-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-missing:not(.role-selected), .themeableElement .groupsDialogContent .valuesOrGroupsTopContainer .role-missing:not(.role-selected) *","{ color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .valuesOrGroupsTopContainer:focus, .themeableElement .groupsDialogContent .valuesOrGroupsTopContainer:focus-within","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule('html[data-focus-source="key"] .pbi-checkbox-input:focus + label::before',"{ outline-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .groupsDialogContent .glyphicon.infoLink","{ border: none !important; }")},t.prototype.validateCanCreateGroup=function(){var e=_.size(this.groupedInternal$.value)+1;return this.groupAuthoringService.core.validateGroupCount(this.groupingListInfo.entity,e+1)},t.prototype.clearPaneSelection=function(e){this.getTreeHelper(e).selection.clear()},t.prototype.loadExistingGroups=function(){var e=this;if(u.fF.assertValue(this.groupingListInfo,"Expect this.groupingListInfo to be defined already"),u.fF.assert(function(){return null==e.ungroupedInternal$.value},'Expect this to be called BEFORE we load any column values, for setting "isMissingInData" value properly'),this.groupingListInfo.existing){for(var n=[],r=0,a=(0,V.$E)(this.groupingListInfo.existing.groups);r<a.length;r++){var s=a[r],c={id:this.lastNodeId++,displayValue:s.name,value:s.name,children:[],isOther:!s.expression,isExpanded:!1};if(n.push(c),u.fF.assertValue(_.isEmpty(this.ungroupedInternal$.value),"Expect this to be called before the ungrouped column values start to load"),s.expression&&(0,ie.Hi)(s.expression))for(var p=s.expression,d=0;d<_.size(p.values);d++){var y=p.values[d][0];if((0,ie.VC)(y)){var M={id:this.lastNodeId++,displayValue:y.value.toString(),value:y.value,sortKey:d,parent:c,isMissingInData:!0};c.children.push(M)}}}var I=_.remove(n,function(D){return D.isOther});u.fF.assert(function(){return _.size(I)<=1},"Maximum 1 Other group is supported");var b=_.first(I);b&&(this.ensureOtherGroupDislayNameRules(b),this.includeOtherGroupToggle.setValue(!0),this.otherGroupNode.displayValue=b.displayValue,this.otherGroupNode.value=b.value,n.push(this.otherGroupNode)),this.groupedInternal$.next(n)}},t.prototype.getDefaultOtherGroupNode=function(){var i=this.localizationService.get("Other"),r=this.localizationService.get("GroupsDialog_OtherGroupContainsUngrouped"),a={id:-1,displayValue:i,value:i,children:[],isOther:!0,isExpanded:!0};return a.children.push({id:-2,displayValue:r,value:r,sortKey:-1,parent:a}),a},t.prototype.loadUngroupedColumnValues=function(e,n){return(0,m.__awaiter)(this,void 0,void 0,function(){var i,r,a,s,c,p=this;return(0,m.__generator)(this,function(d){switch(d.label){case 0:return u.fF.assertValue(this.groupingListInfo,"Expect this.groupingListInfo to be defined already"),this.shouldLoadMore(n)?(i=(0,N.Oh)((0,N.nw)(this.groupingListInfo.schema,this.groupingListInfo.entity.name),this.groupingListInfo.sourceProperty.name),r=this.dataSourcesService.get(),[4,this.lazyScopedProviderModern.get("groupQueryService")]):[2];case 1:a=d.sent(),d.label=2;case 2:return d.trys.push([2,4,,5]),[4,a.getValuesForColumn(i,r,e)];case 3:return s=d.sent(),this.updateNodes(s),this.loadColumnValuesCompleted$.next(!s.canLoadMore),this.shouldLoadMore(!1)&&setTimeout(function(){p.loadUngroupedColumnValues(!0)},100),[3,5];case 4:return c=d.sent(),(0,V.iA)(this.errorService,c,this.localizationService),[3,5];case 5:return[2]}})})},t.prototype.shouldLoadMore=function(e){return!this.loadColumnValuesCompleted$.value&&(e||_.size(this.ungroupedInternal$.value)<3500)},t.prototype.updateNodes=function(e){var n,i,r,a,s,c;if(_.first(null===(n=e?.table)||void 0===n?void 0:n.columns)){var d=e.table.rows;if(!_.isEmpty(d)){for(var y=(0,m.__spreadArray)([],null!==(i=this.groupedInternal$.value)&&void 0!==i?i:[],!0),M={},I=0,b=y;I<b.length;I++){var D=b[I];if(!D.isOther)for(var P=0,G=null!==(r=D.children)&&void 0!==r?r:[];P<G.length;P++)M[(E=G[P]).value]=E}for(var x=null!==(a=this.ungroupedInternal$.value)&&void 0!==a?a:[],F={},k=0,ee=x;k<ee.length;k++){var te=ee[k];F[te.value]=te}for(var ue=(0,m.__spreadArray)([],x,!0),$e=!1,Le=(null!==(c=null===(s=_.last(x))||void 0===s?void 0:s.sortKey)&&void 0!==c?c:0)+1,_e=0;_e<_.size(d);_e++){var Pe=d[_e][0];if(null!=Pe){var E,re={id:this.lastNodeId++,displayValue:Pe.toString(),value:Pe,sortKey:Le};if(Le++,E=M[re.value])$e=!0,E.isMissingInData=!1,E.sortKey=re.sortKey,E.parent.children=(0,m.__spreadArray)([],E.parent.children,!0);else{var Re=F[re.value];if(Re){var an=ue.indexOf(Re);ue[an]=re}else ue.push(re)}}}this.ungroupedInternal$.next(ue),$e&&this.groupedInternal$.next(y)}}},t.prototype.checkToEnforceIncludeOtherGroup=function(){0!==(0,V.SK)(this.groupingListInfo.sourcePropertyValueType)&&(this.forceIncludeOtherGroup=!0,this.includeOtherGroupToggle.setValue(!0))},t.prototype.setupEventRelatedPipes=function(){var e=this;this.ungroupedFocusedDescription$=this.focusedUngroupedInternal$.pipe((0,H.x)(),(0,Z.U)(function(n){return n?"leftPaneNode".concat(n.id):"none"})),this.groupedFocusedDescription$=this.focusedGroupedInternal$.pipe((0,H.x)(),(0,Z.U)(function(n){return n?"rightPaneNode".concat(n.id):"none"})),this.collapseExpandClicked.$.pipe().subscribe(function(n){var i=n.$event,r=n.node;i.stopPropagation(),i.preventDefault(),R(r)&&e.groupedTreeHelper.toggleExpandCollapse(r)}),this.paneFocused.$.pipe().subscribe(function(n){var i=n.$event,r=n.type;i.stopPropagation(),i.preventDefault(),e.getTreeHelper(r).onFocus()}),this.paneBlured.$.pipe().subscribe(function(n){var i=n.$event,r=n.type;i.stopPropagation(),i.preventDefault(),e.getTreeHelper(r).onBlur()}),this.paneBackgroundClicked.$.pipe().subscribe(function(n){var i=n.$event,r=n.type;i.stopPropagation(),i.preventDefault(),e.clearPaneSelection(r)}),this.paneNodeClicked.$.pipe((0,we.b)(function(n){var i=n.$event;i.preventDefault(),i.stopPropagation()}),(0,Ct.p)(200)).subscribe(function(n){var i=n.$event,r=n.type,a=n.node;"ungrouped"===r&&!i.ctrlKey&&!i.shiftKey&&e.clearPaneSelection("grouped"),e.getTreeHelper(r).onNodeClick(a,i)}),this.includeOtherGroupToggle.valueChanges.pipe((0,H.x)()).subscribe(function(n){var i,r=(0,m.__spreadArray)([],null!==(i=e.groupedInternal$.value)&&void 0!==i?i:[],!0),a=_.last(r),s=a?.isOther?a:void 0;if(n){if(!e.validateCanCreateGroup())return void setTimeout(function(){e.includeOtherGroupToggle.setValue(!1)});u.fF.assert(function(){return!s},"this should not be called for checked===true if there is already an Other group"),e.ensureGroupHasUniqueName(e.otherGroupNode,r),e.ensureOtherGroupDislayNameRules(e.otherGroupNode),e.otherGroupNode.isExpanded=!0,r.push(e.otherGroupNode),e.groupedInternal$.next(r),e.groupedTreeHelper.selectAndScrollTo([e.otherGroupNode])}else s&&(r=_.take(r,_.size(r)-1),e.groupedInternal$.next(r))})},t.prototype.setupPaneHelpers=function(){var e=this;this.ungroupedTreeHelper=new De(function(){return e.ungroupedInternal$.value||[]},".valuesOrGroupsTopContainer.valuesTopContainer .cdk-virtual-scroll-content-wrapper",".item",!0,function(n){e.selectedUngroupedInternal$.next(n)},function(n){e.focusedUngroupedInternal$.next(n)},new Gt(function(){return e.ungroupedPaneVirtualScroll},24)),this.groupedTreeHelper=new De(function(){for(var n,i=[],r=0,a=null!==(n=e.groupedInternal$.value)&&void 0!==n?n:[];r<a.length;r++){var s=a[r];if(i.push(s),s.isExpanded)for(var c=0,p=s.children;c<p.length;c++)i.push(p[c])}return i},".valuesOrGroupsTopContainer.groupsTopContainer .scrollableContainer",".item",!0,function(n){e.selectedGroupedInternal$.next(n)},function(n){e.focusedGroupedInternal$.next(n)}),this.ungroupedInternal$.pipe((0,K.h)(function(n){return!!n}),(0,L.R)(this.onDestroy$)).subscribe(function(n){e.ungroupedTreeHelper.syncManagedNodes(n)}),this.groupedInternal$.pipe((0,K.h)(function(n){return!!n}),(0,L.R)(this.onDestroy$)).subscribe(function(n){e.groupedTreeHelper.syncManagedNodes(n)})},t.prototype.setupCanGroupUngroup=function(){var e=this;this.canGroup$=(0,ae.aj)([this.selectedUngroupedInternal$,this.selectedGroupedInternal$]).pipe((0,Z.U)(function(n){var i=n[0],a=_.uniq(_.map(n[1],function(s){return R(s)?s:s.parent}));return!_.find(a,function(s){return s.isOther})&&(_.size(i)>0||_.size(a)>1)}),(0,H.x)()),this.canUngroup$=this.selectedGroupedInternal$.pipe((0,Z.U)(function(n){var i=n;return e.forceIncludeOtherGroup&&(i=_.filter(n,function(r){return R(r)?!r.isOther:!r.parent.isOther})),_.size(i)>0}),(0,H.x)())},t.prototype.mergeGroups=function(e){var n,i=this;u.fF.assert(function(){return _.size(e)>1},"Expecting more than 1 group");for(var r=this.createGroupWithEmptyChildren(e),a=0,s=e;a<s.length;a++)(n=r.children).push.apply(n,s[a].children);return _.forEach(r.children,function(d){d.parent=r}),q(r.children),_.every(e,function(d){return d.displayValue===i.getDefaultGroupName(d.children)})&&(r.displayValue=this.getDefaultGroupName(r.children),r.value=r.displayValue),r},t.prototype.createGroupWithEmptyChildren=function(e){var n=(0,m.__spreadArray)([],e,!0);q(n);var i=this.getDefaultGroupName(n);return{id:this.lastNodeId++,isExpanded:!0,displayValue:i,value:i,children:[],isOther:!1}},t.prototype.ensureOtherGroupDislayNameRules=function(e){if(e){u.fF.assert(function(){return e.isOther},"Expect this to be called only on OtherGroup node");var n=this.localizationService.get("Other");e.displayValue.toLocaleLowerCase().indexOf(n.toLocaleLowerCase())<0&&(e.displayValue=this.localizationService.format("NamePattern_Bracket",[e.displayValue,n]))}},t.prototype.ensureGroupHasUniqueName=function(e,n){var i=this.getUniqueNewName(e,n,e.value);e.displayValue=i,e.value=i},t.prototype.getUniqueNewName=function(e,n,i){for(var r=i??this.getDefaultGroupName(e.children),a=_.filter(n,function(p){return p!==e}),s=_.keyBy(a,"displayValue"),c=2;s[r];)r=r+" "+c,c++;return r},t.prototype.updateGroupChildrenAndFixName=function(e,n,i){var r=this.getUniqueNewName(e,n),a=e.displayValue!==r;i(),a||(e.displayValue=this.getUniqueNewName(e,n),e.value=e.displayValue)},t.prototype.getDefaultGroupName=function(e){return(0,V.wU)(_.map(e,function(n){return n.displayValue}),this.localizationService)},t.prototype.getTreeHelper=function(e){return"ungrouped"===e?this.ungroupedTreeHelper:this.groupedTreeHelper},t.\u0275fac=function(n){return new(n||t)(o.\u0275\u0275directiveInject(v.sg),o.\u0275\u0275directiveInject(ge.D),o.\u0275\u0275directiveInject(ye.T),o.\u0275\u0275directiveInject(de.RD),o.\u0275\u0275directiveInject(Te.g),o.\u0275\u0275directiveInject(Me.H),o.\u0275\u0275directiveInject(Ce.o))},t.\u0275cmp=o.\u0275\u0275defineComponent({type:t,selectors:[["groups-list-pane"]],viewQuery:function(n,i){if(1&n&&(o.\u0275\u0275viewQuery(oe.N7,5),o.\u0275\u0275viewQuery(Pt,5,o.ElementRef)),2&n){var r=void 0;o.\u0275\u0275queryRefresh(r=o.\u0275\u0275loadQuery())&&(i._vs=r.first),o.\u0275\u0275queryRefresh(r=o.\u0275\u0275loadQuery())&&(i.groupsListContainerElementRef=r.first)}},inputs:{groupingListInfo:"groupingListInfo"},features:[o.\u0275\u0275ProvidersFeature([]),o.\u0275\u0275InheritDefinitionFeature],decls:32,vars:43,consts:[[1,"listPaneContainer","twoColumnSection",3,"formGroup"],[1,"cell"],["pbiLabel","","localize","GroupsDialog_ValuesListTitle"],["pbiInput","","itemSize","24","tabindex","-1",1,"valuesOrGroupsTopContainer","valuesTopContainer",3,"click"],["role","listbox","aria-multiselectable","true","tabindex","0",3,"focus","blur","keydown"],["class","item firstLevel","role","option",3,"ngClass","click",4,"cdkVirtualFor","cdkVirtualForOf"],["class","item loadingMoreIndicator","localize","GroupsDialog_LoadingMore",4,"ngIf"],["pbiLabel","","localize","GroupsDialog_GroupsTreeTitle"],["pbiInput","",1,"valuesOrGroupsTopContainer","groupsTopContainer"],["tabindex","-1",1,"scrollableContainer",3,"click"],["role","tree","aria-multiselectable","true","tabindex","0",1,"listContainer",3,"focus","blur","keydown"],["allGroupsListContainer",""],["class","groupNodeOverallContainer firstLevel","role","treeitem",3,"id","click",4,"ngFor","ngForOf"],[1,"cell","controlsContainer"],["localize","Group_Action",1,"pbi-fluent-button",3,"disabled","click"],["localize","Ungroup",1,"pbi-fluent-button","ungroup",3,"disabled","click"],["type","checkbox",3,"formControlName","isCompact","label","disabled"],[1,"pbi-icon-button","glyphicon","pbi-glyph-info","glyph-mini","infoLink",3,"click"],["role","option",1,"item","firstLevel",3,"ngClass","click"],[3,"pbiTooltip"],["localize","GroupsDialog_LoadingMore",1,"item","loadingMoreIndicator"],["role","treeitem",1,"groupNodeOverallContainer","firstLevel",3,"id","click"],[1,"item","groupSelfContainer",3,"ngClass"],["name","caretright","size","mini",1,"expandCollapseIcon",3,"click"],[1,"unselectable",3,"displayName","disableClick","editable","inputMatchLabelWidth","customTooltip","cancel","dblclick","onBlur"],["class","groupChildrenContainer","role","listbox",4,"ngIf"],["role","listbox",1,"groupChildrenContainer"],["class","item groupChildContainer","role","option",3,"id","ngClass","click",4,"ngFor","ngForOf"],["role","option",1,"item","groupChildContainer",3,"id","ngClass","click"]],template:function(n,i){1&n&&(o.\u0275\u0275elementStart(0,"form",0)(1,"pbi-form-field",1),o.\u0275\u0275element(2,"label",2),o.\u0275\u0275elementStart(3,"cdk-virtual-scroll-viewport",3),o.\u0275\u0275listener("click",function(a){return i.paneBackgroundClicked.fn({$event:a,type:"ungrouped"})}),o.\u0275\u0275elementStart(4,"ul",4),o.\u0275\u0275listener("focus",function(a){return i.paneFocused.fn({$event:a,type:"ungrouped"})})("blur",function(a){return i.paneBlured.fn({$event:a,type:"ungrouped"})})("keydown",function(a){return i.onPaneKeyDown("ungrouped",a)}),o.\u0275\u0275pipe(5,"async"),o.\u0275\u0275pipe(6,"localize"),o.\u0275\u0275template(7,Ot,3,8,"li",5),o.\u0275\u0275pipe(8,"async"),o.\u0275\u0275template(9,yt,1,0,"span",6),o.\u0275\u0275pipe(10,"async"),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(11,"pbi-form-field",1),o.\u0275\u0275element(12,"label",7),o.\u0275\u0275elementStart(13,"div",8)(14,"div",9),o.\u0275\u0275listener("click",function(a){return i.paneBackgroundClicked.fn({$event:a,type:"grouped"})}),o.\u0275\u0275elementStart(15,"ul",10,11),o.\u0275\u0275listener("focus",function(a){return i.paneFocused.fn({$event:a,type:"grouped"})})("blur",function(a){return i.paneBlured.fn({$event:a,type:"grouped"})})("keydown",function(a){return i.onPaneKeyDown("grouped",a)}),o.\u0275\u0275pipe(17,"async"),o.\u0275\u0275pipe(18,"localize"),o.\u0275\u0275template(19,It,5,14,"li",12),o.\u0275\u0275pipe(20,"async"),o.\u0275\u0275elementEnd()()()(),o.\u0275\u0275elementStart(21,"div",13)(22,"button",14),o.\u0275\u0275listener("click",function(){return i.group()}),o.\u0275\u0275pipe(23,"async"),o.\u0275\u0275pipe(24,"localize"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(25,"button",15),o.\u0275\u0275listener("click",function(){return i.ungroup()}),o.\u0275\u0275pipe(26,"async"),o.\u0275\u0275pipe(27,"localize"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(28,"pbi-checkbox",16),o.\u0275\u0275pipe(29,"localize"),o.\u0275\u0275elementStart(30,"button",17),o.\u0275\u0275listener("click",function(){return i.learnMoreAboutOtherGroup()}),o.\u0275\u0275pipe(31,"localize"),o.\u0275\u0275elementEnd()()()),2&n&&(o.\u0275\u0275property("formGroup",i.listFormGroup),o.\u0275\u0275advance(4),o.\u0275\u0275attribute("aria-activedescendant",o.\u0275\u0275pipeBind1(5,17,i.ungroupedFocusedDescription$))("aria-label",o.\u0275\u0275pipeBind1(6,19,"GroupsDialog_ValuesListTitle")),o.\u0275\u0275advance(3),o.\u0275\u0275property("cdkVirtualForOf",o.\u0275\u0275pipeBind1(8,21,i.ungrouped$)),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!o.\u0275\u0275pipeBind1(10,23,i.loadColumnValuesCompleted$)),o.\u0275\u0275advance(6),o.\u0275\u0275attribute("aria-activedescendant",o.\u0275\u0275pipeBind1(17,25,i.groupedFocusedDescription$))("aria-label",o.\u0275\u0275pipeBind1(18,27,"GroupsDialog_GroupsTreeTitle")),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",o.\u0275\u0275pipeBind1(20,29,i.grouped$)),o.\u0275\u0275advance(3),o.\u0275\u0275property("disabled",!o.\u0275\u0275pipeBind1(23,31,i.canGroup$)),o.\u0275\u0275attribute("aria-label",o.\u0275\u0275pipeBind1(24,33,"Group_Action")),o.\u0275\u0275advance(3),o.\u0275\u0275property("disabled",!o.\u0275\u0275pipeBind1(26,35,i.canUngroup$)),o.\u0275\u0275attribute("aria-label",o.\u0275\u0275pipeBind1(27,37,"Ungroup")),o.\u0275\u0275advance(3),o.\u0275\u0275property("formControlName",i.includeOtherGroupToggleControlName)("isCompact",!0)("label",o.\u0275\u0275pipeBind1(29,39,"GroupsDialog_EnableOtherGroupAction"))("disabled",i.forceIncludeOtherGroup),o.\u0275\u0275advance(2),o.\u0275\u0275attribute("aria-label",o.\u0275\u0275pipeBind1(31,41,"Generic_LearnMore")))},dependencies:[A.NgClass,A.NgForOf,A.NgIf,ft.V,fe.X,ht.v,Q.bP,Q.ug,Q.nm,mt._,vt.V,v._Y,v.JJ,v.JL,v.sg,v.u,oe.xd,oe.x0,oe.N7,A.AsyncPipe,_t.F],styles:['.groupsDialogContent[_ngcontent-%COMP%]{width:720px;height:480px;display:flex;flex-direction:column}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection{display:grid;grid-template-columns:1fr 1fr;grid-gap:12px 12px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell{display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select{padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input{vertical-align:middle;margin:0;padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input[readonly]{background-color:var(--colorNeutralBackgroundDisabled);color:var(--colorNeutralForegroundDisabled);pointer-events:none}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input::selection{background:var(--colorNeutralBackgroundInverted);color:var(--colorNeutralForegroundInverted)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-size:var(--sm-font-size, 12px)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-weight:var(--font-weight-normal, 500)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls{flex:1;display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls [pbiInput], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls [pbiInput]{flex:1}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown{width:100%}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button{border:1px solid var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button[disabled], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button[disabled]{background-color:var(--colorNeutralBackgroundDisabled)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button .pbi-dropdown-trigger-container, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button .pbi-dropdown-trigger-container{margin:0;padding:4px 8px}.groupsDialogContent[_ngcontent-%COMP%]   .topSection[_ngcontent-%COMP%]{margin-bottom:12px}.groupsDialogContent[_ngcontent-%COMP%]   groups-list-pane[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]   groups-bins-pan[_ngcontent-%COMP%]{flex:1}','.listPaneContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;grid-template-rows:1fr auto}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .valuesOrGroupsTopContainer[_ngcontent-%COMP%]{border:1px solid var(--gray-60, #C8C6C4);outline:none;flex:1}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%;padding:2px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]:focus, .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]:focus-within{border-color:var(--gray-130, #605E5C)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer[_ngcontent-%COMP%]{position:relative}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]:focus, .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]:focus-within{border-color:var(--gray-130, #605E5C)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;padding:2px;overflow-x:hidden;overflow-y:auto}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]{padding:0;margin:0}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:list-item}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   li.groupNodeOverallContainer[_ngcontent-%COMP%]{list-style:none;display:block}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   li.groupChildContainer[_ngcontent-%COMP%]{list-style:circle}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{line-height:12px}html:not([dir="rtl"])[_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-right:4px}html[dir="rtl"][_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-left:4px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   pbi-icon.expandCollapseIcon[_ngcontent-%COMP%]{transform:translateY(6px)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer.role-expanded[_ngcontent-%COMP%]     .pbi-glyph-caretright{-webkit-transform:rotate(0deg);transform:rotate(0)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   editable-label[_ngcontent-%COMP%]{flex:1;display:block}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]   editable-label[_ngcontent-%COMP%]     .textLabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}html:not([dir="rtl"])[_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupChildrenContainer[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupChildrenContainer[_ngcontent-%COMP%]{padding-left:36px}html[dir="rtl"][_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupChildrenContainer[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   div.valuesOrGroupsTopContainer.groupsTopContainer[_ngcontent-%COMP%]   .scrollableContainer[_ngcontent-%COMP%]   .listContainer[_ngcontent-%COMP%]   .groupChildrenContainer[_ngcontent-%COMP%]{padding-right:36px}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:3;display:flex;flex-direction:row;align-items:center}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   button.pbi-fluent-button[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}html:not([dir="rtl"])[_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   button.pbi-fluent-button.ungroup[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   button.pbi-fluent-button.ungroup[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   button.pbi-fluent-button.ungroup[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   button.pbi-fluent-button.ungroup[_ngcontent-%COMP%]{margin-right:8px}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin:0}html:not([dir="rtl"])[_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin-left:auto}html[dir="rtl"][_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin-right:auto}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]     input[type=checkbox]{padding:0}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]     label{font-weight:var(--font-weight-regular, 400)}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{cursor:pointer}html:not([dir="rtl"])[_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-left:4px}html[dir="rtl"][_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:4px}.listPaneContainer[_ngcontent-%COMP%]   .cell.controlsContainer[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]     .pbi-glyph-info{transform:translateY(4px)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;outline-style:none}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:0}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.firstLevel[_ngcontent-%COMP%] > span[_ngcontent-%COMP%], .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .groupSelfContainer[_ngcontent-%COMP%]{padding:0 8px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.role-selected[_ngcontent-%COMP%], .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .role-selected[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-light-color, #EDEBE9)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.role-focused[_ngcontent-%COMP%], .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .role-focused[_ngcontent-%COMP%]{outline:dotted 1px var(--fluent-theme-neutral-dark-color, #201F1E);outline-offset:-1px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.role-missing[_ngcontent-%COMP%]{color:var(--gray-100, #979593)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]     editable-label .editableLabel{display:flex;align-items:center}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]     editable-label .editableLabel input{padding:0 5px;height:24px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], .listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;height:24px;line-height:24px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .item.loadingMoreIndicator[_ngcontent-%COMP%]{text-align:center}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .pbi-icon-button[_ngcontent-%COMP%]{margin:0 4px}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .pbi-icon-button.glyph-mini[_ngcontent-%COMP%]{height:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px)}.listPaneContainer[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .pbi-icon-button[_ngcontent-%COMP%]:focus{border:none;outline-offset:2px}'],changeDetection:0}),t}(gt.w),Gt=function(){function l(t,e){this.getVirtualScroll=t,this.itemSize=e}return l.prototype.scrollItemIntoView=function(t,e){var n=this.getVirtualScroll(),i=Math.floor(n.getViewportSize()/this.itemSize),r=Math.max(t-i+1,0);n.scrollToIndex(r)},l.prototype.handleKeyDown=function(t,e,n){var i=!0,r=t,a=this.getVirtualScroll(),s=Math.floor(a.getViewportSize()/this.itemSize);switch(e.code){case"PageUp":r=Math.max(t-s,0);break;case"PageDown":r=Math.min(t+s,a.getDataLength()-1);break;case"End":r=a.getDataLength()-1;break;case"Home":r=0;break;case"ArrowUp":r=Math.max(t-1,0);break;case"ArrowDown":r=Math.min(t+1,a.getDataLength()-1);break;default:i=!1}return null!=r&&r!==t&&(n(r),this.scrollItemIntoView(r)),i},l.prototype.onScroll=function(t){},l}(),Bt=function(){function l(){}return l.createValidator=function(t,e){return function(n){return l.registeredControls.has(n)||(l.registeredControls.add(n),t.pipe((0,L.R)(e),(0,we.b)(function(i){n.updateValueAndValidity()})).subscribe()),_.find(t.value,function(i){return!i.isOther})?null:{noNormalGroup:!0}}},l.registeredControls=new Set,l}();function R(l){return!_.isEmpty(l?.children)}function se(l){return!!l&&!R(l)}function q(l){_.isEmpty(l)||l.sort(Nt)}function Nt(l,t){if(R(l)!==R(t))return u.fF.assertFail("Expect to compare nodes of same type (both group or both value"),-1;if(R(l)&&R(t)){if(!l.isOther&&t.isOther)return-1;if(l.isOther&&!t.isOther)return 1}return se(l)&&se(t)?l.sortKey<t.sortKey?-1:l===t?0:1:(l.displayValue||"").localeCompare(t.displayValue||"")}function Be(l,t,e){return e.format(1===l?"GroupsDialog_NamePattern":"BinsDialog_NamePattern",[t])}var Ne=g(47755),zt=g(42111),Et=g(76001),Ft=g(80777),ze=g(67489),Vt=g(22318),$t=g(26898),Lt=g(23983),Rt=g(96777),Ee=g(76492),Ut=g(42189),kt=g(9529);function Ht(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"pbi-dropdown-item",13)(1,"span"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd()()),2&l){var e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.displayName)}}function At(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"pbi-dropdown-item",13)(1,"span"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd()()),2&l){var e=t.$implicit;o.\u0275\u0275property("value",e),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.displayName)}}function jt(l,t){if(1&l&&(o.\u0275\u0275elementStart(0,"pbi-form-field",2),o.\u0275\u0275element(1,"label",14),o.\u0275\u0275elementStart(2,"pbi-dropdown",15)(3,"pbi-dropdown-trigger")(4,"span"),o.\u0275\u0275text(5),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(6,At,3,2,"pbi-dropdown-item",9),o.\u0275\u0275elementEnd()()),2&l){var n,e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(5),o.\u0275\u0275textInterpolate(null==(n=e.dialogForm.get("displayBinModeSelection"))||null==n.value?null:n.value.displayName),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",e.displayBinModes)}}function Wt(l,t){if(1&l&&o.\u0275\u0275element(0,"groups-list-pane",16),2&l){var e=o.\u0275\u0275nextContext();o.\u0275\u0275property("formGroup",e.dialogForm)("groupingListInfo",e.groupingListInfo)}}function Kt(l,t){if(1&l&&o.\u0275\u0275element(0,"groups-bins-pane",17),2&l){var n,e=o.\u0275\u0275nextContext();o.\u0275\u0275property("formGroup",e.dialogForm)("binMode",null==(n=e.dialogForm.get("displayBinModeSelection"))||null==n.value?null:n.value.value)("binningColumnInfo",e.binningColumnInfo)}}var Fe=function(){function l(t,e,n,i,r,a,s){this.conceptualSchemaProxy=t,this.dataSourcesService=e,this.groupAuthoringService=n,this.groupingDesignStateService=i,this.highContrastCssGenerationService=r,this.localizationService=a,this.templateDialogPayload=s,this.destroy$=new le.xQ,this.initializeHighContrastRules()}return l.prototype.ngOnInit=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var t,e;return(0,m.__generator)(this,function(n){switch(n.label){case 0:return(0,V.MF)(this.dataSourcesService),this.groupModeToDisplayGroupModeDict=((t={})[1]={value:1,displayName:this.localizationService.get("List")},t[2]={value:2,displayName:this.localizationService.get("GroupsDialog_ModeBins")},t),this.binModeToDisplayBinModeDict=((e={})[1]={value:1,displayName:this.localizationService.get("BinsDialog_ModeByCount")},e[0]={value:0,displayName:this.localizationService.get("BinsDialog_ModeBySize")},e),[4,this.initialize()];case 1:return n.sent(),[2]}})})},l.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},l.prototype.initialize=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var t,e=this;return(0,m.__generator)(this,function(n){switch(n.label){case 0:return this.groupNameInput=new v.p4("",[function(l){var t;return _.isEmpty(null===(t=l.value)||void 0===t?void 0:t.trim())?{errorType:"emptyName"}:null}]),this.displayGroupModeSelection=new v.p4,this.displayBinModeSelection=new v.p4,this.dialogForm=new v.nJ({groupNameInput:this.groupNameInput,displayGroupModeSelection:this.displayGroupModeSelection,displayBinModeSelection:this.displayBinModeSelection}),this.dialogForm.statusChanges.pipe((0,K.h)(function(i){return"VALID"===i||"INVALID"===i})).subscribe(function(i){e.templateDialogPayload.setOkButtonState("INVALID"===i)}),this.templateDialogPayload.onOkButtonClick=function(){return e.onCommit()},t=this,[4,this.parseInitialLoad()];case 1:return t.info=n.sent(),this.initializeNamesInfo(this.info),this.initializeGroupModesInfo(this.info),this.initializeListModeInfo(this.info),this.initializeBinningModeInfo(this.info),[2]}})})},l.prototype.parseInitialLoad=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var t,e,n,i,r,a,s,c,p,d,M,I,b,D;return(0,m.__generator)(this,function(P){switch(P.label){case 0:return e=(t=this.templateDialogPayload.input).schema,n=t.entity,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return i=P.sent(),r=i.schema(e),a=r.entities.withName(n),t.isNew?(D=a.properties.withName(t.sourcePropertyName),s=ve(D),[2,{schema:r,entity:a,groupDataType:(0,V.SK)(s),sourceProperty:D,sourcePropertyValueType:s}]):(c=a.properties.withName(t.name),p=ve(c),d=this.groupingDesignStateService.getGroupingDesignState(n,c.name),M=(0,V.ZP)(c.column.groupingMetadata,(0,N.nw)(e,n)),u.fF.assert(function(){return _.size(M)<=1},"No more than 1 grouped column is supported noew"),I=(0,Et.Q)(M[0]),b=(0,zt.Hp)(I),D=a.properties.withName(b),[2,{schema:r,entity:a,groupDataType:(0,V.SK)(p),sourceProperty:D,sourcePropertyValueType:ve(D),existing:{groupProperty:c,groupPropertyValueType:p,definition:d,binningInfo:Xt(d)}}])}})})},l.prototype.initializeGroupModesInfo=function(t){var i,e=this,n=!t.existing;this.displayGroupModes=[],n?(this.displayGroupModes.push(this.groupModeToDisplayGroupModeDict[1]),0!==t.groupDataType&&this.displayGroupModes.push(this.groupModeToDisplayGroupModeDict[2]),i=Ve(t.groupDataType)):(i=function(l,t){return l?.binItem?2:_.isEmpty(l?.groupItems)?Ve(t):1}(t.existing.definition,t.groupDataType),this.displayGroupModes.push(this.groupModeToDisplayGroupModeDict[i])),this.displayGroupModeSelection.setValue(this.groupModeToDisplayGroupModeDict[i]),u.fF.assert(function(){return!!_.find(e.displayGroupModes,function(r){return r.value===i})},"selected group mode has to be one of the displayed modes"),this.isGroupModeSelectionDisabled=!n||this.displayGroupModes.length<2},l.prototype.initializeBinningModeInfo=function(t){var n,i,e=this;if(u.fF.assert(function(){return!_.isEmpty(e.displayGroupModes)},"this.displayGroupModes should already been initialized"),_.find(this.displayGroupModes,function(d){return 2===d.value})){var s=!!(null===(n=t.entity.capabilities)||void 0===n?void 0:n.supportsBinByCount)&&!!t.schema.capabilities.canEdit;this.displayBinModes=[this.binModeToDisplayBinModeDict[0]],s&&this.displayBinModes.push(this.binModeToDisplayBinModeDict[1]);var p,c=null===(i=t.existing)||void 0===i?void 0:i.binningInfo;t.existing?(u.fF.assert(function(){return!!c},"There should be existing binning info"),!s&&1===c.mode&&(c={mode:0,binSizeUnit:void 0}),p=c.mode):p=0,this.displayBinModeSelection.setValue(this.binModeToDisplayBinModeDict[p]),this.binningColumnInfo={isNew:!t.existing,schemaName:t.schema.name,entityName:t.entity.name,sourcePropertyName:this.sourcePropertyName,valueType:t.existing?t.existing.groupPropertyValueType:t.sourcePropertyValueType,groupDataType:t.groupDataType,supportBinByCountMode:s},c&&(0===c.mode?this.binningColumnInfo.binSizeUnit=c.binSizeUnit:this.binningColumnInfo.binCount=c.binCount)}},l.prototype.initializeListModeInfo=function(t){var e;u.fF.assertValue(this.sourcePropertyName,"This should be called after this.sourcePropertyName is set"),this.groupingListInfo={schema:t.schema.name,entity:t.entity,existing:t.existing?{groupProperty:t.existing.groupProperty,groups:null===(e=t.existing.definition)||void 0===e?void 0:e.groupItems}:void 0,sourceProperty:t.sourceProperty,sourcePropertyValueType:t.sourcePropertyValueType}},l.prototype.initializeNamesInfo=function(t){var e,n=this;this.sourcePropertyName=t.sourceProperty.name,t.existing?this.groupNameInput.setValue(t.existing.groupProperty.name):(this.groupModeToDefaultGroupNameDict=((e={})[1]=Be(1,this.sourcePropertyName,this.localizationService),e[2]=Be(2,this.sourcePropertyName,this.localizationService),e),u.fF.assert(function(){var r;return!(null!==(r=n.displayGroupModeSelection)&&void 0!==r&&r.value)},"We need to call this BEFORE first time displayGroupModeSelection value is set"),this.displayGroupModeSelection.valueChanges.pipe((0,Vt.O)(null),(0,xe.G)()).subscribe(function(r){var a=r[0],s=r[1];s&&n.checkToUpdateGroupName(a?.value,s.value)}))},l.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule('.themeableElement .groupsDialogContent input[readonly=""]',"{ color: @disabledTextColor !important; border-color: @disabledTextColor !important; }")},l.prototype.checkToUpdateGroupName=function(t,e){var i,n=this;u.fF.assert(function(){return!_.isEmpty(n.sourcePropertyName)},"Expect this to be called after this.sourcePropertyName is set"),u.fF.assert(function(){return!_.isEmpty(n.groupModeToDefaultGroupNameDict)},"Expect this to be called after this.groupModeToDefaultGroupNameDict is set");var r=!0;t!==e&&null!=t&&this.groupModeToDefaultGroupNameDict[t]!==(null===(i=this.groupNameInput.value)||void 0===i?void 0:i.trim())&&(r=!1),r&&this.groupNameInput.setValue(this.groupModeToDefaultGroupNameDict[e])},l.prototype.onCommit=function(){return(0,m.__awaiter)(this,void 0,void 0,function(){var e,n,i,r=this;return(0,m.__generator)(this,function(a){switch(a.label){case 0:return this.templateDialogPayload.setOkButtonState(!0),u.fF.assertValue(this.displayGroupModeSelection.value,"this.displayGroupModeSelection.value should be defined at this point"),n=1===(e=this.displayGroupModeSelection.value.value)?this.listPane.getDefinition():this.binsPane.getDefinition(),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return i=a.sent(),[2,new Promise(function(s,c){return(0,m.__awaiter)(r,void 0,void 0,function(){var p,d,y,M,I,b,D,P,G,E,x;return(0,m.__generator)(this,function(k){switch(k.label){case 0:if(!this.groupAuthoringService.core.validateGroupDefinition(i,n))return this.templateDialogPayload.setOkButtonState(!1),[2];1===e?this.listPane.logTelemetryOnCommit(n):this.binsPane.logTelemetryOnCommit(),d=2===e,y=this.info.schema.name,M=this.info.entity.name,I=this.groupNameInput.value,b=[],(p=!this.info.existing)?(D={schema:y,entity:M,name:I,definition:(0,Ne.qC)(n)},b.push(d?{newBins:D}:{newGroups:D})):(G={schema:y,entity:M,property:P=this.info.existing.groupProperty.name,definition:(0,Ne.qC)(n)},b.push(d?{updateBinsMetadata:G}:{updateGroupsDefinition:G}),I!==P&&b.push({propertyRename:{schema:y,entity:M,before:P,after:I,objectType:"Column"}})),E=d?"Bin":"List",x=p?"Create":"Update",k.label=1;case 1:return k.trys.push([1,3,,4]),[4,this.groupAuthoringService.core.applyModelChanges(E,x,b)];case 2:return k.sent(),s({groupMode:e}),[3,4];case 3:return k.sent(),this.templateDialogPayload.setOkButtonState(!1),[3,4];case 4:return[2]}})})})]}})})},l.\u0275fac=function(e){return new(e||l)(o.\u0275\u0275directiveInject($t.i),o.\u0275\u0275directiveInject(ge.D),o.\u0275\u0275directiveInject(de.RD),o.\u0275\u0275directiveInject(Lt.AA),o.\u0275\u0275directiveInject(Te.g),o.\u0275\u0275directiveInject(Ce.o),o.\u0275\u0275directiveInject(ze.x))},l.\u0275cmp=o.\u0275\u0275defineComponent({type:l,selectors:[["groups-dialog"]],viewQuery:function(e,n){if(1&e&&(o.\u0275\u0275viewQuery(me,5),o.\u0275\u0275viewQuery(he,5)),2&e){var i=void 0;o.\u0275\u0275queryRefresh(i=o.\u0275\u0275loadQuery())&&(n.listPane=i.first),o.\u0275\u0275queryRefresh(i=o.\u0275\u0275loadQuery())&&(n.binsPane=i.first)}},features:[o.\u0275\u0275ProvidersFeature([ze.x])],decls:19,vars:8,consts:[[1,"groupsDialogContent",3,"formGroup"],[1,"topSection","twoColumnSection"],[1,"cell"],["pbiLabel","","for","name-input","localize","Name"],["pbiInput","","required","","id","name-input","cdkFocusInitial","","formControlName","groupNameInput","spellcheck","false"],["pbiLabel","","for","source-property-name","localize","Field"],["pbiInput","","readonly","","id","source-property-name","spellcheck","false",3,"value"],["pbiLabel","","localize","GroupsDialog_GroupType"],["pbiInput","","formControlName","displayGroupModeSelection",3,"isDisabled"],[3,"value",4,"ngFor","ngForOf"],["class","cell",4,"ngIf"],[3,"formGroup","groupingListInfo",4,"ngIf"],[3,"formGroup","binMode","binningColumnInfo",4,"ngIf"],[3,"value"],["pbiLabel","","localize","GroupsDialog_BinType"],["pbiInput","","formControlName","displayBinModeSelection"],[3,"formGroup","groupingListInfo"],[3,"formGroup","binMode","binningColumnInfo"]],template:function(e,n){var i,r,a,s;(1&e&&(o.\u0275\u0275elementStart(0,"template-dialog")(1,"form",0)(2,"div",1)(3,"pbi-form-field",2),o.\u0275\u0275element(4,"label",3)(5,"input",4),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"pbi-form-field",2),o.\u0275\u0275element(7,"label",5)(8,"input",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"pbi-form-field",2),o.\u0275\u0275element(10,"label",7),o.\u0275\u0275elementStart(11,"pbi-dropdown",8)(12,"pbi-dropdown-trigger")(13,"span"),o.\u0275\u0275text(14),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(15,Ht,3,2,"pbi-dropdown-item",9),o.\u0275\u0275elementEnd()(),o.\u0275\u0275template(16,jt,7,2,"pbi-form-field",10),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(17,Wt,1,2,"groups-list-pane",11),o.\u0275\u0275template(18,Kt,1,3,"groups-bins-pane",12),o.\u0275\u0275elementEnd()()),2&e)&&(o.\u0275\u0275advance(1),o.\u0275\u0275property("formGroup",n.dialogForm),o.\u0275\u0275advance(7),o.\u0275\u0275property("value",n.sourcePropertyName),o.\u0275\u0275advance(3),o.\u0275\u0275property("isDisabled",n.isGroupModeSelectionDisabled),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(null==(i=n.dialogForm.get("displayGroupModeSelection"))||null==i.value?null:i.value.displayName),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",n.displayGroupModes),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",2===(null==(r=n.dialogForm.get("displayGroupModeSelection"))||null==r.value?null:r.value.value)),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",1===(null==(a=n.dialogForm.get("displayGroupModeSelection"))||null==a.value?null:a.value.value)),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",2===(null==(s=n.dialogForm.get("displayGroupModeSelection"))||null==s.value?null:s.value.value)))},dependencies:[A.NgForOf,A.NgIf,Rt.J,fe.X,Ee.H,Ut.r,kt._,Ee.T,Q.bP,Q.ug,Q.nm,v._Y,v.Fj,v.JJ,v.JL,v.Q7,v.sg,v.u,he,me],styles:['.groupsDialogContent[_ngcontent-%COMP%]{width:720px;height:480px;display:flex;flex-direction:column}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection{display:grid;grid-template-columns:1fr 1fr;grid-gap:12px 12px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell{display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select{padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell textarea:focus, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell select:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input{vertical-align:middle;margin:0;padding:4px 8px;border-color:var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input[readonly]{background-color:var(--colorNeutralBackgroundDisabled);color:var(--colorNeutralForegroundDisabled);pointer-events:none}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::selection, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input::selection{background:var(--colorNeutralBackgroundInverted);color:var(--colorNeutralForegroundInverted)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell input, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-size:var(--sm-font-size, 12px)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection .cell label, .groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   label.cell[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection label.cell{font-weight:var(--font-weight-normal, 500)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls{flex:1;display:flex}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-form-field.cell[_ngcontent-%COMP%]     .controls [pbiInput], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-form-field.cell   .controls [pbiInput]{flex:1}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown{width:100%}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button{border:1px solid var(--gray-60, #C8C6C4)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button:focus, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button:focus{border-color:var(--gray-130, #605E5C)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button[disabled], .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button[disabled]{background-color:var(--colorNeutralBackgroundDisabled)}.groupsDialogContent[_ngcontent-%COMP%]   .twoColumnSection[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]     button .pbi-dropdown-trigger-container, .groupsDialogContent[_ngcontent-%COMP%]     .twoColumnSection pbi-dropdown   button .pbi-dropdown-trigger-container{margin:0;padding:4px 8px}.groupsDialogContent[_ngcontent-%COMP%]   .topSection[_ngcontent-%COMP%]{margin-bottom:12px}.groupsDialogContent[_ngcontent-%COMP%]   groups-list-pane[_ngcontent-%COMP%], .groupsDialogContent[_ngcontent-%COMP%]   groups-bins-pan[_ngcontent-%COMP%]{flex:1}'],changeDetection:0}),l}();function Xt(l){var t=l?.binItem;if(t)if((0,ie.RN)(t)){var e=t.source;if((0,ie.P4)(e))return{mode:1,binCount:e.count};u.fF.assertFail("When binItem is of type SQMemberExpr, expect binItem.source is isDiscretize")}else{if((0,ie.xb)(t)){var s=t.timeUnit;return{mode:0,binSizeUnit:{size:t.size,unit:null!=s?(0,V.rU)(s):0}}}u.fF.assertFail("Expect binItem to be either SQMemberExpr or SQFloorExpr")}}function Ve(l){return 0===l?1:2}function ve(l){var t=l.type;return t.underlyingType&&(t=Ft.Ge.fromExtendedType(t.underlyingType)),t}var Yt=g(79061),Zt=g(42729),qt=g(16987),en=g(47913),tn=g(6015),nn=g(14525),on=g(93367),rn=g(16095),ln=function(){function l(){}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=o.\u0275\u0275defineNgModule({type:l}),l.\u0275inj=o.\u0275\u0275defineInjector({imports:[A.CommonModule,Zt.c.withManifest([{componentIdentifier:at.i,componentType:Fe}]),qt.w,Yt.v,en.V,tn.C,nn.g,on.U,rn.Z,v.UX,oe.Cl]}),l}()},45074:function(ce,X,g){g.d(X,{bP:function(){return S},nm:function(){return B},uC:function(){return w},ug:function(){return Y}});var m=g(4437),u=g(50423),J=[[["","pbiLabel",""]],[["","pbiInput",""]],[["","pbiInputButton",""]],[["","pbiInputError",""]]],j=["[pbiLabel]","[pbiInput]","[pbiInputButton]","[pbiInputError]"],W=0,Y=function(){function f(C,h){this.elementRef=C,this.formField=h}return f.\u0275fac=function(h){return new(h||f)(u.\u0275\u0275directiveInject(u.ElementRef),u.\u0275\u0275directiveInject((0,u.forwardRef)(function(){return S})))},f.\u0275dir=u.\u0275\u0275defineDirective({type:f,selectors:[["","pbiInput",""]],hostAttrs:["autocomplete","off"],hostVars:3,hostBindings:function(h,O){2&h&&u.\u0275\u0275attribute("aria-required",O.required||null)("aria-describedby",null==O.formField.error?null:O.formField.error.id)("aria-invalid",O.formField.error?"true":"false")},inputs:{required:"required"}}),f}(),B=function(){function f(C,h){this.elementRef=C,this.formField=h}return f.\u0275fac=function(h){return new(h||f)(u.\u0275\u0275directiveInject(u.ElementRef),u.\u0275\u0275directiveInject((0,u.forwardRef)(function(){return S})))},f.\u0275dir=u.\u0275\u0275defineDirective({type:f,selectors:[["","pbiLabel",""]],hostVars:2,hostBindings:function(h,O){2&h&&u.\u0275\u0275classProp("pbi-label-required",null!=O.formField.input.required)}}),f}(),w=function(){function f(){this.id="pbi-input-error-id-".concat(W++)}return f.\u0275fac=function(h){return new(h||f)},f.\u0275dir=u.\u0275\u0275defineDirective({type:f,selectors:[["","pbiInputError",""]],hostVars:3,hostBindings:function(h,O){2&h&&(u.\u0275\u0275attribute("id",O.id),u.\u0275\u0275classProp("pbi-input-error",!0))}}),f}(),S=function(){function f(C){this.renderer=C,this._compact=!1}return Object.defineProperty(f.prototype,"compact",{get:function(){return this._compact},set:function(h){this._compact=(0,m.Ig)(h)},enumerable:!1,configurable:!0}),f.prototype.ngAfterContentInit=function(){if(this.input&&this.label){var C="pbi-input-id-".concat(W++);this.renderer.setAttribute(this.input.elementRef.nativeElement,"id",C),this.renderer.setAttribute(this.label.elementRef.nativeElement,"for",C)}},f.\u0275fac=function(h){return new(h||f)(u.\u0275\u0275directiveInject(u.Renderer2))},f.\u0275cmp=u.\u0275\u0275defineComponent({type:f,selectors:[["pbi-form-field"]],contentQueries:function(h,O,T){if(1&h&&(u.\u0275\u0275contentQuery(T,Y,5),u.\u0275\u0275contentQuery(T,B,5),u.\u0275\u0275contentQuery(T,w,5)),2&h){var U=void 0;u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(O.input=U.first),u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(O.label=U.first),u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(O.error=U.first)}},hostVars:2,hostBindings:function(h,O){2&h&&u.\u0275\u0275classProp("pbi-compact-form-field",O.compact)},inputs:{compact:"compact"},ngContentSelectors:j,decls:5,vars:0,consts:[[1,"controls"]],template:function(h,O){1&h&&(u.\u0275\u0275projectionDef(J),u.\u0275\u0275projection(0),u.\u0275\u0275elementStart(1,"div",0),u.\u0275\u0275projection(2,1),u.\u0275\u0275projection(3,2),u.\u0275\u0275elementEnd(),u.\u0275\u0275projection(4,3))},styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;--input-border-color: var(--gray-110);--input-foreground: var(--gray-140);--disabled-input-background: var(--gray-20);--disabled-input-border-color: var(--gray-60);--disabled-input-foreground: var(--gray-90);--focused-input-border-color: var(--gray-130);--focused-input-foreground: var(--gray-180);--error-color: var(--fluent-theme-error-dark-color)}[data-legacy-theming=false]   [_nghost-%COMP%]{--input-border-color: var(--colorNeutralStroke1);--input-foreground: var(--colorNeutralForeground1);--disabled-input-background: var(--colorNeutralBackgroundDisabled);--disabled-input-border-color: var(--colorNeutralStrokeDisabled);--disabled-input-foreground: var(--colorNeutralForegroundDisabled);--focused-input-border-color: var(--colorNeutralStrokeFocus2);--focused-input-foreground: var(--colorNeutralForeground1);--error-color: var(--fluent-theme-error-dark-color)}.pbi-form-field-inline[_nghost-%COMP%] {flex-direction:row;align-items:center;justify-content:space-between}.pbi-form-field-inline[_nghost-%COMP%]  label{margin:0 8px 0 0}.pbi-form-field-inline[_nghost-%COMP%]  .controls{flex-grow:1;justify-content:flex-end}.pbi-compact-form-field[_nghost-%COMP%]  label{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.pbi-compact-form-field[_nghost-%COMP%]  input{height:28px;padding:4px 6px}.pbi-compact-form-field[_nghost-%COMP%]  textarea{padding:4px 6px}[_nghost-%COMP%]  *{box-sizing:border-box}[_nghost-%COMP%]  label{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);margin:0 0 4px}[_nghost-%COMP%]  label.pbi-label-required:after{content:"*";margin-left:4px;color:var(--error-color)}[_nghost-%COMP%]  .controls{display:flex}[_nghost-%COMP%]  .controls>*:not(:last-child){margin-right:8px}[_nghost-%COMP%]  input{height:32px}[_nghost-%COMP%]  textarea{resize:none}[_nghost-%COMP%]  input, [_nghost-%COMP%]  textarea{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);width:100%;border-radius:2px;border:1px solid var(--input-border-color);color:var(--input-foreground);outline:none;padding:8px 6px}[_nghost-%COMP%]  input[disabled], [_nghost-%COMP%]  textarea[disabled], [_nghost-%COMP%]  input[aria-disabled=true], [_nghost-%COMP%]  textarea[aria-disabled=true]{background-color:var(--disabled-input-background);border-color:var(--disabled-input-border-color);color:var(--disabled-input-foreground)}[_nghost-%COMP%]  input:focus, [_nghost-%COMP%]  textarea:focus{border-color:var(--focused-input-border-color);color:var(--focused-input-foreground)}[_nghost-%COMP%]  [pbiInput][aria-invalid=true]{border-color:var(--error-color)}[_nghost-%COMP%]  .pbi-input-error{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin:4px 0 0;color:var(--error-color)}'],changeDetection:0}),f}()}}]);