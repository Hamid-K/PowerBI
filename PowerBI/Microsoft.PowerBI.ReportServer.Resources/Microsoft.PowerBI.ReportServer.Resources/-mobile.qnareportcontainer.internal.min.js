"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["qnareportcontainer.internal"],{65947:function(we,k,i){i.d(k,{z:function(){return e}});var e=new(i(50423).InjectionToken)("QnaModelUtilsPath")},12123:function(we,k,i){i.d(k,{n:function(){return e}});var e=new(i(50423).InjectionToken)("QnaProxyPath")},71691:function(we,k,i){i.r(k),i.d(k,{QnaReportContainerInternalModule:function(){return Se}});var u=i(81337),e=i(50423),W=i(33567),A=i(22543),M=i(14463),J=i(74804),F=i(8590),te=i(47245),b=i(61903),se=i(46616),ge=i(47508),le=i(62458),Y=i(39681),K=i(46135),Ie=i(4954),de=i(40713),Je=i(37320),ne=i(72129),Be=i(282),qe=i(73360),$e=i(35691),he=i(46544),Qe=i(35510),ze=i(30794),_e=i(83317),Le=i(14172),E=i(83008),d=i(48145),f=i(21024),y=i(77200),w=i(10861),T=i(94130),V=i(11494),Q=i(94717),j=i(80277),q=i(39503),X=i(9380),xe=i(40956),be=i(58991),fe=i(4877),Ce=i(67660),ie=i(65181),De=i(2330),oe=i(52121),$=i(84916),re=i(77832),Ae=i(1599),ue=i(77476),Ze=i(18460),tt=i(78565),Te=i(16400),me=i(98885),nt=i(50480),St=i(46101),st=i(44581),lt=i(59968),wt=i(22844),Mt=i(73425),Et=i(1240),it=i(53188),Ft=["qnaReportContainer"],It=["contentContainer"];function xt(o,r){1&o&&(e.\u0275\u0275elementStart(0,"div",12)(1,"div",13),e.\u0275\u0275element(2,"spinner",14)(3,"span",15),e.\u0275\u0275elementEnd()()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("delay",0))}function bt(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"canvas-visual-error-overlay",17),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(n);var S=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(S.showQnaVisualErrorDetails())}),e.\u0275\u0275elementEnd()()}if(2&o){var a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("errorInfo",a.viewModel.error)("viewport",a.componentViewport)}}function Tt(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"qna-input-v2-lazy",20),e.\u0275\u0275listener("inputBoxFocused",function(S){e.\u0275\u0275restoreView(n);var z=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(z.onInputBoxFocused(S))}),e.\u0275\u0275elementEnd()}if(2&o){var a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("entryPoint",a.viewModel.qnaInputConfiguration.entryPoint)("qnaSupportedScopes",a.viewModel.qnaInputConfiguration.qnaSupportedScopes)("interpretListener",a.viewModel.qnaInputConfiguration.interpretListener)("presentationArgs",a.inputPresentation)("configs",a.viewModel.qnaInputConfiguration.configs)("initialUtterance",a.viewModel.qnaInputConfiguration.initialUtterance)}}function Ot(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",18),e.\u0275\u0275template(1,Tt,1,6,"qna-input-v2-lazy",19),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.viewModel.qnaInputConfiguration)}}var Vt=function(r){return{color:r}},Bt=function(r){return{tooltipShowOnFocus:!0,tooltipShowOnHover:!0,tooltipDescription:r}};function zt(o,r){if(1&o&&e.\u0275\u0275element(0,"i",21),2&o){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,Vt,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.color))("pbi-tooltip",e.\u0275\u0275pureFunction1(5,Bt,n.displayedRestatement)),e.\u0275\u0275attribute("aria-label",n.displayedRestatement)}}var Dt=function(r,n,a,p,S,z,O){return{"background-color":r,color:n,"font-size":a,"font-family":p,"font-weight":S,"font-style":z,"text-decoration":O}};function Ut(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275listener("accessible-click",function(){var O=e.\u0275\u0275restoreView(n).$implicit,Z=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(Z.interpretSuggestedQuestion(O.content))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&o){var a=r.$implicit,p=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction7(3,Dt,null==p.suggestionsPresentation?null:p.suggestionsPresentation.backgroundColor,null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties?null:p.suggestionsPresentation.cardFontProperties.color,(null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties||null==p.suggestionsPresentation.cardFontProperties.size?null:p.suggestionsPresentation.cardFontProperties.size.px)+"px",null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties?null:p.suggestionsPresentation.cardFontProperties.family,null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties?null:p.suggestionsPresentation.cardFontProperties.weight,null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties?null:p.suggestionsPresentation.cardFontProperties.style,null==p.suggestionsPresentation||null==p.suggestionsPresentation.cardFontProperties?null:p.suggestionsPresentation.cardFontProperties.textDecoration)),e.\u0275\u0275attribute("aria-label",a.accessibilityLabel),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.content," ")}}var Rt=function(r,n,a,p,S,z){return{color:r,"font-size":n,"font-family":a,"font-weight":p,"font-style":S,"text-decoration":z}},Qt=function(r){return{"aria-label":r}};function _t(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275element(1,"div",32),e.\u0275\u0275elementStart(2,"div",33),e.\u0275\u0275template(3,Ut,2,11,"div",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",35),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(n);var S=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(S.toggleShowAllSuggestions())}),e.\u0275\u0275elementEnd()()}if(2&o){var a=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction6(4,Rt,null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties?null:a.suggestionsPresentation.headerFontProperties.color,(null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties||null==a.suggestionsPresentation.headerFontProperties.size?null:a.suggestionsPresentation.headerFontProperties.size.px)+"px",null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties?null:a.suggestionsPresentation.headerFontProperties.family,null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties?null:a.suggestionsPresentation.headerFontProperties.weight,null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties?null:a.suggestionsPresentation.headerFontProperties.style,null==a.suggestionsPresentation||null==a.suggestionsPresentation.headerFontProperties?null:a.suggestionsPresentation.headerFontProperties.textDecoration)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",a.viewModel.result.suggestions),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("localize",a.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction1(11,Qt,a.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"))}}var ut=function(r,n,a,p,S){return{color:r,"font-family":n,"font-weight":a,"font-style":p,"text-decoration":S}};function Lt(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"span",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(2,ut,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.color,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.family,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.weight,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.style,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.textDecoration)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.viewModel.result.failedToLoadSuggestionsMessage," ")}}function At(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275template(1,_t,5,13,"div",29),e.\u0275\u0275template(2,Lt,2,8,"span",30),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.viewModel.result.suggestions.length>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.viewModel.result.failedToLoadSuggestionsMessage)}}function dt(o,r){1&o&&e.\u0275\u0275elementContainer(0)}function Nt(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275template(1,dt,1,0,"ng-container",39),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(8);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}function jt(o,r){1&o&&e.\u0275\u0275elementContainer(0)}function Wt(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275template(1,jt,1,0,"ng-container",39),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(8);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}function ot(o,r){1&o&&e.\u0275\u0275elementContainer(0)}function ye(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275template(1,ot,1,0,"ng-container",39),e.\u0275\u0275elementEnd()),2&o){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(8);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}function Me(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",43),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.launchFeedbackDialog(-1,!1))}),e.\u0275\u0275element(1,"span",44),e.\u0275\u0275elementEnd()}}function ct(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",40)(1,"div",41)(2,"div")(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Me,2,0,"a",42),e.\u0275\u0275elementEnd()()()),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(3,ut,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.color,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.family,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.weight,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.style,null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.textDecoration)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.viewModel.result.message),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.allowFeedback&&n.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function pt(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",43),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.launchFeedbackDialog(-1,!1))}),e.\u0275\u0275element(1,"span",44),e.\u0275\u0275elementEnd()}}function vt(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",45)(1,"canvas-visual-error-overlay",17),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(n);var S=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(S.showResultErrorDetails())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,pt,2,0,"a",42),e.\u0275\u0275elementEnd()}if(2&o){var a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("errorInfo",a.viewModel.result)("viewport",a.viewModel.viewport),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.allowFeedback&&a.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function Oe(o,r){1&o&&e.\u0275\u0275element(0,"spinner",51),2&o&&e.\u0275\u0275property("delay",0)}function gt(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",48),e.\u0275\u0275template(1,Oe,1,1,"spinner",49),e.\u0275\u0275element(2,"single-visual-host",50),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.viewModel.result.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("visual",n.viewModel.result.visual)("visualViewport",n.viewModel.viewport)("themeCollection",n.viewModel.themeCollection)("config",n.core.singleVisualHostConfig)}}function Ee(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",52),e.\u0275\u0275element(1,"explore-canvas",53),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("viewModel",n.viewModel.result.exploreCanvas)("canvasOptions",n.canvasOptions)("disableOutspacePane","VisualAsExploration"!==n.viewModel.result.type)}}function Ve(o,r){if(1&o&&(e.\u0275\u0275template(0,gt,3,5,"div",46),e.\u0275\u0275template(1,Ee,2,3,"div",47)),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",n.viewModel.result.visual&&n.core.singleVisualHostConfig),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.viewModel.result.exploreCanvas&&n.jQueryUILoaded)}}function Ye(o,r){if(1&o&&(e.\u0275\u0275elementContainerStart(0,22),e.\u0275\u0275template(1,At,3,2,"div",23),e.\u0275\u0275template(2,Nt,2,1,"div",24),e.\u0275\u0275template(3,Wt,2,1,"div",24),e.\u0275\u0275template(4,ye,2,1,"div",24),e.\u0275\u0275template(5,ct,6,9,"div",25),e.\u0275\u0275template(6,vt,3,3,"div",26),e.\u0275\u0275template(7,Ve,2,2,"ng-template",null,27,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&o){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngSwitch",n.viewModel.result.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Suggestions"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Visual"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","VisualAsExploration"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Pod"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","DoNotUnderstand"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Error")}}function Ue(o,r){if(1&o&&e.\u0275\u0275element(0,"span",61),2&o){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("resizeEdges",n.TaskPane.resizeEdges)}}function Ne(o,r){if(1&o&&e.\u0275\u0275element(0,"span",62),2&o){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("resizeEdges",n.TaskPane.resizeEdges)}}function je(o,r){if(1&o&&e.\u0275\u0275element(0,"span",61),2&o){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("resizeEdges",n.VisualizationPane.resizeEdges)}}function ht(o,r){if(1&o&&e.\u0275\u0275element(0,"span",62),2&o){var n=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("resizeEdges",n.VisualizationPane.resizeEdges)}}var rt=function(r){return{isCollapsed:r}},at=function(r){return{"width.px":r}},ft=function(r){return{paneViewModel:r}};function Ht(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",54)(1,"div",55),e.\u0275\u0275template(2,Ue,1,1,"span",56),e.\u0275\u0275template(3,Ne,1,1,"span",57),e.\u0275\u0275element(4,"data-pane",58),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",59),e.\u0275\u0275template(6,je,1,1,"span",56),e.\u0275\u0275template(7,ht,1,1,"span",57),e.\u0275\u0275element(8,"pbi-lazy-load",60),e.\u0275\u0275elementEnd()()),2&o){var n=r.ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(18,rt,!n.TaskPane.isExpanded))("ngStyle",e.\u0275\u0275pureFunction1(20,at,n.TaskPane.width))("enableGhostResize",!0)("validateResize",a.getResizeValidator("TaskPane")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.TaskPane.resizeEdges.left),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.TaskPane.resizeEdges.right),e.\u0275\u0275advance(1),e.\u0275\u0275property("disallowExpandCollapse",a.taskPaneViewModel.disallowExpandCollapse)("title",a.taskPaneViewModel.title),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(22,rt,!n.VisualizationPane.isExpanded))("ngStyle",e.\u0275\u0275pureFunction1(24,at,n.VisualizationPane.width))("enableGhostResize",!0)("resizeEdges",n.VisualizationPane.resizeEdges)("validateResize",a.getResizeValidator("VisualizationPane")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.VisualizationPane.resizeEdges.left),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.VisualizationPane.resizeEdges.right),e.\u0275\u0275advance(1),e.\u0275\u0275property("modulePath",a.exploreUIAuthoringModulePath)("componentId","VisualizationPaneModernComponentId")("inputArgs",e.\u0275\u0275pureFunction1(26,ft,a.visualizationPaneViewModel))}}function mt(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"span",68),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275attribute("aria-label",n.viewModel.result.restatement.tooltipDescription),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.viewModel.result.restatement.tooltipDescription," ")}}function We(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275attribute("aria-label",n.getModelInfo()),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.getModelInfo()," ")}}function He(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",69),e.\u0275\u0275element(1,"qna-feedback-lazy",70),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("fontColor",null==n.inputPresentation||null==n.inputPresentation.restatementFontProperties?null:n.inputPresentation.restatementFontProperties.color)}}function Ke(o,r){if(1&o&&(e.\u0275\u0275elementStart(0,"div",63)(1,"div",64),e.\u0275\u0275template(2,mt,2,2,"span",65),e.\u0275\u0275template(3,We,2,2,"span",66),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,He,2,1,"div",67),e.\u0275\u0275elementEnd()),2&o){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==n.viewModel.result?null:n.viewModel.result.restatement)&&n.showFullRestatement),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==n.viewModel.result?null:n.viewModel.result.modelId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.allowFeedback&&n.core.showFeedbackForCurrentQuestion())}}var I=function(r,n){return{contentReady:r,suggestionContent:n}},Ct={width:32,maxExpandedWidth:420,minExpandedWidth:180,isExpanded:!1,resizeEdges:{right:!0}},ke=function(){function o(r,n,a,p,S,z,O,Z,pe,H,ve,D,R,Pe,Xe,Ge,et,yt,Pt,Kt,kt,Gt,Jt,qt,$t){this.dataSources=r,this.dir=n,this.eventBridge=a,this.explorationCapabilitiesService=p,this.featureSwitchService=S,this.filterGenerator=z,this.geocoder=O,this.geolocationService=Z,this.itemPicker=pe,this.localizationService=H,this.moduleLoader=ve,this.panesVisibilityService=D,this.resourceLoader=R,this.resourcePackagesService=Pe,this.telemetryService=Xe,this.themeService=Ge,this.viewModeState=et,this.visualAuthoring=yt,this.visualHostTooltipServiceFactory=Pt,this.azureMapTokenCache=Kt,this.azureMapsEndpoint=kt,this.geocoderIndexedDB=Gt,this.promiseFactory=Jt,this.explorationNavigation=qt,this.core=$t,this.utteranceUpdated=new e.EventEmitter,this.pinnableContentDefinitionUpdated=new e.EventEmitter,this.convertVisual=new e.EventEmitter,this.toolingLaunched=new e.EventEmitter,this.utteranceRestated=new e.EventEmitter,this.interpretationError=new e.EventEmitter,this.canvasOptions={autoLayoutVisualPadding:0,scrollbarOffset:0},this.visualizationPaneViewModel=(0,b.Ee)(),this.taskPaneViewModel=(0,b.gk)(),this.resizablePanes$=new Qe.X({TaskPane:Ct,VisualizationPane:Ct}),this.onDestroy$=new ze.xQ,this.panesVisibilityService.registerPane("data",this.taskPaneViewModel,!1,{isPaneExpanded:!0,isPaneVisible:!0}),this.panesVisibilityService.registerPane("format",this.visualizationPaneViewModel,!1,{isPaneExpanded:!1,isPaneVisible:!0}),this.viewModel=this.core.viewModel}return Object.defineProperty(o.prototype,"sourceExploration",{set:function(n){n&&this.explorationNavigation&&this.explorationNavigation.loadExploration(n)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"qnaInputV2LazyComponent",{set:function(n){this.core.setGetQnaInputComponentFunc(function(){return n&&n.inputBox})},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"jQueryUILoaded",{get:function(){var n=this;return void 0===this.jQueryUILoadedPromise&&(this.jQueryUILoadedPromise=this.moduleLoader.require(se.W).then(function(){return n.isJQueryUILoaded=!0},function(){return n.isJQueryUILoaded=!1})),this.isJQueryUILoaded},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"exploreUIAuthoringModulePath",{get:function(){return"@powerbi/ExploreUIAuthoring/lazy-modules/explore-ui-authoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){return(0,u.mG)(this,void 0,void 0,function(){var r,n,a,p,S=this;return(0,u.Jh)(this,function(z){switch(z.label){case 0:return this.explorationCapabilities&&this.explorationCapabilitiesService.setCapabilities(this.explorationCapabilities),this.viewModeState.setMode(0),this.panesVisibilityService.setPaneExpansion("data",!1),this.panesVisibilityService.setPaneExpansion("format",!1),this.panesVisibilityService.getPanes$().pipe((0,_e.R)(this.onDestroy$),(0,Le.U)(function(O){return _.pick(O,["data","format"])})).subscribe(function(O){var Z,R=(Z=S.resizablePanes$.value).TaskPane,Pe=Z.VisualizationPane,Ge=O.format.isPaneExpanded,et="rtl"===S.dir.value;S.resizablePanes$.next({TaskPane:s(R,O.data.isPaneExpanded,R.width,et),VisualizationPane:s(Pe,Ge,Pe.width,et)})}),this.visualizationPaneViewModel.visualPluginFilter=function(O){return!S.filterGenerator.tryGetFilterPropertyIdentifier(O.capabilities)&&O.name!==ge.L.qnaVisual.name&&O.name!==ge.L.textbox.name},this.viewModeState.updateConfig(function(O){return O.alwaysPopulatePanes=!0}),(r=this.explorationCapabilitiesService.getCapabilities()).visualContainerOptions.hideHeader=!0,r.visualContainerOptions.showContextMenu=!1,r.disableCustomVisualPluginActions=!0,r.showFluentDesign=!0,r.forceCollapseTaskPane=!0,r.disableEnhancedTooltips=!0,this.initializedTelemetryEvent=this.telemetryService.logEvent($e.dZ,{isAuthoring:!1,entryPoint:this.entryPoint}),this.incomingUtterance&&"Embedded"===this.entryPoint&&this.incomingUtterance.subscribe(function(O){O&&S.interpretSuggestedQuestion(O)}),n=[(0,J.CD)(_.first(this.models))],a=(0,J.yd)(n),this.dataSources.set(a),[4,this.core.initialize(this.models,this.config,(0,Y.ED)((0,te.q)({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.createFromVisualContract(this.core.getCurrentVisual()),getAzureMapToken:function(){return S.azureMapTokenCache.getAzureMapToken()},azureMapsEndpoint:this.azureMapsEndpoint,geocoderIndexedDB:this.geocoderIndexedDB}),function(O){O.getLocalizedString=function(Z){return S.localizationService.get(Z)}}),this.entryPoint,this.utteranceUpdated,this.convertVisual,this.initializedTelemetryEvent,this.contentContainerElement,this.pinnableContentDefinitionUpdated,this.utteranceRestated,this.interpretationError,this.sourceFilters)];case 1:return z.sent(),p=this,[4,this.core.shouldShowThumbsUpDown()];case 2:return p.allowFeedback=z.sent(),this.suggestionPresentationArgs?[4,this.core.update({type:K.EP.Style,objects:m(this.suggestionPresentationArgs)})]:[3,4];case 3:z.sent(),z.label=4;case 4:return this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(F.ilH,function(O,Z){return S.onVisualConversion(Z)}),this.useModernFormatPane=this.featureSwitchService.featureSwitches.useModernFormatPane,[2]}})})},o.prototype.ngAfterViewInit=function(){return(0,u.mG)(this,void 0,void 0,function(){var r;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return r=this.explorationNavigation?(0,de.Su)(this.explorationNavigation,this.featureSwitchService):(0,de.D4)(this.featureSwitchService),[4,Ie.P.loadThemeAndBaseTheme(this.promiseFactory,this.resourceLoader,this.themeService,this.resourcePackagesService.getAllPackages(),r)];case 1:return n.sent(),this.itemPicker.setThemeItems(this.themeService.getDataColors(r),this.themeService.getIcons(r),this.themeService.getIconSets(r)),this.core.update({type:K.EP.Style}),this.resize(),[2]}})})},o.prototype.ngOnDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll(),this.onDestroy$.next(),this.onDestroy$.complete()},o.prototype.resize=function(){var r=this.qnaReportContainerElement.nativeElement;this.componentViewport={scale:1,width:r.clientWidth,height:r.clientHeight},this.core.update({type:K.EP.Resize,viewport:{height:r.clientHeight,width:r.clientWidth}})},o.prototype.getResizeValidator=function(r){var n=this;return function(a){var p;if(a.rectangle&&a.rectangle.width){var S=n.resizablePanes$.value,z=S[r],pe=a.rectangle.width;if(z.minExpandedWidth<=pe&&pe<=z.maxExpandedWidth)return n.resizablePanes$.next((0,u.pi)((0,u.pi)({},S),((p={})[r]=s(z,z.isExpanded,pe,"rtl"===n.dir.value),p))),!0}return!1}},Object.defineProperty(o.prototype,"displayedRestatement",{get:function(){if("Ready"===this.viewModel.state){var n=this.viewModel.result;if(n&&((0,ne.mn)(n)||(0,ne.fU)(n)||(0,ne.lP)(n)))return n.restatement}},enumerable:!1,configurable:!0}),o.prototype.getCurrentVisual=function(){return this.core.getCurrentVisual()},o.prototype.interpretSuggestedQuestion=function(r){this.core.interpretSuggestedQuestion(r)},o.prototype.toggleShowAllSuggestions=function(){this.core.toggleShowAllSuggestions()},o.prototype.showQnaVisualErrorDetails=function(){this.core.showQnaVisualErrorDetails()},o.prototype.showResultlErrorDetails=function(){this.core.showResultErrorDetails()},o.prototype.onToolingLaunched=function(){this.toolingLaunched.emit()},Object.defineProperty(o.prototype,"inputPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.inputBox},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"suggestionsPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.suggestions},enumerable:!1,configurable:!0}),o.prototype.launchFeedbackDialog=function(r,n){this.core.launchFeedbackDialog(r,n)},o.prototype.getModelInfo=function(){var r,n=null===(r=this.viewModel)||void 0===r?void 0:r.result;if(n&&((0,ne.lP)(n)||(0,ne.mn)(n)||(0,ne.fU)(n))){var a=n.modelId,p=_.find(this.models,function(S){return S.id===a});if(!_.isEmpty(p?.displayName))return this.localizationService.format("InfoNav_SourceLabel",[p.displayName])}},o.prototype.canShowPanes=function(){var r,n=null===(r=this.viewModel)||void 0===r?void 0:r.result;return!!n&&(0,ne.fU)(n)&&this.jQueryUILoaded&&!this.config.disablePanes},o.prototype.canShowFooter=function(){var r,n;if("Ready"!==(null===(r=this.viewModel)||void 0===r?void 0:r.state))return!1;if(this.allowFeedback&&this.core.showFeedbackForCurrentQuestion())return!0;var a=null===(n=this.viewModel)||void 0===n?void 0:n.result;return!(!a||!((0,ne.lP)(a)||(0,ne.mn)(a)||(0,ne.fU)(a)))&&(a.restatement&&this.showFullRestatement||!!a.modelId)},o.prototype.onVisualConversion=function(r){var n,a;return(0,u.mG)(this,void 0,void 0,function(){var p,S,z;return(0,u.Jh)(this,function(O){switch(O.label){case 0:return p=null===(n=this.viewModel)||void 0===n?void 0:n.result,(0,ne.fU)(p)?(S=p.exploreCanvas)?[4,this.visualAuthoring.convert(r.visualContainer,this.dataSources.get(),r.newVisualType,S.contract)]:[2]:[3,2];case 1:return z=O.sent(),null===(a=r.actionAfterConversion)||void 0===a||a.call(r,z),[3,3];case 2:le.fF.assertFail("Cannot convert a non visual"),O.label=3;case 3:return[2]}})})},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(E.D),e.\u0275\u0275directiveInject(T.Is),e.\u0275\u0275directiveInject(V.J),e.\u0275\u0275directiveInject(d.U),e.\u0275\u0275directiveInject(X.vZ),e.\u0275\u0275directiveInject(Q.r),e.\u0275\u0275directiveInject(xe.i),e.\u0275\u0275directiveInject(W._1),e.\u0275\u0275directiveInject(fe.a),e.\u0275\u0275directiveInject(ie.o),e.\u0275\u0275directiveInject(De.m),e.\u0275\u0275directiveInject(f.r),e.\u0275\u0275directiveInject(oe.l6),e.\u0275\u0275directiveInject($.o),e.\u0275\u0275directiveInject(he.y0),e.\u0275\u0275directiveInject(Ce.f),e.\u0275\u0275directiveInject(y.kc),e.\u0275\u0275directiveInject(w.$8),e.\u0275\u0275directiveInject(re.RT),e.\u0275\u0275directiveInject(j.o),e.\u0275\u0275directiveInject(be.A),e.\u0275\u0275directiveInject(Ae.W),e.\u0275\u0275directiveInject(M.t),e.\u0275\u0275directiveInject(q.z,8),e.\u0275\u0275directiveInject(Be.D))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["qna-report-container"]],viewQuery:function(n,a){if(1&n&&(e.\u0275\u0275viewQuery(qe.j,5),e.\u0275\u0275viewQuery(Ft,7,e.ElementRef),e.\u0275\u0275viewQuery(It,7,e.ElementRef)),2&n){var p=void 0;e.\u0275\u0275queryRefresh(p=e.\u0275\u0275loadQuery())&&(a.qnaInputV2LazyComponent=p.first),e.\u0275\u0275queryRefresh(p=e.\u0275\u0275loadQuery())&&(a.qnaReportContainerElement=p.first),e.\u0275\u0275queryRefresh(p=e.\u0275\u0275loadQuery())&&(a.contentContainerElement=p.first)}},hostBindings:function(n,a){1&n&&e.\u0275\u0275listener("resize",function(){return a.resize()},!1,e.\u0275\u0275resolveWindow)},inputs:{models:"models",config:"config",entryPoint:"entryPoint",showFullRestatement:"showFullRestatement",incomingUtterance:"incomingUtterance",sourceExploration:"sourceExploration",explorationCapabilities:"explorationCapabilities",sourceFilters:"sourceFilters",suggestionPresentationArgs:"suggestionPresentationArgs"},outputs:{utteranceUpdated:"utteranceUpdated",pinnableContentDefinitionUpdated:"pinnableContentDefinitionUpdated",convertVisual:"convertVisual",toolingLaunched:"toolingLaunched",utteranceRestated:"utteranceRestated",interpretationError:"interpretationError"},features:[e.\u0275\u0275ProvidersFeature((0,u.ev)((0,u.ev)([],A.u,!0),[Be.D,Je.y],!1))],decls:13,vars:14,consts:[["data-testid","qna-visual",1,"qnaVisual",3,"ngSwitch"],["qnaReportContainer",""],["class","loadingContainer",4,"ngSwitchCase"],["class","errorContainer",4,"ngSwitchCase"],["class","header",4,"ngSwitchCase"],["class","glyphicon icon glyph-small pbi-glyph-info restatementIcon","data-testid","restatement-icon","tabindex","0",3,"ngStyle","pbi-tooltip",4,"ngIf"],[1,"content","explorationContainer","newPaneColors",3,"ngClass"],[1,"contentContainer"],["contentContainer",""],[3,"ngSwitch",4,"ngIf"],["class","panes",4,"ngIf"],["class","footer",4,"ngIf"],[1,"loadingContainer"],[1,"loading"],["size","large",3,"delay"],["localize","Qna_InitialLoading"],[1,"errorContainer"],[3,"errorInfo","viewport","showErrorDetails"],[1,"header"],["drag-resize-disabled","true","class","inputBox","tabindex","-1",3,"entryPoint","qnaSupportedScopes","interpretListener","presentationArgs","configs","initialUtterance","inputBoxFocused",4,"ngIf"],["drag-resize-disabled","true","tabindex","-1",1,"inputBox",3,"entryPoint","qnaSupportedScopes","interpretListener","presentationArgs","configs","initialUtterance","inputBoxFocused"],["data-testid","restatement-icon","tabindex","0",1,"glyphicon","icon","glyph-small","pbi-glyph-info","restatementIcon",3,"ngStyle","pbi-tooltip"],[3,"ngSwitch"],["class","suggestionsContainer",4,"ngSwitchCase"],["class","visualResultContainer",4,"ngSwitchCase"],["class","doNotUnderstandContainer",4,"ngSwitchCase"],["class","resultErrorContainer",4,"ngSwitchCase"],["visualOrCanvasTemplate",""],[1,"suggestionsContainer"],["class","suggestions",4,"ngIf"],["class","suggestionsWarning",3,"ngStyle",4,"ngIf"],[1,"suggestions"],["localize","Visual_Qna_SuggestionsHeader",1,"suggestionTitle",3,"ngStyle"],["data-testid","suggestions-list",1,"suggestionsList"],["class","suggestion themeableElement","tabindex","0","role","button","data-testid","suggestion",3,"ngStyle","accessible-click",4,"ngFor","ngForOf"],["data-testid","show-all-toggle","tabindex","0","role","button",1,"showAllToggle",3,"localize","localizeAttr","accessible-click"],["tabindex","0","role","button","data-testid","suggestion",1,"suggestion","themeableElement",3,"ngStyle","accessible-click"],[1,"suggestionsWarning",3,"ngStyle"],[1,"visualResultContainer"],[4,"ngTemplateOutlet"],[1,"doNotUnderstandContainer"],["data-testid","show-do-not-understand-message",1,"showDoNotUnderstandMessage",3,"ngStyle"],["class","tellUsMore","href","javascript:void(0);",3,"accessible-click",4,"ngIf"],["href","javascript:void(0);",1,"tellUsMore",3,"accessible-click"],["localize","Qna_Feedback_TellUsMore"],[1,"resultErrorContainer"],["class","singleVisualHostContainer",4,"ngIf"],["class","horizontalItemsContainer",4,"ngIf"],[1,"singleVisualHostContainer"],["class","loadingSpinner","size","small",3,"delay",4,"ngIf"],["tabindex","0","focus-nav-mode","Hierarchy",3,"visual","visualViewport","themeCollection","config"],["size","small",1,"loadingSpinner",3,"delay"],[1,"horizontalItemsContainer"],[1,"explore-canvas-style",3,"viewModel","canvasOptions","disableOutspacePane"],[1,"panes"],["mwlResizable","",1,"taskPane","sidePane","rightSidePane","smallFontSize","dataPane",3,"ngClass","ngStyle","enableGhostResize","validateResize"],["class","resizeHandlerLeft","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],["class","resizeHandlerRight","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],["data-automation-type","taskPane",3,"disallowExpandCollapse","title"],["mwlResizable","",1,"visualizationPane","sidePane","rightSidePane","smallFontSize","formatPane",3,"ngClass","ngStyle","enableGhostResize","resizeEdges","validateResize"],["data-automation-type","visualizationPane",3,"modulePath","componentId","inputArgs"],["mwlResizeHandle","",1,"resizeHandlerLeft",3,"resizeEdges"],["mwlResizeHandle","",1,"resizeHandlerRight",3,"resizeEdges"],[1,"footer"],[1,"resultInfo"],["class","restatementInfo",4,"ngIf"],[4,"ngIf"],["class","feedback",4,"ngIf"],[1,"restatementInfo"],[1,"feedback"],[3,"fontColor"]],template:function(n,a){1&n&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275template(2,xt,4,1,"div",2),e.\u0275\u0275template(3,bt,2,2,"div",3),e.\u0275\u0275template(4,Ot,2,1,"div",4),e.\u0275\u0275template(5,zt,1,7,"i",5),e.\u0275\u0275elementStart(6,"div",6)(7,"div",7,8),e.\u0275\u0275template(9,Ye,9,7,"ng-container",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Ht,9,28,"div",10),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,Ke,5,3,"div",11),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("ngSwitch",a.viewModel.state),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitchCase","Loading"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Error"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Ready"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.showFullRestatement&&a.displayedRestatement),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(11,I,"Ready"===a.viewModel.state,a.viewModel.result&&"Suggestions"===a.viewModel.result.type)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",a.viewModel.result),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.canShowPanes()&&e.\u0275\u0275pipeBind1(11,9,a.resizablePanes$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.canShowFooter()))},dependencies:[ue.NgClass,ue.NgForOf,ue.NgIf,ue.NgTemplateOutlet,ue.NgStyle,ue.NgSwitch,ue.NgSwitchCase,Ze.R,tt.eP,qe.j,Te.$,me.f,nt.D,St.v,st.t,lt.X,wt.b,Mt.O,Et.i,it.E$,it.mC,ue.AsyncPipe],styles:['.qnaVisual[_ngcontent-%COMP%]{font-size:12px;height:100%;display:flex;flex-direction:column}  html[data-focus-source=key] .qnaVisual:focus,   html[data-focus-source=key] .qnaVisual *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}  html[data-focus-source=mouse] .qnaVisual:focus,   html[data-focus-source=mouse] .qnaVisual *:focus,   html[data-focus-source=program] .qnaVisual:focus,   html[data-focus-source=program] .qnaVisual *:focus{outline:none}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;text-align:center;margin:12px}.qnaVisual[_ngcontent-%COMP%]   .errorContainer[_ngcontent-%COMP%]{flex:1}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:row;min-height:44px;position:relative;margin-top:4px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .inputBox[_ngcontent-%COMP%]{flex:1;margin:4px 8px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction[_ngcontent-%COMP%]{margin:12px 4px 0;cursor:pointer;height:16px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction.disabled[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertiary-color, #A19F9D)!important;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .restatementIcon[_ngcontent-%COMP%]{align-self:flex-end;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:4px;display:flex;flex:0;width:calc(100% - 8px)}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .contentContainer[_ngcontent-%COMP%]{height:100%;flex:1}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionTitle[_ngcontent-%COMP%]{margin:1px 1px 12px 4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]{padding:0 4px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));grid-template-rows:repeat(auto-fit,minmax(32px,1fr))}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]   .suggestion[_ngcontent-%COMP%]{font-size:14px;padding:12px 20px;border-radius:2px;box-shadow:var(--fluent-shadow-depth4, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey));border:1px solid transparent;box-sizing:border-box;cursor:pointer;margin:0 12px 12px 0}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .showAllToggle[_ngcontent-%COMP%]{font-size:14px;color:var(--fluent-theme-link-color, #0078D4);margin:12px 4px;cursor:pointer;align-self:flex-end}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]{position:relative;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]{position:relative;display:block;height:100%;background-color:transparent}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]     .visual{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .horizontalItemsContainer[_ngcontent-%COMP%]{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .horizontalItemsContainer[_ngcontent-%COMP%]   explore-canvas[_ngcontent-%COMP%]{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .showDoNotUnderstandMessage[_ngcontent-%COMP%], .qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestionsWarning[_ngcontent-%COMP%]{display:flex;text-align:center;align-items:center;font-size:14px;max-width:450px;padding:20px;width:100%;box-sizing:border-box}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .showDoNotUnderstandMessage[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestionsWarning[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]{height:100%;position:relative;background-color:var(--neutral-lighter-color, #F4F4F4);display:flex;flex-direction:column;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   canvas-visual-error-overlay[_ngcontent-%COMP%]{position:relative;height:auto}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   .tellUsMore[_ngcontent-%COMP%]{text-align:center;font-size:14px}.qnaVisual[_ngcontent-%COMP%]   .content.contentReady[_ngcontent-%COMP%]{flex:1}.qnaVisual[_ngcontent-%COMP%]   .content.suggestionContent[_ngcontent-%COMP%]{overflow-y:auto;flex-basis:0}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;align-items:center}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:0 12px 8px}html[dir="rtl"][_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:0 12px 8px}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .resultInfo[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;margin-right:32px;width:calc(100% - 300px)}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .resultInfo[_ngcontent-%COMP%]   .restatementInfo[_ngcontent-%COMP%]{margin-bottom:2px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   qna-feedback-lazy[_ngcontent-%COMP%]{float:right}.resizeHandlerLeft[_ngcontent-%COMP%]{left:0;position:absolute;height:100%;cursor:col-resize;width:5px;z-index:1}.resizeHandlerRight[_ngcontent-%COMP%]{right:0;position:absolute;height:100%;cursor:col-resize;width:5px;z-index:1}']}),o}();function m(o){var r;return{suggestions:{cardBackground:t(o.backgroundColor),cardFontColor:t(null===(r=o.cardFontProperties)||void 0===r?void 0:r.color)}}}function t(o){return{solid:{color:o}}}function s(o,r,n,a){var p=n;return r&&32===p?p=180:r||(p=32),(0,u.pi)((0,u.pi)({},o),{width:p,isExpanded:r,resizeEdges:a?{right:r}:{left:r}})}var l=i(2142),h=i(86286);function v(o,r){if(1&o){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"qna-report-container",6),e.\u0275\u0275listener("toolingLaunched",function(){e.\u0275\u0275restoreView(n);var S=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(S.onToolingLaunched())}),e.\u0275\u0275elementEnd()}if(2&o){var a=e.\u0275\u0275nextContext();e.\u0275\u0275property("models",a.viewModel.models)("config",a.viewModel.configs)("entryPoint","Popout")("showFullRestatement",!1)("explorationCapabilities",a.args.explorationCapabilities)("sourceExploration",a.viewModel.sourceExploration)("sourceFilters",a.viewModel.sourceFilters)}}function c(o,r){1&o&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275element(1,"i",8)(2,"span",9),e.\u0275\u0275elementEnd())}var C={canEdit:!1,canShowPods:!0,canShowVisuals:!0,canShowDidYouMean:!0,focusOnInit:!0,resetDataSources:!0},P=function(){function o(r){this.overlayRef=r}return Object.defineProperty(o.prototype,"_qnaReportContainer",{set:function(n){this.reportContainerComponent||(this.reportContainerComponent=n)},enumerable:!1,configurable:!0}),o.prototype.ngOnInit=function(){return(0,u.mG)(this,void 0,void 0,function(){var r,n,a,p,S,z,O;return(0,u.Jh)(this,function(Z){return n=(r=this.args.sourceExploration)&&r.reportId,a=[],p=[],S=_.find(this.args.dataSources,function(pe){return pe.type===l.nKy}),z={vsName:S.dsr.vsName,dbName:S.dsr.dbName,qnaSupported:!0,id:S.dsr.modelId||1},n&&r.report&&z.id===r.report.modelId&&(O=[n]),p.push(z),a.push({model:z,reportIds:O}),this.viewModel={configs:_.merge({},C,{canEdit:0!==this.args.viewMode}),models:p,sourceExploration:r,sourceFilters:this.args.sourceFilters},[2]})})},o.prototype.ngAfterViewInit=function(){this.resize(),this.reportContainerComponent&&this.reportContainerComponent.resize()},o.prototype.resize=function(){this.overlayRef.overlayRef.updatePosition()},o.prototype.ngOnDestroy=function(){this.viewModel=void 0},o.prototype.onToolingLaunched=function(){this.overlayRef.close()},o.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(h.w))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["qna-popout-modern"]],viewQuery:function(n,a){var p;(1&n&&e.\u0275\u0275viewQuery(ke,5),2&n)&&(e.\u0275\u0275queryRefresh(p=e.\u0275\u0275loadQuery())&&(a._qnaReportContainer=p.first))},hostBindings:function(n,a){1&n&&e.\u0275\u0275listener("resize",function(){return a.resize()},!1,e.\u0275\u0275resolveWindow)},inputs:{args:"args"},decls:6,vars:2,consts:[[1,"modernQnaPopout","themeableElement"],["qnaPopout",""],[1,"closeButton"],[1,"glyphicon","pbi-glyph-close","glyph-mini",3,"accessible-click"],[3,"models","config","entryPoint","showFullRestatement","explorationCapabilities","sourceExploration","sourceFilters","toolingLaunched",4,"ngIf"],["class","filterInfo",4,"ngIf"],[3,"models","config","entryPoint","showFullRestatement","explorationCapabilities","sourceExploration","sourceFilters","toolingLaunched"],[1,"filterInfo"],[1,"glyphicon","pbi-glyph-filter","filterBtnIcon","glyph-mini"],["localize","Qna_PopoutFiltersApplied"]],template:function(n,a){1&n&&(e.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2)(3,"i",3),e.\u0275\u0275listener("accessible-click",function(){return a.onToolingLaunched()}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(4,v,1,7,"qna-report-container",4),e.\u0275\u0275template(5,c,3,0,"div",5),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",a.viewModel),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.viewModel&&a.viewModel.sourceFilters.length>0))},dependencies:[ue.NgIf,st.t,lt.X,ke],styles:[".modernQnaPopout[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background-color:var(--fluent-theme-white-color, #FFF);padding:20px}.modernQnaPopout[_ngcontent-%COMP%]   .closeButton[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.modernQnaPopout[_ngcontent-%COMP%]   .closeButton[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{cursor:pointer}.modernQnaPopout[_ngcontent-%COMP%]   qna-report-container[_ngcontent-%COMP%]{flex:1}.modernQnaPopout[_ngcontent-%COMP%]   .filterInfo[_ngcontent-%COMP%]{padding-right:32px;margin-top:12px;font-size:12px;display:flex}.modernQnaPopout[_ngcontent-%COMP%]   .filterInfo[_ngcontent-%COMP%]   .filterBtnIcon[_ngcontent-%COMP%]{margin-right:4px}"]}),o}(),U=i(67659),x=i(46055),g=i(32288),B=i(20993),L=i(77906),G=i(95859),ee=i(1931),N=i(14888),ce=i(52950),ae=[{type:ke,componentId:"QnaReportContainerComponentId"},{type:P,componentId:"QnaPopoutComponentId"}],Se=function(){function o(){}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[ue.CommonModule,L.N.withManifests(ae),x.b,B.T,ee.T,N.m,g.J,U._,G.v,ce.g,it.ym]}),o}()},35691:function(we,k,i){i.d(k,{$g:function(){return F},AM:function(){return b},F2:function(){return le},S4:function(){return Y},UV:function(){return ge},Zg:function(){return se},dY:function(){return M},dZ:function(){return W},gk:function(){return te}});var u=i(41114),e="PBI.QnaVisual.Initialized",W=u.cx[e]=(0,u.b1)(e,{logExpAssignment:!0}),A="PBI.QnaAutoComplete.Initialized",M=u.cx[A]=(0,u.b1)(A),J="PBI.QnaAutoComplete.DropdownSelected",F=u.cx[J]=(0,u.b1)(J),te="PBI.ImproveLsdlBackground.Login",b=u.cx[te]=(0,u.b1)(te),se="PBI.ImproveLsdlBackground.Prompt",ge=u.cx[se]=(0,u.b1)(se),le="PBI.ImproveLsdlBackground.Result",Y=u.cx[le]=(0,u.b1)(le)},1931:function(we,k,i){i.d(k,{T:function(){return Ie}});var u=i(77476),e=i(52910),W=i(13052),A=i(31109),M=i(32288),J=i(76521),F=i(40516),te=i(84497),b=i(95859),se=i(46544),ge=i(52950),le=i(47231),Y=i(50423),Ie=function(){function de(){}return de.\u0275fac=function(ne){return new(ne||de)},de.\u0275mod=Y.\u0275\u0275defineNgModule({type:de}),de.\u0275inj=Y.\u0275\u0275defineInjector({imports:[u.CommonModule,e.O,W.T,A.F,M.J,J.A3,F.h,te.L,b.v,se.e3,ge.g,le.c]}),de}()},37320:function(we,k,i){i.d(k,{y:function(){return he}});var u=i(81337),e=i(35510),W=i(74804),A=i(62458),M=i(58291),J=i(57871),F=i(42614),te=i(3579),b=i(38953),se=i(3468),ge=i(35988),le=i(40713),Y=i(50423),K=i(26898),Ie=i(83008),de=i(3404),Je=i(21436),ne=i(28894),Be=i(84916),qe=i(29866),he=function(){function E(d,f,y,w,T,V,Q){this.conceptualSchemaProxy=d,this.dataSources=f,this.explorationSerializer=y,this.lazyScoped=w,this.podExplorationResolver=T,this.resourcePackage=V,this.visualPlugin=Q}return E.prototype.createInterpretListener=function(d,f){return void 0===f&&(f=500),new Qe(this.conceptualSchemaProxy,this.dataSources,this.explorationSerializer,this.lazyScoped,this.podExplorationResolver,this.resourcePackage,this.visualPlugin,d,f)},E.\u0275fac=function(f){return new(f||E)(Y.\u0275\u0275inject(K.i),Y.\u0275\u0275inject(Ie.D),Y.\u0275\u0275inject(de.L),Y.\u0275\u0275inject(ne.H),Y.\u0275\u0275inject(Je.Bl),Y.\u0275\u0275inject(Be.o),Y.\u0275\u0275inject(qe.D))},E.\u0275prov=Y.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac}),E}(),Qe=function(){function E(d,f,y,w,T,V,Q,j,q){this.conceptualSchemaProxy=d,this.dataSources=f,this.explorationSerializer=y,this.lazyScoped=w,this.podExplorationResolver=T,this.resourcePackage=V,this.visualPlugin=Q,this.setupParams=j,this.timeout=q,A.fF.assertValue(j,"setupParams"),this.updateManager=new Le(this.timeout),this.setupParams=j}return E.prototype.getObservable=function(){return this.updateManager.getObservable()},E.prototype.onInterpretIssued=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:0})},E.prototype.onInterpretRetry=function(d){this.updateManager.pushUpdate({resultType:1,retryWarning:d})},E.prototype.onInterpretResultCleared=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:4,utterance:""})},E.prototype.onInterpretResult=function(d,f){var y;return(0,u.mG)(this,void 0,void 0,function(){var w,T;return(0,u.Jh)(this,function(V){return w=!!f.error||!this.setupParams.forTrainingTermBinding&&_.isEmpty(f.results)||this.setupParams.forTrainingTermBinding&&_.every(f.results,function(Q){return!Q.command})&&!function(E){return!E||!!_.find(E,function(d){return 2===d||8===d||11===d||12===d||9===d||10===d||24===d})}(f.warnings),w?(T=_.first(f.results),this.onInterpretErrorV2(f.utterance,d,f.error,T?.spans,null===(y=T?.correctionInfo)||void 0===y?void 0:y.correctedUtterance),[2]):[2,this.onInterpretSuccessV2(f,d)]})})},E.prototype.onInterpretSuccessV2=function(d,f){var y,w;return(0,u.mG)(this,void 0,void 0,function(){var T,V;return(0,u.Jh)(this,function(j){switch(j.label){case 0:return A.fF.assertValue(d,"interpretResponse"),this.cancelErrorThrottler(),null!==(y=f?.intent)&&void 0!==y&&y.defineCalculation?[4,this.handleCalculationResult(d,f)]:[3,2];case 1:return j.sent(),[3,6];case 2:return T=_.first(d.results),(V=null===(w=T?.command)||void 0===w?void 0:w.query)&&_.find(V.from().sources(),function(q){return(0,b.Yg)(q)})?[4,this.handlePodPageResult(d,f)]:[3,4];case 3:return j.sent(),[3,6];case 4:return[4,this.handleVisualResult(d,f)];case 5:j.sent(),j.label=6;case 6:return[2]}})})},E.prototype.onInterpretErrorV2=function(d,f,y,w,T){var V=this;A.fF.assertValue(d,"utterance"),this.cancelErrorThrottler();var Q=this.setupParams.forTrainingTermBinding?{spans:w,correctedUtterance:T}:void 0;this.errorThrottler=setTimeout(function(){V.updateManager.pushThrottledUpdate({request:f,resultType:3,interpretError:y,utterance:d,termBindingsTrainingInfo:Q,doNotShowResult:!0}),V.errorThrottler=void 0},this.timeout)},E.prototype.cancelErrorThrottler=function(){this.errorThrottler&&clearTimeout(this.errorThrottler),this.errorThrottler=void 0},E.prototype.handlePodPageResult=function(d,f){return(0,u.mG)(this,void 0,void 0,function(){var y,w,T,V,Q,j,q,X,xe,be,fe,Ce,ie,De,oe,$,re,Ae,ue,Ze;return(0,u.Jh)(this,function(Te){switch(Te.label){case 0:if(y=_.first(d?.results),A.fF.assertValue(y,"query interpretResult must be defined for handling pod result"),w=d.utterance,T=ze(y),this.setupParams.forTrainingTermBinding)return this.updateManager.pushThrottledUpdate({request:f,resultType:2,utterance:w,termBindingsTrainingInfo:T,doNotShowResult:!1}),[2];if(!this.setupParams.canShowPods)return this.updateManager.pushThrottledUpdate({request:f,resultType:5,utterance:w}),[2];V=y?.command,Q=V?.query,A.fF.assertValue(Q,"interpretResult command must have a defined query for handling pod result"),j=_.find(Q.from().sources(),function(me){return(0,b.Yg)(me)}),A.fF.assertValue(j,"expect there is a pod entity"),q=this.podExplorationResolver.getReportId(j.schema),Te.label=1;case 1:return Te.trys.push([1,3,,4]),be=(xe=this.explorationSerializer).deepCopyExploration,[4,this.podExplorationResolver.getExploration(q)];case 2:return X=be.apply(xe,[Te.sent()]),fe=_.find(X.pods,function(me){return me.name===j.pod}),Ce=fe&&fe.boundSection,ie=_.find(X.sections,function(me){return Ce===me.name}),fe&&Ce&&ie?(F.l.mergeExplorationSectionFilters(X,ie),De=(0,le.Nj)(V?.queryMetadata),oe=se.ib.serializeQuery(Q),_.isEmpty(oe.Where)||($=F.l.extractParameterFilters(oe,De),F.l.applySectionParameterFilters(ie,fe,void 0,$)),re=_.filter(X.resourcePackages,function(me){return _.some(ie.visualContainers,function(nt){return(0,te.s)(nt)===me.name})}),_.isEmpty(re)||(this.resourcePackage.registerPackages(re),this.visualPlugin.ensurePlugins(re)),ie.size.displayOption=1,X.activeSectionIndex=_.findIndex(X.sections,function(me){return me.name===ie.name}),Ae=this.getModelFromResult(y),this.ensureDataSources(Ae,X),ue=Ae.id,Ze=this.getNotShowLowConfidenceResult(y),this.updateManager.pushThrottledUpdate({request:f,resultType:2,modelId:ue,utterance:w,exploration:X,restatement:y.restatement,doNotShowResult:Ze,usedAgents:y?.usedAgents}),[3,4]):(this.updateManager.pushThrottledUpdate({request:f,resultType:6,utterance:w}),[2]);case 3:return Te.sent(),this.updateManager.pushThrottledUpdate({request:f,resultType:6,utterance:w}),[3,4];case 4:return[2]}})})},E.prototype.handleVisualResult=function(d,f){return(0,u.mG)(this,void 0,void 0,function(){var y,w,T,V,Q,j,q,X,fe,Ce,ie;return(0,u.Jh)(this,function(oe){switch(oe.label){case 0:if(A.fF.assertValue(d,"interpretResponse"),y=d.utterance,w=_.first(d?.results),!this.setupParams.canShowVisuals)return this.updateManager.pushThrottledUpdate(this.setupParams.forTrainingTermBinding?{request:f,resultType:2,utterance:y,termBindingsTrainingInfo:ze(w),doNotShowResult:!1}:{request:f,resultType:5,utterance:y}),[2];T=this.setupParams.forTrainingTermBinding?ze(w):void 0,oe.label=1;case 1:return oe.trys.push([1,4,,5]),V=(0,ge.vr)(d?.warnings),Q=_.uniq(_.map(V,function($){return $.messageKey})),j=!_.isEmpty(V),q=void 0,(X=w&&w.command)&&X.query?_.isEmpty(V)?(fe=this.getModelFromResult(w),this.ensureDataSources(fe,void 0),[4,this.lazyScoped.get("visualRecommendationService")]):(this.updateManager.pushThrottledUpdate({request:f,resultType:2,utterance:y,termBindingsTrainingInfo:T,doNotShowResult:!0,doNotShowResultCustomMessageKeys:Q}),[2]):(this.updateManager.pushThrottledUpdate({request:f,resultType:this.setupParams.forTrainingTermBinding?2:3,utterance:y,termBindingsTrainingInfo:T,doNotShowResult:!this.setupParams.forTrainingTermBinding||j,doNotShowResultCustomMessageKeys:j?Q:void 0}),[2]);case 2:return Ce=oe.sent(),[4,(0,le.y_)(w,this.conceptualSchemaProxy,this.dataSources,Ce)];case 3:return(q=oe.sent())?(ie=this.getNotShowLowConfidenceResult(w),this.updateManager.pushThrottledUpdate({request:f,resultType:2,modelId:fe.id,utterance:y,restatement:w&&w.restatement,termBindingsTrainingInfo:T,visualContainer:q,doNotShowResult:ie,usedAgents:w?.usedAgents})):this.updateManager.pushThrottledUpdate({request:f,resultType:6,utterance:y,termBindingsTrainingInfo:T}),[3,5];case 4:return oe.sent(),this.updateManager.pushThrottledUpdate({request:f,resultType:6,utterance:y,termBindingsTrainingInfo:T}),[3,5];case 5:return[2]}})})},E.prototype.handleCalculationResult=function(d,f){var y;return(0,u.mG)(this,void 0,void 0,function(){var w,T,Q,j,q;return(0,u.Jh)(this,function(X){for(w=d.utterance,this.setupParams.canShowCalculations||this.updateManager.pushThrottledUpdate({request:f,resultType:5,utterance:w}),T=[],Q=0,j=d.results;Q<j.length;Q++)null!==(y=(q=j[Q]).command)&&void 0!==y&&y.defineCalculation&&!this.getNotShowLowConfidenceResult(q)&&T.push((0,u.pi)((0,u.pi)({},q.command.defineCalculation),{restatement:q.restatement}));return _.isEmpty(T)?this.updateManager.pushThrottledUpdate({request:f,resultType:3,utterance:w}):this.updateManager.pushThrottledUpdate({request:f,resultType:2,utterance:w,restatement:void 0,doNotShowResult:!1,calculations:T}),[2]})})},E.prototype.getNotShowLowConfidenceResult=function(d){if(!d?.command)return!0;var f=d.correctionInfo&&d.correctionInfo.state;return 0===f||1===f&&this.setupParams.canShowDidYouMean},E.prototype.getModelFromResult=function(d){var f=1===_.size(this.setupParams.models)?this.setupParams.models[0]:_.find(this.setupParams.models,function(y){return y.dbName===d.databaseName&&y.vsName===d.virtualServerName});return A.fF.assertValue(f,"There are multiple models for interpret, one of them should match the model that the interpret result is from"),f},E.prototype.ensureDataSources=function(d,f){if(d&&this.setupParams.resetDataSources){var y=(0,W.CD)(d),w=(0,W.yd)([y]);if(!_.isEmpty(f?.modelExtensions)){var T=J.eM,V=y.name;w.push({type:M.K,id:void 0,name:T,extends:V,exploration:{schemaName:T,extends:V,getModelExtensions:function(){return f.modelExtensions},getDataSourceVariables:function(){return f.dataSourceVariables}}})}this.dataSources.set(w)}},E}();function ze(E){if(E){var d=E.command;return{spans:E.spans,correctedUtterance:E.correctionInfo&&E.correctionInfo.correctedUtterance,linguisticSchemaJson:d&&d.linguisticSchemaJson,linguisticSchemaItems:d&&d.linguisticSchemaItems,inferredTermMetadata:d&&d.inferredTermMetadata}}}var Le=function(){function E(d){this.timeout=d,this.interpretResult$=new e.X(void 0)}return E.prototype.getObservable=function(){return this.interpretResult$.asObservable()},E.prototype.pushUpdate=function(d){this.throttler&&clearTimeout(this.throttler),this.throttler=void 0,this.throttledUpdate=void 0,this.interpretResult$.next(d),this.throttler=this.startThrottler()},E.prototype.pushThrottledUpdate=function(d){this.throttler?this.throttledUpdate=d:(this.interpretResult$.next(d),this.throttler=this.startThrottler())},E.prototype.startThrottler=function(){var d=this;return setTimeout(function(){d.throttledUpdate?(d.interpretResult$.next(d.throttledUpdate),d.throttledUpdate=void 0,d.throttler=d.startThrottler()):d.throttler=void 0},this.timeout)},E}()},72129:function(we,k,i){function u(F){return"Suggestions"===F?.type}function e(F){return"Visual"===F?.type}function W(F){return"VisualAsExploration"===F?.type}function A(F){return"Pod"===F?.type}function M(F){return"Error"===F?.type}function J(F){return"QueryError"===F?.type}i.d(k,{Ew:function(){return u},fU:function(){return W},lP:function(){return A},mn:function(){return e},uT:function(){return M},wp:function(){return J}})},282:function(we,k,i){i.d(k,{D:function(){return Ct}});var u=i(81337),e=i(50423),W=i(48787),A=i(92060),M=i(79154),J=i(94419),F=i(80981),te=i(90120),b=i(56578),se=i(1521),ge=i(61903),le=i(18664),Y=i(47245),K=i(62458),Ie=i(2142),de=i(2931),Je=i(50550),ne=i(11077),Be=i(32105),qe=i(33567),$e=i(18503),he=i(82755),Qe=i(3579),ze=i(60661),_e=i(76045),Le=i(43286),E=i(39681),d=i(16808),f=i(28579),y=i(14463),w=i(78778),T=new e.InjectionToken("QnaLiveConnectService"),V=i(65947),Q=i(12123),j=i(32640),q=i(21728),X=i(80952),xe=i(46544),be=i(4954),fe=i(38078),Ce=i(46135),ie=i(8590),De=i(80318),oe=i(5894),$=i(72129),re=i(40713),Ae=i(35988),ue=i(87974),Ze=i(29866),tt=i(52121),Te=i(26898),me=i(83008),nt=i(48145),St=i(39503),st=i(11494),lt=i(77200),wt=i(27980),Mt=i(58938),Et=i(67660),it=i(69474),Ft=i(3404),It=i(79006),xt=i(72262),bt=i(906),Tt=i(84281),Ot=i(80277),Vt=i(9380),Bt=i(21548),zt=i(76072),Dt=i(2330),Ut=i(40956),Rt=i(58991),Qt=i(65181),_t=i(81213),ut=i(83309),Lt=i(37320),At=i(1599),ot="qnaVisualContainer",ye="inputBox",Me="suggestions",ct="hiddenProperties",vt="background",Oe="header",gt="cardBackground",Ee="card",Ve="question",Ye="restatement",Ue="FontColor",Ne="FontSize",je="FontFamily",ht="hoverColor",rt="acceptedColor",at="errorColor",ft="warningColor",mt="commitButtonBackgroundColor",We="Bold",He="Italic",Ke="Underline",I={withBorder:!0,showSuggestions:!0,acceptedColor:"#0078D4",errorColor:"#FF0000",warningColor:"#0078D4",borderColor:"#A19F9D",fontColor:"#323130",darkFontColor:"#252423",lightFontColor:"#FFFFFF",inputBoxBackgroundColor:"#FFFFFF",suggestionBackgroundColor:"#F3F2F1",hoverColor:"#EEEEEE",semiboldFont:"'Segoe UI Semibold', wf_segoe-ui_semibold, helvetica, arial, sans-serif",regularFont:"'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",smallFontSize:Be.B.createFromPt(9),mediumFontSize:Be.B.createFromPt(10),largeFontSize:Be.B.createFromPt(12),defaultBIUValue:!1},Re={spanDropdownHeaderConfig:{show:!0,unknownSpanHeaderConfig:{actionType:"none"}}},Ct=function(){function m(t,s,l,h,v,c,C,P,U,x,g,B,L,G,ee,N,ce,ae,Fe,Se,o,r,n,a,p,S,z,O,Z,pe,H,ve,D,R,Pe,Xe,Ge,et){if(this.visualPlugin=t,this.changeDetectorRef=s,this.conceptualSchemaProxy=l,this.dataSources=h,this.dialogService=v,this.explorationActivity=c,this.explorationCapabilities=C,this.explorationNavigation=P,this.explorationSerializer=U,this.eventBridge=x,this.featureSwitchService=g,this.qnaFeedbackStateService=B,this.lazyProvider=L,this.themeService=G,this.expandCollapse=ee,this.geocoder=N,this.geolocationService=ce,this.moduleLoader=ae,this.localizationService=Fe,this.errorService=Se,this.telemetryService=o,this.resourceLoader=r,this.screenReaderService=n,this.interpretListenerFactory=a,this.selectionService=p,this.sortService=S,this.undoRedoService=z,this.viewModeState=O,this.visualAuthoringOpService=Z,this.azureMapTokenCache=pe,this.azureMapsEndpoint=H,this.geocoderIndexedDB=ve,this.visualHostTooltipServiceFactory=D,this.promiseFactory=R,this.accountService=Pe,this.qnaProxyPathToken=Xe,this.qnaModelUtilsPathToken=Ge,this.qnaLiveConnectService=et,this.utteranceUpdated=new e.EventEmitter,this.pinnableContentDefinitionUpdated=new e.EventEmitter,this.convertVisual=new e.EventEmitter,this.utteranceRestated=new e.EventEmitter,this.interpretationError=new e.EventEmitter,this.isBrowserIE=(0,d.rO)(),this.isBrowserIE)this.viewModel={state:"Error",error:(0,re.ET)(Fe),qnaInputConfiguration:void 0,themeCollection:void 0,viewport:void 0,presentationViewModel:void 0};else{this.pendingSuggestedQuestionsRequests=0;var yt=(0,re.Su)(this.explorationNavigation,this.featureSwitchService),Pt=this.themeService.getVisualStyle(yt).colorPalette.dataColors.getColorByIndex(0).value,Kt={withBorder:I.withBorder,borderColor:I.borderColor,backgroundColor:I.inputBoxBackgroundColor,questionFontProperties:{color:I.fontColor,size:I.mediumFontSize,family:I.regularFont},acceptedUnderlineColor:I.acceptedColor,errorUnderlineColor:I.errorColor,warningUnderlineColor:I.warningColor,hoverColor:I.hoverColor,restatementFontProperties:{color:I.fontColor,size:I.smallFontSize,family:I.regularFont},commitButtonBackgroundColor:Pt,commitButtonForegroundColor:ke(Pt)};this.viewModel={state:"Loading",qnaInputConfiguration:void 0,themeCollection:yt,viewport:void 0,presentationViewModel:{inputBox:Kt,suggestions:{backgroundColor:I.suggestionBackgroundColor,show:I.showSuggestions,cardFontProperties:{color:I.fontColor,size:I.mediumFontSize,family:I.regularFont},headerFontProperties:{color:I.fontColor,size:I.largeFontSize,family:I.semiboldFont}}}}}}return m.prototype.initialize=function(t,s,l,h,v,c,C,P,U,x,g,B,L){var G;return void 0===L&&(L=!1),(0,u.mG)(this,void 0,void 0,function(){var N,ae,Fe,Se,o,r,n,a,p,z,O,Z,H=this;return(0,u.Jh)(this,function(ve){switch(ve.label){case 0:return this.isBrowserIE?[2]:(this.models=t,this.config=s,this.hostServices=l,this.entryPoint=h,this.utteranceUpdated=v,this.convertVisual=c,this.utteranceRestated=x,this.interpretationError=g,this.initializedTelemetryEvent=C,this.contentElement=P,U&&(this.pinnableContentDefinitionUpdated=U),N=this,[4,this.lazyProvider.get(this.qnaProxyPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","InterpretServiceModern")]);case 1:return N.interpretService=ve.sent(),ae=this,[4,this.lazyProvider.get(this.qnaModelUtilsPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaModelUtilsService")];case 2:return ae.qnaModelUtils=ve.sent(),Fe=_.map(this.models,function(D){return{datasetName:D.dbName,datasetId:D.id}}),Se=this,[4,(0,ue.U)(Fe,this.qnaModelUtils,this.featureSwitchService)];case 3:return Se.inCommitQuestionOnDemandMode=ve.sent(),this.interpretListener=this.interpretListenerFactory.createInterpretListener({forTrainingTermBinding:!1,canShowPods:this.config.canShowPods,canShowVisuals:this.config.canShowVisuals,canShowDidYouMean:this.config.canShowDidYouMean,models:this.models,resetDataSources:this.config.resetDataSources}),this.interpretListener.getObservable().subscribe(function(D){return H.onResultAvailable(D)}),o=_.find(this.dataSources.get(),function(D){return D.type===Ie.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 4:return r=ve.sent(),n=o&&r&&r.schema(o.name).capabilities,(a=(null===(G=this.viewModel.qnaInputConfiguration)||void 0===G?void 0:G.configs)||{}).supportsPodQueries=!!s.canShowPods,null!=s.focusOnInit&&(a.autoFocusOnInit=s.focusOnInit),null!=s.disableQnaInputAuthoring&&(a.disableAuthoring=s.disableQnaInputAuthoring,a.displayDisabledStateVisually=s.disableQnaInputAuthoring),null!=s.disableQnaInputAuthoringMessage&&(a.disableAuthoringMessage=s.disableQnaInputAuthoringMessage),null!=s.hostHandlesUndo&&(a.hostSupportsUndo=s.hostHandlesUndo),null!=s.showTermDropdownHeader&&(a.spanDropdownHeaderConfig={show:s.showTermDropdownHeader}),s.showUnknownTermDropdownHeaderTextOnly&&(a.spanDropdownHeaderConfig||(a.spanDropdownHeaderConfig={show:void 0}),a.spanDropdownHeaderConfig.unknownSpanHeaderConfig={actionType:"textOnlyHeader",textOnlyTemplate:s.unknownTermDropdownHeaderTextOnlyTemplate}),this.viewModel.themeCollection=(0,re.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,interpretListener:this.interpretListener,qnaSupportedScopes:_.map(this.models,function(D){return{model:D}}),configs:a,presentation:this.viewModel.presentationViewModel.inputBox,initialUtterance:this.config.initialUtterance||"",initialUtteranceFromSaved:this.config.initialUtteranceFromSaved},this.viewModel.presentationViewModel.inputBox.useShellTheme=L,p=this,[4,this.getIsModelEditable()];case 5:return p.isModelEditable=ve.sent(),[4,this.updateUnknownSpanHeaderConfig()];case 6:return ve.sent(),z=_.map(B,function(D,R){return{name:"TempFilter"+R,filter:D}}),O=this.getCurrentVisual(),Z=(0,E.ED)((0,Y.q)({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.createFromVisualContract(O),getAzureMapToken:function(){return H.azureMapTokenCache.getAzureMapToken()},azureMapsEndpoint:this.azureMapsEndpoint,geocoderIndexedDB:this.geocoderIndexedDB}),function(D){D.getLocalizedString=H.hostServices.getLocalizedString,D.tooltips=H.hostServices.tooltips,D.canSelect=H.hostServices.canSelect,D.onSelecting=H.hostServices.onSelecting,D.onSelect=H.hostServices.onSelect,D.onCustomSort=function(R){return H.onCustomSort(R.sortDescriptors)},D.geocoder=H.hostServices.geocoder,D.launchUrl=H.hostServices.launchUrl,D.canExpandCollapse=function(R){return n&&n.supportsInstanceFilters},D.setNodeExpansionState=function(R){var Pe=H.getCurrentVisual();Pe&&(R.isCollapse?H.expandCollapse.collapseNode(Pe,R.dataRoles,R.data):H.expandCollapse.expandNode(Pe,R.dataRoles,R.data),H.eventBridge.publishToChannel(ie.jCS,{affectContainer:function(Ge){return Ge.name===ot}}))},D.telemetry=H.hostServices.telemetry}),Object.defineProperty(Z,"instanceId",{value:fe.b$.generateGuid()}),this.singleVisualHostConfig={notifyStart:_.noop,notifyEnd:function(){var R;$.mn(null===(R=H.viewModel)||void 0===R?void 0:R.result)&&(H.viewModel.result.isLoading=!1)},clearQueryErrors:_.noop,handleQueryErrors:function(R){return H.handleQueryErrors(R)},handleQueryWarnings:_.noop,queryVisualHostServices:{getFilters:function(){var R=H.getCurrentVisual();if(R){var Pe=_.union(R&&R.filters,z);return H.createVisualContainerFilters(R,Pe)}},getDataSourceVariables:function(){var R=H.explorationNavigation.getCurrentExploration();return R&&R.dataSourceVariables},disableAnchorTime:!0},visualHostServices:Z,interactivityOptions:{selection:!0},additionalObjectUpdates:void 0,disableQueryCacheUpdates:!1,noLoadMore:!1},[4,this.setSuggestedQuestions()];case 7:return ve.sent(),_.isEmpty(this.config.initialUtterance)&&this.setSuggestionsViewModel(),[2]}})})},m.prototype.onCustomSort=function(t){var s=this.getCurrentVisual();(0,re.fI)(s,this.sortHelper,t)},m.prototype.ngAfterViewInit=function(){this.updateViewport()},m.prototype.update=function(t){var s;return(0,u.mG)(this,void 0,void 0,function(){var l,h,v,c,C,P,U,x,g,B,L,G,ee,N,ce,ae,Fe,Se;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return l=this,[4,this.getIsModelEditable()];case 1:return l.isModelEditable=o.sent(),(0,Le.yE)(t.type,Ce.EP.Style)&&!this.isBrowserIE?(K.fF.assertValue(this.viewModel,"viewModel should be defined"),h=(0,re.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.themeCollection=h,v=h&&this.themeService.getVisualStyle(h),c=v&&v.colorPalette.background.value||I.inputBoxBackgroundColor,C=v&&v.colorPalette.backgroundNeutral.value||I.hoverColor,P=I.acceptedColor,U=I.errorColor,x=I.warningColor,g=v&&te.v.create(v),B=this.themeService.getVisualStyle(this.viewModel.themeCollection).colorPalette.dataColors.getColorByIndex(0).value,L=(0,se.um)(B)>.6?I.darkFontColor:I.lightFontColor,G=(0,he.W7)(t.objects,{objectName:ye,propertyName:vt},c),ee=this.createFontProperties(t.objects,ye,Ve,"label",I.mediumFontSize,!1,g,v),N=(0,he.W7)(t.objects,{objectName:ye,propertyName:mt},B),ce={withBorder:I.withBorder,borderColor:I.borderColor,backgroundColor:G,questionFontProperties:ee,acceptedUnderlineColor:(0,he.W7)(t.objects,{objectName:ye,propertyName:rt},P),errorUnderlineColor:(0,he.W7)(t.objects,{objectName:ye,propertyName:at},U),warningUnderlineColor:(0,he.W7)(t.objects,{objectName:ye,propertyName:ft},x),hoverColor:(0,he.W7)(t.objects,{objectName:ye,propertyName:ht},C),restatementFontProperties:this.createFontProperties(t.objects,ye,Ye,"smallLabel",I.smallFontSize,!1,g,v),commitButtonBackgroundColor:N,commitButtonForegroundColor:ke(N)},this.viewModel.presentationViewModel.inputBox=ce,ae=this.createFontProperties(t.objects,Me,Ee,"label",I.mediumFontSize,!1,g,v),(!t.objects||!t.objects[Me]||!t.objects[Me][Ee+Ue])&&(ae.color=L),Fe={show:(0,he.NA)(t.objects,{objectName:Me,propertyName:"show"},!0),backgroundColor:(0,he.W7)(t.objects,{objectName:Me,propertyName:gt},B),cardFontProperties:ae,headerFontProperties:this.createFontProperties(t.objects,Me,Oe,"largeLabel",I.largeFontSize,!1,g,v)},this.viewModel.presentationViewModel.suggestions=Fe,this.viewModel.qnaInputConfiguration||(this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,qnaSupportedScopes:void 0,configs:Re}),[4,this.updateUnknownSpanHeaderConfig()]):[3,3];case 2:o.sent(),o.label=3;case 3:return(0,Le.yE)(t.type,Ce.EP.Data)?(this.inheritedFilters=t.filters,null!==(s=this.viewModel.qnaInputConfiguration)&&void 0!==s&&s.qnaSupportedScopes?[4,this.setSuggestedQuestions()]:[3,6]):[3,7];case 4:return o.sent(),$.Ew(this.viewModel.result)&&this.setSuggestionsViewModel(),[4,this.updateUnknownSpanHeaderConfig()];case 5:o.sent(),o.label=6;case 6:this.eventBridge.publishToChannel(ie.jCS,{affectContainer:function(n){return n.name===ot}}),o.label=7;case 7:return(0,Le.yE)(t.type,Ce.EP.Resize)&&(this.visualContainerViewport=t.viewport,this.updateViewport(),!this.isBrowserIE&&$.Ew(this.viewModel.result)&&this.setSuggestionsViewModel()),this.isBrowserIE||t.firstUpdate||t.objects&&t.objects[ct]&&(Se=(0,he.NA)(t.objects,{objectName:ct,propertyName:"savedUtterance"},""),this.qnaInputComponent&&this.qnaInputComponent.interpretUtterance({utterance:Se,suppressSuggestions:!0,incomingTags:["Committed"],useUncommittedUtterance:!0})),[2]}})})},m.prototype.enumerateObjectInstances=function(t){var s,l,h=this;if(K.fF.assert(function(){return!h.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var v=new f.G,c=this.viewModel.presentationViewModel;switch(t.objectName){case ye:var C=((s={})[vt]=c.inputBox.backgroundColor,s[Ve+Ue]=c.inputBox.questionFontProperties.color,s[Ve+Ne]=c.inputBox.questionFontProperties.size.pt,s);C[Ve+We]=c.inputBox.questionFontProperties.weight===M.en,C[Ve+He]=c.inputBox.questionFontProperties.style===M.BF,C[Ve+Ke]=c.inputBox.questionFontProperties.textDecoration===M.f0,C[Ve+je]=c.inputBox.questionFontProperties.family,C[rt]=c.inputBox.acceptedUnderlineColor,C[at]=c.inputBox.errorUnderlineColor,C[ft]=c.inputBox.warningUnderlineColor,C[ht]=c.inputBox.hoverColor,C[Ye+Ue]=c.inputBox.restatementFontProperties.color,C[Ye+Ne]=c.inputBox.restatementFontProperties.size.pt,C[Ye+je]=c.inputBox.restatementFontProperties.family,this.inCommitQuestionOnDemandMode&&(C[mt]=c.inputBox.commitButtonBackgroundColor),v.pushInstance({selector:null,properties:C,objectName:ye});break;case Me:var P=((l={}).show=c.suggestions.show,l[Oe+Ue]=c.suggestions.headerFontProperties.color,l[Oe+Ne]=c.suggestions.headerFontProperties.size.pt,l);P[Oe+We]=c.suggestions.headerFontProperties.weight===M.en,P[Oe+He]=c.suggestions.headerFontProperties.style===M.BF,P[Oe+Ke]=c.suggestions.headerFontProperties.textDecoration===M.f0,P[Oe+je]=c.suggestions.headerFontProperties.family,P[gt]=c.suggestions.backgroundColor,P[Ee+Ue]=c.suggestions.cardFontProperties.color,P[Ee+Ne]=c.suggestions.cardFontProperties.size.pt,P[Ee+We]=c.suggestions.cardFontProperties.weight===M.en,P[Ee+He]=c.suggestions.cardFontProperties.style===M.BF,P[Ee+Ke]=c.suggestions.cardFontProperties.textDecoration===M.f0,P[Ee+je]=c.suggestions.cardFontProperties.family,v.pushInstance({selector:null,properties:P,objectName:Me})}return v.complete()}},m.prototype.getFormattingModel=function(){var t=this;if(K.fF.assert(function(){return!t.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var s=this.viewModel.presentationViewModel;return new b.Nq(function(){return t.buildInputBoxFormattingCard(s)},function(){return t.buildRestatementFormattingCard(s)},function(){return t.buildSuggestionsFormattingCard(s)}).build()}},m.prototype.getCurrentVisual=function(){var t,s=null===(t=this.viewModel)||void 0===t?void 0:t.result;return $.mn(s)?s.visual:$.fU(s)?_.first(s.exploreCanvas.contract.visualContainers):$.wp(s)?s.visualWithError:void 0},m.prototype.getCurrentUtteranceTrimmed=function(){return _.trim(this.getCurrentUtteranceUntrimmed())},m.prototype.setGetQnaInputComponentFunc=function(t){K.fF.assertValue(t,"getQnaInputComponent must be defined."),this.getQnaInputComponent=t},m.prototype.convertVisualClicked=function(){var t=this.getCurrentVisual();if(t){var s=(0,Qe.s)(t);this.telemetryService.logChildEvent(this.initializedTelemetryEvent,oe.dN,{visualType:s}),this.convertVisual.emit(t)}},m.prototype.interpretSuggestedQuestion=function(t){var s=this;this.telemetryService.logChildEvent(this.initializedTelemetryEvent,oe.WW,{isAutoSuggestion:!0}),this.qnaInputComponent&&this.undoRedoService.register("Commit suggested QnA utterance",function(){s.qnaInputComponent.interpretUtterance({utterance:t,suppressSuggestions:!0,incomingTags:["SuggestedUtterance","Committed"],requireCursorAtEndIfFocused:!0,enforceFocus:!0,isCommitInCommitQuestionOnDemandMode:!0})})},m.prototype.toggleShowAllSuggestions=function(){if($.Ew(this.viewModel.result)){var t=this.viewModel.result;t.showAllSuggestions=!t.showAllSuggestions,this.setSuggestionsViewModel()}},m.prototype.showQnaVisualErrorDetails=function(){(0,re.aZ)(this.viewModel.error,this.errorService,this.localizationService)},m.prototype.showResultErrorDetails=function(){($.uT(this.viewModel.result)||$.wp(this.viewModel.result))&&(0,re.aZ)(this.viewModel.result,this.errorService,this.localizationService)},m.prototype.updateViewport=function(){if(!this.isBrowserIE){var t=this.contentElement.nativeElement;this.viewport={scale:1,height:t.clientHeight-10,width:t.clientWidth-10},this.viewModel.viewport=this.viewport}},m.prototype.getUnknownSpanDropdownHeaderActionType=function(){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(t){switch(t.label){case 0:return this.qnaLiveConnectService?this.qnaLiveConnectService.allowsLinguisticSchemaFeedback()?[2,"askToAdd"]:[3,1]:[2,"askToAdd"];case 1:return[4,this.allowTooling()];case 2:return t.sent()?[2,"defineInTooling"]:[2,"none"];case 3:return[2]}})})},m.prototype.allowTooling=function(){var t;return(0,u.mG)(this,void 0,void 0,function(){var s,l,h;return(0,u.Jh)(this,function(v){switch(v.label){case 0:return null==(s=null===(t=this.config)||void 0===t?void 0:t.canEdit)&&(s=0!==this.viewModeState.getMode()),s?(l=this.explorationCapabilities.getCapabilities(),l?.allowQnaTooling?null!=this.isModelEditable?[3,2]:(h=this,[4,this.getIsModelEditable()]):[2,!1]):[2,!1];case 1:h.isModelEditable=v.sent(),v.label=2;case 2:return this.isModelEditable?[2,!0]:[2,!1]}})})},m.prototype.shouldShowThumbsUpDown=function(){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(s){switch(s.label){case 0:return this.isBrowserIE?[2,!1]:this.featureSwitchService.featureSwitches.qnaThumbsUpDown?[4,this.getIsModelEditable()]:[2,!1];case 1:return[2,!s.sent()]}})})},m.prototype.showFeedbackForCurrentQuestion=function(){var s,t=this;if(K.fF.assert(function(){return!t.isBrowserIE},"Expect this never get called if it is inside IE browser"),this.isBrowserIE)return!1;var l=null===(s=this.viewModel)||void 0===s?void 0:s.result;return!!l&&($.mn(l)||$.lP(l)||$.fU(l))},m.prototype.sendFeedback=function(t){return this.logFeedbackTelemetry(t),this.qnaInputComponent.sendFeedback(t,this.getCurrentUtteranceTrimmed())},m.prototype.launchFeedbackDialog=function(t,s){return(0,u.mG)(this,void 0,void 0,function(){var h,v=this;return(0,u.Jh)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.dialogService.openHostDialog({bindings:{sentiment:t,showOptions:s},componentName:w.Xr,config:{minWidth:"600px",panelClass:["no-padding"]},dialogName:"QnaFeedbackDialog"})];case 1:return c.sent().afterClosed().pipe((0,W.q)(1)).subscribe(function(C){if(C&&(!_.isEmpty(C.reason)||!_.isEmpty(C.comment))){v.sendFeedback(C);var P=1===t?"PositiveDetailSubmitted":"NegativeDetailSubmitted";v.qnaFeedbackStateService.updateState(v.getCurrentUtteranceTrimmed(),P)}}),[3,3];case 2:return h=c.sent(),K.fF.assertFail("Qna Feedback dialog failed to open"),K.fF.log(h),[3,3];case 3:return[2]}})})},m.prototype.updateUnknownSpanHeaderConfig=function(){var t;return(0,u.mG)(this,void 0,void 0,function(){var s,h,v;return(0,u.Jh)(this,function(c){switch(c.label){case 0:return K.fF.assertValue(this.viewModel.qnaInputConfiguration.configs,"Expect this.viewModel.qnaInputConfiguration.configs has already been defined"),s=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,"textOnlyHeader"===(null===(t=s?.unknownSpanHeaderConfig)||void 0===t?void 0:t.actionType)?[3,2]:(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig||(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig={show:void 0}),h=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,v={},[4,this.getUnknownSpanDropdownHeaderActionType()]);case 1:h.unknownSpanHeaderConfig=(v.actionType=c.sent(),v),c.label=2;case 2:return[2]}})})},m.prototype.logFeedbackTelemetry=function(t){this.telemetryService.logChildEvent(this.initializedTelemetryEvent,oe.v5,{senitment:this.mapToTelemetryFeedbackSentiment(t.sentiment),reason:t.reason})},m.prototype.mapToTelemetryFeedbackSentiment=function(t){return K.fF.assert(function(){return 1===t||-1===t},"unexpected telemetry sentiment"),1===t?"Positive":"Negative"},m.prototype.shouldShowdoNotUnderstandMessageFeedbackLink=function(){var t=this.getCurrentUtteranceTrimmed();return"NegativeDetailSubmitted"!==this.qnaFeedbackStateService.getState(t)},Object.defineProperty(m.prototype,"qnaInputComponent",{get:function(){return this.getQnaInputComponent&&this.getQnaInputComponent()},enumerable:!1,configurable:!0}),m.prototype.getIsModelEditable=function(){return(0,u.mG)(this,void 0,void 0,function(){var t,s,l;return(0,u.Jh)(this,function(h){switch(h.label){case 0:return t=_.find(this.dataSources.get(),function(v){return v.type===Ie.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=h.sent(),l=t&&s?.schema(t.name).capabilities,[2,l?.canEdit]}})})},m.prototype.getCurrentUtteranceUntrimmed=function(){return this.qnaInputComponent&&this.qnaInputComponent.currentDisplayedUtterance},m.prototype.setSuggestedQuestions=function(){return(0,u.mG)(this,void 0,void 0,function(){var t,s,l,h,v,C=this;return(0,u.Jh)(this,function(P){switch(P.label){case 0:return K.fF.assert(function(){return!!C.interpretService},"interpretService should be defined"),this.pendingSuggestedQuestionsRequests++,[4,this.interpretService.getSuggestedQuestions(this.convertRequestScopes(this.viewModel.qnaInputConfiguration.qnaSupportedScopes)).toPromise()];case 1:if(t=P.sent(),this.pendingSuggestedQuestionsRequests--,s=t.result,"Loading"===this.viewModel.state&&this.pendingSuggestedQuestionsRequests>0&&!t.error&&_.isEmpty(s?.utterances))return[2];if(t.error)return this.viewModel.error=this.getErrorDetailsFromError(t.error),this.viewModel.state="Error",[2];if(l=_.chain(this.models).map(function(U){return _.map(U.featuredQuestions,function(x){return x.utterance})}).flatten().value(),_.isEmpty(l))for(l=[],h=0,v=s.utterances;h<v.length;h++)l.push(v[h].text);return K.fF.assert(function(){return!_.isEmpty(s.utterances)||!_.isEmpty(s.warnings)},"No suggested question but no warning? something is wrong."),this.suggestions={questions:l,hasWarnings:!_.isEmpty(s.warnings)},this.viewModel.state="Ready",[2]}})})},m.prototype.getErrorDetailsFromError=function(t){K.fF.assertValue(t,"Expect the given error to be defined.");var h,s=(0,Ae.AU)(t.errorCode,this.localizationService),l=t.errorCode,v=[],c=[];if("SchemaLanguageNotSupported"===t.errorCode)h=!1,v=[{errorInfoKey:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedTitle"),errorInfoValue:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedMessage")}];else if(!(h="GenericRequestFailure"!==l))if(t.sourceServiceError){var x=new X.sI(t.sourceServiceError).getDetails(this.localizationService);v=x.displayableErrorInfo,c=x.debugErrorInfo}else _.isEmpty(t.message)||c.push({errorInfoKey:de.Bm,errorInfoValue:t.message}),_.isEmpty(t.stackTrace)||c.push({errorInfoKey:de.RU,errorInfoValue:t.stackTrace});var g={code:l,fixableError:0,hideSeeDetails:h,details:{message:s,displayableErrorInfo:v,debugErrorInfo:c},source:t.source};return"DataIndexMissingAllStatistics"===t.errorCode&&(g.details.helpLink="https://go.microsoft.com/fwlink/?LinkId=786785",g.details.helpLinkType=1,g.details.errorType=1),K.fF.assert(function(){return!_.isEmpty(g.code)},"telemetryCode should not be empty"),K.fF.assert(function(){return null!=g.hideSeeDetails},"hideSeeDetails should not be null"),K.fF.assert(function(){return!_.isEmpty(g.details.message)},"mainMessage should not be empty"),K.fF.assert(function(){return null!=g.source},"errorSource should not be null"),g},m.prototype.setSuggestionsViewModel=function(){var s,l,h,t=this;K.fF.assert(function(){return!t.isBrowserIE},"Expect this never get called if it is inside IE browser");var v=_.size(null===(s=this.suggestions)||void 0===s?void 0:s.questions),c=this.viewModel.result,C=!!$.Ew(c)&&c.showAllSuggestions;v>0&&!C&&(v=Math.floor(this.contentElement.nativeElement.clientWidth/200))<=1&&(v=5);var x=_.take(null===(l=this.suggestions)||void 0===l?void 0:l.questions,v),g=_.size(x);this.viewModel.result={type:"Suggestions",suggestions:_.map(x,function(B,L){return{content:B,accessibilityLabel:t.localizationService.format("Visual_Qna_SuggestedQuestion_AccessibilityLabel",L+1,g,B)}}),showAllSuggestions:C,failedToLoadSuggestionsMessage:0===v&&null!==(h=this.suggestions)&&void 0!==h&&h.hasWarnings?this.localizationService.get("QnaStart_ErrorLoadingSuggestions"):void 0}},m.prototype.onResultAvailable=function(t){var s,l,h;return(0,u.mG)(this,void 0,void 0,function(){var v,c,C,P,U,x,g,B,L,G=this;return(0,u.Jh)(this,function(ee){switch(ee.label){case 0:return t&&1===t.resultType?[2]:t?(this.showQuestionProblematicResultTimeout&&(clearTimeout(this.showQuestionProblematicResultTimeout),this.showQuestionProblematicResultTimeout=void 0),_.includes(t.usedAgents,"PowerBI.AzureOpenAISynonyms")?[4,this.logInterpretCopilotTelemetry()]:[3,2]):(this.pinnableContentDefinitionUpdated.emit(void 0),this.viewModel.result=void 0,[2]);case 1:ee.sent(),ee.label=2;case 2:return null!=t.utterance&&this.utteranceUpdated.emit(t.utterance),this.updateViewport(),4===t.resultType&&this.setSuggestionsViewModel(),4!==t.resultType&&6!==t.resultType&&0!==t.resultType&&t.doNotShowResult&&(this.showQuestionProblematicResultTimeout=setTimeout(function(){var N=t.interpretError;if(N)G.interpretationError&&G.interpretationError.emit(),G.viewModel.result=(0,u.pi)({type:"Error"},G.getErrorDetailsFromError(N));else{var ce=G.localizationService.get("Qna_NoVisual_Message");G.viewModel.result={type:"DoNotUnderstand",message:_.isEmpty(t.doNotShowResultCustomMessageKeys)?ce:_.map(t.doNotShowResultCustomMessageKeys,function(ae){return G.localizationService.get(ae)}).join("\n\n")},G.screenReaderService.alert(ce)}},1500)),4===t.resultType||6===t.resultType||t.doNotShowResult||2!==t.resultType||!t.visualContainer&&!t.exploration?(this.pinnableContentDefinitionUpdated.emit(void 0),this.cancelVisualUpdateAlert(),[2]):(this.utteranceRestated&&this.utteranceRestated.emit(t.restatement),K.fF.assertValue(t.visualContainer||t.exploration,"result should contain either visualContainer or exploration"),t.visualContainer&&(t.visualContainer.name=ot),v=t.restatement,_.startsWith(v,"Show ")&&(v=_.replace(v,"Show ",t.visualContainer?"This visual is showing ":"Showing ")),c=t.modelId,t.visualContainer?(K.fF.assert(function(){var N;return!(null===(N=t.visualContainer.config)||void 0===N||!N.singleVisual)},"single visual is not defined"),this.config.showVisualsAsExploration?(C="QnaSection",t.visualContainer.layouts=(0,Je.Br)([{id:0,position:{x:0,y:0,height:this.viewport.height,width:this.viewport.width}}]),(P=null!==(s=(0,ze.PQ)(t.visualContainer).vcObjects)&&void 0!==s?s:{}).title=[{properties:{show:(0,J.O7)(!1)}}],t.visualContainer.config.singleVisual.vcObjects=P,U={name:C,displayName:C,size:{displayOption:0,width:this.viewport.width,height:this.viewport.height},visualContainers:[t.visualContainer],visualContainerGroups:[t.visualContainer],filters:[]},g={themeCollection:(0,re.D4)(this.featureSwitchService),dataSources:this.dataSources.get(),sections:[U],settings:{useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0}},this.explorationNavigation.loadExploration(g),this.explorationNavigation.goto(U),this.viewModel.result={type:"VisualAsExploration",restatement:v,exploreCanvas:(0,ge.T8)(g,U,0),modelId:c},q.UP.selectCanvasItem(t.visualContainer,this.selectionService),this.explorationActivity.sendExplorationContainerReady({parentActivity:void 0})):(this.viewModel.result=void 0,setTimeout(function(){return(0,u.mG)(G,void 0,void 0,function(){var N,ce=this;return(0,u.Jh)(this,function(ae){switch(ae.label){case 0:return this.viewModel.result={type:"Visual",restatement:v,visual:t.visualContainer,modelId:c,isLoading:!0},N=(0,ze.oJ)(t.visualContainer),_.isEmpty(N)?[3,2]:[4,this.createSortHelper(t.visualContainer)];case 1:ae.sent(),ae.label=2;case 2:return this.changeDetectorRef.detectChanges(),this.eventBridge.publishToChannel(ie.jCS,{affectContainer:function(Se){return Se.name===t.visualContainer.name}}),setTimeout(function(){return ce.updateViewport()}),[2]}})})})),x=(0,F.d9)(t.visualContainer,this.explorationSerializer),null!=(null===(h=null===(l=x?.config)||void 0===l?void 0:l.singleVisual)||void 0===h?void 0:h.vcObjects)&&(x.config.singleVisual.vcObjects=void 0),this.pinnableContentDefinitionUpdated.emit({pinVisualArgs:{dataSources:this.dataSources.get(),filters:this.createVisualContainerFilters(t.visualContainer,t.visualContainer.filters),modelId:c,resourcePackages:void 0,themeCollection:this.viewModel.themeCollection,utterance:t.utterance,visualContainer:x}}),this.alertVisualUpdate(this.getCurrentUtteranceTrimmed(),(0,Qe.s)(t.visualContainer)),[3,6]):[3,3]);case 3:return t.exploration?(this.updateViewport(),t.exploration.themeCollection?[4,be.P.loadThemeAndBaseTheme(this.promiseFactory,this.resourceLoader,this.themeService,t.exploration.resourcePackages,t.exploration.themeCollection)]:[3,5]):[3,6];case 4:ee.sent(),ee.label=5;case 5:B=(g=t.exploration).sections[g.activeSectionIndex],this.explorationNavigation.loadExploration(g),this.explorationNavigation.goto(B),this.viewModel.result={type:"Pod",restatement:v,exploreCanvas:(0,ge.T8)(g,B,0),modelId:c},L=_.find(this.models,function(N){return N.id===c}),this.pinnableContentDefinitionUpdated.emit({pinReportPageArgs:{exploration:(0,ge.vi)(g,0,g.activeSectionIndex,void 0,this.localizationService),section:B,reportId:g.reportId,modelId:c,packageId:L&&L.packageId,action:{action:Ie.RCq},utterance:t.utterance,pod:_.find(t.exploration.pods,function(N){return N.boundSection===B.name}).name,filters:B.filters}}),this.cancelVisualUpdateAlert(),ee.label=6;case 6:return[2]}})})},m.prototype.createSortHelper=function(t){return(0,u.mG)(this,void 0,void 0,function(){var s;return(0,u.Jh)(this,function(l){switch(l.label){case 0:return s=this,[4,(0,re.Vq)(t,this.conceptualSchemaProxy,this.dataSources,this.sortService,this.undoRedoService,this.visualAuthoringOpService,this.visualPlugin)];case 1:return s.sortHelper=l.sent(),[2]}})})},m.prototype.createFontProperties=function(t,s,l,h,v,c,C,P){var U=t&&t[s],x="".concat(l).concat(We),g="".concat(l).concat(He),B="".concat(l).concat(Ke),L=(0,_e.N)(U,x),G=(0,_e.N)(U,g),ee=(0,_e.N)(U,B),N={color:"".concat(l).concat(Ue),family:"".concat(l).concat(je),size:"".concat(l).concat(Ne)};return L&&(N.bold="".concat(l).concat(We)),G&&(N.italic="".concat(l).concat(He)),ee&&(N.underline="".concat(l).concat(Ke)),(0,le.Zi)(t&&t[s],N,C,P,"foreground",h,{color:I.fontColor,family:c?I.semiboldFont:I.regularFont,size:v,weight:M.AI,style:M.AI,textDecoration:M.zu})},m.prototype.createVisualContainerFilters=function(t,s){var l=_.isEmpty(s)?[]:_.chain(s).filter(function(B){return B.filter}).map(function(B){return B.filter}).value();this.inheritedFilters&&this.inheritedFilters.dataFilter&&l.push.apply(l,_.map(this.inheritedFilters.dataFiltersUnmerged,function(B){return B.filter}));for(var h=new ne.ME,v=0,c=l;v<c.length;v++)h.addVisualFilter({filter:c[v]});var P=(0,Qe.s)(t),U=P&&this.visualPlugin.capabilities(P),x=U&&U.supportsHighlight;!x&&this.inheritedFilters&&this.inheritedFilters.highlightFilter&&h.addVisualFilter({filter:this.inheritedFilters.highlightFilter});var g=h.getFilters(!1);return{dataFilter:g.dataFilter,dataFiltersUnmerged:g.dataFiltersUnmerged,highlightFilter:x&&this.inheritedFilters?this.inheritedFilters.highlightFilter:void 0,highlightFiltersUnmerged:x&&this.inheritedFilters?this.inheritedFilters.highlightFiltersUnmerged:void 0}},m.prototype.handleQueryErrors=function(t){if(!t.ignorable){var s=t.getDetails(this.localizationService),l=(0,$e.fe)(t.code);this.viewModel.result={type:"QueryError",visualWithError:this.getCurrentVisual(),details:s,code:t.code,fixableError:0,hideSeeDetails:(0,$e.O6)(t.code),overlayType:l,requestId:t.requestId,source:s.source||t.source||"PowerBI"},this.cancelVisualUpdateAlert()}},m.prototype.alertVisualUpdate=function(t,s){if(t){var l=s?this.localizationService.format("Qna_ScreenReader_VisualUpdatedWithChartType",[t,s]):this.localizationService.format("Qna_ScreenReader_VisualUpdated",[t]);this.screenReaderService.alertWithDebounce("qna_visual_update",l)}},m.prototype.cancelVisualUpdateAlert=function(){this.screenReaderService.cancelDebounce("qna_visual_update")},m.prototype.logInterpretCopilotTelemetry=function(){var t;return(0,u.mG)(this,void 0,void 0,function(){var s,l,h;return(0,u.Jh)(this,function(c){switch(c.label){case 0:return s=null!==(t=this.qnaProxyPathToken)&&void 0!==t?t:"@powerbi/Qna/qnaweb.module#QnaWebModule",[4,this.ensureInterpretCopilotTelemetry(s)];case 1:return c.sent(),[4,this.accountService.isSignedInAsync()];case 2:return l=c.sent(),h=this.viewModeState.getMode(),this.interpretCopilotTelemetry.logInterpretWithCopilotEvent("@powerbi/Qna/qnaweb.module#QnaWebModule"===this.qnaProxyPathToken?"service":"desktop",l,h),[2]}})})},m.prototype.ensureInterpretCopilotTelemetry=function(t){return(0,u.mG)(this,void 0,void 0,function(){var s;return(0,u.Jh)(this,function(l){switch(l.label){case 0:return null!=this.interpretCopilotTelemetry?[2]:(s=this,[4,this.lazyProvider.get(t,"interpretCopilotTelemetryService")]);case 1:return s.interpretCopilotTelemetry=l.sent(),[2]}})})},m.prototype.convertRequestScopes=function(t){return _.map(t,function(s){return{model:s.model,reportIds:s.reportIds}})},m.prototype.buildInputBoxFormattingCard=function(t){var s=this,l=j.Fp.inputBox,h=new b.CQ(new b.lg("inputBox"),"Visual_Qna_QuestionBox",l,function(x){return s.localizationService.get(x)}),v=t.inputBox.questionFontProperties.weight===M.en,c=t.inputBox.questionFontProperties.style===M.BF,C=t.inputBox.questionFontProperties.textDecoration===M.f0,U=(new b.UN).withFontFamily({descriptor:l.questionFontFamily,value:t.inputBox.questionFontProperties.family}).withFontSizeProperties({descriptor:l.questionFontSize,value:t.inputBox.questionFontProperties.size.pt}).withBold({descriptor:l.questionBold,value:v}).withItalic({descriptor:l.questionItalic,value:c}).withUnderline({descriptor:l.questionUnderline,value:C}).build();return h.addGroup("text",function(x){x.withDisplayName("Text").addCompositeSlice("fontselector","Font",U).addSimpleSlice("color",function(){return new b.BT({descriptor:l.questionFontColor,value:{value:t.inputBox.questionFontProperties.color}}).build()},function(g){return g.withCustomDisplayName("Generic_Color")})}),h.addGroup("background",function(x){x.withDisplayName("Visual_Background").addSimpleSlice("defaultColor",function(){return new b.BT({descriptor:l.background,value:{value:t.inputBox.backgroundColor}}).build()},function(g){return g.withCustomDisplayName("Visual_Qna_QuestionBackgroundColor")}).addSimpleSlice("hoverColor",function(){return new b.BT({descriptor:l.hoverColor,value:{value:t.inputBox.hoverColor}}).build()},function(g){return g.withCustomDisplayName("Visual_Qna_QuestionBackgroundHoverColor")})}),h.addGroup("underlines",function(x){x.withDisplayName("Underline").addSimpleSlice("acceptedColor",function(){return new b.BT({descriptor:l.acceptedColor,value:{value:t.inputBox.acceptedUnderlineColor}}).build()},function(g){return g.withCustomDisplayName("AcceptedColor")}).addSimpleSlice("errorColor",function(){return new b.BT({descriptor:l.errorColor,value:{value:t.inputBox.errorUnderlineColor}}).build()},function(g){return g.withCustomDisplayName("Error_Color")}).addSimpleSlice("warningColor",function(){return new b.BT({descriptor:l.warningColor,value:{value:t.inputBox.warningUnderlineColor}}).build()},function(g){return g.withCustomDisplayName("Warning_TitleColor")})}),h.addGroup("submitButton",function(x){x.withDisplayName("Visual_Qna_CommitButtonBackground").addSimpleSlice("submitButtonColor",function(){return new b.BT({descriptor:l.commitButtonBackgroundColor,value:{value:t.inputBox.commitButtonBackgroundColor}}).build()},function(g){return g.withCustomDisplayName("Background_Color")})}),h.build()},m.prototype.buildRestatementFormattingCard=function(t){var s=this,l=j.Fp.inputBox,h=new b.CQ(new b.lg("restatement"),"Visual_Qna_Restatement",l,function(C){return s.localizationService.get(C)}),c=(new b.UN).withFontFamily({descriptor:l.restatementFontFamily,value:t.inputBox.restatementFontProperties.family}).withFontSizeProperties({descriptor:l.restatementFontSize,value:t.inputBox.restatementFontProperties.size.pt}).build();return h.addGroup("text",function(C){C.addCompositeSlice("fontselector","Font",c).addSimpleSlice("color",function(){return new b.BT({descriptor:l.restatementFontColor,value:{value:t.inputBox.restatementFontProperties.color}}).build()},function(P){return P.withCustomDisplayName("Generic_Color")})}),h.build()},m.prototype.buildSuggestionsFormattingCard=function(t){var s=this,l=j.Fp.suggestions,h=new b.CQ(new b.lg("suggestions"),"Suggestions",l,function(B){return s.localizationService.get(B)});h.addTopLevelToggle("show",function(){return new b.bd({descriptor:l.show,value:t.suggestions.show}).build()});var v=t.suggestions.headerFontProperties.weight===M.en,c=t.suggestions.headerFontProperties.style===M.BF,C=t.suggestions.headerFontProperties.textDecoration===M.f0,U=(new b.UN).withFontFamily({descriptor:l.headerFontFamily,value:t.suggestions.headerFontProperties.family}).withFontSizeProperties({descriptor:l.headerFontSize,value:t.suggestions.headerFontProperties.size.pt}).withBold({descriptor:l.headerBold,value:v}).withItalic({descriptor:l.headerItalic,value:c}).withUnderline({descriptor:l.headerUnderline,value:C}).build();h.addGroup("header",function(B){B.withDisplayName("Visual_Qna_SuggestionsCardHeader").addCompositeSlice("fontselector","Font",U).addSimpleSlice("color",function(){return new b.BT({descriptor:l.headerFontColor,value:{value:t.suggestions.headerFontProperties.color}}).build()},function(L){return L.withCustomDisplayName("Generic_Color")})}),v=t.suggestions.cardFontProperties.weight===M.en,c=t.suggestions.cardFontProperties.style===M.BF,C=t.suggestions.cardFontProperties.textDecoration===M.f0;var g=(new b.UN).withFontFamily({descriptor:l.cardFontFamily,value:t.suggestions.cardFontProperties.family}).withFontSizeProperties({descriptor:l.cardFontSize,value:t.suggestions.cardFontProperties.size.pt}).withBold({descriptor:l.cardBold,value:v}).withItalic({descriptor:l.cardItalic,value:c}).withUnderline({descriptor:l.cardUnderline,value:C}).build();return h.addGroup("cards",function(B){B.withDisplayName("Cards").addCompositeSlice("fontselector","Font",g).addSimpleSlice("text",function(){return new b.BT({descriptor:l.cardFontColor,value:{value:t.suggestions.cardFontProperties.color}}).build()},function(L){return L.withCustomDisplayName("Text_Color")}).addSimpleSlice("background",function(){return new b.BT({descriptor:l.cardBackground,value:{value:t.suggestions.backgroundColor}}).build()},function(L){return L.withCustomDisplayName("Background_Color")})}),h.build()},m.\u0275fac=function(s){return new(s||m)(e.\u0275\u0275inject(Ze.D),e.\u0275\u0275inject(e.ChangeDetectorRef),e.\u0275\u0275inject(Te.i),e.\u0275\u0275inject(me.D),e.\u0275\u0275inject(Mt.x),e.\u0275\u0275inject(it.Z),e.\u0275\u0275inject(nt.U),e.\u0275\u0275inject(St.z),e.\u0275\u0275inject(Ft.L),e.\u0275\u0275inject(st.J),e.\u0275\u0275inject(Vt.vZ),e.\u0275\u0275inject(Bt.B),e.\u0275\u0275inject(zt.E),e.\u0275\u0275inject(Et.f),e.\u0275\u0275inject(It.v),e.\u0275\u0275inject(Ut.i),e.\u0275\u0275inject(qe._1),e.\u0275\u0275inject(Dt.m),e.\u0275\u0275inject(Qt.o),e.\u0275\u0275inject(_t.T),e.\u0275\u0275inject(xe.y0),e.\u0275\u0275inject(tt.l6),e.\u0275\u0275inject(ut.g),e.\u0275\u0275inject(Lt.y),e.\u0275\u0275inject(xt.z),e.\u0275\u0275inject(bt.K),e.\u0275\u0275inject(Tt.z),e.\u0275\u0275inject(lt.kc),e.\u0275\u0275inject(wt.Q),e.\u0275\u0275inject(Ot.o),e.\u0275\u0275inject(Rt.A),e.\u0275\u0275inject(At.W),e.\u0275\u0275inject(De.A),e.\u0275\u0275inject(y.t),e.\u0275\u0275inject(A.F),e.\u0275\u0275inject(Q.n,8),e.\u0275\u0275inject(V.z,8),e.\u0275\u0275inject(T,8))},m.\u0275prov=e.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac}),m}();function ke(m){return(0,se.um)(m)>.6?I.darkFontColor:I.lightFontColor}},21548:function(we,k,i){i.d(k,{B:function(){return e}});var u=i(50423),e=function(){function W(){this.states={}}return W.prototype.updateState=function(A,M){this.states[A.toLocaleLowerCase()]=M},W.prototype.getState=function(A){var M;return null!==(M=this.states[A.toLocaleLowerCase()])&&void 0!==M?M:"Unchosen"},W.\u0275prov=u.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac=function(M){return new(M||W)},providedIn:"root"}),W}()},5894:function(we,k,i){i.d(k,{WW:function(){return W},dN:function(){return M},v5:function(){return b},yP:function(){return F}});var u=i(41114),e="PBI.QnaVisual.SuggestionCardClicked",W=u.cx[e]=(0,u.b1)(e),A="PBI.QnaVisual.VisualConverted",M=u.cx[A]=(0,u.b1)(A),J="PBI.QnA.INAQ",F=u.cx[J]=(0,u.b1)(J,{logExpAssignment:!0}),te="PBI.QnA.Feedback",b=u.cx[te]=(0,u.b1)(te),se="PBI.QnA.UpdateLsdlSharingPermission",le=(u.cx[se]=(0,u.b1)(se),"PBI.QnaTooling.ImproveLsdlRequest");u.cx[le]=(0,u.b1)(le)},87974:function(we,k,i){i.d(k,{U:function(){return e}});var u=i(81337);function e(W,A,M){return(0,u.mG)(this,void 0,void 0,function(){var J,F;return(0,u.Jh)(this,function(b){switch(b.label){case 0:if(M.featureSwitches.qnaSupportCommitQuestionOnDemandForAll)return[2,!0];J=0,F=W??[],b.label=1;case 1:return J<F.length?[4,A.isDQOrLiveConnectToOnPrem(F[J])]:[3,4];case 2:if(b.sent())return[2,!0];b.label=3;case 3:return J++,[3,1];case 4:return[2,!1]}})})}}}]);