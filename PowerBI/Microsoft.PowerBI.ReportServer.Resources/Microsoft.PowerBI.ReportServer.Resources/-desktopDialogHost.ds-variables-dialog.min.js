(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["ds-variables-dialog"],{77489:function(Me){Me.exports=function(G,Se){(null==Se||Se>G.length)&&(Se=G.length);for(var ce=0,R=new Array(Se);ce<Se;ce++)R[ce]=G[ce];return R},Me.exports.default=Me.exports,Me.exports.__esModule=!0},32878:function(Me){function $e(Se,ce){for(var R=0;R<ce.length;R++){var X=ce[R];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(Se,X.key,X)}}Me.exports=function(Se,ce,R){return ce&&$e(Se.prototype,ce),R&&$e(Se,R),Se},Me.exports.default=Me.exports,Me.exports.__esModule=!0},34850:function(Me,$e,G){var Se=G(91052);Me.exports=function(R,X){var ke=typeof Symbol<"u"&&R[Symbol.iterator]||R["@@iterator"];if(ke)return(ke=ke.call(R)).next.bind(ke);if(Array.isArray(R)||(ke=Se(R))||X&&R&&"number"==typeof R.length){ke&&(R=ke);var W=0;return function(){return W>=R.length?{done:!0}:{done:!1,value:R[W++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},Me.exports.default=Me.exports,Me.exports.__esModule=!0},12864:function(Me,$e,G){var Se=G(74);Me.exports=function(R,X){R.prototype=Object.create(X.prototype),R.prototype.constructor=R,Se(R,X)},Me.exports.default=Me.exports,Me.exports.__esModule=!0},74:function(Me){function $e(G,Se){return Me.exports=$e=Object.setPrototypeOf||function(R,X){return R.__proto__=X,R},Me.exports.default=Me.exports,Me.exports.__esModule=!0,$e(G,Se)}Me.exports=$e,Me.exports.default=Me.exports,Me.exports.__esModule=!0},91052:function(Me,$e,G){var Se=G(77489);Me.exports=function(R,X){if(R){if("string"==typeof R)return Se(R,X);var ke=Object.prototype.toString.call(R).slice(8,-1);if("Object"===ke&&R.constructor&&(ke=R.constructor.name),"Map"===ke||"Set"===ke)return Array.from(R);if("Arguments"===ke||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ke))return Se(R,X)}},Me.exports.default=Me.exports,Me.exports.__esModule=!0},36444:function(Me,$e,G){var Se=G(32878).default,ce=G(12864).default,R=G(34850).default;function X(){"use strict";X=function(){return W};var ke,W={},Ue=Object.prototype,qe=Ue.hasOwnProperty,de=Object.defineProperty||function(N,O,U){N[O]=U.value},be="function"==typeof Symbol?Symbol:{},F=be.iterator||"@@iterator",Ie=be.asyncIterator||"@@asyncIterator",we=be.toStringTag||"@@toStringTag";function A(N,O,U){return Object.defineProperty(N,O,{value:U,enumerable:!0,configurable:!0,writable:!0}),N[O]}try{A({},"")}catch{A=function(U,M,Z){return U[M]=Z}}function Le(N,O,U,M){var ee=Object.create((O&&O.prototype instanceof ze?O:ze).prototype),Y=new We(M||[]);return de(ee,"_invoke",{value:$(N,U,Y)}),ee}function Qe(N,O,U){try{return{type:"normal",arg:N.call(O,U)}}catch(M){return{type:"throw",arg:M}}}W.wrap=Le;var fe="suspendedStart",ye="suspendedYield",se="executing",ve="completed",Ee={};function ze(){}function ie(){}function pe(){}var he={};A(he,F,function(){return this});var le=Object.getPrototypeOf,ge=le&&le(le(Ne([])));ge&&ge!==Ue&&qe.call(ge,F)&&(he=ge);var P=pe.prototype=ze.prototype=Object.create(he);function b(N){["next","throw","return"].forEach(function(O){A(N,O,function(U){return this._invoke(O,U)})})}function V(N,O){function U(Z,ee,Y,Ve){var f=Qe(N[Z],N,ee);if("throw"!==f.type){var Lt=f.arg,Tt=Lt.value;return Tt&&"object"==typeof Tt&&qe.call(Tt,"__await")?O.resolve(Tt.__await).then(function(wt){U("next",wt,Y,Ve)},function(wt){U("throw",wt,Y,Ve)}):O.resolve(Tt).then(function(wt){Lt.value=wt,Y(Lt)},function(wt){return U("throw",wt,Y,Ve)})}Ve(f.arg)}var M;de(this,"_invoke",{value:function(ee,Y){function Ve(){return new O(function(f,Lt){U(ee,Y,f,Lt)})}return M=M?M.then(Ve,Ve):Ve()}})}function $(N,O,U){var M=fe;return function(Z,ee){if(M===se)throw new Error("Generator is already running");if(M===ve){if("throw"===Z)throw ee;return{value:ke,done:!0}}for(U.method=Z,U.arg=ee;;){var Y=U.delegate;if(Y){var Ve=Pe(Y,U);if(Ve){if(Ve===Ee)continue;return Ve}}if("next"===U.method)U.sent=U._sent=U.arg;else if("throw"===U.method){if(M===fe)throw M=ve,U.arg;U.dispatchException(U.arg)}else"return"===U.method&&U.abrupt("return",U.arg);M=se;var f=Qe(N,O,U);if("normal"===f.type){if(M=U.done?ve:ye,f.arg===Ee)continue;return{value:f.arg,done:U.done}}"throw"===f.type&&(M=ve,U.method="throw",U.arg=f.arg)}}}function Pe(N,O){var U=O.method,M=N.iterator[U];if(M===ke)return O.delegate=null,"throw"===U&&N.iterator.return&&(O.method="return",O.arg=ke,Pe(N,O),"throw"===O.method)||"return"!==U&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+U+"' method")),Ee;var Z=Qe(M,N.iterator,O.arg);if("throw"===Z.type)return O.method="throw",O.arg=Z.arg,O.delegate=null,Ee;var ee=Z.arg;return ee?ee.done?(O[N.resultName]=ee.value,O.next=N.nextLoc,"return"!==O.method&&(O.method="next",O.arg=ke),O.delegate=null,Ee):ee:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,Ee)}function Ce(N){var O={tryLoc:N[0]};1 in N&&(O.catchLoc=N[1]),2 in N&&(O.finallyLoc=N[2],O.afterLoc=N[3]),this.tryEntries.push(O)}function me(N){var O=N.completion||{};O.type="normal",delete O.arg,N.completion=O}function We(N){this.tryEntries=[{tryLoc:"root"}],N.forEach(Ce,this),this.reset(!0)}function Ne(N){if(N||""===N){var O=N[F];if(O)return O.call(N);if("function"==typeof N.next)return N;if(!isNaN(N.length)){var U=-1,M=function Z(){for(;++U<N.length;)if(qe.call(N,U))return Z.value=N[U],Z.done=!1,Z;return Z.value=ke,Z.done=!0,Z};return M.next=M}}throw new TypeError(typeof N+" is not iterable")}return ie.prototype=pe,de(P,"constructor",{value:pe,configurable:!0}),de(pe,"constructor",{value:ie,configurable:!0}),ie.displayName=A(pe,we,"GeneratorFunction"),W.isGeneratorFunction=function(N){var O="function"==typeof N&&N.constructor;return!!O&&(O===ie||"GeneratorFunction"===(O.displayName||O.name))},W.mark=function(N){return Object.setPrototypeOf?Object.setPrototypeOf(N,pe):(N.__proto__=pe,A(N,we,"GeneratorFunction")),N.prototype=Object.create(P),N},W.awrap=function(N){return{__await:N}},b(V.prototype),A(V.prototype,Ie,function(){return this}),W.AsyncIterator=V,W.async=function(N,O,U,M,Z){void 0===Z&&(Z=Promise);var ee=new V(Le(N,O,U,M),Z);return W.isGeneratorFunction(O)?ee:ee.next().then(function(Y){return Y.done?Y.value:ee.next()})},b(P),A(P,we,"Generator"),A(P,F,function(){return this}),A(P,"toString",function(){return"[object Generator]"}),W.keys=function(N){var O=Object(N),U=[];for(var M in O)U.push(M);return U.reverse(),function Z(){for(;U.length;){var ee=U.pop();if(ee in O)return Z.value=ee,Z.done=!1,Z}return Z.done=!0,Z}},W.values=Ne,We.prototype={constructor:We,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=ke,this.done=!1,this.delegate=null,this.method="next",this.arg=ke,this.tryEntries.forEach(me),!O)for(var U in this)"t"===U.charAt(0)&&qe.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=ke)},stop:function(){this.done=!0;var O=this.tryEntries[0].completion;if("throw"===O.type)throw O.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var U=this;function M(Lt,Tt){return Y.type="throw",Y.arg=O,U.next=Lt,Tt&&(U.method="next",U.arg=ke),!!Tt}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var ee=this.tryEntries[Z],Y=ee.completion;if("root"===ee.tryLoc)return M("end");if(ee.tryLoc<=this.prev){var Ve=qe.call(ee,"catchLoc"),f=qe.call(ee,"finallyLoc");if(Ve&&f){if(this.prev<ee.catchLoc)return M(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return M(ee.finallyLoc)}else if(Ve){if(this.prev<ee.catchLoc)return M(ee.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<ee.finallyLoc)return M(ee.finallyLoc)}}}},abrupt:function(O,U){for(var M=this.tryEntries.length-1;M>=0;--M){var Z=this.tryEntries[M];if(Z.tryLoc<=this.prev&&qe.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var ee=Z;break}}ee&&("break"===O||"continue"===O)&&ee.tryLoc<=U&&U<=ee.finallyLoc&&(ee=null);var Y=ee?ee.completion:{};return Y.type=O,Y.arg=U,ee?(this.method="next",this.next=ee.finallyLoc,Ee):this.complete(Y)},complete:function(O,U){if("throw"===O.type)throw O.arg;return"break"===O.type||"continue"===O.type?this.next=O.arg:"return"===O.type?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):"normal"===O.type&&U&&(this.next=U),Ee},finish:function(O){for(var U=this.tryEntries.length-1;U>=0;--U){var M=this.tryEntries[U];if(M.finallyLoc===O)return this.complete(M.completion,M.afterLoc),me(M),Ee}},catch:function(O){for(var U=this.tryEntries.length-1;U>=0;--U){var M=this.tryEntries[U];if(M.tryLoc===O){var Z=M.completion;if("throw"===Z.type){var ee=Z.arg;me(M)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(O,U,M){return this.delegate={iterator:Ne(O),resultName:U,nextLoc:M},"next"===this.method&&(this.arg=ke),Ee}},W}typeof self<"u"&&self,Me.exports=function(){var de,be,ke={302:function(be,F,Ie){var A;F.formatArgs=function(A){if(A[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+A[0]+(this.useColors?"%c ":" ")+"+"+be.exports.humanize(this.diff),this.useColors){var Le="color: "+this.color;A.splice(1,0,Le,"color: inherit");var Qe=0,fe=0;A[0].replace(/%[a-zA-Z%]/g,function(ye){"%%"!==ye&&(Qe++,"%c"===ye&&(fe=Qe))}),A.splice(fe,0,Le)}},F.save=function(A){try{A?F.storage.setItem("debug",A):F.storage.removeItem("debug")}catch{}},F.load=function(){var A;try{A=F.storage.getItem("debug")}catch{}return!A&&typeof process<"u"&&"env"in process&&(A=process.env.DEBUG),A},F.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},F.storage=function(){try{return localStorage}catch{}}(),F.destroy=(A=!1,function(){A||(A=!0)}),F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],F.log=console.debug||console.log||function(){},be.exports=Ie(65)(F),be.exports.formatters.j=function(A){try{return JSON.stringify(A)}catch(Le){return"[UnexpectedJSONParseError]: "+Le.message}}},65:function(be,F,Ie){be.exports=function(we){function A(fe){var ye,se,ve,Ee=null;function ze(){for(var ie=arguments.length,pe=new Array(ie),he=0;he<ie;he++)pe[he]=arguments[he];if(ze.enabled){var le=ze,ge=Number(new Date);le.diff=ge-(ye||ge),le.prev=ye,le.curr=ge,ye=ge,pe[0]=A.coerce(pe[0]),"string"!=typeof pe[0]&&pe.unshift("%O");var b=0;pe[0]=pe[0].replace(/%([a-zA-Z%])/g,function(V,$){if("%%"===V)return"%";b++;var Pe=A.formatters[$];return"function"==typeof Pe&&(V=Pe.call(le,pe[b]),pe.splice(b,1),b--),V}),A.formatArgs.call(le,pe),(le.log||A.log).apply(le,pe)}}return ze.namespace=fe,ze.useColors=A.useColors(),ze.color=A.selectColor(fe),ze.extend=Le,ze.destroy=A.destroy,Object.defineProperty(ze,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==Ee?Ee:(se!==A.namespaces&&(se=A.namespaces,ve=A.enabled(fe)),ve)},set:function(pe){Ee=pe}}),"function"==typeof A.init&&A.init(ze),ze}function Le(fe,ye){var se=A(this.namespace+(void 0===ye?":":ye)+fe);return se.log=this.log,se}function Qe(fe){return fe.toString().substring(2,fe.toString().length-2).replace(/\.\*\?$/,"*")}return A.debug=A,A.default=A,A.coerce=function(fe){return fe instanceof Error?fe.stack||fe.message:fe},A.disable=function(){var fe=[].concat(A.names.map(Qe),A.skips.map(Qe).map(function(ye){return"-"+ye})).join(",");return A.enable(""),fe},A.enable=function(fe){var ye;A.save(fe),A.namespaces=fe,A.names=[],A.skips=[];var se=("string"==typeof fe?fe:"").split(/[\s,]+/),ve=se.length;for(ye=0;ye<ve;ye++)se[ye]&&("-"===(fe=se[ye].replace(/\*/g,".*?"))[0]?A.skips.push(new RegExp("^"+fe.slice(1)+"$")):A.names.push(new RegExp("^"+fe+"$")))},A.enabled=function(fe){if("*"===fe[fe.length-1])return!0;var ye,se;for(ye=0,se=A.skips.length;ye<se;ye++)if(A.skips[ye].test(fe))return!1;for(ye=0,se=A.names.length;ye<se;ye++)if(A.names[ye].test(fe))return!0;return!1},A.humanize=Ie(247),A.destroy=function(){},Object.keys(we).forEach(function(fe){A[fe]=we[fe]}),A.names=[],A.skips=[],A.formatters={},A.selectColor=function(fe){for(var ye=0,se=0;se<fe.length;se++)ye=(ye<<5)-ye+fe.charCodeAt(se),ye|=0;return A.colors[Math.abs(ye)%A.colors.length]},A.enable(A.load()),A}},247:function(be){var F=1e3,Ie=60*F,we=60*Ie,A=24*we;function ye(se,ve,Ee,ze){var ie=ve>=1.5*Ee;return Math.round(se/Ee)+" "+ze+(ie?"s":"")}be.exports=function(se,ve){ve=ve||{};var Ee=typeof se;if("string"===Ee&&se.length>0)return function(se){if(!((se=String(se)).length>100)){var ve=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(se);if(ve){var Ee=parseFloat(ve[1]);switch((ve[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*Ee;case"weeks":case"week":case"w":return 6048e5*Ee;case"days":case"day":case"d":return Ee*A;case"hours":case"hour":case"hrs":case"hr":case"h":return Ee*we;case"minutes":case"minute":case"mins":case"min":case"m":return Ee*Ie;case"seconds":case"second":case"secs":case"sec":case"s":return Ee*F;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Ee;default:return}}}}(se);if("number"===Ee&&isFinite(se))return ve.long?function(se){var ve=Math.abs(se);return ve>=A?ye(se,ve,A,"day"):ve>=we?ye(se,ve,we,"hour"):ve>=Ie?ye(se,ve,Ie,"minute"):ve>=F?ye(se,ve,F,"second"):se+" ms"}(se):function(se){var ve=Math.abs(se);return ve>=A?Math.round(se/A)+"d":ve>=we?Math.round(se/we)+"h":ve>=Ie?Math.round(se/Ie)+"m":ve>=F?Math.round(se/F)+"s":se+"ms"}(se);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(se))}}},W={};function Ue(de){var be=W[de];if(void 0!==be)return be.exports;var F=W[de]={exports:{}};return ke[de](F,F.exports,Ue),F.exports}be=Object.getPrototypeOf?function(F){return Object.getPrototypeOf(F)}:function(F){return F.__proto__},Ue.t=function(F,Ie){if(1&Ie&&(F=this(F)),8&Ie||"object"==typeof F&&F&&(4&Ie&&F.__esModule||16&Ie&&"function"==typeof F.then))return F;var we=Object.create(null);Ue.r(we);var A={};de=de||[null,be({}),be([]),be(be)];for(var Le=2&Ie&&F;"object"==typeof Le&&!~de.indexOf(Le);Le=be(Le))Object.getOwnPropertyNames(Le).forEach(function(Qe){return A[Qe]=function(){return F[Qe]}});return A.default=function(){return F},Ue.d(we,A),we},Ue.d=function(de,be){for(var F in be)Ue.o(be,F)&&!Ue.o(de,F)&&Object.defineProperty(de,F,{enumerable:!0,get:be[F]})},Ue.o=function(de,be){return Object.prototype.hasOwnProperty.call(de,be)},Ue.r=function(de){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(de,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(de,"__esModule",{value:!0})};var qe={};return function(){"use strict";Ue.r(qe),Ue.d(qe,{ActionObjectType:function(){return O},ChannelType:function(){return Mr},ChildAppWindow:function(){return _o},DialogDimension:function(){return wt},ErrorCode:function(){return M},FileOpenPreference:function(){return N},FrameContexts:function(){return f},HostClientType:function(){return Y},HostName:function(){return Ve},LiveShareHost:function(){return _i},NotificationTypes:function(){return qr},ParentAppWindow:function(){return Ja},SecondaryM365ContentIdName:function(){return U},TaskModuleDimension:function(){return dn},TeamType:function(){return Lt},UserSettingTypes:function(){return hr},UserTeamRole:function(){return Tt},ViewerActionTypes:function(){return Jr},app:function(){return xt},appEntity:function(){return Kn},appInitialization:function(){return un},appInstallDialog:function(){return $r},authentication:function(){return _n},barCode:function(){return Cr},calendar:function(){return oi},call:function(){return Ar},chat:function(){return Kr},clipboard:function(){return wr},conversations:function(){return gr},dialog:function(){return Qt},enablePrintCapability:function(){return Qo},executeDeepLink:function(){return Di},externalAppAuthentication:function(){return qn},externalAppCardActions:function(){return Jn},files:function(){return Yn},geoLocation:function(){return ei},getAdaptiveCardSchemaVersion:function(){return qa},getContext:function(){return jo},getMruTabInstances:function(){return Ai},getTabInstances:function(){return Pi},initialize:function(){return zo},initializeWithFrameContext:function(){return Ri},liveShare:function(){return Pn},location:function(){return In},logs:function(){return Br},mail:function(){return ai},marketplace:function(){return Dn},media:function(){return on},meeting:function(){return ni},meetingRoom:function(){return $n},menus:function(){return xn},monetization:function(){return Gn},navigateBack:function(){return Li},navigateCrossDomain:function(){return Mi},navigateToTab:function(){return Ti},notifications:function(){return Zn},openFilePreview:function(){return Oo},pages:function(){return ot},people:function(){return si},print:function(){return vi},profile:function(){return ui},registerAppButtonClickHandler:function(){return Bo},registerAppButtonHoverEnterHandler:function(){return Ci},registerAppButtonHoverLeaveHandler:function(){return Dr},registerBackButtonHandler:function(){return wi},registerBeforeUnloadHandler:function(){return Si},registerChangeSettingsHandler:function(){return Ei},registerCustomHandler:function(){return Ro},registerFocusEnterHandler:function(){return bi},registerFullScreenHandler:function(){return Wn},registerOnLoadHandler:function(){return yi},registerOnThemeChangeHandler:function(){return jt},registerUserSettingsChangeHandler:function(){return Na},remoteCamera:function(){return Xn},returnFocus:function(){return Oi},search:function(){return li},secondaryBrowser:function(){return ti},sendCustomEvent:function(){return La},sendCustomMessage:function(){return Ma},setFrameContext:function(){return Fi},settings:function(){return zn},shareDeepLink:function(){return ki},sharing:function(){return di},stageView:function(){return bn},tasks:function(){return jn},teams:function(){return er},teamsCore:function(){return gn},thirdPartyCloudStorage:function(){return kr},uploadCustomApp:function(){return Ta},version:function(){return sr},videoEffects:function(){return sn},videoEffectsEx:function(){return tr},visualMedia:function(){return Er},webStorage:function(){return Pr}});var we,A,t,de=(0,Ue(302).debug)("teamsJs");function be(t){return de.extend(t)}function F(t,r){return t+"_"+r}function Ie(t){return/^v\d+_[\w.]+$/.test(t)}(t=we||(we={})).V_0="v0",t.V_1="v1",t.V_2="v2",t.V_3="v3",function(t){t.App_GetContext="app.getContext",t.App_Initialize="app.initialize",t.App_NotifyAppLoaded="app.notifyAppLoaded",t.App_NotifyExpectedFailure="app.notifyExpectedFailure",t.App_NotifyFailure="app.notifyFailure",t.App_NotifySuccess="app.notifySuccess",t.App_OpenLink="app.openLink",t.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",t.AppEntity_SelectAppEntity="appEntity.selectAppEntity",t.BarCode_HasPermission="barCode.hasPermission",t.BarCode_RequestPermission="barCode.requestPermission",t.BarCode_ScanBarCode="barCode.scanBarCode",t.Calendar_ComposeMeeting="calendar.composeMeeting",t.Calendar_OpenCalendarItem="calendar.openCalendarItem",t.Call_StartCall="call.startCall",t.Clipboard_Read="clipboard.read",t.Clipboard_Write="clipboard.write",t.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",t.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",t.Dialog_Update_Resize="dialog.update.resize",t.Dialog_Url_Bot_Open="dialog.url.bot.open",t.Dialog_Url_Open="dialog.url.open",t.Dialog_Url_Submit="dialog.url.submit",t.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",t.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",t.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",t.GeoLocation_HasPermission="geoLocation.hasPermission",t.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",t.GeoLocation_RequestPermission="geoLocation.hasPermission",t.GeoLocation_ShowLocation="geoLocation.showLocation",t.Location_GetLocation="location.getLocation",t.Location_ShowLocation="location.showLocation",t.Mail_ComposeMail="mail.composeMail",t.Mail_OpenMailItem="mail.openMailItem",t.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",t.Marketplace_GetCart="marketplace.getCart",t.Marketplace_RemoveCardItems="marketplace.removeCartItems",t.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",t.Media_CaptureImage="media.captureImage",t.Media_Controller="media.controller",t.Media_GetMedia="media.getMedia",t.Media_HasPermission="media.hasPermission",t.Media_RequestPermission="media.requestPermission",t.Media_ScanBarCode="media.scanBarCode",t.Media_SelectMedia="media.selectMedia",t.Media_ViewImages="media.viewImages",t.Navigation_NavigateBack="navigation.navigateBack",t.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",t.Navigation_NavigateToTab="navigation.navigateToTab",t.Navigation_ReturnFocus="navigation.returnFocus",t.Pages_AppButton_OnClick="pages.appButton.onClick",t.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",t.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",t.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",t.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",t.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",t.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",t.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",t.Pages_Config_SetConfig="pages.config.setConfig",t.Pages_Config_SetValidityState="pages.config.setValidityState",t.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",t.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",t.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",t.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",t.Pages_GetConfig="pages.getConfig.",t.Pages_NavigateCrossDomain="pages.navigateCrossDomain",t.Pages_NavigateToApp="pages.navigateToApp",t.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",t.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",t.Pages_ReturnFocus="pages.returnFocus",t.Pages_SetCurrentFrame="pages.setCurrentFrame",t.Pages_ShareDeepLink="pages.shareDeepLink",t.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",t.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",t.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",t.PublicAPIs_ExecuteDeepLink="executeDeepLink",t.PublicAPIs_GetContext="getContext",t.PublicAPIs_GetMruTabInstances="getMruTabInstances",t.PublicAPIs_GetTabInstances="getTabInstances",t.PublicAPIs_Initialize="initialize",t.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",t.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",t.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",t.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",t.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",t.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",t.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",t.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",t.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",t.PublicAPIs_SetFrameContext="setFrameContext",t.PublicAPIs_ShareDeepLink="shareDeepLink",t.RegisterHandler="registerHandler",t.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",t.Settings_Remove_Failure="settings.remove.failure",t.Settings_Remove_Success="settings.remove.success",t.Settings_Save_Failure="settings.save.failure",t.Settings_Save_Success="settings.save.success",t.Tasks_StartTask="tasks.startTask",t.Tasks_SubmitTask="tasks.submitTask",t.Tasks_UpdateTask="tasks.updateTask"}(A||(A={}));var Le=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),Qe="2.0.1",se="1.8.0",ve=Ue.t(Le,2).validOrigins,Ee=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),ze=/^https:\/\//,ie="https",pe="teams.microsoft.com",he="The library has not yet been initialized",le="The runtime has not yet been initialized",ge="The runtime version is not supported",P=function(){};P.initializeCalled=!1,P.initializeCompleted=!1,P.additionalValidOrigins=[],P.initializePromise=void 0,P.isFramelessWindow=!1,P.frameContext=void 0,P.hostClientType=void 0,P.printCapabilityEnabled=!1;var V,b={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},$=new Uint8Array(16);function Pe(){if(!V&&!(V=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return V($)}for(var Ce=[],me=0;me<256;++me)Ce.push((me+256).toString(16).slice(1));var N,O,U,M,Z,ee,Y,Ve,f,Lt,Tt,wt,Ne=function(r,s,u){if(b.randomUUID&&!s&&!r)return b.randomUUID();var a=(r=r||{}).random||(r.rng||Pe)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){u=u||0;for(var c=0;c<16;++c)s[u+c]=a[c];return s}return function(t,r){return void 0===r&&(r=0),(Ce[t[r+0]]+Ce[t[r+1]]+Ce[t[r+2]]+Ce[t[r+3]]+"-"+Ce[t[r+4]]+Ce[t[r+5]]+"-"+Ce[t[r+6]]+Ce[t[r+7]]+"-"+Ce[t[r+8]]+Ce[t[r+9]]+"-"+Ce[t[r+10]]+Ce[t[r+11]]+Ce[t[r+12]]+Ce[t[r+13]]+Ce[t[r+14]]+Ce[t[r+15]]).toLowerCase()}(a)};(function(t){t.Inline="inline",t.Desktop="desktop",t.Web="web"})(N||(N={})),function(t){t.M365Content="m365content"}(O||(O={})),function(t){t.DriveId="driveId",t.GroupId="groupId",t.SiteId="siteId",t.UserId="userId"}(U||(U={})),function(t){t[t.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t[t.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",t[t.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",t[t.NETWORK_ERROR=2e3]="NETWORK_ERROR",t[t.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",t[t.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",t[t.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",t[t.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",t[t.THROTTLE=7e3]="THROTTLE",t[t.USER_ABORT=8e3]="USER_ABORT",t[t.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",t[t.OLD_PLATFORM=9e3]="OLD_PLATFORM",t[t.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",t[t.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(M||(M={})),function(t){t.GeoLocation="geolocation",t.Media="media"}(Z||(Z={})),function(t){t.TextPlain="text/plain",t.TextHtml="text/html",t.ImagePNG="image/png",t.ImageJPEG="image/jpeg"}(ee||(ee={})),function(t){t.desktop="desktop",t.web="web",t.android="android",t.ios="ios",t.ipados="ipados",t.macos="macos",t.rigel="rigel",t.surfaceHub="surfaceHub",t.teamsRoomsWindows="teamsRoomsWindows",t.teamsRoomsAndroid="teamsRoomsAndroid",t.teamsPhones="teamsPhones",t.teamsDisplays="teamsDisplays"}(Y||(Y={})),function(t){t.office="Office",t.outlook="Outlook",t.outlookWin32="OutlookWin32",t.orange="Orange",t.places="Places",t.teams="Teams",t.teamsModern="TeamsModern"}(Ve||(Ve={})),function(t){t.settings="settings",t.content="content",t.authentication="authentication",t.remove="remove",t.task="task",t.sidePanel="sidePanel",t.stage="stage",t.meetingStage="meetingStage"}(f||(f={})),function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff"}(Lt||(Lt={})),function(t){t[t.Admin=0]="Admin",t[t.User=1]="User",t[t.Guest=2]="Guest"}(Tt||(Tt={})),function(t){t.Large="large",t.Medium="medium",t.Small="small"}(wt||(wt={}));var Mr,dn=wt;!function(t){t.Regular="Regular",t.Private="Private",t.Shared="Shared"}(Mr||(Mr={}));var z={errorCode:M.NOT_SUPPORTED_ON_PLATFORM},Rn={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},ra=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),zt=new Error("Invalid response: Received more images than the specified max limit in the response.");function Zt(t){return function(r,s){if(!r)throw new Error(t||s)}}function bt(t,r){if("string"!=typeof t||"string"!=typeof r)return NaN;var s=t.split("."),u=r.split(".");function a(g){return/^\d+$/.test(g)}if(!s.every(a)||!u.every(a))return NaN;for(;s.length<u.length;)s.push("0");for(;u.length<s.length;)u.push("0");for(var c=0;c<s.length;++c)if(Number(s[c])!=Number(u[c]))return Number(s[c])>Number(u[c])?1:-1;return 0}function nr(){return Ne()}function Lr(t){return Object.keys(t).forEach(function(r){"object"==typeof t[r]&&Lr(t[r])}),Object.freeze(t)}function vn(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(){r&&r(null)}).catch(function(g){r&&r(g)}),c}function Ln(t){return!(bt(t.majorVersion+"."+t.minorVersion,"1.5")>=0)}function Cn(t){return"https:"===t.protocol}function fn(t,r){return new Promise(function(s,u){t||u("MimeType cannot be null or empty."),r||u("Base64 string cannot be null or empty.");var a=atob(r);if(t.startsWith("image/")){for(var c=new Uint8Array(a.length),g=0;g<a.length;g++)c[g]=a.charCodeAt(g);s(new Blob([c],{type:t}))}s(new Blob([a],{type:t}))})}function Nn(t){return new Promise(function(r,s){0===t.size&&s(new Error("Blob cannot be empty."));var u=new FileReader;u.onloadend=function(){u.result?r(u.result.toString().split(",")[1]):s(new Error("Failed to read the blob"))},u.onerror=function(){s(u.error)},u.readAsDataURL(t)})}function it(){if(ht())throw new Error("window object undefined at SSR check");return window}function ht(){return typeof window>"u"}var Bt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function ut(t){if(!Bt.test(t))throw new Error("App ID is not valid. Must be GUID format. App ID: "+t)}var Mt=be("runtime"),yt=3;function Xt(t){return t.apiVersion===yt}var l={apiVersion:-1,supports:{}},$i={apiVersion:3,hostVersionsInfo:Rn,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Nr=[Y.desktop,Y.web,Y.rigel,Y.surfaceHub,Y.teamsRoomsWindows,Y.teamsRoomsAndroid,Y.teamsPhones,Y.teamsDisplays],_r=[].concat(Nr,[Y.android,Y.ios,Y.ipados]);var ia=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(r){var s;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:r.isLegacyTeams,supports:Object.assign(Object.assign({},r.supports),{dialog:r.supports.dialog?{card:void 0,url:r.supports.dialog,update:null===(s=r.supports.dialog)||void 0===s?void 0:s.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(r){var a=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(r.supports,["appNotification"]);return Object.assign(Object.assign({},r),{apiVersion:3,supports:a})}}],xr={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Nr}],"1.9.0":[{capability:{location:{}},hostClientTypes:_r}],"2.0.0":[{capability:{people:{}},hostClientTypes:_r},{capability:{sharing:{}},hostClientTypes:[Y.desktop,Y.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[Y.android,Y.desktop,Y.ios,Y.teamsRoomsAndroid,Y.teamsPhones,Y.teamsDisplays,Y.web]},{capability:{webStorage:{}},hostClientTypes:[Y.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[Y.android,Y.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[Y.android,Y.ios]}]},wn=Mt.extend("generateBackCompatRuntimeConfig");function Vr(t,r){var s=Object.assign({},t);for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&("object"!=typeof r[u]||Array.isArray(r[u])?u in t||(s[u]=r[u]):s[u]=Vr(t[u]||{},r[u]));return s}function ir(t,r,s){wn("generating back compat runtime config for %s",t);var u=Object.assign({},r.supports);wn("Supported capabilities in config before updating based on highestSupportedVersion: %o",u),Object.keys(s).forEach(function(c){bt(t,c)>=0&&s[c].forEach(function(g){void 0!==P.hostClientType&&g.hostClientTypes.includes(P.hostClientType)&&(u=Vr(u,g.capability))})});var a={apiVersion:yt,hostVersionsInfo:Rn,isLegacyTeams:!0,supports:u};return wn("Runtime config after updating based on highestSupportedVersion: %o",a),a}var or=Mt.extend("applyRuntimeConfig");function ar(t){"string"==typeof t.apiVersion&&(or("Trying to apply runtime with string apiVersion, processing as v1: %o",t),t=Object.assign(Object.assign({},t),{apiVersion:1})),or("Fast-forwarding runtime %o",t);var r=function(t){var r=t;if(r.apiVersion<yt&&ia.forEach(function(s){r.apiVersion===s.versionToUpgradeFrom&&(r=s.upgradeToNextVersion(r))}),Xt(r))return r;throw new Error("Received a runtime that could not be upgraded to the latest version")}(t);or("Applying runtime %o",r),l=Lr(r)}var sr="2.19.0",Xi=be("internal"),oa=Xi.extend("ensureInitializeCalled"),aa=Xi.extend("ensureInitialized");function qt(){if(!P.initializeCalled)throw oa(he),new Error(he)}function S(t){if(!P.initializeCompleted)throw aa("%s. initializeCalled: %s",he,P.initializeCalled.toString()),new Error(he);for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];if(s&&s.length>0){for(var a=!1,c=0;c<s.length;c++)if(s[c]===P.frameContext){a=!0;break}if(!a)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(s)+'. Current context: "'+P.frameContext+'".')}return function(t){if(Xt(t))return!0;throw-1===t.apiVersion?new Error(le):new Error(ge)}(t)}function _t(t){void 0===t&&(t=Qe);var r=bt(P.clientSupportedSDKVersion,t);return!isNaN(r)&&r>=0}function Ki(){return P.hostClientType==Y.android||P.hostClientType==Y.ios||P.hostClientType==Y.ipados}function ur(t){if(void 0===t&&(t=Qe),!Ki())throw{errorCode:M.NOT_SUPPORTED_ON_PLATFORM};if(!_t(t))throw{errorCode:M.OLD_PLATFORM}}function Xe(t){return null==t}var _n,eo=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},pn=[],yn=be("validateOrigin");function to(){return eo(this,void 0,void 0,X().mark(function t(){return X().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",0!==pn.length?pn:ht()?(pn=ve,ve):fetch(Ee).then(function(u){if(!u.ok)throw new Error("Invalid Response from Fetch Call");return u.json().then(function(a){if(la(JSON.stringify(a)))return pn=a.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(u){return yn("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",u),pn=ve}));case 1:case"end":return s.stop()}},t)}))}function la(t){var r=JSON.parse(t);try{r=JSON.parse(t)}catch{return!1}if(!r.validOrigins)return!1;for(var u,s=R(r.validOrigins);!(u=s()).done;){var a=u.value;try{new URL("https://"+a)}catch{return yn("isValidOriginsFromCDN call failed to validate origin: %s",a),!1}}return!0}function Jt(t,r){if("*."===t.substring(0,2)){var s=t.substring(1);if(r.length>s.length&&r.split(".").length===s.split(".").length&&r.substring(r.length-s.length)===s)return!0}else if(t===r)return!0;return!1}function da(t){return to().then(function(r){if(!Cn(t))return yn("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",t,t.protocol),!1;var s=t.host;if(r.some(function(g){return Jt(g,s)}))return!0;for(var a,u=R(P.additionalValidOrigins);!(a=u()).done;){var c=a.value;if(Jt("https://"===c.substring(0,8)?c.substring(8):c,s))return!0}return yn("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",t,r,P.additionalValidOrigins),!1})}!function(t){var r,s,u,T;function c(T){return new Promise(function(J,re){if(P.hostClientType===Y.desktop||P.hostClientType===Y.android||P.hostClientType===Y.ios||P.hostClientType===Y.ipados||P.hostClientType===Y.macos||P.hostClientType===Y.rigel||P.hostClientType===Y.teamsRoomsWindows||P.hostClientType===Y.teamsRoomsAndroid||P.hostClientType===Y.teamsPhones||P.hostClientType===Y.teamsDisplays||P.hostClientType===Y.surfaceHub){var Q=document.createElement("a");Q.href=T.url,J(Vt("authentication.authenticate",[Q.href,T.width,T.height,T.isExternal]).then(function(Te){var St=Te[1];if(Te[0])return St;throw new Error(St)}))}else r={success:J,fail:re},function(T){C();var J=T.width||600,re=T.height||400;J=Math.min(J,B.currentWindow.outerWidth-400),re=Math.min(re,B.currentWindow.outerHeight-200);var Q=document.createElement("a");Q.href=T.url.replace("{oauthRedirectMethod}","web");var Te=void 0!==B.currentWindow.screenLeft?B.currentWindow.screenLeft:B.currentWindow.screenX,Ge=void 0!==B.currentWindow.screenTop?B.currentWindow.screenTop:B.currentWindow.screenY;B.childWindow=B.currentWindow.open(Q.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(Ge+=B.currentWindow.outerHeight/2-re/2)+", left="+(Te+=B.currentWindow.outerWidth/2-J/2)+", width="+J+", height="+re),B.childWindow?(h(),s=B.currentWindow.setInterval(function(){if(!B.childWindow||B.childWindow.closed)j("CancelledByUser");else{var T=B.childOrigin;try{B.childOrigin="*",Ut("ping")}finally{B.childOrigin=T}}},100),De("initialize",function(){return[f.authentication,P.hostClientType]}),De("navigateCrossDomain",function(){return!1})):j("FailedToOpenWindow")}(T)})}function C(){h();try{B.childWindow&&B.childWindow.close()}finally{B.childWindow=null,B.childOrigin=null}}function h(){s&&(clearInterval(s),s=0),gt("initialize"),gt("navigateCrossDomain")}function D(T){try{r&&r.success(T)}finally{r=void 0,C()}}function j(T){try{r&&r.fail(new Error(T))}finally{r=void 0,C()}}function Fe(T,J,re){if(T){var Q=document.createElement("a");Q.href=decodeURIComponent(T),Q.host&&Q.host!==it().location.host&&"outlook.office.com"===Q.host&&Q.search.indexOf("client_type=Win32_Outlook")>-1&&(J&&"result"===J&&(re&&(Q.href=q(Q.href,"result",re)),B.currentWindow.location.assign(q(Q.href,"authSuccess",""))),J&&"reason"===J&&(re&&(Q.href=q(Q.href,"reason",re)),B.currentWindow.location.assign(q(Q.href,"authFailure",""))))}}function q(T,J,re){var Q=T.indexOf("#"),Te=-1===Q?"#":T.substr(Q);return Te=Te+"&"+J+(""!==re?"="+re:""),(T=-1===Q?T:T.substr(0,Q))+Te}t.initialize=function(){De("authentication.authenticate.success",D,!1),De("authentication.authenticate.failure",j,!1)},t.registerAuthenticationHandlers=function(T){u=T},t.authenticate=function(T){var J=void 0!==T,re=J?T:u;if(!re)throw new Error("No parameters are provided for authentication");return S(l,f.content,f.sidePanel,f.settings,f.remove,f.task,f.stage,f.meetingStage),c(re).then(function(Q){try{return re&&re.successCallback?(re.successCallback(Q),""):Q}finally{J||(u=void 0)}}).catch(function(Q){try{if(re&&re.failureCallback)return re.failureCallback(Q.message),"";throw Q}finally{J||(u=void 0)}})},t.getAuthToken=function(T){return qt(),function(T){return new Promise(function(J){J(Vt("authentication.getAuthToken",[T?.resources,T?.claims,T?.silent]))}).then(function(J){var Q=J[1];if(J[0])return Q;throw new Error(Q)})}(T).then(function(J){return T&&T.successCallback?(T.successCallback(J),""):J}).catch(function(J){if(T&&T.failureCallback)return T.failureCallback(J.message),"";throw J})},t.getUser=function(T){return qt(),new Promise(function(T){T(Vt("authentication.getUser"))}).then(function(T){var re=T[1];if(T[0])return re;throw new Error(re)}).then(function(J){return T&&T.successCallback?(T.successCallback(J),null):J}).catch(function(J){if(T&&T.failureCallback)return T.failureCallback(J.message),null;throw J})},t.notifySuccess=function(T,J){Fe(J,"result",T),S(l,f.authentication),K("authentication.authenticate.success",[T]),jr(B.parentWindow,function(){return setTimeout(function(){return B.currentWindow.close()},200)})},t.notifyFailure=function(T,J){Fe(J,"reason",T),S(l,f.authentication),K("authentication.authenticate.failure",[T]),jr(B.parentWindow,function(){return setTimeout(function(){return B.currentWindow.close()},200)})},(T=t.DataResidency||(t.DataResidency={})).Public="public",T.EUDB="eudb",T.Other="other"}(_n||(_n={}));var Qt,xn,Kt=we.V_2;function no(t,r){if(S(l,f.content,f.sidePanel,f.task,f.meetingStage),!Qt.update.isSupported())throw z;_e(t,"tasks.updateTask",[r])}function Ur(t,r,s,u){if(S(l,f.content,f.sidePanel,f.meetingStage),!Qt.url.isSupported())throw z;u&&De("messageForParent",u),_e(t,"tasks.startTask",[Qt.url.getDialogInfoFromUrlDialogInfo(r)],function(a,c){s?.({err:a,result:c}),gt("messageForParent")})}function ro(t,r,s,u){if(S(l,f.content,f.sidePanel,f.meetingStage),!Qt.url.bot.isSupported())throw z;u&&De("messageForParent",u),_e(t,"tasks.startTask",[Qt.url.getDialogInfoFromBotUrlDialogInfo(r)],function(a,c){s?.({err:a,result:c}),gt("messageForParent")})}function io(t,r,s){if(S(l,f.content,f.task),!Qt.url.isSupported())throw z;_e(t,"tasks.completeTask",[r,s?Array.isArray(s)?s:[s]:[]])}(function(t){var g,r=[];function s(g){P.frameContext&&(P.frameContext===f.task?r.push(g):gt("messageForChild"))}t.initialize=function(){De("messageForChild",s,!1)},function(g){function v(){return S(l)&&void 0!==(l.supports.dialog&&l.supports.dialog.url)}var h;function m(h){return{url:h.url,height:h.size?h.size.height:wt.Small,width:h.size?h.size.width:wt.Small,title:h.title,fallbackUrl:h.fallbackUrl}}g.open=function(h,k,D){Ur(F(Kt,A.Dialog_Url_Open),h,k,D)},g.submit=function(h,k){io(F(Kt,A.Dialog_Url_Submit),h,k)},g.sendMessageToParentFromDialog=function(h){if(S(l,f.task),!v())throw z;_e(F(Kt,A.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[h])},g.sendMessageToDialog=function(h){if(S(l,f.content,f.sidePanel,f.meetingStage),!v())throw z;_e(F(Kt,A.Dialog_Url_SendMessageToDialog),"messageForChild",[h])},g.registerOnMessageFromParent=function(h){if(S(l,f.task),!v())throw z;for(gt("messageForChild"),De("messageForChild",h),r.reverse();r.length>0;)h(r.pop())},g.isSupported=v,(h=g.bot||(g.bot={})).open=function(k,D,j){ro(F(Kt,A.Dialog_Url_Bot_Open),k,D,j)},h.isSupported=function(){return S(l)&&void 0!==(l.supports.dialog&&l.supports.dialog.url&&l.supports.dialog.url.bot)},g.getDialogInfoFromUrlDialogInfo=m,g.getDialogInfoFromBotUrlDialogInfo=function(h){var k=m(h);return k.completionBotId=h.completionBotId,k}}(t.url||(t.url={})),t.isSupported=function(){return!(!S(l)||!l.supports.dialog)},(g=t.update||(t.update={})).resize=function(v){no(F(Kt,A.Dialog_Update_Resize),v)},g.isSupported=function(){return!(!S(l)||!l.supports.dialog||!l.supports.dialog.update)},function(g){function v(){var k=l.hostVersionsInfo&&l.hostVersionsInfo.adaptiveCardSchemaVersion&&!Ln(l.hostVersionsInfo.adaptiveCardSchemaVersion);return S(l)&&void 0!==(k&&l.supports.dialog&&l.supports.dialog.card)}function m(k){return{card:k.card,height:k.size?k.size.height:wt.Small,width:k.size?k.size.width:wt.Small,title:k.title}}g.open=function(k,D){if(S(l,f.content,f.sidePanel,f.meetingStage),!v())throw z;var j=m(k);_e(F(Kt,A.Dialog_AdaptiveCard_Open),"tasks.startTask",[j],function(Fe,q){D?.({err:Fe,result:q})})},g.isSupported=v,function(k){function D(){var j=l.hostVersionsInfo&&l.hostVersionsInfo.adaptiveCardSchemaVersion&&!Ln(l.hostVersionsInfo.adaptiveCardSchemaVersion);return S(l)&&void 0!==(j&&l.supports.dialog&&l.supports.dialog.card&&l.supports.dialog.card.bot)}k.open=function(j,Fe){if(S(l,f.content,f.sidePanel,f.meetingStage),!D())throw z;var q=function(k){var D=m(k);return D.completionBotId=k.completionBotId,D}(j);_e(F(Kt,A.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[q],function(T,J){Fe?.({err:T,result:J})})},k.isSupported=D}(g.bot||(g.bot={}))}(t.adaptiveCard||(t.adaptiveCard={}))})(Qt||(Qt={})),function(t){var u,a,c,h;function g(h){c&&c(h)||(S(l),K("viewConfigItemPress",[h]))}function v(h){u&&u(h)||(S(l),K("handleNavBarMenuItemPress",[h]))}function C(h){a&&a(h)||(S(l),K("handleActionMenuItemPress",[h]))}function m(){return!(!S(l)||!l.supports.menus)}(h=t.DisplayMode||(t.DisplayMode={}))[h.ifRoom=0]="ifRoom",h[h.overflowOnly=1]="overflowOnly",t.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(h){h.dropDown="dropDown",h.popOver="popOver"}(t.MenuListType||(t.MenuListType={})),t.initialize=function(){De("navBarMenuItemPress",v,!1),De("actionMenuItemPress",C,!1),De("setModuleView",g,!1)},t.setUpViews=function(h,k){if(S(l),!m())throw z;c=k,K("setUpViews",[h])},t.setNavBarMenu=function(h,k){if(S(l),!m())throw z;u=k,K("setNavBarMenu",[h])},t.showActionMenu=function(h,k){if(S(l),!m())throw z;a=k,K("showActionMenu",[h])},t.isSupported=m}(xn||(xn={}));var en=we.V_2,fa=5e3,oo=be("app");function Hr(t,r){return ht()?(oo.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(t,r,s){return new Promise(function(u,a){var c=setTimeout(a,r,s);t().then(function(g){clearTimeout(c),u(g)}).catch(function(g){clearTimeout(c),a(g)})})}(function(){return function(t,r){return new Promise(function(s){P.initializeCalled||(P.initializeCalled=!0,Ze.initializeHandlers(),P.initializePromise=function(t,r){var s=this;if(nt.messageListener=function(a){return Gr(s,void 0,void 0,X().mark(function c(){return X().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,bo(a);case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},c)}))},B.currentWindow=B.currentWindow||it(),B.parentWindow=B.currentWindow.parent!==B.currentWindow.self?B.currentWindow.parent:B.currentWindow.opener,(B.parentWindow||t)&&B.currentWindow.addEventListener("message",nt.messageListener,!1),!B.parentWindow){var u=B.currentWindow;if(!u.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));P.isFramelessWindow=!0,u.onNativeMessage=Ao}try{return B.parentOrigin="*",Hn(r,"initialize",[sr,yt]).then(function(a){return{context:a[0],clientType:a[1],runtimeConfig:a[2],clientSupportedSDKVersion:a[3]}})}finally{B.parentOrigin=null}}(r,t).then(function(u){var c=u.clientType,g=u.runtimeConfig,v=u.clientSupportedSDKVersion,C=void 0===v?Qe:v;P.frameContext=u.context,P.hostClientType=c,P.clientSupportedSDKVersion=C;try{hn("Parsing %s",g);var m=JSON.parse(g);if(hn("Checking if %o is a valid runtime object",m??"null"),!m||!m.apiVersion)throw new Error("Received runtime config is invalid");g&&ar(m)}catch(k){if(!(k instanceof SyntaxError))throw k;try{hn("Attempting to parse %s as an SDK version",g),isNaN(bt(g,Qe))||(P.clientSupportedSDKVersion=g);var h=JSON.parse(C);if(hn("givenRuntimeConfig parsed to %o",h??"null"),!h)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");ar(h)}catch(D){if(!(D instanceof SyntaxError))throw D;ar(ir(P.clientSupportedSDKVersion,$i,xr))}}P.initializeCompleted=!0}),_n.initialize(),xn.initialize(),ot.config.initialize(),Qt.initialize()),Array.isArray(r)&&function(t){var r=P.additionalValidOrigins.concat(t.filter(function(u){return"string"==typeof u&&ze.test(u)})),s={};r=r.filter(function(u){return!s[u]&&(s[u]=!0,!0)}),P.additionalValidOrigins=r}(r),void 0!==P.initializePromise?s(P.initializePromise):hn("GlobalVars.initializePromise is unexpectedly undefined")})}(t,r)},fa,new Error("SDK initialization timed out."))}var xt,hn=oo.extend("initializeHelper");function ao(t,r){!Xe(r)&&qt(),function(t,r){Ze.themeChangeHandler=r,!Xe(r)&&_e(t,"registerHandler",["themeChange"])}(t,r)}function so(t,r){return new Promise(function(s){S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage),s(nn(t,"executeDeepLink",r))})}!function(t){var c,r=be("app");t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(c=t.FailedReason||(t.FailedReason={})).AuthFailed="AuthFailed",c.Timeout="Timeout",c.Other="Other",function(c){c.PermissionError="PermissionError",c.NotFound="NotFound",c.Throttling="Throttling",c.Offline="Offline",c.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return P.initializeCompleted},t.getFrameContext=function(){return P.frameContext},function(){if(!ht()){var c=document.getElementsByTagName("script"),g=c&&c[c.length-1]&&c[c.length-1].src,v="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";g&&0!==g.length?r("teamsjs is being used from %s. %s",g,v):r("teamsjs is being used from a script tag embedded directly in your html. %s",v)}}(),t.initialize=function(c){return function(){eo(this,void 0,void 0,X().mark(function t(){return X().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,to();case 2:case"end":return s.stop()}},t)}))}(),Hr(F(en,A.App_Initialize),c)},t._initialize=function(c){B.currentWindow=c},t._uninitialize=function(){P.initializeCalled&&(Ze.uninitializeHandlers(),P.initializeCalled=!1,P.initializeCompleted=!1,P.initializePromise=void 0,P.additionalValidOrigins=[],P.frameContext=void 0,P.hostClientType=void 0,P.isFramelessWindow=!1,B.currentWindow&&B.currentWindow.removeEventListener("message",nt.messageListener,!1),B.currentWindow=null,B.parentWindow=null,B.parentOrigin=null,B.childWindow=null,B.childOrigin=null,nt.parentMessageQueue=[],nt.childMessageQueue=[],nt.nextMessageId=0,nt.callbacks={},nt.promiseCallbacks={})},t.getContext=function(){return new Promise(function(c){qt(),c(Un(F(en,A.App_GetContext),"getContext"))}).then(function(c){return function(t){var r;return{actionInfo:t.actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:Ve.teams,clientType:t.hostClientType?t.hostClientType:Y.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId},appLaunchId:t.appLaunchId},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:P.frameContext,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,sourceOrigin:t.sourceOrigin},user:{id:null!==(r=t.userObjectId)&&void 0!==r?r:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0}}(c)})},t.notifyAppLoaded=function(){qt(),_e(F(en,A.App_NotifyAppLoaded),t.Messages.AppLoaded,[sr])},t.notifySuccess=function(){qt(),_e(F(en,A.App_NotifySuccess),t.Messages.Success,[sr])},t.notifyFailure=function(c){qt(),_e(F(en,A.App_NotifyFailure),t.Messages.Failure,[c.reason,c.message])},t.notifyExpectedFailure=function(c){qt(),_e(F(en,A.App_NotifyExpectedFailure),t.Messages.ExpectedFailure,[c.reason,c.message])},t.registerOnThemeChangeHandler=function(c){ao(F(en,A.App_RegisterOnThemeChangeHandler),c)},t.openLink=function(c){return so(F(en,A.App_OpenLink),c)},function(c){c.registerBeforeSuspendOrTerminateHandler=function(g){if(!g)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");S(l),function(t){Ze.beforeSuspendOrTerminateHandler=t,!Xe(t)&&K("registerHandler",["beforeUnload"])}(g)},c.registerOnResumeHandler=function(g){if(!g)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");S(l),function(t){Ze.resumeHandler=t,!Xe(t)&&K("registerHandler",["load"])}(g)}}(t.lifecycle||(t.lifecycle={}))}(xt||(xt={}));var ot,Je=we.V_2;function uo(t,r){return new Promise(function(s){if(S(l,f.content,f.sidePanel,f.settings,f.remove,f.task,f.stage,f.meetingStage),!ot.isSupported())throw z;s(zr(t,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",r))})}function co(t){return new Promise(function(r){if(S(l),!ot.backStack.isSupported())throw z;r(zr(t,"navigateBack","Back navigation is not supported in the current client or context."))})}function lo(t,r){return new Promise(function(s){if(S(l),!ot.tabs.isSupported())throw z;s(zr(t,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",r))})}function fo(t,r){if(S(l),!ot.isSupported())throw z;_e(t,"returnFocus",[r])}function po(t,r){return new Promise(function(s){if(S(l),!ot.tabs.isSupported())throw z;s(Un(t,"getTabInstances",r))})}function ho(t,r){return new Promise(function(s){if(S(l),!ot.tabs.isSupported())throw z;s(Un(t,"getMruTabInstances",r))})}function go(t,r){if(S(l,f.content,f.sidePanel,f.meetingStage),!ot.isSupported())throw z;_e(t,"shareDeepLink",[r.subPageId,r.subPageLabel,r.subPageWebUrl])}function cr(t,r){if(S(l,f.content),!ot.isSupported())throw z;_e(t,"setFrameContext",[r])}!function(t){function r(m){cr(F(Je,A.Pages_SetCurrentFrame),m)}function s(){return!(!S(l)||!l.supports.pages)}var m;t.returnFocus=function(m){fo(F(Je,A.Pages_ReturnFocus),m)},t.registerFocusEnterHandler=function(m){Ot(F(Je,A.Pages_RegisterFocusEnterHandler),"focusEnter",m,[],function(){if(!s())throw z})},t.setCurrentFrame=r,t.initializeWithFrameContext=function(m,h,k){xt.initialize(k).then(function(){return h&&h()}),r(m)},t.getConfig=function(){return new Promise(function(m){if(S(l,f.content,f.settings,f.remove,f.sidePanel),!s())throw z;m(Un(F(Je,A.Pages_GetConfig),"settings.getSettings"))})},t.navigateCrossDomain=function(m){return uo(F(Je,A.Pages_NavigateCrossDomain),m)},t.navigateToApp=function(m){return new Promise(function(h){if(S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage),!s())throw z;var k=F(Je,A.Pages_NavigateCrossDomain);h(l.isLegacyTeams?nn(k,"executeDeepLink",function(t){var r=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(t.appId)+"/"+encodeURIComponent(t.pageId));return t.webUrl&&r.searchParams.append("webUrl",t.webUrl),(t.channelId||t.subPageId)&&r.searchParams.append("context",JSON.stringify({channelId:t.channelId,subEntityId:t.subPageId})),r.toString()}(m)):nn(k,"pages.navigateToApp",m))})},t.shareDeepLink=function(m){return go(F(Je,A.Pages_ShareDeepLink),m)},t.registerFullScreenHandler=function(m){Ot(F(Je,A.Pages_RegisterFullScreenHandler),"fullScreenChange",m,[],function(){if(!Xe(m)&&!s())throw z})},t.isSupported=s,(m=t.tabs||(t.tabs={})).navigateToTab=function(h){return lo(F(Je,A.Pages_Tabs_NavigateToTab),h)},m.getTabInstances=function(h){return po(F(Je,A.Pages_Tabs_GetTabInstances),h)},m.getMruTabInstances=function(h){return ho(F(Je,A.Pages_Tabs_GetMruTabInstances),h)},m.isSupported=function(){return!(!S(l)||!l.supports.pages||!l.supports.pages.tabs)},function(m){var h,k;function D(Q,Te){!Xe(Q)&&S(l,f.settings),Te&&Te(),h=Q,!Xe(Q)&&_e(F(Je,A.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function j(Q,Te){!Xe(Q)&&S(l,f.remove,f.settings),Te&&Te(),k=Q,!Xe(Q)&&_e(F(Je,A.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function Fe(Q){var Te=new q(Q);h?h(Te):B.childWindow?Ut("settings.save",[Q]):Te.notifySuccess()}m.initialize=function(){De("settings.save",Fe,!1),De("settings.remove",T,!1)},m.setValidityState=function(Q){if(S(l,f.settings,f.remove),!re())throw z;_e(F(Je,A.Pages_Config_SetValidityState),"settings.setValidityState",[Q])},m.setConfig=function(Q){return new Promise(function(Te){if(S(l,f.content,f.settings,f.sidePanel),!re())throw z;Te(nn(F(Je,A.Pages_Config_SetConfig),"settings.setSettings",Q))})},m.registerOnSaveHandler=function(Q){D(Q,function(){if(!Xe(Q)&&!re())throw z})},m.registerOnSaveHandlerHelper=D,m.registerOnRemoveHandler=function(Q){j(Q,function(){if(!Xe(Q)&&!re())throw z})},m.registerOnRemoveHandlerHelper=j,m.registerChangeConfigHandler=function(Q){Ot(F(Je,A.Pages_Config_RegisterChangeConfigHandler),"changeSettings",Q,[f.content],function(){if(!re())throw z})};var q=function(){function Q(Ge){this.notified=!1,this.result=Ge||{}}var Te=Q.prototype;return Te.notifySuccess=function(){this.ensureNotNotified(),_e(F(Je,A.Settings_Save_Success),"settings.save.success"),this.notified=!0},Te.notifyFailure=function(St){this.ensureNotNotified(),_e(F(Je,A.Settings_Save_Failure),"settings.save.failure",[St]),this.notified=!0},Te.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},Q}();function T(){var Q=new J;k?k(Q):B.childWindow?Ut("settings.remove",[]):Q.notifySuccess()}var J=function(){function Q(){this.notified=!1}var Te=Q.prototype;return Te.notifySuccess=function(){this.ensureNotNotified(),_e(F(Je,A.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},Te.notifyFailure=function(St){this.ensureNotNotified(),_e(F(Je,A.Settings_Remove_Failure),"settings.remove.failure",[St]),this.notified=!0},Te.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},Q}();function re(){return!(!S(l)||!l.supports.pages||!l.supports.pages.config)}m.isSupported=re}(t.config||(t.config={})),function(m){var h;function k(){return co(F(Je,A.Pages_BackStack_NavigateBack))}function D(q,T,J){!Xe(T)&&S(l),J&&J(),h=T,!Xe(T)&&_e(q,"registerHandler",["backButton"])}function j(){h&&h()||(B.childWindow?Ut("backButtonPress",[]):k())}function Fe(){return!(!S(l)||!l.supports.pages||!l.supports.pages.backStack)}m._initialize=function(){De("backButtonPress",j,!1)},m.navigateBack=k,m.registerBackButtonHandler=function(q){D(F(Je,A.Pages_BackStack_RegisterBackButtonHandler),q,function(){if(!Xe(q)&&!Fe())throw z})},m.registerBackButtonHandlerHelper=D,m.isSupported=Fe}(t.backStack||(t.backStack={})),function(m){function h(){return!(!S(l)||!l.supports.pages||!l.supports.pages.fullTrust)}m.enterFullscreen=function(){if(S(l,f.content),!h())throw z;_e(F(Je,A.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},m.exitFullscreen=function(){if(S(l,f.content),!h())throw z;_e(F(Je,A.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},m.isSupported=h}(t.fullTrust||(t.fullTrust={})),function(m){function h(){return!(!S(l)||!l.supports.pages||!l.supports.pages.appButton)}m.onClick=function(k){Ot(F(Je,A.Pages_AppButton_OnClick),"appButtonClick",k,[f.content],function(){if(!h())throw z})},m.onHoverEnter=function(k){Ot(F(Je,A.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",k,[f.content],function(){if(!h())throw z})},m.onHoverLeave=function(k){Ot(F(Je,A.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",k,[f.content],function(){if(!h())throw z})},m.isSupported=h}(t.appButton||(t.appButton={})),function(m){function h(){return!(!S(l)||!l.supports.pages||!l.supports.pages.currentApp)}m.navigateTo=function(k){return new Promise(function(D){if(S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage),!h())throw z;D(dt(F(Je,A.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",k))})},m.navigateToDefaultPage=function(){return new Promise(function(k){if(S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage),!h())throw z;k(dt(F(Je,A.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},m.isSupported=h}(t.currentApp||(t.currentApp={}))}(ot||(ot={}));var ga=be("handlers"),Ze=function(){function t(){}return t.initializeHandlers=function(){t.handlers.themeChange=wo,t.handlers.load=tn,t.handlers.beforeUnload=wa,ot.backStack._initialize()},t.uninitializeHandlers=function(){t.handlers={},t.themeChangeHandler=null,t.loadHandler=null,t.beforeUnloadHandler=null,t.beforeSuspendOrTerminateHandler=null,t.resumeHandler=null},t}();Ze.handlers={},Ze.themeChangeHandler=null,Ze.loadHandler=null,Ze.beforeUnloadHandler=null,Ze.beforeSuspendOrTerminateHandler=null,Ze.resumeHandler=null;var vo=ga.extend("callHandler");function Ir(t,r){var s=Ze.handlers[t];return s?(vo("Invoking the registered handler for message %s with arguments %o",t,r),[!0,s.apply(this,r)]):B.childWindow?(Ut(t,r),[!1,void 0]):(vo("Handler for action message %s not found.",t),[!1,void 0])}function De(t,r,s,u){void 0===s&&(s=!0),void 0===u&&(u=[]),r?(Ze.handlers[t]=r,s&&_e(F(we.V_0,A.RegisterHandler),"registerHandler",[t].concat(u))):delete Ze.handlers[t]}function gt(t){delete Ze.handlers[t]}function Co(t){return null!=Ze.handlers[t]}function Ot(t,r,s,u,a){s&&S.apply(void 0,[l].concat(u)),a&&a(),De(r,s)}function wo(t){Ze.themeChangeHandler&&Ze.themeChangeHandler(t),B.childWindow&&Ut("themeChange",[t])}function tn(t){Ze.resumeHandler?Ze.resumeHandler(t):Ze.loadHandler&&Ze.loadHandler(t),B.childWindow&&Ut("load",[t])}function wa(){var t=function(){K("readyToUnload",[])};Ze.beforeSuspendOrTerminateHandler?(Ze.beforeSuspendOrTerminateHandler(),B.childWindow?Ut("beforeUnload"):t()):Ze.beforeUnloadHandler&&Ze.beforeUnloadHandler(t)||(B.childWindow?Ut("beforeUnload"):t())}var Gr=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},Vn=be("communication"),B=function(){},nt=function(){};function Un(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){return c[0]})}function Wr(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Vt(t,s).then(function(a){return a[0]})}function nn(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){if(!c[0])throw new Error(c[1])})}function rn(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Vt(t,s).then(function(a){if(!a[0])throw new Error(a[1])})}function zr(t,r,s){for(var u=arguments.length,a=new Array(u>3?u-3:0),c=3;c<u;c++)a[c-3]=arguments[c];return Hn(t,r,a).then(function(g){if(!g[0])throw new Error(g[1]||s)})}function dt(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){var g=c[0];if(g)throw g;return c[1]})}function at(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Vt(t,s).then(function(a){var c=a[0];if(c)throw c;return a[1]})}function Hn(t,r,s){if(void 0===s&&(s=void 0),!Ie(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(u){u(yo(dr(t,r,s).id))})}function Vt(t,r){return void 0===r&&(r=void 0),new Promise(function(s){s(yo(dr(F(we.V_0,"testing"),t,r).id))})}function yo(t){return new Promise(function(r){nt.promiseCallbacks[t]=r})}function _e(t,r,s,u){var a;if(s instanceof Function?u=s:s instanceof Array&&(a=s),!Ie(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var c=dr(t,r,a);u&&(nt.callbacks[c.id]=u)}function K(t,r,s){var u;r instanceof Function?s=r:r instanceof Array&&(u=r);var a=dr(F(we.V_0,"testing"),t,u);s&&(nt.callbacks[a.id]=s)}nt.parentMessageQueue=[],nt.childMessageQueue=[],nt.nextMessageId=0,nt.callbacks={},nt.promiseCallbacks={};var Pa=Vn.extend("sendMessageToParentHelper");function dr(t,r,s){var u=Pa,a=B.parentWindow,c=function(t,r,s){return{id:nt.nextMessageId++,func:r,timestamp:Date.now(),args:s||[],apiversiontag:t}}(t,r,s);if(u("Message %i information: %o",c.id,{actionName:r,args:s}),P.isFramelessWindow)B.currentWindow&&B.currentWindow.nativeInterface&&(u("Sending message %i to parent via framelessPostMessage interface",c.id),B.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(c)));else{var g=pr(a);a&&g?(u("Sending message %i to parent via postMessage",c.id),a.postMessage(c,g)):(u("Adding message %i to parent message queue",c.id),fr(a).push(c))}return c}var So=Vn.extend("processMessage");function bo(t){return Gr(this,void 0,void 0,X().mark(function r(){var s,u;return X().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t&&t.data&&"object"==typeof t.data){c.next=2;break}return c.abrupt("return",void So("Unrecognized message format received by app, message being ignored. Message: %o",t));case 2:return c.abrupt("return",Aa(s=t.source||t.originalEvent&&t.originalEvent.source,u=t.origin||t.originalEvent&&t.originalEvent.origin).then(function(g){g?(ka(s,u),s===B.parentWindow?Ao(t):s===B.childWindow&&Qr(t)):So("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return c.stop()}},r)}))}var Eo=Vn.extend("shouldProcessMessage");function Aa(t,r){return Gr(this,void 0,void 0,X().mark(function s(){var u;return X().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!B.currentWindow||t!==B.currentWindow){c.next=2;break}return c.abrupt("return",(Eo("Should not process message because it is coming from the current window"),!1));case 2:if(!(B.currentWindow&&B.currentWindow.location&&r&&r===B.currentWindow.location.origin)){c.next=4;break}return c.abrupt("return",!0);case 4:return c.next=6,da(new URL(r));case 6:return c.abrupt("return",((u=c.sent)||Eo("Message has an invalid origin of %s",r),u));case 8:case"end":return c.stop()}},s)}))}function ka(t,r){P.isFramelessWindow||B.parentWindow&&!B.parentWindow.closed&&t!==B.parentWindow?B.childWindow&&!B.childWindow.closed&&t!==B.childWindow||(B.childWindow=t,B.childOrigin=r):(B.parentWindow=t,B.parentOrigin=r),B.parentWindow&&B.parentWindow.closed&&(B.parentWindow=null,B.parentOrigin=null),B.childWindow&&B.childWindow.closed&&(B.childWindow=null,B.childOrigin=null),Do(B.parentWindow),Do(B.childWindow)}var Po=Vn.extend("handleParentMessage");function Ao(t){var r=Po;if("id"in t.data&&"number"==typeof t.data.id){var s=t.data,u=nt.callbacks[s.id];r("Received a response from parent for message %i",s.id),u&&(r("Invoking the registered callback for message %i with arguments %o",s.id,s.args),u.apply(null,[].concat(s.args,[s.isPartialResponse])),function(t){return!0===t.data.isPartialResponse}(t)||(r("Removing registered callback for message %i",s.id),delete nt.callbacks[s.id]));var a=nt.promiseCallbacks[s.id];a&&(r("Invoking the registered promise callback for message %i with arguments %o",s.id,s.args),a(s.args),r("Removing registered promise callback for message %i",s.id),delete nt.promiseCallbacks[s.id])}else if("func"in t.data&&"string"==typeof t.data.func){var c=t.data;r("Received an action message %s from parent",c.func),Ir(c.func,c.args)}else r("Received an unknown message: %O",t)}function Qr(t){if("id"in t.data&&"func"in t.data){var r=t.data,s=Ir(r.func,r.args),a=s[1];s[0]&&void 0!==a?Fo(r.id,Array.isArray(a)?a:[a]):K(r.func,r.args,function(){if(B.childWindow){for(var c=arguments.length,g=new Array(c),v=0;v<c;v++)g[v]=arguments[v];var C=g.pop();Fo(r.id,g,C)}})}}function fr(t){return t===B.parentWindow?nt.parentMessageQueue:t===B.childWindow?nt.childMessageQueue:[]}function pr(t){return t===B.parentWindow?B.parentOrigin:t===B.childWindow?B.childOrigin:null}var Br,qr,Jr,hr,gr,Da=Vn.extend("flushMessageQueue");function Do(t){for(var r=pr(t),s=fr(t),u=t==B.parentWindow?"parent":"child";t&&r&&s.length>0;){var a=s.shift();Da("Flushing message %i from "+u+" message queue via postMessage.",a?.id),t.postMessage(a,r)}}function jr(t,r){var s;s=B.currentWindow.setInterval(function(){0===fr(t).length&&(clearInterval(s),r())},100)}function Fo(t,r,s){var u=B.childWindow,a=function(t,r,s){return{id:t,args:r||[],isPartialResponse:s}}(t,r,s),c=pr(u);u&&c&&u.postMessage(a,c)}function Ut(t,r){var s=B.childWindow,u=function(t,r){return{func:t,args:r||[]}}(t,r),a=pr(s);s&&a?s.postMessage(u,a):fr(s).push(u)}function Ta(t,r){S(l),K("uploadCustomApp",[t],r||Zt())}function Ma(t,r,s){S(l),K(t,r,s)}function La(t,r){if(S(l),!B.childWindow)throw new Error("The child window has not yet been initialized or is not present");Ut(t,r)}function Ro(t,r){var s=this;S(l),De(t,function(){for(var u=arguments.length,a=new Array(u),c=0;c<u;c++)a[c]=arguments[c];return r.apply(s,a)})}function Na(t,r){S(l),De("userSettingsChange",r,!0,[t])}function Oo(t){S(l,f.content,f.task),K("openFilePreview",[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId,t.viewerAction,t.fileOpenPreference,t.conversationId,t.sizeInBytes])}(function(t){function r(){return!(!S(l)||!l.supports.logs)}t.registerGetLogHandler=function(s){if(!Xe(s)&&S(l),!Xe(s)&&!r())throw z;s?De("log.request",function(){K("log.receive",[s()])}):gt("log.request")},t.isSupported=r})(Br||(Br={})),function(t){t.fileDownloadStart="fileDownloadStart",t.fileDownloadComplete="fileDownloadComplete"}(qr||(qr={})),function(t){t.view="view",t.edit="edit",t.editNew="editNew"}(Jr||(Jr={})),function(t){t.fileOpenPreference="fileOpenPreference",t.theme="theme"}(hr||(hr={})),function(t){function r(){return!(!S(l)||!l.supports.conversations)}t.openConversation=function(s){return new Promise(function(u){if(S(l,f.content),!r())throw z;var a=rn("conversations.openConversation",{title:s.title,subEntityId:s.subEntityId,conversationId:s.conversationId,channelId:s.channelId,entityId:s.entityId});s.onStartConversation&&De("startConversation",function(c,g,v,C){var m;return null===(m=s.onStartConversation)||void 0===m?void 0:m.call(s,{subEntityId:c,conversationId:g,channelId:v,entityId:C})}),s.onCloseConversation&&De("closeConversation",function(c,g,v,C){var m;return null===(m=s.onCloseConversation)||void 0===m?void 0:m.call(s,{subEntityId:c,conversationId:g,channelId:v,entityId:C})}),u(a)})},t.closeConversation=function(){if(S(l,f.content),!r())throw z;K("conversations.closeConversation"),gt("startConversation"),gt("closeConversation")},t.getChatMembers=function(){return new Promise(function(s){if(S(l),!r())throw z;s(Wr("getChatMembers"))})},t.isSupported=r}(gr||(gr={}));var $r;function To(t,r,s){if(0===t.length)throw new Error("Must have at least one user when creating a chat deep link");var u="users="+t.map(function(g){return encodeURIComponent(g)}).join(","),a=void 0===r?"":"&topicName="+encodeURIComponent(r),c=void 0===s?"":"&message="+encodeURIComponent(s);return ie+"://"+pe+"/l/chat/0/0?"+u+a+c}!function(t){function r(){return!(!S(l)||!l.supports.appInstallDialog)}t.openAppInstallDialog=function(s){return new Promise(function(u){if(S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage),!r())throw new Error("Not supported");l.isLegacyTeams?u(rn("executeDeepLink",function(t){if(!t)throw new Error("App ID must be set when creating an app install dialog deep link");return ie+"://"+pe+"/l/app/"+encodeURIComponent(t)}(s.appId))):(K("appInstallDialog.openAppInstallDialog",[s]),u())})},t.isSupported=r}($r||($r={}));var on,Ht=we.V_1,Ua=be("media");function mr(t,r){if(null==t||null==r||t.length<=0)return null;var s=null,u=1;return t.sort(function(a,c){return a.sequence>c.sequence?1:-1}),t.forEach(function(a){a.sequence==u&&(s=s?new Blob([s,a.file],{type:r}):new Blob([a.file],{type:r}),u++)}),s}function Zr(t,r){if(null==t||null==r)return null;for(var s=atob(t.chunk),u=new Array(s.length),a=0;a<s.length;a++)u[a]=s.charCodeAt(a);var c=new Uint8Array(u),g=new Blob([c],{type:r});return{sequence:t.chunkSequence,file:g}}function Ha(t){!function(t){return!(!t||t.mediaType!=on.MediaType.VideoAndImage&&!t.videoAndImageProps)}(t)?function(t){return!(!t||t.mediaType!=on.MediaType.Video||!t.videoProps||t.videoProps.isFullScreenMode)}(t)?ur("2.0.3"):function(t){var r;return!(t?.mediaType!=on.MediaType.Image||null===(r=t?.imageProps)||void 0===r||!r.imageOutputFormats)}(t)&&ur("2.0.4"):ur("2.0.2")}function Mo(t){return!t||!(null===t.timeOutIntervalInSec||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec<=0||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec>60)}!function(t){var s,c,D;(D=t.FileFormat||(t.FileFormat={})).Base64="base64",D.ID="id";var C=function(){};function m(){return!(!S(l)||!l.supports.permissions)}t.File=C,t.captureImage=function(D){if(!D)throw new Error("[captureImage] Callback cannot be null");S(l,f.content,f.task),P.isFramelessWindow?_t("1.7.0")?_e(F(Ht,A.Media_CaptureImage),"captureImage",D):D({errorCode:M.OLD_PLATFORM},[]):D({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},[])},t.hasPermission=function(){if(S(l,f.content,f.task),!m())throw z;var D=Z.Media;return new Promise(function(j){j(dt(F(Ht,A.Media_HasPermission),"permissions.has",D))})},t.requestPermission=function(){if(S(l,f.content,f.task),!m())throw z;var D=Z.Media;return new Promise(function(j){j(dt(F(Ht,A.Media_RequestPermission),"permissions.request",D))})};var h=function(D){function j(q){var T;return T=D.call(this)||this,q&&(T.content=q.content,T.format=q.format,T.mimeType=q.mimeType,T.name=q.name,T.preview=q.preview,T.size=q.size),T}ce(j,D);var Fe=j.prototype;return Fe.getMedia=function(T){if(!T)throw new Error("[get Media] Callback cannot be null");S(l,f.content,f.task),_t(se)?function(t,r,s){return null!=t&&null!=r&&r==on.FileFormat.ID&&null!=s}(this.mimeType,this.format,this.content)?_t("2.0.0")?this.getMediaViaCallback(T):this.getMediaViaHandler(T):T({errorCode:M.INVALID_ARGUMENTS},new Blob):T({errorCode:M.OLD_PLATFORM},new Blob)},Fe.getMediaViaCallback=function(T){var J={mediaMimeType:this.mimeType,assembleAttachment:[]},re=[this.content];_e(F(Ht,A.Media_GetMedia),"getMedia",re,function(Q){if(T)if(Q&&Q.error)T(Q.error,new Blob);else if(Q&&Q.mediaChunk)if(Q.mediaChunk.chunkSequence<=0){var Te=mr(J.assembleAttachment,J.mediaMimeType);T(Q.error,Te??new Blob)}else{var Ge=Zr(Q.mediaChunk,J.mediaMimeType);Ge?J.assembleAttachment.push(Ge):Ua("Received a null assemble attachment for when decoding chunk sequence "+Q.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else T({errorCode:M.INTERNAL_ERROR,message:"data received is null"},new Blob)})},Fe.getMediaViaHandler=function(T){var J=nr(),re={mediaMimeType:this.mimeType,assembleAttachment:[]},Q=[J,this.content];this.content&&!Xe(T)&&_e(F(Ht,A.Media_GetMedia),"getMedia",Q),De("getMedia"+J,function(Te){if(T){var Ge=JSON.parse(Te);if(Ge.error)T(Ge.error,new Blob),gt("getMedia"+J);else if(Ge.mediaChunk)if(Ge.mediaChunk.chunkSequence<=0){var St=mr(re.assembleAttachment,re.mediaMimeType);T(Ge.error,St??new Blob),gt("getMedia"+J)}else{var ft=Zr(Ge.mediaChunk,re.mediaMimeType);ft&&re.assembleAttachment.push(ft)}else T({errorCode:M.INTERNAL_ERROR,message:"data received is null"},new Blob),gt("getMedia"+J)}})},j}(C);t.Media=h;var k=function(){function D(Fe){this.controllerCallback=Fe}var j=D.prototype;return j.notifyEventToHost=function(q,T){S(l,f.content,f.task);try{ur("2.0.3")}catch(re){return void(T&&T(re))}var J={mediaType:this.getMediaType(),mediaControllerEvent:q};_e(F(Ht,A.Media_Controller),"media.controller",[J],function(re){T&&T(re)})},j.stop=function(q){this.notifyEventToHost(s.StopRecording,q)},D}();t.VideoController=function(D){function j(){return D.apply(this,arguments)||this}ce(j,D);var Fe=j.prototype;return Fe.getMediaType=function(){return c.Video},Fe.notifyEventToApp=function(T){if(this.controllerCallback)switch(T){case s.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},j}(k),function(D){D[D.StartRecording=1]="StartRecording",D[D.StopRecording=2]="StopRecording"}(s=t.MediaControllerEvent||(t.MediaControllerEvent={})),function(D){D[D.Photo=1]="Photo",D[D.Document=2]="Document",D[D.Whiteboard=3]="Whiteboard",D[D.BusinessCard=4]="BusinessCard"}(t.CameraStartMode||(t.CameraStartMode={})),function(D){D[D.Camera=1]="Camera",D[D.Gallery=2]="Gallery"}(t.Source||(t.Source={})),function(D){D[D.Image=1]="Image",D[D.Video=2]="Video",D[D.VideoAndImage=3]="VideoAndImage",D[D.Audio=4]="Audio"}(c=t.MediaType||(t.MediaType={})),function(D){D[D.ID=1]="ID",D[D.URL=2]="URL"}(t.ImageUriType||(t.ImageUriType={})),function(D){D[D.IMAGE=1]="IMAGE",D[D.PDF=2]="PDF"}(t.ImageOutputFormats||(t.ImageOutputFormats={})),t.selectMedia=function(D,j){if(!j)throw new Error("[select Media] Callback cannot be null");if(S(l,f.content,f.task),_t(se)){try{Ha(D)}catch(J){return void j(J,[])}if(function(t){return!(null==t||t.maxMediaCount>10)}(D)){var T=[D];_e(F(Ht,A.Media_SelectMedia),"selectMedia",T,function(J,re,Q){var Te,Ge;if(Q)(function(t){return!(t.mediaType!=on.MediaType.Video||!t.videoProps||!t.videoProps.videoController)})(D)&&(null===(Ge=null===(Te=D?.videoProps)||void 0===Te?void 0:Te.videoController)||void 0===Ge||Ge.notifyEventToApp(Q));else if(re){for(var Tr,St=[],ft=R(re);!(Tr=ft()).done;)St.push(new h(Tr.value));j(J,St)}else j(J,[])})}else j({errorCode:M.INVALID_ARGUMENTS},[])}else j({errorCode:M.OLD_PLATFORM},[])},t.viewImages=function(D,j){if(!j)throw new Error("[view images] Callback cannot be null");if(S(l,f.content,f.task),_t(se))if(function(t){return!(null==t||t.length<=0||t.length>10)}(D)){var Fe=[D];_e(F(Ht,A.Media_ViewImages),"viewImages",Fe,j)}else j({errorCode:M.INVALID_ARGUMENTS});else j({errorCode:M.OLD_PLATFORM})},t.scanBarCode=function(D,j){if(!D)throw new Error("[media.scanBarCode] Callback cannot be null");S(l,f.content,f.task),P.hostClientType!==Y.desktop&&P.hostClientType!==Y.web&&P.hostClientType!==Y.rigel&&P.hostClientType!==Y.teamsRoomsWindows&&P.hostClientType!==Y.teamsRoomsAndroid&&P.hostClientType!==Y.teamsPhones&&P.hostClientType!==Y.teamsDisplays?_t("1.9.0")?Mo(j)?_e(F(Ht,A.Media_ScanBarCode),"media.scanBarCode",[j],D):D({errorCode:M.INVALID_ARGUMENTS},""):D({errorCode:M.OLD_PLATFORM},""):D({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},"")}}(on||(on={}));var Cr,Kr,Xr=we.V_2;(function(t){function r(){return!!(S(l)&&l.supports.barCode&&l.supports.permissions)}t.scanBarCode=function(s){return new Promise(function(u){if(S(l,f.content,f.task),!r())throw z;if(!Mo(s))throw{errorCode:M.INVALID_ARGUMENTS};u(dt(F(Xr,A.BarCode_ScanBarCode),"media.scanBarCode",s))})},t.hasPermission=function(){if(S(l,f.content,f.task),!r())throw z;var s=Z.Media;return new Promise(function(u){u(dt(F(Xr,A.BarCode_HasPermission),"permissions.has",s))})},t.requestPermission=function(){if(S(l,f.content,f.task),!r())throw z;var s=Z.Media;return new Promise(function(u){u(dt(F(Xr,A.BarCode_RequestPermission),"permissions.request",s))})},t.isSupported=r})(Cr||(Cr={})),function(t){function r(u){return new Promise(function(a){if(S(l,f.content,f.task),!s())throw z;a(l.isLegacyTeams?rn("executeDeepLink",To([u.user],void 0,u.message)):rn("chat.openChat",{members:[u.user],message:u.message}))})}function s(){return!(!S(l)||!l.supports.chat)}t.openChat=r,t.openGroupChat=function(u){return new Promise(function(a){if(u.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===u.users.length)a(r({user:u.users[0],message:u.message}));else{if(S(l,f.content,f.task),!s())throw z;a(l.isLegacyTeams?rn("executeDeepLink",To(u.users,u.topic,u.message)):rn("chat.openChat",{members:u.users,message:u.message,topic:u.topic}))}})},t.isSupported=s}(Kr||(Kr={}));var wr,Lo=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},No=we.V_2;!function(t){function r(){return!!(S(l)&&navigator&&navigator.clipboard&&l.supports.clipboard)}t.write=function(s){return Lo(this,void 0,void 0,X().mark(function u(){var c;return X().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(S(l,f.content,f.meetingStage,f.task,f.settings,f.stage,f.sidePanel),r()){v.next=2;break}throw z;case 2:if(s.type&&Object.values(ee).includes(s.type)){v.next=4;break}throw new Error("Blob type "+s.type+" is not supported. Supported blob types are "+Object.values(ee));case 4:return v.next=6,Nn(s);case 6:return c={mimeType:s.type,content:v.sent},v.abrupt("return",dt(F(No,A.Clipboard_Write),"clipboard.writeToClipboard",c));case 9:case"end":return v.stop()}},u)}))},t.read=function(){return Lo(this,void 0,void 0,X().mark(function s(){var u;return X().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(S(l,f.content,f.meetingStage,f.task,f.settings,f.stage,f.sidePanel),r()){c.next=2;break}throw z;case 2:if(!Ki()&&P.hostClientType!==Y.macos){c.next=9;break}return c.t0=JSON,c.next=6,at("clipboard.readFromClipboard");case 6:return c.t1=c.sent,u=c.t0.parse.call(c.t0,c.t1),c.abrupt("return",fn(u.mimeType,u.content));case 9:return c.abrupt("return",dt(F(No,A.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return c.stop()}},s)}))},t.isSupported=r}(wr||(wr={}));var ei,ti,Sn=we.V_2;function qa(){return l.hostVersionsInfo?l.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(t){function r(){return!!(S(l)&&l.supports.geoLocation&&l.supports.permissions)}t.getCurrentLocation=function(){if(S(l,f.content,f.task),!r())throw z;return dt(F(Sn,A.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},t.hasPermission=function(){if(S(l,f.content,f.task),!r())throw z;var u=Z.GeoLocation;return new Promise(function(a){a(dt(F(Sn,A.GeoLocation_HasPermission),"permissions.has",u))})},t.requestPermission=function(){if(S(l,f.content,f.task),!r())throw z;var u=Z.GeoLocation;return new Promise(function(a){a(dt(F(Sn,A.GeoLocation_RequestPermission),"permissions.request",u))})},t.isSupported=r,function(u){function a(){return!!(S(l)&&l.supports.geoLocation&&l.supports.geoLocation.map&&l.supports.permissions)}u.chooseLocation=function(){if(S(l,f.content,f.task),!a())throw z;return dt(F(Sn,A.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},u.showLocation=function(c){if(S(l,f.content,f.task),!a())throw z;if(!c)throw{errorCode:M.INVALID_ARGUMENTS};return dt(F(Sn,A.GeoLocation_ShowLocation),"location.showLocation",c)},u.isSupported=a}(t.map||(t.map={}))}(ei||(ei={}));var _o=function(){function t(){}var r=t.prototype;return r.postMessage=function(u,a){S(l),K("messageForChild",[u],a||Zt())},r.addEventListener=function(u,a){S(l),"message"===u&&De("messageForParent",a)},t}(),Ja=function(){function t(){}var r=t.prototype;return r.postMessage=function(u,a){S(l,f.task),K("messageForParent",[u],a||Zt())},r.addEventListener=function(u,a){S(l,f.task),"message"===u&&De("messageForChild",a)},Se(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();!function(t){function r(){return!(!S(l)||!l.supports.secondaryBrowser)}t.open=function(s){if(S(l,f.content),!r())throw z;if(!s||!Cn(s))throw{errorCode:M.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return at("secondaryBrowser.open",s.toString())},t.isSupported=r}(ti||(ti={}));var In,xo=we.V_1;!function(t){function r(){return!(!S(l)||!l.supports.location)}t.getLocation=function(s,u){if(!u)throw new Error("[location.getLocation] Callback cannot be null");if(S(l,f.content,f.task),!_t("1.9.0"))throw{errorCode:M.OLD_PLATFORM};if(!s)throw{errorCode:M.INVALID_ARGUMENTS};if(!r())throw z;_e(F(xo,A.Location_GetLocation),"location.getLocation",[s],u)},t.showLocation=function(s,u){if(!u)throw new Error("[location.showLocation] Callback cannot be null");if(S(l,f.content,f.task),!_t("1.9.0"))throw{errorCode:M.OLD_PLATFORM};if(!s)throw{errorCode:M.INVALID_ARGUMENTS};if(!r())throw z;_e(F(xo,A.Location_ShowLocation),"location.showLocation",[s],u)},t.isSupported=r}(In||(In={}));var ni,Gn,ri=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var r,c,h;function m(h,k){S(l,f.sidePanel,f.meetingStage),K("meeting.updateMicState",[h,k])}(h=r||(r={}))[h.HostInitiated=0]="HostInitiated",h[h.AppInitiated=1]="AppInitiated",h[h.AppDeclinedToChange=2]="AppDeclinedToChange",h[h.AppFailedToChange=3]="AppFailedToChange",function(h){h.like="like",h.heart="heart",h.laugh="laugh",h.surprised="surprised",h.applause="applause"}(t.MeetingReactionType||(t.MeetingReactionType={})),function(h){h.Unknown="Unknown",h.Adhoc="Adhoc",h.Scheduled="Scheduled",h.Recurring="Recurring",h.Broadcast="Broadcast",h.MeetNow="MeetNow"}(t.MeetingType||(t.MeetingType={})),function(h){h.OneOnOneCall="oneOnOneCall",h.GroupCall="groupCall"}(t.CallType||(t.CallType={})),function(h){h.Collaborative="Collaborative",h.ScreenShare="ScreenShare"}(c=t.SharingProtocol||(t.SharingProtocol={})),t.getIncomingClientAudioState=function(h){if(!h)throw new Error("[get incoming client audio state] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("getIncomingClientAudioState",h)},t.toggleIncomingClientAudio=function(h){if(!h)throw new Error("[toggle incoming client audio] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("toggleIncomingClientAudio",h)},t.getMeetingDetails=function(h){if(!h)throw new Error("[get meeting details] Callback cannot be null");S(l,f.sidePanel,f.meetingStage,f.settings,f.content),K("meeting.getMeetingDetails",h)},t.getAuthenticationTokenForAnonymousUser=function(h){if(!h)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");S(l,f.sidePanel,f.meetingStage,f.task),K("meeting.getAuthenticationTokenForAnonymousUser",h)},t.getLiveStreamState=function(h){if(!h)throw new Error("[get live stream state] Callback cannot be null");S(l,f.sidePanel),K("meeting.getLiveStreamState",h)},t.requestStartLiveStreaming=function(h,k,D){if(!h)throw new Error("[request start live streaming] Callback cannot be null");S(l,f.sidePanel),K("meeting.requestStartLiveStreaming",[k,D],h)},t.requestStopLiveStreaming=function(h){if(!h)throw new Error("[request stop live streaming] Callback cannot be null");S(l,f.sidePanel),K("meeting.requestStopLiveStreaming",h)},t.registerLiveStreamChangedHandler=function(h){if(!h)throw new Error("[register live stream changed handler] Handler cannot be null");S(l,f.sidePanel),De("meeting.liveStreamChanged",h)},t.shareAppContentToStage=function(h,k,D){if(void 0===D&&(D={sharingProtocol:c.Collaborative}),!h)throw new Error("[share app content to stage] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("meeting.shareAppContentToStage",[k,D],h)},t.getAppContentStageSharingCapabilities=function(h){if(!h)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("meeting.getAppContentStageSharingCapabilities",h)},t.stopSharingAppContentToStage=function(h){if(!h)throw new Error("[stop sharing app content to stage] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("meeting.stopSharingAppContentToStage",h)},t.getAppContentStageSharingState=function(h){if(!h)throw new Error("[get app content stage sharing state] Callback cannot be null");S(l,f.sidePanel,f.meetingStage),K("meeting.getAppContentStageSharingState",h)},t.registerSpeakingStateChangeHandler=function(h){if(!h)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");S(l,f.sidePanel,f.meetingStage),De("meeting.speakingStateChanged",h)},t.registerRaiseHandStateChangedHandler=function(h){if(!h)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");S(l,f.sidePanel,f.meetingStage),De("meeting.raiseHandStateChanged",h)},t.registerMeetingReactionReceivedHandler=function(h){if(!h)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");S(l,f.sidePanel,f.meetingStage),De("meeting.meetingReactionReceived",h)},function(h){h.setOptions=function(k){S(l,f.sidePanel),k.contentUrl&&new URL(k.contentUrl),K("meeting.appShareButton.setOptions",[k])}}(t.appShareButton||(t.appShareButton={})),t.requestAppAudioHandling=function(h,k){if(!k)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!h.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");S(l,f.sidePanel,f.meetingStage),h.isAppHandlingAudio?function(h,k){var D=this;K("meeting.requestAppAudioHandling",[h.isAppHandlingAudio],function(j,Fe){if(j&&null!=Fe)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(j)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+j.errorCode+" "+j.message);if("boolean"!=typeof Fe)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");De("meeting.micStateChanged",function(q){return ri(D,void 0,void 0,X().mark(function T(){var J;return X().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.prev=0,Q.next=3,h.micMuteStateChangedCallback(q);case 3:m(J=Q.sent,J.isMicMuted===q.isMicMuted?r.HostInitiated:r.AppDeclinedToChange),Q.next=10;break;case 7:Q.prev=7,Q.t0=Q.catch(0),m(q,r.AppFailedToChange);case 10:case"end":return Q.stop()}},T,null,[[0,7]])}))}),De("meeting.audioDeviceSelectionChanged",function(q){var T;null===(T=h.audioDeviceSelectionChangedCallback)||void 0===T||T.call(h,q)}),k(Fe)})}(h,k):function(h,k){K("meeting.requestAppAudioHandling",[h.isAppHandlingAudio],function(D,j){if(D&&null!=j)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(D)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+D.errorCode+" "+D.message);if("boolean"!=typeof j)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Co("meeting.micStateChanged")&&gt("meeting.micStateChanged"),Co("meeting.audioDeviceSelectionChanged")&&gt("meeting.audioDeviceSelectionChanged"),k(j)})}(h,k)},t.updateMicState=function(h){m(h,r.AppInitiated)}})(ni||(ni={})),function(t){function r(){return!(!S(l)||!l.supports.monetization)}t.openPurchaseExperience=function(s,u){var a,c;return"function"==typeof s?(a=s,c=u):c=s,S(l,f.content),function(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(g){r&&r(null,g)}).catch(function(g){r&&r(g,null)}),c}(function(){return new Promise(function(g){if(!r())throw z;g(at("monetization.openPurchaseExperience",c))})},a)},t.isSupported=r}(Gn||(Gn={}));var oi,ii=we.V_2;!function(t){function r(){return!(!S(l)||!l.supports.calendar)}t.openCalendarItem=function(s){return new Promise(function(u){if(S(l,f.content),!r())throw new Error("Not supported");if(!s.itemId||!s.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");u(nn(F(ii,A.Calendar_OpenCalendarItem),"calendar.openCalendarItem",s))})},t.composeMeeting=function(s){return new Promise(function(u){if(S(l,f.content),!r())throw new Error("Not supported");u(l.isLegacyTeams?rn("executeDeepLink",function(t,r,s,u,a){var c=void 0===t?"":"attendees="+t.map(function(h){return encodeURIComponent(h)}).join(","),g=void 0===r?"":"&startTime="+encodeURIComponent(r),v=void 0===s?"":"&endTime="+encodeURIComponent(s),C=void 0===u?"":"&subject="+encodeURIComponent(u),m=void 0===a?"":"&content="+encodeURIComponent(a);return ie+"://"+pe+"/l/meeting/new?"+c+g+v+C+m}(s.attendees,s.startTime,s.endTime,s.subject,s.content)):nn(F(ii,A.Calendar_ComposeMeeting),"calendar.composeMeeting",s))})},t.isSupported=r}(oi||(oi={}));var ai,gn,si,ui,Vo=we.V_2;(function(t){function r(){return!(!S(l)||!l.supports.mail)}var u;t.openMailItem=function(u){return new Promise(function(a){if(S(l,f.content),!r())throw new Error("Not supported");if(!u.itemId||!u.itemId.trim())throw new Error("Must supply an itemId to openMailItem");a(nn(F(Vo,A.Mail_OpenMailItem),"mail.openMailItem",u))})},t.composeMail=function(u){return new Promise(function(a){if(S(l,f.content),!r())throw new Error("Not supported");a(nn(F(Vo,A.Mail_ComposeMail),"mail.composeMail",u))})},t.isSupported=r,(u=t.ComposeMailType||(t.ComposeMailType={})).New="new",u.Reply="reply",u.ReplyAll="replyAll",u.Forward="forward"})(ai||(ai={})),function(t){function r(){it().print()}function s(c,g){!Xe(c)&&S(l),!Xe(c)&&g&&g(),function(t){Ze.loadHandler=t,!Xe(t)&&_e(F(we.V_2,A.RegisterHandler),"registerHandler",["load"])}(c)}function u(c,g){!Xe(c)&&S(l),!Xe(c)&&g&&g(),function(t){Ze.beforeUnloadHandler=t,!Xe(t)&&_e(F(we.V_2,A.RegisterHandler),"registerHandler",["beforeUnload"])}(c)}function a(){return!(!S(l)||!l.supports.teamsCore)}t.enablePrintCapability=function(){if(!P.printCapabilityEnabled){if(S(l),!a())throw z;P.printCapabilityEnabled=!0,document.addEventListener("keydown",function(c){(c.ctrlKey||c.metaKey)&&80===c.keyCode&&(r(),c.cancelBubble=!0,c.preventDefault(),c.stopImmediatePropagation())})}},t.print=r,t.registerOnLoadHandler=function(c){s(c,function(){if(!Xe(c)&&!a())throw z})},t.registerOnLoadHandlerHelper=s,t.registerBeforeUnloadHandler=function(c){u(c,function(){if(!Xe(c)&&!a())throw z})},t.registerBeforeUnloadHandlerHelper=u,t.isSupported=a}(gn||(gn={})),function(t){function r(u){return new Promise(function(a){if(!_t("2.0.0"))throw{errorCode:M.OLD_PLATFORM};if(!function(t){return!(t&&(t.title&&"string"!=typeof t.title||t.setSelected&&"object"!=typeof t.setSelected||t.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof t.openOrgWideSearchInChatOrChannel||t.singleSelect&&"boolean"!=typeof t.singleSelect))}(u))throw{errorCode:M.INVALID_ARGUMENTS};if(!s())throw z;a(at("people.selectPeople",u))})}function s(){return!(!S(l)||!l.supports.people)}t.selectPeople=function(u,a){var c,g,v;return S(l,f.content,f.task,f.settings),"function"==typeof u?(g=(c=[u,a])[0],v=c[1]):v=u,function(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(g){r&&r(void 0,g)}).catch(function(g){r&&r(g)}),c}(r,g,v)},t.isSupported=s}(si||(si={})),function(t){t.showProfile=function(r){return S(l,f.content),new Promise(function(s){var u=function(t){return t?t.modality&&"string"!=typeof t.modality?[!1,"modality must be a string"]:t.targetElementBoundingRect&&"object"==typeof t.targetElementBoundingRect?t.triggerType&&"string"==typeof t.triggerType?function(t){return t?t.displayName&&"string"!=typeof t.displayName?[!1,"displayName must be a string"]:t.identifiers&&"object"==typeof t.identifiers?t.identifiers.AadObjectId||t.identifiers.Smtp||t.identifiers.Upn?t.identifiers.AadObjectId&&"string"!=typeof t.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:t.identifiers.Smtp&&"string"!=typeof t.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:t.identifiers.Upn&&"string"!=typeof t.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(t.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(r);if(!u[0])throw{errorCode:M.INVALID_ARGUMENTS,message:u[1]};s(at("profile.showProfile",{modality:r.modality,persona:r.persona,triggerType:r.triggerType,targetRectangle:{x:r.targetElementBoundingRect.x,y:r.targetElementBoundingRect.y,width:r.targetElementBoundingRect.width,height:r.targetElementBoundingRect.height}}))})},t.isSupported=function(){return!(!S(l)||!l.supports.profile)}}(ui||(ui={}));var mn,an=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};function Ho(t,r,s,u){var a,c;return an(this,void 0,void 0,X().mark(function g(){var v;return X().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return v=Wo(),!ht()&&(null===(c=null===(a=window.chrome)||void 0===a?void 0:a.webview)||void 0===c||c.registerTextureStream(t,v)),m.t0=yr,m.next=5,Go(t,s,u);case 5:m.t1=m.sent,m.t2=new ci(s,r),m.t3=v.writable,(0,m.t0)(m.t1,m.t2,m.t3);case 9:case"end":return m.stop()}},g)}))}function Io(t,r,s,u){var a,c;return an(this,void 0,void 0,X().mark(function g(){var v;return X().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return v=Wo(),!ht()&&(null===(c=null===(a=window.chrome)||void 0===a?void 0:a.webview)||void 0===c||c.registerTextureStream(t,v)),m.t0=yr,m.next=5,Go(t,s,u);case 5:m.t1=m.sent,m.t2=new Xa(s,r),m.t3=v.writable,(0,m.t0)(m.t1,m.t2,m.t3);case 9:case"end":return m.stop()}},g)}))}function Go(t,r,s){return an(this,void 0,void 0,X().mark(function u(){var a,c;return X().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!ht()){v.next=2;break}throw z;case 2:return a=it().chrome,v.prev=3,s?.reportGettingTextureStream(t),v.next=7,a.webview.getTextureStream(t);case 7:if(0!==(c=v.sent.getVideoTracks()).length){v.next=10;break}throw new Error("No video track in stream "+t);case 10:return v.abrupt("return",(s?.reportTextureStreamAcquired(),c[0]));case 13:throw v.prev=13,v.t0=v.catch(3),r("Failed to get video track from stream "+t+", error: "+v.t0),new Error("Internal error: can't get video track from stream "+t);case 16:case"end":return v.stop()}},u,null,[[3,13]])}))}function Wo(){if(ht())throw z;var t=window.MediaStreamTrackGenerator;if(!t)throw z;return new t({kind:"video"})}function yr(t,r,s){new(it().MediaStreamTrackProcessor)({track:t}).readable.pipeThrough(new TransformStream(r)).pipeTo(s)}!function(t){t.TimestampIsNull="timestamp of the original video frame is null",t.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(mn||(mn={}));var ci=function(r,s){var u=this;this.notifyError=r,this.videoFrameHandler=s,this.transform=function(a,c){return an(u,void 0,void 0,X().mark(function g(){var v,C,m;return X().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(null===(v=a.timestamp)){k.next=15;break}return k.prev=2,k.next=5,this.videoFrameHandler({videoFrame:a});case 5:C=k.sent,m=new VideoFrame(C,{timestamp:v}),c.enqueue(m),a.close(),C.close(),k.next=13;break;case 10:k.prev=10,k.t0=k.catch(2),a.close(),this.notifyError(k.t0);case 13:k.next=16;break;case 15:this.notifyError(mn.TimestampIsNull);case 16:case"end":return k.stop()}},g,this,[[2,10]])}))}},$a=function(){function t(r,s){if(this.headerBuffer=r,this.notifyError=s,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(r),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return Se(t,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),t}(),Za=function(){function t(r,s){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var u=new Uint32Array(r),a=0,c=0;a<s;a++){var g=u[c++],v=u[c++],C=u[c++],m=new Uint8Array(r,v,C);this.metadataMap.set(g,m)}}return Se(t,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),t}(),Xa=function(r,s){var u=this;this.notifyError=r,this.videoFrameHandler=s,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(a,c){return an(u,void 0,void 0,X().mark(function g(){var v,C,m,h,D,j,Fe;return X().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(null===(v=a.timestamp)){T.next=22;break}return T.prev=2,T.next=5,this.extractVideoFrameAndMetadata(a);case 5:return m=(C=T.sent).videoFrame,D=(void 0===(h=C.metadata)?{}:h).audioInferenceResult,T.next=12,this.videoFrameHandler({videoFrame:m,audioInferenceResult:D});case 12:j=T.sent,Fe=new VideoFrame(j,{timestamp:v}),c.enqueue(Fe),m.close(),a.close(),j.close(),T.next=20;break;case 17:T.prev=17,T.t0=T.catch(2),a.close(),this.notifyError(T.t0);case 20:T.next=23;break;case 22:this.notifyError(mn.TimestampIsNull);case 23:case"end":return T.stop()}},g,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(a){return an(u,void 0,void 0,X().mark(function c(){var g,v,C,m,h,k;return X().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!ht()){j.next=2;break}throw z;case 2:if("NV12"===a.format){j.next=4;break}throw this.notifyError(mn.UnsupportedVideoFramePixelFormat),new Error(mn.UnsupportedVideoFramePixelFormat);case 4:return g={x:0,y:0,width:a.codedWidth,height:2},v=new ArrayBuffer(g.width*g.height*3/2),j.next=7,a.copyTo(v,{rect:g});case 7:return C=new $a(v,this.notifyError),m={x:0,y:C.multiStreamHeaderRowOffset,width:a.codedWidth,height:a.codedHeight-C.multiStreamHeaderRowOffset},h=new ArrayBuffer(m.width*m.height*3/2),j.next=10,a.copyTo(h,{rect:m});case 10:return k=new Za(h,C.multiStreamCount),j.abrupt("return",{videoFrame:new VideoFrame(a,{timestamp:a.timestamp,visibleRect:{x:0,y:C.frameRowOffset,width:C.frameWidth,height:C.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:k.audioInferenceResult}});case 12:case"end":return j.stop()}},c,this)}))},De("video.mediaStream.audioInferenceDiscardStatusChange",function(a){u.shouldDiscardAudioInferenceResult=a.discardAudioInferenceResult})};function Yt(t,r){return function(s,u){r?.reportApplyingVideoEffect(s||"",u),t(s,u).then(function(){r?.reportVideoEffectChanged(s||"",u),K("video.videoEffectReadiness",[!0,s,void 0,u])}).catch(function(a){K("video.videoEffectReadiness",[!1,s,a in sn.EffectFailureReason?a:sn.EffectFailureReason.InitializationFailure,u])})}}var $t=function(){function t(){}return t.setTimeout=function(s,u){var a=performance.now(),c=nr();return t.setTimeoutCallbacks[c]={callback:s,timeoutInMs:u,startedAtInMs:a},c},t.clearTimeout=function(s){delete t.setTimeoutCallbacks[s]},t.setInterval=function(s,u){t.setTimeout(function a(){s(),t.setTimeout(a,u)},u)},t.tick=function(){var s=performance.now(),u=[];for(var a in t.setTimeoutCallbacks){var c=t.setTimeoutCallbacks[a];s-c.startedAtInMs>=c.timeoutInMs&&u.push(a)}for(var g=0,v=u;g<v.length;g++){var C=v[g];t.setTimeoutCallbacks[C].callback(),delete t.setTimeoutCallbacks[C]}},t}();$t.setTimeoutCallbacks={};var Sr=function(){function t(s,u){this.reportStatisticsResult=u,this.sampleCount=0,this.distributionBins=new Uint32Array(s)}var r=t.prototype;return r.processStarts=function(u,a,c,g){$t.tick(),this.suitableForThisSession(u,a,c,g)||this.reportAndResetSession(this.getStatistics(),u,g,a,c),this.start()},r.processEnds=function(){var u=performance.now()-this.frameProcessingStartedAt,a=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,u)));this.distributionBins[a]+=1,this.sampleCount+=1},r.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},r.start=function(){this.frameProcessingStartedAt=performance.now()},r.suitableForThisSession=function(u,a,c,g){return this.currentSession&&this.currentSession.effectId===u&&this.currentSession.effectParam===g&&this.currentSession.frameWidth===a&&this.currentSession.frameHeight===c},r.reportAndResetSession=function(u,a,c,g,v){var C=this;u&&this.reportStatisticsResult(u),this.resetCurrentSession(this.getNextTimeout(a,this.currentSession),a,c,g,v),this.timeoutId&&$t.clearTimeout(this.timeoutId),this.timeoutId=$t.setTimeout(function(){return C.reportAndResetSession(C.getStatistics(),a,c,g,v)}.bind(this),this.currentSession.timeoutInMs)},r.resetCurrentSession=function(u,a,c,g,v){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:u,effectId:a,effectParam:c,frameWidth:g,frameHeight:v},this.sampleCount=0,this.distributionBins.fill(0)},r.getNextTimeout=function(u,a){return a&&a.effectId===u?Math.min(t.maxSessionTimeoutInMs,2*a.timeoutInMs):t.initialSessionTimeoutInMs},t}();Sr.initialSessionTimeoutInMs=1e3,Sr.maxSessionTimeoutInMs=3e4;var br=function(){function t(s){var u=this;this.reportPerformanceEvent=s,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Sr(t.distributionBinSize,function(a){return u.reportPerformanceEvent("video.performance.performanceDataGenerated",[a])})}var r=t.prototype;return r.startMonitorSlowFrameProcessing=function(){var u=this;$t.setInterval(function(){if(0!==u.processedFrameCount){var a=u.frameProcessingTimeCost/u.processedFrameCount;a>u.frameProcessTimeLimit&&u.reportPerformanceEvent("video.performance.frameProcessingSlow",[a]),u.frameProcessingTimeCost=0,u.processedFrameCount=0}},t.calculateFPSInterval)},r.setFrameProcessTimeLimit=function(u){this.frameProcessTimeLimit=u},r.reportApplyingVideoEffect=function(u,a){var c,g;(null===(c=this.applyingEffect)||void 0===c?void 0:c.effectId)===u&&(null===(g=this.applyingEffect)||void 0===g?void 0:g.effectParam)===a||(this.applyingEffect={effectId:u,effectParam:a},this.appliedEffect=void 0)},r.reportVideoEffectChanged=function(u,a){void 0===this.applyingEffect||this.applyingEffect.effectId!==u&&this.applyingEffect.effectParam!==a||(this.appliedEffect={effectId:u,effectParam:a},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},r.reportStartFrameProcessing=function(u,a){$t.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,u,a,this.appliedEffect.effectParam))},r.reportFrameProcessed=function(){var u;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(u=this.appliedEffect)||void 0===u?void 0:u.effectParam])))},r.reportGettingTextureStream=function(u){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=u},r.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var u=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,u])}},t}();br.distributionBinSize=1e3,br.calculateFPSInterval=1e3;var sn,li,di,bn,fi=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var q,r=ht()?void 0:new br(K);function g(q){K("video.notifyError",[q])}function v(){return S(l)&&!!l.supports.video&&(!!l.supports.video.mediaStream||!!l.supports.video.sharedFrame)}function m(q,T){var J=this;return function(re){return fi(J,void 0,void 0,X().mark(function Q(){var Te,Ge;return X().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return Te=re.videoFrame,T?.reportStartFrameProcessing(Te.codedWidth,Te.codedHeight),ft.next=4,q(re);case 4:return Ge=ft.sent,ft.abrupt("return",(T?.reportFrameProcessed(),Ge));case 6:case"end":return ft.stop()}},Q)}))}}function h(q,T){if(S(l,f.sidePanel),!v()||!Fe())throw z;De("video.newVideoFrame",function(J){if(J){var re=J.timestamp;r?.reportStartFrameProcessing(J.width,J.height),q(function(q){if("videoFrameBuffer"in q)return q;var T=q.data,J=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(q,["data"]);return Object.assign(Object.assign({},J),{videoFrameBuffer:T})}(J),function(){r?.reportFrameProcessed(),function(q){K("video.videoFrameProcessed",[q])}(re)},g)}},!1),K("video.registerForVideoFrame",[T])}function D(){var q;return S(l,f.sidePanel)&&function(){var q,T,J,re;return!(null===(T=null===(q=it().chrome)||void 0===q?void 0:q.webview)||void 0===T||!T.getTextureStream||null===(re=null===(J=it().chrome)||void 0===J?void 0:J.webview)||void 0===re||!re.registerTextureStream)}()&&!(null===(q=l.supports.video)||void 0===q||!q.mediaStream)}function Fe(){var q;return S(l,f.sidePanel)&&!(null===(q=l.supports.video)||void 0===q||!q.sharedFrame)}(t.VideoFrameFormat||(t.VideoFrameFormat={})).NV12="NV12",(q=t.EffectChangeType||(t.EffectChangeType={})).EffectChanged="EffectChanged",q.EffectDisabled="EffectDisabled",function(q){q.InvalidEffectId="InvalidEffectId",q.InitializationFailure="InitializationFailure"}(t.EffectFailureReason||(t.EffectFailureReason={})),t.registerForVideoFrame=function(q){if(S(l,f.sidePanel),!v())throw z;if(!q.videoFrameHandler||!q.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(De("video.setFrameProcessTimeLimit",function(T){return r?.setFrameProcessTimeLimit(T.timeLimit)},!1),D())!function(q,T){var J=this;if(S(l,f.sidePanel),!v()||!D())throw z;De("video.startVideoExtensibilityVideoStream",function(re){return fi(J,void 0,void 0,X().mark(function Q(){var Te,Ge;return X().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return Te=re.streamId,Ge=m(q,r),ft.next=3,Ho(Te,Ge,g,r);case 3:case"end":return ft.stop()}},Q)}))},!1),K("video.mediaStream.registerForVideoFrame",[T])}(q.videoFrameHandler,q.config);else{if(!Fe())throw z;h(q.videoBufferHandler,q.config)}r?.startMonitorSlowFrameProcessing()},t.notifySelectedVideoEffectChanged=function(q,T){if(S(l,f.sidePanel),!v())throw z;K("video.videoEffectChanged",[q,T])},t.registerForVideoEffect=function(q){if(S(l,f.sidePanel),!v())throw z;De("video.effectParameterChange",Yt(q,r),!1),K("video.registerForVideoEffect")},t.isSupported=v})(sn||(sn={})),function(t){var r="search.queryChange",s="search.queryClose",u="search.queryExecute";function a(){return!(!S(l)||!l.supports.search)}t.registerHandlers=function(c,g,v){if(S(l,f.content),!a())throw z;De(s,c),De(u,g),v&&De(r,v)},t.unregisterHandlers=function(){if(S(l,f.content),!a())throw z;K("search.unregister"),gt(r),gt(s),gt(u)},t.isSupported=a,t.closeSearch=function(){return new Promise(function(c){if(S(l,f.content),!a())throw new Error("Not supported");c(rn("search.closeSearch"))})}}(li||(li={})),function(t){function r(g){return new Promise(function(v){if(!c())throw z;v(at(t.SharingAPIMessages.shareWebContent,g))})}function c(){return!(!S(l)||!l.supports.sharing)}t.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},t.shareWebContent=function(g,v){try{(function(g){if(!(g&&g.content&&g.content.length))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content is missing"}})(g),function(g){if(g.content.some(function(C){return!C.type}))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(g.content.some(function(C){return C.type!==g.content[0].type}))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(g),function(g){if("URL"!==g.content[0].type)throw{errorCode:M.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(g.content.some(function(C){return!C.url}))throw{errorCode:M.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(g)}catch(C){return vn(function(){return Promise.reject(C)},v)}return S(l,f.content,f.sidePanel,f.task,f.stage,f.meetingStage),vn(r,v,g)},t.isSupported=c}(di||(di={})),function(t){var u;function s(){return!(!S(l)||!l.supports.stageView)}(u=t.StageViewOpenMode||(t.StageViewOpenMode={})).modal="modal",u.popout="popout",u.popoutWithChat="popoutWithChat",t.open=function(u){return new Promise(function(a){if(S(l,f.content),!s())throw z;if(!u)throw new Error("[stageView.open] Stage view params cannot be null");a(at("stageView.open",u))})},t.isSupported=s}(bn||(bn={}));var Er,Pr,hi=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var u,a;(a=t.CameraRestriction||(t.CameraRestriction={}))[a.FrontOrRear=1]="FrontOrRear",a[a.FrontOnly=2]="FrontOnly",a[a.RearOnly=3]="RearOnly",function(a){a[a.Camera=1]="Camera",a[a.Gallery=2]="Gallery"}(t.Source||(t.Source={})),t.hasPermission=function(){if(S(l,f.content,f.task),!u.isSupported())throw z;return at("permissions.has",Z.Media)},t.requestPermission=function(){if(S(l,f.content,f.task),!u.isSupported())throw z;return at("permissions.request",Z.Media)},function(a){function c(){return!!(S(l)&&l.supports.visualMedia&&l.supports.visualMedia.image&&l.supports.permissions)}function g(){if(!c())throw z}function v(m){if(!m||m.maxVisualMediaCount>10||m.maxVisualMediaCount<1)throw ra}function C(m,h){if(h.length>m)throw zt}a.captureImages=function(m){return hi(this,void 0,void 0,X().mark(function h(){var k;return X().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return S(l,f.content,f.task),g(),v(m),j.next=3,at("visualMedia.image.captureImages",m);case 3:return j.abrupt("return",(C(m.maxVisualMediaCount,k=j.sent),k));case 5:case"end":return j.stop()}},h)}))},a.retrieveImages=function(m){return hi(this,void 0,void 0,X().mark(function h(){var k;return X().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return S(l,f.content,f.task),g(),v(m),j.next=3,at("visualMedia.image.retrieveImages",m);case 3:return j.abrupt("return",(C(m.maxVisualMediaCount,k=j.sent),k));case 5:case"end":return j.stop()}},h)}))},a.isSupported=c}(u=t.image||(t.image={}))})(Er||(Er={})),function(t){function r(){return!(!S(l)||!l.supports.webStorage)}t.isWebStorageClearedOnUserLogOut=function(){return S(l),r()},t.isSupported=r}(Pr||(Pr={}));var Ar,un,gi=we.V_2;(function(t){var r,u;function s(){return!(!S(l)||!l.supports.call)}(u=r=t.CallModalities||(t.CallModalities={})).Unknown="unknown",u.Audio="audio",u.Video="video",u.VideoBasedScreenSharing="videoBasedScreenSharing",u.Data="data",t.startCall=function(u){var a=F(gi,A.Call_StartCall);return new Promise(function(c){var g;if(S(l,f.content,f.task),!s())throw z;if(!l.isLegacyTeams)return _e(a,"call.startCall",[u],c);c(Un(a,"executeDeepLink",function(t,r,s){if(0===t.length)throw new Error("Must have at least one target when creating a call deep link");var u="users="+t.map(function(g){return encodeURIComponent(g)}).join(","),a=void 0===r?"":"&withVideo="+encodeURIComponent(r),c=void 0===s?"":"&source="+encodeURIComponent(s);return ie+"://"+pe+"/l/call/0/0?"+u+a+c}(u.targets,null===(g=u.requestedModalities)||void 0===g?void 0:g.includes(r.Video),u.source)).then(function(v){if(!v)throw new Error("The call was not properly started");return v}))})},t.isSupported=s})(Ar||(Ar={})),function(t){t.Messages=xt.Messages,t.FailedReason=xt.FailedReason,t.ExpectedFailureReason=xt.ExpectedFailureReason,t.notifyAppLoaded=function(){xt.notifyAppLoaded()},t.notifySuccess=function(){xt.notifySuccess()},t.notifyFailure=function(r){xt.notifyFailure(r)},t.notifyExpectedFailure=function(r){xt.notifyExpectedFailure(r)}}(un||(un={}));var kr,mi=be("thirdPartyCloudStorage");!function(t){var r=[],s={fileType:"",assembleAttachment:[]},u=!0,a=null;function c(v){if(a)if(v&&v.error)a([],v.error),a=null;else if(v&&v.fileChunk)try{u||0!==v.fileChunk.chunkSequence||(mi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),u=!0,a([],{errorCode:M.INTERNAL_ERROR,message:"error occurred while receiving data"}),r=[],a=null);var C=Zr(v.fileChunk,v.fileType);if(C?s.assembleAttachment.push(C):(mi("Received a null assemble attachment for when decoding chunk sequence "+v.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),a?a([],{errorCode:M.INTERNAL_ERROR,message:"error occurred while receiving data"}):a=null,r=[],a=null,u=!0),u=v.fileChunk.endOfFile,v.fileChunk.endOfFile){var m=mr(s.assembleAttachment,s.fileType);if(m){var h=new File([m],v.fileName,{type:m.type});r.push(h)}v.isLastFile&&a&&(a(r,v.error),r=[],a=null,u=!0),s={fileType:"",assembleAttachment:[]}}}catch(k){a&&(a([],{errorCode:M.INTERNAL_ERROR,message:k}),r=[],a=null,u=!0)}else a([],{errorCode:M.INTERNAL_ERROR,message:"data received is null"}),r=[],a=null,u=!0}function g(){return!(!S(l)||!l.supports.thirdPartyCloudStorage)}t.getDragAndDropFiles=function(v,C){if(!C)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(v&&""!==v){if(S(l,f.content,f.task),!g())throw z;if(a)throw a=null,new Error("getDragAndDropFiles cannot be called twice");a=C,u=!0,K("thirdPartyCloudStorage.getDragAndDropFiles",[v],c)}else C([],{errorCode:M.INVALID_ARGUMENTS})},t.isSupported=g}(kr||(kr={}));var ct=we.V_1;function zo(t,r){Hr(F(ct,A.PublicAPIs_Initialize),r).then(function(){t&&t()})}function Qo(){gn.enablePrintCapability()}function vi(){gn.print()}function jo(t){qt(),_e(F(ct,A.PublicAPIs_GetContext),"getContext",function(r){r.frameContext||(r.frameContext=P.frameContext),t(r)})}function jt(t){ao(F(ct,A.PublicAPIs_RegisterOnThemeChangeHandlerHelper),t)}function Wn(t){Ot(F(ct,A.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",t,[])}function Bo(t){Ot(F(ct,A.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",t,[f.content])}function Ci(t){Ot(F(ct,A.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",t,[f.content])}function Dr(t){Ot(F(ct,A.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",t,[f.content])}function wi(t){ot.backStack.registerBackButtonHandlerHelper(F(ct,A.PublicAPIs_RegisterBackButtonHandler),t)}function yi(t){gn.registerOnLoadHandlerHelper(t)}function Si(t){gn.registerBeforeUnloadHandlerHelper(t)}function bi(t){Ot(F(ct,A.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",t,[])}function Ei(t){Ot(F(ct,A.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",t,[f.content])}function Pi(t,r){S(l),po(F(ct,A.PublicAPIs_GetTabInstances),r).then(function(s){t(s)})}function Ai(t,r){S(l),ho(F(ct,A.PublicAPIs_GetMruTabInstances),r).then(function(s){t(s)})}function ki(t){go(F(ct,A.PublicAPIs_ShareDeepLink),{subPageId:t.subEntityId,subPageLabel:t.subEntityLabel,subPageWebUrl:t.subEntityWebUrl})}function Di(t,r){S(l,f.content,f.sidePanel,f.settings,f.task,f.stage,f.meetingStage);var s=r??Zt();so(F(ct,A.PublicAPIs_ExecuteDeepLink),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Fi(t){cr(F(ct,A.PublicAPIs_SetFrameContext),t)}function Ri(t,r,s){Hr(F(ct,A.PublicAPIs_Initialize),s).then(function(){return r&&r()}),cr(F(ct,A.PublicAPIs_SetFrameContext),t)}var zn,En=we.V_1;function Oi(t){fo(F(En,A.Navigation_ReturnFocus),t)}function Ti(t,r){S(l);var s=r??Zt();lo(F(En,A.Navigation_NavigateToTab),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Mi(t,r){S(l,f.content,f.sidePanel,f.settings,f.remove,f.task,f.stage,f.meetingStage);var s=r??Zt();uo(F(En,A.Navigation_NavigateCrossDomain),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Li(t){S(l);var r=t??Zt();co(F(En,A.Navigation_NavigateBack)).then(function(){r(!0)}).catch(function(s){r(!1,s.message)})}!function(t){t.setValidityState=function(r){ot.config.setValidityState(r)},t.getSettings=function(r){S(l,f.content,f.settings,f.remove,f.sidePanel),ot.getConfig().then(function(s){r(s)})},t.setSettings=function(r,s){S(l,f.content,f.settings,f.sidePanel);var u=s??Zt();ot.config.setConfig(r).then(function(){u(!0)}).catch(function(a){u(!1,a.message)})},t.registerOnSaveHandler=function(r){ot.config.registerOnSaveHandlerHelper(r)},t.registerOnRemoveHandler=function(r){ot.config.registerOnRemoveHandlerHelper(r)}}(zn||(zn={}));var jn,Pn,Qn=we.V_1;(function(t){function u(a){return a.height=a.height?a.height:dn.Small,a.width=a.width?a.width:dn.Small,a}t.startTask=function(a,c){var g=F(Qn,A.Tasks_StartTask),v=c?function(C){var m,h;return c(null!==(m=C.err)&&void 0!==m?m:"",null!==(h=C.result)&&void 0!==h?h:"")}:void 0;return void 0===a.card&&void 0===a.url||a.card?(S(l,f.content,f.sidePanel,f.meetingStage),_e(g,"tasks.startTask",[a],c)):void 0!==a.completionBotId?ro(g,function(a){if(void 0===a.url||void 0===a.completionBotId)throw new Error("Both url "+a.url+" and completionBotId "+a.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:a.url,size:{height:a.height?a.height:dn.Small,width:a.width?a.width:dn.Small},title:a.title,fallbackUrl:a.fallbackUrl,completionBotId:a.completionBotId}}(a),v):Ur(g,function(a){if(void 0===a.url)throw new Error("url property of taskInfo object can't be undefined");return{url:a.url,size:{height:a.height?a.height:dn.Small,width:a.width?a.width:dn.Small},title:a.title,fallbackUrl:a.fallbackUrl}}(a),v),new _o},t.updateTask=function(a){var C=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(a=u(a),["width","height"]);if(Object.keys(C).length)throw new Error("resize requires a TaskInfo argument containing only width and height");no(F(Qn,A.Tasks_UpdateTask),a)},t.submitTask=function(a,c){io(F(Qn,A.Tasks_SubmitTask),a,c)},t.getDefaultSizeIfNotProvided=u})(jn||(jn={})),function(t){var u;(u=t.UserMeetingRole||(t.UserMeetingRole={})).guest="Guest",u.attendee="Attendee",u.presenter="Presenter",u.organizer="Organizer",function(u){u.added="Added",u.alreadyExists="AlreadyExists",u.conflict="Conflict",u.notFound="NotFound"}(t.ContainerState||(t.ContainerState={})),t.isSupported=function(){return!(!S(l,f.meetingStage,f.sidePanel)||!l.supports.interactive)}}(Pn||(Pn={}));var _i=function(){function t(){}var r=t.prototype;return r.getFluidTenantInfo=function(){return It(),new Promise(function(u){u(at("interactive.getFluidTenantInfo"))})},r.getFluidToken=function(u){return It(),new Promise(function(a){a(at("interactive.getFluidToken",u))})},r.getFluidContainerId=function(){return It(),new Promise(function(u){u(at("interactive.getFluidContainerId"))})},r.setFluidContainerId=function(u){return It(),new Promise(function(a){a(at("interactive.setFluidContainerId",u))})},r.getNtpTime=function(){return It(),new Promise(function(u){u(at("interactive.getNtpTime"))})},r.registerClientId=function(u){return It(),new Promise(function(a){a(at("interactive.registerClientId",u))})},r.getClientRoles=function(u){return It(),new Promise(function(a){a(at("interactive.getClientRoles",u))})},r.getClientInfo=function(u){return It(),new Promise(function(a){a(at("interactive.getClientInfo",u))})},t.create=function(){return It(),new t},t}();function It(){if(!Pn.isSupported())throw new Error("LiveShareHost Not supported")}var xi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function An(t){try{return t.cartItems=Fr(t.cartItems),t}catch{throw new Error("Error deserializing cart")}}function Fr(t){return t.map(function(r){if(r.imageURL){var s=new URL(r.imageURL);r.imageURL=s}return r.accessories&&(r.accessories=Fr(r.accessories)),r})}var Hi=function t(r){try{return r.map(function(s){var u=s.imageURL,a=s.accessories,c=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(s,["imageURL","accessories"]),g=Object.assign({},c);return u&&(g.imageURL=u.href),a&&(g.accessories=t(a)),g})}catch{throw new Error("Error serializing cart items")}};function Gi(t){if(null!=t){if(!Array.isArray(t)||0===t.length)throw new Error("CartItem.accessories must be a non-empty array");for(var s,r=R(t);!(s=r()).done;){var u=s.value;if(u.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Rr(u)}}}function Rr(t){if(!t.id)throw new Error("cartItem.id must not be empty");if(!t.name)throw new Error("cartItem.name must not be empty");(function(t){if("number"!=typeof t||t<0)throw new Error("price "+t+" must be a number not less than 0");if(parseFloat(t.toFixed(3))!==t)throw new Error("price "+t+" must have at most 3 decimal places")})(t.price),function(t){if("number"!=typeof t||t<=0||parseInt(t.toString())!==t)throw new Error("quantity "+t+" must be an integer greater than 0")}(t.quantity)}function Bn(t){if(null!=t){if(!t)throw new Error("id must not be empty");if(!1===("string"==typeof(r=t)&&xi.test(r)))throw new Error("id must be a valid UUID")}var r}var Dn,qn,Jn,Yn,$n,Zn,Xn,kn=we.V_2;(function(t){var a;function u(){return!(!S(l)||!l.supports.marketplace)}t.cartVersion={majorVersion:1,minorVersion:1},(a=t.Intent||(t.Intent={})).TACAdminUser="TACAdminUser",a.TeamsAdminUser="TeamsAdminUser",a.TeamsEndUser="TeamsEndUser",function(a){a.Open="Open",a.Processing="Processing",a.Processed="Processed",a.Closed="Closed",a.Error="Error"}(t.CartStatus||(t.CartStatus={})),t.getCart=function(){if(S(l,f.content,f.task),!u())throw z;return dt(F(kn,A.Marketplace_GetCart),"marketplace.getCart",t.cartVersion).then(An)},t.addOrUpdateCartItems=function(a){if(S(l,f.content,f.task),!u())throw z;if(!a)throw new Error("addOrUpdateCartItemsParams must be provided");return Bn(a?.cartId),function(t){if(!Array.isArray(t)||0===t.length)throw new Error("cartItems must be a non-empty array");for(var s,r=R(t);!(s=r()).done;){var u=s.value;Rr(u),Gi(u.accessories)}}(a?.cartItems),dt(F(kn,A.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},a),{cartItems:Hi(a.cartItems),cartVersion:t.cartVersion})).then(An)},t.removeCartItems=function(a){if(S(l,f.content,f.task),!u())throw z;if(!a)throw new Error("removeCartItemsParams must be provided");if(Bn(a?.cartId),!Array.isArray(a?.cartItemIds)||0===a?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return dt(F(kn,A.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},a),{cartVersion:t.cartVersion})).then(An)},t.updateCartStatus=function(a){if(S(l,f.content,f.task),!u())throw z;if(!a)throw new Error("updateCartStatusParams must be provided");return Bn(a?.cartId),function(t){if(!Object.values(Dn.CartStatus).includes(t))throw new Error("cartStatus "+t+" is not valid")}(a?.cartStatus),dt(F(kn,A.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},a),{cartVersion:t.cartVersion})).then(An)},t.isSupported=u})(Dn||(Dn={})),function(t){var s,a,v,r="Action.Execute";function c(v){if(v.requestType===s.ActionExecuteInvokeRequest){if(v.type!==r)throw{errorCode:a.INTERNAL_ERROR,message:"Invalid action type "+v.type+'. Action type must be "'+r+'"'}}else if(v.requestType===s.QueryMessageExtensionRequest){if(v.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(v.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var h,m=R(v.parameters);!(h=m()).done;){var k=h.value;if(k.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(k.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function g(){return!(!S(l)||!l.supports.externalAppAuthentication)}(v=s=t.OriginalRequestType||(t.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",v.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(v){v.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",v.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(t.InvokeResponseType||(t.InvokeResponseType={})),function(v){v.INTERNAL_ERROR="INTERNAL_ERROR"}(a=t.InvokeErrorCode||(t.InvokeErrorCode={})),t.authenticateAndResendRequest=function(v,C,m){if(S(l,f.content),!g())throw z;return ut(v),c(m),Vt("externalAppAuthentication.authenticateAndResendRequest",[v,m,C.url.href,C.width,C.height,C.isExternal]).then(function(h){var D=h[1];if(h[0]&&null!=D.responseType)return D;throw D})},t.authenticateWithSSO=function(v,C){if(S(l,f.content),!g())throw z;return ut(v),Vt("externalAppAuthentication.authenticateWithSSO",[v,C.claims,C.silent]).then(function(m){if(!m[0])throw m[1]})},t.authenticateWithSSOAndResendRequest=function(v,C,m){if(S(l,f.content),!g())throw z;return ut(v),c(m),Vt("externalAppAuthentication.authenticateWithSSOAndResendRequest",[v,m,C.claims,C.silent]).then(function(h){var D=h[1];if(h[0]&&null!=D.responseType)return D;throw D})},t.isSupported=g}(qn||(qn={})),function(t){var c;function a(){return!(!S(l)||!l.supports.externalAppCardActions)}(c=t.ActionOpenUrlType||(t.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",c.DeepLinkOther="DeepLinkOther",c.DeepLinkStageView="DeepLinkStageView",c.GenericUrl="GenericUrl",function(c){c.INTERNAL_ERROR="INTERNAL_ERROR",c.INVALID_LINK="INVALID_LINK",c.NOT_SUPPORTED="NOT_SUPPORTED"}(t.ActionOpenUrlErrorCode||(t.ActionOpenUrlErrorCode={})),function(c){c.INTERNAL_ERROR="INTERNAL_ERROR"}(t.ActionSubmitErrorCode||(t.ActionSubmitErrorCode={})),t.processActionSubmit=function(c,g){if(S(l,f.content),!a())throw z;return ut(c),Vt("externalAppCardActions.processActionSubmit",[c,g]).then(function(v){if(!v[0])throw v[1]})},t.processActionOpenUrl=function(c,g){if(S(l,f.content),!a())throw z;return ut(c),Vt("externalAppCardActions.processActionOpenUrl",[c,g.href]).then(function(v){var C=v[0];if(C)throw C;return v[1]})},t.isSupported=a}(Jn||(Jn={})),function(t){var C;function v(C,m){return{errorCode:C,message:m}}(C=t.CloudStorageProvider||(t.CloudStorageProvider={})).Dropbox="DROPBOX",C.Box="BOX",C.Sharefile="SHAREFILE",C.GoogleDrive="GOOGLEDRIVE",C.Egnyte="EGNYTE",C.SharePoint="SharePoint",function(C){C[C.Sharepoint=0]="Sharepoint",C[C.WopiIntegration=1]="WopiIntegration",C[C.Google=2]="Google",C[C.OneDrive=3]="OneDrive",C[C.Recent=4]="Recent",C[C.Aggregate=5]="Aggregate",C[C.FileSystem=6]="FileSystem",C[C.Search=7]="Search",C[C.AllFiles=8]="AllFiles",C[C.SharedWithMe=9]="SharedWithMe"}(t.CloudStorageProviderType||(t.CloudStorageProviderType={})),function(C){C.ClassMaterials="classMaterials"}(t.SpecialDocumentLibraryType||(t.SpecialDocumentLibraryType={})),function(C){C.Readonly="readonly"}(t.DocumentLibraryAccessType||(t.DocumentLibraryAccessType={})),function(C){C.Downloaded="Downloaded",C.Downloading="Downloading",C.Failed="Failed"}(t.FileDownloadStatus||(t.FileDownloadStatus={})),function(C){C.Download="DOWNLOAD",C.Upload="UPLOAD",C.Delete="DELETE"}(t.CloudStorageProviderFileAction||(t.CloudStorageProviderFileAction={})),t.getCloudStorageFolders=function(C,m){if(S(l,f.content),!C||0===C.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!m)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");K("files.getCloudStorageFolders",[C],m)},t.addCloudStorageFolder=function(C,m){if(S(l,f.content),!C||0===C.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!m)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");K("files.addCloudStorageFolder",[C],m)},t.deleteCloudStorageFolder=function(C,m,h){if(S(l,f.content),!C)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!m)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!h)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");K("files.deleteCloudStorageFolder",[C,m],h)},t.getCloudStorageFolderContents=function(C,m,h){if(S(l,f.content),!C||!m)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!h)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in C&&!C.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");K("files.getCloudStorageFolderContents",[C,m],h)},t.openCloudStorageFile=function(C,m,h){if(S(l,f.content),!C||!m)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(C.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");K("files.openCloudStorageFile",[C,m,h])},t.getExternalProviders=function(C,m){if(void 0===C&&(C=!1),S(l,f.content),!m)throw new Error("[files.getExternalProviders] Callback cannot be null");K("files.getExternalProviders",[C],m)},t.copyMoveFiles=function(C,m,h,k,D,j){if(void 0===D&&(D=!1),S(l,f.content),!C||0===C.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!m)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!h)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!k)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!j)throw new Error("[files.copyMoveFiles] callback cannot be null");K("files.copyMoveFiles",[C,m,h,k,D],j)},t.getFileDownloads=function(C){if(S(l,f.content),!C)throw new Error("[files.getFileDownloads] Callback cannot be null");K("files.getFileDownloads",[],C)},t.openDownloadFolder=function(C,m){if(void 0===C&&(C=void 0),S(l,f.content),!m)throw new Error("[files.openDownloadFolder] Callback cannot be null");K("files.openDownloadFolder",[C],m)},t.addCloudStorageProvider=function(C){if(S(l,f.content),!C)throw v(M.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");K("files.addCloudStorageProvider",[],C)},t.removeCloudStorageProvider=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!C||!C.content)throw v(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");K("files.removeCloudStorageProvider",[C],m)},t.addCloudStorageProviderFile=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!C||!C.content)throw v(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");K("files.addCloudStorageProviderFile",[C],m)},t.renameCloudStorageProviderFile=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!C||!C.content)throw v(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");K("files.renameCloudStorageProviderFile",[C],m)},t.deleteCloudStorageProviderFile=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");K("files.deleteCloudStorageProviderFile",[C],m)},t.downloadCloudStorageProviderFile=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");K("files.downloadCloudStorageProviderFile",[C],m)},t.uploadCloudStorageProviderFile=function(C,m){if(S(l,f.content),!m)throw v(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!C.content.destinationFolder)throw v(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");K("files.uploadCloudStorageProviderFile",[C],m)},t.registerCloudStorageProviderListChangeHandler=function(C){if(S(l),!C)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");De("files.cloudStorageProviderListChange",C)},t.registerCloudStorageProviderContentChangeHandler=function(C){if(S(l),!C)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");De("files.cloudStorageProviderContentChange",C)}}(Yn||(Yn={})),function(t){function r(){return!(!S(l)||!l.supports.meetingRoom)}t.getPairedMeetingRoomInfo=function(){return new Promise(function(s){if(S(l),!r())throw z;s(at("meetingRoom.getPairedMeetingRoomInfo"))})},t.sendCommandToPairedMeetingRoom=function(s){return new Promise(function(u){if(!s||0==s.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(S(l),!r())throw z;u(at("meetingRoom.sendCommandToPairedMeetingRoom",s))})},t.registerMeetingRoomCapabilitiesUpdateHandler=function(s){if(!s)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(S(l),!r())throw z;De("meetingRoom.meetingRoomCapabilitiesUpdate",function(u){S(l),s(u)})},t.registerMeetingRoomStatesUpdateHandler=function(s){if(!s)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(S(l),!r())throw z;De("meetingRoom.meetingRoomStatesUpdate",function(u){S(l),s(u)})},t.isSupported=r}($n||($n={})),function(t){function r(){return!(!S(l)||!l.supports.notifications)}t.showNotification=function(s){if(S(l,f.content),!r())throw z;K("notifications.showNotification",[s])},t.isSupported=r}(Zn||(Zn={})),function(t){var c;function a(){return!(!S(l)||!l.supports.remoteCamera)}(c=t.ControlCommand||(t.ControlCommand={})).Reset="Reset",c.ZoomIn="ZoomIn",c.ZoomOut="ZoomOut",c.PanLeft="PanLeft",c.PanRight="PanRight",c.TiltUp="TiltUp",c.TiltDown="TiltDown",function(c){c[c.CommandResetError=0]="CommandResetError",c[c.CommandZoomInError=1]="CommandZoomInError",c[c.CommandZoomOutError=2]="CommandZoomOutError",c[c.CommandPanLeftError=3]="CommandPanLeftError",c[c.CommandPanRightError=4]="CommandPanRightError",c[c.CommandTiltUpError=5]="CommandTiltUpError",c[c.CommandTiltDownError=6]="CommandTiltDownError",c[c.SendDataError=7]="SendDataError"}(t.ErrorReason||(t.ErrorReason={})),function(c){c[c.None=0]="None",c[c.ControlDenied=1]="ControlDenied",c[c.ControlNoResponse=2]="ControlNoResponse",c[c.ControlBusy=3]="ControlBusy",c[c.AckTimeout=4]="AckTimeout",c[c.ControlTerminated=5]="ControlTerminated",c[c.ControllerTerminated=6]="ControllerTerminated",c[c.DataChannelError=7]="DataChannelError",c[c.ControllerCancelled=8]="ControllerCancelled",c[c.ControlDisabled=9]="ControlDisabled",c[c.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(t.SessionTerminatedReason||(t.SessionTerminatedReason={})),t.getCapableParticipants=function(c){if(!c)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(S(l,f.sidePanel),!a())throw z;K("remoteCamera.getCapableParticipants",c)},t.requestControl=function(c,g){if(!c)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!g)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(S(l,f.sidePanel),!a())throw z;K("remoteCamera.requestControl",[c],g)},t.sendControlCommand=function(c,g){if(!c)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!g)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(S(l,f.sidePanel),!a())throw z;K("remoteCamera.sendControlCommand",[c],g)},t.terminateSession=function(c){if(!c)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(S(l,f.sidePanel),!a())throw z;K("remoteCamera.terminateSession",c)},t.registerOnCapableParticipantsChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(S(l,f.sidePanel),!a())throw z;De("remoteCamera.capableParticipantsChange",c)},t.registerOnErrorHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(S(l,f.sidePanel),!a())throw z;De("remoteCamera.handlerError",c)},t.registerOnDeviceStateChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(S(l,f.sidePanel),!a())throw z;De("remoteCamera.deviceStateChange",c)},t.registerOnSessionStatusChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(S(l,f.sidePanel),!a())throw z;De("remoteCamera.sessionStatusChange",c)},t.isSupported=a}(Xn||(Xn={}));var Kn,er,ji=we.V_1;(function(t){function r(){return!(!S(l)||!l.supports.appEntity)}t.selectAppEntity=function(s,u,a,c){if(S(l,f.content),!r())throw z;if(!s||0==s.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!c)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");_e(F(ji,A.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[s,u,a],c)},t.isSupported=r})(Kn||(Kn={})),function(t){var a;function u(){return!(!S(l)||!l.supports.teams)}(a=t.ChannelType||(t.ChannelType={}))[a.Regular=0]="Regular",a[a.Private=1]="Private",a[a.Shared=2]="Shared",t.getTeamChannels=function(a,c){if(S(l,f.content),!u())throw z;if(!a)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!c)throw new Error("[teams.getTeamChannels] Callback cannot be null");K("teams.getTeamChannels",[a],c)},t.refreshSiteUrl=function(a,c){if(S(l),!u())throw z;if(!a)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!c)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");K("teams.refreshSiteUrl",[a],c)},t.isSupported=u,function(a){function g(){return!(!S(l)||!l.supports.teams||!l.supports.teams.fullTrust)}(function(v){function C(){return!!(S(l)&&l.supports.teams&&l.supports.teams.fullTrust&&l.supports.teams.fullTrust.joinedTeams)}v.getUserJoinedTeams=function(m){return new Promise(function(h){if(S(l),!C())throw z;if((P.hostClientType===Y.android||P.hostClientType===Y.teamsRoomsAndroid||P.hostClientType===Y.teamsPhones||P.hostClientType===Y.teamsDisplays)&&!_t("2.0.1"))throw new Error(JSON.stringify({errorCode:M.OLD_PLATFORM}));h(Wr("getUserJoinedTeams",m))})},v.isSupported=C})(a.joinedTeams||(a.joinedTeams={})),a.getConfigSetting=function(v){return new Promise(function(C){if(S(l),!g())throw z;C(Wr("getConfigSetting",v))})},a.isSupported=g}(t.fullTrust||(t.fullTrust={}))}(er||(er={}));var tr,Or=function(r,s,u,a){return new(u||(u=Promise))(function(g,v){function C(k){try{h(a.next(k))}catch(D){v(D)}}function m(k){try{h(a.throw(k))}catch(D){v(D)}}function h(k){k.done?g(k.value):function(g){return g instanceof u?g:new u(function(v){v(g)})}(k.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};!function(t){t.frameProcessingTimeoutInMs=2e3;var s,m,r=ht()?void 0:new br(K);function u(){var m=setTimeout(function(){C("Frame not processed in "+t.frameProcessingTimeoutInMs+"ms",s.Warn)},t.frameProcessingTimeoutInMs);return function(){clearTimeout(m)}}function a(m,h){var k=this;return function(D){return Or(k,void 0,void 0,X().mark(function j(){var Fe,q,T;return X().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return h.reportStartFrameProcessing((Fe=D.videoFrame).codedWidth,Fe.codedHeight),q=u(),re.next=5,m(D);case 5:return T=re.sent,re.abrupt("return",(q(),h.reportFrameProcessed(),T));case 7:case"end":return re.stop()}},j)}))}}function g(){return S(l),sn.isSupported()}function C(m,h){void 0===h&&(h=s.Warn),K("video.notifyError",[m,h])}(m=s=t.ErrorLevel||(t.ErrorLevel={})).Fatal="fatal",m.Warn="warn",t.registerForVideoFrame=function(m){var k,D,h=this;if(!g())throw z;if(!m.videoFrameHandler||!m.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(S(l,f.sidePanel)){if(De("video.setFrameProcessTimeLimit",function(j){return r?.setFrameProcessTimeLimit(j)},!1),null===(k=l.supports.video)||void 0===k?void 0:k.mediaStream)De("video.startVideoExtensibilityVideoStream",function(j){return Or(h,void 0,void 0,X().mark(function Fe(){var q,T,J;return X().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(q=j.streamId,T=j.metadataInTexture,J=r?a(m.videoFrameHandler,r):m.videoFrameHandler,!T){Q.next=6;break}return Q.next=4,Io(q,J,C,r);case 4:Q.next=8;break;case 6:return Q.next=8,Ho(q,J,C,r);case 8:case"end":return Q.stop()}},Fe)}))},!1),K("video.mediaStream.registerForVideoFrame",[m.config]);else{if(null===(D=l.supports.video)||void 0===D||!D.sharedFrame)throw z;De("video.newVideoFrame",function(j){if(j){r?.reportStartFrameProcessing(j.width,j.height);var Fe=u(),q=j.timestamp;m.videoBufferHandler(function(m){return m.videoFrameBuffer=m.videoFrameBuffer||m.data,delete m.data,m}(j),function(){Fe(),r?.reportFrameProcessed(),function(m){K("video.videoFrameProcessed",[m])}(q)},C)}},!1),K("video.registerForVideoFrame",[m.config])}r?.startMonitorSlowFrameProcessing()}},t.notifySelectedVideoEffectChanged=function(m,h,k){if(S(l,f.sidePanel),!g())throw z;K("video.videoEffectChanged",[m,h,k])},t.registerForVideoEffect=function(m){if(S(l,f.sidePanel),!g())throw z;De("video.effectParameterChange",Yt(m,r),!1),K("video.registerForVideoEffect")},t.updatePersonalizedEffects=function(m){if(S(l,f.sidePanel),!sn.isSupported())throw z;K("video.personalizedEffectsChanged",[m])},t.isSupported=g,t.notifyFatalError=function(m){if(S(l),!sn.isSupported())throw z;C(m,s.Fatal)}}(tr||(tr={}))}(),qe}()},78590:function(Me,$e,G){"use strict";G.d($e,{w9:function(){return Dr},rP:function(){return qo},Qo:function(){return ce},Cq:function(){return Bo},Mw:function(){return R}});var ce,e,R,X,ke,W,Ue,qe,de,be,F,Ie,Se={};G.r(Se),G.d(Se,{addQueryParameters:function(){return vi},getOrigin:function(){return jo},removeQueryAndFragment:function(){return Qo}}),(e=ce||(ce={}))[e.ExistingPersistedMashup=0]="ExistingPersistedMashup",e[e.TransientMashup=1]="TransientMashup",e[e.TransientEmptyMashup=2]="TransientEmptyMashup",function(e){e.AddQueries="addQueries",e.BrowseMashup="BrowseMashup",e.ConnectToDataSource="ConnectToDataSource",e.CreateConnection="CreateConnection",e.DataPreview="DataPreview",e.DiagramView="DiagramView",e.EditConnection="EditConnection",e.EditDataflowComputeEngineSettings="EditDataflowComputeEngineSettings",e.EditCubeVariables="editCubeVariables",e.EditQuery="editQuery",e.EditQuickCreate="EditQuickCreate",e.ImportMashupTemplate="importMashupTemplate",e.IncrementalRefreshSettings="incrementalRefreshSettings",e.ManageConnections="manageConnections",e.ManageDataflowComputeEngine="manageDataflowComputeEngine",e.Navigate="navigate",e.QuickCreate="QuickCreate",e.RefreshSettings="refreshSettings",e.ResolveResourceChallenge="ResolveResourceChallenge",e.ShowRefreshHistory="showRefreshHistory"}(R||(R={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}(X||(X={})),function(e){e.Attach="Attach"}(ke||(ke={})),function(e){e.Busy="Busy",e.Error="Error",e.Ready="Ready",e.Unknown="Unknown"}(W||(W={})),function(e){e.Editable="Editable",e.Hidden="Hidden",e.Readonly="Readonly"}(Ue||(Ue={})),function(e){e.Dataflow="Dataflow",e.Project="Project"}(qe||(qe={})),function(e){e.Definition="Definition",e.Instance="Instance"}(de||(de={})),function(e){e.DataSourceTemplateKind="DataSourceTemplateKind"}(be||(be={})),function(e){e.DataSourceTemplateKind="DataSourceTemplateKind",e.Navigation="Navigation"}(F||(F={})),function(e){e.Busy="Busy",e.Error="Error",e.Ready="Ready",e.Unknown="Unknown"}(Ie||(Ie={}));var Fn,Rn,we=G(90341);function Ee(e){throw new Error("Unexpected value: "+e)}function V(e){switch(e.kind){case R.BrowseMashup:case R.ConnectToDataSource:case R.DataPreview:case R.DiagramView:case R.EditConnection:case R.EditCubeVariables:case R.EditDataflowComputeEngineSettings:case R.EditQuickCreate:case R.ImportMashupTemplate:case R.IncrementalRefreshSettings:case R.ManageConnections:case R.ManageDataflowComputeEngine:case R.Navigate:case R.QuickCreate:case R.RefreshSettings:case R.ShowRefreshHistory:return!0;case R.AddQueries:case R.CreateConnection:case R.EditQuery:case R.ResolveResourceChallenge:return!e.keepFlowRunningOnCommit;default:Ee(e)}}function $(e){switch(e.kind){case R.AddQueries:case R.BrowseMashup:case R.ConnectToDataSource:case R.CreateConnection:case R.DataPreview:case R.DiagramView:case R.EditConnection:case R.EditCubeVariables:case R.EditDataflowComputeEngineSettings:case R.EditQuery:case R.EditQuickCreate:case R.ImportMashupTemplate:case R.IncrementalRefreshSettings:case R.ManageConnections:case R.ManageDataflowComputeEngine:case R.Navigate:case R.QuickCreate:case R.RefreshSettings:case R.ShowRefreshHistory:return!0;case R.ResolveResourceChallenge:return!e.keepFlowRunningOnCancel;default:Ee(e)}}function z(e,n){return e.kind===n.kind}function zt(e){bt(e)}function bt(e,n){if(null==e)throw new Error(n?n():"Value should be defined");return e}!function(e){e.ClientInstanceId="clientInstanceId",e.ProtocolId="protocolId"}(Fn||(Fn={})),function(e){e.DataAutomationId="data-automation-id",e.DataIsAutoFocusable="data-is-autofocusable",e.DataIsFocusable="data-is-focusable"}(Rn||(Rn={}));var On,vn,Tn,Mn,Nt,Ln,Cn,fn,Nn,it,ht,Bt,ut,Rt,Mt,yt,Xt,Lr=function(){function e(i,o,d){this.iFrameElement=document.createElement("iframe"),this.iFrameElementOriginalDisplayValue=this.iFrameElement.style.display,this.iFrameElement.src=i,this.iFrameElement.title="Power Query",this.iFrameElement.allow="clipboard-read; clipboard-write",this.iFrameElement.setAttribute(Rn.DataIsFocusable,"true"),zt(o),this.container=o,d&&(this.iFrameElement.className=d),this.hide(),this.container.appendChild(this.iFrameElement),this.isDisposed=!1}var n=e.prototype;return n.addEventListener=function(o,d,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.addEventListener(o,d,w))},n.removeEventListener=function(o,d,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.removeEventListener(o,d,w))},n.postMessage=function(o,d,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.postMessage(o,d,w))},n.hide=function(){if(!this.isDisposed){var o=this.iFrameElement.style.display;"none"!==o&&(this.iFrameElementOriginalDisplayValue=o,this.iFrameElement.style.display="none")}},n.show=function(){this.isDisposed||(this.iFrameElement.style.display=this.iFrameElementOriginalDisplayValue)},n.dispose=function(){this.container.removeChild(this.iFrameElement),this.isDisposed=!0},e}();!function(e){e.GetEntityQueryScript="browseMashupCallbacks.getEntityQueryScript"}(On||(On={})),function(e){e.GetInitialComputeEngineSettings="computeEngineCallbacks.getInitialComputeEngineSettings"}(vn||(vn={})),function(e){e.OnStateChanged="createConnectionFlowClientCallbacks.onStateChanged"}(Tn||(Tn={})),function(e){e.OnSampleDataItemClick="dataDiscoveryFormCallbacks.onSampleDataItemClick"}(Mn||(Mn={})),function(e){e.OnEvaluationEnded="dataPreview.onEvaluationEnded",e.OnEvaluationStarted="dataPreview.onEvaluationStarted",e.OnQueryScriptChange="dataPreview.onQueryScriptChange",e.OnTableSelectionChanged="dataPreview.onTableSelectionChanged"}(Nt||(Nt={})),function(e){e.OnControlStateChanged="flowControlRpcMethodNames.onControlStateChanged"}(Ln||(Ln={})),function(e){e.OnCommandExecuted="hostCommandsCallbacks.onCommandExecuted"}(Cn||(Cn={})),function(e){e.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",e.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(fn||(fn={})),function(e){e.OnUnlinkConnection="manageConnectionsFlowCallbacks.onUnlinkConnection"}(Nn||(Nn={})),function(e){e.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",e.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",e.GetEntities="mappingEditorCallbacks.getEntities",e.GetEntityFields="mappingEditorCallbacks.getEntityFields",e.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",e.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(it||(it={})),function(e){e.GetEntityTypeFields="mappingCallbacks.getEntityTypeFields",e.GetEntityTypes="mappingCallbacks.getEntityTypes"}(ht||(ht={})),function(e){e.GetEntityDefinitionFromEntityPath="mappingCallbacksV2.getEntityDefinitionFromEntityPath",e.GetManifestDefinitionFromManifestPath="mappingCallbacksV2.getManifestDefinitionFromManifestPath",e.GetRootManifestDefinition="mappingCallbacksV2.getRootManifestDefinition"}(Bt||(Bt={})),function(e){e.GetMashupSensitivityLabel="mashupEditorClientCallbacks.getMashupSensitivityLabel",e.OnComputeEngineSettingsChanged="mashupEditorClientCallbacks.onComputeEngineSettingsChanged",e.OnEditingSessionMashupChanged="mashupEditorClientCallbacks.onEditingSessionMashupChanged",e.OnEditingSessionMashupInitialized="mashupEditorClientCallbacks.onEditingSessionMashupInitialized",e.OnMashupEditorClick="mashupEditorClientCallbacks.onMashupEditorClick",e.RenameMashup="mashupEditorClientCallbacks.renameMashup"}(ut||(ut={})),function(e){e.OnNewSqlQueryButtonClicked="powerBIDataMart.onNewSqlQueryButtonClicked",e.OnNewVisualQueryButtonClicked="powerBIDataMart.onNewVisualQueryButtonClicked",e.OnSaveAsViewButtonClicked="powerBIDataMart.onSaveAsViewButtonClicked",e.OnViewSqlButtonClicked="powerBIDataMart.onViewSqlButtonClicked",e.OnVisualizeResultButtonClicked="powerBIDataMart.onVisualizeResultButtonClicked"}(Rt||(Rt={})),function(e){e.OnDownloadExcelFileButtonClick="queryEditorPreviewButtonsCallbacks.onDownloadExcelFileButtonClick",e.OnSaveAsTableButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsTableButtonClick",e.OnSaveAsViewButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsViewButtonClick",e.OnVisualizeResultsButtonClick="queryEditorPreviewButtonsCallbacks.onVisualizeResultsButtonClick"}(Mt||(Mt={})),function(e){e.OnCommandBarPopupButtonClick="queryEditorCallbacks.onCommandBarPopupButtonClick",e.OnDiagramViewCommandBarPopupButtonClick="queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick",e.OnOpenInExcelButtonClick="queryEditorCallbacks.onOpenInExcelButtonClick",e.ValidateQuery="queryEditorCallbacks.validateQuery",e.ValidateQueryNameInteractive="queryEditorCallbacks.validateQueryNameInteractive"}(yt||(yt={})),function(e){e.GetUserSettings="userSettings.getUserSettings",e.SetUserSettings="userSettings.setUserSettings"}(Xt||(Xt={}));var l,Yi=function(){function e(i,o,d,w,H){this.clientRpcChannel=i,this.clientRpcEndpointHost=o,this.client=d,this.configuration=w,this.clientStartTime=H,this.registerRpcMethods()}var n=e.prototype;return n.dispose=function(){this.unregisterRpcMethods()},n.registerRpcMethods=function(){var d,w,H,ae,ne,te,ue,xe,st,lt,Et,He,Re,pt,mt,Ke,Pt,At,vt,rt,Gt,Ct,cn,Wt,ln,kt,Dt,Ft,E,p,y,L,I,x,oe,Ae,Oe,et,Ye,tt,Jo,Yo,$o,Zo,Xo,Ko,ea,ta,na,o=this;this.register("acquireToken",function(je){return o.configuration.acquireToken(je)}),this.register("getClientStartTime",function(){return o.clientStartTime}),this.register("getSettings",function(){return o.configuration.editorSettings}),this.register("getVersion",function(){return"22.28.0"}),this.register("hasMappingCallbacks",function(){return null!=o.configuration.mappingCallbacks}),this.register("hasMappingCallbacksV2",function(){return null!=o.configuration.mappingCallbacksV2}),this.register("onAppReady",function(){return o.clientRpcEndpointHost.onAppReady()}),this.register("onCancel",function(){return o.clientRpcEndpointHost.onCancelCurrentFlow()}),this.register("onCommit",function(){}),this.register("onCommit2",function(je){return o.clientRpcEndpointHost.onCommitCurrentFlow(je)}),this.register("onFlowReady",function(){return o.clientRpcEndpointHost.onCurrentFlowReady()}),!(null===(d=this.configuration.browseMashupCallbacks)||void 0===d)&&d.getEntityQueryScript&&this.register(On.GetEntityQueryScript,this.configuration.browseMashupCallbacks.getEntityQueryScript),!(null===(w=this.configuration.computeEngineCallbacks)||void 0===w)&&w.getInitialComputeEngineSettings&&this.register(vn.GetInitialComputeEngineSettings,this.configuration.computeEngineCallbacks.getInitialComputeEngineSettings),!(null===(H=this.configuration.createConnectionFlowClientCallbacks)||void 0===H)&&H.onStateChanged&&this.register(Tn.OnStateChanged,this.configuration.createConnectionFlowClientCallbacks.onStateChanged),!(null===(ae=this.configuration.dataPreviewCallbacks)||void 0===ae)&&ae.onEvaluationEnded&&this.register(Nt.OnEvaluationEnded,this.configuration.dataPreviewCallbacks.onEvaluationEnded),!(null===(ne=this.configuration.dataPreviewCallbacks)||void 0===ne)&&ne.onEvaluationStarted&&this.register(Nt.OnEvaluationStarted,this.configuration.dataPreviewCallbacks.onEvaluationStarted),!(null===(te=this.configuration.dataPreviewCallbacks)||void 0===te)&&te.onQueryScriptChange&&this.register(Nt.OnQueryScriptChange,this.configuration.dataPreviewCallbacks.onQueryScriptChange),!(null===(ue=this.configuration.dataPreviewCallbacks)||void 0===ue)&&ue.onTableSelectionChanged&&this.register(Nt.OnTableSelectionChanged,this.configuration.dataPreviewCallbacks.onTableSelectionChanged),!(null===(xe=this.configuration.flowControlCallbacks)||void 0===xe)&&xe.onControlStateChanged&&this.register(Ln.OnControlStateChanged,function(){var je;return null===(je=o.configuration.flowControlCallbacks)||void 0===je?void 0:je.onControlStateChanged(o.client)}),!(null===(st=this.configuration.hostPopupsCallbacks)||void 0===st)&&st.getLoginSuccessRedirectUri&&this.register(fn.GetLoginSuccessRedirectUri,this.configuration.hostPopupsCallbacks.getLoginSuccessRedirectUri),!(null===(lt=this.configuration.hostPopupsCallbacks)||void 0===lt)&&lt.openHostPopup&&this.register(fn.OpenHostPopup,this.configuration.hostPopupsCallbacks.openHostPopup),!(null===(Et=this.configuration.hostCommandsCallbacks)||void 0===Et)&&Et.onCommandExecuted&&this.register(Cn.OnCommandExecuted,this.configuration.hostCommandsCallbacks.onCommandExecuted),!(null===(He=this.configuration.manageConnectionsFlowCallbacks)||void 0===He)&&He.onUnlinkConnection&&this.register(Nn.OnUnlinkConnection,this.configuration.manageConnectionsFlowCallbacks.onUnlinkConnection),!(null===(Re=this.configuration.mappingEditorCallbacks)||void 0===Re)&&Re.generateNewEntityFieldNames&&this.register(it.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(pt=this.configuration.mappingEditorCallbacks)||void 0===pt)&&pt.generateNewEntityNames&&this.register(it.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(mt=this.configuration.mappingEditorCallbacks)||void 0===mt)&&mt.getEntities&&this.register(it.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===(Ke=this.configuration.mappingEditorCallbacks)||void 0===Ke)&&Ke.getEntityFields&&this.register(it.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(Pt=this.configuration.mappingEditorCallbacks)||void 0===Pt)&&Pt.getEntityKeys&&this.register(it.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(At=this.configuration.mappingEditorCallbacks)||void 0===At)&&At.validateMappingEditorResult&&this.register(it.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(vt=this.configuration.mappingCallbacks)||void 0===vt)&&vt.getEntityTypeFields&&this.register(ht.GetEntityTypeFields,this.configuration.mappingCallbacks.getEntityTypeFields),!(null===(rt=this.configuration.mappingCallbacks)||void 0===rt)&&rt.getEntityTypes&&this.register(ht.GetEntityTypes,null===(Gt=this.configuration.mappingCallbacks)||void 0===Gt?void 0:Gt.getEntityTypes),!(null===(Ct=this.configuration.mappingCallbacksV2)||void 0===Ct)&&Ct.getEntityDefinitionFromEntityPath&&this.register(Bt.GetEntityDefinitionFromEntityPath,this.configuration.mappingCallbacksV2.getEntityDefinitionFromEntityPath),!(null===(cn=this.configuration.mappingCallbacksV2)||void 0===cn)&&cn.getManifestDefinitionFromManifestPath&&this.register(Bt.GetManifestDefinitionFromManifestPath,this.configuration.mappingCallbacksV2.getManifestDefinitionFromManifestPath),!(null===(Wt=this.configuration.mappingCallbacksV2)||void 0===Wt)&&Wt.getRootManifestDefinition&&this.register(Bt.GetRootManifestDefinition,null===(ln=this.configuration.mappingCallbacksV2)||void 0===ln?void 0:ln.getRootManifestDefinition),!(null===(kt=this.configuration.mashupEditorClientCallbacks)||void 0===kt)&&kt.getMashupSensitivityLabel&&this.register(ut.GetMashupSensitivityLabel,this.configuration.mashupEditorClientCallbacks.getMashupSensitivityLabel),!(null===(Dt=this.configuration.mashupEditorClientCallbacks)||void 0===Dt)&&Dt.onComputeEngineSettingsChanged&&this.register(ut.OnComputeEngineSettingsChanged,this.configuration.mashupEditorClientCallbacks.onComputeEngineSettingsChanged),!(null===(Ft=this.configuration.mashupEditorClientCallbacks)||void 0===Ft)&&Ft.onEditingSessionMashupChanged&&this.register(ut.OnEditingSessionMashupChanged,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupChanged),!(null===(E=this.configuration.mashupEditorClientCallbacks)||void 0===E)&&E.onEditingSessionMashupInitialized&&this.register(ut.OnEditingSessionMashupInitialized,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupInitialized),!(null===(p=this.configuration.mashupEditorClientCallbacks)||void 0===p)&&p.onMashupEditorClick&&this.register(ut.OnMashupEditorClick,null===(y=this.configuration.mashupEditorClientCallbacks)||void 0===y?void 0:y.onMashupEditorClick),!(null===(L=this.configuration.mashupEditorClientCallbacks)||void 0===L)&&L.renameMashup&&this.register(ut.RenameMashup,this.configuration.mashupEditorClientCallbacks.renameMashup),!(null===(I=this.configuration.powerBIDataMartCallbacks)||void 0===I)&&I.onNewSqlQueryButtonClicked&&this.register(Rt.OnNewSqlQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewSqlQueryButtonClicked),!(null===(x=this.configuration.powerBIDataMartCallbacks)||void 0===x)&&x.onNewVisualQueryButtonClicked&&this.register(Rt.OnNewVisualQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewVisualQueryButtonClicked),!(null===(oe=this.configuration.powerBIDataMartCallbacks)||void 0===oe)&&oe.onSaveAsViewButtonClicked&&this.register(Rt.OnSaveAsViewButtonClicked,this.configuration.powerBIDataMartCallbacks.onSaveAsViewButtonClicked),!(null===(Ae=this.configuration.powerBIDataMartCallbacks)||void 0===Ae)&&Ae.onViewSqlButtonClicked&&this.register(Rt.OnViewSqlButtonClicked,this.configuration.powerBIDataMartCallbacks.onViewSqlButtonClicked),!(null===(Oe=this.configuration.powerBIDataMartCallbacks)||void 0===Oe)&&Oe.onVisualizeResultButtonClicked&&this.register(Rt.OnVisualizeResultButtonClicked,this.configuration.powerBIDataMartCallbacks.onVisualizeResultButtonClicked),!(null===(et=this.configuration.queryEditorCallbacks)||void 0===et)&&et.onCommandBarPopupButtonClick&&this.register(yt.OnCommandBarPopupButtonClick,function(){var je;return bt(null===(je=o.configuration.queryEditorCallbacks)||void 0===je?void 0:je.onCommandBarPopupButtonClick)(o.client)}),!(null===(Ye=this.configuration.queryEditorCallbacks)||void 0===Ye)&&Ye.onDiagramViewCommandBarPopupButtonClick&&this.register(yt.OnDiagramViewCommandBarPopupButtonClick,function(){var je;return bt(null===(je=o.configuration.queryEditorCallbacks)||void 0===je?void 0:je.onDiagramViewCommandBarPopupButtonClick)(o.client)}),!(null===(tt=this.configuration.queryEditorCallbacks)||void 0===tt)&&tt.onOpenInExcelButtonClick&&this.register(yt.OnOpenInExcelButtonClick,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorCallbacks)||void 0===Be?void 0:Be.onOpenInExcelButtonClick)(o.client,je)}),!(null===(Jo=this.configuration.queryEditorCallbacks)||void 0===Jo)&&Jo.validateQuery&&this.register(yt.ValidateQuery,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorCallbacks)||void 0===Be?void 0:Be.validateQuery)(o.client,je)}),!(null===(Yo=this.configuration.queryEditorCallbacks)||void 0===Yo)&&Yo.validateQueryNameInteractive&&this.register(yt.ValidateQueryNameInteractive,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorCallbacks)||void 0===Be?void 0:Be.validateQueryNameInteractive)(o.client,je)}),!(null===($o=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===$o)&&$o.onDownloadExcelFileButtonClick&&this.register(Mt.OnDownloadExcelFileButtonClick,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Be?void 0:Be.onDownloadExcelFileButtonClick)(je)}),!(null===(Zo=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Zo)&&Zo.onSaveAsTableButtonClick&&this.register(Mt.OnSaveAsTableButtonClick,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Be?void 0:Be.onSaveAsTableButtonClick)(je)}),!(null===(Xo=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Xo)&&Xo.onSaveAsViewButtonClick&&this.register(Mt.OnSaveAsViewButtonClick,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Be?void 0:Be.onSaveAsViewButtonClick)(je)}),!(null===(Ko=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Ko)&&Ko.onVisualizeResultsButtonClick&&this.register(Mt.OnVisualizeResultsButtonClick,function(je){var Be;return bt(null===(Be=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Be?void 0:Be.onVisualizeResultsButtonClick)(je)}),!(null===(ea=this.configuration.userSettingsStorageCallbacks)||void 0===ea)&&ea.getUserSettings&&this.register(Xt.GetUserSettings,this.configuration.userSettingsStorageCallbacks.getUserSettings),!(null===(ta=this.configuration.userSettingsStorageCallbacks)||void 0===ta)&&ta.setUserSettings&&this.register(Xt.SetUserSettings,this.configuration.userSettingsStorageCallbacks.setUserSettings),null!==(na=this.configuration.dataDiscoveryFormCallbacks)&&void 0!==na&&na.onSampleDataItemClick&&this.register(Mn.OnSampleDataItemClick,function(je){var Be;return bt(null===(Be=o.configuration.dataDiscoveryFormCallbacks)||void 0===Be?void 0:Be.onSampleDataItemClick)(je)})},n.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("getClientStartTime"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onAppReady"),this.unregister("onCancel"),this.unregister("onCommit"),this.unregister("onFlowReady"),this.unregister(On.GetEntityQueryScript),this.unregister(vn.GetInitialComputeEngineSettings),this.unregister(Tn.OnStateChanged),this.unregister(Nt.OnEvaluationEnded),this.unregister(Nt.OnEvaluationStarted),this.unregister(Nt.OnQueryScriptChange),this.unregister(Nt.OnTableSelectionChanged),this.unregister(fn.GetLoginSuccessRedirectUri),this.unregister(fn.OpenHostPopup),this.unregister(Cn.OnCommandExecuted),this.unregister(Nn.OnUnlinkConnection),this.unregister(it.GenerateNewEntityFieldNames),this.unregister(it.GenerateNewEntityNames),this.unregister(it.GetEntities),this.unregister(it.GetEntityFields),this.unregister(it.GetEntityKeys),this.unregister(it.ValidateMappingEditorResult),this.unregister(ht.GetEntityTypeFields),this.unregister(ht.GetEntityTypes),this.unregister(Bt.GetEntityDefinitionFromEntityPath),this.unregister(Bt.GetManifestDefinitionFromManifestPath),this.unregister(Bt.GetRootManifestDefinition),this.unregister(ut.GetMashupSensitivityLabel),this.unregister(ut.OnComputeEngineSettingsChanged),this.unregister(ut.OnEditingSessionMashupChanged),this.unregister(ut.OnEditingSessionMashupInitialized),this.unregister(ut.OnMashupEditorClick),this.unregister(ut.RenameMashup),this.unregister(Rt.OnNewSqlQueryButtonClicked),this.unregister(Rt.OnNewVisualQueryButtonClicked),this.unregister(Rt.OnSaveAsViewButtonClicked),this.unregister(Rt.OnViewSqlButtonClicked),this.unregister(Rt.OnVisualizeResultButtonClicked),this.unregister(yt.OnCommandBarPopupButtonClick),this.unregister(yt.OnDiagramViewCommandBarPopupButtonClick),this.unregister(yt.OnOpenInExcelButtonClick),this.unregister(yt.ValidateQuery),this.unregister(yt.ValidateQueryNameInteractive),this.unregister(Mt.OnDownloadExcelFileButtonClick),this.unregister(Mt.OnSaveAsTableButtonClick),this.unregister(Mt.OnSaveAsViewButtonClick),this.unregister(Mt.OnVisualizeResultsButtonClick),this.unregister(Xt.GetUserSettings),this.unregister(Xt.SetUserSettings),this.unregister(Mn.OnSampleDataItemClick)},n.register=function(o,d){this.clientRpcChannel.register(o,d)},n.unregister=function(o){this.clientRpcChannel.unregister(o)},e}();!function(e){e.ActivateQuery="activateQuery",e.AddQuery="addQuery",e.CancelAddQueriesFlow="cancelAddQueriesFlow",e.ClickCancelButton="clickCancelButton",e.ClickCommitButton="clickCommitButton",e.ClickCustomButton="clickCustomButton",e.ClickNextStageButton="clickNextStageButton",e.ClickPreviousStageButton="clickPreviousStageButton",e.CreateConnectionFlow_Commit="createConnectionFlow_commit",e.DataPreview_CancelCurrentQueryEvaluation="dataPreview_cancelCurrentQueryEvaluation",e.DataPreview_SelectColumns="dataPreview_selectColumns",e.DeleteAllQueries="deleteAllQueries",e.DisposeService="disposeService",e.EndFlow="endFlow",e.GetActiveQueryName="getActiveQueryName",e.GetCancelButtonLabel="getCancelButtonLabel",e.GetCommitButtonLabel="getCommitButtonLabel",e.GetCommitResult="getCommitResult",e.GetComputeEngineSettings="getComputeEngineSettings",e.GetCurrentFlow="getCurrentFlow",e.GetCustomButtonLabel="getCustomButtonLabel",e.GetDataSourceQueryScript="getDataSourceQueryScript",e.GetDataWizardFooter_ClickCancelButton="getDataWizardFooter_clickCancelButton",e.GetDataWizardFooter_ClickCommitButton="getDataWizardFooter_clickCommitButton",e.GetDataWizardFooter_ClickCustomButton="getDataWizardFooter_clickCustomButton",e.GetDataWizardFooter_ClickNextStageButton="getDataWizardFooter_clickNextStageButton",e.GetDataWizardFooter_ClickPreviousStageButton="getDataWizardFooter_clickPreviousStageButton",e.GetEditingSessionId="getEditingSessionId",e.GetEditingSessionMashup="getEditingSessionMashup",e.GetFooterMessage="getFooterMessage",e.GetGetDataWizardFlowStage="getGetDataWizardFlowStage",e.GetIncrementalRefreshSettings="getIncrementalRefreshSettings",e.GetMashupGatewayVersion="getMashupGatewayVersion",e.GetNextStageButtonLabel="getNextStageButtonLabel",e.GetPreviousStageButtonLabel="getPreviousStageButtonLabel",e.GetQueriesInfo="getQueriesInfo",e.GetQueryEditorState="getQueryEditorState",e.GetQueryEditorStateOrThrow="getQueryEditorStateOrThrow",e.GetQueryNames="getQueryNames",e.GetQueryScript="getQueryScript",e.GetReadyState="getReadyState",e.GetRefreshSettings="getRefreshSettings",e.GetSelectedStepName="getSelectedStepName",e.GetUserSettings="getUserSettings",e.IsCancelButtonEnabled="isCancelButtonEnabled",e.IsCancelButtonVisible="isCancelButtonVisible",e.IsCommitButtonEnabled="isCommitButtonEnabled",e.IsCommitButtonVisible="isCommitButtonVisible",e.IsCustomButtonEnabled="isCustomButtonEnabled",e.IsCustomButtonVisible="isCustomButtonVisible",e.IsDialogVisible="isDialogVisible",e.IsFeatureSupported="isFeatureSupported",e.IsFooterOverlayVisible="isFooterOverlayVisible",e.IsNextStageButtonEnabled="isNextStageButtonEnabled",e.IsNextStageButtonVisible="isNextStageButtonVisible",e.IsPreviousStageButtonEnabled="isPreviousStageButtonEnabled",e.IsPreviousStageButtonVisible="isPreviousStageButtonVisible",e.LogXFramePerformanceMarks="logXFramePerformanceMarks",e.OnHostPopupCancelled="onHostPopupCancelled",e.RefreshActiveQueryResult="refreshActiveQueryResult",e.SetCommitButtonEnabledStatePolicy="setCommitButtonEnabledStatePolicy",e.SetUserSettings="setUserSettings",e.StartFlow="startFlow",e.TrySetQueryScript="trySetQueryScript"}(l||(l={}));var $i=function(){function e(i){this.clientRpcChannel=i}var n=e.prototype;return n.activateQuery=function(o){return this.clientRpcChannel.call(l.ActivateQuery,[o])},n.addQuery=function(o,d,w){return this.clientRpcChannel.call(l.AddQuery,[o,d,w])},n.endFlow=function(){return this.clientRpcChannel.callIfSupported(l.EndFlow)},n.cancelAddQueriesFlow=function(){return this.clientRpcChannel.call(l.CancelAddQueriesFlow)},n.clickCancelButton=function(){return this.clientRpcChannel.call(l.ClickCancelButton)},n.clickCommitButton=function(){return this.clientRpcChannel.call(l.ClickCommitButton)},n.clickCustomButton=function(){return this.clientRpcChannel.call(l.ClickCustomButton)},n.clickNextStageButton=function(){return this.clientRpcChannel.call(l.ClickNextStageButton)},n.clickPreviousStageButton=function(){return this.clientRpcChannel.call(l.ClickPreviousStageButton)},n.createConnectionFlow_commit=function(o){return this.clientRpcChannel.call(l.CreateConnectionFlow_Commit,[o])},n.dataPreview_cancelCurrentQueryEvaluation=function(){return this.clientRpcChannel.call(l.DataPreview_CancelCurrentQueryEvaluation)},n.dataPreview_selectColumns=function(o){return this.clientRpcChannel.callIfSupported(l.DataPreview_SelectColumns,[o])},n.deleteAllQueries=function(){return this.clientRpcChannel.callIfSupported(l.DeleteAllQueries)},n.disposeService=function(){return this.clientRpcChannel.callIfSupported(l.DisposeService)},n.getActiveQueryName=function(){return this.clientRpcChannel.call(l.GetActiveQueryName)},n.getCancelButtonLabel=function(){return this.clientRpcChannel.call(l.GetCancelButtonLabel)},n.getCommitButtonLabel=function(){return this.clientRpcChannel.call(l.GetCommitButtonLabel)},n.getCustomButtonLabel=function(){return this.clientRpcChannel.call(l.GetCustomButtonLabel)},n.getCommitResult=function(){return this.clientRpcChannel.call(l.GetCommitResult)},n.getComputeEngineSettings=function(){return this.clientRpcChannel.call(l.GetComputeEngineSettings)},n.getCurrentFlow=function(){return this.clientRpcChannel.callIfSupported(l.GetCurrentFlow)},n.getDataSourceQueryScript=function(o,d){return this.clientRpcChannel.call(l.GetDataSourceQueryScript,[o,d])},n.getDataWizardFooter_clickCancelButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCancelButton)},n.getDataWizardFooter_clickCommitButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCommitButton)},n.getDataWizardFooter_clickCustomButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCustomButton)},n.getDataWizardFooter_clickNextStageButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickNextStageButton)},n.getDataWizardFooter_clickPreviousStageButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickPreviousStageButton)},n.getEditingSessionId=function(){return this.clientRpcChannel.call(l.GetEditingSessionId)},n.getEditingSessionMashup=function(o){return this.clientRpcChannel.call(l.GetEditingSessionMashup,[o])},n.getFooterMessage=function(){return this.clientRpcChannel.call(l.GetFooterMessage)},n.getGetDataWizardFlowStage=function(){return this.clientRpcChannel.callIfSupported(l.GetGetDataWizardFlowStage)},n.getIncrementalRefreshSettings=function(){return this.clientRpcChannel.call(l.GetIncrementalRefreshSettings)},n.getMashupGatewayVersion=function(){return this.clientRpcChannel.call(l.GetMashupGatewayVersion)},n.getNextStageButtonLabel=function(){return this.clientRpcChannel.call(l.GetNextStageButtonLabel)},n.getPreviousStageButtonLabel=function(){return this.clientRpcChannel.call(l.GetPreviousStageButtonLabel)},n.getQueriesInfo=function(){return this.clientRpcChannel.call(l.GetQueriesInfo)},n.getQueryEditorState=function(){return this.clientRpcChannel.call(l.GetQueryEditorState)},n.getQueryEditorStateOrThrow=function(){return this.clientRpcChannel.call(l.GetQueryEditorStateOrThrow)},n.getQueryNames=function(){return this.clientRpcChannel.call(l.GetQueryNames)},n.getQueryScript=function(o){return this.clientRpcChannel.call(l.GetQueryScript,[o])},n.getReadyState=function(){return this.clientRpcChannel.call(l.GetReadyState)},n.getRefreshSettings=function(){return this.clientRpcChannel.callIfSupported(l.GetRefreshSettings)},n.getSelectedStepName=function(){return this.clientRpcChannel.call(l.GetSelectedStepName)},n.getUserSettings=function(){return this.clientRpcChannel.call(l.GetUserSettings)},n.isCancelButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCancelButtonEnabled)},n.isCancelButtonVisible=function(){return this.clientRpcChannel.call(l.IsCancelButtonVisible)},n.isCommitButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCommitButtonEnabled)},n.isCommitButtonVisible=function(){return this.clientRpcChannel.call(l.IsCommitButtonVisible)},n.isCustomButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCustomButtonEnabled)},n.isCustomButtonVisible=function(){return this.clientRpcChannel.call(l.IsCustomButtonVisible)},n.isDialogVisible=function(){return this.clientRpcChannel.call(l.IsDialogVisible)},n.isFeatureSupported=function(o){return this.clientRpcChannel.call(l.IsFeatureSupported,[o])},n.isFooterOverlayVisible=function(){return this.clientRpcChannel.call(l.IsFooterOverlayVisible)},n.isNextStageButtonEnabled=function(){return this.clientRpcChannel.call(l.IsNextStageButtonEnabled)},n.isNextStageButtonVisible=function(){return this.clientRpcChannel.call(l.IsNextStageButtonVisible)},n.isPreviousStageButtonEnabled=function(){return this.clientRpcChannel.call(l.IsPreviousStageButtonEnabled)},n.isPreviousStageButtonVisible=function(){return this.clientRpcChannel.call(l.IsPreviousStageButtonVisible)},n.logXFramePerformanceMarks=function(o){return this.clientRpcChannel.call(l.LogXFramePerformanceMarks,[o])},n.onHostPopupCancelled=function(o){return this.clientRpcChannel.callIfSupported(l.OnHostPopupCancelled,[o])},n.refreshActiveQueryResult=function(){return this.clientRpcChannel.callIfSupported(l.RefreshActiveQueryResult)},n.setCommitButtonEnabledStatePolicy=function(o){return this.clientRpcChannel.call(l.SetCommitButtonEnabledStatePolicy,[o])},n.setUserSettings=function(o){return this.clientRpcChannel.callIfSupported(l.SetUserSettings,[o])},n.startFlow=function(o,d){return this.clientRpcChannel.callIfSupported(l.StartFlow,[o,d])},n.trySetQueryScript=function(o,d){return this.clientRpcChannel.call(l.TrySetQueryScript,[o,d])},e}(),Nr=G(37419),rr=function(){function e(){var i=this;this.resolveMethod=function(o){},this.rejectMethod=function(o){},this.promise=new Promise(function(o,d){i.resolveMethod=o,i.rejectMethod=d})}e.createResolvedDeferred=function(){var o=new e;return o.resolve(),o};var n=e.prototype;return n.resolve=function(o){this.resolveMethod(o)},n.reject=function(o){this.rejectMethod(o)},e}(),Zi=G(11105);function xr(){return Zi.Z()}function wn(){wn=function(){return n};var e,n={},i=Object.prototype,o=i.hasOwnProperty,d=Object.defineProperty||function(E,p,y){E[p]=y.value},w="function"==typeof Symbol?Symbol:{},H=w.iterator||"@@iterator",ae=w.asyncIterator||"@@asyncIterator",ne=w.toStringTag||"@@toStringTag";function te(E,p,y){return Object.defineProperty(E,p,{value:y,enumerable:!0,configurable:!0,writable:!0}),E[p]}try{te({},"")}catch{te=function(y,L,I){return y[L]=I}}function ue(E,p,y,L){var x=Object.create((p&&p.prototype instanceof pt?p:pt).prototype),oe=new Dt(L||[]);return d(x,"_invoke",{value:cn(E,y,oe)}),x}function xe(E,p,y){try{return{type:"normal",arg:E.call(p,y)}}catch(L){return{type:"throw",arg:L}}}n.wrap=ue;var st="suspendedStart",lt="suspendedYield",Et="executing",He="completed",Re={};function pt(){}function mt(){}function Ke(){}var Pt={};te(Pt,H,function(){return this});var At=Object.getPrototypeOf,vt=At&&At(At(Ft([])));vt&&vt!==i&&o.call(vt,H)&&(Pt=vt);var rt=Ke.prototype=pt.prototype=Object.create(Pt);function Gt(E){["next","throw","return"].forEach(function(p){te(E,p,function(y){return this._invoke(p,y)})})}function Ct(E,p){function y(I,x,oe,Ae){var Oe=xe(E[I],E,x);if("throw"!==Oe.type){var et=Oe.arg,Ye=et.value;return Ye&&"object"==typeof Ye&&o.call(Ye,"__await")?p.resolve(Ye.__await).then(function(tt){y("next",tt,oe,Ae)},function(tt){y("throw",tt,oe,Ae)}):p.resolve(Ye).then(function(tt){et.value=tt,oe(et)},function(tt){return y("throw",tt,oe,Ae)})}Ae(Oe.arg)}var L;d(this,"_invoke",{value:function(x,oe){function Ae(){return new p(function(Oe,et){y(x,oe,Oe,et)})}return L=L?L.then(Ae,Ae):Ae()}})}function cn(E,p,y){var L=st;return function(I,x){if(L===Et)throw new Error("Generator is already running");if(L===He){if("throw"===I)throw x;return{value:e,done:!0}}for(y.method=I,y.arg=x;;){var oe=y.delegate;if(oe){var Ae=Wt(oe,y);if(Ae){if(Ae===Re)continue;return Ae}}if("next"===y.method)y.sent=y._sent=y.arg;else if("throw"===y.method){if(L===st)throw L=He,y.arg;y.dispatchException(y.arg)}else"return"===y.method&&y.abrupt("return",y.arg);L=Et;var Oe=xe(E,p,y);if("normal"===Oe.type){if(L=y.done?He:lt,Oe.arg===Re)continue;return{value:Oe.arg,done:y.done}}"throw"===Oe.type&&(L=He,y.method="throw",y.arg=Oe.arg)}}}function Wt(E,p){var y=p.method,L=E.iterator[y];if(L===e)return p.delegate=null,"throw"===y&&E.iterator.return&&(p.method="return",p.arg=e,Wt(E,p),"throw"===p.method)||"return"!==y&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+y+"' method")),Re;var I=xe(L,E.iterator,p.arg);if("throw"===I.type)return p.method="throw",p.arg=I.arg,p.delegate=null,Re;var x=I.arg;return x?x.done?(p[E.resultName]=x.value,p.next=E.nextLoc,"return"!==p.method&&(p.method="next",p.arg=e),p.delegate=null,Re):x:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,Re)}function ln(E){var p={tryLoc:E[0]};1 in E&&(p.catchLoc=E[1]),2 in E&&(p.finallyLoc=E[2],p.afterLoc=E[3]),this.tryEntries.push(p)}function kt(E){var p=E.completion||{};p.type="normal",delete p.arg,E.completion=p}function Dt(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(ln,this),this.reset(!0)}function Ft(E){if(E||""===E){var p=E[H];if(p)return p.call(E);if("function"==typeof E.next)return E;if(!isNaN(E.length)){var y=-1,L=function I(){for(;++y<E.length;)if(o.call(E,y))return I.value=E[y],I.done=!1,I;return I.value=e,I.done=!0,I};return L.next=L}}throw new TypeError(typeof E+" is not iterable")}return mt.prototype=Ke,d(rt,"constructor",{value:Ke,configurable:!0}),d(Ke,"constructor",{value:mt,configurable:!0}),mt.displayName=te(Ke,ne,"GeneratorFunction"),n.isGeneratorFunction=function(E){var p="function"==typeof E&&E.constructor;return!!p&&(p===mt||"GeneratorFunction"===(p.displayName||p.name))},n.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,Ke):(E.__proto__=Ke,te(E,ne,"GeneratorFunction")),E.prototype=Object.create(rt),E},n.awrap=function(E){return{__await:E}},Gt(Ct.prototype),te(Ct.prototype,ae,function(){return this}),n.AsyncIterator=Ct,n.async=function(E,p,y,L,I){void 0===I&&(I=Promise);var x=new Ct(ue(E,p,y,L),I);return n.isGeneratorFunction(p)?x:x.next().then(function(oe){return oe.done?oe.value:x.next()})},Gt(rt),te(rt,ne,"Generator"),te(rt,H,function(){return this}),te(rt,"toString",function(){return"[object Generator]"}),n.keys=function(E){var p=Object(E),y=[];for(var L in p)y.push(L);return y.reverse(),function I(){for(;y.length;){var x=y.pop();if(x in p)return I.value=x,I.done=!1,I}return I.done=!0,I}},n.values=Ft,Dt.prototype={constructor:Dt,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(kt),!p)for(var y in this)"t"===y.charAt(0)&&o.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=e)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if("throw"===p.type)throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var y=this;function L(et,Ye){return oe.type="throw",oe.arg=p,y.next=et,Ye&&(y.method="next",y.arg=e),!!Ye}for(var I=this.tryEntries.length-1;I>=0;--I){var x=this.tryEntries[I],oe=x.completion;if("root"===x.tryLoc)return L("end");if(x.tryLoc<=this.prev){var Ae=o.call(x,"catchLoc"),Oe=o.call(x,"finallyLoc");if(Ae&&Oe){if(this.prev<x.catchLoc)return L(x.catchLoc,!0);if(this.prev<x.finallyLoc)return L(x.finallyLoc)}else if(Ae){if(this.prev<x.catchLoc)return L(x.catchLoc,!0)}else{if(!Oe)throw new Error("try statement without catch or finally");if(this.prev<x.finallyLoc)return L(x.finallyLoc)}}}},abrupt:function(p,y){for(var L=this.tryEntries.length-1;L>=0;--L){var I=this.tryEntries[L];if(I.tryLoc<=this.prev&&o.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var x=I;break}}x&&("break"===p||"continue"===p)&&x.tryLoc<=y&&y<=x.finallyLoc&&(x=null);var oe=x?x.completion:{};return oe.type=p,oe.arg=y,x?(this.method="next",this.next=x.finallyLoc,Re):this.complete(oe)},complete:function(p,y){if("throw"===p.type)throw p.arg;return"break"===p.type||"continue"===p.type?this.next=p.arg:"return"===p.type?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):"normal"===p.type&&y&&(this.next=y),Re},finish:function(p){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.finallyLoc===p)return this.complete(L.completion,L.afterLoc),kt(L),Re}},catch:function(p){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc===p){var I=L.completion;if("throw"===I.type){var x=I.arg;kt(L)}return x}}throw new Error("illegal catch attempt")},delegateYield:function(p,y,L){return this.delegate={iterator:Ft(p),resultName:y,nextLoc:L},"next"===this.method&&(this.arg=e),Re}},n}var ir="__SUPPORTS_METHOD__",or=function(){function e(i){var o=this;this.onMessageReceived=function(d){d.method?o.handleRequestMessageReceived(d):o.handleResponseMessageReceived(d)},this.options=i,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(ir,function(d){return o.handleSupportsMethodMessage(d)})}var n=e.prototype;return n.call=function(o,d){return this.internalCall(e.normalizeMethodName(o),d)},n.callIfSupported=function(o,d){return function(e,n,i,o){return new(i||(i=Promise))(function(w,H){function ae(ue){try{te(o.next(ue))}catch(xe){H(xe)}}function ne(ue){try{te(o.throw(ue))}catch(xe){H(xe)}}function te(ue){ue.done?w(ue.value):function(w){return w instanceof i?w:new i(function(H){H(w)})}(ue.value).then(ae,ne)}te((o=o.apply(e,n||[])).next())})}(this,void 0,void 0,wn().mark(function w(){return wn().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.next=2,this.supportsMethod(o);case 2:if(!ne.sent){ne.next=5;break}return ne.abrupt("return",this.call(o,d));case 5:return ne.abrupt("return",void 0);case 6:case"end":return ne.stop()}},w,this)}))},n.dispose=function(){this.internalUnregister(ir),this.requestDeferredByMessageId.forEach(function(o){return o.reject(function(e){var n=new Error("Rpc disposed");if(null!=n.stack)return n;try{throw n}catch(i){return i}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},n.register=function(o,d){var w=this,H=e.normalizeMethodName(o);this.internalRegister(H,function(){for(var ae,ne,te=arguments.length,ue=new Array(te),xe=0;xe<te;xe++)ue[xe]=arguments[xe];return null===(ne=(ae=w.options).onMethodInvoked)||void 0===ne||ne.call(ae,o,ue),d.apply(void 0,ue)})},n.supportsMethod=function(o){return this.internalCall(ir,[o])},n.unregister=function(o){var d=e.normalizeMethodName(o);this.internalUnregister(d)},n.canPostMessage=function(o){return this.ready},n.internalCall=function(o,d){void 0===d&&(d=void 0);var w=xr(),H={id:w,method:o,params:d},ae=new rr;return this.requestDeferredByMessageId.set(w,ae),this.canPostMessage(H)?this.tryPostMessage(H):this.queuedRequestMessages.push(H),ae.promise},n.internalRegister=function(o,d){if(this.methodCallbackMap.has(o))throw new Error("Rpc method with name '"+o+"' already registered.");this.methodCallbackMap.set(o,d)},n.internalUnregister=function(o){this.methodCallbackMap.delete(o)},n.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},e.getResponseMessageError=function(o){return o instanceof Error?{message:o.message,name:o.name,stack:o.stack}:o},e.normalizeMethodName=function(o){return o.toUpperCase()},n.flushRequestMessageQueue=function(){var o=this;this.queuedRequestMessages.forEach(function(d){return o.tryPostMessage(d)}),this.queuedRequestMessages=[]},n.handleRequestMessageReceived=function(o){var d=this,w=this.methodCallbackMap.get(o.method);if(w){var H={signature:o.signature,id:o.id};try{var ae=w.apply(this,o.params);Promise.resolve(ae).then(function(ne){H.result=ne,d.postMessage(H)}).catch(function(ne){H.error=e.getResponseMessageError(ne),d.postMessage(H)})}catch(ne){H.error=e.getResponseMessageError(ne),this.postMessage(H)}}},n.handleResponseMessageReceived=function(o){var d=o.id,w=this.requestDeferredByMessageId.get(d);w&&(o.error?w.reject(o.error):w.resolve(o.result),this.requestDeferredByMessageId.delete(d))},n.handleSupportsMethodMessage=function(o){return this.methodCallbackMap.has(e.normalizeMethodName(o))},n.postMessage=function(o){this.options.rpcWindow.postMessage(o)},n.tryPostMessage=function(o){try{this.postMessage(o)}catch(H){if(H instanceof Error){var d=o.id,w=this.requestDeferredByMessageId.get(d);w&&(w.reject(H),this.requestDeferredByMessageId.delete(d))}}},(0,we.Z)(e,[{key:"rpcHandshakeHandler",get:function(){return this.options.rpcHandshakeHandler}}]),e}(),ar=function(e){function n(o){var d;return(d=e.call(this,o)||this).clientOptions=o,d.internalRegister(o.rpcHandshakeHandler.getReadyMessageMethod(),function(){return d.handleReadyMessage()}),d}return(0,Nr.Z)(n,e),n.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},n}(or);function ci(e,n,i){var o;return e&&$t(e)&&e.hasOwnProperty(n)&&null!==(o=e[n])&&void 0!==o?o:i}function $t(e){return function(e){return null!==e&&"object"==typeof e}(e)&&!Array.isArray(e)&&e.constructor===Object}var bn=function(){function e(i){this.signature=i}var n=e.prototype;return n.deserialize=function(o){var d=o.data;return $t(d)?ci(d,"data",d):d},n.serialize=function(o){return o.signature=this.signature,{id:o.id,kind:ci(o,"method",e.emptyValue),signature:e.frameSignature,data:o}},e}();bn.emptyValue="",bn.frameSignature="FxFrameControl";var un,Er=function(){function e(){}var n=e.prototype;return n.createAckResponse=function(){return"start"},n.getReadyMessageMethod=function(){return"ready"},n.isAckResponse=function(o){return"start"===o},e}(),Pr=function(){function e(i){this.signature=i}var n=e.prototype;return n.deserialize=function(o){return o.data},n.serialize=function(o){return o.signature=this.signature,o},e}(),gi="__PONG__",Ar=function(){function e(){}var n=e.prototype;return n.createAckResponse=function(){return gi},n.getReadyMessageMethod=function(){return"__PING__"},n.isAckResponse=function(o){return o===gi},e}();!function(e){e.Default="default",e.AzurePortal_v1_0_0="azureportal-v1.0.0"}(un||(un={}));var ct=function(){function e(i){zt(i.targetWindow),zt(i.sourceWindow),this.options=i,this.eventListeners=new Map}var n=e.prototype;return n.addListener=function(o){var d=this;if(this.eventListeners.has(o))throw new Error("Duplicate rpc listener added.");var w=function(ae){return d.handleMessageReceived(ae,o)};this.eventListeners.set(o,w),this.options.sourceWindow.addEventListener(e.eventTypeName,w)},n.postMessage=function(o){var d=this.options.targetOriginProvider.getTargetOrigin(o);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(o),d)},n.removeListener=function(o){var d=this.eventListeners.get(o);d&&(this.options.sourceWindow.removeEventListener(e.eventTypeName,d),this.eventListeners.delete(o))},e.isMessageEvent=function(o){return!function(e){return null==e}(o.data)},n.canProcessMessage=function(o){return!!o&&o.signature===this.options.rpcMessageConverter.signature},n.handleMessageReceived=function(o,d){if(e.isMessageEvent(o)){var w=this.options.rpcMessageConverter.deserialize(o);this.canProcessMessage(w)&&this.options.allowedOrigins.some(function(H){return function(e,n){if("*"===n)return!0;if(n.startsWith("https://*.")&&e.startsWith("https://")){var o=n.substring(9);return e.substring(8).endsWith(o)}return e===n}(o.origin,H)})&&(this.options.targetOriginProvider.onMessageReceived(o.origin),d(w))}},e}();ct.eventTypeName="message";var zo=function(){function e(i){this.explicitTargetOrigin=i}var n=e.prototype;return n.getTargetOrigin=function(o){return this.explicitTargetOrigin},n.onMessageReceived=function(o){},e}();function Qo(e){var n=e.indexOf("#"),i=n>=0?e.substring(0,n):e,o=e.indexOf("?");return o>=0?i.substring(0,o):i}function vi(e){for(var i=e.indexOf("?")>-1?"&":"?",o=arguments.length,d=new Array(o>1?o-1:0),w=1;w<o;w++)d[w-1]=arguments[w];return""+e+i+d.map(function(ae){return encodeURIComponent(ae.name)+"="+encodeURIComponent(ae.value)}).join("&")}function jo(e){var n=e.indexOf("//");if(n>=0){var i=e.indexOf("/",n+=2);if(i>=0)return e.substring(0,i)}return e}function jt(){jt=function(){return n};var e,n={},i=Object.prototype,o=i.hasOwnProperty,d=Object.defineProperty||function(E,p,y){E[p]=y.value},w="function"==typeof Symbol?Symbol:{},H=w.iterator||"@@iterator",ae=w.asyncIterator||"@@asyncIterator",ne=w.toStringTag||"@@toStringTag";function te(E,p,y){return Object.defineProperty(E,p,{value:y,enumerable:!0,configurable:!0,writable:!0}),E[p]}try{te({},"")}catch{te=function(y,L,I){return y[L]=I}}function ue(E,p,y,L){var x=Object.create((p&&p.prototype instanceof pt?p:pt).prototype),oe=new Dt(L||[]);return d(x,"_invoke",{value:cn(E,y,oe)}),x}function xe(E,p,y){try{return{type:"normal",arg:E.call(p,y)}}catch(L){return{type:"throw",arg:L}}}n.wrap=ue;var st="suspendedStart",lt="suspendedYield",Et="executing",He="completed",Re={};function pt(){}function mt(){}function Ke(){}var Pt={};te(Pt,H,function(){return this});var At=Object.getPrototypeOf,vt=At&&At(At(Ft([])));vt&&vt!==i&&o.call(vt,H)&&(Pt=vt);var rt=Ke.prototype=pt.prototype=Object.create(Pt);function Gt(E){["next","throw","return"].forEach(function(p){te(E,p,function(y){return this._invoke(p,y)})})}function Ct(E,p){function y(I,x,oe,Ae){var Oe=xe(E[I],E,x);if("throw"!==Oe.type){var et=Oe.arg,Ye=et.value;return Ye&&"object"==typeof Ye&&o.call(Ye,"__await")?p.resolve(Ye.__await).then(function(tt){y("next",tt,oe,Ae)},function(tt){y("throw",tt,oe,Ae)}):p.resolve(Ye).then(function(tt){et.value=tt,oe(et)},function(tt){return y("throw",tt,oe,Ae)})}Ae(Oe.arg)}var L;d(this,"_invoke",{value:function(x,oe){function Ae(){return new p(function(Oe,et){y(x,oe,Oe,et)})}return L=L?L.then(Ae,Ae):Ae()}})}function cn(E,p,y){var L=st;return function(I,x){if(L===Et)throw new Error("Generator is already running");if(L===He){if("throw"===I)throw x;return{value:e,done:!0}}for(y.method=I,y.arg=x;;){var oe=y.delegate;if(oe){var Ae=Wt(oe,y);if(Ae){if(Ae===Re)continue;return Ae}}if("next"===y.method)y.sent=y._sent=y.arg;else if("throw"===y.method){if(L===st)throw L=He,y.arg;y.dispatchException(y.arg)}else"return"===y.method&&y.abrupt("return",y.arg);L=Et;var Oe=xe(E,p,y);if("normal"===Oe.type){if(L=y.done?He:lt,Oe.arg===Re)continue;return{value:Oe.arg,done:y.done}}"throw"===Oe.type&&(L=He,y.method="throw",y.arg=Oe.arg)}}}function Wt(E,p){var y=p.method,L=E.iterator[y];if(L===e)return p.delegate=null,"throw"===y&&E.iterator.return&&(p.method="return",p.arg=e,Wt(E,p),"throw"===p.method)||"return"!==y&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+y+"' method")),Re;var I=xe(L,E.iterator,p.arg);if("throw"===I.type)return p.method="throw",p.arg=I.arg,p.delegate=null,Re;var x=I.arg;return x?x.done?(p[E.resultName]=x.value,p.next=E.nextLoc,"return"!==p.method&&(p.method="next",p.arg=e),p.delegate=null,Re):x:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,Re)}function ln(E){var p={tryLoc:E[0]};1 in E&&(p.catchLoc=E[1]),2 in E&&(p.finallyLoc=E[2],p.afterLoc=E[3]),this.tryEntries.push(p)}function kt(E){var p=E.completion||{};p.type="normal",delete p.arg,E.completion=p}function Dt(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(ln,this),this.reset(!0)}function Ft(E){if(E||""===E){var p=E[H];if(p)return p.call(E);if("function"==typeof E.next)return E;if(!isNaN(E.length)){var y=-1,L=function I(){for(;++y<E.length;)if(o.call(E,y))return I.value=E[y],I.done=!1,I;return I.value=e,I.done=!0,I};return L.next=L}}throw new TypeError(typeof E+" is not iterable")}return mt.prototype=Ke,d(rt,"constructor",{value:Ke,configurable:!0}),d(Ke,"constructor",{value:mt,configurable:!0}),mt.displayName=te(Ke,ne,"GeneratorFunction"),n.isGeneratorFunction=function(E){var p="function"==typeof E&&E.constructor;return!!p&&(p===mt||"GeneratorFunction"===(p.displayName||p.name))},n.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,Ke):(E.__proto__=Ke,te(E,ne,"GeneratorFunction")),E.prototype=Object.create(rt),E},n.awrap=function(E){return{__await:E}},Gt(Ct.prototype),te(Ct.prototype,ae,function(){return this}),n.AsyncIterator=Ct,n.async=function(E,p,y,L,I){void 0===I&&(I=Promise);var x=new Ct(ue(E,p,y,L),I);return n.isGeneratorFunction(p)?x:x.next().then(function(oe){return oe.done?oe.value:x.next()})},Gt(rt),te(rt,ne,"Generator"),te(rt,H,function(){return this}),te(rt,"toString",function(){return"[object Generator]"}),n.keys=function(E){var p=Object(E),y=[];for(var L in p)y.push(L);return y.reverse(),function I(){for(;y.length;){var x=y.pop();if(x in p)return I.value=x,I.done=!1,I}return I.done=!0,I}},n.values=Ft,Dt.prototype={constructor:Dt,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(kt),!p)for(var y in this)"t"===y.charAt(0)&&o.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=e)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if("throw"===p.type)throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var y=this;function L(et,Ye){return oe.type="throw",oe.arg=p,y.next=et,Ye&&(y.method="next",y.arg=e),!!Ye}for(var I=this.tryEntries.length-1;I>=0;--I){var x=this.tryEntries[I],oe=x.completion;if("root"===x.tryLoc)return L("end");if(x.tryLoc<=this.prev){var Ae=o.call(x,"catchLoc"),Oe=o.call(x,"finallyLoc");if(Ae&&Oe){if(this.prev<x.catchLoc)return L(x.catchLoc,!0);if(this.prev<x.finallyLoc)return L(x.finallyLoc)}else if(Ae){if(this.prev<x.catchLoc)return L(x.catchLoc,!0)}else{if(!Oe)throw new Error("try statement without catch or finally");if(this.prev<x.finallyLoc)return L(x.finallyLoc)}}}},abrupt:function(p,y){for(var L=this.tryEntries.length-1;L>=0;--L){var I=this.tryEntries[L];if(I.tryLoc<=this.prev&&o.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var x=I;break}}x&&("break"===p||"continue"===p)&&x.tryLoc<=y&&y<=x.finallyLoc&&(x=null);var oe=x?x.completion:{};return oe.type=p,oe.arg=y,x?(this.method="next",this.next=x.finallyLoc,Re):this.complete(oe)},complete:function(p,y){if("throw"===p.type)throw p.arg;return"break"===p.type||"continue"===p.type?this.next=p.arg:"return"===p.type?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):"normal"===p.type&&y&&(this.next=y),Re},finish:function(p){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.finallyLoc===p)return this.complete(L.completion,L.afterLoc),kt(L),Re}},catch:function(p){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc===p){var I=L.completion;if("throw"===I.type){var x=I.arg;kt(L)}return x}}throw new Error("illegal catch attempt")},delegateYield:function(p,y,L){return this.delegate={iterator:Ft(p),resultName:y,nextLoc:L},"next"===this.method&&(this.arg=e),Re}},n}var Ci,Dr,wi,yi,Si,bi,Ei,Pi,Ai,ki,Di,Fi,Ri,En,Oi,Ti,Mi,Li,zn,Ni,Qn,jn,Pn,_i,It,xi,Vi,Ui,An,Fr,Hi,Ii,Gi,Rr,Bn,Wi,zi,Qi,kn,Dn,qn,Jn,Yn,$n,Zn,Xn,ji,Kn,er,tr,Or,t,r,s,u,a,c,g,v,C,m,h,k,D,j,Fe,q,T,J,re,Q,Te,Ge,St,ft,Tr,Bi,qo,Ka,es,ts,ns,rs,is,os,as,ss,us,cs,ls,ds,fs,ps,hs,gs,ms,vs,Cs,ws,ys,Ss,bs,Es,Ps,As,ks,Ds,Fs,Rs,Os,Ts,Wn=function(e,n,i,o){return new(i||(i=Promise))(function(w,H){function ae(ue){try{te(o.next(ue))}catch(xe){H(xe)}}function ne(ue){try{te(o.throw(ue))}catch(xe){H(xe)}}function te(ue){ue.done?w(ue.value):function(w){return w instanceof i?w:new i(function(H){H(w)})}(ue.value).then(ae,ne)}te((o=o.apply(e,n||[])).next())})},Bo=function(){function e(i){var d,w,H,o=this,ae=new Date;this.instanceId=xr(),this.configuration=i;var ne=null!==(d=this.configuration.clientSettings.clientEnvironment)&&void 0!==d?d:this.createDefaultClientEnvironment(this.configuration.clientSettings.container,this.configuration.clientSettings.className),te=[{name:Fn.ClientInstanceId,value:this.instanceId}];this.configuration.clientSettings.protocolId&&te.push({name:Fn.ProtocolId,value:this.configuration.clientSettings.protocolId});var ue=vi.apply(Se,[this.configuration.clientSettings.url].concat(te));this.appWindow=ne.appWindowFactory(ue);var xe=void 0!==this.configuration.clientSettings.allowedOrigin?this.configuration.clientSettings.allowedOrigin:"*",st=function(e,n){return n===un.AzurePortal_v1_0_0?{rpcMessageConverter:new bn(e),rpcHandshakeHandler:new Er}:{rpcMessageConverter:new Pr(e),rpcHandshakeHandler:new Ar}}(function(e){return null==e?"mspq":"mspq-"+e}(this.instanceId),null!==(w=this.configuration.clientSettings.protocolId)&&void 0!==w?w:un.Default);this.clientRpcChannel=new ar({debugName:"MashupEditorClient.clientRpcChannel",enableDebugLogging:null!==(H=this.configuration.clientSettings.enableDebugLogging)&&void 0!==H&&H,rpcHandshakeHandler:st.rpcHandshakeHandler,rpcWindow:new ct({allowedOrigins:[xe],rpcMessageConverter:st.rpcMessageConverter,sourceWindow:ne.clientWindow,targetOriginProvider:new zo(xe),targetWindow:this.appWindow})}),this.clientRpcEndpoint=new Yi(this.clientRpcChannel,{onCancelCurrentFlow:function(){return o.onCancelCurrentFlow()},onCommitCurrentFlow:function(Et){return o.onCommitCurrentFlow(Et)},onCurrentFlowReady:function(){return o.onCurrentFlowReady()},onAppReady:function(){return o.appReady.resolve()}},this,i,ae),this.serviceProxy=new $i(this.clientRpcChannel),this.appReady=new rr}var n=e.prototype;return n.activateQuery=function(o){return this.serviceProxy.activateQuery(o)},n.addQuery=function(o,d,w){return this.serviceProxy.addQuery(o,d,w)},n.deleteAllQueries=function(){return this.serviceProxy.deleteAllQueries()},n.onHostPopupCancelled=function(o){return this.serviceProxy.onHostPopupCancelled(o)},n.cancelAddQueriesFlow=function(){return this.serviceProxy.cancelAddQueriesFlow()},n.endFlow=function(){return this.appWindow.hide(),this.serviceProxy.endFlow()},n.getActiveQueryName=function(){return this.serviceProxy.getActiveQueryName()},n.getCommitResult=function(){return this.serviceProxy.getCommitResult()},n.getComputeEngineSettings=function(){return this.serviceProxy.getComputeEngineSettings()},n.getCurrentFlow=function(){return this.serviceProxy.getCurrentFlow()},n.getDataSourceQueryScript=function(o,d){return this.serviceProxy.getDataSourceQueryScript(o,d)},n.getEditingSessionId=function(){return this.serviceProxy.getEditingSessionId()},n.getEditingSessionMashup=function(o){return this.serviceProxy.getEditingSessionMashup(o)},n.getMashupGatewayVersion=function(){return this.serviceProxy.getMashupGatewayVersion()},n.getGetDataWizardFlowStage=function(){return this.serviceProxy.getGetDataWizardFlowStage()},n.getFooterMessage=function(){return this.serviceProxy.getFooterMessage()},n.getIncrementalRefreshSettings=function(){return this.serviceProxy.getIncrementalRefreshSettings()},n.getQueriesInfo=function(){return this.serviceProxy.getQueriesInfo()},n.getQueryEditorState=function(){return this.serviceProxy.getQueryEditorState()},n.getQueryEditorStateOrThrow=function(){return this.serviceProxy.getQueryEditorStateOrThrow()},n.getQueryNames=function(){return this.serviceProxy.getQueryNames()},n.getQueryScript=function(o){return this.serviceProxy.getQueryScript(o)},n.getReadyState=function(){return this.serviceProxy.getReadyState()},n.getRefreshSettings=function(){return this.serviceProxy.getRefreshSettings()},n.getSelectedStepName=function(){return this.serviceProxy.getSelectedStepName()},n.getUserSettings=function(){return this.serviceProxy.getUserSettings()},n.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},n.isFeatureSupported=function(o){return this.serviceProxy.isFeatureSupported(o)},n.isFooterOverlayVisible=function(){return this.serviceProxy.isFooterOverlayVisible()},n.logXFramePerformanceMarks=function(o){return this.serviceProxy.logXFramePerformanceMarks(o)},n.refreshActiveQueryResult=function(){return this.serviceProxy.refreshActiveQueryResult()},n.setCommitButtonEnabledStatePolicy=function(o){return this.serviceProxy.setCommitButtonEnabledStatePolicy(o)},n.setUserSettings=function(o){return this.serviceProxy.setUserSettings(o)},n.startFlow=function(o,d,w,H){return Wn(this,void 0,void 0,jt().mark(function ae(){return jt().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,this.ready;case 2:return ue.next=4,this.getCurrentFlow();case 4:if(null==ue.sent){ue.next=7;break}throw Error("cannot start a new flow when an existing flow is running");case 7:return this.currentFlowConfiguration={flowReady:new rr,shouldEndFlowOnCommit:V(o),shouldEndFlowOnCancel:$(o),onCommit:function(st,lt){if(z(lt,o))return d(st,lt);throw new Error("The flow "+o.kind+" returned the wrong type of result: "+lt.kind)},onCancel:w},this.appWindow.show(),this.serviceProxy.startFlow(o,H),ue.abrupt("return",this.currentFlowConfiguration.flowReady.promise);case 11:case"end":return ue.stop()}},ae,this)}))},n.dispose=function(){return Wn(this,void 0,void 0,jt().mark(function o(){return jt().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.appWindow.hide(),w.prev=1,w.next=4,this.serviceProxy.disposeService();case 4:return w.prev=4,this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.appWindow.dispose(),w.finish(4);case 9:case"end":return w.stop()}},o,this,[[1,,4,9]])}))},n.trySetQueryScript=function(o,d){return this.serviceProxy.trySetQueryScript(o,d)},n.createDefaultClientEnvironment=function(o,d){return{clientWindow:window,appWindowFactory:function(H){return new Lr(H,o,d)}}},n.onCancelCurrentFlow=function(){return Wn(this,void 0,void 0,jt().mark(function o(){return jt().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this.configuration.onCancel){w.next=2;break}return w.abrupt("return",this.configuration.onCancel(this));case 2:return zt(this.currentFlowConfiguration),w.next=5,this.currentFlowConfiguration.onCancel(this);case 5:this.currentFlowConfiguration.shouldEndFlowOnCancel&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return w.stop()}},o,this)}))},n.onCommitCurrentFlow=function(o){return Wn(this,void 0,void 0,jt().mark(function d(){return jt().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!this.configuration.onCommit){H.next=2;break}return H.abrupt("return",this.configuration.onCommit(this));case 2:return zt(this.currentFlowConfiguration),H.next=5,this.currentFlowConfiguration.onCommit(this,o);case 5:this.currentFlowConfiguration.shouldEndFlowOnCommit&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return H.stop()}},d,this)}))},n.onCurrentFlowReady=function(){zt(this.currentFlowConfiguration),this.currentFlowConfiguration.flowReady.resolve()},(0,we.Z)(e,[{key:"dataPreview",get:function(){var o=this;return{cancelCurrentEvaluation:function(){return o.serviceProxy.dataPreview_cancelCurrentQueryEvaluation()},selectColumns:function(w){return o.serviceProxy.dataPreview_selectColumns(w)}}}},{key:"getDataWizardFooterCallbacks",get:function(){var o=this;return{clickCancelButton:function(){return o.serviceProxy.getDataWizardFooter_clickCancelButton()},clickCommitButton:function(){return o.serviceProxy.getDataWizardFooter_clickCommitButton()},clickCustomButton:function(){return o.serviceProxy.getDataWizardFooter_clickCustomButton()},clickNextStageButton:function(){return o.serviceProxy.getDataWizardFooter_clickNextStageButton()},clickPreviousStageButton:function(){return o.serviceProxy.getDataWizardFooter_clickPreviousStageButton()}}}},{key:"cancelButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCancelButton()},getLabel:function(){return o.serviceProxy.getCancelButtonLabel()},isEnabled:function(){return o.serviceProxy.isCancelButtonEnabled()},isVisible:function(){return o.serviceProxy.isCancelButtonVisible()}}}},{key:"commitButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCommitButton()},getLabel:function(){return o.serviceProxy.getCommitButtonLabel()},isEnabled:function(){return o.serviceProxy.isCommitButtonEnabled()},isVisible:function(){return o.serviceProxy.isCommitButtonVisible()}}}},{key:"customButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCustomButton()},getLabel:function(){return o.serviceProxy.getCustomButtonLabel()},isEnabled:function(){return o.serviceProxy.isCustomButtonEnabled()},isVisible:function(){return o.serviceProxy.isCustomButtonVisible()}}}},{key:"nextStageButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickNextStageButton()},getLabel:function(){return o.serviceProxy.getNextStageButtonLabel()},isEnabled:function(){return o.serviceProxy.isNextStageButtonEnabled()},isVisible:function(){return o.serviceProxy.isNextStageButtonVisible()}}}},{key:"createConnectionFlowCallbacks",get:function(){var o=this;return{commit:function(w){return o.serviceProxy.createConnectionFlow_commit(w)}}}},{key:"previousStageButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickPreviousStageButton()},getLabel:function(){return o.serviceProxy.getPreviousStageButtonLabel()},isEnabled:function(){return o.serviceProxy.isPreviousStageButtonEnabled()},isVisible:function(){return o.serviceProxy.isPreviousStageButtonVisible()}}}},{key:"ready",get:function(){return this.appReady.promise}}]),e}();!function(e){e.Success="Success",e.Error_EmptyName="Error_EmptyName",e.Error_InvalidCharacters="Error_InvalidCharacters",e.Error_NameAlreadyExists="Error_NameAlreadyExists",e.Error_NameTooLong="Error_NameTooLong"}(Ci||(Ci={})),function(e){e.Cancel="Cancel",e.Commit="Commit"}(Dr||(Dr={})),function(e){e.AlwaysCancel="AlwaysCancel",e.AlwaysCommit="AlwaysCommit",e.Ask="Ask"}(wi||(wi={})),function(e){e.BuiltInCommand="BuiltInCommand",e.HostCommand="HostCommand"}(yi||(yi={})),function(e){e.Kusto="kusto",e.Sql="sql"}(Si||(Si={})),function(e){e.StepLabel="StepLabel",e.StepName="StepName"}(bi||(bi={})),function(e){e.CalculatedEntity="CalculatedEntity",e.Default="Default",e.LinkedEntity="LinkedEntity",e.Parameter="Parameter",e.Visual="Visual"}(Ei||(Ei={})),function(e){e.Data="Data",e.Schema="Schema"}(Pi||(Pi={})),function(e){e.None="None",e.Query="Query",e.Step="Step"}(Ai||(Ai={})),function(e){e.Critical="Critical",e.Error="Error"}(ki||(ki={})),function(e){e.AlwaysDisabled="AlwaysDisabled",e.Default="Default"}(Di||(Di={})),function(e){e.Cancelled="Cancelled",e.Completed="Completed",e.Failed="Failed",e.NotStarted="NotStarted",e.Running="Running"}(Fi||(Fi={})),function(e){e.Access="Access",e.Access_Monocolor="Access_Monocolor",e.ActiveDirectory="ActiveDirectory",e.AddFuzzyClusterColumn="AddFuzzyClusterColumn",e.AddRankColumn="AddRankColumn",e.AdobeAnalytics="AdobeAnalytics",e.AIInsights="AIInsights",e.AllFilled="AllFilled",e.AllRegular="AllRegular",e.Alternates="Alternates",e.AnyType="AnyType",e.AppendQueries="AppendQueries",e.AppendQueriesAsNew="AppendQueriesAsNew",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureFilled="AzureFilled",e.AzureHdInsightClusters="AzureHdInsightClusters",e.AzureRegular="AzureRegular",e.AzureSql="AzureSql",e.AzureSynapse="AzureSynapse",e.AzureTables="AzureTables",e.Binary="Binary",e.Blog="Blog",e.BlueLink="BlueLink",e.CalculatedEntity="CalculatedEntity",e.Calculator="Calculator",e.Cancel="Cancel",e.CancelRefresh="CancelRefresh",e.Cds="Cds",e.ChartClusteredBar="ChartClusteredBar",e.ChartClusteredColumn="ChartClusteredColumn",e.ChartLine="ChartLine",e.ChartPercentageStackedArea="ChartPercentageStackedArea",e.ChartPercentageStackedBar="ChartPercentageStackedBar",e.ChartPercentageStackedColumn="ChartPercentageStackedColumn",e.ChartStackedArea="ChartStackedArea",e.ChartStackedBar="ChartStackedBar",e.ChartStackedColumn="ChartStackedColumn",e.Checkmark="Checkmark",e.ChooseColumns="ChooseColumns",e.ClearFilter="ClearFilter",e.Close="Close",e.CloseAndLoad="CloseAndLoad",e.CloseAndLoadTo="CloseAndLoadTo",e.CloseRed="CloseRed",e.Column="Column",e.ColumnByExample="ColumnByExample",e.CombineFiles="CombineFiles",e.Community="Community",e.ConditionalColumn="ConditionalColumn",e.ConnectDatabase="ConnectDatabase",e.Copilot="Copilot",e.Copy="Copy",e.CountRows="CountRows",e.Cube="Cube",e.CubeAddAndExpandDimensionColumn="CubeAddAndExpandDimensionColumn",e.CubeCollapseAndRemoveColumns="CubeCollapseAndRemoveColumns",e.CubeDimension="CubeDimension",e.CubeDimensionAttribute="CubeDimensionAttribute",e.CubeDimensionHierarchy="CubeDimensionHierarchy",e.CubeMeasure="CubeMeasure",e.CubeServer="CubeServer",e.Currency="Currency",e.CustomColumn="CustomColumn",e.Cut="Cut",e.Database="Database",e.DatabaseClock="DatabaseClock",e.DatabaseDynamic="DatabaseDynamic",e.DatabaseFilled="DatabaseFilled",e.DatabaseLightning="DatabaseLightning",e.DatabaseOpaque="DatabaseOpaque",e.DatabaseRefresh="DatabaseRefresh",e.DatabaseRegular="DatabaseRegular",e.Databases="Databases",e.DatabaseUnknown="DatabaseUnknown",e.Dataflows="Dataflows",e.Dataverse="Dataverse",e.Date="Date",e.DateTime="DateTime",e.DateTimeZone="DateTimeZone",e.Delete="Delete",e.DeleteFile="DeleteFile",e.DemoteHeaders="DemoteHeaders",e.DetectDataType="DetectDataType",e.Diagram="Diagram",e.Documentation="Documentation",e.DragQueries="DragQueries",e.DragQueryGroups="DragQueryGroups",e.DuplicateColumn="DuplicateColumn",e.Duration="Duration",e.Dynamics365="Dynamics365",e.Empty="Empty",e.Entity="Entity",e.Error="Error",e.Excel="Excel",e.Excel_Monocolor="Excel_Monocolor",e.Exchange="Exchange",e.Exchange_Monocolor="Exchange_Monocolor",e.Expand="Expand",e.ExpandColumn="ExpandColumn",e.Fabric="Fabric",e.FabricFilled="FabricFilled",e.FabricRegular="FabricRegular",e.FastCopy="FastCopy",e.Feedback="Feedback",e.FeedbackExtremelyDissatisfied="FeedbackExtremelyDissatisfied",e.FeedbackExtremelySatisfied="FeedbackExtremelySatisfied",e.FeedbackSomewhatDissatisfied="FeedbackSomewhatDissatisfied",e.FeedbackSomewhatSatisfied="FeedbackSomewhatSatisfied",e.Fhir="Fhir",e.FileFilled="FileFilled",e.FileRegular="FileRegular",e.FillDown="FillDown",e.FillUp="FillUp",e.Filter="Filter",e.FitToView="FitToView",e.FluentView="FluentView",e.Folder="Folder",e.FormatText="FormatText",e.FullScreen="FullScreen",e.Function="Function",e.Gear="Gear",e.GetData="GetData",e.GoogleAnalytics="GoogleAnalytics",e.GoToColumn="GoToColumn",e.GridAutoFilter="GridAutoFilter",e.GridCombineFiles="GridCombineFiles",e.GridEditFilter="GridEditFilter",e.GridExpandColumn="GridExpandColumn",e.GridSortedAscending="GridSortedAscending",e.GridSortedDescending="GridSortedDescending",e.GroupBy="GroupBy",e.HorizontalLayout="HorizontalLayout",e.IndexColumn="IndexColumn",e.Info="Info",e.InsertColumnsLeft="InsertColumnsLeft",e.InsertColumnsRight="InsertColumnsRight",e.InsertRowsAbove="InsertRowsAbove",e.InsertRowsBelow="InsertRowsBelow",e.InvokeCustomFunction="InvokeCustomFunction",e.JoinKindFullOuter="JoinKindFullOuter",e.JoinKindInner="JoinKindInner",e.JoinKindLeftAnti="JoinKindLeftAnti",e.JoinKindLeftOuter="JoinKindLeftOuter",e.JoinKindRightAnti="JoinKindRightAnti",e.JoinKindRightOuter="JoinKindRightOuter",e.KeepBottomRows="KeepBottomRows",e.KeepDuplicates="KeepDuplicates",e.KeepErrors="KeepErrors",e.KeepRange="KeepRange",e.KeepTopRows="KeepTopRows",e.Key="Key",e.KeyboardShortcuts="KeyboardShortcuts",e.Kusto="Kusto",e.LightBulb="LightBulb",e.LinkedEntity="LinkedEntity",e.List="List",e.ListToTable="ListToTable",e.Load="Load",e.Logical="Logical",e.ManageConnections="ManageConnections",e.ManageDataSources="ManageDataSources",e.Map="Map",e.MapToEntity="MapToEntity",e.MashupGraphCollapse="MashupGraphCollapse",e.MashupGraphExpand="MashupGraphExpand",e.MashupGraphRelated="MashupGraphRelated",e.MathInfo="MathInfo",e.MergeColumns="MergeColumns",e.MergeQueries="MergeQueries",e.MergeQueriesAsNew="MergeQueriesAsNew",e.More="More",e.MoveColumns="MoveColumns",e.MoveColumnsLeft="MoveColumnsLeft",e.MoveColumnsRight="MoveColumnsRight",e.MoveColumnsToBeginning="MoveColumnsToBeginning",e.MoveColumnsToEnd="MoveColumnsToEnd",e.MoveDown="MoveDown",e.MoveLeft="MoveLeft",e.MoveRight="MoveRight",e.MoveUp="MoveUp",e.Neutral="Neutral",e.Number="Number",e.OData="OData",e.Odbc="Odbc",e.OnlineServicesFilled="OnlineServicesFilled",e.OnlineServicesRegular="OnlineServicesRegular",e.OtherFilled="OtherFilled",e.OtherRegular="OtherRegular",e.Parameter="Parameter",e.Parquet="Parquet",e.Parse="Parse",e.Paste="Paste",e.Pdf="Pdf",e.Pencil="Pencil",e.Percentage="Percentage",e.PivotColumn="PivotColumn",e.Plus="Plus",e.PowerBI="PowerBI",e.PowerBIReport="PowerBIReport",e.PowerPlatformFilled="PowerPlatformFilled",e.PowerPlatformRegular="PowerPlatformRegular",e.PowerQuery="PowerQuery",e.PrimitiveToList="PrimitiveToList",e.PrivacyBuffering="PrivacyBuffering",e.PromoteHeaders="PromoteHeaders",e.Properties="Properties",e.QuerySettings="QuerySettings",e.QuestionMark="QuestionMark",e.Record="Record",e.Reference="Reference",e.Refresh="Refresh",e.RemoveAlternateRows="RemoveAlternateRows",e.RemoveBlankRows="RemoveBlankRows",e.RemoveBottomRows="RemoveBottomRows",e.RemoveColumns="RemoveColumns",e.RemoveDuplicates="RemoveDuplicates",e.RemoveErrors="RemoveErrors",e.RemoveOtherColumns="RemoveOtherColumns",e.RemoveRows="RemoveRows",e.RemoveTopRows="RemoveTopRows",e.Rename="Rename",e.ReplaceErrors="ReplaceErrors",e.ReplaceValues="ReplaceValues",e.Reset="Reset",e.ReverseRows="ReverseRows",e.Rounding="Rounding",e.Salesforce="Salesforce",e.Save="Save",e.Scientific="Scientific",e.Script="Script",e.Sensitivity="Sensitivity",e.Settings="Settings",e.Share="Share",e.SharePoint="SharePoint",e.Sheet="Sheet",e.SheetAccess="SheetAccess",e.SheetCsv="SheetCsv",e.SheetDataflow="SheetDataflow",e.SheetExcel="SheetExcel",e.SheetHtml="SheetHtml",e.SheetJson="SheetJson",e.SheetSql="SheetSql",e.SheetText="SheetText",e.SheetXml="SheetXml",e.SortAscending="SortAscending",e.SortDescending="SortDescending",e.Spark="Spark",e.Sparkle="Sparkle",e.Sparkle_Monocolor="Sparkle_Monocolor",e.SplitColumn="SplitColumn",e.Standard="Standard",e.Statistics="Statistics",e.Success="Success",e.Suggestion="Suggestion",e.Support="Support",e.Table="Table",e.TableSchema="TableSchema",e.Template="Template",e.Text="Text",e.TextFile="TextFile",e.Time="Time",e.ToTable="ToTable",e.Transpose="Transpose",e.Trigonometry="Trigonometry",e.UnknownType="UnknownType",e.Unlink="Unlink",e.UnpivotColumns="UnpivotColumns",e.Vertica="Vertica",e.VerticalLayout="VerticalLayout",e.View="View",e.Visual="Visual",e.Wand="Wand",e.Warning="Warning",e.Web="Web",e.Website="Website",e.WholeNumber="WholeNumber",e.Worksheet="Worksheet"}(Ri||(Ri={})),function(e){e.FullRefresh="FullRefresh",e.IncrementalRefresh="IncrementalRefresh"}(En||(En={})),function(e){e.Days="Days",e.Months="Months",e.Quarters="Quarters",e.Years="Years"}(Oi||(Oi={})),function(e){e.Custom="Custom",e.Standard="Standard",e.System="System"}(Ti||(Ti={})),function(e){e.EvaluateTop1000Rows="EvaluateTop1000Rows",e.EvaluateEntireDataset="EvaluateEntireDataset"}(Mi||(Mi={})),function(e){e.Action="Action.Type",e.Any="Any.Type",e.Binary="Binary.Type",e.Byte="Byte.Type",e.Character="Character.Type",e.Currency="Currency.Type",e.Date="Date.Type",e.DateTime="DateTime.Type",e.DateTimeZone="DateTimeZone.Type",e.Decimal="Decimal.Type",e.Double="Double.Type",e.Duration="Duration.Type",e.Function="Function.Type",e.Int16="Int16.Type",e.Int32="Int32.Type",e.Int64="Int64.Type",e.Int8="Int8.Type",e.List="List.Type",e.Logical="Logical.Type",e.None="None.Type",e.Null="Null.Type",e.Number="Number.Type",e.Percentage="Percentage.Type",e.Record="Record.Type",e.Single="Single.Type",e.Table="Table.Type",e.Text="Text.Type",e.Time="Time.Type",e.Type="Type.Type"}(Li||(Li={})),function(e){e.MultiLine="MultiLine",e.SingleLine="SingleLine"}(zn||(zn={})),function(e){e.Always="Always",e.BasedOnProjectSettings="BasedOnProjectSettings",e.Never="Never"}(Ni||(Ni={})),function(e){e.Collapsed="Collapsed",e.Expanded="Expanded",e.Maximized="Maximized"}(Qn||(Qn={})),function(e){e.Host="Host",e.Initialization="Initialization",e.UserInteraction="UserInteraction"}(jn||(jn={})),function(e){e.Action="action",e.Any="any",e.AnyNonNull="anynonnull",e.Binary="binary",e.Currency="currency",e.Date="date",e.DateTime="datetime",e.DateTimeZone="datetimezone",e.Duration="duration",e.Exception="exception",e.Function="function",e.List="list",e.Logical="logical",e.None="none",e.Null="null",e.Number="number",e.Percentage="percentage",e.Record="record",e.Table="table",e.Text="text",e.Time="time",e.Type="type",e.WholeNumber="wholenumber"}(Pn||(Pn={})),function(e){e.Auto="Auto",e.Percent="Percent",e.Pixels="Pixels"}(_i||(_i={})),function(e){e.Cells="Cells",e.Columns="Columns",e.Rows="Rows"}(It||(It={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(xi||(xi={})),function(e){e.Extension="extension"}(Vi||(Vi={})),function(e){e.Failed="Failed",e.Idle="Idle",e.InProgress="InProgress",e.Success="Success"}(Ui||(Ui={})),function(e){e.WaitingToStart="WaitingToStart",e.EvaluatingRelationships="EvaluatingRelationships",e.WaitingForOtherEntities="WaitingForOtherEntities",e.EvaluatingSchema="EvaluatingSchema",e.DeletingEntity="DeletingEntity",e.CreatingEntity="CreatingEntity",e.DeletingExistingData="DeletingExistingData",e.EvaluatingData="EvaluatingData",e.ProvisioningTempStorage="ProvisioningTempStorage",e.UploadingDataToTempStorage="UploadingDataToTempStorage",e.InitializingLoadSession="InitializingLoadSession",e.WaitingForLoadSessionToInitialize="WaitingForLoadSessionToInitialize",e.CreatingDefinitionGroup="CreatingDefinitionGroup",e.CreatingDefinitionGroupDetails="CreatingDefinitionGroupDetails",e.UploadingData="UploadingData",e.GeneratingFieldMapping="GeneratingFieldMapping",e.AutoSequencing="AutoSequencing",e.ExecutingLoad="ExecutingLoad",e.WaitingForLoadToComplete="WaitingForLoadToComplete",e.GeneratingExecutionErrors="GeneratingExecutionErrors",e.Success="Success",e.SignInRequired="SignInRequired",e.DeletingExistingDataFailed="DeletingExistingDataFailed",e.EvaluationFailed="EvaluationFailed",e.CreatingEntityFailed="CreatingEntityFailed",e.DeletingEntityFailed="DeletingEntityFailed",e.RetrievingEntityMetadataFailed="RetrievingEntityMetadataFailed",e.Canceled="Canceled",e.LoadToCdsPartiallySucceeded="LoadToCdsPartiallySucceeded",e.LoadToCdsFailed="LoadToCdsFailed",e.LoadFailedDueToErrorInOtherEntity="LoadFailedDueToErrorInOtherEntity",e.Unknown="Unknown"}(An||(An={})),function(e){e.Composition="Composition",e.Conditional="Conditional",e.CountDistinctValues="CountDistinctValues",e.CountValues="CountValues",e.Date_Age="Date_Age",e.Date_CombineWithTime="Date_CombineWithTime",e.Date_Day="Date_Day",e.Date_DayOfWeek="Date_DayOfWeek",e.Date_DayOfWeekName="Date_DayOfWeekName",e.Date_DayOfYear="Date_DayOfYear",e.Date_DaysInMonth="Date_DaysInMonth",e.Date_Earliest="Date_Earliest",e.Date_EndOfDay="Date_EndOfDay",e.Date_EndOfMonth="Date_EndOfMonth",e.Date_EndOfQuarter="Date_EndOfQuarter",e.Date_EndOfWeek="Date_EndOfWeek",e.Date_EndOfYear="Date_EndOfYear",e.Date_From="Date_From",e.Date_Latest="Date_Latest",e.Date_Month="Date_Month",e.Date_MonthName="Date_MonthName",e.Date_QuarterOfYear="Date_QuarterOfYear",e.Date_StartOfDay="Date_StartOfDay",e.Date_StartOfMonth="Date_StartOfMonth",e.Date_StartOfQuarter="Date_StartOfQuarter",e.Date_StartOfWeek="Date_StartOfWeek",e.Date_StartOfYear="Date_StartOfYear",e.Date_SubtractDays="Date_SubtractDays",e.Date_WeekOfMonth="Date_WeekOfMonth",e.Date_WeekOfYear="Date_WeekOfYear",e.Date_Year="Date_Year",e.DateTime_Earliest="DateTime_Earliest",e.DateTime_From="DateTime_From",e.DateTime_Latest="DateTime_Latest",e.DateTime_Subtract="DateTime_Subtract",e.DateTime_SubtractDays="DateTime_SubtractDays",e.DateTimeZone_Earliest="DateTimeZone_Earliest",e.DateTimeZone_From="DateTimeZone_From",e.DateTimeZone_Latest="DateTimeZone_Latest",e.DateTimeZone_Subtract="DateTimeZone_Subtract",e.DateTimeZone_SubtractDays="DateTimeZone_SubtractDays",e.DateTimeZone_ToLocal="DateTimeZone_ToLocal",e.Number_Abs="Number_Abs",e.Number_Acos="Number_Acos",e.Number_Asin="Number_Asin",e.Number_Atan="Number_Atan",e.Number_Average="Number_Average",e.Number_Cos="Number_Cos",e.Number_Cube="Number_Cube",e.Number_Divide="Number_Divide",e.Number_Exp="Number_Exp",e.Number_Factorial="Number_Factorial",e.Number_From="Number_From",e.Number_IntegerDivide="Number_IntegerDivide",e.Number_IsEven="Number_IsEven",e.Number_IsOdd="Number_IsOdd",e.Number_Ln="Number_Ln",e.Number_Log10="Number_Log10",e.Number_Maximum="Number_Maximum",e.Number_Median="Number_Median",e.Number_Minimum="Number_Minimum",e.Number_Modulo="Number_Modulo",e.Number_MultiplyColumnAndConstant="Number_MultiplyColumnAndConstant",e.Number_MultiplyColumns="Number_MultiplyColumns",e.Number_PercentOf="Number_PercentOf",e.Number_Power="Number_Power",e.Number_Range="Number_Range",e.Number_Round="Number_Round",e.Number_RoundDown="Number_RoundDown",e.Number_RoundUp="Number_RoundUp",e.Number_Sign="Number_Sign",e.Number_Sin="Number_Sin",e.Number_Sqrt="Number_Sqrt",e.Number_Square="Number_Square",e.Number_StandardDeviation="Number_StandardDeviation",e.Number_Subtract="Number_Subtract",e.Number_SumColumnAndConstant="Number_SumColumnAndConstant",e.Number_SumColumns="Number_SumColumns",e.Number_Tan="Number_Tan",e.Reference="Reference",e.Text_AfterDelimiter="Text_AfterDelimiter",e.Text_BeforeDelimiter="Text_BeforeDelimiter",e.Text_BetweenDelimiters="Text_BetweenDelimiters",e.Text_Combine="Text_Combine",e.Text_End="Text_End",e.Text_Length="Text_Length",e.Text_Literal="Text_Literal",e.Text_Middle="Text_Middle",e.Text_Reference="Text_Reference",e.Text_Remove="Text_Remove",e.Text_Replace="Text_Replace",e.Text_Select="Text_Select",e.Text_Start="Text_Start",e.Time_Earliest="Time_Earliest",e.Time_EndOfHour="Time_EndOfHour",e.Time_From="Time_From",e.Time_Hour="Time_Hour",e.Time_Latest="Time_Latest",e.Time_Minute="Time_Minute",e.Time_Second="Time_Second",e.Time_StartOfHour="Time_StartOfHour",e.Time_Subtract="Time_Subtract"}(Fr||(Fr={})),function(e){e.UnknownError="UnknownError",e.InvalidConnectionProvider="InvalidConnectionProvider"}(Hi||(Hi={})),function(e){e.Adf="Adf",e.CdsA="CdsA",e.Desktop="Desktop",e.DmtsPowerBi="DmtsPowerBi",e.DmtsSa="DmtsSa",e.None="None",e.PowerApps="PowerApps",e.SelfHosted="SelfHosted"}(Ii||(Ii={})),function(e){e.SqlDw="SqlDw",e.SynapseOnDemand="SynapseOnDemand"}(Gi||(Gi={})),function(e){e.Error="Error",e.Warning="Warning"}(Rr||(Rr={})),function(e){e[e.sunday=0]="sunday",e[e.monday=1]="monday",e[e.tuesday=2]="tuesday",e[e.wednesday=3]="wednesday",e[e.thursday=4]="thursday",e[e.friday=5]="friday",e[e.saturday=6]="saturday"}(Bn||(Bn={})),function(e){e.Boolean="Boolean",e.DateAndTime="DateAndTime",e.DateOnly="DateOnly",e.Decimal="Decimal",e.Double="Double",e.Integer="Integer",e.Lookup="Lookup",e.Memo="Memo",e.Money="Money",e.String="String"}(Wi||(Wi={})),function(e){e.Resource="Resource",e.Personal="Personal",e.VirtualNetwork="VirtualNetwork"}(zi||(zi={})),function(e){e[e.none=0]="none",e[e.fetchDataSourceDetails=1]="fetchDataSourceDetails",e[e.schemaRowsets=2]="schemaRowsets",e[e.mdDataset=4]="mdDataset",e[e.columnOrdinals=8]="columnOrdinals",e[e.statefulSessions=16]="statefulSessions",e[e.directQuerySingleSignOn_Kerberos=32]="directQuerySingleSignOn_Kerberos",e[e.mashupCustomConnectors=64]="mashupCustomConnectors",e[e.mashupCustomConnectorsForODG=128]="mashupCustomConnectorsForODG",e[e.sapHanaSSOManagedProvider=256]="sapHanaSSOManagedProvider",e[e.filteringMashupExtensionsOnODG=512]="filteringMashupExtensionsOnODG",e[e.certifiedConnectors=1024]="certifiedConnectors",e[e.mashupAzureConnectorsCachingPool=2048]="mashupAzureConnectorsCachingPool",e[e.skipTestConnection=4096]="skipTestConnection",e[e.encryptedConnectionOptionOverride=8192]="encryptedConnectionOptionOverride",e[e.mashupADONetProviderSSO=16384]="mashupADONetProviderSSO",e[e.authTypeSAS=32768]="authTypeSAS",e[e.powerQueryOnlineCachingPool=65536]="powerQueryOnlineCachingPool",e[e.ssoTestConnection=131072]="ssoTestConnection",e[e.mashupIgnorePreviouslyCachedData=262144]="mashupIgnorePreviouslyCachedData",e[e.mashupQueryStatus=524288]="mashupQueryStatus",e[e.multipleResults=1048576]="multipleResults",e[e.renewDiagnosticsStorageAccess=2097152]="renewDiagnosticsStorageAccess",e[e.oAuthResource=4194304]="oAuthResource",e[e.statefulDbConnection=8388608]="statefulDbConnection",e[e.discoverDatasourcesUsingMashupDSR=16777216]="discoverDatasourcesUsingMashupDSR"}(Qi||(Qi={})),function(e){e.Critical="Critical",e.Error="Error",e.Warning="Warning",e.Informational="Informational",e.Verbose="Verbose"}(kn||(kn={})),function(e){e[e.connectionNotFound=0]="connectionNotFound",e[e.failedToRefreshConnection=1]="failedToRefreshConnection",e[e.unauthorizedConnection=2]="unauthorizedConnection"}(Dn||(Dn={})),function(e){e.DifferentUser="DifferentUser",e.NoMatchingConnection="NoMatchingConnection",e.NonOAuthConnection="NonOAuthConnection ",e.NoToken="NoToken"}(qn||(qn={})),function(e){e.Active="ActivePowerAppsEnvironment",e.HardDeleted="HardDeletedPowerAppsEnvironment",e.SoftDeleted="SoftDeletedPowerAppsEnvironment",e.Unknown="UnknownPowerAppsEnvironment"}(Jn||(Jn={})),function(e){e.MappingEditorProperties="MappingEditorProperties"}(Yn||(Yn={})),function(e){e[e.day=0]="day",e[e.month=1]="month",e[e.quarter=2]="quarter",e[e.year=3]="year"}($n||($n={})),function(e){e.Minutes="Minutes",e.Hours="Hours",e.Days="Days",e.Weeks="Weeks",e.Months="Months"}(Zn||(Zn={})),function(e){e[e.uploadFileMalformedMultipartContent=1]="uploadFileMalformedMultipartContent",e[e.uploadFileUnsupportedFileExtension=2]="uploadFileUnsupportedFileExtension",e[e.oAuthStartLoginFailed=3]="oAuthStartLoginFailed",e[e.oAuthFinishLoginFailed=4]="oAuthFinishLoginFailed",e[e.normalizeResourceFailed=8]="normalizeResourceFailed",e[e.editVersionMismatch=9]="editVersionMismatch",e[e.updateGatewayVersion=10]="updateGatewayVersion",e[e.mashupTooLong=11]="mashupTooLong",e[e.gatewayBindingMultipleMatchingGatewayError=12]="gatewayBindingMultipleMatchingGatewayError",e[e.gatewayBindingNoMatchingDataSourceError=13]="gatewayBindingNoMatchingDataSourceError",e[e.gatewayBindingNoMatchingGatewayError=14]="gatewayBindingNoMatchingGatewayError"}(Xn||(Xn={})),function(e){e.NoTextExampleFound="NoTextExampleFound",e.NoTextProgramFound="NoTextProgramFound",e.NoTextProgramFoundBeforeCancellation="NoTextProgramFoundBeforeCancellation",e.NoTextProgramFoundBeforeTimeout="NoTextProgramFoundBeforeTimeout"}(ji||(ji={})),function(e){e.Successful="Successful",e.Failed="Failed",e.SessionExpired="SessionExpired"}(Kn||(Kn={})),function(e){e.AM="AM",e.PM="PM"}(er||(er={})),function(e){e[e.anonymous=1]="anonymous",e[e.basic=2]="basic",e[e.oAuth2=3]="oAuth2",e[e.windows=4]="windows",e[e.key=5]="key",e[e.sas=6]="sas",e[e.servicePrincipal=7]="servicePrincipal"}(tr||(tr={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(Or||(Or={})),function(e){e.Automatic="Automatic",e.Explicit="Explicit",e.Fixed="Fixed"}(t||(t={})),function(e){e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(r||(r={})),function(e){e.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",e.AdfConnectionEvaluationError="AdfConnectionEvaluationError",e.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",e.ConnectionApiPolicyViolation="ConnectionApiPolicyViolation",e.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",e.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",e.ConnectionKindNotSupported="ConnectionKindNotSupported",e.ConnectionNotFound="ConnectionNotFound",e.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",e.DataAccessError="DataAccessError",e.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",e.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",e.DuplicateDataSourceNameError="DuplicateDataSourceNameError",e.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",e.ExceededLimit="ExceededLimit",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",e.InvalidCredentials="InvalidCredentials",e.InvalidPath="InvalidPath",e.OAuthLoginFailed="OAuthLoginFailed",e.OboSignInError="OboSignInError",e.OboTokenAcquisitionFailed="OboTokenAcquisitionFailed",e.TooManyConnections="TooManyConnections",e.UnknownDmtsError="UnknownDmtsError",e.UnknownError="UnknownError",e.UnknownGatewayError="UnknownGatewayError",e.Unsupported="Unsupported"}(s||(s={})),function(e){e.AddStep="AddStep",e.CreateQuery="CreateQuery",e.DeleteQuery="DeleteQuery",e.ExplainQuery="ExplainQuery",e.ExplainStep="ExplainStep"}(u||(u={})),function(e){e.CouldNotExplainQuery="CouldNotExplainQuery",e.CouldNotGenerateQuery="CouldNotGenerateQuery",e.CouldNotGenerateStep="CouldNotGenerateStep",e.DataItemsMissing="DataItemsMissing",e.LanguageNotSupported="LanguageNotSupported",e.OutOfScope="OutOfScope",e.QueryNotFound="QueryNotFound",e.SkillNotFound="SkillNotFound",e.TableNotFound="TableNotFound",e.Unknown="Unknown"}(a||(a={})),function(e){e.Action="Action",e.Error="Error"}(c||(c={})),function(e){e.Automatic="Automatic",e.Explicit="Explicit",e.Fixed="Fixed"}(g||(g={})),function(e){e.Singleton="Singleton",e.Database="Database",e.Uri="Uri",e.Custom="Custom"}(v||(v={})),function(e){e.BuiltIn="BuiltIn",e.Extension="Extension"}(C||(C={})),function(e){e.JsonDsr="JsonDsr",e.MScript="MScript",e.QueryModel="QueryModel"}(m||(m={})),function(e){e.DSR="DSR",e.Reference="Reference",e.Script="Script"}(h||(h={})),function(e){e.Cluster="Cluster",e.Database="Database",e.Lakehouse="Lakehouse",e.Object="Object",e.Schema="Schema",e.Server="Server",e.Table="Table",e.Warehouse="Warehouse",e.Workspace="Workspace"}(k||(k={})),function(e){e.Constant="Constant",e.Duplicate="Duplicate",e.Empty="Empty",e.Index="Index"}(D||(D={})),function(e){e[e.false=0]="false",e[e.true=1]="true",e[e.notApplicable=2]="notApplicable",e[e.existingConnection=3]="existingConnection"}(j||(j={})),function(e){e.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",e.Cancelled="Cancelled",e.DuplicateEvaluationId="DuplicateEvaluationId",e.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",e.EvaluationAgentNotFound="EvaluationAgentNotFound",e.EvaluationQuotaReached="EvaluationQuotaReached",e.ExternalServiceError="ExternalServiceError",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNeeded="GatewayNeeded",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayNotFound="GatewayNotFound",e.GatewayUnknownError="GatewayUnknownError",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUpgradeRequired="GatewayUpgradeRequired",e.GatewayUserError="GatewayUserError",e.MashupEntityNotFound="MashupEntityNotFound",e.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",e.NetworkAccessDenied="NetworkAccessDenied",e.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",e.ParameterNotFound="ParameterNotFound",e.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",e.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",e.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",e.QueryNotFound="QueryNotFound",e.StepNotFound="StepNotFound",e.UnableToContactBackend="UnableToContactBackend",e.Unknown="Unknown",e.UnsupportedKind="UnsupportedKind",e.ValueTooComplex="ValueTooComplex"}(Fe||(Fe={})),function(e){e.Path="Path",e.QueryScript="QueryScript"}(q||(q={})),function(e){e.AutoFilterColumnValues="AutoFilterColumnValues",e.BinaryMetadata="BinaryMetadata",e.ConnectorRows="ConnectorRows",e.ConnectorSchema="ConnectorSchema",e.CubeAllowedValues="CubeAllowedValues",e.CubeDisplayFolders="CubeDisplayFolders",e.CubeParameters="CubeParameters",e.DataSourceQuery="DataSourceQuery",e.DetailsPreview="DetailsPreview",e.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",e.DsrDetailsFetching="DsrDetailsFetching",e.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",e.ExpandColumnNames="ExpandColumnNames",e.FunctionBrowser="FunctionBrowser",e.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",e.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",e.LoadToCdsRelationships="LoadToCdsRelationships",e.LoadToCdsSchema="LoadToCdsSchema",e.MappingEditorQueryProfiling="MappingEditorQueryProfiling",e.MappingEditorSchemaResult="MappingEditorSchemaResult",e.MappingEditorTypeMetadata="MappingEditorTypeMetadata",e.MashupLoad="MashupLoad",e.MergeMatchAnalysis="MergeMatchAnalysis",e.MergeQueriesPreview="MergeQueriesPreview",e.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",e.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",e.NaturalLanguageValidation="NaturalLanguageValidation",e.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",e.NavigatorCubeParameters="NavigatorCubeParameters",e.NavigatorCubePreview="NavigatorCubePreview",e.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",e.NavigatorPreview="NavigatorPreview",e.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",e.Preview="Preview",e.QueryAnalysis="QueryAnalysis",e.QueryPlan="QueryPlan",e.QuerySanitizer="QuerySanitizer",e.QuerySanitizerAnalysis="QuerySanitizerAnalysis",e.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",e.QueryScriptPreview="QueryScriptPreview",e.SemanticEntitySets="SemanticEntitySets",e.SemanticDataGetData="SemanticDataGetData",e.SemanticDataList="SemanticDataList",e.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",e.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",e.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",e.StepAnalysis="StepAnalysis",e.TableProfiler="TableProfiler",e.TextByExampleGetText="TextByExampleGetText",e.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",e.WebByExampleGetHtml="WebByExampleGetHtml"}(T||(T={})),function(e){e.None="None",e.Any="Any",e.Access="Access",e.Excel="Excel",e.Json="Json",e.TextCsv="TextCsv",e.Pdf="Pdf",e.Xml="Xml"}(J||(J={})),function(e){e.List="List"}(re||(re={})),function(e){e.MenuItem="MenuItem",e.Separator="Separator"}(Q||(Q={})),function(e){e.Max="Max",e.Mean="Mean",e.Min="Min",e.Mode="Mode",e.RoundedMean="RoundedMean"}(Te||(Te={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}(Ge||(Ge={})),function(e){e.Database="Database",e.File="File"}(St||(St={})),function(e){e.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",e.BasedOnMetadata="BasedOnMetadata",e.Never="Never"}(ft||(ft={})),function(e){e.Always="Always",e.Never="Never",e.HasNewLoadableQueries="HasNewLoadableQueries",e.NumberOfQueries="NumberOfQueries"}(Tr||(Tr={})),function(e){e.Equals="Equals",e.GreaterThan="GreaterThan",e.GreaterThanOrEqual="GreaterThanOrEqual",e.LessThan="LessThan",e.LessThanOrEqual="LessThanOrEqual"}(Bi||(Bi={})),function(e){e.Adf="Adf",e.Athena="Athena",e.CdsA="CdsA",e.CdsLite="CdsLite",e.CdsT="CdsT",e.CdsV1="CdsAdHoc",e.CustomerInsights="CustomerInsights",e.CustomerInsightsPPDF="CustomerInsightsPPDF",e.D365TalentInsights="D365TalentInsights",e.DataIntegration="DataIntegration",e.DesktopBootstrap="DesktopBootstrap",e.DesktopUITester="DesktopUITester",e.DmtsPowerBiExperimental="DmtsPowerBiExperimental",e.DmtsSaExperimental="DmtsSaExperimental",e.ExcelDesktop="ExcelDesktop",e.ExcelOnline="ExcelOnline",e.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",e.Experimental="Experimental",e.Flow="Flow",e.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",e.IntelligentOrderManagement="IntelligentOrderManagement",e.InternalPortal="InternalPortal",e.KustoViewDesigner="KustoViewDesigner",e.MashupEditorBootstrap="MashupEditorBootstrap",e.PowerAppsTeams="PowerAppsTeams",e.PowerBIDataMart="PowerBIDataMart",e.PowerBIModeling="PowerBIModeling",e.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",e.PowerBIPaginatedReports="PowerBIPaginatedReports",e.PowerBIPPDF="PowerBIPPDF",e.PowerBIReportView="PowerBIReportView",e.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",e.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",e.PowerPlatformExperimental="PowerPlatformExperimental",e.PowerQueryDesktop="PowerQueryDesktop",e.ProcessAdvisor="ProcessAdvisor",e.SupplyChainVisibility="SupplyChainVisibility",e.SustainabilityCloud="SustainabilityCloud",e.Synapse="Synapse",e.TridentDataflow="TridentDataflow",e.TridentDataPipeline="TridentDataPipeline",e.TridentDataverseOneLake="TridentDataverseOneLake",e.TridentDataWarehouse="TridentDataWarehouse",e.TridentEventStream="TridentEventStream",e.TridentKusto="TridentKusto",e.TridentLakehouse="TridentLakehouse",e.TridentLakeWarehouse="TridentLakeWarehouse",e.TridentMountedDataWarehouse="TridentMountedDataWarehouse",e.TridentOneLake="TridentOneLake",e.TridentReplicator="TridentReplicator",e.TridentSynapseLink="TridentSynapseLink"}(qo||(qo={})),function(e){e.Boolean="Boolean"}(Ka||(Ka={})),function(e){e.NaN="NaN",e.NegativeInfinity="NegativeInfinity",e.PositiveInfinity="PositiveInfinity",e.FormattedNumber="FormattedNumber",e.Number="Number"}(es||(es={})),function(e){e.Access="Access",e.ActiveDirectory="ActiveDirectory",e.AdoDotNet="AdoDotNet",e.AdobeAnalytics="AdobeAnalytics",e.AnalysisServices="AnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.Cdpa="CDPA",e.CurrentWorkbook="CurrentWorkbook",e.DB2="DB2",e.Environment="Environment",e.Essbase="Essbase",e.Exchange="Exchange",e.File="File",e.Folder="Folder",e.Ftp="Ftp",e.GoogleAnalytics="GoogleAnalytics",e.HDInsight="HDInsight",e.Hdfs="Hdfs",e.Informix="Informix",e.MQ="MQ",e.MicrosoftInformationProtection="MicrosoftInformationProtection",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.OleDb="OleDb",e.Oracle="Oracle",e.PostgreSQL="PostgreSQL",e.PowerBIDataflow="PowerBI",e.Python="Python",e.R="R",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Spark="Spark",e.Sql="SQL",e.Staging="Staging",e.Sybase="Sybase",e.Teradata="Teradata",e.Web="Web"}(ts||(ts={})),function(e){e.TemplateMetadata="Metadata.json",e.MashupDocument="MashupDocument.pq",e.MashupMetadata="MashupMetadata.json"}(ns||(ns={})),function(e){e.GroupNestingLimitReached="GroupNestingLimitReached",e.NullMashupXml="NullMashupXml",e.Unknown="Unknown"}(rs||(rs={})),function(e){e.CompletedSuccessfully="CompletedSuccessfully",e.CompletedWithExpectedError="CompletedWithExpectedError",e.CompletedWithUnexpectedError="CompletedWithUnexpectedError",e.Started="Started"}(is||(is={})),function(e){e.Above="Above",e.Below="Below"}(os||(os={})),function(e){e.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",e.NoProgramFound="NoProgramFound",e.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",e.RequestCanceled="RequestCanceled"}(as||(as={})),function(e){e.Ascii="Ascii",e.Utf8="Utf8",e.Utf16="Utf16",e.Windows="Windows"}(ss||(ss={})),function(e){e.Excel="Excel",e.Json="Json",e.Parquet="Parquet",e.Text="Text"}(us||(us={})),function(e){e.Colon="Colon",e.Comma="Comma",e.None="None",e.Semicolon="Semicolon",e.Space="Space",e.Tab="Tab"}(cs||(cs={})),function(e){e.Even="Even",e.Odd="Odd"}(ls||(ls={})),function(e){e.None="None",e.Private="Private",e.Organizational="Organizational",e.Public="Public"}(ds||(ds={})),function(e){e.ChangeModes="ChangeModes"}(fs||(fs={})),function(e){e.QueryNeedsToFold="QueryNeedsToFold"}(ps||(ps={})),function(e){e.AzureBlob="AzureBlob",e.Database="Database"}(hs||(hs={})),function(e){e.DynamicPlanFolded="DynamicPlanFolded",e.DynamicPlanMightFold="DynamicPlanMightFold",e.DynamicPlanNotFolded="DynamicPlanNotFolded",e.DynamicPlanOpaque="DynamicPlanOpaque",e.ErrorRetrievingPlan="ErrorRetrievingPlan",e.FoldedQueryNotImplemented="FoldedQueryNotImplemented",e.FoldedQueryNull="FoldedQueryNull",e.FoldedWithQuery="FoldedWithQuery",e.NotFolded="NotFolded",e.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",e.NotTable="NotTable",e.OpaqueConstant="OpaqueConstant",e.UnexpectedPlanKind="UnexpectedPlanKind"}(gs||(gs={})),function(e){e.ActiveDirectory="ActiveDirectory",e.AdobeAnalytics="AdobeAnalytics",e.AmazonRedshift="AmazonRedshift",e.AnalysisServices="AnalysisServices",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataExplorer="AzureDataExplorer",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.AIFunctions="AIFunctions",e.AIInsights="AIInsights",e.AzureMLFunctions="AzureMLFunctions",e.AIInsightsInProc="AIInsightsInProc",e.Cds="Cds",e.CommonDataService="CommonDataService",e.DataLake="DataLake",e.Dataverse="Dataverse",e.DB2="DB2",e.ElasticSearch="ElasticSearch",e.Exchange="Exchange",e.Fhir="Fhir",e.File="File",e.Folder="Folder",e.GoogleAnalytics="GoogleAnalytics",e.GoogleBigQuery="GoogleBigQuery",e.HDInsight="HDInsight",e.Impala="Impala",e.Kusto="Kusto",e.Lakehouse="Lakehouse",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.Oracle="Oracle",e.OracleERP="OracleERP",e.PostgreSQL="PostgreSQL",e.PowerBI="PowerBI",e.PowerBIDatamarts="PowerBIDatamarts",e.PowerPlatformDataflows="PowerPlatformDataflows",e.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SAPERP="SAPERP",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Snowflake="Snowflake",e.Spark="Spark",e.SQL="SQL",e.Sybase="Sybase",e.Teradata="Teradata",e.Vertica="Vertica",e.Warehouse="Warehouse",e.Web="Web"}(ms||(ms={})),function(e){e.CompilationError="CompilationError",e.InvalidQueryName="InvalidQueryName",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(vs||(vs={})),function(e){e.Failure="Failure",e.Success="Success"}(Cs||(Cs={})),function(e){e[e.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",e[e.httpError=1]="httpError",e[e.invalidInput=2]="invalidInput",e[e.maxRetriesReached=3]="maxRetriesReached",e[e.modelError=4]="modelError"}(ws||(ws={})),function(e){e.Error="Error",e.Ok="Ok"}(ys||(ys={})),function(e){e.Default="Default",e.FastCopy="FastCopy"}(Ss||(Ss={})),function(e){e.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",e.DuplicateQueryId="DuplicateQueryId",e.DuplicateQueryName="DuplicateQueryName",e.DuplicateStepName="DuplicateStepName",e.InvalidQueryName="InvalidQueryName",e.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",e.ParsingError="ParsingError",e.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(bs||(bs={})),function(e){e.Custom="Custom",e.DropColumn="DropColumn",e.DropBlankRows="DropBlankRows",e.DropDuplicates="DropDuplicates",e.FillColumn="FillColumn",e.SplitColumn="SplitColumn",e.UnpivotColumns="UnpivotColumns",e.UnpivotOtherColumns="UnpivotOtherColumns"}(Es||(Es={})),function(e){e.Column="Column",e.ColumnType="ColumnType",e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(Ps||(Ps={})),function(e){e.AppendRows="AppendRows",e.ReplaceRows="ReplaceRows",e.UpsertRows="UpsertRows"}(As||(As={})),function(e){e.SelectRows="SelectRows",e.Sort="Sort",e.SelectColumns="SelectColumns",e.RenameColumns="RenameColumns",e.AddColumn="AddColumn",e.ReplaceColumns="ReplaceColumns",e.ReplaceRows="ReplaceRows",e.AddRows="AddRows",e.SplitColumn="SplitColumn",e.ReplaceTable="ReplaceTable"}(ks||(ks={})),function(e){e.InvocationPattern="InvocationPattern",e.Script="Script"}(Ds||(Ds={})),function(e){e.DataSourceTag="DataSourceTag",e.QueryEditorMessageBar="QueryEditorMessageBar",e.QuickCreateForm="QuickCreateForm",e.WebByExampleForm="WebByExampleForm"}(Fs||(Fs={})),function(e){e.Append="Append",e.Replace="Replace"}(Rs||(Rs={})),function(e){e.CompilationError="CompilationError",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Os||(Os={})),function(e){e.Link="Link",e.Text="Text"}(Ts||(Ts={}))},62113:function(Me,$e,G){"use strict";G.d($e,{Q:function(){return ge}});var F,P,Se=G(81337),ce=G(29019),R=G(66422),X=G(37241),ke=G(41170),W_clientInfoDecodingError_code="client_info_decoding_error",W_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",W_clientInfoEmptyError_code="client_info_empty_error",W_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",W_tokenParsingError_code="token_parsing_error",W_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",W_nullOrEmptyToken_code="null_or_empty_token",W_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",W_endpointResolutionError_code="endpoints_resolution_error",W_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",W_networkError_code="network_error",W_networkError_desc="Network request failed. Please check network trace to determine root cause.",W_unableToGetOpenidConfigError_code="openid_config_error",W_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",W_hashNotDeserialized_code="hash_not_deserialized",W_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",W_invalidStateError_code="invalid_state",W_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",W_stateMismatchError_code="state_mismatch",W_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",W_stateNotFoundError_code="state_not_found",W_stateNotFoundError_desc="State not found",W_nonceMismatchError_code="nonce_mismatch",W_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",W_nonceNotFoundError_code="nonce_not_found",W_nonceNotFoundError_desc="nonce not found",W_multipleMatchingTokens_code="multiple_matching_tokens",W_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",W_multipleMatchingAccounts_code="multiple_matching_accounts",W_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",W_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",W_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",W_tokenRequestCannotBeMade_code="request_cannot_be_made",W_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",W_appendEmptyScopeError_code="cannot_append_empty_scope",W_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",W_removeEmptyScopeError_code="cannot_remove_empty_scope",W_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",W_appendScopeSetError_code="cannot_append_scopeset",W_appendScopeSetError_desc="Cannot append ScopeSet due to error.",W_emptyInputScopeSetError_code="empty_input_scopeset",W_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",W_DeviceCodePollingCancelled_code="device_code_polling_cancelled",W_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",W_DeviceCodeExpired_code="device_code_expired",W_DeviceCodeExpired_desc="Device code is expired.",W_DeviceCodeUnknownError_code="device_code_unknown_error",W_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",W_NoAccountInSilentRequest_code="no_account_in_silent_request",W_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",W_invalidCacheRecord_code="invalid_cache_record",W_invalidCacheRecord_desc="Cache record object was null or undefined.",W_invalidCacheEnvironment_code="invalid_cache_environment",W_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",W_noAccountFound_code="no_account_found",W_noAccountFound_desc="No account found in cache for given key.",W_CachePluginError_code="no cache plugin set on CacheManager",W_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",W_noCryptoObj_code="no_crypto_object",W_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",W_invalidCacheType_code="invalid_cache_type",W_invalidCacheType_desc="Invalid cache type",W_unexpectedAccountType_code="unexpected_account_type",W_unexpectedAccountType_desc="Unexpected account type.",W_unexpectedCredentialType_code="unexpected_credential_type",W_unexpectedCredentialType_desc="Unexpected credential type.",W_invalidAssertion_code="invalid_assertion",W_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",W_invalidClientCredential_code="invalid_client_credential",W_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",W_tokenRefreshRequired_code="token_refresh_required",W_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",W_userTimeoutReached_code="user_timeout_reached",W_userTimeoutReached_desc="User defined timeout for device code polling reached",W_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",W_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",W_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",W_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",W_bindingKeyNotRemovedError_code="binding_key_not_removed",W_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",W_logoutNotSupported_code="end_session_endpoint_not_supported",W_logoutNotSupported_desc="Provided authority does not support logout.",W_keyIdMissing_code="key_id_missing",W_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",Ue=function(P){function b(V,$){var Pe=P.call(this,V,$)||this;return Pe.name="ClientAuthError",Object.setPrototypeOf(Pe,b.prototype),Pe}return(0,X.ZT)(b,P),b.createClientInfoDecodingError=function(V){return new b(W_clientInfoDecodingError_code,W_clientInfoDecodingError_desc+" Failed with error: "+V)},b.createClientInfoEmptyError=function(){return new b(W_clientInfoEmptyError_code,""+W_clientInfoEmptyError_desc)},b.createTokenParsingError=function(V){return new b(W_tokenParsingError_code,W_tokenParsingError_desc+" Failed with error: "+V)},b.createTokenNullOrEmptyError=function(V){return new b(W_nullOrEmptyToken_code,W_nullOrEmptyToken_desc+" Raw Token Value: "+V)},b.createEndpointDiscoveryIncompleteError=function(V){return new b(W_endpointResolutionError_code,W_endpointResolutionError_desc+" Detail: "+V)},b.createNetworkError=function(V,$){return new b(W_networkError_code,W_networkError_desc+" | Fetch client threw: "+$+" | Attempted to reach: "+V.split("?")[0])},b.createUnableToGetOpenidConfigError=function(V){return new b(W_unableToGetOpenidConfigError_code,W_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+V)},b.createHashNotDeserializedError=function(V){return new b(W_hashNotDeserialized_code,W_hashNotDeserialized_desc+" Given Object: "+V)},b.createInvalidStateError=function(V,$){return new b(W_invalidStateError_code,W_invalidStateError_desc+" Invalid State: "+V+", Root Err: "+$)},b.createStateMismatchError=function(){return new b(W_stateMismatchError_code,W_stateMismatchError_desc)},b.createStateNotFoundError=function(V){return new b(W_stateNotFoundError_code,W_stateNotFoundError_desc+":  "+V)},b.createNonceMismatchError=function(){return new b(W_nonceMismatchError_code,W_nonceMismatchError_desc)},b.createNonceNotFoundError=function(V){return new b(W_nonceNotFoundError_code,W_nonceNotFoundError_desc+":  "+V)},b.createMultipleMatchingTokensInCacheError=function(){return new b(W_multipleMatchingTokens_code,W_multipleMatchingTokens_desc+".")},b.createMultipleMatchingAccountsInCacheError=function(){return new b(W_multipleMatchingAccounts_code,W_multipleMatchingAccounts_desc)},b.createMultipleMatchingAppMetadataInCacheError=function(){return new b(W_multipleMatchingAppMetadata_code,W_multipleMatchingAppMetadata_desc)},b.createTokenRequestCannotBeMadeError=function(){return new b(W_tokenRequestCannotBeMade_code,W_tokenRequestCannotBeMade_desc)},b.createAppendEmptyScopeToSetError=function(V){return new b(W_appendEmptyScopeError_code,W_appendEmptyScopeError_desc+" Given Scope: "+V)},b.createRemoveEmptyScopeFromSetError=function(V){return new b(W_removeEmptyScopeError_code,W_removeEmptyScopeError_desc+" Given Scope: "+V)},b.createAppendScopeSetError=function(V){return new b(W_appendScopeSetError_code,W_appendScopeSetError_desc+" Detail Error: "+V)},b.createEmptyInputScopeSetError=function(){return new b(W_emptyInputScopeSetError_code,""+W_emptyInputScopeSetError_desc)},b.createDeviceCodeCancelledError=function(){return new b(W_DeviceCodePollingCancelled_code,""+W_DeviceCodePollingCancelled_desc)},b.createDeviceCodeExpiredError=function(){return new b(W_DeviceCodeExpired_code,""+W_DeviceCodeExpired_desc)},b.createDeviceCodeUnknownError=function(){return new b(W_DeviceCodeUnknownError_code,""+W_DeviceCodeUnknownError_desc)},b.createNoAccountInSilentRequestError=function(){return new b(W_NoAccountInSilentRequest_code,""+W_NoAccountInSilentRequest_desc)},b.createNullOrUndefinedCacheRecord=function(){return new b(W_invalidCacheRecord_code,W_invalidCacheRecord_desc)},b.createInvalidCacheEnvironmentError=function(){return new b(W_invalidCacheEnvironment_code,W_invalidCacheEnvironment_desc)},b.createNoAccountFoundError=function(){return new b(W_noAccountFound_code,W_noAccountFound_desc)},b.createCachePluginError=function(){return new b(W_CachePluginError_code,""+W_CachePluginError_desc)},b.createNoCryptoObjectError=function(V){return new b(W_noCryptoObj_code,""+W_noCryptoObj_desc+V)},b.createInvalidCacheTypeError=function(){return new b(W_invalidCacheType_code,""+W_invalidCacheType_desc)},b.createUnexpectedAccountTypeError=function(){return new b(W_unexpectedAccountType_code,""+W_unexpectedAccountType_desc)},b.createUnexpectedCredentialTypeError=function(){return new b(W_unexpectedCredentialType_code,""+W_unexpectedCredentialType_desc)},b.createInvalidAssertionError=function(){return new b(W_invalidAssertion_code,""+W_invalidAssertion_desc)},b.createInvalidCredentialError=function(){return new b(W_invalidClientCredential_code,""+W_invalidClientCredential_desc)},b.createRefreshRequiredError=function(){return new b(W_tokenRefreshRequired_code,W_tokenRefreshRequired_desc)},b.createUserTimeoutReachedError=function(){return new b(W_userTimeoutReached_code,W_userTimeoutReached_desc)},b.createTokenClaimsRequiredError=function(){return new b(W_tokenClaimsRequired_code,W_tokenClaimsRequired_desc)},b.createNoAuthCodeInServerResponseError=function(){return new b(W_noAuthorizationCodeFromServer_code,W_noAuthorizationCodeFromServer_desc)},b.createBindingKeyNotRemovedError=function(){return new b(W_bindingKeyNotRemovedError_code,W_bindingKeyNotRemovedError_desc)},b.createLogoutNotSupportedError=function(){return new b(W_logoutNotSupported_code,W_logoutNotSupported_desc)},b.createKeyIdMissingError=function(){return new b(W_keyIdMissing_code,W_keyIdMissing_desc)},b}(ke.l),qe=function(){function P(){}return P.decodeAuthToken=function(b){if(P.isEmpty(b))throw Ue.createTokenNullOrEmptyError(b);var $=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(b);if(!$||$.length<4)throw Ue.createTokenParsingError("Given token is malformed: "+JSON.stringify(b));return{header:$[1],JWSPayload:$[2],JWSSig:$[3]}},P.isEmpty=function(b){return typeof b>"u"||!b||0===b.length},P.isEmptyObj=function(b){if(b&&!P.isEmpty(b))try{var V=JSON.parse(b);return 0===Object.keys(V).length}catch{}return!0},P.startsWith=function(b,V){return 0===b.indexOf(V)},P.endsWith=function(b,V){return b.length>=V.length&&b.lastIndexOf(V)===b.length-V.length},P.queryStringToObject=function(b){var V={},$=b.split("&"),Pe=function(me){return decodeURIComponent(me.replace(/\+/g," "))};return $.forEach(function(Ce){if(Ce.trim()){var me=Ce.split(/=(.+)/g,2),We=me[0],Ne=me[1];We&&Ne&&(V[Pe(We)]=Pe(Ne))}}),V},P.trimArrayEntries=function(b){return b.map(function(V){return V.trim()})},P.removeEmptyStringsFromArray=function(b){return b.filter(function(V){return!P.isEmpty(V)})},P.jsonParseHelper=function(b){try{return JSON.parse(b)}catch{return null}},P.matchPattern=function(b,V){return new RegExp(b.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(V)},P}();(P=F||(F={}))[P.Default=0]="Default",P[P.Adfs=1]="Adfs";var Ie=function(){function P(){}return P.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},P.prototype.generateAccountKey=function(){return P.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},P.prototype.generateType=function(){switch(this.authorityType){case R.iR.ADFS_ACCOUNT_TYPE:return R.LL.ADFS;case R.iR.MSAV1_ACCOUNT_TYPE:return R.LL.MSA;case R.iR.MSSTS_ACCOUNT_TYPE:return R.LL.MSSTS;case R.iR.GENERIC_ACCOUNT_TYPE:return R.LL.GENERIC;default:throw Ue.createUnexpectedAccountTypeError()}},P.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},P.generateAccountCacheKey=function(b){return[b.homeAccountId,b.environment||R.gT.EMPTY_STRING,b.tenantId||R.gT.EMPTY_STRING].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},P.createAccount=function(b,V,$,Pe,Ce,me,We,Ne,N){var O,U,M,Z,ee,Y,Ve=new P;Ve.authorityType=R.iR.MSSTS_ACCOUNT_TYPE,Ve.clientInfo=b,Ve.homeAccountId=V,Ve.nativeAccountId=N;var f=Ne||Pe&&Pe.getPreferredCache();if(!f)throw Ue.createInvalidCacheEnvironmentError();return Ve.environment=f,Ve.realm=(null===(O=$?.claims)||void 0===O?void 0:O.tid)||R.gT.EMPTY_STRING,Ve.oboAssertion=Ce,$&&(Ve.idTokenClaims=$.claims,Ve.localAccountId=(null===(U=$?.claims)||void 0===U?void 0:U.oid)||(null===(M=$?.claims)||void 0===M?void 0:M.sub)||R.gT.EMPTY_STRING,Ve.username=(null===(Z=$?.claims)||void 0===Z?void 0:Z.preferred_username)||(null!==(ee=$?.claims)&&void 0!==ee&&ee.emails?$.claims.emails[0]:R.gT.EMPTY_STRING),Ve.name=null===(Y=$?.claims)||void 0===Y?void 0:Y.name),Ve.cloudGraphHostName=me,Ve.msGraphHost=We,Ve},P.createGenericAccount=function(b,V,$,Pe,Ce,me,We){var Ne,N,O,U,M=new P;M.authorityType=$&&$.authorityType===F.Adfs?R.iR.ADFS_ACCOUNT_TYPE:R.iR.GENERIC_ACCOUNT_TYPE,M.homeAccountId=b,M.realm=R.gT.EMPTY_STRING,M.oboAssertion=Pe;var Z=We||$&&$.getPreferredCache();if(!Z)throw Ue.createInvalidCacheEnvironmentError();return V&&(M.localAccountId=(null===(Ne=V?.claims)||void 0===Ne?void 0:Ne.oid)||(null===(N=V?.claims)||void 0===N?void 0:N.sub)||R.gT.EMPTY_STRING,M.username=(null===(O=V?.claims)||void 0===O?void 0:O.upn)||R.gT.EMPTY_STRING,M.name=(null===(U=V?.claims)||void 0===U?void 0:U.name)||R.gT.EMPTY_STRING,M.idTokenClaims=V?.claims),M.environment=Z,M.cloudGraphHostName=Ce,M.msGraphHost=me,M},P.generateHomeAccountId=function(b,V,$,Pe,Ce){var me,We=null!==(me=Ce?.claims)&&void 0!==me&&me.sub?Ce.claims.sub:R.gT.EMPTY_STRING;if(V===F.Adfs)return We;if(b)try{var Ne=function(P,b){if(qe.isEmpty(P))throw Ue.createClientInfoEmptyError();try{var V=b.base64Decode(P);return JSON.parse(V)}catch($){throw Ue.createClientInfoDecodingError($)}}(b,Pe);if(!qe.isEmpty(Ne.uid)&&!qe.isEmpty(Ne.utid))return""+Ne.uid+R.Bv.CLIENT_INFO_SEPARATOR+Ne.utid}catch{}return $.verbose("No client info in response"),We},P.isAccountEntity=function(b){return!!b&&b.hasOwnProperty("homeAccountId")&&b.hasOwnProperty("environment")&&b.hasOwnProperty("realm")&&b.hasOwnProperty("localAccountId")&&b.hasOwnProperty("username")&&b.hasOwnProperty("authorityType")},P.accountInfoIsEqual=function(b,V,$){if(!b||!V)return!1;var Pe=!0;if($){var Ce=b.idTokenClaims||{},me=V.idTokenClaims||{};Pe=Ce.iat===me.iat&&Ce.nonce===me.nonce}return b.homeAccountId===V.homeAccountId&&b.localAccountId===V.localAccountId&&b.username===V.username&&b.tenantId===V.tenantId&&b.environment===V.environment&&b.nativeAccountId===V.nativeAccountId&&Pe},P}(),we=G(98665),A=G(98049),Le=G(19270),Qe=G(66070),fe=function(P){function b(V,$){var Pe=P.call(this,V)||this;return Pe.message=V,Pe.msalError=$,Pe}return(0,Se.__extends)(b,P),b}(Error),ye=G(41114),se="PBI.App.AdHocTokenAcquisition",ve=ye.cx[se]=(0,ye.b1)(se),Ee="PBI.App.AdHocTokenAcquisition.UserConfirmation",ze=ye.cx[Ee]=(0,ye.b1)(Ee),ie=G(50423),pe=G(58938),he=G(65181),le=window,ge=function(){function P(b,V,$){this.dialogService=b,this.localizationService=V,this.telemetryService=$,this.msalClientApplication=le.msalClientApplication}return P.prototype.acquireToken=function(b,V,$){var Pe;return void 0===$&&($=!1),(0,Se.__awaiter)(this,void 0,void 0,function(){var Ce,me,We,Ne,N;return(0,Se.__generator)(this,function(O){switch(O.label){case 0:if(Ce=this.retrieveSignedInAccount(),me=this.telemetryService.startActivity(null,ve,{scenarioName:b,authMethod:"Silent"}),!Ce)return[3,5];O.label=1;case 1:return O.trys.push([1,3,,4]),[4,this.msalClientApplication.acquireTokenSilent({scopes:V,account:Ce,forceRefresh:$})];case 2:return We=O.sent(),me.resolve(),[2,{token:We.accessToken,expiry:We.expiresOn}];case 3:throw(Ne=O.sent()).constructor.name===ce.Yo.name?(me.reject({errorSource:"External",errorMessage:N=Le.fW.UserInteractionRequired,errorCode:"UserInteractionRequired"}),new fe(N,Ne)):(N=null!==(Pe=Ne.message)&&void 0!==Pe?Pe:Ne,me.reject({errorSource:"External",errorMessage:N,errorCode:Ne.code}),new fe("Error code: ".concat(Ne.code,", error message: ").concat(N),Ne));case 4:return[3,6];case 5:throw me.reject({errorSource:"PowerBI",errorMessage:N=Le.fW.UserNotSignedIn,errorCode:"UserNotSignedIn"}),Error(N);case 6:return[2]}})})},P.prototype.acquireTokenPopup=function(b,V){return(0,Se.__awaiter)(this,void 0,void 0,function(){var $=this;return(0,Se.__generator)(this,function(Pe){return[2,Qe.kB.retryOnInteractionInProgressError(function(){return $.acquireTokenPopupInternal(b,V)})]})})},P.prototype.acquireTokenPopupInternal=function(b,V){var $;return(0,Se.__awaiter)(this,void 0,void 0,function(){var Ce,me,We,Ne,N,O;return(0,Se.__generator)(this,function(U){switch(U.label){case 0:return[4,this.dialogService.open(A.J,{data:{title:this.localizationService.get("AcquireToken_Dialog_VerifyIdentity"),ariaLabel:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),message:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),cancelButtonText:this.localizationService.get("ModalDialog_Cancel")},autoFocus:!0}).afterClosed().toPromise()];case 1:if(Ce=U.sent(),this.telemetryService.logEvent(ze,{scenarioName:b,authMethod:"Popup",result:1===Ce}),1!==Ce)throw Error(Le.fW.UserInteractionDeclined);me=this.retrieveSignedInAccount(),We=this.telemetryService.startActivity(null,ve,{scenarioName:b,authMethod:"Popup"}),U.label=2;case 2:return U.trys.push([2,4,,5]),[4,this.msalClientApplication.acquireTokenPopup({scopes:V,account:me})];case 3:return Ne=U.sent(),this.msalClientApplication.setActiveAccount(Ne.account),[3,5];case 4:throw N=U.sent(),O=null!==($=N.message)&&void 0!==$?$:N,We.reject({errorSource:"External",errorMessage:O,errorCode:N.code}),new fe("Error code: ".concat(N.code,", error message: ").concat(O),N);case 5:if(!Ie.accountInfoIsEqual(me??null,Ne.account))throw We.reject({errorSource:"External",errorMessage:Le.fW.UserAccountChanged,errorCode:"UserAccountChanged"}),this.reloadPage(),Error(Le.fW.UserAccountChanged);return We.resolve(),[2,{token:Ne.accessToken,expiry:Ne.expiresOn}]}})})},P.prototype.reloadPage=function(){window.location.reload()},P.prototype.retrieveSignedInAccount=function(){return le.signInProviderService.retrieveSignedInAccount()},P.\u0275fac=function(V){return new(V||P)(ie.\u0275\u0275inject(pe.x),ie.\u0275\u0275inject(he.o),ie.\u0275\u0275inject(we.y0))},P.\u0275prov=ie.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac,providedIn:"root"}),P}()},74568:function(Me,$e,G){"use strict";G.d($e,{m:function(){return qe}});var Se=G(77476),ce=G(17174),R=G(79061),X=G(75266),ke=G(56545),W=G(38426),Ue=G(50423),qe=function(){function de(){}return de.\u0275fac=function(F){return new(F||de)},de.\u0275mod=Ue.\u0275\u0275defineNgModule({type:de}),de.\u0275inj=Ue.\u0275\u0275defineInjector({imports:[Se.CommonModule,ce.u5,R.v,ke.g,W._,X.G]}),de}()},69049:function(Me,$e,G){"use strict";G.r($e),G.d($e,{DSVariablesDialogModule:function(){return Ne}});var ce=G(32293),R=G(50423),X=G(81337),ke=G(41114),W="PBI.DataSourceVariables.PQEndpointRetrieved",qe=(ke.cx[W]=(0,ke.b1)(W),"PBI.DataSourceVariables.PQEndpointRetrievalFailure"),be=(ke.cx[qe]=(0,ke.b1)(qe),"PBI.DataSourceVariables.ShowMashupEditor"),F=ke.cx[be]=(0,ke.b1)(be),Ie="PBI.DataSourceVariables.CloseMashupEditor",we=ke.cx[Ie]=(0,ke.b1)(Ie),A=G(98665),Le=G(78590),Qe=G(59017),fe=G(11547),ye=G(59973),se=G(48787),ve=G(42195),Ee=G(73875),ze=function(){function N(O){this.httpService=O,this.DataSourceVariablesUriPrefix="explore/dataSourceVariables"}return N.prototype.getDataSourceMetadataUri=function(O){return(0,fe.of)("powerbi/databases/v201606/datasets/"+O+"/datasourcesForVariables")},N.prototype.getMDocument=function(O,U){return this.httpService.post(this.DataSourceVariablesUriPrefix+"/"+O+"/mdocument",U)},N.prototype.extractVariables=function(O){return this.httpService.post(this.DataSourceVariablesUriPrefix+"/extract",O)},N.\u0275fac=function(U){return new(U||N)(R.\u0275\u0275inject(Ee.O))},N.\u0275prov=R.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac,providedIn:"root"}),N}(),ie=G(81213),pe=G(65181),he=G(77476),le=G(73425),ge=G(8748);function P(N,O){1&N&&R.\u0275\u0275element(0,"spinner",2)}var b=function(O){return{hidden:O}};function V(N,O){if(1&N){var U=R.\u0275\u0275getCurrentView();R.\u0275\u0275elementStart(0,"mashup-editor",3),R.\u0275\u0275listener("onError",function(ee){R.\u0275\u0275restoreView(U);var Y=R.\u0275\u0275nextContext();return R.\u0275\u0275resetView(Y.onError(ee))})("onReady",function(){R.\u0275\u0275restoreView(U);var ee=R.\u0275\u0275nextContext();return R.\u0275\u0275resetView(ee.onReady())}),R.\u0275\u0275elementEnd()}if(2&N){var M=R.\u0275\u0275nextContext();R.\u0275\u0275property("ngClass",R.\u0275\u0275pureFunction1(5,b,M.loading))("clientConfiguration",M.clientConfiguration)("flow",M.flow)("editorOnCommit",M.editorOnCommit)("editorOnCancel",M.editorOnCancel)}}var $=function(){function N(O,U,M,Z,ee){this.ref=O,this.dataSourceVariablesService=U,this.errorService=M,this.localizationService=Z,this.telemetryService=ee,this.onCancel=new R.EventEmitter,this.onCommit=new R.EventEmitter,this.loading=!0}return N.prototype.ngOnInit=function(){var O=this;(0,Qe.aj)([this.dataSourceVariablesService.getMDocument(this.modelId,{overrides:this.currentOverrides}),this.dataSourceVariablesService.getDataSourceMetadataUri(this.dbName)]).pipe((0,ye.h)(function(U){return!!U[0]&&!!U[1]}),(0,se.q)(1)).subscribe(function(U){var M=U[0],Z=U[1];try{O.currentMDocument={document:M.data.document},O.clientConfiguration={editorSettings:O.getEditorSettings()};var ee={type:Le.rP.PowerBIReportView,details:{modelGuid:O.dbName,appServicesEndpoint:Z,useGatewaySSO:"true"}};O.flow={hostContext:ee,kind:Le.Mw.EditCubeVariables,mashupDefinition:{kind:Le.Qo.TransientMashup,editingSessionMashup:{mashupName:"",mashupDocument:O.currentMDocument.document,documentLocale:"",queryGroups:void 0,gatewayObjectId:O.gatewayObjectId,queriesMetadata:void 0,connectionOverrides:void 0,hostContext:ee}},queryName:"Cube"},O.editorOnCommit=function(f){return O.commit(f)},O.editorOnCancel=function(f){return O.cancel()},O.ref.markForCheck()}catch(f){O.onError(f)}})},N.prototype.getEditorSettings=function(){return{sessionId:this.telemetryService.sessionId,locale:this.localizationService.currentLanguageLocale,queryEditorSettings:{enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,useHostConnectionProvider:!1,closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:Le.w9.Cancel}},showCloseButton:!0}},N.prototype.commit=function(O){return(0,X.__awaiter)(this,void 0,void 0,function(){var U,M=this;return(0,X.__generator)(this,function(Z){switch(Z.label){case 0:return this.telemetryService.logEvent(we,{cancelled:!1}),[4,O.getEditingSessionMashup()];case 1:return U=Z.sent(),this.extractOverrides(U.mashupDocument,this.currentMDocument).subscribe(function(ee){return M.onCommit.emit(ee)}),[2]}})})},N.prototype.cancel=function(){return(0,X.__awaiter)(this,void 0,void 0,function(){return(0,X.__generator)(this,function(O){return this.telemetryService.logEvent(we,{cancelled:!0}),this.onCancel.emit(),[2]})})},N.prototype.onError=function(O){var M,Z,ee,U=this;if(_.isString(O))Z=O,ee=500;else{var Y=O.error;ee=O.status,Z=Y&&(Y.message||Y.code)||(null===(M=O?.data)||void 0===M?void 0:M.Message)}this.errorService.error(Z,"mashupEditorError",{onDialogClosed:function(){return U.onCancel.emit()},statusCode:"".concat(ee)})},N.prototype.onReady=function(){this.telemetryService.logEvent(F),this.loading=!1,this.ref.markForCheck()},N.prototype.extractOverrides=function(O,U){return this.dataSourceVariablesService.extractVariables({currentMDocument:{document:O},originalMDocument:U}).pipe((0,ve.VS)(function(ee){return(0,fe.of)(ee.data.hasDifferences&&ee.data.overrides)}))},N.\u0275fac=function(U){return new(U||N)(R.\u0275\u0275directiveInject(R.ChangeDetectorRef),R.\u0275\u0275directiveInject(ze),R.\u0275\u0275directiveInject(ie.T),R.\u0275\u0275directiveInject(pe.o),R.\u0275\u0275directiveInject(A.y0))},N.\u0275cmp=R.\u0275\u0275defineComponent({type:N,selectors:[["datasource-mashup-editor"]],inputs:{dbName:"dbName",modelId:"modelId",currentOverrides:"currentOverrides",gatewayObjectId:"gatewayObjectId"},outputs:{onCancel:"onCancel",onCommit:"onCommit"},decls:2,vars:2,consts:[["size","xlarge",4,"ngIf"],[3,"ngClass","clientConfiguration","flow","editorOnCommit","editorOnCancel","onError","onReady",4,"ngIf"],["size","xlarge"],[3,"ngClass","clientConfiguration","flow","editorOnCommit","editorOnCancel","onError","onReady"]],template:function(U,M){1&U&&(R.\u0275\u0275template(0,P,1,0,"spinner",0),R.\u0275\u0275template(1,V,1,7,"mashup-editor",1)),2&U&&(R.\u0275\u0275property("ngIf",M.loading),R.\u0275\u0275advance(1),R.\u0275\u0275property("ngIf",!!M.clientConfiguration))},dependencies:[he.NgClass,he.NgIf,le.O,ge.o],styles:["[_nghost-%COMP%]{height:768px;width:1024px;max-height:75vh;max-width:75vw;display:flex;flex-direction:column;align-items:stretch;justify-content:center}[_nghost-%COMP%]   spinner[_ngcontent-%COMP%], [_nghost-%COMP%]   mashup-editor[_ngcontent-%COMP%]{display:flex;justify-content:center;flex:1 1 auto}[_nghost-%COMP%]   spinner[_ngcontent-%COMP%]{align-items:center}[_nghost-%COMP%]   mashup-editor[_ngcontent-%COMP%]{align-items:stretch}[_nghost-%COMP%]   mashup-editor.hidden[_ngcontent-%COMP%]{display:none}"]}),N}(),Pe=function(){function N(O,U){this.matDialogRef=O,this.titleKey=U.titleKey,this.dbName=U.dbName,this.modelId=U.modelId,this.gatewayObjectId=U.gatewayObjectId,this.currentOverrides=U.currentOverrides}return N.prototype.onCommit=function(O){this.close(O)},N.prototype.onCancel=function(){this.close()},N.prototype.close=function(O){this.matDialogRef.close(O)},N.\u0275fac=function(U){return new(U||N)(R.\u0275\u0275directiveInject(ce.so),R.\u0275\u0275directiveInject(ce.WI))},N.\u0275cmp=R.\u0275\u0275defineComponent({type:N,selectors:[["ds-variables-dialog"]],decls:4,vars:4,consts:[[1,"table"],[3,"currentOverrides","gatewayObjectId","dbName","modelId","onCancel","onCommit"]],template:function(U,M){1&U&&(R.\u0275\u0275elementStart(0,"mat-dialog-content")(1,"section",0)(2,"datasource-mashup-editor",1),R.\u0275\u0275listener("onCancel",function(){return M.onCancel()})("onCommit",function(ee){return M.onCommit(ee)}),R.\u0275\u0275elementEnd()()(),R.\u0275\u0275element(3,"mat-dialog-actions")),2&U&&(R.\u0275\u0275advance(2),R.\u0275\u0275property("currentOverrides",M.currentOverrides)("gatewayObjectId",M.gatewayObjectId)("dbName",M.dbName)("modelId",M.modelId))},dependencies:[$,ce.xY,ce.H8],styles:["mat-dialog-content[_ngcontent-%COMP%]{padding:0;margin:0}mat-dialog-actions[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),N}(),Ce=G(74568),me=G(42729),Ne=function(){function N(){}return N.\u0275fac=function(U){return new(U||N)},N.\u0275mod=R.\u0275\u0275defineNgModule({type:N}),N.\u0275inj=R.\u0275\u0275defineInjector({imports:[Ce.m,me.c.withManifest([{componentIdentifier:"DSVariablesDialog",componentType:Pe}])]}),N}()},8748:function(Me,$e,G){"use strict";G.d($e,{o:function(){return he}});var Se=G(81337),ce=G(12966),R=G(41114),X="PBI.MashupEditor.OnReadyError",ke=R.cx[X]=(0,R.b1)(X),W="PBI.MashupEditor.OnTokenError",Ue=R.cx[W]=(0,R.b1)(W),qe=G(48741),de=G(50423),be=G(95281),F=G(35911),Ie=G(73221),we=G(98665),A=G(78590),Le=G(59017),Qe=G(23558),fe=G(59973),ye=G(83317),se=G(76746),ve=G(85928),Ee=G(65181),ze=["mashupIframe"],pe={readyState:0},he=function(le){function ge(P,b,V,$,Pe,Ce){var me=le.call(this)||this;return me.appSettings=P,me.ref=b,me.mashupService=V,me.localizationService=$,me.telemetryService=Pe,me.componentStore=Ce,me.onError=new de.EventEmitter,me.onReady=new de.EventEmitter,me.readyState$=me.componentStore.select(function(We){return We.readyState}),me.updateState=me.componentStore.updater(function(We,Ne){return(0,Se.__assign)((0,Se.__assign)({},We),{readyState:Ne})}),me}return(0,Se.__extends)(ge,le),ge.prototype.ngOnInit=function(){var b,V,$,Pe,P=this;!this.theme&&!(null===(V=null===(b=this.clientConfiguration)||void 0===b?void 0:b.editorSettings)||void 0===V)&&V.themeOverride&&(this.theme=null===(Pe=null===($=this.clientConfiguration)||void 0===$?void 0:$.editorSettings)||void 0===Pe?void 0:Pe.themeOverride),this.componentStore.setState(pe),this.changes$("flow").pipe((0,Qe.M)(this.readyState$),(0,fe.h)(function(Ce){return!!Ce[0]&&1!==Ce[1]}),(0,ye.R)(this.onDestroy$)).subscribe(function(Ce){var We=Ce[1];return(0,Se.__awaiter)(P,void 0,void 0,function(){return(0,Se.__generator)(this,function(Ne){switch(Ne.label){case 0:return this.updateState(1),0===We?[3,2]:[4,this.endFlow()];case 1:Ne.sent(),Ne.label=2;case 2:return this.startFlow(),[2]}})})})},ge.prototype.ngAfterViewInit=function(){var P=this;(0,F.mv)(this.clientConfiguration,"clientConfiguration is required"),this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).toPromise().catch(function(){}),this.mashupDataSubscription=(0,Le.aj)([this.mashupService.getPQEndpoint()]).pipe((0,fe.h)(function(b){return!!b[0]})).subscribe(function(b){P.initMashupeditor(b[0])},function(b){P.onError.emit(b)})},ge.prototype.ngOnDestroy=function(){return this.mashupEditorClient&&this.mashupEditorClient.dispose(),this.mashupDataSubscription&&this.mashupDataSubscription.unsubscribe(),le.prototype.ngOnDestroy.call(this)},ge.prototype.setFocus=function(){var P=this.mashupIframe.nativeElement.contentDocument||this.mashupIframe.nativeElement.contentWindow;P?.focus()},ge.prototype.activateQuery=function(P){return this.mashupEditorClient.activateQuery(P)},ge.prototype.addQuery=function(P,b){return this.mashupEditorClient.addQuery(P,b)},ge.prototype.cancelCurrentEvaluation=function(){return this.mashupEditorClient.dataPreview.cancelCurrentEvaluation()},ge.prototype.getEditingSessionMashup=function(){return this.mashupEditorClient.getEditingSessionMashup()},ge.prototype.getQueriesInfo=function(){return this.mashupEditorClient.getQueriesInfo()},ge.prototype.getQueryScript=function(P){return this.mashupEditorClient.getQueryScript(P)},ge.prototype.getDataSourceQueryScript=function(P,b){return this.mashupEditorClient.getDataSourceQueryScript(P,b)},ge.prototype.setUserSettings=function(P){return this.mashupEditorClient.setUserSettings(P)},ge.prototype.refreshActiveQueryResult=function(){return this.mashupEditorClient.refreshActiveQueryResult()},ge.prototype.getSelectedStepName=function(){return this.mashupEditorClient.getSelectedStepName()},ge.prototype.getActiveQueryName=function(){return this.mashupEditorClient.getActiveQueryName()},ge.prototype.getClientSettings=function(P){return{allowedOrigin:P,container:this.mashupIframe.nativeElement,url:this.createMashupEditorUrl(P),className:"mashup-editor-client-iframe"}},ge.prototype.createMashupEditorUrl=function(P){var b="".concat(P,"/MashupEditor");if(this.mashupEditorFeatureFlags&&this.mashupEditorFeatureFlags.size>0){var V=new qe.LE;this.mashupEditorFeatureFlags.forEach(function($,Pe){V=V.set(Pe,$)}),b=b+"?"+V.toString()}return b},ge.prototype.getEditorSettings=function(){var P={cancelButtonLabel:this.localizationService.get("Cancel_ButtonText"),closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:A.w9.Cancel},commitButtonLabel:this.localizationService.get("ModalDialog_Save"),enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,showCancelButton:!0,useHostConnectionProvider:!1};return{addFocusTrapZone:!1,locale:this.localizationService.currentLanguageLocale,sessionId:this.telemetryService.sessionId,queryEditorSettings:P,showCloseButton:!0,showHeader:!1,themeOverride:this.theme||ce.C8}},ge.prototype.endFlow=function(){return(0,Se.__awaiter)(this,void 0,void 0,function(){var P;return(0,Se.__generator)(this,function(b){switch(b.label){case 0:if(!this.mashupEditorClient)return[2];b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.mashupEditorClient.endFlow()];case 2:return b.sent(),this.updateState(3),[3,4];case 3:return P=b.sent(),this.onError.emit(P),this.updateState(4),[3,4];case 4:return[2]}})})},ge.prototype.startFlow=function(){var P=this;!this.flow||!this.mashupEditorClient||this.mashupEditorClient.ready.then(function(){P.mashupEditorClient.startFlow(P.flow,P.editorOnCommit,P.editorOnCancel).then(function(){P.updateState(2),P.onReady.emit(),P.ref.detectChanges()},function(b){P.updateState(4)})},function(b){P.onError.emit(b),P.updateState(4),P.telemetryService.logEvent(ke,{reason:b?b+"":void 0})})},ge.prototype.initMashupeditor=function(P){var b=this,V=this.getClientSettings(P),$=this.getEditorSettings();this.mashupEditorClient=function(ge){return new A.Cq(ge)}(_.merge({clientSettings:V,editorSettings:$,acquireToken:function(Ce){return b.mashupService.getPQToken("".concat(Ce,"/.default")).toPromise().catch(function(me){b.onError.emit(me),b.telemetryService.logEvent(Ue,{reason:me?me.status+"":void 0})})}},this.clientConfiguration)),this.startFlow()},ge.\u0275fac=function(b){return new(b||ge)(de.\u0275\u0275directiveInject(se.de),de.\u0275\u0275directiveInject(de.ChangeDetectorRef),de.\u0275\u0275directiveInject(ve.M),de.\u0275\u0275directiveInject(Ee.o),de.\u0275\u0275directiveInject(we.y0),de.\u0275\u0275directiveInject(be.m1))},ge.\u0275cmp=de.\u0275\u0275defineComponent({type:ge,selectors:[["mashup-editor"]],viewQuery:function(b,V){var $;(1&b&&de.\u0275\u0275viewQuery(ze,5),2&b)&&(de.\u0275\u0275queryRefresh($=de.\u0275\u0275loadQuery())&&(V.mashupIframe=$.first))},inputs:{clientConfiguration:"clientConfiguration",mashupEditorFeatureFlags:"mashupEditorFeatureFlags",flow:"flow",editorOnCommit:"editorOnCommit",editorOnCancel:"editorOnCancel",theme:"theme"},outputs:{onError:"onError",onReady:"onReady"},features:[de.\u0275\u0275ProvidersFeature([be.m1]),de.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["id","mashupIframe","pbi-auto-focus","","data-testid","mashup-iframe"],["mashupIframe",""]],template:function(b,V){1&b&&de.\u0275\u0275element(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:flex}#mashupIframe[_ngcontent-%COMP%]{background:var(--white-color, #FFF);display:flex;flex:1 1 auto;align-items:stretch;justify-content:center}#mashupIframe[_ngcontent-%COMP%]     .mashup-editor-client-iframe{border:none;width:100%;height:100%;display:block!important}"],changeDetection:0}),ge}(Ie.w)},12966:function(Me,$e,G){"use strict";G.d($e,{C8:function(){return Se},z6:function(){return ce}});var Se={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},ce={palette:{themePrimary:"#117865",themeLighterAlt:"#f1faf8",themeLighter:"#c9e9e3",themeLight:"#9fd6cc",themeTertiary:"#54ae9d",themeSecondary:"#218875",themeDarkAlt:"#0f6c5b",themeDark:"#0d5b4d",themeDarker:"#094339",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},semanticColors:{}}},75266:function(Me,$e,G){"use strict";G.d($e,{G:function(){return ze}});var Se=G(32293),ce=G(50423),R=G(77476),X=G(8748);function ke(ie,pe){if(1&ie){var he=ce.\u0275\u0275getCurrentView();ce.\u0275\u0275elementStart(0,"mashup-editor",1),ce.\u0275\u0275listener("onError",function(){ce.\u0275\u0275restoreView(he);var P=ce.\u0275\u0275nextContext();return ce.\u0275\u0275resetView(P.onError)}),ce.\u0275\u0275elementEnd()}if(2&ie){var le=ce.\u0275\u0275nextContext();ce.\u0275\u0275property("clientConfiguration",le.mashUpEditorInput.clientConfiguration)("editorOnCommit",le.onCommit)("editorOnCancel",le.onCancel)("flow",le.mashUpEditorInput.flow)}}var W=function(){function ie(pe,he){var le=this;this.dialogRef=pe,this.onCommit=function(ge,P){le.mashUpEditorInput.editorOnCommit(ge,P),le.dialogRef.close(P)},this.onCancel=function(ge){le.mashUpEditorInput.editorOnCancel(ge),le.dialogRef.close()},this.onError=function(ge){le.mashUpEditorInput.onError(ge)},this.mashUpEditorInput=he.input}return ie.\u0275fac=function(he){return new(he||ie)(ce.\u0275\u0275directiveInject(Se.so),ce.\u0275\u0275directiveInject(Se.WI))},ie.\u0275cmp=ce.\u0275\u0275defineComponent({type:ie,selectors:[["mashup-editor-dialog"]],decls:1,vars:1,consts:[["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError",4,"ngIf"],["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError"]],template:function(he,le){1&he&&ce.\u0275\u0275template(0,ke,1,4,"mashup-editor",0),2&he&&ce.\u0275\u0275property("ngIf",!!le.mashUpEditorInput.clientConfiguration)},dependencies:[R.NgIf,X.o],styles:["[_nghost-%COMP%]     mashup-editor{display:flex;width:80vw;height:80vh}[_nghost-%COMP%]{display:flex}"]}),ie}(),qe=new ce.InjectionToken("MashUpEditorErrorHandler"),de=new ce.InjectionToken("MashUpEditorLauncher"),be=G(78590),F=G(33554),Ie=G(82762),we=G(48787),A=G(42195),Le=G(58938),Qe=function(ie){return ie.OnCommit="OnCommit",ie.OnCancel="OnCancel",ie}({}),ye={provide:de,useClass:function(){function ie(pe,he){this.dialogService=pe,this.errorHandler=he,this.lifeCycleEvent$=new F.t(1)}return ie.prototype.editQueries=function(pe,he){return this.launchMashUpEditor(he.clientConfiguration,{kind:be.Mw.EditQuery,hostContext:he.hostContext||pe.hostContext,mashupDefinition:{editingSessionMashup:pe,kind:be.Qo.TransientMashup}})},ie.prototype.addQueries=function(pe,he){var le=this.buildFlowForAddQueries(pe,he);return this.launchMashUpEditor(he.clientConfiguration,le)},ie.prototype.manageDataSources=function(pe,he){return this.launchMashUpEditor(he.clientConfiguration,{kind:be.Mw.ManageConnections,hostContext:he.hostContext,connectionOverrides:pe.connectionOverrides})},ie.prototype.buildFlowForAddQueries=function(pe,he){var le={kind:be.Mw.AddQueries,hostContext:he.hostContext||pe.hostContext};return function(ie){return!_.has(ie,"mashupDocument")||_.isNil(ie.mashupDocument)}(pe)?(le.mashupTemplateImportAllowed=!0,le.mashupDefinition={editingSessionEmptyMashup:pe,kind:be.Qo.TransientEmptyMashup}):(le.mashupTemplateImportAllowed=!1,le.mashupDefinition={editingSessionMashup:pe,kind:be.Qo.TransientMashup}),le},ie.prototype.launchMashUpEditor=function(pe,he){var le=this;return(0,Ie.D)(this.dialogService.showTemplateDialog("MashUpEditorDialogComponentId",{title:"Mash Up Editor Dialog",input:{clientConfiguration:pe,flow:he,editorOnCommit:function(b,V){return le.onCommit(b,V)},editorOnCancel:function(b){return le.onCancel(b)},onError:function(b){var V;return null===(V=le.errorHandler)||void 0===V?void 0:V.handleError(b)}}})).pipe((0,we.q)(1),(0,A.zg)(function(P){return P.afterClosed()})).toPromise()},ie.prototype.onCommit=function(pe,he){this.lifeCycleEvent$.next({type:Qe.OnCommit,payload:he})},ie.prototype.onCancel=function(pe){this.lifeCycleEvent$.next({type:Qe.OnCancel,payload:void 0})},ie.\u0275fac=function(he){return new(he||ie)(ce.\u0275\u0275inject(Le.x),ce.\u0275\u0275inject(qe,8))},ie.\u0275prov=ce.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac}),ie}()},se=G(79061),ve=G(24495),ze=function(){function ie(){}return ie.\u0275fac=function(he){return new(he||ie)},ie.\u0275mod=ce.\u0275\u0275defineNgModule({type:ie}),ie.\u0275inj=ce.\u0275\u0275defineInjector({providers:[ye],imports:[R.CommonModule,se.v,ve.z.withManifest([{componentIdentifier:"MashUpEditorDialogComponentId",componentType:W}])]}),ie}()},85928:function(Me,$e,G){"use strict";G.d($e,{M:function(){return se}});var Se=G(36444),ce=G(35911),R=G(85732),X=(0,R.ZF)("urlConfiguration"),ke=(0,R.P1)(X,function(ve){return ve.powerQueryHostUrl}),W=G(37263),Ue=G(59694),qe=G(11547),de=G(82762),be=G(35510),F=G(42195),Ie=G(14172),we=G(17653),A=G(88255),Le=G(50423),Qe=G(62113),fe=G(73875),ye=window,se=function(){function ve(Ee,ze,ie,pe){var he=this;this.store=Ee,this.accessTokenProviderService=ze,this.httpService=ie,this.inTeams=pe,this.getAADToken$=function(le){return(0,qe.of)(null).pipe((0,F.zg)(function(){if(ye.clientAuthEnabled)return(0,de.D)(he.accessTokenProviderService.acquireToken("MashupService",[le],!1)).pipe((0,Ie.U)(function(V){return V.token}));if(he.inTeams){var ge=le.substring(0,le.lastIndexOf("/"));return Se.authentication.initialize(),(0,de.D)(Se.authentication.getAuthToken({resources:[ge],silent:!0}))}var P=(0,Ue.W)("{0}/msal",ye.baseUrl||window.location.origin),b=he.httpService.powerbiRequestOptions();return b.params={scopes:le},he.httpService.get(P,b).pipe((0,Ie.U)(function(V){return V.data.AccessToken}))}),(0,we.b)(function(ge){var b=1e3*(0,ce.oG)(ge).exp;he.AADTokenCache$.next(new Map(he.AADTokenCache$.getValue()).set(le,{token:ge,expiration:b}))}))},this.AADTokenCache$=new be.X(new Map)}return ve.prototype.getPQEndpoint=function(){return this.store.select(ke).pipe((0,Ie.U)(function(Ee){return(0,Ue.g)(Ee)?null:Ee.replace(/\/$/,"")}))},ve.prototype.getPQToken=function(Ee){var ze=this;return this.AADTokenCache$.pipe((0,A.P)(),(0,F.zg)(function(ie){return!ie.has(Ee)||Date.now()+3e5>ie.get(Ee).expiration?ze.getAADToken$(Ee):(0,qe.of)(ie.get(Ee).token)}))},ve.\u0275fac=function(ze){return new(ze||ve)(Le.\u0275\u0275inject(R.yh),Le.\u0275\u0275inject(Qe.Q),Le.\u0275\u0275inject(fe.O),Le.\u0275\u0275inject(W.$,8))},ve.\u0275prov=Le.\u0275\u0275defineInjectable({token:ve,factory:ve.\u0275fac,providedIn:"root"}),ve}()}}]);