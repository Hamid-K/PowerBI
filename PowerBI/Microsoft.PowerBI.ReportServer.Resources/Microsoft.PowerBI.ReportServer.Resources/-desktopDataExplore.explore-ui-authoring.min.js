"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["explore-ui-authoring"],{26902:function(oe,K,l){l.d(K,{L6:function(){return L},aI:function(){return p},ac:function(){return F},dw:function(){return Q},uz:function(){return T}});var h=l(40812),t=l(64067),P=l(62458),A=l(94419),b=l(59897),O=l(80777),z={totalMatchingOption:1,reverseDirection:!1,hideText:!1};function p(k,j){return P.fF.assertValue(k,"visual"),P.fF.assertValue(j,"repetition"),L(S(k.objects,j))}function L(k){if(!k)return z;var j,Z=k.minValue;Z&&(j=Z.value);var I,R=k.maxValue;R&&(I=R.value);var W=1,U=k.totalMatchingOption;return U&&(W=U.value),{minValue:j,maxValue:I,positiveColor:V(k.positiveColor),negativeColor:V(k.negativeColor),axisColor:V(k.axisColor),reverseDirection:k.reverseDirection.value,hideText:k.hideText.value,totalMatchingOption:W}}function V(k){var j=k.solid.color;return(0,t.A7)(j.value)?{solid:{color:j.value}}:null}function T(){return F(z,O.Ge.fromPrimitiveTypeAndCategory(12))}function F(k,j){var Z,I,R;return P.fF.assertValue(k,"dataBars"),P.fF.assertValue(j,"valueType"),void 0!==k.minValue&&(Z=H(k.minValue,j)),void 0!==k.maxValue&&(I=H(k.maxValue,j)),void 0!==k.totalMatchingOption&&(R=(0,A.cA)(k.totalMatchingOption)),{minValue:Z,maxValue:I,positiveColor:(0,b.EV)(k.positiveColor&&k.positiveColor.solid.color,"maxColor"),negativeColor:(0,b.EV)(k.negativeColor&&k.negativeColor.solid.color,"minColor"),axisColor:(0,b.EV)(k.axisColor&&k.axisColor.solid.color,"foreground"),reverseDirection:(0,A.O7)(k.reverseDirection),hideText:(0,A.O7)(k.hideText),totalMatchingOption:R}}function S(k,j){return P.fF.assertValue(j,"objectRepetition"),(0,h.OT)(k,j)}function Q(k,j){return P.fF.assertValue(j,"objectRepetition"),void 0!==S(k,j)}function H(k,j){if(P.fF.assert(function(){return j.integer||j.numeric},"databars only supports numeric SQExprs"),j.integer){var Z=Math.round(k);return(0,A.cA)(Z)}return 2===j.primitiveType?(0,A.gH)(k):(P.fF.assert(function(){return 259===j.extendedType},"Unexpected data type."),(0,A.tx)(k))}},41606:function(oe,K,l){l.d(K,{x:function(){return t}});var h=l(47508),t=function(){function P(){}return P.getDefaultVisualPlugin=function(A){return A&&A.featureSwitches&&A.featureSwitches.pivotTableVisualEnabled?h.L.tableEx:h.L.table},P}()},55201:function(oe,K,l){function h(t,P){if(!t&&!P)return!0;if(!!t!=!!P||t.length!==P.length)return!1;for(var A=0,b=t.length;A<b;A++)if(!t[A].equals(P[A]))return!1;return!0}l.d(K,{L:function(){return h}})},32441:function(oe,K,l){l.d(K,{u:function(){return A}});var h=l(50423),t=l(18460),P=function(O,z,p,L,V){return{formattingSources:O,indicatorEnabled:z,mobileFormatting:p,disabledCards:L,disabledSlices:V}},A=function(){function b(){var O=this;this.mobileFormatting=!1,this.propertyChanged=new h.EventEmitter,this.outputArgs={propertyChanged:function(p){return O.propertyChanged.emit(p)}},this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="FormattingPaneComponentId"}return b.\u0275fac=function(z){return new(z||b)},b.\u0275cmp=h.\u0275\u0275defineComponent({type:b,selectors:[["formatting-pane-lazy"]],inputs:{formattingSources:"formattingSources",indicatorEnabled:"indicatorEnabled",mobileFormatting:"mobileFormatting",disabledCards:"disabledCards",disabledSlices:"disabledSlices"},outputs:{propertyChanged:"propertyChanged"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(z,p){1&z&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&z&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction5(4,P,p.formattingSources,p.indicatorEnabled,p.mobileFormatting,p.disabledCards,p.disabledSlices))("modulePath",p.modulePath)("outputArgs",p.outputArgs)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),b}()},78633:function(oe,K,l){l.d(K,{a:function(){return A}});var h=l(50423),t=l(18460),P=function(O){return{colors:O}},A=function(){function b(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="GradientBarComponentId"}return b.\u0275fac=function(z){return new(z||b)},b.\u0275cmp=h.\u0275\u0275defineComponent({type:b,selectors:[["gradient-bar-lazy"]],inputs:{colors:"colors"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(z,p){1&z&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&z&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction1(3,P,p.colors))("modulePath",p.modulePath)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),b}()},92278:function(oe,K,l){l.d(K,{I:function(){return A}});var h=l(50423),t=l(18460),P=function(O,z,p,L,V){return{toggle:O,ariaLabelledby:z,ariaDescribedby:p,toggleLabel:L,isDisabled:V}},A=function(){function b(){var O=this;this.onToggleChange=new h.EventEmitter,this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="ToggleSwitchModernComponentId",this.outputArgs={onToggleChange:function(p){return O.onToggleChange.emit(p)}}}return b.\u0275fac=function(z){return new(z||b)},b.\u0275cmp=h.\u0275\u0275defineComponent({type:b,selectors:[["toggle-switch-modern-lazy"]],inputs:{toggle:"toggle",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",toggleLabel:"toggleLabel",isDisabled:"isDisabled"},outputs:{onToggleChange:"onToggleChange"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(z,p){1&z&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&z&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction5(4,P,p.toggle,p.ariaLabelledby,p.ariaDescribedby,p.toggleLabel,p.isDisabled))("modulePath",p.modulePath)("outputArgs",p.outputArgs)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),b}()},90094:function(oe,K,l){l.d(K,{l:function(){return A}});var h=l(50423),t=l(18460),P=function(O){return{warningMessage:O}},A=function(){function b(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="WarningComponentId"}return b.\u0275fac=function(z){return new(z||b)},b.\u0275cmp=h.\u0275\u0275defineComponent({type:b,selectors:[["warning-eager"]],inputs:{warningMessage:"warningMessage"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(z,p){1&z&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&z&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction1(3,P,p.warningMessage))("modulePath",p.modulePath)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),b}()},42101:function(oe,K,l){l.d(K,{p:function(){return Q}});var h=l(9844),O=(l(32441),l(78633),l(92278),l(90094),l(77476)),z=l(9398),p=l(76072),L=l(82156),V=l(50423),T={loadChildren:function(){return Promise.all([l.e(5),l.e("pane-formatting")]).then(l.bind(l,53150)).then(function(k){return k.PaneFormattingModule})}};p.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",T.loadChildren);var F=[{path:"dummy-pane-formatting-lazy",loadChildren:T.loadChildren}],Q=function(){function H(){}return H.\u0275fac=function(j){return new(j||H)},H.\u0275mod=V.\u0275\u0275defineNgModule({type:H}),H.\u0275inj=V.\u0275\u0275defineInjector({imports:[O.CommonModule,h.j,L.N,z.Bz.forChild(F)]}),H}()},43281:function(oe,K,l){l.r(K),l.d(K,{ExploreUIAuthoringModule:function(){return ls}});var h=l(86286),t=l(50423),P=l(77476),A=l(89961);function b(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"section",1),t.\u0275\u0275element(1,"visual-types-container-modern",4),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("visualContainer",e.visualContainer)("visualPluginFilter",e.nonPersonalVisualPluginFilter)("disableMoreOptionsIcon",!0)("visualConversionSource",e.visualConversionSource)}}var O=function(){function o(){}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["all-visual-selector"]],inputs:{visualContainer:"visualContainer",visualPluginFilter:"visualPluginFilter",showNonPersonalVisualizationPane$:"showNonPersonalVisualizationPane$",nonPersonalVisualPluginFilter:"nonPersonalVisualPluginFilter",visualConversionSource:"visualConversionSource"},decls:5,vars:6,consts:[[1,"allVisualizationsPicker","explorationContainer","newPaneColors"],[1,"modern-format-pane"],[1,"compact-visual-types",3,"visualContainer","visualPluginFilter","visualConversionSource"],["class","modern-format-pane",4,"ngIf"],[1,"withTopDivider","compact-visual-types",3,"visualContainer","visualPluginFilter","disableMoreOptionsIcon","visualConversionSource"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"section",1),t.\u0275\u0275element(2,"visual-types-container-modern",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,b,2,4,"section",3),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("visualContainer",i.visualContainer)("visualPluginFilter",i.visualPluginFilter)("visualConversionSource",i.visualConversionSource),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(4,4,i.showNonPersonalVisualizationPane$)))},dependencies:[P.NgIf,A.r,P.AsyncPipe],styles:[".allVisualizationsPicker[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),o}(),z=function(){function o(n){this.visualSelectorInput=n,this.visualContainer=n.visualContainer,this.visualPluginFilter=n.visualPluginFilter,this.nonPersonalVisualPluginFilter=n.nonPersonalVisualPluginFilter,this.showNonPersonalVisualizationPane$=n.showNonPersonalVisualizationPane$}return o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(h.M))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["all-visual-selector-flyout"]],decls:2,vars:4,consts:[[1,"allVisualSelectorContainer"],[1,"white-background",3,"visualContainer","visualPluginFilter","nonPersonalVisualPluginFilter","showNonPersonalVisualizationPane$"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275element(1,"all-visual-selector",1),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("visualContainer",i.visualContainer)("visualPluginFilter",i.visualPluginFilter)("nonPersonalVisualPluginFilter",i.nonPersonalVisualPluginFilter)("showNonPersonalVisualizationPane$",i.showNonPersonalVisualizationPane$))},dependencies:[O],styles:["[_nghost-%COMP%]{width:100%}.allVisualSelectorContainer[_ngcontent-%COMP%]{padding:3px 0;background:var(--fluent-theme-white-color);border:1px solid var(--gray-110);border-top:none}"]}),o}(),p=l(81337),L=l(35510),V=l(63057),T=l(83317),F=l(59973),S=l(48787),Q=l(33754),H=l(78778),k=l(73221),j=l(25512),Z=l(86940),I=l(8590),R=l(3579),W=l(60661),U=l(61903),ie=l(20590),J=l(47508),D=l(62458),Y=l(26898),de=l(29748),q=l(39503),ne=l(11494),ce=l(83008),Ve=l(66977),ae=l(9380),Se=l(28894),se=l(65181),gi=l(69071),he=l(29866),pe=l(66890),it=l(34518),hi=l(65188),nt=l(92278),rt=l(36858),je=l(85102),Ht=["visualPicker"],ht=["allVisualToggleButton"],fi=["suggestedVisualTypeElement"];function ft(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"label",8),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(e.label)}}var Kt=function(n,e){return{selected:n,notSelected:e}};function mt(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",14,15),t.\u0275\u0275listener("click",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.updateVisualType(d.type))})("keydown",function(u){var g=t.\u0275\u0275restoreView(e).index,v=t.\u0275\u0275nextContext(2).ngIf,f=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(f.onSuggestedVisualTypeKeydown(u,g,v.suggestions.length))}),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275element(3,"svg-use-symbol",16),t.\u0275\u0275elementEnd()}if(2&o){var i=n.$implicit,r=n.index,a=t.\u0275\u0275nextContext(2).ngIf,s=t.\u0275\u0275nextContext();t.\u0275\u0275property("tabindex",r===t.\u0275\u0275pipeBind1(2,8,s.suggestedVisualTypeFocusIndex$)?0:-1)("ngClass",t.\u0275\u0275pureFunction2(10,Kt,i.type===a.selectedInfo.type,i.type!==a.selectedInfo.type))("disabled",!s.allowChangeVisualType)("ngStyle",i.imageStyles)("pbiTooltip",i.tooltip),t.\u0275\u0275attribute("aria-colindex",r),t.\u0275\u0275advance(3),t.\u0275\u0275property("sheet",i.iconSheet)("symbolId",i.symbol)}}var Qt=function(n,e){return{"pbi-glyph-chevronupsmall":n,"pbi-glyph-chevrondownsmall":e}};function yt(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",17,18),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(a.toggleAllVisualState())}),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275pipe(3,"localize"),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(9,Qt,i.showAllVisualizations,!i.showAllVisualizations))("pbiTooltip",t.\u0275\u0275pipeBind1(3,7,i.showAllVisualizations?"Chevron_CollapseDescription":"Chevron_ExpandDescription"))("disabled",!i.allowChangeVisualType),t.\u0275\u0275attribute("aria-expanded",i.showAllVisualizations)("aria-label",t.\u0275\u0275pipeBind1(2,5,"Show_All_Visual_Types"))}}var Xt=function(n){return{withAllVisualsSelector:n}};function Ct(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"div",9)(1,"div",10)(2,"div",11),t.\u0275\u0275template(3,mt,4,13,"button",12),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(4,yt,4,12,"button",13),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(4,Xt,i.showAllVisualizations&&!i.allVisualsPickerInFlyout||i.alwaysExpanded)),t.\u0275\u0275advance(1),t.\u0275\u0275attribute("aria-colcount",e.suggestions.length),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.suggestions),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.alwaysExpanded)}}function Zt(o,n){if(1&o&&t.\u0275\u0275element(0,"all-visual-selector",19),2&o){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("visualContainer",e.visualContainer)("visualPluginFilter",e.visualPluginFilter)("showNonPersonalVisualizationPane$",e.showNonPersonalVisualizationPane$)("nonPersonalVisualPluginFilter",e.nonPersonalVisualizationPaneFilter)("visualConversionSource",e.host)}}var bt=function(n){return{isDisabled:n}};function mi(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20)(1,"toggle-switch-modern-lazy",21),t.\u0275\u0275listener("onToggleChange",function(s){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.updateAutoVisualState(s))}),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext().ngIf,r=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,bt,!r.allowChangeVisualType)),t.\u0275\u0275advance(1),t.\u0275\u0275property("toggle",i.selectedInfo.isAutoVisual)("isDisabled",!r.allowChangeVisualType)("pbiTooltip",r.tooltip)("toggleLabel",r.autoModeToggleLabel)}}var Pt=function(n,e){return{disabledVisualPicker:n,withSuggestions:e}};function yi(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"div",1),t.\u0275\u0275template(1,ft,2,1,"label",2),t.\u0275\u0275elementStart(2,"div",3,4),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275template(5,Ct,5,6,"div",5),t.\u0275\u0275template(6,Zt,1,5,"all-visual-selector",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(7,mi,2,7,"div",7),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.label),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(7,Pt,t.\u0275\u0275pipeBind1(4,5,e.disabled$),!e.noSuggestions)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!e.noSuggestions),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showAllVisualizations&&!e.allVisualsPickerInFlyout||e.alwaysExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!e.noAutoToggleSwitch)}}var ot=function(o){function n(e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B){var M=o.call(this)||this;return M.conceptualSchemaProxy=e,M.contextActivityService=i,M.explorationNavigation=r,M.eventBridge=a,M.dataSources=s,M.featureSwitchService=c,M.injector=u,M.lazyScoped=d,M.localizationService=g,M.overlay=v,M.trustedVisual=f,M.visualAuthoring=m,M.visualPaneSettingsService=y,M.visualPluginOperationsService=x,M.visualPlugin=C,M.visualTypesService=B,M.numberOfSuggestionsToShow=5,M.onVisualTypeUpdated=new t.EventEmitter,M.showNonPersonalVisualizationPane$=new L.X(!1),M.isInitialized$=new L.X(!1),M.suggestedVisualTypeFocusIndex$=new L.X(void 0),M.visualViewModel$=new L.X(void 0),M.isInitialFocusSet=!1,M.visualPluginFilter=function(w,E,G){return!(M.withPerspectives&&M.visualPluginOperationsService.isQnaVisual(w.name)||_.isFunction(M.isVisualExcluded)&&M.isVisualExcluded(w.name))&&(0,U.CL)(w,E,G)},M.nonPersonalVisualizationPaneFilter=function(w,E,G){return!(0,U.CL)(w,E,G)},M}return(0,p.__extends)(n,o),Object.defineProperty(n.prototype,"_suggestedVisualTypeElementRefs",{set:function(i){this.suggestedVisualTypeElementRefs=i?.toArray()||[],!this.isInitialFocusSet&&null!=this.suggestedVisualTypeFocusIndex$.value&&this.setFocusAfterInitialization&&(this.setInitialFocus(),this.isInitialFocusSet=!0)},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.lazyScoped.get("authoringVisualRecommendationInterop").then(function(i){e.recommendationInterop=i,e.visualTypesService.initialize(),e.isInitialized$.next(!0)}),this.visualTypesService.availableVisualTypes$.pipe((0,T.R)(this.onDestroy$)).subscribe(function(i){e.availableVisualTypes=i}),this.allowChangeVisualType=this.visualContainer?this.visualPluginOperationsService.canConvertVisual(this.visualContainer):this.allowSelectVisualTypeWhenNoVisual,this.isInitialized$.pipe((0,T.R)(this.onDestroy$),(0,F.h)(function(i){return!!i})).subscribe(function(){e.updateVisualViewModel(),e.updateNonPersonalVisualState()}),(0,V.T)(this.changes$("visualContainer"),this.eventBridge.on(I.KD7),this.eventBridge.on(I.jCS),this.eventBridge.on(I.D1A),this.eventBridge.on(I.Udu)).pipe((0,T.R)(this.onDestroy$)).subscribe(function(){e.isInitialized$.value&&(e.updateVisualViewModel(),e.updateNonPersonalVisualState())})},n.prototype.onResize=function(){var e;null===(e=this.allVisualSelectorOverlayRef)||void 0===e||e.close()},n.prototype.toggleAllVisualState=function(){this.showAllVisualizations=!this.showAllVisualizations,this.allVisualsPickerInFlyout&&this.showHideVisualPickerFlyout(this.showAllVisualizations)},n.prototype.updateAutoVisualState=function(e){this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),e?void 0:(0,R.s)(this.visualContainer),this.explorationNavigation.getCurrentSection())},n.prototype.updateVisualType=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,r,s,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:if(!this.visualContainer)return[3,5];i=this.contextActivityService.createActivity({name:"SelectVisualRecommendation",visualName:this.visualContainer.name,data:{visualTypePicked:e,source:"Skittle",skittleType:"Build"}}),d.label=1;case 1:return d.trys.push([1,3,,4]),r=(0,W.II)(this.visualContainer),[4,this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),e,this.explorationNavigation.getCurrentSection(),r,"Skittle",i)];case 2:return d.sent()?(this.onVisualTypeUpdated.emit(e),i.resolve()):i.reject(new Error("cannot convert to recommended type")),[3,4];case 3:throw s=d.sent(),i.reject(s),s;case 4:return[3,6];case 5:this.allowSelectVisualTypeWhenNoVisual&&(c=this.visualPlugin.getPlugin(e))&&(u=_.find(this.availableVisualTypes.types,function(g){return g.plugin.name===c.name}))&&this.visualTypesService.performSelectVisualTypeAction(u,this.host),d.label=6;case 6:return[2]}})})},n.prototype.onSuggestedVisualTypeKeydown=function(e,i,r){"ArrowRight"===e.key||"ArrowDown"===e.key?i+1<r&&(this.suggestedVisualTypeFocusIndex$.next(i+1),this.suggestedVisualTypeElementRefs[i+1].nativeElement.focus()):("ArrowLeft"===e.key||"ArrowUp"===e.key)&&i-1>=0&&(this.suggestedVisualTypeFocusIndex$.next(i-1),this.suggestedVisualTypeElementRefs[i-1].nativeElement.focus())},n.prototype.showHideVisualPickerFlyout=function(e){e&&!this.allVisualSelectorOverlayRef&&this.showAllVisualFlyout(),!e&&this.allVisualSelectorOverlayRef&&(this.allVisualSelectorOverlayRef.close(),this.allVisualSelectorOverlayRef=void 0)},n.prototype.showAllVisualFlyout=function(){var e=this;this.allVisualSelectorOverlayRef=this.overlay.open({component:z,data:{visualContainer:this.visualContainer,visualPluginFilter:this.visualPluginFilter,showNonPersonalVisualizationPane$:this.showNonPersonalVisualizationPane$,nonPersonalVisualPluginFilter:this.nonPersonalVisualizationPaneFilter},options:{width:this.visualPickerRef.nativeElement.offsetWidth,positionStrategy:this.overlay.position().flexibleConnectedTo(this.visualPickerRef).withPositions([(0,j.Oq)()]).withFlexibleDimensions(!0).withGrowAfterOpen(!0),hasBackdrop:!0,backdropClass:Z.L,disposeOnNavigation:!0},injector:this.injector,closeOnBackdropClick:!0,forwardClickDisabledElements:[this.allVisualToggleButtonRef.nativeElement]}),this.allVisualSelectorOverlayRef.onClose.pipe((0,S.q)(1)).subscribe(function(){e.allVisualSelectorOverlayRef=void 0,e.showAllVisualizations=!1})},n.prototype.setInitialFocus=function(){var i,r,e=this;this.suggestedVisualTypeFocusIndex$.value>=0&&(D.fF.assert(function(){return e.suggestedVisualTypeFocusIndex$.value<_.size(e.suggestedVisualTypeElementRefs)},"suggested type elementRefs not updated yet"),null===(r=null===(i=this.suggestedVisualTypeElementRefs[this.suggestedVisualTypeFocusIndex$.value])||void 0===i?void 0:i.nativeElement)||void 0===r||r.focus())},n.prototype.updateVisualViewModel=function(){var e;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,r,a,s,c,u,d,g,v,f,m=this;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return i=(0,W.Xf)(this.visualContainer),_.isEmpty(null===(e=i?.defn)||void 0===e?void 0:e.select())?[3,2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:a=y.sent(),r=this.recommendationInterop.getRecommendedVisualTypes(this.visualContainer,a,this.numberOfSuggestionsToShow,this.isVisualExcluded),y.label=2;case 2:return _.isEmpty(r)&&(r=[J.L.columnChart.name,J.L.barChart.name,J.L.lineChart.name,J.L.tableEx.name,J.L.card.name]),(0,W.II)(this.visualContainer)||(s=(0,R.s)(this.visualContainer),(c=_.indexOf(r,s))>=0&&r.splice(c,1),r.unshift(s),_.size(r)>this.numberOfSuggestionsToShow&&r.pop()),u=_.map(r,function(x){var C=m.visualPlugin.getPlugin(x);if(C){var B=(0,ie.tl)(C,m.trustedVisual,m.localizationService,void 0);return{type:x,symbol:B.class,iconSheet:"visualizationPaneIcons",imageStyles:m.getVisualImageStyles(C),tooltip:B.title}}}),d=_.filter(u,function(x){return null!=x}),g=(0,R.s)(this.visualContainer),v=(0,W.II)(this.visualContainer),f={type:g,isAutoVisual:v},this.withPerspectives&&this.visualAuthoring.setPresentationChangesApplied(!0),this.visualViewModel$.next({selectedInfo:f,suggestions:d}),this.suggestedVisualTypeFocusIndex$.next(Math.min(0,d.length-1)),[2]}})})},n.prototype.getVisualImageStyles=function(e){return e.iconUrl&&(e.developerModeVisual||e.custom&&!this.trustedVisual.isAutomaticallyImportedVisual(e.name))?{"background-image":e.iconUrl,"background-repeat":"round","background-clip":"content-box",padding:"1px"}:null},n.prototype.updateNonPersonalVisualState=function(){var e=this;this.showNonPersonalVisualizationPane$.next(_.some(this.visualPlugin.getConvertibleVisuals(),function(i){return null!=i&&!(0,U.CL)(i,e.featureSwitchService,e.visualPaneSettingsService)}))},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(de.r),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(t.Injector),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(Z._),t.\u0275\u0275directiveInject(gi.t),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(it.R),t.\u0275\u0275directiveInject(Ve.f),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Q.V))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["auto-visual"]],viewQuery:function(i,r){if(1&i&&(t.\u0275\u0275viewQuery(Ht,5,t.ElementRef),t.\u0275\u0275viewQuery(ht,5,t.ElementRef),t.\u0275\u0275viewQuery(fi,5,t.ElementRef)),2&i){var a=void 0;t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(r.visualPickerRef=a.first),t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(r.allVisualToggleButtonRef=a.first),t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(r._suggestedVisualTypeElementRefs=a)}},hostBindings:function(i,r){1&i&&t.\u0275\u0275listener("resize",function(){return r.onResize()},!1,t.\u0275\u0275resolveWindow)},inputs:{visualContainer:"visualContainer",label:"label",autoModeToggleLabel:"autoModeToggleLabel",withPerspectives:"withPerspectives",tooltip:"tooltip",numberOfSuggestionsToShow:"numberOfSuggestionsToShow",setFocusAfterInitialization:"setFocusAfterInitialization",noAutoToggleSwitch:"noAutoToggleSwitch",noSuggestions:"noSuggestions",allVisualsPickerInFlyout:"allVisualsPickerInFlyout",disabled$:"disabled$",host:"host",alwaysExpanded:"alwaysExpanded",allowSelectVisualTypeWhenNoVisual:"allowSelectVisualTypeWhenNoVisual",isVisualExcluded:"isVisualExcluded"},outputs:{onVisualTypeUpdated:"onVisualTypeUpdated"},features:[t.\u0275\u0275ProvidersFeature([Q.V,{provide:Q.B,useValue:H.Ys}]),t.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","visualPickerContainer",4,"ngIf"],[1,"visualPickerContainer"],["id","visualPickerTitle",4,"ngIf"],[1,"visualPicker",3,"ngClass"],["visualPicker",""],["class","suggestionsContainer",3,"ngClass",4,"ngIf"],["class","allVisualSelector white-background",3,"visualContainer","visualPluginFilter","showNonPersonalVisualizationPane$","nonPersonalVisualPluginFilter","visualConversionSource",4,"ngIf"],["class","autoVisualContainer",3,"ngClass",4,"ngIf"],["id","visualPickerTitle"],[1,"suggestionsContainer",3,"ngClass"],["id","suggestedVisualTypesContainer","aria-labelledby","visualPickerTitle","role","grid","aria-rowcount","1",1,"suggestions"],["role","row",1,"suggestionsRow"],["class","visualSymbol","role","gridcell",3,"tabindex","ngClass","disabled","ngStyle","pbiTooltip","click","keydown",4,"ngFor","ngForOf"],["class","glyphicon glyph-mini toggleAllVisualsButton",3,"ngClass","pbiTooltip","disabled","click",4,"ngIf"],["role","gridcell",1,"visualSymbol",3,"tabindex","ngClass","disabled","ngStyle","pbiTooltip","click","keydown"],["suggestedVisualTypeElement",""],[3,"sheet","symbolId"],[1,"glyphicon","glyph-mini","toggleAllVisualsButton",3,"ngClass","pbiTooltip","disabled","click"],["allVisualToggleButton",""],[1,"allVisualSelector","white-background",3,"visualContainer","visualPluginFilter","showNonPersonalVisualizationPane$","nonPersonalVisualPluginFilter","visualConversionSource"],[1,"autoVisualContainer",3,"ngClass"],[3,"toggle","isDisabled","pbiTooltip","toggleLabel","onToggleChange"]],template:function(i,r){1&i&&(t.\u0275\u0275template(0,yi,8,10,"div",0),t.\u0275\u0275pipe(1,"async")),2&i&&t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,1,r.visualViewModel$))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,hi.k,nt.I,rt.V,O,P.AsyncPipe,je.F],styles:['.visualPickerContainer[_ngcontent-%COMP%]{--visual-symbol-selected-background-color: var(--gray-40);--visual-symbol-selected-border-color: var(--gray-130)}  [data-legacy-theming=false] .visualPickerContainer{--visual-symbol-selected-background-color: var(--colorNeutralBackground1);--visual-symbol-selected-border-color: var(--colorNeutralStroke1)}.visualPickerContainer[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;display:block;margin-bottom:4px}.visualPickerContainer[_ngcontent-%COMP%]   .disabledVisualPicker[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--fluent-theme-white-color, #FFF);padding:3px;border:1px solid var(--gray-110);border-radius:2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsRow[_ngcontent-%COMP%]{display:flex;align-items:center}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer.withAllVisualsSelector[_ngcontent-%COMP%]{margin-bottom:3px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{display:flex;flex:1}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{height:24px;width:24px;padding:0;box-sizing:border-box;border:none;background-color:transparent;display:flex;align-items:center;justify-content:center}html:not([dir="rtl"])[_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{margin-right:2px}html[dir="rtl"][_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{margin-left:2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]   svg-use-symbol[_ngcontent-%COMP%]{height:20px;width:20px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol.selected[_ngcontent-%COMP%]{background-color:var(--visual-symbol-selected-background-color);border:1px solid var(--visual-symbol-selected-border-color)}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol.notSelected[disabled][_ngcontent-%COMP%]{opacity:.4}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{border:none;background-color:transparent;border-left:1px solid var(--gray-110);width:24px;box-sizing:border-box}html:not([dir="rtl"])[_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{padding:0 2px 0 6px}html[dir="rtl"][_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{padding:0 6px 0 2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker.withSuggestions[_ngcontent-%COMP%]   all-visual-selector[_ngcontent-%COMP%]{padding-top:3px;border-top:1px solid var(--gray-110)}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--gray-90)}.visualPickerContainer[_ngcontent-%COMP%]   .autoVisualContainer[_ngcontent-%COMP%]{margin-bottom:2px;margin-top:2px}']}),n}(k.w),Jt=l(64824),St=l(80649),Ci=l(73425),We=l(42587),at=l(76312),De=l(73795),ve=l(4633),st=l(17653),be=l(74082),lt=l(28199),Ue=l(13702),_t=l(5862),fe=l(72262),$e=l(50702),xt=l(48145),Ge=l(82214),bi=l(77919),Mt=l(1240);function Pi(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",11),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"toggle-switch-modern-lazy",12),t.\u0275\u0275listener("onToggleChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.crossReportDrillthroughAdapter.fn(a))}),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.viewModel.crossReportDrillthroughToggle.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275property("ariaLabelledby","cross-report-toggle-id")("toggle",i.viewModel.crossReportDrillthroughToggle.value)("isDisabled",i.viewModel.crossReportDrillthroughToggle.isDisabled)}}function Ot(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",13),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"toggle-switch-modern-lazy",12),t.\u0275\u0275listener("onToggleChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.filterPassingModeAdapter.fn(a))}),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.viewModel.filterPassingModeToggle.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275property("ariaLabelledby","keep-all-toggle-id")("toggle",i.viewModel.filterPassingModeToggle.value)("isDisabled",i.viewModel.filterPassingModeToggle.isDisabled)}}function Si(o,n){1&o&&t.\u0275\u0275element(0,"filter",14),2&o&&t.\u0275\u0275property("viewModel",n.$implicit)}function wt(o,n){1&o&&t.\u0275\u0275element(0,"filter",14),2&o&&t.\u0275\u0275property("viewModel",n.$implicit)}var _i=function(){function o(){}return o.prototype.transform=function(n){return n&&_.filter(n,function(e){return e&&e.contract&&!!e.contract.isTransient})},o.\u0275fac=function(e){return new(e||o)},o.\u0275pipe=t.\u0275\u0275definePipe({name:"isTransientFilter",type:o,pure:!1}),o}(),Ft=function(){function o(){}return o.prototype.transform=function(n){return n&&_.filter(n,function(e){return e&&e.contract&&!e.contract.isTransient})},o.\u0275fac=function(e){return new(e||o)},o.\u0275pipe=t.\u0275\u0275definePipe({name:"isNonTransientFilter",type:o,pure:!1}),o}(),Et=function(o){function n(e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M){var w=o.call(this)||this;return w.aggrOps=e,w.conceptualSchemaProxy=i,w.dataSources=r,w.displayNameService=a,w.dragDataService=s,w.elementRef=c,w.eventBridge=u,w.explorationCapabilities=d,w.explorationNavigation=g,w.featureSwitchService=v,w.lazyScoped=f,w.localizationService=m,w.scriptVisuals=y,w.selection=x,w.telemetryService=C,w.visualAuthoring=B,w.visualPlugin=M,w.useModernFormatPane=w.featureSwitchService.featureSwitches.useModernFormatPane,w.dropActionHandler=function(E){return w.getDropAction(E)},w}return(0,p.__extends)(n,o),n.prototype.ngOnInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r=this;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=We.j(e?.type,this.localizationService),this.isDestroyed=!1,this.viewModel={drillthroughFilters:[],filterPassingModeToggle:{name:"keepAllFilters",displayName:i.keepAllFiltersLabel,value:!1,isDisabled:!1,tooltip:i.keepAllFiltersTooltip,type:{bool:!0},show:!0,placeholder:"",isValid:!0},crossReportDrillthroughToggle:{name:"crossReportDrillthrough",displayName:i.crossReportDrillthroughLabel,value:!1,isDisabled:!1,tooltip:i.crossReportDrillthroughTooltip,type:{bool:!0},show:!1,placeholder:"",isValid:!0},resources:i},this.filterPassingModeAdapter=this.createEventAdapter(),this.crossReportDrillthroughAdapter=this.createEventAdapter(),this.filterPassingModeAdapter.$.pipe((0,st.b)(function(s){return r.viewModel.filterPassingModeToggle.value=s})).subscribe(function(){return r.onFilterPassingModeToggleChanged()}),this.crossReportDrillthroughAdapter.$.pipe((0,st.b)(function(s){return r.viewModel.crossReportDrillthroughToggle.value=s})).subscribe(function(){return r.onCrossReportDrillthroughToggleChanged()}),this.dropConfig={accept:"field"},this.onDestroy$.subscribe(function(){r.subscriptionManager&&r.subscriptionManager.unsubscribeAll(),r.isDestroyed=!0}),[4,this.createDrillthroughFilters()];case 1:return a.sent(),this.isDestroyed||(this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(I.Tuj,function(s,c){return r.onFilterContainerChanged(c)}).subscribe(I.yVh,function(){return r.onSectionChanged()}).subscribe(I.CCe,function(){return r.onModelChanged()}).subscribe(I.wAN,function(){return r.onCanvasChanged()}).subscribe(I.LE3,function(){return r.onExplorationLoaded()}).subscribe(I.mke,function(s,c){return r.onSectionFiltersContainerChanged(c)}),this.checkAndSetToggle(),(0,at.$o)(this.elementRef.nativeElement,function(s,c){return r.dropDrillthroughFilterFromField(c)})),[2]}})})},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext();return i&&i.field&&this.isSupportedDrillthroughFilterExpr(i.field)?Promise.resolve(3):Promise.resolve(0)},n.prototype.dropDrillthroughFilter=function(){var e=this.dragDataService.getDragContext();!e||!e.field||this.dropDrillthroughFilterFromField(e.field)},n.prototype.dropDrillthroughFilterFromField=function(e){var i=this.explorationNavigation.getCurrentSection();D.fF.assertValue(i,"No section"),(0,De.uE)(1,i,!0,this.dataSources,e,this.visualAuthoring,!0),this.checkAndSetToggle()},n.prototype.getFilterPaneUtilServices=function(){return{aggrOps:this.aggrOps,conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,displayNameService:this.displayNameService,eventBridge:this.eventBridge,explorationCapabilities:this.explorationCapabilities,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,scriptVisuals:this.scriptVisuals,selection:this.selection,telemetryService:this.telemetryService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin}},n.prototype.getKeepAllFiltersTooltipConfig=function(){var e=this.viewModel.filterPassingModeToggle;return{tooltipTitle:e.displayName,tooltipDescription:e.tooltip}},n.prototype.getCrossReportDrillthroughTooltipConfig=function(){var e=this.viewModel.crossReportDrillthroughToggle;return{tooltipTitle:e.displayName,tooltipDescription:e.tooltip}},n.prototype.getPaneTitleTooltipConfig=function(){var e=this.viewModel.resources;return{tooltipTitle:e.paneTitle,tooltipDescription:e.paneTitleTooltip}},n.prototype.onFilterPassingModeToggleChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=this.explorationNavigation.getCurrentExploration(),[4,this.lazyScoped.get("explorationAuthoring")];case 1:return s.sent().setDrillthroughFilterPassingMode(i,e,this.viewModel.filterPassingModeToggle.value),[2]}})})},n.prototype.onCrossReportDrillthroughToggleChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=this.explorationNavigation.getCurrentExploration(),[4,this.lazyScoped.get("explorationAuthoring")];case 1:return s.sent().setCrossReportDrillthrough(i,e,this.viewModel.crossReportDrillthroughToggle.value),[2]}})})},n.prototype.onSectionChanged=function(){var e=this.explorationNavigation.getCurrentSection();D.fF.assertValue(e,"section undefined in onSectionChanged"),this.viewModel.resources=We.j(e.type,this.localizationService),this.checkAndSetToggle()},n.prototype.onModelChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onCanvasChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onExplorationLoaded=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onFilterContainerChanged=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,r,a,s;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return i=this.viewModel.drillthroughFilters,r=this.getFilterPaneUtilServices(),(0,De.Rh)(r,1,i,e),e.filter&&5===e.filter.howCreated?(a=this.explorationNavigation.getCurrentExploration(),[4,(0,De.PJ)(this.dataSources,this.conceptualSchemaProxy)]):[3,2];case 1:s=c.sent(),(0,De.Z)(e,i,a,r,s),c.label=2;case 2:return this.checkAndSetToggle(),[2]}})})},n.prototype.isSupportedDrillthroughFilterExpr=function(e){return(0,be.kb)(e)||(0,be.t3)(e)||(0,be.ez)(e)||(0,be.wD)(e)},n.prototype.onSectionFiltersContainerChanged=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){switch(i.label){case 0:return e.container!==this.explorationNavigation.getCurrentSection()?[3,2]:[4,this.createDrillthroughFilters()];case 1:i.sent(),this.checkAndSetToggle(),i.label=2;case 2:return[2]}})})},n.prototype.createDrillthroughFilters=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return e=this.getFilterPaneUtilServices(),i=this.viewModel,[4,(0,De.JN)(e,5)];case 1:return i.drillthroughFilters=r.sent(),[2]}})})},n.prototype.checkAndSetToggle=function(){var e,i=this.explorationNavigation.getCurrentSection(),r=this.explorationNavigation.getCurrentExploration(),s=We.F(r,i,this.viewModel.resources,!0),c=(e=this.viewModel).filterPassingModeToggle,u=e.crossReportDrillthroughToggle;c.isDisabled=s.keepAllFilters.disabled,c.value=s.keepAllFilters.value,c.tooltip=s.keepAllFilters.tooltip,u.show=s.crossReportDrillthrough.show,u.isDisabled=s.crossReportDrillthrough.disabled,u.value=s.crossReportDrillthrough.value},n.prototype.trackByFn=function(e,i){return i?.id},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(lt.C),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(Ue.O),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(xt.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(_t.k),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(he.D))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["drillthrough-pane"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:18,vars:19,consts:[[1,"sectionHeader","drillthroughSectionHeader"],[1,"sectionTitle","sidePaneTitle","unselectable","largeFontSize",3,"pbi-tooltip"],[1,"drillthroughPane","filterPane","filterPaneClassic","propertyPaneContents"],[3,"pbi-tooltip"],["class","toggle-container",4,"ngIf"],[1,"cards",3,"drop","dropAction","dropHandler"],[1,"linkFieldFilters"],["dataAutomationType","filterCard",3,"viewModel",4,"ngFor","ngForOf","ngForTrackBy"],[1,"transientFilters"],[1,"unselectable","trimmedTextWithEllipsis",3,"ngClass"],[1,"toggle-container"],["id","cross-report-toggle-id",1,"toggle-text"],[3,"ariaLabelledby","toggle","isDisabled","onToggleChange"],["id","keep-all-toggle-id",1,"toggle-text"],["dataAutomationType","filterCard",3,"viewModel"]],template:function(i,r){1&i&&(t.\u0275\u0275elementStart(0,"h3",0)(1,"span",1),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(3,"section",2)(4,"div")(5,"div",3),t.\u0275\u0275template(6,Pi,4,4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",3),t.\u0275\u0275template(8,Ot,4,4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",5),t.\u0275\u0275listener("dropHandler",function(){return r.dropDrillthroughFilter()}),t.\u0275\u0275elementStart(10,"ul",6),t.\u0275\u0275template(11,Si,1,1,"filter",7),t.\u0275\u0275pipe(12,"isNonTransientFilter"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(13,"ul",8),t.\u0275\u0275template(14,wt,1,1,"filter",7),t.\u0275\u0275pipe(15,"isTransientFilter"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"div",9),t.\u0275\u0275text(17),t.\u0275\u0275elementEnd()()()()),2&i&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("pbi-tooltip",r.getPaneTitleTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",r.viewModel.resources.paneTitle," "),t.\u0275\u0275advance(3),t.\u0275\u0275property("pbi-tooltip",r.getCrossReportDrillthroughTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",r.viewModel.crossReportDrillthroughToggle.show&&r.useModernFormatPane),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbi-tooltip",r.getKeepAllFiltersTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",r.useModernFormatPane),t.\u0275\u0275advance(1),t.\u0275\u0275property("drop",r.dropConfig)("dropAction",r.dropActionHandler),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(12,15,r.viewModel.drillthroughFilters))("ngForTrackBy",r.trackByFn),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(15,17,r.viewModel.drillthroughFilters))("ngForTrackBy",r.trackByFn),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngClass",0===r.viewModel.drillthroughFilters.length?"dropzone":"end-dropzone"),t.\u0275\u0275attribute("tabindex",0===r.viewModel.drillthroughFilters.length?0:-1),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",0===r.viewModel.drillthroughFilters.length?r.viewModel.resources.dropZoneText:""," "))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,Ge.W,bi.z,nt.I,Mt.i,Ft,_i],styles:['.drillthroughPane[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:0 6px 4px 4px}.drillthroughPane[_ngcontent-%COMP%]   ul.transientFilters[_ngcontent-%COMP%]{font-style:italic}.modern[_nghost-%COMP%]   .drillthroughSectionHeader[_ngcontent-%COMP%]{padding:6px 4px 4px;font-size:unset;margin-left:8px}.modern[_nghost-%COMP%]   .drillthroughSectionHeader[_ngcontent-%COMP%]   .sectionTitle[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600);margin:0;line-height:16px}.modern[_nghost-%COMP%]   .toggle-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 0;margin-left:8px}.modern[_nghost-%COMP%]   .filterPane[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{margin-top:5px}.filterPane[_ngcontent-%COMP%]{--field-well-title-color: var(--gray-180, #252423);--field-well-bucket-border-color: var(--gray-60, #C8C6C4);float:left;width:100%;box-sizing:border-box;padding:0 6px 4px 4px;overflow:visible}  [data-legacy-theming=false] .filterPane{--field-well-title-color: var(--colorNeutralForeground1);--field-well-bucket-border-color: var(--colorNeutralStroke1)}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]:focus{outline:none}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;margin:6px 5px 6px 0;box-sizing:border-box;font-weight:inherit}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{margin-left:12px;font-size:var(--sm-font-size, 12px)}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]:focus{outline:none}.filterPane[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{float:left;width:100%;box-sizing:border-box;background-color:var(--fluent-theme-white-color, #FFF);border:1px dashed var(--field-well-bucket-border-color);border-radius:2px}.filterPane[_ngcontent-%COMP%]   .cards.append[_ngcontent-%COMP%]{border-color:var(--gray-130, #605E5C)}.filterPane[_ngcontent-%COMP%]   .dropzone[_ngcontent-%COMP%]{color:var(--field-well-title-color);padding:4px 8px}html[data-focus-source=key][_ngcontent-%COMP%]   .filterPane[_ngcontent-%COMP%]   .dropzone[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.filterPane[_ngcontent-%COMP%]   .end-dropzone[_ngcontent-%COMP%]{height:8px}']}),n}(k.w),Te=l(84431),ke=l(15580),me=l(21728),Yt=l(66794),ct=l(41606),xi=l(55201),ut=l(65302),Vt=l(5265),Dt=l(34763),Tt=l(37272),ze=l(81905),At=l(8082),Me=l(15393),It=l(23983),He=l(85677),Ke=l(88409),Ae=l(40702),we=l(14463);function Mi(o,n,e){return o?e.get(o):n.reject()}var Oi=l(12587),Fe=l(59017),X=l(14172),wi=l(57243),Qe=l(28149),Fi=l(77200),Ei=l(74913),Vi=l(79930),Bt=l(89839),On=l(37335),wn=l(47755),Di=l(54766),Xe=l(54834),kt=l(42342),Fn=l(50550),En=l(79602),Ti=l(19008),qt=l(80366),Ai=l(76001),zt=l(94419),Le=l(45551),_e=l(45413),Ii=l(58295),Bi=l(58609),ei=l(54165),ti=l(67660),ii=l(62812),Vn=l(5467),Lt=l(83309),Dn=l(53267),Ee=l(17174),ki=l(44581),Tn=l(24150),zi=l(45916);function An(o,n){if(1&o&&t.\u0275\u0275element(0,"div",13)(1,"div",14),2&o){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("textContent",e.viewModel.displayOptions.tooltipTitle),t.\u0275\u0275advance(1),t.\u0275\u0275property("textContent",e.viewModel.displayOptions.tooltipDescription)}}function In(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"i",15),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.editLabel())}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"pbi-svg-use-symbol",16),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.editableLabelAriaLabel$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("sheet","fieldListPaneIcons")("symbolId","fieldListError")}}function Bn(o,n){1&o&&t.\u0275\u0275element(0,"tri-svg-icon",17)}function kn(o,n){if(1&o&&t.\u0275\u0275element(0,"i",18),2&o){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",e.viewModel.displayOptions.glyph)}}function zn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"input",19),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.editableLabelName=a)}),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngModel",i.editableLabelName),t.\u0275\u0275attribute("maxlength",i.maxInputlength)}}function Ln(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",20),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.toggleHiddenProjection(a))}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"tri-svg-icon",21),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.tooltipForHide$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("name",t.\u0275\u0275pipeBind1(3,5,i.iconNameForHide$))("pbiTooltip",t.\u0275\u0275pipeBind1(4,7,i.tooltipForHide$))}}function Nn(o,n){1&o&&t.\u0275\u0275element(0,"pbi-svg-use-symbol",24)}var Rn=function(n){return{"glyphicon glyph-mini pbi-glyph-chevrondownsmall":n}};function jn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",22),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.showMenu(a))}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275template(2,Nn,1,0,"pbi-svg-use-symbol",23),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,Rn,i.newPaneColorsEnabled)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.editableLabelAriaLabel$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.newPaneColorsEnabled)}}function Wn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",25),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.deleteFieldAndFocus(a))}),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",i.removeAriaLabel)}}function Un(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"li",28),t.\u0275\u0275element(1,"span",29),t.\u0275\u0275elementStart(2,"button",25),t.\u0275\u0275listener("click",function(s){var u=t.\u0275\u0275restoreView(e).index,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.deleteFieldAndFocus(s,u))}),t.\u0275\u0275elementEnd()()}if(2&o){var i=n.$implicit,r=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275property("textContent",i.displayName),t.\u0275\u0275attribute("aria-label",i.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275attribute("aria-label",r.removeAriaLabel)}}function $n(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"ol",26),t.\u0275\u0275template(1,Un,3,3,"li",27),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.viewModel.hierarchyLevels)}}var Gn=function(n,e){return{"can-prepend":n,"not-draggable":e}};function Hn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"li",1),t.\u0275\u0275listener("dropHandler",function(s){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.drop(s.event,s.ui,s.dropAction))}),t.\u0275\u0275template(1,An,2,2,"ng-template",null,2,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementStart(3,"h2",3),t.\u0275\u0275listener("contextmenu",function(s){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.showMenu(s))}),t.\u0275\u0275template(4,In,3,5,"i",4),t.\u0275\u0275template(5,Bn,1,0,"tri-svg-icon",5),t.\u0275\u0275pipe(6,"async"),t.\u0275\u0275template(7,kn,1,1,"i",6),t.\u0275\u0275elementStart(8,"div",7),t.\u0275\u0275listener("dblclick",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.editLabel())})("keydown.enter",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.editLabel())})("keydown.space",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.editLabel())})("click",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.editVisualCalc())}),t.\u0275\u0275pipe(9,"async"),t.\u0275\u0275template(10,zn,1,2,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(11,Ln,5,9,"button",9),t.\u0275\u0275pipe(12,"async"),t.\u0275\u0275template(13,jn,3,7,"button",10),t.\u0275\u0275template(14,Wn,1,1,"button",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(15,$n,2,1,"ol",12),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275reference(2),r=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(30,Gn,!r.viewModel.interactivityOptions.isReplaceable,!r.viewModel.interactivityOptions.isDraggableField))("drag","field")("dragDisabled",!r.viewModel.interactivityOptions.isDraggableField)("getDragContext",r.getDragContext)("drop",r.dropConfig)("dropAction",r.dropActionHandler)("dropContainerId",r.fieldDropUniqueId)("pbiTooltip",i)("pbiTooltipDisabled",r.isTooltipDisabled)("pbiTooltipHideDelay",100)("pbiTooltipMaxHeight","92vh")("pbiTooltipPosition","before"),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",!r.viewModel.valid),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(6,24,r.hasVisualCalcExpression$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",r.viewModel.displayOptions.glyph),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pipeBind1(9,26,r.displayNameStyle$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("pbiEditableLabel",r.pbiEditableLabelOptions)("pbiEditableLabelValue",r.currentDisplayName)("pbiEditableLabelMode",r.viewModel.isEditingLabel)("pbiEditableLabelEditable",r.viewModel.isEditingLabel),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(12,28,r.showHideButton$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",r.viewModel.interactivityOptions.hasContextMenu),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",r.viewModel.interactivityOptions.isRemovableField),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",r.viewModel.hierarchyLevels)}}var Li=function(o){function n(e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w,E,G,te,ee,le,ue,re,Ce){var N=o.call(this)||this;return N.changeDetection=e,N.conceptualSchemaProxy=i,N.contextActivityService=r,N.dataSources=a,N.dragDataService=s,N.element=c,N.eventBridge=u,N.explorationCapabilities=d,N.explorationNavigation=g,N.featureSwitchService=v,N.groupAuthoring=f,N.lazyScoped=m,N.localizationService=y,N.modelChangeHandler=x,N.pbiMenuService=C,N.promiseFactory=B,N.screenReaderService=M,N.selection=w,N.showValueAsService=E,N.sparklinesService=G,N.telemetryService=te,N.themeService=ee,N.visibilityService=le,N.visualAuthoring=ue,N.visualCalcEagerService=re,N.visualPlugin=Ce,N.maxInputlength=100,N.getDragContext=function(){return{sourceIndex:N.viewModel.startIndex,sourceRole:N.viewModel.role,hierarchyLevelCount:N.viewModel.hierarchyLevels.length}},N.fieldDropUniqueId=_.uniqueId("fieldDropUniqueId"),N.element.nativeElement.id=N.fieldDropUniqueId,N.pbiEditableLabelOptions={disableClick:!0,customTooltip:!0,inputMatchLabelWidth:!1,onEdit:function(){return N.editLabel()},onBlur:function(){return N.rename()}},N.showFieldTooltip=N.localizationService.get("Visual_Calculation_Field_Well_Show_In_Visual"),N.hideFieldTooltip=N.localizationService.get("Visual_Calculation_Field_Well_Hide_From_Visual"),N.tooltipConfigManager={getTooltipConfig:function(){return{tooltipTitle:N.viewModel.displayOptions.tooltipTitle,tooltipDescription:N.viewModel.displayOptions.tooltipDescription}}},N.dropConfig={accept:"field",greedy:!1},N.removeAriaLabel=N.localizationService.get("FieldWell_Remove"),N.newPaneColorsEnabled=N.explorationCapabilities.getCapabilities().showFluentDesign||N.featureSwitchService.featureSwitches&&N.featureSwitchService.featureSwitches.paneColorRefresh,N}return(0,p.__extends)(n,o),Object.defineProperty(n.prototype,"currentDisplayName",{get:function(){return this.viewModel.displayOptions.displayName},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.core=new Ni({conceptualSchemaProxy:this.conceptualSchemaProxy,contextActivityService:this.contextActivityService,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,lazyScoped:this.lazyScoped,localizationService:this.localizationService,modelChangeHandler:this.modelChangeHandler,promiseFactory:this.promiseFactory,screenReaderService:this.screenReaderService,selection:this.selection,showValueAsService:this.showValueAsService,sparklinesService:this.sparklinesService,telemetryService:this.telemetryService,themeService:this.themeService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visibilityService:this.visibilityService,visualCalcEagerService:this.visualCalcEagerService},function(){ut.IK.focus($(e.element.nativeElement).find(".fieldWellIcon.dropDown")[0])}),this.core.viewModel=this.viewModel,this.core.bucketDisplayName=this.bucketDisplayName;var r=this.element.nativeElement;r&&(0,at.$o)(r,function(s,c,u){return e.core.dropField(c,e.getFieldDropAction(u))},function(s){return e.getFieldDropAction(s)}),this.dropActionHandler=function(s){return Promise.resolve(e.getDropAction(s))},this.editableLabelName=this.currentDisplayName;var a=this.changes$("viewModel").pipe((0,wi.d)());this.hasVisualCalcExpression$=a.pipe((0,X.U)(function(s){var c=s.expr;return s.valid&&!!c&&(0,be.jX)(c)}),(0,T.R)(this.onDestroy$)),this.iconNameForHide$=a.pipe((0,X.U)(function(s){return s?.isHiddenInVisual?"eye_off_16_regular":"eye_16_regular"}),(0,T.R)(this.onDestroy$)),this.tooltipForHide$=a.pipe((0,X.U)(function(s){return s?.isHiddenInVisual?e.showFieldTooltip:e.hideFieldTooltip}),(0,T.R)(this.onDestroy$)),this.showHideButton$=(0,Fe.aj)([a,this.visibilityService.get$(16)]).pipe((0,X.U)(function(s){var c=s[0],u=s[1],d=c?.expr;return null!=d&&((0,Ii.k)(d)||(0,be.jX)(d))&&16===u?.visibility}),(0,T.R)(this.onDestroy$)),this.editableLabelAriaLabel$=a.pipe((0,X.U)(function(s){return e.getEditableLabelAriaLabel(s)})),this.displayNameStyle$=(0,Fe.aj)([a,this.visibilityService.get$(16)]).pipe((0,X.U)(function(s){var c=s[0],u=s[1];if(16===u?.visibility)return c.displayOptions.pbiStyle}),(0,T.R)(this.onDestroy$)),this.changeDetection.detectChanges()},Object.defineProperty(n.prototype,"isTooltipDisabled",{get:function(){var i=this.viewModel.displayOptions;return _.isEmpty(i.tooltipDescription)&&_.isEmpty(i.tooltipTitle)},enumerable:!1,configurable:!0}),n.prototype.onDestroy=function(){this.core.onDestroy()},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext(),r=this.viewModel.interactivityOptions,a=r.canAppend?3:2;if(i&&r.isDroppableField&&(r.canAppend||r.canPrepend)){var s=i.sourceRole;if(s){var c=i.hierarchyLevelCount||1,u=i.sourceIndex,d=!r.canPrepend||(0,kt.wc)(e);if(this.core.getTargetIndex(s,u,c,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},d)<0)return 0}r.isReplaceable&&r.isReplaceOnly?a=1:(0,kt.W6)(e)&&r.canPrepend&&(a=2)}else a=0;return a},n.prototype.drop=function(e,i,r){var a=this.dragDataService.getDragContext();this.core.dropWithPayloadAndAction(a,r)},n.prototype.deleteField=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,this.core.deleteField(e)]})})},n.prototype.deleteFieldAndFocus=function(e,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(r){return[2,this.core.deleteFieldAndFocus(e,i)]})})},n.prototype.selectFieldMenuItem=function(e){this.core.selectFieldMenuItem(e)},n.prototype.showMenu=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a=this;return(0,p.__generator)(this,function(s){return e.preventDefault(),i={anchorElement:$(e.currentTarget)},this.pbiMenuService.open(On.p.getPbiMenuConfig(this.viewModel.interactivityOptions.dropDownItems,e.currentTarget,!1,!1,i)).onButtonClick$.pipe((0,S.q)(1)).subscribe(function(c){a.selectFieldMenuItem(c.id)}),e.keyCode===$.ui.keyCode.SPACE&&e.stopPropagation(),[2]})})},n.prototype.editLabel=function(){this.core.editLabel()},n.prototype.cancelRename=function(){this.core.cancelRename(),this.changeDetection.detectChanges()},n.prototype.rename=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.core.rename(this.editableLabelName)];case 1:return e.sent(),this.cancelRename(),[2]}})})},n.prototype.toggleHiddenProjection=function(e){return e.preventDefault(),this.toggleFieldHidden()},n.prototype.editVisualCalc=function(){var e;if(16===(null===(e=this.visibilityService.get(16))||void 0===e?void 0:e.visibility)){var r=this.viewModel.expr;null!==r&&(0,be.jX)(r)&&this.core.editVisualCalculation()}},n.prototype.toggleFieldHidden=function(){var e=this.viewModel.role,i=this.viewModel.startIndex,r=this.core.getSelectedVisual(),a=this.dataSources.get();return this.visualAuthoring.toggleFieldHidden(e,i,r,a)},n.prototype.getFieldDropAction=function(e){var i=this.viewModel.interactivityOptions;return i.isDroppableField&&(i.canAppend||i.canPrepend)?i.isReplaceable&&i.isReplaceOnly?1:(0,kt.W6)(e)&&i.canPrepend?2:(0,kt.wc)(e)&&i.canAppend?3:0:0},n.prototype.getEditableLabelAriaLabel=function(e){var i=e.displayOptions.displayName;return _.isString(e.displayOptions.tooltipTitle)&&(i=_.isString(i)?i.concat(". ",e.displayOptions.tooltipTitle):e.displayOptions.tooltipTitle),_.isString(e.displayOptions.tooltipDescription)&&(i=_.isString(i)?i.concat(". ",e.displayOptions.tooltipDescription):e.displayOptions.tooltipDescription),i},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(de.r),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(xt.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Qe.RD),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(ei.x),t.\u0275\u0275directiveInject(Vn.o),t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(Lt.g),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(He.P),t.\u0275\u0275directiveInject(ii.s),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(ti.f),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(Ke.w),t.\u0275\u0275directiveInject(he.D))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["field-well-field-modern"]],inputs:{bucketDisplayName:"bucketDisplayName",viewModel:"viewModel"},features:[t.\u0275\u0275ProvidersFeature([Vi.Wg]),t.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["role","listitem","class","fieldWellProperty","data-testid","field-well-property",3,"ngClass","drag","dragDisabled","getDragContext","drop","dropAction","dropContainerId","pbiTooltip","pbiTooltipDisabled","pbiTooltipHideDelay","pbiTooltipMaxHeight","pbiTooltipPosition","dropHandler",4,"ngIf"],["role","listitem","data-testid","field-well-property",1,"fieldWellProperty",3,"ngClass","drag","dragDisabled","getDragContext","drop","dropAction","dropContainerId","pbiTooltip","pbiTooltipDisabled","pbiTooltipHideDelay","pbiTooltipMaxHeight","pbiTooltipPosition","dropHandler"],["tooltipTemplateRef",""],[1,"flex","smallFontSize",3,"contextmenu"],["tabindex","0","role","button","class","errorIcon error item-auto",3,"accessible-click",4,"ngIf"],["class","fieldIcon","sprite","visual-calc-icons","name","data_histogram_function_20_regular",4,"ngIf"],["class","field-glyph glyphicon glyph-mini",3,"ngClass",4,"ngIf"],["tabindex","0",1,"item-fill","propertyText","propertyContent","caption","trimmedTextWithEllipsis","fieldWellFieldEditableLabel",3,"ngStyle","dblclick","keydown.enter","keydown.space","click"],[3,"ngModel","ngModelChange",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable"],["role","button","class","actionButton",3,"click",4,"ngIf"],["role","button","aria-expanded","false","class","fieldWellIcon dropDown item-auto",3,"ngClass","click",4,"ngIf"],["class","delete glyphicon pbi-glyph-close glyph-micro",3,"click",4,"ngIf"],["class","hierarchyList",4,"ngIf"],[1,"tooltipTitle",3,"textContent"],[1,"fieldTooltipDescription",3,"textContent"],["tabindex","0","role","button",1,"errorIcon","error","item-auto",3,"accessible-click"],[3,"sheet","symbolId"],["sprite","visual-calc-icons","name","data_histogram_function_20_regular",1,"fieldIcon"],[1,"field-glyph","glyphicon","glyph-mini",3,"ngClass"],[3,"ngModel","ngModelChange"],["role","button",1,"actionButton",3,"click"],["tri-svg-icon-16","","sprite","fluentui-icons",1,"eyeIcon",3,"name","pbiTooltip"],["role","button","aria-expanded","false",1,"fieldWellIcon","dropDown","item-auto",3,"ngClass","click"],["sheet","fieldListPaneIcons","symbol-id","fieldListDropdown",4,"ngIf"],["sheet","fieldListPaneIcons","symbol-id","fieldListDropdown"],[1,"delete","glyphicon","pbi-glyph-close","glyph-micro",3,"click"],[1,"hierarchyList"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],["tabindex","0",1,"subcaption","trimmedTextWithEllipsis","item-fill",3,"textContent"]],template:function(i,r){1&i&&t.\u0275\u0275template(0,Hn,16,33,"li",0),2&i&&t.\u0275\u0275property("ngIf",r.core)},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,Dn.w,Ge.W,Ee.Fj,Ee.JJ,Ee.On,ki.t,Tn.D,zi.R,rt.V,Ei.M,P.AsyncPipe],styles:[".fieldWellFieldEditableLabel[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:none}.tooltipTitle[_ngcontent-%COMP%]{font-weight:700}.fieldTooltipDescription[_ngcontent-%COMP%]{max-width:240px;display:block;position:relative;word-break:break-word;white-space:pre-wrap}.fieldIcon[_ngcontent-%COMP%]{margin-right:4px}.actionButton[_ngcontent-%COMP%]{background:transparent;margin-right:4px;margin-top:-4px}.eyeIcon[_ngcontent-%COMP%]{--eye-icon-fill: var(--gray-140);fill:var(--eye-icon-fill)}  [data-legacy-theming=false] .eyeIcon{--eye-icon-fill: var(--colorNeutralForeground1)}"]}),n}(Oi.w),Ni=function(){function o(n,e,i){this.services=n,this.onContextMenuActionFailed=e,this.onLabelInEditingModeChanged=i}return o.prototype.onDestroy=function(){this.dataBarsDialogRef&&this.dataBarsDialogRef.close()},o.prototype.dropWithPayloadAndAction=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,a,s,c,u,d,g,v,f;return(0,p.__generator)(this,function(m){return r=n,a=this.viewModel,s=this.services.dataSources.get(),c=16===(null===(i=this.services.visibilityService.get(16))||void 0===i?void 0:i.visibility),(u=r.sourceRole)?[2,!((v=this.getTargetIndex(u,g=r.sourceIndex,d=r.hierarchyLevelCount||1,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},3===e))<0)&&this.services.visualAuthoring.moveField(u,a.role,g,v,d,s,c)]:(f=n).field?[2,this.dropField(f.field,e)]:[2,!1]})})},o.prototype.dropField=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,a,s,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return r=this.services.dataSources.get(),a=_.size(this.viewModel.hierarchyLevels),s=this.getSelectedVisual(),this.viewModel.interactivityOptions.isReplaceable&&(this.viewModel.interactivityOptions.isReplaceOnly||1===e)?(this.viewModel.isInsideAutoVisualBucket||((0,W.PQ)(s).autoSelectVisualType=void 0),[4,this.checkToRestoreOrMergeLevelToHierarchy(n,r)]):[3,2];case 1:return d.sent()?[2,!0]:[2,this.services.visualAuthoring.replaceField(n,this.viewModel.role,this.viewModel.startIndex,s,r,a>0?a:void 0)];case 2:return u=16===(null===(i=this.services.visibilityService.get(16))||void 0===i?void 0:i.visibility),[2,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,r,s,3===e?this.viewModel.startIndex+Math.max(a,1):this.viewModel.startIndex,void 0,void 0,u)]}})})},o.prototype.editLabel=function(){var n=this.viewModel;n.interactivityOptions.isEditableField&&(n.isEditingLabel=!0,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!0))},o.prototype.deleteField=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return null!==this.viewModel.expr&&(0,be.jX)(this.viewModel.expr)&&(e=this.getSelectedVisual(),i=(0,W.$Z)(e,this.viewModel.role,this.viewModel.startIndex),this.services.visualCalcEagerService.deleteVisualCalc(i)),[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return r=a.sent(),this.services.visualAuthoring.removeFieldFromRole({role:this.viewModel.role,projOptions:{fieldIndex:this.viewModel.startIndex+(n||0)},count:_.isNumber(n)?1:this.viewModel.hierarchyLevels.length||1},r),this.logDeleteTelemetry(),[2]}})})},o.prototype.deleteFieldAndFocus=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return n&&n.stopPropagation(),[4,this.deleteField(e)];case 1:return r.sent(),En.l.setTimeout(function(){i.services.eventBridge.publishToChannel(I.Ah$,i.bucketDisplayName)}),[2]}})})},o.prototype.cancelRename=function(){this.viewModel.isEditingLabel=!1,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!1)},o.prototype.rename=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r,a,s;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return n===(e=this.viewModel.displayOptions).displayName||null==(i=this.getSelectedVisual())?[2]:(r=i.config.singleVisual.query,a=i&&i.name,s=i&&i.config.singleVisual.visualType,i&&r&&r.projections&&r.projections[this.viewModel.role]&&this.viewModel.visualContainerName===a?(e.displayName=n,[4,this.services.visualAuthoring.setDisplayNameAlias(i,{fieldIndex:this.viewModel.startIndex},this.viewModel.role,n)]):(this.services.telemetryService.logEvent(Ae.jG,{originalVisualContainerName:this.viewModel.visualContainerName,originalVisualType:this.viewModel.visualType,currentVisualContainerName:a,currentVisualType:s}),[2]));case 1:return c.sent(),this.cancelRename(),[2]}})})},o.prototype.selectFieldMenuItem=function(n){switch(D.fF.assertValue(n,"Expected a menu item option."),n.action){case 32768:this.editLabel();break;case 1:this.deleteFieldAndFocus();break;case 4:this.setAggregate(this.viewModel,n.aggregate);break;case 2:this.removeAggregate(this.viewModel);break;case 8:this.toggleShowAll(this.viewModel);break;case 128:this.setVariation(this.viewModel,n.variationExpr);break;case 32:this.setShowValueAs(this.viewModel,n.showValueAs);break;case 64:this.showQuickCalcDialog();break;case 256:this.showGroupsDialog(this.viewModel,!0);break;case 512:this.showGroupsDialog(this.viewModel,!1);break;case 1024:this.showEditClusteringDialogAsync(this.viewModel);break;case 2048:this.restoreHierarchy();break;case 4096:this.setConditionalFormatting(n.conditionalFormattingOptions);break;case 16384:this.removeConditionalFormatting(n.conditionalFormattingOptions);break;case 8192:this.removeConditionalFormattingAll();break;case 65536:this.moveField(n.moveFieldPropertyOptions,!1);break;case 131072:this.moveField(n.moveFieldPropertyOptions,!0);break;case 262144:this.moveToBucket(n.moveFieldBucketOptions);break;case 2097152:this.showSparklinesDialog(!1);break;case 33554432:this.editVisualCalculation();break;case 4194304:this.showSparklinesDialog(!0);break;case 16777216:case 8388608:this.switchQueryParameter();break;default:D.fF.assertFail("Invalid action.")}},o.prototype.restoreHierarchy=function(){var n=this.getAuthoringContext();return n?this.services.visualAuthoring.expandHierarchy(n.dataSources,n.visual,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length):Promise.resolve(!1)},o.prototype.editVisualCalculation=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,e,i;return(0,p.__generator)(this,function(r){return n=this.getSelectedVisual(),e=(0,W.$Z)(n,this.viewModel.role,this.viewModel.startIndex),i=(0,Bi.hF)(this.services.contextActivityService,{name:"VisualAction",visualName:n.name,data:{action:"EditVisualCalculation",source:"ContextMenu",contextMenuType:"FieldWell"}}),[2,this.services.visualCalcEagerService.enterVisualCalcMode(n,e,i)]})})},o.prototype.getTargetIndex=function(n,e,i,r,a){var s=r.startIndex;if(a&&(s+=r.hierarchyLevelsLength||1),n===r.role){if(s===e||s===e+i)return-1;s>e&&(s=Math.max(s-i,0))}return s},o.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},o.prototype.checkToRestoreOrMergeLevelToHierarchy=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,c,u,d,g,v,f,m,y,x,B=this;return(0,p.__generator)(this,function(M){switch(M.label){case 0:return r=this.viewModel.hierarchyLevels,_.size(r)>0?(c=null===(i=_.first(r))||void 0===i?void 0:i.expr,[4,this.services.conceptualSchemaProxy.get(e)]):[2,!1];case 1:return u=M.sent(),(0,be.t3)(n)&&(0,Le.K8)(u,n)&&(0,_e.fS)((0,Le.ZB)(c),n)?(f=(0,Le.wA)(u,n),_.size(f)===_.size(r)?[2,!0]:[4,this.restoreHierarchy()]):[3,3];case 2:if(M.sent())return[2,!0];M.label=3;case 3:return(0,be.y3)(n)?(d=!1,n.arg instanceof zt.c7?(g=(0,Le.cH)(c),d=(0,_e.fS)(g,n.arg)):(v=(0,Le.uW)(c),d=(0,_e.fS)(v,n)),d?(f=(0,Le.wA)(u,n),_.size(f)===_.size(r)?[2,!0]:[4,this.restoreHierarchy()]):[3,5]):[3,5];case 4:if(M.sent())return[2,!0];M.label=5;case 5:return(0,be.ez)(n)?(f=(0,Le.wA)(u,this.viewModel.expr),_.isArray(f)&&_.find(f,function(w){return(0,_e.fS)(w,n)})?_.find(this.viewModel.hierarchyLevels,function(w){return(0,_e.fS)(w.expr,n)})?[2,!0]:(m=_.findIndex(f,function(w){return(0,_e.fS)(w,n)}),y=-1,_.findLast(f.slice(0,m),function(w){var E=_.findIndex(B.viewModel.hierarchyLevels,function(G){return(0,_e.fS)(G.expr,w)});if(-1!==E)return y=E,!0}),x=-1!==y?y+1:0,[4,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,e,this.getSelectedVisual(),this.viewModel.startIndex+x)]):[3,7]):[3,7];case 6:if(M.sent())return[2,!0];M.label=7;case 7:return[2,!1]}})})},o.prototype.switchQueryParameter=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return n=e.sent(),this.services.visualAuthoring.switchQueryParameter(n,this.viewModel.startIndex,this.viewModel.role),[2]}})})},o.prototype.setAggregate=function(n,e){D.fF.assertValue(e,"Must specify a new aggregate.");var i=this.getAuthoringContext();if(i){var r=(0,qt._L)((0,Ai.Q)(n.expr)),a=this.services.visualAuthoring.setAggregate(this.viewModel.role,this.viewModel.startIndex,e,i.visual,i.dataSources);return(0,Bt.l)(n,i.visual),this.services.telemetryService.logEvent(Ae.TS,{original:(0,Ti.b)(r),target:(0,Ti.b)(e),visualName:i.visual.name}),a}},o.prototype.setVariation=function(n,e){var i=this.getAuthoringContext();i&&this.services.visualAuthoring.setVariation(i.dataSources,i.visual,e,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length)},o.prototype.removeAggregate=function(n){var e=this.getAuthoringContext();e&&(this.services.visualAuthoring.removeAggregate(this.viewModel.role,this.viewModel.startIndex,e.visual,e.dataSources),(0,Bt.l)(n,e.visual))},o.prototype.toggleShowAll=function(n){var e=this.getAuthoringContext();e&&(this.services.visualAuthoring.toggleShowAll(n.role,e.visual),(0,Bt.l)(n,e.visual))},o.prototype.showQuickCalcDialog=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,e,i,r;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return(n=this.getAuthoringContext())?(r=n.visual.config.singleVisual.query.tryGetExpr(e=this.viewModel.role,i=this.viewModel.startIndex),[4,this.services.lazyScoped.get("quickMeasures")]):[2];case 1:return a.sent().launchQuickMeasures(r,"FieldWell",void 0,{visualContainer:n.visual,index:i,role:e}),[2]}})})},o.prototype.showSparklinesDialog=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r,a,s,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return(e=this.getAuthoringContext())?(a=e.visual.config.singleVisual.query.tryGetExpr(i=this.viewModel.role,r=this.viewModel.startIndex),n?[3,2]:[4,this.services.sparklinesService.showCreateDialog(a)]):[2];case 1:return(s=d.sent())&&(c=Xe.ib.deserializeExpr(s.measure),u=Xe.ib.deserializeExpr(s.grouping),this.services.sparklinesService.addSparklinesToVisual(c,u,e.visual)),[3,4];case 2:return[4,this.services.sparklinesService.showEditDialog(a)];case 3:(s=d.sent())&&(c=Xe.ib.deserializeExpr(s.measure),u=Xe.ib.deserializeExpr(s.grouping),this.services.sparklinesService.updateSparklinesExpr(c,u,e.visual,i,r)),d.label=4;case 4:return[2]}})})},o.prototype.showGroupsDialog=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,r,a,s,c,u,d=this;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return i=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(i)];case 1:r=g.sent(),a=n.expr.getTargetEntity(),s=n.expr.getConceptualProperty(r),c={schema:a.schema,entity:a.entity,name:e?null:s.name,sourcePropertyName:e?s.name:null,isNew:e},u=this.services.modelChangeHandler.register(function(v){return d.handleNewGroupsBins(a,n,v),d.services.promiseFactory.resolve()}),g.label=2;case 2:return g.trys.push([2,,4,5]),[4,this.services.groupAuthoring.openGroupDialog(c)];case 3:return g.sent(),[3,5];case 4:return u.stopHandling(),[7];case 5:return[2]}})})},o.prototype.handleNewGroupsBins=function(n,e,i){var r,a=_.find(i.changes,function(g){return g.newBins});a&&(r=(0,zt.Oh)(n,a.newBins.name));var s=_.find(i.changes,function(g){return g.newGroups});if(s){var c=(0,wn.vB)(s.newGroups.definition);r=(0,zt.Wp)(s.newGroups.name,n,[c.groupedColumns[0]])}if(r){var d=this.services.dataSources.get();this.services.visualAuthoring.replaceField(r,e.role,e.startIndex,this.getSelectedVisual(),d)}},o.prototype.showEditClusteringDialogAsync=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,this.services.lazyScoped.get("clustering")];case 1:return[4,i.sent().editClustering((0,Ai.Q)(n.expr),this.services.dataSources.get())];case 2:return i.sent(),[2]}})})},o.prototype.setShowValueAs=function(n,e){var i=this,r=this.getAuthoringContext();if(r){var a=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(a).then(function(s){var c={dataSources:a,roleIndex:i.viewModel.startIndex,visual:r.visual,visualDataRole:i.getVisualDataRole()},d=_.find(n.interactivityOptions.dropDownItems.items,function(v){return v.key&&16===v.key.action}),g=_.find(d.children,function(v){return v.checked});i.services.showValueAsService.applyShowValueAs(c,g.key.showValueAs,e),(0,Bt.l)(n,r.visual)})}},o.prototype.logDeleteTelemetry=function(){var n=Mi(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy),e=(0,R.s)(this.getSelectedVisual());this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(n,this.viewModel.expr,e,null,this.viewModel.role,"Delete")},o.prototype.moveField=function(n,e){var i=this.viewModel.hierarchyLevels.length||1,r=this.getTargetIndex(this.viewModel.role,this.viewModel.startIndex,i,n,e);r>=0&&this.services.visualAuthoring.moveField(this.viewModel.role,n.role,this.viewModel.startIndex,r,i,this.services.dataSources.get(),!1)},o.prototype.moveToBucket=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.services.visualAuthoring.moveField(this.viewModel.role,n.role,this.viewModel.startIndex,n.targetIndex,this.viewModel.hierarchyLevels.length||1,this.services.dataSources.get(),!1)];case 1:return a.sent()||(r=this.services.localizationService.format("Invalid_FieldWellBucket_Move",[this.viewModel.displayOptions.displayName,n.displayName]),this.services.screenReaderService.alert(r),this.onContextMenuActionFailed&&this.onContextMenuActionFailed()),[2]}})})},o.prototype.setConditionalFormatting=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r,a,s,c,u,d,g,v,f,m,y,C,B,M,E,G,te;return(0,p.__generator)(this,function(ee){switch(ee.label){case 0:return e=this.getSelectedVisual(),i=this.services.dataSources.get(),r=this.viewModel,a=this.services.featureSwitchService.featureSwitches,s=a?.conditionalTablixWebURL,c=a?.dataBarsUpdate,[4,this.services.conceptualSchemaProxy.get(i)];case 1:return u=ee.sent(),g=(d=n.repetition).propertyDescriptor&&d.propertyDescriptor.type,v=d.propertyDescriptor&&d.propertyDescriptor.type.misc,f=this.services.explorationNavigation.getCurrentExploration().themeCollection,m=this.services.themeService.getVisualStyle(f),y=this.viewModel.displayOptions.displayName,g&&(g.fill||g.icon||s&&v&&v.webUrl||c&&g.dataBars)?[4,this.services.lazyScoped.get("conditionalFormattingDialogLauncherService")]:[3,4];case 2:return[4,ee.sent().show(e,y,r.expr,d,n.propertyDefinition,m)];case 3:return(C=ee.sent())&&(B=(0,Di.PU)(C.propertyDefinition,d.propertyDescriptor,!1),M=(0,Di.L1)(C.selector),this.services.visualAuthoring.setPropertyDefinition(e,d.propertyId,d.selector,B,M)),[3,8];case 4:return g&&g.dataBars?(E=r.expr.getMetadata(u).type,[4,this.services.lazyScoped.get("dataBarsDialogLauncherService")]):[3,7];case 5:return G=ee.sent(),te=this,[4,G.show(e,y,d,m.colorPalette,E,!1)];case 6:return te.dataBarsDialogRef=ee.sent(),[3,8];case 7:D.fF.assertFail("FieldWellFieldController.createConditionalFormatting - Invalid Conditional Formatting Type"),ee.label=8;case 8:return[2]}})})},o.prototype.removeConditionalFormatting=function(n){D.fF.assertValue(n.propertyDefinition,"removeConditionalFormatting called for missing property");var e=this.getSelectedVisual(),i=n.repetition,r=i.propertyDescriptor&&i.propertyDescriptor.type,a=i.propertyDescriptor&&i.propertyDescriptor.type.misc;r&&(r.fill||r.icon||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.conditionalTablixWebURL&&a&&a.webUrl)?this.services.visualAuthoring.removePropertyDefinition(e,i.propertyId,i.selector):r&&r.dataBars?this.services.visualAuthoring.removeDataBars(e,i):D.fF.assertFail("FieldWellFieldController.createConditionalFormatting - Invalid Conditional Formatting Type"),this.services.telemetryService.logEvent(Ae.Sd,{visualType:(0,R.s)(e),visualName:e.name})},o.prototype.removeConditionalFormattingAll=function(){var n=this.getSelectedVisual();this.services.visualAuthoring.removeConditionalFormattingAll(n,this.viewModel.conditionalFormattingRepetitions),this.services.telemetryService.logEvent(Ae.Sd,{visualType:(0,R.s)(n),visualName:n.name})},o.prototype.getAuthoringContext=function(){var n=this.getSelectedVisual();if(n){var e=this.services.dataSources.get();if(e)return{visual:n,dataSources:e}}},o.prototype.getVisualDataRole=function(){var n=(0,W.d$)(this.getSelectedVisual(),this.services.visualPlugin);if(!_.isEmpty(n))return(0,Fn.rC)(n,this.viewModel.role)},o}();function Qn(o,n){if(1&o&&(t.\u0275\u0275element(0,"i",8),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275pipe(2,"async")),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275classMapInterpolate1("warning glyphicon glyph-mini ng-scope ",e.viewModel.warning.glyph,""),t.\u0275\u0275property("pbiTooltip",t.\u0275\u0275pipeBind1(2,7,e.warningTooltip$)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,5,e.tooltipDescription$))}}function Xn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"tri-svg-icon",9),t.\u0275\u0275listener("mouseenter",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.infoIconName="info_20_filled")})("mouseleave",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.infoIconName="info_20_regular")}),t.\u0275\u0275elementEnd()}if(2&o){var i=t.\u0275\u0275nextContext();t.\u0275\u0275property("name",i.infoIconName)("pbiTooltip",i.bucketTooltip),t.\u0275\u0275attribute("aria-label",i.bucketTooltip)}}function Zn(o,n){if(1&o&&t.\u0275\u0275element(0,"field-well-field-modern",12),2&o){var e=n.$implicit,i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("bucketDisplayName",i.viewModel.displayName)("viewModel",e)}}var Jn=function(n,e,i){return{dropzone:n,"end-dropzone":e,"supports-multiple-items":i}};function Yn(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,Zn,1,2,"field-well-field-modern",10),t.\u0275\u0275elementStart(2,"li",11),t.\u0275\u0275listener("dropHandler",function(s){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.drop(s.event,s.ui,s.dropAction))}),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275pipe(6,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()}if(2&o){var i=n.ngIf,r=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i),t.\u0275\u0275advance(1),t.\u0275\u0275property("drop",r.dropConfig)("dropAction",r.dropActionHandler)("ngClass",t.\u0275\u0275pureFunction3(16,Jn,0===i.length,i.length>0,t.\u0275\u0275pipeBind1(3,8,r.supportsMultipleItems$)))("textContent",t.\u0275\u0275pipeBind1(4,10,r.dropzoneLocalize$))("title",t.\u0275\u0275pipeBind1(5,12,r.dropzoneLocalize$))("tabindex",t.\u0275\u0275pipeBind1(6,14,r.tabIndex$)),t.\u0275\u0275attribute("aria-label",r.addFieldsAriaLabel)}}var qn=function(n){return{disabled:n}},er=function(n){return{border:n}},Ri=function(o){function n(e,i,r,a,s,c,u,d,g,v,f,m,y,x){var C=o.call(this)||this;return C.element=e,C.conceptualSchemaProxy=i,C.dataSources=r,C.dragDataService=a,C.eventBridge=s,C.featureSwitchService=c,C.groupAuthoring=u,C.localizationService=d,C.promiseFactory=g,C.selection=v,C.telemetryService=f,C.viewModeState=m,C.visibilityService=y,C.visualAuthoring=x,C.infoIconName="info_20_regular",C.core=new ji({conceptualSchemaProxy:C.conceptualSchemaProxy,dataSources:C.dataSources,eventBridge:C.eventBridge,featureSwitchService:C.featureSwitchService,groupAuthoring:C.groupAuthoring,promiseFactory:C.promiseFactory,selection:C.selection,telemetryService:C.telemetryService,visualAuthoring:C.visualAuthoring}),C.uniqueId=_.uniqueId("fieldWellId"),C.dropConfig=C.getDropConfig(),C.dropActionHandler=function(M){return Promise.resolve(C.getDropAction(M))},C.bucketTooltip=d.get("Visual_Calculation_Field_Bucket_Tooltip"),C.dropzoneText=C.localizationService.get("FieldDropZone_AddFields"),C}return(0,p.__extends)(n,o),Object.defineProperty(n.prototype,"viewModel",{get:function(){return this.core.viewModel},set:function(i){this.core.viewModel=i},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.viewModel$=this.changes$("viewModel"),this.showTooltip$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var a=i[1];return i[0].properties.filter(function(c){return c.isHiddenInVisual}).length>0&&16!==a?.visibility}),(0,T.R)(this.onDestroy$)),this.visibleFieldProperties$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var r=i[0],a=i[1];return 16===a?.visibility?r.properties:_.filter(r.properties,function(s){return!s.isHiddenInVisual})}),(0,wi.d)(1),(0,T.R)(this.onDestroy$)),this.dropzoneLocalize$=this.visibleFieldProperties$.pipe((0,X.U)(function(i){return 0===i.length?e.dropzoneText:""})),this.tabIndex$=this.visibleFieldProperties$.pipe((0,X.U)(function(i){return 0===i.length?0:-1})),this.supportsMultipleItems$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var r=i[0],a=i[1];return 16===a?.visibility||r.supportsMultipleItems}),(0,T.R)(this.onDestroy$)),this.addFieldsAriaLabel=this.getAddFieldsAriaLabel(),this.borderStyle$=(0,Fe.aj)([this.viewModel$,this.viewModeState.getMode$()]).pipe((0,X.U)(function(i){return e.getBorderStyle(i[0],i[1])}),(0,T.R)(this.onDestroy$)),this.fieldWellAriaLabel$=this.viewModel$.pipe((0,X.U)(function(i){return e.getFieldWellAriaLabel(i)})),this.tooltipDescription$=this.viewModel$.pipe((0,X.U)(function(i){return i.description||i.displayName})),this.warningTooltip$=this.viewModel$.pipe((0,X.U)(function(i){return e.getWarningTooltip(i)}))},n.prototype.ngAfterViewInit=function(){var e=this;this.viewModel$.pipe((0,T.R)(this.onDestroy$)).subscribe(function(i){i.disabled?(0,at.u3)(e.element.nativeElement):(0,at.$o)(e.element.nativeElement,function(r,a){return e.core.dropField(a)})})},n.prototype.drop=function(e,i,r){var a=this.dragDataService.getDragContext();this.core.dropWithPayload(a)},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext(),r=0;if(i){var a=this.viewModel;r=i.sourceRole===a.role&&_.last(a.properties).startIndex===i.sourceIndex?0:_.isEmpty(this.viewModel.properties)?1:2}return r},n.prototype.getDropConfig=function(){return{accept:"field",greedy:!1}},n.prototype.getAddFieldsAriaLabel=function(){var e=this.localizationService;return e.get("FieldDropZone_NoDataFields").concat(". ",e.get("FieldDropZone_AddFields"))},n.prototype.getBorderStyle=function(e,i){if(0===i&&0!==e.properties.length)return"none"},n.prototype.getFieldWellAriaLabel=function(e){var i=e.displayName;return _.isString(e.description)&&(i=_.isString(i)?i.concat(". ",e.description):e.description),i},n.prototype.getWarningTooltip=function(e){var i={tooltipTitle:"",tooltipDescription:""};return e.warning&&(i={tooltipTitle:e.warning.title,tooltipDescription:e.warning.description}),i.tooltipDescription||i.tooltipTitle},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Qe.RD),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Fi.kc),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(pe.$8))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["field-well-bucket-modern"]],inputs:{viewModel:"viewModel"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:13,vars:23,consts:[[1,"bucket",3,"ngClass"],[1,"bucket-header"],[1,"caption","trimmedTextWithEllipsis","smallFontSize",3,"textContent","pbiTooltip"],["role","alert","tabindex","0",3,"class","pbiTooltip",4,"ngIf"],["role","tooltip","style","margin-left:4px","tabindex","0","tri-svg-icon-16","","sprite","fluentui-icons",3,"name","pbiTooltip","mouseenter","mouseleave",4,"ngIf"],[1,"properties",3,"ngStyle","drop"],["aria-hidden","true",1,"bucketTopBorder"],[4,"ngIf"],["role","alert","tabindex","0",3,"pbiTooltip"],["role","tooltip","tabindex","0","tri-svg-icon-16","","sprite","fluentui-icons",2,"margin-left","4px",3,"name","pbiTooltip","mouseenter","mouseleave"],[3,"bucketDisplayName","viewModel",4,"ngFor","ngForOf"],["data-testid","bucket-add-field",1,"trimmedTextWithEllipsis",3,"drop","dropAction","ngClass","textContent","title","tabindex","dropHandler"],[3,"bucketDisplayName","viewModel"]],template:function(i,r){1&i&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1),t.\u0275\u0275element(2,"h2",2),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275template(5,Qn,3,9,"i",3),t.\u0275\u0275template(6,Xn,1,3,"tri-svg-icon",4),t.\u0275\u0275pipe(7,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"ol",5),t.\u0275\u0275pipe(9,"async"),t.\u0275\u0275element(10,"li",6),t.\u0275\u0275template(11,Yn,7,20,"ng-container",7),t.\u0275\u0275pipe(12,"async"),t.\u0275\u0275elementEnd()()),2&i&&(t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(19,qn,r.viewModel.disabled)),t.\u0275\u0275advance(2),t.\u0275\u0275property("textContent",r.viewModel.displayName)("pbiTooltip",t.\u0275\u0275pipeBind1(4,11,r.tooltipDescription$)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(3,9,r.fieldWellAriaLabel$)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",r.viewModel.warning),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(7,13,r.showTooltip$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(21,er,t.\u0275\u0275pipeBind1(9,15,r.borderStyle$)))("drop",r.dropConfig),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(12,17,r.visibleFieldProperties$)))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,Ge.W,rt.V,Ei.M,Li,P.AsyncPipe],styles:[".bucket.disabled[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.5}"]}),n}(Oi.w),ji=function(){function o(n){this.services=n}return o.prototype.dropWithPayload=function(n){if(n&&!this.viewModel.disabled){var e=n,i=this.getSelectedVisual();if(e.sourceRole){D.fF.assert(function(){return $.isNumeric(e.sourceIndex)},"Unexpected drag source");var r=0;this.viewModel.properties.length>0&&(r=_.last(this.viewModel.properties).endIndex+1),e.sourceRole===this.viewModel.role&&(r=Math.max(r-(e.hierarchyLevelCount||1),0));var a=this.services.dataSources.get();this.services.visualAuthoring.moveField(e.sourceRole,this.viewModel.role,e.sourceIndex,r,e.hierarchyLevelCount||1,a,16===i?.visibility);var c=i?i.config.singleVisual.query.tryGetExpr(e.sourceRole,e.sourceIndex):null;return void this.logTelemetry(c,e.sourceRole,i)}n.field&&this.dropField(n.field)}},o.prototype.dropField=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return this.viewModel.disabled?[2,!1]:(i=this.getSelectedVisual())?(r=this.services.dataSources.get(),[4,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,r,i,void 0,void 0,void 0,16===i?.visibility)]):[3,2];case 1:return e=s.sent(),[3,3];case 2:this.services.eventBridge.publishToChannel(I.Tyr,{expr:n,visualType:ct.x.getDefaultVisualPlugin(this.services.featureSwitchService).name,targetRole:this.viewModel.role,allowAggregate:!0,telemetrySource:3,startAuthoringAfterAddition:!1}),e=!0,s.label=3;case 3:return this.logTelemetry(n,null),[2,e]}})})},o.prototype.logTelemetry=function(n,e,i){if(n){var r="Create";e&&(r="Update",this.services.telemetryService.logEvent(Ae.V1,{sourceBucketRole:e,targetBucketRole:this.viewModel.role,visualName:i&&i.name}));var a=(0,R.s)(this.getSelectedVisual()),s=Mi(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy);this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(s,n,a,this.viewModel.role,e,r)}},o.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},o}();function tr(o,n){1&o&&t.\u0275\u0275element(0,"field-well-bucket-modern",3),2&o&&t.\u0275\u0275property("viewModel",n.$implicit)}function ir(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"ol"),t.\u0275\u0275template(1,tr,1,1,"field-well-bucket-modern",2),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.viewModel.buckets)}}var Wi={},ni=function(){function o(n,e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B){this.changeDetection=n,this.conceptualSchemaProxy=e,this.dataSources=i,this.displayNameService=r,this.eventBridge=a,this.explorationNavigation=s,this.groupingDesignStateService=c,this.featureSwitchService=u,this.lazyScoped=d,this.localizationService=g,this.runningVisualService=v,this.selectionService=f,this.showValueAsService=m,this.vcRef=y,this.visualPlugin=x,this.visibility=C,this.visualCalcEagerService=B}return o.prototype.ngOnInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return n={$element:$(this.vcRef.element.nativeElement),conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,explorationDisplayNameService:this.displayNameService,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,groupingDesignStateService:this.groupingDesignStateService,featureSwitchService:this.featureSwitchService,selection:this.selectionService,showValueAsService:this.showValueAsService,visualPlugin:this.visualPlugin,localizationService:this.localizationService,runningVisuals:this.runningVisualService,visibility:this.visibility,visualCalcEagerService:this.visualCalcEagerService,lazyScopedProvider:this.lazyScoped},this.core=new Ui(n,!1,this.updateViewModel.bind(this)),[4,this.core.onInit()];case 1:return e.sent(),[2]}})})},o.prototype.ngOnDestroy=function(){this.core.onDestroy()},o.prototype.updateViewModel=function(n){this.viewModel=n,this.changeDetection.detectChanges()},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(Ue.O),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(It.AA),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(At.s),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(He.P),t.\u0275\u0275directiveInject(t.ViewContainerRef),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(Ke.w))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["field-well-modern"]],decls:2,vars:1,consts:[[1,"fieldWell","unselectable"],[4,"ngIf"],["class","field-well-bucket-element","data-testid","field-well-bucket-element","role","listitem",3,"viewModel",4,"ngFor","ngForOf"],["data-testid","field-well-bucket-element","role","listitem",1,"field-well-bucket-element",3,"viewModel"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"section",0),t.\u0275\u0275template(1,ir,2,1,"ol",1),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.viewModel&&i.viewModel.buckets))},dependencies:[P.NgForOf,P.NgIf,Ri],styles:[".explorationContainer .fieldWell{overflow:auto}.explorationContainer .fieldWell .errorIcon{cursor:pointer;width:16px;height:16px;background-color:transparent;vertical-align:top}.explorationContainer .fieldWell .bucket{display:flex;flex-direction:column;padding-bottom:4px;color:var(--neutral-tertiary-alt-color, #C8C8C8);width:100%}.explorationContainer .fieldWell .bucket .bucket-header{display:flex;flex-direction:row;margin:6px 5px 6px 0;align-items:center}.explorationContainer .fieldWell .bucket .bucket-header .caption{box-sizing:border-box;margin-left:12px;font-weight:inherit;color:var(--white-color, #FFF)}.explorationContainer .fieldWell .bucket .bucket-header .caption:focus{outline:none}.explorationContainer .fieldWell .bucket .bucket-header .warning{flex:none;margin-top:auto;color:var(--data-color6, #8AD4EB);cursor:pointer}.explorationContainer .fieldWell .properties{float:left;min-height:28px;width:calc(100% - 10px);margin:0 4px;border:1px dashed var(--neutral-secondary-color, #666666);border-radius:4px;background-color:var(--neutral-primary-color-alt2, #4a4a4a);padding:1px 0}.explorationContainer .fieldWell .properties.dragover{border:1px dashed var(--theme-primary-color, #F2C811)!important}.explorationContainer .fieldWell .properties li:focus{outline:none}.explorationContainer .fieldWell .dropzone,.explorationContainer .fieldWell .end-dropzone{width:calc(100% - 4px);line-height:22px;padding-left:8px;margin:0 2px}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items{height:7px;border-top:1px solid transparent}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items.prepend{border-top-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items:focus{outline:none}.explorationContainer .fieldWellProperty[drag]{position:relative;padding-left:4px;background:var(--neutral-primary-color, #333333);border-radius:3px;border:1px solid var(--neutral-dark-color, #212121);cursor:pointer}.explorationContainer .fieldWellProperty[drag].not-draggable,.explorationContainer .fieldWellProperty[drag].not-draggable .errorIcon,.explorationContainer .fieldWellProperty[drag].not-draggable .editableLabel .textLabel{cursor:default}.explorationContainer .fieldWellProperty[drag] .caption{color:var(--white-color, #FFF);line-height:21px}.explorationContainer .fieldWellProperty[drag] .field-glyph{float:left;margin:4px 4px 4px 2px}.explorationContainer .fieldWellProperty[drag] .error{float:left;width:16px;height:16px}.explorationContainer .fieldWellProperty[drag] .delete{width:16px;height:16px;color:var(--neutral-secondary-alt-color2, #888888);background:transparent}.explorationContainer .fieldWellProperty[drag] .hierarchyList{padding-left:8px;color:var(--white-color, #FFF)}.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption{color:var(--white-color, #FFF);line-height:19px}.explorationContainer .fieldWellProperty[drag] .glyphicon{color:var(--white-color, #FFF)}.explorationContainer field-well-field-modern{border:solid var(--neutral-primary-color-alt2, #4a4a4a);display:block;border-width:1px 0;border-radius:3px;margin:0 2px}.explorationContainer field-well-field-modern.append{border-bottom-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer field-well-field-modern.prepend{border-top-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer field-well-field-modern .textInput{background:var(--neutral-tertiary-alt-color, #C8C8C8);color:var(--black-color, #000)}.explorationContainer field-well-field-modern .textInput::selection{background:var(--theme-primary-color, #F2C811)}.explorationContainer field-well-field-modern editable-label .textLabel{white-space:nowrap}.explorationContainer .fieldWellIcon{background-color:transparent}.explorationContainer .fieldWellIcon:hover,.explorationContainer .fieldWellIcon:focus,.explorationContainer .fieldWellIcon:active,.explorationContainer .fieldWellIcon:active:hover,.explorationContainer .fieldWellIcon:focus:hover{background-color:transparent}.explorationContainer .bucketTopBorder{border-bottom:1px solid transparent;border-radius:3px;margin:0 2px}.explorationContainer .bucketTopBorder.append{border-bottom-color:var(--theme-primary-color, #F2C811)}.newPaneColors.explorationContainer{--field-well-title-color: var(--gray-180, #252423);--field-well-background: var(--white-color, #FFF);--field-well-item-background: var(--gray-30, #EDEBE9);--field-well-item-border-color: var(--gray-60, #C8C6C4)}[data-legacy-theming=false] .newPaneColors.explorationContainer{--field-well-title-color: var(--colorNeutralForeground1);--field-well-background: var(--colorNeutralBackground3);--field-well-item-background: var(--colorNeutralBackground2);--field-well-item-border-color: var(--colorNeutralStroke1)}.newPaneColors.explorationContainer .fieldWell .bucket,.newPaneColors.explorationContainer .fieldWell .bucket .bucket-header .caption{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .bucket .bucket-header .caption:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWell .properties{border-color:var(--field-well-item-border-color);background-color:var(--field-well-background);border-radius:2px}.newPaneColors.explorationContainer .fieldWell .properties.dragover{border-color:var(--gray-130, #605E5C)!important}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .properties li:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .errorIcon:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag]{background:var(--field-well-item-background);border-radius:2px;border-color:var(--field-well-item-border-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .caption{color:var(--field-well-title-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .caption input{background:var(--field-well-background);color:var(--field-well-title-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .delete{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellProperty[drag] .delete:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList,.newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .glyphicon{color:var(--field-well-title-color)}.newPaneColors.explorationContainer field-well-field-modern{border-color:transparent;border-radius:2px}.newPaneColors.explorationContainer field-well-field-modern .textInput{background:var(--field-well-background);color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer field-well-field-modern editable-label:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellIcon:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .bucketTopBorder{border-radius:2px}\n"],encapsulation:2}),o}(),Ui=function(){function o(n,e,i){this.services=n,this.disableHierarchyLevelGrouping=e,this.onViewModelChange=i,this.additionalSubscriptions=new Dt.w}return o.prototype.onInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return this.viewModel=new Te.KT([]),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(I.CCe,function(){return n.requestModelAndUpdate(!0)}).subscribe(I.tRg,function(){return n.requestModelAndUpdate()}).subscribe(I.KD7,function(){return n.requestModelAndUpdate()}).subscribe(I.y5h,function(){return n.requestModelAndUpdate(!0)}).subscribe(I.jCS,function(){return n.requestModelAndUpdate(!0)}).subscribe(I.Ah$,function(i,r){return n.onFieldWellFieldRemoved(r)}).subscribe(I.D1A,function(){return n.requestModelAndUpdate(!0)}).subscribe(I.oRp,function(){return n.requestModelAndUpdate()}),this.additionalSubscriptions.add(this.services.visualCalcEagerService.onContextChange$().subscribe(function(){return n.requestModelAndUpdate()})),this.additionalSubscriptions.add(me.UP.getSelectedVisualContainer$(this.services.selection).pipe((0,F.h)(function(i){return!!i}),(0,ze.w)(function(i){return n.services.runningVisuals.getVisual$(i)}),(0,ze.w)(function(i){return i?i.getErrorInfo$():Tt.E})).subscribe(function(){return n.requestModelAndUpdate()})),[4,this.requestModelAndUpdate()];case 1:return[2,e.sent()]}})})},o.prototype.onDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll(),this.additionalSubscriptions.unsubscribe()},o.prototype.onFieldWellFieldRemoved=function(n){ut.IK.focus(_.find(this.services.$element.find(".field-well-bucket-element .bucket .bucket-header .caption"),function(e){return $(e).html()===n}),!1)},o.prototype.requestModelAndUpdate=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i=this;return(0,p.__generator)(this,function(r){return(e=this.services.dataSources.get())?[2,this.services.conceptualSchemaProxy.get(e).then(function(a){return i.update(a,n)})]:[2]})})},o.prototype.update=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,a,s,c,u,d,g,v=this;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.services.lazyScopedProvider.get("fieldWellViewModelService")];case 1:if(r=f.sent(),s=this.getSelectedVisual(),this.deferredCreateBuckets&&(this.deferredCreateBuckets.reject(Wi),this.deferredCreateBuckets=void 0),n){if(s)return u=[new nr(this.services.explorationNavigation,this.services.localizationService)],d=16===(null===(i=this.services.visibility.get())||void 0===i?void 0:i.visibility),this.services.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||u.push(new rr(this.services.visualPlugin,s)),g=this.services.runningVisuals.getVisual(s),this.deferredCreateBuckets=r.createBuckets(g,s,n,this.services.groupingDesignStateService,this.services.showValueAsService,this.services.visualPlugin,this.services.explorationDisplayNameService,u,this.disableHierarchyLevelGrouping,d),[2,this.deferredCreateBuckets.promise.then(function(m){v.updateViewModel(m,e)},function(m){if(m!==Wi)throw m}).finally(function(){v.deferredCreateBuckets=void 0})];c=(0,W.x3)(ct.x.getDefaultVisualPlugin(this.services.featureSwitchService)),a=r.createEmptyBuckets(c,[]),this.updateViewModel(a,e)}else this.updateViewModel(a=null,e);return[2]}})})},o.prototype.updateViewModel=function(n,e){e&&(0,xi.L)(n,this.viewModel.buckets)||(this.viewModel.buckets=n,this.onViewModelChange&&this.onViewModelChange(this.viewModel))},o.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},o}(),nr=function(){function o(n,e){this.explorationNavigation=n,this.localizationService=e}return o.prototype.onBucketCreated=function(n,e,i,r,a,s,c){var u=e.config.singleVisual,d=s.capabilities(u.visualType),g=!d||!d.tooltips||void 0===d.tooltips.showByDefault||d.tooltips.showByDefault,v=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"show"},void 0);if((v||g)&&(!v||v.value)){var f=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"type"},void 0),m=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"section"},void 0),y=f&&f.value,C=m&&m.value;if((!y||y===ke.Xz)&&C&&C!==ke.pJ&&_.some(d.tooltips&&d.tooltips.roles,function(re){return re===n.role})){var w=m&&m.value,E=void 0;if(w===ke.pJ)E=c.get("ReportPage");else{var G=this.explorationNavigation.getAllSections(),te=_.find(G,function(re){return re.name===w&&1===re.type});if(!te)return;E=te.displayName}var ee=new Te.DR(E,null,null,"pbi-glyph-canvas-tooltip"),le=new Te.Ct(null,!1,!1);le.disableInteractivity();var ue=new Te._d(void 0,n.role,-1,-1,!0,ee,le,void 0,void 0,void 0,void 0);n.properties.push(ue),n.warning=new Te.kh("pbi-glyph-info",void 0,this.localizationService.get("FieldWellBucket_Warning_CanvasTooltipDescription"))}}},o.prototype.shouldCreateBucketForRole=function(n){return!0},o}(),rr=function(){function o(n,e){this.visualPluginService=n,this.visual=e}return o.prototype.onBucketCreated=function(n,e,i,r,a,s,c){},o.prototype.shouldCreateBucketForRole=function(n){var e=this.visualPluginService.capabilities(this.visual.config.singleVisual.visualType);return(0,Yt.hQ)(n,this.visual.config.singleVisual,e)},o}();function or(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"visual-types-container-modern",5),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("visualPluginFilter",e.visualPluginFilter)}}function ar(o,n){1&o&&t.\u0275\u0275element(0,"spinner")}function sr(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"section",6),t.\u0275\u0275template(1,ar,1,0,"spinner",2),t.\u0275\u0275elementStart(2,"visual-types-container-modern",7),t.\u0275\u0275listener("isFinishedLoading",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onVisualTypesContainerDoneLoading())}),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.isPersonalVisualTypesLoaded),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("hidden",!i.isPersonalVisualTypesLoaded),t.\u0275\u0275property("visualPluginFilter",i.nonPersonalVisualizationPaneFilter)("disableMoreOptionsIcon",!0)}}function lr(o,n){1&o&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"field-well-modern"),t.\u0275\u0275elementEnd())}function cr(o,n){1&o&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"drillthrough-pane",9),t.\u0275\u0275elementEnd())}var ur=function(){return{ignoreOverlay:!1,ignoreMobile:!1}};function dr(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"div")(1,"div",8),t.\u0275\u0275template(2,lr,2,0,"section",2),t.\u0275\u0275template(3,cr,2,0,"section",2),t.\u0275\u0275elementEnd()()),2&o){var e=t.\u0275\u0275nextContext();t.\u0275\u0275classMap(e.fieldWellOrFiltersClass),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbiScrollbar",t.\u0275\u0275pureFunction0(6,ur))("pbiScrollbarDisabled",e.disableScrollbar),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showFieldWell),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showDrillthroughPane)}}var ri,$i=function(){function o(){this.disableScrollbar=!1}return o.prototype.onVisualTypesContainerDoneLoading=function(){this.isPersonalVisualTypesLoaded=!0},Object.defineProperty(o.prototype,"fieldWellOrFiltersClass",{get:function(){return this.disableScrollbar?"fieldWellOrFilters disableScrollbar":"fieldWellOrFilters enableScrollbar"},enumerable:!1,configurable:!0}),o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["build-section"]],inputs:{showVisualTypes:"showVisualTypes",showFieldWell:"showFieldWell",showDrillthroughPane:"showDrillthroughPane",showFieldWellOrFilters:"showFieldWellOrFilters",populatePanes:"populatePanes",visualPluginFilter:"visualPluginFilter",nonPersonalVisualizationPaneFilter:"nonPersonalVisualizationPaneFilter",showNonPersonalVisuals:"showNonPersonalVisuals",disableScrollbar:"disableScrollbar"},decls:5,vars:3,consts:[["section-animation-slider","",1,"pane-contents-modern","modern-format-pane"],[1,"visualTypesContainer"],[4,"ngIf"],["class","nonPersonalVisualizationPane",4,"ngIf"],[3,"class",4,"ngIf"],[3,"visualPluginFilter"],[1,"nonPersonalVisualizationPane"],[3,"visualPluginFilter","disableMoreOptionsIcon","isFinishedLoading"],[1,"scroller",3,"pbiScrollbar","pbiScrollbarDisabled"],[1,"modern"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1),t.\u0275\u0275template(2,or,2,1,"section",2),t.\u0275\u0275template(3,sr,3,5,"section",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,dr,4,7,"div",4),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.showVisualTypes),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showVisualTypes&&i.showNonPersonalVisuals),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showFieldWellOrFilters))},dependencies:[P.NgIf,Jt.R,St.r,Ci.O,A.r,Et,ni],styles:['.pane-contents-modern[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;margin-top:2px}.hidden[_ngcontent-%COMP%]{display:none}.nonPersonalVisualizationPane[_ngcontent-%COMP%]{margin-top:4px;padding-top:4px;border-top:1px dashed var(--gray-40, #E1DFDD)}.fieldWellOrFilters[_ngcontent-%COMP%]{border-top:1px solid var(--gray-40, #E1DFDD);padding-top:2px;flex-basis:0;flex-grow:1}.disableScrollbar[_ngcontent-%COMP%]{overflow:unset;padding-right:"6px";padding-left:"6px"}.enableScrollbar[_ngcontent-%COMP%]{overflow:hidden}.visualTypesContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:2px 6px;margin-bottom:4px}']}),o}(),Ie=l(41887),Ne=l(80981);!function(o){function n(r,a,s,c,u,d){if(r&&function(r,a){var s=r.config.singleVisual,u=s.query;if(u)return a.capabilities(s.visualType).supportsSynchronizingFilterState&&u.hasProjections()}(r,a))return new pr(r,u,d,s,c)}o.create=n,o.createObservable=function(r,a,s,c,u,d,g,v){var f=this,m=new L.X(void 0);a.get(s.get()).then(function(B){return m.next(B)});var C,y=new L.X(me.UP.getSelectedVisual(c)),x=new L.X(g.getCurrentExploration());return r.subscribe(I.jCS,function(B,M){if(1!==M.visualContainerChangeType){var w=me.UP.getSelectedVisual(c);w&&M.affectContainer(w)&&y.next(w)}}).subscribe(I.tRg,function(){y.next(me.UP.getSelectedVisual(c))}).subscribe(I.UpY,function(){C=!0}).subscribe(I.t4l,function(){x.next(g.getCurrentExploration())}).subscribe(I.LE3,function(){x.next(g.getCurrentExploration())}).subscribeAsync(I.CCe,function(){return(0,p.__awaiter)(f,void 0,void 0,function(){var B;return(0,p.__generator)(this,function(M){switch(M.label){case 0:return[4,a.get(s.get())];case 1:return B=M.sent(),C=!1,m.next(B),[2]}})})}).subscribe(I.KD7,function(){return y.next(me.UP.getSelectedVisual(c))}).subscribe(I.TTT,function(){x.next(g.getCurrentExploration())}).subscribe(I.HGU,function(){x.next(g.getCurrentExploration())}),(0,Fe.aj)([m,y,x]).pipe((0,F.h)(function(){return!C}),(0,X.U)(function(B){var M=B[0],w=B[1],E=B[2];if(w&&M&&E)return n(w,u,v,d,E,M)}))}}(ri||(ri={}));var pr=function(){return function(n,e,i,r,a){this.sourceVisual=n,this.exploration=e,this.schema=i,this.localizationService=r,this.visualSyncService=a,this.pageSyncItems=[];var s=function(o,n,e,i,r){return o.syncGroup?function(o,n,e){var i=dt(o);D.fF.assertValue(i,"source visual should be in a group");for(var r=[],a={},s=0,c=n.sections;s<c.length;s++){for(var u=c[s],d=e.format("SyncGroupPane_SyncCheckboxLabel",[u.displayName]),g=e.format("SyncGroupPane_VisibleCheckboxLabel",[u.displayName]),v=void 0,f=[],m=[],y=0,x=u.visualContainers;y<x.length;y++){var B=(C=x[y]).config.singleVisual,M=dt(B);M?(a[M]=!0,B===o?v=C:M===i&&m.push(C)):Gi(o,B)&&f.push(C)}if(v)r.push({section:u,synced:!!i,visible:!(0,Ne.xj)(o),visualContainer:v,isSourceVisual:!0,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g});else if(_.some(m))r.push(1===m.length?{section:u,synced:!0,visible:!(0,Ne.xj)((C=m[0]).config.singleVisual),visualContainer:C,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g}:{disabledReason:1,section:u,synced:!0,visible:_.some(m,function(w){return!(0,Ne.xj)(w.config.singleVisual)}),visualContainer:m[0],syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g});else if(1===f.length){var C;r.push({section:u,synced:!1,visible:!(0,Ne.xj)((C=f[0]).config.singleVisual),visualContainer:C,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g})}else r.push({section:u,synced:!1,visible:!1,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g})}return D.fF.assert(function(){return r.length===n.sections.length},"expected a single sync group item for each section"),{state:0,items:r,activeSyncGroup:i}}(o,n,r):function(o,n,e,i,r){D.fF.assert(function(){return!o.syncGroup},"expected visual to be ungrouped");for(var d,a={},s={},c={},u=-1,g=[],v=0;v<n.sections.length;v++){var m=r.format("SyncGroupPane_SyncCheckboxLabel",[(f=n.sections[v]).displayName]),y=r.format("SyncGroupPane_VisibleCheckboxLabel",[f.displayName]);g[v]={};for(var x=void 0,C={},B=0,M=f.visualContainers;B<M.length;B++){var w=M[B],E=w.config.singleVisual,G=dt(E);if(E===o&&(x=d=w,u=v),G&&(a[G]=!0),Gi(o,E)){G&&(s[G]=!0,C[G]=!0,x&&(c[G]=!0));var te=g[v][G];te&&E!==o?x||(g[v][G]=G?{disabledReason:1,synced:!0,section:f,visible:te.visible||!(0,Ne.xj)(E),syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}:{synced:!1,section:f,visible:!1,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}):g[v][G]={synced:!!G,section:f,visible:!(0,Ne.xj)(E),visualContainer:w,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}}}x&&(c=C)}for(var ee in c)delete s[ee];var le=Object.keys(s),ue=dt(null),re=1===le.length?le[0]:ue,Ce=[];for(v=0;v<n.sections.length;v++){var f;m=r.format("SyncGroupPane_SyncCheckboxLabel",[(f=n.sections[v]).displayName]),y=r.format("SyncGroupPane_VisibleCheckboxLabel",[f.displayName]),Ce.push(v===u?{section:f,synced:!!o.syncGroup,visible:!(0,Ne.xj)(o),visualContainer:d,isSourceVisual:!0,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}:g[v][re]||g[v][ue]||{section:f,synced:!1,visible:!1,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y})}return D.fF.assert(function(){return Ce.length===n.sections.length},"expected a single sync group item for each section"),{state:0,items:Ce,activeSyncGroup:re||e.generateUniqueGroupName(i,o,a)}}(o,n,e,i,r)}(this.sourceVisual.config.singleVisual,this.exploration,this.visualSyncService,this.schema,this.localizationService),c=this.sourceVisual.config.singleVisual;this.pageSyncItems=s.items,this.syncFields=c.syncGroup&&c.syncGroup.fieldChanges,this.syncFilters=c.syncGroup&&c.syncGroup.filterChanges,this.sourceVisualSyncGroup=dt(c),this.activeSyncGroup=s.activeSyncGroup,this.status=s.state}}();function Gi(o,n){if(n.visualType!==o.visualType)return!1;var e=n.query&&n.query.defn&&n.query.defn.select(),i=o.query&&o.query.defn&&o.query.defn.select();return!_.isEmpty(i)&&!_.isEmpty(e)&&i.length===e.length&&(1===i.length?(0,_e.fS)(i[0].expr,e[0].expr):!_.differenceWith(i,e,function(a,s){return(0,_e.fS)(a.expr,s.expr)}).length)}function dt(o){return o&&o.syncGroup&&o.syncGroup.groupName||null}var Hi=l(64647),oi=l(69474),ai=l(8586),pt=l(84281),Nt=l(17328),Ki=l(21024),vt=l(27980),fr=l(64370),mr=l(59968),yr=l(50057),Cr=l(54932),Qi=l(35756),br=l(56011),Pr=l(86663),Xi=l(21023),Zi=l(24548);function Sr(o,n){1&o&&(t.\u0275\u0275elementStart(0,"pbi-pane-section"),t.\u0275\u0275element(1,"legend",4),t.\u0275\u0275elementEnd()),2&o&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("id","syncGroupDescriptionLegend"))}function _r(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",21),t.\u0275\u0275listener("click",function(){var c=t.\u0275\u0275restoreView(e).$implicit,u=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(u.navigateAndSelectVisual(c))}),t.\u0275\u0275elementStart(2,"label",22),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",23)(5,"pbi-checkbox",24),t.\u0275\u0275listener("onChange",function(s){var u=t.\u0275\u0275restoreView(e).$implicit,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.onSyncCheckChanged(u,s))}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"div",23)(7,"pbi-checkbox",25),t.\u0275\u0275listener("onChange",function(s){var u=t.\u0275\u0275restoreView(e).$implicit,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.onVisibleCheckChanged(u,s))}),t.\u0275\u0275elementEnd()()()}if(2&o){var i=n.$implicit,r=t.\u0275\u0275nextContext(3);t.\u0275\u0275classProp("navigatable",i.visualContainer)("currentPage",i.isSourceVisual),t.\u0275\u0275advance(2),t.\u0275\u0275attribute("title",i.section.displayName)("role",i.visualContainer?"button":null)("tabindex",i.visualContainer?0:null)("aria-label",i.visualContainer?r.ariaNavigateDescription:null),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",i.section.displayName," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("ariaLabel",i.syncCheckboxAriaLabel)("checked",i.synced)("disabled",!!i.disabledReason),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("ariaLabel",i.visibleCheckboxAriaLabel)("disabled",!!i.disabledReason)("checked",i.visible)}}function xr(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",26),t.\u0275\u0275element(1,"label",27),t.\u0275\u0275elementStart(2,"input",28),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(s.onSourceVisualSyncGroupChanged(a))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"pbi-checkbox",29),t.\u0275\u0275listener("onChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(s.onSyncFieldsCheckChanged(a))}),t.\u0275\u0275pipe(4,"localize"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"pbi-checkbox",29),t.\u0275\u0275listener("onChange",function(a){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(s.onSyncFiltersCheckChanged(a))}),t.\u0275\u0275pipe(6,"localize"),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(2),t.\u0275\u0275property("ngModel",i.syncViewModel.sourceVisualSyncGroup),t.\u0275\u0275attribute("aria-label",i.ariaSyncGroupName),t.\u0275\u0275advance(1),t.\u0275\u0275property("isCompact",!0)("disabled",!i.syncViewModel.sourceVisualSyncGroup)("label",t.\u0275\u0275pipeBind1(4,12,"SyncGroupPane_SyncFieldsLabel"))("ariaLabel",i.ariaSyncFieldCheckbox)("checked",i.syncViewModel.syncFields),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("disabled",!i.syncViewModel.sourceVisualSyncGroup)("label",t.\u0275\u0275pipeBind1(6,14,"SyncGroupPane_SyncFiltersLabel"))("ariaLabel",i.ariaSyncFiltersCheckbox)("checked",i.syncViewModel.syncFilters)}}function Mr(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"pbi-pane-section",5)(1,"pbi-pane-section",6)(2,"legend",7)(3,"span",8),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.syncToAll())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",9)(5,"div",10),t.\u0275\u0275element(6,"div",11),t.\u0275\u0275elementStart(7,"div",12),t.\u0275\u0275element(8,"pbi-icon",13),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",12),t.\u0275\u0275element(10,"pbi-icon",14),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(11,_r,8,17,"div",15),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"pbi-pane-section",16)(13,"div",17),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.toggleShowAdvancedOptions())}),t.\u0275\u0275element(14,"pbi-icon",18)(15,"legend",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(16,xr,7,16,"div",20),t.\u0275\u0275elementEnd()()}if(2&o){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(8),t.\u0275\u0275attribute("aria-label",i.ariaSyncDescription),t.\u0275\u0275advance(2),t.\u0275\u0275attribute("aria-label",i.ariaVisibilityDescription),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i.syncViewModel.pageSyncItems)("ngForTrackBy",i.trackPageSyncItemBy),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("expandedAdvancedOptions",i.showAdvancedOptions),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",i.showAdvancedOptions)}}function Or(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"pbi-pane",1),t.\u0275\u0275listener("onCollapse",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.onPaneCollapsed())})("onToggle",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.onTogglePane())}),t.\u0275\u0275template(1,Sr,2,1,"pbi-pane-section",2),t.\u0275\u0275template(2,Mr,17,7,"pbi-pane-section",3),t.\u0275\u0275elementEnd()}if(2&o){var i=n.ngIf,r=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",i.isPaneExpanded)("allowToggle",!r.onObject)("title",i.title)("optionsSetting",i.optionsSetting)("ariaDescribedBy","syncGroupDescriptionLegend")("showCollapse",r.onObject),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!r.syncViewModel||0!==r.syncViewModel.status),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",r.syncViewModel&&0===r.syncViewModel.status)}}var Ji=function(){function o(n,e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w,E){this.conceptualSchemaProxy=n,this.highContrastCssGenerationService=e,this.dataSources=i,this.eventBridge=r,this.explorationActivity=a,this.explorationCapabilities=s,this.explorationNavigation=c,this.explorationSerializer=u,this.featureSwitchService=d,this.telemetryService=g,this.formFactor=v,this.localizationService=f,this.panesVisibility=m,this.selection=y,this.undoRedo=x,this.visualAuthoring=C,this.visualAuthoringOperations=B,this.visualPlugin=M,this.visualSync=w,this.changeDetectorRef=E,this.paneViewModel$=this.panesVisibility.getPanes$().pipe((0,X.U)(function(G){return G.syncSlicers})),this.newPaneColorsEnabled=this.explorationCapabilities.getCapabilities().showFluentDesign||this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.paneColorRefresh,this.initializeHighContrastRules(),this.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager()}return o.prototype.ngOnInit=function(){var n=this;this.ariaSyncFieldCheckbox=this.localizationService.get("SyncGroupPane_SyncFieldsLabel"),this.ariaSyncFilterCheckbox=this.localizationService.get("SyncGroupPane_SyncFiltersLabel"),this.ariaSyncGroupName=this.localizationService.get("SyncGroupPane_GroupNameLabel"),this.ariaSyncDescription=this.localizationService.get("Sync"),this.ariaVisibilityDescription=this.localizationService.get("Visible"),this.ariaNavigateDescription=this.localizationService.get("SyncGroupPane_NavigateDescription");var e=ri.createObservable(this.subscriptionManager,this.conceptualSchemaProxy,this.dataSources,this.selection,this.visualPlugin,this.visualSync,this.explorationNavigation,this.localizationService);this.viewModelSubscription=e.subscribe(function(i){n.syncViewModel=i,n.changeDetectorRef.markForCheck()})},o.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.viewModelSubscription.unsubscribe()},Object.defineProperty(o.prototype,"onObject",{get:function(){return this.featureSwitchService.featureSwitches.onObject},enumerable:!1,configurable:!0}),o.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .advancedOptionsToggle:focus, .themeableElement .advancedOptionsToggle:focus-within, .themeableElement .advancedOptionsToggle:hover","{ color: @selectedForegroundColor !important; background-color: @selectedBackgroundColor !important; outline: none; }")},o.prototype.getVisibleCheckboxAriaLabel=function(n){return this.localizationService.format("SyncGroupPane_VisibleCheckboxLabel",[n.section.displayName])},o.prototype.syncToAll=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return this.undoRedo.register("SyncToAll",function(){for(var i=0,r=n.syncViewModel.pageSyncItems;i<r.length;i++){var a=r[i];!a.synced&&!a.disabledReason&&n.syncItem(a)}}),[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual,!0)];case 1:return e.sent(),[2]}})})},o.prototype.onSyncCheckChanged=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return this.undoRedo.register("Sync changed",function(){e?r.syncItem(n):Yi(r.visualAuthoringOperations,r.eventBridge,n.visualContainer)}),e?[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual.config.singleVisual.syncGroup?this.syncViewModel.sourceVisual:n.visualContainer,!0)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},o.prototype.onSyncFieldsCheckChanged=function(n){var e=this;this.undoRedo.register("Sync fields changed",function(){e.visualAuthoringOperations.assignSyncGroup(e.syncViewModel.sourceVisual,(0,p.__assign)((0,p.__assign)({},e.syncViewModel.sourceVisual.config.singleVisual.syncGroup),{fieldChanges:n}))})},o.prototype.onSyncFiltersCheckChanged=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return this.undoRedo.register("Sync fields changed",function(){e.visualAuthoringOperations.assignSyncGroup(e.syncViewModel.sourceVisual,(0,p.__assign)((0,p.__assign)({},e.syncViewModel.sourceVisual.config.singleVisual.syncGroup),{filterChanges:n}))}),n?[4,this.visualSync.syncVisualFiltersState(this.syncViewModel.sourceVisual)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},o.prototype.onVisibleCheckChanged=function(n,e){var i=this;this.undoRedo.register("Visible changed",function(){n.visualContainer?qi(i.visualAuthoringOperations,i.eventBridge,n.visualContainer,e):i.syncItem(n)})},o.prototype.onSourceVisualSyncGroupChanged=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i=this;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return e=!!n,this.undoRedo.register("Sync group changed",function(){e?si(i.visualAuthoringOperations,i.syncViewModel.sourceVisual,n):Yi(i.visualAuthoringOperations,i.eventBridge,i.syncViewModel.sourceVisual)}),e?[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual,!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},o.prototype.onTogglePane=function(){this.panesVisibility.togglePaneExpansion("syncSlicers")},o.prototype.onPaneCollapsed=function(){this.panesVisibility.setPaneExpansion("syncSlicers",!1)},o.prototype.toggleShowAdvancedOptions=function(){this.showAdvancedOptions=!this.showAdvancedOptions},o.prototype.trackPageSyncItemBy=function(n,e){return e.section.name},o.prototype.navigateAndSelectVisual=function(n){var e=this;this.undoRedo.register("Navigate and select",function(){e.explorationActivity.doRootActivity(function(i){var r=e.syncViewModel.exploration.sections.indexOf(n.section);r<0||!n.visualContainer||(e.explorationNavigation.updateActiveSection({targetSectionIndex:r,parentActivity:i}),me.UP.selectCanvasItem(n.visualContainer,e.selection))},function(){return e.telemetryService.startChildActivity(void 0,Ae.Es)})})},o.prototype.syncItem=function(n){if(n.visualContainer)si(this.visualAuthoringOperations,n.visualContainer,this.syncViewModel.activeSyncGroup);else{var e=(0,Ie.Mt)(this.explorationSerializer.serializeVisualContainer(this.syncViewModel.sourceVisual),this.syncViewModel.exploration,n.section,this.explorationSerializer,this.formFactor,this.visualAuthoring);si(this.visualAuthoringOperations,e,this.syncViewModel.activeSyncGroup)}},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(Hi.g),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(oi.Z),t.\u0275\u0275directiveInject(xt.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ai.L),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Nt.F),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(Ki.r),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(pt.z),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(vt.Q),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(fr.M),t.\u0275\u0275directiveInject(t.ChangeDetectorRef))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["sync-group-pane"]],decls:2,vars:3,consts:[["focus-nav-mode","Group","disableScroll","","noPadding","","pbiAutoFocus","","keyboard-shortcuts","ctrl-F6","focus-priority","8",3,"expanded","allowToggle","title","optionsSetting","ariaDescribedBy","showCollapse","onCollapse","onToggle",4,"ngIf"],["focus-nav-mode","Group","disableScroll","","noPadding","","pbiAutoFocus","","keyboard-shortcuts","ctrl-F6","focus-priority","8",3,"expanded","allowToggle","title","optionsSetting","ariaDescribedBy","showCollapse","onCollapse","onToggle"],[4,"ngIf"],["class","syncGroupPane","noPadding","",4,"ngIf"],["localize","SyncGroupPane_SelectSlicer",1,"selectionInstructions",3,"id"],["noPadding","",1,"syncGroupPane"],[1,"syncGroupSection"],["localize","SyncGroupPane_Description","localize-fragments","",1,"syncGroupDescription"],["tabindex","0","role","button","fragment-index","0","localize","SyncGroupPane_AddToAll",1,"syncAllButton",3,"accessible-click"],["data-testid","sync-group-table","role","table",1,"syncGroupTable"],["role","row",1,"row"],["role","columnheader","localize","PageName",1,"headerCell","columnPageName","trimmedTextWithEllipsis"],["role","columnheader",1,"headerCell","columnCheckbox"],["size","mini","role","img","name","filtersync","localize-tooltip","Sync"],["role","img","size","mini","name","show","localize-tooltip","Visible",1,"visibility"],["role","row","class","row",3,"navigatable","currentPage",4,"ngFor","ngForOf","ngForTrackBy"],["noPadding","",1,"advancedOptions"],["tabindex","0",1,"advancedOptionsToggle",3,"accessible-click"],["size","mini","name","chevrondownsmall",1,"advancedOptionsCaret"],["localize","AdvancedOptions",1,"advancedOptionsLabel"],["class","advancedOptionsContent",4,"ngIf"],["role","rowheader",1,"bodyCell","columnPageName",3,"click"],[1,"trimmedTextWithEllipsis"],["role","cell",1,"bodyCell","columnCheckbox"],["localize-tooltip","SyncGroupPane_SyncTooltip",3,"isCompact","ariaLabel","checked","disabled","onChange"],["localize-tooltip","SyncGroupPane_VisibleTooltip",3,"isCompact","ariaLabel","disabled","checked","onChange"],[1,"advancedOptionsContent"],["localize","SyncGroupPane_GroupNameLabel",1,"groupNameLabel"],["maxlength","250",1,"groupNameInput",3,"ngModel","ngModelChange"],[1,"syncFieldsCheckbox",3,"isCompact","disabled","label","ariaLabel","checked","onChange"]],template:function(e,i){1&e&&(t.\u0275\u0275template(0,Or,3,8,"pbi-pane",0),t.\u0275\u0275pipe(1,"async")),2&e&&t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[P.NgForOf,P.NgIf,Ee.Fj,Ee.JJ,Ee.nD,Ee.On,mr.X,yr.r,ki.t,Cr.r,Qi.q,br.v,Pr._,Xi.VO,Zi.i,P.AsyncPipe,je.F],styles:["[_nghost-%COMP%]{display:flex;flex-grow:1;flex-direction:column}.syncGroupPane[_ngcontent-%COMP%]{--sync-slicers-link-color: var(--fluent-theme-link-color, #0078D4);--sync-slicers-link-hover-color: var(--fluent-theme-dark-color, #A98C0C);--sync-slicers-row-hover-background-color: var(--gray-30, #EDEBE9);--sync-slicers-advanced-pane-hover-background-color: var(--gray-30, #EDEBE9);--sync-slicers-input-border-color: var(--gray-120, #797775);--sync-slicers-input-background-color: var(--fluent-theme-white-color, #FFF);--sync-slicers-advanced-button-border-color: var(--gray-40, #E1DFDD);--sync-slicers-table-border-color: var(--gray-60, #C8C6C4);--sync-slicers-table-header-background: var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);--sync-slicers-table-header-border-color: var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);flex-grow:1;overflow:auto}  [data-legacy-theming=false] .syncGroupPane{--sync-slicers-link-color: var(--colorBrandForegroundLink);--sync-slicers-link-hover-color: var(--colorBrandForegroundLinkHover);--sync-slicers-row-hover-background-color: var(--colorNeutralBackground1Hover);--sync-slicers-advanced-pane-hover-background-color: var(--colorNeutralBackground1Hover);--sync-slicers-input-border-color: var(--colorNeutralStroke1);--sync-slicers-input-background-color: var(--colorNeutralBackground1);--sync-slicers-advanced-button-border-color: var(--colorNeutralStroke1);--sync-slicers-table-border-color: var(--colorNeutralStroke1);--sync-slicers-table-header-background: var(--colorNeutralBackground1);--sync-slicers-table-header-border-color: var(--colorNeutralStroke1)}.syncGroupPane[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:default}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupSection[_ngcontent-%COMP%]{display:flex;flex-direction:column}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupDescription[_ngcontent-%COMP%]{margin-bottom:4px}.syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]{color:var(--sync-slicers-link-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:hover, .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{cursor:pointer;text-decoration:underline}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=mouse][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]{border:1px solid var(--sync-slicers-table-border-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:focus-within{background:var(--fluent-theme-neutral-secondary-color, #605E5C)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]:hover{background:var(--sync-slicers-row-hover-background-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{cursor:pointer;color:var(--sync-slicers-link-color)}html[data-focus-source][_ngcontent-%COMP%]:not([data-focus-source=key])   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:focus, html[data-focus-source][_ngcontent-%COMP%]:not([data-focus-source=key])   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{color:var(--sync-slicers-link-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:hover{color:var(--sync-slicers-link-hover-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]{height:20px;border-style:solid;border-width:0 0 1px 1px;background:var(--sync-slicers-table-header-background);border-color:var(--sync-slicers-table-header-border-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell.columnPageName[_ngcontent-%COMP%]{text-align:left;cursor:default}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]   pbi-icon.visibility[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{font-size:13px}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .bodyCell[_ngcontent-%COMP%]{border-left:1px solid var(--fluent-theme-neutral-secondary-color, #605E5C);padding:2px 0}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnCheckbox[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnVisible[_ngcontent-%COMP%]{width:24px;display:flex;align-items:center;justify-content:center;flex:0 0 auto}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;border-left:0;overflow:hidden;white-space:nowrap}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;display:block;padding-left:2px}.syncGroupPane[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin-bottom:0}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;margin-top:12px}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsContent[_ngcontent-%COMP%]{padding:8px}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsCaret[_ngcontent-%COMP%]{transform:rotate(-90deg);transition:transform .25s ease-out;display:flex}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]{height:36px;padding:4px 4px 4px 12px;display:flex;align-items:center;border:1px solid var(--sync-slicers-advanced-button-border-color);border-style:solid none;cursor:pointer}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:hover{background:var(--sync-slicers-advanced-pane-hover-background-color)}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=mouse][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .expandedAdvancedOptions[_ngcontent-%COMP%]   .advancedOptionsCaret[_ngcontent-%COMP%]{transform:rotate(0)}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsLabel[_ngcontent-%COMP%]{display:inline;margin-left:8px;cursor:pointer}.syncGroupPane[_ngcontent-%COMP%]   .groupNameLabel[_ngcontent-%COMP%]{white-space:normal}.syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]{display:block;width:100%;height:24px;margin-top:8px;padding-left:4px;border:1px solid var(--sync-slicers-input-border-color);background:var(--sync-slicers-input-background-color)}.syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncFieldsCheckbox[_ngcontent-%COMP%]{margin-top:8px}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncFieldsCheckbox[_ngcontent-%COMP%]:focus-within{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]{color:var(--fluent-theme-link-color, #0078D4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]{border-color:var(--gray-60, #C8C6C4)}html[data-focus-source=key][_ngcontent-%COMP%]   .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:focus-within{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]:hover{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{color:var(--fluent-theme-link-color, #0078D4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-dark-color, #A98C0C)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]{background:var(--gray-40, #E1DFDD);border-color:var(--gray-60, #C8C6C4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .bodyCell[_ngcontent-%COMP%]{border-color:var(--gray-60, #C8C6C4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsContent[_ngcontent-%COMP%]{background:var(--gray-20, #F3F2F1)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]{border-color:var(--gray-40, #E1DFDD)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:hover, .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus, .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus-within{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]{background:var(--fluent-theme-white-color, #FFF);border-color:var(--gray-60, #C8C6C4)}"],changeDetection:0}),o}();function Yi(o,n,e){o.clearSyncGroup(e),qi(o,n,e,!0)}function qi(o,n,e,i){o.setVisibility(e,!i,!0),o.notifyVisualContainers([e]),n.publishToChannel(I.cyb,{changedItems:[e]})}function si(o,n,e){var i=n.config.singleVisual.syncGroup;o.assignSyncGroup(n,i?(0,p.__assign)((0,p.__assign)({},i),{groupName:e}):{groupName:e,fieldChanges:!0,filterChanges:!0})}l(92160);var Fr=l(59787),en=l(22318),Ze=l(23558),Er=l(77526),Vr=l(6181),Dr=l(73805),ye=l(9215),Tr=l(23224),Je=l(10556),tn=l(65195),Ar=l(9500),Ir=l(7475),Br=l(95281),Pe=l(85732);function nn(o){return me.UP.getSelectedCanvasItems(o)}function li(o,n){return!_.isEmpty(o)&&_.every(o,function(e){return(0,ye.Vz)(e)&&n.isQueryVisual((0,R.s)(e))})}function ci(o,n){return!_.isEmpty(o)&&_.every(o,function(e){return(0,ye.Vz)(e)&&n.canConvertVisual(e)})}function rn(o){return!_.isEmpty(o)&&_.every(o,function(n){return(0,R.s)(n)===(0,R.s)(o[0])})}function on(o,n){return!_.isEmpty(o)&&_.every(o,function(e){return(0,ye.Vz)(e)&&n.isSupportedVisual(e)})}var Be=function(n){return n.active},kr=function(n){return n.alwaysPopulatePanes},an=function(n){return n.availableSectionTypes},zr=function(n){return n.isEditing},Rt=function(n){return n.selectedVisuals},sn=function(o){function n(e,i,r){var a=o.call(this)||this;return a.featureSwitchService=e,a.localizationService=i,a.visualPluginOps=r,a.updateState=a.updater(function(s,c){return(0,p.__assign)((0,p.__assign)({},s),c)}),a.getProperty=function(s){return(0,Pe.P1)(function(c){return c},function(c){return c[s]})},a.populatePanes=(0,Pe.P1)(zr,kr,function(s,c){return s||c}),a.header=(0,Pe.P1)(a.populatePanes,Rt,function(s,c){var u,d,g=(u=(0,ye.rQ)(c))[0],v=u[1];if(s&&!_.isEmpty(g)&&_.isEmpty(v)){var f=(0,R.s)(g[0]),m=rn(g)?f:null;m&&(m===J.L.basicShape.name||m===J.L.shape.name?d="VisualizationPane_Shape":m===J.L.image.name?d="VisualizationPane_Image":m===J.L.textbox.name?d="VisualizationPane_Text_Box":m===J.L.actionButton.name?d="VisualizationPane_Action_Button":(m===J.L.pageNavigator.name||m===J.L.bookmarkNavigator.name)&&(d="VisualizationPane_Navigator"))}return d??(a.featureSwitchService.featureSwitches.onObject?"Format":"VisualizationPane_Title")}),a.showVisualTypes=(0,Pe.P1)(a.populatePanes,Rt,Be,function(s,c,u){var d,g;if(_.isEmpty(c))g=s&&0===u;else{var v=(d=(0,ye.rQ)(c))[0];g=s&&(!_.isEmpty(d[1])||ci(v,a.visualPluginOps))&&0===u}return g}),a.sections=(0,Pe.P1)(an,function(s){return a.loadSectionDetails(s)}),a.showFieldWellOrFilters=(0,Pe.P1)(Be,function(s){return 0===s}),a.showFieldWell=(0,Pe.P1)(a.populatePanes,Be,function(s,c){return s&&0===c}),a.showPropertyPane=(0,Pe.P1)(a.populatePanes,Be,Rt,function(s,c,u){return!_.isEmpty(u)&&s&&1===c}),a.showPagePropertyPane=(0,Pe.P1)(a.populatePanes,Be,Rt,function(s,c,u){return _.isEmpty(u)&&s&&3===c}),a.showAnalyticsPane=(0,Pe.P1)(a.populatePanes,Be,function(s,c){return s&&2===c}),a.showDrillthroughPane=(0,Pe.P1)(a.showFieldWellOrFilters,function(s){return s}),a.showBuildSection=(0,Pe.P1)(a.showVisualTypes,a.showFieldWellOrFilters,function(s,c){return!a.featureSwitchService.featureSwitches.onObject&&(s||c)}),a.activeSectionIndex=(0,Pe.P1)(Be,an,function(s,c){return c.findIndex(function(u){return u===s})}),a}return(0,p.__extends)(n,o),n.prototype.setVisualizationPaneViewModelState=function(e){this.setState(e)},n.prototype.select$=function(e){return this.select(this.getProperty(e))},n.prototype.loadSectionDetails=function(e){var i=this;return e.map(function(a){return i.getSectionDetails(a)})},n.prototype.getSectionDetails=function(e){var i,r="_paneColorRefresh";switch(e){case 0:i={sectionType:e,displayName:this.localizationService.get("VisualizationPane_Section_Fields"),cssClass:"fields",normalSvg:"",styledSvg:""};break;case 1:i={sectionType:e,displayName:this.localizationService.get("Format"),cssClass:"format",normalSvg:"",styledSvg:""};break;case 2:i={sectionType:e,displayName:this.localizationService.get("VisualizationPane_Section_Analytics"),cssClass:"analytics",normalSvg:"",styledSvg:""};break;case 3:i={sectionType:e,displayName:this.localizationService.get("Page"),cssClass:"page",normalSvg:"",styledSvg:""};break;default:D.fF.assertNever(e)}return i.normalSvg="visualizationPane".concat(_.upperFirst(i.cssClass),"Modern").concat(r),i.styledSvg="visualizationPane".concat(_.upperFirst(i.cssClass),"ModernSelected").concat(r),i},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(se.o),t.\u0275\u0275inject(Ve.f))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(Br.m1),ln=l(21302),Lr=l(94130),Nr=l(42645),Rr=l(43025),jr=l(84144),Wr=l(43859),Ur=l(32441),$r=l(53240),Gr=l(64713),Hr=l(2380),Kr=l(11991),Qr=l(26124),Xr=function(o){function n(e,i){return o.call(this,e,i)||this}return(0,p.__extends)(n,o),n.prototype.ngOnInit=function(){var e=this;this.changes$("pbiEmphasisOpacity").pipe((0,ze.w)(function(r){return r||Tt.E})).subscribe(function(){var r=e.getAnimation("opacity",1);e.emphasize(r)})},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(Qr._j,8),t.\u0275\u0275directiveInject(t.ElementRef))},n.\u0275dir=t.\u0275\u0275defineDirective({type:n,selectors:[["","pbiEmphasisOpacity",""]],inputs:{pbiEmphasisOpacity:"pbiEmphasisOpacity"},features:[t.\u0275\u0275InheritDefinitionFeature]}),n}(Kr.A),Zr=l(47808),Jr=d3.easeCubic,Yr=d3.select,qr=["svgPathElement"];function eo(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"div",10),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275elementEnd()),2&o){var e=n.ngIf;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,e)," ")}}var to=function(n,e){return{currentSection:n,sections:e,rootAttribute:"focus-pivot-root",pivotAttribute:"focus-pivot"}};function io(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"pbi-button-toggle",11),t.\u0275\u0275listener("pointerenter",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.styledSvg,!0,!0))})("pointerleave",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.styledSvg,!1,!0))})("onFocus",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.normalSvg,!0,!1))})("onBlur",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.normalSvg,!1,!1))})("valueChanged",function(u){var g=t.\u0275\u0275restoreView(e).$implicit,v=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(v.sectionSelectEvent.fn({value:g.sectionType,checked:u}))})("onActiveSection",function(u){t.\u0275\u0275restoreView(e);var d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.sectionSelectEvent.fn({value:u.nextSection.sectionType,checked:!0}))}),t.\u0275\u0275elementStart(2,"div",12)(3,"div",13),t.\u0275\u0275element(4,"pbi-svg-use-symbol",14)(5,"pbi-svg-use-symbol",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementContainerEnd()}if(2&o){var i=n.$implicit,r=n.ngForOf,a=t.\u0275\u0275nextContext(2).ngIf,s=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("role","tab")("checked",i.sectionType===a.active)("value",i.sectionType)("aria-label",s.ariaLabels[i.sectionType])("buttonTabIndex",i.sectionType===a.active?0:-1)("pivot-tab-key-handler",t.\u0275\u0275pureFunction2(15,to,i,r)),t.\u0275\u0275attribute("data-testid","visualization-pane-tab-"+i.sectionType),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("selected",i.sectionType===a.active),t.\u0275\u0275property("pbiTooltip",s.tooltips[i.sectionType]),t.\u0275\u0275attribute("data-unique-id",i.sectionType),t.\u0275\u0275advance(2),t.\u0275\u0275property("sheet",s.sectionIconSheetName)("symbolId",i.normalSvg),t.\u0275\u0275advance(1),t.\u0275\u0275property("sheet",s.sectionIconSheetName)("symbolId",i.styledSvg)}}function no(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"div",16,17)(2,"div",18),t.\u0275\u0275namespaceSVG(),t.\u0275\u0275elementStart(3,"svg",19,20),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275element(6,"path",21,22),t.\u0275\u0275elementEnd(),t.\u0275\u0275namespaceHTML(),t.\u0275\u0275elementStart(8,"div",23),t.\u0275\u0275element(9,"div",24)(10,"div",25),t.\u0275\u0275elementEnd()()()),2&o){var e=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(3),t.\u0275\u0275attribute("transform",t.\u0275\u0275pipeBind1(5,1,e.isRTL$)?"scale(-1, 1)":null)}}function ro(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"pbi-pane-divider"),t.\u0275\u0275template(1,eo,3,3,"div",6),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275elementStart(3,"pbi-button-toggle-group",7),t.\u0275\u0275template(4,io,6,18,"ng-container",8),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(6,no,11,3,"div",9),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(2,4,i.sectionTitle$)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(5,6,i.sections$))("ngForTrackBy",i.trackBySectionTypeFn),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.showIndicator(e.availableSectionTypes))}}function oo(o,n){if(1&o&&(t.\u0275\u0275element(0,"build-section",29),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275pipe(5,"async")),2&o){var e=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("disableScrollbar",e.isWholePaneScrollable)("showVisualTypes",t.\u0275\u0275pipeBind1(1,9,e.showVisualTypes$))("showFieldWell",t.\u0275\u0275pipeBind1(2,11,e.showFieldWell$))("showDrillthroughPane",t.\u0275\u0275pipeBind1(3,13,e.showDrillthroughPane$))("showFieldWellOrFilters",t.\u0275\u0275pipeBind1(4,15,e.showFieldWellOrFilters$))("populatePanes",t.\u0275\u0275pipeBind1(5,17,e.populatePanes$))("visualPluginFilter",e.paneViewModel.visualPluginFilter)("nonPersonalVisualizationPaneFilter",e.paneViewModel.nonPersonalVisualizationPaneFilter)("showNonPersonalVisuals",e.showNonPersonalVisualizationPane())}}function ao(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"section",30),t.\u0275\u0275element(1,"formatting-pane-lazy",31),t.\u0275\u0275elementEnd()),2&o){var e=n.ngIf,i=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("id","toggle-group-tab-panel3"),t.\u0275\u0275advance(1),t.\u0275\u0275property("formattingSources",e.formattingSources)("disableScrollbar",i.isWholePaneScrollable)}}function so(o,n){if(1&o&&(t.\u0275\u0275elementStart(0,"pbi-pane-section",26),t.\u0275\u0275template(1,oo,6,19,"build-section",27),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275template(3,ao,2,3,"section",28),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()),2&o){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275property("hidden",!e.isPaneExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(2,3,i.showBuildSection$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(4,5,i.formattingPaneModel$))}}function lo(o,n){if(1&o){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",2),t.\u0275\u0275listener("resizing",function(s){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.onResizing(s))}),t.\u0275\u0275elementStart(1,"pbi-pane",3),t.\u0275\u0275listener("onToggle",function(){var c=t.\u0275\u0275restoreView(e).ngIf,u=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(u.onPaneExpanded.emit(!c.isPaneExpanded))})("onCollapse",function(){t.\u0275\u0275restoreView(e);var s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.onPaneCollapsed())}),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275template(3,ro,7,8,"pbi-pane-divider",4),t.\u0275\u0275template(4,so,5,7,"pbi-pane-section",5),t.\u0275\u0275elementEnd()()}if(2&o){var i=n.ngIf,r=t.\u0275\u0275nextContext();t.\u0275\u0275classProp("isCollapsed",!i.isPaneExpanded),t.\u0275\u0275property("pbiEmphasisBackground",r.emphasize$)("pbiEmphasisBackgroundColor","var(--globalColorBrand160)"),t.\u0275\u0275advance(1),t.\u0275\u0275property("expanded",i.isPaneExpanded)("title",t.\u0275\u0275pipeBind1(2,12,r.header$))("allowToggle",!r.onObject)("optionsSetting",r.paneViewModel.optionsSetting)("disableScroll",!r.isWholePaneScrollable)("showCollapse",r.onObject),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!r.onObjectOn&&i.isPaneExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isPaneExpanded)}}var co=["M0 8.5H16L24 1L32 8.5H180","M0 8.5H82L90 1L98 8.5H180","M0 8.5H148L156 1L164 8.5H180"],dn=function(o){function n(e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w){var E=o.call(this)||this;return E.promiseFactory=e,E.directionality=i,E.eventBridge=r,E.explorationNavigation=a,E.favoriteVisualLoader=s,E.featureSwitchService=c,E.globalEventBridge=u,E.highContrastCssGenerationService=d,E.localizationService=g,E.paneVisibilityService=v,E.selection=f,E.svgProviderService=m,E.telemetryService=y,E.viewModeState=x,E.visualizationPaneService=C,E.visualPaneSettingsService=B,E.visualPlugin=M,E.visualPluginOps=w,E.onPaneExpanded=new t.EventEmitter,E.isWholePaneScrollable=window.innerWidth<640||window.innerHeight<360,E.preparePersonalVisualizationPane(),E.initializeHighContrastRules(),E.onObjectOn=E.featureSwitchService.featureSwitches.onObject,E.channelSubscriptions=r.createChannelSubscriptionManager(),E.channelSubscriptions.subscribe(ln.sn,function(){E.visualizationPaneService.updateState({isPaneExpanded:!0,active:1}),E.paneVisibilityService.isPaneExpanded("format")||E.paneVisibilityService.togglePaneExpansion("format")}),E.channelSubscriptions.subscribe(ln.mF,function(){E.selection.clearSelection(),E.visualizationPaneService.updateState({isPaneExpanded:!0,active:3}),E.paneVisibilityService.isPaneExpanded("format")||E.paneVisibilityService.togglePaneExpansion("format")}),E.onDestroy$.subscribe(function(G){G&&E.channelSubscriptions.unsubscribeAll()}),E}return(0,p.__extends)(n,o),n.prototype.ngOnInit=function(){var e=this;this.setInitialState(),this.initSelectors(),this.initExpansionHandler(),this.initEventHandlers(),this.ariaLabels=this.buildAriaLabels(),this.tooltips=this.buildTooltips();var i=this.isEditing$.pipe((0,X.U)(function(v){return{isEditing:v}})),r=this.alwaysPopulatePanes$.pipe((0,X.U)(function(v){return{alwaysPopulatePanes:v}})),a=this.mergeSelectedVisualType$.pipe((0,X.U)(function(v){return{selectedVisuals:v.selectedVisuals,visualType:v.visualType}})),s=this.availableSectionTypes$.pipe((0,X.U)(function(v){return{availableSectionTypes:v}})),c=this.active$.pipe((0,X.U)(function(v){return{active:v.active,previous:v.previous}})),u=this.isPaneExpanded$.pipe((0,X.U)(function(v){return{isPaneExpanded:v}})),d=this.isPaneVisible$.pipe((0,X.U)(function(v){return{isPaneVisible:v}})),g=(0,V.T)(i,r,a,s,c,u,d);this.visualizationPaneService.updateState(g),this.isRTL$=this.directionality.change.pipe((0,en.O)(this.directionality.value),(0,X.U)(function(v){return"rtl"===v})),this.emphasize$=this.paneVisibilityService.getPaneEmphasis$("format"),(0,Fr.R)(window,"resize").subscribe(function(v){var f=window.innerWidth,m=window.innerHeight;e.isWholePaneScrollable=f<640||m<360})},n.prototype.ngAfterViewInit=function(){var e=this;this.svgPathElement$=this.svgPathElements.changes.pipe((0,X.U)(function(r){return r.first}),(0,en.O)(this.svgPathElements.first),(0,X.U)(function(r){return r&&Yr(r.nativeElement)}));var i=this.svgPathElement$.pipe((0,ze.w)(function(r){return r?e.activeSectionIndex$:Tt.E}));(0,V.T)(i,this.svgPathElement$.pipe((0,F.h)(function(r){return!!r}))).pipe((0,Ze.M)(i,this.svgPathElement$),(0,Er.x)()).subscribe(function(r){return e.changePath(r[2],r[1])}),this.svgProviderService.toggleCssClasses(!0,"active",this.sectionIconSheetName,this.defaultSectionSelectedSVG)},Object.defineProperty(n.prototype,"onObject",{get:function(){return this.featureSwitchService.featureSwitches.onObject},enumerable:!1,configurable:!0}),n.prototype.onPaneCollapsed=function(){this.paneVisibilityService.setPaneExpansion("format",!1)},n.prototype.showNonPersonalVisualizationPane=function(){var e=this;return _.some(this.visualPlugin.getConvertibleVisuals(),function(i){if(!i)return!1;var r=!1,a=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&e.visualPaneSettingsService.isFavoritePublicCustomVisual(i.name),s=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&i.favoriteId||a,c=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&!i.favoriteId&&!a,u=e.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&i.custom&&i.isOutOfBox,d=e.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled&&e.visualPaneSettingsService.isUnpinnedVisual(i.name);return(i.custom&&!u&&c||d&&!s)&&(r=!0),r})},n.prototype.preparePersonalVisualizationPaneServices=function(){var e=this,i=[];return this.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.push(this.favoriteVisualLoader.ensureFavoriteVisualResources(this.visualPlugin)),this.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&i.push(this.favoriteVisualLoader.ensureOutOfBoxVisuals(this.visualPlugin)),this.promiseFactory.allSettled(i).finally(function(){if(e.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled)return e.visualPaneSettingsService.updateVisuals()})},n.prototype.preparePersonalVisualizationPane=function(){var e=this;this.preparePersonalVisualizationPaneServices().finally(function(){e.eventBridge.publishToChannel(I.Udu)})},n.prototype.initSelectors=function(){var e=this.visualizationPaneService;this.activeSectionIndex$=e.select(e.activeSectionIndex),this.populatePanes$=e.select(e.populatePanes),this.showFieldWell$=e.select(e.showFieldWell),this.showAnalyticsPane$=e.select(e.showAnalyticsPane),this.showDrillthroughPane$=e.select(e.showDrillthroughPane),this.showPropertyPane$=e.select(e.showPropertyPane),this.showPagePropertyPane$=e.select(e.showPagePropertyPane),this.showVisualTypes$=e.select(e.showVisualTypes),this.showFieldWellOrFilters$=e.select(e.showFieldWellOrFilters),this.showBuildSection$=e.select(e.showBuildSection),this.header$=e.select(e.header),this.sections$=e.select(e.sections),this.sectionTitle$=e.select(Be).pipe((0,X.U)(function(s){switch(s){case 3:return"Format_Page";case 1:return"Format_Visual";case 0:return"Build_Visual";case 2:return"VisualizationPane_Section_Analytics";default:return void D.fF.assertNever(s)}}));var i=this.showAnalyticsPane$.pipe((0,X.U)(function(s){return s?{formattingSources:["Analytics"]}:void 0})),r=this.showPagePropertyPane$.pipe((0,X.U)(function(s){return s?{formattingSources:["Page"]}:void 0})),a=this.showPropertyPane$.pipe((0,X.U)(function(s){return s?{formattingSources:["Visual","Format_Label_General"]}:void 0}));this.formattingPaneModel$=(0,Fe.aj)([i,r,a]).pipe((0,X.U)(function(s){return s.find(function(c){return!_.isUndefined(c)})}))},n.prototype.initEventHandlers=function(){var e=this,i=this.visualizationPaneService,r=i.select$("selectedVisuals"),a=i.select$("active"),s=i.select$("availableSectionTypes");this.isEditing$=this.viewModeState.getMode$().pipe((0,T.R)(this.onDestroy$),(0,X.U)(function(v){return 1===v})),this.isEditing$.pipe((0,T.R)(this.onDestroy$)).subscribe(function(v){v&&e.updateExplorationVisuals()}),this.alwaysPopulatePanes$=this.viewModeState.getConfig$().pipe((0,Vr.j)("alwaysPopulatePanes"),(0,T.R)(this.onDestroy$),(0,X.U)(function(v){return v})),this.mergeSelectedVisualType$=(0,V.T)(this.eventBridge.on(I.tRg),this.eventBridge.on(I.KD7)).pipe((0,T.R)(this.onDestroy$),(0,X.U)(function(v){var f,m=nn(e.selection),y=null,x=(f=(0,ye.rQ)(m))[0],C=f[1];if(!_.isEmpty(x)&&_.isEmpty(C)){var B=(0,R.s)(x[0]);rn(x)&&(y=B)}return{selectedVisuals:m,visualType:y}}));var c=this.globalEventBridge.on(Tr.U.SignInStatusChangedEvent);c.pipe((0,T.R)(this.onDestroy$)).subscribe(function(v){e.favoriteVisualLoader.reset(e.visualPlugin),e.visualPaneSettingsService.reset()}),(0,V.T)(this.eventBridge.on(Ir.nR),c).pipe((0,T.R)(this.onDestroy$)).subscribe(function(v){e.preparePersonalVisualizationPane()}),this.availableSectionTypes$=this.mergeSelectedVisualType$.pipe((0,Ze.M)(r),(0,X.U)(function(v){var f,y=v[1],x=[];if(_.isEmpty(y))e.featureSwitchService.featureSwitches.onObject||x.push(0),x.push(3);else{var C=(f=(0,ye.rQ)(y))[0],B=f[1],M=ci(y,e.visualPluginOps);(li(y,e.visualPluginOps)||M||!_.isEmpty(B))&&(e.featureSwitchService.featureSwitches.onObject||x.push(0),_.every(C,function(G){return e.visualPluginOps.canFormatVisual(G)})&&(x.push(1),e.featureSwitchService.featureSwitches.onObject||x.push(2)))}return x})),this.sectionSelectEvent=this.createEventAdapter();var u=this.sectionSelectEvent.$.pipe((0,F.h)(function(v){return v.checked}),(0,Ze.M)(s),(0,X.U)(function(v){var f=v[0];return v[1].find(function(y){return y===f.value})})),d=(0,V.T)(this.eventBridge.on(I.cY_),this.eventBridge.on(I.x4H)).pipe((0,Ze.M)(r),(0,F.h)(function(v){return li(v[1],e.visualPluginOps)}),(0,Dr.h)(this.featureSwitchService.featureSwitches.onObject?1:2)),g=this.mergeSelectedVisualType$.pipe((0,Ze.M)(r,a),(0,X.U)(function(v){var C,y=v[1],x=v[2],B=e.featureSwitchService.featureSwitches.onObject?3:0;if(_.isEmpty(y))C=B;else{var w=(0,ye.rQ)(y)[1],E=li(y,e.visualPluginOps),G=ci(y,e.visualPluginOps);C=!_.isEmpty(w)||E||G?3===x?1:x:on(y,e.visualPluginOps)?1:B}return C}));this.active$=(0,V.T)(u,d,g).pipe((0,Ze.M)(a),(0,X.U)(function(v){return{active:v[0],previous:v[1]}})),(0,Fe.aj)([this.active$,this.sections$]).subscribe(function(v){var f=v[0],m=v[1],y=f.active,x=f.previous,C=m.find(function(M){return M.sectionType===y}),B=m.find(function(M){return M.sectionType===x});B&&(e.svgProviderService.toggleCssClasses(!1,"active",e.sectionIconSheetName,B.styledSvg),e.svgProviderService.toggleCssClasses(!1,"focus",e.sectionIconSheetName,B.normalSvg)),C&&e.svgProviderService.toggleCssClasses(!0,"active",e.sectionIconSheetName,C.styledSvg)})},n.prototype.initExpansionHandler=function(){var e=this,i=this.paneVisibilityService.getPanes$().pipe((0,X.U)(function(a){var s;return null===(s=a.format)||void 0===s?void 0:s.isPaneExpanded})),r=this.onPaneExpanded.asObservable();this.isPaneExpanded$=(0,V.T)(r,i),this.isPaneVisible$=this.paneVisibilityService.getPanes$().pipe((0,X.U)(function(a){var s;return null===(s=a.format)||void 0===s?void 0:s.isPaneVisible})),r.pipe((0,T.R)(this.onDestroy$)).subscribe(function(a){e.telemetryService.logEvent(Je.vLR,{paneType:"Visualization",expanded:a,viewMode:(0,Ar.ku)(e.viewModeState.getMode())}),e.paneVisibilityService.togglePaneExpansion("format")})},n.prototype.setInitialState=function(){this.sectionIconSheetName="visualizationPaneIcons_paneColorRefresh",this.defaultSectionSelectedSVG="visualizationPaneFieldsModernSelected_paneColorRefresh",this.viewModelStore$=this.visualizationPaneService.state$,this.svgProviderService.loadSheet(this.sectionIconSheetName);var e=nn(this.selection),i=_.isEmpty(e)?[3]:[1],r=0,a=on(e,this.visualPluginOps);this.featureSwitchService.featureSwitches.onObject?r=a?1:3:(i.unshift(0),a&&i.push(2)),this.visualizationPaneService.setVisualizationPaneViewModelState({active:r,previous:r,availableSectionTypes:i,isPaneVisible:this.paneVisibilityService.isPaneVisible("format"),isPaneExpanded:this.paneVisibilityService.isPaneExpanded("format"),selectedVisuals:e})},n.prototype.changePath=function(e,i){i>=0&&i<=2&&e.transition().duration(200).ease(Jr).attr("d",co[i])},n.prototype.updateExplorationVisuals=function(){this.visualPaneSettingsService.resetExplorationVisuals();var e=this.explorationNavigation.getCurrentExploration();if(e)for(var i=0,r=e.sections;i<r.length;i++)for(var s=0,c=r[i].visualContainers;s<c.length;s++)this.visualPaneSettingsService.addExplorationVisual(c[s].config.singleVisual.visualType)},n.prototype.showIndicator=function(e){return!!(e&&e.length>0)},n.prototype.buildAriaLabels=function(){var e;return(e={})[0]=this.localizationService.get("Build_Visual"),e[1]=this.localizationService.get("Format_Visual"),e[2]=this.localizationService.get("VisualizationPane_Section_Analytics"),e[3]=this.localizationService.get("Format_Page"),e},n.prototype.buildTooltips=function(){var e;return(e={})[0]=this.localizationService.get("VisualizationPane_Section_Build_Visual_Description"),e[1]=this.localizationService.get("VisualizationPane_Section_Format_Visual_Description"),e[2]=this.localizationService.get("VisualizationPane_Section_Analytics_Button_Description"),e[3]=this.localizationService.get("VisualizationPane_Section_Format_Page_Description"),e},n.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".visualization-pane pbi-button-toggle-group .outer.selected","{ background-color: @selectedBackgroundColor !important; }")},n.prototype.toggleEffectClasses=function(e,i,r){this.svgProviderService.toggleCssClasses(i,r?tn.Cj:tn.PG,this.sectionIconSheetName,e)},n.prototype.trackBySectionTypeFn=function(e,i){return i.sectionType},Object.defineProperty(n.prototype,"paneSectionClass",{get:function(){return this.isWholePaneScrollable?"pane-section paneScrollable":"pane-section paneNotScrollable"},enumerable:!1,configurable:!0}),n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(Lr.Is),t.\u0275\u0275directiveInject(ne.J),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(Nr.W),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Rr.Z),t.\u0275\u0275directiveInject(Hi.g),t.\u0275\u0275directiveInject(se.o),t.\u0275\u0275directiveInject(Ki.r),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(jr.g),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Fi.kc),t.\u0275\u0275directiveInject(sn),t.\u0275\u0275directiveInject(it.R),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Ve.f))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["visualization-pane-modern"]],viewQuery:function(i,r){var a;(1&i&&t.\u0275\u0275viewQuery(qr,5),2&i)&&(t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(r.svgPathElements=a))},hostVars:2,hostBindings:function(i,r){2&i&&t.\u0275\u0275attribute("data-automation-type","visualizationPane")("data-testid","visualization-pane")},inputs:{paneViewModel:"paneViewModel"},outputs:{onPaneExpanded:"onPaneExpanded"},features:[t.\u0275\u0275ProvidersFeature([sn,{provide:Bi.yk,useValue:{source:"Pane",paneType:"format"}}]),t.\u0275\u0275InheritDefinitionFeature],decls:3,vars:4,consts:[["class","visualization-pane","data-automation-type","visualizationPaneGroup","keyboard-shortcuts","ctrl-F6","focus-priority","12","focus-nav-mode","Group",3,"isCollapsed","pbiEmphasisBackground","pbiEmphasisBackgroundColor","resizing",4,"ngIf"],[1,"emphasis-border",3,"pbiEmphasisOpacity"],["data-automation-type","visualizationPaneGroup","keyboard-shortcuts","ctrl-F6","focus-priority","12","focus-nav-mode","Group",1,"visualization-pane",3,"pbiEmphasisBackground","pbiEmphasisBackgroundColor","resizing"],["role","region","overlayScrollbar","","noPadding","",3,"expanded","title","allowToggle","optionsSetting","disableScroll","showCollapse","onToggle","onCollapse"],[4,"ngIf"],["class","pane-section","noPadding","",3,"hidden",4,"ngIf"],["class","section-title",4,"ngIf"],["role","tablist","focus-pivot-root",""],[4,"ngFor","ngForOf","ngForTrackBy"],["class","select-button-indicator",4,"ngIf"],[1,"section-title"],["pbiTooltipCheckChildren","true","focus-pivot","",3,"role","checked","value","aria-label","buttonTabIndex","pivot-tab-key-handler","pointerenter","pointerleave","onFocus","onBlur","valueChanged","onActiveSection"],[1,"outer",3,"pbiTooltip"],[1,"content"],[1,"normal-svg",3,"sheet","symbolId"],[1,"styled-svg",3,"sheet","symbolId"],[1,"select-button-indicator"],["custom",""],[1,"divider-component"],["width","180","height","9","viewBox","0 0 180 9","fill","none","xmlns","http://www.w3.org/2000/svg",1,"select-indicator-bar"],["svgElement",""],["d","M0 8.5H16L24 1L32 8.5H180"],["svgPathElement",""],[1,"filler"],[1,"space"],[1,"line"],["noPadding","",1,"pane-section",3,"hidden"],["class","pane-content",3,"disableScrollbar","showVisualTypes","showFieldWell","showDrillthroughPane","showFieldWellOrFilters","populatePanes","visualPluginFilter","nonPersonalVisualizationPaneFilter","showNonPersonalVisuals",4,"ngIf"],["class","pane-content","role","tabpanel","section-animation-slider","",3,"id",4,"ngIf"],[1,"pane-content",3,"disableScrollbar","showVisualTypes","showFieldWell","showDrillthroughPane","showFieldWellOrFilters","populatePanes","visualPluginFilter","nonPersonalVisualizationPaneFilter","showNonPersonalVisuals"],["role","tabpanel","section-animation-slider","",1,"pane-content",3,"id"],["data-testid","formatting-pane-lazy",3,"formattingSources","disableScrollbar"]],template:function(i,r){1&i&&(t.\u0275\u0275template(0,lo,5,14,"div",0),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"div",1)),2&i&&(t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,2,r.viewModelStore$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("pbiEmphasisOpacity",r.emphasize$))},dependencies:[P.NgForOf,P.NgIf,Jt.R,Wr.H,Ur.u,Qi.q,$r.I,Gr.J,Hr.O,Xr,Xi.VO,Zr.P,Zi.i,zi.R,rt.V,$i,P.AsyncPipe,je.F],styles:['[_nghost-%COMP%]{display:flex;height:100%}.emphasis-border[_ngcontent-%COMP%]{border:1px solid var(--globalColorBrand80);position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;opacity:0;pointer-events:none}.visualization-pane[_ngcontent-%COMP%]{--viz-pane-selected-button-background: var(--gray-50, #D2D0CE);--viz-pane-button-hover-background: var(--gray-40, #E1DFDD);--viz-pane-button-hover-outline-color: var(--gray-110, #8A8886);--viz-pane-selected-svg-line-color: var(--gray-110, #8A8886);--viz-pane-selected-line-color: var(--gray-70, #BEBBB8);--icon-fill-color: var(--theme-primary-color);--icon-stroke-color: #252423;overflow:hidden;flex-grow:1}  [data-legacy-theming=false] .visualization-pane{--viz-pane-selected-button-background: var(--colorNeutralBackground1);--viz-pane-button-hover-background: var(--colorNeutralBackground1Hover);--viz-pane-button-hover-outline-color: var(--colorNeutralStroke1Hover);--viz-pane-selected-svg-line-color: var(--colorNeutralStroke1);--viz-pane-selected-line-color: var(--colorNeutralStroke1);--icon-fill-color: var(--colorCompoundBrandStroke);--icon-stroke-color: var(--colorNeutralStrokeAccessible)}.visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-ms-user-select:none;user-select:none}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-right:8px}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]{display:flex;padding:4px 0}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{cursor:pointer;border-radius:2px;border:none;padding:4px}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .normal-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .styled-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]{background:var(--viz-pane-selected-button-background)}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]   .normal-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]   .styled-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover{outline:var(--focus-outline-definition, 2.5px solid) var(--viz-pane-button-hover-outline-color);background:var(--viz-pane-button-hover-background)}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover   .normal-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover   .styled-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:focus{outline:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:24px;width:24px;display:flex;justify-content:center}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{flex:none}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{margin-right:34px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{margin-left:34px}html[data-focus-source="key"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:focus-within   .content[_ngcontent-%COMP%], html[data-focus-source="key"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:focus-within   .content[_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child, html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child, html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child{margin-right:8px}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child, html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child{margin-right:0}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child, html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child{margin-left:0}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]{display:block;padding-bottom:4px}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]{display:flex;width:100%}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .select-indicator-bar[_ngcontent-%COMP%]{flex:none}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .select-indicator-bar[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{stroke:var(--viz-pane-selected-svg-line-color)}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]{height:9px;display:flex;flex-direction:column;flex-grow:1}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]   .space[_ngcontent-%COMP%]{height:8px}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{height:1px;background:var(--viz-pane-selected-line-color)}.visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%], .visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%]   .pane-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%]   .pane-content[_ngcontent-%COMP%]   formatting-pane-lazy[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.visualization-pane[_ngcontent-%COMP%]   .paneScrollable[_ngcontent-%COMP%]{height:"100%"}.visualization-pane[_ngcontent-%COMP%]   .paneNotScrollable[_ngcontent-%COMP%]{height:unset}']}),n}(k.w),uo=l(49080),po=l(17966),vo=l(19276),ge=l(49702),Re=l(23306),pn=l(35497),go={provide:"bookmarkAuthoringService",useFactory:function(o,n,e,i,r,a,s,c,u,d,g){return new fo(o,n,e,i,r,s,c,u,a,d,g)},deps:[po.F,Y.i,ce.D,ne.J,vo.j,uo.J,se.o,Lt.g,fe.z,ve.y0,pt.z]},fo=function(){function o(n,e,i,r,a,s,c,u,d,g,v){this.bookmarkService=n,this.conceptualSchemaProxy=e,this.dataSources=i,this.eventBridge=r,this.explorationStateApplier=a,this.localizationService=s,this.screenReaderService=c,this.selection=u,this.stateManager=d,this.telemetryService=g,this.undoRedoService=v}return o.prototype.create=function(n,e,i,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,s,c,u,d,g;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return a=f.sent(),e?[3,3]:(s={captureAllSections:!1,suppressDataSourceVariables:!0,capturePresentation:!1},_.assign(s,r),[4,this.stateManager.capture(a,s)]);case 2:e=f.sent(),f.label=3;case 3:return c=this.bookmarkService.getBookmarks(),u=c?c.length+1:1,d=n||this.localizationService.get("Generic_Bookmark")+" ".concat(u),g=this.generateBookmarkName(),i||(i=this.updateTargetVisualsOptions({})),[2,{displayName:d,name:g,explorationState:e,options:i}]}})})},o.prototype.add=function(n,e,i,r){return void 0===r&&(r=!0),(0,p.__awaiter)(this,void 0,void 0,function(){var a,s,c=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return[4,this.create(n,e,i)];case 1:return a=u.sent(),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 2:return s=u.sent(),this.undoRedoService.register(ge.U.Add,function(){c.bookmarkService.setBookmarks((0,Re.IH)(c.bookmarkService.getBookmarks(),a)),r&&(c.bookmarkService.setActiveBookmark(a),e&&c.applyBookmarkState(a,s)),c.telemetryService.logEvent(Je.Dbt)}),this.screenReaderService.alertPolite(this.localizationService.format("CreatedItem",a.displayName)),[2,a]}})})},o.prototype.remove=function(n){var e=this,i=this.getBookmark(n);D.fF.assert(function(){return ge.J.isValidBookmark(i)},"Invalid bookmark"),this.undoRedoService.register(ge.U.Remove,function(){var r=(0,Re.Od)(i,e.bookmarkService.getBookmarks());e.bookmarkService.setBookmarks(r);var a=e.bookmarkService.getActiveBookmark();a&&i.name===a.name&&e.bookmarkService.setActiveBookmark(null),e.telemetryService.logEvent(Je.FQA)})},o.prototype.move=function(n,e,i,r){var a=this;void 0===i&&(i=!1),"number"==typeof n&&"number"==typeof e&&(i=n<e);var s=this.getBookmark(n),c=this.getBookmark(e);D.fF.assert(function(){return ge.J.isValidBookmark(s)},"Invalid source bookmark"),D.fF.assert(function(){return ge.J.isValidBookmark(c)},"Invalid target bookmark"),this.undoRedoService.register(ge.U.Move,function(){a.bookmarkService.setBookmarks((0,Re.pB)([s],c,a.bookmarkService.getBookmarks(),i))})},o.prototype.rename=function(n,e){var i=this,r=this.getBookmark(n);D.fF.assert(function(){return ge.J.isValidBookmark(r)},"Invalid bookmark"),D.fF.assert(function(){return!_.isEmpty(e)},"Bookmark name can't be empty"),this.undoRedoService.register(ge.U.Rename,function(){r.displayName=e,i.bookmarkService.emitUpdatedBookmarks()})},o.prototype.update=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r,a=this;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return e=this.getBookmark(n),D.fF.assert(function(){return ge.J.isValidBookmark(e)},"Invalid bookmark"),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return i=s.sent(),[4,this.stateManager.capture(i,{captureAllSections:!1})];case 2:return r=s.sent(),this.undoRedoService.register(ge.U.Update,function(){a.bookmarkService.setActiveBookmark(e),e.explorationState=r,e.options=a.updateTargetVisualsOptions(e.options),a.telemetryService.logEvent(Je.m_M)}),[2]}})})},o.prototype.ungroup=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return D.fF.assert(function(){return ge.J.isValidBookmark(n)},"Invalid bookmark"),[4,this.undoRedoService.register(ge.U.Ungroup,function(){e.bookmarkService.setBookmarks((0,Re.Z8)(n,e.bookmarkService.getBookmarks()))})];case 1:return i.sent(),[2]}})})},o.prototype.group=function(n){var e=this;D.fF.assert(function(){return!_.isEmpty(n)},"Bookmarks to group should not be empty");var i=this.createBookmarkGroup(n);this.undoRedoService.register(ge.U.Group,function(){e.bookmarkService.setBookmarks((0,Re.ru)(i,e.bookmarkService.getBookmarks()))})},o.prototype.getBookmark=function(n){return"number"==typeof n?this.bookmarkService.getBookmarks()[n]:n},o.prototype.generateBookmarkName=function(){var n={};return _.each(this.bookmarkService.getBookmarks(),function(e){n[e.name]=!0}),pn.q.generateUniqueId(n)},o.prototype.createBookmarkGroup=function(n){var e=_.filter(this.bookmarkService.getBookmarks(),function(c){return ge.J.isBookmarkGroup(c)}),i=e?e.length+1:1;return{displayName:this.localizationService.get("Group")+" ".concat(i),name:this.generateBookmarkName(),children:n}},o.prototype.updateTargetVisualsOptions=function(n){n||(n={});for(var e=me.UP.getSelectedCanvasItems(this.selection),i=[],r=[],a=0,s=e;a<s.length;a++){var c=s[a];i.push(c.name),(0,ye.q4)(c)&&r.push(c)}return _.isEmpty(r)||(0,ye.Iw)(r,function(u){return i.push(u.name)}),n.targetVisualNames=_.uniq(i),n},o.prototype.applyBookmarkState=function(n,e,i){D.fF.assertValue(n,"bookmark");var r={clearUnmatchedData:!0,suppressDataSourceVariables:!0};if(_.assign(r,i),!ge.J.isBookmarkGroup(n)){var a=this.explorationStateApplier.createApplyBookmarkActivity("AddReportBookmark");try{n.options&&(r.suppressData=n.options.suppressData,r.suppressActiveSection=n.options.suppressActiveSection,r.suppressDisplay=n.options.suppressDisplay,n.options.applyOnlyToTargetVisuals&&(r.targetVisualNames=n.options.targetVisualNames));var s=this.applyState(a,n.explorationState,e,r);return this.eventBridge.publishToChannel(I.gG5,{bookmarkName:n.name}),this.telemetryService.logEvent(Je.LPp,{bookmarkName:n.name}),a.resolve(),s}catch(c){a.reject(c)}}},o.prototype.applyState=function(n,e,i,r){return this.explorationStateApplier.applyDirty(e,i,r,n)},o}(),ui=l(40033),gt=l(80),bo={provide:"canvasListOrderingService",useFactory:function(o,n,e,i){return new Promise(function(r){r(new Po(o,n,e,i))})},deps:[ui.F,pe.$8,vt.Q,Nt.F]},Po=function(){function o(n,e,i,r){this.canvasListOrderNormalizeService=n,this.visualAuthoring=e,this.visualAuthoringOperations=i,this.formFactor=r}return o.prototype.getListOrderPropertyFunction=function(n,e){var i=this.formFactor.getCurrentLayout();return n.layouts.withId(i).position[e]},o.prototype.insertAtMinMagnitude=function(n,e,i,r,a,s){var c=this;if(!_.isEmpty(e)){var u=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(v){return c.getListOrderPropertyFunction(v,r)});this.insertAtMinMagnitudeInternal(e,u,i,r,a,s);var d=_.concat(n,e);if(u=this.canvasListOrderNormalizeService.getContainerListOrders(d,function(v){return c.getListOrderPropertyFunction(v,r)}),this.canvasListOrderNormalizeService.shouldNormalizeListOrder(u,i)){var g=this.canvasListOrderNormalizeService.normalizeListOrder(u,i);a?this.visualAuthoringOperations.updateContainerListOrders(d,g,r):this.visualAuthoring.updateContainerListOrders(d,g,r)}}},o.prototype.insertAtMinMagnitudeInternal=function(n,e,i,r,a,s){var v,c=this,u=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(y){return c.getListOrderPropertyFunction(y,r)}),d=this.canvasListOrderNormalizeService.getSortedContainerNames(u,s?!i:i),g=this.canvasListOrderNormalizeService.getSortedContainerNames(e,i);v=g.length?e[_.head(g)]:i?gt.RT:gt.Wp;var f=this.convertsMagnitude(gt.oZ,!i),m={};this.canvasListOrderNormalizeService.settingListOrder(m,d,v+=f,f),a?this.visualAuthoringOperations.updateContainerListOrders(n,m,r):this.visualAuthoring.updateContainerListOrders(n,m,r)},o.prototype.convertsMagnitude=function(n,e){return e?n:-n},o.prototype.bringToFront=function(n,e,i,r,a){var s=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(d){return s.getListOrderPropertyFunction(d,r)});this.moveAfterIndexInternal(n,n.length-1,c,e,i,r,a)}},o.prototype.bringForward=function(n,e,i,r,a){var s=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return s.getListOrderPropertyFunction(u,r)});this.groupSequentialContainers(n,e,c,function(u,d,g){var v=g+1;return _.map(u,function(f){return{afterContainerIndex:v,containerName:f}})},i,r,a)}},o.prototype.sendToBack=function(n,e,i,r,a){var s=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return s.getListOrderPropertyFunction(u,r)});this.moveBeforeIndexInternal(n,0,c,e,i,r,a)}},o.prototype.sendBackward=function(n,e,i,r,a){var s=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return s.getListOrderPropertyFunction(u,r)});this.groupSequentialContainers(n,e,c,function(u,d,g){var v=d-1;return _.map(u,function(f){return{beforeContainerIndex:v,containerName:f}})},i,r,a)}},o.prototype.moveAfter=function(n,e,i,r,a){var s=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return s.getListOrderPropertyFunction(g,a)}),u=this.findContainerIndex(e,c,r),d=_.union(n,i);this.moveAfterIndexInternal(d,u,c,i,r,a)}},o.prototype.moveAfterIndex=function(n,e,i,r,a){var s=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return s.getListOrderPropertyFunction(u,a)});this.moveAfterIndexInternal(n,e,c,i,r,a)}},o.prototype.shouldNormalize=function(n,e,i){var r=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return r.getListOrderPropertyFunction(g,i)}),s=this.canvasListOrderNormalizeService.shouldNormalizeListOrder(a,e);if(!s)for(var c=0,u=n;c<u.length;c++){var d=u[c];if((0,ye.q4)(d)&&(s=this.shouldNormalize(d.children,e,i)))break}return s},o.prototype.normalize=function(n,e,i){var r=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return r.getListOrderPropertyFunction(g,i)}),s=this.canvasListOrderNormalizeService.normalizeListOrder(a,e);this.visualAuthoringOperations.updateContainerListOrders(n,s,i);for(var c=0,u=n;c<u.length;c++){var d=u[c];(0,ye.q4)(d)&&this.normalize(d.children,e,i)}},o.prototype.moveAfterIndexInternal=function(n,e,i,r,a,s,c){var u=this.buildOperations(r,i,a,function(d){return{containerName:d.name,afterContainerIndex:e}});this.movecanvasItems(n,u,i,a,s,c)},o.prototype.moveBefore=function(n,e,i,r,a){var s=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return s.getListOrderPropertyFunction(g,a)}),u=this.findContainerIndex(e,c,r),d=_.union(n,i);this.moveBeforeIndexInternal(d,u,c,i,r,a)}},o.prototype.moveBeforeIndex=function(n,e,i,r,a){var s=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return s.getListOrderPropertyFunction(u,a)});this.moveBeforeIndexInternal(n,e,c,i,r,a)}},o.prototype.moveBeforeIndexInternal=function(n,e,i,r,a,s,c){var u=this.buildOperations(r,i,a,function(d){return{containerName:d.name,beforeContainerIndex:e}});this.movecanvasItems(n,u,i,a,s,c)},o.prototype.findContainerIndex=function(n,e,i){var r=this.canvasListOrderNormalizeService.getSortedContainerNames(e,i);return _.findIndex(r,function(a){return a===n.name})},o.prototype.movecanvasItems=function(n,e,i,r,a,s){for(var c=this.canvasListOrderNormalizeService.getSortedContainerNames(i,r),u=[],d={},g={},v=gt.oZ,f=function(w){var E=w.containerName;D.fF.assert(function(){return!d[E]},"VisualContainer is used in multiple operations");var G=void 0,te=void 0,ee=void 0;!function(o){return null!=o.afterContainerIndex}(w)?function(o){return null!=o.beforeContainerIndex}(w)?(G=(te=Math.max(w.beforeContainerIndex,0))-1,ee=m.convertsMagnitude(v,!r)):D.fF.assertFail("Unknown operation type"):(te=(G=Math.min(w.afterContainerIndex,c.length-1))+1,ee=m.convertsMagnitude(v,r));var le=m.getAfterContainerListOrderPropertyNumber(u,c,i,G),ue=m.getBeforeContainerListOrderPropertyNumber(c,i,te),re=null!=le,Ce=null!=ue;(!re||!Ce)&&(!re&&Ce?le=ue+ee:re&&!Ce?ue=le+ee:D.fF.assertFail("Could not find afterListOrderNumber and beforeListOrderNumber"));var N=(ue+le)/2;D.fF.assert(function(){return r?le<N:N<le},"afterListOrderNumber is not less than insertionListOrderNumber if range is positive, insertionListOrderNumber is not less than afterListOrderNumber if range is negative"),D.fF.assert(function(){return r?ue>N:N>ue},"beforeListOrderNumber is not greater than insertionListOrderNumber if range is positive, insertionListOrderNumber is not greater than beforePrderNumber if range is negative"),u[G]=N,g[E]=N},m=this,y=0,x=e;y<x.length;y++)f(x[y]);var B=_.extend({},i,g);this.canvasListOrderNormalizeService.shouldNormalizeListOrder(B,r)&&(B=this.canvasListOrderNormalizeService.normalizeListOrder(B,r)),s?this.visualAuthoringOperations.updateContainerListOrders(n,B,a):this.visualAuthoring.updateContainerListOrders(n,B,a)},o.prototype.getAfterContainerListOrderPropertyNumber=function(n,e,i,r){var a=n[r];if(null==a){var s=e[r];s&&(a=i[s])}return a},o.prototype.getBeforeContainerListOrderPropertyNumber=function(n,e,i){return e[n[i]]},o.prototype.groupSequentialContainers=function(n,e,i,r,a,s,c){for(var x,u=this,d=this.canvasListOrderNormalizeService.getSortedContainerNames(i,a),g=_.zipObject(_.map(e,function(w){return w.name}),_.map(e,function(){return!0})),v=e.length,f=0,m=0,y=0,C=0;C<d.length;C++){var B=d[C];if(g[B]){if(x?x.push(B):(x=[B],m=C),++f===v){y=C;break}}else if(x){var M=r(x,m,y=C-1);this.movecanvasItems(n,M,i,a,s),i=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(w){return u.getListOrderPropertyFunction(w,s)}),x=null}}x&&(M=r(x,m,y),this.movecanvasItems(n,M,i,a,s,c))},o.prototype.buildOperations=function(n,e,i,r){var a=i?"asc":"desc";return _.chain(n).map(r).orderBy(function(s){return e[s.containerName]},a).value()},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275inject(ui.F),t.\u0275\u0275inject(pe.$8),t.\u0275\u0275inject(vt.Q),t.\u0275\u0275inject(Nt.F))},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),vn=l(26902),So=l(25740),gn=l(58938),xo={provide:"dataBarsDialogLauncherService",useFactory:function(o,n,e,i){return new Mo(o,n,e,i)},deps:[gn.x,se.o,ve.y0,pe.$8]},Mo=function(){function o(n,e,i,r){this.dialogService=n,this.localizationService=e,this.telemetryService=i,this.visualAuthoring=r}return o.prototype.show=function(n,e,i,r,a,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var c,u,d,g,f,m=this;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return c=(0,vn.aI)(n.config.singleVisual,i),u={dataBarsSettings:c,colorPalette:(0,So.NO)(r)},d=this.localizationService.get("Visual_ConditionalFormatting_DataBars"),g={title:"".concat(d," - ").concat(e),input:u,hideOkButton:!1,hideCancelButton:!1},[4,this.dialogService.showTemplateDialog("DataBarsDialog",g,{height:"668px",width:"426px"})];case 1:return(f=y.sent()).afterClosed().subscribe(function(x){x&&m.setDataBars(x.dataBars,n,i,a,s)}),[2,f]}})})},o.prototype.setDataBars=function(n,e,i,r,a){var s=(0,vn.ac)(n,r);this.visualAuthoring.addDataBars(e,i,s),this.telemetryService.logEvent(Je.QBi,{visualType:(0,R.s)(e),userValueSpecified:void 0!==n.minValue||void 0!==n.maxValue,fromPropertyPane:a,visualName:e.name})},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275inject(gn.x),t.\u0275\u0275inject(se.o),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8))},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),hn=l(52298),fn=l(57871),xe=l(78417),Oo=l(83400),wo=l(71216),jt=l(43286),Fo={provide:"explorationAuthoring",useFactory:function(o,n,e,i,r,a,s,c,u,d){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(g){return[2,new Vo(o,n,e,i,r,a,s,c,u,d)]})})},deps:[ne.J,oi.Z,q.z,ai.L,ae.vZ,hn.e,se.o,we.t,ve.y0,pt.z]},Vo=function(){function o(n,e,i,r,a,s,c,u,d,g){this.eventBridge=n,this.explorationNavigation=i,this.featureSwitchService=a,this.linguisticSchemaProxy=s,this.promiseFactory=u,this.undoRedo=g,this.explorationAuthoringOps=new Do(e,i,r,c,d)}return o.prototype.renameSection=function(n,e,i){var r=this,a=n.exploration.contract,s=a.sections[i].name;this.undoRedo.register("RenameNavigationTab",function(){r.explorationAuthoringOps.renameSection(n,e,i),(0,xe.D6)(a,s,e,r.linguisticSchemaProxy,!1).then(function(){r.eventBridge.publishToChannel(I.TTT,{sectionName:e,sectionIndex:i})})})},o.prototype.createSection=function(n,e,i,r,a){var s=this;this.undoRedo.register("CreateSection",function(){s.explorationAuthoringOps.createSection(n,e,i,r,a)})},o.prototype.duplicateSection=function(n,e){var i=this;this.undoRedo.register("DuplicateSection",function(){var r=i.explorationAuthoringOps.duplicateSection(n,e);(0,xe.bx)(n.exploration.contract,r,e,i.linguisticSchemaProxy,i.promiseFactory).then(function(){i.explorationAuthoringOps.insertSection(n,r)})})},o.prototype.deleteSection=function(n,e,i){var r=this,a=function(){var c=n.exploration.contract;(0,xe.Og)(c,c.sections[e].name,r.linguisticSchemaProxy).then(function(){r.explorationAuthoringOps.deleteSection(n,e),r.eventBridge.publishToChannel(I.HGU,{sectionIndex:e})})};i?this.undoRedo.register("DeleteSection",function(){a()}):a()},o.prototype.insertSection=function(n,e){var i=this;this.undoRedo.register("InsertSection",function(){i.explorationAuthoringOps.insertSection(n,e)})},o.prototype.setSectionVisibility=function(n,e){var i=this;this.undoRedo.register("SetSectionVisibility",function(){i.explorationAuthoringOps.setSectionVisibility(n,e)})},o.prototype.reorderSection=function(n,e,i){var r=this;this.undoRedo.register("ReorderSection",function(){r.explorationAuthoringOps.reorderSection(n,e,i)})},o.prototype.setSectionType=function(n,e,i,r){var a=this,s=function(){0===i?a.explorationAuthoringOps.clearSectionType(e,~i):a.explorationAuthoringOps.setSectionType(e,i),(0,xe.TJ)(n,e.name,(0,xe.wj)(e,a.featureSwitchService.featureSwitches.onObject))};r?s():this.undoRedo.register("SetSectionType",s)},o.prototype.clearSectionType=function(n,e,i){var r=this;0!==i?this.undoRedo.register("ClearSectionType",function(){r.explorationAuthoringOps.clearSectionType(e,i),(0,xe.TJ)(n,e.name,(0,xe.wj)(e,r.featureSwitchService.featureSwitches.onObject))}):D.fF.assertFail('Can not clear a "Regular" default section state')},o.prototype.setDrillthroughFilterPassingMode=function(n,e,i){var r=this;this.undoRedo.register("setDrillthroughFilterPassingMode",function(){r.explorationAuthoringOps.setDrillthroughFilterPassingMode(n,e,i)})},o.prototype.setCrossReportDrillthrough=function(n,e,i,r){var a=this;void 0===r&&(r=!0),r?this.undoRedo.register("setCrossReportDrillthrough",function(){a.explorationAuthoringOps.setCrossReportDrillthrough(n,e,i)}):this.explorationAuthoringOps.setCrossReportDrillthrough(n,e,i)},o.prototype.setDataSourceVariables=function(n,e){var i=this;void 0===e&&(e=this.explorationNavigation.getCurrentExploration()),D.fF.assertValue(e,"contract"),this.undoRedo.register("setDataSourceVariables",function(){i.explorationAuthoringOps.setDataSourceVariables(e,n),i.eventBridge.publishToChannel(I.jCS,{affectContainer:_.stubTrue})})},o.prototype.setCanvasDisplay=function(n){this.eventBridge.publishToChannel(I.Pkb,n)},(0,p.__decorate)([(0,p.__param)(7,(0,t.Inject)(we.t)),(0,p.__metadata)("design:paramtypes",[ne.J,oi.Z,q.z,ai.L,ae.vZ,hn.e,se.o,Object,ve.y0,pt.z])],o)}(),Do=function(){function o(n,e,i,r,a){this.explorationActivity=n,this.explorationNavigation=e,this.explorationSerializer=i,this.localization=r,this.telemetryService=a}return o.prototype.renameSection=function(n,e,i){var r=n.exploration;r.contract.sections[i].displayName=e;var a=r.sections;a[i].displayName=e,a[i].isTabEditable=!1,this.explorationNavigation.emitUpdatedSections()},o.prototype.duplicateSection=function(n,e){var i=n.exploration.contract;D.fF.assert(function(){return e<=i.sections.length},"Expected target index should be less than or equals sections length.");var r=this.explorationSerializer.serializePage(i.sections[e],1),a=this.explorationSerializer.deserializePage(r,{enableVisualContainerGrouping:i.settings&&i.settings.useStylableVisualContainerHeader});return a.name=mn(i),(0,Oo.gs)(a,n.exploration.contract.sections),a.displayName=this.localization.format("DuplicateSectionName_StartingText",[a.displayName]),a},o.prototype.insertSection=function(n,e){var i=this;this.explorationActivity.doRootActivity(function(r){e.id=void 0,e.objectId=void 0;var s=n.exploration.contract.sections;s.push(e),n.exploration.sections.push((0,U.Iu)(e,i.localization));var u=s.length-1;i.explorationNavigation.updateActiveSection({targetSectionIndex:u,forceUpdate:n.sectionStatus.currentSectionNumber===u,parentActivity:r}),i.explorationNavigation.emitUpdatedSections()},function(){return i.telemetryService.startChildActivity(void 0,Ae.$0)})},o.prototype.deleteSection=function(n,e){var i=this;this.explorationActivity.doRootActivity(function(r){var a=n.exploration.contract;if(e>-1&&a&&e<a.sections.length){var s=a.sections[e];a.sections.splice(e,1);var c=n.exploration.sections,u=c[e];u&&u.contract===s&&c.splice(e,1);var d=n.sectionStatus.currentSectionNumber;if(d===e){var g=e;g>=a.sections.length&&(g=a.sections.length-1),i.explorationNavigation.updateActiveSection({targetSectionIndex:g,forceUpdate:d===g,suppressHistory:!0,parentActivity:r})}else{var f=e>d?d:d-1;n.sectionStatus.currentSectionNumber=f,a.activeSectionIndex=f}}i.explorationNavigation.emitUpdatedSections()},function(){return i.telemetryService.startChildActivity(void 0,Ae.yw)})},o.prototype.createSection=function(n,e,i,r,a){var s=n.exploration.contract;i||(i={displayOption:1,width:fn.$z,height:fn.az});var c={name:mn(s),displayName:a||(0,wo.Vk)(s.sections,this.localization),size:i,objects:r,visualContainers:[],visualContainerGroups:[],filters:[],acceptsAllFiltersWhenLinked:void 0,howCreated:e??"Default",isNew:!0};this.insertSection(n,c),this.explorationNavigation.emitUpdatedSections()},o.prototype.reorderSection=function(n,e,i){if(e<0||i<0)return!1;var r=!1,a=n.exploration.contract.sections,s=a[e];a.splice(e,1),a.splice(i,0,s);var c=n.exploration.sections,u=c[e];u&&u.contract===s&&(c.splice(e,1),c.splice(i,0,u),r=!0);for(var d=c.length-1;d>=0;--d)if(c[d].selected){n.sectionStatus.currentSectionNumber=d;break}return this.explorationNavigation.emitUpdatedSections(),r},o.prototype.setSectionVisibility=function(n,e){n.visibility=e,this.explorationNavigation.emitUpdatedSections()},o.prototype.setSectionType=function(n,e){D.fF.assert(function(){return!((0,jt.yE)(e,2)&&(0,jt.yE)(e,1))},"Tooltip and Drillthrough types cannot co-exist!"),(0,jt.yE)(e,2)&&this.clearSectionType(n,1),(0,jt.yE)(e,1)&&this.clearSectionType(n,2),n.type|=e,this.explorationNavigation.emitUpdatedSections()},o.prototype.clearSectionType=function(n,e){n.type&=~e,this.explorationNavigation.emitUpdatedSections()},o.prototype.setDrillthroughFilterPassingMode=function(n,e,i){(0,xe.rF)(n,e.name,(0,xe.Js)(i))},o.prototype.setCrossReportDrillthrough=function(n,e,i){(0,xe.kt)(n,e.name,(0,xe.zO)(i))},o.prototype.setDataSourceVariables=function(n,e){n.dataSourceVariables=e},o}();function mn(o){var n=_.map(o.sections,function(i){return i.name}),e=_.zipObject(n,_.map(n,function(){return!0}));return pn.q.generateUniqueId(e)}var To=l(49092),Ao=l(88565),Io=l(77435),Bo=l(93658),ko=l(28107),zo=l(33163),Lo=function(){function o(){}return o.prototype.exportToExcel=function(n,e){D.fF.assertValue(n,"exportToExcelRequest"),D.fF.assertValue(e,"requestOptions"),D.fF.assertFail("ExportToExcelProxy code path should only be through webExploration")},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac=function(e){return new(e||o)},providedIn:"root"}),o}(),No=l(73875),Ro=l(82755),yn=l(28326),Wt=l(80777),di='"',pi=",",jo="yyyy-MM-dd HH:mm:ss",Wo="'";function Uo(o,n,e){var i,r=o.table;if(!r)return"";var a=r.columns;D.fF.assertValue(a,"columns metadata is null");var s="",c=0;(null==e||e>r.rows.length)&&(e=r.rows.length);for(var u=0;u<e;u++){var d=r.rows[u],g=[];d.length>c&&(c=d.length);for(var v=0,f=d.length;v<f;v++){var m=a[v],y=m&&m.type,x=(0,Ro.NA)(null===(i=d.objects)||void 0===i?void 0:i[v],n);g.push(Go(d[v],y,x||m&&m.format))}g.length>0&&(s+=g.join(pi)+"\r\n")}return s=function(o,n){(n<=0||n>o.length)&&(n=o.length);for(var e=[],i=0;i<n;i++)e.push(Cn(o[i].displayName));return e.join(pi)}(a,c)+"\r\n"+s,s}function Go(o,n,e){return null==o?"":(n||(n=function(o){return D.fF.assertValue(o,"value"),_.isDate(o)?Wt.Ge.fromPrimitiveTypeAndCategory(6):_.isBoolean(o)?Wt.Ge.fromPrimitiveTypeAndCategory(5):_.isNumber(o)?Wt.Ge.fromPrimitiveTypeAndCategory(3):Wt.Ge.fromPrimitiveTypeAndCategory(1)}(o)),Cn(n.dateTime?yn.dx.formatValue(o,jo):n.bool||n.numeric&&!e?o.toString():n.numeric?yn.dx.formatValue(o,function(o){return D.fF.assertValue(o,"format"),o.replace(/(\r\n|\n|\r|,)/g,"")}(e)):function(o){return("="===o.charAt(0)||"-"===o.charAt(0)||"+"===o.charAt(0)||"@"===o.charAt(0))&&(o=Wo.concat(o)),o}(o.toString())))}function Cn(o){return null==o?"":(o=o.replace(/\"/g,'""'),_.includes(o,"\n")||_.includes(o,di)||_.includes(o,pi)||_.includes(o,"\r")||0===o.length?di+o+di:o)}var bn=l(42220),Xo=l(74593),Zo=l(48706),Jo=l(13479),Pn=l(74804),Sn=l(29169),Yo=l(11077),vi=l(89522),Ye=l(94853),_n=l(53497),qo=l(16699),ea=l(14599),ta=l(48708),xn=l(38078),Ut=l(71813),ia=l(39317),na=l(25992),ra=l(5361),oa=l(8679),aa={provide:"exportVisualData",useFactory:function(o,n,e,i,r,a,s,c,u,d,g,v,f,m,y){var x=(0,Yt.Vz)(o,a,r,s,y,c),C=m.create();return new ua(x,o,n,e,i,c,u,d,s,g,v,f,y,C)},deps:[he.D,Ao.S,To.d,Y.i,lt.C,Io.q,ae.vZ,Ue.O,se.o,oa.z,Lo,No.O,vt.Q,Bo.P,ko.Q]},$t=1e6,ua=function(){function o(n,e,i,r,a,s,c,u,d,g,v,f,m,y){this.visualAuthoringCore=n,this.visualPluginService=e,this.visualQueryGenerator=i,this.dataProxy=r,this.conceptualSchemaProxy=a,this.displayNameService=s,this.localizationService=c,this.localeProviderService=u,this.featureSwitchService=d,this.exportToExcelProxy=g,this.httpService=v,this.visualAuthoringOperations=f,this.visualAuthoringCustomizeOperations=m,this.visualParameterService=y,D.fF.assertValue(n,"visualAuthoring"),D.fF.assertValue(e,"visualPluginService"),D.fF.assertValue(i,"visualQueryGenerator"),D.fF.assertValue(r,"dataProxy"),D.fF.assertValue(a,"conceptualSchemaProxy"),D.fF.assertValue(s,"displayNameService"),D.fF.assertValue(c,"localizationService"),D.fF.assertValue(u,"localeProviderService"),D.fF.assertValue(f,"visualAuthoringOperations")}return o.prototype.exportToCsv=function(n,e,i,r,a,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var c,u,d,g,v,f,m,y,x,B=this;return(0,p.__generator)(this,function(M){switch(M.label){case 0:return D.fF.assertAnyValue(n,"visualTitle"),D.fF.assertAnyValue(e,"visualData"),D.fF.assertValue(i,"dataSources"),D.fF.assertValue(r,"visualContainer"),D.fF.assertAnyValue(a,"additionalFilters"),u=(c=e&&e.data)&&c.dataViewSource,c&&(d=c.isFirstSegment),g=e&&e.dataTransforms,null==i||null==g||null==u||(0,vi.e6)(r)?[3,2]:[4,this.exportDataViewSourceToCSV(u,g,null!=s,n,this.featureSwitchService.featureSwitches,d,s)];case 1:if(null!=(v=M.sent()))return[2,Promise.resolve(v)];M.label=2;case 2:return[4,this.getConceptualSchema(i)];case 3:return f=M.sent(),[4,this.getGeneratedQuery(f,r,i,a,g?.selects)];case 4:return(m=M.sent())&&m.result&&!m.result.error?(this.overrideDataReduction((y=m.result).options.query.command,s=s??$t,!1),y&&y.options&&y.options.query&&(y.options.query.cacheResponseOnClient=!1),x=y.transforms,[2,this.queryData(y.options,function(E){return B.exportDataViewSourceToCSV(E,x,!0,n,B.featureSwitchService.featureSwitches,void 0,s)})]):[2,Promise.resolve({blob:null,errorDetails:{errorType:0}})]}})})},o.prototype.getConceptualSchema=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(n)];case 1:return e=r.sent(),[3,3];case 2:return r.sent(),[2,Promise.reject({blob:null,errorDetails:{errorType:3}})];case 3:return[2,e]}})})},o.prototype.exportToExcel=function(n,e,i,r,a,s,c,u){var d;return(0,p.__awaiter)(this,void 0,void 0,function(){var g,v,m,y,x,C,M,w,E,G,te,ee,le,ue=this;return(0,p.__generator)(this,function(re){switch(re.label){case 0:return D.fF.assertAnyValue(n,"visualTitle"),D.fF.assertValue(i,"dataSources"),D.fF.assertValue(r,"visualContainer"),D.fF.assertAnyValue(a,"additionalFilters"),D.fF.assertAnyValue(s,"filtersDescription"),D.fF.assertAnyValue(c,"exportType"),[4,this.getConceptualSchema(i)];case 1:return g=re.sent(),2!==c?[3,2]:(v=this.getGeneratedQueryMatrixDataLayout(g,r,i,a),[3,4]);case 2:return[4,this.getGeneratedQuery(g,r,i,a,null===(d=e?.dataTransforms)||void 0===d?void 0:d.selects)];case 3:v=re.sent(),re.label=4;case 4:return v&&v.result&&!v.result.error?(y=(m=v.result).options.query.command,x=r.config.singleVisual,D.fF.assert(function(){return!_.isEmpty(y.Commands)},"query command should contains Commands"),D.fF.assertValue(y.Commands[0].SemanticQueryDataShapeCommand,"The first command must be a SemanticQuery command"),2===c?(C=this.generateExportVisualLayoutDataCommand(g,y.Commands[0].SemanticQueryDataShapeCommand.Query,x,m.transforms,s),y.Commands.push(C),this.overrideDataReduction(y,$t,this.featureSwitchService.featureSwitches.useWindowWhenExporting)):(M=this.generateExportDataCommand(g,y.Commands[0].SemanticQueryDataShapeCommand.Query,s,x,m.transforms,v.selectsWithDisplayName),y.Commands.push(M),this.clearDataQuerySubtotal(y),3===c&&this.setConnectedExportRowLimit(r.config.singleVisual.query,y.Commands[0].SemanticQueryDataShapeCommand.Query),this.overrideDataReduction(y,$t,!1)),(w=this.httpService.powerbiRequestOptions()).responseType="blob",w.retryCount=0,E=(0,Jo.xV)([y],(0,Pn.kB)((0,Pn.$$)(i,x.query&&x.query.defn))),G=(0,bn.u5)(E,this.localeProviderService),3===c&&(0,bn.K4)(G)?[2,Promise.reject({blob:null,errorDetails:{errorType:7}})]:(te={exportDataType:c,executeSemanticQueryRequest:G,artifactId:u},ee=1,[2,(le=function(){return(0,p.__awaiter)(ue,void 0,void 0,function(){var N,Oe,qe,Gt,et;return(0,p.__generator)(this,function(tt){switch(tt.label){case 0:return tt.trys.push([0,2,,3]),[4,this.exportToExcelProxy.exportToExcel(te,w)];case 1:return N=tt.sent(),[3,3];case 2:return Oe=tt.sent(),ee>0&&0===Oe?.status&&"NetworkConnectionIssue"===(null===(et=Oe.error)||void 0===et?void 0:et.code)?(ee--,[2,le()]):[2,this.handleExportToExcelErrorResult(Oe)];case 3:return N.headers&&(qe=N.headers("requestId")),0===N.data.size?[2,Promise.reject({blob:null,requestId:qe,errorDetails:{errorType:1}})]:(Gt={blob:N.data,requestId:qe,isPartialResult:!1,format:1,fileName:o.getFileName(n,1)},[2,Promise.resolve(Gt)])}})})})()])):[2,Promise.reject({blob:null,errorDetails:{errorType:0}})]}})})},o.prototype.handleExportToExcelErrorResult=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,r,a,s,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:if(n.headers&&(e=n.headers("requestId")),!(n.data&&n.data instanceof Blob&&_.startsWith(n.data.type,"application/json")))return[3,9];r=new FileReader,a=void 0,d.label=1;case 1:return d.trys.push([1,3,,5]),[4,this.readAsText(n.data,r)];case 2:return a=d.sent(),[3,5];case 3:return s=d.sent(),[4,this.getDefaultQueryErrorExportDataResult(s,e)];case 4:return u=d.sent(),[2,Promise.reject(u)];case 5:return(c=JSON.parse(a))&&c.error&&(i=(0,Ye.GB)(c.error)),i?[2,Promise.reject(this.getTelemetryErrorExportDataResult(i,e))]:[3,6];case 6:return[4,this.getDefaultQueryErrorExportDataResult(a,e)];case 7:return u=d.sent(),[2,Promise.reject(u)];case 8:return[3,12];case 9:return n.error||n.data&&n.data.error?(i=(0,Ye.GB)(n.error?n.error:n.data.error),[2,Promise.reject(this.getTelemetryErrorExportDataResult(i,e,n.status))]):[3,10];case 10:return[4,this.getDefaultQueryErrorExportDataResult(n.data,e)];case 11:return u=d.sent(),[2,Promise.reject(u)];case 12:return[2]}})})},o.prototype.getCustomizedVisualArgs=function(n,e){if(D.fF.assertValue(n,"hostVisualContainer is undefined"),n){if(!this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(n))return{customizedVisualContainer:n,mergedFilters:e};var i=xn.b$.generateGuid(),r={singleVisual:(0,ke.d9)(n.config.singleVisual)},a=this.visualAuthoringOperations.buildVisualContainerFromConfig(i,r,"Default");return a.name=n.name,this.visualAuthoringCustomizeOperations.customizeConvert(a),{customizedVisualContainer:a,mergedFilters:this.mergeCustomizedFilters(a.filters,e)}}},o.prototype.readAsText=function(n,e){if(void 0!==n)return new Promise(function(i,r){e.onload=function(){i(e.result)},e.onerror=function(){r(e.error)},e.readAsText(n)})},o.prototype.getDefaultQueryErrorExportDataResult=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,r,a,c;return(0,p.__generator)(this,function(u){switch(u.label){case 0:if(i=n.toString(),!(n instanceof Blob))return[3,5];r=new FileReader,a=void 0,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.readAsText(n,r)];case 2:return a=u.sent(),[3,4];case 3:return u.sent(),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})];case 4:return i=a,(c=JSON.stringify(a))&&c.length>2&&(i=c),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})];case 5:return"object"==typeof n&&(c=JSON.stringify(n))&&c.length>2&&(i=c),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})]}})})},o.prototype.getTelemetryErrorExportDataResult=function(n,e,i){return{blob:null,requestId:e,errorDetails:{errorType:n.errorCode===_n._h?6:2,errorCode:n.errorCode,errorSource:n.errorCode===_n._h?(0,Ye.oG)("User"):n.errorSource,errorMessage:n.errorCode,status:i}}},o.prototype.mergeCustomizedFilters=function(n,e){var i=new Yo.ME;if(e&&!_.isEmpty(e.dataFiltersUnmerged))for(var r=0,a=e.dataFiltersUnmerged;r<a.length;r++)i.addVisualFilter(a[r]);for(var u=0,d=_.isEmpty(n)?[]:_.chain(n).filter(function(v){return v.filter}).map(function(v){return v.filter}).value();u<d.length;u++)i.addVisualFilter({filter:d[u]});return i.getFilters(!1)},o.prototype.resolveQueryParameters=function(n,e,i,r){return this.visualParameterService.resolve({dataSources:e,schema:n,additionalFilters:i,config:r.config.singleVisual,visual:r})},o.prototype.getGeneratedQuery=function(n,e,i,r,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var s,u,d,g,v,f,m,y,x,C,B,M,w,E,G,te,ee,ue,re,Ce;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return s=(0,ke.d9)(e.config.singleVisual),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(e)&&(u=this.getCustomizedVisualArgs(e,r),s=u.customizedVisualContainer.config.singleVisual,r=u.mergedFilters),s=this.replaceSparklineDataWithMeasure(n,s),d=this.getPercentRoleSelectIndexToDisplayNameMapping(s,n),this.rewritePercentRoleRefs(s,r),g=this.mapSelectIndexWithExprs(s,d),this.clearConversionContextWithPercentRole(s),this.clearVisualConfigObjects(s),[4,this.visualPluginService.ensureBuiltInPlugins()];case 1:return N.sent(),v=this.visualPluginService.getPlugin(J.L.tableEx.name),e.config.singleVisual.visualType===v.name?[3,3]:(f=this.visualAuthoringCore.convert({schema:n,source:s,target:v.name}),(m=_.clone(e)).config=_.clone(m.config),m.config.singleVisual=s,[4,this.resolveQueryParameters(n,i,r,m)]);case 2:if(N.sent(),!f)return[2];N.label=3;case 3:if(x=(y=s.query).projections,C=this.visualPluginService.capabilities(J.L.tableEx.name),!_.isEmpty(a))for(B=0,M=a;B<M.length;B++)w=M[B],!_.isEmpty(w.relatedSelects)&&w.expr&&y.add(w.expr,C.dataRoles[0].name);for(E=function(qe){var Gt=_.find(y.defn.select(),function(tt){return(0,_e.fS)(tt.expr,qe.expr)}),et=G.getQueryProjectionForSelect(Gt,x);et&&(et.displayName=qe.name)},G=this,te=0,ee=g;te<ee.length;te++)E(ee[te]);return(ue=_.cloneDeep(C.dataViewMappings))[0].table.rows.dataReductionAlgorithm={top:{count:$t}},re=(0,Sn.c)(i),Ce=re&&re.getDataSourceVariables(),[2,{result:this.visualQueryGenerator.execute({dataSources:i,config:s,schema:n,additionalFilters:r,dataViewMappingsOverride:ue,dataSourceVariables:Ce}),selectsWithDisplayName:g}]}})})},o.prototype.getGeneratedQueryMatrixDataLayout=function(n,e,i,r){var a=(0,ke.d9)(e.config.singleVisual);a=this.replaceSparklineDataWithMeasure(n,a);var s=(0,Sn.c)(i),u=s&&s.getDataSourceVariables();return{result:this.visualQueryGenerator.execute({dataSources:i,config:a,schema:n,additionalFilters:r,dataViewMappingsOverride:void 0,dataSourceVariables:u}),selectsWithDisplayName:void 0}},o.prototype.replaceSparklineDataWithMeasure=function(n,e){var i={name:"vc",config:{singleVisual:e}};return(0,vi.e6)(i)?((0,vi.Gy)(n,i,this.visualAuthoringOperations),i.config.singleVisual):e},o.prototype.queryData=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.dataProxy.execute(n)];case 1:return i=s.sent(),[3,3];case 2:return s.sent(),[2,Promise.reject({blob:null,errorDetails:{errorType:2}})];case 3:return[4,e(i.dataViewSource)];case 4:return[2,null!=(a=s.sent())?Promise.resolve(a):Promise.reject({blob:null,errorDetails:{errorType:1}})]}})})},o.prototype.exportDataViewSourceToCSV=function(n,e,i,r,a,s,c){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,d,g,f,m,y;return(0,p.__generator)(this,function(x){switch(x.label){case 0:return D.fF.assertValue(n,"dataViewSource"),D.fF.assertValue(e,"transformActions"),(u=o.readDataViewSource(n,a))&&(g=(d=u.dataView)&&d.table)?_.filter(g.columns,function(C){return null!=C.index&&!_.find(g.columns,function(B){return B.formatSource&&B.formatSource.formatString===C})}).length!==e.selects.length||(f=o.isPartialResult(u,s))&&!i?[2]:[4,this.visualPluginService.ensureBuiltInPlugins()]:[2];case 1:return x.sent(),m=this.visualPluginService.capabilities(J.L.table.name),y=(0,na.nn)({transforms:e,dataRoles:m.dataRoles,objectDescriptors:m.objects,prototype:d,colorAllocatorFactory:(0,ia.V)(),dataViewMappings:m.dataViewMappings,visualStyle:(0,ta.Ue)(),featureSwitches:this.featureSwitchService.featureSwitches}).dataViews,_.isEmpty(y)||null!=c&&void 0!==s&&o.isRowsBelowLimit(y[0],c)?[2]:f||null==c||!(f=o.isRowsAboveLimit(y[0],c))||i?[2,{isPartialResult:f,blob:Uo(y[0],ea.e0.formatString,c),format:0,fileName:o.getFileName(r,0)}]:[2]}})})},o.isRowsAboveLimit=function(n,e){var i=n.table;return!!i&&i.rows.length>e},o.isRowsBelowLimit=function(n,e){var i=n.table;return!!i&&i.rows.length<e},o.readDataViewSource=function(n,e){var i;try{i=(0,Zo.ij)(31,n.data,(0,qo.u)(e))}catch(r){return}return i},o.isPartialResult=function(n,e){if(!n)return!1;var i=_.some(n.warnings,function(r){return r instanceof Xo.x});return!!n.restartToken||i||void 0!==e},o.getFileName=function(n,e){var i="data";if(!_.isEmpty(n)){var r=(0,xn.k4)(n);_.isEmpty(r)||(i=r)}switch(e){case 0:return i+".csv";case 1:return i+".xlsx";default:D.fF.assertFail("Unknown format type")}},o.prototype.generateExportDataCommand=function(n,e,i,r,a,s){var c=this,u=Xe.ib.deserializeQuery(e),d={includeVariationSource:!0,includeDefaultAggregate:!0,includeHierarchyName:!0},g=this.visualPluginService.capabilities(r.visualType),v=_.map(u.select(),function(m){var y=_.find(s,function(x){return(0,_e.fS)(m.expr,x.expr)});return{queryName:m.name,displayName:y?y.name:c.displayNameService.getDisplayName(m.expr,n,g,m.name,r.columnProperties,d),qualifiedDisplayName:y?y.name:c.displayNameService.getQualifiedDisplayName(m.expr,n,g,d)}});return o.ensureUniqueName(v,i),{ExportDataCommand:{Columns:_.map(v,function(m){return{QueryName:m.queryName,Name:m.useQualified?m.qualifiedDisplayName:m.displayName}}),Ordering:this.getTableOrderingFromTransforms(a)||this.getDefaultTableOrdering(u.select().length),FiltersDescription:this.generateFiltersDescriptionString(i)}}},o.prototype.generateExportVisualLayoutDataCommand=function(n,e,i,r,a){var s=this,c=Xe.ib.deserializeQuery(e),u={includeVariationSource:!0,includeDefaultAggregate:!1,includeHierarchyName:!0},d=this.visualPluginService.capabilities(i.visualType);return{ExportDataCommand:{Columns:_.map(c.select(),function(y){var x=s.displayNameService.getDisplayName(y.expr,n,d,y.name,i.columnProperties,u);return{QueryName:y.name,Name:x}}),Ordering:this.getTableOrderingFromTransforms(r)||[],FiltersDescription:this.generateFiltersDescriptionString(a)}}},o.prototype.getTableOrderingFromTransforms=function(n){if(n.roles&&n.roles.ordering)return n.roles.ordering[zo.xP.ValuesRoleName]},o.prototype.getDefaultTableOrdering=function(n){return _.range(n)},o.ensureUniqueName=function(n,e){var i={},r={};D.fF.assertValue(n,"selectsNames"),D.fF.assertValue(e,"filtersDescription");for(var c=[],u=0,d=n.concat(e.filtersNamesAndRestatements||[]);u<d.length;u++)if((g=d[u]).displayName){c.push(g);var v=g.displayName.toLowerCase(),f=g.qualifiedDisplayName.toLowerCase();v in i&&i[v]!==f&&(r[v]=!0),i[v]=f}else g.useQualified=!0;for(var m=0,y=c;m<y.length;m++){var g;(g=y[m]).useQualified=r[g.displayName.toLowerCase()]}},o.prototype.generateFiltersDescriptionString=function(n){if(null==n.filtersNamesAndRestatements)return"";if(0===n.filtersNamesAndRestatements.length)return this.localizationService.get("ExportData_NoAppliedFiltersText");for(var e="",i=0,r=n.filtersNamesAndRestatements;i<r.length;i++){var a=r[i];e=e.concat(this.localizationService.format("ExportData_SingleFilterText",["\n",a.useQualified?a.qualifiedDisplayName:a.displayName,a.restatement]))}return this.localizationService.format("ExportData_AppliedFiltersText",[e])},o.prototype.overrideDataReduction=function(n,e,i,r){r=r||100,n.Commands[0].SemanticQueryDataShapeCommand.Binding.DataReduction=i?{Primary:(0,Ut.P)({window:{count:e}},void 0),Secondary:(0,Ut.P)({top:{count:r}},void 0)}:{Primary:(0,Ut.P)({top:{count:e}},void 0),Secondary:(0,Ut.P)({top:{count:r}},void 0)}},o.prototype.clearDataQuerySubtotal=function(n){for(var e=0,i=n.Commands[0].SemanticQueryDataShapeCommand.Binding.Primary.Groupings;e<i.length;e++){var r=i[e];null!=r.Subtotal&&(r.Subtotal=0)}},o.prototype.clearVisualConfigObjects=function(n){n.objects=void 0,n.vcObjects=void 0},o.prototype.getPercentRoleSelectIndexToDisplayNameMapping=function(n,e){for(var i=this.visualPluginService.capabilities(n.visualType),a=n.query.defn.select(),s=[],c=0;c<a.length;c++){var u=a[c];if((0,qt.fv)(u.expr)){var d=this.displayNameService.getDisplayName(u.expr,e,i,u.name,n.columnProperties);s.push({selectIndex:c,displayName:d})}}return s},o.prototype.rewritePercentRoleRefs=function(n,e){var i=n.query,r=i.defn.select(),s=new da(r,i.projections);i.defn=i.defn.rewrite(s),e&&e.dataFilter&&(e.dataFilter=e.dataFilter.rewrite(s))},o.prototype.mapSelectIndexWithExprs=function(n,e){for(var i=n.query.defn.select(),r=[],a=0,s=e;a<s.length;a++){var c=s[a];r.push({expr:i[c.selectIndex].expr,name:c.displayName})}return r},o.prototype.clearConversionContextWithPercentRole=function(n){if(n.conversionSourceContext&&n.conversionSourceContext.query)for(var r=0,a=n.conversionSourceContext.query.defn.select();r<a.length;r++)if((0,qt.fv)(a[r].expr)){n.conversionSourceContext=void 0;break}},o.prototype.getQueryProjectionForSelect=function(n,e){for(var i in e){var r=e[i].all(),a=_.find(r,function(s){return s.queryRef===n.name});if(a)return a}},o.prototype.setConnectedExportRowLimit=function(n,e){var i=5e5;!n||this.checkQueryForAllMeasures(n)||(null==e.Top||e.Top>i)&&(e.Top=i)},o.prototype.checkQueryForAllMeasures=function(n){return _.every(n.defn.select(),function(e){return(0,Ii.k)(e.expr)})},o}(),da=function(o){function n(e,i){var r=o.call(this)||this;return r.selects=e,r.projections=i,r}return(0,p.__extends)(n,o),n.prototype.visitScopedEval=function(e){for(var i=this,r=[],a=!1,s=0,c=e.scope;s<c.length;s++){var u=c[s];if((0,be.yL)(u)){a=!0;var d=this.projections[u.role];if(d){var g=d.all();r.push.apply(r,_.map(g,function(v){return i.selects.withName(v.queryRef).expr}))}}else r.push(u)}return a?new zt.kC(e.expression,r):e},n}(ra.b),Mn=l(43626),va={provide:Mn.DS,useFactory:function(o,n,e,i,r,a,s,c,u){return new ga(o,n,e,i,r,s,a,c,u)},deps:[Y.i,ce.D,ne.J,ae.vZ,Qe.RD,we.t,fe.z,ve.y0,pe.$8]},ga=function(){function o(n,e,i,r,a,s,c,u,d){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.featureSwitchService=r,this.groupAuthoring=a,this.selection=s,this.promiseFactory=c,this.telemetryService=u,this.visualAuthoring=d}return o.prototype.createFieldWellBucketCore=function(){return new ji({conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,promiseFactory:this.promiseFactory,selection:this.selection,telemetryService:this.telemetryService,visualAuthoring:this.visualAuthoring})},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(ne.J),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(Qe.RD),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(we.t),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8))},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),fa={provide:Mn.E6,useFactory:function(o,n,e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w,E){return new ma(o,n,e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w,E)},deps:[Y.i,ce.D,ne.J,q.z,ae.vZ,Qe.RD,Se.H,se.o,ei.x,we.t,Lt.g,fe.z,He.P,ii.s,ti.f,ve.y0,pe.$8,Ke.w,he.D,Me.w,de.r]},ma=function(){function o(n,e,i,r,a,s,c,u,d,g,v,f,m,y,x,C,B,M,w,E,G){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.explorationNavigation=r,this.featureSwitchService=a,this.groupAuthoring=s,this.lazyScoped=c,this.localizationService=u,this.modelChangeHandler=d,this.promiseFactory=g,this.screenReaderService=v,this.selection=f,this.showValueAsService=m,this.sparklinesService=y,this.themeService=x,this.telemetryService=C,this.visualAuthoring=B,this.visualCalcEagerService=M,this.visualPlugin=w,this.visibilityService=E,this.contextActivityService=G}return o.prototype.createFieldWellFieldCore=function(n,e){return new Ni({conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,lazyScoped:this.lazyScoped,localizationService:this.localizationService,modelChangeHandler:this.modelChangeHandler,promiseFactory:this.promiseFactory,screenReaderService:this.screenReaderService,selection:this.selection,showValueAsService:this.showValueAsService,sparklinesService:this.sparklinesService,telemetryService:this.telemetryService,themeService:this.themeService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visibilityService:this.visibilityService,visualCalcEagerService:this.visualCalcEagerService,contextActivityService:this.contextActivityService},n,e)},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(ne.J),t.\u0275\u0275inject(q.z),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(Qe.RD),t.\u0275\u0275inject(Se.H),t.\u0275\u0275inject(se.o),t.\u0275\u0275inject(ei.x),t.\u0275\u0275inject(we.t),t.\u0275\u0275inject(Lt.g),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(He.P),t.\u0275\u0275inject(ii.s),t.\u0275\u0275inject(ti.f),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8),t.\u0275\u0275inject(Ke.w),t.\u0275\u0275inject(he.D),t.\u0275\u0275inject(Me.w),t.\u0275\u0275inject(de.r))},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Ca={provide:"fieldWellModernService",useFactory:function(o,n,e,i,r,a,s,c,u,d,g,v,f,m,y){return new ba(o,n,e,i,r,a,s,c,u,d,g,v,f,m,y)},deps:[Y.i,ce.D,ne.J,Ue.O,q.z,ae.vZ,It.AA,Se.H,se.o,At.s,fe.z,He.P,Me.w,Ke.w,he.D]},ba=function(){function o(n,e,i,r,a,s,c,u,d,g,v,f,m,y,x){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.explorationDisplayNameService=r,this.explorationNavigation=a,this.featureSwitchService=s,this.groupingDesignStateService=c,this.lazyScopedProvider=u,this.localizationService=d,this.runningVisuals=g,this.selection=v,this.showValueAsService=f,this.visibility=m,this.visualCalcEagerService=y,this.visualPlugin=x}return o.prototype.createFieldWellCore=function(n,e,i){return new Ui({$element:n,conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationDisplayNameService:this.explorationDisplayNameService,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupingDesignStateService:this.groupingDesignStateService,lazyScopedProvider:this.lazyScopedProvider,localizationService:this.localizationService,runningVisuals:this.runningVisuals,selection:this.selection,showValueAsService:this.showValueAsService,visibility:this.visibility,visualCalcEagerService:this.visualCalcEagerService,visualPlugin:this.visualPlugin},e,i)},o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(ne.J),t.\u0275\u0275inject(Ue.O),t.\u0275\u0275inject(q.z),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(It.AA),t.\u0275\u0275inject(Se.H),t.\u0275\u0275inject(se.o),t.\u0275\u0275inject(At.s),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(He.P),t.\u0275\u0275inject(Me.w),t.\u0275\u0275inject(Ke.w),t.\u0275\u0275inject(he.D))},o.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Pa={provide:"tabOrderService",useFactory:function(o,n,e,i,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return[4,e.get("canvasListOrderingService")];case 1:return a=s.sent(),[2,new _a(a,o,n,i,r)]}})})},deps:[ui.F,Nt.F,Se.H,pt.z,vt.Q]},_a=function(){function o(n,e,i,r,a){this.canvasListOrderingService=n,this.canvasListOrderNormalizeService=e,this.formFactor=i,this.undoRedoService=r,this.visualAuthoringOperations=a,this.tabOrderPropertyName="tabOrder"}return o.prototype.changeSection=function(n,e,i,r,a){this.canvasListOrderingService.insertAtMinMagnitude(n,e,i,this.tabOrderPropertyName,r,a)},o.prototype.bringForward=function(n,e,i,r){this.canvasListOrderingService.bringForward(n,e,i,this.tabOrderPropertyName,r)},o.prototype.sendBackward=function(n,e,i,r){this.canvasListOrderingService.sendBackward(n,e,i,this.tabOrderPropertyName,r)},o.prototype.moveAfter=function(n,e,i,r){this.canvasListOrderingService.moveAfter(n,e,i,r,this.tabOrderPropertyName)},o.prototype.moveAfterIndex=function(n,e,i,r){this.canvasListOrderingService.moveAfterIndex(n,e,i,r,this.tabOrderPropertyName)},o.prototype.moveBefore=function(n,e,i,r){this.canvasListOrderingService.moveBefore(n,e,i,r,this.tabOrderPropertyName)},o.prototype.moveBeforeIndex=function(n,e,i,r){this.canvasListOrderingService.moveBeforeIndex(n,e,i,r,this.tabOrderPropertyName)},o.prototype.shouldNormalize=function(n,e){return this.canvasListOrderingService.shouldNormalize(n,e,this.tabOrderPropertyName)},o.prototype.normalize=function(n,e){this.canvasListOrderingService.normalize(n,e,this.tabOrderPropertyName)},o.prototype.normalizeHierarchy=function(n){var e=this,i=_.partition(n,function(y){var x=(0,Ie.bt)(y,0).tabOrder;return void 0===x||x>=0}),a=i[1],s=this.canvasListOrderNormalizeService.getContainerListOrders(i[0],function(y){return e.canvasListOrderingService.getListOrderPropertyFunction(y,"tabOrder")}),c=this.canvasListOrderNormalizeService.getContainerListOrders(a,function(y){return e.canvasListOrderingService.getListOrderPropertyFunction(y,"tabOrder")}),u=this.canvasListOrderNormalizeService.normalizeListOrder(s,!0),d=this.canvasListOrderNormalizeService.normalizeListOrder(c,!1),g=(0,p.__assign)((0,p.__assign)({},u),d);this.visualAuthoringOperations.updateContainerListOrders(n,g,"tabOrder");for(var v=0,f=n;v<f.length;v++){var m=f[v];(0,ye.q4)(m)&&this.normalizeHierarchy(m.children)}},o.prototype.sendTabOrderCommandsByLevel=function(n,e,i){var r=this;this.undoRedoService.register("Update Visual Containers for tabOrder",function(){r.sendTabOrderCommandsByLevelImpl(n,e,i)})},o.prototype.sendTabOrderCommandsByLevelImpl=function(n,e,i){var r=(0,Ie.Dg)(n);for(var a in r){var s=r[a],c=(0,Re.E8)(s[0],e);switch(i){case 0:this.bringForwardHierarchy(c,s,!0,!0);break;case 1:this.sendBackwardHierarchy(c,s,!0,!0)}}},o.prototype.bringForwardHierarchy=function(n,e,i,r){var a=(0,Ie.cV)(n,!0);this.canvasListOrderingService.bringForward(a,e,i,this.tabOrderPropertyName,r)},o.prototype.sendBackwardHierarchy=function(n,e,i,r){var a=(0,Ie.cV)(n,!0);this.canvasListOrderingService.sendBackward(a,e,i,this.tabOrderPropertyName,r)},o.prototype.orderByPosition=function(n){var e=this;this.undoRedoService.register("Update Visual Containers for tabOrder",function(){e.orderByPositionImpl(n)})},o.prototype.orderByPositionImpl=function(n){for(var e=this,a=(0,Ie.cV)(n,!0).map(function(d){return(0,Ie.bt)(d,e.formFactor.getCurrentLayout())}).sort(function(d,g){var v=Math.round(g.x)-Math.round(d.x),f=Math.round(g.y)-Math.round(d.y);return 0===Math.abs(f)?v:f}),s=0;s<a.length;s++){a[s].tabOrder=s*gt.R$;var u=n[s];(0,ye.q4)(u)&&this.orderByPositionImpl(u.children)}},o}(),xa={provide:"zIndexService",useFactory:function(o){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,o.get("canvasListOrderingService")];case 1:return n=e.sent(),[2,new Oa(n)]}})})},deps:[Se.H]},Oa=function(){function o(n){this.canvasListOrderingService=n,this.zIndexPropertyName="z"}return o.prototype.bringForward=function(n,e,i){this.canvasListOrderingService.bringForward(n,e,!0,this.zIndexPropertyName,i)},o.prototype.bringToFront=function(n,e,i){this.canvasListOrderingService.bringToFront(n,e,!0,this.zIndexPropertyName,i)},o.prototype.sendBackward=function(n,e,i){this.canvasListOrderingService.sendBackward(n,e,!0,this.zIndexPropertyName,i)},o.prototype.sendToBack=function(n,e,i){this.canvasListOrderingService.sendToBack(n,e,!0,this.zIndexPropertyName,i)},o.prototype.moveAfter=function(n,e,i){this.canvasListOrderingService.moveAfter(n,e,i,!0,this.zIndexPropertyName)},o.prototype.moveAfterIndex=function(n,e,i){this.canvasListOrderingService.moveAfterIndex(n,e,i,!0,this.zIndexPropertyName)},o.prototype.moveBefore=function(n,e,i){this.canvasListOrderingService.moveBefore(n,e,i,!0,this.zIndexPropertyName)},o.prototype.moveBeforeIndex=function(n,e,i){this.canvasListOrderingService.moveBeforeIndex(n,e,i,!0,this.zIndexPropertyName)},o.prototype.shouldNormalize=function(n){return this.canvasListOrderingService.shouldNormalize(n,!0,this.zIndexPropertyName)},o.prototype.normalize=function(n){this.canvasListOrderingService.normalize(n,!0,this.zIndexPropertyName)},o.prototype.sendZIndexCommandsByLevel=function(n,e,i){var r=(0,Ie.Dg)(n);for(var a in r){var s=r[a],c=(0,Re.E8)(s[0],e);switch(i){case 3:this.bringForward(c,s,!0);break;case 4:this.sendBackward(c,s,!0);break;case 1:this.bringToFront(c,s,!0);break;case 2:this.sendToBack(c,s,!0)}}},o}(),wa=l(44408),Fa=l(20914),Ea=l(52910),Va=l(31109),Da=l(22346),Ta=l(91280),Aa=l(42101),Ia=l(17269),Ba=l(82156),ka=l(79061),za=l(93855),La=l(13316),Na=l(94770),Ra=l(72359),ja=l(3741),Wa=l(90938),Ua=l(45925),$a=l(52040),Ga=l(91382),Ha=l(53935),Ka=l(47913),Qa=l(6015),Xa=l(76433),Za=l(47542),Ja=l(93367),Ya=l(94841),qa=l(13254),es=l(39433),ts=l(55533),is=l(79725),ns=l(16095),rs=l(6618),os=l(27037),as=l(17177),ss=[{type:Ji,componentId:"SyncGroupPaneComponentId"},{type:dn,componentId:"VisualizationPaneModernComponentId"},{type:ni,componentId:"FieldWellModernComponentId"},{type:Et,componentId:"DrillthroughPaneComponentId"},{type:ot,componentId:"AutoVisualComponentId"}],ls=function(){function o(){}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=t.\u0275\u0275defineInjector({providers:[go,bo,Vi.EY,xo,Fo,aa,va,fa,Ca,Pa,xa],imports:[P.CommonModule,Ea.O,La._,Va.F,Da.J,Ua.e,Ee.u5,Ia.InsightsUIModule,Ba.N.withManifests(ss),ka.v,wa.Ps,$a.x,Ga.d,Aa.p,Fa._,Ha.e,Ka.V,Qa.C,Na.f,Xa.d,Za.d,Ja.U,Ya.b,qa.x,Ra.K,es.t,ts.q,is.j,ns.Z,za.m,Ee.UX,rs.J,os.b,ja.z,as.T6,Wa.g,Ta.Q]}),o}()},79930:function(oe,K,l){l.d(K,{EY:function(){return H},Wg:function(){return k}});var h=l(81337),t=l(8082),P=l(40823),A=l(83008),b=l(77616),O=l(54766),z=l(54834),p=l(74082),L=l(25740),V=l(65181),T=l(58938),F=l(4877),S=l(50423),H={provide:"conditionalFormattingDialogLauncherService",useFactory:function(j,Z,I,R,W,U){return new k(j,Z,I,R,W,U)},deps:[V.o,T.x,F.a,A.D,t.s,P._]},k=function(){function j(Z,I,R,W,U,ie){this.localizationService=Z,this.dialogService=I,this.itemPickerService=R,this.dataSourcesService=W,this.runningVisuals=U,this.dataSourcesSerializer=ie}return j.prototype.show=function(Z,I,R,W,U,ie){return(0,h.__awaiter)(this,void 0,void 0,function(){var J;return(0,h.__generator)(this,function(Y){switch(Y.label){case 0:return J=R&&(0,p.tO)(R)?R.measure:R,[4,this.showModernConditionaFormattingDialog(Z,I,J,W,U,ie)];case 1:return[2,Y.sent().afterClosed().toPromise()]}})})},j.prototype.showModernConditionaFormattingDialog=function(Z,I,R,W,U,ie){var J,D;return(0,h.__awaiter)(this,void 0,void 0,function(){var Y,de,q,ne,ce;return(0,h.__generator)(this,function(ae){return Y=this.dataSourcesSerializer.serializeDataSources(this.dataSourcesService.get()),de=W.propertyDescriptor,q=this.runningVisuals.getVisual(Z),ne={colorPalette:(0,L.NO)(ie.colorPalette),icons:null===(J=this.itemPickerService)||void 0===J?void 0:J.getIcons(),iconSets:null===(D=this.itemPickerService)||void 0===D?void 0:D.getIconSets(),inDataSources:Y,propertySelector:W.selector&&(0,O.UZ)(W.selector),allowOverrideTotalMatching:W.allowOverrideSubtotalMatching,propertyDefinition:U&&(0,O.W7)(U,de),propertyDescriptor:(0,b.m8)(de,this.localizationService),targetFieldDisplayName:I,targetFieldExpr:R&&z.ib.serializeExpr(R),visualType:q.getType(),hasGrouping:!!W.selector&&this.hasGroupingColumn(q)},ce={title:"".concat(ne.propertyDescriptor.displayName," - ").concat(ne.targetFieldDisplayName),input:ne,hideOkButton:!1,hideCancelButton:!1,focusInitialCloseButton:!0,footerLink:{text:this.localizationService.get("ConditionalFormattingDialog_LearnMore"),url:"https://go.microsoft.com/fwlink/?linkid=874399",type:"external"}},[2,this.dialogService.showTemplateDialog("ConditionalFormattingDialog",ce,{minWidth:"940px",height:"665px",autoFocus:!0})]})})},j.prototype.hasGroupingColumn=function(Z){if(!Z)return!1;var I=Z.getDataViews()[0];if(I.metadata&&I.metadata.columns)for(var R=0,W=I.metadata.columns;R<W.length;R++)if(!W[R].isMeasure)return!0;return!1},j.\u0275fac=function(I){return new(I||j)(S.\u0275\u0275inject(V.o),S.\u0275\u0275inject(T.x),S.\u0275\u0275inject(F.a),S.\u0275\u0275inject(A.D),S.\u0275\u0275inject(t.s),S.\u0275\u0275inject(P._))},j.\u0275prov=S.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac}),j}()},42587:function(oe,K,l){l.d(K,{F:function(){return P},j:function(){return t}});var h=l(78417);function t(A,b,O){return void 0===O&&(O=!1),1===A?{paneTitle:b.get("Tooltip"),paneTitleTooltip:b.get("Drillthrough_TooltipTitleTooltip"),linkFieldsDropZoneTitle:b.get(O?"PagePropertyPane_LinkFieldsDropZoneTitle_Tooltip":"DrillthroughLinks_Tooltip_Fields"),dropZoneText:b.get("FieldDropZone_TooltipLink_Watermark"),keepAllFiltersLabel:b.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:b.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip"),keepAllFiltersToggleForcedOnTooltip:b.format("Drillthrough_KeepAllFiltersForcedOnForTooltip_Tooltip",[b.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip")]),crossReportDrillthroughLabel:b.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:b.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:b.get("DrillthroughLinks_LinkTypeGroup_Tooltip")}:{paneTitle:b.get("Drillthrough"),paneTitleTooltip:b.get("Drillthrough_DrillthroughTitleTooltip"),linkFieldsDropZoneTitle:b.get(O?"PagePropertyPane_LinkFieldsDropZoneTitle_Drillthrough":"DrillthroughLinks_Drillthrough_Fields"),dropZoneText:b.get("FieldDropZone_DrillthroughLink_Watermark"),keepAllFiltersLabel:b.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:b.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip"),keepAllFiltersToggleForcedOnTooltip:b.format("Drillthrough_KeepAllFiltersForcedOnForDrillthrough_Tooltip",[b.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip")]),crossReportDrillthroughLabel:b.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:b.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:b.get("DrillthroughLinks_LinkTypeGroup_Drillthrough")}}function P(A,b,O,z){var p=(0,h.Dt)(A,b),L=(0,h.LM)(A,b)||p,V=!b||p,H=!!b&&2===b.type||z&&!!b&&(void 0===b.type||0===b.type);return{keepAllFilters:{disabled:V,value:L,tooltip:V&&L?O.keepAllFiltersToggleForcedOnTooltip:O.keepAllFiltersTooltip},crossReportDrillthrough:{show:H,disabled:!b,value:!!H&&(0,h.aQ)(A,b),tooltip:O.crossReportDrillthroughTooltip},linkFieldsDropZoneTitle:O.linkFieldsDropZoneTitle,linkFieldsLinkTypeGroupTitle:O.linkFieldsLinkTypeGroupTitle}}},89839:function(oe,K,l){l.d(K,{l:function(){return b}});var h=l(62458),t=l(76001),P=l(80366),A=l(94419);function b(L,V){var T=(0,P._L)((0,t.Q)(L.expr)),F=void 0!==T,S=L.interactivityOptions.dropDownItems;if(S)for(var Q=0,H=S.items;Q<H.length;Q++){var k=H[Q],j=k.key;if(j)switch(j.action){case 4:k.checked=F&&j.aggregate===T;break;case 2:k.checked=!F;break;case 8:var Z=V.config.singleVisual.query.projections[L.role];k.checked=!(!Z||!Z.showAll);break;case 128:k.checked=O(L,k.text);break;case 16:for(var I=0,R=k.children;I<R.length;I++){var W=R[I];W.checked=p(L,W.key.showValueAs)}break;case 2048:k.checked=!1;break;default:k.checked=void 0}}}function O(L,V){var T=function(L){if(!_.isEmpty(L.hierarchyLevels)){var T=L.hierarchyLevels[0].expr;return h.fF.assert(function(){return T.arg instanceof A.jE},"hierarchyLevelExpr.arg should be instanceof powerbi.data.SQHierarchyExpr"),T.arg}}(L);if(T)return T.hierarchy===V;var F=(0,t.Q)(L.expr);return!!F&&(F.columnAggr?F.columnAggr.name===V:F.groupingColumnAggr?F.groupingColumnAggr.name===V:F.column?F.column.name===V:!!F.groupingColumn&&F.groupingColumn.name===V)}function p(L,V){var T=(0,t.Q)(L.expr);if(!T||!V)return!1;switch(V.kind){case void 0:return!T.percentOfGrandTotal&&!T.percentOfRoleTotal;case 0:return!!T.percentOfGrandTotal;case 1:var F=V;return!(!T.percentOfRoleTotal||!_.every(T.percentOfRoleTotal.roles,function(S){return _.includes(F.roles,S)}));default:return!1}}},40702:function(oe,K,l){l.d(K,{$0:function(){return T},Es:function(){return Kt},G5:function(){return b},Lo:function(){return Ht},Sd:function(){return Ve},TS:function(){return ne},V1:function(){return de},Y$:function(){return j},Yu:function(){return pe},_Z:function(){return H},_m:function(){return Xt},cF:function(){return P},gW:function(){return Zt},jG:function(){return Qt},lG:function(){return z},rU:function(){return L},yw:function(){return S}});var h=l(41114),t="PBI.ExploreUIAuthoring.ContextMenuButtonClicked",P=h.cx[t]=(0,h.b1)(t),A="PBI.ExploreUIAuthoring.RevertToDefaultClicked",b=h.cx[A]=(0,h.b1)(A),O="PBI.ExploreUIAuthoring.ExpansionButtonClicked",z=h.cx[O]=(0,h.b1)(O),p="PBI.ExploreUIAuthoring.FormattingPaneSearch",L=h.cx[p]=(0,h.b1)(p),V="PBI.ExploreUIAuthoring.InsertSection",T=h.cx[V]=(0,h.b1)(V),F="PBI.ExploreUIAuthoring.DeleteSection",S=h.cx[F]=(0,h.b1)(F),Q="PBI.ExploreUIAuthoring.VisualSession",H=h.cx[Q]=(0,h.b1)(Q,{logExpAssignment:!0}),k="PBI.ExploreUIAuthoring.ReorderTabOrderByPosition",j=h.cx[k]=(0,h.b1)(k),Z="PBI.ReportCreationCopilot.RunSuggestQueries",R=(h.cx[Z]=(0,h.b1)(Z),"PBI.AuthoringCopilotCreatePage.RunSuggestQueries"),U=(h.cx[R]=(0,h.b1)(R),"PBI.ReportCreationCopilot.PageValidation"),J=(h.cx[U]=(0,h.b1)(U),"PBI.ReportCreationCopilot.VisualValidation"),Y=(h.cx[J]=(0,h.b1)(J),"PBI.EX.ChangeFieldWell"),de=h.cx[Y]=(0,h.b1)(Y),q="PBI.EX.ChangeAggregation",ne=h.cx[q]=(0,h.b1)(q),ce="PBI.EX.RemoveConditionalFormatting",Ve=h.cx[ce]=(0,h.b1)(ce),ae="PBI.EX.RemoveDataBars",se=(h.cx[ae]=(0,h.b1)(ae),"PBI.EX.AnalyticsPane.Open"),he=(h.cx[se]=(0,h.b1)(se),"PBI.EX.AnalyticsPane.AddInstance"),pe=h.cx[he]=(0,h.b1)(he),it="PBI.EX.AnalyticsPane.RemoveInstance",nt=(h.cx[it]=(0,h.b1)(it),"PBI.EX.AnalyticsPane.ForecastParameterUpdated"),je=(h.cx[nt]=(0,h.b1)(nt),"PBI.EX.PropertyPane.OnValueChanged"),Ht=h.cx[je]=(0,h.b1)(je),ht="PBI.EX.DrillthroughPane.ChangeLink",ft=(h.cx[ht]=(0,h.b1)(ht),"PBI.EX.NavigateAndSelectVisual"),Kt=h.cx[ft]=(0,h.b1)(ft),mt="PBI.EX.FieldWellAbnormalRename",Qt=h.cx[mt]=(0,h.b1)(mt),yt="PBI.EX.LaunchChangeDetectionDialog",Xt=h.cx[yt]=(0,h.b1)(yt),Ct="PBI.EX.PersonalizeVisual.ChangePerspective",Zt=h.cx[Ct]=(0,h.b1)(Ct),bt="PBI.ReportCreationCopilot.FeedbackLoop.UserResponse",Pt=(h.cx[bt]=(0,h.b1)(bt),"PBI.ReportCreationCopilot.FeedbackLoop"),ot=(h.cx[Pt]=(0,h.b1)(Pt),"PBI.ReportCreationCopilot.UserResponse"),St=(h.cx[ot]=(0,h.b1)(ot),"PBI.ReportCreationCopilot.StageCompleted"),We=(h.cx[St]=(0,h.b1)(St),"PBI.ReportCreationCopilot.TerminalAPIError"),De=(h.cx[We]=(0,h.b1)(We),"PBI.ReportCreationCopilot.TerminalAgentError"),st=(h.cx[De]=(0,h.b1)(De),"PBI.ReportCreationCopilot.EnsureComplete"),lt=(h.cx[st]=(0,h.b1)(st),"PBI.CopilotReportAuthoring.Authoring"),_t=(h.cx[lt]=(0,h.b1)(lt),"PBI.CopilotReportAuthoring.CreatePage"),$e=(h.cx[_t]=(0,h.b1)(_t),"PBI.Copilot.PageCreationTool"),Ge=(h.cx[$e]=(0,h.b1)($e),"PBI.CopilotReportAuthoring.SuggestTopics"),Mt=(h.cx[Ge]=(0,h.b1)(Ge),"PBI.CopilotReportAuthoring.SummarizeDataset"),Ot=(h.cx[Mt]=(0,h.b1)(Mt),"PBI.CopilotReportAuthoring.CloseButtonClicked"),wt=(h.cx[Ot]=(0,h.b1)(Ot),"PBI.CopilotReportAuthoring.ValidateVisual"),Ft=(h.cx[wt]=(0,h.b1)(wt),"PBI.CopilotReportAuthoring.ValidateVisualAdHocQuery"),Te=(h.cx[Ft]=(0,h.b1)(Ft),"PBI.CopilotScenario.Summary.Generated"),me=(h.cx[Te]=(0,h.b1)(Te),"PBI.CopilotScenario.Answer.Generated"),ct=(h.cx[me]=(0,h.b1)(me),"PBI.CopilotScenario.Forecast.Generated"),ut=(h.cx[ct]=(0,h.b1)(ct),"PBI.CopilotReportAuthoring.ValidateField"),Dt=(h.cx[ut]=(0,h.b1)(ut),"PBI.ExploreCopilot.CopilotReferenceClicked"),ze=(h.cx[Dt]=(0,h.b1)(Dt),"PBI.ExploreCopilot.CopilotReferenceHovered"),Me=(h.cx[ze]=(0,h.b1)(ze),"PBI.Copilot.OpenCopilotPaneEditModeFS");h.cx[Me]=(0,h.b1)(Me)},43859:function(oe,K,l){l.d(K,{H:function(){return A}});var h=l(50423),t=l(57470),P=l(62458),A=function(){function b(){this.onActiveSection=new h.EventEmitter,this.observedTargetsMap=new Map}return b.prototype.onKeyDown=function(O){var V,z=this.options,p=this.options.sections,L=p.length;switch(O.keyCode){case 37:case 38:V=p.findIndex(function(H){return H===z.currentSection}),this.switchTab(p[(V-1+L)%L],O,!0);break;case 39:case 40:V=p.findIndex(function(H){return H===z.currentSection}),this.switchTab(p[(V+1)%L],O)}},b.prototype.switchTab=function(O,z,p){var L=this;void 0===p&&(p=void 0);var V=z.target,T=new MutationObserver(function(S){for(var Q=function(W){if("attributes"===W.type&&"tabindex"===W.attributeName&&document.activeElement===V){var U=t.M.getFirstMatchingAncestor(V,function(J){return J.hasAttribute(L.options.rootAttribute)}),ie=void 0;ie=p?t.M.getPrevTabbableMatchingSibling(V,function(J){return!!t.M.getFirstMatchingAncestor(J,function(D){return D.hasAttribute(L.options.pivotAttribute)},U,!0)},U):t.M.getNextTabbableMatchingSibling(V,function(J){return!!t.M.getFirstMatchingAncestor(J,function(D){return D.hasAttribute(L.options.pivotAttribute)},U,!0)},U),ie?.focus()}},H=0,k=S;H<k.length;H++)Q(k[H]);var Z=L.observedTargetsMap.has(V);Z||P.fF.assertFail("PivotTabKeyHandler does not have the correct observed target on mutation observer callback - possibly detached early"),T.disconnect();var I=L.observedTargetsMap.get(V);I>1?L.observedTargetsMap.set(V,I-1):Z&&L.observedTargetsMap.delete(V)});T.observe(V,{attributes:!0,attributeFilter:["tabindex"]});var F=this.observedTargetsMap.get(V);this.observedTargetsMap.set(V,F?F+1:1),this.onActiveSection.emit({nextSection:O}),z.stopPropagation()},b.\u0275fac=function(z){return new(z||b)},b.\u0275dir=h.\u0275\u0275defineDirective({type:b,selectors:[["","pivot-tab-key-handler",""]],hostBindings:function(z,p){1&z&&h.\u0275\u0275listener("keydown",function(V){return p.onKeyDown(V)})},inputs:{options:["pivot-tab-key-handler","options"]},outputs:{onActiveSection:"onActiveSection"}}),b}()},64824:function(oe,K,l){l.d(K,{R:function(){return P}});var h=l(50423),P=function(){function A(b){this.elementRef=b}return A.prototype.ngOnChanges=function(b){if(b.sectionNumber&&!b.sectionNumber.isFirstChange()){var O=b.sectionNumber.currentValue;null!=O&&this.animateSectionSlide(O,b.sectionNumber.previousValue)}},A.prototype.animateElement=function(b,O,z){b.css(O).animate(z,200)},A.prototype.animateSectionSlide=function(b,O){this.doNotAnimateSection||(b<O?this.animateElement($(this.elementRef.nativeElement),{right:"200%"},{right:0}):b>O&&this.animateElement($(this.elementRef.nativeElement),{"margin-left":"200%"},{"margin-left":0}));var z=$(".".concat(this.navMarkerParent," .navMarker"));if(this.autoWidth){var p=0===b?"margin-left":"margin-right",L=0===b?"margin-right":"margin-left",V={};V[p]="".concat(z.width(),"px"),V[L]="auto";var T={};T[p]="0",this.animateElement(z,V,T)}else this.animateElement(z,{},{"margin-left":z.width()*b+"px"})},A.\u0275fac=function(O){return new(O||A)(h.\u0275\u0275directiveInject(h.ElementRef))},A.\u0275dir=h.\u0275\u0275defineDirective({type:A,selectors:[["","section-animation-slider",""]],inputs:{sectionNumber:"sectionNumber",navMarkerParent:"navMarkerParent",autoWidth:"autoWidth",doNotAnimateSection:"doNotAnimateSection"},features:[h.\u0275\u0275NgOnChangesFeature]}),A}()},84431:function(oe,K,l){l.d(K,{Ct:function(){return z},DR:function(){return O},KT:function(){return T},OB:function(){return L},_d:function(){return b},aT:function(){return p},kh:function(){return V}});var h=l(55201),t=l(40812),P=l(50550),A=l(45413),b=function(){function F(S,Q,H,k,j,Z,I,R,W,U,ie,J,D){this.expr=S,this.role=Q,this.startIndex=H,this.endIndex=k,this.valid=j,this.displayOptions=Z,this.interactivityOptions=I,this.hierarchyLevels=R,this.conditionalFormattingRepetitions=W,this.supportedOperations=67108863,this.visualContainerName=U,this.visualType=ie,this.isHiddenInVisual=J,this.supportedOperations=D}return F.prototype.equals=function(S){return this.role===S.role&&(0,A.fS)(this.expr,S.expr)&&this.startIndex===S.startIndex&&this.endIndex===S.endIndex&&this.isEditingLabel===S.isEditingLabel&&this.valid===S.valid&&(this.displayOptions===S.displayOptions||!!(this.displayOptions&&S.displayOptions&&this.displayOptions.equals&&this.displayOptions.equals(S.displayOptions)))&&(this.interactivityOptions===S.interactivityOptions||!!(this.interactivityOptions&&S.interactivityOptions&&this.interactivityOptions.equals&&this.interactivityOptions.equals(S.interactivityOptions)))&&(0,P.NF)(this.conditionalFormattingRepetitions,S.conditionalFormattingRepetitions,t.u9)&&(0,h.L)(this.hierarchyLevels,S.hierarchyLevels)&&this.visualContainerName===S.visualContainerName&&this.visualType===S.visualType&&this.isHiddenInVisual===S.isHiddenInVisual&&this.supportedOperations===S.supportedOperations},F}(),O=function(){function F(S,Q,H,k,j){this.displayName=S,this.tooltipTitle=Q,this.tooltipDescription=H,this.glyph=k,this.pbiStyle=j}return F.prototype.equals=function(S){return this.displayName===S.displayName&&this.tooltipTitle===S.tooltipTitle&&this.tooltipDescription===S.tooltipDescription&&this.glyph===S.glyph&&this.pbiStyle===S.pbiStyle},F}(),z=function(){function F(S,Q,H){this.dropDownItems=S,this.isReplaceable=Q,this.isEditableField=H,this.canAppend=!0,this.canPrepend=!0,this.hasContextMenu=!0,this.isDraggableField=!0,this.isDroppableField=!0,this.isRemovableField=!0}return F.prototype.disableInteractivity=function(){this.canAppend=!1,this.canPrepend=!1,this.hasContextMenu=!1,this.isDraggableField=!1,this.isDroppableField=!1,this.isEditableField=!1,this.isRemovableField=!1},F.prototype.equals=function(S){return this.canAppend===S.canAppend&&this.canPrepend===S.canPrepend&&_.isEqual(this.dropDownItems,S.dropDownItems)&&this.hasContextMenu===S.hasContextMenu&&this.isDraggableField===S.isDraggableField&&this.isDroppableField===S.isDroppableField&&this.isEditableField===S.isEditableField&&this.isRemovableField===S.isRemovableField&&this.isReplaceable===S.isReplaceable},F}(),p=function(){function F(S,Q,H){this.expr=S,this.displayName=Q,this.tooltipTitle=H}return F.prototype.equals=function(S){return(0,A.fS)(this.expr,S.expr)&&this.displayName===S.displayName&&this.tooltipTitle===S.tooltipTitle},F}(),L=function(){function F(S,Q,H,k,j){this.role=S,this.displayName=Q,this.properties=H,this.supportsMultipleItems=k,this.description=j}return F.prototype.equals=function(S){return this.role===S.role&&this.displayName===S.displayName&&(0,h.L)(this.properties,S.properties)&&this.supportsMultipleItems===S.supportsMultipleItems&&this.description===S.description&&(this.warning===S.warning||!!(this.warning&&S.warning&&this.warning.equals&&this.warning.equals(S.warning)))&&this.disabled===S.disabled},F}(),V=function(){function F(S,Q,H){this.glyph=S,this.title=Q,this.description=H}return F.prototype.equals=function(S){return this.glyph===S.glyph&&this.title===S.title&&this.description===S.description},F}(),T=function(){return function(S){this.buckets=S}}()},64713:function(oe,K,l){l.d(K,{J:function(){return p}});var h=l(81337),t=l(42900),P=l(4437),A=l(73221),b=l(14172),O=l(50423),z=["*"],p=function(L){function V(T){var F=L.call(this)||this;return F.pbiButtonToggleService=T,F}return(0,h.__extends)(V,L),V.prototype.ngOnInit=function(){var T=this;this.changes$("disabled").pipe((0,b.U)(function(F){return(0,P.Ig)(F)})).subscribe(function(F){return T.pbiButtonToggleService.setDisabled(F)}),this.changes$("multiple").pipe((0,b.U)(function(F){return(0,P.Ig)(F)})).subscribe(function(F){return T.pbiButtonToggleService.setMultiple(F)})},V.\u0275fac=function(F){return new(F||V)(O.\u0275\u0275directiveInject(t.r))},V.\u0275cmp=O.\u0275\u0275defineComponent({type:V,selectors:[["pbi-button-toggle-group"]],hostAttrs:["role","group"],hostVars:4,hostBindings:function(F,S){2&F&&O.\u0275\u0275classProp("multiple",S.multiple)("disabled",S.disabled)},inputs:{disabled:"disabled",multiple:"multiple"},features:[O.\u0275\u0275ProvidersFeature([t.r]),O.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:z,decls:1,vars:0,template:function(F,S){1&F&&(O.\u0275\u0275projectionDef(),O.\u0275\u0275projection(0))},encapsulation:2,changeDetection:0}),V}(A.w)},42900:function(oe,K,l){l.d(K,{r:function(){return P}});var h=l(33554),t=l(50423),P=function(){function A(){this.selected$=new h.t(1),this.disabled$=new h.t(1),this.multiple$=new h.t(1)}return A.prototype.select=function(b){this.selected$.next(b)},A.prototype.setDisabled=function(b){this.disabled$.next(b)},A.prototype.setMultiple=function(b){this.multiple$.next(b)},A.\u0275prov=t.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac=function(O){return new(O||A)}}),A}()},53240:function(oe,K,l){l.d(K,{I:function(){return j}});var h=l(81337),t=l(4437),P=l(50423),A=l(17174),b=l(72065),O=l(63057),z=l(14172),p=l(22318),L=l(23558),V=l(83317),T=l(59973),F=l(73805),S=l(57243),Q=l(42900),H=l(77476),k=["*"],j=function(Z){function I(R){var W=Z.call(this)||this;return W.pbiButtonToggleService=R,W.checked=!1,W.supportsNoSelection=!1,W.role="button",W.ariaControls=null,W.id=null,W.valueChanged=new P.EventEmitter,W.onFocus=new P.EventEmitter,W.onBlur=new P.EventEmitter,W}return(0,h.__extends)(I,Z),I.prototype.ngOnInit=function(){this.isDisabled$=(0,O.T)(this.pbiButtonToggleService.disabled$,this.mergePropertyInputsAndFormControl(this.changes$("disabled").pipe((0,z.U)(function(R){return(0,t.Ig)(R)})),this.disabled$,"disabled",this.onDestroy$)).pipe((0,p.O)((0,t.Ig)(this.disabled))),this.setCheckedObservable()},I.prototype.setCheckedObservable=function(){var R=this,W=this.pbiButtonToggleService.multiple$.pipe((0,p.O)(!1)),U=this.mergePropertyInputsAndFormControl(this.changes$("checked"),this.value$,"checked",this.onDestroy$);U.subscribe(function(Y){return R.checked=Y});var ie=this.pbiButtonToggleService.selected$.pipe((0,L.M)(W),(0,V.R)(this.onDestroy$),(0,T.h)(function(Y){return!Y[1]&&R.value!==Y[0]}),(0,F.h)(!1));this.onButtonClicked=this.createEventAdapter();var J=this.onButtonClicked.$.pipe((0,L.M)(W),(0,z.U)(function(Y){var q=Y[1];return Y[0].stopPropagation(),!q&&!R.supportsNoSelection||!R.checked})),D=(0,O.T)(ie,J).pipe((0,S.d)(1));this.checked$=(0,O.T)(U,D),D.pipe((0,L.M)(this.isDisabled$),(0,T.h)(function(Y){return!Y[1]})).subscribe(function(Y){var de=Y[0];de&&R.pbiButtonToggleService.select(R.value),R.checked=de,R.valueChanged.emit(R.checked),R.onValueChange(R.checked),R.onTouched()})},I.\u0275fac=function(W){return new(W||I)(P.\u0275\u0275directiveInject(Q.r))},I.\u0275cmp=P.\u0275\u0275defineComponent({type:I,selectors:[["pbi-button-toggle"]],hostVars:2,hostBindings:function(W,U){2&W&&P.\u0275\u0275classProp("checked",U.checked)},inputs:{value:"value",disabled:"disabled",checked:"checked",supportsNoSelection:"supportsNoSelection",role:"role",ariaControls:"ariaControls",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],buttonTabIndex:"buttonTabIndex"},outputs:{valueChanged:"valueChanged",onFocus:"onFocus",onBlur:"onBlur"},features:[P.\u0275\u0275ProvidersFeature([{provide:A.JU,useExisting:(0,P.forwardRef)(function(){return I}),multi:!0}]),P.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:k,decls:5,vars:17,consts:[["type","button",3,"disabled","tabindex","click","focus","blur"]],template:function(W,U){1&W&&(P.\u0275\u0275projectionDef(),P.\u0275\u0275elementStart(0,"button",0),P.\u0275\u0275listener("click",function(J){return U.onButtonClicked.fn(J)})("focus",function(){return U.onFocus.emit()})("blur",function(){return U.onBlur.emit()}),P.\u0275\u0275pipe(1,"async"),P.\u0275\u0275pipe(2,"async"),P.\u0275\u0275pipe(3,"async"),P.\u0275\u0275projection(4),P.\u0275\u0275elementEnd()),2&W&&(P.\u0275\u0275property("disabled",P.\u0275\u0275pipeBind1(1,11,U.isDisabled$)||null)("tabindex",U.buttonTabIndex),P.\u0275\u0275attribute("value",U.value)("role",U.role)("aria-controls",U.ariaControls)("id",U.id)("aria-pressed","button"===U.role?P.\u0275\u0275pipeBind1(2,13,U.checked$):null)("aria-selected","button"!==U.role?P.\u0275\u0275pipeBind1(3,15,U.checked$):null)("aria-label",U.ariaLabel)("aria-labelledby",U.ariaLabelledby)("aria-describedby",U.ariaDescribedby))},dependencies:[H.AsyncPipe],styles:["button[_ngcontent-%COMP%]{background:transparent;overflow:hidden;border:none;margin:0;padding:0}button[_ngcontent-%COMP%]:focus{outline:none}"],changeDetection:0}),I}(b.N)},2380:function(oe,K,l){l.d(K,{O:function(){return L}});var h=l(81337),t=l(11991),P=l(37272),A=l(81905),b=l(23558),O=l(50423),z=l(26124),L=function(V){function T(F,S){return V.call(this,F,S)||this}return(0,h.__extends)(T,V),T.prototype.ngOnInit=function(){var F=this;this.changes$("pbiEmphasisBackground").pipe((0,A.w)(function(Q){return Q||P.E})).pipe((0,b.M)(this.changes$("pbiEmphasisBackgroundColor",!0))).subscribe(function(Q){var j=F.getAnimation("backgroundColor",Q[1]??"var(--globalColorBrand160)");F.emphasize(j)})},T.\u0275fac=function(S){return new(S||T)(O.\u0275\u0275directiveInject(z._j,8),O.\u0275\u0275directiveInject(O.ElementRef))},T.\u0275dir=O.\u0275\u0275defineDirective({type:T,selectors:[["","pbiEmphasisBackground",""]],inputs:{pbiEmphasisBackground:"pbiEmphasisBackground",pbiEmphasisBackgroundColor:"pbiEmphasisBackgroundColor"},features:[O.\u0275\u0275InheritDefinitionFeature]}),T}(t.A)},11991:function(oe,K,l){l.d(K,{A:function(){return A}});var h=l(81337),t=l(26124),A=function(b){function O(z,p){var L=b.call(this)||this;return L.animationBuilder=z,L.element=p,L}return(0,h.__extends)(O,b),O.prototype.emphasize=function(z){var p=this;if(this.animationBuilder){var L=function(){var T=p.animationBuilder.build(z),F=p.currentPlayer=T.create(p.element.nativeElement);F.onDestroy(function(){return p.currentPlayer=void 0}),F.play()};this.currentPlayer?(this.currentPlayer.finish(),this.currentPlayer.destroy(),this.requestedAnimationFrameId&&window.cancelAnimationFrame(this.requestedAnimationFrameId),this.requestedAnimationFrameId=window.requestAnimationFrame(function(){L(),p.requestedAnimationFrameId=void 0})):L()}},O.prototype.getAnimation=function(z,p){var L,V,T;return[(0,t.oB)((L={},L[z]="*",L)),(0,t.jt)("100ms ease-out",(0,t.oB)((V={},V[z]=p,V))),(0,t.jt)("500ms ease-out",(0,t.oB)((T={},T[z]="*",T)))]},O}(l(73221).w)},76433:function(oe,K,l){l.d(K,{d:function(){return P}});var h=l(77476),t=l(50423),P=function(){function A(){}return A.\u0275fac=function(O){return new(O||A)},A.\u0275mod=t.\u0275\u0275defineNgModule({type:A}),A.\u0275inj=t.\u0275\u0275defineInjector({imports:[h.CommonModule]}),A}()}}]);