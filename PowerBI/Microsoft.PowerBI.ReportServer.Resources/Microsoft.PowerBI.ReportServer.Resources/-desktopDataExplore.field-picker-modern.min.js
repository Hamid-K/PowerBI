"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["field-picker-modern"],{13941:function(Oe,Y,g){function y(A){return"add"===A.type}function N(A){return"delete"===A.type}function X(A){return"reorder"===A.type}function t(A){return"replace"===A.type}function V(A){return"rename"===A.type}function F(A){return"initialize"===A.type}g.d(Y,{H2:function(){return N},JB:function(){return y},V5:function(){return F},cA:function(){return t},cS:function(){return X},y$:function(){return V}})},30324:function(Oe,Y,g){g.r(Y),g.d(Y,{FieldPickerModernModule:function(){return bn}});var y=g(81337),N=g(77476),X=g(17174),t=g(83008),V=g(11494),F=g(82156),A=g(79061),J=g(41920),G=g(56598),B=g(6015),$=g(63654),ee=g(94841),U=g(66972),K=g(16748),pe=g(16095),W=g(35284),j=g(17177),R=g(35510),te=g(14463),ae=function(){function l(){this.visibility$=new R.X(!1)}return l.prototype.setVisibility=function(r){this.visibility$.next(r)},l.prototype.getVisibility$=function(){return this.visibility$.asObservable()},l}(),H={provide:"fieldPickerFlyoutService",useFactory:function(l){var r=new ae;return l.resolve(r)},deps:[te.t]},e=g(50423),se=g(82762),ue=g(59017),ke=g(14172),qe=g(77526),et=g(81905),tt=g(48787),nt=g(83317),Q=g(4722),Fe=g(67290),it=g(74804),E=g(62458),Ee=g(50550),ce=g(45413),Re=g(45551),de=g(44529),ge=g(88315),rt=g(32518),Ce=g(94419),ye=g(74082),ne=g(25512),be=g(64560),ot=g(8590),Ie=g(86940),at=g(88819),Be=g(59725),lt=g(68509),Ne=g(73221),Se=g(54834),st=g(95862),ze=g(45334),ct=g(80777),We=g(46135),He=g(81141),Ue=g(75096),Te=g(72525),dt=g(65534),Ke=g(66014),Le=g(78963),Pe=g(23983),De=g(86286),pt=g(70863);function $e(l){var c,n=l.allowSelectEntities,i=l.groupingDesignStateService,s=l.flatNode.node.data;if(E.fF.assertValue(s,"flatNode.node.data"),!(0,pt.Ov)(s)){if(s instanceof ge.e){if(!n)return;c=(0,Ce.nw)(s.contractSchema.name,s.contract.name)}else s instanceof ge.Xx?c=(0,de.Sd)(s,i):E.fF.assertFail("Expect flatNode to be either FieldListConceptualEntity or FieldListConceptualItem");return{newSelection:c,action:0}}}var je=function(){function l(r,n){this.overlayData=r,this.groupingDesignStateService=n}return l.prototype.check=function(r){var n=$e({flatNode:r.flatNode,allowSelectEntities:this.overlayData.allowSelectEntities,groupingDesignStateService:this.groupingDesignStateService});n&&(r.checked?(r.flatNode.node.checked=!0,this.overlayData.handleCheckedField(n)):(r.flatNode.node.checked=!1,this.overlayData.handleUncheckedField(n)))},l.\u0275fac=function(n){return new(n||l)(e.\u0275\u0275inject(De.M),e.\u0275\u0275inject(Pe.AA))},l.\u0275prov=e.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac}),l}(),Qe=g(13702),Ze=g(65181),ut=g(59968),gt=g(50057),Xe=g(76492),vt=g(58679),ft=g(42189),Ae=g(9529),Ve=g(36858),ve=g(65005),Ge=g(74913),d=g(85102),a=["fieldListDropdown"];function o(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.createVisualCalc())}),e.\u0275\u0275element(1,"tri-svg-icon",12),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("localizeTooltip",i.visualCalcCreationInfo.tooltip)}}function u(l,r){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",15),e.\u0275\u0275element(2,"span",16),e.\u0275\u0275elementStart(3,"p",17),e.\u0275\u0275element(4,"span",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("innerHtml",n.perspectiveDoesNotExistsDescriptionHtml,e.\u0275\u0275sanitizeHtml)}}function v(l,r){if(1&l&&(e.\u0275\u0275element(0,"span",19),e.\u0275\u0275elementStart(1,"p",17),e.\u0275\u0275element(2,"span",18),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("innerHtml",n.perspectiveExistsDescriptionHtml,e.\u0275\u0275sanitizeHtml)}}function C(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,u,5,1,"ng-container",9),e.\u0275\u0275template(2,v,3,1,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.perspectiveDoesNotExist)("ngIfElse",n)}}function h(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.selectedDisplayName," ")}}function w(l,r){1&l&&e.\u0275\u0275element(0,"span",32)}function x(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=r.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function I(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275element(1,"h2",34),e.\u0275\u0275elementStart(2,"pbi-dropdown",35),e.\u0275\u0275listener("valueChange",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.onAggregationChanged(c.property))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementStart(5,"pbi-dropdown-trigger")(6,"div",25)(7,"span"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,x,2,2,"pbi-dropdown-item",36),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled",i.aggregationDropdown.isDisabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",i.aggregationDropdown.selectedItem)("pbiTooltip",i.aggregationDropdown.isDisabled&&e.\u0275\u0275pipeBind1(3,8,"FieldPicker_AggregationsDisabled"))("aria-label",e.\u0275\u0275pipeBind1(4,10,"Summarization"))("isDisabled",i.aggregationDropdown.isDisabled),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(null==i.aggregationDropdown.selectedItem?null:i.aggregationDropdown.selectedItem.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.aggregationDropdown.items)}}function T(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=r.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function L(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275element(1,"h2",39),e.\u0275\u0275elementStart(2,"pbi-dropdown",40),e.\u0275\u0275listener("valueChange",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.onVariationChanged(c.property))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementStart(4,"pbi-dropdown-trigger")(5,"div",25)(6,"span"),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,T,2,2,"pbi-dropdown-item",36),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled",i.variationsDropdown.isDisabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",i.variationsDropdown.selectedItem)("aria-label",e.\u0275\u0275pipeBind1(3,7,"Date"))("isDisabled",i.variationsDropdown.isDisabled),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==i.variationsDropdown.selectedItem?null:i.variationsDropdown.selectedItem.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.variationsDropdown.items)}}function _t(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",20),e.\u0275\u0275element(2,"h2",21),e.\u0275\u0275elementStart(3,"pbi-dropdown",22,23),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementStart(6,"pbi-dropdown-trigger",24)(7,"div",25),e.\u0275\u0275template(8,h,2,1,"span",26),e.\u0275\u0275template(9,w,1,0,"span",27),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"pbi-field-list",28),e.\u0275\u0275listener("onNodeClick",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onNodeClick(c))}),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"div",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(13,I,10,12,"div",30),e.\u0275\u0275template(14,L,9,9,"div",31),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("aria-label",e.\u0275\u0275pipeBind1(5,12,"Field"))("options",i.fieldListDropdownOptions)("maxHeight",i.fieldListDropdownMaxHeight),e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",i.selectedItemTooltip),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.selectedDisplayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.selectedDisplayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(11,14,i.fieldListTree$))("scrollSelectedItemIntoViewOnInit",i.openFieldDropdownOnInit)("hasHighlights",!1)("options",i.fieldListTreeOptions),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.aggregationDropdown),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.variationsDropdown&&!i.variationsDropdown.isDisabled)}}function Ot(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-field-list",41),e.\u0275\u0275listener("onNodeClick",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onMultiSelectNodeClick(c))})("handleFieldListTreeHeightDiff",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.handleFieldListTreeHeightDiff(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(1,4,i.fieldListTree$))("options",i.fieldListTreeOptions)("checkMode",i.multiCheckMode)("focusSearchBoxOnFirstRenderComplete",!0)}}var Et=function(l){function r(n,i,s,c,p,f,m,b,P,M,O){var D=l.call(this)||this;return D.overlayData=n,D.checkableSetting=i,D.checkStrategy=s,D.explorationDisplayNameService=c,D.fieldListTreeService=p,D.groupingDesignStateService=f,D.hideMenuSetting=m,D.inlineItemsExtendShowOrHideSettingStrategy=b,D.localizationService=P,D.overlayRef=M,D.tooltipStrategy=O,D.fieldListTree$=D.fieldListTreeService.fieldListTree$,D.defaultPerspective="",D.fieldListTreeOptions={check:D.checkStrategy,editLabel:null,tooltip:D.tooltipStrategy},D.multiCheckMode=Be.kH.Multi,D}return(0,y.__extends)(r,l),r.prototype.ngOnInit=function(){var n,i=(n=this.overlayData).fieldListModel,s=n.allowSelectEntities,c=n.perspectiveDisplayName,p=n.schema,f=n.perspectiveDoesNotExist,m=n.openedByKeyboard,b=n.isAddingData;E.fF.assertValue(i,"fieldListModel"),this.perspectiveDoesNotExist=f,this.inNonDefaultPerspective=c&&c!==this.defaultPerspective,this.allowSelectEntities=s,this.perspectiveDoesNotExistsDescriptionHtml=this.localizationService.format("PersonalizeVisual_PerspectiveDescription_With_CubeNameError",c),this.perspectiveExistsDescriptionHtml=this.localizationService.format("PersonalizeVisual_PerspectiveDescription_V2",c),this.isAddingData=b,this.visualCalcCreationInfo=this.overlayData.visualCalcCreationInfo,this.initAggregationDropdown(),E.fF.assertValue(this.aggregationDropdown,"aggregationDropdown should be initialized"),this.initVariationDropdown(),this.openFieldDropdownOnInit=!b&&!m&&this.aggregationDropdown.isDisabled,p&&i&&this.initFieldList()},Object.defineProperty(r.prototype,"fieldListDropdownOptions",{get:function(){return{panelClass:this.overlayData.fieldListOverlayPanelClass}},enumerable:!1,configurable:!0}),r.prototype.ngAfterViewInit=function(){this.isAddingData||(this.fieldListDropdownMaxHeight=this.getFieldListDropdownMaxHeight(),this.openFieldDropdownOnInit&&this.fieldListDropdown.openDropdown())},r.prototype.getFieldListDropdownMaxHeight=function(){var n=this.fieldListDropdownElementRef.nativeElement.getBoundingClientRect(),s=document.documentElement.clientHeight-n.bottom;return Math.max(n.top,s)-4},r.prototype.onAggregationChanged=function(n){var i=this.aggregationDropdown.items.find(function(s){return s.property===n});E.fF.assertValue(i,"aggregationsDropdown.items should contain the selected item"),i&&(this.aggregationDropdown=(0,y.__assign)((0,y.__assign)({},this.aggregationDropdown),{selectedItem:i}),this.onDropdownItemSelected(i))},r.prototype.onVariationChanged=function(n){var i=this.variationsDropdown.items.find(function(s){return s.property===n});E.fF.assertValue(i,"variationsDropdown.items should contain the selected item"),i&&(this.variationsDropdown=(0,y.__assign)((0,y.__assign)({},this.variationsDropdown),{selectedItem:i}),this.onDropdownItemSelected(i))},r.prototype.onDropdownItemSelected=function(n){this.overlayData.onMenuItemSelected(n.property),this.closeOverlay()},r.prototype.initFieldList=function(){var n,i=(n=this.overlayData).visualCapabilities,s=n.fieldListModel,c=n.currentSelection,p=n.disabledCollection,f=n.schema;c=c??[],this.inlineItemsExtendShowOrHideSettingStrategy.addHiddenItemsOnly=!0,this.inlineItemsExtendShowOrHideSettingStrategy.hideInlineItemTooltip="Field_ShowHiddenFieldFromDataPane";var m=1===_.size(s.tables);this.fieldListTreeService.modelToPbiTreeConverterOptions={checkableSetting:this.checkableSetting,showMenuSetting:this.hideMenuSetting,expandedSetting:new It(m),inlineItemsSetting:this.inlineItemsExtendShowOrHideSettingStrategy};var b=_.flatMapDeep(c,function(O){return s.findItems(O,f,{excludeVariationSource:!0,excludeHierarchyLevels:!0})}),P=_.flatMapDeep(p,function(O){return s.findItems(O,f,{excludeVariationSource:!0,excludeHierarchyLevels:!0},{excludeHierarchy:!0,excludeVariationSource:!0})});this.fieldListTreeService.setOrUpdateFieldListTreeModel(s,b,void 0,P),E.fF.assert(function(){return c.length<=1},"Expected no more than 1 selection");var M=_.first(c);M&&(this.selectedDisplayName=this.explorationDisplayNameService.getDisplayName(M,f,i,void 0,void 0,{includeHierarchyName:!0,includeVariationSource:!0}),this.selectedItemTooltip=this.explorationDisplayNameService.getQualifiedDisplayName(M,f,i,{includeHierarchyName:!0,includeVariationSource:!0}))},r.prototype.initAggregationDropdown=function(){var i=this.initDropdown(this.overlayData.aggregationMenuItems);if(!i.selectedItem){var s=this.localizationService.get("Count_Visuals_0");i.selectedItem={name:s,property:s}}this.aggregationDropdown=i},r.prototype.initVariationDropdown=function(){var i=this.initDropdown(this.overlayData.variationsMenuItems);this.variationsDropdown=i},r.prototype.initDropdown=function(n){var i={items:[],isDisabled:!1};if(_.isEmpty(n))return i.isDisabled=!0,i;for(var s=0,c=n;s<c.length;s++){var p=c[s],f={name:p.text,property:p};p.checked&&(i.selectedItem=f),i.items.push(f)}return i},r.prototype.onNodeClick=function(n){var i=$e({flatNode:n,allowSelectEntities:this.allowSelectEntities,groupingDesignStateService:this.groupingDesignStateService});i&&this.overlayRef.close(i)},r.prototype.onMultiSelectNodeClick=function(n){this.checkStrategy.check({flatNode:n,checked:!n.node.checked})},r.prototype.closeOverlay=function(){this.overlayRef.close()},r.prototype.createVisualCalc=function(){this.overlayRef.close({newSelection:void 0,action:2})},r.prototype.handleFieldListTreeHeightDiff=function(n){if(n>0){var i=this.overlayRef.overlayRef.overlayElement.getBoundingClientRect().height;this.overlayRef.overlayRef.updateSize({height:i+n})}},r.\u0275fac=function(i){return new(i||r)(e.\u0275\u0275directiveInject(De.M),e.\u0275\u0275directiveInject(He.x),e.\u0275\u0275directiveInject(je),e.\u0275\u0275directiveInject(Qe.O),e.\u0275\u0275directiveInject(Ue.p),e.\u0275\u0275directiveInject(Pe.AA),e.\u0275\u0275directiveInject(Le.W),e.\u0275\u0275directiveInject(Te.VI),e.\u0275\u0275directiveInject(Ze.o),e.\u0275\u0275directiveInject(De.w),e.\u0275\u0275directiveInject(Ke.Z))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["field-picker-flyout"]],viewQuery:function(i,s){if(1&i&&(e.\u0275\u0275viewQuery(a,5),e.\u0275\u0275viewQuery(a,5,e.ElementRef)),2&i){var c=void 0;e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.fieldListDropdown=c.first),e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.fieldListDropdownElementRef=c.first)}},features:[e.\u0275\u0275ProvidersFeature([He.x,je,Ue.p,Pe.AA,Te.wt,Te.VI,dt.n,Ke.Z,{provide:Le.W,useClass:Le.w}]),e.\u0275\u0275InheritDefinitionFeature],decls:13,vars:7,consts:[["role","dialog","aria-labelledby","flyoutContainerTitle",1,"flyout-container"],[1,"header"],["id","flyoutContainerTitle","localize","TaskPane_Fields",1,"fluentTheme-lg-semiBold"],[1,"action-button-container"],["data-testid","create-visual-calc-button","tri-button","","size","small","appearance","subtle","class","increased-contrast",3,"localizeTooltip","click",4,"ngIf"],["localizeTooltip","Close",1,"glyphicon","glyph-mini","pbi-glyph-close","pbi-icon-button","pbi-focus-outline","close-button",3,"click"],[1,"field-list-container"],["class","pbi-field-list-perspective-header",4,"ngIf"],[1,"field-list-content"],[4,"ngIf","ngIfElse"],["multiSelectFieldList",""],["data-testid","create-visual-calc-button","tri-button","","size","small","appearance","subtle",1,"increased-contrast",3,"localizeTooltip","click"],["sprite","visual-calc-icons","name","data_histogram_function_20_regular"],[1,"pbi-field-list-perspective-header"],["showPerspectiveInfo",""],[1,"perspective-error"],["role","presentation",1,"glyphicon","glyph-small","pbi-glyph-error"],[1,"fluentTheme-sm-reg"],[3,"innerHtml"],["role","presentation",1,"glyphicon","glyph-small","pbi-glyph-info"],[1,"field-picker"],["localize","Field",1,"fluentTheme-sm-reg"],["size","xs","dropdown-type","field-list",1,"field-list-field",3,"aria-label","options","maxHeight"],["fieldListDropdown",""],[3,"pbiTooltip"],[1,"field-list-trigger","dropdown-trigger"],[4,"ngIf"],["localize","Select_A_Field",4,"ngIf"],["focus-nav-mode","Browser",1,"field-list-field-dropdown",3,"fieldListTree","scrollSelectedItemIntoViewOnInit","hasHighlights","options","onNodeClick"],["tabindex","0",1,"container-stop-bottom"],["class","aggregation-picker",4,"ngIf"],["class","variations-picker",4,"ngIf"],["localize","Select_A_Field"],[1,"aggregation-picker"],["localize","Summarization",1,"fluentTheme-sm-reg"],["size","xs",1,"field-list-aggregate",3,"value","pbiTooltip","aria-label","isDisabled","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"variations-picker"],["localize","Date",1,"fluentTheme-sm-reg"],["size","xs",1,"field-list-variation",3,"value","aria-label","isDisabled","valueChange"],[1,"multi-select-field-list",3,"fieldListTree","options","checkMode","focusSearchBoxOnFirstRenderComplete","onNodeClick","handleFieldListTreeHeightDiff"]],template:function(i,s){if(1&i&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"h1",2),e.\u0275\u0275elementStart(3,"div",3),e.\u0275\u0275template(4,o,2,1,"button",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",5),e.\u0275\u0275listener("click",function(){return s.closeOverlay()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"section",6),e.\u0275\u0275template(8,C,4,2,"div",7),e.\u0275\u0275elementStart(9,"div",8),e.\u0275\u0275template(10,_t,15,16,"ng-container",9),e.\u0275\u0275template(11,Ot,2,6,"ng-template",null,10,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()()),2&i){var c=e.\u0275\u0275reference(12);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",s.isAddingData&&s.visualCalcCreationInfo.supportVisualCalcCreation),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,5,"Close")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",s.inNonDefaultPerspective),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!s.isAddingData)("ngIfElse",c)}},dependencies:[N.NgForOf,N.NgIf,ut.X,gt.r,Xe.H,vt.I,ft.r,Ae._,Xe.T,Ve.V,ve.l,Ge.M,N.AsyncPipe,d.F],styles:['[_nghost-%COMP%]{height:100%;width:100%;background-color:var(--colorNeutralBackground3);border:1px solid var(--colorNeutralStroke3);border-radius:2px;color:var(--colorNeutralForeground1);padding:0;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 4px 8px var(--colorNeutralShadowKey)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;margin:8px 8px 4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action-button-container[_ngcontent-%COMP%]{display:flex;flex:auto;justify-content:flex-end;margin-bottom:4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{width:24px;height:24px;color:var(--colorNeutralForeground1)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground1Hover)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{background-color:var(--colorNeutralBackground1Pressed)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]{margin:4px 8px 8px;height:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:8px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   button[tri-button].increased-contrast[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   button[tri-button].increased-contrast[_ngcontent-%COMP%]:active:hover{background-color:var(--colorNeutralBackground3Pressed);color:var(--colorNeutralForeground2Pressed)}.pbi-overlay-caret-small.pbi-overlay-caret[_nghost-%COMP%]:after{background:var(--colorNeutralBackground3)!important;border-color:var(--colorNeutralStroke1Selected)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]{display:flex;margin:12px 0 4px}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .pbi-glyph-error[_ngcontent-%COMP%]{color:var(--colorDangerForeground1)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin:3px 8px 0 0}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--colorNeutralForeground1)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .perspective-error[_ngcontent-%COMP%]{background-color:var(--colorDangerBackground1);display:flex;padding:8px}.field-list-field-dropdown[_ngcontent-%COMP%]{padding:8px;height:380px}'],changeDetection:0}),r}(Ne.w),It=function(){function l(r){this.hasSingleTable=r}return l.prototype.isExpanded=function(r){return"Hierarchy"===r.modelObjectType||"Table"===r.modelObjectType&&this.hasSingleTable},l.prototype.isExpandedStateFixed=function(r){return"Hierarchy"===r.modelObjectType},l}(),St=g(98476),xe=g(13941),Ct=g(58609),Tt=g(28199),Lt=g(26898),At=g(61451),Vt=g(77200),Rt=g(27980),Bt=g(80357),Nt=function(){function l(){}return l.prototype.transform=function(r,n){if(null!=r){var i=n.split(",").map(function(s){return Number(s)});return(0,Q.X)(r,i)}},l.\u0275fac=function(n){return new(n||l)},l.\u0275pipe=e.\u0275\u0275definePipe({name:"itemAtPosition",type:l,pure:!0}),l}(),zt=["dragDropPickerRef"],Wt=["openFlyoutChevron"];function Ht(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"label",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.label)}}var Ut=function(r){return{v2Design:r}};function Kt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",8)(2,"button",9),e.\u0275\u0275listener("click",function(){var p=e.\u0275\u0275restoreView(n);return e.\u0275\u0275resetView(p.ngIf.handler())}),e.\u0275\u0275element(3,"tri-svg-icon",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=r.ngIf,s=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(5,Ut,s.withFieldList)),e.\u0275\u0275attribute("aria-label",i.tooltip),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",i.svgIconName)("sprite",i.svgIconSpriteName)("pbiTooltip",i.tooltip)}}function $t(l,r){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Kt,4,7,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&l){var n=r.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,n.promotedAction$))}}function jt(l,r){if(1&l&&(e.\u0275\u0275template(0,$t,3,3,"ng-container",1),e.\u0275\u0275pipe(1,"itemAtPosition"),e.\u0275\u0275pipe(2,"async")),2&l){var n=r.position,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind2(1,1,e.\u0275\u0275pipeBind1(2,4,i.fieldsView$),n.join(",")))}}var Qt=function(r,n){return{v2Design:r,error:n}};function Zt(l,r){if(1&l&&e.\u0275\u0275element(0,"div",16),2&l){var n=e.\u0275\u0275nextContext(2).field,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,Qt,i.withFieldList,n.invalid))}}function Xt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17,18),e.\u0275\u0275listener("click",function(m){e.\u0275\u0275restoreView(n);var b=e.\u0275\u0275reference(1),P=e.\u0275\u0275nextContext(2).position,M=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(M.openFlyout({overlayOrigin:b.parentElement.parentElement,fromFieldPosition:P,openedByKeyboard:0===m.detail}))})("keydown.arrowLeft",function(){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(m.focusClearButton())}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2),s=i.field,c=i.position,p=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",s.actionTooltip),e.\u0275\u0275attribute("aria-expanded",p.arePositionsEqual(e.\u0275\u0275pipeBind1(2,2,p.flyoutOpenPosition$),c))}}function Gt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",19),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2).position,f=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(f.directEditStrategy.onEdit(p))})("keydown.arrowLeft",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(p.focusClearButton())}),e.\u0275\u0275element(1,"tri-svg-icon",20),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2).position,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",s.directEditStrategy.getActionTooltip())("disabled",s.directEditStrategy.isDisabled(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular")}}function Jt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",21),e.\u0275\u0275listener("pbiMenuButtonClick",function(p){e.\u0275\u0275restoreView(n);var f=e.\u0275\u0275nextContext(2).position,m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.onMenuItemSelected(p,f))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2).field,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,4,"Options_Menu"))("pbiMenu",i.menu)("menuMode",s.CompactMenuMode)("pbiMenuActivation",s.pbiMenuActivation)}}function Yt(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,Zt,1,4,"div",12),e.\u0275\u0275template(2,Xt,3,4,"button",13),e.\u0275\u0275template(3,Gt,2,3,"button",14),e.\u0275\u0275template(4,Jt,2,6,"button",15),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(),i=n.position,s=n.field,c=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.withFieldList&&!c.disallowReplaceItems),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.withFieldList&&c.canOpenFlyout(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==c.directEditStrategy?null:c.directEditStrategy.shouldAllowDirectEdit(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!c.withFieldList&&!!s.menu)}}function qt(l,r){1&l&&e.\u0275\u0275template(0,Yt,5,4,"div",11),2&l&&e.\u0275\u0275property("ngIf",r.field)}function en(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ht,2,1,"label",2),e.\u0275\u0275elementStart(2,"pbi-drag-drop-picker",3,4),e.\u0275\u0275listener("onChangeAdd",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onPickerChangeAdd(f))})("onChangeRemove",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onPickerChangeRemove(f))})("onChangeReorder",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onPickerChangeReorder(f))})("onChangeReplace",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onPickerChangeReplace(f))})("onChangeLabelUpdate",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onPickerChangeRename(f))})("onCrossPickerDrop",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onCrossPickerDrop.emit(f))})("onAddDataClick",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(!m.disabled&&m.openFlyout({overlayOrigin:f.overlayOrigin,openedByKeyboard:0===f.detail,isAddingData:!0}))})("onContentClick",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onContentClickEvent(f))})("onMenuItemClick",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onMenuItemSelected(f.menuButton,f.position))})("onClearButtonArrowRight",function(f){e.\u0275\u0275restoreView(n);var m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.focusOpenFlyoutChevron(f))}),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,jt,3,6,"ng-template",null,5,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(9,qt,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=e.\u0275\u0275reference(8),s=e.\u0275\u0275reference(10),c=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.label),e.\u0275\u0275advance(1),e.\u0275\u0275property("compact",c.compact)("ariaLabelledby",c.ariaLabelledby)("dataFormat",c.parameterPickerDataFormat)("disabled",e.\u0275\u0275pipeBind1(4,28,c.changes$("disabled")))("placeholder",e.\u0275\u0275pipeBind1(6,32,"FieldDropZone_AddFields"))("addDataLabelKey",c.addDataLabelKey)("addDataAriaLabelKey",c.addDataAriaLabelKey)("draggable",c.allowReorderItems)("allowEditingLabelsSetting",c.allowEditingLabelsSetting)("allowMultipleValues",c.allowMultipleValues)("allowClear",c.allowClear)("disableDropZoneIndicator",c.disableDropZoneIndicator)("disableContentClick",c.disallowReplaceItems)("pbiDragDropPickerActionsTemplate",s)("itemPromotedActionTemplate",i)("externalCrossPickerDragDropMonitor",c.externalCrossPickerDragDropMonitor)("v2Design",c.withFieldList)("menuMode",c.CompactMenuMode)("useCustomTooltip",c.useCustomTooltip)("tooltipPosition",c.tooltipPosition)("tooltipWithFlexiblePositions",c.tooltipWithFlexiblePositions)("disableAutoScroll",c.disableAutoScroll)("disableClearButtonTabNavigation",!0)("allowEmptyLabel",c.emptyFieldSetsDefaultLabel),e.\u0275\u0275attribute("aria-labelledby",c.ariaLabelledby)("aria-describedby",c.ariaDescribedby)("aria-disabled",e.\u0275\u0275pipeBind1(5,30,c.changes$("disabled")))}}var tn=function(r){return{value:r}},an=function(l){function r(n,i,s,c,p,f,m,b,P,M,O,D,S,Z,z){var k=l.call(this)||this;return k.aggrOps=n,k.conceptualSchemaProxy=i,k.dataSourcesService=s,k.displayNameService=c,k.eventBridge=p,k.groupingDesignStateService=f,k.injector=m,k.localizationService=b,k.pbiOverlay=P,k.reportSettingsService=M,k.viewModeState=O,k.visualAuthoringOperationsService=D,k.pbiOverlayFactory=S,k.visualActionContext=Z,k.hostOverlayRef=z,k.withFieldList=!1,k.parameterPickerDataFormat=Be.L$,k.onExprChange=new e.EventEmitter,k.onCrossPickerDrop=new e.EventEmitter,k.flyoutOpenPosition$=new R.X(void 0),k.pbiMenuActivation="both",k.CompactMenuMode=be.Kb.Compact,k.fieldsMetadataUpdate$=new R.X(void 0),k.fieldsViewUpdate$=new R.X(void 0),k}return(0,y.__extends)(r,l),r.prototype.ngOnInit=function(){var n=this;this.ensureStrategies(),this.changes$("enterExitFieldRename",!0).subscribe(function(i){!0===i?.modeOn?n.dragDropPickerRef.beginEditSection(i.fieldPosition):!1===i?.modeOn&&n.dragDropPickerRef.endEditSection(i.fieldPosition)}),this.lifecycleSubscriptions.add(this.eventBridge.on(ot.CCe).subscribe(function(){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.resetFieldListTreeModel()];case 1:return i.sent(),[2]}})})})),this.changes$("initialExpr").pipe((0,ke.U)(function(i){if(n.allowMultipleValues||!_.isArray(i))return i&&!_.isEmpty(i)?(0,Ee.rY)(i):void 0;E.fF.assertFail("Expected initialExpr to be a single value when allowMultipleValues is false.")}),(0,qe.x)(function(i,s){if(_.isEmpty(s)){var c=n.fieldsMetadataUpdate$.getValue();return _.isEmpty(c?.metadata)}return function(l,r){if(_.size(l)!==_.size(r))return!1;for(var n=function(m){if(!_.some(r,function(b){return(0,ce.fS)(m,b)}))return{value:!1}},i=0,s=l??[];i<s.length;i++){var p=n(s[i]);if("object"==typeof p)return p.value}return!0}(_.map(i,function(p){return p.expr}),_.map(s,function(p){return p.expr}))}),(0,et.w)(function(i){return(0,se.D)(n.getSchema()).pipe((0,ke.U)(function(s){return{initialExprs:i,schema:s}}))})).subscribe(function(i){return n.updaterPickerWithInitialExprs(i.initialExprs,i.schema)}),this.lifecycleSubscriptions.add(this.fieldsMetadataUpdate$.subscribe(function(i){if(i&&(n.setFieldsViewUpdate(i),function(l){if(!l)return!1;var r=l.type;switch(r){case"add":case"delete":case"rename":case"reorder":case"replace":return!0;case"initialize":return!1;default:return E.fF.assertNever(r),!1}}(i.update))){var s=_.map(i.metadata,function(p){return{expr:p.expr,metadata:p.metadata}}),c=n.allowMultipleValues?s:_.first(s);n.onExprChange.emit({newExpr:c,fromUpdate:i.update})}})),this.lifecycleSubscriptions.add(this.fieldsViewUpdate$.subscribe(function(i){n.dragDropPickerRef&&i&&"delete"!==i.update.type&&(n.dragDropPickerRef.setAllData(_.map(i.view,function(c){return bt(c)})),n.dragDropPickerRef.detectChanges())})),this.fieldsView$=this.fieldsViewUpdate$.pipe((0,ke.U)(function(i){return i?.view})),this.visualAuthoringOperationsService.setVisualActionContext(this.visualActionContext)},r.prototype.canOpenFlyout=function(n){var i;return!this.disallowReplaceItems&&(null===(i=this.flyoutFieldsStrategyEnsured)||void 0===i?void 0:i.canOpenFlyout(n))},Object.defineProperty(r.prototype,"allowEditingLabelsSetting",{get:function(){return"varyByItem"},enumerable:!1,configurable:!0}),r.prototype.onPickerChangeRemove=function(n){this.removeFieldMetadata(n.position)},r.prototype.onPickerChangeAdd=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.onPickerChangeAddReplaceInternal({type:"add",data:n.data,position:n.position})];case 1:return i.sent(),[2]}})})},r.prototype.onPickerChangeReplace=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.onPickerChangeAddReplaceInternal({type:"replace",data:n.data,position:n.position})];case 1:return i.sent(),[2]}})})},r.prototype.onPickerChangeReorder=function(n){this.reorderFieldMetadata(n.fromPosition,n.toPosition)},r.prototype.onPickerChangeRename=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){var i,s,c,p,f=this;return(0,y.__generator)(this,function(m){return i=n.newLabel,s=n.position,c=(0,y.__spreadArray)([],this.fieldsMetadataUpdate$.value.metadata,!0),(0,Q.ri)(c,s,function(b,P){var M=b[P];E.fF.assert(function(){return"varyByItem"===f.allowEditingLabelsSetting&&M.allowRename},"the item does not allow rename!"),b[P]=(0,y.__assign)((0,y.__assign)({},M),{displayName:{value:i,fromOverride:!0}})}),p=function(l,r){return{type:"rename",renamed:{position:l,newName:r}}}(s,i),this.updateFieldsMetadata(c,p),[2]})})},r.prototype.onPickerChangeAddReplaceInternal=function(n){var i,s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,m,b,P,M,O,D,S,Z;return(0,y.__generator)(this,function(z){switch(z.label){case 0:return[4,this.getSchema()];case 1:return c=z.sent(),E.fF.assertValue(p=n.data.fieldExpr,"expect change data has fieldExpr and value not null"),p?(f=Se.ib.deserializeExpr(p),[4,this.dropExprStrategyInternal.getDropExpr(f,c)]):[3,3];case 2:m=z.sent(),z.label=3;case 3:if(b=n.position,P="replace"===n.type,m)this.addReplaceFieldMetadata(m,f,b,P,c);else{if(!this.dragDropPickerRef)return[2];M=null===(i=this.fieldsViewUpdate$.value)||void 0===i?void 0:i.view,O=this.getEffectiveReplacementPosition(b,_.size(M),P),D=null!=O?(0,Q.X)(M,O):void 0,S=D?.pickerData,null==S?(Z="end"===b?[_.size(null===(s=this.fieldsViewUpdate$.value)||void 0===s?void 0:s.view)]:b,this.dragDropPickerRef.handleClear(Z,!0)):this.dragDropPickerRef.replaceData((0,y.__assign)((0,y.__assign)({},S),{allowEditLabel:D.allowRename,menu:D.menuFactory}),O),this.dragDropPickerRef.detectChanges()}return[2]}})})},r.prototype.onContentClickEvent=function(n){var i=n.overlayOrigin,s=n.position;this.canOpenFlyout(s)&&this.openFlyout({overlayOrigin:i,fromFieldPosition:s})},r.prototype.openFlyout=function(n){var i,s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,m,P,M,O,D,S,Z,z,k,ie,fe,_e,me,Me,he,Mt,wt,Ye=this;return(0,y.__generator)(this,function(re){switch(re.label){case 0:return c=n.overlayOrigin,p=n.fromFieldPosition,f=n.openedByKeyboard,m=n.isAddingData,this.shouldFieldListShowHiddenFields()===this.lastFieldListShowHiddenFields?[3,2]:[4,this.resetFieldListTreeModel()];case 1:re.sent(),re.label=2;case 2:return P=this.pbiOverlay.position().flexibleConnectedTo(c).withPositions([(0,ne.v3)(),(0,ne.J7)(),(0,ne.Zz)(),(0,ne.q6)(),(0,ne.Kb)(),(0,ne.Iz)()]).withFlexibleDimensions(!0).withPush(!0).withViewportMargin(4).withGrowAfterOpen(!0),null!=this.fieldListTreeModel?[3,4]:[4,this.resetFieldListTreeModel()];case 3:re.sent(),re.label=4;case 4:return M=null===(i=this.fieldsMetadataUpdate$.value)||void 0===i?void 0:i.metadata,E.fF.assert(function(){return _.size(p)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),O=null!=p?(0,Q.X)(M,p):void 0,D=O?.expr,[4,this.getSchemaForFlyout()];case 5:if(S=re.sent(),Z=[],z=[],O?.menu)for(k=0,ie=O.menu.items;k<ie.length;k++)(fe=ie[k]).type===be.iB.Button&&(_e=fe.data,me=_e?.action,(4===me||2===me)&&Z.push(fe),128===me&&z.push(fe));return(he=new WeakMap).set(Ct.yk,this.visualActionContext),(null===(s=this.visualCalcFieldsStrategy)||void 0===s?void 0:s.isEditableVisualCalc(D))?[4,this.pbiOverlay.openWithFactoryLazy({modulePath:"@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-flyout/visual-calc-flyout.module#VisualCalcFlyoutModule",componentId:"VisualCalcFlyoutComponentId",data:{queryName:this.visualCalcFieldsStrategy.getQueryName(p)},options:{positionStrategy:P,hasBackdrop:!0,backdropClass:Ie.L,minWidth:150},closeOnBackdropClick:!0,hasCaret:!0,caretSize:0,injector:this.injector,providers:he},this.pbiOverlayFactory)]:[3,7];case 6:return Me=re.sent(),[3,9];case 7:return[4,this.flyoutFieldsStrategyEnsured.getVisualCalcCreationInfo(this.role)];case 8:Mt=re.sent(),wt=m?this.hostOverlayRef?this.hostOverlayRef.overlayRef.overlayElement.getBoundingClientRect().height:500:void 0,Me=this.pbiOverlay.openWithFactory({component:Et,data:{isAddingData:m,visualCapabilities:this.visualCapabilities,schema:S,fieldListModel:this.fieldListTreeModel,perspectiveDisplayName:this.perspectiveDisplayName,perspectiveDoesNotExist:this.perspectiveDoesNotExist,currentSelection:this.flyoutFieldsStrategyEnsured.getFieldsToSelectOnOpen(p,D),disabledCollection:this.flyoutFieldsStrategyEnsured.getFieldsToDisableOnOpen(p,D,this.fieldListTreeExprs,S),allowSelectEntities:this.allowEntityField,aggregationMenuItems:Z,variationsMenuItems:z,onMenuItemSelected:function(oe){return Ye.onMenuItemSelected(oe,p)},openedByKeyboard:f,fieldListOverlayPanelClass:this.fieldListOverlayPanelClass,role:this.role,handleCheckedField:function(oe){return Ye.handleCheckedField(oe,p)},handleUncheckedField:function(oe){return Ye.handleUncheckedField(oe)},visualCalcCreationInfo:Mt},options:{positionStrategy:P,hasBackdrop:!0,backdropClass:Ie.L,minWidth:206,minHeight:wt},closeOnBackdropClick:!0,hasCaret:!0,caretSize:0,injector:this.injector,providers:he},this.pbiOverlayFactory),re.label=9;case 9:return null!=p&&this.flyoutOpenPosition$.next(p),Me.onClose.pipe((0,tt.q)(1)).subscribe(function(q){return(0,y.__awaiter)(Ye,void 0,void 0,function(){var oe,ht;return(0,y.__generator)(this,function(we){switch(we.label){case 0:return null!=this.flyoutOpenPosition$.value&&this.flyoutOpenPosition$.next(void 0),q?function(l){return 0===l.action||2===l.action}(q)?0!==q.action?[3,2]:[4,this.flyoutFieldsStrategyEnsured.handleSelectedField(q.newSelection,p)]:[3,4]:[2];case 1:return we.sent(),[3,4];case 2:return 2!==q.action?[3,4]:[4,this.flyoutFieldsStrategyEnsured.onCloseWithCreateVisualCalc(this.role)];case 3:we.sent(),we.label=4;case 4:return function(l){return 1===l.action}(q)?(E.fF.assertValue(oe=q.queryName,"queryName of the visual calc to be edit"),null==oe?[2]:[4,null===(ht=this.visualCalcFieldsStrategy)||void 0===ht?void 0:ht.onEditVisualCalc(q.queryName)]):[3,6];case 5:we.sent(),we.label=6;case 6:return[2]}})})}),[2]}})})},r.prototype.onMenuItemSelected=function(n,i){var s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,m,b,P,M=this;return(0,y.__generator)(this,function(O){switch(O.label){case 0:return[4,this.getSchema()];case 1:return c=O.sent(),(p=this.menuStrategyInternal.menuItemClickHandler(n,i,c))?(f=p.fromUpdate,m=null===(s=this.fieldsMetadataUpdate$.value)||void 0===s?void 0:s.metadata,b=(0,Ee.rY)(p.newExpr),P=_.map(b,function(D,S){return M.createFieldMetadata(D,D.expr,[S],c,f)}),P=_.map(P,function(D,S){return Pt(D,[S],P,m,f)}),this.updateFieldsMetadata(P,f),[2]):[2]}})})},r.prototype.handleCheckedField=function(n,i){this.flyoutFieldsStrategyEnsured.handleSelectedField(n.newSelection,i)},r.prototype.handleUncheckedField=function(n){this.flyoutFieldsStrategyEnsured.handleDeselectedField(n.newSelection)},r.prototype.focusOpenFlyoutChevron=function(n){this.openFlyoutChevronQueryList&&(this.previousFocusedClearButton=n.currentFocusedClearButton,this.openFlyoutChevronQueryList.get(n.topLevelIndex).nativeElement.focus())},r.prototype.arePositionsEqual=function(n,i){return mt(n,i)},r.prototype.focusClearButton=function(){this.previousFocusedClearButton&&this.previousFocusedClearButton.focus()},r.prototype.updaterPickerWithInitialExprs=function(n,i){var s=this,c={type:"initialize"};this.updateFieldsMetadata(_.map(n,function(p,f){return s.createFieldMetadata(p,p.expr,[f],i,c)}),c)},r.prototype.createFieldMetadata=function(n,i,s,c,p){var m,b,f=this,P=this.dropExprStrategyInternal.getDroppedExprChildren(n,s,c,p),M=p;return{expr:n.expr,metadata:n.metadata,pickerDataExpr:i,allowRename:this.nameStrategyInternal.isRenameAllowed(s,M),menu:this.menuStrategyInternal.getMenu(n.expr,s,c,p),displayName:{value:this.nameStrategyInternal.getDisplayName(n.expr,s,c,M),fromOverride:!1,pbiStyle:this.nameStrategyInternal.getDisplayNameStyle?this.nameStrategyInternal.getDisplayNameStyle(s,M):void 0},customTooltipContent:this.nameStrategyInternal.getCustomTooltipContent?this.nameStrategyInternal.getCustomTooltipContent(n.expr,c,s,M):void 0,children:_.isEmpty(P)?void 0:_.map(P,function(O,D){var S=s.concat(D);return f.createFieldMetadata(O,O.expr,S,c,p)}),promotedAction$:null===(m=this.promotedActionStrategy)||void 0===m?void 0:m.getAction(s,M),invalid:this.nameStrategyInternal.isFieldInvalid(s,M),actionTooltip:null!==(b=this.visualCalcFieldsStrategy)&&void 0!==b&&b.isEditableVisualCalc(n.expr)?this.localizationService.get("Calculation_Options"):this.localizationService.get("Data_Options")}},r.prototype.addReplaceFieldMetadata=function(n,i,s,c,p){var f;E.fF.assertValue(!c||"end"!==s,"expect position to be a valid ItemPosition when it is for replace");var m=null===(f=this.fieldsMetadataUpdate$.value)||void 0===f?void 0:f.metadata,b=this.getEffectiveReplacementPosition(s,_.size(m),c),P=null!=b,M=P?void 0:"end"===s?[_.size(m)]:s,O=P?(0,Q.X)(m,b).metadata:void 0,D=P?xt(b,O):function(l,r,n){return{type:"add",added:{position:l,pickerOriginalExpr:r,metadata:n}}}(M,i,n.metadata),S=P?b:M,Z=this.createFieldMetadata(n,i,S,p,D),z=(0,y.__spreadArray)([],m||[],!0),k=P?1:0;if(1===_.size(S))z.splice(S[0],k,Z);else{var fe=S.slice(0,-1);(0,Q.ri)(z,fe,function(_e,me){var Me=_e[me],he=(0,y.__spreadArray)([],Me.children,!0),Je=_.last(S);he.splice(Je,k,Z),_e[me]=(0,y.__assign)((0,y.__assign)({},Me),{children:he})})}this.updateFieldsMetadata(z,D)},r.prototype.reorderFieldMetadata=function(n,i){var c,s=this;E.fF.assert(function(){return s.allowMultipleValues},"expect this to be called only when this allows multiple values");var p=n.slice(0,-1);E.fF.assert(function(){return mt(p,i.slice(0,-1))},"Expect reordering only among siblings. Add your implement for new scenario.");var f=null===(c=this.fieldsMetadataUpdate$.value)||void 0===c?void 0:c.metadata,m=_.isEmpty(p)?void 0:(0,Q.X)(f,p),b=m?m.children:f,P=_.last(n),M=_.last(i),O=b[P];E.fF.assert(function(){return _.inRange(P,0,_.size(b))},"fromIndex value is invalid"),E.fF.assert(function(){return _.inRange(M,0,_.size(b)+1)},"toIndex value is invalid");var S,D=(0,y.__spreadArray)([],b,!0);D[P]=void 0,D.splice(M,0,O),D=_.filter(D,function(z){return!!z}),m?(S=(0,y.__spreadArray)([],f,!0),(0,Q.ri)(S,p,function(z,k){var ie=z[k];ie=(0,y.__assign)((0,y.__assign)({},ie),{children:D}),z.splice(k,1,ie)})):S=D;var Z=function(l,r,n){return{type:"reorder",reordered:{fromPosition:l,toPosition:r,originalMetadata:n}}}(n,i,O.metadata);this.updateFieldsMetadata(S,Z)},r.prototype.removeFieldMetadata=function(n){var i,s,p,c=(0,y.__spreadArray)([],null!==(s=null===(i=this.fieldsMetadataUpdate$.value)||void 0===i?void 0:i.metadata)&&void 0!==s?s:[],!0);if(1===_.size(n))p=c.splice(n[0],1)[0];else{var m=n.slice(0,-1);p=(0,Q.ri)(c,m,function(P,M){var O=P[M],D=(0,y.__spreadArray)([],O.children,!0),S=_.last(n),Z=D.splice(S,1)[0];return P[M]=(0,y.__assign)((0,y.__assign)({},O),{children:D}),Z})}var b=function(l,r){return{type:"delete",deleted:{position:l,expr:r.expr,metadata:r.metadata}}}(n,p);this.updateFieldsMetadata(c,b)},r.prototype.updateFieldsMetadata=function(n,i){this.fieldsMetadataUpdate$.next({metadata:_.map(n,function(s){return{expr:s.expr,metadata:s.metadata,pickerDataExpr:s.pickerDataExpr,allowRename:s.allowRename,displayName:s.displayName,menu:s.menu,children:s.children,customTooltipContent:s.customTooltipContent,promotedAction$:s.promotedAction$,invalid:s.invalid,actionTooltip:s.actionTooltip}}),update:i})},r.prototype.setFieldsViewUpdate=function(n){E.fF.assertValue(n,"Expect fieldsMetadataUpdate to be defined");var i=_.map(n.metadata,function(s){return yt(s)});this.fieldsViewUpdate$.next({view:i,update:n.update})},r.prototype.ensureStrategies=function(){var n=this;(0,ue.aj)([this.changes$("alwaysAllowAggregate",!0),this.changes$("aggregatesConstraint",!0),this.changes$("validators",!0)]).pipe((0,nt.R)(this.onDestroy$)).subscribe(function(i){n.defaultStrategy=new ln(function(){var f;return null===(f=n.fieldsMetadataUpdate$.value)||void 0===f?void 0:f.metadata},function(){return n.dragDropPickerRef},i[0],i[1],i[2],n.aggrOps,n.conceptualSchemaProxy,n.dataSourcesService,n.displayNameService,n.localizationService)}),this.changes$("menuStrategy",!0).subscribe(function(i){n.menuStrategyInternal=i??n.defaultStrategy}),this.changes$("getDropExprStrategy",!0).subscribe(function(i){n.dropExprStrategyInternal=i??n.defaultStrategy}),this.changes$("displayNameStrategy",!0).subscribe(function(i){n.nameStrategyInternal=i??n.defaultStrategy,n.useCustomTooltip=!!n.nameStrategyInternal.getCustomTooltipContent}),this.changes$("flyoutFieldsStrategy",!0).subscribe(function(i){n.flyoutFieldsStrategyEnsured={getFieldsToSelectOnOpen:function(c,p){return i?.getFieldsToSelectOnOpen?i.getFieldsToSelectOnOpen(c,p):n.defaultStrategy.getFieldsToSelectOnOpen(c,p)},getFieldsToDisableOnOpen:function(c,p,f,m){return i?.getFieldsToDisableOnOpen?i.getFieldsToDisableOnOpen(c,p,f,m):n.defaultStrategy.getFieldsToDisableOnOpen(c,p,f,m)},handleSelectedField:function(c,p){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(f){switch(f.label){case 0:return i?.handleSelectedField?[4,i.handleSelectedField(c,p)]:[3,2];case 1:return f.sent(),[3,4];case 2:return[4,this.defaultStrategy.handleSelectedField(c,p)];case 3:f.sent(),f.label=4;case 4:return[2]}})})},handleDeselectedField:function(c){i?.handleDeselectedField?i.handleDeselectedField(c):n.defaultStrategy.handleDeselectedField(c)},onCloseWithCreateVisualCalc:function(c){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(p){switch(p.label){case 0:return i?.onCloseWithCreateVisualCalc?[4,i.onCloseWithCreateVisualCalc(c)]:[3,2];case 1:return p.sent(),[3,4];case 2:return[4,this.defaultStrategy.onCloseWithNewVisualCalc(c)];case 3:p.sent(),p.label=4;case 4:return[2]}})})},getVisualCalcCreationInfo:function(c){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(p){switch(p.label){case 0:return i?.getVisualCalcCreationInfo?[4,i.getVisualCalcCreationInfo(c)]:[3,2];case 1:return[2,p.sent()];case 2:return[2,this.defaultStrategy.getVisualCalcCreationInfo(c)]}})})},canOpenFlyout:function(c){return i?.canOpenFlyout?i.canOpenFlyout(c):n.defaultStrategy.canOpenFlyout(c)}}})},r.prototype.buildFieldListTreeModel=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var n;return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getSchemaForFlyout()];case 1:return(n=i.sent())?(this.lastFieldListShowHiddenFields=this.shouldFieldListShowHiddenFields(),[2,new rt.O(this.localizationService).createModel(n,!1,!this.lastFieldListShowHiddenFields)]):[2]}})})},r.prototype.resetFieldListTreeModel=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var n;return(0,y.__generator)(this,function(i){switch(i.label){case 0:return n=this,[4,this.buildFieldListTreeModel()];case 1:return n.fieldListTreeModel=i.sent(),this.setFieldListTreeExprs(),[2]}})})},r.prototype.shouldFieldListShowHiddenFields=function(){var n=this.viewModeState.getMode();return(1===n||2===n)&&this.reportSettingsService.getShowHiddenFields()},r.prototype.getSchemaForFlyout=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var i;return(0,y.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(this.getDataSourceForFlyout())];case 1:return[2,s.sent()];case 2:return(i=s.sent()).serviceError&&"CubeNameDoesNotExist"===i.serviceError.errorCode&&(this.perspectiveDoesNotExist=!0),[2];case 3:return[2]}})})},r.prototype.getDataSourceForFlyout=function(){var n=(0,it.yd)((0,y.__spreadArray)([],this.dataSourcesService.get(),!0));if(this.perspectiveDisplayName&&""!==this.perspectiveDisplayName){var i=n.findIndex(function(p){return"dsr"===p.type}),s=n[i];if(s){var c=(0,y.__assign)((0,y.__assign)({},s),{perspectiveId:this.perspectiveDisplayName});n[i]=c}}return n},r.prototype.getSchema=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return[2,i.sent()]}})})},r.prototype.getEffectiveReplacementPosition=function(n,i,s){return this.allowMultipleValues?(E.fF.assert(function(){return!s||"end"!==n},"an ItemPosition from replace should never be 'end'"),s?n:void 0):i>0&&("end"===n||1===_.size(n))?[0]:s?n:void 0},r.prototype.setFieldListTreeExprs=function(){var n=this;this.fieldListTreeModel&&(this.fieldListTreeExprs=[],_.forEach(this.fieldListTreeModel.entities,function(i){n.fieldListTreeExprs.push((0,de.W4)(i));var s=_.map([i.columns,i.measures,i.kpis,i.hierarchies],function(p){return p.getItems()}),c=[].concat.apply([],s);_.forEach(c,function(p){var f=(0,de.Sd)(p,n.groupingDesignStateService);n.fieldListTreeExprs.push(f)}),_.forEach(i.properties,function(p){_.forEach(p.properties,function(f){f instanceof ge.Jg&&(n.fieldListTreeExprs.push((0,de.Sd)(f,n.groupingDesignStateService)),_.forEach(f.hierarchyLevels,function(m){n.fieldListTreeExprs.push((0,de.Sd)(m,n.groupingDesignStateService))}))})}),_.forEach(i.hierarchies.getItems(),function(p){_.forEach(p.hierarchyLevels,function(f){var m=(0,de.Sd)(f,n.groupingDesignStateService);n.fieldListTreeExprs.push(m)})})}))},r.\u0275fac=function(i){return new(i||r)(e.\u0275\u0275directiveInject(Tt.C),e.\u0275\u0275directiveInject(Lt.i),e.\u0275\u0275directiveInject(t.D),e.\u0275\u0275directiveInject(Qe.O),e.\u0275\u0275directiveInject(V.J),e.\u0275\u0275directiveInject(Pe.AA),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Ze.o),e.\u0275\u0275directiveInject(Ie._),e.\u0275\u0275directiveInject(At.h),e.\u0275\u0275directiveInject(Vt.kc),e.\u0275\u0275directiveInject(Rt.Q),e.\u0275\u0275directiveInject(at.l),e.\u0275\u0275directiveInject(Ct.yk),e.\u0275\u0275directiveInject(De.w,8))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["field-picker-modern"]],viewQuery:function(i,s){if(1&i&&(e.\u0275\u0275viewQuery(zt,5),e.\u0275\u0275viewQuery(Wt,5)),2&i){var c=void 0;e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.dragDropPickerRef=c.first),e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.openFlyoutChevronQueryList=c)}},inputs:{initialExpr:"initialExpr",alwaysAllowAggregate:"alwaysAllowAggregate",aggregatesConstraint:"aggregatesConstraint",validators:"validators",allowReorderItems:"allowReorderItems",disallowReplaceItems:"disallowReplaceItems",allowMultipleValues:"allowMultipleValues",disableDropZoneIndicator:"disableDropZoneIndicator",disabled:"disabled",label:"label",addDataLabelKey:"addDataLabelKey",addDataAriaLabelKey:"addDataAriaLabelKey",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",withFieldList:"withFieldList",enterExitFieldRename:"enterExitFieldRename",allowEntityField:"allowEntityField",promotedActionStrategy:"promotedActionStrategy",getDropExprStrategy:"getDropExprStrategy",flyoutFieldsStrategy:"flyoutFieldsStrategy",directEditStrategy:"directEditStrategy",visualCalcFieldsStrategy:"visualCalcFieldsStrategy",menuStrategy:"menuStrategy",displayNameStrategy:"displayNameStrategy",externalCrossPickerDragDropMonitor:"externalCrossPickerDragDropMonitor",perspectiveDisplayName:"perspectiveDisplayName",tooltipPosition:"tooltipPosition",tooltipWithFlexiblePositions:"tooltipWithFlexiblePositions",disableAutoScroll:"disableAutoScroll",parameterPickerDataFormat:"parameterPickerDataFormat",visualCapabilities:"visualCapabilities",emptyFieldSetsDefaultLabel:"emptyFieldSetsDefaultLabel",role:"role",fieldListOverlayPanelClass:"fieldListOverlayPanelClass",allowClear:"allowClear",compact:"compact"},outputs:{onExprChange:"onExprChange",onCrossPickerDrop:"onCrossPickerDrop"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:5,consts:[["fieldPicker",""],[4,"ngIf"],["for","dragDropPickerRef","class","fluentTheme-sm-reg field-picker-label",4,"ngIf"],["id","dragDropPickerId",3,"compact","ariaLabelledby","dataFormat","disabled","placeholder","addDataLabelKey","addDataAriaLabelKey","draggable","allowEditingLabelsSetting","allowMultipleValues","allowClear","disableDropZoneIndicator","disableContentClick","pbiDragDropPickerActionsTemplate","itemPromotedActionTemplate","externalCrossPickerDragDropMonitor","v2Design","menuMode","useCustomTooltip","tooltipPosition","tooltipWithFlexiblePositions","disableAutoScroll","disableClearButtonTabNavigation","allowEmptyLabel","onChangeAdd","onChangeRemove","onChangeReorder","onChangeReplace","onChangeLabelUpdate","onCrossPickerDrop","onAddDataClick","onContentClick","onMenuItemClick","onClearButtonArrowRight"],["dragDropPickerRef",""],["promotedFieldActionTemplate",""],["pickerActionsTemplate",""],["for","dragDropPickerRef",1,"fluentTheme-sm-reg","field-picker-label"],[1,"pbi-drag-drop-picker-actions"],[1,"pbi-icon-button",3,"ngClass","click"],["tri-svg-icon-16","",3,"name","sprite","pbiTooltip"],["class","pbi-drag-drop-picker-actions",4,"ngIf"],["aria-hidden","true","class","button-divider",3,"ngClass",4,"ngIf"],["tabindex","-1","class","glyphicon pbi-glyph-chevronrightmedium glyph-mini pbi-focus-outline pbi-icon-button v2Design","aria-haspopup","true",3,"pbiTooltip","click","keydown.arrowLeft",4,"ngIf"],["class","pbi-focus-outline pbi-icon-button v2Design","tabindex","-1","aria-haspopup","true",3,"pbiTooltip","disabled","click","keydown.arrowLeft",4,"ngIf"],["class","glyphicon pbi-glyph-chevrondownsmall glyph-small pbi-focus-outline pbi-icon-button","aria-haspopup","true",3,"pbiTooltip","pbiMenu","menuMode","pbiMenuActivation","pbiMenuButtonClick",4,"ngIf"],["aria-hidden","true",1,"button-divider",3,"ngClass"],["tabindex","-1","aria-haspopup","true",1,"glyphicon","pbi-glyph-chevronrightmedium","glyph-mini","pbi-focus-outline","pbi-icon-button","v2Design",3,"pbiTooltip","click","keydown.arrowLeft"],["openFlyoutChevron",""],["tabindex","-1","aria-haspopup","true",1,"pbi-focus-outline","pbi-icon-button","v2Design",3,"pbiTooltip","disabled","click","keydown.arrowLeft"],["tri-svg-icon-16","",3,"name"],["aria-haspopup","true",1,"glyphicon","pbi-glyph-chevrondownsmall","glyph-small","pbi-focus-outline","pbi-icon-button",3,"pbiTooltip","pbiMenu","menuMode","pbiMenuActivation","pbiMenuButtonClick"]],template:function(i,s){1&i&&(e.\u0275\u0275elementStart(0,"div",null,0),e.\u0275\u0275template(2,en,11,34,"ng-container",1),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction1(3,tn,e.\u0275\u0275pipeBind1(3,1,s.fieldsView$))))},dependencies:[N.NgClass,N.NgIf,Q.HV,Bt.l8,Ve.V,Ge.M,N.AsyncPipe,d.F,Nt],styles:[".field-picker-label[_ngcontent-%COMP%]{display:inline-block;margin-bottom:4px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button{height:fit-content;width:fit-content;margin-left:12px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design{margin-left:4px;border-radius:2px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button:disabled tri-svg-icon{opacity:50%}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider{width:1px;background-color:var(--gray-130, #605E5C);margin-left:2px;margin-right:2px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider.error{background-color:var(--globalColorCranberryShade10)}"],changeDetection:0}),r}(Ne.w),ln=function(){function l(r,n,i,s,c,p,f,m,b,P){this.getCurrentMetadata=r,this.getDragDropPickerRef=n,this.alwaysAllowAggregate=i,this.aggregatesConstraint=s,this.validators=c,this.aggrOps=p,this.conceptualSchemaProxy=f,this.dataSourcesService=m,this.displayNameService=b,this.localizationService=P}return l.prototype.getDropExpr=function(r,n){var i,s,c=r;if(this.shouldAggregate(r,n)){var p=null!=(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.type)?[this.validators.field.type]:[];c=this.aggrOps.createExprWithAggregate(r,n,!0,p)}if(this.isValidDrop(c,n,!0))return Promise.resolve({expr:c})},l.prototype.getDroppedExprChildren=function(r,n,i,s){},l.prototype.getMenu=function(r,n,i,s){if(null!=r&&this.shouldShowPickerMenu(r,i)){var c={items:[]};if(this.shouldShowAggregationMenu(r,i)){var p=(0,Ce._L)(r);c.items=this.createAggregateMenuItems(r,p,i)}else{var f=this.getVariations(r,i);_.isEmpty(f)||(c.items=this.createVariationMenuItems(f,r,i))}return c}},l.prototype.menuItemClickHandler=function(r,n,i){return this.onMenuItemSelected(r,n,i)},l.prototype.getDisplayName=function(r,n,i,s){return Dt(r,i,this.displayNameService)},l.prototype.isRenameAllowed=function(r){return!1},l.prototype.isFieldInvalid=function(r,n){return!1},l.prototype.getFieldsToSelectOnOpen=function(r,n){if(n)return[n]},l.prototype.getFieldsToDisableOnOpen=function(r,n,i,s){},l.prototype.handleSelectedField=function(r,n){var i,s,c;return(0,y.__awaiter)(this,void 0,void 0,function(){var p,f,m=this;return(0,y.__generator)(this,function(b){switch(b.label){case 0:return E.fF.assertValue(r,"selectedField"),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return p=b.sent(),f={fieldExpr:Se.ib.serializeExpr(r),label:Dt(r,p,this.displayNameService)},E.fF.assert(function(){return _.size(n)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),E.fF.assert(function(){return _.size(n)<2||(0,ye.ez)((0,Q.X)(m.getCurrentMetadata(),n).expr)},"field-picker-modern second-level field should only be hierarchy levels"),n?null===(i=this.getDragDropPickerRef())||void 0===i||i.handleReplace(f,[n[0]]):null===(s=this.getDragDropPickerRef())||void 0===s||s.handleAdd(f),null===(c=this.getDragDropPickerRef())||void 0===c||c.detectChanges(),[2]}})})},l.prototype.handleDeselectedField=function(r){E.fF.assertValue(r,"deselectedField");var n=this.getCurrentMetadata();if(!_.isEmpty(n)){var i=(0,St.f)(r,n);if(!_.isEmpty(i)){var s=this.getDragDropPickerRef();s&&s.handleClear(i)}}},l.prototype.onCloseWithNewVisualCalc=function(r){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(n){return[2]})})},l.prototype.getVisualCalcCreationInfo=function(r){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(n){return[2,{supportVisualCalcCreation:!1}]})})},l.prototype.canOpenFlyout=function(r){return!0},l.prototype.rename=function(r,n){E.fF.assertFail("Expect this not to be called, rename is not allowed")},l.prototype.shouldAggregate=function(r,n){var i,s;return 1===(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.kind)&&!ze.m.discourageAggregation(r,n)},l.prototype.isValidDrop=function(r,n,i){var s;if(E.fF.assertValue(r,"expr"),!r)return!1;var c=r.getConceptualProperty(n),p=r.getMetadata(n);if(c?.kpiValue||!p)return!1;if(null!==(s=this.validators)&&void 0!==s&&s.field&&p?.kind!==this.validators.field.kind)return!1;var m=function(l){var r,n=null===(r=l?.field)||void 0===r?void 0:r.type;if(n)return n.variant||[n]}(this.validators);if(!_.isEmpty(m)&&!ct.Ge.isCompatibleTo(p?.type,m,!0))return!1;if(i){var P=this.getCurrentMetadata();if(_.some(P,function(M){return(0,ce.fS)(M.expr,r)}))return!1}return!0},l.prototype.shouldShowPickerMenu=function(r,n){return!!r&&!(0,ye.kb)(r)&&(this.shouldShowAggregationMenu(r,n)||!_.isEmpty(this.getVariations(r,n)))},l.prototype.createAggregateMenuItems=function(r,n,i){var s,c,p=null!=(null===(c=null===(s=this.validators)||void 0===s?void 0:s.field)||void 0===c?void 0:c.type)?[this.validators.field.type]:[],m=(0,Fe.Hh)(r,i,this.aggrOps,!1,this.alwaysAllowAggregate?We.DW.GroupingOrMeasure:We.DW.Measure,p,this.localizationService,void 0,void 0,this.aggregatesConstraint);return _.map(m,function(b){var P;return{text:b.text,type:be.iB.Button,data:b.key,checkable:!0,checked:(null===(P=b.key)||void 0===P?void 0:P.aggregate)===n}})},l.prototype.shouldShowAggregationMenu=function(r,n){return this.alwaysAllowAggregate&&!ze.m.discourageAggregation(r,n)||this.shouldAggregate(r,n)},l.prototype.onMenuItemSelected=function(r,n,i){r.checked=!r.checked,E.fF.assert(function(){return 1===_.size(n)},"default field-picker creates menu only for first level of items");var b,s=n[0],c=this.getCurrentMetadata(),p=_.map(c,function(O){return O.expr}),f=p[s],m=c[s].metadata;if(r.data instanceof Ce.Il)b=r.data;else{var P=r.data.aggregate;b=null==f?f:null==P?(0,lt.n)(f,i):(0,st.k)(f,P)}p[s]=b;var M=xt(n,m);return{newExpr:_.map(p,function(O,D){return{expr:O,metadata:c[D].metadata}}),fromUpdate:M}},l.prototype.getVariations=function(r,n){var i,s;if(0!==(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.kind))return[];var c=r;if((0,ye.ez)(r)&&!(c=(0,Re.ZB)(r)))return[];var p=(0,Re.wA)(n,c);if(!_.isArray(p)&&(0,ce.fS)(p,c))return[];var f=(0,Ee.rY)(p),m=[];this.isValidDrop(c,n,!1)&&m.push(c);for(var b=0,P=f;b<P.length;b++){var M=P[b];this.isValidDrop(M,n,!1)&&m.push(M)}return 1===m.length&&((0,ce.fS)(m[0],r)||(0,ce.fS)(m[0],c))?[]:m},l.prototype.createVariationMenuItems=function(r,n,i){var s=this;return _.map(r,function(c){return{text:s.displayNameService.getDisplayName(c,i,null),type:be.iB.Button,data:c,checkable:!0,checked:(0,ce.fS)(n,c)}})},l}();function yt(l){var r={fieldExpr:Se.ib.serializeExpr(l.pickerDataExpr),label:l.displayName.value,metadata:l.metadata,customTooltipContent:l.customTooltipContent,pbiStyle:l.displayName.pbiStyle,invalid:l.invalid},n=function(l){var r;return null!=l&&(l.invalid?r={type:1,sheet:"fluentui-icons",symbolId:"warning_20_regular",styles:{color:"var(--globalColorCranberryShade10)",fill:"currentColor"}}:(0,ye.jX)(l.expr)&&(r={type:1,sheet:"visual-calc-icons",symbolId:"data_histogram_function_20_regular"})),r}(l);null!=n&&(r.icon=n);var i=l.menu,s=!_.isEmpty(i?.items);return{pickerData:r,allowRename:l.allowRename,menuFactory:s?i:void 0,children:_.map(l.children,function(c){return yt(c)}),promotedAction$:l.promotedAction$,actionTooltip:l.actionTooltip}}function bt(l){return(0,y.__assign)((0,y.__assign)({},l.pickerData),{allowEditLabel:l.allowRename,menu:l.menuFactory,children:_.map(l.children,function(r){return bt(r)}),actionTooltip:l.actionTooltip})}function Pt(l,r,n,i,s){var m,c=l.displayName,p=function(l,r,n){var i;if(1===l.length)i=r;else{var s=l.slice(0,-1);i=(0,Q.X)(r,s).children}var f=function(l,r,n){if((0,xe.H2)(n))return l<_.last(n.deleted.position)?l:l+1;if((0,xe.JB)(n)){var i="end"===n.added.position?r-1:_.last(n.added.position);return l===i?void 0:l<i?l:l-1}if((0,xe.y$)(n))return l;if((0,xe.cS)(n)){var c=n.reordered.toPosition,p=mt(n.reordered.fromPosition.slice(0,-1),c.slice(0,-1));E.fF.assert(function(){return p},"Expect reordering only among siblings. Add your implementation for new scenario.");var f=_.last(n.reordered.fromPosition),m=_.last(n.reordered.toPosition);return l<f?l:f<=l&&l<m-1?l+1:l===m-1?f:l}if((0,xe.cA)(n))return l===_.last(n.replaced.position)?void 0:l;(0,xe.V5)(n)||E.fF.assertNever(n)}(_.last(l),_.size(i),n);if(null!=f)return l.slice(0,-1).concat(f)}(r,n,s);return null!=p&&(c=(0,Q.X)(i,p).displayName),_.isEmpty(l.children)||(m=[],_.forEach(l.children,function(b,P){var M=Pt(b,r.concat(P),n,i,s);m.push(M)})),(0,y.__assign)((0,y.__assign)({},l),{displayName:c,children:m})}function mt(l,r){return _.size(l)===_.size(r)&&_.every(l,function(n,i){return n===r[i]})}function Dt(l,r,n){return n.getDisplayName(l,r,void 0,void 0,void 0,{includeVariationSource:!0})}function xt(l,r){return{type:"replace",replaced:{position:l,originalMetadata:r}}}var yn=[{type:an,componentId:"FieldPickerComponentId"}],bn=function(){function l(){}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=e.\u0275\u0275defineNgModule({type:l}),l.\u0275inj=e.\u0275\u0275defineInjector({providers:(0,y.__spreadArray)((0,y.__spreadArray)([],J.U,!0),[t.D,V.J,H],!1),imports:[N.CommonModule,X.u5,F.N.withManifests(yn),A.v,G.K,B.C,ee.b,U.N,K.H,pe.Z,W.J,$.X,X.UX,j.T6]}),l}()},98476:function(Oe,Y,g){g.d(Y,{f:function(){return t}});var y=g(45413),N=g(74082);function X(V){return void 0!==V.pickerDataExpr}function t(V,F){for(var J,A=(0,N.ez)(V),G=F.length-1;G>=0;G--){var B=F[G],$=B.expr;if(A&&(0,N.y3)($)){var U,ee=G;if((U=X(B)?_.findIndex(B.children,function(K){return(0,y.fS)(K.expr,V)}):_.findIndex(B.hierarchyLevels,function(K){return(0,y.fS)(K.expr,V)}))>=0)return[ee,U]}if((0,N.iV)($)&&($=$.arg),(0,y.fS)($,V))return[G]}return J}},4722:function(Oe,Y,g){g.d(Y,{HV:function(){return ft},X:function(){return Ae},ri:function(){return ve}});var y=g(81337),N=g(64560),X=g(93247),t=g(50423),V=g(17174),F=g(62458),A=g(59694),J=g(14172),G=g(59973),B=g(22318),$=g(6663),ee=g(35497),U=g(65181),K=g(77476),pe=g(23097),W=g(59968),j=g(44581),R=g(24150),te=g(86663),ae=g(80357),le=g(45916),H=g(36858),e=g(85102),se=["dragDropPicker"],ue=["clearButton"],ke=["contentLabel"],qe=["listOfData"],et=function(){return[]},tt=function(a,o){return{nonEmptyDisplayDataList:a,isTopLevel:!0,rootToParentIndices:o}};function nt(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(),u=t.\u0275\u0275reference(5);t.\u0275\u0275property("ngTemplateOutlet",u)("ngTemplateOutletContext",t.\u0275\u0275pureFunction2(3,tt,o.listOfPbiDisplayData,t.\u0275\u0275pureFunction0(2,et)))}}function Q(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",8),t.\u0275\u0275listener("drop",function(v){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(C.handleDrop(v))})("dragover",function(v){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(!C.isItRedundantPositionToDropCurrentData("end")&&C.handleDragover(v))})("dragenter",function(){t.\u0275\u0275restoreView(o);var v=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(v.handleDragEnterListEndArea())})("dragleave",function(){t.\u0275\u0275restoreView(o);var v=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(v.handleDragLeaveListEndArea())}),t.\u0275\u0275elementEnd()}}var Fe=function(a){return{highlight:a}};function it(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20),t.\u0275\u0275listener("dragenter",function(){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().index,h=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(h.handleDragEnterPosition([C]))})("dragleave",function(){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().index,h=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(h.handleDragLeavePosition([C]))})("dragover",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(!h.isItRedundantPositionToDrop()&&h.handleDragover(C))})("drop",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(h.handleDrop(C))}),t.\u0275\u0275elementEnd()}if(2&d){var u=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Fe,u.highlight))}}function E(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function Ee(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function ce(d,a){1&d&&t.\u0275\u0275elementContainer(0)}var Re=function(a,o){return{nonEmptyDisplayDataList:a,isTopLevel:!1,rootToParentIndices:o}};function de(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(2),u=o.$implicit,v=o.index,C=t.\u0275\u0275nextContext().rootToParentIndices;t.\u0275\u0275nextContext();var h=t.\u0275\u0275reference(5);t.\u0275\u0275property("ngTemplateOutlet",h)("ngTemplateOutletContext",t.\u0275\u0275pureFunction2(2,Re,u.children,C.concat(v)))}}var ge=function(a,o,u){return{$implicit:a,position:o,field:u}};function rt(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(2),u=o.index,v=o.$implicit,C=t.\u0275\u0275nextContext().rootToParentIndices,h=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngTemplateOutlet",h.pbiDragDropPickerActionsTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(2,ge,h.picker,C.concat(u),v))}}var Ce=function(a){return{compact:a}},ye=function(a,o,u,v){return{isTopLevel:a,displayData:o,allowDrag:u,position:v}},ne=function(a){return{position:a}};function be(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",21)(2,"div",22),t.\u0275\u0275template(3,E,1,0,"ng-container",23),t.\u0275\u0275template(4,Ee,1,0,"ng-container",23),t.\u0275\u0275template(5,ce,1,0,"ng-container",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(6,de,1,5,"ng-container",24),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(7,rt,1,6,"ng-container",24),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext(),u=o.$implicit,v=o.index,C=t.\u0275\u0275reference(7),h=t.\u0275\u0275reference(11),w=t.\u0275\u0275nextContext(),x=w.isTopLevel,I=w.rootToParentIndices,T=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(9,Ce,T.compact)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",C)("ngTemplateOutletContext",t.\u0275\u0275pureFunction4(11,ye,x,u,!u.isEditing&&(T.draggable||!T.allowMultipleValues)&&x,I.concat(v))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",T.itemPromotedActionTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(16,ge,T.picker,I.concat(v),u)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",h)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(20,ne,I.concat(v))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",(null==u.children?null:u.children.length)>0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",x)}}function ot(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function Ie(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function at(d,a){1&d&&t.\u0275\u0275elementContainer(0)}var Be=function(a,o,u){return{isTopLevel:!0,displayData:a,allowDrag:o,position:u}};function lt(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,ot,1,0,"ng-container",23),t.\u0275\u0275template(2,Ie,1,0,"ng-container",23),t.\u0275\u0275template(3,at,1,0,"ng-container",23),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext(),u=o.$implicit,v=o.index,C=t.\u0275\u0275reference(7),h=t.\u0275\u0275reference(11),w=t.\u0275\u0275nextContext().rootToParentIndices,x=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",C)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(6,Be,u,!u.isEditing&&(x.draggable||!x.allowMultipleValues),w.concat(v))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",x.pbiDragDropPickerActionsTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(10,ge,x.picker,w.concat(v),u)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",h)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(14,ne,w.concat(v)))}}var Ne=function(a){return{width:a}};function Se(d,a){if(1&d&&t.\u0275\u0275element(0,"div",32),2&d){var o=t.\u0275\u0275nextContext().position;t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(1,Ne,8*(o.length-1)+"px"))}}function st(d,a){if(1&d&&t.\u0275\u0275element(0,"pbi-icon",33),2&d){var o=t.\u0275\u0275nextContext().displayData,u=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("name",o.icon.glyph)("size",u.smallIconSize)}}function ze(d,a){if(1&d&&t.\u0275\u0275element(0,"pbi-svg-use-symbol",34),2&d){var o=t.\u0275\u0275nextContext().displayData;t.\u0275\u0275property("ngStyle",o.icon.styles)("sheet",o.icon.sheet)("symbolId",o.icon.symbolId)}}function ct(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"input",35),t.\u0275\u0275listener("ngModelChange",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext().displayData;return t.\u0275\u0275resetView(h.value=C)})("keydown",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext().position,w=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(w.handleKeyDown(C,h))})("blur",function(){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().position,h=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(h.endEditSection(C))}),t.\u0275\u0275elementEnd()}if(2&d){var u=t.\u0275\u0275nextContext().displayData;t.\u0275\u0275property("ngModel",u.value)}}var We=function(a,o){return{showHover:a,interactable:o}};function He(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",25,26),t.\u0275\u0275listener("singleClickAction",function(){var I=t.\u0275\u0275restoreView(o).position;t.\u0275\u0275nextContext();var T=t.\u0275\u0275reference(3),L=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(L.v2Design&&!L.disableContentClick&&L.handleContentClick(T,I))})("doubleClickAction",function(){var I=t.\u0275\u0275restoreView(o).position,T=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(T.beginEditSection(I))})("accessible-click",function(){var I=t.\u0275\u0275restoreView(o).position;t.\u0275\u0275nextContext();var T=t.\u0275\u0275reference(3),L=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(L.v2Design&&!L.disableContentClick&&L.handleContentClick(T,I))})("keydown.F2",function(){var x=t.\u0275\u0275restoreView(o),I=x.displayData,T=x.position,L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(I.allowEditing&&!I.isEditing?L.beginEditSection(T):L.return)})("keydown.arrowRight",function(x){t.\u0275\u0275restoreView(o);var I=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(I.focusClearButton(x.target))})("contextmenu",function(x){t.\u0275\u0275restoreView(o);var I=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(I.onContextMenu(x))})("dragstart",function(x){var I=t.\u0275\u0275restoreView(o),T=I.allowDrag,L=I.position,_t=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(T&&_t.handleDragItemStart(x,L))})("dragend",function(){var I=t.\u0275\u0275restoreView(o).allowDrag,T=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(I&&T.handleDragItemEnd())})("dragover",function(x){var T=t.\u0275\u0275restoreView(o).allowDrag,L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(T&&!L.allowMultipleValues?L.handleDragover(x):L.return)})("drop",function(x){var T=t.\u0275\u0275restoreView(o).allowDrag,L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(T&&!L.allowMultipleValues?L.handleDrop(x):L.return)})("pbiMenuButtonClick",function(x){var T=t.\u0275\u0275restoreView(o).position,L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(L.handleMenuItemClick(x,T))}),t.\u0275\u0275template(2,Se,1,3,"div",27),t.\u0275\u0275elementStart(3,"div",28),t.\u0275\u0275template(4,st,1,2,"pbi-icon",29),t.\u0275\u0275template(5,ze,1,3,"pbi-svg-use-symbol",30),t.\u0275\u0275template(6,ct,1,1,"input",31),t.\u0275\u0275elementEnd()()}if(2&d){var u=a.displayData,v=a.isTopLevel;t.\u0275\u0275nextContext();var C=t.\u0275\u0275reference(9),h=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("id","contentLabelId"+h.uid)("ngClass",t.\u0275\u0275pureFunction2(28,We,u.interactionAvailable&&!u.isEditing&&!h.disableHover,u.interactionAvailable))("ngStyle",u.pbiStyle)("disabled",h.v2Design&&null==u.menu)("pbiMenu",h.v2Design?u.menu:null)("menuMode",null!=h.menuMode?h.menuMode:h.CompactMenuMode)("pbiMenuActivation",h.v2Design&&u.menu?"contextmenu":null)("draggable",!u.isEditing&&h.draggable&&!h.disabled)("singleClickDisabled",u.isEditing)("pbiTooltip",C)("pbiTooltipDisabled",h.disableHover)("pbiTooltipPosition",h.calculatedTooltipPosition)("pbiTooltipWithFlexiblePositions",h.tooltipWithFlexiblePositions)("doubleClickDisabled",!u.allowEditing||u.isEditing)("accessible-click-ignore-mouse",!0)("accessible-click-ignore-tabindex",!h.v2Design&&!u.allowEditing),t.\u0275\u0275attribute("role",h.v2Design?"button":null)("aria-haspopup",!!h.v2Design||null)("aria-labelledby",h.ariaLabelledby+" contentLabelId"+h.uid),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!v),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitch",null==u.icon?null:u.icon.type),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitchCase",h.PbiIconGlyphKind),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitchCase",h.PbiIconSvgKind),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbiEditableLabel",h.editableLabelOptions)("pbiEditableLabelValue",u.value)("pbiEditableLabelMode",u.isEditing)("pbiEditableLabelEditable",u.isEditing)("pbiEditableLabelClasses",h.editableLabelClasses)}}function Ue(d,a){if(1&d&&t.\u0275\u0275element(0,"div",38),2&d){var o=t.\u0275\u0275nextContext(2).$implicit;t.\u0275\u0275property("textContent",o.customTooltipContent.description)}}function Te(d,a){if(1&d&&(t.\u0275\u0275element(0,"div",36),t.\u0275\u0275template(1,Ue,1,1,"div",37)),2&d){var o=t.\u0275\u0275nextContext().$implicit,u=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("textContent",u.useCustomTooltip?null==o.customTooltipContent?null:o.customTooltipContent.title:o.value),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",u.useCustomTooltip&&(null==o.customTooltipContent?null:o.customTooltipContent.description))}}function dt(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",40,41),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext().position,w=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(w.handleClear(h))})("keydown.arrowLeft",function(h){t.\u0275\u0275restoreView(o);var w=t.\u0275\u0275nextContext(4);return t.\u0275\u0275resetView(w.focusContentLabel(h.target))})("keydown.arrowRight",function(h){t.\u0275\u0275restoreView(o);var w=t.\u0275\u0275nextContext().position,x=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(x.handleClearButtonArrowRight(h.target,w))}),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275elementEnd()}if(2&d){var u=t.\u0275\u0275nextContext(2).$implicit,v=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("tabindex",v.disableClearButtonTabNavigation?-1:0)("pbiTooltip",t.\u0275\u0275pipeBind1(2,3,"FieldPicker_RemoveData"))("aria-label",u.removeDataAriaLabel)}}function Ke(d,a){if(1&d&&t.\u0275\u0275template(0,dt,3,5,"button",39),2&d){var o=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngIf",o.allowClear&&!o.disabled)}}function Le(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,it,1,3,"div",14),t.\u0275\u0275elementStart(2,"span",15,16),t.\u0275\u0275template(4,be,8,22,"ng-container",13),t.\u0275\u0275template(5,lt,4,16,"ng-container",13),t.\u0275\u0275template(6,He,7,31,"ng-template",null,17,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(8,Te,2,2,"ng-template",null,18,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(10,Ke,1,1,"ng-template",null,19,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&d){var o=a.$implicit,u=t.\u0275\u0275nextContext().isTopLevel,v=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",u),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("error",o.invalid),t.\u0275\u0275attribute("role",v.v2Design?"listitem":null)("aria-level",v.v2Design?1:null)("aria-setsize",v.v2Design?1:null)("aria-posinset",v.v2Design?1:null),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",v.v2Design),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!v.v2Design)}}function Pe(d,a){if(1&d&&t.\u0275\u0275element(0,"div",42),2&d){var o=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Fe,o.shouldHighlightLastItemBottom))}}var De=function(a){return{showListEndDropZone:a}};function pt(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementContainer(1,7),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext().nonEmptyDisplayDataList;t.\u0275\u0275nextContext();var u=t.\u0275\u0275reference(9);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",u)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(2,De,o.length>0))}}var $e=function(a){return{childrenContentContainer:a}};function je(d,a){if(1&d&&(t.\u0275\u0275elementStart(0,"div",9,10),t.\u0275\u0275template(2,Le,12,9,"ng-container",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,Pe,1,3,"div",12),t.\u0275\u0275template(4,pt,2,4,"ng-container",13)),2&d){var o=a.nonEmptyDisplayDataList,u=a.isTopLevel,v=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,$e,!u)),t.\u0275\u0275attribute("role",v.v2Design?"list":null),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",o),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!v.v2Design||!v.allowMultipleValues),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",v.v2Design&&v.allowMultipleValues&&u)}}function Qe(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",44),t.\u0275\u0275listener("drop",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(h.handleDrop(C))})("dragover",function(C){t.\u0275\u0275restoreView(o);var h=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(h.handleDragover(C))}),t.\u0275\u0275elementStart(1,"label"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd()()}if(2&d){var u=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",u.placeholder),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(u.placeholder)}}function Ze(d,a){if(1&d&&t.\u0275\u0275template(0,Qe,3,2,"span",43),2&d){var o=t.\u0275\u0275nextContext(),u=t.\u0275\u0275reference(9);t.\u0275\u0275property("ngIf",!o.v2Design)("ngIfElse",u)}}function ut(d,a){if(1&d&&t.\u0275\u0275element(0,"div",50),2&d){var o=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Fe,o.shouldHighlightLastItemBottom))}}function gt(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",46,47),t.\u0275\u0275listener("accessible-click",function(w){t.\u0275\u0275restoreView(o);var x=t.\u0275\u0275reference(1),I=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(I.handleAddDataClick(w,x))})("drop",function(w){t.\u0275\u0275restoreView(o);var x=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(x.handleDrop(w))})("dragenter",function(){t.\u0275\u0275restoreView(o);var w=t.\u0275\u0275nextContext().showListEndDropZone,x=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(w?x.handleDragEnterListEndArea():x.return)})("dragleave",function(){t.\u0275\u0275restoreView(o);var w=t.\u0275\u0275nextContext().showListEndDropZone,x=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(w?x.handleDragLeaveListEndArea():x.return)})("dragover",function(w){t.\u0275\u0275restoreView(o);var x=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(x.handleDragOverAddDataArea(w))}),t.\u0275\u0275template(2,ut,1,3,"div",48),t.\u0275\u0275element(3,"label",49),t.\u0275\u0275pipe(4,"localize"),t.\u0275\u0275elementEnd()}if(2&d){var C,u=t.\u0275\u0275nextContext().showListEndDropZone,v=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(8,Ce,v.compact)),t.\u0275\u0275attribute("aria-labelledby",v.ariaLabelledby+" addDataLabelId"+v.uid),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",u),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate("localize",v.addDataLabelKey),t.\u0275\u0275property("id","addDataLabelId"+v.uid),t.\u0275\u0275attribute("aria-label",null!==(C=v.addDataAriaLabelKey)&&void 0!==C?C:t.\u0275\u0275pipeBind1(4,6,"Add_Data"))}}function Xe(d,a){if(1&d&&t.\u0275\u0275template(0,gt,5,10,"span",45),2&d){var o=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngIf",o.v2Design)}}var vt=function(a,o,u,v,C){return{empty:a,disabled:o,v2Design:u,disableDropZoneIndicator:v,compact:C}},ft=function(){function d(a,o){this.changeDetectorRef=a,this.localizationService=o,this.CompactMenuMode=N.Kb.Compact,this.PbiIconGlyphKind=0,this.PbiIconSvgKind=1,this.listOfPbiDisplayData=[],this.smallIconSize="small",this.shouldHighlightLastItemBottom=!1,this.draggingToPosition="end",this.allowClear=!0,this.data=[],this.dataFormat="text",this.allowMultipleValues=!1,this.allowEditingLabelsSetting="allDisallow",this.v2Design=!1,this.onChangeAdd=new t.EventEmitter,this.onChangeRemove=new t.EventEmitter,this.onChangeReorder=new t.EventEmitter,this.onChangeReplace=new t.EventEmitter,this.onChangeLabelUpdate=new t.EventEmitter,this.onCrossPickerDrop=new t.EventEmitter,this.onAddDataClick=new t.EventEmitter,this.onContentClick=new t.EventEmitter,this.onMenuItemClick=new t.EventEmitter,this.onClearButtonArrowRight=new t.EventEmitter,this.editableLabelClasses=["fluentTheme-md-reg","trimmedTextWithEllipsis"],this.uid=ee.q.generateShortId(4)}return d.prototype.ngOnInit=function(){var a,o;this.disableHover=!0,this.allowClear=null===(a=this.allowClear)||void 0===a||a,this.addDataLabelKey=null!==(o=this.addDataLabelKey)&&void 0!==o?o:"Plus_Add_Data",this.editableLabelClasses=this.v2Design?["fluentTheme-sm-reg","trimmedTextWithEllipsis"]:["fluentTheme-md-reg","trimmedTextWithEllipsis"],this.editableLabelOptions={customTooltip:!0,disableClick:!0,inputMatchLabelWidth:!1},this.calculatedTooltipPosition=this.tooltipPosition?this.tooltipPosition:this.allowMultipleValues?"before":"above"},d.prototype.ngAfterViewInit=function(){var a=this;this.dragDropPicker.nativeElement.addEventListener("mousemove",function u(){F.fF.assert(function(){return a.disableHover},"Expect hover is disabled"),a.disableHover=!1,a.dragDropPicker.nativeElement.removeEventListener("mousemove",u)}),!this.disableAutoScroll&&(this.scrollToViewSubscription=this.listOfDataAsQueryList.changes.pipe((0,J.U)(function(u){return u.toArray()}),(0,G.h)(function(){return a.allowMultipleValues}),(0,B.O)([]),(0,$.G)()).subscribe(function(u){var v=u[0],C=u[1];null!=a.scrollToIndex&&C?.length>0&&v.length<C.length&&C[a.scrollToIndex].nativeElement.scrollIntoView(),a.resetHighlight(),a.resetDraggingIndex(),a.scrollToIndex=null}))},d.prototype.ngOnDestroy=function(){var a;null===(a=this.scrollToViewSubscription)||void 0===a||a.unsubscribe()},d.prototype.endEditSection=function(a){var o=this.getDisplayDataAtPosition(a);if(o.allowEditing){if(!o.isEditing)return void F.fF.assertFail("Pbi-drag-drop-picker: Attempting to end editing when you are NOT in edit mode");o.isEditing=!1;var u=this.getDataAtPosition(a);F.fF.assertValue(u,"Expect data at the given position exists");var C,v=o.value;if("string"==typeof u){if((0,A.g)(o.value))return void(o.value=u);u!==v&&(C=v)}else{if(!this.allowEmptyLabel&&(0,A.g)(o.value))return void(o.value=u.label);u.label!==v&&(C=(0,y.__assign)((0,y.__assign)({},u),{label:v}))}C&&(this.setDataAtPosition(a,C),this.propagateChange&&this.propagateChange(this.data),this.onChangeLabelUpdate.emit({newLabel:v,position:a}))}},d.prototype.handleKeyDown=function(a,o){(a.keyCode===X.hY||a.keyCode===X.K5)&&!(0,X.Vb)(a)&&this.endEditSection(o),a.stopPropagation()},d.prototype.beginEditSection=function(a){var o=this.getDisplayDataAtPosition(a);if(o.allowEditing){if(o.isEditing)return void F.fF.assertFail("Pbi-drag-drop-picker: Attempting to edit when you are already in edit mode");o.isEditing=!0}},d.prototype.detectChanges=function(){this.changeDetectorRef.detectChanges()},d.prototype.writeValue=function(a){this.data=[],this.listOfPbiDisplayData=[];for(var o=0,u=a;o<u.length;o++)this.addData(u[o])},d.prototype.registerOnChange=function(a){this.propagateChange=a},d.prototype.registerOnTouched=function(a){},d.prototype.setDisabledState=function(a){this.disabled=a},d.prototype.handleDragItemStart=function(a,o){var u,v;if(this.draggable){this.disableHover=!0,this.draggingFromPosition=o;var C={fromGroupId:null===(u=this.externalCrossPickerDragDropMonitor)||void 0===u?void 0:u.groupId,fromComponentId:null===(v=this.externalCrossPickerDragDropMonitor)||void 0===v?void 0:v.componentId,fromPosition:o,data:this.getDataAtPosition(o)};a.dataTransfer.setData(this.dataFormat,JSON.stringify(C))}},d.prototype.handleDragItemEnd=function(){this.disableHover=!1,this.resetDraggingIndex()},d.prototype.handleDragover=function(a){a.preventDefault()},d.prototype.handleDragOverAddDataArea=function(a){var o;this.allowMultipleValues&&0!==this.listOfPbiDisplayData.length?(null===(o=this.draggingFromPosition)||void 0===o?void 0:o[0])!==this.listOfPbiDisplayData.length-1&&this.handleDragover(a):this.handleDragover(a)},d.prototype.handleDragLeavePosition=function(a){this.getDisplayDataAtPosition(a).highlight=!1},d.prototype.handleDragEnterPosition=function(a){this.draggable&&(this.draggingToPosition=a,!this.isItRedundantPositionToDrop(this.draggingFromPosition,a))&&(this.getDisplayDataAtPosition(a).highlight=!0)},d.prototype.handleAddDataClick=function(a,o){this.v2Design&&this.onAddDataClick.emit({type:a.type,overlayOrigin:o})},d.prototype.handleContentClick=function(a,o){var u=this;F.fF.assert(function(){return!u.disableContentClick},"Expect this not to be called if disableContentClick is true"),this.v2Design&&this.onContentClick.emit({overlayOrigin:a,position:o})},d.prototype.handleMenuItemClick=function(a,o){this.v2Design&&this.onMenuItemClick.emit({menuButton:a,position:o})},d.prototype.onContextMenu=function(a){a.stopPropagation(),a.preventDefault()},d.prototype.focusClearButton=function(a){if(this.clearButtonQueryList){var o=this.contentLabelQueryList.toArray().findIndex(function(u){return u.nativeElement===a});this.clearButtonQueryList.get(o).nativeElement.focus()}},d.prototype.focusContentLabel=function(a){if(this.contentLabelQueryList){var o=this.clearButtonQueryList.toArray().findIndex(function(u){return u.nativeElement===a});this.contentLabelQueryList.get(o).nativeElement.focus()}},d.prototype.handleClearButtonArrowRight=function(a,o){this.onClearButtonArrowRight.emit({currentFocusedClearButton:a,topLevelIndex:_.first(o)})},d.prototype.doesCurrentDragDropReorderItems=function(){return this.doesMoveLocationReorderItems(this.draggingFromPosition,this.draggingToPosition)},d.prototype.doesMoveLocationReorderItems=function(a,o){if(!a)return!1;F.fF.assert(function(){return 1===_.size(a)},"we ONLY handle drag-drop into first level position as of now. Add your implementation for new scenario."),F.fF.assert(function(){return"end"===o||1===_.size(o)},"we ONLY handle drag-drop into first level position as of now. Add your implementation for new scenario.");var u=a[0],v=_.isArray(o)?o[0]:o;return v!==u&&("end"===v?u!==_.size(this.data)-1:v-1!==u)},d.prototype.isItRedundantPositionToDrop=function(a,o){return!!a&&!this.doesMoveLocationReorderItems(a,o)},d.prototype.isItRedundantPositionToDropCurrentData=function(a){return this.isItRedundantPositionToDrop(this.draggingFromPosition,a)},d.prototype.resetHighlight=function(){if(this.draggingFromPosition){var a=this.getDisplayDataAtPosition(this.draggingFromPosition);a&&(a.highlight=!1)}if("end"!==this.draggingToPosition){var o=this.getDisplayDataAtPosition(this.draggingToPosition);o&&(o.highlight=!1)}this.shouldHighlightLastItemBottom=!1},d.prototype.reorderItemsInternal=function(a,o){var u=this;F.fF.assert(function(){return null!=a&&_.inRange(a,0,_.size(u.data))},"expect 0 <= fromIndex < itemsCount"),F.fF.assert(function(){return null!=o&&_.inRange(o,0,_.size(u.data)+1)},"expect 0 <= toIndex <= itemsCount"),a<o&&o--;var v=this.data.splice(a,1)[0];this.data.splice(o,0,v);var C=this.listOfPbiDisplayData.splice(a,1)[0];this.listOfPbiDisplayData.splice(o,0,C),this.propagateChange&&this.propagateChange(this.data)},d.prototype.resetDraggingIndex=function(){this.draggingFromPosition=void 0,this.draggingToPosition="end"},d.prototype.handleDragEnterListEndArea=function(){this.shouldHighlightLastItemBottom=null==this.draggingFromPosition||_.size(this.draggingFromPosition)>1||this.draggingFromPosition[0]!==this.data.length-1,this.draggingToPosition="end"},d.prototype.handleDragLeaveListEndArea=function(){this.shouldHighlightLastItemBottom=!1},d.prototype.handleDrop=function(a){if(a.preventDefault(),a.stopPropagation(),null==this.draggingFromPosition){var o=a.dataTransfer.types;F.fF.assert(function(){return _.size(o)<=1},"We set one drag data format at most in the dragstart event");var u=_.first(o),v=a.dataTransfer.getData(u);if(v){var C=void 0;try{C=JSON.parse(v)}catch{}var h=void 0;if("object"==typeof C)if(function(d){return!!d&&d.hasOwnProperty("fromGroupId")&&d.hasOwnProperty("fromComponentId")&&d.hasOwnProperty("fromPosition")&&d.hasOwnProperty("data")}(C)){if(h=C.data,this.externalCrossPickerDragDropMonitor&&(this.externalCrossPickerDragDropMonitor.groupId!==C.fromGroupId||this.externalCrossPickerDragDropMonitor.componentId!==C.fromComponentId))return this.onCrossPickerDrop.emit({fromGroupId:C.fromGroupId,fromComponentId:C.fromComponentId,fromPosition:C.fromPosition,toGroupId:this.externalCrossPickerDragDropMonitor.groupId,toComponentId:this.externalCrossPickerDragDropMonitor.componentId,toPosition:this.draggingToPosition}),void this.resetHighlight()}else h=C;else h=v;this.handleAdd(h,this.draggingToPosition)}}else this.handleReorder(this.draggingFromPosition,this.draggingToPosition)},d.prototype.handleClear=function(a,o){void 0===o&&(o=!1);var u=Ve(this.data,a);Ve(this.listOfPbiDisplayData,a),u?(this.propagateChange&&this.propagateChange(this.data),o||this.onChangeRemove.emit({data:u,position:a})):F.fF.assertFail("expect position to be valid")},d.prototype.handleAdd=function(a,o){void 0===o&&(o="end"),this.allowMultipleValues||_.isEmpty(this.data)||"end"!==o&&1!==o.length?(this.addReplaceDataInternal(a,o,!1),this.propagateChange&&this.propagateChange(this.data),this.onChangeAdd.emit({data:a,position:o})):this.handleReplace(a,[0])},d.prototype.handleReplace=function(a,o){this.addReplaceDataInternal(a,o,!0),this.propagateChange&&this.propagateChange(this.data),this.onChangeReplace.emit({data:a,position:o})},d.prototype.addData=function(a){this.addReplaceDataInternal(a,"end",!1)},d.prototype.replaceData=function(a,o){this.addReplaceDataInternal(a,o,!0)},d.prototype.setAllData=function(a){var o=[],u=[];if(!_.isEmpty(a)&&_.every(a,function(x){return!!x}))for(var v=0,C=a;v<C.length;v++){var h=C[v],w=this.getPbiDisplayData(h,this.allowEditingLabelsSetting);if(!w)return;o.push(h),u.push(w)}this.data=o,this.listOfPbiDisplayData=u},d.prototype.handleReorder=function(a,o){var u=this;F.fF.assert(function(){return 1===_.size(a)},"We ONLY support reordering in first-level right now. Add your implementation for new scenario."),F.fF.assert(function(){return"end"===o||1===_.size(o)},"We ONLY support reordering in first-level right now. Add your implementation for new scenario.");var v=a[0],C=_.isArray(o)?o[0]:o;if(F.fF.assert(function(){return null!=v&&_.inRange(v,0,_.size(u.data))},"expect fromIndex to be in valid range"),F.fF.assert(function(){return null!=C&&("end"===C||_.inRange(C,0,_.size(u.data)))},"expect toIndex to be in valid range"),this.resetHighlight(),this.doesMoveLocationReorderItems(a,o)){var h="end"!==C?C:_.size(this.data);this.reorderItemsInternal(v,h),this.onChangeReorder.emit({data:this.data[v],fromPosition:a,toPosition:[h]})}},d.prototype.addReplaceDataInternal=function(a,o,u){if(a){F.fF.assert(function(){return"end"===o||1===_.size(o)},"we ONLY handle add/replace first level position data as of now. Add your implementation for new scenario."),F.fF.assert(function(){return!u||"end"!==o[0]},"replacement index must be a valid number"),!this.allowMultipleValues&&!u&&(this.data.pop(),this.listOfPbiDisplayData.pop());var v=this.getPbiDisplayData(a,this.allowEditingLabelsSetting);if(v){this.resetHighlight();var C=u?1:0;if("end"!==o){var h=o[0];this.data.splice(h,C,a),this.listOfPbiDisplayData.splice(h,C,v),this.scrollToIndex=h}else this.data.push(a),this.scrollToIndex=this.data.length-1,this.listOfPbiDisplayData.push(v)}}},d.prototype.getDataAtPosition=function(a){return Ae(this.data,a)},d.prototype.setDataAtPosition=function(a,o){ve(this.data,a,function(u,v){u[v]=o})},d.prototype.getDisplayDataAtPosition=function(a){return Ae(this.listOfPbiDisplayData,a)},d.prototype.getPbiDisplayData=function(a,o){var v,u=this;if("string"==typeof a){if(""===a)return}else if(0===Object.keys(a).length)return;var C=(v="string"==typeof a?"allAllow"===o:"allAllow"===o||"varyByItem"===o&&!!a.allowEditLabel)||this.v2Design&&!this.disableContentClick||this.v2Design&&"string"!=typeof a&&!!a.menu;return"string"==typeof a?{value:a,allowEditing:v,isEditing:!1,highlight:!1,interactionAvailable:C}:{value:a.label,icon:a.icon,allowEditing:v,isEditing:!1,highlight:!1,interactionAvailable:C,menu:a.menu,customTooltipContent:a.customTooltipContent,children:_.isEmpty(a.children)?void 0:_.map(a.children,function(w){return u.getPbiDisplayData(w,o)}),actionTooltip:a.actionTooltip,removeDataAriaLabel:this.localizationService.format("FieldPicker_RemoveField",a.label),pbiStyle:a.pbiStyle,invalid:a.invalid}},d.\u0275fac=function(o){return new(o||d)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(U.o))},d.\u0275cmp=t.\u0275\u0275defineComponent({type:d,selectors:[["pbi-drag-drop-picker"]],viewQuery:function(o,u){if(1&o&&(t.\u0275\u0275viewQuery(se,5),t.\u0275\u0275viewQuery(ue,5),t.\u0275\u0275viewQuery(ke,5),t.\u0275\u0275viewQuery(qe,5)),2&o){var v=void 0;t.\u0275\u0275queryRefresh(v=t.\u0275\u0275loadQuery())&&(u.dragDropPicker=v.first),t.\u0275\u0275queryRefresh(v=t.\u0275\u0275loadQuery())&&(u.clearButtonQueryList=v),t.\u0275\u0275queryRefresh(v=t.\u0275\u0275loadQuery())&&(u.contentLabelQueryList=v),t.\u0275\u0275queryRefresh(v=t.\u0275\u0275loadQuery())&&(u.listOfDataAsQueryList=v)}},inputs:{pbiDragDropPickerActionsTemplate:"pbiDragDropPickerActionsTemplate",itemPromotedActionTemplate:"itemPromotedActionTemplate",externalCrossPickerDragDropMonitor:"externalCrossPickerDragDropMonitor",allowClear:"allowClear",data:"data",dataFormat:"dataFormat",disabled:"disabled",draggable:"draggable",placeholder:"placeholder",addDataLabelKey:"addDataLabelKey",addDataAriaLabelKey:"addDataAriaLabelKey",allowMultipleValues:"allowMultipleValues",allowEditingLabelsSetting:"allowEditingLabelsSetting",useCustomTooltip:"useCustomTooltip",tooltipPosition:"tooltipPosition",tooltipWithFlexiblePositions:"tooltipWithFlexiblePositions",disableAutoScroll:"disableAutoScroll",disableClearButtonTabNavigation:"disableClearButtonTabNavigation",allowEmptyLabel:"allowEmptyLabel",compact:"compact",disableDropZoneIndicator:"disableDropZoneIndicator",disableContentClick:"disableContentClick",v2Design:"v2Design",menuMode:"menuMode",ariaLabelledby:"ariaLabelledby"},outputs:{onChangeAdd:"onChangeAdd",onChangeRemove:"onChangeRemove",onChangeReorder:"onChangeReorder",onChangeReplace:"onChangeReplace",onChangeLabelUpdate:"onChangeLabelUpdate",onCrossPickerDrop:"onCrossPickerDrop",onAddDataClick:"onAddDataClick",onContentClick:"onContentClick",onMenuItemClick:"onMenuItemClick",onClearButtonArrowRight:"onClearButtonArrowRight"},features:[t.\u0275\u0275ProvidersFeature([{provide:V.JU,useExisting:(0,t.forwardRef)(function(){return d}),multi:!0}])],decls:10,vars:10,consts:[[1,"drag-drop-picker",3,"ngClass"],["dragDropPicker",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["class","dropArea unselectable",3,"drop","dragover","dragenter","dragleave",4,"ngIf"],["nonEmptyDisplayDataListTemplate",""],["showPlaceholder",""],["addData",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"dropArea","unselectable",3,"drop","dragover","dragenter","dragleave"],[3,"ngClass"],["listOfData",""],[4,"ngFor","ngForOf"],["class","dropBetween unselectable",3,"ngClass",4,"ngIf"],[4,"ngIf"],["class","dropBetween unselectable",3,"ngClass","dragenter","dragleave","dragover","drop",4,"ngIf"],[1,"content"],["contentContainer",""],["contentLabelTemplate",""],["tooltipTemplateRef",""],["clearButtonTemplate",""],[1,"dropBetween","unselectable",3,"ngClass","dragenter","dragleave","dragover","drop"],[1,"selfAndChildrenContent"],[1,"selfLevelContentContainer",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["customClick","","pbiTooltipAlwaysShow","true",1,"contentWithIndentationContainer",3,"id","ngClass","ngStyle","disabled","pbiMenu","menuMode","pbiMenuActivation","draggable","singleClickDisabled","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","pbiTooltipWithFlexiblePositions","doubleClickDisabled","accessible-click-ignore-mouse","accessible-click-ignore-tabindex","singleClickAction","doubleClickAction","accessible-click","keydown.F2","keydown.arrowRight","contextmenu","dragstart","dragend","dragover","drop","pbiMenuButtonClick"],["contentLabel",""],["class","indentation",3,"ngStyle",4,"ngIf"],[1,"content-label",3,"ngSwitch"],[3,"name","size",4,"ngSwitchCase"],[3,"ngStyle","sheet","symbolId",4,"ngSwitchCase"],["class","editableLabel","spellcheck","false",3,"ngModel","ngModelChange","keydown","blur",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable","pbiEditableLabelClasses"],[1,"indentation",3,"ngStyle"],[3,"name","size"],[3,"ngStyle","sheet","symbolId"],["spellcheck","false",1,"editableLabel",3,"ngModel","ngModelChange","keydown","blur"],[1,"tooltipTitle",3,"textContent"],["class","fieldTooltipDescription",3,"textContent",4,"ngIf"],[1,"fieldTooltipDescription",3,"textContent"],["class","glyphicon pbi-glyph-close glyph-mini content-clear pbi-focus-outline unselectable",3,"tabindex","pbiTooltip","aria-label","click","keydown.arrowLeft","keydown.arrowRight",4,"ngIf"],[1,"glyphicon","pbi-glyph-close","glyph-mini","content-clear","pbi-focus-outline","unselectable",3,"tabindex","pbiTooltip","aria-label","click","keydown.arrowLeft","keydown.arrowRight"],["clearButton",""],[1,"dropBetween","unselectable",3,"ngClass"],["class","placeholder","aria-readonly","true","tabIndex","0",3,"drop","dragover",4,"ngIf","ngIfElse"],["aria-readonly","true","tabIndex","0",1,"placeholder",3,"drop","dragover"],["data-testid","add-data-button","class","placeholder","tabIndex","0","role","button","aria-haspopup","true",3,"ngClass","accessible-click","drop","dragenter","dragleave","dragover",4,"ngIf"],["data-testid","add-data-button","tabIndex","0","role","button","aria-haspopup","true",1,"placeholder",3,"ngClass","accessible-click","drop","dragenter","dragleave","dragover"],["addDataButton",""],["class","dropBetween unselectable insidePlaceholder",3,"ngClass",4,"ngIf"],[1,"fluentTheme-sm-reg",3,"localize","id"],[1,"dropBetween","unselectable","insidePlaceholder",3,"ngClass"]],template:function(o,u){if(1&o&&(t.\u0275\u0275elementStart(0,"div",0,1),t.\u0275\u0275template(2,nt,1,6,"ng-container",2),t.\u0275\u0275template(3,Q,1,0,"div",3),t.\u0275\u0275template(4,je,5,7,"ng-template",null,4,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(6,Ze,1,2,"ng-template",null,5,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(8,Xe,1,1,"ng-template",null,6,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()),2&o){var v=t.\u0275\u0275reference(7);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction5(4,vt,u.listOfPbiDisplayData.length<1,u.disabled,u.v2Design,u.disableDropZoneIndicator,u.compact)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",u.listOfPbiDisplayData.length>0)("ngIfElse",v),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!u.v2Design&&u.allowMultipleValues&&u.listOfPbiDisplayData.length>0)}},dependencies:[K.NgClass,K.NgForOf,K.NgIf,K.NgTemplateOutlet,K.NgStyle,K.NgSwitch,K.NgSwitchCase,pe.f,V.Fj,V.JJ,V.On,W.X,j.t,R.D,te._,ae.l8,le.R,H.V,e.F],styles:['[_nghost-%COMP%]{--contentBackgroundColor: var(--gray-30);--contentBorderColor: var(--gray-40);--colorActionButton: var(--gray-190);--colorItemHover: var(--gray-60);--grayBackgroundEmpty: var(--gray-20)}[data-legacy-theming=false]   [_nghost-%COMP%]{--contentBackgroundColor: var(--colorNeutralBackground3);--contentBorderColor: var(--colorNeutralStroke1);--colorActionButton: var(--colorNeutralForeground1);--colorItemHover: var(--colorNeutralBackground3Hover);--grayBackgroundEmpty: var(--colorNeutralBackground3)}.placeholder-gray-background[_nghost-%COMP%]   .drag-drop-picker.empty[_ngcontent-%COMP%]{background-color:var(--grayBackgroundEmpty);border:1px solid var(--grayBackgroundEmpty)}.pbi-drag-drop-picker-scrollbar[_nghost-%COMP%]   .drag-drop-picker[_ngcontent-%COMP%]{overflow-y:auto}.tooltipTitle[_ngcontent-%COMP%]{font-weight:700}.fieldTooltipDescription[_ngcontent-%COMP%]{max-width:240px;display:block;word-break:break-word;white-space:pre-wrap}.drag-drop-picker[_ngcontent-%COMP%]{display:flex;border:1px dashed var(--gray-130, #605E5C);border-radius:2px;flex-direction:column;--field-error-background-color: var(--globalColorCranberryTint60);--field-error-border-color: var(--globalColorCranberryShade10)}  [data-legacy-theming=false] .drag-drop-picker{--field-error-background-color: var(--colorDangerBackground1);--field-error-border-color: var(--colorDangerBorder1)}.drag-drop-picker.disabled[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.drag-drop-picker.v2Design[_ngcontent-%COMP%]{border:1px dashed var(--colorNeutralStrokeAccessible);background-color:var(--colorNeutralBackground1);height:100%;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground2);border-color:var(--colorNeutralStrokeAccessible);border-radius:3px;color:var(--colorNeutralForeground1);padding:2px;height:fit-content;display:flex;flex-direction:row;align-items:center}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content.error[_ngcontent-%COMP%]{border-color:var(--field-error-border-color);background-color:var(--field-error-background-color);color:var(--colorDangerForeground1)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow-x:hidden}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:row;align-items:center;box-sizing:border-box;height:24px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]{padding:0 2px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer.interactable[_ngcontent-%COMP%]{cursor:pointer}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer.showHover[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{height:24px;width:24px;display:flex;align-items:center;justify-content:center;margin:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]{height:16px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{height:16px;width:16px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .childrenContentContainer[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .childrenContentContainer[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{border:none;padding:0;margin:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);display:flex;justify-content:center;cursor:pointer;padding:0;margin:4px;line-height:28px;box-sizing:border-box;position:relative;border:1px solid var(--colorNeutralStrokeAccessible)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder.compact[_ngcontent-%COMP%]{line-height:20px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]   .dropBetween.insidePlaceholder[_ngcontent-%COMP%]{pointer-events:none;position:absolute;top:0;left:0;width:calc(100% - 8px)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground1Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;cursor:pointer;pointer-events:none;display:flex;align-items:center;justify-content:center}.drag-drop-picker.v2Design.disabled[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.5}.drag-drop-picker[_ngcontent-%COMP%]   div.dropBetween[_ngcontent-%COMP%]{height:4px;margin:0 4px}.drag-drop-picker[_ngcontent-%COMP%]   div.dropBetween.highlight[_ngcontent-%COMP%]{background-color:var(--theme-primary-color, #F2C811)}.drag-drop-picker[_ngcontent-%COMP%]   div.dropArea[_ngcontent-%COMP%]{flex:1;min-height:8px}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex:1;white-space:nowrap;overflow:hidden;padding:6px 8px;height:12px;border-radius:2px}.drag-drop-picker[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{color:var(--gray-90, #A19F9D)}.drag-drop-picker[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{margin:0 4px;border:1px solid var(--contentBorderColor);background-color:var(--contentBackgroundColor)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:8px;flex-shrink:0}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   pbi-svg-use-symbol[_ngcontent-%COMP%]{width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px);margin-right:8px;flex-shrink:0}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]{overflow:hidden;flex:1;display:flex;flex-direction:row}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer.showHover[_ngcontent-%COMP%]:hover{background-color:var(--colorItemHover)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]{display:flex;text-overflow:ellipsis;overflow:hidden;align-items:center;padding:0;flex:1;color:var(--colorNeutralForeground1)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{cursor:pointer;padding:0;border:0;background:transparent;margin-left:12px;color:var(--colorActionButton)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%], .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%], .drag-drop-picker   span   [_nghost-%COMP%]     .pbi-drag-drop-picker-actions button{box-sizing:border-box;border:solid 2px transparent;border-radius:2px;outline:none}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer.pbi-focus-outline[_ngcontent-%COMP%]:focus-visible, .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear.pbi-focus-outline[_ngcontent-%COMP%]:focus-visible, .drag-drop-picker   span   [_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.pbi-focus-outline:focus-visible{border-color:var(--gray-140, #484644)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]   pbi-text-label[_ngcontent-%COMP%]{outline:none;border:none}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]{border-style:solid}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{border-style:none}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]{height:26px}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]{height:18px}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{border-color:var(--colorNeutralStroke1)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions{align-self:stretch;display:flex;justify-content:space-evenly;align-items:center}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions>*{color:var(--gray-190, #201F1E)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design{margin:0;border:0;height:24px;width:24px;color:var(--colorNeutralForeground1);fill:var(--colorNeutralForeground1)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design:hover{background-color:var(--colorNeutralBackground3Hover)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider.v2Design{align-self:stretch;margin-top:4px;margin-bottom:4px;background-color:var(--colorNeutralStrokeAccessible)}[_nghost-%COMP%]     .compact button.v2Design{height:16px;width:16px}[_nghost-%COMP%]     .compact .button-divider.v2Design{margin-top:2px;margin-bottom:2px}[_nghost-%COMP%]     .content-label pbi-text-label{margin:0;padding:0;flex:1;overflow-x:hidden}[_nghost-%COMP%]     .content-label input{margin:0;padding:2px 0;width:100%}'],changeDetection:0}),d}();function Ae(d,a){return ve(d,a,function(o,u){return o[u]})}function Ve(d,a){return ve(d,a,function(o,u){return o.splice(u,1)[0]})}function ve(d,a,o){F.fF.assert(function(){return!_.isEmpty(a)},"the given position should contain at least one element");var u=a[0],v=_.nth(d,u);F.fF.assertAnyValue(v,"it is possible that currentLevelItem is undefined, e.g. when using this function to add an item after the last item in the collection at the lowest level of the position");var C=a.slice(1);return _.isEmpty(C)?o(d,u):v?"string"==typeof v?(F.fF.assertFail("string data should not have any child"),o(d,u)):ve(v.children,C,o):void F.fF.assertFail("trying to do something to a child of an item but the item does not exist")}},56598:function(Oe,Y,g){g.d(Y,{K:function(){return ee}});var y=g(20914),N=g(5806),X=g(94770),t=g(93367),V=g(94841),F=g(79725),A=g(16095),J=g(77476),G=g(17174),B=g(79061),$=g(50423),ee=function(){function U(){}return U.\u0275fac=function(pe){return new(pe||U)},U.\u0275mod=$.\u0275\u0275defineNgModule({type:U}),U.\u0275inj=$.\u0275\u0275defineInjector({imports:[J.CommonModule,N.Y,G.u5,B.v,y._,X.f,t.U,V.b,F.j,A.Z,G.UX]}),U}()},58679:function(Oe,Y,g){g.d(Y,{I:function(){return pe}});var y=g(65005),N=g(62458),X=g(9795),t=g(59017),V=g(59973),F=g(14172),A=g(81905),J=g(83317),G=g(48787),B=g(50423),$=g(84354),ee=function(){function W(j){this.pbiDropdownService=j,this.isOpen$=this.pbiDropdownService.select$("open");var R=this.pbiDropdownService.select$("dropdownItems"),te=this.pbiDropdownService.select$("overlayRef"),ae=R.pipe((0,V.h)(function(H){return!!H}),(0,F.U)(function(H){return N.fF.assert(function(){return 1===H.length},"Expected 1 FieldListComponent"),H.first})),le=ae.pipe((0,A.w)(function(H){return H.onFirstRenderComplete}));(0,t.aj)([this.isOpen$,te,ae,le]).pipe((0,J.R)(this.pbiDropdownService.onDestroy$),(0,V.h)(function(H){var se=H[1],ue=H[2];return H[0]&&!!se?.overlayRef.overlayElement&&!!ue})).subscribe(function(H){H[2].focusSearchBox()})}return W.prototype.buttonKeydown=function(j){var R=this;this.isOpen$.pipe((0,G.q)(1)).subscribe(function(te){te||(0,X.Wl)(j.keyCode)&&(R.pbiDropdownService.toggleOpenState(),j.preventDefault())})},W.\u0275fac=function(R){return new(R||W)(B.\u0275\u0275inject($.S))},W.\u0275prov=B.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac}),W}(),U=g(26333),K=g(31343),pe=function(){function W(j,R){this.pbiDropdownService=j,this.strategy=R}return W.prototype.ngAfterViewInit=function(){var j=this;(0,U.x)([{strategy:this.strategy,dropdownItems:this.dropdownItems}],K.N).subscribe(function(R){j.pbiDropdownService.updateState(R)})},W.\u0275fac=function(R){return new(R||W)(B.\u0275\u0275directiveInject($.S),B.\u0275\u0275directiveInject(ee))},W.\u0275dir=B.\u0275\u0275defineDirective({type:W,selectors:[["pbi-dropdown","dropdown-type","field-list"]],contentQueries:function(R,te,ae){var le;(1&R&&B.\u0275\u0275contentQuery(ae,y.l,5),2&R)&&(B.\u0275\u0275queryRefresh(le=B.\u0275\u0275loadQuery())&&(te.dropdownItems=le))},features:[B.\u0275\u0275ProvidersFeature([ee])]}),W}()}}]);