"use strict";

(self.webpackChunkdesktop = self.webpackChunkdesktop || []).push([ [ "extension-host-subfolder" ], {
    17299: function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {
        __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, {
            ExtensionHostSubfolderModule: function() {
                return ExtensionHostSubfolderModule;
            }
        });
        var common = __webpack_require__(77476), ngrx_effects = __webpack_require__(60756), tslib_es6 = __webpack_require__(81337), from = __webpack_require__(82762), throwError = __webpack_require__(60225), of = __webpack_require__(11547), switchMap = __webpack_require__(81905), map = __webpack_require__(14172), catchError = __webpack_require__(59822), index_core = __webpack_require__(97558), src = __webpack_require__(60397), host_proxy_src = __webpack_require__(17899), subfolder_src = __webpack_require__(37976), lazy_provider_service = __webpack_require__(6814), core = __webpack_require__(50423), telemetry_service = __webpack_require__(54323), ExtensionHostSubfolderEffects = function() {
            function ExtensionHostSubfolderEffects(actions$, messageBroker, telemetryService, lazyProvider) {
                var _this = this;
                this.actions$ = actions$, this.messageBroker = messageBroker, this.telemetryService = telemetryService, 
                this.lazyProvider = lazyProvider, this.onOpenSubfolderPickerDialogReceived$ = (0, 
                host_proxy_src.Av)(this.actions$, this.messageBroker, index_core.Vm.openSubfolderPickerDialog, function(config) {
                    return (0, from.D)(_this.lazyProvider.get("@powerbi/SubfolderPicker/subfolder-picker.module#SubfolderPickerModule", subfolder_src.cU)).pipe((0, 
                    switchMap.w)(function(subfolderPickerService) {
                        var _a, _b;
                        if (null === (_a = config.messageBarModel) || void 0 === _a ? void 0 : _a.link) {
                            var error = _this.validateLink(null === (_b = config.messageBarModel) || void 0 === _b ? void 0 : _b.link);
                            if (error) return (0, throwError._)(error);
                        }
                        return (0, from.D)(subfolderPickerService.openSubfolderPicker({
                            initialSubfolderId: config.initialSubfolderId,
                            title: config.title,
                            confirmButtonText: config.confirmButtonText,
                            allowSelectWorkspace: config.allowSelectWorkspace,
                            semanticInputLabelText: config.semanticInputLabelText,
                            semanticInputPlaceholder: config.semanticInputPlaceholder,
                            messageBarModel: config.messageBarModel,
                            allowSelectItemTypes: config.allowSelectItemTypes,
                            allowMultiSelection: config.allowMultiSelection,
                            hideNewButton: !config.showNewButton,
                            preSelectedItems: config.preSelectedItems,
                            visibleItemTypes: config.visibleItemTypes
                        })).pipe((0, map.U)(function(result) {
                            var _a, _b, _c, _d, _e, _f, _g, _h;
                            if (!result) return result;
                            var value = (0, tslib_es6.__assign)({}, result);
                            return result.selectedItems && (value.selectedItems = {
                                subfolders: null === (_a = result.selectedItems.subfolders) || void 0 === _a ? void 0 : _a.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                artifacts: null === (_b = result.selectedItems.artifacts) || void 0 === _b ? void 0 : _b.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                dashboards: null === (_c = result.selectedItems.dashboards) || void 0 === _c ? void 0 : _c.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                reports: null === (_d = result.selectedItems.reports) || void 0 === _d ? void 0 : _d.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                datasets: null === (_e = result.selectedItems.datasets) || void 0 === _e ? void 0 : _e.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                datamarts: null === (_f = result.selectedItems.datamarts) || void 0 === _f ? void 0 : _f.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                }),
                                workbooks: null === (_g = result.selectedItems.workbooks) || void 0 === _g ? void 0 : _g.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        packageId: _a.packageId
                                    };
                                }),
                                cdsaModels: null === (_h = result.selectedItems.cdsaModels) || void 0 === _h ? void 0 : _h.map(function(_a) {
                                    return {
                                        id: _a.id,
                                        objectId: _a.objectId
                                    };
                                })
                            }), result.selectedItemsMetadata && (value.selectedItemsMetadata = result.selectedItemsMetadata.map(function(_a) {
                                return {
                                    id: _a.id,
                                    objectId: _a.objectId,
                                    displayName: _a.displayName,
                                    type: _a.type
                                };
                            })), value;
                        }), (0, map.U)(function(value) {
                            return index_core.Vm.openSubfolderPickerDialog.resolve({
                                value
                            });
                        }));
                    }), (0, catchError.K)(function(error) {
                        return _this.telemetryService.logEvent({
                            name: "SubfolderAPI.openSubfolderPickerDialog",
                            properties: {
                                error
                            }
                        }), (0, of.of)(index_core.Vm.openSubfolderPickerDialog.reject({
                            error
                        }));
                    }));
                });
            }
            return ExtensionHostSubfolderEffects.prototype.validateLink = function(link) {
                var _a, protocol = (_a = new URL(link)).protocol, hostname = _a.hostname;
                return "https:" !== protocol ? new Error('The link url must start with "https://".') : hostname === window.location.hostname ? new Error("The link url must not contain fabric doamin.") : void 0;
            }, ExtensionHostSubfolderEffects.\u0275fac = function(t) {
                return new (t || ExtensionHostSubfolderEffects)(core["\u0275\u0275inject"](ngrx_effects.eX), core["\u0275\u0275inject"](src.u), core["\u0275\u0275inject"](telemetry_service.t), core["\u0275\u0275inject"](lazy_provider_service.rn));
            }, ExtensionHostSubfolderEffects.\u0275prov = core["\u0275\u0275defineInjectable"]({
                token: ExtensionHostSubfolderEffects,
                factory: ExtensionHostSubfolderEffects.\u0275fac
            }), ExtensionHostSubfolderEffects;
        }(), ExtensionHostSubfolderModule = function() {
            function ExtensionHostSubfolderModule() {}
            return ExtensionHostSubfolderModule.\u0275fac = function(t) {
                return new (t || ExtensionHostSubfolderModule);
            }, ExtensionHostSubfolderModule.\u0275mod = core["\u0275\u0275defineNgModule"]({
                type: ExtensionHostSubfolderModule
            }), ExtensionHostSubfolderModule.\u0275inj = core["\u0275\u0275defineInjector"]({
                imports: [ common.CommonModule, ngrx_effects.sQ.forFeature([ ExtensionHostSubfolderEffects ]) ]
            }), ExtensionHostSubfolderModule;
        }();
    }
} ]);