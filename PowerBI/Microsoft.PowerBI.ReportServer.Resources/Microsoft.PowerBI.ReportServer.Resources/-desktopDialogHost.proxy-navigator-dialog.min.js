"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["proxy-navigator-dialog"],{24387:function(te,b,s){s.r(b),s.d(b,{ProxyNavigatorDialogModule:function(){return Je}});var O=s(60693),d=s(81337),p=s(43045),A=s(36946);function L(t){return"Server"===t.modelObjectType}function M(t){return"Database"===t.modelObjectType}function z(t){return"Perspective"===t.modelObjectType}var x=s(62458),T=s(9738),u=s(70863);function D(t,e){if(function(t){return"Server"===t.modelObjectType}(t))for(var i=0,n=t.databases;i<n.length;i++){var o=n[i];e.push(o),D(o,e)}else if(function(t){return"Database"===t.modelObjectType}(t)){t.model&&(0,u.Ie)(t.model,e);for(var a=0,c=t.perspectives;a<c.length;a++)D(c[a],e)}else!function(t){return"Perspective"===t.modelObjectType}(t)?(0,u.Ie)(t,e):t.model&&(0,u.Ie)(t.model,e)}var C=s(31802),r=s(50423),V=function(){function t(e){this.checkingService=e}return t.prototype.check=function(e){var i=e.flatNode.node;this.checkingService.suspendNotification();var n=this.fetchDatabaseNodeForGivenTreeNode(i),o=n?.parent.children.find(function(a){return a.checked||a.isIndeterminate});n&&o&&n.data.name!==o.data.name&&this.deselectGivenNodeAndItsChildren(o),this.checkNodeRecursively(i,e.checked),this.checkingService.resumeNotification()},t.prototype.onChildrenAdded=function(e){e.checked&&this.checkNodeRecursively(e,!0)},t.prototype.checkNodeRecursively=function(e,i){var n=this;i?(0,C.r)([e],function(o){"Null"!==o.data.modelObjectType&&(n.checkingService.select(o.data,!1),o.isIndeterminate=!1)}):((0,C.r)([e],function(o){n.checkingService.deselect(o.data),o.isIndeterminate=!1}),this.normalizeSelection(e)),this.updateAncestorsCheckedAndIndeterminateState(e.parent)},t.prototype.deselectGivenNodeAndItsChildren=function(e){var i=this;(0,C.r)([e],function(n){i.checkingService.deselect(n.data),n.isIndeterminate=!1})},t.prototype.fetchDatabaseNodeForGivenTreeNode=function(e){return"Database"===e.data.modelObjectType?e:e.parent?this.fetchDatabaseNodeForGivenTreeNode(e.parent):void 0},t.prototype.normalizeSelection=function(e){if(0!==this.checkingService.selection.length){var i=this.fetchDatabaseNodeForGivenTreeNode(e);!i||!M(i.data)||this.uncheckAncestorsOfNodeIfNeeded(e.data,i.data)}},t.prototype.uncheckAncestorsOfNodeIfNeeded=function(e,i){var n=[];((0,u.vP)(e)||(0,u.wb)(e)||(0,u.t3)(e)||(0,u.kb)(e)||(0,u.y3)(e)||(0,u.jz)(e)||(0,u.ez)(e))&&(0,u.nP)(e,n);var o=n[n.length-1];x.fF.assert(function(){return!o||(0,u.vP)(o)},"last ancestor in a model must be a model");var a=i.perspectives.find(function(y){return y.model===o});a&&n.push(a),n.push(i),n.push(i.server);for(var c=[],l=0,h=n;l<h.length;l++){var f=h[l];if(D(f,c),this.hasSelectedDescendant(c))return;this.checkingService.isSelected(f)&&this.checkingService.deselect(f)}},t.prototype.hasSelectedDescendant=function(e){for(var i=0,n=e;i<n.length;i++)if(this.checkingService.isSelected(n[i]))return!0;return!1},t.prototype.updateAncestorsCheckedAndIndeterminateState=function(e){var i=this;e?.checkable&&(e.children.every(function(n){return i.checkingService.isSelected(n.data)})?(this.checkingService.select(e.data,!1),e.isIndeterminate=!1):e.children.some(function(n){return n.isIndeterminate})||this.nodeHasAnySelectedChildren(e)&&this.nodeHasAnyUnselectedChildren(e)?(e.checked=!1,e.isIndeterminate=!0):(e.checked=!0,e.isIndeterminate=!1),this.updateAncestorsCheckedAndIndeterminateState(e.parent))},t.prototype.nodeHasAnySelectedChildren=function(e){var n,i=this;return null===(n=e.children)||void 0===n?void 0:n.some(function(o){return i.checkingService.isSelected(o.data)})},t.prototype.nodeHasAnyUnselectedChildren=function(e){var n,i=this;return null===(n=e.children)||void 0===n?void 0:n.some(function(o){return!i.checkingService.isSelected(o.data)})},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(T.fc))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),E=function(){function t(){}return t.prototype.isCheckable=function(e){return!(L(e)||(0,u.t3)(e)||(0,u.kb)(e)||(0,u.y3)(e)||(0,u.ez)(e)||!(M(e)||z(e)||(0,u.wb)(e)))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac=function(i){return new(i||t)}}),t}(),N=function(){function t(){}return t.prototype.isEnabled=function(e){return!!(L(e)||M(e)||z(e))||1!==this.viewKind()},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac=function(i){return new(i||t)}}),t}(),oe=s(98209),R=s(35510),P=s(65181),K=function(){function t(e){this.localizationService=e,this.modelUpdates=new R.X({schema:void 0,model:void 0,appliedChanges:void 0})}return t.prototype.update=function(e,i){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(o){return n=new oe.O(this.localizationService).createModel(i,!1),this.modelUpdates.next({schema:i,model:n,appliedChanges:e}),[2]})})},Object.defineProperty(t.prototype,"modelChange$",{get:function(){return this.modelUpdates.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this.modelUpdates.value.model},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.modelUpdates.value.schema},enumerable:!1,configurable:!0}),t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(P.o))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),H=s(2142);var g=function(){function t(e){this.items=e}return t.prototype[Symbol.iterator]=function(){return this.getItems()[Symbol.iterator]()},t.prototype.contains=function(e){return this.getItems().some(function(i){return i===e})},t.prototype.filter=function(e){return this.getItems().filter(e)},t.prototype.getItems=function(){return this.items},t.prototype.find=function(e){return this.items.find(e)},t.prototype.findByName=function(e){return this.items.find(function(i){return i.name===e})},t.prototype.findByUrn=function(e){return this.items.find(function(i){return i.urn===e})},t.prototype.push=function(){for(var e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return(e=this.items).push.apply(e,i)},t.prototype.unshift=function(){for(var e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return(e=this.items).unshift.apply(e,i)},Object.defineProperty(t.prototype,"length",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),t}(),B=s(16789),$=function(){function t(e){this.defaultSearchStrategy=e}return t.prototype.applySearchState=function(e){this.defaultSearchStrategy.applySearchState({tree:e.tree,term:e.term})},t.prototype.search=function(e){var i=e.flatNodes,n=e.search;return i=i.filter(function(o){var a;return"Null"!==(null===(a=o.node.data)||void 0===a?void 0:a.modelObjectType)}),this.defaultSearchStrategy.search({flatNodes:i,search:n})},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(B.XI))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),pe=s(46227),U=s(65534),G=function(){function t(e,i){this.localizationService=e,this.modelObjectTooltipFactory=i,this.tooltipCaretSize="small",this.tooltipPosition="above"}return t.prototype.getTooltip=function(){return pe.x},t.prototype.getTooltipComponentData=function(e){var i=e.flatNode.node.data;switch(i.modelObjectType){case"Database":return this.populateTooltipForDatabase(i);case"Server":return this.populateTooltipForServer(i);case"Perspective":return this.populateTooltipForPerspective(i);default:return this.modelObjectTooltipFactory.getTooltipData(i)}},t.prototype.populateTooltipForServer=function(e){return[{title:this.localizationService.get("Name"),value:e.displayName},{title:this.localizationService.get("Databases"),value:this.localizationService.formatValue(e.databases.length)}]},t.prototype.populateTooltipForDatabase=function(e){return this.getRemoteModelTooltipData(e)},t.prototype.populateTooltipForPerspective=function(e){return this.getRemoteModelTooltipData(e)},t.prototype.getRemoteModelTooltipData=function(e){var i=e.model,n=[];return e.lastModifiedDate&&n.push({title:this.localizationService.get("Modified"),value:e.lastModifiedDate}),i&&(n.push({title:this.localizationService.get("Tables"),value:"".concat(i.tables.length)}),n.push({title:this.localizationService.get("TaskPane_Fields"),value:this.localizationService.formatValue(_.reduce(e.model.tables.getItems(),function(o,a){return o+a.measures.length+a.columns.length},0))})),e.description&&n.push({title:this.localizationService.get("Description"),value:e.description}),n},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(P.o),r.\u0275\u0275inject(U.n))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),X=s(32293),fe=s(12985),J=s(63898),he=s(19326),ve=s(9380),W=function(){function t(e,i){this.localizationService=e,this.featureSwitchService=i,this._fieldListTree$=new R.X(void 0),this.fieldListTree$=this._fieldListTree$.asObservable()}return Object.defineProperty(t.prototype,"fieldListTreeModel",{get:function(){return this._fieldListTree$.value},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e,i,n){var a=new J.l(this.localizationService,this.featureSwitchService,this.modelToPbiTreeConverterOptions).convertServerToPbiTreeNode(e,i);this.setTree({nodes:[a],parent:void 0}),this.updateChecked(n,!0)},t.prototype.updateNodeChildren=function(e,i,n){var o=new J.l(this.localizationService,this.featureSwitchService,this.modelToPbiTreeConverterOptions);i.children=o.convertModelToPbiTreeNodes(e,i),this.updateChecked(n,!0)},t.prototype.updateChecked=function(e,i){!this.fieldListTreeModel||void 0===e||((0,he.Z)(this.fieldListTreeModel,e,this.localizationService.get("FieldList_HasCheckedDecsendantsLabel"),!1),i&&this.updateIndeterminateCheckboxes(this.fieldListTreeModel.nodes),this.updateDisabled(),this.update())},t.prototype.updateIndeterminateCheckboxes=function(e){for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n];a.children&&(i.push.apply(i,a.children),a.checkable&&a.children.some(function(c){return c.checked})&&a.children.some(function(c){return!c.checked})&&(a.isIndeterminate=!0,a.checked=!1,this.updateAncestorsIndeterminateState(a.parent)))}i.length&&this.updateIndeterminateCheckboxes(i)},t.prototype.updateAncestorsIndeterminateState=function(e){e?.checkable&&(e.isIndeterminate=!0,e.checked=!1,this.updateAncestorsIndeterminateState(e.parent))},t.prototype.updateDisabled=function(){var e=this.fieldListTreeModel.nodes[0].children;e.every(function(i){return i.children.every(function(n){return"Perspective"===n.data.modelObjectType})})&&e.forEach(function(i){var n;null!==(n=i.children)&&void 0!==n&&n.some(function(o){return o.checked})?i.children.forEach(function(o){return o.disabled=!o.checked}):i.children.forEach(function(o){return o.disabled=!1})})},t.prototype.update=function(){this._fieldListTree$.next((0,d.__assign)({},this.fieldListTreeModel))},t.prototype.setTree=function(e){this._fieldListTree$.next(e)},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(P.o),r.\u0275\u0275inject(ve.vZ))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),Z=s(72525),Q=s(72193),k=s(78963),me=s(59725),ye=s(34763),Se=s(26898),be=s(29524),Te=s(88023),Ce=s(39119),Pe=function(){function t(e){this.hostService=e.getHostService("directLakeDesktopHostService")}return t.prototype.getDirectLakeAsync=function(e){return this.hostService.getDirectLake(e)},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275inject(Ce.j))},t.\u0275prov=r.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),Ie=s(58938),m=s(77476),Oe=s(59968),Me=s(37196),F=s(17174),Y=s(76492),xe=s(42189),De=s(9529),Ne=s(86663),q=s(68070),ke=s(45051),Fe=s(53833),je=s(44511),we=s(85102);function Ae(t,e){1&t&&r.\u0275\u0275elementContainer(0)}function Le(t,e){1&t&&r.\u0275\u0275elementContainer(0)}var ze=function(e){return{disabled:e}},ee=function(e){return{$implicit:e}};function Ve(t,e){if(1&t&&(r.\u0275\u0275elementStart(0,"pbi-dropdown-item",22),r.\u0275\u0275template(1,Le,1,0,"ng-container",3),r.\u0275\u0275elementEnd()),2&t){var i=e.$implicit;r.\u0275\u0275nextContext();var n=r.\u0275\u0275reference(33);r.\u0275\u0275property("value",i.key)("disabled",i.value.disabled())("ngClass",r.\u0275\u0275pureFunction1(5,ze,i.value.disabled())),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngTemplateOutlet",n)("ngTemplateOutletContext",r.\u0275\u0275pureFunction1(7,ee,i.value))}}function Ee(t,e){if(1&t&&(r.\u0275\u0275elementStart(0,"div",23),r.\u0275\u0275element(1,"pbi-icon",24),r.\u0275\u0275elementStart(2,"span"),r.\u0275\u0275text(3),r.\u0275\u0275elementEnd()()),2&t){var i=e.$implicit;r.\u0275\u0275advance(1),r.\u0275\u0275property("name",i.iconName),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(i.displayName)}}var Re=function(){function t(e,i,n,o,a,c,l,h,f,y,v,S,We,Ze,Qe,j,Ye,qe,et){var I=this;this.dialogRef=e,this.localizationService=i,this.conceptualSchemaProxy=n,this.captionSetting=o,this.draggableSetting=a,this.inlineItemsSetting=c,this.showMenuSetting=l,this.checkableSetting=h,this.enabledSetting=f,this.hiddenSetting=y,this.fieldListTreeService=v,this.modelService=S,this.checkStrategy=We,this.tooltipStrategy=Ze,this.directLakeService=Qe,this.searchStrategy=Ye,this.checkingService=qe,this.modernDialogService=et,this.subscription=new ye.w,this.checkMode=me.kH.Multi,this.canIncludeFutureArtifacts=!0,this.enableDisambiguationPreferences=!1,this.canSubmit=!1,this.canRefresh=!1,this.serverViewKindToViewInfoMappings=new Map,this.otherServerViewSelectionCache=[],this.fieldListTree$=this.fieldListTreeService.fieldListTree$,this.fieldListOptions={check:this.checkStrategy,search:this.searchStrategy,editLabel:null,tooltip:this.tooltipStrategy},this.pbiTreeNodeSettingOptions={captionSetting:this.captionSetting,draggableSetting:this.draggableSetting,inlineItemsSetting:this.inlineItemsSetting,enabledSetting:this.enabledSetting,showMenuSetting:this.showMenuSetting,checkableSetting:this.checkableSetting,hiddenSetting:this.hiddenSetting},this.inlineItemsSetting.addHiddenItemsOnly=!0,this.inlineItemsSetting.hideInlineItemTooltip="Field_ShowHiddenFieldInProxyNavigator",this.hiddenSetting.showHiddenFields=function(){return 0===I.selectedServerViewKind},this.enabledSetting.viewKind=function(){return I.selectedServerViewKind},this.fieldListTreeService.modelToPbiTreeConverterOptions=this.pbiTreeNodeSettingOptions,this.selectedServerViewKind=0,this.server=function(t,e){var i={canDelete:!1,canEdit:!1,databases:[],displayName:t,modelObjectType:"Server",name:t,schemaName:t,urn:t};return i.databases=e.map(function(n){return function(t,e){var i,o,n="".concat(t.urn,"/databases/").concat(e.name);if("lakehouse"===e.dataSourceType){var a={id:0,name:"offlineMode",isOfflineMode:!0};a.datamartObjectId=e.modelId,o=a}else o={id:parseInt(e.modelId,10),name:n,type:H.nKy,dsr:{schemaName:n,modelId:parseInt(e.modelId,10)}};var c={server:t,canDelete:!1,canEdit:!1,displayName:e.name,description:e.description,lastModifiedDate:e.lastModifiedDate,modelObjectType:"Database",name:e.name,modelRequested:!1,canMaterializeModelFromDatasource:!0,model:void 0,dataSource:o,perspectives:[],schemaName:n,urn:n};return(i=c.perspectives).push.apply(i,e.perspectives.map(function(l){return function(t,e){var i="".concat(t.urn,"/perspectives/").concat(e.name);return{database:t,canDelete:!1,canEdit:!1,displayName:e.name,description:e.description,lastModifiedDate:e.lastModifiedDate,modelObjectType:"Perspective",name:e.name,model:void 0,canMaterializeModelFromDatasource:!0,modelRequested:!1,dataSource:{id:parseInt(e.modelId,10),name:i,type:H.nKy,dsr:{modelId:parseInt(e.modelId,10),schemaName:i}},schemaName:i,urn:i}}(c,l)})),c}(i,n)}),i}(j.serverName,j.databases),this.serverViewKindToViewInfoMappings.set(0,{iconName:"databaseicon",description:this.localizationService.get("ProxyNavigator_Description_Databases"),displayName:this.localizationService.get("Databases"),disabled:function(){return!1}}),this.serverViewKindToViewInfoMappings.set(1,{iconName:"pbiperspective",description:this.localizationService.get("ProxyNavigator_Description_Perspectives"),displayName:this.localizationService.get("Perspectives"),disabled:function(){return!I.server.databases.some(function(it){return it.perspectives.length>0})}}),this.fieldListTreeService.fieldListTree$.subscribe(function(w){return I.fieldListTree=w}),this.initialSelection=j.initialSelection}return Object.defineProperty(t.prototype,"selectedServerView",{get:function(){return this.serverViewKindToViewInfoMappings.get(this.selectedServerViewKind)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,d.__generator)(this,function(i){switch(i.label){case 0:return this.subscription.add(this.checkingService.selectionChanged.subscribe(function(n){e.fieldListTreeService.updateChecked(n,!1),e.updateCanSubmit()})),this.fieldListTreeService.initialize(this.server,this.selectedServerViewKind,this.checkingService.selection),[4,this.loadInitialSelection()];case 1:return i.sent(),[2]}})})},t.prototype.loadInitialSelection=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e,i,n,o,a,c,l,h,f,y=this;return(0,d.__generator)(this,function(v){switch(v.label){case 0:return this.initialSelection?(this.includeFutureArtifacts=this.initialSelection.includeFutureArtifacts,this.initializeDisambiguationPreferences(this.initialSelection.disambiguationPreferences),(e=this.findTreeNodeByName(this.initialSelection.databaseName,"Database"))?(e.expanded=!0,i=e.data,this.initialSelection.perspectiveName?[3,3]:[4,this.populateModel(i)]):[2]):[2];case 1:for(v.sent(),n=[],o=[],a=0,c=this.initialSelection.modelObjects;a<c.length;a++)h={name:this.getTableNameFromUrn((l=c[a]).urn),lineageTag:l.lineageTag},l.selected?n.push(h):o.push(h);return[4,this.getPreCheckedTreeItems(i,this.initialSelection.includeFutureArtifacts,n,o)];case 2:return(f=v.sent()).forEach(function(S){return y.checkingService.select(S,!1)}),this.fieldListTreeService.updateNodeChildren(i.model,e,f),[3,5];case 3:return this.onServerViewChanged(1),[4,this.getPreCheckedTreeItems(i,void 0,[],[],this.initialSelection.perspectiveName)];case 4:(f=v.sent()).forEach(function(S){return y.checkingService.select(S,!1)}),this.fieldListTreeService.updateChecked(f,!0),v.label=5;case 5:return[2]}})})},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.prototype.onServerViewChanged=function(e){if(this.selectedServerViewKind!==e){this.selectedServerViewKind=e,this.canIncludeFutureArtifacts=0===this.selectedServerViewKind,this.canIncludeFutureArtifacts?this.includeFutureArtifacts=this.includeFutureArtifactsRestorationValue:(this.includeFutureArtifactsRestorationValue=this.includeFutureArtifacts,this.includeFutureArtifacts=!0);var i=this.otherServerViewSelectionCache;this.otherServerViewSelectionCache=this.checkingService.selection,this.checkingService.selectAll(i,!0),this.fieldListTreeService.initialize(this.server,this.selectedServerViewKind,this.checkingService.selection)}},t.prototype.onNodeExpanded=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var i;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return e.node.expanded&&(i=e.node.data)&&function(t){return t.canMaterializeModelFromDatasource}(i)&&!i.modelRequested?1===this.selectedServerViewKind&&"Database"===i.modelObjectType?[2]:[4,this.populateModel(i)]:[2];case 1:return n.sent(),this.fieldListTreeService.updateNodeChildren(i.model,e.node,this.checkingService.selection),this.checkStrategy.onChildrenAdded(e.node),[2]}})})},t.prototype.onCancel=function(){this.dialogRef.close()},t.prototype.updateCanSubmit=function(){this.canSubmit=this.checkingService.selection.length>0},t.prototype.onSubmit=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return(e=this.fieldListTree.nodes[0].children.find(function(o){return o.checked||o.isIndeterminate}))?e.data.modelRequested||0!==this.selectedServerViewKind?[3,2]:[4,this.populateModel(e.data)]:[2,this.dialogRef.close()];case 1:n.sent(),this.fieldListTreeService.updateNodeChildren(e.data.model,e,e.data.model.tables.getItems()),n.label=2;case 2:return(i=this.getResults(e))?(this.dialogRef.close({selection:i}),[2]):[2,this.dialogRef.close()]}})})},t.prototype.openSettingsDialog=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var o,a;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,this.modernDialogService.openHostDialog({componentName:p.S,dialogName:p.S,bindings:{initialSelection:{includeFutureArtifacts:this.includeFutureArtifacts,enableDisambiguationPreferences:this.enableDisambiguationPreferences,disambiguationPreferences:this.disambiguationPreferences},canIncludeFutureArtifacts:this.canIncludeFutureArtifacts}})];case 1:return[4,c.sent().afterClosed().toPromise()];case 2:return(o=c.sent())?(this.populateFromSettingsDialog(o),[3,4]):[2];case 3:return a=c.sent(),x.fF.assertFail("Proxy navigator settings dialog failed to open"),x.fF.log(a),[3,4];case 4:return[2]}})})},t.prototype.getPreCheckedTreeItems=function(e,i,n,o,a){return(0,d.__awaiter)(this,void 0,void 0,function(){var c,l,h;return(0,d.__generator)(this,function(f){return c=[],a?(l=this.findTreeNodeByName(a,"Perspective").data)&&c.push(l):(n.length||o.length)&&(h=this.getDatabaseSelectedTables(e,i,n,o),c.push.apply(c,h)),c.length&&c.push(e),[2,c]})})},t.prototype.findTreeNodeByName=function(e,i){return(0,C.Q)(this.fieldListTree.nodes,function(n){var o,a;return(null===(o=n.data)||void 0===o?void 0:o.name)===e&&(null===(a=n.data)||void 0===a?void 0:a.modelObjectType)===i},function(n){var o;return(null===(o=n.data)||void 0===o?void 0:o.modelObjectType)!==i})},t.prototype.getDatabaseSelectedTables=function(e,i,n,o){var a=this;return i?e.model.tables.getItems().filter(function(c){return!o.some(function(l){return a.checkTableMatchesId(c,l)})}):e.model.tables.getItems().filter(function(c){return n.some(function(l){return a.checkTableMatchesId(c,l)})})},t.prototype.checkTableMatchesId=function(e,i){return!(e.lineageTag&&!i.lineageTag||!e.lineageTag&&i.lineageTag)&&(e.lineageTag?e.lineageTag===i.lineageTag:this.getTableNameFromUrn(e.urn)===i.name)},t.prototype.getTableNameFromUrn=function(e){if(e){var n=e.toLowerCase().indexOf("/table/")+7;return decodeURIComponent(e.substring(n))}},t.prototype.getResults=function(e){var n,i=[];if(0===this.selectedServerViewKind){if((i=e.children.map(function(o){var a=o.data;return{selected:o.checked,urn:fe.X6.getTableUrn(a.name,a.schemaName),lineageTag:a.lineageTag}})).every(function(o){return!o.selected}))return}else if(!(n=e.children.find(function(o){return o.checked})))return;return{databaseName:e.displayName,includeFutureArtifacts:this.includeFutureArtifacts,modelObjects:n?[]:i,perspectiveName:n?.displayName,disambiguationPreferences:this.enableDisambiguationPreferences?this.disambiguationPreferences:null}},t.prototype.populateModel=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var a;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return e.modelRequested=!0,function(t){return t.isOfflineMode}(e.dataSource)?[4,this.directLakeService.getDirectLakeAsync(e.dataSource.datamartObjectId)]:[3,2];case 1:return function(t,e){var i=[];e.model={tables:new g(i),version:"",modelObjectType:"Model",name:"",schemaName:"",displayName:"",canEdit:!1,canDelete:!1,urn:""};for(var n=0,o=t.tables;n<o.length;n++){var a=o[n],c={name:a.name,modelObjectType:"Table",model:e.model,columns:new g([]),measures:new g([]),hierarchies:new g([]),kpis:new g([]),partitions:new g([]),description:"",isCalculatedTable:!1,isMeasureGroup:!1,isErrorState:!1,isHidden:!1,canEditSource:!1,canRename:!1,canRefreshIndependently:!1,canHaveMeasures:!1,supportManageRelationships:!1,isDateTable:!1,schemaName:"",displayName:"",canEdit:!1,canDelete:!1,urn:a.name,lineageTag:a.lineageTag};i.push(c)}}(c.sent(),this.server.databases[0]),[3,5];case 2:return[4,this.conceptualSchemaProxy.get([e.dataSource])];case 3:return a=c.sent(),[4,this.modelService.update([],a)];case 4:c.sent(),e.model=this.modelService.model,c.label=5;case 5:return[2]}})})},t.prototype.populateFromSettingsDialog=function(e){this.includeFutureArtifacts=e.includeFutureArtifacts,this.enableDisambiguationPreferences=e.enableDisambiguationPreferences,this.disambiguationPreferences=e.disambiguationPreferences},t.prototype.initializeDisambiguationPreferences=function(e){if(e){var i=e.targetedModelObjects.toString(),n=A.S[i],o=e.mode.toString();this.disambiguationPreferences={text:e.text,isPrefix:e.isPrefix,targetedModelObjects:n,mode:A.x[o]},this.enableDisambiguationPreferences=!0}},t.\u0275fac=function(i){return new(i||t)(r.\u0275\u0275directiveInject(X.so),r.\u0275\u0275directiveInject(P.o),r.\u0275\u0275directiveInject(Se.i),r.\u0275\u0275directiveInject(be.B),r.\u0275\u0275directiveInject(Te.F),r.\u0275\u0275directiveInject(Z.VI),r.\u0275\u0275directiveInject(k.W),r.\u0275\u0275directiveInject(E),r.\u0275\u0275directiveInject(N),r.\u0275\u0275directiveInject(Q.J),r.\u0275\u0275directiveInject(W),r.\u0275\u0275directiveInject(K),r.\u0275\u0275directiveInject(V),r.\u0275\u0275directiveInject(G),r.\u0275\u0275directiveInject(Pe),r.\u0275\u0275directiveInject(X.WI),r.\u0275\u0275directiveInject($),r.\u0275\u0275directiveInject(T.fc),r.\u0275\u0275directiveInject(Ie.x))},t.\u0275cmp=r.\u0275\u0275defineComponent({type:t,selectors:[["proxy-navigator-dialog"]],features:[r.\u0275\u0275ProvidersFeature([V,U.n,G,W,K,$,N,B.XI,Z.VI,Q.J,E,N,{provide:k.W,useClass:k.w},{provide:T.fc,useClass:T.$x}])],decls:34,vars:32,consts:[[3,"title","close"],[1,"header"],[1,"server-view-dropdown",3,"ngModel","ngModelChange"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"value","disabled","ngClass",4,"ngFor","ngForOf"],[3,"hidden"],[1,"refresh-button","pbi-fluent-button","fluentTheme-md-reg"],["name","refresh","size","small"],["localize","Refresh"],[1,"divider"],[1,"search-box"],["pbiSearchInput","",1,"pbi-focus-outline","pbi-focus-outline","search-box-input",3,"placeholder","keyup"],["searchInput",""],[1,"settings"],["aria-label","settings",1,"settings-button","pbi-fluent-button","fluentTheme-md-reg",3,"click"],["name","settings","size","small"],["localize","Settings",1,"settings-text"],["id","ConnectData_Description",1,"description"],["aria-describedby","ConnectData_Description","localize","LearnMore","href","https://go.microsoft.com/fwlink/?linkid=2167320","target","_blank",1,"pbi-external-link"],["focus-nav-mode","Browser",1,"navigator-field-list",3,"search","tree","options","checkMode","onNodeExpansionToggle"],[3,"okText","disableOk","okAction","cancelAction"],["serverViewOptionTemplate",""],[3,"value","disabled","ngClass"],[1,"server-view-option"],["size","small",3,"name"]],template:function(i,n){if(1&i&&(r.\u0275\u0275elementStart(0,"dialog-header",0),r.\u0275\u0275listener("close",function(){return n.onCancel()}),r.\u0275\u0275pipe(1,"localize"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(2,"dialog-body")(3,"div",1)(4,"pbi-dropdown",2),r.\u0275\u0275listener("ngModelChange",function(l){return n.onServerViewChanged(l)}),r.\u0275\u0275elementStart(5,"pbi-dropdown-trigger"),r.\u0275\u0275template(6,Ae,1,0,"ng-container",3),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(7,Ve,2,9,"pbi-dropdown-item",4),r.\u0275\u0275pipe(8,"keyvalue"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(9,"div",5)(10,"button",6),r.\u0275\u0275element(11,"pbi-icon",7)(12,"span",8),r.\u0275\u0275elementEnd(),r.\u0275\u0275element(13,"div",9),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(14,"pbi-search-box",10)(15,"input",11,12),r.\u0275\u0275listener("keyup",function(){return null}),r.\u0275\u0275pipe(17,"localize"),r.\u0275\u0275pipe(18,"localize"),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementStart(19,"div",13),r.\u0275\u0275element(20,"div",9),r.\u0275\u0275elementStart(21,"button",14),r.\u0275\u0275listener("click",function(){return n.openSettingsDialog()}),r.\u0275\u0275element(22,"pbi-icon",15)(23,"span",16),r.\u0275\u0275elementEnd()()(),r.\u0275\u0275elementStart(24,"p",17),r.\u0275\u0275text(25),r.\u0275\u0275element(26,"a",18),r.\u0275\u0275pipe(27,"localize"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(28,"pbi-tree",19),r.\u0275\u0275listener("onNodeExpansionToggle",function(l){return n.onNodeExpanded(l)}),r.\u0275\u0275pipe(29,"async"),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementStart(30,"dialog-footer",20),r.\u0275\u0275listener("okAction",function(){return n.onSubmit()})("cancelAction",function(){return n.onCancel()}),r.\u0275\u0275pipe(31,"localize"),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(32,Ee,4,2,"ng-template",null,21,r.\u0275\u0275templateRefExtractor)),2&i){var o=r.\u0275\u0275reference(16),a=r.\u0275\u0275reference(33);r.\u0275\u0275property("title",r.\u0275\u0275pipeBind1(1,16,"TutorialPopup_ConnectDataTitle")),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngModel",n.selectedServerViewKind),r.\u0275\u0275advance(2),r.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",r.\u0275\u0275pureFunction1(30,ee,n.selectedServerView)),r.\u0275\u0275advance(1),r.\u0275\u0275property("ngForOf",r.\u0275\u0275pipeBind1(8,18,n.serverViewKindToViewInfoMappings)),r.\u0275\u0275advance(2),r.\u0275\u0275property("hidden",!n.canRefresh),r.\u0275\u0275advance(6),r.\u0275\u0275property("placeholder",r.\u0275\u0275pipeBind1(18,22,"SearchBox_Text")),r.\u0275\u0275attribute("aria-label",r.\u0275\u0275pipeBind1(17,20,"SearchBox_Text")),r.\u0275\u0275advance(10),r.\u0275\u0275textInterpolate1(" ",n.selectedServerView.description," "),r.\u0275\u0275advance(1),r.\u0275\u0275attribute("aria-label",r.\u0275\u0275pipeBind1(27,24,"LearnMore")),r.\u0275\u0275advance(2),r.\u0275\u0275property("search",o.value)("tree",r.\u0275\u0275pipeBind1(29,26,n.fieldListTree$))("options",n.fieldListOptions)("checkMode",n.checkMode),r.\u0275\u0275advance(2),r.\u0275\u0275property("okText",r.\u0275\u0275pipeBind1(31,28,"Submit"))("disableOk",!n.canSubmit)}},dependencies:[m.NgClass,m.NgForOf,m.NgTemplateOutlet,Oe.X,Me.u,F.JJ,F.On,Y.H,xe.r,De._,Y.T,Ne._,q.a,q.p,ke.A,Fe.H,je.g,m.AsyncPipe,m.KeyValuePipe,we.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;padding:24px;width:520px;box-sizing:border-box}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .server-view-dropdown[_ngcontent-%COMP%]{width:160px}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .refresh-button[_ngcontent-%COMP%]{display:flex;align-items:center;border:none;margin-left:4px;padding-left:8px;padding-right:8px}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .refresh-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:4px}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{display:flex;align-self:center;width:1px;height:calc(100% - 12px);margin-right:4px;margin-left:4px;background-color:var(--gray-60, #C8C6C4)}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{display:flex;margin-right:4px}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]:before{font-size:16px}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .search-box-input[_ngcontent-%COMP%]{border-color:transparent}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]{display:flex}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .settings-button[_ngcontent-%COMP%]{border-color:transparent;display:flex;align-items:center;border:none;padding-left:8px;padding-right:8px;cursor:pointer}dialog-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .settings-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex;margin-right:8px}dialog-body[_ngcontent-%COMP%]   .navigator-field-list[_ngcontent-%COMP%]{display:block;height:350px;margin-bottom:5px}.server-view-option[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif)}.server-view-option[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex;margin-right:4px}']}),t}(),Ke=s(79061),He=s(96327),Be=s(42729),$e=s(47913),Ue=s(6015),Ge=s(93367),Xe=s(39433),_e=s(35284),Je=function(){function t(){}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=r.\u0275\u0275defineInjector({imports:[m.CommonModule,Ke.v,_e.J,F.u5,$e.V,Ue.C,Ge.U,Xe.t,He.F,Be.c.withManifest([{componentIdentifier:O.O,componentType:Re}])]}),t}()},36946:function(te,b,s){s.d(b,{S:function(){return O},x:function(){return d}});var O=function(p){return p[p.None=0]="None",p[p.Tables=1]="Tables",p[p.Measures=2]="Measures",p[p.All=3]="All",p}({}),d=function(p){return p.Always="Always",p.ConflictOnly="ConflictOnly",p}({})}}]);