"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["visual-calc-editor"],{48563:function(me,W,t){t.d(W,{w:function(){return L}});var h=t(17819);function L(x){return x.map(function(T){return function(x){return{name:x.Name,description:x.Description,category:I(x.Category),pushableToDQ:V(x.PushableToDirectQuery),parameters:w(x.Parameters),visualCalculationsInfo:x.VisualCalculationsInfo}}(T)})}function I(x){switch(x){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9}}function V(x){var T=0;return 1===x?T=1:2===x?T=2:3===x&&(T=3),T}function w(x){return x?x.map(function(T){return function(x){return new h.Hw(x.Name,x.Optional,x.Repeatable,x.RepeatGroup,x.Skippable)}(T)}):[]}},83269:function(me,W,t){t.r(W),t.d(W,{VisualCalcEditorModule:function(){return It},VisualCalcServiceLazyProvider:function(){return Ct},VisualCalcServicePromiseFactory:function(){return yt}});var h=t(77476),L=t(17174),O=t(98665),I=t(26898),V=t(83008),w=t(21024),H=t(48145),x=t(27980),T=t(32208),E=t(9380),U=t(9844),G=t(17848),Y=t(82156),J=t(79061),q=t(93367),ee=t(14463),pe=t(15393),he=t(66890),N=t(51644),f=t(62458);function Q(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return f.fF.assertValue(o,"functionName"),f.fF.assertValue(n,"args"),"".concat(o).concat(N.block("(",n,")"))}var ve,oe=t(50550),b=t(21571),m=t(50423),ye=t(65181),Ee=function(){function o(n){this.localizationService=n}return o.prototype.getTemplates=function(){return[new Qe(this.localizationService),new Ze(this.localizationService),new Xe(this.localizationService),new Je(this.localizationService),new Fe(this.localizationService),new Me(this.localizationService,0),new Me(this.localizationService,1),new Me(this.localizationService,3),new Me(this.localizationService,2)]},o.\u0275fac=function(r){return new(r||o)(m.\u0275\u0275inject(ye.o))},o.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Qe=function(){function o(n){this.localizationService=n,this.capabilities={name:"RunningSum",displayName:(0,b.V)("VisualCalcTemplate_RunningSum_DisplayName"),description:(0,b.V)("VisualCalcTemplate_RunningSum_Description"),category:"VisualCalculation",input:(0,oe.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService);return function(o){return f.fF.assertValue(o,"expression"),Q("RUNNINGSUM",o)}("[".concat(n,"]"))},o}(),Ze=function(){function o(n){this.localizationService=n,this.capabilities={name:"MovingAverage",displayName:(0,b.V)("VisualCalcTemplate_MovingAverage_DisplayName"),description:(0,b.V)("VisualCalcTemplate_MovingAverage_Description"),category:"VisualCalculation",input:(0,oe.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""},{name:"WindowSize",constant:{type:{numeric:!0},defaultValue:1},displayName:(0,b.V)("VisualCalcTemplate_WindowSizeField"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService),r=(0,b.G)(this.capabilities.input[1].displayName,this.localizationService);return function(o,n){return f.fF.assertValue(o,"expression"),f.fF.assertValue(n,"windowSize"),Q("MOVINGAVERAGE",o,n)}("[".concat(n,"]"),"".concat(r))},o}(),Xe=function(){function o(n){this.localizationService=n,this.capabilities={name:"PercentOfParent",displayName:(0,b.V)("VisualCalcTemplate_PercentOfParent_DisplayName"),description:(0,b.V)("VisualCalcTemplate_PercentOfParent_Description"),category:"VisualCalculation",input:(0,oe.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""},{name:"CollapseDenominatorField",column:{},displayName:(0,b.V)("Field"),description:""},{name:"Axis",displayName:(0,b.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService),r=(0,b.G)(this.capabilities.input[1].displayName,this.localizationService),s=(0,b.G)(this.capabilities.input[2].displayName,this.localizationService);return N.divide("[".concat(n,"]"),function(o,n){return f.fF.assertValue(o,"expression"),f.fF.assertValue(n,"axis"),Q("COLLAPSE",o,n)}("[".concat(r,"]"),"".concat(s)))},o}(),Je=function(){function o(n){this.localizationService=n,this.capabilities={name:"PercentOfGrandTotal",displayName:(0,b.V)("ShowValueAs_Calculation_PercentOfGrandTotal"),description:(0,b.V)("VisualCalcTemplate_PercentOfGrandTotal_Description"),category:"VisualCalculation",input:(0,oe.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""},{name:"CollapseAllDenominatorField",column:{},displayName:(0,b.V)("Field"),description:""},{name:"Axis",displayName:(0,b.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService),r=(0,b.G)(this.capabilities.input[1].displayName,this.localizationService),s=(0,b.G)(this.capabilities.input[2].displayName,this.localizationService);return N.divide("[".concat(n,"]"),function(o,n){return f.fF.assertValue(o,"expression"),f.fF.assertValue(n,"axis"),Q("COLLAPSEALL",o,n)}("[".concat(r,"]"),"".concat(s)))},o}(),Fe=function(){function o(n){this.localizationService=n,this.capabilities={name:"AverageOfChildren",displayName:(0,b.V)("VisualCalcTemplate_AverageOfChildren_DisplayName"),description:(0,b.V)("VisualCalcTemplate_AverageOfChildren_Description"),category:"VisualCalculation",input:(0,oe.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""},{name:"Axis",displayName:(0,b.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService),r=(0,b.G)(this.capabilities.input[1].displayName,this.localizationService);return function(o,n){return f.fF.assertValue(o,"expression"),f.fF.assertValue(n,"axis"),Q("EXPAND",o,n)}(N.average("[".concat(n,"]")),"".concat(r))},o}(),Me=function(){function o(n,r){void 0===r&&(r=3),this.localizationService=n,this.versusEnum=r;var s=o.versusToDax[this.versusEnum];this.capabilities={name:"Versus".concat(s),displayName:(0,b.V)("VisualCalcTemplate_Versus_".concat(s,"_DisplayName")),description:(0,b.V)("VisualCalcTemplate_Versus_".concat(s,"_Description")),category:"VisualCalculation",input:(0,oe.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,b.V)("Field"),description:""},{name:"DaxFunctionField",column:{},displayName:(0,b.V)("Field"),description:""}]),helpLink:-1}}return o.prototype.getExpression=function(){var n=(0,b.G)(this.capabilities.input[0].displayName,this.localizationService),r=(0,b.G)(this.capabilities.input[1].displayName,this.localizationService),s=o.versusToDax[this.versusEnum];return"[".concat(n,"] - ").concat(Q(s,"[".concat(r,"]")))},o.versusToDax=((ve={})[3]="FIRST",ve[2]="LAST",ve[1]="NEXT",ve[0]="PREVIOUS",ve),o}(),ge=t(88409),S=t(81337),_e=t(63057),Ie=t(59787),Ce=t(59973),re=t(83317),Ye=t(17653),Ve=t(81905),qe=t(48787),Be=t(15903),et=t(15783),De=t(34103),Re=t(72080),Ne=t(49217),He=t(65302),tt=t(39681),ze=t(73221),Ae=t(52570),be=t(61561),Oe=t(30794),nt=t(35510),xe=t(23558),ot=t(22318),je=t(77526),rt=t(6663),it=t(98361),Ue=t(95792),at=t(74249),st=t(26657),fe=t(60661),lt=t(74082),ut=t(63731),ke=t(73027),Le=t(8590),ue=t(73202),ct=t(11494),$e=t(28894),We={provide:Be.n9,useClass:function(o){function n(r,s,l,d,p,v,M,F){var C=o.call(this,r,l,s)||this;return C.eventBridge=d,C.lazyScopeProvider=p,C.visualCalcEagerService=v,C.daxCapabilitiesService=M,C.zone=F,C.submit$=new Oe.xQ,C.cancel$=new Oe.xQ,C.onContentChanged$=new nt.X(void 0),C.destroy$=new Oe.xQ,C}return(0,S.__extends)(n,o),n.prototype.hasUnsavedChanges=function(r){return!1},n.prototype.commitOrDeletePendingCalculation=function(r){return(0,S.__awaiter)(this,void 0,void 0,function(){return(0,S.__generator)(this,function(s){return[2,!1]})})},n.prototype.commitCalculationUpdate=function(r){return(0,S.__awaiter)(this,void 0,void 0,function(){return(0,S.__generator)(this,function(s){return this.submit$.next(r),[2]})})},n.prototype.cancel=function(r){this.cancel$.next()},n.prototype.onContentChanged=function(r){this.onContentChanged$.next(r)},n.prototype.onTemplateSelection=function(r){return(0,S.__awaiter)(this,void 0,void 0,function(){var s,l;return(0,S.__generator)(this,function(p){switch(p.label){case 0:return st.gD(r)?(s=r.getExpression(),l=(0,b.G)(r.capabilities.displayName,this.localizationService),this.formulaBarControl.isEditorEnabled?[3,3]:[4,this.lazyScopeProvider.get(be.w)]):(f.fF.assertFail("Selected template is not a visual calculation template"),[2]);case 1:return[4,p.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Template",s,l)];case 2:return p.sent(),[2];case 3:return _.isEmpty(this.formulaBarControl.getCurrentEditorText())||this.formulaBarControl.getCurrentEditorText()===this.formulaBarControl.getHighlightedText()?this.formulaBarControl.insertTextAtCurrentCursor("".concat(l," = ").concat(s)):this.formulaBarControl.insertTextAtCurrentCursor(s),[2]}})})},n.prototype.setVisualContainer=function(r){this.visualContainer=r},n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.registerFormulaBarControl=function(r){var s=this;this.formulaBarControl=r,this.formulaBarControl.setReadOnly(!1),this.eventBridge.on(Le.jCS).pipe((0,re.R)(this.destroy$),(0,Ce.h)(function(l){return l.affectContainer(s.visualContainer)})).subscribe(function(){s.intellisenseService.updateFormulaContextAsync()}),this.submit$.pipe((0,re.R)(this.destroy$)).subscribe(function(){s.visualCalcEagerService.enterViewMode("PressedSubmit")}),this.destroy$.pipe((0,xe.M)(this.onContentChanged$,this.visualCalcEagerService.onContextChange$())).subscribe(function(l){var d=l[1],p=l[2];return(0,S.__awaiter)(s,void 0,void 0,function(){return(0,S.__generator)(this,function(M){switch(M.label){case 0:switch(p.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(d,p)];case 2:return M.sent(),[4,this.tryRemoveUnchangedNewCalculation(d,p)];case 3:return M.sent(),[3,5];case 4:return[3,5];case 5:return[2]}})})}),this.cancel$.pipe((0,re.R)(this.destroy$)).subscribe(function(){s.visualCalcEagerService.enterViewMode("PressedCancel")}),this.visualCalcEagerService.onContextChange$().pipe((0,ot.O)({type:"Edit",calculationInfo:{isNew:!1}}),(0,je.x)(function(l,d){return"Edit"===l.type&&"Edit"===d.type&&l.queryName===d.queryName}),(0,re.R)(this.destroy$),(0,rt.G)(),(0,xe.M)(this.onContentChanged$)).subscribe(function(l){var d=l[0],p=d[0],v=d[1],M=l[1];return(0,S.__awaiter)(s,void 0,void 0,function(){var C,de,ae;return(0,S.__generator)(this,function(ne){switch(ne.label){case 0:if("Edit"!==p.type)return[3,15];switch(v.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(M,p)];case 2:return ne.sent(),[4,this.tryRemoveUnchangedNewCalculation(M,p)];case 3:return ne.sent(),[3,15];case 4:switch(C=v.entryPoints){case"PressedCancel":return[3,5];case"PressedSubmit":return[3,9];case"DeletedCurrentCalc":return[3,12]}return[3,13];case 5:return p.calculationInfo.isNew?[4,this.lazyScopeProvider.get(be.w)]:[3,8];case 6:return[4,ne.sent().removeVisualCalculation(this.visualContainer,p.queryName)];case 7:ne.sent(),ne.label=8;case 8:return[3,14];case 9:return[4,this.tryRemoveUnchangedNewCalculation(M,p)];case 10:return ne.sent(),[4,this.tryToCommitContents(M,p)];case 11:return ne.sent(),[3,14];case 12:return[3,14];case 13:return f.fF.assertNever(C),[3,14];case 14:return[3,15];case 15:switch(v.type){case"Edit":return[3,16];case"View":return[3,23]}return[3,23];case 16:return(de=(0,fe.Xf)(this.visualContainer))&&de.defn.select().withName(v.queryName)?[4,this.intellisenseService.getCalculationInfo()]:(this.visualCalcEagerService.enterViewMode("DeletedCurrentCalc"),[3,24]);case 17:switch(ae=ne.sent(),v.editingType){case"Template":return[3,18];case"Custom":return[3,20]}return[3,20];case 18:return[4,this.handleUpdateContents(!1,ae)];case 19:return ne.sent(),[3,22];case 20:return[4,this.handleUpdateContents(ae.isNew,ae)];case 21:return ne.sent(),[3,22];case 22:return[3,24];case 23:return this.resetFormulaBar(),[3,24];case 24:return[2]}})})}),this.visualCalcEagerService.onVisualCalcDeleted$().pipe((0,re.R)(this.destroy$),(0,xe.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(l){var p=l[1];"Edit"===p.type&&l[0]===p.queryName&&s.visualCalcEagerService.enterViewMode("DeletedCurrentCalc")}),this.visualCalcEagerService.onNativeNameReferenceChange$().pipe((0,re.R)(this.destroy$),(0,xe.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(l){var d=l[0],p=d.oldName,v=d.queryName,M=l[1];return(0,S.__awaiter)(s,void 0,void 0,function(){var F,C,g,k,K,de,ae;return(0,S.__generator)(this,function(se){switch(se.label){case 0:return"Edit"!==M.type?[3,6]:(F=M.queryName,C=(0,fe.Xf)(this.visualContainer),g=C?.defn.select().withName(F),g&&(0,lt.jX)(g.expr)?null==(k=C.defn.select().withName(v))?[2]:(K=this.formulaBarControl.getCurrentEditorText(),F!==v?[3,2]:[4,this.updateExpressionAfterFieldRenamed(K)]):[3,6]);case 1:return ae=se.sent(),[3,4];case 2:return[4,this.updateExpressionAfterReferencedFieldRenamed(K,C,p,k.nativeReferenceName)];case 3:ae=se.sent(),se.label=4;case 4:return(de=ae)===K?[3,6]:[4,this.updateContents(de,void 0)];case 5:se.sent(),this.formulaBarControl.resetModelTokens(de),this.intellisenseService.updateFormulaContextAsync(),se.label=6;case 6:return[2]}})})})},n.prototype.updateExpressionAfterFieldRenamed=function(r){return(0,S.__awaiter)(this,void 0,void 0,function(){var s,l,d,p,v;return(0,S.__generator)(this,function(M){switch(M.label){case 0:return s=r,[4,this.intellisenseService.getCalculationInfo()];case 1:return null!=(l=M.sent())&&(d=(0,Ue.O5)(l.formulaText,!0),p=(0,Ue.O5)(r),v=p.formula||" ",p.name&&p.name===r&&(v=" ".concat(r)),s="".concat(d.name," =").concat(v)),[2,s]}})})},n.prototype.updateExpressionAfterReferencedFieldRenamed=function(r,s,l,d){return(0,S.__awaiter)(this,void 0,void 0,function(){var p,v,M,F,C,g;return(0,S.__generator)(this,function(k){switch(k.label){case 0:return p=r,_.isEmpty(r)?[3,5]:null!=this.vcDaxParserService?[3,2]:(v=this,[4,this.lazyScopeProvider.get(ut.M)]);case 1:v.vcDaxParserService=k.sent(),k.label=2;case 2:return[4,this.daxCapabilitiesService.getReservedWords()];case 3:return M=k.sent(),[4,this.daxCapabilitiesService.getCapabilities()];case 4:F=k.sent(),C=s.defn.getNativeReferenceNames(!0),C=_.map(C,function(K){return K===d?l:K}),g=this.vcDaxParserService.getContext(C,M,F),p=this.vcDaxParserService.renameReference(g,r,l,d),k.label=5;case 5:return[2,p]}})})},n.prototype.handleUpdateContents=function(r,s){return(0,S.__awaiter)(this,void 0,void 0,function(){return(0,S.__generator)(this,function(l){switch(l.label){case 0:return this.formulaBarControl.clear(),[4,this.updateContents(s.formulaText,s.alertMessage)];case 1:return l.sent(),[4,this.focusWhenNotBlocked()];case 2:return l.sent(),r&&this.formulaBarControl.setSelection({startPosition:0,length:s.formulaText.length}),[2]}})})},n.prototype.resetFormulaBar=function(){this.formulaBarControl.clear(),this.formulaBarControl.resetModelTokens(""),this.formulaBarControl.setExpandCollapseState(1),this.formulaBarControl.endFormulaEdit()},n.prototype.tryToCommitContents=function(r,s){return(0,S.__awaiter)(this,void 0,void 0,function(){var l,d,p;return(0,S.__generator)(this,function(M){switch(M.label){case 0:return r&&r.doCommit&&!_.isEmpty(r.newExpression)?(d=r.newExpression,p=this.getName(r.newName,l=s.queryName),[4,this.lazyScopeProvider.get(be.w)]):[3,3];case 1:return[4,M.sent().updateVisualCalculation(this.visualContainer,p,d,l,s.calculationInfo.isNew)];case 2:M.sent(),M.label=3;case 3:return[2]}})})},n.prototype.tryRemoveUnchangedNewCalculation=function(r,s){return(0,S.__awaiter)(this,void 0,void 0,function(){return(0,S.__generator)(this,function(d){switch(d.label){case 0:return!s.calculationInfo.isNew||!r||r.doCommit&&_.isEmpty(r.newInvalidFormula)&&!_.isEmpty(r.newExpression)?[3,3]:[4,this.lazyScopeProvider.get(be.w)];case 1:return[4,d.sent().removeVisualCalculation(this.visualContainer,s.queryName)];case 2:d.sent(),d.label=3;case 3:return[2]}})})},n.prototype.getName=function(r,s){if(_.isEmpty(r)){var l=(0,fe.Xf)(this.visualContainer);return ue.Fo(l,s)}return r},n.\u0275fac=function(s){return new(s||n)(m.\u0275\u0275inject(ke.D),m.\u0275\u0275inject(Re.e),m.\u0275\u0275inject(ye.o),m.\u0275\u0275inject(ct.J),m.\u0275\u0275inject($e.H),m.\u0275\u0275inject(ge.w),m.\u0275\u0275inject(at.r),m.\u0275\u0275inject(m.NgZone))},n.\u0275prov=m.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(it.e)},Ge=t(78384),pt={provide:Be.$d,useClass:function(){function o(n){this.canvasZoomService=n}return o.prototype.getZoomLevel=function(){var n=this.canvasZoomService.getCurrentZoomLevel();return f.fF.assert(function(){return n>0},"ZoomLevel should greater than 0"),this.canvasZoomService.getCurrentZoomLevel()},o.\u0275fac=function(r){return new(r||o)(m.\u0275\u0275inject(Ge.w))},o.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}()},Se=t(63708),Te=t(68405),a=t(13080),i=t(49642),u=t(58295),c=function(o){return o[o.None=0]="None",o[o.Rows=1]="Rows",o[o.Columns=2]="Columns",o}({}),y=function(){function o(n){this.selects=n,this.containsRows=!1,this.containsColumns=!1,this.referencedItems=new Set}return o.prototype.withRestartToken=function(n){return this},o.prototype.withPrimaryWindowExpansion=function(n){return this},o.prototype.withDataVolume=function(n){return this},o.prototype.withIncludeEmptyGroups=function(n){return this},o.prototype.withHighlightFilter=function(n){return this},o.prototype.withGroupBy=function(n){return this},o.prototype.withPrimaryGrouping=function(n,r,s,l,d,p){return this.containsValidAxisGroup(n)&&(this.containsRows=!0),this},o.prototype.withPrimaryGroupingNestedByRole=function(n,r,s,l,d,p,v){return this.withPrimaryGrouping(n,r,s,l,d,p)},o.prototype.withPrimaryExpansion=function(n){return this},o.prototype.withPrimarySynchronization=function(n){return this},o.prototype.withPrimaryGroupingNested=function(n,r,s,l,d){return this.containsValidAxisGroup(n)&&(this.containsRows=!0),this},o.prototype.withSecondaryGrouping=function(n,r,s,l,d){return this.containsValidAxisGroup(n)&&(this.containsColumns=!0),this},o.prototype.withSecondaryGroupingNestedByRole=function(n,r,s,l,d,p){return this.withSecondaryGrouping(n,r,s,l,d)},o.prototype.withSecondaryExpansion=function(n){return this},o.prototype.withSecondaryGroupingNested=function(n,r,s,l,d){return this.containsValidAxisGroup(n)&&(this.containsColumns=!0),this},o.prototype.withCurrentInnermostGrouping=function(n,r,s){return this},o.prototype.withCurrentInnermostPrimaryGrouping=function(n,r,s,l){return this},o.prototype.withPrimaryDataReduction=function(n){return this},o.prototype.withScopedDataReduction=function(n,r){return this},o.prototype.withSecondaryDataReduction=function(n){return this},o.prototype.withIntersectionDataReduction=function(n){return this},o.prototype.withTopLevelAggregates=function(n){return this},o.prototype.withAdditionalProjections=function(n){return this},o.prototype.withRolesWithHierarchicalGroupingSupport=function(n){return this},o.prototype.toQueryShape=function(n){var r=c.None;return this.containsRows&&(r|=c.Rows),this.containsColumns&&(r|=c.Columns),r},o.prototype.containsValidAxisGroup=function(n){if(_.isEmpty(n))return!1;for(var r=0,s=n;r<s.length;r++){var l=s[r];if(this.referencedItems.has(l.queryName))return!0;var d=(0,oe.rC)(this.selects,l.queryName);if(!(0,u.k)(d.expr))return this.referencedItems.add(l.queryName),!0}return!1},o}(),P=t(453),j=t(29866),te=t(39665),ft=t(24878),ht=t(13702),ie=t(906),Pe={provide:Be.Pm,useClass:function(){function o(n,r,s,l,d,p,v,M,F,C,g){this.visualCalcEagerService=n,this.featureSwitchService=r,this.localizationService=s,this.telemetryService=l,this.visualPluginService=d,this.conceptualSchemaProxy=p,this.dataSources=v,this.displayNameService=M,this.sortService=F,this.transformPluginService=C,this.dataReaders=g}return o.prototype.setVisualContainer=function(n){this.visualContainer=n},o.prototype.init=function(n){},o.prototype.reset=function(){},o.prototype.getCalculationObject=function(){return this.findCalculationObject()},o.prototype.findCalculationObject=function(n){var r=this.visualCalcEagerService.getCurrentEditingContext();if(null==r)return{name:"",expression:"",calculationType:Se.eN.VisualCalculation,calculationSyntaxType:Se.Up.Formula};var s=r.calculationInfo.isNew,l=(0,fe.Xf)(this.visualContainer),d=ue.zd(l,r);return{name:ue.Fo(l,r.queryName),expression:d,calculationType:Se.eN.VisualCalculation,calculationSyntaxType:Se.Up.Formula,isNew:s}},o.prototype.getDaxModeConfigInputs=function(n){return(0,S.__awaiter)(this,void 0,void 0,function(){var r,s,l,d;return(0,S.__generator)(this,function(p){switch(p.label){case 0:return r=this.visualCalcEagerService.getCurrentEditingContext(),s=(0,fe.Xf)(this.visualContainer),l=ue.Oq(s,r?.queryName),[4,this.getVisualAxes()];case 1:return d=p.sent(),[2,{serializableModel:ue.qN(l),wireDataSourceInfo:n,axes:d}]}})})},o.prototype.getVisualAxes=function(){return(0,S.__awaiter)(this,void 0,void 0,function(){var n,r,s,l,d,p,v,M,F,C,g,k,K,de,ae,ne;return(0,S.__generator)(this,function(Et){switch(Et.label){case 0:return r=(n=this.visualContainer.config.singleVisual).visualType,s={displayNameService:this.displayNameService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,sortService:this.sortService,telemetryService:this.telemetryService,transformPluginService:this.transformPluginService,visualPluginService:this.visualPluginService},l=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(l)];case 1:return d=Et.sent(),p=(0,Te.W5)(l,n.query&&n.query.defn),_.isEmpty(p)?[2,[]]:(v=this.dataReaders.queryGenerator(p),M=this.visualPluginService.capabilities(n.visualType).visualShapeDataViewMappings,!(F=(0,P.p0)(n,r,d,v,s,void 0,M,void 0,_.noop))||F.error?[2,[]]:(C=F.compiled)?(g=(0,P.Go)(C.mappings),K=(0,i.Jz)(k=C.query.defn),de=(0,a.lr)(g,K),ae=k.select(),ne=(0,i.cd)(function(){return new y(ae)},K,de.mapping,ae,C.additionalProjections),[2,this.convertVisualAxesTypesToStringArray(ne)]):[2,[]])}})})},o.prototype.convertVisualAxesTypesToStringArray=function(n){var r=[];return n&c.Rows&&r.push("ROWS"),n&c.Columns&&r.push("COLUMNS"),r},o.\u0275fac=function(r){return new(r||o)(m.\u0275\u0275inject(ge.w),m.\u0275\u0275inject(E.vZ),m.\u0275\u0275inject(ye.o),m.\u0275\u0275inject(O.y0),m.\u0275\u0275inject(j.D),m.\u0275\u0275inject(I.i),m.\u0275\u0275inject(V.D),m.\u0275\u0275inject(ht.O),m.\u0275\u0275inject(ie.K),m.\u0275\u0275inject(te.y),m.\u0275\u0275inject(ft.A))},o.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}()},we=t(56083),Ke=function(){function o(n,r){this.localizationService=n,this.tutorialService=r}return o.prototype.showTutorial=function(){var n=this.createVisualCalcTutorial();this.tutorialService.startTutorial(n)},o.prototype.createVisualCalcTutorial=function(){var n,r="VisualCalcTemplateButton",s="VisualCalcEditInFormulaBar";return{itemKeys:[r,s],items:(n={},n[r]=this.createTemplateModelItem(r),n[s]=this.createFormulaBarModelItem(s),n),isSequentialTutorial:!0}},o.prototype.createTemplateModelItem=function(n){var r='[data-unique-id="formula-bar-template-button"]';return{title:this.localizationService.get("VisualCalcTeachingCallout_Template_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_Template_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:n,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},preferredOrientation:"right",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},o.prototype.createFormulaBarModelItem=function(n){var r=".formulaBarEditorContainer";return{title:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:n,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},arrowOffset:{top:0,left:500},offset:{top:0,left:-500},preferredOrientation:"bottom",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},o.\u0275fac=function(r){return new(r||o)(m.\u0275\u0275inject(ye.o),m.\u0275\u0275inject(we.yU))},o.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),vt=t(11934),Bt=t(19086),bt=t(64018),Mt=["formulaBar"],Ot=["detailVisual"];function xt(o,n){if(1&o&&m.\u0275\u0275element(0,"outline-overlay-lazy",8),2&o){var r=m.\u0275\u0275nextContext();m.\u0275\u0275property("regionOutlinesData",r.regionOutlinesData)}}var St=function(){return{formulaBarParentClass:".visualCalcEditor",expandScaleFactor:.5,expandOffet:0,fullyExpandedTooltip:"Formula_Bar_ExpandToMultiLine"}},Pt=function(o){function n(r,s,l,d,p,v,M,F,C){var g=o.call(this)||this;return g.behaviourService=r,g.intellisenseModelService=s,g.featureSwitchService=l,g.visualCalcEagerService=d,g.visualCalcDaxTemplateService=p,g.lazyScopeProvider=v,g.visualCalcTutorialService=M,g.subSelectionOutlineManager=F,g.visualContainerSubSelectionHostServiceFactory=C,g.visualHTMLElementChanged=new m.EventEmitter,g.templateSelected=g.createEventAdapter(),g.visualCalculationTemplates=g.visualCalcDaxTemplateService.getTemplates(),g.enableSubSelection=g.featureSwitchService.featureSwitches.enableCalculationHighlighting,g.enableSubSelection&&(g.subSelectionHostService=g.visualContainerSubSelectionHostServiceFactory.create(),g.regionOutlinesData={regionOutlines$:g.subSelectionOutlineManager.getRegionOutlines$()}),g}return(0,S.__extends)(n,o),Object.defineProperty(n.prototype,"_detailVisualElementRef",{set:function(s){var l=s?.nativeElement,d=l!==this.detailVisualElement;this.detailVisualElement=l,d&&this.visualHTMLElementChanged.emit(l)},enumerable:!1,configurable:!0}),n.prototype.ngAfterViewInit=function(){var r=this,s=(0,_e.T)((0,Ie.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"click"),(0,Ie.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"keydown").pipe((0,Ce.h)(function(d){return"Enter"===d.key}))),l=(0,_e.T)(this.visualCalcEagerService.onEditContextChange$(),this.templateSelected.$).pipe((0,re.R)(this.onDestroy$));this.visualCalcEagerService.onViewContextChanged$().pipe((0,re.R)(this.onDestroy$),(0,Ye.b)(function(){return He.IK.focus(r.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"))}),(0,Ve.w)(function(){return s.pipe((0,re.R)(l),(0,qe.q)(1))})).subscribe(function(){return(0,S.__awaiter)(r,void 0,void 0,function(){return(0,S.__generator)(this,function(p){switch(p.label){case 0:return[4,this.lazyScopeProvider.get(be.w)];case 1:return[4,p.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Custom")];case 2:return p.sent(),[2]}})})}),this.visualCalcTutorialService.showTutorial()},n.prototype.ngOnInit=function(){var r=this;this.behaviourService.setVisualContainer(this.visualContainer),this.intellisenseModelService.setVisualContainer(this.visualContainer),this.hostServices=this.parentHostServices,this.enableSubSelection&&(this.hostServices=(0,tt.ED)(this.parentHostServices,function(s){s.getSubSelectionService=function(){return r.getVisualSubSelectionHostService()}}),this.subSelectionOutlineManager.registerVisualContainer(this.visualContainer.name,this.subSelectionHostService.regionOutlines$,"annotation"))},n.prototype.ngOnDestroy=function(){return this.enableSubSelection&&this.subSelectionOutlineManager.deregisterVisualContainer(this.visualContainer.name,"annotation"),o.prototype.ngOnDestroy.call(this)},n.prototype.onRightClick=function(r){r.stopPropagation()},n.prototype.getVisualSubSelectionHostService=function(){var r=this;return{clearAllRegionOutlines:function(){return r.subSelectionHostService.clearAllRegionOutlines()},getAllRegionOutlines:function(){return r.subSelectionHostService.getAllRegionOutlines()},getRegionOutline:function(l){return r.subSelectionHostService.getRegionOutline(l)},updateRegionOutlines:function(l){var d,p,v=null===(d=r.detailVisualComponent)||void 0===d?void 0:d.getVisualComponentBoundingClientRect();v&&r.subSelectionHostService.updateVisualRegionOutlines(l,null===(p=r.detailVisualElement)||void 0===p?void 0:p.getBoundingClientRect(),v,!1)}}},n.\u0275fac=function(s){return new(s||n)(m.\u0275\u0275directiveInject(Be.n9),m.\u0275\u0275directiveInject(Be.Pm),m.\u0275\u0275directiveInject(E.vZ),m.\u0275\u0275directiveInject(ge.w),m.\u0275\u0275directiveInject(Ee),m.\u0275\u0275directiveInject($e.H),m.\u0275\u0275directiveInject(Ke),m.\u0275\u0275directiveInject(Ae.g),m.\u0275\u0275directiveInject(vt._))},n.\u0275cmp=m.\u0275\u0275defineComponent({type:n,selectors:[["visual-calc-editor"]],viewQuery:function(s,l){if(1&s&&(m.\u0275\u0275viewQuery(Mt,5,m.ElementRef),m.\u0275\u0275viewQuery(Ot,5,m.ElementRef),m.\u0275\u0275viewQuery(Ne.X,5)),2&s){var d=void 0;m.\u0275\u0275queryRefresh(d=m.\u0275\u0275loadQuery())&&(l.formulaBar=d.first),m.\u0275\u0275queryRefresh(d=m.\u0275\u0275loadQuery())&&(l._detailVisualElementRef=d.first),m.\u0275\u0275queryRefresh(d=m.\u0275\u0275loadQuery())&&(l.detailVisualComponent=d.first)}},inputs:{visualContainer:"visualContainer",themeCollection:"themeCollection",viewport:"viewport",parentHostServices:"parentHostServices",detailVisualSpinnerActionCallback:"detailVisualSpinnerActionCallback"},outputs:{visualHTMLElementChanged:"visualHTMLElementChanged"},features:[m.\u0275\u0275ProvidersFeature([et.B,We,pt,De.Dz,Pe,Re.e,Ke,Ae.g]),m.\u0275\u0275InheritDefinitionFeature],decls:8,vars:16,consts:[["data-automation-type","visualCalcEditor","role","document",1,"visualCalcEditor",3,"contextmenu"],["visualCalcEditor",""],[3,"isActive","autoHide","expandCollapseConfig","implicitEndEditingOnBlur","navMode","shouldAlwaysEnableCancelButton","daxTemplates","templateSelected"],["formulaBar",""],[1,"visualWithOutlinesOverlay"],["data-automation-type","detailVisual",3,"inVisualCalcMode","parentHostServices","visualContainer","themeCollection","viewport","detailVisualSpinnerActionCallback","applyUIThemeToVisualModern"],["detailVisual",""],["class","outlinesOverlayContainer",3,"regionOutlinesData",4,"ngIf"],[1,"outlinesOverlayContainer",3,"regionOutlinesData"]],template:function(s,l){1&s&&(m.\u0275\u0275elementStart(0,"div",0,1),m.\u0275\u0275listener("contextmenu",function(p){return l.onRightClick(p)}),m.\u0275\u0275elementStart(2,"formula-bar",2,3),m.\u0275\u0275listener("templateSelected",function(){return l.templateSelected.fn()}),m.\u0275\u0275elementEnd(),m.\u0275\u0275elementStart(4,"div",4),m.\u0275\u0275element(5,"detail-visual",5,6),m.\u0275\u0275template(7,xt,1,1,"outline-overlay-lazy",7),m.\u0275\u0275elementEnd()()),2&s&&(m.\u0275\u0275advance(2),m.\u0275\u0275property("isActive",!0)("autoHide",!1)("expandCollapseConfig",m.\u0275\u0275pureFunction0(15,St))("implicitEndEditingOnBlur",!1)("navMode",void 0)("shouldAlwaysEnableCancelButton",!1)("daxTemplates",l.visualCalculationTemplates),m.\u0275\u0275advance(3),m.\u0275\u0275property("inVisualCalcMode",!0)("parentHostServices",l.hostServices)("visualContainer",l.visualContainer)("themeCollection",l.themeCollection)("viewport",l.viewport)("detailVisualSpinnerActionCallback",l.detailVisualSpinnerActionCallback)("applyUIThemeToVisualModern",!0),m.\u0275\u0275advance(2),m.\u0275\u0275property("ngIf",l.enableSubSelection))},dependencies:[h.NgIf,Ne.X,Bt.P,bt.L],styles:[".visualCalcEditor[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:visible;flex-grow:1;box-sizing:border-box;border-width:10px 10px 0 10px;border-style:solid;border-color:var(--colorNeutralStroke1);background-color:var(--colorNeutralBackground1)}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]{position:relative;flex-basis:0;flex-grow:1;overflow:hidden;display:flex}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   detail-visual[_ngcontent-%COMP%]{flex:1;height:100%;z-index:0}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   .outlinesOverlayContainer[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;box-sizing:border-box;z-index:1;pointer-events:none;background:transparent}"]}),n}(ze.w),_t=t(94419),gt=t(46135),wt=function(){function o(n,r,s,l,d,p,v,M,F,C,g){this.conceptualSchemaProxy=n,this.dataSources=r,this.vcEagerService=s,this.visualAuthoring=l,this.visibilityService=d,this.panesVisibilityService=p,this.featureSwitchService=v,this.visualAuthoringOperationService=M,this.certifiedEventsService=F,this.telemetryService=C,this.explorationCapabilitiesService=g}return o.prototype.enterVisualCalcMode=function(n,r,s,l){return(0,S.__awaiter)(this,void 0,void 0,function(){var d;return(0,S.__generator)(this,function(v){switch(v.label){case 0:return 16!==n.visibility&&(n.config.singleVisual.autoSelectVisualType=!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return d=v.sent(),[4,this.visualAuthoring.ensureNativeReferenceName(d,n)];case 2:return v.sent(),this.panesVisibilityService.closePane("quickMeasures"),this.featureSwitchService.featureSwitches.onObject&&this.panesVisibilityService.setPaneExpansion("build",!0,!0),_.isEmpty(r)?[4,this.enterVisualCalcEditingModeWithPlaceHolder(n,"Custom",void 0,void 0,s,l)]:[3,4];case 3:return v.sent(),[3,5];case 4:this.vcEagerService.enterEditMode(r,"Custom",!1),v.label=5;case 5:return this.visibilityService.set(n,16),[2]}})})},o.prototype.updateVisualCalculation=function(n,r,s,l,d){return(0,S.__awaiter)(this,void 0,void 0,function(){var p,v,F,C;return(0,S.__generator)(this,function(g){switch(g.label){case 0:return C=(0,ue.dQ)(n,l),p=C.fieldIndex,v=C.role,f.fF.assert(function(){return p>=0},"Query name of field doesn't exist"),[4,this.visualAuthoring.updateVisualCalculation({visualContainer:n,fieldIndex:p,role:v,name:r,expression:s,shouldUnhide:d,dataType:void 0},d)];case 1:return F=g.sent(),this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:"VisualCalculationSubmitted",activityName:ge.f,activityStatus:"Succeeded",resultCode:"",activityAttributes:{initialCreation:d}}),[2,F]}})})},o.prototype.removeVisualCalculation=function(n,r){return(0,S.__awaiter)(this,void 0,void 0,function(){var s,l,d,p;return(0,S.__generator)(this,function(v){switch(v.label){case 0:return p=(0,ue.dQ)(n,r),s=p.fieldIndex,l=p.role,f.fF.assert(function(){return s>=0},"Query name of field doesn't exist"),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return d=v.sent(),[2,this.visualAuthoringOperationService.removeFieldFromRole({role:l,projOptions:{fieldIndex:s}},d,n)]}})})},o.prototype.enterVisualCalcEditingModeWithPlaceHolder=function(n,r,s,l,d,p){return(0,S.__awaiter)(this,void 0,void 0,function(){var v,M,F,C,g,k;return(0,S.__generator)(this,function(K){switch(K.label){case 0:return v=(0,fe.Xf)(n),M=(0,ue.ND)(v,l),F=this.dataSources.get(),C=(0,_t.YU)(M,"BLANK()"),g=!1,null==d?[3,2]:[4,this.visualAuthoring.addFieldInRole(C,d,F,n,void 0,void 0,void 0,!0,!0,p)];case 1:return g=K.sent(),[3,4];case 2:return[4,this.visualAuthoring.addFieldToVisual(C,F,n,"VisualCalculationMode",!0,!0,p)];case 3:g=K.sent(),K.label=4;case 4:return g&&(k=(0,ue.oG)((0,fe.Xf)(n),M),this.vcEagerService.enterEditMode(k,r,!0,s)),[2,g]}})})},o.prototype.getVisualCalcCreationInfo=function(n,r,s){var l,d;return(0,S.__awaiter)(this,void 0,void 0,function(){var p,F;return(0,S.__generator)(this,function(g){switch(g.label){case 0:return p=this.explorationCapabilitiesService.getCapabilities(),p?.disableVisualCalcAuthoring?[2,{supportVisualCalcCreation:!1}]:[4,this.vcEagerService.canSupportVisualCalc(n)];case 1:return g.sent()?(null===(d=null===(l=n?.config)||void 0===l?void 0:l.singleVisual)||void 0===d?void 0:d.autoSelectVisualType)?[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:!(F=_.find(r.dataRoles,function(k){return k.name===s}))||F.kind!==gt.DW.Measure&&F.kind!==gt.DW.GroupingOrMeasure?[2,{supportVisualCalcCreation:!1}]:[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:[2,{supportVisualCalcCreation:!1}]}})})},o.\u0275fac=function(r){return new(r||o)(m.\u0275\u0275inject(I.i),m.\u0275\u0275inject(V.D),m.\u0275\u0275inject(ge.w),m.\u0275\u0275inject(he.$8),m.\u0275\u0275inject(pe.w),m.\u0275\u0275inject(w.r),m.\u0275\u0275inject(E.vZ),m.\u0275\u0275inject(x.Q),m.\u0275\u0275inject(O.ly),m.\u0275\u0275inject(O.y0),m.\u0275\u0275inject(H.U))},o.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),Ft=[{type:Pt,componentId:"VisualCalcEditorComponentId"}],Ct={provide:"VisualCalcService",useFactory:yt,deps:[I.i,V.D,ge.w,he.$8,pe.w,w.r,E.vZ,x.Q,O.ly,O.y0,ee.t,H.U]};function yt(o,n,r,s,l,d,p,v,M,F,C,g){var k=new wt(o,n,r,s,l,d,p,v,M,F,g);return C.resolve(k)}var It=function(){function o(){}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=m.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=m.\u0275\u0275defineInjector({providers:[Ct,Ee],imports:[h.CommonModule,T.J,L.u5,U.j,Y.N.withManifests(Ft),J.v,q.U,G.p]}),o}()},64018:function(me,W,t){t.d(W,{L:function(){return Se}});var h=t(81337),L=t(15903),O=t(81892),I="padding-left",V="padding-right",w="padding-top",H="padding-bottom",x="margin-left",T="margin-right",E="margin-top",U="margin-bottom",G="border-left-width",Y="border-right-width",J="border-top-width",q="border-bottom-width";function N(a,i){return 1===i?parseInt(a.css(I),10)+parseInt(a.css(V),10):parseInt(a.css(w),10)+parseInt(a.css(H),10)}function f(a,i){return 1===i?parseInt(a.css(x),10)+parseInt(a.css(T),10):parseInt(a.css(E),10)+parseInt(a.css(U),10)}function B(a,i){return 1===i?parseInt(a.css(G),10)+parseInt(a.css(Y),10):parseInt(a.css(J),10)+parseInt(a.css(q),10)}function D(a){return parseInt(a.css("minWidth"),10)}function X(a,i,u){for(var c=f(a,u),y=$("html")[0],P=a.parent();P.length>0&&P[0]!==y&&P[0]!==i[0];)c=c+N(P,u)+B(P,u)+f(P,u),P=P.parent();return P[0]===i[0]?c=c+N(P,u)+B(P,u):0}var z=t(26124),e=t(50423),le=t(47786),Q=t(74249),oe=t(62458),b=t(2951),m=t(25261),ye=t(1685),ve=t(30794),Ee=t(35510),Qe=t(82762),Ze=t(59017),Xe=t(77526),Je=t(14172),Fe=t(83317),Me=t(64647),ge=t(83309),S=t(15783),_e=t(65181),Ie=t(85270),Ce=t(77476),re=t(17174),Ye=t(59968),Ve=t(36858),qe=t(45916),Be=t(698),et=t(35756),De=t(20551),Re=t(64716),Ne=t(85721),He=t(74913),tt=t(4715),ze=t(21571),Ae=t(73221),be=t(98665),Oe=t(64560),nt=t(25512),xe=t(48787),ot=t(5467),je=t(85102);function rt(a,i){if(1&a){var u=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1),e.\u0275\u0275listener("click",function(y){e.\u0275\u0275restoreView(u);var P=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(P.showTemplatesMenu(y))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",2),e.\u0275\u0275elementEnd()}2&a&&e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,1,"Visual_Calculation_Template_Button_Tooltip"))}var it=function(a){function i(u,c,y,P){var j=a.call(this)||this;return j.elementRef=u,j.pbiMenuService=c,j.localizationService=y,j.telemetryService=P,j.selectedTemplate=new e.EventEmitter,j.showButton$=new Ee.X(!1),j}return(0,h.__extends)(i,a),i.prototype.ngOnInit=function(){var u=this;this.changes$("daxTemplates").pipe((0,Fe.R)(this.onDestroy$)).subscribe(function(c){u.createTemplateMenu(c)})},i.prototype.showTemplatesMenu=function(u){var c=this;u.preventDefault();var y=this.templatingMenu;null!=y&&0!==y.items.length&&this.pbiMenuService.open({menu:y,origin:this.elementRef.nativeElement,flexibleConnectedPositions:[(0,nt.Oq)(0,0)],closeOnButtonClick:!0,menuMode:Oe.Kb.Compact}).onButtonClick$.pipe((0,xe.q)(1)).subscribe(function(j){var te=j.data;c.selectedTemplate.emit(te),c.telemetryService.logEvent(tt.Zs,{templateName:te.capabilities.name})})},i.prototype.createTemplateMenu=function(u){var c=this,y=_.map(u,function(P){var j=P.capabilities;return{type:Oe.iB.Button,id:j.name,text:(0,ze.G)(j.displayName,c.localizationService),tooltip:(0,ze.G)(j.description,c.localizationService),data:P}});this.templatingMenu={items:y},this.showButton$.next(y.length>0)},i.\u0275fac=function(c){return new(c||i)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(ot.o),e.\u0275\u0275directiveInject(_e.o),e.\u0275\u0275directiveInject(be.y0))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["template-button"]],inputs:{daxTemplates:"daxTemplates"},outputs:{selectedTemplate:"selectedTemplate"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","templateButton","tabindex","0",3,"pbiTooltip","click",4,"ngIf"],["tabindex","0",1,"templateButton",3,"pbiTooltip","click"],["tri-svg-icon-24","","name","math_formula_20_regular","sprite","visual-calc-icons"]],template:function(c,y){1&c&&(e.\u0275\u0275template(0,rt,3,3,"button",0),e.\u0275\u0275pipe(1,"async")),2&c&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,y.showButton$))},dependencies:[Ce.NgIf,Ve.V,He.M,Ce.AsyncPipe,je.F],styles:[".templateButton[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:24px;background-color:transparent}.templateButton[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2)}.templateButton[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground1Hover)}.templateButton[_ngcontent-%COMP%]:hover   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Hover)}.templateButton[_ngcontent-%COMP%]:active   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Pressed)}"]}),i}(Ae.w),Ue=["monacoEditorHostContainer"];function at(a,i){if(1&a){var u=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"monaco-editor-host",21),e.\u0275\u0275listener("initialized",function(){e.\u0275\u0275restoreView(u);var j=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(j.onMonacoEditorInitialized())})("tabFocusMode",function(j){e.\u0275\u0275restoreView(u);var te=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(te.onTabFocusModeChanged(j))})("onContentChanged",function(j){e.\u0275\u0275restoreView(u);var te=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(te.onContentChanged(j))})("onContentHeightChanged",function(j){e.\u0275\u0275restoreView(u);var te=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(te.onContentHeightChanged(j))})("onFocus",function(){e.\u0275\u0275restoreView(u);var j=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(j.onEditorFocus())}),e.\u0275\u0275elementEnd()}if(2&a){var c=i.ngIf,y=e.\u0275\u0275nextContext();e.\u0275\u0275property("selection",y.editorHost.selection)("isReadOnly",y.isReadOnly)("formulaText",y.editorHost.text)("languageOptions",c)("hidden",!y.isEditorEnabled)}}function st(a,i){if(1&a){var u=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",22),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(u);var y=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(y.toggleTabMovesFocus())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}2&a&&e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,1,"Tab_Moves_Focus_Toggle"))}function fe(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275element(1,"pbi-svg-use-symbol",24)(2,"tri-svg-icon",25)(3,"textarea",26),e.\u0275\u0275elementEnd()),2&a){var u=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",u.alertText)("ngModel",u.alertText),e.\u0275\u0275attribute("aria-label",u.alertText)}}function lt(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tri-dropdown-trigger"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&a){var u=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,e.\u0275\u0275pipeBind1(3,3,u.selectedEditModeOption$).displayName)," ")}}function ut(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",27),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&a){var u=i.$implicit;e.\u0275\u0275property("value",u),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,u.displayName)," ")}}var ke="monaco-editor-host",Le=".formulaBarButtons",We=".formulaBarController",pt=[".formulaBarEditorContainer",Le,"ribbon [data-unique-id='clipboardGroupMlr'], ribbon [data-unique-id='clipboardGroupSlr'], .ms-Callout #FlyoutMenuId","ribbon [data-automation-type='RibbonTab'][data-unique-id='home']"],Se=function(){function a(i,u,c,y,P,j,te,ft,ht){var ie=this;this.element=i,this.highContrastCssGenerationService=u,this.formulaBarService=c,this.localizationService=y,this.screenReaderService=P,this.formulaBarInteractionService=j,this.cdr=te,this.daxCapabilitiesService=ft,this.formulaBarZoomService=ht,this.catchOutsideClickEventCallBack=function(ce){return!1},this.implicitEndEditingOnBlur=!0,this.navMode="Group",this.daxTemplates=[],this.beginEdit=new e.EventEmitter,this.endEdit=new e.EventEmitter,this.templateSelected=new e.EventEmitter,this.editorHost={},this.formulaBarDropdownConfigurations=[],this.destroy$=new ve.xQ,this._dropdownOptions$=new Ee.X(void 0),this._dropdownVisible$=new Ee.X(!1),this._selectedEditModeOption$=new Ee.X(void 0),this.onDocumentMouseDownCapture=function(ce){ie.lastCapturedMousedownEvent=ce,Te(ce.target)||ie.formulaBarService.hasUnsavedChanges(ie.getCurrentEditorText())&&ce.stopImmediatePropagation()},this.onDocumentClickCapture=function(ce){var Pe=ie.lastCapturedMousedownEvent&&ie.lastCapturedMousedownEvent.target;ie.lastCapturedMousedownEvent=void 0;var we=!Pe||Te(Pe),Ke=Te(ce.target);we||Ke||ie.catchOutsideClickEventCallBack(ce)||(ie.formulaBarService.hasUnsavedChanges(ie.getCurrentEditorText())&&(ce.stopPropagation(),ce.preventDefault()),ie.onBlur())},this.triDropdownOptions={panelClass:O.Uu},this.expandedState=1,this.languageOptions$=(0,Qe.D)(this.daxCapabilitiesService.getCapabilities())}return Object.defineProperty(a.prototype,"selectedEditModeOption$",{get:function(){return this._selectedEditModeOption$},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"editMode$",{get:function(){return this._selectedEditModeOption$.pipe((0,Xe.x)(),(0,Je.U)(function(u){return u?.key}))},enumerable:!1,configurable:!0}),a.prototype.setEditMode=function(i){var u=this.formulaBarDropdownConfigurations.findIndex(function(c){return c.key===i});(0,le.hu)(u>-1,"Invalid calculation edit mode"),this._selectedEditModeOption$.next(this.formulaBarDropdownConfigurations[u])},Object.defineProperty(a.prototype,"editModeOptions$",{get:function(){return this._dropdownOptions$.asObservable()},enumerable:!1,configurable:!0}),a.prototype.setEditModeOptions=function(i){this._dropdownOptions$.next(i),this._selectedEditModeOption$.next(void 0)},Object.defineProperty(a.prototype,"showEditModeSelector$",{get:function(){return this._dropdownVisible$.asObservable()},enumerable:!1,configurable:!0}),a.prototype.showEditModeSelector=function(i){this._dropdownVisible$.next(i)},a.prototype.ngOnInit=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,h.__generator)(this,function(u){switch(u.label){case 0:return this.initializeHighContrastRules(),this.isHidden=this.autoHide,this.setReadOnly(!0),(0,Ze.aj)([this._dropdownOptions$,this._dropdownVisible$]).pipe((0,Fe.R)(this.destroy$)).subscribe(function(c){var P=c[1];i.formulaBarDropdownConfigurations=c[0],i.formulaDropdownWidth=P?D($(".dropdownContainer")):0,i.recalculateOffset(),i.onResize()}),[4,this.formulaBarService.setUICulture()];case 1:return u.sent(),[2]}})})},a.prototype.ngAfterViewInit=function(){var i=this;this.formulaBarService.registerFormulaBarControl(this),this.formulaBarInteractionService.registerFormulaBarInteractionControl(this),this.resizeObserver=new ResizeObserver(function(){window.requestAnimationFrame(function(){i.onResize()})}),this.resizeObserver.observe(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass))},a.prototype.ngOnDestroy=function(){$(this.element.nativeElement).off(We),$(this.monacoEditorHostContainer.nativeElement).off(We),this.destroy$.next(),this.destroy$.complete(),this.resizeObserver&&(this.resizeObserver.unobserve(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass)),this.resizeObserver.disconnect())},a.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert, formula-bar .formulaBar .formulaBarAlert .messageAlert","{ background-color: @backgroundColor !important; color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert","{ border: 1px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarEditorContainer","{ background-color: @backgroundColor !important; }")},Object.defineProperty(a.prototype,"willCollapse",{get:function(){return 0===this.nextExpandCollapseState},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isEditorEnabled",{get:function(){return!!this.lastCommittedFormulaText||this.isEditing},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"formulaBarExpanderTooltip",{get:function(){var u,c="Formula_Bar_ExpandToFull";switch(this.nextExpandCollapseState){case 0:c="Formula_Bar_CollapseToSingleLine";break;case 1:c="Formula_Bar_ExpandToFit";break;case 2:c=null!==(u=this.expandCollapseConfig.fullyExpandedTooltip)&&void 0!==u?u:"Formula_Bar_ExpandToFull"}return this.localizationService.get(c)},enumerable:!1,configurable:!0}),a.prototype.setReadOnly=function(i){this.isReadOnly=i},a.prototype.onMonacoEditorInitialized=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var i,u,c;return(0,h.__generator)(this,function(y){switch(y.label){case 0:return this.monacoEditorInitialized=!0,i=$(this.element.nativeElement),u=function(a){return parseInt(a.css("min-height"),10)}(i),c=function(a){return parseInt(a.css("max-height"),10)}(i),this.monacoEditorUtility=new b.j0(this.textEditorHost.textEditor),[4,this.textEditorHost.registerActions(this.getKeyboardActions())];case 1:return y.sent(),this.textEditorHeightOffset=this.calculateTextEditorHeightOffset(),this.recalculateOffset(),this.textEditorFullExpandHeight=c-this.textEditorHeightOffset,this.textEditorCollapsedHeight=u-this.textEditorHeightOffset,this.targetEditorHeight=this.textEditorCollapsedHeight,this.onContentHeightChanged(this.textEditorHost.textEditor.getContentHeight()),this.onResize(),this.focusOnInitialized&&this.focus(),[2]}})})},a.prototype.calculateTextEditorHeightOffset=function(){var i=$(this.element.nativeElement);return X(i.find(ke),i,0)},a.prototype.onTabFocusModeChanged=function(i){this.tabMovesFocus=i},a.prototype.updateEditorExpandedHeight=function(){var i,u,c=this.alertText?20:0,y=this.expandCollapseConfig.formulaBarParentClass,P=null!==(i=this.expandCollapseConfig.expandScaleFactor)&&void 0!==i?i:1,j=null!==(u=this.expandCollapseConfig.expandOffet)&&void 0!==u?u:-80,te=P*$(this.element.nativeElement).closest(y).height()+j;this.textEditorFullExpandHeight=te-this.textEditorHeightOffset-c},a.prototype.updateFormulaBarMaxHeight=function(){var i=this.alertText?20:0,u=1e7;0===this.expandedState?u=this.textEditorCollapsedHeight+this.textEditorHeightOffset+i:1===this.expandedState&&(u=this.targetEditorHeight+this.textEditorHeightOffset+i),oe.fF.assertValue(u,"maxHeight"),$(this.element.nativeElement).css("max-height",u)},a.prototype.show=function(){this.isHidden&&(this.isHidden=!1,this.cdr.detectChanges())},a.prototype.hide=function(){this.isHidden||(this.isHidden=!0)},a.prototype.clear=function(){this.setCommittedFormulaBarText(""),this.autoHide&&this.hide()},a.prototype.setSelection=function(i){this.editorHost.selection=i,this.cdr.detectChanges()},a.prototype.showAlertMessage=function(i){i=i.replace(/\n/g,""),this.alertText=i,this.screenReaderService.alert(this.localizationService.format("Formula_Bar_Warning_Aria",i)),this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},a.prototype.toggleTabMovesFocus=function(){this.textEditorHost.toggleTabMovesFocus(),this.textEditorHost.focus()},a.prototype.hideAlert=function(){this.alertText=void 0,this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},a.prototype.setCommittedFormulaBarText=function(i){this.lastCommittedFormulaText=i,this.editorHost.text=i,this.cdr.detectChanges()},a.prototype.focus=function(){this.monacoEditorInitialized?(this.textEditorHost.focus(),this.cdr.detectChanges()):this.focusOnInitialized=!0},a.prototype.scrollTop=function(){this.monacoEditorInitialized&&this.textEditorHost.scrollTop()},a.prototype.copy=function(){this.textEditorHost.copy()},a.prototype.cut=function(){this.textEditorHost.cut()},a.prototype.paste=function(i){this.textEditorHost.paste(i)},a.prototype.resetModelTokens=function(i){this.textEditorHost.resetModelTokens(i)},a.prototype.isFormulaBarActive=function(){return this.isActive},a.prototype.onToggleExpandCollapse=function(){this.setExpandCollapseState(this.nextExpandCollapseState)},a.prototype.setExpandCollapseState=function(i){switch(i){case 0:this.collapse();break;case 1:this.fitToContent();break;case 2:this.fullExpand()}this.calculateNextExpandCollapseState()},a.prototype.calculateNextExpandCollapseState=function(){switch(this.expandedState){case 0:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?2:1;break;case 1:this.nextExpandCollapseState=this.editorContentHeight>=this.textEditorFullExpandHeight?0:this.editorContentHeight<=this.textEditorCollapsedHeight||this.isEditing?2:0;break;case 2:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?1:0;break;default:oe.fF.assertNever(this.expandedState)}},a.prototype.fullExpand=function(){this.expandedState=2,this.updateEditorExpandedHeight(),this.layout(void 0,this.textEditorFullExpandHeight)},a.prototype.fitToContent=function(){this.expandedState=1,this.updateEditorExpandedHeight(),this.targetEditorHeight=Math.max(this.textEditorCollapsedHeight,Math.min(this.textEditorFullExpandHeight,this.editorContentHeight)),this.layout(void 0,this.targetEditorHeight)},a.prototype.collapse=function(){this.expandedState=0,this.layout(void 0,this.textEditorCollapsedHeight)},a.prototype.layout=function(i,u){this.updateFormulaBarMaxHeight(),this.monacoEditorInitialized&&this.textEditorHost.layout(i,u)},a.prototype.recalculateOffset=function(){var i,u=$(Le),c=$(this.element.nativeElement),y=c.find(ke);this.textEditorWidthOffset=X(y,c,1)+D(u)+f(u,1)+(null!==(i=this.formulaDropdownWidth)&&void 0!==i?i:0)},a.prototype.commitFormulaBarEdit=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var i;return(0,h.__generator)(this,function(u){switch(u.label){case 0:return this.endFormulaEdit(),(i=this.getCurrentEditorText())===this.lastCommittedFormulaText?[3,2]:(this.lastCommittedFormulaText=i,[4,this.formulaBarService.onSubmit(i)]);case 1:return u.sent(),[3,4];case 2:return[4,this.formulaBarService.onSubmit(i)];case 3:u.sent(),u.label=4;case 4:return[2]}})})},a.prototype.onBlur=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(i){switch(i.label){case 0:return this.implicitEndEditingOnBlur?this.endFormulaEdit():(this.removeFocus(),this.removeCatchClickOutsideFormulaBar()),this.lastCommittedFormulaText=this.monacoEditorInitialized?this.getCurrentEditorText():"",[4,this.formulaBarService.onBlur(this.lastCommittedFormulaText)];case 1:return[2,i.sent()]}})})},a.prototype.removeFocus=function(){$(document.activeElement).blur(),$(document.body).focus()},a.prototype.onContentChanged=function(i){var u=this.monacoEditorUtility.getCursorPosition();this.formulaBarService.onContentChanged(this.monacoEditorUtility.getEditorText(),u.position,u.selectionStart,i)},a.prototype.onContentHeightChanged=function(i){this.editorContentHeight=i+2,(1===this.expandedState||0===this.expandedState&&this.isEditing)&&this.fitToContent(),this.calculateNextExpandCollapseState()},a.prototype.submit=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(i){switch(i.label){case 0:return[4,this.commitFormulaBarEdit()];case 1:return i.sent(),[2]}})})},a.prototype.cancel=function(){this.endFormulaEdit(),this.formulaBarService.onCancel(this.lastCommittedFormulaText),this.autoHide&&this.hide()},a.prototype.onEditorFocus=function(){this.isEditorEnabled&&(this.isReadOnly||this.isEditing?this.implicitEndEditingOnBlur||this.catchClickOutsideFormulaBar():this.beginFormulaEdit(),this.formulaBarService.onEditorFocus())},a.prototype.catchClickOutsideFormulaBar=function(){document.body.addEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.addEventListener("click",this.onDocumentClickCapture,!0),document.body.addEventListener("contextmenu",this.onDocumentClickCapture,!0)},a.prototype.removeCatchClickOutsideFormulaBar=function(){document.body.removeEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.removeEventListener("click",this.onDocumentClickCapture,!0),document.body.removeEventListener("contextmenu",this.onDocumentClickCapture,!0)},a.prototype.endFormulaEdit=function(){this.isEditing=!1,this.removeFocus(),this.removeCatchClickOutsideFormulaBar(),this.endEdit.emit()},a.prototype.beginFormulaEdit=function(){this.isEditing=!0,this.catchClickOutsideFormulaBar(),this.beginEdit.emit()},a.prototype.onResize=function(){var i,u;if(this.monacoEditorInitialized){var c;2===this.expandedState?(this.updateEditorExpandedHeight(),c=this.textEditorFullExpandHeight):1===this.expandedState&&(this.updateEditorExpandedHeight(),c=Math.min(this.textEditorFullExpandHeight,this.targetEditorHeight));var y=this.element.nativeElement.getBoundingClientRect().width||1e3,P=null!==(u=null===(i=this.formulaBarZoomService)||void 0===i?void 0:i.getZoomLevel())&&void 0!==u?u:1;this.layout(y/P-this.textEditorWidthOffset,c)}},a.prototype.selectTemplate=function(i){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(u){switch(u.label){case 0:return[4,this.formulaBarService.onTemplateSelection(i)];case 1:return u.sent(),this.templateSelected.emit(),[2]}})})},a.prototype.insertTextAtCurrentCursor=function(i){this.textEditorHost.insertTextAtCurrentCursor(i)},a.prototype.getCurrentEditorText=function(){return this.textEditorHost.getText()},a.prototype.getHighlightedText=function(){return this.textEditorHost.getHighlightedText()},a.prototype.getKeyboardActions=function(){var i=this;return[{id:"formulaBar.find",label:"Find",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.CtrlF]],run:_.noop},{id:"formulaBar.findNext",label:"Find next",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.F3]],run:_.noop},{id:"formulaBar.findPrevious",label:"Find previous",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.CtrlF3]],run:_.noop},{id:"formulaBar.replace",label:"Replace",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.CtrlH]],run:_.noop},{id:"formulaBar.errorNavigator",label:"Error navigator",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.F8]],run:_.noop},{id:"formulaBar.escape",label:"Escape",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.Escape]],run:function(){var c=i.textEditorHost.textEditor.getSelections();c.length<=1?i.cancel():i.textEditorHost.textEditor.setSelection(c[0])},keybindingContext:"!".concat(b.B6,"&&!").concat(b.HW,"&&!").concat(b.s1)},{id:"formulaBar.submit",label:"Submit",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.CtrlEnter]],run:function(){i.submit()}},{id:"formulaBar.enter",label:"Enter",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.Enter]],run:function(){i.submit()},keybindingContext:"!".concat(b.HW)},{id:"formulaBar.toggleExpandCollapse",label:"Toggle expand collapse",keybindings:[this.textEditorHost.monacoKeybindingsMap[m.f.CtrlJ]],run:function(){i.onToggleExpandCollapse()}}]},a.\u0275fac=function(u){return new(u||a)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Me.g),e.\u0275\u0275directiveInject(S.B),e.\u0275\u0275directiveInject(_e.o),e.\u0275\u0275directiveInject(ge.g),e.\u0275\u0275directiveInject(Ie.l),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Q.r),e.\u0275\u0275directiveInject(L.$d,8))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["formula-bar"]],viewQuery:function(u,c){if(1&u&&(e.\u0275\u0275viewQuery(Ue,7,e.ElementRef),e.\u0275\u0275viewQuery(ye.C,5)),2&u){var y=void 0;e.\u0275\u0275queryRefresh(y=e.\u0275\u0275loadQuery())&&(c.monacoEditorHostContainer=y.first),e.\u0275\u0275queryRefresh(y=e.\u0275\u0275loadQuery())&&(c.textEditorHost=y.first)}},hostVars:1,hostBindings:function(u,c){1&u&&e.\u0275\u0275listener("desktopUIResizeFormulaBar",function(){return c.onResize()}),2&u&&e.\u0275\u0275hostProperty("hidden",c.isHidden)},inputs:{autoHide:"autoHide",isActive:"isActive",catchOutsideClickEventCallBack:"catchOutsideClickEventCallBack",expandCollapseConfig:"expandCollapseConfig",implicitEndEditingOnBlur:"implicitEndEditingOnBlur",navMode:"navMode",shouldAlwaysEnableCancelButton:"shouldAlwaysEnableCancelButton",daxTemplates:"daxTemplates"},outputs:{beginEdit:"beginEdit",endEdit:"endEdit",templateSelected:"templateSelected"},decls:29,vars:42,consts:[["keyboard-shortcuts","ctrl-F6","focus-priority","11",1,"formulaBar",3,"hidden","on-resize"],[1,"formulaBarEditorContainer"],[1,"formulaBarEditor"],["tabindex","0",1,"formulaBarEditorMain",3,"keydown.enter"],["monacoEditorHostContainer",""],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus",4,"ngIf"],["data-unique-id","formula-bar-chevron",1,"formulaBarExpander",3,"disabled","pbiTooltip","click"],["tri-svg-icon-16","","name","chevron_down_16_regular"],[1,"accessibililtyMessages"],["class","message","localize","Tab_Moves_Focus",3,"pbiTooltip","click",4,"ngIf"],["class","formulaBarAlert",4,"ngIf"],[1,"formulaBarDropdown"],[1,"dropdownContainer",3,"compact","options","isDisabled","value","valueChange"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"formulaBarButtons"],["data-unique-id","formula-bar-cancel",1,"formulaBarCancel",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","dismiss_20_regular"],["data-unique-id","formula-bar-commit",1,"formulaBarCommit",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","checkmark_20_regular"],["data-unique-id","formula-bar-template-button",3,"daxTemplates","selectedTemplate"],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus"],["localize","Tab_Moves_Focus",1,"message",3,"pbiTooltip","click"],[1,"formulaBarAlert"],["symbolId","alert","sheet","filterPaneIcons",1,"imageAlert"],["tri-svg-icon-16","","name","dismiss_circle_16_filled"],["data-unique-id","formula-bar-alert","row","1","cols","1","readonly","","pbiTooltipPosition","below",1,"messageAlert",3,"pbiTooltip","ngModel"],[3,"value"]],template:function(u,c){1&u&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("on-resize",function(){return c.onResize()}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementStart(2,"div",1)(3,"div",2)(4,"div",3,4),e.\u0275\u0275listener("keydown.enter",function(){return c.focus()}),e.\u0275\u0275template(6,at,1,5,"monaco-editor-host",5),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",6),e.\u0275\u0275listener("click",function(){return c.onToggleExpandCollapse()}),e.\u0275\u0275element(9,"tri-svg-icon",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div",8),e.\u0275\u0275template(11,st,2,3,"button",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,fe,4,3,"div",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",11),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementStart(15,"tri-dropdown",12),e.\u0275\u0275listener("valueChange",function(P){return c.setEditMode(P.key)}),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275template(17,lt,4,5,"tri-dropdown-trigger",13),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275template(19,ut,3,4,"tri-dropdown-item",14),e.\u0275\u0275pipe(20,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div",15)(22,"button",16),e.\u0275\u0275listener("click",function(){return c.cancel()}),e.\u0275\u0275pipe(23,"localize"),e.\u0275\u0275element(24,"tri-svg-icon",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"button",18),e.\u0275\u0275listener("click",function(){return c.submit()}),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275element(27,"tri-svg-icon",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"template-button",20),e.\u0275\u0275listener("selectedTemplate",function(P){return c.selectTemplate(P)}),e.\u0275\u0275elementEnd()()()),2&u&&(e.\u0275\u0275classProp("readonly",c.isReadOnly),e.\u0275\u0275property("hidden",c.isHidden||!c.monacoEditorInitialized),e.\u0275\u0275attribute("focus-nav-mode",c.navMode)("aria-label",e.\u0275\u0275pipeBind1(1,26,"Formula_Bar")),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("hasAlert",c.alertText),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,28,c.languageOptions$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",!c.monacoEditorInitialized||!c.isEditorEnabled)("pbiTooltip",c.formulaBarExpanderTooltip),e.\u0275\u0275advance(1),e.\u0275\u0275property("@chevron",c.nextExpandCollapseState),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",c.tabMovesFocus&&!c.isReadOnly&&c.isEditorEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!c.alertText),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("hideFormulaBarDropdown",!e.\u0275\u0275pipeBind1(14,30,c.showEditModeSelector$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("compact",!0)("options",c.triDropdownOptions)("isDisabled",c.isReadOnly)("value",e.\u0275\u0275pipeBind1(16,32,c.selectedEditModeOption$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(18,34,c.selectedEditModeOption$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(20,36,c.editModeOptions$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(23,38,"Cancel_ButtonText"))("disabled",c.shouldAlwaysEnableCancelButton?!c.monacoEditorInitialized:!c.isEditing||!c.monacoEditorInitialized),e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(26,40,"Commit_ButtonText"))("disabled",!c.isEditing||!c.monacoEditorInitialized),e.\u0275\u0275advance(3),e.\u0275\u0275property("daxTemplates",c.daxTemplates))},dependencies:[Ce.NgForOf,Ce.NgIf,re.Fj,re.JJ,re.On,Ye.X,ye.C,Ve.V,qe.R,Be.O,et.q,De.M3,Re.l,Ne.q,De.ii,He.M,it,Ce.AsyncPipe,je.F],styles:['[_nghost-%COMP%]{--read-only-button-foreground: var(--fluent-theme-neutral-secondary-alt-color);--read-only-background: var(--fluent-theme-neutral-tertiary-color);--read-only-border-color: var(--fluent-theme-neutral-tertiary-color);--button-background: transparent;--button-foreground: var(--gray-180);--editor-container-border-color: var(--fluent-theme-neutral-tertia-color);--editor-container-background: var(--fluent-theme-white-color);--expander-foreground-hover: var(--fluent-theme-black-color);--accessibility-message-background: var(--fluent-theme-neutral-primary-color);--accessibility-message-foreground: var(--fluent-theme-white-color);--accessibility-message-background-focus: var(--fluent-theme-neutral-tertiary-alt-color);--alert-foreground: var(--fluent-theme-black-color);--alert-background: var(--fluent-theme-warning-background-color);--alert-border: none;--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--fluent-theme-neutral-tertiary-alt-color);--submit-cancel-buttons-background: var(--fluent-theme-white-color);--cancel-button-foreground: var(--fluent-theme-error-dark-color);--commit-button-foreground: var(--fluent-theme-success-icon-color);--gray-host-background: var(--gray-20);--gray-border-color: var(--gray-60);--gray-read-only-background: var(--gray-20);--gray-read-only-border: var(--gray-40);position:relative;padding:4px;min-height:36px;max-height:36px;width:100%;box-sizing:border-box;display:flex;flex-direction:column}[data-legacy-theming=false]   [_nghost-%COMP%]{--read-only-button-foreground: var(--colorNeutralForegroundDisabled);--read-only-background: var(--colorNeutralBackgroundDisabled);--read-only-border-color: var(--colorNeutralStrokeDisabled);--button-background: transparent;--button-foreground: var(--colorNeutralForeground1);--editor-container-border-color: var(--colorNeutralStroke1);--editor-container-background: var(--colorNeutralBackground1);--expander-foreground-hover: var(--colorNeutralStrokeFocus2);--accessibility-message-background: var(--colorCompoundBrandBackground);--accessibility-message-foreground: var(--colorNeutralForegroundOnBrand);--accessibility-message-background-focus: var(--colorCompoundBrandBackgroundHover);--alert-foreground: var(--colorNeutralForeground1);--alert-background: var(--colorDangerBackground1);--alert-border: 1px solid var(--colorDangerBorder1);--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--colorNeutralStroke1);--submit-cancel-buttons-background: var(--colorNeutralBackground1);--cancel-button-foreground: var(--colorDangerForeground1);--commit-button-foreground: var(--colorSuccessForeground1);--gray-host-background: var(--colorNeutralBackground3);--gray-border-color: var(--colorNeutralStroke2);--gray-read-only-background: var(--colorNeutralBackground3);--gray-read-only-border: var(--colorNeutralStrokeDisabled)}[hidden][_nghost-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]{flex-grow:1;cursor:default;box-sizing:border-box;display:flex}[_nghost-%COMP%]   .formulaBar[hidden][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--read-only-button-foreground)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-color:var(--read-only-border-color);background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursor[_ngcontent-%COMP%]{background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:var(--button-background);color:var(--button-foreground)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:currentcolor}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [disabled][_ngcontent-%COMP%]{opacity:.4}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{order:1;flex-grow:1;height:100%;display:flex;flex-direction:column;margin-left:3px;min-height:28px;box-sizing:border-box;border:1px solid var(--editor-container-border-color);background-color:var(--editor-container-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer.hasAlert[_ngcontent-%COMP%]{min-height:48px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;padding-top:2px;padding-right:21px;display:flex;flex-direction:column;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;background-color:transparent;-webkit-user-select:none}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:16px;height:16px;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus:not(:disabled){color:var(--expander-foreground-hover)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-left:2px;padding:2px;background-color:var(--accessibility-message-background);color:var(--accessibility-message-foreground);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:focus{background-color:var(--accessibility-message-background-focus)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]{width:100%;height:20px;box-sizing:border-box;color:var(--alert-foreground);background-color:var(--alert-background);outline:var(--alert-border);display:flex;padding-left:2px;align-items:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--alert-icon)}[data-legacy-theming=true]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{width:16px;height:16px}[data-legacy-theming=false]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .messageAlert[_ngcontent-%COMP%]{cursor:default;flex-grow:1;height:100%;box-sizing:border-box;border:none;padding-top:2px;padding-left:4px;background-color:var(--alert-background);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:11px;resize:none;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]{margin-right:3px;font-size:14px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown.hideFormulaBarDropdown[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]{min-width:100px;height:28px;box-sizing:border-box}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]     button{min-width:inherit;height:inherit}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]{min-width:76px;flex:0;height:28px;box-sizing:border-box;border:1px solid var(--submit-cancel-buttons-border);display:flex;align-items:center;justify-content:space-evenly;background-color:var(--submit-cancel-buttons-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-content:center;justify-content:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForegroundDisabled)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:disabled){background:var(--colorNeutralBackground1Hover)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--cancel-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--commit-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:none}.gray-theme   [_nghost-%COMP%]{background-color:var(--gray-host-background)}.gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-radius:2px;border-color:var(--gray-border-color)}.gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{background-color:var(--gray-read-only-background);border-color:var(--gray-read-only-border)}@media print{formula-bar[_ngcontent-%COMP%]   .formulaBar[_ngcontent-%COMP%]{display:none}}'],data:{animation:[(0,z.X$)("chevron",[(0,z.SB)("".concat(0),(0,z.oB)({transform:"rotate(180deg)"})),(0,z.SB)("".concat(2),(0,z.oB)({transform:"rotate(0deg)"})),(0,z.SB)("".concat(1),(0,z.oB)({transform:"rotate(0deg)"})),(0,z.eR)("".concat(1," => ").concat(2,", ").concat(2," => ").concat(1),[(0,z.jt)(150,(0,z.F4)([(0,z.oB)({transform:"rotate(0deg)",offset:0}),(0,z.oB)({transform:"rotate(45deg)",offset:.5}),(0,z.oB)({transform:"rotate(0deg)",offset:1})]))]),(0,z.eR)("* => ".concat(0),[(0,z.jt)(150,(0,z.F4)([(0,z.oB)({transform:"rotate(0deg)",offset:0}),(0,z.oB)({transform:"rotate(180deg)",offset:1})]))]),(0,z.eR)("".concat(0," => *"),[(0,z.jt)(150,(0,z.F4)([(0,z.oB)({transform:"rotate(180deg)",offset:0}),(0,z.oB)({transform:"rotate(0deg)",offset:1})]))])])]}}),a}();function Te(a){return _.some(pt,function(i){var u=$(a),c=$(i);return c.is(u)||!!c.find(u).length})}},17848:function(me,W,t){t.d(W,{p:function(){return q}});var h=t(77476),L=t(17174),O=t(67659),I=t(79061),V=t(20214),w=t(68101),H=t(93367),x=t(94841),T=t(79725),E=t(16095),U=t(53772),G=t(44913),Y=t(17177),J=t(50423),q=function(){function ee(){}return ee.\u0275fac=function(he){return new(he||ee)},ee.\u0275mod=J.\u0275\u0275defineNgModule({type:ee}),ee.\u0275inj=J.\u0275\u0275defineInjector({imports:[h.CommonModule,L.u5,H.U,I.v,w.B,x.b,E.Z,T.j,U.w,V.y,O._,G.lK,Y.T6]}),ee}()},15903:function(me,W,t){t.d(W,{$d:function(){return I},Pm:function(){return L},n9:function(){return O}});var h=t(50423),L=new h.InjectionToken("IntellisenseModelService"),O=new h.InjectionToken("FormulaBarBehaviorService"),I=new h.InjectionToken("FormulaBarZoomService")},98361:function(me,W,t){t.d(W,{e:function(){return O}});var h=t(81337),L=t(50423),O=function(){function I(V,w,H){this.uiBlockingService=V,this.localizationService=w,this.intellisenseService=H}return I.prototype.registerFormulaBarControl=function(V){this.formulaBarControl=V,V.setEditModeOptions([])},I.prototype.focusWhenNotBlocked=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(V){switch(V.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return V.sent(),this.formulaBarControl.focus(),[2]}})})},I.prototype.updateReadOnlyState=function(V){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(w){switch(w.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return w.sent(),this.formulaBarControl.setReadOnly(V),[2]}})})},I.prototype.updateContents=function(V,w){return(0,h.__awaiter)(this,void 0,void 0,function(){var H;return(0,h.__generator)(this,function(x){switch(x.label){case 0:return[4,this.intellisenseService.getDataSourceInfo()];case 1:return H=x.sent(),(_.isEmpty(H.functionDataFromEngine)||_.isEmpty(H.reservedWords))&&!w&&(w=this.localizationService.get("DaxEditor_ErrorMessageToGetIntellisense")),[4,this.updateFormulaText(V,H)];case 2:return x.sent(),this.updateAlertText(w),[2]}})})},I.prototype.updateFormulaText=function(V,w){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(H){switch(H.label){case 0:return[4,this.intellisenseService.updateDaxContext(w)];case 1:return H.sent(),this.formulaBarControl.setCommittedFormulaBarText(V||null),this.contentChanged=!1,[2]}})})},I.prototype.updateAlertText=function(V){V?this.formulaBarControl.showAlertMessage(V):this.formulaBarControl.hideAlert()},I.\u0275fac=function(w){L.\u0275\u0275invalidFactory()},I.\u0275prov=L.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac}),I}()},15783:function(me,W,t){t.d(W,{B:function(){return x}});var h=t(81337),L=t(15903),O=t(50423),I=t(72080),V=t(83309),x=function(){function T(E,U,G,Y){this.intellisenseService=E,this.screenReaderService=U,this.zone=G,this.behaviorService=Y,this.suspendParseCount=0}return T.prototype.setUICulture=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(E){switch(E.label){case 0:return[4,this.intellisenseService.setUICulture()];case 1:return E.sent(),[2]}})})},T.prototype.ngOnDestroy=function(){this.behaviorService.ngOnDestroy()},Object.defineProperty(T.prototype,"mode",{get:function(){return"dax"},enumerable:!1,configurable:!0}),T.prototype.registerFormulaBarControl=function(E){this.formulaBarControl=E,this.behaviorService.registerFormulaBarControl(E),this.intellisenseService.onClientViewLoaded(this)},T.prototype.onContentChanged=function(E,U,G,Y){var J=this,q=this.intellisenseService.analyzeFinalFormulaCommitInfo(E,!1,!1);this.behaviorService.contentChanged||(this.behaviorService.contentChanged=q.doCommit),q.parseErrorMessages.size&&q.parseErrorMessages.forEach(function(ee,pe){J.screenReaderService.alertWithDebounce("dax-error"+pe,ee)}),this.intellisenseService.onContentChanged(E,U,G,0!==this.suspendParseCount,Y.length>1),this.behaviorService.onContentChanged(q)},T.prototype.onEditorFocus=function(){this.intellisenseService.onEditorFocus()},T.prototype.hasUnsavedChanges=function(E){return this.behaviorService.hasUnsavedChanges(E)},T.prototype.onBlur=function(E){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(U){switch(U.label){case 0:return[4,this.behaviorService.commitOrDeletePendingCalculation(E)];case 1:return[2,U.sent()]}})})},T.prototype.onSubmit=function(E){return(0,h.__awaiter)(this,void 0,void 0,function(){var U;return(0,h.__generator)(this,function(G){switch(G.label){case 0:return U=this.intellisenseService.analyzeFinalFormulaCommitInfo(E,!0,!0),[4,this.behaviorService.commitCalculationUpdate(U)];case 1:return G.sent(),[2]}})})},T.prototype.onCancel=function(E){return(0,h.__awaiter)(this,void 0,void 0,function(){return(0,h.__generator)(this,function(U){return this.behaviorService.cancel(E),[2]})})},T.prototype.onTemplateSelection=function(E){return this.behaviorService.onTemplateSelection(E)},T.prototype.setCommittedFormulaBarText=function(E){this.formulaBarControl.setCommittedFormulaBarText(E)},T.prototype.hostServiceCalculationCommitedOrDeleted=function(){this.formulaBarControl.endFormulaEdit(),this.behaviorService.contentChanged=!1},T.\u0275fac=function(U){return new(U||T)(O.\u0275\u0275inject(I.e),O.\u0275\u0275inject(V.g),O.\u0275\u0275inject(O.NgZone),O.\u0275\u0275inject(L.n9))},T.\u0275prov=O.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac}),(0,h.__decorate)([function(T,E,U){var G=U.value;U.value=function(){for(var Y=[],J=0;J<arguments.length;J++)Y[J]=arguments[J];var q=this;this.zone.run(function(){return G.apply(q,Y)})}},(0,h.__metadata)("design:type",Function),(0,h.__metadata)("design:paramtypes",[]),(0,h.__metadata)("design:returntype",void 0)],T.prototype,"hostServiceCalculationCommitedOrDeleted",null),T}()},34103:function(me,W,t){t.d(W,{Dz:function(){return V},TH:function(){return I}});var h=t(50423),L=new h.InjectionToken("IntellisenseProxyServiceOverrideToken"),I=function(){function w(){}return w.prototype.onClientViewLoaded=function(H){},w.prototype.onContentChanged=function(H,x,T,E,U){},w.prototype.onEditorFocus=function(){},w.prototype.endIntellisenseSession=function(){},w.prototype.startIntellisenseSession=function(H,x,T,E){},w.prototype.getCultureInfo=function(){return Promise.resolve(JSON.stringify({decimalSeparator:".",listSeparator:","}))},w}(),V={provide:I,useFactory:function(w){var H=w.get(L,null);return H?h.Injector.create([H],w).get(I):new I},deps:[h.Injector]}},72080:function(me,W,t){t.d(W,{e:function(){return ee}});var h=t(81337),L=t(15903),O=t(17819),I=t(63513),V=t(48563),w=t(74249),H=t(26112),x=t(62458),T=t(59694),E=t(63708),U=t(49088),G=t(50423),Y=t(65181),J=t(34103),q=[" ","\t"],ee=function(){function N(f,B,D,A){this.localizationService=f,this.intellisenseHostService=B,this.intellisenseModelService=D,this.daxCapabilitiesService=A}return N.prototype.onClientViewLoaded=function(f){this.intellisenseHostService.onClientViewLoaded(f)},N.prototype.onContentChanged=function(f,B,D,A,R){this.intellisenseHostService.onContentChanged(f,B,D,A,R)},N.prototype.setUICulture=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var f,B;return(0,h.__generator)(this,function(D){switch(D.label){case 0:return[4,this.intellisenseHostService.getCultureInfo()];case 1:return f=D.sent(),B=(0,H.K)(f),(0,O.g5)({listSeparator:B.listSeparator,numberDecimalSeparator:B.decimalSeparator}),[2]}})})},N.prototype.onEditorFocus=function(){this.intellisenseHostService.onEditorFocus()},N.prototype.endIntellisenseSession=function(){this.intellisenseModelService.reset(),this.intellisenseHostService.endIntellisenseSession()},N.prototype.startIntellisenseSession=function(f,B,D,A){this.intellisenseModelService.init({entityName:f,propertyName:B,schemaName:D,calculationEditMode:A}),this.intellisenseHostService.startIntellisenseSession(f,B,D,A)},N.prototype.getCalculationInfo=function(f){return(0,h.__awaiter)(this,void 0,void 0,function(){var B;return(0,h.__generator)(this,function(D){return(B=this.intellisenseModelService.findCalculationObject(f))&&null!=B.expression?[2,Promise.resolve({isNew:B.isNew,alertMessage:B.expressionErrorMessage?B.expressionErrorMessage:void 0,formulaText:this.getCalculationExpression(B)})]:(x.fF.assertFail((0,T.W)("Cannot find editable Calculation: schema:{0} entity:{1} property:{2}",f?.schemaName,f?.entityName,f?.propertyName)),[2,Promise.resolve(void 0)])})})},N.prototype.getCalculationExpression=function(f){if(f.formulaOverride)return f.formulaOverride.formula;var B=O.w_.convertToUI(f.expression);return f.calculationSyntaxType===E.Up.Expression?B:(0,O.Mk)(f.name,B)},N.prototype.updateFormulaContextAsync=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var f;return(0,h.__generator)(this,function(B){switch(B.label){case 0:return[4,this.getDataSourceInfo()];case 1:return f=B.sent(),[4,this.updateDaxContext(f)];case 2:return B.sent(),[2]}})})},N.prototype.updateDaxContext=function(f){return(0,h.__awaiter)(this,void 0,void 0,function(){var X;return(0,h.__generator)(this,function(z){switch(z.label){case 0:return[4,this.intellisenseModelService.getDaxModeConfigInputs(f)];case 1:return X=z.sent(),U._.configureModel(X.serializableModel,X.wireDataSourceInfo,X.daxCalculation,X.isRestrictedMode,X.axes),[2]}})})},N.prototype.getDataSourceInfo=function(){return(0,h.__awaiter)(this,void 0,void 0,function(){var f,D,R;return(0,h.__generator)(this,function(Z){switch(Z.label){case 0:return[4,Promise.all([this.daxCapabilitiesService.getReservedWords(),this.daxCapabilitiesService.getCapabilities()])];case 1:return R=Z.sent(),f=R[0],D=(0,V.w)(R[1].Functions),[2,{reservedWords:f,functionDataFromEngine:D}]}})})},N.prototype.analyzeFinalFormulaCommitInfo=function(f,B,D){var A=this.intellisenseModelService.getCalculationObject(),R={name:void 0,expression:void 0,invalidFormula:void 0,anonymizedExpression:void 0,parseResult:void 0},Z=function(N,f,B,D){if(!D)return f.name=void 0,f.expression=void 0,f.invalidFormula=void 0,f.anonymizedExpression=void 0,!1;!function(N,f,B,D){var A=!1,R={name:void 0,expression:void 0};if((A=D.calculationSyntaxType===E.Up.Expression)?R.expression=I.uI.trimStart(N,q):A=(0,O.Mn)(N,R,D.calculationType===E.eN.VisualCalculation),!A)return f.name=D.name||"",f.name&&!N?f.expression="":(f.invalidFormula=N,f.expression=D.expression||""),null;if(f.name=R.name,f.expression=R.expression,R.expression)if(B){(Z=U._.getContext())||x.fF.assertFail("Context should be defined");var X=new O.w_,z=new O.ss,e={finalResult:z};X.finalParse(R.expression,Z,e,O.MX.AddMissingParens|O.MX.Anonymize|O.MX.ConvertToEngine),f.expression=e.finalResult.updatedExpression,f.anonymizedExpression=e.finalResult.anonymizedExpression,f.parseResult=z}else{X=new O.w_;var Z=U._.getContext(),Q={result:new O.bp};X.parse(R.expression,0,void 0,void 0,Z,Q,void 0),f.expression=O.w_.convertToEngine(R.expression),f.parseResult=Q.result}}(N,f,B,D);var A,R=D.formulaOverride;return R&&(A=R.formula),D.name!==f.name||D.expression!==f.expression||A!==f.invalidFormula}(f,R,D,A);!Z&&B&&A&&(Z=!!A.expressionErrorMessage&&!!A.expressionOverride&&!A.formulaOverride);var e,le,Q=new Map;if(Z&&R.invalidFormula)switch(e={expression:null,formula:R.invalidFormula},A.calculationType){case E.eN.Column:le=this.localizationService.get("ReportModelInvalidColumnNameMessage");break;case E.eN.Table:le=this.localizationService.get("ReportModelInvalidCalculatedTableNameMessage");break;case E.eN.Measure:le=this.localizationService.get("ReportModelInvalidMeasureNameMessage");break;case E.eN.CalculationItem:le=this.localizationService.get("ReportModelInvalidCalcItemNameMessage");break;case E.eN.VisualCalculation:break;default:x.fF.assertFail("Unknown type "+A.calculationType)}return R.parseResult instanceof O.bp&&R.parseResult.errors.length&&R.parseResult.errors.forEach(function(oe){return Q.set(oe.errorCode,oe.message)}),{doCommit:Z,newName:R.name,newExpression:R.expression,newInvalidFormula:R.invalidFormula,anonymizedExpression:R.anonymizedExpression,expressionOverride:e,errorMessage:le,parseErrorMessages:Q}},N.\u0275fac=function(B){return new(B||N)(G.\u0275\u0275inject(Y.o),G.\u0275\u0275inject(J.TH),G.\u0275\u0275inject(L.Pm),G.\u0275\u0275inject(w.r))},N.\u0275prov=G.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac,providedIn:"root"}),N}()},4715:function(me,W,t){t.d(W,{H2:function(){return O},Zs:function(){return H},gV:function(){return V}});var h=t(41114),L="PBI.FormulaBar.EditFormulaBarObject",O=h.cx[L]=(0,h.b1)(L),I="PBI.FormulaBar.SubmitDynamicFormatString",V=h.cx[I]=(0,h.b1)(I),w="PBI.FormulaBar.SelectTemplate",H=h.cx[w]=(0,h.b1)(w)},81892:function(me,W,t){t.d(W,{Uu:function(){return O},ZI:function(){return h},dO:function(){return L}});var h=[{displayName:"Measure",key:1},{displayName:"Format",key:2}],L=[{displayName:"Item",key:1},{displayName:"Format",key:2}],O="formulaBarDropdownPanel"}}]);