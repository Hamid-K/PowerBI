"use strict";(self.webpackChunkdesktopModelView=self.webpackChunkdesktopModelView||[]).push([["pbicopilot-desktop"],{67254:function(_,g,a){a.r(g),a.d(g,{PBICopilotDesktopModule:function(){return q}});var G=a(77476),V=a(82762),v=a(50423),S=a(80795),$=function(){function t(){this.aiScenarioDesktopService=(0,v.inject)(S.$)}return t.prototype.runScenario=function(o,r){if(r)throw Error("Streaming not yet supported");var n=this.aiScenarioDesktopService.complete(o);return(0,V.D)(n)},t.\u0275prov=v.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac=function(r){return new(r||t)}}),t}(),i=a(81337),z=a(64791),H=a(58707),Z=a(94853),e=a(41114),f="PBI.Copilot.CompletionEvent",J=e.cx[f]=(0,e.b1)(f),h="PBI.Copilot.EmbeddingEvent",K=e.cx[h]=(0,e.b1)(h),b="PBI.Copilot.StreamCompletionEvent",y="PBI.Copilot.ChatCompletionEvent",Q=e.cx[y]=(0,e.b1)(y),k=(e.cx[b]=(0,e.b1)(b),"PBI.Copilot.GetSerializedSchema"),D=(e.cx[k]=(0,e.b1)(k),"PBI.Copilot.UndoSkill"),P=(e.cx[D]=(0,e.b1)(D),"PBI.Copilot.RetrySkill"),x=(e.cx[P]=(0,e.b1)(P),"PBI.Copilot.ZeroPromptAction"),I=(e.cx[x]=(0,e.b1)(x),"PBI.Copilot.PromptGuideAction"),B=(e.cx[I]=(0,e.b1)(I),"PBI.Copilot.SkillSetExecution"),N=(e.cx[B]=(0,e.b1)(B),"PBI.Copilot.UserTurn"),R=(e.cx[N]=(0,e.b1)(N),"PBI.Copilot.CopilotTurn"),w=(e.cx[R]=(0,e.b1)(R),"PBI.Copilot.CopilotTurnSkillExecution"),T=(e.cx[w]=(0,e.b1)(w),"PBI.Copilot.AggregationError"),M=(e.cx[T]=(0,e.b1)(T),"PBI.Copilot.NonRetriableError"),L=(e.cx[M]=(0,e.b1)(M),"PBI.Copilot.RetriableError"),A=(e.cx[L]=(0,e.b1)(L),"PBI.Copilot.FeedbackDialog"),F=(e.cx[A]=(0,e.b1)(A),"PBI.Copilot.FeedbackDialogError"),U=(e.cx[F]=(0,e.b1)(F),"PBI.Copilot.FeedbackDialogView"),W=(e.cx[U]=(0,e.b1)(U),function(){function t(){this.telemetryService=(0,v.inject)(H.y0),this.aiScenarioDesktopService=(0,v.inject)(S.$)}return t.prototype.complete=function(o,r,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var l,s,p,c;return(0,i.__generator)(this,function(m){switch(m.label){case 0:return l=(0,i.__assign)({scenarioDefinition:{aiClientCompletion:o}},r),s=this.buildCopilotUsageRequest(l,r),p=this.telemetryService.startEvent(J,(0,i.__assign)({promptLength:o.prompt.length},n?.telemetryOptions||{})),[4,this.aiScenarioDesktopService.complete(s)];case 1:if((c=m.sent()).error)throw this.logError(p,c.error),c;return p.resolve(),[2,c]}})})},t.prototype.embedding=function(o,r,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var l,u,p;return(0,i.__generator)(this,function(c){switch(c.label){case 0:return l=this.buildCopilotUsageRequest(o,r),u=this.telemetryService.startEvent(K,(0,i.__assign)({inputLength:l.input.length},n?.telemetryOptions||{})),[4,this.aiScenarioDesktopService.embedding(l)];case 1:if((p=c.sent()).error)throw this.logError(u,p.error),p;return u.resolve(),[2,p]}})})},t.prototype.complete$=function(o){throw new Error("complete$ not yet implemented")},t.prototype.chatCompletion=function(o,r,n){var l;return(0,i.__awaiter)(this,void 0,void 0,function(){var s,C,u,p,c,m,E,d;return(0,i.__generator)(this,function(j){switch(j.label){case 0:return s=this.buildCopilotUsageRequest(o,r),C=n?.telemetryOptions||{},u=o.model,p=z.eH[null===(l=o.client_scenario)||void 0===l?void 0:l.scenario_type],c=s.messages.length,m=s.messages.map(function(O){return O.content?O.content.length:0}),E=this.telemetryService.startEvent(Q,(0,i.__assign)({numberOfMessages:c,messageLengths:m,scenarioType:p,model:u},C)),[4,this.aiScenarioDesktopService.chatCompletion(s)];case 1:if((d=j.sent()).error)throw this.logError(E,d.error),d;return E.resolve(),[2,d]}})})},t.prototype.buildCopilotUsageRequest=function(o,r){return(0,i.__assign)((0,i.__assign)({},o),{copilotUsageMetadata:r})},t.prototype.logError=function(o,r){var n;r&&(n=(0,Z.GB)(r)),o.reject(n)},t.\u0275prov=v.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac=function(r){return new(r||t)}}),t}()),X=a(66971),Y=function(){function t(o){this.titlebarService=o}return t.prototype.getReportTitle=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(o){return[2,this.titlebarService.getTitleAsync()]})})},t.prototype.getAvailableTokens=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(o){throw new Error("getAvailableTokens not available in Desktop")})})},t.\u0275fac=function(r){return new(r||t)(v.\u0275\u0275inject(X.M))},t.\u0275prov=v.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),q=function(){function t(){}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=v.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=v.\u0275\u0275defineInjector({providers:[{provide:"copilotScenarioProxyService",useClass:$},{provide:"copilotLLMProxyService",useClass:W},{provide:"reportContentCopilotProxyService",useClass:Y}],imports:[G.CommonModule]}),t}()}}]);