"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["qnaui.internal"],{70940:function(qe,ye,l){l.d(ye,{s:function(){return q}});var f=l(47508),b=l(45034),X=new b.o(function(){var C={};return C[3]=f.L.card,C[13]=f.L.lineClusteredColumnComboChart,C[29]=f.L.multiRowCard,C[7]=f.L.clusteredBarChart,C[10]=f.L.clusteredColumnChart,C[20]=f.L.donutChart,C[16]=f.L.funnel,C[30]=f.L.gauge,C[22]=f.L.heatMap,C[9]=f.L.hundredPercentStackedBarChart,C[12]=f.L.hundredPercentStackedColumnChart,C[4]=f.L.lineChart,C[1]=f.L.map,C[19]=f.L.filledMap,C[2]=f.L.pivotTable,C[5]=f.L.pieChart,C[6]=f.L.scatterChart,C[8]=f.L.barChart,C[11]=f.L.columnChart,C[0]=f.L.tableEx,C[17]=f.L.treemap,C[23]=f.L.waterfallChart,C[26]=f.L.stackedAreaChart,C[27]=f.L.hundredPercentStackedAreaChart,C[32]=f.L.areaChart,C[33]=f.L.ribbonChart,C[34]=f.L.kpi,C[35]=f.L.decompositionTreeVisual,C});function q(C){return X.getValue()[C]}new b.o(function(){var C={};return C[f.L.card.name]=3,C[f.L.lineClusteredColumnComboChart.name]=13,C[f.L.multiRowCard.name]=29,C[f.L.clusteredBarChart.name]=7,C[f.L.clusteredColumnChart.name]=10,C[f.L.donutChart.name]=20,C[f.L.funnel.name]=16,C[f.L.gauge.name]=30,C[f.L.heatMap.name]=22,C[f.L.hundredPercentStackedBarChart.name]=9,C[f.L.hundredPercentStackedColumnChart.name]=12,C[f.L.lineChart.name]=4,C[f.L.map.name]=1,C[f.L.filledMap.name]=19,C[f.L.matrix.name]=2,C[f.L.pivotTable.name]=2,C[f.L.pieChart.name]=5,C[f.L.scatterChart.name]=6,C[f.L.barChart.name]=8,C[f.L.columnChart.name]=11,C[f.L.table.name]=0,C[f.L.tableEx.name]=0,C[f.L.treemap.name]=17,C[f.L.waterfallChart.name]=23,C[f.L.stackedAreaChart.name]=26,C[f.L.hundredPercentStackedAreaChart.name]=27,C[f.L.areaChart.name]=32,C[f.L.ribbonChart.name]=33,C[f.L.kpi.name]=34,C[f.L.decompositionTreeVisual.name]=35,C})},73708:function(qe,ye,l){l.r(ye),l.d(ye,{QnaUIInternalModule:function(){return sa}});var f=l(77476),b=l(52910),X=l(42729),k=l(558),q=l(32208),Q=l(76521),C=l(82156),ce=l(79061),W=l(67659),K=l(35911),z=l(16095),Z=l(22760),te=l(1931),U=l(98665),ae=l(47768),ue=l(56545),ve=l(3176),P=l(81337),j=l(14172),J=l(83317),he=l(30794),T=l(73446),S=l(62458),e=l(50423),oe=l(43286),Y=l(37320),A=l(16808),M=l(72129),E=l(7124),B=l(48787),F=l(17653),ne=l(57243),ee=l(77526),se=l(83495),fe=l(18353),pe=l(59973),xe=l(81905),ke=l(46358),We=l(23558),de=l(35510),Fe=l(59787),Oe=l(11547),Re=l(59017),Ue=l(40133),Ve=l(82762),Le=l(63057),dt=l(35988),pt=l(1521),yt=l(87632),St=l(59107),tt=l(32105),zt=l(65947),wt=l(12123),Yt=l(87974),Ae=l(38078);function Wt(i){i.remove?i.remove():i.parentNode&&i.parentNode.removeChild?i.parentNode.removeChild(i):S.fF.assertFail("No remove element API found")}function Ot(i){return i.isComposing||229===i.keyCode}function tn(i){if(S.fF.assertValue(i,"response"),!_.isEmpty(i.utterance)){for(var n=i.utterance,t=[],o=0,r=_.first(i.results),s=0,u=r&&r.spans||[];s<u.length;s++){var h=u[s];if(o<h.startIndex){var d=m(n,o,h.startIndex);t.push.apply(t,d||[])}t.push(h),o=h.endExcludingIndex}if(o<n.length){var g=m(n,o,n.length);t.push.apply(t,g||[])}return t}}function $e(i){return i&&i.replace(/\s/g," ")}function c(i,n){if(i){if(i.nodeType===Node.TEXT_NODE)return i;for(var t=i.childNodes,o=_.size(t),a=0,s=n?_.range(0,o):_.range(o-1,-1,-1);a<s.length;a++){var d=c(t[s[a]],n);if(d)return d}}}function m(i,n,t){for(var o=[],r=n;r<t;){var a=r,s=void 0,u=void 0;if(/\s/.test(i.charAt(r)))u=!0,s=a+1,r++;else{u=!1;var h=i.indexOf(" ",r);s=h=h>-1?Math.min(h,t):t,r=h}var d=i.substring(a,s);o.push({startIndex:a,endExcludingIndex:s,text:d,isWhiteSpace:u,isOverlapping:!1,isCorrected:!1,isUnknown:!1,isUsed:!1,state:"none"})}return o}function y(i,n){if(S.fF.assertValue(i,"The given node must be defined"),S.fF.assertValue(n>=0,"The given nodeTextContentOffset must be >= 0"),S.fF.assert(function(){return i.nodeType!==Node.COMMENT_NODE},"Expect the given node is NOT a comment node"),0===n)return{node:c(i,!0)||i,textOrChildNodesOffset:0};if(n>i.textContent.length)return{node:void 0,textOrChildNodesOffset:-1};if(_.isEmpty(i.childNodes))return S.fF.assert(function(){return i.nodeType===Node.TEXT_NODE},"0 < nodeTextContentOffset <= node.textContent.length, and node has no childNodes, then node should be a TEXT_NODE"),{node:i,textOrChildNodesOffset:n};for(var r=n,a=0;a<i.childNodes.length;a++){var s=i.childNodes.item(a);if(s.nodeType!==Node.COMMENT_NODE){var u=s.textContent.length;if(r>u){r-=u;continue}if(s.nodeType===Node.TEXT_NODE)return{node:s,textOrChildNodesOffset:r};if(r===u){var h=c(s,!1);return h?{node:h,textOrChildNodesOffset:h.textContent.length}:{node:i,textOrChildNodesOffset:a+1}}return y(s,r)}}S.fF.assertFail("nodeTextContentOffset <= node.textContent.length, there should be a descendant (or same) Node that the given position lands on")}function O(i,n){return!(!i||!n)&&(i===n||(n.nodeType===Node.ELEMENT_NODE?i.contains(n):O(i,n.parentNode)))}var Se=l(41114),Pe="PBI.QnaVisual.Initialized",Qe=Se.cx[Pe]=(0,Se.b1)(Pe,{logExpAssignment:!0}),ft="PBI.QnaAutoComplete.Initialized",nt=Se.cx[ft]=(0,Se.b1)(ft),rt="PBI.QnaAutoComplete.DropdownSelected",gt=Se.cx[rt]=(0,Se.b1)(rt),mt="PBI.ImproveLsdlBackground.Login",nn=Se.cx[mt]=(0,Se.b1)(mt),on="PBI.ImproveLsdlBackground.Prompt",rn=Se.cx[on]=(0,Se.b1)(on),Xe="PBI.ImproveLsdlBackground.Result",ht=Se.cx[Xe]=(0,Se.b1)(Xe),Pt=l(76598),un=l(63377),Gt=l(64647),st=l(83309),It=l(65181),ot=l(59968),it=l(44581),Mt=function(n,t,o,r,a){return{"font-size":n,"font-family":t,"font-weight":o,"font-style":r,"text-decoration":a}};function xt(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"h4",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(2,Mt,o.presentation.value.questionFontProperties.size.px+"px",o.presentation.value.questionFontProperties.family,o.presentation.value.questionFontProperties.bold,o.presentation.value.questionFontProperties.italic,o.presentation.value.questionFontProperties.underline)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.title)}}var Tt=function(n){return{matchedSegment:n}};function Dt(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(3,Tt,!t.isMatched)),e.\u0275\u0275attribute("aria-hidden",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.text)}}function cn(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,Dt,2,5,"span",14),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.textSegments)}}function dn(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",16),e.\u0275\u0275element(1,"span",17),e.\u0275\u0275elementEnd())}var pn=function(n,t,o,r,a,s){return{backgroundColor:n,"font-size":t,"font-family":o,"font-weight":r,"font-style":a,"text-decoration":s}},gn=function(n,t,o,r){return{selected:n,themableBackgroundColorSelected:t,showMoreItem:o,showAsGroupTitle:r}};function xn(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",10),e.\u0275\u0275listener("mouseenter",function(){var d=e.\u0275\u0275restoreView(t).index,g=e.\u0275\u0275nextContext(2).index,v=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(v.updateHoverItemIndex(g,d))})("accessible-click",function(){var d=e.\u0275\u0275restoreView(t).$implicit,g=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(g.selectDropdownItem(d))}),e.\u0275\u0275template(1,cn,2,1,"div",11),e.\u0275\u0275template(2,dn,2,0,"div",12),e.\u0275\u0275elementEnd()}if(2&i){var o=n.$implicit,r=n.index,a=e.\u0275\u0275nextContext(2).index,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction6(5,pn,s.presentation.value.useShellTheme?"":r===s.selectedSpanIndex&&a===s.selectedGroupIndex||r===s.hoverSpanIndex&&a===s.hoverGroupIndex?s.presentation.value.hoverColor:s.presentation.value.backgroundColor,s.presentation.value.questionFontProperties.size.px+"px",s.presentation.value.questionFontProperties.family,s.presentation.value.questionFontProperties.bold,s.presentation.value.questionFontProperties.italic,s.presentation.value.questionFontProperties.underline))("ngClass",e.\u0275\u0275pureFunction4(12,gn,r===s.selectedSpanIndex&&a===s.selectedGroupIndex||r===s.hoverSpanIndex&&a===s.hoverGroupIndex,r===s.selectedSpanIndex&&a===s.selectedGroupIndex||r===s.hoverSpanIndex&&a===s.hoverGroupIndex,o.isShowMore,o.isShowMore&&s.hasGroupTitle)),e.\u0275\u0275attribute("aria-selected",r===s.selectedSpanIndex&&a===s.selectedGroupIndex?"true":"false"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!o.isShowMore),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isShowMore)}}function hn(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"ul",8),e.\u0275\u0275template(1,xn,3,17,"li",9),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.groupItems)}}function Bt(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"li",4),e.\u0275\u0275template(1,xt,2,8,"h4",5),e.\u0275\u0275template(2,hn,2,1,"ul",6),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(3,Mt,o.presentation.value.questionFontProperties.size.px+"px",o.presentation.value.questionFontProperties.family,o.presentation.value.questionFontProperties.bold,o.presentation.value.questionFontProperties.italic,o.presentation.value.questionFontProperties.underline)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.title&&(null==t.groupItems?null:t.groupItems.length)>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.groupItems)}}var Ft=function(n,t){return{link:n,fixRequestedText:t}},At=function(n){return{"border-top-color":n}};function me(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",20),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.performActionsInUnknownSpanHeader())}),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(3,Ft,!o.disableUnknownSpanHeaderSubtitleAction,o.isUnknownSpanHeaderForFixRequested))("innerHTML",o.unknownSpanHeaderSubtitle,e.\u0275\u0275sanitizeHtml)("ngStyle",e.\u0275\u0275pureFunction1(6,At,o.presentation.value.useShellTheme?"":o.presentation.value.questionFontProperties.color))}}function En(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"h4",18)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,me,1,8,"span",19),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(3,Mt,t.presentation.value.questionFontProperties.size.px+"px",t.presentation.value.questionFontProperties.family,t.presentation.value.questionFontProperties.bold,t.presentation.value.questionFontProperties.italic,t.presentation.value.questionFontProperties.underline)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.unknownSpanHeaderTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.unknownSpanHeaderSubtitle)}}var bn=function(n,t){return{backgroundColor:n,color:t}};function fn(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"ul",1),e.\u0275\u0275template(1,Bt,3,9,"li",2),e.\u0275\u0275template(2,En,4,9,"h4",3),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction2(3,bn,t.presentation.value.useShellTheme?"":t.presentation.value.backgroundColor,t.presentation.value.useShellTheme?"":t.presentation.value.questionFontProperties.color)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.autoCompleteViewModel.dropdownGroups),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showUnknownSpanHeader)}}var ie=/\u00a0/g,p="qna_autocomplete_open",I="qna_autocomplete_item",V=function(){function i(n,t,o,r,a){this.highContrastCssGenerationService=n,this.localizationService=t,this.screenReaderService=o,this.telemetryService=r,this.unknownTermService=a,this.utteranceSelected=new e.EventEmitter,this.fullyExpanded=new e.EventEmitter,this.destroy$=new he.xQ,this.resetSelectedIndices(),this.resetHoverIndices(),this.initializeHighContrastRules()}return i.prototype.ngOnInit=function(){var n=this;this.maxItemCountInFullExpansion=this.maxItemCountInFullExpansion>0?this.maxItemCountInFullExpansion:10,this.maxItemCountInPartialExpansion=this.maxItemCountInPartialExpansion>0?this.maxItemCountInPartialExpansion:4,S.fF.assert(function(){return n.maxItemCountInFullExpansion>=n.maxItemCountInPartialExpansion},"maxItemCountInFullExpansion is less than maxItemCountInPartialExpansion. It does not make sense so we are setting maxItemCountInFullExpansion to be maxItemCountInPartialExpansion now."),this.maxItemCountInFullExpansion=Math.max(this.maxItemCountInFullExpansion,this.maxItemCountInPartialExpansion),this.params.pipe((0,J.R)(this.destroy$)).subscribe(function(t){return n.generateDropdownItems(t)}),this.selectPrevious.pipe((0,J.R)(this.destroy$)).subscribe(function(){return n.moveSelectionUp()}),this.selectNext.pipe((0,J.R)(this.destroy$)).subscribe(function(){return n.moveSelectionDown()}),this.confirmSelection.pipe((0,J.R)(this.destroy$)).subscribe(function(){return n.selectCurrentDropdownItem()}),this.initializedTelemetryEvent=this.telemetryService.logEvent(nt),this.isInitialized=!0},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.screenReaderService.cancelDebounce(I)},i.prototype.updateHoverItemIndex=function(n,t){this.resetSelectedIndices(),this.hoverGroupIndex=n,this.hoverSpanIndex=t,this.screenReaderCurrentDropdownSelection(n,t)},i.prototype.selectDropdownItem=function(n){if(this.isInitialized){if(n.isShowMore)return void this.expandAllItems();n&&n.textSegments&&(this.utteranceSelected.emit({utterance:n.text,tags:["Dropdown","Committed"]}),this.telemetryService.logChildEvent(this.initializedTelemetryEvent,gt,{spanState:this.selectedSpan.state}))}},i.prototype.performActionsInUnknownSpanHeader=function(){var n,t;return(0,P.__awaiter)(this,void 0,void 0,function(){var o,r;return(0,P.__generator)(this,function(a){switch(a.label){case 0:return this.disableUnknownSpanHeaderSubtitleAction?[2]:(o=_.map(this.params.value.spans,function(s){return s.text}).join(""),[4,this.unknownTermService.handleUnknownTerm(o,this.selectedSpan.text,this.params.value.dataSourceArray,this.params.value.exploration,null===(t=null===(n=this.params.value.config.header)||void 0===n?void 0:n.unknownSpanHeaderConfig)||void 0===t?void 0:t.actionType)]);case 1:return 0===(r=a.sent())?(this.unknownSpanHeaderSubtitle=this.localizationService.get("Qna_AutoComplete_FixRequestedLabelText"),this.disableUnknownSpanHeaderSubtitleAction=!0,this.isUnknownSpanHeaderForFixRequested=!0,this.utteranceSelected.emit({utterance:o,tags:["Dropdown","AskToAdd","Committed"],showDropdown:!0,action:r})):this.utteranceSelected.emit({utterance:void 0,action:r}),[2]}})})},Object.defineProperty(i.prototype,"hasGroupTitle",{get:function(){var t;return _.some(null===(t=this.autoCompleteViewModel)||void 0===t?void 0:t.dropdownGroups,function(o){return!_.isEmpty(o.title)})},enumerable:!1,configurable:!0}),i.prototype.expandAllItems=function(){var n=this;S.fF.assertValue(this.shouldDisplayShowMore,"Expect this be called only when this.shouldDisplayShowMore is true"),S.fF.assertValue(this.autoCompleteViewModel,"Expect this.autoCompleteViewModel to be defined"),this.shouldDisplayShowMore=!1,S.fF.assert(function(){return _.last(_.last(n.autoCompleteViewModel.dropdownGroups).groupItems).isShowMore},"last group should be for showMore item");var t=_.size(this.autoCompleteViewModel.dropdownGroups)-2;S.fF.assert(function(){return t>=0},"expect lastVisibleGroupIndex>=0 before click ShowMore");var o=_.size(this.autoCompleteViewModel.dropdownGroups[t].groupItems)-1;S.fF.assert(function(){return o>=0},"expect lastVisiableItemIndex>=0 before click ShowMore"),this.autoCompleteViewModel.dropdownGroups=this.allDropdownGroups;var r=D(this.autoCompleteViewModel.dropdownGroups,{groupIndex:t,itemIndex:o});this.selectedGroupIndex=r.groupIndex,this.selectedSpanIndex=r.itemIndex,this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex),this.fullyExpanded.emit()},i.prototype.moveSelectionUp=function(){var t,o,n=this;if(this.isInitialized&&(!this.selectPrevious||void 0!==this.selectPrevious.value)&&null!==(t=this.autoCompleteViewModel)&&void 0!==t&&t.dropdownGroups){if(S.fF.assert(function(){return n.selectedSpanIndex>=0},"Expect selectedSpanIndex >= 0"),this.selectedSpanIndex>0)this.selectedSpanIndex--;else if(0===this.selectedSpanIndex)if(this.selectedGroupIndex>0)this.selectedGroupIndex--,this.selectedSpanIndex=this.autoCompleteViewModel.dropdownGroups[this.selectedGroupIndex].groupItems.length-1;else if(0===this.selectedGroupIndex)this.selectedGroupIndex--;else{this.selectedGroupIndex=this.autoCompleteViewModel.dropdownGroups.length-1;var r=null===(o=this.autoCompleteViewModel.dropdownGroups[this.selectedGroupIndex])||void 0===o?void 0:o.groupItems;_.isEmpty(r)||(this.selectedSpanIndex=r.length-1)}this.resetHoverIndices(),this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex)}},i.prototype.moveSelectionDown=function(){var n;if(this.isInitialized&&(!this.selectNext||void 0!==this.selectNext.value)&&null!==(n=this.autoCompleteViewModel)&&void 0!==n&&n.dropdownGroups){var t=D(this.autoCompleteViewModel.dropdownGroups,{groupIndex:this.selectedGroupIndex,itemIndex:this.selectedSpanIndex});this.selectedGroupIndex=t.groupIndex,this.selectedSpanIndex=t.itemIndex,this.resetHoverIndices(),this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex)}},i.prototype.selectCurrentDropdownItem=function(){var n,t;if(this.isInitialized&&(!this.confirmSelection||void 0!==this.confirmSelection.value)){var o=null===(n=this.autoCompleteViewModel)||void 0===n?void 0:n.dropdownGroups,r=o&&(null===(t=o[this.selectedGroupIndex])||void 0===t?void 0:t.groupItems);r&&r[this.selectedSpanIndex]?this.selectDropdownItem(r[this.selectedSpanIndex]):this.utteranceSelected.emit({utterance:void 0})}},i.prototype.currentDropdownString=function(n,t){var o,r=null===(o=this.autoCompleteViewModel.dropdownGroups[n])||void 0===o?void 0:o.groupItems,a=r&&r[t];if(a)return a.isShowMore?a.text:_.map(a.textSegments,function(s){return s.text}).join("").replace(ie," ")},i.prototype.screenReaderCurrentDropdownSelection=function(n,t){var o=this.currentDropdownString(n,t);if(o){var r=this.autoCompleteViewModel.dropdownGroups[n].title;this.screenReaderService.alertWithDebounce(I,r?r+" "+o:o)}},i.prototype.generateDropdownItems=function(n){if(n){var t=n.spans,o=n.cursorPosition;this.resetSelectedIndices(),this.resetHoverIndices();var r=(0,Pt._6)(t,o);if(-1===r)return void(this.showAutoCompleteDropdown=!1);this.unknownSpanHeaderTitle=void 0,this.unknownSpanHeaderSubtitle=void 0,this.selectedSpan=t[r],this.showUnknownSpanHeader=!1,this.disableUnknownSpanHeaderSubtitleAction=!1,this.isUnknownSpanHeaderForFixRequested=!1;var a=(0,Pt.d0)(n,r,this.localizationService);if(this.allDropdownGroups=(0,Pt.$v)(a.dropdownGroups,this.maxItemCountInFullExpansion),this.autoCompleteViewModel=_.merge({},a,{dropdownGroups:this.allDropdownGroups}),this.showAutoCompleteDropdown=!_.isEmpty(this.allDropdownGroups),this.generateUnknownSpanTitle(n,r),this.resetExpansionState(),this.showAutoCompleteDropdown){var s=_.sum(this.autoCompleteViewModel.dropdownGroups.map(function(h){return _.size(h.groupItems)}));this.shouldDisplayShowMore&&s--;var u=this.localizationService.format("Qna_ScreenReader_SuggestionsOpened_NoTerm",["".concat(s)]);this.screenReaderService.alertWithDebounce(p,u)}else this.screenReaderService.cancelDebounce(p)}},i.prototype.generateUnknownSpanTitle=function(n,t){var r,a,s,u,o=this;if("none"===(null===(a=null===(r=n.config.header)||void 0===r?void 0:r.unknownSpanHeaderConfig)||void 0===a?void 0:a.actionType))return this.showUnknownSpanHeader=!1,this.unknownSpanHeaderTitle=void 0,void(this.unknownSpanHeaderSubtitle=void 0);var h=n.spans,d=_.last(this.allDropdownGroups);if(d?.title&&this.unknownTermService){var g=_.map(h,function(H){return H.text}).join(""),v=null===(u=null===(s=n.config.header)||void 0===s?void 0:s.unknownSpanHeaderConfig)||void 0===u?void 0:u.actionType;if(d.title===this.localizationService.get("Qna_DidYouMean_LabelTextWithColon"))S.fF.assert(function(){var H;return null===(H=n.config.header)||void 0===H?void 0:H.show},"Expect params.config.header?.show to be true when lastDropdownGroup.title is not empty"),"textOnlyHeader"!==v&&!this.unknownTermService.wasUtteranceAdded(g,this.selectedSpan.text)&&(this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnusedTermWithAlternatesTitle"),this.unknownSpanHeaderSubtitle=this.unknownTermService.getLabel(h[t],v,n.modelOwner),this.showUnknownSpanHeader=!0);else if(d.title===this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle"))if(S.fF.assert(function(){var H;return null===(H=n.config.header)||void 0===H?void 0:H.show},"Expect params.config.header?.show to be true when lastDropdownGroup.title is not empty"),this.showUnknownSpanHeader=!0,"textOnlyHeader"===v){this.unknownSpanHeaderTitle=void 0;var w=n.config.header.unknownSpanHeaderConfig.textOnlyTemplate;if(w){var N=_.map(w.variables,function(H){var _e=1===H.type?o.selectedSpan.text:H.text;return H.isBold?(0,Pt.Je)(_e):_e});this.unknownSpanHeaderSubtitle=this.localizationService.format(w.template,N)}else this.unknownSpanHeaderSubtitle=this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle");this.disableUnknownSpanHeaderSubtitleAction=!0}else this.unknownTermService.wasUtteranceAdded(g,this.selectedSpan.text)?(this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnknowTermHasAlreadyBeenAdded"),this.disableUnknownSpanHeaderSubtitleAction=!0,this.isUnknownSpanHeaderForFixRequested=!0):(S.fF.assert(function(){return"askToAdd"===v||"defineInTooling"===v},"Expect the actionType is either AskToAdd or DefineInTooling"),this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle"),this.unknownSpanHeaderSubtitle=this.unknownTermService.getLabel(h[t],v,n.modelOwner))}},i.prototype.resetExpansionState=function(){var n,t;S.fF.assertValue(this.autoCompleteViewModel,"Expect this.autoCompleteViewModel to be defined"),this.autoCompleteViewModel.dropdownGroups=(0,Pt.$v)(this.allDropdownGroups,this.showUnknownSpanHeader?this.maxItemCountInPartialExpansion-1:this.maxItemCountInPartialExpansion),this.shouldDisplayShowMore=_.size(this.autoCompleteViewModel.dropdownGroups)<_.size(this.allDropdownGroups)||_.size(null===(n=_.last(this.autoCompleteViewModel.dropdownGroups))||void 0===n?void 0:n.groupItems)<_.size(null===(t=_.last(this.allDropdownGroups))||void 0===t?void 0:t.groupItems),this.shouldDisplayShowMore&&this.autoCompleteViewModel.dropdownGroups.push({groupItems:[{isShowMore:!0,text:this.localizationService.get("ShowMore"),textSegments:[],score:0}]})},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .link","{ color: var(--link-color) !important; opacity: 1 !important; }")},i.prototype.resetHoverIndices=function(){this.hoverGroupIndex=-1,this.hoverSpanIndex=0},i.prototype.resetSelectedIndices=function(){this.selectedGroupIndex=-1,this.selectedSpanIndex=0},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Gt.g),e.\u0275\u0275directiveInject(It.o),e.\u0275\u0275directiveInject(st.g),e.\u0275\u0275directiveInject(U.y0),e.\u0275\u0275directiveInject(un.U,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-autocomplete"]],inputs:{maxItemCountInFullExpansion:"maxItemCountInFullExpansion",maxItemCountInPartialExpansion:"maxItemCountInPartialExpansion",params:"params",presentation:"presentation",selectPrevious:"selectPrevious",selectNext:"selectNext",confirmSelection:"confirmSelection"},outputs:{utteranceSelected:"utteranceSelected",fullyExpanded:"fullyExpanded"},decls:1,vars:1,consts:[["id","qnaAutoComplete","role","listbox","class","qnaAutoComplete themeableElement highContrastBorder",3,"ngStyle",4,"ngIf"],["id","qnaAutoComplete","role","listbox",1,"qnaAutoComplete","themeableElement","highContrastBorder",3,"ngStyle"],["class","groupItem","drag-resize-disabled","true",3,"ngStyle",4,"ngFor","ngForOf"],["class","unknownTermTitle",3,"ngStyle",4,"ngIf"],["drag-resize-disabled","true",1,"groupItem",3,"ngStyle"],["class","dropdownGroupTitle",3,"ngStyle",4,"ngIf"],["class","dropdownGroupItems",4,"ngIf"],[1,"dropdownGroupTitle",3,"ngStyle"],[1,"dropdownGroupItems"],["class","singleDropdownItem","role","option","data-testid","single-dropdown-item",3,"ngStyle","ngClass","mouseenter","accessible-click",4,"ngFor","ngForOf"],["role","option","data-testid","single-dropdown-item",1,"singleDropdownItem",3,"ngStyle","ngClass","mouseenter","accessible-click"],["class","singleDropdownItemTextContainer",4,"ngIf"],["class","singleDropdownItemTextContainer showMoreItem",4,"ngIf"],[1,"singleDropdownItemTextContainer"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"singleDropdownItemTextContainer","showMoreItem"],["localize","ShowMore"],[1,"unknownTermTitle",3,"ngStyle"],["tabindex","0","drag-resize-disabled","true",3,"ngClass","innerHTML","ngStyle","accessible-click",4,"ngIf"],["tabindex","0","drag-resize-disabled","true",3,"ngClass","innerHTML","ngStyle","accessible-click"]],template:function(t,o){1&t&&e.\u0275\u0275template(0,fn,3,6,"ul",0),2&t&&e.\u0275\u0275property("ngIf",o.showAutoCompleteDropdown)},dependencies:[f.NgClass,f.NgForOf,f.NgIf,f.NgStyle,ot.X,it.t],styles:['.qnaAutoComplete[_ngcontent-%COMP%]{display:block;position:absolute;left:0;width:100%;border-radius:2px;box-shadow:0 1.2px 3.6px rgba(0,0,0,.11),0 6.4px 14.4px rgba(0,0,0,.13);background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{font-family:Segoe UI Semibold,wf_segoe-ui_semibold,helvetica,arial,sans-serif;background-color:transparent;margin:0;white-space:pre-wrap}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{padding:4px 8px 8px}html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{padding:4px 8px 8px}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.selected[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1Hover)}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]{font-weight:400!important;border-top-color:var(--colorNeutralForeground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--colorBrandForegroundLink);text-decoration:none;cursor:pointer!important}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]   .fixRequestedText[_ngcontent-%COMP%]{font-weight:700!important}.qnaAutoComplete[_ngcontent-%COMP%]   .groupItem[_ngcontent-%COMP%]{display:block;text-decoration:none}.qnaAutoComplete[_ngcontent-%COMP%]   .groupItem[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]{list-style:none;z-index:2;cursor:pointer;display:block;position:relative;margin-top:0!important;overflow:visible;white-space:pre-wrap}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:0;background-color:transparent;overflow-wrap:break-word}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{padding:4px 0 8px 16px}html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{padding:4px 16px 8px 0}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]   .singleDropdownItemTextContainer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem[_ngcontent-%COMP%]{color:var(--colorBrandForegroundLink)}.qnaAutoComplete[_ngcontent-%COMP%]   .matchedSegment[_ngcontent-%COMP%]{font-weight:700}']}),i}();function D(i,n){var t;S.fF.assertValue(i,"Expect dropdownGroups to be defined"),S.fF.assert(function(){return n.itemIndex>=0},"Expect currentIndices.itemIndex >= 0");var o=n.groupIndex,r=n.itemIndex,a=null===(t=i[o])||void 0===t?void 0:t.groupItems;return a&&r===a.length-1?o>=i.length-1?{groupIndex:-1,itemIndex:0}:{groupIndex:o+1,itemIndex:0}:o<0?{groupIndex:0,itemIndex:0}:{groupIndex:o,itemIndex:r+1}}var re=l(26898),le=l(83008),Ie=l(39503),ge=l(9380),R=l(76072),Me=l(84281),be=l(52298),Be=l(22844),ze=l(1240),we=["contentElementExtraContainer"],Ye=["deleteButton"],je=["commitButton"],lt=["autoComplete"],ut=["contentElement"],Ke=["qnaInputContainer"],Et=["beginGripper"],vt=["endGripper"],Ze=["spanElement"],Ht=function(n,t,o,r){return{width:n,height:t,right:o,top:r}},$t=function(n){return{"stroke-width":n}};function jt(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",19),e.\u0275\u0275element(1,"circle",20),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext(3).ngIf;e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction4(7,Ht,t.meatball.width+"px",t.meatball.height+"px",t.meatball.right+"px",t.meatball.top+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(12,$t,t.meatball.strokeWidth+"px")),e.\u0275\u0275attribute("stroke",t.meatball.strokeColor)("fill",o.useShellTheme?"":t.meatball.fillColor)("r",t.meatball.r)("cx",t.meatball.cx)("cy",t.meatball.cy)}}var Kt=function(n,t,o){return{notClickable:n,loadingIcon:t,warningIcon:o}},Vt=function(n,t){return{color:n,"font-size":t}};function Zt(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",17),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var h=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(h.resetAllState())}),e.\u0275\u0275template(1,jt,2,14,"svg",18),e.\u0275\u0275elementEnd()}if(2&i){var o=n.ngIf,r=e.\u0275\u0275nextContext(2).ngIf,a=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(6,Kt,s.noResetAllActionIndication,"loading"===o.state,"warning"===o.state))("ngStyle",e.\u0275\u0275pureFunction2(10,Vt,a.useShellTheme?"":a.questionFontProperties.color,r.iconFontSize+"px"))("pbi-tooltip",o.tooltipConfig),e.\u0275\u0275attribute("aria-label",o.ariaLabel)("role","normal"!==o.state?"alert":"button"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","normal"!==o.state)}}var De=function(n){return{width:n}},Je=function(n){return{"font-size":n}},Ee=function(n,t,o,r){return{state:n,ariaLabel:t,tooltipConfig:o,meatball:r}};function Te(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",14)(2,"span",15),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Zt,2,13,"span",16),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext().ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(11,De,null!=r.fullConfig&&r.fullConfig.showQuestionIcon?t.iconFontSize+"px":0)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(13,Je,o.questionFontProperties.size.px+"px")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction4(15,Ee,e.\u0275\u0275pipeBind1(5,3,r.questionIconProperties.state$),e.\u0275\u0275pipeBind1(6,5,r.questionIconProperties.ariaLabel$),e.\u0275\u0275pipeBind1(7,7,r.questionIconProperties.tooltipConfig$),e.\u0275\u0275pipeBind1(8,9,r.questionIconProperties.loadingWarningPresentation$)))}}function Ct(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32,33),e.\u0275\u0275listener("keyup",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2).$implicit,u=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(u.gripperKeyUp(a,s,"beginGripper"))})("cdkDragStarted",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(8);return e.\u0275\u0275resetView(a.beginGripperDragStarted())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(2,"svg",34),e.\u0275\u0275element(3,"rect"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"svg",35),e.\u0275\u0275element(5,"circle"),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext(7).ngIf;e.\u0275\u0275property("cdkDragData","beginGripper"),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("fill",o.errorUnderlineColor),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("stroke",o.errorUnderlineColor)("fill",o.backgroundColor)}}function mn(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",36,37),e.\u0275\u0275listener("keyup",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2).$implicit,u=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(u.gripperKeyUp(a,s,"endGripper"))})("cdkDragStarted",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(8);return e.\u0275\u0275resetView(a.endGripperDragStarted())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(2,"svg",38),e.\u0275\u0275element(3,"rect"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"svg",35),e.\u0275\u0275element(5,"circle"),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext(7).ngIf;e.\u0275\u0275property("cdkDragData","endGripper"),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("fill",o.errorUnderlineColor),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("stroke",o.errorUnderlineColor)("fill",o.backgroundColor)}}var an=function(n,t,o,r,a,s,u,h,d){return{dropZoneLocatedBeforeToken:n,dropZoneLocatedAfterToken:t,noGripperOnDragging:o,beginGripperOnDragging:r,endGripperOnDragging:a,serveBeginGripper:s,serveEndGripper:u,hasBeginGripper:h,hasEndGripper:d}};function wn(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",29),e.\u0275\u0275listener("cdkDropListEntered",function(h){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext(7);return e.\u0275\u0275resetView(d.gripperEnter(h))})("cdkDropListDropped",function(h){e.\u0275\u0275restoreView(t);var d=e.\u0275\u0275nextContext(7);return e.\u0275\u0275resetView(d.dropGripper(h))}),e.\u0275\u0275template(1,Ct,6,4,"div",30),e.\u0275\u0275template(2,mn,6,4,"div",31),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext(2).$implicit,a=e.\u0275\u0275nextContext(2).ngIf,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunctionV(5,an,[o===(null==r.dropZonesInfo?null:r.dropZonesInfo.zoneLocatedBeforeInfo),o===(null==r.dropZonesInfo?null:r.dropZonesInfo.zoneLocatedAfterInfo),"none"===a.gripperOnDragging,"beginGripper"===a.gripperOnDragging,"endGripper"===a.gripperOnDragging,!!o.beginGripperOf,!!o.endGripperOf,!!o.hasBeginGripper,!!o.hasEndGripper]))("cdkDropListData",o)("cdkDropListEnterPredicate",s.dropZonePredicate),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.hasBeginGripper),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.hasEndGripper)}}function vn(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,wn,3,15,"div",28),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t)}}var Cn=function(n,t){return[n,t]};function On(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,vn,2,1,"ng-container",27),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction2(1,Cn,null==t.dropZonesInfo?null:t.dropZonesInfo.zoneLocatedBeforeInfo,null==t.dropZonesInfo?null:t.dropZonesInfo.zoneLocatedAfterInfo))}}var Tn=function(n,t,o,r){return{space:n,filler:t,isBetweenDroppedGrippers:o,isBetweenOnDraggingGrippers:r}};function Po(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",26),e.\u0275\u0275text(1),e.\u0275\u0275template(2,On,2,4,"ng-container",0),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,o=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(4,Tn,t.isWhiteSpace,t.isFillerText,t.isBetweenDroppedGrippers,t.isBetweenOnDraggingGrippers)),e.\u0275\u0275attribute("aria-hidden",t.isWhiteSpace),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.text),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==o.fullConfig?null:o.fullConfig.supportTokenGrippers)}}var Io=function(n,t){return{height:n,bottom:t,left:0}};function Mo(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",39),e.\u0275\u0275element(1,"line",40),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3).ngIf;e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction2(7,Io,2*t.singleUnderlineThickness+"px",-.5*t.singleUnderlineSpace+-1.5*t.singleUnderlineThickness+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("x1",t.singleUnderlineThickness)("y1",t.singleUnderlineThickness)("y2",t.singleUnderlineThickness)("stroke-width",t.singleUnderlineThickness)("stroke-dasharray","1 "+(t.singleUnderlineThickness+2))("stroke",t.warningUnderlineColor)}}var xo=function(n,t,o,r,a,s){return{unused:n,space:t,corrected:o,showAcceptedUnderline:r,showErrorUnderline:a,showWarningUnderline:s}},Dn=function(n){return{"background-color":n}},Eo=function(n,t){return{hasMultipleTokens:n,unused:t}},bo=function(n,t,o,r){return{color:n,"border-bottom-color":t,"border-bottom-style":o,"border-bottom-width":r}};function wo(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",21,22),e.\u0275\u0275listener("mouseover",function(){var u=e.\u0275\u0275restoreView(t).$implicit,h=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(h.onSpanMouseEnter(u))})("mouseleave",function(){var u=e.\u0275\u0275restoreView(t).$implicit,h=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(h.onSpanMouseLeave(u))}),e.\u0275\u0275elementStart(2,"span",23),e.\u0275\u0275template(3,Po,3,9,"span",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Mo,2,10,"svg",25),e.\u0275\u0275elementEnd()}if(2&i){var o=n.$implicit,r=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction6(7,xo,o.isUnused,o.isWhiteSpace,o.isCorrected,o.shouldShowAcceptedUnderline,o.shouldShowErrorUnderline,o.shouldShowWarningUnderline))("ngStyle",e.\u0275\u0275pureFunction1(14,Dn,r.useShellTheme?"":o.backgroundColor)),e.\u0275\u0275attribute("aria-hidden",o.isWhiteSpace),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(16,Eo,(null==o.tokens?null:o.tokens.length)>1,o.isUnused))("ngStyle",e.\u0275\u0275pureFunction4(19,bo,r.useShellTheme?"":o.isUnused?r.droppedFontColor:r.questionFontProperties.color,r.useShellTheme?"":o.shouldShowAcceptedUnderline?r.acceptedUnderlineColor:o.shouldShowErrorUnderline?r.errorUnderlineColor:r.warningUnderlineColor,o.shouldShowAcceptedUnderline?"solid":o.shouldShowErrorUnderline?"double":"unset",(o.shouldShowAcceptedUnderline?r.singleUnderlineThickness:o.shouldShowErrorUnderline?2*r.singleUnderlineThickness:0)+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",null==o?null:o.tokens),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.shouldShowWarningUnderline)}}var Wn=function(n,t){return{disabled:n,usingShellTheme:t}},Oo=function(){return{tooltipLocalizeDescription:"Clear",tooltipShowOnFocus:!0}},Gn=function(n,t){return{"font-size":n,color:t}};function To(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",43)(1,"button",44,45),e.\u0275\u0275listener("accessible-click",function(s){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(u.clearButtonClicked(s))}),e.\u0275\u0275elementStart(3,"div",46)(4,"span",20),e.\u0275\u0275text(5,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",47),e.\u0275\u0275element(7,"i",48),e.\u0275\u0275elementEnd()()()()}if(2&i){var o=e.\u0275\u0275nextContext(4).ngIf,r=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(6,Wn,o.isUtteranceEmpty,r.useShellTheme))("pbi-tooltip",e.\u0275\u0275pureFunction0(9,Oo))("ngStyle",e.\u0275\u0275pureFunction1(10,Dn,r.useShellTheme?"":r.backgroundColor)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(12,Je,r.questionFontProperties.size.px+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(14,Je,r.questionFontProperties.size.px+"px")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction2(16,Gn,o.iconFontSize+"px",r.useShellTheme?"":r.questionFontProperties.color))}}var Do=function(n){return{"aria-label":n}},Bo=function(n){return{tooltipLocalizeDescription:n,tooltipShowOnFocus:!0}};function Fo(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",43)(1,"button",49,50),e.\u0275\u0275listener("accessible-click",function(u){e.\u0275\u0275restoreView(t);var h=e.\u0275\u0275nextContext(7);return e.\u0275\u0275resetView(h.commitButtonClicked(u))}),e.\u0275\u0275elementStart(3,"div",46)(4,"span",20),e.\u0275\u0275text(5,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",47),e.\u0275\u0275element(7,"i",51),e.\u0275\u0275elementEnd()()()()}if(2&i){var o=e.\u0275\u0275nextContext().ngIf,r=e.\u0275\u0275nextContext(4).ngIf,a=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(7,Wn,!o.isTrue,a.useShellTheme))("localizeAttr",e.\u0275\u0275pureFunction1(10,Do,o.isTrue?"Submit":"Qna_Input_SubmitQuestion_Disabled_Description"))("pbi-tooltip",e.\u0275\u0275pureFunction1(12,Bo,o.isTrue?"Submit":"Qna_Input_SubmitQuestion_Disabled_Description"))("ngStyle",e.\u0275\u0275pureFunction1(14,Dn,a.useShellTheme?"":a.commitButtonBackgroundColor)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(16,Je,a.questionFontProperties.size.px+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(18,Je,a.questionFontProperties.size.px+"px")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction2(20,Gn,r.iconFontSize+"px",a.useShellTheme?"":a.commitButtonForegroundColor))}}function Ao(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Fo,8,23,"div",42),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.commitVisible)}}var Vo=function(n){return{isTrue:n}};function Uo(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",41),e.\u0275\u0275listener("click",function(u){e.\u0275\u0275restoreView(t);var h=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(h.actionButtonsContainerClicked(u))}),e.\u0275\u0275template(2,To,8,19,"div",42),e.\u0275\u0275template(3,Ao,2,1,"ng-container",0),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var o=e.\u0275\u0275nextContext().ngIf,r=e.\u0275\u0275nextContext(2).ngIf,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,De,(r.iconFontSize+16)*(!a.inCommitOnDemandMode||null!=a.fullConfig.commitOnDemandConfigs&&a.fullConfig.commitOnDemandConfigs.hideCommitActionUI?1:2)+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.deleteVisible),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction1(7,Vo,e.\u0275\u0275pipeBind1(4,3,a.hasUncommittedQuestion$)))}}function Lo(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Uo,5,9,"ng-container",0),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.ngIf,o=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!o.isUtteranceEmpty||t.commitVisible||t.deleteVisible)}}var Ro=function(n,t){return{commitVisible:n,deleteVisible:t}};function Qo(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Lo,2,1,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction2(5,Ro,e.\u0275\u0275pipeBind1(2,1,t.commitActionVisible$),e.\u0275\u0275pipeBind1(3,3,t.clearActionVisible$)))}}function ko(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"qna-autocomplete",52,53),e.\u0275\u0275listener("utteranceSelected",function(s){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.autoCompleteDropdownItemSelected(s))})("fullyExpanded",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.autoCompleteFullyExpanded())}),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("withTopSeparator",o.height),e.\u0275\u0275property("params",r.autoCompleteInputArgs.params)("presentation",r.autoCompleteInputArgs.presentation)("selectPrevious",r.autoCompleteInputArgs.selectPrevious)("selectNext",r.autoCompleteInputArgs.selectNext)("confirmSelection",r.autoCompleteInputArgs.confirmSelection)}}var zo=function(n,t,o,r){return{withBorder:n,withShadow:t,authoringDisabled:o,showDisabled:r}},No=function(n,t,o,r,a,s,u,h,d){return{"background-color":n,color:t,"font-size":o,"font-family":r,"border-color":a,"font-weight":s,"font-style":u,"text-decoration":h,height:d}},qo=function(n){return{height:n}},Wo=function(n,t){return{withFixedHeight:n,allowContentHorizontalScroll:t}},Go=function(n){return{"max-height":n}},Ho=function(n){return{withMaxHeight:n}},$o=function(n){return{isGripperOnDragging:n}};function jo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275template(1,Te,9,20,"ng-container",0),e.\u0275\u0275elementStart(2,"div",4,5)(4,"div",6)(5,"div",7)(6,"div",8,9)(8,"div",10,11),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275template(11,wo,5,24,"span",12),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,Qo,4,8,"ng-container",0),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,ko,2,7,"qna-autocomplete",13),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd()()()),2&i){var t=n.ngIf,o=e.\u0275\u0275nextContext().ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.fullConfig?null:r.fullConfig.showQuestionIcon),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(20,zo,o.withBorder,o.withShadow,null==r.fullConfig?null:r.fullConfig.disableAuthoring,null==r.fullConfig?null:r.fullConfig.displayDisabledStateVisually))("ngStyle",e.\u0275\u0275pureFunctionV(25,No,[o.useShellTheme?"":o.backgroundColor,o.useShellTheme?"":o.questionFontProperties.color,o.questionFontProperties.size.px+"px",o.questionFontProperties.family,o.useShellTheme?"":o.borderColor,o.questionFontProperties.weight,o.questionFontProperties.style,o.questionFontProperties.textDecoration,o.height?o.height+"px":"auto"])),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(35,qo,o.height?o.height+"px":"auto"))("ngClass",e.\u0275\u0275pureFunction2(37,Wo,o.height,o.allowContentHorizontalScroll)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(40,Go,o.height?o.height+"px":"unset"))("ngClass",e.\u0275\u0275pureFunction1(42,Ho,o.height)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(44,$o,"none"!==t.gripperOnDragging)),e.\u0275\u0275attribute("contenteditable",r.isEditable())("placeholder",e.\u0275\u0275pipeBind1(10,14,r.placeholder$))("aria-label",r.ariaLabel),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(12,16,r.uiSpans$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",null==r.fullConfig?null:r.fullConfig.showActionButtons),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(15,18,r.shouldShowAutoComplete$))}}var Ko=function(n){return{corrected:n}};function Zo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",58),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(2,Ko,t.isCorrected)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.text)}}var Jo=function(n,t,o){return{color:n,"font-size":t,"font-family":o}};function Xo(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",54)(1,"span",55),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",56),e.\u0275\u0275listener("accessible-click",function(){var u=e.\u0275\u0275restoreView(t).ngIf,h=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(h.replaceWithCorrectedUtterance(u.replacementUtterance,u.state))}),e.\u0275\u0275template(4,Zo,2,4,"span",57),e.\u0275\u0275elementEnd()()}if(2&i){var o=n.ngIf,r=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction3(4,Jo,r.restatementFontProperties.color,r.restatementFontProperties.size.px+"px",r.restatementFontProperties.family)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.label),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",o.replacementUtterance),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",o.spans)}}var Yo=function(n,t,o){return{gripperOnDragging:n,isUtteranceEmpty:t,iconFontSize:o}};function ei(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,jo,16,46,"div",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,Xo,5,8,"div",2),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction3(10,Yo,e.\u0275\u0275pipeBind1(2,2,null==t.grippersInfo?null:t.grippersInfo.gripperOnDragging$),e.\u0275\u0275pipeBind1(3,4,t.isDisplayedUtteranceEmpty$),e.\u0275\u0275pipeBind1(4,6,t.iconFontSize$))),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(6,8,t.currentUtteranceAutoCorrectionInfo$))}}var Hn={withBorder:!1,withShadow:!1,backgroundColor:"#FFFFFF",borderColor:"#A19F9D",questionFontProperties:{color:"#323130",size:tt.B.createFromPt(10),family:"'Segoe UI', wf_segoe- ui_normal, helvetica, arial, sans- serif"},acceptedUnderlineColor:"#0078D4",errorUnderlineColor:"#FF0000",warningUnderlineColor:"#0078D4",singleUnderlineThickness:2,singleUnderlineSpace:1,droppedFontColor:"#A19F9D",hoverColor:"#EEEEEE",restatementFontProperties:{color:"#323130",size:tt.B.createFromPt(9),family:"'Segoe UI', wf_segoe- ui_normal, helvetica, arial, sans- serif"},commitButtonBackgroundColor:"#F3F2F1",commitButtonForegroundColor:"#323130",allowContentHorizontalScroll:!1},ni={sendPausedTagTimeout:3e3,showErrorWarningUnderlineTimeout:1500,showActionButtons:!0,showPlaceholderText:!0,showQuestionIcon:!0,showWarningIcon:!0,showLoadingIcon:!0,showCorrectedUtterance:!0,customPlaceholderText:"",autoFocusOnInit:!1,disableAuthoring:!1,disableAuthoringMessage:"",displayDisabledStateVisually:!0,disableSendingServiceTags:!1,supportTokenGrippers:!1,supportsPodQueries:!1,supportsInsightsQueries:!1,inferUnknownModelTerms:!1,singleAnswerBias:!1,hostSupportsUndo:!1,spanDropdownHeaderConfig:{show:!0,unknownSpanHeaderConfig:{actionType:"none"}},calculation:void 0,considerDroppedSpans:!0,considerErrorSpans:!0,considerWarningSpans:!0,commitOnDemandForcedMode:void 0,commitOnDemandConfigs:{hideCommitActionUI:!1,noCommitOnDropdownSelection:!1,noCommitOnInitialUtterance:!1}},Bn="\xa0",yn=function(){function i(n,t,o,r,a,s,u,h,d,g,v,w,N){this.changeDetectorRef=n,this.conceptualSchemaProxy=t,this.dataSourcesService=o,this.explorationNavigationService=r,this.featureSwitchService=a,this.highContrastCssGenerationService=s,this.lazyProvider=u,this.localizationService=h,this.screenReaderService=d,this.undoRedoService=g,this.linguisticSchemaProxy=v,this.qnaProxyPathToken=w,this.qnaModelUtilsPathToken=N,this.grippersDefinedTextRangeChanged=new e.EventEmitter,this.enterKeyPressed=new e.EventEmitter,this.initialized=new e.EventEmitter,this.toolingLaunched=new e.EventEmitter,this.inputBoxFocused=new e.EventEmitter,this.displayedUtteranceInternal$=new de.X(void 0),this.distinctDisplayedUtterance$=new de.X(void 0),this.hasUncommittedQuestion$=new de.X(!1),this.loadingStateTooltipConfig$=new de.X(void 0),this.warningStateTooltipConfig$=new de.X(void 0),this.hasFocus$=new de.X(void 0),this.cursorLocation$=new de.X(-1),this.uiSpanWithMouseHover$=new de.X(void 0),this.tokensGripperLocInfoUpdated$=new de.X(void 0),this.delayedSpanUnderlineStyleUpdated$=new de.X(void 0),this.contentElementAngularCommentNodes=[],this.destroy$=new he.xQ,this.firstTimeLoad=!0,this.componentUniqueId=Ae.b$.generateGuid(),this.interpretRequestSequenceNumber=-1,this.initializeHighContrastRules(),S.fF.assert(function(){return!(0,A.rO)()},"Expect input box never get created if it is in IE browser.")}return Object.defineProperty(i.prototype,"autoCompleteElementRef",{set:function(t){t&&(this.autoCompleteElement=t.nativeElement)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"contentElementRef",{set:function(t){var o=this;if(t&&(this.contentElement=t.nativeElement,this.firstTimeLoad)){this.firstTimeLoad=!1;var r=!1;this.contentElement&&this.isEditable()&&this.fullConfig.autoFocusOnInit&&(r=!0),this.contentElementAngularCommentNodes=_.takeWhile(this.contentElement.childNodes,function(a){return a.nodeType===Node.COMMENT_NODE}),_.isEmpty(this.contentElementAngularCommentNodes)&&(this.contentElementAngularCommentNodes=_.takeRightWhile(this.contentElement.childNodes,function(a){return a.nodeType===Node.COMMENT_NODE})),this.addEventListeners(),S.fF.assert(function(){return!o.initialUtteranceFromSaved||!_.isEmpty(o.initialUtterance)},"initialUtteranceFromSaved is true, then there must be an initialUtterance"),_.isEmpty(this.initialUtterance)?r&&setTimeout(function(){o.contentElement.focus()}):setTimeout(function(){var a,s;S.fF.assertValue(o.fullConfig,"this.fullConfig should already been set"),o.interpretUtteranceRequest$.next({utterance:o.initialUtterance,uniqueId:Ae.b$.generateGuid(),utteranceUITextAlreadyEnsured:!1,suppressSuggestions:!0,requireCursorAtEndIfFocused:!0,enforceFocus:r,delayError:!1,linguisticSchemaJson:o.linguisticInfo&&o.linguisticInfo.linguisticSchemaJson,inferredTermBinding:o.linguisticInfo&&o.linguisticInfo.inferredTermBinding,incomingTags:o.initialUtteranceFromSaved?["SavedQuestion"]:void 0,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:!(null!==(s=null===(a=o.fullConfig)||void 0===a?void 0:a.commitOnDemandConfigs)&&void 0!==s&&s.noCommitOnInitialUtterance)})})}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"spanElementRefs",{set:function(t){var o=this;_.forEach(t.toArray(),function(r){(0,Fe.R)(r.nativeElement,"click").pipe((0,J.R)(o.destroy$)).subscribe(function(a){var s=o.getUtteranceSelection();o.cursorLocation$.next(Ut(1,s)),o.flushUnderlineDelayApply(),Ge(a);var u=Ut(0,s);-1!==u&&o.showDropdownAtPosition(1,u)})})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"qnaInputContainerElementRef",{set:function(t){var o=this;t&&(this.qnaInputContainerElement=t.nativeElement,(0,Fe.R)(t.nativeElement,"focusout").pipe((0,J.R)(this.destroy$)).subscribe(function(r){var a=r.relatedTarget,s=r.target,u=!!s&&O(o.autoCompleteElement,s),h=!1;(!a&&!u||a&&!O(o.qnaInputContainerElement,a))&&(h=!0),h&&o.showHideDropdown(!1,{utterance:o.getCurrentUtteranceSpaceNormalized()})}))},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){var n;return(0,P.__awaiter)(this,void 0,void 0,function(){var t,r,a,s,u=this;return(0,P.__generator)(this,function(h){switch(h.label){case 0:return this.qnaProxyPath=this.qnaProxyPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule",t=this,[4,this.lazyProvider.get(this.qnaProxyPath,"InterpretServiceModern")];case 1:return t.interpretService=h.sent(),r=this,[4,this.lazyProvider.get(this.qnaModelUtilsPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaModelUtilsService")];case 2:return r.qnaModelUtils=h.sent(),this.fullConfig=_.merge({},ni,this.configs),[4,this.updateCommitOnDemandMode()];case 3:return h.sent(),this.placeholder$=this.fullConfig.showPlaceholderText?_.isEmpty(this.fullConfig.customPlaceholderText)?this.interpretService.getPlaceholderText(this.qnaSupportedScopes).pipe((0,B.q)(1),(0,j.U)(function(d){return d.result})):(0,Oe.of)(this.fullConfig.customPlaceholderText):(0,Oe.of)(""),this.fullConfig.showLoadingIcon&&this.interpretListener.getObservable().subscribe(function(d){if(d&&1===d.resultType&&null!=d.retryWarning){var g=Xn([d.retryWarning],u.qnaProxyPath,u.localizationService);if(S.fF.assert(function(){return!_.isEmpty(g)},"Unmapped retry warning"),!_.isEmpty(g)){var v={tooltipShowOnFocus:!0,tooltipDescription:g,tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()};u.loadingStateTooltipConfig$.next(v)}}}),this.ariaLabel=this.screenReaderService.concatMessages([this.fullConfig.customAriaLabel?this.fullConfig.customAriaLabel:this.localizationService.get("Qna_ScreenReader_TextboxLabel"),this.localizationService.get("Qna_ScreenReader_InitialInstruction")]),this.resetTags(),this.presentationSubject$=new de.X(this.presentationArgs),this.interpretUtteranceRequest$=new de.X(void 0),this.fullPresentation$=this.presentationSubject$.pipe((0,j.U)(function(d){var g=_.merge({},Hn,d);return g.singleUnderlineThickness=2+Math.floor(g.questionFontProperties.size.px/20),g}),(0,F.b)(function(d){u.autoCompleteInputArgs.presentation.next(d),u.errorBackgroundColorString=(0,pt.Et)(d.errorUnderlineColor,.15),u.warningBackgroundColorString=(0,pt.Et)(d.warningUnderlineColor,.15),u.acceptedBackgroundColorString=(0,pt.Et)(d.acceptedUnderlineColor,.15)}),(0,ne.d)()),this.fullConfig.showWarningIcon&&this.fullConfig.disableAuthoring&&!_.isEmpty(this.fullConfig.disableAuthoringMessage)&&this.warningStateTooltipConfig$.next({tooltipShowOnFocus:!0,tooltipDescription:this.fullConfig.disableAuthoringMessage,tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:this.getWarningLoadingIconTooltipArrowPosition()}),this.displayedUtteranceInternal$.pipe((0,J.R)(this.destroy$),(0,ee.x)()).subscribe(function(d){u.distinctDisplayedUtterance$.next(d)}),this.isDisplayedUtteranceEmpty$=this.distinctDisplayedUtterance$.pipe((0,J.R)(this.destroy$),(0,j.U)(function(d){return _.isEmpty(d)}),(0,ee.x)(),(0,ne.d)(1)),this.fullConfig.showActionButtons?this.inCommitOnDemandMode?(this.interpretUtteranceRequest$.pipe((0,J.R)(this.destroy$),(0,j.U)(function(d){return null!=d&&!d.isCommitInCommitQuestionOnDemandMode}),(0,ee.x)()).subscribe(function(d){u.hasUncommittedQuestion$.next(d)}),a=(0,Re.aj)([this.hasFocus$,this.isDisplayedUtteranceEmpty$,this.hasUncommittedQuestion$]).pipe((0,J.R)(this.destroy$),(0,j.U)(function(d){return!!d[2]||d[0]&&!d[1]}),(0,ee.x)(),(0,se.B)()),this.commitActionVisible$=null!==(n=this.fullConfig.commitOnDemandConfigs)&&void 0!==n&&n.hideCommitActionUI?(0,Oe.of)(!1):a.pipe((0,J.R)(this.destroy$)),this.clearActionVisible$=a.pipe((0,J.R)(this.destroy$))):(this.commitActionVisible$=(0,Oe.of)(!1),this.clearActionVisible$=(0,Re.aj)([this.hasFocus$,this.isDisplayedUtteranceEmpty$]).pipe((0,J.R)(this.destroy$),(0,j.U)(function(d){return d[0]&&!d[1]}),(0,ee.x)())):(this.commitActionVisible$=(0,Oe.of)(!1),this.clearActionVisible$=(0,Oe.of)(!1),this.noResetAllActionIndication=!0),this.isDisplayedUtteranceEmpty$.pipe((0,J.R)(this.destroy$)).subscribe(function(d){d&&(!_.isEmpty(u.utteranceSuggestions)&&u.isInputBoxFocused()?u.showUtteranceSuggestions():u.contentElement&&(u.updateAutoCompleteArgsCommand$.next(void 0),u.showHideDropdown(!1),u.resetPausedTagTimeoutHandler(!1)))}),this.interpretResponse$=this.interpretUtteranceRequest$.pipe((0,fe.R)(function(d,g){return d.push(g),d.slice(-2)},[]),(0,pe.h)(function(d){var g,v,w=_.last(d);if(!w)return!1;var N=null!==(g=$e(w.utterance))&&void 0!==g?g:"",H=null!==(v=u.initialUtterance)&&void 0!==v?v:"";return S.fF.assert(function(){return null!=u.contentElement||H===N},"If an interpret request sent in before this.contentElement is even initialized, we expect its utterance to be the same as 'initialUtterance' but now it's not. Re-check this assumption and fix accordingly."),!(null==u.contentElement&&H===N)}),(0,F.b)(function(d){_.nth(d,0)&&_.nth(d,1)&&!Kn(d[0].utterance,d[1].utterance)&&u.showGrippersAroundTextRangeRequest$.next(void 0)}),(0,j.U)(function(d){var g=_.last(d);if(!g.utteranceUITextAlreadyEnsured){var v=$e(g.utterance),w=u.getUtteranceSelection(),N=u.ensureContentElementUtteranceText(v);u.displayedUtteranceInternal$.next(v);var H=!1;if(N?(w||g.enforceFocus)&&(w&&u.isValidRange(w)?u.setUtteranceSelection(w):H=!0):!w&&g.enforceFocus&&(H=!0),H){var _e=g.utterance.length;u.setUtteranceSelection({normalizedAnchor:_e,normalizedFocus:_e})}}return g}),(0,pe.h)(function(d){return!!d}),(0,F.b)(function(d){u.displayedUtteranceInternal$.next($e(d.utterance))}),(0,xe.w)(function(d){return u.interpretInternal(d)})),this.currentUtteranceInterpretResponse$=(0,Re.aj)([this.interpretUtteranceRequest$,this.interpretResponse$]).pipe((0,j.U)(function(d){var g=d[0],v=d[1];if(v&&g&&v.interpretRequestId===g.uniqueId&&$e(g.utterance)===u.getCurrentUtteranceSpaceNormalized())return(0,P.__assign)((0,P.__assign)({},v),{suppressSuggestions:g.suppressSuggestions,requireCursorAtEndIfFocused:g.requireCursorAtEndIfFocused,enforceFocus:g.enforceFocus,delayError:g.delayError,isFromInputEvent:g.isFromInputEvent})}),(0,pe.h)(function(d){return!!d}),(0,J.R)(this.destroy$),(0,se.B)()),this.currentUtteranceInterpretResponseProcessed$=this.currentUtteranceInterpretResponse$.pipe((0,F.b)(function(d){if(u.loadingStateTooltipConfig$.next(void 0),u.fullConfig.showWarningIcon){var g=d?.warnings,v=Xn(g,u.qnaProxyPath,u.localizationService);if(!_.isEmpty(v)){var N={tooltipShowOnFocus:!0,tooltipDescription:_.isEmpty(u.fullConfig.disableAuthoringMessage)?v:u.localizationService.format("Qna_Input_Warning_AuthoringDisabled_Plus_AnotherWarning",[u.fullConfig.disableAuthoringMessage,v]),tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()};u.warningStateTooltipConfig$.next(N)}}}),(0,pe.h)(function(d){return d&&!(_.isEmpty(d.utterance)&&!d.results)}),(0,j.U)(function(d){var g;return{utterance:d.utterance,fullCoverageSpans:tn(d),modelOwner:null===(g=_.first(d.results))||void 0===g?void 0:g.modelOwner,suppressSuggestions:d.suppressSuggestions,requireCursorAtEndIfFocused:d.requireCursorAtEndIfFocused,enforceFocus:d.enforceFocus,delayError:d.delayError,isFromInputEvent:d.isFromInputEvent}}),(0,F.b)(function(d){var g=u.getUtteranceSelectionAnchor();d.suppressSuggestions?u.showHideDropdown(!1):u.updateAutoCompleteArgsCommand$.next({matchingUtterance:d.utterance,cursorPosition:Math.max(g,0),triggerSource:0,spans:d.fullCoverageSpans})}),(0,se.B)()),s=_.merge({},Hn,this.presentationArgs),this.setupAutoCompleteRelatedPipes(s),this.uiSpans$=this.currentUtteranceInterpretResponseProcessed$.pipe((0,ke.D)(function(d){return(0,Ue.H)(d.isFromInputEvent?200:0)}),(0,pe.h)(function(d){return $e(d.utterance)===u.getCurrentUtteranceSpaceNormalized()}),(0,j.U)(function(d){return{response:d,currentSelection:u.contentElement?u.getUtteranceSelection():void 0}}),(0,F.b)(function(d){var g=$e(d.response&&d.response.utterance),v=d.currentSelection;u.cleanContentElement(),u.cursorLocation$.next(-1),u.ensureAngularCommentNodes(),u.contentElement.contentEditable="false";var w=d.response;setTimeout(function(){u.changeDetectorRef.detectChanges();var N=u.getCurrentUtteranceSpaceNormalized();if(v){var H=!1;w.requireCursorAtEndIfFocused||g===N&&(H=!0),u.setUtteranceSelection(H?v:{normalizedAnchor:_e=N.length,normalizedFocus:_e})}else if(u.isInputBoxFocused()||w.enforceFocus){var _e;u.setUtteranceSelection({normalizedAnchor:_e=N.length,normalizedFocus:_e})}u.isInputBoxFocused()&&u.cursorLocation$.next(u.getUtteranceCursorPosition()),u.contentElement.contentEditable="true"},1)}),(0,j.U)(function(d){var g=d.response;return{uiSpans:ii(g.fullCoverageSpans,u.fullConfig),delayError:g.delayError,cursorPosition:d.currentSelection?d.currentSelection.normalizedFocus:-1}}),(0,F.b)(function(d){if(u.cancelUnderlineDelayApply(),d.delayError){var v,w,g=d.cursorPosition;-1!==g&&(v=_.find(d.uiSpans,function(N){return!N.isWhiteSpace&&g>=N.startIndex&&g<=N.endExcludingIndex})),v||(v=_.last(d.uiSpans)),v&&(v.shouldShowErrorUnderline||v.shouldShowWarningUnderline)&&(v.shouldShowErrorUnderline?(v.shouldShowErrorUnderline=!1,w=function(){v.shouldShowErrorUnderline=!0}):(v.shouldShowWarningUnderline=!1,w=function(){v.shouldShowWarningUnderline=!0}),u.underlineDelayApplyInfo={timeoutHandler:setTimeout(function(){w(),u.delayedSpanUnderlineStyleUpdated$.next(!0)},u.fullConfig.showErrorWarningUnderlineTimeout),apply:w})}}),(0,j.U)(function(d){return d.uiSpans}),(0,se.B)()),this.uiSpanWithCursor$=(0,Re.aj)([this.uiSpans$,this.cursorLocation$]).pipe((0,J.R)(this.destroy$),(0,j.U)(function(d){var v=d[1];if(!(v<0))for(var w=0,N=d[0]||[];w<N.length;w++){var H=N[w];if(!H.isWhiteSpace&&H.text.length>0&&v>=H.startIndex&&v<=H.endExcludingIndex)return H}}),(0,se.B)()),this.uiSpanWithCursor$.pipe((0,J.R)(this.destroy$),(0,pe.h)(function(d){return!!d})).subscribe(function(d){d.shouldShowErrorUnderline&&u.showGrippersAroundTextRangeRequest$.next({startIndex:d.startIndex,endExcludingIndex:d.endExcludingIndex})}),this.setupCorrectionRelatedPipes(),this.setupGrippersRelatedPipes(),(0,Re.aj)([this.uiSpans$,this.uiSpanWithCursor$,this.uiSpanWithMouseHover$,this.grippersInfo.grippersLocationDuringDragging$,this.tokensGripperLocInfoUpdated$,this.delayedSpanUnderlineStyleUpdated$]).pipe((0,J.R)(this.destroy$)).subscribe(function(d){var g=d[0],v=d[1],w=d[2],N=d[3],H=N?.associatedUISpans===g&&!!N?.begin&&!!N?.end;_.forEach(g,function(_e){var et=u.getUISpanBackgroundState(_e,_e===v,_e===w,H);_e.backgroundColor="error"===et?u.errorBackgroundColorString:"warning"===et?u.warningBackgroundColorString:"accepted"===et?u.acceptedBackgroundColorString:"transparent"})}),this.iconFontSize$=this.fullPresentation$.pipe((0,j.U)(function(d){return u.getIconFontSizePx(d)})),this.questionIconProperties={state$:new de.X("normal"),ariaLabel$:new de.X(this.localizationService.get("Qna_ScreenReader_TextboxIcon")),tooltipConfig$:new de.X(void 0),loadingWarningPresentation$:new de.X(void 0)},(0,Re.aj)([this.loadingStateTooltipConfig$,this.warningStateTooltipConfig$]).pipe((0,J.R)(this.destroy$)).subscribe(function(d){var g=d[0],v=d[1],w=g??v;u.questionIconProperties.state$.next(g?"loading":v?"warning":"normal");var N=[u.localizationService.get("Qna_ResetAllStates_Tooltip")];w?.tooltipDescription&&N.push(w?.tooltipDescription);var H=N.join("\n\n"),_e=(0,P.__assign)({},w??{tooltipShowOnFocus:!0,tooltipDescription:"",tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()});_e.tooltipDescription=H,u.questionIconProperties.tooltipConfig$.next(_e),u.questionIconProperties.ariaLabel$.next(_e.tooltipDescription)}),this.fullPresentation$.pipe((0,J.R)(this.destroy$)).subscribe(function(d){var g=u.getQuestionIconWarningCirleRadius(d);u.questionIconProperties.loadingWarningPresentation$.next({width:2*g,height:2*g,right:1-g+1,top:1-g+1,r:g,cx:g,cy:g,strokeColor:d.backgroundColor,strokeWidth:1,fillColor:d.commitButtonBackgroundColor})}),this.hasInitialized=!0,this.initialized&&this.initialized.emit(),[2]}})})},i.prototype.ngOnChanges=function(n){if(this.hasInitialized){var t=n.presentationArgs&&n.presentationArgs.currentValue;if(t){var o=n.presentationArgs.previousValue,r=o?_.merge({},o,t):t;this.presentationSubject$.next(r)}var a=n.configs&&n.configs.currentValue;if(a){var s=n.configs.previousValue;r=s?_.merge({},s,a):a,S.fF.assertValue(this.fullConfig,"this.fullConfig should have been initialized inside ngOnInit, since it comes here only if this.hasInitialized."),this.fullConfig=_.merge({},this.fullConfig,r)}}},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},Object.defineProperty(i.prototype,"currentDisplayedUtterance",{get:function(){return this.distinctDisplayedUtterance$.value},enumerable:!1,configurable:!0}),i.prototype.isEditable=function(){return!this.fullConfig.disableAuthoring},i.prototype.focus=function(){var n;if(this.contentElement&&(null===(n=this.fullConfig)||void 0===n||!n.disableAuthoring))return this.contentElement.focus(),!0},i.prototype.actionButtonsContainerClicked=function(){this.focus()},i.prototype.clearButtonClicked=function(n){Ge(n),this.clearUtterance(!0)},i.prototype.commitButtonClicked=function(n){Ge(n),this.hasUncommittedQuestion$.value&&this.commitUtterance()},i.prototype.showGrippersAroundTextRange=function(n){var t=this;S.fF.assert(function(){return t.fullConfig.supportTokenGrippers},"this should be called only when this.fullConfig.supportTokenGrippers is true"),this.showGrippersAroundTextRangeRequest$.next(n)},i.prototype.interpretUtterance=function(n){var t=n.utterance,o=n.isCommitInCommitQuestionOnDemandMode,r=n.specifiedSpans;if(this.inCommitOnDemandMode)if(n.useUncommittedUtterance&&this.hasUncommittedQuestion$.value){var a=this.getCurrentUtteranceSpaceNormalized();a!==t&&(t=a,o=!0,r=void 0)}else!this.hasUncommittedQuestion$.value&&n.utterance===this.getCurrentUtteranceSpaceNormalized()&&(o=!0);this.interpretUtteranceRequest$.next({utterance:t,uniqueId:Ae.b$.generateGuid(),isCommitInCommitQuestionOnDemandMode:o,utteranceUITextAlreadyEnsured:!1,delayError:!1,enforceFocus:n.enforceFocus,requireCursorAtEndIfFocused:n.requireCursorAtEndIfFocused,suppressSuggestions:n.suppressSuggestions,incomingTags:n.incomingTags,linguisticSchemaJson:this.linguisticInfo&&this.linguisticInfo.linguisticSchemaJson,inferredTermBinding:this.linguisticInfo&&this.linguisticInfo.inferredTermBinding,specifiedSpans:r})},i.prototype.clearUtterance=function(n,t){var o=this;void 0===t&&(t=!1),this.undoRedoService.register(this.inCommitOnDemandMode&&t?"Reset Qna state":"Clear QnA utterance",function(){var a=!!o.inCommitOnDemandMode&&t;o.interpretUtteranceRequest$.next({uniqueId:Ae.b$.generateGuid(),utterance:"",utteranceUITextAlreadyEnsured:!1,delayError:!1,enforceFocus:!!n,requireCursorAtEndIfFocused:!1,suppressSuggestions:!0,linguisticSchemaJson:void 0,inferredTermBinding:void 0,incomingTags:void 0,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:a})})},i.prototype.commitUtterance=function(){var n=this;S.fF.assert(function(){return n.inCommitOnDemandMode},"expect this.inCommitOnDemandMode to be true"),this.undoRedoService.register("Commit QnA utterance",function(){n.interpretUtteranceRequest$.next({uniqueId:Ae.b$.generateGuid(),utterance:n.displayedUtteranceInternal$.value,isCommitInCommitQuestionOnDemandMode:!0,utteranceUITextAlreadyEnsured:!0,delayError:!1,enforceFocus:!0,requireCursorAtEndIfFocused:!1,suppressSuggestions:!0,linguisticSchemaJson:void 0,inferredTermBinding:void 0,incomingTags:["Committed"],specifiedSpans:void 0})})},i.prototype.resetAllState=function(){this.clearUtterance(!0,!0)},i.prototype.replaceWithCorrectedUtterance=function(n,t){if(1===t||2===t){var o=1===t?["DidYouMean"]:["ShowingResultsFor"];return o.push("Committed"),void this.replaceWithUtterance(n,!0,!0,!0,o)}S.fF.assertFail("this should only be called for didYouMean or showingResultsFor")},i.prototype.onSpanMouseEnter=function(n){this.uiSpanWithMouseHover$.next(n)},i.prototype.onSpanMouseLeave=function(n){this.uiSpanWithMouseHover$.value===n&&this.uiSpanWithMouseHover$.next(void 0)},i.prototype.gripperKeyUp=function(n,t,o){var r=this,a="beginGripper"===o;if(a||"endGripper"===o){if("Escape"===n.key)return Ge(n),at(n),this.setUtteranceSelection({normalizedAnchor:t.position,normalizedFocus:t.position}),void this.updateAutoCompleteArgsCommand$.next({matchingUtterance:this.getCurrentUtteranceSpaceNormalized(),cursorPosition:t.position,triggerSource:2,spans:void 0});if("ArrowDown"===n.key)return Ge(n),at(n),this.setUtteranceSelection({normalizedAnchor:t.position,normalizedFocus:t.position}),void this.arrowDownOnInputboxHanlder();var u="ArrowLeft"===n.key;(u||"ArrowRight"===n.key)&&(Ge(n),at(n),this.showHideDropdown(!1),this.tryDropGripperInZone(o,a?u?t.previousBeginGripperZoneInfo:t.nextBeginGripperZoneInfo:u?t.previousEndGripperZoneInfo:t.nextEndGripperZoneInfo)&&setTimeout(function(){var g,v,w=a?null===(g=r.beginGripperElementRef)||void 0===g?void 0:g.nativeElement:null===(v=r.endGripperElementRef)||void 0===v?void 0:v.nativeElement;w&&w.focus()}))}},i.prototype.getWarningLoadingIconTooltipArrowPosition=function(){return yt.xI.arrowBottomLeft},i.prototype.getIconFontSizePx=function(n){return Math.max(n.questionFontProperties.size.px,14)},i.prototype.getQuestionIconWarningCirleRadius=function(n){var t=this.getIconFontSizePx(n);return 3+.5*(Math.floor(t/4)-4)+1},i.prototype.updateCommitOnDemandMode=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,t,o;return(0,P.__generator)(this,function(r){switch(r.label){case 0:return S.fF.assertValue(this.fullConfig,"this.fullConfig should already been set"),null!=(n=this.fullConfig.commitOnDemandForcedMode)?(this.inCommitOnDemandMode="AlwaysOn"===n,[2]):(this.inCommitOnDemandMode=!1,t=_.map(this.qnaSupportedScopes,function(a){return a.model}),o=this,[4,(0,Yt.U)(_.map(t,function(a){return{datasetName:a.dbName,datasetId:a.id}}),this.qnaModelUtils,this.featureSwitchService)]);case 1:return o.inCommitOnDemandMode=r.sent(),[2]}})})},i.prototype.getCurrentUtteranceSpaceNormalized=function(){return this.contentElement?$e(this.contentElement.textContent):void 0},i.prototype.getUISpanBackgroundState=function(n,t,o,r){return n.shouldShowAcceptedUnderline||n.shouldShowErrorUnderline||n.shouldShowWarningUnderline?((t||o)&&(a=!r&&!_.some(n.tokens,function(s){return s.isBetweenOnDraggingGrippers||s.isBetweenDroppedGrippers})),a?n.shouldShowErrorUnderline?"error":n.shouldShowWarningUnderline?"warning":"accepted":"normal"):"normal";var a},i.prototype.replaceWithUtterance=function(n,t,o,r,a){var s=this;this.undoRedoService.register("Replace QnA utterance",function(){var u,h;s.interpretUtteranceRequest$.next({uniqueId:Ae.b$.generateGuid(),utterance:n,utteranceUITextAlreadyEnsured:!1,suppressSuggestions:t,requireCursorAtEndIfFocused:!0,enforceFocus:o,delayError:!1,linguisticSchemaJson:null===(u=s.linguisticInfo)||void 0===u?void 0:u.linguisticSchemaJson,inferredTermBinding:null===(h=s.linguisticInfo)||void 0===h?void 0:h.inferredTermBinding,incomingTags:a,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:r})})},i.prototype.autoCompleteDropdownItemSelected=function(n){var t,o=this.getCurrentUtteranceSpaceNormalized();1===n.action&&this.toolingLaunched.emit();var r=!(null!==(t=this.fullConfig.commitOnDemandConfigs)&&void 0!==t&&t.noCommitOnDropdownSelection);_.isEmpty(n.utterance)||$e(n.utterance)===o?this.showHideDropdown(!!n.showDropdown,{incomingTags:n.tags,utterance:o}):(this.resetPausedTagTimeoutHandler(!1),this.replaceWithUtterance($e(n.utterance),!0,!0,r,n.tags),this.showHideDropdown(!1)),this.inCommitOnDemandMode&&r&&this.hasUncommittedQuestion$.value&&this.commitUtterance()},i.prototype.autoCompleteFullyExpanded=function(){S.fF.assertValue(this.utteranceSelectionAtLastAutoCompleteInputUpdate,"autocomplete fully expanded, this.utteranceSelectionAtLastAutoCompleteInputUpdate should be defined"),this.utteranceSelectionAtLastAutoCompleteInputUpdate?this.setUtteranceSelection(this.utteranceSelectionAtLastAutoCompleteInputUpdate):this.focus()},i.prototype.getTokenZoneInfo=function(n,t){var o=n.dropZonesInfo;if(o)return t?o.zoneLocatedBeforeInfo:o.zoneLocatedAfterInfo},i.prototype.dropZonePredicate=function(n,t){return"beginGripper"===n.data?!!t.data.beginGripperOf:!!t.data.endGripperOf},i.prototype.beginGripperDragStarted=function(){this.oneGripperDragStarted("beginGripper")},i.prototype.endGripperDragStarted=function(){this.oneGripperDragStarted("endGripper")},i.prototype.gripperEnter=function(n){var t,o;Zn(null===(t=n.item)||void 0===t?void 0:t.data,null===(o=n.container)||void 0===o?void 0:o.data,this.grippersInfo.grippersLocationDuringDragging$)},i.prototype.dropGripper=function(n){var t,o,r=null===(t=n.item)||void 0===t?void 0:t.data,a=null===(o=n.container)||void 0===o?void 0:o.data;this.tryDropGripperInZone(r,a)},i.prototype.tryDropGripperInZone=function(n,t){var o;return this.grippersInfo.gripperOnDragging$.next("none"),S.fF.assertValue(null===(o=this.grippersInfo.grippersLocationDuringDragging$.value)||void 0===o?void 0:o.associatedUISpans,"this.grippersInfo.grippersLocationDuringDragging$.value.associatedUISpans should be defined"),this.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:this.grippersInfo.grippersLocationDuringDragging$.value.associatedUISpans,begin:void 0,end:void 0}),Zn(n,t,this.grippersInfo.grippersLocationDropped$)},i.prototype.sendFeedback=function(n,t){return S.fF.assertValue(n,"invalid feedback"),S.fF.assertValue(t,"invalid feedback utterance"),this.interpretService.sendFeedback(n,t,this.qnaSupportedScopes,this.tags)},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".qnaInputV2Container svg *","{ stroke: @foregroundColor !important; fill: @foregroundColor !important; opacity: 1 !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .qnaInputV2Container *.disabled, .themeableElement .qnaInputV2Container *.disabled *","{ color: @disabledTextColor !important; border-color: @disabledTextColor !important; opacity: 1 !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .inputBox .qnaInputV2Container .inputWithoutAutoCompleteContainer button.actionButton.disabled:hover, .themeableElement .inputBox .qnaInputV2Container .inputWithoutAutoCompleteContainer button.actionButton.disabled:hover * ","{ background-color: transparent !important; color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule('html[data-focus-source="key"] .inputBox .qnaInputV2Container .beginGripper:focus, html[data-focus-source="key"] .inputBox .qnaInputV2Container .endGripper:focus',"{ outline-color: @foregroundColor; outline-offset: 4px; outline-style: dashed }")},i.prototype.showUtteranceSuggestions=function(){if(!_.isEmpty(this.utteranceSuggestions)){var n={startIndex:0,endExcludingIndex:0,text:"",isUnknown:!1,isCorrected:!1,state:"accepted",isOverlapping:!1,isWhiteSpace:!1,isUsed:!1,replacementBindings:{alternates:_.map(this.utteranceSuggestions,function(o){return{type:10,text:o,textSegmentsWithMatchInfo:[{text:o,isMatched:!1}],score:0}})}};this.showHideDropdown(!0),this.autoCompleteInputArgs.params.next({spans:[n],cursorPosition:0,config:{header:{show:!1}}}),this.resetPausedTagTimeoutHandler(!1)}},i.prototype.resetTags=function(){this.tags=[this.entryPoint]},i.prototype.flushUnderlineDelayApply=function(){if(this.underlineDelayApplyInfo){var n=this.underlineDelayApplyInfo.apply;this.cancelUnderlineDelayApply(),n()}},i.prototype.cancelUnderlineDelayApply=function(){this.underlineDelayApplyInfo&&(clearTimeout(this.underlineDelayApplyInfo.timeoutHandler),this.underlineDelayApplyInfo.timeoutHandler=void 0,this.underlineDelayApplyInfo=void 0)},i.prototype.showDropdownAtCurrentPosition=function(n){var t=this.getUtteranceSelectionAnchor();this.showDropdownAtPosition(n,t)},i.prototype.showDropdownAtPosition=function(n,t){S.fF.assert(function(){return-1!==t},"the given cursorPosition should not be -1.");var o=this.getCurrentUtteranceSpaceNormalized();S.fF.assert(function(){return t<=_.size(o)},"the given cursorPosition should not be > current displayed utterance's length."),-1!==t&&this.updateAutoCompleteArgsCommand$.next({matchingUtterance:o,cursorPosition:t,triggerSource:n,spans:void 0}),this.showHideDropdown(!0)},i.prototype.setupAutoCompleteRelatedPipes=function(n){var t=this;this.isDropdownOn$=new de.X(!1),this.updateAutoCompleteArgsCommand$=new de.X(void 0),this.autoCompleteInputArgs={params:new de.X(void 0),presentation:new de.X(n),selectPrevious:new de.X(void 0),selectNext:new de.X(void 0),confirmSelection:new de.X(void 0)},this.fullConfig.disableAuthoring?this.shouldShowAutoComplete$=(0,Oe.of)(!1):((0,Re.aj)([this.updateAutoCompleteArgsCommand$,this.currentUtteranceInterpretResponseProcessed$]).pipe((0,j.U)(function(o){var r=o[0],a=o[1];if(r&&a&&Kn(r.matchingUtterance,a.utterance))return{command:r,response:a}}),(0,pe.h)(function(o){return!!o}),(0,ee.x)(function(o,r){if(o.command.matchingUtterance===r.command.matchingUtterance&&o.command.cursorPosition===r.command.cursorPosition)return!0}),(0,j.U)(function(o){var r,a,s=o.command,u=o.response,h=t.getCurrentUtteranceSpaceNormalized(),d={spans:s.spans||u.fullCoverageSpans,cursorPosition:s.cursorPosition,config:{header:{show:(null===(r=t.fullConfig.spanDropdownHeaderConfig)||void 0===r?void 0:r.show)&&0!==s.triggerSource&&s.cursorPosition<h.length}},modelOwner:u.modelOwner,dataSourceArray:t.dataSourcesService.get(),exploration:t.explorationNavigationService.getCurrentExploration()};return d.config.header.show&&(d.config.header.unknownSpanHeaderConfig=null===(a=t.fullConfig.spanDropdownHeaderConfig)||void 0===a?void 0:a.unknownSpanHeaderConfig),{params:d,utterance:s.matchingUtterance}}),(0,J.R)(this.destroy$)).subscribe(function(o){t.autoCompleteInputArgs.params.next(o.params);var r=!_.isEmpty(o.utterance)&&!!o.params;t.resetPausedTagTimeoutHandler(r,o.utterance);var a=!_.isEmpty(o.utterance)&&!t.escapedDropdown;t.showHideDropdown(a)}),this.shouldShowAutoComplete$=(0,Re.aj)([this.isDropdownOn$,this.autoCompleteInputArgs.params]).pipe((0,j.U)(function(o){return!!o[1]&&!!o[0]}),(0,F.b)(function(o){t.utteranceSelectionAtLastAutoCompleteInputUpdate=o?t.getUtteranceSelection():void 0}),(0,ee.x)(),(0,J.R)(this.destroy$)))},i.prototype.setupCorrectionRelatedPipes=function(){var n=this;this.currentUtteranceAutoCorrectionInfo$=this.fullConfig.showCorrectedUtterance?this.currentUtteranceInterpretResponse$.pipe((0,pe.h)(function(o){return!o.isQuestionUnCommitted}),(0,j.U)(function(o){var s,u,r=_.first(o?.results),a=r?.correctionInfo;if(a&&0!==a.state)return function(i){return"correctedTextSegments"in i}(a)?(s=a.correctedUtterance,u=function(i){if(i){var n=i.correctedUtterance,t=i.correctedTextSegments,o=[];if(!_.isEmpty(t)){var r=0;return _.forEach(t,function(a){r<a.startIndex&&o.push({text:n.substring(r,a.startIndex),isCorrected:!1}),o.push({text:n.substring(a.startIndex,a.endExcludingIndex),isCorrected:!0}),r=a.endExcludingIndex}),r<n.length&&o.push({text:n.substring(r),isCorrected:!1}),o}}}(a)):(s=a.replacementUtterance,u=function(i,n){if(n){for(var t=n.correctedUtterance,o=[],r=0,a=0,s=0,u=0,h=i;u<h.length;u++){var d=h[u];if(!_.isEmpty(d.text)&&(r=s,null!=d.correctedStartIndex&&null!=d.correctedEndExcludingIndex?(a=d.correctedStartIndex,s=d.correctedEndExcludingIndex):s=(a=t.indexOf(d.text,r))+(d.endExcludingIndex-d.startIndex),d.isUsed)){if(r!==a){var g=t.substring(r,a);(!_.isEmpty(_.trim(g))||!_.isEmpty(o))&&o.push({text:t.substring(r,a),isCorrected:!1})}o.push({text:t.substring(a,s),isCorrected:d.isCorrected})}}return o}}(r.spans,a)),{label:ai(a.state,n.localizationService),spans:u,replacementUtterance:s,state:a.state}})):(0,Oe.of)(void 0)},i.prototype.setupGrippersRelatedPipes=function(){var n=this;this.grippersInfo={grippersLocationDropped$:new de.X(void 0),grippersLocationDuringDragging$:new de.X(void 0),gripperOnDragging$:new de.X("none")},this.showGrippersAroundTextRangeRequest$=new de.X(void 0),this.fullConfig.supportTokenGrippers&&((0,Re.aj)([this.uiSpans$,this.showGrippersAroundTextRangeRequest$]).pipe((0,J.R)(this.destroy$)).subscribe(function(t){var o=t[0],r=t[1],a=-1;r&&(a=_.findIndex(o,function(u){return u.startIndex===r.startIndex&&u.endExcludingIndex===r.endExcludingIndex})),n.grippersInfo.grippersLocationDropped$.next(-1===a?{associatedUISpans:o,begin:void 0,end:void 0}:{associatedUISpans:o,begin:{spanIndex:a,tokenIndex:0},end:{spanIndex:a,tokenIndex:_.size(o[a].tokens)-1}}),n.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:o,begin:void 0,end:void 0}),n.grippersInfo.gripperOnDragging$.next("none")}),(0,Re.aj)([this.uiSpans$,this.grippersInfo.grippersLocationDuringDragging$]).pipe((0,J.R)(this.destroy$),(0,ee.x)(function(t,o){return t[0]===o[0]&&_.isEqual(t[1],o[1])})).subscribe(function(t){var o=t[0],r=t[1];r&&r.associatedUISpans!==o||(_.forEach(o,function(a,s){_.forEach(a.tokens,function(u,h){u.isBetweenOnDraggingGrippers=!!r&&Jn(s,h,n.grippersInfo.grippersLocationDuringDragging$.value)})}),n.tokensGripperLocInfoUpdated$.next(!0))}),(0,Re.aj)([this.uiSpans$,this.grippersInfo.grippersLocationDropped$]).pipe((0,J.R)(this.destroy$),(0,ee.x)(function(t,o){return t[0]===o[0]&&_.isEqual(t[1],o[1])})).subscribe(function(t){var o=t[0],r=t[1];if(!r||r.associatedUISpans===o)if(_.forEach(o,function(g,v){_.forEach(g.tokens,function(w,N){var H=w.dropZonesInfo;if(r?.begin&&r?.end){if(H){var _e=H.zoneLocatedBeforeInfo;_e.hasBeginGripper=Sn(w,!0,"beginGripper",r),_e.hasEndGripper=Sn(w,!0,"endGripper",r);var et=H.zoneLocatedAfterInfo;et.hasBeginGripper=Sn(w,!1,"beginGripper",r),et.hasEndGripper=Sn(w,!1,"endGripper",r)}w.isBetweenDroppedGrippers=Jn(v,N,n.grippersInfo.grippersLocationDropped$.value)}else H&&(H.zoneLocatedBeforeInfo.hasBeginGripper=!1,H.zoneLocatedBeforeInfo.hasEndGripper=!1,H.zoneLocatedAfterInfo.hasBeginGripper=!1,H.zoneLocatedAfterInfo.hasEndGripper=!1),w.isBetweenDroppedGrippers=!1})}),n.tokensGripperLocInfoUpdated$.next(!0),r?.begin&&r?.end){var a=r.begin,u=r.end,h=o[u.spanIndex].tokens[u.tokenIndex];n.grippersDefinedTextRangeChanged.emit({startIndex:o[a.spanIndex].tokens[a.tokenIndex].startIndex,endExcludingIndex:h.startIndex+h.text.length})}else n.grippersDefinedTextRangeChanged.emit(void 0)}))},i.prototype.interpretInternal=function(n){var t=this;this.fullConfig.showWarningIcon&&!_.isEmpty(this.fullConfig.disableAuthoringMessage)?this.warningStateTooltipConfig$.next({tooltipShowOnFocus:!0,tooltipDescription:this.fullConfig.disableAuthoringMessage,tooltipDelay:0,tooltipHideDelay:0}):this.warningStateTooltipConfig$.next(void 0),this.loadingStateTooltipConfig$.next(void 0);var o=!0;this.inCommitOnDemandMode&&(o=!!n.isCommitInCommitQuestionOnDemandMode),this.escapedDropdown=!1;var r={utterance:"",interpretRequestId:n.uniqueId,isQuestionCommitted:!0};if(_.isEmpty(n.utterance))return o&&this.interpretListener.onInterpretResultCleared(),this.resetTags(),(0,Oe.of)(r);var a=_.union(this.tags,n.incomingTags);this.resetTags();var s=this.fullConfig.calculation;return s&&o&&(s=(0,P.__assign)((0,P.__assign)({},s),{isCommitted:!0})),this.interpretRequestSequenceNumber++,this.getReportMetadata().pipe((0,xe.w)(function(h){return t.interpretService.interpret({groupId:t.componentUniqueId,groupSequenceNumber:t.interpretRequestSequenceNumber},n.utterance,t.entryPoint,t.qnaSupportedScopes,t.interpretListener,{supportsPodQueries:t.fullConfig.supportsPodQueries,supportsInsightsQueries:t.fullConfig.supportsInsightsQueries,inferUnknownModelTerms:t.fullConfig.inferUnknownModelTerms,singleAnswerBias:t.fullConfig.singleAnswerBias,supportsCalculation:!!s},{isQuestionNotCommitted:!o,specifiedSpans:n.specifiedSpans,linguisticSchemaJson:n.linguisticSchemaJson,inferredTermBinding:n.inferredTermBinding,tags:a,calculation:s},h).pipe((0,B.q)(1),(0,j.U)(function(d){return _.merge({},d,{interpretRequestId:n.uniqueId,isQuestionUnCommitted:!o})}))}))},i.prototype.getReportMetadata=function(){var n=this;if("@powerbi/Qna/qnadesktop.module#QnaDesktopModule"!==this.qnaProxyPath||!this.fullConfig.supportsPodQueries||!this.linguisticSchemaProxy)return(0,Oe.of)(void 0);var t=this.explorationNavigationService.getCurrentExploration();return t?(0,Ve.D)(this.conceptualSchemaProxy.get(this.dataSourcesService.get())).pipe((0,j.U)(function(r){var a=n.linguisticSchemaProxy.getSchema(-1);if(a?.content)return{linguisticSchema:a.content,pods:_.map(t.pods,function(s){return{name:s.name,parameters:_.chain(s.parameters).map(function(u){var h=function(i,n,t,o){var r=_.find(t.sections,function(u){return u.name===n});if(r){var a=_.find(r.filters,function(u){return u.name===i});if(a?.expression){var s=a.expression.getConceptualProperty(o);return s?{column:s.name,entity:a.expression.getTargetEntity().entity}:void 0}S.fF.assertFail("filter should be part of the section and have an expression")}else S.fF.assertFail("pod section should be part of the exploration")}(u.boundFilter,s.boundSection,t,r);if(h)return{name:u.name,targetColumn:h.column,targetEntity:h.entity}}).filter(function(u){return!!u}).value(),cortanaEnabled:s.cortanaEnabled}})}})):(0,Oe.of)(void 0)},i.prototype.resetPausedTagTimeoutHandler=function(n,t){var o=this;this.fullConfig.disableSendingServiceTags||(null!=this.pausedTagTimeoutHandler&&(clearTimeout(this.pausedTagTimeoutHandler),this.pausedTagTimeoutHandler=null),n&&(S.fF.assert(function(){return!_.isEmpty(t)},"Expect the given utteranceIfRestart not to be empty."),this.pausedTagTimeoutHandler=setTimeout(function(){o.sendTags(["Paused"],t),o.pausedTagTimeoutHandler=void 0},this.fullConfig.sendPausedTagTimeout)))},i.prototype.showHideDropdown=function(n,t){if(!this.fullConfig.disableAuthoring){var o=this.isDropdownOn$.value;if(this.escapedDropdown=!n,(o!==n||n)&&(this.isDropdownOn$.next(n),t)){var r=void 0;_.isEmpty(this.getCurrentUtteranceSpaceNormalized())?r=_.union(t.incomingTags,["Dropdown:Suggested","Committed"]):(S.fF.assert(function(){return!_.isEmpty(t.utterance)},"Going to send tags for dropdown commit, expect its associated utterance not empty"),r=_.union(t.incomingTags,["Committed"])),this.resetPausedTagTimeoutHandler(!1),this.sendTags(r,t.utterance)}}},i.prototype.sendTags=function(n,t){return(0,P.__awaiter)(this,void 0,void 0,function(){var o;return(0,P.__generator)(this,function(r){switch(r.label){case 0:return o=_.union(this.tags,n),this.resetTags(),_.isEmpty(o)?[2]:[4,this.interpretService.sendTags(o,t,this.entryPoint,this.qnaSupportedScopes,{supportsPodQueries:this.fullConfig.supportsPodQueries,supportsInsightsQueries:this.fullConfig.supportsInsightsQueries,inferUnknownModelTerms:this.fullConfig.inferUnknownModelTerms,singleAnswerBias:this.fullConfig.singleAnswerBias})];case 1:return r.sent(),[2]}})})},i.prototype.isInputBoxFocused=function(){return this.contentElement&&O(this.contentElement,document.activeElement)},i.prototype.getUtteranceSelection=function(){if(S.fF.assertValue(this.contentElement,"this.contentElement"),this.isInputBoxFocused())return function(i){if(i&&window.getSelection){var n=window.getSelection();if(n.rangeCount&&O(i,n.anchorNode)&&O(i,n.focusNode)){var t=n.getRangeAt(0),o=t.cloneRange();o.selectNodeContents(i),o.setEnd(t.startContainer,t.startOffset);var r=o.toString().length;if(n.isCollapsed)return{normalizedAnchor:r,normalizedFocus:r};o.setEnd(t.endContainer,t.endOffset);var a=o.toString().length,s=n.anchorNode===t.startContainer;return{normalizedAnchor:s?r:a,normalizedFocus:s?a:r}}}}(this.contentElement)},i.prototype.isValidRange=function(n){var t=_.size(this.contentElement.textContent);return _.inRange(n.normalizedAnchor,0,t+1)&&_.inRange(n.normalizedFocus,0,t+1)},i.prototype.setUtteranceSelection=function(n){S.fF.assertValue(n,"selection"),S.fF.assertValue(this.contentElement,"this.contentElement"),function(i,n){S.fF.assertValue(i,"Expect the given node to be defined."),S.fF.assertValue(n,"Expect the given selectionRange to be defined."),S.fF.assert(function(){return _.inRange(n.normalizedAnchor,0,_.size(i.textContent)+1)},"Expect the given selectionRange.anchor is a valid position inside the given node"),S.fF.assert(function(){return _.inRange(n.normalizedFocus,0,_.size(i.textContent)+1)},"Expect the given selectionRange.focus is a valid position inside the given node");var t=_.size(i.textContent);if(i&&n&&_.inRange(n.normalizedAnchor,0,t+1)&&_.inRange(n.normalizedFocus,0,t+1)){var o=window.getSelection&&window.getSelection();if(o){var r=n.normalizedAnchor,a=n.normalizedFocus,s=y(i,r);if(S.fF.assertValue(s,"Expect to find the NodeAndOffset for character position "+r+" inside the node"),s){var u=a===r?s:y(i,a);if(S.fF.assertValue(s,"Expect to find the NodeAndOffset for character position "+a+" inside the node"),u){var h=s.node,d=s.textOrChildNodesOffset,g=u.node,v=u.textOrChildNodesOffset;if(o.anchorNode!==h||o.focusNode!==g||o.anchorOffset!==d||o.focusOffset!==v){i instanceof HTMLElement&&i.focus();var w=document.createRange();w.setStart(h,d),w.setEnd(g,v),o.removeAllRanges(),o.addRange(w)}}}}}}(this.contentElement,n)},i.prototype.getUtteranceCursorPosition=function(){var n=this.getUtteranceSelection();return n?n.normalizedFocus:-1},i.prototype.getUtteranceSelectionAnchor=function(){return Ut(0,this.getUtteranceSelection())},i.prototype.addEventListeners=function(){var n=this;(0,Fe.R)(this.contentElement,"click").pipe((0,J.R)(this.destroy$),(0,se.B)()).subscribe(function(g){var v=n.getUtteranceSelection(),w=Ut(1,v);n.cursorLocation$.next(w),n.flushUnderlineDelayApply(),Ge(g);var N=n.getCurrentUtteranceSpaceNormalized(),H=Ut(0,v);_.isEmpty(N)||-1!==H&&n.updateAutoCompleteArgsCommand$.next({matchingUtterance:N,cursorPosition:H,triggerSource:1,spans:void 0})});var o=(0,Fe.R)(this.contentElement,"paste").pipe((0,j.U)(function(g){return{event:g,beforePastedContentElementText:n.contentElement.textContent}}),(0,F.b)(function(g){if(at(g.event),Ge(g.event),window.getSelection){var v=(n.getCurrentUtteranceSpaceNormalized()||"").length,w=n.getUtteranceSelection();w&&(v-=Math.abs(w.normalizedAnchor-w.normalizedFocus));var N=(function(i){var n=i.originalEvent||i;return n.clipboardData&&n.clipboardData.getData?n.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):void 0}(g.event)||"").substr(0,200-v);!function(i){S.fF.assertValue(window.getSelection,"Expecting window.getSelection is defined");var n=window.getSelection();if(n.rangeCount){var t=n.getRangeAt(0);if(t.deleteContents(),i){var o=document.createTextNode(i);t.insertNode(o),t.setStart(o,i.length),t.collapse(!0)}}}(N)}}),(0,pe.h)(function(g){return g.beforePastedContentElementText!==n.contentElement.textContent})),r=(0,Fe.R)(this.contentElement,"compositionend").pipe((0,se.B)()),a=(0,Fe.R)(this.contentElement,"keyup").pipe((0,J.R)(this.destroy$),(0,pe.h)(function(g){return!Ot(g)}),(0,se.B)());a.pipe((0,J.R)(this.destroy$),(0,pe.h)(function(g){return"Backspace"===g.key||"Delete"===g.key})).subscribe(function(g){_.isEmpty(n.getCurrentUtteranceSpaceNormalized())&&n.cleanContentElement()}),a.pipe((0,J.R)(this.destroy$),(0,pe.h)(function(g){return _.includes(["Home","End","ArrowLeft","ArrowRight"],g.key)})).subscribe(function(g){Fn(g)||n.cursorLocation$.next(n.getUtteranceCursorPosition())});var s=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Backspace","Delete","Home","End","Enter","Escape","Tab"],u=["A","X","C","Z","a","x","c","z"],h=(0,Fe.R)(this.contentElement,"keydown").pipe((0,J.R)(this.destroy$),(0,pe.h)(function(g){return!Ot(g)}),(0,F.b)(function(g){!Fn(g)&&!_.includes(s,g.key)&&(!g.ctrlKey||!_.includes(u,g.key))&&n.getCurrentUtteranceSpaceNormalized().length>=200&&at(g)}),(0,se.B)());(0,Fe.R)(this.contentElement,"focus").pipe((0,J.R)(this.destroy$),(0,We.M)(this.distinctDisplayedUtterance$)).subscribe(function(g){var w=g[1];n.inputBoxFocused.emit(g[0]),n.hasFocus$.next(!0),n.cursorLocation$.next(n.getUtteranceCursorPosition()),!n.isAutoCompleteDropdownShown()&&_.isEmpty(w)&&n.showUtteranceSuggestions()}),(0,Fe.R)(this.contentElement,"blur").pipe((0,J.R)(this.destroy$)).subscribe(function(g){var v=g.relatedTarget;n.deleteButtonElementRef&&n.deleteButtonElementRef.nativeElement.contains(v)||n.commitButtonElementRef&&n.commitButtonElementRef.nativeElement.contains(v)||n.hasFocus$.next(!1),n.cursorLocation$.next(-1),n.flushUnderlineDelayApply();var H=window.getSelection?window.getSelection():void 0;H&&H.removeAllRanges()});var d=(0,Fe.R)(this.contentElement,"input").pipe((0,pe.h)(function(g){return!g.isComposing}));(0,Le.T)(d,r,o).pipe((0,J.R)(this.destroy$),(0,j.U)(function(g){return n.getCurrentUtteranceSpaceNormalized()}),(0,F.b)(function(g){n.displayedUtteranceInternal$.next(g)})).subscribe(function(g){n.interpretUtteranceRequest$.next({uniqueId:Ae.b$.generateGuid(),utterance:g,utteranceUITextAlreadyEnsured:!0,delayError:!0,enforceFocus:!1,suppressSuggestions:!1,requireCursorAtEndIfFocused:!1,linguisticSchemaJson:n.linguisticInfo&&n.linguisticInfo.linguisticSchemaJson,inferredTermBinding:n.linguisticInfo&&n.linguisticInfo.inferredTermBinding,incomingTags:void 0,specifiedSpans:void 0,isFromInputEvent:!0})}),h.pipe((0,J.R)(this.destroy$),(0,pe.h)(function(g){return!Ot(g)})).subscribe(function(g){if(Fn(g)&&!_.includes(["Tab","Enter"],g.key))return _.includes(["ArrowLeft","ArrowRight","Escape","ArrowDown"],g.key)?(Ge(g),void at(g)):void 0;var v=n.getCurrentUtteranceSpaceNormalized();switch(g.key){case"z":case"Z":St.M.isCtrlOrMeta(g)&&(at(g),n.fullConfig.hostSupportsUndo?n.contentElement.blur():Ge(g));break;case"ArrowLeft":n.flushUnderlineDelayApply(),Ge(g),_.isEmpty(v)||-1!==(N=Ut(0,w=n.getUtteranceSelection()))&&n.updateAutoCompleteArgsCommand$.next({matchingUtterance:v,cursorPosition:w.normalizedAnchor!==w.normalizedFocus?N:Math.max(0,N-1),triggerSource:2,spans:void 0});break;case"ArrowRight":case"Right":var w,N;n.flushUnderlineDelayApply(),Ge(g),_.isEmpty(v)||-1!==(N=Ut(0,w=n.getUtteranceSelection()))&&n.updateAutoCompleteArgsCommand$.next({matchingUtterance:v,cursorPosition:w.normalizedAnchor!==w.normalizedFocus?N:Math.min(N+1,v.length),triggerSource:2,spans:void 0});break;case"ArrowUp":n.flushUnderlineDelayApply(),Ge(g),at(g),n.autoCompleteInputArgs.selectPrevious.next(!0);break;case"ArrowDown":n.flushUnderlineDelayApply(),Ge(g),at(g),n.arrowDownOnInputboxHanlder();break;case"Enter":n.flushUnderlineDelayApply(),Ge(g),n.isAutoCompleteDropdownShown()?n.autoCompleteInputArgs.confirmSelection.next(!0):(n.enterKeyPressed&&n.enterKeyPressed.emit(),n.inCommitOnDemandMode&&n.hasUncommittedQuestion$.value&&n.commitUtterance()),at(g);break;case"Backspace":"false"===n.contentElement.contentEditable&&at(g);case"Delete":Ge(g);break;case"Escape":n.flushUnderlineDelayApply();var H=n.isAutoCompleteDropdownShown();n.showHideDropdown(!1,{utterance:v}),H&&(at(g),Ge(g));break;case"Home":_.isEmpty(v)||n.updateAutoCompleteArgsCommand$.next({matchingUtterance:v,cursorPosition:0,triggerSource:2,spans:void 0});break;case"End":_.isEmpty(v)||n.updateAutoCompleteArgsCommand$.next({matchingUtterance:v,cursorPosition:v.length,triggerSource:2,spans:void 0})}})},i.prototype.cleanContentElement=function(){this.contentElement&&_.filter(this.contentElement.childNodes,function(t){return t.nodeType!==Node.COMMENT_NODE}).forEach(function(t){Wt(t)})},i.prototype.isAutoCompleteDropdownShown=function(){var n;return null===(n=this.autoCompleteComponent)||void 0===n?void 0:n.showAutoCompleteDropdown},i.prototype.ensureAngularCommentNodes=function(){var n=this;""===this.contentElement.textContent&&(this.contentElement.innerHTML="");var t=[];_.forEach(this.contentElement.childNodes,function(h){h.nodeType===Node.COMMENT_NODE&&_.includes(n.contentElementAngularCommentNodes,h)&&t.push(h)});var o=_.size(this.contentElementAngularCommentNodes);if(_.size(t)!==o){_.forEach(t,function(h){return Wt(h)});var r=_.first(this.contentElement.childNodes);if(r)for(var a=r,s=void 0,u=o-1;u>=0;u--)this.contentElement.insertBefore(s=this.contentElementAngularCommentNodes[u],a),a=s;else _.forEach(this.contentElementAngularCommentNodes,function(h){n.contentElement.appendChild(h)})}},i.prototype.ensureContentElementUtteranceText=function(n){return $e(n)!==this.getCurrentUtteranceSpaceNormalized()&&(this.cleanContentElement(),n&&this.contentElement.appendChild(document.createTextNode(n)),!0)},i.prototype.oneGripperDragStarted=function(n){S.fF.assert(function(){return"none"!==n},"Expect this not to be called with GripperIdentifier.None");var t=this.grippersInfo.grippersLocationDropped$.value;S.fF.assertValue(t,"this.grippersInfo.grippersLocationDropped$.value should be defined"),this.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:t.associatedUISpans,begin:t.begin,end:t.end}),this.grippersInfo.gripperOnDragging$.next(n)},i.prototype.arrowDownOnInputboxHanlder=function(){this.showDropdownAtCurrentPosition(2),this.autoCompleteInputArgs.selectNext.next(!0)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(re.i),e.\u0275\u0275directiveInject(le.D),e.\u0275\u0275directiveInject(Ie.z),e.\u0275\u0275directiveInject(ge.vZ),e.\u0275\u0275directiveInject(Gt.g),e.\u0275\u0275directiveInject(R.E),e.\u0275\u0275directiveInject(It.o),e.\u0275\u0275directiveInject(st.g),e.\u0275\u0275directiveInject(Me.z),e.\u0275\u0275directiveInject(be.e,8),e.\u0275\u0275directiveInject(wt.n,8),e.\u0275\u0275directiveInject(zt.z,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-input-v2"]],viewQuery:function(t,o){if(1&t&&(e.\u0275\u0275viewQuery(we,5,e.ElementRef),e.\u0275\u0275viewQuery(Ye,5,e.ElementRef),e.\u0275\u0275viewQuery(je,5,e.ElementRef),e.\u0275\u0275viewQuery(lt,5,e.ElementRef),e.\u0275\u0275viewQuery(ut,5,e.ElementRef),e.\u0275\u0275viewQuery(V,5),e.\u0275\u0275viewQuery(Ke,5,e.ElementRef),e.\u0275\u0275viewQuery(Et,5,e.ElementRef),e.\u0275\u0275viewQuery(vt,5,e.ElementRef),e.\u0275\u0275viewQuery(Ze,5,e.ElementRef)),2&t){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.contentElementExtraContainer=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.deleteButtonElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.commitButtonElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.autoCompleteElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.contentElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.autoCompleteComponent=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.qnaInputContainerElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.beginGripperElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.endGripperElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.spanElementRefs=r)}},hostVars:1,hostBindings:function(t,o){2&t&&e.\u0275\u0275attribute("tabindex",null!=o.fullConfig&&o.fullConfig.disableAuthoring?null:-1)},inputs:{entryPoint:"entryPoint",presentationArgs:"presentationArgs",configs:"configs",qnaSupportedScopes:"qnaSupportedScopes",interpretListener:"interpretListener",linguisticInfo:"linguisticInfo",initialUtterance:"initialUtterance",initialUtteranceFromSaved:"initialUtteranceFromSaved",utteranceSuggestions:"utteranceSuggestions"},outputs:{grippersDefinedTextRangeChanged:"grippersDefinedTextRangeChanged",enterKeyPressed:"enterKeyPressed",initialized:"initialized",toolingLaunched:"toolingLaunched",inputBoxFocused:"inputBoxFocused"},features:[e.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[[4,"ngIf"],["class","resetButtonAndInputV2Container",4,"ngIf"],["class","qnaAutoCorrection",3,"ngStyle",4,"ngIf"],[1,"resetButtonAndInputV2Container"],["data-testId","qna-input-v2-container","role","application",1,"qnaInputV2Container",3,"ngClass","ngStyle"],["qnaInputContainer",""],[1,"inputAndAutoCompleteContainer",3,"ngStyle","ngClass"],[1,"inputWithoutAutoCompleteContainer",3,"ngStyle","ngClass"],["contenteditable","false","tabindex","-1",1,"utteranceContentExtraContainer"],["contentElementExtraContainer",""],["data-testId","qna-input-box","tabindex","0","cdkDropListGroup","","role","textbox","aria-autocomplete","list","spellcheck","false",1,"utteranceContent",3,"ngClass"],["contentElement",""],["class","term",3,"ngClass","ngStyle","mouseover","mouseleave",4,"ngFor","ngForOf"],[3,"withTopSeparator","params","presentation","selectPrevious","selectNext","confirmSelection","utteranceSelected","fullyExpanded",4,"ngIf"],[1,"beforeUtteranceOneLineHeightContainer",3,"ngStyle"],["aria-hidden","true",2,"width","1px",3,"ngStyle"],["class","questionIcon glyphicon pbi-glyph-qna",3,"ngClass","ngStyle","pbi-tooltip","accessible-click",4,"ngIf"],[1,"questionIcon","glyphicon","pbi-glyph-qna",3,"ngClass","ngStyle","pbi-tooltip","accessible-click"],["class","questionIconWarningLoadingCircle","preserveAspectRatio","none","style","position: absolute;",3,"ngStyle",4,"ngIf"],["preserveAspectRatio","none",1,"questionIconWarningLoadingCircle",2,"position","absolute",3,"ngStyle"],[3,"ngStyle"],[1,"term",3,"ngClass","ngStyle","mouseover","mouseleave"],["spanElement",""],[1,"term-main",3,"ngClass","ngStyle"],["class","token",3,"ngClass",4,"ngFor","ngForOf"],["style","position: absolute;",3,"ngStyle",4,"ngIf"],[1,"token",3,"ngClass"],[4,"ngFor","ngForOf"],["cdkDropList","","class","dropZone","contenteditable","false",3,"ngClass","cdkDropListData","cdkDropListEnterPredicate","cdkDropListEntered","cdkDropListDropped",4,"ngIf"],["cdkDropList","","contenteditable","false",1,"dropZone",3,"ngClass","cdkDropListData","cdkDropListEnterPredicate","cdkDropListEntered","cdkDropListDropped"],["cdkDrag","","class","beginGripper","cdkDragBoundary",".utteranceContent","tabindex","0",3,"cdkDragData","keyup","cdkDragStarted",4,"ngIf"],["cdkDrag","","class","endGripper","cdkDragBoundary",".utteranceContent","tabindex","0",3,"cdkDragData","keyup","cdkDragStarted",4,"ngIf"],["cdkDrag","","cdkDragBoundary",".utteranceContent","tabindex","0",1,"beginGripper",3,"cdkDragData","keyup","cdkDragStarted"],["beginGripper",""],["preserveAspectRatio","none",1,"line"],["preserveAspectRatio","none",1,"circle"],["cdkDrag","","cdkDragBoundary",".utteranceContent","tabindex","0",1,"endGripper",3,"cdkDragData","keyup","cdkDragStarted"],["endGripper",""],[1,"line"],[2,"position","absolute",3,"ngStyle"],["x2","100%","stroke-linecap","round"],[1,"actionButtonsInputBoxFullHeightContainer",3,"ngStyle","click"],["class","singleButtonContainer",4,"ngIf"],[1,"singleButtonContainer"],["role","button",1,"actionButton","deleteButton",3,"ngClass","pbi-tooltip","ngStyle","accessible-click"],["deleteButton",""],[1,"actionButtonsInputBoxOneLineHeightContainer",3,"ngStyle"],[1,"buttonIconContainer"],[1,"glyphicon","pbi-glyph-exit",3,"ngStyle"],["role","button","data-testId","qna-submit-button",1,"actionButton","commitButton",3,"ngClass","localizeAttr","pbi-tooltip","ngStyle","accessible-click"],["commitButton",""],[1,"glyphicon","pbi-glyph-rightarrow",3,"ngStyle"],[3,"params","presentation","selectPrevious","selectNext","confirmSelection","utteranceSelected","fullyExpanded"],["autoComplete",""],[1,"qnaAutoCorrection",3,"ngStyle"],[1,"correctedUtteranceLabel"],["tabindex","0",1,"correctedUtteranceContentContainer",3,"accessible-click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,o){1&t&&(e.\u0275\u0275template(0,ei,7,14,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,o.fullPresentation$))},dependencies:[f.NgClass,f.NgForOf,f.NgIf,f.NgStyle,k.Wj,k.Fd,k.Zt,Be.b,ze.i,it.t,V,f.AsyncPipe],styles:["@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.2}50%{opacity:1}to{opacity:.2}}html[data-focus-source=key][_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]:focus{outline:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]{display:flex}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]{margin-right:8px;padding:6px 0;background-color:transparent;position:relative;height:fit-content}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-40%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%]{cursor:pointer;color:var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%]   .questionIconWarningLoadingCircle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:var(--colorBrandBackground)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon.notClickable[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .loadingIcon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1s linear .5s infinite}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]{flex:1;display:flex;display:-ms-flexbox;flex-flow:column;align-items:flex-start;position:relative;cursor:text;margin:0;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border-color:var(--colorNeutralStrokeAccessible);--inputContainerBackgroundColor: inherit;--inputContainerColor: inherit}[data-legacy-theming=false][_ngcontent-%COMP%]   .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]{--inputContainerBackgroundColor: var(--colorNeutralForegroundInverted);--inputContainerColor: var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer[_ngcontent-%COMP%]{width:100%;overflow-y:hidden}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.withFixedHeight[_ngcontent-%COMP%]{overflow-y:auto}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer[_ngcontent-%COMP%]   .inputWithoutAutoCompleteContainer[_ngcontent-%COMP%]{width:100%;overflow-y:visible;display:flex;display:-ms-flexbox;flex-direction:column}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.allowContentHorizontalScroll[_ngcontent-%COMP%]{overflow-x:auto}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.allowContentHorizontalScroll[_ngcontent-%COMP%]   .inputWithoutAutoCompleteContainer[_ngcontent-%COMP%]{min-width:100%;width:fit-content}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.withBorder[_ngcontent-%COMP%]{border:1px solid;border-radius:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.withShadow[_ngcontent-%COMP%]{box-shadow:var(--fluent-shadow-depth4, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey))}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 auto;position:relative;display:inline-flex;display:-ms-inline-flexbox;background-color:var(--inputContainerBackgroundColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 0px;margin-left:10px;display:block;padding:6px;outline:none;box-sizing:border-box;white-space:pre-wrap;pointer-events:auto;-ms-user-select:text;user-select:text;-webkit-user-select:text;color:var(--inputContainerColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-selection, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::selection{background:var(--fluent-theme-neutral-lighter-secondary-color, #E5E5E5)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]:empty:before{content:attr(placeholder);color:var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{cursor:grabbing!important}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{display:inline}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{position:static;display:inline;cursor:text;margin:0;min-height:6px;color:var(--inputContainerColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main.hasMultipleTokens[_ngcontent-%COMP%]{white-space:nowrap}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main.unused[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{position:relative;display:inline}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.space[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.filler[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.isBetweenDroppedGrippers[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.isBetweenOnDraggingGrippers[_ngcontent-%COMP%]{background-color:rgba(254,217,204,.5)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{pointer-events:auto;cursor:grab;width:6px;height:100%;box-sizing:border-box;background:transparent}  html[data-focus-source=key] .resetButtonAndInputV2Container .qnaInputV2Container .utteranceContentExtraContainer .utteranceContent .term .term-main .token .beginGripper:focus,   html[data-focus-source=key] .resetButtonAndInputV2Container .qnaInputV2Container .utteranceContentExtraContainer .utteranceContent .term .term-main .token .endGripper:focus{outline-offset:2px;outline-style:dashed}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{width:2px;height:calc(100% - 12px)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{width:100%;height:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{width:8px;height:8px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{cx:4px;cy:4px;r:3px;stroke-width:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%]{pointer-events:auto;cursor:default;background-color:transparent;position:absolute}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.noGripperOnDragging[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.endGripperOnDragging[_ngcontent-%COMP%]:not(.serveEndGripper):not(.hasBeginGripper), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.beginGripperOnDragging[_ngcontent-%COMP%]:not(.serveBeginGripper):not(.hasEndGripper){visibility:hidden;width:0;height:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]{position:absolute;width:calc(50% + 2px);left:-2px;height:calc(100% + 14px);top:unset;bottom:-2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]{position:absolute;left:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{position:absolute;left:0;bottom:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{position:absolute;left:-3px;top:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]{position:absolute;right:-2px;height:calc(100% + 16px);width:calc(50% + 2px);top:-2px;bottom:unset}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{position:absolute;right:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{position:absolute;right:0;top:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{position:absolute;right:-3px;bottom:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.unused[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertiary-color, #A19F9D)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showAcceptedUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;padding-bottom:1px;border-bottom-color:var(--colorSuccessForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showAcceptedUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorSuccessForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]{position:relative}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;border-bottom-color:var(--colorSuccessForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorSuccessForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;width:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showErrorUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;padding-bottom:1px;border-bottom-color:var(--colorDangerForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showErrorUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorDangerForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]{display:flex;display:-ms-flexbox;position:relative;margin-left:2px;padding:1px 0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 auto;position:relative}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]{width:100%;position:absolute;top:0;padding:0;margin:0;border:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]{left:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]{right:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme).disabled, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme).disabled{opacity:.5;cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme):hover:not(.disabled), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme):hover:not(.disabled){filter:brightness(90%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme):active:not(.disabled), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme):active:not(.disabled){filter:brightness(80%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled);cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--colorNeutralBackground1Hover)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--colorNeutralBackground1Pressed)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]{background-color:var(--colorBrandBackground);color:var(--colorNeutralForegroundOnBrand)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme.disabled[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackgroundDisabled);color:var(--colorNeutralForegroundDisabled);cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--colorBrandBackgroundHover)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--colorBrandBackgroundPressed)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]   .actionButtonsInputBoxOneLineHeightContainer[_ngcontent-%COMP%]{padding:5px 0;width:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]   .actionButtonsInputBoxOneLineHeightContainer[_ngcontent-%COMP%]   .buttonIconContainer[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:100%;display:flex;display:-ms-flexbox;align-items:center;justify-content:center}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token.space[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token.filler[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%]{pointer-events:none!important}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled.showDisabled[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled.showDisabled[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]{opacity:.6}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     ul.qnaAutoComplete, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     .qnaAutoComplete ul{text-decoration:none;list-style:none;margin-top:4px!important;z-index:101;white-space:pre;max-height:400px;overflow-y:auto;padding:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     .withTopSeparator ul.qnaAutoComplete{border-top:solid 1px var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.qnaAutoCorrection[_ngcontent-%COMP%]{margin-top:8px;display:flex;display:-ms-flexbox}.qnaAutoCorrection[_ngcontent-%COMP%]   .correctedUtteranceContentContainer[_ngcontent-%COMP%]{margin-left:4px;cursor:pointer;font-style:italic;text-decoration:underline}.qnaAutoCorrection[_ngcontent-%COMP%]   .correctedUtteranceContentContainer[_ngcontent-%COMP%]   .corrected[_ngcontent-%COMP%]{font-weight:600}"]}),i}();function ii(i,n){if(i){var t=_.map(i,function(o){if(!_.isEmpty(o.text))return{text:o.isWhiteSpace?o.text:o.text.replace(" ",Bn),startIndex:o.startIndex,endExcludingIndex:o.endExcludingIndex,tokens:ri(o),isCorrected:o.isCorrected,isUnused:!o.isUsed&&n.considerDroppedSpans,isWhiteSpace:o.isWhiteSpace,shouldShowAcceptedUnderline:"accepted"===o.state,shouldShowErrorUnderline:"error"===o.state&&n.considerErrorSpans,shouldShowWarningUnderline:"warning"===o.state&&n.considerWarningSpans}}).filter(function(o){return!!o});return n.supportTokenGrippers&&function(i){var n,t;_.forEach(i,function(o,r){_.forEach(o.tokens,function(a,s){var u=i[r].tokens[s];if(!_.isEmpty(u.text)&&!u.isWhiteSpace){var h={position:a.startIndex,beginGripperOf:{spanIndex:r,tokenIndex:s},hasBeginGripper:!1,hasEndGripper:!1,previousBeginGripperZoneInfo:n,previousEndGripperZoneInfo:t},d={position:a.endExcludingIndex,endGripperOf:{spanIndex:r,tokenIndex:s},hasBeginGripper:!1,hasEndGripper:!1,previousBeginGripperZoneInfo:n,previousEndGripperZoneInfo:t};n&&(n.nextBeginGripperZoneInfo=h,n.nextEndGripperZoneInfo=d),t&&(t.nextBeginGripperZoneInfo=h,t.nextEndGripperZoneInfo=d),n=h,t=d,a.dropZonesInfo={zoneLocatedBeforeInfo:h,zoneLocatedAfterInfo:d}}})})}(t),t}}function ri(i){for(var n=[],t=0,o=function(g){var v=g.startIndex-i.startIndex,w=g.endExcludingIndex-g.startIndex;if(S.fF.assert(function(){return _.inRange(v,0,_.size(i.text))},"Expect each token.startIndex is a valid index with the given spanText and spanStartIndex"),S.fF.assert(function(){return!_.isEmpty(_.trim(i.text.substr(v,w)))},"Expect no Token being pure space"),t<v){var N=jn(i.startIndex,i.text,t,v,i.isWhiteSpace);n.push.apply(n,N||[])}n.push({text:g.text.replace(" ",Bn),startIndex:g.startIndex,endExcludingIndex:g.endExcludingIndex,isFillerText:!1,isWhiteSpace:!1}),t=v+w},r=0,a=i.tokens||[];r<a.length;r++)o(a[r]);var u=_.size(i.text);if(t<u){var h=jn(i.startIndex,i.text,t,u,i.isWhiteSpace);n.push.apply(n,h||[])}return n}function jn(i,n,t,o,r){S.fF.assert(function(){return _.inRange(t,0,_.size(n))},"Expect the given startIndexInSpan is a valid index in the given spanText"),S.fF.assert(function(){return _.inRange(o,0,_.size(n)+1)},"Expect the given notIncludingEndIndexInSpan is a valid index in the given spanText or equals to spanText.length+1");for(var a=[],s=/\s/.test(n.charAt(t)),u=t,h=t+1;h<=o;h++){var d=/\s/.test(n.charAt(h));if(h===o||s!==d){var g=h-u,v=s&&!r?_.repeat(Bn,g):n.substr(u,g);a.push({text:v,startIndex:i+u,endExcludingIndex:i+u+g,isFillerText:!0,isWhiteSpace:s}),s=d,u=h}}return a}function ai(i,n){if(i){if(1===i)return n.get("Qna_DidYouMean_LabelText");if(2===i)return n.get("Qna_ShowingResultsFor_LabelText")}}function at(i){i.preventDefault&&i.preventDefault()}function Ge(i){i.stopPropagation&&i.stopPropagation()}function Kn(i,n){return null==i?null==n:null==n?null==i:$e(i)===$e(n)}function Zn(i,n,t){var o,r,a,s;if(!n)return!1;if("beginGripper"===i&&n.beginGripperOf){var u=_.cloneDeep(t.value.end);if(n.beginGripperOf.spanIndex<u.spanIndex||n.beginGripperOf.spanIndex===u.spanIndex&&n.beginGripperOf.tokenIndex<=u.tokenIndex){var h=n.beginGripperOf;return S.fF.assertValue(null===(o=t.value)||void 0===o?void 0:o.associatedUISpans,"grippersPairLocation$.value.associatedUISpans should be defined"),t.next({associatedUISpans:null===(r=t.value)||void 0===r?void 0:r.associatedUISpans,begin:h,end:u}),!0}}else if("endGripper"===i&&n.endGripperOf){var d=_.cloneDeep(t.value.begin);if(n.endGripperOf.spanIndex>d.spanIndex||n.endGripperOf.spanIndex===d.spanIndex&&n.endGripperOf.tokenIndex>=d.tokenIndex){var g=n.endGripperOf;return S.fF.assertValue(null===(a=t.value)||void 0===a?void 0:a.associatedUISpans,"grippersPairLocation$.value.associatedUISpans should be defined"),t.next({associatedUISpans:null===(s=t.value)||void 0===s?void 0:s.associatedUISpans,begin:d,end:g}),!0}}return!1}function Sn(i,n,t,o){if(!o?.begin||!o?.end||!i.dropZonesInfo)return!1;var r=n?i.dropZonesInfo.zoneLocatedBeforeInfo:i.dropZonesInfo.zoneLocatedAfterInfo;S.fF.assert(function(){return"none"!==t},"The given gripper should not be GripperIdentifier.None");var a="beginGripper"===t?o.begin:o.end,s="beginGripper"===t?r.beginGripperOf:r.endGripperOf;return a.spanIndex===(s&&s.spanIndex)&&a.tokenIndex===(s&&s.tokenIndex)}function Jn(i,n,t){if(!t?.begin||!t?.end)return!1;var o=t.begin,a=t.end;return(i!==o.spanIndex?i>o.spanIndex:n>=o.tokenIndex)&&(i!==a.spanIndex?i<a.spanIndex:n<=a.tokenIndex)}function Fn(i){var n;return _.some(null===(n=i?.target)||void 0===n?void 0:n.classList,function(t){return"beginGripper"===t||"endGripper"===t})}function Xn(i,n,t){var o=dt.Tm(i,n);return _.map(o,function(a){return t.get(a)}).join("\n\n")}function Ut(i,n){return n?0===i?n.normalizedAnchor:n.normalizedFocus:-1}var Yn=l(71148),Lt=l(46135),eo=l(98136),to=l(77200),li=l(55232),no=l(28894),ui=l(73425),oo=l(98885),ci=l(46101),di=l(36858),pi=l(21548),ct=function(n){return{color:n}},An=function(){return{"aria-label":"Qna_FeedbackDialog_ThumbsUp"}},Vn=function(){return{"aria-label":"Qna_FeedbackDialog_ThumbsDown"}};function gi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"span",4),e.\u0275\u0275elementStart(2,"button",5),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.feedbackIconClick(!0))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",6),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.feedbackIconClick(!1))}),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,ct,o.fontColor)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(7,ct,o.fontColor))("localizeAttr",e.\u0275\u0275pureFunction0(9,An)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(10,ct,o.fontColor))("localizeAttr",e.\u0275\u0275pureFunction0(12,Vn))}}function hi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3)(1,"a",7),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.launchFeedbackDialog(!0))}),e.\u0275\u0275element(2,"span",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"button",9),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,ct,o.fontColor)),e.\u0275\u0275advance(2),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(5,An))("ngStyle",e.\u0275\u0275pureFunction1(6,ct,o.fontColor))}}function fi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3)(1,"a",10),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.launchFeedbackDialog(!1))}),e.\u0275\u0275element(2,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"button",12),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,ct,o.fontColor)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,ct,o.fontColor))("localizeAttr",e.\u0275\u0275pureFunction0(7,Vn))}}function mi(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"span",13)(2,"button",9),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,ct,t.fontColor)),e.\u0275\u0275advance(1),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(5,An))("ngStyle",e.\u0275\u0275pureFunction1(6,ct,t.fontColor))}}function vi(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"span",13)(2,"button",14),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,ct,t.fontColor)),e.\u0275\u0275advance(1),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(5,Vn))("ngStyle",e.\u0275\u0275pureFunction1(6,ct,t.fontColor))}}var Un=function(){function i(n,t,o,r){this.core=n,this.localizationService=t,this.qnaFeedbackStateService=o,this.screenReaderService=r}return i.prototype.ngOnInit=function(){this.utterance=this.core.getCurrentUtteranceTrimmed()},i.prototype.feedbackIconClick=function(n){var t={sentiment:n?1:-1,reason:void 0,comment:void 0};this.updateState(n?"PositiveChecked":"NegativeChecked"),this.sendFeedbackInterpretRequest(t)},i.prototype.getState=function(){return this.qnaFeedbackStateService.getState(this.utterance)},i.prototype.announceDescription=function(){var n=this.getState(),t=this.localizationService.get("Qna_FeedbackState_"+n);S.fF.assertValue(t,"no strings for current feedback state"),this.screenReaderService.alert(t)},i.prototype.launchFeedbackDialog=function(n){return(0,P.__awaiter)(this,void 0,void 0,function(){return(0,P.__generator)(this,function(t){return this.core.launchFeedbackDialog(n?1:-1,!0),[2]})})},i.prototype.sendFeedbackInterpretRequest=function(n){return S.fF.assertValue(n,"invalid feedback"),this.core.sendFeedback(n)},i.prototype.updateState=function(n){this.qnaFeedbackStateService.updateState(this.utterance,n)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(E.D),e.\u0275\u0275directiveInject(It.o),e.\u0275\u0275directiveInject(pi.B),e.\u0275\u0275directiveInject(st.g))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-feedback"]],inputs:{fontColor:"fontColor"},features:[e.\u0275\u0275ProvidersFeature([T.Q,eo.Z])],decls:7,vars:6,consts:[["focus-nav-mode","Hierarchy",1,"qnnFeedback",3,"focusin"],[3,"ngSwitch"],["class","textAndIcons",4,"ngSwitchCase"],[1,"textAndIcons"],["localize","Qna_FeedbackState_Unchosen",1,"descriptionText",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-like",3,"ngStyle","localizeAttr","accessible-click"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislike",3,"ngStyle","localizeAttr","accessible-click"],["href","javascript:void(0);",1,"descriptionText",3,"ngStyle","accessible-click"],["localize","Qna_FeedbackState_PositiveChecked"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-likesolid",3,"localizeAttr","ngStyle"],["href","javascript:void(0);",1,"descriptionText",3,"accessible-click"],["localize","Qna_FeedbackState_NegativeChecked",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislikesolid",3,"ngStyle","localizeAttr"],["localize","Qna_FeedbackState_FeedbackDetailSubmitted",1,"descriptionText",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislikesolid",3,"localizeAttr","ngStyle"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("focusin",function(){return o.announceDescription()}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275template(2,gi,4,13,"div",2),e.\u0275\u0275template(3,hi,4,8,"div",2),e.\u0275\u0275template(4,fi,4,8,"div",2),e.\u0275\u0275template(5,mi,3,8,"div",2),e.\u0275\u0275template(6,vi,3,8,"div",2),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",o.getState()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Unchosen"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","PositiveChecked"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","NegativeChecked"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","PositiveDetailSubmitted"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","NegativeDetailSubmitted"))},dependencies:[f.NgStyle,f.NgSwitch,f.NgSwitchCase,ot.X,Be.b,it.t],styles:['.qnnFeedback[_ngcontent-%COMP%]{height:100%}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]{display:flex;flex-direction:row}html:not([dir="rtl"])[_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%]{margin-right:10px}html[dir="rtl"][_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%]{margin-left:10px}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{background-color:transparent}html:not([dir="rtl"])[_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{margin-left:2px;margin-right:2px}html[dir="rtl"][_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{margin-left:2px;margin-right:2px}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon.pbi-glyph-likesolid[_ngcontent-%COMP%], .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon.pbi-glyph-dislikesolid[_ngcontent-%COMP%]{cursor:default}']}),i}(),Ln=l(59694),Ci=l(73221),_i=l(45769);function yi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-message-bar",2),e.\u0275\u0275listener("hideMessageBar",function(){var s=e.\u0275\u0275restoreView(t).$implicit,u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.onDismissBanner(s.id))}),e.\u0275\u0275elementEnd()}2&i&&e.\u0275\u0275property("viewModel",n.$implicit)}function Si(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,yi,1,1,"tri-message-bar",1),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function Pi(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Si,2,1,"ng-container",0),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.length>0)}}var Rn=function(i){function n(){var t=i.call(this)||this;return t.onDismiss=new e.EventEmitter,t}return(0,P.__extends)(n,i),n.prototype.ngOnInit=function(){var t=this;this.messageBarModels$=this.changes$("bannerContent").pipe((0,j.U)(function(o){return _.chain(o.banners).filter(function(a){return a.isVisible}).map(function(a){var s,u;return{id:a.id,bannerType:t.mapToMessageBarType(a.bannerType),message:t.mapToMessageBarText(a.message),barButtons:_.chain(a.actions).map(function(h){return t.mapToMessageBarAction(h,a.data)}).filter(function(h){return!!h}).value(),allowDismiss:a.allowDismiss,isRoundedCorners:!0,isMultiline:!0,link:null===(s=a.link)||void 0===s?void 0:s.href,linkDisplayName:null===(u=a.link)||void 0===u?void 0:u.text}}).value()}))},n.prototype.onDismissBanner=function(t){S.fF.assertValue(t,"bannerId"),this.onDismiss.emit(t)},n.prototype.mapToMessageBarType=function(t){switch(t){case"copilot":return 6;case"error":return 1;case"info":return 0;case"warning":return 2;default:S.fF.assertFail("unknown bannerType ".concat(t))}},n.prototype.mapToMessageBarText=function(t){return S.fF.assert(function(){return!(0,Ln.g)(t.text)},"banner message should be defined and non empty"),t.emphasis?"<b>".concat(t.emphasis,"</b> ").concat(t.text):t.text},n.prototype.mapToMessageBarAction=function(t,o){var r=this,a=(0,Ln.g)(t.text);if(S.fF.assert(function(){return!a},"banner action text should be defined and non empty"),!a)return{buttonText:t.text,buttonAction:function(){return function(h){if("noop"!==h){var d=r.bannerContent.actionHandlers.get(h);S.fF.assertValue(d,"handler with actionId ".concat(h)),null!=o?d(o):d()}}(t.id)},buttonAppearance:"primary"===t.actionAppearance?"primary":void 0,isLoading:"loading"===t.actionAppearance,isDisabled:"loading"===t.actionAppearance}},n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["qna-banner"]],inputs:{bannerContent:"bannerContent"},outputs:{onDismiss:"onDismiss"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],["style","margin-bottom: 4px;",3,"viewModel","hideMessageBar",4,"ngFor","ngForOf"],[2,"margin-bottom","4px",3,"viewModel","hideMessageBar"]],template:function(o,r){1&o&&(e.\u0275\u0275template(0,Pi,2,1,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.messageBarModels$))},dependencies:[f.NgForOf,f.NgIf,_i.h,f.AsyncPipe],styles:["[_nghost-%COMP%]     tri-message-bar .message-banner{border-top-color:transparent;border-right-color:transparent;border-left-color:transparent}"]}),n}(Ci.w),Ii=l(85102),Mi=["bannerMainMessageTextContainer"],xi=["contentContainer"];function Ei(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",8)(1,"div",9),e.\u0275\u0275element(2,"spinner",10)(3,"span",11),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("delay",0))}function bi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"canvas-visual-error-overlay",12),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.showQnaVisualErrorDetails())}),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("errorInfo",o.viewModel.error)("viewport",o.viewModel.viewport)}}function wi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"qna-banner",20),e.\u0275\u0275listener("onDismiss",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onBannerDismiss(a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var o=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("bannerContent",o)}}function Oi(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,wi,2,1,"ng-container",19),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showBanners)}}function Ti(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Oi,2,1,"ng-container",19),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,t.bannerContent$))}}var Di=function(){return{"aria-label":"VisualContainer_QnaVisual_Promotion_HideAction"}};function Bi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",22),e.\u0275\u0275element(1,"i",23)(2,"span",24,25),e.\u0275\u0275elementStart(4,"button",26),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.performBannerMainAction())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",27),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.dismissBanner())}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",o.bannerMainMessageTooltip)("localize","VisualContainer_QnaVisual_Promotion_MainMessage"),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","VisualContainer_QnaVisual_Promotion_ActionText"),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(6,5,"VisualContainer_QnaVisual_Promotion_HideAction"))("localizeAttr",e.\u0275\u0275pureFunction0(7,Di))}}function Fi(i,n){if(1&i&&e.\u0275\u0275template(0,Bi,7,8,"div",21),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",t.showLegacyBanner)}}var Ai=function(n){return{disabled:n}},Vi=function(){return{"aria-label":"Qna_ConvertDescription"}},io=function(n,t){return{color:n,"font-size":t}};function Ui(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"i",28),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.convertVisualClicked())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(6,Ai,!o.viewModel.result||"Visual"!==o.viewModel.result.type&&"QueryError"!==o.viewModel.result.type))("pbiTooltip",e.\u0275\u0275pipeBind1(1,4,"Qna_ConvertDescription"))("localizeAttr",e.\u0275\u0275pureFunction0(8,Vi))("ngStyle",e.\u0275\u0275pureFunction2(9,io,null==o.inputPresentation||null==o.inputPresentation.restatementFontProperties?null:o.inputPresentation.restatementFontProperties.color,(null==o.inputPresentation||null==o.inputPresentation.questionFontProperties?null:o.inputPresentation.questionFontProperties.size.px)+"px"))}}var Li=function(){return{"aria-label":"Qna_ToolingDescription"}};function Ri(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"i",29),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.showTooling("VisualTooling"))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,"Qna_ToolingDescription"))("localizeAttr",e.\u0275\u0275pureFunction0(5,Li))("ngStyle",e.\u0275\u0275pureFunction2(6,io,null==o.inputPresentation||null==o.inputPresentation.restatementFontProperties?null:o.inputPresentation.restatementFontProperties.color,(null==o.inputPresentation||null==o.inputPresentation.questionFontProperties?null:o.inputPresentation.questionFontProperties.size.px)+"px"))}}var Qi=function(n){return{hasBanner:n}};function ki(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ti,3,3,"ng-container",13),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Fi,1,1,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(5,"div",15)(6,"qna-input-v2",16),e.\u0275\u0275listener("inputBoxFocused",function(s){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onInputBoxFocused(s))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Ui,2,12,"i",17),e.\u0275\u0275template(8,Ri,2,9,"i",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var o=e.\u0275\u0275reference(4),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,12,r.allowTooling&&r.isCopilotSynonymsEnabled$))("ngIfElse",o),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(14,Qi,r.showLegacyBanner)),e.\u0275\u0275advance(1),e.\u0275\u0275property("entryPoint",r.viewModel.qnaInputConfiguration.entryPoint)("qnaSupportedScopes",r.viewModel.qnaInputConfiguration.qnaSupportedScopes)("interpretListener",r.viewModel.qnaInputConfiguration.interpretListener)("presentationArgs",r.inputPresentation)("configs",r.viewModel.qnaInputConfiguration.configs)("initialUtterance",r.viewModel.qnaInputConfiguration.initialUtterance)("initialUtteranceFromSaved",r.viewModel.qnaInputConfiguration.initialUtteranceFromSaved),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.config.canEdit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.allowTooling)}}var zi=function(n){return{color:n}};function Ni(i,n){if(1&i&&e.\u0275\u0275element(0,"i",30),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(3,zi,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color))("pbiTooltip",t.displayedRestatement),e.\u0275\u0275attribute("aria-label",t.displayedRestatement.tooltipDescription)}}var qi=function(n,t,o,r,a,s,u){return{"background-color":n,color:t,"font-size":o,"font-family":r,"font-weight":a,"font-style":s,"text-decoration":u}};function Wi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",45),e.\u0275\u0275listener("accessible-click",function(){var u=e.\u0275\u0275restoreView(t).$implicit,h=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(h.interpretSuggestedQuestion(u.content))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&i){var o=n.$implicit,r=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction7(3,qi,null==r.suggestionsPresentation?null:r.suggestionsPresentation.backgroundColor,null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties?null:r.suggestionsPresentation.cardFontProperties.color,(null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties||null==r.suggestionsPresentation.cardFontProperties.size?null:r.suggestionsPresentation.cardFontProperties.size.px)+"px",null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties?null:r.suggestionsPresentation.cardFontProperties.family,null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties?null:r.suggestionsPresentation.cardFontProperties.weight,null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties?null:r.suggestionsPresentation.cardFontProperties.style,null==r.suggestionsPresentation||null==r.suggestionsPresentation.cardFontProperties?null:r.suggestionsPresentation.cardFontProperties.textDecoration)),e.\u0275\u0275attribute("aria-label",o.accessibilityLabel),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.content," ")}}var Gi=function(n,t,o,r,a,s){return{color:n,"font-size":t,"font-family":o,"font-weight":r,"font-style":a,"text-decoration":s}},Hi=function(n){return{"aria-label":n}};function $i(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",40),e.\u0275\u0275element(1,"div",41),e.\u0275\u0275elementStart(2,"div",42),e.\u0275\u0275template(3,Wi,2,11,"div",43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",44),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.toggleShowAllSuggestions())}),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction6(4,Gi,null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties?null:o.suggestionsPresentation.headerFontProperties.color,(null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties||null==o.suggestionsPresentation.headerFontProperties.size?null:o.suggestionsPresentation.headerFontProperties.size.px)+"px",null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties?null:o.suggestionsPresentation.headerFontProperties.family,null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties?null:o.suggestionsPresentation.headerFontProperties.weight,null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties?null:o.suggestionsPresentation.headerFontProperties.style,null==o.suggestionsPresentation||null==o.suggestionsPresentation.headerFontProperties?null:o.suggestionsPresentation.headerFontProperties.textDecoration)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",o.viewModel.result.suggestions),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("localize",o.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction1(11,Hi,o.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"))}}var ro=function(n,t,o,r,a){return{color:n,"font-family":t,"font-weight":o,"font-style":r,"text-decoration":a}};function ji(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",46),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(2,ro,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.family,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.weight,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.style,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.textDecoration)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.viewModel.result.failedToLoadSuggestionsMessage," ")}}function Ki(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,$i,5,13,"div",38),e.\u0275\u0275template(2,ji,2,8,"span",39),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.viewModel.result.suggestions.length>0&&t.suggestionsPresentation.show),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.viewModel.result.failedToLoadSuggestionsMessage&&t.suggestionsPresentation.show)}}function Zi(i,n){1&i&&e.\u0275\u0275element(0,"spinner",52),2&i&&e.\u0275\u0275property("delay",0)}function Ji(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",49),e.\u0275\u0275template(1,Zi,1,1,"spinner",50),e.\u0275\u0275element(2,"single-visual-host",51),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.viewModel.result.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("visual",t.viewModel.result.visual)("visualViewport",t.viewModel.viewport)("themeCollection",t.viewModel.themeCollection)("config",t.core.singleVisualHostConfig)}}function Xi(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",47),e.\u0275\u0275template(1,Ji,3,5,"div",48),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.viewModel.result.visual&&t.core.singleVisualHostConfig)}}function Yi(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",57),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(r.launchFeedbackDialog(-1,!1))}),e.\u0275\u0275element(1,"span",58),e.\u0275\u0275elementEnd()}}function er(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",53)(1,"div",54)(2,"div")(3,"span",55),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Yi,2,0,"a",56),e.\u0275\u0275elementEnd()()()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction5(3,ro,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.family,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.weight,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.style,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.textDecoration)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.viewModel.result.message),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.allowFeedback&&t.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function tr(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function nr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",59),e.\u0275\u0275template(1,tr,1,0,"ng-container",60),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(7);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function or(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function ir(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",59),e.\u0275\u0275template(1,or,1,0,"ng-container",60),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(7);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function rr(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",57),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(r.launchFeedbackDialog(-1,!1))}),e.\u0275\u0275element(1,"span",58),e.\u0275\u0275elementEnd()}}function ar(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"canvas-visual-error-overlay",12),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.showResultErrorDetails())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(1,rr,2,0,"a",56)}if(2&i){var o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("errorInfo",o.viewModel.result)("viewport",o.viewModel.viewport),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.allowFeedback&&o.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function sr(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0,31),e.\u0275\u0275template(1,Ki,3,2,"div",32),e.\u0275\u0275template(2,Xi,2,1,"div",33),e.\u0275\u0275template(3,er,6,9,"div",34),e.\u0275\u0275template(4,nr,2,1,"div",35),e.\u0275\u0275template(5,ir,2,1,"div",35),e.\u0275\u0275template(6,ar,2,3,"ng-template",null,36,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngSwitch",t.viewModel.result.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Suggestions"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Visual"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","DoNotUnderstand"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Error"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","QueryError")}}function lr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",64),e.\u0275\u0275element(1,"qna-feedback",65),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("fontColor",null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color)}}function ur(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",66),e.\u0275\u0275element(1,"span",67)(2,"a",68),e.\u0275\u0275elementEnd())}function cr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",61),e.\u0275\u0275template(1,lr,2,1,"div",62),e.\u0275\u0275template(2,ur,3,0,"div",63),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.allowFeedback&&t.core.showFeedbackForCurrentQuestion()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,2,t.isCopilotSynonymsEnabled$)&&"Visual"===(null==t.viewModel.result?null:t.viewModel.result.type))}}var dr=function(n,t){return{contentReady:n,suggestionContent:t}},Qn=function(){function i(n,t,o,r,a,s,u,h,d,g){this.dataSources=n,this.explorationNavigation=t,this.featureSwitchService=o,this.lazyScoped=r,this.viewModeState=a,this.telemetryService=s,this.core=u,this.highContrastCssGenerationService=h,this.settingsService=d,this.qnaToolingDialogLauncher=g,this.inputBoxFocused=new e.EventEmitter,this.utteranceUpdated=new e.EventEmitter,this.convertVisual=new e.EventEmitter,this.destroy$=new he.xQ,this.viewModel=this.core.viewModel,S.fF.assert(function(){return!(0,A.rO)()},"Expect qna.component never get created if it is in IE browser."),this.highContrastCssGenerationService.addRule('html[data-focus-source="key"] .themeableElement .qnaVisual *:focus',"{ outline: 2px solid @selectedBackgroundColor; }")}return Object.defineProperty(i.prototype,"inputComponent",{set:function(t){var o=this;this.qnaInputComponent=t,this.core.setGetQnaInputComponentFunc(function(){return o.qnaInputComponent})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_bannerMessageElementRef",{set:function(t){this.bannerMainMessageTextContainerElementRef=t,t&&this.updateBannerMainMessageTooltipConfig()},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,t,o,r,s,u=this;return(0,P.__generator)(this,function(h){switch(h.label){case 0:return n=0!==this.viewModeState.getMode(),this.initializedTelemetryEvent=this.telemetryService.logEvent(Qe,{isAuthoring:n,entryPoint:this.entryPoint}),S.fF.assertValue(this.config,"Expect this.config to be defined"),t=_.cloneDeep(this.config),t=_.merge({},t,{hostHandlesUndo:!0}),[4,this.core.initialize(this.models,t,this.hostServices,this.entryPoint,this.utteranceUpdated,this.convertVisual,this.initializedTelemetryEvent,this.contentContainerElement,void 0)];case 1:return h.sent(),this.isCopilotSynonymsEnabled$=this.featureSwitchService.featureSwitches$.pipe((0,j.U)(function(d){return d.qnaImproveLsdlCopilot})),o=this,[4,this.core.shouldShowThumbsUpDown()];case 2:return o.allowFeedback=h.sent(),r=this,[4,this.core.allowTooling()];case 3:return r.allowTooling=h.sent(),this.allowTooling?[4,this.lazyScoped.get("improveLsdlBackgroundService")]:[3,7];case 4:return[4,h.sent().tryImproveLsdl("qnaVisual")];case 5:return h.sent(),s=this,[4,this.lazyScoped.get("qnaBannerService")];case 6:s.qnaBannerService=h.sent(),this.bannerContent$=this.qnaBannerService.getBannerContent("Visual"),h.label=7;case 7:return this.showLegacyBanner=this.shouldShowBanner(),this.settingsService.settingChanged$.pipe((0,J.R)(this.destroy$)).subscribe(function(d){"ShowQnaVisualBanner"===d&&(u.showLegacyBanner=u.shouldShowBanner())}),[2]}})})},i.prototype.ngAfterViewInit=function(){this.core.updateViewport()},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},i.prototype.onBannerDismiss=function(n){var t;null===(t=this.qnaBannerService)||void 0===t||t.dismissBanner("Visual",n)},i.prototype.update=function(n){(0,oe.yE)(n.type,Lt.EP.Resize)&&this.updateBannerMainMessageTooltipConfig(),this.core.update(n)},i.prototype.enumerateObjectInstances=function(n){return this.core.enumerateObjectInstances(n)},i.prototype.getFormattingModel=function(){return this.core.getFormattingModel()},i.prototype.focus=function(){if(this.qnaInputComponent)return this.qnaInputComponent.focus(),!0},i.prototype.onInputBoxFocused=function(n){this.inputBoxFocused.emit(n)},i.prototype.getCurrentVisual=function(){return this.core.getCurrentVisual()},i.prototype.convertVisualClicked=function(){this.core.convertVisualClicked()},i.prototype.dismissBanner=function(){this.settingsService.setShowQnaVisualBanner(!1),this.showLegacyBanner=!1},i.prototype.performBannerMainAction=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,P.__generator)(this,function(t){switch(t.label){case 0:return S.fF.assert(function(){return n.showLegacyBanner},"This should only be called when showBanner is true"),[4,this.showTooling("VisualBanner","bulkEditing")];case 1:return t.sent(),[2]}})})},Object.defineProperty(i.prototype,"inputPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.inputBox},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"suggestionsPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.suggestions},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"displayedRestatement",{get:function(){if("Ready"!==this.viewModel.state)return null;var t=this.viewModel.result;return t?(0,M.mn)(t)||(0,M.fU)(t)||(0,M.lP)(t)?t.restatement:void 0:null},enumerable:!1,configurable:!0}),i.prototype.showTooling=function(n,t){return(0,P.__awaiter)(this,void 0,void 0,function(){var o,r,a=this;return(0,P.__generator)(this,function(s){switch(s.label){case 0:return S.fF.assert(function(){return a.allowTooling},"this should be called only when this.allowTooling is true"),this.allowTooling?(o=this.dataSources.get(),r=this.explorationNavigation.getCurrentExploration(),[4,this.qnaToolingDialogLauncher.showToolingDialog({dataSources:o,exploration:r,entryPoint:n,entryContentType:t,entryQuestion:this.core.getCurrentUtteranceTrimmed()})]):[2];case 1:return s.sent(),[2]}})})},i.prototype.interpretSuggestedQuestion=function(n){this.core.interpretSuggestedQuestion(n)},i.prototype.toggleShowAllSuggestions=function(){this.core.toggleShowAllSuggestions()},i.prototype.showQnaVisualErrorDetails=function(){this.core.showQnaVisualErrorDetails()},i.prototype.showResultErrorDetails=function(){this.core.showResultErrorDetails()},i.prototype.launchFeedbackDialog=function(n,t){this.core.launchFeedbackDialog(n,t)},i.prototype.shouldShowBanner=function(){var n=this;return S.fF.assert(function(){return null!=n.allowTooling},"this.allowTooling value should already been set to be true or false"),this.allowTooling&&this.settingsService.getShowQnaVisualBanner()},i.prototype.updateBannerMainMessageTooltipConfig=function(){if(this.bannerMainMessageTextContainerElementRef){var n=this.bannerMainMessageTextContainerElementRef.nativeElement,t=n&&n.offsetWidth<n.scrollWidth;!this.bannerMainMessage!=!t&&(this.bannerMainMessage=t?n.textContent:null)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(le.D),e.\u0275\u0275directiveInject(Ie.z),e.\u0275\u0275directiveInject(ge.vZ),e.\u0275\u0275directiveInject(no.H),e.\u0275\u0275directiveInject(to.kc),e.\u0275\u0275directiveInject(U.y0),e.\u0275\u0275directiveInject(E.D),e.\u0275\u0275directiveInject(Gt.g),e.\u0275\u0275directiveInject(li.g),e.\u0275\u0275directiveInject(Yn.b,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-host"]],viewQuery:function(t,o){if(1&t&&(e.\u0275\u0275viewQuery(yn,5),e.\u0275\u0275viewQuery(Mi,5,e.ElementRef),e.\u0275\u0275viewQuery(xi,7,e.ElementRef)),2&t){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.inputComponent=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o._bannerMessageElementRef=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.contentContainerElement=r.first)}},inputs:{models:"models",config:"config",hostServices:"hostServices",entryPoint:"entryPoint"},outputs:{inputBoxFocused:"inputBoxFocused",utteranceUpdated:"utteranceUpdated",convertVisual:"convertVisual"},features:[e.\u0275\u0275ProvidersFeature([Y.y,T.Q,eo.Z,E.D])],decls:9,vars:11,consts:[[1,"qnaVisual",3,"ngSwitch"],["class","loadingContainer",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","glyphicon icon glyph-small pbi-glyph-info restatementIcon","tabindex","0",3,"ngStyle","pbiTooltip",4,"ngIf"],[1,"content",3,"ngClass"],["contentContainer",""],[3,"ngSwitch",4,"ngIf"],["class","footer",4,"ngIf"],[1,"loadingContainer"],[1,"loading"],["size","large",3,"delay"],["localize","Qna_InitialLoading"],[3,"errorInfo","viewport","showErrorDetails"],[4,"ngIf","ngIfElse"],["legacyBanner",""],[1,"header",3,"ngClass"],["drag-resize-disabled","true","tabindex","-1",1,"inputBox",3,"entryPoint","qnaSupportedScopes","interpretListener","presentationArgs","configs","initialUtterance","initialUtteranceFromSaved","inputBoxFocused"],["class","glyphicon icon glyph-small pbi-glyph-dependencyadd qnaAction","role","button",3,"ngClass","pbiTooltip","localizeAttr","ngStyle","accessible-click",4,"ngIf"],["class","glyphicon icon glyph-small pbi-glyph-settings qnaAction","role","button",3,"pbiTooltip","localizeAttr","ngStyle","accessible-click",4,"ngIf"],[4,"ngIf"],[3,"bannerContent","onDismiss"],["class","banner",4,"ngIf"],[1,"banner"],[1,"glyphicon","glyph-small","pbi-glyph-info"],[1,"mainMessage",3,"pbiTooltip","localize"],["bannerMainMessageTextContainer",""],["mat-button","",1,"mainAction",3,"localize","accessible-click"],["mat-button","",1,"dismiss","glyphicon","pbi-glyph-close","glyph-mini",3,"pbiTooltip","localizeAttr","accessible-click"],["role","button",1,"glyphicon","icon","glyph-small","pbi-glyph-dependencyadd","qnaAction",3,"ngClass","pbiTooltip","localizeAttr","ngStyle","accessible-click"],["role","button",1,"glyphicon","icon","glyph-small","pbi-glyph-settings","qnaAction",3,"pbiTooltip","localizeAttr","ngStyle","accessible-click"],["tabindex","0",1,"glyphicon","icon","glyph-small","pbi-glyph-info","restatementIcon",3,"ngStyle","pbiTooltip"],[3,"ngSwitch"],["class","suggestionsContainer",4,"ngSwitchCase"],["class","visualResultContainer",4,"ngSwitchCase"],["class","doNotUnderstandContainer",4,"ngSwitchCase"],["class","resultErrorContainer",4,"ngSwitchCase"],["errorOverlayTemplate",""],[1,"suggestionsContainer"],["class","suggestions",4,"ngIf"],["class","suggestionsWarning",3,"ngStyle",4,"ngIf"],[1,"suggestions"],["localize","Visual_Qna_SuggestionsHeader",1,"suggestionTitle",3,"ngStyle"],["data-testid","qna-suggestions",1,"suggestionsList"],["class","suggestion themeableElement","tabindex","0","role","button","data-testid","qna-suggestion",3,"ngStyle","accessible-click",4,"ngFor","ngForOf"],["tabindex","0","role","button","data-testid","qna-show-all-suggestions-btn",1,"showAllToggle",3,"localize","localizeAttr","accessible-click"],["tabindex","0","role","button","data-testid","qna-suggestion",1,"suggestion","themeableElement",3,"ngStyle","accessible-click"],[1,"suggestionsWarning",3,"ngStyle"],[1,"visualResultContainer"],["class","singleVisualHostContainer",4,"ngIf"],[1,"singleVisualHostContainer"],["class","loadingSpinner","size","small",3,"delay",4,"ngIf"],["tabindex","0","focus-nav-mode","Hierarchy","data-testid","qna-visual",3,"visual","visualViewport","themeCollection","config"],["size","small",1,"loadingSpinner",3,"delay"],[1,"doNotUnderstandContainer"],[1,"showDoNotUnderstandMessage",3,"ngStyle"],[1,"message"],["class","tellUsMore","href","javascript:void(0);",3,"accessible-click",4,"ngIf"],["href","javascript:void(0);",1,"tellUsMore",3,"accessible-click"],["localize","Qna_Feedback_TellUsMore"],[1,"resultErrorContainer"],[4,"ngTemplateOutlet"],[1,"footer"],["class","feedback",4,"ngIf"],["class","disclaimer",4,"ngIf"],[1,"feedback"],[3,"fontColor"],[1,"disclaimer"],["localize","Copilot_Disclaimer_Short"],["href","https://go.microsoft.com/fwlink/?linkid=2243166","localize","CopilotInline_PreviewLink","target","_blank",1,"pbi-external-link","fluentTheme-sm-reg"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Ei,4,1,"div",1),e.\u0275\u0275template(2,bi,2,2,"div",2),e.\u0275\u0275template(3,ki,9,16,"ng-container",2),e.\u0275\u0275template(4,Ni,1,5,"i",3),e.\u0275\u0275elementStart(5,"div",4,5),e.\u0275\u0275template(7,sr,8,6,"ng-container",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,cr,4,4,"div",7),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("ngSwitch",o.viewModel.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Loading"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Error"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Ready"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.displayedRestatement),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(8,dr,"Ready"===o.viewModel.state,o.viewModel.result&&"Suggestions"===o.viewModel.result.type)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.viewModel.result),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Ready"===o.viewModel.state))},dependencies:[f.NgClass,f.NgForOf,f.NgIf,f.NgTemplateOutlet,f.NgStyle,f.NgSwitch,f.NgSwitchCase,ot.X,Be.b,ui.O,oo.f,ci.v,it.t,di.V,yn,Un,Rn,f.AsyncPipe,Ii.F],styles:['.qnaVisual[_ngcontent-%COMP%]{font-size:12px;height:100%;display:flex;flex-direction:column}  html[data-focus-source=key] .qnaVisual:focus,   html[data-focus-source=key] .qnaVisual *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}  html[data-focus-source=mouse] .qnaVisual:focus,   html[data-focus-source=mouse] .qnaVisual *:focus,   html[data-focus-source=program] .qnaVisual:focus,   html[data-focus-source=program] .qnaVisual *:focus{outline:none}.qnaVisual[_ngcontent-%COMP%]     .powerbi-spinner{position:unset!important;margin-right:12px}.qnaVisual[_ngcontent-%COMP%]   .pbi-glyph-info[_ngcontent-%COMP%]:before{content:"\\e946"!important}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;text-align:center;margin:12px}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:var(--gray-20, #F3F2F1);padding:0 12px;margin:8px 4px 4px;color:var(--gray-160, #323130);align-items:center}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin:8px 0}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .mainMessage[_ngcontent-%COMP%]{margin:4px 8px;flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .mainAction[_ngcontent-%COMP%]{margin:0;padding:2px 20px;background:var(--white-color, #FFF);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);border:1px solid var(--gray-110, #8A8886);box-sizing:border-box;border-radius:2px;height:fit-content}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{padding:0}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{margin:0 0 0 12px}html[dir="rtl"][_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{margin:0 12px 0 0}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:row;min-height:44px;position:relative;margin-top:16px}.qnaVisual[_ngcontent-%COMP%]   .header.hasBanner[_ngcontent-%COMP%]{margin-top:0}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .inputBox[_ngcontent-%COMP%]{flex:1;margin:4px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction[_ngcontent-%COMP%]{margin:12px 4px 0;cursor:pointer;height:16px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction.disabled[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertiary-color, #A19F9D)!important;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .restatementIcon[_ngcontent-%COMP%]{align-self:flex-end;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:4px;flex:0}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionTitle[_ngcontent-%COMP%]{margin:1px 1px 12px 4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]{padding:0 4px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));grid-template-rows:repeat(auto-fit,minmax(32px,1fr))}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]   .suggestion[_ngcontent-%COMP%]{font-size:14px;padding:12px 20px;border-radius:2px;box-shadow:var(--fluent-shadow-depth4, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey));border:1px solid transparent;box-sizing:border-box;cursor:pointer;margin:0 12px 12px 0}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .showAllToggle[_ngcontent-%COMP%]{font-size:14px;color:var(--fluent-theme-link-color, #0078D4);margin:12px 4px;cursor:pointer;align-self:flex-end}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]{position:relative;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]{position:relative;display:block;height:100%;background-color:transparent}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]     .visual{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-right:4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .showDoNotUnderstandMessage[_ngcontent-%COMP%], .qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestionsWarning[_ngcontent-%COMP%]{display:flex;text-align:center;align-items:center;font-size:14px;max-width:450px;padding:20px;width:100%;box-sizing:border-box}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]{height:100%;position:relative;background-color:var(--neutral-lighter-color, #F4F4F4);display:flex;flex-direction:column;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   canvas-visual-error-overlay[_ngcontent-%COMP%]{position:relative;height:auto}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   .tellUsMore[_ngcontent-%COMP%]{text-align:center;font-size:14px}.qnaVisual[_ngcontent-%COMP%]   .content.contentReady[_ngcontent-%COMP%]{flex:1;overflow:hidden}.qnaVisual[_ngcontent-%COMP%]   .content.suggestionContent[_ngcontent-%COMP%]{overflow-y:auto}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]{flex:0;padding-top:2px}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   qna-feedback[_ngcontent-%COMP%]{float:right}']}),i}(),gr=l(97999),hr=l(8898),fr=l(14463),sn=l(8590),ao=l(3579),so=l(60661),mr=l(91615),vr=l(2142),Cr=l(32640),_r=l(82755),lo=l(5265),yr=l(99917),Sr=l(4541),Pr=l(69838),Ir=l(64546),Pn=l(74857),uo=l(91592),Mr=l(11494),co=l(48145),xr=l(94717),Er=l(39631),br=l(66890),wr=l(81213),Or=l(29866),Tr=l(72262),Dr=l(28107),Br=l(67660),Fr=l(35756),Ar=["qnaVisual"],Vr=function(){return{"aria-label":"Qna_MessageDialog_EnableQnaButtonText"}};function Ur(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("accessible-click",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(r.enableQna())}),e.\u0275\u0275elementEnd()}2&i&&e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(2,Vr))("localize","Qna_MessageDialog_EnableQnaButtonText")}function Lr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275element(1,"div",8),e.\u0275\u0275elementStart(2,"span",9),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Ur,1,3,"button",10),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",t.disallowQnaDetails.notEnabledDetails.message),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.disallowQnaDetails.notEnabledDetails.message),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.disallowQnaDetails.notEnabledDetails.canEnable)}}function Rr(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"canvas-visual-error-overlay",12),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.showVisualErrorDetails())}),e.\u0275\u0275elementEnd()}if(2&i){var o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("errorInfo",o.disallowQnaDetails.otherReasonErrorDetails)("viewport",o.currentViewport)}}function Qr(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Lr,5,3,"div",5),e.\u0275\u0275template(2,Rr,1,2,"canvas-visual-error-overlay",6),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","qnaNotEnabled"===t.disallowQnaDetails.reason),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","qnaNotEnabled"!==t.disallowQnaDetails.reason)}}function kr(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Qr,3,2,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(),o=e.\u0275\u0275reference(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.disallowQna)("ngIfElse",o)}}function zr(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"qna-host",14,15),e.\u0275\u0275listener("utteranceUpdated",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.utteranceUpdated(a))})("convertVisual",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.convertVisual(a))})("inputBoxFocused",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onInputBoxFocused(a))}),e.\u0275\u0275elementEnd()()}if(2&i){var o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("config",o.config)("models",o.models)("hostServices",o.hostServices)("entryPoint",o.entryPoint)}}var Nr=function(n,t){return{hasDisallowQnaContent:n,customPadding:t}},po="hiddenProperties",go="savedUtterance",ho=function(){function i(n,t,o,r,a,s,u,h,d,g,v,w,N,H,_e,et,_t,Xt,la,ua,ca,da){var qn=this;this.changeDetectorRef=n,this.conceptualSchemaProxy=t,this.dataSources=o,this.errorService=r,this.eventBridge=a,this.explorationCapabilitiesService=s,this.explorationNavigation=u,this.filterGenerator=h,this.lazyProvider=d,this.localizationService=g,this.pauseQueriesService=v,this.visualPlugin=w,this.featureSwitchService=N,this.selection=H,this.telemetryService=_e,this.themeService=et,this.viewModeState=_t,this.visualAuthoring=Xt,this.visualAuthoringCustomizeOperations=la,this.promiseFactory=ua,this.qnaProxyPath=da,this.visualReady=new e.EventEmitter,this.inputBoxFocused=new e.EventEmitter,this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(sn.CCe,function(){return(0,P.__awaiter)(qn,void 0,void 0,function(){return(0,P.__generator)(this,function(So){switch(So.label){case 0:return[4,this.onModelChanged()];case 1:return So.sent(),[2]}})})}),this.subscriptions=new gr.g4(ca),this.isReportPausedSubscription=this.pauseQueriesService.isReportPaused$().subscribe(function(){qn.visualContainer&&qn.reInitializeComponent()})}return i.prototype.ngOnInit=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){return(0,P.__generator)(this,function(n){return this.reInitializeComponent(),[2]})})},i.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.subscriptions.unsubscribeAll(),this.settingsChangedSubscription&&this.settingsChangedSubscription.unsubscribe(),this.isReportPausedSubscription&&this.isReportPausedSubscription.unsubscribe(),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(this.visualContainer)&&this.visualAuthoringCustomizeOperations.removeCustomizeFrom(this.visualContainer)},i.prototype.ngDoCheck=function(){var n=this.visualDefinition.viewport;(!this.currentViewport||n.height!==this.currentViewport.height||n.width!==this.currentViewport.width||n.scale!==this.currentViewport.scale)&&(this.currentViewport={width:n.width,height:n.height,scale:n.scale},this.setNewViewport(n),this.qnaHost&&!this.disallowQna&&this.qnaHost.update({type:Lt.EP.Resize,viewport:this.currentViewport}))},i.prototype.init=function(n){var t=this,o=this.extractObjects(this.visualContainer),r=(0,_r.NA)(o,{objectName:po,propertyName:go},"");this.config={canEdit:this.getCanEdit(),canShowPods:!1,canShowVisuals:!0,canShowDidYouMean:!0,initialUtterance:r,initialUtteranceFromSaved:!_.isEmpty(r)};var a=_.find(this.dataSources.get(),function(s){return s.type===vr.nKy});this.models=[{vsName:a.dsr.vsName,dbName:a.dsr.dbName,qnaSupported:!0,id:a.id}],this.entryPoint="Visual",this.hostServices=n.host,this.isLoading=!1,this.setNewViewport(n.viewport),this.changeDetectorRef.detectChanges(),this.onVisualContainerUpdate(!0),this.visualAuthoringCustomizeOperations.registerCustomizeFrom(this.visualContainer,function(s){return t.customizeConvertFrom(s)})},i.prototype.update=function(n){!(0,oe.yE)(n.type,Lt.EP.Resize)||!this.qnaHost||(this.setNewViewport(n.viewport),this.qnaHost.update({type:Lt.EP.Resize,viewport:n.viewport}))},i.prototype.onViewModeChanged=function(n){this.config.canEdit=this.getCanEdit()},i.prototype.enumerateObjectInstances=function(n){if(this.qnaHost)return this.qnaHost.enumerateObjectInstances(n)},i.prototype.getFormattingModel=function(){if(this.qnaHost)return this.qnaHost.getFormattingModel()},Object.defineProperty(i.prototype,"supportsCustomPadding",{get:function(){var t;return null===(t=this.featureSwitchService)||void 0===t?void 0:t.featureSwitches.vcPadding},enumerable:!1,configurable:!0}),i.prototype.focus=function(){if(this.qnaHost)return this.qnaHost.focus()},i.prototype.utteranceUpdated=function(n){var t;if(null!=n){var o={merge:[{objectName:po,selector:void 0,properties:(t={},t[go]=n,t)}]};this.hostServices.persistProperties(o,!0)}},i.prototype.convertVisual=function(n){return(0,P.__awaiter)(this,void 0,void 0,function(){var t,r,a=this;return(0,P.__generator)(this,function(s){switch(s.label){case 0:return t=(0,ao.s)(n),[4,this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),t,void 0)];case 1:return s.sent()&&(r=this.selection.getSelectedElements().find(function(u){return u.canvasItem.name===a.visualContainer.name}))&&this.eventBridge.publishToChannel(sn.MEZ,{affectContainer:function(h){return h===r.canvasItem},preventScroll:!0}),[2]}})})},i.prototype.onInputBoxFocused=function(n){this.inputBoxFocused.emit(n)},i.prototype.customizeConvertFrom=function(n){S.fF.assertValue(n,"visualContainer");var t=this.qnaHost&&this.qnaHost.getCurrentVisual();t&&(n.config.singleVisual.query=t.config.singleVisual.query,n.config.singleVisual.visualType=t.config.singleVisual.visualType,n.config.singleVisual.objects=(0,P.__assign)((0,P.__assign)({},n.config.singleVisual.objects||{}),t.config.singleVisual.objects||{}),n.filters=t.filters,n.config.singleVisual.conversionSourceContext=void 0)},i.prototype.enableQna=function(){var n=this;S.fF.assert(function(){var t,o;return n.disallowQna&&(null===(o=null===(t=n.disallowQnaDetails)||void 0===t?void 0:t.notEnabledDetails)||void 0===o?void 0:o.canEnable)},"Expect this is called only when this.disallowQna && this.disallowQnaDetails.becauseNotEnabledDetails.canEnable is true"),this.qnaSupportabilityService.enableQna()},i.prototype.showVisualErrorDetails=function(){var n=this;S.fF.assert(function(){var t;return n.disallowQna&&!(null===(t=n.disallowQnaDetails)||void 0===t||!t.otherReasonErrorDetails)},"Expect this to be called only when this.disallowQna && this.disallowQnaDetails.becauseOtherReasonErrorDetails is defined"),(0,Pn.aZ)(this.disallowQnaDetails.otherReasonErrorDetails,this.errorService,this.localizationService)},i.prototype.reInitializeComponent=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,t,o,r=this;return(0,P.__generator)(this,function(a){switch(a.label){case 0:return this.isLoading=!0,this.visualContainer.filters=void 0,[4,this.ensureQnaSupportabilityService()];case 1:return a.sent(),this.settingsChangedSubscription||(this.settingsChangedSubscription=this.qnaSupportabilityService.qnaSettingsChanged$.subscribe(function(){return r.reInitializeComponent()})),[4,this.checkIsQnaAllowed()];case 2:return a.sent(),this.disallowQna?(this.isLoading=!1,[2]):(this.wasQnaAllowedBefore?this.visualDefinition.visual.destroy():(this.currentViewport=this.visualDefinition.viewport,n=this.visualPlugin.getPlugin(this.visualDefinition.type),this.visualDefinition.visual=(0,Ir.nm)(n,n.create,this.promiseFactory,this.telemetryService,{createQnaVisual:function(){return r}}),this.subscriptionManager.subscribe(sn.jCS,function(s,u){u&&u.affectContainer(r.visualContainer)&&r.onVisualContainerUpdate()}).subscribe(mr.kx,function(){return(0,P.__awaiter)(r,void 0,void 0,function(){return(0,P.__generator)(this,function(s){switch(s.label){case 0:return[4,this.onVisualContainerUpdate()];case 1:return[2,s.sent()]}})})}).subscribe(sn.Tuj,function(){return(0,P.__awaiter)(r,void 0,void 0,function(){return(0,P.__generator)(this,function(s){switch(s.label){case 0:return[4,this.onVisualContainerUpdate()];case 1:return[2,s.sent()]}})})}),this.subscriptions.subscribe("LuciaDomainModelChangedEvent",function(){return r.onVisualContainerUpdate()})),this.wasQnaAllowedBefore=!0,t=(0,Pn.Su)(this.explorationNavigation,this.featureSwitchService),o={element:{empty:function(){},get:function(){}},host:this.visualDefinition.hostServices,visualAdapterHostServices:this.visualDefinition.visualAdapterHostServices,style:this.themeService&&this.themeService.getVisualStyle(t),viewport:this.visualDefinition.viewport,animation:{transitionImmediate:!1},featureSwitches:(0,P.__assign)({},this.featureSwitchService.featureSwitches)},[2,this.visualDefinition.visual.init(o)])}})})},i.prototype.getCanEdit=function(){return 0!==this.viewModeState.getMode()},i.prototype.onModelChanged=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){return(0,P.__generator)(this,function(n){switch(n.label){case 0:return[4,this.reInitializeComponent()];case 1:return n.sent(),[2]}})})},i.prototype.checkIsQnaAllowed=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,o,r;return(0,P.__generator)(this,function(a){switch(a.label){case 0:if(this.pauseQueriesService.isReportPaused())return this.disallowQna=!0,this.disallowQnaDetails={reason:"qnaNotSupported",otherReasonErrorDetails:Gr(this.localizationService)},[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 2:return n=a.sent(),[3,4];case 3:return a.sent(),[2];case 4:if(o=this.explorationCapabilitiesService.getCapabilities(),r=(0,uo.H)(o,n,this.qnaSupportabilityService),this.disallowQna=!r.isAllowed,r.isAllowed)return[2];switch(r.disallowedReason){case"featureDisabledInIE":this.disallowQnaDetails={reason:"featureDisabledInIE",otherReasonErrorDetails:(0,Pn.ET)(this.localizationService)};break;case"featureDisabledInApp":S.fF.assertFail("Expect the code of generating a qna visual never be called if app doesn't allow qna feature");break;case"noModel":this.disallowQnaDetails={reason:"noModel",otherReasonErrorDetails:qr(this.localizationService)};break;case"qnaNotSupported":this.disallowQnaDetails={reason:"qnaNotSupported",otherReasonErrorDetails:Wr(this.localizationService)};break;case"qnaNotEnabled":this.disallowQnaDetails={reason:"qnaNotEnabled",notEnabledDetails:{message:this.qnaSupportabilityService.modelHasQnaDisabledMessage,canEnable:this.qnaSupportabilityService.canAnyUserEnableQna()}};break;default:S.fF.assertNever(r.disallowedReason)}return[2]}})})},i.prototype.onVisualContainerUpdate=function(n){return void 0===n&&(n=!1),(0,P.__awaiter)(this,void 0,void 0,function(){var t,o,r,a,s=this;return(0,P.__generator)(this,function(u){switch(u.label){case 0:return this.isLoading?[2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return t=u.sent(),o=this.filterGenerator.calculateVisualContainerFilter(this.explorationNavigation.getCurrentExploration(),this.explorationNavigation.getCurrentSection(),this.visualContainer,t),r=this.extractObjects(this.visualContainer),a=Lt.EP.Style|Lt.EP.Data,n&&(a|=Lt.EP.Resize),this.qnaHost&&(this.qnaHost.update({type:a,filters:o,objects:r,firstUpdate:n,viewport:this.currentViewport}),this.visualAuthoringCustomizeOperations.registerCustomizeFrom(this.visualContainer,function(h){return s.customizeConvertFrom(h)})),this.eventBridge.publishToChannel(sn.D1A,this.visualContainer),this.visualReady.emit(),[2]}})})},i.prototype.extractObjects=function(n){var t=(0,so.GQ)(n);t||(t={}),t=(0,lo.d9)(t);var o=(0,Pn.Su)(this.explorationNavigation,this.featureSwitchService),r=this.themeService.getVisualObjects(o,(0,ao.s)(n),void 0,Cr.OF.objects,!1);(0,lo.l7)(t,r);var a=[];for(var s in t)a.push({name:s,properties:t[s][0].properties});var u=(0,so.cj)(n,this.visualPlugin),h=u?.objects;if(h){var d=this.themeService.getVisualStyle(o),g=(0,Pr.X)(),v=new Sr.Q(this.featureSwitchService.featureSwitches,d);return(0,yr.PJ)(v,g,h,a)}},i.prototype.setNewViewport=function(n){var t=this.qnaVisualElement.nativeElement;$(t).height(n.height),$(t).width(n.width)},i.prototype.ensureQnaSupportabilityService=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n;return(0,P.__generator)(this,function(t){switch(t.label){case 0:return this.qnaSupportabilityService?[2]:(n=this,[4,this.lazyProvider.get(this.qnaProxyPath||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaSupportabilityService")]);case 1:return n.qnaSupportabilityService=t.sent(),[2]}})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(re.i),e.\u0275\u0275directiveInject(le.D),e.\u0275\u0275directiveInject(wr.T),e.\u0275\u0275directiveInject(Mr.J),e.\u0275\u0275directiveInject(co.U),e.\u0275\u0275directiveInject(Ie.z),e.\u0275\u0275directiveInject(xr.r),e.\u0275\u0275directiveInject(R.E),e.\u0275\u0275directiveInject(It.o),e.\u0275\u0275directiveInject(Er.F),e.\u0275\u0275directiveInject(Or.D),e.\u0275\u0275directiveInject(ge.vZ),e.\u0275\u0275directiveInject(Tr.z),e.\u0275\u0275directiveInject(U.y0),e.\u0275\u0275directiveInject(Br.f),e.\u0275\u0275directiveInject(to.kc),e.\u0275\u0275directiveInject(br.$8),e.\u0275\u0275directiveInject(Dr.Q),e.\u0275\u0275directiveInject(fr.t),e.\u0275\u0275directiveInject(hr.x,8),e.\u0275\u0275directiveInject(wt.n,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-visual-host"]],viewQuery:function(t,o){if(1&t&&(e.\u0275\u0275viewQuery(Ar,7,e.ElementRef),e.\u0275\u0275viewQuery(Z.Pl,7),e.\u0275\u0275viewQuery(Qn,5)),2&t){var r=void 0;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.qnaVisualElement=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.portalOutlet=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(o.qnaHost=r.first)}},inputs:{visualDefinition:"visualDefinition",visualContainer:"visualContainer"},outputs:{visualReady:"visualReady",inputBoxFocused:"inputBoxFocused"},decls:5,vars:6,consts:[["keyboard-shortcuts","ctrl-ArrowRight scoped",1,"visual","visual-qnaVisual",3,"ngClass"],["qnaVisual",""],[4,"ngIf"],["showQna",""],[4,"ngIf","ngIfElse"],["class","qnaNotEnabledContainer",4,"ngIf"],[3,"errorInfo","viewport","showErrorDetails",4,"ngIf"],[1,"qnaNotEnabledContainer"],[1,"glyphicon","pbi-glyph-blocked2","glyph-med"],["tabindex","0",1,"message"],["class","btn primary",3,"localizeAttr","localize","accessible-click",4,"ngIf"],[1,"btn","primary",3,"localizeAttr","localize","accessible-click"],[3,"errorInfo","viewport","showErrorDetails"],[1,"qnaVisualContent"],[3,"config","models","hostServices","entryPoint","utteranceUpdated","convertVisual","inputBoxFocused"],["qnaHost",""]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275template(2,kr,2,2,"ng-container",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,zr,3,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(3,Nr,o.disallowQna,o.supportsCustomPadding)),e.\u0275\u0275attribute("focus-nav-mode","Group"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!o.isLoading))},dependencies:[f.NgClass,f.NgIf,ot.X,Be.b,oo.f,it.t,Fr.q,Qn],styles:[".visual-qnaVisual.hasDisallowQnaContent[_ngcontent-%COMP%]{width:100%!important;height:100%!important}  html[data-focus-source=key] .visual-qnaVisual:focus,   html[data-focus-source=key] .visual-qnaVisual *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}  html[data-focus-source=mouse] .visual-qnaVisual:focus,   html[data-focus-source=mouse] .visual-qnaVisual *:focus,   html[data-focus-source=program] .visual-qnaVisual:focus,   html[data-focus-source=program] .visual-qnaVisual *:focus{outline:none}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;box-sizing:border-box;padding:20px;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);font-size:14px;text-align:center}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-top:12px;max-width:300px}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:12px}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaVisualContent[_ngcontent-%COMP%]{height:100%}"]}),i}();function qr(i){return{code:"qnaNotAllowedWithoutModel",fixableError:0,hideSeeDetails:!0,details:{message:i.get("Qna_NotAllowedForReport_WithoutModel"),displayableErrorInfo:void 0},source:"User"}}function Wr(i){var o=[{errorInfoKey:i.get("VisualContainer_QnaVisual_NotSupportedTitle"),errorInfoValue:i.get("VisualContainer_QnaVisual_NotSupportedMessage")}];return{code:"qnaNotSupported",fixableError:0,hideSeeDetails:!1,details:{message:i.get("Qna_NotAllowedForReport_QnaNotSupported"),displayableErrorInfo:o},source:"User"}}function Gr(i){return{code:"qnaNotSupported",fixableError:0,hideSeeDetails:!0,details:{message:i.get("Qna_NotAllowedForReport_Paused"),displayableErrorInfo:void 0},source:"User"}}var fo=l(67489),Hr=l(96777),mo=function(){function i(n){this.templateDialogPayload=n}return i.prototype.ngOnInit=function(){var n,t=(n=this.templateDialogPayload.input).errorCode,o=n.errorMessage;S.fF.assertValue(t,"diagnostic dialog error code"),this.diagnosticMessage=(0,Ln.g)(o)?t:"".concat(t," ").concat(o)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(fo.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["qna-diagnostic-dialog"]],features:[e.\u0275\u0275ProvidersFeature([fo.x])],decls:3,vars:1,consts:[[2,"min-width","400px"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"p",0),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.diagnosticMessage))},dependencies:[Hr.J],encapsulation:2,changeDetection:0}),i}(),$r=l(92060),jr=l(96278),kn=l(14714),Kr=l(68082),zn=l(65966),Zr=l(58938),Rt=l(34100),In=l(55461),Qt=l(10693),ln=l(87413),Jr=function(i){function n(t,o,r,a,s,u,h){var d=i.call(this,h)||this;return d.featureSwitchService=t,d.conceptualSchemaProxy=o,d.dataModelService=r,d.dataSourcesService=a,d.explorationCapabilitiesService=s,d.qnaSupportabilityService=u,d}return(0,P.__extends)(n,i),n.prototype.execute=function(){var t;return(0,P.__awaiter)(this,void 0,void 0,function(){var r,a,s;return(0,P.__generator)(this,function(u){switch(u.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return u.sent().qnaCopilotPhrasings?[4,this.dataModelService.getLinguisticSchema()]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 2:return r=u.sent(),[4,(0,Rt.NP)(this.conceptualSchemaProxy,this.dataSourcesService,this.explorationCapabilitiesService,this.qnaSupportabilityService,r)];case 3:return u.sent()?(a=new In.X(r),s=(0,ln.TD)("oaiPhrasings",a),_.includes(s,"PowerBI.AzureOpenAIPhrasings")&&this.doneOAISynonyms(a)&&this.hasAuthoredTerm(a)?(null===(t=this.next)||void 0===t||t.execute(s),[2,this.getDeferredPromise()]):(this.signalCompletion(),[2,this.getDeferredPromise()])):(this.signalCompletion(),[2,this.getDeferredPromise()])}})})},n.prototype.doneOAISynonyms=function(t){var o=(0,ln.TD)("externalSynonyms",t);return!_.includes(o,"PowerBI.AzureOpenAISynonyms")},n.prototype.hasAuthoredTerm=function(t){var o=t.getEntities();return _.some(o,function(r){return _.some(r.terms,function(a){return a.isAuthored})})},n}(Qt.R),Xr=function(i){function n(t,o,r,a,s,u){var h=i.call(this,u)||this;return h.conceptualSchemaProxy=t,h.dataModelService=o,h.dataSourcesService=r,h.explorationCapabilitiesService=a,h.qnaSupportabilityService=s,h}return(0,P.__extends)(n,i),n.prototype.execute=function(){var t;return(0,P.__awaiter)(this,void 0,void 0,function(){var o,r,a;return(0,P.__generator)(this,function(s){switch(s.label){case 0:return[4,this.dataModelService.getLinguisticSchema()];case 1:return o=s.sent(),[4,(0,Rt.NP)(this.conceptualSchemaProxy,this.dataSourcesService,this.explorationCapabilitiesService,this.qnaSupportabilityService,o)];case 2:return s.sent()?(r=new In.X(o),a=(0,ln.TD)("externalSynonyms",r),_.isEmpty(a)?this.signalCompletion():null===(t=this.next)||void 0===t||t.execute(a),[2,this.getDeferredPromise()]):(this.signalCompletion(),[2,this.getDeferredPromise()])}})})},n}(Qt.R),Ne=l(40978),vo=function(i){function n(t,o,r,a,s,u,h,d,g){var v=i.call(this,g)||this;return v.accountService=t,v.dataSourcesService=o,v.explorationNavigationService=r,v.qnaBannerService=a,v.qnaToolingLauncher=s,v.localizationService=u,v.improveLsdlBackgroundTelemetry=h,v.target=d,v}return(0,P.__extends)(n,i),n.prototype.execute=function(t){var o;return(0,P.__awaiter)(this,void 0,void 0,function(){var a,s,u,h,d,g,v=this;return(0,P.__generator)(this,function(w){switch(w.label){case 0:return[4,this.accountService.isSignedInAsync()];case 1:return w.sent()?(this.clearBannerContent(),null===(o=this.next)||void 0===o||o.execute(t),[2,this.getDeferredPromise()]):(a=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_LoginMessage":"Qna_ImproveLsdl_Phrasings_LoginMessage"),s={emphasis:this.localizationService.get("Qna_ImproveLsdl_Login"),text:a},u=this.localizationService.get("SignInButton"),h=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_AddYourOwnButton":"Qna_ImproveLsdl_Phrasings_AddYourOwnButton"),d=function(H){v.improveLsdlBackgroundTelemetry.logSigninEvent({surface:H,type:v.target,action:"Login"}),v.accountService.trySignInAsync()},this.qnaBannerService.setContent(((g={}).Visual={showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"},{id:"launchTooling",text:h,actionAppearance:"secondary"}]}],actionHandlers:new Map([["login",function(){return d("Visual")}],["launchTooling",function(){v.improveLsdlBackgroundTelemetry.logSigninEvent({surface:"Visual",type:v.target,action:"AddYourOwn"}),v.qnaToolingLauncher.showToolingDialog({dataSources:v.dataSourcesService.get(),exploration:v.explorationNavigationService.getCurrentExploration(),entryPoint:"VisualBanner",entryContentType:"Synonyms"===v.target?"bulkEditing":"managePhrasings"})}]])},g.ToolingHome={showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"},{id:"Synonyms"===this.target?"switchToSynonymsPage":"switchToPhrasingsPage",text:h,actionAppearance:"secondary"}]}],actionHandlers:new Map([["login",function(){return d("ToolingHome")}],["switchToSynonymsPage",void 0],["switchToPhrasingsPage",void 0]])},g.ToolingSynonyms="Synonyms"===this.target?{showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"}]}],actionHandlers:new Map([["login",function(){return d("ToolingSynonyms")}]])}:Ne.me,g.ToolingPhrasings="Phrasings"===this.target?{showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"}]}],actionHandlers:new Map([["login",function(){return d("ToolingPhrasings")}]])}:Ne.me,g)),[2,this.getDeferredPromise()])}})})},n.prototype.clearBannerContent=function(){var t;this.qnaBannerService.setContent(((t={}).Visual=Ne.me,t.ToolingHome=Ne.me,t.ToolingSynonyms=Ne.me,t.ToolingPhrasings=Ne.me,t))},n}(Qt.R),Yr=l(53439),Jt=l(94759),Nn=l(67412),Mn=l(85726),ea=function(i){function n(t,o,r,a,s){var u=i.call(this,s)||this;return u.copilotRequirementsService=t,u.localizationService=o,u.modelAuthoringService=r,u.qnaBannerService=a,u}return(0,P.__extends)(n,i),n.prototype.execute=function(t){return(0,P.__awaiter)(this,void 0,void 0,function(){var o,a,s=this;return(0,P.__generator)(this,function(u){return o="pickWorkspace",this.qnaBannerService.setContent(((a={}).Visual={showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:{text:s.localizationService.get("Qna_Enhance_WithCopilot_FromSelectWorkspace_Disclaminer"),emphasis:s.localizationService.get("Qna_Enhance_WithCopilot")},link:{href:Nn.y,text:s.localizationService.get("LearnMore")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:o,text:s.localizationService.get("WorkspacesSelect_Label_Text"),actionAppearance:"primary"}]}],onDismissAllBanners:function(){return s.signalCompletion()},actionHandlers:new Map([[o,s.pickWorkspace(t)]])},a.ToolingHome=Ne.me,a.ToolingSynonyms=Ne.me,a.ToolingPhrasings=Ne.me,a)),[2,this.getDeferredPromise()]})})},n.prototype.pickWorkspace=function(t){var o=this;return function(){return(0,P.__awaiter)(o,void 0,void 0,function(){var r,a,s,u,d,g;return(0,P.__generator)(this,function(v){switch(v.label){case 0:return[4,this.copilotRequirementsService.validateRequirements({showLoadingDialog:!1})];case 1:if(!(r=v.sent()).copilotStatus.enabled||_.isEmpty(r.copilotRequirements.workspaceId))return[3,6];if(a=JSON.parse(JSON.stringify(t)),(s=new In.X(a)).setRuntimeUnderstanding("Full"),!s.commit())return[3,5];v.label=2;case 2:return v.trys.push([2,4,,5]),[4,this.modelAuthoringService.apply({changes:[{updateLinguisticMetadata:{linguisticSchemaJson:s.toJsonString()}}]})];case 3:return v.sent(),[3,5];case 4:return u=v.sent(),S.fF.assertFail(u),[3,5];case 5:return this.qnaBannerService.setContent(((g={}).Visual=Ne.me,g.ToolingHome=Ne.me,g.ToolingSynonyms=Ne.me,g.ToolingPhrasings=Ne.me,g)),this.signalCompletion(),[3,7];case 6:if(r.copilotStatus.reason===Jt.Hm.NoWorkspaceId)return[2];d=Mn.G.getErrorBanners([{category:"powerbi",code:"UnsupportedUser"}],this.localizationService,"fuzzyMatchWorkspace"),this.qnaBannerService.updateContent("Visual",{showBanners:!0,banners:d}),v.label=7;case 7:return[2]}})})}},n}(Qt.R),ta=function(i){function n(t,o,r,a,s,u,h,d,g){var v=i.call(this,g)||this;return v.qnaProxyPath=t,v.conceptualSchemaProxy=o,v.copilotCapabilityService=r,v.dataModelService=a,v.dataSourcesService=s,v.explorationCapabilitiesService=u,v.featureSwitchService=h,v.qnaSupportabilityService=d,v}return(0,P.__extends)(n,i),n.prototype.execute=function(){var t,o;return(0,P.__awaiter)(this,void 0,void 0,function(){var r,s,u,d,v,w,N,H;return(0,P.__generator)(this,function(_e){switch(_e.label){case 0:return"@powerbi/Qna/qnadesktop.module#QnaDesktopModule"!==this.qnaProxyPath?(this.signalCompletion(),[2,this.getDeferredPromise()]):[4,this.featureSwitchService.getFeatureSwitches()];case 1:return r=_e.sent(),(0,Rt.J8)(r)?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 2:return s=_e.sent(),u=this.explorationCapabilitiesService.getCapabilities(),(0,uo.H)(u,s,this.qnaSupportabilityService).isAllowed&&this.qnaSupportabilityService.allowsLinguisticSchemaEdit()?[4,this.copilotCapabilityService.getCopilotEnablementStatus()]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 3:return d=_e.sent(),v=_.includes([Jt.Hm.NoWorkspaceId,Jt.Hm.WorkspaceNotFound,Jt.Hm.UserNotSignedIn],d.copilotStatus.reason),[4,this.dataModelService.getLinguisticSchema()];case 4:return w=_e.sent(),N=null===(t=w.DynamicImprovement)||void 0===t?void 0:t.RuntimeUnderstanding,H=null==N||"Default"===N||"Full"===N,v&&H?[2,null===(o=this.next)||void 0===o?void 0:o.execute(w)]:[2]}})})},n}(Qt.R),na=l(40682),Co=function(){function i(n,t){this.certifiedEventsService=n,this.telemetryService=t,this.featureName="Qna - Improve LSDL Feature"}return i.prototype.logSigninEvent=function(n){this.telemetryService.logEvent(nn,n),this.logCertifiedEvent(mt,(0,P.__assign)({},n))},i.prototype.logPromptEvent=function(n){this.telemetryService.logEvent(rn,n),this.logCertifiedEvent(on,(0,P.__assign)({},n))},i.prototype.logResultEvent=function(n){this.telemetryService.logEvent(ht,n),this.logCertifiedEvent(Xe,(0,P.__assign)({},n))},i.prototype.logCertifiedEvent=function(n,t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,activityName:n,activityAttributes:t,resultCode:"",featureName:this.featureName,activityStatus:"Succeeded"},{normalizeHierarchicalSeparators:!0})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(na.l),e.\u0275\u0275inject(U.y0))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),_o=function(i){function n(t,o,r,a,s,u){var h=i.call(this,u)||this;return h.improveLsdlService=t,h.dataModelService=o,h.localizationService=r,h.qnaBannerService=a,h.target=s,h}return(0,P.__extends)(n,i),n.prototype.execute=function(t){var o=t.requestedAgents,r=t.copilotWorkspaceId;return(0,P.__awaiter)(this,void 0,void 0,function(){var a,s,u;return(0,P.__generator)(this,function(h){switch(h.label){case 0:return _.isEmpty(o)?(S.fF.assertFail("requestable agents should be defined and non empty"),this.signalCompletion(),[2,this.getDeferredPromise()]):(0,Rt.J_)(o)&&_.isEmpty(r)?(S.fF.assertFail("copilotWorkspaceId should be defined for copilot agents"),this.signalCompletion(),[2,this.getDeferredPromise()]):[4,this.dataModelService.getLinguisticSchema()];case 1:return a=h.sent(),s=new In.X(a),this.setLoadingBanner(o),[4,this.improveLsdlService.improveLinguisticSchema({requestedAgents:o,requestPriority:"Background",lsdlJson:s.toJsonString(),copilotWorkspaceId:r})];case 2:return u=h.sent(),[4,this.next.execute({response:u,requestedAgents:o})];case 3:return h.sent(),[2,this.getDeferredPromise()]}})})},n.prototype.setLoadingBanner=function(t){var o,r=this,a=(0,ln.QH)(t,this.localizationService,this.target),s=function(et,_t){r.improveLsdlService.cancelImproveLinguisticSchema(),r.qnaBannerService.dismissBanner(_t,et)},u=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Loading_Synonyms":"Qna_ImproveLsdl_Loading_Relationships"),h=this.localizationService.get("PBI_Button_Label_Cancel"),d=(0,Rt.J_)(t)?"copilot":"info",g=Ae.b$.generateGuid(),v=Ae.b$.generateGuid(),w=Ae.b$.generateGuid(),H={showBanners:!0,banners:[{id:w,message:a,isVisible:!0,allowDismiss:!1,bannerType:d,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:h,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl","Synonyms"===this.target?function(){return s(w,"ToolingSynonyms")}:function(){return s(w,"ToolingPhrasings")}]])};this.qnaBannerService.setContent(((o={}).Visual={showBanners:!0,banners:[{id:g,message:a,link:{href:Nn.c,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:d,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:h,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl",function(){return s(g,"Visual")}]])},o.ToolingHome={showBanners:!0,banners:[{id:v,message:a,isVisible:!0,allowDismiss:!0,bannerType:d,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:h,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl",function(){return s(v,"ToolingHome")}]])},o.ToolingSynonyms="Synonyms"===this.target?H:Ne.me,o.ToolingPhrasings="Phrasings"===this.target?H:Ne.me,o))},n}(Qt.R),yo=function(i){function n(t,o,r,a,s,u){var h=i.call(this,u)||this;return h.qnaBannerService=t,h.localizationService=o,h.improveLsdlBackgroundTelemetry=r,h.copilotRequirementsService=a,h.target=s,h.underExecution=!1,h}return(0,P.__extends)(n,i),n.prototype.execute=function(t){return(0,P.__awaiter)(this,void 0,void 0,function(){var o,r,a,s=this;return(0,P.__generator)(this,function(u){return S.fF.assertNonEmpty(t,"requestableAgents"),o="Synonyms"===this.target?"generateSynonyms":"generatePhrasings",this.qnaBannerService.setContent(((a={}).Visual=(r=function(d){return{showBanners:!0,banners:[{id:Ae.b$.generateGuid(),message:(0,ln.QH)(t,s.localizationService,s.target),link:{href:Nn.c,text:s.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:(0,Rt.J_)(t)?"copilot":"info",actions:[{id:o,text:s.localizationService.get("Synonyms"===s.target?"Add_Synonyms":"Add_Relationships"),actionAppearance:"primary"}]}],actionHandlers:new Map([[o,s.getGenerationHandler(t,s.target,d)]])}})("Visual"),a.ToolingHome=r("ToolingHome"),a.ToolingSynonyms="Synonyms"===this.target?r("ToolingSynonyms"):Ne.me,a.ToolingPhrasings="Phrasings"===this.target?r("ToolingPhrasings"):Ne.me,a)),[2,this.getDeferredPromise()]})})},n.prototype.getGenerationHandler=function(t,o,r){var a=this;return function(){return(0,P.__awaiter)(a,void 0,void 0,function(){var s,u,d;return(0,P.__generator)(this,function(g){switch(g.label){case 0:return this.underExecution?[2]:(this.underExecution=!0,this.improveLsdlBackgroundTelemetry.logPromptEvent({surface:r,type:o}),(0,Rt.J_)(t)?[3,2]:[4,this.next.execute({requestedAgents:t})]);case 1:return g.sent(),this.underExecution=!1,[2];case 2:return[4,this.copilotRequirementsService.validateRequirements({showLoadingDialog:!1})];case 3:return(s=g.sent()).copilotStatus.enabled&&!_.isEmpty(s.copilotRequirements.workspaceId)?[4,this.next.execute({requestedAgents:t,copilotWorkspaceId:s.copilotRequirements.workspaceId})]:[3,5];case 4:return g.sent(),this.underExecution=!1,[2];case 5:if(s.copilotStatus.reason===Jt.Hm.NoWorkspaceId)return this.underExecution=!1,[2];g.label=6;case 6:return u=_.filter(t,function(v){return"PowerBI.AzureOpenAISynonyms"!==v&&"PowerBI.AzureOpenAIPhrasings"!==v}),_.isEmpty(u)?[3,8]:[4,this.next.execute({requestedAgents:u})];case 7:return g.sent(),this.underExecution=!1,[2];case 8:return d=Mn.G.getErrorBanners([{category:"powerbi",code:s.copilotStatus.reason===Jt.Hm.DisabledForCrossGeo?"DisallowedForCrossGeo":"UnsupportedUser",agent:"Synonyms"===o?"PowerBI.AzureOpenAISynonyms":"PowerBI.AzureOpenAIPhrasings"}],this.localizationService,o),this.qnaBannerService.updateContent(r,{showBanners:!0,banners:d}),this.underExecution=!1,[2]}})})}},n}(Qt.R),ia={provide:"improveLsdlBackgroundService",useFactory:function(i,n,t,o,r,a,s,u,h,d,g,v,w,N,H,_e,et){return(0,P.__awaiter)(this,void 0,void 0,function(){var _t;return(0,P.__generator)(this,function(Xt){switch(Xt.label){case 0:return[4,o.get(h||"@powerbi/Qna/qnadesktop.module#QnaDesktopModule","qnaSupportabilityService")];case 1:return _t=Xt.sent(),S.fF.assertValue(_t,"qna supportability service should be provided"),[2,new ra(i,n,t,r,a,s,u,_t,d,g,v,w,h,N,H,_e,et)]}})})},deps:[re.i,le.D,no.H,R.E,It.o,co.U,Ie.z,ge.vZ,wt.n,Zr.x,Co,jr.g,kn.I_,$r.F,Yn.b,Kr.n,Yr.S,kn.Dt,kn.vb]},ra=function(){function i(n,t,o,r,a,s,u,h,d,g,v,w,N,H,_e,et,_t){var Xt=this;this.conceptualSchemaProxy=n,this.dataSourcesService=t,this.lazyScoped=o,this.localizationService=r,this.explorationCapabilities=a,this.explorationNavigation=s,this.featureSwitchService=u,this.qnaSupportabilityService=h,this.dialogService=d,this.improveLsdlBackgroundTelemetry=g,this.copilotRequirementsService=v,this.copilotCapabilityService=w,this.qnaProxyPath=N,this.accountService=H,this.qnaToolingDialogLauncher=_e,this.dataModelService=et,this.modelAuthoringService=_t,this.manualImproveLsdlTriggered$=new he.xQ,this.improveLsdlBackground$=(0,Le.T)(this.qnaSupportabilityService.qnaSettingsChanged$.asObservable(),this.manualImproveLsdlTriggered$.asObservable()).pipe((0,xe.w)(function(){return Xt.tryImproveLsdlCore()}))}return i.prototype.tryImproveLsdl=function(n){return(0,P.__awaiter)(this,void 0,void 0,function(){return(0,P.__generator)(this,function(o){switch(o.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return o.sent().qnaImproveLsdlCopilot&&null==this.improveLsdlBackgroundSub?(this.improveLsdlBackgroundSub=this.improveLsdlBackground$.subscribe(),this.manualImproveLsdlTriggered$.next(n),[2]):[2]}})})},i.prototype.ngOnDestroy=function(){var n;null===(n=this.improveLsdlBackgroundSub)||void 0===n||n.unsubscribe()},i.prototype.tryImproveLsdlCore=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,o,r;return(0,P.__generator)(this,function(a){switch(a.label){case 0:return[4,this.ensureLazyScopedServices()];case 1:return a.sent(),n=new zn.B,this.constructSynonymsBannerTree(n),[4,this.improveSynonymsBannerTree.execute()];case 2:return a.sent(),o=new zn.B,this.constructPhrasingsBannerTree(o),[4,this.improvePhrasingsBannerTree.execute()];case 3:return a.sent(),r=new zn.B,this.constructWorkspacePickerBannerTree(r),[2,this.workspacePickerBannerTree.execute()]}})})},i.prototype.constructSynonymsBannerTree=function(n){this.improveSynonymsBannerTree=new Xr(this.conceptualSchemaProxy,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.qnaSupportabilityService,n);var t=new vo(this.accountService,this.dataSourcesService,this.explorationNavigation,this.qnaBannerService,this.qnaToolingDialogLauncher,this.localizationService,this.improveLsdlBackgroundTelemetry,"Synonyms",n),o=new yo(this.qnaBannerService,this.localizationService,this.improveLsdlBackgroundTelemetry,this.copilotRequirementsService,"Synonyms",n),r=new _o(this.improveLsdlService,this.dataModelService,this.localizationService,this.qnaBannerService,"Synonyms",n),a=new Mn.G(this.dataModelService,this.dataSourcesService,this.explorationNavigation,this.featureSwitchService,this.qnaBannerService,this.qnaToolingDialogLauncher,this.modelAuthoringService,this.localizationService,this.dialogService,r,this.improveLsdlBackgroundTelemetry,"Synonyms",n);this.improveSynonymsBannerTree.next=t,t.next=o,o.next=r,r.next=a},i.prototype.constructPhrasingsBannerTree=function(n){this.improvePhrasingsBannerTree=new Jr(this.featureSwitchService,this.conceptualSchemaProxy,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.qnaSupportabilityService,n);var t=new vo(this.accountService,this.dataSourcesService,this.explorationNavigation,this.qnaBannerService,this.qnaToolingDialogLauncher,this.localizationService,this.improveLsdlBackgroundTelemetry,"Phrasings",n),o=new yo(this.qnaBannerService,this.localizationService,this.improveLsdlBackgroundTelemetry,this.copilotRequirementsService,"Phrasings",n),r=new _o(this.improveLsdlService,this.dataModelService,this.localizationService,this.qnaBannerService,"Phrasings",n),a=new Mn.G(this.dataModelService,this.dataSourcesService,this.explorationNavigation,this.featureSwitchService,this.qnaBannerService,this.qnaToolingDialogLauncher,this.modelAuthoringService,this.localizationService,this.dialogService,r,this.improveLsdlBackgroundTelemetry,"Phrasings",n);this.improvePhrasingsBannerTree.next=t,t.next=o,o.next=r,r.next=a},i.prototype.constructWorkspacePickerBannerTree=function(n){this.workspacePickerBannerTree=new ta(this.qnaProxyPath,this.conceptualSchemaProxy,this.copilotCapabilityService,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.featureSwitchService,this.qnaSupportabilityService,n);var t=new ea(this.copilotRequirementsService,this.localizationService,this.modelAuthoringService,this.qnaBannerService,n);this.workspacePickerBannerTree.next=t},i.prototype.ensureLazyScopedServices=function(){return(0,P.__awaiter)(this,void 0,void 0,function(){var n,t;return(0,P.__generator)(this,function(o){switch(o.label){case 0:return this.qnaBannerService?[3,2]:(n=this,[4,this.lazyScoped.get("qnaBannerService")]);case 1:n.qnaBannerService=o.sent(),S.fF.assertValue(this.qnaBannerService,"qna banner service should be provided"),o.label=2;case 2:return this.improveLsdlService?[3,4]:(t=this,[4,this.lazyScoped.get("improveLsdlService")]);case 3:t.improveLsdlService=o.sent(),S.fF.assertValue(this.improveLsdlService,"improve lsdl service should be provided"),o.label=4;case 4:return[2]}})})},i.\u0275fac=function(t){e.\u0275\u0275invalidFactory()},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),aa=[{type:ho,componentId:"QnaVisualHostComponentId"},{type:V,componentId:"QnaAutocompleteComponentId"},{type:yn,componentId:"QnaInputV2ComponentId"},{type:Un,componentId:"QnaFeedbackComponentId"},{type:Rn,componentId:"QnaBannerComponentId"}],sa=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[ia,Ne.Do,Co],imports:[C.N.withManifests(aa),X.c.withManifest([{componentIdentifier:"QnaDiagnosticDialogComponentId",componentType:mo}]),f.CommonModule,k._t,ce.v,ue.g,K.gd,Z.eL,q.J,ve.c,Q.A3,b.O,U.e3,W._,te.T,z.Z,ae.I]}),i}()},67412:function(qe,ye,l){l.d(ye,{c:function(){return f},y:function(){return b}});var f="https://go.microsoft.com/fwlink/?linkid=2243166",b="https://go.microsoft.com/fwlink/?linkid=2258254"},87413:function(qe,ye,l){l.d(ye,{QH:function(){return X},TD:function(){return Q},od:function(){return k},x6:function(){return q}});var f=l(62458),b=l(59694);function X(C,ce,W){var K;switch(f.fF.assert(function(){return!_.isEmpty(C)},"lsdlAgents should be defined and non empty"),f.fF.assertValue(ce,"localizationService"),f.fF.assertValue(W,"target should be defined"),W){case"Synonyms":var z=_.includes(C,"PowerBI.AzureOpenAISynonyms"),Z=_.includes(C,"PowerBI.OrganizationLsdlSharing");f.fF.assert(function(){return z||Z},"target: Synonyms should contain AzureOpenAISynonyms or OrganizationLsdlSharing agent or both in the improve lsdl flow"),K=k(z,Z,ce);break;case"Phrasings":f.fF.assert(function(){return _.includes(C,"PowerBI.AzureOpenAIPhrasings")},"target: Phrasings should contain AzureOpenAIPhrasings agent in the improve lsdl flow"),K=q(ce);break;default:f.fF.assertFail("target should be synonyms or phrasings")}return K}function k(C,ce,W){return{emphasis:W.get(C&&ce?"Qna_ImproveLsdl_Synonyms_Copilot_Org":C?"Qna_ImproveLsdl_Synonyms_Copilot":"Qna_ImproveLsdl_Synonyms_Org"),text:W.get(C?"Qna_ImproveLsdl_Copilot_Disclaimer":"Qna_ImproveLsdl_Synonyms_Org_Message")}}function q(C){var ce=C.format("Qna_ImproveLsdl_Copilot_Phrasings_Prompt",[C.get("Qna_ImproveLsdl_Copilot_Disclaimer")]);return{emphasis:C.get("Qna_ImproveLsdl_Phrasings_Copilot"),text:ce}}function Q(C,ce,W){void 0===W&&(W=!1);var K=ce.getAgents(C),z=_.chain(K).filter(function(Z){var te="Enabled"===Z.state,U=(0,b.g)(Z.lastModified);return W?te:te&&U}).map(function(Z){return Z.name}).value();return"oaiPhrasings"!==C||_.find(K,function(Z){return"PowerBI.AzureOpenAIPhrasings"===Z.name})?"externalSynonyms"===C&&(_.find(K,function(Z){return"PowerBI.AzureOpenAISynonyms"===Z.name})||z.push("PowerBI.AzureOpenAISynonyms"),_.find(K,function(Z){return"PowerBI.OrganizationLsdlSharing"===Z.name})||z.push("PowerBI.OrganizationLsdlSharing")):z.push("PowerBI.AzureOpenAIPhrasings"),z}},10693:function(qe,ye,l){l.d(ye,{R:function(){return f}});var f=function(){function b(X){this.deferredPromise=X}return b.prototype.signalCompletion=function(){this.deferredPromise.resolve()},b.prototype.getDeferredPromise=function(){return this.deferredPromise.promise},b}()},85726:function(qe,ye,l){l.d(ye,{G:function(){return K}});var f=l(81337),b=l(62458),X=l(34100),k=l(55461),q=l(38078),Q=l(10693),C=l(67412),ce=l(40978),W=l(87413),K=function(z){function Z(te,U,ae,ue,ve,P,j,J,he,T,S,e,oe){var Y=z.call(this,oe)||this;return Y.dataModelService=te,Y.dataSourcesService=U,Y.explorationNavigationService=ae,Y.featureSwitchService=ue,Y.qnaBannerService=ve,Y.qnaToolingLauncher=P,Y.modelAuthoringService=j,Y.localizationService=J,Y.dialogService=he,Y.improveLsdlExecutionHandler=T,Y.improveLsdlBackgroundTelemetry=S,Y.target=e,Y.underExecution=!1,Y}return(0,f.__extends)(Z,z),Z.prototype.execute=function(te){var U=te.response,ae=te.requestedAgents,ue=te.copilotWorkspaceId;return(0,f.__awaiter)(this,void 0,void 0,function(){var ve,P,j,J,he,T,S,e,oe,Y,A=this;return(0,f.__generator)(this,function(M){switch(M.label){case 0:return null==U.result?[3,1]:(ve=new k.X(U.result.lsdlObject),[3,3]);case 1:return[4,this.dataModelService.getLinguisticSchema()];case 2:P=M.sent(),ve=new k.X(P),M.label=3;case 3:return[4,this.featureSwitchService.getFeatureSwitches()];case 4:if(j=M.sent(),J=(0,X.J8)(j),he=!1,J&&(ve.setRuntimeUnderstanding("Full"),he=ve.commit()),null==U.result&&!he)return[3,8];M.label=5;case 5:return M.trys.push([5,7,,8]),[4,this.modelAuthoringService.apply({changes:[{updateLinguisticMetadata:{linguisticSchemaJson:ve.toJsonString()}}]})];case 6:return M.sent(),[3,8];case 7:return T=M.sent(),b.fF.assertFail(T),[3,8];case 8:return(oe={}).Visual=[],oe.ToolingHome=[],oe.ToolingSynonyms=[],oe.ToolingPhrasings=[],S=oe,null!=U.result&&(S=this.getSuccessBanners(ve,ae)),e=[],!_.isEmpty(U.errors)&&null==_.find(U.errors,function(E){return"OperationCancelled"===E.code})&&(e=Z.getErrorBanners(U.errors,this.localizationService,this.target)),this.qnaBannerService.setContent(((Y={}).Visual={showBanners:!0,banners:(0,f.__spreadArray)((0,f.__spreadArray)([],S.Visual,!0),e,!0),onDismissAllBanners:function(){return A.signalCompletion()},actionHandlers:new Map([["launchTooling",function(){var E=_.first(S.Visual);A.qnaBannerService.dismissBanner("Visual",E.id),A.improveLsdlBackgroundTelemetry.logResultEvent({surface:"Visual",type:A.target,action:"ReviewResults",resultType:"Success"}),A.qnaToolingLauncher.showToolingDialog({dataSources:A.dataSourcesService.get(),exploration:A.explorationNavigationService.getCurrentExploration(),entryPoint:"VisualBanner",entryContentType:"Synonyms"===A.target?"bulkEditing":"managePhrasings"}),A.signalCompletion()}],["errorDetails",this.getErrorDetailsHandler("Visual")],["retry",this.getRetryHandler("Visual",ae,ue)]])},Y.ToolingHome={showBanners:!0,banners:(0,f.__spreadArray)((0,f.__spreadArray)([],S.ToolingHome,!0),e,!0),onDismissAllBanners:function(){return A.signalCompletion()},actionHandlers:"Synonyms"===this.target?new Map([["switchToSynonymsPage",void 0],["errorDetails",this.getErrorDetailsHandler("ToolingHome")],["retry",this.getRetryHandler("ToolingHome",ae,ue)]]):new Map([["switchToPhrasingsPage",void 0],["errorDetails",this.getErrorDetailsHandler("ToolingHome")],["retry",this.getRetryHandler("ToolingHome",ae,ue)]])},Y.ToolingSynonyms="Synonyms"===this.target?{showBanners:!0,banners:e,onDismissAllBanners:function(){return A.signalCompletion()},actionHandlers:new Map([["errorDetails",this.getErrorDetailsHandler("ToolingSynonyms")],["retry",void 0]])}:ce.me,Y.ToolingPhrasings="Phrasings"===this.target?{showBanners:!0,banners:e,onDismissAllBanners:function(){return A.signalCompletion()},actionHandlers:new Map([["errorDetails",this.getErrorDetailsHandler("ToolingPhrasings")],["retry",void 0]])}:ce.me,Y)),[2,this.getDeferredPromise()]}})})},Z.getErrorBanners=function(te,U,ae){var ue=this,ve=_.filter(te,function(he){return null!=he.agent}),P=_.filter(te,function(he){return null==he.agent}),j=new Map;_.forEach(ve,function(he){if(j.has(he.code)){var T=j.get(he.code);T.agents.push(he.agent),j.set(he.code,T)}else j.set(he.code,{agents:[he.agent],originalError:he})});var J=[];return j.forEach(function(he){var e=ue.generateErrorBanner(he.originalError,U,ae,he.agents);J.push(e)}),_.forEach(P,function(he){var T=ue.generateErrorBanner(he,U,ae);J.push(T)}),J},Z.generateErrorBanner=function(te,U,ae,ue){void 0===ue&&(ue=[]);var ve=this.getErrorConfig(te.code,U,ae,ue),P=ve.text,j=ve.bannerType,J=ve.actions;return{id:q.b$.generateGuid(),message:{text:P},isVisible:!0,allowDismiss:!0,bannerType:j,data:te,actions:J}},Z.prototype.getSuccessBanners=function(te,U){var ae,P,ue=te.getAgents("Synonyms"===this.target?"externalSynonyms":"oaiPhrasings"),ve=_.chain(ue).filter(function(T){return null!=T.lastModified}).map(function(T){return T.name}).value();if("Synonyms"===this.target){var j=_.includes(ve,"PowerBI.AzureOpenAISynonyms")&&_.includes(U,"PowerBI.AzureOpenAISynonyms"),J=_.includes(ve,"PowerBI.OrganizationLsdlSharing")&&_.includes(U,"PowerBI.OrganizationLsdlSharing");P=(0,W.od)(j,J,this.localizationService)}else P=(0,W.x6)(this.localizationService);var he=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_Review":"Qna_ImproveLsdl_Phrasings_Review");return(ae={}).Visual=[{id:q.b$.generateGuid(),message:P,link:{href:C.c,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"launchTooling",text:he,actionAppearance:"primary"}]}],ae.ToolingHome=[{id:q.b$.generateGuid(),message:P,link:{href:C.c,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"Synonyms"===this.target?"switchToSynonymsPage":"switchToPhrasingsPage",text:he,actionAppearance:"primary"}]}],ae.ToolingSynonyms=[],ae.ToolingPhrasings=[],ae},Z.getErrorConfig=function(te,U,ae,ue){var ve;void 0===ue&&(ue=[]);var P,T,j=Z.getErrorMessageConfig(te,U,ae);if("copilotAndOrg"===j.possibleSources){b.fF.assert(function(){return"Synonyms"===ae},"target can only be synonyms when the sources are copilot and org");var J=_.includes(ue,"PowerBI.AzureOpenAISynonyms"),he=_.includes(ue,"PowerBI.OrganizationLsdlSharing");P=J&&he?j.copilotAndOrg:J?j.copilot:j.org}else"copilotOnly"===j.possibleSources?P=j.copilot:"orgOnly"===j.possibleSources?(b.fF.assert(function(){return"Synonyms"===ae},"target can only be synonyms when the source is org"),P=j.org):"agnostic"===j.possibleSources?P=j.agnostic:b.fF.assertFail("possibleSources not handled");switch(te){case"NoLsdlIndexAvailable":case"NoLsdlSharingModelsAvailable":T="info";break;case"RequestThrottled":case"RequestTimeOut":T="blocked";break;case"UnsafeContentDetectedInRequest":case"UnsafeContentDetectedInResponse":case"PartiallySuccessful":T="warning";break;case"FeatureNotAvailable":T="info";break;case"FailedToOpenLsdlIndexSearcher":T="info";case"UnsupportedLanguage":b.fF.assertFail("Unexpected improve lsdl error ".concat("UnsupportedLanguage"));default:T="error"}return{text:U.get(P),bannerType:T,actions:null!==(ve=j.availableActions)&&void 0!==ve?ve:[]}},Z.getErrorMessageConfig=function(te,U,ae){var ue={id:"retry",text:U.get("IntermittentFailureRetryButton"),actionAppearance:"primary"},ve={id:"errorDetails",text:U.get("View_Details"),actionAppearance:"secondary"},P="Synonyms"===ae,J=P?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Synonyms_Error_Generic_Copilot_Org",copilot:"Qna_ImproveLsdl_Synonyms_Error_Generic_Copilot",org:"Qna_ImproveLsdl_Synonyms_Error_Generic_Org",availableActions:[ve]}:"Phrasings"===ae?{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Phrasings_Error_Generic_Copilot",availableActions:[ve]}:{possibleSources:"copilotOnly",copilot:"Qna_FuzzyMatching_PickWorkspace_Error_Generic",availableActions:[ve]};switch(te){case"GenericError":case"FailedToParseLsdlFromRequest":case"FailedToParseLsdlFromRequest":case"UnsupportedLanguage":case"NoKnownAgentsRequested":case"GenericFailure":return J;case"NetworkConnectionIssue":return{possibleSources:"agnostic",agnostic:P?"Qna_ImproveLsdl_Error_NetworkIssue_Synonyms":"Qna_ImproveLsdl_Error_NetworkIssue_Phrasings",availableActions:[ue]};case"NoLsdlIndexAvailable":return b.fF.assert(function(){return P},"NoLsdlIndexAvailable error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_NoLsdlIndexAvailable"};case"NoLsdlSharingModelsAvailable":return b.fF.assert(function(){return P},"NoLsdlSharingModelsAvailable error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_NoLsdlSharingModelsAvailable"};case"InvalidRequestVersion":case"RequiresNewerVersion":return{possibleSources:"agnostic",agnostic:"Qna_ImproveLsdl_Error_RequiresNewerVersion"};case"FailedToOpenLsdlIndexSearcher":return b.fF.assert(function(){return P},"FailedToOpenLsdlIndexSearcher error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_FailedToOpenLsdlIndexSearcher"};case"FeatureNotAvailable":case"FeatureNotAvailable":return{possibleSources:"copilotOnly",copilot:P?"Qna_ImproveLsdl_Error_Copilot_Tenant_Disabled_Synonyms":"Qna_ImproveLsdl_Error_Copilot_Tenant_Disabled_Phrasings"};case"UnsupportedUser":return{possibleSources:"copilotOnly",copilot:"CopilotCapability_NoEligibleWorkspace_Message"};case"PartiallySuccessful":return P?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_PartialSuccess_Org_Synonyms",availableActions:[ue]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Phrasings",availableActions:[ue]};case"UnsafeContentDetectedInRequest":case"UnsafeContentDetectedInResponse":return P?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_PartialSuccess_Org_Synonyms",availableActions:[ue]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Unsafe_Content_Copilot",availableActions:[ve]};case"RequestThrottled":return P?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_Throttle_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_Throttle_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_Throttle_Org_Synonyms",availableActions:[ue]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Throttle_Copilot_Phrasings",availableActions:[ue]};case"RequestTimeOut":return P?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_Timeout_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_Timeout_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_Timeout_Org_Synonyms",availableActions:[ue]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Timeout_Copilot_Phrasings",availableActions:[ue]};case"DisallowedForCrossGeo":return{possibleSources:"copilotOnly",copilot:P?"Qna_ImproveLsdl_Error_Copilot_CrossGeo_Disallowed_Synonyms":"Qna_ImproveLsdl_Error_Copilot_CrossGeo_Disallowed_Phrasings"};default:return b.fF.assertFail("unhandled improveLsdlErrorCode ".concat(te)),J}},Z.prototype.getRetryHandler=function(te,U,ae){var ue=this;return function(){return(0,f.__awaiter)(ue,void 0,void 0,function(){return(0,f.__generator)(this,function(ve){switch(ve.label){case 0:return this.underExecution?[2]:(this.underExecution=!0,this.improveLsdlBackgroundTelemetry.logResultEvent({surface:te,type:this.target,action:"Retry",resultType:"Failure"}),[4,this.improveLsdlExecutionHandler.execute({requestedAgents:U,copilotWorkspaceId:ae})]);case 1:return ve.sent(),this.underExecution=!1,[2]}})})}},Z.prototype.getErrorDetailsHandler=function(te){var U=this;return function(ae){b.fF.assertValue(ae,"improve lsdl error"),U.improveLsdlBackgroundTelemetry.logResultEvent({surface:te,type:U.target,action:"ShowErrorDetails",resultType:"Failure"}),U.dialogService.showTemplateDialog("QnaDiagnosticDialogComponentId",{title:U.localizationService.get("Qna_Explore_ErrorMessage"),hideCancelButton:!0,input:{errorCode:ae.code,errorMessage:ae.diagnosticMessage}})}},Z}(Q.R)},40978:function(qe,ye,l){l.d(ye,{Do:function(){return C},me:function(){return ce}});var f=l(81337),b=l(35510),X=l(14172),k=l(62458),q=l(50423),C={provide:"qnaBannerService",useFactory:function(){return(0,f.__awaiter)(this,void 0,void 0,function(){return(0,f.__generator)(this,function(K){return[2,new W]})})},deps:[]},ce={showBanners:!1,banners:[]},W=function(){function K(){var z;this.bannerContent$=new b.X(((z={}).ToolingHome=ce,z.ToolingSynonyms=ce,z.ToolingPhrasings=ce,z.Visual=ce,z))}return K.prototype.setContent=function(z){k.fF.assertValue(z,"bannersBySurface"),_.forEach(z,function(Z){k.fF.assertValue(Z,"banner content should not be null")}),this.bannerContent$.next(z)},K.prototype.updateContent=function(z,Z){k.fF.assertValue(z,"qnaBannerSurface"),k.fF.assertValue(Z,"updatedContent");var te=this.bannerContent$.value;te[z]=Z,this.bannerContent$.next(te)},K.prototype.getBannerContent=function(z){return k.fF.assertValue(z,"qnaBannerSurface"),this.bannerContent$.asObservable().pipe((0,X.U)(function(Z){return Z[z]}))},K.prototype.dismissBanner=function(z,Z){k.fF.assertValue(z,"qnaBannerSurface"),k.fF.assertValue(Z,"qnaBannerId");var U=(0,f.__assign)({},this.bannerContent$.value[z]),ae=_.find(U.banners,function(ue){return ue.id===Z});null!=ae?(ae.isVisible=!1,U.banners=(0,f.__spreadArray)([],U.banners,!0),this.updateContent(z,U),1===_.size(U.banners)&&U.onDismissAllBanners&&U.onDismissAllBanners()):k.fF.assertFail("banner with id: ".concat(Z," not found"))},K.\u0275prov=q.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac=function(Z){return new(Z||K)}}),K}()},1931:function(qe,ye,l){l.d(ye,{T:function(){return ae}});var f=l(77476),b=l(52910),X=l(13052),k=l(31109),q=l(32208),Q=l(76521),C=l(40516),ce=l(84497),W=l(79061),K=l(98665),z=l(56545),Z=l(3176),te=l(50423),ae=function(){function ue(){}return ue.\u0275fac=function(P){return new(P||ue)},ue.\u0275mod=te.\u0275\u0275defineNgModule({type:ue}),ue.\u0275inj=te.\u0275\u0275defineInjector({imports:[f.CommonModule,b.O,X.T,k.F,q.J,Q.A3,C.h,ce.L,W.v,K.e3,z.g,Z.c]}),ue}()},37320:function(qe,ye,l){l.d(ye,{y:function(){return T}});var f=l(81337),b=l(35510),X=l(74804),k=l(62458),q=l(58291),Q=l(57871),C=l(42614),ce=l(3579),W=l(38953),K=l(54834),z=l(35988),Z=l(74857),te=l(50423),U=l(26898),ae=l(83008),ue=l(8586),ve=l(21436),P=l(28894),j=l(84916),J=l(29866),T=function(){function A(M,E,B,F,ne,ee,se){this.conceptualSchemaProxy=M,this.dataSources=E,this.explorationSerializer=B,this.lazyScoped=F,this.podExplorationResolver=ne,this.resourcePackage=ee,this.visualPlugin=se}return A.prototype.createInterpretListener=function(M,E){return void 0===E&&(E=500),new S(this.conceptualSchemaProxy,this.dataSources,this.explorationSerializer,this.lazyScoped,this.podExplorationResolver,this.resourcePackage,this.visualPlugin,M,E)},A.\u0275fac=function(E){return new(E||A)(te.\u0275\u0275inject(U.i),te.\u0275\u0275inject(ae.D),te.\u0275\u0275inject(ue.L),te.\u0275\u0275inject(P.H),te.\u0275\u0275inject(ve.Bl),te.\u0275\u0275inject(j.o),te.\u0275\u0275inject(J.D))},A.\u0275prov=te.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac}),A}(),S=function(){function A(M,E,B,F,ne,ee,se,fe,pe){this.conceptualSchemaProxy=M,this.dataSources=E,this.explorationSerializer=B,this.lazyScoped=F,this.podExplorationResolver=ne,this.resourcePackage=ee,this.visualPlugin=se,this.setupParams=fe,this.timeout=pe,k.fF.assertValue(fe,"setupParams"),this.updateManager=new Y(this.timeout),this.setupParams=fe}return A.prototype.getObservable=function(){return this.updateManager.getObservable()},A.prototype.onInterpretIssued=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:0})},A.prototype.onInterpretRetry=function(M){this.updateManager.pushUpdate({resultType:1,retryWarning:M})},A.prototype.onInterpretResultCleared=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:4,utterance:""})},A.prototype.onInterpretResult=function(M,E){var B;return(0,f.__awaiter)(this,void 0,void 0,function(){var F,ne;return(0,f.__generator)(this,function(ee){return F=!!E.error||!this.setupParams.forTrainingTermBinding&&_.isEmpty(E.results)||this.setupParams.forTrainingTermBinding&&_.every(E.results,function(se){return!se.command})&&!function(A){return!A||!!_.find(A,function(M){return 2===M||8===M||11===M||12===M||9===M||10===M||24===M})}(E.warnings),F?(ne=_.first(E.results),this.onInterpretErrorV2(E.utterance,M,E.error,ne?.spans,null===(B=ne?.correctionInfo)||void 0===B?void 0:B.correctedUtterance),[2]):[2,this.onInterpretSuccessV2(E,M)]})})},A.prototype.onInterpretSuccessV2=function(M,E){var B,F;return(0,f.__awaiter)(this,void 0,void 0,function(){var ne,ee;return(0,f.__generator)(this,function(fe){switch(fe.label){case 0:return k.fF.assertValue(M,"interpretResponse"),this.cancelErrorThrottler(),null!==(B=E?.intent)&&void 0!==B&&B.defineCalculation?[4,this.handleCalculationResult(M,E)]:[3,2];case 1:return fe.sent(),[3,6];case 2:return ne=_.first(M.results),(ee=null===(F=ne?.command)||void 0===F?void 0:F.query)&&_.find(ee.from().sources(),function(pe){return(0,W.Yg)(pe)})?[4,this.handlePodPageResult(M,E)]:[3,4];case 3:return fe.sent(),[3,6];case 4:return[4,this.handleVisualResult(M,E)];case 5:fe.sent(),fe.label=6;case 6:return[2]}})})},A.prototype.onInterpretErrorV2=function(M,E,B,F,ne){var ee=this;k.fF.assertValue(M,"utterance"),this.cancelErrorThrottler();var se=this.setupParams.forTrainingTermBinding?{spans:F,correctedUtterance:ne}:void 0;this.errorThrottler=setTimeout(function(){ee.updateManager.pushThrottledUpdate({request:E,resultType:3,interpretError:B,utterance:M,termBindingsTrainingInfo:se,doNotShowResult:!0}),ee.errorThrottler=void 0},this.timeout)},A.prototype.cancelErrorThrottler=function(){this.errorThrottler&&clearTimeout(this.errorThrottler),this.errorThrottler=void 0},A.prototype.handlePodPageResult=function(M,E){return(0,f.__awaiter)(this,void 0,void 0,function(){var B,F,ne,ee,se,fe,pe,xe,ke,We,de,Fe,Oe,Re,Ue,Ve,Le,dt,pt,yt;return(0,f.__generator)(this,function(tt){switch(tt.label){case 0:if(B=_.first(M?.results),k.fF.assertValue(B,"query interpretResult must be defined for handling pod result"),F=M.utterance,ne=e(B),this.setupParams.forTrainingTermBinding)return this.updateManager.pushThrottledUpdate({request:E,resultType:2,utterance:F,termBindingsTrainingInfo:ne,doNotShowResult:!1}),[2];if(!this.setupParams.canShowPods)return this.updateManager.pushThrottledUpdate({request:E,resultType:5,utterance:F}),[2];ee=B?.command,se=ee?.query,k.fF.assertValue(se,"interpretResult command must have a defined query for handling pod result"),fe=_.find(se.from().sources(),function(He){return(0,W.Yg)(He)}),k.fF.assertValue(fe,"expect there is a pod entity"),pe=this.podExplorationResolver.getReportId(fe.schema),tt.label=1;case 1:return tt.trys.push([1,3,,4]),We=(ke=this.explorationSerializer).deepCopyExploration,[4,this.podExplorationResolver.getExploration(pe)];case 2:return xe=We.apply(ke,[tt.sent()]),de=_.find(xe.pods,function(He){return He.name===fe.pod}),Fe=de&&de.boundSection,Oe=_.find(xe.sections,function(He){return Fe===He.name}),de&&Fe&&Oe?(C.l.mergeExplorationSectionFilters(xe,Oe),Re=(0,Z.Nj)(ee?.queryMetadata),Ue=K.ib.serializeQuery(se),_.isEmpty(Ue.Where)||(Ve=C.l.extractParameterFilters(Ue,Re),C.l.applySectionParameterFilters(Oe,de,void 0,Ve)),Le=_.filter(xe.resourcePackages,function(He){return _.some(Oe.visualContainers,function(bt){return(0,ce.s)(bt)===He.name})}),_.isEmpty(Le)||(this.resourcePackage.registerPackages(Le),this.visualPlugin.ensurePlugins(Le)),Oe.size.displayOption=1,xe.activeSectionIndex=_.findIndex(xe.sections,function(He){return He.name===Oe.name}),dt=this.getModelFromResult(B),this.ensureDataSources(dt,xe),pt=dt.id,yt=this.getNotShowLowConfidenceResult(B),this.updateManager.pushThrottledUpdate({request:E,resultType:2,modelId:pt,utterance:F,exploration:xe,restatement:B.restatement,doNotShowResult:yt,usedAgents:B?.usedAgents}),[3,4]):(this.updateManager.pushThrottledUpdate({request:E,resultType:6,utterance:F}),[2]);case 3:return tt.sent(),this.updateManager.pushThrottledUpdate({request:E,resultType:6,utterance:F}),[3,4];case 4:return[2]}})})},A.prototype.handleVisualResult=function(M,E){return(0,f.__awaiter)(this,void 0,void 0,function(){var B,F,ne,ee,se,fe,pe,xe,de,Fe,Oe;return(0,f.__generator)(this,function(Ue){switch(Ue.label){case 0:if(k.fF.assertValue(M,"interpretResponse"),B=M.utterance,F=_.first(M?.results),!this.setupParams.canShowVisuals)return this.updateManager.pushThrottledUpdate(this.setupParams.forTrainingTermBinding?{request:E,resultType:2,utterance:B,termBindingsTrainingInfo:e(F),doNotShowResult:!1}:{request:E,resultType:5,utterance:B}),[2];ne=this.setupParams.forTrainingTermBinding?e(F):void 0,Ue.label=1;case 1:return Ue.trys.push([1,4,,5]),ee=(0,z.vr)(M?.warnings),se=_.uniq(_.map(ee,function(Ve){return Ve.messageKey})),fe=!_.isEmpty(ee),pe=void 0,(xe=F&&F.command)&&xe.query?_.isEmpty(ee)?(de=this.getModelFromResult(F),this.ensureDataSources(de,void 0),[4,this.lazyScoped.get("visualRecommendationService")]):(this.updateManager.pushThrottledUpdate({request:E,resultType:2,utterance:B,termBindingsTrainingInfo:ne,doNotShowResult:!0,doNotShowResultCustomMessageKeys:se}),[2]):(this.updateManager.pushThrottledUpdate({request:E,resultType:this.setupParams.forTrainingTermBinding?2:3,utterance:B,termBindingsTrainingInfo:ne,doNotShowResult:!this.setupParams.forTrainingTermBinding||fe,doNotShowResultCustomMessageKeys:fe?se:void 0}),[2]);case 2:return Fe=Ue.sent(),[4,(0,Z.y_)(F,this.conceptualSchemaProxy,this.dataSources,Fe)];case 3:return(pe=Ue.sent())?(Oe=this.getNotShowLowConfidenceResult(F),this.updateManager.pushThrottledUpdate({request:E,resultType:2,modelId:de.id,utterance:B,restatement:F&&F.restatement,termBindingsTrainingInfo:ne,visualContainer:pe,doNotShowResult:Oe,usedAgents:F?.usedAgents})):this.updateManager.pushThrottledUpdate({request:E,resultType:6,utterance:B,termBindingsTrainingInfo:ne}),[3,5];case 4:return Ue.sent(),this.updateManager.pushThrottledUpdate({request:E,resultType:6,utterance:B,termBindingsTrainingInfo:ne}),[3,5];case 5:return[2]}})})},A.prototype.handleCalculationResult=function(M,E){var B;return(0,f.__awaiter)(this,void 0,void 0,function(){var F,ne,se,fe,pe;return(0,f.__generator)(this,function(xe){for(F=M.utterance,this.setupParams.canShowCalculations||this.updateManager.pushThrottledUpdate({request:E,resultType:5,utterance:F}),ne=[],se=0,fe=M.results;se<fe.length;se++)null!==(B=(pe=fe[se]).command)&&void 0!==B&&B.defineCalculation&&!this.getNotShowLowConfidenceResult(pe)&&ne.push((0,f.__assign)((0,f.__assign)({},pe.command.defineCalculation),{restatement:pe.restatement}));return _.isEmpty(ne)?this.updateManager.pushThrottledUpdate({request:E,resultType:3,utterance:F}):this.updateManager.pushThrottledUpdate({request:E,resultType:2,utterance:F,restatement:void 0,doNotShowResult:!1,calculations:ne}),[2]})})},A.prototype.getNotShowLowConfidenceResult=function(M){if(!M?.command)return!0;var E=M.correctionInfo&&M.correctionInfo.state;return 0===E||1===E&&this.setupParams.canShowDidYouMean},A.prototype.getModelFromResult=function(M){var E=1===_.size(this.setupParams.models)?this.setupParams.models[0]:_.find(this.setupParams.models,function(B){return B.dbName===M.databaseName&&B.vsName===M.virtualServerName});return k.fF.assertValue(E,"There are multiple models for interpret, one of them should match the model that the interpret result is from"),E},A.prototype.ensureDataSources=function(M,E){if(M&&this.setupParams.resetDataSources){var B=(0,X.CD)(M),F=(0,X.yd)([B]);if(!_.isEmpty(E?.modelExtensions)){var ne=Q.eM,ee=B.name;F.push({type:q.K,id:void 0,name:ne,extends:ee,exploration:{schemaName:ne,extends:ee,getModelExtensions:function(){return E.modelExtensions},getDataSourceVariables:function(){return E.dataSourceVariables}}})}this.dataSources.set(F)}},A}();function e(A){if(A){var M=A.command;return{spans:A.spans,correctedUtterance:A.correctionInfo&&A.correctionInfo.correctedUtterance,linguisticSchemaJson:M&&M.linguisticSchemaJson,linguisticSchemaItems:M&&M.linguisticSchemaItems,inferredTermMetadata:M&&M.inferredTermMetadata}}}var Y=function(){function A(M){this.timeout=M,this.interpretResult$=new b.X(void 0)}return A.prototype.getObservable=function(){return this.interpretResult$.asObservable()},A.prototype.pushUpdate=function(M){this.throttler&&clearTimeout(this.throttler),this.throttler=void 0,this.throttledUpdate=void 0,this.interpretResult$.next(M),this.throttler=this.startThrottler()},A.prototype.pushThrottledUpdate=function(M){this.throttler?this.throttledUpdate=M:(this.interpretResult$.next(M),this.throttler=this.startThrottler())},A.prototype.startThrottler=function(){var M=this;return setTimeout(function(){M.throttledUpdate?(M.interpretResult$.next(M.throttledUpdate),M.throttledUpdate=void 0,M.throttler=M.startThrottler()):M.throttler=void 0},this.timeout)},A}()},72129:function(qe,ye,l){function f(C){return"Suggestions"===C?.type}function b(C){return"Visual"===C?.type}function X(C){return"VisualAsExploration"===C?.type}function k(C){return"Pod"===C?.type}function q(C){return"Error"===C?.type}function Q(C){return"QueryError"===C?.type}l.d(ye,{Ew:function(){return f},fU:function(){return X},lP:function(){return k},mn:function(){return b},uT:function(){return q},wp:function(){return Q}})},7124:function(qe,ye,l){l.d(ye,{D:function(){return bn}});var f=l(81337),b=l(50423),X=l(48787),k=l(92060),q=l(79154),Q=l(94419),C=l(80981),ce=l(90120),W=l(56578),K=l(1521),z=l(61903),Z=l(18664),te=l(47245),U=l(62458),ae=l(2142),ue=l(2931),ve=l(50550),P=l(11077),j=l(32105),J=l(35911),he=l(18503),T=l(82755),S=l(3579),e=l(60661),oe=l(76045),Y=l(43286),A=l(39681),M=l(16808),E=l(28579),B=l(14463),F=l(78778),ne=l(64491),ee=l(65947),se=l(12123),fe=l(32640),pe=l(21728),xe=l(80952),ke=l(98665),We=l(9410),de=l(38078),Fe=l(46135),Oe=l(8590),Re=l(80318),Ue=l(5894),Ve=l(72129),Le=l(74857),dt=l(35988),pt=l(87974),yt=l(29866),St=l(52121),tt=l(26898),He=l(83008),bt=l(48145),kt=l(39503),zt=l(11494),wt=l(77200),Yt=l(27980),Ae=l(58938),Nt=l(67660),en=l(69474),qt=l(8586),Wt=l(79006),Ot=l(72262),tn=l(906),$e=l(84281),c=l(80277),m=l(9380),y=l(21548),O=l(76072),L=l(2330),Ce=l(40956),Se=l(58991),Pe=l(65181),Qe=l(81213),ft=l(83309),nt=l(37320),rt=l(20066),rn="qnaVisualContainer",Xe="inputBox",ht="suggestions",Pt="hiddenProperties",Gt="background",st="header",It="cardBackground",ot="card",it="question",Mt="restatement",xt="FontColor",Tt="FontSize",Dt="FontFamily",cn="hoverColor",dn="acceptedColor",pn="errorColor",gn="warningColor",hn="commitButtonBackgroundColor",Bt="Bold",Ft="Italic",At="Underline",me={withBorder:!0,showSuggestions:!0,acceptedColor:"#0078D4",errorColor:"#FF0000",warningColor:"#0078D4",borderColor:"#A19F9D",fontColor:"#323130",darkFontColor:"#252423",lightFontColor:"#FFFFFF",inputBoxBackgroundColor:"#FFFFFF",suggestionBackgroundColor:"#F3F2F1",hoverColor:"#EEEEEE",semiboldFont:"'Segoe UI Semibold', wf_segoe-ui_semibold, helvetica, arial, sans-serif",regularFont:"'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",smallFontSize:j.B.createFromPt(9),mediumFontSize:j.B.createFromPt(10),largeFontSize:j.B.createFromPt(12),defaultBIUValue:!1},En={spanDropdownHeaderConfig:{show:!0,unknownSpanHeaderConfig:{actionType:"none"}}},bn=function(){function ie(p,I,x,G,V,D,re,le,Ie,ge,R,Me,be,Be,ze,we,Ye,je,lt,ut,Ke,Et,vt,Ze,Ht,$t,jt,Kt,Vt,Zt,De,Je,Ee,Te,Ct,mn,an,wn){if(this.visualPlugin=p,this.changeDetectorRef=I,this.conceptualSchemaProxy=x,this.dataSources=G,this.dialogService=V,this.explorationActivity=D,this.explorationCapabilities=re,this.explorationNavigation=le,this.explorationSerializer=Ie,this.eventBridge=ge,this.featureSwitchService=R,this.qnaFeedbackStateService=Me,this.lazyProvider=be,this.themeService=Be,this.expandCollapse=ze,this.geocoder=we,this.geolocationService=Ye,this.moduleLoader=je,this.localizationService=lt,this.errorService=ut,this.telemetryService=Ke,this.resourceLoader=Et,this.screenReaderService=vt,this.interpretListenerFactory=Ze,this.selectionService=Ht,this.sortService=$t,this.undoRedoService=jt,this.viewModeState=Kt,this.visualAuthoringOpService=Vt,this.azureMapTokenCache=Zt,this.azureMapsEndpoint=De,this.geocoderIndexedDB=Je,this.visualHostTooltipServiceFactory=Ee,this.promiseFactory=Te,this.accountService=Ct,this.qnaProxyPathToken=mn,this.qnaModelUtilsPathToken=an,this.qnaLiveConnectService=wn,this.utteranceUpdated=new b.EventEmitter,this.pinnableContentDefinitionUpdated=new b.EventEmitter,this.convertVisual=new b.EventEmitter,this.utteranceRestated=new b.EventEmitter,this.interpretationError=new b.EventEmitter,this.isBrowserIE=(0,M.rO)(),this.isBrowserIE)this.viewModel={state:"Error",error:(0,Le.ET)(lt),qnaInputConfiguration:void 0,themeCollection:void 0,viewport:void 0,presentationViewModel:void 0};else{this.pendingSuggestedQuestionsRequests=0;var vn=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),Cn=this.themeService.getVisualStyle(vn).colorPalette.dataColors.getColorByIndex(0).value,On={withBorder:me.withBorder,borderColor:me.borderColor,backgroundColor:me.inputBoxBackgroundColor,questionFontProperties:{color:me.fontColor,size:me.mediumFontSize,family:me.regularFont},acceptedUnderlineColor:me.acceptedColor,errorUnderlineColor:me.errorColor,warningUnderlineColor:me.warningColor,hoverColor:me.hoverColor,restatementFontProperties:{color:me.fontColor,size:me.smallFontSize,family:me.regularFont},commitButtonBackgroundColor:Cn,commitButtonForegroundColor:fn(Cn)};this.viewModel={state:"Loading",qnaInputConfiguration:void 0,themeCollection:vn,viewport:void 0,presentationViewModel:{inputBox:On,suggestions:{backgroundColor:me.suggestionBackgroundColor,show:me.showSuggestions,cardFontProperties:{color:me.fontColor,size:me.mediumFontSize,family:me.regularFont},headerFontProperties:{color:me.fontColor,size:me.largeFontSize,family:me.semiboldFont}}}}}}return ie.prototype.initialize=function(p,I,x,G,V,D,re,le,Ie,ge,R,Me,be){var Be;return void 0===be&&(be=!1),(0,f.__awaiter)(this,void 0,void 0,function(){var we,je,lt,ut,Ke,Et,vt,Ze,Ht,jt,Kt,Vt,De=this;return(0,f.__generator)(this,function(Je){switch(Je.label){case 0:return this.isBrowserIE?[2]:(this.models=p,this.config=I,this.hostServices=x,this.entryPoint=G,this.utteranceUpdated=V,this.convertVisual=D,this.utteranceRestated=ge,this.interpretationError=R,this.initializedTelemetryEvent=re,this.contentElement=le,Ie&&(this.pinnableContentDefinitionUpdated=Ie),we=this,[4,this.lazyProvider.get(this.qnaProxyPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","InterpretServiceModern")]);case 1:return we.interpretService=Je.sent(),je=this,[4,this.lazyProvider.get(this.qnaModelUtilsPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaModelUtilsService")];case 2:return je.qnaModelUtils=Je.sent(),lt=_.map(this.models,function(Ee){return{datasetName:Ee.dbName,datasetId:Ee.id}}),ut=this,[4,(0,pt.U)(lt,this.qnaModelUtils,this.featureSwitchService)];case 3:return ut.inCommitQuestionOnDemandMode=Je.sent(),this.interpretListener=this.interpretListenerFactory.createInterpretListener({forTrainingTermBinding:!1,canShowPods:this.config.canShowPods,canShowVisuals:this.config.canShowVisuals,canShowDidYouMean:this.config.canShowDidYouMean,models:this.models,resetDataSources:this.config.resetDataSources}),this.interpretListener.getObservable().subscribe(function(Ee){return De.onResultAvailable(Ee)}),Ke=_.find(this.dataSources.get(),function(Ee){return Ee.type===ae.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 4:return Et=Je.sent(),vt=Ke&&Et&&Et.schema(Ke.name).capabilities,(Ze=(null===(Be=this.viewModel.qnaInputConfiguration)||void 0===Be?void 0:Be.configs)||{}).supportsPodQueries=!!I.canShowPods,null!=I.focusOnInit&&(Ze.autoFocusOnInit=I.focusOnInit),null!=I.disableQnaInputAuthoring&&(Ze.disableAuthoring=I.disableQnaInputAuthoring,Ze.displayDisabledStateVisually=I.disableQnaInputAuthoring),null!=I.disableQnaInputAuthoringMessage&&(Ze.disableAuthoringMessage=I.disableQnaInputAuthoringMessage),null!=I.hostHandlesUndo&&(Ze.hostSupportsUndo=I.hostHandlesUndo),null!=I.showTermDropdownHeader&&(Ze.spanDropdownHeaderConfig={show:I.showTermDropdownHeader}),I.showUnknownTermDropdownHeaderTextOnly&&(Ze.spanDropdownHeaderConfig||(Ze.spanDropdownHeaderConfig={show:void 0}),Ze.spanDropdownHeaderConfig.unknownSpanHeaderConfig={actionType:"textOnlyHeader",textOnlyTemplate:I.unknownTermDropdownHeaderTextOnlyTemplate}),this.viewModel.themeCollection=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,interpretListener:this.interpretListener,qnaSupportedScopes:_.map(this.models,function(Ee){return{model:Ee}}),configs:Ze,presentation:this.viewModel.presentationViewModel.inputBox,initialUtterance:this.config.initialUtterance||"",initialUtteranceFromSaved:this.config.initialUtteranceFromSaved},this.viewModel.presentationViewModel.inputBox.useShellTheme=be,Ht=this,[4,this.getIsModelEditable()];case 5:return Ht.isModelEditable=Je.sent(),[4,this.updateUnknownSpanHeaderConfig()];case 6:return Je.sent(),jt=_.map(Me,function(Ee,Te){return{name:"TempFilter"+Te,filter:Ee}}),Kt=this.getCurrentVisual(),Vt=(0,A.ED)((0,te.q)({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.createFromVisualContract(Kt),getAzureMapToken:function(){return De.azureMapTokenCache.getAzureMapToken()},azureMapsEndpoint:this.azureMapsEndpoint,geocoderIndexedDB:this.geocoderIndexedDB}),function(Ee){Ee.getLocalizedString=De.hostServices.getLocalizedString,Ee.tooltips=De.hostServices.tooltips,Ee.canSelect=De.hostServices.canSelect,Ee.onSelecting=De.hostServices.onSelecting,Ee.onSelect=De.hostServices.onSelect,Ee.onCustomSort=function(Te){return De.onCustomSort(Te.sortDescriptors)},Ee.geocoder=De.hostServices.geocoder,Ee.launchUrl=De.hostServices.launchUrl,Ee.canExpandCollapse=function(Te){return vt&&vt.supportsInstanceFilters},Ee.setNodeExpansionState=function(Te){var Ct=De.getCurrentVisual();Ct&&(Te.isCollapse?De.expandCollapse.collapseNode(Ct,Te.dataRoles,Te.data):De.expandCollapse.expandNode(Ct,Te.dataRoles,Te.data),De.eventBridge.publishToChannel(Oe.jCS,{affectContainer:function(an){return an.name===rn}}))},Ee.telemetry=De.hostServices.telemetry}),Object.defineProperty(Vt,"instanceId",{value:de.b$.generateGuid()}),this.singleVisualHostConfig={notifyStart:_.noop,notifyEnd:function(){var Te;Ve.mn(null===(Te=De.viewModel)||void 0===Te?void 0:Te.result)&&(De.viewModel.result.isLoading=!1)},clearQueryErrors:_.noop,handleQueryErrors:function(Te){return De.handleQueryErrors(Te)},handleQueryWarnings:_.noop,queryVisualHostServices:{getFilters:function(){var Te=De.getCurrentVisual();if(Te){var Ct=_.union(Te&&Te.filters,jt);return De.createVisualContainerFilters(Te,Ct)}},getDataSourceVariables:function(){var Te=De.explorationNavigation.getCurrentExploration();return Te&&Te.dataSourceVariables},disableAnchorTime:!0},visualHostServices:Vt,interactivityOptions:{selection:!0},additionalObjectUpdates:void 0,disableQueryCacheUpdates:!1,noLoadMore:!1},[4,this.setSuggestedQuestions()];case 7:return Je.sent(),_.isEmpty(this.config.initialUtterance)&&this.setSuggestionsViewModel(),[2]}})})},ie.prototype.onCustomSort=function(p){var I=this.getCurrentVisual();(0,Le.fI)(I,this.sortHelper,p)},ie.prototype.ngAfterViewInit=function(){this.updateViewport()},ie.prototype.update=function(p){var I;return(0,f.__awaiter)(this,void 0,void 0,function(){var x,G,V,D,re,le,Ie,ge,R,Me,be,Be,ze,we,Ye,je,lt,ut;return(0,f.__generator)(this,function(Ke){switch(Ke.label){case 0:return x=this,[4,this.getIsModelEditable()];case 1:return x.isModelEditable=Ke.sent(),(0,Y.yE)(p.type,Fe.EP.Style)&&!this.isBrowserIE?(U.fF.assertValue(this.viewModel,"viewModel should be defined"),G=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.themeCollection=G,V=G&&this.themeService.getVisualStyle(G),D=V&&V.colorPalette.background.value||me.inputBoxBackgroundColor,re=V&&V.colorPalette.backgroundNeutral.value||me.hoverColor,le=me.acceptedColor,Ie=me.errorColor,ge=me.warningColor,R=V&&ce.v.create(V),Me=this.themeService.getVisualStyle(this.viewModel.themeCollection).colorPalette.dataColors.getColorByIndex(0).value,be=(0,K.um)(Me)>.6?me.darkFontColor:me.lightFontColor,Be=(0,T.W7)(p.objects,{objectName:Xe,propertyName:Gt},D),ze=this.createFontProperties(p.objects,Xe,it,"label",me.mediumFontSize,!1,R,V),we=(0,T.W7)(p.objects,{objectName:Xe,propertyName:hn},Me),Ye={withBorder:me.withBorder,borderColor:me.borderColor,backgroundColor:Be,questionFontProperties:ze,acceptedUnderlineColor:(0,T.W7)(p.objects,{objectName:Xe,propertyName:dn},le),errorUnderlineColor:(0,T.W7)(p.objects,{objectName:Xe,propertyName:pn},Ie),warningUnderlineColor:(0,T.W7)(p.objects,{objectName:Xe,propertyName:gn},ge),hoverColor:(0,T.W7)(p.objects,{objectName:Xe,propertyName:cn},re),restatementFontProperties:this.createFontProperties(p.objects,Xe,Mt,"smallLabel",me.smallFontSize,!1,R,V),commitButtonBackgroundColor:we,commitButtonForegroundColor:fn(we)},this.viewModel.presentationViewModel.inputBox=Ye,je=this.createFontProperties(p.objects,ht,ot,"label",me.mediumFontSize,!1,R,V),(!p.objects||!p.objects[ht]||!p.objects[ht][ot+xt])&&(je.color=be),lt={show:(0,T.NA)(p.objects,{objectName:ht,propertyName:"show"},!0),backgroundColor:(0,T.W7)(p.objects,{objectName:ht,propertyName:It},Me),cardFontProperties:je,headerFontProperties:this.createFontProperties(p.objects,ht,st,"largeLabel",me.largeFontSize,!1,R,V)},this.viewModel.presentationViewModel.suggestions=lt,this.viewModel.qnaInputConfiguration||(this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,qnaSupportedScopes:void 0,configs:En}),[4,this.updateUnknownSpanHeaderConfig()]):[3,3];case 2:Ke.sent(),Ke.label=3;case 3:return(0,Y.yE)(p.type,Fe.EP.Data)?(this.inheritedFilters=p.filters,null!==(I=this.viewModel.qnaInputConfiguration)&&void 0!==I&&I.qnaSupportedScopes?[4,this.setSuggestedQuestions()]:[3,6]):[3,7];case 4:return Ke.sent(),Ve.Ew(this.viewModel.result)&&this.setSuggestionsViewModel(),[4,this.updateUnknownSpanHeaderConfig()];case 5:Ke.sent(),Ke.label=6;case 6:this.eventBridge.publishToChannel(Oe.jCS,{affectContainer:function(vt){return vt.name===rn}}),Ke.label=7;case 7:return(0,Y.yE)(p.type,Fe.EP.Resize)&&(this.visualContainerViewport=p.viewport,this.updateViewport(),!this.isBrowserIE&&Ve.Ew(this.viewModel.result)&&this.setSuggestionsViewModel()),this.isBrowserIE||p.firstUpdate||p.objects&&p.objects[Pt]&&(ut=(0,T.NA)(p.objects,{objectName:Pt,propertyName:"savedUtterance"},""),this.qnaInputComponent&&this.qnaInputComponent.interpretUtterance({utterance:ut,suppressSuggestions:!0,incomingTags:["Committed"],useUncommittedUtterance:!0})),[2]}})})},ie.prototype.enumerateObjectInstances=function(p){var I,x,G=this;if(U.fF.assert(function(){return!G.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var V=new E.G,D=this.viewModel.presentationViewModel;switch(p.objectName){case Xe:var re=((I={})[Gt]=D.inputBox.backgroundColor,I[it+xt]=D.inputBox.questionFontProperties.color,I[it+Tt]=D.inputBox.questionFontProperties.size.pt,I);re[it+Bt]=D.inputBox.questionFontProperties.weight===q.en,re[it+Ft]=D.inputBox.questionFontProperties.style===q.BF,re[it+At]=D.inputBox.questionFontProperties.textDecoration===q.f0,re[it+Dt]=D.inputBox.questionFontProperties.family,re[dn]=D.inputBox.acceptedUnderlineColor,re[pn]=D.inputBox.errorUnderlineColor,re[gn]=D.inputBox.warningUnderlineColor,re[cn]=D.inputBox.hoverColor,re[Mt+xt]=D.inputBox.restatementFontProperties.color,re[Mt+Tt]=D.inputBox.restatementFontProperties.size.pt,re[Mt+Dt]=D.inputBox.restatementFontProperties.family,this.inCommitQuestionOnDemandMode&&(re[hn]=D.inputBox.commitButtonBackgroundColor),V.pushInstance({selector:null,properties:re,objectName:Xe});break;case ht:var le=((x={}).show=D.suggestions.show,x[st+xt]=D.suggestions.headerFontProperties.color,x[st+Tt]=D.suggestions.headerFontProperties.size.pt,x);le[st+Bt]=D.suggestions.headerFontProperties.weight===q.en,le[st+Ft]=D.suggestions.headerFontProperties.style===q.BF,le[st+At]=D.suggestions.headerFontProperties.textDecoration===q.f0,le[st+Dt]=D.suggestions.headerFontProperties.family,le[It]=D.suggestions.backgroundColor,le[ot+xt]=D.suggestions.cardFontProperties.color,le[ot+Tt]=D.suggestions.cardFontProperties.size.pt,le[ot+Bt]=D.suggestions.cardFontProperties.weight===q.en,le[ot+Ft]=D.suggestions.cardFontProperties.style===q.BF,le[ot+At]=D.suggestions.cardFontProperties.textDecoration===q.f0,le[ot+Dt]=D.suggestions.cardFontProperties.family,V.pushInstance({selector:null,properties:le,objectName:ht})}return V.complete()}},ie.prototype.getFormattingModel=function(){var p=this;if(U.fF.assert(function(){return!p.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var I=this.viewModel.presentationViewModel;return new W.Nq(function(){return p.buildInputBoxFormattingCard(I)},function(){return p.buildRestatementFormattingCard(I)},function(){return p.buildSuggestionsFormattingCard(I)}).build()}},ie.prototype.getCurrentVisual=function(){var p,I=null===(p=this.viewModel)||void 0===p?void 0:p.result;return Ve.mn(I)?I.visual:Ve.fU(I)?_.first(I.exploreCanvas.contract.visualContainers):Ve.wp(I)?I.visualWithError:void 0},ie.prototype.getCurrentUtteranceTrimmed=function(){return _.trim(this.getCurrentUtteranceUntrimmed())},ie.prototype.setGetQnaInputComponentFunc=function(p){U.fF.assertValue(p,"getQnaInputComponent must be defined."),this.getQnaInputComponent=p},ie.prototype.convertVisualClicked=function(){var p=this.getCurrentVisual();if(p){var I=(0,S.s)(p);this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.dN,{visualType:I}),this.convertVisual.emit(p)}},ie.prototype.interpretSuggestedQuestion=function(p){var I=this;this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.WW,{isAutoSuggestion:!0}),this.qnaInputComponent&&this.undoRedoService.register("Commit suggested QnA utterance",function(){I.qnaInputComponent.interpretUtterance({utterance:p,suppressSuggestions:!0,incomingTags:["SuggestedUtterance","Committed"],requireCursorAtEndIfFocused:!0,enforceFocus:!0,isCommitInCommitQuestionOnDemandMode:!0})})},ie.prototype.toggleShowAllSuggestions=function(){if(Ve.Ew(this.viewModel.result)){var p=this.viewModel.result;p.showAllSuggestions=!p.showAllSuggestions,this.setSuggestionsViewModel()}},ie.prototype.showQnaVisualErrorDetails=function(){(0,Le.aZ)(this.viewModel.error,this.errorService,this.localizationService)},ie.prototype.showResultErrorDetails=function(){(Ve.uT(this.viewModel.result)||Ve.wp(this.viewModel.result))&&(0,Le.aZ)(this.viewModel.result,this.errorService,this.localizationService)},ie.prototype.updateViewport=function(){if(!this.isBrowserIE){var p=this.contentElement.nativeElement;this.viewport={scale:1,height:p.clientHeight-10,width:p.clientWidth-10},this.viewModel.viewport=this.viewport}},ie.prototype.getUnknownSpanDropdownHeaderActionType=function(){return(0,f.__awaiter)(this,void 0,void 0,function(){return(0,f.__generator)(this,function(p){switch(p.label){case 0:return this.qnaLiveConnectService?this.qnaLiveConnectService.allowsLinguisticSchemaFeedback()?[2,"askToAdd"]:[3,1]:[2,"askToAdd"];case 1:return[4,this.allowTooling()];case 2:return p.sent()?[2,"defineInTooling"]:[2,"none"];case 3:return[2]}})})},ie.prototype.allowTooling=function(){var p;return(0,f.__awaiter)(this,void 0,void 0,function(){var I,x,G;return(0,f.__generator)(this,function(V){switch(V.label){case 0:return null==(I=null===(p=this.config)||void 0===p?void 0:p.canEdit)&&(I=0!==this.viewModeState.getMode()),I?(x=this.explorationCapabilities.getCapabilities(),x?.allowQnaTooling?null!=this.isModelEditable?[3,2]:(G=this,[4,this.getIsModelEditable()]):[2,!1]):[2,!1];case 1:G.isModelEditable=V.sent(),V.label=2;case 2:return this.isModelEditable?[2,!0]:[2,!1]}})})},ie.prototype.shouldShowThumbsUpDown=function(){return(0,f.__awaiter)(this,void 0,void 0,function(){return(0,f.__generator)(this,function(I){switch(I.label){case 0:return this.isBrowserIE?[2,!1]:this.featureSwitchService.featureSwitches.qnaThumbsUpDown?[4,this.getIsModelEditable()]:[2,!1];case 1:return[2,!I.sent()]}})})},ie.prototype.showFeedbackForCurrentQuestion=function(){var I,p=this;if(U.fF.assert(function(){return!p.isBrowserIE},"Expect this never get called if it is inside IE browser"),this.isBrowserIE)return!1;var x=null===(I=this.viewModel)||void 0===I?void 0:I.result;return!!x&&(Ve.mn(x)||Ve.lP(x)||Ve.fU(x))},ie.prototype.sendFeedback=function(p){return this.logFeedbackTelemetry(p),this.qnaInputComponent.sendFeedback(p,this.getCurrentUtteranceTrimmed())},ie.prototype.launchFeedbackDialog=function(p,I){return(0,f.__awaiter)(this,void 0,void 0,function(){var G,V=this;return(0,f.__generator)(this,function(D){switch(D.label){case 0:return D.trys.push([0,2,,3]),[4,this.dialogService.openHostDialog({bindings:{sentiment:p,showOptions:I},componentName:F.Xr,config:{minWidth:"600px",panelClass:["no-padding"]},dialogName:"QnaFeedbackDialog"})];case 1:return D.sent().afterClosed().pipe((0,X.q)(1)).subscribe(function(re){if(re&&(!_.isEmpty(re.reason)||!_.isEmpty(re.comment))){V.sendFeedback(re);var le=1===p?"PositiveDetailSubmitted":"NegativeDetailSubmitted";V.qnaFeedbackStateService.updateState(V.getCurrentUtteranceTrimmed(),le)}}),[3,3];case 2:return G=D.sent(),U.fF.assertFail("Qna Feedback dialog failed to open"),U.fF.log(G),[3,3];case 3:return[2]}})})},ie.prototype.updateUnknownSpanHeaderConfig=function(){var p;return(0,f.__awaiter)(this,void 0,void 0,function(){var I,G,V;return(0,f.__generator)(this,function(D){switch(D.label){case 0:return U.fF.assertValue(this.viewModel.qnaInputConfiguration.configs,"Expect this.viewModel.qnaInputConfiguration.configs has already been defined"),I=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,"textOnlyHeader"===(null===(p=I?.unknownSpanHeaderConfig)||void 0===p?void 0:p.actionType)?[3,2]:(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig||(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig={show:void 0}),G=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,V={},[4,this.getUnknownSpanDropdownHeaderActionType()]);case 1:G.unknownSpanHeaderConfig=(V.actionType=D.sent(),V),D.label=2;case 2:return[2]}})})},ie.prototype.logFeedbackTelemetry=function(p){this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.v5,{senitment:this.mapToTelemetryFeedbackSentiment(p.sentiment),reason:p.reason})},ie.prototype.mapToTelemetryFeedbackSentiment=function(p){return U.fF.assert(function(){return 1===p||-1===p},"unexpected telemetry sentiment"),1===p?"Positive":"Negative"},ie.prototype.shouldShowdoNotUnderstandMessageFeedbackLink=function(){var p=this.getCurrentUtteranceTrimmed();return"NegativeDetailSubmitted"!==this.qnaFeedbackStateService.getState(p)},Object.defineProperty(ie.prototype,"qnaInputComponent",{get:function(){return this.getQnaInputComponent&&this.getQnaInputComponent()},enumerable:!1,configurable:!0}),ie.prototype.getIsModelEditable=function(){return(0,f.__awaiter)(this,void 0,void 0,function(){var p,I,x;return(0,f.__generator)(this,function(G){switch(G.label){case 0:return p=_.find(this.dataSources.get(),function(V){return V.type===ae.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return I=G.sent(),x=p&&I?.schema(p.name).capabilities,[2,x?.canEdit]}})})},ie.prototype.getCurrentUtteranceUntrimmed=function(){return this.qnaInputComponent&&this.qnaInputComponent.currentDisplayedUtterance},ie.prototype.setSuggestedQuestions=function(){return(0,f.__awaiter)(this,void 0,void 0,function(){var p,I,x,G,V,re=this;return(0,f.__generator)(this,function(le){switch(le.label){case 0:return U.fF.assert(function(){return!!re.interpretService},"interpretService should be defined"),this.pendingSuggestedQuestionsRequests++,[4,this.interpretService.getSuggestedQuestions(this.convertRequestScopes(this.viewModel.qnaInputConfiguration.qnaSupportedScopes)).toPromise()];case 1:if(p=le.sent(),this.pendingSuggestedQuestionsRequests--,I=p.result,"Loading"===this.viewModel.state&&this.pendingSuggestedQuestionsRequests>0&&!p.error&&_.isEmpty(I?.utterances))return[2];if(p.error)return this.viewModel.error=this.getErrorDetailsFromError(p.error),this.viewModel.state="Error",[2];if(x=_.chain(this.models).map(function(Ie){return _.map(Ie.featuredQuestions,function(ge){return ge.utterance})}).flatten().value(),_.isEmpty(x))for(x=[],G=0,V=I.utterances;G<V.length;G++)x.push(V[G].text);return U.fF.assert(function(){return!_.isEmpty(I.utterances)||!_.isEmpty(I.warnings)},"No suggested question but no warning? something is wrong."),this.suggestions={questions:x,hasWarnings:!_.isEmpty(I.warnings)},this.viewModel.state="Ready",[2]}})})},ie.prototype.getErrorDetailsFromError=function(p){U.fF.assertValue(p,"Expect the given error to be defined.");var G,I=(0,dt.AU)(p.errorCode,this.localizationService),x=p.errorCode,V=[],D=[];if("SchemaLanguageNotSupported"===p.errorCode)G=!1,V=[{errorInfoKey:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedTitle"),errorInfoValue:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedMessage")}];else if(!(G="GenericRequestFailure"!==x))if(p.sourceServiceError){var ge=new xe.sI(p.sourceServiceError).getDetails(this.localizationService);V=ge.displayableErrorInfo,D=ge.debugErrorInfo}else _.isEmpty(p.message)||D.push({errorInfoKey:ue.Bm,errorInfoValue:p.message}),_.isEmpty(p.stackTrace)||D.push({errorInfoKey:ue.RU,errorInfoValue:p.stackTrace});var R={code:x,fixableError:0,hideSeeDetails:G,details:{message:I,displayableErrorInfo:V,debugErrorInfo:D},source:p.source};return"DataIndexMissingAllStatistics"===p.errorCode&&(R.details.helpLink="https://go.microsoft.com/fwlink/?LinkId=786785",R.details.helpLinkType=1,R.details.errorType=1),U.fF.assert(function(){return!_.isEmpty(R.code)},"telemetryCode should not be empty"),U.fF.assert(function(){return null!=R.hideSeeDetails},"hideSeeDetails should not be null"),U.fF.assert(function(){return!_.isEmpty(R.details.message)},"mainMessage should not be empty"),U.fF.assert(function(){return null!=R.source},"errorSource should not be null"),R},ie.prototype.setSuggestionsViewModel=function(){var I,x,G,p=this;U.fF.assert(function(){return!p.isBrowserIE},"Expect this never get called if it is inside IE browser");var V=_.size(null===(I=this.suggestions)||void 0===I?void 0:I.questions),D=this.viewModel.result,re=!!Ve.Ew(D)&&D.showAllSuggestions;V>0&&!re&&(V=Math.floor(this.contentElement.nativeElement.clientWidth/200))<=1&&(V=5);var ge=_.take(null===(x=this.suggestions)||void 0===x?void 0:x.questions,V),R=_.size(ge);this.viewModel.result={type:"Suggestions",suggestions:_.map(ge,function(Me,be){return{content:Me,accessibilityLabel:p.localizationService.format("Visual_Qna_SuggestedQuestion_AccessibilityLabel",be+1,R,Me)}}),showAllSuggestions:re,failedToLoadSuggestionsMessage:0===V&&null!==(G=this.suggestions)&&void 0!==G&&G.hasWarnings?this.localizationService.get("QnaStart_ErrorLoadingSuggestions"):void 0}},ie.prototype.onResultAvailable=function(p){var I,x,G;return(0,f.__awaiter)(this,void 0,void 0,function(){var V,D,re,le,Ie,ge,R,Me,be,Be=this;return(0,f.__generator)(this,function(ze){switch(ze.label){case 0:return p&&1===p.resultType?[2]:p?(this.showQuestionProblematicResultTimeout&&(clearTimeout(this.showQuestionProblematicResultTimeout),this.showQuestionProblematicResultTimeout=void 0),_.includes(p.usedAgents,"PowerBI.AzureOpenAISynonyms")?[4,this.logInterpretCopilotTelemetry()]:[3,2]):(this.pinnableContentDefinitionUpdated.emit(void 0),this.viewModel.result=void 0,[2]);case 1:ze.sent(),ze.label=2;case 2:return null!=p.utterance&&this.utteranceUpdated.emit(p.utterance),this.updateViewport(),4===p.resultType&&this.setSuggestionsViewModel(),4!==p.resultType&&6!==p.resultType&&0!==p.resultType&&p.doNotShowResult&&(this.showQuestionProblematicResultTimeout=setTimeout(function(){var we=p.interpretError;if(we)Be.interpretationError&&Be.interpretationError.emit(),Be.viewModel.result=(0,f.__assign)({type:"Error"},Be.getErrorDetailsFromError(we));else{var Ye=Be.localizationService.get("Qna_NoVisual_Message");Be.viewModel.result={type:"DoNotUnderstand",message:_.isEmpty(p.doNotShowResultCustomMessageKeys)?Ye:_.map(p.doNotShowResultCustomMessageKeys,function(je){return Be.localizationService.get(je)}).join("\n\n")},Be.screenReaderService.alert(Ye)}},1500)),4===p.resultType||6===p.resultType||p.doNotShowResult||2!==p.resultType||!p.visualContainer&&!p.exploration?(this.pinnableContentDefinitionUpdated.emit(void 0),this.cancelVisualUpdateAlert(),[2]):(this.utteranceRestated&&this.utteranceRestated.emit(p.restatement),U.fF.assertValue(p.visualContainer||p.exploration,"result should contain either visualContainer or exploration"),p.visualContainer&&(p.visualContainer.name=rn),V=p.restatement,_.startsWith(V,"Show ")&&(V=_.replace(V,"Show ",p.visualContainer?"This visual is showing ":"Showing ")),D=p.modelId,p.visualContainer?(U.fF.assert(function(){var we;return!(null===(we=p.visualContainer.config)||void 0===we||!we.singleVisual)},"single visual is not defined"),this.config.showVisualsAsExploration?(re="QnaSection",p.visualContainer.layouts=(0,ve.Br)([{id:0,position:{x:0,y:0,height:this.viewport.height,width:this.viewport.width}}]),(le=null!==(I=(0,e.PQ)(p.visualContainer).vcObjects)&&void 0!==I?I:{}).title=[{properties:{show:(0,Q.O7)(!1)}}],p.visualContainer.config.singleVisual.vcObjects=le,Ie={name:re,displayName:re,size:{displayOption:0,width:this.viewport.width,height:this.viewport.height},visualContainers:[p.visualContainer],visualContainerGroups:[p.visualContainer],filters:[]},R={themeCollection:(0,Le.D4)(this.featureSwitchService),dataSources:this.dataSources.get(),sections:[Ie],settings:{useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0}},this.explorationNavigation.loadExploration(R),this.explorationNavigation.goto(Ie),this.viewModel.result={type:"VisualAsExploration",restatement:V,exploreCanvas:(0,z.T8)(R,Ie,0),modelId:D},pe.UP.selectCanvasItem(p.visualContainer,this.selectionService),this.explorationActivity.sendExplorationContainerReady({parentActivity:void 0})):(this.viewModel.result=void 0,setTimeout(function(){return(0,f.__awaiter)(Be,void 0,void 0,function(){var we,Ye=this;return(0,f.__generator)(this,function(je){switch(je.label){case 0:return this.viewModel.result={type:"Visual",restatement:V,visual:p.visualContainer,modelId:D,isLoading:!0},we=(0,e.oJ)(p.visualContainer),_.isEmpty(we)?[3,2]:[4,this.createSortHelper(p.visualContainer)];case 1:je.sent(),je.label=2;case 2:return this.changeDetectorRef.detectChanges(),this.eventBridge.publishToChannel(Oe.jCS,{affectContainer:function(ut){return ut.name===p.visualContainer.name}}),setTimeout(function(){return Ye.updateViewport()}),[2]}})})})),ge=(0,C.d9)(p.visualContainer,this.explorationSerializer),null!=(null===(G=null===(x=ge?.config)||void 0===x?void 0:x.singleVisual)||void 0===G?void 0:G.vcObjects)&&(ge.config.singleVisual.vcObjects=void 0),this.pinnableContentDefinitionUpdated.emit({pinVisualArgs:{dataSources:this.dataSources.get(),filters:this.createVisualContainerFilters(p.visualContainer,p.visualContainer.filters),modelId:D,resourcePackages:void 0,themeCollection:this.viewModel.themeCollection,utterance:p.utterance,visualContainer:ge}}),this.alertVisualUpdate(this.getCurrentUtteranceTrimmed(),(0,S.s)(p.visualContainer)),[3,6]):[3,3]);case 3:return p.exploration?(this.updateViewport(),p.exploration.themeCollection?[4,We.P.loadThemeAndBaseTheme(this.promiseFactory,this.resourceLoader,this.themeService,p.exploration.resourcePackages,p.exploration.themeCollection)]:[3,5]):[3,6];case 4:ze.sent(),ze.label=5;case 5:Me=(R=p.exploration).sections[R.activeSectionIndex],this.explorationNavigation.loadExploration(R),this.explorationNavigation.goto(Me),this.viewModel.result={type:"Pod",restatement:V,exploreCanvas:(0,z.T8)(R,Me,0),modelId:D},be=_.find(this.models,function(we){return we.id===D}),this.pinnableContentDefinitionUpdated.emit({pinReportPageArgs:{exploration:(0,z.vi)(R,0,R.activeSectionIndex,void 0,this.localizationService),section:Me,reportId:R.reportId,modelId:D,packageId:be&&be.packageId,action:{action:ae.RCq},utterance:p.utterance,pod:_.find(p.exploration.pods,function(we){return we.boundSection===Me.name}).name,filters:Me.filters}}),this.cancelVisualUpdateAlert(),ze.label=6;case 6:return[2]}})})},ie.prototype.createSortHelper=function(p){return(0,f.__awaiter)(this,void 0,void 0,function(){var I;return(0,f.__generator)(this,function(x){switch(x.label){case 0:return I=this,[4,(0,Le.Vq)(p,this.conceptualSchemaProxy,this.dataSources,this.sortService,this.undoRedoService,this.visualAuthoringOpService,this.visualPlugin)];case 1:return I.sortHelper=x.sent(),[2]}})})},ie.prototype.createFontProperties=function(p,I,x,G,V,D,re,le){var Ie=p&&p[I],ge="".concat(x).concat(Bt),R="".concat(x).concat(Ft),Me="".concat(x).concat(At),be=(0,oe.N)(Ie,ge),Be=(0,oe.N)(Ie,R),ze=(0,oe.N)(Ie,Me),we={color:"".concat(x).concat(xt),family:"".concat(x).concat(Dt),size:"".concat(x).concat(Tt)};return be&&(we.bold="".concat(x).concat(Bt)),Be&&(we.italic="".concat(x).concat(Ft)),ze&&(we.underline="".concat(x).concat(At)),(0,Z.Zi)(p&&p[I],we,re,le,"foreground",G,{color:me.fontColor,family:D?me.semiboldFont:me.regularFont,size:V,weight:q.AI,style:q.AI,textDecoration:q.zu})},ie.prototype.createVisualContainerFilters=function(p,I){var x=_.isEmpty(I)?[]:_.chain(I).filter(function(Me){return Me.filter}).map(function(Me){return Me.filter}).value();this.inheritedFilters&&this.inheritedFilters.dataFilter&&x.push.apply(x,_.map(this.inheritedFilters.dataFiltersUnmerged,function(Me){return Me.filter}));for(var G=new P.ME,V=0,D=x;V<D.length;V++)G.addVisualFilter({filter:D[V]});var le=(0,S.s)(p),Ie=le&&this.visualPlugin.capabilities(le),ge=Ie&&Ie.supportsHighlight;!ge&&this.inheritedFilters&&this.inheritedFilters.highlightFilter&&G.addVisualFilter({filter:this.inheritedFilters.highlightFilter});var R=G.getFilters(!1);return{dataFilter:R.dataFilter,dataFiltersUnmerged:R.dataFiltersUnmerged,highlightFilter:ge&&this.inheritedFilters?this.inheritedFilters.highlightFilter:void 0,highlightFiltersUnmerged:ge&&this.inheritedFilters?this.inheritedFilters.highlightFiltersUnmerged:void 0}},ie.prototype.handleQueryErrors=function(p){if(!p.ignorable){var I=p.getDetails(this.localizationService),x=(0,he.fe)(p.code);this.viewModel.result={type:"QueryError",visualWithError:this.getCurrentVisual(),details:I,code:p.code,fixableError:0,hideSeeDetails:(0,he.O6)(p.code),overlayType:x,requestId:p.requestId,source:I.source||p.source||"PowerBI"},this.cancelVisualUpdateAlert()}},ie.prototype.alertVisualUpdate=function(p,I){if(p){var x=I?this.localizationService.format("Qna_ScreenReader_VisualUpdatedWithChartType",[p,I]):this.localizationService.format("Qna_ScreenReader_VisualUpdated",[p]);this.screenReaderService.alertWithDebounce("qna_visual_update",x)}},ie.prototype.cancelVisualUpdateAlert=function(){this.screenReaderService.cancelDebounce("qna_visual_update")},ie.prototype.logInterpretCopilotTelemetry=function(){var p;return(0,f.__awaiter)(this,void 0,void 0,function(){var I,x,G;return(0,f.__generator)(this,function(D){switch(D.label){case 0:return I=null!==(p=this.qnaProxyPathToken)&&void 0!==p?p:"@powerbi/Qna/qnaweb.module#QnaWebModule",[4,this.ensureInterpretCopilotTelemetry(I)];case 1:return D.sent(),[4,this.accountService.isSignedInAsync()];case 2:return x=D.sent(),G=this.viewModeState.getMode(),this.interpretCopilotTelemetry.logInterpretWithCopilotEvent("@powerbi/Qna/qnaweb.module#QnaWebModule"===this.qnaProxyPathToken?"service":"desktop",x,G),[2]}})})},ie.prototype.ensureInterpretCopilotTelemetry=function(p){return(0,f.__awaiter)(this,void 0,void 0,function(){var I;return(0,f.__generator)(this,function(x){switch(x.label){case 0:return null!=this.interpretCopilotTelemetry?[2]:(I=this,[4,this.lazyProvider.get(p,"interpretCopilotTelemetryService")]);case 1:return I.interpretCopilotTelemetry=x.sent(),[2]}})})},ie.prototype.convertRequestScopes=function(p){return _.map(p,function(I){return{model:I.model,reportIds:I.reportIds}})},ie.prototype.buildInputBoxFormattingCard=function(p){var I=this,x=fe.Fp.inputBox,G=new W.CQ(new W.lg("inputBox"),"Visual_Qna_QuestionBox",x,function(ge){return I.localizationService.get(ge)}),V=p.inputBox.questionFontProperties.weight===q.en,D=p.inputBox.questionFontProperties.style===q.BF,re=p.inputBox.questionFontProperties.textDecoration===q.f0,Ie=(new W.UN).withFontFamily({descriptor:x.questionFontFamily,value:p.inputBox.questionFontProperties.family}).withFontSizeProperties({descriptor:x.questionFontSize,value:p.inputBox.questionFontProperties.size.pt}).withBold({descriptor:x.questionBold,value:V}).withItalic({descriptor:x.questionItalic,value:D}).withUnderline({descriptor:x.questionUnderline,value:re}).build();return G.addGroup("text",function(ge){ge.withDisplayName("Text").addCompositeSlice("fontselector","Font",Ie).addSimpleSlice("color",function(){return new W.BT({descriptor:x.questionFontColor,value:{value:p.inputBox.questionFontProperties.color}}).build()},function(R){return R.withCustomDisplayName("Generic_Color")})}),G.addGroup("background",function(ge){ge.withDisplayName("Visual_Background").addSimpleSlice("defaultColor",function(){return new W.BT({descriptor:x.background,value:{value:p.inputBox.backgroundColor}}).build()},function(R){return R.withCustomDisplayName("Visual_Qna_QuestionBackgroundColor")}).addSimpleSlice("hoverColor",function(){return new W.BT({descriptor:x.hoverColor,value:{value:p.inputBox.hoverColor}}).build()},function(R){return R.withCustomDisplayName("Visual_Qna_QuestionBackgroundHoverColor")})}),G.addGroup("underlines",function(ge){ge.withDisplayName("Underline").addSimpleSlice("acceptedColor",function(){return new W.BT({descriptor:x.acceptedColor,value:{value:p.inputBox.acceptedUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("AcceptedColor")}).addSimpleSlice("errorColor",function(){return new W.BT({descriptor:x.errorColor,value:{value:p.inputBox.errorUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("Error_Color")}).addSimpleSlice("warningColor",function(){return new W.BT({descriptor:x.warningColor,value:{value:p.inputBox.warningUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("Warning_TitleColor")})}),G.addGroup("submitButton",function(ge){ge.withDisplayName("Visual_Qna_CommitButtonBackground").addSimpleSlice("submitButtonColor",function(){return new W.BT({descriptor:x.commitButtonBackgroundColor,value:{value:p.inputBox.commitButtonBackgroundColor}}).build()},function(R){return R.withCustomDisplayName("Background_Color")})}),G.build()},ie.prototype.buildRestatementFormattingCard=function(p){var I=this,x=fe.Fp.inputBox,G=new W.CQ(new W.lg("restatement"),"Visual_Qna_Restatement",x,function(re){return I.localizationService.get(re)}),D=(new W.UN).withFontFamily({descriptor:x.restatementFontFamily,value:p.inputBox.restatementFontProperties.family}).withFontSizeProperties({descriptor:x.restatementFontSize,value:p.inputBox.restatementFontProperties.size.pt}).build();return G.addGroup("text",function(re){re.addCompositeSlice("fontselector","Font",D).addSimpleSlice("color",function(){return new W.BT({descriptor:x.restatementFontColor,value:{value:p.inputBox.restatementFontProperties.color}}).build()},function(le){return le.withCustomDisplayName("Generic_Color")})}),G.build()},ie.prototype.buildSuggestionsFormattingCard=function(p){var I=this,x=fe.Fp.suggestions,G=new W.CQ(new W.lg("suggestions"),"Suggestions",x,function(Me){return I.localizationService.get(Me)});G.addTopLevelToggle("show",function(){return new W.bd({descriptor:x.show,value:p.suggestions.show}).build()});var V=p.suggestions.headerFontProperties.weight===q.en,D=p.suggestions.headerFontProperties.style===q.BF,re=p.suggestions.headerFontProperties.textDecoration===q.f0,Ie=(new W.UN).withFontFamily({descriptor:x.headerFontFamily,value:p.suggestions.headerFontProperties.family}).withFontSizeProperties({descriptor:x.headerFontSize,value:p.suggestions.headerFontProperties.size.pt}).withBold({descriptor:x.headerBold,value:V}).withItalic({descriptor:x.headerItalic,value:D}).withUnderline({descriptor:x.headerUnderline,value:re}).build();G.addGroup("header",function(Me){Me.withDisplayName("Visual_Qna_SuggestionsCardHeader").addCompositeSlice("fontselector","Font",Ie).addSimpleSlice("color",function(){return new W.BT({descriptor:x.headerFontColor,value:{value:p.suggestions.headerFontProperties.color}}).build()},function(be){return be.withCustomDisplayName("Generic_Color")})}),V=p.suggestions.cardFontProperties.weight===q.en,D=p.suggestions.cardFontProperties.style===q.BF,re=p.suggestions.cardFontProperties.textDecoration===q.f0;var R=(new W.UN).withFontFamily({descriptor:x.cardFontFamily,value:p.suggestions.cardFontProperties.family}).withFontSizeProperties({descriptor:x.cardFontSize,value:p.suggestions.cardFontProperties.size.pt}).withBold({descriptor:x.cardBold,value:V}).withItalic({descriptor:x.cardItalic,value:D}).withUnderline({descriptor:x.cardUnderline,value:re}).build();return G.addGroup("cards",function(Me){Me.withDisplayName("Cards").addCompositeSlice("fontselector","Font",R).addSimpleSlice("text",function(){return new W.BT({descriptor:x.cardFontColor,value:{value:p.suggestions.cardFontProperties.color}}).build()},function(be){return be.withCustomDisplayName("Text_Color")}).addSimpleSlice("background",function(){return new W.BT({descriptor:x.cardBackground,value:{value:p.suggestions.backgroundColor}}).build()},function(be){return be.withCustomDisplayName("Background_Color")})}),G.build()},ie.\u0275fac=function(I){return new(I||ie)(b.\u0275\u0275inject(yt.D),b.\u0275\u0275inject(b.ChangeDetectorRef),b.\u0275\u0275inject(tt.i),b.\u0275\u0275inject(He.D),b.\u0275\u0275inject(Ae.x),b.\u0275\u0275inject(en.Z),b.\u0275\u0275inject(bt.U),b.\u0275\u0275inject(kt.z),b.\u0275\u0275inject(qt.L),b.\u0275\u0275inject(zt.J),b.\u0275\u0275inject(m.vZ),b.\u0275\u0275inject(y.B),b.\u0275\u0275inject(O.E),b.\u0275\u0275inject(Nt.f),b.\u0275\u0275inject(Wt.v),b.\u0275\u0275inject(Ce.i),b.\u0275\u0275inject(J._1),b.\u0275\u0275inject(L.m),b.\u0275\u0275inject(Pe.o),b.\u0275\u0275inject(Qe.T),b.\u0275\u0275inject(ke.y0),b.\u0275\u0275inject(St.l6),b.\u0275\u0275inject(ft.g),b.\u0275\u0275inject(nt.y),b.\u0275\u0275inject(Ot.z),b.\u0275\u0275inject(tn.K),b.\u0275\u0275inject($e.z),b.\u0275\u0275inject(wt.kc),b.\u0275\u0275inject(Yt.Q),b.\u0275\u0275inject(c.o),b.\u0275\u0275inject(Se.A),b.\u0275\u0275inject(rt.W),b.\u0275\u0275inject(Re.A),b.\u0275\u0275inject(B.t),b.\u0275\u0275inject(k.F),b.\u0275\u0275inject(se.n,8),b.\u0275\u0275inject(ee.z,8),b.\u0275\u0275inject(ne.U,8))},ie.\u0275prov=b.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac}),ie}();function fn(ie){return(0,K.um)(ie)>.6?me.darkFontColor:me.lightFontColor}},21548:function(qe,ye,l){l.d(ye,{B:function(){return b}});var f=l(50423),b=function(){function X(){this.states={}}return X.prototype.updateState=function(k,q){this.states[k.toLocaleLowerCase()]=q},X.prototype.getState=function(k){var q;return null!==(q=this.states[k.toLocaleLowerCase()])&&void 0!==q?q:"Unchosen"},X.\u0275prov=f.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac=function(q){return new(q||X)},providedIn:"root"}),X}()},5894:function(qe,ye,l){l.d(ye,{Nt:function(){return Z},WW:function(){return X},dN:function(){return q},eV:function(){return z},v5:function(){return W},yP:function(){return C},yp:function(){return te}});var f=l(41114),b="PBI.QnaVisual.SuggestionCardClicked",X=f.cx[b]=(0,f.b1)(b),k="PBI.QnaVisual.VisualConverted",q=f.cx[k]=(0,f.b1)(k),Q="PBI.QnA.INAQ",C=f.cx[Q]=(0,f.b1)(Q,{logExpAssignment:!0}),ce="PBI.QnA.Feedback",W=f.cx[ce]=(0,f.b1)(ce),K="PBI.QnA.UpdateLsdlSharingPermission",z=f.cx[K]=(0,f.b1)(K),Z="PBI.QnaTooling.ImproveLsdlRequest",te=f.cx[Z]=(0,f.b1)(Z)},34100:function(qe,ye,l){l.d(ye,{J8:function(){return q},J_:function(){return k},NP:function(){return X}});var f=l(81337),b=l(91592);function X(Q,C,ce,W,K){var z;return(0,f.__awaiter)(this,void 0,void 0,function(){var Z,te;return(0,f.__generator)(this,function(ae){switch(ae.label){case 0:return[4,Q.get(C.get())];case 1:return Z=ae.sent(),te=ce.getCapabilities(),(0,b.H)(te,Z,W).isAllowed&&W.allowsLinguisticSchemaEdit()&&"None"!==(null===(z=K.DynamicImprovement)||void 0===z?void 0:z.Schema)?[2,!0]:[2,!1]}})})}function k(Q){return _.includes(Q,"PowerBI.AzureOpenAISynonyms")||_.includes(Q,"PowerBI.AzureOpenAIPhrasings")}function q(Q){return Q.qnaImproveLsdlCopilot&&Q.qnaSupportCommitQuestionOnDemandForAll&&Q.qnaFuzzyMatch}},87974:function(qe,ye,l){l.d(ye,{U:function(){return b}});var f=l(81337);function b(X,k,q){return(0,f.__awaiter)(this,void 0,void 0,function(){var Q,C;return(0,f.__generator)(this,function(W){switch(W.label){case 0:if(q.featureSwitches.qnaSupportCommitQuestionOnDemandForAll)return[2,!0];Q=0,C=X??[],W.label=1;case 1:return Q<C.length?[4,k.isDQOrLiveConnectToOnPrem(C[Q])]:[3,4];case 2:if(W.sent())return[2,!0];W.label=3;case 3:return Q++,[3,1];case 4:return[2,!1]}})})}},91592:function(qe,ye,l){l.d(ye,{H:function(){return b}});var f=l(16808);function b(k,q,Q){return(0,f.rO)()?{isAllowed:!1,disallowedReason:"featureDisabledInIE"}:Q.appShouldHideQnaFeature()?{isAllowed:!1,disallowedReason:"featureDisabledInApp"}:_.some(q?.schemas,function(W){return!W.isExtensionSchema&&!_.isEmpty(W.entities)})?Q.modelSupportsQna(q,k)?Q.modelHasQnaEnabled(q,k)?{isAllowed:!0}:{isAllowed:!1,disallowedReason:"qnaNotEnabled"}:{isAllowed:!1,disallowedReason:"qnaNotSupported"}:{isAllowed:!1,disallowedReason:"noModel"}}},74857:function(qe,ye,l){l.d(ye,{D4:function(){return U},ET:function(){return ce},Nj:function(){return z},Su:function(){return te},Vq:function(){return ve},aZ:function(){return Z},fI:function(){return P},y_:function(){return ae}});var f=l(81337),b=l(62458),X=l(38701),k=l(60661),q=l(18503),Q=l(50547),C=l(2240);function ce(T){return{code:"qnaNotAllowedInIE",fixableError:0,hideSeeDetails:!0,details:{message:T.get("Qna_NotSupportedInIE"),displayableErrorInfo:void 0},source:"User"}}function z(T){if(T)return{Filters:_.map(T.filters,function(S){return{Restatement:S.Restatement,type:void 0}}),Select:_.map(T.selects,function(S){return{Restatement:S.restatement}})}}function Z(T,S,e){b.fF.assertValue(T,"Expect this to be called only when the given error is defined.");var oe=T.details;if(oe){var Y=(0,q.jx)(oe),A=e.get("ServiceError_CannotLoadVisual"),M=oe.message,E=[];if(Y&&(A=oe.displayableErrorInfo[0].errorInfoKey,M=oe.displayableErrorInfo[0].errorInfoValue,oe.displayableErrorInfo.length>1))for(var B=1;B<oe.displayableErrorInfo.length;B++)E.push(oe.displayableErrorInfo[B]);b.fF.assert(function(){return null!=T.source},"Expect error.source is not null."),S.error(M,T.code,{debugErrorInfo:oe.debugErrorInfo,displayableErrorInfo:E,title:A,source:T.source,level:Q.U.Error})}}function te(T,S){var e=T.getCurrentExploration(),oe=e?.themeCollection;return _.isEmpty(oe)?U(S):oe}function U(T){return{baseTheme:(0,X.DC)(T)}}function ae(T,S,e,oe){return(0,f.__awaiter)(this,void 0,void 0,function(){var Y,A,M,E,B,F,ne,ee;return(0,f.__generator)(this,function(se){switch(se.label){case 0:return Y=T?.command,A=Y?.query,A?(M=A.select(),E=Y.queryMetadata,B=_.map(E?.selects,function(fe,pe){return{expression:M[pe].expr,type:fe.type,isGroup:fe.isGroup,defaultLabel:fe.defaultLabel,isExplicitSortBy:fe.isExplicitSortBy}}),F=E?.filters,[4,S.get(e.get())]):[2];case 1:return ne=se.sent(),(ee=oe.recommendVisuals(A,ne,{numberOfResults:1,visualType:_.first(Y.suggestedVisualTypes),filterMetadata:F,exprMetadata:B,addDefaultFormatting:!0,allowTooltipMeasures:!0}))?(b.fF.assert(function(){return 1===_.size(ee.visualContainers)},"Expected 1 result"),[2,ee.visualContainers[0]]):[2]}})})}function ve(T,S,e,oe,Y,A,M){return(0,f.__awaiter)(this,void 0,void 0,function(){var E,B;return(0,f.__generator)(this,function(F){switch(F.label){case 0:return[4,J(T,S,e,oe)];case 1:return E=F.sent(),B={defaultSortBehavior:j(T,M),sortableFields:E?.sortableFields,sortGroups:E?.sortGroups},[2,new C.B(B,T,oe,Y,A)]}})})}function P(T,S,e){if(!_.isEmpty(e)){var oe=(0,k.oJ)(T);_.isEmpty(oe)||S.applySortByFields(e)}}function j(T,S){var e,oe=(0,k.cj)(T,S);return!!oe&&!(null===(e=oe.sorting)||void 0===e||!e.default)}function J(T,S,e,oe){return(0,f.__awaiter)(this,void 0,void 0,function(){var Y,A,M,E;return(0,f.__generator)(this,function(F){switch(F.label){case 0:if(!(Y=e.get()))return[2];F.label=1;case 1:return F.trys.push([1,3,,4]),A=(0,k.PQ)(T),M=(0,k.Xf)(T),[4,S.get(Y)];case 2:return E=F.sent(),[2,oe.getSortableFields({query:M,schema:E,visualType:A.visualType,columnProperties:A.columnProperties,compiledMappings:[]})];case 3:return F.sent(),[3,4];case 4:return[2]}})})}},35988:function(qe,ye,l){l.d(ye,{AU:function(){return Re},B4:function(){return he},C2:function(){return de},Cb:function(){return e},Fm:function(){return Y},NG:function(){return se},R1:function(){return T},Tm:function(){return Oe},hj:function(){return F},qV:function(){return A},tc:function(){return fe},vr:function(){return Fe}});var Q,C,ce,W,K,z,f=l(70940),b=l(54834),X=l(62458),k=l(43286),q=l(80777),Z=((Q={}).GeneratedLinguisticSchema=0,Q.DataIndexBuildingCancelled=16,Q.DataIndexMissingStatistics=17,Q.DataIndexNotReady=8,Q.DataIndexSizeLimitReached=15,Q.DataIndexUpdateFailure=10,Q.DomainModelNotReady=2,Q.DomainModelPartialLoad=3,Q.DomainModelUpdateFailure=9,Q.EmptyLinguisticSchema=1,Q.InterpretationSemanticError=4,Q.InterpretationSemanticWarning=5,Q.InterpretCancelled=18,Q.InvalidTextualEntity=6,Q.LinguisticSchemaTruncated=14,Q.MissingOrInvalidPodParameters=13,Q.QueryAggregateNotSupported=19,Q.QueryMedianNotSupported=20,Q.QueryPercentileNotSupported=21,Q.QueryScopedEvalNotSupported=22,Q.QuerySubqueryRegroupingNotSupported=23,Q.StaleDataIndex=12,Q.StaleDomainModel=11,Q.RequiresNewerVersion=7,Q.DataIndexVersionIsOld=24,Q.QueryGroupByTableNotSupported=25,Q.QueryNotSupported=26,Q.NextBestInterpretation=27,Q),te=((C={}).ActivationFailure="ActivationFailure",C.CloudRlsModelAccessDenied="CloudRlsModelAccessDenied",C.DataIndexBuildFailure="DataIndexBuildFailure",C.DomainModelLoadFailure="DomainModelLoadFailure",C.ExternalModelAccessDenied="ExternalModelAccessDenied",C.GenericRequestFailure="GenericRequestFailure",C.LinguisticSchemaLoadFailure="LinguisticSchemaLoadFailure",C.ModelNotFound="ModelNotFound",C.ModelQnaNotEnabled="ModelQnaNotEnabled",C.ModelQnaNotSupported="ModelQnaNotSupported",C.RequiresNewerVersion="RequiresNewerVersion",C.SchemaLanguageNotSupported="SchemaLanguageNotSupported",C.MissingRuntimeModule="MissingRuntimeModule",C.VerifyRuntimeFailure="VerifyRuntimeFailure",C.DataIndexMissingAllStatistics="DataIndexMissingAllStatistics",C),U=((ce={})[16]="Qna_Warning_DataIndexIncomplete_Desktop",ce[15]="Qna_Warning_DataIndexIncomplete_Desktop",ce[14]="Qna_Warning_LinguisticSchemaTruncated_Desktop",ce),ae=((W={})[16]="Qna_Warning_DataIndexIncomplete_Service",W[15]="Qna_Warning_DataIndexIncomplete_Service",W[14]="Qna_Warning_LinguisticSchemaTruncated_Service",W),ue=[2,8,11,12,24],ve=[2,8],P=((K={})[1]="Qna_NotAllowedForReport_WithoutModel",K[2]="Qna_Explore_WarningBuildingLanguageModel",K[7]="Qna_Warning_RequiresNewerVersion",K[8]="Qna_Explore_WarningIndexing",K[9]="Qna_Warning_ModelUpdateFailure",K[10]="Qna_Warning_DataIndexUpdateFailure",K[11]="Qna_Warning_StaleModel",K[12]="Qna_Warning_StaleIndex",K[17]="Qna_Warning_DataIndexMissingStatistics",K[19]="Qna_Warning_UnsupportedFunction",K[20]="Qna_Warning_UnsupportedFunction",K[21]="Qna_Warning_UnsupportedFunction",K[22]="Qna_Warning_UnsupportedFunction",K[23]="Qna_Warning_UnsupportedFunction",K[25]="Qna_Warning_QueryGroupByTableNotSupported",K[26]="Qna_Warning_QueryNotSupported",K[27]="Qna_Warning_NextBestInterpretation",K),j=((z={}).FeatureNotAvailable="Qna_Error_GenericRequestFailure",z.NetworkConnectionIssue="Qna_Error_NetworkIssue",z.RequiresNewerVersion="Qna_Error_RequiresNewerVersion",z.ModelNotFound="Qna_Error_ModelNotFound",z.ModelQnaNotEnabled="Qna_Error_ModelQnaNotEnabled",z.ModelQnaNotSupported="Qna_Error_ModelQnaNotSupported",z.MissingRuntimeModule="Qna_Explore_MissingBinaries",z.VerifyRuntimeFailure="Qna_Explore_MissingBinaries",z.SchemaLanguageNotSupported="Qna_NotAllowedForReport_QnaNotSupported",z.SessionIsInactive="Qna_Error_GenericRequestFailure",z.GenericRequestFailure="Qna_Error_GenericRequestFailure",z.DataIndexBuildFailure="Qna_Explore_WarningFailedIndexing",z.CloudRlsModelAccessDenied="Tile_RLS_NoAccess",z.ExternalModelAccessDenied="Qna_Explore_ModelAccessDenied_WithoutSpecifyOwner",z.DataIndexMissingAllStatistics="Qna_Error_DataIndexMissingAllStatistics",z),J=[19,20,22,21,23,25,26];function he(c){X.fF.assertValue(c,"Expect the given wireV3Response to be defined");var m=Ue(c);if(m)return{error:m};var y=_.first(c.Results),O=_.first(y?.Interpretations);return{result:{utterances:_.map(O?.SuggestedUtterances,function(L){return{text:L.Text,source:L.Source}}),warnings:Le(y?.DiagnosticMessages)}}}function T(c,m,y,O){X.fF.assertValue(O,"Expect the given wireV3Response to be defined");var Ce,Se,L=Ue(O);if(!L){var Pe=_.first(O.Results);Se=Le(Pe?.DiagnosticMessages);var Qe=m??1,ft=_.take(Pe?.Interpretations,Qe);_.isEmpty(ft)||(Ce=_.map(ft,function(nt){var rt,gt,mt;return{restatement:nt.Restatement,databaseName:null===(rt=Pe.Context)||void 0===rt?void 0:rt.DatabaseName,virtualServerName:null===(gt=Pe.Context)||void 0===gt?void 0:gt.VirtualServerName,command:pt(nt.Command),correctionInfo:Ot(nt),spans:B(c,nt.Spans),language:Pe.Language,modelLanguage:Pe.ModelLanguage,modelOwner:null===(mt=Pe.Context)||void 0===mt?void 0:mt.ModelOwner,usedAgents:_.map(nt.UsedAgents,function(nn){return nn}),score:nt.Score,relevantSchemaElements:S(Pe.RelevantSchemaElements)}}))}return{utterance:c,requestId:y,error:L,results:Ce,warnings:Se}}function S(c){if(null!=c&&(null!=c.Entities||null!=c.Relationships)){var m=function(O){return{description:O.Description,score:O.Score}};return{entities:_.map(c.Entities,m),relationships:_.map(c.Relationships,m)}}}function e(c){X.fF.assertValue(c,"Expect the given wireV3Response to be defined");var m=Ue(c);if(m)return{error:m};var y=_.first(c.Results);return{results:_.map(y?.Interpretations,function(L){return{language:y.Language}})}}function oe(c){X.fF.assertValue(c,"Expect the given wireV3Response to be defined");var m=_.first(c.Results);return Le(m?.DiagnosticMessages)}function Y(c){X.fF.assertValue(c,"Expect the given wireResponse to be defined");var m=oe(c);return _.find(ue,function(y){return _.includes(m,y)})}function A(c){return X.fF.assertValue(c,"Expect the given wireResponse to be defined"),function(c){X.fF.assertValue(c,"Expect the given wireResponse to be defined");var m=oe(c);return _.find(ve,function(y){return _.includes(m,y)})}(c)}function B(c,m){if(X.fF.assertValue(c,"utterance"),X.fF.assertAnyValue(m,"wireSpans"),m){_.isEmpty(c)&&X.fF.assert(function(){return _.every(m,function(L){return 0===L.Length})},"utterance is empty, every span should have zero length");var y=[],O=[];return _.forEach(m,function(L){5!==L.Resolution||L.Binding?y.push(new dt(c,L,!1)):O.push(new dt(c,L,!0))}),_.isEmpty(O)||_.forEach(O,function(L){_.forEach(y,function(Ce){if(function(c,m){return m.startIndex<=c.startIndex&&m.endExcludingIndex>c.startIndex||m.startIndex<c.endExcludingIndex&&m.endExcludingIndex>c.endExcludingIndex||c.startIndex<=m.startIndex&&c.endExcludingIndex>=m.endExcludingIndex||m.startIndex<=c.startIndex&&m.endExcludingIndex>=c.endExcludingIndex}(Ce,L))Ce.overlapSpans.push(L);else if(L.endExcludingIndex<Ce.startIndex)return})}),y}}function F(c){return"BadGateway"===c||"ConnectFailure"===c||"ConnectionClosed"===c||"GatewayTimeout"===c||"KeepAliveFailure"===c||"NameResolutionFailure"===c||"NetworkUnavailable"===c||"ProxyAuthenticationRequired"===c||"ProxyNameResolutionFailure"===c||"RequestTimeout"===c||"ServiceUnvailable"===c||"Timeout"===c||"AccessDenied"===c?"NetworkConnectionIssue":"FeatureNotAvailableError"===c?"FeatureNotAvailable":"GenericRequestFailure"}function ne(c){return _.map(c,function(m){return{startIndex:m.StartIndex,endExcludingIndex:m.StartIndex+m.Length}})}function se(c){var m=xe(c);return c&&(m.Context={ReportMetadata:en(c.reportMetadata)}),m}function fe(c,m,y){var O=xe(c);return O.Context={ModelScopes:[{VirtualServerName:m,DatabaseName:y}],Tags:c?.tags,ImpersonatedUserPrincipalName:c?.impersonatedUserPrincipalName,ImpersonatedRoles:c?.impersonatedRoles,Feedback:Nt(c?.feedback)},O.Options||(O.Options={}),O}function xe(c){return c?{Version:"3.3.0",Utterance:c.utterance,Spans:_.map(c.spans,function(m){var y={StartIndex:m.startIndex,Length:m.endExcludingIndex-m.startIndex};return m.inferredTerm&&(y.Binding={InferredTerm:qt(m.inferredTerm)}),y}),Options:We(c),LinguisticSchemaJson:c.linguisticSchemaJson,InferredTermBinding:qt(c.inferredTermBinding),Intent:ke(c.intent),IsCommitted:c.isCommitted,DesiredInterpretationsCount:c.desiredInterpretationsCount,GroupId:c.groupId,GroupSequenceNumber:c.groupSequenceNumber}:{Version:"3.3.0",Utterance:""}}function ke(c){if(c?.defineCalculation)return{DefineCalculation:{Language:c.defineCalculation.language,Options:c.defineCalculation.options}}}function We(c){return null==c?.options?{}:{QueryMetadata:(0,k.yE)(c.options,2),VisualConfiguration:(0,k.yE)(c.options,4),SupportPodQueries:(0,k.yE)(c.options,8),IncludeRelevantSchemaElements:(0,k.yE)(c.options,32),Spans:(0,k.yE)(c.options,64),Diagnostics:(0,k.yE)(c.options,128),FrameTree:!1,AllowFollowUpQuestion:!1,AllowInsightQueries:(0,k.yE)(c.options,512),InferUnknownModelTerms:(0,k.yE)(c.options,4096),AllowPlaceholderSuggestions:!1,SuggestFollowUp:!1,SuggestedUtterances:(0,k.yE)(c.options,2048),SkipCompletion:c.skipCompletion,SingleAnswerBias:(0,k.yE)(c.options,8192),SuggestedDefineCalculationUtterances:(0,k.yE)(c.options,16384),UseLlmParser:(0,k.yE)(c.options,65536)}}function de(c){return _.map(c,function(m){var y,O;return{VirtualServerName:null===(y=m.model)||void 0===y?void 0:y.vsName,DatabaseName:null===(O=m.model)||void 0===O?void 0:O.dbName,ReportIds:m.reportIds}})}function Fe(c){if(_.indexOf(c,27)>=0)return[];var m=_.intersection(c,J);return _.map(m,function(y){return{warning:y,messageKey:P[y]}})}function Oe(c,m){if(!_.isEmpty(c)){X.fF.assert(function(){return!_.isEmpty(m)},"Must provide a valid qnaProxyPath");for(var y=[],O="@powerbi/Qna/qnadesktop.module#QnaDesktopModule"===m?U:ae,L=0,Ce=c;L<Ce.length;L++){var Se=Ce[L];if(O){var Pe=O[Se];if(Pe){y.push(Pe);continue}}var Qe=P[Se];Qe&&y.push(Qe)}return _.uniq(y)}}function Re(c,m){return m.get(j[c]||"Qna_Error_GenericRequestFailure")}function Ue(c){var m,y;if(X.fF.assertValue(c,"Expect the given wireV3Response to be defined"),"3.3.0"!==c.Version)m="RequiresNewerVersion";else{var O=_.first(c.Results);if(!O)return;y=_.find(O.DiagnosticMessages,function(Se){return 1===Se.Severity}),m=y?.Code}if(null!=m){var L=function(c){var m=te[c];return X.fF.assert(function(){return null!=m},"InterpretDiagnosticCodeToQnaErrorCodeMappings should contain key "+c),m||(m="NoClientHandling"),m}(m),Ce={errorCode:L,source:"GenericRequestFailure"===L?"PowerBI":"User",message:y?.Message,stackTrace:y?.StackTrace};return"NoClientHandling"===Ce.errorCode&&(Ce.message=_.isEmpty(Ce.message)?m+".":m+". "+Ce.message),Ce}}function Le(c){if(!_.isEmpty(c)){for(var m=[],O=function(Qe){X.fF.assert(function(){return null!=Z[Qe.Code]},'unknown mapping to convert InterpretDiagnosticMessage "'+Qe.Code+'" to client interpret warning code'),Z[Qe.Code]&&m.push(Z[Qe.Code])},L=0,Ce=c.filter(function(Pe){return 2===Pe.Severity});L<Ce.length;L++)O(Ce[L]);return m}}var dt=function(){return function(m,y,O){this.utterance=m,this.wireSpan=y,this.isOverlappingSpan=O,this.startIndex=y.StartIndex,this.endExcludingIndex=y.StartIndex+y.Length,this.text=m.substr(y.StartIndex,y.Length),this.correctedStartIndex=y.CorrectedStartIndex,this.correctedEndExcludingIndex=null!=y.CorrectedStartIndex?y.CorrectedStartIndex+y.CorrectedLength:void 0,this.resolution=y.Resolution,this.isOverlapping=O,this.tokens=function(c,m,y){return _.map(y,function(O){var L=O.StartIndex-m;return X.fF.assert(function(){return _.inRange(L,0,_.size(c))},"Expect each token.StartIndex is a valid index with the given spanText and spanStartIndex"),X.fF.assert(function(){return!_.isEmpty(_.trim(c.substr(L,O.Length)))},"Expect no WireToken being pure space"),{startIndex:O.StartIndex,endExcludingIndex:O.StartIndex+O.Length,text:c.substr(L,O.Length)}})}(this.text,this.startIndex,y.Tokens);var L=zt(this.text,y.Binding);this.binding=L&&L.bindingInfo,this.isCorrected=!(!this.binding||!L.isCorrected);var Ce=Ae(this.text,y.AlternateBindings),Se=Ae(this.text,y.PhraseCompletions),Pe=Ae(this.text,y.PhraseExtensions),Qe=Ae(this.text,y.SuggestedReplacements);(!_.isEmpty(Ce)||!_.isEmpty(Se)||!_.isEmpty(Pe)||!_.isEmpty(Qe))&&(this.replacementBindings={alternates:Ce,phraseCompletions:Se,phraseExtensions:Pe,suggestedReplacements:Qe}),this.inferredTermBindings=_.map(y.InferredTermBindings,function(gt){return{inferredBindingType:(c=gt.InferredTerm).Type,definitionPrompt:c.DefinitionPrompt,definitionText:c.DefinitionText,prefixText:c.PrefixText,suffixText:c.SuffixText,hintText:c.HintText,alternateDefinitionTexts:c.AlternateDefinitionTexts,linguisticSchemaItems:c.LinguisticSchemaItems,definedTerm:c.DefinedTerm,targetRole:c.TargetRole,metadata:c.Metadata};var c}),this.inferredTermBindingsUnsupported=y.InferredTermBindingsUnsupported,this.hasBinding=null!=this.binding||null!=this.replacementBindings||!_.isEmpty(this.inferredTermBindings),this.isWhiteSpace=!_.isEmpty(this.text)&&_.isEmpty(_.trim(this.text)),this.isUsed=!this.isOverlapping&&(null==this.resolution||0===this.resolution||4===this.resolution),this.isUnknown=3===this.resolution,this.isInferred=4===this.resolution,this.overlapSpans=[];var c,nt=!((c=this).isOverlapping||_.isEmpty(c.text)||tt(c)||He(c)||kt(c))&&c.hasBinding&&c.isUsed,rt=kt(this);X.fF.assert(function(){return!(nt&&rt)},"A span can not be definedWithOptions and undefinedWithOptions at the same time."),this.state=nt?"accepted":rt&&this.isUsed?"warning":rt?"error":"none"}}();function pt(c){if(c){var m=c.Query?b.ib.deserializeQuery(c.Query):void 0;return{query:m,queryMetadata:St(m,c.QueryMetadata),data:c.Data,binding:c.Binding,visualConfigurations:_.map(c.VisualConfigurations,function(O){var L=O.Query?b.ib.deserializeQuery(O.Query):void 0;return{visualizationType:O.VisualizationType,dataShapeBinding:O.DataShapeBinding,visualElements:O.VisualElements,query:L,queryMetadata:St(m,O.QueryMetadata)}}),suggestedVisualTypes:_.map(c.SuggestedVisualizations,function(O){return(0,f.s)(O.VisualizationType).name}),linguisticSchemaJson:c.LinguisticSchemaJson,linguisticSchemaItems:c.LinguisticSchemaItems,inferredTermMetadata:c.InferredTermMetadata,defineCalculation:yt(c.DefineCalculation)}}}function yt(c){if(c)return{expression:c.Expression,homeTable:c.HomeTable,format:c.Format}}function St(c,m){if(c&&m){var y=_.filter(m.Filters,function(L){return!!L}),O=_.filter(m.Select,function(L){return!!L});return{filters:_.map(y,function(L){return{Restatement:L.Restatement,type:void 0}}),selects:_.map(O,function(L){return{restatement:L.Restatement,valueType:tn(L.DefaultLabel?L.DefaultLabel.SemanticType:L.SemanticType),isGroup:L.IsGroup,defaultLabel:L.DefaultLabel?$e(L.DefaultLabel.Expression,c):void 0,isExplicitSortBy:L.IsExplicitSortBy}})}}}function tt(c){var m,y;return 7===(null===(m=c.binding)||void 0===m?void 0:m.type)&&!c.isCorrected&&_.isEmpty(null===(y=c.replacementBindings)||void 0===y?void 0:y.suggestedReplacements)&&_.isEmpty(c.inferredTermBindings)}function He(c){var m,y;return 8===(null===(m=c.binding)||void 0===m?void 0:m.type)&&!c.isCorrected&&2===c.resolution&&_.isEmpty(null===(y=c.replacementBindings)||void 0===y?void 0:y.suggestedReplacements)&&_.isEmpty(c.inferredTermBindings)}function kt(c){return!(c.isOverlapping||_.isEmpty(c.text)||tt(c)||He(c)||!(c.isCorrected||3===c.resolution||c.hasBinding&&!c.isUsed))}function zt(c,m){if(m&&!m.InferredTerm){var y,O;if(m.Table)y=m.Table,O=0;else if(m.Pod)y=m.Pod,O=1;else if(m.Property)y=m.Property,O=2;else if(m.Value)y=m.Value,O=3;else if(m.Range)y=m.Range,O=4;else if(m.VisType)y=m.VisType,O=5;else if(m.Composite)y=m.Composite,O=6;else if(m.Core)y=m.Core,O=7;else if(m.Phrasing)y=m.Phrasing,O=8;else if(m.TextualEntity)y=m.TextualEntity,O=9;else{if(!m.AnyEntity){var L=m;return void X.fF.assert(function(){return!!L.Literal},"Has binding type that is unhandled by client right now. Known unhandled types are: [Literal] and this is not a known type. Check to either update the known unhandled type list, or handle it on the client side.")}y=m.AnyEntity,O=10}return{bindingInfo:{type:O,text:y.Text,textSegmentsWithMatchInfo:Yt(c,y.Text,y.MatchedSegments),matchType:y.MatchType,score:y.Score},isCorrected:y.Corrected}}}function Yt(c,m,y){if(_.isEmpty(c)||_.isEmpty(y))return[{text:m,isMatched:!1}];for(var O=[],L=0,Ce=0,Se=y;Ce<Se.length;Ce++){var Pe=Se[Ce];L<Pe.StartIndex&&O.push({text:m.substring(L,Pe.StartIndex),isMatched:!1}),O.push({text:m.substr(Pe.StartIndex,Pe.Length),isMatched:!0}),L=Pe.StartIndex+Pe.Length}return L<_.size(m)&&O.push({text:m.substring(L),isMatched:!1}),O}function Ae(c,m){if(m){for(var y=[],O=0,L=m;O<L.length;O++){var Se=zt(c,L[O]);Se&&y.push(Se.bindingInfo)}return y}}function Nt(c){return c?{Sentiment:c.sentiment,Reason:c.reason,Comment:c.comment}:void 0}function en(c){return c?{LinguisticSchema:c.linguisticSchema,Pods:_.map(c.pods,function(m){return{Name:m.name,CortanaEnabled:m.cortanaEnabled,Parameters:_.map(m.parameters,function(y){return{Name:y.name,TargetColumn:y.targetColumn,TargetEntity:y.targetEntity}})}})}:void 0}function qt(c){return null==c?void 0:{Type:c.inferredBindingType,DefinitionPrompt:c.definitionPrompt,DefinitionText:c.definitionText,PrefixText:c.prefixText,SuffixText:c.suffixText,HintText:c.hintText,AlternateDefinitionTexts:c.alternateDefinitionTexts,LinguisticSchemaItems:c.linguisticSchemaItems,DefinedTerm:c.definedTerm,TargetRole:c.targetRole,Metadata:c.metadata}}function Ot(c){X.fF.assertValue(c,"result");var m=c.CorrectedUtterance;if(!_.isEmpty(m)){var O=c.ReplacementUtterance,L=2;return!!c.Command||(c.ConfidenceLevel<=5?L=0:c.ConfidenceLevel<=20&&(L=1)),_.isEmpty(c.CorrectedUtteranceTextSegments)?{correctedUtterance:m,replacementUtterance:O||m,state:L}:{correctedUtterance:m,correctedTextSegments:ne(c.CorrectedUtteranceTextSegments),state:L}}}function tn(c){switch(c){case 0:case 1:case 2:case 3:return;case 4:return q.Ge.fromExtendedType(7078913);case 5:return q.Ge.fromDescriptor({dateTime:!0});case 6:return q.Ge.fromDescriptor({numeric:!0})}}function $e(c,m){var y=b.ib.serializeQuery(m);y.Select.push(c);var O=b.ib.deserializeQuery(y);return _.last(O.select()).expr}}}]);