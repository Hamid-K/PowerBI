"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["json-contracts"],{72138:function(mt,Ne,p){p.r(Ne),p.d(Ne,{JsonContractsModule:function(){return dt}});var j,r,i,S=p(50423);(r=j||(j={})).NotIn="NotIn",r.SelectAll="All",r.operatorDictionary={None:0,LessThan:1,LessThanOrEqual:2,GreaterThan:3,GreaterThanOrEqual:4,Contains:5,DoesNotContain:6,StartsWith:7,DoesNotStartWith:8,Is:9,IsNot:10,IsBlank:11,IsNotBlank:12,IsEmptyString:13,IsNotEmptyString:14},r.logicalOperatorDictionary={Or:1,And:0},(i=r.ErrorCodes||(r.ErrorCodes={})).InvalidDataType="InvalidDataType",i.FieldNotFound="FieldNotFound",i.FilterConditionNotFound="FilterConditionNotFound",function(i){i.InvalidTarget="Could not serialize json filter target to SQ expression.",i.InvalidDataTypeMessage="The data type of the value {0} is not supported. Only string, number and boolean are supported.",i.InvalidCondition="Advanced filter requires a filter condition (None | LessThan | LessThanOrEqual | GreaterThan | GreaterThanOrEqual | Contains | DoesNotContain | StartsWith | DoesNotStartWith | Is | IsNot | IsBlank | IsNotBlank)."}(r.ErrorMessages||(r.ErrorMessages={}));var ne,B=function(){function r(){}return r.InvalidDataType="InvalidDataType",r.FieldNotFound="FieldNotFound",r.FilterConditionNotFound="FilterConditionNotFound",r.FilterValidationErrors="FilterValidationErrors",r.LogicalConditionNotFound="LogicalConditionNotFound",r.BasicFilterSerializationError="BasicFilterSerializationError",r.TupleFilterSerializationError="TupleFilterSerializationError",r.AdvancedFilterSerializationError="AdvancedFilterSerializationError",r.InvalidFilterType="InvalidFilterType",r.InvalidFilterCondition="InvalidFilterCondition",r.FilterNotFound="FilterNotFound",r.TargetNotFound="TargetNotFound",r.BasicFilterOperatorNotFound="BasicFilterOperatorNotFound",r.InvalidReportData="InvalidReportData",r.InvalidPageData="InvalidPageData",r}(),V=function(){function r(){}return r.InvalidFilterMessage="Filter is not valid, validation errors: ",r.InvalidTarget="Could not serialize json filter target to SQ expression.",r.InvalidCondition="Advanced filter requires a filter condition (None | LessThan | LessThanOrEqual | GreaterThan | GreaterThanOrEqual | Contains | DoesNotContain | StartsWith | DoesNotStartWith | Is | IsNot | IsBlank | IsNotBlank).",r.InvalidDataTypeMessage="The data type of the value {0} is not supported. Only string, number and boolean are supported.",r.FilterSerializationError="Could not serialize filter.",r.InvalidFilterTypeMessage="Not supported filter type - can't serialize to json syntax.",r.SemanticFilterInvalidCondition="Filter with invalid condition - can't serialize to json syntax.",r.FilterNotFoundMessage="Invoked filter serialization function with no filter.",r.TargetNotFoundMessage="Invoked filter serialization function with no target.",r.FieldNotFoundMessage="Invoked filter serialization function on a table that has no column/measure/hierarchy.",r.BasicFilterOperatorNotFoundMessage="Basic filter requires an operator (In | Not).",r.FilterValuesNotFound=" Could not retrieve filter values.",r.InvalidReportDataMessage="Could not find the report.",r.InvalidPageDataMessage="Could not find the active page.",r.DataPointSerializationError="Could not serialize a data point.",r.TupleFilterSerializationError="Could not serialize Tuple filter.",r}(),x=p(56745),N=p(40290),xe=p(98238),G=p(42614),we=p(94176),re=p(69615),C=p(38078),ce=p(95462),pe=p(45334),ae=p(81337),Ce=p(41114),Ie="PBI.JSONFilter.UnsupportedFilterType",He=Ce.cx[Ie]=(0,Ce.b1)(Ie),Qe=p(12913),De=p(59694),A=function(){function r(){}return r.traceError=function(e){Qe.f.error("Throwing exception: ".concat(JSON.stringify(e)),null==e.Stack)},r.fieldNotFound=function(e){return{name:B.FieldNotFound,message:V.InvalidTarget+(e?"Target table: "+e.table:"")}},r.filterValidationErrors=function(e){var t=e.map(function(i){return i.message}).join(", ");return{name:B.FilterValidationErrors,message:V.InvalidFilterMessage+t}},r.invalidDataType=function(e){return{name:B.InvalidDataType,message:(0,De.W)(V.InvalidDataTypeMessage,e)}},r.filterConditionNotFound=function(){return{name:B.FilterConditionNotFound,message:V.InvalidCondition}},r.basicFilterSerializationError=function(e){return{name:B.BasicFilterSerializationError,message:V.FilterSerializationError+e}},r.advancedFilterSerializationError=function(){return{name:B.AdvancedFilterSerializationError,message:V.FilterSerializationError}},r.tupleFilterSerializationError=function(e){return{name:B.BasicFilterSerializationError,message:V.TupleFilterSerializationError+e}},r.invalidFilterType=function(){return{name:B.InvalidFilterType,message:V.InvalidFilterTypeMessage}},r.invalidFilterCondition=function(){return{name:B.InvalidFilterCondition,message:V.SemanticFilterInvalidCondition}},r.filterNotFound=function(){return{name:B.FilterNotFound,message:V.FilterNotFoundMessage}},r.targetNotFound=function(){return{name:B.TargetNotFound,message:V.TargetNotFoundMessage}},r.fieldExpressionNotFound=function(){return{name:B.FieldNotFound,message:V.FieldNotFoundMessage}},r.basicFilterOperatorNotFound=function(){return{name:B.BasicFilterOperatorNotFound,message:V.BasicFilterOperatorNotFoundMessage}},r.invalidReportData=function(){return{name:B.InvalidReportData,message:V.InvalidReportDataMessage}},r.invalidPageData=function(){return{name:B.InvalidPageData,message:V.InvalidPageDataMessage}},r}(),$e=p(88495),Ke=p(83186),Ae=p(37532),Je=p(50550),U=p(62458),Fe=p(19008),ke=p(5265),I=p(90031),Pe=p(80366),fe=p(1629),de=p(38703),Re=p(26743),me=p(95778),b=p(94419),Z=p(74082),Ve=p(45413),Te=p(75074);!function(r){function i(l,o){var n=new P(o),u=l.accept(n);return l.hasGroupOnKeys(o)&&(u.keys=function(l,o,n){var u=l.getKeyColumns(n),c=[];return u&&(c=u.map(function(f){return f.accept(o).column})),c}(l,n,o)),u}function s(l,o){if(l&&o){var n={};void 0!==o.isLockedInViewMode&&(n.isLockedInViewMode=o.isLockedInViewMode),void 0!==o.isHiddenInViewMode&&(n.isHiddenInViewMode=o.isHiddenInViewMode),void 0!==o.displayName&&(n.displayName=o.displayName),_.isEmpty(n)||(l.displaySettings=n)}}r.fromSemanticFilter=function(l,o,n,u,c,f,h){var y;if(n&&(!n.conditions()||_.isEmpty(n.conditions())||n.conditions().length>1)&&C.b$.throwException(A.invalidFilterCondition()),function(l){return l.type===N.vA.TopN||l.type===N.vA.Exclude||l.type===N.vA.Include||l.type===N.vA.RelativeDate||l.type===N.vA.RelativeTime||l.type===N.vA.Categorical||l.type===N.vA.Visual||l.type===N.vA.Advanced||l.type===N.vA.Tuple||!l.type}(l))if(l.type===N.vA.TopN)y=v.serializeFilter(n,o,u,l);else if(l.type===N.vA.RelativeTime||l.type===N.vA.RelativeDate)y=E.serializeFilter(n,o,u,l);else if(l.type===N.vA.Exclude||l.type===N.vA.Include)y=d.serializeFilter(n,o,u,l,h);else if(l.type===N.vA.Tuple)y=m.serializeFilter(n,o,u,l);else if(l.type===N.vA.Advanced){var g=void 0;if(n){var R=n.conditions()[0];g=D.getAdvancedFilterExpression(R,f)}else g=(0,Ke.l7)(l,f);g||C.b$.throwException(A.advancedFilterSerializationError()),y=D.serializeFilter(g,o,u,l)}else{var M=l.expression;g=void 0,n&&(R=n.conditions()[0],g=D.getAdvancedFilterExpression(R,f));var L=l.type;null==L&&(M||C.b$.throwException(A.fieldExpressionNotFound()),L=(0,$e.NV)(M,o,l.howCreated,g?g.field:null)),g&&L===N.vA.Advanced?y=D.serializeFilter(g,o,u,l):(M||C.b$.throwException(A.fieldExpressionNotFound()),y=F.serializeFilter(n,l,o,u,l))}else c.logEvent(He,{filterType:N.vA[l.type]}),y=new u.NotSupportedFilter(null,V.InvalidFilterTypeMessage,N.vA[l.type]).toJSON();return y},r.getTarget=i;var v=function(){function l(){}return l.serializeFilter=function(o,n,u,c){o||C.b$.throwException(A.filterNotFound());var f=(0,me.J_)(o),h=new u.TopNFilter(i(f.fieldBeingFiltered,n),f.isTop?"Top":"Bottom",f.itemCount,i(f.orderByField,n));return s(h,c),h.toJSON()},l}(),d=function(){function l(){}return l.serializeFilter=function(o,n,u,c,f){var h;(!o||_.isEmpty(o.conditions()))&&C.b$.throwException(A.filterNotFound());var M,y=new Ge,T=o.conditions()[0].accept(y),g=!T||T.length>1;if((null===(h=f?.featureSwitches)||void 0===h?void 0:h.embedGetIncludeExcludeMultiTargetsFilter)&&g){for(var K=[],w=[],W=[],J=void 0,q=0,he=o?o.where():[];q<he.length;q++){var ee=he[q].condition,se=new We(n,c.filterExpressionMetadata);ee.accept(se),K.push.apply(K,se.dataPoints||[]),J=se.isExclude}for(var te=void 0,ie=0,ye=K;ie<ye.length;ie++){var Q=ye[ie],z=Q.values.map(function(O){return O.keyValues?{value:O.value,keyValues:O.keyValues.map(function($){return $.value})}:{value:O.value}});if(te&&pe.m.sequenceEqual(Q.columns,te))W[W.length-1].push(z);else{var H=Q.columns.map(function(O){return i(O,n)});w.push(H),W.push([z])}te=Q.columns}M=new u.IncludeExcludeFilter(w,J||!1,W)}else J=T[0].isNot,M=new u.IncludeExcludeFilter(i(ee=T[0].fieldExpr,n),J||!1,F.getValuesFromSQExpr(ee,n,o).displayedValues);return s(M,c),M.toJSON()},l}(),E=function(){function l(){}return l.serializeFilter=function(o,n,u,c){var h=(0,de.pi)(o,c.type===N.vA.RelativeDate?I.wj.Date:I.wj.Time),T=i(h?h.field:c.expression,n);T||C.b$.throwException(A.targetNotFound());var R,g=h&&h.options;return c.type===N.vA.RelativeDate?R=l.CreateRelativeDateFilter(T,g,u):c.type===N.vA.RelativeTime?R=l.CreateRelativeTimeFilter(T,g,u):U.fF.assertFail("invalid relative filter type: ".concat(c.type)),s(R,c),R.toJSON()},l.getRelativeDateFilterOperator=function(o,n){var u=o&&o.relativeQualifier;switch(u){case I.KO.Current:return n.RelativeDateOperators.InThis;case I.KO.Next:return n.RelativeDateOperators.InNext;case I.KO.Last:case void 0:return n.RelativeDateOperators.InLast;default:U.fF.assertNever(u)}},l.getRelativeDateFilterTimeUnit=function(o,n){if(!o)return n.RelativeDateFilterTimeUnit.Days;switch(o.relativeUnit){case I.hU.Minute:return n.RelativeDateFilterTimeUnit.Minutes;case I.hU.Hour:return n.RelativeDateFilterTimeUnit.Hours;case I.hU.Day:return n.RelativeDateFilterTimeUnit.Days;case I.hU.Week:return n.RelativeDateFilterTimeUnit.Weeks;case I.hU.CalendarWeek:return n.RelativeDateFilterTimeUnit.CalendarWeeks;case I.hU.Month:return n.RelativeDateFilterTimeUnit.Months;case I.hU.CalendarMonth:return n.RelativeDateFilterTimeUnit.CalendarMonths;case I.hU.Year:return n.RelativeDateFilterTimeUnit.Years;case I.hU.CalendarYear:return n.RelativeDateFilterTimeUnit.CalendarYears;default:U.fF.assertFail("Unsupported relative date unit: ".concat(o.relativeUnit))}},l.getRelativeTimeFilterTimeUnit=function(o,n){if(!o)return n.RelativeDateFilterTimeUnit.Hours;switch(o.relativeUnit){case I.hU.Minute:return n.RelativeDateFilterTimeUnit.Minutes;case I.hU.Hour:return n.RelativeDateFilterTimeUnit.Hours;default:U.fF.assertFail("Unsupported relative time unit: ".concat(o.relativeUnit))}},l.CreateRelativeDateFilter=function(o,n,u){return new u.RelativeDateFilter(o,l.getRelativeDateFilterOperator(n,u),n&&n.duration,l.getRelativeDateFilterTimeUnit(n,u),!(n&&!n.includeToday))},l.CreateRelativeTimeFilter=function(o,n,u){return new u.RelativeTimeFilter(o,l.getRelativeDateFilterOperator(n,u),n&&n.duration,l.getRelativeTimeFilterTimeUnit(n,u))},l}(),F=function(){function l(){}return l.serializeFilter=function(o,n,u,c,f){var g,h=i(n.expression,u),y=o?l.getOperator(u,o,n.expression):"All",T=l.getValuesFromSQExpr(n.expression,u,o,n.cachedValueItems);return(g=T.keyValues&&T.keyValues.length>0?new c.BasicFilterWithKeys(h,y,T.displayedValues,T.keyValues):new c.BasicFilter(h,y,T.displayedValues))||C.b$.throwException(A.basicFilterSerializationError()),s(g,f),g.requireSingleSelection=l.requireSingleSelection(f),g.toJSON()},l.requireSingleSelection=function(o){if(U.fF.assertValue(o,"filterContainer"),!o.objects)return!1;var n=(0,ke.NA)(o.objects,{objectName:"general",propertyName:"requireSingleSelect"},void 0);return!(!n||!n.value)&&b.jz.getBooleanValue(n)},l.getValuesFromSQExpr=function(o,n,u,c){var f={displayedValues:[],keyValues:[]};if(!u)return f;var h,y=l.getSelectedScopeIdsContainerFromFilter(n,u,o);y&&(h=_.isEmpty(y.scopeIds)?[]:y.scopeIds[0]),_.isEmpty(h)&&C.b$.throwException(A.basicFilterSerializationError(V.FilterValuesNotFound));for(var T=0,g=h;T<g.length;T++){var R=g[T];if(o.hasGroupOnKeys(n)){var L=(0,fe.F8)(R).map(function(w){return l.convertValue(w.value)});f.keyValues.push(L),_.isEmpty(c)||c.length!==h.length?C.b$.throwException(A.basicFilterSerializationError(V.FilterValuesNotFound)):f.displayedValues=c.map(function(w){return l.getLabelForGOK(w)})}else{var K=(0,fe.Xz)(R);f.displayedValues.push(l.convertValue(K))}}return f},l.getOperator=function(o,n,u){var c=l.getSelectedScopeIdsContainerFromFilter(o,n,u);if(c)return c.isNot?"NotIn":"In";C.b$.throwException(A.basicFilterOperatorNotFound())},l.getSelectedScopeIdsContainerFromFilter=function(o,n,u){var c=u.getKeyColumns(o);return c||C.b$.throwException(A.fieldExpressionNotFound()),(0,fe.Qq)(n,[c])},l.convertValue=function(o){return _.isDate(o)?o.toISOString():o},l.getLabelForGOK=function(o){return null===o?null:"string"==typeof o?o:o&&o.displayName?o.displayName:void C.b$.throwException(A.invalidDataType("Unrecognized type of value: "+o))},l}(),m=function(){function l(){}return l.serializeFilter=function(o,n,u,c){if(!o)return null;var f,h,y=o.where(),T=y&&y[0]&&y[0].condition;if(!((0,Z.Hi)(T)&&T.values&&T.args&&T.args.length>0))return null;f=T.args,h=T.values;var g,L,R=c.filterExpressionMetadata,M=R&&!_.isEmpty(R.cachedValueItems);if(M&&(L=G.l.findIdentityMapInFilterCache(f,h[0],R)),M&&L){for(var J=[],q=[],he=function(z){var H=L.identities[z],O=new Re.aL;H.expr.accept(O);var $=R.expressions[z],ue=$.getTargetEntity().entity,ve=$.ref;if(1===O.keys.length&&ve===O.keys[0].ref){var k={table:ue,column:ve};q.push(z),J.push(k)}else{k={table:ue,column:ve,keys:[]};for(var Se=function(ht){var Le=ht,yt=Le.getTargetEntity().entity,Ft=Le.ref;U.fF.assert(function(){return yt===ue},"Key column and original column belong to distinct tables"),k.keys.push(Ft),q.push(z)},Y=0,Be=O.keys;Y<Be.length;Y++)Se(Be[Y]);J.push(k)}},le=0;le<L.identities.length;le++)he(le);for(var ee=[],se=function(z){var H=G.l.findIdentityMapInFilterCache(f,z,R);U.fF.assert(function(){return!!H},"Cache entry found for the first tuple and NOT found for one of the subsequent tuples");for(var O=[],$=0;$<H.identities.length;$++)O.push({value:H.valueMap[$]});for(var k=0;k<z.length;k++){var Se=z[k].value,Y=q[k];J[Y].keys&&(O[Y].keyValues||(O[Y].keyValues=[]),O[Y].keyValues.push(Se))}ee.push(O)},te=0,ie=h;te<ie.length;te++)se(ie[te]);g=new u.TupleFilter(J,"In",ee)}else{var w=_.map(f,function(Q){var z=Q.getTargetColumnRef(n);return{table:z.getTargetEntity().entity,column:z.ref}}),W=_.map(h,function(Q){return _.map(Q,function(z){if((0,Z.VC)(z))return{value:z.value};C.b$.throwException(A.tupleFilterSerializationError())})});g=new u.TupleFilter(w,"In",W)}return g||C.b$.throwException(A.tupleFilterSerializationError()),s(g,c),g.toJSON()},l}(),D=function(){function l(){}return l.serializeFilter=function(o,n,u,c){var f=new P(n),h=o.field.accept(f),y=l.getAdvancedFilterLogicalOperator(o.logicalOperator),T=o.conditions.map(function(R){return l.getAdvancedFilterCondition(R)}),g=new u.AdvancedFilter(h,y,T);return g||C.b$.throwException(A.advancedFilterSerializationError()),s(g,c),g.toJSON()},l.getAdvancedFilterExpression=function(o,n){return new Ae.L(n).fromFilterExpr(o)},l.getAdvancedFilterLogicalOperator=function(o){switch(o){case 0:case 2:return"And";case 1:return"Or"}},l.getAdvancedFilterCondition=function(o){var n;(0,xe.AJ)(o.operator)&&(!o.value||!o.value.hasValue)&&C.b$.throwException(A.filterConditionNotFound()),9===o.operator?n="Is":10===o.operator?n="IsNot":3===o.operator?n="GreaterThan":4===o.operator?n="GreaterThanOrEqual":1===o.operator?n="LessThan":2===o.operator?n="LessThanOrEqual":5===o.operator?n="Contains":6===o.operator?n="DoesNotContain":7===o.operator?n="StartsWith":8===o.operator?n="DoesNotStartWith":11===o.operator?n="IsBlank":12===o.operator?n="IsNotBlank":13===o.operator?n="IsEmptyString":14===o.operator?n="IsNotEmptyString":C.b$.throwException(A.filterConditionNotFound());var u=o.value;return{operator:n,value:o.value.isDate?u.value.toISOString():u.value}},l}(),P=function(l){function o(n){var u=l.call(this)||this;return u.schema=n,u}return(0,ae.__extends)(o,l),o.prototype.visitEntity=function(n){return U.fF.assertValue(n,"expr"),{table:n.entity,column:null}},o.prototype.visitPropertyVariationSource=function(n){var u=n.arg.accept(this);return u?{table:u.table,hierarchy:null,hierarchyLevel:null}:null},o.prototype.visitHierarchy=function(n){var u=n.arg.accept(this);return u?{table:u.table,hierarchy:n.hierarchy,hierarchyLevel:null}:null},o.prototype.visitAggr=function(n){var u=n.arg.accept(this);if(!u)return null;var c=u;return c.aggregationFunction=(0,Fe.b)(n.func),c},o.prototype.visitColumnRef=function(n){var u=n.source.accept(this);return u?{table:u.table,column:n.ref}:null},o.prototype.visitMeasureRef=function(n){var u=n.source.accept(this);return u?{table:u.table,measure:n.ref}:null},o.prototype.visitHierarchyLevel=function(n){var u=n.arg.accept(this);return u?{table:u.table,hierarchy:u.hierarchy,hierarchyLevel:n.level}:null},o.prototype.visitGroupRef=function(n){var u=n.source.accept(this);if(!u)return null;for(var c=[],f=0,h=n.groupedExprs;f<h.length;f++){var T=h[f].accept(this);T&&c.push(T)}return{table:u.table,column:n.ref,groupedColumns:c}},o.prototype.visitArithmetic=function(n){if(!(0,Pe.uT)(n,this.schema))return null;var u=n.left.accept(this);return u.percentOfGrandTotal=!0,u},o}(Te.vq);r.SemanticFilterFieldVisitor=P}(ne||(ne={}));var Ee=function(){function r(){}return r.fromInExpr=function(e,t){U.fF.assertValue(e,"inExpr");for(var i=[],a=function(E,F){var m=_.map(e.values,function(D){return D[E]});i.push({fieldExpr:e.args[E],isNot:t,values:pe.m.concatUnique([],m)})},s=0,v=e.args.length;s<v;s++)a(s);return i},r.merge=function(e,t){U.fF.assertValue(e,"leftExprMapping"),U.fF.assertValue(t,"rightExprMapping");for(var i=(0,Je.JG)(e),a=function(F){var m=_.findIndex(i,function(P){return(0,Ve.fS)(P.fieldExpr,F.fieldExpr)&&P.isNot===F.isNot});if(-1!==m){var D=i[m];D.values=pe.m.concatUnique(D.values,F.values)}else i.push(F)},s=0,v=t;s<v.length;s++)a(v[s]);return i},r}(),Ge=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,ae.__extends)(e,r),e.prototype.visitIn=function(t){return Ee.fromInExpr(t)},e.prototype.visitNot=function(t){return t&&t.arg&&10===t.arg.kind?Ee.fromInExpr(t.arg,!0):r.prototype.visitNot.call(this,t,void 0)},e.prototype.visitAnd=function(t){var i=t.left.accept(this),a=t.right.accept(this);if(i&&a)return Ee.merge(i,a)},e}(Te.vq),We=function(r){function e(t,i){var a=r.call(this)||this;return a.schema=t,a.metadata=i,a.dataPoints=[],a.isExclude=!1,a}return(0,ae.__extends)(e,r),e.prototype.visitNot=function(t){this.isExclude=!0,t.arg.accept(this)},e.prototype.visitOr=function(t){t.left.accept(this),t.right.accept(this)},e.prototype.visitIn=function(t){var i,s,a=this;if(!_.isEmpty(t.values)){var v=[],d=t.args,E=[];this.metadata&&!_.isEmpty(this.metadata.expressions)&&(E=this.metadata.expressions.map(function(o){var n=o;return{columnExpr:n,keyColumnsLength:n.hasGroupOnKeys(a.schema)?n.getKeyColumns(a.schema).length:0}}));for(var F=function(n){U.fF.assert(function(){return d.length===n.length},"Columns can't be different from values");var u={columns:[],values:[]},c=G.l.findIdentityMapInFilterCache(d,n,m.metadata);if((null===(s=c?.identities)||void 0===s?void 0:s.length)>0){var f=0;for(var h in c.valueMap){u.columns.push(E[h].columnExpr);var y=E[h].keyColumnsLength;if(y>0){var T=n.slice(f,f+y);u.values.push({value:c.valueMap[h],keyValues:T}),f+=y}else u.values.push({value:n[f].value}),f++}}else for(var g=0;g<n.length;g++)u.values.push({value:n[g].value}),u.columns.push(d[g]);v.push(u)},m=this,D=0,P=t.values;D<P.length;D++)F(P[D]);(i=this.dataPoints).push.apply(i,v||[])}},e}(Te.vq),Ye=p(76001),X=function(){function r(){}return r.prototype.getFilterTarget=function(e,t){return ne.getTarget(e,t)},r.prototype.getTarget=function(e,t,i){if(void 0===i&&(i=!0),!e)return null;var s,a=(0,Ye.Q)(e,t);return a?(a.columnAggr||i&&a.groupingColumnAggr?s=this.getColumnAggrTarget(a):a.hierarchyLevelAggr?s=this.getHierarchyLevelAggrTarget(a):a.measure?s=this.getMeasureTarget(a):a.hierarchyLevel?s=this.getHierarchyLevelTarget(a):a.column&&(s=this.getColumnTarget(a)),s):null},r.prototype.getFieldExpr=function(e,t,i){var a;if(U.fF.assert(function(){return!_.isEmpty(t.schemas)},"schema must contain schemas"),i)a=this.getColumnFieldPattern(e,t,i);else if((0,x.isHierarchyLevelAggr)(e))a=this.getHierarchyLevelAggrFieldPattern(e,t);else if((0,x.isColumnAggr)(e))a=this.getColumnAggrFieldPattern(e,t);else if((0,x.isMeasure)(e))a=this.getMeasureFieldPattern(e,t);else if((0,x.isHierarchyLevel)(e))a=this.getHierarchyLevelFieldPattern(e,t);else{if(!(0,x.isColumn)(e))throw new Error("Invalid or unsupported target");a=this.getColumnFieldPattern(e,t)}return a&&(0,x.isPercentOfGrandTotal)(e)&&(a=this.getPercentOfGrandTotalFieldPattern(a)),(0,Pe.og)(a)},r.prototype.getColumnFieldPattern=function(e,t,i){var a=i||e.column;return{column:{schema:this.getSchemaName(a,e.table,t),entity:e.table,name:a}}},r.prototype.getMeasureFieldPattern=function(e,t){return{measure:{schema:this.getSchemaName(e.measure,e.table,t),entity:e.table,name:e.measure}}},r.prototype.getHierarchyLevelFieldPattern=function(e,t){return{hierarchyLevel:{schema:this.getSchemaName(e.hierarchy,e.table,t,!0),entity:e.table,name:e.hierarchy,level:e.hierarchyLevel}}},r.prototype.getHierarchyLevelAggrFieldPattern=function(e,t){return{hierarchyLevelAggr:{schema:this.getSchemaName(e.hierarchy,e.table,t,!0),entity:e.table,name:e.hierarchy,level:e.hierarchyLevel,aggregate:this.getQueryAggregateFunction(e.aggregationFunction)}}},r.prototype.getColumnAggrFieldPattern=function(e,t){return{columnAggr:{schema:this.getSchemaName(e.column,e.table,t),entity:e.table,name:e.column,aggregate:this.getQueryAggregateFunction(e.aggregationFunction)}}},r.prototype.getPercentOfGrandTotalFieldPattern=function(e){return{percentOfGrandTotal:{baseExpr:e}}},r.prototype.getQueryAggregateFunction=function(e){switch(e){case"Sum":return 0;case"Avg":return 1;case"Count":return 2;case"Min":return 3;case"Max":return 4;case"CountNonNull":return 5;case"Median":return 6;case"StandardDeviation":return 7;case"Variance":return 8;default:U.fF.assert(function(){return!1},"unsupported aggregation function: ".concat(e))}},r.prototype.getColumnTarget=function(e){var t=e.column;return{$schema:"http://powerbi.com/product/schema#column",column:t.name,table:t.entity}},r.prototype.getColumnAggrTarget=function(e,t){void 0===t&&(t=!0);var i=e.columnAggr||t&&e.groupingColumnAggr;return i?{$schema:"http://powerbi.com/product/schema#columnAggr",column:i.name,table:i.entity,aggregationFunction:(0,Fe.b)(i.aggregate)}:null},r.prototype.getMeasureTarget=function(e){var t=e.measure;return{$schema:"http://powerbi.com/product/schema#measure",measure:t.name,table:t.entity}},r.prototype.getHierarchyLevelTarget=function(e){var t=e.hierarchyLevel;return{$schema:"http://powerbi.com/product/schema#hierarchyLevel",hierarchy:t.name,hierarchyLevel:t.level,table:t.entity}},r.prototype.getHierarchyLevelAggrTarget=function(e){var t=e.hierarchyLevelAggr;return{$schema:"http://powerbi.com/product/schema#hierarchyLevelAggr",hierarchy:t.name,hierarchyLevel:t.level,table:t.entity,aggregationFunction:(0,Fe.b)(t.aggregate)}},r.prototype.getSchemaName=function(e,t,i,a){void 0===a&&(a=!1);for(var s=0,v=i.schemas;s<v.length;s++){var d=v[s];if(d.findProperty(t,e)||a&&d.findHierarchy(t,e))return d.name}U.fF.assertFail("propetyName was not found in any Schema")},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)},providedIn:"root"}),r}(),oe=function(){function r(){}return r.prototype.fieldNotFound=function(e){return{name:j.ErrorCodes.FieldNotFound,message:j.ErrorMessages.InvalidTarget+(e?"Target table: "+e.table:"")}},r.prototype.invalidDataType=function(e){return{name:j.ErrorCodes.InvalidDataType,message:(0,De.W)(j.ErrorMessages.InvalidDataTypeMessage,e)}},r.prototype.filterConditionNotFound=function(){return{name:j.ErrorCodes.FilterConditionNotFound,message:j.ErrorMessages.InvalidCondition}},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)},providedIn:"root"}),r}(),Ze=function(){function r(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return r.prototype.tryBuildFilterContainer=function(e,t,i){if((0,x.getFilterType)(i)!==this.getFilterType())return null;var a=i,v=this.jsonTargetParserService.getFieldExpr(a.target,t);v||C.b$.throwException(this.errorProvider.fieldNotFound(a.target));for(var d=[],E=0,F=a.conditions;E<F.length;E++){var D=this.getCondition(F[E]);D&&d.push(D)}var P=v.getMetadata(t),l=P?P.type:null,o=j.logicalOperatorDictionary[a.logicalOperator],n=pe.m.hasMappedMParameter(v,t),u=(0,we.d_)(v,l,d,o,n);return{name:G.l.getNextFilterName(e.filters),expression:v,filter:u?ce.yl.fromSQExpr(u):void 0,type:N.vA.Advanced}},r.prototype.getFilterType=function(){return x.FilterType.Advanced},r.prototype.getCondition=function(e){e||C.b$.throwException(this.errorProvider.filterConditionNotFound());var i,t=j.operatorDictionary[e.operator];return i=_.isString(e.value)&&(0,re.xv)(e.value.substr(0,26))?(0,re.xv)(e.value.substr(0,26)):e.value,new xe.gP(t,i)},r.\u0275fac=function(t){return new(t||r)(S.\u0275\u0275inject(X),S.\u0275\u0275inject(oe))},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),Xe=p(49642),ge=p(89804),qe=p(16699),Ue=p(41640),Oe=p(9380),_e=function(){function r(e,t,i){this.jsonTargetParserService=e,this.errorProvider=t,this.featureSwitchesService=i}return r.prototype.tryBuildFilterContainer=function(e,t,i){if((0,x.getFilterType)(i)!==this.getFilterType())return null;var E,a=i,v={cachedValueItems:[],expressions:[]},d=this.jsonTargetParserService.getFieldExpr(a.target,t);if(d||C.b$.throwException(this.errorProvider.fieldNotFound(a.target)),a.operator!==j.SelectAll){var F=this.getFieldExprsForKeys(a.target,t),m=[],D=0;v.expressions=[d];for(var P=0,l=a.values;P<l.length;P++){var o=l[P],u={identities:[],valueMap:{0:null!=o?o.toString():null}},c=[],f=a.keyValues;if(F&&f)for(var h=0,y=f[D];h<y.length;h++)c.push(this.buildSQConstantExpr(y[h]));else c.push(this.buildSQConstantExpr(o));if(F){var g=(0,ge.Pb)(F,c);u.identities.push(g),v.cachedValueItems.push(u)}m.push(c),D++}var R=(0,Z.ez)(d),M=void 0;if(!F&&R&&this.doesHierarchyLevelExistsOnSchema(t,a.target)){var K=(0,Xe.Zl)((0,qe.u)(this.featureSwitchesService.featureSwitches)).produceIdentities(d,t);M=(0,b.Sh)(K,m)}else M=(0,b.Sh)(F||[d],m);var w;w=a.operator===j.NotIn?(0,b.ff)(M):M,E=ce.yl.fromSQExpr(w)}return{cachedValueItems:(0,ge.cr)(v),name:G.l.getNextFilterName(e.filters),expression:d,filter:E,filterExpressionMetadata:v,type:N.vA.Categorical}},r.prototype.getFilterType=function(){return x.FilterType.Basic},r.prototype.doesHierarchyLevelExistsOnSchema=function(e,t){if(!(t&&t.table&&t.hierarchy&&t.hierarchyLevel))return!1;for(var i=0,a=e.schemas;i<a.length;i++)if(a[i].findHierarchyLevel(t.table,t.hierarchy,t.hierarchyLevel))return!0;return!1},r.prototype.buildSQConstantExpr=function(e){var t;if(_.isString(e))if(null!=(0,re.xv)(e.substr(0,26))){var i=(0,re.xv)(e.substr(0,26));t=(0,b.CQ)(i)}else t=(0,b.fL)(e);else _.isBoolean(e)?t=(0,b.O7)(e):_.isNumber(e)?t=(0,Ue.U)(e)?(0,b.cA)(e):(0,b.tx)(e):null===e?t=(0,b.IF)():C.b$.throwException(this.errorProvider.invalidDataType(e));return t},r.prototype.getFieldExprsForKeys=function(e,t){var i=this;return e&&e.keys?_.map(e.keys,function(s){return i.jsonTargetParserService.getFieldExpr(e,t,s)}):null},r.\u0275fac=function(t){return new(t||r)(S.\u0275\u0275inject(X),S.\u0275\u0275inject(oe),S.\u0275\u0275inject(Oe.vZ))},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),et=function(){function r(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return r.prototype.tryBuildFilterContainer=function(e,t,i){if((0,x.getFilterType)(i)!==this.getFilterType())return null;var a=i,s=this.jsonTargetParserService.getFieldExpr(i.target,t),v=this.jsonTargetParserService.getFieldExpr(a.orderBy,t);if(!s||!v)throw C.b$.throwException(this.errorProvider.fieldNotFound(i.target)),{};var E=(0,me.VK)({fieldBeingFiltered:s,isTop:"Top"===a.operator,itemCount:a.itemCount,orderByField:v});return{name:G.l.getNextFilterName(e.filters),expression:s,filter:E,type:N.vA.TopN}},r.prototype.getFilterType=function(){return x.FilterType.TopN},r.\u0275fac=function(t){return new(t||r)(S.\u0275\u0275inject(X),S.\u0275\u0275inject(oe))},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),Me=function(){function r(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return r.prototype.tryBuildFilterContainer=function(e,t,i){return(0,x.getFilterType)(i)!==this.getFilterType()?null:(null!=i.timeUnitsCount&&(v=(0,de.nh)(this.createRelativeFilterParameters(i,t))),{name:G.l.getNextFilterName(e.filters),expression:this.jsonTargetParserService.getFieldExpr(i.target,t),filter:v,type:this.getContractFilterType()});var v},r.prototype.createRelativeFilterParameters=function(e,t){var i=this.jsonTargetParserService.getFieldExpr(e.target,t);return i||C.b$.throwException(this.errorProvider.fieldNotFound(e.target)),{field:i,options:{duration:e.timeUnitsCount,includeToday:e&&(e.includeToday||e.filterType===x.FilterType.RelativeTime),relativeQualifier:this.translateToRelativeQualifierEnum(e.operator),relativeUnit:this.translateToRelativeFilterUnitEnum(e.timeUnitType)}}},r.prototype.translateToRelativeQualifierEnum=function(e){switch(e){case x.RelativeDateOperators.InLast:return I.KO.Last;case x.RelativeDateOperators.InThis:return I.KO.Current;case x.RelativeDateOperators.InNext:return I.KO.Next;default:return void U.fF.assertFail("Unexpected RelativeDateOperator: "+e)}},r}(),tt=function(r){function e(t,i){return r.call(this,t,i)||this}return(0,ae.__extends)(e,r),e.prototype.translateToRelativeFilterUnitEnum=function(t){switch(t){case x.RelativeDateFilterTimeUnit.Days:return I.hU.Day;case x.RelativeDateFilterTimeUnit.Weeks:return I.hU.Week;case x.RelativeDateFilterTimeUnit.CalendarWeeks:return I.hU.CalendarWeek;case x.RelativeDateFilterTimeUnit.Months:return I.hU.Month;case x.RelativeDateFilterTimeUnit.CalendarMonths:return I.hU.CalendarMonth;case x.RelativeDateFilterTimeUnit.Years:return I.hU.Year;case x.RelativeDateFilterTimeUnit.CalendarYears:return I.hU.CalendarYear;default:return void U.fF.assertFail("Unexpected RelativeDateFilterTimeUnit: "+t)}},e.prototype.getFilterType=function(){return x.FilterType.RelativeDate},e.prototype.getContractFilterType=function(){return N.vA.RelativeDate},e.\u0275fac=function(i){return new(i||e)(S.\u0275\u0275inject(X),S.\u0275\u0275inject(oe))},e.\u0275prov=S.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(Me),rt=function(r){function e(t,i){return r.call(this,t,i)||this}return(0,ae.__extends)(e,r),e.prototype.translateToRelativeFilterUnitEnum=function(t){switch(t){case x.RelativeDateFilterTimeUnit.Minutes:return I.hU.Minute;case x.RelativeDateFilterTimeUnit.Hours:return I.hU.Hour;default:return void U.fF.assertFail("Unexpected RelativeDateFilterTimeUnit: "+t)}},e.prototype.getContractFilterType=function(){return N.vA.RelativeTime},e.prototype.getFilterType=function(){return x.FilterType.RelativeTime},e.\u0275fac=function(i){return new(i||e)(S.\u0275\u0275inject(X),S.\u0275\u0275inject(oe))},e.\u0275prov=S.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(Me),be=function(){function r(e,t,i,a,s){this.filterContainerBuilders=[e,t,i,a,s]}return r.prototype.tryBuildFilterContainer=function(e,t,i){for(var a=0,s=this.filterContainerBuilders;a<s.length;a++){var d=s[a].tryBuildFilterContainer(e,t,i);if(d)return d}},r.\u0275fac=function(t){return new(t||r)(S.\u0275\u0275inject(Ze),S.\u0275\u0275inject(_e),S.\u0275\u0275inject(et),S.\u0275\u0275inject(tt),S.\u0275\u0275inject(rt))},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),it=p(78843),at=p(58295);function nt(r,e,t){if(!r)return null;var i=r.where(),a=i&&i[0]&&i[0].condition;return(0,Z.Hi)(a)&&a.values&&a.args&&(a.args.length>1||1===a.args.length&&function(r,e,t){if(!(0,Z.VC)(e)||!t||_.isEmpty(t.cachedValueItems))return!1;for(var i=0,a=t.cachedValueItems;i<a.length;i++){var s=a[i];if(1===s.identities.length){var v=new Re.aL;if(s.identities[0].expr.accept(v),1===v.keys.length&&(0,Ve.fS)(r,v.keys[0])&&e.value===v.values[0].value)return!0}}return!1}(a.args[0],a.values[0][0],t)||1===a.values.length&&((0,at.k)(a)||(0,Z.ez)(a.args[0]))||1===a.args.length&&a.values.length>2&&(0,Z.ez)(a.args[0]))?{args:a.args,values:a.values}:null}var lt=p(3222),st=p(32379),ze=p(75600),ut=p(98665),vt=p(65181),ct=function(){function r(e,t,i,a,s){this.telemetryService=e,this.jsonTargetParserService=t,this.filterContainerProvider=i,this.featureSwitchService=a,this.localizationService=s,this.advancedFilterCardConverter=new Ae.L(s)}return r.prototype.tryCreateSemanticFilter=function(e,t,i){var s=this.tryCreateFilterContainer({filters:[{name:e}]},t,i);if(s)return s.filter},r.prototype.tryCreateJSONFilter=function(e,t,i){var a=ce.yl.unmerge(e);if(_.isEmpty(a))return[];for(var s=[],v=0,d=a;v<d.length;v++){var E=d[v],F={name:"filter",filter:E},m=!1;if(m||(0,me.J_)(E)&&(F.type=N.vA.TopN,m=!0),m||(0,de.pi)(E,I.wj.Date)&&(F.type=N.vA.RelativeDate,m=!0),m||(0,de.pi)(E,I.wj.Time)&&(F.type=N.vA.RelativeTime,m=!0),m||nt(E,0,i)&&(F.type=N.vA.Tuple,F.filterExpressionMetadata=i,m=!0),!m){var o=this.advancedFilterCardConverter.fromFilterExpr(E.conditions()[0]);o&&(F.type=G.l.getFilterType(o.field,o.supportsCategorical),F.expression=o.field,m=!0)}if(!m)return null;s.push(F)}return this.tryGetFilters({filters:s},t)},r.prototype.getVisualsInfo=function(e){var t=this;return e.map(function(i){return t.getVisualInfo(i.name,null,i.config.singleVisual.visualType)})},r.prototype.tryCreateFilterContainer=function(e,t,i){try{return this.constructFilterContainer(e,t,i)}catch(a){return A.traceError(a),null}},r.prototype.tryConvertJsonFilterArrayToFilterDataArray=function(e,t,i){try{return this.convertJsonFilterArrayToFilterDataArray(e,t,i)}catch(a){A.traceError(a)}return null},r.prototype.tryGetFilters=function(e,t){var i=this;if(!e.filters||0===e.filters.length)return[];try{return e.filters.map(function(a){return ne.fromSemanticFilter(a,t,a.filter,x,i.telemetryService,i.localizationService,i.featureSwitchService)})}catch(a){throw A.traceError(a),void 0!==a.message?{message:a.message}:{message:V.FilterSerializationError}}},r.prototype.getReportAndPageInfo=function(e){return{report:this.getReportInfo(e),page:this.getActivePageInfo(e),visual:null,dataPoints:null,regions:null,filters:null}},r.prototype.tryCreateDataViewScopeIdentityFromExpr=function(e,t){try{for(var i=[],a=0,s=t;a<s.length;a++)i.push(this.buildSQConstantExpr(s[a]));return(0,it.TZ)((0,lt.R)(e,i))}catch{return null}},r.prototype.tryGetSelectedDataPoints=function(e,t,i,a,s){if(!a||!a.config||!a.config.singleVisual)throw{message:V.DataPointSerializationError};var v=a.config.singleVisual;try{var d=this.tryGetFilters(a,t);return{report:this.getReportInfo(e),page:this.getActivePageInfo(e),visual:this.getVisualInfo(a.name,s,v.visualType),dataPoints:this.getDataPoints(i,t),regions:null,filters:d}}catch(E){throw A.traceError(E),void 0!==E.message?{message:E.message}:{message:V.DataPointSerializationError}}},r.prototype.getValues=function(e,t){var i=this;if(!e)return[];var s=_.filter(e,function(v){return""!==v.value});return _.map(s,function(v){return{target:i.jsonTargetParserService.getTarget(v.expr,t),value:v.value,formattedValue:v.formattedValue}})},r.prototype.getDataPoints=function(e,t){var i=[];if(_.isEmpty(e))return i;for(var a=0,s=e;a<s.length;a++){var v=s[a],d={identity:[],values:this.getValues(v.values,t)},E=(0,st.gU)(v.selector);if(E)for(var F=new ne.SemanticFilterFieldVisitor(t),m=0,D=E;m<D.length;m++){var P=D[m];if(P.expr){var o=(0,fe.F8)(P);if(!o)return i;for(var n=function(y){U.fF.assert(function(){return null!=y.expr},"comparand.expr is null");var T=y.expr.accept(F);d.identity.push({target:T,equals:y.value})},u=0,c=o;u<c.length;u++)n(c[u])}}i.push(d)}return i},r.prototype.getReportInfo=function(e){return(!e||null==e.activeSectionIndex)&&C.b$.throwException(A.invalidReportData()),e.report&&{id:e.report.objectId,displayName:e.report.displayName}},r.prototype.getActivePageInfo=function(e){(!e||null==e.activeSectionIndex)&&C.b$.throwException(A.invalidPageData());var t=e.sections[e.activeSectionIndex];return{name:t.name,displayName:t.displayName}},r.prototype.getVisualInfo=function(e,t,i){var a={name:e,type:i};return t&&(a.title=t),a},r.prototype.constructFilterContainer=function(e,t,i){var a=this.validateFilter(i);a&&C.b$.throwException(A.filterValidationErrors(a));var s=this.filterContainerProvider.tryBuildFilterContainer(e,t,i);return this.updateFilterDisplaySettings(s,i.displaySettings),s},r.prototype.updateFilterDisplaySettings=function(e,t){e&&t&&(e.isLockedInViewMode=t.isLockedInViewMode,e.isHiddenInViewMode=t.isHiddenInViewMode,e.displayName=t.displayName)},r.prototype.getTupleElementTargetExpressions=function(e,t){var i=this.jsonTargetParserService.getFieldExpr(e,t);return i||C.b$.throwException(A.fieldNotFound(e)),this.getFieldExprsForKeys(e,t)||[i]},r.prototype.getTupleElementTargetKeyExpressions=function(e,t){return this.getFieldExprsForKeys(e,t)||[]},r.prototype.getTupleElementTargetNonKeyExpression=function(e,t){var i=this.jsonTargetParserService.getFieldExpr(e,t);return i||C.b$.throwException(A.fieldNotFound(e)),i},r.prototype.getTupleTargetExpressions=function(e,t){for(var i=[],a=0,s=e;a<s.length;a++)i=i.concat(this.getTupleElementTargetExpressions(s[a],t));return i},r.prototype.getTupleElementValueExpressions=function(e){var t=[];if(e.keyValues)for(var i=0,a=e.keyValues;i<a.length;i++)t.push(this.buildSQConstantExpr(a[i]));else t.push(this.buildSQConstantExpr(e.value));return t},r.prototype.getTupleElementKeyValueExpressions=function(e){var t=[];if(e.keyValues)for(var i=0,a=e.keyValues;i<a.length;i++)t.push(this.buildSQConstantExpr(a[i]));return t},r.prototype.getTupleElementNonKeyValueExpression=function(e){return this.buildSQConstantExpr(e.value)},r.prototype.getTupleValueExpressions=function(e){for(var t=[],i=0,a=e;i<a.length;i++)t=t.concat(this.getTupleElementValueExpressions(a[i]));return t},r.prototype.convertJsonFilterArrayToFilterDataArray=function(e,t,i){var a=this;return _.isEmpty(e)?[]:_.map(e,function(s){return a.convertJsonFilterToFilterData(s,t,i)})},r.prototype.convertJsonFilterToFilterData=function(e,t,i){var a={filter:null,type:null,filterExpressionMetadata:null,displayName:null};if(e)if(e.filterType===x.FilterType.Tuple)a.type=N.vA.Tuple,a.filter=this.convertJsonTupleFilterToSemanticFilter(e,t),a.filterExpressionMetadata=this.extractFilterExpressionMetadataFromJsonTupleFilter(e,t);else if((0,ze.yL)(e)){if(i){var s=(0,ze.Xx)(e,i.columns,i.filterExpressionMetadata);a.filter=s.filter,a.filterExpressionMetadata=s.filterExpressionMetadata}}else{var d=this.constructFilterContainer({filters:[{name:"Filter"}]},t,e);a.filter=d&&d.filter}return a},r.prototype.convertJsonTupleFilterToSemanticFilter=function(e,t){for(var i=this.getTupleTargetExpressions(e.target,t),a=[],s=0,v=e.values;s<v.length;s++)a.push(this.getTupleValueExpressions(v[s]));var E=(0,b.Sh)(i,a);return ce.yl.fromSQExpr(E)},r.prototype.extractFilterExpressionMetadataFromJsonTupleFilter=function(e,t){var i={expressions:[],cachedValueItems:[]};return this.populateFilterExpressionMetadata(i,e,t),i},r.prototype.populateFilterExpressionMetadata=function(e,t,i){var a=this;if(_.find(t.target,function(c){return!_.isEmpty(a.getTupleElementTargetKeyExpressions(c,i))})){var s=_.map(t.target,function(c){return a.getTupleElementTargetKeyExpressions(c,i)});e.expressions=_.map(t.target,function(c){return a.getTupleElementTargetNonKeyExpression(c,i)});for(var v=0,d=t.values;v<d.length;v++){for(var E=d[v],F={identities:[],valueMap:{}},m=0;m<t.target.length;m++){var D=E[m];_.isString(D.value)?F.valueMap[m]=D.value:C.b$.throwException(A.invalidDataType(D.value));var P=void 0;if(_.isEmpty(s[m])){var l=this.getTupleElementNonKeyValueExpression(D);P=(0,ge.Pb)([e.expressions[m]],[l])}else{var n=this.getTupleElementKeyValueExpressions(D);P=(0,ge.Pb)(s[m],n)}F.identities.push(P)}e.cachedValueItems.push(F)}}},r.prototype.getFieldExprsForKeys=function(e,t){var i=this;return e&&e.keys?_.map(e.keys,function(s){return i.jsonTargetParserService.getFieldExpr(e,t,s)}):null},r.prototype.buildSQConstantExpr=function(e){var t;if(_.isString(e))if(null!=(0,re.xv)(e.substr(0,26))){var i=(0,re.xv)(e.substr(0,26));t=(0,b.CQ)(i)}else t=(0,b.fL)(e);else _.isBoolean(e)?t=(0,b.O7)(e):_.isNumber(e)?t=(0,Ue.U)(e)?(0,b.cA)(e):(0,b.tx)(e):null===e?t=(0,b.IF)():C.b$.throwException(A.invalidDataType(e));return t},r.prototype.validateFilter=function(e){return(0,x.validateFilter)(e)},r.\u0275fac=function(t){return new(t||r)(S.\u0275\u0275inject(ut.y0),S.\u0275\u0275inject(X),S.\u0275\u0275inject(be),S.\u0275\u0275inject(Oe.vZ),S.\u0275\u0275inject(vt.o))},r.\u0275prov=S.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),pt=p(77476),ft=[{provide:"jsonTargetParserService",useClass:X},{provide:"filterContainerProvider",useClass:be},{provide:"jsonFilterParserModern",useClass:ct}],dt=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=S.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=S.\u0275\u0275defineInjector({providers:ft,imports:[pt.CommonModule]}),r}()}}]);