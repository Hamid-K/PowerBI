"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["schema-validator"],{73566:function(H,I,o){o.d(I,{E:function(){return f}});var F=o(77476),w=o(9398),O=o(82156),c=o(8483),D=o(50423),f=function(){function p(){}return p.\u0275fac=function(X){return new(X||p)},p.\u0275mod=D.\u0275\u0275defineNgModule({type:p}),p.\u0275inj=D.\u0275\u0275defineInjector({imports:[F.CommonModule,O.N,w.Bz.forChild(c.Vc)]}),p}()},8483:function(H,I,o){o.d(I,{Vc:function(){return D},yO:function(){return O}});var F=o(50423),w=o(76072),O=new F.InjectionToken("JsonSchemaValidationService"),c={loadChildren:function(){return o.e("json-schema-validation-lazy").then(o.bind(o,98909)).then(function(p){return p.JsonSchemaValidationLazyModule})}};w.E.addLazyLoadForLegacyMapping("@powerbi/JsonSchemaValidation/lazy/json-schema-validation-lazy-module#JsonSchemaValidationLazyModule",c.loadChildren);var D=[{path:"dummy-json-schema-validation-lazy",loadChildren:c.loadChildren}]},36731:function(H,I,o){o.d(I,{D:function(){return F}});var F={allErrors:!0,verbose:!0,allowUnionTypes:!0,validateSchema:"log"}},7256:function(H,I,o){o.r(I),o.d(I,{ReportDefinitionSchemaValidatorModule:function(){return ze}});var F=o(77476),w=o(73566),O=o(82156),c=o(81337),D=o(36731),f=o(38504),p=function(t){return t.Bookmark="bookmark",t.BookmarksMetadata="bookmarksMetadata",t.FormattingObjectDefinitions="formattingObjectDefinitions",t.Page="page",t.PagesMetadata="pagesMetadata",t.ReportExtension="reportExtension",t.Report="report",t.SemanticQuery="semanticQuery",t.VersionMetadata="versionMetadata",t.VisualContainerMobileState="visualContainerMobileState",t.VisualContainer="visualContainer",t}({}),Z=[1],X=[1],ne=[1],oe=[1],se=[1],le=[1],ce=[1],pe=[1],ue=[1];function j(t,e){return e.includes(t)}function M(t){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(a){switch(a.label){case 0:return 1===t.majorVersion?[3,1]:[3,24];case 1:switch(t.type){case p.Bookmark:return[3,2];case p.BookmarksMetadata:return[3,4];case p.FormattingObjectDefinitions:return[3,6];case p.Page:return[3,8];case p.PagesMetadata:return[3,10];case p.ReportExtension:return[3,12];case p.Report:return[3,14];case p.SemanticQuery:return[3,16];case p.VersionMetadata:return[3,18];case p.VisualContainerMobileState:return[3,20];case p.VisualContainer:return[3,22]}return[3,24];case 2:return[4,o.e("schema.json").then(o.t.bind(o,61811,19))];case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:return[2,a.sent()];case 4:return[4,o.e("schema.json.0").then(o.t.bind(o,60378,19))];case 6:return[4,o.e("schema.json.1").then(o.t.bind(o,86891,19))];case 8:return[4,o.e("schema.json.2").then(o.t.bind(o,9590,19))];case 10:return[4,o.e("schema.json.3").then(o.t.bind(o,81938,19))];case 12:return[4,o.e("schema.json.4").then(o.t.bind(o,50339,19))];case 14:return[4,o.e("schema.json.5").then(o.t.bind(o,75774,19))];case 16:return[4,o.e("schema.json.6").then(o.t.bind(o,33959,19))];case 18:return[4,o.e("schema.json.7").then(o.t.bind(o,90836,19))];case 20:return[4,o.e("schema.json.8").then(o.t.bind(o,41605,19))];case 22:return[4,o.e("schema.json.9").then(o.t.bind(o,91139,19))];case 24:throw Error("Error major version ".concat(t.majorVersion," of ").concat(t.type," schema not found!"))}})})}function Q(t,e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,c.__generator)(this,function(i){switch(i.label){case 0:return[4,M({type:p.SemanticQuery,majorVersion:t})];case 1:return r=i.sent(),[4,M({type:p.FormattingObjectDefinitions,majorVersion:e})];case 2:return a=i.sent(),[2,(0,c.__assign)({schemas:[r,a]},D.D)]}})})}function E(t,e){return{filePath:t,keyword:f.VL.InvalidMajorVersion,params:{InvalidMajorVersionError:e},level:f.qB.Error,type:f.ER}}var de=[f.VL.AdditionalProperties];function R(t,e){if(!e.isValid&&!_.isEmpty(e.errors)){for(var r=[],a=0,i=e.errors;a<i.length;a++){var n=i[a];if("string"==typeof n)r.push({filePath:t,keyword:"error",params:{error:n},level:f.qB.Error,type:f.ER});else{if(n.keyword===f.VL.OneOf){var l=n.schema.map(function(s){return s.required});n.params.fields=l.join(",")}r.push({filePath:t,keyword:n.keyword,instancePath:n.instancePath,params:n.params,level:de.includes(n.keyword)?f.qB.Warning:f.qB.Error,type:f.ER})}}return r}}var ve=o(16374),q=o(62458),ee="https://developer.microsoft.com/json-schemas/fabric/item/report/definition";function b(t){return(0,ve.OA)(t)}function x(t){var r=new RegExp("^".concat(ee,"/(?<item>[^/]+)/(?<version>[^/]+)/schema.json$")).exec(t);q.fF.assert(function(){return null!=r},"Schema URL does not match expected format");var a=r.groups,i=a.item,n=a.version;return q.fF.assert(function(){return/^(\d+\.){2}\d+$/.test(n)},"Version is not in the expected format"),{item:i,version:n}}var u=o(50423),me=o(76072),he=o(8483),z=function(){function t(){this.lazyProvider=(0,u.inject)(me.E)}return t.prototype.registerSchema=function(e,r,a){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getService()];case 1:return n.sent().registerSchema(e,r,a),[2]}})})},t.prototype.validate=function(e,r,a){return(0,c.__awaiter)(this,void 0,void 0,function(){var i;return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getService()];case 1:return i=n.sent(),"string"==typeof e?[2,i.validate(e,r)]:[2,i.validate(e,r,a)]}})})},t.prototype.getService=function(){return this.servicePromise||(this.servicePromise=this.lazyProvider.get("@powerbi/JsonSchemaValidation/lazy/json-schema-validation-lazy-module#JsonSchemaValidationLazyModule",he.yO)),this.servicePromise},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac=function(r){return new(r||t)},providedIn:"root"}),t}(),fe=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,l,s,g,m;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,Z)?[4,M({type:p.Bookmark,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return l=d.sent(),[4,Q((s={semanticQueryVersion:1,formattingObjectDefinitionsMajorVersion:1}).semanticQueryVersion,s.formattingObjectDefinitionsMajorVersion)];case 2:return g=d.sent(),[4,this.jsonSchemaValidationService.registerSchema(l.$id,l,g)];case 3:return d.sent(),[4,this.jsonSchemaValidationService.validate(l.$id,e.content)];case 4:return m=d.sent(),[2,R(e.filePath,m)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),Ce=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,n,l;return(0,c.__generator)(this,function(s){switch(s.label){case 0:return r=x(e.wireContract.$schema).version,j(a=b(r).major,X)?[4,M({type:p.BookmarksMetadata,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return n=s.sent(),[4,this.jsonSchemaValidationService.registerSchema(n.$id,n)];case 2:return s.sent(),[4,this.jsonSchemaValidationService.validate(n.$id,e.wireContract)];case 3:return l=s.sent(),[2,R(e.filePath,l)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),re="visuals";new RegExp("^".concat(re,"/(.+)/").concat("visual.json","$"),"g"),new RegExp("^".concat(re,"/(.+)/").concat("mobile.json","$"),"g");var Pe=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,l,s,g,m;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,pe)?[4,M({type:p.VisualContainerMobileState,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return l=d.sent(),[4,Q((s={semanticQueryVersion:1,formattingObjectDefinitionsMajorVersion:1}).semanticQueryVersion,s.formattingObjectDefinitionsMajorVersion)];case 2:return g=d.sent(),[4,this.jsonSchemaValidationService.registerSchema(l.$id,l,g)];case 3:return d.sent(),[4,this.jsonSchemaValidationService.validate(l.$id,e.content)];case 4:return m=d.sent(),[2,R(e.filePath,m)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),be=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,l,s,g,m;return(0,c.__generator)(this,function(d){switch(d.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,ue)?[4,M({type:p.VisualContainer,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return l=d.sent(),[4,Q((s={semanticQueryVersion:1,formattingObjectDefinitionsMajorVersion:1}).semanticQueryVersion,s.formattingObjectDefinitionsMajorVersion)];case 2:return g=d.sent(),[4,this.jsonSchemaValidationService.registerSchema(l.$id,l,g)];case 3:return d.sent(),[4,this.jsonSchemaValidationService.validate(l.$id,e.content)];case 4:return m=d.sent(),[2,R(e.filePath,m)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),ye=function(){function t(e,r,a){this.visualContainerMobileStateSchemaValidatorService=e,this.visualContainerSchemaValidatorService=r,this.jsonSchemaValidationService=a}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,i,s,g,m,d,P,C,y,V,S;return(0,c.__generator)(this,function(h){switch(h.label){case 0:return r=[],a=x(e.content.$schema).version,j(i=b(a).major,ne)?[4,M({type:p.Page,majorVersion:i})]:[2,[E(e.filePath,i)]];case 1:return s=h.sent(),[4,Q((g={semanticQueryVersion:1,formattingObjectDefinitionsMajorVersion:1}).semanticQueryVersion,g.formattingObjectDefinitionsMajorVersion)];case 2:return m=h.sent(),[4,this.jsonSchemaValidationService.registerSchema(s.$id,s,m)];case 3:return h.sent(),[4,this.jsonSchemaValidationService.validate(s.$id,e.content)];case 4:if(d=h.sent(),P=R(e.filePath,d),_.isEmpty(P)||r.push.apply(r,P),!e.visualContainers)return[3,11];C=0,y=e.visualContainers,h.label=5;case 5:return C<y.length?(S=void 0,function(t){var e=t.$schema,r=function(t){return"".concat(ee,"/").concat(t)}("visualContainerMobileState");return e.startsWith(r)}((V=y[C]).content)?[4,this.visualContainerMobileStateSchemaValidatorService.validate(V)]:[3,7]):[3,11];case 6:return S=h.sent(),[3,9];case 7:return[4,this.visualContainerSchemaValidatorService.validate(V)];case 8:S=h.sent(),h.label=9;case 9:_.isEmpty(S)||r.push.apply(r,S),h.label=10;case 10:return C++,[3,5];case 11:return[2,r]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(Pe),u.\u0275\u0275inject(be),u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),je=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,n,l;return(0,c.__generator)(this,function(s){switch(s.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,oe)?[4,M({type:p.PagesMetadata,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return n=s.sent(),[4,this.jsonSchemaValidationService.registerSchema(n.$id,n)];case 2:return s.sent(),[4,this.jsonSchemaValidationService.validate(n.$id,e.content)];case 3:return l=s.sent(),[2,R(e.filePath,l)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),Ee=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,n,l;return(0,c.__generator)(this,function(s){switch(s.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,se)?[4,M({type:p.ReportExtension,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return n=s.sent(),[4,this.jsonSchemaValidationService.registerSchema(n.$id,n)];case 2:return s.sent(),[4,this.jsonSchemaValidationService.validate(n.$id,e.content)];case 3:return l=s.sent(),[2,R(e.filePath,l)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),Re=function(){function t(e){this.jsonSchemaValidationService=e}return t.prototype.validate=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var r,a,n,l;return(0,c.__generator)(this,function(s){switch(s.label){case 0:return r=x(e.content.$schema).version,j(a=b(r).major,ce)?[4,M({type:p.VersionMetadata,majorVersion:a})]:[2,[E(e.filePath,a)]];case 1:return n=s.sent(),[4,this.jsonSchemaValidationService.registerSchema(n.$id,n)];case 2:return s.sent(),[4,this.jsonSchemaValidationService.validate(n.$id,e.content)];case 3:return l=s.sent(),[2,R(e.filePath,l)]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(z))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),xe=function(){function t(e,r,a,i,n,l,s){this.bookmarkSchemaValidatorService=e,this.bookmarksMetadataSchemaValidatorService=r,this.jsonSchemaValidationService=a,this.pageSchemaValidatorService=i,this.pagesMetadataSchemaValidatorService=n,this.reportExtensionSchemaValidatorService=l,this.versionMetadataSchemaValidatorService=s}return t.prototype.validate=function(e,r){return(0,c.__awaiter)(this,void 0,void 0,function(){var a,i,n,l,s,d,P,C,y,V,S,h,A,B,$,k,W,U,N;return(0,c.__generator)(this,function(v){switch(v.label){case 0:return a=r?.createChildActivity({name:"ReportSchemaValidationStep"}),i=[],[4,this.versionMetadataSchemaValidatorService.validate(e.version)];case 1:return n=v.sent(),_.isEmpty(n)||i.push.apply(i,n),l=x(e.report.content.$schema).version,j(s=b(l).major,le)?[4,M({type:p.Report,majorVersion:s})]:[2,[E(e.report.filePath,s)]];case 2:return d=v.sent(),[4,Q((P={semanticQueryVersion:1,formattingObjectDefinitionsMajorVersion:1}).semanticQueryVersion,P.formattingObjectDefinitionsMajorVersion)];case 3:return C=v.sent(),[4,this.jsonSchemaValidationService.registerSchema(d.$id,d,C)];case 4:return v.sent(),[4,this.jsonSchemaValidationService.validate(d.$id,e.report.content)];case 5:return y=v.sent(),V=R(e.report.filePath,y),_.isEmpty(V)||i.push.apply(i,V),e.reportExtensions?[4,this.reportExtensionSchemaValidatorService.validate(e.reportExtensions)]:[3,7];case 6:S=v.sent(),_.isEmpty(S)||i.push.apply(i,S),v.label=7;case 7:return e.bookmarks?[4,this.bookmarksMetadataSchemaValidatorService.validate({wireContract:e.bookmarks.content,filePath:e.bookmarks.filePath})]:[3,12];case 8:h=v.sent(),_.isEmpty(h)||i.push.apply(i,h),A=0,B=e.bookmarks.bookmarks,v.label=9;case 9:return A<B.length?[4,this.bookmarkSchemaValidatorService.validate(B[A])]:[3,12];case 10:$=v.sent(),_.isEmpty($)||i.push.apply(i,$),v.label=11;case 11:return A++,[3,9];case 12:return e.pages.pagesMetadata?[4,this.pagesMetadataSchemaValidatorService.validate(e.pages.pagesMetadata)]:[3,14];case 13:k=v.sent(),_.isEmpty(k)||i.push.apply(i,k),v.label=14;case 14:W=0,U=e.pages.pages,v.label=15;case 15:return W<U.length?[4,this.pageSchemaValidatorService.validate(U[W])]:[3,18];case 16:N=v.sent(),_.isEmpty(N)||i.push.apply(i,N),v.label=17;case 17:return W++,[3,15];case 18:return a?.setProperty("errorCodes",_.map(i,function(T){return JSON.stringify(T)})),a?.resolve(),[2,i]}})})},t.\u0275fac=function(r){return new(r||t)(u.\u0275\u0275inject(fe),u.\u0275\u0275inject(Ce),u.\u0275\u0275inject(z),u.\u0275\u0275inject(ye),u.\u0275\u0275inject(je),u.\u0275\u0275inject(Ee),u.\u0275\u0275inject(Re))},t.\u0275prov=u.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),_e=o(61032),ze=function(){function t(){}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=u.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=u.\u0275\u0275defineInjector({providers:[O.N.withLazyService(_e.ED,xe)],imports:[F.CommonModule,O.N,w.E]}),t}()}}]);