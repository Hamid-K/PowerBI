(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["dataflow-gen2-publish-error"],{77489:function(ge){ge.exports=function(q,de){(null==de||de>q.length)&&(de=q.length);for(var Fe=0,Q=new Array(de);Fe<de;Fe++)Q[Fe]=q[Fe];return Q},ge.exports.default=ge.exports,ge.exports.__esModule=!0},32878:function(ge){function qe(de,Fe){for(var Q=0;Q<Fe.length;Q++){var Z=Fe[Q];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(de,Z.key,Z)}}ge.exports=function(de,Fe,Q){return Fe&&qe(de.prototype,Fe),Q&&qe(de,Q),de},ge.exports.default=ge.exports,ge.exports.__esModule=!0},34850:function(ge,qe,q){var de=q(91052);ge.exports=function(Q,Z){var ye=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(ye)return(ye=ye.call(Q)).next.bind(ye);if(Array.isArray(Q)||(ye=de(Q))||Z&&Q&&"number"==typeof Q.length){ye&&(Q=ye);var L=0;return function(){return L>=Q.length?{done:!0}:{done:!1,value:Q[L++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},ge.exports.default=ge.exports,ge.exports.__esModule=!0},12864:function(ge,qe,q){var de=q(74);ge.exports=function(Q,Z){Q.prototype=Object.create(Z.prototype),Q.prototype.constructor=Q,de(Q,Z)},ge.exports.default=ge.exports,ge.exports.__esModule=!0},74:function(ge){function qe(q,de){return ge.exports=qe=Object.setPrototypeOf||function(Q,Z){return Q.__proto__=Z,Q},ge.exports.default=ge.exports,ge.exports.__esModule=!0,qe(q,de)}ge.exports=qe,ge.exports.default=ge.exports,ge.exports.__esModule=!0},91052:function(ge,qe,q){var de=q(77489);ge.exports=function(Q,Z){if(Q){if("string"==typeof Q)return de(Q,Z);var ye=Object.prototype.toString.call(Q).slice(8,-1);if("Object"===ye&&Q.constructor&&(ye=Q.constructor.name),"Map"===ye||"Set"===ye)return Array.from(Q);if("Arguments"===ye||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ye))return de(Q,Z)}},ge.exports.default=ge.exports,ge.exports.__esModule=!0},36444:function(ge,qe,q){var de=q(32878).default,Fe=q(12864).default,Q=q(34850).default;function Z(){"use strict";Z=function(){return L};var ye,L={},Re=Object.prototype,Qe=Re.hasOwnProperty,Ee=Object.defineProperty||function(V,x,z){V[x]=z.value},se="function"==typeof Symbol?Symbol:{},R=se.iterator||"@@iterator",Le=se.asyncIterator||"@@asyncIterator",ce=se.toStringTag||"@@toStringTag";function E(V,x,z){return Object.defineProperty(V,x,{value:z,enumerable:!0,configurable:!0,writable:!0}),V[x]}try{E({},"")}catch{E=function(z,M,X){return z[M]=X}}function be(V,x,z,M){var ee=Object.create((x&&x.prototype instanceof Me?x:Me).prototype),U=new Ne(M||[]);return Ee(ee,"_invoke",{value:Y(V,z,U)}),ee}function Ve(V,x,z){try{return{type:"normal",arg:V.call(x,z)}}catch(M){return{type:"throw",arg:M}}}L.wrap=be;var re="suspendedStart",ne="suspendedYield",te="executing",ie="completed",fe={};function Me(){}function Oe(){}function Pe(){}var He={};E(He,R,function(){return this});var Ge=Object.getPrototypeOf,Xe=Ge&&Ge(Ge(Ce([])));Xe&&Xe!==Re&&Qe.call(Xe,R)&&(He=Xe);var D=Pe.prototype=Me.prototype=Object.create(He);function A(V){["next","throw","return"].forEach(function(x){E(V,x,function(z){return this._invoke(x,z)})})}function N(V,x){function z(X,ee,U,he){var h=Ve(V[X],V,ee);if("throw"!==h.type){var Je=h.arg,Ke=Je.value;return Ke&&"object"==typeof Ke&&Qe.call(Ke,"__await")?x.resolve(Ke.__await).then(function(We){z("next",We,U,he)},function(We){z("throw",We,U,he)}):x.resolve(Ke).then(function(We){Je.value=We,U(Je)},function(We){return z("throw",We,U,he)})}he(h.arg)}var M;Ee(this,"_invoke",{value:function(ee,U){function he(){return new x(function(h,Je){z(ee,U,h,Je)})}return M=M?M.then(he,he):he()}})}function Y(V,x,z){var M=re;return function(X,ee){if(M===te)throw new Error("Generator is already running");if(M===ie){if("throw"===X)throw ee;return{value:ye,done:!0}}for(z.method=X,z.arg=ee;;){var U=z.delegate;if(U){var he=ve(U,z);if(he){if(he===fe)continue;return he}}if("next"===z.method)z.sent=z._sent=z.arg;else if("throw"===z.method){if(M===re)throw M=ie,z.arg;z.dispatchException(z.arg)}else"return"===z.method&&z.abrupt("return",z.arg);M=te;var h=Ve(V,x,z);if("normal"===h.type){if(M=z.done?ie:ne,h.arg===fe)continue;return{value:h.arg,done:z.done}}"throw"===h.type&&(M=ie,z.method="throw",z.arg=h.arg)}}}function ve(V,x){var z=x.method,M=V.iterator[z];if(M===ye)return x.delegate=null,"throw"===z&&V.iterator.return&&(x.method="return",x.arg=ye,ve(V,x),"throw"===x.method)||"return"!==z&&(x.method="throw",x.arg=new TypeError("The iterator does not provide a '"+z+"' method")),fe;var X=Ve(M,V.iterator,x.arg);if("throw"===X.type)return x.method="throw",x.arg=X.arg,x.delegate=null,fe;var ee=X.arg;return ee?ee.done?(x[V.resultName]=ee.value,x.next=V.nextLoc,"return"!==x.method&&(x.method="next",x.arg=ye),x.delegate=null,fe):ee:(x.method="throw",x.arg=new TypeError("iterator result is not an object"),x.delegate=null,fe)}function ae(V){var x={tryLoc:V[0]};1 in V&&(x.catchLoc=V[1]),2 in V&&(x.finallyLoc=V[2],x.afterLoc=V[3]),this.tryEntries.push(x)}function me(V){var x=V.completion||{};x.type="normal",delete x.arg,V.completion=x}function Ne(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(ae,this),this.reset(!0)}function Ce(V){if(V||""===V){var x=V[R];if(x)return x.call(V);if("function"==typeof V.next)return V;if(!isNaN(V.length)){var z=-1,M=function X(){for(;++z<V.length;)if(Qe.call(V,z))return X.value=V[z],X.done=!1,X;return X.value=ye,X.done=!0,X};return M.next=M}}throw new TypeError(typeof V+" is not iterable")}return Oe.prototype=Pe,Ee(D,"constructor",{value:Pe,configurable:!0}),Ee(Pe,"constructor",{value:Oe,configurable:!0}),Oe.displayName=E(Pe,ce,"GeneratorFunction"),L.isGeneratorFunction=function(V){var x="function"==typeof V&&V.constructor;return!!x&&(x===Oe||"GeneratorFunction"===(x.displayName||x.name))},L.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,Pe):(V.__proto__=Pe,E(V,ce,"GeneratorFunction")),V.prototype=Object.create(D),V},L.awrap=function(V){return{__await:V}},A(N.prototype),E(N.prototype,Le,function(){return this}),L.AsyncIterator=N,L.async=function(V,x,z,M,X){void 0===X&&(X=Promise);var ee=new N(be(V,x,z,M),X);return L.isGeneratorFunction(x)?ee:ee.next().then(function(U){return U.done?U.value:ee.next()})},A(D),E(D,ce,"Generator"),E(D,R,function(){return this}),E(D,"toString",function(){return"[object Generator]"}),L.keys=function(V){var x=Object(V),z=[];for(var M in x)z.push(M);return z.reverse(),function X(){for(;z.length;){var ee=z.pop();if(ee in x)return X.value=ee,X.done=!1,X}return X.done=!0,X}},L.values=Ce,Ne.prototype={constructor:Ne,reset:function(x){if(this.prev=0,this.next=0,this.sent=this._sent=ye,this.done=!1,this.delegate=null,this.method="next",this.arg=ye,this.tryEntries.forEach(me),!x)for(var z in this)"t"===z.charAt(0)&&Qe.call(this,z)&&!isNaN(+z.slice(1))&&(this[z]=ye)},stop:function(){this.done=!0;var x=this.tryEntries[0].completion;if("throw"===x.type)throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var z=this;function M(Je,Ke){return U.type="throw",U.arg=x,z.next=Je,Ke&&(z.method="next",z.arg=ye),!!Ke}for(var X=this.tryEntries.length-1;X>=0;--X){var ee=this.tryEntries[X],U=ee.completion;if("root"===ee.tryLoc)return M("end");if(ee.tryLoc<=this.prev){var he=Qe.call(ee,"catchLoc"),h=Qe.call(ee,"finallyLoc");if(he&&h){if(this.prev<ee.catchLoc)return M(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return M(ee.finallyLoc)}else if(he){if(this.prev<ee.catchLoc)return M(ee.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<ee.finallyLoc)return M(ee.finallyLoc)}}}},abrupt:function(x,z){for(var M=this.tryEntries.length-1;M>=0;--M){var X=this.tryEntries[M];if(X.tryLoc<=this.prev&&Qe.call(X,"finallyLoc")&&this.prev<X.finallyLoc){var ee=X;break}}ee&&("break"===x||"continue"===x)&&ee.tryLoc<=z&&z<=ee.finallyLoc&&(ee=null);var U=ee?ee.completion:{};return U.type=x,U.arg=z,ee?(this.method="next",this.next=ee.finallyLoc,fe):this.complete(U)},complete:function(x,z){if("throw"===x.type)throw x.arg;return"break"===x.type||"continue"===x.type?this.next=x.arg:"return"===x.type?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):"normal"===x.type&&z&&(this.next=z),fe},finish:function(x){for(var z=this.tryEntries.length-1;z>=0;--z){var M=this.tryEntries[z];if(M.finallyLoc===x)return this.complete(M.completion,M.afterLoc),me(M),fe}},catch:function(x){for(var z=this.tryEntries.length-1;z>=0;--z){var M=this.tryEntries[z];if(M.tryLoc===x){var X=M.completion;if("throw"===X.type){var ee=X.arg;me(M)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(x,z,M){return this.delegate={iterator:Ce(x),resultName:z,nextLoc:M},"next"===this.method&&(this.arg=ye),fe}},L}typeof self<"u"&&self,ge.exports=function(){var Ee,se,ye={302:function(se,R,Le){var E;R.formatArgs=function(E){if(E[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+E[0]+(this.useColors?"%c ":" ")+"+"+se.exports.humanize(this.diff),this.useColors){var be="color: "+this.color;E.splice(1,0,be,"color: inherit");var Ve=0,re=0;E[0].replace(/%[a-zA-Z%]/g,function(ne){"%%"!==ne&&(Ve++,"%c"===ne&&(re=Ve))}),E.splice(re,0,be)}},R.save=function(E){try{E?R.storage.setItem("debug",E):R.storage.removeItem("debug")}catch{}},R.load=function(){var E;try{E=R.storage.getItem("debug")}catch{}return!E&&typeof process<"u"&&"env"in process&&(E=process.env.DEBUG),E},R.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},R.storage=function(){try{return localStorage}catch{}}(),R.destroy=(E=!1,function(){E||(E=!0)}),R.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],R.log=console.debug||console.log||function(){},se.exports=Le(65)(R),se.exports.formatters.j=function(E){try{return JSON.stringify(E)}catch(be){return"[UnexpectedJSONParseError]: "+be.message}}},65:function(se,R,Le){se.exports=function(ce){function E(re){var ne,te,ie,fe=null;function Me(){for(var Oe=arguments.length,Pe=new Array(Oe),He=0;He<Oe;He++)Pe[He]=arguments[He];if(Me.enabled){var Ge=Me,Xe=Number(new Date);Ge.diff=Xe-(ne||Xe),Ge.prev=ne,Ge.curr=Xe,ne=Xe,Pe[0]=E.coerce(Pe[0]),"string"!=typeof Pe[0]&&Pe.unshift("%O");var A=0;Pe[0]=Pe[0].replace(/%([a-zA-Z%])/g,function(N,Y){if("%%"===N)return"%";A++;var ve=E.formatters[Y];return"function"==typeof ve&&(N=ve.call(Ge,Pe[A]),Pe.splice(A,1),A--),N}),E.formatArgs.call(Ge,Pe),(Ge.log||E.log).apply(Ge,Pe)}}return Me.namespace=re,Me.useColors=E.useColors(),Me.color=E.selectColor(re),Me.extend=be,Me.destroy=E.destroy,Object.defineProperty(Me,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==fe?fe:(te!==E.namespaces&&(te=E.namespaces,ie=E.enabled(re)),ie)},set:function(Pe){fe=Pe}}),"function"==typeof E.init&&E.init(Me),Me}function be(re,ne){var te=E(this.namespace+(void 0===ne?":":ne)+re);return te.log=this.log,te}function Ve(re){return re.toString().substring(2,re.toString().length-2).replace(/\.\*\?$/,"*")}return E.debug=E,E.default=E,E.coerce=function(re){return re instanceof Error?re.stack||re.message:re},E.disable=function(){var re=[].concat(E.names.map(Ve),E.skips.map(Ve).map(function(ne){return"-"+ne})).join(",");return E.enable(""),re},E.enable=function(re){var ne;E.save(re),E.namespaces=re,E.names=[],E.skips=[];var te=("string"==typeof re?re:"").split(/[\s,]+/),ie=te.length;for(ne=0;ne<ie;ne++)te[ne]&&("-"===(re=te[ne].replace(/\*/g,".*?"))[0]?E.skips.push(new RegExp("^"+re.slice(1)+"$")):E.names.push(new RegExp("^"+re+"$")))},E.enabled=function(re){if("*"===re[re.length-1])return!0;var ne,te;for(ne=0,te=E.skips.length;ne<te;ne++)if(E.skips[ne].test(re))return!1;for(ne=0,te=E.names.length;ne<te;ne++)if(E.names[ne].test(re))return!0;return!1},E.humanize=Le(247),E.destroy=function(){},Object.keys(ce).forEach(function(re){E[re]=ce[re]}),E.names=[],E.skips=[],E.formatters={},E.selectColor=function(re){for(var ne=0,te=0;te<re.length;te++)ne=(ne<<5)-ne+re.charCodeAt(te),ne|=0;return E.colors[Math.abs(ne)%E.colors.length]},E.enable(E.load()),E}},247:function(se){var R=1e3,Le=60*R,ce=60*Le,E=24*ce;function ne(te,ie,fe,Me){var Oe=ie>=1.5*fe;return Math.round(te/fe)+" "+Me+(Oe?"s":"")}se.exports=function(te,ie){ie=ie||{};var fe=typeof te;if("string"===fe&&te.length>0)return function(te){if(!((te=String(te)).length>100)){var ie=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(te);if(ie){var fe=parseFloat(ie[1]);switch((ie[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*fe;case"weeks":case"week":case"w":return 6048e5*fe;case"days":case"day":case"d":return fe*E;case"hours":case"hour":case"hrs":case"hr":case"h":return fe*ce;case"minutes":case"minute":case"mins":case"min":case"m":return fe*Le;case"seconds":case"second":case"secs":case"sec":case"s":return fe*R;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return fe;default:return}}}}(te);if("number"===fe&&isFinite(te))return ie.long?function(te){var ie=Math.abs(te);return ie>=E?ne(te,ie,E,"day"):ie>=ce?ne(te,ie,ce,"hour"):ie>=Le?ne(te,ie,Le,"minute"):ie>=R?ne(te,ie,R,"second"):te+" ms"}(te):function(te){var ie=Math.abs(te);return ie>=E?Math.round(te/E)+"d":ie>=ce?Math.round(te/ce)+"h":ie>=Le?Math.round(te/Le)+"m":ie>=R?Math.round(te/R)+"s":te+"ms"}(te);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(te))}}},L={};function Re(Ee){var se=L[Ee];if(void 0!==se)return se.exports;var R=L[Ee]={exports:{}};return ye[Ee](R,R.exports,Re),R.exports}se=Object.getPrototypeOf?function(R){return Object.getPrototypeOf(R)}:function(R){return R.__proto__},Re.t=function(R,Le){if(1&Le&&(R=this(R)),8&Le||"object"==typeof R&&R&&(4&Le&&R.__esModule||16&Le&&"function"==typeof R.then))return R;var ce=Object.create(null);Re.r(ce);var E={};Ee=Ee||[null,se({}),se([]),se(se)];for(var be=2&Le&&R;"object"==typeof be&&!~Ee.indexOf(be);be=se(be))Object.getOwnPropertyNames(be).forEach(function(Ve){return E[Ve]=function(){return R[Ve]}});return E.default=function(){return R},Re.d(ce,E),ce},Re.d=function(Ee,se){for(var R in se)Re.o(se,R)&&!Re.o(Ee,R)&&Object.defineProperty(Ee,R,{enumerable:!0,get:se[R]})},Re.o=function(Ee,se){return Object.prototype.hasOwnProperty.call(Ee,se)},Re.r=function(Ee){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Ee,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ee,"__esModule",{value:!0})};var Qe={};return function(){"use strict";Re.r(Qe),Re.d(Qe,{ActionObjectType:function(){return x},ChannelType:function(){return Qn},ChildAppWindow:function(){return Di},DialogDimension:function(){return We},ErrorCode:function(){return M},FileOpenPreference:function(){return V},FrameContexts:function(){return h},HostClientType:function(){return U},HostName:function(){return he},LiveShareHost:function(){return wa},NotificationTypes:function(){return sr},ParentAppWindow:function(){return ua},SecondaryM365ContentIdName:function(){return z},TaskModuleDimension:function(){return xt},TeamType:function(){return Je},UserSettingTypes:function(){return ur},UserTeamRole:function(){return Ke},ViewerActionTypes:function(){return cr},app:function(){return dt},appEntity:function(){return Zt},appInitialization:function(){return Tr},appInstallDialog:function(){return fr},authentication:function(){return Tn},barCode:function(){return xn},calendar:function(){return Un},call:function(){return Ir},chat:function(){return an},clipboard:function(){return pr},conversations:function(){return lr},dialog:function(){return ht},enablePrintCapability:function(){return ji},executeDeepLink:function(){return je},externalAppAuthentication:function(){return Or},externalAppCardActions:function(){return hn},files:function(){return gn},geoLocation:function(){return cn},getAdaptiveCardSchemaVersion:function(){return ca},getContext:function(){return qi},getMruTabInstances:function(){return Ki},getTabInstances:function(){return Xi},initialize:function(){return zi},initializeWithFrameContext:function(){return eo},liveShare:function(){return Wn},location:function(){return Qt},logs:function(){return ar},mail:function(){return gr},marketplace:function(){return pn},media:function(){return vt},meeting:function(){return Ln},meetingRoom:function(){return vn},menus:function(){return en},monetization:function(){return hr},navigateBack:function(){return Yt},navigateCrossDomain:function(){return ro},navigateToTab:function(){return no},notifications:function(){return mn},openFilePreview:function(){return Ei},pages:function(){return Ye},people:function(){return vr},print:function(){return _i},profile:function(){return mr},registerAppButtonClickHandler:function(){return va},registerAppButtonHoverEnterHandler:function(){return ln},registerAppButtonHoverLeaveHandler:function(){return Qi},registerBackButtonHandler:function(){return $i},registerBeforeUnloadHandler:function(){return Yi},registerChangeSettingsHandler:function(){return Rr},registerCustomHandler:function(){return Xo},registerFocusEnterHandler:function(){return Zi},registerFullScreenHandler:function(){return Gn},registerOnLoadHandler:function(){return Ji},registerOnThemeChangeHandler:function(){return ga},registerUserSettingsChangeHandler:function(){return bi},remoteCamera:function(){return jn},returnFocus:function(){return to},search:function(){return Vn},secondaryBrowser:function(){return un},sendCustomEvent:function(){return Zo},sendCustomMessage:function(){return Yo},setFrameContext:function(){return kr},settings:function(){return Mt},shareDeepLink:function(){return St},sharing:function(){return Sr},stageView:function(){return br},tasks:function(){return Fr},teams:function(){return wn},teamsCore:function(){return Wt},thirdPartyCloudStorage:function(){return Bn},uploadCustomApp:function(){return Si},version:function(){return En},videoEffects:function(){return Ft},videoEffectsEx:function(){return _n},visualMedia:function(){return Pr},webStorage:function(){return Ar}});var ce,E,t,Ee=(0,Re(302).debug)("teamsJs");function se(t){return Ee.extend(t)}function R(t,a){return t+"_"+a}function Le(t){return/^v\d+_[\w.]+$/.test(t)}(t=ce||(ce={})).V_0="v0",t.V_1="v1",t.V_2="v2",t.V_3="v3",function(t){t.App_GetContext="app.getContext",t.App_Initialize="app.initialize",t.App_NotifyAppLoaded="app.notifyAppLoaded",t.App_NotifyExpectedFailure="app.notifyExpectedFailure",t.App_NotifyFailure="app.notifyFailure",t.App_NotifySuccess="app.notifySuccess",t.App_OpenLink="app.openLink",t.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",t.AppEntity_SelectAppEntity="appEntity.selectAppEntity",t.BarCode_HasPermission="barCode.hasPermission",t.BarCode_RequestPermission="barCode.requestPermission",t.BarCode_ScanBarCode="barCode.scanBarCode",t.Calendar_ComposeMeeting="calendar.composeMeeting",t.Calendar_OpenCalendarItem="calendar.openCalendarItem",t.Call_StartCall="call.startCall",t.Clipboard_Read="clipboard.read",t.Clipboard_Write="clipboard.write",t.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",t.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",t.Dialog_Update_Resize="dialog.update.resize",t.Dialog_Url_Bot_Open="dialog.url.bot.open",t.Dialog_Url_Open="dialog.url.open",t.Dialog_Url_Submit="dialog.url.submit",t.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",t.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",t.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",t.GeoLocation_HasPermission="geoLocation.hasPermission",t.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",t.GeoLocation_RequestPermission="geoLocation.hasPermission",t.GeoLocation_ShowLocation="geoLocation.showLocation",t.Location_GetLocation="location.getLocation",t.Location_ShowLocation="location.showLocation",t.Mail_ComposeMail="mail.composeMail",t.Mail_OpenMailItem="mail.openMailItem",t.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",t.Marketplace_GetCart="marketplace.getCart",t.Marketplace_RemoveCardItems="marketplace.removeCartItems",t.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",t.Media_CaptureImage="media.captureImage",t.Media_Controller="media.controller",t.Media_GetMedia="media.getMedia",t.Media_HasPermission="media.hasPermission",t.Media_RequestPermission="media.requestPermission",t.Media_ScanBarCode="media.scanBarCode",t.Media_SelectMedia="media.selectMedia",t.Media_ViewImages="media.viewImages",t.Navigation_NavigateBack="navigation.navigateBack",t.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",t.Navigation_NavigateToTab="navigation.navigateToTab",t.Navigation_ReturnFocus="navigation.returnFocus",t.Pages_AppButton_OnClick="pages.appButton.onClick",t.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",t.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",t.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",t.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",t.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",t.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",t.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",t.Pages_Config_SetConfig="pages.config.setConfig",t.Pages_Config_SetValidityState="pages.config.setValidityState",t.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",t.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",t.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",t.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",t.Pages_GetConfig="pages.getConfig.",t.Pages_NavigateCrossDomain="pages.navigateCrossDomain",t.Pages_NavigateToApp="pages.navigateToApp",t.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",t.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",t.Pages_ReturnFocus="pages.returnFocus",t.Pages_SetCurrentFrame="pages.setCurrentFrame",t.Pages_ShareDeepLink="pages.shareDeepLink",t.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",t.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",t.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",t.PublicAPIs_ExecuteDeepLink="executeDeepLink",t.PublicAPIs_GetContext="getContext",t.PublicAPIs_GetMruTabInstances="getMruTabInstances",t.PublicAPIs_GetTabInstances="getTabInstances",t.PublicAPIs_Initialize="initialize",t.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",t.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",t.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",t.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",t.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",t.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",t.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",t.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",t.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",t.PublicAPIs_SetFrameContext="setFrameContext",t.PublicAPIs_ShareDeepLink="shareDeepLink",t.RegisterHandler="registerHandler",t.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",t.Settings_Remove_Failure="settings.remove.failure",t.Settings_Remove_Success="settings.remove.success",t.Settings_Save_Failure="settings.save.failure",t.Settings_Save_Success="settings.save.success",t.Tasks_StartTask="tasks.startTask",t.Tasks_SubmitTask="tasks.submitTask",t.Tasks_UpdateTask="tasks.updateTask"}(E||(E={}));var be=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),Ve="2.0.1",te="1.8.0",ie=Re.t(be,2).validOrigins,fe=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),Me=/^https:\/\//,Oe="https",Pe="teams.microsoft.com",He="The library has not yet been initialized",Ge="The runtime has not yet been initialized",Xe="The runtime version is not supported",D=function(){};D.initializeCalled=!1,D.initializeCompleted=!1,D.additionalValidOrigins=[],D.initializePromise=void 0,D.isFramelessWindow=!1,D.frameContext=void 0,D.hostClientType=void 0,D.printCapabilityEnabled=!1;var N,A={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},Y=new Uint8Array(16);function ve(){if(!N&&!(N=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return N(Y)}for(var ae=[],me=0;me<256;++me)ae.push((me+256).toString(16).slice(1));var V,x,z,M,X,ee,U,he,h,Je,Ke,We,Ce=function(a,u,l){if(A.randomUUID&&!u&&!a)return A.randomUUID();var s=(a=a||{}).random||(a.rng||ve)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,u){l=l||0;for(var f=0;f<16;++f)u[l+f]=s[f];return u}return function(t,a){return void 0===a&&(a=0),(ae[t[a+0]]+ae[t[a+1]]+ae[t[a+2]]+ae[t[a+3]]+"-"+ae[t[a+4]]+ae[t[a+5]]+"-"+ae[t[a+6]]+ae[t[a+7]]+"-"+ae[t[a+8]]+ae[t[a+9]]+"-"+ae[t[a+10]]+ae[t[a+11]]+ae[t[a+12]]+ae[t[a+13]]+ae[t[a+14]]+ae[t[a+15]]).toLowerCase()}(s)};(function(t){t.Inline="inline",t.Desktop="desktop",t.Web="web"})(V||(V={})),function(t){t.M365Content="m365content"}(x||(x={})),function(t){t.DriveId="driveId",t.GroupId="groupId",t.SiteId="siteId",t.UserId="userId"}(z||(z={})),function(t){t[t.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t[t.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",t[t.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",t[t.NETWORK_ERROR=2e3]="NETWORK_ERROR",t[t.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",t[t.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",t[t.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",t[t.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",t[t.THROTTLE=7e3]="THROTTLE",t[t.USER_ABORT=8e3]="USER_ABORT",t[t.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",t[t.OLD_PLATFORM=9e3]="OLD_PLATFORM",t[t.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",t[t.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(M||(M={})),function(t){t.GeoLocation="geolocation",t.Media="media"}(X||(X={})),function(t){t.TextPlain="text/plain",t.TextHtml="text/html",t.ImagePNG="image/png",t.ImageJPEG="image/jpeg"}(ee||(ee={})),function(t){t.desktop="desktop",t.web="web",t.android="android",t.ios="ios",t.ipados="ipados",t.macos="macos",t.rigel="rigel",t.surfaceHub="surfaceHub",t.teamsRoomsWindows="teamsRoomsWindows",t.teamsRoomsAndroid="teamsRoomsAndroid",t.teamsPhones="teamsPhones",t.teamsDisplays="teamsDisplays"}(U||(U={})),function(t){t.office="Office",t.outlook="Outlook",t.outlookWin32="OutlookWin32",t.orange="Orange",t.places="Places",t.teams="Teams",t.teamsModern="TeamsModern"}(he||(he={})),function(t){t.settings="settings",t.content="content",t.authentication="authentication",t.remove="remove",t.task="task",t.sidePanel="sidePanel",t.stage="stage",t.meetingStage="meetingStage"}(h||(h={})),function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff"}(Je||(Je={})),function(t){t[t.Admin=0]="Admin",t[t.User=1]="User",t[t.Guest=2]="Guest"}(Ke||(Ke={})),function(t){t.Large="large",t.Medium="medium",t.Small="small"}(We||(We={}));var Qn,xt=We;!function(t){t.Regular="Regular",t.Private="Private",t.Shared="Shared"}(Qn||(Qn={}));var O={errorCode:M.NOT_SUPPORTED_ON_PLATFORM},xr={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},go=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),vo=new Error("Invalid response: Received more images than the specified max limit in the response.");function At(t){return function(a,u){if(!a)throw new Error(t||u)}}function Lt(t,a){if("string"!=typeof t||"string"!=typeof a)return NaN;var u=t.split("."),l=a.split(".");function s(m){return/^\d+$/.test(m)}if(!u.every(s)||!l.every(s))return NaN;for(;u.length<l.length;)u.push("0");for(;l.length<u.length;)l.push("0");for(var f=0;f<u.length;++f)if(Number(u[f])!=Number(l[f]))return Number(u[f])>Number(l[f])?1:-1;return 0}function Lr(){return Ce()}function Ur(t){return Object.keys(t).forEach(function(a){"object"==typeof t[a]&&Ur(t[a])}),Object.freeze(t)}function Hr(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];var f=t.apply(void 0,l);return f.then(function(){a&&a(null)}).catch(function(m){a&&a(m)}),f}function pt(t){return!(Lt(t.majorVersion+"."+t.minorVersion,"1.5")>=0)}function Vr(t){return"https:"===t.protocol}function Br(t,a){return new Promise(function(u,l){t||l("MimeType cannot be null or empty."),a||l("Base64 string cannot be null or empty.");var s=atob(a);if(t.startsWith("image/")){for(var f=new Uint8Array(s.length),m=0;m<s.length;m++)f[m]=s.charCodeAt(m);u(new Blob([f],{type:t}))}u(new Blob([s],{type:t}))})}function Co(t){return new Promise(function(a,u){0===t.size&&u(new Error("Blob cannot be empty."));var l=new FileReader;l.onloadend=function(){l.result?a(l.result.toString().split(",")[1]):u(new Error("Failed to read the blob"))},l.onerror=function(){u(l.error)},l.readAsDataURL(t)})}function Ut(){if(at())throw new Error("window object undefined at SSR check");return window}function at(){return typeof window>"u"}var So=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Kt(t){if(!So.test(t))throw new Error("App ID is not valid. Must be GUID format. App ID: "+t)}var Jn=se("runtime"),yn=3;function Gr(t){return t.apiVersion===yn}var p={apiVersion:-1,supports:{}},Ao={apiVersion:3,hostVersionsInfo:xr,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Wr=[U.desktop,U.web,U.rigel,U.surfaceHub,U.teamsRoomsWindows,U.teamsRoomsAndroid,U.teamsPhones,U.teamsDisplays],zr=[].concat(Wr,[U.android,U.ios,U.ipados]);var Ht=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(a){var u;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:a.isLegacyTeams,supports:Object.assign(Object.assign({},a.supports),{dialog:a.supports.dialog?{card:void 0,url:a.supports.dialog,update:null===(u=a.supports.dialog)||void 0===u?void 0:u.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(a){var s=function(a,u){var l={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&u.indexOf(s)<0&&(l[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)u.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(l[s[f]]=a[s[f]])}return l}(a.supports,["appNotification"]);return Object.assign(Object.assign({},a),{apiVersion:3,supports:s})}}],To={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Wr}],"1.9.0":[{capability:{location:{}},hostClientTypes:zr}],"2.0.0":[{capability:{people:{}},hostClientTypes:zr},{capability:{sharing:{}},hostClientTypes:[U.desktop,U.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[U.android,U.desktop,U.ios,U.teamsRoomsAndroid,U.teamsPhones,U.teamsDisplays,U.web]},{capability:{webStorage:{}},hostClientTypes:[U.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[U.android,U.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[U.android,U.ios]}]},Cn=Jn.extend("generateBackCompatRuntimeConfig");function Zn(t,a){var u=Object.assign({},t);for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&("object"!=typeof a[l]||Array.isArray(a[l])?l in t||(u[l]=a[l]):u[l]=Zn(t[l]||{},a[l]));return u}function Sn(t,a,u){Cn("generating back compat runtime config for %s",t);var l=Object.assign({},a.supports);Cn("Supported capabilities in config before updating based on highestSupportedVersion: %o",l),Object.keys(u).forEach(function(f){Lt(t,f)>=0&&u[f].forEach(function(m){void 0!==D.hostClientType&&m.hostClientTypes.includes(D.hostClientType)&&(l=Zn(l,m.capability))})});var s={apiVersion:yn,hostVersionsInfo:xr,isLegacyTeams:!0,supports:l};return Cn("Runtime config after updating based on highestSupportedVersion: %o",s),s}var Xn=Jn.extend("applyRuntimeConfig");function bn(t){"string"==typeof t.apiVersion&&(Xn("Trying to apply runtime with string apiVersion, processing as v1: %o",t),t=Object.assign(Object.assign({},t),{apiVersion:1})),Xn("Fast-forwarding runtime %o",t);var a=function(t){var a=t;if(a.apiVersion<yn&&Ht.forEach(function(u){a.apiVersion===u.versionToUpgradeFrom&&(a=u.upgradeToNextVersion(a))}),Gr(a))return a;throw new Error("Received a runtime that could not be upgraded to the latest version")}(t);Xn("Applying runtime %o",a),p=Ur(a)}var En="2.19.0",jr=se("internal"),_r=jr.extend("ensureInitializeCalled"),qr=jr.extend("ensureInitialized");function wt(){if(!D.initializeCalled)throw _r(He),new Error(He)}function C(t){if(!D.initializeCompleted)throw qr("%s. initializeCalled: %s",He,D.initializeCalled.toString()),new Error(He);for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];if(u&&u.length>0){for(var s=!1,f=0;f<u.length;f++)if(u[f]===D.frameContext){s=!0;break}if(!s)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(u)+'. Current context: "'+D.frameContext+'".')}return function(t){if(Gr(t))return!0;throw-1===t.apiVersion?new Error(Ge):new Error(Xe)}(t)}function st(t){void 0===t&&(t=Ve);var a=Lt(D.clientSupportedSDKVersion,t);return!isNaN(a)&&a>=0}function Kn(){return D.hostClientType==U.android||D.hostClientType==U.ios||D.hostClientType==U.ipados}function Pn(t){if(void 0===t&&(t=Ve),!Kn())throw{errorCode:M.NOT_SUPPORTED_ON_PLATFORM};if(!st(t))throw{errorCode:M.OLD_PLATFORM}}function Ue(t){return null==t}var Tn,Qr=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})},Vt=[],An=se("validateOrigin");function $r(){return Qr(this,void 0,void 0,Z().mark(function t(){return Z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",0!==Vt.length?Vt:at()?(Vt=ie,ie):fetch(fe).then(function(l){if(!l.ok)throw new Error("Invalid Response from Fetch Call");return l.json().then(function(s){if(Jr(JSON.stringify(s)))return Vt=s.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(l){return An("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",l),Vt=ie}));case 1:case"end":return u.stop()}},t)}))}function Jr(t){var a=JSON.parse(t);try{a=JSON.parse(t)}catch{return!1}if(!a.validOrigins)return!1;for(var l,u=Q(a.validOrigins);!(l=u()).done;){var s=l.value;try{new URL("https://"+s)}catch{return An("isValidOriginsFromCDN call failed to validate origin: %s",s),!1}}return!0}function In(t,a){if("*."===t.substring(0,2)){var u=t.substring(1);if(a.length>u.length&&a.split(".").length===u.split(".").length&&a.substring(a.length-u.length)===u)return!0}else if(t===a)return!0;return!1}function Fo(t){return $r().then(function(a){if(!Vr(t))return An("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",t,t.protocol),!1;var u=t.host;if(a.some(function(m){return In(m,u)}))return!0;for(var s,l=Q(D.additionalValidOrigins);!(s=l()).done;){var f=s.value;if(In("https://"===f.substring(0,8)?f.substring(8):f,u))return!0}return An("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",t,a,D.additionalValidOrigins),!1})}!function(t){var a,u,l,k;function f(k){return new Promise(function(j,J){if(D.hostClientType===U.desktop||D.hostClientType===U.android||D.hostClientType===U.ios||D.hostClientType===U.ipados||D.hostClientType===U.macos||D.hostClientType===U.rigel||D.hostClientType===U.teamsRoomsWindows||D.hostClientType===U.teamsRoomsAndroid||D.hostClientType===U.teamsPhones||D.hostClientType===U.teamsDisplays||D.hostClientType===U.surfaceHub){var G=document.createElement("a");G.href=k.url,j(ut("authentication.authenticate",[G.href,k.width,k.height,k.isExternal]).then(function(le){var rt=le[1];if(le[0])return rt;throw new Error(rt)}))}else a={success:j,fail:J},function(k){S();var j=k.width||600,J=k.height||400;j=Math.min(j,B.currentWindow.outerWidth-400),J=Math.min(J,B.currentWindow.outerHeight-200);var G=document.createElement("a");G.href=k.url.replace("{oauthRedirectMethod}","web");var le=void 0!==B.currentWindow.screenLeft?B.currentWindow.screenLeft:B.currentWindow.screenX,Ae=void 0!==B.currentWindow.screenTop?B.currentWindow.screenTop:B.currentWindow.screenY;B.childWindow=B.currentWindow.open(G.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(Ae+=B.currentWindow.outerHeight/2-J/2)+", left="+(le+=B.currentWindow.outerWidth/2-j/2)+", width="+j+", height="+J),B.childWindow?(v(),u=B.currentWindow.setInterval(function(){if(!B.childWindow||B.childWindow.closed)H("CancelledByUser");else{var k=B.childOrigin;try{B.childOrigin="*",gt("ping")}finally{B.childOrigin=k}}},100),oe("initialize",function(){return[h.authentication,D.hostClientType]}),oe("navigateCrossDomain",function(){return!1})):H("FailedToOpenWindow")}(k)})}function S(){v();try{B.childWindow&&B.childWindow.close()}finally{B.childWindow=null,B.childOrigin=null}}function v(){u&&(clearInterval(u),u=0),tt("initialize"),tt("navigateCrossDomain")}function I(k){try{a&&a.success(k)}finally{a=void 0,S()}}function H(k){try{a&&a.fail(new Error(k))}finally{a=void 0,S()}}function ue(k,j,J){if(k){var G=document.createElement("a");G.href=decodeURIComponent(k),G.host&&G.host!==Ut().location.host&&"outlook.office.com"===G.host&&G.search.indexOf("client_type=Win32_Outlook")>-1&&(j&&"result"===j&&(J&&(G.href=W(G.href,"result",J)),B.currentWindow.location.assign(W(G.href,"authSuccess",""))),j&&"reason"===j&&(J&&(G.href=W(G.href,"reason",J)),B.currentWindow.location.assign(W(G.href,"authFailure",""))))}}function W(k,j,J){var G=k.indexOf("#"),le=-1===G?"#":k.substr(G);return le=le+"&"+j+(""!==J?"="+J:""),(k=-1===G?k:k.substr(0,G))+le}t.initialize=function(){oe("authentication.authenticate.success",I,!1),oe("authentication.authenticate.failure",H,!1)},t.registerAuthenticationHandlers=function(k){l=k},t.authenticate=function(k){var j=void 0!==k,J=j?k:l;if(!J)throw new Error("No parameters are provided for authentication");return C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),f(J).then(function(G){try{return J&&J.successCallback?(J.successCallback(G),""):G}finally{j||(l=void 0)}}).catch(function(G){try{if(J&&J.failureCallback)return J.failureCallback(G.message),"";throw G}finally{j||(l=void 0)}})},t.getAuthToken=function(k){return wt(),function(k){return new Promise(function(j){j(ut("authentication.getAuthToken",[k?.resources,k?.claims,k?.silent]))}).then(function(j){var G=j[1];if(j[0])return G;throw new Error(G)})}(k).then(function(j){return k&&k.successCallback?(k.successCallback(j),""):j}).catch(function(j){if(k&&k.failureCallback)return k.failureCallback(j.message),"";throw j})},t.getUser=function(k){return wt(),new Promise(function(k){k(ut("authentication.getUser"))}).then(function(k){var J=k[1];if(k[0])return J;throw new Error(J)}).then(function(j){return k&&k.successCallback?(k.successCallback(j),null):j}).catch(function(j){if(k&&k.failureCallback)return k.failureCallback(j.message),null;throw j})},t.notifySuccess=function(k,j){ue(j,"result",k),C(p,h.authentication),$("authentication.authenticate.success",[k]),yi(B.parentWindow,function(){return setTimeout(function(){return B.currentWindow.close()},200)})},t.notifyFailure=function(k,j){ue(j,"reason",k),C(p,h.authentication),$("authentication.authenticate.failure",[k]),yi(B.parentWindow,function(){return setTimeout(function(){return B.currentWindow.close()},200)})},(k=t.DataResidency||(t.DataResidency={})).Public="public",k.EUDB="eudb",k.Other="other"}(Tn||(Tn={}));var ht,en,yt=ce.V_2;function Yr(t,a){if(C(p,h.content,h.sidePanel,h.task,h.meetingStage),!ht.update.isSupported())throw O;pe(t,"tasks.updateTask",[a])}function Zr(t,a,u,l){if(C(p,h.content,h.sidePanel,h.meetingStage),!ht.url.isSupported())throw O;l&&oe("messageForParent",l),pe(t,"tasks.startTask",[ht.url.getDialogInfoFromUrlDialogInfo(a)],function(s,f){u?.({err:s,result:f}),tt("messageForParent")})}function er(t,a,u,l){if(C(p,h.content,h.sidePanel,h.meetingStage),!ht.url.bot.isSupported())throw O;l&&oe("messageForParent",l),pe(t,"tasks.startTask",[ht.url.getDialogInfoFromBotUrlDialogInfo(a)],function(s,f){u?.({err:s,result:f}),tt("messageForParent")})}function Xr(t,a,u){if(C(p,h.content,h.task),!ht.url.isSupported())throw O;pe(t,"tasks.completeTask",[a,u?Array.isArray(u)?u:[u]:[]])}(function(t){var m,a=[];function u(m){D.frameContext&&(D.frameContext===h.task?a.push(m):tt("messageForChild"))}t.initialize=function(){oe("messageForChild",u,!1)},function(m){function y(){return C(p)&&void 0!==(p.supports.dialog&&p.supports.dialog.url)}var v;function w(v){return{url:v.url,height:v.size?v.size.height:We.Small,width:v.size?v.size.width:We.Small,title:v.title,fallbackUrl:v.fallbackUrl}}m.open=function(v,P,I){Zr(R(yt,E.Dialog_Url_Open),v,P,I)},m.submit=function(v,P){Xr(R(yt,E.Dialog_Url_Submit),v,P)},m.sendMessageToParentFromDialog=function(v){if(C(p,h.task),!y())throw O;pe(R(yt,E.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[v])},m.sendMessageToDialog=function(v){if(C(p,h.content,h.sidePanel,h.meetingStage),!y())throw O;pe(R(yt,E.Dialog_Url_SendMessageToDialog),"messageForChild",[v])},m.registerOnMessageFromParent=function(v){if(C(p,h.task),!y())throw O;for(tt("messageForChild"),oe("messageForChild",v),a.reverse();a.length>0;)v(a.pop())},m.isSupported=y,(v=m.bot||(m.bot={})).open=function(P,I,H){er(R(yt,E.Dialog_Url_Bot_Open),P,I,H)},v.isSupported=function(){return C(p)&&void 0!==(p.supports.dialog&&p.supports.dialog.url&&p.supports.dialog.url.bot)},m.getDialogInfoFromUrlDialogInfo=w,m.getDialogInfoFromBotUrlDialogInfo=function(v){var P=w(v);return P.completionBotId=v.completionBotId,P}}(t.url||(t.url={})),t.isSupported=function(){return!(!C(p)||!p.supports.dialog)},(m=t.update||(t.update={})).resize=function(y){Yr(R(yt,E.Dialog_Update_Resize),y)},m.isSupported=function(){return!(!C(p)||!p.supports.dialog||!p.supports.dialog.update)},function(m){function y(){var P=p.hostVersionsInfo&&p.hostVersionsInfo.adaptiveCardSchemaVersion&&!pt(p.hostVersionsInfo.adaptiveCardSchemaVersion);return C(p)&&void 0!==(P&&p.supports.dialog&&p.supports.dialog.card)}function w(P){return{card:P.card,height:P.size?P.size.height:We.Small,width:P.size?P.size.width:We.Small,title:P.title}}m.open=function(P,I){if(C(p,h.content,h.sidePanel,h.meetingStage),!y())throw O;var H=w(P);pe(R(yt,E.Dialog_AdaptiveCard_Open),"tasks.startTask",[H],function(ue,W){I?.({err:ue,result:W})})},m.isSupported=y,function(P){function I(){var H=p.hostVersionsInfo&&p.hostVersionsInfo.adaptiveCardSchemaVersion&&!pt(p.hostVersionsInfo.adaptiveCardSchemaVersion);return C(p)&&void 0!==(H&&p.supports.dialog&&p.supports.dialog.card&&p.supports.dialog.card.bot)}P.open=function(H,ue){if(C(p,h.content,h.sidePanel,h.meetingStage),!I())throw O;var W=function(P){var I=w(P);return I.completionBotId=P.completionBotId,I}(H);pe(R(yt,E.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[W],function(k,j){ue?.({err:k,result:j})})},P.isSupported=I}(m.bot||(m.bot={}))}(t.adaptiveCard||(t.adaptiveCard={}))})(ht||(ht={})),function(t){var l,s,f,v;function m(v){f&&f(v)||(C(p),$("viewConfigItemPress",[v]))}function y(v){l&&l(v)||(C(p),$("handleNavBarMenuItemPress",[v]))}function S(v){s&&s(v)||(C(p),$("handleActionMenuItemPress",[v]))}function w(){return!(!C(p)||!p.supports.menus)}(v=t.DisplayMode||(t.DisplayMode={}))[v.ifRoom=0]="ifRoom",v[v.overflowOnly=1]="overflowOnly",t.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(v){v.dropDown="dropDown",v.popOver="popOver"}(t.MenuListType||(t.MenuListType={})),t.initialize=function(){oe("navBarMenuItemPress",y,!1),oe("actionMenuItemPress",S,!1),oe("setModuleView",m,!1)},t.setUpViews=function(v,P){if(C(p),!w())throw O;f=P,$("setUpViews",[v])},t.setNavBarMenu=function(v,P){if(C(p),!w())throw O;l=P,$("setNavBarMenu",[v])},t.showActionMenu=function(v,P){if(C(p),!w())throw O;s=P,$("showActionMenu",[v])},t.isSupported=w}(en||(en={}));var It=ce.V_2,Kr=5e3,ei=se("app");function _t(t,a){return at()?(ei.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(t,a,u){return new Promise(function(l,s){var f=setTimeout(s,a,u);t().then(function(m){clearTimeout(f),l(m)}).catch(function(m){clearTimeout(f),s(m)})})}(function(){return function(t,a){return new Promise(function(u){D.initializeCalled||(D.initializeCalled=!0,xe.initializeHandlers(),D.initializePromise=function(t,a){var u=this;if(Be.messageListener=function(s){return Rn(u,void 0,void 0,Z().mark(function f(){return Z().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,gi(s);case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},f)}))},B.currentWindow=B.currentWindow||Ut(),B.parentWindow=B.currentWindow.parent!==B.currentWindow.self?B.currentWindow.parent:B.currentWindow.opener,(B.parentWindow||t)&&B.currentWindow.addEventListener("message",Be.messageListener,!1),!B.parentWindow){var l=B.currentWindow;if(!l.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));D.isFramelessWindow=!0,l.onNativeMessage=vi}try{return B.parentOrigin="*",nn(a,"initialize",[En,yn]).then(function(s){return{context:s[0],clientType:s[1],runtimeConfig:s[2],clientSupportedSDKVersion:s[3]}})}finally{B.parentOrigin=null}}(a,t).then(function(l){var f=l.clientType,m=l.runtimeConfig,y=l.clientSupportedSDKVersion,S=void 0===y?Ve:y;D.frameContext=l.context,D.hostClientType=f,D.clientSupportedSDKVersion=S;try{Tt("Parsing %s",m);var w=JSON.parse(m);if(Tt("Checking if %o is a valid runtime object",w??"null"),!w||!w.apiVersion)throw new Error("Received runtime config is invalid");m&&bn(w)}catch(P){if(!(P instanceof SyntaxError))throw P;try{Tt("Attempting to parse %s as an SDK version",m),isNaN(Lt(m,Ve))||(D.clientSupportedSDKVersion=m);var v=JSON.parse(S);if(Tt("givenRuntimeConfig parsed to %o",v??"null"),!v)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");bn(v)}catch(I){if(!(I instanceof SyntaxError))throw I;bn(Sn(D.clientSupportedSDKVersion,Ao,To))}}D.initializeCompleted=!0}),Tn.initialize(),en.initialize(),Ye.config.initialize(),ht.initialize()),Array.isArray(a)&&function(t){var a=D.additionalValidOrigins.concat(t.filter(function(l){return"string"==typeof l&&Me.test(l)})),u={};a=a.filter(function(l){return!u[l]&&(u[l]=!0,!0)}),D.additionalValidOrigins=a}(a),void 0!==D.initializePromise?u(D.initializePromise):Tt("GlobalVars.initializePromise is unexpectedly undefined")})}(t,a)},Kr,new Error("SDK initialization timed out."))}var dt,Tt=ei.extend("initializeHelper");function Ie(t,a){!Ue(a)&&wt(),function(t,a){xe.themeChangeHandler=a,!Ue(a)&&pe(t,"registerHandler",["themeChange"])}(t,a)}function Se(t,a){return new Promise(function(u){C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),u(Rt(t,"executeDeepLink",a))})}!function(t){var f,a=se("app");t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(f=t.FailedReason||(t.FailedReason={})).AuthFailed="AuthFailed",f.Timeout="Timeout",f.Other="Other",function(f){f.PermissionError="PermissionError",f.NotFound="NotFound",f.Throttling="Throttling",f.Offline="Offline",f.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return D.initializeCompleted},t.getFrameContext=function(){return D.frameContext},function(){if(!at()){var f=document.getElementsByTagName("script"),m=f&&f[f.length-1]&&f[f.length-1].src,y="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";m&&0!==m.length?a("teamsjs is being used from %s. %s",m,y):a("teamsjs is being used from a script tag embedded directly in your html. %s",y)}}(),t.initialize=function(f){return function(){Qr(this,void 0,void 0,Z().mark(function t(){return Z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,$r();case 2:case"end":return u.stop()}},t)}))}(),_t(R(It,E.App_Initialize),f)},t._initialize=function(f){B.currentWindow=f},t._uninitialize=function(){D.initializeCalled&&(xe.uninitializeHandlers(),D.initializeCalled=!1,D.initializeCompleted=!1,D.initializePromise=void 0,D.additionalValidOrigins=[],D.frameContext=void 0,D.hostClientType=void 0,D.isFramelessWindow=!1,B.currentWindow&&B.currentWindow.removeEventListener("message",Be.messageListener,!1),B.currentWindow=null,B.parentWindow=null,B.parentOrigin=null,B.childWindow=null,B.childOrigin=null,Be.parentMessageQueue=[],Be.childMessageQueue=[],Be.nextMessageId=0,Be.callbacks={},Be.promiseCallbacks={})},t.getContext=function(){return new Promise(function(f){wt(),f(tn(R(It,E.App_GetContext),"getContext"))}).then(function(f){return function(t){var a;return{actionInfo:t.actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:he.teams,clientType:t.hostClientType?t.hostClientType:U.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId},appLaunchId:t.appLaunchId},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:D.frameContext,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,sourceOrigin:t.sourceOrigin},user:{id:null!==(a=t.userObjectId)&&void 0!==a?a:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0}}(f)})},t.notifyAppLoaded=function(){wt(),pe(R(It,E.App_NotifyAppLoaded),t.Messages.AppLoaded,[En])},t.notifySuccess=function(){wt(),pe(R(It,E.App_NotifySuccess),t.Messages.Success,[En])},t.notifyFailure=function(f){wt(),pe(R(It,E.App_NotifyFailure),t.Messages.Failure,[f.reason,f.message])},t.notifyExpectedFailure=function(f){wt(),pe(R(It,E.App_NotifyExpectedFailure),t.Messages.ExpectedFailure,[f.reason,f.message])},t.registerOnThemeChangeHandler=function(f){Ie(R(It,E.App_RegisterOnThemeChangeHandler),f)},t.openLink=function(f){return Se(R(It,E.App_OpenLink),f)},function(f){f.registerBeforeSuspendOrTerminateHandler=function(m){if(!m)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");C(p),function(t){xe.beforeSuspendOrTerminateHandler=t,!Ue(t)&&$("registerHandler",["beforeUnload"])}(m)},f.registerOnResumeHandler=function(m){if(!m)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");C(p),function(t){xe.resumeHandler=t,!Ue(t)&&$("registerHandler",["load"])}(m)}}(t.lifecycle||(t.lifecycle={}))}(dt||(dt={}));var Ye,ke=ce.V_2;function ti(t,a){return new Promise(function(u){if(C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage),!Ye.isSupported())throw O;u(nr(t,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",a))})}function ni(t){return new Promise(function(a){if(C(p),!Ye.backStack.isSupported())throw O;a(nr(t,"navigateBack","Back navigation is not supported in the current client or context."))})}function ri(t,a){return new Promise(function(u){if(C(p),!Ye.tabs.isSupported())throw O;u(nr(t,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",a))})}function ii(t,a){if(C(p),!Ye.isSupported())throw O;pe(t,"returnFocus",[a])}function oi(t,a){return new Promise(function(u){if(C(p),!Ye.tabs.isSupported())throw O;u(tn(t,"getTabInstances",a))})}function ai(t,a){return new Promise(function(u){if(C(p),!Ye.tabs.isSupported())throw O;u(tn(t,"getMruTabInstances",a))})}function si(t,a){if(C(p,h.content,h.sidePanel,h.meetingStage),!Ye.isSupported())throw O;pe(t,"shareDeepLink",[a.subPageId,a.subPageLabel,a.subPageWebUrl])}function tr(t,a){if(C(p,h.content),!Ye.isSupported())throw O;pe(t,"setFrameContext",[a])}!function(t){function a(w){tr(R(ke,E.Pages_SetCurrentFrame),w)}function u(){return!(!C(p)||!p.supports.pages)}var w;t.returnFocus=function(w){ii(R(ke,E.Pages_ReturnFocus),w)},t.registerFocusEnterHandler=function(w){ct(R(ke,E.Pages_RegisterFocusEnterHandler),"focusEnter",w,[],function(){if(!u())throw O})},t.setCurrentFrame=a,t.initializeWithFrameContext=function(w,v,P){dt.initialize(P).then(function(){return v&&v()}),a(w)},t.getConfig=function(){return new Promise(function(w){if(C(p,h.content,h.settings,h.remove,h.sidePanel),!u())throw O;w(tn(R(ke,E.Pages_GetConfig),"settings.getSettings"))})},t.navigateCrossDomain=function(w){return ti(R(ke,E.Pages_NavigateCrossDomain),w)},t.navigateToApp=function(w){return new Promise(function(v){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!u())throw O;var P=R(ke,E.Pages_NavigateCrossDomain);v(p.isLegacyTeams?Rt(P,"executeDeepLink",function(t){var a=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(t.appId)+"/"+encodeURIComponent(t.pageId));return t.webUrl&&a.searchParams.append("webUrl",t.webUrl),(t.channelId||t.subPageId)&&a.searchParams.append("context",JSON.stringify({channelId:t.channelId,subEntityId:t.subPageId})),a.toString()}(w)):Rt(P,"pages.navigateToApp",w))})},t.shareDeepLink=function(w){return si(R(ke,E.Pages_ShareDeepLink),w)},t.registerFullScreenHandler=function(w){ct(R(ke,E.Pages_RegisterFullScreenHandler),"fullScreenChange",w,[],function(){if(!Ue(w)&&!u())throw O})},t.isSupported=u,(w=t.tabs||(t.tabs={})).navigateToTab=function(v){return ri(R(ke,E.Pages_Tabs_NavigateToTab),v)},w.getTabInstances=function(v){return oi(R(ke,E.Pages_Tabs_GetTabInstances),v)},w.getMruTabInstances=function(v){return ai(R(ke,E.Pages_Tabs_GetMruTabInstances),v)},w.isSupported=function(){return!(!C(p)||!p.supports.pages||!p.supports.pages.tabs)},function(w){var v,P;function I(G,le){!Ue(G)&&C(p,h.settings),le&&le(),v=G,!Ue(G)&&pe(R(ke,E.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function H(G,le){!Ue(G)&&C(p,h.remove,h.settings),le&&le(),P=G,!Ue(G)&&pe(R(ke,E.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function ue(G){var le=new W(G);v?v(le):B.childWindow?gt("settings.save",[G]):le.notifySuccess()}w.initialize=function(){oe("settings.save",ue,!1),oe("settings.remove",k,!1)},w.setValidityState=function(G){if(C(p,h.settings,h.remove),!J())throw O;pe(R(ke,E.Pages_Config_SetValidityState),"settings.setValidityState",[G])},w.setConfig=function(G){return new Promise(function(le){if(C(p,h.content,h.settings,h.sidePanel),!J())throw O;le(Rt(R(ke,E.Pages_Config_SetConfig),"settings.setSettings",G))})},w.registerOnSaveHandler=function(G){I(G,function(){if(!Ue(G)&&!J())throw O})},w.registerOnSaveHandlerHelper=I,w.registerOnRemoveHandler=function(G){H(G,function(){if(!Ue(G)&&!J())throw O})},w.registerOnRemoveHandlerHelper=H,w.registerChangeConfigHandler=function(G){ct(R(ke,E.Pages_Config_RegisterChangeConfigHandler),"changeSettings",G,[h.content],function(){if(!J())throw O})};var W=function(){function G(Ae){this.notified=!1,this.result=Ae||{}}var le=G.prototype;return le.notifySuccess=function(){this.ensureNotNotified(),pe(R(ke,E.Settings_Save_Success),"settings.save.success"),this.notified=!0},le.notifyFailure=function(rt){this.ensureNotNotified(),pe(R(ke,E.Settings_Save_Failure),"settings.save.failure",[rt]),this.notified=!0},le.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},G}();function k(){var G=new j;P?P(G):B.childWindow?gt("settings.remove",[]):G.notifySuccess()}var j=function(){function G(){this.notified=!1}var le=G.prototype;return le.notifySuccess=function(){this.ensureNotNotified(),pe(R(ke,E.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},le.notifyFailure=function(rt){this.ensureNotNotified(),pe(R(ke,E.Settings_Remove_Failure),"settings.remove.failure",[rt]),this.notified=!0},le.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},G}();function J(){return!(!C(p)||!p.supports.pages||!p.supports.pages.config)}w.isSupported=J}(t.config||(t.config={})),function(w){var v;function P(){return ni(R(ke,E.Pages_BackStack_NavigateBack))}function I(W,k,j){!Ue(k)&&C(p),j&&j(),v=k,!Ue(k)&&pe(W,"registerHandler",["backButton"])}function H(){v&&v()||(B.childWindow?gt("backButtonPress",[]):P())}function ue(){return!(!C(p)||!p.supports.pages||!p.supports.pages.backStack)}w._initialize=function(){oe("backButtonPress",H,!1)},w.navigateBack=P,w.registerBackButtonHandler=function(W){I(R(ke,E.Pages_BackStack_RegisterBackButtonHandler),W,function(){if(!Ue(W)&&!ue())throw O})},w.registerBackButtonHandlerHelper=I,w.isSupported=ue}(t.backStack||(t.backStack={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.fullTrust)}w.enterFullscreen=function(){if(C(p,h.content),!v())throw O;pe(R(ke,E.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},w.exitFullscreen=function(){if(C(p,h.content),!v())throw O;pe(R(ke,E.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},w.isSupported=v}(t.fullTrust||(t.fullTrust={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.appButton)}w.onClick=function(P){ct(R(ke,E.Pages_AppButton_OnClick),"appButtonClick",P,[h.content],function(){if(!v())throw O})},w.onHoverEnter=function(P){ct(R(ke,E.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",P,[h.content],function(){if(!v())throw O})},w.onHoverLeave=function(P){ct(R(ke,E.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",P,[h.content],function(){if(!v())throw O})},w.isSupported=v}(t.appButton||(t.appButton={})),function(w){function v(){return!(!C(p)||!p.supports.pages||!p.supports.pages.currentApp)}w.navigateTo=function(P){return new Promise(function(I){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!v())throw O;I(et(R(ke,E.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",P))})},w.navigateToDefaultPage=function(){return new Promise(function(P){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!v())throw O;P(et(R(ke,E.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},w.isSupported=v}(t.currentApp||(t.currentApp={}))}(Ye||(Ye={}));var Oo=se("handlers"),xe=function(){function t(){}return t.initializeHandlers=function(){t.handlers.themeChange=Uo,t.handlers.load=Ho,t.handlers.beforeUnload=Bo,Ye.backStack._initialize()},t.uninitializeHandlers=function(){t.handlers={},t.themeChangeHandler=null,t.loadHandler=null,t.beforeUnloadHandler=null,t.beforeSuspendOrTerminateHandler=null,t.resumeHandler=null},t}();xe.handlers={},xe.themeChangeHandler=null,xe.loadHandler=null,xe.beforeUnloadHandler=null,xe.beforeSuspendOrTerminateHandler=null,xe.resumeHandler=null;var ci=Oo.extend("callHandler");function ui(t,a){var u=xe.handlers[t];return u?(ci("Invoking the registered handler for message %s with arguments %o",t,a),[!0,u.apply(this,a)]):B.childWindow?(gt(t,a),[!1,void 0]):(ci("Handler for action message %s not found.",t),[!1,void 0])}function oe(t,a,u,l){void 0===u&&(u=!0),void 0===l&&(l=[]),a?(xe.handlers[t]=a,u&&pe(R(ce.V_0,E.RegisterHandler),"registerHandler",[t].concat(l))):delete xe.handlers[t]}function tt(t){delete xe.handlers[t]}function li(t){return null!=xe.handlers[t]}function ct(t,a,u,l,s){u&&C.apply(void 0,[p].concat(l)),s&&s(),oe(a,u)}function Uo(t){xe.themeChangeHandler&&xe.themeChangeHandler(t),B.childWindow&&gt("themeChange",[t])}function Ho(t){xe.resumeHandler?xe.resumeHandler(t):xe.loadHandler&&xe.loadHandler(t),B.childWindow&&gt("load",[t])}function Bo(){var t=function(){$("readyToUnload",[])};xe.beforeSuspendOrTerminateHandler?(xe.beforeSuspendOrTerminateHandler(),B.childWindow?gt("beforeUnload"):t()):xe.beforeUnloadHandler&&xe.beforeUnloadHandler(t)||(B.childWindow?gt("beforeUnload"):t())}var Rn=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})},Bt=se("communication"),B=function(){},Be=function(){};function tn(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];return nn(t,a,l).then(function(f){return f[0]})}function kn(t){for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];return ut(t,u).then(function(s){return s[0]})}function Rt(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];return nn(t,a,l).then(function(f){if(!f[0])throw new Error(f[1])})}function kt(t){for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];return ut(t,u).then(function(s){if(!s[0])throw new Error(s[1])})}function nr(t,a,u){for(var l=arguments.length,s=new Array(l>3?l-3:0),f=3;f<l;f++)s[f-3]=arguments[f];return nn(t,a,s).then(function(m){if(!m[0])throw new Error(m[1]||u)})}function et(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];return nn(t,a,l).then(function(f){var m=f[0];if(m)throw m;return f[1]})}function ze(t){for(var a=arguments.length,u=new Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];return ut(t,u).then(function(s){var f=s[0];if(f)throw f;return s[1]})}function nn(t,a,u){if(void 0===u&&(u=void 0),!Le(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(l){l(rr(rn(t,a,u).id))})}function ut(t,a){return void 0===a&&(a=void 0),new Promise(function(u){u(rr(rn(R(ce.V_0,"testing"),t,a).id))})}function rr(t){return new Promise(function(a){Be.promiseCallbacks[t]=a})}function pe(t,a,u,l){var s;if(u instanceof Function?l=u:u instanceof Array&&(s=u),!Le(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var f=rn(t,a,s);l&&(Be.callbacks[f.id]=l)}function $(t,a,u){var l;a instanceof Function?u=a:a instanceof Array&&(l=a);var s=rn(R(ce.V_0,"testing"),t,l);u&&(Be.callbacks[s.id]=u)}Be.parentMessageQueue=[],Be.childMessageQueue=[],Be.nextMessageId=0,Be.callbacks={},Be.promiseCallbacks={};var zo=Bt.extend("sendMessageToParentHelper");function rn(t,a,u){var l=zo,s=B.parentWindow,f=function(t,a,u){return{id:Be.nextMessageId++,func:a,timestamp:Date.now(),args:u||[],apiversiontag:t}}(t,a,u);if(l("Message %i information: %o",f.id,{actionName:a,args:u}),D.isFramelessWindow)B.currentWindow&&B.currentWindow.nativeInterface&&(l("Sending message %i to parent via framelessPostMessage interface",f.id),B.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(f)));else{var m=Fn(s);s&&m?(l("Sending message %i to parent via postMessage",f.id),s.postMessage(f,m)):(l("Adding message %i to parent message queue",f.id),Dn(s).push(f))}return f}var hi=Bt.extend("processMessage");function gi(t){return Rn(this,void 0,void 0,Z().mark(function a(){var u,l;return Z().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t&&t.data&&"object"==typeof t.data){f.next=2;break}return f.abrupt("return",void hi("Unrecognized message format received by app, message being ignored. Message: %o",t));case 2:return f.abrupt("return",jo(u=t.source||t.originalEvent&&t.originalEvent.source,l=t.origin||t.originalEvent&&t.originalEvent.origin).then(function(m){m?(_o(u,l),u===B.parentWindow?vi(t):u===B.childWindow&&or(t)):hi("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return f.stop()}},a)}))}var ir=Bt.extend("shouldProcessMessage");function jo(t,a){return Rn(this,void 0,void 0,Z().mark(function u(){var l;return Z().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!B.currentWindow||t!==B.currentWindow){f.next=2;break}return f.abrupt("return",(ir("Should not process message because it is coming from the current window"),!1));case 2:if(!(B.currentWindow&&B.currentWindow.location&&a&&a===B.currentWindow.location.origin)){f.next=4;break}return f.abrupt("return",!0);case 4:return f.next=6,Fo(new URL(a));case 6:return f.abrupt("return",((l=f.sent)||ir("Message has an invalid origin of %s",a),l));case 8:case"end":return f.stop()}},u)}))}function _o(t,a){D.isFramelessWindow||B.parentWindow&&!B.parentWindow.closed&&t!==B.parentWindow?B.childWindow&&!B.childWindow.closed&&t!==B.childWindow||(B.childWindow=t,B.childOrigin=a):(B.parentWindow=t,B.parentOrigin=a),B.parentWindow&&B.parentWindow.closed&&(B.parentWindow=null,B.parentOrigin=null),B.childWindow&&B.childWindow.closed&&(B.childWindow=null,B.childOrigin=null),wi(B.parentWindow),wi(B.childWindow)}var qo=Bt.extend("handleParentMessage");function vi(t){var a=qo;if("id"in t.data&&"number"==typeof t.data.id){var u=t.data,l=Be.callbacks[u.id];a("Received a response from parent for message %i",u.id),l&&(a("Invoking the registered callback for message %i with arguments %o",u.id,u.args),l.apply(null,[].concat(u.args,[u.isPartialResponse])),function(t){return!0===t.data.isPartialResponse}(t)||(a("Removing registered callback for message %i",u.id),delete Be.callbacks[u.id]));var s=Be.promiseCallbacks[u.id];s&&(a("Invoking the registered promise callback for message %i with arguments %o",u.id,u.args),s(u.args),a("Removing registered promise callback for message %i",u.id),delete Be.promiseCallbacks[u.id])}else if("func"in t.data&&"string"==typeof t.data.func){var f=t.data;a("Received an action message %s from parent",f.func),ui(f.func,f.args)}else a("Received an unknown message: %O",t)}function or(t){if("id"in t.data&&"func"in t.data){var a=t.data,u=ui(a.func,a.args),s=u[1];u[0]&&void 0!==s?Ci(a.id,Array.isArray(s)?s:[s]):$(a.func,a.args,function(){if(B.childWindow){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];var S=m.pop();Ci(a.id,m,S)}})}}function Dn(t){return t===B.parentWindow?Be.parentMessageQueue:t===B.childWindow?Be.childMessageQueue:[]}function Fn(t){return t===B.parentWindow?B.parentOrigin:t===B.childWindow?B.childOrigin:null}var ar,sr,cr,ur,lr,mi=Bt.extend("flushMessageQueue");function wi(t){for(var a=Fn(t),u=Dn(t),l=t==B.parentWindow?"parent":"child";t&&a&&u.length>0;){var s=u.shift();mi("Flushing message %i from "+l+" message queue via postMessage.",s?.id),t.postMessage(s,a)}}function yi(t,a){var u;u=B.currentWindow.setInterval(function(){0===Dn(t).length&&(clearInterval(u),a())},100)}function Ci(t,a,u){var l=B.childWindow,s=function(t,a,u){return{id:t,args:a||[],isPartialResponse:u}}(t,a,u),f=Fn(l);l&&f&&l.postMessage(s,f)}function gt(t,a){var u=B.childWindow,l=function(t,a){return{func:t,args:a||[]}}(t,a),s=Fn(u);u&&s?u.postMessage(l,s):Dn(u).push(l)}function Si(t,a){C(p),$("uploadCustomApp",[t],a||At())}function Yo(t,a,u){C(p),$(t,a,u)}function Zo(t,a){if(C(p),!B.childWindow)throw new Error("The child window has not yet been initialized or is not present");gt(t,a)}function Xo(t,a){var u=this;C(p),oe(t,function(){for(var l=arguments.length,s=new Array(l),f=0;f<l;f++)s[f]=arguments[f];return a.apply(u,s)})}function bi(t,a){C(p),oe("userSettingsChange",a,!0,[t])}function Ei(t){C(p,h.content,h.task),$("openFilePreview",[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId,t.viewerAction,t.fileOpenPreference,t.conversationId,t.sizeInBytes])}(function(t){function a(){return!(!C(p)||!p.supports.logs)}t.registerGetLogHandler=function(u){if(!Ue(u)&&C(p),!Ue(u)&&!a())throw O;u?oe("log.request",function(){$("log.receive",[u()])}):tt("log.request")},t.isSupported=a})(ar||(ar={})),function(t){t.fileDownloadStart="fileDownloadStart",t.fileDownloadComplete="fileDownloadComplete"}(sr||(sr={})),function(t){t.view="view",t.edit="edit",t.editNew="editNew"}(cr||(cr={})),function(t){t.fileOpenPreference="fileOpenPreference",t.theme="theme"}(ur||(ur={})),function(t){function a(){return!(!C(p)||!p.supports.conversations)}t.openConversation=function(u){return new Promise(function(l){if(C(p,h.content),!a())throw O;var s=kt("conversations.openConversation",{title:u.title,subEntityId:u.subEntityId,conversationId:u.conversationId,channelId:u.channelId,entityId:u.entityId});u.onStartConversation&&oe("startConversation",function(f,m,y,S){var w;return null===(w=u.onStartConversation)||void 0===w?void 0:w.call(u,{subEntityId:f,conversationId:m,channelId:y,entityId:S})}),u.onCloseConversation&&oe("closeConversation",function(f,m,y,S){var w;return null===(w=u.onCloseConversation)||void 0===w?void 0:w.call(u,{subEntityId:f,conversationId:m,channelId:y,entityId:S})}),l(s)})},t.closeConversation=function(){if(C(p,h.content),!a())throw O;$("conversations.closeConversation"),tt("startConversation"),tt("closeConversation")},t.getChatMembers=function(){return new Promise(function(u){if(C(p),!a())throw O;u(kn("getChatMembers"))})},t.isSupported=a}(lr||(lr={}));var fr;function Ai(t,a,u){if(0===t.length)throw new Error("Must have at least one user when creating a chat deep link");var l="users="+t.map(function(m){return encodeURIComponent(m)}).join(","),s=void 0===a?"":"&topicName="+encodeURIComponent(a),f=void 0===u?"":"&message="+encodeURIComponent(u);return Oe+"://"+Pe+"/l/chat/0/0?"+l+s+f}!function(t){function a(){return!(!C(p)||!p.supports.appInstallDialog)}t.openAppInstallDialog=function(u){return new Promise(function(l){if(C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage),!a())throw new Error("Not supported");p.isLegacyTeams?l(kt("executeDeepLink",function(t){if(!t)throw new Error("App ID must be set when creating an app install dialog deep link");return Oe+"://"+Pe+"/l/app/"+encodeURIComponent(t)}(u.appId))):($("appInstallDialog.openAppInstallDialog",[u]),l())})},t.isSupported=a}(fr||(fr={}));var vt,lt=ce.V_1,Ii=se("media");function on(t,a){if(null==t||null==a||t.length<=0)return null;var u=null,l=1;return t.sort(function(s,f){return s.sequence>f.sequence?1:-1}),t.forEach(function(s){s.sequence==l&&(u=u?new Blob([u,s.file],{type:a}):new Blob([s.file],{type:a}),l++)}),u}function On(t,a){if(null==t||null==a)return null;for(var u=atob(t.chunk),l=new Array(u.length),s=0;s<u.length;s++)l[s]=u.charCodeAt(s);var f=new Uint8Array(l),m=new Blob([f],{type:a});return{sequence:t.chunkSequence,file:m}}function na(t){!function(t){return!(!t||t.mediaType!=vt.MediaType.VideoAndImage&&!t.videoAndImageProps)}(t)?function(t){return!(!t||t.mediaType!=vt.MediaType.Video||!t.videoProps||t.videoProps.isFullScreenMode)}(t)?Pn("2.0.3"):function(t){var a;return!(t?.mediaType!=vt.MediaType.Image||null===(a=t?.imageProps)||void 0===a||!a.imageOutputFormats)}(t)&&Pn("2.0.4"):Pn("2.0.2")}function Ri(t){return!t||!(null===t.timeOutIntervalInSec||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec<=0||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec>60)}!function(t){var u,f,I;(I=t.FileFormat||(t.FileFormat={})).Base64="base64",I.ID="id";var S=function(){};function w(){return!(!C(p)||!p.supports.permissions)}t.File=S,t.captureImage=function(I){if(!I)throw new Error("[captureImage] Callback cannot be null");C(p,h.content,h.task),D.isFramelessWindow?st("1.7.0")?pe(R(lt,E.Media_CaptureImage),"captureImage",I):I({errorCode:M.OLD_PLATFORM},[]):I({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},[])},t.hasPermission=function(){if(C(p,h.content,h.task),!w())throw O;var I=X.Media;return new Promise(function(H){H(et(R(lt,E.Media_HasPermission),"permissions.has",I))})},t.requestPermission=function(){if(C(p,h.content,h.task),!w())throw O;var I=X.Media;return new Promise(function(H){H(et(R(lt,E.Media_RequestPermission),"permissions.request",I))})};var v=function(I){function H(W){var k;return k=I.call(this)||this,W&&(k.content=W.content,k.format=W.format,k.mimeType=W.mimeType,k.name=W.name,k.preview=W.preview,k.size=W.size),k}Fe(H,I);var ue=H.prototype;return ue.getMedia=function(k){if(!k)throw new Error("[get Media] Callback cannot be null");C(p,h.content,h.task),st(te)?function(t,a,u){return null!=t&&null!=a&&a==vt.FileFormat.ID&&null!=u}(this.mimeType,this.format,this.content)?st("2.0.0")?this.getMediaViaCallback(k):this.getMediaViaHandler(k):k({errorCode:M.INVALID_ARGUMENTS},new Blob):k({errorCode:M.OLD_PLATFORM},new Blob)},ue.getMediaViaCallback=function(k){var j={mediaMimeType:this.mimeType,assembleAttachment:[]},J=[this.content];pe(R(lt,E.Media_GetMedia),"getMedia",J,function(G){if(k)if(G&&G.error)k(G.error,new Blob);else if(G&&G.mediaChunk)if(G.mediaChunk.chunkSequence<=0){var le=on(j.assembleAttachment,j.mediaMimeType);k(G.error,le??new Blob)}else{var Ae=On(G.mediaChunk,j.mediaMimeType);Ae?j.assembleAttachment.push(Ae):Ii("Received a null assemble attachment for when decoding chunk sequence "+G.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else k({errorCode:M.INTERNAL_ERROR,message:"data received is null"},new Blob)})},ue.getMediaViaHandler=function(k){var j=Lr(),J={mediaMimeType:this.mimeType,assembleAttachment:[]},G=[j,this.content];this.content&&!Ue(k)&&pe(R(lt,E.Media_GetMedia),"getMedia",G),oe("getMedia"+j,function(le){if(k){var Ae=JSON.parse(le);if(Ae.error)k(Ae.error,new Blob),tt("getMedia"+j);else if(Ae.mediaChunk)if(Ae.mediaChunk.chunkSequence<=0){var rt=on(J.assembleAttachment,J.mediaMimeType);k(Ae.error,rt??new Blob),tt("getMedia"+j)}else{var nt=On(Ae.mediaChunk,J.mediaMimeType);nt&&J.assembleAttachment.push(nt)}else k({errorCode:M.INTERNAL_ERROR,message:"data received is null"},new Blob),tt("getMedia"+j)}})},H}(S);t.Media=v;var P=function(){function I(ue){this.controllerCallback=ue}var H=I.prototype;return H.notifyEventToHost=function(W,k){C(p,h.content,h.task);try{Pn("2.0.3")}catch(J){return void(k&&k(J))}var j={mediaType:this.getMediaType(),mediaControllerEvent:W};pe(R(lt,E.Media_Controller),"media.controller",[j],function(J){k&&k(J)})},H.stop=function(W){this.notifyEventToHost(u.StopRecording,W)},I}();t.VideoController=function(I){function H(){return I.apply(this,arguments)||this}Fe(H,I);var ue=H.prototype;return ue.getMediaType=function(){return f.Video},ue.notifyEventToApp=function(k){if(this.controllerCallback)switch(k){case u.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},H}(P),function(I){I[I.StartRecording=1]="StartRecording",I[I.StopRecording=2]="StopRecording"}(u=t.MediaControllerEvent||(t.MediaControllerEvent={})),function(I){I[I.Photo=1]="Photo",I[I.Document=2]="Document",I[I.Whiteboard=3]="Whiteboard",I[I.BusinessCard=4]="BusinessCard"}(t.CameraStartMode||(t.CameraStartMode={})),function(I){I[I.Camera=1]="Camera",I[I.Gallery=2]="Gallery"}(t.Source||(t.Source={})),function(I){I[I.Image=1]="Image",I[I.Video=2]="Video",I[I.VideoAndImage=3]="VideoAndImage",I[I.Audio=4]="Audio"}(f=t.MediaType||(t.MediaType={})),function(I){I[I.ID=1]="ID",I[I.URL=2]="URL"}(t.ImageUriType||(t.ImageUriType={})),function(I){I[I.IMAGE=1]="IMAGE",I[I.PDF=2]="PDF"}(t.ImageOutputFormats||(t.ImageOutputFormats={})),t.selectMedia=function(I,H){if(!H)throw new Error("[select Media] Callback cannot be null");if(C(p,h.content,h.task),st(te)){try{na(I)}catch(j){return void H(j,[])}if(function(t){return!(null==t||t.maxMediaCount>10)}(I)){var k=[I];pe(R(lt,E.Media_SelectMedia),"selectMedia",k,function(j,J,G){var le,Ae;if(G)(function(t){return!(t.mediaType!=vt.MediaType.Video||!t.videoProps||!t.videoProps.videoController)})(I)&&(null===(Ae=null===(le=I?.videoProps)||void 0===le?void 0:le.videoController)||void 0===Ae||Ae.notifyEventToApp(G));else if(J){for(var Ot,rt=[],nt=Q(J);!(Ot=nt()).done;)rt.push(new v(Ot.value));H(j,rt)}else H(j,[])})}else H({errorCode:M.INVALID_ARGUMENTS},[])}else H({errorCode:M.OLD_PLATFORM},[])},t.viewImages=function(I,H){if(!H)throw new Error("[view images] Callback cannot be null");if(C(p,h.content,h.task),st(te))if(function(t){return!(null==t||t.length<=0||t.length>10)}(I)){var ue=[I];pe(R(lt,E.Media_ViewImages),"viewImages",ue,H)}else H({errorCode:M.INVALID_ARGUMENTS});else H({errorCode:M.OLD_PLATFORM})},t.scanBarCode=function(I,H){if(!I)throw new Error("[media.scanBarCode] Callback cannot be null");C(p,h.content,h.task),D.hostClientType!==U.desktop&&D.hostClientType!==U.web&&D.hostClientType!==U.rigel&&D.hostClientType!==U.teamsRoomsWindows&&D.hostClientType!==U.teamsRoomsAndroid&&D.hostClientType!==U.teamsPhones&&D.hostClientType!==U.teamsDisplays?st("1.9.0")?Ri(H)?pe(R(lt,E.Media_ScanBarCode),"media.scanBarCode",[H],I):I({errorCode:M.INVALID_ARGUMENTS},""):I({errorCode:M.OLD_PLATFORM},""):I({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},"")}}(vt||(vt={}));var xn,an,Nn=ce.V_2;(function(t){function a(){return!!(C(p)&&p.supports.barCode&&p.supports.permissions)}t.scanBarCode=function(u){return new Promise(function(l){if(C(p,h.content,h.task),!a())throw O;if(!Ri(u))throw{errorCode:M.INVALID_ARGUMENTS};l(et(R(Nn,E.BarCode_ScanBarCode),"media.scanBarCode",u))})},t.hasPermission=function(){if(C(p,h.content,h.task),!a())throw O;var u=X.Media;return new Promise(function(l){l(et(R(Nn,E.BarCode_HasPermission),"permissions.has",u))})},t.requestPermission=function(){if(C(p,h.content,h.task),!a())throw O;var u=X.Media;return new Promise(function(l){l(et(R(Nn,E.BarCode_RequestPermission),"permissions.request",u))})},t.isSupported=a})(xn||(xn={})),function(t){function a(l){return new Promise(function(s){if(C(p,h.content,h.task),!u())throw O;s(p.isLegacyTeams?kt("executeDeepLink",Ai([l.user],void 0,l.message)):kt("chat.openChat",{members:[l.user],message:l.message}))})}function u(){return!(!C(p)||!p.supports.chat)}t.openChat=a,t.openGroupChat=function(l){return new Promise(function(s){if(l.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===l.users.length)s(a({user:l.users[0],message:l.message}));else{if(C(p,h.content,h.task),!u())throw O;s(p.isLegacyTeams?kt("executeDeepLink",Ai(l.users,l.topic,l.message)):kt("chat.openChat",{members:l.users,message:l.message,topic:l.topic}))}})},t.isSupported=u}(an||(an={}));var pr,ki=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})},dr=ce.V_2;!function(t){function a(){return!!(C(p)&&navigator&&navigator.clipboard&&p.supports.clipboard)}t.write=function(u){return ki(this,void 0,void 0,Z().mark(function l(){var f;return Z().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(C(p,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel),a()){y.next=2;break}throw O;case 2:if(u.type&&Object.values(ee).includes(u.type)){y.next=4;break}throw new Error("Blob type "+u.type+" is not supported. Supported blob types are "+Object.values(ee));case 4:return y.next=6,Co(u);case 6:return f={mimeType:u.type,content:y.sent},y.abrupt("return",et(R(dr,E.Clipboard_Write),"clipboard.writeToClipboard",f));case 9:case"end":return y.stop()}},l)}))},t.read=function(){return ki(this,void 0,void 0,Z().mark(function u(){var l;return Z().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(C(p,h.content,h.meetingStage,h.task,h.settings,h.stage,h.sidePanel),a()){f.next=2;break}throw O;case 2:if(!Kn()&&D.hostClientType!==U.macos){f.next=9;break}return f.t0=JSON,f.next=6,ze("clipboard.readFromClipboard");case 6:return f.t1=f.sent,l=f.t0.parse.call(f.t0,f.t1),f.abrupt("return",Br(l.mimeType,l.content));case 9:return f.abrupt("return",et(R(dr,E.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return f.stop()}},u)}))},t.isSupported=a}(pr||(pr={}));var cn,un,sn=ce.V_2;function ca(){return p.hostVersionsInfo?p.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(t){function a(){return!!(C(p)&&p.supports.geoLocation&&p.supports.permissions)}t.getCurrentLocation=function(){if(C(p,h.content,h.task),!a())throw O;return et(R(sn,E.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},t.hasPermission=function(){if(C(p,h.content,h.task),!a())throw O;var l=X.GeoLocation;return new Promise(function(s){s(et(R(sn,E.GeoLocation_HasPermission),"permissions.has",l))})},t.requestPermission=function(){if(C(p,h.content,h.task),!a())throw O;var l=X.GeoLocation;return new Promise(function(s){s(et(R(sn,E.GeoLocation_RequestPermission),"permissions.request",l))})},t.isSupported=a,function(l){function s(){return!!(C(p)&&p.supports.geoLocation&&p.supports.geoLocation.map&&p.supports.permissions)}l.chooseLocation=function(){if(C(p,h.content,h.task),!s())throw O;return et(R(sn,E.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},l.showLocation=function(f){if(C(p,h.content,h.task),!s())throw O;if(!f)throw{errorCode:M.INVALID_ARGUMENTS};return et(R(sn,E.GeoLocation_ShowLocation),"location.showLocation",f)},l.isSupported=s}(t.map||(t.map={}))}(cn||(cn={}));var Di=function(){function t(){}var a=t.prototype;return a.postMessage=function(l,s){C(p),$("messageForChild",[l],s||At())},a.addEventListener=function(l,s){C(p),"message"===l&&oe("messageForParent",s)},t}(),ua=function(){function t(){}var a=t.prototype;return a.postMessage=function(l,s){C(p,h.task),$("messageForParent",[l],s||At())},a.addEventListener=function(l,s){C(p,h.task),"message"===l&&oe("messageForChild",s)},de(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();!function(t){function a(){return!(!C(p)||!p.supports.secondaryBrowser)}t.open=function(u){if(C(p,h.content),!a())throw O;if(!u||!Vr(u))throw{errorCode:M.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return ze("secondaryBrowser.open",u.toString())},t.isSupported=a}(un||(un={}));var Qt,Ct=ce.V_1;!function(t){function a(){return!(!C(p)||!p.supports.location)}t.getLocation=function(u,l){if(!l)throw new Error("[location.getLocation] Callback cannot be null");if(C(p,h.content,h.task),!st("1.9.0"))throw{errorCode:M.OLD_PLATFORM};if(!u)throw{errorCode:M.INVALID_ARGUMENTS};if(!a())throw O;pe(R(Ct,E.Location_GetLocation),"location.getLocation",[u],l)},t.showLocation=function(u,l){if(!l)throw new Error("[location.showLocation] Callback cannot be null");if(C(p,h.content,h.task),!st("1.9.0"))throw{errorCode:M.OLD_PLATFORM};if(!u)throw{errorCode:M.INVALID_ARGUMENTS};if(!a())throw O;pe(R(Ct,E.Location_ShowLocation),"location.showLocation",[u],l)},t.isSupported=a}(Qt||(Qt={}));var Ln,hr,la=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})};(function(t){var a,f,v;function w(v,P){C(p,h.sidePanel,h.meetingStage),$("meeting.updateMicState",[v,P])}(v=a||(a={}))[v.HostInitiated=0]="HostInitiated",v[v.AppInitiated=1]="AppInitiated",v[v.AppDeclinedToChange=2]="AppDeclinedToChange",v[v.AppFailedToChange=3]="AppFailedToChange",function(v){v.like="like",v.heart="heart",v.laugh="laugh",v.surprised="surprised",v.applause="applause"}(t.MeetingReactionType||(t.MeetingReactionType={})),function(v){v.Unknown="Unknown",v.Adhoc="Adhoc",v.Scheduled="Scheduled",v.Recurring="Recurring",v.Broadcast="Broadcast",v.MeetNow="MeetNow"}(t.MeetingType||(t.MeetingType={})),function(v){v.OneOnOneCall="oneOnOneCall",v.GroupCall="groupCall"}(t.CallType||(t.CallType={})),function(v){v.Collaborative="Collaborative",v.ScreenShare="ScreenShare"}(f=t.SharingProtocol||(t.SharingProtocol={})),t.getIncomingClientAudioState=function(v){if(!v)throw new Error("[get incoming client audio state] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("getIncomingClientAudioState",v)},t.toggleIncomingClientAudio=function(v){if(!v)throw new Error("[toggle incoming client audio] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("toggleIncomingClientAudio",v)},t.getMeetingDetails=function(v){if(!v)throw new Error("[get meeting details] Callback cannot be null");C(p,h.sidePanel,h.meetingStage,h.settings,h.content),$("meeting.getMeetingDetails",v)},t.getAuthenticationTokenForAnonymousUser=function(v){if(!v)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");C(p,h.sidePanel,h.meetingStage,h.task),$("meeting.getAuthenticationTokenForAnonymousUser",v)},t.getLiveStreamState=function(v){if(!v)throw new Error("[get live stream state] Callback cannot be null");C(p,h.sidePanel),$("meeting.getLiveStreamState",v)},t.requestStartLiveStreaming=function(v,P,I){if(!v)throw new Error("[request start live streaming] Callback cannot be null");C(p,h.sidePanel),$("meeting.requestStartLiveStreaming",[P,I],v)},t.requestStopLiveStreaming=function(v){if(!v)throw new Error("[request stop live streaming] Callback cannot be null");C(p,h.sidePanel),$("meeting.requestStopLiveStreaming",v)},t.registerLiveStreamChangedHandler=function(v){if(!v)throw new Error("[register live stream changed handler] Handler cannot be null");C(p,h.sidePanel),oe("meeting.liveStreamChanged",v)},t.shareAppContentToStage=function(v,P,I){if(void 0===I&&(I={sharingProtocol:f.Collaborative}),!v)throw new Error("[share app content to stage] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("meeting.shareAppContentToStage",[P,I],v)},t.getAppContentStageSharingCapabilities=function(v){if(!v)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("meeting.getAppContentStageSharingCapabilities",v)},t.stopSharingAppContentToStage=function(v){if(!v)throw new Error("[stop sharing app content to stage] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("meeting.stopSharingAppContentToStage",v)},t.getAppContentStageSharingState=function(v){if(!v)throw new Error("[get app content stage sharing state] Callback cannot be null");C(p,h.sidePanel,h.meetingStage),$("meeting.getAppContentStageSharingState",v)},t.registerSpeakingStateChangeHandler=function(v){if(!v)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),oe("meeting.speakingStateChanged",v)},t.registerRaiseHandStateChangedHandler=function(v){if(!v)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),oe("meeting.raiseHandStateChanged",v)},t.registerMeetingReactionReceivedHandler=function(v){if(!v)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");C(p,h.sidePanel,h.meetingStage),oe("meeting.meetingReactionReceived",v)},function(v){v.setOptions=function(P){C(p,h.sidePanel),P.contentUrl&&new URL(P.contentUrl),$("meeting.appShareButton.setOptions",[P])}}(t.appShareButton||(t.appShareButton={})),t.requestAppAudioHandling=function(v,P){if(!P)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!v.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");C(p,h.sidePanel,h.meetingStage),v.isAppHandlingAudio?function(v,P){var I=this;$("meeting.requestAppAudioHandling",[v.isAppHandlingAudio],function(H,ue){if(H&&null!=ue)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(H)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+H.errorCode+" "+H.message);if("boolean"!=typeof ue)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");oe("meeting.micStateChanged",function(W){return la(I,void 0,void 0,Z().mark(function k(){var j;return Z().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.prev=0,G.next=3,v.micMuteStateChangedCallback(W);case 3:w(j=G.sent,j.isMicMuted===W.isMicMuted?a.HostInitiated:a.AppDeclinedToChange),G.next=10;break;case 7:G.prev=7,G.t0=G.catch(0),w(W,a.AppFailedToChange);case 10:case"end":return G.stop()}},k,null,[[0,7]])}))}),oe("meeting.audioDeviceSelectionChanged",function(W){var k;null===(k=v.audioDeviceSelectionChangedCallback)||void 0===k||k.call(v,W)}),P(ue)})}(v,P):function(v,P){$("meeting.requestAppAudioHandling",[v.isAppHandlingAudio],function(I,H){if(I&&null!=H)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(I)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+I.errorCode+" "+I.message);if("boolean"!=typeof H)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");li("meeting.micStateChanged")&&tt("meeting.micStateChanged"),li("meeting.audioDeviceSelectionChanged")&&tt("meeting.audioDeviceSelectionChanged"),P(H)})}(v,P)},t.updateMicState=function(v){w(v,a.AppInitiated)}})(Ln||(Ln={})),function(t){function a(){return!(!C(p)||!p.supports.monetization)}t.openPurchaseExperience=function(u,l){var s,f;return"function"==typeof u?(s=u,f=l):f=u,C(p,h.content),function(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];var f=t.apply(void 0,l);return f.then(function(m){a&&a(null,m)}).catch(function(m){a&&a(m,null)}),f}(function(){return new Promise(function(m){if(!a())throw O;m(ze("monetization.openPurchaseExperience",f))})},s)},t.isSupported=a}(hr||(hr={}));var Un,Fi=ce.V_2;!function(t){function a(){return!(!C(p)||!p.supports.calendar)}t.openCalendarItem=function(u){return new Promise(function(l){if(C(p,h.content),!a())throw new Error("Not supported");if(!u.itemId||!u.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");l(Rt(R(Fi,E.Calendar_OpenCalendarItem),"calendar.openCalendarItem",u))})},t.composeMeeting=function(u){return new Promise(function(l){if(C(p,h.content),!a())throw new Error("Not supported");l(p.isLegacyTeams?kt("executeDeepLink",function(t,a,u,l,s){var f=void 0===t?"":"attendees="+t.map(function(v){return encodeURIComponent(v)}).join(","),m=void 0===a?"":"&startTime="+encodeURIComponent(a),y=void 0===u?"":"&endTime="+encodeURIComponent(u),S=void 0===l?"":"&subject="+encodeURIComponent(l),w=void 0===s?"":"&content="+encodeURIComponent(s);return Oe+"://"+Pe+"/l/meeting/new?"+f+m+y+S+w}(u.attendees,u.startTime,u.endTime,u.subject,u.content)):Rt(R(Fi,E.Calendar_ComposeMeeting),"calendar.composeMeeting",u))})},t.isSupported=a}(Un||(Un={}));var gr,Wt,vr,mr,Mi=ce.V_2;(function(t){function a(){return!(!C(p)||!p.supports.mail)}var l;t.openMailItem=function(l){return new Promise(function(s){if(C(p,h.content),!a())throw new Error("Not supported");if(!l.itemId||!l.itemId.trim())throw new Error("Must supply an itemId to openMailItem");s(Rt(R(Mi,E.Mail_OpenMailItem),"mail.openMailItem",l))})},t.composeMail=function(l){return new Promise(function(s){if(C(p,h.content),!a())throw new Error("Not supported");s(Rt(R(Mi,E.Mail_ComposeMail),"mail.composeMail",l))})},t.isSupported=a,(l=t.ComposeMailType||(t.ComposeMailType={})).New="new",l.Reply="reply",l.ReplyAll="replyAll",l.Forward="forward"})(gr||(gr={})),function(t){function a(){Ut().print()}function u(f,m){!Ue(f)&&C(p),!Ue(f)&&m&&m(),function(t){xe.loadHandler=t,!Ue(t)&&pe(R(ce.V_2,E.RegisterHandler),"registerHandler",["load"])}(f)}function l(f,m){!Ue(f)&&C(p),!Ue(f)&&m&&m(),function(t){xe.beforeUnloadHandler=t,!Ue(t)&&pe(R(ce.V_2,E.RegisterHandler),"registerHandler",["beforeUnload"])}(f)}function s(){return!(!C(p)||!p.supports.teamsCore)}t.enablePrintCapability=function(){if(!D.printCapabilityEnabled){if(C(p),!s())throw O;D.printCapabilityEnabled=!0,document.addEventListener("keydown",function(f){(f.ctrlKey||f.metaKey)&&80===f.keyCode&&(a(),f.cancelBubble=!0,f.preventDefault(),f.stopImmediatePropagation())})}},t.print=a,t.registerOnLoadHandler=function(f){u(f,function(){if(!Ue(f)&&!s())throw O})},t.registerOnLoadHandlerHelper=u,t.registerBeforeUnloadHandler=function(f){l(f,function(){if(!Ue(f)&&!s())throw O})},t.registerBeforeUnloadHandlerHelper=l,t.isSupported=s}(Wt||(Wt={})),function(t){function a(l){return new Promise(function(s){if(!st("2.0.0"))throw{errorCode:M.OLD_PLATFORM};if(!function(t){return!(t&&(t.title&&"string"!=typeof t.title||t.setSelected&&"object"!=typeof t.setSelected||t.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof t.openOrgWideSearchInChatOrChannel||t.singleSelect&&"boolean"!=typeof t.singleSelect))}(l))throw{errorCode:M.INVALID_ARGUMENTS};if(!u())throw O;s(ze("people.selectPeople",l))})}function u(){return!(!C(p)||!p.supports.people)}t.selectPeople=function(l,s){var f,m,y;return C(p,h.content,h.task,h.settings),"function"==typeof l?(m=(f=[l,s])[0],y=f[1]):y=l,function(t,a){for(var u=arguments.length,l=new Array(u>2?u-2:0),s=2;s<u;s++)l[s-2]=arguments[s];var f=t.apply(void 0,l);return f.then(function(m){a&&a(void 0,m)}).catch(function(m){a&&a(m)}),f}(a,m,y)},t.isSupported=u}(vr||(vr={})),function(t){t.showProfile=function(a){return C(p,h.content),new Promise(function(u){var l=function(t){return t?t.modality&&"string"!=typeof t.modality?[!1,"modality must be a string"]:t.targetElementBoundingRect&&"object"==typeof t.targetElementBoundingRect?t.triggerType&&"string"==typeof t.triggerType?function(t){return t?t.displayName&&"string"!=typeof t.displayName?[!1,"displayName must be a string"]:t.identifiers&&"object"==typeof t.identifiers?t.identifiers.AadObjectId||t.identifiers.Smtp||t.identifiers.Upn?t.identifiers.AadObjectId&&"string"!=typeof t.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:t.identifiers.Smtp&&"string"!=typeof t.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:t.identifiers.Upn&&"string"!=typeof t.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(t.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(a);if(!l[0])throw{errorCode:M.INVALID_ARGUMENTS,message:l[1]};u(ze("profile.showProfile",{modality:a.modality,persona:a.persona,triggerType:a.triggerType,targetRectangle:{x:a.targetElementBoundingRect.x,y:a.targetElementBoundingRect.y,width:a.targetElementBoundingRect.width,height:a.targetElementBoundingRect.height}}))})},t.isSupported=function(){return!(!C(p)||!p.supports.profile)}}(mr||(mr={}));var Dt,$t=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})};function Ni(t,a,u,l){var s,f;return $t(this,void 0,void 0,Z().mark(function m(){var y;return Z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return y=Ui(),!at()&&(null===(f=null===(s=window.chrome)||void 0===s?void 0:s.webview)||void 0===f||f.registerTextureStream(t,y)),w.t0=wr,w.next=5,Li(t,u,l);case 5:w.t1=w.sent,w.t2=new da(u,a),w.t3=y.writable,(0,w.t0)(w.t1,w.t2,w.t3);case 9:case"end":return w.stop()}},m)}))}function xi(t,a,u,l){var s,f;return $t(this,void 0,void 0,Z().mark(function m(){var y;return Z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return y=Ui(),!at()&&(null===(f=null===(s=window.chrome)||void 0===s?void 0:s.webview)||void 0===f||f.registerTextureStream(t,y)),w.t0=wr,w.next=5,Li(t,u,l);case 5:w.t1=w.sent,w.t2=new pa(u,a),w.t3=y.writable,(0,w.t0)(w.t1,w.t2,w.t3);case 9:case"end":return w.stop()}},m)}))}function Li(t,a,u){return $t(this,void 0,void 0,Z().mark(function l(){var s,f;return Z().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!at()){y.next=2;break}throw O;case 2:return s=Ut().chrome,y.prev=3,u?.reportGettingTextureStream(t),y.next=7,s.webview.getTextureStream(t);case 7:if(0!==(f=y.sent.getVideoTracks()).length){y.next=10;break}throw new Error("No video track in stream "+t);case 10:return y.abrupt("return",(u?.reportTextureStreamAcquired(),f[0]));case 13:throw y.prev=13,y.t0=y.catch(3),a("Failed to get video track from stream "+t+", error: "+y.t0),new Error("Internal error: can't get video track from stream "+t);case 16:case"end":return y.stop()}},l,null,[[3,13]])}))}function Ui(){if(at())throw O;var t=window.MediaStreamTrackGenerator;if(!t)throw O;return new t({kind:"video"})}function wr(t,a,u){new(Ut().MediaStreamTrackProcessor)({track:t}).readable.pipeThrough(new TransformStream(a)).pipeTo(u)}!function(t){t.TimestampIsNull="timestamp of the original video frame is null",t.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Dt||(Dt={}));var da=function(a,u){var l=this;this.notifyError=a,this.videoFrameHandler=u,this.transform=function(s,f){return $t(l,void 0,void 0,Z().mark(function m(){var y,S,w;return Z().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(null===(y=s.timestamp)){P.next=15;break}return P.prev=2,P.next=5,this.videoFrameHandler({videoFrame:s});case 5:S=P.sent,w=new VideoFrame(S,{timestamp:y}),f.enqueue(w),s.close(),S.close(),P.next=13;break;case 10:P.prev=10,P.t0=P.catch(2),s.close(),this.notifyError(P.t0);case 13:P.next=16;break;case 15:this.notifyError(Dt.TimestampIsNull);case 16:case"end":return P.stop()}},m,this,[[2,10]])}))}},yr=function(){function t(a,u){if(this.headerBuffer=a,this.notifyError=u,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(a),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return de(t,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),t}(),Hi=function(){function t(a,u){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var l=new Uint32Array(a),s=0,f=0;s<u;s++){var m=l[f++],y=l[f++],S=l[f++],w=new Uint8Array(a,y,S);this.metadataMap.set(m,w)}}return de(t,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),t}(),pa=function(a,u){var l=this;this.notifyError=a,this.videoFrameHandler=u,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(s,f){return $t(l,void 0,void 0,Z().mark(function m(){var y,S,w,v,I,H,ue;return Z().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(null===(y=s.timestamp)){k.next=22;break}return k.prev=2,k.next=5,this.extractVideoFrameAndMetadata(s);case 5:return w=(S=k.sent).videoFrame,I=(void 0===(v=S.metadata)?{}:v).audioInferenceResult,k.next=12,this.videoFrameHandler({videoFrame:w,audioInferenceResult:I});case 12:H=k.sent,ue=new VideoFrame(H,{timestamp:y}),f.enqueue(ue),w.close(),s.close(),H.close(),k.next=20;break;case 17:k.prev=17,k.t0=k.catch(2),s.close(),this.notifyError(k.t0);case 20:k.next=23;break;case 22:this.notifyError(Dt.TimestampIsNull);case 23:case"end":return k.stop()}},m,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(s){return $t(l,void 0,void 0,Z().mark(function f(){var m,y,S,w,v,P;return Z().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!at()){H.next=2;break}throw O;case 2:if("NV12"===s.format){H.next=4;break}throw this.notifyError(Dt.UnsupportedVideoFramePixelFormat),new Error(Dt.UnsupportedVideoFramePixelFormat);case 4:return m={x:0,y:0,width:s.codedWidth,height:2},y=new ArrayBuffer(m.width*m.height*3/2),H.next=7,s.copyTo(y,{rect:m});case 7:return S=new yr(y,this.notifyError),w={x:0,y:S.multiStreamHeaderRowOffset,width:s.codedWidth,height:s.codedHeight-S.multiStreamHeaderRowOffset},v=new ArrayBuffer(w.width*w.height*3/2),H.next=10,s.copyTo(v,{rect:w});case 10:return P=new Hi(v,S.multiStreamCount),H.abrupt("return",{videoFrame:new VideoFrame(s,{timestamp:s.timestamp,visibleRect:{x:0,y:S.frameRowOffset,width:S.frameWidth,height:S.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:P.audioInferenceResult}});case 12:case"end":return H.stop()}},f,this)}))},oe("video.mediaStream.audioInferenceDiscardStatusChange",function(s){l.shouldDiscardAudioInferenceResult=s.discardAudioInferenceResult})};function Vi(t,a){return function(u,l){a?.reportApplyingVideoEffect(u||"",l),t(u,l).then(function(){a?.reportVideoEffectChanged(u||"",l),$("video.videoEffectReadiness",[!0,u,void 0,l])}).catch(function(s){$("video.videoEffectReadiness",[!1,u,s in Ft.EffectFailureReason?s:Ft.EffectFailureReason.InitializationFailure,l])})}}var Jt=function(){function t(){}return t.setTimeout=function(u,l){var s=performance.now(),f=Lr();return t.setTimeoutCallbacks[f]={callback:u,timeoutInMs:l,startedAtInMs:s},f},t.clearTimeout=function(u){delete t.setTimeoutCallbacks[u]},t.setInterval=function(u,l){t.setTimeout(function s(){u(),t.setTimeout(s,l)},l)},t.tick=function(){var u=performance.now(),l=[];for(var s in t.setTimeoutCallbacks){var f=t.setTimeoutCallbacks[s];u-f.startedAtInMs>=f.timeoutInMs&&l.push(s)}for(var m=0,y=l;m<y.length;m++){var S=y[m];t.setTimeoutCallbacks[S].callback(),delete t.setTimeoutCallbacks[S]}},t}();Jt.setTimeoutCallbacks={};var Cr=function(){function t(u,l){this.reportStatisticsResult=l,this.sampleCount=0,this.distributionBins=new Uint32Array(u)}var a=t.prototype;return a.processStarts=function(l,s,f,m){Jt.tick(),this.suitableForThisSession(l,s,f,m)||this.reportAndResetSession(this.getStatistics(),l,m,s,f),this.start()},a.processEnds=function(){var l=performance.now()-this.frameProcessingStartedAt,s=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,l)));this.distributionBins[s]+=1,this.sampleCount+=1},a.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},a.start=function(){this.frameProcessingStartedAt=performance.now()},a.suitableForThisSession=function(l,s,f,m){return this.currentSession&&this.currentSession.effectId===l&&this.currentSession.effectParam===m&&this.currentSession.frameWidth===s&&this.currentSession.frameHeight===f},a.reportAndResetSession=function(l,s,f,m,y){var S=this;l&&this.reportStatisticsResult(l),this.resetCurrentSession(this.getNextTimeout(s,this.currentSession),s,f,m,y),this.timeoutId&&Jt.clearTimeout(this.timeoutId),this.timeoutId=Jt.setTimeout(function(){return S.reportAndResetSession(S.getStatistics(),s,f,m,y)}.bind(this),this.currentSession.timeoutInMs)},a.resetCurrentSession=function(l,s,f,m,y){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:l,effectId:s,effectParam:f,frameWidth:m,frameHeight:y},this.sampleCount=0,this.distributionBins.fill(0)},a.getNextTimeout=function(l,s){return s&&s.effectId===l?Math.min(t.maxSessionTimeoutInMs,2*s.timeoutInMs):t.initialSessionTimeoutInMs},t}();Cr.initialSessionTimeoutInMs=1e3,Cr.maxSessionTimeoutInMs=3e4;var Hn=function(){function t(u){var l=this;this.reportPerformanceEvent=u,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Cr(t.distributionBinSize,function(s){return l.reportPerformanceEvent("video.performance.performanceDataGenerated",[s])})}var a=t.prototype;return a.startMonitorSlowFrameProcessing=function(){var l=this;Jt.setInterval(function(){if(0!==l.processedFrameCount){var s=l.frameProcessingTimeCost/l.processedFrameCount;s>l.frameProcessTimeLimit&&l.reportPerformanceEvent("video.performance.frameProcessingSlow",[s]),l.frameProcessingTimeCost=0,l.processedFrameCount=0}},t.calculateFPSInterval)},a.setFrameProcessTimeLimit=function(l){this.frameProcessTimeLimit=l},a.reportApplyingVideoEffect=function(l,s){var f,m;(null===(f=this.applyingEffect)||void 0===f?void 0:f.effectId)===l&&(null===(m=this.applyingEffect)||void 0===m?void 0:m.effectParam)===s||(this.applyingEffect={effectId:l,effectParam:s},this.appliedEffect=void 0)},a.reportVideoEffectChanged=function(l,s){void 0===this.applyingEffect||this.applyingEffect.effectId!==l&&this.applyingEffect.effectParam!==s||(this.appliedEffect={effectId:l,effectParam:s},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},a.reportStartFrameProcessing=function(l,s){Jt.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,l,s,this.appliedEffect.effectParam))},a.reportFrameProcessed=function(){var l;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(l=this.appliedEffect)||void 0===l?void 0:l.effectParam])))},a.reportGettingTextureStream=function(l){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=l},a.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var l=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,l])}},t}();Hn.distributionBinSize=1e3,Hn.calculateFPSInterval=1e3;var Ft,Vn,Sr,br,Er=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})};(function(t){var W,a=at()?void 0:new Hn($);function m(W){$("video.notifyError",[W])}function y(){return C(p)&&!!p.supports.video&&(!!p.supports.video.mediaStream||!!p.supports.video.sharedFrame)}function w(W,k){var j=this;return function(J){return Er(j,void 0,void 0,Z().mark(function G(){var le,Ae;return Z().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return le=J.videoFrame,k?.reportStartFrameProcessing(le.codedWidth,le.codedHeight),nt.next=4,W(J);case 4:return Ae=nt.sent,nt.abrupt("return",(k?.reportFrameProcessed(),Ae));case 6:case"end":return nt.stop()}},G)}))}}function v(W,k){if(C(p,h.sidePanel),!y()||!ue())throw O;oe("video.newVideoFrame",function(j){if(j){var J=j.timestamp;a?.reportStartFrameProcessing(j.width,j.height),W(function(W){if("videoFrameBuffer"in W)return W;var k=W.data,j=function(a,u){var l={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&u.indexOf(s)<0&&(l[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)u.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(l[s[f]]=a[s[f]])}return l}(W,["data"]);return Object.assign(Object.assign({},j),{videoFrameBuffer:k})}(j),function(){a?.reportFrameProcessed(),function(W){$("video.videoFrameProcessed",[W])}(J)},m)}},!1),$("video.registerForVideoFrame",[k])}function I(){var W;return C(p,h.sidePanel)&&function(){var W,k,j,J;return!(null===(k=null===(W=Ut().chrome)||void 0===W?void 0:W.webview)||void 0===k||!k.getTextureStream||null===(J=null===(j=Ut().chrome)||void 0===j?void 0:j.webview)||void 0===J||!J.registerTextureStream)}()&&!(null===(W=p.supports.video)||void 0===W||!W.mediaStream)}function ue(){var W;return C(p,h.sidePanel)&&!(null===(W=p.supports.video)||void 0===W||!W.sharedFrame)}(t.VideoFrameFormat||(t.VideoFrameFormat={})).NV12="NV12",(W=t.EffectChangeType||(t.EffectChangeType={})).EffectChanged="EffectChanged",W.EffectDisabled="EffectDisabled",function(W){W.InvalidEffectId="InvalidEffectId",W.InitializationFailure="InitializationFailure"}(t.EffectFailureReason||(t.EffectFailureReason={})),t.registerForVideoFrame=function(W){if(C(p,h.sidePanel),!y())throw O;if(!W.videoFrameHandler||!W.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(oe("video.setFrameProcessTimeLimit",function(k){return a?.setFrameProcessTimeLimit(k.timeLimit)},!1),I())!function(W,k){var j=this;if(C(p,h.sidePanel),!y()||!I())throw O;oe("video.startVideoExtensibilityVideoStream",function(J){return Er(j,void 0,void 0,Z().mark(function G(){var le,Ae;return Z().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return le=J.streamId,Ae=w(W,a),nt.next=3,Ni(le,Ae,m,a);case 3:case"end":return nt.stop()}},G)}))},!1),$("video.mediaStream.registerForVideoFrame",[k])}(W.videoFrameHandler,W.config);else{if(!ue())throw O;v(W.videoBufferHandler,W.config)}a?.startMonitorSlowFrameProcessing()},t.notifySelectedVideoEffectChanged=function(W,k){if(C(p,h.sidePanel),!y())throw O;$("video.videoEffectChanged",[W,k])},t.registerForVideoEffect=function(W){if(C(p,h.sidePanel),!y())throw O;oe("video.effectParameterChange",Vi(W,a),!1),$("video.registerForVideoEffect")},t.isSupported=y})(Ft||(Ft={})),function(t){var a="search.queryChange",u="search.queryClose",l="search.queryExecute";function s(){return!(!C(p)||!p.supports.search)}t.registerHandlers=function(f,m,y){if(C(p,h.content),!s())throw O;oe(u,f),oe(l,m),y&&oe(a,y)},t.unregisterHandlers=function(){if(C(p,h.content),!s())throw O;$("search.unregister"),tt(a),tt(u),tt(l)},t.isSupported=s,t.closeSearch=function(){return new Promise(function(f){if(C(p,h.content),!s())throw new Error("Not supported");f(kt("search.closeSearch"))})}}(Vn||(Vn={})),function(t){function a(m){return new Promise(function(y){if(!f())throw O;y(ze(t.SharingAPIMessages.shareWebContent,m))})}function f(){return!(!C(p)||!p.supports.sharing)}t.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},t.shareWebContent=function(m,y){try{(function(m){if(!(m&&m.content&&m.content.length))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content is missing"}})(m),function(m){if(m.content.some(function(S){return!S.type}))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(m.content.some(function(S){return S.type!==m.content[0].type}))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(m),function(m){if("URL"!==m.content[0].type)throw{errorCode:M.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(m.content.some(function(S){return!S.url}))throw{errorCode:M.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(m)}catch(S){return Hr(function(){return Promise.reject(S)},y)}return C(p,h.content,h.sidePanel,h.task,h.stage,h.meetingStage),Hr(a,y,m)},t.isSupported=f}(Sr||(Sr={})),function(t){var l;function u(){return!(!C(p)||!p.supports.stageView)}(l=t.StageViewOpenMode||(t.StageViewOpenMode={})).modal="modal",l.popout="popout",l.popoutWithChat="popoutWithChat",t.open=function(l){return new Promise(function(s){if(C(p,h.content),!u())throw O;if(!l)throw new Error("[stageView.open] Stage view params cannot be null");s(ze("stageView.open",l))})},t.isSupported=u}(br||(br={}));var Pr,Ar,Gi=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})};(function(t){var l,s;(s=t.CameraRestriction||(t.CameraRestriction={}))[s.FrontOrRear=1]="FrontOrRear",s[s.FrontOnly=2]="FrontOnly",s[s.RearOnly=3]="RearOnly",function(s){s[s.Camera=1]="Camera",s[s.Gallery=2]="Gallery"}(t.Source||(t.Source={})),t.hasPermission=function(){if(C(p,h.content,h.task),!l.isSupported())throw O;return ze("permissions.has",X.Media)},t.requestPermission=function(){if(C(p,h.content,h.task),!l.isSupported())throw O;return ze("permissions.request",X.Media)},function(s){function f(){return!!(C(p)&&p.supports.visualMedia&&p.supports.visualMedia.image&&p.supports.permissions)}function m(){if(!f())throw O}function y(w){if(!w||w.maxVisualMediaCount>10||w.maxVisualMediaCount<1)throw go}function S(w,v){if(v.length>w)throw vo}s.captureImages=function(w){return Gi(this,void 0,void 0,Z().mark(function v(){var P;return Z().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return C(p,h.content,h.task),m(),y(w),H.next=3,ze("visualMedia.image.captureImages",w);case 3:return H.abrupt("return",(S(w.maxVisualMediaCount,P=H.sent),P));case 5:case"end":return H.stop()}},v)}))},s.retrieveImages=function(w){return Gi(this,void 0,void 0,Z().mark(function v(){var P;return Z().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return C(p,h.content,h.task),m(),y(w),H.next=3,ze("visualMedia.image.retrieveImages",w);case 3:return H.abrupt("return",(S(w.maxVisualMediaCount,P=H.sent),P));case 5:case"end":return H.stop()}},v)}))},s.isSupported=f}(l=t.image||(t.image={}))})(Pr||(Pr={})),function(t){function a(){return!(!C(p)||!p.supports.webStorage)}t.isWebStorageClearedOnUserLogOut=function(){return C(p),a()},t.isSupported=a}(Ar||(Ar={}));var Ir,Tr,ha=ce.V_2;(function(t){var a,l;function u(){return!(!C(p)||!p.supports.call)}(l=a=t.CallModalities||(t.CallModalities={})).Unknown="unknown",l.Audio="audio",l.Video="video",l.VideoBasedScreenSharing="videoBasedScreenSharing",l.Data="data",t.startCall=function(l){var s=R(ha,E.Call_StartCall);return new Promise(function(f){var m;if(C(p,h.content,h.task),!u())throw O;if(!p.isLegacyTeams)return pe(s,"call.startCall",[l],f);f(tn(s,"executeDeepLink",function(t,a,u){if(0===t.length)throw new Error("Must have at least one target when creating a call deep link");var l="users="+t.map(function(m){return encodeURIComponent(m)}).join(","),s=void 0===a?"":"&withVideo="+encodeURIComponent(a),f=void 0===u?"":"&source="+encodeURIComponent(u);return Oe+"://"+Pe+"/l/call/0/0?"+l+s+f}(l.targets,null===(m=l.requestedModalities)||void 0===m?void 0:m.includes(a.Video),l.source)).then(function(y){if(!y)throw new Error("The call was not properly started");return y}))})},t.isSupported=u})(Ir||(Ir={})),function(t){t.Messages=dt.Messages,t.FailedReason=dt.FailedReason,t.ExpectedFailureReason=dt.ExpectedFailureReason,t.notifyAppLoaded=function(){dt.notifyAppLoaded()},t.notifySuccess=function(){dt.notifySuccess()},t.notifyFailure=function(a){dt.notifyFailure(a)},t.notifyExpectedFailure=function(a){dt.notifyExpectedFailure(a)}}(Tr||(Tr={}));var Bn,Wi=se("thirdPartyCloudStorage");!function(t){var a=[],u={fileType:"",assembleAttachment:[]},l=!0,s=null;function f(y){if(s)if(y&&y.error)s([],y.error),s=null;else if(y&&y.fileChunk)try{l||0!==y.fileChunk.chunkSequence||(Wi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),l=!0,s([],{errorCode:M.INTERNAL_ERROR,message:"error occurred while receiving data"}),a=[],s=null);var S=On(y.fileChunk,y.fileType);if(S?u.assembleAttachment.push(S):(Wi("Received a null assemble attachment for when decoding chunk sequence "+y.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),s?s([],{errorCode:M.INTERNAL_ERROR,message:"error occurred while receiving data"}):s=null,a=[],s=null,l=!0),l=y.fileChunk.endOfFile,y.fileChunk.endOfFile){var w=on(u.assembleAttachment,u.fileType);if(w){var v=new File([w],y.fileName,{type:w.type});a.push(v)}y.isLastFile&&s&&(s(a,y.error),a=[],s=null,l=!0),u={fileType:"",assembleAttachment:[]}}}catch(P){s&&(s([],{errorCode:M.INTERNAL_ERROR,message:P}),a=[],s=null,l=!0)}else s([],{errorCode:M.INTERNAL_ERROR,message:"data received is null"}),a=[],s=null,l=!0}function m(){return!(!C(p)||!p.supports.thirdPartyCloudStorage)}t.getDragAndDropFiles=function(y,S){if(!S)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(y&&""!==y){if(C(p,h.content,h.task),!m())throw O;if(s)throw s=null,new Error("getDragAndDropFiles cannot be called twice");s=S,l=!0,$("thirdPartyCloudStorage.getDragAndDropFiles",[y],f)}else S([],{errorCode:M.INVALID_ARGUMENTS})},t.isSupported=m}(Bn||(Bn={}));var Ze=ce.V_1;function zi(t,a){_t(R(Ze,E.PublicAPIs_Initialize),a).then(function(){t&&t()})}function ji(){Wt.enablePrintCapability()}function _i(){Wt.print()}function qi(t){wt(),pe(R(Ze,E.PublicAPIs_GetContext),"getContext",function(a){a.frameContext||(a.frameContext=D.frameContext),t(a)})}function ga(t){Ie(R(Ze,E.PublicAPIs_RegisterOnThemeChangeHandlerHelper),t)}function Gn(t){ct(R(Ze,E.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",t,[])}function va(t){ct(R(Ze,E.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",t,[h.content])}function ln(t){ct(R(Ze,E.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",t,[h.content])}function Qi(t){ct(R(Ze,E.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",t,[h.content])}function $i(t){Ye.backStack.registerBackButtonHandlerHelper(R(Ze,E.PublicAPIs_RegisterBackButtonHandler),t)}function Ji(t){Wt.registerOnLoadHandlerHelper(t)}function Yi(t){Wt.registerBeforeUnloadHandlerHelper(t)}function Zi(t){ct(R(Ze,E.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",t,[])}function Rr(t){ct(R(Ze,E.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",t,[h.content])}function Xi(t,a){C(p),oi(R(Ze,E.PublicAPIs_GetTabInstances),a).then(function(u){t(u)})}function Ki(t,a){C(p),ai(R(Ze,E.PublicAPIs_GetMruTabInstances),a).then(function(u){t(u)})}function St(t){si(R(Ze,E.PublicAPIs_ShareDeepLink),{subPageId:t.subEntityId,subPageLabel:t.subEntityLabel,subPageWebUrl:t.subEntityWebUrl})}function je(t,a){C(p,h.content,h.sidePanel,h.settings,h.task,h.stage,h.meetingStage);var u=a??At();Se(R(Ze,E.PublicAPIs_ExecuteDeepLink),t).then(function(){u(!0)}).catch(function(l){u(!1,l.message)})}function kr(t){tr(R(Ze,E.PublicAPIs_SetFrameContext),t)}function eo(t,a,u){_t(R(Ze,E.PublicAPIs_Initialize),u).then(function(){return a&&a()}),tr(R(Ze,E.PublicAPIs_SetFrameContext),t)}var Mt,fn=ce.V_1;function to(t){ii(R(fn,E.Navigation_ReturnFocus),t)}function no(t,a){C(p);var u=a??At();ri(R(fn,E.Navigation_NavigateToTab),t).then(function(){u(!0)}).catch(function(l){u(!1,l.message)})}function ro(t,a){C(p,h.content,h.sidePanel,h.settings,h.remove,h.task,h.stage,h.meetingStage);var u=a??At();ti(R(fn,E.Navigation_NavigateCrossDomain),t).then(function(){u(!0)}).catch(function(l){u(!1,l.message)})}function Yt(t){C(p);var a=t??At();ni(R(fn,E.Navigation_NavigateBack)).then(function(){a(!0)}).catch(function(u){a(!1,u.message)})}!function(t){t.setValidityState=function(a){Ye.config.setValidityState(a)},t.getSettings=function(a){C(p,h.content,h.settings,h.remove,h.sidePanel),Ye.getConfig().then(function(u){a(u)})},t.setSettings=function(a,u){C(p,h.content,h.settings,h.sidePanel);var l=u??At();Ye.config.setConfig(a).then(function(){l(!0)}).catch(function(s){l(!1,s.message)})},t.registerOnSaveHandler=function(a){Ye.config.registerOnSaveHandlerHelper(a)},t.registerOnRemoveHandler=function(a){Ye.config.registerOnRemoveHandlerHelper(a)}}(Mt||(Mt={}));var Fr,Wn,Dr=ce.V_1;(function(t){function l(s){return s.height=s.height?s.height:xt.Small,s.width=s.width?s.width:xt.Small,s}t.startTask=function(s,f){var m=R(Dr,E.Tasks_StartTask),y=f?function(S){var w,v;return f(null!==(w=S.err)&&void 0!==w?w:"",null!==(v=S.result)&&void 0!==v?v:"")}:void 0;return void 0===s.card&&void 0===s.url||s.card?(C(p,h.content,h.sidePanel,h.meetingStage),pe(m,"tasks.startTask",[s],f)):void 0!==s.completionBotId?er(m,function(s){if(void 0===s.url||void 0===s.completionBotId)throw new Error("Both url "+s.url+" and completionBotId "+s.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:s.url,size:{height:s.height?s.height:xt.Small,width:s.width?s.width:xt.Small},title:s.title,fallbackUrl:s.fallbackUrl,completionBotId:s.completionBotId}}(s),y):Zr(m,function(s){if(void 0===s.url)throw new Error("url property of taskInfo object can't be undefined");return{url:s.url,size:{height:s.height?s.height:xt.Small,width:s.width?s.width:xt.Small},title:s.title,fallbackUrl:s.fallbackUrl}}(s),y),new Di},t.updateTask=function(s){var S=function(a,u){var l={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&u.indexOf(s)<0&&(l[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)u.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(l[s[f]]=a[s[f]])}return l}(s=l(s),["width","height"]);if(Object.keys(S).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Yr(R(Dr,E.Tasks_UpdateTask),s)},t.submitTask=function(s,f){Xr(R(Dr,E.Tasks_SubmitTask),s,f)},t.getDefaultSizeIfNotProvided=l})(Fr||(Fr={})),function(t){var l;(l=t.UserMeetingRole||(t.UserMeetingRole={})).guest="Guest",l.attendee="Attendee",l.presenter="Presenter",l.organizer="Organizer",function(l){l.added="Added",l.alreadyExists="AlreadyExists",l.conflict="Conflict",l.notFound="NotFound"}(t.ContainerState||(t.ContainerState={})),t.isSupported=function(){return!(!C(p,h.meetingStage,h.sidePanel)||!p.supports.interactive)}}(Wn||(Wn={}));var wa=function(){function t(){}var a=t.prototype;return a.getFluidTenantInfo=function(){return bt(),new Promise(function(l){l(ze("interactive.getFluidTenantInfo"))})},a.getFluidToken=function(l){return bt(),new Promise(function(s){s(ze("interactive.getFluidToken",l))})},a.getFluidContainerId=function(){return bt(),new Promise(function(l){l(ze("interactive.getFluidContainerId"))})},a.setFluidContainerId=function(l){return bt(),new Promise(function(s){s(ze("interactive.setFluidContainerId",l))})},a.getNtpTime=function(){return bt(),new Promise(function(l){l(ze("interactive.getNtpTime"))})},a.registerClientId=function(l){return bt(),new Promise(function(s){s(ze("interactive.registerClientId",l))})},a.getClientRoles=function(l){return bt(),new Promise(function(s){s(ze("interactive.getClientRoles",l))})},a.getClientInfo=function(l){return bt(),new Promise(function(s){s(ze("interactive.getClientInfo",l))})},t.create=function(){return bt(),new t},t}();function bt(){if(!Wn.isSupported())throw new Error("LiveShareHost Not supported")}var ya=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function zn(t){try{return t.cartItems=oo(t.cartItems),t}catch{throw new Error("Error deserializing cart")}}function oo(t){return t.map(function(a){if(a.imageURL){var u=new URL(a.imageURL);a.imageURL=u}return a.accessories&&(a.accessories=oo(a.accessories)),a})}var Sa=function t(a){try{return a.map(function(u){var l=u.imageURL,s=u.accessories,f=function(a,u){var l={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&u.indexOf(s)<0&&(l[s]=a[s]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(s=Object.getOwnPropertySymbols(a);f<s.length;f++)u.indexOf(s[f])<0&&Object.prototype.propertyIsEnumerable.call(a,s[f])&&(l[s[f]]=a[s[f]])}return l}(u,["imageURL","accessories"]),m=Object.assign({},f);return l&&(m.imageURL=l.href),s&&(m.accessories=t(s)),m})}catch{throw new Error("Error serializing cart items")}};function Ea(t){if(null!=t){if(!Array.isArray(t)||0===t.length)throw new Error("CartItem.accessories must be a non-empty array");for(var u,a=Q(t);!(u=a()).done;){var l=u.value;if(l.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");ao(l)}}}function ao(t){if(!t.id)throw new Error("cartItem.id must not be empty");if(!t.name)throw new Error("cartItem.name must not be empty");(function(t){if("number"!=typeof t||t<0)throw new Error("price "+t+" must be a number not less than 0");if(parseFloat(t.toFixed(3))!==t)throw new Error("price "+t+" must have at most 3 decimal places")})(t.price),function(t){if("number"!=typeof t||t<=0||parseInt(t.toString())!==t)throw new Error("quantity "+t+" must be an integer greater than 0")}(t.quantity)}function Mr(t){if(null!=t){if(!t)throw new Error("id must not be empty");if(!1===("string"==typeof(a=t)&&ya.test(a)))throw new Error("id must be a valid UUID")}var a}var pn,Or,hn,gn,vn,mn,jn,dn=ce.V_2;(function(t){var s;function l(){return!(!C(p)||!p.supports.marketplace)}t.cartVersion={majorVersion:1,minorVersion:1},(s=t.Intent||(t.Intent={})).TACAdminUser="TACAdminUser",s.TeamsAdminUser="TeamsAdminUser",s.TeamsEndUser="TeamsEndUser",function(s){s.Open="Open",s.Processing="Processing",s.Processed="Processed",s.Closed="Closed",s.Error="Error"}(t.CartStatus||(t.CartStatus={})),t.getCart=function(){if(C(p,h.content,h.task),!l())throw O;return et(R(dn,E.Marketplace_GetCart),"marketplace.getCart",t.cartVersion).then(zn)},t.addOrUpdateCartItems=function(s){if(C(p,h.content,h.task),!l())throw O;if(!s)throw new Error("addOrUpdateCartItemsParams must be provided");return Mr(s?.cartId),function(t){if(!Array.isArray(t)||0===t.length)throw new Error("cartItems must be a non-empty array");for(var u,a=Q(t);!(u=a()).done;){var l=u.value;ao(l),Ea(l.accessories)}}(s?.cartItems),et(R(dn,E.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},s),{cartItems:Sa(s.cartItems),cartVersion:t.cartVersion})).then(zn)},t.removeCartItems=function(s){if(C(p,h.content,h.task),!l())throw O;if(!s)throw new Error("removeCartItemsParams must be provided");if(Mr(s?.cartId),!Array.isArray(s?.cartItemIds)||0===s?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return et(R(dn,E.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},s),{cartVersion:t.cartVersion})).then(zn)},t.updateCartStatus=function(s){if(C(p,h.content,h.task),!l())throw O;if(!s)throw new Error("updateCartStatusParams must be provided");return Mr(s?.cartId),function(t){if(!Object.values(pn.CartStatus).includes(t))throw new Error("cartStatus "+t+" is not valid")}(s?.cartStatus),et(R(dn,E.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},s),{cartVersion:t.cartVersion})).then(zn)},t.isSupported=l})(pn||(pn={})),function(t){var u,s,y,a="Action.Execute";function f(y){if(y.requestType===u.ActionExecuteInvokeRequest){if(y.type!==a)throw{errorCode:s.INTERNAL_ERROR,message:"Invalid action type "+y.type+'. Action type must be "'+a+'"'}}else if(y.requestType===u.QueryMessageExtensionRequest){if(y.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(y.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var v,w=Q(y.parameters);!(v=w()).done;){var P=v.value;if(P.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(P.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function m(){return!(!C(p)||!p.supports.externalAppAuthentication)}(y=u=t.OriginalRequestType||(t.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",y.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(y){y.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",y.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(t.InvokeResponseType||(t.InvokeResponseType={})),function(y){y.INTERNAL_ERROR="INTERNAL_ERROR"}(s=t.InvokeErrorCode||(t.InvokeErrorCode={})),t.authenticateAndResendRequest=function(y,S,w){if(C(p,h.content),!m())throw O;return Kt(y),f(w),ut("externalAppAuthentication.authenticateAndResendRequest",[y,w,S.url.href,S.width,S.height,S.isExternal]).then(function(v){var I=v[1];if(v[0]&&null!=I.responseType)return I;throw I})},t.authenticateWithSSO=function(y,S){if(C(p,h.content),!m())throw O;return Kt(y),ut("externalAppAuthentication.authenticateWithSSO",[y,S.claims,S.silent]).then(function(w){if(!w[0])throw w[1]})},t.authenticateWithSSOAndResendRequest=function(y,S,w){if(C(p,h.content),!m())throw O;return Kt(y),f(w),ut("externalAppAuthentication.authenticateWithSSOAndResendRequest",[y,w,S.claims,S.silent]).then(function(v){var I=v[1];if(v[0]&&null!=I.responseType)return I;throw I})},t.isSupported=m}(Or||(Or={})),function(t){var f;function s(){return!(!C(p)||!p.supports.externalAppCardActions)}(f=t.ActionOpenUrlType||(t.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",f.DeepLinkOther="DeepLinkOther",f.DeepLinkStageView="DeepLinkStageView",f.GenericUrl="GenericUrl",function(f){f.INTERNAL_ERROR="INTERNAL_ERROR",f.INVALID_LINK="INVALID_LINK",f.NOT_SUPPORTED="NOT_SUPPORTED"}(t.ActionOpenUrlErrorCode||(t.ActionOpenUrlErrorCode={})),function(f){f.INTERNAL_ERROR="INTERNAL_ERROR"}(t.ActionSubmitErrorCode||(t.ActionSubmitErrorCode={})),t.processActionSubmit=function(f,m){if(C(p,h.content),!s())throw O;return Kt(f),ut("externalAppCardActions.processActionSubmit",[f,m]).then(function(y){if(!y[0])throw y[1]})},t.processActionOpenUrl=function(f,m){if(C(p,h.content),!s())throw O;return Kt(f),ut("externalAppCardActions.processActionOpenUrl",[f,m.href]).then(function(y){var S=y[0];if(S)throw S;return y[1]})},t.isSupported=s}(hn||(hn={})),function(t){var S;function y(S,w){return{errorCode:S,message:w}}(S=t.CloudStorageProvider||(t.CloudStorageProvider={})).Dropbox="DROPBOX",S.Box="BOX",S.Sharefile="SHAREFILE",S.GoogleDrive="GOOGLEDRIVE",S.Egnyte="EGNYTE",S.SharePoint="SharePoint",function(S){S[S.Sharepoint=0]="Sharepoint",S[S.WopiIntegration=1]="WopiIntegration",S[S.Google=2]="Google",S[S.OneDrive=3]="OneDrive",S[S.Recent=4]="Recent",S[S.Aggregate=5]="Aggregate",S[S.FileSystem=6]="FileSystem",S[S.Search=7]="Search",S[S.AllFiles=8]="AllFiles",S[S.SharedWithMe=9]="SharedWithMe"}(t.CloudStorageProviderType||(t.CloudStorageProviderType={})),function(S){S.ClassMaterials="classMaterials"}(t.SpecialDocumentLibraryType||(t.SpecialDocumentLibraryType={})),function(S){S.Readonly="readonly"}(t.DocumentLibraryAccessType||(t.DocumentLibraryAccessType={})),function(S){S.Downloaded="Downloaded",S.Downloading="Downloading",S.Failed="Failed"}(t.FileDownloadStatus||(t.FileDownloadStatus={})),function(S){S.Download="DOWNLOAD",S.Upload="UPLOAD",S.Delete="DELETE"}(t.CloudStorageProviderFileAction||(t.CloudStorageProviderFileAction={})),t.getCloudStorageFolders=function(S,w){if(C(p,h.content),!S||0===S.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!w)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");$("files.getCloudStorageFolders",[S],w)},t.addCloudStorageFolder=function(S,w){if(C(p,h.content),!S||0===S.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!w)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");$("files.addCloudStorageFolder",[S],w)},t.deleteCloudStorageFolder=function(S,w,v){if(C(p,h.content),!S)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!w)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!v)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");$("files.deleteCloudStorageFolder",[S,w],v)},t.getCloudStorageFolderContents=function(S,w,v){if(C(p,h.content),!S||!w)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!v)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in S&&!S.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");$("files.getCloudStorageFolderContents",[S,w],v)},t.openCloudStorageFile=function(S,w,v){if(C(p,h.content),!S||!w)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(S.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");$("files.openCloudStorageFile",[S,w,v])},t.getExternalProviders=function(S,w){if(void 0===S&&(S=!1),C(p,h.content),!w)throw new Error("[files.getExternalProviders] Callback cannot be null");$("files.getExternalProviders",[S],w)},t.copyMoveFiles=function(S,w,v,P,I,H){if(void 0===I&&(I=!1),C(p,h.content),!S||0===S.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!w)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!v)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!P)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!H)throw new Error("[files.copyMoveFiles] callback cannot be null");$("files.copyMoveFiles",[S,w,v,P,I],H)},t.getFileDownloads=function(S){if(C(p,h.content),!S)throw new Error("[files.getFileDownloads] Callback cannot be null");$("files.getFileDownloads",[],S)},t.openDownloadFolder=function(S,w){if(void 0===S&&(S=void 0),C(p,h.content),!w)throw new Error("[files.openDownloadFolder] Callback cannot be null");$("files.openDownloadFolder",[S],w)},t.addCloudStorageProvider=function(S){if(C(p,h.content),!S)throw y(M.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");$("files.addCloudStorageProvider",[],S)},t.removeCloudStorageProvider=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!S||!S.content)throw y(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");$("files.removeCloudStorageProvider",[S],w)},t.addCloudStorageProviderFile=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!S||!S.content)throw y(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");$("files.addCloudStorageProviderFile",[S],w)},t.renameCloudStorageProviderFile=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!S||!S.content)throw y(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");$("files.renameCloudStorageProviderFile",[S],w)},t.deleteCloudStorageProviderFile=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(S&&S.content&&S.content.itemList&&S.content.itemList.length>0))throw y(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");$("files.deleteCloudStorageProviderFile",[S],w)},t.downloadCloudStorageProviderFile=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(S&&S.content&&S.content.itemList&&S.content.itemList.length>0))throw y(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");$("files.downloadCloudStorageProviderFile",[S],w)},t.uploadCloudStorageProviderFile=function(S,w){if(C(p,h.content),!w)throw y(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(S&&S.content&&S.content.itemList&&S.content.itemList.length>0))throw y(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!S.content.destinationFolder)throw y(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");$("files.uploadCloudStorageProviderFile",[S],w)},t.registerCloudStorageProviderListChangeHandler=function(S){if(C(p),!S)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");oe("files.cloudStorageProviderListChange",S)},t.registerCloudStorageProviderContentChangeHandler=function(S){if(C(p),!S)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");oe("files.cloudStorageProviderContentChange",S)}}(gn||(gn={})),function(t){function a(){return!(!C(p)||!p.supports.meetingRoom)}t.getPairedMeetingRoomInfo=function(){return new Promise(function(u){if(C(p),!a())throw O;u(ze("meetingRoom.getPairedMeetingRoomInfo"))})},t.sendCommandToPairedMeetingRoom=function(u){return new Promise(function(l){if(!u||0==u.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(C(p),!a())throw O;l(ze("meetingRoom.sendCommandToPairedMeetingRoom",u))})},t.registerMeetingRoomCapabilitiesUpdateHandler=function(u){if(!u)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(C(p),!a())throw O;oe("meetingRoom.meetingRoomCapabilitiesUpdate",function(l){C(p),u(l)})},t.registerMeetingRoomStatesUpdateHandler=function(u){if(!u)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(C(p),!a())throw O;oe("meetingRoom.meetingRoomStatesUpdate",function(l){C(p),u(l)})},t.isSupported=a}(vn||(vn={})),function(t){function a(){return!(!C(p)||!p.supports.notifications)}t.showNotification=function(u){if(C(p,h.content),!a())throw O;$("notifications.showNotification",[u])},t.isSupported=a}(mn||(mn={})),function(t){var f;function s(){return!(!C(p)||!p.supports.remoteCamera)}(f=t.ControlCommand||(t.ControlCommand={})).Reset="Reset",f.ZoomIn="ZoomIn",f.ZoomOut="ZoomOut",f.PanLeft="PanLeft",f.PanRight="PanRight",f.TiltUp="TiltUp",f.TiltDown="TiltDown",function(f){f[f.CommandResetError=0]="CommandResetError",f[f.CommandZoomInError=1]="CommandZoomInError",f[f.CommandZoomOutError=2]="CommandZoomOutError",f[f.CommandPanLeftError=3]="CommandPanLeftError",f[f.CommandPanRightError=4]="CommandPanRightError",f[f.CommandTiltUpError=5]="CommandTiltUpError",f[f.CommandTiltDownError=6]="CommandTiltDownError",f[f.SendDataError=7]="SendDataError"}(t.ErrorReason||(t.ErrorReason={})),function(f){f[f.None=0]="None",f[f.ControlDenied=1]="ControlDenied",f[f.ControlNoResponse=2]="ControlNoResponse",f[f.ControlBusy=3]="ControlBusy",f[f.AckTimeout=4]="AckTimeout",f[f.ControlTerminated=5]="ControlTerminated",f[f.ControllerTerminated=6]="ControllerTerminated",f[f.DataChannelError=7]="DataChannelError",f[f.ControllerCancelled=8]="ControllerCancelled",f[f.ControlDisabled=9]="ControlDisabled",f[f.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(t.SessionTerminatedReason||(t.SessionTerminatedReason={})),t.getCapableParticipants=function(f){if(!f)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(C(p,h.sidePanel),!s())throw O;$("remoteCamera.getCapableParticipants",f)},t.requestControl=function(f,m){if(!f)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!m)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(C(p,h.sidePanel),!s())throw O;$("remoteCamera.requestControl",[f],m)},t.sendControlCommand=function(f,m){if(!f)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!m)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(C(p,h.sidePanel),!s())throw O;$("remoteCamera.sendControlCommand",[f],m)},t.terminateSession=function(f){if(!f)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(C(p,h.sidePanel),!s())throw O;$("remoteCamera.terminateSession",f)},t.registerOnCapableParticipantsChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw O;oe("remoteCamera.capableParticipantsChange",f)},t.registerOnErrorHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw O;oe("remoteCamera.handlerError",f)},t.registerOnDeviceStateChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw O;oe("remoteCamera.deviceStateChange",f)},t.registerOnSessionStatusChangeHandler=function(f){if(!f)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(C(p,h.sidePanel),!s())throw O;oe("remoteCamera.sessionStatusChange",f)},t.isSupported=s}(jn||(jn={}));var Zt,wn,co=ce.V_1;(function(t){function a(){return!(!C(p)||!p.supports.appEntity)}t.selectAppEntity=function(u,l,s,f){if(C(p,h.content),!a())throw O;if(!u||0==u.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!f)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");pe(R(co,E.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[u,l,s],f)},t.isSupported=a})(Zt||(Zt={})),function(t){var s;function l(){return!(!C(p)||!p.supports.teams)}(s=t.ChannelType||(t.ChannelType={}))[s.Regular=0]="Regular",s[s.Private=1]="Private",s[s.Shared=2]="Shared",t.getTeamChannels=function(s,f){if(C(p,h.content),!l())throw O;if(!s)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!f)throw new Error("[teams.getTeamChannels] Callback cannot be null");$("teams.getTeamChannels",[s],f)},t.refreshSiteUrl=function(s,f){if(C(p),!l())throw O;if(!s)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!f)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");$("teams.refreshSiteUrl",[s],f)},t.isSupported=l,function(s){function m(){return!(!C(p)||!p.supports.teams||!p.supports.teams.fullTrust)}(function(y){function S(){return!!(C(p)&&p.supports.teams&&p.supports.teams.fullTrust&&p.supports.teams.fullTrust.joinedTeams)}y.getUserJoinedTeams=function(w){return new Promise(function(v){if(C(p),!S())throw O;if((D.hostClientType===U.android||D.hostClientType===U.teamsRoomsAndroid||D.hostClientType===U.teamsPhones||D.hostClientType===U.teamsDisplays)&&!st("2.0.1"))throw new Error(JSON.stringify({errorCode:M.OLD_PLATFORM}));v(kn("getUserJoinedTeams",w))})},y.isSupported=S})(s.joinedTeams||(s.joinedTeams={})),s.getConfigSetting=function(y){return new Promise(function(S){if(C(p),!m())throw O;S(kn("getConfigSetting",y))})},s.isSupported=m}(t.fullTrust||(t.fullTrust={}))}(wn||(wn={}));var _n,uo=function(a,u,l,s){return new(l||(l=Promise))(function(m,y){function S(P){try{v(s.next(P))}catch(I){y(I)}}function w(P){try{v(s.throw(P))}catch(I){y(I)}}function v(P){P.done?m(P.value):function(m){return m instanceof l?m:new l(function(y){y(m)})}(P.value).then(S,w)}v((s=s.apply(a,u||[])).next())})};!function(t){t.frameProcessingTimeoutInMs=2e3;var u,w,a=at()?void 0:new Hn($);function l(){var w=setTimeout(function(){S("Frame not processed in "+t.frameProcessingTimeoutInMs+"ms",u.Warn)},t.frameProcessingTimeoutInMs);return function(){clearTimeout(w)}}function s(w,v){var P=this;return function(I){return uo(P,void 0,void 0,Z().mark(function H(){var ue,W,k;return Z().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return v.reportStartFrameProcessing((ue=I.videoFrame).codedWidth,ue.codedHeight),W=l(),J.next=5,w(I);case 5:return k=J.sent,J.abrupt("return",(W(),v.reportFrameProcessed(),k));case 7:case"end":return J.stop()}},H)}))}}function m(){return C(p),Ft.isSupported()}function S(w,v){void 0===v&&(v=u.Warn),$("video.notifyError",[w,v])}(w=u=t.ErrorLevel||(t.ErrorLevel={})).Fatal="fatal",w.Warn="warn",t.registerForVideoFrame=function(w){var P,I,v=this;if(!m())throw O;if(!w.videoFrameHandler||!w.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(C(p,h.sidePanel)){if(oe("video.setFrameProcessTimeLimit",function(H){return a?.setFrameProcessTimeLimit(H)},!1),null===(P=p.supports.video)||void 0===P?void 0:P.mediaStream)oe("video.startVideoExtensibilityVideoStream",function(H){return uo(v,void 0,void 0,Z().mark(function ue(){var W,k,j;return Z().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(W=H.streamId,k=H.metadataInTexture,j=a?s(w.videoFrameHandler,a):w.videoFrameHandler,!k){G.next=6;break}return G.next=4,xi(W,j,S,a);case 4:G.next=8;break;case 6:return G.next=8,Ni(W,j,S,a);case 8:case"end":return G.stop()}},ue)}))},!1),$("video.mediaStream.registerForVideoFrame",[w.config]);else{if(null===(I=p.supports.video)||void 0===I||!I.sharedFrame)throw O;oe("video.newVideoFrame",function(H){if(H){a?.reportStartFrameProcessing(H.width,H.height);var ue=l(),W=H.timestamp;w.videoBufferHandler(function(w){return w.videoFrameBuffer=w.videoFrameBuffer||w.data,delete w.data,w}(H),function(){ue(),a?.reportFrameProcessed(),function(w){$("video.videoFrameProcessed",[w])}(W)},S)}},!1),$("video.registerForVideoFrame",[w.config])}a?.startMonitorSlowFrameProcessing()}},t.notifySelectedVideoEffectChanged=function(w,v,P){if(C(p,h.sidePanel),!m())throw O;$("video.videoEffectChanged",[w,v,P])},t.registerForVideoEffect=function(w){if(C(p,h.sidePanel),!m())throw O;oe("video.effectParameterChange",Vi(w,a),!1),$("video.registerForVideoEffect")},t.updatePersonalizedEffects=function(w){if(C(p,h.sidePanel),!Ft.isSupported())throw O;$("video.personalizedEffectsChanged",[w])},t.isSupported=m,t.notifyFatalError=function(w){if(C(p),!Ft.isSupported())throw O;S(w,u.Fatal)}}(_n||(_n={}))}(),Qe}()},62113:function(ge,qe,q){"use strict";q.d(qe,{Q:function(){return Xe}});var R,D,de=q(81337),Fe=q(29019),Q=q(66422),Z=q(37241),ye=q(41170),L_clientInfoDecodingError_code="client_info_decoding_error",L_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",L_clientInfoEmptyError_code="client_info_empty_error",L_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",L_tokenParsingError_code="token_parsing_error",L_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",L_nullOrEmptyToken_code="null_or_empty_token",L_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",L_endpointResolutionError_code="endpoints_resolution_error",L_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",L_networkError_code="network_error",L_networkError_desc="Network request failed. Please check network trace to determine root cause.",L_unableToGetOpenidConfigError_code="openid_config_error",L_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",L_hashNotDeserialized_code="hash_not_deserialized",L_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",L_invalidStateError_code="invalid_state",L_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",L_stateMismatchError_code="state_mismatch",L_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",L_stateNotFoundError_code="state_not_found",L_stateNotFoundError_desc="State not found",L_nonceMismatchError_code="nonce_mismatch",L_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",L_nonceNotFoundError_code="nonce_not_found",L_nonceNotFoundError_desc="nonce not found",L_multipleMatchingTokens_code="multiple_matching_tokens",L_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",L_multipleMatchingAccounts_code="multiple_matching_accounts",L_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",L_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",L_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",L_tokenRequestCannotBeMade_code="request_cannot_be_made",L_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",L_appendEmptyScopeError_code="cannot_append_empty_scope",L_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",L_removeEmptyScopeError_code="cannot_remove_empty_scope",L_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",L_appendScopeSetError_code="cannot_append_scopeset",L_appendScopeSetError_desc="Cannot append ScopeSet due to error.",L_emptyInputScopeSetError_code="empty_input_scopeset",L_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",L_DeviceCodePollingCancelled_code="device_code_polling_cancelled",L_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",L_DeviceCodeExpired_code="device_code_expired",L_DeviceCodeExpired_desc="Device code is expired.",L_DeviceCodeUnknownError_code="device_code_unknown_error",L_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",L_NoAccountInSilentRequest_code="no_account_in_silent_request",L_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",L_invalidCacheRecord_code="invalid_cache_record",L_invalidCacheRecord_desc="Cache record object was null or undefined.",L_invalidCacheEnvironment_code="invalid_cache_environment",L_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",L_noAccountFound_code="no_account_found",L_noAccountFound_desc="No account found in cache for given key.",L_CachePluginError_code="no cache plugin set on CacheManager",L_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",L_noCryptoObj_code="no_crypto_object",L_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",L_invalidCacheType_code="invalid_cache_type",L_invalidCacheType_desc="Invalid cache type",L_unexpectedAccountType_code="unexpected_account_type",L_unexpectedAccountType_desc="Unexpected account type.",L_unexpectedCredentialType_code="unexpected_credential_type",L_unexpectedCredentialType_desc="Unexpected credential type.",L_invalidAssertion_code="invalid_assertion",L_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",L_invalidClientCredential_code="invalid_client_credential",L_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",L_tokenRefreshRequired_code="token_refresh_required",L_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",L_userTimeoutReached_code="user_timeout_reached",L_userTimeoutReached_desc="User defined timeout for device code polling reached",L_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",L_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",L_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",L_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",L_bindingKeyNotRemovedError_code="binding_key_not_removed",L_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",L_logoutNotSupported_code="end_session_endpoint_not_supported",L_logoutNotSupported_desc="Provided authority does not support logout.",L_keyIdMissing_code="key_id_missing",L_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",Re=function(D){function A(N,Y){var ve=D.call(this,N,Y)||this;return ve.name="ClientAuthError",Object.setPrototypeOf(ve,A.prototype),ve}return(0,Z.ZT)(A,D),A.createClientInfoDecodingError=function(N){return new A(L_clientInfoDecodingError_code,L_clientInfoDecodingError_desc+" Failed with error: "+N)},A.createClientInfoEmptyError=function(){return new A(L_clientInfoEmptyError_code,""+L_clientInfoEmptyError_desc)},A.createTokenParsingError=function(N){return new A(L_tokenParsingError_code,L_tokenParsingError_desc+" Failed with error: "+N)},A.createTokenNullOrEmptyError=function(N){return new A(L_nullOrEmptyToken_code,L_nullOrEmptyToken_desc+" Raw Token Value: "+N)},A.createEndpointDiscoveryIncompleteError=function(N){return new A(L_endpointResolutionError_code,L_endpointResolutionError_desc+" Detail: "+N)},A.createNetworkError=function(N,Y){return new A(L_networkError_code,L_networkError_desc+" | Fetch client threw: "+Y+" | Attempted to reach: "+N.split("?")[0])},A.createUnableToGetOpenidConfigError=function(N){return new A(L_unableToGetOpenidConfigError_code,L_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+N)},A.createHashNotDeserializedError=function(N){return new A(L_hashNotDeserialized_code,L_hashNotDeserialized_desc+" Given Object: "+N)},A.createInvalidStateError=function(N,Y){return new A(L_invalidStateError_code,L_invalidStateError_desc+" Invalid State: "+N+", Root Err: "+Y)},A.createStateMismatchError=function(){return new A(L_stateMismatchError_code,L_stateMismatchError_desc)},A.createStateNotFoundError=function(N){return new A(L_stateNotFoundError_code,L_stateNotFoundError_desc+":  "+N)},A.createNonceMismatchError=function(){return new A(L_nonceMismatchError_code,L_nonceMismatchError_desc)},A.createNonceNotFoundError=function(N){return new A(L_nonceNotFoundError_code,L_nonceNotFoundError_desc+":  "+N)},A.createMultipleMatchingTokensInCacheError=function(){return new A(L_multipleMatchingTokens_code,L_multipleMatchingTokens_desc+".")},A.createMultipleMatchingAccountsInCacheError=function(){return new A(L_multipleMatchingAccounts_code,L_multipleMatchingAccounts_desc)},A.createMultipleMatchingAppMetadataInCacheError=function(){return new A(L_multipleMatchingAppMetadata_code,L_multipleMatchingAppMetadata_desc)},A.createTokenRequestCannotBeMadeError=function(){return new A(L_tokenRequestCannotBeMade_code,L_tokenRequestCannotBeMade_desc)},A.createAppendEmptyScopeToSetError=function(N){return new A(L_appendEmptyScopeError_code,L_appendEmptyScopeError_desc+" Given Scope: "+N)},A.createRemoveEmptyScopeFromSetError=function(N){return new A(L_removeEmptyScopeError_code,L_removeEmptyScopeError_desc+" Given Scope: "+N)},A.createAppendScopeSetError=function(N){return new A(L_appendScopeSetError_code,L_appendScopeSetError_desc+" Detail Error: "+N)},A.createEmptyInputScopeSetError=function(){return new A(L_emptyInputScopeSetError_code,""+L_emptyInputScopeSetError_desc)},A.createDeviceCodeCancelledError=function(){return new A(L_DeviceCodePollingCancelled_code,""+L_DeviceCodePollingCancelled_desc)},A.createDeviceCodeExpiredError=function(){return new A(L_DeviceCodeExpired_code,""+L_DeviceCodeExpired_desc)},A.createDeviceCodeUnknownError=function(){return new A(L_DeviceCodeUnknownError_code,""+L_DeviceCodeUnknownError_desc)},A.createNoAccountInSilentRequestError=function(){return new A(L_NoAccountInSilentRequest_code,""+L_NoAccountInSilentRequest_desc)},A.createNullOrUndefinedCacheRecord=function(){return new A(L_invalidCacheRecord_code,L_invalidCacheRecord_desc)},A.createInvalidCacheEnvironmentError=function(){return new A(L_invalidCacheEnvironment_code,L_invalidCacheEnvironment_desc)},A.createNoAccountFoundError=function(){return new A(L_noAccountFound_code,L_noAccountFound_desc)},A.createCachePluginError=function(){return new A(L_CachePluginError_code,""+L_CachePluginError_desc)},A.createNoCryptoObjectError=function(N){return new A(L_noCryptoObj_code,""+L_noCryptoObj_desc+N)},A.createInvalidCacheTypeError=function(){return new A(L_invalidCacheType_code,""+L_invalidCacheType_desc)},A.createUnexpectedAccountTypeError=function(){return new A(L_unexpectedAccountType_code,""+L_unexpectedAccountType_desc)},A.createUnexpectedCredentialTypeError=function(){return new A(L_unexpectedCredentialType_code,""+L_unexpectedCredentialType_desc)},A.createInvalidAssertionError=function(){return new A(L_invalidAssertion_code,""+L_invalidAssertion_desc)},A.createInvalidCredentialError=function(){return new A(L_invalidClientCredential_code,""+L_invalidClientCredential_desc)},A.createRefreshRequiredError=function(){return new A(L_tokenRefreshRequired_code,L_tokenRefreshRequired_desc)},A.createUserTimeoutReachedError=function(){return new A(L_userTimeoutReached_code,L_userTimeoutReached_desc)},A.createTokenClaimsRequiredError=function(){return new A(L_tokenClaimsRequired_code,L_tokenClaimsRequired_desc)},A.createNoAuthCodeInServerResponseError=function(){return new A(L_noAuthorizationCodeFromServer_code,L_noAuthorizationCodeFromServer_desc)},A.createBindingKeyNotRemovedError=function(){return new A(L_bindingKeyNotRemovedError_code,L_bindingKeyNotRemovedError_desc)},A.createLogoutNotSupportedError=function(){return new A(L_logoutNotSupported_code,L_logoutNotSupported_desc)},A.createKeyIdMissingError=function(){return new A(L_keyIdMissing_code,L_keyIdMissing_desc)},A}(ye.l),Qe=function(){function D(){}return D.decodeAuthToken=function(A){if(D.isEmpty(A))throw Re.createTokenNullOrEmptyError(A);var Y=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(A);if(!Y||Y.length<4)throw Re.createTokenParsingError("Given token is malformed: "+JSON.stringify(A));return{header:Y[1],JWSPayload:Y[2],JWSSig:Y[3]}},D.isEmpty=function(A){return typeof A>"u"||!A||0===A.length},D.isEmptyObj=function(A){if(A&&!D.isEmpty(A))try{var N=JSON.parse(A);return 0===Object.keys(N).length}catch{}return!0},D.startsWith=function(A,N){return 0===A.indexOf(N)},D.endsWith=function(A,N){return A.length>=N.length&&A.lastIndexOf(N)===A.length-N.length},D.queryStringToObject=function(A){var N={},Y=A.split("&"),ve=function(me){return decodeURIComponent(me.replace(/\+/g," "))};return Y.forEach(function(ae){if(ae.trim()){var me=ae.split(/=(.+)/g,2),Ne=me[0],Ce=me[1];Ne&&Ce&&(N[ve(Ne)]=ve(Ce))}}),N},D.trimArrayEntries=function(A){return A.map(function(N){return N.trim()})},D.removeEmptyStringsFromArray=function(A){return A.filter(function(N){return!D.isEmpty(N)})},D.jsonParseHelper=function(A){try{return JSON.parse(A)}catch{return null}},D.matchPattern=function(A,N){return new RegExp(A.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(N)},D}();(D=R||(R={}))[D.Default=0]="Default",D[D.Adfs=1]="Adfs";var Le=function(){function D(){}return D.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Q.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},D.prototype.generateAccountKey=function(){return D.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},D.prototype.generateType=function(){switch(this.authorityType){case Q.iR.ADFS_ACCOUNT_TYPE:return Q.LL.ADFS;case Q.iR.MSAV1_ACCOUNT_TYPE:return Q.LL.MSA;case Q.iR.MSSTS_ACCOUNT_TYPE:return Q.LL.MSSTS;case Q.iR.GENERIC_ACCOUNT_TYPE:return Q.LL.GENERIC;default:throw Re.createUnexpectedAccountTypeError()}},D.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},D.generateAccountCacheKey=function(A){return[A.homeAccountId,A.environment||Q.gT.EMPTY_STRING,A.tenantId||Q.gT.EMPTY_STRING].join(Q.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},D.createAccount=function(A,N,Y,ve,ae,me,Ne,Ce,V){var x,z,M,X,ee,U,he=new D;he.authorityType=Q.iR.MSSTS_ACCOUNT_TYPE,he.clientInfo=A,he.homeAccountId=N,he.nativeAccountId=V;var h=Ce||ve&&ve.getPreferredCache();if(!h)throw Re.createInvalidCacheEnvironmentError();return he.environment=h,he.realm=(null===(x=Y?.claims)||void 0===x?void 0:x.tid)||Q.gT.EMPTY_STRING,he.oboAssertion=ae,Y&&(he.idTokenClaims=Y.claims,he.localAccountId=(null===(z=Y?.claims)||void 0===z?void 0:z.oid)||(null===(M=Y?.claims)||void 0===M?void 0:M.sub)||Q.gT.EMPTY_STRING,he.username=(null===(X=Y?.claims)||void 0===X?void 0:X.preferred_username)||(null!==(ee=Y?.claims)&&void 0!==ee&&ee.emails?Y.claims.emails[0]:Q.gT.EMPTY_STRING),he.name=null===(U=Y?.claims)||void 0===U?void 0:U.name),he.cloudGraphHostName=me,he.msGraphHost=Ne,he},D.createGenericAccount=function(A,N,Y,ve,ae,me,Ne){var Ce,V,x,z,M=new D;M.authorityType=Y&&Y.authorityType===R.Adfs?Q.iR.ADFS_ACCOUNT_TYPE:Q.iR.GENERIC_ACCOUNT_TYPE,M.homeAccountId=A,M.realm=Q.gT.EMPTY_STRING,M.oboAssertion=ve;var X=Ne||Y&&Y.getPreferredCache();if(!X)throw Re.createInvalidCacheEnvironmentError();return N&&(M.localAccountId=(null===(Ce=N?.claims)||void 0===Ce?void 0:Ce.oid)||(null===(V=N?.claims)||void 0===V?void 0:V.sub)||Q.gT.EMPTY_STRING,M.username=(null===(x=N?.claims)||void 0===x?void 0:x.upn)||Q.gT.EMPTY_STRING,M.name=(null===(z=N?.claims)||void 0===z?void 0:z.name)||Q.gT.EMPTY_STRING,M.idTokenClaims=N?.claims),M.environment=X,M.cloudGraphHostName=ae,M.msGraphHost=me,M},D.generateHomeAccountId=function(A,N,Y,ve,ae){var me,Ne=null!==(me=ae?.claims)&&void 0!==me&&me.sub?ae.claims.sub:Q.gT.EMPTY_STRING;if(N===R.Adfs)return Ne;if(A)try{var Ce=function(D,A){if(Qe.isEmpty(D))throw Re.createClientInfoEmptyError();try{var N=A.base64Decode(D);return JSON.parse(N)}catch(Y){throw Re.createClientInfoDecodingError(Y)}}(A,ve);if(!Qe.isEmpty(Ce.uid)&&!Qe.isEmpty(Ce.utid))return""+Ce.uid+Q.Bv.CLIENT_INFO_SEPARATOR+Ce.utid}catch{}return Y.verbose("No client info in response"),Ne},D.isAccountEntity=function(A){return!!A&&A.hasOwnProperty("homeAccountId")&&A.hasOwnProperty("environment")&&A.hasOwnProperty("realm")&&A.hasOwnProperty("localAccountId")&&A.hasOwnProperty("username")&&A.hasOwnProperty("authorityType")},D.accountInfoIsEqual=function(A,N,Y){if(!A||!N)return!1;var ve=!0;if(Y){var ae=A.idTokenClaims||{},me=N.idTokenClaims||{};ve=ae.iat===me.iat&&ae.nonce===me.nonce}return A.homeAccountId===N.homeAccountId&&A.localAccountId===N.localAccountId&&A.username===N.username&&A.tenantId===N.tenantId&&A.environment===N.environment&&A.nativeAccountId===N.nativeAccountId&&ve},D}(),ce=q(4633),E=q(98049),be=q(19270),Ve=q(66070),re=function(D){function A(N,Y){var ve=D.call(this,N)||this;return ve.message=N,ve.msalError=Y,ve}return(0,de.__extends)(A,D),A}(Error),ne=q(41114),te="PBI.App.AdHocTokenAcquisition",ie=ne.cx[te]=(0,ne.b1)(te),fe="PBI.App.AdHocTokenAcquisition.UserConfirmation",Me=ne.cx[fe]=(0,ne.b1)(fe),Oe=q(50423),Pe=q(58938),He=q(65181),Ge=window,Xe=function(){function D(A,N,Y){this.dialogService=A,this.localizationService=N,this.telemetryService=Y,this.msalClientApplication=Ge.msalClientApplication}return D.prototype.acquireToken=function(A,N,Y){var ve;return void 0===Y&&(Y=!1),(0,de.__awaiter)(this,void 0,void 0,function(){var ae,me,Ne,Ce,V;return(0,de.__generator)(this,function(x){switch(x.label){case 0:if(ae=this.retrieveSignedInAccount(),me=this.telemetryService.startActivity(null,ie,{scenarioName:A,authMethod:"Silent"}),!ae)return[3,5];x.label=1;case 1:return x.trys.push([1,3,,4]),[4,this.msalClientApplication.acquireTokenSilent({scopes:N,account:ae,forceRefresh:Y})];case 2:return Ne=x.sent(),me.resolve(),[2,{token:Ne.accessToken,expiry:Ne.expiresOn}];case 3:throw(Ce=x.sent()).constructor.name===Fe.Yo.name?(me.reject({errorSource:"External",errorMessage:V=be.fW.UserInteractionRequired,errorCode:"UserInteractionRequired"}),new re(V,Ce)):(V=null!==(ve=Ce.message)&&void 0!==ve?ve:Ce,me.reject({errorSource:"External",errorMessage:V,errorCode:Ce.code}),new re("Error code: ".concat(Ce.code,", error message: ").concat(V),Ce));case 4:return[3,6];case 5:throw me.reject({errorSource:"PowerBI",errorMessage:V=be.fW.UserNotSignedIn,errorCode:"UserNotSignedIn"}),Error(V);case 6:return[2]}})})},D.prototype.acquireTokenPopup=function(A,N){return(0,de.__awaiter)(this,void 0,void 0,function(){var Y=this;return(0,de.__generator)(this,function(ve){return[2,Ve.kB.retryOnInteractionInProgressError(function(){return Y.acquireTokenPopupInternal(A,N)})]})})},D.prototype.acquireTokenPopupInternal=function(A,N){var Y;return(0,de.__awaiter)(this,void 0,void 0,function(){var ae,me,Ne,Ce,V,x;return(0,de.__generator)(this,function(z){switch(z.label){case 0:return[4,this.dialogService.open(E.J,{data:{title:this.localizationService.get("AcquireToken_Dialog_VerifyIdentity"),ariaLabel:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),message:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),cancelButtonText:this.localizationService.get("ModalDialog_Cancel")},autoFocus:!0}).afterClosed().toPromise()];case 1:if(ae=z.sent(),this.telemetryService.logEvent(Me,{scenarioName:A,authMethod:"Popup",result:1===ae}),1!==ae)throw Error(be.fW.UserInteractionDeclined);me=this.retrieveSignedInAccount(),Ne=this.telemetryService.startActivity(null,ie,{scenarioName:A,authMethod:"Popup"}),z.label=2;case 2:return z.trys.push([2,4,,5]),[4,this.msalClientApplication.acquireTokenPopup({scopes:N,account:me})];case 3:return Ce=z.sent(),this.msalClientApplication.setActiveAccount(Ce.account),[3,5];case 4:throw V=z.sent(),x=null!==(Y=V.message)&&void 0!==Y?Y:V,Ne.reject({errorSource:"External",errorMessage:x,errorCode:V.code}),new re("Error code: ".concat(V.code,", error message: ").concat(x),V);case 5:if(!Le.accountInfoIsEqual(me??null,Ce.account))throw Ne.reject({errorSource:"External",errorMessage:be.fW.UserAccountChanged,errorCode:"UserAccountChanged"}),this.reloadPage(),Error(be.fW.UserAccountChanged);return Ne.resolve(),[2,{token:Ce.accessToken,expiry:Ce.expiresOn}]}})})},D.prototype.reloadPage=function(){window.location.reload()},D.prototype.retrieveSignedInAccount=function(){return Ge.signInProviderService.retrieveSignedInAccount()},D.\u0275fac=function(N){return new(N||D)(Oe.\u0275\u0275inject(Pe.x),Oe.\u0275\u0275inject(He.o),Oe.\u0275\u0275inject(ce.y0))},D.\u0275prov=Oe.\u0275\u0275defineInjectable({token:D,factory:D.\u0275fac,providedIn:"root"}),D}()},30587:function(ge,qe,q){"use strict";q.r(qe),q.d(qe,{DataflowGen2PublishErrorModule:function(){return cc}});var ye,e,L,Re,Qe,Ee,se,R,ee,U,he,h,de=q(81337),Fe=q(32293),Q=q(74076),Z=q(38078);function ne(e,n){return e.kind===n.kind}(e=ye||(ye={})).Cancel="Cancel",e.Commit="Commit",function(e){e.AlwaysCancel="AlwaysCancel",e.AlwaysCommit="AlwaysCommit",e.Ask="Ask"}(L||(L={})),function(e){e.Custom="Custom",e.Standard="Standard",e.System="System"}(Re||(Re={})),function(e){e.Action="Action.Type",e.Any="Any.Type",e.Binary="Binary.Type",e.Byte="Byte.Type",e.Character="Character.Type",e.Currency="Currency.Type",e.Date="Date.Type",e.DateTime="DateTime.Type",e.DateTimeZone="DateTimeZone.Type",e.Decimal="Decimal.Type",e.Double="Double.Type",e.Duration="Duration.Type",e.Function="Function.Type",e.Int16="Int16.Type",e.Int32="Int32.Type",e.Int64="Int64.Type",e.Int8="Int8.Type",e.List="List.Type",e.Logical="Logical.Type",e.None="None.Type",e.Null="Null.Type",e.Number="Number.Type",e.Percentage="Percentage.Type",e.Record="Record.Type",e.Single="Single.Type",e.Table="Table.Type",e.Text="Text.Type",e.Time="Time.Type",e.Type="Type.Type"}(Qe||(Qe={})),function(e){e[e.Fullscreen=0]="Fullscreen",e[e.LargeDialog=1]="LargeDialog",e[e.Panel=2]="Panel",e[e.SmallDialog=3]="SmallDialog"}(Ee||(Ee={})),function(e){e.SinglePage="SinglePage",e.Flow="Flow"}(se||(se={})),function(e){e.BrowseDataflow="BrowseDataflow",e.CreateDataflow="CreateDataflow",e.EditDataflow="EditDataflow",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.PublishErrorDialog="PublishErrorDialog",e.RefreshHistory="RefreshHistory"}(R||(R={})),window,function(e){e.GetEntityQueryScript="browseDataflowRpcMethodNames.getEntityQueryScript"}(ee||(ee={})),function(e){e.GenerateNewDataflowName="dataflowEditorRpcMethodNames.generateNewDataflowName",e.GetDataflowSensitivityLabel="dataflowEditorRpcMethodNames.getDataflowSensitivityLabel",e.GetInitialComputeEngineSettings="dataflowEditorRpcMethodNames.getInitialComputeEngineSettings",e.OnDataflowEditingSessionChanged="dataflowEditorRpcMethodNames.onDataflowEditingSessionChanged",e.OnDataflowEditingSessionInitialized="dataflowEditorRpcMethodNames.onDataflowEditingSessionInitialized",e.OnDataflowEditorClick="dataflowEditorRpcMethodNames.onDataflowEditorClick",e.RenameDataflow="dataflowEditorRpcMethodNames.renameDataflow"}(U||(U={})),function(e){e.OnCallToActionButtonClick="dataflowsErrorDialogCallbacks.onCallToActionButtonClick"}(he||(he={})),function(e){e.EditDataflow="refreshHistoryRpcMethodNames.editDataflow",e.RefreshNow="refreshHistoryRpcMethodNames.refreshNow",e.ScheduleRefresh="refreshHistoryRpcMethodNames.scheduleRefresh"}(h||(h={}));var Ke=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var c,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(c=o.next()).done;)i.push(c.value)}catch(b){d={error:b}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i},We=function(e,n,r){if(r||2===arguments.length)for(var i,o=0,c=n.length;o<c;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))};function lt(e,n){return e<n?-1:e>n?1:0}function Ii(e,n){for(var r=function(i){var d=n[i];e=function(e,n){var r=function(b,T){var g=d.propertyGetter(b),F=d.propertyGetter(T);return d.propertyComparer(g,F)}||lt,o=e.map(function(c,i){return{value:c,index:i}});return o.sort(function(c,i){var d=r(c.value,i.value);return 0!==d?d:c.index-i.index}),o.map(function(c){return c.value})}(e)},o=n.length-1;o>=0;o--)r(o);return function(e,n,r){if(r||2===arguments.length)for(var i,o=0,c=n.length;o<c;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))}([],function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var c,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(c=o.next()).done;)i.push(c.value)}catch(b){d={error:b}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i}(e),!1)}function un(e,n,r){var o;return e&&Qt(e)&&e.hasOwnProperty(n)&&null!==(o=e[n])&&void 0!==o?o:r}function Qt(e){return function(e){return null!==e&&"object"==typeof e}(e)&&!Array.isArray(e)&&e.constructor===Object}!function(){function e(n,r){this.array=n,this.sortDefinitions=r}e.prototype.getArray=function(){return Ii(this.array,this.sortDefinitions)},e.prototype.thenBy=function(n,r){return r||(r=lt),this.sortDefinitions.push({propertyGetter:n,propertyComparer:r}),this}}();var St,je,zi=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var c,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(c=o.next()).done;)i.push(c.value)}catch(b){d={error:b}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i};function ji(e,n){if(!e)return"";if(!n)return e;var r=function(e){var n=new Map;return e&&(function(e,n,r){return e.startsWith("?")}(e)&&(e=e.substring(1)),e.split("&").forEach(function(r){var o=zi(r.split("="),2),i=o[1];n.set(decodeURIComponent(o[0]||""),decodeURIComponent(i||""))})),n}(e),o=function(e,n){var r=new Map;return e.forEach(function(o,c){n(c,o)&&r.set(c,o)}),r}(r,function(c){return!n.includes(c)});return o&&o.size>0?"?".concat(function(e){return function(e){return We([],Ke(e.keys()),!1)}(e).map(function(n){var r,o=encodeURIComponent(n),c=encodeURIComponent(null!==(r=e.get(n))&&void 0!==r?r:"");return"".concat(o,"=").concat(c)}).join("&")}(o)):""}function Gn(e){ln(e)}function ln(e,n){if(null==e)throw new Error(n?n():"Value should be defined");return e}function Rr(e,n){return n.toLowerCase().lastIndexOf(e.toLowerCase())}!function(e){e.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",e.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(St||(St={})),function(e){e.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",e.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",e.GetEntities="mappingEditorCallbacks.getEntities",e.GetEntityFields="mappingEditorCallbacks.getEntityFields",e.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",e.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(je||(je={}));var kr=function(){function e(){var n=this;this.resolveMethod=function(r){},this.rejectMethod=function(r){},this.promise=new Promise(function(r,o){n.resolveMethod=r,n.rejectMethod=o})}return e.createResolvedDeferred=function(){var n=new e;return n.resolve(),n},e.prototype.resolve=function(n){this.resolveMethod(n)},e.prototype.reject=function(n){this.rejectMethod(n)},e}(),eo=function(){function e(n,r,o){this.clientRpcChannel=n,this.configuration=r,this.clientRpcEndpointHost=o,this.ready=new kr,this.registerRpcMethods()}return Object.defineProperty(e.prototype,"readyPromise",{get:function(){return this.ready.promise},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.unregisterRpcMethods()},e.prototype.register=function(n,r){this.clientRpcChannel.register(n,r)},e.prototype.registerRpcMethods=function(){var r,o,c,i,d,b,T,g,F,K,Te,De,$e,mt,Nt,jt,ft,_e,it,Et,Xt,n=this;this.register("acquireToken",function(Pt){return n.configuration.acquireToken(Pt)}),this.register("acquireUPN",function(){return n.configuration.acquireUPN()}),this.register("getHostDeepLinkOnLoad",function(){return function(e){var n;if(void 0!==(null===(n=e.deepLink)||void 0===n?void 0:n.hostAppBasePathname))return function(e,n,r,o){var c=function(e,n,r,o){var c=""===e?n:n.substring(Rr(e,n)+e.length);return void 0!==o&&""!==r?function(e,n,r){return"".concat(e).concat(ji(n,r))}(c,r,ln(o)):c}(e,n,r,o);return function(e){return e.length>0&&"/"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}(c)}(e.deepLink.hostAppBasePathname,window.location.pathname,window.location.search)}(n.configuration.clientSettings)}),this.register("getSettings",function(){return n.configuration.appSettings}),this.register("getVersion",function(){return"2.47.0"}),this.register("onClose",function(Pt){return n.clientRpcEndpointHost.onCloseCurrentFlow(Pt)}),this.register("onPublish",function(Pt){return n.clientRpcEndpointHost.onPublish(Pt)}),this.register("onReady",function(){return n.ready.resolve()}),this.register("updateHostUrl",function(Pt){return n.clientRpcEndpointHost.updateHostUrl(Pt)}),this.configuration.linkToDataLake&&this.register("linkToDataLake",this.configuration.linkToDataLake),!(null===(r=this.configuration.browseDataflowCallbacks)||void 0===r)&&r.getEntityQueryScript&&this.register(ee.GetEntityQueryScript,this.configuration.browseDataflowCallbacks.getEntityQueryScript),!(null===(o=this.configuration.hostPopupsCallbacks)||void 0===o)&&o.getLoginSuccessRedirectUri&&this.register(St.GetLoginSuccessRedirectUri,null===(c=this.configuration.hostPopupsCallbacks)||void 0===c?void 0:c.getLoginSuccessRedirectUri),!(null===(i=this.configuration.hostPopupsCallbacks)||void 0===i)&&i.openHostPopup&&this.register(St.OpenHostPopup,null===(d=this.configuration.hostPopupsCallbacks)||void 0===d?void 0:d.openHostPopup),!(null===(b=this.configuration.mappingEditorCallbacks)||void 0===b)&&b.generateNewEntityFieldNames&&this.register(je.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(T=this.configuration.mappingEditorCallbacks)||void 0===T)&&T.generateNewEntityNames&&this.register(je.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(g=this.configuration.mappingEditorCallbacks)||void 0===g)&&g.getEntities&&this.register(je.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===(F=this.configuration.mappingEditorCallbacks)||void 0===F)&&F.getEntityFields&&this.register(je.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(K=this.configuration.mappingEditorCallbacks)||void 0===K)&&K.getEntityKeys&&this.register(je.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(Te=this.configuration.mappingEditorCallbacks)||void 0===Te)&&Te.validateMappingEditorResult&&this.register(je.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(De=this.configuration.dataflowEditorCallbacks)||void 0===De)&&De.generateNewDataflowName&&this.register(U.GenerateNewDataflowName,this.configuration.dataflowEditorCallbacks.generateNewDataflowName),!(null===($e=this.configuration.dataflowEditorCallbacks)||void 0===$e)&&$e.getDataflowSensitivityLabel&&this.register(U.GetDataflowSensitivityLabel,this.configuration.dataflowEditorCallbacks.getDataflowSensitivityLabel),!(null===(mt=this.configuration.dataflowEditorCallbacks)||void 0===mt)&&mt.getInitialComputeEngineSettings&&this.register(U.GetInitialComputeEngineSettings,this.configuration.dataflowEditorCallbacks.getInitialComputeEngineSettings),!(null===(Nt=this.configuration.dataflowEditorCallbacks)||void 0===Nt)&&Nt.onDataflowEditingSessionChanged&&this.register(U.OnDataflowEditingSessionChanged,this.configuration.dataflowEditorCallbacks.onDataflowEditingSessionChanged),!(null===(jt=this.configuration.dataflowEditorCallbacks)||void 0===jt)&&jt.onDataflowEditingSessionInitialized&&this.register(U.OnDataflowEditingSessionInitialized,this.configuration.dataflowEditorCallbacks.onDataflowEditingSessionInitialized),!(null===(ft=this.configuration.dataflowEditorCallbacks)||void 0===ft)&&ft.onDataflowEditorClick&&this.register(U.OnDataflowEditorClick,this.configuration.dataflowEditorCallbacks.onDataflowEditorClick),!(null===(_e=this.configuration.dataflowEditorCallbacks)||void 0===_e)&&_e.renameDataflow&&this.register(U.RenameDataflow,this.configuration.dataflowEditorCallbacks.renameDataflow),this.configuration.publishErrorDialogCallbacks&&this.register(he.OnCallToActionButtonClick,function(){var Pt,fo;return null===(fo=(Pt=n.clientRpcEndpointHost).onPublishErrorDialogCallToActionButtonClick)||void 0===fo?void 0:fo.call(Pt)}),!(null===(it=this.configuration.refreshHistoryCallbacks)||void 0===it)&&it.editDataflow&&this.register(h.EditDataflow,this.configuration.refreshHistoryCallbacks.editDataflow),!(null===(Et=this.configuration.refreshHistoryCallbacks)||void 0===Et)&&Et.refreshNow&&this.register(h.RefreshNow,this.configuration.refreshHistoryCallbacks.refreshNow),null!==(Xt=this.configuration.refreshHistoryCallbacks)&&void 0!==Xt&&Xt.scheduleRefresh&&this.register(h.ScheduleRefresh,this.configuration.refreshHistoryCallbacks.scheduleRefresh)},e.prototype.unregister=function(n){this.clientRpcChannel.unregister(n)},e.prototype.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("acquireUPN"),this.unregister("getHostDeepLinkOnLoad"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onClose"),this.unregister("onPublish"),this.unregister("onReady"),this.unregister("updateHostUrl"),this.unregister("linkToDataLake"),this.unregister(ee.GetEntityQueryScript),this.unregister(St.GetLoginSuccessRedirectUri),this.unregister(St.OpenHostPopup),this.unregister(je.GenerateNewEntityFieldNames),this.unregister(je.GenerateNewEntityNames),this.unregister(je.GetEntities),this.unregister(je.GetEntityFields),this.unregister(je.GetEntityKeys),this.unregister(je.ValidateMappingEditorResult),this.unregister(U.GenerateNewDataflowName),this.unregister(U.GetDataflowSensitivityLabel),this.unregister(U.GetInitialComputeEngineSettings),this.unregister(U.OnDataflowEditingSessionChanged),this.unregister(U.OnDataflowEditingSessionInitialized),this.unregister(U.OnDataflowEditorClick),this.unregister(U.RenameDataflow),this.unregister(he.OnCallToActionButtonClick),this.unregister(h.EditDataflow),this.unregister(h.RefreshNow),this.unregister(h.ScheduleRefresh)},e}(),no=function(){function e(n){this.serviceRpcChannel=n}return e.prototype.call=function(n,r){return r?this.serviceRpcChannel.call(n,r):this.serviceRpcChannel.call(n)},e.prototype.callIfSupported=function(n,r){return r?this.serviceRpcChannel.callIfSupported(n,r):this.serviceRpcChannel.callIfSupported(n)},e.prototype.getMethodIfSupported=function(n){return function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function b(F){try{g(o.next(F))}catch(K){d(K)}}function T(F){try{g(o.throw(F))}catch(K){d(K)}}function g(F){F.done?i(F.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(F.value).then(b,T)}g((o=o.apply(e,n||[])).next())})}(this,void 0,void 0,function(){var r=this;return function(e,n){var o,c,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function b(g){return function(F){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,c&&(i=2&g[0]?c.return:g[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,g[1])).done)return i;switch(c=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,c=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(F){g=[6,F],c=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,F])}}}(this,function(o){switch(o.label){case 0:return[4,this.supportsMethod(n)];case 1:return o.sent()?[2,function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(n,c)}]:[2,void 0]}})})},e.prototype.supportsMethod=function(n){return this.serviceRpcChannel.supportsMethod(n)},e}(),ro=function(){var e=function(r,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,i){c.__proto__=i}||function(c,i){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(c[d]=i[d])})(r,o)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}e(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Yt=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function b(F){try{g(o.next(F))}catch(K){d(K)}}function T(F){try{g(o.throw(F))}catch(K){d(K)}}function g(F){F.done?i(F.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(F.value).then(b,T)}g((o=o.apply(e,n||[])).next())})},Mt=function(e,n){var o,c,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function b(g){return function(F){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,c&&(i=2&g[0]?c.return:g[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,g[1])).done)return i;switch(c=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,c=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(F){g=[6,F],c=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,F])}}};!function(e){function n(r){return e.call(this,r)||this}ro(n,e),n.prototype.ack=function(){return this.serviceRpcChannel.ack()},n.prototype.acquireToken=function(r){return this.call("acquireToken",[r])},n.prototype.acquireUPN=function(){return this.call("acquireUPN")},n.prototype.getHostPopupCallbacks=function(){return Yt(this,void 0,void 0,function(){var r;return Mt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(St.GetLoginSuccessRedirectUri)];case 1:return r.getLoginSuccessRedirectUri=o.sent(),[4,this.getMethodIfSupported(St.OpenHostPopup)];case 2:return[2,(r.openHostPopup=o.sent(),r)]}})})},n.prototype.getBrowseDataflowCallbacks=function(){return Yt(this,void 0,void 0,function(){var r;return Mt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(ee.GetEntityQueryScript)];case 1:return[2,(r.getEntityQueryScript=o.sent(),r)]}})})},n.prototype.getDataflowEditorCallbacks=function(){return Yt(this,void 0,void 0,function(){var r;return Mt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(U.GenerateNewDataflowName)];case 1:return r.generateNewDataflowName=o.sent(),[4,this.getMethodIfSupported(U.GetDataflowSensitivityLabel)];case 2:return r.getDataflowSensitivityLabel=o.sent(),[4,this.getMethodIfSupported(U.GetInitialComputeEngineSettings)];case 3:return r.getInitialComputeEngineSettings=o.sent(),[4,this.getMethodIfSupported(U.OnDataflowEditingSessionChanged)];case 4:return r.onDataflowEditingSessionChanged=o.sent(),[4,this.getMethodIfSupported(U.OnDataflowEditingSessionInitialized)];case 5:return r.onDataflowEditingSessionInitialized=o.sent(),[4,this.getMethodIfSupported(U.OnDataflowEditorClick)];case 6:return r.onDataflowEditorClick=o.sent(),[4,this.getMethodIfSupported(U.RenameDataflow)];case 7:return[2,(r.renameDataflow=o.sent(),r)]}})})},n.prototype.getPublishErrorDialogCallbacks=function(){var r=this;return{onCallToActionButtonClick:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(he.OnCallToActionButtonClick,c)}}},n.prototype.getRefreshHistoryCallbacks=function(){return Yt(this,void 0,void 0,function(){var r;return Mt(this,function(o){switch(o.label){case 0:return r={},[4,this.getMethodIfSupported(h.EditDataflow)];case 1:return r.editDataflow=o.sent(),[4,this.getMethodIfSupported(h.RefreshNow)];case 2:return r.refreshNow=o.sent(),[4,this.getMethodIfSupported(h.ScheduleRefresh)];case 3:return[2,(r.scheduleRefresh=o.sent(),r)]}})})},n.prototype.getHostDeepLinkOnLoad=function(){return this.serviceRpcChannel.callIfSupported("getHostDeepLinkOnLoad")},n.prototype.getMappingEditorCallbacks=function(){var r=this;return{generateNewEntityFieldNames:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.GenerateNewEntityFieldNames,c)},generateNewEntityNames:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.GenerateNewEntityNames,c)},getEntities:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.GetEntities,c)},getEntityFields:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.GetEntityFields,c)},getEntityKeys:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.GetEntityKeys,c)},validateMappingEditorResult:function(){for(var c=[],i=0;i<arguments.length;i++)c[i]=arguments[i];return r.call(je.ValidateMappingEditorResult,c)}}},n.prototype.getSettings=function(){return this.call("getSettings")},n.prototype.getVersion=function(){return this.callIfSupported("getVersion")},n.prototype.linkToDataLake=function(){return Yt(this,void 0,void 0,function(){var o=this;return Mt(this,function(c){switch(c.label){case 0:return[4,this.serviceRpcChannel.supportsMethod("linkToDataLake")];case 1:return c.sent()?[2,function(){return o.call("linkToDataLake")}]:[2,void 0]}})})},n.prototype.onClose=function(r){return this.call("onClose",[r])},n.prototype.onPublish=function(r){return this.callIfSupported("onPublish",[r])},n.prototype.onReady=function(){return this.call("onReady")},n.prototype.updateHostUrl=function(r){return this.call("updateHostUrl",[r])}}(no),function(){function e(n,r,o,c,i,d,b,T,g,F){this.serviceRpcChannel=n,this.getFlow=r,this.startFlow=o,this.endFlow=c,this.getDataflowEditingSession=i,this.isDialogVisible=F,this.logXFramePerformanceMarks=g,this.onHostPopupCancelled=d,this.showCloseDataflowPrompt=b,this.showCloseOpenDialogsPrompt=T,this.registerRpcMethods()}e.prototype.ack=function(){return this.serviceRpcChannel.ack()},e.prototype.registerRpcMethods=function(){this.registerRpcMethod("disposeService"),this.registerRpcMethod("endFlow"),this.registerRpcMethod("getDataflowEditingSession"),this.registerRpcMethod("getFlow"),this.registerRpcMethod("isDialogVisible"),this.registerRpcMethod("logXFramePerformanceMarks"),this.registerRpcMethod("onHostPopupCancelled"),this.registerRpcMethod("showCloseDataflowPrompt"),this.registerRpcMethod("showCloseOpenDialogsPrompt"),this.registerRpcMethod("startFlow")},e.prototype.registerRpcMethod=function(n){var r=this;switch(n){case"disposeService":this.serviceRpcChannel.register("disposeService",function(){return r.disposeService()});break;case"endFlow":this.serviceRpcChannel.register("endFlow",function(){return r.endFlow()});break;case"getDataflowEditingSession":this.serviceRpcChannel.register("getDataflowEditingSession",function(){return r.getDataflowEditingSession()});break;case"getFlow":this.serviceRpcChannel.register("getFlow",function(){return r.getFlow()});break;case"isDialogVisible":this.serviceRpcChannel.register("isDialogVisible",function(){return r.isDialogVisible()});break;case"logXFramePerformanceMarks":this.serviceRpcChannel.register("logXFramePerformanceMarks",function(o){return r.logXFramePerformanceMarks(o)});break;case"onHostPopupCancelled":this.onHostPopupCancelled&&this.serviceRpcChannel.register("onHostPopupCancelled",function(o){return r.onHostPopupCancelled(o)});break;case"showCloseDataflowPrompt":this.serviceRpcChannel.register("showCloseDataflowPrompt",function(){return r.showCloseDataflowPrompt()});break;case"showCloseOpenDialogsPrompt":this.serviceRpcChannel.register("showCloseOpenDialogsPrompt",function(){return r.showCloseOpenDialogsPrompt()});break;case"startFlow":this.serviceRpcChannel.register("startFlow",function(o){return r.startFlow(o)});break;default:!function(e){throw new Error("Unexpected value: ".concat(e))}(n)}},e.prototype.disposeService=function(){}}();var so=function(){function e(n){this.clientRpcChannel=n}return e.prototype.disposeService=function(){return this.clientRpcChannel.call("disposeService")},e.prototype.endFlow=function(){return this.clientRpcChannel.call("endFlow")},e.prototype.getDataflowEditingSession=function(){return this.clientRpcChannel.call("getDataflowEditingSession")},e.prototype.getFlow=function(){return this.clientRpcChannel.call("getFlow")},e.prototype.isDialogVisible=function(){return this.clientRpcChannel.call("isDialogVisible")},e.prototype.logXFramePerformanceMarks=function(n){return this.clientRpcChannel.call("logXFramePerformanceMarks",[n])},e.prototype.onHostPopupCancelled=function(n){return this.clientRpcChannel.call("onHostPopupCancelled",[n])},e.prototype.showCloseDataflowPrompt=function(){return this.clientRpcChannel.call("showCloseDataflowPrompt")},e.prototype.showCloseOpenDialogsPrompt=function(){return this.clientRpcChannel.call("showCloseOpenDialogsPrompt")},e.prototype.startFlow=function(n){return this.clientRpcChannel.call("startFlow",[n])},e}(),pn=q(79078);function hn(){return pn.Z()}var S,gn=function(){var e=function(r,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,i){c.__proto__=i}||function(c,i){for(var d in i)Object.prototype.hasOwnProperty.call(i,d)&&(c[d]=i[d])})(r,o)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}e(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),vn=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function b(F){try{g(o.next(F))}catch(K){d(K)}}function T(F){try{g(o.throw(F))}catch(K){d(K)}}function g(F){F.done?i(F.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(F.value).then(b,T)}g((o=o.apply(e,n||[])).next())})},mn=function(e,n){var o,c,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function b(g){return function(F){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,c&&(i=2&g[0]?c.return:g[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,g[1])).done)return i;switch(c=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,c=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(F){g=[6,F],c=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,F])}}},Zt="__SUPPORTS_METHOD__",wn=function(){function e(n){var r=this;this.onMessageReceived=function(o){o.method?r.handleRequestMessageReceived(o):r.handleResponseMessageReceived(o)},this.options=n,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(Zt,function(o){return r.handleSupportsMethodMessage(o)})}return e.prototype.call=function(n,r){return this.internalCall(e.normalizeMethodName(n),r)},e.prototype.callIfSupported=function(n,r){return vn(this,void 0,void 0,function(){return mn(this,function(c){switch(c.label){case 0:return[4,this.supportsMethod(n)];case 1:return c.sent()?[2,this.call(n,r)]:[2,void 0]}})})},e.prototype.dispose=function(){this.internalUnregister(Zt),this.requestDeferredByMessageId.forEach(function(n){return n.reject(function(e){var n=new Error("Rpc disposed");if(null!=n.stack)return n;try{throw n}catch(r){return r}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},e.prototype.register=function(n,r){var o=this,c=e.normalizeMethodName(n);this.internalRegister(c,function(){for(var i,d,b=[],T=0;T<arguments.length;T++)b[T]=arguments[T];return null===(d=(i=o.options).onMethodInvoked)||void 0===d||d.call(i,n,b),r.apply(void 0,function(e,n,r){if(r||2===arguments.length)for(var i,o=0,c=n.length;o<c;o++)(i||!(o in n))&&(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))}([],function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var c,d,o=r.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(c=o.next()).done;)i.push(c.value)}catch(b){d={error:b}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(d)throw d.error}}return i}(b),!1))})},e.prototype.supportsMethod=function(n){return this.internalCall(Zt,[n])},e.prototype.unregister=function(n){var r=e.normalizeMethodName(n);this.internalUnregister(r)},e.prototype.canPostMessage=function(n){return this.ready},Object.defineProperty(e.prototype,"rpcHandshakeHandler",{get:function(){return this.options.rpcHandshakeHandler},enumerable:!1,configurable:!0}),e.prototype.internalCall=function(n,r){void 0===r&&(r=void 0);var o=hn(),c={id:o,method:n,params:r},i=new kr;return this.requestDeferredByMessageId.set(o,i),this.canPostMessage(c)?this.tryPostMessage(c):this.queuedRequestMessages.push(c),i.promise},e.prototype.internalRegister=function(n,r){if(this.methodCallbackMap.has(n))throw new Error("Rpc method with name '".concat(n,"' already registered."));this.methodCallbackMap.set(n,r)},e.prototype.internalUnregister=function(n){this.methodCallbackMap.delete(n)},e.prototype.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},e.getResponseMessageError=function(n){return n instanceof Error?{message:n.message,name:n.name,stack:n.stack}:n},e.normalizeMethodName=function(n){return n.toUpperCase()},e.prototype.flushRequestMessageQueue=function(){var n=this;this.queuedRequestMessages.forEach(function(r){return n.tryPostMessage(r)}),this.queuedRequestMessages=[]},e.prototype.handleRequestMessageReceived=function(n){var r=this,o=this.methodCallbackMap.get(n.method);if(o){var c={signature:n.signature,id:n.id};try{var i=o.apply(this,n.params);Promise.resolve(i).then(function(d){c.result=d,r.postMessage(c)}).catch(function(d){c.error=e.getResponseMessageError(d),r.postMessage(c)})}catch(d){c.error=e.getResponseMessageError(d),this.postMessage(c)}}},e.prototype.handleResponseMessageReceived=function(n){var r=n.id,o=this.requestDeferredByMessageId.get(r);o&&(n.error?o.reject(n.error):o.resolve(n.result),this.requestDeferredByMessageId.delete(r))},e.prototype.handleSupportsMethodMessage=function(n){return this.methodCallbackMap.has(e.normalizeMethodName(n))},e.prototype.postMessage=function(n){this.options.rpcWindow.postMessage(n)},e.prototype.tryPostMessage=function(n){try{this.postMessage(n)}catch(c){if(c instanceof Error){var r=n.id,o=this.requestDeferredByMessageId.get(r);o&&(o.reject(c),this.requestDeferredByMessageId.delete(r))}}},e}(),_n=function(e){function n(r){var o=e.call(this,r)||this;return o.clientOptions=r,o.internalRegister(r.rpcHandshakeHandler.getReadyMessageMethod(),function(){return o.handleReadyMessage()}),o}return gn(n,e),n.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},n}(wn),t=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}gn(n,e),n.prototype.ack=function(){return vn(this,void 0,void 0,function(){var r,o;return mn(this,function(i){switch(i.label){case 0:return r=this.rpcHandshakeHandler.getReadyMessageMethod(),[4,this.internalCall(r)];case 1:if(o=i.sent(),!this.rpcHandshakeHandler.isAckResponse(o))throw new Error("Invalid Handshake message. Received: '".concat(o,"'."));return this.onReady(),[2]}})})},n.prototype.canPostMessage=function(r){return e.prototype.canPostMessage.call(this,r)||r.method===this.rpcHandshakeHandler.getReadyMessageMethod()}}(wn),function(){function e(n){this.signature=n}return e.prototype.deserialize=function(n){var r=n.data;return Qt(r)?un(r,"data",r):r},e.prototype.serialize=function(n){return n.signature=this.signature,{id:n.id,kind:un(n,"method",e.emptyValue),signature:e.frameSignature,data:n}},e.emptyValue="",e.frameSignature="FxFrameControl",e}()),u="start",l=function(){function e(){}return e.prototype.createAckResponse=function(){return u},e.prototype.getReadyMessageMethod=function(){return"ready"},e.prototype.isAckResponse=function(n){return n===u},e}(),s=function(){function e(n){this.signature=n}return e.prototype.deserialize=function(n){return n.data},e.prototype.serialize=function(n){return n.signature=this.signature,n},e}(),m="__PONG__",y=function(){function e(){}return e.prototype.createAckResponse=function(){return m},e.prototype.getReadyMessageMethod=function(){return"__PING__"},e.prototype.isAckResponse=function(n){return n===m},e}();!function(e){e.Default="default",e.AzurePortal_v1_0_0="azureportal-v1.0.0"}(S||(S={}));var Ia,Ta,Ra,ka,Da,Fa,Ma,Oa,Na,xa,La,Ua,Ha,Va,Ba,Ga,Wa,za,ja,_a,qa,Qa,$a,Ja,Ya,Za,Xa,Ka,es,ts,ns,rs,qn,is,os,as,ss,cs,us,ls,fs,ds,ps,hs,gs,vs,ms,ws,ys,Cs,Ss,bs,Es,Ps,As,Is,Ts,Rs,ks,Ds,Fs,Ms,P=function(){function e(n){Gn(n.targetWindow),Gn(n.sourceWindow),this.options=n,this.eventListeners=new Map}return e.prototype.addListener=function(n){var r=this;if(this.eventListeners.has(n))throw new Error("Duplicate rpc listener added.");var o=function(i){return r.handleMessageReceived(i,n)};this.eventListeners.set(n,o),this.options.sourceWindow.addEventListener(e.eventTypeName,o)},e.prototype.postMessage=function(n){var r=this.options.targetOriginProvider.getTargetOrigin(n);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(n),r)},e.prototype.removeListener=function(n){var r=this.eventListeners.get(n);r&&(this.options.sourceWindow.removeEventListener(e.eventTypeName,r),this.eventListeners.delete(n))},e.isMessageEvent=function(n){return!function(e){return null==e}(n.data)},e.prototype.canProcessMessage=function(n){return!!n&&n.signature===this.options.rpcMessageConverter.signature},e.prototype.handleMessageReceived=function(n,r){if(e.isMessageEvent(n)){var o=this.options.rpcMessageConverter.deserialize(n);this.canProcessMessage(o)&&this.options.allowedOrigins.some(function(c){return function(e,n){if("*"===n)return!0;if(n.startsWith("https://*.")&&e.startsWith("https://")){var o=n.substring(9);return e.substring(8).endsWith(o)}return e===n}(n.origin,c)})&&(this.options.targetOriginProvider.onMessageReceived(n.origin),r(o))}},e.eventTypeName="message",e}(),I=function(){function e(n){this.explicitTargetOrigin=n}return e.prototype.getTargetOrigin=function(n){return this.explicitTargetOrigin},e.prototype.onMessageReceived=function(n){},e}(),le=function(n){return n?"dfpq-".concat(n):"dfpq"},Ot=function(e,n,r,o){return new(r||(r=Promise))(function(i,d){function b(F){try{g(o.next(F))}catch(K){d(K)}}function T(F){try{g(o.throw(F))}catch(K){d(K)}}function g(F){F.done?i(F.value):function(i){return i instanceof r?i:new r(function(d){d(i)})}(F.value).then(b,T)}g((o=o.apply(e,n||[])).next())})},zt=function(e,n){var o,c,i,d,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return d={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function b(g){return function(F){return function(g){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(o=1,c&&(i=2&g[0]?c.return:g[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,g[1])).done)return i;switch(c=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,c=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===g[0]||2===g[0])){r=0;continue}if(3===g[0]&&(!i||g[1]>i[0]&&g[1]<i[3])){r.label=g[1];break}if(6===g[0]&&r.label<i[1]){r.label=i[1],i=g;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(g);break}i[2]&&r.ops.pop(),r.trys.pop();continue}g=n.call(e,r)}catch(F){g=[6,F],c=0}finally{o=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,F])}}},Hs=function(){function e(n){var o,r=this;this.onPublish=function(g){return ln(r.currentFlowConfiguration).onPublish(g)};var c=hn();this.configurations=n,this.iframe=this.renderIFrame(n.clientSettings,c),n.appSettings.runMode===se.Flow&&this.hideApp();var i=function(n,r,o,c){var i,d=null!=n.clientSettings.allowedOrigin?n.clientSettings.allowedOrigin:"*",b=function(e,n){return n===S.AzurePortal_v1_0_0?{rpcMessageConverter:new t(e),rpcHandshakeHandler:new l}:{rpcMessageConverter:new s(e),rpcHandshakeHandler:new y}}(le(r),S.Default),T=new _n({debugName:"DataflowsRpcUtils.clientRpcChannel",enableDebugLogging:null!==(i=n.clientSettings.enableDebugLogging)&&void 0!==i&&i,rpcHandshakeHandler:b.rpcHandshakeHandler,rpcWindow:new P({allowedOrigins:[d],rpcMessageConverter:b.rpcMessageConverter,sourceWindow:window,targetOriginProvider:new I(d),targetWindow:ln(o.contentWindow,function(){return"Unable to find the contentWindow on the iFrame element."})})}),g=new eo(T,n,c);return{serviceRpcProxy:new so(T),clientRpcEndpoint:g,clientRpcChannel:T}}(n,c,this.iframe,{onCloseCurrentFlow:function(F){return r.onCloseCurrentFlow(F)},onPublish:function(F){return r.onPublish(F)},onPublishErrorDialogCallToActionButtonClick:null===(o=this.configurations.publishErrorDialogCallbacks)||void 0===o?void 0:o.onCallToActionButtonClick,updateHostUrl:function(F){return function(e,n){if(e?.allowUpdateHostUrlWithRelativePath){var r=function(e,n){return""===e?"":n.substring(0,Rr(e,n)+e.length)}(e.hostAppBasePathname,window.location.pathname);history.replaceState(null,"",r+n)}}(n.clientSettings.deepLink,F)}}),b=i.clientRpcEndpoint,T=i.clientRpcChannel;this.serviceProxy=i.serviceRpcProxy,this.clientRpcEndpoint=b,this.clientRpcChannel=T,this.ready=this.clientRpcEndpoint.readyPromise}return e.prototype.dispose=function(){return Ot(this,void 0,void 0,function(){return zt(this,function(n){switch(n.label){case 0:return this.hideApp(),[4,this.serviceProxy.disposeService()];case 1:return n.sent(),this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.configurations.clientSettings.container.removeChild(this.iframe),[2]}})})},e.prototype.endFlow=function(){if(this.configurations.appSettings.runMode!==se.Flow)throw new Error("Cannot end a flow with runMode set to '".concat(this.configurations.appSettings.runMode,"'."));return this.hideApp(),this.serviceProxy.endFlow()},e.prototype.getDataflowEditingSession=function(){if(this.configurations.appSettings.runMode!==se.Flow)throw new Error("App is currently running on runMode '".concat(this.configurations.appSettings.runMode,"'."));return this.serviceProxy.getDataflowEditingSession()},e.prototype.getFlow=function(){if(this.configurations.appSettings.runMode!==se.Flow)throw new Error("App is currently running on runMode '".concat(this.configurations.appSettings.runMode,"'."));return this.serviceProxy.getFlow()},e.prototype.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},e.prototype.logXFramePerformanceMarks=function(n){return this.serviceProxy.logXFramePerformanceMarks(n)},e.prototype.onHostPopupCancelled=function(n){return Ot(this,void 0,void 0,function(){return zt(this,function(r){switch(r.label){case 0:return[4,this.serviceProxy.onHostPopupCancelled(n)];case 1:return r.sent(),[2]}})})},e.prototype.showCloseDataflowPrompt=function(){return Ot(this,void 0,void 0,function(){return zt(this,function(n){switch(n.label){case 0:return[4,this.serviceProxy.showCloseDataflowPrompt()];case 1:return n.sent(),[2]}})})},e.prototype.showCloseOpenDialogsPrompt=function(){return Ot(this,void 0,void 0,function(){return zt(this,function(n){switch(n.label){case 0:return[4,this.serviceProxy.showCloseOpenDialogsPrompt()];case 1:return n.sent(),[2]}})})},e.prototype.startFlow=function(n,r,o){return Ot(this,void 0,void 0,function(){return zt(this,function(i){switch(i.label){case 0:if(this.configurations.appSettings.runMode!==se.Flow)throw new Error("Cannot start a flow with runMode set to '".concat(this.configurations.appSettings.runMode,"'."));return[4,this.ready];case 1:return i.sent(),[4,this.getFlow()];case 2:if(null!=i.sent())throw new Error("Cannot start a new flow when an existing flow is running");return this.currentFlowConfiguration={onClose:function(b){if(ne(b,n))return r(b);throw new Error("The flow ".concat(n.kind," returned the wrong type of result: ").concat(b.kind))},onPublish:function(b){var T;if(ne(b,n))return null!==(T=o?.(b))&&void 0!==T?T:Promise.resolve();throw new Error("The flow ".concat(n.kind," returned the wrong type of result: ").concat(b.kind))}},this.showApp(),[2,this.serviceProxy.startFlow(n)]}})})},e.prototype.hideApp=function(){this.iframe.style.display="none"},e.prototype.onCloseCurrentFlow=function(n){return Ot(this,void 0,void 0,function(){return zt(this,function(r){switch(r.label){case 0:return Gn(this.currentFlowConfiguration),[4,this.currentFlowConfiguration.onClose(n)];case 1:return r.sent(),this.hideApp(),this.currentFlowConfiguration=void 0,[2]}})})},e.prototype.renderIFrame=function(n,r){var o=document.createElement("iframe");return o.src=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var c=e.indexOf("?")>-1?"&":"?",i=n.map(function(d){return"".concat(encodeURIComponent(d.name),"=").concat(encodeURIComponent(d.value))}).join("&");return"".concat(e).concat(c).concat(i)}(n.url,{name:"df_ClientInstanceId",value:r}),o.title="Dataflows",o.style.width="100%",o.style.height="100%",o.style.border="none",o.allow="clipboard-write",n.className&&(o.className=n.className),n.container.appendChild(o),o},e.prototype.showApp=function(){this.iframe.style.display="block"},e}();!function(e){e.Success="Success",e.Error_EmptyName="Error_EmptyName",e.Error_InvalidCharacters="Error_InvalidCharacters",e.Error_NameAlreadyExists="Error_NameAlreadyExists",e.Error_NameTooLong="Error_NameTooLong"}(Ia||(Ia={})),function(e){e.Editable="Editable",e.Hidden="Hidden",e.Readonly="Readonly"}(Ta||(Ta={})),function(e){e.CombinedRefreshPublishStatus="CombinedRefreshPublishStatus",e.DataflowType="DataflowType",e.DraftStatus="DraftStatus",e.LastPublished="LastPublished",e.LastRefresh="LastRefresh",e.NextRefresh="NextRefresh"}(Ra||(Ra={})),function(e){e.PublishLater="PublishLater",e.PublishNow="PublishNow"}(ka||(ka={})),function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.NotRequired="NotRequired"}(Da||(Da={})),function(e){e.Action="action",e.Any="any",e.AnyNonNull="anynonnull",e.Binary="binary",e.Currency="currency",e.Date="date",e.DateTime="datetime",e.DateTimeZone="datetimezone",e.Duration="duration",e.Exception="exception",e.Function="function",e.List="list",e.Logical="logical",e.None="none",e.Null="null",e.Number="number",e.Percentage="percentage",e.Record="record",e.Table="table",e.Text="text",e.Time="time",e.Type="type",e.WholeNumber="wholenumber"}(Fa||(Fa={})),function(e){e.AM="AM",e.PM="PM"}(Ma||(Ma={})),function(e){e[e.anonymous=1]="anonymous",e[e.basic=2]="basic",e[e.oAuth2=3]="oAuth2",e[e.windows=4]="windows",e[e.key=5]="key",e[e.sas=6]="sas",e[e.servicePrincipal=7]="servicePrincipal"}(Oa||(Oa={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(Na||(Na={})),function(e){e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(xa||(xa={})),function(e){e.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",e.AdfConnectionEvaluationError="AdfConnectionEvaluationError",e.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",e.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",e.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",e.ConnectionKindNotSupported="ConnectionKindNotSupported",e.ConnectionNotFound="ConnectionNotFound",e.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",e.DataAccessError="DataAccessError",e.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",e.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",e.DuplicateDataSourceNameError="DuplicateDataSourceNameError",e.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",e.ExceededLimit="ExceededLimit",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",e.InvalidCredentials="InvalidCredentials",e.InvalidPath="InvalidPath",e.OboSignInError="OboSignInError",e.TooManyConnections="TooManyConnections",e.UnknownDmtsError="UnknownDmtsError",e.UnknownError="UnknownError",e.UnknownGatewayError="UnknownGatewayError",e.Unsupported="Unsupported"}(La||(La={})),function(e){e.AddStep="AddStep",e.CreateQuery="CreateQuery",e.DeleteQuery="DeleteQuery",e.ExplainQuery="ExplainQuery",e.ExplainStep="ExplainStep"}(Ua||(Ua={})),function(e){e.CouldNotExplainQuery="CouldNotExplainQuery",e.CouldNotGenerateQuery="CouldNotGenerateQuery",e.CouldNotGenerateStep="CouldNotGenerateStep",e.DataItemsMissing="DataItemsMissing",e.LanguageNotSupported="LanguageNotSupported",e.OutOfScope="OutOfScope",e.QueryNotFound="QueryNotFound",e.SkillNotFound="SkillNotFound",e.TableNotFound="TableNotFound",e.Unknown="Unknown"}(Ha||(Ha={})),function(e){e.Action="Action",e.Error="Error"}(Va||(Va={})),function(e){e.Singleton="Singleton",e.Database="Database",e.Uri="Uri",e.Custom="Custom"}(Ba||(Ba={})),function(e){e.BuiltIn="BuiltIn",e.Extension="Extension"}(Ga||(Ga={})),function(e){e.JsonDsr="JsonDsr",e.MScript="MScript",e.QueryModel="QueryModel"}(Wa||(Wa={})),function(e){e.Cluster="Cluster",e.Database="Database",e.Lakehouse="Lakehouse",e.Object="Object",e.Schema="Schema",e.Server="Server",e.Table="Table",e.Warehouse="Warehouse",e.Workspace="Workspace"}(za||(za={})),function(e){e.Constant="Constant",e.Duplicate="Duplicate",e.Empty="Empty",e.Index="Index"}(ja||(ja={})),function(e){e[e.false=0]="false",e[e.true=1]="true",e[e.notApplicable=2]="notApplicable",e[e.existingConnection=3]="existingConnection"}(_a||(_a={})),function(e){e.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",e.Cancelled="Cancelled",e.DuplicateEvaluationId="DuplicateEvaluationId",e.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",e.EvaluationAgentNotFound="EvaluationAgentNotFound",e.EvaluationQuotaReached="EvaluationQuotaReached",e.ExternalServiceError="ExternalServiceError",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNeeded="GatewayNeeded",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayNotFound="GatewayNotFound",e.GatewayUnknownError="GatewayUnknownError",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUpgradeRequired="GatewayUpgradeRequired",e.GatewayUserError="GatewayUserError",e.MashupEntityNotFound="MashupEntityNotFound",e.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",e.NetworkAccessDenied="NetworkAccessDenied",e.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",e.ParameterNotFound="ParameterNotFound",e.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",e.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",e.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",e.QueryNotFound="QueryNotFound",e.StepNotFound="StepNotFound",e.UnableToContactBackend="UnableToContactBackend",e.Unknown="Unknown",e.UnsupportedKind="UnsupportedKind",e.ValueTooComplex="ValueTooComplex"}(qa||(qa={})),function(e){e.Path="Path",e.QueryScript="QueryScript"}(Qa||(Qa={})),function(e){e.AutoFilterColumnValues="AutoFilterColumnValues",e.BinaryMetadata="BinaryMetadata",e.ConnectorRows="ConnectorRows",e.ConnectorSchema="ConnectorSchema",e.CubeAllowedValues="CubeAllowedValues",e.CubeDisplayFolders="CubeDisplayFolders",e.CubeParameters="CubeParameters",e.DataSourceQuery="DataSourceQuery",e.DetailsPreview="DetailsPreview",e.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",e.DsrDetailsFetching="DsrDetailsFetching",e.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",e.ExpandColumnNames="ExpandColumnNames",e.FunctionBrowser="FunctionBrowser",e.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",e.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",e.LoadToCdsRelationships="LoadToCdsRelationships",e.LoadToCdsSchema="LoadToCdsSchema",e.MappingEditorQueryProfiling="MappingEditorQueryProfiling",e.MappingEditorSchemaResult="MappingEditorSchemaResult",e.MappingEditorTypeMetadata="MappingEditorTypeMetadata",e.MashupLoad="MashupLoad",e.MergeMatchAnalysis="MergeMatchAnalysis",e.MergeQueriesPreview="MergeQueriesPreview",e.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",e.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",e.NaturalLanguageValidation="NaturalLanguageValidation",e.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",e.NavigatorCubeParameters="NavigatorCubeParameters",e.NavigatorCubePreview="NavigatorCubePreview",e.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",e.NavigatorPreview="NavigatorPreview",e.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",e.Preview="Preview",e.QueryAnalysis="QueryAnalysis",e.QueryPlan="QueryPlan",e.QuerySanitizer="QuerySanitizer",e.QuerySanitizerAnalysis="QuerySanitizerAnalysis",e.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",e.QueryScriptPreview="QueryScriptPreview",e.SemanticEntitySets="SemanticEntitySets",e.SemanticDataGetData="SemanticDataGetData",e.SemanticDataList="SemanticDataList",e.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",e.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",e.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",e.StepAnalysis="StepAnalysis",e.TableProfiler="TableProfiler",e.TextByExampleGetText="TextByExampleGetText",e.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",e.WebByExampleGetHtml="WebByExampleGetHtml"}($a||($a={})),function(e){e.None="None",e.Any="Any",e.Access="Access",e.Excel="Excel",e.Json="Json",e.TextCsv="TextCsv",e.Pdf="Pdf",e.Xml="Xml"}(Ja||(Ja={})),function(e){e.List="List"}(Ya||(Ya={})),function(e){e.MenuItem="MenuItem",e.Separator="Separator"}(Za||(Za={})),function(e){e.Max="Max",e.Mean="Mean",e.Min="Min",e.Mode="Mode",e.RoundedMean="RoundedMean"}(Xa||(Xa={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}(Ka||(Ka={})),function(e){e.Database="Database",e.File="File"}(es||(es={})),function(e){e.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",e.BasedOnMetadata="BasedOnMetadata",e.Never="Never"}(ts||(ts={})),function(e){e.Always="Always",e.Never="Never",e.HasNewLoadableQueries="HasNewLoadableQueries",e.NumberOfQueries="NumberOfQueries"}(ns||(ns={})),function(e){e.Equals="Equals",e.GreaterThan="GreaterThan",e.GreaterThanOrEqual="GreaterThanOrEqual",e.LessThan="LessThan",e.LessThanOrEqual="LessThanOrEqual"}(rs||(rs={})),function(e){e.Adf="Adf",e.Athena="Athena",e.AzureSearch="AzureSearch",e.BingAtWork="BingAtWork",e.CdsA="CdsA",e.CdsLite="CdsLite",e.CdsT="CdsT",e.CdsV1="CdsAdHoc",e.CustomerInsights="CustomerInsights",e.CustomerInsightsPPDF="CustomerInsightsPPDF",e.D365TalentInsights="D365TalentInsights",e.DataIntegration="DataIntegration",e.DesktopBootstrap="DesktopBootstrap",e.DesktopUITester="DesktopUITester",e.DmtsPowerBiExperimental="DmtsPowerBiExperimental",e.DmtsSaExperimental="DmtsSaExperimental",e.ExcelDesktop="ExcelDesktop",e.ExcelOnline="ExcelOnline",e.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",e.Experimental="Experimental",e.Flow="Flow",e.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",e.IntelligentOrderManagement="IntelligentOrderManagement",e.InternalPortal="InternalPortal",e.KustoViewDesigner="KustoViewDesigner",e.MashupEditorBootstrap="MashupEditorBootstrap",e.PowerAppsTeams="PowerAppsTeams",e.PowerBIDataMart="PowerBIDataMart",e.PowerBIModeling="PowerBIModeling",e.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",e.PowerBIPaginatedReports="PowerBIPaginatedReports",e.PowerBIPPDF="PowerBIPPDF",e.PowerBIReportView="PowerBIReportView",e.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",e.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",e.PowerPlatformExperimental="PowerPlatformExperimental",e.PowerQueryDesktop="PowerQueryDesktop",e.ProcessAdvisor="ProcessAdvisor",e.SupplyChainVisibility="SupplyChainVisibility",e.SustainabilityCloud="SustainabilityCloud",e.Synapse="Synapse",e.TridentDataflow="TridentDataflow",e.TridentDataPipeline="TridentDataPipeline",e.TridentDataWarehouse="TridentDataWarehouse",e.TridentEventStream="TridentEventStream",e.TridentKusto="TridentKusto",e.TridentLakehouse="TridentLakehouse",e.TridentLakeWarehouse="TridentLakeWarehouse",e.TridentMountedDataWarehouse="TridentMountedDataWarehouse",e.TridentOneLake="TridentOneLake",e.TridentReplicator="TridentReplicator",e.TridentSynapseLink="TridentSynapseLink"}(qn||(qn={})),function(e){e.Boolean="Boolean"}(is||(is={})),function(e){e.NaN="NaN",e.NegativeInfinity="NegativeInfinity",e.PositiveInfinity="PositiveInfinity",e.FormattedNumber="FormattedNumber",e.Number="Number"}(os||(os={})),function(e){e.Access="Access",e.ActiveDirectory="ActiveDirectory",e.AdoDotNet="AdoDotNet",e.AdobeAnalytics="AdobeAnalytics",e.AnalysisServices="AnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.Cdpa="CDPA",e.CurrentWorkbook="CurrentWorkbook",e.DB2="DB2",e.Environment="Environment",e.Essbase="Essbase",e.Exchange="Exchange",e.File="File",e.Folder="Folder",e.Ftp="Ftp",e.GoogleAnalytics="GoogleAnalytics",e.HDInsight="HDInsight",e.Hdfs="Hdfs",e.Informix="Informix",e.MQ="MQ",e.MicrosoftInformationProtection="MicrosoftInformationProtection",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.OleDb="OleDb",e.Oracle="Oracle",e.PostgreSQL="PostgreSQL",e.PowerBIDataflow="PowerBI",e.Python="Python",e.R="R",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Spark="Spark",e.Sql="SQL",e.Staging="Staging",e.Sybase="Sybase",e.Teradata="Teradata",e.Web="Web"}(as||(as={})),function(e){e.TemplateMetadata="Metadata.json",e.MashupDocument="MashupDocument.pq",e.MashupMetadata="MashupMetadata.json"}(ss||(ss={})),function(e){e.GroupNestingLimitReached="GroupNestingLimitReached",e.NullMashupXml="NullMashupXml",e.Unknown="Unknown"}(cs||(cs={})),function(e){e.CompletedSuccessfully="CompletedSuccessfully",e.CompletedWithExpectedError="CompletedWithExpectedError",e.CompletedWithUnexpectedError="CompletedWithUnexpectedError",e.Started="Started"}(us||(us={})),function(e){e.Above="Above",e.Below="Below"}(ls||(ls={})),function(e){e.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",e.NoProgramFound="NoProgramFound",e.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",e.RequestCanceled="RequestCanceled"}(fs||(fs={})),function(e){e.Ascii="Ascii",e.Utf8="Utf8",e.Utf16="Utf16",e.Windows="Windows"}(ds||(ds={})),function(e){e.Excel="Excel",e.Json="Json",e.Parquet="Parquet",e.Text="Text"}(ps||(ps={})),function(e){e.Colon="Colon",e.Comma="Comma",e.None="None",e.Semicolon="Semicolon",e.Space="Space",e.Tab="Tab"}(hs||(hs={})),function(e){e.Even="Even",e.Odd="Odd"}(gs||(gs={})),function(e){e.None="None",e.Private="Private",e.Organizational="Organizational",e.Public="Public"}(vs||(vs={})),function(e){e.QueryNeedsToFold="QueryNeedsToFold"}(ms||(ms={})),function(e){e.AzureBlob="AzureBlob",e.Database="Database"}(ws||(ws={})),function(e){e.DynamicPlanFolded="DynamicPlanFolded",e.DynamicPlanMightFold="DynamicPlanMightFold",e.DynamicPlanNotFolded="DynamicPlanNotFolded",e.DynamicPlanOpaque="DynamicPlanOpaque",e.ErrorRetrievingPlan="ErrorRetrievingPlan",e.FoldedQueryNotImplemented="FoldedQueryNotImplemented",e.FoldedQueryNull="FoldedQueryNull",e.FoldedWithQuery="FoldedWithQuery",e.NotFolded="NotFolded",e.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",e.NotTable="NotTable",e.OpaqueConstant="OpaqueConstant",e.UnexpectedPlanKind="UnexpectedPlanKind"}(ys||(ys={})),function(e){e.ActiveDirectory="ActiveDirectory",e.AdobeAnalytics="AdobeAnalytics",e.AmazonRedshift="AmazonRedshift",e.AnalysisServices="AnalysisServices",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataExplorer="AzureDataExplorer",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.AIFunctions="AIFunctions",e.AIInsights="AIInsights",e.AzureMLFunctions="AzureMLFunctions",e.AIInsightsInProc="AIInsightsInProc",e.Cds="Cds",e.CommonDataService="CommonDataService",e.DataLake="DataLake",e.Dataverse="Dataverse",e.DB2="DB2",e.ElasticSearch="ElasticSearch",e.Exchange="Exchange",e.Fhir="Fhir",e.File="File",e.Folder="Folder",e.GoogleAnalytics="GoogleAnalytics",e.GoogleBigQuery="GoogleBigQuery",e.HDInsight="HDInsight",e.Impala="Impala",e.Kusto="Kusto",e.Lakehouse="Lakehouse",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.Oracle="Oracle",e.OracleERP="OracleERP",e.PostgreSQL="PostgreSQL",e.PowerBI="PowerBI",e.PowerBIDatamarts="PowerBIDatamarts",e.PowerPlatformDataflows="PowerPlatformDataflows",e.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SAPERP="SAPERP",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Snowflake="Snowflake",e.Spark="Spark",e.SQL="SQL",e.Sybase="Sybase",e.Teradata="Teradata",e.Vertica="Vertica",e.Warehouse="Warehouse",e.Web="Web"}(Cs||(Cs={})),function(e){e.CompilationError="CompilationError",e.InvalidQueryName="InvalidQueryName",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Ss||(Ss={})),function(e){e.Failure="Failure",e.Success="Success"}(bs||(bs={})),function(e){e[e.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",e[e.httpError=1]="httpError",e[e.invalidInput=2]="invalidInput",e[e.maxRetriesReached=3]="maxRetriesReached",e[e.modelError=4]="modelError"}(Es||(Es={})),function(e){e.Error="Error",e.Ok="Ok"}(Ps||(Ps={})),function(e){e.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",e.DuplicateQueryId="DuplicateQueryId",e.DuplicateQueryName="DuplicateQueryName",e.DuplicateStepName="DuplicateStepName",e.InvalidQueryName="InvalidQueryName",e.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",e.ParsingError="ParsingError",e.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(As||(As={})),function(e){e.Custom="Custom",e.DropColumn="DropColumn",e.DropBlankRows="DropBlankRows",e.DropDuplicates="DropDuplicates",e.FillColumn="FillColumn",e.SplitColumn="SplitColumn",e.UnpivotColumns="UnpivotColumns",e.UnpivotOtherColumns="UnpivotOtherColumns"}(Is||(Is={})),function(e){e.Column="Column",e.ColumnType="ColumnType",e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(Ts||(Ts={})),function(e){e.SelectRows="SelectRows",e.Sort="Sort",e.SelectColumns="SelectColumns",e.RenameColumns="RenameColumns",e.AddColumn="AddColumn",e.ReplaceColumn="ReplaceColumns",e.ReplaceRows="ReplaceRows",e.AddRows="AddRows",e.ReplaceValues="ReplaceValues",e.SplitColumn="SplitColumn",e.ReplaceTable="ReplaceTable"}(Rs||(Rs={})),function(e){e.InvocationPattern="InvocationPattern",e.Script="Script"}(ks||(ks={})),function(e){e.DataSourceTag="DataSourceTag",e.QueryEditorMessageBar="QueryEditorMessageBar",e.QuickCreateForm="QuickCreateForm",e.WebByExampleForm="WebByExampleForm"}(Ds||(Ds={})),function(e){e.CompilationError="CompilationError",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Fs||(Fs={})),function(e){e.Link="Link",e.Text="Text"}(Ms||(Ms={}));var Vs=q(88255),we=q(50423),Os=q(9380),Bs=q(98873),Ns=q(65181),lo=q(9398),xs=q(85732),Ls=q(41114),Us="PBI.DataflowsClient.OnReadyError",Gs=Ls.cx[Us]=(0,Ls.b1)(Us),Ws=q(48741),zs=q(12966),js=q(73221),_s=q(4633),qs=q(35510),Qs=q(59017),$s=q(59973),Js=q(85928),Nr=q(77476),Ys=q(24326),Zs=["dataflowsClientIFrame"];function Xs(e,n){1&e&&(we.\u0275\u0275elementStart(0,"div",3),we.\u0275\u0275element(1,"pbi-spinner",4),we.\u0275\u0275elementEnd())}var Ks=window,ec=function(e){function n(r,o,c,i,d,b){var T=e.call(this)||this;return T.activatedRoute=r,T.featureSwitchService=o,T.store=c,T.mashupService=i,T.localizationService=d,T.telemetryService=b,T.onError=new we.EventEmitter,T.onUpdateDataflowsClient=new we.EventEmitter,T.isReady$=new qs.X(!1),T}return(0,de.__extends)(n,e),n.prototype.ngAfterViewInit=function(){var r=this;this.dataflowsAppFeatureFlags=new Map,this.activatedRoute.snapshot.queryParamMap.keys.forEach(function(o){r.dataflowsAppFeatureFlags.set(o,r.activatedRoute.snapshot.queryParamMap.get(o))}),this.lifecycleSubscriptions.add((0,Qs.aj)([this.mashupService.getPQEndpoint(),this.store.select(Q.CW),this.store.select(Q.T),this.store.select(Q.iF)]).pipe((0,$s.h)(function(o){return!!o[0]&&!!o[1]})).subscribe(function(o){r.initDataflowsClient(o[0],o[2]?o[3]:o[1])},function(o){r.onError.emit(o)}))},n.prototype.ngOnDestroy=function(){var r;this.onUpdateDataflowsClient.emit(void 0),null===(r=this.dataflowsClient)||void 0===r||r.dispose(),e.prototype.ngOnDestroy.call(this)},n.prototype.ngOnChanges=function(r){r.flow&&r.flow.isFirstChange()&&this.startFlow(),e.prototype.ngOnChanges.call(this,r)},n.prototype.createDataflowsAppUrl=function(r){var o="".concat(r,"/DataflowsApp");if(this.dataflowsAppFeatureFlags&&this.dataflowsAppFeatureFlags.size>0){var c=new Ws.LE;this.dataflowsAppFeatureFlags.forEach(function(i,d){c=c.set(d,i)}),o=o+"?"+c.toString()}return o},n.prototype.getDefaultAppSettings=function(r){return{group:{id:r,location:"westus",languageCode:1033},hostCapabilities:{platformCapabilities:{supportsDraftDataflows:!1,supportsPublishLater:!1}},hostContext:{type:Ks.isTrident?qn.TridentDataflow:qn.PowerBIPPDF,details:{capacityObjectId:this.capacityObjectId,dataPoolId:this.dataflowId,groupObjectId:"",metadataClientType:"PowerBI",metadataProviderType:"PowerBI"}},locale:this.localizationService.currentLanguageLocale,queryEditorSettings:{closeButtonSettings:{showConfirmationPrompt:!0,actionOnConfirm:L.AlwaysCancel},enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!0,enableQueryOutputDestinations:!0,enableWelcomePane:!0,helpSettings:{communityUrl:"https://aka.ms/PQCommunity",submitAnIdeaUrl:"https://go.microsoft.com/fwlink/?linkid=2154006",supportUrl:"https://go.microsoft.com/fwlink/?linkid=2153926"},useHostConnectionProvider:!0},runMode:se.Flow,sessionId:Z.b$.generateGuid(),themeOverride:zs.z6}},n.prototype.getDefaultClientSettings=function(r){return{container:this.dataflowsClientIFrame.nativeElement,url:this.createDataflowsAppUrl(r)}},n.prototype.initDataflowsClient=function(r,o){var c=this;this.dataflowsClientIFrame.nativeElement.style.display="none",this.isReady$.next(!1),this.dataflowsClient=new Hs(_.merge({appSettings:this.getDefaultAppSettings(o),clientSettings:this.getDefaultClientSettings(r),acquireToken:function(d){return c.mashupService.getPQToken("".concat(d,"/.default")).toPromise()},acquireUPN:function(){return Promise.resolve("")}},this.clientConfigurations)),this.onUpdateDataflowsClient.emit(this.dataflowsClient),this.dataflowsClient.ready.then(function(){c.isReady$.next(!0),c.dataflowsClientIFrame.nativeElement.style.display="block"}),this.startFlow()},n.prototype.startFlow=function(){var r=this;!this.flow||!this.dataflowsClient||this.dataflowsClient.ready.then(function(){r.dataflowsClient.startFlow(r.flow,r.onCloseDataflowsClient)},function(o){r.telemetryService.logEvent(Gs,{reason:o})})},n.\u0275fac=function(o){return new(o||n)(we.\u0275\u0275directiveInject(lo.gz),we.\u0275\u0275directiveInject(Os.vZ),we.\u0275\u0275directiveInject(xs.yh),we.\u0275\u0275directiveInject(Js.M),we.\u0275\u0275directiveInject(Ns.o),we.\u0275\u0275directiveInject(_s.y0))},n.\u0275cmp=we.\u0275\u0275defineComponent({type:n,selectors:[["dataflows-client"]],viewQuery:function(o,c){var i;(1&o&&we.\u0275\u0275viewQuery(Zs,5),2&o)&&(we.\u0275\u0275queryRefresh(i=we.\u0275\u0275loadQuery())&&(c.dataflowsClientIFrame=i.first))},inputs:{capacityObjectId:"capacityObjectId",clientConfigurations:"clientConfigurations",dataflowId:"dataflowId",flow:"flow",onCloseDataflowsClient:"onCloseDataflowsClient"},outputs:{onError:"onError",onUpdateDataflowsClient:"onUpdateDataflowsClient"},features:[we.\u0275\u0275InheritDefinitionFeature,we.\u0275\u0275NgOnChangesFeature],decls:4,vars:3,consts:[["id","dataflowsClientIFrame","pbi-auto-focus",""],["dataflowsClientIFrame",""],["class","loadingSpinnerContainer",4,"ngIf"],[1,"loadingSpinnerContainer"],[1,"pbi-spinner-extra-large"]],template:function(o,c){1&o&&(we.\u0275\u0275element(0,"div",0,1),we.\u0275\u0275template(2,Xs,2,0,"div",2),we.\u0275\u0275pipe(3,"async")),2&o&&(we.\u0275\u0275advance(2),we.\u0275\u0275property("ngIf",!we.\u0275\u0275pipeBind1(3,1,c.isReady$)))},dependencies:[Nr.NgIf,Ys.k,Nr.AsyncPipe],styles:["[_nghost-%COMP%]{display:flex}#dataflowsClientIFrame[_ngcontent-%COMP%], .loadingSpinnerContainer[_ngcontent-%COMP%]{background:var(--fluent-theme-white-color, #FFF);display:flex;flex:1 1 auto;align-items:center;justify-content:center}#dataflowsClientIFrame[hidden][_ngcontent-%COMP%], .loadingSpinnerContainer[hidden][_ngcontent-%COMP%]{display:none}"],changeDetection:0}),n}(js.w),tc=function(){function e(n,r,o,c,i,d,b,T){var g=this;this.dialogRef=n,this.featureSwitchService=r,this.folderService=o,this.localizationService=c,this.route=i,this.router=d,this.store=b,this.data=T,this.flow={kind:R.PublishErrorDialog,errorInfo:this.getErrorInfo(),correlationDetails:{label:this.localizationService.get("Root_Activity_ID_Colon"),id:this.data.rootActivityId},dataflowId:this.data.dataflowId,getHelpUrl:"https://docs.microsoft.com/en-us/power-query/dataflows/troubleshooting-dataflows-issues-creating-dataflow",hostContext:{type:qn.TridentDataflow,details:{capacityObjectId:this.folderService.selectedFolder.capacityObjectId,datapoolId:this.data.dataflowId,metadataClientType:"PowerBI",metadataProviderType:"PowerBI",workspaceObjectId:this.folderService.selectedFolder.isMyWorkspace?this.folderService.selectedFolder.workspaceId:this.folderService.selectedFolder.objectId}},timestamp:this.data.timestamp},this.clientConfigurations={publishErrorDialogCallbacks:{onCallToActionButtonClick:function(){return(0,de.__awaiter)(g,void 0,void 0,function(){var K,Te,De;return(0,de.__generator)(this,function($e){switch($e.label){case 0:return this.dialogRef.close(),[4,this.store.select(Q.S6).pipe((0,Vs.P)()).toPromise()];case 1:return K=$e.sent(),Te=["workloads","dataflows","author","capacityObjectId",this.folderService.activeFolder.capacity.id,"dataflowId",this.data.dataflowId,"extensionActionId",Z.b$.generateGuid(),"workspaceObjectId",null!==(De=K.workspaceId)&&void 0!==De?De:K.objectId],[4,this.router.navigate(Te,{queryParamsHandling:"preserve",relativeTo:this.route})];case 2:return $e.sent(),[2]}})})}}},this.onCloseDataflowsClient=function(){return(0,de.__awaiter)(g,void 0,void 0,function(){return(0,de.__generator)(this,function(F){return this.dialogRef.close(),[2]})})}}return e.prototype.getErrorInfo=function(){if(this.featureSwitchService.featureSwitches.enableHostPublishErrorMessagesForGen2Dataflows){var n=this.getErrorMessages();return{kind:"Explicit",callToActionButtonLabel:this.localizationService.get("Edit_Dataflow"),disableCallToActionButton:this.data.disableCallToActionButton,errorMessage:n.errorMessage,callToActionMessage:n.callToActionMessage,errorDetails:this.data.errorDetails}}return{kind:"ErrorCode",callToActionButtonLabel:this.localizationService.get("Edit_Dataflow"),disableCallToActionButton:this.data.disableCallToActionButton,errorCode:this.data.errorCode,errorDetails:this.data.errorDetails}},e.prototype.getErrorMessages=function(){switch(this.data.errorCode){case 200060:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DependencyCycleDetected_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200020:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowRefreshInProgress_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowRefreshInProgress_CallToActionMessage")};case 200030:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DynamicDatasourceNotSupported_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200050:return{errorMessage:this.localizationService.get("Dataflow_Gen2_MashupDocumentContainsDuplicateQueryName_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_PleaseEditTheDataflowToFixTheProblemAndTryAgain")};case 200090:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowSnapshotMismatch_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowSnapshotMismatch_CallToActionMessage")};case 200100:case 200130:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowNotFound_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowNotFound_CallToActionMessage")};case 200150:return{errorMessage:this.localizationService.get("Dataflow_Gen2_DataflowUnauthorizedError_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_DataflowUnauthorizedError_CallToActionMessage")};case 200230:return{errorMessage:this.localizationService.get("Dataflow_DataflowPublish_CapacityThrottled"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_GenericError_CallToActionMessage")};default:return{errorMessage:this.localizationService.get("Dataflow_Gen2_GenericError_ErrorMessage"),callToActionMessage:this.localizationService.get("Dataflow_Gen2_GenericError_CallToActionMessage")}}},e.\u0275fac=function(r){return new(r||e)(we.\u0275\u0275directiveInject(Fe.so),we.\u0275\u0275directiveInject(Os.vZ),we.\u0275\u0275directiveInject(Bs.s),we.\u0275\u0275directiveInject(Ns.o),we.\u0275\u0275directiveInject(lo.gz),we.\u0275\u0275directiveInject(lo.F0),we.\u0275\u0275directiveInject(xs.yh),we.\u0275\u0275directiveInject(Fe.WI))},e.\u0275cmp=we.\u0275\u0275defineComponent({type:e,selectors:[["dataflow-gen2-publish-error"]],decls:1,vars:3,consts:[[3,"clientConfigurations","flow","onCloseDataflowsClient"]],template:function(r,o){1&r&&we.\u0275\u0275element(0,"dataflows-client",0),2&r&&we.\u0275\u0275property("clientConfigurations",o.clientConfigurations)("flow",o.flow)("onCloseDataflowsClient",o.onCloseDataflowsClient)},dependencies:[ec],styles:["dataflows-client[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e}(),nc=q(16748),rc=function(){function e(){}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=we.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=we.\u0275\u0275defineInjector({imports:[Nr.CommonModule,nc.H]}),e}(),ic=q(79061),oc=q(76966),ac=q(90938),sc=[{componentType:tc,componentIdentifier:"DataflowGen2PublishErrorComponentId"}],cc=function(){function e(){}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=we.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=we.\u0275\u0275defineInjector({imports:[Nr.CommonModule,rc,oc.c.withManifest(sc),ic.v,ac.g]}),e}()},12966:function(ge,qe,q){"use strict";q.d(qe,{C8:function(){return de},z6:function(){return Fe}});var de={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},Fe={palette:{themePrimary:"#117865",themeLighterAlt:"#f1faf8",themeLighter:"#c9e9e3",themeLight:"#9fd6cc",themeTertiary:"#54ae9d",themeSecondary:"#218875",themeDarkAlt:"#0f6c5b",themeDark:"#0d5b4d",themeDarker:"#094339",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},semanticColors:{}}},85928:function(ge,qe,q){"use strict";q.d(qe,{M:function(){return te}});var de=q(36444),Fe=q(35911),Q=q(85732),Z=(0,Q.ZF)("urlConfiguration"),ye=(0,Q.P1)(Z,function(ie){return ie.powerQueryHostUrl}),L=q(37263),Re=q(59694),Qe=q(11547),Ee=q(82762),se=q(35510),R=q(42195),Le=q(14172),ce=q(17653),E=q(88255),be=q(50423),Ve=q(62113),re=q(73875),ne=window,te=function(){function ie(fe,Me,Oe,Pe){var He=this;this.store=fe,this.accessTokenProviderService=Me,this.httpService=Oe,this.inTeams=Pe,this.getAADToken$=function(Ge){return(0,Qe.of)(null).pipe((0,R.zg)(function(){if(ne.clientAuthEnabled)return(0,Ee.D)(He.accessTokenProviderService.acquireToken("MashupService",[Ge],!1)).pipe((0,Le.U)(function(N){return N.token}));if(He.inTeams){var Xe=Ge.substring(0,Ge.lastIndexOf("/"));return de.authentication.initialize(),(0,Ee.D)(de.authentication.getAuthToken({resources:[Xe],silent:!0}))}var D=(0,Re.W)("{0}/msal",ne.baseUrl||window.location.origin),A=He.httpService.powerbiRequestOptions();return A.params={scopes:Ge},He.httpService.get(D,A).pipe((0,Le.U)(function(N){return N.data.AccessToken}))}),(0,ce.b)(function(Xe){var A=1e3*(0,Fe.oG)(Xe).exp;He.AADTokenCache$.next(new Map(He.AADTokenCache$.getValue()).set(Ge,{token:Xe,expiration:A}))}))},this.AADTokenCache$=new se.X(new Map)}return ie.prototype.getPQEndpoint=function(){return this.store.select(ye).pipe((0,Le.U)(function(fe){return(0,Re.g)(fe)?null:fe.replace(/\/$/,"")}))},ie.prototype.getPQToken=function(fe){var Me=this;return this.AADTokenCache$.pipe((0,E.P)(),(0,R.zg)(function(Oe){return!Oe.has(fe)||Date.now()+3e5>Oe.get(fe).expiration?Me.getAADToken$(fe):(0,Qe.of)(Oe.get(fe).token)}))},ie.\u0275fac=function(Me){return new(Me||ie)(be.\u0275\u0275inject(Q.yh),be.\u0275\u0275inject(Ve.Q),be.\u0275\u0275inject(re.O),be.\u0275\u0275inject(L.$,8))},ie.\u0275prov=be.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac,providedIn:"root"}),ie}()}}]);