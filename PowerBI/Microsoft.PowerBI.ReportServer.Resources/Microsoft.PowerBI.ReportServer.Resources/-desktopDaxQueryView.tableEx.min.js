"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["tableEx"],{52073:function(Re,we,X){function B(Q,i){var C=i.getHierarchyDepth(),r=i.getChildren(Q);if(!_.isEmpty(r))for(var e=0,h=r;e<h.length;e++)C=Math.min(C,i.getLevel(h[e]));return C-i.getLevel(Q)}function fe(Q,i){return i.isLeaf(Q)?Q:fe(_.head(i.getChildren(Q)),i)}function ee(Q,i){return void 0!==i.getLeafIndex(Q)?Q:ee(_.head(i.getChildren(Q)),i)}function oe(Q,i){return i.isLeaf(Q)?Q:oe(_.last(i.getChildren(Q)),i)}function le(Q,i){return void 0!==i.getLeafIndex(Q)?Q:le(_.last(i.getChildren(Q)),i)}function F(Q,i){return i.getLeafIndex(fe(Q,i))}function E(Q,i){return i.getLeafIndex(ee(Q,i))}function T(Q,i){return i.getLeafIndex(oe(Q,i))}function O(Q,i){return i.getLeafIndex(le(Q,i))}X.d(we,{LF:function(){return F},O3:function(){return O},hG:function(){return E},oj:function(){return oe},pA:function(){return T},zG:function(){return B}})},15366:function(Re,we,X){X.d(we,{AV:function(){return M},DJ:function(){return I},DX:function(){return J},EO:function(){return Q},FA:function(){return G},MN:function(){return F},Ms:function(){return E},Sv:function(){return h},_E:function(){return r},hw:function(){return O},sB:function(){return U},sW:function(){return e},yl:function(){return C}});var B=X(81337),fe=X(62458),ee=X(52073),oe=X(7911),le=X(44404),F=10,E=50,O=20,Q=20,C=function(){function H(){}return H.getAncestorsToMeasure=function(c,w){for(var d=[];;){var V=w.getParent(c);if(!V||!w.isLastItem(c,w.getChildren(V)))break;d.push({node:V,size:-1}),c=V}return d},H.getSizeDifference=function(c,w,d,V){for(var Z=0,K=0,W=c;K<W.length;K++)Z=Math.max(Z,this.getItemSizeDifference(W[K],w,d,V));return Z},H.getItemSizeDifference=function(c,w,d,V){for(var K=0,W=(0,ee.LF)(c.node,d);W<=w;W++)if((K+=V(W))>=c.size)return 0;return c.size-K},H.getPageIndex=function(c,w){return Math.floor(c/w)},H.itemRangeToPageRange=function(c,w,d){var V=this.getPageIndex(c,d),Z=this.getPageIndex(w,d);if(V===Z)return[{pageIndex:V,startIndex:c%d,endIndex:w%d}];var K=[];K.push({pageIndex:V,startIndex:c%d,endIndex:d-1});for(var W=V+1;W<Z;W++)K.push({pageIndex:W,startIndex:0,endIndex:d-1});return K.push({pageIndex:Z,startIndex:0,endIndex:w%d}),K},H}(),r=function(){function H(){}return H.linesOverlapVertically=function(c,w,d,V){return!(d>c+w||d+V<c)},H.isRowMeasured=function(c,w){return this.getMeasuredRowCount(w)>c},H.getMeasuredRowCount=function(c){var w=c.getPageRows();return _.isEmpty(w)?0:(w.length-1)*O+_.last(w).getRowHeights().length},H.remeasureRows=function(c,w,d,V,Z,K,W){for(var v=0,t=C.itemRangeToPageRange(V,Z,O);v<t.length;v++){var o=t[v];W.measurePage(W.getPageRows()[o.pageIndex],c,w,d,V,K,Q,o.startIndex,o.endIndex-o.startIndex+1)}},H.getVisibleRowStart=function(c,w,d){var V=d.getRowHeight(c.firstLeafIndex);return{rowIndex:c.firstLeafIndex,visibleHeight:V-w+c.firstLeafTop}},H.getVisibleRange=function(c,w,d,V,Z){var K=this.getVisiblePageRange(c,w,d);if(!K)return null;var W=this.getFirstVisibleIndex(K.firstPageRow,K.firstPageIndex,K.firstPageTop,c,w);if(null!=W){var v,te=this.getLastVisibleIndex(K.lastPageRow,K.lastPageIndex,K.lastPageTop,c,w);if(null!=te)return null!=V&&V>=0&&null!=Z&&Z>=0&&(v=Math.max(te,W.leafIndex+V-1),v=Math.min(v,Z)),{firstLeafIndex:W.leafIndex,firstLeafTop:W.top,lastLeafIndex:v??te}}},H.getVisiblePageRange=function(c,w,d){for(var V=0,Z=0,K=null,te=0,v=d.getPageRows();te<v.length;te++){var t=v[te],o=t.getHeight();if(this.linesOverlapVertically(V,o,c,w))K?(K.lastPageRow=t,K.lastPageIndex=Z,K.lastPageTop=V):K={firstPageRow:t,firstPageIndex:Z,firstPageTop:V,lastPageRow:t,lastPageIndex:Z,lastPageTop:V};else if(K)break;V+=o,Z++}return K},H.getFirstVisibleIndex=function(c,w,d,V,Z){for(var K=0,W=d,v=0,t=c.getRowHeights();v<t.length;v++){var o=t[v];if(this.linesOverlapVertically(W,o,V,Z))return{leafIndex:w*O+K,top:W};W+=o,K++}},H.getLastVisibleIndex=function(c,w,d,V,Z){for(var te,K=0,W=d,v=0,t=c.getRowHeights();v<t.length;v++){var o=t[v];this.linesOverlapVertically(W,o,V,Z)&&(te=w*O+K),W+=o,K++}return te},H.getBounds=function(c,w){var d=C.getPageIndex(c,O);if(!(d>=w.getPageRows().length)){for(var V=w.getPageRows()[d],Z=w.getPageRowTop(V),K=c%O,W=0;W<K;W++)Z+=V.getRowHeights()[W];return{top:Z,height:V.getRowHeights()[K]}}},H.getOffset=function(c,w){var d=this.getBounds(c.rowIndex,w);return d?c.alignBottom?c.visibleHeight>=d.height?d.top+d.height:d.top+c.visibleHeight:c.visibleHeight>=d.height?d.top:d.top+d.height-c.visibleHeight:0},H}(),e=function(){function H(){}return H.linesOverlapHorizontally=function(c,w,d,V){return!(d>c+w||d+V<c)},H.isColumnMeasured=function(c,w){return this.getMeasuredColumnCount(w)>c},H.getMeasuredColumnCount=function(c){var w=c.getPageColumns();return _.isEmpty(w)?0:(w.length-1)*F+_.last(w).getColumnWidths().length},H.remeasureColumn=function(c,w,d,V,Z,K){var W=K.getPageColumn(c,w,d,V,Z);K.measurePage(W,w,d,V,Z,E,c%F,1)},H.getVisibleColumnStart=function(c,w,d){var V=d.getColumnWidth(c.firstLeafIndex);return{columnIndex:c.firstLeafIndex,visibleWidth:V-w+c.firstLeafLeft}},H.getVisibleRange=function(c,w,d,V,Z){var K=this.getVisiblePageRange(c,w,d);if(!K)return null;var W=this.getFirstVisibleIndex(K.firstPageColumn,K.firstPageIndex,K.firstPageLeft,c,w);if(null!=W){var v,te=this.getLastVisibleIndex(K.lastPageColumn,K.lastPageIndex,K.lastPageLeft,c,w);if(null!=te)return null!=V&&V>=0&&null!=Z&&Z>=0&&(v=Math.max(te,W.leafIndex+V-1),v=Math.min(v,Z)),{firstLeafIndex:W.leafIndex,firstLeafLeft:W.left,lastLeafIndex:v??te}}},H.getVisiblePageRange=function(c,w,d){for(var V=0,Z=0,K=null,W=0,te=d.getPageColumns();W<te.length;W++){var v=te[W],t=v.getWidth();if(this.linesOverlapHorizontally(V,t,c,w))K?(K.lastPageColumn=v,K.lastPageIndex=Z,K.lastPageLeft=V):K={firstPageColumn:v,firstPageIndex:Z,firstPageLeft:V,lastPageColumn:v,lastPageIndex:Z,lastPageLeft:V};else if(K)break;V+=t,Z++}return K},H.getFirstVisibleIndex=function(c,w,d,V,Z){for(var K=0,W=d,v=0,t=c.getColumnWidths();v<t.length;v++){var o=t[v];if(this.linesOverlapHorizontally(W,o,V,Z))return{leafIndex:w*F+K,left:W};W+=o,K++}return null},H.getLastVisibleIndex=function(c,w,d,V,Z){for(var te,K=0,W=d,v=0,t=c.getColumnWidths();v<t.length;v++){var o=t[v];this.linesOverlapHorizontally(W,o,V,Z)&&(te=w*F+K),W+=o,K++}return te},H.getBounds=function(c,w){var d=C.getPageIndex(c,F);if(!(d>=w.getPageColumns().length)){for(var V=w.getPageColumns()[d],Z=w.getPageColumnLeft(V),K=c%F,W=V.getColumnWidths(),te=0;te<K;te++)Z+=W[te];return{left:Z,width:W[K]}}},H.getOffset=function(c,w){var d=this.getBounds(c.columnIndex,w);return d?c.alignRight?c.visibleWidth>=d.width?d.left+d.width:d.left+c.visibleWidth:c.visibleWidth>=d.width?d.left:d.left+d.width-c.visibleWidth:0},H}(),h=function(){function H(c,w){this.pageColumns=[],this.measureElement=c,this.sizeManager=w}return H.prototype.canAddPageColumn=function(c){return this.pageColumns.length<this.getMaxPageColumnCount(c)},H.prototype.getMaxPageColumnCount=function(c){return Math.ceil(c.getHierarchyLeafCount()/F)},H.prototype.getPageColumns=function(){return this.pageColumns},H.prototype.getPageColumnStartIndex=function(c){var w=this.pageColumns.indexOf(c);return-1===w?-1:w*F},H.prototype.getPageColumnLeft=function(c){for(var w=0,d=0,V=this.pageColumns;d<V.length;d++){var Z=V[d];if(c===Z)break;w+=Z.getWidth()}return w},H.prototype.getColumnsWidth=function(){for(var c=0,w=0,d=this.pageColumns;w<d.length;w++)c+=d[w].getWidth();return c},H.prototype.clear=function(){this.pageColumns=[]},H.prototype.measureNextPage=function(c,w,d,V){var Z=new oe.VG;this.getPageColumns().push(Z),this.measurePage(Z,c,w,d,V,E)},H.prototype.getWidestCellBindingString=function(c,w,d,V,Z,K,W){for(var te={item:null,width:-1},v=0;v<K;v++)this.updateWidestItemFromBodyCell(V.getHierarchyLeafAt(v+W),c,d,V,te);if(w){var t=V.getFloatingHierarchyLeafCount();for(v=0;v<t;v++)this.updateWidestItemFromBodyCell(V.getFloatingHierarchyLeafAt(v),c,d,V,te)}var l,o=d.getApproximateColumnHeaderWidth(c);return o>te.width&&(te.item=c,te.width=o),l=te.item===c?d.getColumnHeaderBinding(te.item,!0):d.getBodyCellBinding(te.item,!0),oe.bG.build(l,H.measureRequiredStyle)},H.prototype.measurePage=function(c,w,d,V,Z,K,W,te){var v=this.getPageColumnStartIndex(c);void 0===W&&(W=0),void 0===te&&(te=Math.min(V.getHierarchyLeafCount()-v,F)+W);for(var t=Math.min(d.getHierarchyLeafCount()-Z,K),o="",l=d.getFloatingHierarchyItems(),g=0;g<te;g++){var f=V.getHierarchyLeafAt(g+W+v);void 0===(c.getColumnWidths()[g+W]=this.sizeManager.getColumnWidth(f))&&(o+=this.getWidestCellBindingString(f,l,w,d,V,t,Z))}if(o){this.measureElement.insertAdjacentHTML("beforeend",o);var n=this.measureElement.firstChild;for(g=0;g<te;g++)void 0===c.getColumnWidths()[g+W]&&(c.getColumnWidths()[g+W]=n.offsetWidth+1,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(c,w,V,v,W,te)}},H.prototype.updateWidestItemFromBodyCell=function(c,w,d,V,Z){var K=V.getIntersection(c,w),W=d.getApproximateBodyCellWidth(K);W>Z.width&&(Z.item=K,Z.width=W)},H.prototype.adjustItemsWidth=function(c,w,d,V,Z,K){for(var W=0;W<K;W++){var te=d.getHierarchyLeafAt(W+Z+V);void 0===this.sizeManager.getColumnWidth(te)&&this.adjustItemWidth(c,W+Z,V,w,d,te)}},H.prototype.adjustItemWidth=function(c,w,d,V,Z,K){var W=this,te=C.getAncestorsToMeasure(K,Z);_.isEmpty(te)||(this.measureAncestors(te,V),c.getColumnWidths()[w]+=C.getSizeDifference(te,w+d,Z,function(v){return W.getColumnWidth(v)}))},H.prototype.measureAncestors=function(c,w){for(var d="",V=0,Z=c;V<Z.length;V++){var W=w.getColumnHeaderBinding(Z[V].node,!0);d+=oe.bG.build(W,H.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",d);for(var te=this.measureElement.firstChild,v=0,t=c;v<t.length;v++)t[v].size=te.offsetWidth+1,te=te.nextSibling;this.measureElement.innerHTML=""},H.prototype.getColumnWidth=function(c,w,d,V,Z){return this.getPageColumn(c,w,d,V,Z).getColumnWidths()[c%F]},H.prototype.setColumnWidth=function(c,w){this.getPageColumn(c).getColumnWidths()[c%F]=w},H.prototype.getPageColumn=function(c,w,d,V,Z){var K=this.getPageIndex(c);if(w&&K>=this.pageColumns.length)for(var W=K-this.pageColumns.length+1,te=0;te<W;te++)this.measureNextPage(w,d,V,Z);return this.pageColumns[K]},H.prototype.getPageIndex=function(c){return C.getPageIndex(c,F)},H.prototype.getLastMeasuredIndex=function(){var c=this.pageColumns.length;if(0===c)return-1;var w=_.last(this.pageColumns);return(c-1)*F+(w.getColumnWidths().length-1)},H.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},H}(),y=function(){function H(c,w,d,V){this.pageRows=[],this.measureElement=c,this.columnWidthMeasureManager=w,this.rowLevelWidthMeasureManager=d,this.sizeManager=V}return H.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},H.prototype.clearFloatingRows=function(){this.floatingPageRow=new oe.BJ},H.prototype.ensureLastPageComplete=function(c,w,d,V,Z,K){if(0===this.pageRows.length)return-1;var te=this.pageRows.length-1,v=this.pageRows[te],t=v.getRowHeights().length;return t<O&&this.gotMoreRows(v,w)&&(this.measurePage(v,c,w,d,V,Z,K,v.getRowHeights().length-1),v.getRowHeights().length>t)?te:-1},H.prototype.measureNextPage=function(c,w,d,V,Z){var K=new oe.BJ;this.getPageRows().push(K),this.measurePage(K,c,w,d,V,Z,Q)},H.prototype.measureFloatingRows=function(c,w,d,V,Z,K,W){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var te=w.getFloatingHierarchyItems();if(!_.isEmpty(te)){for(var v=Math.min(d.getHierarchyLeafCount()-Z,Q),t="",o=w.getFloatingHierarchyLeafCount(),l=0;l<o;l++){var g=w.getFloatingHierarchyLeafAt(l);this.floatingPageRow.getRowHeights()[l]=this.sizeManager.getRowHeight(g),void 0===this.floatingPageRow.getRowHeights()[l]&&(t+=this.getHeighestCellBindingString(g,c,w,d,v,Z,V,K,W))}if(t){this.measureElement.insertAdjacentHTML("beforeend",t);var f=this.measureElement.firstChild;for(l=0;l<o;l++)void 0===this.floatingPageRow.getRowHeights()[l]&&(this.floatingPageRow.getRowHeights()[l]=f.offsetHeight,f=f.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,c,w,0,0,o)}}}},H.prototype.getPageIndex=function(c){return C.getPageIndex(c,O)},H.prototype.getMeasureRequiredStyle=function(c){return{"box-sizing":"border-box",width:(0,le.S)(c)}},H.prototype.gotMoreRows=function(c,w){return w.getHierarchyLeafCount()-this.getPageRowStartIndex(c)-c.getRowHeights().length>0},H.prototype.measurePage=function(c,w,d,V,Z,K,W,te,v){var t=this.getPageRowStartIndex(c);void 0===te&&(te=0),void 0===v&&(v=Math.min(d.getHierarchyLeafCount()-t,O)-te);for(var o=Math.min(V.getHierarchyLeafCount()-K,W),l="",g=0;g<v;g++){var f=d.getHierarchyLeafAt(g+te+t);void 0===(c.getRowHeights()[g+te]=this.sizeManager.getRowHeight(f))&&(l+=this.getHeighestCellBindingString(f,w,d,V,o,K,Z))}if(l){this.measureElement.insertAdjacentHTML("beforeend",l);var n=this.measureElement.firstChild;for(g=0;g<v;g++)void 0===c.getRowHeights()[g+te]&&(c.getRowHeights()[g+te]=n.offsetHeight,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(c,w,d,t,te,v)}},H.prototype.getHeighestCellBindingString=function(c,w,d,V,Z,K,W,te,v){for(var t={item:null,width:-1,height:-1},o=0;o<Z;o++){var l=V.getHierarchyLeafAt(o+K),g=d.getIntersection(c,l),f=this.columnWidthMeasureManager.getColumnWidth(o+K,w,d,V,W),s=w.getApproximateBodyCellHeight(g,f);s>t.height&&(t.item=g,t.width=f,t.height=s)}var S,n=this.getItemWidth(c,d),u=w.getApproximateRowHeaderHeight(c,n);return u>t.height&&(t.item=c,t.height=u,t.width=n),S=t.item===c?w.getRowHeaderBinding(t.item,!0):w.getBodyCellBinding(t.item,!0,void 0,void 0,void 0,te,void 0,v),oe.bG.build(S,this.getMeasureRequiredStyle(t.width))},H.prototype.getItemWidth=function(c,w){return fe.fF.assertFail("abstract method"),0},H.prototype.adjustItemsHeight=function(c,w,d,V,Z,K){fe.fF.assertFail("abstract method")},H.prototype.getMaxPageRowCount=function(c){return Math.ceil(c.getHierarchyLeafCount()/O)},H.prototype.getPageRows=function(){return this.pageRows},H.prototype.getFloatingPageRow=function(){return this.floatingPageRow},H.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},H.prototype.canAddPageRow=function(c){return this.pageRows.length<this.getMaxPageRowCount(c)},H.prototype.getPageRowStartIndex=function(c){if(c===this.floatingPageRow)return 0;var w=this.pageRows.indexOf(c);return-1===w?-1:w*O},H.prototype.getPageRowTop=function(c){if(c===this.floatingPageRow)return 0;for(var w=0,d=0,V=this.pageRows;d<V.length;d++){var Z=V[d];if(c===Z)break;w+=Z.getHeight()}return w},H.prototype.getRowsHeight=function(){for(var c=0,w=0,d=this.pageRows;w<d.length;w++)c+=d[w].getHeight();return c},H.prototype.getRowHeight=function(c,w,d,V,Z,K){return this.getPageRow(c,w,d,V,K).getRowHeights()[c%O]},H.prototype.getFloatingRowHeight=function(c){return this.floatingPageRow.getRowHeights()[c]},H.prototype.getPageRow=function(c,w,d,V,Z,K){var W=this.getPageIndex(c);if(w&&W>this.pageRows.length)for(var te=W-this.pageRows.length+1,v=0;v<te;v++)this.measureNextPage(w,d,V,Z,K);return this.pageRows[W]},H.prototype.getLastMeasuredIndex=function(){var c=this.pageRows.length;if(0===c)return-1;var w=_.last(this.pageRows);return(c-1)*O+(w.getRowHeights().length-1)},H}(),I=function(H){function c(){return null!==H&&H.apply(this,arguments)||this}return(0,B.__extends)(c,H),c.prototype.getItemWidth=function(w,d){return this.rowLevelWidthMeasureManager.getWidth(d.getLevel(w),(0,ee.zG)(w,d))},c.prototype.adjustItemsHeight=function(w,d,V,Z,K,W){for(var te=0;te<W;te++){var v=V.getHierarchyLeafAt(te+K+Z);void 0===this.sizeManager.getRowHeight(v)&&this.adjustItemHeight(w,te+K,Z,d,V,v)}},c.prototype.adjustItemHeight=function(w,d,V,Z,K,W){var te=this,v=C.getAncestorsToMeasure(W,K);_.isEmpty(v)||(this.measureAncestors(v,Z,K),w.getRowHeights()[d]+=C.getSizeDifference(v,V+d,K,function(t){return w===te.getFloatingPageRow()?te.getFloatingRowHeight(t):te.getRowHeight(t)}))},c.prototype.measureAncestors=function(w,d,V){for(var Z="",K=0,W=w;K<W.length;K++){var v=d.getRowHeaderBinding((te=W[K]).node,!0);Z+=oe.bG.build(v,this.getMeasureRequiredStyle(this.getItemWidth(te.node,V)))}this.measureElement.insertAdjacentHTML("beforeend",Z);for(var t=this.measureElement.firstChild,o=0,l=w;o<l.length;o++){var te;(te=l[o]).size=t.offsetHeight,t=t.nextSibling}this.measureElement.innerHTML=""},c}(y),M=function(H){function c(){return null!==H&&H.apply(this,arguments)||this}return(0,B.__extends)(c,H),c.prototype.getItemWidth=function(w,d){return this.rowLevelWidthMeasureManager.getLevelWidth(d.getLevel(w))},c.prototype.adjustItemsHeight=function(w,d,V,Z,K,W){},c}(y),U=function(){function H(c,w,d,V){this.columnLevelHeights=[],this.measureElement=c,this.columnWidthMeasureManager=w,this.rowLevelWidthMeasureManager=d,this.sizeManager=V}return H.prototype.clear=function(){this.columnLevelHeights=[]},H.prototype.getMeasureRequiredStyle=function(c){return{"box-sizing":"border-box",width:(0,le.S)(c)}},H.prototype.measure=function(c,w,d,V,Z,K,W){if(0===this.columnLevelHeights.length){for(var te={done:!1,levels:[],spanningHeaders:[],leafCount:0},v=d.getHierarchyDepth(),t=w.getHierarchyDepth(),o=0;o<v;o++)(void 0===W||W===o)&&(this.columnLevelHeights[o]=this.sizeManager.getColumnLevelHeight(w.getCorner(t-1,o))),te.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var l=d.getHierarchyItems();l&&this.getHeighestColumnHeaders(l,te,c,w,d,V,Z,K);for(var g=0;g<t;g++)for(var f=0;f<v;f++)if(void 0===this.columnLevelHeights[f]){var s=w.getCorner(g,f),n=this.rowLevelWidthMeasureManager.getLevelWidth(g),u=c.getApproximateCornerCellHeight(s,n);u>te.levels[f].largestItemHeight&&(te.levels[f].isHeader=!1,te.levels[f].largestItem=s,te.levels[f].largestItemHeight=u,te.levels[f].largestItemWidth=n)}for(var S="",b=0,p=te.levels;b<p.length;b++)if((m=p[b]).largestItem){var L=this.getMeasureRequiredStyle(m.largestItemWidth);if(m.isHeader){var R=c.getColumnHeaderBinding(m.largestItem,!0);S+=oe.bG.build(R,L)}else R=c.getCornerCellBinding(m.largestItem,!0),S+=oe.bG.build(R,L)}if(S){this.measureElement.insertAdjacentHTML("beforeend",S);for(var k=this.measureElement.firstChild,D=0,re=0,ae=te.levels;re<ae.length;re++){var m;(m=ae[re]).largestItem&&((void 0===W||W===D)&&(this.columnLevelHeights[D]=k.offsetHeight),k=k.nextSibling),D++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(te,c,w,d,V)}}},H.prototype.adjustLevelHeightsFromSpanningHeaders=function(c,w,d,V,Z){for(var K="",W=0,te=c.spanningHeaders;W<te.length;W++)if(c.levels[(v=te[W]).levelToAdjust].largestItem){var t=this.getMeasureRequiredStyle(this.getHeaderWidth(v.item,w,d,V,Z)),o=w.getColumnHeaderBinding(v.item,!0);K+=oe.bG.build(o,t)}if(K){this.measureElement.insertAdjacentHTML("beforeend",K);for(var l=this.measureElement.firstChild,g=0,f=c.spanningHeaders;g<f.length;g++){var v;c.levels[(v=f[g]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(v.item,v.level,v.levelToAdjust,l.offsetHeight,V),l=l.nextSibling)}this.measureElement.innerHTML=""}},H.prototype.adjustLevelFromSpanningHeader=function(c,w,d,V,Z){for(var K=0,W=w;W<=d;W++)K+=this.getLevelHeight(W);V>K&&(this.columnLevelHeights[d]+=V-K)},H.prototype.getHeighestColumnHeaders=function(c,w,d,V,Z,K,W,te){for(var v=0,t=c;v<t.length;v++){var o=t[v];if(w.done)return;var l=Z.isLeaf(o),g=Z.getLevel(o),f=(0,ee.zG)(o,Z),s=(0,ee.pA)(o,Z)>=W;if(s)if(1===f){if(void 0===this.columnLevelHeights[g]){var n=this.getHeaderWidth(o,d,V,Z,K),u=d.getApproximateColumnHeaderHeight(o,n);u>w.levels[g].largestItemHeight&&(w.levels[g].largestItem=o,w.levels[g].largestItemHeight=u,w.levels[g].largestItemWidth=n)}}else w.spanningHeaders.push({item:o,level:g,levelToAdjust:f+g-1});var S=Z.getChildren(o);S&&this.getHeighestColumnHeaders(S,w,d,V,Z,K,W,te),l&&s&&w.leafCount++,w.leafCount===te&&(w.done=!0)}},H.prototype.getHeadersHeight=function(){for(var c=0,w=0,d=this.columnLevelHeights;w<d.length;w++)c+=d[w];return c},H.prototype.getLevelTop=function(c){for(var w=0,d=0;d<c;d++)w+=this.columnLevelHeights[d];return w},H.prototype.getLevelHeight=function(c){return this.columnLevelHeights[c]},H.prototype.getHeaderWidth=function(c,w,d,V,Z){for(var K=(0,ee.LF)(c,V),W=(0,ee.pA)(c,V),te=0,v=K;v<=W;v++)te+=this.columnWidthMeasureManager.getColumnWidth(v,w,d,V,Z);return te},H}(),J=function(){function H(c,w){this.rowLevelWidths=[],this.measureElement=c,this.sizeManager=w}return H.prototype.clear=function(){this.rowLevelWidths=[]},H.prototype.measure=function(c,w,d,V,Z,K){if(0===this.rowLevelWidths.length||void 0!==K){for(var W={done:!1,levels:[],spanningHeaders:[],leafCount:0},te=w.getHierarchyDepth(),v=d.getHierarchyDepth(),t=0;t<te;t++)(void 0===K||K===t)&&(this.rowLevelWidths[t]=this.sizeManager.getRowLevelWidth(w.getCorner(t,v-1))),W.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(w.getHierarchyItems(),W,c,w,V,Z);var o=w.getFloatingHierarchyItems();_.isEmpty(o)||(W.done=!1,W.leafCount=0,this.getWidestRowHeaders(o,W,c,w,-1,w.getFloatingHierarchyLeafCount()));for(var l=0;l<v;l++)for(var g=0;g<te;g++)if(void 0===this.rowLevelWidths[g]){var f=w.getCorner(g,l),s=c.getApproximateCornerCellWidth(f);s>W.levels[g].largestItemWidth&&(W.levels[g].isHeader=!1,W.levels[g].largestItem=f,W.levels[g].largestItemWidth=s)}for(var n="",u=0,S=W.levels;u<S.length;u++)if((b=S[u]).largestItem)if(b.isHeader){var p=c.getRowHeaderBinding(b.largestItem,!0);n+=oe.bG.build(p,H.measureRequiredStyles)}else p=c.getCornerCellBinding(b.largestItem,!0),n+=oe.bG.build(p,H.measureRequiredStyles);if(n){this.measureElement.insertAdjacentHTML("beforeend",n);for(var m=this.measureElement.firstChild,L=0,R=0,k=W.levels;R<k.length;R++){var b;(b=k[R]).largestItem&&((void 0===K||K===L)&&(this.rowLevelWidths[L]=m.offsetWidth+1),m=m.nextSibling),L++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(W,c,w)}}},H.prototype.adjustLevelWidthsFromSpanningHeaders=function(c,w,d){for(var V="",Z=0,K=c.spanningHeaders;Z<K.length;Z++)if(c.levels[(W=K[Z]).levelToAdjust].largestItem){var te=w.getRowHeaderBinding(W.item,!0);V+=oe.bG.build(te,H.measureRequiredStyles)}if(V){this.measureElement.insertAdjacentHTML("beforeend",V);for(var v=this.measureElement.firstChild,t=0,o=c.spanningHeaders;t<o.length;t++){var W;c.levels[(W=o[t]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(W.item,W.level,W.levelToAdjust,v.offsetWidth,d),v=v.nextSibling)}this.measureElement.innerHTML=""}},H.prototype.adjustLevelWidthFromSpanningHeader=function(c,w,d,V,Z){for(var K=0,W=w;W<=d;W++)K+=this.getLevelWidth(W);V>K&&(this.rowLevelWidths[d]+=V-K)},H.prototype.getWidestRowHeaders=function(c,w,d,V,Z,K){for(var W=0,te=c;W<te.length;W++){var v=te[W];if(w.done)return;var t=V.isLeaf(v),o=V.getLevel(v),l=(0,ee.zG)(v,V),g=(0,ee.pA)(v,V)>=Z;if(g)if(1===l){if(void 0===this.rowLevelWidths[o]){var f=d.getApproximateRowHeaderWidth(v);f>w.levels[o].largestItemWidth&&(w.levels[o].largestItem=v,w.levels[o].largestItemWidth=f)}}else w.spanningHeaders.push({item:v,level:o,levelToAdjust:l+o-1});var s=V.getChildren(v);s&&this.getWidestRowHeaders(s,w,d,V,Z,K),t&&g&&w.leafCount++,w.leafCount===K&&(w.done=!0)}},H.prototype.getHeadersWidth=function(){for(var c=0,w=0,d=this.rowLevelWidths;w<d.length;w++)c+=d[w];return c},H.prototype.getLevelLeft=function(c){for(var w=0,d=0;d<c;d++)w+=this.rowLevelWidths[d];return w},H.prototype.getLevelWidth=function(c){return this.rowLevelWidths[c]},H.prototype.setLevelWidth=function(c,w){this.rowLevelWidths[c]=w},H.prototype.getWidth=function(c,w){for(var d=0,V=c;V<c+w;V++)d+=this.getLevelWidth(V);return d},H.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},H}(),G=function(){function H(c,w){this.measureElement=c,this.sizeManager=w}return H.prototype.clear=function(){this.width=void 0},H.prototype.getHeaderBindingString=function(c,w){var d=w.getRowHeaderBinding(c,!0);return oe.bG.build(d,J.measureRequiredStyles)},H.prototype.measure=function(c,w,d,V,Z,K){if((void 0===this.width||void 0!==K)&&(this.width=this.sizeManager.getRowLevelWidth(w.getCorner(0,d.getHierarchyDepth()-1)),void 0===this.width)){for(var W="",te=Math.min(w.getHierarchyLeafCount()-V,Z),v=0;v<te;v++)W+=this.getHeaderBindingString(w.getHierarchyLeafAt(v+V),c);var t=w.getFloatingHierarchyItems();if(!_.isEmpty(t)){var o=w.getFloatingHierarchyLeafCount();for(v=0;v<o;v++)W+=this.getHeaderBindingString(w.getFloatingHierarchyLeafAt(v),c)}if(w.getHierarchyDepth()>0)for(v=0;v<d.getHierarchyDepth();v++){var l=w.getCorner(0,v),g=c.getCornerCellBinding(l,!0);W+=oe.bG.build(g,J.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",W);for(var f=this.measureElement.firstChild,s=0;f;)s=Math.max(s,f.offsetWidth+1),f=f.nextSibling;this.measureElement.innerHTML="",this.width=s}},H.prototype.getHeadersWidth=function(){return this.width},H.prototype.getLevelWidth=function(c){return this.width},H.prototype.setLevelWidth=function(c,w){this.width=w},H.prototype.getLevelLeft=function(c){return 0},H}()},87914:function(Re,we,X){X.d(we,{yv:function(){return ee},zf:function(){return B}});var B=9,ee=250},79465:function(Re,we,X){X.d(we,{BM:function(){return B},aP:function(){return le},p0:function(){return fe},xU:function(){return oe},y2:function(){return ee}});var B=function(F){return F[F.Incremental=0]="Incremental",F[F.ClearRendering=1]="ClearRendering",F[F.ClearMeasurement=2]="ClearMeasurement",F[F.ClearMeasurementOnly=3]="ClearMeasurementOnly",F[F.ResizeColumn=4]="ResizeColumn",F}({}),fe=function(F){return F[F.Header=0]="Header",F[F.Body=1]="Body",F[F.Footer=2]="Footer",F[F.FooterHeader=3]="FooterHeader",F[F.MatrixRowHeader=4]="MatrixRowHeader",F[F.MatrixCorner=5]="MatrixCorner",F}({}),ee=function(F){return F[F.Table=0]="Table",F[F.Matrix=1]="Matrix",F}({}),oe=function(F){return F[F.Blocked=0]="Blocked",F[F.Stepped=1]="Stepped",F}({}),le=function(F){return F[F.Prefix=0]="Prefix",F[F.Main=1]="Main",F}({})},44404:function(Re,we,X){X.d(we,{S:function(){return fe}});var B=X(62458);function fe(ee){return B.fF.assertValue(null!=ee,"value should be defined"),0===ee?ee.toString():ee+"px"}},7911:function(Re,we,X){X.d(we,{BJ:function(){return le},VG:function(){return oe},bG:function(){return F}});var B=X(55007),fe=X(62458),ee=X(79602),oe=function(){function E(){this.columnWidths=[]}return E.prototype.getColumnWidths=function(){return this.columnWidths},E.prototype.getWidth=function(){return _.sum(this.columnWidths)},E}(),le=function(){function E(){this.rowHeights=[]}return E.prototype.getRowHeights=function(){return this.rowHeights},E.prototype.getHeight=function(){return _.sum(this.rowHeights)},E.prototype.clear=function(){this.rowHeights=[]},E}(),F=function(){function E(){}return E.build=function(T,O){if(void 0===O&&(O={}),null===T.tagName)return T.content;var Q=T.tagName||"div",i="<"+Q+" "+this.buildAttributes(T.attributes)+this.buildClassNames(T.classNames)+this.buildStyles(T.styleProperties,O)+">";if(_.isEmpty(T.children))null!=T.content&&(i+=T.content);else for(var C=0,r=T.children;C<r.length;C++)i+=E.build(r[C],null);return i+"</"+Q+">"},E.buildMultiple=function(T){return _.map(T,function(O){return E.build(O)}).join("")},E.buildAttributes=function(T){var O="";if(T)for(var Q in T)O+=Q+"="+B.u3+T[Q]+B.u3;return O},E.buildClassNames=function(T){if(!T||0===T.length)return"";for(var O='class="',Q=0,i=T;Q<i.length;Q++)O+=i[Q]+" ";return O+'"'},E.buildStyles=function(T,O){var Q=!_.isEmpty(O),i=!_.isEmpty(T);if(!Q&&!i)return"";var C="style="+B.u3;if(i)for(var r in T)C+=r+":"+T[r]+";";if(Q)for(var e in O)C+=e+":"+O[e]+";";return C+B.u3},E.attachEventHandlers=function(T,O){if(O.clickHandler&&T.addEventListener("click",function(i){return O.clickHandler(i)}),O.contextMenuHandler&&T.addEventListener("contextmenu",function(i){return O.contextMenuHandler(i)}),O.scrollHandler&&ee.l.runOutsideAngular(function(){T.addEventListener("scroll",function(i){return O.scrollHandler(i)})}),!_.isEmpty(O.children)){fe.fF.assert(function(){return O.children.length===T.childNodes.length},"Element children mismatch");for(var Q=0;Q<O.children.length;Q++)null!==O.children[Q].tagName&&E.attachEventHandlers(T.childNodes[Q],O.children[Q])}},E.attachEventHandlersMultiple=function(T,O){var Q=T;O.forEach(function(i){E.attachEventHandlers(Q,i),Q=Q.nextElementSibling})},E}()},24133:function(Re,we,X){X.d(we,{d:function(){return te}});var B=X(81337),fe=X(11034),ee=X(62458),oe=X(59107),le=X(98094),F=X(79602),E=X(44102),T=X(93340),O=X(71090),Q=X(52073),i=X(15366),C=X(44404),r=X(87914),e=X(79465),h=X(11184),y=function(){function v(t,o,l){this.onFocusChangedHandler=t,this.isA11yTable=o,this.isA11yMatrix=l}return Object.defineProperty(v.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),v.prototype.updateMeasureManagers=function(t,o){this.rowHeightMeasureManager=t,this.columnWidthMeasureManager=o},v.prototype.setAsFocusTableEx=function(t,o,l,g){ee.fF.assert(function(){return null!=t||l!==e.p0.Body},"body cells need row index"),l===e.p0.Header?this.currentFocus=g?{columnHeader:g}:{columnHeader:[o]}:l===e.p0.Body?this.currentFocus={bodyCell:{rowIndex:t,columnIndex:o}}:l===e.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:t??0,columnIndex:o}}:l===e.p0.FooterHeader?this.currentFocus={floatingRowHeader:t}:l===e.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:o,columnLevel:t}}:l===e.p0.MatrixRowHeader?this.currentFocus=g?{rowHeader:g}:{rowHeader:[t]}:ee.fF.assertNever(l),this.updateFocusedItem()},v.prototype.updateFocusedItem=function(){if(ee.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var t=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),o=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);ee.fF.assertValue(t,"row leaf not found"),ee.fF.assertValue(o,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(t,o)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(t=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),o=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),ee.fF.assertValue(t,"row leaf not found"),ee.fF.assertValue(o,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(t,o)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):ee.fF.assertFail("unexpected focus state");ee.fF.assertValue(this.currentFocus,"Undefined focused item")}},v.prototype.moveFocus=function(t,o,l,g,f,s){ee.fF.assertValue(this.currentFocus,"No initial focus");var n=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(t,o,f,g):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(t,o,f,s):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(t,o,g):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(t,o):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(t,o):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(t,o)),ee.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=n},v.prototype.moveBodyCellFocusTableEx=function(t,o,l,g){var f=this.currentFocus.bodyCell.rowIndex,s=this.currentFocus.bodyCell.columnIndex,n=this.rowNavigator.getFloatingHierarchyLeafCount()>0,u=-1===s,S=this.rowHeightMeasureManager.getPageRows().length,b=_.last(this.rowHeightMeasureManager.getPageRows()),p=(S-1)*i.hw+(b.getRowHeights().length-1),m=this.columnWidthMeasureManager.getPageColumns().length,L=_.last(this.columnWidthMeasureManager.getPageColumns()),R=(m-1)*i.MN+(L.getColumnWidths().length-1);if(o){if("home"===t)return g?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===t)return g?this.getBottomRightCell():n?{floatingBodyCell:{rowIndex:0,columnIndex:R}}:{bodyCell:{rowIndex:p,columnIndex:R}};if("up"===t)return g?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(s))[0]]}:u?{bodyCell:{rowIndex:0,columnIndex:s}}:{columnHeader:[s]};if("down"===t)return u||!n?{bodyCell:{rowIndex:p,columnIndex:s}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:s}};if("left"===t)return g?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))[0]]}:{bodyCell:{rowIndex:f,columnIndex:0}};if("right"===t)return{bodyCell:{rowIndex:f,columnIndex:R}}}else{if("home"===t){if(g){var k=this.rowNavigator.getHierarchyLeafAt(f),D=this.rowNavigator.getLeafAncestorAtLevel(k,0);return{rowHeader:this.rowNavigator.getPathIndices(D)}}return{bodyCell:{rowIndex:f,columnIndex:0}}}if("end"===t)return g?{bodyCell:{rowIndex:f,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:f,columnIndex:R}};if("pageup"===t&&l)return{bodyCell:{rowIndex:ae=Math.max(this.prevNonblankRowIndex(f-l+1),0),columnIndex:s}};if("pagedown"===t&&l){var he=this.prevNonblankRowIndex(p+1);return{bodyCell:{rowIndex:ae=Math.min(this.nextNonblankRowIndex(f+l-1),he),columnIndex:s}}}if("up"===t)return(ae=this.prevNonblankRowIndex(f))<0?u?{bodyCell:{rowIndex:0,columnIndex:s}}:g&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(s))}:{columnHeader:[s]}:{bodyCell:{rowIndex:ae,columnIndex:s}};if("down"===t){var ae;if(!((ae=this.nextNonblankRowIndex(f))>p))return{bodyCell:{rowIndex:ae,columnIndex:s}};if(u||!n&&!g)return{bodyCell:{rowIndex:p,columnIndex:s}};if(!g||n)return{floatingBodyCell:{rowIndex:0,columnIndex:s}}}if("left"===t)return g&&0===s?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(f))}:{rowHeader:[f]}:{bodyCell:{rowIndex:f,columnIndex:Math.max(s-1,-1)}};if("right"===t)return{bodyCell:{rowIndex:f,columnIndex:Math.min(s+1,R)}}}return this.currentFocus},v.prototype.moveRowHeaderFocusTableEx=function(t,o,l,g){var f,s=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=this.columnNavigator.getHierarchyDepth(),u=this.currentFocus.rowHeader,S=this.rowNavigator.getNodeFromPath(u),b=this.rowNavigator instanceof h.S?0:this.rowNavigator.getLevel(S),p=this.rowNavigator.getItemsByLevel(b),m=p.indexOf(S),L=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(o){if("home"===t)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===t)return this.getBottomRightCell();if("up"===t)return{cornerCell:{rowLevel:b,columnLevel:0}};if("down"===t)return this.getBottomFooterHeaderCell(b)}else{if("left"===t&&u.length>1)return{rowHeader:_.dropRight(u,1)};if("right"===t){if(null!==(f=this.previousFocus)&&void 0!==f&&f.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var R=this.rowNavigator.getLeafIndex(S);if(void 0===R)return{rowHeader:(0,B.__spreadArray)((0,B.__spreadArray)([],u||[],!0),[0],!1)};if(s>-1)return{bodyCell:{rowIndex:R,columnIndex:0}}}if("up"===t)return(k=this.prevNonblankHeaderRowIndex(m,p))>=0?{rowHeader:this.rowNavigator.getPathIndices(p[k])}:{cornerCell:{rowLevel:b,columnLevel:n-1}};if("down"===t){if((k=this.nextNonblankHeaderRowIndex(m,p))<=p.length-1)return{rowHeader:this.rowNavigator.getPathIndices(p[k])};if(L)return{floatingRowHeader:0}}if("pagedown"===t){var D=this.rowHeightMeasureManager.getLastMeasuredIndex(),re=(0,Q.hG)(this.currentFocus.item,this.rowNavigator),ae=this.nextNonblankRowIndex(re+l-1),he=this.prevNonblankRowIndex(D+1),se=Math.min(ae,he),Y=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(se));if(this.rowNavigator.isLeaf(S)||this.rowNavigator instanceof h.S)return{rowHeader:Y};var ue=_.take(Y,Math.min(this.currentFocus.rowHeader.length,Y.length)),k=this.nextNonblankHeaderRowIndex(m,p);return _.isEqual(ue,this.currentFocus.rowHeader)&&k<=p.length-1?{rowHeader:this.rowNavigator.getPathIndices(p[k])}:{rowHeader:ue}}if("pageup"===t&&(re=(0,Q.hG)(this.currentFocus.item,this.rowNavigator),se=Math.max(this.prevNonblankRowIndex(re-l+1),0),Y=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(se)),(ue=_.take(Y,Math.min(this.currentFocus.rowHeader.length,Y.length)))!==this.currentFocus.rowHeader))return{rowHeader:ue}}return u.length>1&&(o&&"left"===t||"home"===t)?{rowHeader:[u[0]]}:o&&"right"===t||"end"===t?{bodyCell:{rowIndex:(0,Q.hG)(S,this.rowNavigator),columnIndex:s}}:this.currentFocus},v.prototype.moveColumnHeaderFocusTableEx=function(t,o,l){var g,f=this.currentFocus.columnHeader[0],s=this.rowNavigator.getFloatingHierarchyLeafCount()>0,n=this.rowHeightMeasureManager.getPageRows().length,u=_.last(this.rowHeightMeasureManager.getPageRows()),S=u?(n-1)*i.hw+(u.getRowHeights().length-1):-1,b=this.columnWidthMeasureManager.getPageColumns().length,p=_.last(this.columnWidthMeasureManager.getPageColumns()),m=(b-1)*i.MN+(p.getColumnWidths().length-1),L=this.currentFocus.columnHeader,R=this.columnNavigator.getNodeFromPath(L),k=this.columnNavigator.getLevel(R),D=this.rowNavigator.getHierarchyDepth();if(o){if("home"===t)return l?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===t){if(l)return this.getBottomRightCell();if(s)return{floatingBodyCell:{rowIndex:0,columnIndex:m}};if(-1!==S)return{bodyCell:{rowIndex:S,columnIndex:m}}}if("down"===t){var re=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(R):f;return this.getBottomFooterBodyCell(re,S)}if("up"===t)return{columnHeader:[L[0]]}}else{if("up"===t&&l&&this.columnNavigator.hasHierarchy()&&L.length>1)return{columnHeader:_.dropRight(L,1)};if("down"===t){if(l){if(null!==(g=this.previousFocus)&&void 0!==g&&g.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var ae=this.columnNavigator.getLeafIndex(R);if(!this.columnNavigator.isLeaf(R))return{columnHeader:(0,B.__spreadArray)((0,B.__spreadArray)([],this.currentFocus.columnHeader,!0),[0],!1)};if(S>=0)return{bodyCell:{rowIndex:0,columnIndex:ae}};if(s)return{floatingBodyCell:{rowIndex:0,columnIndex:ae}}}if(-1!==S)return{bodyCell:{rowIndex:0,columnIndex:f}}}var he=this.columnNavigator.getItemsByLevel(k),se=he.indexOf(R);if("left"===t)return l?se>0?{columnHeader:this.columnNavigator.getPathIndices(he[se-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:D-1,columnLevel:k}}:{cornerCell:{rowLevel:0,columnLevel:k}}:{columnHeader:[Math.max(f-1,0)]};if("right"===t)return l&&-1!==se?{columnHeader:this.columnNavigator.getPathIndices(he[Math.min(se+1,he.length-1)])}:{columnHeader:[Math.min(f+1,m)]}}return"home"===t||o&&"left"===t?l?{cornerCell:{rowLevel:0,columnLevel:k}}:{columnHeader:[0]}:"end"===t||o&&"right"===t?l?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[m]}:this.currentFocus},v.prototype.moveCornerCellFocusTableEx=function(t,o){var l=this.currentFocus.cornerCell.rowLevel,g=this.currentFocus.cornerCell.columnLevel,f=this.rowNavigator.getItemsByLevel(l),s=this.columnNavigator.getItemsByLevel(g),n=this.rowNavigator.getHierarchyLeafCount(),u=this.rowNavigator.getHierarchyDepth(),S=this.columnNavigator.getHierarchyDepth(),b=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(o){if("home"===t)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===t)return this.getBottomRightCell();if("up"===t)return{cornerCell:{rowLevel:l,columnLevel:0}};if("down"===t)return this.getBottomFooterHeaderCell(l)}else{if("up"===t&&g>0)return{cornerCell:{rowLevel:l,columnLevel:g-1}};if("down"===t){if(g<S-1)return{cornerCell:{rowLevel:l,columnLevel:g+1}};if(n>0)return{rowHeader:this.rowNavigator.getPathIndices(f[0])};if(b)return{floatingRowHeader:0}}if("right"===t){if(l<u-1)return{cornerCell:{rowLevel:l+1,columnLevel:g}};if(!_.isEmpty(s))return{columnHeader:this.columnNavigator.getPathIndices(s[0])}}if("left"===t&&l>0)return{cornerCell:{rowLevel:l-1,columnLevel:g}}}return l>0&&("home"===t||o&&"left"===t)?{cornerCell:{rowLevel:0,columnLevel:g}}:"end"===t||o&&"right"===t?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},v.prototype.moveFloatingRowHeaderFocusTableEx=function(t,o){var l=this.rowNavigator.getHierarchyLeafCount(),g=this.columnWidthMeasureManager.getLastMeasuredIndex(),f=this.columnNavigator.getHierarchyDepth(),s=this.currentFocus.floatingRowHeader;if(ee.fF.assert(function(){return g>-1},"There can not be Floating rows without column headers"),o){if("home"===t||"up"===t)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===t)return this.getBottomRightCell();if("down"===t&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===t)return{floatingBodyCell:{rowIndex:s,columnIndex:0}};if("up"===t){if(s>0)return{floatingRowHeader:s-1};if(l>0){var n=this.rowNavigator.getItemsByLevel(0),u=this.prevNonblankHeaderRowIndex(n.length,n);return{rowHeader:this.rowNavigator.getPathIndices(n[u])}}return{cornerCell:{rowLevel:0,columnLevel:f-1}}}if("down"===t&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:s+1}}return o&&"right"===t||"end"===t?{floatingBodyCell:{rowIndex:s,columnIndex:g}}:this.currentFocus},v.prototype.moveFloatingBodyCellFocusTableEx=function(t,o){var l=this.currentFocus.floatingBodyCell.columnIndex,g=this.currentFocus.floatingBodyCell.rowIndex,f=-1===l,s=this.rowHeightMeasureManager.getPageRows().length,n=_.last(this.rowHeightMeasureManager.getPageRows()),u=n?(s-1)*i.hw+(n.getRowHeights().length-1):-1,S=this.columnWidthMeasureManager.getPageColumns().length,b=_.last(this.columnWidthMeasureManager.getPageColumns()),p=(S-1)*i.MN+(b.getColumnWidths().length-1);if(o){if("home"===t)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===t)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:p}};if("up"===t){if(this.isA11yMatrix){var m=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0);return{columnHeader:[this.columnNavigator.getIndex(m)]}}return f?{bodyCell:{rowIndex:0,columnIndex:l}}:{columnHeader:[l]}}if("down"===t)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:l}};if("left"===t)return this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===t)return{floatingBodyCell:{rowIndex:g,columnIndex:p}}}else{if("home"===t)return this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===t)return{floatingBodyCell:{rowIndex:0,columnIndex:p}};if("up"===t)return 0===g?u>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(u+1),columnIndex:l}}:(m=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0),{columnHeader:[this.columnNavigator.getIndex(m)]}):{floatingBodyCell:{rowIndex:g-1,columnIndex:l}};if("down"===t&&g<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:g+1,columnIndex:l}};if("left"===t)return 0===l&&this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:g,columnIndex:Math.max(l-1,0)}};if("right"===t)return{floatingBodyCell:{rowIndex:g,columnIndex:Math.min(l+1,p)}}}return this.currentFocus},v.prototype.getBottomRightCell=function(){var t=this.rowNavigator.getFloatingHierarchyLeafCount(),o=this.columnWidthMeasureManager.getLastMeasuredIndex(),l=this.rowNavigator.getHierarchyLeafCount()-1;return t>0?{floatingBodyCell:{rowIndex:t-1,columnIndex:o}}:{bodyCell:{rowIndex:l,columnIndex:o}}},v.prototype.getLastMatrixColumnCell=function(t){var o=this.columnNavigator.getHierarchyLeafCount(),l=this.columnNavigator.getHierarchyLeafAt(o-1),g=this.columnNavigator.getPathIndices(l);return{columnHeader:_.dropRight(g,g.length-(t+1))}},v.prototype.getFirstColumnLeafFromAncestor=function(t){return this.columnNavigator.isLeaf(t)?this.columnNavigator.getLeafIndex(t):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(t)[0])},v.prototype.getBottomFooterBodyCell=function(t,o){var l=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==t&&l?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:t}}:-1===o?this.currentFocus:{bodyCell:{rowIndex:o,columnIndex:t}}},v.prototype.getBottomFooterHeaderCell=function(t){var o=this.rowNavigator.getItemsByLevel(t);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(o[o.length-1])}},v.prototype.prevNonblankRowIndex=function(t){for(var o=t-1;o>=0;o--)if(!this.rowNavigator.isBlankRow(o))return o;return-1},v.prototype.nextNonblankRowIndex=function(t){for(var o=this.rowNavigator.getHierarchyLeafCount(),l=t+1;l<o;l++)if(!this.rowNavigator.isBlankRow(l))return l;return o+1},v.prototype.prevNonblankHeaderRowIndex=function(t,o){for(var l=t-1;l>=0;l--)if(!this.rowNavigator.isBlank(o[l]))return l;return-1},v.prototype.nextNonblankHeaderRowIndex=function(t,o){for(var l=t+1;l<o.length;l++)if(!this.rowNavigator.isBlank(o[l]))return l;return o.length},v}(),I=X(51660),M=function(){function v(t,o,l,g,f,s){var n=this;this.isA11yMatrix=s,this.elementOriginalCursor=o?.style.cursor,this.verticalResizeHandler=l,this.horizontalResizeHandler=g,(l||g)&&(o.addEventListener("mousedown",function(u){return o.closest("[".concat(I.y3,"=true]"))?null:n.onMouseDown(t,o,u)}),o.addEventListener("mousemove",function(u){return o.closest("[".concat(I.y3,"=true]"))?null:n.onMouseMove(o,u)}),o.addEventListener("dblclick",function(u){return o.closest("[".concat(I.y3,"=true]"))?null:n.onDoubleClick(t,o,u)})),f&&o.addEventListener("click",function(u){return n.onClick(t,o,u,f)})}return v.prototype.onMouseDown=function(t,o,l){var g=this.getActiveHandler(o,l);if(g){this.resizing=!0,this.startMousePosition=v.getMouseCoordinates(l);var f=(0,T.df)(o);this.initializeDocumentEvents(o,g,f),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(o,l)),g.onStartResize(t)}else this.resizing=!1},v.prototype.onMouseMove=function(t,o){this.startMousePosition||(t.style.cursor=this.getCursor(t,o))},v.prototype.onDoubleClick=function(t,o,l){var g=this.getActiveHandler(o,l);g&&g.onReset(t)},v.prototype.onClick=function(t,o,l,g){this.isA11yMatrix&&!o.closest("[".concat(I.y3,"=true]"))&&l.stopPropagation(),!this.resizing&&g&&g(t,l)},v.prototype.getActiveHandler=function(t,o){return this.isMouseOnVerticalHandle(t,v.getMouseCoordinates(o))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(t,v.getMouseCoordinates(o))?this.horizontalResizeHandler:null},v.prototype.getCursor=function(t,o){return this.isMouseOnVerticalHandle(t,v.getMouseCoordinates(o))?"col-resize":this.isMouseOnHorizontalHandle(t,v.getMouseCoordinates(o))?"row-resize":this.elementOriginalCursor},v.prototype.initializeDocumentEvents=function(t,o,l){var g=this;this.documentMouseMoveListener=function(f){f.preventDefault(),o.onResize(v.getMouseCoordinatesDelta(g.startMousePosition,v.getMouseCoordinates(f),l))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(f){f.preventDefault(),document.removeEventListener("mousemove",g.documentMouseMoveListener),g.documentMouseMoveListener=null,document.removeEventListener("mouseup",g.documentMouseUpListener),g.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=g.documentOriginalCursor,g.documentOriginalCursor=void 0),g.startMousePosition=null,o.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},v.prototype.isMouseOnVerticalHandle=function(t,o){return!!this.verticalResizeHandler&&o.x>=t.getBoundingClientRect().right-v.HandleSize},v.prototype.isMouseOnHorizontalHandle=function(t,o){return!!this.horizontalResizeHandler&&o.y>=t.getBoundingClientRect().bottom-v.HandleSize},v.getMouseCoordinates=function(t){return{x:t.pageX,y:t.pageY}},v.getMouseCoordinatesDelta=function(t,o,l){return o&&t?{x:(o.x-t.x)/l,y:(o.y-t.y)/l}:{x:0,y:0}},v.HandleSize=4,v}(),U=function(){function v(t,o,l){this.a11yTableFS=o,this.a11yMatrixFS=l,this.control=t}return v.prototype.onStartResize=function(t){var o=(0,Q.oj)(t,this.control.getColumnNavigator()),l=this.control.getColumnNavigator().getLeafIndex(o);this.resizeState={leafToResize:o,leafToResizeIndex:l,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(l)}},v.prototype.onResize=function(t){if(t.x&&this.resizeState){var o=this.control.getViewport(),l=i._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager()),g=i.sW.getVisibleRange(o.left,o.width,this.control.getColumnWidthMeasureManager());if(l&&g){var f=Math.max(this.resizeState.originalWidth+t.x,M.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,f),i._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,g.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(e.BM.ResizeColumn)}}},v.prototype.onEndResize=function(){if(this.resizeState){var t=this.resizeState.leafToResize,o=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),l=this.resizeState.originalWidth;this.resizeState=void 0;var g=this.control.getViewport(),f=i._E.getVisibleRange(g.top,g.height,this.control.getRowHeightMeasureManager());if(f&&o!==l){this.control.getSizeManager().setColumnWidth(t,o);var s=i._E.getVisibleRowStart(f,g.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(e.BM.ClearRendering,s)}}},v.prototype.onReset=function(t){var o=this.control.getViewport(),l=i._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(l){var g=(0,Q.oj)(t,this.control.getColumnNavigator()),f=this.control.getColumnNavigator().getLeafIndex(g);this.control.getSizeManager().setColumnWidth(g,void 0),i.sW.remeasureColumn(f,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,this.control.getColumnWidthMeasureManager());var s=i._E.getVisibleRowStart(l,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(e.BM.ClearRendering,s)}},v}(),H=function(){function v(t,o){this.a11yMatrixFS=o,this.control=t}return v.prototype.onStartResize=function(t){var o=this.getLevelToResize(t);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(o,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:o,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(o)}},v.prototype.onResize=function(t){if(t.x&&this.resizeState){var o=this.control.getViewport(),l=i._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager()),g=i.sW.getVisibleRange(o.left,o.width,this.control.getColumnWidthMeasureManager());if(l){var f=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+t.x,M.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,f),i._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,g?g.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(e.BM.ResizeColumn)}}},v.prototype.onEndResize=function(){if(this.resizeState){var t=this.resizeState.cornerCellToResize,o=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),l=this.resizeState.originalWidth;this.resizeState=void 0;var g=this.control.getViewport(),f=i._E.getVisibleRange(g.top,g.height,this.control.getRowHeightMeasureManager());if(f&&o!==l){this.control.getSizeManager().setRowLevelWidth(t,o);var s=i._E.getVisibleRowStart(f,g.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(e.BM.ClearRendering,s)}}},v.prototype.onReset=function(t){var o=this.control.getViewport(),l=i._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(l){var g=this.getLevelToResize(t),f=this.control.getRowNavigator().getCorner(g,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(f,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,i.Ms,g);var s=i._E.getVisibleRowStart(l,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(e.BM.Incremental,s)}},v.prototype.getLevelToResize=function(t){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(t)},v.prototype.getMaxWidth=function(t){for(var o=this.control.getClientWidth(),l=0;l<t;l++)o-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(l);return o},v}(),c=X(57470),w=X(7911),d=function(){function v(t,o,l,g,f,s,n,u,S,b,p,m,L){var k,R=this;this.element=t,this.prefixCellClickHandler=o,this.prefixCellContextMenuHandler=l,this.mainCellClickHandler=g,this.mainCellContextMenuHandler=f,this.interactionHandler=s,this.section=n,this.renderType=u,this.onObject=S,this.enableCalculationHighlight=b,this.isRenderStable=p,this.showTotalPlaceHolders=m,this.showAsTableNativeMenu=L,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(D){var re,ae,he=D.target,se=R.getItemByElement(he);se&&(R.isPrefixCell(he)?null===(re=R.prefixCellClickHandler)||void 0===re||re.call(R,se,D,void 0,R.section):null===(ae=R.mainCellClickHandler)||void 0===ae||ae.call(R,se,D,void 0,R.section))}),this.element.addEventListener("contextmenu",function(D){var re,ae,he=D.target,se=R.getItemByElement(he);!se||L||(R.isPrefixCell(he)?null===(re=R.prefixCellContextMenuHandler)||void 0===re||re.call(R,se,D):null===(ae=R.mainCellContextMenuHandler)||void 0===ae||ae.call(R,se,D))}),this.renderType===e.y2.Table&&this.element.addEventListener("change",function(D){var re,ae=d3.select(D.target).attr("checkbox-rowindex");null!=ae&&(null===(re=R.mainCellClickHandler)||void 0===re||re.call(R,void 0,void 0,+ae,R.section))}),null===(k=this.interactionHandler)||void 0===k||k.setTooltipDelegate(function(D){return R.getItemByElement(D.context)},this.element,this.getRegion.bind(this),!L,function(D){return R.shouldHideDefaultTooltip(D.context)})}return v.prototype.update=function(t,o,l,g){var f=this.rowHeightMeasureManager.getLastMeasuredIndex(),s=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=i._E.getVisibleRange(t.top,t.height,this.rowHeightMeasureManager,i.hw,f),u=i.sW.getVisibleRange(t.left,t.width,this.columnWidthMeasureManager,i.MN,s);if(this.section!==e.p0.Body||n){var S,b,p;switch(u||(u={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case e.p0.Header:S=[0,g.getHierarchyDepth()-1],b=this.rowHeightMeasureManager.getPageRows(),p=this.columnWidthMeasureManager.getPageColumns();break;case e.p0.Body:S=[n.firstLeafIndex,n.lastLeafIndex],b=this.rowHeightMeasureManager.getPageRows(),p=this.columnWidthMeasureManager.getPageColumns();break;case e.p0.Footer:S=[0,l.getFloatingHierarchyLeafCount()-1],b=[this.rowHeightMeasureManager.getFloatingPageRow()],p=this.columnWidthMeasureManager.getPageColumns();break;default:ee.fF.assertNever(this.section)}this.renderMeta={viewport:t,binder:o,rowNavigator:l,columnNavigator:g,visibleRowRange:S,visibleColumnRange:[u.firstLeafIndex,u.lastLeafIndex],pageRows:b,pageColumns:p},this.updateRendering()}},v.prototype.setUnfrozenRowHeaders=function(t){this.unfrozenRowHeaders=t},v.prototype.setRepeatRowHeaders=function(t){this.repeatRowHeaders=t},v.prototype.setRowWidth=function(){var t=this.rowLevelWidthMeasureManager.getHeadersWidth(),o=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(o+=t),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",o+"px")},v.prototype.updateBodyLeft=function(){var t=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",t+"px")},v.prototype.shouldHideDefaultTooltip=function(t){var l=c.M.getFirstMatchingAncestor(t,function(n){return n.matches(".prefix-cell")||n.matches(".main-cell")},this.element,!0);if(!l)return!0;var f,g=d3.select(l);return!g.select(".tablixUrlIconGlyph").node()&&(!(f=g.classed("pivotTableCellWrap")||g.classed("pivotTableCellNoWrap")?g.node():g.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||f.scrollHeight===f.clientHeight&&f.scrollWidth===f.clientWidth)},v.prototype.updateMeasureManagers=function(t,o,l,g,f){this.rowHeaderType=t,this.rowHeightMeasureManager=o,this.columnWidthMeasureManager=l,this.rowLevelWidthMeasureManager=g,this.columnLevelHeightMeasureManager=f},v.prototype.scrollToX=function(t){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-t+"px"),this.xPosition=t},v.prototype.onColumnResize=function(){var t=this;d3.select(this.element).selectAll(".row").each(function(){var o=t.getRowIndex(this),l=t.getRowHeight(o),g=t.getRowTop(o);d3.select(this).style("height",l+"px").style("top",g+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var o=t.getRowIndex(this),l=t.getColumnIndex(this),g=t.isFillerCell(this),f=g?0:t.getPrefixCellHeight(o,l),s=g?0:t.getPrefixCellWidth(o,l),n=t.getPrefixCellLeft(o,l),u=parseFloat(d3.select(this).style("--padding-left")),S=parseFloat(d3.select(this).style("--padding-right")),b=t.getAdjustedPaddings(s,u,S),p=b[0],m=b[1];d3.select(this).style("height",f+"px").style("width",s+"px").style("left",n+"px").style("padding-left",p+"px").style("padding-right",m+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var o=t.getRowIndex(this),l=t.getColumnIndex(this),g=t.getMainCellHeight(o,l),f=t.getMainCellWidth(o,l),s=t.getMainCellLeft(o,l),n=parseFloat(d3.select(this).style("--padding-left")),u=parseFloat(d3.select(this).style("--padding-right")),S=t.getAdjustedPaddings(f,n,u),b=S[0],p=S[1];d3.select(this).style("height",g+"px").style("width",f+"px").style("left",s+"px").style("padding-left",b+"px").style("padding-right",p+"px")}),this.adjustHeaders()},v.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},v.prototype.getElementByIndex=function(t,o,l){var g=l===e.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(t,'"] ').concat(g,'[column-index="').concat(o,'"]')).node()},v.prototype.getItemByElement=function(t){if(this.isRenderStable()){var o=this.getRowIndex(t);if(null!=o){var l=this.getColumnIndex(t);if(null!=l){var g=this.isPrefixCell(t);return this.getCellItem(o,l,g)}}}},v.prototype.updateRendering=function(){var t=this,o=[],l=[];this.clearUnusedElements(),this.setGroupLocations(o,l),o.forEach(function(g){return t.insertRowGroup(g)}),l.forEach(function(g){return t.insertCellGroup(g)}),this.scrollToX(this.xPosition),this.adjustHeaders()},v.prototype.clearUnusedElements=function(){var t=this;for(var o in this.viewSync)if(+o<this.renderMeta.visibleRowRange[0]||+o>this.renderMeta.visibleRowRange[1])delete this.viewSync[o];else for(var l in this.viewSync[o])+l>=0&&(+l<this.renderMeta.visibleColumnRange[0]||+l>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[o][l];d3.select(this.element).selectAll(".row").filter(function(){var g=t.getRowIndex(this);return g<t.renderMeta.visibleRowRange[0]||g>t.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var g=t.getColumnIndex(this);return g<t.renderMeta.visibleColumnRange[0]||g>t.renderMeta.visibleColumnRange[1]}).remove()},v.prototype.setGroupLocations=function(t,o){for(var l,g=this.renderMeta.visibleRowRange[0];g<=this.renderMeta.visibleRowRange[1];g++)if(this.viewSync[g]){l=!1;var s=void 0;this.viewSync[g][-1]||o.push({rowIndex:g,columnStart:-1,columnEnd:-1});for(var f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[g][f]?s=!1:(s?_.last(o).columnEnd++:(o.push({rowIndex:g,columnStart:f,columnEnd:f}),s=!0),this.viewSync[g][f]=!0)}else for(l?_.last(t).rowEnd++:(t.push({rowStart:g,rowEnd:g}),l=!0),this.viewSync[g]={"-1":!0},f=this.renderMeta.visibleColumnRange[0];f<=this.renderMeta.visibleColumnRange[1];f++)this.viewSync[g][f]=!0},v.prototype.insertRowGroup=function(t){for(var l,o=this,g=d3.select(this.element).selectAll(".row").nodes(),f=g.length-1;f>=0;f--){ee.fF.assert(function(){return o.section===e.p0.Body},"header and footer should never insert additional row groups");var s=this.getRowIndex(g[f]);if(t.rowStart>s){l=g[f];break}}var u,n=this.getRowGroupBindings(t.rowStart,t.rowEnd);l?(l.insertAdjacentHTML("afterend",w.bG.buildMultiple(n)),u=l.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",w.bG.buildMultiple(n)),u=_.first(this.element.children)),w.bG.attachEventHandlersMultiple(u,n)},v.prototype.insertCellGroup=function(t){var o;ee.fF.assert(function(){return-1!==t.columnStart},"cell group insertion of prefix cells is not supported");for(var g=d3.select(this.element).select('[row-index="'.concat(t.rowIndex,'"]')).select(".scrollable-cells-container"),f=g.node(),s=g.selectAll(".prefix-cell").nodes(),n=g.selectAll(".main-cell").nodes(),u=n.length-1;u>=0;u--){var S=this.getColumnIndex(n[u]);if(t.columnStart>S){o=n[u];break}}!o&&!_.isEmpty(s)&&(o=_.last(s));var p,b=this.getMainBindings(t.rowIndex,t.columnStart,t.columnEnd);o?(o.insertAdjacentHTML("afterend",w.bG.buildMultiple(b)),p=o.nextElementSibling):(f.insertAdjacentHTML("afterbegin",w.bG.buildMultiple(b)),p=_.first(f.children)),w.bG.attachEventHandlersMultiple(p,b)},v.prototype.getRowGroupBindings=function(t,o){for(var l,g=[],f=t;f<=o;f++){var s=this.getRowHeight(f),n=this.getRowTop(f),u=!1,S=0;this.renderMeta.binder.blankRowsEnabled()&&(u=this.renderMeta.rowNavigator.isBlankRow(f),S=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(f));var b={classNames:["row"],attributes:{role:"row","row-index":f.toString()},styleProperties:{position:"absolute",height:s+"px",width:"100%",top:n+"px","pointer-events":"none"},children:[]};u?b.attributes["aria-hidden"]="true":b.attributes["aria-rowindex"]=(this.getAriaRowIndex(f)-S).toString();var p=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),m=this.columnWidthMeasureManager.getColumnsWidth(),L=this.getPrefixBindings(f),R=this.getMainBindings(f,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===e.y2.Matrix&&(l=b.children).push.apply(l,L);var D={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:p+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:m+"px"},children:this.unfrozenRowHeaders||this.renderType===e.y2.Table?(0,B.__spreadArray)((0,B.__spreadArray)([],L,!0),R,!0):R}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===e.y2.Matrix&&(D.attributes[I.oy]=(0).toString()),b.children.push(D),g.push(b)}return g},v.prototype.getPrefixBindings=function(t){for(var o=[],l=this.renderMeta.rowNavigator.getHierarchyDepth(),g=0;g<l;g++){var f=this.getPrefixCellBinding(t,g);o.push(f)}return o},v.prototype.getMainBindings=function(t,o,l){for(var g=[],f=o;f<=l;f++){var s=this.getMainCellBinding(t,f);g.push(s)}return g},v.prototype.adjustCellBindingPadding=function(t,o){var l=parseFloat(t.styleProperties["padding-left"]),g=parseFloat(t.styleProperties["padding-right"]);isNaN(l)&&(l=0),isNaN(g)&&(g=0);var f=this.getAdjustedPaddings(o,l,g),n=f[1];t.styleProperties["padding-left"]=f[0]+"px",t.styleProperties["padding-right"]=n+"px",t.styleProperties["--padding-left"]=l.toString(),t.styleProperties["--padding-right"]=g.toString()},v.prototype.getAdjustedPaddings=function(t,o,l){var g=Math.max(t-o,0),f=Math.min(l,g);return[Math.min(o,t),f]},v.prototype.getRowIndex=function(t){var l=c.M.getFirstMatchingAncestor(t,function(f){return f.matches("[row-index]")},this.element,!0);return l&&+l.getAttribute("row-index")},v.prototype.getColumnIndex=function(t){var l=c.M.getFirstMatchingAncestor(t,function(f){return f.matches("[column-index]")},this.element,!0);return l&&+l.getAttribute("column-index")},v.prototype.isPrefixCell=function(t){return!!c.M.getFirstMatchingAncestor(t,function(f){return f.matches(".prefix-cell")},this.element,!0)},v.prototype.getRegion=function(t){return this.isPrefixCell(t)?e.aP.Prefix:e.aP.Main},v.prototype.isFillerCell=function(t){return!!c.M.getFirstMatchingAncestor(t,function(f){return f.matches(".filler-cell")},this.element,!0)},v.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},v.prototype.getAriaColIndex=function(t,o){return o?t+1:t+1+this.renderMeta.rowNavigator.getHierarchyDepth()},v.prototype.getColumnWidth=function(t,o){return o?this.rowLevelWidthMeasureManager.getLevelWidth(t):this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(t,i.MN)].getColumnWidths()[t%i.MN]},v.prototype.getColumnLeft=function(t,o){if(o)return this.rowLevelWidthMeasureManager.getLevelLeft(t);var g=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(t,i.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(g)+_.sum(g.getColumnWidths().slice(0,t%i.MN))},v}(),V=function(v){function t(){return null!==v&&v.apply(this,arguments)||this}return(0,B.__extends)(t,v),t.prototype.setResizeHandlers=function(o,l){this.columnWidthResizeHandler=o,this.rowLevelWidthResizeHandler=l},t.prototype.adjustHeaders=function(){var o=this;for(var l in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var n=o.getRowIndex(this),u=o.getColumnIndex(this),S=o.getMainCellWidth(n,u),b=u===o.renderMeta.visibleColumnRange[0],p=d3.select(this).classed("secondary-columnheader")&&!b;if(d3.select(this).classed("visually-hidden",p),b&&!d3.select(this).classed("last-secondary-columnheader")){var m=o.getColumnHeaderOffset(u),L=S-m;d3.select(this).style("transform","translateX(".concat(m,"px)")),d3.select(this).style("width",L+"px")}else p||(d3.select(this).style("transform",null),d3.select(this).style("width",S+"px"))}),this.viewSync)for(var g in this.viewSync[l])if("resizable"!==this.viewSync[l][g]){if("-1"===g)d3.select(this.element).select('[row-index="'.concat(l,'"]')).selectAll(".prefix-cell").each(function(){if(!o.isFillerCell(this)){var n=o.getItemByElement(this);new M(n,this,o.rowLevelWidthResizeHandler,null,o.prefixCellClickHandler,!0)}});else{var f=this.getElementByIndex(l,g,e.aP.Main);if(!this.isFillerCell(f)){var s=this.getItemByElement(f);new M(s,f,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[l][g]="resizable"}},t.prototype.getPrefixCellBinding=function(o,l){var g=l,f=o,s=this.rowLevelWidthMeasureManager.getLevelLeft(g),n=this.columnLevelHeightMeasureManager.getLevelHeight(f),u=this.rowLevelWidthMeasureManager.getLevelWidth(g),S=this.renderMeta.rowNavigator.getCorner(g,f),b=this.renderMeta.binder.getCornerCellBinding(S,!1,!0,this.onObject,u);return b.classNames||(b.classNames=[]),b.attributes||(b.attributes={}),b.styleProperties||(b.styleProperties={}),b.classNames.push("prefix-cell"),b.attributes.role="columnheader",b.attributes["column-index"]=l.toString(),b.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),null==b.attributes.tabindex&&(b.attributes.tabindex="0"),b.styleProperties.position="absolute",b.styleProperties.left=s+"px",b.styleProperties.height=n+"px",b.styleProperties.width=u+"px",b.styleProperties["box-sizing"]="border-box",b.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(b,u),b},t.prototype.getMainCellBinding=function(o,l){var g=o,s=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(l,i.MN)],S=this.columnWidthMeasureManager.getPageColumnLeft(s)+_.sum(s.getColumnWidths().slice(0,l%i.MN));this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var b=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),p=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(b,g,!0);if(!p)return{attributes:{role:"columnheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:S+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var R,L=this.renderMeta.columnNavigator.getHierarchyLeafAt(l+1);L&&(R=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(L,g,!0)),R===p&&(R=void 0);var k=this.getMainCellHeight(o,l),D=this.getMainCellWidth(o,l),re=this.renderMeta.binder.getColumnHeaderBinding(p,!1,!0,this.onObject,R,D),ae=this.renderMeta.columnNavigator.isLeaf(p),he=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(p),se=this.renderMeta.columnNavigator.getNodeLeafCount(p)-(l-he),Y=!ae&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(p)===l,ue=!ae&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(p)!==l,ve=ue&&1===se;return re.classNames||(re.classNames=[]),re.attributes||(re.attributes={}),re.styleProperties||(re.styleProperties={}),re.classNames.push("main-cell"),Y&&re.classNames.push("primary-columnheader"),ue&&re.classNames.push("secondary-columnheader"),ve&&re.classNames.push("last-secondary-columnheader"),re.attributes.role="columnheader",re.attributes["column-index"]=l.toString(),re.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),re.attributes.tabindex="0",re.styleProperties.position="absolute",re.styleProperties.left=S+"px",re.styleProperties.width=D+"px",re.styleProperties.height=k+"px",re.styleProperties["box-sizing"]="border-box",re.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(re,D),re},t.prototype.getAriaRowIndex=function(o){return o+1},t.prototype.getRowHeight=function(o){return this.columnLevelHeightMeasureManager.getLevelHeight(o)},t.prototype.getRowTop=function(o){return this.columnLevelHeightMeasureManager.getLevelTop(o)},t.prototype.getPrefixCellWidth=function(o,l){return this.rowLevelWidthMeasureManager.getLevelWidth(l)},t.prototype.getPrefixCellHeight=function(o,l){return this.columnLevelHeightMeasureManager.getLevelHeight(o)},t.prototype.getPrefixCellLeft=function(o,l){return this.rowLevelWidthMeasureManager.getLevelLeft(l)},t.prototype.getMainCellWidth=function(o,l){var g=this,f=o,s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(s,f),u=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(n),S=this.renderMeta.columnNavigator.getNodeLeafCount(n)-(l-u),b=this.columnWidthMeasureManager.getLastMeasuredIndex(),p=Math.min(l+S-1,b);return _.sum(_.range(l,p+1).map(function(m){return g.columnWidthMeasureManager.getColumnWidth(m)}))},t.prototype.getMainCellHeight=function(o,l){var g=this,f=o,s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(s,f),u=(0,Q.zG)(n,this.renderMeta.columnNavigator);return _.sum(_.range(o,f+u-1+1).map(function(b){return g.columnLevelHeightMeasureManager.getLevelHeight(b)}))},t.prototype.getMainCellLeft=function(o,l){var f=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(l,i.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(f)+_.sum(f.getColumnWidths().slice(0,l%i.MN))},t.prototype.getCellItem=function(o,l,g){if(g)return this.renderMeta.rowNavigator.getCorner(l,o);var n=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(n,o)},t.prototype.getColumnHeaderOffset=function(o){return this.renderMeta.viewport.left-this.getColumnLeft(o,!1)},t}(d),Z=function(v){function t(){return null!==v&&v.apply(this,arguments)||this}return(0,B.__extends)(t,v),t.prototype.scrollToY=function(o){this.element.style.top=-o+"px"},t.prototype.adjustHeaders=function(){if(this.rowHeaderType!==e.xU.Stepped&&!this.repeatRowHeaders){var o=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var l=o.getRowIndex(this),g=o.getColumnIndex(this),f=o.getPrefixCellHeight(l,g),s=l===o.renderMeta.visibleRowRange[0],n=d3.select(this).classed("secondary-rowheader")&&!s;if(d3.select(this).classed("visually-hidden",n),s&&!d3.select(this).classed("last-secondary-rowheader")){var u=o.getRowHeaderOffset(l),S=f-u;d3.select(this).style("transform","translateY(".concat(u,"px)")),d3.select(this).style("height",S+"px")}else n||(d3.select(this).style("transform",null),d3.select(this).style("height",f+"px"))})}},t.prototype.getPrefixCellBinding=function(o,l){var u,g=l,f=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),s=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(f,g,!0),n=this.rowLevelWidthMeasureManager.getLevelLeft(g);if(!s)return{attributes:{role:"rowheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:n+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===e.y2.Table){var S=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),b=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());u=b?this.renderMeta.rowNavigator.getIntersection(S,b):void 0}var m,p=this.renderMeta.rowNavigator.getHierarchyLeafAt(o+1);p&&(m=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(p,g,!0)),m===s&&(m=void 0);var L=this.getPrefixCellWidth(o,l),R=this.getPrefixCellHeight(o,l),k=this.renderMeta.rowNavigator.isLeaf(s),D=this.rowHeaderType===e.xU.Stepped,re=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s),ae=this.renderMeta.rowNavigator.getNodeLeafCount(s)-(o-re),he=!k&&!D&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s)===o,se=!k&&!D&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s)!==o,Y=se&&1===ae,ue=this.renderType===e.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():L,ve=ue+"px",Ce=this.renderMeta.binder.getRowHeaderBinding(s,!1,this.onObject,!1,u,m,ue,this.repeatRowHeaders?f:void 0,se);if(Ce.classNames||(Ce.classNames=[]),Ce.attributes||(Ce.attributes={}),Ce.styleProperties||(Ce.styleProperties={}),Ce.classNames.push("prefix-cell"),he&&Ce.classNames.push("primary-rowheader"),se&&Ce.classNames.push("secondary-rowheader"),Y&&Ce.classNames.push("last-secondary-rowheader"),Ce.attributes["column-index"]=l.toString(),Ce.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),Ce.attributes.tabindex="0",Ce.styleProperties.position="absolute",Ce.styleProperties.left=n+"px",Ce.styleProperties.height=R+"px",Ce.styleProperties.width=ve,Ce.styleProperties["box-sizing"]="border-box",Ce.styleProperties["pointer-events"]=this.renderType===e.y2.Table?"none":"auto",this.renderType===e.y2.Table){var x=s===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),a=this.renderMeta.rowNavigator.isLastItem(s,this.renderMeta.rowNavigator.getHierarchyItems()),P=this.renderMeta.binder.getBorderInfo(x,a,!0,!0,!0,e.p0.Body);Ce.styleProperties["--outline-top"]=P.weightTop+1+"px",Ce.styleProperties["--outline-right"]=P.weightRight+1+"px",Ce.styleProperties["--outline-bottom"]=P.weightBottom+1+"px",Ce.styleProperties["--outline-left"]=P.weightLeft+1+"px",Ce.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(Ce,L),Ce},t.prototype.getMainCellBinding=function(o,l){var g=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),s=this.renderMeta.rowNavigator.getIntersection(g,f),n=this.getRowHeight(o),u=this.getColumnWidth(l,!1),S=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var b=this.renderMeta.rowNavigator.getHierarchyLeafAt(o+1),p=b&&this.renderMeta.rowNavigator.getIntersection(b,f),m=this.renderMeta.binder.getBodyCellBinding(s,!1,n,u,!0,this.onObject,p,this.showTotalPlaceHolders);return m.classNames||(m.classNames=[]),m.attributes||(m.attributes={}),m.styleProperties||(m.styleProperties={}),m.classNames.push("main-cell"),m.attributes.role="gridcell",m.attributes["column-index"]=l.toString(),m.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),m.attributes.tabindex="0",m.styleProperties.position="absolute",m.styleProperties["box-sizing"]="border-box",m.styleProperties.height="100%",m.styleProperties.width=u+"px",m.styleProperties.left=S+"px",m.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(m,u),m},t.prototype.getAriaRowIndex=function(o){return o+1+this.renderMeta.columnNavigator.getHierarchyDepth()},t.prototype.getRowHeight=function(o){return this.rowHeightMeasureManager.getPageRows()[i.yl.getPageIndex(o,i.hw)].getRowHeights()[o%i.hw]},t.prototype.getRowTop=function(o){var g=this.rowHeightMeasureManager.getPageRows()[i.yl.getPageIndex(o,i.hw)];return this.rowHeightMeasureManager.getPageRowTop(g)+_.sum(g.getRowHeights().slice(0,o%i.hw))},t.prototype.getPrefixCellWidth=function(o,l){var g=this;if(this.rowHeaderType===e.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var f=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,f),u=(0,Q.zG)(n,this.renderMeta.rowNavigator);return _.sum(_.range(f,f+u-1+1).map(function(b){return g.rowLevelWidthMeasureManager.getLevelWidth(b)}))},t.prototype.getPrefixCellHeight=function(o,l){var g=this;if(this.renderType===e.y2.Table||this.rowHeaderType===e.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(o);var f=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,f),u=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(n),S=this.renderMeta.rowNavigator.getNodeLeafCount(n)-(o-u),b=this.rowHeightMeasureManager.getLastMeasuredIndex(),p=Math.min(o+S-1,b);return _.sum(_.range(o,p+1).map(function(m){return g.rowHeightMeasureManager.getRowHeight(m)}))},t.prototype.getPrefixCellLeft=function(o,l){return this.getColumnLeft(l,!0)},t.prototype.getMainCellWidth=function(o,l){return this.getColumnWidth(l,!1)},t.prototype.getMainCellHeight=function(o,l){return this.getRowHeight(o)},t.prototype.getMainCellLeft=function(o,l){return this.getColumnLeft(l,!1)},t.prototype.getCellItem=function(o,l,g){if(g){var f=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(o);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,f)}var n=this.renderMeta.rowNavigator.getHierarchyLeafAt(o),u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(n,u)},t.prototype.getRowHeaderOffset=function(o){return this.renderMeta.viewport.top-this.getRowTop(o)},t}(d),K=function(v){function t(){return null!==v&&v.apply(this,arguments)||this}return(0,B.__extends)(t,v),t.prototype.adjustHeaders=function(){for(var g=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),f=0,s=d3.select(this.element).selectAll(".row").nodes().reverse();f<s.length;f++)d3.select(s[f]).attr("aria-rowindex",g--)},t.prototype.getPrefixCellBinding=function(o,l){var g=this.rowHeightMeasureManager.getFloatingRowHeight(o),f=this.rowLevelWidthMeasureManager.getHeadersWidth(),s=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(o),n=this.renderMeta.binder.getRowHeaderBinding(s,!1,this.onObject,!0,void 0,void 0,f);return n.classNames||(n.classNames=[]),n.attributes||(n.attributes={}),n.styleProperties||(n.styleProperties={}),n.classNames.push("prefix-cell"),n.attributes.role="rowheader",n.attributes["column-index"]=l.toString(),n.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),n.attributes.tabindex="0",n.styleProperties.position="absolute",n.styleProperties.left="0",n.styleProperties.height=g+"px",n.styleProperties.width=f+"px",n.styleProperties["box-sizing"]="border-box",n.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(n,f),n},t.prototype.getMainCellBinding=function(o,l){var g=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(o),f=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),s=this.renderMeta.rowNavigator.getIntersection(g,f),n=this.getRowHeight(o),u=this.getColumnWidth(l,!1),S=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var b=this.renderMeta.binder.getBodyCellBinding(s,!1,n,u,!0,this.onObject,void 0,this.showTotalPlaceHolders);return b.classNames||(b.classNames=[]),b.attributes||(b.attributes={}),b.styleProperties||(b.styleProperties={}),b.classNames.push("main-cell"),b.attributes.role="gridcell",b.attributes["column-index"]=l.toString(),b.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),b.attributes.tabindex="0",b.styleProperties.position="absolute",b.styleProperties["box-sizing"]="border-box",b.styleProperties.height="100%",b.styleProperties.width=u+"px",b.styleProperties.left=S+"px",b.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(b,u),b},t.prototype.getAriaRowIndex=function(o){return-1},t.prototype.getRowHeight=function(o){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[o]},t.prototype.getRowTop=function(o){var l=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(l)+_.sum(l.getRowHeights().slice(0,o))},t.prototype.getPrefixCellWidth=function(o,l){return this.rowLevelWidthMeasureManager.getHeadersWidth()},t.prototype.getPrefixCellHeight=function(o,l){return this.rowHeightMeasureManager.getFloatingRowHeight(o)},t.prototype.getPrefixCellLeft=function(o,l){return 0},t.prototype.getMainCellWidth=function(o,l){return this.getColumnWidth(l,!1)},t.prototype.getMainCellHeight=function(o,l){return this.getRowHeight(o)},t.prototype.getMainCellLeft=function(o,l){return this.getColumnLeft(l,!1)},t.prototype.getCellItem=function(o,l,g){if(g)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(o);var f=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(o),s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(f,s)},t}(d),W=function(v){return v[v.Default=0]="Default",v[v.ColumnResizing=1]="ColumnResizing",v[v.RowLevelResizing=2]="RowLevelResizing",v}({}),te=function(){function v(t,o,l,g,f,s,n,u,S,b,p,m,L,R,k){var D=this;this.hostServices=u,this.visualStyle=S,this.showTotalPlaceHolders=L,this.subSelectionHelper=R,this.showAsTableNativeMenu=k,this.unfrozenRowHeaders=!1,this.isA11yTable=g,this.isA11yMatrix=f,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=s,this.enableCalculationHighlighting=n,this.sizeManager=o,this.scrollingEnabled=l.scrollingEnabled;var re=u.getLocalizedString(O.iC),ae=u.getLocalizedString(O.Hw),he=u.getLocalizedString(O.dm),se=u.getLocalizedString(O.Ds),Y=m?"interactive-grid":"",ue="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(re,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(ae,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(he,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(se,"</button>\n                    <div role='grid' class='").concat(Y," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");t.insertAdjacentHTML("beforeend",ue),this.element=t.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(I.oy,(0).toString()),this.midViewport.setAttribute(I.oy,(0).toString()),this.botViewport.setAttribute(I.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var ve,be;null===(ve=D.rowScrollbar)||void 0===ve||ve.scrollPageUp();var Ce=D.getViewport(),x=i._E.getVisibleRange(Ce.top,Ce.height,D.rowHeightMeasureManager,i.hw,null===(be=D.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());b(x.firstLeafIndex,x.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var ve,be;null===(ve=D.rowScrollbar)||void 0===ve||ve.scrollPageDown();var Ce=D.getViewport(),x=i._E.getVisibleRange(Ce.top,Ce.height,D.rowHeightMeasureManager,i.hw,null===(be=D.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());b(x.firstLeafIndex,x.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var ve,be;null===(ve=D.columnScrollbar)||void 0===ve||ve.scrollPageUp();var Ce=D.getViewport(),x=i.sW.getVisibleRange(Ce.left,Ce.width,D.columnWidthMeasureManager,i.MN,null===(be=D.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());p(x.firstLeafIndex,x.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var ve,be;null===(ve=D.columnScrollbar)||void 0===ve||ve.scrollPageDown();var Ce=D.getViewport(),x=i.sW.getVisibleRange(Ce.left,Ce.width,D.columnWidthMeasureManager,i.MN,null===(be=D.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());p(x.firstLeafIndex,x.lastLeafIndex)}),this.options=l,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(ve){return D.onClick(ve)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new U(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new H(this,!0)),$(this.element).on(fe.BZ,function(){return D.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(ve){return D.onKeyDown(ve)}),this.keyUpState=W.Default,this.element.addEventListener("keyup",function(){return D.onKeyUp()}),this.focusManager=new y(function(){return D.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),l.scrollingEnabled&&this.attachScrollEventHandlers()}return v.prototype.onShowTotalPlaceHoldersChanged=function(t){t!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=t,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=t),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=t),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=t))},v.prototype.updateOptions=function(t){this.options=t},v.prototype.attachScrollEventHandlers=function(){var t=this;F.l.runOutsideAngular(function(){t.midViewport.style.overflowY="auto",t.midViewport.addEventListener("scroll",function(){return t.scrollTo(null,t.midViewport.scrollTop)}),t.innerContainer.addEventListener("wheel",function(o){var l;performance.now()-t.prevHorizontalWheelTime>100&&(t.propagateWheel=void 0),clearInterval(t.momentumScrollHandle);var g=!o.shiftKey&&Math.abs(o.deltaX)<=Math.abs(o.deltaY);if(!t.propagateWheel&&!g){var f=o.shiftKey&&Math.abs(o.deltaX)<=Math.abs(o.deltaY)?o.deltaY:o.deltaX,s=Math.max(Math.min(f,v.ScrollDeltaMax),-v.ScrollDeltaMax),n=t.scrollBy(s,0);null!==(l=t.propagateWheel)&&void 0!==l||(t.propagateWheel=!n),t.propagateWheel||(o.stopPropagation(),o.preventDefault()),t.prevHorizontalWheelTime=performance.now()}}),t.innerContainer.addEventListener("touchstart",function(o){clearInterval(t.momentumScrollHandle),t.propagateTouch=o.touches.length>1||void 0,t.touchPreviousX=o.touches[0].clientX,t.touchPreviousY=o.touches[0].clientY}),t.innerContainer.addEventListener("touchmove",function(o){var l,g;if(!t.propagateTouch){var f=t.touchPreviousX-o.touches[0].clientX,s=t.touchPreviousY-o.touches[0].clientY;if(null!==(l=t.propagateTouch)&&void 0!==l||(t.propagateTouch=0===f||Math.abs(f)<=Math.abs(s)||void 0),!t.propagateTouch){t.touchDeltaX=Math.max(Math.min(f,v.ScrollDeltaMax),-v.ScrollDeltaMax),t.touchPreviousX=o.touches[0].clientX,t.touchPreviousY=o.touches[0].clientY;var n=t.scrollBy(t.touchDeltaX,0);null!==(g=t.propagateTouch)&&void 0!==g||(t.propagateTouch=!n),t.propagateTouch||(o.stopPropagation(),o.preventDefault())}}}),t.innerContainer.addEventListener("touchend",function(){if(!t.propagateTouch){var o=t.renderIteration;t.momentumScrollHandle=setInterval(function(l){l[0]+=1/120;var g=t.touchDeltaX*(1-d3.easeCircleOut(l[0]));o!==t.renderIteration||l[0]>=120||Math.abs(g)<1?clearInterval(t.momentumScrollHandle):t.scrollBy(g,0)},1e3/60,[0])}})})},v.prototype.onFocusManagerEnter=function(){var t;null===(t=this.hostServices.telemetry())||void 0===t||t.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},v.prototype.onKeyUp=function(){switch(this.keyUpState){case W.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=W.Default;break;case W.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=W.Default;break;case W.Default:break;default:ee.fF.assertNever(this.keyUpState)}},v.prototype.onKeyDown=function(t){var o=this;if(this.renderLock||this.keyboardLock)return t.stopPropagation(),void t.preventDefault();this.updateFocus();var l=t.code||t.key,g=t.shiftKey,f=oe.M.isCtrlOrMeta(t),s=t.altKey,n=this.isA11yTable,u=this.isA11yMatrix;if("Escape"!==l&&"Esc"!==l&&"Tab"!==l){if("ArrowRight"===l||"Right"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){if(g){if(o.focusManager.CurrentFocus.columnHeader&&o.columnWidthResizeHandler)return o.columnWidthResizeHandler.onStartResize(o.focusManager.CurrentFocus.item),o.columnWidthResizeHandler.onResize({x:1,y:0}),void(o.keyUpState=W.ColumnResizing);if(o.focusManager.CurrentFocus.cornerCell&&o.columnWidthResizeHandler)return o.rowLevelWidthResizeHandler.onStartResize(o.focusManager.CurrentFocus.item),o.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(o.keyUpState=W.RowLevelResizing);o.options.rowHeaderExpandCollapseHandler&&o.focusManager.CurrentFocus.rowHeader&&1===o.rowNavigator.getExpansionState(o.focusManager.CurrentFocus.item)&&o.options.rowHeaderExpandCollapseHandler(o.focusManager.CurrentFocus.item,!1)}else o.focusManager.moveFocus("right",f,n,u)});if("ArrowLeft"===l||"Left"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){if(g){if(o.focusManager.CurrentFocus.columnHeader&&o.columnWidthResizeHandler)return o.columnWidthResizeHandler.onStartResize(o.focusManager.CurrentFocus.item),o.columnWidthResizeHandler.onResize({x:-1,y:0}),void(o.keyUpState=W.ColumnResizing);if(o.focusManager.CurrentFocus.cornerCell&&o.columnWidthResizeHandler)return o.rowLevelWidthResizeHandler.onStartResize(o.focusManager.CurrentFocus.item),o.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(o.keyUpState=W.RowLevelResizing);o.options.rowHeaderExpandCollapseHandler&&o.focusManager.CurrentFocus.rowHeader&&0===o.rowNavigator.getExpansionState(o.focusManager.CurrentFocus.item)&&o.options.rowHeaderExpandCollapseHandler(o.focusManager.CurrentFocus.item,!0)}else o.focusManager.moveFocus("left",f,n,u)});if("ArrowUp"===l||"Up"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){if(g&&!f){if(n){var S=o.focusManager.CurrentFocus;o.focusManager.moveFocus("up",f,n,u);var b=o.focusManager.CurrentFocus;o.selectFocus(t,S),o.selectFocus(t,b)}}else o.focusManager.moveFocus("up",f,n,u)});if("ArrowDown"===l||"Down"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){if(g&&!f){if(n){var S=o.focusManager.CurrentFocus;o.focusManager.moveFocus("down",f,n,u);var b=o.focusManager.CurrentFocus;o.selectFocus(t,S),o.selectFocus(t,b)}}else o.focusManager.moveFocus("down",f,n,u)});if("Home"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){o.focusManager.moveFocus("home",f,n,u)});if("End"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){o.focusManager.moveFocus("end",f,n,u)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){o.focusManager.moveFocus("pagedown",f,n,u,o.getNumberOfVisibleRows())});if("PageUp"===l)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){o.focusManager.moveFocus("pageup",f,n,u,o.getNumberOfVisibleRows())})}if("F10"===l&&g)return f?void 0:(t.preventDefault(),t.stopPropagation(),this.runIfFrameReady(function(){o.showContextMenuForFocus(t)}));if("Enter"===l||"Space"===l||"Spacebar"===l||" "===l)return t.preventDefault(),t.stopPropagation(),this.runIfFrameReady(function(){o.selectFocus(t,o.focusManager.CurrentFocus)});if("KeyO"===l&&f&&s)return t.preventDefault(),t.stopPropagation(),this.runIfFrameReady(function(){o.activateCellContent()});if(("KeyC"===l||"c"===l)&&f&&g)return t.stopPropagation(),t.preventDefault(),this.runIfFrameReady(function(){o.options.whitespaceClickHandler(null,!0)})}},v.prototype.runIfFrameReady=function(t){return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(o){switch(o.label){case 0:return this.keyboardLock=!0,t(),[4,this.requestAnimationFrameAsync()];case 1:return o.sent(),this.keyboardLock=!1,[2]}})})},v.prototype.notifyVisual=function(t){t.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(t.item,t.bodyCell.rowIndex):t.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(t.item):t.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(t.item):t.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(t.item):t.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(t.item):void 0!==t.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(t.item)},v.prototype.setUnfrozenRowHeaders=function(t){this.unfrozenRowHeaders=t,this.topRenderer.setUnfrozenRowHeaders(t),this.midRenderer.setUnfrozenRowHeaders(t),this.botRenderer.setUnfrozenRowHeaders(t)},v.prototype.setRepeatRowHeaders=function(t){this.topRenderer.setRepeatRowHeaders(t),this.midRenderer.setRepeatRowHeaders(t),this.botRenderer.setRepeatRowHeaders(t)},v.prototype.onFocusChanged=function(){var t,o=this.focusManager.CurrentFocus;ee.fF.assertValue(o,"No current focus"),this.notifyVisual(o);var g,f,s,n,u,S,ae,he,l=this.getViewport();if(o.bodyCell)o.bodyCell.columnIndex>=0&&(n=o.bodyCell.columnIndex),g=o.bodyCell.rowIndex;else if(o.rowHeader){var b=i._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager),p=(0,Q.hG)(o.item,this.rowNavigator),m=(0,Q.O3)(o.item,this.rowNavigator);p<=b.firstLeafIndex||m-p+1>=b.lastLeafIndex-b.firstLeafIndex+1?(g=p,f=!1):(g=Math.min(m,this.rowHeightMeasureManager.getLastMeasuredIndex()),f=!0)}else if(o.columnHeader){var k=i.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager);p=(0,Q.hG)(o.item,this.columnNavigator),m=(0,Q.O3)(o.item,this.columnNavigator),p<=k.firstLeafIndex||m-p+1>=k.lastLeafIndex-k.firstLeafIndex+1?(n=p,S=!1):(n=Math.min(m,this.columnWidthMeasureManager.getLastMeasuredIndex()),S=!0)}else o.floatingBodyCell&&(n=o.floatingBodyCell.columnIndex);if(void 0!==g&&this.rowScrollbar.visible&&(b=i._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager))&&(g<=b.firstLeafIndex?s={rowIndex:g,visibleHeight:Number.MAX_VALUE,alignBottom:f??!1}:g>=b.lastLeafIndex&&(s={rowIndex:g,visibleHeight:Number.MAX_VALUE,alignBottom:f??!0})),void 0!==n&&this.columnScrollbar.visible&&(k=i.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager))&&(n<=k.firstLeafIndex?u=this.unfrozenRowHeaders&&0===n&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:S??!1}:n>=k.lastLeafIndex&&(u={columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:S??!0})),s&&(ae=i._E.getOffset(s,this.rowHeightMeasureManager),s.alignBottom&&(ae-=this.rowScrollbar.viewSize)),u&&(he=i.sW.getOffset(u,this.columnWidthMeasureManager),u.alignRight&&(he-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(he+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(o.cornerCell||o.rowHeader||o.floatingRowHeader)){var se=this.getFocusedCell(o),Y=se.offsetLeft,ue=se.offsetWidth;he=Y<this.columnScrollbar.viewMin||ue>this.columnScrollbar.viewSize?Y:Y+ue>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?Y-this.columnScrollbar.viewSize:null}this.scrollTo(he,ae),null===(t=this.getFocusedCell(o))||void 0===t||t.focus({preventScroll:!0})},v.prototype.getFocusedCell=function(t){var o,l;if(t.bodyCell)return-1===t.bodyCell.columnIndex?this.midRenderer.getElementByIndex(t.bodyCell.rowIndex,0,e.aP.Prefix):this.midRenderer.getElementByIndex(t.bodyCell.rowIndex,t.bodyCell.columnIndex,e.aP.Main);if(t.columnHeader){var g=t.item,f=this.columnNavigator.getLevel(g),s=void 0;return s=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(g):null!==(o=this.rowNavigator.getLeafIndex(g))&&void 0!==o?o:this.rowNavigator.getIndexOfFirstLeaf(g),this.topRenderer.getElementByIndex(f,s,e.aP.Main)}if(t.rowHeader){var n=t.item;return f=null!==(l=this.columnNavigator.getLeafIndex(n))&&void 0!==l?l:this.columnNavigator.getIndexOfFirstLeaf(n),s=this.steppedLayout?0:this.rowNavigator.getLevel(n),this.midRenderer.getElementByIndex(f,s,e.aP.Prefix)}return t.cornerCell?this.topRenderer.getElementByIndex(t.cornerCell.columnLevel,t.cornerCell.rowLevel,e.aP.Prefix):t.floatingBodyCell?this.botRenderer.getElementByIndex(t.floatingBodyCell.rowIndex,t.floatingBodyCell.columnIndex,e.aP.Main):null!=t.floatingRowHeader?this.botRenderer.getElementByIndex(t.floatingRowHeader,0,e.aP.Prefix):void ee.fF.assertFail("Unexpected focused item")},v.prototype.getCurrentFocusBoundingRect=function(){var t=document.activeElement;if(t){var o=t.getBoundingClientRect();return{top:o.top,left:o.left,width:o.width,height:o.height}}return{top:0,left:0,width:0,height:0}},v.prototype.selectFocus=function(t,o){var l=o.item,g=this.createMouseEvent(t);o.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,g,o.bodyCell.rowIndex,e.p0.Body):o.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,g,void 0,e.p0.Footer):o.rowHeader||void 0!==o.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(l,g):o.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(l,g):o.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(l,g):ee.fF.assertFail("Unexpected focused item")},v.prototype.activateCellContent=function(){var o=document.activeElement;if(o&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var l=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(o,l)}},v.prototype.createSimpleMouseClickEvent=function(){var t=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:t.left,clientY:t.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},v.prototype.createMouseEvent=function(t){var o=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:o.left,clientY:o.top,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,altKey:t.altKey})},v.prototype.showContextMenuForFocus=function(t){var o,l=this.focusManager.CurrentFocus;if(-1!==(null===(o=l.bodyCell)||void 0===o?void 0:o.columnIndex)){ee.fF.assertValue(l&&l.item,"Keyboard Selection triggered with no focused cell");var g=l.item,f=this.getCurrentFocusBoundingRect(),s=new MouseEvent("contextmenu",{clientX:f.left,clientY:f.top,ctrlKey:t.ctrlKey,metaKey:t.metaKey});l.bodyCell||l.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(g,s):l.rowHeader||void 0!==l.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(g,s):l.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(g,s):l.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(g,s):ee.fF.assertFail("Unexpected focused item")}},v.prototype.onClick=function(t){var o=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),l=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(o>=this.width&&l>=this.height)){var g=(0,T.ut)(this.element,t);(g.x>o||g.y>l)&&this.options.whitespaceClickHandler(t)}},v.prototype.initializeScrollbars=function(){var t=this;this.columnScrollbar=new E.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,C.S)(r.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(t.momentumScrollHandle),t.refresh()}),this.rowScrollbar=new E.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,C.S)(r.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(t.momentumScrollHandle),t.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},v.prototype.setSteppedLayout=function(t){if(t!==this.steppedLayout){this.steppedLayout=t;var o=t?e.xU.Stepped:e.xU.Blocked;this.columnWidthMeasureManager=new i.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new i.FA(this.measureElement,this.sizeManager):new i.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new i.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new i.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new i.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(o,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(o,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(o,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},v.prototype.createRenderers=function(){var t=this,o=this.isA11yTable?e.y2.Table:e.y2.Matrix;this.topRenderer=new V(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,e.p0.Header,o,this.onObject,this.enableCalculationHighlighting,function(){return!t.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new Z(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,e.p0.Body,o,this.onObject,this.enableCalculationHighlighting,function(){return!t.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new K(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,e.p0.Footer,o,this.onObject,this.enableCalculationHighlighting,function(){return!t.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},v.prototype.setWidth=function(t){this.width=t,this.element.style.width=(0,C.S)(this.width),this.columnScrollbar.invalidateArrange()},v.prototype.setHeight=function(t){this.height=t,this.element.style.height=(0,C.S)(this.height),this.rowScrollbar.invalidateArrange()},v.prototype.getWidth=function(){return this.width},v.prototype.getHeight=function(){return this.height},v.prototype.setClassName=function(t){this.element.className=t},v.prototype.setColumnNavigator=function(t){this.columnNavigator=t,this.focusManager.columnNavigator=t},v.prototype.setRowNavigator=function(t){this.rowNavigator=t,this.focusManager.rowNavigator=t},v.prototype.setBinder=function(t){this.binder=t},v.prototype.getSteppedLayout=function(){return this.steppedLayout},v.prototype.getColumnNavigator=function(){return this.columnNavigator},v.prototype.getRowNavigator=function(){return this.rowNavigator},v.prototype.getSizeManager=function(){return this.sizeManager},v.prototype.getBinder=function(){return this.binder},v.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},v.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},v.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},v.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},v.prototype.getTopRenderer=function(){return this.topRenderer},v.prototype.getMidRenderer=function(){return this.midRenderer},v.prototype.getBotRenderer=function(){return this.botRenderer},v.prototype.getViewport=function(){var t=this.columnScrollbar.viewMin,o=this.rowScrollbar.viewMin,l=this.columnScrollbar.viewSize,g=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(t=Math.max(t-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),l-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:t,top:o,width:l=Math.max(l,0),height:g=Math.max(g,0)}},v.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?r.zf:0)},v.prototype.storeFocus=function(){var o,l,g,f,t=document.activeElement;if(this.topViewport.contains(t))this.topRenderer.isPrefixCell(t)?(o=this.topRenderer.getRowIndex(t),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(t),g=e.p0.Header,f=e.aP.Prefix):(o=this.topRenderer.getRowIndex(t),l=this.topRenderer.getColumnIndex(t),g=e.p0.Header,f=e.aP.Main);else if(this.midViewport.contains(t))this.midRenderer.isPrefixCell(t)?(o=this.midRenderer.getRowIndex(t),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(t),g=e.p0.Body,f=e.aP.Prefix):(o=this.midRenderer.getRowIndex(t),l=this.midRenderer.getColumnIndex(t),g=e.p0.Body,f=e.aP.Main);else if(this.botViewport.contains(t))this.botRenderer.isPrefixCell(t)?(o=this.botRenderer.getRowIndex(t),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(t),g=e.p0.Footer,f=e.aP.Prefix):(o=this.botRenderer.getRowIndex(t),l=this.botRenderer.getColumnIndex(t),g=e.p0.Footer,f=e.aP.Main);else if(this.isA11yTable){var n=d3.select(this.topViewport).select(".main-cell").node();o=this.topRenderer.getRowIndex(n),l=this.topRenderer.getColumnIndex(n),g=e.p0.Header,f=e.aP.Main}else{var u=d3.select(this.topViewport).select(".prefix-cell").node();o=this.topRenderer.getRowIndex(u),l=this.topRenderer.getColumnIndex(u),g=e.p0.Header,f=e.aP.Prefix}this.tempFocus={rowIndex:o,columnIndex:l,section:g,region:f}},v.prototype.restoreFocus=function(){var o,t=this;ee.fF.assert(function(){return!!t.tempFocus},"tempFocus must be defined"),this.tempFocus.section===e.p0.Header?o=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===e.p0.Body?o=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,e.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===e.p0.Footer&&(o=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),o||(this.updateFocus(),o=this.getFocusedCell(this.focusManager.CurrentFocus)),o.focus({preventScroll:!0})},v.prototype.updateFocus=function(){var o,l,g,f,t=document.activeElement;if(this.topViewport.contains(t))if(this.topRenderer.isPrefixCell(t))o=this.topRenderer.getRowIndex(t),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(t),g=this.isA11yTable?e.p0.Header:e.p0.MatrixCorner;else{var n=this.topRenderer.getItemByElement(t);g=e.p0.Header,f=this.columnNavigator.getPathIndices(n)}else if(this.midViewport.contains(t))this.midRenderer.isPrefixCell(t)?this.isA11yTable?(o=this.midRenderer.getRowIndex(t),l=-1,g=e.p0.Body):(n=this.midRenderer.getItemByElement(t),g=e.p0.MatrixRowHeader,f=this.rowNavigator.getPathIndices(n)):(o=this.midRenderer.getRowIndex(t),l=this.midRenderer.getColumnIndex(t),g=e.p0.Body);else if(this.botViewport.contains(t))this.botRenderer.isPrefixCell(t)?this.isA11yTable?(o=this.botRenderer.getRowIndex(t),l=-1,g=e.p0.Footer):(o=this.botRenderer.getRowIndex(t),g=e.p0.FooterHeader):(o=this.botRenderer.getRowIndex(t),l=this.botRenderer.getColumnIndex(t),g=e.p0.Footer);else if(this.isA11yTable){var u=d3.select(this.topViewport).select(".main-cell").node();o=this.topRenderer.getRowIndex(u),l=this.topRenderer.getColumnIndex(u),g=e.p0.Header}else{var S=d3.select(this.topViewport).select(".prefix-cell").node();o=this.topRenderer.getRowIndex(S),l=this.topRenderer.getColumnIndex(S),g=e.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(o,l,g,f)},v.prototype.scrollBy=function(t,o){if(this.renderLock)return!1;var l,g;if(t){var f=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(t,!0),this.columnScrollbar.refresh(),l=f!==this.columnScrollbar.viewMin}if(o){var n=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(o,!0),this.rowScrollbar.refresh(),g=n!==this.rowScrollbar.viewMin}return!(!l&&!g||(this.refresh(),0))},v.prototype.scrollTo=function(t,o){this.renderLock||(null!=t&&(this.columnScrollbar.scrollTo(t,!0),this.columnScrollbar.refresh()),null!=o&&(this.rowScrollbar.scrollTo(o,!0),this.rowScrollbar.refresh()),this.refresh())},v.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var t=this.getViewport(),o=this.columnScrollbar.viewMin,l=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(o),this.midRenderer.scrollToX(o),this.botRenderer.scrollToX(o),this.midViewport.scrollTop=l,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(t,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(t,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(t,this.binder,this.rowNavigator,this.columnNavigator)}},v.prototype.renderAsync=function(t,o,l){return(0,B.__awaiter)(this,void 0,void 0,function(){var g,f,s,n,u;return(0,B.__generator)(this,function(S){switch(S.label){case 0:return g=++this.renderIteration,t===e.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(o,l,g)];case 1:return u=S.sent(),f=u[0],s=u[1],g!==this.renderIteration||(this.unlockRendering(),(n=this.element.contains(document.activeElement))&&this.storeFocus(),(t===e.BM.ClearRendering||t===e.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(f,s),t===e.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),n&&(t===e.BM.ClearRendering||t===e.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},v.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},v.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},v.prototype.measureAsync=function(t,o,l){return(0,B.__awaiter)(this,void 0,void 0,function(){var g,f,s,n,u,S,b;return(0,B.__generator)(this,function(p){switch(p.label){case 0:if(u=this.getViewport(),t?n=t.rowIndex:(S=i._E.getVisibleRange(u.top,u.height,this.rowHeightMeasureManager),n=S?S.firstLeafIndex:0),o?s=o.columnIndex:(b=i.sW.getVisibleRange(u.left,u.width,this.columnWidthMeasureManager),s=b?b.firstLeafIndex:0),s=Math.max(0,Math.floor(s-i.EO/2)),!o)return[3,4];p.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&o.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,3];case 2:return p.sent(),l!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return g=i.sW.getOffset(o,this.columnWidthMeasureManager),o.alignRight&&(g-=this.columnScrollbar.viewSize),[3,5];case 4:g=this.columnScrollbar.viewMin,p.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-g<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,7];case 6:return p.sent(),l!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,i.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,n,s,i.EO),!t)return[3,11];p.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&t.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,s),[4,this.setTimeoutAsync()]):[3,10];case 9:return p.sent(),l!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return f=i._E.getOffset(t,this.rowHeightMeasureManager),t.alignBottom&&(f-=this.rowScrollbar.viewSize),[3,12];case 11:f=this.rowScrollbar.viewMin,p.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-f<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,s),[4,this.setTimeoutAsync()]):[3,14];case 13:return p.sent(),l!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,n,s,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,s,i.EO),this.measurePageColumnsAsync(n,l),this.measurePageRowsAsync(n,s,l),[2,[g,f]]}})})},v.prototype.updateAria=function(){var t=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),o=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",t),d3.select(this.innerContainer).attr("aria-colcount",o)},v.prototype.setTimeoutAsync=function(t){return void 0===t&&(t=0),(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(o){return[2,new le.J(function(l){return F.l.setTimeout(function(){return l()},t)})]})})},v.prototype.requestAnimationFrameAsync=function(){return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(t){return[2,new le.J(function(o){return F.l.requestAnimationFrame(function(){return o()})})]})})},v.prototype.getVisibleRowStart=function(){var t=this.getViewport(),o=i._E.getVisibleRange(t.top,t.height,this.rowHeightMeasureManager);return o?i._E.getVisibleRowStart(o,t.top,this.rowHeightMeasureManager):null},v.prototype.getVisibleColumnStart=function(){var t=this.getViewport(),o=i.sW.getVisibleRange(t.left,t.width,this.columnWidthMeasureManager);return o?i.sW.getVisibleColumnStart(o,t.left,this.columnWidthMeasureManager):null},v.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},v.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},v.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},v.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,C.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var t=(0,C.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=t},v.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var t=this.rowHeightMeasureManager.getFloatingRowHeights(),o=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-t,l=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),g=this.rowHeightMeasureManager.getRowsHeight(),f=this.columnWidthMeasureManager.getColumnsWidth(),s=this.options.scrollingEnabled&&g>0&&g>o,n=this.options.scrollingEnabled&&f>0&&f>l;!s&&n&&g>0&&(s=g>o-r.zf),!n&&s&&f>0&&(n=f>l-r.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=s?this.rowScrollbar.width:(0,C.S)(0);var S,b,u=n?r.zf:0;g>o-u?(S=u+t,b=u):(S=o+t-g,b=o-g),this.midViewport.style.bottom=(0,C.S)(S),this.botViewport.style.bottom=(0,C.S)(b),this.rowScrollbar.show(s),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=n?r.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(n),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=s?r.zf+"px":"0",this.columnScrollbar.refresh()},v.prototype.getBodyCellWidth=function(){var t=this.rowLevelWidthMeasureManager.getHeadersWidth(),o=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-t,o)},v.prototype.measurePageColumnsAsync=function(t,o){return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(l){switch(l.label){case 0:return[4,this.setTimeoutAsync(r.yv)];case 1:if(l.sent(),o!==this.renderIteration)return[2];l.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,t),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(r.yv)]):[3,4];case 3:return l.sent(),o!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},v.prototype.measurePageRowsAsync=function(t,o,l){return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(g){switch(g.label){case 0:return[4,this.setTimeoutAsync(r.yv)];case 1:if(g.sent(),l!==this.renderIteration)return[2];g.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,t,o),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(r.yv)]):[3,4];case 3:return g.sent(),l!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},v.prototype.updateScrollRegionWidth=function(){var t=this.rowLevelWidthMeasureManager.getHeadersWidth(),o=this.columnWidthMeasureManager.getColumnsWidth(),l=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?o+t:o,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?l:l-t,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},v.prototype.updateScrollRegionHeight=function(){var t=this.rowHeightMeasureManager.getRowsHeight(),o=this.midViewport.clientHeight,l=(0,C.S)(Math.max(t,o));this.innerBodyCellContainer.style.height=l,this.rowScrollbar.max=t,this.rowScrollbar.viewSize=o,this.rowScrollbar.refresh()},v.prototype.getNumberOfVisibleRows=function(){var t=this.getViewport(),o=i._E.getVisibleRange(t.top,t.height,this.rowHeightMeasureManager);if(o)return Math.max(0===o.firstLeafIndex?o.lastLeafIndex-o.firstLeafIndex:o.lastLeafIndex-o.firstLeafIndex-1,1)},v.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},v.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},v.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},v.prototype.destroy=function(){this.renderIteration=NaN},v.ScrollDeltaMax=200,v}()},44102:function(Re,we,X){X.d(we,{AT:function(){return i},Xg:function(){return Q},fw:function(){return E}});var B=X(81337),fe=X(66232),ee=X(62458),oe=X(87914),le=X(93340),F="unselectable";function E(C,r){if(C)for(var e=0,h=C;e<h.length;e++)(0,h[e])(r)}var T=function(){function C(r,e){this._owner=r,this._direction=e,this._timerHandle=void 0,this.createView();var h=this;this._element.addEventListener("mousedown",function(y){h.onMouseDown(y)}),$(this._element).addClass(F),$(this._svg).addClass(F),$(this._polygon).addClass(F)}return Object.defineProperty(C.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),C.prototype.createView=function(){var r="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(r,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",C.ARROW_COLOR),this._svg=document.createElementNS(r,"svg");var e=this._svg.style;e.position="absolute",e.left="0px",e.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=O.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},C.prototype.onMouseDown=function(r){var e=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){r.cancelBubble=!0;var h=this;this._mouseUpWrapper=function(y){h.onMouseUp(y)},O.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){e.onMouseDown(r)},100),r.preventDefault&&r.preventDefault()},C.prototype.onMouseUp=function(r){clearTimeout(this._timerHandle),O.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},C.prototype.arrange=function(r,e,h){var y=Math.min(r,e);this._polygon.setAttributeNS(null,"transform","translate("+(r-y)/2+", "+(e-y)/2+") scale("+y/16+") rotate("+h+",8,8)"),this._svg.setAttributeNS(null,"width",r+"px"),this._svg.setAttributeNS(null,"height",e+"px"),(0,le.Py)(this._element,r),(0,le.Iw)(this._element,e)},C.MIN_WIDTH=26,C.ARROW_COLOR="#404040",C}(),O=function(){function C(r,e,h,y){this.isModern=h,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(r,e);var I=this;this._element.addEventListener("mousedown",function(M){I.onBackgroundMouseDown(M)}),this._element.addEventListener("pointerdown",function(M){(0,fe.n)(M)}),this._element.addEventListener("dblclick",function(M){(0,fe.n)(M)}),this._middleBar.addEventListener("mousedown",function(M){I.onMiddleBarMouseDown(M)}),this._middleBar.addEventListener("pointerdown",function(M){(0,fe.n)(M)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(F),this.onScrollBehavior=y}return C.prototype.scrollBy=function(r,e){this.scrollTo(this.viewMin+r,e)},C.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},C.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},C.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},C.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(C.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._element.style.width=e,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._element.style.height=e,this.invalidateArrange()},enumerable:!1,configurable:!0}),C.prototype.refresh=function(){ee.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(C.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),C.prototype._scrollSmallIncrement=function(r){this.scrollBy(this.smallIncrement*r)},Object.defineProperty(C.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),C.prototype.show=function(r){this._visible=r,this.element.style.visibility=r?"visible":"hidden",this.invalidateArrange()},C.prototype._getMouseOffset=function(r){return void 0!==r.offsetX?{x:r.offsetX,y:r.offsetY}:void 0!==r.layerX?{x:r.layerX,y:r.layerY}:{x:r.screenX,y:r.screenY}},C.prototype._getOffsetXDelta=function(r){return(r.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},C.prototype._getOffsetYDelta=function(r){return(r.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},C.prototype._getOffsetXTouchDelta=function(r){return this._getMouseOffset(r).x-this._offsetTouchPrevPos.x},C.prototype._getOffsetYTouchDelta=function(r){return this._getMouseOffset(r).y-this._offsetTouchPrevPos.y},C.prototype.onTouchStart=function(r){1===r.touches.length&&this.onTouchMouseDown(r.touches[0])},C.prototype.onTouchMove=function(r){1===r.touches.length&&(r.preventDefault&&r.preventDefault(),this.onTouchMouseMove(r.touches[0]))},C.prototype.onTouchEnd=function(r){this.onTouchMouseUp(1===r.touches.length?r.touches[0]:r,!0)},C.prototype.onTouchMouseDown=function(r){!this._allowMouseDrag&&r.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},C.prototype._getOffsetTouchDelta=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},C.prototype.onTouchMouseMove=function(r){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(r));var e=this._getOffsetTouchDelta(r);0!==e&&(this.scrollBy(-e/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(r)),r.preventDefault&&r.preventDefault(),r.cancelBubble=!0}},C.prototype.onTouchMouseUp=function(r,e){if(this._touchStarted&&this._offsetTouchStartPos){var h=this._getMouseOffset(r);!e&&(Math.abs(this._offsetTouchStartPos.x-h.x)>3||Math.abs(this._offsetTouchStartPos.y-h.y)>3)&&(r.preventDefault&&r.preventDefault(),r.cancelBubble=!0)}this._touchStarted=!1},C.prototype.createView=function(r,e){this._element=document.createElement("div"),this._element.className=C.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===e&&r.appendChild(this._element),this.isModern||(this._minButton=new T(this,-1),this._maxButton=new T(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=C.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},C.prototype.scrollTo=function(r,e){var h=Math.min(this.max-this.viewSize,Math.max(this.min,r));(h=Math.max(this.min,h))!==this.viewMin&&(this.viewMin=h,e||E(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},C.prototype._scrollByPage=function(r){ee.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},C.prototype._getRunningSize=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},C.prototype._getOffsetDelta=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},C.prototype.scroll=function(r){var e=this._getOffsetDelta(r)/this._getRunningSize(!0)*(this.max-this.min);if(e<0){if(this._getScreenMousePos(r)>=this._screenMaxMousePos)return}else if(e>0&&this._getScreenMousePos(r)<=this._screenMinMousePos)return;this.scrollBy(e)},Object.defineProperty(C.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),C.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},C.prototype._calculateButtonWidth=function(){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},C.prototype._calculateButtonHeight=function(){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},C.prototype._getMinButtonAngle=function(){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},C.prototype._getMaxButtonAngle=function(){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},C.prototype._setMaxButtonPosition=function(){ee.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},C.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},C.prototype.onHoldBackgroundMouseDown=function(r){var e=this;this._timerHandle=setTimeout(function(){e.onBackgroundMouseDown(r)},this._timerHandle?C.ScrollbarBackgroundMousedownHoldDelay:C.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},C.prototype.onBackgroundMouseDown=function(r){var e=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(r.cancelBubble=!0,this._backgroundMouseUpWrapper=function(h){e.onBackgroundMouseUp(h)},C.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(r),this.refresh(),this.onHoldBackgroundMouseDown(r),r.preventDefault&&r.preventDefault()},C.prototype.onBackgroundMouseUp=function(r){clearTimeout(this._timerHandle),this._timerHandle=void 0,C.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},C.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},C.prototype.onMiddleBarMouseDown=function(r){r.cancelBubble=!0,this._screenPrevMousePos={x:r.screenX,y:r.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(r)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(r)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(r)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(r)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,le.df)(this.element)*this.getPinchZoomY();var e=this;this._middleBarMouseMoveWrapper=function(h){e.onMiddleBarMouseMove(h)},C.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(h){e.onMiddleBarMouseUp(h)},C.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),r.preventDefault&&r.preventDefault()},C.prototype.onMiddleBarMouseMove=function(r){this._screenPrevMousePos&&(this.scroll(r),this.refresh(),this._screenPrevMousePos={x:r.screenX,y:r.screenY})},C.prototype.onMiddleBarMouseUp=function(r){this._screenPrevMousePos=void 0,C.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,C.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,r.preventDefault&&r.preventDefault()},C.prototype._getScreenContextualLeft=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},C.prototype._getScreenContextualRight=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},C.prototype.onMouseWheel=function(r){r&&this.mouseWheel(r)},C.prototype.mouseWheel=function(r){this.visible&&(r<0?r=Math.min(-C.MouseWheelRange,r):r>0&&(r=Math.max(C.MouseWheelRange,r)),this.scrollBy(-r/C.MouseWheelRange*this.smallIncrement))},C.prototype._getScreenMousePos=function(r){return ee.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},C.addDocumentMouseUpEvent=function(r){document.addEventListener("mouseup",r)},C.removeDocumentMouseUpEvent=function(r){document.removeEventListener("mouseup",r)},C.addDocumentMouseMoveEvent=function(r){document.addEventListener("mousemove",r)},C.removeDocumentMouseMoveEvent=function(r){document.removeEventListener("mousemove",r)},C.DefaultScrollbarWidth="15px",C.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,C.ScrollbarBackgroundMousedownHoldDelay=50,C.MouseWheelRange=120,C.className="scroll-bar-div",C.barClassName="scroll-bar-part-bar",C.arrowClassName="scroll-bar-part-arrow",C}(),Q=function(C){function r(e,h,y,I){var M=C.call(this,e,h,y,I)||this;return M.height=O.DefaultScrollbarWidth,M}return(0,B.__extends)(r,C),r.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,T.MIN_WIDTH))},r.prototype._calculateButtonHeight=function(){return this.actualHeight},r.prototype._getMinButtonAngle=function(){return-180},r.prototype._getMaxButtonAngle=function(){return 0},r.prototype._setMaxButtonPosition=function(){(0,le.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},r.prototype.refresh=function(){this.arrange();var e=this.actualWidth-2*this.actualButtonWidth-2,h=this.viewSize/(this.max-this.min)*e;h<this.MIN_BAR_SIZE&&(e-=this.MIN_BAR_SIZE-h,h=this.MIN_BAR_SIZE),e<0&&(e=0,h=0),h=Math.min(h,e);var y=this.viewMin/(this.max-this.min)*e;(0,le.Py)(this.middleBar,h),(0,le.Iw)(this.middleBar,this.actualHeight);var I=this.actualButtonWidth+1+y;this.isModern?this.middleBar.style.transform="translateX(".concat(I,"px)"):(0,le.hn)(this.middleBar,I)},r.prototype.show=function(e){e!==this.visible&&(C.prototype.show.call(this,e),e?this.element.style.height=this.height:(0,le.Iw)(this.element,0))},r.prototype._scrollByPage=function(e){var h;if(this.isModern){var y=window.getComputedStyle(this.middleBar);h=new WebKitCSSMatrix(y.transform).m41}else h=this.middleBar.offsetLeft;var U=void 0===e.offsetX?e.layerX:e.offsetX;U>h+this.middleBar.offsetWidth?this.scrollPageDown():U<h&&this.scrollPageUp()},r.prototype._getRunningSize=function(e){var h=this.actualWidth;if(e){var I=(h-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));I<this.MIN_BAR_SIZE&&(h-=this.MIN_BAR_SIZE-I)}return h},r.prototype._getOffsetDelta=function(e){return this._getOffsetXDelta(e)},r.prototype._getOffsetTouchDelta=function(e){return this._getOffsetXTouchDelta(e)},r.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().left},r.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().right},r.prototype._getScreenMousePos=function(e){return e.screenX},r}(O),i=function(C){function r(e,h,y,I){var M=C.call(this,e,h,y,I)||this;return M.width=O.DefaultScrollbarWidth,M}return(0,B.__extends)(r,C),r.prototype._calculateButtonWidth=function(){return this.actualWidth},r.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,T.MIN_WIDTH))},r.prototype._getMinButtonAngle=function(){return-90},r.prototype._getMaxButtonAngle=function(){return 90},r.prototype._setMaxButtonPosition=function(){(0,le.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},r.prototype.refresh=function(){this.arrange();var e=this.actualHeight-2*this.actualButtonHeight-2,h=this.viewSize/(this.max-this.min)*e;h<this.MIN_BAR_SIZE&&(e-=this.MIN_BAR_SIZE-h,h=this.MIN_BAR_SIZE),e<0&&(e=0,h=0);var y=this.viewMin/(this.max-this.min)*e;(0,le.Py)(this.middleBar,this.actualWidth),(0,le.Iw)(this.middleBar,h);var I=this.actualButtonHeight+1+y;this.isModern?this.middleBar.style.transform="translateY(".concat(I,"px)"):(0,le.FX)(this.middleBar,I)},r.prototype.show=function(e){e!==this.visible&&(C.prototype.show.call(this,e),e?this.element.style.width=this.width:(0,le.Py)(this.element,0))},r.prototype._scrollByPage=function(e){var h;if(this.isModern){var y=window.getComputedStyle(this.middleBar);h=new WebKitCSSMatrix(y.transform).m42}else h=this.middleBar.offsetTop;var U=void 0===e.offsetY?e.layerY:e.offsetY;U>h+this.middleBar.offsetHeight?this.scrollPageDown():U<h&&this.scrollPageUp()},r.prototype._getRunningSize=function(e){var h=this.actualHeight;if(e){var I=(h-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));I<this.MIN_BAR_SIZE&&(h-=this.MIN_BAR_SIZE-I)}return h},r.prototype._getOffsetDelta=function(e){return this._getOffsetYDelta(e)},r.prototype._getOffsetTouchDelta=function(e){return this._getOffsetYTouchDelta(e)},r.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().top},r.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().bottom},r.prototype._getScreenMousePos=function(e){return e.screenY},r}(O)},73889:function(Re,we,X){X.d(we,{Y:function(){return B}});var B=function(fe){return fe[fe.Matrix=0]="Matrix",fe[fe.Table=1]="Table",fe[fe.PivotTable=2]="PivotTable",fe[fe.TableEx=3]="TableEx",fe}({})},71090:function(Re,we,X){X.d(we,{Ds:function(){return e},Ed:function(){return d},Eo:function(){return V},F2:function(){return L},Hw:function(){return C},JM:function(){return W},LU:function(){return w},Mh:function(){return E},NA:function(){return c},OM:function(){return l},P$:function(){return S},Pr:function(){return I},QM:function(){return o},R9:function(){return H},Sl:function(){return Q},TV:function(){return O},Vz:function(){return k},WA:function(){return M},YR:function(){return n},Yo:function(){return he},Zk:function(){return R},b:function(){return T},bn:function(){return oe},dG:function(){return m},dm:function(){return r},en:function(){return y},f:function(){return U},fG:function(){return b},iC:function(){return i},jv:function(){return g},lN:function(){return re},mQ:function(){return J},qT:function(){return ee},rJ:function(){return u},rx:function(){return s},rz:function(){return h},s$:function(){return K},s0:function(){return G},sR:function(){return fe},uX:function(){return F},uZ:function(){return ae},wH:function(){return f},wd:function(){return p},yF:function(){return le},ye:function(){return D},z7:function(){return t},zq:function(){return te}});var B=X(38265),fe=.8,ee="TableTotalLabel",oe="Format_AddTotalLabel",le="Visual_LabelText_Value",F="Row_Selection",E="SelectRow",T="Row_Selected",O="Row_Unselected",Q="Additional_Conditional_Formatting",i="DecompositionTree_ScrollLevelUp_Tooltip",C="DecompositionTree_ScrollLevelDown_Tooltip",r="Scroll_Left",e="Scroll_Right",h="tablixDiv",y="tablixCellContentElement",I="tablixCellContentHost",M="tablixWrappingContainer",U="tablixHeader",J="tablixColumnHeaderLeaf",G="tablixValueNumeric",H="tablixValueTotal",c="powervisuals-glyph tablixUrlIconGlyph",w="tablixValueUrlIcon",d="tablixImageContainer",V="matrixRowHeaderLeaf",K="tableFooterCell",W="tableBodyCell",te="tableBodyCellBottom",t="tablixAlignLeft",o="tablixAlignCenter",l="tablixAlignRight",g="&nbsp;",f="px",s="tablixSortIconContainer",n=10,u=5,S=5,b=5,p=1,m=B.Wn.regular.css,L=B.Wn.regular.css,R=B.Wn.bold.css,k=B.Wn.glyphs.css,D="#333",re="#666",ae=Number.POSITIVE_INFINITY,he=.71},42737:function(Re,we,X){X.d(we,{A:function(){return fe}});var B=X(62458),fe=function(){function ee(oe,le){this._element=oe,this._handler=le,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return ee.addDocumentMouseUpEvent=function(oe){document.addEventListener("mouseup",oe)},ee.removeDocumentMouseUpEvent=function(oe){document.removeEventListener("mouseup",oe)},ee.addDocumentMouseMoveEvent=function(oe){document.addEventListener("mousemove",oe)},ee.removeDocumentMouseMoveEvent=function(oe){document.removeEventListener("mousemove",oe)},ee.getMouseCoordinates=function(oe){return{x:oe.pageX,y:oe.pageY}},ee.getMouseCoordinateDelta=function(oe,le){return{x:le.x-oe.x,y:le.y-oe.y}},ee.prototype.initialize=function(){var oe=this;this._elementMouseDownWrapper=function(le){return oe.onElementMouseDown(le)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(le){return oe.onElementMouseMove(le)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(le){return oe.onElementMouseOut(le)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(le){return oe.onElementMouseDoubleClick(le)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},ee.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(ee.prototype,"cell",{get:function(){return B.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),ee.prototype._hotSpot=function(oe){return B.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},ee.prototype.onElementMouseDown=function(oe){var le=this,F=ee.getMouseCoordinates(oe);this._hotSpot(F)&&(oe.cancelBubble=!0,this._startMousePosition=F,this._documentMouseMoveWrapper=function(E){return le.onDocumentMouseMove(E)},ee.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(E){return le.onDocumentMouseUp(E)},ee.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=ee.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},ee.prototype.onElementMouseMove=function(oe){this._startMousePosition||(this._hotSpot(ee.getMouseCoordinates(oe))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=ee.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},ee.prototype.onElementMouseOut=function(oe){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},ee.prototype.onElementMouseDoubleClick=function(oe){this._hotSpot(ee.getMouseCoordinates(oe))&&this._handler.onReset(this.cell)},ee.prototype.onDocumentMouseMove=function(oe){if(this._startMousePosition){var le=ee.getMouseCoordinateDelta(this._startMousePosition,ee.getMouseCoordinates(oe));this._handler.onResize(this.cell,le.x,le.y),oe.preventDefault()}},ee.prototype.onDocumentMouseUp=function(oe){this._startMousePosition=null,ee.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,ee.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),oe.preventDefault&&oe.preventDefault(),this._handler.onEndResize(this.cell)},ee.resizeHandleSize=4,ee.resizeCursor="e-resize",ee}()},93340:function(Re,we,X){X.d(we,{AB:function(){return g},Av:function(){return D},Ch:function(){return s},D4:function(){return C},D6:function(){return ae},DM:function(){return l},FX:function(){return r},G9:function(){return t},Hd:function(){return a},Hx:function(){return S},Iw:function(){return h},MN:function(){return p},Or:function(){return R},Pb:function(){return H},Py:function(){return y},R5:function(){return v},RP:function(){return m},Uy:function(){return M},W_:function(){return K},Y1:function(){return k},Y4:function(){return Y},aP:function(){return o},df:function(){return J},ey:function(){return te},hn:function(){return e},jG:function(){return Z},jT:function(){return P},mx:function(){return I},om:function(){return c},pW:function(){return ue},qZ:function(){return w},ri:function(){return V},ut:function(){return G},v4:function(){return f},vU:function(){return u},wC:function(){return W},wX:function(){return L},x7:function(){return re},xl:function(){return n}});var B=X(54522),fe=X(91358),ee=X(44977),oe=X(38308),le=X(62458),F=X(6444),E=X(64329),T=X(48066),O=X(28326),Q=X(42737),i=X(71090);function C(A){if(A)for(;A.hasChildNodes();)A.removeChild(A.firstChild)}function r(A,z){A.style.top=z+"px"}function e(A,z){A.style.left=z+"px"}function h(A,z){A.style.height=U(z)?"":z+"px"}function y(A,z){A.style.width=U(z)?"":z+"px"}function I(A){return A.offsetWidth}function M(A){return A.offsetHeight}function U(A){return-1===A}function J(A){var z=A.offsetWidth;return 0===z?1:A.getBoundingClientRect().width/z}function G(A,z){var ie=A.getBoundingClientRect(),ce=J(A);return{x:(z.pageX-ie.left)/ce,y:(z.pageY-ie.top)/ce}}var H=function(A){return A[A.Outline=0]="Outline",A[A.Gridline=1]="Gridline",A}({}),c=function(){function A(z,ie){this.applyParams(!0,z,ie)}return A.prototype.applyParams=function(z,ie,ce,me){z?(this.weight=ie??0,this.color=ce??"black",this.type=me??H.Gridline):(this.weight=0,this.color="black",this.type=H.Gridline)},A.prototype.getCSS=function(){var z=[];return _.isNumber(this.weight)&&(z.push(this.weight+i.wH),this.color&&z.push(this.color),z.push("solid")),z.join(" ")},A.prototype.getPriority=function(z){return this===z.top||this===z.bottom?this.type===H.Outline?2:0:this===z.right||this===z.left?this.type===H.Outline?3:1:-1},A.prototype.getShadowCss=function(z,ie){var me=this.weight?this.weight+5:0,Pe="inset ";if(this===z.left)Pe+=me+i.wH+" 0";else if(this===z.right)Pe+="-"+Math.min(me,ie+5)+i.wH+" 0";else if(this===z.top)Pe+="0 "+me+i.wH;else{if(this!==z.bottom)return"";Pe+="0 -"+me+i.wH}return Pe+" 0 -".concat(5,"px ")+this.color},A}(),w=function(){function A(z,ie){void 0===z&&(z=i.YR),void 0===ie&&(ie=i.rJ),this.borders={},this.paddings={top:0,left:z,bottom:0,right:ie},this.fontColor="",this.fontFamily="",this.backColor=""}return A.prototype.applyStyle=function(z){var ce=z.extension.contentHost.style;ce.fontFamily=this.fontFamily,ce.fontSize=this.fontSize?E.FP.toString(this.fontSize.px):void 0,ce.fontWeight=this.fontWeight,ce.fontStyle=this.fontStyle,ce.textDecoration=this.textDecoration,ce.color=this.fontColor,ce.backgroundColor=this.backColor,ce.boxShadow=this.getBoxShadow(),ce.border="none",ce.paddingTop=this.getPaddingTop(),ce.paddingRight=this.getPaddingRight(),ce.paddingBottom=this.getPaddingBottom(),ce.paddingLeft=this.getPaddingLeft(),ce.maxWidth=this.maxWidth},A.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+i.wH},A.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+i.wH},A.prototype.getPaddingRight=function(){return(this.paddings.right??i.rJ)+(null==this.borders.right?0:this.borders.right.weight)+i.wH},A.prototype.getPaddingLeft=function(){return(this.paddings.left??i.YR)+(null==this.borders.left?0:this.borders.left.weight)+i.wH},A.prototype.getBoxShadow=function(z){var ie,ce,me,ye,Pe,Me,He,xe,Fe=[];return(null===(ie=this.borders.left)||void 0===ie?void 0:ie.type)===H.Outline&&0!==this.borders.left.weight&&Fe.push(this.borders.left.getShadowCss(this.borders)),(null===(ce=this.borders.right)||void 0===ce?void 0:ce.type)===H.Outline&&0!==this.borders.right.weight&&0!==z&&Fe.push(this.borders.right.getShadowCss(this.borders,z)),(null===(me=this.borders.bottom)||void 0===me?void 0:me.type)===H.Outline&&0!==this.borders.bottom.weight&&Fe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(ye=this.borders.top)||void 0===ye?void 0:ye.type)===H.Outline&&0!==this.borders.top.weight&&Fe.push(this.borders.top.getShadowCss(this.borders)),(null===(Pe=this.borders.left)||void 0===Pe?void 0:Pe.type)===H.Gridline&&0!==this.borders.left.weight&&Fe.push(this.borders.left.getShadowCss(this.borders)),(null===(Me=this.borders.right)||void 0===Me?void 0:Me.type)===H.Gridline&&0!==this.borders.right.weight&&0!==z&&Fe.push(this.borders.right.getShadowCss(this.borders,z)),(null===(He=this.borders.bottom)||void 0===He?void 0:He.type)===H.Gridline&&0!==this.borders.bottom.weight&&Fe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(xe=this.borders.top)||void 0===xe?void 0:xe.type)===H.Gridline&&0!==this.borders.top.weight&&Fe.push(this.borders.top.getShadowCss(this.borders)),Fe.join(", ")},A.prototype.setAttributes=function(z,ie,ce,me,ye){if(z["padding-top"]=this.getPaddingTop(),z["padding-right"]=this.getPaddingRight(),z["padding-bottom"]=this.getPaddingBottom(),z["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(z["font-family"]=this.fontFamily),null!=this.fontSize&&(z["font-size"]=E.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(z["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(z["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(z["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(z.color=this.fontColor),_.isEmpty(this.backColor)||(z["background-color"]=this.backColor),me||!ie&&!ce){var Pe=parseFloat(this.getPaddingLeft()),Me=parseFloat(this.getPaddingRight()),He=this.getRightBorderMax(ye,Pe,Me),xe=this.getBoxShadow(He);_.isEmpty(xe)||(z["box-shadow"]=xe)}_.isEmpty(this.maxWidth)||(z["max-width"]=this.maxWidth),(ie||ce)&&(z["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",z["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",z["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",z["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},A.prototype.getRightBorderMax=function(z,ie,ce){if(null==z)return ce;var me=Math.max(z-ie,0);return Math.min(ce,me)},A.prototype.getAttributes=function(z,ie,ce,me){var ye={};return this.setAttributes(ye,z,ie,ce,me),ye},A.prototype.getExtraTop=function(){var z=0;return this.paddings.top&&(z+=this.paddings.top),this.borders.top&&(z+=this.borders.top.weight),z},A.prototype.getExtraBottom=function(){var z=0;return this.paddings.bottom&&(z+=this.paddings.bottom),this.borders.bottom&&(z+=this.borders.bottom.weight),z},A.prototype.getExtraRight=function(){var z=0;return this.paddings.right&&(z+=this.paddings.right),this.borders.right&&(z+=this.borders.right.weight),z},A.prototype.getExtraLeft=function(){var z=0;return this.paddings.left&&(z+=this.paddings.left),this.borders.left&&(z+=this.borders.left.weight),z},A}(),d=function(){return function(){}}(),V=function(){function A(){this.row=new d,this.column=new d}return A.prototype.isMatch=function(z){return this.column.index===z.column.index&&this.row.index===z.row.index},A}(),Z=function(){function A(z,ie,ce,me,ye,Pe,Me,He,xe,Fe,Ve){this.dataPoint=z,this.objects=ie,this.isRowSubTotal=ce,this.isColumnSubTotal=me,this.isRowGrandTotal=ye,this.isColumnGrandTotal=Pe,this.isBlankRow=Me,this.columnMetadata=He,this.formatter=xe,this.tooltipFormatter=Fe,this.type=Ve,this.position=new V,this.cachedTextContent=xe?this.formatter.format(z,ie):null!=this.dataPoint?z:""}return Object.defineProperty(A.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isKpi",{get:function(){return this.columnMetadata&&k(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(A,z){le.fF.assertValue(A,"kpi"),le.fF.assertValue(z,"kpiValue");var ie=(0,fe.sq)(A,z)||"";return(0,oe.hi)().addClass(ie).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,B.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,B.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"isValidUrl",{get:function(){return p(this.columnMetadata,this.textContent)!==T.av.NONE},enumerable:!1,configurable:!0}),A.prototype.isMatch=function(z){return this.position.isMatch(z.position)&&this.backColor===z.backColor},A}();function K(){return document.createElement("table")}function W(){var A=document.createElement("div");return A.className=i.rz,A}function te(A){A.extension.contentElement.className=i.rz+" "+i.en,A.extension.contentHost.className=i.rz+" "+i.Pr}function v(A,z){A.extension.contentHost.className+=" "+z}function t(A){A.extension.contentHost.className="",A.extension.contentHost.style.cssText=""}function o(A){A.extension.contentHost.textContent="",A.extension.contentHost.removeAttribute("title"),A.contentHeight=A.contentWidth=0,C(A.extension.contentHost)}function l(A,z,ie){g(A,z),f(A,ie||z)}function g(A,z){z.textContent=(0,ee.PC)(A)}function f(A,z){z.title=A}function s(A,z){var ie=W();return A.appendChild(ie),z&&(ie.textContent=z),ie}function n(A){var ie=A.offsetX;return ie>=0&&ie<A.target.offsetWidth-Q.A.resizeHandleSize}function u(A,z,ie){var ce=null;0===z.childElementCount?(ce=document.createElement("a"),z.appendChild(ce)):ce=z.children[0],ce.href=A,ce.target="_blank",ce.rel="noopener noreferrer",ce.title=A,null!=ie?(ce.className=i.NA+" "+ie,$(z).addClass(i.LU)):ce.innerText=A}function S(A,z,ie){var ce=W(),me=document.createElement("img");ce.style.height=ie+"px",ce.style.width="100%",ce.style.textAlign="center",me.src=A,me.style.maxHeight="100%",me.style.maxWidth="100%",ce.appendChild(me),z.appendChild(ce),z.title=A}function p(A,z){return(0,B.cR)(A)?(0,T.MN)(z):T.av.NONE}function m(A){switch(A){case T.av.file:case T.av.ftp:return"page2";case T.av.mailto:return"mail";case T.av.news:return"link";case T.av.telnet:return"pc1";case T.av.http:case T.av.https:return"link";default:return null}}function L(A,z,ie){return R(A,z)&&(0,T.gU)(ie)}function R(A,z){return(0,B.pt)(z)&&!A.isSubtotal&&!!A.identity}function k(A,z){return!(!A||void 0===z||!(0,fe.sq)(A,z))}function D(A,z){return{sortDescriptors:[{queryName:A,sortDirection:z}]}}function re(A){return 2===A?1:2}function ae(A,z){var ie=W();A?(ie.appendChild(he(A,!0)),ie.appendChild(he(re(A),!1))):ie.appendChild(he(2,!1));var ce=W();return ie.appendChild(ce),z.appendChild(ie),ce}function he(A,z){var ie=document.createElement("i");return ie.className=i.rx+" "+(z?"sorted":"future")+" "+(1===A?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),ie}function Y(A){(function(A){for(var z=0,ie=A.extension.contentElement.childElementCount;z<ie;z++)if(A.extension.contentElement.children.item(z).classList.contains(i.rx))return!0;return!1})(A)&&$(A.extension.contentElement).find("."+i.rx).remove()}function ue(A){return le.fF.assert(function(){return!(A instanceof Date)||(0,F.M4)(A)},"dates should implement DateWithEpochValue"),(0,F.M4)(A)&&(A=O.y3.fromDateWithEpochValue(A).toString()),String(A)}function a(A){return A+2}function P(A){return A+2}},74304:function(Re,we,X){X.d(we,{U:function(){return l}});var B=X(81337),fe=X(67016),ee=X(2142),oe=X(85196),le=X(84183),F=X(54522),E=X(56707),T=X(85028),O=X(32105),Q=X(33024),i=X(55007),C=X(85308),r=X(62458),e=X(56578),h=X(64329),y=X(82755),I=X(76045),M=X(91059),U=X(96915),J=X(82386),G=X(86878),c=X(72489),w=X(71090),d=X(73889),V=X(66842),Z=X(40845),K=10,l=function(){function f(s){this.tablixProperties=new i.FX(s)}return f.getMetadataObjects=function(s){return s&&s.metadata?s.metadata.objects:null},f.prototype.enumerateObjectRepetition=function(s,n,u,S){var b,p,m,L,R,k,D;r.fF.assertValue(s,"enumeration should be defined"),r.fF.assertValue(n,"dataView can't be undefined");var ae,re=this.getSelectorData(u);switch(u){case d.Y.Table:case d.Y.TableEx:ae=this.getTableColumnMetadata(n);break;case d.Y.Matrix:case d.Y.PivotTable:ae=this.getMatrixValuesColumnMetadata(n);break;default:return void r.fF.assertNever(u)}if(ae){ae=_.uniq(ae);for(var he=u===d.Y.PivotTable||u===d.Y.TableEx,se=0,Y=ae;se<Y.length;se++){var ue=Y[se],ve=null===(D=ue.type.misc)||void 0===D?void 0:D.sparkline;if(he){var Ce={containerName:ue.displayName,selector:this.getSelector(ue.queryName,re),allowOverrideSubtotalMatching:!0,objects:(p={},p[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},p)};if(s.push(Ce),!ve){var x={containerName:ue.displayName,selector:this.getSelector(ue.queryName,re),allowOverrideSubtotalMatching:!0,objects:(m={},m[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},m)};s.push(x)}if(ue.type.numeric&&!ve){var a={containerName:ue.displayName,selector:this.getSelector(ue.queryName),objects:(L={},L[i.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[i.FX.PropColumnFormattingDataBars.propertyName]},L)};s.push(a)}var P={containerName:ue.displayName,selector:this.getSelector(ue.queryName,re),altStaticSelector:this.getSelector(ue.queryName),allowOverrideSubtotalMatching:!0,objects:(R={},R[i.FX.PropValuesIcon.objectName]={formattingProperties:[i.FX.PropValuesIcon.propertyName]},R)};if(s.push(P),he&&S?.conditionalTablixWebURL&&!(0,F.cR)(ue)&&!ve){var N={containerName:ue.displayName,selector:this.getSelector(ue.queryName,re),allowOverrideSubtotalMatching:!0,objects:(k={},k[i.FX.PropValuesWebURL.objectName]={formattingProperties:[i.FX.PropValuesWebURL.propertyName]},k)};s.push(N)}}else{if(!ue.isMeasure||!ue.type.numeric)continue;var be={containerName:ue.displayName,selector:this.getSelector(ue.queryName,re),objects:(b={},b[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},b)};s.push(be)}}}},f.prototype.getSelectorData=function(s){switch(s){case d.Y.Table:return[(0,M.Yp)(["Values"])];case d.Y.TableEx:return[(0,U.Ue)(1)];case d.Y.Matrix:return[(0,M.Yp)(["Rows","Columns"])];case d.Y.PivotTable:return[(0,U.Ue)(1)];default:return void r.fF.assertNever(s)}},f.prototype.getConditionalFormattingSelector=function(s,n,u){void 0===u&&(u=!0);var S=u?this.getSelectorData(s):void 0;return this.getSelector(n,S)},f.prototype.getSelector=function(s,n){var u={metadata:s};return n&&(u.data=n),u},f.prototype.getFormattingModel=function(s,n,u,S,b,p,m){void 0===b&&(b=!1),r.fF.assertValue(u,"dataView can't be undefined");var D,L=f.getMetadataObjects(u),R=n,k=n,re=this.getColumnsMetadata(u,S);D=S===d.Y.Table?this.shouldShowTableTotalsOption(u)&&i.FX.PropGeneralTableTotals.getValue(L):this.shouldShowColumnSubtotalsOption(u)&&i.FX.PropGeneralMatrixColumnSubtotals.getValue(L)||this.shouldShowRowSubtotalsOption(u)&&i.FX.PropGeneralMatrixRowSubtotals.getValue(L);var ae=this.getTablixTextClassProperties(m),he=new e.Nq(this.getStylePresetCard(s,R,S,p),this.getGridCard(s,n,S,L,ae,p),this.getBlankRowCard(s,R,S,p),this.getValueCard(s,n,S,L,p),this.getColumnHeadersCard(s,n,S,p),this.getRowHeadersCard(s,R,S,L,b,p),this.getTotalsCard(s,k,S,p),this.getColumnSubtotalCard(s,R,u,S,D,p),this.getRowSubTotalsCard(s,R,u,S,D,p),this.getColumnGrandTotalsCard(s,R,S),this.getRowGrandTotalsCard(s,R,S),this.getColumnFormattingCard(s,n,re,S),this.getCellColumnCard(s,S,u,p),this.getUrlIconCard(s,n,S),this.getImageSizeCard(s,n,S,p),this.getSparklinesCard(re,s,S)),se=this.getMatrixRowsColumnMetadata(u),Y=this.getMatrixColumnsColumnMetadata(u),ue=p.a11yShowAsMatrix?this.getAccessibilityCardNew(se,Y,re,s,k,S):this.getAccessibilityCard(re,s,k,S);return ue&&he.addCards(ue),he.build()},f.prototype.getLayoutSlice=function(s,n){return new e.vi({uidBuilder:new e.IN(new e.SS(new e.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new e.uY({descriptor:fe.t.general.layout,value:s.general.layout}).build(),localize:n}).build()},f.prototype.getIndentationSlice=function(s,n){if(s.general.layout===V.t.Compact){var u=s.rowHeaders;return new e.vi({uidBuilder:new e.IN(new e.SS(new e.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(u,n).build(),localize:n}).build()}},f.prototype.getRepeatRowHeadersSlice=function(s,n){if(s.general.layout!==V.t.Compact)return new e.vi({uidBuilder:new e.IN(new e.SS(new e.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new e.bd({descriptor:fe.t.rowHeaders.repeatRowHeaders,value:s.rowHeaders.repeatRowHeaders}).build(),localize:n}).build()},f.prototype.getStylePresetCard=function(s,n,u,S){var b=this,p="StylePresets";S.matrixLayouts&&u===d.Y.PivotTable&&(p="Layout_And_StylePresets");var m=function(k){return s.getLocalizedString(k)},L=new e.CQ(new e.lg("stylePreset"),p,[fe.t.general.layout,fe.t.rowHeaders.steppedLayoutIndentation,fe.t.rowHeaders.repeatRowHeaders],m);return L.addGroup(void 0,function(R){if(R.addSlicePlaceholder((0,e.E0)("stylePreset")),S.matrixLayouts&&u===d.Y.PivotTable){var k=b.getLayoutSlice(n,m),D=b.getIndentationSlice(n,m),re=b.getRepeatRowHeadersSlice(n,m);R.addSlice(k),D&&R.addSlice(D),re&&R.addSlice(re)}}),L.build()},f.prototype.getBlankRowCard=function(s,n,u,S){if(S.matrixLayouts&&u===d.Y.PivotTable){var b=function(R){return s.getLocalizedString(R)},p=fe.t.blankRows,m=new e.CQ(new e.lg("blankRows"),"Visual_Blank_Rows",p,b).addTopLevelToggle("blankRow",function(){return new e.bd({descriptor:p.showBlankRows,value:n.blankRows.showBlankRows}).build()});return m.addGroup("colors",function(L){L.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new e.BT({descriptor:p.blankRowColor,value:{value:n.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new e.JN({descriptor:p.blankRowTransparency,value:n.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Q.t2},localize:b}).build(),function(R){return R.withCustomDisplayName("Transparency")})}),m.addGroup("border",function(L){L.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new e.bd({descriptor:p.showBorder,value:n.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new e.uY({descriptor:p.borderPosition,value:n.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new e.BT({descriptor:p.borderColor,value:{value:n.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new e.JN({descriptor:p.borderTransparency,value:n.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:Q.t2},localize:b}).build(),function(R){return R.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new e.mu({descriptor:p.borderWidth,value:n.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:K},unitSymbol:Q.e_}}).build(),function(R){return R.withCustomDisplayName("Visual_General_Properties_Width")})}),m.build()}},f.prototype.getGridCard=function(s,n,u,S,b,p){var m=function(ie){return s.getLocalizedString(ie)},L=u===d.Y.TableEx?ee.Z.grid:fe.t.grid,R=u===d.Y.TableEx?ee.Z.values:fe.t.values,k=R.outlineStyle,D=R.outlineWeight,re=R.outlineColor,ae=u===d.Y.TableEx?ee.Z.columnHeaders:fe.t.columnHeaders,he=ae.outlineStyle,se=ae.outlineWeight,Y=ae.outlineColor,ue=u===d.Y.TableEx?ee.Z.total:fe.t.total,ve=ue.outlineStyle,be=ue.outlineWeight,Ce=ue.outlineColor,x=fe.t.rowHeaders,a=x.outlineStyle,P=x.outlineWeight,N=x.outlineColor,de=L.outlineStyle,pe=(0,B.__rest)(L,["imageHeight","imageWidth","outline","outlineStyle"]);pe=(0,B.__assign)((0,B.__assign)({},pe),{outlineStyle:de,valuesOutlineStyle:k,valuesOutlineWeight:D,valuesOutlineColor:re,columnHeadersOutlineStyle:he,columnHeadersOutlineWeight:se,columnHeadersOutlineColor:Y}),u===d.Y.TableEx&&(pe=(0,B.__assign)((0,B.__assign)({},pe),{totalsOutlineStyle:ve,totalsOutlineColor:Ce,totalsOutlineWeight:be})),u===d.Y.PivotTable&&(pe=(0,B.__assign)((0,B.__assign)({},pe),{rowHeaderOutlineStyle:a,rowHeaderOutlineWeight:P,rowHeaderOutlineColor:N}));var ge=n.grid,A=new e.CQ(new e.lg("grid"),"Visual_Grid",pe,m);return A.addGroup("gridHorizontal",function(z){z.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new e.bd({descriptor:pe.gridHorizontal,value:ge.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new e.BT({descriptor:pe.gridHorizontalColor,value:{value:ge.gridHorizontalColor}}).build()},function(ie){return ie.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new e.mu({descriptor:pe.gridHorizontalWeight,value:ge.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:K}}}).build(),function(ie){return ie.withCustomDisplayName("Visual_General_Properties_Width")})}),A.addGroup("gridVertical",function(z){z.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new e.bd({descriptor:pe.gridVertical,value:ge.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new e.BT({descriptor:pe.gridVerticalColor,value:{value:ge.gridVerticalColor}}).build()},function(ie){return ie.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new e.mu({descriptor:pe.gridVerticalWeight,value:ge.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:K}}}).build(),function(ie){return ie.withCustomDisplayName("Visual_General_Properties_Width")})}),A.addGroup("border",function(z){z.withDisplayName("Visual_Border").addContainer("outline",function(ie){ie.withDisplayName("Section"),ie.addContainerItem("all",m("All"),function(ce){ce.addSimpleSlice("outlineStyle",function(){return new e.oM({descriptor:pe.outlineStyle,value:ge.outline}).build()},function(me){return me.withCustomDisplayName("Visual_Border_Position")}),ce.addSimpleSlice("outlineColor",function(){return new e.BT({descriptor:pe.outlineColor,value:{value:ge.outlineColor}}).build()},function(me){return me.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new e.mu({descriptor:pe.outlineWeight,value:ge.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:K}}}).build(),function(me){return me.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",m("Visual_Tablix_ColumnHeader"),function(ce){var me=n.columnHeaders;ce.addSimpleSlice("outlineStyleColumnHeaders",function(){return new e.oM({descriptor:he,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}),ce.addSimpleSlice("outlineColorColumnHeaders",function(){return new e.BT({descriptor:Y,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new e.mu({descriptor:se,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:K}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),u===d.Y.PivotTable&&ie.addContainerItem("rowHeaders",m("Visual_Tablix_RowHeaders"),function(ce){var me=n.rowHeaders;ce.addSimpleSlice("outlineStyleRowHeaders",function(){return new e.oM({descriptor:a,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}),ce.addSimpleSlice("outlineColorRowHeaders",function(){return new e.BT({descriptor:N,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new e.mu({descriptor:P,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:K}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),ie.addContainerItem("values",m("Visual_Tablix_ValuesSection"),function(ce){var me=n.values;ce.addSimpleSlice("outlineStyleValues",function(){return new e.oM({descriptor:k,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new e.BT({descriptor:re,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new e.mu({descriptor:D,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:K}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),u===d.Y.TableEx&&ie.addContainerItem("outline-totals",m("Visual_Tablix_TotalsSection"),function(ce){var me=n.total;ce.addSimpleSlice("outlineStyleTotals",function(){return new e.oM({descriptor:ve,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new e.BT({descriptor:Ce,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new e.mu({descriptor:be,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:K}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})})})}),A.addGroup("options",function(z){z.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new e.mu({descriptor:pe.rowPadding,value:ge.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new e.mu({descriptor:pe.textSize,value:i.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,S,b.fontSizeOverrideFn,b.labelFontProperties.size&&b.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(ie){return ie.withCustomDisplayName("Global_Font_Size")})}),A.build()},f.prototype.getValueCard=function(s,n,u,S,b){var se=(0,B.__rest)(u===d.Y.TableEx?ee.Z.values:fe.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),Y=n.values,ue=new e.CQ(new e.lg("values"),"Visual_Tablix_Values",se,function(x){return s.getLocalizedString(x)}),be=(new e.UN).withFontFamily({descriptor:se.fontFamily,value:Y.fontFamily}).withFontSizeProperties({descriptor:se.fontSize,value:Y.fontSize.pt}).withBold({descriptor:se.bold,value:Y.bold}).withItalic({descriptor:se.italic,value:Y.italic}).withUnderline({descriptor:se.underline,value:Y.underline}).build();return ue.addGroup("values",function(Ce){Ce.withDisplayName("Visual_Tablix_Values"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&Ce.addCompositeSlice("font","Font",be),Ce.addSimpleSlice("fontColorPrimary",function(){return new e.BT({descriptor:se.fontColorPrimary,value:{value:Y.fontColorPrimary}}).build()},function(x){return x.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new e.BT({descriptor:se.backColorPrimary,value:{value:Y.backColorPrimary}}).build()},function(x){return x.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new e.BT({descriptor:se.fontColorSecondary,value:{value:Y.fontColorSecondary}}).build()},function(x){return x.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new e.BT({descriptor:se.backColorSecondary,value:{value:Y.backColorSecondary}}).build()},function(x){return x.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new e.bd({descriptor:se.wordWrap,value:Y.wordWrap}).build(),function(x){return x.withCustomDisplayName("TextWrap")})}),u===d.Y.PivotTable&&ue.addGroup("options",function(Ce){Ce.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new e.bd({descriptor:se.valuesOnRow,value:i.FX.PropValuesOnRow.setInstanceProperty(void 0,S)}).build(),function(x){return x.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),ue.build()},f.prototype.getColumnHeadersCard=function(s,n,u,S){var D=(0,B.__rest)(u===d.Y.TableEx?ee.Z.columnHeaders:fe.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),re=n.columnHeaders,ae=new e.CQ(new e.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",D,function(ue){return s.getLocalizedString(ue)}),se=(new e.UN).withFontFamily({descriptor:D.fontFamily,value:re.fontFamily}).withFontSizeProperties({descriptor:D.fontSize,value:re.fontSize.pt}).withBold({descriptor:D.bold,value:re.bold}).withItalic({descriptor:D.italic,value:re.italic}).withUnderline({descriptor:D.underline,value:re.underline}).build();return ae.addGroup("text",function(Y){Y.withDisplayName("Text"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&Y.addCompositeSlice("font","Font",se),Y.addSimpleSlice("fontColor",function(){return new e.BT({descriptor:D.fontColor,value:{value:re.fontColor}}).build()},function(ve){return ve.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new e.BT({descriptor:D.backColor,value:{value:re.backColor}}).build()},function(ve){return ve.withCustomDisplayName("Background_Color")}),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&Y.addSimpleSlice("alignment",new e.Gp({descriptor:D.alignment,value:re.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(ve){return ve.withCustomDisplayName("Visual_TextAlignment_Header")}),u===d.Y.PivotTable&&Y.addSimpleSlice("titleAlignment",new e.Gp({descriptor:D.titleAlignment,value:n.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&Y.addSimpleSlice("wordWrap",new e.bd({descriptor:D.wordWrap,value:re.wordWrap}).build(),function(ve){return ve.withCustomDisplayName("TextWrap")})}),(u===d.Y.PivotTable||u===d.Y.TableEx)&&ae.addGroup("options",function(Y){Y.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new e.bd({descriptor:D.autoSizeColumnWidth,value:n.general.autoSizeColumnWidth}).build(),function(ue){return ue.withCustomDisplayName("Visual_AutoSize_Width")})}),ae.build()},f.prototype.getRowHeadersCard=function(s,n,u,S,b,p){var m=this;if(void 0===b&&(b=!1),u===d.Y.PivotTable){var L=function(a){return s.getLocalizedString(a)},se=(0,B.__rest)(fe.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),Y=fe.t.values.bandedRowHeaders;u===d.Y.PivotTable&&(se=(0,B.__assign)((0,B.__assign)({},se),{bandedRowHeaders:Y}));var ue=n.rowHeaders,ve=new e.CQ(new e.lg("rowHeaders"),"Visual_Tablix_RowHeaders",se,L),Ce=(new e.UN).withFontFamily({descriptor:se.fontFamily,value:ue.fontFamily}).withFontSizeProperties({descriptor:se.fontSize,value:ue.fontSize.pt}).withBold({descriptor:se.bold,value:ue.bold}).withItalic({descriptor:se.italic,value:ue.italic}).withUnderline({descriptor:se.underline,value:ue.underline}).build();return ve.addGroup("text",function(x){x.withDisplayName("Text"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&x.addCompositeSlice("font","Font",Ce),x.addSimpleSlice("fontColor",function(){return new e.BT({descriptor:se.fontColor,value:{value:ue.fontColor}}).build()},function(a){return a.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new e.BT({descriptor:se.backColor,value:{value:ue.backColor}}).build()},function(a){return a.withCustomDisplayName("Background_Color")}),u===d.Y.PivotTable&&x.addSimpleSlice("bandedRowHeaders",new e.bd({descriptor:se.bandedRowHeaders,value:i.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,S)}).build()),x.addSimpleSlice("alignment",new e.Gp({descriptor:se.alignment,value:ue.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new e.bd({descriptor:se.wordWrap,value:ue.wordWrap}).build(),function(a){return a.withCustomDisplayName("TextWrap")})}),u===d.Y.PivotTable&&b&&ve.addGroup("expandCollapseButtons",function(x){x.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),x.addTopLevelToggle("showExpandCollapseButtons",function(){return new e.bd({descriptor:se.showExpandCollapseButtons,value:ue.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new e.BT({descriptor:se.expandCollapseButtonsColor,value:{value:ue.expandCollapseButtonsColor}}).build()},function(a){return a.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new e.mu({descriptor:se.expandCollapseButtonsSize,value:ue.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(a){return a.withCustomDisplayName("Visual_BubbleSize")})}),p.matrixLayouts||ve.addGroup("options",function(x){x.withDisplayName("Desktop_FileMenu_Options"),x.addSimpleSlice("stepped",new e.bd({descriptor:se.stepped,value:ue.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",m.getIndentationSliderBuilder(ue,L).build())}),ve.build()}},f.prototype.getIndentationSliderBuilder=function(s,n){return new e.JN({descriptor:fe.t.rowHeaders.steppedLayoutIndentation,value:s.steppedLayoutIndentation,localize:n,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},f.prototype.getTotalsCard=function(s,n,u,S){if(u===d.Y.TableEx){var k=(0,B.__rest)(u===d.Y.TableEx?ee.Z.total:fe.t.total,["outlineStyle","outlineWeight","outlineColor"]),D=n.total,re=new e.CQ(new e.lg("totals"),"Visual_Totals",k,function(Y){return s.getLocalizedString(Y)}),he=(new e.UN).withFontFamily({descriptor:k.fontFamily,value:D.fontFamily}).withFontSizeProperties({descriptor:k.fontSize,value:D.fontSize.pt}).withBold({descriptor:k.bold,value:D.bold}).withItalic({descriptor:k.italic,value:D.italic}).withUnderline({descriptor:k.underline,value:D.underline}).build();return re.addGroup("values",function(se){var Y;se.withDisplayName("Visual_Tablix_Values"),u===d.Y.TableEx?(se.addTopLevelToggle("gridVertical",function(){return new e.bd({descriptor:k.totals,value:n.general.totals}).build()}),Y=n.general.totals):Y=!0,Y&&se.addSimpleSlice("totalLabel",new e.fq({descriptor:k.label,value:D.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",he),se.addSimpleSlice("fontColor",function(){return new e.BT({descriptor:k.fontColor,value:{value:D.fontColor}}).build()},function(ue){return ue.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new e.BT({descriptor:k.backColor,value:{value:D.backColor}}).build()},function(ue){return ue.withCustomDisplayName("Background_Color")})}),re.build()}},f.prototype.getColumnGrandTotalsCard=function(s,n,u){if(u!==d.Y.TableEx){var L=(0,B.__rest)(fe.t.columnTotal,["outlineStyle","outline"]),R=n.columnGrandTotal,k=new e.CQ(new e.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",L,function(he){return s.getLocalizedString(he)}),re=(new e.UN).withFontFamily({descriptor:L.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:L.fontSize,value:R.fontSize.pt}).withBold({descriptor:L.bold,value:R.bold}).withItalic({descriptor:L.italic,value:R.italic}).withUnderline({descriptor:L.underline,value:R.underline}).build();return k.addGroup("values",function(ae){ae.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",re).addSimpleSlice("fontColor",function(){return new e.BT({descriptor:L.fontColor,value:{value:R.fontColor}}).build()},function(he){return he.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new e.BT({descriptor:L.backColor,value:{value:R.backColor}}).build()},function(he){return he.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new e.bd({descriptor:L.applyToHeaders,value:R.applyToHeaders}).build())}),k.build()}},f.prototype.getRowGrandTotalsCard=function(s,n,u){if(u!==d.Y.TableEx){var L=(0,B.__rest)(fe.t.rowTotal,["outlineStyle","outline"]),R=n.rowGrandTotal,k=new e.CQ(new e.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",L,function(he){return s.getLocalizedString(he)}),re=(new e.UN).withFontFamily({descriptor:L.fontFamily,value:R.fontFamily}).withFontSizeProperties({descriptor:L.fontSize,value:R.fontSize.pt}).withBold({descriptor:L.bold,value:R.bold}).withItalic({descriptor:L.italic,value:R.italic}).withUnderline({descriptor:L.underline,value:R.underline}).build();return k.addGroup("values",function(ae){ae.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",re).addSimpleSlice("fontColor",function(){return new e.BT({descriptor:L.fontColor,value:{value:R.fontColor}}).build()},function(he){return he.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new e.BT({descriptor:L.backColor,value:{value:R.backColor}}).build()},function(he){return he.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new e.bd({descriptor:L.applyToHeaders,value:R.applyToHeaders}).build())}),k.build()}},f.prototype.addAltTextGroup=function(s,n,u,S,b,p){_.isEmpty(S)||s.addGroup(n,function(m){m.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),m.addContainer("measure",function(L){L.withDisplayName(u);for(var R=function(he){var se;p===oe.r.rows||p===oe.r.columns?se={data:[(0,M.Yp)([p])]}:p===oe.r.values?se={data:[(0,U.Ue)(0)],metadata:he.queryName}:r.fF.assertFail("unexpected role"),L.addContainerItem(he.queryName,he.displayName,function(Y){return Y.addSimpleSlice("altTextColumns",new e.k0({descriptor:(0,B.__assign)((0,B.__assign)({},b.altTextColumns),{selector:se,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},k=0,D=S;k<D.length;k++)R(D[k])})})},f.prototype.getAccessibilityCardNew=function(s,n,u,S,b,p){r.fF.assert(function(){return p===d.Y.TableEx||p===d.Y.PivotTable});var m=p===d.Y.TableEx?ee.Z.accessibility:fe.t.accessibility,L=_.filter(s,F.pt),R=_.filter(n,F.pt),k=_.filter(u,F.pt),D=_.filter(u,function(se){return se.type.text}).map(function(se){return{displayName:se.displayName,value:se.queryName}});if(!(_.isEmpty(L)&&_.isEmpty(R)&&_.isEmpty(k))||p!==d.Y.PivotTable&&!_.isEmpty(D)){var ae=new e.CQ(new e.lg("accessibility"),"Accessibility",p===d.Y.TableEx?[m.altTextColumns,m.rowWithReferenceText]:[m.altTextColumns],function(Y){return S.getLocalizedString(Y)});if(this.addAltTextGroup(ae,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",L,m,oe.r.rows),this.addAltTextGroup(ae,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",R,m,oe.r.columns),this.addAltTextGroup(ae,"AltTextValues","Image_Alt_Text_Values",k,m,oe.r.values),p===d.Y.TableEx&&!_.isEmpty(D)){var he={displayName:S.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};D.unshift(he),ae.addGroup("rowWithReferenceText",function(se){var Y;se.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),se.addSimpleSlice("rowWithReferenceText",new e.uY({descriptor:(0,B.__assign)({},m.rowWithReferenceText),items:D,value:null!==(Y=_.find(D,function(ue){return ue.value===b.rowWithReferenceText.rowWithReferenceText}))&&void 0!==Y?Y:D[0]}).build())})}return ae.build()}},f.prototype.getAccessibilityCard=function(s,n,u,S){if(S===d.Y.TableEx){var b=ee.Z.accessibility,p=_.filter(s,F.pt),m=_.filter(s,function(D){return D.type.text}).map(function(D){return{displayName:D.displayName,value:D.queryName}});if(!_.isEmpty(p)||!_.isEmpty(m)){var R=new e.CQ(new e.lg("accessibility"),"Accessibility",[b.altTextColumns,b.rowWithReferenceText],function(re){return n.getLocalizedString(re)});if(_.isEmpty(p)||R.addGroup("AltTextValues",function(D){D.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),D.addContainer("measure",function(re){re.withDisplayName("Image_Alt_Text_Values");for(var ae=function(ve){re.addContainerItem(ve.queryName,ve.displayName,function(be){return be.addSimpleSlice("altTextColumns",new e.k0({descriptor:(0,B.__assign)((0,B.__assign)({},b.altTextColumns),{selector:{data:[(0,U.Ue)(0)],metadata:ve.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},he=0,se=p;he<se.length;he++)ae(se[he])})}),!_.isEmpty(m)){var k={displayName:n.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};m.unshift(k),R.addGroup("rowWithReferenceText",function(D){var re;D.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),D.addSimpleSlice("rowWithReferenceText",new e.uY({descriptor:(0,B.__assign)({},b.rowWithReferenceText),items:m,value:null!==(re=_.find(m,function(ae){return ae.value===u.rowWithReferenceText.rowWithReferenceText}))&&void 0!==re?re:m[0]}).build())})}return R.build()}}},f.prototype.getRowSubTotalsCard=function(s,n,u,S,b,p){var m=this;if(b||S===d.Y.PivotTable){var L=f.getMetadataObjects(u),R=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,L),k=function(Y){return s.getLocalizedString(Y)},D=fe.t.subTotals,re=(0,B.__assign)((0,B.__assign)({},n.subtotals),n.rowSubtotals),ae=new e.CQ(new e.lg("rowSubTotal"),"Visual_SubtotalRow",[D.rowSubtotalsLabel,D.rowSubtotals,D.rowSubtotalsPosition,D.perRowLevel,D.levelSubtotalEnabled,D.levelSubtotalLabel,D.fontColor,D.backColor,D.fontSize,D.fontFamily,D.bold,D.italic,D.underline,D.applyToHeaders],k);ae.addTopLevelToggle("rowSubtotals",function(){return new e.bd({descriptor:D.rowSubtotals,value:n.general.rowSubtotals}).build()});var he=0;return ae.addGroup("applySettingsTo",function(se){se.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new e.bd({descriptor:D.perRowLevel,value:R}).build(),function(Y){return Y.withDisabled(!m.shouldShowRowSubtotalsOption(u)).withCustomDescriptionIf(function(){return!m.shouldShowRowSubtotalsOption(u)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(Y){Y.withDisplayName("Visual_Tablix_Row_Level"),Y.addContainerItem("all",k("All"),function(N){return m.getRowSubtotalContainers(n,N,k,p,D,re,void 0,L)});for(var ue=0,ve=u.matrix.rows.levels;ue<ve.length;ue++)for(var Ce=function(j){if(!j.isMeasure){var q={metadata:j.queryName};Y.addContainerItem(j.displayName,j.displayName,function(ne){return m.getRowSubtotalContainers(n,ne,k,p,D,re,q,j.objects,he)}),he++}},x=0,a=ve[ue].sources;x<a.length;x++)Ce(a[x])})}),ae.build()}},f.prototype.getRowSubtotalContainers=function(s,n,u,S,b,p,m,L,R){var k=m?i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(L,!0):i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(L,!0),D=m?"":u(w.qT),re=m?b.levelSubtotalLabel:b.rowSubtotalsLabel;n.addGroup("rows",function(ae){ae.withDisplayName("Role_DisplayName_Rows"),ae.addSimpleSlice("levelSubtotalEnabled",new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},b.levelSubtotalEnabled),{selector:m}),value:i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,L)}).build(),function(he){return he.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!m)}).addSimpleSlice("rowSubtotalsLabel",new e.fq({descriptor:(0,B.__assign)((0,B.__assign)({},re),{selector:m}),value:k||D,placeholder:""}).build(),function(he){return he.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(m?"rowSubtotalsPositionSeries".concat(R):"rowSubtotalsPositionAll",new e.uY({descriptor:b.rowSubtotalsPosition,value:s.subtotals.rowSubtotalsPosition}).build(),function(he){return he.withCustomDisplayName("Visual_Position").withDisabled(!!m||S.matrixLayouts&&s.general.layout===V.t.Tabular)})}),n.addGroup("values",function(ae){if(ae.withDisplayName("Visual_Tablix_Values"),m)ae.withDisabled(!0,"");else{var he={id:"Row"},Y=(new e.UN).withFontFamily({descriptor:(0,B.__assign)((0,B.__assign)({},b.fontFamily),{selector:he}),value:p.fontFamily}).withFontSizeProperties({descriptor:(0,B.__assign)((0,B.__assign)({},b.fontSize),{selector:he}),value:p.fontSize.pt}).withBold({descriptor:(0,B.__assign)((0,B.__assign)({},b.bold),{selector:he}),value:p.bold}).withItalic({descriptor:(0,B.__assign)((0,B.__assign)({},b.italic),{selector:he}),value:p.italic}).withUnderline({descriptor:(0,B.__assign)((0,B.__assign)({},b.underline),{selector:he}),value:p.underline}).build();ae.addCompositeSlice("font","Font",Y).addSimpleSlice("fontColor",function(){var ue={value:p.fontColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},b.fontColor),{selector:he}),value:ue}).build()},function(ue){return ue.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var ue={value:p.backColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},b.backColor),{selector:he}),value:ue}).build()},function(ue){return ue.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},b.applyToHeaders),{selector:he}),value:p.applyToHeaders}).build())}})},f.prototype.getColumnSubtotalCard=function(s,n,u,S,b,p){var m=this;if(b||S===d.Y.PivotTable||this.shouldShowColumnSubtotalsOption(u)){var L=f.getMetadataObjects(u),R=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(L),k=function(se){return s.getLocalizedString(se)},D=fe.t.subTotals,re=(0,B.__assign)((0,B.__assign)({},n.subtotals),n.columnSubtotals),ae=new e.CQ(new e.lg("columnSubTotal"),"Visual_SubtotalColumn",[D.columnSubtotals,D.columnSubtotalsLabel,D.perColumnLevel,D.levelSubtotalEnabled,D.levelSubtotalLabel,D.fontColor,D.backColor,D.fontSize,D.fontFamily,D.bold,D.italic,D.underline,D.applyToHeaders],k);return ae.addTopLevelToggle("columnSubtotals",function(){return new e.bd({descriptor:D.columnSubtotals,value:n.general.columnSubtotals}).build()}),ae.addGroup("applySettingsTo",function(he){he.withContainerDisabled(!R).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new e.bd({descriptor:D.perColumnLevel,value:R}).build(),function(se){return se.withDisabled(!m.shouldShowColumnSubtotalsOption(u)).withCustomDescriptionIf(function(){return!m.shouldShowColumnSubtotalsOption(u)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(se){se.withDisplayName("Visual_Tablix_Column_Level"),se.addContainerItem("all",k("All"),function(P){return m.getColumnSubtotalContainers(P,k,p,D,re,void 0,L)});for(var Y=0,ue=u.matrix.columns.levels;Y<ue.length;Y++)for(var be=function(N){if(!N.isMeasure){var j={metadata:N.queryName};se.addContainerItem(N.displayName,N.displayName,function(q){return m.getColumnSubtotalContainers(q,k,p,D,re,j,N.objects)})}},Ce=0,x=ue[Y].sources;Ce<x.length;Ce++)be(x[Ce])})}),ae.build()}},f.prototype.getColumnSubtotalContainers=function(s,n,u,S,b,p,m){var L=n(w.qT),R=p?i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(m,!0):i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(m,!0),k=p?S.levelSubtotalLabel:S.columnSubtotalsLabel;s.addGroup("columns",function(D){D.withDisplayName("Role_DisplayName_Columns"),D.addSimpleSlice("levelSubtotalEnabled",new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},S.levelSubtotalEnabled),{selector:p}),value:i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,m)}).build(),function(re){return re.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!p)}).addSimpleSlice("columnSubtotalsLabel",new e.fq({descriptor:(0,B.__assign)((0,B.__assign)({},k),{selector:p}),value:R||L,placeholder:""}).build(),function(re){return re.withCustomDisplayName("Visual_Subtotal_Label")})}),s.addGroup("values",function(D){if(D.withDisplayName("Visual_Tablix_Values"),p)D.withDisabled(!0,"");else{var re={id:"Column"},he=(new e.UN).withFontFamily({descriptor:(0,B.__assign)((0,B.__assign)({},S.fontFamily),{selector:re}),value:b.fontFamily}).withFontSizeProperties({descriptor:(0,B.__assign)((0,B.__assign)({},S.fontSize),{selector:re}),value:b.fontSize.pt}).withBold({descriptor:(0,B.__assign)((0,B.__assign)({},S.bold),{selector:re}),value:b.bold}).withItalic({descriptor:(0,B.__assign)((0,B.__assign)({},S.italic),{selector:re}),value:b.italic}).withUnderline({descriptor:(0,B.__assign)((0,B.__assign)({},S.underline),{selector:re}),value:b.underline}).build();D.addCompositeSlice("font","Font",he).addSimpleSlice("fontColor",function(){var se={value:b.fontColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},S.fontColor),{selector:re}),value:se}).build()},function(se){return se.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var se={value:b.backColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},S.backColor),{selector:re}),value:se}).build()},function(se){return se.withCustomDisplayName("Background_Color")}),D.addSimpleSlice("applyToHeaders",new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},S.applyToHeaders),{selector:re}),value:b.applyToHeaders}).build())}})},f.prototype.getColumnFormattingCard=function(s,n,u,S){if(!_.isEmpty(u)){var L=(0,B.__rest)(S===d.Y.TableEx?ee.Z.columnFormatting:fe.t.columnFormatting,["dataBars"]),R=n.columnFormatting,k=new e.CQ(new e.lg("columnFormatting"),"Visual_Tablix_Specific_Column",L,function(re){return s.getLocalizedString(re)});return k.withDescription("Visual_Matrix_SpecificColumn_Description"),k.addGroup("columns",function(D){D.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(re){re.withDisplayName("Series");for(var ae=function(ve){var be=ve&&ve.objects;re.addContainerItem(ve.queryName,ve.displayName,function(Ce){Ce.addSimpleSlice(L.styleHeader,new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},L.styleHeader),{selector:{metadata:ve.queryName}}),value:R[ve.queryName].styleHeader}).build()),S===d.Y.PivotTable&&Ce.addSimpleSlice(L.styleSubtotals,new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},L.styleSubtotals),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,be)}).build()),Ce.addSimpleSlice(L.styleTotal,new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},L.styleTotal),{selector:{metadata:ve.queryName}}),value:R[ve.queryName].styleTotal}).build()).addSimpleSlice(L.styleValues,new e.bd({descriptor:(0,B.__assign)((0,B.__assign)({},L.styleValues),{selector:{metadata:ve.queryName}}),value:R[ve.queryName].styleValues}).build()),Ce.addGroup("values",function(x){if(x.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var P={value:R[ve.queryName].fontColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},L.fontColor),{selector:{metadata:ve.queryName}}),value:P}).build()},function(P){return P.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var P={value:R[ve.queryName].backColor};return new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},L.backColor),{selector:{metadata:ve.queryName}}),value:P}).build()},function(P){return P.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new e.Gp({descriptor:(0,B.__assign)((0,B.__assign)({},L.alignment),{selector:{metadata:ve.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:R[ve.queryName].alignment}).build()),ve.type.numeric&&(S===d.Y.PivotTable||S===d.Y.TableEx)){var a=ve&&ve.objects;x.addSimpleSlice("labelDisplayUnits",new e.uY({descriptor:(0,B.__assign)((0,B.__assign)({},L.labelDisplayUnits),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,a)}).build()).addSimpleSlice("labelPrecision",new e.mu({descriptor:(0,B.__assign)((0,B.__assign)({},L.labelPrecision),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,a),options:{minValue:{type:0,value:0},maxValue:{type:1,value:E.vo}}}).build())}})})},he=0,se=u;he<se.length;he++)ae(se[he])})}),k.build()}},f.prototype.getCellColumnCard=function(s,n,u,S){var m=(0,ee.k)().objects,L=[];return this.enumerateObjectRepetition(L,u,n,S),(0,le.Z)(L,function(k){return s.getLocalizedString(k)},m,"Cell_Elements","Visual_Matrix_CellElements_Description")},f.prototype.getUrlIconCard=function(s,n,u){var S=u===d.Y.TableEx?ee.Z.values.urlIcon:fe.t.values.urlIcon,b=n,p=fe.t.columnHeaders.urlIcon,m=fe.t.rowHeaders.urlIcon,R=new e.CQ(new e.lg("urlIcon"),"Visual_Tablix_UrlIcon",[S,p,m],function(D){return s.getLocalizedString(D)});return R.addGroup("urlIcon",function(k){(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&k.addSimpleSlice("values",new e.bd({descriptor:S,value:n.values.urlIcon}).build(),function(D){return D.withCustomDisplayName("Visual_Tablix_Values")}),u===d.Y.PivotTable&&k.addSimpleSlice("columnheaders",new e.bd({descriptor:p,value:b.columnHeaders.urlIcon}).build(),function(D){return D.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new e.bd({descriptor:m,value:b.rowHeaders.urlIcon}).build(),function(D){return D.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),R.build()},f.prototype.getImageSizeCard=function(s,n,u,S){var b=u===d.Y.TableEx?ee.Z.grid.imageHeight:fe.t.grid.imageHeight,p=u===d.Y.TableEx?ee.Z.grid.imageWidth:fe.t.grid.imageWidth,L=new e.CQ(new e.lg("imageHeight"),"Visual_Tablix_ImageSize",[b,p],function(k){return s.getLocalizedString(k)});return L.addGroup("imageHeight",function(R){R.addSimpleSlice("imageHeight",new e.mu({descriptor:b,value:n.grid.imageHeight,options:{minValue:{type:0,value:f.ImageSizeMin},maxValue:{type:1,value:f.ImageSizeMax},unitSymbol:Q.e_}}).build()),S.tablixImageWidth&&R.addSimpleSlice("imageWidth",new e.mu({descriptor:p,value:n.grid.imageWidth,options:{minValue:{type:0,value:f.ImageSizeMin},maxValue:{type:1,value:f.ImageSizeMax},unitSymbol:Q.e_}}).build())}),L.build()},f.prototype.getSparklinesCard=function(s,n,u){var S=this;if(!_.isEmpty(s)&&this.hasSparklines(s)){var b=function(L){return n.getLocalizedString(L)},p=u===d.Y.TableEx?ee.Z.sparklines:fe.t.sparklines;return new e.CQ(new e.lg("sparklines"),"Sparkline_Label",p,b).addGroup("columns",function(m){return m.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(L){var R;L.withDisplayName("Sparkline_Singular_Label");for(var k=function(se){if(!(null===(R=se.type.misc)||void 0===R?void 0:R.sparkline))return"continue";var ue=se?.objects,ve={metadata:se.queryName};L.addContainerItem(se.queryName,se.displayName,function(be){var Ce=i.FX.PropSparklinesChartType.setInstanceProperty(void 0,ue);be.addGroup("sparklines",function(x){return x.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new e.uY({descriptor:(0,B.__assign)((0,B.__assign)({},p.chartType),{selector:ve}),value:Ce}).build()).addSimpleSlice("dataColor",new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},p.dataColor),{selector:ve}),value:{value:S.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,ue).solid.color}}).build()).addSimpleSlice("strokeWidth",new e.JN({descriptor:(0,B.__assign)((0,B.__assign)({},p.strokeWidth),{selector:ve}),value:i.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,ue),localize:b,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(a){return a.withHidden(Ce!==C.U.line)})}),Ce===C.U.line&&be.addGroup("markers",function(x){var a=i.FX.PropSparklinesMarkerType.getValue(ue);x.withDisplayName("Marker").addSimpleSlice("markers",new e.oM({descriptor:(0,B.__assign)((0,B.__assign)({},p.markers),{selector:ve}),value:a}).build()),null!=a&&0!==a&&x.addSimpleSlice("markerColor",new e.BT({descriptor:(0,B.__assign)((0,B.__assign)({},p.markerColor),{selector:ve}),value:{value:S.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,ue).solid.color}}).build()).addSimpleSlice("markerShape",new e.uY({descriptor:(0,B.__assign)((0,B.__assign)({},p.markerShape),{selector:ve}),value:i.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,ue)}).build()).addSimpleSlice("markerSize",new e.JN({descriptor:(0,B.__assign)((0,B.__assign)({},p.markerSize),{selector:ve}),value:i.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,ue),localize:b,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},D=0,re=s;D<re.length;D++)k(re[D])})}).build()}},f.prototype.hasSparklines=function(s){for(var n,u=0,S=s;u<S.length;u++)if(null===(n=S[u].type.misc)||void 0===n?void 0:n.sparkline)return!0;return!1},f.prototype.enumerateObjectInstances=function(s,n,u,S,b,p,m,L){void 0===p&&(p={}),void 0===m&&(m=!1),r.fF.assertValue(u,"dataView can't be undefined");var D,R=f.getMetadataObjects(u),k=this.getTablixTextClassProperties(L);switch(D=S===d.Y.Table?this.shouldShowTableTotalsOption(u)&&i.FX.PropGeneralTableTotals.getValue(R):this.shouldShowColumnSubtotalsOption(u)&&i.FX.PropGeneralMatrixColumnSubtotals.getValue(R)||this.shouldShowRowSubtotalsOption(u)&&i.FX.PropGeneralMatrixRowSubtotals.getValue(R),s.objectName){case i.FX.ObjectGeneral:this.enumerateGeneralOptions(n,R,S,u);break;case i.FX.ObjectGrid:this.enumerateGridOptions(n,R,S,k,p);break;case i.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(n,R,S,k,p);break;case i.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(n,R,S,m,k,p);break;case i.FX.ObjectValues:this.enumerateValuesOptions(n,R,S,k,p);break;case i.FX.ObjectTotal:S===d.Y.TableEx?this.enumerateTotalOptions(n,R,d.Y.TableEx,b,p,k):D&&(S===d.Y.Table?this.enumerateTotalOptions(n,R,d.Y.TableEx,b,p,k):this.enumerateGrandTotalOptions(n,R,S,k));break;case i.FX.ObjectColumnTotal:S===d.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(n,R,k,p);break;case i.FX.ObjectRowTotal:S===d.Y.PivotTable&&this.enumerateRowGrandTotalOptions(n,R,k,p);break;case i.FX.ObjectSubTotals:(D||S===d.Y.PivotTable)&&this.enumerateSubTotalsOptions(n,R,S,u,b,p,k);break;case i.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(n,this.getColumnsMetadata(u,S),S);break;case i.FX.ObjectSparklines:this.enumerateSparklines(n,this.getColumnsMetadata(u,S))}},f.prototype.getColumnsMetadata=function(s,n){switch(n){case d.Y.Table:case d.Y.TableEx:return this.getTableColumnMetadata(s);case d.Y.Matrix:case d.Y.PivotTable:return this.getMatrixValuesColumnMetadata(s);default:return void r.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+n)}},f.prototype.getTableColumnMetadata=function(s){if(s&&s.table&&!_.isEmpty(s.table.columns))return s.table.columns},f.prototype.getMatrixRowsColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.rows)){for(var n=[],u=0,S=s.matrix.rows.levels;u<S.length;u++)for(var p=0,m=S[u].sources;p<m.length;p++)n.push(m[p]);return n}},f.prototype.getMatrixColumnsColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.columns)){for(var n=[],u=0,S=s.matrix.columns.levels;u<S.length;u++)for(var p=0,m=S[u].sources;p<m.length;p++)n.push(m[p]);return n}},f.prototype.getMatrixValuesColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.valueSources))return s.matrix.valueSources},f.prototype.createVisualObjectInstance=function(s,n,u){void 0===n&&(n=null);var S={selector:n,objectName:s,properties:{}};return null!=u&&(S.displayName=u),S},f.prototype.enumerateGeneralOptions=function(s,n,u,S){var b=this.createVisualObjectInstance(i.FX.ObjectGeneral);switch(u){case d.Y.Table:i.FX.PropGeneralAutoSizeColumns.setInstanceProperty(b,n),i.FX.PropGeneralTextSize.setInstanceProperty(b,n),this.shouldShowTableTotalsOption(S)&&i.FX.PropGeneralTableTotals.setInstanceProperty(b,n);break;case d.Y.Matrix:i.FX.PropGeneralAutoSizeColumns.setInstanceProperty(b,n),i.FX.PropGeneralTextSize.setInstanceProperty(b,n),this.shouldShowRowSubtotalsOption(S)&&i.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(b,n),this.shouldShowColumnSubtotalsOption(S)&&i.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(b,n)}s.pushInstance(b)},f.prototype.enumerateGridOptions=function(s,n,u,S,b){var p=this.createVisualObjectInstance(i.FX.ObjectGrid),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt,L=i.FX.PropGridVertical.getValue(n);i.FX.PropGridVertical.setInstanceProperty(p,n),L&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(p,n),i.FX.PropGridVerticalWeight.setInstanceProperty(p,n));var R=u===d.Y.Table||u===d.Y.TableEx,k=(R?i.FX.PropGridHorizontalTable:i.FX.PropGridHorizontalMatrix).getValue(n);(R?i.FX.PropGridHorizontalTable:i.FX.PropGridHorizontalMatrix).setInstanceProperty(p,n),k&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(p,n),i.FX.PropGridHorizontalWeight.setInstanceProperty(p,n)),i.FX.PropGridRowPadding.setInstanceProperty(p,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropGridOutlineStyle.setInstanceProperty(p,n,this.outlineOverrideFn,i.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(p,n),i.FX.PropGridOutlineWeight.setInstanceProperty(p,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropGridPivotTableTextSize.setInstanceProperty(p,n,S.fontSizeOverrideFn,m),i.FX.PropGridImageHeight.setInstanceProperty(p,n),s.pushInstance(p)},f.prototype.enumerateColumnHeadersOptions=function(s,n,u,S,b){var p=this.createVisualObjectInstance(i.FX.ObjectColumnHeaders),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(p,n,S.fontColorOverrideFn,S.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(p,n),u===d.Y.PivotTable||u===d.Y.TableEx){var R=this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(n),n,i.UR);i.FX.PropColumnsOutlineStyle.setInstanceProperty(p,n,this.outlineOverrideFn,R);var k=this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(n),n);i.FX.PropColumnsOutlineWeight.setInstanceProperty(p,n,this.outlineOverrideFn,k);var D=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(n),n);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(p,n,this.outlineOverrideFn,D),i.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(p,n),i.FX.PropColumnsFontFamily.setInstanceProperty(p,n,S.fontFamilyOverrideFn,S.labelFontProperties.family),i.FX.PropColumnsFontSize.setInstanceProperty(p,n,S.fontSizeOverrideFn,m),i.FX.PropColumnsBold.setInstanceProperty(p,n),i.FX.PropColumnsItalic.setInstanceProperty(p,n),i.FX.PropColumnsUnderline.setInstanceProperty(p,n),i.FX.PropColumnsAlignment.setInstanceProperty(p,n)}else i.FX.PropColumnsOutline.setInstanceProperty(p,n);u===d.Y.PivotTable&&(i.FX.PropColumnsAlignmentTitle.setInstanceProperty(p,n),i.FX.PropColumnsUrlIcon.setInstanceProperty(p,n)),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&i.FX.PropColumnsWordWrap.setInstanceProperty(p,n),s.pushInstance(p)},f.prototype.enumerateRowHeadersOptions=function(s,n,u,S,b,p){void 0===S&&(S=!1);var m=this.createVisualObjectInstance(i.FX.ObjectRowHeaders),L=b.labelFontProperties.size&&b.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(m,n,b.fontColorOverrideFn,b.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(m,n),u===d.Y.PivotTable||u===d.Y.TableEx){var k=this.ensureOutline(i.FX.PropRowsOutlineStyle.getValue(n),n,i.Pi);i.FX.PropRowsOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,k)}else i.FX.PropRowsOutline.setInstanceProperty(m,n);if(u===d.Y.PivotTable){var D=this.ensureOutlineWeight(i.FX.PropRowsOutlineWeight.getValue(n),n);i.FX.PropRowsOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,D);var re=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(n),n);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,re),i.FX.PropRowsSteppedLayout.setInstanceProperty(m,n)&&i.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(m,n),i.FX.PropRowsUrlIcon.setInstanceProperty(m,n),i.FX.PropGeneralMatrixLayout.setInstanceProperty(m,n)!==V.t.Compact&&i.FX.PropRowsRepeatRowHeaders.setInstanceProperty(m,n)}(u===d.Y.Matrix||u===d.Y.PivotTable)&&i.FX.PropRowsWordWrap.setInstanceProperty(m,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropRowsFontFamily.setInstanceProperty(m,n,b.fontFamilyOverrideFn,b.labelFontProperties.family),i.FX.PropRowsFontSize.setInstanceProperty(m,n,b.fontSizeOverrideFn,L),i.FX.PropRowsBold.setInstanceProperty(m,n),i.FX.PropRowsItalic.setInstanceProperty(m,n),i.FX.PropRowsUnderline.setInstanceProperty(m,n),i.FX.PropRowsAlignment.setInstanceProperty(m,n)),u===d.Y.PivotTable&&S&&(i.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(m,n),i.FX.PropRowsShowExpandCollapseButtons.getValue(n)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(m,n),i.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(m,n))),s.pushInstance(m)},f.prototype.enumerateValuesOptions=function(s,n,u,S,b){var p=this.createVisualObjectInstance(i.FX.ObjectValues),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(p,n,S.fontColorOverrideFn,S.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(p,n),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(p,n),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(p,n),u===d.Y.PivotTable&&(i.FX.PropValuesBandedRowHeaders.setInstanceProperty(p,n),i.FX.PropValuesOnRow.setInstanceProperty(p,n)),u===d.Y.PivotTable||u===d.Y.TableEx){var R=this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(n),n,i.IC);i.FX.PropValuesOutlineStyle.setInstanceProperty(p,n,this.outlineOverrideFn,R);var k=this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(n),n);i.FX.PropValuesOutlineWeight.setInstanceProperty(p,n,this.outlineOverrideFn,k);var D=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(n),n);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(p,n,this.outlineOverrideFn,D)}else i.FX.PropValuesOutline.setInstanceProperty(p,n);(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&i.FX.PropValuesUrlIcon.setInstanceProperty(p,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropValuesWordWrap.setInstanceProperty(p,n),i.FX.PropValuesFontFamily.setInstanceProperty(p,n,S.fontFamilyOverrideFn,S.labelFontProperties.family),i.FX.PropValuesFontSize.setInstanceProperty(p,n,S.fontSizeOverrideFn,m),i.FX.PropValuesBold.setInstanceProperty(p,n),i.FX.PropValuesItalic.setInstanceProperty(p,n),i.FX.PropValuesUnderline.setInstanceProperty(p,n)),s.pushInstance(p)},f.prototype.enumerateTotalOptions=function(s,n,u,S,b,p){var m=this.createVisualObjectInstance(i.FX.ObjectTotal),L=p.boldLabelFontProperties.size&&p.boldLabelFontProperties.size.pt;if(u!==d.Y.TableEx||i.FX.PropTotalTableExTotals.setInstanceProperty(m,n)){if(u===d.Y.TableEx){var k=i.FX.PropTotalTableExTotalLabel.getValue(n,!0)||S(w.qT);m.properties[i.FX.PropTotalTableExTotalLabel.propertyName]=k}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(m,n,p.fontColorOverrideFn,p.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(m,n),u===d.Y.PivotTable||u===d.Y.TableEx){var re=this.ensureOutline(i.FX.PropTotalOutlineStyle.getValue(n),n,i.Sc);i.FX.PropTotalOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,re)}else i.FX.PropTotalOutline.setInstanceProperty(m,n);if(u===d.Y.TableEx){var ae=this.ensureOutlineWeight(i.FX.PropTotalOutlineWeight.getValue(n),n);i.FX.PropTotalOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,ae);var he=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(n),n);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,he)}(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropTotalFontFamily.setInstanceProperty(m,n,p.fontFamilyOverrideFn,p.boldLabelFontProperties.family),i.FX.PropTotalFontSize.setInstanceProperty(m,n,p.fontSizeOverrideFn,L),i.FX.PropTotalBold.setInstanceProperty(m,n),i.FX.PropTotalItalic.setInstanceProperty(m,n),i.FX.PropTotalUnderline.setInstanceProperty(m,n))}s.pushInstance(m)},f.prototype.enumerateGrandTotalOptions=function(s,n,u,S){if(u!==d.Y.PivotTable){var b=this.createVisualObjectInstance(i.FX.ObjectTotal),p=S.boldLabelFontProperties.size&&S.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(b,n,S.fontColorOverrideFn,S.boldLabelFontProperties.color),i.FX.PropGrandTotalFontFamily.setInstanceProperty(b,n),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(b,n),i.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(b,n),u===d.Y.TableEx&&(i.FX.PropGrandTotalFontFamily.setInstanceProperty(b,n,S.fontFamilyOverrideFn,S.boldLabelFontProperties.family),i.FX.PropGrandTotalFontSize.setInstanceProperty(b,n,S.fontSizeOverrideFn,p),i.FX.PropGrandTotalBold.setInstanceProperty(b,n),i.FX.PropGrandTotalItalic.setInstanceProperty(b,n),i.FX.PropGrandTotalUnderline.setInstanceProperty(b,n)),s.pushInstance(b)}},f.prototype.enumerateColumnGrandTotalOptions=function(s,n,u,S){var b=this.createVisualObjectInstance(i.FX.ObjectColumnTotal),p=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(b,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color),i.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(b,n),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(b,n),i.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(b,n),i.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(b,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family),i.FX.PropColumnGrandTotalFontSize.setInstanceProperty(b,n,u.fontSizeOverrideFn,p),i.FX.PropColumnGrandTotalBold.setInstanceProperty(b,n),i.FX.PropColumnGrandTotalItalic.setInstanceProperty(b,n),i.FX.PropColumnGrandTotalUnderline.setInstanceProperty(b,n),s.pushInstance(b)},f.prototype.enumerateRowGrandTotalOptions=function(s,n,u,S){var b=this.createVisualObjectInstance(i.FX.ObjectRowTotal),p=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(b,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color),i.FX.PropRowGrandTotalFontFamily.setInstanceProperty(b,n),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(b,n),i.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(b,n),i.FX.PropRowGrandTotalFontFamily.setInstanceProperty(b,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family),i.FX.PropRowGrandTotalFontSize.setInstanceProperty(b,n,u.fontSizeOverrideFn,p),i.FX.PropRowGrandTotalBold.setInstanceProperty(b,n),i.FX.PropRowGrandTotalItalic.setInstanceProperty(b,n),i.FX.PropRowGrandTotalUnderline.setInstanceProperty(b,n),s.pushInstance(b)},f.prototype.enumerateSubTotalsOptions=function(s,n,u,S,b,p,m){var k,D,re,L=!1,R=!1;if(u===d.Y.PivotTable){r.fF.assertValue(b,"enumerateSubTotalsOptions - localizer"),k=b(w.qT);var ae=this.createVisualObjectInstance(i.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(S)&&(L=i.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(ae,n)),L&&(D=i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(n,!0)||k,ae.properties[i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=D),s.pushInstance(ae)}if(this.enumerateSubtotalsFontProperties(s,n,m,p,u,"Row"),L){ae=this.createVisualObjectInstance(i.FX.ObjectSubTotals),i.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(ae,n),s.pushInstance(ae),ae=this.createVisualObjectInstance(i.FX.ObjectSubTotals);var he=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(ae,n);s.pushInstance(ae,!1),he&&this.enumeratePerLevelSubtotals(s,S.matrix.rows.levels,D,b)}u===d.Y.PivotTable&&(ae=this.createVisualObjectInstance(i.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(S)&&(R=i.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(ae,n)),R&&(re=i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(n,!0)||k,ae.properties[i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=re),s.pushInstance(ae,!1)),this.enumerateSubtotalsFontProperties(s,n,m,p,u,"Column"),R&&(ae=this.createVisualObjectInstance(i.FX.ObjectSubTotals),he=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(ae,n),s.pushInstance(ae,!1),r.fF.assert(function(){return!_.isEmpty(S.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),he&&this.enumeratePerLevelSubtotals(s,S.matrix.columns.levels,re,b))},f.prototype.enumerateSubtotalsFontProperties=function(s,n,u,S,b,p){var L=this.createVisualObjectInstance(i.FX.ObjectSubTotals,p?{id:p}:void 0),R=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(L,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color,p),i.FX.PropSubTotalsFontFamily.setInstanceProperty(L,n,void 0,void 0,p),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(L,n,void 0,void 0,p),b===d.Y.PivotTable&&(i.FX.PropSubTotalsFontFamily.setInstanceProperty(L,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family,p),i.FX.PropSubTotalsFontSize.setInstanceProperty(L,n,u.fontSizeOverrideFn,R,p),i.FX.PropSubTotalsBold.setInstanceProperty(L,n,void 0,void 0,p),i.FX.PropSubTotalsItalic.setInstanceProperty(L,n,void 0,void 0,p),i.FX.PropSubTotalsUnderline.setInstanceProperty(L,n,void 0,void 0,p),i.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(L,n,void 0,void 0,p)),s.pushInstance(L)},f.prototype.enumeratePerLevelSubtotals=function(s,n,u,S){r.fF.assert(function(){return!_.isEmpty(n)},"enumeratePerLevelSubtotals: Empty levels");for(var b=0,p=n;b<p.length;b++)for(var L=0,R=p[b].sources;L<R.length;L++){var k=R[L];if(!k.isMeasure){var D=this.createVisualObjectInstance(i.FX.ObjectSubTotals,{metadata:k.queryName},k.displayName);i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(D,k.objects),s.pushInstance(D,!1),D=this.createVisualObjectInstance(i.FX.ObjectSubTotals,{metadata:k.queryName},S("Visual_PivotTable_TotalLabel",k.displayName));var re=i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(k.objects,!0)||u;D.properties[i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=re,s.pushInstance(D,!1)}}},f.prototype.enumerateColumnFormattingOptions=function(s,n,u){if(!_.isEmpty(n))for(var S=0,b=n;S<b.length;S++){var p=b[S];s.pushContainer({displayName:p.displayName});var m=p&&p.objects,L=this.createVisualObjectInstance(i.FX.ObjectColumnFormatting,{metadata:p.queryName});p.type.numeric&&(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(L,m),i.FX.PropColumnFormattingPrecision.setInstanceProperty(L,m),i.FX.PropColumnFormattingPrecision.setInstanceValidValues(L,{numberRange:{min:0,max:E.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(L,m),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(L,m),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropColumnFormattingAlignment.setInstanceProperty(L,m),i.FX.PropColumnFormattingStyleHeader.setInstanceProperty(L,m),i.FX.PropColumnFormattingStyleValues.setInstanceProperty(L,m),(u===d.Y.Matrix||u===d.Y.PivotTable)&&i.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(L,m),i.FX.PropColumnFormattingStyleTotal.setInstanceProperty(L,m),s.pushInstance(L),s.popContainer()}},f.prototype.enumerateSparklines=function(s,n){var u;if(!_.isEmpty(n))for(var S=0,b=n;S<b.length;S++){var p=b[S];if(null===(u=p.type.misc)||void 0===u?void 0:u.sparkline){s.pushContainer({displayName:p.displayName});var L=p&&p.objects,R=this.createVisualObjectInstance(i.FX.ObjectSparklines,{metadata:p.queryName});if(i.FX.PropSparklinesChartType.setInstanceProperty(R,L),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(R,L),i.FX.PropSparklinesChartType.getValue(L)===C.U.line){i.FX.PropSparklinesStrokeWidth.setInstanceProperty(R,L),i.FX.PropSparklinesStrokeWidth.setInstanceValidValues(R,{numberRange:{min:1,max:4}}),i.FX.PropSparklinesMarkerType.setInstanceProperty(R,L);var k=i.FX.PropSparklinesMarkerType.getValue(L);null!=k&&0!==k&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(R,L),i.FX.PropSparklinesMarkerSize.setInstanceProperty(R,L),i.FX.PropSparklinesMarkerSize.setInstanceValidValues(R,{numberRange:{min:3,max:5}}),i.FX.PropSparklinesMarkerShape.setInstanceProperty(R,L))}s.pushInstance(R),s.popContainer()}}},f.prototype.getTableObjects=function(s){var n=f.getMetadataObjects(s),u=i.FX.PropGeneralTextSize.getValue(n),S=null!=u?O.B.createFromPt(+u):void 0,b={general:{autoSizeColumnWidth:i.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:S,totals:i.FX.PropGeneralTableTotals.getValue(n)}};b.grid={gridVertical:i.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:i.FX.PropGridHorizontalTable.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:i.FX.PropGridOutlineWeight.getValue(n),rowPadding:i.FX.PropGridRowPadding.getValue(n),imageHeight:i.FX.PropGridImageHeight.getValue(n)},b.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:i.FX.PropColumnsOutline.getValue(n),wordWrap:i.FX.PropColumnsWordWrap.getValue(n)},b.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:i.FX.PropValuesOutline.getValue(n),urlIcon:i.FX.PropValuesUrlIcon.getValue(n)},b.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(n),backColor:this.tablixProperties.PropTotalBackColor.getValue(n),outline:i.FX.PropTotalOutline.getValue(n)},b.columnFormatting={},b.formatters={};var p=this.getTableColumnMetadata(s);if(p)for(var m=0,L=p;m<L.length;m++){var R=L[m],k=R&&R.objects;b.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(k),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(k),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(k),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(k),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(k)},b.formatters[R.queryName]=new c.g({column:R,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1})}return b},f.prototype.getMatrixObjects=function(s){var n=f.getMetadataObjects(s),u=i.FX.PropGeneralTextSize.getValue(n),S=null!=u?O.B.createFromPt(+u):void 0,b={general:{autoSizeColumnWidth:i.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:S,rowSubtotals:i.FX.PropGeneralMatrixRowSubtotals.getValue(n),columnSubtotals:i.FX.PropGeneralMatrixColumnSubtotals.getValue(n),layout:i.FX.PropGeneralMatrixLayout.getValue(n)}};b.grid={gridVertical:i.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:i.FX.PropGridHorizontalMatrix.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:i.FX.PropGridOutlineWeight.getValue(n),rowPadding:i.FX.PropGridRowPadding.getValue(n),imageHeight:i.FX.PropGridImageHeight.getValue(n)},b.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:i.FX.PropColumnsOutline.getValue(n)},b.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(n),backColor:this.tablixProperties.PropRowsBackColor.getValue(n),outline:i.FX.PropRowsOutline.getValue(n),wordWrap:i.FX.PropRowsWordWrap.getValue(n),repeatRowHeaders:i.FX.PropRowsRepeatRowHeaders.getValue(n)},b.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:i.FX.PropValuesOutline.getValue(n)},b.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(n),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(n),applyToHeaders:i.FX.PropGrandTotalApplyToHeaders.getValue(n)},b.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(n),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(n)},b.columnFormatting={},b.formatters={};var p=this.getMatrixValuesColumnMetadata(s);if(p)for(var m=0,L=p;m<L.length;m++){var R=L[m],k=R&&R.objects;b.columnFormatting[R.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(k),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(k),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(k),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(k),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(k),styleSubTotals:i.FX.PropColumnFormattingStyleSubtotals.getValue(k)},b.formatters[R.queryName]=new c.g({column:R,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(s.matrix.rows,b.formatters),this.addMatrixHierarchyColumnsFormatters(s.matrix.columns,b.formatters),b},f.prototype.addMatrixHierarchyColumnsFormatters=function(s,n,u){if(s){r.fF.assertValue(s.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var S=0,b=s.levels;S<b.length;S++){var p=b[S];r.fF.assertValue(p.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var m=0,L=p.sources;m<L.length;m++){var R=L[m];if(!R.isMeasure){var k=R.queryName;n[k]=new c.g({column:R,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1}),u&&(u[k]=new c.g({column:R,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},f.prototype.addMatrixHierarchySubtotalLabels=function(s,n,u,S){if(s){r.fF.assertValue(s.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var b=0,p=s.levels;b<p.length;b++){var m=p[b];r.fF.assertValue(m.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var L=void 0,R=0,k=m.sources;R<k.length;R++){var D=k[R];D.isMeasure||(S&&(L=i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(D.objects)),L||(L=u),n[D.queryName]={subtotalLabel:L})}}}},f.prototype.getPivotTableObjects=function(s,n,u,S,b,p){var m,L,R,k,D,re,ae,he,se;void 0===p&&(p=!1);var Y=f.getMetadataObjects(s),ue=this.getTablixTextClassProperties(S),ve=ue.labelFontProperties.size&&ue.labelFontProperties.size.pt,be=ue.boldLabelFontProperties.size&&ue.boldLabelFontProperties.size.pt,Ce=i.FX.PropGridPivotTableTextSize.getValue(Y,void 0,ue.fontSizeOverrideFn,ve),x=null!=Ce?O.B.createFromPt(+Ce):void 0,a=i.FX.PropColumnsFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,ve),P=null!=a?O.B.createFromPt(+a):void 0,N=i.FX.PropRowsFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,ve),j=null!=N?O.B.createFromPt(+N):void 0,q=i.FX.PropRowsExpandCollapseButtonsSize.getValue(Y),ne=null!=q?O.B.createFromPt(+q):void 0,de=i.FX.PropRowsExpandCompositeHierarchy.getValue(Y),pe=i.FX.PropValuesFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,ve),ge=null!=pe?O.B.createFromPt(+pe):void 0,A=i.FX.PropGrandTotalFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be),ie=(null!=A&&O.B.createFromPt(+A),i.FX.PropColumnGrandTotalFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be,void 0,["Column"])),ce=null!=ie?O.B.createFromPt(+ie):void 0,me=i.FX.PropRowGrandTotalFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be,void 0,["Row"]),ye=null!=me?O.B.createFromPt(+me):void 0,Pe=i.FX.PropSubTotalsFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be),He=(null!=Pe&&O.B.createFromPt(+Pe),i.FX.PropSubTotalsFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be,"Row")),xe=null!=He?O.B.createFromPt(+He):void 0,Fe=i.FX.PropSubTotalsFontSize.getValue(Y,void 0,ue.fontSizeOverrideFn,be,"Column"),Ve=null!=Fe?O.B.createFromPt(+Fe):void 0,Ie=n(w.qT),_e=i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(Y)||Ie,We=i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(Y)||Ie,Ne=i.FX.PropRowsSteppedLayout.getValue(Y),Ee=i.FX.PropGeneralMatrixLayout.getValue(Y)||(Ne?V.t.Compact:V.t.Outline);b.matrixLayouts&&(Ne=Ee===V.t.Compact);var Oe={showBlankRows:i.FX.PropBlankRowsShowBlankRows.getValue(Y),blankRowColor:null!==(m=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(Y))&&void 0!==m?m:this.tablixProperties.PropValuesBackColorPrimary.getValue(Y),blankRowTransparency:i.FX.PropBlankRowsTransparency.getValue(Y),showBorder:i.FX.PropBlankRowsShowBorder.getValue(Y),borderPosition:null!==(L=i.FX.PropBlankRowsBorderPosition.getValue(Y))&&void 0!==L?L:"Top",borderColor:null!==(R=this.tablixProperties.PropBlankRowsBorderColor.getValue(Y))&&void 0!==R?R:S.colorPalette.foregroundNeutralSecondary.value,borderTransparency:i.FX.PropBlankRowsBorderTransparency.getValue(Y),borderWidth:i.FX.PropBlankRowsBorderWidth.getValue(Y)},Be={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.boldLabelFontProperties.color,"Row"),fontFamily:i.FX.PropSubTotalsFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.boldLabelFontProperties.family,"Row"),fontSize:xe,bold:i.FX.PropSubTotalsBold.getValue(Y,void 0,void 0,void 0,"Row"),italic:i.FX.PropSubTotalsItalic.getValue(Y,void 0,void 0,void 0,"Row"),underline:i.FX.PropSubTotalsUnderline.getValue(Y,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(Y,void 0,void 0,void 0,"Row"),applyToHeaders:i.FX.PropSubTotalsApplyToHeaders.getValue(Y,void 0,void 0,void 0,"Row")},ze={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.boldLabelFontProperties.color,"Column"),fontFamily:i.FX.PropSubTotalsFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.boldLabelFontProperties.family,"Column"),fontSize:Ve,bold:i.FX.PropSubTotalsBold.getValue(Y,void 0,void 0,void 0,"Column"),italic:i.FX.PropSubTotalsItalic.getValue(Y,void 0,void 0,void 0,"Column"),underline:i.FX.PropSubTotalsUnderline.getValue(Y,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(Y,void 0,void 0,void 0,"Column"),applyToHeaders:i.FX.PropSubTotalsApplyToHeaders.getValue(Y,void 0,void 0,void 0,"Column")},je={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:i.FX.PropColumnGrandTotalFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.boldLabelFontProperties.family,void 0,["Column"]),fontSize:ce,bold:i.FX.PropColumnGrandTotalBold.getValue(Y),italic:i.FX.PropColumnGrandTotalItalic.getValue(Y),underline:i.FX.PropColumnGrandTotalUnderline.getValue(Y),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(Y),applyToHeaders:i.FX.PropColumnGrandTotalApplyToHeaders.getValue(Y)},Ze={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:i.FX.PropRowGrandTotalFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.boldLabelFontProperties.family,void 0,["Row"]),fontSize:ye,bold:i.FX.PropRowGrandTotalBold.getValue(Y),italic:i.FX.PropRowGrandTotalItalic.getValue(Y),underline:i.FX.PropRowGrandTotalUnderline.getValue(Y),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(Y),applyToHeaders:i.FX.PropRowGrandTotalApplyToHeaders.getValue(Y)},Te={general:{autoSizeColumnWidth:i.FX.PropColumnPivotTableAutoSizeColumns.getValue(Y),textSize:x,rowSubtotals:i.FX.PropSubTotalsPivotTableRowSubtotals.getValue(Y),columnSubtotals:i.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(Y),layout:Ee},grid:{gridVertical:i.FX.PropGridVertical.getValue(Y),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(Y),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(Y),gridHorizontal:i.FX.PropGridHorizontalMatrix.getValue(Y),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(Y),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(Y),outline:i.FX.PropGridOutlineStyle.getValue(Y)||i.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(Y),outlineWeight:i.FX.PropGridOutlineWeight.getValue(Y),rowPadding:i.FX.PropGridRowPadding.getValue(Y),imageHeight:i.FX.PropGridImageHeight.getValue(Y),imageWidth:i.FX.PropGridImageWidth.getValue(Y)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.labelFontProperties.color),fontFamily:i.FX.PropColumnsFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.labelFontProperties.family),fontSize:P,bold:i.FX.PropColumnsBold.getValue(Y),italic:i.FX.PropColumnsItalic.getValue(Y),underline:i.FX.PropColumnsUnderline.getValue(Y),backColor:this.tablixProperties.PropColumnsBackColor.getValue(Y),outline:this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(Y),Y,i.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(Y),Y),urlIcon:i.FX.PropColumnsUrlIcon.getValue(Y),wordWrap:i.FX.PropColumnsWordWrap.getValue(Y),alignment:i.FX.PropColumnsAlignment.getValue(Y),titleAlignment:i.FX.PropColumnsAlignmentTitle.getValue(Y)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(Y,void 0,ue.fontColorOverrideFn,ue.labelFontProperties.color),fontFamily:i.FX.PropRowsFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.labelFontProperties.family),fontSize:j,bold:i.FX.PropRowsBold.getValue(Y),italic:i.FX.PropRowsItalic.getValue(Y),underline:i.FX.PropRowsUnderline.getValue(Y),backColor:this.tablixProperties.PropRowsBackColor.getValue(Y),outline:this.ensureOutline(i.FX.PropRowsOutlineStyle.getValue(Y),Y,i.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(i.FX.PropRowsOutlineWeight.getValue(Y),Y),steppedLayout:Ne,steppedLayoutIndentation:i.FX.PropRowsSteppedLayoutIndentation.getValue(Y),urlIcon:i.FX.PropRowsUrlIcon.getValue(Y),wordWrap:i.FX.PropRowsWordWrap.getValue(Y),alignment:i.FX.PropRowsAlignment.getValue(Y),showExpandCollapseButtons:!!u&&i.FX.PropRowsShowExpandCollapseButtons.getValue(Y),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(Y),expandCollapseButtonsSize:ne,expandCompositeHierarchy:de,repeatRowHeaders:i.FX.PropRowsRepeatRowHeaders.getValue(Y),legacyStyleDisabled:i.FX.PropRowsLegacyStyleDisabled.getValue(Y)},values:{fontFamily:i.FX.PropValuesFontFamily.getValue(Y,void 0,ue.fontFamilyOverrideFn,ue.labelFontProperties.family),fontSize:ge,bold:i.FX.PropValuesBold.getValue(Y),italic:i.FX.PropValuesItalic.getValue(Y),underline:i.FX.PropValuesUnderline.getValue(Y),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(Y,void 0,ue.fontColorOverrideFn,ue.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(Y),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(Y),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(Y),bandedRowHeaders:i.FX.PropValuesBandedRowHeaders.getValue(Y),outline:this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(Y),Y,i.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(Y),Y),outlineWeight:this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(Y),Y),urlIcon:i.FX.PropValuesUrlIcon.getValue(Y),wordWrap:i.FX.PropValuesWordWrap.getValue(Y),valuesOnRow:i.FX.PropValuesOnRow.getValue(Y)},columnGrandTotal:je,rowGrandTotal:Ze,subtotals:{rowSubtotalsPosition:Ee===V.t.Tabular?Z.I:i.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(Y),rowSubtotalsLabel:_e,columnSubtotalsLabel:We},rowSubtotals:Be,columnSubtotals:ze,blankRows:Oe,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ae=this.getMatrixValuesColumnMetadata(s);if(Ae)for(var ke=0,Ue=Ae;ke<Ue.length;ke++){var Se=Ue[ke],Le=Se&&Se.objects;Te.columnFormatting[Se.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(Le),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(Le),alignment:i.FX.PropColumnFormattingAlignment.getValue(Le),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(Le),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(Le),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(Le),styleSubTotals:i.FX.PropColumnFormattingStyleSubtotals.getValue(Le),dataBarsSettings:i.FX.PropColumnFormattingDataBars.getValue(Le),icon:i.FX.PropValuesIcon.getValue(Le)};var Xe=void 0,De=void 0;if(Se.type.numeric&&(Xe=i.FX.PropColumnFormattingDisplayUnits.getValue(Le),De=i.FX.PropColumnFormattingPrecision.getValue(Le)),Te.formatters[Se.queryName]=new c.g({column:Se,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Xe,precision:De,trailingZeroes:!0}),Te.tooltipFormatters[Se.queryName]=new c.g({column:Se,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Xe,precision:De,trailingZeroes:!0}),null!==(k=Se.type.misc)&&void 0!==k&&k.sparkline){var Ye=i.FX.PropSparklinesChartType.getValue(Le),Ke=new g(Se.displayName,Se.type,n);Te.formatters[Se.queryName]=Ke,Te.tooltipFormatters[Se.queryName]=Ke,Te.sparklines[Se.queryName]={chartType:Ye,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(Le).solid.color,strokeWidth:i.FX.PropSparklinesStrokeWidth.getValue(Le),marker:{show:!0,typeFlags:i.FX.PropSparklinesMarkerType.getValue(Le),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(Le).solid.color,size:i.FX.PropSparklinesMarkerSize.getValue(Le),shape:i.FX.PropSparklinesMarkerShape.getValue(Le)}}}}p&&(Te.annotationFormatting={columnHeaders:{}},_.forEach(null===(D=s.metadata)||void 0===D?void 0:D.columns,function(Qe){var Je;if(null!==(Je=Qe.objects)&&void 0!==Je&&Je.annotations){var Ge=(0,y.NA)(Qe.objects,fe.t.annotations.highlights);Ge&&(null!=Ge.backColor||!0===Ge.emphasizeText)&&(Te.annotationFormatting.columnHeaders[Qe.queryName]={backColor:Ge.backColor,bold:Ge.emphasizeText})}}),_.isEmpty(Te.annotationFormatting.columnHeaders)&&(Te.annotationFormatting=void 0));var $e=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(Y),qe=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(Y);return this.addMatrixHierarchySubtotalLabels(null===(re=s?.matrix)||void 0===re?void 0:re.rows,Te.columnFormatting,_e,$e),this.addMatrixHierarchySubtotalLabels(null===(ae=s?.matrix)||void 0===ae?void 0:ae.columns,Te.columnFormatting,We,qe),this.addMatrixHierarchyColumnsFormatters(null===(he=s?.matrix)||void 0===he?void 0:he.rows,Te.formatters,Te.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(se=s?.matrix)||void 0===se?void 0:se.columns,Te.formatters,Te.tooltipFormatters),Te},f.prototype.getTableExObjects=function(s,n,u,S){var b,p=f.getMetadataObjects(s),m=this.getTablixTextClassProperties(u),L=m.labelFontProperties.size&&m.labelFontProperties.size.pt,R=m.boldLabelFontProperties.size&&m.boldLabelFontProperties.size.pt,k=i.FX.PropGridPivotTableTextSize.getValue(p),D=null!=k?O.B.createFromPt(+k):void 0,re=i.FX.PropColumnsFontSize.getValue(p,void 0,m.fontSizeOverrideFn,L),ae=null!=re?O.B.createFromPt(+re):void 0,he=i.FX.PropValuesFontSize.getValue(p,void 0,m.fontSizeOverrideFn,L),se=null!=he?O.B.createFromPt(+he):void 0,Y=i.FX.PropTotalFontSize.getValue(p,void 0,m.fontSizeOverrideFn,R),ue=null!=Y?O.B.createFromPt(+Y):void 0,ve=i.FX.ProprowWithReferenceText.getValue(p),be={general:{autoSizeColumnWidth:i.FX.PropColumnPivotTableAutoSizeColumns.getValue(p),textSize:D,totals:i.FX.PropTotalTableExTotals.getValue(p)}};be.grid={gridVertical:i.FX.PropGridVertical.getValue(p),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(p),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(p),gridHorizontal:i.FX.PropGridHorizontalTable.getValue(p),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(p),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(p),outline:i.FX.PropGridOutlineStyle.getValue(p)||i.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(p),outlineWeight:i.FX.PropGridOutlineWeight.getValue(p),rowPadding:i.FX.PropGridRowPadding.getValue(p),imageHeight:i.FX.PropGridImageHeight.getValue(p),imageWidth:i.FX.PropGridImageWidth.getValue(p)},be.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(p,void 0,m.fontColorOverrideFn,m.labelFontProperties.color),fontFamily:i.FX.PropColumnsFontFamily.getValue(p,void 0,m.fontFamilyOverrideFn,m.labelFontProperties.family),fontSize:ae,bold:i.FX.PropColumnsBold.getValue(p),italic:i.FX.PropColumnsItalic.getValue(p),underline:i.FX.PropColumnsUnderline.getValue(p),backColor:this.tablixProperties.PropColumnsBackColor.getValue(p),outline:this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(p),p,i.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(p),p),wordWrap:i.FX.PropColumnsWordWrap.getValue(p),alignment:i.FX.PropColumnsAlignment.getValue(p)},be.values={fontFamily:i.FX.PropValuesFontFamily.getValue(p,void 0,m.fontFamilyOverrideFn,m.labelFontProperties.family),fontSize:se,bold:i.FX.PropValuesBold.getValue(p),italic:i.FX.PropValuesItalic.getValue(p),underline:i.FX.PropValuesUnderline.getValue(p),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(p,void 0,m.fontColorOverrideFn,m.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(p),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(p),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(p),outline:this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(p),p,i.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(p),p),urlIcon:i.FX.PropValuesUrlIcon.getValue(p),wordWrap:i.FX.PropValuesWordWrap.getValue(p)};var Ce=i.FX.PropTotalTableExTotalLabel.getValue(p);be.total={totalLabel:Ce||n(w.qT),totalPlaceholderLabel:n(w.bn),isDefaultTotalLabel:!Ce,fontFamily:i.FX.PropTotalFontFamily.getValue(p,void 0,m.fontFamilyOverrideFn,m.boldLabelFontProperties.family),fontSize:ue,bold:i.FX.PropTotalBold.getValue(p),italic:i.FX.PropTotalItalic.getValue(p),underline:i.FX.PropTotalUnderline.getValue(p),fontColor:this.tablixProperties.PropTotalFontColor.getValue(p,void 0,m.fontColorOverrideFn,m.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(p),outline:this.ensureOutline(i.FX.PropTotalOutlineStyle.getValue(p),p,i.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(i.FX.PropTotalOutlineWeight.getValue(p),p)},be.columnFormatting={},be.formatters={},be.tooltipFormatters={},be.sparklines={};var x=this.getTableColumnMetadata(s);if(x)for(var a=0,P=x;a<P.length;a++){var N=P[a];if(N){var j=N.objects,q=N.queryName;be.columnFormatting[q]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(j),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(j),alignment:i.FX.PropColumnFormattingAlignment.getValue(j),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(j),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(j),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(j),dataBarsSettings:i.FX.PropColumnFormattingDataBars.getValue(j),icon:i.FX.PropValuesIcon.getValue(j)};var ne=void 0,de=void 0;if(N.type.numeric&&(ne=i.FX.PropColumnFormattingDisplayUnits.getValue(j),de=i.FX.PropColumnFormattingPrecision.getValue(j)),be.formatters[q]=new c.g({column:N,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:ne,precision:de,trailingZeroes:!0}),be.tooltipFormatters[q]=new c.g({column:N,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:ne,precision:de,trailingZeroes:!0}),null!==(b=N.type.misc)&&void 0!==b&&b.sparkline){var pe=i.FX.PropSparklinesChartType.getValue(j),ge=new g(N.displayName,N.type,n);be.formatters[q]=ge,be.tooltipFormatters[q]=ge,be.sparklines[q]={chartType:pe,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(j).solid.color,strokeWidth:i.FX.PropSparklinesStrokeWidth.getValue(j),marker:{show:!0,typeFlags:i.FX.PropSparklinesMarkerType.getValue(j),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(j).solid.color,size:i.FX.PropSparklinesMarkerSize.getValue(j),shape:i.FX.PropSparklinesMarkerShape.getValue(j)}}}}}return be.rowWithReferenceText={rowWithReferenceText:ve},be},f.prototype.ensureOutline=function(s,n,u){var S;return null!==(S=s??i.FX.PropGridOutlineStyle.getValue(n))&&void 0!==S?S:u},f.prototype.ensureOutlineWeight=function(s,n){return s??i.FX.PropGridOutlineWeight.getValue(n)},f.prototype.outlineOverrideFn=function(s,n){return!!(0,y.NA)(s,n)},f.prototype.ensureOutlineColor=function(s,n){return s??this.tablixProperties.PropGridOutlineColor.getValue(n)},f.getTextSizeInPx=function(s){return h.FP.toString(s.px)},f.prototype.shouldShowTableTotalsOption=function(s){return!(s&&s.table&&!_.isEmpty(s.table.columns)&&_.some(s.table.columns,function(u){return u.discourageAggregationAcrossGroups}))},f.prototype.shouldShowRowSubtotalsOption=function(s){return!(!s||(0,J.be)(s.matrix)<1||this.isDiscourageAggregationAcrossGroups(s.matrix.rows.levels))},f.prototype.shouldShowColumnSubtotalsOption=function(s){if(!s||!s.matrix||(0,J.pr)(s.matrix.columns)<1)return!1;var n=s.matrix.columns.levels;return s.matrix.valueSources.length>1&&(n=_.initial(n)),!this.isDiscourageAggregationAcrossGroups(n)},f.prototype.isDiscourageAggregationAcrossGroups=function(s){var n=_.last(s);return n&&_.some(n.sources,function(u){return u.discourageAggregationAcrossGroups})},f.prototype.getTablixTextClassProperties=function(s){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,T.m)(s,"label"),boldLabelFontProperties:(0,T.m)(s,"boldLabel")}},f.prototype.fontSizeOverridePredicate=function(){var s=this;return function(n,u,S){var b=(0,y.RK)(n,u.objectName),p=(0,y.RK)(n,i.FX.ObjectGrid),m=(0,y.RK)(n,i.FX.ObjectValues),L=(0,y.RK)(n,i.FX.ObjectSubTotals),R=s.gridDependentObject(u.objectName),k=(0,I.N)(p,"textSize",void 0)&&!(0,I.N)(b,u.propertyName,void 0,S),D=s.valuesDependentObject(u.objectName),re=(0,I.N)(m,"fontSize",void 0)&&!(0,I.N)(b,u.propertyName,void 0,S),ae=s.subTotalsDependentObject(u.objectName),he=s.getSubTotalsValue(u.objectName,L,"fontSize",void 0)&&!(0,I.N)(b,u.propertyName,void 0,S),Y=!!(0,I.N)(b,u.objectName===i.FX.ObjectGrid?"textSize":"fontSize",void 0,S);return R&&k||D&&re||ae&&he||Y}},f.prototype.fontFamilyOverridePredicate=function(){var s=this;return function(n,u,S){var b=(0,y.RK)(n,u.objectName),p=(0,y.RK)(n,i.FX.ObjectValues),m=(0,y.RK)(n,i.FX.ObjectSubTotals),L=s.valuesDependentObject(u.objectName),R=(0,I.N)(p,"fontFamily",void 0)&&!(0,I.N)(b,u.propertyName,void 0),k=s.subTotalsDependentObject(u.objectName),D=s.getSubTotalsValue(u.objectName,m,"fontFamily",void 0)&&!(0,I.N)(b,u.propertyName,void 0,S),re=!!(0,I.N)(b,"fontFamily",void 0,S);return L&&R||k&&D||re}},f.prototype.fontColorOverridePredicate=function(){return function(s,n,u){var S=(0,y.RK)(s,n.objectName),b=n.objectName===i.FX.ObjectValues?"fontColorPrimary":"fontColor",p=(0,I.N)(S,b);return!!(0,I.N)(S,b,p,u)}},f.prototype.gridDependentObject=function(s){return this.valuesDependentObject(s)||s===i.FX.ObjectRowHeaders||s===i.FX.ObjectColumnHeaders||s===i.FX.ObjectValues},f.prototype.valuesDependentObject=function(s){return this.subTotalsDependentObject(s)||s===i.FX.ObjectSubTotals},f.prototype.subTotalsDependentObject=function(s){return s===i.FX.ObjectTotal||s===i.FX.ObjectRowTotal||s===i.FX.ObjectColumnTotal},f.prototype.getSubTotalsValue=function(s,n,u,S){var b=s===i.FX.ObjectRowTotal?"Row":s===i.FX.ObjectColumnTotal?"Column":void 0;return S=S??(0,I.N)(n,u),(0,I.N)(n,u,S,b)},f.ImageSizeMin=8,f.ImageSizeMax=512,f}(),g=function(){function f(s,n,u){this.displayName=s,this.sparklineType=n,this.localizer=u}return f.prototype.format=function(s,n){var u=function(f,s,n){if(n){var u=n.points;if(u=_.filter(u,function(ae){return null!=ae.x&&null!=ae.y}),!_.isEmpty(u)){var S=_.size(u);if(1===S)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[f,n.lowY]};var b=s.misc.sparkline.groupingType;if(b&&(b.numeric||b.dateTime||b.temporal)){var m=u[0].y,L=u[S-1].y;if(!_.some(u,function(ae){return ae.y!==m}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[f,m]};if((0,G.JM)(_.map(u,function(ae){return ae.x}),_.map(u,function(ae){return ae.y}),!0).rSquared>.5){var re,D="Sparkline_Tooltip_ScalarTrend";return D+=L>m?"Up":"Down",0!==m?(re=100*(L-m)/m,D+="Percent"):(re=L-m,D+="Value"),{key:D,parameters:[f,+Math.abs(re).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[f,n.lowY,n.highY]}}return n.lowY===n.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[f,n.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[f,n.lowY,n.highY]}}}}(this.displayName,this.sparklineType,s);if(u)return this.localizer.apply(this,(0,B.__spreadArray)([u.key],u.parameters,!1))},f}()},91468:function(Re,we,X){X.d(we,{CQ:function(){return d},D2:function(){return Z},JT:function(){return H},K2:function(){return I},Km:function(){return l},Kq:function(){return p},MO:function(){return U},Nk:function(){return S},Od:function(){return n},Ps:function(){return K},RD:function(){return t},RP:function(){return v},TQ:function(){return u},VM:function(){return e},X1:function(){return G},aY:function(){return b},do:function(){return c},jv:function(){return f},kJ:function(){return V},n2:function(){return y},qk:function(){return J},rP:function(){return s},s$:function(){return M},tO:function(){return o},wV:function(){return h},x9:function(){return w}});var B=X(18664),fe=X(91358),ee=X(32105),oe=X(19650),le=X(62458),F=X(32041),E=X(48066),T=X(38078),O=X(66001),Q=X(7911),i=X(93340),C=X(71090),r="0.3",e="cell-interactive",h="pivotTableCellNoWrap",y="pivotTableCellWrap",I=5,M=5,U=5;function J(m){return m.insertAdjacentHTML("beforeend",Q.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),m.lastChild}function G(m,L){return _.isEmpty(m)?0:F.b.measureSvgTextWidth(L,m)}function H(m,L){if(_.isEmpty(m))return 0;var R=0;return m.split("\n").forEach(function(k){var D=G(k,L);D>R&&(R=D)}),R}function c(m,L,R){return _.isEmpty(m)?[m]:(m=m.trim(),(0,O.ql)(m,R,F.b.measureSvgTextWidth,L,C.uZ,void 0,!0,!0))}function w(m,L){return Math.max(0,m-(L.getExtraLeft()+L.getExtraRight()))}function d(m){m.opacity=r}function V(m,L){return le.fF.assertValue(m,"kpi"),le.fF.assertValue(L,"kpiValue"),Q.bG.build({content:"",classNames:[(0,fe.sq)(m,L)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function Z(m,L,R,k){var D={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:m,referrerpolicy:"no-referrer"},contextMenuHandler:function(ae){ae.stopPropagation()}};return null!=k&&(D.attributes.alt=k),{children:[D],classNames:[C.Ed],styleProperties:{height:L+"px",width:R+"px"},attributes:null}}function K(m,L,R,k){le.fF.assertValue(m,"undefined iconSettings");var D={attributes:{},styleProperties:{},classNames:["flex-container"]},re=function(m,L,R){le.fF.assertValue(m,"undefined icon");var k=L+"px";return null===m.value?{tagName:"div",styleProperties:{height:k,width:k},attributes:{},classNames:null}:(le.fF.assertValue(m.value,"Undefined icon value"),m.value.svgId?{tagName:"svg",attributes:{height:k,width:k,role:"img","aria-label":R.getLocalizedString(m.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+m.value.svgId},classNames:null,styleProperties:{}}]}:null!=m.value.url?{tagName:"img",classNames:null,styleProperties:{height:k,width:k},attributes:{src:(0,T.HZ)(m.value.url),referrerpolicy:"no-referrer"}}:void le.fF.assertFail("Unrecognized icon value"))}(m,L,k);switch(R.classNames.push("stretching-content"),m.layout){case"IconOnly":R.children=[re],te(m,R),D.children=[R];break;case"After":te(m,re),D.children=[R,re];break;default:te(m,re),D.children=[re,R]}return D}function te(m,L){L.classNames||(L.classNames=[]);var R=L.classNames;switch(R.push("tablixIcon"),m.layout){case"IconOnly":break;case"Before":R.push("before");break;default:R.push("after")}switch(m.verticalAlignment){case"Bottom":R.push("bottom");break;case"Middle":R.push("middle");break;default:R.push("top")}}function v(m,L){return m?(0,i.RP)(L):null}function t(m,L,R,k,D,re){var ae={tagName:"a",classNames:[],styleProperties:{},attributes:{href:L,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(se){se.stopPropagation(),k(L,se)},contextMenuHandler:function(se){se.stopPropagation()}};return"string"==typeof m?ae.content=m:ae.children=[m],R&&(ae.content=void 0,ae.children=void 0,ae.classNames.push(C.NA,R),ae.attributes["aria-label"]=L),D&&(ae.styleProperties.color="inherit"),re&&(ae.attributes.title=L),ae}function o(m){return m-1}function l(m,L,R,k,D,re,ae){var he,se={};return L&&(he=m?["powervisuals-glyph","sort-icon",g(m)]:R?["powervisuals-glyph","sort-icon",g(k),"future"]:["sort-icon"]),!m&&R?se["aria-label"]=ae.getLocalizedString("Field_Sorting_Possible"):se["aria-hidden"]="true",{content:C.jv,attributes:se,styleProperties:{"font-size":re,bottom:D+"px"},classNames:he}}function g(m){switch(m){case 1:return"caret-up";case 2:return"caret-down"}}function f(m,L){return(0,i.MN)(m,L)!==E.av.NONE}function s(m){return m&&m.replace(/&#10;/g,"<BR />")}function n(m,L){m.size&&8.52===m.size.px&&(m=(0,B.ED)(m,{size:ee.B.createFromPx(8)}));var R={measuredFontHeight:null,textProperties:(0,B.qk)(m),fontProperties:m};return L.addItem(R),R}function u(m,L,R){return n((0,B.ED)(m.fontProperties,L),R)}function S(m,L,R){var k=m.fontProperties;k.family&&(L.fontFamily=k.family),k.size&&(L.fontSize=k.size),k.weight&&(L.fontWeight=k.weight),k.style&&(L.fontStyle=k.style),k.textDecoration&&R&&(L.textDecoration=k.textDecoration)}function b(m,L,R){if(le.fF.assertValue(L,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==m||m===oe.H.auto){if(!R)return;m=R}switch(m){case oe.H.left:return void L.push(C.z7);case oe.H.center:return void L.push(C.QM);case oe.H.right:return void L.push(C.OM);default:return}}var p=function(){function m(){this.items=[]}return m.prototype.addItem=function(L){this.items.push(L)},m.prototype.measureAll=function(L){if(!_.isEmpty(this.items)){for(var R=[],k=0,D=this.items;k<D.length;k++){var ae={content:"a",classNames:null,styleProperties:(0,B.wB)(D[k].fontProperties),attributes:null};R.push(Q.bG.build(ae,null))}var he=R.join("");L.insertAdjacentHTML("beforeend",he);for(var Y,se=!0,ue=0,ve=this.items;ue<ve.length;ue++)se?(se=!1,Y=L.firstChild):Y=Y.nextSibling,ve[ue].measuredFontHeight=Math.ceil(Y.offsetHeight);L.innerHTML=""}},m}()},59151:function(Re,we,X){X.d(we,{P:function(){return fe}});var B=X(55007);function fe(ee,oe,le){for(var F={remove:[],merge:[]},E=0,T=ee;E<T.length;E++){var O=T[E],Q={selector:O.selector,objectName:B.FX.PropColumnWidthValue.objectName,properties:{}};Q.properties[B.FX.PropColumnWidthValue.propertyName]=O.value,null==O.value?F.remove.push(Q):F.merge.push(Q)}oe.persistProperties(F,le)}},13375:function(Re,we,X){X.d(we,{aD:function(){return Q},hc:function(){return i}});var B=X(81337),fe=X(62458),ee=X(39681),oe=X(38078),le=X(93340),F=X(29043),E=X(66842),T=X(40845),O=function(C){function r(e,h,y,I,M,U,J,G){var c,w,d,V,H=this;if(y)for(d=y;d.parent;)d=d.parent;if(I)for(V=I;V.parent;)V=V.parent;var Z=V&&!!V.isSubtotal,K=!Z&&I&&!!I.isSubtotal,W=d&&!!d.isSubtotal,te=!W&&y&&!!y.isSubtotal,v=y.isBlankRow;return _.isString(e)&&!(null===(w=null===(c=M?.type)||void 0===c?void 0:c.misc)||void 0===w)&&w.sparkline&&(e=(0,F.th)(e,U)),(H=C.call(this,e,h,te,K,W,Z,v,M,J,G,0)||this).rowItem=y,H.columnItem=I,H.hasRowSubtotalStyle=y&&y.hasSubtotalStyle,H.hasColumnSubtotalStyle=I&&I.hasSubtotalStyle,H.hasSubtotalStyle=H.hasRowSubtotalStyle||H.hasColumnSubtotalStyle,H}return(0,B.__extends)(r,C),Object.defineProperty(r.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),r}(le.jG);function Q(C,r,e,h,y,I,M,U,J,G){void 0===M&&(M=!0);var H=new i(h,y,I,G,!0);return M&&H.update(C,!1,!1,!1,r,!0,e,U,J,void 0,void 0,!1),H}var i=function(){function C(r,e,h,y,I){this.tablixProperties=e,this.hostServices=h,this.expandCompositeHierarchy=y,this.modernRowHeaderStyle=I,this.compositeGroupSeparator=r}return C.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},C.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},C.prototype.getLeafCount=function(r){var e=this.getMatrixHierarchy(r);return e?e.leafNodes.length:0},C.prototype.getLeafAt=function(r,e){var h=this.getMatrixHierarchy(r);return h?h.leafNodes[e]:null},C.prototype.getLeafIndex=function(r){return fe.fF.assertValue(r,"item"),r.leafIndex},C.prototype.getParent=function(r){return fe.fF.assertValue(r,"item"),0===r.level?null:r.parent},C.prototype.getIndex=function(r){return fe.fF.assertValue(r,"item"),r?r.index:-1},C.prototype.isLeaf=function(r){return fe.fF.assertValue(r,"item"),!r.children||0===r.children.length},C.prototype.isRowHierarchyLeaf=function(r){return!0},C.prototype.isColumnHierarchyLeaf=function(r){return!1},C.prototype.isFirstItem=function(r,e){return r===_.head(e)},C.prototype.areAllParentsFirst=function(r,e){if(!r)return!1;var h=this.getParent(r);return h?this.isFirstItem(r,r.siblings)&&this.areAllParentsFirst(h,h.siblings):this.isFirstItem(r,r.siblings)},C.prototype.isLastItem=function(r,e){if(fe.fF.assertValue(r,"item"),r!==_.last(e))return!1;if(!this.isItemRow(r)||this.isDataComplete)return!0;for(var h=r.parent;h;){if(h!==_.last(h.siblings))return!0;h=h.parent}return!1},C.prototype.isItemRow=function(r){if(!r)return!1;for(var e=r;e.parent;)e=e.parent;return e.siblings===this.rowHierarchy.root.children},C.prototype.areAllParentsLast=function(r,e){if(!r)return!1;var h=this.getParent(r);return h?this.isLastItem(r,r.siblings)&&this.areAllParentsLast(h,h.siblings):this.isLastItem(r,r.siblings)},C.prototype.getChildren=function(r){return fe.fF.assertValue(r,"item"),r.children},C.prototype.getChildrenLevelDifference=function(r){var e=1/0,h=this.getChildren(r);if(!_.isEmpty(h))for(var y=0,I=h.length;y<I;y++)e=Math.min(e,h[y].level-r.level);return e},C.prototype.getCount=function(r){return fe.fF.assertValue(r,"items"),r.length},C.prototype.getAt=function(r,e){return fe.fF.assertValue(r,"items"),r[e]},C.prototype.getLevel=function(r){return fe.fF.assertValue(r,"item"),r.level},C.prototype.getRowLeafIndex=function(r){return this.isSteppedLayout&&r.isSubtotal?r.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?r.parent.leafIndex:r.leafIndex:this.valuesOnRow?r.levelSourceIndex:-1:r.leafIndex},C.prototype.getIntersection=function(r,e){fe.fF.assertValue(r,"rowItem"),fe.fF.assertValue(e,"columnItem");var h,I,y=e.leafIndex;if(h=r.values?r.values[e.leafIndex]:void 0){var M=this.valueSources[h.valueSourceIndex||0],U=M.queryName;I=new O(h.value,h.objects,r,e,M,this.hostServices,this.formatters[U],this.tooltipFormatters[U])}else I=new O(void 0,void 0,r,e,void 0,this.hostServices,void 0,void 0);var H=this.getRowLeafIndex(r);return I.position.row.index=H,I.position.row.indexInSiblings=r.siblings.indexOf(r),I.position.row.isFirst=0===H,I.position.row.isLast=this.isDataComplete&&H===this.rowHierarchy.leafNodes.length-1,I.position.column.index=y,I.position.column.indexInSiblings=e.siblings.indexOf(e),I.position.column.isFirst=0===y,I.position.column.isLast=y===this.columnHierarchy.leafNodes.length-1,h&&h.objects&&(I.backColor=(0,oe.HZ)(this.tablixProperties.PropValuesBackColor.getValue(h.objects)),I.fontColor=(0,oe.HZ)(this.tablixProperties.PropValuesFontColor.getValue(h.objects))),I},C.prototype.getCorner=function(r,e){fe.fF.assert(function(){return r>=0},"rowLevel"),fe.fF.assert(function(){return e>=0},"columnLevel");var I,h=this.columnHierarchy.levels,y=this.rowHierarchy.levels;if((e===h.length-1||0===h.length)&&(I=y[r])){var M=r===y.length-1,U=this.valuesOnRow&&M;return{metadata:1===I.sources.length||I.sources.length>1&&U?I.sources[0]:null,displayName:U?"":_.map(I.sources,function(H){return H.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:M,position:this.calculateCornerCellPosition(r,e),rowLevel:r,columnLevel:e}}if(r===y.length-1&&(I=h[e])){var G=I.sources.filter(function(c){return!c.isMeasure});return{metadata:1===I.sources.length?I.sources[0]:null,displayName:_.map(G,function(c){return c.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(r,e),rowLevel:r,columnLevel:e}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(r,e),rowLevel:r,columnLevel:e}},C.prototype.calculateCornerCellPosition=function(r,e){var h=new le.ri,y=e;h.row.index=h.row.indexInSiblings=y,h.row.isFirst=0===y;var I=this.getColumnHierarchyDepth();h.row.isLast=e===I-1;var M=r;h.column.index=h.column.indexInSiblings=M,h.column.isFirst=0===M;var U=this.getRowHierarchyDepth();return h.column.isLast=M===U-1,h},C.prototype.headerItemEquals=function(r,e){return!(!r||!e)&&r===e},C.prototype.bodyCellItemEquals=function(r,e){return r.position.isMatch(e.position)},C.prototype.cornerCellItemEquals=function(r,e){return!(!r||!e)&&r.displayName===e.displayName&&r.isColumnHeaderLeaf===e.isColumnHeaderLeaf&&r.isRowHeaderLeaf===e.isRowHeaderLeaf&&r.metadata===e.metadata},C.prototype.getColumnHierarchy=function(){return this.columnHierarchy},C.prototype.getRowHierarchy=function(){return this.rowHierarchy},C.prototype.getValueSources=function(){return this.valueSources},C.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},C.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},C.prototype.update=function(r,e,h,y,I,M,U,J,G,H,c,w){var d=this;fe.fF.assertValue(r,"matrix"),this.isSteppedLayout=e,this.valuesOnRow=h,this.areRowSubtotalsBefore=y,this.isDataComplete=I,this.valueSources=r.valueSources,this.formatters=U,this.tooltipFormatters=J||{},this.subtotalByColumn=G||{},this.multipleValueSources=r.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(r.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,w,H,c),(M=M||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(r.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,c,this.areRowSubtotalsBefore,function(V,Z){return d.calculateRowHeaderPosition(V,Z)}),M&&(this.updateHierarchy(this.columnHierarchy,!1,c,!1,function(V,Z){return d.calculateColumnHeaderPosition(V,Z)}),this.updateStaticColumnHeaders(this.columnHierarchy))},C.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},C.prototype.removeValueNodesFromColumnHierarchy=function(r){fe.fF.assertValue(r,"nodes");for(var e=0,h=r;e<h.length;e++){var y=h[e];if(!y.parent&&this.isLeaf(y))return r.length=0,void r.push({level:0});this.isLeaf(y.children[0])?y.children=void 0:this.removeValueNodesFromColumnHierarchy(y.children)}},C.prototype.addValueNodesToRowHierarchy=function(r,e){for(var h=this.getRowHierarchyDepth(),y=this.valueSources.length,I=r.length,M=0;M<I;M++){var U=r[M];if(this.isLeaf(U)){var J=void 0,G=void 0,H=void 0;if(this.isSteppedLayout&&U.isSubtotal||!e?(r.splice(M,1),J=r,G=M,H=U.level,I=I-1+y,M=M-1+y):(U.children=[],J=U.children,G=0,H=h),!U.isBlankRow)for(var c=0;c<y;c++){var w=this.createRowValueNode(c,y,U,H);J.splice(G++,0,w)}U.values=null}else this.addValueNodesToRowHierarchy(U.children,e)}},C.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},C.prototype.createRowValueNode=function(r,e,h,y){var I={level:y,levelSourceIndex:r,isSubtotal:h.isSubtotal,hasSubtotalStyle:!!h.hasSubtotalStyle,values:{}},M=0,U=0;for(var J in h.values)M%e===r&&(I.values[U++]=h.values[M]),M++;return I},C.prototype.createBlankRowValueNode=function(r){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(r),function(h){return h.valueSourceIndex}).map(function(h){return{value:"",valueSourceIndex:h,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.needsBlankRow=function(r,e,h){return!r.isSubtotal||e===T.we&&h!==E.t.Compact},C.prototype.findValues=function(r){if(r.values)return r.values;var e=_.first(r.children);return e?this.findValues(e):void 0},C.prototype.wrapHierarchy=function(r,e,h,y,I,M){var J,U=this;return J={levels:this.wrapLevels(r.levels,e),root:{children:this.wrapNodes(r.root.children,r,e,h)}},y&&J.root.children.length>0&&(J.root.children=_.flatMap(J.root.children,function(G){return U.needsBlankRow(G,I,M)?[G,U.createBlankRowValueNode(G)]:[G]})),J.leafNodes=[],J},C.prototype.wrapLevels=function(r,e){if(r){for(var h=[],y=0,I=r;y<I.length;y++){var M=I[y],U=(0,ee.ED)(M);if(h.push(U),M.sources.length>1&&e){for(var J=1;J<M.sources.length;J++)h.push({sources:[M.sources[J]]});U.sources.splice(1,U.sources.length-1)}}return h}},C.prototype.wrapNodes=function(r,e,h,y){if(r){for(var I=[],M=0,U=r;M<U.length;M++){var J=U[M],G=(0,ee.ED)(J);if(J.isCollapsed&&!_.isEmpty(J.children)){var H=_.find(J.children,function(W){return W.isSubtotal});H&&(G.values=H.values),G.children=null,G.hasSubtotalStyle=!0}else{if(G.isSubtotal){var c=e.levels[G.level||0];if(1===c.sources.length&&!1===this.subtotalByColumn[c.sources[0].queryName])continue}G.hasSubtotalStyle=!!J.isSubtotal||y&&!_.isEmpty(J.children),G.children=this.wrapNodes(J.children,e,h,y)}if(!_.isEmpty(G.levelValues)&&G.levelValues.length>1&&h){for(var w=G.children,d=G,V=1;V<G.levelValues.length;V++){var Z=(0,ee.ED)(G),K=G.levelValues[V];K.levelSourceIndex=0,Z.levelValues=[K],Z.level+=V,Z.isCollapsed=!0,Z.children=void 0,d.isCollapsed=!1,d.children=[Z],d=Z}_.isEmpty(w)||(d.children=w,d.isCollapsed=!1),d.values=G.values,G.values=void 0,G.levelValues.splice(1,G.levelValues.length-1)}I.push(G)}return I}},C.prototype.updateHierarchy=function(r,e,h,y,I){r.leafNodes.length>0&&(r.leafNodes.length=0),r.root.children&&this.updateRecursive(r,r.root.children,null,r.leafNodes,e,h,y,I)},C.prototype.createEmptyNode=function(r){return void 0===r&&(r=0),{level:r,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.updateRecursive=function(r,e,h,y,I,M,U,J){for(var G,H=function(Z,K){var W=e[Z];if(W.siblings=e,r===c.rowHierarchy&&!W.isCollapsed&&!_.isEmpty(W.children)&&M===E.t.Outline&&!U&&W.children.unshift(c.createEmptyNode(W.children[0].level)),h&&(W.parent=h),G=r===c.rowHierarchy&&c.isSteppedLayout&&W.isSubtotal&&void 0!==W.levelSourceIndex?_.last(r.levels):r.levels[W.level],W.hierarchyLevel=G,G)if(W.levelValues){for(var te=[],v=[],t=0,o=W.levelValues;t<o.length;t++){var l=o[t],s=l.value;te.push(c.formatters[(g=G.sources[l.levelSourceIndex||0]).queryName].format(s,null));var n=c.tooltipFormatters[g.queryName];n&&v.push(n.format(s,null))}fe.fF.assert(function(){return te.length===v.length||_.isEmpty(v)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),W.valueFormatted=te.join(c.compositeGroupSeparator),W.tooltipValueFormatted=_.isEmpty(v)?void 0:v.join(c.compositeGroupSeparator),W.queryName=1!==G.sources.length?void 0:G.sources[0].queryName}else{var g;W.valueFormatted=(g=G.sources[W.levelSourceIndex||0]).displayName,W.tooltipValueFormatted=g.displayName,W.queryName=g.queryName}W.index=Z,_.isEmpty(W.children)?(!I||!W.isSubtotal||!U&&W.parent&&!W.parent.isSubtotal||c.valuesOnRow&&W.parent)&&(W.leafIndex=y.length,y.push(W)):(I&&(W.leafIndex=y.length,y.push(W)),c.updateRecursive(r,W.children,W,y,I,M,U,J),I&&(fe.fF.assertAnyValue(_.every(W.children,function(u){return _.isEqual(u.hierarchyLevel,W.children[0].hierarchyLevel)}),"Children may come from different levels"),(!c.hasMultipleValueSources()||_.some(W.children,function(u){return _.some(u.hierarchyLevel.sources,function(S){return!S.isMeasure})}))&&(W.hasSubtotalStyle=!0))),W.position=J(W,e)},c=this,w=0,d=e.length;w<d;w++)H(w)},C.prototype.updateStaticColumnHeaders=function(r){var e=r.leafNodes;if(e&&e.length>0){if(!e[0].identity&&this.valuesOnRow&&1===e.length)return;for(var h=0,y=e.length;h<y;h++){var I=e[h];if(!I.identity&&_.isEmpty(I.levelValues)){var U=r.levels[I.level].sources[I.levelSourceIndex?I.levelSourceIndex:0];U&&(I.valueFormatted=U.displayName)}}}},C.prototype.getMatrixHierarchy=function(r){var e=this.rowHierarchy.root.children;if(e&&r===e)return this.rowHierarchy;var h=this.columnHierarchy.root.children;return h&&r===h?this.columnHierarchy:null},C.prototype.calculateRowHeaderPosition=function(r,e){var h=new le.ri;h.row.index=this.getRowLeafIndex(r),h.row.indexInSiblings=this.getIndex(r),h.row.isFirst=this.areAllParentsFirst(r,e),h.row.isLast=this.areAllParentsLast(r,e);var y=this.getLevel(r);return h.column.index=h.column.indexInSiblings=y,h.column.isFirst=0===y,h.column.isLast=this.isLeaf(r),h},C.prototype.calculateColumnHeaderPosition=function(r,e){var h=new le.ri,y=this.getLevel(r);h.row.index=h.row.indexInSiblings=y,h.row.isFirst=0===y,h.row.isLast=this.isLeaf(r);var I=this.getIndex(r);return h.column.index=h.column.indexInSiblings=I,h.column.isFirst=this.areAllParentsFirst(r,e),h.column.isLast=this.areAllParentsLast(r,e),h},C.prototype.getRowHeaderMetadataColumn=function(r){var e=this.getRowHeaderMetadataColumns(r);return e&&e[0]},C.prototype.getRowHeaderMetadataColumns=function(r){if(r&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,r.level)},C.prototype.getColumnHeaderMetadataColumn=function(r){var e=this.getColumnHeaderMetadataColumns(r);return e&&e[0]},C.prototype.getColumnHeaderMetadataColumns=function(r){if(r&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,r.level)},C.prototype.getHierarchyMetadataColumns=function(r,e){if(r&&r.levels&&!(r.levels.length<e)){var h=r.levels[e];if(h&&h.sources&&0!==h.sources.length)return h.sources}},C.isNodeGrandTotal=function(r){if(r){for(var e=r;e.parent;)e=e.parent;return e.isSubtotal}return!1},C}()},32771:function(Re,we,X){X.d(we,{JF:function(){return T},az:function(){return E}});var B=X(81337),fe=X(90120),ee=X(34021),oe=X(44783),le=X(62458),F=X(38078);function E(Q,i,C){if(le.fF.assertValue(Q,"getColumnDataBarsSettings: column"),i){var e,h,r=Q.aggregates;if(null!=i.minValue?e=i.minValue:r&&null!=r.min&&_.isNumber(r.min)&&(e=r.min),null!=i.maxValue?h=i.maxValue:r&&null!=r.max&&_.isNumber(r.max)&&(h=r.max),!(null==e||null==h||e>h)){var y=null!=i.minValue,I=null!=i.maxValue;return e>=0&&h>0&&!y&&(e=0),e<0&&h<0&&!I&&(h=0),{min:e,max:h,range:h-e,zeroPosition:0===e&&0===h?.5:e>=0&&h>0&&y?0:e<0&&h<=0&&I?1:(0-e)/(h-e),positiveColor:(0,F.HZ)(fe.v.getFillColor(C,i.positiveColor,oe.U)),negativeColor:(0,F.HZ)(fe.v.getFillColor(C,i.negativeColor,oe.U)),axisColor:(0,F.HZ)(fe.v.getFillColor(C,i.axisColor,oe.fA)),hideText:!!i.hideText,reverseDirection:!!i.reverseDirection,strokeSettings:(0,B.__assign)((0,B.__assign)({},(0,ee.kG)(C)),{width:1}),totalMatching:i.totalMatchingOption}}}}function T(Q,i,C,r,e){var h,y=C.getExtraLeft()+"px",I=C.getExtraRight()+"px",M=C.getExtraTop()+"px",U=C.getExtraBottom()+"px",J={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:y,right:I,top:M,bottom:U}},G=[],H=function(Q,i,C){if(null!=i&&_.isNumber(i)&&0!==i){var I,M,U,r=Q.min,e=Q.max,h=Q.range,y=Q.zeroPosition;if(i>=e){if(1===y)return;i=e}else if(i<=r){if(0===y)return;i=r}if(0===h?(I=M=y,U=Q.positiveColor):i>0?(I=y,M=(i-r)/h,U=Q.positiveColor):(I=(i-r)/h,M=y,U=Q.negativeColor),Q.reverseDirection){var J=I;I=1-M,M=1-J}var G=100*(M-I);C?.push((i>=0?"":"-")+Math.round(G)+"%");var H={left:100*I+"%",width:G+"%",background:U},c=Q.strokeSettings;return c&&c.visible&&(H.outline="".concat(c.width,"px solid ").concat(c.color),H["outline-offset"]="-".concat(c.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:H}}}(i,r,G);H&&J.children.push(H);var d,c=i.zeroPosition;i.reverseDirection&&(c=1-c),J.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+M,bottom:"-"+U,left:100*c+"%","border-left-color":i.axisColor}}),e&&(d={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:e.getLocalizedString("Data_Bar_Percentage",null!==(h=G[0])&&void 0!==h?h:"0%")});var V=Q.styleProperties;return V.position="absolute",V.left=y,V.right=I,V.top=M,V.bottom=U,d?{children:[J,Q,d],classNames:[],attributes:{},styleProperties:{}}:{children:[J,Q],classNames:[],attributes:{},styleProperties:{}}}},21242:function(Re,we,X){X.d(we,{Ak:function(){return e},IP:function(){return I},JW:function(){return T},MX:function(){return C},d4:function(){return oe},kH:function(){return le},mM:function(){return r},p_:function(){return y},re:function(){return O}});var B=X(81337),fe=X(13375);function ee(M,U,J,G){var H,c,w,d,V,Z;void 0===J&&(J=!0);var K=M.columnItem,W=M.rowItem,te=0,v={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},t=W&&!_.isEmpty(W.values),o=W&&i(W,U,J,G);o&&((H=v.displayNameParts).push.apply(H,o.displayNameParts||[]),(c=v.valueParts).push.apply(c,o.valueParts||[]),(w=v.headerParts).push.apply(w,_.map(o.valueParts,function(){return!0})),v.concatenatedParts.push(_.map(o.displayNameParts,function(){return te++})));var l=K&&i(K,U,J,G);if(l&&((d=v.displayNameParts).push.apply(d,l.displayNameParts||[]),(V=v.valueParts).push.apply(V,l.valueParts||[]),(Z=v.headerParts).push.apply(Z,_.map(l.valueParts,function(){return!0})),v.concatenatedParts.push(_.map(l.displayNameParts,function(){return te++}))),t)if(v.displayNameParts.push(M.columnMetadata.displayName),v.concatenatedParts.push([te++]),v.headerParts.push(!1),M.isKpi){var g={metadata:M.columnMetadata.kpi,value:M.tooltipContent};(v.otherType[v.displayNameParts.length-1]={}).kpiValue=g,v.valueParts.push(M.tooltipContent)}else _.isEmpty(M.tooltipContent)||v.valueParts.push(M.tooltipContent);return v}function oe(M,U,J){if(M)return J?[{displayName:"",value:M.tooltipContent}]:function(M){for(var U=[],J=function(d){var V=_.filter(M.displayNameParts,function(te,v){return-1!==d.indexOf(v)}),Z=_.filter(M.valueParts,function(te,v){return-1!==d.indexOf(v)});if((V.length>0||Z.length>0)&&(U.push({displayName:V.join(" "),value:Z.join(" ")}),M.otherType)){var K=_.first(d);if(_.has(M.otherType,String(K))){var W=U.length-1;delete U[W].value,U[W]=(0,B.__assign)((0,B.__assign)({},U[W]),M.otherType[K])}}},G=0,H=M.concatenatedParts;G<H.length;G++)J(H[G]);return U}(ee(M,U))}function le(M,U,J,G){for(var H=[],c=0,w=M;c<w.length;c++)H.push(ee(w[c],G));var V=0,Z=U.getHierarchyLeafCount()*J.getHierarchyLeafCount();return 0!==Z&&(V=Math.round(M.length/Z*100)),(0,B.__assign)({coveragePercentage:V},F(H))}function F(M){for(var U={headers:_.uniq(_.flatten(_.map(M,function(l){return l.displayNameParts}))),isHeader:{},values:[]},J=U.values,G=U.headers,H=U.isHeader,c={},w=0;w<G.length;w++)c[G[w]]=w;for(var d=0,V=M;d<V.length;d++){var Z=V[d],K=_.fill(new Array(G.length),"");for(w=0;w<Z.displayNameParts.length;w++){var v=c[Z.displayNameParts[w]];K[v]=Z.valueParts[w],Z.headerParts&&(U.isHeader[v]=Z.headerParts[w])}J.push(K)}if(!_.isEmpty(M)&&M[0].headerParts)for(var t=function(g){for(var f=J[g],s=[],n=g+1;n<J.length;n++)_.every(J[n],function(se,Y){return H[Y]&&se===f[Y]||!H[Y]&&(""===se||""===f[Y])})&&s.push(n);if(s.length>0)for(var b=_.reduce(f,function(se,Y,ue){return""===Y&&se.push(ue),se},[]),p=0,m=s;p<m.length;p++){var R=J[m[p]];for(n=0;n<b.length;n++){var k=b[n],D=R[k];""!==D&&(f[k]=D,b.splice(n,1),n--)}}s.sort(function(se,Y){return Y-se});for(var re=0,ae=s;re<ae.length;re++)J.splice(ae[re],1)},o=0;o<J.length;o++)t(o);return U}function T(M,U){if(M)return U?[{displayName:"",value:M.displayName}]:[{displayName:M.displayName}]}function O(M,U,J,G,H,c){if(M){if(c)return[{displayName:"",value:M.isSubtotal||fe.hc.isNodeGrandTotal(M)?G:M.tooltipValueFormatted}];if(fe.hc.isNodeGrandTotal(M))return J(M)?[{displayName:M.tooltipValueFormatted}]:[{displayName:G}];var d=[],V=function(M,U){var J=C(M,U),G=J.displayNameParts,H=J.valueParts;if(G.length>0||H.length>0)return{displayName:G.join(" "),value:H.join(" ")}}(M,H);return V&&d.push(V),U(M)&&d.push({displayName:H,value:M.valueFormatted}),d}}function i(M,U,J,G){void 0===J&&(J=!0);var H=h(M),c=M.queryName,w=_.find(H,function(d){return d.queryName===c});return w&&w.isMeasure&&(M=M.parent),C(M,U,J,G)}function C(M,U,J,G){void 0===J&&(J=!0);for(var H=[],c=[];M;)if(J&&M.isSubtotal)M=M.parent;else{var w=h(M);if(!_.isEmpty(w)){for(var d=[],V=0,Z=w;V<Z.length;V++){var K=Z[V];d.push(K.isMeasure?U:K.displayName)}H.push(d.join(" ")),_.every(w,function(W){return W.isMeasure})?c.push(w[0].displayName):c.push(M.isSubtotal?G:M.tooltipValueFormatted)}M=M.parent}return{displayNameParts:H=H.reverse(),valueParts:c=c.reverse()}}function r(M,U,J,G,H){var c=e(J,G,M,U),w=0,d=J.getHierarchyLeafCount()*G.getHierarchyLeafCount();0!==d&&(w=Math.round(c.length/d*100));for(var V=[],Z=0,K=c;Z<K.length;Z++)V.push(ee(K[Z],H));return(0,B.__assign)({coveragePercentage:w},F(V))}function e(M,U,J,G){_.isEmpty(J)&&(J=M.getHierarchyItems()),_.isEmpty(G)&&(G=U.getHierarchyItems());var H=[];M.getLeaves(J,H),H=_.filter(H,function(v){return!v.isSubtotal});var c=[];U.getLeaves(G,c),c=_.filter(c,function(v){return!v.isSubtotal});for(var w=[],d=0,V=H;d<V.length;d++)for(var Z=V[d],K=0,W=c;K<W.length;K++)w.push(M.getIntersection(Z,W[K]));return w.filter(function(v){return!v.isSubtotal&&!v.isGrandTotal})}function h(M){var U=M.hierarchyLevel&&M.hierarchyLevel.sources;return _.isEmpty(U)?[]:_.every(U,function(J){return J.isMeasure})?[U[M.levelSourceIndex||0]]:U}function y(M){return{displayNameParts:[M.displayName],valueParts:[null]}}function I(M,U){for(var J=[],G=0;G<M.displayNameParts.length;G++){var H=M.displayNameParts[G],c=M.valueParts[G];null!=c&&(H+=": "+c),J.push(H)}if(!_.isEmpty(U))for(var w=0,d=U;w<d.length;w++)J.push(d[w]);return J.join(". ")}},29043:function(Re,we,X){X.d(we,{MV:function(){return r},th:function(){return i},wJ:function(){return C}});var B=X(53197),fe=X(90120),ee=X(51995),oe=X(85308),le=X(58520),F=X(45296),E=X(44783),T=X(62458),O=X(43286),Q=52;function i(M,U){var o,J={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(M)){var G;try{G=JSON.parse(M)}catch{return}var H=+G.yl,c=+G.yh,d=+G.xl,V=+G.xh,Z=null!=G.md?+G.md:void 0;_.size(G.p)>Q&&U.setWarnings([new F.El]);for(var K=0,W=G.p;K<W.length;K++){var te=W[K];J.points.push({x:null!=te[0]?+te[0]:void 0,y:null!=te[1]?(o=+te[1],o*(c-H)/100+H):void 0})}return{points:_.filter(J.points,function(t){return _.isFinite(t.x)&&(null!=t.y||_.isFinite(t.y))}),lowX:d,highX:V,lowY:H,highY:c,minXDifference:Z}}}function C(M,U,J){var G;T.fF.assertValue(M,"sparkline"),T.fF.assertValue(null===(G=U?.misc)||void 0===G?void 0:G.sparkline,"invalid type for sparkline"),T.fF.assertValue(J,"style");var H=U.misc.sparkline.groupingType;return{chartType:M.chartType,dataColor:J.isHighContrast?fe.v.getThemeColor(J,E.fA):M.dataColor,strokeWidth:M.strokeWidth,marker:{show:!0,typeFlags:M.marker.typeFlags,color:J.isHighContrast?fe.v.getThemeColor(J,E.fA):M.marker.color,size:M.marker.size,shape:M.marker.shape},isScalar:H&&!!(H.numeric||H.dateTime||H.temporal)}}function r(M,U,J,G,H,c,w,d){var V;if(null!=G){var v=c-J.getExtraLeft()-J.getExtraRight()-(d?d+5:0),t=H-J.getExtraTop()-J.getExtraBottom();v-U.strokeWidth>1&&t-U.strokeWidth>1&&(V=U.chartType===oe.U.line?function(M,U,J,G){var g,c=M.dataColor,w=M.strokeWidth,d=M.marker,V=d.color,Z=d.size,K=d.shape,W=d.typeFlags,te=M.isScalar,v=(0,O.Js)(W),t=0===v||1===v&&(0,O.yE)(W,le.qC),o=Math.max(w,2)+(t?0:Math.ceil(Z/2)),l=G.points;g=te?d3.scaleLinear().domain([G.lowX,G.highX]).range([o,U-o]):d3.scalePoint().domain(_.map(_.range(G.lowX,G.highX+1),function(k){return k.toString()})).range([o,U-o]);var b,p,f=d3.scaleLinear().domain(d3.extent(l,function(k){return k.y})).range([J-o,o]),s=d3.line().x(function(k){return g(k.x)}).y(function(k){return f(k.y)}),n=_.filter(l,function(k){return null!=k.y}),S={tagName:"path",attributes:{d:s(n)},classNames:[],styleProperties:{stroke:c,"stroke-width":w.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},m=function(M,U){var J=U.marker.typeFlags,G=d3.extent(M,function(w){return w.y}),H=G[0],c=G[1];return _.filter(M,function(w,d){var V,Z;return null!=w.y&&(!!(0,O.yE)(J,le.$6)||(0,O.yE)(J,le.Ps)&&0===d||(0,O.yE)(J,le.Z$)&&d===M.length-1||(0,O.yE)(J,le.pd)&&w.y<0||(0,O.yE)(J,le.Zc)&&w.y===c||(0,O.yE)(J,le.O3)&&w.y===H||(0,O.yE)(J,le.qC)&&null==(null===(V=M[d-1])||void 0===V?void 0:V.y)&&null==(null===(Z=M[d+1])||void 0===Z?void 0:Z.y))})}(n,M);if(!_.isEmpty(m)){var L="markerKey".concat(Z).concat(V).concat(K);b={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:L,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:Z.toString(),markerWidth:Z.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,ee.F)(K).toString(),"stroke-opacity":"1",stroke:V,fill:V},attributes:{d:(0,ee.Ar)(K)}}]}]},p={tagName:"path",attributes:{d:s(m)},classNames:[],styleProperties:{stroke:c,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(L,")"),"marker-mid":"url(#".concat(L,")"),"marker-end":"url(#".concat(L,")")}}}return{tagName:"svg",children:p?[b,S,p]:[S],classNames:[],styleProperties:{},attributes:{height:J+"px",width:U+"px"}}}(U,v,t,G):function(M,U,J,G){var K,H=M.dataColor,c=M.isScalar,w=G.points,d=[G.lowX,G.highX],V=function(M,U,J,G,H){if(_.isEmpty(M))return 0;var d,V=G[G.length-1]-G[0];return H&&G&&G.length>1?(0!==V?(T.fF.assert(function(){return null!=U},"minXDifference cannot be null for scalar plotted as columns"),d=J*(U/(V+U))):d=J,d=Math.max(d,2)):d=J/(V+1),.8*d}(w,G.minXDifference,U,d,c),Z=V/2;K=c?d3.scaleLinear().domain(d).range([Z,U-Z]):d3.scalePoint().domain(_.map(_.range(G.lowX,G.highX+1),function(o){return o.toString()})).range([Z,U-Z]);var W=d3.extent(w,function(o){return o.y});W[0]=Math.min(0,W[0]),W[1]=Math.max(0,W[1]);var te=d3.scaleLinear().domain(W).range([J,0]),v=te(0),t=V.toString();return{tagName:"svg",children:_.chain(w).filter(function(o){return null!=o.y}).map(function(o){var l=(K(o.x)-Z).toString(),g=(v+(0,B.sc)(te,Math.max(0,o.y),0)).toString(),f=Math.abs((0,B.sc)(te,0,o.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:H},attributes:{x:l,y:g,width:t,height:f}}}).value(),classNames:[],styleProperties:{},attributes:{height:J+"px",width:U+"px"}}}(U,v,t,G))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(w&&"Before"!==w.layout?[V,M]:[M,V],function(g){return!!g})}}},11184:function(Re,we,X){X.d(we,{Q:function(){return oe},S:function(){return le}});var B=X(81337),fe=X(55007),ee=X(62458),oe=function(){function F(E){this.matrixNavigator=E}return F.prototype.setHierarchy=function(E){this.hierarchy=E,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},F.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},F.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},F.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},F.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},F.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},F.prototype.getHierarchyLeafAt=function(E){return this.hierarchy.leafNodes[E]},F.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},F.prototype.getFloatingHierarchyLeafAt=function(E){return this.floatingLeaves[E]},F.prototype.isBlank=function(E){return E.isBlankRow},F.prototype.isBlankRow=function(E){return this.getHierarchyLeafAt(E).isBlankRow},F.prototype.numberOfBlankRowsBefore=function(E){var T=this.getHierarchyLeafAt(E),O=this.getAncestor(T);return Math.floor(O.index/2)},F.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},F.prototype.getFloatingHierarchyItems=function(){return null},F.prototype.getLeafIndex=function(E){return this.matrixNavigator.getLeafIndex(E)},F.prototype.isLeaf=function(E){return this.matrixNavigator.isLeaf(E)},F.prototype.isLastItem=function(E,T){return this.matrixNavigator.isLastItem(E,T)},F.prototype.getAncestor=function(E){for(;E.parent;)E=E.parent;return E},F.prototype.getParent=function(E){return this.matrixNavigator.getParent(E)},F.prototype.getIndex=function(E){return this.matrixNavigator.getIndex(E)},F.prototype.getNodeLeafCount=function(E){var T=this;return this.isLeaf(E)?1:_.sum(_.map(E.children,function(O){return T.getNodeLeafCount(O)}))},F.prototype.getIndexOfFirstLeaf=function(E){for(;!_.isEmpty(E.children);)E=E.children[0];return this.getLeafIndex(E)},F.prototype.getPathIndices=function(E){for(var T=[this.getIndex(E)],O=this.getParent(E);O;)T=(0,B.__spreadArray)([this.getIndex(O)],T||[],!0),O=this.getParent(O);return T},F.prototype.getNodeFromPath=function(E){var T=this.hierarchy.levels.length||1;if(!(_.isEmpty(E)||E.length>T)){for(var O=this.hierarchy.root,Q=0,i=E;Q<i.length;Q++)if(!(O=O.children[i[Q]]))return;return O}},F.prototype.getLeafAncestorAtLevel=function(E,T,O){if(ee.fF.assertValue(E,"Undefined leaf node"),ee.fF.assert(function(){return T>=0},"Invalid target level"),!(T>this.getLevel(E))){for(var Q=E;this.getLevel(Q)>T;){if(Q=this.getParent(Q),O&&this.getLevel(Q)<T)return;ee.fF.assertValue(Q,"reached root without finding a matching ancestor")}return Q}},F.prototype.getItemsByLevel=function(E){var T=[];return this.findLevelItems(E,this.hierarchy.root,-1,T),T},F.prototype.findLevelItems=function(E,T,O,Q){if(!_.isEmpty(T.children))for(var i=O+1,C=0,r=T.children;C<r.length;C++){var e=r[C];i===E||i+this.matrixNavigator.getChildrenLevelDifference(e)>E?Q.push(e):i<E&&this.findLevelItems(E,e,i,Q)}},F.prototype.getExpansionState=function(E){return E.isCollapsed?1:!1===E.isCollapsed?0:2},F.prototype.getChildren=function(E){return this.matrixNavigator.getChildren(E)},F.prototype.getLevel=function(E){return this.matrixNavigator.getLevel(E)},F.prototype.getIntersection=function(E,T){var O=this.matrixNavigator.getIntersection(E,T);return O&&O.objects&&(O.icon=fe.FX.PropValuesIcon.getValue(O.objects),O.hyperlink=fe.FX.PropValuesWebURL.getValue(O.objects),O.altText=fe.FX.PropAltTextValue.getValue(O.objects)),O},F.prototype.getCorner=function(E,T){return this.matrixNavigator.getCorner(E,T)},F.prototype.getRowLevel=function(E){return E.rowLevel},F.prototype.getColumnLevel=function(E){return E.columnLevel},F.prototype.getRowHeaderMetadataColumn=function(E){return this.matrixNavigator.getRowHeaderMetadataColumn(E)},F.prototype.getRowHeaderMetadataColumns=function(E){return this.matrixNavigator.getRowHeaderMetadataColumns(E)},F.prototype.getColumnHeaderMetadataColumn=function(E){return this.matrixNavigator.getColumnHeaderMetadataColumn(E)},F.prototype.getColumnHeaderMetadataColumns=function(E){return this.matrixNavigator.getColumnHeaderMetadataColumns(E)},F.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},F.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},F.prototype.isColumnHeaderMultiValueSubtotal=function(E){return E.isSubtotal&&E.parent&&E.parent.isSubtotal},F.prototype.isRowHeaderMultiValueSubtotal=function(E){return this.valuesOnRowApplied()&&E.parent&&E.parent.isSubtotal},F.prototype.getLeaves=function(E,T){if(!_.isEmpty(E))for(var O=0,Q=E;O<Q.length;O++){var i=Q[O];this.isLeaf(i)?T.push(i):this.getLeaves(this.getChildren(i),T)}},F.prototype.getColumnIndexFromQueryName=function(E){return null},F}(),le=function(F){function E(){return null!==F&&F.apply(this,arguments)||this}return(0,B.__extends)(E,F),E.prototype.getIntersection=function(T,O){return this.isLeaf(T)||_.isEmpty(T.children)||!T.children[0].isSubtotal||this.valuesOnRowApplied()?F.prototype.getIntersection.call(this,T,O):F.prototype.getIntersection.call(this,T.children[0],O)},E.prototype.getChildren=function(T){return ee.fF.assertValue(T,"item"),!_.isEmpty(T.children)&&T.children[0].isSubtotal?T.children.slice(1):T.children},E.prototype.getHierarchyDepth=function(){return F.prototype.getHierarchyDepth.call(this)>0?1:0},E.prototype.getCorner=function(T,O){var Q=O===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return F.prototype.getCorner.call(this,Q,O)},E.prototype.getFloatingHierarchyItems=function(){var T=this.getHierarchyItems();if(_.isEmpty(T))return null;for(var O=0,Q=[];;){var i=T[O];if(!i||!i.isSubtotal)break;Q.push(i),O++}return _.isEmpty(Q)?null:Q},E.prototype.isRowHeaderMultiValueSubtotal=function(T){return this.valuesOnRowApplied()&&T.isSubtotal},E.prototype.getLeaves=function(T,O){if(!_.isEmpty(T))for(var Q=0,i=T;Q<i.length;Q++){var C=i[Q];O.push(C),this.getLeaves(this.getChildren(C),O)}},E.prototype.getPathIndices=function(T){return[this.getLeafIndex(T)]},E.prototype.getNodeFromPath=function(T){if(1===T.length)return this.getHierarchyLeafAt(T[0])},E.prototype.getItemsByLevel=function(T){return ee.fF.assert(function(){return 0===T},"Stepped PivotTable rows hierarchy has 1 level"),(0,B.__spreadArray)([],this.getHierarchyLeafNodes()||[],!0)},E.prototype.getLeafAncestorAtLevel=function(T,O){return ee.fF.assert(function(){return 0===O},"Stepped PivotTable rows hierarchy has 1 level"),ee.fF.assertValue(T,"Undefined leaf node"),T},E}(oe)},76797:function(Re,we,X){X.d(we,{D:function(){return O},l:function(){return i}});var B=X(81337),fe=X(85196),ee=X(66232),oe=X(62458),le=X(78843),F=X(93340),E=X(71090),T=X(21242),O=function(C){return C[C.RowHeader=0]="RowHeader",C[C.ColumnHeader=1]="ColumnHeader",C[C.BodyCell=2]="BodyCell",C}({});function Q(C){return 0===C.type}var i=function(){function C(r,e){this.hostServices=r,this.featureSwitches=e,this.clearLocal()}return C.prototype.onItemContextMenu=function(r,e,h,y,I){var M;(0,ee.n)(h),!this.isEmpty()&&this.isItemSelected(r,!0)?(M=this.selectedItems,e=this.selectionMode):M=[r];var U=this.createContextMenuArgs(r,e,M,h,y,I);U&&this.hostServices.onContextMenu(U)},C.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},C.prototype.isDrillingEnabled=function(r,e,h){var y=this.createSelectingArgs(r,h,e);return this.hostServices.onSelecting(y),1===y.action},C.prototype.select=function(r,e,h){this.updateSelection(r,e,h,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(r)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,h))},C.prototype.getSelectionScreenReaderMessage=function(r){var e,h,y;switch(this.indicatorStyle){case O.RowHeader:h=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(r));var I=1===this.rowHierarchyNavigator.getExpansionState(r);e=_.isEmpty(this.selectedItems)?!h||r.isSubtotal||I?"Row_Group_Unselected":"Row_Unselected":!h||r.isSubtotal||I?"Row_Group_Selected":"Row_Selected";break;case O.ColumnHeader:y=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(r)),e=_.isEmpty(this.selectedItems)?y&&!r.isSubtotal?"Column_Unselected":"Column_Group_Unselected":y&&!r.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case O.BodyCell:h=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(r.rowItem)),y=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(r.columnItem)),e=_.isEmpty(this.selectedItems)?h&&y&&!r.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":h&&y&&!r.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:e="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(e)},C.prototype.getIndicatorStyle=function(){return this.indicatorStyle},C.prototype.updateSelection=function(r,e,h,y){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in r&&(r.isRowAndColumnGrandTotal||r.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!y&&e!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(r))if(this.isItemSelected(r,y)){if(y)return!1;1===this.selectedItems.length&&1!==h?this.clearLocal():3===h?this.unselectItem(r):0===h&&(this.selectedItems=[r])}else(0===h||e!==this.selectionMode)&&this.clearLocal(),this.selectionMode=e,this.indicatorStyle=e,this.selectedItems.push(r),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[r]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return r.isRowGrandTotal?this.indicatorStyle=O.ColumnHeader:r.isColumnGrandTotal&&(this.indicatorStyle=O.RowHeader),!0},C.prototype.isRowHeaderHighlighted=function(r){if(this.isEmpty())return!0;for(var e=0,h=this.selectedItems;e<h.length;e++)if(this.isRowHeaderOnSelectedPath(h[e],r))return!0;return!1},C.prototype.isColumnHeaderHighlighted=function(r){if(this.isEmpty())return!0;for(var e=0,h=this.selectedItems;e<h.length;e++)if(this.isColumnHeaderOnSelectedPath(h[e],r))return!0;return!1},C.prototype.isRowHeaderIndicatorOn=function(r,e){var h=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(M){return h.isRowHeaderOnSelectedPath(M,r,!0,!e)})&&!(this.indicatorStyle===O.ColumnHeader)},C.prototype.isRowHeaderDarkened=function(r){var e=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(I){return e.isRowHeaderOnSelectedPath(I,r,!0,!1)})&&this.indicatorStyle===O.RowHeader},C.prototype.isColumnHeaderIndicatorOn=function(r){var e=this;if(!this.featureSwitches.a11yMatrix)return!1;var h=this.columnHierarchyNavigator.isLeaf(r),y=_.some(this.selectedItems,function(M){return e.isColumnHeaderOnSelectedPath(M,r)});return h&&y&&!(this.indicatorStyle===O.RowHeader)},C.prototype.isColumnHeaderDarkened=function(r){var e=this;return _.some(this.selectedItems,function(I){return e.isColumnHeaderOnSelectedPath(I,r)})&&!(this.indicatorStyle===O.RowHeader)},C.prototype.isBodyCellHighlighted=function(r){if(this.isEmpty())return!0;for(var e=0,h=this.selectedItems;e<h.length;e++)if(this.isBodyCellOnSelectedPath(h[e],r))return!0;return!1},C.prototype.isBodyCellIndicatorOn=function(r){if(this.isEmpty())return!1;for(var e=0,h=this.selectedItems;e<h.length;e++)if(this.isBodyCellOnSelectedPath(h[e],r)&&this.indicatorStyle===O.BodyCell)return!0;return!1},C.prototype.isRowHeaderOnSelectedPath=function(r,e,h,y){return this.indicatorStyle===O.ColumnHeader||(I=Q(r)?r.rowItem:r,this.isOnSelectedPath(this.getEffectiveSelectedHeader(I),e,h,y));var I},C.prototype.isColumnHeaderOnSelectedPath=function(r,e){return this.indicatorStyle===O.RowHeader||(h=Q(r)?r.columnItem:r,this.isOnSelectedPath(this.getEffectiveSelectedHeader(h),e));var h},C.prototype.isBodyCellOnSelectedPath=function(r,e){return this.isRowHeaderOnSelectedPath(r,e.rowItem)&&this.isColumnHeaderOnSelectedPath(r,e.columnItem)},C.prototype.isOnSelectedPath=function(r,e,h,y){if(!r||r===e)return!0;var I=r;if(!h)for(;I;){if(I===e)return!0;I=I.parent}if(I=e,!y)for(;I;){if(I===r)return!0;I=I.parent}return!1},C.prototype.onDataViewChanged=function(r,e){this.rowHierarchyNavigator=r,this.columnHierarchyNavigator=e;var h=r&&r.getHierarchyItems(),y=e&&e.getHierarchyItems();if(!this.isEmpty()){for(var I=[],M=0,U=this.selectedItems;M<U.length;M++){var J=U[M],G=C.getMatchingItem(J,this.selectionMode,h,y,r);I.push(G||J)}this.selectedItems=I}},C.getMatchingItem=function(r,e,h,y,I){if(r.isBlankRow)return null;switch(e){case O.RowHeader:return this.getMatchingHeader(r,h);case O.ColumnHeader:return this.getMatchingHeader(r,y);case O.BodyCell:var M=r,U=this.getMatchingHeader(M.rowItem,h),J=this.getMatchingHeader(M.columnItem,y);return U&&J?I.getIntersection(U,J):null}},C.getMatchingHeader=function(r,e){if(e)for(var h=0,y=e;h<y.length;h++){var I=y[h];if(this.areHeadersEqual(r,I))return I;var M=this.getMatchingHeader(r,I.children);if(M)return M}return null},C.areHeadersEqual=function(r,e){if(oe.fF.assert(function(){return!!r&&!!e},"items cannot be null"),(0,le.fS)(r.identity,e.identity)&&r.queryName===e.queryName){if(!r.parent&&!e.parent)return!0;if(r.parent&&e.parent)return this.areHeadersEqual(r.parent,e.parent)}return!1},C.getMatchingItemById=function(r,e,h,y,I){var M=_.keys(r.dataMap),U=_.chain(I.getColumnHierarchy().levels).filter(function(c){return!c.sources[0].isMeasure}).map(function(c){return c.sources[0].queryName}).filter(function(c){return _.includes(M,c)}).value(),J=_.chain(I.getRowHierarchy().levels).map(function(c){return c.sources[0].queryName}).filter(function(c){return _.includes(M,c)}).value();switch(e){case O.RowHeader:return this.getMatchingHeaderById(r,J,h);case O.ColumnHeader:return this.getMatchingHeaderById(r,U,y);case O.BodyCell:var G=this.getMatchingHeaderById(r,J,h),H=this.getMatchingHeaderById(r,U,y);return G&&H?I.getIntersection(G,H):null}},C.getMatchingHeaderById=function(r,e,h){if(h)for(var y=0,I=h;y<I.length;y++)for(var M=I[y],U=function(d,V){var Z=e[d];if(J.headerMatchesId(r,Z,M)){if(1===V)return{value:M};oe.fF.assertAnyValue(M.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var K=J.getMatchingHeaderById(r,_.filter(e,function(W){return W!==Z}),M.children);if(K)return{value:K}}},J=this,G=0,H=e.length;G<H;G++){var c=U(G,H);if("object"==typeof c)return c.value}return null},C.headerMatchesId=function(r,e,h){return oe.fF.assert(function(){return!!r&&!!h},"items cannot be null"),!!(e===h.queryName&&r.dataMap&&r.dataMap[e]&&(0,le.fS)(_.head(r.dataMap[e]),h.identity))},C.areCornerItemsEqual=function(r,e){return!(!r.metadata||!e.metadata)&&r.metadata.queryName===e.metadata.queryName},C.prototype.clearLocal=function(){this.selectedItems=[]},C.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.restoreSelectionState=function(r,e){if(this.clearLocal(),_.isEmpty(r))return!0;for(var h=!1,y=this.selectedItems,I=0,M=r;I<M.length;I++){var U=M[I],J=this.determineSelectionModeFromIds(U,e);if(null!=J){this.selectionMode=J,this.indicatorStyle=J;var G=C.getMatchingItemById(U,J,e.getRowHierarchy().root.children,e.getColumnHierarchy().root.children,e);G&&(y.push(G),h=!0,G.isRowGrandTotal?this.indicatorStyle=O.ColumnHeader:G.isColumnGrandTotal&&(this.indicatorStyle=O.RowHeader))}}return h},C.prototype.determineSelectionModeFromIds=function(r,e){if(!r)return this.selectionMode;var h=_.map(e.getColumnHierarchy().levels,function(J){return J.sources[0].queryName}),y=!1,I=_.map(e.getRowHierarchy().levels,function(J){return J.sources[0].queryName}),M=!1;for(var U in r.dataMap)if(_.includes(h,U))y=!0;else{if(!_.includes(I,U))return;M=!0}return y&&M?O.BodyCell:y?O.ColumnHeader:M?O.RowHeader:void 0},C.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.isItemSelected=function(r,e){void 0===e&&(e=!1);for(var h=Q(r)?r:void 0,y=0,I=this.selectedItems;y<I.length;y++){var M=I[y];if(Q(M)&&h){if(this.areBodyCellsEqual(M,h))return!0}else if(M===r)return!0}return!(!e||this.isEmpty()||!h)&&this.isBodyCellHighlighted(h)},C.prototype.unselectItem=function(r){var e=this;Q(r)?_.remove(this.selectedItems,function(h){return e.areBodyCellsEqual(h,r)}):_.pull(this.selectedItems,r)},C.prototype.areBodyCellsEqual=function(r,e){return r.rowItem===e.rowItem&&r.columnItem===e.columnItem},C.prototype.getEffectiveSelectedHeader=function(r){return r&&!r.identity&&r.parent?this.getEffectiveSelectedHeader(r.parent):r},C.prototype.getEffectiveSelectedNodes=function(r){return r.parent?[this.getEffectiveSelectedHeader(r)]:r.identity?[r]:r.siblings},C.getRoleNames=function(r){switch(r){case O.ColumnHeader:return[fe.r.columns];case O.RowHeader:return[fe.r.rows];case O.BodyCell:return[fe.r.values];default:oe.fF.assertFail("unexpected PivotTableSelectionMode")}},C.prototype.createSelectingArgs=function(r,e,h){return{type:0,visualObjects:this.getVisualObjects([r]),position:C.getMouseEventPosition(h),dataRoles:C.getRoleNames(e)}},C.prototype.createSelectArgs=function(r,e){for(var h=[],y=0,I=r;y<I.length;y++){var U=this.createSelectorsByColumn(I[y]);U&&h.push({objectName:"",selectorsByColumn:U})}return{type:0,visualObjects:this.getVisualObjects(r),selectionMode:e}},C.prototype.getVisualObjects=function(r){for(var e=[],h=0,y=r;h<y.length;h++){var M=this.createSelectorsByColumn(y[h]);M&&e.push({objectName:"",selectorsByColumn:M})}return e},C.prototype.createContextMenuArgs=function(r,e,h,y,I,M){for(var J,G,H,c,w,d,U=this,V=[],Z=0,K=h;Z<K.length;Z++){var te=this.createSelectorsByColumn(K[Z]);te&&V.push(te)}var o,v={dataRoles:I,data:V,position:C.getMouseEventPosition(y)};if(Q(r)||(v.nodeIndex=this.getHierarchyNodeIndex(r)),(_.isEmpty(V)||V.every(function(f){return _.isEmpty(f.dataMap)}))&&Q(r)&&r.isRowAndColumnGrandTotal){var t=null===(H=null===(G=null===(J=r.columnMetadata)||void 0===J?void 0:J.type)||void 0===G?void 0:G.misc)||void 0===H?void 0:H.sparkline;return v.copyArgs={singleValue:function(){return t?r.textContent:String(r.dataPoint)}},v}if(Q(r))if(null===(d=null===(w=null===(c=r.columnMetadata)||void 0===c?void 0:c.type)||void 0===w?void 0:w.misc)||void 0===d?void 0:d.sparkline)o=r.textContent;else{var g=r.dataPoint;null!=g&&(o=(0,F.pW)(g))}else o=r.tooltipValueFormatted;return v.copyArgs={grid:function(){return U.generateGridCopyCallback(h,e)}},void 0!==o&&(v.copyArgs.singleValue=function(){return String(o)}),this.featureSwitches.a11yShowAsMatrix&&(v.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,B.__awaiter)(U,void 0,void 0,function(){return(0,B.__generator)(this,function(s){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,B.__awaiter)(U,void 0,void 0,function(){return(0,B.__generator)(this,function(s){return[2,!M]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,B.__awaiter)(U,void 0,void 0,function(){return(0,B.__generator)(this,function(s){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,B.__awaiter)(U,void 0,void 0,function(){return(0,B.__generator)(this,function(s){return[2,M]})})}}]),v},C.prototype.generateGridCopyCallback=function(r,e){var I,h=r.slice(),y=[];switch(e){case O.BodyCell:h=this.collectSelectedBodyNodes(h),I=(0,T.kH)(h,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(E.yF)),y.push.apply(y,(0,B.__spreadArray)([I.headers],I.values||[],!1));break;case O.ColumnHeader:for(var M=[],U=0,J=h;U<J.length;U++){var G=J[U];this.columnHierarchyNavigator.isLeaf(G)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(G).isMeasure?M.push.apply(M,G.siblings||[]):M.push(G)}I=(0,T.mM)([],h=M,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(E.yF)),y.push.apply(y,(0,B.__spreadArray)([I.headers],I.values||[],!1));break;case O.RowHeader:I=(0,T.mM)(h,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(E.yF)),y.push.apply(y,(0,B.__spreadArray)([I.headers],I.values||[],!1));break;default:oe.fF.assertNever(e)}return{grid:y,coveragePercentage:I?I.coveragePercentage:void 0}},C.prototype.getHierarchyNodeIndex=function(r){for(var e=[];r&&null!=r.index;)e.splice(0,0,r.index),r=r.parent;return e},C.prototype.collectSelectedBodyNodes=function(r){for(var e=[],h=0,y=r;h<y.length;h++){var I=y[h];if(!I.isSubtotal&&I.columnItem.identity&&I.rowItem.identity)e.push(I);else{var M=[],U=[];I.isRowGrandTotal||(M=this.getEffectiveSelectedNodes(I.rowItem)),I.isColumnGrandTotal||(U=this.getEffectiveSelectedNodes(I.columnItem));var J=(0,T.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,M,U);e.push.apply(e,J||[])}}for(var G=0;G<e.length;G++)for(var H=e[G],c=G+1;c<e.length;c++)_.isEqual(H,e[c])&&(e.splice(c,1),c--);return e},C.prototype.createSelectorsByColumn=function(r){return Q(r)?this.createSelectorsByColumnForBodyCell(r):this.createSelectorsByColumnForHeader(r)},C.prototype.createSelectorsByColumnForHeader=function(r){var e=r.queryName,h={};return C.addHeaderIdentities(r,h)?{dataMap:h,metadata:[e]}:void 0},C.prototype.createSelectorsByColumnForBodyCell=function(r){var e,h={},y=C.addHeaderIdentities(r.rowItem,h),I=C.addHeaderIdentities(r.columnItem,h),M=null===(e=r.columnMetadata)||void 0===e?void 0:e.queryName;return oe.fF.assert(function(){return y||I||!!M},"Must have a row or column identity or column metadata"),{dataMap:h,metadata:M?[M]:void 0}},C.addHeaderIdentities=function(r,e){for(var h=[];r;)r.identity&&h.splice(0,0,r),r=r.parent;for(var y=0,I=h;y<I.length;y++){var M=I[y];e[M.queryName]=[M.identity]}return h.length>0},C.hasIdentity=function(r){return C.addHeaderIdentities(r,{})},C.getMouseEventPosition=function(r){return{x:r.clientX,y:r.clientY}},C}()},59784:function(Re,we,X){X.d(we,{S:function(){return fe}});var B=X(76797),fe=function(){function ee(oe){this.hostServices=oe}return ee.prototype.onDataViewChanged=function(oe,le,F,E,T){this.isSteppedLayout=E,this.valuesOnRowApplied=T,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(oe),this.valueSources=F,this.hasRows=oe&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=le&&!_.isEmpty(le.levels),this.measureCount=F?F.length:0},ee.hasSortingChanged=function(oe,le){if(!oe||!le)return!1;var F=oe.metadata.columns;if(_.isEmpty(F))return!1;var E=le.metadata.columns;if(_.isEmpty(E))return!1;for(var T=function(e){var h=_.find(F,function(y){return e.queryName===y.queryName});if(h&&e.sort!==h.sort)return{value:!0}},O=0,Q=E;O<Q.length;O++){var C=T(Q[O]);if("object"==typeof C)return C.value}return!1},ee.prototype.isCornerSortable=function(oe){return this.hasRows&&null!=oe.metadata&&oe.position.row.isLast&&(!this.valuesOnRowApplied||!oe.position.column.isLast)},ee.prototype.getNonMeasureRowLevels=function(oe){if(this.valuesOnRowApplied){var le=[];return le.push.apply(le,oe.levels||[]),le.pop(),le}return oe.levels},ee.prototype.isColumnHeaderSortable=function(oe){var le=B.l.hasIdentity(oe);return this.hasRows&&this.measureCount>0&&!le&&oe.position.row.isLast&&!this.valuesOnRowApplied},ee.prototype.getCornerSortDirection=function(oe){if(!this.isCornerSortable(oe))return null;if(this.isSteppedLayout){for(var le=null,F=0,E=this.nonMeasureRowLevels;F<E.length;F++){var T=E[F];if(1!==T.sources.length)return null;var O=T.sources[0].sort;if(null==O)return null;if(null!==le){if(O!==le)return null}else le=O}return le}return this.nonMeasureRowLevels[oe.position.column.index].sources[0].sort},ee.prototype.getColumnHeaderSortDirection=function(oe){return this.isColumnHeaderSortable(oe)?this.getMeasureSortDirection(this.getMeasureQueryName(oe)):null},ee.prototype.getMeasureQueryName=function(oe){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:oe.queryName},ee.prototype.sortCorner=function(oe){var E,le=this.getCornerSortDirection(oe),F=ee.getNextSortDirection(le);if(this.isSteppedLayout){E=[];for(var T=0,O=this.nonMeasureRowLevels;T<O.length;T++)E.push({queryName:O[T].sources[0].queryName,sortDirection:F})}else E=[{queryName:oe.metadata.queryName,sortDirection:F}];this.hostServices.onCustomSort({sortDescriptors:E,suppressAnnouncements:!0})},ee.prototype.sortColumnHeader=function(oe){var le=this.getColumnHeaderSortDirection(oe),F=this.getMeasureColumn(this.getMeasureQueryName(oe));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(oe),sortDirection:ee.getNextSortDirection(le,F)}],suppressAnnouncements:!0})},ee.getNextSortDirection=function(oe,le){return void 0===oe?ee.getDefaultSortDirection(le):1===oe?2:1},ee.getDefaultSortDirection=function(oe){return oe&&oe.isMeasure&&oe.type&&oe.type.numeric&&!oe.type.temporal?2:1},ee.prototype.getMeasureSortDirection=function(oe){var le=this.getMeasureColumn(oe);if(null!=le)return le.sort},ee.prototype.getMeasureColumn=function(oe){return _.find(this.valueSources,function(le){return le.queryName===oe})},ee}()},97654:function(Re,we,X){X.r(we),X.d(we,{TableEx:function(){return Ce}});var B=X(81337),fe=X(3665),ee=X(51650),oe=X(57622),le=X(28579),F=X(80065),E=X(51660),T=X(86900),O=X(35249),Q=X(55007),i=X(40739),C=X(40550),r=X(62458),e=X(57419),h=X(59107),y=X(46135),I=X(32379),M=X(72489),U=X(79465),J=X(24133),G=X(93340),H=X(71090),c=X(73889),w=X(74304),d=X(2142),V=X(54522),Z=X(44977),K=X(32105),W=X(19650),te=X(64067),v=X(79154),t=X(39681),o=X(48066),l=X(38078),g=X(58702),f=X(7911),s=X(87914),n=X(59784),u=X(91468),S=X(32771),b=X(29043),p=X(44245),m=function(){function x(a,P){this.isA11yTable=P,this.hostServices=a}return x.prototype.sort=function(a,P,N){void 0===N&&(N=!1);var pe,j=x.getSortDirection(a),q=n.S.getNextSortDirection(j,a.metadata),ne=a.metadata.queryName,de={queryName:ne,sortDirection:q};N?(pe=_.chain(P).filter(function(ge){return void 0!==ge.sortOrder&&ge.queryName!==ne}).sortBy(function(ge){return ge.sortOrder}).map(function(ge){return{queryName:ge.queryName,sortDirection:ge.sort}}).value()).push(de):pe=[de],this.hostServices.onCustomSort({sortDescriptors:pe,suppressAnnouncements:this.isA11yTable})},x.hasSortingChanged=function(a,P){if(!a||!P)return!1;var N=a.metadata.columns;if(_.isEmpty(N))return!1;var j=P.metadata.columns;if(_.isEmpty(j))return!1;for(var q=function(z){var ie=_.find(N,function(ce){return z.queryName===ce.queryName});if(ie&&z.sort!==ie.sort)return{value:!0}},ne=0,de=j;ne<de.length;ne++){var ge=q(de[ne]);if("object"==typeof ge)return ge.value}return!1},x.getSortDirection=function(a){return a.metadata.sort},x}(),L=function(){function x(a,P,N,j,q){this.a11yMatrixFS=q,this.options=a,this.selectionManager=P,this.measureElement=(0,u.qk)(N),this.legacyTooltipsEnabled=!0,this.hostServices=j}return x.prototype.setFormatMode=function(a){this.formatMode=a},x.prototype.getRowLabelAndRole=function(a){var P=this.hostServices.getLocalizedString(H.Mh),N="gridcell";return null!=a?.dataPoint&&(P=this.hostServices.getLocalizedString("Visual_Tablix_ReferenceRowWithText",a.dataPoint.toString()),N="rowheader"),{rowLabel:(0,l.HZ)(P),rowRole:N}},x.prototype.getRowHeaderBinding=function(a,P,N,j,q){this.options.onBindRowHeader&&!P&&this.options.onBindRowHeader(a);var ne=this.getRowLabelAndRole(q),de=ne.rowLabel,ge={attributes:{role:ne.rowRole},classNames:[],styleProperties:{},children:[]};return j||(ge.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":a.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:de,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(a)&&(ge.children[0].children[0].attributes.checked="")),ge},x.prototype.getColumnHeaderBinding=function(a,P,N,j,q,ne){var de,pe=this.formattingProperties.columnHeaders,ge=this.formattingProperties.columnFormatting[a.metadata.queryName],A=(0,l.HZ)(this.getColumnHeaderLabel(a)),z={},ie=m.getSortDirection(a);N&&(z.role="columnheader",z["aria-colindex"]=(0,G.jT)(a.position.column.index).toString(),1===ie?z["aria-sort"]="ascending":2===ie&&(z["aria-sort"]="descending")),_.isEmpty(A)&&(A=H.jv),pe.wordWrap&&(A=(0,u.rP)(A));var ce=!_.isEmpty(A.trim()),me=this.getColumnHeaderStyle(a,P,ce),ye=me.getExtraBottom();me.paddings.bottom+=(0,u.tO)(this.glyphFontInfo.measuredFontHeight);var Pe=(0,u.Km)(ie,this.options.sortIconEnabled,this.options.sortingEnabled,n.S.getDefaultSortDirection(a.metadata),ye,this.glyphFontInfo.textProperties.fontSize,this.hostServices);A+=f.bG.build(Pe,{});var Me=(0,t.ED)(this.columnHeaderClasses);return j&&(Me.push(E.cy),z[E.Ez]="".concat("columnHeaders"),z[E.QZ]="".concat(1),z[E.CK]="Visual_Tablix_ColumnHeaders"),(0,u.aY)(ge&&ge.styleHeader&&ge.alignment||pe.alignment,Me),!(null===(de=this.isHeaderAutoWidth)||void 0===de)&&de.call(this,a)&&(me.maxWidth=this.getMeasureElementMaxWidth(P)),{content:A,classNames:Me,styleProperties:me.getAttributes(N,void 0,this.a11yMatrixFS,ne),attributes:z}},x.prototype.getRowReferenceQueryName=function(){return this.formattingProperties.rowWithReferenceText.rowWithReferenceText},x.prototype.blankRowsEnabled=function(){return!1},x.prototype.getRowBinding=function(a,P,N,j){this.options.onBindRowHeader&&this.options.onBindRowHeader(a);var q=this.getRowLabelAndRole(N),pe={classNames:[],attributes:{},styleProperties:{},children:[this.getCheckboxCellBinding(a,P,q.rowLabel,j,q.rowRole)]};return this.selectionManager.isRowHighlighted(a)?this.selectionManager.isItemSelected(a)&&pe.classNames.push("row-selected"):pe.classNames.push("row-unselected"),this.formatMode&&pe.classNames.push("format-mode"),pe},x.prototype.getCheckboxCellBinding=function(a,P,N,j,q){var ne={attributes:{role:q,"aria-colindex":"1",tabindex:"0","selection-cell":""},classNames:["cell-interactive"],styleProperties:{position:"absolute","box-sizing":"border-box",width:"100%",height:"100%","--outline-top":j.weightTop+1+"px","--outline-right":j.weightRight+1+"px","--outline-bottom":j.weightBottom+1+"px","--outline-left":j.weightLeft+1+"px"}};return P||(ne.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":a.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:N,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(a)&&(ne.children[0].children[0].attributes.checked="")),ne},x.prototype.getBodyCellBinding=function(a,P,N,j,q,ne,de,pe){var ge,ce,z=(0,l.HZ)(this.getBodyCellContent(a)),ie={},me=!_.isEmpty(z.trim()),ye=this.getBodyCellStyle(a,P,me),Pe=a.columnMetadata;r.fF.assertValue(Pe,"Body cell with no column metadata");var Ie,Me=this.columnsDataBarsSettings[a.columnMetadata.queryName],He=this.shouldApplyDataBars(Me,a),xe=this.formattingProperties.columnFormatting[Pe.queryName],Fe=(0,g.TS)(xe&&xe.icon,a.icon),Ve=a.hyperlink;if(Fe&&"IconOnly"===Fe.layout)z="";else if(_.isEmpty(z)&&(z=H.jv),a.isKpi)z=this.getKpiContentString(a),ie={};else if(He&&Me.hideText)z=P?H.jv:"";else{this.formattingProperties.values.wordWrap&&(z=(0,u.rP)(z));var _e=(0,G.MN)(a.columnMetadata,z);if(_e!==o.av.NONE)ce=(0,u.RP)(this.formattingProperties.values.urlIcon,_e),Ie=(0,u.RD)(z,(0,l.HZ)(a.textContent),ce,this.options.onHyperlinkClicked),Ve=void 0;else if(this.isImage(a)){var We=l.b$.encodeUriForImageDataSvg(a.textContent),Ne=this.formattingProperties.grid;Ie=(0,u.D2)((0,l.HZ)(We),Ne.imageHeight,Ne.imageWidth,(0,l.HZ)(a.altText))}else this.isSparkline(a)&&(z=P?H.jv:"")}this.options.hyperlinksEnabled&&(Ie||""!==z&&z!==H.jv)&&Ve&&(0,o.MN)(Ve)!==o.av.NONE&&(Ie=(0,u.RD)(Ie||z,(0,l.HZ)(Ve),null,this.options.onHyperlinkClicked,!0,!0));var Be,Ee={};if(null!==(ge=this.isBodyCellAutoWidth)&&void 0!==ge&&ge.call(this,a)){var Oe=this.getMeasureElementMaxWidth(P);void 0!==Oe&&(Ee["max-width"]=Oe)}if(this.a11yMatrixFS&&!P&&a.position.column.isFirst){var ze=this.selectionManager.getRowFromCell(a);if(this.selectionManager.isItemSelected(ze)){var Te=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,!0,!1,!0,U.p0.Body),Ae=de&&this.selectionManager.getRowFromCell(de),ke=Ae&&this.selectionManager.isItemSelected(Ae);Be={attributes:{"aria-hidden":"true"},classNames:[],styleProperties:{width:"100%",top:Te.weightTop+"px",bottom:ke?"0":Te.weightBottom+"px",left:Te.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]}}}var Le,Se=Ie=Ie?{tagName:"div",children:[Ie],classNames:[],styleProperties:Ee,attributes:{}}:{tagName:"div",content:z,classNames:[],styleProperties:Ee,attributes:{}};if(Fe&&(Le=this.getBodyCellFontInfo(a).measuredFontHeight,Se=(0,u.Ps)(Fe,Le,Ie,this.hostServices)),He&&!P&&(Se=(0,S.JF)(Se,Me,ye,a.dataPoint,this.hostServices)),!P&&this.isSparkline(a)&&(r.fF.assert(function(){return null!=N&&null!=j},"height and width should be defined for sparkline rendering"),Se=(0,b.MV)(Se,this.sparklineSettings[a.columnMetadata.queryName],ye,a.dataPoint,N,j,Fe,Le)),q&&(a.fontColor||a.backColor)){var De=this.hostServices.getLocalizedString(H.Sl);_.isEmpty(Se.children)?Se={attributes:{},classNames:[],styleProperties:{},children:[Se,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:De}]}:Se.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:De})}if(this.a11yMatrixFS&&Be&&(_.isEmpty(Se.children)?Se={attributes:{},classNames:[],styleProperties:{},children:[Se,Be]}:Se.children.push(Be)),ne){(ie=ie??{})[E.QZ]="".concat(1);var Ye=a.columnMetadata.isMeasure;a.isRowGrandTotal||a.isTotal?Ye||""===a.textContent?(Se.classNames.push(E.cy),ie[E.Ez]="".concat("totals"),ie[E.CK]="Visual_Tablix_TotalsSection"):""!==a.textContent&&(Se.classNames.push(E.cy),ie[E.Ez]="".concat("total-labels"),ie[E.CK]="Visual_Tablix_TotalsSection_Label",ie[E.kv]=JSON.stringify({reference:d.Z.total.label,style:0}).replace(/\"/g,"&quot;")):(Se.classNames.push(E.cy),ie[E.Ez]="".concat(Ye?"measure-values":"values"),ie[E.CK]="Visual_Tablix_Values")}return this.a11yMatrixFS&&(ze=this.selectionManager.getRowFromCell(a),this.selectionManager.isBodyCellHighlighted(a)?this.selectionManager.isItemSelected(ze)&&Se.classNames.push("cell-selected"):Se.classNames.push("cell-unselected")),this.addBodyCellClasses(a,!!ce,Ie.classNames,Se.classNames),this.addBodyCellStyleAttributes(a,ye,Se.styleProperties,q,j),Se.attributes=ie,Se},x.prototype.getMeasureElementMaxWidth=function(a){return this.formattingProperties.values.wordWrap&&a&&this.getViewport?"".concat(this.getViewport().width-s.zf-3,"px"):void 0},x.prototype.getCornerCellBinding=function(a,P,N){return N?{content:this.hostServices.getLocalizedString(H.uX),classNames:["visually-hidden"],attributes:{role:"columnheader","aria-colindex":"1",tabindex:"-1"},styleProperties:{}}:{content:"",classNames:null,styleProperties:null,attributes:void 0}},x.prototype.getApproximateRowHeaderWidth=function(a){return 0},x.prototype.getApproximateColumnHeaderWidth=function(a){var P,N,j,q,ne=this.getColumnHeaderStyle(a,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,u.JT)(this.getColumnHeaderLabel(a),this.getColumnHeaderFontInfo(a).textProperties):(0,u.X1)(this.getColumnHeaderLabel(a),this.getColumnHeaderFontInfo(a).textProperties))+(null!==(N=null===(P=ne.borders.left)||void 0===P?void 0:P.weight)&&void 0!==N?N:0)+(null!==(q=null===(j=ne.borders.right)||void 0===j?void 0:j.weight)&&void 0!==q?q:0)},x.prototype.getApproximateBodyCellWidth=function(a){var P,N,j,q,ne=0;if(a.icon){if(ne=this.getBodyCellFontInfo(a).measuredFontHeight,"IconOnly"===a.icon.layout)return ne;ne+=u.MO}if(a.isKpi)return ne+this.valueFontInfo.fontProperties.size.px;var de=a.columnMetadata&&this.columnsDataBarsSettings[a.columnMetadata.queryName];if(de&&de.hideText&&!a.isTotal&&_.isNumber(a.dataPoint))return ne;var pe=this.getBodyCellContent(a),ge=(0,G.MN)(a.columnMetadata,pe);if(ge!==o.av.NONE&&(0,u.RP)(this.formattingProperties.values.urlIcon,ge))return ne+this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return ne+this.formattingProperties.grid.imageWidth;if(this.isSparkline(a))return ne;var A=this.getBodyCellFontInfo(a),z=this.getBodyCellStyle(a,!0,!0);return ne+(this.formattingProperties.values.wordWrap?(0,u.JT)(pe,A.textProperties):(0,u.X1)(pe,A.textProperties))+(null!==(N=null===(P=z.borders.left)||void 0===P?void 0:P.weight)&&void 0!==N?N:0)+(null!==(q=null===(j=z.borders.right)||void 0===j?void 0:j.weight)&&void 0!==q?q:0)},x.prototype.getApproximateCornerCellWidth=function(a){return 0},x.prototype.getApproximateRowHeaderHeight=function(a,P){return 0},x.prototype.getApproximateColumnHeaderHeight=function(a,P){var N,j,q,ne,de,pe=this.getColumnHeaderFontInfo(a),ge=this.getColumnHeaderStyle(a,!0,!0);de=this.formattingProperties.columnHeaders.wordWrap&&null!=P?(0,u.do)(this.getColumnHeaderLabel(a),(0,u.x9)(P,ge),pe.textProperties).length:1;var A=null!==(j=null===(N=ge.borders.top)||void 0===N?void 0:N.weight)&&void 0!==j?j:0,z=null!==(ne=null===(q=ge.borders.bottom)||void 0===q?void 0:q.weight)&&void 0!==ne?ne:0;return pe.measuredFontHeight*de+A+z},x.prototype.getApproximateBodyCellHeight=function(a,P){var N,j,q,ne,de=this.getBodyCellFontInfo(a);if(a.icon&&"IconOnly"===a.icon.layout)return de.measuredFontHeight;if(a.isKpi)return this.valueFontInfo.fontProperties.size.px;var pe=this.getBodyCellContent(a),ge=(0,G.MN)(a.columnMetadata,pe);if(ge!==o.av.NONE&&(0,u.RP)(this.formattingProperties.values.urlIcon,ge))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(a))return de.measuredFontHeight;var A,z=this.getBodyCellStyle(a,!0,!0);this.formattingProperties.values.wordWrap&&null!=P?(a.icon&&(P-=de.measuredFontHeight+u.MO),A=(0,u.do)(pe,(0,u.x9)(P,z),de.textProperties).length):A=1;var ie=null!==(j=null===(N=z.borders.top)||void 0===N?void 0:N.weight)&&void 0!==j?j:0,ce=null!==(ne=null===(q=z.borders.bottom)||void 0===q?void 0:q.weight)&&void 0!==ne?ne:0;return de.measuredFontHeight*A+ie+ce},x.prototype.getApproximateCornerCellHeight=function(a,P){return 0},x.prototype.updateFormattingProperties=function(a,P,N,j){this.formattingProperties=P,this.legacyTooltipsEnabled=j;var q=P.general.textSize,ne=new u.Kq,de={},pe={},ge={};de.family=P.columnHeaders.fontFamily||H.F2,de.size=P.columnHeaders.fontSize||q,P.columnHeaders.bold&&(de.weight=v.en),P.columnHeaders.italic&&(de.style=v.BF),P.columnHeaders.underline&&(de.textDecoration=v.f0),this.columnHeaderFontInfo=(0,u.Od)(de,ne),pe.family=P.values.fontFamily||H.dG,pe.size=P.values.fontSize||q,P.values.bold&&(pe.weight=v.en),P.values.italic&&(pe.style=v.BF),P.values.underline&&(pe.textDecoration=v.f0),this.valueFontInfo=(0,u.Od)(pe,ne);var z,A=P.total.fontFamily;A||this.valueFontInfo.fontProperties.family!==H.dG?z=!0:this.valueFontInfo.fontProperties.family===H.dG&&(A=H.Zk),ge.family=A,ge.size=P.total.fontSize,P.total.bold&&z&&(ge.weight=v.en),P.total.italic&&(ge.style=v.BF),P.total.underline&&(ge.textDecoration=v.f0),this.totalFontInfo=(0,u.TQ)(this.valueFontInfo,ge,ne),this.glyphFontInfo=(0,u.Od)({family:H.Vz,size:K.B.createFromPt((P.columnHeaders.fontSize||q).pt*H.Yo),lineHeight:"100%"},ne),ne.measureAll(this.measureElement),this.columnHeaderClasses=[],this.columnHeaderClasses.push(this.formattingProperties.columnHeaders.wordWrap?u.n2:u.wV),this.options.interactivityIndicatorEnabled&&this.options.sortingEnabled&&this.columnHeaderClasses.push(u.VM),this.columnsDataBarsSettings={};var ie=P.columnFormatting;if(ie&&a&&a.table&&!_.isEmpty(a.table.columns))for(var ce=0,me=a.table.columns;ce<me.length;ce++)(Pe=(ye=me[ce]).queryName)&&ie[Pe]&&(this.columnsDataBarsSettings[Pe]=(0,S.az)(ye,ie[Pe].dataBarsSettings,N));this.sparklineSettings={};var Me=P.sparklines;if(Me&&a&&a.table&&!_.isEmpty(a.table.columns))for(var He=0,xe=a.table.columns;He<xe.length;He++){var ye,Pe;(Pe=(ye=xe[He]).queryName)&&Me[Pe]&&(this.sparklineSettings[Pe]=(0,b.wJ)(Me[Pe],ye.type,N))}},x.prototype.getColumnHeaderLabel=function(a){return this.ensureMeasuringSafeText(a.metadata.displayName,this.formattingProperties.columnHeaders.wordWrap)},x.prototype.getBodyCellContent=function(a){return this.ensureMeasuringSafeText(a.textContent,this.formattingProperties.values.wordWrap)},x.prototype.ensureMeasuringSafeText=function(a,P){var N;return a?P?_.isEmpty(null===(N=a.trim)||void 0===N?void 0:N.call(a))?"":a:(0,Z.zI)(a):""},x.prototype.addBodyCellStyleAttributes=function(a,P,N,j,q){P.setAttributes(N,j,void 0,this.a11yMatrixFS,q),N.position="relative",this.a11yMatrixFS||!this.selectionManager.isBodyCellHighlighted(a)&&!j&&(0,u.CQ)(N)},x.prototype.getColumnHeaderStyle=function(a,P,N){var j=new G.qZ(u.K2,u.K2);return(0,p.aV)(a.position,j,this.formattingProperties,this.getColumnFormatting(a.metadata),this.options.tablixProperties),j.fontFamily=void 0,this.formattingProperties.columnHeaders.underline&&N&&(j.textDecoration=v.f0),(0,u.Nk)(this.columnHeaderFontInfo,j,N),j},x.prototype.getBodyCellStyle=function(a,P,N){var j=new G.qZ(u.K2,u.K2);return a.isRowGrandTotal?((0,p.ji)(a.position,a,j,this.formattingProperties,this.getColumnFormatting(a.columnMetadata),this.options.tablixProperties),this.formattingProperties.total.underline&&N&&(j.textDecoration=v.f0),(0,u.Nk)(this.totalFontInfo,j,N)):((0,p.cP)(a.position,a,j,this.formattingProperties,this.getColumnFormatting(a.columnMetadata),this.options.tablixProperties),this.formattingProperties.values.underline&&N&&(j.textDecoration=v.f0),(0,u.Nk)(this.valueFontInfo,j,N)),j},x.prototype.getBorderInfo=function(a,P,N,j,q,ne){var de,pe,ge,A,ye,Pe,Me,He,xe,Fe,Ve,Ie,_e,z=0,ie=0,ce=0,me=0;switch(ne){case U.p0.Header:_e=this.formattingProperties.columnHeaders;break;case U.p0.Body:_e=this.formattingProperties.values;break;case U.p0.Footer:_e=this.formattingProperties.total;break;default:r.fF.assertNever(ne)}var We=null!==(de=_e.outlineWeight)&&void 0!==de?de:this.formattingProperties.grid.outlineWeight,Ne=null!==(pe=_e.outlineColor)&&void 0!==pe?pe:this.formattingProperties.grid.outlineColor,Ee=null===(ge=this.formattingProperties.grid)||void 0===ge?void 0:ge.gridHorizontalColor,Oe=null===(A=this.formattingProperties.grid)||void 0===A?void 0:A.gridVerticalColor,Be=(0,te.ok)("#FFFFFF",.67,Ee),ze=(0,te.ok)("#FFFFFF",.67,Oe);return a&&(0,C.yo)(_e.outline)&&(z=We,ye=G.Pb.Outline,xe=Ne),j&&(0,C.BK)(_e.outline)?(ie=We,Pe=G.Pb.Outline,Fe=Ne):!j&&this.formattingProperties.grid.gridVertical&&(ie=this.formattingProperties.grid.gridVerticalWeight,Pe=G.Pb.Gridline,Fe=this.selectionManager.isSelectionEmpty()?Oe:ze),P&&(0,C.mv)(_e.outline)?(ce=We,Me=G.Pb.Outline,Ve=Ne):!P&&this.formattingProperties.grid.gridHorizontal&&(ce=this.formattingProperties.grid.gridHorizontalWeight,Me=G.Pb.Gridline,Ve=q?Ee:Be),N&&(0,C.fs)(_e.outline)&&(me=We,He=G.Pb.Outline,Ie=Ne),{weightTop:z,weightRight:ie,weightBottom:ce,weightLeft:me,typeTop:ye,typeRight:Pe,typeBottom:Me,typeLeft:He,colorTop:xe,colorRight:Fe,colorBottom:Ve,colorLeft:Ie}},x.prototype.addBodyCellClasses=function(a,P,N,j){var ne,pe,q=this.formattingProperties.columnFormatting[a.columnMetadata.queryName];N.push(this.formattingProperties.values.wordWrap?u.n2:u.wV),P&&N.push(H.LU),this.options.interactivityIndicatorEnabled&&this.options.selectionEnabled&&!a.isRowGrandTotal&&!this.formatMode&&j.push(u.VM),q&&(a.isTotal?q.styleTotal:q.styleValues)&&(ne=q.alignment),P?pe=W.H.center:a.isNumeric&&(pe=W.H.right),(0,u.aY)(ne,N,pe)},x.prototype.getKpiContentString=function(a){return(0,u.kJ)(a.columnMetadata.kpi,a.textContent)},x.prototype.getColumnHeaderFontInfo=function(a){return this.columnHeaderFontInfo},x.prototype.getBodyCellFontInfo=function(a){return a.isRowGrandTotal?this.totalFontInfo:this.valueFontInfo},x.prototype.getColumnFormatting=function(a){return this.formattingProperties.columnFormatting[a.queryName]},x.prototype.shouldApplyDataBars=function(a,P){if(!a||!_.isNumber(P.dataPoint))return!1;switch(a.totalMatching){case 0:return!0;case 2:return P.isTotal;case 1:case void 0:return!P.isTotal;default:return r.fF.assertNever(a.totalMatching),!P.isTotal}},x.prototype.isImage=function(a){return!(a.isRowGrandTotal&&!_.isEmpty(a.columnMetadata.identityExprs))&&(0,V.pt)(a.columnMetadata)},x.prototype.isSparkline=function(a){var P,N=a.columnMetadata,j=null===(P=N?.type)||void 0===P?void 0:P.misc;return null!=j&&null!=j.sparkline},x}(),R=function(){function x(){}return x.prototype.getNodeLeafCount=function(){return 1},x.prototype.isBlank=function(){return!1},x.prototype.isBlankRow=function(a){return!1},x.prototype.numberOfBlankRowsBefore=function(a){return 0},x.prototype.getIndexOfFirstLeaf=function(a){return a.position.column.index},x.prototype.hasHierarchy=function(){return!0},x.prototype.update=function(a){this.updateColumns(a)},x.prototype.getColumns=function(){return this.columns},x.prototype.getHierarchyDepth=function(){return 1},x.prototype.getHierarchyLeafCount=function(){return _.size(this.columns)},x.prototype.getHierarchyLeafAt=function(a){return this.columns[a]},x.prototype.getFloatingHierarchyLeafCount=function(){return 0},x.prototype.getFloatingHierarchyLeafAt=function(a){return null},x.prototype.getHierarchyItems=function(){return this.columns},x.prototype.getFloatingHierarchyItems=function(){return null},x.prototype.getLeafIndex=function(a){return a.position.column.index},x.prototype.isLeaf=function(a){return!0},x.prototype.isLastItem=function(a,P){return a.position.column.index===P.length-1},x.prototype.getAncestor=function(a){return null},x.prototype.getParent=function(a){return null},x.prototype.getChildren=function(a){return null},x.prototype.getLevel=function(a){return 0},x.prototype.getIndex=function(a){return a.position.column.index},x.prototype.getPathIndices=function(a){return[this.getIndex(a)]},x.prototype.getNodeFromPath=function(a){if(1===a.length)return this.columns[a[0]]},x.prototype.getItemsByLevel=function(a){return r.fF.assert(function(){return 0===a},"Table columns hierarchy has 1 level"),(0,B.__spreadArray)([],this.columns||[],!0)},x.prototype.getLeafAncestorAtLevel=function(a,P){return a},x.prototype.getExpansionState=function(a){return 2},x.prototype.getFirstDescendentLeafIndex=function(a){return this.getLeafIndex(a)},x.prototype.getIntersection=function(a,P){return null},x.prototype.getCorner=function(a,P){return null},x.prototype.getRowLevel=function(a){return 0},x.prototype.getColumnLevel=function(a){return 0},x.prototype.isColumnHeaderMultiValueSubtotal=function(a){return!1},x.prototype.isRowHeaderMultiValueSubtotal=function(a){return!1},x.prototype.getColumnIndexFromQueryName=function(a){return _.find(this.columns,function(P){return P.metadata.queryName===a})},x.prototype.updateColumns=function(a){this.columns=[];for(var P=a.length,N=0;N<P;N++)this.columns.push({metadata:a[N],position:this.calculateItemPosition(N,P)})},x.prototype.calculateItemPosition=function(a,P){var N=new G.ri;return N.row.index=N.row.indexInSiblings=0,N.row.isFirst=!0,N.row.isLast=!0,N.column.index=N.column.indexInSiblings=a,N.column.isFirst=0===a,N.column.isLast=a===P-1,N},x}(),k=function(){function x(a,P){this.tablixProperties=a,this.hostServices=P}return x.prototype.update=function(a,P,N,j,q,ne){this.isDataComplete=j,this.formattingProperties=ne,this.formatters=ne.formatters,this.tooltipFormatters=ne.tooltipFormatters||{},this.updateRows(a,P),this.updateFloatingRow(N,q)},x.prototype.getNodeLeafCount=function(){return 1},x.prototype.getIndexOfFirstLeaf=function(a){return a.index},x.prototype.hasHierarchy=function(){return!1},x.prototype.getRows=function(){return this.rows},x.prototype.isBlank=function(){return!1},x.prototype.isBlankRow=function(a){return!1},x.prototype.numberOfBlankRowsBefore=function(a){return 0},x.prototype.getHierarchyDepth=function(){return 1},x.prototype.getHierarchyLeafCount=function(){return _.size(this.rows)},x.prototype.getHierarchyLeafAt=function(a){return this.rows[a]},x.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingRow?1:0},x.prototype.getFloatingHierarchyLeafAt=function(a){return this.floatingRow},x.prototype.getHierarchyItems=function(){return this.rows},x.prototype.getFloatingHierarchyItems=function(){return this.floatingRow?[this.floatingRow]:null},x.prototype.getLeafIndex=function(a){return a.index},x.prototype.isLeaf=function(a){return!0},x.prototype.isLastItem=function(a,P){return this.isDataComplete&&a.index===P.length-1},x.prototype.getAncestor=function(a){return null},x.prototype.getParent=function(a){return null},x.prototype.getIndex=function(a){return a.index},x.prototype.getPathIndices=function(a){return[this.getIndex(a)]},x.prototype.getNodeFromPath=function(a){if(1===a.length)return this.rows[a[0]]},x.prototype.getItemsByLevel=function(a){return r.fF.assert(function(){return 0===a},"Table rows hierarchy has 1 level"),[this.rows[0]]},x.prototype.getChildren=function(a){return null},x.prototype.getLevel=function(a){return 0},x.prototype.getLeafAncestorAtLevel=function(a,P){return a},x.prototype.getExpansionState=function(a){return 2},x.prototype.getIntersection=function(a,P){var N,j,q=P.position.column.index,ne=a.values[q],de=a.values.objects&&a.values.objects[q],pe=P.metadata.queryName,ge=P.metadata,A=a===this.floatingRow;_.isString(ne)&&null!==(j=null===(N=ge?.type)||void 0===N?void 0:N.misc)&&void 0!==j&&j.sparkline&&(ne=(0,b.th)(ne,this.hostServices));var z=new G.ri,ie=P.position;z.column.index=ie.column.index,z.column.isFirst=ie.column.isFirst,z.column.isLast=ie.column.isLast;var ce=a.index;z.row.index=ce,z.row.isFirst=0===ce,z.row.isLast=this.isDataComplete&&a===_.last(this.rows);var me,ye,Pe=A&&!ge.isMeasure&&0===ie.column.index;if(Pe)me=ye=this.formattingProperties.total.totalLabel;else{var Me=this.formatters[pe],He=this.tooltipFormatters[pe];me=Me?Me.format(ne,de):null!=ne?"".concat(ne):"",ye=He?He.format(ne,de):me}var xe={position:z,dataPoint:ne,isRowGrandTotal:A,columnMetadata:ge,isTotal:A,isDefaultTotalLabel:Pe&&this.formattingProperties.total.isDefaultTotalLabel,textContent:me,tooltipContent:ye,isKpi:ge&&(0,G.Y1)(ge.kpi,me),isNumeric:ge&&ge.type.numeric&&!ge.kpi};return de&&(xe.backColor=(0,l.HZ)(this.tablixProperties.PropValuesBackColor.getValue(de)),xe.fontColor=(0,l.HZ)(this.tablixProperties.PropValuesFontColor.getValue(de)),xe.icon=Q.FX.PropValuesIcon.getValue(de),xe.hyperlink=Q.FX.PropValuesWebURL.getValue(de),xe.altText=Q.FX.PropAltTextValue.getValue(de)),xe},x.prototype.getCorner=function(a,P){return{}},x.prototype.getRowLevel=function(a){return 0},x.prototype.getColumnLevel=function(a){return 0},x.prototype.isColumnHeaderMultiValueSubtotal=function(a){return!1},x.prototype.isRowHeaderMultiValueSubtotal=function(a){return!1},x.prototype.getColumnIndexFromQueryName=function(a){},x.prototype.updateRows=function(a,P){this.rows=[];for(var N=0;N<a.length;N++)this.rows.push({index:N,values:a[N],identity:P?P[N]:void 0})},x.prototype.updateFloatingRow=function(a,P){this.floatingRow=_.isEmpty(a)?null:{index:0,values:a,identity:void 0}},x}(),D=X(26543),re=function(){function x(a,P,N){this.tooltipService=a,this.selectionManager=P,this.tooltipsEnabled=!0}return x.prototype.getBodyHandler=function(){var a=this;return{addTooltip:function(N,j){return a.addBodyTooltip(N,j)},removeTooltip:function(N,j){return a.removeTooltip(j)},isTooltipEnabled:function(N){return a.tooltipsEnabled&&a.isBodyTooltipEnabled(N)},setTooltipDelegate:function(N,j,q,ne,de){return a.setTooltipDelegate(N,j,ne,de)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},x.prototype.getHeaderHandler=function(){var a=this;return{addTooltip:function(N,j,q){return a.addHeaderTooltip(N,j,q)},removeTooltip:function(N,j){return a.removeTooltip(j)},isTooltipEnabled:function(N){return a.tooltipsEnabled},setTooltipDelegate:function(N,j,q,ne,de){return a.setTooltipDelegateHeader(N,j,ne,de)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},x.prototype.onDataViewChanged=function(a,P){this.rowHierarchyNavigator=a,this.columnHierarchyNavigator=P},x.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},x.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},x.prototype.setTooltipsEnabled=function(a){this.tooltipsEnabled=a},x.prototype.addBodyTooltip=function(a,P){var N=this,j=d3.select(P);this.tooltipService.addTooltip(j,function(q){return N.getBodyTooltipInfo(a,q)},function(q){var ne=N.getItemSelectionId(a,q);return ne&&[ne]})},x.prototype.setTooltipDelegate=function(a,P,N,j){var q=this,ne=d3.select(P);this.tooltipService.addTooltip(ne,function(de){return!q.tooltipsEnabled&&j(de)?null:q.getBodyTooltipInfo(a(de),de,!q.tooltipsEnabled)},function(de){if(!q.tooltipsEnabled)return null;var pe=q.getItemSelectionId(a(de),de);return pe&&[pe]},!0,!0,N)},x.prototype.addHeaderTooltip=function(a,P,N){var q,ne,j=this,de=d3.select(P),pe=null===(ne=(q=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===ne?void 0:ne.call(q);this.tooltipService.addTooltip(de,function(ge){return j.getHeaderTooltipInfo(a,ge)},pe?function(ge){return j.getItemSelectionId(a,ge)}:function(ge){},void 0,N)},x.prototype.setTooltipDelegateHeader=function(a,P,N,j){var ne,de,q=this,pe=d3.select(P),ge=null===(de=(ne=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===de?void 0:de.call(ne);this.tooltipService.addTooltip(pe,function(A){return!q.tooltipsEnabled&&j(A)?null:q.getHeaderTooltipInfo(a(A),A,!q.tooltipsEnabled)},function(A){return q.tooltipsEnabled&&ge?[q.getItemSelectionId(a(A),A)]:null},!0,!0,N)},x.prototype.removeTooltip=function(a){var P=d3.select(a);this.tooltipService.removeTooltips(P)},x.prototype.isBodyTooltipEnabled=function(a){return!a.isRowGrandTotal||!_.isEmpty(a.textContent)},x.prototype.getHeaderTooltipInfo=function(a,P,N){if(a)return N?[{displayName:"",value:a.metadata.displayName}]:[{displayName:a.metadata.displayName}]},x.prototype.getBodyTooltipInfo=function(a,P,N){var j;if(this.rowHierarchyNavigator&&a){if(N)return"IconOnly"===(null===(j=a.icon)||void 0===j?void 0:j.layout)?void 0:[{displayName:"",value:a.tooltipContent}];var q=[],ne=this.rowHierarchyNavigator.getHierarchyLeafAt(a.position.row.index);if(!a.isRowGrandTotal){var de=this.getGroupingTooltipInfo(ne);de&&q.push.apply(q,de||[])}if(a.columnMetadata.isMeasure){var ge=a.columnMetadata.displayName;a.isKpi?q.push({displayName:ge,kpiValue:{metadata:a.columnMetadata.kpi,value:a.tooltipContent}}):_.isEmpty(a.tooltipContent)||q.push({displayName:ge,value:a.tooltipContent})}else a.isRowGrandTotal&&!_.isEmpty(a.tooltipContent)&&q.push({displayName:a.tooltipContent});return _.isEmpty(q)?void 0:q}},x.prototype.getGroupingTooltipInfo=function(a){if(this.columnHierarchyNavigator&&this.rowHierarchyNavigator){for(var N=[],j=0,q=this.columnHierarchyNavigator.getColumns();j<q.length;j++){var ne=q[j];if(!ne.metadata.isMeasure){var de=this.rowHierarchyNavigator.getIntersection(a,ne);N.push({displayName:ne.metadata.displayName,value:de.tooltipContent})}}return N}},x.prototype.getItemSelectionId=function(a,P){if(this.rowHierarchyNavigator&&a&&!a.isRowGrandTotal){var N=this.rowHierarchyNavigator.getHierarchyLeafAt(a.position.row.index);return D.l0.fromSelectorsByColumn(this.selectionManager.createSelectorsByColumn(N))}},x}(),ae=X(66232),he=X(78843),se=function(){function x(a){this.hostServices=a,this.totalLabel=this.hostServices.getLocalizedString(H.qT),this.clearLocal()}return x.prototype.onBodyCellContextMenu=function(a,P){if((0,ae.n)(P),this.isTableEmpty())r.fF.assertFail("onBodyCellContextMenu should not be triggered on empty table.");else{var j,N=this.getRowFromCell(a);j=!this.isSelectionEmpty()&&this.isItemSelected(N)?this.selectedItems:[N];var q=this.createContextMenuArgs(a,j,P);q&&this.hostServices.onContextMenu(q)}},x.prototype.onBodyCellClick=function(a,P,N){r.fF.assert(function(){return null!=a||null!=N},"cell or row should be defined"),this.isTableEmpty()?r.fF.assertFail("onBodyCellClick should not be triggered on empty table."):a?a.isRowGrandTotal?this.clearHost():this.select(this.getRowFromCell(a),P):this.select(this.rows[N],P)},x.prototype.onWhitespaceClick=function(){this.clearHost()},x.prototype.isDrillingEnabled=function(a,P){if(!this.isTableEmpty()){var N={type:0,visualObjects:this.getVisualObjects([this.getRowFromCell(a)]),position:x.getMouseEventPosition(P)};return this.hostServices.onSelecting(N),1===N.action}r.fF.assertFail("isDrillingEnabled should not be triggered on empty table.")},x.prototype.select=function(a,P,N,j){if(void 0===N&&(N=!1),this.isItemSelected(a)){if(N)return;1===this.selectedItems.length&&1!==P?this.clearLocal():3===P?this.unselectItem(a):0===P&&(this.selectedItems=[a])}else 0===P&&this.clearLocal(),this.selectedItems.push(a),!j&&!this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))&&(this.selectedItems=[a]);j||this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,P))},x.prototype.isRowHighlighted=function(a){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(a)},x.prototype.isBodyCellHighlighted=function(a){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(this.getRowFromCell(a))},x.prototype.onDataViewChanged=function(a,P){if(this.rowNavigator=a,this.rows=a&&a.getRows(),this.totalRow=a&&a.getFloatingHierarchyLeafAt(0),this.columns=P&&P.getColumns(),!this.isSelectionEmpty()){for(var N=[],j=0,q=this.selectedItems;j<q.length;j++){var ne=q[j],de=x.getMatchingRow(ne,this.rows);N.push(de||ne)}this.selectedItems=N}},x.prototype.clearLocal=function(){this.selectedItems=[]},x.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},x.prototype.isTableEmpty=function(){return!this.rows},x.prototype.isItemSelected=function(a){return-1!==this.selectedItems.indexOf(a)},x.prototype.unselectItem=function(a){_.pull(this.selectedItems,a)},x.prototype.clearHost=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs([]))},x.prototype.restoreSelection=function(a){if(this.clearLocal(),_.isEmpty(a))return!0;var P=_.keys(a[0].dataMap);if(1!==P.length)return!1;var N=_.chain(this.columns).filter(function(Pe){return!Pe.metadata.isMeasure}).map(function(Pe){return Pe.metadata.queryName}).value(),j=P[0];if(!_.includes(N,j))return!1;for(var q=!1,ne=_.clone(a),de=0,pe=this.rows;de<pe.length;de++){for(var ge=pe[de],A=void 0,z=function(Me){var He=Me.dataMap[j][0];if(r.fF.assert(function(){return 1===Me.dataMap[j].length},"TableExSelectionManager.restoreSelection received an identity with multiple scope identities"),r.fF.assert(function(){return(0,I.yN)(He)},"TableExSelectionManager.restoreSelection received an identity that was not a scope identity"),(0,he.fS)(He,ge.identity))return A=Me,"break"},ie=0,ce=ne;ie<ce.length&&"break"!==z(ce[ie]);ie++);A&&(this.select(ge,3,!1,!0),_.remove(ne,A),q=!0)}return q},x.prototype.getRowFromCell=function(a){var P=this;return r.fF.assert(function(){return!a.isRowGrandTotal||a.isRowGrandTotal&&!!P.totalRow},"expected a floating row to be present for a rowGrandTotal cell"),a.isRowGrandTotal?this.totalRow:this.rows[a.position.row.index]},x.prototype.getRowAtIndex=function(a){return this.rows[a]},x.prototype.createContextMenuArgs=function(a,P,N){for(var j=this,q=[],ne=0,de=P;ne<de.length;ne++){var ge=this.createSelectorsByColumn(de[ne]);ge&&q.push(ge)}r.fF.assert(function(){return!(_.isEmpty(q)&&1!==j.rows.length)},"multi-row tables should have identities");var A={data:q,position:x.getMouseEventPosition(N)};return A.copyArgs={singleValue:function(){var ce,me;return(null===(me=null===(ce=a.columnMetadata.type)||void 0===ce?void 0:ce.misc)||void 0===me?void 0:me.sparkline)?a.textContent:(0,G.pW)(a.dataPoint)},grid:function(){var me=j.columns.length,ye=new Array(P.length+1);ye[0]=new Array(me),j.columns.forEach(function(Me,He){ye[0][He]=Me.metadata.displayName}),P.forEach(function(Me,He){var xe=ye[He+1]=new Array(me);j.columns.forEach(function(Fe,Ve){xe[Ve]=j.rowNavigator.getIntersection(Me,Fe).textContent})}),a.isRowGrandTotal&&j.totalRow&&j.totalRow.values&&_.isEmpty(j.totalRow.values[0])&&(ye[1][0]=j.totalLabel);var Pe=0;return 0!==j.rows.length&&(Pe=Math.round(P.length/j.rows.length*100)),{grid:ye,coveragePercentage:Pe}}},A},x.prototype.createSelectArgs=function(a,P){return void 0===P&&(P=0),{type:0,visualObjects:this.getVisualObjects(a),selectionMode:P}},x.prototype.getVisualObjects=function(a){for(var P=[],N=0,j=a;N<j.length;N++){var ne=this.createSelectorsByColumn(j[N]);ne&&P.push({objectName:"",selectorsByColumn:ne})}return P},x.prototype.createSelectorsByColumn=function(a){var P,N,j=_.find(this.columns,function(ne){return!ne.metadata.isMeasure});j&&((P={})[j.metadata.queryName]=[a.identity],N=P);var q=_(this.columns).filter(function(ne){return ne.metadata.isMeasure}).map(function(ne){return ne.metadata.queryName}).value();if(N||!_.isEmpty(q))return{dataMap:N,metadata:q}},x.getMouseEventPosition=function(a){return{x:a.clientX,y:a.clientY}},x.getMatchingRow=function(a,P){if(_.isEmpty(P))return null;for(var N=0,j=P;N<j.length;N++){var q=j[N];if((0,he.fS)(q.identity,a.identity))return q}return null},x.getMatchingColumnHeader=function(a,P){for(var N=0,j=P;N<j.length;N++){var q=j[N];if(this.areHeadersEqual(q,a))return q}return null},x.areHeadersEqual=function(a,P){return a.metadata.queryName===P.metadata.queryName},x}(),Y=X(59151),ue=function(){function x(a){this.hostServices=a,this.pendingChanges=[]}return x.prototype.onDataViewChanged=function(){this.pendingChanges=[]},x.getSelector=function(a){return{metadata:a.metadata.queryName}},x.prototype.getPendingChange=function(a){return _.find(this.pendingChanges,function(P){return se.areHeadersEqual(P.header,a)})},x.prototype.queuePendingChange=function(a,P){var N=this.getPendingChange(a);N?N.width=P:this.pendingChanges.push({header:a,width:P})},x.prototype.getColumnWidth=function(a){var P=this.getPendingChange(a);if(P)return P.width;var N=a.metadata.objects;return N?Q.FX.PropColumnWidthValue.getValue(N):void 0},x.prototype.setColumnWidth=function(a,P){this.queuePendingChange(a,P),(0,Y.P)([{selector:x.getSelector(a),value:P}],this.hostServices,!1)},x.prototype.getRowHeight=function(a){},x.prototype.setRowHeight=function(a,P){},x.prototype.getRowLevelWidth=function(a){},x.prototype.setRowLevelWidth=function(a,P){r.fF.assertFail("tableExSizeManager:setRowLevelWidth should not be called")},x.prototype.getColumnLevelHeight=function(a){},x.prototype.setColumnLevelHeight=function(a,P){},x.prototype.setMissingWidths=function(a){for(var P=[],N=0,j=a;N<j.length;N++){var q=j[N],ne=q.header,de=q.width;null==this.getColumnWidth(ne)&&(this.queuePendingChange(ne,de),P.push({selector:x.getSelector(ne),value:de}))}_.isEmpty(P)||(0,Y.P)(P,this.hostServices,!0)},x.prototype.clearWidths=function(a){for(var P=[],N=0,j=a;N<j.length;N++){var q=j[N];null!=this.getColumnWidth(q)&&P.push({selector:x.getSelector(q),value:void 0}),this.queuePendingChange(q,void 0)}_.isEmpty(P)||(0,Y.P)(P,this.hostServices,!0)},x}(),ve=X(67016),be=X(48645),Ce=function(){function x(a,P){void 0===a&&(a=(0,O.DH)()),this.options=a,this.featureSwitches=P||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.tooltipType=0,this.asyncSerializer=new e.W,this.supportsOnObject=this.featureSwitches.onObject&&this.featureSwitches.a11yMatrix,this.numFontDelays=0}return x.prototype.init=function(a){var N,P=this;if(this.currentViewport=a.viewport,this.element=a.element,this.hostServices=a.host,this.waitingForData=!1,this.style=a.style,this.tablixPropertyManager=new w.U(this.style),this.selectionManager=new se(this.hostServices),this.sortingManager=new m(this.hostServices,this.featureSwitches.a11yTable),this.sizeManager=new ue(this.hostServices),this.tooltipService=(0,i.r)(a.host),this.supportsOnObject){var q=(null===(N=this.hostServices)||void 0===N?void 0:N.getSubSelectionService())??T.D.createWithDefaultHost();this.subSelectionHelper=E.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:new be.y(q),targetSource:"format",scale:function(){return P.currentViewport.scale},selectorCallback:function(de){return P.getSelectorsByColumnFromSubselectedElement(de)}})}},Object.defineProperty(x.prototype,"showTotalPlaceHolders",{get:function(){return this.featureSwitches.onObject&&1===this.viewMode&&this.isSelected},enumerable:!1,configurable:!0}),x.prototype.onViewModeOrIsSelectedChanged=function(a,P,N){var j=this.showTotalPlaceHolders;this.viewMode=a,this.isSelected=P;var q=this.showTotalPlaceHolders;j!==q&&this.pivotTableControl instanceof J.d&&(this.pivotTableControl.onShowTotalPlaceHoldersChanged(q),N||this.pivotTableControl.renderAsync(U.BM.ClearMeasurement))},x.prototype.onViewModeChanged=function(a){this.onViewModeOrIsSelectedChanged(a,this.isSelected)},x.prototype.onSelectionStateChanged=function(a){this.onViewModeOrIsSelectedChanged(this.viewMode,a)},x.prototype.update=function(a){return(0,B.__awaiter)(this,void 0,void 0,function(){var P=this;return(0,B.__generator)(this,function(N){switch(N.label){case 0:return null!=a.viewMode&&this.onViewModeOrIsSelectedChanged(a.viewMode,this.isSelected,!0),this.currentViewport=a.viewport,[4,this.asyncSerializer.enqueue(function(){return(0,B.__awaiter)(P,void 0,void 0,function(){var j,q,ne,de;return(0,B.__generator)(this,function(pe){switch(pe.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new Promise(function(ge){return setTimeout(ge,500)})]:[3,2];case 1:return pe.sent(),this.numFontDelays++,[3,0];case 2:return a.type&y.EP.Data||2===a.resizeMode?[4,this.onDataViewChanged(a.dataViews,a.operationKind,a.viewport)]:[3,4];case 3:pe.sent(),pe.label=4;case 4:return this.pivotTableControl&&a.type&y.EP.Resize?(this.pivotTableControl.setWidth(a.viewport.width),this.pivotTableControl.setHeight(a.viewport.height),[4,this.renderControl(U.BM.Incremental,null,null)]):[3,6];case 5:pe.sent(),pe.label=6;case 6:return this.supportsOnObject?a.formatMode===this.formatMode?[3,8]:(this.formatMode=a.formatMode,this.subSelectionHelper.setFormatMode(a.formatMode),a.formatMode?(this.element.get(0).setAttribute(E.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(E.y3),this.pivotTableControl&&this.pivotTableControl instanceof J.d?(this.pivotTableControl.getBinder().setFormatMode(a.formatMode),[4,this.pivotTableControl.renderAsync(U.BM.ClearRendering)]):[3,8]):[3,8];case 7:pe.sent(),pe.label=8;case 8:return j=a.type&y.EP.Data||a.type&y.EP.Resize||a.type&y.EP.FormattingSubSelectionChange,q=a.type&y.EP.FormattingSubSelectionChange,this.subSelectionHelper&&j&&(this.subSelectionHelper.updateOutlinesFromSubSelections(a.subSelections,!0),this.hostServices.alertScreenReader&&q&&(ne=this.subSelectionHelper.getLabelsFromSubSelections(a.subSelections,["aria-label"]),(de=ne?.length&&ne.join(" "))&&this.hostServices.alertScreenReader(de))),[2]}})})})];case 1:return N.sent(),[2]}})})},x.prototype.updatePersistedWidths=function(a){var P=Q.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!P&&this.pivotTableControl){for(var N=[],j=this.columnHierarchyNavigator.getColumns(),ne=0,de=0,pe=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();de<pe.length;de++)for(var z=0,ie=pe[de].getColumnWidths();z<ie.length;z++)N.push({header:j[ne],width:ie[z]}),ne++;this.sizeManager.setMissingWidths(N)}else P&&a&&a.metadata&&a.metadata.objects&&!Q.FX.PropColumnPivotTableAutoSizeColumns.getValue(a.metadata.objects)&&this.sizeManager.clearWidths(this.columnHierarchyNavigator.getColumns())},x.prototype.onDataViewChanged=function(a,P,N){return(0,B.__awaiter)(this,void 0,void 0,function(){var j,q,ne=this;return(0,B.__generator)(this,function(de){switch(de.label){case 0:return _.isEmpty(a)?[3,5]:(j=this.dataView,this.dataView=a[0],this.formattingProperties=this.tablixPropertyManager.getTableExObjects(this.dataView,function(pe){for(var ge,A=[],z=1;z<arguments.length;z++)A[z-1]=arguments[z];return(ge=ne.hostServices).getLocalizedString.apply(ge,(0,B.__spreadArray)([pe],A||[],!1))},this.style,this.featureSwitches),q=!this.dataView.metadata.segment,P!==y.su.Append?[3,2]:[4,this.onAppendDataView(j,q)]);case 1:return de.sent(),[3,4];case 2:return[4,this.onNewDataView(j,N,q)];case 3:de.sent(),de.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(void 0,void 0),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),de.label=6;case 6:return this.waitingForData=!1,[2]}})})},x.prototype.onAppendDataView=function(a,P){return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(N){switch(N.label){case 0:return this.updateHierarchyNavigators(P),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),[4,this.renderControl(U.BM.Incremental,null,null)];case 1:return N.sent(),[2]}})})},x.prototype.onNewDataView=function(a,P,N){return(0,B.__awaiter)(this,void 0,void 0,function(){var j,q,ne;return(0,B.__generator)(this,function(de){switch(de.label){case 0:return j=this.getPreviousVisibleRowStart(),q=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(N),this.sizeManager.onDataViewChanged(),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(P.width),this.pivotTableControl.setHeight(P.height),ne=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&ne&&ne.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.updateFormattingProperties(this.dataView,this.formattingProperties,this.style,0===this.tooltipType),[4,this.renderControl(U.BM.ClearMeasurement,this.getVisibleRowStart(j,m.hasSortingChanged(a,this.dataView)),this.getVisibleColumnStart(q))];case 1:return de.sent(),this.updatePersistedWidths(a),[2]}})})},x.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},x.prototype.onRestoreSelection=function(a){if(this.selectionManager){var P=this.selectionManager.restoreSelection(a.selection);return this.renderSelection(),P}return!1},x.prototype.updateHierarchyNavigators=function(a){this.rowHierarchyNavigator.update(this.dataView.table.rows,this.dataView.table.identity,this.dataView.table.totals,a,this.dataView.table.columns,this.formattingProperties),this.columnHierarchyNavigator.update(this.dataView.table.columns)},x.prototype.renderControl=function(a,P,N){return this.pivotTableControl.renderAsync(a,P,N)},x.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleRowStart();if(!a)return null;var P=this.rowHierarchyNavigator.getHierarchyLeafAt(a.rowIndex);return P?{item:P,offset:a.visibleHeight}:null}},x.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleColumnStart();if(!a)return null;var P=this.columnHierarchyNavigator.getHierarchyLeafAt(a.columnIndex);return P?{item:P,offset:a.visibleWidth}:null}},x.prototype.getSelectorsByColumnFromSubselectedElement=function(a){var N,P=this;if(r.fF.assert(function(){return P.supportsOnObject},"Should not be calling getSelectorsByColumnFromSubSelectedElement if does not support onObject"),this.pivotTableControl instanceof J.d)switch(d3.select(a).attr(E.Ez)){case"values":case"measure-values":var q=this.pivotTableControl.getMidRenderer().getItemByElement(a);return null!==(N=q?.columnMetadata)&&void 0!==N&&N.queryName?{metadata:[q.columnMetadata.queryName]}:{};default:return{}}},x.prototype.getVisibleRowStart=function(a,P){if(!a||0===this.pivotTableControl.getViewport().top)return null;if(P)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var N=se.getMatchingRow(a.item,this.rowHierarchyNavigator.getRows());return N&&this.rowHierarchyNavigator.isLeaf(N)?{rowIndex:this.rowHierarchyNavigator.getLeafIndex(N),visibleHeight:a.offset}:null},x.prototype.getVisibleColumnStart=function(a){if(!a||0===this.pivotTableControl.getViewport().left)return null;var P=se.getMatchingColumnHeader(a.item,this.columnHierarchyNavigator.getColumns());return P&&this.columnHierarchyNavigator.isLeaf(P)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(P),visibleWidth:a.offset}:null},x.prototype.renderSelection=function(){var a;null===(a=this.pivotTableControl)||void 0===a||a.renderAsync(U.BM.ClearRendering)},x.prototype.createOrUpdateControlAndNavigators=function(a){var P=this;if(this.rowHierarchyNavigator||(this.rowHierarchyNavigator=new k(this.tablixPropertyManager.tablixProperties,this.hostServices),this.columnHierarchyNavigator=new R),this.updateHierarchyNavigators(a),!this.pivotTableControl){var N={interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties,onBindRowHeader:function(ie){return P.onBindRowHeader(ie)},onHyperlinkClicked:function(ie,ce){return P.onHyperlinkClicked(ie,ce)}},j=document.createElement("div");j.className="tableExContainer",this.element.append(j),this.binder=new L(N,this.selectionManager,j,this.hostServices,this.featureSwitches.a11yMatrix);var q=this.featureSwitches.a11yTable,ne=this.featureSwitches.a11yMatrix,de=this.supportsOnObject;this.pivotTableControl=new J.d(j,this.sizeManager,this.createControlOptions(),q,!1,de,this.featureSwitches.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,this.showTotalPlaceHolders,this.subSelectionHelper),this.binder.getViewport=ne?function(){return{width:P.pivotTableControl.getWidth(),height:P.pivotTableControl.getHeight()}}:function(){return P.pivotTableControl.getViewport()}.bind(this),this.binder.isHeaderAutoWidth=function(ie){return void 0===P.sizeManager.getColumnWidth(ie)}.bind(this),this.binder.isBodyCellAutoWidth=function(ie){var ce=P.columnHierarchyNavigator.getColumns()[ie.position.column.index];return void 0===P.sizeManager.getColumnWidth(ce)}.bind(this),this.pivotTableControl.setClassName("tableEx"),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},x.prototype.createControlOptions=function(){var a=this,P=this.options.scrolling.enabled,N=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=this.interactionManager=new re(this.tooltipService,this.selectionManager,this.hostServices.getLocalizedString(H.qT)));var j=this.interactionManager;return this.options.selection.enabled?{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:function(ne,de){return a.onColumnHeaderClickHandler(ne,de)},columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:!this.formatMode&&j?j.getHeaderHandler():null,columnHeaderFocusHandler:function(ne){return null},bodyCellClickHandler:function(ne,de,pe,ge){return!a.formatMode&&a.onBodyCellClick(ne,de,pe,ge)},bodyCellContextMenuHandler:function(ne,de){return!a.formatMode&&a.onBodyCellContextMenu(ne,de)},bodyCellInteractionHandler:!this.formatMode&&j?j.getBodyHandler():null,bodyCellFocusHandler:function(ne,de){return null},cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:function(ne,de){return!a.formatMode&&a.onContentActivation(ne,de)},whitespaceClickHandler:function(ne,de){return!a.formatMode&&a.onWhitespaceClick(de)},scrollingEnabled:P,columnResizingEnabled:N,rowLevelResizingEnabled:!1,onScroll:function(){return a.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:j?j.getHeaderHandler():null,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:j?j.getBodyHandler():null,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:P,columnResizingEnabled:N,rowLevelResizingEnabled:!1,onScroll:function(){return a.onScroll()}}},x.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip()},x.prototype.onHyperlinkClicked=function(a,P){this.hostServices.onHyperlinkClick(a,P)},x.prototype.onColumnHeaderClickHandler=function(a,P){this.supportsOnObject&&this.formatMode?this.subSelectionHelper.isVisualObjectSubSelected({objectName:"columnHeaders",selectorsByColumn:{}})&&this.onColumnHeaderClick(a,P):this.onColumnHeaderClick(a,P)},x.prototype.onBodyCellClick=function(a,P,N,j){if(j!==U.p0.Footer||a)if(r.fF.assert(function(){return null!=a&&null!=P||null!=N},"cell or row should be defined"),a){if(!this.selectionManager.isDrillingEnabled(a,P)){var q=void 0;if(1==(q=h.M.isCtrlOrMeta(P)||1===this.hostServices.dataMultiSelectMode()?3:P.shiftKey?1:0)&&this.selectionManager.isItemSelected(this.selectionManager.getRowFromCell(a))||1===q&&a.isRowGrandTotal)return;this.selectionManager.onBodyCellClick(a,q),this.renderSelection(),this.announceSelectionState(a,void 0)}}else{if(1==(q=P?.shiftKey?1:3)&&this.selectionManager.isItemSelected(this.selectionManager.getRowAtIndex(N)))return;this.selectionManager.onBodyCellClick(void 0,q,N),this.renderSelection(),this.announceSelectionState(a,N)}},x.prototype.onBodyCellContextMenu=function(a,P){P.stopPropagation(),P.preventDefault(),this.selectionManager.onBodyCellContextMenu(a,P)},x.prototype.onVerticalScrollButtonClick=function(a,P){var N=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(a),this.getScrollRowIndex(P));this.hostServices.alertScreenReader(N)},x.prototype.onHorizontalScrollButtonClick=function(a,P){var N=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(a),this.getScrollColumnIndex(P));this.hostServices.alertScreenReader(N)},x.prototype.getScrollRowIndex=function(a){return 0===a?1:(0,G.Hd)(a)},x.prototype.getScrollColumnIndex=function(a){return 0===a?1:(0,G.jT)(a)},x.prototype.announceSelectionState=function(a,P){var N;r.fF.assert(function(){return null!=a||null!=P},"cell or row should be defined");var j=this.rowHierarchyNavigator.getHierarchyLeafAt(null!==(N=a?.position.row.index)&&void 0!==N?N:P),q=this.selectionManager.isItemSelected(j),ne=this.hostServices.getLocalizedString(q?H.b:H.TV);this.hostServices.alertScreenReader(ne)},x.prototype.onColumnHeaderClick=function(a,P){a&&this.dataView&&this.options.sorting.enabled&&this.sortingManager.sort(a,this.dataView.table.columns,P.shiftKey)},x.prototype.onContentActivation=function(a,P){r.fF.assertValue(a,"onContentActivated - null cellElement");var N=a.querySelector("a");N&&N.dispatchEvent(P)},x.prototype.onWhitespaceClick=function(a){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),a){var P=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(P)}},x.prototype.onBindRowHeader=function(a){this.needsMoreData(a)&&(this.featureSwitches.a11yMatrix?setTimeout(this.hostServices.loadMoreData):this.hostServices.loadMoreData(),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},x.prototype.needsMoreData=function(a){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var N=this.rowHierarchyNavigator.getHierarchyLeafCount()*H.sR;return this.rowHierarchyNavigator.getLeafIndex(a)>=N},x.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,c.Y.TableEx,void 0,this.featureSwitches,this.style)},x.prototype.enumerateObjectInstances=function(a){var P=this,N=new le.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(a,N,this.dataView,c.Y.TableEx,function(j){for(var q,ne=[],de=1;de<arguments.length;de++)ne[de-1]=arguments[de];return(q=P.hostServices).getLocalizedString.apply(q,(0,B.__spreadArray)([j],ne||[],!1))},this.featureSwitches,void 0,this.style),N.complete()},x.prototype.enumerateObjectRepetition=function(){var a=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(a,this.dataView,c.Y.TableEx,this.featureSwitches),a},x.prototype.getSubSelectablesAsync=function(a){var P;return(0,B.__awaiter)(this,void 0,void 0,function(){return(0,B.__generator)(this,function(N){switch(N.label){case 0:return[4,null===(P=this.pivotTableControl)||void 0===P?void 0:P.renderAsync(U.BM.Incremental)];case 1:return N.sent(),[2,this.subSelectionHelper.getAllSubSelectables(a)]}})})},x.prototype.getSubSelectionStyles=function(a){if(this.supportsOnObject){var j,q,N=_.first(a).visualObjects;if(!(N.length>0))return;switch(j=N[0],_.isEmpty(j.selectorsByColumn)||(q=(0,I.tV)(j.selectorsByColumn)),j.objectName){case"columnHeaders":var ne=(0,F.RM)(this.hostServices,{boldReference:d.Z.columnHeaders.bold,italicReference:d.Z.columnHeaders.italic,underlineReference:d.Z.columnHeaders.underline,fontColorReference:d.Z.columnHeaders.fontColor,fontFamilyReference:d.Z.columnHeaders.fontFamily,fontSizeReference:d.Z.columnHeaders.fontSize,backgroundReference:d.Z.columnHeaders.backColor,horizontalAlignmentReference:d.Z.columnHeaders.alignment,wordWrapReference:d.Z.columnHeaders.wordWrap});return ne.grid={type:"contextmenu"},ne.border={type:"contextmenu"},(0,B.__assign)({type:1},ne);case"totals":var de=(0,F.RM)(this.hostServices,{boldReference:d.Z.total.bold,italicReference:d.Z.total.italic,underlineReference:d.Z.total.underline,fontColorReference:d.Z.total.fontColor,fontFamilyReference:d.Z.total.fontFamily,fontSizeReference:d.Z.total.fontSize,backgroundReference:d.Z.total.backColor});return de.grid={type:"contextmenu"},de.border={type:"contextmenu"},(0,B.__assign)({type:1},de);case"values":case"measure-values":if(!q)return;var pe=this.columnHierarchyNavigator.getColumnIndexFromQueryName(q.metadata);return(0,F.xs)(this.hostServices,{fontFamilyReference:d.Z.values.fontFamily,fontSizeReference:d.Z.values.fontSize,boldReference:d.Z.values.bold,italicReference:d.Z.values.italic,underlineReference:d.Z.values.underline,fontColorReference:(0,B.__assign)((0,B.__assign)({},d.Z.columnFormatting.fontColor),{selector:q}),precisionReference:(0,B.__assign)((0,B.__assign)({},d.Z.columnFormatting.labelPrecision),{selector:q}),displayUnitsReference:(0,B.__assign)((0,B.__assign)({},d.Z.columnFormatting.labelDisplayUnits),{selector:q}),backgroundReference:(0,B.__assign)((0,B.__assign)({},d.Z.columnFormatting.backColor),{selector:q}),horizontalAlignmentReference:(0,B.__assign)((0,B.__assign)({},d.Z.columnFormatting.alignment),{selector:q}),wordWrapReference:d.Z.values.wordWrap},{precision:{defaultPrecision:(0,M.h1)(void 0,(0,M.v1)(pe.metadata.type))},grid:{type:"contextmenu"},border:{type:"contextmenu"}})}}},x.prototype.getBorderShortcuts=function(a){var P;switch(a){case"columnHeaders":P=d.Z.columnHeaders.outlineStyle;break;case"totals":P=d.Z.total.outlineStyle;break;case"values":case"measure-values":P=d.Z.values.outlineStyle;break;default:return}return[{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},P),{value:C.$m.Nil})],label:this.hostServices.getLocalizedString("Format_Border_NoBorder"),icon:"NoBorder_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},P),{value:C.$m.Top|C.$m.Bottom|C.$m.Left|C.$m.Right})],label:this.hostServices.getLocalizedString("Format_Border_AllBorders"),icon:"BoxBorder_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},P),{value:C.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopBorder"),icon:"TopBorder_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},P),{value:C.$m.Bottom})],label:this.hostServices.getLocalizedString("Format_Border_BottomBorder"),icon:"BottomBorder_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},P),{value:C.$m.Bottom|C.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopAndBottomBorder"),icon:"TopAndThickBottomBorder_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("border")},label:this.hostServices.getLocalizedString("Format_Border")}]},x.prototype.getGridShortcuts=function(){return[{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Small_Multiples_Layout_Grid_Line_Type_Inner"),icon:"AccessGridlinesBoth_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Horizontal"),icon:"AccessGridlinesHorizontal_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Vertical"),icon:"AccessGridlinesVertical_16"},{type:9,referencesAndValues:[(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,B.__assign)((0,B.__assign)({},d.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_None"),icon:"AccessGridlinesNone_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("gridHorizontal")},label:this.hostServices.getLocalizedString("Format_Grid")}]},x.prototype.getSubSelectionShortcuts=function(a,P){if(this.supportsOnObject){var q,ne,j=_.first(a).visualObjects;if(!(j.length>0))return;if(q=j[0],P)switch(P){case"grid":return this.getGridShortcuts();case"border":return this.getBorderShortcuts(q.objectName)}switch(_.isEmpty(q.selectorsByColumn)||(ne=(0,I.tV)(q.selectorsByColumn)),q.objectName){case"columnHeaders":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"totals":case"total-labels":var de="".concat("totals","-").concat("values");return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("totals"),groupUid:de},label:this.hostServices.getLocalizedString("total-labels"===q.objectName?"Format_Total_Label":"Format_Totals")}];case"values":case"measure-values":var pe="".concat("values","-").concat("values"),ge=[{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("values"),groupUid:pe},label:this.hostServices.getLocalizedString("Format_Values")}];if("measure-values"===q.objectName){var A=ne?this.tablixPropertyManager.getConditionalFormattingSelector(c.Y.TableEx,ne.metadata):void 0;ge.unshift({type:8,shortcuts:[(0,B.__assign)((0,B.__assign)({type:6,label:this.hostServices.getLocalizedString("Background_Color")},ve.t.values.backColor),{selector:A}),(0,B.__assign)((0,B.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_FontColor")},ve.t.values.fontColor),{selector:A}),(0,B.__assign)((0,B.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_ConditionalFormatting_DataBars")},ve.t.columnFormatting.dataBars),{selector:ne?this.tablixPropertyManager.getConditionalFormattingSelector(c.Y.TableEx,ne.metadata,!1):void 0}),(0,B.__assign)((0,B.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_Tablix_Icons")},ve.t.values.icon),{selector:A}),{type:7},{type:1,destinationInfo:(0,B.__assign)((0,B.__assign)({},ve.t.values.backColor),{selector:A}),label:this.hostServices.getLocalizedString("Format_Cell_Elements")}],label:this.hostServices.getLocalizedString("Format_AddCellElements")})}return ge.unshift({type:0}),ge}}},x.prototype.onDataViewObjectChanged=function(a,P){if(!this.supportsOnObject||!this.formatMode||1!==P)return a;for(var N={objectName:"columnFormatting",propertyName:"styleValues"},j={objectName:"columnFormatting",propertyName:"backColor"},q={objectName:"columnFormatting",propertyName:"fontColor"},ne={objectName:"columnFormatting",propertyName:"alignment"},de=[],pe=0,ge=a;pe<ge.length;pe++){var z=ge[pe].selector;if(z&&z.metadata){var ie=this.formattingProperties.columnFormatting[z.metadata],ce=ie.styleValues||ie.styleHeader||ie.styleTotal;de.push(fe.v.create(j,ce).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(N,!0,{selector:z})),fe.v.create(q,ce).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(N,!0,{selector:z})),fe.v.create(ne,ce).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(N,!0,{selector:z})))}}return ee.o.applyDataViewObjectsBehaviorChanges(a,ee.o.getDataViewObjectsBehaviorChanges(a,de))},x}()},44245:function(Re,we,X){X.d(we,{Yc:function(){return r},aV:function(){return Q},cP:function(){return i},ji:function(){return C}});var B=X(54522),fe=X(55007),ee=X(40550),oe=X(32041),le=X(64329),F=X(48066),E=X(66001),T=X(93340),O=X(71090);function Q(e,h,y,I,M){var U,J;h.fontFamily=O.F2,h.fontColor=O.lN,h.borders.bottom=new T.om(fe.FX.PropGridOutlineWeight.defaultValue,M.PropGridOutlineColor.getValue(null));var G=y.grid,H=y.columnHeaders,d=y.total.outline,V=H.outline,Z=y.values.outline,K=null!==(U=H.outlineWeight)&&void 0!==U?U:G.outlineWeight,W=null!==(J=H.outlineColor)&&void 0!==J?J:G.outlineColor;h.borders.top=new T.om,h.borders.top.applyParams((0,ee.yo)(V),K,W,T.Pb.Outline),h.borders.bottom=new T.om,h.borders.bottom.applyParams((0,ee.mv)(V),K,W,T.Pb.Outline),h.borders.left=new T.om,e.column.isFirst&&(h.borders.left.applyParams((0,ee.fs)(V),K,W,T.Pb.Outline),!(0,ee.fs)(V)&&((0,ee.fs)(d)||(0,ee.fs)(Z))&&(h.paddings.left+=K)),h.borders.right=new T.om,e.column.isLast?(h.borders.right.applyParams((0,ee.BK)(V),K,W,T.Pb.Outline),!(0,ee.BK)(V)&&((0,ee.BK)(d)||(0,ee.BK)(Z))&&(h.paddings.right+=K)):h.borders.right.applyParams(G.gridVertical,G.gridVerticalWeight,G.gridVerticalColor,T.Pb.Gridline),h.fontColor=I&&I.styleHeader&&I.fontColor?I.fontColor:H.fontColor,h.backColor=I&&I.styleHeader&&I.backColor?I.backColor:H.backColor,h.paddings.top=h.paddings.bottom=G.rowPadding}function i(e,h,y,I,M,U){var J,G;e.row.isLast||(y.borders.bottom=new T.om(fe.FX.PropGridHorizontalWeight.defaultValue,U.PropGridHorizontalColor.getValue(null)));var H=I.grid,c=I.values,V=I.total.outline,Z=c.outline,K=I.columnHeaders.outline,W=null!==(J=c.outlineWeight)&&void 0!==J?J:H.outlineWeight,te=null!==(G=c.outlineColor)&&void 0!==G?G:H.outlineColor;y.borders.top=new T.om,e.row.isFirst&&y.borders.top.applyParams((0,ee.yo)(Z),W,te,T.Pb.Outline),y.borders.bottom=new T.om,e.row.isLast?y.borders.bottom.applyParams((0,ee.mv)(Z),W,te,T.Pb.Outline):y.borders.bottom.applyParams(H.gridHorizontal,H.gridHorizontalWeight,H.gridHorizontalColor,T.Pb.Gridline),y.borders.left=new T.om,e.column.isFirst&&(y.borders.left.applyParams((0,ee.fs)(Z),W,te,T.Pb.Outline),!(0,ee.fs)(Z)&&((0,ee.fs)(V)||(0,ee.fs)(K))&&(y.paddings.left+=W)),y.borders.right=new T.om,e.column.isLast?(y.borders.right.applyParams((0,ee.BK)(Z),W,te,T.Pb.Outline),!(0,ee.BK)(Z)&&((0,ee.BK)(V)||(0,ee.BK)(K))&&(y.paddings.right+=W)):y.borders.right.applyParams(H.gridVertical,H.gridVerticalWeight,H.gridVerticalColor,T.Pb.Gridline),y.fontColor=h.fontColor?h.fontColor:M&&M.styleValues&&M.fontColor?M.fontColor:e.row.index%2==0?c.fontColorPrimary:c.fontColorSecondary,y.backColor=h.backColor?h.backColor:M&&M.styleValues&&M.backColor?M.backColor:e.row.index%2==0?c.backColorPrimary:c.backColorSecondary,y.paddings.top=y.paddings.bottom=H.rowPadding}function C(e,h,y,I,M,U){var J,G;y.fontFamily=O.Zk,y.borders.top=new T.om(fe.FX.PropGridOutlineWeight.defaultValue,U.PropGridOutlineColor.getValue(null));var v,t,H=I.total,c=I.grid,V=H.outline,Z=I.values.outline,K=I.columnHeaders.outline,W=null!==(J=H.outlineWeight)&&void 0!==J?J:c.outlineWeight,te=null!==(G=H.outlineColor)&&void 0!==G?G:c.outlineColor;y.borders.top=new T.om,y.borders.top.applyParams((0,ee.yo)(V),W,te,T.Pb.Outline),y.borders.bottom=new T.om,y.borders.bottom.applyParams((0,ee.mv)(V),W,te,T.Pb.Outline),y.borders.left=new T.om,e.column.isFirst&&(y.borders.left.applyParams((0,ee.fs)(V),W,te,T.Pb.Outline),!(0,ee.fs)(V)&&((0,ee.fs)(Z)||(0,ee.fs)(K))&&(y.paddings.left+=W)),y.borders.right=new T.om,e.column.isLast?(y.borders.right.applyParams((0,ee.BK)(V),W,te,T.Pb.Outline),!(0,ee.BK)(V)&&((0,ee.BK)(Z)||(0,ee.BK)(K))&&(y.paddings.right+=W)):y.borders.right.applyParams(c.gridVertical,c.gridVerticalWeight,c.gridVerticalColor,T.Pb.Gridline),M&&M.styleTotal&&(v=M.fontColor,t=M.backColor),y.fontColor=h.fontColor||v||H.fontColor,y.backColor=h.backColor||t||H.backColor,y.paddings.top=y.paddings.bottom=c.rowPadding}var r=function(){function e(h,y){this.options=h,y&&this.updateDataView(y)}return e.prototype.updateDataView=function(h){this.tableDataView=h,this.formattingProperties=h.formattingProperties,this.updateTextHeights(),this.rowHeight=this.hasImage()?Math.max(this.textHeightValue,this.formattingProperties.grid.imageHeight):this.textHeightValue},e.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:O.F2,fontSize:le.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:O.dG,fontSize:le.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:O.Zk,fontSize:le.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsTotal,"a"))},e.prototype.hasImage=function(){return _.some(this.tableDataView.columns,function(h){return(0,B.pt)(h)})},e.prototype.getColumnFormatting=function(h){return this.formattingProperties.columnFormatting[h.queryName]},e.prototype.onStartRenderingSession=function(){},e.prototype.onEndRenderingSession=function(){},e.prototype.bindRowHeader=function(h,y){y.contentHeight=h.totalCells?this.textHeightTotal:this.rowHeight,(0,T.G9)(y),this.options.onBindRowHeader&&this.options.onBindRowHeader(h)},e.prototype.unbindRowHeader=function(h,y){},e.prototype.bindColumnHeader=function(h,y){var I=this;y.extension.disableDragResize(),(0,T.ey)(y),(0,T.R5)(y,O.f),(0,T.R5)(y,O.mQ);var M=new T.qZ;Q(y.position,M,this.formattingProperties,this.getColumnFormatting(h),this.options.tablixProperties);var U=y.extension.contentHost;(U=(0,T.Ch)(U)).classList.add(O.WA);var G,J=this.getWordWrappingWidth(h.queryName,y,M);null!=J&&(G=this.getWordWrappingLines(h.displayName,J));var H=G&&G.length>1;if(H){y.contentHeight=G.length*this.textHeightHeader;for(var c=0,w=G.length;c<w-1;c++)(0,T.Ch)(U,G[c]);U=(0,T.Ch)(U)}else y.contentHeight=this.textHeightHeader;this.sortIconsEnabled()&&(U=(0,T.D6)(h.sort,U),h.sort&&!H&&(y.contentWidth=this.fontSizeHeader+O.fG));var d=h.displayName;if(H){var V=_.last(G);(0,T.AB)(V,U),(0,T.v4)(d,y.extension.contentHost),y.contentWidth=J}else(0,T.DM)(d,U,y.extension.contentHost),y.contentWidth+=oe.b.measureSvgTextWidth(this.textPropsHeader,d);y.contentWidth=Math.ceil(y.contentWidth),this.options.onColumnHeaderClick&&y.extension.registerClickHandler(function(W){if((0,T.xl)(W)){var te=(0,T.x7)(h.sort);I.options.onColumnHeaderClick(h.queryName?h.queryName:h.displayName,te)}}),y.applyStyle(M)},e.prototype.getWordWrappingLines=function(h,y){return(0,E.ql)(h,this.textPropsHeader,oe.b.measureSvgTextWidth,y,O.uZ,void 0,!0)},e.prototype.getWordWrappingWidth=function(h,y,I){var M;if(this.formattingProperties.columnHeaders.wordWrap&&0===this.options.layoutKind&&(y.isColumnResizing()&&y.containerWidth>=0?M=y.containerWidth:this.options.columnWidthManager&&(M=this.options.columnWidthManager.getPersistedColumnWidth(h)),null!=M))return Math.max(0,M-(I.getExtraLeft()+I.getExtraRight()))},e.prototype.unbindColumnHeader=function(h,y){(0,T.G9)(y),(0,T.aP)(y),this.sortIconsEnabled()&&(0,T.Y4)(y),this.options.onColumnHeaderClick&&y.extension.unregisterClickHandler()},e.prototype.bindBodyCell=function(h,y){(0,T.ey)(y),this.setBodyContent(h,y),y.contentWidth=Math.ceil(y.contentWidth),h.isTotal?((0,T.R5)(y,O.R9),(0,T.R5)(y,O.s$)):(0,T.R5)(y,h.position.row.isLast?O.zq:O.JM),h.isNumeric&&(0,T.R5)(y,O.s0);var I=new T.qZ;h.isTotal?C(y.position,h,I,this.formattingProperties,this.getColumnFormatting(h.columnMetadata),this.options.tablixProperties):i(y.position,h,I,this.formattingProperties,this.getColumnFormatting(h.columnMetadata),this.options.tablixProperties),y.applyStyle(I)},e.prototype.setBodyContent=function(h,y){var I=y.extension.contentHost,M=this.formattingProperties.grid.imageHeight,U=h.textContent;y.contentHeight=h.isTotal?this.textHeightTotal:h.isImage?M:this.textHeightValue;var J=(0,T.MN)(h.columnMetadata,h.textContent);if(J!==F.av.NONE){var G=this.formattingProperties.values.urlIcon,H=void 0;return G&&(H=(0,T.RP)(J)),G&&null!=H?(0,T.vU)(U,I,H):(0,T.vU)(U,I),void(y.contentWidth=G?this.fontSizeValue:oe.b.measureSvgTextWidth(this.textPropsValue,U))}if(h.isImage&&(0,F.gU)(U))return(0,T.Hx)(U,I,M),void(y.contentWidth=M*O.wd);var c=h.kpiContent;return c?($(I).append(c),void(y.contentWidth=this.fontSizeValue)):U?((0,T.DM)(U,I),void(y.contentWidth=oe.b.measureSvgTextWidth(h.isTotal?this.textPropsTotal:this.textPropsValue,U))):((0,T.DM)(" ",I),void(y.contentWidth=0))},e.prototype.unbindBodyCell=function(h,y){(0,T.G9)(y),(0,T.aP)(y)},e.prototype.bindCornerCell=function(h,y){y.contentWidth=0},e.prototype.unbindCornerCell=function(h,y){},e.prototype.bindEmptySpaceHeaderCell=function(h){},e.prototype.unbindEmptySpaceHeaderCell=function(h){},e.prototype.bindEmptySpaceFooterCell=function(h){},e.prototype.unbindEmptySpaceFooterCell=function(h){},e.prototype.getHeaderLabel=function(h){return h?h.displayName:""},e.prototype.getCellContent=function(h){return h},e.prototype.hasRowGroups=function(){return!1},e.prototype.sortIconsEnabled=function(){return 0===this.options.layoutKind},e}()},79476:function(Re,we,X){X.d(we,{ao:function(){return C},fS:function(){return ee},oY:function(){return i}});var B=X(19377);function ee(r,e){return null!=r&&null!=e&&r.x===e.x&&r.y===e.y}function i(r,e,h){var y=(e.y-r.y)*(h.x-e.x)-(e.x-r.x)*(h.y-e.y);return 0===y?B.i.Colinear:y>0?B.i.Clockwise:B.i.Counterclockwise}function C(r,e,h){return h.x<=Math.max(r.x,e.x)&&h.x>=Math.min(r.x,e.x)&&h.y<=Math.max(r.y,e.y)&&h.y>=Math.min(r.y,e.y)}},92379:function(Re,we,X){X.d(we,{m:function(){return oe}});var B=X(19377),fe=X(79476),ee=X(80758),oe=function(){function le(F){F&&(this.polygonPoints=this.convertArrayPathToPoints(F))}return le.fromPolygonPoints=function(F){var E=new le(null);return E.polygonPoints=F,E},le.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},le.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},le.prototype.contains=function(F){var T={x:F.left+F.width,y:F.top},O={x:F.left,y:F.top+F.height},Q={x:F.left+F.width,y:F.top+F.height};return this.inside({x:F.left,y:F.top})&&this.inside(T)&&this.inside(O)&&this.inside(Q)},le.prototype.conflicts=function(F){if(!this.isConflictWithBoundingBox(F))return!1;var T={x:F.left+F.width/2,y:F.top},O={x:F.left+F.width,y:F.top},Q={x:F.left,y:F.top+F.height},i={x:F.left+F.width/2,y:F.top+F.height},C={x:F.left+F.width,y:F.top+F.height},r={x:F.left,y:F.top+F.height/2},e={x:F.left+F.width,y:F.top+F.height/2};return this.inside({x:F.left,y:F.top})||this.inside(T)||this.inside(O)||this.inside(Q)||this.inside(i)||this.inside(C)||this.inside(r)||this.inside(e)},le.prototype.lineIntersectionPoint=function(F,E){for(var T=0;T<this.polygonPoints.length;T++){var i=this.getLineIntersection(F,E,this.polygonPoints[T],T===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[T+1]);if(null!==i)return i}return null},le.calculateAbsolutePolygonArea=function(F){var E,T=1,O=0;for(E=0;E<F.length;E++)O+=F[E].x*F[T].y-F[T].x*F[E].y,T=(T+1)%F.length;return.5*O},le.prototype.overlapPath=function(F){if(this.inside({x:F[0],y:F[1]}))return!0;var E=new le(F);if(E.inside(this.polygonPoints[0]))return!0;for(var T=0;T<this.polygonPoints.length;T++)if(E.lineIntersectionPoint(this.polygonPoints[T],this.polygonPoints[(T+1)%this.polygonPoints.length]))return!0;return!1},le.prototype.inside=function(F){for(var E=F.x,T=F.y,O=!1,Q=0,i=this.polygonPoints.length-1;Q<this.polygonPoints.length;i=Q++){var C=this.polygonPoints[Q].x,r=this.polygonPoints[Q].y,h=this.polygonPoints[i].y;r>T!=h>T&&E<(this.polygonPoints[i].x-C)*(T-r)/(h-r)+C&&(O=!O)}return O},le.translateX=function(F,E){for(var T=new Float64Array(2*F.polygonPoints.length),O=0;O<F.polygonPoints.length;O++)T[2*O]=F.polygonPoints[O].x+E,T[2*O+1]=F.polygonPoints[O].y;return new le(T)},le.polygonBoundsOverlap=function(F,E){var T=(0,ee.WN)(le.getPolyBoundLeft(F),le.getPolyBoundRight(F),le.getPolyBoundLeft(E),le.getPolyBoundRight(E)),O=(0,ee.WN)(le.getPolyBoundLower(F),le.getPolyBoundUpper(F),le.getPolyBoundLower(E),le.getPolyBoundUpper(E));return T&&O},le.circleRectangleOverlap=function(F,E,T){var O=Math.max(F.left,Math.min(E.x,F.right)),Q=Math.min(F.bottom,Math.max(E.y,F.top)),i=O-E.x,C=Q-E.y;return i*i+C*C<=T*T},le.linesIntersect=function(F,E,T,O,Q){void 0===Q&&(Q=!0);var i=(0,fe.oY)(F,E,T),C=(0,fe.oY)(F,E,O),r=(0,fe.oY)(T,O,F),e=(0,fe.oY)(T,O,E);return i!==C&&r!==e||!!Q&&!!(i===B.i.Colinear&&(0,fe.ao)(F,E,T)||C===B.i.Colinear&&(0,fe.ao)(F,E,O)||r===B.i.Colinear&&(0,fe.ao)(T,O,F)||e===B.i.Colinear&&(0,fe.ao)(T,O,E))},le.resize=function(F,E){if(0===E)return F;for(var T=le.calculateAbsolutePolygonArea(F.polygonPoints)>0,Q=_.clone(E>0&&!0===T||E<0&&!1===T?F.polygonPoints.reverse():F.polygonPoints),i=F.absoluteCentroid(),C=[],r=0;r<Q.length;r++){var e=Q[r],h=Q[(r+1)%Q.length],y=h.y-e.y,I=void 0;0!==y&&(I=-(h.x-e.x)/y);var M=0;_.isUndefined(I)||(M=(e.y<h.y?-1:1)*Math.sqrt(E*E/(1+I*I)));var U=0;0===M?U=(e.x>h.x?-1:1)*E:_.isUndefined(I)||(U=I*M);var J={x:e.x+M,y:e.y+U},G={x:0,y:0};0===I?(G.x=J.x,G.y=J.y+10):_.isUndefined(I)||(G.x=J.x+10,G.y=J.y-10/I);var H=(J.x-G.x)*(i.y-e.y)-(J.y-G.y)*(i.x-e.x);if(0!==H){var c={x:((J.x*G.y-J.y*G.x)*(i.x-e.x)-(J.x-G.x)*(i.x*e.y-i.y*e.x))/H,y:((J.x*G.y-J.y*G.x)*(i.y-e.y)-(J.y-G.y)*(i.x*e.y-i.y*e.x))/H};isFinite(c.x)&&isFinite(c.y)&&C.push(c)}}return le.fromPolygonPoints(C)},le.getPolyBoundLeft=function(F){var E;return null===(E=_.minBy(F.polygonPoints,function(T){return T.x}))||void 0===E?void 0:E.x},le.getPolyBoundRight=function(F){var E;return null===(E=_.maxBy(F.polygonPoints,function(T){return T.x}))||void 0===E?void 0:E.x},le.getPolyBoundUpper=function(F){var E;return null===(E=_.maxBy(F.polygonPoints,function(T){return T.y}))||void 0===E?void 0:E.y},le.getPolyBoundLower=function(F){var E;return null===(E=_.minBy(F.polygonPoints,function(T){return T.y}))||void 0===E?void 0:E.y},le.prototype.isConflictWithBoundingBox=function(F){return(0,ee.HL)(this.absoluteBoundingRect(),F)},le.prototype.calculatePolygonCentroid=function(){var F,E,T,O,Q,i;for(F=le.calculateAbsolutePolygonArea(this.polygonPoints),T=O=0,i=1,Q=0;Q<this.polygonPoints.length;Q++)T+=(this.polygonPoints[Q].x+this.polygonPoints[i].x)*(E=this.polygonPoints[Q].x*this.polygonPoints[i].y-this.polygonPoints[i].x*this.polygonPoints[Q].y),O+=(this.polygonPoints[Q].y+this.polygonPoints[i].y)*E,i=(i+1)%this.polygonPoints.length;return{x:T/=6*F,y:O/=6*F}},le.prototype.calculateBoundingRect=function(){for(var F=Number.POSITIVE_INFINITY,E=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY,Q=0,i=this.polygonPoints;Q<i.length;Q++){var C=i[Q];C.x<F?F=C.x:C.x>T&&(T=C.x),C.y<E?E=C.y:C.y>O&&(O=C.y)}return{left:F,top:E,width:T-F,height:O-E}},le.prototype.getLineIntersection=function(F,E,T,O){var Q=F.x,i=F.y,e=T.x,h=T.y,M=E.x-Q,U=E.y-i,J=O.x-e,G=O.y-h,H=(-U*(Q-e)+M*(i-h))/(-J*U+M*G),c=(J*(i-h)-G*(Q-e))/(-J*U+M*G);return H>=0&&H<=1&&c>=0&&c<=1?{x:Q+c*M,y:i+c*U}:null},le.prototype.convertArrayPathToPoints=function(F){for(var E=[],T=0;T<F.length;T+=2)E.push({x:F[T],y:F[T+1]});return E},le}()},19377:function(Re,we,X){X.d(we,{i:function(){return B}});var B=function(fe){return fe[fe.Clockwise=0]="Clockwise",fe[fe.Counterclockwise=1]="Counterclockwise",fe[fe.Colinear=2]="Colinear",fe}({})}}]);