"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["groupQuery"],{3942:function(b,f,e){e.r(f),e.d(f,{GroupQueryModule:function(){return M}});var l=e(81337),S=e(38823),C=e(26898),F=e(94717),G=e(88565),p=e(45114),w=e(98306),m=e(98330),h=e(47508),g=e(62458),Q=e(95462),P=e(14463),E=e(29866),D={provide:"groupQueryService",useFactory:function(t,a,s,n,i,r){return new V(t,a,s,n,i,r)},deps:[S.U,F.r,C.i,G.S,P.t,E.D]},V=function(){function t(a,s,n,i,r,o){this.singleExecutableDataProxyFactory=a,this.filterGenerator=s,this.conceptualSchemaProxy=n,this.visualQueryGenerator=i,this.promiseFactory=r,this.visualPluginService=o,this.reset()}return t.prototype.getValuesForColumn=function(a,s,n){return(0,l.__awaiter)(this,void 0,void 0,function(){var i,r,o,v;return(0,l.__generator)(this,function(u){switch(u.label){case 0:g.fF.assertValue(a,"expr"),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.conceptualSchemaProxy.get(s)];case 2:return i=u.sent(),(r=new p.g(Q.vQ.create(),{},[])).add(a,"Values"),[4,this.runQueryImpl({dataSources:s,schema:i,config:{visualType:h.L.table.name,query:r},hostServices:(0,m.E)(),visualQueryGenerator:this.visualQueryGenerator,executionType:n?1:0,preferCurrentData:!n,allowResultFromClientCache:!1,isInitialLoad:!n})];case 3:return o=u.sent(),this.lastResult=o?{table:o.dataReaderResult.dataView.table,canLoadMore:this.dataProxy.canLoadMore()}:this.lastResult,[3,5];case 4:throw v=u.sent(),new Error(v.errorCode);case 5:return[2,this.lastResult]}})})},t.prototype.getAggregatesForColumn=function(a,s){return(0,l.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,v,u,d,y,x;return(0,l.__generator)(this,function(c){switch(c.label){case 0:g.fF.assertValue(a,"expr"),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.conceptualSchemaProxy.get(s)];case 2:return i=c.sent(),r=new p.g(Q.vQ.create(),{},[]),g.fF.assert(function(){return 1===h.L.multiRowCard.capabilities.dataRoles.length},"Expecting MultiRowCard.capabilities has only 1 data role."),r.add(a,o=h.L.multiRowCard.capabilities.dataRoles[0].name),r.setAggregate(o,0,3),r.add(a,o),r.setAggregate(o,1,4),r.add(a,o),r.setAggregate(o,2,5),[4,this.runQueryImpl({dataSources:s,schema:i,config:{visualType:h.L.multiRowCard.name,query:r},hostServices:(0,m.E)(),visualQueryGenerator:this.visualQueryGenerator,executionType:0,preferCurrentData:!1,allowResultFromClientCache:!1})];case 3:return v=c.sent(),(d=(u=v.dataReaderResult.dataView.table)&&u.rows)&&d.length>0&&(n=(y=d[0])?{min:{formatString:u.columns[0].format,value:y[0]},max:{formatString:u.columns[1].format,value:y[1]},count:y[2]}:void 0),[3,5];case 4:throw x=c.sent(),new Error(x.clientError);case 5:return[2,n]}})})},t.prototype.reset=function(){this.conceptualSchemaProxy.clearCache(),this.dataProxy=(0,w.nW)(this.singleExecutableDataProxyFactory.create(),this.filterGenerator,this.promiseFactory,this.visualPluginService)},t.prototype.runQueryImpl=function(a){return(0,l.__awaiter)(this,void 0,void 0,function(){return(0,l.__generator)(this,function(s){switch(s.label){case 0:return[4,this.dataProxy.runQuery(a)];case 1:return[2,s.sent()]}})})},t}(),R=e(50423),M=function(){function t(){}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=R.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=R.\u0275\u0275defineInjector({providers:[D]}),t}()}}]);