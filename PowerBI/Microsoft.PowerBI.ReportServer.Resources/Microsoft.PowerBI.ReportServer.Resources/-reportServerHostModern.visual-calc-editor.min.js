"use strict";(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["visual-calc-editor"],{8898:function(Ke,Ie,T){T.d(Ie,{x:function(){return I}});var I=new(T(50423).InjectionToken)("EventAggregationServiceToken")},55863:function(Ke,Ie,T){T.d(Ie,{hu:function(){return Y},mv:function(){return k},sr:function(){return R},vE:function(){return U}});var G,x=T(62458);function Y(H,X){x.fF.isDisabled()||!0!==H&&R(X||"condition: ".concat(H))}function k(H,X){x.fF.isDisabled()||null==H&&R(X||"condition: "+H)}function R(H){if(!x.fF.isDisabled())throw(G||alert)("Debug Assert failed: ".concat(H)),new Error(H)}function U(H){return R(H)}},48563:function(Ke,Ie,T){T.d(Ie,{w:function(){return I}});var x=T(17819);function I(H){return H.map(function(X){return function(H){return{name:H.Name,description:H.Description,category:Y(H.Category),pushableToDQ:k(H.PushableToDirectQuery),parameters:R(H.Parameters),visualCalculationsInfo:H.VisualCalculationsInfo}}(X)})}function Y(H){switch(H){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9}}function k(H){var X=0;return 1===H?X=1:2===H?X=2:3===H&&(X=3),X}function R(H){return H?H.map(function(X){return function(H){return new x.Hw(H.Name,H.Optional,H.Repeatable,H.RepeatGroup,H.Skippable)}(X)}):[]}},11674:function(Ke,Ie,T){T.d(Ie,{w_:function(){return Fe},MX:function(){return Me},Jt:function(){return xe}});var k,x=T(81337),I=T(55863),G=T(58871),Y=T(63513);!function(M){M.buildAnonymousExpression=function(f,m,d){return new O(f,m,d).buildAnonymousExpression()};var O=function(){function f(m,d,E){this.tokenization=m,this.context=d,this.delimitIdentifier=E,this.matchObjectReplacements=new Y.Xy,this.unmatchedObjectReplacements={},this.tableIndex=0,this.columnIndex=0,this.measureIndex=0,this.variableIndex=0,this.unmatchedIndex=0}return f.prototype.buildAnonymousExpression=function(){for(var m="",d=0,E=this.tokenization.tokens;d<E.length;d++){var S=E[d],F=void 0;switch(S.type){case 29:case 2:case 3:case 4:case 5:case 6:case 7:F=" ";break;case 10:case 11:case 12:case 13:case 14:case 9:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 40:F=S.getString();break;case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 51:case 52:case 53:case 54:case 49:case 50:case 55:F=S.getString().toUpperCase();break;case 30:case 31:F='"String"';break;case 36:case 37:F="0";break;case 32:case 33:case 34:case 35:case 58:case 57:F=this.anonymizeIdentifier(S);break;case 59:F="?";break;case 38:case 39:F='DT""';break;default:(0,I.sr)("Unexpected token type"),F=""}m+=F}return m},f.prototype.anonymizeIdentifier=function(m){var E,d=m.matchObject;if(d instanceof G.it||d instanceof G.Gs||d instanceof G.Z0)return m.getString().toUpperCase();if(d instanceof G.XN||d instanceof G.Cf||d instanceof G.S2||d instanceof G.yB)(E=this.matchObjectReplacements.get(d))||(E=d instanceof G.XN?"Column"+ ++this.columnIndex:d instanceof G.Cf?"Measure"+ ++this.measureIndex:d instanceof G.S2?"Table"+ ++this.tableIndex:"Variable"+ ++this.variableIndex,this.matchObjectReplacements.add(d,E));else{var S=m.getIdentifier();(E=this.unmatchedObjectReplacements[S])||(E="Unmatched"+ ++this.unmatchedIndex,this.unmatchedObjectReplacements[S]=E)}return this.delimitIdentifier(m.type,E,this.context)},f}()}(k||(k={}));var B,R=T(70163),U=T(66106),H=T(3371),X=T(22021),D=T(85616),re=T(68706),q=T(82269),Q=T(40546),i=T(20540),W=T(66813),C=T(85786),oe=function(){function M(g,O){var f=this;this.newExpressionNode=new D.ig(g,function(){return f._rootNode=O(),f._rootNode}),this._context=g,this._leafPositions=[],this.tokenization=new W.h("",0,void 0,void 0)}return Object.defineProperty(M.prototype,"rootNode",{get:function(){return this._rootNode},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"leafPositions",{get:function(){return this._leafPositions},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"anyErrors",{get:function(){return _.some(this._leafPositions,function(O){return _.some(O.validNodes,function(f){return f instanceof D.IE})})},enumerable:!1,configurable:!0}),M.prototype.getValidLeafNodesAtPosition=function(g){return this._leafPositions[g].validNodes},M.prototype.update=function(g){var O={iToken:void 0,currentNodes:void 0};this.reuseExistingParseTree(g,O),this.completeParseTree(g,O.iToken,O.currentNodes),this.tokenization=g},M.prototype.tryAddClosingParens=function(g,O){var f={result:!1,countParensAdded:-1},m={iToken:void 0,currentNodes:void 0};this.reuseExistingParseTree(this.tokenization,m),(0,I.hu)(m.iToken===this.tokenization.parseTokenCount,"expected iToken to be parseTokenCount");var d=O.expression;for(f.countParensAdded=0;;){var E=new C.WU(24,d+=")",d.length-1,1),S=new G.qf(E);switch(this.tryEatToken(E,new G.qf(E),m)){case i.R.Yum:f.countParensAdded++,g&&(O.expression=d,this.tokenization.updateExpression(O.expression),this.tokenization.tokens.push(E),this.tokenization.parseTokenCount++,this.leafPositions.push(S));break;case i.R.Yuck:return f.result=!1,f;case i.R.NotHungry:return f.result=!0,f}}},M.prototype.reuseExistingParseTree=function(g,O){var f=Math.min(this.tokenization.parseTokenCount,g.parseTokenCount);for(O.iToken=0;O.iToken<f;O.iToken++){var m=this.tokenization.tokens[O.iToken],d=g.tokens[O.iToken];if(m.activelyEdited||d.activelyEdited||!(0,C.Cu)(d.type,m.type))break;this.leafPositions[O.iToken].rebindToken(d)}O.iToken<this.leafPositions.length&&this.leafPositions.splice(O.iToken,this.leafPositions.length-O.iToken);for(var E=O.iToken-1;E>=0;E--){var S=this.leafPositions[E];if(S.isInParseTree)return O.currentNodes=S.nodes,void this.refreshParsePaths(O.currentNodes)}O.currentNodes=[this.newExpressionNode]},M.prototype.refreshParsePaths=function(g){this.removeLaterNodes(g),this.reinitializeParsePaths(g)},M.prototype.removeLaterNodes=function(g){for(var O=0,f=g;O<f.length;O++){var m=f[O];m.onParseIncomplete();for(var d=void 0,E=m;d=E.parent;E=d)d.removeLaterChildren(E),d.onParseIncomplete()}},M.prototype.reinitializeParsePaths=function(g){for(var O=0,f=g;O<f.length;O++)for(var d=f[O].path;d;d=d.parent)d.reinitialize();for(var E=0,S=g;E<S.length;E++)for(var F=(d=S[E].path).parent;F&&F.addChild(d);d=F,F=F.parent);},M.prototype.completeParseTree=function(g,O,f){for(var m={currentNodes:f},d=[],E=!0,S=[],F=function(){var ne=g.tokens[O],se=new G.qf(ne);if((0,I.hu)(K.leafPositions.length===O,"iToken to be the end of the leaf positions"),K.leafPositions.push(se),K.tryEatToken(ne,se,m),!Q.d.featureSwitches.addTriviaToParseNodeMetadata)return"continue";if(ne.ignorable)return d.push(ne),"continue";if(60===ne.type)return"continue";if(E&&m.currentNodes.length)E=!1,m.currentNodes.map(function(Ce){return Ce.leadingTrivia=d}),d=[];else if(S.length&&m.currentNodes.length){var de=d.findIndex(function(Ce){return Ce.getString().includes("\n")}),be=-1===de?d.length:de+1;S.map(function(Ce){return Ce.trailingTrivia=d.slice(0,be)}),m.currentNodes.map(function(Ce){return Ce.leadingTrivia=d.slice(be)}),d=[]}S=m.currentNodes},K=this;O<g.parseTokenCount;O++)F();Q.d.featureSwitches.addTriviaToParseNodeMetadata&&d.length>0&&S.length&&S.map(function(ee){return ee.trailingTrivia=d})},M.prototype.tryEatToken=function(g,O,f){if(g.ignorable)return O.addNode(new D.i8(O,this.context)),i.R.Yum;for(var m=!1,d=0,E=f.currentNodes;d<E.length;d++)for(var S=E[d],F=[],K=S;;K=K.parent){var ee=K.eatToken(O,S.path);if(ee===i.R.Yum){for(var ne=0,se=F;ne<se.length;ne++){var de=se[ne];de.parentNode.setChild(de.parseNode)}if(60!==O.token.type)for(var be=S;be!==K;be=be.parent)be.onParseComplete();break}if(ee===i.R.Yuck){S.path.markUnsuccessful();break}if((0,I.hu)(ee===i.R.NotHungry,"expected ".concat(ee," to be EatResult.NotHungry (").concat(i.R.NotHungry,")")),!K.parent){m=!0,S.path.markUnsuccessful();break}var Ce=K.parent instanceof D.q1?K.parent:null;Ce&&F.push({parseNode:K,parentNode:Ce})}return _.some(O.nodes)?(f.currentNodes=O.nodes,f.currentNodes.forEach(function(Re){return Re.consolidatePath()}),i.R.Yum):(60!==g.type&&O.addNode(new D.IE(O,this.context)),this.reinitializeParsePaths(f.currentNodes),m?i.R.NotHungry:i.R.Yuck)},M.prototype.clearAllContexts=function(){for(var g=[this.rootNode];g.length>0;){var f=g.pop();f.parent&&f.clearContext(),f instanceof G.sN&&(f instanceof D.q1?f.prospectiveChildren:f.children).forEach(function(m){return g.push(m)})}},M}(),ve=T(88498);(B||(B={})).couldBeOperand=function(O){for(var f=O.parent;null!=f&&f.isFirstChild(O);O=f,f=f.parent)if(f instanceof D.HV||f instanceof D.Ti||f instanceof D.F0||f instanceof D.IS||f instanceof D.RZ||f instanceof D.gi||f instanceof D.Ed||f instanceof D.gR||f instanceof D.ze||f instanceof D.Sm)return!0;return!1};var b=T(42165),te=T(48987),pe=function(){function M(g,O,f,m){this.tokenization=g,this.parseTree=O,this.iNewToken=f,this.iTokenLeft=m,this.suggestionContexts=[],this._suggestions=[],this._replaceStart=-1,this._replaceEnd=-1,this._afterOParen=-1,this._afterCParen=-1,this._bestMatch=-1}return Object.defineProperty(M.prototype,"bestMatch",{get:function(){return this._bestMatch},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"afterCParen",{get:function(){return this._afterCParen},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"afterOParen",{get:function(){return this._afterOParen},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"replaceStart",{get:function(){return this._replaceStart},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"replaceEnd",{get:function(){return this._replaceEnd},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"suggestions",{get:function(){return this._suggestions},enumerable:!1,configurable:!0}),M.prototype.buildSuggestions=function(){this.addSuggestions(),this.removeDuplicateSuggestionsForSameObject(),this.removeDuplicateSuggestionsBySuggestionText(),this.sortSuggestions(),this.findBestMatch()},M.prototype.addSuggestions=function(g,O){if(g)this.suggestionContexts=this.suggestionContexts.concat(_.map(g,function(v){return new ye(v,O)}));else if(this._replaceStart=this.tokenization.cursorPosition||0,this._replaceEnd=this.tokenization.cursorPosition||0,this.tokenization.activeCursor&&3!==this.tokenization.cursorActivity){var f=this.iNewToken;if(-1===f&&(f=this.iTokenLeft),-1!==f){for(var m=this.tokenization.tokens[f],d=0,E=this.parseTree.getValidLeafNodesAtPosition(f);d<E.length;d++){var S=E[d];if(S instanceof D.IE)return;var F=S.parent,K=void 0;if((F instanceof D.DH||F instanceof D.qS||F instanceof D.Fc)&&(K=F.firstDescendent.token)!==m){for(var ee=void 0,ne=f-1;(ee=this.tokenization.tokens[ne])!==K;ne--)if(29!==ee.type&&_.some(this.parseTree.getValidLeafNodesAtPosition(ne),function(v){return v instanceof D.i8||v instanceof D.IE}))return;var se=(0,Y.as)(F,D.Fc);if(se){this.addSuggestionsBasedOnPartialVariation(m.getIdentifier(),S.context,se.dotNode.token.startPosition);var de=se.variationSource;(0,Y.as)(de.parent,D.DH)?this.addSuggestionsBasedOnTableColumnAndPartialVariation(K.getIdentifier(),de.token.getIdentifier(),m.getIdentifier(),K.matchesType(32),se.context,K.startPosition):this.addSuggestionsBasedOnColumnAndPartialVariation(de.token.getIdentifier(),m.getIdentifier(),se.context,K.startPosition)}else F instanceof D.qS?this.addSuggestionsBasedOnPartialIdentifier(this.tokenization.expression.substr(K.startPosition,m.endPosition-K.startPosition),F.context,K.startPosition):this.addSuggestionsBasedOnTableAndPartialColumnOrMeasure(K.getIdentifier(),m.getIdentifier(),K.matchesType(32),F.context,K.startPosition)}else{var Ce=S.context;if(Q.d.featureSwitches.suggestKeywords&&S instanceof D.ub&&!(S.parent instanceof D.mR)&&this.addSuggestionsBasedOnPartialKeywordValue(m.getString(),S.keyword,m.startPosition),33===m.type)this.addSuggestionsBasedOnPartialTable(m.getIdentifier(),Ce,m.startPosition),this.addSuggestionsBasedOnPartialCalendarCore(m.getIdentifier(),!0,new le(Ce),m.startPosition);else if(35===m.type)this.addSuggestionsBasedOnPartialColumnOrMeasure(m.getIdentifier(),Ce,m.startPosition);else if(m.isIdentifierOrKeyword&&B.couldBeOperand(S))this.addSuggestionsBasedOnPartialIdentifier(m.getIdentifier(),Ce,m.startPosition);else if(36===m.type)this.addSuggestionsBasedOnPartialEnumValue(m.getString(),Ce,m.startPosition);else if(60===m.type){var Re=this.tokenization.nextNonIgnorable(f);this.addSuggestionsBasedOnNewToken(Ce,(Re?Re.matchedType:U.Yl.None).type,m.startPosition,4===this.tokenization.cursorActivity)}}}this.setReplaceStartAndPadSuggestions(),this._replaceEnd=m.endPosition;var a={iTokenNext:-1},u=this.tokenization.nextNonIgnorable(f,a);u&&(u.secondHalf&&(u.matchObject||1===u.length)&&(33===m.type&&32===u.type||35===m.type&&34===u.type||m.isIdentifierOrKeyword&&u.isIdentifierOrKeyword)&&((0,I.hu)(this.replaceEnd===u.startPosition,"expected replaceEnd to equal startPosition"),this._replaceEnd=u.endPosition,u=this.tokenization.nextNonIgnorable(a.iTokenNext,a)),u&&23===u.type&&(this._afterOParen=u.endPosition,(u=this.tokenization.nextNonIgnorable(a.iTokenNext,a))&&24===u.type&&(this._afterCParen=u.endPosition)))}}},M.prototype.addSuggestion=function(g,O){this.suggestionContexts.push(new ye(g,O))},M.prototype.setReplaceStartAndPadSuggestions=function(){var g=this;this.suggestionContexts.length>0&&(this._replaceStart=_.min(_.map(this.suggestionContexts,function(O){return O.replaceStart})),this._suggestions=this._suggestions.concat(_.map(this.suggestionContexts,function(O){return g.replaceStart<O.replaceStart&&O.suggestion.prependSuggestionText(g.tokenization.expression.substr(g.replaceStart,O.replaceStart-g.replaceStart)),O.suggestion})))},M.prototype.addSuggestionsBasedOnPartialTableCore=function(g,O,f,m){this.addSuggestions(_.chain(f.tables).filter(function(be){return M.isMatch(be.name,g)}).map(function(be){return new te.q$(be,be.getAutoCompleteName(O))}).value(),m);for(var d=function(Ce){var Re=M.tableToSuggest(Ce),N=Re.getAutoCompleteName(O),l=M.isMatch(Re.name,g);l&&g!==N&&E.addSuggestion(new te.tA(Re,N),m),E.addSuggestions(_.chain(Ce.columns).filter(function(a){return l||M.isColumnMatch(a,g)}).map(function(a){return M.buildTableColumnSuggestion(a,O,!0)}).value(),m)},E=this,S=0,F=f.tablesForQualifiedColumnRefs;S<F.length;S++)d(F[S]);for(var ee=function(Ce){var Re=Ce.getAutoCompleteName(O);ne.addSuggestions(_.map(Ce.measures,function(N){return new te.q$(N,Re+Y.LP.bracket(N.name),Ce,N)}),m)},ne=this,se=0,de=_.filter(f.tablesForMeasures,function(be){return M.isMatch(be.name,g)});se<de.length;se++)ee(de[se])},M.prototype.addSuggestionsBasedOnPartialTable=function(g,O,f){this.addSuggestionsBasedOnPartialTableCore(g,!0,new le(O),f),this.userInput=g},M.prototype.addSuggestionsBasedOnPartialColumnOrMeasureCore=function(g,O,f){this.addSuggestions(_.chain(O.simpleColumnRefs).filter(function(m){return M.isColumnMatch(m,g)}).map(function(m){return M.buildColumnSuggestion(m)}).value(),f),this.addSuggestions(_.chain(O.measures).filter(function(m){return M.isMatch(m.name,g)}).map(function(m){return new te.q$(m,Y.LP.bracket(m.name))}).value(),f)},M.prototype.addSuggestionsBasedOnPartialColumnOrMeasure=function(g,O,f){this.addSuggestionsBasedOnPartialColumnOrMeasureCore(g,new le(O),f),this.userInput=g},M.prototype.addSuggestionsBasedOnColumnAndPartialVariation=function(g,O,f,m){var d=new le(f);this.addSuggestions(_.chain(d.simpleColumnRefs).filter(function(E){return E.table.variationSource&&Y.uI.equalIgnoreCase(E.table.variationSource.name,g)&&M.isMatch(E.name,O)}).map(function(E){return new te.q$(E,Y.LP.bracket(E.table.variationSource.name)+"."+Y.LP.bracket(E.name),E)}).value(),m),this.userInput=O},M.prototype.addSuggestionsBasedOnPartialEnumValueCore=function(g,O,f){this.addSuggestions(_.chain(O.enumValues).filter(function(m){return M.isMatch(m.name,g)}).map(function(m){return new te.q$(m,m.name)}).value(),f)},M.prototype.addSuggestionsBasedOnPartialCalendarCore=function(g,O,f,m){this.addSuggestions(_.chain(f.calendars).filter(function(d){return M.isMatch(d.name,g)}).map(function(d){if(O)return new te.q$(d,Y.LP.quote(d.name));var E=d.name.trim().indexOf(" ")>=0;return new te.q$(d,E?Y.LP.quote(d.name):d.name)}).value(),m)},M.prototype.addSuggestionsBasedOnPartialEnumValue=function(g,O,f){this.addSuggestionsBasedOnPartialEnumValueCore(g,new le(O),f),this.userInput=g},M.prototype.addSuggestionsBasedOnPartialKeywordValue=function(g,O,f){M.isMatch(O,g)&&this.addSuggestions([new te.q$(new G.Z0(O),O.toUpperCase())],f),this.userInput=g},M.prototype.addSuggestionBasedOnParitialAxis=function(g,O,f){var m=O.axes.map(function(E){return E.name}),d=m;m.length>=2&&(d=(0,x.ev)((0,x.ev)([],m,!0),["".concat(m[0]," ").concat(m[1]),"".concat(m[1]," ").concat(m[0])],!1)),this.addSuggestions(_.chain(d).filter(function(E){return M.startsWith(E,g)}).map(function(E){return new te.q$(new G.cr(E),E)}).value(),f)},M.prototype.addSuggestionsBasedOnPartialIdentifier=function(g,O,f){var m=new le(O);this.addSuggestionsBasedOnPartialTableCore(g,!1,m,f),this.addSuggestionsBasedOnPartialColumnOrMeasureCore(g,m,f),this.addSuggestionsBasedOnPartialEnumValueCore(g,m,f),this.addSuggestionBasedOnParitialAxis(g,m,f),this.addSuggestionsBasedOnPartialCalendarCore(g,!1,m,f),this.addSuggestions(_.chain(m.functions).filter(function(d){return M.isMatch(d.name,g)}).map(function(d){return new te.q$(d,d.name)}).value(),f),this.addSuggestions(_.chain(m.variables).filter(function(d){return M.isMatch(d.name,g)}).map(function(d){return new te.q$(d,d.name)}).value(),f),this.userInput=g},M.prototype.addSuggestionsBasedOnNewToken=function(g,O,f,m){_.some(g.ephemeralContexts)?O!==U.Yl.None.type&&_.some(g.ephemeralContexts,function(E){return Y.G.hasFlag(E.allowedTypes,O)})||this.addSuggestionsBasedOnPartialIdentifier("",g,f):m&&this.addSuggestionsBasedOnPartialIdentifier("",g,f)},M.prototype.addSuggestionsBasedOnTableAndPartialColumnOrMeasure=function(g,O,f,m,d){for(var E=new le(m),S=0,F=E.tablesForQualifiedColumnRefs;S<F.length;S++){var K=F[S],ee=M.tableToSuggest(K);Y.uI.equalIgnoreCase(ee.name,g)&&this.addSuggestions(K.columns.filter(function(de){return M.isColumnMatch(de,O)}).map(function(de){return M.buildTableColumnSuggestion(de,f,!1)}),d)}var ne=_.find(E.tablesForMeasures,function(de){return Y.uI.equalIgnoreCase(de.name,g)});if(ne){var se=ne.getAutoCompleteName(f);this.addSuggestions(ne.measures.filter(function(de){return M.isMatch(de.name,O)}).map(function(de){return new te.q$(de,se+Y.LP.bracket(de.name),de)}),d)}this.userInput=O},M.prototype.addSuggestionsBasedOnTableColumnAndPartialVariation=function(g,O,f,m,d,E){for(var S=new le(d),F=function(be){var Re=be.variationSource.table.getAutoCompleteName(m);K.addSuggestions(be.columns.filter(function(N){return M.isMatch(N.name,f)}).map(function(N){return new te.q$(N,Re+Y.LP.bracket(be.variationSource.name)+"."+Y.LP.bracket(N.name),N)}),E)},K=this,ee=0,ne=_.filter(S.tablesForQualifiedColumnRefs,function(de){return de.variationSource&&Y.uI.equalIgnoreCase(de.variationSource.table.name,g)&&Y.uI.equalIgnoreCase(de.variationSource.name,O)});ee<ne.length;ee++)F(ne[ee]);this.userInput=f},M.prototype.addSuggestionsBasedOnPartialVariation=function(g,O,f){var m=new le(O),d=_.chain(m.newVariations).filter(function(E){return M.isMatch(E.name,g)}).map(function(E){return new te.q$(E,"."+Y.LP.bracket(E.name))}).value();_.some(d)&&(this.addSuggestions(d,f),this.userInput=g)},M.prototype.removeDuplicateSuggestionsForSameObject=function(){for(var g=new Y.Xy,O=0,f=this.suggestions;O<f.length;O++){var m=f[O],d=m.matchObject;g.containsKey(d)?m.segments.length>g.get(d).segments.length&&g.update(d,m):g.add(d,m)}this._suggestions=g.values()},M.prototype.removeDuplicateSuggestionsBySuggestionText=function(){this._suggestions=Y.Sy.distinct(this.suggestions,te.XI.equals)},M.prototype.sortSuggestions=function(){this.suggestions.sort(te.J_)},M.prototype.findBestMatch=function(){var g=this;if(this._bestMatch=-1,_.some(this.suggestions)){for(var O=void 0,f=function(F){if(O=_.find(m.suggestions,function(K){return K.segments.length>F&&_.startsWith(K.segments[F].toUpperCase(),g.userInput.toUpperCase())}))return"break"},m=this,d=0;d<3&&"break"!==f(d);d++);this._bestMatch=0,O&&(this._bestMatch=this.suggestions.indexOf(O))}},M.buildColumnSuggestion=function(g){var O=Y.LP.bracket(g.name),f=[g],m=g.table.variationSource;return m&&(O=Y.LP.bracket(m.name)+"."+O,f.splice(0,0,m)),g.variationTable?new(te.tA.bind.apply(te.tA,(0,x.ev)([void 0,g,O],f,!1))):new(te.q$.bind.apply(te.q$,(0,x.ev)([void 0,g,O],f,!1)))},M.tableToSuggest=function(g){return g.variationSource?g.variationSource.table:g},M.buildTableColumnSuggestion=function(g,O,f){var m=g.table,d=Y.LP.bracket(g.name),E=[g],S=m.variationSource;return S&&(d=Y.LP.bracket(S.name)+"."+d,E.splice(0,0,S),m=S.table),d=m.getAutoCompleteName(O)+d,f&&E.splice(0,0,m),g.variationTable?new(te.tA.bind.apply(te.tA,(0,x.ev)([void 0,g,d],E,!1))):new(te.q$.bind.apply(te.q$,(0,x.ev)([void 0,g,d],E,!1)))},M.isColumnMatch=function(g,O){if(M.isMatch(g.name,O))return!0;var f=g.table.variationSource;return!(!f||!M.isMatch(f.name,O))},M.isMatch=function(g,O){return!!(M.startsWith(g,O)||O.length>=2&&g.toUpperCase().indexOf(O.toUpperCase())>=0)},M.startsWith=function(g,O){return _.startsWith(g.toUpperCase(),O.toUpperCase())},M}(),le=function(){function M(g){this._tables=[],this._tablesForMeasures=[],this._measures=[],this._newVariations=[],this._axes=[],this._calendars=[];var O=!1,f=[],m=[],d=[],E=[],S=0;if(_.some(g.ephemeralContexts))for(var F=0,K=g.ephemeralContexts;F<K.length;F++){var ee=K[F],ne=ee.allowedTypes;(Y.G.hasFlag(ne,1)||Q.d.featureSwitches.useSkippableParams&&void 0===ne)&&(O=!0),(Y.G.hasFlag(ne,2)||Y.G.hasFlag(ne,4))&&(this._tables=g.matchObjects.tables.filter(function(se){return se.isUserTable}),S|=256),Y.G.hasFlag(ne,8)&&(f=f.concat(ee.getTablesInScopeForQualifiedColRefs())),Y.G.hasFlag(ne,16)&&(m=m.concat(ee.getSimpleColumnRefsInScope())),Y.G.hasFlag(ne,64)&&(d=d.concat(ee.enumValues)),Y.G.hasFlag(ne,2)&&(S|=20494,E=E.concat(_.filter(g.variables,function(se){return se.value&&se.value.tableValue}))),Y.G.hasFlag(ne,128)&&(S|=16),Y.G.hasFlag(ne,256)&&(S|=32),Y.G.hasFlag(ne,512)&&(S|=64),Y.G.hasFlag(ne,1024)&&(S|=128),Y.G.hasFlag(ne,16384)&&(S|=512),Y.G.hasFlag(ne,32768)&&(S|=1024),Y.G.hasFlag(ne,131072)&&(S|=2048),Y.G.hasFlag(ne,8192)&&(this._newVariations=ee.getSimpleColumnRefsInScope()),(Y.G.hasFlag(ne,524288)||Y.G.hasFlag(ne,65536))&&(this._axes=g.matchObjects.axes),Y.G.hasFlag(ne,524288)&&(S|=8192),Y.G.hasFlag(ne,1048576)&&(this._calendars=g.matchObjects.calendars)}else O=!0;O&&(f=f.concat(g.getTablesInScopeForQualifiedColRefs()),m=m.concat(g.getSimpleColumnRefsInScope()),E=E.concat(g.variables),this._tablesForMeasures=g.matchObjects.tables.filter(function(se){return se.isUserTable}),this._measures=g.matchObjects.measures,S|=20495,S|=256),g.groupByCurrentTable||(S&=-9),this._tablesForQualifiedColumnRefs=f.filter(function(se){return se.isUserTable}),this._simpleColumnRefs=m,this._enumValues=d,this._variables=E,this._functions=_.filter(g.matchObjects.functions,function(se){return!!(se.role&S)})}return Object.defineProperty(M.prototype,"tables",{get:function(){return this._tables},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"tablesForMeasures",{get:function(){return this._tablesForMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"tablesForQualifiedColumnRefs",{get:function(){return this._tablesForQualifiedColumnRefs},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"simpleColumnRefs",{get:function(){return this._simpleColumnRefs},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"variables",{get:function(){return this._variables},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"measures",{get:function(){return this._measures},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"newVariations",{get:function(){return this._newVariations},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"axes",{get:function(){return this._axes},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"calendars",{get:function(){return this._calendars},enumerable:!1,configurable:!0}),M}(),ye=function(){return function(g,O){this.suggestion=g,this.replaceStart=O}}(),Pe=T(21527);R.j(function(M,g){var O=M.trimEnd();if("]"!==O[O.length-1])return!1;var f=(0,Pe.w)(M,0,void 0,void 0,void 0,!0),m=new D.DH(void 0),d=new oe(void 0,function(){return m});return d.update(f),d.anyErrors?(g.table=void 0,g.column=void 0,!1):m.tryGetTableAndColumnNames(g)});var Me=function(M){return M[M.LegacyDefaultBehavior=0]="LegacyDefaultBehavior",M[M.AddMissingParens=1]="AddMissingParens",M[M.ConvertToEngine=2]="ConvertToEngine",M[M.Anonymize=4]="Anonymize",M}({}),xe=function(M){return M[M.Expression=0]="Expression",M[M.Query=1]="Query",M[M.MultipleQueries=2]="MultipleQueries",M[M.MaskExpressionType=3]="MaskExpressionType",M}({}),Fe=function(){function M(g){void 0===g&&(g=xe.Expression),this.options=g,this.clearParseState()}return Object.defineProperty(M.prototype,"parseTree",{get:function(){return this._parseTree},enumerable:!1,configurable:!0}),M.findCursorTokens=function(g){var O={iToken:-1,iNewToken:-1,iTokenLeft:-1,iTokenRight:-1,iTokenPrev:-1,iTokenSelection:-1};if(0!==g.cursorActivity){for(var f=g.cursorPosition||0,m=g.parseTokenCount-1;m>=0;m--)if(!(d=g.tokens[m]).ignorable&&(d.startPosition===f?d.length>0?O.iTokenRight=m:((0,I.hu)(60===d.type,"expected newToken"),O.iNewToken=m):d.startPosition+d.length===f&&(O.iTokenLeft=m),d.startPosition<f)){O.iTokenPrev=m;break}var E=g.selectionStart||0;if(E>=0)for(m=g.parseTokenCount-1;m>=0;m--){var d;if(!((d=g.tokens[m]).startPosition>=E)){d.startPosition+d.length>E&&29!==d.type&&(O.iTokenSelection=-1);break}d.ignorable||(O.iTokenSelection=m)}}return O},M.isUnrecognizedIdentifier=function(g){var O=g.token;return(0,I.hu)(O.isAnyKindOfIdentifier,"Expected IsUnrecognizedIdentifier to be called with an identifier node"),!O.matchObject&&!(g.parent instanceof D.qS||g.parent instanceof D.ai)},M.checkSemiselectability=function(g,O,f,m){-1!==f&&(m.semiselectable=_.some(O.getValidLeafNodesAtPosition(f),B.couldBeOperand))},M.updateSuggestions=function(g,O,f,m,d){var E=new pe(g,O,f,m);E.buildSuggestions(),d.suggestions=E.suggestions,d.replaceStart=E.replaceStart,d.replaceEnd=E.replaceEnd,d.afterOParen=E.afterOParen,d.afterCParen=E.afterCParen,d.bestMatch=E.bestMatch},M.checkBoldParens=function(g,O,f,m,d){var E;if(-1!==f&&24===g.tokens[f].type?E=_.map(O.getValidLeafNodesAtPosition(f),function(be){return be.parent}):-1!==m&&23===g.tokens[m].type&&(E=_.map(O.getValidLeafNodesAtPosition(m),function(be){return be.parent})),E){for(var S,F,K=0,ee=E;K<ee.length;K++){var ne=ee[K],se=(0,Y.as)(ne,D.U6);if(se){S=se.leftParen,F=se.rightParen;break}var de=ne instanceof D.u0?ne:null;if(de){S=de.leftParen,F=de.rightParen;break}}S&&F&&(d.boldLeftParen=S.token.startPosition,d.boldRightParen=F.token.startPosition)}},M.checkPrototype=function(g,O,f){var m,d;if(-1!==O)for(var E=0,S=g.getValidLeafNodesAtPosition(O);E<S.length;E++){var K=void 0,ee=void 0;for(ee=(K=S[E]).parent;ee;K=ee,ee=ee.parent){var ne=void 0,se=void 0,de=void 0;if(ne=(0,Y.as)(ee,D.fA)){var be=ne.getParamIndex(K);(Ce=ne.getParameterByIndex(be))&&(m=f.prototypeParamContexts).push.apply(m,Ce.context.parameterContexts)}else if((se=ee instanceof D.u0?ee:void 0)&&(de=se.functionNode)&&K!==se.rightParen){var Re=se.leftParen,N=de.token;if(f.prototypeFunctionBase=(0,Y.as)(N.matchObject,G.eL),f.prototypePosition=N.startPosition,K===Re){var Ce=void 0;(ne=se.parameterList)&&(Ce=ne.getParameterByIndex(0)),Ce?(d=f.prototypeParamContexts).push.apply(d,Ce.context.parameterContexts):f.prototypeParamContexts.push(new G.Go)}if(K!==de)break}}if(f.prototypeFunctionBase)break}},M.userEditingNode=function(g,O){if(!g.activeCursor)return!1;for(var f=O.token,m=f,d=O.parent;d instanceof D.n1||d instanceof D.DH||d instanceof D.jg||d instanceof D.Fc||d instanceof D.qS;d=d.parent)f=d.firstDescendent.token,m=d.lastDescendent.token;var E=g.cursorPosition||0;return f.startPosition<=E&&E<=m.endPosition},M.updateSyntaxHighlighting=function(g,O){for(var f,m=0;m<g.tokens.length;m++){var d=g.tokens[m];d.isComment?O.comments.push(d.getSegment()):d.isKeyword?O.functions.push(d.getSegment()):30===d.type||31===d.type?O.strings.push(d.getSegment()):33===d.type||35===d.type||39===d.type?O.unrecognizedIdentifiers.push(d.getSegment()):d.isAnyKindOfIdentifier&&(d.matchObject instanceof G.Gs||d.matchObject instanceof G.Z0||d.matchObject instanceof G.it||d.matchObject instanceof G.cr?O.functions.push(d.getSegment()):d.matchObject instanceof G.S2?O.tableReferences.push(d.getSegment()):d.matchObject instanceof G.XN?O.columnReferences.push(d.getSegment()):d.matchObject instanceof G.Cf?O.measureReferences.push(d.getSegment()):d.matchObject instanceof G.yB?O.variables.push(d.getSegment()):m<g.parseTokenCount&&O.unrecognizedIdentifiers.push(d.getSegment()))}(f=O.references).push.apply(f,(0,x.ev)((0,x.ev)((0,x.ev)([],O.tableReferences,!1),O.columnReferences,!1),O.measureReferences,!1))},M.detectErrors=function(g,O,f){for(var m,d=0,E=O.leafPositions;d<E.length;d++){for(var F=void 0,K=0,ee=E[d].validNodes;K<ee.length;K++){var se=M.errorsAtNode(g,ee[K],O.context);(!F||se.length<F.length)&&(F=se)}F&&(m=f.errors).push.apply(m,F)}},M.errorsAtNode=function(g,O,f){var m=[],d=O.token;if(O instanceof D.IE){if(M.userEditingNode(g,O))switch(d.type){case 60:case 40:return m}return m.push(new re.D(d.getSegment(),re.j.Gramatical)),m}if(M.userEditingNode(g,O)||!O.parent)return m;if(O instanceof D.R6){var E=(0,Y.as)(O.parent,D.tw);E&&!E.isInValidLocation&&m.push(new re.D(E.fullSpan,re.j.InvalidTupleLocation))}if(O instanceof D.N9){var F=(0,Y.as)(O.parent,D._N).invalidRightArgument;F&&m.push(new re.D(F.fullSpan,re.j.RightArgumentToInOperatorNotValidTable))}if(O instanceof D.gq&&O.parent instanceof D.pZ){var K=O.parent.measureDef;if(K?.isComplete){var ee=K.tableName,ne=K.identifier,se=f.matchObjects.measures.find(function(Ae){return!Ae.isQueryScoped&&Ae.name.toLowerCase()===ne?.toLowerCase()});se&&se.table.name.toLowerCase()!==ee?.toLowerCase()&&m.push(new re.D(K.fullSpan,re.j.DuplicateMeasureName))}}if(d.isAnyKindOfIdentifier&&(O.parent instanceof D.xY&&_.some(Object.keys(O.context.matchObjects.reservedWords),function(Ae){return Y.uI.equalIgnoreCase(Ae,d.getString())})&&m.push(new re.D(d.getSegment(),re.j.VariableNameReserved)),M.isUnrecognizedIdentifier(O)&&m.push(new re.D(d.getSegment(),re.j.UnrecognizedIdentifier))),37===d.type&&m.push(new re.D(d.getSegment(),re.j.IncompleteNumber)),d.isIdentifierOrKeyword){var de=O.parent instanceof D.u0?O.parent:null;if(de){var be=(0,Y.as)(d.matchObject,G.eL);if(be){var Ce=de.parameterList,Re=function(M,g,O){for(var f=new G.gR,m=M.getParamCount(O),d=M.signatures.map(function(se){return new G.o(g,se,O,m,!1)}),E=Y.jl.getAllExploredStates(d),K=0,ee=E.completedStates.concat(E.incompleteStates);K<ee.length;K++){var ne=ee[K];f.assessStatus(ne.actualParam,m,ne.prototypeParam,ne.prototypeSignature)}return f}(be,de.context,Ce),N=re.j.InvalidParameter;if(!Re.success){var l=de.rightParen,a=void 0,u=void 0;if(Re.incomplete)l&&(a=u=l.token,N=re.j.MissingParameters);else if(Re.badParam>-1){if(Re.badParam!==Ce.parameterCount-1||l){var v=Ce.getParameterByIndex(Re.badParam);if(v){a=v.firstDescendent.token,u=v.lastDescendent.token;var A=Re.associatedSignature;Re.badParam<A.length&&(A[Re.badParam].role===U.Yl.OrderByParam&&(N=re.j.IncorrectOrderByParam),A[Re.badParam].role===U.Yl.PartitionByParam&&(N=re.j.IncorrectPartitionByParam),A[Re.badParam].role===U.Yl.MatchByParam&&(N=re.j.IncorrectMatchByParam))}else{var Z=Ce.getSeparatorByIndex(Re.badParam+1);Z||(Z=l),a=u=Z.token}}}else Re.firstExtraParam>-1&&(N=re.j.TooManyParameters,a=(0===Re.firstExtraParam?Ce.firstDescendent:Ce.getSeparatorByIndex(Re.firstExtraParam)).token,u=Ce.lastDescendent.token);a&&m.push(new re.D(b.X.fromTokens(a,u),N))}}else m.push(new re.D(d.getSegment(),re.j.FunctionCallOnNonFunction))}var ue=(0,Y.as)(O.parent,D.qS);if(ue)if(Y.LP.hasValidAxesReferences(ue.axesRef)||ue.isValidEnumValue||O!==ue.firstIdentifier){if(Y.LP.hasValidAxesReferences(ue.axesRef)&&O===ue.firstIdentifier){var ge=ue.axesRef,we=ue.firstIdentifier.token,Ne=ue.lastIdentifier.token;_.uniqWith(ge,G.e$).length!==ge.length&&m.push(new re.D(b.X.fromTokens(we,Ne),re.j.InvalidParameter))}}else for(var Ee=1;Ee<ue.children.length;Ee++)m.push(new re.D(ue.getIdentifier(Ee).token.getSegment(),re.j.InvalidIdentifier))}return m},M.getResult=function(g,O,f){f=f||{};var m=new q.b(g.expression,g.cursorActivity,g.cursorPosition,g.selectionStart);if(!f.disableAll){var d=M.findCursorTokens(g);M.checkSemiselectability(g,O,d.iTokenSelection,m),f.disableSuggestions||M.updateSuggestions(g,O,d.iNewToken,d.iTokenLeft,m),M.checkBoldParens(g,O,d.iTokenLeft,d.iTokenRight,m),M.checkPrototype(O,d.iTokenPrev,m),f.disableSyntaxHighlighting||M.updateSyntaxHighlighting(g,m),f.disableErrorDetection||M.detectErrors(g,O,m)}return m},M.prototype.tryBindQualifiedReference=function(g,O){(0,I.hu)(34===g.type,"expected BracketedIdentifier"),(0,I.hu)(O.token===g,"expected BracketedIdentifier");var f=(0,Y.as)(O.parent,D.DH);if(f){var E=f.tableRefNode.tableNode.token,S=E.getString();32===E.type&&(S=M.unquote(S));for(var F=M.unbracket(g.getString()),K=0,ee=_.filter(f.context.getAllTablesInScopeForQualifiedColRefs(),function(Ce){return Oe(Ce.name,S)});K<ee.length;K++){var ne=ee[K],se=ne.findColumn(F);if(se)return E.matchObject=ne,g.matchObject=se,!0}var de=f.context.matchObjects.findTable(S),be=de?.findMeasure(F);return be&&(E.matchObject=de,g.matchObject=be),!0}return!1},M.prototype.tryBindVariation=function(g,O){(0,I.hu)(34===g.type,"expected brackedIdentifierToken"),(0,I.hu)(O.token===g,"expected brackedIdentifierToken");var f=(0,Y.as)(O.parent,D.Fc);if(f){var m=M.unbracket(g.getString()),d=f.variationSource,E=d.token,S=E.matchObject;if(S&&S.variationTable&&(g.matchObject=S.variationTable.findColumn(m)),!g.matchObject){var K,F=void 0;d.parent instanceof D.DH&&(K=(F=d.parent.tableRefNode.tableNode.token).getIdentifier());var ee=E.getIdentifier(),ne=_.find(f.context.getAllSimpleColRefsInScope(),function(se){return!!se.table.variationSource&&Oe(se.name,m)&&Oe(se.table.variationSource.name,ee)&&(!K||Oe(se.table.variationSource.table.name,K))});ne&&(F&&(F.matchObject=ne.table.variationSource.table),E.matchObject=ne.table.variationSource,g.matchObject=ne)}return!0}return!1},M.prototype.bindTokens=function(g,O){for(var f=g.tokens,m=0;m<g.parseTokenCount;m++)this.bindToken(f[m],this._parseTree.getValidLeafNodesAtPosition(m),O)},M.prototype.bindToken=function(g,O,f){if(!g.matchObject)for(var m=function(ne){switch(g.type){case 58:var se=ne.parent;if(se instanceof D.qS){if(d.tryBindMultiAxisReference(g,(0,Y.as)(se,D.qS))||d.tryBindMultiEnumValue(g,(0,Y.as)(se,D.qS)))return{value:void 0};break}var de=g.getString();if(g.matchObject=f.findAxis(de))return g.matchObject=new G.cr(de),{value:void 0};var be=(0,Y.as)(se,D.rI);if(be&&be.identifier===ne)return g.matchObject=new G.yB(de,be),{value:void 0};if(g.matchObject=f.findFunction(de))return{value:void 0};if(_.includes(Object.keys(f.reservedWords),de))return g.matchObject=new G.Z0(de),{value:void 0};if(g.matchObject=f.findTable(de))return{value:void 0};if(g.matchObject=_.find(ne.context.variables,function(l){return Oe(l.name,de)}))return{value:void 0};var Ce=_.flatMap(ne.context.ephemeralContexts,function(l){return l.enumValues}).filter(function(l){return!!l});if(!_.isEmpty(Ce)&&(g.matchObject=_.find(Ce,function(l){return Oe(l.name,de)})))return{value:void 0};if(g.matchObject=f.findCalendar(de))return{value:void 0};break;case 57:case 46:g.matchObject=f.findFunction(g.getString());break;case 32:var Re=M.unquote(g.getString());if(g.matchObject=f.findTable(Re))return{value:void 0};if(g.matchObject=f.findCalendar(Re))return{value:void 0};break;case 34:if(d.tryBindQualifiedReference(g,ne)||d.tryBindVariation(g,ne))return{value:void 0};var N=M.unbracket(g.getString());if(g.matchObject=_.find(ne.context.getAllSimpleColRefsInScope(),function(l){return Oe(l.name,N)}))return{value:void 0};if(g.matchObject=_.find(f.measures,function(l){return Oe(l.name,N)}))return{value:void 0};break;case 49:case 50:return g.matchObject=new G.Z0(g.getString()),{value:void 0}}},d=this,E=0,S=O;E<S.length;E++){var K=m(S[E]);if("object"==typeof K)return K.value}},M.prototype.tryBindMultiAxisReference=function(g,O){var f=g.getString();return!!(g.matchObject=O.context.matchObjects.findAxis(f))&&(g.matchObject=new G.cr(f),!0)},M.prototype.tryBindMultiEnumValue=function(g,O){var f=g.getString();return!!O.isValidEnumValue&&(g.matchObject=new G.it(f,void 0),!0)},M.prototype.doParse=function(g,O,f,m,d,E){if(void 0===f&&(f=0),void 0===m&&(m=void 0),void 0===d&&(d=void 0),void 0===E&&(E=void 0),O!==this.context&&(this.context=O,this.clearParseState()),g===this.tokenization.expression&&f===this.tokenization.cursorActivity&&m===this.tokenization.cursorPosition&&d===this.tokenization.selectionStart)return E&&(E.tokensMatch=!0),!1;var S=(0,Pe.w)(g,f,m,d,this.tokenization,!0,this.penultimateTokenization);return this._parseTree.update(S),this.hasInvalidatedQueries()&&this.doQueryInvalidations(O,S),this.bindTokens(S,O.matchObjects),E&&(E.tokensMatch=S.tokens.length===this.tokenization.tokens.length&&_.isEqual(_.map(S.tokens,function(F){return F.type}),_.map(this.tokenization.tokens,function(F){return F.type}))),this.penultimateTokenization=this.tokenization,this.tokenization=S,!0},M.prototype.hasInvalidatedQueries=function(){var g=(0,Y.as)(this._parseTree.rootNode,D.Vu);if(g)return g.isInvalidated;if(this._parseTree.rootNode instanceof D._7)for(var f=0,m=this._parseTree.rootNode.queries;f<m.length;f++)if(m[f].isInvalidated)return!0;return!1},M.prototype.doQueryInvalidations=function(g,O){this._parseTree.clearAllContexts(),O.tokens.forEach(function(f){return f.matchObject=void 0}),g.matchObjects.clearDefinedMeasures(),g.matchObjects.clearDefinedVariables()},M.prototype.buildParseTree=function(g,O,f,m){void 0===O&&(O=0),void 0===f&&(f=void 0),void 0===m&&(m=void 0),this.context=void 0,this.clearParseState();var d=(0,Pe.w)(g,O,f,m,this.tokenization,!0,this.penultimateTokenization);return this._parseTree.update(d),this._parseTree},M.prototype.parse=function(g,O,f,m,d,E,S){if(0===O)f=void 0,m=void 0;else{if(null==f)throw new Error("cursorPosition is null");if(null==m)throw new Error("selectionStart is null")}if(this.doParse(g,d,O,f,m,S))try{E.result=M.getResult(this.tokenization,this._parseTree)}catch(F){throw F.DaxParserTokenList="["+_.map(this.tokenization.tokens,function(K){return K.type}).join()+"]",F}},M.prototype.tryParse=function(g,O,f,m,d,E,S){if(void 0===f&&(f=void 0),void 0===m&&(m=void 0),void 0===d&&(d=0),void 0===E&&(E=void 0),void 0===S&&(S=void 0),0===d)E=void 0,S=void 0;else{if(null==E)throw new Error("cursorPosition is null");if(null==S)throw new Error("selectionStart is null")}if(this.doParse(g,O,d,E,S)){if(!f)return!0;try{return f.result=M.getResult(this.tokenization,this._parseTree,m),!0}catch(F){throw F.DaxParserTokenList="["+_.map(this.tokenization.tokens,function(K){return K.type}).join()+"]",F}}return!1},M.prototype.getDescription=function(g){for(var O=0,f=this.tokenization.tokens;O<f.length;O++){var m=f[O];if(m.matchObject&&m.startPosition<=g&&m.endPosition>=g)return m.matchObject.description}},M.prototype.getMeasureReferences=function(g,O,f){if(this.clearParseState(),!this.doParse(g,O))return f.unrecognizedMeasures=!0,[];var m={};f.unrecognizedMeasures=!1;for(var d=0;d<this.tokenization.tokens.length;d++){var E=this.tokenization.tokens[d],S=(0,Y.as)(E.matchObject,G.Cf);if(S)m[S.name]=S;else if(34===E.type){var F=this._parseTree.getValidLeafNodesAtPosition(d);_.every(F,function(K){return M.isUnrecognizedIdentifier(K)})&&(f.unrecognizedMeasures=!0)}}return _.values(m)},M.prototype.renameReferences=function(g,O,f,m,d){if(this.clearParseState(),!this.doParse(O,f))return O;for(var E="",S=0,F=this.tokenization.tokens;S<F.length;S++){var K=F[S],ee=void 0;switch(g){case"column":ee=(0,Y.as)(K.matchObject,G.XN);break;case"measure":ee=(0,Y.as)(K.matchObject,G.Cf);break;case"table":ee=(0,Y.as)(K.matchObject,G.S2)}ee&&Y.uI.equalIgnoreCase(ee.name,m)?E+=M.delimitIdentifier(K.type,d,f):E+=K.getString()}return E},M.prototype.renameMovedMeasureTableReference=function(g,O,f,m,d){if(this.clearParseState(),!this.doParse(g,O))return g;for(var E=0,S=0;S<this.tokenization.tokens.length;S++){var K=(0,Y.as)(this.tokenization.tokens[S].matchObject,G.Cf);if(K&&Y.uI.equalIgnoreCase(K.name,f))for(var ne=0,se=this._parseTree.getValidLeafNodesAtPosition(S);ne<se.length;ne++){var be=(0,Y.as)(se[ne].parent,D.DH);if(be){var Ce=be.tableRefNode.tableNode.token,Re=Ce.getSegment(),N=M.delimitIdentifier(Ce.type,d,O);g=g.substr(0,E+Re.startPosition)+N+g.substr(E+Re.startPosition+Re.length),E+=N.length-Re.length;break}}}return g},M.prototype.finalParse=function(g,O,f,m){if(void 0===m&&(m=Me.LegacyDefaultBehavior),this.doParse(g,O),f.finalResult=new X.s,this._parseTree.anyErrors)f.finalResult.valid=!1;else{var d={expression:g},E=this._parseTree.tryAddClosingParens(!!(m&Me.AddMissingParens),d);f.finalResult.valid=E.result,g=d.expression,f.finalResult.cParensNeeded=E.countParensAdded}m&Me.ConvertToEngine&&(g=M.convertFormatCore(g,this.tokenization,!1)),f.finalResult.updatedExpression=g,m&Me.Anonymize&&(f.finalResult.anonymizedExpression=k.buildAnonymousExpression(this.tokenization,O,M.delimitIdentifier)),this.clearParseState()},M.prototype.clearParseState=function(){var O,g=this;switch(this.penultimateTokenization=void 0,this.tokenization=new W.h("",0),this.options&xe.MaskExpressionType){case xe.Query:O=function(){return new D.Vu(void 0,g.context)};break;case xe.Expression:O=function(){return new D.HV(void 0,g.context)};break;case xe.MultipleQueries:O=function(){return new D._7(void 0,g.context)};break;default:(0,I.sr)("Unknown expression type in option value: "+JSON.stringify(this.options)),O=function(){return new D.HV(void 0,g.context)}}this._parseTree=new oe(this.context,O)},Object.defineProperty(M,"listSeparator",{get:function(){return ve.ft().listSeparator},enumerable:!1,configurable:!0}),Object.defineProperty(M,"decimalSeparator",{get:function(){return ve.ft().numberDecimalSeparator},enumerable:!1,configurable:!0}),M.quoteIfNeeded=function(g,O){return M.quoteNeeded(g,O)?M.quote(g):g},M.quoteNeeded=function(g,O){return Y.LP.quoteNeeded(g,O instanceof G.hK?O:function(){return H.M.isReservedWord(g,O)})},M.quote=function(g){return M.quotePartial(g)+"'"},M.quotePartial=function(g){return"'"+g.replace(/'/g,"''")},M.unquote=function(g){return M.unquotePartial(g.substr(0,g.length-1))},M.unquotePartial=function(g){return g.substr(1).replace(/''/g,"'")},M.DoubleQuote=function(g){return'"'.concat(g.replace(/"/g,'""'),'"')},M.unDoubleQuote=function(g){return g.substr(1,g.length-2).replace(/""/g,'"')},M.bracket=function(g){return M.bracketPartial(g)+"]"},M.bracketPartial=function(g){return"["+g.replace(/\]/g,"]]")},M.delimitIdentifier=function(g,O,f){return M.delimitIdentifierInternal(g,O,function(){return M.quoteIfNeeded(O,f)})},M.delimitIdentifierInternal=function(g,O,f){switch(g){case 32:return M.quote(O);case 33:return M.quotePartial(O);case 34:return M.bracket(O);case 35:return M.bracketPartial(O);default:return(0,I.hu)(58===g,"expected identifier type"),f()}},M.unbracket=function(g){return M.unbracketPartial(g.substr(0,g.length-1))},M.unbracketPartial=function(g){return g.substr(1).replace(/\]\]/g,"]")},M.isFormulaTranslationNeeded=function(){return"."!==M.decimalSeparator||","!==M.listSeparator},M.convertFormat=function(g,O){return M.convertFormatCore(g,void 0,O)},M.convertFormatCore=function(g,O,f){var m=","!==M.listSeparator,d="."!==M.decimalSeparator,S=!f&&-1!==g.indexOf("\xa0");if(m||d||S){var F="";O||(O=(0,Pe.w)(g,0,void 0,void 0,void 0,!f));var K=void 0,ee=void 0,ne=void 0;f?(K=M.listSeparator,ee=".",ne=M.decimalSeparator):(K=",",ee=M.decimalSeparator,ne=".");for(var se=0,de=0,be=O.tokens;de<be.length;de++){var Ce=be[de],Re=Ce.getString(),N=Re;switch(Ce.offsetPosition(se),Ce.type){case 27:m&&(N=K);break;case 36:d&&(N=Re.replace(ee,ne));break;case 29:S&&(N=Re.replace("\xa0"," "))}se+=N.length-Re.length,F+=N}g=F,O.tokens.forEach(function(l){return l.attachToNewExpression(g)})}return g},M.convertToUI=function(g){return M.convertFormat(g,!0)},M.convertToEngine=function(g){return M.convertFormat(g,!1)},M}();function Oe(M,g){return Y.uI.equalIgnoreCase(M,g)}},40546:function(Ke,Ie,T){T.d(Ie,{d:function(){return I}});var x=T(81337),I=function(){function G(){}return Object.defineProperty(G,"featureSwitches",{get:function(){return G._featureSwitches},enumerable:!1,configurable:!0}),G.setFeatureSwitches=function(Y){G._featureSwitches=(0,x.pi)((0,x.pi)({},this._featureSwitches),Y)},G._featureSwitches={useSkippableParams:!1,suggestKeywords:!0,includeUndefinedOptionalFunctionParameters:!1,resetSuggestWidgetStateBeforeCompletion:!0,addTriviaToParseNodeMetadata:!0,useParseTreeFormatting:!1,customCalendars:!1},G}()},95792:function(Ke,Ie,T){T.d(Ie,{BY:function(){return Fe},Gz:function(){return Pe},K2:function(){return le},Mk:function(){return pe},Mn:function(){return te},O5:function(){return ve},Sm:function(){return Me},kD:function(){return ye},ub:function(){return xe}});var x=T(3371),I=T(58871),G=T(68706),Y=T(42165),k=T(74104),R=T(63513),X=/=|:=/,re=new RegExp("^"+k.co+"$"),q=new RegExp("^"+k.jZ),Q=new RegExp("^:$"),i=["]","["],W=/\t|\n|\r/g,C=[" ","\t","\n","\r"],oe=[" ","\t"];function ve(ie,M){return B(ie,!1,M)}function B(ie,M,g,O){var f={name:null,formula:null,formulaStart:-1,errors:[]};try{var m=R.uI.trimStart(ie=ie||"",C),d=me(m,re);if(d&&d[0].length===m.length)return f.name=g?d[0]:R.LP.unbracketPartial(d[0]),f;var E=me(m,q);E&&(f.name=g?E[0]:R.LP.unbracket(E[0]),m=R.uI.trimStart(m.substr(E[0].length),C));var S=X.exec(m);if(null==S&&O)return f.name="",f.formula=M?R.uI.trimStart(ie,oe):ie,f.formulaStart=0,f;var F=R.uI.trimEnd(S?m.substr(0,S.index):m,C);if(null==f.name){var K=R.uI.indexOfAny(F,i);if(-1===K)f.name=F;else{f.name=F.substr(0,K);var ee=ie.length-m.length;do{f.errors.push(new G.D(new Y.X(ie,ee+K,1),G.j.InvalidNameCharacter)),K=R.uI.indexOfAny(F,i,K+1)}while(-1!==K)}}else if(!R.uI.isNullOrEmpty(F)){var ne=me(F,Q);!S&&ne&&ne[0].length===F.length||f.errors.push(new G.D(new Y.X(ie,ie.length-m.length,F.length),G.j.CantSeparateFormulaNameAndExpression))}if(!S)return f;m=m.substr(S.index+S[0].length),M&&(m=R.uI.trimStart(m,oe)),f.formula=m,f.formulaStart=ie.length-m.length}finally{f.name=f.name.replace(W,"")}return f}function te(ie,M,g){var O=function(ie,M){var g=B(ie,!0,!1,M),O={name:g.name,formula:g.formula,invalidFormula:void 0};return g.errors.length>0||null==g.formula?(O.formula="",O.invalidFormula=ie):O.invalidFormula=null,O}(ie,g);return M.name=O.name,M.expression=O.formula,null==O.invalidFormula}function pe(ie,M){return function(ie){return R.uI.trim(ie,C)!==ie||-1!==R.uI.indexOfAny(ie,i)||!!X.exec(ie)}(ie)&&(ie=R.LP.bracket(ie)),"".concat(ie," = ").concat(M)}function le(ie,M,g,O){var f={matchObjects:null};x.M.populateAll(ie,M,f);var m=f.matchObjects;O&&m.chooseFunctions(function(F){return R.G.hasFlag(F.pushableToDirectQuery,1)});var d=new I.hK(m),E=m.findTable(g.table.name);E&&(d.currentTable=E.uberTable);var S=new I.hK(d,!1);return S.currentTable=null,S}function ye(ie,M,g,O){var f={matchObjects:null};x.M.populateAll(ie,M,f);var m=f.matchObjects;O&&m.chooseFunctions(function(K){return R.G.hasFlag(K.pushableToDirectQuery,1)});var d=new I.hK(m),E=m.findTable(g.table.name);if(E){var S=E.findMeasure(g.name);S&&(m.hideMeasure(S),E.hideMeasure(S)),d.currentTable=E.uberTable}var F=new I.hK(d,!1);return F.currentTable=null,F}function Pe(ie,M,g,O){var f={matchObjects:null};x.M.populateAll(ie,M,f);var m=f.matchObjects;O&&m.chooseFunctions(function(F){return R.G.hasFlag(F.pushableToDirectQuery,2)});var d=new I.hK(f.matchObjects),E=m.findTable(g.table.name);if(E){var S=E.findColumn(g.name);S&&(m.hideColumn(S),E.hideColumn(S)),d.currentTable=E.uberTable}return d}function Me(ie,M,g){var O={matchObjects:null};x.M.populateAll(ie,M,O);var f=O.matchObjects,m=new I.hK(f),d=f.findTable(g.name);return d&&(m.currentTable=d.uberTable),m}function xe(ie,M,g){var O={matchObjects:null};x.M.populateAll(ie,M,O);var f=O.matchObjects,m=new I.hK(f);m.ephemeralContexts.push(new I.xE(m,null,{type:2},null));var d=f.findTable(g.name);return d&&f.hideTable(d),m}function Fe(ie,M){var g={matchObjects:null};return x.M.populateAll(ie,M,g),new I.hK(g.matchObjects)}function me(ie,M){var g=M.exec(ie);if(g&&0===g.index)return g}},20540:function(Ke,Ie,T){T.d(Ie,{R:function(){return x}});var x=function(I){return I[I.Yum=0]="Yum",I[I.NotHungry=1]="NotHungry",I[I.Yuck=2]="Yuck",I}({})},79232:function(Ke,Ie,T){T.d(Ie,{A3:function(){return ee},AP:function(){return ne},Bw:function(){return b},E8:function(){return m},EF:function(){return F},Ex:function(){return g},FY:function(){return Q},Ht:function(){return d},JQ:function(){return D},M0:function(){return ve},M5:function(){return Pe},ME:function(){return f},NB:function(){return pe},Nw:function(){return le},PH:function(){return q},PY:function(){return i},S7:function(){return E},Sx:function(){return oe},T8:function(){return xe},TG:function(){return C},UE:function(){return Re},Wt:function(){return H},Ym:function(){return U},ZO:function(){return me},ZQ:function(){return ye},_H:function(){return ie},aN:function(){return X},bM:function(){return Oe},dG:function(){return O},mO:function(){return K},qo:function(){return S},sC:function(){return Fe},sW:function(){return Me},tR:function(){return M},w1:function(){return re},wV:function(){return B},zA:function(){return te}});var x=T(81337),I=T(55863),G=T(58871),Y=T(63513),k=function(){function N(){}return N.prototype.toTraceString=function(){return this.toString(!0)},N.prototype.toString=function(l){void 0===l&&(l=!1);try{var a=new Re(l);return this.accept(a)}catch(u){if(l)return u.ToString()}},N.Comparer={equals:function(a,u){return a.toLowerCase()===u.toLowerCase()}},N}(),R=function(N){function l(a,u){var v=N.call(this)||this;return v.left=a,v.right=u,(0,I.mv)(a,"left expression should not be null"),(0,I.mv)(u,"right expression should not be null"),v}return(0,x.ZT)(l,N),l.prototype.equals=function(a){return null!=a&&a instanceof l&&this.left.equals(a.left)&&this.right.equals(a.right)&&this.equalsCore(a)},l}(k),U=function(N){function l(a,u,v){var A=N.call(this,u,v)||this;return A.comparison=a,A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitComparison(this,u)},l.prototype.equalsCore=function(a){return a instanceof l&&this.comparison===a.comparison},l}(R),H=function(N){function l(a,u,v){var A=N.call(this,u,v)||this;return A.operator=a,A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitLogicalOperation(this,u)},l.prototype.equalsCore=function(a){return a instanceof l&&this.operator===a.operator},l}(R),X=function(N){function l(a,u,v){var A=N.call(this,u,v)||this;return A.operation=a,A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitArithmetic(this,u)},l.prototype.equalsCore=function(a){return a instanceof l&&this.operation===a.operation},l}(R),D=function(N){function l(a){var u=N.call(this)||this;return u.value=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitDateTimeLiteral(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.value===a.value},l}(k),re=function(N){function l(a,u){var v=N.call(this)||this;return v.value=a,v.type=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitConstantScalar(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.value===a.value&&this.type===a.type},l}(k),q=function(N){function l(a){var u=N.call(this)||this;return u.expression=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitNot(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.expression.equals(a.expression)},l}(k),Q=function(N){function l(a){var u=N.call(this)||this;return u.expression=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitNegation(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.expression.equals(a.expression)},l}(k),i=function(N){function l(a){for(var u=[],v=1;v<arguments.length;v++)u[v-1]=arguments[v];var A=N.call(this)||this;return A.functionName=a,A.parameters=u,A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitFunction(this,u)},l.prototype.equals=function(a){if(!(a instanceof l&&k.Comparer.equals(this.functionName,a.functionName)&&this.parameters.length===a.parameters.length))return!1;for(var u=0;u<this.parameters.length;u++)if(!this.parameters[u].equals(a.parameters[u]))return!1;return!0},l}(k),W=function(N){function l(a){var u=N.call(this)||this;return u.tableName=a,u}return(0,x.ZT)(l,N),l}(k),C=function(N){function l(a){var u=N.call(this,a)||this;return u.tableName=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitTableReference(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.tableName,a.tableName)},l}(W),oe=function(N){function l(a,u){var v=N.call(this,a)||this;return v.tableName=a,v.propertyName=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitColumnReference(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.tableName,a.tableName)&&k.Comparer.equals(this.propertyName,a.propertyName)},l}(W),ve=function(N){function l(a,u){var v=N.call(this,a)||this;return v.propertyName=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitMeasureReference(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.tableName,a.tableName)&&k.Comparer.equals(this.propertyName,a.propertyName)},l}(W),B=function(N){function l(a,u){return N.call(this,a,u)||this}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitTextConcatenation(this,u)},l.prototype.equalsCore=function(a){return a instanceof l},l}(R),b=function(N){function l(a,u){return N.call(this,a,u)||this}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitIn(this,u)},l.prototype.equalsCore=function(a){return a instanceof l},l}(R),te=function(N){function l(a){var u=N.call(this)||this;return u.items=a,(0,I.mv)(u.items,"items should not be null"),u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitRowConstructor(this,u)},l.prototype.equals=function(a){if(!(a instanceof l)||this.items.length!==a.items.length)return!1;for(var u=0;u<this.items.length;u++)if(!this.items[u].equals(a.items[u]))return!1;return!0},l}(k),pe=function(N){function l(a){var u=N.call(this)||this;return u.rows=a,(0,I.mv)(u.rows,"rows should not be null"),u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitTableConstructor(this,u)},l.prototype.equals=function(a){if(!(a instanceof l)||this.rows.length!==a.rows.length)return!1;for(var u=0;u<this.rows.length;u++)if(!this.rows[u].equals(a.rows[u]))return!1;return!0},l.empty=new l([]),l}(k),le=function(N){function l(a,u){var v=N.call(this)||this;return v.name=a,v.definition=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitMeasureExpression(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.name.equals(a.name)&&this.definition.equals(a.definition)},l}(k),ye=function(N){return N.Asc="ASC",N.Desc="DESC",N.True="TRUE",N.False="FALSE",N}({}),Pe=function(N){function l(a){var u=N.call(this)||this;return u.value=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitKeyword(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.value===a.value},l.Asc=new l(ye.Asc),l.Desc=new l(ye.Desc),l.True=new l(ye.True),l.False=new l(ye.False),l}(k),Me=function(N){function l(a){var u=N.call(this)||this;return u.axis=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitAxis(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.axis===a.axis},l}(k),xe=function(N){function l(a){var u=N.call(this)||this;return u.expressions=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitMultiIdentifier(this,u)},l.prototype.equals=function(a){if(!(a instanceof l)||this.expressions.length!==a.expressions.length)return!1;for(var u=this.expressions.length,v=0;v<u;v++)if(!this.expressions[v].equals(a.expressions[v]))return!1;return!0},l}(k),Fe=function(N){function l(a){var u=N.call(this)||this;return u.value=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitEnum(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.value===a.value},l}(k),me=function(N){function l(){return N.call(this)||this}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitOmittedArgument(this,u)},l.prototype.equals=function(a){return this===a},l.instance=new l,l}(k),Oe=function(N){function l(a){var u=N.call(this)||this;return(0,I.mv)(a,"nodeOrExpressionText should be defined"),u.expressionText=a instanceof G.$Y?a.fullSpan.text:a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitUnknown(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.expressionText,a.expressionText)},l}(k),ie=function(N){function l(a,u){var v=N.call(this)||this;return v.name=a,v.definition=u,(0,I.hu)(!Y.uI.isNullOrEmpty(a),"name should not be null or empty"),(0,I.mv)(u,"definition should not be null"),v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitVariableDefinition(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.name,a.name)&&this.definition.equals(a.definition)},l}(k),M=function(N){function l(a,u){var v=N.call(this)||this;return v.variables=a,v.returnExpression=u,(0,I.mv)(a,"variables should not be null"),(0,I.mv)(u,"returnExpression should not be null"),v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitVarReturn(this,u)},l.prototype.equals=function(a){if(!(a instanceof l&&this.variables.length===a.variables.length&&this.returnExpression.equals(a.returnExpression)))return!1;for(var u=0;u<this.variables.length;u++)if(!this.variables[u].equals(a.variables[u]))return!1;return!0},l}(k),g=function(N){function l(a){var u=N.call(this)||this;return u.name=a,(0,I.hu)(!Y.uI.isNullOrEmpty(a),"name should not be null or empty"),u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitVariableReference(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.name,a.name)},l}(k),O=function(N){function l(a,u,v){var A=N.call(this)||this;return A.tableName=a,A.variationSourceName=u,A.targetPropertyName=v,(0,I.mv)(u,"variationSourceName should not be null"),(0,I.mv)(v,"targetPropertyName should not be null"),A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitVariationColumnReference(this,u)},l.prototype.equals=function(a){return a instanceof l&&k.Comparer.equals(this.tableName,a.tableName)&&k.Comparer.equals(this.variationSourceName,a.variationSourceName)&&k.Comparer.equals(this.targetPropertyName,a.targetPropertyName)},l}(k),f=function(N){function l(a){var u=N.call(this)||this;return u.values=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitStartAt(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.values.length===a.values.length&&this.values.every(function(u,v){return u.equals(a.values[v])})},l}(k),m=function(N){function l(a,u){var v=N.call(this)||this;return v.clause=a,v.direction=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitSort(this,u)},l.prototype.equals=function(a){return!!(a instanceof l&&this.clause.equals(a.clause))&&(!this.direction||!!a.direction&&this.direction.equals(a.direction))},l}(k),d=function(N){function l(a,u){var v=N.call(this)||this;return v.sortClauses=a,v.startAt=u,v}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitOrderBy(this,u)},l.prototype.equals=function(a){if(!(a instanceof l)||this.sortClauses.length!==a.sortClauses.length)return!1;for(var u=0;u<this.sortClauses.length;u++)if(!this.sortClauses[u].equals(a.sortClauses[u]))return!1;return!this.startAt||!!a.startAt&&this.startAt.equals(a.startAt)},l}(k),E=function(N){function l(a,u,v){var A=N.call(this)||this;return A.definitions=a,A.evaluate=u,A.orderBy=v,A}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitQuery(this,u)},l.prototype.equals=function(a){var u,v;if(!(a instanceof l)||(null===(u=this.definitions)||void 0===u?void 0:u.length)!==(null===(v=a.definitions)||void 0===v?void 0:v.length))return!1;for(var A=0;A<this.definitions.length;A++)if(!this.definitions[A].equals(a.definitions[A]))return!1;return!!this.evaluate.equals(a.evaluate)&&(!this.orderBy||!!a.orderBy&&this.orderBy.equals(a.orderBy))},l}(k),S=function(N){function l(a){var u=N.call(this)||this;return u.queries=a,u}return(0,x.ZT)(l,N),l.prototype.accept=function(a,u){return a.visitQueries(this,u)},l.prototype.equals=function(a){return a instanceof l&&this.queries.length===a.queries.length&&this.queries.every(function(u,v){return u.equals(a.queries[v])})},l}(k),F=function(N){return N[N.Add=0]="Add",N[N.Subtract=1]="Subtract",N[N.Multiply=2]="Multiply",N[N.Divide=3]="Divide",N[N.Power=4]="Power",N}({}),K=function(N){return N[N.EqualTo=0]="EqualTo",N[N.StrictEqualTo=1]="StrictEqualTo",N[N.GreaterThan=2]="GreaterThan",N[N.LessThan=3]="LessThan",N[N.GreaterThanEqualTo=4]="GreaterThanEqualTo",N[N.LessThanEqualTo=5]="LessThanEqualTo",N[N.NotEqualTo=6]="NotEqualTo",N}({}),ee=function(N){return N[N.And=0]="And",N[N.Or=1]="Or",N}({}),ne=function(N){return N[N.String=0]="String",N[N.Number=1]="Number",N}({});function be(N){switch(N){case ne.Number:return"Number";case ne.String:return"String"}return(0,I.vE)("uexpected ConstantDataType ".concat(N))}var Re=function(){function N(l){this.traceString=l}return N.prototype.visitStartAt=function(l,a){var u=this,v="";return l.values.length>0&&(v="START AT ",v+=l.values.map(function(A){return A.accept(u,a)}).join(", ")),v},N.prototype.visitSort=function(l,a){return"".concat(l.clause.accept(this,a)).concat(l.direction?" "+l.direction.accept(this,a):"")},N.prototype.visitOrderBy=function(l,a){var u=this,v="";return l.sortClauses.length>0&&(v="ORDER BY\n",v+="    "+l.sortClauses.map(function(A){return A.accept(u,a)}).join(", "),l.startAt&&(v+="\n"+l.startAt.accept(this,a))),v},N.prototype.visitMeasureExpression=function(l,a){return"MEASURE ".concat(l.name," = ").concat(l.definition.accept(this,a))},N.prototype.visitVariableDefinition=function(l,a){return"VAR ".concat(l.name," = ").concat(l.definition.accept(this,a))},N.prototype.visitQuery=function(l,a){var u=this,v="";l.definitions.length>0&&(v="DEFINE\n",v+=l.definitions.map(function(he){return"    "+he.accept(u,a)}).join("\n"),v+="\n");var A="EVALUATE ".concat(l.evaluate.accept(this,a),"\n"),Z=l.orderBy?"".concat(l.orderBy.accept(this,a),"\n"):"";return"".concat(v).concat(A).concat(Z)},N.prototype.visitQueries=function(l,a){var u=this;return l.queries.map(function(v){return v.accept(u,a)}).join("\n\n")},N.prototype.visitAxis=function(l,a){return l.axis},N.prototype.visitMultiIdentifier=function(l,a){for(var u="",v=0,A=l.expressions;v<A.length;v++)u+=this.visitExpression(A[v]);return u},N.prototype.visitEnum=function(l,a){return l.value},N.prototype.visitArithmetic=function(l){return this.visitBinaryExpression(l,function(N){switch(N){case F.Add:return"+";case F.Divide:return"/";case F.Multiply:return"*";case F.Power:return"^";case F.Subtract:return"-"}return(0,I.vE)("unexpected operator ".concat(N))}(l.operation))},N.prototype.visitConstantScalar=function(l){if(this.traceString)return"{".concat(be(l.type),"}");switch(l.type){case ne.String:return Y.LP.doubleQuote(l.value);case ne.Number:return l.value;default:(0,I.sr)("Unsupported node of type ".concat(be(l.type)))}},N.prototype.visitDateTimeLiteral=function(l,a){return l.value},N.prototype.visitComparison=function(l){return this.visitBinaryExpression(l,function(N){switch(N){case K.EqualTo:return"=";case K.StrictEqualTo:return"==";case K.NotEqualTo:return"<>";case K.GreaterThan:return">";case K.GreaterThanEqualTo:return">=";case K.LessThan:return"<";case K.LessThanEqualTo:return"<="}return(0,I.vE)("unexpected comparison operator ".concat(N))}(l.comparison))},N.prototype.visitNegation=function(l){return"-".concat(this.visitExpression(l.expression))},N.prototype.visitNot=function(l){return"NOT(".concat(l.expression.toString(this.traceString),")")},N.prototype.visitFunction=function(l){var a=this,u=l.parameters.map(function(v){return a.visitExpression(v)}).join(", ");return"".concat(l.functionName,"(").concat(u,")")},N.prototype.visitTableReference=function(l){return this.traceString?"Table":Y.LP.quote(l.tableName)},N.prototype.visitColumnReference=function(l){return this.traceString?"Table[Column]":"".concat(Y.LP.quote(l.tableName)).concat(Y.LP.bracket(l.propertyName))},N.prototype.visitMeasureReference=function(l){return this.traceString?"[Measure]":"".concat(Y.LP.quote(l.tableName)).concat(Y.LP.bracket(l.propertyName))},N.prototype.visitLogicalOperation=function(l){return this.visitBinaryExpression(l,function(N){switch(N){case ee.And:return"&&";case ee.Or:return"||"}return(0,I.vE)("unexpected logical operator ".concat(N))}(l.operator))},N.prototype.visitIn=function(l){return this.visitBinaryExpression(l,"IN")},N.prototype.visitTextConcatenation=function(l){return this.visitBinaryExpression(l,"&")},N.prototype.visitRowConstructor=function(l){var a=this,u=l.items.map(function(v){return v.toString(a.traceString)}).join(", ");return"(".concat(u,")")},N.prototype.visitTableConstructor=function(l){var a=this,u=l.rows.map(function(v){return v.toString(a.traceString)}).join(", ");return"{".concat(u,"}")},N.prototype.visitKeyword=function(l){return l.value.toString().toUpperCase()},N.prototype.visitOmittedArgument=function(l){return""},N.prototype.visitUnknown=function(l){return this.traceString?"{Unknown}":l.expressionText},N.prototype.visitVarReturn=function(l){var a=this,u=l.variables.map(function(v){return"VAR ".concat(a.traceString?"__X":v.name," = ").concat(a.visitExpression(v.definition))}).join(" ");return"".concat(u," RETURN ").concat(this.visitExpression(l.returnExpression))},N.prototype.visitVariableReference=function(l){return this.traceString?"__X":l.name},N.prototype.visitVariationColumnReference=function(l){return this.traceString?"Table[VariationSource].[Column]":"".concat(Y.LP.quote(l.tableName)).concat(Y.LP.bracket(l.variationSourceName),".").concat(Y.LP.bracket(l.targetPropertyName))},N.prototype.visitBinaryExpression=function(l,a){var u=this.getExpressionType(l),v=this.getExpressionType(l.left),A=this.getExpressionType(l.right),Z=!1,he=!1;0===v&&(Z=!0),0===A&&(he=!0);var ue=this.getPrecedence(u);if(Z||13===v||ue<this.getPrecedence(v)&&(Z=!0),!he&&13!==A){var ge=this.getPrecedence(A);(ue<ge||ue===ge&&!this.canCombine(u,A))&&(he=!0)}return"".concat(this.visitExpression(l.left,Z)," ").concat(a," ").concat(this.visitExpression(l.right,he))},N.prototype.visitExpression=function(l,a){void 0===a&&(a=!1);var u="";return a&&(u+="("),u+=l.accept(this),a&&(u+=")"),u},N.prototype.getPrecedence=function(l){switch(l){case 1:return 0;case 2:return 1;case 3:case 4:return 2;case 6:case 7:return 3;case 8:return 4;case 12:case 9:return 5;case 5:return 6;case 10:return 7;case 11:return 8;default:(0,I.vE)("Unsuppored expression type ".concat(l))}},N.prototype.getExpressionType=function(l){if(l instanceof Oe)return 0;if(l instanceof Q)return 2;if(l instanceof q)return 5;if(l instanceof B)return 8;if(l instanceof b)return 12;if(l instanceof X)switch(l.operation){case F.Power:return 1;case F.Multiply:return 3;case F.Divide:return 4;case F.Add:return 6;case F.Subtract:return 7;default:(0,I.vE)("Unsupported arithmetic operation ".concat(l.operation))}if(l instanceof U)return 9;if(l instanceof H)switch(l.operator){case ee.And:return 10;case ee.Or:return 11;default:(0,I.vE)("Unsupported binary logical operator ".concat(l.operator))}return 13},N.prototype.canCombine=function(l,a){return 6===l&&6===a||3===l&&3===a||10===l&&10===a||11===l&&11===a},N}()},98277:function(Ke,Ie,T){T.d(Ie,{r:function(){return H}});var H,x=T(81337),I=T(55863),G=T(40546),Y=T(58871),k=T(85616),R=T(79232),U=T(59458);!function(oe){var ve;function b(f){var m=f,d=function(f){for(;null!=f&&1===f.children.length&&f instanceof k._L;){if(!(f.isComplete&&f.children[0]instanceof Y.sN)){f=void 0;break}f=f.children[0]}return f}(m);if(null==d)return new R.bM(m);if(1===m.children.length&&m instanceof k.q1){if(m.valid){var S=m.children[0];return S.valid?S instanceof k._L||S instanceof k.q1?b(S):te(S):new R.bM(d)}return new R.bM(d)}if(null!=d&&d instanceof k.ze){for(var K=0,ee=d.children;K<ee.length;K++){var ne=ee[K];if(!(ne instanceof k._L)||ne.isComplete)return te(ne)}return new R.bM(d)}return te(d)}function te(f){if((0,U.hI)(ve)&&f instanceof k.Ti){if(f.children.length>=2){for(var m=!1,d=0;d<f.children.length-1;d++)44===f.children[0].token.type&&(m=!m);var S=b(f.children[f.children.length-1]);return m?new R.PH(S):S}return new R.bM(f)}if(f instanceof k.Hf)return R.M5.Asc;if(f instanceof k.QB)return R.M5.Desc;if(f instanceof k.a$){var F=f.children.length;if(F>=3){if(f instanceof k.gi||f instanceof k.RZ||f instanceof k.Ed)return pe(f.children,F-1,X);if((0,U.V0)(ve)&&f instanceof k.F0)return pe(f.children,F-1,D);if((0,U.Tk)(ve)&&f instanceof k.HV)return pe(f.children,F-1,re);if((0,U.pi)(ve)&&f instanceof k.IS)return pe(f.children,F-1,q)}return new R.bM(f)}if(f instanceof k.gR){if(f.children.length>=2){var K=1;for(d=0;d<f.children.length-1;d++)20===f.children[d].token.type&&(K*=-1);return Me(S=b(f.children[f.children.length-1]),K)}return new R.bM(f)}if(f instanceof k.U6)return 3===f.children.length?b(f.children[1]):new R.bM(f);if(f instanceof k.DU){if(f.children.length>=3){var ne=f.children[0].token.getString(),se=[];if(f.children[2]instanceof k.fA){var de=f.children[2];if(de.parameterCount>0){se=new Array(de.parameterCount);var Ce=G.d.featureSwitches.includeUndefinedOptionalFunctionParameters?de.allParametersIncludingUndefined:de.parameters;for(d=0;d<de.parameterCount;d++)se[d]=null!=Ce[d]?b(Ce[d]):R.ZO.instance}}return new(R.PY.bind.apply(R.PY,(0,x.ev)([void 0,ne],se,!1)))}return new R.bM(f)}if(f instanceof k.DH){var N=f;return N.qualifiedColumnRef?new R.Sx(N.qualifiedColumnRef.table.name,f.qualifiedColumnRef.name):N.bracketedIdentifier&&N.tableRefNode?g(N):new R.bM(f)}if(f instanceof k.Fc){var l=f.variationSource;if(null!=l&&null!=l.simpleColumnRef){var a=l.simpleColumnRef.table.name,u=l.simpleColumnRef.name;if(null!=f.qualifiedColumnRef)return new R.dG(a,u,f.qualifiedColumnRef.name);if(null!=f.simpleColumnRef)return new R.dG(a,u,f.simpleColumnRef.name)}return new R.bM(f)}if(f instanceof k.TV||f instanceof k.T0||f instanceof k.eV)return g(f);if(f instanceof k.qS)return function(f){for(var m=[],d=0,E=f.children;d<E.length;d++){var F=g(E[d]);F&&m.push(F)}return new R.T8(m)}(f);if(f instanceof k.uA)return new R.JQ(f.token.getString());if(f instanceof k.vX)return new R.w1(f.token.getString(),R.AP.Number);if(f instanceof k.XN)return new R.w1(f.string,R.AP.String);if((0,U.hI)(ve)&&f instanceof k.Cm)return function(f){var m=f.children.length;if(!f.isComplete||m<3||!(f.children[m-2]instanceof k.y3))return new R.bM(f);for(var d=new Array(m-2),E=0;E<m-2;E++){var S=f.children[E];if(null==S)return new R.bM(f);var F=ye(S);if(!F)return new R.bM(f);d[E]=F}return new R.tR(d,b(f.children[m-1]))}(f);if((0,U.A3)(ve)){if(f instanceof k._N)return f.children.length>=3&&f.children[1]instanceof k.N9?pe(f.children,f.children.length-1,Q):new R.bM(f);if(f instanceof k.tw){var v=f.children,A=[];for(d=1;d<v.length-1;d++)v[d]instanceof k.ZH||A.push(b(v[d]));return new R.zA(A)}if(f instanceof k.lg){var Z=function(f){var m=f.children,d=m.length;if(!(d<2)&&m[0]instanceof k.HI&&m[d-1]instanceof k.yE){if(2===d)return R.NB.empty;for(var E=[],S=1;S<d-1;S++)if(!(m[S]instanceof k.ZH)){var F=b(m[S]);E.push(F instanceof R.zA?F:new R.zA([F]))}return new R.NB(E)}}(f);return Z??new R.bM(f)}}if((0,U.XD)(ve)&&f instanceof k.mR&&1===f.children.length){var he=f.children[0];if(he instanceof k.Hf)return R.M5.Asc;if(he instanceof k.QB)return R.M5.Desc}if(f instanceof k.ZQ)return b(f.children[0]);if(f instanceof k.Lj){var ue=b(f.children[0]),Ee=void 0;return f.children[1]instanceof k.et&&(Ee=b(f.children[1])),new R.E8(ue,Ee)}return new R.bM(f)}function pe(f,m,d){if(m<0)return new R.bM(f[0]);if(0===m)return b(f[m]);var E=pe(f,m-2,d);return d(f[m-1],E,b(f[m]))}function ye(f){if(f.isComplete&&!(f.children.length<4)&&f.children[0]instanceof k.fY&&f.children[2]instanceof k.sB){var d=f.children[1];if(d instanceof k.TV){var E=d.token.matchObject;if(E instanceof Y.yB)return new R._H(E.name,b(f.children[3]))}}}function Me(f,m){return f instanceof R.FY?Me(f.expression,-1*m):m<0?new R.FY(f):f}function me(f){var m=f.children;if(f.isComplete&&!(m.length<4)&&m[0]instanceof k.gq&&m[1]instanceof k.ai&&m[2]instanceof k.sB&&m[3]instanceof k.ZQ){var E=g(m[1]),S=b(m[3]);return new R.Nw(E,S)}}function Oe(f){if(!f.isComplete)return new R.bM(f);var E,S,m=f.children,d=[],F=0;if(m[F]instanceof k.N4){for(var ee=0,ne=m[F].children;ee<ne.length;ee++){var se=ne[ee];if(se instanceof k.pZ){var de=me(se);if(!de)return new R.bM(f);d.push(de)}else if(se instanceof k.dl){var be=ye(se);if(!be)return new R.bM(f);d.push(be)}}F++}return m[F]instanceof k.yC&&m[++F]instanceof k.ZQ?(E=b(m[F]),m[++F]instanceof k.rc&&!(S=function(f){var m=f.children,d=m.length;if(!(d<3)){for(var F,E=[],S=2;S<d&&!(m[S]instanceof k.ic);)m[S]instanceof k.Lj&&E.push(b(m[S])),S++;if(!(m[S]instanceof k.ic)||(F=function(f){var m=f.children,d=m.length;if(!(d<3)&&m[0]instanceof k.Xg&&m[1]instanceof k.rL){for(var E=[],S=2;S<d;S++)m[S]instanceof k.ZH||E.push(b(m[S]));return new R.ME(E)}}(m[S]),F))return new R.Ht(E,F)}}(m[F]))?new R.bM(f):new R.S7(d,E,S)):new R.bM(f)}function g(f){var m=f instanceof k.DH?f.bracketedIdentifier:f;if(!(m instanceof Y.a9))return new R.bM(f);var d=m.token;if(d.matchObject instanceof Y.S2)return new R.TG(d.matchObject.name);if(d.matchObject instanceof Y.Cf)return new R.M0(d.matchObject.table.name,d.matchObject.name);if(d.matchObject instanceof Y.XN)return new R.Sx(d.matchObject.table.name,d.matchObject.name);if(d.matchObject instanceof Y.yB)return new R.Ex(d.matchObject.name);if(d.matchObject instanceof Y.Gs){if(d.matchObject.name===R.ZQ.True)return R.M5.True;if(d.matchObject.name===R.ZQ.False)return R.M5.False}if(d.matchObject instanceof Y.cr)return new R.sW(d.matchObject.name);if(d.matchObject instanceof Y.it)return new R.sC(d.matchObject.name);if(d.matchObject instanceof Y.Z0){if(d.matchObject.name===R.ZQ.Asc)return R.M5.Asc;if(d.matchObject.name===R.ZQ.Desc)return R.M5.Desc}return new R.bM(f)}oe.build=function(f,m){return ve=m,f instanceof k._7?function(f){if(!f.isComplete)return new R.bM(f);for(var m=[],d=0,E=f.children;d<E.length;d++){var S=E[d];if(!(S instanceof k.Vu))return new R.bM(S);var F=Oe(S);if(!(F instanceof R.S7))return new R.bM(S);m.push(F)}return new R.qo(m)}(f):b(f)}}(H||(H={}));var X=function(ve,B,b){return new R.aN(function(oe){if(oe instanceof Y.a9)switch(oe.token.type){case 21:return R.EF.Multiply;case 22:return R.EF.Divide;case 19:return R.EF.Add;case 20:return R.EF.Subtract;case 18:return R.EF.Power}return(0,I.vE)("Not a SingleTokenNode arithmetic Operator ".concat(JSON.stringify(oe)))}(ve),B,b)},D=function(ve,B,b){return new R.Ym(function(oe){if(oe instanceof Y.a9)switch(oe.token.type){case 15:return R.mO.LessThan;case 11:return R.mO.LessThanEqualTo;case 17:return R.mO.EqualTo;case 9:return R.mO.StrictEqualTo;case 12:return R.mO.GreaterThanEqualTo;case 16:return R.mO.GreaterThan;case 10:return R.mO.NotEqualTo}return(0,I.vE)("Not a SingleTokenNode ComparisonOperator ".concat(oe.token.type))}(ve),B,b)},re=function(ve,B,b){return new R.Wt(function(oe){switch(oe.token.type){case 13:return R.A3.And;case 14:return R.A3.Or}return(0,I.vE)("Not a SingleTokenNode LogicalOperator ".concat(oe.token.type))}(ve),B,b)},q=function(ve,B,b){return new R.wV(B,b)},Q=function(ve,B,b){return new R.Bw(B,b)}},59458:function(Ke,Ie,T){T.d(Ie,{A3:function(){return R},Tk:function(){return Y},V0:function(){return G},XD:function(){return U},hI:function(){return I},pi:function(){return k}});var x=T(63513);function I(X){return x.G.hasFlag(X,1)}function G(X){return x.G.hasFlag(X,2)}function Y(X){return x.G.hasFlag(X,4)}function k(X){return x.G.hasFlag(X,16)}function R(X){return x.G.hasFlag(X,8)}function U(X){return x.G.hasFlag(X,32)}},17819:function(Ke,Ie,T){T.d(Ie,{MQ:function(){return D.M},cr:function(){return H.cr},Df:function(){return H.Df},XN:function(){return H.XN},hK:function(){return H.hK},it:function(){return H.it},Gs:function(){return H.Gs},Z0:function(){return H.Z0},Cf:function(){return H.Cf},w_:function(){return x.w_},dH:function(){return C.d},S2:function(){return H.S2},yB:function(){return H.yB},MX:function(){return x.MX},ss:function(){return re.s},Hw:function(){return oe},bp:function(){return X.b},O5:function(){return f.O5},Gz:function(){return f.Gz},K2:function(){return f.K2},kD:function(){return f.kD},Sm:function(){return f.Sm},ub:function(){return f.ub},Mk:function(){return f.Mk},yD:function(){return pe},o4:function(){return le},g5:function(){return m.g5},Mn:function(){return f.Mn}});var x=T(11674);T(68706),T(98277),T(59458),T(79232);var H=T(58871),X=T(82269),D=T(3371),re=T(22021),q=T(81337),Q=T(55863),i=T(66106),W=T(63513),C=T(40546),oe=function(){return function(E,S,F,K,ee){this.name=E,this.optional=S,this.repeatable=F,this.repeatGroup=K,this.skippable=ee}}(),ve=function(){return function(E,S,F,K,ee,ne){this.name=E,this.description=S,this.category=F,this.pushableToDQ=K,this.parameters=ee,this.VisualCalculationsInfo=ne}}(),B=function(){return function(E,S,F){this.param=E,this.value=S,this.description=F}}(),b=function(){return function(E,S,F,K,ee){void 0===ee&&(ee=1023),this.name=E,this.role=S,this.signatureRole=F,this.enumValues=K,this.returnType=ee}}(),te=function(){function d(E,S,F){this._reservedWords={},this._functions=[],this._daxAxes=F?F.map(function(Ce){return new H.cr(Ce)}):[];for(var K=0,ee=E;K<ee.length;K++)this._reservedWords[ee[K].toUpperCase()]=!0;for(var se=0,de=S;se<de.length;se++){var be=de[se];("ROLLUPADDISSUBTOTAL"===be.name||"ROLLUPISSUBTOTAL"===be.name)&&4===be.parameters.length&&(be.parameters[0].skippable=!0,be.parameters[0].repeatGroup=1,be.parameters[0].repeatable=!0,be.parameters[1].repeatGroup=2,be.parameters[2].repeatGroup=2,be.parameters[3].repeatGroup=2,be.parameters[3].skippable=!0),this.addFunction(be)}this.ensureSpecialFunctions()}return Object.defineProperty(d.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"reservedWords",{get:function(){return this._reservedWords},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"fnCalculate",{get:function(){return this._fnCalculate},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"axes",{get:function(){return this._daxAxes},enumerable:!1,configurable:!0}),d.loadHardcodedCalculateSignature=function(){return new H.Gs(H.Gs.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME,"",4,3,1023,1,[[new H.td("expression",1023,!1,!1,0,i.Yl.None,!1,void 0),new H.td("filter",1023,!0,!0,0,i.Yl.Filter,!1,void 0)]])},d.prototype.addFunction=function(E){(0,Q.mv)(E.name,"functionDataFromEngine.name");var S=(0,q.ev)((0,q.ev)([],d.builtinFunctionData,!0),d.builtinVisualCalcFunctionData,!0);C.d.featureSwitches.customCalendars&&S.forEach(function(Ce){Ce.signatureRole[0]===i.Yl.DatesAddToRet&&(Ce.signatureRole[0]=i.Yl.DatesCalendarsAddToRet)});var K,F=_.find(S,function(Ce){return W.uI.equalIgnoreCase(Ce.name,E.name)});K=null==F||"EXPAND"!==F.name&&"COLLAPSE"!==F.name?[E.parameters]:this.createHardCodedSignaturesForExpandCollapseFunctions(E);for(var ee=[],ne=function(Re){for(var l=0,a=[],u=0,v=K[Re];u<v.length;u++){var A=v[u],Z=i.Yl.None;if(null!=F?.signatureRole){var he;he=_.isArray(F.signatureRole[0])?F.signatureRole[Re]:F.signatureRole,l<he.length&&(Z=he[l])}var ue=[];W.G.hasFlag(Z.type,64)&&(ue=_.chain(F.enumValues).filter(function(Ee){return Ee.param===l}).map(function(Ee){return new H.it(Ee.value,Ee.description)}).value()),a.push(new H.td(A.name,Z.dataType,A.repeatable,A.optional,A.repeatGroup,Z,A.skippable,ue)),l++}ee.push(a)},se=0;se<K.length;se++)ne(se);var de=1,be=0;F&&(de=F.role,be=F.returnType),this._functions.push(new H.Gs(E.name,E.description,E.category,E.pushableToDQ,be,de,ee))},d.prototype.createHardCodedSignaturesForExpandCollapseFunctions=function(E){var S=4===E.parameters.length;if((0,Q.mv)(S,"expecting 4 parameters"),!S)return[];var F="Expression"===E.parameters[0].name,K="Axis"===E.parameters[1].name,ee="Column"===E.parameters[2].name,ne="N"===E.parameters[3].name;if((0,Q.mv)(F,"1st parameter should be Expression"),(0,Q.mv)(K,"2nd parameter should be Axis"),(0,Q.mv)(ee,"3rd parameter should be Column"),(0,Q.mv)(ne,"4th parameter should be N"),!(F&&K&&ee&&ne))return[];var Ce=E.parameters[1],Re=E.parameters[2],N=E.parameters[3],l=new oe(E.parameters[0].name,!0,!1,-1,!0),a=new oe(N.name,!0,!1,-1,!0);return[[l,new oe(Ce.name,!1,!1,-1,!1),a],[l,new oe(Re.name,!1,!0,0,!1)]]},d.prototype.ensureSpecialFunctions=function(){this._fnCalculate=_.find(this.functions,function(E){return E.name===H.Gs.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME}),this._fnCalculate||(this._fnCalculate=d.hardcodedFnCalculate,this._functions.push(this._fnCalculate))},d.hardcodedFnCalculate=d.loadHardcodedCalculateSignature(),d.builtinFunctionData=[new b("ADDCOLUMNS",2,[i.Yl.TableExprAddToRet,i.Yl.NewCol,i.Yl.ExprOverTable],void 0),new b("ADDMISSINGITEMS",2,[i.Yl.QualifiedColRef,i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.ColFromExtractedTable,{type:512}),i.Yl.TableExpr],void 0),new b("ALLCROSSFILTERED",1,[i.Yl.TableRef],void 0),new b("ALL",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("ALLEXCEPT",2,[i.Yl.TableRefAddToRet,{type:12,columnReferenceScope:5,argumentContextAction:4}],void 0),new b("ALLNOBLANKROW",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("ALLSELECTED",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet),i.Yl.QualifiedColRefAddToRet],void 0),new b("APPROXIMATEDISTINCTCOUNT",1,[i.Yl.AnyColRef],void 0),new b("AVERAGE",1,[i.Yl.AnyColRef],void 0),new b("AVERAGEA",1,[i.Yl.AnyColRef],void 0),new b("AVERAGEX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("CALCULATE",1,[{dataType:1087,argumentContextAction:5},(0,q.pi)({dataType:264},i.Yl.Filter)],void 0,1024),new b("CALCULATETABLE",2,[i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:5}),i.Yl.Filter],void 0),new b("CALENDAR",4,[i.Yl.None,i.Yl.None],void 0),new b("CALENDARAUTO",4,[i.Yl.None],void 0),new b("CLOSINGBALANCEMONTH",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("CLOSINGBALANCEQUARTER",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("CLOSINGBALANCEYEAR",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("COLUMNSTATISTICS",4096,[],void 0),new b("CONCATENATEX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(4,"ASC"),new B(4,"DESC")]),new b("CONTAINS",1,[i.Yl.TableExpr,i.Yl.ColFromExtractedTableOrRel,i.Yl.None],void 0),new b("CONVERT",1,[i.Yl.None,i.Yl.EnumValue],[new B(1,"BOOLEAN"),new B(1,"DOUBLE"),new B(1,"INTEGER"),new B(1,"DATETIME"),new B(1,"CURRENCY"),new B(1,"STRING")]),new b("CONVERTTOCSV",1,[i.Yl.TableExpr,i.Yl.None,i.Yl.None,i.Yl.None],void 0),new b("COUNT",1,[i.Yl.AnyColRef],void 0),new b("COUNTA",1,[i.Yl.AnyColRef],void 0),new b("COUNTAX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("COUNTBLANK",1,[i.Yl.AnyColRef],void 0),new b("COUNTX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("COUNTROWS",1,[i.Yl.TableExpr],void 0),new b("CROSSFILTER",1,[i.Yl.QualifiedColRef,i.Yl.QualifiedColRef,i.Yl.EnumValue],[new B(2,"None"),new B(2,"OneWay"),new B(2,"Both"),new B(2,"OneWay_LeftFiltersRight"),new B(2,"OneWay_RightFiltersLeft")]),new b("CROSSJOIN",2,[i.Yl.TableExprAddToRet],void 0),new b("CURRENTGROUP",8,[],void 0),new b("DATATABLE",2,[i.Yl.NewCol,i.Yl.EnumValue,{type:4096}],[new B(1,"BOOLEAN"),new B(1,"DOUBLE"),new B(1,"INTEGER"),new B(1,"DATETIME"),new B(1,"CURRENCY"),new B(1,"STRING")]),new b("DATE",1,[(0,q.pi)({dataType:1},i.Yl.None),(0,q.pi)({dataType:1},i.Yl.None),(0,q.pi)({dataType:1},i.Yl.None)],void 0,16),new b("DATEADD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.EnumValue],[new B(2,"DAY"),new B(2,"MONTH"),new B(2,"QUARTER"),new B(2,"YEAR")]),new b("DATEDIFF",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"DAY"),new B(2,"WEEK"),new B(2,"MONTH"),new B(2,"QUARTER"),new B(2,"YEAR"),new B(2,"HOUR"),new B(2,"MINUTE"),new B(2,"SECOND")]),new b("DATESBETWEEN",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.None],void 0),new b("DATESINPERIOD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(3,"DAY"),new B(3,"MONTH"),new B(3,"QUARTER"),new B(3,"YEAR")]),new b("DATESMTD",2,[i.Yl.DatesAddToRet],void 0),new b("DATESQTD",2,[i.Yl.DatesAddToRet],void 0),new b("DATESYTD",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("DISTINCT",8194,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,i.Yl.TableExprAddToRet)],void 0),new b("DISTINCTCOUNT",1,[i.Yl.AnyColRef],void 0),new b("DISTINCTCOUNTNOBLANK",1,[i.Yl.AnyColRef],void 0),new b("EARLIER",1,[i.Yl.EarlierColRef],void 0),new b("EARLIEST",1,[i.Yl.EarliestColRef],void 0),new b("ENDOFMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("ENDOFQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("ENDOFYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("EVALUATEANDLOG",256,[i.Yl.or({type:1},i.Yl.TableExpr,i.Yl.TableExprAddToRet,i.Yl.TableRef,i.Yl.TableRefAddToRet),i.Yl.None,i.Yl.None],void 0),new b("EXCEPT",2,[i.Yl.TableExprAddToRet,i.Yl.TableExpr],void 0),new b("EXTERNALMEASURE",1,[{type:2048},i.Yl.EnumValue,{type:2048}],[new B(1,"BOOLEAN"),new B(1,"DOUBLE"),new B(1,"INTEGER"),new B(1,"DATETIME"),new B(1,"CURRENCY"),new B(1,"STRING"),new B(1,"VARIANT")]),new b("FILTER",2,[(0,q.pi)({dataType:256},i.Yl.TableExprAddToRet),(0,q.pi)({dataType:8},i.Yl.ExprOverTable)],void 0,256),new b("FILTERS",2,[i.Yl.or(i.Yl.HomeOrQualifiedColRef,{argumentAction:1})],void 0),new b("FIRSTDATE",2,[i.Yl.DatesAddToRet],void 0),new b("FIRSTNONBLANK",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("FIRSTNONBLANKVALUE",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("FULLOUTERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("GENERATE",2,[i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:1})],void 0),new b("GENERATEALL",2,[i.Yl.TableExprAddToRet,i.Yl.or(i.Yl.TableExprAddToRet,{argumentContextAction:1})],void 0),new b("GENERATESERIES",12,[i.Yl.None,i.Yl.None,i.Yl.None],void 0),new b("GEOMEAN",1,[i.Yl.AnyColRef],void 0),new b("GEOMEANX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("GROUPBY",2,[i.Yl.TableExpr,i.Yl.ColFromExtractedTableOrRelAddToRet,i.Yl.NewCol,{additionalBehaviors:1}],void 0),new b("HASONEVALUE",1,[i.Yl.QualifiedColRef],void 0),new b("HASONEFILTER",1,[i.Yl.HomeOrQualifiedColRef],void 0),new b("KEEPFILTERS",2,[i.Yl.or(i.Yl.TableExprAddToRet,{type:1})],void 0),new b("IF",1,[(0,q.pi)((0,q.pi)({},i.Yl.None),{dataType:59}),(0,q.pi)({dataType:1087},i.Yl.None),(0,q.pi)({dataType:1087},i.Yl.None)],void 0,1024),new b("INFO.ALTERNATEOFDEFINITIONS",16384,[]),new b("INFO.ANNOTATIONS",16384,[]),new b("INFO.ATTRIBUTEHIERARCHIES",16384,[]),new b("INFO.ATTRIBUTEHIERARCHYSTORAGES",16384,[]),new b("INFO.CALCDEPENDENCY",16384,[]),new b("INFO.CALCULATIONGROUPS",16384,[]),new b("INFO.CALCULATIONITEMS",16384,[]),new b("INFO.CATALOGS",16384,[]),new b("INFO.CHANGEDPROPERTIES",16384,[]),new b("INFO.COLUMNPARTITIONSTORAGES",16384,[]),new b("INFO.COLUMNPERMISSIONS",16384,[]),new b("INFO.COLUMNS",16384,[]),new b("INFO.COLUMNSTORAGES",16384,[]),new b("INFO.CULTURES",16384,[]),new b("INFO.DATACOVERAGEDEFINITIONS",16384,[]),new b("INFO.DATASOURCES",16384,[]),new b("INFO.DELTATABLEMETADATASTORAGES",16384,[]),new b("INFO.DETAILROWSDEFINITIONS",16384,[]),new b("INFO.DICTIONARYSTORAGES",16384,[]),new b("INFO.EXCLUDEDARTIFACTS",16384,[]),new b("INFO.EXPRESSIONS",16384,[]),new b("INFO.EXTENDEDPROPERTIES",16384,[]),new b("INFO.FORMATSTRINGDEFINITIONS",16384,[]),new b("INFO.FUNCTIONS",16384,[]),new b("INFO.GENERALSEGMENTMAPSEGMENTMETADATASTORAGES",16384,[]),new b("INFO.GROUPBYCOLUMNS",16384,[]),new b("INFO.HIERARCHIES",16384,[]),new b("INFO.HIERARCHYSTORAGES",16384,[]),new b("INFO.KPIS",16384,[]),new b("INFO.LEVELS",16384,[]),new b("INFO.LINGUISTICMETADATA",16384,[]),new b("INFO.MEASURES",16384,[]),new b("INFO.MODEL",16384,[]),new b("INFO.OBJECTTRANSLATIONS",16384,[]),new b("INFO.PARQUETFILESTORAGES",16384,[]),new b("INFO.PARTITIONS",16384,[]),new b("INFO.PARTITIONSTORAGES",16384,[]),new b("INFO.PERSPECTIVECOLUMNS",16384,[]),new b("INFO.PERSPECTIVEHIERARCHIES",16384,[]),new b("INFO.PERSPECTIVEMEASURES",16384,[]),new b("INFO.PERSPECTIVES",16384,[]),new b("INFO.PERSPECTIVETABLES",16384,[]),new b("INFO.PROPERTIES",16384,[]),new b("INFO.QUERYGROUPS",16384,[]),new b("INFO.REFRESHPOLICIES",16384,[]),new b("INFO.RELATEDCOLUMNDETAILS",16384,[]),new b("INFO.RELATIONSHIPINDEXSTORAGES",16384,[]),new b("INFO.RELATIONSHIPS",16384,[]),new b("INFO.RELATIONSHIPSTORAGES",16384,[]),new b("INFO.ROLEMEMBERSHIPS",16384,[]),new b("INFO.ROLES",16384,[]),new b("INFO.SEGMENTMAPSTORAGES",16384,[]),new b("INFO.SEGMENTSTORAGES",16384,[]),new b("INFO.STORAGEFILES",16384,[]),new b("INFO.STORAGEFOLDERS",16384,[]),new b("INFO.STORAGETABLECOLUMNS",16384,[]),new b("INFO.STORAGETABLECOLUMNSEGMENTS",16384,[]),new b("INFO.STORAGETABLES",16384,[]),new b("INFO.TABLEPERMISSIONS",16384,[]),new b("INFO.TABLES",16384,[]),new b("INFO.TABLESTORAGES",16384,[]),new b("INFO.VARIATIONS",16384,[]),new b("INTERSECT",2,[i.Yl.TableExprAddToRet,i.Yl.TableExpr],void 0),new b("ISAFTER",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"ASC"),new B(2,"DESC")]),new b("ISCROSSFILTERED",1,[i.Yl.or(i.Yl.TableRef,i.Yl.HomeOrQualifiedColRef)],void 0),new b("ISEMPTY",1,[i.Yl.TableExpr],void 0),new b("ISFILTERED",1,[i.Yl.or(i.Yl.TableRef,i.Yl.HomeOrQualifiedColRef)],void 0),new b("INDEX",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new B(3,"DEFAULT"),new B(6,"NONE"),new B(6,"LOWESTPARENT"),new B(6,"HIGHESTPARENT")],256),new b("ISINSCOPE",1,[i.Yl.HomeOrQualifiedColRef],void 0),new b("ISONORAFTER",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"ASC"),new B(2,"DESC")]),new b("ISSUBTOTAL",1,[i.Yl.ColFromCurTable],void 0),new b("LASTDATE",2,[i.Yl.DatesAddToRet],void 0),new b("LASTNONBLANK",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("LASTNONBLANKVALUE",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{argumentAction:8},i.Yl.TableExprAddToRet),{argumentContextAction:3}],void 0),new b("LINEST",2,[i.Yl.AnyColRef,i.Yl.AnyColRef,i.Yl.EnumValue],[new B(2,"TRUE"),new B(2,"FALSE")],256),new b("LINESTX",2,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(3,"TRUE"),new B(3,"FALSE")],256),new b("LOOKUPVALUE",1,[i.Yl.or(i.Yl.HomeOrQualifiedColRef,{argumentAction:4}),i.Yl.ColFromExtractedTableOrRel,i.Yl.None],void 0),new b("MATCHBY",2048,[i.Yl.AnyColRef],void 0),new b("MAX",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("MAXA",1,[i.Yl.AnyColRef],void 0),new b("MAXX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(2,"TRUE"),new B(2,"FALSE")],void 0),new b("MEDIAN",1,[i.Yl.AnyColRef],void 0),new b("MEDIANX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("MIN",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("MINA",1,[i.Yl.AnyColRef],void 0),new b("MINX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(2,"TRUE"),new B(2,"FALSE")],void 0),new b("NAMEOF",1,[i.Yl.or(i.Yl.AnyColRef,{type:1})],void 0),new b("NATURALINNERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("NATURALLEFTOUTERJOIN",2,[i.Yl.TableExprAddToRet,i.Yl.TableExprAddToRet],void 0),new b("NETWORKDAYS",1,[i.Yl.None,i.Yl.None,i.Yl.None,i.Yl.TableExpr],void 0,63),new b("NEXTDAY",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("NEXTYEAR",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("NONVISUAL",2,[i.Yl.TableExprAddToRet],void 0),new b("OFFSET",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new B(3,"DEFAULT"),new B(6,"NONE"),new B(6,"LOWESTPARENT"),new B(6,"HIGHESTPARENT")],256),new b("OPENINGBALANCEMONTH",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("OPENINGBALANCEQUARTER",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("OPENINGBALANCEYEAR",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("ORDERBY",512,[i.Yl.or(i.Yl.ColFromCurTable,{type:1}),i.Yl.EnumValue],[new B(1,"ASC"),new B(1,"DESC"),new B(1,"ASC BLANKS DEFAULT"),new B(1,"ASC BLANKS FIRST"),new B(1,"ASC BLANKS LAST"),new B(1,"DESC BLANKS DEFAULT"),new B(1,"DESC BLANKS FIRST"),new B(1,"DESC BLANKS LAST")]),new b("PARALLELPERIOD",2,[i.Yl.DatesAddToRet,i.Yl.None,i.Yl.EnumValue],[new B(2,"MONTH"),new B(2,"QUARTER"),new B(2,"YEAR")]),new b("PARTITIONBY",1024,[i.Yl.AnyColRef],void 0),new b("PATH",1,[i.Yl.HomeOrQualifiedColRef,i.Yl.HomeOrQualifiedColRef],void 0),new b("PATHITEM",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"TEXT","Function returns a string"),new B(2,"INTEGER","Function returns an integer")]),new b("PATHITEMREVERSE",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"TEXT","Function returns a string"),new B(2,"INTEGER","Function returns an integer")]),new b("PERCENTILE.EXC",1,[i.Yl.AnyColRef,i.Yl.None],void 0),new b("PERCENTILE.INC",1,[i.Yl.AnyColRef,i.Yl.None],void 0),new b("PERCENTILEX.EXC",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("PERCENTILEX.INC",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("PREVIOUSDAY",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("PREVIOUSYEAR",2,[i.Yl.DatesAddToRet,{type:2048}],void 0),new b("PRODUCT",1,[i.Yl.AnyColRef],void 0),new b("PRODUCTX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("RANK",1,[i.Yl.EnumValue,i.Yl.TableExpr,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new B(0,"DENSE"),new B(0,"SKIP"),new B(3,"DEFAULT"),new B(3,"FIRST"),new B(3,"LAST"),new B(6,"NONE"),new B(6,"LOWESTPARENT"),new B(6,"HIGHESTPARENT")]),new b("RANK.EQ",1,[i.Yl.None,i.Yl.AnyColRef,i.Yl.EnumValue],[new B(2,"ASC"),new B(2,"DESC")]),new b("RANKX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.None,i.Yl.EnumValue,i.Yl.EnumValue],[new B(3,"ASC"),new B(3,"DESC"),new B(4,"Skip"),new B(4,"Dense")]),new b("RELATED",1,[i.Yl.RelatedColRef],void 0),new b("RELATEDTABLE",2,[i.Yl.or(i.Yl.TableRefAddToRet,{argumentContextAction:5})],void 0),new b("REMOVEFILTERS",1,[i.Yl.or(i.Yl.TableRef,i.Yl.QualifiedColRef),i.Yl.QualifiedColRef],void 0),new b("ROLLUP",16,[{type:1024,additionalBehaviors:4}],void 0),new b("ROLLUPGROUP",128,[{additionalBehaviors:4}],void 0),new b("ROLLUPADDISSUBTOTAL",32,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromParentContext,{type:1024,additionalBehaviors:4}),i.Yl.NewCol,i.Yl.TableExpr],void 0),new b("ROLLUPISSUBTOTAL",64,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromParentContext,{type:1024,additionalBehaviors:4}),i.Yl.ColFromParentContext,i.Yl.TableExpr],void 0),new b("ROW",2,[i.Yl.NewCol,i.Yl.None],void 0),new b("ROWNUMBER",1,[i.Yl.TableExpr,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new B(2,"DEFAULT"),new B(2,"FIRST"),new B(2,"LAST"),new B(5,"NONE"),new B(5,"LOWESTPARENT"),new B(5,"HIGHESTPARENT")]),new b("SAMEPERIODLASTYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("SAMPLE",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(3,"ASC"),new B(3,"DESC")]),new b("SELECTCOLUMNS",2,[i.Yl.TableExpr,i.Yl.NewCol,i.Yl.ExprOverTable],void 0),new b("SELECTEDVALUE",1,[(0,q.pi)({dataType:1024},i.Yl.QualifiedColRef)],void 0,1024),new b("STARTOFMONTH",2,[i.Yl.DatesAddToRet],void 0),new b("STARTOFQUARTER",2,[i.Yl.DatesAddToRet],void 0),new b("STARTOFYEAR",2,[i.Yl.DatesAddToRet],void 0),new b("STDEV.P",1,[i.Yl.AnyColRef],void 0),new b("STDEV.S",1,[i.Yl.AnyColRef],void 0),new b("STDEVX.P",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("STDEVX.S",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("SUBSTITUTEWITHINDEX",2,[{type:2,argumentAction:1},i.Yl.NewCol,i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(4,"ASC"),new B(4,"DESC")]),new b("SUMMARIZE",2,[i.Yl.TableExpr,i.Yl.or(i.Yl.ColFromExtractedTableOrRelAddToRet,{type:1152,argumentAction:8}),i.Yl.NewCol,{argumentContextAction:2}],void 0),new b("SUMMARIZECOLUMNS",2,[i.Yl.or(i.Yl.QualifiedColRefAddToRet,{type:256}),i.Yl.TableExpr,i.Yl.NewCol,i.Yl.None],void 0),new b("SUM",1,[(0,q.pi)((0,q.pi)({},i.Yl.AnyColRef),{dataType:1083})],void 0,1024),new b("SUMX",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0,1024),new b("TOCSV",1,[i.Yl.TableExpr,i.Yl.None,i.Yl.None,i.Yl.None],void 0,4),new b("TODAY",1,[],void 0,16),new b("TOJSON",1,[i.Yl.TableExpr,i.Yl.None],void 0,4),new b("TOPN",2,[i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(3,"ASC"),new B(3,"DESC"),new B(3,"0"),new B(3,"1"),new B(3,"TRUE"),new B(3,"FALSE")]),new b("TOPNSKIP",2,[i.Yl.None,i.Yl.None,i.Yl.TableExprAddToRet,i.Yl.ExprOverTable,i.Yl.EnumValue],[new B(4,"ASC"),new B(4,"DESC"),new B(4,"0"),new B(4,"1"),new B(4,"TRUE"),new B(4,"FALSE")]),new b("TOTALMTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("TOTALQTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter],void 0),new b("TOTALYTD",1,[{argumentContextAction:5},i.Yl.Dates,i.Yl.Filter,{type:2048}],void 0),new b("TREATAS",2,[{type:2},i.Yl.QualifiedColRefAddToRet],void 0),new b("UNION",2,[i.Yl.or(i.Yl.TableExprAddToRet,{argumentAction:2})],void 0),new b("USERELATIONSHIP",1,[i.Yl.QualifiedColRef,i.Yl.QualifiedColRef],void 0),new b("VALUES",8194,[i.Yl.or(i.Yl.TableRefAddToRet,i.Yl.QualifiedColRefAddToRet)],void 0),new b("VAR.P",1,[i.Yl.AnyColRef],void 0),new b("VAR.S",1,[i.Yl.AnyColRef],void 0),new b("VARX.P",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("VARX.S",1,[i.Yl.TableExpr,i.Yl.ExprOverTable],void 0),new b("WINDOW",2,[i.Yl.None,i.Yl.EnumValue,i.Yl.None,i.Yl.EnumValue,i.Yl.TableExprAddToRet,i.Yl.OrderByParam,i.Yl.EnumValue,i.Yl.PartitionByParam,i.Yl.MatchByParam,i.Yl.EnumOrIntValue],[new B(1,"ABS"),new B(1,"REL"),new B(3,"ABS"),new B(3,"REL"),new B(6,"DEFAULT"),new B(9,"NONE"),new B(9,"LOWESTPARENT"),new B(9,"HIGHESTPARENT")],256),new b("WEEKDAY",1,[i.Yl.None,i.Yl.EnumValue],[new B(1,"1","Sunday=1 through Saturday=7"),new B(1,"2","Monday=1 through Sunday=7"),new B(1,"3","Monday=0 through Sunday=6")]),new b("WEEKNUM",1,[i.Yl.None,i.Yl.EnumValue],[new B(1,"1","Week begins on Sunday"),new B(1,"2","Week begins on Monday"),new B(1,"11","Week begins on Monday"),new B(1,"12","Week begins on Tuesday"),new B(1,"13","Week begins on Wednesday"),new B(1,"14","Week begins on Thursday"),new B(1,"15","Week begins on Friday"),new B(1,"16","Week begins on Saturday"),new B(1,"17","Week begins on Sunday"),new B(1,"21","Based on the European week numbering system, the week begins on Monday")]),new b("XIRR",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("XNPV",1,[i.Yl.TableExpr,i.Yl.ExprOverTable,i.Yl.ExprOverTable,i.Yl.None],void 0),new b("YEARFRAC",1,[i.Yl.None,i.Yl.None,i.Yl.EnumValue],[new B(2,"0","US (NASD) 30/360"),new B(2,"1","Actual/actual"),new B(2,"2","Actual/360"),new B(2,"3","Actual/365"),new B(2,"4","European 30/360")])],d.builtinVisualCalcFunctionData=[new b("FIRST",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(2,"DEFAULT"),new B(2,"FIRST"),new B(2,"LAST"),new B(3,"NONE"),new B(3,"LOWESTPARENT"),new B(3,"HIGHESTPARENT")]),new b("LAST",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(2,"DEFAULT"),new B(2,"FIRST"),new B(2,"LAST"),new B(3,"NONE"),new B(3,"LOWESTPARENT"),new B(3,"HIGHESTPARENT")]),new b("NEXT",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(3,"DEFAULT"),new B(3,"FIRST"),new B(3,"LAST"),new B(4,"NONE"),new B(4,"LOWESTPARENT"),new B(4,"HIGHESTPARENT")]),new b("PREVIOUS",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(3,"DEFAULT"),new B(3,"FIRST"),new B(3,"LAST"),new B(4,"NONE"),new B(4,"LOWESTPARENT"),new B(4,"HIGHESTPARENT")]),new b("LOOKUP",1,[i.Yl.AnyColRef,i.Yl.Filter],void 0),new b("RUNNINGSUM",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(2,"DEFAULT"),new B(2,"FIRST"),new B(2,"LAST"),new B(3,"NONE"),new B(3,"LOWESTPARENT"),new B(3,"HIGHESTPARENT")]),new b("MOVINGAVERAGE",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.None,i.Yl.EnumValue,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(2,"TRUE"),new B(2,"FALSE"),new B(4,"DEFAULT"),new B(4,"FIRST"),new B(4,"LAST"),new B(5,"NONE"),new B(5,"LOWESTPARENT"),new B(5,"HIGHESTPARENT")]),new b("EXPAND",1,[[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.None],[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AnyColRef]],void 0),new b("COLLAPSE",1,[[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr,i.Yl.None],[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AnyColRef]],void 0),new b("EXPANDALL",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr],void 0),new b("COLLAPSEALL",1,[i.Yl.or(i.Yl.AnyColRef,{type:1}),i.Yl.AxisExpr],void 0),new b("RANGE",2,[i.Yl.None,i.Yl.EnumValue,i.Yl.AxisExpr,i.Yl.EnumValue,i.Yl.EnumOrIntValue],[new B(1,"TRUE"),new B(1,"FALSE"),new B(3,"DEFAULT"),new B(3,"FIRST"),new B(3,"LAST"),new B(4,"NONE"),new B(4,"LOWESTPARENT"),new B(4,"HIGHESTPARENT")]),new b("ISATLEVEL",1,[i.Yl.AnyColRef],void 0)],d}();function pe(d,E){return new te(d.reservedWords,d.functionDataFromEngine.map(function(S){return function(d){return new ve(d.name,d.description,d.category,d.pushableToDQ,d.parameters.map(function(E){return function(d){return new oe(d.name,d.optional,d.repeatable,d.repeatGroup,d.skippable)}(E)}),d.visualCalculationsInfo)}(S)}),E)}function le(d){return new Me(d)}var Me=function(){function d(E){this.tables=[];for(var S=0,F=E.tables;S<F.length;S++)this.tables.push(new Oe(F[S]));for(var ee=0,ne=this.tables;ee<ne.length;ee++)for(var de=0,be=ne[ee].columns;de<be.length;de++)be[de].bindVariationTable(this.tables);this.relationshipGraph=new ie(this,E.relationships)}return d.prototype.findTable=function(E){return _.find(this.tables,function(S){return S.name===E})},d}(),xe=function(){function d(E,S){this.table=E,this.name=S.name,this.description=S.description,this.variationTableName=S.variationTable}return Object.defineProperty(d.prototype,"variationTable",{get:function(){return this._variationTable},enumerable:!1,configurable:!0}),d.prototype.bindVariationTable=function(E){var S=this;this.variationTableName&&(this._variationTable=_.find(E,function(F){return F.name===S.variationTableName}))},d}(),Fe=function(){return function(E,S){this.table=E,this.name=S.name,this.description=S.description,this.expression=S.expression,this.isExternal=S.isExternal}}(),me=function(){return function(E,S){this.table=E,this.name=S.name}}(),Oe=function(){function d(E){var F,S=this;this.name=E.name,this.description=E.description,this.measures=E.measures.map(function(ee){return new Fe(S,ee)});var K=E.columns.filter(function(ee){return ee.isUserColumn});this.columns=K.map(function(ee){return new xe(S,ee)}),this.calendars=null===(F=E.calendars)||void 0===F?void 0:F.map(function(ee){return new me(S,ee)}),this.isTransparent=E.isTransparent,this.isUserTable=E.isUserTable}return d.prototype.getHashCode=function(){return this.name},d.prototype.equals=function(E){return this.name===E.name},d}(),ie=function(){function d(E,S){this.reachableTables=new W.Xy,this.reachableTables=d.buildReachableTables(E,S)}return d.prototype.getRelatedTables=function(E){var S=this.reachableTables.get(E);return S?S.values():[]},d.buildReachableTables=function(E,S){for(var F=new W.Xy,K=0,ee=_.filter(S,function(ue){return ue.active});K<ee.length;K++){var ne=ee[K],se=E.findTable(ne.from.table),de=E.findTable(ne.to.table);d.addRelatedTable(F,se,de),"one"===ne.from.cardinality&&"one"===ne.to.cardinality&&d.addRelatedTable(F,de,se)}for(var be=new W.Xy,Ce=0,Re=F.keys;Ce<Re.length;Ce++){var N=Re[Ce],l=new W.Bl,a=new W.ci;for(l.add(N),a.enqueue(N);a.length>0;){var u=a.dequeue(),v=F.get(u);if(v)for(var A=0,Z=v.values();A<Z.length;A++){var he=Z[A];l.add(he)&&a.enqueue(he)}}l.remove(N),be.update(N,l)}return be},d.addRelatedTable=function(E,S,F){var K=E.get(S);K||(K=new W.Bl,E.add(S,K)),K.add(F)},d}(),f=(T(21527),T(85786),T(48987),T(95792)),m=T(88498)},70163:function(Ke,Ie,T){function x(G){I.initialize(G)}T.d(Ie,{J:function(){return I},j:function(){return x}});var I=function(){function G(){}return G.initialize=function(Y){G._tryParseColumnReference=Y},Object.defineProperty(G,"tryParseColumnReference",{get:function(){if(!this._tryParseColumnReference)throw new Error("NodeUtilities has not been initialized! Ensure DaxParserUtils.initialize has been called first");return G._tryParseColumnReference},enumerable:!1,configurable:!0}),G}()},66106:function(Ke,Ie,T){T.d(Ie,{Rv:function(){return R},XD:function(){return Y},Yl:function(){return k},e9:function(){return G}});var k,R,U,x=T(81337),I=T(63513),G=1920,Y=24;!function(U){function H(){for(var X=[],D=0;D<arguments.length;D++)X[D]=arguments[D];for(var re=U.None,q=0,Q=X;q<Q.length;q++){var i=Q[q];re={additionalBehaviors:re.additionalBehaviors|i.additionalBehaviors,argumentAction:re.argumentAction|i.argumentAction,argumentContextAction:re.argumentContextAction|i.argumentContextAction,columnReferenceScope:re.columnReferenceScope|i.columnReferenceScope,type:re.type|i.type,dataType:re.dataType|i.dataType}}return re}U.None={},U.InvalidParam={type:262144},U.TableExpr={type:524290,argumentAction:4},U.TableExprAddToRet={type:524290,argumentAction:5},U.TableRef={type:65540,argumentAction:4},U.TableRefAddToRet={type:65540,argumentAction:5},U.AnyColRef={type:24,columnReferenceScope:49},U.QualifiedColRef={type:8,columnReferenceScope:16},U.CalendarRef={type:1048576,argumentAction:4},U.QualifiedColRefAddToRet=H(U.QualifiedColRef,{argumentAction:1}),U.RelatedColRef={type:8,columnReferenceScope:4},U.HomeOrQualifiedColRef={type:8,columnReferenceScope:48},U.EarlierColRef={type:24,columnReferenceScope:3,argumentContextAction:6},U.EarliestColRef={type:24,columnReferenceScope:3,argumentContextAction:7},U.ColFromParentContext={type:24,additionalBehaviors:4},U.ColFromCurTable={type:24,columnReferenceScope:3},U.ColFromExtractedTable=H(U.ColFromCurTable,{argumentContextAction:4}),U.ColFromExtractedTableOrRel=H(U.ColFromCurTable,{columnReferenceScope:4,argumentContextAction:4}),U.ColFromExtractedTableOrRelAddToRet=H(U.ColFromExtractedTableOrRel,{columnReferenceScope:8,argumentAction:1}),U.NewCol={type:32,argumentAction:1},U.ExprOverTable={argumentContextAction:1},U.EnumValue={type:64},U.Dates=H(U.TableExpr,U.QualifiedColRef),U.DatesAddToRet=H(U.Dates,{argumentAction:1}),U.DatesCalendars=H(U.Dates,U.CalendarRef),U.DatesCalendarsAddToRet=H(U.DatesCalendars,{argumentAction:1}),U.Filter={type:1,additionalBehaviors:2},U.OrderByParam={type:16384,argumentContextAction:1},U.PartitionByParam={type:32768},U.MatchByParam={type:131072},U.AxisExpr={type:524288},U.EnumOrIntValue=H(U.EnumValue,{type:1}),U.or=H}(k||(k={})),(U=R||(R={})).getTypes=function(D,re){var q=D.type;if(I.G.hasFlag(D.additionalBehaviors,4))for(var Q=0,i=re.ephemeralContexts;Q<i.length;Q++)q|=i[Q].allowedTypes&Y;return!_.isEmpty(re.matchObjects.transparentTables)&&I.G.hasFlag(q,8)&&(q|=16),q},U.transformRole=function(D,re){if(!_.isEmpty(re.matchObjects.transparentTables)&&I.G.hasFlag(D.type,8)){var q=D.type?16|D.type:16;return(0,x.pi)((0,x.pi)({},D),{type:q})}return D}},85402:function(Ke,Ie,T){T.d(Ie,{q:function(){return I}});var x=T(55863),I=function(){function G(Y){this._parent=Y,null!=this.parent&&this.parent.addChild(this),this._state=0,this.children=[]}return Object.defineProperty(G.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"childCount",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),G.prototype.addChild=function(Y){return!_.includes(this.children,Y)&&(this.children.push(Y),!0)},G.prototype.removeChild=function(Y){var k=_.indexOf(this.children,Y);-1!==k&&this.children.splice(k,1)},G.prototype.reinitialize=function(){this._state=0,this.children=[]},G.prototype.markUnsuccessful=function(){for(var Y=this;;){Y._state=2;var k=Y.parent;if(!k||(k.removeChild(Y),k.childCount>0))break;Y=k}},G.prototype.consolidatePath=function(){var Y,k;for(Y=this,k=this.parent;null!=k&&k.childCount<=1;Y=k,k=k.parent)(0,x.hu)(1===k.childCount,"Must have at least one child, since it is our parent"),Y._state=1,k.removeChild(Y);return Y},Object.defineProperty(G.prototype,"isValid",{get:function(){for(var k=this;;k=k.parent){if((0,x.hu)(null!=k,"There must be an ongoing ParsePath at the root of the tree of ParsePaths"),0===k.state)return!0;if(2===k.state)return!1}},enumerable:!1,configurable:!0}),G}()},88498:function(Ke,Ie,T){T.d(Ie,{Mz:function(){return k},V:function(){return x},ft:function(){return G},g5:function(){return Y}});var k,R,x={listSeparator:",",numberDecimalSeparator:"."},I=x;function G(){return I}function Y(R){I=R}(R=k||(k={})).alwaysRebuildContext=!1,R.debugging=!0},3371:function(Ke,Ie,T){T.d(Ie,{M:function(){return Y}});var Y,x=T(55863),I=T(63513),G=T(58871);!function(k){function U(q,Q,i){for(var W=Q.name,oe=new G.S2(W,Q.description,I.LP.quoteNeeded(W,function(ye){return re(ye,q)}),Q.name,Q.isTransparent,Q.isUserTable),ve=0,B=Q.columns;ve<B.length;ve++){var b=B[ve],te=b.description,pe=void 0;i&&b.variationTable&&(pe=U(q,b.variationTable,!1));var le=new G.XN(b.name,te,oe);oe.addColumn(le),null!=pe&&(le.variationTable=pe,pe.variationSource=le)}return oe}function re(q,Q){return G.hK.isReservedWord(q,Q.reservedWords,Q.functions)}k.populateAll=function(q,Q,i){var W={daxTables:[],daxColumns:[],transparentDaxTables:[]};!function(q,Q,i){var W={},C={};i.daxTables=[],i.daxColumns=[],i.transparentDaxTables=[];for(var oe=0,ve=q.tables;oe<ve.length;oe++){var B=ve[oe];(b=U(Q,B,!0)).isTransparent?i.transparentDaxTables.push(b):i.daxTables.push(b),W[b.name]=b,C[B.name]=B,i.daxColumns=i.daxColumns.concat(b.columns)}for(var te=q.relationshipGraph,pe=0,le=i.daxTables;pe<le.length;pe++)for(var b,ye=(b=le[pe]).uberTable,Pe=0,Me=te.getRelatedTables(C[b.name]);Pe<Me.length;Pe++){var Fe=W[Me[Pe].name];Fe&&ye.relatedTables.push(Fe)}}(q,Q,W);var C={measures:[]};!function(q,Q,i,W){W.measures=[];for(var C=function(te){if(!_.some(te.measures))return"continue";var pe=_.find(i.daxTables,function(xe){return xe.name===te.name});(0,x.mv)(pe,"daxTable");for(var le=0,ye=te.measures;le<ye.length;le++){var Pe=ye[le],Me=new G.Cf(Pe.name,Pe.description,pe,Q);pe.addMeasure(Me),W.measures.push(Me)}},oe=0,ve=q.tables;oe<ve.length;oe++)C(ve[oe])}(q,Q.fnCalculate,W,C);var oe={calendars:[]};(function(q,Q,i){i.calendars=[];for(var W=function(b){if(!_.some(b.calendars))return"continue";var te=_.find(Q.daxTables,function(Me){return Me.name===b.name});(0,x.mv)(te,"daxTable");for(var pe=0,le=b.calendars;pe<le.length;pe++){var Pe=new G.Df(le[pe].name,te);te.addCalendar(Pe),i.calendars.push(Pe)}},C=0,oe=q.tables;C<oe.length;C++)W(oe[C])})(q,W,oe),i.matchObjects=new G.ZY(W.daxTables,W.daxColumns,C.measures,oe.calendars,Q.functions,Q.reservedWords,W.transparentDaxTables,Q.axes)},k.isReservedWord=re}(Y||(Y={}))},22021:function(Ke,Ie,T){T.d(Ie,{s:function(){return x}});var x=function(){return function(){this.valid=!1,this.cParensNeeded=0}}()},58871:function(Ke,Ie,T){T.d(Ie,{cr:function(){return b},e$:function(){return Me},Df:function(){return te},XN:function(){return Fe},hK:function(){return i},it:function(){return me},xE:function(){return W},Gs:function(){return m},eL:function(){return ie},gR:function(){return M},td:function(){return Oe},Z0:function(){return B},ZY:function(){return C},Cf:function(){return d},Go:function(){return f},S2:function(){return xe},Lc:function(){return ve},yB:function(){return pe},Nr:function(){return E},qf:function(){return ee},o:function(){return ne},sN:function(){return F},$Y:function(){return S},a9:function(){return K}});var x=T(81337),I=T(55863),G=T(40546),Y=T(20540),k=T(70163),R=T(66106),U=T(85402),H=T(88498),X=T(42165),D=T(63513),re={CALENDAR:{columns:["Date"]},CALENDARAUTO:{columns:["Date"]},COLUMNSTATISTICS:{columns:["Table Name","Column Name","Min","Max","Cardinality","Max Length"]},GENERATESERIES:{columns:["Value"]},"INFO.ALTERNATEOFDEFINITIONS":{columns:["ID","ColumnID","BaseColumnID","BaseTableID","Summarization"]},"INFO.ANNOTATIONS":{columns:["ID","ObjectID","ObjectType","Name","Value","ModifiedTime"]},"INFO.ATTRIBUTEHIERARCHIES":{columns:["ID","ColumnID","State","AttributeHierarchyStorageID","ModifiedTime","RefreshedTime"]},"INFO.ATTRIBUTEHIERARCHYSTORAGES":{columns:["ID","AttributeHierarchyID","SortOrder","OptimizationLevel","MaterializationType","ColumnPositionToData","ColumnDataToPosition","DistinctDataCount","DataVersion","StorageFileID","SystemTableID","HasStatistics","MinValue","MaxValue","StringValueMaxLength"]},"INFO.CALCDEPENDENCY":{columns:["DATABASE_NAME","OBJECT_TYPE","TABLE","OBJECT","EXPRESSION","REFERENCED_OBJECT_TYPE","REFERENCED_TABLE","REFERENCED_OBJECT","REFERENCED_EXPRESSION","QUERY"]},"INFO.CALCULATIONGROUPS":{columns:["ID","TableID","Description","ModifiedTime","Precedence"]},"INFO.CALCULATIONITEMS":{columns:["ID","CalculationGroupID","FormatStringDefinitionID","Name","Description","ModifiedTime","State","ErrorMessage","Expression","Ordinal"]},"INFO.CATALOGS":{columns:["CATALOG_NAME","DESCRIPTION","ROLES","DATE_MODIFIED","COMPATIBILITY_LEVEL","TYPE","VERSION","DATABASE_ID","DATABASE_GUID","DATE_QUERIED","CURRENTLY_USED","POPULARITY","WEIGHTEDPOPULARITY","CLIENTCACHEREFRESHPOLICY","ENCRYPTION_LEVEL"]},"INFO.CHANGEDPROPERTIES":{columns:["ID","ObjectID","ObjectType","Property"]},"INFO.COLUMNPARTITIONSTORAGES":{columns:["ID","ColumnStorageID","PartitionStorageID","DataVersion","State","SegmentStorageID","StorageFileID"]},"INFO.COLUMNPERMISSIONS":{columns:["ID","TablePermissionID","ColumnID","ModifiedTime","MetadataPermission"]},"INFO.COLUMNS":{columns:["ID","TableID","ExplicitName","InferredName","ExplicitDataType","InferredDataType","DataCategory","Description","IsHidden","State","IsUnique","IsKey","IsNullable","Alignment","TableDetailPosition","IsDefaultLabel","IsDefaultImage","SummarizeBy","ColumnStorageID","Type","SourceColumn","ColumnOriginID","Expression","FormatString","IsAvailableInMDX","SortByColumnID","AttributeHierarchyID","ModifiedTime","StructureModifiedTime","RefreshedTime","SystemFlags","KeepUniqueRows","DisplayOrdinal","ErrorMessage","SourceProviderType","DisplayFolder","EncodingHint","RelatedColumnDetailsID","AlternateOfID","LineageTag","SourceLineageTag"]},"INFO.COLUMNSTORAGES":{columns:["ID","ColumnID","Name","StoragePosition","DictionaryStorageID","Settings","ColumnFlags","Collation","OrderByColumn","Locale","BinaryCharacters","Statistics_DistinctStates","Statistics_MinDataID","Statistics_MaxDataID","Statistics_OriginalMinSegmentDataID","Statistics_RLESortOrder","Statistics_RowCount","Statistics_HasNulls","Statistics_RLERuns","Statistics_OthersRLERuns","Statistics_Usage","Statistics_DBType","Statistics_XMType","Statistics_CompressionType","Statistics_CompressionParam","Statistics_EncodingHint","IsDeltaPartitionColumn","DeltaColumnMappingPhysicalName","DeltaColumnMappingId","FramedSourceColumn"]},"INFO.CULTURES":{columns:["ID","ModelID","Name","LinguisticMetadataID","ModifiedTime","StructureModifiedTime"]},"INFO.DATASOURCES":{columns:["ID","ModelID","Name","Description","Type","ConnectionString","ImpersonationMode","Account","Password","MaxConnections","Isolation","Timeout","Provider","ModifiedTime","ConnectionDetails","Options","Credential","ContextExpression"]},"INFO.DELTATABLEMETADATASTORAGES":{columns:["ID","PartitionStorageID","TableName","RootLocation","CurrentVersion","TableObjectID","DatamartObjectID","FramedSchemaName","FallbackReason"]},"INFO.DETAILROWSDEFINITIONS":{columns:["ID","ObjectID","ObjectType","Expression","ModifiedTime","State","ErrorMessage"]},"INFO.DICTIONARYSTORAGES":{columns:["ID","ColumnStorageID","Type","DataType","DataVersion","BaseId","Magnitude","LastId","IsNullable","IsUnique","IsOperatingOn32","DictionaryFlags","StorageFileID","Size"]},"INFO.EXCLUDEDARTIFACTS":{columns:["ID","ObjectID","ObjectType","ArtifactType","Reference"]},"INFO.EXPRESSIONS":{columns:["ID","ModelID","Name","Description","Kind","Expression","ModifiedTime","QueryGroupID","ParameterValuesColumnID","MAttributes","LineageTag","SourceLineageTag"]},"INFO.EXTENDEDPROPERTIES":{columns:["ID","ObjectID","ObjectType","Name","Type","Value","ModifiedTime"]},"INFO.FORMATSTRINGDEFINITIONS":{columns:["ID","ObjectID","ObjectType","Expression","ModifiedTime","State","ErrorMessage"]},"INFO.FUNCTIONS":{columns:["FUNCTION_NAME","DESCRIPTION","PARAMETER_LIST","RETURN_TYPE","ORIGIN","INTERFACE_NAME","LIBRARY_NAME","DLL_NAME","HELP_FILE","HELP_CONTEXT","OBJECT","CAPTION","PARAMETERINFO","DIRECTQUERY_PUSHABLE","VISUAL_CALCULATIONS_INFO"]},"INFO.GENERALSEGMENTMAPSEGMENTMETADATASTORAGES":{columns:["ID","SegmentMapStorageID","RecordCount","Ordinal"]},"INFO.GROUPBYCOLUMNS":{columns:["ID","RelatedColumnDetailsID","GroupingColumnID","ModifiedTime"]},"INFO.HIERARCHIES":{columns:["ID","TableID","Name","Description","IsHidden","State","HierarchyStorageID","ModifiedTime","StructureModifiedTime","RefreshedTime","DisplayFolder","HideMembers","LineageTag","SourceLineageTag"]},"INFO.HIERARCHYSTORAGES":{columns:["ID","HierarchyID","Name","LevelDefinition","MaterializationType","StructureType","SystemTableID"]},"INFO.KPIS":{columns:["ID","MeasureID","Description","TargetDescription","TargetExpression","TargetFormatString","StatusGraphic","StatusDescription","StatusExpression","TrendGraphic","TrendDescription","TrendExpression","ModifiedTime"]},"INFO.LEVELS":{columns:["ID","HierarchyID","Ordinal","Name","Description","ColumnID","ModifiedTime","LineageTag","SourceLineageTag"]},"INFO.LINGUISTICMETADATA":{columns:["ID","CultureID","Content","ModifiedTime","ContentType"]},"INFO.MEASURES":{columns:["ID","TableID","Name","Description","DataType","Expression","FormatString","IsHidden","State","ModifiedTime","StructureModifiedTime","KPIID","IsSimpleMeasure","ErrorMessage","DisplayFolder","DetailRowsDefinitionID","DataCategory","LineageTag","SourceLineageTag"]},"INFO.MODEL":{columns:["ID","Name","Description","StorageLocation","DefaultMode","DefaultDataView","Culture","Collation","ModifiedTime","StructureModifiedTime","Version","DataAccessOptions","DefaultMeasureID","DefaultPowerBIDataSourceVersion","ForceUniqueNames","DiscourageImplicitMeasures","DataSourceVariablesOverrideBehavior","DataSourceDefaultMaxConnections","SourceQueryCulture","MAttributes"]},"INFO.OBJECTTRANSLATIONS":{columns:["ID","CultureID","ObjectID","ObjectType","Property","Value","ModifiedTime"]},"INFO.PARQUETFILESTORAGES":{columns:["ID","DeltaTableMetadataStorageID","Size","Location","CreatedVersion","DeletedVersion","RowgroupCount","Ordinal","ETag","DeletionVectorFileLocation","DeletionVectorBitmapOffset","DeletionVectorBitmapSize","DeletionVectorFileETag"]},"INFO.PARTITIONS":{columns:["ID","TableID","Name","Description","DataSourceID","QueryDefinition","State","Type","PartitionStorageID","Mode","DataView","ModifiedTime","RefreshedTime","SystemFlags","ErrorMessage","RetainDataTillForceCalculate","RangeStart","RangeEnd","RangeGranularity","RefreshBookmark","QueryGroupID","ExpressionSourceID","MAttributes"]},"INFO.PARTITIONSTORAGES":{columns:["ID","PartitionID","Name","StoragePosition","SegmentMapStorageID","DataObjectId","StorageFolderID"]},"INFO.PERSPECTIVECOLUMNS":{columns:["ID","PerspectiveTableID","ColumnID","ModifiedTime"]},"INFO.PERSPECTIVEHIERARCHIES":{columns:["ID","PerspectiveTableID","HierarchyID","ModifiedTime"]},"INFO.PERSPECTIVEMEASURES":{columns:["ID","PerspectiveTableID","MeasureID","ModifiedTime"]},"INFO.PERSPECTIVES":{columns:["ID","ModelID","Name","Description","ModifiedTime"]},"INFO.PERSPECTIVETABLES":{columns:["ID","PerspectiveID","TableID","IncludeAll","ModifiedTime"]},"INFO.PROPERTIES":{columns:["PropertyName","PropertyDescription","PropertyType","PropertyAccessType","IsRequired","Value"]},"INFO.QUERYGROUPS":{columns:["ID","ModelID","Folder","Description"]},"INFO.REFRESHPOLICIES":{columns:["ID","TableID","PolicyType","RollingWindowGranularity","RollingWindowPeriods","IncrementalGranularity","IncrementalPeriods","IncrementalPeriodsOffset","PollingExpression","SourceExpression"]},"INFO.RELATEDCOLUMNDETAILS":{columns:["ID","ColumnID","ModifiedTime"]},"INFO.RELATIONSHIPINDEXSTORAGES":{columns:["ID","RelationshipStorageID","IndexType","Flags","RecordCount","SecondaryRecordCount","StorageFolderID","StorageFileID","SystemTableID","SecondarySystemTableID"]},"INFO.RELATIONSHIPS":{columns:["ID","ModelID","Name","IsActive","Type","CrossFilteringBehavior","JoinOnDateBehavior","RelyOnReferentialIntegrity","FromTableID","FromColumnID","FromCardinality","ToTableID","ToColumnID","ToCardinality","State","RelationshipStorageID","RelationshipStorage2ID","ModifiedTime","RefreshedTime","SecurityFilteringBehavior"]},"INFO.RELATIONSHIPSTORAGES":{columns:["ID","RelationshipID","Name","DefinitionType","Cardinality","Flags","RelationshipIndexStorageID"]},"INFO.ROLEMEMBERSHIPS":{columns:["ID","RoleID","MemberName","MemberID","IdentityProvider","MemberType","ModifiedTime"]},"INFO.ROLES":{columns:["ID","ModelID","Name","Description","ModelPermission","ModifiedTime"]},"INFO.SEGMENTMAPSTORAGES":{columns:["ID","PartitionStorageID","Type","RecordCount","SegmentCount","RecordsPerSegment"]},"INFO.SEGMENTSTORAGES":{columns:["ID","ColumnPartitionStorageID","SegmentCount","StorageFileID"]},"INFO.STORAGEFILES":{columns:["ID","OwnerID","OwnerType","StorageFolderID","FileName"]},"INFO.STORAGEFOLDERS":{columns:["ID","OwnerID","OwnerType","Path"]},"INFO.STORAGETABLECOLUMNS":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","DIMENSION_NAME","ATTRIBUTE_NAME","TABLE_ID","COLUMN_ID","COLUMN_TYPE","COLUMN_ENCODING","DATATYPE","ISKEY","ISUNIQUE","ISNULLABLE","ISROWNUMBER","DICTIONARY_SIZE","DICTIONARY_ISPAGEABLE","DICTIONARY_ISRESIDENT","DICTIONARY_TEMPERATURE","DICTIONARY_LAST_ACCESSED"]},"INFO.STORAGETABLECOLUMNSEGMENTS":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","PARTITION_NAME","DIMENSION_NAME","TABLE_ID","COLUMN_ID","SEGMENT_NUMBER","TABLE_PARTITION_NUMBER","RECORDS_COUNT","ALLOCATED_SIZE","USED_SIZE","COMPRESSION_TYPE","BITS_COUNT","BOOKMARK_BITS_COUNT","VERTIPAQ_STATE","ISPAGEABLE","ISRESIDENT","TEMPERATURE","LAST_ACCESSED"]},"INFO.STORAGETABLES":{columns:["DATABASE_NAME","CUBE_NAME","MEASURE_GROUP_NAME","DIMENSION_NAME","TABLE_ID","TABLE_PARTITIONS_COUNT","HINT_TABLE_TYPE","ROWS_COUNT","RIVIOLATION_COUNT"]},"INFO.TABLEPERMISSIONS":{columns:["ID","RoleID","TableID","FilterExpression","ModifiedTime","State","ErrorMessage","MetadataPermission"]},"INFO.TABLES":{columns:["ID","ModelID","Name","DataCategory","Description","IsHidden","TableStorageID","ModifiedTime","StructureModifiedTime","SystemFlags","ShowAsVariationsOnly","IsPrivate","DefaultDetailRowsDefinitionID","AlternateSourcePrecedence","RefreshPolicyID","CalculationGroupID","ExcludeFromModelRefresh","LineageTag","SourceLineageTag"]},"INFO.TABLESTORAGES":{columns:["ID","TableID","Name","Version","Settings","RIViolationCount","StorageFolderID"]},"INFO.VARIATIONS":{columns:["ID","ColumnID","Name","Description","RelationshipID","DefaultHierarchyID","DefaultColumnID","IsDefault"]}},q=T(19194),i=function(){function l(a,u){this.inlineVariables=[],this._parameterContexts=[];var v=function(l){return!!l.matchObjects}(a)?a.matchObjects:a;if(this._homeContext=this,this._matchObjects=v,this.inlineVariables=[],this.filterExpressionState=0,this._parameterContexts=[],this._ephemeralContexts=[],!(a instanceof C)){var A=a;this._previousContext=A,this._homeContext=A.homeContext,this._earliestContext=A.earliestContext,this._earlierContext=A.earlierContext,this.currentTable=A.currentTable,this.groupByCurrentTable=A.groupByCurrentTable,this.inlineVariables=this.inlineVariables.concat(A.inlineVariables),this.filterExpressionState=A.filterExpressionState,u&&A.parameterContexts&&(this._parameterContexts=this._parameterContexts.concat(A.parameterContexts))}}return Object.defineProperty(l.prototype,"matchObjects",{get:function(){return this._matchObjects},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"homeContext",{get:function(){return this._homeContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"earlierContext",{get:function(){return this._earlierContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"earliestContext",{get:function(){return this._earliestContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ephemeralContexts",{get:function(){return this._ephemeralContexts},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"parameterContexts",{get:function(){return this._parameterContexts},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"variables",{get:function(){return D.Sy.union(this.matchObjects.variables,this.inlineVariables,ye)},enumerable:!1,configurable:!0}),l.prototype.getTablesInScopeForQualifiedColRefs=function(){return this.getTablesInScopeForQualifiedColRefsEx(void 0,R.Yl.None.columnReferenceScope)},l.prototype.getAllTablesInScopeForQualifiedColRefs=function(){return _.union(this.getTablesInScopeForQualifiedColRefs(),_.flatten(_.map(this.ephemeralContexts,function(a){return a.getTablesInScopeForQualifiedColRefs()})))},l.prototype.getSimpleColumnRefsInScope=function(){return this.getSimpleColumnRefsInScopeEx(void 0,R.Yl.None.columnReferenceScope)},l.prototype.getAllSimpleColRefsInScope=function(){return this.getSimpleColumnRefsInScope().concat(_.flatten(_.map(this.ephemeralContexts,function(a){return a.getSimpleColumnRefsInScope()})))},l.prototype.getAllTables=function(){var a=this.matchObjects.tables;return this.currentTable&&(a=a.concat(this.currentTable.constructedTables)),a.concat(_.chain(this.ephemeralContexts).filter(function(u){return!!u.currentTable}).map(function(u){return u.currentTable.constructedTables}).flatten().value())},l.prototype.getTablesInScopeForQualifiedColRefsEx=function(a,u){if(a||(a=this.currentTable),u===R.Yl.None.columnReferenceScope)switch(this.filterExpressionState){case 1:u=18;break;case 0:case 2:u=3}var v=[];if(D.G.hasFlag(u,16))v=_.union(v,this.matchObjects.tables);else{if(D.G.hasFlag(u,1)&&null!=a&&(v=_.union(v,a.immediateTables)),D.G.hasFlag(u,32)){var A=this.homeContext.currentTable;null!=A&&(v=_.union(v,A.immediateTables))}D.G.hasFlag(u,4)&&null!=a&&(v=_.union(v,a.relatedTables))}return D.G.hasFlag(u,2)&&null!=a&&(v=_.union(v,_.filter(a.constructedTables,function(Z){return!D.uI.isNullOrEmpty(Z.name)}))),v},l.prototype.getSimpleColumnRefsInScopeEx=function(a,u){var v=u;if(a||(a=this.currentTable),u===R.Yl.None.columnReferenceScope||64===u)switch(this.filterExpressionState){case 1:case 2:u=18;break;case 0:u=3}var A=[];if(D.G.hasFlag(u,1)&&null!=a)for(var Z=0,he=a.immediateTables;Z<he.length;Z++)A=A.concat(he[Z].columns);if(D.G.hasFlag(u,32)){var Ee=this.homeContext.currentTable;if(null!=Ee)for(var ge=0,we=Ee.immediateTables;ge<we.length;ge++)A=A.concat(we[ge].columns)}if(D.G.hasFlag(u,8)&&null!=a)for(var Ne=0,Ae=a.relatedTables;Ne<Ae.length;Ne++)A=A.concat(Ae[Ne].columns);if(D.G.hasFlag(u,2)&&null!=a)for(var Ve=0,Ge=a.constructedTables;Ve<Ge.length;Ve++)A=A.concat(Ge[Ve].columns);if(!D.G.hasFlag(v,64))for(var ke=0,Ze=this.matchObjects.transparentTables;ke<Ze.length;ke++)A=A.concat(Ze[ke].columns);return A},l.prototype.isReservedWord=function(a){return l.isReservedWord(a,this.matchObjects.reservedWords,this.matchObjects.functions)},l.isReservedWord=function(a,u,v){return!(!a||!_.has(u,a.toUpperCase())&&!_.find(v,function(A){return D.uI.equalIgnoreCase(A.name,a)}))},l.prototype.newTableScan=function(){for(this._earlierContext=this._previousContext,this._earliestContext=this.earlierContext;null!=this.earliestContext.earlierContext;this._earliestContext=this.earliestContext.earlierContext);},l.prototype.mergeInlineVariables=function(a){_.remove(this.inlineVariables,function(u){return _.some(a,function(v){return D.uI.equalIgnoreCase(v.name,u.name)})}),this.inlineVariables=this.inlineVariables.concat(a)},l}(),W=function(){function l(a,u,v,A){this.context=a,this._currentTable=u,this._role=v,this._enumValues=A}return Object.defineProperty(l.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"allowedTypes",{get:function(){return this.role.type},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"currentTable",{get:function(){return this._currentTable},enumerable:!1,configurable:!0}),l.prototype.getTablesInScopeForQualifiedColRefs=function(){return this.context.getTablesInScopeForQualifiedColRefsEx(this.currentTable,this.role.columnReferenceScope)},l.prototype.getSimpleColumnRefsInScope=function(){return this.context.getSimpleColumnRefsInScopeEx(this.currentTable,this.role.columnReferenceScope)},l}(),C=function(){function l(a,u,v,A,Z,he,ue,Ee){this._tables=a,this._columns=u,this._measures=v,this._calendars=A,this.reservedWords=he,this.transparentTables=ue,this.visibleColumnMap={},this.visibleTableMap={},this.definedVarMap={},this.visibleMeasureMap={},this.definedMeasureMap={},this.functionMap={},this.axisMap={},this.calendarMap={},this.unhideAll();for(var ge=0,we=Z;ge<we.length;ge++){var Ne=we[ge];this.functionMap[m.getMatchObjectKey(Ne.name)]=Ne}for(var Ae=0,Ve=Ee;Ae<Ve.length;Ae++){var Ge=Ve[Ae];this.axisMap[b.getMatchObjectKey(Ge.name)]=Ge}for(var ke=0,Ze=this._calendars;ke<Ze.length;ke++){var ct=Ze[ke];this.calendarMap[ct.matchObjectKey]=ct}}return Object.defineProperty(l.prototype,"axes",{get:function(){return Object.values(this.axisMap)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"tables",{get:function(){return Object.values(this.visibleTableMap)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"columns",{get:function(){return Object.values(this.visibleColumnMap)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"functions",{get:function(){return Object.values(this.functionMap)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"measures",{get:function(){return Object.values((0,x.pi)((0,x.pi)({},this.definedMeasureMap),this.visibleMeasureMap))},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"variables",{get:function(){return Object.values(this.definedVarMap)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"calendars",{get:function(){return Object.values(this.calendarMap)},enumerable:!1,configurable:!0}),l.prototype.hideTable=function(a){delete this.visibleTableMap[a.matchObjectKey];for(var u=0,v=Object.entries(this.visibleColumnMap);u<v.length;u++){var A=v[u],Z=A[0];A[1].table===a&&delete this.visibleColumnMap[Z]}for(var ue=0,Ee=Object.entries(this.visibleMeasureMap);ue<Ee.length;ue++){var ge=Ee[ue];Z=ge[0],ge[1].table===a&&delete this.visibleMeasureMap[Z]}},l.prototype.hideColumn=function(a){delete this.visibleColumnMap[a.matchObjectKey]},l.prototype.hideMeasure=function(a){delete this.visibleMeasureMap[a.matchObjectKey]},l.prototype.unhideAll=function(){for(var a=0,u=this._tables;a<u.length;a++){var v=u[a];this.visibleTableMap[v.matchObjectKey]=v}for(var A=0,Z=this._columns;A<Z.length;A++){var he=Z[A];this.visibleColumnMap[he.matchObjectKey]=he}for(var ue=0,Ee=this._measures;ue<Ee.length;ue++){var ge=Ee[ue];this.visibleMeasureMap[ge.matchObjectKey]=ge}for(var we=0,Ne=this._tables;we<Ne.length;we++)Ne[we].unhideAll()},l.prototype.clearDefinedMeasures=function(){this.definedMeasureMap={};for(var a=0,u=this.tables;a<u.length;a++)u[a].clearDefinedMeasures()},l.prototype.clearDefinedVariables=function(){this.definedVarMap={}},l.prototype.chooseFunctions=function(a){for(var u=0,v=Object.entries(this.functionMap);u<v.length;u++){var A=v[u],Z=A[0];a(A[1])||delete this.functionMap[Z]}},l.prototype.mergeMeasures=function(a){for(var u=0,v=a;u<v.length;u++){var A=v[u];this.definedMeasureMap[A.matchObjectKey]||(this.definedMeasureMap[A.matchObjectKey]=A)}},l.prototype.removeDefinedMeasure=function(a,u){var v=E.getMatchObjectKey(u,a);delete this.definedMeasureMap[v]},l.prototype.mergeVariables=function(a){for(var u=0,v=a;u<v.length;u++){var A=v[u];this.definedVarMap[A.matchObjectKey]||(this.definedVarMap[A.matchObjectKey]=A)}},l.prototype.removeDefinedVariable=function(a){var u=pe.getMatchObjectKey(a,!0);delete this.definedVarMap[u]},l.prototype.findAxis=function(a){return this.axisMap[b.getMatchObjectKey(a)]},l.prototype.findTable=function(a){return this.visibleTableMap[xe.getMatchObjectKey(a)]},l.prototype.findFunction=function(a){return this.functionMap[m.getMatchObjectKey(a)]},l.prototype.findVariable=function(a){var u=pe.getMatchObjectKey(a,!0);return this.definedVarMap[u]},l.prototype.findCalendar=function(a){return this.calendarMap[te.getMatchObjectKey(a)]},l}(),oe=function(){function l(a,u){this._name=a,this._description=u}return Object.defineProperty(l.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),l.prototype.toString=function(){return this.name},l.prototype.getHashCode=function(){return this.name},l}(),ve=function(){return function(){this.constructedTables=[],this.immediateTables=[],this.relatedTables=[]}}(),B=function(l){function a(u){return l.call(this,u,void 0)||this}return(0,x.ZT)(a,l),a}(oe),b=function(l){function a(u){var v=l.call(this,u,void 0)||this;return v.matchObjectKey=a.getMatchObjectKey(u),v}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u){return u.toLowerCase()},Object.defineProperty(a.prototype,"description",{get:function(){return"rows"===this.name.toLowerCase()?q.m.localizedStrings.rowsDescription:"columns"===this.name.toLowerCase()?q.m.localizedStrings.columnsDescription:"rows columns"===this.name.toLowerCase()?q.m.localizedStrings.rowsColumnsDescription:"columns rows"===this.name.toLowerCase()?q.m.localizedStrings.columnsRowsDescription:""},enumerable:!1,configurable:!0}),a}(oe),te=function(l){function a(u,v){var A=l.call(this,u,void 0)||this;return A._table=v,A.matchObjectKey=a.getMatchObjectKey(u),A}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u){return u.toLowerCase()},Object.defineProperty(a.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),a}(oe),pe=function(l){function a(u,v,A){void 0===A&&(A=!1);var Z=l.call(this,u,void 0)||this;return Z.variableNode=v,Z._isQueryScoped=A,Z.matchObjectKey=a.getMatchObjectKey(u,A),Z}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u,v){return"".concat(u.toLowerCase(),":").concat(v)},Object.defineProperty(a.prototype,"value",{get:function(){return this.variableNode&&this.variableNode.value},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isQueryScoped",{get:function(){return this._isQueryScoped},enumerable:!1,configurable:!0}),a}(oe);function ye(l,a){return l===a||D.uI.equalIgnoreCase(l.name,a.name)}function Me(l,a){return l===a||D.uI.equalIgnoreCase(l.name,a.name)}var xe=function(l){function a(u,v,A,Z,he,ue){void 0===Z&&(Z=u),void 0===he&&(he=!1),void 0===ue&&(ue=!0);var Ee=l.call(this,u,v)||this;return Ee.visibleColumnMap={},Ee.visibleMeasureMap={},Ee.definedMeasureMap={},Ee._uberTable=new ve,Ee._uberTable.immediateTables.push(Ee),Ee._quoteNeeded=A,Ee._tableId=Z,Ee._columnMap={},Ee._measureMap={},Ee._calendarMap={},Ee._isTransparent=he,Ee._isUserTable=ue,Ee.matchObjectKey=a.getMatchObjectKey(u),Ee.unhideAll(),Ee}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u){return u.toLowerCase()},Object.defineProperty(a.prototype,"isTransparent",{get:function(){return this._isTransparent},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"quoteNeeded",{get:function(){return this._quoteNeeded},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uberTable",{get:function(){return this._uberTable},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tableId",{get:function(){return this._tableId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"columns",{get:function(){return this.visibleColumns},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"measures",{get:function(){return Object.values((0,x.pi)((0,x.pi)({},this.definedMeasureMap),this.visibleMeasureMap))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"calendars",{get:function(){return Object.values((0,x.pi)({},this._calendarMap))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isUserTable",{get:function(){return this._isUserTable},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleColumns",{get:function(){return Object.values(this.visibleColumnMap)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleMeasures",{get:function(){return Object.values(this.visibleMeasureMap)},enumerable:!1,configurable:!0}),a.prototype.addColumn=function(u){this._columnMap[u.matchObjectKey]=u,this.visibleColumnMap[u.matchObjectKey]=u},a.prototype.addMeasure=function(u){this._measureMap[u.matchObjectKey]=u,this.visibleMeasureMap[u.matchObjectKey]=u},a.prototype.addCalendar=function(u){this._calendarMap[u.matchObjectKey]=u},a.prototype.hideColumn=function(u){delete this.visibleColumnMap[u.matchObjectKey]},a.prototype.hideMeasure=function(u){delete this.visibleMeasureMap[u.matchObjectKey]},a.prototype.unhideAll=function(){this.visibleColumnMap=(0,x.pi)({},this._columnMap),this.visibleMeasureMap=(0,x.pi)({},this._measureMap)},a.prototype.getAutoCompleteName=function(u){return u||this.quoteNeeded?D.LP.quote(this.name):this.name},a.prototype.clearDefinedMeasures=function(){this.definedMeasureMap={}},a.prototype.mergeDefinedMeasure=function(u){(0,I.hu)(u.isQueryScoped,"Should only be merging defined measures"),this.definedMeasureMap[u.matchObjectKey]||(this.definedMeasureMap[u.matchObjectKey]=u)},a.prototype.removeDefinedMeasure=function(u){var v=E.getMatchObjectKey(this.name,u);delete this.definedMeasureMap[v]},a.prototype.findColumn=function(u){var v=Fe.getMatchObjectKey(this.name,u);return this.visibleColumnMap[v]},a.prototype.findMeasure=function(u){var v=E.getMatchObjectKey(this.name,u),A=d.getMatchObjectKey(this.name,u);return this.definedMeasureMap[v]||this.visibleMeasureMap[A]},a}(oe),Fe=function(l){function a(u,v,A){var Z=l.call(this,u,v)||this;return Z._table=A,Z.matchObjectKey=a.getMatchObjectKey(A.name,u),Z}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u,v){return"".concat(u.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(a.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),a}(oe),me=function(l){function a(u,v){return l.call(this,u,v)||this}return(0,x.ZT)(a,l),a}(oe),Oe=function(){function l(a,u,v,A,Z,he,ue,Ee){this._name=a,this._type=u,this._repeatable=v,this._optional=A,this._repeatGroup=v?Z:-1,this._role=he,this._skippable=ue,this._enumValues=Ee}return Object.defineProperty(l.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"optional",{get:function(){return this._optional},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"repeatable",{get:function(){return this._repeatable},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"repeatGroup",{get:function(){return this._repeatGroup},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"skippable",{get:function(){return this._skippable},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"enumValues",{get:function(){return this._enumValues},enumerable:!1,configurable:!0}),l.prototype.getNameForPrototype=function(a){void 0===a&&(a=0);var u=this.optional,v=this.name;return this.repeatable&&(v+=a,a>1&&(u=!0)),u&&(v="[".concat(v,"]")),v},l}(),ie=function(l){function a(u,v,A,Z,he){void 0===he&&(he=[]);var ue=l.call(this,u,v)||this;return ue._returnType=A,ue._role=Z,ue._signatures=he,ue}return(0,x.ZT)(a,l),Object.defineProperty(a.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"signatures",{get:function(){return this._signatures},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"returnType",{get:function(){return this._returnType},enumerable:!1,configurable:!0}),a.prototype.getParamCount=function(u){return u?u.getParameterCount():0},a.prototype.getTableReturnValue=function(u,v){var A;switch(this.role){case 2:case 8194:if(v){A=new ve;for(var Z=this.getParamCount(v),he=0,ue=this.signatures;he<ue.length;he++)new Ce(u,ue[he],v,Z,A).iterate()}break;case 4:case 4096:case 12:case 16384:(0,I.hu)(!!re[this.name],"Function ".concat(this.name," does not have a schema defined.")),A=new ve;var ge=new xe("",void 0,!1);re[this.name].columns.forEach(function(we){ge.addColumn(new Fe(we,void 0,ge))}),A.immediateTables.push(ge);break;case 8:A=u.groupByCurrentTable}return A},a.prototype.getContextForParam=function(u,v,A){for(var Z,he=this.signatures.map(function(Ue){return new de(u,Ue,v,A)}),Ee=D.jl.getAllExploredStates(he).completedStates.filter(function(Ue){return Ue.prototypeParam<Ue.prototypeSignature.length}),ge=new i(u,!1),we=v.getParameter(A),Ne=!1,Ae=!1,Ve=0,Ge=Ee;Ve<Ge.length;Ve++){var ct=(ke=Ge[Ve]).prototypeSignature[ke.prototypeParam],rt=ct.role,tt=R.Rv.getTypes(rt,u),nt=!0;if(tt!==R.Yl.None.type&&(we.couldBeType({type:tt})||(nt=!1,Ne=!0)),nt){ke.paramContext.prototypeParam=ke.prototypeParam,ke.paramContext.skippedParameters=ke.skippedParameters,ge.parameterContexts.push(ke.paramContext);var dt=void 0,Je=rt.argumentContextAction;if(3===Je||1===Je||2===Je){var $e=ge.currentTable,We=ge.currentTable;(2===Je||3===Je)&&ke.extractedColumns.length>0?((We=new ve).constructedTables=We.constructedTables.concat(ke.extractedColumns),null!=$e&&(We.immediateTables=We.immediateTables.concat($e.immediateTables),We.relatedTables=We.relatedTables.concat($e.relatedTables),We.constructedTables=We.constructedTables.concat($e.constructedTables))):(1===Je||3===Je)&&null!=ke.extractedTable&&($e?((We=new ve).immediateTables=We.immediateTables.concat($e.immediateTables.concat(ke.extractedTable.immediateTables)),We.relatedTables=We.relatedTables.concat($e.relatedTables.concat(ke.extractedTable.relatedTables)),We.constructedTables=We.constructedTables.concat($e.constructedTables.concat(ke.extractedTable.constructedTables))):We=ke.extractedTable),We!==$e&&(ge.currentTable=We,ge.newTableScan())}else 4===Je?dt=ke.extractedTable:5===Je?ge.currentTable=void 0:6===Je?ge.currentTable=ge.earlierContext?ge.earlierContext.currentTable:void 0:7===Je&&(ge.currentTable=ge.earliestContext?ge.earliestContext.currentTable:void 0);if(D.G.hasFlag(rt.additionalBehaviors,1)&&(ge.groupByCurrentTable=ke.extractedTable),D.G.hasFlag(rt.additionalBehaviors,2)?ge.filterExpressionState=1:!_.isEqual(rt,R.Yl.None)&&!D.G.hasFlag(rt.type,1)&&(ge.filterExpressionState=0),D.G.hasFlag(rt.additionalBehaviors,4)&&(Z=ge.ephemeralContexts).push.apply(Z,_.chain(u.ephemeralContexts).filter(function(Ue){return!!(Ue.allowedTypes&R.XD)}).map(function(Ue){return new W(ge,Ue.currentTable,(0,x.pi)((0,x.pi)({},Ue.role),{type:R.XD}),Ue.enumValues)}).value()),tt!==R.Yl.None.type){var ht=R.Rv.transformRole(rt,u);ge.ephemeralContexts.push(new W(ge,dt,ht,D.G.hasFlag(ht.type,64)?ct.enumValues:void 0))}else Ae=!0}}if(0===ge.parameterContexts.length)for(var mt=0,Tt=Ee;mt<Tt.length;mt++){var ke;(ke=Tt[mt]).paramContext.prototypeParam=ke.prototypeParam,ge.parameterContexts.push(ke.paramContext)}return Ne&&0===ge.ephemeralContexts.length&&ge.ephemeralContexts.push(new W(ge,void 0,G.d.featureSwitches.useSkippableParams&&!Ae?R.Yl.InvalidParam:R.Yl.None,void 0)),ge},a.prototype.getDefaultPrototype=function(){for(var v="",A=0,Z=this.getPrototype(void 0);A<Z.length;A++){var he=Z[A];v+=he.text+he.separator}return v},a.prototype.getPrototype=function(u){var v=[];v.push({text:this.name+"(",separator:"",bold:!1});for(var Z=u?u.prototypeSignature:this.signatures[0],he=u?u.prototypeParam:-1,ue=Z.length,Ee=0,ge=0;ge<ue;){var we=Z[ge];if(we.repeatable){var Ne=void 0;for(Ne=ge+1;Ne<ue&&((Ae=Z[Ne]).repeatable&&Ae.repeatGroup===we.repeatGroup);Ne++);var Ve=0;u&&Ee<u.repeatCounts.length&&(Ve=u.repeatCounts[Ee]),Ee++;var Ge=he<Ne;if(Ge&&Ve++,Ve>0){if(Ve>1){for(var ke=ge;ke<Ne;ke++){var Ae=Z[ke];O(u?.skippedParameters,ke,0)||v.push({text:Ae.getNameForPrototype(1)+H.ft().listSeparator,separator:" ",bold:!1})}Ve>2&&v.push({text:"..."+H.ft().listSeparator,separator:" ",bold:!1})}for(;ge<Ne;ge++)we=Z[ge],!O(u?.skippedParameters,ge,Ve-1)&&v.push({text:we.getNameForPrototype(Ve)+H.ft().listSeparator,separator:" ",bold:ge===he});Ge&&v.push({text:"..."+H.ft().listSeparator,separator:" ",bold:!1})}else ge=Ne}else O(u?.skippedParameters,ge,0)||v.push({text:we.getNameForPrototype()+H.ft().listSeparator,separator:" ",bold:ge===he}),ge++}if(v.length>1){var Ze=_.last(v);v[v.length-1]={text:Ze.text.substr(0,Ze.text.length-H.ft().listSeparator.length),separator:"",bold:Ze.bold}}return v.push({text:")",separator:"",bold:!1}),v},a}(oe),M=function(){function l(){this.success=!1,this.badParam=-1,this.firstExtraParam=-1,this.incomplete=!1,this.associatedSignature=[]}return l.prototype.assessStatus=function(a,u,v,A){if(a<u)v<A.length?(this.badParam=Math.max(this.badParam,a),this.associatedSignature=A):this.firstExtraParam=Math.max(this.firstExtraParam,a);else{for(;v<A.length&&A[v].optional;v++);v<A.length?this.incomplete=!0:this.success=!0}},l.prototype.markSuccess=function(){this.success=!0},l}(),g=function(){function l(a,u){this.paramNumber=a,this.repeatCount=u}return l.prototype.equals=function(a){return!(this.paramNumber!==a.paramNumber||this.repeatCount!==a.repeatCount)},l}();function O(l,a,u){return!(!G.d.featureSwitches.useSkippableParams||!l?.find(function(v){return v.equals(new g(a,u))}))}var f=function(){function l(a){this.prototypeSignature=[],this.prototypeParam=a?a.prototypeParam:0,this.skippedParameters=a?_.toArray(a.skippedParameters):[],this._repeatCounts=a?_.toArray(a.repeatCounts):[]}return Object.defineProperty(l.prototype,"repeatCounts",{get:function(){return this._repeatCounts},enumerable:!1,configurable:!0}),l.prototype.equals=function(a){if(this.prototypeParam!==a.prototypeParam||this.repeatCounts.length!==a.repeatCounts.length)return!1;for(var u=0;u<this.repeatCounts.length;u++)if(this.repeatCounts[u]!==a.repeatCounts[u])return!1;if(G.d.featureSwitches.useSkippableParams){if(this.skippedParameters.length!==a.skippedParameters.length)return!1;for(u=0;u<this.skippedParameters.length;u++)if(!this.skippedParameters[u].equals(a.skippedParameters[u]))return!1}return!0},l}(),m=function(l){function a(u,v,A,Z,he,ue,Ee){var ge=l.call(this,u,v,he,ue,Ee)||this;return ge._category=A,ge._pushableToDirectQuery=Z,ge.matchObjectKey=a.getMatchObjectKey(u),ge}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u){return u.toLowerCase()},Object.defineProperty(a.prototype,"pushableToDirectQuery",{get:function(){return this._pushableToDirectQuery},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"category",{get:function(){return this._category},enumerable:!1,configurable:!0}),a.FUNCTIONS_SPECIAL_CALCULATE_FUNCTION_NAME="CALCULATE",a}(ie),d=function(l){function a(u,v,A,Z,he){void 0===he&&(he=!1);var ue=l.call(this,u,v,Z.returnType,Z.role,a.removeFirstParam(Z.signatures))||this;return ue._table=A,ue._isQueryScoped=he,ue.matchObjectKey=a.getMatchObjectKey(A.name,u),ue}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u,v){return"".concat(u.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(a.prototype,"isQueryScoped",{get:function(){return this._isQueryScoped},enumerable:!1,configurable:!0}),a.removeFirstParam=function(u){(0,I.mv)(1===u.length,"Expected exactly one parameter prototype");var v=_.toArray(u[0]);return v.shift(),[v]},Object.defineProperty(a.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),a}(ie),E=function(l){function a(u,v,A,Z,he){var ue=l.call(this,u,v,A,Z,!0)||this;return ue._measureExpressionNode=he,ue.matchObjectKey=a.getMatchObjectKey(A.name,u),ue}return(0,x.ZT)(a,l),a.getMatchObjectKey=function(u,v){return"".concat(u.toLowerCase(),":").concat(v.toLowerCase())},Object.defineProperty(a.prototype,"measureExpressionNode",{get:function(){return this._measureExpressionNode},enumerable:!1,configurable:!0}),a}(d),S=function(){function l(a,u){this.leadingTrivia=[],this.trailingTrivia=[],this._parent=a,this.cachedContext=u}return Object.defineProperty(l.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fullSpan",{get:function(){return X.X.fromTokens(this.firstDescendent.token,this.lastDescendent.token)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"tableValue",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"tableRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"qualifiedColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"filterColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"simpleColumnRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isDataTable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"string",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"tupleCardinality",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"axesRef",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isValidAxisValue",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isValidEnumValue",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"calendarRef",{get:function(){},enumerable:!1,configurable:!0}),l.prototype.getRolledUpColumns=function(a){},l.prototype.getChildFunctionName=function(){},l.prototype.couldBeType=function(a){return!1},Object.defineProperty(l.prototype,"context",{get:function(){return(!this.cachedContext||H.Mz.alwaysRebuildContext)&&this.parent&&(this.cachedContext=this.parent.getContextForChild(this)),this.cachedContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"segment",{get:function(){return X.X.fromTokens(this.firstDescendent.token,this.lastDescendent.token)},enumerable:!1,configurable:!0}),l.prototype.onParseComplete=function(){},l.prototype.onParseIncomplete=function(){},Object.defineProperty(l.prototype,"selfDescription",{get:function(){if(H.Mz.debugging){var u=this.constructor.name.toString();return _.endsWith(u,"Node")&&(u=u.substr(0,u.length-4)),u}},enumerable:!1,configurable:!0}),l.prototype.clearContext=function(){this.cachedContext=void 0},l.prototype.printSelf=function(a){},l.prototype.printSelfAndChildren=function(a){H.Mz.debugging&&(this.printSelf(a),this.printChildren(a+2))},l.prototype.printChildren=function(a){},l}(),F=function(l){function a(u,v){return l.call(this,u,v)||this}return(0,x.ZT)(a,l),Object.defineProperty(a.prototype,"tableValue",{get:function(){return this.getFromOnlyChild(function(v){return v.tableValue})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tableRef",{get:function(){return this.getFromOnlyChild(function(v){return v.tableRef})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"qualifiedColumnRef",{get:function(){return this.getFromOnlyChild(function(v){return v.qualifiedColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"simpleColumnRef",{get:function(){return this.getFromOnlyChild(function(v){return v.simpleColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"string",{get:function(){return this.getFromOnlyChild(function(v){return v.string})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isDataTable",{get:function(){return this.getFromOnlyChild(function(v){return v.isDataTable})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tupleCardinality",{get:function(){return this.getFromOnlyChild(function(v){return v.tupleCardinality})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"axesRef",{get:function(){return this.getFromOnlyChild(function(v){return v.axesRef})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isValidAxisValue",{get:function(){return this.getFromOnlyChild(function(v){return v.isValidAxisValue})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isValidEnumValue",{get:function(){return this.getFromOnlyChild(function(v){return v.isValidEnumValue})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"calendarRef",{get:function(){return this.getFromOnlyChild(function(v){return v.calendarRef})},enumerable:!1,configurable:!0}),a.prototype.getRolledUpColumns=function(u){return this.getFromOnlyChild(function(v){return v.getRolledUpColumns(u)})},a.prototype.getChildFunctionName=function(){return this.getFromOnlyChild(function(u){return u.getChildFunctionName()})},a.prototype.couldBeType=function(u){return this.getFromOnlyChild(function(v){return v.couldBeType(u)})},a}(S),K=function(l){function a(u,v,A){var Z=l.call(this,u,A)||this;return Z.types=_.isArray(v)?v:[v],Z}return(0,x.ZT)(a,l),Object.defineProperty(a.prototype,"leafPosition",{get:function(){return this._leafPosition},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"token",{get:function(){return this._leafPosition.token},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"path",{get:function(){return this._path},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"firstDescendent",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"lastDescendent",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valid",{get:function(){return!this.path||this.path.isValid},enumerable:!1,configurable:!0}),a.prototype.eatToken=function(u,v){if(this.leafPosition)return Y.R.NotHungry;for(var A=u.token,Z=!1,he=0,ue=this.types;he<ue.length;he++)if(A.matchesType(ue[he])){Z=!0;break}return Z||this.otherwiseMatchesToken(A)?(this._path=new U.q(v),this._leafPosition=u,this._leafPosition.addNode(this),Y.R.Yum):Y.R.Yuck},Object.defineProperty(a.prototype,"isValidEnumValue",{get:function(){var v=this,A=_.flatMap(this.context.ephemeralContexts,function(Z){return Z.enumValues}).filter(function(Z){return!!Z});return!_.isEmpty(A)&&_.some(A,function(Z){return D.uI.equalIgnoreCase(Z.name,v.token.getString())})},enumerable:!1,configurable:!0}),a.prototype.consolidatePath=function(){this._path=this.path.consolidatePath()},a.prototype.otherwiseMatchesToken=function(u){return!1},a}(S),ee=function(){function l(a){this._nodes=[],this._token=a}return Object.defineProperty(l.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"validNodes",{get:function(){return _.filter(this.nodes,function(u){return u.valid})},enumerable:!1,configurable:!0}),l.prototype.addNode=function(a){this.nodes.push(a)},l.prototype.rebindToken=function(a){this._token=a},Object.defineProperty(l.prototype,"isInParseTree",{get:function(){return _.some(this.nodes,function(u){return u.parent})},enumerable:!1,configurable:!0}),l}(),ne=function(){function l(a,u,v,A,Z){this.parentContext=a,this._prototypeSignature=u,this._actualParameters=v,this._actualParamMax=A,this._useMismatchedState=Z,this._useMismatchedState=Z,this._completedStates=[],this._incompleteStates=[]}return Object.defineProperty(l.prototype,"completedStates",{get:function(){return this._completedStates},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"incompleteStates",{get:function(){return this._incompleteStates},enumerable:!1,configurable:!0}),l.prototype.iterate=function(){var a=[],u=[];for(a.push(this.newIteration());;){var v=void 0;if(a.length>0)v=a.shift();else if(this._useMismatchedState&&0===this.completedStates.length){for(var A=void 0,Z=!1,he=0,ue=u;he<ue.length;he++){var Ee=ue[he];!A||Ee.actualParam>A.actualParam?(A=Ee,Z=!1):Ee.actualParam===A.actualParam&&(Z=!0)}u.length=0,A&&!Z&&(v=A).advanceParameter()}if(!v)break;v.iterate(a,u)?this.completedStates.push(v):this.incompleteStates.push(v)}},l.prototype.newIteration=function(){return new se(this)},l}(),se=function(){function l(a){this._actualParam=0,this._prototypeParam=0,this._skippedParameters=[],this._prototypeSignature=[],this.repeatStart=-1,this._repeated=!1,this.repeatGroup=-1,this.repeatCount=0,a instanceof l?(this.paramIter=a.paramIter,this._actualParam=a.actualParam,this._prototypeParam=a.prototypeParam,this._skippedParameters=a.skippedParameters?_.toArray(a.skippedParameters):[],this._prototypeSignature=a._prototypeSignature,this.repeatStart=a.repeatStart,this._repeated=a.repeated,this.repeatGroup=a.repeatGroup,this.repeatCount=a.repeatCount):(this.paramIter=a,this._prototypeSignature=a._prototypeSignature)}return Object.defineProperty(l.prototype,"actualParam",{get:function(){return this._actualParam},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"prototypeParam",{get:function(){return this._prototypeParam},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"skippedParameters",{get:function(){return this._skippedParameters},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"prototypeSignature",{get:function(){return this._prototypeSignature},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"repeated",{get:function(){return this._repeated},enumerable:!1,configurable:!0}),l.prototype.advanceParameter=function(){this._prototypeParam++,this._actualParam++},l.prototype.skipCurrentParameter=function(){this._skippedParameters.push(new g(this.prototypeParam,this.repeatCount)),this._prototypeParam++},l.prototype.iterate=function(a,u){for(var A,Z,he,v=this;;){if(this.repeatStart>-1&&(this.prototypeParam>=this.paramIter._prototypeSignature.length||this.paramIter._prototypeSignature[this.prototypeParam].repeatGroup!==this.repeatGroup)){if(this.repeat(),G.d.featureSwitches.useSkippableParams){if(this.skippedParameters.filter(function(Rt){return Rt.repeatCount===v.repeatCount}).length===this.paramIter._prototypeSignature.filter(function(Rt){return Rt.repeatGroup===v.repeatGroup}).length)return!1;this.repeatCount++}var ue=this.clone();ue.repeatStart=-1,ue._repeated=!1,ue.repeatCount=0,a.push(ue),this._repeated=!0,this._prototypeParam=this.repeatStart}if(this.prototypeParam>=this.paramIter._prototypeSignature.length)return this.actualParam===this.paramIter._actualParamMax;var Ee=this.paramIter._prototypeSignature[this.prototypeParam],ge=Ee.role,we=R.Rv.getTypes(ge,this.paramIter.parentContext);if(-1===this.repeatStart){if(Ee.optional&&Ee.repeatable){var Ne;for((Ne=this.clone())._prototypeParam++;Ne.prototypeParam<this.paramIter._prototypeSignature.length&&this.paramIter._prototypeSignature[Ne.prototypeParam].repeatGroup===Ee.repeatGroup;)Ne._prototypeParam++;Ne.newRepeatGroup(),a.push(Ne)}Ee.repeatable&&(this.repeatStart=this.prototypeParam,this.repeatGroup=Ee.repeatGroup,this.newRepeatGroup())}if(G.d.featureSwitches.useSkippableParams&&Ee.skippable&&((Ne=this.clone()).skipCurrentParameter(),a.push(Ne)),this.actualParam===this.paramIter._actualParamMax)return!0;var Ae=!1,Ve=this.paramIter._actualParameters.getParameter(this.actualParam);if(null==Ve)Ae=Ee.optional;else{var Ge=void 0;if(!Ae&&D.G.hasFlag(we,2)){var ke=Ve.getTableValue();(Ae=null!=ke)&&(this.handleTableValue(ge,ke),Ge=2)}if(!Ae&&D.G.hasFlag(we,4)){var Ze=Ve.getTableRef();(Ae=null!=Ze)&&(this.handleTableRef(ge,Ze),Ge=4)}var ct=!1,rt=void 0,tt=void 0,nt=void 0;if(this.prototypeParam>0&&(rt=O(this.skippedParameters,this.prototypeParam-1,this.repeatCount),nt=R.Rv.getTypes((tt=this.paramIter._prototypeSignature[this.prototypeParam-1]).role,this.paramIter.parentContext),rt&&D.G.hasFlag(nt,32)&&(we=24,ct=!0)),!Ae&&D.G.hasFlag(we,8)){var dt=Ve.getQualifiedColumnRef();(Ae=!!dt)&&(ct&&this.handleNewCol(tt.role,dt.table.name,dt.name,dt.table.quoteNeeded),this.handleQualifiedColRef(ge,dt),Ge=8)}if(!Ae&&D.G.hasFlag(we,16)){var Je=Ve.getSimpleColumnRef();(Ae=null!=Je)&&(ct&&this.handleNewCol(tt.role,Je.table.name,Je.name,Je.table.quoteNeeded),this.handleSimpleColRef(ge,Je),Ge=16)}if(!Ae&&D.G.hasFlag(we,32)){var $e=Ve.getString();if(Ae=!!$e){var We=void 0,ht={table:void 0,column:void 0};k.J.tryParseColumnReference($e,ht)?We=D.LP.quoteNeeded(ht.table,this.paramIter.parentContext):(ht.column=$e,ht.table="",We=!1),this.handleNewCol(ge,ht.table,ht.column,We),Ge=32}}if(!Ae&&D.G.hasFlag(we,2048)&&(Ae=null!=Ve.getString(),Ge=2048),!Ae&&we&R.e9){var mt=Ve.getRolledUpColumns({type:we});if(Ae=null!=mt)for(var Tt=0,Ue=mt;Tt<Ue.length;Tt++)this.handleSimpleColRef(ge,Ue[Tt]);Ge=we&R.e9}!Ae&&D.G.hasFlag(we,16384)&&(Ae="ORDERBY"===(null===(A=Ve.getChildFunctionName())||void 0===A?void 0:A.toUpperCase()))&&(Ge=16384),!Ae&&D.G.hasFlag(we,32768)&&(Ae="PARTITIONBY"===(null===(Z=Ve.getChildFunctionName())||void 0===Z?void 0:Z.toUpperCase()))&&(Ge=32768),!Ae&&D.G.hasFlag(we,524288)&&(Ae=Ve.hasValidAxisValue())&&(Ge=524288),!Ae&&D.G.hasFlag(we,65536)&&(Ae=Ve.hasValidAxisRef())&&(Ge=65536),!Ae&&D.G.hasFlag(we,131072)&&(Ae="MATCHBY"===(null===(he=Ve.getChildFunctionName())||void 0===he?void 0:he.toUpperCase()))&&(Ge=131072),Ve.isDataTable?!Ae&&D.G.hasFlag(we,4096)&&(Ae=!0,Ge=4096):(!Ae&&D.G.hasFlag(we,64)&&(Ae=Ve.hasValidEnumValue())&&(Ge=64),!Ae&&D.G.hasFlag(we,1)&&(Ae=!0,Ge=1),!Ae&&D.G.hasFlag(we,1048576)&&(Ae=null!=Ve.getCalendarRef())&&(Ge=1048576),we===R.Yl.None.type&&(Ae=!0)),Ae&&Ve.storeMatchedType({type:Ge})}if(!Ae)return this.paramIter._useMismatchedState&&u.push(this),!1;this.advanceParameter()}},l.prototype.repeat=function(){},l.prototype.newRepeatGroup=function(){},l.prototype.clone=function(){return new l(this)},l.prototype.handleTableValue=function(a,u){},l.prototype.handleTableRef=function(a,u){},l.prototype.handleQualifiedColRef=function(a,u){},l.prototype.handleSimpleColRef=function(a,u){},l.prototype.handleNewCol=function(a,u,v,A){},l}(),de=function(l){function a(u,v,A,Z){return l.call(this,u,v,A,Z,!0)||this}return(0,x.ZT)(a,l),a.prototype.newIteration=function(){return new be(this)},a}(ne),be=function(l){function a(u){var v=this;return u instanceof ne?((v=l.call(this,u)||this)._paramContext=new f,v._extractedColumns=[]):((v=l.call(this,u)||this)._paramContext=new f(u.paramContext),v._extractedTable=u.extractedTable,v._extractedColumns=u.extractedColumns.slice()),v._paramContext.prototypeSignature=v.prototypeSignature,v}return(0,x.ZT)(a,l),Object.defineProperty(a.prototype,"extractedColumns",{get:function(){return this._extractedColumns},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"paramContext",{get:function(){return this._paramContext},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"extractedTable",{get:function(){return this._extractedTable},enumerable:!1,configurable:!0}),a.prototype.repeat=function(){this.paramContext.repeatCounts[this.paramContext.repeatCounts.length-1]++},a.prototype.newRepeatGroup=function(){this.paramContext.repeatCounts.push(0)},a.prototype.clone=function(){return new a(this)},a.prototype.handleTableValue=function(u,v){this.checkExtractTable(u,v)},a.prototype.handleTableRef=function(u,v){this.checkExtractTable(u,v)},a.prototype.handleQualifiedColRef=function(u,v){this.checkExtractTable(u,v.table.uberTable),this.checkExtractColumn(u,function(){return N.isolatedClone(v)})},a.prototype.handleSimpleColRef=function(u,v){this.checkExtractColumn(u,function(){return N.isolatedClone(v)})},a.prototype.handleNewCol=function(u,v,A,Z){this.checkExtractColumn(u,function(){return N.buildIsolatedColumn(A,v,Z)})},a.prototype.checkExtractTable=function(u,v){D.G.hasFlag(u.argumentAction,4)&&(this._extractedTable=v)},a.prototype.checkExtractColumn=function(u,v){D.G.hasFlag(u.argumentAction,8)&&this._extractedColumns.push(v().table)},a}(se),Ce=function(l){function a(u,v,A,Z,he){var ue=l.call(this,u,v,A,Z,!1)||this;return ue.resultTable=he,ue}return(0,x.ZT)(a,l),a.prototype.newIteration=function(){return new Re(this,this.resultTable)},a}(ne),Re=function(l){function a(u,v){var A=this;return(A=l.call(this,u)||this)._resultTable=u instanceof a?u.resultTable:v,A}return(0,x.ZT)(a,l),Object.defineProperty(a.prototype,"resultTable",{get:function(){return this._resultTable},enumerable:!1,configurable:!0}),a.prototype.clone=function(){return new a(this)},a.prototype.handleTableValue=function(u,v){this.checkAddUberTableToResult(u,v)},a.prototype.handleTableRef=function(u,v){this.checkAddUberTableToResult(u,v)},a.prototype.handleQualifiedColRef=function(u,v){this.checkAddConstructedTableToResult(u,function(){return N.isolatedClone(v)})},a.prototype.handleSimpleColRef=function(u,v){this.checkAddConstructedTableToResult(u,function(){return N.isolatedClone(v)})},a.prototype.handleNewCol=function(u,v,A,Z){this.checkAddConstructedTableToResult(u,function(){return N.buildIsolatedColumn(A,v,Z)})},a.prototype.checkAddUberTableToResult=function(u,v){D.G.hasFlag(u.argumentAction,1)&&(!D.G.hasFlag(u.argumentAction,2)||!this.repeated)&&(this.resultTable.immediateTables=this.resultTable.immediateTables.concat(v.immediateTables),this.resultTable.relatedTables=this.resultTable.relatedTables.concat(v.relatedTables),this.resultTable.constructedTables=this.resultTable.constructedTables.concat(v.constructedTables))},a.prototype.checkAddConstructedTableToResult=function(u,v){D.G.hasFlag(u.argumentAction,1)&&(!D.G.hasFlag(u.argumentAction,2)||!this.repeated)&&this.resultTable.constructedTables.push(v().table)},a}(se),N=function(){function l(){}return l.buildIsolatedColumn=function(a,u,v){var A=new xe(u,void 0,v),Z=new Fe(a,void 0,A);return A.addColumn(Z),Z},l.isolatedClone=function(a){var u=this.isolatedCloneCore(a);if(a.table.variationSource){var v=this.isolatedCloneCore(a.table.variationSource);u.table.variationSource=v,v.variationTable=u.table}return u},l.isolatedCloneCore=function(a){return this.buildIsolatedColumn(a.name,a.table.name,a.table.quoteNeeded)},l}()},85616:function(Ke,Ie,T){T.d(Ie,{$Z:function(){return nt},Cm:function(){return Kt},DH:function(){return It},DU:function(){return Me},Ed:function(){return Ve},F0:function(){return C},Fc:function(){return _e},HI:function(){return $e},HV:function(){return u},Hf:function(){return be},IE:function(){return le},IS:function(){return Rt},Lj:function(){return Ue},N4:function(){return te},N9:function(){return Re},QB:function(){return Ce},R6:function(){return We},RZ:function(){return Ae},Sm:function(){return Oe},T0:function(){return Ze},TV:function(){return M},Ti:function(){return qe},U6:function(){return Ne},VW:function(){return K},Vu:function(){return ke},XN:function(){return Ot},Xg:function(){return N},ZH:function(){return l},ZQ:function(){return ye},_7:function(){return Ge},_L:function(){return H},_N:function(){return O},a$:function(){return Q},ai:function(){return v},dl:function(){return b},eV:function(){return i},et:function(){return ut},fA:function(){return q},fY:function(){return S},gR:function(){return zt},gi:function(){return je},gq:function(){return E},i8:function(){return g},ic:function(){return Ct},ig:function(){return Ee},jg:function(){return W},lg:function(){return Vt},mR:function(){return a},n1:function(){return Dt},pZ:function(){return A},q1:function(){return X},qS:function(){return ue},rI:function(){return bt},rL:function(){return m},rc:function(){return we},sB:function(){return dt},tw:function(){return Pt},u0:function(){return Pe},uA:function(){return mt},ub:function(){return f},vX:function(){return Je},xY:function(){return D},y3:function(){return F},yC:function(){return ee},yE:function(){return tt},ze:function(){return ge}});var x=T(81337),I=T(55863),G=T(20540),Y=T(66106),k=T(85402),R=T(58871),U=T(63513),H=function(V){function p(h,L){var J=V.call(this,h,L)||this;return J._children=[],J}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"filterColumnRef",{get:function(){if(1===this.context.filterExpressionState)for(var L=0,J=this._children;L<J.length;L++){var Be=J[L].filterColumnRef;if(Be)return Be}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"valid",{get:function(){return this._children[0].valid},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"firstDescendent",{get:function(){return this._children[0].firstDescendent},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastDescendent",{get:function(){var L=_.last(this._children);if(L)return L.lastDescendent},enumerable:!1,configurable:!0}),p.prototype.eatToken=function(h,L){for(var J=0,Te=this.getPotentialNextChildren();J<Te.length;J++){var Be=Te[J];if(Be.eatToken(h,L)===G.R.Yum)return this._children.push(Be),G.R.Yum}return this.isComplete?G.R.NotHungry:G.R.Yuck},p.prototype.getFromOnlyChild=function(h){return 1===this._children.length?h(this._children[0]):void 0},Object.defineProperty(p.prototype,"lastChild",{get:function(){return _.last(this._children)},enumerable:!1,configurable:!0}),p.prototype.getFromFirstChild=function(h){if(1===this._children.length)return h(this._children[0])},p.prototype.getContextForChild=function(h){var L=this.context,J=L;if(0!==J.ephemeralContexts.length&&h!==this.childWhichReceivesEphemeralContexts&&(J=new R.hK(J,!0)),1===J.filterExpressionState)for(var Te=0,Be=this._children;Te<Be.length;Te++){var ze=Be[Te];if(ze===h)break;ze.filterColumnRef&&(J===L&&(J=new R.hK(J,!0)),J.filterExpressionState=2,J.currentTable=ze.filterColumnRef.table.uberTable,J.newTableScan())}return J},Object.defineProperty(p.prototype,"childWhichReceivesEphemeralContexts",{get:function(){return this._children[0]},enumerable:!1,configurable:!0}),p.prototype.isFirstChild=function(h){return h===_.head(this._children)},p.prototype.isOnlyChild=function(h){return 1===this._children.length&&this.isFirstChild(h)},p.prototype.removeLaterChildren=function(h){for(var L=this._children.length-1;this._children[L]!==h;L--)(0,I.hu)(L>0,"iChild > 0"),this._children.splice(L,1)},p.prototype.printEarlierNodes=function(h){var L;L=this.parent?this.parent.printEarlierNodes(this):0,this.printSelf(L),L+=2;for(var J=0,Te=this._children;J<Te.length;J++){var Be=Te[J];if(Be===h)break;Be.printSelfAndChildren(L)}return L},p.prototype.printChildren=function(h){for(var L=0,J=this._children;L<J.length;L++)J[L].printSelfAndChildren(h)},p}(R.sN),X=function(V){function p(){var h=null!==V&&V.apply(this,arguments)||this;return h.prospectiveChildren=[],h}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"filterColumnRef",{get:function(){return this.getFromOnlyChild(function(L){return L.filterColumnRef})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"firstDescendent",{get:function(){return _.head(this.validChildren).firstDescendent},enumerable:!1,configurable:!0}),p.prototype.getFromOnlyChild=function(h){return this.child?h(this.child):void 0},Object.defineProperty(p.prototype,"children",{get:function(){return this.validChildren},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastDescendent",{get:function(){return _.head(this.validChildren).lastDescendent},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"valid",{get:function(){return _.some(this.validChildren)},enumerable:!1,configurable:!0}),p.prototype.setChild=function(h){(0,I.hu)(!this.child,"expected no existing child"),this.child=h},p.prototype.eatToken=function(h,L){if((0,I.hu)(null==this.child,"child == null"),_.some(this.prospectiveChildren))return G.R.NotHungry;for(var J=0,Te=this.getPotentialChildren();J<Te.length;J++){var Be=Te[J];Be.eatToken(h,L)===G.R.Yum&&this.prospectiveChildren.push(Be)}return this.prospectiveChildren.length>0?G.R.Yum:G.R.Yuck},Object.defineProperty(p.prototype,"validChildren",{get:function(){return this.child?[this.child]:_.filter(this.prospectiveChildren,function(L){return L.valid})},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return _.some(this.validChildren,function(L){return L.couldBeType(h)})},p.prototype.getContextForChild=function(h){return this.context},p.prototype.printEarlierNodes=function(h){var L;return L=this.parent?this.parent.printEarlierNodes(this):0,this.printSelf(L),L+2},p.prototype.printChildren=function(h){this.child&&this.child.printSelfAndChildren(h)},p.prototype.removeLaterChildren=function(h){this.child=void 0},p.prototype.isFirstChild=function(h){return!0},p.prototype.isOnlyChild=function(h){return!0},p}(R.sN),D=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialNextChildren=function(){var h;switch(this._children.length){case 0:h=new S(this);break;case 1:h=new M(this);break;case 2:h=new dt(this);break;case 3:h=new u(this);break;default:return[]}return[h]},Object.defineProperty(p.prototype,"isComplete",{get:function(){return 4===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"identifier",{get:function(){return this._children.length>1?(0,U.as)(this._children[1],M):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this._children.length>3?this._children[3]:void 0},enumerable:!1,configurable:!0}),p}(H),re=function(V){function p(h,L){var J=V.call(this,h)||this;return J._index=L,J}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),p.prototype.getPotentialChildren=function(){return[new u(this)]},p.prototype.getTableValue=function(){return this.tableValue},p.prototype.getTableRef=function(){return this.tableRef},p.prototype.getQualifiedColumnRef=function(){return this.qualifiedColumnRef},p.prototype.getSimpleColumnRef=function(){return this.simpleColumnRef},p.prototype.getString=function(){return this.string},p.prototype.hasValidAxisRef=function(){return U.LP.hasValidAxesReferences(this.axesRef)},p.prototype.hasValidAxisValue=function(){return this.isValidAxisValue},p.prototype.hasValidEnumValue=function(){return this.isValidEnumValue},p.prototype.couldBeType=function(h){return!(!U.G.hasFlag(h.type,64)&&!U.G.hasFlag(h.type,1))||V.prototype.couldBeType.call(this,h)},p.prototype.storeMatchedType=function(h){this.firstDescendent.token.matchedType=h},p.prototype.getCalendarRef=function(){return this.calendarRef},p}(X),q=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getContextForChild=function(h){return this.parent.getContextForParam(this,this.getParamIndex(h))},Object.defineProperty(p.prototype,"isComplete",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"parameterCount",{get:function(){return(0,I.hu)(this._children.length>0,"children.length > 0"),this.getParamIndex(this.lastChild)+1},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"parameters",{get:function(){for(var L=[],J=0;J<this.parameterCount;J++){var Te=this.getParameterByIndex(J);Te&&L.push(Te)}return L},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"allParametersIncludingUndefined",{get:function(){for(var L=[],J=0;J<this.parameterCount;J++){var Te=this.getParameterByIndex(J);L.push(Te)}return L},enumerable:!1,configurable:!0}),p.prototype.getParamIndex=function(h){return this.getParamIndexAndIsParameter(h).index},p.prototype.getSeparatorByIndex=function(h){var L=_.filter(this._children,function(J){return J instanceof l&&J.index===h});if(L.length>1)throw new Error("expected at most one parameter at index "+h);return(0,U.as)(L[0],l)},p.prototype.getParameterByIndex=function(h){var L=_.filter(this._children,function(J){return J instanceof re&&J.index===h});if(L.length>1)throw new Error("expected at most one parameter at index "+h);return(0,U.as)(L[0],re)},p.prototype.getParameterCount=function(){return this.parameterCount},p.prototype.getParameter=function(h){return this.getParameterByIndex(h)},p.prototype.getPotentialNextChildren=function(){var h=!1,L=0;if(this._children.length>0){var J=this.getParamIndexAndIsParameter(this.lastChild);L=J.index,h=J.isParameter}return h?[new l(this,L+1)]:[this.newParameterNode(L),new l(this,L+1)]},p.prototype.newParameterNode=function(h){return new re(this,h)},p.prototype.getParamIndexAndIsParameter=function(h){var L=(0,U.as)(h,re);return L?{index:L.index,isParameter:!0}:{index:h.index,isParameter:!1}},p}(H),Q=function(V){function p(h,L){return V.call(this,h,L)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialNextChildren=function(){return[this._children.length%2==0?this.getOperand():this.getOperator()]},Object.defineProperty(p.prototype,"isComplete",{get:function(){return this._children.length%2==1},enumerable:!1,configurable:!0}),p}(H),i=function(V){function p(h){return V.call(this,h,34)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"simpleColumnRef",{get:function(){var L=this.token;if(35!==L.type)return(0,U.as)(L.matchObject,R.XN)},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,16)},p}(R.a9),W=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new i(this),new It(this)]},Object.defineProperty(p.prototype,"bracketedIdentifier",{get:function(){var L=(0,U.as)(this.child,i);if(!L){var J=(0,U.as)(this.child,It);null!=J&&(L=J.bracketedIdentifier)}return L},enumerable:!1,configurable:!0}),p}(X),C=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new O(this)},p.prototype.getOperator=function(){return new R.a9(this,[9,10,11,12,15,16,17])},p}(Q),oe=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new Ot(this),new Je(this),new ct(this),new mt(this)]},p}(X),ve=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new M(this),new Ot(this),new Je(this),new ct(this),new rt(this),new mt(this)]},p}(X),B=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new $e(this)];var h=this.lastChild;return h instanceof $e||h instanceof l?[new ve(this),new l(this,0),new tt(this)]:h instanceof ve?[new l(this,0),new tt(this)]:[]},p}(H),b=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p}(D),te=function(V){function p(h){var L=V.call(this,h)||this;return L.query=h,L}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this._children.length>=2},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){return 0===this._children.length?[new d(this)]:[new A(this),new b(this)]},p.prototype.getContextForChild=function(h){var L=this.addDefinedMeasuresToMatchObjects();this.context.matchObjects.mergeMeasures(L);var J=this.createDefinedVariables();return this.context.matchObjects.mergeVariables(J),this.context},p.prototype.removeLaterChildren=function(h){var L=this.removeDefinedMeasuresFromMatchObjectsAfter(h),J=this.removeDefinedVariablesAfter(h);(L||J)&&(this.query.isInvalidated=!0),this.isComplete||(this.query.isInvalidated=!0),V.prototype.removeLaterChildren.call(this,h)},p.prototype.removeDefinedVariablesAfter=function(h){for(var L=!1,J=U.Sy.skipWhile(this._children,function(lt){return lt!==h}).slice(1),Te=0,Be=U.Sy.ofType(J,b);Te<Be.length;Te++){var ze=Be[Te];ze.identifier&&(this.context.matchObjects.removeDefinedVariable(ze.identifier.token.getString()),L=!0)}return L},p.prototype.removeDefinedMeasuresFromMatchObjectsAfter=function(h){for(var L=!1,J=U.Sy.skipWhile(this._children,function(wt){return wt!==h}).slice(1),Te=0,Be=U.Sy.ofType(J,A);Te<Be.length;Te++){var ze=Be[Te];if(ze.measureDef){var lt=this.context.matchObjects.findTable(ze.measureDef.tableName);null!=lt&&(lt.removeDefinedMeasure(ze.measureDef.identifier),this.context.matchObjects.removeDefinedMeasure(ze.measureDef.identifier,ze.measureDef.tableName),L=!0)}}return L},p.prototype.createDefinedVariables=function(){var h=_.chain(U.Sy.ofType(this._children,b)).filter(function(L){return L.identifier}).map(this.createVariable).value();return _.some(h)&&(this.query.isInvalidated=!0),h},p.prototype.createVariable=function(h){return new R.yB(h.identifier.token.getString(),h,!0)},p.prototype.addDefinedMeasuresToMatchObjects=function(){for(var h=[],L=0,J=_.filter(U.Sy.ofType(this._children,A),function(ze){return ze.isComplete});L<J.length;L++){var Te=J[L],Be=this.context.matchObjects.findTable(Te.measureDef.tableName);Be&&h.push(this.createMeasure(Te,Be))}return _.some(h)&&(this.query.isInvalidated=!0),h},p.prototype.createMeasure=function(h,L){var J=new R.Nr(h.measureDef.identifier,h.measureDef.identifier,L,this.context.matchObjects.findFunction("CALCULATE"),h);return L.mergeDefinedMeasure(J),J},p}(H),pe=function(V){function p(h){return V.call(this,h,[40,60])||this}return(0,x.ZT)(p,V),p}(R.a9),le=function(V){function p(h,L){var J=V.call(this,void 0,0,L)||this;return J._leafPosition=h,J}return(0,x.ZT)(p,V),p}(R.a9),ye=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new u(this)]},p}(X),Pe=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){var L=this.daxFunctionBase;return L&&L.getTableReturnValue(this.context,this.parameterList)},enumerable:!1,configurable:!0}),p.prototype.getRolledUpColumns=function(h){var L=this;if(this.functionMatchesType(h.type)&&this.parameterList)return _.chain(this.parameterList.parameters).map(function(J){var Te=J.getRolledUpColumns({type:Y.e9});if(Te)return Te;var Be=J.qualifiedColumnRef||J.simpleColumnRef;if(Be)return[Be];if((L.functionMatchesType(256)||L.functionMatchesType(512))&&J.couldBeType({type:32})){var ze=new R.S2("",void 0,!1);return[new R.XN(J.string,"",ze)]}return[]}).flatten().value()},p.prototype.couldBeType=function(h){return this.functionMatchesType(h.type)},p.prototype.functionMatchesType=function(h){var L=this.daxFunctionBase;return!!L&&(16===L.role&&U.G.hasFlag(h,128)||32===L.role&&U.G.hasFlag(h,256)||64===L.role&&U.G.hasFlag(h,512)||128===L.role&&U.G.hasFlag(h,1024)||512===L.role&&U.G.hasFlag(h,16384)||12===L.role&&U.G.hasFlag(h,2)||4===L.role&&U.G.hasFlag(h,2)||4096===L.role&&U.G.hasFlag(h,2)||16384===L.role&&U.G.hasFlag(h,2)||2===L.role&&U.G.hasFlag(h,2)||U.G.hasFlag(L.role,8192)&&U.G.hasFlag(h,524288)||256===L.role&&(U.G.hasFlag(h,4)||U.G.hasFlag(h,2)||U.G.hasFlag(h,1)||U.G.hasFlag(h,2048)))},p.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[this.getPotentialFirstChild()];if(1===this._children.length)return[new We(this)];var h=this.lastChild;return h instanceof We?[this.newParamList(),new nt(this)]:h instanceof q?[new nt(this)]:[]},p.prototype.newParamList=function(){return new q(this)},Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof nt},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"leftParen",{get:function(){return this._children.length>1?(0,U.as)(this._children[1],We):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"parameterList",{get:function(){return this._children.length>2?(0,U.as)(this._children[2],q):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"rightParen",{get:function(){var L=this._children.length>3?(0,U.as)(this._children[3],nt):void 0;return L||(L=this._children.length>2?(0,U.as)(this._children[2],nt):void 0),L},enumerable:!1,configurable:!0}),p.prototype.getChildFunctionName=function(){var h;return null===(h=this.functionNode)||void 0===h?void 0:h.segment.text},Object.defineProperty(p.prototype,"daxFunctionBase",{get:function(){var L=this.functionNode;if(L)return(0,U.as)(L.token.matchObject,R.eL)},enumerable:!1,configurable:!0}),p.prototype.getContextForParam=function(h,L){var J=this.daxFunctionBase;return J?J.getContextForParam(this.context,h,L):this.context},Object.defineProperty(p.prototype,"isValidAxisValue",{get:function(){var L=this.daxFunctionBase;return!!L&&U.G.hasFlag(L.role,8192)},enumerable:!1,configurable:!0}),p}(H),Me=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"functionNode",{get:function(){return(0,U.as)(this._children[0],R.a9)},enumerable:!1,configurable:!0}),p.prototype.getPotentialFirstChild=function(){return new M(this)},p}(Pe),xe=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){var L,J;return null===(J=null===(L=this.parameterList)||void 0===L?void 0:L.parameters[0])||void 0===J?void 0:J.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableRef",{get:function(){var L,J;return null===(J=null===(L=this.parameterList)||void 0===L?void 0:L.parameters[0])||void 0===J?void 0:J.tableRef},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"string",{get:function(){var L,J;return null===(J=null===(L=this.parameterList)||void 0===L?void 0:L.parameters[0])||void 0===J?void 0:J.string},enumerable:!1,configurable:!0}),p.prototype.getPotentialFirstChild=function(){return new Tt(this)},p.prototype.getContextForParam=function(h,L){var J=this.daxFunctionBase;if(J&&0!==L)return J.getContextForParam(this.context,h,L);for(var Te=new R.hK(this.context,!1),Be=0,ze=this.context.ephemeralContexts;Be<ze.length;Be++){var lt=ze[Be];Te.ephemeralContexts.push(new R.xE(Te,lt.currentTable,(0,x.pi)((0,x.pi)({},lt.role),{type:7&lt.role.type}),lt.enumValues))}return Te},p}(Me),Fe=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"functionNode",{get:function(){return(0,U.as)(_.head(this._children),R.a9)},enumerable:!1,configurable:!0}),p.prototype.getPotentialFirstChild=function(){return new ne(this)},p.prototype.newParamList=function(){return new ie(this)},p}(Pe),me=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isDataTable",{get:function(){return!0},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,4096)},p.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new $e(this)];var h=this.lastChild;return h instanceof $e||h instanceof l?[new B(this)]:h instanceof B?[new l(this,0),new tt(this)]:[]},p}(H),Oe=function(V){function p(h,L){return V.call(this,h,L)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new Ot(this),new M(this),new me(this)]},p}(re),ie=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.newParameterNode=function(h){return new Oe(this,h)},p}(q),M=function(V){function p(h){return V.call(this,h,58)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){if(this.token){var L=this.token.matchObject,J=(0,U.as)(L,R.S2);if(J)return J.uberTable;var Te=(0,U.as)(L,R.yB);if(Te&&Te.value)return Te.value.tableValue}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableRef",{get:function(){return this.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"axesRef",{get:function(){if(this.token){var L=(0,U.as)(this.token.matchObject,R.cr);if(L)return[L]}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"calendarRef",{get:function(){if(this.token){var L=(0,U.as)(this.token.matchObject,R.Df);if(L)return L}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isValidAxisValue",{get:function(){return U.LP.hasValidAxesReferences(this.axesRef)},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return!!(U.G.hasFlag(h.type,2)||U.G.hasFlag(h.type,4)||U.G.hasFlag(h.type,8)||U.G.hasFlag(h.type,16)||U.G.hasFlag(h.type,16384)||U.G.hasFlag(h.type,32768)||U.G.hasFlag(h.type,65536)||U.G.hasFlag(h.type,524288)||U.G.hasFlag(h.type,131072)||60===this.token.type&&(U.G.hasFlag(h.type,32)||U.G.hasFlag(h.type,2048)||U.G.hasFlag(h.type,4096)))},p.prototype.otherwiseMatchesToken=function(h){return h.isKeyword&&h.activelyEdited},p}(R.a9),g=function(V){function p(h,L){var J=V.call(this,void 0,0,L)||this;return J._leafPosition=h,J}return(0,x.ZT)(p,V),p}(R.a9),O=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"firstChildCouldBeTuple",{get:function(){return this._children.length>=2||!this.parseComplete},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"invalidRightArgument",{get:function(){if(!(this._children.length<3)&&this.parseComplete){var L=this._children[2];if(!L.tableValue)return L}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 1===this._children.length||3===this._children.length},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Rt(this)];case 1:return[new Re(this)];case 2:return[new p(this)];default:return[]}},p.prototype.onParseComplete=function(){this.parseComplete=!0},p.prototype.onParseIncomplete=function(){this.parseComplete=!1},p}(H),f=function(V){function p(h,L,J){var Te=V.call(this,h,L)||this;return Te.keyword=J,Te}return(0,x.ZT)(p,V),p.prototype.otherwiseMatchesToken=function(h){return h.isIdentifierOrKeyword&&h.activelyEdited&&U.uI.startsWithIgnoreCase(this.keyword,h.getString())},p}(R.a9),m=function(V){function p(h){return V.call(this,h,52,"at")||this}return(0,x.ZT)(p,V),p}(f),d=function(V){function p(h){return V.call(this,h,53,"define")||this}return(0,x.ZT)(p,V),p}(f),E=function(V){function p(h){return V.call(this,h,54,"measure")||this}return(0,x.ZT)(p,V),p}(f),S=function(V){function p(h){return V.call(this,h,42,"var")||this}return(0,x.ZT)(p,V),p}(f),F=function(V){function p(h){return V.call(this,h,43,"return")||this}return(0,x.ZT)(p,V),p}(f),K=function(V){function p(h){return V.call(this,h,44,"not")||this}return(0,x.ZT)(p,V),p}(f),ee=function(V){function p(h){return V.call(this,h,45,"evaluate")||this}return(0,x.ZT)(p,V),p}(f),ne=function(V){function p(h){return V.call(this,h,46,"datatable")||this}return(0,x.ZT)(p,V),p}(f),se=function(V){function p(h){return V.call(this,h,47,"order")||this}return(0,x.ZT)(p,V),p}(f),de=function(V){function p(h){return V.call(this,h,48,"by")||this}return(0,x.ZT)(p,V),p}(f),be=function(V){function p(h){return V.call(this,h,49,"asc")||this}return(0,x.ZT)(p,V),p}(f),Ce=function(V){function p(h){return V.call(this,h,50,"desc")||this}return(0,x.ZT)(p,V),p}(f),Re=function(V){function p(h){return V.call(this,h,55,"in")||this}return(0,x.ZT)(p,V),p}(f),N=function(V){function p(h){return V.call(this,h,51,"start")||this}return(0,x.ZT)(p,V),p}(f),l=function(V){function p(h,L){var J=V.call(this,h,27)||this;return J._index=L,J}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),p}(R.a9),a=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new be(this),new Ce(this)]},Object.defineProperty(p.prototype,"isValidEnumValue",{get:function(){return!0},enumerable:!1,configurable:!0}),p}(X),u=function(V){function p(h,L){return V.call(this,h,L)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new qe(this)},p.prototype.getOperator=function(){return new R.a9(this,[13,14])},p}(Q),v=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"identifier",{get:function(){if(!(this._children.length<2)){var L=(0,U.as)(this._children[1],i);return L?L.token.getIdentifier():void(0,I.sr)("Unexpected node type: "+this._children[1].constructor)}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableRefNode",{get:function(){return this._children.length>0?(0,U.as)(this._children[0],Dt):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableName",{get:function(){if(this.tableRefNode)return this.tableRefNode.tableNode.token.getIdentifier()},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Dt(this)];case 1:return[new i(this)]}return[]},p}(H),A=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new E(this)];case 1:return[new v(this)];case 2:return[new dt(this)];case 3:return[new ye(this)]}return[]},Object.defineProperty(p.prototype,"isComplete",{get:function(){return 4===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"measureDef",{get:function(){if(this._children.length>1)return(0,U.as)(this._children[1],v)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"expressionNode",{get:function(){if(this._children.length>2)return(0,U.as)(this._children[3],ye)},enumerable:!1,configurable:!0}),p.prototype.getContextForChild=function(h){var L=this;if(h instanceof ye){var J=new R.hK(this.context.matchObjects),Te=_.find(J.matchObjects.tables,function(ze){return ze.name===L.measureDef.tableName});if(Te){J.currentTable=Te.uberTable;var Be=new R.hK(J,!1);return Be.currentTable=void 0,Be}}return V.prototype.getContextForChild.call(this,h)},p}(H),Z=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"functionNode",{get:function(){return this._children[0].bracketedIdentifier},enumerable:!1,configurable:!0}),p.prototype.getPotentialFirstChild=function(){return new he(this)},p}(Pe),he=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"bracketedIdentifier",{get:function(){var L=(0,U.as)(this.child,i);if(!L){var J=(0,U.as)(this.child,It);J&&(L=J.bracketedIdentifier)}return L},enumerable:!1,configurable:!0}),p.prototype.getPotentialChildren=function(){return[new i(this),new It(this)]},p}(X),ue=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this._children.length>1},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"firstIdentifier",{get:function(){return(0,U.as)(this._children[0],R.a9)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastIdentifier",{get:function(){return(0,U.as)(this.lastChild,R.a9)},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,2)||U.G.hasFlag(h.type,4)||U.G.hasFlag(h.type,8)||U.G.hasFlag(h.type,65536)||U.G.hasFlag(h.type,524288)||U.G.hasFlag(h.type,64)},p.prototype.getIdentifier=function(h){return(0,U.as)(this._children[h],R.a9)},p.prototype.getPotentialNextChildren=function(){return[new M(this),new be(this),new Ce(this)]},Object.defineProperty(p.prototype,"axesRef",{get:function(){return this._children.map(function(L){var J;return null!==(J=L.axesRef)&&void 0!==J&&J.length?L.axesRef[0]:void 0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isValidAxisValue",{get:function(){return U.LP.hasValidAxesReferences(this.axesRef)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"matchingMultiEnumValue",{get:function(){var L=_.find(this.context.ephemeralContexts,function(Te){return Te.enumValues});if(L){(0,I.hu)(_.every(this.children,function(Te){return!!(0,U.as)(Te,R.a9)}),"Unexpected child type");var J=_.join(_.map(this.children,function(Te){return(0,U.as)(Te,R.a9).token.getString()})," ");return _.find(L.enumValues,function(Te){return U.uI.equalIgnoreCase(Te.name,J)})}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isValidEnumValue",{get:function(){return!!this.matchingMultiEnumValue},enumerable:!1,configurable:!0}),p}(H),Ee=function(V){function p(h,L){var J=V.call(this,void 0,0,h)||this;return J._path=new k.q(void 0),J.newRootNode=L,J}return(0,x.ZT)(p,V),p.prototype.eatToken=function(h,L){return this.newRootNode().eatToken(h,L)},p}(R.a9),ge=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new M(this),new a(this),new Ze(this),new i(this),new It(this),new _e(this),new Ot(this),new Je(this),new mt(this),new Me(this),new Z(this),new Fe(this),new Ne(this),new Kt(this),new ue(this),new Vt(this),new Pt(this),new xe(this)]},p}(X),we=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof Ue||this.lastChild instanceof Ct},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new se(this)];case 1:return[new de(this)];default:var h=this.lastChild;if(h instanceof l||h instanceof de)return[new Ue(this)];if(h instanceof Ue)return[new l(this,0),new Ct(this)]}return[]},p}(H),Ne=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getFromOnlyChild=function(h){if(this._children.length>=2)return h(this._children[1])},Object.defineProperty(p.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"childWhichReceivesEphemeralContexts",{get:function(){if(this._children.length>=2)return this._children[1]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"leftParen",{get:function(){return(0,U.as)(this._children[0],R.a9)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"rightParen",{get:function(){if(this._children.length>2)return(0,U.as)(this._children[2],R.a9)},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new R.a9(this,23)];case 1:return[new u(this)];case 2:return[new R.a9(this,24)];default:return[]}},p}(H),Ae=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new je(this)},p.prototype.getOperator=function(){return new R.a9(this,[19,20])},p}(Q),Ve=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new zt(this)},p.prototype.getOperator=function(){return new R.a9(this,[18])},p}(Q),Ge=function(V){function p(h,L){return V.call(this,h,L)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this._children.length>=1},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"queries",{get:function(){return _.filter(this._children,function(L){return L instanceof ke})},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){return[new ke(this,this.context)]},p}(H),ke=function(V){function p(h,L){return V.call(this,h,L)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.hasDefineMeasure?this._children.length>=3:this._children.length>=2},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hasDefineMeasure",{get:function(){return this._children.length>0&&this._children[0]instanceof te},enumerable:!1,configurable:!0}),p.prototype.getContextForChild=function(h){var L=this.context;if(h instanceof ye)(L=new R.hK(L,!1)).ephemeralContexts.push(new R.xE(L,void 0,Y.Yl.TableExpr,void 0));else if(h instanceof we){var Te=_.find(this._children,function(Be){return Be instanceof ye}).tableValue;(L=new R.hK(L,!1)).currentTable=Te}return L},p.prototype.getPotentialNextChildren=function(){if(0===this._children.length)return[new ee(this),new te(this)];var L;switch(this.hasDefineMeasure?this._children.length-1:this._children.length){case 0:L=new ee(this);break;case 1:L=new ye(this);break;case 2:L=new we(this);break;default:return[]}return[L]},p}(H),Ze=function(V){function p(h){return V.call(this,h,32)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){if(this.token){var L=(0,U.as)(this.token.matchObject,R.S2);if(L)return L.uberTable}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableRef",{get:function(){return this.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"calendarRef",{get:function(){if(this.token){var L=(0,U.as)(this.token.matchObject,R.Df);if(L)return L}},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,2)||U.G.hasFlag(h.type,4)||U.G.hasFlag(h.type,8)||U.G.hasFlag(h.type,16)},p}(R.a9),ct=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new ht(this)];case 1:return[new Je(this)];default:return[]}},p}(H),rt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new M(this)];case 1:return[new We(this)];case 2:return[new nt(this)];default:return[]}},p}(H),tt=function(V){function p(h){return V.call(this,h,26)||this}return(0,x.ZT)(p,V),p}(R.a9),nt=function(V){function p(h){return V.call(this,h,24)||this}return(0,x.ZT)(p,V),p}(R.a9),dt=function(V){function p(h){return V.call(this,h,17)||this}return(0,x.ZT)(p,V),p}(R.a9),Je=function(V){function p(h){return V.call(this,h,36)||this}return(0,x.ZT)(p,V),p}(R.a9),$e=function(V){function p(h){return V.call(this,h,25)||this}return(0,x.ZT)(p,V),p}(R.a9),We=function(V){function p(h){return V.call(this,h,23)||this}return(0,x.ZT)(p,V),p}(R.a9),ht=function(V){function p(h){return V.call(this,h,[19,20])||this}return(0,x.ZT)(p,V),p}(R.a9),mt=function(V){function p(h){return V.call(this,h,38)||this}return(0,x.ZT)(p,V),p}(R.a9),Tt=function(V){function p(h){return V.call(this,h,57)||this}return(0,x.ZT)(p,V),p}(R.a9),Ue=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this._children.length>=1},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new ye(this)];case 1:return[new ut(this)];default:return[]}},p}(H),ut=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialChildren=function(){return[new be(this),new Ce(this)]},p}(X),Ct=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getPotentialNextChildren=function(){var h;switch(this._children.length){case 0:h=new N(this);break;case 1:h=new m(this);break;default:var L=this.lastChild;L instanceof l||L instanceof m?h=new oe(this):((0,I.hu)(L instanceof oe,"Unexpected node type "+L.constructor),h=new l(this,0))}return[h]},Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof oe},enumerable:!1,configurable:!0}),p}(H),Ot=function(V){function p(h){return V.call(this,h,30)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"string",{get:function(){var L=this.token;if(30===L.type)return U.LP.unDoubleQuote(L.getString())},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,32)||U.G.hasFlag(h.type,2048)},p}(R.a9),Rt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new Ae(this)},p.prototype.getOperator=function(){return new R.a9(this,[28])},p}(Q),It=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"bracketedIdentifier",{get:function(){return this._children.length>1?(0,U.as)(this._children[1],i):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"qualifiedColumnRef",{get:function(){var L=this.bracketedIdentifier;if(L)return L.simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"filterColumnRef",{get:function(){if(1===this.context.filterExpressionState)return this.qualifiedColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 2===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tableRefNode",{get:function(){if(_.some(this._children))return(0,U.as)(_.head(this._children),Dt)},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){if(U.G.hasFlag(h.type,2)||U.G.hasFlag(h.type,2)){var L=this.bracketedIdentifier;if(!L||60===L.token.type)return!0}return U.G.hasFlag(h.type,8)},p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new Dt(this)];case 1:return[new i(this)];default:return[]}},p.prototype.tryGetTableAndColumnNames=function(h){if(!this.bracketedIdentifier||34!==this.bracketedIdentifier.token.type)return h.table=void 0,h.column=void 0,!1;var L=this.firstDescendent,Te=L.token.getString();return L instanceof Ze&&(Te=U.LP.unquote(Te)),h.table=Te,h.column=U.LP.unbracket(this.bracketedIdentifier.token.getString()),!0},p}(H),Vt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){var L=new R.Lc,J=new R.S2("",void 0,!1);L.constructedTables.push(J);var Te=_.head(U.Sy.ofType(this._children,u));if(Te)if(Te.tupleCardinality>1)for(var Be=0;Be<Te.tupleCardinality;Be++)J.addColumn(new R.XN("Value".concat(Be+1),void 0,J));else J.addColumn(new R.XN("Value",void 0,J));return L},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,2)},Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof tt},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new $e(this)];var h=this.lastChild;return h instanceof $e?[new u(this),new tt(this)]:h instanceof l?[new u(this)]:h instanceof u?[new l(this,0),new tt(this)]:[]},p}(H),Dt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableNode",{get:function(){return(0,U.as)(this.child,R.a9)},enumerable:!1,configurable:!0}),p.prototype.getPotentialChildren=function(){return[new M(this),new Ze(this)]},p}(X),je=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p.prototype.getOperand=function(){return new Ve(this)},p.prototype.getOperator=function(){return new R.a9(this,[21,22])},p}(Q),Pt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof nt},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"tupleCardinality",{get:function(){return this.nextSeparatorIndex},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInValidLocation",{get:function(){for(var L=this,J=L.parent;J;L=J,J=J.parent){if(J instanceof Vt)return!0;var Te=(0,U.as)(J,O);if(Te&&Te.firstChildCouldBeTuple)return!0;if(!J.isOnlyChild(L))break}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"nextSeparatorIndex",{get:function(){for(var L=this._children.length-1;L>0;L--){var J=(0,U.as)(this._children[L],l);if(J)return J.index+1}return 1},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){if(!_.some(this._children))return[new We(this)];var h=this.lastChild;if(h instanceof We)return[new u(this),new l(this,1)];if(h instanceof u||h instanceof l){var L=this.nextSeparatorIndex,J=[new l(this,L)];return h instanceof l&&J.push(new u(this)),L>1&&J.push(new nt(this)),J}return[]},p}(H),qe=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof C},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){return this.isComplete?[]:[new K(this),new C(this)]},p}(H),zt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof ge},enumerable:!1,configurable:!0}),p.prototype.getPotentialNextChildren=function(){return this.isComplete?[]:[new ht(this),new ge(this)]},p}(H),bt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),p}(D),_e=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"simpleColumnRef",{get:function(){if(this._children[0].simpleColumnRef&&!(this._children.length<3))return this._children[2].simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"qualifiedColumnRef",{get:function(){if(this._children[0].qualifiedColumnRef&&!(this._children.length<3))return this._children[2].simpleColumnRef},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isComplete",{get:function(){return 3===this._children.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"dotNode",{get:function(){return this._children[1]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"variationSource",{get:function(){return this._children[0].bracketedIdentifier},enumerable:!1,configurable:!0}),p.prototype.couldBeType=function(h){return this._children[0].couldBeType(h)},p.prototype.getContextForChild=function(h){var L=this.context;if(h===this._children[0])return L;var Te=(0,U.as)(this.variationSource.token.matchObject,R.XN),Be=Te&&Te.variationTable?Te.variationTable.uberTable:new R.Lc,ze=new R.hK(L,!0);return ze.ephemeralContexts.push(new R.xE(ze,Be,{type:8192,columnReferenceScope:64},void 0)),ze},p.prototype.getPotentialNextChildren=function(){switch(this._children.length){case 0:return[new W(this)];case 1:return[new pe(this)];case 2:return[new i(this)];default:return[]}},p}(H),Kt=function(V){function p(h){return V.call(this,h)||this}return(0,x.ZT)(p,V),Object.defineProperty(p.prototype,"tableValue",{get:function(){var L=this.returnedExpression;if(L)return L.tableValue},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"returnedExpression",{get:function(){return(0,U.as)(this.lastChild,u)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isComplete",{get:function(){return this.lastChild instanceof u},enumerable:!1,configurable:!0}),p.prototype.getEarlierVariables=function(h){for(var L=[],J=0,Te=this._children;J<Te.length;J++){var Be=Te[J];if(Be===h)break;Be instanceof bt&&L.push(Be)}return L},p.prototype.couldBeType=function(h){return U.G.hasFlag(h.type,2)},p.prototype.getContextForChild=function(h){for(var L=[],J=0,Te=this._children;J<Te.length;J++){var Be=Te[J];if(Be===h)break;var ze=(0,U.as)(Be,bt);ze&&L.push(ze.identifier.token.matchObject)}var lt=this.context;return(h!==this._children[0]&&_.some(lt.ephemeralContexts)||_.some(L))&&(lt=new R.hK(lt,!0)).mergeInlineVariables(L),lt},p.prototype.getPotentialNextChildren=function(){var h=this.lastChild;return h?h instanceof bt?[new bt(this),new F(this)]:h instanceof F?[new u(this)]:[]:[new bt(this)]},p}(H)},68706:function(Ke,Ie,T){T.d(Ie,{D:function(){return Y},j:function(){return G}});var x=T(55863),I=T(19194),G=function(k){return k[k.CantSeparateFormulaNameAndExpression=0]="CantSeparateFormulaNameAndExpression",k[k.DuplicateMeasureName=1]="DuplicateMeasureName",k[k.FunctionCallOnNonFunction=2]="FunctionCallOnNonFunction",k[k.Gramatical=3]="Gramatical",k[k.IncompleteNumber=4]="IncompleteNumber",k[k.IncorrectOrderByParam=5]="IncorrectOrderByParam",k[k.IncorrectPartitionByParam=6]="IncorrectPartitionByParam",k[k.IncorrectMatchByParam=7]="IncorrectMatchByParam",k[k.InvalidIdentifier=8]="InvalidIdentifier",k[k.InvalidNameCharacter=9]="InvalidNameCharacter",k[k.InvalidTupleLocation=10]="InvalidTupleLocation",k[k.InvalidParameter=11]="InvalidParameter",k[k.MissingParameters=12]="MissingParameters",k[k.RightArgumentToInOperatorNotValidTable=13]="RightArgumentToInOperatorNotValidTable",k[k.TooManyParameters=14]="TooManyParameters",k[k.UnrecognizedIdentifier=15]="UnrecognizedIdentifier",k[k.VariableNameReserved=16]="VariableNameReserved",k}({}),Y=function(){function k(R,U){this.segment=R,this.errorCode=U,this.message=k.getMessage(R,U)}return k.prototype.equals=function(R){return this.segment.equals(R.segment)&&this.errorCode===R.errorCode},k.prototype.toString=function(){return"".concat(this.errorCode,": ").concat(this.segment.text)},k.getMessage=function(R,U){switch(U){case G.CantSeparateFormulaNameAndExpression:return I.m.format(I.m.localizedStrings.invalidIdentifier,R.text);case G.FunctionCallOnNonFunction:return I.m.format(I.m.localizedStrings.functionCallOnNonFunction,R.text);case G.Gramatical:return I.m.format(I.m.localizedStrings.grammaticalError,R.text);case G.IncompleteNumber:return I.m.format(I.m.localizedStrings.incompleteNumber);case G.IncorrectOrderByParam:return I.m.format(I.m.localizedStrings.incorrectOrderByParam);case G.IncorrectPartitionByParam:return I.m.format(I.m.localizedStrings.incorrectPartitionByParam);case G.IncorrectMatchByParam:return I.m.format(I.m.localizedStrings.incorrectMatchByParam);case G.InvalidIdentifier:return I.m.format(I.m.localizedStrings.invalidIdentifier,R.text);case G.InvalidNameCharacter:return I.m.format(I.m.localizedStrings.invalidNameCharacter,R.text);case G.InvalidTupleLocation:return I.m.format(I.m.localizedStrings.invalidTupleLocation);case G.InvalidParameter:return I.m.format(I.m.localizedStrings.invalidParameter);case G.MissingParameters:return I.m.format(I.m.localizedStrings.missingParameters);case G.RightArgumentToInOperatorNotValidTable:return I.m.format(I.m.localizedStrings.rightArgumentToInOperatorNotValidTable,R.text);case G.TooManyParameters:return I.m.format(I.m.localizedStrings.tooManyParameters,R.text);case G.UnrecognizedIdentifier:return I.m.format(I.m.localizedStrings.unrecognizedIdentifier,R.text);case G.VariableNameReserved:return I.m.format(I.m.localizedStrings.variableNameReserved,R.text);case G.DuplicateMeasureName:return I.m.format(I.m.localizedStrings.duplicateMeasureName)}(0,x.vE)("unexpected error code ".concat(U))},k}()},82269:function(Ke,Ie,T){T.d(Ie,{b:function(){return x}});var x=function(){function I(G,Y,k,R){void 0===G&&(G=""),void 0===Y&&(Y=0),this._expression=G,this._cursorActivity=Y,this._cursorPosition=k,this._selectionStart=R,this.semiselectable=!1,this.suggestions=[],this.replaceStart=-1,this.replaceEnd=-1,this.afterOParen=-1,this.afterCParen=-1,this.bestMatch=-1,this._prototypeParamContexts=[],this.prototypePosition=-1,this.boldLeftParen=-1,this.boldRightParen=-1,this._errors=[],this._comments=[],this._functions=[],this._references=[],this._tableReferences=[],this._columnReferences=[],this._measureReferences=[],this._strings=[],this._variables=[],this._unrecognizedIdentifiers=[]}return Object.defineProperty(I.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"cursorActivity",{get:function(){return this._cursorActivity},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"cursorPosition",{get:function(){return this._cursorPosition},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"selectionStart",{get:function(){return this._selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"prototypeParamContexts",{get:function(){return this._prototypeParamContexts},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"comments",{get:function(){return this._comments},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"references",{get:function(){return this._references},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"measureReferences",{get:function(){return this._measureReferences},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"tableReferences",{get:function(){return this._tableReferences},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"columnReferences",{get:function(){return this._columnReferences},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"strings",{get:function(){return this._strings},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"variables",{get:function(){return this._variables},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"unrecognizedIdentifiers",{get:function(){return this._unrecognizedIdentifiers},enumerable:!1,configurable:!0}),I}()},42165:function(Ke,Ie,T){T.d(Ie,{X:function(){return I}});var x=T(55863),I=function(){function G(Y,k,R){(0,x.mv)(Y,"Segment expression cannot be null"),(0,x.hu)(k>=0&&k<=Y.length,"Invalid startPos"),(0,x.hu)(R>=0&&k+R<=Y.length,"Invalid length"),this._expression=Y,this._startPosition=k,this._length=R}return G.fromTokens=function(Y,k){return new G(k.expression,Y.startPosition,k.startPosition+k.length-Y.startPosition)},Object.defineProperty(G.prototype,"startPosition",{get:function(){return this._startPosition},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"text",{get:function(){return this.expression.substr(this.startPosition,this.length)},enumerable:!1,configurable:!0}),G.prototype.equals=function(Y){return this.startPosition===Y.startPosition&&this.length===Y.length},G}()},19194:function(Ke,Ie,T){T.d(Ie,{m:function(){return I}});var I,x=T(55863);!function(G){function U(H){return null==H?"":_.isString(H)?H:_.isNumber(H)||_.isDate(H)?H.toLocaleString():_.isObject(H)?null!=H.toLocaleString?H.toLocaleString():H.toString():""}G.localizedStrings={incompleteNumber:"Invalid number.",invalidTupleLocation:"Unexpected tuple.",invalidParameter:"Parameter is not the correct type.",missingParameters:"Expected additional parameters.",incorrectOrderByParam:"The OrderBy parameter only accepts the ORDERBY function.",incorrectPartitionByParam:"The PartitionBy parameter only accepts the PARTITIONBY function.",incorrectMatchByParam:"The MatchBy parameter only accepts the MATCHBY function.",grammaticalError:"Unexpected expression {0}",functionCallOnNonFunction:"'{0}' is not a function.",rightArgumentToInOperatorNotValidTable:"{0} is not a valid table.",tooManyParameters:"Unexepected parameter '{0}'",invalidNameCharacter:"'{0}' is not a valid name character.",invalidIdentifier:"Cannot find name '{0}'",unrecognizedIdentifier:"Cannot find name '{0}'",variableNameReserved:"'{0}' is a reserved word",rowsDescription:"Calculate vertically across rows.",columnsDescription:"Calculate horizontally across columns.",rowsColumnsDescription:"Calculate vertically across rows, continuing column by column.",columnsRowsDescription:"Calculate horizontally across columns, continuing row by row.",duplicateMeasureName:"This measure's name has already been used in another table"},G.setLocalizedDaxStrings=function(H){G.localizedStrings=H},G.format=function(H){for(var X=[],D=1;D<arguments.length;D++)X[D-1]=arguments[D];_.isArray(X[0])&&((0,x.hu)(1===X.length,"expected single argument to format if called with an array"),X=X[0]);var re=H;if(re)for(var q=X.length;q--;)re=re.replace(new RegExp("\\{"+q+"\\}","gm"),U(X[q]));return re}}(I||(I={}))},48987:function(Ke,Ie,T){T.d(Ie,{J_:function(){return k},XI:function(){return R},q$:function(){return G},tA:function(){return Y}});var x=T(81337),I=T(63513),G=function(){function U(H,X){for(var D=[],re=2;re<arguments.length;re++)D[re-2]=arguments[re];this._matchObject=H,this._suggestionText=X,_.some(D)||(D=[H]),this._segments=_.map(D,function(q){return q.name})}return Object.defineProperty(U.prototype,"complete",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"matchObject",{get:function(){return this._matchObject},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"suggestionText",{get:function(){return this._suggestionText},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"segments",{get:function(){return this._segments},enumerable:!1,configurable:!0}),U.prototype.prependSuggestionText=function(H){this._suggestionText=H+this._suggestionText},U}(),Y=function(U){function H(X,D){for(var re=[],q=2;q<arguments.length;q++)re[q-2]=arguments[q];return U.apply(this,(0,x.ev)([X,D],re,!1))||this}return(0,x.ZT)(H,U),Object.defineProperty(H.prototype,"complete",{get:function(){return!1},enumerable:!1,configurable:!0}),H}(G);function k(U,H){for(var X=0;;X++){if(X>=U.segments.length&&X>=H.segments.length)return 0;if(X>=U.segments.length)return-1;if(X>=H.segments.length)return 1;var D=I.uI.compare(U.segments[X],H.segments[X],!0);if(0!==D)return D}}var R=function(){function U(){}return U.equals=function(H,X){return typeof H.matchObject==typeof X.matchObject&&I.uI.equalIgnoreCase(H.suggestionText,X.suggestionText)},U}()},74104:function(Ke,Ie,T){T.d(Ie,{co:function(){return U},jZ:function(){return R},nR:function(){return Y}});var x=T(55863),I=T(85786),G=T(63513),Y=_.memoize(function(H,X){return new k(H,X)}),k=function(){function H(X,D){this.initializeRules(X,D)}return H.prototype.isTokenComplete=function(X){var D=_.find(this.rules,function(re){return re.tokenType===X.type});return!(!D||D.canBeExtendedByIdentifier)},H.prototype.nextToken=function(X,D,re){this.uberRegExp.lastIndex=D;var q=this.uberRegExp.exec(X.substr(0,re));if(!q)return new I.WU(59,X,D,X.length-D);if(q.index>D)return new I.WU(59,X,D,q.index-D);for(var i,Q=q[0],W=0,C=this.rules;W<C.length;W++){var oe=C[W],ve=oe.regExp.exec(Q);if(ve&&0===ve.index&&ve[0].length===Q.length){i=new I.WU(oe.tokenType,X,D,Q.length,oe.isIgnorable);break}}switch((0,x.mv)(i,"Given that the uber-regexp found a match, one of the token rules must also match"),i.type){case 3:i=this.adjustMLCommentToken(i,re);break;case 58:i=this.adjustIdentifierToken(i)}return i},H.prototype.adjustIdentifierToken=function(X){var D=X.getString(),re=_.find(this.keywordRules,function(Q){return G.uI.equalIgnoreCase(Q.keyword,D)}),q=re?re.tokenType:0;return 0!==q?new I.WU(q,X.expression,X.startPosition,X.length,X.ignorable):X},H.prototype.adjustMLCommentToken=function(X,D){for(var re=1,q=X.expression,Q=X.endPosition;Q<D;){var i=q[Q++];switch(i){case"*":if(Q<D&&"/"===(i=q[Q++])&&0==--re)return new I.WU(2,q,X.startPosition,Q-X.startPosition,X.ignorable);break;case"/":Q<D&&"*"===(i=q[Q++])&&++re}}return new I.WU(3,q,X.startPosition,Q-X.startPosition,X.ignorable)},H.prototype.initializeRules=function(X,D){this.rules=[],this.addRule(3,"/\\*",!0,!0),this.addRule(4,"//.*\\n",!1,!0),this.addRule(5,"//.*",!0,!0),this.addRule(6,"--.*\\n",!1,!0),this.addRule(7,"--.*",!0,!0),this.addOperatorRule(9,"=="),this.addOperatorRule(10,"<>"),this.addOperatorRule(11,"<="),this.addOperatorRule(12,">="),this.addOperatorRule(13,"&&"),this.addOperatorRule(14,"\\|\\|"),this.addOperatorRule(15,"<"),this.addOperatorRule(16,">"),this.addOperatorRule(17,"="),this.addOperatorRule(18,"\\^"),this.addOperatorRule(28,"&"),this.addOperatorRule(19,"\\+"),this.addOperatorRule(20,"-"),this.addOperatorRule(21,"\\*"),this.addOperatorRule(22,"/"),this.addOperatorRule(23,"\\("),this.addOperatorRule(24,"\\)"),this.addOperatorRule(25,"\\{"),this.addOperatorRule(26,"}"),this.addOperatorRule(27,X),this.addRule(29,"[\\s\\t\\r\\n]+",!1,!0),this.addDelimitedIdentifierRule(30,31,'"','"'),this.addDelimitedIdentifierRule(32,33,"'","'"),this.addDelimitedIdentifierRule(34,35,"[","]");var re=_.escapeRegExp(D),q="(([0-9]+"+re+"[0-9]*)|([0-9]*"+re+"[0-9]+)|([0-9]+))";this.addRule(38,'[dD][tT]"[^"]+"',!1,!1),this.addRule(39,'[dD][tT]"[^"]*',!1,!1),this.addRuleWithUberPattern(36,q+"([eE][+\\-]?[0-9]+)?",!1,!1,q+"([eE][+\\-]?[0-9]*)?"),this.addRuleWithUberPattern(37,q+"([eE][+\\-]?)",!1,!1,void 0),this.addOperatorRule(40,"\\."),this.addRule(57,"evaluateandlog",!1,!1,!0),this.addRule(58,"[a-zA-Z_][a-zA-Z_0-9.]*",!0,!1),this.keywordRules=[],this.keywordRules.push({keyword:"var",tokenType:42}),this.keywordRules.push({keyword:"return",tokenType:43}),this.keywordRules.push({keyword:"not",tokenType:44}),this.keywordRules.push({keyword:"evaluate",tokenType:45}),this.keywordRules.push({keyword:"datatable",tokenType:46}),this.keywordRules.push({keyword:"order",tokenType:47}),this.keywordRules.push({keyword:"by",tokenType:48}),this.keywordRules.push({keyword:"start",tokenType:51}),this.keywordRules.push({keyword:"at",tokenType:52}),this.keywordRules.push({keyword:"asc",tokenType:49}),this.keywordRules.push({keyword:"desc",tokenType:50}),this.keywordRules.push({keyword:"define",tokenType:53}),this.keywordRules.push({keyword:"measure",tokenType:54}),this.keywordRules.push({keyword:"in",tokenType:55}),this.buildUberPattern()},H.prototype.buildUberPattern=function(){for(var X="",D=!0,re=0,q=this.rules;re<q.length;re++){var Q=q[re];Q.uberPattern&&(D||(X+="|"),X+="("+(Q.uberPattern||Q.regExp.source)+")",D=!1)}this.uberRegExp=new RegExp(X,"g")},H.prototype.addDelimitedIdentifierRule=function(X,D,re,q){this.addRuleWithUberPattern(X,H.delimitedIdentifier(re,q),!1,!1,H.delimitedIdentifierStartOrComplete(re,q)),this.addRuleWithUberPattern(D,H.delimitedIdentifierStart(re,q),!0,!1,void 0)},H.prototype.addOperatorRule=function(X,D){this.addRule(X,D,!1,!1)},H.prototype.addRule=function(X,D,re,q,Q){void 0===Q&&(Q=!1),this.addRuleWithUberPattern(X,D,re,q,D,Q)},H.prototype.addRuleWithUberPattern=function(X,D,re,q,Q,i){void 0===i&&(i=!1),this.rules.push({tokenType:X,regExp:new RegExp(D,i?"i":""),canBeExtendedByIdentifier:re,isIgnorable:q,uberPattern:Q})},H.delimitedIdentifierStartOrComplete=function(X,D){return H.delimitedIdentifier(X,D)+"?"},H.delimitedIdentifier=function(X,D){return H.delimitedIdentifierStart(X,D)+"("+_.escapeRegExp(D)+")"},H.delimitedIdentifierStart=function(X,D){return X=_.escapeRegExp(X),D=_.escapeRegExp(D),"(".concat(X,")([^").concat(D,"]|(").concat(D).concat(D,"))*")},H}(),R=k.delimitedIdentifier("[","]"),U=k.delimitedIdentifierStart("[","]")},66813:function(Ke,Ie,T){T.d(Ie,{h:function(){return x}});var x=function(){function I(G,Y,k,R){this._expression=G,this._cursorActivity=Y,this._cursorPosition=k,this._selectionStart=R,this._tokens=[],this.parseTokenCount=-1}return Object.defineProperty(I.prototype,"activeCursor",{get:function(){return this.cursorActivity>=3},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"cursorActivity",{get:function(){return this._cursorActivity},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"cursorPosition",{get:function(){return this._cursorPosition},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"selectionStart",{get:function(){return this._selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"tokens",{get:function(){return this._tokens},enumerable:!1,configurable:!0}),I.prototype.updateExpression=function(G){this._expression=G},I.prototype.nextNonIgnorable=function(G,Y){for(void 0===Y&&(Y={iTokenNext:void 0}),Y.iTokenNext=G+1;Y.iTokenNext<this.tokens.length;Y.iTokenNext++){var k=this.tokens[Y.iTokenNext];if(!k.ignorable)return k}},I}()},21527:function(Ke,Ie,T){T.d(Ie,{w:function(){return U}});var x=T(55863),I=T(88498),G=T(66813),Y=T(74104),k=T(85786),R=T(63513);function U(D,re,q,Q,i,W,C){var oe,ve=W?I.ft():I.V,B=(0,Y.nR)(ve.listSeparator,ve.numberDecimalSeparator),b=new G.h(D,re,q,Q),te=0,pe=D.length,le=b.activeCursor;le&&(0,x.hu)(null!=q,"cursorPosition must have value if the cursor is active");var ye=[],Pe={stopPosition:pe},Me=i&&X(b,i,!1,ye,Pe);if(Me||(Me=C&&X(b,C,!1,ye,Pe)),Me||(Me=i&&X(b,i,!0,ye,Pe)),Me||(Me=C&&X(b,C,!0,ye,Pe)),pe=Pe.stopPosition,i){var xe=pe;i.activeCursor&&(xe=Math.min(xe,i.cursorPosition||0)),le&&(xe=Math.min(xe,q||0));for(var Fe=0,me=i.tokens;Fe<me.length;Fe++){(0,x.hu)(i.expression.length>=(Oe=me[Fe]).startPosition+Oe.length,"expected token to be within the bounds of the expression");var ie=Oe.startPosition+Oe.length;if(xe<=ie||i.expression.length<=ie||D[ie]!==i.expression[ie]||!R.uI.equalIgnoreCase(D.substr(Oe.startPosition,Oe.length),i.expression.substr(Oe.startPosition,Oe.length)))break;(0,x.hu)(60!==Oe.type,"cannot reuse NewToken"),b.tokens.push(Oe)}if(b.tokens.length>0){var M=b.tokens[b.tokens.length-1];te=M.startPosition+M.length}}for(;te<pe;){var Oe=B.nextToken(D,te,pe);if(le&&Oe.startPosition<q&&Oe.startPosition+Oe.length>q){for(;te<q;){var g=B.nextToken(D,te,q);b.tokens.push(g),te+=g.length}Oe.markAsSecondHalf(q)}le&&(Oe.startPosition===q?(H(0,D,b.tokens),b.parseTokenCount=b.tokens.length):Oe.endPosition===q&&(Oe.activelyEdited=!0)),b.tokens.push(Oe),te+=Oe.length}if(le)te===q&&H(0,D,b.tokens),-1===b.parseTokenCount&&(b.parseTokenCount=b.tokens.length),(oe=b.tokens).push.apply(oe,ye);else{if(0!==b.cursorActivity&&q>=0){var O=!1;(0,x.hu)(te>=q,"currentPosition >= cursorPosition");for(var f=te,m=b.tokens.length;;){if(f===q){O=!0;break}if((0,x.hu)(f>q,"effectiveEndPosition > cursorPosition"),(0,x.hu)(m>0,"iToken > 0"),m--,(f=(Oe=b.tokens[m]).startPosition)<q){O=29===Oe.type;break}if(!Oe.ignorable)break}O&&H(0,D,b.tokens)}b.parseTokenCount=b.tokens.length}return b}function H(D,re,q){var Q=!0,i=0;if(_.some(q)){var W=_.last(q);(Q=W.isComplete)&&(i=W.startPosition+W.length)}Q&&q.push(new k.WU(60,re,i,0))}function X(D,re,q,Q,i){if(0===re.expression.length)return!1;if(D.activeCursor){var W=re.expression,C=D.expression,oe=0===re.cursorActivity?0:Math.max(0,re.cursorPosition||0),ve=Math.max(0,D.cursorPosition||0),B=W.length-oe,b=C.length-ve,te=q?Math.min(B,b):b,pe=W.substr(W.length-te),le=C.substr(C.length-te);if(B>=te&&R.uI.equalIgnoreCase(pe,le)){for(var ye=C.length-W.length,Pe=te,Me=re.tokens.length-1;Me>=0&&Pe>0;Me--){var xe=re.tokens[Me];if(60!==xe.type){var Fe=xe.startPosition+ye,me=xe.length,Oe=xe.secondHalf;me>Pe&&(Fe+=me-Pe,me=Pe,Oe=!0),Q.unshift(xe.cloneForReuse(C,Fe,me,Oe)),Pe-=me}else(0,x.hu)(0===xe.length,"token.length === 0")}return b>te&&Q.unshift(new k.WU(61,C,ve,b-te)),i.stopPosition=ve,!0}}return!1}},85786:function(Ke,Ie,T){T.d(Ie,{C3:function(){return D},Cu:function(){return H},WU:function(){return U}});var x=T(55863),I=T(40546),G=T(66106),Y=T(88498),k=T(42165),R=T(63513),U=function(){function i(W,C,oe,ve,B,b,te,pe,le){void 0===B&&(B=!1),void 0===b&&(b=!1),void 0===te&&(te=!1),void 0===le&&(le=G.Yl.None),this._type=W,this._expression=C,this._startPosition=oe,this._length=ve,this._ignorable=B,this._secondHalf=b,this.activelyEdited=te,this.matchObject=pe,this.matchedType=le}return i.prototype.debuggerDisplay=function(){return(0,x.hu)(Y.Mz.debugging,"cannot use debuggerDisplay unless debugging"),"".concat(this.type," ").concat(this.getString()," (").concat(this.startPosition,", ").concat(this.length,")")},i.prototype.toString=function(){return this.debuggerDisplay()},Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startPosition",{get:function(){return this._startPosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endPosition",{get:function(){return this.startPosition+this.length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ignorable",{get:function(){return this._ignorable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondHalf",{get:function(){return this._secondHalf},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComment",{get:function(){return D(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isKeyword",{get:function(){return Q(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isIdentifierOrKeyword",{get:function(){return function(i){return 58===i||Q(i)}(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isAnyKindOfIdentifier",{get:function(){return function(i){return 58===i||32===i||34===i}(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return function(i){if(Q(i))return!1;switch(i){case 3:case 5:case 7:case 31:case 33:case 35:case 36:case 37:case 39:case 58:return!1}return!0}(this.type)},enumerable:!1,configurable:!0}),i.prototype.getSegment=function(){return new k.X(this.expression,this.startPosition,this.length)},i.prototype.getString=function(){return this.expression.substr(this.startPosition,this.length)},i.prototype.getIdentifier=function(){var W=this.getString();if(this.isIdentifierOrKeyword)return W;switch(this.type){case 32:return R.LP.unquote(W);case 33:return R.LP.unquotePartial(W);case 34:return R.LP.unbracket(W);case 35:return R.LP.unbracketPartial(W)}return""},i.prototype.matchesType=function(W){return!!H(this.type,W)||60===this.type&&(58===W||32===W||34===W||I.d.featureSwitches.suggestKeywords&&48===W)},i.prototype.markAsSecondHalf=function(W){this._length=this._startPosition+this._length-W,this._startPosition=W,this._secondHalf=!0},i.prototype.cloneForReuse=function(W,C,oe,ve){return new i(this.type,W,C,oe,this.ignorable,ve,!1,this.matchObject,ve?G.Yl.None:this.matchedType)},i.prototype.attachToNewExpression=function(W){this._expression=W},i.prototype.offsetPosition=function(W){this._startPosition+=W},i}();function H(i,W){if(i===W)return!0;switch(i){case 31:return 30===W;case 30:return 31===W;case 33:return 32===W;case 32:return 33===W;case 35:return 34===W;case 34:return 35===W;case 37:return 36===W;case 36:return 37===W;case 38:return 39===W;case 39:return 38===W}return!1}function D(i){return i>1&&i<8}function Q(i){return i>41&&i<56}},63513:function(Ke,Ie,T){T.d(Ie,{Bl:function(){return X},G:function(){return G},LP:function(){return re},Sy:function(){return Y},Xy:function(){return D},as:function(){return R},ci:function(){return H},jl:function(){return q},uI:function(){return k}});var G,Y,k,Q,x=T(81337),I=T(55863);function R(Q,i){return Q instanceof i?Q:void 0}function U(Q,i){return Q?Q.equals?Q.equals(i):Q===i:i?i.equals?i.equals(Q):i===Q:Q===i}(G||(G={})).hasFlag=function(W,C){return void 0===W&&(W=0),void 0===C&&(C=0),(W&C)===C},(Q=Y||(Y={})).union=function(ve,B,b){return ve.concat(_.filter(B,function(te){return!_.some(ve,function(pe){return b(te,pe)})}))},Q.distinct=function(ve,B){for(var b=[],te=function(Me){_.some(b,function(xe){return B(Me,xe)})||b.push(Me)},pe=0,le=ve;pe<le.length;pe++)te(le[pe]);return b},Q.ofType=function(ve,B){return _.filter(ve,function(b){return b instanceof B})},Q.skipWhile=function(ve,B){for(var b=0;b<ve.length&&B(ve[b]);)b++;return ve.slice(b)},function(Q){function C(pe,le){for(var ye=0;ye<pe.length&&_.includes(le,pe[ye]);ye++);return pe.substr(ye)}function oe(pe,le){for(var ye=pe.length-1;ye>=0&&_.includes(le,pe[ye]);ye--);return pe.substr(0,ye+1)}Q.compare=function(pe,le,ye){return pe===le?0:null==pe||null==le?-1:(ye&&(pe=pe.toUpperCase(),le=le.toUpperCase()),pe===le?0:pe<le?-1:1)},Q.trim=function(pe,le){return C(oe(pe,le),le)},Q.trimStart=C,Q.trimEnd=oe,Q.indexOfAny=function(pe,le,ye){for(var Pe,Me=0,xe=le;Me<xe.length;Me++){var me=pe.indexOf(xe[Me],ye);-1!==me&&(null==Pe||me<Pe)&&(Pe=me)}return void 0!==Pe?Pe:-1},Q.equalIgnoreCase=function(pe,le){return(0,I.mv)(pe,"first string in comparison must be defined"),(0,I.mv)(le,"second string in comparison must be defined"),pe.toUpperCase()===le.toUpperCase()},Q.isNullOrEmpty=function(pe){return!pe},Q.startsWithIgnoreCase=function(pe,le){return(0,I.mv)(pe,"str"),_.startsWith(pe.toUpperCase(),le.toUpperCase())}}(k||(k={}));var re,q,H=function(){function Q(){this.items=[]}return Q.prototype.enqueue=function(i){this.items.push(i)},Q.prototype.dequeue=function(){return this.items.pop()},Object.defineProperty(Q.prototype,"length",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),Q}(),X=function(){function Q(){this.table=new D}return Q.prototype.add=function(i){var W=this.table.get(i);return!(W&&_.some(W,function(C){return U(C,i)})||(this.table.add(i,[i]),0))},Q.prototype.remove=function(i){var W=this.table.get(i);if(!W)return!1;for(var C=0;C<W.length;C++)if(U(W[C],i))return W.splice(C,1),!0;return!1},Q.prototype.contains=function(i){var W=this.table.get(i);return!!W&&_.some(W,function(C){return U(C,i)})},Q.prototype.values=function(){for(var i=[],W=0,C=this.table.values();W<C.length;W++)i.push.apply(i,C[W]);return i},Q}(),D=function(){function Q(){this.hashMap={}}return Object.defineProperty(Q.prototype,"keys",{get:function(){var W=[];for(var C in this.hashMap)W.push.apply(W,this.hashMap[C].map(function(ve){return ve.key}));return W},enumerable:!1,configurable:!0}),Q.prototype.add=function(i,W){var C=Q.getHashCode(i),oe=this.getBucket(i);if(oe){if(this.containsKey(i))throw new Error("Cannot add duplicate value to dictionary");oe.push({key:i,value:W})}else this.hashMap[C]=[{key:i,value:W}]},Q.prototype.update=function(i,W){var C=this.getEntry(i);C?C.value=W:this.add(i,W)},Q.prototype.get=function(i){var W=this.getEntry(i);return W&&W.value},Q.prototype.values=function(){var i=[];for(var W in this.hashMap)i.push.apply(i,_.map(this.hashMap[W],function(oe){return oe.value}));return i},Q.prototype.containsKey=function(i){return!!this.getEntry(i)},Q.prototype.getBucket=function(i){var W=Q.getHashCode(i);return this.hashMap.hasOwnProperty(W)?this.hashMap[W]:void 0},Q.prototype.getEntry=function(i){var W=this.getBucket(i);if(W)return _.find(W,function(C){return Q.equals(C.key,i)})},Q.getHashCode=function(i){var W=i;return _.isFunction(W.getHashCode)?W.getHashCode():0},Q.equals=function(i,W){if((0,I.mv)(i,"a"),(0,I.mv)(W,"b"),i.constructor!==W.constructor)return!1;var C=i;return _.isFunction(C.equals)?C.equals(W):i===W},Q}();!function(Q){var i=/[a-zA-Z_][a-zA-Z_0-9]*/;function C(me,Oe){return _.isFunction(Oe)?oe(me,Oe):oe(me,function(ie){return Oe.isReservedWord(ie)})}function oe(me,Oe){var ie=i.exec(me);return!ie||ie[0].length!==me.length||Oe(me)}function ve(me){return me&&B(me)+"'"}function B(me){return"'"+me.replace(/'/g,"''")}function te(me){return me.substr(1).replace(/''/g,"'")}function Pe(me){return"["+me.replace(/\]/g,"]]")}function xe(me){return me.substr(1).replace(/\]\]/g,"]")}Q.quoteIfNeeded=function(me,Oe){return C(me,Oe)?ve(me):me},Q.quoteNeeded=C,Q.quote=ve,Q.quotePartial=B,Q.unquote=function(me){return te(me.substr(0,me.length-1))},Q.unquotePartial=te,Q.doubleQuote=function(me){return'"'.concat(me.replace(/"/g,'""'),'"')},Q.unDoubleQuote=function(me){return me.substr(1,me.length-2).replace(/""/g,'"')},Q.bracket=function(me){return Pe(me)+"]"},Q.bracketPartial=Pe,Q.unbracket=function(me){return xe(me.substr(0,me.length-1))},Q.unbracketPartial=xe,Q.hasValidAxesReferences=function(me){return!_.isEmpty(me)&&!_.some(me,function(Oe){return _.isEmpty(Oe)})}}(re||(re={})),function(Q){Q.getAllExploredStates=function(W){for(var C=[],oe=[],ve=0,B=W;ve<B.length;ve++){var b=B[ve];b.iterate(),C=(0,x.ev)((0,x.ev)([],C,!0),b.completedStates,!0),oe=(0,x.ev)((0,x.ev)([],oe,!0),b.incompleteStates,!0)}return{completedStates:C,incompleteStates:oe}}}(q||(q={}))},51644:function(Ke,Ie,T){T.r(Ie),T.d(Ie,{all:function(){return Y},allSelected:function(){return k},average:function(){return R},binaryOperator:function(){return ee},block:function(){return se},calculate:function(){return U},calculateTable:function(){return H},countX:function(){return O},dateAdd:function(){return X},datesBetween:function(){return D},datesInPeriod:function(){return re},defineReturn:function(){return de},divide:function(){return q},equal:function(){return Q},error:function(){return W},except:function(){return i},filter:function(){return C},functionCall:function(){return S},ifThenElse:function(){return oe},inOperator:function(){return ve},isBlank:function(){return b},isFiltered:function(){return B},isOnOrAfter:function(){return te},joinWithBinaryOperator:function(){return ne},keepFilters:function(){return pe},lastDate:function(){return le},list:function(){return Ce},max:function(){return ye},min:function(){return Pe},minus:function(){return Me},multiply:function(){return xe},newExpression:function(){return N},not:function(){return me},parentheses:function(){return F},power:function(){return Fe},prefixOperator:function(){return K},round:function(){return Oe},sqrt:function(){return g},sumX:function(){return M},summarize:function(){return ie},switchExpression:function(){return f},tableConstructor:function(){return m},treatAs:function(){return d},values:function(){return E}});var x=T(81337),I=T(62458),G=64;function Y(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return I.fF.assertValue(a,"args"),S.apply(void 0,(0,x.ev)(["ALL"],a||[],!1))}function k(a){return I.fF.assertValue(a,"arg"),S("ALLSELECTED",a)}function R(a){return I.fF.assertValue(a,"arg"),S("AVERAGE",a)}function U(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return I.fF.assert(function(){return _.size(a)>0},"args"),S.apply(void 0,(0,x.ev)(["CALCULATE"],a||[],!1))}function H(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return I.fF.assert(function(){return _.size(a)>0},"args"),S.apply(void 0,(0,x.ev)(["CALCULATETABLE"],a||[],!1))}function X(a,u,v){return I.fF.assertValue(a,"date"),I.fF.assertValue(u,"interval"),I.fF.assertValue(v,"period"),S("DATEADD",a,u,v)}function D(a,u,v){return I.fF.assertValue(a,"date"),I.fF.assertValue(u,"start"),I.fF.assertValue(v,"end"),S("DATESBETWEEN",a,u,v)}function re(a,u,v,A){return I.fF.assertValue(a,"date"),I.fF.assertValue(u,"start"),I.fF.assertValue(v,"interval"),I.fF.assertValue(A,"period"),S("DATESINPERIOD",a,u,v,A)}function q(a,u){return I.fF.assertValue(a,"numerator"),I.fF.assertValue(u,"denominator"),S("DIVIDE",a,u)}function Q(a,u,v){var A=ee(a,"=",u);return v?ee(A,"&&",me(b(a))):A}function i(a,u){return I.fF.assertValue(a,"table1"),I.fF.assertValue(u,"table2"),S("EXCEPT",a,u)}function W(a){return I.fF.assertValue(a,"message"),S("ERROR",a)}function C(a,u){return I.fF.assertValue(a,"table"),I.fF.assertValue(u,"condition"),S("FILTER",a,u)}function oe(a,u,v){return I.fF.assertValue(a,"condition"),I.fF.assertValue(u,"positive"),v?S("IF",a,u,v):S("IF",a,u)}function ve(a,u){return I.fF.assertValue(a,"columnName"),I.fF.assertValue(_.size(u)>0,"values"),ee(a,"IN",se("{",u,"}",!0))}function B(a){return I.fF.assertValue(a,"arg"),S("ISFILTERED",a)}function b(a){return I.fF.assertValue(a,"arg"),S("ISBLANK",a)}function te(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return I.fF.assert(function(){return _.size(a)>0},"args"),S.apply(void 0,(0,x.ev)(["ISONORAFTER"],a||[],!1))}function pe(a){return I.fF.assertValue(a,"arg"),S("KEEPFILTERS",a)}function le(a){return I.fF.assertValue(a,"arg"),S("LASTDATE",a)}function ye(a,u){return I.fF.assertValue(a,"first"),I.fF.assertValue(u,"second"),S("MAX",a,u)}function Pe(a,u){return I.fF.assertValue(a,"first"),I.fF.assertValue(u,"second"),S("MIN",a,u)}function Me(a,u){return I.fF.assertValue(a,"left"),I.fF.assertValue(u,"right"),ee(a,"-",u)}function xe(a,u){return I.fF.assertValue(a,"left"),I.fF.assertValue(u,"right"),ee(a,"*",u)}function Fe(a,u){return I.fF.assertValue(a,"left"),I.fF.assertValue(u,"right"),ee(a,"^",u)}function me(a){return I.fF.assertValue(a,"arg"),K("NOT",a)}function Oe(a,u){return I.fF.assertValue(a,"value"),I.fF.assertValue(u,"digits"),S("ROUND",a,u)}function ie(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return I.fF.assert(function(){return _.size(a)>0},"args"),S.apply(void 0,(0,x.ev)(["SUMMARIZE"],a||[],!1))}function M(a,u){return I.fF.assertValue(a,"table"),I.fF.assertValue(u,"calculation"),S("SUMX",a,u)}function g(a){return I.fF.assertValue(a,"calculation"),S("SQRT",a)}function O(a,u){return I.fF.assertValue(a,"table"),I.fF.assertValue(u,"calculation"),S("COUNTX",a,u)}function f(a,u,v){I.fF.assertValue(a,"expression"),I.fF.assertValue(u,"conditions"),I.fF.assertAnyValue(v,"defaultValue");var A=_.map(u,function(Z){return"".concat(Z.value,", ").concat(Z.result)});return S.apply(void 0,v?(0,x.ev)((0,x.ev)(["SWITCH",a],A||[],!1),[v],!1):(0,x.ev)(["SWITCH",a],A||[],!1))}function m(a){I.fF.assertValue(a,"values");var u=_.map(a,function(v){return se("(",v,")")});return se("{",u,"}")}function d(a,u){return I.fF.assertValue(a,"values"),I.fF.assertValue(u,"args"),S("TREATAS",a,u)}function E(a){return I.fF.assertValue(a,"arg"),S("VALUES",a)}function S(a){for(var u=[],v=1;v<arguments.length;v++)u[v-1]=arguments[v];return I.fF.assertValue(a,"functionName"),I.fF.assertValue(u,"args"),"".concat(a).concat(se("(",u,")"))}function F(a){return I.fF.assertValue(a,"expression"),se("(",[a],")")}function K(a,u){return I.fF.assertValue(a,"operator"),I.fF.assertValue(u,"arg"),"".concat(a," ").concat(se("",[u],""))}function ee(a,u,v){I.fF.assertValue(a,"left"),I.fF.assertValue(u,"operator"),I.fF.assertValue(v,"right");var A=[a,u,v].join(" ");return-1===A.indexOf("\n")&&_.size(A)>G?"".concat(a,"\n").concat(l([u,v].join(" "))):A}function ne(a){for(var u=[],v=1;v<arguments.length;v++)u[v-1]=arguments[v];return I.fF.assertValue(a,"operator"),I.fF.assertValue(u,"exprs"),Re.apply(void 0,(0,x.ev)([" ".concat(a)],u||[],!1))}function se(a,u,v,A){if(0===(void 0===A&&(A=!1),I.fF.assertValue(a,"start"),I.fF.assertValue(u,"args"),I.fF.assertValue(v,"end"),_.size(u)))return"".concat(a).concat(v);var Z=Ce.apply(void 0,u||[]);return-1===Z.indexOf("\n")?A?"".concat(a," ").concat(Z," ").concat(v):"".concat(a).concat(Z).concat(v):_.isEmpty(v)?"".concat(a,"\n").concat(l(Z)):"".concat(a,"\n").concat(l(Z),"\n").concat(v)}function de(a,u){return I.fF.assertValue(a,"variables"),I.fF.assertValue(u,"returnValue"),_.isEmpty(a)?u:_.chain(a).map(be).join("\n").value()+"\nRETURN\n".concat(l(u))}function be(a){return I.fF.assertValue(a,"variable"),-1===a.definition.indexOf("\n")?"VAR ".concat(a.name," = ").concat(a.definition):"VAR ".concat(a.name," =\n").concat(l(a.definition))}function Ce(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return Re.apply(void 0,(0,x.ev)([","],a||[],!1))}function Re(a){for(var u=[],v=1;v<arguments.length;v++)u[v-1]=arguments[v];I.fF.assertValue(u,"args");var A=_.size(u);if(0===A)return"";if(1===A)return u[0];var Z="".concat(a," "),he="".concat(a,"\n"),ue=_.size(Z),Ee=_.chain(u).map(function(ge){return ge.length}).sum().value()+(A-1)*ue;return u.join(Ee>G?he:Z)}function N(a){return"\n"+a}function l(a){return I.fF.assertValue(a,"text"),a.replace(new RegExp("^","gim"),"\t")}},26657:function(Ke,Ie,T){T.d(Ie,{$b:function(){return Pe},AA:function(){return W},Io:function(){return ve},Mf:function(){return i},Q8:function(){return le},SN:function(){return C},TS:function(){return pe},VJ:function(){return ye},ao:function(){return B},gD:function(){return Me},gN:function(){return oe},mK:function(){return te},q7:function(){return b}});var x=T(81337),I=T(50550),G=T(62458),Y=T(76001),k=T(94419),R=T(5361),U=T(45334),H=T(45551),X=T(80777),D=T(74082),re=T(58295),q=T(45413),Q=T(80366);function i(f,m,d){G.fF.assertValue(f,"inputs"),G.fF.assertValue(m,"expressions"),G.fF.assertValue(d,"schema");var E=_.clone(m);E.push.apply(E,function(f){for(var m=[],d=0,E=f;d<E.length;d++){var F=(0,Y.Q)(E[d]);if(F&&F.columnHierarchyLevelVariation){var K=(0,Q.Mu)(F.columnHierarchyLevelVariation.source);m.push(K)}}return m}(E)||[]),E.push.apply(E,function(f){for(var m=[],d=0,E=f;d<E.length;d++){var S=E[d];(0,re.k)(S)||m.push((0,k.Sh)([S],[[(0,k.LS)()]]))}return m}(E)||[]);for(var S=function(f,m,d){for(var E=_.sortBy(f,function(Ce){return function(f){if(f.column)return!!f.column.type;if(f.measure)return!!f.measure.type;if(f.constant)return!0;if(f.instance){var m=f.instance.column;return m&&!!m.type}}(Ce)?0:1}),S=_.map(m,function(Ce){return O.create(Ce,d)}),F=[],K={},ne=function(Re){var N=_.find(S,function(a){return function(Re,N){return Fe(Re.value.expression,Re.metadata,N,d)&&U.m.indexOfExpr(F,Re.value.expression)<0}(a,Re)});if(N){var l=N.value;K[Re.name]=l,F.push(l.expression)}},se=0,de=E;se<de.length;se++)ne(de[se]);return K}(f,E,d),F=0,K=f;F<K.length;F++){var ee=K[F];ee.constant&&!S[ee.name]&&(S[ee.name]={expression:(0,k.kQ)(ee.constant.defaultValue,ee.constant.type)})}return S}function W(f,m,d){return G.fF.assertValue(m,"input"),G.fF.assertValue(d,"schema"),f&&f.expression&&Fe(f.expression,f.expression.getMetadata(d),m,d)}var C=function(f){function m(d,E){var S=f.call(this)||this;return S.exprToReplace=d,S.replacement=E,S}return(0,x.ZT)(m,f),m.rewrite=function(d,E,S){return(0,q.fS)(E,S)?d:d.accept(new m(E,S))},m.prototype.visitColumnRef=function(d){return(0,q.fS)(this.exprToReplace,d)?this.replacement:f.prototype.visitColumnRef.call(this,d)},m.prototype.visitEntity=function(d){return(0,q.fS)(this.exprToReplace,d)?this.replacement:f.prototype.visitEntity.call(this,d)},m}(R.b);function oe(f,m,d){G.fF.assertValue(f,"sourceExprs"),G.fF.assertValue(m,"schema");var E=_.chain(f).map(function(de){return de.getTargetColumnRef(m)}).filter(function(de){return!!de}).value(),F=[];!function de(be,Ce,Re){for(var N=0,l=Re;N<l.length;N++){var a=l[N];if(!(0,I.dB)(Ce,a,q.fS)){Ce.push(a);for(var u=(0,x.ev)((0,x.ev)((0,x.ev)([],a.getKeyColumns(m)||[],!0),U.m.getColumnnsWithKey(a,m)||[],!0),a.getOrderByColumns(m)||[],!0),v=0,A=(0,x.ev)([a],u||[],!0);v<A.length;v++){var Z=A[v];(0,I.dB)(F,Z,q.fS)||d&&(0,I.dB)(E,Z,q.fS)||F.push(Z)}de(be,Ce,u)}}}(F,[],E);for(var ee=0,ne=f;ee<ne.length;ee++)F=B(ne[ee],F,m);return F}function ve(f,m){G.fF.assertValue(f,"expr"),G.fF.assertValue(m,"schema");var d=f.getTargetColumnRef(m);if(d){var E=(0,x.ev)((0,x.ev)([],f.getOrderByColumns(m)||[],!0),[f],!1),S=f.getKeyColumns(m),F=_.size(S);return(F>1||1===F&&!(0,q.fS)(S[0],d))&&E.push.apply(E,S||[]),B(f,E,m)}}function B(f,m,d){if(G.fF.assertValue(f,"sourceExpr"),G.fF.assertValue(m,"expressions"),G.fF.assertValue(d,"schema"),!(0,D.ez)(f))return m;var E=(0,H.cH)(f);if(!E)return m;var S=f.getTargetColumnRef(d).getTargetEntity();return S?_.map(m,function(F){return C.rewrite(F,S,E)}):m}function b(f,m){G.fF.assertValue(f,"expr"),G.fF.assertValue(m,"schema");var d=f.getTargetEntity(),E=f.getConceptualProperty(m,!0);if(E&&E.column&&!_.isEmpty(E.column.variations)){var S=_.find(E.column.variations,function(ee){return ee.isDefault});if(S){var F=m.schema(d.schema).findTargetEntityOfVariation(d.entity,E.name,S.name);if(F){var K=_.find(F.properties,function(ee){return ee.type.temporal&&ee.type.temporal.paddedDateTableDate});if(K)return(0,k.Oh)((0,k.yU)(d,S.name,E.name),K.name)}}}}function te(f,m){G.fF.assertValue(f,"expr"),G.fF.assertValue(m,"schema");var d=f.getTargetEntity();if(!d)return!1;var E=_.find(m.schema(d.schema).entities,function(F){return F.name===d.entity}),S=f.getConceptualProperty(m);return E&&E.isDateTable&&S&&S.column&&S.column.idOnEntityKey&&_.isEmpty(S.column.keys)}function pe(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];G.fF.assertValue(f,"validationResults");var d={errors:{},warnings:{}};if(0===_.size(f))return d;for(var E=0,S=f;E<S.length;E++){var F=S[E];if(F){if(F.warnings)for(var K in F.warnings)d.warnings[K]=F.warnings[K];if(F.errors)for(var ee in F.errors)d.errors[ee]=F.errors[ee]}}return d}function le(f,m,d,E){if(G.fF.assertValue(f,"template"),G.fF.assertValue(E,"paramaters"),!f.validate)return{warnings:{},errors:{}};var S=f.validate(m,d,E);return(S=S||{warnings:{},errors:{}}).warnings=S.warnings||{},S.errors=S.errors||{},S}function ye(f){return G.fF.assertValue(f,"expression"),(0,D.Hi)(f)&&1===_.size(f.values)&&1===_.size(f.values[0])&&(0,D.FU)(f.values[0][0])}function Pe(f){if(f&&(0,D.Hi)(f)){var m=f.args,d=[];if(1===_.size(m)&&_.size(f.values)>0){for(var E=0,S=f.values;E<S.length;E++){var F=S[E];if(1!==_.size(F)||!(0,D.VC)(F[0]))return;d.push(F[0])}return{arg:m[0],values:d}}}}function Me(f){return null!=f.getExpression}function Fe(f,m,d,E){if(G.fF.assertValue(f,"expressionValue"),G.fF.assertValue(d,"input"),G.fF.assertValue(E,"schema"),d.column)return M(m,0,d.column.type);if(d.measure)return((0,D.kb)(f)||(0,D.iV)(f))&&M(m,1,d.measure.type);if(d.constant)return d.constant.type.enumeration?(0,D.VC)(f)&&_.some(d.constant.type.enumeration.members(),function(F){return F.value===f.value}):(0,D.VC)(f)&&g(m,d.constant.type);if(d.instance&&(0,D.Hi)(f)&&f.args&&1===f.args.length){var S=f.args[0].getMetadata(E);return!_.isEmpty(f.values)&&M(S,0,d.instance.column.type)}}function M(f,m,d){return f&&f.kind===m&&g(f,d)}function g(f,m){if(!m)return!0;var d=X.Ge.fromDescriptor(m);return f&&f.type&&d.isCompatibleFrom(f.type,!0)}var O=function(){function f(){}return f.create=function(m,d){return G.fF.assertValue(m,"expression"),G.fF.assertValue(d,"schema"),{value:{expression:m},metadata:m.getMetadata(d)}},f}()},35747:function(Ke,Ie,T){T.r(Ie),T.d(Ie,{VisualCalcEditorModule:function(){return ca},VisualCalcServiceLazyProvider:function(){return or},VisualCalcServicePromiseFactory:function(){return ar}});var x=T(77476),I=T(17174),G=T(98665),Y=T(26898),k=T(83008),R=T(21024),U=T(48145),H=T(27980),X=T(22824),D=T(83342),re=T(9844),q=T(67659),Q=T(79061),i=T(50423),W=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({}),r}(),C=T(81337),oe=T(74611),ve=T(55375),B=T(75334),b=T(8898),te=T(62458),pe=T(18950),le=T(65181),ye=function(r){return r[r.GetDataModel=0]="GetDataModel",r[r.ApplyChange=1]="ApplyChange",r[r.ManageRelationship=2]="ManageRelationship",r[r.PendingChange=3]="PendingChange",r[r.AutodetectRelationship=4]="AutodetectRelationship",r}({}),Me=function(){function r(e,t,n,o){var s=this;this.errorService=e,this.eventAggregationService=t,this.featureSwitchService=n,this.localizationService=o,this.clientSystemErrorCategories=["ModelObjectState","Structural","Unknown"],this.handleGeneralSystemOrExternalErrors=function(c,y,P){void 0===P&&(P=!0);var w=s.localizationService.get(s.commonErrorMessages.get(c).systemOrExternalErrorKey),j=!1;return P&&(s.handleDefaultError(c,y),j=!0),s.eventHandling(w,w,!1),j},this.handleDefaultError=function(c,y){var P=s.commonErrorMessages.get(c).systemOrExternalErrorKey,w=s.commonErrorMessages.get(c).errorType;return s.defaultErrorDialog(s.localizationService.get(P),w,y),!0},this.defaultErrorDialog=function(c,y,P){s.errorService.error(c,y,{requestId:P.requestId,statusCode:P.status&&P.status.toString(),errorDetails:s.getErrorDetails(P),stackTrace:s.getStackTrace(P.error)})},this.handleModelStateUserErrors=function(c,y){switch(s.getErrorObject(y).code){case"ModelOutOfSync":return s.handleModelOutOfSyncError(),!0;case"DataModelVersionNotSupported":return s.handleDataModelVersionNotSupported(),!0;case"ApplyPendingChanges":return s.handleApplyPendingChanges(y),!0;case"DeleteDataSourceNotSupported":return s.handleDeleteDataSourceError(),!0;case"InvalidCapacityState":return!!s.featureSwitchService.featureSwitches.detectFabricCapacityStateErrors&&(s.handleInvalidCapacityStateError(c,y),!0)}return!1},this.handleGeneralUserErrors=function(c,y,P,w,j){var z=s.getErrorObject(y).code;if(s.handleModelStateUserErrors(c,y))return!0;switch(z){case"NameValidationError":return s.handleNameValidationError(y),!0;case"RelationshipError":return s.handleRelationshipError(y,!0),!0;case"ASOperationExceptionError":return s.handleASOperationError(y,j),!0;default:return!!P&&(s.handleUnknownUserError(y,c),!0)}},this.handlGetDataModelUserErrors=function(c,y){return s.handleModelStateUserErrors(c,y)||s.tryHandleUnknowUserError(y,c),!0},this.handleUnknownUserError=function(c,y){if(!s.tryHandleClientSystemError(c,y)){var P=s.tryHandleUnknowUserError(c,y),w=s.commonErrorMessages.get(y).unkownUserErrorKey;s.eventHandling(s.localizationService.get(w),P||s.getErrorDetails(c),!1)}},this.commonErrorMessages=new Map([[ye.GetDataModel,{systemOrExternalErrorKey:"WebModeling_GetDataModelSystemOrExternalError",unkownUserErrorKey:"WebModeling_GetDataModelUnKnownUserError",errorType:"webModelingGetDataModelFailure"}],[ye.ApplyChange,{systemOrExternalErrorKey:"WebModeling_ApplyChangeSystemOrExternalError",unkownUserErrorKey:"WebModeling_ApplyChangeUnKnownUserError",errorType:"webModelingApplyChangeFailure"}],[ye.ManageRelationship,{systemOrExternalErrorKey:"WebModeling_ManageRelationshipSystemOrExternalError",unkownUserErrorKey:"WebModeling_ManageRelationshipUnKnownUserError",errorType:"webModelingManageRelaitonshipFailure"}],[ye.PendingChange,{systemOrExternalErrorKey:"WebModeling_PendingChangeFailed",unkownUserErrorKey:"WebModeling_PendingChangeFailed",errorType:"webModelingPendingChangeFailure"}],[ye.AutodetectRelationship,{systemOrExternalErrorKey:"WebModeling_AutodetectRelationshipSystemOrExternalError",unkownUserErrorKey:"WebModeling_AutodetectRelationshipUnknownError",errorType:"webModelingAutodetectRelationshipFailure"}]])}return r.prototype.handleApplyChangeErrors=function(e,t,n,o,s){return this.associateTelemetryEvent=t,this.handleError(e,ye.ApplyChange,n?this.handleGeneralUserErrors:this.handleModelStateUserErrors,this.handleGeneralSystemOrExternalErrors,o,!1,s)},r.prototype.handleGetDataModelErrors=function(e){this.handleError(e,ye.GetDataModel,this.handlGetDataModelUserErrors,this.handleDefaultError)},r.prototype.handleManageRelationshipErrors=function(e,t){this.associateTelemetryEvent=t,this.handleError(e,ye.ManageRelationship,this.handleGeneralUserErrors,this.handleGeneralSystemOrExternalErrors)},r.prototype.handlePendingChangeError=function(e,t){this.handleError(e,ye.PendingChange,this.handleGeneralUserErrors,this.handleDefaultError),this.eventHandling("WebModeling_PendingChangeFailed","WebModeling_PendingChangeFailed",!0)},r.prototype.handleAutodetectRelationshipError=function(e,t){this.associateTelemetryEvent=t,this.handleError(e,ye.AutodetectRelationship,this.handleGeneralUserErrors,this.handleGeneralSystemOrExternalErrors)},r.prototype.handleError=function(e,t,n,o,s,c,y){void 0===s&&(s=!0),void 0===c&&(c=!0);var P=this.getErrorObject(e);return P&&P["pbi.error"]?1===P["pbi.error"].exceptionCulprit?n(t,e,s,c,y):o(t,e,s):!!s&&(this.defaultErrorDialog(this.getErrorDetails(e),this.commonErrorMessages.get(t).errorType,e),!0)},r.prototype.handleModelOutOfSyncError=function(){this.displayUserErrorDialog(this.localizationService.get("ErrorMessage_DefaultTitle"),this.localizationService.get("WebModeling_ModelOutOfSync")),this.eventHandling(this.localizationService.get("WebModeling_ModelOutOfSync"),"",!0)},r.prototype.handleDataModelVersionNotSupported=function(){var e=this.localizationService.get("DataModelVersionNotSupportedMessage");this.displayUserErrorDialog(this.localizationService.get("PendingChangesTitle"),e),this.eventHandling("ModelingEngineError",e,!1)},r.prototype.handleApplyPendingChanges=function(e){var t=this.getErrorMessage(e);te.fF.assertValue(t,"The error message in applyPendingChanges should not be empty."),this.displayUserErrorDialog(this.localizationService.get("PendingChangesTitle"),t),this.eventHandling("ModelingEngineError",t,!1)},r.prototype.handleDeleteDataSourceError=function(){var e=this.localizationService.get("DeleteDataSourceNotAllowedMessage");this.displayUserErrorDialog(this.localizationService.get("DeleteDataSourceNotAllowedTitle"),e),this.eventHandling("ModelingEngineError",e,!1)},r.prototype.handleNameValidationError=function(e){var o,t=this.getDetailValue(e,"ModelingServiceError_ObjectType"),n=this.getErrorMessage(e);switch(te.fF.assertValue(t,"The object type in nameValidationError should not be empty."),te.fF.assertValue(n,"The error message in nameValidationError should not be empty."),t){case"Hierarchy":o=this.localizationService.get("RenameHierarchyTitle");break;case"Column":o=this.localizationService.get("RenameColumnTitle");break;case"Level":o=this.localizationService.get("RenameHierarchyLevelTitle");break;case"Measure":o=this.localizationService.get("RenameMeasureErrorTitle");break;case"Table":o=this.localizationService.get("RenameTableTitle");break;default:te.fF.assertFail("Unexpected object type failed name validation: "+t),o=this.localizationService.get("RenameItemTitle")}te.fF.assertValue(n,"The error message in nameValidationError should not be empty."),this.displayUserErrorDialog(o,n),this.eventHandling("ModelingEngineError",n,!1)},r.prototype.handleInvalidCapacityStateError=function(e,t){var n,o,s=this.localizationService.get(this.commonErrorMessages.get(e).unkownUserErrorKey),c=this.getErrorObject(t),y=c&&c["pbi.error"];if(this.containsCapacityExceptionCause(y)){var P=this.getCapacityExceptionCause(y);o="https://aka.ms/capacitymessages",n=this.localizationService.format("FabricThrottled"===P||"PowerBIThrottled"===P?"CapacityThrottledGenericErrorContent":"FabricCapacityNotAvailableErrorContent")}else n=this.getErrorMessage(t);te.fF.assertValue(n,"Error message not calculated"),te.fF.assertValue(s,"Error title not calculated"),this.displayUserErrorDialog(s,n,o),e!==ye.GetDataModel&&this.eventHandling("InvalidCapacityState",n,!1)},r.prototype.handleASOperationError=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c,y;return(0,C.Jh)(this,function(P){if(t.length>0&&t.every(function(w){return!!w.setDataType}))s=(0,oe.dr)(t[0].setDataType.dataType),c=s?this.localizationService.get(s):null,n=this.localizationService.format("ReportModelChangeColumnDataTypeFailedMessage",c),o=this.localizationService.get("Error");else switch(n=this.getErrorMessage(e),y=this.getDetailValue(e,"ModelingServiceError_AdditionalErrorCode"),y){case"PFE_TM_ALTERNATEOF_INVALID_RLS":o=this.localizationService.get("ManageRolesASExceptionForRLSWithAggsMessageTitle");break;case"PFE_TM_NO_SFB_FOR_RLS_TABLE":o=this.localizationService.get("ManageRolesASExceptionForCrossFilteringRelationshipsMessageTitle"),n=this.localizationService.get("ManageRolesASExceptionForCrossFilteringRelationshipsMessage");break;case"PFE_XM_COLUMN_UNIQUE_CONSTRAINT":o=this.localizationService.get("KeyColumnUniquenessErrorTitle"),n=this.localizationService.get("KeyColumnUniquenessErrorMessage");break;case"PFE_TM_RLS_NOT_SUPPORTED_ON_PROXY_TABLE":o=this.localizationService.get("WebModeling_ApplyChangeUnKnownUserError"),n=this.localizationService.get("RLS_Error_Message_For_ProxyModels");break;default:o=this.localizationService.get("Error")}return te.fF.assertValue(n,"Error message not calculated"),te.fF.assertValue(o,"Error title not calculated"),this.displayUserErrorDialog(o,n),this.eventHandling("ASOperationExceptionError",n,!1),[2]})})},r.prototype.handleRelationshipError=function(e,t){var n=this.getErrorMessage(e);te.fF.assertValue(n,"The error message in relationshipError should not be empty."),t&&this.displayUserErrorDialog(this.localizationService.get("InvalidRelationshipTitle"),n),this.eventHandling("WebModeling_ChangeRelationshipFailed",n,!1)},r.prototype.eventHandling=function(e,t,n){this.eventAggregationService.publishToClient("ModelChangeFailedEvent",[{errorInfoKey:e,errorInfoValue:t}]),this.eventAggregationService.publishToClient("LoadClientDataModelEvent",{refreshModel:n})},r.prototype.tryHandleUnknowUserError=function(e,t){var n=this.getErrorMessage(e);return n?this.displayUserErrorDialog(this.localizationService.get(this.commonErrorMessages.get(t).unkownUserErrorKey),n):this.defaultErrorDialog(this.localizationService.get(this.commonErrorMessages.get(t).unkownUserErrorKey),this.commonErrorMessages.get(t).errorType,e),n},r.prototype.tryHandleClientSystemError=function(e,t){var n=this.getClientSideSystemError(e);if(n){this.logClientSystemErrorIntoTelemetry(e.requestId,n,t.toString());var o=this.commonErrorMessages.get(t).unkownUserErrorKey;return this.eventHandling(this.localizationService.get(o),this.getErrorDetails(e),!0),this.defaultErrorDialog(this.localizationService.get(o),this.commonErrorMessages.get(t).errorType,e),!0}return!1},r.prototype.logClientSystemErrorIntoTelemetry=function(e,t,n){if(this.associateTelemetryEvent){var o=this.associateTelemetryEvent.event.info;o.hasClientSystemError=!0,o.apiErrorSource=n,o.errorCategory=t,o.stackTrace=this.getStackTrace()}},r.prototype.getClientSideSystemError=function(e){var t=this.getDetailValue(e,"ModelingServiceError_UserErrorCategory");if(this.clientSystemErrorCategories.find(function(n){return n===t}))return t},r.prototype.displayUserErrorDialog=function(e,t,n){this.errorService.error(t,"modelingError",{title:e,source:"User",hideGetHelpLink:!n,getHelpTextOverride:n?"Generic_LearnMore":void 0,showAdditionalErrorInfo:!1,helpLink:n})},r.prototype.getErrorDetails=function(e){var t;return JSON.stringify(null!==(t=this.getErrorObject(e))&&void 0!==t?t:e.data)},r.prototype.getDetailValue=function(e,t){return r.getDetailValueFromApiObject(this.getErrorObject(e),t)},r.getDetailValueFromApiObject=function(e,t){var n,o=e&&e["pbi.error"];if(!o)throw"pbi.error object doesn't exist in the error response";var s=_.find(o.details,function(c){return c.code===t});return null===(n=s?.detail)||void 0===n?void 0:n.value},r.prototype.getErrorMessage=function(e){return r.getErrorMessageFromApiObject(this.getErrorObject(e))},r.getErrorMessageFromApiObject=function(e){var t;return null!==(t=r.getDetailValueFromApiObject(e,"ModelingServiceError_Reason"))&&void 0!==t?t:""},r.prototype.getErrorObject=function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.error},r.prototype.getStackTrace=function(e){var t;return e?null===(t=e.innererror)||void 0===t?void 0:t.trace:(new Error).stack},r.prototype.getCapacityExceptionCause=function(e){if(e){var t=Array.isArray(e.parameters)?_.first(e.parameters):e.parameters;return t&&t.CapacityExceptionCause}},r.prototype.containsCapacityExceptionCause=function(e){return void 0!==this.getCapacityExceptionCause(e)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(pe.T),i.\u0275\u0275inject(b.x),i.\u0275\u0275inject(D.vZ),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),xe=T(68082),Fe=T(53439),me=T(65843),Oe=T(33197),ie=T(58938),M=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.moveMeasure=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c;return(0,C.Jh)(this,function(P){switch(P.label){case 0:t=[],n=0,o=e,P.label=1;case 1:return n<o.length?[4,this.moveMeasureAllowed((c=(s=o[n]).measureMove).property,c.schema,c.destination,c.source)]:[3,4];case 2:P.sent()&&t.push(s),P.label=3;case 3:return n++,[3,1];case 4:return _.isEmpty(t)?[2]:[4,this.modelAuthoring.apply({changes:t})];case 5:return P.sent(),[2]}})})},r.prototype.moveMeasureAllowed=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){var s;return(0,C.Jh)(this,function(c){return s=this.dataModelService.getDataModel(),(0,oe.Gz)(s,t,n,e)?(ve.Z.buildCancelDialog(this.localizationService.get("MoveMeasureConfirmationTitle"),this.localizationService.format("MoveMeasureNameConflict",n,e),"MoveMeasureCancellationDialog",this.dialogService,this.localizationService),[2,!1]):[2,!0]})})},r.prototype.createNewCalcTable=function(){var e=this.localizationService.get("Table_ToolTip"),t=B.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Table",null,e,null);return this.applySchemaChangesWithIsNewFlag([{newCalculatedTableCreated:{entity:t,schema:null,expression:""}}],me.X6.getTableUrn(t))},r.prototype.createNewCalcColumn=function(e,t){te.fF.assertValue(e,"Table not supplied for new column");var n=this.localizationService.get("Column"),o=B.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Column",e,n,null),s=[{newCalculatedColumnCreated:{entity:e,name:o,schema:null}}];if(t?.displayFolder){var c={setDisplayFolder:{modelObject:me.X6.getColumnUrn(e,o,null),displayFolder:t.displayFolder}};s.push(c)}return this.applySchemaChangesWithIsNewFlag(s,me.X6.getColumnUrn(e,o))},r.prototype.createNewMeasure=function(e,t,n){te.fF.assertValue(e,"Table not supplied for new measure");var o=this.localizationService.get("Measure"),s=B.cm.makeValidName(this.dataModelService.getDataModel(),this.localizationService,"Measure",e,o,t),c=[{newMeasureCreated:{entity:e,name:s,schema:t,expression:"",dataType:"WholeNumber"}}];if(n?.displayFolder){var y={setDisplayFolder:{modelObject:me.X6.getMeasureUrn(e,s,t),displayFolder:n.displayFolder}};c.push(y)}return this.applySchemaChangesWithIsNewFlag(c,me.X6.getMeasureUrn(e,s,t))},r.prototype.updateCalculation=function(e,t,n,o,s,c){var y,P;return(0,C.mG)(this,void 0,void 0,function(){var w,z,ae,ce;return(0,C.Jh)(this,function(fe){switch(fe.label){case 0:return w=Oe.G.createObject(e),[4,this.showUpdateCalculationConfirmation(w)];case 1:return fe.sent()?(z={updateExpression:{modelObject:e,expression:s?"":n,anonymizedExpression:o,expressionOverride:s,errorMessage:c}},ce=null!==(P=null===(y=w.getSecondLevelPart())||void 0===y?void 0:y.name)&&void 0!==P?P:w.getTopLevelPart().name,t&&t!==ce&&(ae="Table"===w.getObjectType()?{entityRename:{before:ce,after:t,schema:w.getSchemaName()}}:{propertyRename:{objectType:w.getObjectType(),entity:w.getTopLevelPart().name,before:ce,after:t,schema:w.getSchemaName()}}),[4,this.updateExpressionAndRename(z,ae)]):[2];case 2:return fe.sent(),[2]}})})},r.prototype.updateExpressionAndRename=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,c;return(0,C.Jh)(this,function(y){switch(y.label){case 0:return y.trys.push([0,2,,4]),c={changes:[e]},t&&(c.changes[1]=t),[4,this.modelAuthoring.apply(c,!0)];case 1:case 3:return y.sent(),[3,4];case 2:return n=y.sent(),o=Me.getErrorMessageFromApiObject(n),c={changes:[{updateExpression:{modelObject:e.updateExpression.modelObject,expression:"",anonymizedExpression:"",expressionOverride:{expression:e.updateExpression.expression},errorMessage:o}}]},t&&(c.changes[1]=t),[4,this.modelAuthoring.apply(c,!1)];case 4:return[2]}})})},r.prototype.showUpdateCalculationConfirmation=function(e){var t;return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c,y,P,w;return(0,C.Jh)(this,function(ae){switch(ae.label){case 0:return n=e.getSchemaName(),o=e.getTopLevelPart().name,s=null===(t=e.getSecondLevelPart())||void 0===t?void 0:t.name,c=this.dataModelService.getDataModel(),[],P=(0,oe.Lc)(c,n,o,s),y=s?(0,oe.L9)([P]):P.columns.filter(function(ce){return"CalculatedTableColumn"===ce.columnType}),(w=this.getUserSemanticDependentsAsDisplayableString(y))?[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("ChangeCalculationLabel"),message:this.localizationService.format("ModelingChangeConfirmationWithDependents",w)},"ChangeCalculationUserSemanticDependentsTitle",this.dialogService,this.localizationService)]:[3,3];case 1:return[4,ae.sent().afterClosed().toPromise()];case 2:return[2,1===ae.sent()];case 3:return[2,!0]}})})},r.prototype.getUserSemanticDependentsAsDisplayableString=function(e){if(!_.isEmpty(e)){var t=(0,oe.Y3)(e,this.localizationService);if(!_.isNull(t)&&!_.isEmpty(t))return t.join(this.localizationService.get("ListJoin_Separator"))}},r.prototype.applySchemaChangesWithIsNewFlag=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n={setAnnotation:{annotationName:oe.j0,value:"True",modelObject:t}},[4,this.modelAuthoring.apply({changes:(0,C.ev)((0,C.ev)([],e,!0),[n],!1)})];case 1:return o.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),g=T(70863),O=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.setDataType=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.setDataType_internal(e,t,n,o)];case 1:return s.sent(),[2]}})})},r.prototype.setDescription=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return e&&0!==e.length&&0===e.filter(function(n){return!n.object.canEdit}).length?[4,this.SetDescriptionBySchemaChanges(e)]:[2];case 1:return t.sent(),[2]}})})},r.prototype.SetDescriptionBySchemaChanges=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return t=[],e.forEach(function(o){(0,g.t3)(o.object)||(0,g.kb)(o.object)||(0,g.y3)(o.object)||(0,g.ez)(o.object)||(0,g.wb)(o.object)?t.push({setDescription:{description:o.newValue,modelObject:o.object.urn}}):te.fF.assertFail("Trying to set description on unsupported object")}),[4,this.setDescription_internal(t)];case 1:return n.sent(),[2]}})})},r.prototype.setDescription_internal=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c,y,P,w,j,z,ae;return(0,C.Jh)(this,function(Se){switch(Se.label){case 0:for(t=this.dataModelService.getDataModel(),n=[],o=0,s=e;o<s.length;o++)te.fF.assertValue((c=s[o]).setDescription,"The SetDescription schemaChange shouldn't be empty"),1===(y=new Oe.M(c.setDescription.modelObject)).getParts().length&&"Table"===y.getTopLevelPart().objectType&&(P=(0,oe.Xt)(t,y.getTopLevelPart().name),w=(0,oe.aP)(P),j=(0,oe.q1)(P),(0,oe.oQ)(P,c.setDescription.description,w?.name,j?.name)&&n.push(P));return 0===n.length?[3,3]:(z=n.map(function(Le){return Le.name}).join(this.localizationService.get("ListJoin_Separator")),ae=this.localizationService.format(1===n.length?"DeleteDescriptionConfirmationWithCuration":"DeleteDescriptionConfirmationMultipleWithCuration",z),[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("DeleteDescriptionConfirmationTitle"),message:ae},"DeleteDescriptionConfirmationDialog",this.dialogService,this.localizationService,this.localizationService.get("Clear"))]);case 1:return[4,Se.sent().afterClosed().toPromise()];case 2:if(1!==Se.sent())return[2];Se.label=3;case 3:return[4,this.modelAuthoring.apply({changes:e})];case 4:return Se.sent(),[2]}})})},r.prototype.setDataType_internal=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){var s,c,y,P,w,j,z,ae,ce,fe,Se,Le,De,gt,xt=this;return(0,C.Jh)(this,function(ft){switch(ft.label){case 0:for(s=[],c=this.dataModelService.getDataModel(),y=0,P=e;y<P.length;y++)"Column"===(w=P[y]).objectType&&(De=(0,oe.Gz)(c,w.schema,w.tableName,w.itemName))&&s.push(De);for(j=[],z=s.filter(function(st){return xt.isLossyConversion(st,t)}),ae=this.getUserSemanticDependentsAsDisplayableString(s),_.isEmpty(z)?ae&&j.push(this.localizationService.format("ModelingChangeConfirmationWithDependents",ae)):j.push(ae?this.localizationService.format("LossyDataTypeChangeConfirmationWithDependents",ae):this.localizationService.get("LossyDataTypeChangeConfirmationMessage")),ce=function(yt){var At=c.expressions.filter(function(en){return _.isEqual(en.parameterValuesColumn,yt)});if(At&&!_.isEmpty(At))return j.push(fe.localizationService.get("DQP_Incompatible_Data_Type")),"break"},fe=this,Se=0,Le=s;Se<Le.length&&"break"!==ce(De=Le[Se]);Se++);return _.isEmpty(j)?[3,3]:[4,ve.Z.buildOKCancelDialogWithList(this.localizationService.get("DataTypeChangeConfirmationTitle"),j,"DataTypeChangeConfirmationTitle",this.localizationService.get("DataTypeChangeConfirmation"),this.dialogService,this.localizationService)];case 1:return[4,ft.sent().afterClosed().toPromise()];case 2:if(1!==ft.sent())return[2];ft.label=3;case 3:return gt=[],e.forEach(function(st){var yt;"Column"===st.objectType?yt=me.X6.getColumnUrn(st.tableName,st.itemName,st.schema):"Measure"===st.objectType&&(yt=me.X6.getMeasureUrn(st.tableName,st.itemName,st.schema)),gt.push({setDataType:{dataType:t,clearTableValues:n,sourceProviderType:o,modelObject:yt}})}),[4,this.modelAuthoring.apply({changes:gt})];case 4:return ft.sent(),[2]}})})},r.prototype.getUserSemanticDependentsAsDisplayableString=function(e){var t=(0,oe.Y3)(e,this.localizationService);if(null!==t&&0!==t.length)return t.join(this.localizationService.get("ListJoin_Separator"))},r.prototype.isLossyConversion=function(e,t){var n=(0,oe.iQ)(e);return!!n[t]&&n[t]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),f=T(33565),m=T(34145),d=new i.InjectionToken("SchemaChangeService"),E=function(){return function(e,t,n){this.existingLevelUrn=e,this.levelName=t,this.columnName=n}}(),S=function(){function r(e,t,n){this.modelService=e,this.schemaChangeService=t,this.deleteModelItemService=n}return r.prototype.createHierarchy=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c,y,P,w,ae;return(0,C.Jh)(this,function(ce){switch(ce.label){case 0:return t=(0,g.QA)(this.modelService.model.tables,e.table.name),n=t.hierarchies?t.hierarchies.getItems().map(function(fe){return fe.name}):[],[4,this.schemaChangeService.createHierarchy([e])];case 1:for(ce.sent(),o=(0,g.QA)(this.modelService.model.tables,e.table.name),s=o.hierarchies?o.hierarchies.getItems().map(function(fe){return fe.name}):[],y=function(Se){if(_.every(n,function(Le){return Le!==Se}))return c=Se,"break"},P=0,w=s;P<w.length&&"break"!==y(w[P]);P++);return c?(ae=(0,g.QA)(o.hierarchies,c),e.displayFolder?[4,this.schemaChangeService.setDisplayFolder([{object:ae,newValue:e.displayFolder}])]:[3,3]):[3,4];case 2:return ce.sent(),o=(0,g.QA)(this.modelService.model.tables,e.table.name),[2,(0,g.QA)(o.hierarchies,c)];case 3:return[2,ae];case 4:return[2,null]}})})},r.prototype.createHierarchyFromMultiple=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c,y,P,w,ae;return(0,C.Jh)(this,function(ce){switch(ce.label){case 0:return t=(0,g.QA)(this.modelService.model.tables,e[0].table.name),n=t.hierarchies?t.hierarchies.getItems().map(function(fe){return fe.name}):[],[4,this.schemaChangeService.createHierarchy(e)];case 1:for(ce.sent(),o=(0,g.QA)(this.modelService.model.tables,e[0].table.name),s=o.hierarchies?o.hierarchies.getItems().map(function(fe){return fe.name}):[],y=function(Se){if(_.every(n,function(Le){return Le!==Se}))return c=Se,"break"},P=0,w=s;P<w.length&&"break"!==y(w[P]);P++);return c?(ae=(0,g.QA)(o.hierarchies,c),e[0].displayFolder?[4,this.schemaChangeService.setDisplayFolder([{object:ae,newValue:e[0].displayFolder}])]:[3,3]):[3,4];case 2:return ce.sent(),o=(0,g.QA)(this.modelService.model.tables,e[0].table.name),[2,(0,g.QA)(o.hierarchies,c)];case 3:return[2,ae];case 4:return[2,null]}})})},r.prototype.applyLevelChanges=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,s,c,y=this;return(0,C.Jh)(this,function(P){switch(P.label){case 0:return o=[],e.levels.getItems().forEach(function(w){var j=t.find(function(z){return z.levelName===w.name});j?j.existingLevelUrn||(j.existingLevelUrn=w.urn):o.push(w)}),s=[],c=[],t.forEach(function(w,j){var z;w.existingLevelUrn&&(z=(0,g.Tr)(e.levels,w.existingLevelUrn)),z?z.ordinal!==j&&s.push({object:z,newValue:j}):c.push(y.createLevel(e,w.levelName,w.columnName,j,n))}),c.length>0&&s.length>0&&c.length+s.length>1?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(c,s,null)]:[3,2];case 1:return P.sent(),[3,6];case 2:return c.length>0?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(c,null,null)]:[3,4];case 3:return P.sent(),[3,6];case 4:return s.length>0&&c.length+s.length>1?[4,this.schemaChangeService.createLevelsAndOrSetLevelOrdinal(null,s,null)]:[3,6];case 5:P.sent(),P.label=6;case 6:return o.length>0?[4,this.deleteModelItemService.deleteAllFromModel(o,!c.length)]:[3,8];case 7:P.sent(),P.label=8;case 8:return[2]}})})},r.prototype.addNewLevels=function(e,t){var n=[];e.levels.getItems().forEach(function(o){var s=new E(o.urn,o.name,o.column.name);n.push(s)}),t.forEach(function(o){if(!n.find(function(c){return c.columnName===o.name})){var s=new E(null,o.name,o.name);n.push(s)}}),this.applyLevelChanges(e,n)},r.prototype.createLevelWithName=function(e,t,n,o){return void 0===o&&(o=!0),{name:t,displayName:void 0,lineageTag:"",description:"",hierarchy:e,column:(0,g.QA)(e.table.columns,n),schemaName:e.schemaName,canEdit:void 0,canDelete:void 0,canRename:void 0,urn:me.X6.getLevelUrn(e.table.name,void 0,e.name,t,e.schemaName),ordinal:void 0,modelObjectType:"Level"}},r.prototype.createLevel=function(e,t,n,o,s){return void 0===s&&(s=!1),{schema:e.schemaName,entity:e.table.name,hierarchy:e.name,property:n,levelName:t,index:void 0!==o?o:e.levels.length}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(m.q),i.\u0275\u0275inject(d),i.\u0275\u0275inject(f.c))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),F=T(67789),K=new i.InjectionToken("ModernModalDialogService"),se=T(48787),de="GroupsDialog",be=function(r){return r[r.CloseDialog=0]="CloseDialog",r[r.ChangeTab=1]="ChangeTab",r[r.AssignPaneRoleSelection=2]="AssignPaneRoleSelection",r[r.Revert=3]="Revert",r}({}),Ce=function(){function r(e,t,n,o,s){this.dataModelService=e,this.dialogService=t,this.featureSwitchService=n,this.localizationService=o,this.modalDialogService=s,document.modelingDialogService=this}return r.prototype.openDataSearchCurationDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return t={title:this.localizationService.get("FeaturedTable_Setup_Title"),okButtonText:this.localizationService.get("ModalDialog_Save"),hideCancelButton:!1,focusInitialCloseButton:!0,input:{table:e}},[4,this.dialogService.showTemplateDialog("DataSearchCurationComponent",t,{minHeight:453,width:"650px"})];case 1:return o.sent(),[2]}})})},r.prototype.openRemoveOrDeleteTableDialog=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var s=this;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return[4,this.dialogService.openHostDialog({dialogName:"Remove or delete this table?",componentName:"RemoveOrDeleteTableComponent",bindings:{multipleTables:e},config:{minHeight:170,width:"575px",panelClass:["no-padding"],backdropClass:"cdk-overlay-transparent-backdrop"}})];case 1:return c.sent().afterClosed().pipe((0,se.q)(1)).subscribe(function(y){return(0,C.mG)(s,void 0,void 0,function(){return(0,C.Jh)(this,function(P){return t(y),[2]})})}),[2]}})})},r.prototype.openManageAggregationsDialog=function(e){var t;return(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return!(n=this.dataModelService.getDataModel()).tables.find(function(y){return _.isEqual(y.name,e)}).capabilities.canEdit||null!==(t=n.expressions)&&void 0!==t&&t.find(function(y){return null!=y.parameterValuesColumn})?[3,2]:[4,this.dialogService.openHostDialog({componentName:"ManageAggregationsComponent",dialogName:"Manage aggregations",autoFocus:!0,bindings:{table:e},config:{height:"628px",width:"800px",backdropClass:"cdk-overlay-transparent-backdrop",panelClass:["pbi-dialog","no-padding"]}})];case 1:c.sent(),c.label=2;case 2:return[2]}})})},r.prototype.openManageRelationshipsDialog=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,n=this;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return e={title:this.localizationService.get("Manage_Relationships"),okButtonText:"Close",hideCancelButton:!0,focusInitialCloseButton:!0},[4,this.dialogService.showTemplateDialog("ManageRelationshipsComponent",e)];case 1:return o.sent().afterClosed().pipe((0,se.q)(1)).subscribe(function(s){return(0,C.mG)(n,void 0,void 0,function(){return(0,C.Jh)(this,function(c){switch(c.label){case 0:return"OpenNewRelationshipDialog"!==s?.closeStatus?[3,2]:[4,this.openCreateRelationshipDialog(s.args,!0)];case 1:return c.sent(),[3,4];case 2:return"OpenEditRelationshipDialog"!==s?.closeStatus?[3,4]:[4,this.openEditRelationshipDialog(s.args,!0)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}),[2]}})})},r.prototype.openFixMissingRelationshipsDialog=function(e,t){return void 0===t&&(t=!1),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return n={title:this.localizationService.get("RelationshipDetection_Tooltip"),showDefaultActions:!1,input:{tables:e,autodetect:t}},[4,this.dialogService.showTemplateDialog("FixMissingRelationshipsDialogComponent",n)];case 1:return[2,s.sent().afterClosed().toPromise()]}})})},r.prototype.openDeleteLayoutConfirmDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,ve.Z.buildOKCancelDialog({title:this.localizationService.format("WebDiagram_Delete_LayoutName",e),message:this.localizationService.format("WebDiagram_Delete_LayoutMessage")},"Delete Layout",this.dialogService,this.localizationService,this.localizationService.format("Delete"))];case 1:return[2,n.sent().afterClosed().toPromise()]}})})},r.prototype.openIncrementalRefreshPolicyDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,c,y;return(0,C.Jh)(this,function(w){switch(w.label){case 0:return t=this.dataModelService.getDataModel(),n=t.tables.find(function(j){return _.isEqual(j.name,e)}),(o=n.capabilities.canSetIncrementalRefreshPolicy&&n.capabilities.canEdit)&&!this.featureSwitchService.enableHybridTables?[4,this.dialogService.openHostDialog({componentName:"IncrementalRefreshPolicyComponent",dialogName:"Incremental Refresh Policy",autoFocus:!0,bindings:{table:e},config:{height:"668px",width:"660px",backdropClass:"cdk-overlay-transparent-backdrop",panelClass:["pbi-dialog","no-padding"]}})]:[3,2];case 1:case 3:return w.sent(),[2];case 2:return o&&this.featureSwitchService.enableHybridTables?(c={table:e},y={title:this.localizationService.get("Incremental_Refresh_With_DQ_Title"),input:c,okButtonText:this.localizationService.get("Apply"),isDraggable:!0},[4,this.dialogService.showTemplateDialog("IncrementalRefreshPolicyWithDirectQueryComponent",y,{width:"614px",height:"700px"})]):[3,4];case 4:return[2]}})})},r.prototype.openRLSEditorDialog=function(){return(0,C.mG)(this,void 0,void 0,function(){var e;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return e={title:this.localizationService.get("RLS_Editor_Title"),cancelButtonText:this.localizationService.get("Close"),okButtonText:this.localizationService.get("ModalDialog_Save"),okButtonDisabled:!0,input:null,dontCloseOnDefaultActions:!0},[4,this.dialogService.showTemplateDialog("RLSEditorDialogComponent",e,{width:"1068px"})];case 1:return n.sent(),[2]}})})},r.prototype.openRLSEditorConfirmationDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s;return(0,C.Jh)(this,function(P){switch(P.label){case 0:switch(n=this.localizationService.get("SaveChanges"),o=this.localizationService.get("ModalDialog_Save"),s=this.localizationService.get("ModalDialog_DontSave"),e){case be.AssignPaneRoleSelection:t=this.localizationService.get("RLS_Editor_SaveChanges_Message_SwitchRole");break;case be.ChangeTab:t=this.localizationService.get("RLS_Editor_SaveChanges_Message_Tabbing");break;case be.CloseDialog:t=this.localizationService.get("RLS_Editor_SaveChanges_Message");break;case be.Revert:t=this.localizationService.get("RLS_Editor_RevertChanges_Message"),n=this.localizationService.get("Revert_Changes"),o=this.localizationService.get("MobileReport_RevertText"),s=this.localizationService.get("Cancel_ButtonText")}return[4,ve.Z.buildOKCancelDialog({title:n,preventEscPropagation:!0,message:t},"SaveChangesDialog",this.dialogService,this.localizationService,o,s)];case 1:return[4,P.sent().afterClosed().toPromise()];case 2:return[2,P.sent()]}})})},r.prototype.openCreateRelationshipDialog=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.openCreateOrEditRelationshipDialog(e,null,!!t)];case 1:return[2,n.sent()]}})})},r.prototype.openGroupDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return this.featureSwitchService.modernGroupingDialog?(t={title:this.localizationService.get("Groups"),input:e,hideOkButton:!1,hideCancelButton:!1,okButtonText:this.localizationService.get("OK_ButtonText"),okButtonDisabled:!0},[4,this.dialogService.showTemplateDialog(de,t)]):[3,3];case 1:return[4,o.sent().afterClosed().toPromise()];case 2:return[2,o.sent()];case 3:return[2,this.modalDialogService.showHostModalDialog({dialogName:de,definitionTemplateCachePath:"components/groupsDialog/groupsDialogDefinition.html",bindings:{args:e}})]}})})},r.prototype.openEditRelationshipDialog=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:if(n=this.dataModelService.getDataModel(),!(o=(0,oe.Te)(n,e.fromTableId,e.toTableId,e.fromColumnId,e.toColumnId)))throw new Error("relationship does not exist for editing");return s={fromTableId:e.fromTableId,fromColumnId:e.fromColumnId,toTableId:e.toTableId,toColumnId:e.toColumnId,canEdit:o.capabilities.canEdit,isActive:o.isActive,crossFilterDirection:o.crossFilteringBehavior.toString(),fromCardinality:o.fromCardinality.toString(),toCardinality:o.toCardinality.toString(),securityFilteringBehavior:o.securityFilteringBehavior.toString(),referentialIntegrity:o.referentialIntegrity},[4,this.openCreateOrEditRelationshipDialog(s,o.name,!!t)];case 1:return[2,c.sent()]}})})},r.prototype.openCreateOrEditRelationshipDialog=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,s,y,P=this;return(0,C.Jh)(this,function(w){switch(w.label){case 0:return o={title:this.localizationService.get(t?"Edit_Relationship":"New_Relationship"),okButtonText:this.localizationService.get("ModalDialog_Save"),hideCancelButton:!1,focusInitialCloseButton:!0,backButton:n,dontCloseOnAction:!0,input:{relationshipName:t,fromTable:e.fromTableId,fromColumn:e.fromColumnId,toTable:e.toTableId,toColumn:e.toColumnId,canEdit:e.canEdit,isActive:e.isActive,crossFilterDirection:e.crossFilterDirection,fromCardinality:e.fromCardinality,toCardinality:e.toCardinality,securityFilteringBehavior:e.securityFilteringBehavior,referentialIntegrity:e.referentialIntegrity,backToManageRelationshipDialogAfterClose:n}},s=this.featureSwitchService.newManageRelationshipDialog&&this.dataModelService.getDataModel().capabilities.supportManageRelationships,[4,this.dialogService.showTemplateDialog("CreateOrEditRelationshipComponent",o,{minHeight:s?"775":"545",minwidth:s?"686":"727"})];case 1:return(y=w.sent()).afterClosed().pipe((0,se.q)(1)).subscribe(function(j){return(0,C.mG)(P,void 0,void 0,function(){return(0,C.Jh)(this,function(z){switch(z.label){case 0:return!0!==j?.backToManageRelationshipDialog?[3,2]:[4,this.openManageRelationshipsDialog()];case 1:z.sent(),z.label=2;case 2:return[2]}})})}),[2,y]}})})},r.prototype.openGenerateModelItemDescriptionDialog=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o;return(0,C.Jh)(this,function(y){switch(y.label){case 0:return e||(e=this.localizationService.get("None")),n={currentDescription:e,args:t},o={title:this.localizationService.get("Review_Copilot_Measure_Description"),okButtonText:this.localizationService.get("Keep_It"),cancelButtonText:this.localizationService.get("Settings_DiscardButtonText"),input:n},[4,this.dialogService.showTemplateDialog("GenerateModelItemDescriptionsComponent",o,{width:"640px",panelClass:["generateModelItemDescriptionDialog"]})];case 1:return[4,y.sent().afterClosed().toPromise()];case 2:return[2,y.sent()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(F.h),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(K))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Re=T(83164),N=function(){function r(e){this.modelAuthoring=e}return r.prototype.applyRoleSettings=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.applyChanges(e)];case 1:return[2,!!(t=n.sent())&&"Failed"!==t.resultStatus]}})})},r.prototype.verifyRoleSettings=function(e){var t,n;return(0,C.mG)(this,void 0,void 0,function(){var o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.applyChanges(e,!0)];case 1:return o=s.sent(),[2,null!==(n=null===(t=o.clientDataModel)||void 0===t?void 0:t.dataModel.roles)&&void 0!==n?n:[]]}})})},r.prototype.applyChanges=function(e,t){return void 0===t&&(t=!1),(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(o){switch(o.label){case 0:return[4,this.modelAuthoring.apply({changes:e},void 0,t)];case 1:return[2,o.sent()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),l=T(70604),a=T(66339),u=function(){function r(e,t){this.modelAuthoring=e,this.telemetryService=t}return r.prototype.renameObjects=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)?n.push({propertyRename:{schema:s.object.schemaName,entity:s.object.table.name,objectType:"Column",before:s.object.name,after:s.newName}}):(0,g.kb)(s.object)||(0,g.jz)(s.object)?n.push({propertyRename:{schema:s.object.schemaName,entity:s.object.table.name,objectType:"Measure",before:s.object.name,after:s.newName}}):(0,g.y3)(s.object)?n.push({propertyRename:{schema:s.object.schemaName,entity:s.object.table.name,objectType:"Hierarchy",before:s.object.name,after:s.newName}}):(0,g.ez)(s.object)?n.push({hierarchyLevelRename:{schema:s.object.schemaName,entity:s.object.hierarchy.table.name,hierarchy:s.object.hierarchy.name,before:s.object.name,after:s.newName}}):(0,g.wb)(s.object)?n.push({entityRename:{schema:s.object.schemaName,before:s.object.name,after:s.newName}}):(0,g.RF)(s.object)?n.push({propertyRename:{schema:s.object.schemaName,entity:s.object.calculationGroup.table.name,objectType:"CalculationItem",before:s.object.name,after:s.newName}}):te.fF.assertFail("Trying to 'renameObjects' unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDisplayFolder=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)||(0,g.kb)(s.object)||(0,g.y3)(s.object)?n.push({setDisplayFolder:{displayFolder:s.newValue,modelObject:s.object.urn}}):te.fF.assertFail("Trying to set displayFolder on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setIsHidden=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n,o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return n=[],e.forEach(function(c){if((0,g.wb)(c.object))o=me.X6.getTableUrn(c.object.name,c.object.schemaName);else if((0,g.t3)(c.object))o=me.X6.getColumnUrn(c.object.table.name,c.object.name,c.object.schemaName);else if((0,g.kb)(c.object))o=me.X6.getMeasureUrn(c.object.table.name,c.object.name,c.object.schemaName);else{if(!(0,g.y3)(c.object))throw"Trying to set isHidden on unsupported object";o=c.object.urn}n.push({itemShowHide:{makeHidden:c.newValue,modelObject:o}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,s.sent()]}})})},r.prototype.setIsCuratedForDataSearch=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.wb)(s.object)?n.push({updateDataSearchCuration:{schema:s.object.schemaName,entity:s.object.name,isCurationEnabled:s.newValue}}):te.fF.assertFail("Trying to disable/enable data search curation on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.refreshData=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=_.map(e,function(s){return{entityRefresh:{schema:s.schemaName,entity:s.name}}}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.createLevelsAndOrSetLevelOrdinal=function(e,t,n){return void 0===n&&(n=null),(0,C.mG)(this,void 0,void 0,function(){var o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return o=[],e?.forEach(function(c){o.push({hierarchyLevelCreate:c})}),t?.forEach(function(c){(0,g.ez)(c.object)?o.push({hierarchyLevelMove:{schema:c.object.hierarchy.table.schemaName,entity:c.object.hierarchy.table.name,hierarchy:c.object.hierarchy.name,level:c.object.name,index:c.newValue}}):te.fF.assertFail("Trying to set ordinal on unsupported object")}),[4,this.pushOrApplyChanges(o,n)];case 1:return[2,s.sent()]}})})},r.prototype.createHierarchy=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.pushOrApplyChanges([{hierarchyCreate:{schema:e[0].table.schemaName,entity:e[0].table.name,name:null,levels:e.map(function(o){return{property:o.name,columnName:o.name}})}}],t)];case 1:return[2,n.sent()]}})})},r.prototype.setDescription=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.vP)(s.object)||(0,g.t3)(s.object)||(0,g.kb)(s.object)||(0,g.y3)(s.object)||(0,g.wb)(s.object)?n.push({setDescription:{description:s.newValue,modelObject:s.object.urn}}):(0,g.ez)(s.object)?te.fF.assertFail("Trying to set description on unsupported object (hierarchy level)"):te.fF.assertFail("Trying to set description on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setIsNullable=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)?n.push({setColumnNullable:{isNullable:s.newValue,modelObject:s.object.urn}}):te.fF.assertFail("Trying to set isNullable on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setSummarizeBy=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)?n.push({setDefaultSummarization:{aggregateFunction:"Default"===s.newValue?null:s.newValue,modelObject:s.object.urn}}):te.fF.assertFail("Trying to set sortByColumn on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDataCategory=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){n.push({setDataCategory:{modelObject:s.object.urn,dataCategory:s.newValue}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDecimalPlaces=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)||(0,g.kb)(s.object)?n.push({setDecimalPlaces:{decimalPlaces:s.newValue,modelObject:s.object.urn}}):te.fF.assertFail("Trying to set DecimalPlaces on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.toggleThousandsSeparator=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){n.push({toggleThousandsSeparator:{modelObject:s.urn}})}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setKeyColumn=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.wb)(s.object)?n.push({updateKeyColumn:{schema:s.object.schemaName,entity:s.object.name,property:s.newValue}}):te.fF.assertFail("Trying to set key column on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setDefaultLabel=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.wb)(s.object)?n.push({updateDefaultLabel:{modelObject:s.newValue?me.X6.getColumnUrn(s.object.name,s.newValue):s.object.urn}}):te.fF.assertFail("Trying to set default label on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.apply=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){return t=new l.B,e&&e.changes&&e.changes.length&&(this.telemetryService.logApplyChanges(this.getChangeNames(e)),this.modelAuthoring.apply(e).then(function(o){t.resolve()},function(o){te.fF.log(JSON.stringify(o)),t.reject(o.message)})),[2,t.promise]})})},r.prototype.setAlternateSourcePrecedence=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.wb)(s.object)?n.push({setTableAlternateSourcePrecedence:{schema:s.object.schemaName,entity:s.object.name,alternateSourcePrecedence:s.newValue}}):te.fF.assertFail("Trying to set AlternateSourcePrecedence on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setSortByColumn=function(e,t){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return n=[],e.forEach(function(s){(0,g.t3)(s.object)?n.push({sortByAnotherColumn:{sortByProperty:s.newValue,modelObject:s.object.urn}}):te.fF.assertFail("Trying to set sortByColumn on unsupported object")}),[4,this.pushOrApplyChanges(n,t)];case 1:return[2,o.sent()]}})})},r.prototype.setFormatInformation=function(e,t,n){return void 0===t&&(t=null),(0,C.mG)(this,void 0,void 0,function(){var o,s=this;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return o=[],e.forEach(function(y){if((0,g.t3)(y.object)||(0,g.kb)(y.object)){var P=s.createFormatInformationSchemaChange(y.object,y.newValue,n);P&&o.push(P)}else te.fF.assertFail("Trying to set formatInformation on unsupported object")}),[4,this.pushOrApplyChanges(o,t)];case 1:return[2,c.sent()]}})})},r.prototype.getChangeNames=function(e){return e.changes.map(function(t){return Object.keys(t)}).reduce(function(t,n){return(0,C.ev)((0,C.ev)([],t,!0),n,!0)})},r.prototype.pushOrApplyChanges=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return t?(t.changes||(t.changes=[]),e.length&&(n=t.changes).push.apply(n,e||[]),[2,null]):[3,1];case 1:return[4,this.apply({changes:e})];case 2:return[2,o.sent()]}})})},r.prototype.createFormatInformationSchemaChange=function(e,t,n){var o=null,s=e.formatInformation;return s.format!==t.format||"Custom"===t.format?o=this.changeFormatFormatInformationSchemaChange(e,t,n):t.dateTimeCustomFormat?o={setDateTimeFormatInfo:{format:t.format,dateTimeCustomFormatGroup:t.dateTimeCustomFormat.formatGroup,formatString:t.dateTimeCustomFormat.formatString,modelObject:e.urn}}:s.thousandSeparator!==t.thousandSeparator?o={toggleThousandsSeparator:{modelObject:e.urn}}:s.accuracy!==t.accuracy?o={setDecimalPlaces:{decimalPlaces:t.accuracy,modelObject:e.urn}}:t.currencyFormat&&(o={setCurrencyFormatInfo:{culture:t.currencyFormat.culture,currencySymbol:t.currencyFormat.currencySymbol,positivePattern:t.currencyFormat.positivePattern,negativePattern:t.currencyFormat.negativePattern,format:t.format,modelObject:e.urn}}),o},r.prototype.changeFormatFormatInformationSchemaChange=function(e,t,n){switch(void 0===n&&(n=e.formatString),t.format){case"CurrencyGeneral":case"CurrencyCustom":return{setCurrencyFormatInfo:{culture:t.currencyFormat.culture,currencySymbol:t.currencyFormat.currencySymbol,positivePattern:t.currencyFormat.positivePattern,negativePattern:t.currencyFormat.negativePattern,format:t.format,modelObject:e.urn}};case"DateTimeGeneralPattern":case"DateTimeCustom":return{setDateTimeFormatInfo:{format:t.format,dateTimeCustomFormatGroup:t.dateTimeCustomFormat.formatGroup,formatString:t.dateTimeCustomFormat.formatString,modelObject:e.urn}};case"Custom":return{setCustomFormatStringInfo:{formatString:n,modelObject:e.urn}};default:return{setFormatting:{format:t.format,modelObject:e.urn}}}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(a.L))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),v=new i.InjectionToken("DataQueriesExecutionService"),A=T(49346),Z=T(82762),he=T(14172),ue=T(59822);function Ee(r,e){var t,n=new Ge(e);return r.getColumnsCardinalityInfo?t=n.visitGetColumnsCardinality(r.getColumnsCardinalityInfo):r.validateReferentialIntegrity?t=n.visitValidateReferentialIntegrity(r.validateReferentialIntegrity):r.getTableData?t=n.visitGetTableData(r.getTableData):r.isValidKeyForDateTable?t=n.visitIsValidKeyForDateTable(r.isValidKeyForDateTable):r.canSortByColumn&&(t=n.visitCanSortByColumn(r.canSortByColumn)),t}var ge=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("columns"))throw new Error("expect getColumnsCardinalityInfo has columns property");var n=this.dataQueriesExecutionResponse.dataQueries,o=[];if(1!==t.columns.length)throw new Error("Expect to only have one column in getColumnsCardinalityInfo query as for now.");for(var s=function(w){var j=n.queries[w];if(j.getColumnsCardinalityInfo){var z=t.columns.map(function(Se){return Se.column})[0],ce=j.getColumnsCardinalityInfo.columns.map(function(Se){return Se.column}).findIndex(function(Se){return Se===z});if(ce>-1)return o.push([w,[ce]]),"break"}},c=0;c<n.queries.length&&"break"!==s(c);c++);return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.getColumnsCardinalityInfo)throw new Error("getColumnsCardinalityInfo should be found from dataQueriesResult");var o=e[0][1][0];if(n.getColumnsCardinalityInfo.columnsCardinalityInfo.length<o)throw new Error("target column cannot be found from getColumnsCardinalityInfo dataQueriesResult");return{columnsCardinalityInfo:[n.getColumnsCardinalityInfo.columnsCardinalityInfo[o]]}},r}(),we=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("foreignKeyColumn")||!t.hasOwnProperty("primaryKeyColumn"))throw new Error("expect validateReferentialIntegrity has foreignKeyColumn or primaryKeyColumn property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],s=0;s<n.queries.length;s++){var c=n.queries[s];if(c.validateReferentialIntegrity&&c.validateReferentialIntegrity.foreignKeyColumn===t.foreignKeyColumn&&c.validateReferentialIntegrity.primaryKeyColumn===t.primaryKeyColumn){o.push([s,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.validateReferentialIntegrity)throw new Error("validateReferentialIntegrity should be found from dataQueriesResult");return(0,C.pi)({},n.validateReferentialIntegrity)},r}(),Ne=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("table")||!t.hasOwnProperty("columnNames"))throw new Error("expect getTableData has table or columns property");var n=this.dataQueriesExecutionResponse.dataQueries,o=[];if(t.columnNames.length<=0)throw new Error("Expect to have at least one column in getTableData");for(var s=function(P){var w=n.queries[P];if(w.getTableData){var j=!0,z=w.getTableData.columnNames;_.forEach(t.columnNames,function(ae){(z.findIndex(function(fe){return fe===ae})<0||w.getTableData.table!==t.table)&&(j=!1)}),j&&o.push([P,[0]])}},c=0;c<n.queries.length;c++)s(c);return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.getTableData)throw new Error("getTableData should be found from dataQueriesResult");return(0,C.pi)({},n.getTableData)},r}(),Ae=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("column"))throw new Error("expect isValidKeyForDateTable has column property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],s=0;s<n.queries.length;s++){var c=n.queries[s];if(c.isValidKeyForDateTable&&c.isValidKeyForDateTable.column===t.column){o.push([s,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.dateColumnValidations)throw new Error("dateColumnValidations should be found from dataQueriesResult");return(0,C.pi)({},n.dateColumnValidations)},r}(),Ve=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.getTargetQueryLocation=function(e){var t=e;if(!t.hasOwnProperty("column"))throw new Error("expect canSortByColumn has column property");if(!t.hasOwnProperty("sortByColumn"))throw new Error("expect canSortByColumn has sortByColumn property");if(!t.hasOwnProperty("tablePartitionMode"))throw new Error("expect canSortByColumn has tablePartitionMode property");for(var n=this.dataQueriesExecutionResponse.dataQueries,o=[],s=0;s<n.queries.length;s++){var c=n.queries[s];if(c.canSortByColumn&&c.canSortByColumn.column===t.column&&c.canSortByColumn.sortByColumn===t.sortByColumn&&c.canSortByColumn.tablePartitionMode===t.tablePartitionMode){o.push([s,[0]]);break}}return o},r.prototype.getTargetQueryResult=function(e){if(1!==e.length)throw new Error("Expect to have only one target query");if(1!==e[0][1].length)throw new Error("Expect to only have one target column from query");var n=this.dataQueriesExecutionResponse.dataQueriesResult.queriesResult[e[0][0]];if(!n.canSortByColumn)throw new Error("canSortByColumn should be found from dataQueriesResult");return(0,C.pi)({},n.canSortByColumn)},r}(),Ge=function(){function r(e){this.dataQueriesExecutionResponse=e}return r.prototype.visitGetColumnsCardinality=function(e){var t=new ge(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitValidateReferentialIntegrity=function(e){var t=new we(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitGetTableData=function(e){var t=new Ne(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitIsValidKeyForDateTable=function(e){var t=new Ae(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.visitCanSortByColumn=function(e){var t=new Ve(this.dataQueriesExecutionResponse);return this.getTargetQueryResult(e,t)},r.prototype.getTargetQueryResult=function(e,t){var n=t.getTargetQueryLocation(e);return t.getTargetQueryResult(n)},r}(),Ze=function(){function r(e,t){this._code=e,this._errorValue=t}return Object.defineProperty(r.prototype,"code",{get:function(){return this._code},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"pbi.error",{get:function(){return{code:this._code,details:[{code:"ModelingServiceError_Reason",detail:{type:1,value:this._errorValue}}],parameters:[]}},enumerable:!1,configurable:!0}),r}();function nt(r,e,t){return new Promise(function(n,o){(0,Z.D)(e.executeDataQueries({queries:r})).pipe((0,he.U)(function(s){return s}),(0,ue.K)(function(s){throw t})).subscribe(function(s){return n(s)},function(s){return o(s)})})}function dt(r,e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,e];case 1:return t=n.sent(),[2,Ee(r,t)]}})})}var Je=function(r){function e(){return r.call(this)||this}return(0,C.ZT)(e,r),e}(Error),$e=T(96608),We=function(){function r(e,t){this.telemetryService=e,this.dataQueriesExecutionService=t,this.cache=new Map}return r.prototype.ngOnDestroy=function(){this.cache.clear()},r.prototype.setDataQueryCache=function(e,t){this.checkDataQueryDefined(e),this.checkDataQueryResponseDefined(t);var n=this.getCacheKey(e);this.cache.set(n,t)},r.prototype.isDataQueryInCache=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);return this.cache.has(t)},r.prototype.getDataQueryRequest=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);if(!this.isDataQueryInCache(e))throw new Je;return this.cache.get(t)},r.prototype.removeCache=function(e){this.checkDataQueryDefined(e);var t=this.getCacheKey(e);return this.cache.delete(t)},r.prototype.tryToConstructDataQueriesRequestIfMissInCache=function(e,t,n){void 0===n&&(n=function(ce){return ce});for(var o=[],s=0,c=e;s<c.length;s++){var P=!0;this.isDataQueryInCache(y=c[s])||(o.push(y),P=!1),this.telemetryService.logEvent(A.g4,{isCacheHit:P,cacheKey:JSON.stringify(y)})}if(!_.isEmpty(o))for(var w=nt(n(o),this.dataQueriesExecutionService,t),j=0,z=o;j<z.length;j++){var y;this.setDataQueryCache(y=z[j],w)}},r.prototype.getCacheKey=function(e){return JSON.stringify(e)},r.prototype.checkDataQueryDefined=function(e){if(!e)throw new Error("dataQuery is not defined")},r.prototype.checkDataQueryResponseDefined=function(e){if(!e)throw new Error("dataQueryResponse is not defined")},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject($e.y0),i.\u0275\u0275inject(v))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),ht=function(){function r(e,t,n,o,s,c,y,P){this.modelAuthoring=e,this.dataModelService=t,this.featureSwitchService=n,this.dialogService=o,this.localizationService=s,this.executeDataQueriesRequestCacheService=c,this.dataQueriesExecutionService=y,this.telemetryService=P}return r.prototype.setSortByColumn=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return e&&0!==e.length?[4,this.setSortByColumn_internal(e)]:[2];case 1:return t.sent(),[2]}})})},r.prototype.setSortByColumn_internal=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c,y,P,w,z,ce;return(0,C.Jh)(this,function(fe){switch(fe.label){case 0:for(t=this.dataModelService.getDataModel(),n=[],o=[],s=function(Le){y=Oe.G.createObject(Le.modelObject),te.fF.assert(function(){return 2===y.getParts().length},"Should have 2 parts in model object");var De=(0,oe.Xt)(t,y.getTopLevelPart().name);if(Le.sortByProperty){var Xe=De.columns.find(function(at){return at.name===Le.sortByProperty});if(te.fF.assert(function(){return!!Xe},"sortByColumn is invalid or not found on the table."),(0,oe.ef)(Xe))return c.showErrorDialog(c.localizationService.format("SortByAnotherColumnInvalidColumnErrorMessage",y.getSecondLevelPart().name,Le.sortByProperty)),{value:void 0};var ot=me.X6.getColumnUrn(De.name,Xe.name,Xe.schemaName);o.push({canSortByColumn:{column:y.toString(),sortByColumn:ot,tablePartitionMode:(0,oe.iJ)(De)}})}n.push({sortByAnotherColumn:Le})},c=this,P=0,w=e;P<w.length;P++)if("object"==typeof(z=s(w[P])))return[2,z.value];fe.label=1;case 1:return fe.trys.push([1,3,,4]),[4,this.runDataQueryValidation(o)];case 2:return fe.sent()?[3,4]:[2];case 3:if((ce=fe.sent())instanceof Ze&&"ExecuteDataQueriesFailed"===ce.code)return this.showErrorDialog(this.localizationService.get("DateTableDialog_GenericErrorMessage")),[2];throw ce;case 4:return[4,this.modelAuthoring.apply({changes:n})];case 5:return fe.sent(),[2]}})})},r.prototype.showErrorDialog=function(e){ve.Z.buildCancelDialog(this.localizationService.get("SortByAnotherColumnErrorTitle"),e,"setSortByColumnDialog",this.dialogService,this.localizationService)},r.prototype.runDataQueryValidation=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s,c,y,P,w,j,ae,ce,fe=this;return(0,C.Jh)(this,function(Se){switch(Se.label){case 0:if(!e||_.isEmpty(e))return[2,!0];t=this.telemetryService.startEvent(A.TM,{}),n=e.filter(function(Le){return!function(r,e){return!r&&"DirectLake"===e}(fe.featureSwitchService.allowDirectLakeDataValidation,Le.canSortByColumn.tablePartitionMode)}),o=n.filter(function(Le){return!fe.executeDataQueriesRequestCacheService.isDataQueryInCache(Le)}),_.isEmpty(o)||(s=nt(o,this.dataQueriesExecutionService,new Ze("ExecuteDataQueriesFailed",this.localizationService.format("SortByColumnValidationExecuteDataQueriesFailed"))),o.forEach(function(Le){return fe.executeDataQueriesRequestCacheService.setDataQueryCache(Le,s)})),c=!0,P=0,w=n,Se.label=1;case 1:return P<w.length?[4,this.getDataQueryResult(j=w[P])]:[3,4];case 2:if(!Se.sent().isValid)return c=!1,ae=Oe.G.createObject((y=j).canSortByColumn.column),ce=Oe.G.createObject(y.canSortByColumn.sortByColumn),this.showErrorDialog(this.localizationService.format("SortByAnotherColumnMoreThanOneValueErrorMessage",ae.getSecondLevelPart().name,ce.getSecondLevelPart().name)),[3,4];Se.label=3;case 3:return P++,[3,1];case 4:return y&&(t.event.info.errors=JSON.stringify(y)),t.resolve(),[2,c]}})})},r.prototype.getDataQueryResult=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache(e))throw new Error("data query should be found from cache");if(!e.canSortByColumn)throw new Error("Expect canSortByColumn to be present on the data query");return t=this.executeDataQueriesRequestCacheService.getDataQueryRequest(e),[4,dt(e,t)];case 1:if(!(n=o.sent()).hasOwnProperty("isValid"))throw new Error("Expect isValid defined in canSortByColumnResult");return[2,n]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(F.h),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(We),i.\u0275\u0275inject(v),i.\u0275\u0275inject(G.y0))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),mt=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.updateDefaultLabel=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return t=this.dataModelService.getDataModel(),n=Oe.G.createObject(e.modelObject),e&&this.canUpdateDefaultLabel(t,e,n)?[4,this.updateDefaultLabel_internal(t,e,n)]:[2];case 1:return o.sent(),[2]}})})},r.prototype.updateDefaultLabel_internal=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,s,c,y,P,w,j,ce;return(0,C.Jh)(this,function(fe){switch(fe.label){case 0:return o=n.getTopLevelPart().name,s="Table"===n.getObjectType()?void 0:n.getSecondLevelPart().name,c=(0,oe.Xt)(e,o),y=(0,oe.Gz)(e,void 0,o,s),P=(0,oe.aP)(c),(0,oe.oQ)(c,c.description,P?.name,y?.name)?(w=void 0,j=void 0,y&&y.isHidden?(j=this.localizationService.get("HiddenDefaultLabelConfirmationTitle"),w=this.localizationService.format("HiddenDefaultLabelConfirmationMessage",c.name)):(j=this.localizationService.get("UnsetDefaultLabelConfirmationTitle"),w=this.localizationService.format("UnsetDefaultLabelConfirmationMessage",c.name)),[4,ve.Z.buildOKCancelDialog({title:j,message:w},"UpdateDefaultLabelConfirmationDialog",this.dialogService,this.localizationService)]):[3,3];case 1:return[4,fe.sent().afterClosed().toPromise()];case 2:if(1!==fe.sent())return[2];fe.label=3;case 3:return(ce=[]).push({updateDefaultLabel:t}),[4,this.modelAuthoring.apply({changes:ce})];case 4:return fe.sent(),[2]}})})},r.prototype.canUpdateDefaultLabel=function(e,t,n){te.fF.assert(function(){return 1===n.getParts().length&&"Table"===n.getObjectType()||2===n.getParts().length&&"Column"===n.getObjectType()},"objectType and modelObjectUri is not matched");var o=n.getTopLevelPart().name,s="Table"===n.getObjectType()?void 0:n.getSecondLevelPart().name,c=(0,oe.Xt)(e,o),y=(0,oe.Gz)(e,void 0,o,s),P=(0,oe.q1)(c);return c.capabilities.canEdit&&(!y||y.capabilities.canEdit)&&(!P||P.capabilities.canEdit)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Tt=function(){function r(e,t,n,o){this.modelAuthoring=e,this.dataModelService=t,this.dialogService=n,this.localizationService=o}return r.prototype.updateKeyColumn=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return t=this.dataModelService.getDataModel(),e&&this.canUpdateKeyColumn(t,e)?[4,this.updateKeyColumn_internal(t,e)]:[2];case 1:return n.sent(),[2]}})})},r.prototype.updateKeyColumn_internal=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c,y,j;return(0,C.Jh)(this,function(z){switch(z.label){case 0:return n=(0,oe.Xt)(e,t.entity),o=(0,oe.Gz)(e,void 0,t.entity,t.property),s=(0,oe.q1)(n),(0,oe.oQ)(n,n.description,o?.name,s?.name)?(c=void 0,y=void 0,o&&o.isHidden?(y=this.localizationService.get("HiddenKeyColumnConfirmationTitle"),c=this.localizationService.format("HiddenKeyColumnConfirmationMessage",n.name)):(y=this.localizationService.get("UnsetKeyColumnConfirmationTitle"),c=this.localizationService.format("UnsetKeyColumnConfirmationMessage",n.name)),[4,ve.Z.buildOKCancelDialog({title:y,message:c},"UpdateKeyColumnConfirmationDialog",this.dialogService,this.localizationService)]):[3,3];case 1:return[4,z.sent().afterClosed().toPromise()];case 2:if(1!==z.sent())return[2];z.label=3;case 3:return(j=[]).push({updateKeyColumn:t}),[4,this.modelAuthoring.apply({changes:j})];case 4:return z.sent(),[2]}})})},r.prototype.canUpdateKeyColumn=function(e,t){var n=(0,oe.Xt)(e,t.entity),o=(0,oe.Gz)(e,void 0,t.entity,t.property),s=(0,oe.aP)(n);return n.capabilities.canEdit&&(!o||o.capabilities.canEdit)&&(!s||s.capabilities.canEdit)},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ue=T(96898),ut=function(r){return r.MaxNumberOfGroups="MaxNumberOfGroups",r.MaxNumberOfItems="MaxNumberOfItems",r.NotInteger="NotInteger",r.OutOfRangeOrdinal="OutOfRangeOrdinal",r.OutOfRangePrecedence="OutOfRangePrecedence",r.PrecedenceNotUnique="PrecedenceNotUnique",r}({}),Ct=function(){function r(e,t,n,o,s){this.modelAuthoring=e,this.dataModelService=t,this.localizationService=n,this.dialogService=o,this.errorService=s}return r.prototype.createNewCalculationGroup=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,n,o,s,c,y,P,w;return(0,C.Jh)(this,function(j){switch(j.label){case 0:return e=[],t=this.dataModelService.getDataModel(),[4,this.checkAndApplyDiscourageImplicitMeasures(t.discourageImplicitMeasures,e)];case 1:if(!j.sent())return[2];if(this.addFeatureTagIfMissing(e),(n=this.getCalculationGroupInfo()).length)if((s=Math.max.apply(Math,n.map(function(z){return z.precedence})))<Ue.SX)o=s+1;else{if(!(n.length<=Ue.SX))return this.handleUserError(ut.MaxNumberOfGroups),[2];for(c=n.length-2,o=s-1;c>=0&&o!==n[c].precedence;)c--,o-=1}else o=Ue.UI;return y=B.cm.makeValidName(t,this.localizationService,"CalculationGroup",null,this.localizationService.get("CalculationGroup"),null),P={newCalculationGroup:{name:y,columnName:this.localizationService.get("CalculationGroupColumn"),ordinalColumnName:this.localizationService.get("Ordinal"),precedence:o}},w=this.createNewCalculationItemSchemaChange(y,Ue.Ow,this.localizationService.get("CalculationItem"),t.editableSchemaName),e.push(P,w),[4,this.modelAuthoring.apply({changes:e})];case 2:return j.sent(),[2]}})})},r.prototype.addNewCalculationItem=function(e){var t;return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c,y,P,w;return(0,C.Jh)(this,function(j){switch(j.label){case 0:return n=this.dataModelService.getDataModel(),o=null===(t=n.tables.find(function(z){return z.name===e}))||void 0===t?void 0:t.calculationGroup,te.fF.assert(function(){return!!o}),(c=o.calculationItems.map(function(z){return z.ordinal})).length?c.every(function(z){return z===Ue.Ow})?s=Ue.Ow:(y=Math.max.apply(Math,c),s=y<Ue.BT?y+1:y):s=Ue.Ow,this.addFeatureTagIfMissing(P=[]),w=B.cm.makeValidName(n,this.localizationService,"CalculationItem",e,this.localizationService.get("CalculationItem"),null),P.push(this.createNewCalculationItemSchemaChange(e,s,w,n.editableSchemaName)),[4,this.modelAuthoring.apply({changes:P})];case 1:return j.sent(),[2]}})})},r.prototype.handleEditPrecedenceFromReorder=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,y,P=this;return(0,C.Jh)(this,function(w){switch(w.label){case 0:return n=this.getCalculationGroupInfo(),te.fF.assert(function(){return e>=0&&e<n.length&&t>=0&&t<n.length}),o=n[e],e===t?[2]:(o.dirty=!0,e<t&&(n[t].precedence>(t<n.length-1?n[t+1].precedence+1:Ue.UI)?o.precedence=n[t].precedence-1:(o.precedence=n[t].precedence-.5,n.sort(Ue.zb),o.precedence=Math.round(n[t].precedence+.5),this.resolvePrecedenceConflict(n,t-1,-1))),e>t&&(n[t].precedence<(t>0?n[t-1].precedence-1:Ue.SX)?o.precedence=n[t].precedence+1:(o.precedence=n[t].precedence+.5,n.sort(Ue.zb),o.precedence=Math.round(n[t].precedence-.5),this.resolvePrecedenceConflict(n,t+1,1))),y=n.filter(function(j){return j.dirty}).map(function(j){return P.createSetPrecedenceSchemaChange(j.name,j.precedence)}),this.addFeatureTagIfMissing(y),[4,this.modelAuthoring.apply({changes:y})]);case 1:return w.sent(),[2]}})})},r.prototype.handleEditPrecedenceDirectly=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return n=this.getCalculationGroupInfo(),(o=n.find(function(y){return y.name===e})).precedence===t?[2]:n.some(function(y){return y.precedence===t})?(this.handleUserError(ut.PrecedenceNotUnique),[2]):t<Ue.UI||t>Ue.SX?(this.handleUserError(ut.OutOfRangePrecedence),[2]):Number.isSafeInteger(t)?(s=[this.createSetPrecedenceSchemaChange(o.name,t)],this.addFeatureTagIfMissing(s),[4,this.modelAuthoring.apply({changes:s})]):(this.handleUserError(ut.NotInteger),[2]);case 1:return c.sent(),[2]}})})},r.prototype.handleEditOrdinalFromReorder=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,s,c,y,P=this;return(0,C.Jh)(this,function(w){switch(w.label){case 0:return o=this.getCalculationItems(e),te.fF.assert(function(){return null!==o&&t>=0&&t<o.length&&n>=0&&n<o.length}),t===n?[2]:(_.forEach(o,function(j,z){j.ordinal!==z&&(j.ordinal=z,j.dirty=!0)}),s=o[t],c=t>n?_.concat(_.slice(o,0,n),s,_.slice(o,n,t),_.slice(o,t+1)):_.concat(_.slice(o,0,t),_.slice(o,t+1,n+1),s,_.slice(o,n+1)),y=[],_.forEach(c,function(j,z){(j.dirty||j.ordinal!==z)&&y.push(P.createSetOrdinalSchemaChange(e,j.name,z))}),this.addFeatureTagIfMissing(y),[4,this.modelAuthoring.apply({changes:y})]);case 1:return w.sent(),[2]}})})},r.prototype.handleResetAllOrdinalsToDefault=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o=this;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return t=this.getCalculationItems(e),n=t.filter(function(c){return c.ordinal!==Ue.Ow}).map(function(c){return o.createSetOrdinalSchemaChange(e,c.name,Ue.Ow)}),this.addFeatureTagIfMissing(n),[4,this.modelAuthoring.apply({changes:n})];case 1:return s.sent(),[2]}})})},r.prototype.findCalculationGroupIndex=function(e){var t=this.getCalculationGroupInfo();return _.findIndex(t,function(n){return n.name===e})},r.prototype.findCalculationItemIndex=function(e,t){var n=this.getCalculationItems(e);return _.findIndex(n,function(o){return o.name===t})},r.prototype.supportCalculationGroupAuthoring=function(){return this.dataModelService.getDataModel().capabilities.supportCalculationGroupAuthoring},r.prototype.resolvePrecedenceConflict=function(e,t,n){for(var o=function(P){if(e[P].precedence!==e[P-n].precedence)return"break";e[P].precedence-=n,e[P].dirty=!0,te.fF.assert(function(){return e[P].precedence>=Ue.UI&&e[P].precedence<=Ue.SX})},s=t;s>=0&&s<e.length&&"break"!==o(s);s+=n);},r.prototype.checkAndApplyDiscourageImplicitMeasures=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return e?[3,3]:[4,ve.Z.buildOKCancelDialog({title:this.localizationService.get("CalculationGroupEnableDiscourageImplicitMeasuresDialogTitle"),message:this.localizationService.get("CalculationGroupEnableDiscourageImplicitMeasuresDialogMessage")},"CalculationGroupEnableDiscourageImplicitMeasuresDialog",this.dialogService,this.localizationService)];case 1:return[4,s.sent().afterClosed().toPromise()];case 2:return 1===s.sent()?(t.push(this.createSetDiscourageImplicitMeasuresSchemaChange(!0)),[2,!0]):[2,!1];case 3:return[2,!0]}})})},r.prototype.resolveOrdinalConflict=function(e,t,n){for(var o=function(P){if(e[P].ordinal!==e[P-n].ordinal)return"break";e[P].ordinal+=n,e[P].dirty=!0,te.fF.assert(function(){return e[P].ordinal>=Ue.Ow&&e[P].ordinal<=Ue.BT})},s=t;s>=0&&s<e.length&&"break"!==o(s);s+=n);},r.prototype.getCalculationGroupInfo=function(){var t=this.dataModelService.getDataModel().tables.filter(function(n){return null!==n.calculationGroup}).map(function(n){return{precedence:n.calculationGroup.precedence,name:n.name,dirty:!1}});return t.sort(Ue.zb),t},r.prototype.getCalculationItems=function(e){var t,n,s=null===(n=null===(t=this.dataModelService.getDataModel().tables.find(function(c){return c.name===e}))||void 0===t?void 0:t.calculationGroup)||void 0===n?void 0:n.calculationItems;return s.sort(Ue.hJ),s},r.prototype.createNewCalculationItemSchemaChange=function(e,t,n,o){return{newCalculationItem:{name:n,ordinal:t,expression:Ue.tU,modelObject:me.X6.getTableUrn(e,o)}}},r.prototype.createSetPrecedenceSchemaChange=function(e,t){var n=this.dataModelService.getDataModel().editableSchemaName;return{setCalculationGroupPrecedence:{precedence:t,modelObject:me.X6.getTableUrn(e,n)}}},r.prototype.createSetOrdinalSchemaChange=function(e,t,n){var o=this.dataModelService.getDataModel().editableSchemaName;return{setCalculationItemOrdinal:{ordinal:n,modelObject:me.X6.getCalculationItemUrn(e,t,o)}}},r.prototype.createSetDiscourageImplicitMeasuresSchemaChange=function(e){return{setDiscourageImplicitMeasures:{discourageImplicitMeasures:e}}},r.prototype.handleUserError=function(e){this.errorService.error(this.getErrorMessageDescription(e),"modelingError",{title:this.getErrorMessageTitle(e),source:"User",hideGetHelpLink:!0,showAdditionalErrorInfo:!1})},r.prototype.getErrorMessageTitle=function(e){return this.localizationService.get("".concat(this.getErrorMessageKey(e),"_Title"))},r.prototype.getErrorMessageDescription=function(e){return e===ut.OutOfRangePrecedence?this.localizationService.format(this.getErrorMessageKey(e),Ue.UI):e===ut.OutOfRangeOrdinal?this.localizationService.format(this.getErrorMessageKey(e),Ue.Ow):this.localizationService.get(this.getErrorMessageKey(e))},r.prototype.getErrorMessageKey=function(e){switch(e){case ut.MaxNumberOfGroups:case ut.MaxNumberOfItems:case ut.NotInteger:case ut.OutOfRangeOrdinal:case ut.OutOfRangePrecedence:case ut.PrecedenceNotUnique:return"CalculationGroupAuthoringService_".concat(e,"Error");default:te.fF.assertNever(e)}},r.prototype.addFeatureTagIfMissing=function(e){var t=this.dataModelService.getDataModel();(0,oe.vQ)(t,oe.CL,"CalcGroup")||e.push({SetUsedFeatureModelTraitSchemaChange:{featureTagsToAdd:["CalcGroup"]}})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(xe.n),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(pe.T))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ot=function(){function r(e,t){this.modelAuthoring=e,this.deleteModelItemService=t}return r.prototype.createCalendar=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(o){switch(o.label){case 0:return[4,this.modelAuthoring.apply({changes:[{createCalendar:{modelObject:e,calendarName:t.name,timeUnitColumnAssociations:t.associations}}]})];case 1:return o.sent(),[2]}})})},r.prototype.editCalendar=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){var s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return s=[],t&&s.push({propertyRename:{schema:o,entity:e,before:t.oldName,after:t.name,objectType:"Calendar"}}),n&&s.push({updateCalendar:{modelObject:me.X6.getCalendarUrn(e,n.name,o),timeUnitColumnAssociations:n.associations}}),[4,this.modelAuthoring.apply({changes:s})];case 1:return c.sent(),[2]}})})},r.prototype.deleteCalendar=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(o){switch(o.label){case 0:return[4,this.deleteModelItemService.deleteModelItem([{schema:n,tableName:e,itemName:t,objectType:"Calendar"}],!1)];case 1:return o.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(f.c))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Rt=function(){function r(e,t){this.dialogService=e,this.localizationService=t}return r.prototype.showCalendarOptions=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){var s,c;return(0,C.Jh)(this,function(y){switch(y.label){case 0:return s={tableName:e,entryPoint:t,initialState:n,editingCalendarName:o},c={title:this.localizationService.format("CalendarOptions_ForTable",e),input:s,dontCloseOnAction:!0,dontCloseOnDefaultActions:!0,hideClose:!0},[4,this.dialogService.showTemplateDialog("CalendarOptionsComponent",c)];case 1:return y.sent(),[2]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),It=function(){function r(e,t,n,o,s){this.modelAuthoring=e,this.dialogService=t,this.featureSwitchService=n,this.localizationService=o,this.dataModelService=s}return r.prototype.showOrEditDateTable=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.showDateTableDialog(e,t??void 0,n)];case 1:return(o=s.sent())?[4,this.modelAuthoring.apply({changes:[{markAsDateTable:{schema:o.schema,tableName:o.tableName,columnName:o.dateColumnName,enabled:o.enabled}}]})]:[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}})})},r.prototype.createAssistedDateTable=function(e){return void 0===e&&(e=null),(0,C.mG)(this,void 0,void 0,function(){var t,n,o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return t=this.generateNewAssistedDateTableName(),[4,this.showAuthorDateTableDialog({tableName:t,srcColumns:e?[me.X6.getColumnUrn(e.table.name,e.name,e.table.schemaName)]:[],dateAttributes:[{dateAttribute:"Date",isHidden:!1,customName:this.localizationService.get("Date")},{dateAttribute:"Year",isHidden:!1,customName:this.localizationService.get("TimeUnit_Year")},{dateAttribute:"YearNumber",isHidden:!1,customName:this.localizationService.get("YearNumber")},{dateAttribute:"Quarter",isHidden:!1,customName:this.localizationService.get("CdsaAuthoring_Iframe_Quarter")},{dateAttribute:"Month",isHidden:!1,customName:this.localizationService.get("TimeUnit_Month")},{dateAttribute:"MonthNumber",isHidden:!1,customName:this.localizationService.get("MonthNumber")}],startMonthOfYear:1,hideSourceColumn:!0,hideDefaultCalendar:!0})];case 1:return(n=s.sent())?(o=n.srcColumns.map(function(c,y){return{caption:c.columnName,field:c.columnName,ordinal:y,table:c.tableName}}),[4,this.modelAuthoring.apply({changes:[{createAssistedDateTable:{dateTableDefinition:{dateAttributes:n.dateAttributes,dateFieldInfo:o,hideDefaultCalendar:n.hideDefaultCalendar,hideSourceColumn:n.hideSourceColumn,startMonthOfYear:n.startMonthOfYear},modelObject:me.X6.getTableUrn(t)}}]})]):[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}})})},r.prototype.editAssistedDateTable=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.getExistingDateTableMetadata(e)];case 1:return t=s.sent(),[4,this.showAuthorDateTableDialog(t)];case 2:return(n=s.sent())?(o=n.srcColumns.map(function(c,y){return{caption:c.columnName,field:c.columnName,ordinal:y,table:c.tableName}}),[4,this.modelAuthoring.apply({changes:[{editAssistedDateTable:{dateTableDefinition:{dateAttributes:n.dateAttributes,dateFieldInfo:o,hideDefaultCalendar:n.hideDefaultCalendar,hideSourceColumn:n.hideSourceColumn,startMonthOfYear:n.startMonthOfYear},modelObject:me.X6.getTableUrn(e.name,e.schemaName)}}]})]):[3,4];case 3:s.sent(),s.label=4;case 4:return[2]}})})},r.prototype.getExistingDateTableMetadata=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){return[2,Promise.resolve(null)]})})},r.prototype.generateNewAssistedDateTableName=function(){var e=new Set(this.dataModelService.getDataModel().tables.map(function(o){return o.name})),t=this.localizationService.get("Date_Table");if(!e.has(t))return t;var n=1;for(t=this.localizationService.format("NamePattern_Bracket",this.localizationService.get("Date_Table"),n);e.has(t);)n++,t=this.localizationService.format("NamePattern_Bracket",this.localizationService.get("Date_Table"),n);return t},r.prototype.showAuthorDateTableDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.dialogService.showTemplateDialog("AuthorDateTableComponent",{title:this.localizationService.format("Customize_Bracket",e.tableName),okButtonText:this.localizationService.get("SaveAndClose_ButtonText"),input:e,hideCancelButton:!0},{width:"639px",height:"712px"})];case 1:return[2,n.sent().afterClosed().toPromise()]}})})},r.prototype.showDateTableDialog=function(e,t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,c,y;return(0,C.Jh)(this,function(P){switch(P.label){case 0:return o={entityName:e,schemaName:t,entryPoint:n},y=this.localizationService.get((c=this.featureSwitchService.featureSwitches.customCalendars)?"CalendarOptions_MarkAsADateTable_NotRecommended":"MarkAsADateTable"),o.description=c?void 0:this.localizationService.get("DateTableDialog_MarkAsDateTableDescription"),o.warning=this.localizationService.get(c?"CalendarOptions_MarkAsADateTable_Warning":"DateTableDialog_MarkAsDateTableWarning"),[4,this.dialogService.showTemplateDialog("DateTableComponent",{title:y,okButtonText:this.localizationService.get("PBI_Button_Label_Save"),input:o})];case 1:return[2,P.sent().afterClosed().toPromise()]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Fe.S),i.\u0275\u0275inject(ie.x),i.\u0275\u0275inject(D.vZ),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(xe.n))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Vt=function(){function r(e){this.telemetryService=e,this.telemetryService.initialize()}return r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(a.L))},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[f.c,Tt,mt,O,M,ht,S,Ce,a.L,N,Re.B,Ct,Ot,Rt,It,We,{provide:d,useClass:u}],imports:[W]}),r}(),Dt=new i.InjectionToken("AccessibilityService"),je=T(68816),Pt=function(){function r(){var e=this;this.modelToProviderConfig=new Map,je.editor.onWillDisposeModel(function(t){return e.disposeModel(t)})}return r.getInstance=function(){return this._instance||(this._instance=new r)},r.prototype.getProviderConfig=function(e){return this.modelToProviderConfig.get(e)},r.prototype.createMonacoModelWithConfig=function(e,t,n){var o,s,c=je.editor.createModel(e,t);return this.modelToProviderConfig.set(c.id,n),void 0!==(null===(o=n.modelOptions)||void 0===o?void 0:o.endOfLineStyle)&&c.setEOL(n.modelOptions.endOfLineStyle),void 0!==(null===(s=n.modelOptions)||void 0===s?void 0:s.textModelUpdateOptions)&&c.updateOptions(n.modelOptions.textModelUpdateOptions),c},r.prototype.disposeModel=function(e){this.modelToProviderConfig.delete(e.id)},r}(),qe=T(13500),zt=T(19194),bt=T(48501),_e=T(17819),Kt=T(47164),p=function(r){function e(t){var n=r.call(this,t)||this;return n.message=t,n.name="DaxConfigError",n}return(0,C.ZT)(e,r),e}(Error),h=function(r){function e(t){var n=r.call(this,t.message)||this;return n.originalError=t,Object.setPrototypeOf(n,e.prototype),n.name="MonacoError",n}return(0,C.ZT)(e,r),e}(Error),J=T(85386),Te=function(r){return r[r.Column=0]="Column",r[r.Measure=1]="Measure",r[r.Table=2]="Table",r[r.Role=3]="Role",r[r.VisualCalculation=4]="VisualCalculation",r[r.CalculationItem=5]="CalculationItem",r}({}),Be=function(r){return r[r.Formula=0]="Formula",r[r.Expression=1]="Expression",r[r.Query=2]="Query",r}({}),ze=function(r){return r.ModelChange="ModelChange",r.CodeAction="CodeAction",r.CodeLens="CodeLens",r.Completions="Completions",r.Formatting="Formatting",r.Hover="Hover",r.SemanticTokens="SemanticTokens",r.SignatureHelp="SignatureHelp",r.Validation="Validation",r.Unknown="Unknown",r}({}),lt=function(){function r(e){this.daxParserManager=e,this.signatureHelpTriggerCharacters=["(",","],this.signatureHelpRetriggerCharacters=[","]}return r.prototype.provideSignatureHelp=function(e,t,n,o){var s=this.daxParserManager.getParseResult(e,e.getOffsetAt(t),void 0,!0,ze.SignatureHelp);if(!s)return Promise.resolve(void 0);var c=s.parseResult&&s.parseResult.prototypeFunctionBase;if(!c)return Promise.resolve(void 0);var y=[],P={currentParameter:-1};if(s.parseResult.prototypeParamContexts.length)for(var w=0,j=s.parseResult.prototypeParamContexts;w<j.length;w++)y.push(this.buildSignature(c,j[w],P));else y.push(this.buildSignature(c,void 0,P));return Promise.resolve({value:{signatures:y,activeParameter:P.currentParameter,activeSignature:0},dispose:function(){}})},r.prototype.buildSignature=function(e,t,n){var o={documentation:e.description,label:void 0,parameters:[],activeParameter:void 0};if(n.currentParameter=-1,!t)return o.label=e.getDefaultPrototype(),o;var z,c="",y=e.getPrototype(t);c+=y[0].text+y[0].separator;for(var P=1;P<y.length-1;P++){var w=y[P];o.parameters.push({documentation:"",label:(z=w.text,z.endsWith(_e.w_.listSeparator)&&(z=z.substr(0,z.length-_e.w_.listSeparator.length)),z)}),c+=w.text,c+=w.separator,w.bold&&(n.currentParameter=P-1)}return o.label="".concat(c+=y[y.length-1].text+y[y.length-1].separator),o.activeParameter=n.currentParameter,o},r}(),wt=T(35510),pt=function(){function r(){}return r.configureModel=function(e,t,n,o,s){this.config=new ur(e,(0,_e.yD)(t,s),n,o),this.newConfig$.next()},r.newConfigNotification=function(){return this.newConfig$.asObservable()},r.getConfig=function(){return r.config},r.getModel=function(){return r.config&&r.config.daxModel},r.getMonacoModel=function(){return r.config&&r.config.wireModel},r.getDataSourceInfo=function(){return r.config&&r.config.dataSourceInfo},r.getContext=function(){return r.config&&r.config.daxContext},r.config=void 0,r.newConfig$=new wt.X(void 0),r}(),ur=function(){function r(e,t,n,o){this.wireModel=e,this.dataSourceInfo=t,this.calculation=n,this.restrictedDirectQuery=o}return Object.defineProperty(r.prototype,"syntaxType",{get:function(){var t,n;return null!==(n=null===(t=this.calculation)||void 0===t?void 0:t.syntaxType)&&void 0!==n?n:Be.Formula},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"daxModel",{get:function(){return this._daxModel||(this._daxModel=(0,_e.o4)(this.wireModel)),this._daxModel},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"daxContext",{get:function(){if(!this._daxContext){var t={matchObjects:null};_e.MQ.populateAll(this.daxModel,this.dataSourceInfo,t);var n=this.calculation;if(!n||n.syntaxType===Be.Query)return this._daxContext=new _e.hK(t.matchObjects),this._daxContext;var o=_.find(this.daxModel.tables,function(y){return y.name===n.tableName});switch(n.type){case Te.Column:var s=_.find(o.columns,function(y){return y.name===n.calculationName});this._daxContext=(0,_e.Gz)(this.daxModel,this.dataSourceInfo,s,this.restrictedDirectQuery);break;case Te.Measure:var c=_.find(o.measures,function(y){return y.name===n.calculationName});this._daxContext=n.syntaxType===Be.Expression?(0,_e.K2)(this.daxModel,this.dataSourceInfo,c,this.restrictedDirectQuery):(0,_e.kD)(this.daxModel,this.dataSourceInfo,c,this.restrictedDirectQuery);break;case Te.Table:this._daxContext=(0,_e.ub)(this.daxModel,this.dataSourceInfo,o);break;case Te.Role:this._daxContext=(0,_e.Sm)(this.daxModel,this.dataSourceInfo,o);break;default:this._daxContext=new _e.hK(t.matchObjects)}}return this._daxContext},enumerable:!1,configurable:!0}),r.prototype.onWireModelUpdated=function(){this._daxModel=null,this._daxContext=null},r}(),kt=T(6855),lr=function(){function r(e){this.daxParserManager=e,this.triggerCharacters=[",","[","(","]","'"],function(){var r=kt.n.prototype.triggerSuggest;kt.n.prototype.triggerSuggest=function(e,t){return r.apply(this,[e,!0])}}()}return r.prototype.provideCompletionItems=function(e,t,n,o){if(""===e.getValue())return Promise.resolve(function(){var r,e=new je.Range(1,1,1,1);return{suggestions:(null===(r=pt.getConfig())||void 0===r?void 0:r.syntaxType)===Be.Query?[{label:"DEFINE",insertText:"DEFINE",range:e,kind:je.languages.CompletionItemKind.Keyword},{label:"EVALUATE",insertText:"EVALUATE",range:e,kind:je.languages.CompletionItemKind.Keyword}]:[]}}());var s=this.daxParserManager.getParseResult(e,e.getOffsetAt(t),5,void 0,ze.Completions);if(!s||!s.parseResult)return Promise.resolve(void 0);var c=s.parseResult,y=c.suggestions.map(function(P,w){var z,j=P.suggestionText;if(P.matchObject instanceof _e.Gs){var ae=P.matchObject;j+="(",(0===ae.signatures.length||1===ae.signatures.length&&0===ae.signatures[0].length)&&(j+=")"),z={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"}}P.complete||(z={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"});var ce=function(r,e,t,n){var o=e.replaceEnd;if(r.matchObject instanceof _e.Gs){e.afterOParen===o+1&&(o=e.afterOParen);var s=r.matchObject;(0===s.signatures.length||1===s.signatures.length&&0===s.signatures[0].length)&&e.afterCParen===o+1&&(o=e.afterCParen)}var c=n.getPositionAt(e.replaceStart+t.formulaBreakup.formulaStart),y=n.getPositionAt(o+t.formulaBreakup.formulaStart);return{startLineNumber:c.lineNumber,startColumn:c.column,endLineNumber:y.lineNumber,endColumn:y.column}}(P,c,s,e);return{label:P.suggestionText,command:z,range:ce,preselect:w===c.bestMatch,insertText:j,documentation:P.matchObject.description||"",kind:fr(P),filterText:e.getValueInRange(ce)}});return Promise.resolve({suggestions:y})},r.prototype.resolveCompletionItem=function(e,t){return Promise.resolve(e)},r}();function fr(r){if(r.matchObject instanceof _e.Gs)return je.languages.CompletionItemKind.Function;if(r.matchObject instanceof _e.Z0)return je.languages.CompletionItemKind.Keyword;if(r.matchObject instanceof _e.S2)return je.languages.CompletionItemKind.Class;if(r.matchObject instanceof _e.XN)return je.languages.CompletionItemKind.Property;if(r.matchObject instanceof _e.Cf)return je.languages.CompletionItemKind.Method;if(r.matchObject instanceof _e.it)return je.languages.CompletionItemKind.Enum;if(r.matchObject instanceof _e.Df)return je.languages.CompletionItemKind.Event;if(r.matchObject instanceof _e.cr){var e=r.matchObject;if("rows"===e.name.toLowerCase())return je.languages.CompletionItemKind.Struct;if("columns"===e.name.toLowerCase())return je.languages.CompletionItemKind.Interface;if("rows columns"===e.name.toLowerCase())return je.languages.CompletionItemKind.Constructor;if("columns rows"===e.name.toLowerCase())return je.languages.CompletionItemKind.Module}return je.languages.CompletionItemKind.Folder}var Ut=T(11674),pr=T(40546),fn=T(79232),gr=T(98277),tn=T(58871),Ye=T(85616),mr=T(85786),dn=T(63513),vr=function(){function r(e){this.daxParserManager=e,this.maxCharactersInLine={},this.modelToEditorDictionary={},this.disposables=[],this.daxParser=new Ut.w_(Ut.Jt.MultipleQueries)}return r.prototype.initialize=function(){var e=this;this.disposables.push(je.editor.onDidCreateEditor(function(t){var n,o=t.getId(),s=null===(n=t.getModel())||void 0===n?void 0:n.uri.toString();s&&(e.modelToEditorDictionary[s]&&e.modelToEditorDictionary[s]!==o&&(0,bt.sr)("The formatting provider currently doesn't support using the same model on multiple editors"),e.modelToEditorDictionary[s]=o),e.maxCharactersInLine[o]||(e.maxCharactersInLine[o]=200),e.disposables.push(t.onDidChangeModel(function(c){var y,P=null===(y=c.newModelUrl)||void 0===y?void 0:y.toString();P&&e.modelToEditorDictionary[P]&&e.modelToEditorDictionary[P]!==o&&(0,bt.sr)("The formatting provider currently doesn't support using the same model on multiple editors"),c.oldModelUrl&&(e.modelToEditorDictionary[c.oldModelUrl.toString()]=void 0),e.modelToEditorDictionary[P]=o})),e.disposables.push(t.onDidLayoutChange(function(c){e.maxCharactersInLine[o]=c.viewportColumn}))}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},r.prototype.provideDocumentFormattingEdits=function(e,t,n){var o,s,c,y=Pt.getInstance().getProviderConfig(e.id);if(null!==(o=y?.formatting)&&void 0!==o&&o.enabled){var P=null!==(c=null===(s=y.formatting)||void 0===s?void 0:s.formattingOptions)&&void 0!==c?c:(0,C.pi)((0,C.pi)({},t),{addSpaceBetweenFunctionArguments:!1,contextualLineBreaksAndIndentation:!1,functionAndKeywordCase:"uppercase",lineStyle:"editorWidth",maxCharactersInLine:this.maxCharactersInLine[this.modelToEditorDictionary[e.uri.toString()]],removeUnnecessaryRowParenthesis:!1,spaceBetweenFunctionNameAndParenthesis:!1});return this.provideDocumentFormattingEditsCore(e,P,n)}},r.prototype.formatDaxText=function(e,t,n,o){var s;if(!n||!n.isCancellationRequested){var c=this.daxParser.buildParseTree(e);if(!c.anyErrors){t=t??{tabSize:4,insertSpaces:!1,functionAndKeywordCase:"uppercase",lineStyle:"short",addSpaceBetweenFunctionArguments:!0,contextualLineBreaksAndIndentation:!0,removeUnnecessaryRowParenthesis:!0,spaceBetweenFunctionNameAndParenthesis:!1};var w=((null===(s=pt.getConfig())||void 0===s?void 0:s.syntaxType)===Be.Formula?(0,_e.O5)(e):{errors:[],formula:void 0,formulaStart:0,name:null}).name,z=new yr(t).format(c.rootNode),ae=w?"".concat(w," ="):"";return _.isEmpty(ae)?z:o&&ae.length+z.length+1<=this.maxCharactersInLine[this.modelToEditorDictionary[o]]?"".concat(ae," ").concat(z):"".concat(ae,"\n").concat(z)}}},r.prototype.provideDocumentFormattingEditsCore=function(e,t,n){return pr.d.featureSwitches.useParseTreeFormatting?this.provideDocumentFormattingEditsUsingParseTree(e,t,n):this.provideDocumentFormattingEditsUsingExpressionTree(e,t,n)},r.prototype.provideDocumentFormattingEditsUsingParseTree=function(e,t,n){if(this.modelToEditorDictionary[e.uri.toString()]){var o=this.formatDaxText(e.getValue(),t,n,e.uri.toString());if(o)return[{text:o,range:e.getFullModelRange()}]}},r.prototype.provideDocumentFormattingEditsUsingExpressionTree=function(e,t,n){if(this.modelToEditorDictionary[e.uri.toString()]&&!n.isCancellationRequested){var o=this.daxParserManager.getParseResult(e,e.getValueLength(),void 0,!0,ze.Formatting);if(o&&o.formulaBreakup&&null!==o.parser.parseTree.rootNode&&!(o.parseResult.errors.length>0)){var s=o.formulaBreakup.name,y=gr.r.build(o.parser.parseTree.rootNode,127).accept(new Cr(t)),P=s?"".concat(s," ="):"",w="";w=_.isEmpty(P)?y:P.length+y.length+1<=this.maxCharactersInLine[this.modelToEditorDictionary[e.uri.toString()]]?"".concat(P," ").concat(y):"".concat(P,"\n").concat(y);var j=this.getPositionMetadataOfEachLeaf(o.parser._parseTree.leafPositions,e.getValue()),z=this.findCommentsFromLeaves(j);return 0===z.length||(w=this.addCommentsToText(w,z)),[{text:w,range:e.getFullModelRange()}]}}},r.prototype.getPositionMetadataOfEachLeaf=function(e,t){for(var n=[],o=0,s=e;o<s.length;o++){var c=s[o];if(60!==c.token.type){if(c.token.ignorable){n.push({leaf:c,instance:0});continue}for(var y=c.token.getString(),P=0,w=t.indexOf(y);-1!==w;){if(c.token.startPosition===w){n.push({leaf:c,instance:P});break}P++,w=t.indexOf(y,w+1)}}}return n},r.prototype.findCommentsFromLeaves=function(e){for(var t=[],n=0;n<e.length;n++)if((0,mr.C3)(e[n].leaf.token.type)){var s=e[n].leaf.token.getString(),c=this.getLeavesUntillTheNextNonIgnorableLeaf(e,n-1,"Decrement"),y=this.getLeavesUntillTheNextNonIgnorableLeaf(e,n+1,"Increment"),P=c.some(function(De){return De&&De.leaf.token.isComment}),w=y.some(function(De){return De&&De.leaf.token.isComment}),j=!this.isThereAnyTextBeforeTheNewLine(c,!0)&&(!this.isThereAnyTextBeforeTheNewLine(y,!1)||s.endsWith("\n")),z=this.getNumberOfNewLinesInLeaves(c),ae=this.getNumberOfNewLinesInLeaves(y)+(s.endsWith("\n")?1:0),ce=0!==c.length&&!c[c.length-1].leaf.token.ignorable,fe=0!==y.length&&!y[y.length-1].leaf.token.ignorable,Se=!P&&!ce,Le=!w&&!fe;t.push({text:s,type:j&&fe&&(ae<=z||Se)?"Above":j&&ce&&(z<=ae||Le)?"Below":j||!z&&!Se||ae&&!w?j||z&&w||!ae&&!Le?"Between":"Behind":"Front",leavesBeforeComment:c,leavesAfterComment:y})}return t},r.prototype.getLeavesUntillTheNextNonIgnorableLeaf=function(e,t,n){for(var o=[];t>=0&&t<e.length&&e[t].leaf.token.ignorable;)o.push(e[t]),t="Increment"===n?t+1:t-1;return t>=0&&t<e.length&&o.push(e[t]),o},r.prototype.isThereAnyTextBeforeTheNewLine=function(e,t){void 0===t&&(t=!1);for(var n=0,o=e;n<o.length;n++){var s=o[n],c=t?s.leaf.token.getString().split("").reverse().join(""):s.leaf.token.getString(),y=c.search(/\S/),P=c.search(/\n/);if(-1!==y||-1!==P)return!(-1===y&&-1!==P||-1!==y&&-1!==P&&P<y)}return!1},r.prototype.getNumberOfNewLinesInLeaves=function(e){return e.reduce(function(t,n){return t+(n.leaf.token.getString().split("\n").length-1)},0)},r.prototype.addCommentsToText=function(e,t){for(var n,o=0,s=0,c=t;s<c.length;s++)e=(n=this.addCommentToText(e,c[s],o))[0],o=n[1];return e},r.prototype.addCommentToText=function(e,t,n){var o,s,c,y,P;void 0===n&&(n=0);var w=t.leavesBeforeComment[t.leavesBeforeComment.length-1],j=t.leavesAfterComment[t.leavesAfterComment.length-1],z=null!==(o=w?.leaf.token.getString().toLowerCase())&&void 0!==o?o:void 0,ae=null!==(s=j?.leaf.token.getString().toLowerCase())&&void 0!==s?s:void 0,ce=this.getStartPositionsThatMatchTheSubstring(e.toLowerCase(),z),fe=this.getStartPositionsThatMatchTheSubstring(e.toLowerCase(),ae),Se=ce[null!==(c=w?.instance)&&void 0!==c?c:-1],Le=fe[null!==(y=j?.instance)&&void 0!==y?y:-1],De=0;void 0!==Se&&(De=Se+(null!==(P=z?.length)&&void 0!==P?P:0)),void 0===Se&&void 0!==Le&&(De=Le-e.slice(0,Le).split("").reverse().join().search(/\S/)),void 0===Le&&(Le=e.slice(De).search(/\S/)+De);var ot=this.formatComment(e,t,n,Le,De,j),at=ot[0],gt=ot[1],xt=ot[2],ft=ot[3];return[e=e.slice(0,ft)+gt+at.text+xt+e.slice(ft),n=ft+t.text.length+gt.length+xt.length]},r.prototype.formatComment=function(e,t,n,o,s,c){var y="",P="",w=0;switch(t.type){case"Above":w=o,t.text.endsWith("\n")||(P="\n"),P+=(e.slice(0,w).match(/[ \t]*$/)||[""])[0];break;case"Below":w=s,n>=s&&(w=n),e.slice(0,w).endsWith("\n")||(y="\n");var j=e.slice(0,w).lastIndexOf("\n")+1;y+=(e.slice(j,w).match(/^[ \t]*/)||[""])[0],t.text.endsWith("\n")&&(t.text=t.text.slice(0,-1));break;case"Front":!e.slice(w=o).startsWith(" ")&&!t.text.endsWith("\n")&&(P=" ");break;case"Between":w=o;break;case"Behind":w=s,n>=s&&(w=n),e.slice(0,w).endsWith(" ")||(y=" "),t.text.endsWith("\n")&&e.slice(w,o).includes("\n")?t.text=t.text.slice(0,-1):!t.text.endsWith("\n")&&!e.slice(w,o).includes("\n")&&void 0!==c&&(t.text=t.text+"\n")}return[t,y,P,w]},r.prototype.getStartPositionsThatMatchTheSubstring=function(e,t){if(void 0===t)return[];for(var n=[],o=e.indexOf(t);-1!==o;)n.push(o),o=e.indexOf(t,o+1);return n},r}(),yr=function(){function r(e){var t=this;this.options=e,this.functionWithNoShortLineBreaks=["DATE"],this.functionWithLineFollowedByPairs=["SWITCH"],this.functionWithJustPairs=["ROW"],this.functionWithNameAndExpressionPairs=["SUMMARIZE","SUMMARIZECOLUMNS","ADDCOLUMNS","SELECTCOLUMNS"],this.identifersThatChangeCase=["true","false"],this.indentLevel=0,this.indentPadding="",this.addIndentation=function(){return _.repeat(t.indentPadding,t.indentLevel)},this.indentPadding=this.options.insertSpaces?_.repeat(" ",this.options.tabSize):"\t"}return r.prototype.format=function(e){var t=this.formatCore(e);return(t=t.replace(/(?<=\n)[ \t]+(?=\n)/g,"")).replace(/(\n?[\t ]*)+$/,"")},r.prototype.addSpacesBetweenArgsIfNone=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0;o<e.length;o++)e[o-1]&&!this.doesEndWithWhitespace(e[o-1])&&n.push(" "),n.push(e[o]);return n.join("")},r.prototype.doesEndWithWhitespace=function(e){return/\s$/.test(e)},r.prototype.formatCore=function(e,t){var n,o;void 0===t&&(t=!1);var s="";if(void 0===e)return s;if(s+=this.formatTrivia(null!==(n=e.leadingTrivia)&&void 0!==n?n:[],!0),e instanceof Ye.a$)s+=this.formatBinaryOperation(e);else if(e instanceof Ye.N4)s+=this.formatDefinitions(e);else if(e instanceof Ye.DU)s+=this.formatFunctionCall(e);else if(e instanceof Ye.TV&&e.parent instanceof Ye.DU)s+=this.formatIdentifier(e,!0);else if(e instanceof Ye.TV&&this.identifersThatChangeCase.includes(e.token.getString().toLowerCase()))s+=this.formatIdentifier(e,!0);else if(e instanceof Ye.TV)s+=this.formatIdentifier(e);else if(e instanceof Ye._N)s+=this.formatInOperation(e);else if(e instanceof Ye.ub)s+=this.formatKeyword(e);else if(e instanceof Ye.pZ)s+=this.formatMeasureExpression(e);else if(e instanceof Ye.rc)s+=this.formatOrderBy(e);else if(e instanceof Ye._7)s+=this.formatQueries(e);else if(e instanceof Ye.Vu)s+=this.formatQuery(e);else if(e instanceof Ye.ic)s+=this.formatStartAt(e);else if(e instanceof Ye.Lj)s+=this.formatSortClause(e);else if(e instanceof Ye.lg)s+=this.formatTableConstructor(e);else if(e instanceof Ye.tw)s+=this.formatTuple(e);else if(e instanceof Ye.Ti)s+=this.formatUnaryLogicalOperation(e);else if(e instanceof Ye.dl||e instanceof Ye.rI)s+=this.formatVariable(e);else if(e instanceof Ye.Cm)s+=this.formatVarStatementNode(e);else if(e instanceof tn.a9)s+=e.token.getString();else if(e instanceof Ye.q1&&e.children.length>1)for(var y=0,P=this.getAllDescendents(e.children[0]);y<P.length;y++)s+=this.formatCore(P[y],t);else if(e instanceof tn.sN)for(var j=0,z=e.children;j<z.length;j++)s+=this.formatCore(z[j],t);return s+=this.formatTrivia(null!==(o=e.trailingTrivia)&&void 0!==o?o:[],!1),t?s.replace(/(\n[\t ]*$)/,""):s},r.prototype.formatBinaryOperation=function(e){return this.formatBinaryOperationCore(e.children)},r.prototype.formatBinaryOperationCore=function(e){var t;if(1===e.length)return this.formatCore(e[0]);var n=this.formatBinaryOperationCore(e.slice(0,e.length-2)),o=this.formatCore(e[e.length-2]),s=this.formatCore(e[e.length-1]);return"editorWidth"===this.options.lineStyle&&n.length+s.length+2+this.indentLevel*this.options.tabSize<=(null!==(t=this.options.maxCharactersInLine)&&void 0!==t?t:200)||"long"===this.options.lineStyle||"short"===this.options.lineStyle?this.addSpacesBetweenArgsIfNone(n,o,s):"".concat(n,"\n").concat(this.addIndentation()).concat(this.addSpacesBetweenArgsIfNone(o,s))},r.prototype.formatDefinitions=function(e){var t="";t+=this.formatCore(e.children[0],!0),this.options.contextualLineBreaksAndIndentation&&this.indentLevel++;for(var n=1;n<e.children.length;n++)t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n],!0));return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,t},r.prototype.formatFunctionCall=function(e){var t,n,o,s=this.formatCore(e.children[0]),c=null!==(n=null===(t=e.getChildFunctionName())||void 0===t?void 0:t.toUpperCase())&&void 0!==n?n:"",y=this.formatCore(e.children[1],!0),P=e.children[e.children.length-1]instanceof Ye.$Z?this.formatCore(e.children[e.children.length-1]):"",w=this.functionWithNoShortLineBreaks.includes(c),j=this.functionWithLineFollowedByPairs.includes(c),z=this.functionWithJustPairs.includes(c),ae=this.functionWithNameAndExpressionPairs.includes(c);w||this.indentLevel++;var ce=void 0;e.children[2]instanceof Ye.fA&&(ce=e.children[2]);var fe=this.options.spaceBetweenFunctionNameAndParenthesis?" ":"",Se=this.options.addSpaceBetweenFunctionArguments?" ":"";if("long"===this.options.lineStyle||"editorWidth"===this.options.lineStyle&&s.length+(ce?ce.fullSpan.length:0)+this.indentLevel*this.options.tabSize+y.length+P.length<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"short"===this.options.lineStyle&&ce&&ce.children.length<=1||!ce||"short"===this.options.lineStyle&&w){w||this.indentLevel--;var De="";if(ce)for(var Xe=0,ot=ce.children;Xe<ot.length;Xe++)De+=this.formatCore(at=ot[Xe]),at instanceof Ye.ZH&&!this.doesEndWithWhitespace(De)&&(De+=Se);return fe=this.doesEndWithWhitespace(s)?"":fe,"".concat(s).concat(fe).concat(y).concat(De).concat(P)}var gt="";gt+="".concat(s).concat(fe).concat(y,"\n");for(var xt=!1,ft="\n",st=this.addIndentation(),yt=0,At=0;ce&&At<ce.children.length;At++){var at,en=this.formatCore(at=ce.children[At],!0);if(at instanceof Ye.ZH)ce.children[At-1]&&ce.children[At-1]instanceof Ye.ZH&&(gt+=st),gt+="".concat(en).concat(ft);else{if(st=this.addIndentation(),ft="\n",j)st=0!==yt&&yt%2==0?"":this.addIndentation(),ft=yt%2!=0?" ":"\n";else if(z)st=yt%2==0?this.addIndentation():" ",ft=yt%2==0?"":"\n";else if(ae){var sr=this.getAllDescendents(at);1===sr.length&&sr[0]instanceof Ye.XN&&!xt?(ft=" ",xt=!0):xt&&(st="",xt=!1)}gt+="".concat(st).concat(en),yt++}}return gt+="\n",w||this.indentLevel--,gt+"".concat(this.addIndentation()).concat(P)},r.prototype.formatIdentifier=function(e,t){void 0===t&&(t=!1);var n=e.token.getIdentifier();return t&&(n="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase()),n},r.prototype.formatInOperation=function(e){return 1===e.children.length?this.formatCore(e.children[0]):this.addSpacesBetweenArgsIfNone(this.formatCore(e.children[0]),this.formatCore(e.children[1]),this.formatCore(e.children[2]))},r.prototype.formatKeyword=function(e){return"uppercase"===this.options.functionAndKeywordCase?e.keyword.toUpperCase():e.keyword.toLowerCase()},r.prototype.formatMeasureExpression=function(e){this.indentLevel++;var t=this.formatCore(e.children[0]),n=this.formatCore(e.children[1]),o=this.formatCore(e.children[2]),s=this.formatCore(e.children[3]);return this.indentLevel--,this.addSpacesBetweenArgsIfNone(t,n,o,s)},r.prototype.formatOrderBy=function(e){var t="",n="".concat(this.addIndentation()),o="\n".concat(this.addIndentation());this.indentLevel++;var s="\n".concat(this.addIndentation()),c=" ";this.options.contextualLineBreaksAndIndentation&&(s=e.children.length<=4?" ":s,c="\n".concat(this.addIndentation())),this.indentLevel--;var y=this.formatCore(e.children[0]),P=this.formatCore(e.children[1],!0);t+="".concat(n).concat(this.addSpacesBetweenArgsIfNone(y,P)).concat(s);for(var w=2;w<e.children.length&&!(e.children[w]instanceof Ye.ic);w++){var j=this.formatCore(e.children[w],!0);w%2!=0&&(j+=c),t+=j}return e.children[e.children.length-1]instanceof Ye.ic&&(t+="".concat(o).concat(this.formatCore(e.children[e.children.length-1]))),t},r.prototype.formatQueries=function(e){for(var t="",n=0;n<e.children.length;n++){var o=n!==e.children.length-1;t+=this.formatCore(e.children[n],o),t+=o?"\n":""}return t},r.prototype.formatQuery=function(e){var n,o,s,c,t=e.children,y=0;t[y]instanceof Ye.N4&&(n=t[y],y++),o=t[y],s=t[++y],t[++y]instanceof Ye.rc&&(c=t[y]);var P=n?"".concat(this.formatCore(n),"\n"):"",w=this.formatCore(o,!0),j=" ";this.options.contextualLineBreaksAndIndentation&&(this.indentLevel++,j="\n".concat(this.addIndentation()));var z=void 0!==c;w+="".concat(j).concat(this.formatCore(s,z));var ae=c?"\n".concat(this.formatCore(c)):"";return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,"".concat(P).concat(w).concat(ae)},r.prototype.formatSortClause=function(e){var t="";return t+=this.formatCore(e.children[0]),e.children[1]&&(/\n\s*$/.test(t)&&(this.indentLevel++,t+=this.addIndentation(),this.indentLevel--),t+=this.doesEndWithWhitespace(t)?"":" ",t+=this.formatCore(e.children[1])),t},r.prototype.formatStartAt=function(e){var t="",n=" ",o=" ",s=this.formatCore(e.children[0]),c=this.formatCore(e.children[1],!0);"short"===this.options.lineStyle&&e.children.length>3&&(this.indentLevel++,n="\n".concat(this.addIndentation()),o="\n".concat(this.addIndentation()),this.indentLevel--),t+="".concat(this.addSpacesBetweenArgsIfNone(s,c)).concat(n);for(var y=2;y<e.children.length;y++)t+=this.formatCore(e.children[y],!0),y%2!=0&&(t+=o);return t},r.prototype.formatTableConstructor=function(e){var t=[],n=" ",o="",s="",c=0,y=this.formatCore(e.children[c],!0);for(c++,"short"===this.options.lineStyle&&(this.indentLevel++,n="\n".concat(this.addIndentation()),o="\n".concat(this.addIndentation()));c<e.children.length&&!(e.children[c]instanceof Ye.yE);c++)t.push(this.formatCore(e.children[c],!0));"short"===this.options.lineStyle&&(this.indentLevel--,s=e.children[c]?"\n".concat(this.addIndentation()):"");for(var P=this.formatCore(e.children[c]),w="",j=0;j<t.length;j++)w+=j%2?"".concat(t[j]).concat(n):t[j];return"".concat(y).concat(o).concat(w).concat(s).concat(P)},r.prototype.formatTuple=function(e){var t=this.options.contextualLineBreaksAndIndentation?" ":"\n".concat(this.addIndentation()),n=0,o=this.formatCore(e.children[n]);n++;for(var s="";n<e.children.length&&!(e.children[n]instanceof Ye.$Z);n++)s+=this.formatCore(e.children[n],!0),s+=n%2?"":t;var c=this.formatCore(e.children[n]);return"".concat(o).concat(s).concat(c)},r.prototype.formatTrivia=function(e,t){for(var n="",o=0;o<e.length;o++)if(!e[o].isComment&&e[o].getString().includes("\n")){var s=e[o].getString().split("\n").length-1;n+="\n".repeat(s<0?0:s),n+=this.addIndentation()}else if(!e[o].isComment&&(e[o-1]&&e[o-1].isComment&&!e[o-1].getString().endsWith("\n")&&e[o+1]&&e[o+1].isComment||t&&e.length-1===o&&e[o-1]&&e[o-1].isComment&&!e[o-1].getString().endsWith("\n")||!t&&0===o&&e[o+1]&&e[o+1].isComment))n+=" ";else{if(!e[o].isComment)continue;if(e[o].isComment&&e[o].getString().endsWith("\n"))n+="".concat(e[o].getString()).concat(this.addIndentation());else if(e[o].isComment&&e[o].getString().includes("\n")){var c=e[o].getString().match(/\/\*([ ]*)(?=[^\s\n])/),P=" ".repeat(c&&c[1]?c[1].length+2:2);(n+=e[o].getString().replace(/(\n)[ \t]+/g,"\n").replace(/\n/g,"\n".concat(this.addIndentation()).concat(P))).endsWith("\n".concat(this.addIndentation()).concat(P,"*/"))&&(n=n.slice(0,n.length-P.length-2),n+="*/")}else n+=e[o].getString()}return n},r.prototype.formatUnaryLogicalOperation=function(e){for(var t="",n=0,o=e.children;n<o.length;n++){var s=o[n];s instanceof Ye.VW?(t+=this.formatCore(s),t+=this.doesEndWithWhitespace(t)?"":" "):t+=this.formatCore(s)}return t},r.prototype.formatVariable=function(e){var t=this.formatCore(e.children[0]),n=this.formatCore(e.children[1]),o=this.formatCore(e.children[2]),s=this.formatCore(e.children[3]);return this.addSpacesBetweenArgsIfNone(t,n,o,s)},r.prototype.formatVarStatementNode=function(e){for(var t="",n=0;n<e.children.length&&e.children[n]instanceof Ye.rI;n++)t+=0===n?"":this.addIndentation(),t+=this.formatCore(e.children[n],!0),e.children[n+1]instanceof Ye.rI&&(t+="\n");return t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n],!0)),n++,this.indentLevel++,t+="\n".concat(this.addIndentation()).concat(this.formatCore(e.children[n])),this.indentLevel--,t},r.prototype.getAllDescendents=function(e){if(e instanceof tn.sN){for(var t=[],n=0,o=e.children;n<o.length;n++)t.push.apply(t,this.getAllDescendents(o[n]));return t}return[e]},r}(),Cr=function(r){function e(t){var n=r.call(this,!1)||this;return n.options=t,n.functionWithNoShortLineBreaks=["DATE"],n.functionWithLineFollowedByPairs=["SWITCH","ADDCOLUMNS"],n.functionWithJustPairs=["ROW"],n.functionWithNameAndExpressionPairs=["SUMMARIZE","SUMMARIZECOLUMNS"],n.indentLevel=0,n.indentPadding="",n.addIndentation=function(){return _.repeat(n.indentPadding,n.indentLevel)},n.indentPadding=n.options.insertSpaces?_.repeat(" ",n.options.tabSize):"\t",n}return(0,C.ZT)(e,r),e.prototype.visitStartAt=function(t,n){var o=this,s="uppercase"===this.options.functionAndKeywordCase?"START AT":"start at",c=" ",y=", ";"short"===this.options.lineStyle&&t.values.length>1&&(this.indentLevel++,c="\n".concat(this.addIndentation()),y=",\n".concat(this.addIndentation()),this.indentLevel--);var P="";return t.values.length>0&&(P="".concat(this.addIndentation()).concat(s).concat(c),P+=t.values.map(function(w){return w.accept(o,n)}).join(y)),P},e.prototype.visitOrderBy=function(t,n){var o=this,s="uppercase"===this.options.functionAndKeywordCase?"ORDER BY":"order by";this.indentLevel++;var c="\n".concat(this.addIndentation()),y=", ";this.options.contextualLineBreaksAndIndentation&&(c=1===t.sortClauses.length?" ":c,y=",\n".concat(this.addIndentation())),this.indentLevel--;var P="";return t.sortClauses.length>0&&(P="".concat(this.addIndentation()).concat(s),P+=c+t.sortClauses.map(function(w){return w.accept(o,n)}).join(y),t.startAt&&(this.indentLevel++,P+="\n"+t.startAt.accept(this,n),this.indentLevel--)),P},e.prototype.visitMeasureExpression=function(t,n){return this.lowercaseKeywordsIfNeeded(r.prototype.visitMeasureExpression.call(this,t,n),"MEASURE")},e.prototype.visitMeasureReference=function(t){return"".concat(dn.LP.bracket(t.propertyName))},e.prototype.visitVariableDefinition=function(t,n){return this.lowercaseKeywordsIfNeeded(r.prototype.visitVariableDefinition.call(this,t,n),"VAR")},e.prototype.visitQuery=function(t,n){var o=this,c="uppercase"===this.options.functionAndKeywordCase?"EVALUATE":"evaluate",y="";t.definitions.length>0&&(y="".concat("uppercase"===this.options.functionAndKeywordCase?"DEFINE":"define","\n"),this.indentLevel++,y+=t.definitions.map(function(ae){return o.addIndentation()+ae.accept(o,n)}).join("\n"),this.indentLevel--,y+="\n",y+=this.options.contextualLineBreaksAndIndentation?"\n":"");var P=" ";this.options.contextualLineBreaksAndIndentation&&(this.indentLevel++,P="\n".concat(this.addIndentation()));var w="".concat(c).concat(P).concat(t.evaluate.accept(this,n)),j=t.orderBy?"\n".concat(t.orderBy.accept(this,n)):"",z="".concat(y).concat(w).concat(j);return this.options.contextualLineBreaksAndIndentation&&this.indentLevel--,z},e.prototype.visitNegation=function(t){return this.visitUnaryExpression(t,"-","")},e.prototype.visitNot=function(t){return this.visitUnaryExpression(t,"NOT"," ")},e.prototype.visitFunction=function(t){var o,n=this,s="uppercase"===this.options.functionAndKeywordCase?t.functionName.toUpperCase():t.functionName.toLowerCase(),c=this.functionWithNoShortLineBreaks.includes(s.toUpperCase()),y=this.functionWithLineFollowedByPairs.includes(s.toUpperCase()),P=this.functionWithJustPairs.includes(s.toUpperCase()),w=this.functionWithNameAndExpressionPairs.includes(s.toUpperCase()),j=this.options.spaceBetweenFunctionNameAndParenthesis?" ":"",z=this.options.addSpaceBetweenFunctionArguments?", ":",";c||this.indentLevel++;var ae=t.parameters.map(function(Le){return r.prototype.visitExpression.call(n,Le)}),ce=s.length+_.sum(_.map(ae,function(Le){return Le.length}))+this.indentLevel*this.options.tabSize+2+_.size(ae)-1;if("long"===this.options.lineStyle||"editorWidth"===this.options.lineStyle&&ce<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"short"===this.options.lineStyle&&ae.length<=1||"short"===this.options.lineStyle&&c)return c||this.indentLevel--,"".concat(s).concat(j,"(").concat(ae.join(z),")");var fe="";fe+="".concat(s).concat(j,"(\n");var Se=!1;return _.forEach(t.parameters,function(Le,De){var Xe=ae[De],ot=n.addIndentation(),at="\n";y?(ot=0!==De&&De%2==0?"":n.addIndentation(),at=De%2!=0?" ":"\n"):P?(ot=De%2==0?n.addIndentation():" ",at=De%2==0?"":"\n"):w&&(Le instanceof fn.w1&&!Se?(at=" ",Se=!0):Se&&(ot="",Se=!1)),fe+=ot,fe+=De===ae.length-1?"".concat(Xe,"\n"):"".concat(Xe,",").concat(at)}),c||this.indentLevel--,fe+=this.addIndentation(),fe+=")"},e.prototype.visitKeyword=function(t){return"uppercase"===this.options.functionAndKeywordCase?r.prototype.visitKeyword.call(this,t):r.prototype.visitKeyword.call(this,t).toLowerCase()},e.prototype.visitRowConstructor=function(t){var n=this,o=this.options.contextualLineBreaksAndIndentation?", ":",\n".concat(this.addIndentation()),s=t.items.map(function(c){return c.accept(n)}).join(o);return this.options.removeUnnecessaryRowParenthesis&&1===t.items.length?s:"(".concat(s,")")},e.prototype.visitTableConstructor=function(t){var n=this,o=", ",s="{",c="}";"short"===this.options.lineStyle&&(this.indentLevel++,o=",\n".concat(this.addIndentation()),s="{\n".concat(this.addIndentation()),this.indentLevel--,c="\n".concat(this.addIndentation(),"}"));var y=t.rows.map(function(P){return P.accept(n)}).join(o);return"".concat(s).concat(y).concat(c)},e.prototype.visitVarReturn=function(t){var n=this,o="uppercase"===this.options.functionAndKeywordCase?"VAR":"var",s="uppercase"===this.options.functionAndKeywordCase?"RETURN":"return",c="",y=t.variables.map(function(P){var w=P.name;return"".concat(o," ").concat(w," = ").concat(n.visitExpression(P.definition))}).join("\n".concat(this.addIndentation()));return c+="".concat(y,"\n").concat(this.addIndentation()).concat(s,"\n"),this.indentLevel++,c+=this.addIndentation(),c+=this.visitExpression(t.returnExpression),this.indentLevel--,c},e.prototype.visitBinaryExpression=function(t,n){var o,s="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase(),c=this.getExpressionType(t),y=this.getExpressionType(t.left),P=this.getExpressionType(t.right),w=!1,j=!1;0===y&&(w=!0),0===P&&(j=!0);var z=this.getPrecedence(c);if(w||13===y||z<this.getPrecedence(y)&&(w=!0),!j&&13!==P){var ce=this.getPrecedence(P);(z<ce||z===ce&&!this.canCombine(c,P))&&(j=!0)}var fe=this.visitExpression(t.left,w),Se=this.visitExpression(t.right,j);return"editorWidth"===this.options.lineStyle&&fe.length+Se.length+2+this.indentLevel*this.options.tabSize<=(null!==(o=this.options.maxCharactersInLine)&&void 0!==o?o:200)||"long"===this.options.lineStyle||"short"===this.options.lineStyle?"".concat(fe," ").concat(s," ").concat(Se):"".concat(fe,"\n").concat(this.addIndentation()).concat(s," ").concat(Se)},e.prototype.visitUnaryExpression=function(t,n,o){var s="uppercase"===this.options.functionAndKeywordCase?n.toUpperCase():n.toLowerCase(),c=this.getExpressionType(t),y=this.getExpressionType(t.expression),P=!1;0===y&&(P=!0);var w=this.getPrecedence(c);P||13===y||w<this.getPrecedence(y)&&(P=!0);var z=this.visitExpression(t.expression,P);return"".concat(s).concat(o).concat(z)},e.prototype.lowercaseKeywordsIfNeeded=function(t,n){return"lowercase"===this.options.functionAndKeywordCase&&(t=t.replace(n,n.toLowerCase())),t},e}(fn.UE),br=function(){function r(){}return r.triggerValidation=function(e,t){var n,o=t.getModel();if(o){var s=e.getParseResult(o,void 0,void 0,void 0,ze.Validation);if(!s)return;var c=this.getMarkerDataFromErrors(s.formulaBreakup.errors,o,0),y=this.getMarkerDataFromErrors((null===(n=s.parseResult)||void 0===n?void 0:n.errors)||[],o,s.formulaBreakup.formulaStart);this.decorationsByEditor[t.getId()]?this.decorationsByEditor[t.getId()].set((0,C.ev)((0,C.ev)([],c,!0),y,!0)):this.decorationsByEditor[t.getId()]=t.createDecorationsCollection((0,C.ev)((0,C.ev)([],c,!0),y,!0))}},r.getMarkerDataFromErrors=function(e,t,n){for(var o=[],s=0,c=e;s<c.length;s++){var y=c[s],P=t.getPositionAt(n+y.segment.startPosition),w=t.getPositionAt(n+y.segment.startPosition+y.segment.length);o.push({range:new je.Range(P.lineNumber,P.column,w.lineNumber,w.column),options:{className:"squiggly-error",overviewRuler:{color:{id:"editorOverviewRuler.errorForeground"},position:je.editor.OverviewRulerLane.Right},stickiness:je.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,zIndex:30,hoverMessage:{value:y.message,isTrusted:!1}}})}return o},r.decorationsByEditor={},r}(),Er=function(){function r(){this.daxParserCache={},this.deleteKeyDown={},this.suspendCursorPositionChange={},this.forceRetokenizeEmitter=new je.Emitter,this.disposables=[],this.subscriptions=[]}return Object.defineProperty(r.prototype,"forceRetokenize",{get:function(){return this.forceRetokenizeEmitter.event},enumerable:!1,configurable:!0}),r.prototype.clearCursorPositionChange=function(e){this.suspendCursorPositionChange[e]=!1},r.prototype.initialize=function(e){var t=this;this.subscriptions.push(pt.newConfigNotification().subscribe(function(){t.clearParserCache();for(var o=0,s=je.editor.getEditors();o<s.length;o++)t.handleModelChange(s[o],"clearParserCache")})),this.disposables.push(je.editor.onDidCreateEditor(function(n){var o;t.disposables.push(n.onDidChangeCursorPosition(function(s){o=s.position,t.suspendCursorPositionChange[n.getModel().id]||t.handleModelChange(n,s.source)})),t.listenForSpecialKeys(n),t.disposables.push(n.onDidChangeModelContent(function(s){var c;t.isModelRegistered(n.getModel().id)&&(_e.dH.featureSwitches.resetSuggestWidgetStateBeforeCompletion&&(null===(c=kt.n.get(n))||void 0===c||c.cancelSuggestWidget()),!o||_.some(s.changes,function(y){return!je.Range.containsPosition(y.range,o)})?(t.clearParserCache(n.getModel().id),t.handleModelChange(n,"reset"),t.forceRetokenizeEmitter.fire()):t.deleteKeyDown[n.getModel().id]&&t.handleModelChange(n,"delete"))})),t.disposables.push(n.onDidChangeModel(function(s){var c=s.newModelUrl;if(c){var y=je.editor.getModel(c);y&&t.registerModel(y,e)}}))})),this.disposables.push(je.editor.onDidCreateModel(function(n){t.registerModel(n,e)}))},r.prototype.dispose=function(){for(var e=0,t=this.subscriptions;e<t.length;e++)t[e].unsubscribe();for(var o=0,s=this.disposables;o<s.length;o++)s[o].dispose()},r.prototype.getParseResult=function(e,t,n,o,s){var c=e.getValue();if(this.isModelRegistered(e.id)){if(this.suspendCursorPositionChange[e.id])return o?this.daxParserCache[e.id].getParseResult():void 0;switch(this.daxParserCache[e.id].doesKeyMatch(c,n,t)){case vt.FullMatch:return this.daxParserCache[e.id].getParseResult();case vt.MouseCursorChange:case vt.DifferentCursorActivity:return this.parseModelExpression(e,t,n,s,!1);case vt.CacheCleared:return this.parseModelExpression(e,t||c.length,1,s);default:return this.daxParserCache[e.id].clear(),this.parseModelExpression(e,t||c.length,5,s)}}},r.prototype.handleModelChange=function(e,t){var n=e.getModel();if(n&&this.isModelRegistered(n.id)&&pt.getConfig()){var o=n.getOffsetAt(e.getPosition()),s=this.getNewCursorActivity(n,o);if(this.daxParserCache[n.id].doesKeyMatch(n.getValue(),s,o)!==vt.FullMatch){var c=1===s&&5===this.daxParserCache[n.id].parseResultKey.cursorActivity;this.parseModelExpression(n,o,s,ze.ModelChange),br.triggerValidation(this,e),5===s&&"snippet"!==t&&"modelChange"!==t&&e.trigger("HandleModelChangedChangeTriggeredSuggest","editor.action.triggerSuggest",{auto:!0}),c&&this.forceRetokenizeEmitter.fire()}}},r.prototype.parseModelExpression=function(e,t,n,o,s){void 0===o&&(o=ze.Unknown),void 0===s&&(s=!0);var c=performance.now(),y=e.getValue(),P=pt.getConfig();if(!P)throw new p("DaxMode resource config is not defined");var ce,j=P.syntaxType===Be.Formula?(0,_e.O5)(y):{errors:[],formula:y,formulaStart:0,name:null},z={result:null},ae=this.daxParserCache[e.id].getDaxParser();if(j.formula){var fe=this.daxParserCache[e.id].getParseResult();if(fe&&fe.formulaBreakup&&j.name!==fe.formulaBreakup.name&&j.formula===fe.formulaBreakup.formula)ce={parseResult:fe.parseResult,formulaBreakup:j,parser:ae};else{if(!ae.tryParse(j.formula,pt.getContext(),z,void 0,n,t-j.formulaStart,t-j.formulaStart)&&(ae.clearParseState(),!ae.tryParse(j.formula,pt.getContext(),z,void 0,n,t-j.formulaStart,t-j.formulaStart)))return fe;ce={parseResult:z.result,formulaBreakup:j,parser:ae}}}var Se=performance.now();return s&&this.daxParserCache[e.id].setParseResult(y,t,ce,n),this.logParseEvent(e.id,c,Se,t,y,o),ce},r.prototype.registerModel=function(e,t){var o,n=this;if(!this.isModelRegistered(e.id)&&e.getLanguageId()===t){var s=null===(o=pt.getConfig())||void 0===o?void 0:o.syntaxType;this.daxParserCache[e.id]=new Tr(s),this.disposables.push(e.onWillDispose(function(){n.disposeModel(e.id)}))}},r.prototype.isModelRegistered=function(e){return e in this.daxParserCache},r.prototype.disposeModel=function(e){this.daxParserCache=_.pickBy(this.daxParserCache,function(t,n){return n!==e}),this.deleteKeyDown=_.pickBy(this.deleteKeyDown,function(t,n){return n!==e}),this.suspendCursorPositionChange=_.pickBy(this.suspendCursorPositionChange,function(t,n){return n!==e})},r.prototype.clearParserCache=function(e){void 0===e&&(e=void 0);for(var n=0,o=e?[e]:Object.keys(this.daxParserCache);n<o.length;n++)this.daxParserCache[o[n]].clear()},r.prototype.listenForSpecialKeys=function(e){var t=this;this.disposables.push(e.onKeyDown(function(n){n.keyCode===je.KeyCode.Delete?t.deleteKeyDown[e.getModel().id]=!0:(n.keyCode===je.KeyCode.PageDown||n.keyCode===je.KeyCode.PageUp||n.keyCode===je.KeyCode.LeftArrow||n.keyCode===je.KeyCode.RightArrow||n.keyCode===je.KeyCode.UpArrow||n.keyCode===je.KeyCode.DownArrow||n.ctrlKey&&(n.keyCode===je.KeyCode.KeyZ||n.keyCode===je.KeyCode.KeyY))&&(t.suspendCursorPositionChange[e.getModel().id]=!0)})),this.disposables.push(e.onMouseDown(function(n){t.suspendCursorPositionChange[e.getModel().id]=!0})),this.disposables.push(e.onKeyUp(function(n){n.keyCode===je.KeyCode.Delete?t.deleteKeyDown[e.getModel().id]=!1:n.keyCode===je.KeyCode.PageDown||n.keyCode===je.KeyCode.PageUp||n.keyCode===je.KeyCode.LeftArrow||n.keyCode===je.KeyCode.RightArrow||n.keyCode===je.KeyCode.UpArrow||n.keyCode===je.KeyCode.DownArrow?(t.suspendCursorPositionChange[e.getModel().id]=!1,t.handleModelChange(e,"keyup")):n.ctrlKey&&(n.keyCode===je.KeyCode.KeyZ||n.keyCode===je.KeyCode.KeyY)&&(t.suspendCursorPositionChange[e.getModel().id]=!1,t.clearParserCache(e.getModel().id),t.handleModelChange(e,"undoRedo"))})),this.disposables.push(e.onMouseUp(function(n){t.suspendCursorPositionChange[e.getModel().id]=!1,t.handleModelChange(e,"mouseClick")}))},r.prototype.getNewCursorActivity=function(e,t){var n=this.daxParserCache[e.id].parseResultKey,o=this.daxParserCache[e.id].doesKeyMatch(e.getValue(),void 0,t);return o===vt.FullMatch?n.cursorActivity:o===vt.CacheCleared||n.expression===e.getValue()?1:5},r.prototype.logParseEvent=function(e,t,n,o,s,c){return(0,C.mG)(this,void 0,void 0,function(){var y;return(0,C.Jh)(this,function(P){return y=Pt.getInstance().getProviderConfig(e),y?.logger&&y.logger.logDaxEvent({startTime:t,endTime:n,expressionLength:s.length,cursorPosition:o,parseTriggerSource:c}),[2]})})},r}(),vt=function(r){return r[r.FullMatch=0]="FullMatch",r[r.NoMatch=1]="NoMatch",r[r.DifferentCursorActivity=2]="DifferentCursorActivity",r[r.CacheCleared=3]="CacheCleared",r[r.MouseCursorChange=4]="MouseCursorChange",r}({}),Tr=function(){function r(e){this.parseResult=void 0,this._parseResultKey={expression:void 0,cursorPosition:void 0,cursorActivity:void 0},this.daxParser=new _e.w_(e===Be.Query?Ut.Jt.MultipleQueries:Ut.Jt.Expression)}return Object.defineProperty(r.prototype,"parseResultKey",{get:function(){return this._parseResultKey},enumerable:!1,configurable:!0}),r.prototype.getDaxParser=function(){return this.daxParser},r.prototype.getParseResult=function(){return this.parseResult},r.prototype.setParseResult=function(e,t,n,o){this._parseResultKey={expression:e,cursorPosition:t,cursorActivity:o},this.parseResult=n},r.prototype.doesKeyMatch=function(e,t,n){return void 0===this.parseResultKey.expression&&void 0===this.parseResultKey.cursorPosition&&void 0===this.parseResultKey.cursorActivity?vt.CacheCleared:e===this.parseResultKey.expression&&2===t?vt.MouseCursorChange:n&&n!==this.parseResultKey.cursorPosition||e!==this.parseResultKey.expression?vt.NoMatch:t&&t!==this.parseResultKey.cursorActivity?vt.DifferentCursorActivity:vt.FullMatch},r.prototype.clear=function(){this.daxParser.clearParseState(),this.parseResult=void 0,this._parseResultKey={expression:void 0,cursorPosition:void 0,cursorActivity:void 0}},r}(),Or=function(){function r(e){this.daxParserManager=e,this.onDidChangeEmitter=new je.Emitter,this.disposables=[]}return r.prototype.initialize=function(){var e=this;this.disposables.push(this.daxParserManager.forceRetokenize(function(){return e.onDidChangeEmitter.fire()}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},Object.defineProperty(r.prototype,"onDidChange",{get:function(){return this.onDidChangeEmitter.event},enumerable:!1,configurable:!0}),r.prototype.getLegend=function(){return{tokenTypes:["comment","function","identifier","keyword","axis","number","string","variable","measureReference","unrecognizedIdentifier","name"],tokenModifiers:["declaration"]}},r.prototype.provideDocumentSemanticTokens=function(e,t,n){if(""===e.getValue())return{data:new Uint32Array([]),resultId:null};var s=this.daxParserManager.getParseResult(e,void 0,void 0,void 0,ze.SemanticTokens);if(!s)return{data:new Uint32Array([]),resultId:null};for(var c=s.parser.tokenization.tokens,y=[0],P=1;P<e.getLineCount();P++)y.push(y[P-1]+e.getLineLength(P));var w=[],j=0,z=0,ae=s.formulaBreakup.formulaStart;ae>0&&w.push(0,0,ae,10,0);for(var ce=0,fe=c;ce<fe.length;ce++){var Se=fe[ce],Le=Pr(Se);if(11!==Le){var De=j,Xe=Se.startPosition+ae;for(P=j;P<y.length&&Xe-P>=y[P];P++)De=P;Xe-=De,Xe-=y[De],w.push(De-j,De===j?Xe-z:Xe,Se.length,Le,0),j=De,z=Xe}}return{data:new Uint32Array(w),resultId:null}},r.prototype.releaseDocumentSemanticTokens=function(e){},r}();function Pr(r){return r.isComment?0:r.isKeyword?3:r.matchObject instanceof _e.cr?4:30===r.type||31===r.type?6:36===r.type||37===r.type?5:33===r.type||35===r.type||39===r.type?11:r.isAnyKindOfIdentifier?r.matchObject instanceof _e.Gs||r.matchObject instanceof _e.Z0||r.matchObject instanceof _e.it?1:r.matchObject instanceof _e.yB?7:r.matchObject instanceof _e.Cf?8:r.matchObject instanceof _e.S2||r.matchObject instanceof _e.XN||r.matchObject instanceof _e.Df?2:9:11}var Mr=function(){function r(e,t){this.daxParserManager=e,this.localizationService=t}return r.prototype.provideHover=function(e,t,n){var o,s=Pt.getInstance().getProviderConfig(e.id);if(null!==(o=s?.hover)&&void 0!==o&&o.enabled)return s.hover.provideHover?s.hover.provideHover(e,t,n,{daxParserManager:this.daxParserManager}):this.defaultProvideHover(e,t,n)},r.prototype.defaultProvideHover=function(e,t,n){var o,s=pt.getModel(),c=pt.getContext();if(s&&c){var y=e.getOffsetAt(t),P=this.daxParserManager.getParseResult(e,y,2,void 0,ze.Hover);if(P?.parseResult){var w=null===(o=P.parser.tokenization)||void 0===o?void 0:o.tokens.find(function(fe){return fe.startPosition<=y&&y<fe.startPosition+fe.length});if(w){var j=w.getSegment(),z=w.matchObject,ae=e.getPositionAt(j.startPosition),ce=e.getPositionAt(j.startPosition+j.length);if(z instanceof _e.Gs)return this.getFunctionDetails(z,ae,ce);if(z instanceof _e.Cf)return this.getMeasureDetails(z,ae,ce,P.parser.parseTree)}}}},r.prototype.getFunctionDetails=function(e,t,n){var o=e.description||"",s=e.getDefaultPrototype();return{range:je.Range.fromPositions(t,n),contents:[{value:"**".concat(this.localizationService.get("Function"),"** ").concat(s)},{value:o}]}},r.prototype.getMeasureDetails=function(e,t,n,o){var s=e.name,c=function(r,e){for(var n,o=function(j){if(n=_.find(j.measures,function(z){return z.name.toLocaleLowerCase()===r.toLocaleLowerCase()&&(!e||e.toLowerCase()===j.name.toLowerCase())}))return"break"},s=0,c=pt.getModel().tables;s<c.length&&"break"!==o(c[s]);s++);return n}(e.name,e.table.name),y=c?.description,P=c&&!_.isNil(c.expression),w=this.getDefinedMeasure(e.table.name,e.name,o);if(c||w){var j=c?.isExternal,z=w?w.expressionNode.segment.text:void 0,ae=c&&w&&z!==c?.expression,ce=w?z:P&&!j?c.expression:void 0;return{range:je.Range.fromPositions(t,n),contents:[{value:"**".concat(this.localizationService.get("Measure"),"** ").concat(s).concat(y?" \u2013 ":"").concat(y??"")},{value:ce?"```dax\n"+ce+"\n```":"*".concat(this.localizationService.get("Dax_Formula_Unavailable"),"*")},{value:ae?"*".concat(this.localizationService.get("Dax_Query_View_Inactive_Measure"),"*\n").concat(c.expression&&!j?"```dax\n"+c.expression+"\n```":"\n*".concat(this.localizationService.get("Dax_Formula_Unavailable"),"*")):""}]}}},r.prototype.getDefinedMeasure=function(e,t,n){return this.getDefinedMeasures(n.rootNode).find(function(c){return t===c.measureDef.identifier&&e===c.measureDef.tableName})},r.prototype.getDefinedMeasures=function(e){if(!(e instanceof Ye._7))return[];for(var t=[],n=0,o=e.children;n<o.length;n++){var s=o[n];if(s instanceof Ye.Vu&&s.children[0]instanceof Ye.N4){var c=s.children[0].children.filter(function(y){return y instanceof Ye.pZ&&y.isComplete});t=(0,C.ev)((0,C.ev)([],t,!0),c,!0)}}return t},r}(),xr=function(){function r(e){this.daxParserManager=e}return r.prototype.provideCodeLenses=function(e,t){var n,o=Pt.getInstance().getProviderConfig(e.id);if(null!==(n=o?.codeLens)&&void 0!==n&&n.provideCodeLenses)return o.codeLens.provideCodeLenses(e,t,{daxParserManager:this.daxParserManager})},r}(),Rr=function(){function r(e){this.daxParserManager=e}return r.prototype.provideCodeActions=function(e,t,n,o){var s,c,y=Pt.getInstance().getProviderConfig(e.id);if(null!==(s=y?.codeAction)&&void 0!==s&&s.enabled&&null!==(c=y?.codeAction)&&void 0!==c&&c.provideCodeActions)return y.codeAction.provideCodeActions(e,t,n,o,{daxParserManager:this.daxParserManager})},r}(),Ir={rules:[{token:"comment",foreground:"008000"},{token:"function",foreground:"3165BB"},{token:"identifier",foreground:"001080"},{token:"keyword",foreground:"0000FF"},{token:"axis",foreground:"0000FF"},{token:"number",foreground:"098658"},{token:"string",foreground:"A31515"},{token:"variable",foreground:"008080"},{token:"measureReference",foreground:"68349C"},{token:"unrecognizedIdentifier",foreground:"5F5F5F5F"},{token:"name",foreground:"000000"}],colors:{"editor.background":"#FFFFFF","minimap.background":"#FFFFFF","editorSuggestWidget.selectedBackground":"#CFE4FA","editorSuggestWidget.selectedForeground":"#242424","editorSuggestWidget.highlightForeground":"#115EA3","editorSuggestWidget.focusHighlightForeground":"#115EA3"}},wr={rules:[{token:"comment",foreground:"6A9955"},{token:"function",foreground:"569CD6"},{token:"identifier",foreground:"9CDCFE"},{token:"keyword",foreground:"4FC1FF"},{token:"axis",foreground:"4FC1FF"},{token:"number",foreground:"B5CEA8"},{token:"string",foreground:"D16989"},{token:"variable",foreground:"4EC9B0"},{token:"measureReference",foreground:"C586C0"},{token:"unrecognizedIdentifier",foreground:"C8C8C8"},{token:"name",foreground:"FFFFFF"}],colors:{"editor.background":"#292929","minimap.background":"#292929","editorSuggestWidget.selectedBackground":"#0C3B5E","editorSuggestWidget.selectedForeground":"#FFFFFF","editorSuggestWidget.highlightForeground":"#479EF5","editorSuggestWidget.focusHighlightForeground":"#479EF5"}},it="dax",Ar=["var","return","not","evaluate","datatable","order","by","start","at","asc","desc","define","measure","in"],pn=function(){function r(){}return r.registerLanguageContributions=function(e,t,n){if(e===it)return void 0===this.initializedCount&&(this.initializedCount=0,r.registerDaxContributions(t,n)),this.initializedCount++,1===this.initializedCount&&r.initializeDaxContributions(),_e.dH.setFeatureSwitches({useSkippableParams:t.useSkippableParams,includeUndefinedOptionalFunctionParameters:t.includeUndefinedOptionalFunctionParameters,addTriviaToParseNodeMetadata:t.addTriviaToParseNodeMetadata,useParseTreeFormatting:t.useParseTreeFormatting}),this.daxContributions;(0,bt.sr)("Only DAX language is implemented with Monaco Contributions so far")},r.disposeLanguageContributions=function(e){if(e===it&&void 0!==this.initializedCount&&(this.initializedCount--,0===this.initializedCount)){this.daxContributions.daxParserManager.dispose(),this.daxContributions.semanticTokensProvider.dispose(),this.daxContributions.formattingEditProvider.dispose();for(var t=0,n=this.disposables;t<n.length;t++)n[t].dispose()}},r.registerDaxContributions=function(e,t){Kt.Po.unexpectedErrorHandler=function(r){setTimeout(function(){throw new h(r)})};var n=new Er;r.overrideIntellisenseWidgetPositioningStrategy(n),qe.languages.register({id:it,aliases:["DAX"],extensions:["dax","DAX"]});var o=function(r,e){var t="(".concat(r.join("|"),")");return{ignoreCase:!0,keywords:e,functions:r,tokenizer:{root:[{include:"@expression"}],expression:[[new RegExp("/\\*"),"comment","@comment"],[new RegExp("(//.*)"),"comment"],[new RegExp("--.*"),"comment"],[new RegExp('"'),"string","@string"],[new RegExp("[0-9"+Ut.w_.decimalSeparator+"]e?"),"number"],[new RegExp(t+"(\\s*\\()"),["function","function-parenthesis"]],[new RegExp("\\["),"bracketed-identifier","@bracketedIdentifier"],[new RegExp("\\'"),"quoted-identifier","@quotedIdentifier"],[new RegExp("[a-z_$][a-zA-Z0-9_$]*"),{cases:{"@keywords":"keyword"}}]],comment:[[new RegExp("[^/*]+"),"comment"],[new RegExp("/\\*"),"comment","@push"],[new RegExp("\\*/"),"comment","@pop"],[new RegExp("[/*]"),"comment"]],string:[[new RegExp('[^"]+'),"string"],[new RegExp('"'),"string","@pop"]],bracketedIdentifier:[[new RegExp("[^\\]]+"),"bracketed-identifier"],[new RegExp("]"),"bracketed-identifier","@pop"]],quotedIdentifier:[[new RegExp("[^\\']+"),"quoted-identifier"],[new RegExp("'"),"quoted-identifier","@pop"]]}}}(e.functionNames,Ar);qe.languages.setMonarchTokensProvider(it,o);var s=new Or(n);qe.languages.registerDocumentSemanticTokensProvider(it,s);var c=new lt(n);qe.languages.registerSignatureHelpProvider(it,c);var y=new lr(n);qe.languages.registerCompletionItemProvider(it,y);var P=new vr(n);qe.languages.registerDocumentFormattingEditProvider(it,P);var w=new Mr(n,t);qe.languages.registerHoverProvider(it,w);var j=new xr(n);qe.languages.registerCodeLensProvider(it,j);var z=new Rr(n);qe.languages.registerCodeActionProvider(it,z),this.daxContributions={daxParserManager:n,monarchTokensProvider:o,semanticTokensProvider:s,signatureHelpProvider:c,completionItemProvider:y,formattingEditProvider:P,hoverProvider:w,codeLensProvider:j,codeActionProvider:z},qe.editor.defineTheme(it,(0,C.pi)({base:"vs",inherit:!0},Ir)),qe.editor.defineTheme("".concat(it,"-dark"),(0,C.pi)({base:"vs-dark",inherit:!0},wr)),zt.m.setLocalizedDaxStrings({incompleteNumber:t.get("DaxError_IncompleteNumber"),invalidTupleLocation:t.get("DaxError_InvalidTupleLocation"),invalidParameter:t.get("DaxError_InvalidParameter"),missingParameters:t.get("DaxError_MissingParameters"),incorrectOrderByParam:t.get("DaxError_IncorrectOrderByParam"),incorrectPartitionByParam:t.get("DaxError_IncorrectPartitionByParam"),incorrectMatchByParam:t.get("DaxError_IncorrectMatchByParam"),grammaticalError:t.get("DaxError_GrammaticalError"),functionCallOnNonFunction:t.get("DaxError_FunctionCallOnNonFunction"),rightArgumentToInOperatorNotValidTable:t.get("DaxError_RightArgumentToInOperatorNotValidTable"),tooManyParameters:t.get("DaxError_TooManyParameters"),invalidNameCharacter:t.get("DaxError_InvalidNameCharacter"),invalidIdentifier:t.get("DaxError_UnrecognizedIdentifier"),unrecognizedIdentifier:t.get("DaxError_UnrecognizedIdentifier"),variableNameReserved:t.get("DaxError_VariableNameReserved"),rowsDescription:t.get("DaxDescription_Rows"),columnsDescription:t.get("DaxDescription_Columns"),rowsColumnsDescription:t.get("DaxDescription_RowsColumns"),columnsRowsDescription:t.get("DaxDescription_ColumnsRows"),duplicateMeasureName:t.get("DaxError_DuplicateMeasure")})},r.initializeDaxContributions=function(){var e=this;this.disposables.push(qe.languages.setLanguageConfiguration(it,{brackets:[["{","}"],["(",")"],["[","]"]],comments:{lineComment:"//",blockComment:["/*","*/"]}})),this.disposables.push(qe.editor.onDidCreateEditor(function(t){e.disposables.push(t.onDidChangeCursorSelection(function(n){if("snippet"===n.source){var o=t.getModel();if(!o)return;var s=t.getPosition();if(s&&s.equals(n.selection.getPosition())){var c=o.getPositionAt(o.getOffsetAt(n.selection.getPosition())-1),y=o.getValueInRange(qe.Range.fromPositions(c,s));e.daxContributions.signatureHelpProvider.signatureHelpTriggerCharacters.some(function(P){return P===y})&&t.trigger("ModelChangeTriggeredParameterHints","editor.action.triggerParameterHints",null)}}}))})),this.daxContributions.daxParserManager.initialize(it),this.daxContributions.semanticTokensProvider.initialize(),this.daxContributions.formattingEditProvider.initialize()},r.overrideIntellisenseWidgetPositioningStrategy=function(e){var t=J.j.prototype.getPosition;J.j.prototype.getPosition=function(){try{var n=this.editor.getModel();if(!n)return null;var o=t.apply(this);if(n.getLanguageId()!==it||!o)return o;var s=e.getParseResult(n,n.getOffsetAt(this.editor.getPosition()),void 0,!0);return s?{position:n.getPositionAt(s.formulaBreakup.formulaStart+s.parseResult.prototypePosition),preference:[qe.editor.ContentWidgetPositionPreference.ABOVE,qe.editor.ContentWidgetPositionPreference.BELOW]}:o}catch(y){return t.apply(this)}}},r.disposables=[],r}(),Wt="tmdl",gn=function(){function r(){}return r.registerLanguageContributions=function(e){e===Wt?(0===this.initializedCount&&je.languages.register({id:Wt,aliases:["TMDL"],extensions:["tmdl"]}),this.initializedCount++):(0,bt.sr)('Trying to register TMDL language while provided language is not "'.concat(e,'".'))},r.disposeLanguageContributions=function(e){e===Wt&&this.initializedCount--},r.initializedCount=0,r}(),Dr=["ADD","ALL","ALTER","AND","ANY","AS","ASC","AUTHORIZATION","BACKUP","BEGIN","BETWEEN","BREAK","BROWSE","BULK","BY","CASCADE","CASE","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COLLATE","COLUMN","COMMIT","COMPUTE","CONSTRAINT","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CREATE","CROSS","CURRENT","CURSOR","DATABASE","DBCC","DEALLOCATE","DECLARE","DEFAULT","DELETE","DENY","DESC","DISK","DISTINCT","DISTRIBUTED","DOUBLE","DROP","DUMP","ELSE","END","ERRLVL","ESCAPE","EXCEPT","EXEC","EXECUTE","EXISTS","EXIT","EXTERNAL","FETCH","FILE","FILLFACTOR","FOR","FOREIGN","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GOTO","GRANT","GROUP","HAVING","HOLDLOCK","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IN","INDEX","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KILL","LEFT","LIKE","LINENO","LOAD","MERGE","NATIONAL","NOCHECK","NONCLUSTERED","NOT","NULL","OF","OFF","OFFSETS","ON","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OUTER","OVER","PERCENT","PIVOT","PLAN","PRECISION","PRIMARY","PRINT","PROC","PROCEDURE","PUBLIC","RAISERROR","READ","READTEXT","RECONFIGURE","REFERENCES","REPLICATION","RESTORE","RESTRICT","RETURN","REVERT","REVOKE","RIGHT","ROLLBACK","ROWCOUNT","ROWGUIDCOL","RULE","SAVE","SCHEMA","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SET","SETUSER","SHUTDOWN","SOME","STATISTICS","TABLE","TABLESAMPLE","TEXTSIZE","THEN","TO","TOP","TRAN","TRANSACTION","TRIGGER","TRUNCATE","TRY_CONVERT","TSEQUAL","UNION","UNIQUE","UNPIVOT","UPDATE","UPDATETEXT","USE","USER","VALUES","VARYING","VIEW","WAITFOR","WHEN","WHERE","WHILE","WITH","WITHIN","WRITETEXT"],Nr=["ABSOLUTE","ACTION","ADA","ADD","ALLOCATE","ARE","ASSERTION","AT","BIT","BOTH","CASCADED","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","COLLATION","CONNECT","CONNECTION","CONSTRAINTS","CORRESPONDING","DATE","DEC","DECIMAL","DEFERRABLE","DEFERRED","DESCRIBE","DESCRIPTOR","DIAGNOSTICS","DISCONNECT","DOMAIN","END-EXEC","EXCEPTION","EXTRACT","FALSE","FIRST","FLOAT","FORTRAN","FOUND","GET","GLOBAL","GO","IMMEDIATE","INCLUDE","INDICATOR","INITIALLY","INSENSITIVE","INT","INTEGER","INTERVAL","ISOLATION","LANGUAGE","LAST","LEADING","LEVEL","LOCAL","MATCH","MAX","MIN","MODULE","NAMES","NATURAL","NCHAR","NEXT","NO","NONE","NUMERIC","ONLY","OVERLAPS","PAD","PARTIAL","PASCAL","POSITION","PREPARE","PRESERVE","PRIOR","PRIVILEGES","REAL","RELATIVE","ROWS","SCROLL","SECTION","SESSION","SIZE","SMALLINT","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","TEMPORARY","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TRAILING","TRANSLATE","TRANSLATION","TRIM","TRUE","UNKNOWN","USAGE","USING","VALUE","VARCHAR","WHENEVER","WORK","WRITE","ZONE"],Fr=["ADMIN","AFTER","AGGREGATE","ALIAS","ARRAY","ASENSITIVE","ASYMMETRIC","ATOMIC","BEFORE","BINARY","BLOB","BOOLEAN","BREADTH","CALL","CALLED","CARDINALITY","CLASS","CLOB","COLLECT","COMPLETION","CONDITION","CONSTRUCTOR","CORR","COVAR_POP","COVAR_SAMP","CUBE","CURRENT_CATALOG","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CYCLE","DATA","DEPTH","DEREF","DESTROY","DESTRUCTOR","DETERMINISTIC","DICTIONARY","DYNAMIC","EACH","ELEMENT","EQUALS","EVERY","FILTER","FREE","FULLTEXTTABLE","FUSION","GENERAL","HOLD","HOST","IGNORE","INITIALIZE","INOUT","INPUT","INTERSECTION","ITERATE","LARGE","LATERAL","LESS","LIKE_REGEX","LIMIT","LN","LOCALTIME","LOCALTIMESTAMP","LOCATOR","MAP","MEMBER","METHOD","MOD","MODIFIES","MODIFY","MULTISET","NCLOB","NEW","NORMALIZE","OBJECT","OCCURRENCES_REGEX","OLD","OPERATION","ORDINALITY","OUT","OUTPUT","OVERLAY","PARAMETER","PARAMETERS","PARTITION","PATH","POSITION_REGEX","POSTFIX","PREFIX","PREORDER","RANGE","READS","RECURSIVE","REF","REFERENCING","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RESULT","RETURNS","ROLE","ROLLUP","ROUTINE","ROW","SAVEPOINT","SCOPE","SEARCH","SENSITIVE","SEQUENCE","SETS","SIMILAR","SPECIFIC","SPECIFICTYPE","SQLEXCEPTION","START","STATE","STATEMENT","STATIC","STDDEV_POP","STDDEV_SAMP","STRUCTURE","SUBMULTISET","SUBSTRING_REGEX","SYMMETRIC","SYSTEM","TERMINATE","THAN","TRANSLATE_REGEX","TREAT","UESCAPE","UNDER","UNNEST","VARIABLE","VAR_POP","VAR_SAMP","WIDTH_BUCKET","WINDOW","WITHOUT","XMLAGG","XMLATTRIBUTES","XMLBINARY","XMLCAST","XMLCOMMENT","XMLCONCAT","XMLDOCUMENT","XMLELEMENT","XMLEXISTS","XMLFOREST","XMLITERATE","XMLNAMESPACES","XMLPARSE","XMLPI","XMLQUERY","XMLSERIALIZE","XMLTABLE","XMLTEXT","XMLVALIDATE"],Br=["APPLY","MATCHED"],Lr=["ABS","ACOS","APPROX_COUNT_DISTINCT","ASCII","ASIN","ATAN","ATN2","AVG","BINARY_CHECKSUM","BIT_LENGTH","CEILING","CHARINDEX","CHECKSUM","COALESCE","COLLATIONPROPERTY","COL_NAME","CONCAT","COS","COT","COUNT","COUNT_BIG","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASEPROPERTYEX","DATALENGTH","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DB_ID","DB_NAME","DEGREES","DENSE_RANK","DIFFERENCE","EOMONTH","ERROR_MESSAGE","ERROR_NUMBER","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","EXP","FIRST_VALUE","FLOOR","GETDATE","GETUTCDATE","GROUPING","HASHBYTES","HAS_DBACCESS","HOUR","INDEXPROPERTY","ISDATE","ISNULL","ISNUMERIC","LAG","LAST_VALUE","LEAD","LEN","LOG10","LOWER","LTRIM","MINUTE","MONTH","MONTHNAME","NTILE","NULLIF","OBJECTPROPERTY","OBJECTPROPERTYEX","OBJECT_ID","OBJECT_NAME","OCTET_LENGTH","PARSENAME","PATINDEX","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PI","POWER","QUARTER","QUOTENAME","RADIANS","RAND","RANK","REPLACE","REVERSE","ROUND","ROW_NUMBER","RTRIM","SCHEMA_ID","SCHEMA_NAME","SECOND","SERVERPROPERTY","SESSION_USER","SIGN","SIN","SMALLDATETIMEFROMPARTS","SOUNDEX","SPACE","SQL_VARIANT_PROPERTY","SQRT","SQUARE","STATS_DATE","STDEV","STDEVP","STR","STRING_AGG","STUFF","SUBSTRING","SUM","SUSER_SNAME","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSTEM_USER","SYSUTCDATETIME","TAN","TERTIARY_WEIGHTS","TIMEFROMPARTS","TODATETIMEOFFSET","TYPEPROPERTY","TYPE_ID","TYPE_NAME","UNICODE","UPPER","USER_NAME","VAR","VARP","WEEK","XACT_STATE","YEAR"],jr=function(){function r(){!function(){var r=kt.n.prototype.triggerSuggest;kt.n.prototype.triggerSuggest=function(e,t){return r.apply(this,[e,!0])}}()}return r.prototype.provideCompletionItems=function(e,t,n,o){var s=e.getWordUntilPosition(t),c={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:s.startColumn,endColumn:s.endColumn},y={id:"editor.action.triggerSuggest",title:"TriggerSuggestion"},P=Dr.map(function(fe){return{label:fe,kind:je.languages.CompletionItemKind.Keyword,detail:"",insertText:fe,range:c,command:y}}).filter(function(fe){var Se;return fe.label.toString().startsWith(null===(Se=s.word)||void 0===Se?void 0:Se.toLocaleUpperCase())}),w=Nr.map(function(fe){return{label:fe,kind:je.languages.CompletionItemKind.Keyword,detail:"",insertText:fe,range:c,command:y}}).filter(function(fe){var Se;return fe.label.toString().startsWith(null===(Se=s.word)||void 0===Se?void 0:Se.toLocaleUpperCase())}),j=Fr.map(function(fe){return{label:fe,kind:je.languages.CompletionItemKind.Keyword,detail:"",insertText:fe,range:c,command:y}}).filter(function(fe){var Se;return fe.label.toString().startsWith(null===(Se=s.word)||void 0===Se?void 0:Se.toLocaleUpperCase())}),z=Br.map(function(fe){return{label:fe,kind:je.languages.CompletionItemKind.Operator,detail:"",insertText:fe,range:c,command:y}}).filter(function(fe){var Se;return fe.label.toString().startsWith(null===(Se=s.word)||void 0===Se?void 0:Se.toLocaleUpperCase())}),ae=Lr.map(function(fe){return{label:fe,kind:je.languages.CompletionItemKind.Function,detail:"",insertText:fe,range:c,command:y}}).filter(function(fe){var Se;return fe.label.toString().startsWith(null===(Se=s.word)||void 0===Se?void 0:Se.toLocaleUpperCase())}),ce=(0,C.ev)((0,C.ev)((0,C.ev)((0,C.ev)((0,C.ev)([],P,!0),w,!0),j,!0),z,!0),ae,!0);return Promise.resolve({suggestions:ce})},r.prototype.resolveCompletionItem=function(e,t){return Promise.resolve(e)},r}(),Vr=function(){function r(){this.disposables=[]}return r.prototype.initialize=function(e){var t=this;this.disposables.push(je.editor.onDidCreateEditor(function(n){t.disposables.push(n.onDidChangeModelContent(function(o){t.handleModelChange(n,"reset")}))}))},r.prototype.dispose=function(){for(var e=0,t=this.disposables;e<t.length;e++)t[e].dispose()},r.prototype.handleModelChange=function(e,t){e.trigger("TriggerSuggestion","editor.action.triggerSuggest",{auto:!0,completionOptions:{providerFilter:void 0,kindFilter:void 0}})},r}(),Nt="sql",mn=function(){function r(){}return r.registerLanguageContributions=function(e){return e===Nt?(0===this.initializedCount&&(this.initializedCount=1,r.registerSqlContributions()),1===this.initializedCount&&r.initializeSqlContributions(),this.sqlContributions):this.sqlContributions},r.disposeLanguageContributions=function(e){if(e===Nt&&(this.initializedCount--,this.initializedCount<=0)){this.sqlContributions.sqlParserManager.dispose();for(var t=0,n=this.disposables;t<n.length;t++)n[t].dispose()}},r.registerSqlContributions=function(){qe.languages.register({id:Nt,aliases:["sql"],extensions:["sql"]});var e=new Vr,t=new jr;this.disposables.push(qe.languages.registerCompletionItemProvider(Nt,t)),this.sqlContributions={sqlParserManager:e,completionItemProvider:t}},r.initializeSqlContributions=function(){this.disposables.push(qe.languages.setLanguageConfiguration(Nt,{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]})),this.sqlContributions.sqlParserManager.initialize(Nt)},r.initializedCount=0,r.disposables=[],r}(),kr=T(32238),Qe=function(r){return r[r.AltEnter=0]="AltEnter",r[r.AltF1=1]="AltF1",r[r.Ctrl0=2]="Ctrl0",r[r.CtrlEnter=3]="CtrlEnter",r[r.CtrlEqual=4]="CtrlEqual",r[r.CtrlF=5]="CtrlF",r[r.CtrlF3=6]="CtrlF3",r[r.CtrlH=7]="CtrlH",r[r.CtrlJ=8]="CtrlJ",r[r.CtrlMinus=9]="CtrlMinus",r[r.Enter=10]="Enter",r[r.Escape=11]="Escape",r[r.F1=12]="F1",r[r.F3=13]="F3",r[r.F8=14]="F8",r[r.ShiftEnter=15]="ShiftEnter",r}({}),vn="accessibilityWidgetVisible",yn="suggestWidgetVisible",Hr={scrollbar:{vertical:"visible"}},zr={scrollbar:{vertical:"hidden"}},Cn=function(){function r(e){this.editor=e}return r.prototype.insertNewLine=function(){var e=this.editor.getPosition().lineNumber;this.editor.trigger("MonacoEditorUtility.insertNewLine","lineBreakInsert",{}),this.editor.setPosition({lineNumber:e+1,column:this.editor.getModel().getLineIndentColumn(e+1)}),this.updateEditorScrollbar(),this.editor.trigger("InsertNewLineTriggeredSuggest","editor.action.triggerSuggest",{auto:!0})},r.prototype.getSelections=function(){return this.editor.getSelections()},r.prototype.setSelection=function(e){if(e){var t=this.editor.getModel();if(!(e.startPosition+e.length>this.getModelText(t).length)){var n=t.getPositionAt(e.startPosition),o=t.getPositionAt(e.startPosition+e.length);this.editor.setSelection({startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:o.lineNumber,endColumn:o.column})}}},r.prototype.setIsReadOnly=function(e){this.editor.updateOptions({readOnly:e})},r.prototype.getModelText=function(e){return e?e.getValue():""},r.prototype.getEditorText=function(){return this.getModelText(this.editor.getModel())},r.prototype.getCursorPosition=function(){var e=this.editor.getModel(),t=this.getModelText(e),n=this.editor.getSelection(),o=this.getAbsolutePositionInModel(e,n.getEndPosition(),t);return{position:o,selectionStart:n.isEmpty()?o:this.getAbsolutePositionInModel(e,n.getStartPosition(),t)}},r.prototype.getAbsolutePositionInModel=function(e,t,n){var o=e.getLinesContent();if(t.lineNumber>o.length)return n.length;for(var s=t.lineNumber-1,y=t.column>o[s].length?o[s].length:t.column-1;--s>=0;)y+=o[s].length+1;return y},r.prototype.updateEditorScrollbar=function(){var e=this.editor.getLayoutInfo();this.editor.getContentHeight()>e.height?this.editor.updateOptions(Hr):this.editor.updateOptions(zr)},r.prototype.executeCopy=function(){this.executeCommandForSelection("copy")},r.prototype.executeCut=function(){this.executeCommandForSelection("cut")},r.prototype.executeFormat=function(){var e;return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.editor.getAction("editor.action.formatDocument"))||void 0===e?void 0:e.run()];case 1:return t.sent(),[2]}})})},r.prototype.executeCommandForSelection=function(e){this.editor.getSelection().isEmpty()||document.execCommand(e)},r}(),bn=T(64647),Kr=["editorContainer"],Wr=["accessibilityContent"];function Qr(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",3),i.\u0275\u0275listener("keydown",function(s){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onAccessibilityWidgetKeypress(s))}),i.\u0275\u0275elementStart(1,"div",4,5),i.\u0275\u0275listener("blur",function(){i.\u0275\u0275restoreView(t);var s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onAccessibilityWidgetBlur())}),i.\u0275\u0275text(3),i.\u0275\u0275element(4,"br")(5,"br"),i.\u0275\u0275text(6),i.\u0275\u0275element(7,"br")(8,"br"),i.\u0275\u0275text(9),i.\u0275\u0275element(10,"br")(11,"br"),i.\u0275\u0275text(12),i.\u0275\u0275element(13,"br")(14,"br"),i.\u0275\u0275text(15),i.\u0275\u0275elementEnd()()}if(2&r){var n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngStyle",n.accessibilityWidgetStyle),i.\u0275\u0275attribute("aria-hidden",!n.accessibilityWidgetVisible),i.\u0275\u0275advance(1),i.\u0275\u0275attribute("aria-label",n.accessibilityWidgetAria),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",n.accessibilityWidgetMessages.cursor," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.optimized," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.tabbing," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("- ",n.accessibilityWidgetMessages.documentation," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1("",n.accessibilityWidgetMessages.dismiss," ")}}var Qt=function(){function r(e,t,n,o,s,c,y){this.themeManager=e,this.element=t,this.highContrastCssGenerationService=n,this.accessibilityService=o,this.localizationService=s,this.featureSwitchService=c,this.ref=y,this.defaultMonacoProviderConfig={modelOptions:{endOfLineStyle:qe.editor.EndOfLineSequence.LF}},this.initialized=new i.EventEmitter,this.onFocus=new i.EventEmitter,this.onBlur=new i.EventEmitter,this.tabFocusMode=new i.EventEmitter,this.onContentChanged=new i.EventEmitter,this.onContentHeightChanged=new i.EventEmitter,this.onZoomLevelChanged=new i.EventEmitter,this.subscriptions=[],this.isInHighContrast=!1,this.toUnhooks=[],this.initializationTask=new l.B}return Object.defineProperty(r.prototype,"monacoKeybindingsMap",{get:function(){return this._monacoKeybindingsMap},enumerable:!1,configurable:!0}),r.prototype.ngOnInit=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,n,s,c,y,P,w,j=this;return(0,C.Jh)(this,function(z){switch(z.label){case 0:return[4,Promise.all([Promise.resolve().then(T.bind(T,68816)),Promise.resolve().then(T.bind(T,94124))])];case 1:return P=z.sent(),this.monacoApi={monaco:e=P[0],EditorZoom:P[1].EditorZoom},this._monacoKeybindingsMap=((w={})[Qe.AltEnter]=e.KeyMod.Alt|e.KeyCode.Enter,w[Qe.AltF1]=e.KeyMod.Alt|e.KeyCode.F1,w[Qe.Ctrl0]=e.KeyMod.CtrlCmd|e.KeyCode.Numpad0,w[Qe.CtrlEnter]=e.KeyMod.CtrlCmd|e.KeyCode.Enter,w[Qe.CtrlEqual]=e.KeyMod.CtrlCmd|e.KeyCode.Equal,w[Qe.CtrlF]=e.KeyMod.CtrlCmd|e.KeyCode.KeyF,w[Qe.CtrlF3]=e.KeyMod.CtrlCmd|e.KeyCode.F3,w[Qe.CtrlH]=e.KeyMod.CtrlCmd|e.KeyCode.KeyH,w[Qe.CtrlJ]=e.KeyMod.CtrlCmd|e.KeyCode.KeyJ,w[Qe.CtrlMinus]=e.KeyMod.CtrlCmd|e.KeyCode.Minus,w[Qe.Enter]=e.KeyCode.Enter,w[Qe.Escape]=e.KeyCode.Escape,w[Qe.F1]=e.KeyCode.F1,w[Qe.F3]=e.KeyCode.F3,w[Qe.F8]=e.KeyCode.F8,w[Qe.ShiftEnter]=e.KeyMod.Shift|e.KeyCode.Enter,w),this.mode===Nt?mn.registerLanguageContributions(this.mode):this.mode===it?(n=[],this.languageOptions&&(n=this.languageOptions.Functions.map(function(ae){return ae.Name})),this.contributions=pn.registerLanguageContributions(this.mode,{functionNames:n,useSkippableParams:!0,includeUndefinedOptionalFunctionParameters:!0,addTriviaToParseNodeMetadata:!0,useParseTreeFormatting:!0},this.localizationService)):this.mode===Wt&&gn.registerLanguageContributions(this.mode),s={automaticLayout:!1,autoClosingBrackets:"never",codeLens:!1,contextmenu:!1,folding:!1,fontSize:12,language:this.mode,lineHeight:18,lineNumbersMinChars:1,minimap:{enabled:!1},mouseWheelZoom:!0,quickSuggestions:!1,renderLineHighlight:"none",roundedSelection:!1,scrollbar:{useShadows:!1,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,selectionHighlight:!1,suggestSelection:"first",wordBasedSuggestions:!1,acceptSuggestionOnEnter:"on",wordWrap:"on",value:"","semanticHighlighting.enabled":!0,unicodeHighlight:{nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}},this.isReadOnly&&(s.overviewRulerBorder=!1,s.hideCursorInOverviewRuler=!0,s.lineNumbers="off"),c=null!=this.customCreationOptions?(0,C.pi)((0,C.pi)({},s),this.customCreationOptions):s,y=Pt.getInstance().createMonacoModelWithConfig("",this.mode,this.defaultMonacoProviderConfig),this.textEditor=this.monacoApi.monaco.editor.create(this.editorContainer.nativeElement,(0,C.pi)({model:y},c)),$(this.textEditor.getDomNode()).find("textarea.inputarea").addClass("cdk-visually-hidden"),this.monacoEditorUtility=new Cn(this.textEditor),this.initializeMonacoEvents(),this.initializeHighContrastSettings(),this.initializationTask.resolve(),this.initialized.next(this),this.subscriptions.push(this.themeManager.theme$.subscribe(function(ae){var ce=j.resolveThemeName(ae);j.theme=ce,j.isInHighContrast||j.monacoApi.monaco.editor.setTheme(ce)})),[2]}})})},r.prototype.ngOnChanges=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,this.initializationTask.promise];case 1:return t.sent(),e.formulaText&&this.setText(e.formulaText.currentValue),e.isReadOnly&&!e.isReadOnly.isFirstChange()&&this.setIsReadOnly(e.isReadOnly.currentValue),e.selection&&this.monacoEditorUtility.setSelection(e.selection.currentValue),[2]}})})},r.prototype.ngOnDestroy=function(){for(var e=0,t=this.toUnhooks;e<t.length;e++)t[e].dispose();if(this.subscriptions)for(var o=0,s=this.subscriptions;o<s.length;o++)s[o].unsubscribe();this.textEditor&&this.textEditor.dispose(),pn.disposeLanguageContributions(this.mode),mn.disposeLanguageContributions(this.mode),gn.disposeLanguageContributions(this.mode)},Object.defineProperty(r.prototype,"accessibilityWidgetAria",{get:function(){if(this.accessibilityWidgetMessages)return"".concat(this.accessibilityWidgetMessages.cursor," ").concat(this.accessibilityWidgetMessages.optimized," ").concat(this.accessibilityWidgetMessages.tabbing," ").concat(this.accessibilityWidgetMessages.documentation," ").concat(this.accessibilityWidgetMessages.dismiss)},enumerable:!1,configurable:!0}),r.prototype.focus=function(){this.textEditor&&this.textEditor.focus()},r.prototype.scrollTop=function(){this.textEditor.setScrollPosition({scrollTop:0})},r.prototype.copy=function(){this.monacoEditorUtility.executeCopy()},r.prototype.cut=function(){this.monacoEditorUtility.executeCut()},r.prototype.paste=function(e){for(var n=[],o=0,s=this.monacoEditorUtility.getSelections();o<s.length;o++)n.push({text:e,range:s[o],forceMoveMarkers:!0});this.textEditor.executeEdits(e,n)},r.prototype.getText=function(){return this.monacoEditorUtility.getEditorText()},r.prototype.resetModelTokens=function(e){var t;this.monacoEditorUtility.getEditorText()!==e?this.textEditor.getModel().setValue(e):null===(t=this.textModelInternal().tokenization)||void 0===t||t.resetTokenization()},r.prototype.textModelInternal=function(){return this.textEditor.getModel()},r.prototype.format=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.monacoEditorUtility.executeFormat()];case 1:return e.sent(),[2]}})})},r.prototype.onAccessibilityWidgetBlur=function(){this.accessibilityWidgetVisible=!1,this.accessibilityWidgetContextKey.set(!1),this.textEditor.focus()},r.prototype.onAccessibilityWidgetKeypress=function(e){var t=!1;switch(e.code){case"KeyE":e.ctrlKey&&(t=!0,this.textEditor.updateOptions({accessibilitySupport:this.textEditor.getRawOptions().accessibilitySupport}));break;case"KeyH":e.ctrlKey&&(t=!0,window.open("https://go.microsoft.com/fwlink?linkid=2028689"));break;case"KeyM":e.ctrlKey&&(t=!0,this.toggleTabMovesFocus());break;case"Escape":t=!0,this.onAccessibilityWidgetBlur()}t&&(event.stopPropagation(),event.preventDefault())},r.prototype.layout=function(e,t){if(te.fF.assert(function(){return void 0!==e||void 0!==t},"At least one of the width/height values should be specified."),this.textEditor){var n=this.textEditor.getLayoutInfo(),o=e||n.width,s=t||n.height;this.textEditor.layout({width:o,height:s}),$(this.editorContainer).width(o).height(s)}},r.prototype.toggleTabMovesFocus=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.initializationTask];case 1:return e.sent(),this.textEditor.getAction("editor.action.toggleTabFocusMode").run(),[2]}})})},r.prototype.registerActions=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return[4,this.initializationTask.promise];case 1:for(c.sent(),t=0,n=e;t<n.length;t++)s=(o=n[t]).keybindingContext?"".concat(this.editorContextId,"&&").concat(o.keybindingContext):this.editorContextId,o.keybindingContext=s,this.textEditor.addAction(o);return[2]}})})},r.prototype.setValue=function(e){this.textEditor.setValue(e)},r.prototype.insertTextAtCurrentCursor=function(e){this.textEditor.trigger("keyboard","paste",{text:e})},r.prototype.getHighlightedText=function(){var e=this.textEditor.getSelection();return null==e?"":this.textEditor.getModel().getValueInRange(e)},r.prototype.updateZoomLevel=function(e){te.fF.assert(function(){return e>=-5&&e<=20},"zoomLevel should be between -5 to 20"),this.monacoApi.EditorZoom.setZoomLevel(e)},r.prototype.getZoomLevel=function(){return this.monacoApi.EditorZoom.getZoomLevel()},r.prototype.showAccessibilityWidget=function(){if(!this.accessibilityWidgetVisible){this.updateAccessibilityMessage();var e=this.textEditor.getLayoutInfo();this.accessibilityWidgetStyle={top:"30px","max-width":"".concat(e.width,"px"),"max-height":"".concat(e.height-38,"px")},this.accessibilityWidgetVisible=!0,this.accessibilityWidgetContextKey.set(!0),this.ref.detectChanges(),this.accessibilityContent.nativeElement.focus()}},r.prototype.updateAccessibilityMessage=function(){var e=this.textEditor.getPosition();this.accessibilityWidgetMessages={cursor:this.localizationService.format("MonacoEditorAccessibilityMessageCursor",[e.lineNumber,e.column]),optimized:this.localizationService.get(this.textEditor.getOption(this.monacoApi.monaco.editor.EditorOption.accessibilitySupport)?"MonacoEditorAccessibilityOn":"MonacoEditorAccessibilityOff"),tabbing:this.localizationService.get(this.textEditor.getOption(this.monacoApi.monaco.editor.EditorOption.tabFocusMode)?"MonacoEditorAccessibilityTabMovesFocusOn":"MonacoEditorAccessibilityTabMovesFocusOff"),documentation:this.localizationService.get("MonacoEditorAccessibilityMessageDocumentation"),dismiss:this.localizationService.get("MonacoEditorAccessibilityMessageDismiss")}},r.prototype.initializeHighContrastSettings=function(){var e=this;this.subscriptions.push(this.accessibilityService.highContrastThemeChanged$.subscribe(function(t){return e.setHighContrastTheme(t)})),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .view-overlays .selected-text","{ background-color: @selectedBackgroundColor !important; border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .cursor","{ color: @foregroundColor !important; background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .hc-black .monaco-scrollable-element > .scrollbar > .slider","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor.hc-black .view-line span.inline-selected-text","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget > .tree","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .details","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon::before","{ color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-struct::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-interface::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-constructor::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-widget .suggest-icon.codicon-symbol-module::before","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .parameter-hints-widget","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .monaco-editor .suggest-details","{ background-color: @backgroundColor !important; }"),this.setHighContrastTheme(this.accessibilityService.getHighContrastTheme())},r.prototype.setIsReadOnly=function(e){this.monacoEditorUtility.setIsReadOnly(e),this.textEditor.updateOptions({overviewRulerBorder:!e&&void 0,hideCursorInOverviewRuler:!!e||void 0,lineNumbers:e?"off":void 0})},r.prototype.setText=function(e){var t=this.textEditor.getModel();this.monacoEditorUtility.getEditorText()!==e&&t.applyEdits([{text:e||"",range:t.getFullModelRange()}]);var n=e?t.getPositionAt(e.length):{lineNumber:1,column:1};this.textEditor.setPosition(n)},r.prototype.setHighContrastTheme=function(e){if(!e)return this.isInHighContrast=!1,void this.monacoApi.monaco.editor.setTheme(this.theme);this.isInHighContrast=!0;var t=function(o){return"#"===o[0]?o.substr(1):o};this.monacoApi.monaco.editor.defineTheme("highContrast",{base:"hc-black",inherit:!1,rules:[{background:t(e.background),foreground:t(e.foreground),token:""}],colors:{"editor.background":e.background,"editor.foreground":e.foreground,"editorCursor.foreground":e.foreground,"editor.selectionBackground":e.selectedBackground,"editor.selectionForeground":e.selectedText,"editor.selectionHighlight":e.selected}}),this.monacoApi.monaco.editor.setTheme("highContrast")},r.prototype.initializeMonacoEvents=function(){var e=this;this.editorContextId="MonacoEditorHost".concat(this.textEditor.getId(),".focused");var t=this.textEditor.createContextKey(this.editorContextId,!1);this.toUnhooks.push(this.textEditor.onDidFocusEditorText(function(){t.set(!0),e.onFocus.emit()})),this.toUnhooks.push(this.textEditor.onDidBlurEditorText(function(){t.set(!1),e.onBlur.emit()})),this.accessibilityWidgetContextKey=this.textEditor.createContextKey(vn,!1),this.configureDefaultKeybindings(),this.toUnhooks.push(this.textEditor.onDidChangeConfiguration(function(){e.tabFocusMode.next(e.textEditor.getOption(e.monacoApi.monaco.editor.EditorOption.tabFocusMode)),e.textEditor.getModel()&&e.updateAccessibilityMessage()})),this.toUnhooks.push(this.textEditor.onDidChangeModelContent(function(n){e.onContentChanged.next(n.changes)})),this.toUnhooks.push(this.textEditor.onDidContentSizeChange(function(n){n.contentHeightChanged&&e.onContentHeightChanged.next(n.contentHeight)})),this.toUnhooks.push(this.monacoApi.EditorZoom.onDidChangeZoomLevel(function(n){e.onZoomLevelChanged.next(n),e.hideSuggestWidget()}))},r.prototype.configureDefaultKeybindings=function(){var e=this,t=[{id:"editor.action.fontZoomIn",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomIn"),keybindings:[this.monacoKeybindingsMap[Qe.CtrlEqual]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(e.monacoApi.EditorZoom.getZoomLevel()+1),e.hideSuggestWidget()}},{id:"editor.action.fontZoomOut",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomOut"),keybindings:[this.monacoKeybindingsMap[Qe.CtrlMinus]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(e.monacoApi.EditorZoom.getZoomLevel()-1),e.hideSuggestWidget()}},{id:"editor.action.fontZoomReset",label:this.localizationService.get("DaxEditor_CommandLabel_ZoomReset"),keybindings:[this.monacoKeybindingsMap[Qe.Ctrl0]],run:function(){e.monacoApi.EditorZoom.setZoomLevel(0),e.hideSuggestWidget()}},{id:"editor.action.showAccessibilityWidget",label:"Show Accessibility Widget",keybindings:[this.monacoKeybindingsMap[Qe.AltF1]],run:function(){e.showAccessibilityWidget()}},{id:"editor.action.newLineAltEnter",label:this.localizationService.get("New_Line_AltEnter"),keybindings:[this.monacoKeybindingsMap[Qe.AltEnter]],run:function(){return e.monacoEditorUtility.insertNewLine()}},{id:"editor.action.newLineShiftEnter",label:this.localizationService.get("New_Line_ShiftEnter"),keybindings:[this.monacoKeybindingsMap[Qe.ShiftEnter]],run:function(){return e.monacoEditorUtility.insertNewLine()}}];this.registerActions(t),this.textEditor.addCommand(this.monacoKeybindingsMap[Qe.F1],_.noop)},r.prototype.hideSuggestWidget=function(){this.textEditor.trigger(null,"hideSuggestWidget",null)},r.prototype.resolveThemeName=function(e){return this.mode===it?"dark"===e?"dax-dark":"dax":"dark"===e?"vs-dark":"vs"},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275directiveInject(kr.Ve),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(bn.g),i.\u0275\u0275directiveInject(Dt),i.\u0275\u0275directiveInject(le.o),i.\u0275\u0275directiveInject(D.vZ),i.\u0275\u0275directiveInject(i.ChangeDetectorRef))},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["monaco-editor-host"]],viewQuery:function(t,n){if(1&t&&(i.\u0275\u0275viewQuery(Kr,7,i.ElementRef),i.\u0275\u0275viewQuery(Wr,5)),2&t){var o=void 0;i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.editorContainer=o.first),i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.accessibilityContent=o.first)}},inputs:{formulaText:"formulaText",isReadOnly:"isReadOnly",mode:"mode",theme:"theme",selection:"selection",customCreationOptions:"customCreationOptions",languageOptions:"languageOptions",defaultMonacoProviderConfig:"defaultMonacoProviderConfig"},outputs:{initialized:"initialized",onFocus:"onFocus",onBlur:"onBlur",tabFocusMode:"tabFocusMode",onContentChanged:"onContentChanged",onContentHeightChanged:"onContentHeightChanged",onZoomLevelChanged:"onZoomLevelChanged"},features:[i.\u0275\u0275NgOnChangesFeature],decls:3,vars:3,consts:[["focus-nav-mode","Browser",1,"monacoEditorContainer"],["editorContainer",""],["class","customAccessibilityHelpWidget","role","dialog",3,"ngStyle","keydown",4,"ngIf"],["role","dialog",1,"customAccessibilityHelpWidget",3,"ngStyle","keydown"],["role","document","tabindex","0",1,"content",3,"blur"],["accessibilityContent",""]],template:function(t,n){1&t&&(i.\u0275\u0275element(0,"div",0,1),i.\u0275\u0275template(2,Qr,16,8,"div",2)),2&t&&(i.\u0275\u0275classProp("readonly",n.isReadOnly),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.accessibilityWidgetVisible))},dependencies:[x.NgIf,x.NgStyle],styles:['[_nghost-%COMP%]   .customAccessibilityHelpWidget[_ngcontent-%COMP%]{position:absolute;width:500px;height:300px;padding:4px;overflow:auto;border:1px solid var(--fluent-theme-neutral-secondary-color, #605E5C);background-color:var(--fluent-theme-neutral-light-color, #EDEBE9);z-index:1}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]{box-sizing:border-box;height:100%}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursors-layer[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .view-lines[_ngcontent-%COMP%]{cursor:inherit}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursors-layer[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .view-lines[_ngcontent-%COMP%]:hover{cursor:text}[_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .inputarea[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .monaco-editor-background[_ngcontent-%COMP%], [_nghost-%COMP%]   .monacoEditorContainer.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .margin[_ngcontent-%COMP%]{background-color:var(--fluent-theme-primary-color, #F2C811)}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .wordHighlight{background-color:transparent}@media (forced-colors: active){[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .quick-input-widget{background-color:canvas!important}}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{background-image:none;content:"\\f305";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-function:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{background-image:none;content:"\\ed86";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-class:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{background-image:none;content:"\\e4bd";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-property:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{background-image:none;content:"\\e8ef";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-method:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{background-image:none;content:"\\f37c";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-enum:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{background-image:none;content:"\\f86d";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-folder:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{background-image:none;content:"\\e787";font-family:PowrMDL2;color:var(--fluent-theme-black-color, #000);font-size:var(--sm-font-size, 12px)}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-event:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+T.p+'../images/DaxAxisRows.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-struct:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+T.p+'../images/DaxAxisColumns.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-interface:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+T.p+'../images/DaxAxisRowsColumns.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-constructor:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{background-color:var(--colorNeutralForeground1);width:12px;height:12px;display:inline-block;mask:url('+T.p+'../images/DaxAxisColumnsRows.svg) no-repeat 50% 50%;-webkit-mask-size:cover;mask-size:cover}html:not([dir="rtl"])   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{padding-left:2px;padding-right:4px}html[dir="rtl"]   [_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row .suggest-icon.codicon-symbol-module:before{padding-left:4px;padding-right:2px}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused.string-label .codicon-suggest-more-info{visibility:visible;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}@media (forced-colors: active){[_nghost-%COMP%]   .monacoEditorContainer[_ngcontent-%COMP%]     .monaco-editor .scrollbar .slider{background-color:highlight!important}}'],changeDetection:0}),r}(),En=T(82156),Tn=T(17177),nn=T(74913),Jr=T(50057),rn=T(85102),Sn=function(){function r(){this.iconName="copilot_24_multicolor",this.sprite="copilot-icons"}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["copilot-gutter-button"]],inputs:{iconName:"iconName",sprite:"sprite"},decls:3,vars:5,consts:[["tri-button","","appearance","subtle","localize-tooltip","Ribbon_Dax_Copilot_Tooltip",1,"icon-button"],["tri-svg-icon-16","",3,"name","sprite"]],template:function(t,n){1&t&&(i.\u0275\u0275elementStart(0,"button",0),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275element(2,"tri-svg-icon",1),i.\u0275\u0275elementEnd()),2&t&&(i.\u0275\u0275attribute("aria-label",i.\u0275\u0275pipeBind1(1,3,"Ribbon_Dax_Copilot_Tooltip")),i.\u0275\u0275advance(2),i.\u0275\u0275property("name",n.iconName)("sprite",n.sprite))},dependencies:[nn.M,Jr.r,rn.F],styles:["tri-svg-icon[_ngcontent-%COMP%]{fill:var(--colorBrandForeground2);width:100%;height:100%}"]}),r}(),$r={buttonHeightOffset:-7,rightOffset:0,onButtonClick:function(){}},qr=function(){function r(){this.isInitialized=!1,this.gutterContainerSelector=".margin-view-overlays",this.currentLineSelector=".current-line",this.activeLineNumberSelector=".active-line-number"}return r.prototype.initialize=function(e,t,n){this.isInitialized||(this.isInitialized=!0,this.initializeButton(t,n),this.initializeObserver(e))},r.prototype.initializeButton=function(e,t){t=(0,C.pi)((0,C.pi)({},$r),t);var n=e.createComponent(Sn);this.button=n.location.nativeElement,this.button.style.right="".concat(t.rightOffset,"px"),this.button.style.position="absolute",this.button.style.top="".concat(t.buttonHeightOffset,"px"),this.button.style.cursor="pointer",this.button.addEventListener("click",t.onButtonClick)},r.prototype.initializeObserver=function(e){var t=this;e.textEditor.onDidChangeModelDecorations(function(){t.showButtonOnInit(e);var n=document.querySelector(t.gutterContainerSelector);n.childNodes.length>0&&t.observeGutterContainer(n,e)})},r.prototype.showButtonOnInit=function(e){var t=document.querySelector(this.activeLineNumberSelector),n=t?.parentElement;n&&window.getComputedStyle(n).position&&this.handleCurrentLine(t.parentElement,e)},r.prototype.observeGutterContainer=function(e,t){var n=this;this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(function(o){for(var s=0,c=o;s<c.length;s++){var y=c[s];y.addedNodes.length&&n.handleAddedNodes(y.addedNodes,t)}}),this.mutationObserver.observe(e,{childList:!0})},r.prototype.handleAddedNodes=function(e,t){var n=this;e.forEach(function(o){o.querySelector(n.currentLineSelector)&&n.handleCurrentLine(o,t)})},r.prototype.handleCurrentLine=function(e,t){var n=e.querySelector(this.activeLineNumberSelector),o=n?parseInt(n.textContent,10):null,s=t.textEditor.getModel();"number"!=typeof o||o>s.getLineCount()||s.getLineContent(o).trim().length||e.appendChild(this.button)},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)}}),r}(),ei=[{type:Qt,componentId:"MonacoEditorHostComponentId"}],ti=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[qr],imports:[x.CommonModule,En.N.withManifests(ei),Tn.T6,Q.v]}),r}(),On=T(93367),ni=T(94841),ri=T(79725),ii=T(16095),oi=T(53772),ai=T(44913),si=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({imports:[x.CommonModule,I.u5,On.U,Q.v,ti,ni.b,ii.Z,ri.j,oi.w,Vt,q._,ai.lK,Tn.T6]}),r}(),ui=T(14463),Pn=T(15393),Mn=T(10861),Zt=T(51644);function St(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return te.fF.assertValue(r,"functionName"),te.fF.assertValue(e,"args"),"".concat(r).concat(Zt.block("(",e,")"))}var Lt,Ft=T(50550),He=T(21571),xn=function(){function r(e){this.localizationService=e}return r.prototype.getTemplates=function(){return[new pi(this.localizationService),new gi(this.localizationService),new mi(this.localizationService),new vi(this.localizationService),new yi(this.localizationService),new Xt(this.localizationService,0),new Xt(this.localizationService,1),new Xt(this.localizationService,3),new Xt(this.localizationService,2)]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(le.o))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),pi=function(){function r(e){this.localizationService=e,this.capabilities={name:"RunningSum",displayName:(0,He.V)("VisualCalcTemplate_RunningSum_DisplayName"),description:(0,He.V)("VisualCalcTemplate_RunningSum_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService);return function(r){return te.fF.assertValue(r,"expression"),St("RUNNINGSUM",r)}("[".concat(e,"]"))},r}(),gi=function(){function r(e){this.localizationService=e,this.capabilities={name:"MovingAverage",displayName:(0,He.V)("VisualCalcTemplate_MovingAverage_DisplayName"),description:(0,He.V)("VisualCalcTemplate_MovingAverage_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"WindowSize",constant:{type:{numeric:!0},defaultValue:1},displayName:(0,He.V)("VisualCalcTemplate_WindowSizeField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService);return function(r,e){return te.fF.assertValue(r,"expression"),te.fF.assertValue(e,"windowSize"),St("MOVINGAVERAGE",r,e)}("[".concat(e,"]"),"".concat(t))},r}(),mi=function(){function r(e){this.localizationService=e,this.capabilities={name:"PercentOfParent",displayName:(0,He.V)("VisualCalcTemplate_PercentOfParent_DisplayName"),description:(0,He.V)("VisualCalcTemplate_PercentOfParent_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"CollapseDenominatorField",column:{},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=(0,He.G)(this.capabilities.input[2].displayName,this.localizationService);return Zt.divide("[".concat(e,"]"),function(r,e){return te.fF.assertValue(r,"expression"),te.fF.assertValue(e,"axis"),St("COLLAPSE",r,e)}("[".concat(t,"]"),"".concat(n)))},r}(),vi=function(){function r(e){this.localizationService=e,this.capabilities={name:"PercentOfGrandTotal",displayName:(0,He.V)("ShowValueAs_Calculation_PercentOfGrandTotal"),description:(0,He.V)("VisualCalcTemplate_PercentOfGrandTotal_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"NumeratorField",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"CollapseAllDenominatorField",column:{},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=(0,He.G)(this.capabilities.input[2].displayName,this.localizationService);return Zt.divide("[".concat(e,"]"),function(r,e){return te.fF.assertValue(r,"expression"),te.fF.assertValue(e,"axis"),St("COLLAPSEALL",r,e)}("[".concat(t,"]"),"".concat(n)))},r}(),yi=function(){function r(e){this.localizationService=e,this.capabilities={name:"AverageOfChildren",displayName:(0,He.V)("VisualCalcTemplate_AverageOfChildren_DisplayName"),description:(0,He.V)("VisualCalcTemplate_AverageOfChildren_Description"),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"Axis",displayName:(0,He.V)("VisualCalcTemplate_AxisField"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService);return function(r,e){return te.fF.assertValue(r,"expression"),te.fF.assertValue(e,"axis"),St("EXPAND",r,e)}(Zt.average("[".concat(e,"]")),"".concat(t))},r}(),Xt=function(){function r(e,t){void 0===t&&(t=3),this.localizationService=e,this.versusEnum=t;var n=r.versusToDax[this.versusEnum];this.capabilities={name:"Versus".concat(n),displayName:(0,He.V)("VisualCalcTemplate_Versus_".concat(n,"_DisplayName")),description:(0,He.V)("VisualCalcTemplate_Versus_".concat(n,"_Description")),category:"VisualCalculation",input:(0,Ft.z8)([{name:"Field",column:{type:{numeric:!0}},displayName:(0,He.V)("Field"),description:""},{name:"DaxFunctionField",column:{},displayName:(0,He.V)("Field"),description:""}]),helpLink:-1}}return r.prototype.getExpression=function(){var e=(0,He.G)(this.capabilities.input[0].displayName,this.localizationService),t=(0,He.G)(this.capabilities.input[1].displayName,this.localizationService),n=r.versusToDax[this.versusEnum];return"[".concat(e,"] - ").concat(St(n,"[".concat(t,"]")))},r.versusToDax=((Lt={})[3]="FIRST",Lt[2]="LAST",Lt[1]="NEXT",Lt[0]="PREVIOUS",Lt),r}(),jt=T(88409),Rn=T(63057),In=T(59787),wn=T(59973),Et=T(83317),Ci=T(17653),bi=T(81905),on=new i.InjectionToken("IntellisenseModelService"),an=new i.InjectionToken("FormulaBarBehaviorService"),An=new i.InjectionToken("FormulaBarZoomService"),Ei=T(48563),sn=T(74249),Ti=T(26112),Si=T(59694),Oi=new i.InjectionToken("IntellisenseProxyServiceOverrideToken"),Jt=function(){function r(){}return r.prototype.onClientViewLoaded=function(e){},r.prototype.onContentChanged=function(e,t,n,o,s){},r.prototype.onEditorFocus=function(){},r.prototype.endIntellisenseSession=function(){},r.prototype.startIntellisenseSession=function(e,t,n,o){},r.prototype.getCultureInfo=function(){return Promise.resolve(JSON.stringify({decimalSeparator:".",listSeparator:","}))},r}(),Mi={provide:Jt,useFactory:function(r){var e=r.get(Oi,null);return e?i.Injector.create([e],r).get(Jt):new Jt},deps:[i.Injector]},xi=[" ","\t"],un=function(){function r(e,t,n,o){this.localizationService=e,this.intellisenseHostService=t,this.intellisenseModelService=n,this.daxCapabilitiesService=o}return r.prototype.onClientViewLoaded=function(e){this.intellisenseHostService.onClientViewLoaded(e)},r.prototype.onContentChanged=function(e,t,n,o,s){this.intellisenseHostService.onContentChanged(e,t,n,o,s)},r.prototype.setUICulture=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.intellisenseHostService.getCultureInfo()];case 1:return e=n.sent(),t=(0,Ti.K)(e),(0,_e.g5)({listSeparator:t.listSeparator,numberDecimalSeparator:t.decimalSeparator}),[2]}})})},r.prototype.onEditorFocus=function(){this.intellisenseHostService.onEditorFocus()},r.prototype.endIntellisenseSession=function(){this.intellisenseModelService.reset(),this.intellisenseHostService.endIntellisenseSession()},r.prototype.startIntellisenseSession=function(e,t,n,o){this.intellisenseModelService.init({entityName:e,propertyName:t,schemaName:n,calculationEditMode:o}),this.intellisenseHostService.startIntellisenseSession(e,t,n,o)},r.prototype.getCalculationInfo=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){return(t=this.intellisenseModelService.findCalculationObject(e))&&null!=t.expression?[2,Promise.resolve({isNew:t.isNew,alertMessage:t.expressionErrorMessage?t.expressionErrorMessage:void 0,formulaText:this.getCalculationExpression(t)})]:(te.fF.assertFail((0,Si.W)("Cannot find editable Calculation: schema:{0} entity:{1} property:{2}",e?.schemaName,e?.entityName,e?.propertyName)),[2,Promise.resolve(void 0)])})})},r.prototype.getCalculationExpression=function(e){if(e.formulaOverride)return e.formulaOverride.formula;var t=_e.w_.convertToUI(e.expression);return e.calculationSyntaxType===Be.Expression?t:(0,_e.Mk)(e.name,t)},r.prototype.updateFormulaContextAsync=function(){return(0,C.mG)(this,void 0,void 0,function(){var e;return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,this.getDataSourceInfo()];case 1:return e=t.sent(),[4,this.updateDaxContext(e)];case 2:return t.sent(),[2]}})})},r.prototype.updateDaxContext=function(e){return(0,C.mG)(this,void 0,void 0,function(){var y;return(0,C.Jh)(this,function(P){switch(P.label){case 0:return[4,this.intellisenseModelService.getDaxModeConfigInputs(e)];case 1:return y=P.sent(),pt.configureModel(y.serializableModel,y.wireDataSourceInfo,y.daxCalculation,y.isRestrictedMode,y.axes),[2]}})})},r.prototype.getDataSourceInfo=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,n,s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return[4,Promise.all([this.daxCapabilitiesService.getReservedWords(),this.daxCapabilitiesService.getCapabilities()])];case 1:return s=c.sent(),e=s[0],n=(0,Ei.w)(s[1].Functions),[2,{reservedWords:e,functionDataFromEngine:n}]}})})},r.prototype.analyzeFinalFormulaCommitInfo=function(e,t,n){var o=this.intellisenseModelService.getCalculationObject(),s={name:void 0,expression:void 0,invalidFormula:void 0,anonymizedExpression:void 0,parseResult:void 0},c=function(r,e,t,n){if(!n)return e.name=void 0,e.expression=void 0,e.invalidFormula=void 0,e.anonymizedExpression=void 0,!1;!function(r,e,t,n){var o=!1,s={name:void 0,expression:void 0};if((o=n.calculationSyntaxType===Be.Expression)?s.expression=dn.uI.trimStart(r,xi):o=(0,_e.Mn)(r,s,n.calculationType===Te.VisualCalculation),!o)return e.name=n.name||"",e.name&&!r?e.expression="":(e.invalidFormula=r,e.expression=n.expression||""),null;if(e.name=s.name,e.expression=s.expression,s.expression)if(t){(c=pt.getContext())||te.fF.assertFail("Context should be defined");var y=new _e.w_,P=new _e.ss,w={finalResult:P};y.finalParse(s.expression,c,w,_e.MX.AddMissingParens|_e.MX.Anonymize|_e.MX.ConvertToEngine),e.expression=w.finalResult.updatedExpression,e.anonymizedExpression=w.finalResult.anonymizedExpression,e.parseResult=P}else{y=new _e.w_;var c=pt.getContext(),z={result:new _e.bp};y.parse(s.expression,0,void 0,void 0,c,z,void 0),e.expression=_e.w_.convertToEngine(s.expression),e.parseResult=z.result}}(r,e,t,n);var o,s=n.formulaOverride;return s&&(o=s.formula),n.name!==e.name||n.expression!==e.expression||o!==e.invalidFormula}(e,s,n,o);!c&&t&&o&&(c=!!o.expressionErrorMessage&&!!o.expressionOverride&&!o.formulaOverride);var w,j,z=new Map;if(c&&s.invalidFormula)switch(w={expression:null,formula:s.invalidFormula},o.calculationType){case Te.Column:j=this.localizationService.get("ReportModelInvalidColumnNameMessage");break;case Te.Table:j=this.localizationService.get("ReportModelInvalidCalculatedTableNameMessage");break;case Te.Measure:j=this.localizationService.get("ReportModelInvalidMeasureNameMessage");break;case Te.CalculationItem:j=this.localizationService.get("ReportModelInvalidCalcItemNameMessage");break;case Te.VisualCalculation:break;default:te.fF.assertFail("Unknown type "+o.calculationType)}return s.parseResult instanceof _e.bp&&s.parseResult.errors.length&&s.parseResult.errors.forEach(function(ae){return z.set(ae.errorCode,ae.message)}),{doCommit:c,newName:s.name,newExpression:s.expression,newInvalidFormula:s.invalidFormula,anonymizedExpression:s.anonymizedExpression,expressionOverride:w,errorMessage:j,parseErrorMessages:z}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(Jt),i.\u0275\u0275inject(on),i.\u0275\u0275inject(sn.r))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),Dn=T(83309),Nn=function(){function r(e,t,n,o){this.intellisenseService=e,this.screenReaderService=t,this.zone=n,this.behaviorService=o,this.suspendParseCount=0}return r.prototype.setUICulture=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.intellisenseService.setUICulture()];case 1:return e.sent(),[2]}})})},r.prototype.ngOnDestroy=function(){this.behaviorService.ngOnDestroy()},Object.defineProperty(r.prototype,"mode",{get:function(){return"dax"},enumerable:!1,configurable:!0}),r.prototype.registerFormulaBarControl=function(e){this.formulaBarControl=e,this.behaviorService.registerFormulaBarControl(e),this.intellisenseService.onClientViewLoaded(this)},r.prototype.onContentChanged=function(e,t,n,o){var s=this,c=this.intellisenseService.analyzeFinalFormulaCommitInfo(e,!1,!1);this.behaviorService.contentChanged||(this.behaviorService.contentChanged=c.doCommit),c.parseErrorMessages.size&&c.parseErrorMessages.forEach(function(y,P){s.screenReaderService.alertWithDebounce("dax-error"+P,y)}),this.intellisenseService.onContentChanged(e,t,n,0!==this.suspendParseCount,o.length>1),this.behaviorService.onContentChanged(c)},r.prototype.onEditorFocus=function(){this.intellisenseService.onEditorFocus()},r.prototype.hasUnsavedChanges=function(e){return this.behaviorService.hasUnsavedChanges(e)},r.prototype.onBlur=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,this.behaviorService.commitOrDeletePendingCalculation(e)];case 1:return[2,t.sent()]}})})},r.prototype.onSubmit=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return t=this.intellisenseService.analyzeFinalFormulaCommitInfo(e,!0,!0),[4,this.behaviorService.commitCalculationUpdate(t)];case 1:return n.sent(),[2]}})})},r.prototype.onCancel=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){return this.behaviorService.cancel(e),[2]})})},r.prototype.onTemplateSelection=function(e){return this.behaviorService.onTemplateSelection(e)},r.prototype.setCommittedFormulaBarText=function(e){this.formulaBarControl.setCommittedFormulaBarText(e)},r.prototype.hostServiceCalculationCommitedOrDeleted=function(){this.formulaBarControl.endFormulaEdit(),this.behaviorService.contentChanged=!1},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(un),i.\u0275\u0275inject(Dn.g),i.\u0275\u0275inject(i.NgZone),i.\u0275\u0275inject(an))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),(0,C.gn)([function(r,e,t){var n=t.value;t.value=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var c=this;this.zone.run(function(){return n.apply(c,o)})}},(0,C.w6)("design:type",Function),(0,C.w6)("design:paramtypes",[]),(0,C.w6)("design:returntype",void 0)],r.prototype,"hostServiceCalculationCommitedOrDeleted",null),r}(),Fn=T(46192),Di=T(65302),Ni=T(39681),Bn=T(73221),Ln=T(52570),Yt=T(61561),$t=T(30794),qt=T(23558),Fi=T(22318),jn=T(77526),Bi=T(6663),Li=function(){function r(e,t,n){this.uiBlockingService=e,this.localizationService=t,this.intellisenseService=n}return r.prototype.registerFormulaBarControl=function(e){this.formulaBarControl=e,e.setEditModeOptions([])},r.prototype.focusWhenNotBlocked=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return e.sent(),this.formulaBarControl.focus(),[2]}})})},r.prototype.updateReadOnlyState=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,this.uiBlockingService.waitTillUnblocked()];case 1:return t.sent(),this.formulaBarControl.setReadOnly(e),[2]}})})},r.prototype.updateContents=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return[4,this.intellisenseService.getDataSourceInfo()];case 1:return n=o.sent(),(_.isEmpty(n.functionDataFromEngine)||_.isEmpty(n.reservedWords))&&!t&&(t=this.localizationService.get("DaxEditor_ErrorMessageToGetIntellisense")),[4,this.updateFormulaText(e,n)];case 2:return o.sent(),this.updateAlertText(t),[2]}})})},r.prototype.updateFormulaText=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,this.intellisenseService.updateDaxContext(t)];case 1:return n.sent(),this.formulaBarControl.setCommittedFormulaBarText(e||null),this.contentChanged=!1,[2]}})})},r.prototype.updateAlertText=function(e){e?this.formulaBarControl.showAlertMessage(e):this.formulaBarControl.hideAlert()},r.\u0275fac=function(t){i.\u0275\u0275invalidFactory()},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),_n=T(95792),ji=T(26657),Bt=T(60661),_i=T(74082),Vi=T(63731),ki=new i.InjectionToken("UIBlockingService"),Ui=T(8590),Mt=T(73202),Gi=T(11494),Vn=T(28894),Hi={provide:an,useClass:function(r){function e(t,n,o,s,c,y,P,w){var j=r.call(this,t,o,n)||this;return j.eventBridge=s,j.lazyScopeProvider=c,j.visualCalcEagerService=y,j.daxCapabilitiesService=P,j.zone=w,j.submit$=new $t.xQ,j.cancel$=new $t.xQ,j.onContentChanged$=new wt.X(void 0),j.destroy$=new $t.xQ,j}return(0,C.ZT)(e,r),e.prototype.hasUnsavedChanges=function(t){return!1},e.prototype.commitOrDeletePendingCalculation=function(t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){return[2,!1]})})},e.prototype.commitCalculationUpdate=function(t){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(n){return this.submit$.next(t),[2]})})},e.prototype.cancel=function(t){this.cancel$.next()},e.prototype.onContentChanged=function(t){this.onContentChanged$.next(t)},e.prototype.onTemplateSelection=function(t){return(0,C.mG)(this,void 0,void 0,function(){var n,o;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return ji.gD(t)?(n=t.getExpression(),o=(0,He.G)(t.capabilities.displayName,this.localizationService),this.formulaBarControl.isEditorEnabled?[3,3]:[4,this.lazyScopeProvider.get(Yt.w)]):(te.fF.assertFail("Selected template is not a visual calculation template"),[2]);case 1:return[4,c.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Template",n,o)];case 2:return c.sent(),[2];case 3:return _.isEmpty(this.formulaBarControl.getCurrentEditorText())||this.formulaBarControl.getCurrentEditorText()===this.formulaBarControl.getHighlightedText()?this.formulaBarControl.insertTextAtCurrentCursor("".concat(o," = ").concat(n)):this.formulaBarControl.insertTextAtCurrentCursor(n),[2]}})})},e.prototype.setVisualContainer=function(t){this.visualContainer=t},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.registerFormulaBarControl=function(t){var n=this;this.formulaBarControl=t,this.formulaBarControl.setReadOnly(!1),this.eventBridge.on(Ui.jCS).pipe((0,Et.R)(this.destroy$),(0,wn.h)(function(o){return o.affectContainer(n.visualContainer)})).subscribe(function(){n.intellisenseService.updateFormulaContextAsync()}),this.submit$.pipe((0,Et.R)(this.destroy$)).subscribe(function(){n.visualCalcEagerService.enterViewMode("PressedSubmit")}),this.destroy$.pipe((0,qt.M)(this.onContentChanged$,this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var s=o[1],c=o[2];return(0,C.mG)(n,void 0,void 0,function(){return(0,C.Jh)(this,function(P){switch(P.label){case 0:switch(c.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(s,c)];case 2:return P.sent(),[4,this.tryRemoveUnchangedNewCalculation(s,c)];case 3:return P.sent(),[3,5];case 4:return[3,5];case 5:return[2]}})})}),this.cancel$.pipe((0,Et.R)(this.destroy$)).subscribe(function(){n.visualCalcEagerService.enterViewMode("PressedCancel")}),this.visualCalcEagerService.onContextChange$().pipe((0,Fi.O)({type:"Edit",calculationInfo:{isNew:!1}}),(0,jn.x)(function(o,s){return"Edit"===o.type&&"Edit"===s.type&&o.queryName===s.queryName}),(0,Et.R)(this.destroy$),(0,Bi.G)(),(0,qt.M)(this.onContentChanged$)).subscribe(function(o){var s=o[0],c=s[0],y=s[1],P=o[1];return(0,C.mG)(n,void 0,void 0,function(){var j,fe,Se;return(0,C.Jh)(this,function(De){switch(De.label){case 0:if("Edit"!==c.type)return[3,15];switch(y.type){case"Edit":return[3,1];case"View":return[3,4]}return[3,4];case 1:return[4,this.tryToCommitContents(P,c)];case 2:return De.sent(),[4,this.tryRemoveUnchangedNewCalculation(P,c)];case 3:return De.sent(),[3,15];case 4:switch(j=y.entryPoints){case"PressedCancel":return[3,5];case"PressedSubmit":return[3,9];case"DeletedCurrentCalc":return[3,12]}return[3,13];case 5:return c.calculationInfo.isNew?[4,this.lazyScopeProvider.get(Yt.w)]:[3,8];case 6:return[4,De.sent().removeVisualCalculation(this.visualContainer,c.queryName)];case 7:De.sent(),De.label=8;case 8:return[3,14];case 9:return[4,this.tryRemoveUnchangedNewCalculation(P,c)];case 10:return De.sent(),[4,this.tryToCommitContents(P,c)];case 11:return De.sent(),[3,14];case 12:return[3,14];case 13:return te.fF.assertNever(j),[3,14];case 14:return[3,15];case 15:switch(y.type){case"Edit":return[3,16];case"View":return[3,23]}return[3,23];case 16:return(fe=(0,Bt.Xf)(this.visualContainer))&&fe.defn.select().withName(y.queryName)?[4,this.intellisenseService.getCalculationInfo()]:(this.visualCalcEagerService.enterViewMode("DeletedCurrentCalc"),[3,24]);case 17:switch(Se=De.sent(),y.editingType){case"Template":return[3,18];case"Custom":return[3,20]}return[3,20];case 18:return[4,this.handleUpdateContents(!1,Se)];case 19:return De.sent(),[3,22];case 20:return[4,this.handleUpdateContents(Se.isNew,Se)];case 21:return De.sent(),[3,22];case 22:return[3,24];case 23:return this.resetFormulaBar(),[3,24];case 24:return[2]}})})}),this.visualCalcEagerService.onVisualCalcDeleted$().pipe((0,Et.R)(this.destroy$),(0,qt.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var c=o[1];"Edit"===c.type&&o[0]===c.queryName&&n.visualCalcEagerService.enterViewMode("DeletedCurrentCalc")}),this.visualCalcEagerService.onNativeNameReferenceChange$().pipe((0,Et.R)(this.destroy$),(0,qt.M)(this.visualCalcEagerService.onContextChange$())).subscribe(function(o){var s=o[0],c=s.oldName,y=s.queryName,P=o[1];return(0,C.mG)(n,void 0,void 0,function(){var w,j,z,ae,ce,fe,Se;return(0,C.Jh)(this,function(Le){switch(Le.label){case 0:return"Edit"!==P.type?[3,6]:(w=P.queryName,j=(0,Bt.Xf)(this.visualContainer),z=j?.defn.select().withName(w),z&&(0,_i.jX)(z.expr)?null==(ae=j.defn.select().withName(y))?[2]:(ce=this.formulaBarControl.getCurrentEditorText(),w!==y?[3,2]:[4,this.updateExpressionAfterFieldRenamed(ce)]):[3,6]);case 1:return Se=Le.sent(),[3,4];case 2:return[4,this.updateExpressionAfterReferencedFieldRenamed(ce,j,c,ae.nativeReferenceName)];case 3:Se=Le.sent(),Le.label=4;case 4:return(fe=Se)===ce?[3,6]:[4,this.updateContents(fe,void 0)];case 5:Le.sent(),this.formulaBarControl.resetModelTokens(fe),this.intellisenseService.updateFormulaContextAsync(),Le.label=6;case 6:return[2]}})})})},e.prototype.updateExpressionAfterFieldRenamed=function(t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c,y;return(0,C.Jh)(this,function(P){switch(P.label){case 0:return n=t,[4,this.intellisenseService.getCalculationInfo()];case 1:return null!=(o=P.sent())&&(s=(0,_n.O5)(o.formulaText,!0),c=(0,_n.O5)(t),y=c.formula||" ",c.name&&c.name===t&&(y=" ".concat(t)),n="".concat(s.name," =").concat(y)),[2,n]}})})},e.prototype.updateExpressionAfterReferencedFieldRenamed=function(t,n,o,s){return(0,C.mG)(this,void 0,void 0,function(){var c,y,P,w,j,z;return(0,C.Jh)(this,function(ae){switch(ae.label){case 0:return c=t,_.isEmpty(t)?[3,5]:null!=this.vcDaxParserService?[3,2]:(y=this,[4,this.lazyScopeProvider.get(Vi.M)]);case 1:y.vcDaxParserService=ae.sent(),ae.label=2;case 2:return[4,this.daxCapabilitiesService.getReservedWords()];case 3:return P=ae.sent(),[4,this.daxCapabilitiesService.getCapabilities()];case 4:w=ae.sent(),j=n.defn.getNativeReferenceNames(!0),j=_.map(j,function(ce){return ce===s?o:ce}),z=this.vcDaxParserService.getContext(j,P,w),c=this.vcDaxParserService.renameReference(z,t,o,s),ae.label=5;case 5:return[2,c]}})})},e.prototype.handleUpdateContents=function(t,n){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(o){switch(o.label){case 0:return this.formulaBarControl.clear(),[4,this.updateContents(n.formulaText,n.alertMessage)];case 1:return o.sent(),[4,this.focusWhenNotBlocked()];case 2:return o.sent(),t&&this.formulaBarControl.setSelection({startPosition:0,length:n.formulaText.length}),[2]}})})},e.prototype.resetFormulaBar=function(){this.formulaBarControl.clear(),this.formulaBarControl.resetModelTokens(""),this.formulaBarControl.setExpandCollapseState(1),this.formulaBarControl.endFormulaEdit()},e.prototype.tryToCommitContents=function(t,n){return(0,C.mG)(this,void 0,void 0,function(){var o,s,c;return(0,C.Jh)(this,function(P){switch(P.label){case 0:return t&&t.doCommit&&!_.isEmpty(t.newExpression)?(s=t.newExpression,c=this.getName(t.newName,o=n.queryName),[4,this.lazyScopeProvider.get(Yt.w)]):[3,3];case 1:return[4,P.sent().updateVisualCalculation(this.visualContainer,c,s,o,n.calculationInfo.isNew)];case 2:P.sent(),P.label=3;case 3:return[2]}})})},e.prototype.tryRemoveUnchangedNewCalculation=function(t,n){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return!n.calculationInfo.isNew||!t||t.doCommit&&_.isEmpty(t.newInvalidFormula)&&!_.isEmpty(t.newExpression)?[3,3]:[4,this.lazyScopeProvider.get(Yt.w)];case 1:return[4,s.sent().removeVisualCalculation(this.visualContainer,n.queryName)];case 2:s.sent(),s.label=3;case 3:return[2]}})})},e.prototype.getName=function(t,n){if(_.isEmpty(t)){var o=(0,Bt.Xf)(this.visualContainer);return Mt.Fo(o,n)}return t},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275inject(ki),i.\u0275\u0275inject(un),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(Gi.J),i.\u0275\u0275inject(Vn.H),i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(sn.r),i.\u0275\u0275inject(i.NgZone))},e.\u0275prov=i.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(Li)},zi=T(78384),Wi={provide:An,useClass:function(){function r(e){this.canvasZoomService=e}return r.prototype.getZoomLevel=function(){var e=this.canvasZoomService.getCurrentZoomLevel();return te.fF.assert(function(){return e>0},"ZoomLevel should greater than 0"),this.canvasZoomService.getCurrentZoomLevel()},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(zi.w))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}()},Qi=T(68405),Zi=T(13080),kn=T(49642),Xi=T(58295),Ht=function(r){return r[r.None=0]="None",r[r.Rows=1]="Rows",r[r.Columns=2]="Columns",r}({}),Ji=function(){function r(e){this.selects=e,this.containsRows=!1,this.containsColumns=!1,this.referencedItems=new Set}return r.prototype.withRestartToken=function(e){return this},r.prototype.withPrimaryWindowExpansion=function(e){return this},r.prototype.withDataVolume=function(e){return this},r.prototype.withIncludeEmptyGroups=function(e){return this},r.prototype.withHighlightFilter=function(e){return this},r.prototype.withGroupBy=function(e){return this},r.prototype.withPrimaryGrouping=function(e,t,n,o,s,c){return this.containsValidAxisGroup(e)&&(this.containsRows=!0),this},r.prototype.withPrimaryGroupingNestedByRole=function(e,t,n,o,s,c,y){return this.withPrimaryGrouping(e,t,n,o,s,c)},r.prototype.withPrimaryExpansion=function(e){return this},r.prototype.withPrimarySynchronization=function(e){return this},r.prototype.withPrimaryGroupingNested=function(e,t,n,o,s){return this.containsValidAxisGroup(e)&&(this.containsRows=!0),this},r.prototype.withSecondaryGrouping=function(e,t,n,o,s){return this.containsValidAxisGroup(e)&&(this.containsColumns=!0),this},r.prototype.withSecondaryGroupingNestedByRole=function(e,t,n,o,s,c){return this.withSecondaryGrouping(e,t,n,o,s)},r.prototype.withSecondaryExpansion=function(e){return this},r.prototype.withSecondaryGroupingNested=function(e,t,n,o,s){return this.containsValidAxisGroup(e)&&(this.containsColumns=!0),this},r.prototype.withCurrentInnermostGrouping=function(e,t,n){return this},r.prototype.withCurrentInnermostPrimaryGrouping=function(e,t,n,o){return this},r.prototype.withPrimaryDataReduction=function(e){return this},r.prototype.withScopedDataReduction=function(e,t){return this},r.prototype.withSecondaryDataReduction=function(e){return this},r.prototype.withIntersectionDataReduction=function(e){return this},r.prototype.withTopLevelAggregates=function(e){return this},r.prototype.withAdditionalProjections=function(e){return this},r.prototype.withRolesWithHierarchicalGroupingSupport=function(e){return this},r.prototype.toQueryShape=function(e){var t=Ht.None;return this.containsRows&&(t|=Ht.Rows),this.containsColumns&&(t|=Ht.Columns),t},r.prototype.containsValidAxisGroup=function(e){if(_.isEmpty(e))return!1;for(var t=0,n=e;t<n.length;t++){var o=n[t];if(this.referencedItems.has(o.queryName))return!0;var s=(0,Ft.rC)(this.selects,o.queryName);if(!(0,Xi.k)(s.expr))return this.referencedItems.add(o.queryName),!0}return!1},r}(),Un=T(453),$i=T(29866),qi=T(39665),eo=T(88099),to=T(13702),no=T(906),io={provide:on,useClass:function(){function r(e,t,n,o,s,c,y,P,w,j,z){this.visualCalcEagerService=e,this.featureSwitchService=t,this.localizationService=n,this.telemetryService=o,this.visualPluginService=s,this.conceptualSchemaProxy=c,this.dataSources=y,this.displayNameService=P,this.sortService=w,this.transformPluginService=j,this.dataReaders=z}return r.prototype.setVisualContainer=function(e){this.visualContainer=e},r.prototype.init=function(e){},r.prototype.reset=function(){},r.prototype.getCalculationObject=function(){return this.findCalculationObject()},r.prototype.findCalculationObject=function(e){var t=this.visualCalcEagerService.getCurrentEditingContext();if(null==t)return{name:"",expression:"",calculationType:Te.VisualCalculation,calculationSyntaxType:Be.Formula};var n=t.calculationInfo.isNew,o=(0,Bt.Xf)(this.visualContainer),s=Mt.zd(o,t);return{name:Mt.Fo(o,t.queryName),expression:s,calculationType:Te.VisualCalculation,calculationSyntaxType:Be.Formula,isNew:n}},r.prototype.getDaxModeConfigInputs=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,n,o,s;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return t=this.visualCalcEagerService.getCurrentEditingContext(),n=(0,Bt.Xf)(this.visualContainer),o=Mt.Oq(n,t?.queryName),[4,this.getVisualAxes()];case 1:return s=c.sent(),[2,{serializableModel:Mt.qN(o),wireDataSourceInfo:e,axes:s}]}})})},r.prototype.getVisualAxes=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,n,o,s,c,y,P,w,j,z,ae,ce,fe,Se,De;return(0,C.Jh)(this,function(Xe){switch(Xe.label){case 0:return t=(e=this.visualContainer.config.singleVisual).visualType,n={displayNameService:this.displayNameService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,sortService:this.sortService,telemetryService:this.telemetryService,transformPluginService:this.transformPluginService,visualPluginService:this.visualPluginService},o=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(o)];case 1:return s=Xe.sent(),c=(0,Qi.W5)(o,e.query&&e.query.defn),_.isEmpty(c)?[2,[]]:(y=this.dataReaders.queryGenerator(c),P=this.visualPluginService.capabilities(e.visualType).visualShapeDataViewMappings,!(w=(0,Un.p0)(e,t,s,y,n,void 0,P,void 0,_.noop))||w.error?[2,[]]:(j=w.compiled)?(z=(0,Un.Go)(j.mappings),ce=(0,kn.Jz)(ae=j.query.defn),fe=(0,Zi.lr)(z,ce),Se=ae.select(),De=(0,kn.cd)(function(){return new Ji(Se)},ce,fe.mapping,Se,j.additionalProjections),[2,this.convertVisualAxesTypesToStringArray(De)]):[2,[]])}})})},r.prototype.convertVisualAxesTypesToStringArray=function(e){var t=[];return e&Ht.Rows&&t.push("ROWS"),e&Ht.Columns&&t.push("COLUMNS"),t},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(D.vZ),i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(G.y0),i.\u0275\u0275inject($i.D),i.\u0275\u0275inject(Y.i),i.\u0275\u0275inject(k.D),i.\u0275\u0275inject(to.O),i.\u0275\u0275inject(no.K),i.\u0275\u0275inject(qi.y),i.\u0275\u0275inject(eo.A))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}()},oo=T(56083),Gn=function(){function r(e,t){this.localizationService=e,this.tutorialService=t}return r.prototype.showTutorial=function(){var e=this.createVisualCalcTutorial();this.tutorialService.startTutorial(e)},r.prototype.createVisualCalcTutorial=function(){var e,t="VisualCalcTemplateButton",n="VisualCalcEditInFormulaBar";return{itemKeys:[t,n],items:(e={},e[t]=this.createTemplateModelItem(t),e[n]=this.createFormulaBarModelItem(n),e),isSequentialTutorial:!0}},r.prototype.createTemplateModelItem=function(e){var t='[data-unique-id="formula-bar-template-button"]';return{title:this.localizationService.get("VisualCalcTeachingCallout_Template_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_Template_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:e,canShow:function(){return!!$(t)},attachTo:function(){return $(t)},preferredOrientation:"right",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},r.prototype.createFormulaBarModelItem=function(e){var t=".formulaBarEditorContainer";return{title:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Title"),text:this.localizationService.get("VisualCalcTeachingCallout_FormulaBar_Description"),buttonLabel:this.localizationService.get("Next_ButtonText"),dataStoreKey:e,canShow:function(){return!!$(t)},attachTo:function(){return $(t)},arrowOffset:{top:0,left:500},offset:{top:0,left:-500},preferredOrientation:"bottom",customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",overrideCancelWithClose:!0,closeOnBackdropClick:!0}},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(le.o),i.\u0275\u0275inject(oo.yU))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),ao=T(11934),so=T(19086),lo="padding-left",co="padding-right",fo="padding-top",ho="padding-bottom",po="margin-left",go="margin-right",mo="margin-top",vo="margin-bottom",yo="border-left-width",Co="border-right-width",bo="border-top-width",Eo="border-bottom-width";function Yn(r,e){return 1===e?parseInt(r.css(lo),10)+parseInt(r.css(co),10):parseInt(r.css(fo),10)+parseInt(r.css(ho),10)}function ln(r,e){return 1===e?parseInt(r.css(po),10)+parseInt(r.css(go),10):parseInt(r.css(mo),10)+parseInt(r.css(vo),10)}function Hn(r,e){return 1===e?parseInt(r.css(yo),10)+parseInt(r.css(Co),10):parseInt(r.css(bo),10)+parseInt(r.css(Eo),10)}function zn(r){return parseInt(r.css("minWidth"),10)}function Kn(r,e,t){for(var n=ln(r,t),o=$("html")[0],s=r.parent();s.length>0&&s[0]!==o&&s[0]!==e[0];)n=n+Yn(s,t)+Hn(s,t)+ln(s,t),s=s.parent();return s[0]===e[0]?n=n+Yn(s,t)+Hn(s,t):0}var et=T(26124),xo=T(55863),Ro=T(59017),wo=(new i.InjectionToken("FormulaBarInteraction"),T(37272)),Wn=function(){function r(){this.isValid=!1}return r.prototype.registerFormulaBarInteractionControl=function(e){this.formulaBarStorageControl=e,this.isValid=!0},r.prototype.focus=function(){this.isValid&&this.formulaBarStorageControl.focus()},r.prototype.copy=function(){this.isValid&&(this.formulaBarStorageControl.focus(),this.formulaBarStorageControl.copy())},r.prototype.cut=function(){this.isValid&&(this.formulaBarStorageControl.focus(),this.formulaBarStorageControl.cut())},r.prototype.paste=function(e){this.isValid&&this.formulaBarStorageControl.paste(e)},r.prototype.show=function(){this.isValid&&this.formulaBarStorageControl.show()},Object.defineProperty(r.prototype,"editMode$",{get:function(){return this.isValid?this.formulaBarStorageControl.editMode$:wo.E},enumerable:!1,configurable:!0}),r.prototype.setEditMode=function(e){this.isValid&&this.formulaBarStorageControl.setEditMode(e)},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(t){return new(t||r)},providedIn:"root"}),r}(),Ao=T(59968),Qn=T(36858),Do=T(45916),No=T(698),Fo=T(35756),Zn=T(20551),Bo=T(64716),Lo=T(85721),_t=T(41114),Xn="PBI.FormulaBar.EditFormulaBarObject",Jn=(_t.cx[Xn]=(0,_t.b1)(Xn),"PBI.FormulaBar.SubmitDynamicFormatString"),$n=(_t.cx[Jn]=(0,_t.b1)(Jn),"PBI.FormulaBar.SelectTemplate"),jo=_t.cx[$n]=(0,_t.b1)($n),qn=T(64560),_o=T(25512),Vo=T(5467);function ko(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",1),i.\u0275\u0275listener("click",function(o){i.\u0275\u0275restoreView(t);var s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.showTemplatesMenu(o))}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275element(2,"tri-svg-icon",2),i.\u0275\u0275elementEnd()}2&r&&i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(1,1,"Visual_Calculation_Template_Button_Tooltip"))}var Uo=function(r){function e(t,n,o,s){var c=r.call(this)||this;return c.elementRef=t,c.pbiMenuService=n,c.localizationService=o,c.telemetryService=s,c.selectedTemplate=new i.EventEmitter,c.showButton$=new wt.X(!1),c}return(0,C.ZT)(e,r),e.prototype.ngOnInit=function(){var t=this;this.changes$("daxTemplates").pipe((0,Et.R)(this.onDestroy$)).subscribe(function(n){t.createTemplateMenu(n)})},e.prototype.showTemplatesMenu=function(t){var n=this;t.preventDefault();var o=this.templatingMenu;null!=o&&0!==o.items.length&&this.pbiMenuService.open({menu:o,origin:this.elementRef.nativeElement,flexibleConnectedPositions:[(0,_o.Oq)(0,0)],closeOnButtonClick:!0,menuMode:qn.Kb.Compact}).onButtonClick$.pipe((0,se.q)(1)).subscribe(function(c){var y=c.data;n.selectedTemplate.emit(y),n.telemetryService.logEvent(jo,{templateName:y.capabilities.name})})},e.prototype.createTemplateMenu=function(t){var n=this,o=_.map(t,function(s){var c=s.capabilities;return{type:qn.iB.Button,id:c.name,text:(0,He.G)(c.displayName,n.localizationService),tooltip:(0,He.G)(c.description,n.localizationService),data:s}});this.templatingMenu={items:o},this.showButton$.next(o.length>0)},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(Vo.o),i.\u0275\u0275directiveInject(le.o),i.\u0275\u0275directiveInject(G.y0))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["template-button"]],inputs:{daxTemplates:"daxTemplates"},outputs:{selectedTemplate:"selectedTemplate"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","templateButton","tabindex","0",3,"pbiTooltip","click",4,"ngIf"],["tabindex","0",1,"templateButton",3,"pbiTooltip","click"],["tri-svg-icon-24","","name","math_formula_20_regular","sprite","visual-calc-icons"]],template:function(n,o){1&n&&(i.\u0275\u0275template(0,ko,3,3,"button",0),i.\u0275\u0275pipe(1,"async")),2&n&&i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(1,1,o.showButton$))},dependencies:[x.NgIf,Qn.V,nn.M,x.AsyncPipe,rn.F],styles:[".templateButton[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:24px;background-color:transparent}.templateButton[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2)}.templateButton[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground1Hover)}.templateButton[_ngcontent-%COMP%]:hover   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Hover)}.templateButton[_ngcontent-%COMP%]:active   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2Pressed)}"]}),e}(Bn.w),Go=["monacoEditorHostContainer"];function Yo(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"monaco-editor-host",21),i.\u0275\u0275listener("initialized",function(){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onMonacoEditorInitialized())})("tabFocusMode",function(c){i.\u0275\u0275restoreView(t);var y=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(y.onTabFocusModeChanged(c))})("onContentChanged",function(c){i.\u0275\u0275restoreView(t);var y=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(y.onContentChanged(c))})("onContentHeightChanged",function(c){i.\u0275\u0275restoreView(t);var y=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(y.onContentHeightChanged(c))})("onFocus",function(){i.\u0275\u0275restoreView(t);var c=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(c.onEditorFocus())}),i.\u0275\u0275elementEnd()}if(2&r){var n=e.ngIf,o=i.\u0275\u0275nextContext();i.\u0275\u0275property("selection",o.editorHost.selection)("isReadOnly",o.isReadOnly)("formulaText",o.editorHost.text)("languageOptions",n)("hidden",!o.isEditorEnabled)}}function Ho(r,e){if(1&r){var t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",22),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);var o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.toggleTabMovesFocus())}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275elementEnd()}2&r&&i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(1,1,"Tab_Moves_Focus_Toggle"))}function zo(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"div",23),i.\u0275\u0275element(1,"pbi-svg-use-symbol",24)(2,"tri-svg-icon",25)(3,"textarea",26),i.\u0275\u0275elementEnd()),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",t.alertText)("ngModel",t.alertText),i.\u0275\u0275attribute("aria-label",t.alertText)}}function Ko(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"tri-dropdown-trigger"),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"localize"),i.\u0275\u0275pipe(3,"async"),i.\u0275\u0275elementEnd()),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,1,i.\u0275\u0275pipeBind1(3,3,t.selectedEditModeOption$).displayName)," ")}}function Wo(r,e){if(1&r&&(i.\u0275\u0275elementStart(0,"tri-dropdown-item",27),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"localize"),i.\u0275\u0275elementEnd()),2&r){var t=e.$implicit;i.\u0275\u0275property("value",t),i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,2,t.displayName)," ")}}var er="monaco-editor-host",tr=".formulaBarButtons",nr=".formulaBarController",qo=[".formulaBarEditorContainer",tr,"ribbon [data-unique-id='clipboardGroupMlr'], ribbon [data-unique-id='clipboardGroupSlr'], .ms-Callout #FlyoutMenuId","ribbon [data-automation-type='RibbonTab'][data-unique-id='home']"],ea=function(){function r(e,t,n,o,s,c,y,P,w){var j=this;this.element=e,this.highContrastCssGenerationService=t,this.formulaBarService=n,this.localizationService=o,this.screenReaderService=s,this.formulaBarInteractionService=c,this.cdr=y,this.daxCapabilitiesService=P,this.formulaBarZoomService=w,this.catchOutsideClickEventCallBack=function(z){return!1},this.implicitEndEditingOnBlur=!0,this.navMode="Group",this.daxTemplates=[],this.beginEdit=new i.EventEmitter,this.endEdit=new i.EventEmitter,this.templateSelected=new i.EventEmitter,this.editorHost={},this.formulaBarDropdownConfigurations=[],this.destroy$=new $t.xQ,this._dropdownOptions$=new wt.X(void 0),this._dropdownVisible$=new wt.X(!1),this._selectedEditModeOption$=new wt.X(void 0),this.onDocumentMouseDownCapture=function(z){j.lastCapturedMousedownEvent=z,cn(z.target)||j.formulaBarService.hasUnsavedChanges(j.getCurrentEditorText())&&z.stopImmediatePropagation()},this.onDocumentClickCapture=function(z){var ae=j.lastCapturedMousedownEvent&&j.lastCapturedMousedownEvent.target;j.lastCapturedMousedownEvent=void 0;var ce=!ae||cn(ae),fe=cn(z.target);ce||fe||j.catchOutsideClickEventCallBack(z)||(j.formulaBarService.hasUnsavedChanges(j.getCurrentEditorText())&&(z.stopPropagation(),z.preventDefault()),j.onBlur())},this.triDropdownOptions={panelClass:"formulaBarDropdownPanel"},this.expandedState=1,this.languageOptions$=(0,Z.D)(this.daxCapabilitiesService.getCapabilities())}return Object.defineProperty(r.prototype,"selectedEditModeOption$",{get:function(){return this._selectedEditModeOption$},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"editMode$",{get:function(){return this._selectedEditModeOption$.pipe((0,jn.x)(),(0,he.U)(function(t){return t?.key}))},enumerable:!1,configurable:!0}),r.prototype.setEditMode=function(e){var t=this.formulaBarDropdownConfigurations.findIndex(function(n){return n.key===e});(0,xo.hu)(t>-1,"Invalid calculation edit mode"),this._selectedEditModeOption$.next(this.formulaBarDropdownConfigurations[t])},Object.defineProperty(r.prototype,"editModeOptions$",{get:function(){return this._dropdownOptions$.asObservable()},enumerable:!1,configurable:!0}),r.prototype.setEditModeOptions=function(e){this._dropdownOptions$.next(e),this._selectedEditModeOption$.next(void 0)},Object.defineProperty(r.prototype,"showEditModeSelector$",{get:function(){return this._dropdownVisible$.asObservable()},enumerable:!1,configurable:!0}),r.prototype.showEditModeSelector=function(e){this._dropdownVisible$.next(e)},r.prototype.ngOnInit=function(){return(0,C.mG)(this,void 0,void 0,function(){var e=this;return(0,C.Jh)(this,function(t){switch(t.label){case 0:return this.initializeHighContrastRules(),this.isHidden=this.autoHide,this.setReadOnly(!0),(0,Ro.aj)([this._dropdownOptions$,this._dropdownVisible$]).pipe((0,Et.R)(this.destroy$)).subscribe(function(n){var s=n[1];e.formulaBarDropdownConfigurations=n[0],e.formulaDropdownWidth=s?zn($(".dropdownContainer")):0,e.recalculateOffset(),e.onResize()}),[4,this.formulaBarService.setUICulture()];case 1:return t.sent(),[2]}})})},r.prototype.ngAfterViewInit=function(){var e=this;this.formulaBarService.registerFormulaBarControl(this),this.formulaBarInteractionService.registerFormulaBarInteractionControl(this),this.resizeObserver=new ResizeObserver(function(){window.requestAnimationFrame(function(){e.onResize()})}),this.resizeObserver.observe(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass))},r.prototype.ngOnDestroy=function(){$(this.element.nativeElement).off(nr),$(this.monacoEditorHostContainer.nativeElement).off(nr),this.destroy$.next(),this.destroy$.complete(),this.resizeObserver&&(this.resizeObserver.unobserve(this.element.nativeElement.closest(this.expandCollapseConfig.formulaBarParentClass)),this.resizeObserver.disconnect())},r.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarButtons","{ background-color: @buttonBackgroundColor !important; border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert, formula-bar .formulaBar .formulaBarAlert .messageAlert","{ background-color: @backgroundColor !important; color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarAlert","{ border: 1px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule("formula-bar .formulaBar .formulaBarEditorContainer","{ background-color: @backgroundColor !important; }")},Object.defineProperty(r.prototype,"willCollapse",{get:function(){return 0===this.nextExpandCollapseState},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isEditorEnabled",{get:function(){return!!this.lastCommittedFormulaText||this.isEditing},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"formulaBarExpanderTooltip",{get:function(){var t,n="Formula_Bar_ExpandToFull";switch(this.nextExpandCollapseState){case 0:n="Formula_Bar_CollapseToSingleLine";break;case 1:n="Formula_Bar_ExpandToFit";break;case 2:n=null!==(t=this.expandCollapseConfig.fullyExpandedTooltip)&&void 0!==t?t:"Formula_Bar_ExpandToFull"}return this.localizationService.get(n)},enumerable:!1,configurable:!0}),r.prototype.setReadOnly=function(e){this.isReadOnly=e},r.prototype.onMonacoEditorInitialized=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,n;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return this.monacoEditorInitialized=!0,e=$(this.element.nativeElement),t=function(r){return parseInt(r.css("min-height"),10)}(e),n=function(r){return parseInt(r.css("max-height"),10)}(e),this.monacoEditorUtility=new Cn(this.textEditorHost.textEditor),[4,this.textEditorHost.registerActions(this.getKeyboardActions())];case 1:return o.sent(),this.textEditorHeightOffset=this.calculateTextEditorHeightOffset(),this.recalculateOffset(),this.textEditorFullExpandHeight=n-this.textEditorHeightOffset,this.textEditorCollapsedHeight=t-this.textEditorHeightOffset,this.targetEditorHeight=this.textEditorCollapsedHeight,this.onContentHeightChanged(this.textEditorHost.textEditor.getContentHeight()),this.onResize(),this.focusOnInitialized&&this.focus(),[2]}})})},r.prototype.calculateTextEditorHeightOffset=function(){var e=$(this.element.nativeElement);return Kn(e.find(er),e,0)},r.prototype.onTabFocusModeChanged=function(e){this.tabMovesFocus=e},r.prototype.updateEditorExpandedHeight=function(){var e,t,n=this.alertText?20:0,o=this.expandCollapseConfig.formulaBarParentClass,s=null!==(e=this.expandCollapseConfig.expandScaleFactor)&&void 0!==e?e:1,c=null!==(t=this.expandCollapseConfig.expandOffet)&&void 0!==t?t:-80,y=s*$(this.element.nativeElement).closest(o).height()+c;this.textEditorFullExpandHeight=y-this.textEditorHeightOffset-n},r.prototype.updateFormulaBarMaxHeight=function(){var e=this.alertText?20:0,t=1e7;0===this.expandedState?t=this.textEditorCollapsedHeight+this.textEditorHeightOffset+e:1===this.expandedState&&(t=this.targetEditorHeight+this.textEditorHeightOffset+e),te.fF.assertValue(t,"maxHeight"),$(this.element.nativeElement).css("max-height",t)},r.prototype.show=function(){this.isHidden&&(this.isHidden=!1,this.cdr.detectChanges())},r.prototype.hide=function(){this.isHidden||(this.isHidden=!0)},r.prototype.clear=function(){this.setCommittedFormulaBarText(""),this.autoHide&&this.hide()},r.prototype.setSelection=function(e){this.editorHost.selection=e,this.cdr.detectChanges()},r.prototype.showAlertMessage=function(e){e=e.replace(/\n/g,""),this.alertText=e,this.screenReaderService.alert(this.localizationService.format("Formula_Bar_Warning_Aria",e)),this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},r.prototype.toggleTabMovesFocus=function(){this.textEditorHost.toggleTabMovesFocus(),this.textEditorHost.focus()},r.prototype.hideAlert=function(){this.alertText=void 0,this.updateFormulaBarMaxHeight(),this.cdr.detectChanges()},r.prototype.setCommittedFormulaBarText=function(e){this.lastCommittedFormulaText=e,this.editorHost.text=e,this.cdr.detectChanges()},r.prototype.focus=function(){this.monacoEditorInitialized?(this.textEditorHost.focus(),this.cdr.detectChanges()):this.focusOnInitialized=!0},r.prototype.scrollTop=function(){this.monacoEditorInitialized&&this.textEditorHost.scrollTop()},r.prototype.copy=function(){this.textEditorHost.copy()},r.prototype.cut=function(){this.textEditorHost.cut()},r.prototype.paste=function(e){this.textEditorHost.paste(e)},r.prototype.resetModelTokens=function(e){this.textEditorHost.resetModelTokens(e)},r.prototype.isFormulaBarActive=function(){return this.isActive},r.prototype.onToggleExpandCollapse=function(){this.setExpandCollapseState(this.nextExpandCollapseState)},r.prototype.setExpandCollapseState=function(e){switch(e){case 0:this.collapse();break;case 1:this.fitToContent();break;case 2:this.fullExpand()}this.calculateNextExpandCollapseState()},r.prototype.calculateNextExpandCollapseState=function(){switch(this.expandedState){case 0:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?2:1;break;case 1:this.nextExpandCollapseState=this.editorContentHeight>=this.textEditorFullExpandHeight?0:this.editorContentHeight<=this.textEditorCollapsedHeight||this.isEditing?2:0;break;case 2:this.nextExpandCollapseState=this.editorContentHeight<=this.textEditorCollapsedHeight?1:0;break;default:te.fF.assertNever(this.expandedState)}},r.prototype.fullExpand=function(){this.expandedState=2,this.updateEditorExpandedHeight(),this.layout(void 0,this.textEditorFullExpandHeight)},r.prototype.fitToContent=function(){this.expandedState=1,this.updateEditorExpandedHeight(),this.targetEditorHeight=Math.max(this.textEditorCollapsedHeight,Math.min(this.textEditorFullExpandHeight,this.editorContentHeight)),this.layout(void 0,this.targetEditorHeight)},r.prototype.collapse=function(){this.expandedState=0,this.layout(void 0,this.textEditorCollapsedHeight)},r.prototype.layout=function(e,t){this.updateFormulaBarMaxHeight(),this.monacoEditorInitialized&&this.textEditorHost.layout(e,t)},r.prototype.recalculateOffset=function(){var e,t=$(tr),n=$(this.element.nativeElement),o=n.find(er);this.textEditorWidthOffset=Kn(o,n,1)+zn(t)+ln(t,1)+(null!==(e=this.formulaDropdownWidth)&&void 0!==e?e:0)},r.prototype.commitFormulaBarEdit=function(){return(0,C.mG)(this,void 0,void 0,function(){var e;return(0,C.Jh)(this,function(t){switch(t.label){case 0:return this.endFormulaEdit(),(e=this.getCurrentEditorText())===this.lastCommittedFormulaText?[3,2]:(this.lastCommittedFormulaText=e,[4,this.formulaBarService.onSubmit(e)]);case 1:return t.sent(),[3,4];case 2:return[4,this.formulaBarService.onSubmit(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},r.prototype.onBlur=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return this.implicitEndEditingOnBlur?this.endFormulaEdit():(this.removeFocus(),this.removeCatchClickOutsideFormulaBar()),this.lastCommittedFormulaText=this.monacoEditorInitialized?this.getCurrentEditorText():"",[4,this.formulaBarService.onBlur(this.lastCommittedFormulaText)];case 1:return[2,e.sent()]}})})},r.prototype.removeFocus=function(){$(document.activeElement).blur(),$(document.body).focus()},r.prototype.onContentChanged=function(e){var t=this.monacoEditorUtility.getCursorPosition();this.formulaBarService.onContentChanged(this.monacoEditorUtility.getEditorText(),t.position,t.selectionStart,e)},r.prototype.onContentHeightChanged=function(e){this.editorContentHeight=e+2,(1===this.expandedState||0===this.expandedState&&this.isEditing)&&this.fitToContent(),this.calculateNextExpandCollapseState()},r.prototype.submit=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.commitFormulaBarEdit()];case 1:return e.sent(),[2]}})})},r.prototype.cancel=function(){this.endFormulaEdit(),this.formulaBarService.onCancel(this.lastCommittedFormulaText),this.autoHide&&this.hide()},r.prototype.onEditorFocus=function(){this.isEditorEnabled&&(this.isReadOnly||this.isEditing?this.implicitEndEditingOnBlur||this.catchClickOutsideFormulaBar():this.beginFormulaEdit(),this.formulaBarService.onEditorFocus())},r.prototype.catchClickOutsideFormulaBar=function(){document.body.addEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.addEventListener("click",this.onDocumentClickCapture,!0),document.body.addEventListener("contextmenu",this.onDocumentClickCapture,!0)},r.prototype.removeCatchClickOutsideFormulaBar=function(){document.body.removeEventListener("mousedown",this.onDocumentMouseDownCapture,!0),document.body.removeEventListener("click",this.onDocumentClickCapture,!0),document.body.removeEventListener("contextmenu",this.onDocumentClickCapture,!0)},r.prototype.endFormulaEdit=function(){this.isEditing=!1,this.removeFocus(),this.removeCatchClickOutsideFormulaBar(),this.endEdit.emit()},r.prototype.beginFormulaEdit=function(){this.isEditing=!0,this.catchClickOutsideFormulaBar(),this.beginEdit.emit()},r.prototype.onResize=function(){var e,t;if(this.monacoEditorInitialized){var n;2===this.expandedState?(this.updateEditorExpandedHeight(),n=this.textEditorFullExpandHeight):1===this.expandedState&&(this.updateEditorExpandedHeight(),n=Math.min(this.textEditorFullExpandHeight,this.targetEditorHeight));var o=this.element.nativeElement.getBoundingClientRect().width||1e3,s=null!==(t=null===(e=this.formulaBarZoomService)||void 0===e?void 0:e.getZoomLevel())&&void 0!==t?t:1;this.layout(o/s-this.textEditorWidthOffset,n)}},r.prototype.selectTemplate=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){switch(t.label){case 0:return[4,this.formulaBarService.onTemplateSelection(e)];case 1:return t.sent(),this.templateSelected.emit(),[2]}})})},r.prototype.insertTextAtCurrentCursor=function(e){this.textEditorHost.insertTextAtCurrentCursor(e)},r.prototype.getCurrentEditorText=function(){return this.textEditorHost.getText()},r.prototype.getHighlightedText=function(){return this.textEditorHost.getHighlightedText()},r.prototype.getKeyboardActions=function(){var e=this;return[{id:"formulaBar.find",label:"Find",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlF]],run:_.noop},{id:"formulaBar.findNext",label:"Find next",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.F3]],run:_.noop},{id:"formulaBar.findPrevious",label:"Find previous",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlF3]],run:_.noop},{id:"formulaBar.replace",label:"Replace",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlH]],run:_.noop},{id:"formulaBar.errorNavigator",label:"Error navigator",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.F8]],run:_.noop},{id:"formulaBar.escape",label:"Escape",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.Escape]],run:function(){var n=e.textEditorHost.textEditor.getSelections();n.length<=1?e.cancel():e.textEditorHost.textEditor.setSelection(n[0])},keybindingContext:"!".concat(vn,"&&!").concat(yn,"&&!").concat("parameterHintsVisible")},{id:"formulaBar.submit",label:"Submit",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlEnter]],run:function(){e.submit()}},{id:"formulaBar.enter",label:"Enter",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.Enter]],run:function(){e.submit()},keybindingContext:"!".concat(yn)},{id:"formulaBar.toggleExpandCollapse",label:"Toggle expand collapse",keybindings:[this.textEditorHost.monacoKeybindingsMap[Qe.CtrlJ]],run:function(){e.onToggleExpandCollapse()}}]},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(bn.g),i.\u0275\u0275directiveInject(Nn),i.\u0275\u0275directiveInject(le.o),i.\u0275\u0275directiveInject(Dn.g),i.\u0275\u0275directiveInject(Wn),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(sn.r),i.\u0275\u0275directiveInject(An,8))},r.\u0275cmp=i.\u0275\u0275defineComponent({type:r,selectors:[["formula-bar"]],viewQuery:function(t,n){if(1&t&&(i.\u0275\u0275viewQuery(Go,7,i.ElementRef),i.\u0275\u0275viewQuery(Qt,5)),2&t){var o=void 0;i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.monacoEditorHostContainer=o.first),i.\u0275\u0275queryRefresh(o=i.\u0275\u0275loadQuery())&&(n.textEditorHost=o.first)}},hostVars:1,hostBindings:function(t,n){1&t&&i.\u0275\u0275listener("desktopUIResizeFormulaBar",function(){return n.onResize()}),2&t&&i.\u0275\u0275hostProperty("hidden",n.isHidden)},inputs:{autoHide:"autoHide",isActive:"isActive",catchOutsideClickEventCallBack:"catchOutsideClickEventCallBack",expandCollapseConfig:"expandCollapseConfig",implicitEndEditingOnBlur:"implicitEndEditingOnBlur",navMode:"navMode",shouldAlwaysEnableCancelButton:"shouldAlwaysEnableCancelButton",daxTemplates:"daxTemplates"},outputs:{beginEdit:"beginEdit",endEdit:"endEdit",templateSelected:"templateSelected"},decls:29,vars:42,consts:[["keyboard-shortcuts","ctrl-F6","focus-priority","11",1,"formulaBar",3,"hidden","on-resize"],[1,"formulaBarEditorContainer"],[1,"formulaBarEditor"],["tabindex","0",1,"formulaBarEditorMain",3,"keydown.enter"],["monacoEditorHostContainer",""],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus",4,"ngIf"],["data-unique-id","formula-bar-chevron",1,"formulaBarExpander",3,"disabled","pbiTooltip","click"],["tri-svg-icon-16","","name","chevron_down_16_regular"],[1,"accessibililtyMessages"],["class","message","localize","Tab_Moves_Focus",3,"pbiTooltip","click",4,"ngIf"],["class","formulaBarAlert",4,"ngIf"],[1,"formulaBarDropdown"],[1,"dropdownContainer",3,"compact","options","isDisabled","value","valueChange"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"formulaBarButtons"],["data-unique-id","formula-bar-cancel",1,"formulaBarCancel",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","dismiss_20_regular"],["data-unique-id","formula-bar-commit",1,"formulaBarCommit",3,"pbiTooltip","disabled","click"],["tri-svg-icon-24","","name","checkmark_20_regular"],["data-unique-id","formula-bar-template-button",3,"daxTemplates","selectedTemplate"],["mode","dax","theme","dax",3,"selection","isReadOnly","formulaText","languageOptions","hidden","initialized","tabFocusMode","onContentChanged","onContentHeightChanged","onFocus"],["localize","Tab_Moves_Focus",1,"message",3,"pbiTooltip","click"],[1,"formulaBarAlert"],["symbolId","alert","sheet","filterPaneIcons",1,"imageAlert"],["tri-svg-icon-16","","name","dismiss_circle_16_filled"],["data-unique-id","formula-bar-alert","row","1","cols","1","readonly","","pbiTooltipPosition","below",1,"messageAlert",3,"pbiTooltip","ngModel"],[3,"value"]],template:function(t,n){1&t&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275listener("on-resize",function(){return n.onResize()}),i.\u0275\u0275pipe(1,"localize"),i.\u0275\u0275elementStart(2,"div",1)(3,"div",2)(4,"div",3,4),i.\u0275\u0275listener("keydown.enter",function(){return n.focus()}),i.\u0275\u0275template(6,Yo,1,5,"monaco-editor-host",5),i.\u0275\u0275pipe(7,"async"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(8,"button",6),i.\u0275\u0275listener("click",function(){return n.onToggleExpandCollapse()}),i.\u0275\u0275element(9,"tri-svg-icon",7),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(10,"div",8),i.\u0275\u0275template(11,Ho,2,3,"button",9),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(12,zo,4,3,"div",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(13,"div",11),i.\u0275\u0275pipe(14,"async"),i.\u0275\u0275elementStart(15,"tri-dropdown",12),i.\u0275\u0275listener("valueChange",function(s){return n.setEditMode(s.key)}),i.\u0275\u0275pipe(16,"async"),i.\u0275\u0275template(17,Ko,4,5,"tri-dropdown-trigger",13),i.\u0275\u0275pipe(18,"async"),i.\u0275\u0275template(19,Wo,3,4,"tri-dropdown-item",14),i.\u0275\u0275pipe(20,"async"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(21,"div",15)(22,"button",16),i.\u0275\u0275listener("click",function(){return n.cancel()}),i.\u0275\u0275pipe(23,"localize"),i.\u0275\u0275element(24,"tri-svg-icon",17),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(25,"button",18),i.\u0275\u0275listener("click",function(){return n.submit()}),i.\u0275\u0275pipe(26,"localize"),i.\u0275\u0275element(27,"tri-svg-icon",19),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(28,"template-button",20),i.\u0275\u0275listener("selectedTemplate",function(s){return n.selectTemplate(s)}),i.\u0275\u0275elementEnd()()()),2&t&&(i.\u0275\u0275classProp("readonly",n.isReadOnly),i.\u0275\u0275property("hidden",n.isHidden||!n.monacoEditorInitialized),i.\u0275\u0275attribute("focus-nav-mode",n.navMode)("aria-label",i.\u0275\u0275pipeBind1(1,26,"Formula_Bar")),i.\u0275\u0275advance(2),i.\u0275\u0275classProp("hasAlert",n.alertText),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(7,28,n.languageOptions$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("disabled",!n.monacoEditorInitialized||!n.isEditorEnabled)("pbiTooltip",n.formulaBarExpanderTooltip),i.\u0275\u0275advance(1),i.\u0275\u0275property("@chevron",n.nextExpandCollapseState),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.tabMovesFocus&&!n.isReadOnly&&n.isEditorEnabled),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!!n.alertText),i.\u0275\u0275advance(1),i.\u0275\u0275classProp("hideFormulaBarDropdown",!i.\u0275\u0275pipeBind1(14,30,n.showEditModeSelector$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("compact",!0)("options",n.triDropdownOptions)("isDisabled",n.isReadOnly)("value",i.\u0275\u0275pipeBind1(16,32,n.selectedEditModeOption$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind1(18,34,n.selectedEditModeOption$)),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",i.\u0275\u0275pipeBind1(20,36,n.editModeOptions$)),i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(23,38,"Cancel_ButtonText"))("disabled",n.shouldAlwaysEnableCancelButton?!n.monacoEditorInitialized:!n.isEditing||!n.monacoEditorInitialized),i.\u0275\u0275advance(3),i.\u0275\u0275property("pbiTooltip",i.\u0275\u0275pipeBind1(26,40,"Commit_ButtonText"))("disabled",!n.isEditing||!n.monacoEditorInitialized),i.\u0275\u0275advance(3),i.\u0275\u0275property("daxTemplates",n.daxTemplates))},dependencies:[x.NgForOf,x.NgIf,I.Fj,I.JJ,I.On,Ao.X,Qt,Qn.V,Do.R,No.O,Fo.q,Zn.M3,Bo.l,Lo.q,Zn.ii,nn.M,Uo,x.AsyncPipe,rn.F],styles:['[_nghost-%COMP%]{--read-only-button-foreground: var(--fluent-theme-neutral-secondary-alt-color);--read-only-background: var(--fluent-theme-neutral-tertiary-color);--read-only-border-color: var(--fluent-theme-neutral-tertiary-color);--button-background: transparent;--button-foreground: var(--gray-180);--editor-container-border-color: var(--fluent-theme-neutral-tertia-color);--editor-container-background: var(--fluent-theme-white-color);--expander-foreground-hover: var(--fluent-theme-black-color);--accessibility-message-background: var(--fluent-theme-neutral-primary-color);--accessibility-message-foreground: var(--fluent-theme-white-color);--accessibility-message-background-focus: var(--fluent-theme-neutral-tertiary-alt-color);--alert-foreground: var(--fluent-theme-black-color);--alert-background: var(--fluent-theme-warning-background-color);--alert-border: none;--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--fluent-theme-neutral-tertiary-alt-color);--submit-cancel-buttons-background: var(--fluent-theme-white-color);--cancel-button-foreground: var(--fluent-theme-error-dark-color);--commit-button-foreground: var(--fluent-theme-success-icon-color);--gray-host-background: var(--gray-20);--gray-border-color: var(--gray-60);--gray-read-only-background: var(--gray-20);--gray-read-only-border: var(--gray-40);position:relative;padding:4px;min-height:36px;max-height:36px;width:100%;box-sizing:border-box;display:flex;flex-direction:column}[data-legacy-theming=false]   [_nghost-%COMP%]{--read-only-button-foreground: var(--colorNeutralForegroundDisabled);--read-only-background: var(--colorNeutralBackgroundDisabled);--read-only-border-color: var(--colorNeutralStrokeDisabled);--button-background: transparent;--button-foreground: var(--colorNeutralForeground1);--editor-container-border-color: var(--colorNeutralStroke1);--editor-container-background: var(--colorNeutralBackground1);--expander-foreground-hover: var(--colorNeutralStrokeFocus2);--accessibility-message-background: var(--colorCompoundBrandBackground);--accessibility-message-foreground: var(--colorNeutralForegroundOnBrand);--accessibility-message-background-focus: var(--colorCompoundBrandBackgroundHover);--alert-foreground: var(--colorNeutralForeground1);--alert-background: var(--colorDangerBackground1);--alert-border: 1px solid var(--colorDangerBorder1);--alert-icon: var(--fluent-theme-error-fill-color);--submit-cancel-buttons-border: var(--colorNeutralStroke1);--submit-cancel-buttons-background: var(--colorNeutralBackground1);--cancel-button-foreground: var(--colorDangerForeground1);--commit-button-foreground: var(--colorSuccessForeground1);--gray-host-background: var(--colorNeutralBackground3);--gray-border-color: var(--colorNeutralStroke2);--gray-read-only-background: var(--colorNeutralBackground3);--gray-read-only-border: var(--colorNeutralStrokeDisabled)}[hidden][_nghost-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]{flex-grow:1;cursor:default;box-sizing:border-box;display:flex}[_nghost-%COMP%]   .formulaBar[hidden][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--read-only-button-foreground)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-color:var(--read-only-border-color);background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .monaco-editor[_ngcontent-%COMP%]   .cursor[_ngcontent-%COMP%]{background-color:var(--read-only-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:var(--button-background);color:var(--button-foreground)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:currentcolor}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [disabled][_ngcontent-%COMP%]{opacity:.4}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{order:1;flex-grow:1;height:100%;display:flex;flex-direction:column;margin-left:3px;min-height:28px;box-sizing:border-box;border:1px solid var(--editor-container-border-color);background-color:var(--editor-container-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer.hasAlert[_ngcontent-%COMP%]{min-height:48px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;padding-top:2px;padding-right:21px;display:flex;flex-direction:column;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]{flex-grow:1;box-sizing:border-box;background-color:transparent;-webkit-user-select:none}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarEditorMain[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:16px;height:16px;background-color:transparent}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus:not(:disabled){color:var(--expander-foreground-hover)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarEditor[_ngcontent-%COMP%]   .formulaBarExpander[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarEditorContainer .formulaBarEditor .formulaBarExpander *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-left:2px;padding:2px;background-color:var(--accessibility-message-background);color:var(--accessibility-message-foreground);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .accessibililtyMessages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:focus{background-color:var(--accessibility-message-background-focus)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]{width:100%;height:20px;box-sizing:border-box;color:var(--alert-foreground);background-color:var(--alert-background);outline:var(--alert-border);display:flex;padding-left:2px;align-items:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--alert-icon)}[data-legacy-theming=true]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{width:16px;height:16px}[data-legacy-theming=false]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .imageAlert[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]   .formulaBarAlert[_ngcontent-%COMP%]   .messageAlert[_ngcontent-%COMP%]{cursor:default;flex-grow:1;height:100%;box-sizing:border-box;border:none;padding-top:2px;padding-left:4px;background-color:var(--alert-background);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:11px;resize:none;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]{margin-right:3px;font-size:14px}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown.hideFormulaBarDropdown[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]{min-width:100px;height:28px;box-sizing:border-box}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarDropdown[_ngcontent-%COMP%]   .dropdownContainer[_ngcontent-%COMP%]     button{min-width:inherit;height:inherit}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]{min-width:76px;flex:0;height:28px;box-sizing:border-box;border:1px solid var(--submit-cancel-buttons-border);display:flex;align-items:center;justify-content:space-evenly;background-color:var(--submit-cancel-buttons-background)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-content:center;justify-content:center}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForegroundDisabled)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled), [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:disabled){background:var(--colorNeutralBackground1Hover)}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--cancel-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCancel[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCancel *:focus{outline:none}[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{fill:var(--commit-button-foreground)}html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=key]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=key] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]:focus, html[data-focus-source=program]   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%]   .formulaBarCommit[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] -shadowcsshost .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=mouse] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit:focus,   html[data-focus-source=program] -shadowcsshost-no-combinator .formulaBar .formulaBarButtons .formulaBarCommit *:focus{outline:none}.gray-theme   [_nghost-%COMP%]{background-color:var(--gray-host-background)}.gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{border-radius:2px;border-color:var(--gray-border-color)}.gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarButtons[_ngcontent-%COMP%], .gray-theme[_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%], .gray-theme   [_nghost-%COMP%]   .formulaBar.readonly[_ngcontent-%COMP%]   .formulaBarEditorContainer[_ngcontent-%COMP%]{background-color:var(--gray-read-only-background);border-color:var(--gray-read-only-border)}@media print{formula-bar[_ngcontent-%COMP%]   .formulaBar[_ngcontent-%COMP%]{display:none}}'],data:{animation:[(0,et.X$)("chevron",[(0,et.SB)("".concat(0),(0,et.oB)({transform:"rotate(180deg)"})),(0,et.SB)("".concat(2),(0,et.oB)({transform:"rotate(0deg)"})),(0,et.SB)("".concat(1),(0,et.oB)({transform:"rotate(0deg)"})),(0,et.eR)("".concat(1," => ").concat(2,", ").concat(2," => ").concat(1),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(0deg)",offset:0}),(0,et.oB)({transform:"rotate(45deg)",offset:.5}),(0,et.oB)({transform:"rotate(0deg)",offset:1})]))]),(0,et.eR)("* => ".concat(0),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(0deg)",offset:0}),(0,et.oB)({transform:"rotate(180deg)",offset:1})]))]),(0,et.eR)("".concat(0," => *"),[(0,et.jt)(150,(0,et.F4)([(0,et.oB)({transform:"rotate(180deg)",offset:0}),(0,et.oB)({transform:"rotate(0deg)",offset:1})]))])])]}}),r}();function cn(r){return _.some(qo,function(e){var t=$(r),n=$(e);return n.is(t)||!!n.find(t).length})}var ta=["formulaBar"],na=["detailVisual"];function ra(r,e){if(1&r&&i.\u0275\u0275element(0,"outline-overlay-lazy",8),2&r){var t=i.\u0275\u0275nextContext();i.\u0275\u0275property("regionOutlinesData",t.regionOutlinesData)}}var ia=function(){return{formulaBarParentClass:".visualCalcEditor",expandScaleFactor:.5,expandOffet:0,fullyExpandedTooltip:"Formula_Bar_ExpandToMultiLine"}},oa=function(r){function e(t,n,o,s,c,y,P,w,j){var z=r.call(this)||this;return z.behaviourService=t,z.intellisenseModelService=n,z.featureSwitchService=o,z.visualCalcEagerService=s,z.visualCalcDaxTemplateService=c,z.lazyScopeProvider=y,z.visualCalcTutorialService=P,z.subSelectionOutlineManager=w,z.visualContainerSubSelectionHostServiceFactory=j,z.visualHTMLElementChanged=new i.EventEmitter,z.templateSelected=z.createEventAdapter(),z.visualCalculationTemplates=z.visualCalcDaxTemplateService.getTemplates(),z.enableSubSelection=z.featureSwitchService.featureSwitches.enableCalculationHighlighting,z.enableSubSelection&&(z.subSelectionHostService=z.visualContainerSubSelectionHostServiceFactory.create(),z.regionOutlinesData={regionOutlines$:z.subSelectionOutlineManager.getRegionOutlines$()}),z}return(0,C.ZT)(e,r),Object.defineProperty(e.prototype,"_detailVisualElementRef",{set:function(n){var o=n?.nativeElement,s=o!==this.detailVisualElement;this.detailVisualElement=o,s&&this.visualHTMLElementChanged.emit(o)},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this,n=(0,Rn.T)((0,In.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"click"),(0,In.R)(this.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"),"keydown").pipe((0,wn.h)(function(s){return"Enter"===s.key}))),o=(0,Rn.T)(this.visualCalcEagerService.onEditContextChange$(),this.templateSelected.$).pipe((0,Et.R)(this.onDestroy$));this.visualCalcEagerService.onViewContextChanged$().pipe((0,Et.R)(this.onDestroy$),(0,Ci.b)(function(){return Di.IK.focus(t.formulaBar.nativeElement.querySelector(".formulaBarEditorMain"))}),(0,bi.w)(function(){return n.pipe((0,Et.R)(o),(0,se.q)(1))})).subscribe(function(){return(0,C.mG)(t,void 0,void 0,function(){return(0,C.Jh)(this,function(c){switch(c.label){case 0:return[4,this.lazyScopeProvider.get(Yt.w)];case 1:return[4,c.sent().enterVisualCalcEditingModeWithPlaceHolder(this.visualContainer,"Custom")];case 2:return c.sent(),[2]}})})}),this.visualCalcTutorialService.showTutorial()},e.prototype.ngOnInit=function(){var t=this;this.behaviourService.setVisualContainer(this.visualContainer),this.intellisenseModelService.setVisualContainer(this.visualContainer),this.hostServices=this.parentHostServices,this.enableSubSelection&&(this.hostServices=(0,Ni.ED)(this.parentHostServices,function(n){n.getSubSelectionService=function(){return t.getVisualSubSelectionHostService()}}),this.subSelectionOutlineManager.registerVisualContainer(this.visualContainer.name,this.subSelectionHostService.regionOutlines$,"annotation"))},e.prototype.ngOnDestroy=function(){return this.enableSubSelection&&this.subSelectionOutlineManager.deregisterVisualContainer(this.visualContainer.name,"annotation"),r.prototype.ngOnDestroy.call(this)},e.prototype.onRightClick=function(t){t.stopPropagation()},e.prototype.getVisualSubSelectionHostService=function(){var t=this;return{clearAllRegionOutlines:function(){return t.subSelectionHostService.clearAllRegionOutlines()},getAllRegionOutlines:function(){return t.subSelectionHostService.getAllRegionOutlines()},getRegionOutline:function(o){return t.subSelectionHostService.getRegionOutline(o)},updateRegionOutlines:function(o){var s,c,y=null===(s=t.detailVisualComponent)||void 0===s?void 0:s.getVisualComponentBoundingClientRect();y&&t.subSelectionHostService.updateVisualRegionOutlines(o,null===(c=t.detailVisualElement)||void 0===c?void 0:c.getBoundingClientRect(),y,!1)}}},e.\u0275fac=function(n){return new(n||e)(i.\u0275\u0275directiveInject(an),i.\u0275\u0275directiveInject(on),i.\u0275\u0275directiveInject(D.vZ),i.\u0275\u0275directiveInject(jt.w),i.\u0275\u0275directiveInject(xn),i.\u0275\u0275directiveInject(Vn.H),i.\u0275\u0275directiveInject(Gn),i.\u0275\u0275directiveInject(Ln.g),i.\u0275\u0275directiveInject(ao._))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["visual-calc-editor"]],viewQuery:function(n,o){if(1&n&&(i.\u0275\u0275viewQuery(ta,5,i.ElementRef),i.\u0275\u0275viewQuery(na,5,i.ElementRef),i.\u0275\u0275viewQuery(Fn.X,5)),2&n){var s=void 0;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(o.formulaBar=s.first),i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(o._detailVisualElementRef=s.first),i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(o.detailVisualComponent=s.first)}},inputs:{visualContainer:"visualContainer",themeCollection:"themeCollection",viewport:"viewport",parentHostServices:"parentHostServices",detailVisualSpinnerActionCallback:"detailVisualSpinnerActionCallback"},outputs:{visualHTMLElementChanged:"visualHTMLElementChanged"},features:[i.\u0275\u0275ProvidersFeature([Nn,Hi,Wi,Mi,io,un,Gn,Ln.g]),i.\u0275\u0275InheritDefinitionFeature],decls:8,vars:16,consts:[["data-automation-type","visualCalcEditor","role","document",1,"visualCalcEditor",3,"contextmenu"],["visualCalcEditor",""],[3,"isActive","autoHide","expandCollapseConfig","implicitEndEditingOnBlur","navMode","shouldAlwaysEnableCancelButton","daxTemplates","templateSelected"],["formulaBar",""],[1,"visualWithOutlinesOverlay"],["data-automation-type","detailVisual",3,"inVisualCalcMode","parentHostServices","visualContainer","themeCollection","viewport","detailVisualSpinnerActionCallback","applyUIThemeToVisualModern"],["detailVisual",""],["class","outlinesOverlayContainer",3,"regionOutlinesData",4,"ngIf"],[1,"outlinesOverlayContainer",3,"regionOutlinesData"]],template:function(n,o){1&n&&(i.\u0275\u0275elementStart(0,"div",0,1),i.\u0275\u0275listener("contextmenu",function(c){return o.onRightClick(c)}),i.\u0275\u0275elementStart(2,"formula-bar",2,3),i.\u0275\u0275listener("templateSelected",function(){return o.templateSelected.fn()}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",4),i.\u0275\u0275element(5,"detail-visual",5,6),i.\u0275\u0275template(7,ra,1,1,"outline-overlay-lazy",7),i.\u0275\u0275elementEnd()()),2&n&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("isActive",!0)("autoHide",!1)("expandCollapseConfig",i.\u0275\u0275pureFunction0(15,ia))("implicitEndEditingOnBlur",!1)("navMode",void 0)("shouldAlwaysEnableCancelButton",!1)("daxTemplates",o.visualCalculationTemplates),i.\u0275\u0275advance(3),i.\u0275\u0275property("inVisualCalcMode",!0)("parentHostServices",o.hostServices)("visualContainer",o.visualContainer)("themeCollection",o.themeCollection)("viewport",o.viewport)("detailVisualSpinnerActionCallback",o.detailVisualSpinnerActionCallback)("applyUIThemeToVisualModern",!0),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",o.enableSubSelection))},dependencies:[x.NgIf,Fn.X,so.P,ea],styles:[".visualCalcEditor[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:visible;flex-grow:1;box-sizing:border-box;border-width:10px 10px 0 10px;border-style:solid;border-color:var(--colorNeutralStroke1);background-color:var(--colorNeutralBackground1)}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]{position:relative;flex-basis:0;flex-grow:1;overflow:hidden;display:flex}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   detail-visual[_ngcontent-%COMP%]{flex:1;height:100%;z-index:0}.visualCalcEditor[_ngcontent-%COMP%]   .visualWithOutlinesOverlay[_ngcontent-%COMP%]   .outlinesOverlayContainer[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;box-sizing:border-box;z-index:1;pointer-events:none;background:transparent}"]}),e}(Bn.w),aa=T(94419),ir=T(46135),ua=function(){function r(e,t,n,o,s,c,y,P,w,j,z){this.conceptualSchemaProxy=e,this.dataSources=t,this.vcEagerService=n,this.visualAuthoring=o,this.visibilityService=s,this.panesVisibilityService=c,this.featureSwitchService=y,this.visualAuthoringOperationService=P,this.certifiedEventsService=w,this.telemetryService=j,this.explorationCapabilitiesService=z}return r.prototype.enterVisualCalcMode=function(e,t,n,o){return(0,C.mG)(this,void 0,void 0,function(){var s;return(0,C.Jh)(this,function(y){switch(y.label){case 0:return 16!==e.visibility&&(e.config.singleVisual.autoSelectVisualType=!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=y.sent(),[4,this.visualAuthoring.ensureNativeReferenceName(s,e)];case 2:return y.sent(),this.panesVisibilityService.closePane("quickMeasures"),this.featureSwitchService.featureSwitches.onObject&&this.panesVisibilityService.setPaneExpansion("build",!0,!0),_.isEmpty(t)?[4,this.enterVisualCalcEditingModeWithPlaceHolder(e,"Custom",void 0,void 0,n,o)]:[3,4];case 3:return y.sent(),[3,5];case 4:this.vcEagerService.enterEditMode(t,"Custom",!1),y.label=5;case 5:return this.visibilityService.set(e,16),[2]}})})},r.prototype.updateVisualCalculation=function(e,t,n,o,s){return(0,C.mG)(this,void 0,void 0,function(){var c,y,w,j;return(0,C.Jh)(this,function(z){switch(z.label){case 0:return j=(0,Mt.dQ)(e,o),c=j.fieldIndex,y=j.role,te.fF.assert(function(){return c>=0},"Query name of field doesn't exist"),[4,this.visualAuthoring.updateVisualCalculation({visualContainer:e,fieldIndex:c,role:y,name:t,expression:n,shouldUnhide:s,dataType:void 0},s)];case 1:return w=z.sent(),this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:"VisualCalculationSubmitted",activityName:jt.f,activityStatus:"Succeeded",resultCode:"",activityAttributes:{initialCreation:s}}),[2,w]}})})},r.prototype.removeVisualCalculation=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var n,o,s,c;return(0,C.Jh)(this,function(y){switch(y.label){case 0:return c=(0,Mt.dQ)(e,t),n=c.fieldIndex,o=c.role,te.fF.assert(function(){return n>=0},"Query name of field doesn't exist"),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=y.sent(),[2,this.visualAuthoringOperationService.removeFieldFromRole({role:o,projOptions:{fieldIndex:n}},s,e)]}})})},r.prototype.enterVisualCalcEditingModeWithPlaceHolder=function(e,t,n,o,s,c){return(0,C.mG)(this,void 0,void 0,function(){var y,P,w,j,z,ae;return(0,C.Jh)(this,function(ce){switch(ce.label){case 0:return y=(0,Bt.Xf)(e),P=(0,Mt.ND)(y,o),w=this.dataSources.get(),j=(0,aa.YU)(P,"BLANK()"),z=!1,null==s?[3,2]:[4,this.visualAuthoring.addFieldInRole(j,s,w,e,void 0,void 0,void 0,!0,!0,c)];case 1:return z=ce.sent(),[3,4];case 2:return[4,this.visualAuthoring.addFieldToVisual(j,w,e,"VisualCalculationMode",!0,!0,c)];case 3:z=ce.sent(),ce.label=4;case 4:return z&&(ae=(0,Mt.oG)((0,Bt.Xf)(e),P),this.vcEagerService.enterEditMode(ae,t,!0,n)),[2,z]}})})},r.prototype.getVisualCalcCreationInfo=function(e,t,n){var o,s;return(0,C.mG)(this,void 0,void 0,function(){var c,w;return(0,C.Jh)(this,function(z){switch(z.label){case 0:return c=this.explorationCapabilitiesService.getCapabilities(),c?.disableVisualCalcAuthoring?[2,{supportVisualCalcCreation:!1}]:[4,this.vcEagerService.canSupportVisualCalc(e)];case 1:return z.sent()?(null===(s=null===(o=e?.config)||void 0===o?void 0:o.singleVisual)||void 0===s?void 0:s.autoSelectVisualType)?[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:!(w=_.find(t.dataRoles,function(ae){return ae.name===n}))||w.kind!==ir.DW.Measure&&w.kind!==ir.DW.GroupingOrMeasure?[2,{supportVisualCalcCreation:!1}]:[2,{supportVisualCalcCreation:!0,tooltip:"NewVisualCalc"}]:[2,{supportVisualCalcCreation:!1}]}})})},r.\u0275fac=function(t){return new(t||r)(i.\u0275\u0275inject(Y.i),i.\u0275\u0275inject(k.D),i.\u0275\u0275inject(jt.w),i.\u0275\u0275inject(Mn.$8),i.\u0275\u0275inject(Pn.w),i.\u0275\u0275inject(R.r),i.\u0275\u0275inject(D.vZ),i.\u0275\u0275inject(H.Q),i.\u0275\u0275inject(G.ly),i.\u0275\u0275inject(G.y0),i.\u0275\u0275inject(U.U))},r.\u0275prov=i.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),la=[{type:oa,componentId:"VisualCalcEditorComponentId"}],or={provide:"VisualCalcService",useFactory:ar,deps:[Y.i,k.D,jt.w,Mn.$8,Pn.w,R.r,D.vZ,H.Q,G.ly,G.y0,ui.t,U.U]};function ar(r,e,t,n,o,s,c,y,P,w,j,z){var ae=new ua(r,e,t,n,o,s,c,y,P,w,z);return j.resolve(ae)}var ca=function(){function r(){}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=i.\u0275\u0275defineInjector({providers:[or,xn],imports:[x.CommonModule,X.J,I.u5,re.j,En.N.withManifests(la),Q.v,On.U,si]}),r}()},33565:function(Ke,Ie,T){T.d(Ie,{c:function(){return te}});var W,x=T(81337),I=T(68082),G=T(53439),Y=T(50423),k=new Y.InjectionToken("ViewScopedUserSettingsService"),H="hideDeleteRelationshipConfirmation",X=function(pe){return pe.DeleteModelItem="DeleteModelItem",pe}({}),D=T(74611),re=T(50550),q=T(62458),Q=T(65843),i=T(55375);!function(pe){var le="COMMANDS_DELETE_TABLE",Oe="ListJoin_Separator";function Re(u,v){return(u=u.sort().map(function(A){return'"'+A+'"'})).join(v.get(Oe))}pe.getDeleteConfirmationText=function(u,v){var A=(0,re.EB)(u.map(function(Ne){return(0,D.cO)(Ne)?(0,D.d3)(Ne.fromTable.name,Ne.fromColumn.name,Ne.fromCardinality,Ne.toTable.name,Ne.toColumn.name,Ne.toCardinality):Ne.name})).join(v.get(Oe)+" "),Z=v.format("DeleteConfirmationMultiple",A);1===u.length&&(Z="Relationship"===u[0].objectType?v.get("DeleteRelationshipConfirmationMessage"):"Calendar"===u[0].objectType?v.get("DeleteCalendarConfirmationMessage"):v.format("DeleteMeasurePrompt",A));var he=function(u,v){for(var A=(0,D.Y3)((0,D.L9)(u),v),Z=0,he=u;Z<he.length;Z++){var ue=he[Z];if((0,D.t3)(ue)&&ue.table.refreshPolicy&&"DateTime"===ue.dataType){A.push(v.get("IncrementalRefreshPolicy"));break}}return A.filter(function(we){return!u.find(function(Ne){return Ne.name===we})})}(u,v);if(0!==he.length){var ue=(0,re.EB)(he).join(v.get(Oe)+" ");Z=v.format(1===he.length?"DeleteConfirmationWithDependents":"DeleteConfirmationMultipleWithDependents",A,ue)}var Ee=function(u){for(var v=new Set,A=0,Z=u;A<Z.length;A++){var he=Z[A];if((0,D.t3)(he)){var ue=he,Ee=ue.table.description,ge=(0,D.aP)(ue.table,ue),we=(0,D.q1)(ue.table,ue);(0,D.oQ)(ue.table,Ee,ge?.name,we?.name)&&v.add(ue.table.name)}}return Array.from(v)}(u);if(0!==Ee.length){var ge=(0,re.EB)(Ee).join(v.get(Oe)+" ");Z=Z+"<br/><br/>"+v.format("DeleteConfirmationForCuration",ge)}return Z},pe.showConfirmDialogToDeleteTableWithDependents=function(u,v,A,Z){return(0,x.mG)(this,void 0,void 0,function(){var he;return(0,x.Jh)(this,function(ge){switch(ge.label){case 0:return he=function(u,v,A){for(var Z=new Set,he=0,ue=u;he<ue.length;he++)Z.add(ue[he].name);for(var ge=[],we=[],Ne=0,Ae=Object.keys(v);Ne<Ae.length;Ne++)for(var Ve=Ae[Ne],ke=!1,Ze=0,ct=v[Ve];Ze<ct.length;Ze++){var rt=ct[Ze];Z.has(rt)||(ke||(ge.push(Ve),ke=!0),we.push(rt))}if(0!==ge.length){q.fF.assert(function(){return we.length>0},"If some tables are remaining, there should have dependents remaining as well");var tt=Re(we,A);if(1===ge.length)return 1===we.length?A.format("DeleteQueryWithOneDependent",ge[0],we[0]):A.format("DeleteQueryWithMultipleDependents",ge[0],tt);var nt=Re(ge,A);return A.format("DeleteQueriesWithMultipleDependents",nt,tt)}}(u,v,A),he?[4,i.Z.buildOKCancelDialogWithList(A.get(le),[he],"deleteTableConfirmationDialog",A.get("ReportModelTableLoadWillBeDisabled"),Z,A)]:[2,!0];case 1:return[4,ge.sent().afterClosed().toPromise()];case 2:return[2,1===ge.sent()]}})})},pe.getQueryToDependents=function(u,v){for(var A={},Z={},he=u.dataModelExtendedState.queryDependencyGraph,ue=0,Ee=Object.keys(he);ue<Ee.length;ue++)for(var ge=Ee[ue],Ne=0,Ae=he[ge];Ne<Ae.length;Ne++){var Ve=Ae[Ne];Z[Ve]||(Z[Ve]=new Set),Z[Ve].add(ge)}for(var Ge=0,ke=v;Ge<ke.length;Ge++){var Ze=ke[Ge];Z[Ze.name]&&(A[Ze.name]=Array.from(Z[Ze.name]))}return A},pe.reorderItemsToMinimizeDependencies=function(u,v,A,Z){for(var he=function(u,v){for(var A=[],Z=u.length,he=function(){var Ee=u.length,ge=new Set;u.forEach(function(we){v[we.name]&&v[we.name].forEach(function(Ne){return ge.add(Ne)})}),A=A.concat(u.filter(function(we){return!ge.has(we.name)})),u=u.filter(function(we){return ge.has(we.name)}),Ee===u.length&&q.fF.assertFail("Unable to calculate table dependencies")};u.length>0;)he();return Z!==(A=A.reverse()).length&&q.fF.assertFail("ordered table number is not same as the origin number for deletion"),A}(v,A),ue=u.filter(function(Ne){return!(0,D.wb)(Ne)}),Ee=[],ge=function(){var Ae=new Set((0,D.Y3)((0,D.L9)(ue),Z)),Ve=ue.filter(function(Ge){return!Ae.has(Ge.name)});Ee=Ve.concat(Ee),ue=ue.filter(function(Ge){return Ae.has(Ge.name)})};ue.length>0;)ge();var we=Ee.concat(he);return u.length!==we.length&&q.fF.assertFail("ordered all item number is not same as the origin number for deletion"),we},pe.createDeleteSchemaChange=function(u){var v=u.objectType;if("Relationship"===v){var A=u;return{relationshipDelete:{fromColumns:[Q.X6.getColumnUrn(A.fromTable.name,A.fromColumn.name,A.fromColumn.schemaName)],toColumns:[Q.X6.getColumnUrn(A.toTable.name,A.toColumn.name,A.toColumn.schemaName)]}}}if("Level"===v)return{hierarchyLevelDelete:{schema:u.schemaName,entity:u.hierarchy.table.name,hierarchy:u.hierarchy.name,hierarchyLevel:u.name}};if("Table"===v||"Expression"===v)return{itemDelete:{schema:u.schemaName,entity:u.name,objectType:u.objectType}};var he=void 0;return"Column"===v||"Measure"===v||"Hierarchy"===v?he=u:"CalculationItem"===v?he=u.calculationGroup:"Calendar"===v?he=u:q.fF.assertFail("This object type is not implemented "+v.toString()+"when create schemaChange"),{itemDelete:{schema:u.schemaName,entity:he.table.name,objectType:u.objectType,property:u.name}}},pe.getDeleteComfirmationTitle=function(u,v){if(1!==u.length)return v.get("ReportModelDeleteItemsTitle");switch(u[0].objectType){case"Table":return v.get(le);case"Column":return v.get("DeleteColumnConfirmationTitle");case"Measure":return v.get("DeleteMeasurePromptTitle");case"Hierarchy":return v.get("DeleteHierarchyConfirmationTitle");case"Level":return v.get("DeleteHierarchyLevelConfirmationTitle");case"Relationship":return v.get("DeleteRelationshipConfirmationTitle");case"Calendar":return v.format("DeleteCalendarConfirmationTitle",u[0].name);default:q.fF.assertFail("Unexpected type being deleted")}},pe.getDeleteConfirmationOkButtonText=function(u,v){if(1!==u.length)return v.get("Yes");switch(u[0].objectType){case"Table":case"Column":case"Measure":case"Hierarchy":case"Level":case"Relationship":return v.get("Yes");case"Calendar":return v.get("Delete");default:q.fF.assertFail("Unexpected type being deleted")}}}(W||(W={}));var C=T(70863),oe=T(58938),ve=T(65181),B=T(66339),te=function(){function pe(le,ye,Pe,Me,xe,Fe){this.modelAuthoring=le,this.dataModelService=ye,this.dialogService=Pe,this.localizationService=Me,this.telemetryService=xe,this.viewScopedUserSettingsService=Fe}return pe.prototype.deleteAllFromModel=function(le,ye,Pe){if(void 0===Pe&&(Pe=!1),le.every(function(xe){return!0===xe.canDelete})){var Me=this.createDeleteItems(le,ye);return this.deleteModelItem(Me,Pe)}},pe.prototype.createDeleteItems=function(le,ye){var Pe=[];if(!le)return Pe;var Me=[],xe=[],Fe=[],me=[];le.forEach(function(ie){(0,C.wb)(ie)?Me.push(ie):(0,C.y3)(ie)?xe.push(ie):(0,C.ez)(ie)?Fe.push(ie):me.push(ie)});var Oe=[];return Fe.forEach(function(ie){if(xe.every(function(g){return g.urn!==ie.hierarchy.urn})&&Me.every(function(g){return g.urn!==ie.hierarchy.table.urn})){var M=Oe.find(function(g){return g.hierarchy===ie.hierarchy});M||Oe.push(M={hierarchy:ie.hierarchy,levelsToDelete:[]}),M.levelsToDelete.push(ie)}}),Oe.forEach(function(ie){ye&&ie.levelsToDelete.length===ie.hierarchy.levels.length?xe.push(ie.hierarchy):me.push.apply(me,ie.levelsToDelete||[])}),me.forEach(function(ie){(0,C.Mx)(ie)?Pe.push({itemName:ie.name,schema:null,objectType:"Relationship"}):(0,C.ez)(ie)?Pe.push({schema:ie.schemaName,tableName:ie.hierarchy.table.name,itemName:ie.hierarchy.name,subItemName:ie.name,objectType:"Level"}):(0,C.kb)(ie)||(0,C.jz)(ie)?Me.every(function(M){return M.urn!==ie.table.urn})&&Pe.push({schema:ie.schemaName,tableName:ie.table.name,itemName:ie.name,objectType:"Measure"}):(0,C.t3)(ie)?Me.every(function(M){return M.urn!==ie.table.urn})&&Pe.push({schema:ie.schemaName,tableName:ie.table.name,itemName:ie.name,objectType:"Column"}):(0,C.RF)(ie)?Me.every(function(M){return M.urn!==ie.calculationGroup.table.urn})&&Pe.push({schema:ie.schemaName,tableName:ie.calculationGroup.table.name,itemName:ie.name,objectType:"CalculationItem"}):(0,C.CV)(ie)&&Me.every(function(M){return M.urn!==ie.table.urn})&&Pe.push({schema:ie.schemaName,tableName:ie.table.name,itemName:ie.name,objectType:"Calendar"})}),xe.forEach(function(ie){Me.every(function(M){return M.urn!==ie.table.urn})&&Pe.push({schema:ie.schemaName,tableName:ie.table.name,itemName:ie.name,objectType:"Hierarchy"})}),Me.forEach(function(ie){Pe.push({schema:ie.schemaName,tableName:ie.name,itemName:null,objectType:"Table"})}),Pe},pe.prototype.deleteModelItem=function(le,ye){return(0,x.mG)(this,void 0,void 0,function(){var Pe,Me,xe,Fe,me,Oe,M,g,f,m;return(0,x.Jh)(this,function(d){switch(d.label){case 0:if(_.isEmpty(le))return[2];for(Pe=this.dataModelService.getClientDataModel(),Me=[],xe=0,Fe=le;xe<Fe.length;xe++){if(!(Oe=(0,D.Mf)(Pe.dataModel,(me=Fe[xe]).objectType,me.schema,me.tableName,me.itemName,me.subItemName))||!Oe.capabilities.canDelete)return[2];Me.push(Oe)}return ye||this.hasUserOptedOutOfConfirmation(Me)?[3,2]:[4,this.confirmDeleteObjects(Pe.dataModel,Me,le)];case 1:if(!d.sent())return[2];d.label=2;case 2:return M=Me.filter(function(E){return(0,D.wb)(E)}),g=W.getQueryToDependents(Pe,M),[4,W.showConfirmDialogToDeleteTableWithDependents(M,g,this.localizationService,this.dialogService)];case 3:return d.sent()?(f=W.reorderItemsToMinimizeDependencies(Me,M,g,this.localizationService),m=f.map(function(E){return W.createDeleteSchemaChange(E)}),m?.length>0?(this.telemetryService.logApplyChanges([X.DeleteModelItem]),[4,this.modelAuthoring.apply({changes:m})]):[3,5]):[2];case 4:d.sent(),d.label=5;case 5:return[2]}})})},pe.prototype.hasUserOptedOutOfConfirmation=function(le){return!(!this.viewScopedUserSettingsService||!this.everyItemIsRelationship(le)||!this.viewScopedUserSettingsService.get(H))},pe.prototype.confirmDeleteObjects=function(le,ye,Pe){return(0,x.mG)(this,void 0,void 0,function(){var Me,xe,me;return(0,x.Jh)(this,function(Oe){switch(Oe.label){case 0:if(0===ye.length)return[2,!1];if(1===ye.length){if("CalculationItem"===ye[0].objectType)return[2,!0];if((Me=(0,D.Lc)(le,Pe[0].schema,Pe[0].tableName,Pe[0].itemName))&&(0,D.e_)(Me))return[2,!0]}return xe=this.shouldIncludeDontAskAgainCheckbox(ye)?this.localizationService.get("Generic_DontShowThisAgain"):void 0,[4,i.Z.buildOKCancelDialog({title:W.getDeleteComfirmationTitle(ye,this.localizationService),message:W.getDeleteConfirmationText(ye,this.localizationService),doNotShowAgain:xe},"deleteConfirmationDialog",this.dialogService,this.localizationService,W.getDeleteConfirmationOkButtonText(ye,this.localizationService))];case 1:return[4,Oe.sent().afterClosed().toPromise()];case 2:return 5===(me=Oe.sent())?(this.handleDontAskAgainCheckbox(ye),[2,!1]):2===me||3===me?[2,!1]:4===me?(this.handleDontAskAgainCheckbox(ye),[2,!0]):[2,1===me]}})})},pe.prototype.shouldIncludeDontAskAgainCheckbox=function(le){return!!this.viewScopedUserSettingsService&&!!this.everyItemIsRelationship(le)},pe.prototype.handleDontAskAgainCheckbox=function(le){this.viewScopedUserSettingsService&&this.everyItemIsRelationship(le)&&this.viewScopedUserSettingsService.set(H,!0)},pe.prototype.everyItemIsRelationship=function(le){return le.every(function(ye){return"Relationship"===ye.objectType})},pe.\u0275fac=function(ye){return new(ye||pe)(Y.\u0275\u0275inject(G.S),Y.\u0275\u0275inject(I.n),Y.\u0275\u0275inject(oe.x),Y.\u0275\u0275inject(ve.o),Y.\u0275\u0275inject(B.L),Y.\u0275\u0275inject(k,8))},pe.\u0275prov=Y.\u0275\u0275defineInjectable({token:pe,factory:pe.\u0275fac}),pe}()},34145:function(Ke,Ie,T){T.d(Ie,{q:function(){return I}});var I=new(T(50423).InjectionToken)("ModelService")},49346:function(Ke,Ie,T){T.d(Ie,{TM:function(){return re},Yk:function(){return k},Yt:function(){return U},g4:function(){return X}});var x=T(41114),I="ClientSystemErrorBase",Y=(x.cx[I]=(0,x.b1)(I),"PBIModelingCommonApplyChange"),k=x.cx[Y]=(0,x.b1)(Y),R="PBIModelingCommonDataModelUpdated",U=x.cx[R]=(0,x.b1)(R),H="PBIExecuteDataQueryCacheEventName",X=x.cx[H]=(0,x.b1)(H),D="PBISortByColumnDataQueryValidationEventName",re=x.cx[D]=(0,x.b1)(D)},66339:function(Ke,Ie,T){T.d(Ie,{L:function(){return U}});var x=T(34145),I=T(49346),G=T(68082),Y=T(98665),k=T(34763),R=T(50423),U=function(){function H(X,D,re){var Q,i,q=this;this.dataModelService=X,this.modelService=D,this.telemetryService=re,this.subscriptions=new k.w,this.telemetryService&&this.modelService&&this.dataModelService&&(this.subscriptions.add(null===(Q=this.dataModelService.modelChanged$)||void 0===Q?void 0:Q.subscribe(function(){q.logModelUpdated()})),this.subscriptions.add(null===(i=this.dataModelService.modelLoaded$)||void 0===i?void 0:i.subscribe(function(){q.logModelUpdated()})))}return H.prototype.initialize=function(){},H.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},H.prototype.logModelUpdated=function(){var X,D,re=this.dataModelService.getDataModel();this.telemetryService.root&&this.telemetryService.logEvent(I.Yt,{modelVersion:this.dataModelService.version,tables:null===(X=re?.tables)||void 0===X?void 0:X.length,relationships:null===(D=re?.relationships)||void 0===D?void 0:D.length})},H.prototype.logApplyChanges=function(X){var D,re;this.telemetryService.root&&this.telemetryService.logEvent(I.Yk,{change:X.join(", "),modelVersion:null===(re=null===(D=this.modelService)||void 0===D?void 0:D.model)||void 0===re?void 0:re.version})},H.\u0275fac=function(D){return new(D||H)(R.\u0275\u0275inject(G.n,8),R.\u0275\u0275inject(x.q,8),R.\u0275\u0275inject(Y.y0,8))},H.\u0275prov=R.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac}),H}()},55375:function(Ke,Ie,T){T.d(Ie,{Z:function(){return I}});var x=T(81337),I=function(){function G(){}return G.buildOKCancelDialog=function(Y,k,R,U,H,X){return void 0===H&&(H=U.get("Yes")),void 0===X&&(X=U.get("Cancel_ButtonText")),Y=(0,x.pi)((0,x.pi)({},Y),{okButtonText:H,cancelButtonText:X}),R.openHostDialog({dialogName:k,componentName:"SimpleConfirmationDialogComponent",bindings:Y,config:{width:"500px",panelClass:["mat-dialog-content-nonextra-space"],ariaDescribedBy:"simple-dialog-content-id"}})},G.buildOKCancelDialogWithList=function(Y,k,R,U,H,X){var D=k.join(" ");return this.buildOKCancelDialog({title:Y,message:void 0,additionalMessages:[[D,{segmentStr:"",lineBreak:!0},{segmentStr:"",lineBreak:!0},U]]},R,H,X)},G.buildCancelDialog=function(Y,k,R,U,H,X,D,re){var q={dialogName:R,componentName:"SimpleDialogComponent",bindings:{titleIcon:D,title:Y,message:k,okButtonText:X||H.get("Close")},config:(0,x.pi)({width:"500px",panelClass:["mat-dialog-content-nonextra-space","legacy-dialog"],ariaDescribedBy:"simple-dialog-content-id"},re)};return U.openHostDialog(q)},G}()}}]);