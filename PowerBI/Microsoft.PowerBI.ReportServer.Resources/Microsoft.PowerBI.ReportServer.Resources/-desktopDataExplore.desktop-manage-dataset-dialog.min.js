"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["desktop-manage-dataset-dialog"],{96038:function(We,be,g){g.d(be,{jn:function(){return V}});var h=g(37419),y=g(73449);function V(se,ae,ue){return void 0===ae&&(ae=Number.POSITIVE_INFINITY),ae=(ae||0)<1?Number.POSITIVE_INFINITY:ae,function(Y){return Y.lift(new j(se,ae,ue))}}var j=function(){function se(ue,Y,w){this.project=ue,this.concurrent=Y,this.scheduler=w}return se.prototype.call=function(Y,w){return w.subscribe(new fe(Y,this.project,this.concurrent,this.scheduler))},se}(),fe=function(se){function ae(Y,w,re,z){var B;return(B=se.call(this,Y)||this).project=w,B.concurrent=re,B.scheduler=z,B.index=0,B.active=0,B.hasCompleted=!1,re<Number.POSITIVE_INFINITY&&(B.buffer=[]),B}(0,h.Z)(ae,se),ae.dispatch=function(w){w.subscriber.subscribeToProjection(w.result,w.value,w.index)};var ue=ae.prototype;return ue._next=function(w){var re=this.destination;if(re.closed)this._complete();else{var z=this.index++;if(this.active<this.concurrent){re.next(w);try{var o=(0,this.project)(w,z);this.scheduler?this.destination.add(this.scheduler.schedule(ae.dispatch,0,{subscriber:this,result:o,value:w,index:z})):this.subscribeToProjection(o,w,z)}catch(k){re.error(k)}}else this.buffer.push(w)}},ue.subscribeToProjection=function(w,re,z){this.active++,this.destination.add((0,y.ft)(w,new y.IY(this)))},ue._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},ue.notifyNext=function(w){this._next(w)},ue.notifyComplete=function(){var w=this.buffer;this.active--,w&&w.length>0&&this._next(w.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},ae}(y.Ds)},19828:function(We,be,g){g.d(be,{X:function(){return V}});var h=g(37419),y=g(47875);function V(se){return void 0===se&&(se=-1),function(ae){return ae.lift(new j(se,ae))}}var j=function(){function se(ue,Y){this.count=ue,this.source=Y}return se.prototype.call=function(Y,w){return w.subscribe(new fe(Y,this.count,this.source))},se}(),fe=function(se){function ae(Y,w,re){var z;return(z=se.call(this,Y)||this).count=w,z.source=re,z}return(0,h.Z)(ae,se),ae.prototype.error=function(w){if(!this.isStopped){var re=this.source,z=this.count;if(0===z)return se.prototype.error.call(this,w);z>-1&&(this.count=z-1),re.subscribe(this._unsubscribeAndRecycle())}},ae}(y.L)},19178:function(We,be,g){g.d(be,{Y:function(){return n}});var h=g(81337),y=g(82515),V=g(74076),j=g(40898),fe=g(82762),se=g(11547),ae=g(59017),ue=g(81905),Y=g(14172),w=g(48787),re=g(41198),z=g(23558),B=g(50423),o=g(85732),n=function(){function G(k){this.store=k}return Object.defineProperty(G.prototype,"selectedGroup$",{get:function(){return this.store.select(V.S6)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"selectedFolderId$",{get:function(){return this.store.select(V.CW)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"myFolderObjectId$",{get:function(){return this.store.select(V.iF)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"nonMyWorkspaces$",{get:function(){return this.store.select(V.c_)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"myWorkspace$",{get:function(){return this.store.select(V.Au)},enumerable:!1,configurable:!0}),G.prototype.foldersWithEditPermissions=function(k){var N=this;return(0,fe.D)(this.ensureWorkspacesLoaded()).pipe((0,ue.w)(function(){return(0,ae.aj)([N.store.select(j.Ou),k?N.store.select(V.Ze):(0,se.of)(null)])}),(0,Y.U)(function(pe){var U=pe[1],L=_(pe[0]).filter(function(J){return!U||!_.isEqual(J,U)}).sortBy(function(J){return J.displayName.toLocaleLowerCase()}).value();return U?(0,h.__spreadArray)([U],L,!0):L}))},G.prototype.add=function(k,N){this.store.dispatch(new y.mm({group:k,isFolder:N}))},Object.defineProperty(G.prototype,"folders",{get:function(){return this.store.select(j.xh).pipe((0,Y.U)(function(N){return _.map(Object.keys(N),function(pe){return N[pe]})}))},enumerable:!1,configurable:!0}),G.prototype.remove=function(k){this.store.dispatch(new y.JW(k))},G.prototype.update=function(k){this.store.dispatch(new y.BN(k))},G.prototype.updateGroup=function(k){this.store.dispatch(new y.bn(k))},G.prototype.updatePartialWorkspaces=function(k){this.store.dispatch(new y.ZG(k))},G.prototype.load=function(k){this.store.dispatch(new y.q5({groupId:k}))},G.prototype.getGroupById=function(k){return this.store.select(V.VL,{id:k})},G.prototype.getAllNonEmptyDomains=function(){return this.store.select(V.vL)},G.prototype.addDomainFilters=function(k){this.store.dispatch(new y.qC({domainObjectIds:k}))},G.prototype.deleteDomainFilters=function(k){this.store.dispatch(new y.tk({domainObjectIds:k}))},G.prototype.getGroupObjectId=function(k){return this.store.select(V.cM).pipe((0,ue.w)(function(N){for(var pe in N){var q=N[pe];if(q.id===k)return(0,se.of)(q?.objectId)}return(0,se.of)(void 0)}),(0,w.q)(1))},G.prototype.loadSuccess=function(k,N,pe,q){this.store.dispatch(new y.Xt({id:k,group:N,folderId:pe,permissions:q}))},G.prototype.loadSuccessBasedOnWorkspaceContext=function(k,N){var pe=this;this.store.select(V.ve).pipe((0,w.q)(1)).subscribe(function(q){pe.store.dispatch(new y.Xt(q?{id:k,group:N,folderId:void 0,permissions:void 0,currentWorkspaceType:"folder"}:{id:k,group:N,folderId:void 0,permissions:void 0,currentWorkspaceType:"group"}))})},G.prototype.select=function(k){this.store.dispatch(new y.Ph({id:k}))},G.prototype.switch=function(k,N){this.store.dispatch(new y.q_({groupId:k,groupSwitchOptions:N}))},G.prototype.ensureGroupArtifactsLoaded=function(k,N){var pe=this;return this.store.select(V.s4).pipe((0,re.n)(function(q){return!q}),(0,w.q)(1)).subscribe(function(){pe.store.dispatch(new y._S({groupObjectId:k,refreshIfStale:!1,addArtifacts:N}))}),this.store.select(V.VL,{id:k}).pipe((0,z.M)(this.store.select(V.Uy)),(0,re.n)(function(q){var U=q[0];return!U||!(U.loaded&&(!N||!0===q[1]))}),(0,w.q)(1),(0,Y.U)(function(){return!0})).toPromise()},G.prototype.ensureGroupArtifactsLoadedOrError=function(k){var N=this;return this.store.select(V.s4).pipe((0,re.n)(function(pe){return!pe}),(0,w.q)(1)).subscribe(function(){N.store.dispatch(new y._S({groupObjectId:k,refreshIfStale:!1}))}),this.store.select(V.VL,{id:k}).pipe((0,re.n)(function(pe){return!pe||!pe.loaded&&!pe.loadedWithError}),(0,w.q)(1),(0,Y.U)(function(){return!0})).toPromise()},G.prototype.ensureGroupSelectedAndLoaded=function(k){return this.store.select(V.S6).pipe((0,re.n)(function(N){return!N||!N.loaded||N.objectId!==k}),(0,w.q)(1),(0,Y.U)(function(){return!0})).toPromise()},G.prototype.ensureWorkspacesLoaded=function(){var k=this;return this.store.select(V.LD).pipe((0,re.n)(function(N){return!N||N.loading}),(0,w.q)(1)).subscribe(function(N){N.loaded||k.store.dispatch(new y.Us)}),this.store.select(V.LD).pipe((0,re.n)(function(N){return!N||!N.loaded}),(0,w.q)(1),(0,Y.U)(function(){return!0})).toPromise()},G.prototype.forceReloadWorkspaces=function(){return this.store.dispatch(new y.Us),this.store.select(V.LD).pipe((0,re.n)(function(k){return!k||!k.loaded}),(0,w.q)(1),(0,Y.U)(function(){return!0})).toPromise()},G.prototype.updateMyWorkSpaceCapacity=function(k){this.store.dispatch(new y.Vd(k))},G.prototype.loadFoldersSuccess=function(k){this.store.dispatch(new y.uw(k))},G.prototype.hide=function(k){this.store.dispatch(new y.c({group:k}))},G.prototype.unhide=function(k){this.store.dispatch(new y.yO({group:k}))},G.\u0275fac=function(N){return new(N||G)(B.\u0275\u0275inject(o.yh))},G.\u0275prov=B.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac,providedIn:"root"}),G}()},4301:function(We,be,g){g.d(be,{$3:function(){return R},Ap:function(){return k},BQ:function(){return Vt},CZ:function(){return Me},Iz:function(){return Y},Mo:function(){return Ut},Nl:function(){return Ht},Ok:function(){return ba},Ou:function(){return Se},PZ:function(){return tt},QC:function(){return ha},SX:function(){return Ke},Sw:function(){return pa},XI:function(){return fa},bU:function(){return j},c7:function(){return va},d7:function(){return J},fr:function(){return Oe},g3:function(){return L},gY:function(){return ma},hG:function(){return G},lp:function(){return U},nI:function(){return se},pT:function(){return yt},rD:function(){return ga},rM:function(){return f},s:function(){return Rt},sl:function(){return ua},uB:function(){return re},uh:function(){return he},vh:function(){return mt},wV:function(){return B}});var h=g(85732),y="[Datamart Metadata]",j=((0,h.PH)("".concat(y," Create datamart error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Datamart initalized"),(0,h.Ky)())),se=((0,h.PH)("".concat(y," Delete datamart"),(0,h.Ky)()),(0,h.PH)("".concat(y," Delete datamart internal"),(0,h.Ky)())),Y=((0,h.PH)("".concat(y," Delete datamart Success"),(0,h.Ky)()),(0,h.PH)("".concat(y," Delete datamart error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Refresh datamart"),(0,h.Ky)())),re=((0,h.PH)("".concat(y," Refresh datamart succeeded")),(0,h.PH)("".concat(y," Refresh datamart error"),(0,h.Ky)())),B=((0,h.PH)("".concat(y," Update datamart name"),(0,h.Ky)()),(0,h.PH)("".concat(y," Update datamart name success"),(0,h.Ky)())),G=((0,h.PH)("".concat(y," Update datamart name error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Update datamart description"),(0,h.Ky)()),(0,h.PH)("".concat(y," Update datamart description success"),(0,h.Ky)())),k=(0,h.PH)("".concat(y," Add bulk of datamarts"),(0,h.Ky)()),U=((0,h.PH)("".concat(y," Update datamart description error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Optimistically update datamart metadata"),(0,h.Ky)()),(0,h.PH)("".concat(y," Optimistically update datamart metadata success")),(0,h.PH)("".concat(y," Optimistically update datamart metadata error"),(0,h.Ky)())),L=(0,h.PH)("".concat(y," Update datamart workspace"),(0,h.Ky)()),J=(0,h.PH)("".concat(y," Select datamart"),(0,h.Ky)()),Se=(0,h.PH)("".concat(y," Unselect datamart")),Ke=((0,h.PH)("".concat(y," Get datamart info"),(0,h.Ky)()),(0,h.PH)("".concat(y," Datamart info succeeded"),(0,h.Ky)())),yt=((0,h.PH)("".concat(y," Get datamart info error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Load datamart success"),(0,h.Ky)())),f=((0,h.PH)("".concat(y," Load datamart error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Update current refresh status"),(0,h.Ky)())),R=(0,h.PH)("".concat(y," Update artifact info form"),(0,h.Ky)()),Me=((0,h.PH)("".concat(y," Get datamart refresh history"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get datamart refresh history success"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get datamart refresh history error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get datamart batch history"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get datamart batch history success"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get datamart batch history error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Try Again"),(0,h.Ky)())),tt=(0,h.PH)("".concat(y," Retry suspended datamart error"),(0,h.Ky)()),mt=((0,h.PH)("".concat(y," Failure")),(0,h.PH)("".concat(y," Retry suspended datamart success"),(0,h.Ky)())),Ut=(0,h.PH)("".concat(y," Datamart updated"),(0,h.Ky)()),ua=((0,h.PH)("".concat(y," Datamart delete UI only"),(0,h.Ky)()),(0,h.PH)("".concat(y," Datamart takeover success"),(0,h.Ky)())),ma=((0,h.PH)("".concat(y," Generate ADS Protocol By DatamartID"),(0,h.Ky)()),(0,h.PH)("".concat(y," Generate ADS Protocol By Connection string"),(0,h.Ky)()),(0,h.PH)("".concat(y," Load datamart recents success"),(0,h.Ky)())),pa=(0,h.PH)("".concat(y," Add or Update datamart recent success"),(0,h.Ky)()),va=(0,h.PH)("".concat(y," Load datamart favorites success"),(0,h.Ky)()),Rt=(0,h.PH)("".concat(y," Add datamart favorite optimistically"),(0,h.Ky)()),Ht=(0,h.PH)("".concat(y," Add datamart favorite success"),(0,h.Ky)()),fa=(0,h.PH)("".concat(y," Delete datamart favorite success"),(0,h.Ky)()),Vt=(0,h.PH)("".concat(y," Set DW sample to load"),(0,h.Ky)()),ha=(0,h.PH)("".concat(y," DW Sample Load Success"),(0,h.Ky)()),ga=(0,h.PH)("".concat(y," DW Sample Load Error"),(0,h.Ky)()),he=(0,h.PH)("".concat(y," Move To Subfolder Success"),(0,h.Ky)()),Oe=(0,h.PH)("".concat(y," Auto Add To Default Dataset Value Requested Success"),(0,h.Ky)()),ba=((0,h.PH)("".concat(y," Update Auto Add To Default Dataset Value"),(0,h.Ky)()),(0,h.PH)("".concat(y," Update Auto Add To Default Dataset Value Success"),(0,h.Ky)()));(0,h.PH)("".concat(y," Get Active Query Runs Error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get Long Running Query Insights Error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Get Frequently Run Query Insights Error"),(0,h.Ky)()),(0,h.PH)("".concat(y," Cancel Queries Error"),(0,h.Ky)())},4565:function(We,be,g){g.d(be,{EL:function(){return Y},LE:function(){return N},WZ:function(){return pe},pM:function(){return q}});var h=g(81337),y=g(4301),V=g(8894),j=g(85732),fe=g(93731),se=g(73058),ae=g(50600),ue=g(7600);function Y(f){return f.objectId}var w=(0,V.H)({selectId:function(R){return Y(R)},sortComparer:!1}),re=w.getInitialState({selectedDatamartId:null}),o=((0,j.Lq)(re,(0,j.on)(y.bU,function(f,R){var l=R.datamartObjectId,S=R.datamartType,x=R.folderId,Q=R.subfolderId;return f.entities[l]?w.updateOne({id:l,changes:{datamartType:S,state:0,status:1,folderId:x,subfolderId:Q}},f):w.addOne({objectId:l,datamartType:S,state:0,status:1,folderId:x,subfolderId:Q},f)}),(0,j.on)(y.Ou,function(f,R){return(0,h.__assign)((0,h.__assign)({},f),{selectedDatamartId:null})}),(0,j.on)(y.g3,function(f,R){var l=R.datamarts,S=R.artifacts,x=S?.filter(function(Me){return"Warehouse"===Me.artifactType||"SqlAnalyticsEndpoint"===Me.artifactType}),Q=l;if(x&&x.length>0){var te=_.map(x,function(Me){return function(f,R){var l,S,x=R?.find(function(Q){var te;return null===(te=Q.artifactRelations)||void 0===te?void 0:te.find(function(_e){return _e.dependentArtifactObjectId===f.objectId})});return{objectId:f.objectId,isGenericArtifact:!0,datamartType:yt(f,x),datasetId:null===(S=null===(l=f.datasetRelations)||void 0===l?void 0:l[0])||void 0===S?void 0:S.dependentArtifactId,lastModifiedTimeUTC:"",lastRefreshTimeUTC:"",nextRefreshTimeUTC:"",artifactPermissions:f.artifactPermissions,lastRefreshStatus:0,state:f.extendedProperties.state,status:f.extendedProperties.status,id:f.extendedProperties.DatamartsMetadataId,capabilities:f.extendedProperties.Capabilities,displayName:f.displayName,modifiedByUserId:f.modifiedByUserId,modifiedByUser:{id:f.modifiedByUser.id,objectId:f.modifiedByUser.objectId,displayName:f.modifiedByUser.name,userPrincipalName:f.modifiedByUser.userPrincipalName},ownerUserId:f.ownerUserId,ownerUser:{id:f.ownerUser.id,objectId:f.ownerUser.objectId,displayName:f.ownerUser.name,userPrincipalName:f.ownerUser.userPrincipalName},parentArtifact:x}}(Me,S)});Q=l.concat(te)}S?.forEach(function(Me){var tt;null===(tt=Me.datamartRelations)||void 0===tt||tt.forEach(function(ca){var mt=Q.find(function(Ut){return Ut.id===ca.dependentArtifactId});mt&&(mt.parentArtifact=Me)})});var _e=_.map(Q,function(Me){return(0,h.__assign)((0,h.__assign)({},Me),{currentRefreshStatus:Me.lastRefreshStatus})});return w.upsertMany(_e||[],f)}),(0,j.on)(y.Ap,function(f,R){var S=_.map(R.datamarts,function(x){return(0,h.__assign)((0,h.__assign)({},x),{currentRefreshStatus:x.lastRefreshStatus})});return w.addMany(S,f)}),(0,j.on)(y.$3,function(f,R){var x=R.artifactInfo.title;return w.updateOne({id:R.datamartObjectId,changes:{displayName:x,name:x}},f)}),(0,j.on)(y.wV,function(f,R){var l=R.name;return w.updateOne({id:R.datamartObjectId,changes:{displayName:l,name:l}},f)}),(0,j.on)(y.hG,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{description:R.description}},f)}),(0,j.on)(y.lp,function(f,R){var l=R.originalData;return w.updateOne({id:R.datamartObjectId,changes:{displayName:l.name,name:l.name}},f)}),(0,j.on)(y.d7,function(f,R){var l=R.datamartObjectId;return(0,h.__assign)((0,h.__assign)({},f),{selectedDatamartId:l})}),(0,j.on)(y.Iz,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{currentRefreshStatus:4}},f)}),(0,j.on)(y.uB,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{currentRefreshStatus:2}},f)}),(0,j.on)(y.rM,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{currentRefreshStatus:R.currentRefreshStatus}},f)}),(0,j.on)(fe.fk,fe.d_,function(f,R){var S=_.filter(R.artifacts,function(te){return te.artifactType===ae.B.Datamart});if(_.isEmpty(S))return f;var x=_.map(S,function(te){var _e=function(f){var R=f.workspaceObjectId===se.wku;return(0,h.__assign)((0,h.__assign)((0,h.__assign)((0,h.__assign)((0,h.__assign)((0,h.__assign)((0,h.__assign)({id:f.artifactId,workspaceName:f.workspaceName,workspaceType:f.workspaceType,objectId:f.artifactObjectId.toLowerCase(),artifactEndorsement:f.artifactEndorsement,artifactInformationProtection:f.artifactInformationProtection},f.ownerUser&&{ownerUser:f.ownerUser}),f.workspaceId&&{workspaceId:f.workspaceId}),f.snapshotId&&{snapshotId:f.snapshotId}),f.description&&{description:f.description}),f.lastVisitedTimeUTC&&{lastVisitedTimeUTC:f.lastVisitedTimeUTC}),f.lastRefreshTime&&{lastRefreshTime:f.lastRefreshTime}),!R&&f.workspaceObjectId&&{workspaceObjectId:f.workspaceObjectId.toLocaleLowerCase()})}(te);return{id:_e.objectId,changes:_e}}),Q=w.upsertMany(_.map(S,function(te){return function(f){return(0,h.__assign)((0,h.__assign)({},f.artifact),{displayName:f.displayName,id:f.artifactId,permissions:f.permissions})}(te)}),f);return(0,h.__assign)({},w.updateMany(x,Q))}),(0,j.on)(y.vh,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{status:1}},f)}),(0,j.on)(y.sl,function(f,R){var l=R.datamartInformation;return w.updateOne({id:l.objectId,changes:{ownerUser:l.ownerUser,modifiedByUser:l.modifiedByUser}},f)}),(0,j.on)(y.SX,function(f,R){var S=Ke(R.datamartInformation);return w.updateOne({id:S.objectId,changes:S},f)}),(0,j.on)(y.pT,function(f,R){var S=Ke(R.datamartInformation);return w.updateOne({id:S.objectId,changes:S},(0,h.__assign)((0,h.__assign)({},f),{selectedDatamartId:S.objectId}))}),(0,j.on)(y.Mo,function(f,R){var l=R.datamartObjectId,S=R.datamartType,x=R.artifactId;return f.entities[l]?f.entities[l].id?f:w.updateOne({id:l,changes:{id:x}},(0,h.__assign)((0,h.__assign)({},f),{selectedDatamartId:l})):w.addOne({objectId:l,datamartType:S,isNew:!0,id:x},f)}),(0,j.on)(y.gY,function(f,R){var S=R.recents.filter(function(te){return 8===te.ty});if(_.isEmpty(S))return f;var x=S.map(function(te){var _e=Se(te);return{id:_e.objectId,changes:_e}}),Q=w.upsertMany(_.map(S,function(te){return Se(te)}),f);return(0,h.__assign)({},w.updateMany(x,Q))}),(0,j.on)(y.Sw,function(f,R){var S=Se(R.recent);return w.updateOne({id:S.objectId,changes:S},f)}),(0,j.on)(y.c7,function(f,R){var S=R.favorites.filter(function(te){return te.favoriteType===ue.nW.Datamart});if(_.isEmpty(S))return f;var x=S.map(function(te){var _e=bt(te);return{id:te.objectId,changes:_e}}),Q=w.upsertMany(_.map(S,function(te){return bt(te)}),f);return(0,h.__assign)({},w.updateMany(x,Q))}),(0,j.on)(y.s,function(f,R){return w.updateOne({id:R.objectId,changes:{favoriteId:-1}},f)}),(0,j.on)(y.Nl,function(f,R){return w.updateOne({id:R.objectId,changes:{favoriteId:R.favoriteId,workspaceObjectId:R.workspaceObjectId}},f)}),(0,j.on)(y.XI,function(f,R){return w.updateOne({id:R.objectId,changes:{favoriteId:void 0}},f)}),(0,j.on)(y.BQ,function(f,R){var l=R.datamartObjectId,x={sampleName:lt(R.sampleName)};return w.updateOne({id:l,changes:x},f)}),(0,j.on)(y.QC,y.rD,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{sampleName:""}},f)}),(0,j.on)(y.uh,function(f,R){return w.updateMany(R.movedDatamarts.map(function(S){return{id:S.objectId,changes:{subfolderId:S.subfolderId}}}),f)}),(0,j.on)(y.Ok,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{autoAddToDefaultDataset:R.autoAddToDefaultDataset}},f)}),(0,j.on)(y.fr,function(f,R){return w.updateOne({id:R.datamartObjectId,changes:{autoAddToDefaultDataset:R.autoAddToDefaultDataset}},f)})),w.getSelectors()),N=o.selectIds,pe=o.selectEntities,q=o.selectAll;function Se(f){return{displayName:f.dn,objectId:f.oid,lastAccessDate:f.la,count:f.co,workspaceObjectId:f.gid,datamartType:f.datamartType,status:f.artifactStatus,state:f.artifactState,datasetId:f.datasetId}}function bt(f){return{displayName:f.displayName,objectId:f.objectId,favoriteId:f.id,workspaceObjectId:f.workspaceId,permissions:f.permissions,datamartType:f.datamartType,status:f.datamartStatus,state:f.datamartState,datasetId:f.datasetId}}function Ke(f){var R={objectId:f.objectId,name:f.name,displayName:f.name,description:f.description,gatewayObjectId:f.gatewayObjectId,dataflowObjectId:f.dataflowObjectId,datasetObjectId:f.datasetObjectId,datasetId:f.datasetId,status:f.status,currentRefreshStatus:f.lastRefreshStatus,lastRefreshStatus:f.lastRefreshStatus,tdsEndpoint:f.tdsEndpoint,ownerUser:f.ownerUser,datamartType:f.datamartType,lastModifiedTimeUTC:void 0,lastRefreshTimeUTC:f.lastRefreshTimeUTC,ownerUserId:f.ownerUser.id,ownerArtifactObjectId:f.ownerArtifactObjectId,nextRefreshTimeUTC:f.nextRefreshTimeUTC,modifiedByUser:f.modifiedByUser,permissions:f.permissions,artifactPermissions:f.artifactPermissions,subfolderId:f.subfolderId};return void 0!==f.state&&(R.state=f.state),R}function yt(f,R){return"Warehouse"===f.artifactType?4:"SqlAnalyticsEndpoint"===f.artifactType?"Lakehouse"===R?.artifactType?2:5:void 0}function lt(f){return f&&"nytaxi"===f.toLowerCase()?"nytaxi":""}},2253:function(We,be,g){g.d(be,{WZ:function(){return B},sv:function(){return J},LR:function(){return Ke},jf:function(){return et},JJ:function(){return G}});var h=g(4565),V=g(85732),j=g(48723),fe=g(19533),ae=((0,V.P1)(fe.C,function(S){return S&&S.params.groupid}),(0,V.P1)(fe.C,function(S){return S&&S.params.datamartId})),ue=(0,V.P1)(fe.C,function(S){var x,Q=S&&(null===(x=S?.url)||void 0===x?void 0:x.match(/warehouses\/([^\/\?]+)/));return Q?Q[1]:null}),Y=(0,V.ZF)("datamartMetadataState"),z=((0,V.P1)(Y,function(S){return S&&S.selectedDatamartId}),(0,V.P1)(Y,h.LE),(0,V.P1)(Y,h.pM)),B=(0,V.P1)(Y,h.WZ),n=(0,V.P1)(B,ae,function(S,x){return x&&S[x]}),G=(0,V.P1)(B,ae,ue,function(S,x,Q){var te=x||Q;return te&&S[te]}),J=((0,V.P1)(n,function(S){return S&&S.status}),(0,V.P1)(n,function(S){return S&&S.datasetId}),(0,V.P1)(n,function(S){return S&&S.permissions}),(0,V.P1)(B,function(S){return _.map(S,function(x){return x.displayName||x.name})}),function(x){return(0,V.P1)(B,function(Q){return Q[x].displayName||Q[x].name})}),Ke=function(x){return(0,V.P1)(B,function(Q){return Q&&Q[x].datamartType})},et=function(x){return(0,V.P1)(B,function(Q){var te;return Q&&null!==(te=Q[x])&&void 0!==te&&te.datamartType?(0,j.kK)(Q[x].datamartType):"ArtifactKind_Datamart"})};(0,V.P1)(n,function(S){return S&&S.datamartType}),(0,V.P1)(B,ae,function(S,x){var Q;return null===(Q=S[x])||void 0===Q?void 0:Q.autoAddToDefaultDataset}),(0,V.P1)(z,function(S,x){return x?_.find(S,function(Q){return Q.id===x}):null})},48723:function(We,be,g){g.d(be,{LC:function(){return y},PQ:function(){return ue},kK:function(){return j},q4:function(){return fe},wZ:function(){return V}});var h=g(62458);function y(w){switch(w){case 4:return"datawarehouses";case 2:return"lakewarehouses";case 5:return"mountedwarehouses";case 1:return"datamarts";default:return h.fF.assertFail("invalid datamartType"),"datamarts"}}function V(w){switch(w){case 4:return"datawarehouses";case 2:return"lhdatamarts";case 5:return"mountedwarehouses";case 1:return"datamarts";default:return h.fF.assertFail("invalid datamartType"),"datamarts"}}function j(w){switch(w){case 4:return"ArtifactKind_Warehouse";case 2:case 5:return"Artifact_SQL_Analytics_Endpoint";case 1:return"ArtifactKind_Datamart";default:return h.fF.assert(function(){return _.isNil(w)},"invalid datamartType"),"ArtifactKind_Datamart"}}function fe(w){switch(w){case 4:return"Artifact_Warehouse";case 2:case 5:return"Artifact_SQL_Analytics_Endpoint";case 1:return"Artifact_Datamart";default:return h.fF.assert(function(){return _.isNil(w)},"invalid datamartType"),"Artifact_Datamart"}}function ue(w){switch(w){case 4:return"data-warehouse";case 2:return"lake-warehouse";case 1:return"datamart";case 5:return"mounted-warehouse";default:return h.fF.assert(function(){return _.isNil(w)},"invalid datamartType"),"datamart"}}},47068:function(We,be,g){g.r(be),g.d(be,{DesktopManageDatasetDialogModule:function(){return $v}});var h=g(77476),y=g(17174),V=g(79061),j=g(76966),fe=g(90938),se=g(16973),ae=g(52040),ue=g(47913),Y=g(94841),w=g(45411),re=g(8816),z=g(35284),B=g(48787),o=g(81337),n=g(85732),G=g(2253),k=g(48723),N=g(12985),pe=g(19533),q=function(e){return e[e.ValidatingMashup=0]="ValidatingMashup",e[e.BuildingDataflow=1]="BuildingDataflow",e[e.BuildingDataflowRelationships=2]="BuildingDataflowRelationships",e[e.UpdatingDataflow=3]="UpdatingDataflow",e[e.RequestingDatamartRefresh=4]="RequestingDatamartRefresh",e[e.ImportingData=5]="ImportingData",e[e.WrappingUp=6]="WrappingUp",e[e.CreatingSampleTables=7]="CreatingSampleTables",e[e.CopyingSampleData=8]="CopyingSampleData",e[e.CreatingSampleViewsSprocs=9]="CreatingSampleViewsSprocs",e[e.BuildingObjects=10]="BuildingObjects",e[e.PublishingSchema=11]="PublishingSchema",e[e.ImportingUserQueries=12]="ImportingUserQueries",e}({}),U=function(e){return e.NotStarted="notStarted",e.InProgress="inProgress",e.Complete="complete",e}({}),L=g(62458),J=g(5207),Se=function(){function e(){}return e.buildFilterCommandToGetSchemaObjectContainers=function(t){var a=this;if(!_.isEmpty(t)){var r=[];return _.forEach(t,function(i){r.push(a.getIncludeFilter(i.schemaName,i.childrenType))}),this.getFilterCommand(r,[])}},e.buildFilterCommandToGetDatabaseRoleContainers=function(t){var a=this;if(!_.isEmpty(t)){var r=[];return _.forEach(t,function(i){r.push(a.getIncludeFilter(void 0,i.childrenDatamartObjectType))}),this.getFilterCommand(r,[])}},e.buildFilterCommandToGetContainers=function(t){var a=this;if(!_.isEmpty(t)){var r=[];return _.forEach(t.schemaObjectContainers,function(i){r.push(a.getIncludeFilter(i.schemaName,i.childrenType))}),_.forEach(t.databaseRoleContainers,function(i){r.push(a.getIncludeFilter(void 0,i.childrenDatamartObjectType))}),this.getFilterCommand(r,[])}},e.buildDatabaseDefinitionFilterCommandForSchema=function(t){return this.getFilterCommand([{schemaName:t.name,databaseObjectTypes:void 0}],[{schemaName:t.name,databaseObjectTypes:["storedProcedure","function"]}])},e.buildDatabaseDefinitionFilterCommandForSchemaObjectContainer=function(t){return this.getFilterCommand([{schemaName:t.schemaName,databaseObjectTypes:[this.datamartTypeToDatabaseType(t.childrenType)]}],[])},e.buildDatabaseDefinitionFilterCommandForDatabaseRoleContainer=function(t){return this.getFilterCommand([{schemaName:void 0,databaseObjectTypes:[this.datamartTypeToDatabaseType(t.childrenDatamartObjectType)]}],[])},e.datamartTypeToDatabaseType=function(t){switch(t){case"Table":return"table";case"View":return"view";case"StoredProcedure":return"storedProcedure";case"UserDefinedFunction":return"function";case"DatabaseRole":return"dbRoles";default:throw"Cannot filter database definition on this datamart object type: ".concat(t,".")}},e.databaseTypeToDatamartType=function(t){switch(t){case"table":return"Table";case"view":return"View";case"storedProcedure":return"StoredProcedure";case"function":return"UserDefinedFunction";case"dbRoles":return"DatabaseRole";default:throw"Cannot find database object type: ".concat(t,".")}},e.getDatabaseRoleContainerUniqueIdentifier=function(t,a){return"".concat(t,"_").concat(a)},e.getFilterCommand=function(t,a){return{$type:"GetDatabaseCommand",databaseDefinitionIncludeFilters:t,databaseDefinitionExcludeFilters:a}},e.getIncludeFilter=function(t,a){return{schemaName:t,databaseObjectTypes:[this.datamartTypeToDatabaseType(a)]}},e.defaultFilterCommand={$type:"GetDatabaseCommand",databaseDefinitionIncludeFilters:[{schemaName:void 0,databaseObjectTypes:["table","view"]}],databaseDefinitionExcludeFilters:[{schemaName:void 0,databaseObjectTypes:["function","storedProcedure"]},{schemaName:J._.informationSchema,databaseObjectTypes:["function","storedProcedure","view","table"]},{schemaName:J._.sysSchema,databaseObjectTypes:["function","storedProcedure","view","table"]}]},e}();function Ke(e){var t=[];return e.schemas.forEach(function(a){return t.push(a.name)}),t}function et(e,t,a){var r=e.get(t);return r?a.forEach(function(i){return r.add(Se.databaseTypeToDatamartType(i))}):r=new Set(_.map(a,function(i){return Se.databaseTypeToDatamartType(i)})),e.set(t,r),e}function lt(e,t,a){var r=e.get(t);return r?a.forEach(function(i){return r.delete(Se.databaseTypeToDatamartType(i))}):r=new Set,e.set(t,r),e}var l=g(41114),S="PBI.StartModelChangeCall.Event",x="PBI.InitialLease.Event",te=(l.cx[x]=(0,l.b1)(x),"PBI.ExtendLease.Event"),tt=(l.cx[te]=(0,l.b1)(te),l.cx[S]=(0,l.b1)(S),"PBI.EndModelChangeCall.Event"),mt=(l.cx[tt]=(0,l.b1)(tt),"PBI.InvalidEndModelCall.Event"),da=(l.cx[mt]=(0,l.b1)(mt),"PBI.Datamart.DbDefManagedViewNotInETL"),ua=l.cx[da]=(0,l.b1)(da),Pe=function(e){return e[e.Automatic=1]="Automatic",e[e.String=2]="String",e[e.Int64=6]="Int64",e[e.Double=8]="Double",e[e.DateTime=9]="DateTime",e[e.Decimal=10]="Decimal",e[e.Boolean=11]="Boolean",e[e.Binary=17]="Binary",e[e.Unknown=19]="Unknown",e[e.Variant=20]="Variant",e}({});function la(e){switch(e){case"auto":return Pe.Automatic;case"string":return Pe.String;case"int64":return Pe.Int64;case"double":return Pe.Double;case"dateTime":return Pe.DateTime;case"decimal":return Pe.Decimal;case"boolean":return Pe.Boolean;case"binary":return Pe.Binary;case"variant":return Pe.Variant;default:return Pe.Unknown}}function ma(e){switch(e){case"string":return 24;case"int64":return 10;case"double":return 15;case"dateTime":return 6;case"decimal":return 19;default:return 0}}function Rt(e){return e||Pe.Unknown}function Ht(e){return e||0}function fa(e){var t;if(function(e){return"pbi:refreshPolicy"in e}(e)&&function(e){return"IncrementalRefreshPolicy"===e.$type}(e["pbi:refreshPolicy"])){e["pbi:refreshPolicy"].refreshCompletePeriods=null!==(t=e["pbi:refreshPolicy"].refreshCompletePeriods)&&void 0!==t&&t;var a=_.find(e.annotations,function(i){return"pbi:IncrementalRefreshFilterByAttribute"===i.name}).value,r=_.find(e.annotations,function(i){return"pbi:IncrementalRefreshDetectChangeAttribute"===i.name}).value;e["pbi:refreshPolicy"].filterByAttributeName=a,e["pbi:refreshPolicy"].detectChangesAttributeName=r}}function Vt(e){if(e)switch(e.toLowerCase()){case"data":return"Data";case"calculated":return"Calculated";case"rownumber":return"RowNumber";default:return}}function he(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return"".concat(e).concat(N.kr).concat(_.join(t,N.kr))}function Oe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"[".concat(_.join(e,"].["),"]")}function ya(e,t,a){for(var r,i,s=0;s<(null===(r=e.tables)||void 0===r?void 0:r.length);s++){var c=e.tables[s],u=he(a.datamartObjectId,c.schemaName,c.name),m=t.tables.get(u);m?(m.name=c.name,m.schemaName=c.schemaName,m.isBiObject=c.isBiObject,m.uniqueName=c.uniqueName,m.modelUrn=N.X6.getTableUrn(c.uniqueName,c.isBiObject?null:J._.DataWarehouseSchema)):m={objectType:"Table",urn:u,columns:new Set,measures:new Set,name:c.name,id:c.id,isHidden:!1,canEdit:!0,isManaged:c.isManaged,isBiObject:c.isBiObject,schemaName:c.schemaName,warehouseName:a.name,uniqueName:c.uniqueName,modelUrn:N.X6.getTableUrn(c.uniqueName,c.isBiObject?null:J._.DataWarehouseSchema),syncErrors:[],syncWarnings:[],warehouseId:a.datamartObjectId,fullyQualifiedName:Oe(a.name,c.schemaName,c.name),twoPartName:Oe(c.schemaName,c.name)};for(var p=0;p<(null===(i=c.columns)||void 0===i?void 0:i.length);p++){var v=c.columns[p],b=he(a.datamartObjectId,c.schemaName,m.name,v.name),E=t.columns.get(b);At(E=E?kr((0,o.__assign)((0,o.__assign)({},E),{index:p}),v,m):{objectType:"Column",urn:b,name:v.name,index:p,isBiObject:m.isBiObject,parentDisplayName:m.name,warehouseId:a.datamartObjectId,isHidden:v.isHidden,canEdit:!0,columnType:"Data",modelDataType:Rt(v.asDataType),sqlDataType:Ht(v.dataType),modelUrn:N.X6.getColumnUrn(m.uniqueName,v.name,m.isBiObject?null:J._.DataWarehouseSchema),fullyQualifiedName:Oe(v.name)},m,t)}Br(m,t,a)}return t}function Da(e,t,a,r){for(var i,s,c=function(p){var v=e.views[p];if(v.isManaged){var b=he(a.datamartObjectId,J._.EtlSchema,v.name.toLowerCase()),E=t.tables.get(b);return E?(E.isBiObject=v.isBiObject,E.uniqueName=v.uniqueName,E.modelUrn=N.X6.getTableUrn(v.uniqueName,v.isBiObject?null:J._.DataWarehouseSchema),E.columns.forEach(function(M){var F=t.columns.get(M);L.fF.assertValue(F,"This column should exist."),F.modelUrn=N.X6.getColumnUrn(E.uniqueName,F.name,E.isBiObject?null:J._.DataWarehouseSchema),F.isBiObject=E.isBiObject,F.sqlDataType=void 0,At(F,E,t)}),"continue"):(L.fF.assertValue(E,"An ETL table should exist for the view ".concat(b," but it doesnt.")),r?.logEvent(ua),"continue")}var D=he(a.datamartObjectId,v.schemaName,v.name),O=t.views.get(D);O?(O.name=v.name,O.schemaName=v.schemaName,O.isBiObject=v.isBiObject,O.uniqueName=v.uniqueName,O.modelUrn=N.X6.getTableUrn(v.uniqueName,v.isBiObject?null:J._.DataWarehouseSchema)):O={objectType:"View",urn:D,name:v.name,columns:new Set,measures:new Set,isHidden:!1,canEdit:!0,isManaged:v.isManaged,isBiObject:v.isBiObject,schemaName:v.schemaName,warehouseName:a.name,uniqueName:v.uniqueName,modelUrn:N.X6.getTableUrn(v.uniqueName,v.isBiObject?null:J._.DataWarehouseSchema),warehouseId:a.datamartObjectId,fullyQualifiedName:Oe(a.name,v.schemaName,v.name),twoPartName:Oe(v.schemaName,v.name)};for(var A=0;A<(null===(s=v.columns)||void 0===s?void 0:s.length);A++){var C=v.columns[A],I=he(a.datamartObjectId,v.schemaName,O.name,C.name),P=t.columns.get(I);At(P=P?kr((0,o.__assign)((0,o.__assign)({},P),{index:A}),C,O):{objectType:"Column",urn:I,name:C.name,index:A,isBiObject:O.isBiObject,parentDisplayName:O.name,isHidden:C.isHidden,warehouseId:a.datamartObjectId,canEdit:!0,columnType:"Data",modelDataType:Rt(C.asDataType),sqlDataType:Ht(C.dataType),modelUrn:N.X6.getColumnUrn(O.uniqueName,C.name,O.isBiObject?null:J._.DataWarehouseSchema),fullyQualifiedName:Oe(C.name)},O,t)}!function(e,t,a){t.views.set(e.urn,e),Mt(e.schemaName,"Views","View",t,a).childrenUrns.add(e.urn)}(O,t,a)},u=0;u<(null===(i=e.views)||void 0===i?void 0:i.length);u++)c(u);return t}function ke(e,t,a,r,i){var s=Mt(e.name,t,a,r,i);e.schemaObjectContainersUrns.add(s.urn)}function xr(e,t){var a=e.datamarts.get(t.datamartObjectId);return a||(e.datamarts.set(t.datamartObjectId,a={name:t.name,canEdit:!1,objectType:"Warehouse",categoryUrns:new Set,isHidden:!1,urn:t.name,objectId:t.datamartObjectId,warehouseMetadata:t,autoRefreshingFromQueryExecution:!1,etlModel:void 0,datasetInfo:void 0,databaseDefinition:void 0,refreshingDatamartBatchId:void 0,refreshedEntityIds:[],importingWarehouseBatchId:void 0,updatingDatamartStepsProgressIds:[],updatingLoadingStepsProgressIds:[],viewAsRoles:[],infoLoadState:"LOADING",queriesLoadState:"LOADING",schemaLoadState:"LOADED",modelingServiceInitialized:!1,modelingServiceIgnoreModelChanged:!1,fromDatahub:!1,notificationSuspended:!1,isReadonly:!1,autoRefreshing:!1,isSyncRunning:!1,loadingForSearch:!1,isObjectContainerRefreshing:!1,isWarehouseImporting:!1,failedToLoadTableSyncErrors:[]}),a)}function Qt(e,t,a){var r=he(a.datamartObjectId,e),i=t.categories.get(r);return i||(t.categories.set(r,i={name:e,canEdit:!1,objectType:"Category",childrenUrns:new Set,isHidden:!1,urn:r,warehouseMetadata:a}),i)}function jr(e,t,a){var r=he(a.datamartObjectId,e),i=t.schemas.get(r);return i||(t.schemas.set(r,i={name:e,canEdit:!1,objectType:"Schema",schemaObjectContainersUrns:new Set,isHidden:!1,urn:r,warehouseMetadata:a}),i)}function Mt(e,t,a,r,i){var s=he(i.datamartObjectId,e,t),c=r.schemaObjectContainers.get(s);return c||(c={name:t,canEdit:!1,objectType:"SchemaObjectContainer",childrenUrns:new Set,isHidden:!1,urn:s,childrenType:a,warehouseMetadata:i,schemaName:e,isLoaded:tc(e,a)},r.schemaObjectContainers.set(s,c),c)}function tc(e,t){return"Table"===t||"View"===t&&e!==J._.sysSchema&&e!==J._.informationSchema&&e!==J._.queryInsightsSchema}function _a(e,t,a,r){var i=he(r.datamartObjectId,e),s=a.databaseRoleContainers.get(i);return s||(a.databaseRoleContainers.set(i,s={name:e,canEdit:!1,objectType:"DatabaseRoleContainer",databaseRoleUrns:new Set,childrenRoleType:t,isHidden:!1,urn:i,isLoaded:!1,warehouseMetadata:r,childrenDatamartObjectType:"DatabaseRole"}),s)}function At(e,t,a){return a.columns.set(e.urn,e),t.columns.add(e.urn),a}function Br(e,t,a,r){if(t.tables.set(e.urn,e),1!==a.datamartType)Mt(e.schemaName,"Tables","Table",t,a).childrenUrns.add(e.urn);else{if(!r)throw new Error("Attempted to update SQL Datamart Table without Category");r.childrenUrns.add(e.urn)}return t}function rc(e,t){var a,r,i,s;return e.name=null!==(a=t?.name)&&void 0!==a?a:e?.name,e.columnType=Vt(t?.type),e.dataType=_.isNull(t?.dataType)?e?.dataType:function(e){switch(_.toLower(e)){case"binary":return"Binary";case"boolean":return"Boolean";case"currency":return"Currency";case"date":return"Date";case"datetime":return"DateTime";case"number":return"Number";case"text":default:return"Text";case"time":return"Time";case"variant":return"Variant";case"wholenumber":return"WholeNumber"}}(t?.dataType),e.isHidden=t?.isHidden,e.isKey=null!==(r=t?.isKey)&&void 0!==r?r:e?.isKey,e.isNullable=null!==(i=t?.isNullable)&&void 0!==i?i:e?.isNullable,e.isUnique=null!==(s=t?.isUnique)&&void 0!==s?s:e?.isUnique,e.summarizeBy=_.isNull(t?.summarizeBy)?e?.summarizeBy:function(e){switch(_.toLower(e)){case"average":return"Average";case"count":return"Count";case"default":default:return"Default";case"distinctCount":return"DistinctCount";case"max":return"Max";case"min":return"Min";case"none":return"None";case"sum":return"Sum"}}(t?.summarizeBy),e.formatString=t?.formatString,e}function kr(e,t,a){var r,i,s,c;return e.name=null!==(r=t.name)&&void 0!==r?r:e.name,e.modelDataType=Rt(t.asDataType),e.isHidden=null!==(i=t.isHidden)&&void 0!==i?i:e.isHidden,e.isKey=null!==(s=t.isKey)&&void 0!==s?s:e.isKey,e.isUnique=null!==(c=t.isUnique)&&void 0!==c?c:e.isUnique,e.formatString=t.formatString,e.modelUrn=N.X6.getColumnUrn(a.uniqueName,e.name,a.isBiObject?null:J._.DataWarehouseSchema),e}function qr(e,t,a,r,i){var s,c,u=e[t.uniqueName];if(u){for(var m=0;m<(null===(s=u.measures)||void 0===s?void 0:s.length);m++){var p=u.measures[m],v=he(a.datamartObjectId,t.schemaName,t.name,p.name),b=r.measures.get(v);b?(b.name=p.name,b.expression=p.expression,b.annotations=p.annotations,b.modelUrn=N.X6.getMeasureUrn(t.uniqueName,p.name,t.isBiObject?null:J._.DataWarehouseSchema)):b={objectType:"Measure",urn:v,name:p.name,parentDisplayName:t.name,isHidden:!1,canEdit:!0,warehouseId:a.datamartObjectId,expression:p.expression,annotations:p.annotations,modelUrn:N.X6.getMeasureUrn(t.uniqueName,p.name,t.isBiObject?null:J._.DataWarehouseSchema)},r.measures.set(b.urn,b),t.measures.add(b.urn)}for(var E=0;E<(null===(c=u.columns)||void 0===c?void 0:c.length);E++){var D=u.columns[E];if("rowNumber"!==D.type){var O=N.X6.getColumnUrn(t.uniqueName,D.name,t.isBiObject?null:J._.DataWarehouseSchema),A=i.get(O),C=he(a.datamartObjectId,t.schemaName,t.name,D.name);A||(A={objectType:"Column",urn:C,name:D.name,isHidden:D.isHidden,canEdit:!0,warehouseId:a.datamartObjectId,columnType:Vt(D.type),modelDataType:la(D.dataType),sqlDataType:ma(D.dataType),isBiObject:t.isBiObject,modelUrn:O,fullyQualifiedName:Oe(D.name)}),At(A=rc(A,D),t,r)}}}}var pt=g(68816),at=g(35510),Lr=function(){function e(){this.hasSelection$=new at.X(!1),this.selectedText$=new at.X(""),this.hasErrorMarker$=new at.X(!1),this.model=pt.editor.createModel("","AzureDb")}return e.prototype.bindEditor=function(t){var a=this;this.codeEditor=t,this.model&&this.codeEditor.setModel(this.model),this.viewState&&this.codeEditor.restoreViewState(this.viewState),this.codeEditor.onDidChangeCursorSelection(function(r){var i=a.getHighlighted().trim();a.hasSelection$.next(!!i),a.selectedText$.next(i)}),pt.editor.onDidChangeMarkers(function(r){var s=pt.editor.getModelMarkers({}).some(function(c){return c.severity===pt.MarkerSeverity.Error});a.hasErrorMarker$.next(s)})},e.prototype.saveViewState=function(){this.codeEditor&&(this.viewState=this.codeEditor.saveViewState())},e.prototype.insertTextAboveSelections=function(t){var a=this.editor.getSelection(),r=a.startLineNumber-1,i=0;r>0?i=this.editor.getModel().getLineContent(r).length+1:r=1;var c=new pt.Range(r,i,r,i+1);t="\n"+t.trim()+"\n",this.editor.executeEdits("",[{range:c,text:t,forceMoveMarkers:!0}]),this.editor.setSelection(new pt.Selection(a.startLineNumber+1,a.startColumn,a.startLineNumber+1,a.startColumn))},e.prototype.focus=function(){var t;null===(t=this.codeEditor)||void 0===t||t.focus()},e.prototype.getSql=function(){return _.isEmpty(this.getHighlighted())?this.editor.getModel().getLinesContent().join("\n"):this.getHighlighted()},e.prototype.getAll=function(){return this.editor.getModel().getLinesContent().join("\n")},e.prototype.getContent=function(){return this.editor.getModel().getLinesContent().join("\n")},e.prototype.setSql=function(t){this.editor.setValue(t)},Object.defineProperty(e.prototype,"editor",{get:function(){return this.codeEditor},enumerable:!1,configurable:!0}),e.prototype.getHighlighted=function(){return this.editor.getModel().getValueInRange(this.editor.getSelection())},e.prototype.getHighlightedWithContext=function(t,a){void 0===t&&(t=5),void 0===a&&(a=5);var r=this.editor.getSelection(),i=Math.max(1,r.startLineNumber-t),s=Math.min(this.editor.getModel().getLineCount(),r.endLineNumber+a),c=new pt.Range(i,1,s,1);return this.editor.getModel().getValueInRange(c)},e.prototype.getHighlightedWithFoldingRange=function(){var a=this.editor.saveViewState().contributionsState["editor.contrib.folding"].collapsedRegions,r=this.editor.getSelection().endLineNumber;if(a)for(var i=0,s=a;i<s.length;i++){var c=s[i],u=c.startLineNumber,m=c.endLineNumber;if(r>=u&&r<=m)return this.getHighlightedWithContext(0,m-u+1)}return this.getHighlighted()},e.prototype.replaceSelection=function(t){var a=this.editor.getSelection();this.editor.executeEdits("",[{range:a,text:t,forceMoveMarkers:!0}])},e.prototype.replaceAll=function(t){var a=this.editor.getModel().getFullModelRange();this.editor.executeEdits("",[{range:a,text:t,forceMoveMarkers:!0}])},e}();function Sa(e,t){var a;return(0,o.__assign)({primaryDatamartObjectId:e,dataExplorer:void 0,leaseExpiration:void 0,sqlRunId:0,tabs:[],selected:{queryId:void 0,items:new Set},loadingWarehousesIds:[],oneLakeUrl:void 0,mwcTokenResponsePayload:void 0,loadedWarehouseIds:[],fieldListFilters:(a={},a.Table=!1,a.View=!1,a.Column=!1,a.StoredProcedure=!1,a.UserDefinedFunction=!1,a.Query=!1,a),loadingError:void 0},t)}function Ia(e,t){return(0,o.__assign)({name:void 0,canEdit:!1,objectType:"Warehouse",categoryUrns:new Set,isHidden:!1,urn:void 0,objectId:e,warehouseMetadata:void 0,autoRefreshingFromQueryExecution:!1,etlModel:void 0,datasetInfo:void 0,databaseDefinition:void 0,refreshingDatamartBatchId:void 0,refreshedEntityIds:[],importingWarehouseBatchId:void 0,updatingDatamartStepsProgressIds:[],updatingLoadingStepsProgressIds:[],viewAsRoles:[],infoLoadState:"INIT",queriesLoadState:"INIT",schemaLoadState:"INIT",modelingServiceInitialized:!1,modelingServiceIgnoreModelChanged:!1,fromDatahub:!1,notificationSuspended:!1,isReadonly:!1,isLoadedFromCache:!1},t)}function Ea(e,t,a,r,i,s,c){var u,m,p,v;void 0===s&&(s=Se.defaultFilterCommand);var b={categories:new Map,schemas:new Map,schemaObjectContainers:new Map,tables:new Map,columns:new Map,measures:new Map,views:new Map,storedProcedures:new Map,userDefinedFunctions:new Map,datamarts:new Map,databaseRoleContainers:new Map,databaseRoles:new Map},E=_.find(e.operationInformation,Pa);b=function(e,t,a){var r,i;if(1!==a.datamartType&&(Qt("Schemas",t,a),!e||!e?.entities))return t;var s=he(a.datamartObjectId,"Tables"),c={name:"Tables",canEdit:!1,objectType:"Category",childrenUrns:new Set,isHidden:!1,urn:s,warehouseMetadata:a};t.categories.set(c.urn,c);for(var u=0;u<(null===(r=e?.entities)||void 0===r?void 0:r.length);u++){var m=e.entities[u];fa(m);for(var v={objectType:"Table",urn:he(a.datamartObjectId,J._.EtlSchema,m.name.toLowerCase()),name:m.name,columns:new Set,measures:new Set,isHidden:m.isHidden,canEdit:!0,isManaged:!0,schemaName:J._.EtlSchema,warehouseName:a.name,isBiObject:void 0,uniqueName:m.name,modelUrn:N.X6.getTableUrn(m.name),fullyQualifiedName:Oe(a.name,J._.EtlSchema,m.name),twoPartName:Oe(J._.EtlSchema,m.name),warehouseId:a.datamartObjectId},b=0;b<(null===(i=m.attributes)||void 0===i?void 0:i.length);b++){var E=m.attributes[b];At({objectType:"Column",urn:he(a.datamartObjectId,J._.EtlSchema,v.name,E.name),name:E.name,isBiObject:v.isBiObject,parentDisplayName:v.name,isHidden:m.isHidden,warehouseId:a.datamartObjectId,canEdit:!0,columnType:"Data",modelDataType:la(E.dataType),description:E.description,modelUrn:N.X6.getColumnUrn(v.uniqueName,E.name,v.isBiObject?null:J._.DataWarehouseSchema),fullyQualifiedName:Oe(E.name),sqlDataType:void 0},v,t)}Br(v,t,a,c)}return t}(null===(u=E?.progressDetail)||void 0===u?void 0:u.dataflow,b,a);var O=_.find(e.operationInformation,Oa),A=null===(m=O?.progressDetail)||void 0===m?void 0:m.databaseDefinition;b=r?function(e,t,a,r){if(1!==a.datamartType){var i=Qt("Schemas",t,a);if(!e||!e?.schemas)return t.categories.set(i.urn,i),t;for(var s=0,c=e.schemas;s<c.length;s++){var u=c[s],m=jr(u.name,t,a);switch(u.name){case J._.informationSchema:case J._.sysSchema:ke(m,"Views","View",t,a);break;default:ke(m,"Tables","Table",t,a),ke(m,"Views","View",t,a)}t.schemas.set(m.urn,m),i.childrenUrns.add(m.urn)}t.categories.set(i.urn,i),t=ya(e,t,a)}else if(!e||!e?.schemas)return t;return Da(e,t,a,r)}(A,b,a,i):function(e,t,a,r,i){var s=xr(a,r);if(1!==r.datamartType){var c=Qt("Schemas",a,r);if(e){s.categoryUrns.add(c.urn);var u=Qt("Security",a,r);s.categoryUrns.add(u.urn);var m=_a("BuiltIn","DB roles (Built-in)",a,s.warehouseMetadata),p=_a("Custom","DB roles (Custom)",a,s.warehouseMetadata);u.childrenUrns.add(he(s.objectId,m.name)),u.childrenUrns.add(he(s.objectId,p.name))}if(!t||!t?.schemas)return a.categories.set(c.urn,c),a;for(var v=0,b=t.schemas;v<b.length;v++){var E=b[v],D=jr(E.name,a,r);switch(E.name){case J._.informationSchema:case J._.queryInsightsSchema:ke(D,"Views","View",a,r);break;case J._.sysSchema:ke(D,"Views","View",a,r),ke(D,"Stored Procedures","StoredProcedure",a,r),ke(D,"Functions","UserDefinedFunction",a,r);break;default:ke(D,"Tables","Table",a,r),ke(D,"Views","View",a,r),ke(D,"Stored Procedures","StoredProcedure",a,r),ke(D,"Functions","UserDefinedFunction",a,r)}a.schemas.set(D.urn,D),c.childrenUrns.add(D.urn)}a.categories.set(c.urn,c),a=function(e,t,a){for(var r,i=0;i<(null===(r=e.storedProcedures)||void 0===r?void 0:r.length);i++){var s=e.storedProcedures[i],c=he(a.datamartObjectId,s.schemaName,"StoredProcedure",s.name),u=t.storedProcedures.get(c);u?(u.name=u.name,u.schemaName=u.schemaName,u.uniqueName=u.uniqueName):u={objectType:"StoredProcedure",urn:c,name:s.name,isHidden:!1,canEdit:!1,schemaName:s.schemaName,uniqueName:s.uniqueName,fullyQualifiedName:Oe(s.schemaName,s.name),warehouseId:a.datamartObjectId},t.storedProcedures.set(u.urn,u),Mt(u.schemaName,"Stored Procedures","StoredProcedure",t,a).childrenUrns.add(u.urn)}return t}(t,a=ya(t,a,r),r),a=function(e,t,a){for(var r,i=0;i<(null===(r=e.functions)||void 0===r?void 0:r.length);i++){var s=e.functions[i],c=he(a.datamartObjectId,s.schemaName,"UserDefinedFunction",s.name),u=t.userDefinedFunctions.get(c);u?(u.name=u.name,u.schemaName=u.schemaName,u.uniqueName=u.uniqueName):u={objectType:"UserDefinedFunction",urn:c,name:s.name,isHidden:!1,canEdit:!1,schemaName:s.schemaName,uniqueName:s.uniqueName,fullyQualifiedName:Oe(s.schemaName,s.name),warehouseId:a.datamartObjectId},t.userDefinedFunctions.set(u.urn,u),Mt(u.schemaName,"Functions","UserDefinedFunction",t,a).childrenUrns.add(u.urn)}return t}(t,a,r),a=function(e,t,a){for(var r,i=0;i<(null===(r=e.dbRoles)||void 0===r?void 0:r.length);i++){var s=e.dbRoles[i],c=s.isBuiltIn?"BuiltIn":"Custom",u=he(a.datamartObjectId,c,s.name),m=t.databaseRoles.get(u);m?(m.name=m.name,m.databaseRoleType=m.databaseRoleType):m={objectType:"DatabaseRole",urn:u,name:s.name,isHidden:!1,canEdit:!1,warehouseId:a.datamartObjectId,databaseRoleType:s.isBuiltIn?"DB roles (Built-in)":"DB roles (Custom)"},t.databaseRoles.set(m.urn,m),_a(c,s.isBuiltIn?"DB roles (Built-in)":"DB roles (Custom)",t,a).databaseRoleUrns.add(m.urn)}return t}(t,a,r)}else if(!t||!t?.schemas)return a;return Da(t,a,r,i)}(t.warehouseCrossDbQueries,A,b,a,i);var C=_.find(e.operationInformation,Ca);b=function(e,t,a,r){var i,s;if(_.isEmpty(t))return a;var c=function(e){for(var t,a,r={},i=0;i<(null===(a=null===(t=e?.model)||void 0===t?void 0:t.tables)||void 0===a?void 0:a.length);i++){var s=e?.model.tables[i];r[s.name]=s}return r}(t),u=new Map;a.columns.forEach(function(A){u.set(A.modelUrn,A)});var m=e.datamarts.entities[r.datamartObjectId],p=xr(a,r);if(!_.isEmpty(m)){var v=[],b=m.viewAsRoles.map(function(A){return A.roleName}),E=null===(s=null===(i=t?.model)||void 0===i?void 0:i.roles)||void 0===s?void 0:s.map(function(A){return A.name});_.difference(E,b).forEach(function(A){v.push({roleName:A,checked:!1})}),_.intersection(b,E).forEach(function(A){v.push(m.viewAsRoles.find(function(C){return C.roleName===A}))}),p.viewAsRoles=v,a.datamarts.set(r.datamartObjectId,p)}return a.tables.forEach(function(A){qr(c,A,r,a,u)}),a.views.forEach(function(A){qr(c,A,r,a,u)}),a}(t,null===(p=C?.progressDetail)||void 0===p?void 0:p.dataset,b,a);var P=_.find(e.operationInformation,oc);return b=function(e,t,a){var r,i,s=t.datamarts.get(a.datamartObjectId);if(!s||2!==a.datamartType)return t;if(void 0===e)return s.failedToLoadTableSyncErrors=void 0,t;for(var c=0,u=e;c<u.length;c++){var m=u[c],p=he(a.datamartObjectId,"dbo",m.tableName),v=t.tables.get(p);m.warehouseName=s.name,v&&!_.isEmpty(m.warningMessages)?v.syncWarnings=m.warningMessages:v&&m.error?(null!==(r=v.syncErrors)&&void 0!==r||(v.syncErrors=[]),v.syncErrors.push(m)):m.error&&(null!==(i=s.failedToLoadTableSyncErrors)&&void 0!==i||(s.failedToLoadTableSyncErrors=[]),s.failedToLoadTableSyncErrors.push(m))}return t}(null===(v=P?.progressDetail)||void 0===v?void 0:v.tablesSyncStatus,b,a),function(e,t,a,r){return I=!0,e.datamarts.forEach(function(P,M){var F,Z=t.datamarts.entities[P.objectId];if(Z&&"INIT"!==Z.schemaLoadState){var je=P.categoryUrns,ut=null!==(F=P.failedToLoadTableSyncErrors)&&void 0!==F?F:Z.failedToLoadTableSyncErrors;P=(0,o.__assign)((0,o.__assign)({},Z),{name:Z.name,canEdit:Z.canEdit,objectType:"Warehouse",categoryUrns:je,isHidden:Z.isHidden,urn:Z.urn,objectId:Z.objectId,autoRefreshing:!1,warehouseMetadata:a,autoRefreshingFromQueryExecution:Z.autoRefreshingFromQueryExecution,isSyncRunning:!1,isWarehouseImporting:!1,failedToLoadTableSyncErrors:ut,viewAsRoles:P.viewAsRoles})}else I&&(P={name:P.name,canEdit:P.canEdit,objectType:"Warehouse",categoryUrns:P.categoryUrns,isHidden:P.isHidden,urn:P.urn,objectId:P.objectId,autoRefreshing:!1,warehouseMetadata:a,autoRefreshingFromQueryExecution:P.autoRefreshingFromQueryExecution,isSyncRunning:!1,isWarehouseImporting:!1,failedToLoadTableSyncErrors:P.failedToLoadTableSyncErrors,etlModel:void 0,datasetInfo:P.datasetInfo,databaseDefinition:P.databaseDefinition,refreshingDatamartBatchId:P.refreshingDatamartBatchId,refreshedEntityIds:P.refreshedEntityIds,importingWarehouseBatchId:P.importingWarehouseBatchId,updatingDatamartStepsProgressIds:P.updatingDatamartStepsProgressIds,updatingLoadingStepsProgressIds:P.updatingLoadingStepsProgressIds,viewAsRoles:P.viewAsRoles,infoLoadState:P.infoLoadState,queriesLoadState:P.queriesLoadState,schemaLoadState:P.schemaLoadState,modelingServiceInitialized:P.modelingServiceInitialized,modelingServiceIgnoreModelChanged:P.modelingServiceIgnoreModelChanged,fromDatahub:P.fromDatahub,notificationSuspended:P.notificationSuspended,isReadonly:P.isReadonly},I=!1);e.datamarts.set(P.objectId,P)}),e.schemas.forEach(function(I,P){var M=t.schemas.entities[I.urn];if(M){var F=I.schemaObjectContainersUrns;(I=_.cloneDeep(M)).schemaObjectContainersUrns=F,e.schemas.set(I.urn,I)}}),e.categories.forEach(function(I,P){var M=t.categories.entities[I.urn];if(M){var F=I.childrenUrns;(I=_.cloneDeep(M)).childrenUrns=F,e.categories.set(I.urn,I)}}),e.schemaObjectContainers.forEach(function(I,P){var M=t.schemaObjectContainers.entities[I.urn];if(M){var F=I.childrenUrns;(function(I){var P=r.get(I.schemaName);return!!P&&P.has(I.childrenType)})(I=_.cloneDeep(M))&&(I.childrenUrns=F),e.schemaObjectContainers.set(I.urn,I)}}),e.tables.forEach(function(I,P){var M=t.tables.entities[I.urn];M&&1!==a.datamartType&&(I.isHidden=M.isHidden,I.canEdit=M.canEdit,I.syncErrors=M.syncErrors,I.syncWarnings=M.syncWarnings,e.tables.set(I.urn,I))}),e.views.forEach(function(I,P){var M=t.views.entities[I.urn];M&&(I.isHidden=M.isHidden,I.canEdit=M.canEdit,e.views.set(I.urn,I))}),e.measures.forEach(function(I,P){var M=t.measures.entities[I.urn];M&&(I.isHidden=M.isHidden,I.canEdit=M.canEdit,e.measures.set(I.urn,I))}),e.columns.forEach(function(I,P){var M=t.columns.entities[I.urn];M&&(I.isHidden=M.isHidden,I.canEdit=M.canEdit,e.columns.set(I.urn,I))}),e.storedProcedures.forEach(function(I,P){var M=t.storedProcedures.entities[I.urn];M&&(I.isHidden=M.isHidden,e.storedProcedures.set(I.urn,I))}),e.databaseRoleContainers.forEach(function(I,P){var M=t.databaseRoleContainers.entities[I.urn];if(M){var F=I.databaseRoleUrns;(function(I){var P=Se.getDatabaseRoleContainerUniqueIdentifier(I.warehouseMetadata.datamartObjectId,I.childrenRoleType),M=r.get(P);return!!M&&M.has(I.childrenDatamartObjectType)})(I=_.cloneDeep(M))&&(I.databaseRoleUrns=F),e.databaseRoleContainers.set(I.urn,I)}}),e.databaseRoles.forEach(function(I,P){var M=t.databaseRoles.entities[I.urn];M&&(I.isHidden=M.isHidden,e.databaseRoles.set(I.urn,I))}),e;var I}(b,t,a,function(e,t,a,r){e=e??Se.defaultFilterCommand;for(var i=new Map,s=["DB roles (Custom)","DB roles (Built-in)"],c=function(A){var C;if(A.databaseObjectTypes.includes("dbRoles"))L.fF.assert(function(){return 1===A.databaseObjectTypes.length},"dbRoles should be the only type in the filter when included"),C=Se.getDatabaseRoleContainerUniqueIdentifier(a,r||s.pop()),i=et(i,C,A.databaseObjectTypes);else if(A.schemaName)i=function(e,t){return et(e,t.schemaName,t.databaseObjectTypes)}(i,A);else for(var I=0,P=Ke(t);I<P.length;I++)i=et(i,P[I],A.databaseObjectTypes)},u=0,m=e.databaseDefinitionIncludeFilters;u<m.length;u++)c(m[u]);for(var v=function(A){var C;if(A.databaseObjectTypes.includes("dbRoles"))L.fF.assert(function(){return 1===A.databaseObjectTypes.length},"dbRoles should be the only type in the filter when included"),C=Se.getDatabaseRoleContainerUniqueIdentifier(a,r||s.pop()),i=lt(i,C,A.databaseObjectTypes);else if(A.schemaName)i=function(e,t){return lt(e,t.schemaName,t.databaseObjectTypes)}(i,A);else for(var I=0,P=Ke(t);I<P.length;I++)i=lt(i,P[I],A.databaseObjectTypes)},b=0,E=e.databaseDefinitionExcludeFilters;b<E.length;b++)v(E[b]);return i}(s,b,a.datamartObjectId,c))}function Pa(e){var t;return null!=(null===(t=e?.progressDetail)||void 0===t?void 0:t.dataflow)}function Ca(e){var t;return"GetDatasetOperationProgressDetail"===(null===(t=e?.progressDetail)||void 0===t?void 0:t.$type)}function Oa(e){var t;return null!=(null===(t=e?.progressDetail)||void 0===t?void 0:t.databaseDefinition)}function sc(e){var t;return"PutDataflowOperationProgressDetail"===(null===(t=e?.progressDetail)||void 0===t?void 0:t.$type)}function oc(e){var t;return null!=(null===(t=e?.progressDetail)||void 0===t?void 0:t.tablesSyncStatus)}function Fr(e){var t;return"ExecuteSqlOperationProgressDetail"===(null===(t=e?.progressDetail)||void 0===t?void 0:t.$type)}function cc(e){var t;return"ImportOperationProgressDetail"===(null===(t=e?.progressDetail)||void 0===t?void 0:t.$type)}function uc(e){var t=[];return _.forEach(e.tables.entities,function(a){return t.push({id:a.urn,changes:{isHidden:!1}})}),t}function lc(e){var t=[];return _.forEach(e.columns.entities,function(a){return t.push({id:a.urn,changes:{isHidden:!1}})}),t}function mc(e){var t=[];return _.forEach(e.measures.entities,function(a){return t.push({id:a.urn,changes:{isHidden:!1}})}),t}function Ur(e,t){var a=e.schemas.entities[t];if(a)return{type:"Schema",value:a};var r=e.tables.entities[t];if(r)return{type:"Table",value:r};var i=e.columns.entities[t];if(i)return{type:"Column",value:i};var s=e.measures.entities[t];if(s)return{type:"Measure",value:s};var c=e.queries.entities[t];if(c)return{type:"Query",value:c};var u=e.storedProcedures.entities[t];if(u)return{type:"StoredProcedure",value:u};var m=e.views.entities[t];if(m)return{type:"View",value:m};var p=e.userDefinedFunctions.entities[t];if(p)return{type:"UserDefinedFunction",value:p};var v=e.datamarts.entities[t];if(v)return{type:"Warehouse",value:v};var b=e.categories.entities[t];if(b)return{type:"Category",value:b};var E=e.schemaObjectContainers.entities[t];if(E)return{type:"SchemaObjectContainer",value:E};var D=e.databaseRoleContainers.entities[t];if(D)return{type:"DatabaseRoleContainer",value:D};var O=e.databaseRoles.entities[t];return O?{type:"DatabaseRole",value:O}:null}function Ta(e,t,a,r){var i,s,c,u,m,p,v,b,E;void 0===r&&(r=null);var D={urn:N.X6.getQueryUrn(t),queryId:null===(i=a.queryId)||void 0===i?void 0:i.toString(),name:a.queryName,mExpression:a.mExpression,sqlExpression:a.sqlExpression,updatedAt:a.updatedAt,objectType:"Query",warehouseId:e,canEdit:!1,isHidden:!1,sqlGridResultIds:[],state:3,clientExecutionStartTime:a.clientExecutionStartTime,sqlResultPaneSelectedView:"messages",sqlResultsPaneMessageIds:[],startLineNumber:null!==(s=a.startLineNumber)&&void 0!==s?s:1,type:_.isEmpty(a.mExpression)?0:1,isSaving:!1,clientUniqueId:t,badge:0,isShared:a.isShared,ownerUserObjectId:a.ownerUserObjectId,columns:[]};return 0===D.type&&(D.editorContext=null!==(c=r?.editorContext)&&void 0!==c?c:new Lr,D.isResultGridVisible=null!==(u=r?.isResultGridVisible)&&void 0!==u?u:a.isResultGridVisible,D.isQueryCanceled=null!==(m=r?.isQueryCanceled)&&void 0!==m?m:a.isQueryCanceled,D.isQueryExecuting=null!==(p=r?.isQueryExecuting)&&void 0!==p?p:a.isQueryExecuting,D.sqlGridResultIds=null!==(v=r?.sqlGridResultIds)&&void 0!==v?v:[],D.sqlResultsPaneMessageIds=null!==(b=r?.sqlResultsPaneMessageIds)&&void 0!==b?b:[],D.sqlResultPaneSelectedView=null!==(E=r?.sqlResultPaneSelectedView)&&void 0!==E?E:D.sqlResultPaneSelectedView),D}function Le(e,t,a,r){void 0===r&&(r=!1);var i=Wt(),s={sqlExpression:void 0,name:t,canEdit:!1,isHidden:!1,warehouseId:e,mExpression:void 0,objectType:"Query",urn:N.X6.getQueryUrn(i),queryId:"",updatedAt:"",sqlGridResultIds:[],state:0,sqlResultPaneSelectedView:"messages",sqlResultsPaneMessageIds:[],type:a,clientUniqueId:i,isShared:r,columns:[]};return 0===a&&(s.editorContext=new Lr,s.isResultGridVisible=!1,s.isQueryCanceled=!1,s.isQueryExecuting=!1),s}function wa(){return{name:"Queries",canEdit:!1,objectType:"Category",childrenUrns:new Set,isHidden:!1,urn:"Queries",warehouseMetadata:void 0}}function Wt(){var e="",t=0;for(t=0;t<32;t+=1){var a=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=a.toString(16)}return e}function ie(e,t){return e+"/"+t}var ye=g(8894),bc=g(4301),Kt="dbo";function Nt(e){return e.replace(/]/g,"]]")}var Kr=function(e){return e[e.informational=0]="informational",e[e.warning=1]="warning",e[e.error=2]="error",e}({}),Oc=function(e){return e.CapacityLimitExceeded="CapacityLimitExceeded",e.CapacityNotActive="CapacityNotActive",e.DmsBatchNotFound="DmsBatchNotFound",e.OperationCanceled="OperationCanceled",e.DmsImportDatabaseException="DmsImportDatabaseException",e.SqlMwcTokenSizeLimitExceededException="SqlMwcTokenSizeLimitExceededException",e}({}),Ra="[Datamart Datahub Dialog]",Tc=((0,n.PH)("".concat(Ra," Create Datahub")),(0,n.PH)("".concat(Ra," Add Warehouse to OE"),(0,n.Ky)())),$=((0,n.PH)("".concat(Ra," Error while trying to show datahub dialog"),(0,n.Ky)()),"[Datamart Field List]"),wc=((0,n.PH)("".concat($," Select Table"),(0,n.Ky)()),(0,n.PH)("".concat($," Unselect Table"),(0,n.Ky)()),(0,n.PH)("".concat($," Select Multiple Tables"),(0,n.Ky)()),(0,n.PH)("".concat($," Select Top 100 rows"),(0,n.Ky)())),Rc=((0,n.PH)("".concat($," Select Multiple Columns"),(0,n.Ky)()),(0,n.PH)("".concat($," Expand Table Category")),(0,n.PH)("".concat($," Cancel preview data query")),(0,n.PH)("".concat($," Preview selected table data"),(0,n.Ky)())),Mc=(0,n.PH)("".concat($," Preview Data Success"),(0,n.Ky)()),Ac=(0,n.PH)("".concat($," Preview Data Failure"),(0,n.Ky)()),Nc=(0,n.PH)("".concat($," display Query Error message on Preview Data"),(0,n.Ky)()),xc=((0,n.PH)("".concat($," Collapse Table Category")),(0,n.PH)("".concat($," Expand Table"),(0,n.Ky)()),(0,n.PH)("".concat($," Collapse Table"),(0,n.Ky)()),(0,n.PH)("".concat($," Select Column"),(0,n.Ky)()),(0,n.PH)("".concat($," Unselect Column"),(0,n.Ky)()),(0,n.PH)("".concat($," New Measure"),(0,n.Ky)()),(0,n.PH)("".concat($," Create Default Function"),(0,n.Ky)())),jc=(0,n.PH)("".concat($," Create Default Schema"),(0,n.Ky)()),Bc=(0,n.PH)("".concat($," Create Default Stored Proc"),(0,n.Ky)()),kc=(0,n.PH)("".concat($," Create Default Table"),(0,n.Ky)()),qc=(0,n.PH)("".concat($," Create Default View"),(0,n.Ky)()),Lc=(0,n.PH)("".concat($," Create Table as Select"),(0,n.Ky)()),Fc=((0,n.PH)("".concat($," Drop Database Object"),(0,n.Ky)()),(0,n.PH)("".concat($," Show Incremental Refresh"),(0,n.Ky)()),(0,n.PH)("".concat($," Edit Table")),(0,n.PH)("".concat($," On Add Remove Tables To BI"),(0,n.Ky)()),(0,n.PH)("".concat($," Add or remove operation in BI model Succeeded"),(0,n.Ky)())),Uc=(0,n.PH)("".concat($," Add or remove operation in BI model failed"),(0,n.Ky)()),Ma=(0,n.PH)("".concat($," Schema updated after add/remove object operation"),(0,n.Ky)()),Hc=((0,n.PH)("".concat($," On expanded node"),(0,n.Ky)()),(0,n.PH)("".concat($," Load schema succeeded"),(0,n.Ky)())),Vc=(0,n.PH)("".concat($," Load schema failed"),(0,n.Ky)()),Qc=(0,n.PH)("".concat($," Sql create script"),(0,n.Ky)()),Wc=(0,n.PH)("".concat($," Alter Stored Procedure or View"),(0,n.Ky)()),Kc=((0,n.PH)("".concat($," Sql drop script"),(0,n.Ky)()),(0,n.PH)("".concat($," Sql drop create script"),(0,n.Ky)())),zc=(0,n.PH)("".concat($," New sql script"),(0,n.Ky)()),Gc=(0,n.PH)("".concat($," Sql script generation failed"),(0,n.Ky)()),$c=(0,n.PH)("".concat($," Object refresh"),(0,n.Ky)()),Xc=(0,n.PH)("".concat($," object refresh succeeded"),(0,n.Ky)()),Zc=(0,n.PH)("".concat($," Object refresh failed"),(0,n.Ky)()),De=((0,n.PH)("".concat($," Open Filepath Properties"),(0,n.Ky)()),(0,n.PH)("".concat($," On field list search triggered")),(0,n.PH)("".concat($," on drag start to monaco editor")),(0,n.PH)("".concat($," on drag end to monaco editor"),(0,n.Ky)()),(0,n.PH)("".concat($," Export Datawarehouse")),"[Mashup Editor]"),Jc=((0,n.PH)("".concat(De," Launch Mashup Editor Dialog"),(0,n.Ky)()),(0,n.PH)("".concat(De," Recover mashup"),(0,n.Ky)()),(0,n.PH)("".concat(De," Hide mashup dialog"))),Aa=(0,n.PH)("".concat(De," Save Visual Query Transformation"),(0,n.Ky)()),Yc=(0,n.PH)("".concat(De," View SQL from Visual Query")),ed=((0,n.PH)("".concat(De," Save as Table from Visual Query")),(0,n.PH)("".concat(De," Save Query as View from Visual Query")),(0,n.PH)("".concat(De," Set Mashup Editor Dialog"),(0,n.Ky)())),td=(0,n.PH)("".concat(De," Unblock Interaction for Mashup Client UI")),ad=(0,n.PH)("".concat(De," Added Query to Mashup Client Call Completed")),rd=(0,n.PH)("".concat(De," Mashup Client is Ready")),zr=(0,n.PH)("".concat(De," Set Visual Query Mashup Editor Dialog"),(0,n.Ky)()),nd=(0,n.PH)("".concat(De," Effects Initialized"),(0,n.Ky)()),Gr=(0,n.PH)("".concat(De," PQO Drag and Drop Table in Query Designer"),(0,n.Ky)()),$r=(0,n.PH)("".concat(De," Drag and Drop Table in Query Designer"),(0,n.Ky)()),id=((0,n.PH)("".concat(De," Save Mashup Query in Query Designer")),(0,n.PH)("".concat(De," Access Token Will Expire Soon"))),sd=((0,n.PH)("".concat(De," Mwc Token Acquire Failed"),(0,n.Ky)()),(0,n.PH)("".concat(De," No View As Roles are Selected"))),T=((0,n.PH)("".concat(De," On view selected"),(0,n.Ky)()),"[Datamart Model]"),od=(0,n.PH)("".concat(T," Load datamart"),(0,n.Ky)()),cd=(0,n.PH)("".concat(T," Load datamart from cache"),(0,n.Ky)()),dd=(0,n.PH)("".concat(T," Close Datamart Editor"),(0,n.Ky)()),ud=(0,n.PH)("".concat(T," Load datamart and editor from cache"),(0,n.Ky)()),ld=(0,n.PH)("".concat(T," Load datamart information succeeded"),(0,n.Ky)()),md=((0,n.PH)("".concat(T," informationCallSuccedded"),(0,n.Ky)()),(0,n.PH)("".concat(T," Load datamart schema succeeded"),(0,n.Ky)())),pd=(0,n.PH)("".concat(T," Load datamart queries succeeded"),(0,n.Ky)()),vd=(0,n.PH)("".concat(T," Load datamart information failed"),(0,n.Ky)()),fd=(0,n.PH)("".concat(T," Load datamart schema failed"),(0,n.Ky)()),hd=(0,n.PH)("".concat(T," Cache Load datamart error"),(0,n.Ky)()),gd=(0,n.PH)("".concat(T," Load datamart queries failed"),(0,n.Ky)()),bd=((0,n.PH)("".concat(T," Handle newly loaded datamart history failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," Initialize modeling service succeeded"))),yd=((0,n.PH)("".concat(T," Initialize modeling view succeeded")),(0,n.PH)("".concat(T," Initialize modeling service failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," First Modeling service modelChanged has been ignored"))),Dd=(0,n.PH)("".concat(T," Datahub show tables side pane opened"),(0,n.Ky)()),Na=(0,n.PH)("".concat(T," Get datamart schema succeeded"),(0,n.Ky)()),_d=(0,n.PH)("".concat(T," Auto refreshing datamart schema"),(0,n.Ky)()),Xr=(0,n.PH)("".concat(T," Auto refresh latest datamart schema success"),(0,n.Ky)()),Sd=(0,n.PH)("".concat(T,"  Auto refresh latest datamart schema failed"),(0,n.Ky)()),Id=(0,n.PH)("".concat(T," Load datamart version success"),(0,n.Ky)()),Ed=(0,n.PH)("".concat(T," Set Copilot Capability"),(0,n.Ky)()),Pd=(0,n.PH)("".concat(T,"  Started metadata sync on run query success but no change to datamart version"),(0,n.Ky)()),Zr=(0,n.PH)("".concat(T,"  Started metadata sync on run query success and got new datamart version and schema"),(0,n.Ky)()),Cd=(0,n.PH)("".concat(T,"  Error during autoRefreshFromQueryExecution$"),(0,n.Ky)()),xa=(0,n.PH)("".concat(T," Get datamart schema failed"),(0,n.Ky)()),Od=(0,n.PH)("".concat(T," Get datahub schema succeeded"),(0,n.Ky)()),Td=(0,n.PH)("".concat(T," Exit datamart")),wd=(0,n.PH)("".concat(T," Save Datamart"),(0,n.Ky)()),Rd=(0,n.PH)("".concat(T," Tracking newly loaded datamart's refresh"),(0,n.Ky)()),Md=(0,n.PH)("".concat(T," Starting update step"),(0,n.Ky)()),Ad=(0,n.PH)("".concat(T," Completed update step"),(0,n.Ky)()),Nd=(0,n.PH)("".concat(T," Tracking datamart refresh batch request"),(0,n.Ky)()),xd=(0,n.PH)("".concat(T," Poll datamart refresh success"),(0,n.Ky)()),jd=(0,n.PH)("".concat(T," Save Datamart succeeded"),(0,n.Ky)()),Bd=(0,n.PH)("".concat(T," Save Datamart failed"),(0,n.Ky)()),kd=((0,n.PH)("".concat(T," Cancel saving the datamart")),(0,n.PH)("".concat(T," Cancel refreshing the datamart succeeded"))),qd=(0,n.PH)("".concat(T," Cancel refreshing the datamart failed"),(0,n.Ky)()),Ld=((0,n.PH)("".concat(T," Rename datamart"),(0,n.Ky)()),(0,n.PH)("".concat(T," Update Datamart"),(0,n.Ky)()),(0,n.PH)("".concat(T," Delete Measure"),(0,n.Ky)()),(0,n.PH)("".concat(T," Unrecoverable failure")),(0,n.PH)("".concat(T," Set is hidden"),(0,n.Ky)())),Fd=(0,n.PH)("".concat(T," Unhide all items")),Ud=(0,n.PH)("".concat(T," get lease succeeded"),(0,n.Ky)()),Hd=(0,n.PH)("".concat(T," extend lease"),(0,n.Ky)()),Vd=(0,n.PH)("".concat(T," Set View As Roles"),(0,n.Ky)()),Qd=(0,n.PH)("".concat(T," Datamart effects are loaded"),(0,n.Ky)()),Wd=(0,n.PH)("".concat(T," Selected"),(0,n.Ky)()),Kd=(0,n.PH)("".concat(T," Deselected"),(0,n.Ky)()),zd=(0,n.PH)("".concat(T," Selected All"),(0,n.Ky)()),Gd=(0,n.PH)("".concat(T," Cleared Selections")),$d=(0,n.PH)("".concat(T," Suspended Notifications")),Xd=(0,n.PH)("".concat(T," Resumed Notifications")),Zd=(0,n.PH)("".concat(T," Sync Succeeded"),(0,n.Ky)()),Jd=(0,n.PH)("".concat(T," Sync failed"),(0,n.Ky)()),Yd=((0,n.PH)("".concat(T," Sql lanuage service requests to load warehouse"),(0,n.Ky)()),(0,n.PH)("".concat(T," Add Warehouse to OE succeeded"),(0,n.Ky)())),eu=((0,n.PH)("".concat(T," Add Warehouse to OE failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," Remove Warehouse from Field List"),(0,n.Ky)())),tu=((0,n.PH)("".concat(T," Manage Dataset From Message Bar")),(0,n.PH)("".concat(T," Dismiss Datamart Info Message Bar")),(0,n.PH)("".concat(T," Set Read Only Mode"),(0,n.Ky)())),au=((0,n.PH)("".concat(T," On view changed"),(0,n.Ky)()),(0,n.PH)("".concat(T," On action error"))),ru=((0,n.PH)("".concat(T," Load Datamart Sample"),(0,n.Ky)()),(0,n.PH)("".concat(T," Load Datamart Sample started"),(0,n.Ky)())),nu=((0,n.PH)("".concat(T," Load Datamart Sample failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," Load Datamart Sample Lock Conflict Error"),(0,n.Ky)()),(0,n.PH)("".concat(T," Load Sample Polling Success"),(0,n.Ky)())),iu=(0,n.PH)("".concat(T," Get Datamart Schema For Search"),(0,n.Ky)()),su=(0,n.PH)("".concat(T," Get Datamart Schema For Search succeeded"),(0,n.Ky)()),ou=(0,n.PH)("".concat(T," Get Datamart Schema For Search failed"),(0,n.Ky)()),cu=(0,n.PH)("".concat(T," On shouldTryToLoadIncrementally returns true"),(0,n.Ky)()),du=(0,n.PH)("".concat(T," OneLake Filepath Success"),(0,n.Ky)()),uu=((0,n.PH)("".concat(T," OneLake Filepath Retry"),(0,n.Ky)()),(0,n.PH)("".concat(T," OneLake Filepath Error"),(0,n.Ky)()),(0,n.PH)("".concat(T," Field list object filter toggle"),(0,n.Ky)())),lu=(0,n.PH)("".concat(T," Field list object filter clear all")),mu=((0,n.PH)("".concat(T," Show datamart side panel"),(0,n.Ky)()),(0,n.PH)("".concat(T," Fetch mwc token success"),(0,n.Ky)())),pu=(0,n.PH)("".concat(T," Http request using an mwc token returned with a 404")),vu=((0,n.PH)("".concat(T," On clone table"),(0,n.Ky)()),(0,n.PH)("".concat(T," Clone table success"),(0,n.Ky)())),fu=((0,n.PH)("".concat(T," Clone table error"),(0,n.Ky)()),(0,n.PH)("".concat(T," Activate Copilot"))),hu=(0,n.PH)("".concat(T," Deactivate Copilot")),gu=(0,n.PH)("".concat(T," Toggle Copilot")),bu=((0,n.PH)("".concat(T," Share datamart")),(0,n.PH)("".concat(T," Share datamart error"),(0,n.Ky)()),(0,n.PH)("".concat(T," Export Datawarehouse failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," Export Datawarehouse Success")),(0,n.PH)("".concat(T," Import Datawarehouse")),(0,n.PH)("".concat(T," Import Datawarehouse Started"),(0,n.Ky)()),(0,n.PH)("".concat(T," Import Datawarehouse in Progress"),(0,n.Ky)())),yu=(0,n.PH)("".concat(T," Import Datawarehouse Polling Success"),(0,n.Ky)()),Du=(0,n.PH)("".concat(T," Import Datawarehouse Success"),(0,n.Ky)()),_u=((0,n.PH)("".concat(T," Import Datawarehouse Failed"),(0,n.Ky)()),(0,n.PH)("".concat(T," Import Datawarehouse Exception"),(0,n.Ky)()),(0,n.PH)("".concat(T," Cancel importing the datawarehouse")),(0,n.PH)("".concat(T," Cancel importing the datawarehouse succeeded"))),ne=((0,n.PH)("".concat(T," Cancel importing the datawarehouse failed"),(0,n.Ky)()),"[Datamart Query Editor]"),Su=(0,n.PH)("".concat(ne," Initialize Query Editor"),(0,n.Ky)()),Iu=(0,n.PH)("".concat(ne," Set Query Name"),(0,n.Ky)()),Eu=(0,n.PH)("".concat(ne," Set Query Status to Saved")),Pu=(0,n.PH)("".concat(ne," Save Query"),(0,n.Ky)()),Cu=(0,n.PH)("".concat(ne," Discard Query")),Ou=(0,n.PH)("".concat(ne," Add or Update Session Query"),(0,n.Ky)()),Tu=((0,n.PH)("".concat(ne," On save query as view"),(0,n.Ky)()),(0,n.PH)("".concat(ne," On explain query"))),wu=(0,n.PH)("".concat(ne," On fix query"),(0,n.Ky)()),Ru=((0,n.PH)("".concat(ne," Open In Excel From Visual Designer"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Open query selection confirm dialog"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Transform Data from Visual Designer"))),Mu=(0,n.PH)("".concat(ne," Add generated Transient Model to cache"),(0,n.Ky)()),Au=((0,n.PH)("".concat(ne," Open visual result")),(0,n.PH)("".concat(ne," Open data explore"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result save as report"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result save report failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result save report succeeded"),(0,n.Ky)())),Nu=((0,n.PH)("".concat(ne," Launch Sql View of Visual Query"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result cancel save report")),(0,n.PH)("".concat(ne," Visual result discover datasources failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," save a view failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result save your report"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result discover datasources failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," get schemas from executeSql failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Visual result generate model failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Load visual result success"),(0,n.Ky)()),(0,n.PH)("".concat(ne," Validate datamart mashup failed"),(0,n.Ky)()),(0,n.PH)("".concat(ne," save as view succeeded"),(0,n.Ky)())),xu=((0,n.PH)("".concat(ne," cancel save as view")),(0,n.PH)("".concat(ne," save as view succeeded")),(0,n.PH)("".concat(ne," Explain query succeeded"),(0,n.Ky)())),ju=(0,n.PH)("".concat(ne," Explain query failed"),(0,n.Ky)()),Bu=(0,n.PH)("".concat(ne," Fix query succeeded"),(0,n.Ky)()),ku=(0,n.PH)("".concat(ne," Fix query failed"),(0,n.Ky)()),qu=(0,n.PH)("".concat(ne," Begin auto completion")),Lu=(0,n.PH)("".concat(ne," End auto completion")),oe="[Datamart Query]",Fu=((0,n.PH)("".concat(oe," Create query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Create query succeeded"),(0,n.Ky)())),Uu=((0,n.PH)("".concat(oe," Create query failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Update Query"),(0,n.Ky)())),Hu=(0,n.PH)("".concat(oe," Update Query Succeeded"),(0,n.Ky)()),Vu=((0,n.PH)("".concat(oe," Update Query Failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Update Query Conflict Error"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Rename query on client side"),(0,n.Ky)())),Qu=(0,n.PH)("".concat(oe," Rename query"),(0,n.Ky)()),Wu=(0,n.PH)("".concat(oe," Rename query succeeded"),(0,n.Ky)()),Ku=((0,n.PH)("".concat(oe," Rename query failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Rename query conflict error"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Update query shared status"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Update query shared status success"),(0,n.Ky)())),zu=((0,n.PH)("".concat(oe," Update query shared status failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Delete query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Delete query succeeded"),(0,n.Ky)())),Gu=((0,n.PH)("".concat(oe," Delete query failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Get queries")),(0,n.PH)("".concat(oe," Get queries succeeded"),(0,n.Ky)())),$u=((0,n.PH)("".concat(oe," Get queries failed"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Open save query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Create draft query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Duplicate query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Editing session mashup changed")),(0,n.PH)("".concat(oe," On query Http call"),(0,n.Ky)())),Xu=((0,n.PH)("".concat(oe," Run Query")),(0,n.PH)("".concat(oe," Cancel Query"),(0,n.Ky)()),(0,n.PH)("".concat(oe," On fetch MWC token for execteSql error"),(0,n.Ky)()),(0,n.PH)("".concat(oe," Query canceled"),(0,n.Ky)())),Zu=(0,n.PH)("".concat(oe," Query cancellation failed"),(0,n.Ky)()),Ju=(0,n.PH)("".concat(oe," Query batch dispatched"),(0,n.Ky)()),W="[Datamart Ribbon]",Yu=((0,n.PH)("".concat(W," Get Data")),(0,n.PH)("".concat(W," New Data Pipeline")),(0,n.PH)("".concat(W," New Dataflow Gen 2")),(0,n.PH)("".concat(W," Transform Data")),(0,n.PH)("".concat(W," Enter Data")),(0,n.PH)("".concat(W," Refresh")),(0,n.PH)("".concat(W," Manage Roles")),(0,n.PH)("".concat(W," View As Roles")),(0,n.PH)("".concat(W," Copy Tds Endpoint")),(0,n.PH)("".concat(W," New report")),(0,n.PH)("".concat(W," New Column")),(0,n.PH)("".concat(W," On query tab added."),(0,n.Ky)())),el=((0,n.PH)("".concat(W," New Measure"),(0,n.Ky)()),(0,n.PH)("".concat(W," Create Hierarchy"),(0,n.Ky)()),(0,n.PH)("".concat(W," Create Report"),(0,n.Ky)())),tl=((0,n.PH)("".concat(W," Table Name"),(0,n.Ky)()),(0,n.PH)("".concat(W," Column Name"),(0,n.Ky)()),(0,n.PH)("".concat(W," Measure Name"),(0,n.Ky)()),(0,n.PH)("".concat(W," Enable Column Profile"),(0,n.Ky)()),(0,n.PH)("".concat(W," Show Column Quality Details"),(0,n.Ky)()),(0,n.PH)("".concat(W," Show Column Value Distribution"),(0,n.Ky)()),(0,n.PH)("".concat(W," Show Column Profile In Details"),(0,n.Ky)()),(0,n.PH)("".concat(W," Run Query")),(0,n.PH)("".concat(W," Cancel Query"),(0,n.Ky)()),(0,n.PH)("".concat(W," Save Query"),(0,n.Ky)()),(0,n.PH)("".concat(W," Discard Query"),(0,n.Ky)()),(0,n.PH)("".concat(W," Show Incremental Refresh"),(0,n.Ky)()),(0,n.PH)("".concat(W," New Dataset")),(0,n.PH)("".concat(W," Manage Dataset")),(0,n.PH)("".concat(W," Manage Dataset From New Report")),(0,n.PH)("".concat(W," Manage Dataset From Auto Update Default Dataset"),(0,n.Ky)()),(0,n.PH)("".concat(W," Add/Remove Tables To/From BI"),(0,n.Ky)())),al=((0,n.PH)("".concat(W," Add/Remove Tables To/From BI From Auto Update Dataset"),(0,n.Ky)()),(0,n.PH)("".concat(W," Add/Remove Tables/Views To/From BI operation In Progress"),(0,n.Ky)())),rl=((0,n.PH)("".concat(W," On Cancel Add/Remove Tables/Views To/From BI")),(0,n.PH)("".concat(W," On Cancel Add/Remove Tables/Views To/From BI response"),(0,n.Ky)()),(0,n.PH)("".concat(W," Add or remove operation in BI model from auto update dataset success"),(0,n.Ky)())),nl=(0,n.PH)("".concat(W," Add or remove operation in BI model from auto update dataset failed"),(0,n.Ky)()),ja=(0,n.PH)("".concat(W," Add or remove operation in BI model from manage dataset failed"),(0,n.Ky)()),il=(0,n.PH)("".concat(W," Add or remove operation in BI model from manage dataset failed with internal error"),(0,n.Ky)()),sl=((0,n.PH)("".concat(W," Automatically Update Dataset")),(0,n.PH)("".concat(W," Automatically Update Dataset Success"),(0,n.Ky)()),(0,n.PH)("".concat(W," Automatically Update Dataset failed"),(0,n.Ky)()),(0,n.PH)("".concat(W," Automatically Update Dataset failed with internal error"),(0,n.Ky)()),(0,n.PH)("".concat(W," Generate ADS Protocol By DatamartID"),(0,n.Ky)()),(0,n.PH)("".concat(W," Sync Data"))),ol=(0,n.PH)("".concat(W," Refresh From Manage Dataset")),cl=((0,n.PH)("".concat(W," On Settings Open")),(0,n.PH)("".concat(W," Export Datawarehouse")),(0,n.PH)("".concat(W," Dialog Export Datawarehouse")),(0,n.PH)("".concat(W," On Query Activity")),(0,n.PH)("".concat(W," On Create Default Table Template"),(0,n.Ky)())),dl=(0,n.PH)("".concat(W," On Create Default View Template"),(0,n.Ky)()),ul=(0,n.PH)("".concat(W," On Create Default Schema Template")),ll=(0,n.PH)("".concat(W," On Create Default Stored Procedure Template"),(0,n.Ky)()),ce="[Datamart tabs]",ml=(0,n.PH)("".concat(ce," Run SQL native script."),(0,n.Ky)()),Jr=(0,n.PH)("".concat(ce," On Editor Run Query Success"),(0,n.Ky)()),pl=((0,n.PH)("".concat(ce," On Editor Run Async Query Success"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On Async Query Finished Execution"),(0,n.Ky)())),vl=(0,n.PH)("".concat(ce," On Editor Run Query Error"),(0,n.Ky)()),fl=(0,n.PH)("".concat(ce," On SQL result selected."),(0,n.Ky)()),hl=(0,n.PH)("".concat(ce," Selected SQL query tab evaluation started.")),gl=(0,n.PH)("".concat(ce," Selected SQL query tab evaluation ended"),(0,n.Ky)()),bl=((0,n.PH)("".concat(ce," Selected SQL query tab evaluation canceled")),(0,n.PH)("".concat(ce," Query view initialized."))),yl=(0,n.PH)("".concat(ce," On query tab added."),(0,n.Ky)()),Dl=(0,n.PH)("".concat(ce," On saved query opened."),(0,n.Ky)()),_l=(0,n.PH)("".concat(ce," On saved query open refreshed."),(0,n.Ky)()),Sl=(0,n.PH)("".concat(ce," On query tab closed."),(0,n.Ky)()),Il=((0,n.PH)("".concat(ce," On unsaved-query tab closed.")),(0,n.PH)("".concat(ce," On selected query tab changed."),(0,n.Ky)())),El=(0,n.PH)("".concat(ce," Selected SQL query tab editor activated."),(0,n.Ky)()),Pl=(0,n.PH)("".concat(ce," Selected SQL query tab pane height changed."),(0,n.Ky)()),Cl=(0,n.PH)("".concat(ce," Selected SQL query tab pane is expanded/maximized."),(0,n.Ky)()),Ol=(0,n.PH)("".concat(ce," SQL query tab content changed."),(0,n.Ky)()),Tl=(0,n.PH)("".concat(ce," SQL query results pane tab view changed."),(0,n.Ky)()),wl=(0,n.PH)("".concat(ce," Visual query tab content changed."),(0,n.Ky)()),Rl=((0,n.PH)("".concat(ce," Open in excel from SQL editor"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On close tab"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On Visualize result from SQL editor"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On Visualize result from Design view editor"),(0,n.Ky)()),(0,n.PH)("".concat(ce," Query info from datamart mashup validated"),(0,n.Ky)())),Al=((0,n.PH)("".concat(ce," Save as table from SQL editor"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On save as table dialog submit"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On cancel save as table"),(0,n.Ky)()),(0,n.PH)("".concat(ce," On cancel save as table success")),(0,n.PH)("".concat(ce," On cancel save as table error"),(0,n.Ky)()),(0,n.PH)("".concat("[Datamart Incremental Refresh]"," Save Incremental Refresh"),(0,n.Ky)()));function Yr(e){return e&&"Category"===e.objectType}function Ba(e){return e&&"Schema"===e.objectType}function rt(e){return e&&"SchemaObjectContainer"===e.objectType}function zt(e){return e&&"Table"===e.objectType}function en(e){return e&&"View"===e.objectType}function tn(e){return e&&"StoredProcedure"===e.objectType}function Dt(e){return e&&"DatabaseRoleContainer"===e.objectType}function xt(e){return e&&"Column"===e.objectType}function an(e){return e&&"Measure"===e.objectType}function rn(e){return e&&(e.modelDataType===Pe.Int64||e.modelDataType===Pe.Decimal||e.modelDataType===Pe.Double)}var Ie=function(){function e(){}return e.getUniqueName=function(t,a){if(!_.find(a,function(D){return D.toLocaleLowerCase()===t.toLocaleLowerCase()}))return t;for(var s,r=/\d+/g,i=[];null!==(s=r.exec(t));){var c=s[0];i.push({value:Number.parseInt(c,void 0),prefix:t.substr(0,r.lastIndex-c.length),suffix:t.substr(r.lastIndex)})}for(var u=0,m=i=_.reverse(i);u<m.length;u++)for(var p=m[u],v=function(O){var A=p.prefix+O+p.suffix;if(!_.find(a,function(C){return C.toLocaleLowerCase()===A.toLocaleLowerCase()}))return{value:A}},b=p.value+1;b<1e6;b++){var E=v(b);if("object"==typeof E)return E.value}return this.getUniqueName(t+" (2)",a)},e}(),Ll=window,Fe="SQL query 1",ee=(0,ye.H)({selectId:function(t){return t.primaryDatamartObjectId}}),vt=(0,ye.H)({selectId:function(t){return t.id}}),Ae=(0,ye.H)({selectId:function(t){return t.id}}),nt=(0,ye.H)({selectId:function(t){return t.id}}),H=(0,ye.H)({selectId:function(t){return t.objectId}}),_t=(0,ye.H)({selectId:function(t){return t.urn}}),qe=(0,ye.H)({selectId:function(t){return t.urn}}),it=(0,ye.H)({selectId:function(t){return t.urn}}),st=(0,ye.H)({selectId:function(t){return t.urn}}),ze=(0,ye.H)({selectId:function(t){return t.urn}}),Gt=(0,ye.H)({selectId:function(t){return t.id}}),Ue=(0,ye.H)({selectId:function(t){return t.urn}}),ot=(0,ye.H)({selectId:function(t){return t.urn}}),Ge=(0,ye.H)({selectId:function(t){return t.urn}}),$e=(0,ye.H)({selectId:function(t){return t.urn}}),St=(0,ye.H)({selectId:function(t){return t.id}}),K=(0,ye.H)({selectId:function(t){return t.urn},sortComparer:function(t,a){return t.name.localeCompare(a.name)}}),He=(0,ye.H)({selectId:function(t){return t.urn}}),ft=(0,ye.H)({selectId:function(t){return t.urn}}),$t={sqlMessages:St.getInitialState(),schemas:_t.getInitialState(),schemaObjectContainers:qe.getInitialState(),sqlGridResults:Gt.getInitialState(),categories:ze.getInitialState(),tables:Ue.getInitialState(),views:ot.getInitialState(),storedProcedures:it.getInitialState(),userDefinedFunctions:st.getInitialState(),columns:Ge.getInitialState(),measures:$e.getInitialState(),queries:K.getInitialState(),refreshedEntities:vt.getInitialState(),updatingDatamartStepsProgress:Ae.getInitialState(),updatingLoadingStepsProgress:nt.getInitialState(),lakehouseModeling:void 0,datamartModeling:void 0,tridentMultitaskingDatamarts:void 0,datamarts:H.getInitialState(),warehouseCrossDbQueries:void 0,activeEditorId:void 0,executeSqlAsyncFeatureSwitch:void 0,datamartAutoRefresh:void 0,databaseRoleContainers:He.getInitialState(),databaseRoles:ft.getInitialState(),editors:ee.getInitialState(),telemetryService:void 0,isCopilotActive:!1};function Ce(e,t){return e?{selected:{queryId:e,items:new Set([N.X6.getQueryUrn(e)])}}:{selected:{queryId:void 0,items:new Set}}}function sn(e,t,a,r){for(var i=a?new Set:r.editors.entities[e].selected.items,s=0,c=t;s<c.length;s++)i.add(c[s].urn);return i}function Kl(e,t,a){var r=new Set(a.editors.entities[e].selected.items);return r.delete(t.urn),r}function on(e,t,a){var r;if(1===t.editors.entities[e].tabs.length)r=null;else if(a===t.editors.entities[e].selected.queryId){var i=t.editors.entities[e].tabs.indexOf(a);r=t.editors.entities[e].tabs[0===i?1:i-1]}else r=t.editors.entities[e].selected.queryId;var c=t.editors.entities[e].tabs;return c.splice(c.indexOf(a),1),{newSelectedId:r,tabs:c}}function Xe(e,t,a,r,i,s,c){var u=Ea(e,t,a,r,i,s),m=un(a.datamartObjectId,t),p=Array.from(u.schemaObjectContainers.values()),v=Array.from(u.databaseRoleContainers.values());if(c?.schemaObjectContainers){var b=new Set(c.schemaObjectContainers.map(function(D){return D.urn}));p.map(function(D){b.has(D.urn)&&(D.isLoaded=!0)})}if(c?.databaseRoleContainers){var E=new Set(c.databaseRoleContainers.map(function(D){return D.urn}));v.map(function(D){E.has(D.urn)&&(D.isLoaded=!0)})}return(0,o.__assign)((0,o.__assign)({},m),{databaseRoleContainers:He.upsertMany(v,t.databaseRoleContainers),databaseRoles:ft.upsertMany(Array.from(u.databaseRoles.values()),t.databaseRoles),categories:ze.upsertMany(Array.from(u.categories.values()),t.categories),schemas:_t.upsertMany(Array.from(u.schemas.values()),t.schemas),schemaObjectContainers:qe.upsertMany(p,t.schemaObjectContainers),tables:Ue.upsertMany(Array.from(u.tables.values()),t.tables),views:ot.upsertMany(Array.from(u.views.values()),t.views),storedProcedures:it.upsertMany(Array.from(u.storedProcedures.values()),t.storedProcedures),userDefinedFunctions:st.upsertMany(Array.from(u.userDefinedFunctions.values()),t.userDefinedFunctions),columns:Ge.upsertMany(Array.from(u.columns.values()),t.columns),measures:$e.upsertMany(Array.from(u.measures.values()),t.measures),queries:t.queries,datamarts:H.upsertMany(Array.from(u.datamarts.values()),t.datamarts)})}function Ze(e,t,a){var r,i,s,c,u,m,p,v,b;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:t,changes:{etlModel:null!==(s=null===(i=null===(r=_.find(a.operationInformation,Pa))||void 0===r?void 0:r.progressDetail)||void 0===i?void 0:i.dataflow)&&void 0!==s?s:e.datamarts.entities[t].etlModel,datasetInfo:null!==(c=e.datamarts.entities[t].datasetInfo)&&void 0!==c?c:null===(m=null===(u=_.find(a.operationInformation,Ca))||void 0===u?void 0:u.progressDetail)||void 0===m?void 0:m.dataset,databaseDefinition:null!==(p=e.datamarts.entities[t].databaseDefinition)&&void 0!==p?p:null===(b=null===(v=_.find(a.operationInformation,Oa))||void 0===v?void 0:v.progressDetail)||void 0===b?void 0:b.databaseDefinition}},e.datamarts)})}function ka(e,t,a){switch(t.objectType){case"Warehouse":return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:t.objectId,changes:{isObjectContainerRefreshing:a}},e.datamarts)});case"Category":return(0,o.__assign)((0,o.__assign)({},e),{categories:ze.updateOne({id:t.urn,changes:{isObjectContainerRefreshing:a}},e.categories)});case"SchemaObjectContainer":return(0,o.__assign)((0,o.__assign)({},e),{schemaObjectContainers:qe.updateOne({id:t.urn,changes:{isObjectContainerRefreshing:a}},e.schemaObjectContainers)});default:return e}}function qa(e,t,a){if(!t)return e;switch(t.objectType){case"Table":return(0,o.__assign)((0,o.__assign)({},e),{tables:Ue.updateOne({id:t.urn,changes:{generatingSqlScript:a}},e.tables)});case"View":return(0,o.__assign)((0,o.__assign)({},e),{views:ot.updateOne({id:t.urn,changes:{generatingSqlScript:a}},e.views)});case"UserDefinedFunction":return(0,o.__assign)((0,o.__assign)({},e),{userDefinedFunctions:st.updateOne({id:t.urn,changes:{generatingSqlScript:a}},e.userDefinedFunctions)});case"StoredProcedure":return(0,o.__assign)((0,o.__assign)({},e),{storedProcedures:it.updateOne({id:t.urn,changes:{generatingSqlScript:a}},e.storedProcedures)});default:return e}}function cn(e,t,a,r,i,s){var c=Dt(a)?a.childrenRoleType:void 0,u=Ea(e,t,a.warehouseMetadata,r,i,s,c),m=Array.from(u.schemaObjectContainers.values()),p=Array.from(u.databaseRoleContainers.values());switch(a.objectType){case"SchemaObjectContainer":m.map(function(v){v.urn===a.urn&&(v.isLoaded=!0)});break;case"DatabaseRoleContainer":p.map(function(v){v.urn===a.urn&&(v.isLoaded=!0)})}return{schemaObjectContainers:qe.upsertMany(m,t.schemaObjectContainers),databaseRoleContainers:He.upsertMany(p,t.databaseRoleContainers),tables:Ue.upsertMany(Array.from(u.tables.values()),t.tables),views:ot.upsertMany(Array.from(u.views.values()),t.views),storedProcedures:it.upsertMany(Array.from(u.storedProcedures.values()),t.storedProcedures),userDefinedFunctions:st.upsertMany(Array.from(u.userDefinedFunctions.values()),t.userDefinedFunctions),columns:Ge.upsertMany(Array.from(u.columns.values()),t.columns),measures:$e.upsertMany(Array.from(u.measures.values()),t.measures),databaseRoles:ft.upsertMany(Array.from(u.databaseRoles.values()),t.databaseRoles)}}function dn(e,t){return 2===e.status&&void 0!==e.state||!!t.datamarts.entities[e.objectId]&&t.datamarts.entities[e.objectId].isReadonly}function un(e,t){var a=function(e,t){var a={datamarts:[],categories:[],schemas:[],schemaObjectContainers:[],tables:[],views:[],columns:[],measures:[],storedProcedures:[],userDefinedFunctions:[],databaseRoleContainers:[],databaseRoles:[]},r=t.datamarts.entities[e];return r&&(a.datamarts.push(e),a.categories=Array.from(r.categoryUrns.values()),_.forEach(a.categories,function(i){var s,c,u=t.categories.entities[i];if(u)switch(u.name){case"Schemas":(s=a.schemas).push.apply(s,Array.from(t.categories.entities[i].childrenUrns.values()));break;case"Security":(c=a.databaseRoleContainers).push.apply(c,Array.from(t.categories.entities[i].childrenUrns.values()))}else L.fF.assertFail("Expected ".concat(i," to be a real category"))}),_.forEach(a.schemas,function(i){var s;t.schemas.entities[i]?(s=a.schemaObjectContainers).push.apply(s,Array.from(t.schemas.entities[i].schemaObjectContainersUrns.values())):L.fF.assertFail("Expected ".concat(i," to be a real schema"))}),_.forEach(a.schemaObjectContainers,function(i){var s,c,u,m,p=t.schemaObjectContainers.entities[i];switch(p?.childrenType){case"Table":(s=a.tables).push.apply(s,Array.from(p.childrenUrns.values()));break;case"View":(c=a.views).push.apply(c,Array.from(p.childrenUrns.values()));break;case"StoredProcedure":(u=a.storedProcedures).push.apply(u,Array.from(p.childrenUrns.values()));break;case"UserDefinedFunction":(m=a.userDefinedFunctions).push.apply(m,Array.from(p.childrenUrns.values()));break;default:return}}),_.forEach(a.databaseRoleContainers,function(i){var s,c=t.databaseRoleContainers.entities[i];if(c)switch(c.childrenRoleType){case"DB roles (Built-in)":case"DB roles (Custom)":(s=a.databaseRoles).push.apply(s,Array.from(c.databaseRoleUrns.values()));break;default:return}}),_.forEach(a.tables,function(i){var s,c,u=t.tables.entities[i];u&&((s=a.columns).push.apply(s,Array.from(u.columns.values())),(c=a.measures).push.apply(c,Array.from(u.measures.values())))}),_.forEach(a.views,function(i){var s,c,u=t.views.entities[i];u&&((s=a.columns).push.apply(s,Array.from(u.columns.values())),(c=a.measures).push.apply(c,Array.from(u.measures.values())))})),a}(e,t),r=function(e,t){var a={datamarts:[],categories:[],schemas:[],schemaObjectContainers:[],tables:[],views:[],columns:[],measures:[],storedProcedures:[],userDefinedFunctions:[],databaseRoleContainers:[],databaseRoles:[]},r=t.datamarts.entities[e];return r&&r.warehouseMetadata&&1===r.warehouseMetadata.datamartType&&(a.categories.push(he(e,"Tables")),_.forEach(a.categories,function(i){var s,c,u;t.categories.entities[i]?(s=a.schemas).push.apply(s,Array.from(t.categories.entities[i].childrenUrns.values())):L.fF.assertFail("Expected ".concat(i," to be a real category")),(c=a.tables).push.apply(c,Array.from(null===(u=t.categories.entities[i])||void 0===u?void 0:u.childrenUrns.values()))}),_.forEach(a.tables,function(i){var s,c,u=t.tables.entities[i];t.tables.entities[i]?(u.columns.size>0&&(s=a.columns).push.apply(s,Array.from(t.tables.entities[i].columns.values())),u.measures.size>0&&(c=a.measures).push.apply(c,Array.from(t.tables.entities[i].measures.values()))):L.fF.assertFail("Expected ".concat(i," to be a real table"))})),a}(e,t);return{datamarts:H.removeMany(a.datamarts,t.datamarts),categories:ze.removeMany(a.categories.concat(r.categories),t.categories),schemaObjectContainers:qe.removeMany(a.schemaObjectContainers,t.schemaObjectContainers),schemas:_t.removeMany(a.schemas,t.schemas),tables:Ue.removeMany(a.tables.concat(r.tables),t.tables),views:ot.removeMany(a.views,t.views),storedProcedures:it.removeMany(a.storedProcedures,t.storedProcedures),userDefinedFunctions:st.removeMany(a.userDefinedFunctions,t.userDefinedFunctions),columns:Ge.removeMany(a.columns.concat(r.columns),t.columns),measures:$e.removeMany(a.measures.concat(r.measures),t.measures),databaseRoleContainers:He.removeMany(a.databaseRoleContainers,t.databaseRoleContainers),databaseRoles:ft.removeMany(a.databaseRoles,t.databaseRoles)}}function ve(e,t){return e.entities[N.X6.getQueryUrn(t)]}function ln(e){return _.isEmpty(e)||_.isEmpty(e.trim())?null:JSON.parse(e).mashupDocument}(0,n.Lq)($t,(0,n.on)(od,function(e,t){var a=t.datamartObjectId,r=Sa(a);return(0,o.__assign)((0,o.__assign)({},e),{activeEditorId:a,editors:ee.upsertOne(r,e.editors),datamarts:H.upsertOne(Ia(a,{infoLoadState:"LOADING",queriesLoadState:"LOADING",schemaLoadState:"LOADING"}),e.datamarts)})}),(0,n.on)(hd,function(e,t){var a=t.editorId,r=t.errorMsg,i=t.errorType,s=t.errorOptions;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:a,changes:{loadingError:{errorMsg:r,errorType:i,errorOptions:s}}},e.editors)})}),(0,n.on)(ld,function(e,t){var a=t.datamartInformation;return(0,o.__assign)((0,o.__assign)({},e),{categories:ze.addOne(wa(),e.categories),datamarts:H.updateOne({id:a.objectId,changes:{isReadonly:dn(a,e),infoLoadState:"LOADED",name:a.name,urn:a.name,warehouseMetadata:{datamartType:a.datamartType,name:a.name,datamartObjectId:a.objectId,datamartVersion:void 0,artifactPermissions:a.artifactPermissions},informationCallData:{statusCode:a.statusCode,responseRequestId:a.responseRequestId,clientRequestId:a.clientRequestId}}},e.datamarts),editors:ee.updateOne({id:a.objectId,changes:{loadedWarehouseIds:[a.objectId]}},e.editors)})}),(0,n.on)(vd,function(e,t){var a=t.datamartObjectId,r=t.error;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{infoLoadState:"ERROR",informationCallData:{statusCode:r.status,responseRequestId:r.responseRequestId,clientRequestId:r.requestId}}},e.datamarts)})}),(0,n.on)(pd,function(e,t){var a=t.queries;return a?(0,o.__assign)((0,o.__assign)({},e),{queries:K.upsertMany(a.map(function(r){return Ta(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Wt(),r)}),e.queries),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{queriesLoadState:"LOADED"}},e.datamarts)}):e}),(0,n.on)(gd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{queriesLoadState:"ERROR"}},e.datamarts)})}),(0,n.on)(md,function(e,t){var a,r,i,s,c,u,m=t.schema,v=t.datamartInformation,b={datamartType:t.datamartType,name:v.name,datamartObjectId:v.objectId,datamartVersion:m.datamartVersion},E=(0,o.__assign)((0,o.__assign)({},e),function(e,t,a,r){if(!e)return t;var i=Ea(e,t,a,!1,r),s=i.categories,c=wa();return s.set(c.name,c),{databaseRoleContainers:He.upsertMany(Array.from(i.databaseRoleContainers.values()),t.databaseRoleContainers),databaseRoles:ft.upsertMany(Array.from(i.databaseRoles.values()),t.databaseRoles),categories:ze.upsertMany(Array.from(s.values()),t.categories),schemas:_t.upsertMany(Array.from(i.schemas.values()),t.schemas),schemaObjectContainers:qe.upsertMany(Array.from(i.schemaObjectContainers.values()),t.schemaObjectContainers),tables:Ue.upsertMany(Array.from(i.tables.values()),t.tables),views:ot.upsertMany(Array.from(i.views.values()),t.views),storedProcedures:it.upsertMany(Array.from(i.storedProcedures.values()),t.storedProcedures),userDefinedFunctions:st.upsertMany(Array.from(i.userDefinedFunctions.values()),t.userDefinedFunctions),columns:Ge.upsertMany(Array.from(i.columns.values()),t.columns),measures:$e.upsertMany(Array.from(i.measures.values()),t.measures),datamarts:H.upsertMany(Array.from(i.datamarts.values()),t.datamarts)}}(m,e,b,e.telemetryService));return(0,o.__assign)((0,o.__assign)({},E),{datamarts:H.updateOne({id:v.objectId,changes:{etlModel:null===(r=null===(a=_.find(m.operationInformation,Pa))||void 0===a?void 0:a.progressDetail)||void 0===r?void 0:r.dataflow,datasetInfo:null===(s=null===(i=_.find(m.operationInformation,Ca))||void 0===i?void 0:i.progressDetail)||void 0===s?void 0:s.dataset,databaseDefinition:null===(u=null===(c=_.find(m.operationInformation,Oa))||void 0===c?void 0:c.progressDetail)||void 0===u?void 0:u.databaseDefinition,schemaLoadState:"LOADED",isReadonly:dn(v,e),hasLockTimeoutException:!1}},E.datamarts)})}),(0,n.on)(Id,function(e,t){var a=t.datamartObjectId,r=t.datamartVersion,i=e.datamarts.entities[a];return(0,o.__assign)((0,o.__assign)({},e),{categories:ze.addOne(wa(),e.categories),datamarts:H.updateOne({id:a,changes:{warehouseMetadata:(0,o.__assign)((0,o.__assign)({},i.warehouseMetadata),{datamartVersion:r})}},e.datamarts)})}),(0,n.on)(fd,function(e,t){var a=t.datamartObjectId,r=t.error;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{schemaLoadState:"ERROR",hasLockTimeoutException:"SqlLockTimeoutException"===r.error.code}},e.datamarts)})}),(0,n.on)(ud,function(e,t){var a=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{activeEditorId:a,datamarts:H.updateOne({id:a,changes:{isLoadedFromCache:!0}},e.datamarts)})}),(0,n.on)(bc.nI,function(e,t){var a=t.datamartObjectId;return e.tridentMultitaskingDatamarts?(0,o.__assign)((0,o.__assign)({},e),{activeEditorId:void 0,editors:ee.removeOne(a,e.editors),datamarts:H.removeOne(a,e.datamarts)}):e}),(0,n.on)(dd,function(e,t){var a=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{activeEditorId:e.activeEditorId===a?void 0:e.activeEditorId,editors:ee.removeOne(a,e.editors)})}),(0,n.on)(cd,function(e,t){var a=t.datamartObjectId,r=Sa(a,{primaryDatamartObjectId:a,loadedWarehouseIds:[a]});return(0,o.__assign)((0,o.__assign)({},e),{activeEditorId:a,editors:ee.upsertOne(r,e.editors),datamarts:H.updateOne({id:a,changes:{isLoadedFromCache:!0}},e.datamarts)})}),(0,n.on)(ru,function(e,t){var a=t.datamartObjectId,r=[{id:ie(a,q.CreatingSampleTables),step:q.CreatingSampleTables,progress:U.InProgress},{id:ie(a,q.CopyingSampleData),step:q.CopyingSampleData,progress:U.NotStarted},{id:ie(a,q.CreatingSampleViewsSprocs),step:q.CreatingSampleViewsSprocs,progress:U.NotStarted},{id:ie(a,q.WrappingUp),step:q.WrappingUp,progress:U.NotStarted}];return(0,o.__assign)((0,o.__assign)({},e),{updatingLoadingStepsProgress:nt.setAll(r,e.updatingLoadingStepsProgress),datamarts:H.updateOne({id:a,changes:{updatingLoadingStepsProgressIds:r.map(function(i){return i.id})}},e.datamarts)})}),(0,n.on)(bu,function(e,t){var a=t.datamartObjectId,r=[{id:ie(a,q.BuildingObjects),step:q.BuildingObjects,progress:U.InProgress},{id:ie(a,q.PublishingSchema),step:q.PublishingSchema,progress:U.NotStarted},{id:ie(a,q.ImportingUserQueries),step:q.ImportingUserQueries,progress:U.NotStarted},{id:ie(a,q.WrappingUp),step:q.WrappingUp,progress:U.NotStarted}];return(0,o.__assign)((0,o.__assign)({},e),{updatingLoadingStepsProgress:nt.setAll(r,e.updatingLoadingStepsProgress),datamarts:H.updateOne({id:a,changes:{updatingLoadingStepsProgressIds:r.map(function(i){return i.id}),isWarehouseImporting:!0}},e.datamarts)})}),(0,n.on)(bd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{modelingServiceInitialized:!0}},e.datamarts)})}),(0,n.on)(yd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{modelingServiceIgnoreModelChanged:!1}},e.datamarts)})}),(0,n.on)(Od,function(e,t){var a=t.datamartObjectId,r=t.datamartName,i=t.schema,s=t.datamartType,c=(0,o.__assign)((0,o.__assign)({},e),Xe(i,e,{datamartObjectId:a,datamartType:s,name:r,datamartVersion:i.datamartVersion},e.datamarts.entities[a].fromDatahub,e.telemetryService)),u=(0,o.__assign)((0,o.__assign)({},c),Ze(c,a,i));return(0,o.__assign)((0,o.__assign)({},u),{datamarts:H.updateOne({id:a,changes:{schemaLoadState:"LOADED"}},u.datamarts)})}),(0,n.on)(Na,Ma,function(e,t){var a=t.schema,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=(0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService)),s=(0,o.__assign)((0,o.__assign)({},i),Ze(i,r,a));return(0,o.__assign)((0,o.__assign)({},s),{datamarts:H.updateOne({id:r,changes:{schemaLoadState:"LOADED",hasLockTimeoutException:!1}},s.datamarts)})}),(0,n.on)(Zd,function(e,t){var a=t.schema,r=t.datamartObjectId,i=t.filterCommand,s=(0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService,i)),c=(0,o.__assign)((0,o.__assign)({},s),Ze(s,r,a));return(0,o.__assign)((0,o.__assign)({},c),{datamarts:H.updateOne({id:r,changes:{isSyncRunning:!1}},c.datamarts)})}),(0,n.on)(Jd,function(e,t){var a=t.datamartObjectId;return a?(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{isSyncRunning:!1}},e.datamarts)}):e}),(0,n.on)(_d,function(e,t){var a=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{autoRefreshing:!0}},e.datamarts)})}),(0,n.on)(Sd,function(e,t){var a=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{autoRefreshing:!1}},e.datamarts)})}),(0,n.on)(Xr,function(e,t){var a=t.schema,r=t.datamartObjectId,i=t.filterCommand,s=(0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService,i)),c=(0,o.__assign)((0,o.__assign)({},s),Ze(s,r,a));return(0,o.__assign)((0,o.__assign)({},c),{datamarts:H.updateOne({id:r,changes:{schemaLoadState:"LOADED",autoRefreshing:!1,hasLockTimeoutException:!1}},c.datamarts)})}),(0,n.on)(Zr,function(e,t){var a=t.schema,r=t.datamartObjectId,i=t.filterCommand,s=(0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService,i)),c=(0,o.__assign)((0,o.__assign)({},s),Ze(s,r,a));return(0,o.__assign)({},c)}),(0,n.on)(Tu,function(e){var t=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:t.urn,changes:{isExplainQueryRunning:!0,isLLMChatExecuting:!0}},e.queries)})}),(0,n.on)(wu,function(e){var t=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:t.urn,changes:{isFixRunning:!0,isLLMChatExecuting:!0}},e.queries)})}),(0,n.on)(xu,Bu,ju,ku,function(e,t){var r=e.queries.entities[N.X6.getQueryUrn(t.queryId)];return r?(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r.urn,changes:{isExplainQueryRunning:!1,isFixRunning:!1,isLLMChatExecuting:!1}},e.queries)}):e}),(0,n.on)(Jr,Nu,vu,function(e,t){return function(e){var t,a,r,i=null===(a=null===(t=e.userOperationsBatchResponse)||void 0===t?void 0:t.operationInformation)||void 0===a?void 0:a[0];if(i&&Fr(i))return(null===(r=i.progressDetail)||void 0===r?void 0:r.results)&&null!=_.find(i.progressDetail.results,function(s){return"shouldRefresh"===s.resultType})}(t.sqlResponse)&&e.datamartAutoRefresh?(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.map(function(r){return(0,o.__assign)((0,o.__assign)({},r),{autoRefreshingFromQueryExecution:!0})},e.datamarts)}):e}),(0,n.on)(Pd,Zr,Cd,function(e,t){var a=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a,changes:{autoRefreshingFromQueryExecution:!1}},e.datamarts)})}),(0,n.on)(xa,function(e,t){var a,r=t.datamartObjectId,i=t.error;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:r,changes:{schemaLoadState:"ERROR",hasLockTimeoutException:"SqlLockTimeoutException"===(null===(a=i.error)||void 0===a?void 0:a.code)}},e.datamarts)})}),(0,n.on)(sl,function(e){return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.map(function(t){return(0,o.__assign)((0,o.__assign)({},t),{isSyncRunning:!0})},e.datamarts)})}),(0,n.on)(Tc,function(e,t){var r=t.datamartObjectId,i=e.editors.entities[t.editorId];return i.loadingWarehousesIds=(0,o.__spreadArray)((0,o.__spreadArray)([],i.loadingWarehousesIds,!0),[r],!1),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.upsertOne(i,e.editors),datamarts:H.upsertOne(Ia(r,{infoLoadState:"LOADING",schemaLoadState:"LOADING"}),e.datamarts)})}),(0,n.on)(eu,function(e,t){var a=t.warehouse;return(0,o.__assign)((0,o.__assign)((0,o.__assign)({},e),un(a.objectId,e)),{editors:ee.updateOne({id:e.activeEditorId,changes:{loadedWarehouseIds:e.editors.entities[e.activeEditorId].loadedWarehouseIds.filter(function(r){return r!==a.objectId})}},e.editors)})}),(0,n.on)(wd,function(e){var t=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,a=[{id:ie(t,q.ValidatingMashup),step:q.ValidatingMashup,progress:U.NotStarted},{id:ie(t,q.BuildingDataflow),step:q.BuildingDataflow,progress:U.NotStarted},{id:ie(t,q.BuildingDataflowRelationships),step:q.BuildingDataflowRelationships,progress:U.NotStarted},{id:ie(t,q.RequestingDatamartRefresh),step:q.RequestingDatamartRefresh,progress:U.NotStarted},{id:ie(t,q.ImportingData),step:q.ImportingData,progress:U.NotStarted},{id:ie(t,q.WrappingUp),step:q.WrappingUp,progress:U.NotStarted}];return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.setAll(a,e.updatingDatamartStepsProgress),datamarts:H.updateOne({id:t,changes:{updatingDatamartStepsProgressIds:a.map(function(r){return r.id})}},e.datamarts)})}),(0,n.on)(Rd,function(e,t){var a=t.batchId,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=[{id:ie(r,q.ImportingData),step:q.ImportingData,progress:U.InProgress},{id:ie(r,q.WrappingUp),step:q.WrappingUp,progress:U.NotStarted}];return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.setAll(i,e.updatingDatamartStepsProgress),datamarts:H.updateOne({id:r,changes:{updatingDatamartStepsProgressIds:i.map(function(s){return s.id}),refreshingDatamartBatchId:a}},e.datamarts)})}),(0,n.on)(Al,function(e){var t=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,a=[{id:ie(t,q.UpdatingDataflow),step:q.UpdatingDataflow,progress:U.NotStarted},{id:ie(t,q.RequestingDatamartRefresh),step:q.RequestingDatamartRefresh,progress:U.NotStarted},{id:ie(t,q.ImportingData),step:q.ImportingData,progress:U.NotStarted},{id:ie(t,q.WrappingUp),step:q.WrappingUp,progress:U.NotStarted}];return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.setAll(a,e.updatingDatamartStepsProgress),datamarts:H.updateOne({id:t,changes:{updatingDatamartStepsProgressIds:a.map(function(r){return r.id})}},e.datamarts)})}),(0,n.on)(Nd,function(e,t){var a=t.batchId,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.updateOne({id:ie(r,q.ImportingData),changes:{progress:U.InProgress}},e.updatingDatamartStepsProgress),datamarts:H.updateOne({id:r,changes:{refreshingDatamartBatchId:a}},e.datamarts)})}),(0,n.on)(Md,function(e,t){var a=t.step,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.updateOne({id:ie(r,a),changes:{progress:U.InProgress}},e.updatingDatamartStepsProgress)})}),(0,n.on)(Ad,function(e,t){var a=t.step,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.updateOne({id:ie(r,a),changes:{progress:U.Complete}},e.updatingDatamartStepsProgress)})}),(0,n.on)(yu,function(e,t){var a=t.response,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=_.find(a.operationInformation,cc);if(!i||!i.progressDetail)return e;var s=i.progressDetail.totalDatabaseObjectsForImport,c=i.progressDetail.databaseObjectsImportedSuccessfully;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:r,changes:{isWarehouseImporting:!0,importingWarehouseBatchId:a.batchId}},e.datamarts),updatingLoadingStepsProgress:nt.updateMany([{id:ie(r,q.BuildingObjects),changes:{progress:c===s?U.Complete:U.InProgress}},{id:ie(r,q.PublishingSchema),changes:{progress:i.progressDetail.schemasPublished?U.Complete:c===s?U.InProgress:U.NotStarted}},{id:ie(r,q.ImportingUserQueries),changes:{progress:i.progressDetail.userQueriesImported?U.Complete:i.progressDetail.schemasPublished?U.InProgress:U.NotStarted}},{id:ie(r,q.WrappingUp),changes:{progress:c===s&&i.progressDetail.schemasPublished&&i.progressDetail.userQueriesImported?U.Complete:U.NotStarted}}],e.updatingLoadingStepsProgress)})}),(0,n.on)(nu,function(e,t){var r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=_.find(t.response.operationInformation,Fr);if(i&&i.progressDetail.results){var s=_.filter(i.progressDetail.results,function(c){return"operationMessage"===c.resultType});return(0,o.__assign)((0,o.__assign)({},e),{updatingLoadingStepsProgress:nt.updateMany([{id:ie(r,q.CreatingSampleTables),changes:{progress:s.length>1?U.Complete:U.InProgress}},{id:ie(r,q.CopyingSampleData),changes:{progress:s.length>2?U.Complete:2===s.length?U.InProgress:U.NotStarted}},{id:ie(r,q.CreatingSampleViewsSprocs),changes:{progress:s.length>3?U.Complete:3===s.length?U.InProgress:U.NotStarted}},{id:ie(r,q.WrappingUp),changes:{progress:s.length>4?U.Complete:4===s.length?U.InProgress:U.NotStarted}}],e.updatingLoadingStepsProgress)})}return e}),(0,n.on)(xd,function(e,t){var r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=_.find(t.batchResponse.operationInformation,sc);if(!i||!i.progressDetail)return e;var s=function(e,t){var a,r=null!==(a=t.refreshedEntities)&&void 0!==a?a:[];return r.forEach(function(i){return i.id=function(e,t){return e+"/"+t.entityName}(e,i)}),r}(r,i.progressDetail),c=s?.find(function(u){return"notStarted"===u.progressState||"inProgress"===u.progressState});return(0,o.__assign)((0,o.__assign)({},e),{refreshedEntities:vt.setAll(s,e.refreshedEntities),datamarts:H.updateOne({id:r,changes:{refreshedEntityIds:s.map(function(u){return u.id})}},e.datamarts),updatingDatamartStepsProgress:Ae.updateMany([{id:ie(r,q.ImportingData),changes:{progress:c?U.InProgress:U.Complete}},{id:ie(r,q.WrappingUp),changes:{progress:c?U.NotStarted:U.InProgress}}],e.updatingDatamartStepsProgress)})}),(0,n.on)(jd,function(e,t){var a=t.schema,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService)),{updatingDatamartStepsProgress:Ae.getInitialState(),refreshedEntities:vt.getInitialState()}),s=(0,o.__assign)((0,o.__assign)({},i),Ze(i,r,a));return(0,o.__assign)((0,o.__assign)({},s),{datamarts:H.updateOne({id:r,changes:{refreshedEntityIds:[],updatingDatamartStepsProgressIds:[],refreshingDatamartBatchId:void 0}},s.datamarts)})}),(0,n.on)(Bd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.getInitialState(),refreshedEntities:vt.getInitialState(),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{refreshedEntityIds:[],updatingDatamartStepsProgressIds:[],refreshingDatamartBatchId:void 0}},e.datamarts)})}),(0,n.on)(kd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.getInitialState(),refreshedEntities:vt.getInitialState(),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{refreshedEntityIds:[],updatingDatamartStepsProgressIds:[],refreshingDatamartBatchId:void 0}},e.datamarts)})}),(0,n.on)(Du,function(e){return(0,o.__assign)((0,o.__assign)({},e),{updatingLoadingStepsProgresss:nt.getInitialState(),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{updatingLoadingStepsProgressIds:[],importingWarehouseBatchId:void 0,isWarehouseImporting:!1}},e.datamarts)})}),(0,n.on)(_u,function(e){return(0,o.__assign)((0,o.__assign)({},e),{updatingLoadingStepsProgresss:nt.getInitialState(),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{updatingLoadingStepsProgressIds:[],importingWarehouseBatchId:void 0,isWarehouseImporting:!1}},e.datamarts)})}),(0,n.on)(qd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{updatingDatamartStepsProgress:Ae.getInitialState(),refreshedEntities:vt.getInitialState(),datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{refreshedEntityIds:[],updatingDatamartStepsProgressIds:[],refreshingDatamartBatchId:void 0}},e.datamarts)})}),(0,n.on)(Fd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{tables:Ue.updateMany(uc(e),e.tables),columns:Ge.updateMany(lc(e),e.columns),measures:$e.updateMany(mc(e),e.measures)})}),(0,n.on)(Ld,function(e,t){var i=function(e,t,a){return{type:Ur(e,t).type,update:{id:t,changes:{isHidden:a}}}}(e,t.urn,t.hidden);switch(i.type){case"Table":return(0,o.__assign)((0,o.__assign)({},e),{tables:Ue.updateOne(i.update,e.tables)});case"Column":return(0,o.__assign)((0,o.__assign)({},e),{columns:Ge.updateOne(i.update,e.columns)});case"Measure":return(0,o.__assign)((0,o.__assign)({},e),{measures:$e.updateOne(i.update,e.measures)})}}),(0,n.on)(Ed,function(e,t){var a=t.isCopilotEnabled;return(0,o.__assign)((0,o.__assign)({},e),{isCopilotEnabled:a})}),(0,n.on)(Ud,function(e,t){var a=t.leaseExpiration;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{leaseExpiration:a}},e.editors)})}),(0,n.on)(Hd,function(e,t){var a=t.extendTo;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{leaseExpiration:a}},e.editors)})}),(0,n.on)(Td,function(e){var t,a;if(e.tridentMultitaskingDatamarts){var r=ve(e.queries,null===(t=e.editors.entities[e.activeEditorId])||void 0===t?void 0:t.selected.queryId),i=null===(a=e.editors.entities[e.activeEditorId])||void 0===a?void 0:a.primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{queries:r?K.updateOne({id:r.urn,changes:{isQueryExecuting:!1,isResultGridVisible:!1}},e.queries):e.queries,activeEditorId:void 0,actionError:void 0,datamarts:i?H.updateOne({id:i,changes:{modelingServiceInitialized:!1}},e.datamarts):e.datamarts})}return(0,o.__assign)((0,o.__assign)({},$t),{lakehouseModeling:e.lakehouseModeling,datamartModeling:e.datamartModeling,warehouseCrossDbQueries:e.warehouseCrossDbQueries,telemetryService:e.telemetryService,executeSqlAsyncFeatureSwitch:e.executeSqlAsyncFeatureSwitch,datamartAutoRefresh:e.datamartAutoRefresh,tridentMultitaskingDatamarts:e.tridentMultitaskingDatamarts})}),(0,n.on)(Vd,function(e,t){var a=t.roles;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:e.editors.entities[e.activeEditorId].primaryDatamartObjectId,changes:{viewAsRoles:a}},e.datamarts),editors:ee.updateOne({id:e.activeEditorId,changes:{mwcTokenResponsePayload:void 0}},e.editors)})}),(0,n.on)(Fu,function(e,t){var a=t.query,r=N.X6.getQueryUrn(a.clientUniqueId),i=e.queries.entities[r],s=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{queries:K.upsertOne((0,o.__assign)({},Ta(s,a.clientUniqueId,a,i)),e.queries)})}),(0,n.on)(Uu,function(e,t){var i={id:N.X6.getQueryUrn(t.query.clientUniqueId),changes:{state:1}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(i,e.queries)})}),(0,n.on)(Hu,function(e,t){var a=t.query,r={id:N.X6.getQueryUrn(a.clientUniqueId),changes:{mExpression:a.mExpression,sqlExpression:a.sqlExpression,updatedAt:a.updatedAt,state:3,isSaving:!1,badge:0}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(r,e.queries)})}),(0,n.on)(Ku,function(e,t){var a=t.query,r=N.X6.getQueryUrn(a.clientUniqueId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r,changes:{isShared:a.isShared,badge:0,updatedAt:a.updatedAt}},e.queries)})}),(0,n.on)(Vu,function(e,t){var a=t.query,r=N.X6.getQueryUrn(a.clientUniqueId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r,changes:{name:a.name}},e.queries)})}),(0,n.on)(Wu,function(e,t){var a=t.query,r=N.X6.getQueryUrn(a.clientUniqueId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r,changes:{name:a.queryName,badge:0,updatedAt:a.updatedAt}},e.queries)})}),(0,n.on)(Qu,function(e,t){var r=N.X6.getQueryUrn(t.query.clientUniqueId);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r,changes:{badge:1}},e.queries)})}),(0,n.on)(zu,function(e,t){var a=t.query,r=on(e.activeEditorId,e,a.clientUniqueId),i=r.newSelectedId,s=r.tabs;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)((0,o.__assign)({},Ce(i)),{tabs:s})},e.editors),queries:K.removeOne(N.X6.getQueryUrn(a.clientUniqueId),e.queries)})}),(0,n.on)(Gu,function(e,t){var r=_.map(t.response,function(u){var m=_.find(e.queries.entities,function(p){return p.queryId===u.queryId.toString()});return(0,o.__assign)((0,o.__assign)({},u),{clientUniqueId:_.isEmpty(m)?Wt():m.clientUniqueId,isResultGridVisible:m?.isResultGridVisible,isQueryCanceled:m?.isQueryCanceled,isQueryExecuting:m?.isQueryExecuting,clientExecutionStartTime:m?.clientExecutionStartTime,startLineNumber:m?.startLineNumber})}),i=_.filter(e.queries.entities,function(u){return 0===u.state}),s=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,c=r.map(function(u){return Ta(s,u.clientUniqueId,u)}).concat(i);return(0,o.__assign)((0,o.__assign)({},e),{queries:K.setAll(c,e.queries)})}),(0,n.on)(bl,function(e){if(!_.isEmpty(e.editors.entities[e.activeEditorId].tabs))return e;var r=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(i){return i.name})),0);return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:[r.clientUniqueId]},Ce(r.clientUniqueId))},e.editors),queries:K.addOne(r,e.queries)})}),(0,n.on)(pl,function(e,t){var r=e.queries.entities[N.X6.getQueryUrn(t.queryId)];if(!r)return e;var i={id:r.urn,changes:{isQueryExecuting:!1}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(i,e.queries)})}),(0,n.on)(Jr,function(e,t){var a=t.sqlResponse,r=t.queryId,i=t.asyncExecution,s=e.queries.entities[N.X6.getQueryUrn(r)];if(!s)return e;var c=[],u=0,m=0,p=[];a.sqlResults.forEach(function(A){var C="".concat(r).concat(u);switch(A.resultType){case"query":c.push({id:r+m,displayName:++m,queryResult:A});break;case"statementCompletedMessage":p.push({id:"".concat(C,"-0"),recordsAffected:A.recordsAffected}),u++;break;case"queryDurationMessage":s.sqlExecutionDuration=moment.utc(A.durationMilliseconds).format("HH:mm:ss.SSS");break;case"errorMessage":var I;I=A.sqlErrors?A.sqlErrors.map(function(P,M){return{id:"".concat(C,"-").concat(M),message:P}}):[{id:C,message:{messageType:Kr.error,messageText:A.exceptionMessage}}],p=(0,o.__spreadArray)((0,o.__spreadArray)([],p,!0),I,!0),u++;break;case"infoMessage":A.sqlWarnings.forEach(function(P,M){p.push({id:"".concat(C,"-").concat(M),message:P})}),u++}});var v=s.clientExecutionStartTime,b=moment(),E=moment.utc(b.diff(moment(v))).format("HH:mm:ss.SSS"),D=_.some(p,function(A){var C;return(null===(C=A.message)||void 0===C?void 0:C.messageType)===Kr.error}),O={id:s.urn,changes:{hasResultError:D,isQueryExecuting:i,selectedSqlGridResultId:c.length?r+"0":void 0,clientExecutionEndTime:b.format(),clientRunTime:E,sqlExecutionDuration:s.sqlExecutionDuration,sqlGridResultIds:c.map(function(A){return A.id}),sqlResultPaneSelectedView:D||!c.length?"messages":"results",sqlResultsPaneMessageIds:p.map(function(A){return A.id}),state:0===s.state?2:s.state}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(O,e.queries),sqlGridResults:Gt.upsertMany(c,e.sqlGridResults),sqlMessages:St.setMany(p,e.sqlMessages)})}),(0,n.on)(yl,Yu,function(e,t){var a=t.queryType,r=t.shared,i=null,s=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;e.editors.entities[e.activeEditorId].selected.queryId&&0===(i=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId)).type&&i.editorContext.saveViewState(),void 0===a&&(a=i?i.type:1===e.datamarts.entities[s].warehouseMetadata.datamartType?1:0);var u=Le(s,Ie.getUniqueName(0===a?Fe:"Visual query 1",_.map(e.queries.entities,function(m){return m.name})),a,r);return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[u.clientUniqueId],!1)},Ce(u.clientUniqueId))},e.editors),queries:K.addOne(u,e.queries)})}),(0,n.on)(Dl,Aa,function(e,t){var a=t.queryId,r=ve(e.queries,a),i=e.editors.entities[e.activeEditorId].tabs.indexOf(a)>=0;return e.editors.entities[e.activeEditorId].selected.queryId&&0===ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).type?e.queries.entities[N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId)].editorContext.saveViewState():r.editingMExpression=r.mExpression,(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:i?e.editors.entities[e.activeEditorId].tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[a],!1)},Ce(a))},e.editors),queries:K.upsertOne(r,e.queries)})}),(0,n.on)(Aa,function(e,t){var i=t.queryInfo.schema,s=_.map(i?.columns,function(c){return{name:c.name,dataType:c.type}});return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{isQueryExecuting:!1,columns:_.isEmpty(i)?void 0:s}},e.queries)})}),(0,n.on)(Rc,function(e,t){var a=t.editorId,r=t.sql,i={isExecuting:!0,clientExecutionStartTime:moment().format(),sql:r};return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:a,changes:{dataExplorer:i}},e.editors)})}),(0,n.on)(Mc,function(e,t){var a=t.editorId,r=t.queryResult,i=e.editors.entities[a].dataExplorer.clientExecutionStartTime,s=moment(),c=moment.utc(s.diff(moment(i))).format("HH:mm:ss.SSS");return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:a,changes:{dataExplorer:(0,o.__assign)((0,o.__assign)({},e.editors.entities[a].dataExplorer),{isExecuting:!1,clientExecutionStartTime:i,clientExecutionEndTime:s.format(),clientRunTime:c,sqlGridResult:r})}},e.editors)})}),(0,n.on)(wc,function(e,t){var m,p,a=t.urn,r=t.name,i=t.itemType,u=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(v){return v.name})),0);return"Table"===i?p=e.tables.entities[a]:"View"===i&&(p=e.views.entities[a]),m=p&&_.map(Array.from(p.columns.values()),function(v){return e.columns.entities[v].name}),u.sqlExpression=function(e,t,a,r,i,s){var c;return void 0===s&&(s=100),c=i?.length?i.reduce(function(u,m,p){return 0===p?u+" [".concat(m,"]"):"".concat(u,"\n            ,[").concat(m,"]")},"SELECT TOP (".concat(s,")")):"SELECT TOP (".concat(s,") *"),c+(1===r?"\nFROM [".concat(Nt(t),"].[").concat(Nt(a),"]"):"\nFROM [".concat(Nt(e),"].[").concat(Nt(t),"].[").concat(Nt(a),"]"))}(p.warehouseName,p.schemaName,r,e.datamarts.entities[p.warehouseId].warehouseMetadata.datamartType,m),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[u.clientUniqueId],!1)},Ce(u.clientUniqueId))},e.editors),queries:K.addOne(u,e.queries)})}),(0,n.on)(kc,cl,function(e,t){var a=t.schemaObjectContainer,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,s=Le(r,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(p){return p.name})),0),c=Ie.getUniqueName("table1",_.map(e.tables.entities,function(p){return p.name}));return s.sqlExpression=function(e,t,a){return"CREATE TABLE [".concat(e,"].[").concat(t,"].[").concat(a,"]\n")+"(\n   col1 int NOT NULL\n)\nGO"}(a?a.warehouseMetadata.name:e.datamarts.entities[r].warehouseMetadata.name,a?a.schemaName:Kt,c),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[s.clientUniqueId],!1)},Ce(s.clientUniqueId))},e.editors),queries:K.addOne(s,e.queries)})}),(0,n.on)(qc,dl,function(e,t){var a=t.schemaObjectContainer,s=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(m){return m.name})),0),c=Ie.getUniqueName("view1",_.map(e.views.entities,function(m){return m.name}));return s.sqlExpression=function(e,t){return"CREATE VIEW [".concat(e,"].[").concat(t,"]\n")+"AS SELECT *\nFROM [SomeTableOrView]\n"}(a?a.schemaName:Kt,c),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[s.clientUniqueId],!1)},Ce(s.clientUniqueId))},e.editors),queries:K.addOne(s,e.queries)})}),(0,n.on)(Bc,ll,function(e,t){var a=t.schemaObjectContainer,s=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(m){return m.name})),0),c=Ie.getUniqueName("storedproc1",_.map(e.storedProcedures.entities,function(m){return m.name}));return s.sqlExpression=function(e,t){return"CREATE PROC [".concat(e,"].[").concat(t,"]\n")+"@param1 int,\n@param2 int\nAS\nBEGIN\nSELECT @param1, @param2\nEND\n"}(a?a.schemaName:Kt,c),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[s.clientUniqueId],!1)},Ce(s.clientUniqueId))},e.editors),queries:K.addOne(s,e.queries)})}),(0,n.on)(xc,function(e,t){var a=t.schemaObjectContainer,s=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,Ie.getUniqueName(Fe,_.map(e.queries.entities,function(m){return m.name})),0),c=Ie.getUniqueName("function1",_.map(e.userDefinedFunctions.entities,function(m){return m.name}));return s.sqlExpression=function(e,t){return"CREATE FUNCTION [".concat(e,"].[").concat(t,"] (@param1 int)\n")+"RETURNS int\nAS\nBEGIN\n\tDECLARE @MyValueOut int;\n\tSET @MyValueOut = @param1\n\tRETURN(@MyValueOut)\nEND\nGO\n"}(a?a.schemaName:Kt,c),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[s.clientUniqueId],!1)},Ce(s.clientUniqueId))},e.editors),queries:K.addOne(s,e.queries)})}),(0,n.on)(jc,ul,function(e){var t=Ie.getUniqueName(Fe,_.map(e.queries.entities,function(s){return s.name})),r=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,t,0),i=Ie.getUniqueName("schema1",_.map(e.schemas.entities,function(s){return s.name}));return r.sqlExpression=function(e){return"CREATE SCHEMA [".concat(e,"]\n")+"GO"}(i),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[r.clientUniqueId],!1)},Ce(r.clientUniqueId))},e.editors),queries:K.addOne(r,e.queries)})}),(0,n.on)(Lc,function(e,t){var a=t.table,r=Ie.getUniqueName(Fe,_.map(e.queries.entities,function(p){return p.name})),s=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,r,0),c=Ie.getUniqueName("table1",_.map(e.tables.entities,function(p){return p.name}));return s.sqlExpression="SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n"+function(e,t,a,r){return"CREATE TABLE [".concat(e,"].[").concat(t,"].[").concat(a,"]\n")+"AS\nSELECT *\n"+"FROM [".concat(e,"].[").concat(t,"].[").concat(r,"]\n")+"GO\n"}(a.warehouseName,a.schemaName,c,a.name),(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[s.clientUniqueId],!1)},Ce(s.clientUniqueId))},e.editors),queries:K.addOne(s,e.queries)})}),(0,n.on)(zc,function(e,t){var a=t.sqlStatement,r=t.datamartModelObject,i=Ie.getUniqueName(Fe,_.map(e.queries.entities,function(u){return u.name})),c=Le(e.editors.entities[e.activeEditorId].primaryDatamartObjectId,i,0);return c.sqlExpression=a,(0,o.__assign)((0,o.__assign)({},qa(e,r,!1)),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].tabs,!0),[c.clientUniqueId],!1)},Ce(c.clientUniqueId))},e.editors),queries:K.addOne(c,e.queries)})}),(0,n.on)(_l,function(e,t){var a=t.savedQueryId,r=_.find(e.queries.entities,function(m){return m.queryId===a.toString()}),i=_.clone(r);i.clientUniqueId=Wt(),i.urn=N.X6.getQueryUrn(i.clientUniqueId);var s=K.removeOne(r.urn,e.queries),c=e.editors.entities[e.activeEditorId].tabs;c.splice(e.editors.entities[e.activeEditorId].tabs.indexOf(r.clientUniqueId),1,i.clientUniqueId);var u=K.addOne(i,s);return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:c},Ce(i.clientUniqueId,(0,o.__assign)((0,o.__assign)({},e),{queries:u})))},e.editors),queries:u})}),(0,n.on)(Sl,function(e,t){var r=t.featureSwitches,i=ve(e.queries,t.queryId),s=on(e.activeEditorId,e,i.clientUniqueId),c=s.newSelectedId,u=s.tabs;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({tabs:u},Ce(c))},e.editors),queries:0===i?.state?K.removeOne(i.urn,e.queries):r.datamartSql?e.queries:K.updateOne({id:i.urn,changes:{isResultGridVisible:!1,isQueryExecuting:!1}},e.queries)})}),(0,n.on)(Il,function(e,t){var a,r,u,i=t.queryId,s=ve(e.queries,i),c=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId);return i!==e.editors.entities[e.activeEditorId].selected.queryId&&0===c.type&&(null===(a=c.editorContext)||void 0===a||a.saveViewState(),u={isResultGridVisible:s.isQueryCanceled?null!==(r=e.executeSqlAsyncFeatureSwitch)&&void 0!==r&&r:s.isResultGridVisible}),(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:s.urn,changes:u},e.queries),editors:ee.updateOne({id:e.activeEditorId,changes:(0,o.__assign)({},Ce(i))},e.editors)})}),(0,n.on)(El,function(e,t){var a=t.selectedContext,r={id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{editorContext:a}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(r,e.queries)})}),(0,n.on)(Pl,function(e,t){var a=t.selectedPaneHeight,r={id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{resultGridHeight:a}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(r,e.queries)})}),(0,n.on)(Cl,function(e,t){var a=t.isBottomPaneMaximized,r={id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{isBottomPaneMaximized:a}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(r,e.queries)})}),(0,n.on)(Tl,function(e,t){var a=t.view;return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{sqlResultPaneSelectedView:a}},e.queries)})}),(0,n.on)(ml,function(e,t){var a=t.sql,r=t.startLineNumber,i=e.editors.entities[e.activeEditorId].selected.queryId+"_"+e.editors.entities[e.activeEditorId].sqlRunId,s=++e.editors.entities[e.activeEditorId].sqlRunId,c=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId),u={lastSqlRunId:i,isResultGridVisible:!0,lastSql:a,clientExecutionStartTime:moment().format(),isQueryExecuting:!0,isQueryCanceled:!1,sqlResultPaneSelectedView:"messages",startLineNumber:r};return(0,o.__assign)((0,o.__assign)({},e),{sqlMessages:St.removeMany(c.sqlResultsPaneMessageIds,e.sqlMessages),editors:ee.updateOne({id:e.activeEditorId,changes:{sqlRunId:s}},e.editors),sqlGridResults:Gt.removeMany(c.sqlGridResultIds,e.sqlGridResults),queries:K.updateOne({id:c.urn,changes:u},e.queries)})}),(0,n.on)(fl,function(e,t){var a=t.id,r=e.editors.entities[e.activeEditorId].selected.queryId&&e.queries.entities[N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId)];return _.isEmpty(r)?e:(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{selectedSqlGridResultId:a}},e.queries)})}),(0,n.on)(hl,function(e){var t=e.editors.entities[e.activeEditorId].selected.queryId&&e.queries.entities[N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId)];return _.isEmpty(t)||1===t.type||!t.isResultGridVisible?e:(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{isQueryExecuting:!0,isQueryCanceled:!1}},e.queries)})}),(0,n.on)(gl,function(e,t){var a=t.queryInfo,r=e.editors.entities[e.activeEditorId].selected.queryId&&e.queries.entities[N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId)],i=a.schema;if(_.isEmpty(r)||1===r.type||!r.isResultGridVisible)return e;var s=_.map(i?.columns,function(c){return{name:c.name,dataType:c.type}});return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId).urn,changes:{isQueryExecuting:!1,columns:_.isEmpty(i)?void 0:s}},e.queries)})}),(0,n.on)(vl,function(e,t){var r=e.queries.entities[N.X6.getQueryUrn(t.queryId)];return(0,o.__assign)((0,o.__assign)({},e),{sqlMessages:St.removeAll(e.sqlMessages),queries:K.updateOne({id:r.urn,changes:{hasResultError:!0,isQueryExecuting:!1,clientRunTime:moment.utc(moment().diff(moment(r.clientExecutionStartTime))).format("HH:mm:ss.SSS"),isQueryCanceled:!1}},e.queries)})}),(0,n.on)(Nc,Ac,function(e,t){var a=t.editorId;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:a,changes:{dataExplorer:{isExecuting:!1,hasResultError:!0}}},e.editors)})}),(0,n.on)(Xu,Zu,function(e,t){var a=t.queryId;return(0,o.__assign)((0,o.__assign)({},e),{sqlMessages:St.removeAll(e.sqlMessages),queries:K.updateOne({id:ve(e.queries,a).urn,changes:{isQueryExecuting:!1,isQueryCanceled:!0,sqlResultPaneSelectedView:"messages"}},e.queries)})}),(0,n.on)(Ju,function(e,t){var a=t.batchId,r=t.queryId;return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:ve(e.queries,r).urn,changes:{batchId:a}},e.queries)})}),(0,n.on)(wl,Aa,function(e,t){var a=t.mExpression,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;if(_.isEmpty(_.trim(a))||e.datamarts.entities[r].isReadonly)return e;var i=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId),s=ln(i.mExpression)===ln(a)?i.state:2,c={id:i.urn,changes:{state:s,editingMExpression:a,badge:2===s?1:0}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(c,e.queries)})}),(0,n.on)(Ol,function(e,t){var r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;if(_.isEmpty(t.model)||e.datamarts.entities[r].isReadonly)return e;var i=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId),s=i.editorContext.getContent();if(_.isEmpty(_.trim(s))||s===i.sqlExpression)return e;var c={id:i.urn,changes:{state:2,badge:1}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(c,e.queries)})}),(0,n.on)(Rl,function(e,t){var a=t.queryInfo,r=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId),i=a.schema;if(_.isEmpty(i))return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:r.urn,changes:{columns:void 0}},e.queries)});var s=_.map(i.columns,function(u){return{name:u.name,dataType:u.type}}),c={id:r.urn,changes:{columns:s}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(c,e.queries)})}),(0,n.on)($u,function(e,t){var a=t.query;return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne({id:N.X6.getQueryUrn(a.clientUniqueId),changes:{isSaving:!0,badge:1}},e.queries)})}),(0,n.on)(Gr,function(e,t){var a=t.tableName,r=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId);if(!r||r.mExpression)return e;var i={id:N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId),changes:{firstTable:a}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(i,e.queries)})}),(0,n.on)($r,function(e,t){var a,r,i=t.urn,s=ve(e.queries,e.editors.entities[e.activeEditorId].selected.queryId);if(!s||s.mExpression)return e;var c=null!==(r=null===(a=e.tables.entities[i])||void 0===a?void 0:a.name)&&void 0!==r?r:e.views.entities[i].name,u={id:N.X6.getQueryUrn(e.editors.entities[e.activeEditorId].selected.queryId),changes:{firstTable:c}};return(0,o.__assign)((0,o.__assign)({},e),{queries:K.updateOne(u,e.queries)})}),(0,n.on)(Qd,function(e,t){var a=t.featureSwitches,r=t.telemetryService;return(0,o.__assign)((0,o.__assign)({},e),{lakehouseModeling:a.lakehouseModeling&&Ll.isTrident,tridentMultitaskingDatamarts:a.tridentMultitaskingDatamarts&&a.tridentMultitasking,datamartModeling:a.datamartModeling,warehouseCrossDbQueries:a.warehouseCrossDbQueries,executeSqlAsyncFeatureSwitch:a.executeSqlAsync,datamartAutoRefresh:a.datamartAutoRefresh,telemetryService:r})}),(0,n.on)(Dd,function(e,t){var a=t.datamartObjectId,r=e.editors.entities[a];r||(r=Sa(a));var i=e.datamarts.entities[a];return i||(i=Ia(a)),i.fromDatahub=!0,(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.upsertOne(i,e.datamarts),editors:ee.upsertOne(r,e.editors),activeEditorId:a})}),(0,n.on)(Yd,function(e,t){var a=t.editorId,r=t.schema,i=t.warehouseMetadata,s=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},e),Xe(r,e,i,!1,e.telemetryService)),{editors:ee.updateOne({id:a,changes:{loadingWarehousesIds:e.editors.entities[e.activeEditorId].loadingWarehousesIds.filter(function(u){return u!==i.datamartObjectId}),loadedWarehouseIds:(0,o.__spreadArray)((0,o.__spreadArray)([],e.editors.entities[e.activeEditorId].loadedWarehouseIds,!0),[i.datamartObjectId],!1)}},e.editors)}),c=(0,o.__assign)((0,o.__assign)({},s),Ze(s,i.datamartObjectId,r));return(0,o.__assign)((0,o.__assign)({},c),{datamarts:H.updateOne({id:i.datamartObjectId,changes:{name:i.name,urn:i.name,warehouseMetadata:i,infoLoadState:"LOADED",schemaLoadState:"LOADED",hasLockTimeoutException:!1}},c.datamarts)})}),(0,n.on)(iu,function(e,t){var a=t.warehouse;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:a.objectId,changes:{loadingForSearch:!0}},e.datamarts)})}),(0,n.on)(su,function(e,t){var a=t.schema,r=t.datamartObjectId,i=t.containersToLoad,s=t.filterCommand,c=(0,o.__assign)((0,o.__assign)({},e),Xe(a,e,(0,o.__assign)((0,o.__assign)({},e.datamarts.entities[r].warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r].fromDatahub,e.telemetryService,s,i)),u=(0,o.__assign)((0,o.__assign)({},c),Ze(c,r,a));return(0,o.__assign)((0,o.__assign)({},u),{datamarts:H.updateOne({id:r,changes:{loadingForSearch:!1,schemaLoadState:"LOADED",hasLockTimeoutException:!1}},u.datamarts)})}),(0,n.on)(ou,function(e,t){var r=t.datamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:r,changes:{loadingForSearch:!1}},e.datamarts)})}),(0,n.on)(cu,function(e,t){var a=t.datamartModelObject,r=rt(a)?qe.updateOne({id:a.urn,changes:{loadingForIncrementalLoad:!0}},e.schemaObjectContainers):e.schemaObjectContainers,i=Dt(a)?He.updateOne({id:a.urn,changes:{loadingForIncrementalLoad:!0}},e.databaseRoleContainers):e.databaseRoleContainers;return(0,o.__assign)((0,o.__assign)({},e),{schemaObjectContainers:r,databaseRoleContainers:i})}),(0,n.on)($c,function(e,t){return ka(e,t.datamartModelObject,!0)}),(0,n.on)(Zc,function(e,t){return ka(e,t.datamartModelObject,!1)}),(0,n.on)(Hc,function(e,t){var r=t.datamartModelObject,s=e.editors.entities[e.activeEditorId].primaryDatamartObjectId,u=cn(t.schema,e,r,e.datamarts.entities[s].fromDatahub,e.telemetryService,t.filterCommand),m=(0,o.__assign)((0,o.__assign)({},e),u),p=rt(r)?qe.updateOne({id:r.urn,changes:{loadingForIncrementalLoad:!1}},m.schemaObjectContainers):m.schemaObjectContainers,v=Dt(r)?He.updateOne({id:r.urn,changes:{loadingForIncrementalLoad:!1}},m.databaseRoleContainers):m.databaseRoleContainers;return(0,o.__assign)((0,o.__assign)({},m),{schemaObjectContainers:p,databaseRoleContainers:v,datamarts:H.updateOne({id:s,changes:{schemaLoadState:"LOADED",hasLockTimeoutException:!1}},e.datamarts)})}),(0,n.on)(Xc,function(e,t){var a=t.schema,r=t.datamartModelObject,i=t.filterCommand,s=e.datamarts.entities[r.warehouseMetadata.datamartObjectId].fromDatahub,c=rt(r)?cn(a,e,r,s,e.telemetryService,i):Xe(a,e,(0,o.__assign)((0,o.__assign)({},r.warehouseMetadata),{datamartVersion:a.datamartVersion}),e.datamarts.entities[r.warehouseMetadata.datamartObjectId].fromDatahub,e.telemetryService,i);return ka((0,o.__assign)((0,o.__assign)((0,o.__assign)({},e),c),Ze((0,o.__assign)((0,o.__assign)({},e),c),r.warehouseMetadata.datamartObjectId,a)),r,!1)}),(0,n.on)(Vc,function(e,t){var a=t.datamartModelObject,r=rt(a)?qe.updateOne({id:a.urn,changes:{loadingForIncrementalLoad:!1}},e.schemaObjectContainers):e.schemaObjectContainers,i=Dt(a)?He.updateOne({id:a.urn,changes:{loadingForIncrementalLoad:!1}},e.databaseRoleContainers):e.databaseRoleContainers;return(0,o.__assign)((0,o.__assign)({},e),{schemaObjectContainers:r,databaseRoleContainers:i})}),(0,n.on)(Wd,function(e,t){var a=t.item,r=t.clearPreviousSelection;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{selected:(0,o.__assign)((0,o.__assign)({},e.editors.entities[e.activeEditorId].selected),{items:sn(e.activeEditorId,[a],r,e)})}},e.editors)})}),(0,n.on)(zd,function(e,t){var a=t.items,r=t.clearPreviousSelection;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{selected:(0,o.__assign)((0,o.__assign)({},e.editors.entities[e.activeEditorId].selected),{items:sn(e.activeEditorId,a,r,e)})}},e.editors)})}),(0,n.on)(Kd,function(e,t){var a=t.item;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{selected:(0,o.__assign)((0,o.__assign)({},e.editors.entities[e.activeEditorId].selected),{items:Kl(e.activeEditorId,a,e)})}},e.editors)})}),(0,n.on)($d,function(e){var t=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:t,changes:{notificationSuspended:!0}},e.datamarts)})}),(0,n.on)(Xd,function(e){var t=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:t,changes:{notificationSuspended:!1}},e.datamarts)})}),(0,n.on)(Gd,function(e){var t=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{selected:(0,o.__assign)((0,o.__assign)({},e.editors.entities[e.activeEditorId].selected),{items:new Set})}},e.editors),datamarts:H.updateOne({id:t,changes:{notificationSuspended:void 0}},e.datamarts)})}),(0,n.on)(tu,function(e,t){var a=t.isReadonly,r=e.editors.entities[e.activeEditorId].primaryDatamartObjectId;return(0,o.__assign)((0,o.__assign)({},e),{datamarts:H.updateOne({id:r,changes:{isReadonly:a}},e.datamarts)})}),(0,n.on)(au,function(e){return(0,o.__assign)((0,o.__assign)({},e),{actionError:!0})}),(0,n.on)(Qc,Kc,Wc,function(e,t){return qa(e,t.item,!0)}),(0,n.on)(Gc,function(e,t){return qa(e,t.datamartModelObject,!1)}),(0,n.on)(du,function(e,t){var a=t.oneLakeUrl;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{oneLakeUrl:a}},e.editors)})}),(0,n.on)(uu,function(e,t){var a,r=t.objectType;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{fieldListFilters:(0,o.__assign)((0,o.__assign)({},e.editors.entities[e.activeEditorId].fieldListFilters),(a={},a[r]=!e.editors.entities[e.activeEditorId].fieldListFilters[r],a))}},e.editors)})}),(0,n.on)(lu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{fieldListFilters:void 0}},e.editors)})}),(0,n.on)(mu,function(e,t){var a=t.mwcTokenResponsePayload;return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{mwcTokenResponsePayload:a}},e.editors)})}),(0,n.on)(pu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{editors:ee.updateOne({id:e.activeEditorId,changes:{mwcTokenResponsePayload:void 0}},e.editors)})}),(0,n.on)(fu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{isCopilotActive:!0})}),(0,n.on)(hu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{isCopilotActive:!1})}),(0,n.on)(gu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{isCopilotActive:!e.isCopilotActive})}));var mn=window;(0,n.Lq)({visible:!1,mashupEditorDialog:void 0,locale:void 0,accessToken:mn.powerBIAccessToken,blockEditorInteraction:!1},(0,n.on)(Jc,function(e){return(0,o.__assign)((0,o.__assign)({},e),{visible:!1})}),(0,n.on)(ed,zr,function(e,t){var a=t.mashupEditorDialog;return(0,o.__assign)((0,o.__assign)({},e),{mashupEditorDialog:a})}),(0,n.on)(nd,function(e,t){var a=t.locale;return(0,o.__assign)((0,o.__assign)({},e),{locale:a})}),(0,n.on)(id,function(e){return(0,o.__assign)((0,o.__assign)({},e),{accessToken:mn.powerBIAccessToken})}),(0,n.on)(sd,function(e,t){return(0,o.__assign)((0,o.__assign)({},e),{mwcToken:void 0})}),(0,n.on)(Yc,Ru,Gr,$r,function(e){return(0,o.__assign)((0,o.__assign)({},e),{blockEditorInteraction:!0})}),(0,n.on)(zr,ad,td,rd,function(e){return(0,o.__assign)((0,o.__assign)({},e),{blockEditorInteraction:!1})}));var Fa=function(e){return e[e.None=0]="None",e[e.Unsaved=1]="Unsaved",e[e.Saved=2]="Saved",e}({}),Xt={queryName:void 0,sourceTable:void 0,status:Fa.None,queryScript:void 0,transientModelMap:void 0,persistedModels:[],autoCompletionRequestInFlight:!1};(0,n.Lq)(Xt,(0,n.on)(Su,function(e,t){var a=t.tableName;return(0,o.__assign)((0,o.__assign)({},e),{queryName:"Query_".concat(a),sourceTable:a,status:Fa.Unsaved})}),(0,n.on)(Iu,function(e,t){var a=t.name;return(0,o.__assign)((0,o.__assign)({},e),{queryName:a})}),(0,n.on)(Pu,function(e,t){var a=t.queryScript;return(0,o.__assign)((0,o.__assign)({},e),{queryScript:a})}),(0,n.on)(Eu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{status:Fa.Saved})}),(0,n.on)(Cu,function(){return Xt}),(0,n.on)(Mu,function(e,t){var a=t.transientModels;return(0,o.__assign)((0,o.__assign)({},e),{transientModelMap:a})}),(0,n.on)(Au,function(e,t){var a=t.modelObjectId;return e.persistedModels.find(function(i){return i===a})?(0,o.__assign)({},e):(0,o.__assign)((0,o.__assign)({},e),{persistedModels:(0,o.__spreadArray)((0,o.__spreadArray)([],e.persistedModels,!0),[a],!1)})}),(0,n.on)(qu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{autoCompletionRequestInFlight:!0})}),(0,n.on)(Lu,function(e){return(0,o.__assign)((0,o.__assign)({},e),{autoCompletionRequestInFlight:!1})}));(0,n.Lq)({addRemoveFromBIBatchId:void 0},(0,n.on)(al,function(e,t){var a=t.addRemoveFromBIBatchId;return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:a})}),(0,n.on)(Fc,function(e){return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:void 0})}),(0,n.on)(ja,function(e){return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:void 0})}),(0,n.on)(nl,function(e){return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:void 0})}),(0,n.on)(Uc,function(e){return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:void 0})}),(0,n.on)(rl,function(e){return(0,o.__assign)((0,o.__assign)({},e),{addRemoveFromBIBatchId:void 0})}));var Ha=(0,ye.H)(),Va=Ha.getInitialState({});(0,n.Lq)(Va,(0,n.on)(Ou,function(e,t){return Ha.upsertOne({id:t.queryName,script:t.queryScript},e)})),Ha.getSelectors();var Ct,jt=(0,n.ZF)("datamartRootState"),le=((0,n.P1)(jt,function(e){return e.mashupEditor}),(0,n.P1)(jt,function(e){return e?.datamartModel})),Qa=((0,n.P1)(jt,function(e){return e.ribbonState}),(0,n.P1)(jt,function(e){return e&&e.queryEditor}),(0,n.P1)(jt,function(e){return e&&e.sessionQueries}),(0,n.P1)(pe.C,function(e){return e&&e.params.groupid}),(0,n.P1)(pe.C,function(e){return e&&e.params.datamartId})),Ne=((0,n.P1)(pe.C,function(e){return e&&e.params.queryId}),(0,n.P1)(G.WZ,Qa,function(e,t){return e&&e[t]})),Zt=((0,n.P1)(Ne,function(e){return e&&e.tdsEndpoint}),(0,n.P1)(Ne,function(e){return e&&e.datamartType})),nm=((0,n.P1)(Zt,function(e){return 2===e}),(0,n.P1)(Zt,function(e){return 2===e||5===e}),(0,n.P1)(Ne,function(e){return e&&e.dataflowObjectId}),(0,n.P1)(Ne,function(e){return e&&e.ownerArtifactObjectId}),(0,n.P1)(Ne,function(e){return e&&e.gatewayObjectId}),(0,n.P1)(Ne,function(e){return e&&e.name}),(0,n.P1)(Ne,function(e){return e&&e.datasetObjectId}),(0,n.P1)(Ne,function(e){return e&&e.status}),(0,n.P1)(Ne,function(e){return e&&e.state})),Wa=((0,n.P1)(Ne,function(e){return e&&(0,k.kK)(e.datamartType)}),H.getSelectors()),vn=ee.getSelectors(),Ka=(0,n.P1)(le,function(e){return e&&e.datamarts}),fn=(0,n.P1)(le,function(e){return e&&e.editors}),Ve=(0,n.P1)(Ka,Wa.selectEntities),za=(0,n.P1)(fn,vn.selectEntities),Ga=((0,n.P1)(fn,vn.selectAll),(0,n.P1)(Ka,Wa.selectIds),(0,n.P1)(Ka,Wa.selectAll)),de=((0,n.P1)(Ga,Qa,G.WZ,function(e,t,a){return e.length>0?e.map(function(r){return(0,o.__assign)({},a[r.objectId])}):[(0,o.__assign)({},a[t])]}),(0,n.P1)(za,Qa,function(e,t){return e&&t&&e[t]})),im=(0,n.P1)(de,function(e){return e&&e.primaryDatamartObjectId}),ge=((0,n.P1)(le,function(e){return e&&e.activeEditorId}),(0,n.P1)(Ve,im,function(e,t){return e&&t&&e[t]})),Bt=((0,n.P1)(ge,function(e){return e&&e.name}),(0,n.P1)(ge,function(e){return e&&e.warehouseMetadata})),hn=((0,n.P1)(de,function(e){return e.loadingError}),function(t){return(0,n.P1)(de,function(a){return a&&a.primaryDatamartObjectId===t})}),sm=(0,n.P1)(Bt,function(e){return e&&e.datamartVersion}),$a=((0,n.P1)(Bt,function(e){return e&&e.datamartVersion}),(0,n.P1)(ge,function(e){return e&&e.etlModel})),gn=((0,n.P1)($a,function(e){return e&&e.entities}),(0,n.P1)(ge,function(e){return e&&e.datasetInfo}),(0,n.P1)(ge,function(e){return e&&e.databaseDefinition}),(0,n.P1)(ge,function(e){var t;return e&&(null===(t=e.databaseDefinition)||void 0===t?void 0:t.tables)}),(0,n.P1)(ge,function(e){var t;return e&&(null===(t=e.databaseDefinition)||void 0===t?void 0:t.views)}),(0,n.P1)($a,function(e){var t;return null!==(t=e&&e["pbi:mashup"].queriesMetadata)&&void 0!==t?t:{}}),(0,n.P1)($a,function(e){return e&&e.culture}),(0,n.P1)(de,function(e){return e&&e.leaseExpiration}),(0,n.P1)(ge,function(e){return e&&e.infoLoadState})),om=((0,n.P1)(gn,function(e){return"LOADED"!==e}),(0,n.P1)(gn,function(e){return"LOADED"===e})),bn=(0,n.P1)(ge,function(e){return e&&e.queriesLoadState}),cm=((0,n.P1)(bn,function(e){return"LOADED"!==e}),(0,n.P1)(bn,function(e){return"LOADED"===e}),(0,n.P1)(nm,function(e){return 0===e})),Xa=(0,n.P1)(ge,function(e){return e&&e.schemaLoadState}),yn=(0,n.P1)(Xa,function(e){return"LOADING"===e}),Dn=(0,n.P1)(Xa,function(e){return"LOADED"===e}),Za=((0,n.P1)(Xa,function(e){return"ERROR"===e}),(0,n.P1)(le,function(e){return e&&e.lakehouseModeling}),(0,n.P1)(le,function(e){return e&&e.datamartModeling}),(0,n.P1)(le,function(e){return e&&e.isCopilotActive}),(0,n.P1)(le,function(e){return e&&e.isCopilotEnabled}),(0,n.P1)(Ne,function(e){return e&&null!=e.sampleName&&""!==e.sampleName})),Ja=(0,n.P1)(ge,function(e){return e&&e.isWarehouseImporting}),dm=((0,n.P1)(Dn,Za,function(e,t){return e&&!t}),(0,n.P1)(yn,Za,Ja,function(e,t,a){return e||t||a}),(0,n.P1)(om,cm,Ja,function(e,t,a){return e&&!t&&!a}),(0,n.P1)(yn,Za,Ja,function(e,t,a){return(t||a)&&!e}),(0,n.P1)(ge,function(e){return e&&e.modelingServiceInitialized}),Ae.getSelectors()),_n=(0,n.P1)(le,function(e){return e&&e.updatingDatamartStepsProgress}),um=((0,n.P1)(_n,dm.selectEntities),(0,n.P1)(_n,ge,function(e,t){return t&&t.updatingDatamartStepsProgressIds.map(function(a){return e.entities[a]})})),lm=((0,n.P1)(um,function(e){var t=_.find(e,function(a){return a.step===q.ImportingData});return!!t&&t.progress!==U.NotStarted}),nt.getSelectors()),Sn=(0,n.P1)(le,function(e){return e&&e.updatingLoadingStepsProgress}),mm=((0,n.P1)(Sn,lm.selectEntities),(0,n.P1)(Sn,ge,function(e,t){return t&&t.updatingLoadingStepsProgressIds.map(function(a){return e.entities[a]})}),(0,n.P1)(ge,function(e){return e&&e.importingWarehouseBatchId}),(0,n.P1)(ge,function(e){return e&&e.refreshingDatamartBatchId}),vt.getSelectors(),(0,n.P1)(le,function(e){return e.refreshedEntities})),Jt=(0,n.P1)(mm,ge,function(e,t){return t&&t.refreshedEntityIds.map(function(a){return e.entities[a]})}),Ya=((0,n.P1)(Jt,function(e){return!_.isEmpty(e)}),(0,n.P1)(Jt,function(e){return e.filter(function(t){return"failure"===t.progressState||"invalid"===t.progressState})}),(0,n.P1)(Jt,function(e){return e.filter(function(t){return"notStarted"===t.progressState||"inProgress"===t.progressState})}),(0,n.P1)(Jt,function(e){return e.filter(function(t){return"success"===t.progressState})}),_t.getSelectors()),er=(0,n.P1)(le,function(e){return e&&e.schemas}),Yt=(0,n.P1)(er,Ya.selectEntities),pm=(0,n.P1)(er,Ya.selectIds),vm=(0,n.P1)(er,Ya.selectAll),tr=((0,n.P1)(Yt,pm,function(e,t){return e&&t&&e[t[0]]}),(0,n.P1)(vm,Bt,function(e,t){return e&&t&&_.filter(e,function(a){return a.warehouseMetadata.datamartObjectId===t.datamartObjectId})}),qe.getSelectors()),ar=(0,n.P1)(le,function(e){return e&&e.schemaObjectContainers}),rr=(0,n.P1)(ar,tr.selectEntities),nr=((0,n.P1)(ar,tr.selectIds),(0,n.P1)(ar,tr.selectAll)),fm=(0,n.P1)(nr,function(e){return e&&_.filter(e,function(t){return t.isLoaded})}),In=(0,n.P1)(nr,function(e){return e&&_.filter(e,function(t){return!t.isLoaded})}),ir=He.getSelectors(),sr=(0,n.P1)(le,function(e){return e.databaseRoleContainers}),gm=(0,n.P1)(sr,ir.selectEntities),En=(0,n.P1)(sr,ir.selectAll),bm=(0,n.P1)(En,function(e){return e&&_.filter(e,function(t){return t.isLoaded})}),Pn=(0,n.P1)(En,function(e){return e&&_.filter(e,function(t){return!t.isLoaded})}),or=((0,n.P1)(sr,ir.selectIds),(0,n.P1)(fm,bm,function(e,t){return{schemaObjectContainers:e,databaseRoleContainers:t}}),(0,n.P1)(In,Pn,function(e,t){return{schemaObjectContainers:e,databaseRoleContainers:t}}),ze.getSelectors()),cr=(0,n.P1)(le,function(e){return e&&e.categories}),dr=(0,n.P1)(cr,or.selectEntities),Dm=((0,n.P1)(cr,or.selectIds),(0,n.P1)(cr,or.selectAll)),Cn=((0,n.P1)(ge,function(e){var t;return e&&e.etlModel&&(null===(t=e.etlModel["pbi:mashup"])||void 0===t?void 0:t.connectionOverrides)}),it.getSelectors()),On=(0,n.P1)(le,function(e){return e&&e.storedProcedures}),_m=(0,n.P1)(On,Cn.selectEntities),Tn=((0,n.P1)(On,Cn.selectIds),(0,n.P1)(_m,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})})),Sm=(0,n.P1)(Tn,function(e){return _.filter(e,function(t){return t.isHidden})}),wn=st.getSelectors(),Rn=(0,n.P1)(le,function(e){return e&&e.userDefinedFunctions}),Im=(0,n.P1)(Rn,wn.selectEntities),Mn=((0,n.P1)(Rn,wn.selectIds),(0,n.P1)(Im,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})})),Em=(0,n.P1)(Mn,function(e){return _.filter(e,function(t){return t.isHidden})}),ur=ft.getSelectors(),lr=(0,n.P1)(le,function(e){return e&&e.databaseRoles}),Pm=(0,n.P1)(lr,ur.selectEntities),mr=((0,n.P1)(lr,ur.selectIds),(0,n.P1)(lr,ur.selectAll),Ue.getSelectors()),pr=(0,n.P1)(le,function(e){return e&&e.tables}),ea=(0,n.P1)(pr,mr.selectEntities),kt=(0,n.P1)(pr,mr.selectAll),Cm=(0,n.P1)(pr,mr.selectIds),It=(0,n.P1)(ea,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})}),Om=(0,n.P1)(It,function(e){return _.filter(e,function(t){return t.isHidden})}),Tm=(0,n.P1)(It,Cm,function(e,t){return e&&t&&e[t[0]]}),An=(0,n.P1)(kt,Bt,function(e,t){return e&&t&&_.filter(e,function(a){return a.warehouseId===t.datamartObjectId})}),vr=((0,n.P1)(An,function(e){return _.filter(e,function(t){return t.isBiObject})}),ot.getSelectors()),fr=(0,n.P1)(le,function(e){return e&&e.views}),hr=(0,n.P1)(fr,vr.selectEntities),Nn=(0,n.P1)(fr,vr.selectAll),wm=(0,n.P1)(fr,vr.selectIds),Et=(0,n.P1)(hr,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})}),Rm=(0,n.P1)(Et,function(e){return _.filter(e,function(t){return t.isHidden})}),Mm=(0,n.P1)(Et,wm,function(e,t){return e&&t&&e[t[0]]}),xn=(0,n.P1)(Nn,Bt,function(e,t){return e&&t&&_.filter(e,function(a){return a.warehouseId===t.datamartObjectId})}),jn=((0,n.P1)(Tm,Mm,function(e,t){return e??t}),(0,n.P1)(xn,function(e){return _.filter(e,function(t){return t.isBiObject})}),Ge.getSelectors()),Bn=(0,n.P1)(le,function(e){return e&&e.columns}),ta=(0,n.P1)(Bn,jn.selectEntities),aa=((0,n.P1)(Bn,jn.selectIds),(0,n.P1)(ta,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})})),Am=(0,n.P1)(aa,function(e){return _.filter(e,function(t){return t.isHidden})}),kn=$e.getSelectors(),qn=(0,n.P1)(le,function(e){return e&&e.measures}),Ln=(0,n.P1)(qn,kn.selectEntities),gr=((0,n.P1)(qn,kn.selectIds),(0,n.P1)(Ln,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})})),Nm=(0,n.P1)(gr,function(e){return _.filter(e,function(t){return t.isHidden})}),br=((0,n.P1)(aa,gr,function(e,t){return{columns:e,measures:t}}),(0,n.P1)(de,function(e){return e&&e.selected.queryId})),Fn=K.getSelectors(),Un=(0,n.P1)(le,function(e){return e&&e.queries}),ht=(0,n.P1)(Un,Fn.selectEntities),Hn=(0,n.P1)(Un,Fn.selectAll),yr=(0,n.P1)(ht,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})}),Ee=((0,n.P1)(yr,function(e){return _.map(e,function(t){return t.name})}),(0,n.P1)(ht,pe.C,function(e,t){return _.find(e,function(a){var r;return a.queryId===(null===(r=t?.params)||void 0===r?void 0:r.queryId)})}),(0,n.P1)(br,le,de,function(e,t,a){return _.isEmpty(t)||_.isEmpty(a)||_.isEmpty(_.trim(e))?void 0:t.queries.entities[N.X6.getQueryUrn(e)]})),xm=((0,n.P1)(br,ht,function(e,t){var a;return null===(a=t[N.X6.getQueryUrn(e)])||void 0===a?void 0:a.firstTable}),(0,n.P1)(Ee,function(e){return e?.sqlGridResultIds})),jm=(0,n.P1)(Ee,function(e){return e?.sqlResultsPaneMessageIds}),Vn=((0,n.P1)(Ee,function(e){return 0===e?.type}),(0,n.P1)(de,function(e){return e&&e.dataExplorer})),Bm=((0,n.P1)(Vn,function(e){return e?.sqlGridResult}),(0,n.P1)(Vn,function(e){return e?.sql}),Gt.getSelectors()),km=(0,n.P1)(le,function(e){return e&&e.sqlGridResults}),qm=(0,n.P1)(km,Bm.selectEntities),Lm=(0,n.P1)(Ee,function(e){return e?.selectedSqlGridResultId}),Fm=((0,n.P1)(qm,xm,function(e,t){return t?.reduce(function(a,r){return e[r]?(0,o.__spreadArray)((0,o.__spreadArray)([],a,!0),[e[r]],!1):a},[])}),(0,n.P1)(Lm,le,function(e,t){return _.isEmpty(t)?void 0:t.sqlGridResults.entities[e]}),(0,n.P1)(Ee,function(e){return e?.sqlResultPaneSelectedView}),St.getSelectors()),Um=(0,n.P1)(le,function(e){return e?.sqlMessages}),Hm=(0,n.P1)(Um,Fm.selectEntities),Vm=((0,n.P1)(Hm,jm,function(e,t){return t?t.reduce(function(a,r){return e[r]?(0,o.__spreadArray)((0,o.__spreadArray)([],a,!0),[e[r]],!1):a},[]):[]}),(0,n.P1)(de,le,function(e,t){return e&&e.tabs.map(function(a){return t.queries.entities[N.X6.getQueryUrn(a)]})}),(0,n.P1)(ht,br,function(e,t){var a;return null===(a=e[N.X6.getQueryUrn(t)])||void 0===a?void 0:a.type}),(0,n.P1)(Ee,function(e){return e&&e.editorContext}),(0,n.P1)(Ee,function(e){return e&&e.isResultGridVisible}),(0,n.P1)(Ee,function(e){return e&&e.resultGridHeight}),(0,n.P1)(Ee,function(e){return e&&e.lastSqlRunId}),(0,n.P1)(Ee,function(e){return e&&e.lastSql}),(0,n.P1)(Ee,function(e){return e&&e.isQueryExecuting})),Qn=((0,n.P1)(Ee,function(e){return e&&e.isQueryCanceled}),(0,n.P1)(Ee,function(e){return e&&e.isBottomPaneMaximized}),(0,n.P1)(Ee,function(e){return e&&e.isExplainQueryRunning}),(0,n.P1)(Ee,function(e){return e&&e.isFixRunning}),(0,n.P1)(Dn,It,Et,function(e,t,a){return e&&(!_.isEmpty(t)||!_.isEmpty(a))}),(0,n.P1)(Hn,function(e){return e.reduce(function(a,r){return _.isEmpty(r.lastSqlRunId)||a.push({runId:r.lastSqlRunId,sql:r.lastSql}),a},[])}),(0,n.P1)(yr,function(e){return _.some(e,function(t){return 1===t.state||2===t.state})}),(0,n.P1)(kt,Hn,function(e,t){return{tables:e,queries:t}}),(0,n.P1)(Om,Rm,Sm,Em,Am,Nm,function(e,t,a,r,i,s){return{tables:e,views:t,storedProcedures:a,userDefinedFunctions:r,columns:i,measures:s}}),(0,n.P1)(Ve,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.objectId)&&(a[i]=s),a},{})})),Wn=(0,n.P1)(Yt,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseMetadata.datamartObjectId)&&(a[i]=s),a},{})}),Kn=(0,n.P1)(rr,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseMetadata.datamartObjectId)&&(a[i]=s),a},{})}),zn=(0,n.P1)(dr,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return("Queries"===s.name||_.includes(t.loadedWarehouseIds,s.warehouseMetadata.datamartObjectId))&&(a[i]=s),a},{})}),Qm=(0,n.P1)(gm,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseMetadata.datamartObjectId)&&(a[i]=s),a},{})}),Wm=(0,n.P1)(Pm,de,function(e,t){if(e&&t)return Object.entries(e).reduce(function(a,r){var i=r[0],s=r[1];return _.includes(t.loadedWarehouseIds,s.warehouseId)&&(a[i]=s),a},{})}),Km=(0,n.P1)(Qn,Wn,Kn,zn,Qm,Wm,function(e,t,a,r,i,s){return{warehouses:e,schemas:t,schemaObjectContainers:a,categories:r,databaseRoleContainers:i,databaseRoles:s}}),zm=(0,n.P1)(It,Et,Tn,Mn,aa,gr,yr,function(e,t,a,r,i,s,c){return{tables:e,views:t,storedProcedures:a,userDefinedFunctions:r,columns:i,measures:s,queries:c}}),Gn=((0,n.P1)(Km,zm,function(e,t){return(0,o.__assign)((0,o.__assign)({},e),t)}),(0,n.P1)(Ve,Yt,rr,ea,hr,dr,function(e,t,a,r,i,s){return{warehouses:e,schemas:t,schemaObjectContainers:a,tables:r,views:i,categories:s}})),Gm=((0,n.P1)(ge,function(e){return e&&e.viewAsRoles}),(0,n.P1)(ge,function(e){return e&&e.viewAsRoles.filter(function(t){return t.checked})}),(0,n.P1)(de,function(e){return e&&e.mwcTokenResponsePayload}),(0,n.P1)(Ee,function(e){return(new TextEncoder).encode(e?.sqlExpression).length/1024<512})),Te=((0,n.P1)(Vm,Gm,function(e,t){return!e&&t}),(0,n.P1)(Ga,function(e){return e&&e.flatMap(function(t){var a;return null!==(a=t.failedToLoadTableSyncErrors)&&void 0!==a?a:[]})}),(0,n.P1)(It,Et,function(e,t){return _.isEmpty(e)&&_.isEmpty(t)}),(0,n.P1)(le,function(e){var t=e.editors.entities[e.activeEditorId];if(e&&t&&t.selected){for(var a=[],r=0,i=Array.from(t.selected.items.values());r<i.length;r++){var c=Ur(e,i[r]);c&&a.push(c.value)}return a}}),(0,n.P1)(de,function(e){return e.loadingWarehousesIds}),(0,n.P1)(de,function(e){return e.loadedWarehouseIds}),(0,n.P1)(ge,function(e){return e&&e.isReadonly}),(0,n.P1)(le,function(e){return e.actionError}),(0,n.P1)(de,function(e){return e.oneLakeUrl}),(0,n.P1)(ge,function(e){return e&&e.modelingServiceIgnoreModelChanged}),(0,n.P1)(Ne,function(e){return e&&e.sampleName}),(0,n.P1)(Ga,nr,Dm,function(e,t,a){if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r];if(s.isSyncRunning||s.autoRefreshingFromQueryExecution||s.isObjectContainerRefreshing)return!0}if(a)for(var c=0,u=a;c<u.length;c++)if(u[c].isObjectContainerRefreshing)return!0;if(t)for(var p=0,v=t;p<v.length;p++)if(v[p].isObjectContainerRefreshing)return!0;return!1}),(0,n.P1)(Qn,zn,Wn,Kn,It,Et,aa,function(e,t,a,r,i,s,c){return{datamarts:e,categories:t,schemas:a,schemaObjectContainers:r,tables:i,views:s,columns:c}}),(0,n.P1)(Zt,de,function(e,t){if(e&&1!==e&&t)return t.fieldListFilters}),g(59725)),Pt=g(82842),me=g(82332),Xm=g(69637);var $n=((Ct={}).Table=0,Ct.View=1,Ct.UserDefinedFunction=2,Ct.StoredProcedure=3,Ct),d=g(50423),Ot=g(65181),qt=g(9380),Xn=function(){function e(t,a,r){this.localizationService=t,this.featureSwitch=a,this.store=r,this.iconsAriaLabels={},this.getIconsAriaLabels()}return e.prototype.convertModelToPbiTree=function(t,a,r,i,s,c,u){var m=this;L.fF.assertValue(t,"models must be defined"),s?this.datamartType=c:this.store.select(Zt).pipe((0,B.q)(1)).subscribe(function(C){m.datamartType=C}),this.models=t,this.fromDatahub=a,this.fromManageDefaultDataset=i;var p=[],v={data:null,displayName:"root",draggable:!1,id:"model_root"};v.children=p;var b={nodes:p,parent:v};if(_.isEmpty(t.categories)&&!s)return b;var O,E=r&&t.warehouses[r],D=E&&"LOADED"===E.queriesLoadState;if(1===this.datamartType||this.fromDatahub)_.forEach(t.categories,function(C){if("Queries"!==C.name){var I=m.convertCategoryToPbiTreeNode(v,C,D);p.push(I)}else O=m.convertQueryCategoryToPbiTreeNode(v,D)}),_.isEmpty(O)||p.push(O);else if(this.fromManageDefaultDataset)_.forEach(t.schemas,function(C){var I=!1;if(s?I=u:m.store.select(hn(C.warehouseMetadata.datamartObjectId)).pipe((0,B.q)(1)).subscribe(function(M){I=M}),C.name!==J._.informationSchema&&C.name!==J._.sysSchema&&I){var P=m.convertSchemaToPbiTreeNode(v,C,I);p.push(P)}});else{_.forEach(t.warehouses,function(C){var I=m.convertWarehouseToPbiTreeNode(v,C);p.push(I)});var A=this.convertQueryCategoryToPbiTreeNode(v,D);p.push(A)}return this.sortNodes(p),b},e.prototype.convertWarehouseToPbiTreeNode=function(t,a){var r=this;L.fF.assertValue(a,"warehouse must be defined"),L.fF.assertValue(t,"parentNode must be defined");var i=!0;this.store.select(hn(a.objectId)).pipe((0,B.q)(1)).subscribe(function(u){i=u});var s={type:0,glyph:""},c={data:a,displayName:a.name,icon:s,checkable:!1,draggable:!1,id:"warehouse_".concat(a.name),tooltip:!0,parent:t,editable:!1,menu:1!==this.datamartType&&(this.featureSwitch.featureSwitches.warehouseCrossDbQueries&&!i||this.featureSwitch.featureSwitches.datamartObjectContainerRefresh),ariaLabel:"".concat(this.iconsAriaLabels[s.glyph]," ").concat(a.name),expanded:i,children:[],inlineItems:this.getWarehouseInlineItems(a),alwaysShowInlineItems:!0};return a.categoryUrns.forEach(function(u){var m=r.convertCategoryToPbiTreeNode(c,r.models.categories[u],i);c.children.push(m)}),c},e.prototype.getWarehouseInlineItems=function(t){var a,r;if(t.autoRefreshing||t.autoRefreshingFromQueryExecution||t.loadingForSearch||t.isSyncRunning||t.isObjectContainerRefreshing||"LOADING"===t.schemaLoadState)return[{type:Te.Q_.Spinner}];if("LOADED"===t.schemaLoadState&&null!==(r=null===(a=t.databaseDefinition)||void 0===a?void 0:a.databaseDefinitionProperties)&&void 0!==r&&r.isStale){var i=t.databaseDefinition.databaseDefinitionProperties.lastUpdatedAt;return[{type:Te.Q_.Spinner,label:i?this.localizationService.format("Datamart_StaleSchemaWithCache",(0,Xm.Wh)(new Date(i).toLocaleString(),this.localizationService)):this.getLocalizedString("Datamart_StaleSchemaWithoutCache")}]}return"ERROR"===t.schemaLoadState&&t.hasLockTimeoutException?[{type:Te.Q_.Spinner,label:this.getLocalizedString("Datamart_StaleSchemaWithoutCache")}]:[]},e.prototype.convertQueryCategoryToPbiTreeNode=function(t,a){var r=_.find(this.models.categories,function(c){return"Queries"===c.name});L.fF.assertValue(r,"category must be defined"),L.fF.assertValue(t,"parentNode must be defined");var i={type:0,glyph:""},s={data:r,displayName:r.name,icon:i,checkable:!1,draggable:!1,id:"category_".concat(r.name),tooltip:!0,parent:t,editable:!1,menu:!1,ariaLabel:"".concat(this.iconsAriaLabels[i.glyph]," ").concat(r.name),expanded:!0,children:[]};return this.convertQueries(s,a),s},e.prototype.convertCategoryToPbiTreeNode=function(t,a,r,i){var s=this;L.fF.assertValue(a,"category must be defined"),L.fF.assertValue(t,"parentNode must be defined");var c={data:a,displayName:a.name,icon:this.getTridentIcon(a),checkable:!1,draggable:!1,id:"category_".concat(a.name),tooltip:!0,parent:t,editable:!1,menu:!(!this.featureSwitch.featureSwitches.datamartObjectContainerRefresh||1===this.datamartType),ariaLabel:"".concat(this.iconsAriaLabels[this.getDefaultIcon(a)]," ").concat(a.name),expanded:!1,children:[],inlineItems:this.getCategoryInlineItems(a),alwaysShowInlineItems:!0};switch(a.name){case"Tables":return a.childrenUrns.forEach(function(u){var m=s.convertTableToPbiTreeNode(c,s.models.tables[u]);c.children.push(m)}),c;case"Schemas":return this.featureSwitch.featureSwitches.sqlQueryTemplates&&4===this.datamartType&&i&&(c.menu=!0),a.childrenUrns.forEach(function(u){var m=s.convertSchemaToPbiTreeNode(c,s.models.schemas[u],i);c.children.push(m)}),c;case"Queries":return this.convertQueries(c,r),c;case"Security":return a.childrenUrns.forEach(function(u){var m=s.convertDatabaseRoleContainerToPbiTreeNode(c,s.models.databaseRoleContainers[u]);c.children.push(m)}),c;default:return c}},e.prototype.getCategoryInlineItems=function(t){return t.isObjectContainerRefreshing?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertDatabaseRoleContainerToPbiTreeNode=function(t,a){var r=this;L.fF.assertValue(a,"databaseRoleContainer must be defined"),L.fF.assertValue(t,"parentNode must be defined");var i={data:a,displayName:a.childrenRoleType,icon:this.getTridentIcon(a),checkable:!1,draggable:!1,id:"databaseRoleContainer_".concat(a.name),tooltip:!0,parent:t,editable:!1,menu:!1,ariaLabel:"".concat(this.iconsAriaLabels[this.getDefaultIcon(a)]," ").concat(a.name),expanded:!1,children:[],inlineItems:this.getDatabaseRoleContainerInlineItems(a),forceExpandable:!0};return a.databaseRoleUrns.forEach(function(s){var c=r.convertDatabaseRoleToPbiTreeNode(i,r.models.databaseRoles[s]);i.children.push(c)}),i},e.prototype.getDatabaseRoleContainerInlineItems=function(t){return t.loadingForIncrementalLoad?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertQueries=function(t,a){var r=this;if(this.featureSwitch.featureSwitches.sharedQueries){var i=this.convertQueryToSubQueries("SharedQueries",this.getLocalizedString("SharedQueries"),"SharedQuery",t,a),s=this.convertQueryToSubQueries("MyQueries",this.getLocalizedString("MyQueries"),"MyQuery",t,a);_.forEach(this.models.queries,function(c){var u=r.convertQueryToPbiTreeNode(c);u.parent=c.isShared?i:s,u.parent.children.push(u)}),t.children.push(s),t.children.push(i)}else _.forEach(this.models.queries,function(c){var u=r.convertQueryToPbiTreeNode(c);u.parent=t,t.children.push(u)})},e.prototype.convertDatabaseRoleToPbiTreeNode=function(t,a){return L.fF.assertValue(a,"databaseRole must be defined"),L.fF.assertValue(t,"parentNode must be defined"),this.convertLeafObjectsToPbiTreeNode(t,a,"databaseRole",this.getTridentIcon(a),!1)},e.prototype.convertQueryToSubQueries=function(t,a,r,i,s){var c={type:1,sheet:"icons",symbolId:"tridentFolderRegularIcon"},u={objectType:r,name:a,urn:t};return{data:u,displayName:u.name,icon:c,checkable:!1,draggable:!1,id:"category_".concat(t),tooltip:!0,parent:i,editable:!1,menu:!0,ariaLabel:"".concat(this.iconsAriaLabels[c.symbolId]," ").concat(u.name),expanded:!0,inlineItems:s?void 0:[{type:Te.Q_.Spinner}],children:[]}},e.prototype.convertSchemaToPbiTreeNode=function(t,a,r){var i=this;L.fF.assertValue(a,"schema must be defined"),L.fF.assertValue(t,"parentNode must be defined");var s_glyph=this.getDefaultIcon(a),c={data:a,displayName:a.name,icon:this.getTridentIcon(a),checkable:this.fromManageDefaultDataset,draggable:!1,id:"schema_".concat(a.name),tooltip:!0,parent:t,editable:!1,menu:!(!this.featureSwitch.featureSwitches.sqlQueryTemplates||4!==this.datamartType||!r||this.fromManageDefaultDataset),ariaLabel:"".concat(this.iconsAriaLabels[s_glyph]," ").concat(a.name),expanded:!1,children:[],forceExpandable:!0};return a.schemaObjectContainersUrns.forEach(function(u){if(i.fromManageDefaultDataset&&"StoredProcedure"!==i.models.schemaObjectContainers[u].childrenType&&"UserDefinedFunction"!==i.models.schemaObjectContainers[u].childrenType||!i.fromManageDefaultDataset){var m=i.convertSchemaObjectContainerToPbiTreeNode(c,i.models.schemaObjectContainers[u],r);c.children.push(m)}i.updateTreeNodeState(c)}),c},e.prototype.convertSchemaObjectContainerToPbiTreeNode=function(t,a,r){var i=this;L.fF.assertValue(a,"schemaObjectContainer must be defined"),L.fF.assertValue(t,"parentNode must be defined");var s={data:a,displayName:a.name,icon:this.getTridentIcon(a),checkable:this.fromManageDefaultDataset,draggable:!1,id:"schemaObjectContainer_".concat(a.name),tooltip:!0,parent:t,editable:!1,menu:this.getSchemaObjectContainerMenu(a,r)&&!this.fromManageDefaultDataset,ariaLabel:"".concat(this.iconsAriaLabels[this.getDefaultIcon(a)]," ").concat(a.name),expanded:!1,children:[],forceExpandable:!0,inlineItems:this.getSchemaObjectContainerInlineItems(a),alwaysShowInlineItems:!0};switch(a.childrenType){case"Table":return a.childrenUrns.forEach(function(c){var u=i.convertTableToPbiTreeNode(s,i.models.tables[c]);s.children.push(u)}),this.updateTreeNodeState(s),s;case"View":return this.featureSwitch.featureSwitches.sqlQueryTemplates&&2===this.datamartType&&(s.menu=!0),a.childrenUrns.forEach(function(c){var u=i.convertViewToPbiTreeNode(s,i.models.views[c]);s.children.push(u)}),this.updateTreeNodeState(s),s;case"StoredProcedure":return this.featureSwitch.featureSwitches.sqlQueryTemplates&&2===this.datamartType&&(s.menu=!0),a.childrenUrns.forEach(function(c){var u=i.convertStoredProcedureToPbiTreeNode(s,i.models.storedProcedures[c]);s.children.push(u)}),s;case"UserDefinedFunction":return a.childrenUrns.forEach(function(c){var u=i.convertUserDefinedFunctionToPbiTreeNode(s,i.models.userDefinedFunctions[c]);s.children.push(u)}),s;default:return s}},e.prototype.getSchemaObjectContainerMenu=function(t,a){return!t.loadingForIncrementalLoad&&!!(this.featureSwitch.featureSwitches.sqlQueryTemplates&&4===this.datamartType&&a||this.featureSwitch.featureSwitches.datamartObjectContainerRefresh&&1!==this.datamartType)},e.prototype.getSchemaObjectContainerInlineItems=function(t){return t.loadingForIncrementalLoad||t.isObjectContainerRefreshing?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertTableToPbiTreeNode=function(t,a){var r=this;L.fF.assertValue(a,"table must be defined"),L.fF.assertValue(t,"parentNode must be defined");var i=Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(a.name,a,this.getTridentIcon(a)).extendPbiTreeNode({draggable:!this.fromDatahub,id:"table_".concat(a.name),tooltip:!0,parent:t,editable:!this.fromManageDefaultDataset&&a.canEdit,checkable:this.fromManageDefaultDataset,checked:a.isBiObject,disabled:!!this.fromManageDefaultDataset&&!_.isEmpty(a.measures),children:[],alwaysShowInlineItems:!0,inlineItems:this.getTableInlineItems(a),menu:!this.fromDatahub&&!this.fromManageDefaultDataset,expanded:!1}).getPbiTreeNode();return this.fromManageDefaultDataset||(a.columns.forEach(function(s){var c=r.convertColumnToPbiTreeNode(i,r.models.columns[s]);i.children.push(c)}),a.measures.forEach(function(s){var c=r.convertMeasureToPbiTreeNode(i,r.models.measures[s]);i.children.push(c)})),i},e.prototype.getTableInlineItems=function(t){var a=[{type:Te.Q_.Button,id:"table_sync_error",icon:{type:1,sheet:"fluentui-icons",symbolId:"dismiss_circle_20_filled"},label:this.getLocalizedString("SyncError")}],r=[{type:Te.Q_.Icon,id:"table_sync_warning",icon:{type:1,sheet:"fluentui-icons",symbolId:"warning_20_filled"},label:this.getLocalizedString("SyncWarning")}];return t.generatingSqlScript?[{type:Te.Q_.Spinner}]:_.isEmpty(t.syncWarnings)?_.isEmpty(t.syncErrors)?[]:a:r},e.prototype.convertQueryToPbiTreeNode=function(t){return L.fF.assertValue(t,"query must be defined"),Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(t.name,_.clone(t),this.getTridentIcon(t)).extendPbiTreeNode({draggable:!1,id:"query_".concat(t.urn),tooltip:!0,editable:!0,children:[],menu:!0}).getPbiTreeNode()},e.prototype.convertViewToPbiTreeNode=function(t,a){var r=this;L.fF.assertValue(a,"view must be defined"),L.fF.assertValue(t,"parentNode must be defined");var i=Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(a.name,a,this.getTridentIcon(a)).extendPbiTreeNode({draggable:!this.fromDatahub,id:"view_".concat(a.name),tooltip:!0,parent:t,editable:!this.fromManageDefaultDataset&&a.canEdit,checkable:this.fromManageDefaultDataset,checked:a.isBiObject,disabled:!!this.fromManageDefaultDataset&&!_.isEmpty(a.measures),children:[],menu:!this.fromDatahub&&!this.fromManageDefaultDataset,alwaysShowInlineItems:!0,inlineItems:this.getViewInlineItems(a)}).getPbiTreeNode();return this.fromManageDefaultDataset||(a.columns.forEach(function(s){var c=r.convertColumnToPbiTreeNode(i,r.models.columns[s]);i.children.push(c)}),a.measures.forEach(function(s){var c=r.convertMeasureToPbiTreeNode(i,r.models.measures[s]);i.children.push(c)})),i},e.prototype.getViewInlineItems=function(t){return t.generatingSqlScript?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertColumnToPbiTreeNode=function(t,a){return L.fF.assertValue(a,"column must be defined"),L.fF.assertValue(t,"parentNode must be defined"),this.convertLeafObjectsToPbiTreeNode(t,a,"column",this.getColumnDataTypeTridentIcon(a),!this.fromDatahub)},e.prototype.convertMeasureToPbiTreeNode=function(t,a){return L.fF.assertValue(a,"measure must be defined"),L.fF.assertValue(t,"parentNode must be defined"),this.convertLeafObjectsToPbiTreeNode(t,a,"measure",this.getTridentIcon(a),!this.fromDatahub)},e.prototype.convertStoredProcedureToPbiTreeNode=function(t,a){return L.fF.assertValue(a,"storedProcedure must be defined"),L.fF.assertValue(t,"parentNode must be defined"),Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(a.name,a,this.getTridentIcon(a)).extendPbiTreeNode({draggable:!1,id:"storedProcedure_".concat(a.name),tooltip:!0,parent:t,editable:a.canEdit,children:[],menu:!this.fromDatahub,alwaysShowInlineItems:!0,inlineItems:this.getstoredProcedureInlineItems(a)}).getPbiTreeNode()},e.prototype.getstoredProcedureInlineItems=function(t){return t.generatingSqlScript?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertUserDefinedFunctionToPbiTreeNode=function(t,a){L.fF.assertValue(a,"userDefinedFunction must be defined"),L.fF.assertValue(t,"parentNode must be defined");var r={type:0,glyph:this.getDefaultIcon(a)};return Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(a.name,a,r).extendPbiTreeNode({draggable:!1,id:"userDefinedFunction_".concat(a.name),tooltip:!0,parent:t,editable:a.canEdit,children:[],menu:!1,alwaysShowInlineItems:!0,inlineItems:this.getUserDefinedFunctionInlineItems(a)}).getPbiTreeNode()},e.prototype.getUserDefinedFunctionInlineItems=function(t){return t.generatingSqlScript?[{type:Te.Q_.Spinner}]:[]},e.prototype.convertLeafObjectsToPbiTreeNode=function(t,a,r,i,s){return void 0===s&&(s=!0),L.fF.assertValue(a,"target must be defined"),L.fF.assertValue(t,"parentNode must be defined"),Pt._.createBuilder(this.localizationService).createDefaultPbiTreeNode(a.name,a,i).extendPbiTreeNode({draggable:s,id:"".concat(r,"_").concat(a.name),tooltip:!0,parent:t,editable:a.canEdit,children:[],menu:!this.fromDatahub}).getPbiTreeNode()},e.prototype.sortNodes=function(t,a){if(!_.isEmpty(t)&&t){!function(e,t){_.isEmpty(e)||null==t||"model_root"===t.id||(Ba(t.data)?e.sort(function(a,r){var i=a.data,s=r.data;return rt(i)&&rt(s)?$n[i.childrenType]-$n[s.childrenType]:0}):zt(e[0].data)?function(e){var t=[],a=[];(function(e,t,a){if(void 0===t&&(t=[]),void 0===a&&(a=[]),!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var s=i[r];zt(s.data)?s.data.isMeasureGroup?t.push(s):a.push(s):L.fF.assertFail("node data should be table type")}})(e,t,a),t.sort(function(i,s){return i.data.name.localeCompare(s.data.name)}),a.sort(function(i,s){return i.data.name.localeCompare(s.data.name)});for(var r=0;r<t.length;r++)e[r]=t[r];for(r=0;r<a.length;r++)e[t.length+r]=a[r]}(e):xt(e[0].data)?e.sort(function(a,r){var i=a.data,s=r.data;return xt(i)&&xt(s)?i.index-s.index:0}):e.sort(function(a,r){return a.data.name.localeCompare(r.data.name)}))}(t,a);for(var r=0,i=t;r<i.length;r++){var s=i[r];this.sortNodes(s?.children,s)}}},e.prototype.getDefaultIcon=function(t){return an(t)?t.isChangeDetection?me.I9:me.ou:zt(t)?me.b$:xt(t)?this.getDefaultColumnIcon(t):en(t)?me.qV:Ba(t)||rt(t)||Dt(t)||Yr(t)?me.TC:tn(t)||function(e){return e&&"UserDefinedFunction"===e.objectType}(t)?me.O9:""},e.prototype.getTridentIcon=function(t){var a="";return zt(t)&&(a="tridentTableRegularIcon"),xt(t)&&(a="tridentColumnRegularIcon"),an(t)&&(a="tridentMeasureRegularIcon"),Ba(t)&&(a="tridentSchemaRegularIcon"),(rt(t)||Dt(t)||Yr(t))&&(a="tridentFolderRegularIcon"),en(t)&&(a="tridentViewRegularIcon"),tn(t)&&(a="tridentStoredProcedureRegularIcon"),function(e){return e&&"Query"===e.objectType}(t)&&(a=0===t.type?"tridentSQLQueryRegularIcon":"tridentVisualQueryRegularIcon"),function(e){return e&&"DatabaseRole"===e.objectType}(t)&&(a="tridentPersonLockIcon"),{type:1,sheet:"icons",symbolId:a}},e.prototype.getDefaultColumnIcon=function(t){return t.isGrouping?me.ur:function(e){return e&&"Calculated"===e.columnType}(t)?rn(t)?me.Nc:me.O9:t.isDateTime?me.G3:t.isDefaultLabel||t.isKey?me.WE:rn(t)&&"None"!==t.summarizeBy?me.dz:me.aI},e.prototype.getColumnDataTypeTridentIcon=function(t){var a="tridentColumnRegularIcon";switch(t.sqlDataType){case 4:a="tridentCalendar";break;case 5:a="tridentClock";break;case 6:a="tridentCalendarClock";break;case 19:a="tridentMathExponent";break;case 3:a="tridentUniqueIdentifier";break;case 10:case 20:a="tridentInteger";break;case 9:a="tridentShortNumber";break;case 12:a="tridentRealNumber";break;case 15:a="tridentFloat";break;case 18:a="tridentBit";break;case 22:a="tridentLong";break;case 23:a="tridentBinary";break;case 26:case 24:a="tridentString"}return{type:1,sheet:"icons",symbolId:a}},e.prototype.getIconsAriaLabels=function(){this.iconsAriaLabels[me.ou]=this.getLocalizedString("Icon_AriaLabel_MeasureField"),this.iconsAriaLabels[me.zF]=this.getLocalizedString("kpi_Tooltip"),this.iconsAriaLabels[me.EF]=this.getLocalizedString("Icon_AriaLabel_HierarchyField"),this.iconsAriaLabels[me.tV]=this.getLocalizedString("Icon_AriaLabel_CalculatedTable"),this.iconsAriaLabels[me.vc]=this.getLocalizedString("Icon_AriaLabel_MeasureGroupTable"),this.iconsAriaLabels[me.b$]=this.getLocalizedString("Table_ToolTip"),this.iconsAriaLabels[me.ur]=this.getLocalizedString("Icon_AriaLabel_GroupField"),this.iconsAriaLabels[me.O9]=this.getLocalizedString("Icon_AriaLabel_NonNumericCalculatedField"),this.iconsAriaLabels[me.Nc]=this.getLocalizedString("Icon_AriaLabel_NumericCalculatedField"),this.iconsAriaLabels[me.dz]=this.getLocalizedString("Icon_AriaLabel_NumericField"),this.iconsAriaLabels[me.Yq]=this.getLocalizedString("Icon_AriaLabel_GeoField"),this.iconsAriaLabels[me.G3]=this.getLocalizedString("Icon_AriaLabel_CalendarField"),this.iconsAriaLabels[me.WE]=this.getLocalizedString("Icon_AriaLabel_IdentifyField"),this.iconsAriaLabels[me.LG]=this.getLocalizedString("Icon_AriaLabel_Parameter"),this.iconsAriaLabels[me.aI]=this.getLocalizedString("Icon_AriaLabel_TableColumn"),this.iconsAriaLabels[me.TC]=this.getLocalizedString("Display_Folder")},e.prototype.getLocalizedString=function(t){return"".concat(this.localizationService.get(t))},e.prototype.updateTreeNodeState=function(t){var a=t.children.filter(function(i){return!i.disabled}),r=t.children.length>0&&t.children.every(function(i){return i.checked});t.checked=r,t.isIndeterminate=t.children.some(function(i){return i.checked||i.isIndeterminate})&&!r,t.disabled=!!this.fromManageDefaultDataset&&0===a.length},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Ot.o),d.\u0275\u0275inject(qt.vZ),d.\u0275\u0275inject(n.yh))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Zn=g(16789),_r=function(){function e(t){this.defaultSearchStrategy=t}return e.prototype.applySearchState=function(t){var a,r=t.tree,i=t.term;i&&i.length||t.filter?this.noSearchState||(this.noSearchState=r.treeControl.expansionModel.selected,r.virtualScroll.scrollToIndex(0),r.expandAll(!0,!1)):this.noSearchState&&(r.collapseAll(!0,!1),(a=r.treeControl.expansionModel).select.apply(a,this.noSearchState||[]),r.virtualScroll.scrollToIndex(0),this.noSearchState=null)},e.prototype.search=function(t){return this.defaultSearchStrategy.search({flatNodes:t.flatNodes,search:t.search})},e.prototype.filter=function(t,a){var r;if(!a)return t;for(var i=[],s=[],c=0;c<t.length;c++){var u=t[c];if(u.expandable){for(;s.length&&u.level<=s[s.length-1].level;)s.pop();s.push(u)}var m=u.node.data.objectType;if(this.isKeyOfFieldListFilters(m,a)&&this.shouldIncludeNode(a,m,u.node.data)){if(s.length){for(;!u.expandable&&s.length&&u.level<=s[s.length-1].level;)s.pop();i.push.apply(i,s||[]),s=[]}if(u.expandable){for(c++;c<t.length&&u.level<t[c].level;)(null===(r=a.Schema)||void 0===r?void 0:r.length)>0&&(a.Table||a.View)?this.shouldInlcudeNodeWithSchemaFilter(a,t[c].node.data)&&i.push(t[c]):i.push(t[c]),c++;c=c>=t.length?c:c-1}else i.push(u)}}return i},e.prototype.isKeyOfFieldListFilters=function(t,a){return t in a},e.prototype.shouldInlcudeNodeWithSchemaFilter=function(t,a){return"SchemaObjectContainer"!==a.objectType?this.shouldIncludeNode(t,a.objectType,a):this.isKeyOfFieldListFilters(a.childrenType,t)?t[a.childrenType]:void 0},e.prototype.shouldIncludeNode=function(t,a,r){var i;if(this.isKeyOfFieldListFilters(a,t)){var s=(null===(i=t.Schema)||void 0===i?void 0:i.length)>0&&(t.Table||t.View);return"Schema"===a?this.hasSchemaFilter(t,r.name):s?this.hasSchemaFilter(t,r.schemaName)&&t[a]:t[a]}},e.prototype.hasSchemaFilter=function(t,a){var r=t.Schema;return r?.includes(a)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Zn.XI))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ep=function(){function e(){}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=d.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=d.\u0275\u0275defineInjector({providers:[Xn,_r],imports:[h.CommonModule,V.v,fe.g]}),e}(),tp=g(44913),ap=g(22645),rp=function(){function e(){}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=d.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=d.\u0275\u0275defineInjector({imports:[h.CommonModule,V.v,tp.lK,ap.V]}),e}(),np=g(14977),ip=g(16149),sp=g(30435),op=g(46303),cp=g(5915),dp=g(17177),ra=new d.InjectionToken("ManageDatasetServiceInjectionToken"),Qe=g(67489),Tt=g(60756),X=g(14172),xe=g(42195),na=g(59822),Sr=g(94853),Jn="PBI.SeeThroughModeling.EditTables.ConfirmButton.Click",up=l.cx[Jn]=(0,l.b1)(Jn),Yn="PBI.SeeThroughModeling.EditTables.CancelButton.Click",lp=l.cx[Yn]=(0,l.b1)(Yn),ei="PBI.SeeThroughModeling.OnRefreshSchema",mp=l.cx[ei]=(0,l.b1)(ei),ti="PBI.SeeThroughDataset.GetDatamartVersion",pp=l.cx[ti]=(0,l.b1)(ti),ai="PBI.SeeThroughDataset.LockDatamart",vp=l.cx[ai]=(0,l.b1)(ai),ri="PBI.SeeThroughDataset.GetDatamartPermission",fp=l.cx[ri]=(0,l.b1)(ri),ni="PBI.SeeThroughDataset.OnAddOrRemoveTableInBI",hp=l.cx[ni]=(0,l.b1)(ni),ii="PBI.SeeThroughDataset.OnGetDatamartSchema",gp=l.cx[ii]=(0,l.b1)(ii),si="PBI.SeeThroughDataset.OnCreateSeeThroughModel",bp=l.cx[si]=(0,l.b1)(si),oi="PBI.Datamart.OnAddOrRemoveTableInBI",ci=l.cx[oi]=(0,l.b1)(oi),di="PBI.Datamart.Ribbon.NewReport.ManageDefaultDataset.Click",yp=l.cx[di]=(0,l.b1)(di),ui="PBI.Datamart.Ribbon.AutoUpdateDefaultDataset.OnAddOrRemoveTableInBI.",Dp=l.cx[ui]=(0,l.b1)(ui),li="PBI.Datamart.Ribbon.NewReport.ConfirmButton.Click",_p=l.cx[li]=(0,l.b1)(li),mi="PBI.Datamart.Ribbon.UpdateDefaultDataset.CancelButton.Click",Sp=l.cx[mi]=(0,l.b1)(mi),Lt=g(96608),Ip=g(4633),Ep=g(73058),Ft=g(60225),we=g(11547),pi=g(37272),vi=g(40133),Pp=g(19828),Cp=g(24753),fi=g(96038),ia=g(17653),hi=g(59973),Je=g(83317),gi="PBI.Datamart.MashupEditor.NewClient",bi=(l.cx[gi]=(0,l.b1)(gi),"PBI.Datamart.MashupEditor.Exception"),yi=(l.cx[bi]=(0,l.b1)(bi),"PBI.Datamart.MashupEditor.Cancel"),Di=(l.cx[yi]=(0,l.b1)(yi),"PBI.Datamart.Measure.New"),_i=(l.cx[Di]=(0,l.b1)(Di),"PBI.Datamart.DataExplorer.Preview"),Si=(l.cx[_i]=(0,l.b1)(_i),"PBI.Datamart.SqlEditor.AutocompletionAccepted"),Ii=(l.cx[Si]=(0,l.b1)(Si),"PBI.Datamart.SqlEditor.Autocompletion.Cancelled"),Ei=(l.cx[Ii]=(0,l.b1)(Ii),"PBI.Datamart.SqlEditor.Autocompletion.Accepted"),Pi=(l.cx[Ei]=(0,l.b1)(Ei),"PBI.Datamart.SqlEditor.Autocompletion.Feedback"),Ci=(l.cx[Pi]=(0,l.b1)(Pi),"PBI.Datamart.SqlEditor.Autocompletion.Generated"),Oi=(l.cx[Ci]=(0,l.b1)(Ci),"PBI.Datamart.SqlEditor.Autocompletion.NoResponse"),Ti=(l.cx[Oi]=(0,l.b1)(Oi),"PBI.Datamart.SqlEditor.ExplainQuery.Click"),wi=(l.cx[Ti]=(0,l.b1)(Ti),"PBI.Datamart.SqlEditor.ExplainQuery"),Ri=(l.cx[wi]=(0,l.b1)(wi),"PBI.Datamart.SqlEditor.ExplainQuery.fragments"),Mi=(l.cx[Ri]=(0,l.b1)(Ri),"PBI.Datamart.SqlEditor.ExplainQuery.PromptException"),Ai=(l.cx[Mi]=(0,l.b1)(Mi),"PBI.Datamart.SqlEditor.FixQuery"),Ni=(l.cx[Ai]=(0,l.b1)(Ai),"PBI.Datamart.SqlEditor.FixQuery.click"),xi=(l.cx[Ni]=(0,l.b1)(Ni),"PBI.Datamart.SqlEditor.FixQuery.Fragments"),ji=(l.cx[xi]=(0,l.b1)(xi),"PBI.Datamart.SqlEditor.FixQuery.FragmentException"),Bi=(l.cx[ji]=(0,l.b1)(ji),"PBI.Datamart.SqlEditor.Sql"),ki=(l.cx[Bi]=(0,l.b1)(Bi),"PBI_Datamart_SqlEditor_Run"),qi=(l.cx[ki]=(0,l.b1)(ki),"PBI_Datamart_SqlEditor_Save"),Li=(l.cx[qi]=(0,l.b1)(qi),"PBI_Datamart_SqlEditor_Cancel"),Fi=(l.cx[Li]=(0,l.b1)(Li),"PBI.Datamart.SqlEditor.OpenInExcel"),Ui=(l.cx[Fi]=(0,l.b1)(Fi),"PBI.Datamart.MashupEditor.OpenInExcel"),Hi=(l.cx[Ui]=(0,l.b1)(Ui),"PBI.Datamart.MashupEditor.VisualizeResults"),Vi=(l.cx[Hi]=(0,l.b1)(Hi),"PBI.Datamart.Copilot.Exception"),Qi=(l.cx[Vi]=(0,l.b1)(Vi),"PBI.Datamart.Copilot.GenerateSql"),Wi=(l.cx[Qi]=(0,l.b1)(Qi),"PBI.Datamart.Copilot.Ask.Click"),Ki=(l.cx[Wi]=(0,l.b1)(Wi),"PBI.Datamart.Copilot.HelpPane.Click"),zi="PBI.Datamart.Copilot.Toggle.Click",Gi=(l.cx[Ki]=(0,l.b1)(Ki),"PBI.Datamart.Copilot.Suggestion.Edit.Click"),$i=(l.cx[Gi]=(0,l.b1)(Gi),l.cx[zi]=(0,l.b1)(zi),"PBI.Datamart.Create"),Xi=(l.cx[$i]=(0,l.b1)($i),"PBI.Datamart.Save"),Zi=(l.cx[Xi]=(0,l.b1)(Xi),"PBI.Datamart.Open"),Ji=(l.cx[Zi]=(0,l.b1)(Zi),"PBI.Datamart.ModellingChange.Apply"),Yi=(l.cx[Ji]=(0,l.b1)(Ji),"PBI.Datamart.ModelView.Load"),es=(l.cx[Yi]=(0,l.b1)(Yi),"PBI.Datamart.Editor.InReadonlyMode"),ts=(l.cx[es]=(0,l.b1)(es),"PBI.Datamart.IncrementalRefreshSetting"),as=(l.cx[ts]=(0,l.b1)(ts),"PBI.Datamart.PromoBanner.Dismiss"),rs=(l.cx[as]=(0,l.b1)(as),"PBI.Datamart.PromoBanner.CreateDatamart"),ns=(l.cx[rs]=(0,l.b1)(rs),"PBI.Datamart.Ribbon.RLS.Click"),is=(l.cx[ns]=(0,l.b1)(ns),"PBI.Datamart.Ribbon.ViewAsRole.Click"),ss=(l.cx[is]=(0,l.b1)(is),"PBI.Datamart.Ribbon.GetData.Click"),os=(l.cx[ss]=(0,l.b1)(ss),"PBI_Datamart_Create_PowerPlatformDataflows_Click"),cs=(l.cx[os]=(0,l.b1)(os),"PBI_Datamart_Ribbon_GetDataNewPipeline_Click"),ds=(l.cx[cs]=(0,l.b1)(cs),"PBI_Datamart_Ribbon_GetDataNewDataflowGen2_Click"),us=(l.cx[ds]=(0,l.b1)(ds),"PBI_Datamart_Ribbon_TransformData_Click"),ls=(l.cx[us]=(0,l.b1)(us),"PBI_Datamart_Ribbon_EnterData_Click"),ms=(l.cx[ls]=(0,l.b1)(ls),"PBI_Datamart_Ribbon_Settings_Click"),ps=(l.cx[ms]=(0,l.b1)(ms),"PBI_Datamart_Ribbon_NewQuery_Click"),vs=(l.cx[ps]=(0,l.b1)(ps),"PBI.Datamart.Ribbon.NewQuery.Click.InReadonlyMode"),fs=(l.cx[vs]=(0,l.b1)(vs),"PBI.Datamart.Ribbon.NewReport.Click"),hs=(l.cx[fs]=(0,l.b1)(fs),"PBI.Datamart.Ribbon.NewReport.Click.InReadonlyMode"),gs=(l.cx[hs]=(0,l.b1)(hs),"PBI.Datamart.Ribbon.NewDataset.Click"),bs=(l.cx[gs]=(0,l.b1)(gs),"PBI.Datamart.Ribbon.ManageDefaultDataset.Click"),ys=(l.cx[bs]=(0,l.b1)(bs),"PBI.Datamart.InfoMessageBar.ManuallyUpdateDataset.Click"),Ds=(l.cx[ys]=(0,l.b1)(ys),"PBI.Datamart.InfoMessageBar.Dismiss"),_s=(l.cx[Ds]=(0,l.b1)(Ds),"PBI.Datamart.Readonly.InfoMessageBar.Dismiss"),Ss=(l.cx[_s]=(0,l.b1)(_s),"PBI.Datamart.Ribbon.AutoUpdateDefaultDataset.Click"),Is=(l.cx[Ss]=(0,l.b1)(Ss),"PBI.Datamart.Ribbon.ManageDefaultDataset.ConfirmButton.Click"),Es=(l.cx[Is]=(0,l.b1)(Is),"PBI.Datamart.Ribbon.ManageDefaultDataset.CancelButton.Click"),Ps=(l.cx[Es]=(0,l.b1)(Es),"PBI.Datamart.Ribbon.AutoUpdateDefaultDataset.OnAddOrRemoveTableInBI."),Cs=(l.cx[Ps]=(0,l.b1)(Ps),"PBI.Datamart.Ribbon.NewReport.ConfirmButton.Click"),Os=(l.cx[Cs]=(0,l.b1)(Cs),"PBI.Datamart.Ribbon.UpdateDefaultDataset.CancelButton.Click"),Ts=(l.cx[Os]=(0,l.b1)(Os),"PBI.Datamart.Ribbon.UpdateDefaultDataset.ManageDefaultDataset.Click"),ws=(l.cx[Ts]=(0,l.b1)(Ts),"PBI.Datamart.Ribbon.NewReport.ContinueButton.Click"),Rs=(l.cx[ws]=(0,l.b1)(ws),"PBI.Datamart.Ribbon.NewReport.CancelButton.Click"),Ms=(l.cx[Rs]=(0,l.b1)(Rs),"PBI.Datamart.Ribbon.NewReport.ManageDefaultDataset.Click"),As=(l.cx[Ms]=(0,l.b1)(Ms),"PBI.Datamart.Ribbon.OpenInADS.Click"),Ns=(l.cx[As]=(0,l.b1)(As),"PBI.Datamart.Ribbon.OpenInADS.Exception"),xs=(l.cx[Ns]=(0,l.b1)(Ns),"PBI.Datamart.OnAddOrRemoveTableInBI"),js=(l.cx[xs]=(0,l.b1)(xs),"PBI.Datamart.OnAutoUpdateDataset"),Bs=(l.cx[js]=(0,l.b1)(js),"PBI.Datamart.DesignerView.Tab.Click"),ks=(l.cx[Bs]=(0,l.b1)(Bs),"PBI.Datamart.Query.Exception"),qs=(l.cx[ks]=(0,l.b1)(ks),"PBI.Datamart.SqlEditor.CancelQueryEvaluation"),Ls=(l.cx[qs]=(0,l.b1)(qs),"PBI.Datamart.SqlEditor.QueryEvaluationTime"),Fs=(l.cx[Ls]=(0,l.b1)(Ls),"PBI.Datamart.DesignerView.QueryEvaluationTime"),Us=(l.cx[Fs]=(0,l.b1)(Fs),"PBI.Datamart.Query.Create"),Hs=(l.cx[Us]=(0,l.b1)(Us),"PBI.Datamart.Query.Update"),Vs=(l.cx[Hs]=(0,l.b1)(Hs),"PBI_Datamart_Query_Delete"),Qs=(l.cx[Vs]=(0,l.b1)(Vs),"PBI_Datamart_Query_Rename"),Ws=(l.cx[Qs]=(0,l.b1)(Qs),"PBI_Datamart_Query_MoveToMyQuery"),Ks=(l.cx[Ws]=(0,l.b1)(Ws),"PBI_Datamart_Query_MoveToSharedQuery"),zs=(l.cx[Ks]=(0,l.b1)(Ks),"PBI_Datamart_Query_DuplicateQuery"),Gs=(l.cx[zs]=(0,l.b1)(zs),"PBI.Datamart.Query.PollBatch"),Op=l.cx[Gs]=(0,l.b1)(Gs),$s="PBI.Datamart.Query.ExecuteSql",Xs=(l.cx[$s]=(0,l.b1)($s),"PBI.Datamart.Query.Cancel.User.Operations.Batch"),Zs=(l.cx[Xs]=(0,l.b1)(Xs),"PBI.Datamart.Query.Fetch.User.Operations.Batch"),Js=(l.cx[Zs]=(0,l.b1)(Zs),"PBI.Datamart.ExecuteSql.Exception"),Ys=(l.cx[Js]=(0,l.b1)(Js),"PBI.Datamart.Query.FetchMwcToken"),eo=(l.cx[Ys]=(0,l.b1)(Ys),"PBI.Datamart.Query.Open.Sql"),to=(l.cx[eo]=(0,l.b1)(eo),"PBI.Datamart.Query.Open.Visual"),ao=(l.cx[to]=(0,l.b1)(to),"PBI.Datamart.Query.Open.Link.Sql"),ro=(l.cx[ao]=(0,l.b1)(ao),"PBI.Datamart.Query.Open.Link.Visual"),no=(l.cx[ro]=(0,l.b1)(ro),"PBI.Datamart.Query.VisualizeReportInitialization"),io=(l.cx[no]=(0,l.b1)(no),"PBI.Datamart.Query.PersistReport"),so=(l.cx[io]=(0,l.b1)(io),"PBI.Datamart.RefreshMetadata"),oo=(l.cx[so]=(0,l.b1)(so),"PBI.Datamart.DiscoverDatasourcesByDSR"),co=(l.cx[oo]=(0,l.b1)(oo),"PBI.Datamart.FabricChat"),uo=(l.cx[co]=(0,l.b1)(co),"PBI.Datamart.FabricChat.FetchMwcToken"),lo=(l.cx[uo]=(0,l.b1)(uo),"PBI.Datamart.FabricChat.TokenUseage"),mo=(l.cx[lo]=(0,l.b1)(lo),"PBI.Datamart.GetImpactAnalysis"),po=(l.cx[mo]=(0,l.b1)(mo),"PBI.Datamart.ShowedCredentialManagementDialog"),vo=(l.cx[po]=(0,l.b1)(po),"PBI.Datamart.Query.Visuals"),fo=(l.cx[vo]=(0,l.b1)(vo),"PBI.Datamart.Query.Open.VisualizeResult.Sql"),ho=(l.cx[fo]=(0,l.b1)(fo),"PBI.Datamart.Query.Open.VisualizeResult.Visual"),go=(l.cx[ho]=(0,l.b1)(ho),"PBI.Datamart.Query.GenerateModel"),bo=(l.cx[go]=(0,l.b1)(go),"PBI.Datamart.LaunchDataPipeline"),yo=(l.cx[bo]=(0,l.b1)(bo),"PBI.Datamart.LaunchDataflowGen2"),Do=(l.cx[yo]=(0,l.b1)(yo),"PBI.Datamart.LoadSample"),_o=(l.cx[Do]=(0,l.b1)(Do),"PBI.Datamart.LoadSampleOnCreate"),So=(l.cx[_o]=(0,l.b1)(_o),"PBI.Datamart.ResumeLoadSample"),Io=(l.cx[So]=(0,l.b1)(So),"PBI.Datamart.ObjectContainerRefresh"),Eo=(l.cx[Io]=(0,l.b1)(Io),"PBI.Datamart.OpenFilepathProperties"),Po=(l.cx[Eo]=(0,l.b1)(Eo),"PBI.Datamart.CopyUrl"),Co=(l.cx[Po]=(0,l.b1)(Po),"PBI.Datamart.SyncErrorDetails"),Oo=(l.cx[Co]=(0,l.b1)(Co),"PBI.Datamart.Ribbon.QueryActivity.Click"),To=(l.cx[Oo]=(0,l.b1)(Oo),"PBI.Datamart.Ribbon.Export.Click"),wo=(l.cx[To]=(0,l.b1)(To),"PBI_Datamart_CloneTable_RibbonButtonClick"),Ro="PBI_Datamart_CloneTable_ContextMenuClick",Mo="PBI_Datamart_CloneTable_Submit",Ao="PBI_Datamart_CloneTable_Errors",No=(l.cx[wo]=(0,l.b1)(wo),l.cx[Ro]=(0,l.b1)(Ro),l.cx[Mo]=(0,l.b1)(Mo),l.cx[Ao]=(0,l.b1)(Ao),"BaseDatamartTopLevelCustomerAction"),xo=(l.cx[No]=(0,l.b1)(No),"PBI.Datamart.DatamartCreate"),wp=l.cx[xo]=(0,l.b1)(xo),jo="PBI.Datamart.DatamartDelete",Rp=l.cx[jo]=(0,l.b1)(jo),Bo="PBI.Datamart.DatamartUpdate",Mp=l.cx[Bo]=(0,l.b1)(Bo),ko=g(73875),Ap=g(98624),Np=window,sa="01:00:00",jp={$type:"GetDatabaseCommand",databaseDefinitionIncludeFilters:[{schemaName:void 0,databaseObjectTypes:["table","view"]}],databaseDefinitionExcludeFilters:[{schemaName:void 0,databaseObjectTypes:["function","storedProcedure"]},{schemaName:J._.informationSchema,databaseObjectTypes:["function","storedProcedure","view","table"]},{schemaName:J._.sysSchema,databaseObjectTypes:["function","storedProcedure","view","table"]},{schemaName:J._.queryInsightsSchema,databaseObjectTypes:["function","storedProcedure","view","table"]}]},qo="?subFolderObjectId=",gt="x-ms-parent-activity-id",Ir=function(){function e(t,a,r,i){this.httpService=t,this.featureSwitchService=a,this.upload=r,this.telemetryService=i}return e.prototype.createDatamartQuery=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/queries"),c=this.getOptions("queries",i);return delete a.clientUniqueId,delete a.isResultGridVisible,this.httpService.post(s,a,c).pipe((0,X.U)(function(u){return a.queryId=parseInt(u.data.queryId,10),a.updatedAt=u.data.updatedAt,a}))},e.prototype.saveDatamartQueryAsView=function(t,a,r,i){var s="v1.0/myorg/groups/".concat(t,"/datamarts/").concat(a,"/queryAsView"),c=this.getOptions("queryAsView",i);return this.httpService.post(s,r,c)},e.prototype.updateDatamartQuery=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/queries"),c=this.getOptions("queries",i);return delete a.clientUniqueId,delete a.isResultGridVisible,this.httpService.put(s,a,c).pipe((0,X.U)(function(u){return a.queryId=parseInt(u.data.queryId,10),a.updatedAt=u.data.updatedAt,a}))},e.prototype.deleteDatamartQuery=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/queries"),c=this.getOptions("queries",i);return delete a.clientUniqueId,delete a.isResultGridVisible,this.httpService.delete(s,c,a).pipe((0,X.U)(function(u){return a}))},e.prototype.getDatamartQueries=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/queries"),s=this.getOptions("queries",r);return this.httpService.get(i,s).pipe((0,X.U)(function(c){return c.data.value}))},e.prototype.createDatamart=function(t,a,r,i,s,c){var u="".concat("me"===a?this.buildBaseURL(r).concat(c?qo.concat(c):""):this.buildCreateBaseURL(a,r,c)),m=this.getOptions("createDatamart",s);this.telemetryService.logEvent(wp,{datamartType:r});var p={name:t};return i&&(p.sensitivityLabelId=i),this.httpService.post(u,p,m).pipe((0,X.U)(function(v){return v.data}))},e.prototype.updateDatamart=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(a),c=this.getOptions("updateDatamart",i);return this.telemetryService.logEvent(Mp,{datamartObjectId:a,datamartType:r}),this.httpService.post(s,t,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.refreshMetadata=function(t,a,r,i,s){void 0===i&&(i=!1);var c="".concat(this.buildBaseURL(r),"/").concat(t),m={datamartVersion:a??1,commands:[{$type:i?"MetadataRefreshExternalCommand":"MetadataRefreshCommand"}]},p=this.getOptions("refreshMetadata",s);return this.httpService.post(c,m,p).pipe((0,X.U)(function(v){return v.data}))},e.prototype.importDatawarehouse=function(t,a,r,i,s){var c="".concat(this.buildBaseURL(r),"/").concat(t),m={datamartVersion:a??1,executionMode:"Full",commands:[{$type:"ImportCommand",mediaType:"zip",archive:i}]},p=this.getOptions("importDatawarehouse",s);return this.httpService.post(c,m,p).pipe((0,X.U)(function(v){return v.data}))},e.prototype.deleteDatamart=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t),s=this.getOptions("deleteDatamart",r);return this.telemetryService.logEvent(Rp,{datamartObjectId:t,datamartType:a}),this.httpService.delete(i,s)},e.prototype.exportDatawarehouse=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/export"),s=this.getOptions("exportDatawarehouse",r);return this.httpService.get(i,s).pipe((0,X.U)(function(c){return c.data}))},e.prototype.getDatamartPermissions=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(a,"/permissions"),c=this.getOptions("datamartPermissions",i);return this.httpService.post(s,t,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.getDatamartHistory=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/batches"),s=this.getOptions("datamartHistory",r);return this.httpService.get(i,s).pipe((0,X.U)(function(c){return c.data}))},e.prototype.getDatamartVersion=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/version"),s=this.getOptions("datamartVersion",r);return this.httpService.get(i,s).pipe((0,X.U)(function(c){return c.data}))},e.prototype.getDatamartBatch=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/batches/").concat(a),c=this.getOptions("datamartBatches",i);return this.httpService.get(s,c).pipe((0,Pp.X)(3),(0,xe.zg)(function(u){if("failure"===u.data.progressState){if(u.data.errorData.error.code===Oc.DmsImportDatabaseException)return(0,Ft._)({data:u.data.operationInformation[0].progressDetail.errors,error:u.data.errorData.error});var p=(0,o.__assign)((0,o.__assign)({},u),{status:500,data:u.data.errorData,error:u.data.errorData.error,headers:void 0});return(0,Ft._)(p)}return(0,we.of)(u.data)}))},e.prototype.cancelDatamartBatch=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/batches/").concat(a,"/cancel"),c=this.getOptions("datamartBatches",i);return this.httpService.post(s,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.resumeSuspendedDatamartBatch=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/resumeSuspendedBatches"),s=this.getOptions("datamartBatches",r);return this.httpService.post(i,s).pipe((0,X.U)(function(c){return c.data}))},e.prototype.refreshDatamart=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/refresh"),s=this.getOptions("refreshDatamart",r);return this.httpService.post(i,null,s)},e.prototype.getDatamartInformation=function(t,a,r){var i="v1.0/myorg/".concat((0,k.wZ)(a),"/").concat(t,"/information"),s=this.getOptions("information",r);return this.httpService.get(i,s).pipe((0,X.U)(function(c){var u;switch(c.data.datamartType){case"Sql":u=1;break;case"Lakewarehouse":u=2;break;case"Datawarehouse":u=4;break;case"MountedWarehouse":u=5;break;default:L.fF.assertFail("invalid DatamartType")}return(0,o.__assign)((0,o.__assign)({},c.data),{datamartType:u,statusCode:c.status,responseRequestId:c.responseRequestId,clientRequestId:s.headers.RequestId})}))},e.prototype.getUnfilteredDatamartSchema=function(t,a,r,i,s){r||(r=1===a?"etl,xmla,views":"xmla,views");var c="".concat(this.buildBaseURL(a),"/").concat(t,"?$select=").concat(r);i&&(c="".concat(c,"&customDatasetId=").concat(i));var u=this.getOptions("getDatamartVersion",s);return this.httpService.get(c,u).pipe((0,X.U)(function(m){return m.data}))},e.prototype.getDatamartSchema=function(t,a,r,i,s,c){var u=this;if(this.featureSwitchService.featureSwitches.datamartIncrementalLoad){i||(i=1===a?"etl,xmla":"xmla");var m="".concat(this.buildBaseURL(a),"/").concat(t,"?$select=").concat(i);s&&(m="".concat(m,"&customDatasetId=").concat(s));var p=this.getOptions("getDatamartVersion",c);return this.httpService.get(m,p).pipe((0,Cp.V)(24e4),(0,xe.zg)(function(v){return u.requestFilteredDatabaseDefinition(r=r??jp,v.data.datamartVersion,a,t).pipe((0,X.U)(function(b){return v.data.operationInformation.push(b.operationInformation[0]),v.data}))}))}return this.getUnfilteredDatamartSchema(t,a,i,s,c)},e.prototype.requestFilteredDatabaseDefinition=function(t,a,r,i,s){var c={datamartVersion:a??1,executionMode:"Full",commands:[t]},u="".concat(this.buildBaseURL(r),"/").concat(i),m=this.getOptions("getFilteredDatabaseDefinition",s);return this.httpService.post(u,c,m).pipe((0,X.U)(function(p){return p.data}))},e.prototype.executeSql=function(t,a,r,i,s,c,u){var p,m=this,v=this.buildExecuteSqlUrl(i.mwcTokenTargetUriHost,i.capacityObjectId,a),b={SqlScript:r,Timeout:s?"0.00:00:00":sa,SchemaOnly:u},E=this.getOptions("execute",c);return E.onRequestIdGenerated=function(D){E.headers[gt]=D.requestId},E.retryCount=0,this.httpService.setWorkloadResourceMonikerHeader(null!==(p=i.workspaceObjectId)&&void 0!==p?p:t,E),this.httpService.setMwcAuthorizationHeader(i.mwcToken,E),E.excludeBackendUri=!0,this.httpService.post(v,b,E).pipe((0,X.U)(function(D){var O;return{userOperationsBatchResponse:D.data,sqlResults:m.parseSqlResult(null===(O=D.data.operationInformation[0])||void 0===O?void 0:O.progressDetail.results)}}))},e.prototype.getUserOperationsBatch=function(t,a,r,i,s){var c,u=this.buildUserOperationsBatchUrl(r.mwcTokenTargetUriHost,r.capacityObjectId,a),m=this.getOptions("userOperationsBatchProgress",s);return m.onRequestIdGenerated=function(p){m.headers[gt]=p.requestId},m.retryCount=3,this.httpService.setWorkloadResourceMonikerHeader(null!==(c=r.workspaceObjectId)&&void 0!==c?c:t,m),this.httpService.setMwcAuthorizationHeader(r.mwcToken,m),m.excludeBackendUri=!0,this.httpService.get(u,m).pipe((0,xe.zg)(function(p){return"failure"!==p.data.state||i?(0,we.of)(p.data):(0,Ft._)(p.data.exceptionData)}))},e.prototype.cancelUserOperationsBatch=function(t,a,r,i){var s,c="".concat(this.buildUserOperationsBatchUrl(a.mwcTokenTargetUriHost,a.capacityObjectId,r),"/cancel"),u=this.getOptions("cancelUserOperationsBatch",i);return u.onRequestIdGenerated=function(m){u.headers[gt]=m.requestId},u.retryCount=0,this.httpService.setWorkloadResourceMonikerHeader(null!==(s=a.workspaceObjectId)&&void 0!==s?s:t,u),this.httpService.setMwcAuthorizationHeader(a.mwcToken,u),u.excludeBackendUri=!0,this.httpService.post(c,null,u).pipe((0,X.U)(function(m){return m.data}))},e.prototype.saveWarehouseQueryAsView=function(t,a,r,i,s,c){var u=this,v={executionMode:"Full",PrepareTimeout:sa,datamartVersion:s??1,commands:[{$type:"ExecuteSaveQueryAsViewCommand",targetSchemaName:r.schemaName,viewName:r.viewName,query:r.script}]};return this.generateNewMwcToken(a,{roles:[""]},i).pipe((0,X.U)(function(D){return D}),(0,na.K)(function(D){return(0,Ft._)(D)})).pipe((0,xe.zg)(function(D){var C=u.buildExecuteUserCommandUrl(D.mwcTokenTargetUriHost,D.capacityObjectId,a),I=u.getOptions("batches",c);return I.onRequestIdGenerated=function(P){I.headers[gt]=P.requestId},I.retryCount=0,u.httpService.setWorkloadResourceMonikerHeader(t,I),u.httpService.setMwcAuthorizationHeader(D.mwcToken,I),I.excludeBackendUri=!0,u.httpService.post(C,v,I).pipe((0,X.U)(function(P){var M;return{userOperationsBatchResponse:P.data,sqlResults:u.parseSqlResult(null===(M=P.data.operationInformation[0])||void 0===M?void 0:M.progressDetail.results)}}))}))},e.prototype.saveAsTable=function(t,a,r,i,s,c){var u=this,p={executionMode:"Full",PrepareTimeout:sa,datamartVersion:s??1,commands:[{$type:"ExecuteCtasCommand",targetDbName:i.databaseName,targetSchemaName:i.schemaName,targetTableName:i.tableName,selectStatement:i.script}]};return this.generateNewMwcToken(a,{roles:[""]},r).pipe((0,xe.zg)(function(v){var D=u.buildExecuteUserCommandUrl(v.mwcTokenTargetUriHost,v.capacityObjectId,a),O=u.getOptions("execute",c);return O.onRequestIdGenerated=function(A){O.headers[gt]=A.requestId},O.retryCount=0,u.httpService.setWorkloadResourceMonikerHeader(t,O),u.httpService.setMwcAuthorizationHeader(v.mwcToken,O),O.excludeBackendUri=!0,u.httpService.post(D,p,O)}))},e.prototype.loadDatamartSample=function(t,a,r,i,s,c){var u=this,p={executionMode:"Full",prepareTimeout:sa,datamartVersion:s??1,commands:[{$type:"LoadSampleCommand",sampleName:i}]};return this.generateNewMwcToken(a,{roles:[""]},r).pipe((0,xe.zg)(function(v){var D=u.buildExecuteUserCommandUrl(v.mwcTokenTargetUriHost,v.capacityObjectId,a),O=u.getOptions("execute",c);return O.onRequestIdGenerated=function(A){O.headers[gt]=A.requestId},O.retryCount=0,u.httpService.setWorkloadResourceMonikerHeader(t,O),u.httpService.setMwcAuthorizationHeader(v.mwcToken,O),O.excludeBackendUri=!0,u.httpService.post(D,p,O)}))},e.prototype.getLoadSampleBatchId=function(t,a,r,i){var s=this;return this.generateNewMwcToken(a,{roles:[""]},r).pipe((0,xe.zg)(function(u){var m,b=s.buildLoadSampleBatchIdUrl(u.mwcTokenTargetUriHost,u.capacityObjectId,a),E=s.getOptions("sample",i);return E.onRequestIdGenerated=function(D){E.headers[gt]=D.requestId},E.retryCount=0,s.httpService.setWorkloadResourceMonikerHeader(null!==(m=u.workspaceObjectId)&&void 0!==m?m:t,E),s.httpService.setMwcAuthorizationHeader(u.mwcToken,E),E.excludeBackendUri=!0,s.httpService.get(b,E)}))},e.prototype.updateDatamartProperties=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/information"),c=this.getOptions("information",i);return this.httpService.post(s,a,c)},e.prototype.validateDatamartMashup=function(t,a){var i=this.getOptions("validateDatamartMashup",a);return this.httpService.post("metadata/mashup/validate",t,i).pipe((0,X.U)(function(s){return s.data}))},e.prototype.buildDataflow=function(t,a){var i=this.getOptions("buildDataflow",a);return this.httpService.post("metadata/dataflows/build",t,i).pipe((0,X.U)(function(s){return s.data}))},e.prototype.updateDataflow=function(t,a){var i=this.getOptions("updateDataflow",a);return this.httpService.post("metadata/dataflows/build/update",t,i).pipe((0,X.U)(function(s){return s.data}))},e.prototype.buildModelRelationships=function(t,a,r){var i="metadata/dataflows/build/".concat(a,"/relationships"),s=this.getOptions("buildModelRelationships",r);return this.httpService.post(i,t,s).pipe((0,X.U)(function(c){return c.data}))},e.prototype.acquireDatamartLease=function(t,a,r,i){var c={datamartVersion:r??1,commands:[{$type:"DelayBackgroundProcessingCommand"}]},u="".concat(this.buildBaseURL(a),"/").concat(t),m=this.getOptions("acquireBackgroundLease",i);return this.httpService.post(u,c,m).pipe((0,X.U)(function(p){return p.data}))},e.prototype.generateTransientModel=function(t,a){return this.httpService.post("modeling/generateModel",t).pipe((0,X.U)(function(i){return i.data}))},e.prototype.generateNewMwcToken=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(t,"/token"),c=this.getOptions("generateMwcToken",i);return this.httpService.post(s,a,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.getModel=function(t,a){var r="metadata/models/".concat(t);return this.httpService.get(r).pipe((0,X.U)(function(i){return i.data}))},e.prototype.addRemoveTablesFromBI=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(a),c=this.getOptions("addRemoveTablesFromBIModel",i);return this.httpService.post(s,t,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.addTablesToBiModelImpactAnalysis=function(t,a,r,i){var s="".concat(this.buildBaseURL(r),"/").concat(a),c=this.getOptions("addTablesToBiModelImpactAnalysis",i);return this.httpService.post(s,t,c).pipe((0,X.U)(function(u){return u.data}))},e.prototype.waitForBatchProcessToComplete=function(t,a,r,i){var c,u,s=this,m=1e3,p=i?.executeOnPoll,v=i?.pollingInterval,b=null!==(c=i?.stopCondition)&&void 0!==c?c:pi.E,E=null!==(u=i?.completionCondition)&&void 0!==u?u:function(D){return"inProgress"!==D.progressState};return(0,we.of)(a).pipe((0,fi.jn)(function(D){return E(D)?(0,we.of)(D):(0,vi.H)(m).pipe((0,ia.b)(function(){m=void 0!==v?v:Math.min(1.3*m,15e3)}),(0,xe.zg)(function(){return s.getDatamartBatch(t,a.batchId,r)}))}),(0,ia.b)(function(D){return p?.(D)}),(0,hi.h)(function(D){return E(D)}),(0,B.q)(1),(0,Je.R)(b))},e.prototype.waitForUserOperationBatchProcessToComplete=function(t,a,r,i,s,c){var m,p,b,u=this,v=1e3,E=c?.executeOnPoll,D=c?.pollingInterval,O=null!==(m=c?.stopCondition)&&void 0!==m?m:pi.E,A=null!==(p=c?.completionCondition)&&void 0!==p?p:function(C){return"inProgress"!==C.state};return(0,we.of)(r).pipe((0,fi.jn)(function(C){return A(C)?(0,we.of)(C):(0,vi.H)(v).pipe((0,ia.b)(function(){v=void 0!==D?D:Math.min(1.3*v,15e3)}),(0,xe.zg)(function(){return u.fetchMWCTokenWithRoles(t,i,s).pipe((0,xe.zg)(function(I){return b=u.telemetryService.startActivity(null,Op),u.getUserOperationsBatch(a,r.batchId,I).pipe((0,X.U)(function(P){return b.resolve(),P}),(0,na.K)(function(P){return b.reject(),(0,Ft._)(P)}))}))}))}),(0,ia.b)(function(C){return E?.(C)}),(0,hi.h)(function(C){return A(C)}),(0,B.q)(1),(0,Je.R)(O))},e.prototype.fetchMWCTokenWithRoles=function(t,a,r){L.fF.assert(function(){return!!r},"roles undefined");var i=r.filter(function(c){return c.checked}),s={roles:_.map(i,function(c){return c.roleName}),UtilizationType:"Interactive"};return this.generateNewMwcToken(t,s,a)},e.prototype.getOneLakeFilepathProperties=function(t,a){var r=Np.feUrl;switch(!0){case r.indexOf("edog")>-1:case r.indexOf("df")>-1:case r.indexOf("int3")>-1:case r.indexOf("int")>-1:return(0,we.of)("https://onelake-int-edog.dfs.pbidedicated.windows-int.net");case r.indexOf("daily")>-1:return(0,we.of)("https://daily-onelake.dfs.fabric.microsoft.com");case r.indexOf("dxt")>-1:return(0,we.of)("https://dxt-onelake.dfs.fabric.microsoft.com");case r.indexOf("msit")>-1:return(0,we.of)("https://msit-onelake.dfs.fabric.microsoft.com");default:return(0,we.of)("https://onelake.dfs.fabric.microsoft.com")}},e.prototype.parseSqlResult=function(t){if(!t)return null;var a=["errorMessage","infoMessage","query","statementCompletedMessage","queryDurationMessage"];return t.filter(function(r){return a.includes(r.resultType)})},e.prototype.getAutoAddToDefaultDatasetValue=function(t,a){var r="".concat(this.buildBaseURL(a),"/").concat(t,"/parameters?name=AutoAddToDefaultDataset");return this.httpService.get(r).pipe((0,X.U)(function(i){return"true"===i.data.parameters[0].value.toLowerCase()}))},e.prototype.updateAutoAddToDefaultDatasetValue=function(t,a,r){var i="".concat(this.buildBaseURL(a),"/").concat(t,"/parameters"),s={parameters:[{name:"AutoAddToDefaultDataset",value:String(r)}]};return this.httpService.patch(i,s).pipe((0,X.U)(function(c){return"true"===c.data.parameters[0].value.toLowerCase()}))},e.prototype.setLabelOnFile=function(t,a,r,i){return(0,o.__awaiter)(this,void 0,void 0,function(){var s,c;return(0,o.__generator)(this,function(m){switch(m.label){case 0:return s="metadata/informationProtection/labelStream/datamart/".concat(t,"/type/").concat(r),(c=this.httpService.powerbiRequestOptions(i,"SetLabelOnStream")).retryCount=0,c.headers[Ep.Pg6]=a.size.toString(),c.responseType="blob",[4,this.upload.post(s,[a],c)];case 1:return[2,m.sent().data]}})})},e.prototype.getOptions=function(t,a){return this.httpService.powerbiRequestOptions(a,t)},e.prototype.buildCreateBaseURL=function(t,a,r){var i="v1.0/myorg/groups/".concat(t,"/").concat((0,k.wZ)(a));return r?i.concat(qo,r):i},e.prototype.buildBaseURL=function(t){return"v1.0/myorg/".concat((0,k.wZ)(t))},e.prototype.buildUserOperationsEndpointUrl=function(t,a){return"https://".concat(t,"/webapi/capacities/").concat(a,"/workloads/DMS/DmsService/automatic")},e.prototype.buildUserOperationsBatchUrl=function(t,a,r){return"".concat(this.buildUserOperationsEndpointUrl(t,a),"/batches/").concat(r)},e.prototype.buildExecuteSqlUrl=function(t,a,r){return"".concat(this.buildUserOperationsEndpointUrl(t,a),"/datamarts/").concat(r,"/execute")},e.prototype.buildExecuteUserCommandUrl=function(t,a,r){return"".concat(this.buildUserOperationsEndpointUrl(t,a),"/datamarts/").concat(r,"/batches")},e.prototype.buildLoadSampleBatchIdUrl=function(t,a,r){return"".concat(this.buildUserOperationsEndpointUrl(t,a),"/datamarts/").concat(r,"/sample")},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(ko.O),d.\u0275\u0275inject(qt.vZ),d.\u0275\u0275inject(Ap.g),d.\u0275\u0275inject(Ip.y0))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),oa=function(){function e(t,a,r,i){this.store=t,this.actions$=a,this.telemetryService=r,this.datamartHttpService=i}return e.prototype.initialize=function(t){this.tablesAndViews=t},Object.defineProperty(e.prototype,"datamartObjectId",{get:function(){return this.tablesAndViews.datamart.objectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"settings",{get:function(){return this.tablesAndViews.settings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){switch(this.tablesAndViews.datamartType){case 2:return"Lakehouse";case 4:return"Warehouse";case 1:return"Datamart"}},enumerable:!1,configurable:!0}),e.prototype.updateTables=function(t,a){return(0,o.__awaiter)(this,void 0,void 0,function(){var s,c;return(0,o.__generator)(this,function(u){switch(u.label){case 0:return this.tablesAndViews.skipStore?[4,this.addOrRemoveTablesFromBI(t,a,this.tablesAndViews.datamartVersion,this.tablesAndViews.datamartObjectId,this.tablesAndViews.datamartType)]:[3,2];case 1:return u.sent(),[3,4];case 2:return this.store.dispatch(tl({tableNamesToAdd:t,tableNamesToRemove:a})),this.actions$?[4,this.actions$.pipe((0,Tt.l4)(ja,Ma,xa),(0,B.q)(1)).toPromise()]:[3,4];case 3:if((s=u.sent()).type===Ma.type)this.createReportIfNeeded();else if(s.type===ja.type)throw L.fF.assertValue((c=s.error).error,"error.error has to be defined"),500===c.status&&this.store.dispatch(il({error:c})),c;u.label=4;case 4:return[2]}})})},e.prototype.getTables=function(t,a){return(0,o.__awaiter)(this,void 0,void 0,function(){var r,i,s,c,u,m=this;return(0,o.__generator)(this,function(p){switch(p.label){case 0:return!t&&this.tablesAndViews?[2,this.tablesAndViews]:a?(r=void 0,this.tablesAndViews.skipStore?(r=this.tablesAndViews.models,[3,3]):[3,1]):[3,4];case 1:return[4,this.store.select(Gn).pipe((0,B.q)(1),(0,X.U)(function(v){return v})).toPromise()];case 2:r=p.sent(),p.label=3;case 3:return this.tablesAndViews=(0,o.__assign)((0,o.__assign)({},this.tablesAndViews),{models:r}),[2,this.tablesAndViews];case 4:return this.store.dispatch(ol()),[4,this.actions$.pipe((0,Tt.l4)(Na,xa),(0,B.q)(1),(0,Tt.IC)(function(){return[m.store.select(kt),m.store.select(Nn)]})).toPromise()];case 5:if(u=p.sent(),s=u[1],c=u[2],(i=u[0]).type===Na.type)return this.tablesAndViews=(0,o.__assign)((0,o.__assign)({},this.tablesAndViews),{tables:s,views:c}),[2,this.tablesAndViews];throw i.error}})})},e.prototype.createDataset=function(t,a,r){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(i){return[2,""]})})},e.prototype.refreshSchema=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(t){return[2]})})},e.prototype.getDatamartUserPermissions=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(t){return[2]})})},e.prototype.createReportIfNeeded=function(){this.tablesAndViews.isFromNewReport&&!this.tablesAndViews.skipStore&&this.store.dispatch(el({datamart:this.tablesAndViews.datamart}))},e.prototype.addOrRemoveTablesFromBI=function(t,a,r,i,s){return(0,o.__awaiter)(this,void 0,void 0,function(){var c,p=this;return(0,o.__generator)(this,function(v){switch(v.label){case 0:return c=this.telemetryService.startActivity(null,ci),[4,this.datamartHttpService.addRemoveTablesFromBI({datamartVersion:r??1,executionMode:"Full",commands:[{$type:"AddRemoveTablesToBiModelCommand",tableNamesToAdd:t,tableNamesToRemove:a??[]}]},i,s).pipe((0,xe.zg)(function(b){return p.datamartHttpService.waitForBatchProcessToComplete(i,b,s).pipe((0,X.U)(function(){c.resolve()}))}),(0,na.K)(function(b){throw c.reject((0,Sr.GB)(b.error,b.status)),L.fF.assertValue(b.error,"error.error has to be defined"),b})).toPromise()];case 1:return v.sent(),[2]}})})},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(n.yh),d.\u0275\u0275inject(Tt.eX),d.\u0275\u0275inject(Lt.y0),d.\u0275\u0275inject(Ir))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),Lo=g(59017),Er=g(22318),Fo=g(73221),Uo=g(64560),Bp=g(40543),Ho=g(16601),Vo=new d.InjectionToken("TriInformationProtectionMandatoryLabelDialogService"),Pr=g(69388),ct=function(){function e(){}return e.convertTableViewsToFieldListModels=function(t,a,r,i){var s=this.getSchemaToTableViewsMap(t),c={schemas:{},schemaObjectContainers:{},tables:{},views:{},warehouses:{}},u={datamartType:a.datamartType,name:a.datamartName,datamartObjectId:a.datamartId,datamartVersion:r};c.warehouses[a.datamartId]={canEdit:!1,objectId:a.datamartId,categoryUrns:new Set,warehouseMetadata:u,isHidden:!1,objectType:"Warehouse"};for(var m=0,p=Array.from(s.entries());m<p.length;m++){var v=p[m],b=v[0],E=v[1],D="".concat(u.datamartObjectId,"/").concat(b),O="".concat(D,"/Tables"),A="".concat(D,"/Views"),C=new Set,I=new Set;c.schemas[D]={canEdit:!1,warehouseMetadata:u,schemaObjectContainersUrns:new Set([O,A]),name:b,urn:D,isHidden:!1,objectType:"Schema"};for(var P=0,M=E.tables;P<M.length;P++){var F=M[P],Z="".concat(D,"/").concat(F.name);C.add(Z),c.tables[Z]={objectType:F.objectType,columns:F.columns,measures:F.measures,isBiObject:F.isBiObject,name:F.name,uniqueName:F.uniqueName,schemaName:F.schemaName,id:F.id,isHidden:!1,canEdit:!0,isManaged:!1,syncErrors:[],syncWarnings:[],modelUrn:"",urn:Z,fullyQualifiedName:"[".concat(u.name,"].[").concat(b,"].[").concat(F.name,"]"),twoPartName:"[".concat(b,"].[").concat(F.name,"]"),warehouseName:u.name,warehouseId:u.datamartObjectId}}for(var je=0,ut=E.views;je<ut.length;je++){var Re=ut[je],wt="".concat(D,"/").concat(Re.name);I.add(wt),c.views[wt]={objectType:Re.objectType,columns:Re.columns,measures:Re.measures,isBiObject:Re.isBiObject,name:Re.name,uniqueName:Re.uniqueName,schemaName:Re.schemaName,isHidden:!1,canEdit:!0,isManaged:!1,modelUrn:"",urn:wt,fullyQualifiedName:"[".concat(u.name,"].[").concat(b,"].[").concat(Re.name,"]"),twoPartName:"[".concat(b,"].[").concat(Re.name,"]"),warehouseName:u.name,warehouseId:u.datamartObjectId}}c.schemaObjectContainers[O]={canEdit:!1,childrenType:"Table",childrenUrns:C,isHidden:!1,isLoaded:!0,name:i.tablesTitle,schemaName:b,urn:O,warehouseMetadata:u,objectType:"SchemaObjectContainer"},c.schemaObjectContainers[A]={canEdit:!1,childrenType:"View",childrenUrns:I,isHidden:!1,isLoaded:!0,name:i.viewsTitle,schemaName:b,urn:A,warehouseMetadata:u,objectType:"SchemaObjectContainer"}}return c},e.updateTreeNodeState=function(t){var a=t.children.length>0&&t.children.every(function(r){return r.checked});t.checked=a,t.isIndeterminate=t.children.some(function(r){return r.checked||r.isIndeterminate})&&!a,t.disabled=!(t.children.length>0)||t.children.every(function(r){return r.disabled})},e.getSchemaToTableViewsMap=function(t){for(var a=new Map,r=0,i=t.tables;r<i.length;r++){var s=i[r];void 0===(c=a.get(s.schemaName))?a.set(s.schemaName,c={tables:[s],views:[]}):c.tables.push(s)}for(var u=0,m=t.views;u<m.length;u++){var c,p=m[u];void 0===(c=a.get(p.schemaName))?a.set(p.schemaName,c={tables:[],views:[p]}):c.views.push(p)}return a},e.parseDatabaseTables=function(t,a,r){var i=_.map(t.tables,function(s){var c="Create"!==r&&s.isBiObject;return{objectType:"Table",columns:new Set,measures:new Set,isBiObject:c,name:s.name,uniqueName:s.uniqueName,schemaName:s.schemaName}});return this.filterTables(i)},e.parseDatabaseViews=function(t,a,r){var i=_.map(t.views,function(s){var c="Create"!==r&&s.isBiObject;return{objectType:"View",name:s.name,columns:new Set,measures:new Set,isBiObject:c,uniqueName:s.uniqueName,schemaName:s.schemaName}});return this.filterViews(i)},e.filterTables=function(t){return _.filter(t,function(a){return"queryinsights"!==a.schemaName})},e.filterViews=function(t){return _.filter(t,function(a){return"queryinsights"!==a.schemaName})},e}(),kp=g(5467),Qo=g(96777),qp=g(59968),Wo=g(44641),Lp=g(56011),Ko=g(69437),Fp=g(55490),Up=g(65e3),Hp=g(89237),Vp=g(54729),Qp=g(74913),Wp=g(10965),Cr=g(74076),zo=g(7600),Go=g(43286),Kp=(0,n.P1)(Cr.Hf,Cr.iF,function(e,t){var a;return a=_.isEmpty(t)?_.filter(e,function(r){return void 0!==r.folderId&&(!r.type||r.type!==zo.Sr.AdminFolder)||r.isMyWorkspace}):_.filter(e,function(r){return void 0!==r.folderId&&r.objectId!==t&&r?.type!==zo.Sr.AdminFolder||r.isMyWorkspace}),_.filter(a,function(r){return(0,Go.yE)(r.permissions,8)||r.isMyWorkspace})}),zp=g(23558),Gp=g(19178),$o=g(20551),$p=g(64716),Xp=g(85721),Zp=g(22743),Or=g(85102);function Jp(e,t){if(1&e&&d.\u0275\u0275element(0,"tri-workspace-icon",5),2&e){var a=d.\u0275\u0275nextContext(2);d.\u0275\u0275property("workspace",a.currentSelection)("iconSizePx",20)}}function Yp(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"tri-dropdown-item",6),d.\u0275\u0275element(1,"tri-workspace-icon",5),d.\u0275\u0275elementStart(2,"div"),d.\u0275\u0275text(3),d.\u0275\u0275elementEnd()()),2&e){var a=t.$implicit;d.\u0275\u0275property("value",a),d.\u0275\u0275advance(1),d.\u0275\u0275property("workspace",a)("iconSizePx",20),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(a.displayName)}}function ev(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"div")(1,"tri-dropdown",2),d.\u0275\u0275listener("valueChange",function(s){d.\u0275\u0275restoreView(a);var c=d.\u0275\u0275nextContext();return d.\u0275\u0275resetView(c.currentSelection=s)})("valueChange",function(s){d.\u0275\u0275restoreView(a);var c=d.\u0275\u0275nextContext();return d.\u0275\u0275resetView(c.onWorkspaceSelected(s))}),d.\u0275\u0275elementStart(2,"tri-dropdown-trigger"),d.\u0275\u0275template(3,Jp,1,2,"tri-workspace-icon",3),d.\u0275\u0275elementStart(4,"div"),d.\u0275\u0275text(5),d.\u0275\u0275elementEnd()(),d.\u0275\u0275template(6,Yp,4,4,"tri-dropdown-item",4),d.\u0275\u0275pipe(7,"async"),d.\u0275\u0275elementEnd()()}if(2&e){var r=d.\u0275\u0275nextContext();d.\u0275\u0275advance(1),d.\u0275\u0275property("value",r.currentSelection)("isDisabled",r.disabled)("options",r.triDropdownOptions),d.\u0275\u0275advance(2),d.\u0275\u0275property("ngIf",null==r.currentSelection?null:r.currentSelection.displayName),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(null==r.currentSelection?null:r.currentSelection.displayName),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngForOf",d.\u0275\u0275pipeBind1(7,6,r.folders$))}}function tv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"span",8),d.\u0275\u0275text(1),d.\u0275\u0275pipe(2,"localize"),d.\u0275\u0275elementEnd()),2&e){var a=d.\u0275\u0275nextContext(2);d.\u0275\u0275advance(1),d.\u0275\u0275textInterpolate1(" ",d.\u0275\u0275pipeBind1(2,1,a.createWorkspaceKey)," ")}}function av(e,t){if(1&e&&d.\u0275\u0275template(0,tv,3,3,"span",7),2&e){var a=d.\u0275\u0275nextContext();d.\u0275\u0275property("ngIf",a.noWorkspaceFound)}}var rv=function(){function e(t,a,r,i){this.featureSwitches=t,this.changeDetector=a,this.store=r,this.groupStore=i,this.noWorkspaceFound=!1,this.workspaceSelected=new d.EventEmitter,this.foundWorkspaces=new d.EventEmitter}return e.prototype.ngOnInit=function(){var t=this;this.createWorkspaceKey=this.featureSwitches.featureSwitches.goalsAllowedOnShared&&!this.forceDisableSharedWorkspace?"Create_Scorecard_Warning_No_Workspace_found":"Create_Scorecard_Warning_No_Premium_workspace_found",this.groupStore.ensureWorkspacesLoaded().then(function(){t.folders$=t.store.select(Kp).pipe((0,X.U)(function(a){return(!t.featureSwitches.featureSwitches.goalsAllowedOnShared||t.forceDisableSharedWorkspace)&&(a=a.filter(function(r){return void 0!==r.capacitySkuTier})),(!t.featureSwitches.featureSwitches.scorecardsInMyWorkspace||t.forceDisableMyWorkspace)&&(a=a.filter(function(r){return!r.isMyWorkspace})),void 0!==t.permissionFilter&&(a=a.filter(function(r){return(0,Go.yE)(r.permissions,t.permissionFilter)})),_.isEmpty(t.capacityFilter)||(a=a.filter(function(r){return t.capacityFilter.includes(r.capacitySkuTier)})),t.foundWorkspaces.emit(!_.isEmpty(a)),_.isEmpty(a)&&(t.noWorkspaceFound=!0),_.sortBy(a,function(r){return r.displayName.toLocaleLowerCase()})})),t.folders$.pipe((0,zp.M)(t.store.select(Cr.S6)),(0,B.q)(1)).subscribe(function(a){var r=a[0],i=a[1];if(!t.disabled){var s;(s=i?.folderId?_.find(r,function(c){return c.folderId===i.folderId}):i?.isMyWorkspace&&!t.forceDisableMyWorkspace?_.find(r,function(c){return c.isMyWorkspace}):_.first(r))&&t.onWorkspaceSelected(s)}t.changeDetector.detectChanges()})})},e.prototype.ngOnChanges=function(t){var a=this;t.currentWorkspaceObjectId&&this.folders$&&this.folders$.pipe((0,B.q)(1)).subscribe(function(r){a.currentSelection=void 0;for(var i=0,s=r;i<s.length;i++){var c=s[i];if(c.objectId===a.currentWorkspaceObjectId){a.onWorkspaceSelected(c);break}}})},e.prototype.onWorkspaceSelected=function(t){this.currentSelection=t,this.workspaceSelected.emit(t)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275directiveInject(qt.vZ),d.\u0275\u0275directiveInject(d.ChangeDetectorRef),d.\u0275\u0275directiveInject(n.yh),d.\u0275\u0275directiveInject(Gp.Y))},e.\u0275cmp=d.\u0275\u0275defineComponent({type:e,selectors:[["workspace-picker"]],inputs:{currentWorkspaceObjectId:"currentWorkspaceObjectId",disabled:"disabled",forceDisableSharedWorkspace:"forceDisableSharedWorkspace",forceDisableMyWorkspace:"forceDisableMyWorkspace",permissionFilter:"permissionFilter",capacityFilter:"capacityFilter",triDropdownOptions:"triDropdownOptions"},outputs:{workspaceSelected:"workspaceSelected",foundWorkspaces:"foundWorkspaces"},features:[d.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noFound",""],[1,"workspace-select",3,"value","isDisabled","options","valueChange"],["class","workspace-icon tri-mr-1",3,"workspace","iconSizePx",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"workspace-icon","tri-mr-1",3,"workspace","iconSizePx"],[3,"value"],["class","warning",4,"ngIf"],[1,"warning"]],template:function(a,r){if(1&a&&(d.\u0275\u0275template(0,ev,8,8,"div",0),d.\u0275\u0275template(1,av,1,1,"ng-template",null,1,d.\u0275\u0275templateRefExtractor)),2&a){var i=d.\u0275\u0275reference(2);d.\u0275\u0275property("ngIf",!r.noWorkspaceFound)("ngIfElse",i)}},dependencies:[h.NgForOf,h.NgIf,$o.M3,$p.l,Xp.q,$o.ii,Zp.y,h.AsyncPipe,Or.F],styles:["tri-dropdown[_ngcontent-%COMP%]{flex:1;white-space:nowrap;text-align:left;width:100%;display:flex;align-items:center}tri-dropdown[_ngcontent-%COMP%]     .popout-button{border-radius:4px;border:1px solid var(--colorNeutralBackground2Pressed)}tri-dropdown-item[_ngcontent-%COMP%]     .item{height:28px}tri-dropdown-item[_ngcontent-%COMP%]     span{display:flex;flex-direction:row;flex-wrap:nowrap}tri-dropdown-item[_ngcontent-%COMP%]     img{height:20px;width:20px}tri-dropdown-trigger[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}tri-dropdown-trigger[_ngcontent-%COMP%]     img{height:20px;width:20px}tri-dropdown-trigger[_ngcontent-%COMP%], tri-dropdown-item[_ngcontent-%COMP%], .workspace-select[_ngcontent-%COMP%]{font-weight:var(--fontWeightRegular);font-size:var(--fontSizeBase300);line-height:var(--lineHeightBase300)}.workspace-select[_ngcontent-%COMP%]{color:var(--colorNeutralForeground4)}"],changeDetection:0}),e}(),nv=g(48242),iv=g(37196),sv=["datasetNameField"];function ov(e,t){1&e&&(d.\u0275\u0275elementStart(0,"div",3)(1,"tri-spinner",4),d.\u0275\u0275element(2,"label",5),d.\u0275\u0275elementEnd()())}function cv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"message-banner",19),d.\u0275\u0275listener("hideBanner",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(s.closeBanner())})("buttonClicked",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(s.errorButtonClicked())}),d.\u0275\u0275elementEnd()}if(2&e){var r=d.\u0275\u0275nextContext(3);d.\u0275\u0275property("viewModel",r.messageBannerModel)}}function dv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"div",23),d.\u0275\u0275element(1,"label",24)(2,"input",25,26),d.\u0275\u0275pipe(4,"localize"),d.\u0275\u0275pipe(5,"localize"),d.\u0275\u0275pipe(6,"async"),d.\u0275\u0275elementEnd()),2&e){var a=d.\u0275\u0275nextContext(4);d.\u0275\u0275advance(2),d.\u0275\u0275property("placeholder",d.\u0275\u0275pipeBind1(4,4,"SemanticModel_EnterName"))("maxlength",a.datasetNameMaxCharacterLimit),d.\u0275\u0275attribute("aria-label",d.\u0275\u0275pipeBind1(5,6,"Name"))("disabled",!!d.\u0275\u0275pipeBind1(6,8,a.isButtonLevelSpinnerDisplayed$)||null)}}function uv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"div",27)(1,"div",28),d.\u0275\u0275element(2,"label",29)(3,"tri-svg-icon",30),d.\u0275\u0275elementEnd(),d.\u0275\u0275elementStart(4,"workspace-picker",31,32),d.\u0275\u0275listener("workspaceSelected",function(c){d.\u0275\u0275restoreView(a);var u=d.\u0275\u0275nextContext(4);return d.\u0275\u0275resetView(u.onWorkspaceSelected(c))}),d.\u0275\u0275pipe(6,"async"),d.\u0275\u0275elementEnd()()}if(2&e){var r=d.\u0275\u0275nextContext(4),i=d.\u0275\u0275reference(6);d.\u0275\u0275advance(3),d.\u0275\u0275property("triTooltip",i),d.\u0275\u0275advance(1),d.\u0275\u0275property("disabled",d.\u0275\u0275pipeBind1(6,6,r.isButtonLevelSpinnerDisplayed$))("currentWorkspaceObjectId",r.selectedWorkspaceId)("forceDisableMyWorkspace",r.forceDisableMyWorkspace)("capacityFilter",r.workspaceCapacityFilter)("infoIconData",r.infoIconData)}}function lv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"div",20),d.\u0275\u0275template(1,dv,7,10,"div",21),d.\u0275\u0275template(2,uv,7,8,"div",22),d.\u0275\u0275elementEnd()),2&e){var a=d.\u0275\u0275nextContext(3);d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",!a.hideDatasetNameField),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",!a.hideWorkspacePicker)}}function mv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementContainerStart(0),d.\u0275\u0275elementStart(1,"button",33,34),d.\u0275\u0275listener("click",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275reference(2),c=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(c.openMenu(s))}),d.\u0275\u0275pipe(3,"async"),d.\u0275\u0275pipe(4,"async"),d.\u0275\u0275pipe(5,"localize"),d.\u0275\u0275pipe(6,"localize"),d.\u0275\u0275element(7,"pbi-office-icon",35),d.\u0275\u0275elementEnd(),d.\u0275\u0275elementContainerEnd()}if(2&e){var r=d.\u0275\u0275nextContext(3);d.\u0275\u0275advance(1),d.\u0275\u0275property("disabled",d.\u0275\u0275pipeBind1(3,4,r.isButtonLevelSpinnerDisplayed$))("triTooltipDisabled",d.\u0275\u0275pipeBind1(4,6,r.isButtonLevelSpinnerDisplayed$))("triTooltip",d.\u0275\u0275pipeBind1(5,8,"Datamart_Manage_Default_Dataset_Filter_Button")),d.\u0275\u0275attribute("aria-label",d.\u0275\u0275pipeBind1(6,10,"Datamart_Manage_Default_Dataset_Filter_Button"))}}function pv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"div",36),d.\u0275\u0275listener("click",function(s){return s.stopPropagation()}),d.\u0275\u0275elementStart(1,"tri-filter-menu",37),d.\u0275\u0275listener("filterChange",function(s){d.\u0275\u0275restoreView(a);var c=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(c.onFilterChange(s))}),d.\u0275\u0275pipe(2,"async"),d.\u0275\u0275pipe(3,"async"),d.\u0275\u0275pipe(4,"localize"),d.\u0275\u0275pipe(5,"localize"),d.\u0275\u0275pipe(6,"localize"),d.\u0275\u0275elementEnd()()}if(2&e){var r=d.\u0275\u0275nextContext(3);d.\u0275\u0275advance(1),d.\u0275\u0275property("isDisabled",d.\u0275\u0275pipeBind1(2,8,r.isButtonLevelSpinnerDisplayed$))("triTooltipDisabled",d.\u0275\u0275pipeBind1(3,10,r.isButtonLevelSpinnerDisplayed$))("triTooltip",d.\u0275\u0275pipeBind1(4,12,"Datamart_Manage_Default_Dataset_Filter_Button"))("filters",r.schemaViewFilters)("useTridentUIStyle",!0)("includeIconOnly",!0)("ariaLabel",d.\u0275\u0275pipeBind1(6,16,"Filter")),d.\u0275\u0275attribute("aria-label",d.\u0275\u0275pipeBind1(5,14,"Datamart_Manage_Default_Dataset_Filter_Button"))}}function vv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"button",38),d.\u0275\u0275listener("click",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(s.refresh())}),d.\u0275\u0275pipe(1,"async"),d.\u0275\u0275pipe(2,"async"),d.\u0275\u0275pipe(3,"localize"),d.\u0275\u0275pipe(4,"localize"),d.\u0275\u0275element(5,"tri-svg-icon",39),d.\u0275\u0275elementEnd()}if(2&e){var r=d.\u0275\u0275nextContext(3);d.\u0275\u0275property("disabled",d.\u0275\u0275pipeBind1(1,4,r.isButtonLevelSpinnerDisplayed$))("triTooltipDisabled",d.\u0275\u0275pipeBind1(2,6,r.isButtonLevelSpinnerDisplayed$))("triTooltip",d.\u0275\u0275pipeBind1(3,8,"Reload")),d.\u0275\u0275attribute("aria-label",d.\u0275\u0275pipeBind1(4,10,"Reload"))}}function fv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"div",47),d.\u0275\u0275element(1,"pbi-checkbox",48),d.\u0275\u0275pipe(2,"async"),d.\u0275\u0275element(3,"tri-svg-icon",49),d.\u0275\u0275elementStart(4,"label"),d.\u0275\u0275text(5),d.\u0275\u0275elementEnd()()),2&e){var a=d.\u0275\u0275nextContext(),r=a.$implicit,i=a.index,s=d.\u0275\u0275nextContext(4);d.\u0275\u0275property("triTooltipDisabled",!r.isDisabled)("triTooltip",r.toolTip),d.\u0275\u0275advance(1),d.\u0275\u0275property("formControlName",i)("disabled",d.\u0275\u0275pipeBind1(2,8,s.isButtonLevelSpinnerDisplayed$))("ariaLabel",r.item.uniqueName),d.\u0275\u0275advance(2),d.\u0275\u0275property("name",r.iconProperties.iconName)("sprite",r.iconProperties.sprite),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(r.item.uniqueName)}}function hv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"span",45),d.\u0275\u0275template(1,fv,6,10,"div",46),d.\u0275\u0275elementEnd()),2&e){var a=t.$implicit;d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",a.isVisible)}}function gv(e,t){if(1&e&&(d.\u0275\u0275elementContainerStart(0),d.\u0275\u0275element(1,"pbi-checkbox",40),d.\u0275\u0275pipe(2,"localize"),d.\u0275\u0275pipe(3,"async"),d.\u0275\u0275element(4,"hr",41),d.\u0275\u0275elementStart(5,"div",42)(6,"div",43),d.\u0275\u0275template(7,hv,2,1,"span",44),d.\u0275\u0275elementEnd()(),d.\u0275\u0275elementContainerEnd()),2&e){var a=d.\u0275\u0275nextContext(3);d.\u0275\u0275advance(1),d.\u0275\u0275propertyInterpolate("label",d.\u0275\u0275pipeBind1(2,3,"SelectAll")),d.\u0275\u0275property("disabled",d.\u0275\u0275pipeBind1(3,5,a.isButtonLevelSpinnerDisplayed$)),d.\u0275\u0275advance(6),d.\u0275\u0275property("ngForOf",a.allCheckboxes)}}function bv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"div",50)(1,"tri-checkbox",51),d.\u0275\u0275listener("onChange",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(s.schemaViewSelectAll())}),d.\u0275\u0275pipe(2,"localize"),d.\u0275\u0275pipe(3,"async"),d.\u0275\u0275elementEnd(),d.\u0275\u0275element(4,"hr",41),d.\u0275\u0275elementStart(5,"pbi-tree",52),d.\u0275\u0275listener("onNodeCheck",function(s){d.\u0275\u0275restoreView(a);var c=d.\u0275\u0275nextContext(3);return d.\u0275\u0275resetView(c.onNodeCheck(s))}),d.\u0275\u0275elementEnd()()}if(2&e){var r=d.\u0275\u0275nextContext(3);d.\u0275\u0275advance(1),d.\u0275\u0275propertyInterpolate("label",d.\u0275\u0275pipeBind1(2,9,"SelectAll")),d.\u0275\u0275property("checked",null==r.schemaViewSelectAllState?null:r.schemaViewSelectAllState.checked)("indeterminate",null==r.schemaViewSelectAllState?null:r.schemaViewSelectAllState.isIndeterminate)("disabled",d.\u0275\u0275pipeBind1(3,11,r.isButtonLevelSpinnerDisplayed$)),d.\u0275\u0275advance(4),d.\u0275\u0275property("tree",r.treeModel)("search",r.schemaViewSearchText)("checkMode",r.checkMode)("filter",r.schemaViewFieldListFilters)("options",r.fieldListOptions)}}var yv=function(t){return{"overflow-y":t}};function Dv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"form",7),d.\u0275\u0275template(1,cv,1,1,"message-banner",8),d.\u0275\u0275template(2,lv,3,2,"div",9),d.\u0275\u0275elementStart(3,"p",10),d.\u0275\u0275text(4),d.\u0275\u0275elementStart(5,"tri-link",11),d.\u0275\u0275text(6),d.\u0275\u0275pipe(7,"localize"),d.\u0275\u0275elementEnd()(),d.\u0275\u0275elementStart(8,"div",12)(9,"tri-search-box",13,14),d.\u0275\u0275listener("value",function(u){d.\u0275\u0275restoreView(a);var m=d.\u0275\u0275nextContext(2);return d.\u0275\u0275resetView(m.onSearchTextChange(u))}),d.\u0275\u0275pipe(11,"localize"),d.\u0275\u0275pipe(12,"async"),d.\u0275\u0275template(13,mv,8,12,"ng-container",15),d.\u0275\u0275template(14,pv,7,18,"ng-template",null,16,d.\u0275\u0275templateRefExtractor),d.\u0275\u0275elementEnd(),d.\u0275\u0275template(16,vv,6,12,"button",17),d.\u0275\u0275elementEnd(),d.\u0275\u0275template(17,gv,8,7,"ng-container",15),d.\u0275\u0275template(18,bv,6,13,"ng-template",null,18,d.\u0275\u0275templateRefExtractor),d.\u0275\u0275elementEnd()}if(2&e){var r=d.\u0275\u0275reference(15),i=d.\u0275\u0275reference(19),s=d.\u0275\u0275nextContext(2);d.\u0275\u0275property("formGroup",s.manageDatasetGroup)("ngStyle",d.\u0275\u0275pureFunction1(22,yv,s.useSchemaView?"hidden":"auto")),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",s.messageBannerModel),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",!s.hideDatasetNameField||!s.hideWorkspacePicker),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate1("",s.dialogDescription," "),d.\u0275\u0275advance(1),d.\u0275\u0275property("href","Datamart"===s.manageDatasetService.source?"https://go.microsoft.com/fwlink/?linkid=2236525":"https://go.microsoft.com/fwlink/?linkid=2275520")("external",!0),d.\u0275\u0275advance(1),d.\u0275\u0275textInterpolate1(" ",d.\u0275\u0275pipeBind1(7,16,"LearnMore")," "),d.\u0275\u0275advance(3),d.\u0275\u0275property("placeholderText",d.\u0275\u0275pipeBind1(11,18,"SearchBox_Text"))("isDisabled",d.\u0275\u0275pipeBind1(12,20,s.isButtonLevelSpinnerDisplayed$))("autocomplete","off"),d.\u0275\u0275advance(4),d.\u0275\u0275property("ngIf",!s.useSchemaView)("ngIfElse",r),d.\u0275\u0275advance(3),d.\u0275\u0275property("ngIf",!s.isDefaultDataset&&!s.isRemoteModeling),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",!s.useSchemaView)("ngIfElse",i)}}function _v(e,t){if(1&e&&d.\u0275\u0275template(0,Dv,20,24,"form",6),2&e){var a=d.\u0275\u0275nextContext();d.\u0275\u0275property("ngIf",a.manageDatasetGroup)}}function Sv(e,t){1&e&&(d.\u0275\u0275elementStart(0,"span"),d.\u0275\u0275text(1),d.\u0275\u0275pipe(2,"localize"),d.\u0275\u0275elementStart(3,"tri-link",53),d.\u0275\u0275text(4),d.\u0275\u0275pipe(5,"localize"),d.\u0275\u0275elementEnd()()),2&e&&(d.\u0275\u0275advance(1),d.\u0275\u0275textInterpolate1(" ",d.\u0275\u0275pipeBind1(2,3,"SeeThrough_Workspace_Tooltip")," "),d.\u0275\u0275advance(2),d.\u0275\u0275property("external",!0),d.\u0275\u0275advance(1),d.\u0275\u0275textInterpolate1(" ",d.\u0275\u0275pipeBind1(5,5,"LearnMore")," "))}var Iv={isInformationProtectionSupportedForTridentEnabled:function(){return L.fF.assertFail("ManageDatasetComponent: InformationProtectionService is not provided, isInformationProtectionSupportedForTridentEnabled will always be false."),!1},getOrLoadArtifactInformationProtection:function(){return L.fF.assertFail("ManageDatasetComponent: InformationProtectionService is not provided, getOrLoadArtifactInformationProtection will always be null."),(0,we.of)(null)},isMandatoryLabelEnabled:function(){return L.fF.assertFail("ManageDatasetComponent: InformationProtectionService is not provided, isMandatoryLabelEnabled will always be false."),(0,we.of)(!1)},getDefaultLabelId:function(){return L.fF.assertFail("ManageDatasetComponent: InformationProtectionService is not provided, getDefaultLabelId will always be null."),(0,we.of)(null)}},Ev={open:function(){return L.fF.assertFail("ManageDatasetComponent: TriInformationProtectionMandatoryLabelDialogService is not provided, open will always do nothing and return undefined."),Promise.resolve(void 0)}},Tr=function(e){function t(a,r,i,s,c,u,m,p,v,b,E,D,O,A){var C=e.call(this)||this;return C.templateDialogPayload=a,C.formBuilder=r,C.telemetryService=i,C.pbiMenuService=s,C.featureSwitchService=c,C.localizationService=u,C.pbiTreeConverter=m,C.ref=p,C.searchStrategy=v,C.manageDatasetService=b,C.standardizedEventsService=E,C.informationProtectionService=D,C.sensitivityDialogService=O,C.featureSwitchValuesLoader=A,C.workspaceCapacityFilter=[1,7,8,9],C.forceDisableMyWorkspace=!0,C.datasetNameMaxCharacterLimit=250,C.allCheckboxes=[],C.validDatasetName$=new at.X(!1),C.validWorkspaceSelected$=new at.X(!1),C.validCheckboxSelections$=new at.X(!1),C.isButtonLevelSpinnerDisplayed$=new at.X(!1),C.isDialogLevelSpinnerDisplayed$=new at.X(!1),C.hasSelectedViews=!1,C.didShowViewsDisclaimer=!1,C.didFocusOnNameField=!1,C.selectedOptions=new Map,C.selectedViewUrns=new Set,C.originallyDisabledNodes=new Set,C.schemaViewFieldListFilters=void 0,C.foundItem=!1,C.allTreeCheckboxes={objectsToAdd:[],objectsToRemove:[]},C.useSchemaView=!1,C.checkMode=Te.kH.Multi,C.fieldListOptions={search:C.searchStrategy},D||(C.informationProtectionService=Iv),O||(C.sensitivityDialogService=Ev),C}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"isErrorBannerShown",{get:function(){return this.messageBannerModel&&1===this.messageBannerModel.bannerType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCreateCommand",{get:function(){return"Create"===this.manageDatasetService.settings.command},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditCommand",{get:function(){return"Edit"===this.manageDatasetService.settings.command},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWarehouseOrDatamart",{get:function(){return"Warehouse"===this.manageDatasetService.source||"Datamart"===this.manageDatasetService.source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDefaultDataset",{get:function(){return this.manageDatasetService.settings.isFromManageDefaultDataset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRemoteModeling",{get:function(){return this.manageDatasetService.settings.returnTableResults},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hideDatasetNameField",{get:function(){return this.manageDatasetService.settings.hideDatasetNameField||this.isEditCommand},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hideWorkspacePicker",{get:function(){return this.manageDatasetService.settings.hideWorkspacePicker||this.isEditCommand},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"featureName",{get:function(){return this.isDefaultDataset?"ManageDefaultDataset":"SeeThroughModeling"},enumerable:!1,configurable:!0}),t.prototype.hasDatamartWritePermission=function(a){return"Contributor"===a||"Member"===a||"Admin"===a},t.prototype.onWorkspaceSelected=function(a){a?(this.selectedWorkspaceId=a.objectId,this.validWorkspaceSelected$.next(!0)):(this.selectedWorkspaceId=void 0,this.validWorkspaceSelected$.next(!1))},t.prototype.ngOnInit=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a=this;return(0,o.__generator)(this,function(r){switch(r.label){case 0:return this.featureSwitchValuesLoader?[4,this.featureSwitchValuesLoader.ensureDynamicFeatureSwitchesLoaded()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.dialogDescription=this.localizationService.get("Update_SemanticModel_Objects"),this.useSchemaView="Warehouse"===this.manageDatasetService.source&&(this.isEditCommand&&this.isDefaultDataset||this.isCreateCommand)||this.featureSwitchService.featureSwitches.SchemaPickerLHSqlEndpointEditTables,this.allValid$=(0,Lo.aj)([this.validDatasetName$,this.validWorkspaceSelected$,this.validCheckboxSelections$,this.isButtonLevelSpinnerDisplayed$,this.isDialogLevelSpinnerDisplayed$]).pipe((0,X.U)(function(i){return(i[0]||a.hideDatasetNameField)&&(i[1]||a.hideWorkspacePicker)&&i[2]&&!i[3]&&!i[4]})),this.allValid$.subscribe(function(i){a.templateDialogPayload.setOkButtonState(!i)}),this.templateDialogPayload.onOkButtonClick=function(){return(0,o.__awaiter)(a,void 0,void 0,function(){return(0,o.__generator)(this,function(i){return[2,this.onOk()]})})},this.templateDialogPayload.onCancelButtonClick=function(){return(0,o.__awaiter)(a,void 0,void 0,function(){return(0,o.__generator)(this,function(i){return[2,this.onCancel()]})})},this.templateDialogPayload.spinnerDisplay$.pipe((0,Je.R)(this.onDestroy$)).subscribe(function(i){i&&a.isErrorBannerShown&&a.closeBanner(),a.isButtonLevelSpinnerDisplayed$.next(i)}),this.isDialogLevelSpinnerDisplayed$.next(!0),this.useSchemaView?[4,this.setUpSchemaView()]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,this.populateFlatListCheckboxes(!1)];case 5:r.sent(),r.label=6;case 6:return this.isDialogLevelSpinnerDisplayed$.next(!1),[2]}})})},t.prototype.setInitialFilters=function(){var a=!this.isWarehouseOrDatamart,r=this.hasSelectedViews&&!this.isWarehouseOrDatamart;this.filterMenu={styles:{"border-radius":"5px",width:"225px"},items:[{id:Ye.ShowOnlyTables,type:Uo.iB.Button,text:this.localizationService.get("Show_Tables"),checkable:!0,checked:a},{id:Ye.ShowOnlyViews,type:Uo.iB.Button,text:this.localizationService.get("Datamart_Show_Views"),checkable:!0,checked:r}]},this.selectedOptions.set(Ye.ShowOnlyTables,a),this.selectedOptions.set(Ye.ShowOnlyViews,r)},t.prototype.ngAfterViewChecked=function(){this.datasetNameFieldRef&&!this.didFocusOnNameField&&this.isCreateCommand&&(this.datasetNameFieldRef.nativeElement.focus(),this.didFocusOnNameField=!0)},t.prototype.onSearchTextChange=function(a){this.useSchemaView?this.schemaViewSearchText=a:(this.allCheckboxes.forEach(function(r){return r.isVisible=r.item.uniqueName.includes(a)}),this.handleSelectAllCheckbox())},t.prototype.onOk=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a,r,s,c,u,m,p,v,b,E,D,O,A,C,I,P,M;return(0,o.__generator)(this,function(F){switch(F.label){case 0:return this.templateDialogPayload.setSpinnerDisplay(!0),a=this.getFinalSelectedObjects(),this.useSchemaView&&this.schemaViewSelectAll(!0),r=this.telemetryService.logEvent(up,{source:this.manageDatasetService.source,command:this.manageDatasetService.settings.command,objectsToAdd:a.objectsToAdd,objectsToRemove:a.objectsToRemove}),this.logStandardizedEvent(r),_.isEmpty(a.objectsToAdd)&&_.isEmpty(a.objectsToRemove)?(this.tablesAndViews.skipStore?this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled",isFromNewReport:this.tablesAndViews.isFromNewReport}):(this.manageDatasetService.createReportIfNeeded(),this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled"})),[3,18]):[3,1];case 1:this.templateDialogPayload.toggleCancelButton(!0),F.label=2;case 2:switch(F.trys.push([2,17,,18]),this.manageDatasetService.settings.command){case"Create":return[3,3];case"Edit":return[3,11]}return[3,15];case 3:return s=void 0,this.informationProtectionService.isInformationProtectionSupportedForTridentEnabled()?(s=this.manageDatasetService.settings.parentSensitivityLabelId)?[3,5]:[4,this.informationProtectionService.getOrLoadArtifactInformationProtection(Pr.Bz.Datamart,null,this.manageDatasetService.datamartObjectId,!0).toPromise()]:[3,9];case 4:c=F.sent(),s=c?.labelId,F.label=5;case 5:return(u=!s)?[4,this.shouldShowSensitivityLabelPicker()]:[3,7];case 6:u=F.sent(),F.label=7;case 7:return u?[4,this.sensitivityDialogService.open({artifactTypeName:"dataset"})]:[3,9];case 8:if(!(s=F.sent()))return this.templateDialogPayload.toggleCancelButton(!1),this.templateDialogPayload.setSpinnerDisplay(!1),[2];F.label=9;case 9:return[4,this.manageDatasetService.createDataset(this.datasetName,this.selectedWorkspaceId,a.objectsToAdd,s)];case 10:return m=F.sent(),this.templateDialogPayload.closeDialogFromConsumer({status:"Succeeded",datasetUrl:m}),[3,16];case 11:if(!this.isRemoteModeling)return[3,12];for(p=new Set(a.objectsToAdd),v=[],b=0,E=this.tablesAndViews.tables;b<E.length;b++)v.push((0,o.__assign)((0,o.__assign)({},D=E[b]),{isBiObject:p.has(D.uniqueName)}));for(O=0,A=this.tablesAndViews.views;O<A.length;O++)v.push((0,o.__assign)((0,o.__assign)({},C=A[O]),{isBiObject:p.has(C.uniqueName)}));return I=_.map(v,function(Z){return{sourceName:Z.name,sourceLineageTag:Z.sourceLineageTag,checked:Z.isBiObject}}).filter(function(Z){return!!Z.sourceName}),this.templateDialogPayload.closeDialogFromConsumer({status:"Succeeded",tableResults:I}),[3,14];case 12:return[4,this.manageDatasetService.updateTables(a.objectsToAdd,a.objectsToRemove)];case 13:F.sent(),P={status:"Succeeded"},this.tablesAndViews.skipStore&&(P=(0,o.__assign)((0,o.__assign)({},P),{isFromNewReport:this.tablesAndViews.isFromNewReport,diagramLayoutChange:{initialTablesState:this.getAllBiTablesAndViews(),modelObjectsToAdd:a.objectsToAdd,modelObjectsToRemove:a.objectsToRemove}})),this.templateDialogPayload.closeDialogFromConsumer(P),F.label=14;case 14:return[3,16];case 15:return L.fF.assertFail("Unknown command"),[3,16];case 16:return[3,18];case 17:return 500!==(M=F.sent()).status?(this.showErrorMessageBanner(M),this.useSchemaView&&this.schemaViewSelectAll(!1),this.templateDialogPayload.toggleCancelButton(!1),this.templateDialogPayload.setSpinnerDisplay(!1),[2]):(this.templateDialogPayload.closeDialogFromConsumer({status:"Failed",error:M}),[3,18]);case 18:return[2]}})})},t.prototype.onCancel=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a,r;return(0,o.__generator)(this,function(i){return a=!1,this.templateDialogPayload.hideCancelButton$.pipe((0,B.q)(1)).subscribe(function(s){a=s}),a||(r=this.telemetryService.logEvent(lp,{source:this.manageDatasetService.source,command:this.manageDatasetService.settings.command}),this.logStandardizedEvent(r),this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled"})),[2]})})},t.prototype.refresh=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a,r=this;return(0,o.__generator)(this,function(i){switch(i.label){case 0:return this.isRemoteModeling?[2]:(this.isErrorBannerShown&&this.closeBanner(),this.isDialogLevelSpinnerDisplayed$.next(!0),a=function(){return(0,o.__awaiter)(r,void 0,void 0,function(){var c,u;return(0,o.__generator)(this,function(m){switch(m.label){case 0:return m.trys.push([0,4,,5]),[4,this.manageDatasetService.getDatamartUserPermissions()];case 1:return c=m.sent(),this.hasDatamartWritePermission(c.groupAccessRight)?[4,this.manageDatasetService.refreshSchema()]:[3,3];case 2:m.sent(),m.label=3;case 3:return[3,5];case 4:return u=m.sent(),this.showErrorMessageBanner(u),[3,5];case 5:return[2]}})})},this.useSchemaView?(this.schemaViewFieldListFilters=void 0,[4,a()]):[3,3]);case 1:return i.sent(),[4,this.setUpSchemaView(!0)];case 2:return i.sent(),[3,6];case 3:return[4,a()];case 4:return i.sent(),[4,this.populateFlatListCheckboxes(!0)];case 5:i.sent(),i.label=6;case 6:return this.isDialogLevelSpinnerDisplayed$.next(!1),[2]}})})},t.prototype.closeBanner=function(){this.messageBannerModel=void 0},t.prototype.onFilterChange=function(a){var r,i;if(0===a.selected.length)this.schemaViewFieldListFilters=void 0;else if("Object"===a.changed[0].item.groupId)this.schemaViewFieldListFilters=(0,o.__assign)((0,o.__assign)({},this.schemaViewFieldListFilters),((r={})[a.changed[0].item.id]=a.changed[0].checked,r));else if("Schema"===a.changed[0].item.groupId){var s=a.selected.reduce(function(c,u){return"Schema"===u.groupId&&c.push(u.id),c},[]);this.schemaViewFieldListFilters=(0,o.__assign)((0,o.__assign)({},this.schemaViewFieldListFilters),((i={})[a.changed[0].item.groupId]=s,i))}this.ref.markForCheck()},t.prototype.shouldShowSensitivityLabelPicker=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,(0,Lo.aj)([this.informationProtectionService.isMandatoryLabelEnabled(Pr.Bz.Model,!0),this.informationProtectionService.getDefaultLabelId(!0)]).pipe((0,X.U)(function(i){return i[0]&&!i[1]})).toPromise()];case 1:return[2,r.sent()]}})})},t.prototype.onNodeCheck=function(a){var r=this;this.treeModel.nodes=this.treeModel.nodes.map(function(i){return r.foundItem?i:i.data.urn===a.node.data.urn?(i.isIndeterminate?(i.checked=!1,i.isIndeterminate=!1):i.checked=!i.checked,i=r.updateAllChildNodes(i),r.foundItem=!0,i):i=r.updateTreeCheckboxes(i,a.node.data.urn)}),this.foundItem=!1,this.updateSelectAllTreeState(),this.validateCheckboxSelections()},t.prototype.schemaViewSelectAll=function(a){var r=this;this.schemaViewSelectAllState=null==a?{isIndeterminate:!1,checked:!this.schemaViewSelectAllState.checked,disabled:this.schemaViewSelectAllState.disabled}:(0,o.__assign)((0,o.__assign)({},this.schemaViewSelectAllState),{disabled:a}),this.treeModel.nodes=this.treeModel.nodes.map(function(i){if(a)i.disabled=!0;else{if(i.disabled)return r.originallyDisabledNodes.has(i.data.urn)||(i.disabled=!1),r.updateAllChildNodes(i);i.checked=r.schemaViewSelectAllState.checked,i.isIndeterminate=!1}return r.updateAllChildNodes(i,a)}),this.treeModel={nodes:this.treeModel.nodes,parent:this.treeModel.parent},this.ref.markForCheck(),this.validateCheckboxSelections()},t.prototype.setUpSchemaView=function(a){return(0,o.__awaiter)(this,void 0,void 0,function(){var r,i,p=this;return(0,o.__generator)(this,function(v){switch(v.label){case 0:this.manageDatasetGroup=this.formBuilder.group({datasetNameField:[]}),this.setupForm(),this.templateDialogPayload.setSpinnerDisplay(a&&!this.isDialogLevelSpinnerDisplayed$.value),v.label=1;case 1:return v.trys.push([1,3,,4]),r=this,[4,this.manageDatasetService.getTables(a,!0)];case 2:return r.tablesAndViews=v.sent(),[3,4];case 3:return i=v.sent(),this.templateDialogPayload.closeDialogFromConsumer({status:"Failed",error:i}),[2];case 4:return this.treeModel=this.pbiTreeConverter.convertModelToPbiTree(this.tablesAndViews.models,!1,void 0,!0,this.tablesAndViews.skipStore,this.tablesAndViews.datamartType,this.tablesAndViews.isWarehousePrimary),this.treeModel.nodes.forEach(function(b){b.disabled&&p.originallyDisabledNodes.add(b.data.urn),p.checkSchemaCheckboxsInitialState(b)}),this.updateSelectAllTreeState(),this.schemaViewFilters=this.buildFilterGroups(),[2]}})})},t.prototype.checkSchemaCheckboxsInitialState=function(a){var r=this;return this.updateSelectedViewUrns(a),0!==a.children.length&&a.children.forEach(function(i){i.disabled&&r.originallyDisabledNodes.add(i.data.urn),r.checkSchemaCheckboxsInitialState(i)}),a},t.prototype.updateSelectedViewUrns=function(a){"View"===a.data.objectType&&(a.checked||a.isIndeterminate?this.selectedViewUrns.add(a.data.urn):this.selectedViewUrns.delete(a.data.urn))},t.prototype.updateAllChildNodes=function(a,r){var i=this;return this.updateSelectedViewUrns(a),0!==a.children.length&&(a.children=a.children.map(function(s){return r?s.disabled=r:s.disabled?i.originallyDisabledNodes.has(s.data.urn)||(s.disabled=!1):(s.checked=a.checked,s.isIndeterminate=a.isIndeterminate,s.disabled=a.disabled),i.updateAllChildNodes(s,r)})),a},t.prototype.setupForm=function(){var a=this;this.manageDatasetGroup.controls.datasetNameField.valueChanges.pipe((0,Er.O)(this.manageDatasetGroup.controls.datasetNameField.value),(0,Je.R)(this.onDestroy$)).subscribe(function(r){a.datasetName=_.trim(r),a.validDatasetName$.next(!_.isEmpty(a.datasetName))})},t.prototype.getAllCurrentUpdatedCheckboxes=function(a){var r=this,i={objectsToAdd:[],objectsToRemove:[]};return a.forEach(function(s){if(s.children.length>0){var c=r.getAllCurrentUpdatedCheckboxes(s.children);c.objectsToAdd.length>0&&(r.allTreeCheckboxes.objectsToAdd=r.allTreeCheckboxes.objectsToAdd.concat(c.objectsToAdd)),c.objectsToRemove.length>0&&(r.allTreeCheckboxes.objectsToRemove=r.allTreeCheckboxes.objectsToRemove.concat(c.objectsToRemove))}else("Table"===s.data.objectType||"View"===s.data.objectType)&&void 0!==s.data.name&&(r.isDefaultDataset?(s.checked&&!s.data.isBiObject&&i.objectsToAdd.push(s.data.uniqueName),!s.checked&&s.data.isBiObject&&i.objectsToRemove.push(s.data.uniqueName)):s.checked&&i.objectsToAdd.push(s.data.uniqueName))}),i},t.prototype.getFinalSelectedObjects=function(){var a={objectsToAdd:[],objectsToRemove:[]};if(this.useSchemaView)this.getAllCurrentUpdatedCheckboxes(this.treeModel.nodes),a=this.allTreeCheckboxes;else if(this.isDefaultDataset){var i=this.getCurrentSelections();a.objectsToAdd=_.map(this.allCheckboxes,function(s,c){if(!s.isDisabled&&!s.item.isBiObject&&i[c])return s.item.uniqueName}).filter(function(s){return void 0!==s}),a.objectsToRemove=_.map(this.allCheckboxes,function(s,c){if(!s.isDisabled&&s.item.isBiObject&&!i[c])return s.item.uniqueName}).filter(function(s){return void 0!==s})}else{var r=this.getCurrentSelections();a.objectsToAdd=_.map(this.allCheckboxes,function(s,c){if(r[c])return s.item.uniqueName}).filter(function(s){return void 0!==s})}return a},t.prototype.updateTreeCheckboxes=function(a,r){var s,i=this;return 0===a.children.length?a:a.children.find(function(u,m){return s=m,u.data.urn===r})?(this.foundItem=!0,a.children[s].isIndeterminate?(a.children[s].checked=!1,a.children[s].isIndeterminate=!1):a.children[s].checked=!a.children[s].checked,a.children[s]=this.updateAllChildNodes(a.children[s]),ct.updateTreeNodeState(a),a):(0!==a.children.length&&(a.children=a.children.map(function(u){return i.foundItem||0===u.children.length?u:i.updateTreeCheckboxes(u,r)}),ct.updateTreeNodeState(a)),a)},t.prototype.buildFilterGroups=function(){return[{displayName:"Schema",id:"Schema",items:this.buildSchemaFilterItems()},{displayName:"Object",id:"Object",items:[{displayName:"Tables",id:"Table",icon:{name:"table_20_regular"},activeIcon:{name:"table_20_filled"}},{displayName:"Views",id:"View",icon:{name:"square_multiple_overlap_line_20_regular",sprite:"warehouse-icons"},activeIcon:{name:"square_multiple_overlap_line_20_filled",sprite:"warehouse-icons"}}]}]},t.prototype.buildSchemaFilterItems=function(){var a=[];return this.treeModel.nodes.forEach(function(r){a.push({displayName:r.displayName,id:r.data.name,icon:{name:"schema_20_regular",sprite:"warehouse-icons"},activeIcon:{name:"schema_20_filled",sprite:"warehouse-icons"}})}),a},t.prototype.updateSelectAllTreeState=function(){var a=this.treeModel.nodes.filter(function(i){return!i.disabled}),r=this.treeModel.nodes.length>0&&this.treeModel.nodes.every(function(i){return i.checked});this.schemaViewSelectAllState={isIndeterminate:this.treeModel.nodes.some(function(i){return i.isIndeterminate||i.checked})&&!r,checked:r,disabled:0===a.length},this.validateCheckboxSelections()},t.prototype.getToolTip=function(a){return a?this.localizationService.get("Datamart_Manage_Default_Dataset_Object_Has_Measure_Tooltip"):""},t.prototype.setUpTableView=function(a){return(0,o.__awaiter)(this,void 0,void 0,function(){var r,i,s=this;return(0,o.__generator)(this,function(c){switch(c.label){case 0:this.validCheckboxSelections$.next(!1),this.templateDialogPayload.setSpinnerDisplay(a&&!this.isDialogLevelSpinnerDisplayed$.value),c.label=1;case 1:return c.trys.push([1,3,,4]),r=this,[4,this.manageDatasetService.getTables(a)];case 2:return r.tablesAndViews=c.sent(),[3,4];case 3:return i=c.sent(),this.templateDialogPayload.closeDialogFromConsumer({status:"Failed",error:i}),[2];case 4:return this.hasSelectedViews=!!_.find(this.tablesAndViews.views,function(u){return u.isBiObject}),this.hasSelectedViews&&!this.didShowViewsDisclaimer&&this.showDQFallbackDisclaimer(!0),this.allCheckboxes=this.tablesAndViews.tables.map(function(u){return{item:u,isVisible:!0,iconProperties:{iconName:"Lakehouse"===s.manageDatasetService.source?"table_triangle_20_regular":"table_20_regular",sprite:"Lakehouse"===s.manageDatasetService.source?"visual-calc-icons":null},isDisabled:!_.isEmpty(u.measures),toolTip:s.getToolTip(!_.isEmpty(u.measures))}}).concat(this.tablesAndViews.views.map(function(u){return{item:u,isVisible:s.isWarehouseOrDatamart||s.hasSelectedViews,iconProperties:{iconName:"square_multiple_overlap_line_20_regular",sprite:"warehouse-icons"},isDisabled:!_.isEmpty(u.measures),toolTip:s.getToolTip(!_.isEmpty(u.measures))}})),this.manageDatasetGroup=this.formBuilder.group({selectAll:new y.p4(!1),checkboxes:this.formBuilder.array(this.allCheckboxes.map(function(u){return new y.p4({value:u.item.isBiObject,disabled:u.isDisabled})})),datasetNameField:[]}),this.manageDatasetGroup.controls.datasetNameField.valueChanges.pipe((0,Er.O)(this.manageDatasetGroup.controls.datasetNameField.value),(0,Je.R)(this.onDestroy$)).subscribe(function(u){s.datasetName=_.trim(u),s.validDatasetName$.next(!_.isEmpty(s.datasetName))}),this.manageDatasetGroup.controls.checkboxes.valueChanges.pipe((0,Er.O)(this.manageDatasetGroup.controls.checkboxes.value),(0,Je.R)(this.onDestroy$)).subscribe(function(){s.validateCheckboxSelections(),s.handleSelectAllCheckbox()}),this.manageDatasetGroup.controls.selectAll.valueChanges.pipe((0,Je.R)(this.onDestroy$)).subscribe(function(u){var m=s.getCurrentSelections();s.manageDatasetGroup.controls.checkboxes.setValue(s.allCheckboxes.map(function(p,v){return p.isVisible&&!p.isDisabled?u:m[v]}),{emitEvent:!1}),s.validateCheckboxSelections()}),this.validateCheckboxSelections(),this.templateDialogPayload.setSpinnerDisplay(!1),[2]}})})},t.prototype.validateCheckboxSelections=function(){var a=this;this.useSchemaView&&(this.selectedViewUrns.size>0?this.showDQFallbackDisclaimer(!1):this.isErrorBannerShown||this.closeBanner());var r=this.useSchemaView?this.treeModel.nodes.every(function(s){return a.isAllTreeNodesUnchecked(s)}):this.getCurrentSelections().every(function(s){return!s});this.validCheckboxSelections$.next(!(r&&!this.manageDatasetService.settings.allowRemovalOfAllTables))},t.prototype.isAllTreeNodesUnchecked=function(a){var r=this;return a.children&&0!==a.children.length?a.children.map(function(s){return r.isAllTreeNodesUnchecked(s)}).every(function(s){return s}):!a.checked},t.prototype.showErrorMessageBanner=function(a){var r,i,s,c,u,m,p,v,b;switch(L.fF.assertValue(a.error,"error.error has to be defined"),null===(r=a.error)||void 0===r?void 0:r.code){case"DatamartVersionMismatch":v=this.localizationService.get("Datamart_Manage_Default_Dataset_DatamartVersionMismatchVersion"),b=this.localizationService.get("Refresh"),this.setButtonToRefresh();break;case"TablesMissingInDatamartDatasetException":v=this.localizationService.get("Datamart_Manage_Default_Dataset_TablesMissingInDatamartDatasetException"),b=this.localizationService.get("Refresh"),this.setButtonToRefresh();break;case"ColumnCountExceedsMaxLimitException":var E=null===(c=null===(s=null===(i=a.error)||void 0===i?void 0:i["pbi.error"])||void 0===s?void 0:s.parameters)||void 0===c?void 0:c.ErrorMessage;v=this.localizationService.format("Datamart_Manage_Default_Dataset_ColumnCountExceedsMaxLimitException",E.substring(E.indexOf("table name")+11,E.indexOf(",")));break;case"OverallColumnCountExceedsMaxLimitException":v=this.localizationService.get("Datamart_Manage_Default_Dataset_OverallColumnCountExceedsMaxLimitException");break;default:v=null===(p=null===(m=null===(u=a.error)||void 0===u?void 0:u["pbi.error"])||void 0===m?void 0:m.parameters)||void 0===p?void 0:p.ErrorMessage}this.messageBannerModel={bannerType:1,iconName:"pbi-glyph-error",message:v,buttonText:b,closeButtonTooltip:"Storytelling_Close_Banner"}},t.prototype.openMenu=function(a){var r=this,i=this.pbiMenuService.open({menu:this.filterMenu,closeOnButtonClick:!1,origin:{element:a,x:a.getBoundingClientRect().right-225,y:a.getBoundingClientRect().bottom}});i.onClose$.pipe((0,B.q)(1)).subscribe(function(){r.pbiMenuService.closeAll()}),i.onButtonClick$.pipe((0,Je.R)(i.onClose$)).subscribe(function(s){s.checked=!s.checked,r.onFilterOptionsChanged(Number(s.id))})},t.prototype.onFilterOptionsChanged=function(a){this.selectedOptions.set(a,!this.selectedOptions.get(a)||!1),this.allCheckboxes.forEach(function(r){return r.isVisible=!1}),this.selectedOptions.get(Ye.ShowOnlyTables)&&this.selectedOptions.get(Ye.ShowOnlyViews)?this.allCheckboxes.forEach(function(r){return r.isVisible=!0}):this.selectedOptions.get(Ye.ShowOnlyTables)?this.allCheckboxes.forEach(function(r){return r.isVisible="Table"===r.item.objectType}):this.selectedOptions.get(Ye.ShowOnlyViews)?this.allCheckboxes.forEach(function(r){return r.isVisible="View"===r.item.objectType}):this.isWarehouseOrDatamart&&this.allCheckboxes.forEach(function(r){return r.isVisible=!0}),!this.didShowViewsDisclaimer&&this.selectedOptions.get(Ye.ShowOnlyViews)&&!this.isWarehouseOrDatamart&&this.showDQFallbackDisclaimer(!0),this.handleSelectAllCheckbox(),this.ref.markForCheck()},t.prototype.handleSelectAllCheckbox=function(){if(this.allCheckboxes.every(function(i){return i.isDisabled||!i.isVisible}))this.manageDatasetGroup.controls.selectAll.setValue(!1,{emitEvent:!1}),this.manageDatasetGroup.controls.selectAll.disable({emitEvent:!1});else{var a=this.getCurrentSelections(),r=this.allCheckboxes.every(function(i,s){return!0===a[s]||!i.isVisible||i.isDisabled});this.manageDatasetGroup.controls.selectAll.enable({emitEvent:!1}),this.manageDatasetGroup.controls.selectAll.setValue(r,{emitEvent:!1})}},t.prototype.getCurrentSelections=function(){if(_.isNil(this.manageDatasetGroup))return[];var a=this.manageDatasetGroup.controls.checkboxes.value,r=0;return this.allCheckboxes.map(function(i){return i.isDisabled?i.item.isBiObject:a[r++]})},t.prototype.setButtonToRefresh=function(){var a=this;this.errorButtonClicked=function(){return(0,o.__awaiter)(a,void 0,void 0,function(){return(0,o.__generator)(this,function(r){switch(r.label){case 0:return this.closeBanner(),this.useSchemaView?[4,this.setUpSchemaView(!0)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this.populateFlatListCheckboxes(!0)];case 3:r.sent(),r.label=4;case 4:return[2]}})})}},t.prototype.logStandardizedEvent=function(a){this.standardizedEventsService&&this.standardizedEventsService.logEvent(a,[this.featureName],!0,a.info)},t.prototype.populateFlatListCheckboxes=function(a){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,this.setUpTableView(a)];case 1:return r.sent(),this.setInitialFilters(),[2]}})})},t.prototype.showDQFallbackDisclaimer=function(a){this.isErrorBannerShown||(this.messageBannerModel={bannerType:0,iconName:"pbi-glyph-info",message:this.localizationService.get("DirectQueryFallback_PerformanceDisclaimer"),allowDismiss:a,closeButtonTooltip:"Storytelling_Close_Banner"},this.didShowViewsDisclaimer=!0)},t.prototype.getAllBiTablesAndViews=function(){var a=[];return this.tablesAndViews.tables.forEach(function(r){r.isBiObject&&a.push(r.name)}),this.tablesAndViews.views.forEach(function(r){r.isBiObject&&a.push(r.name)}),a},t.\u0275fac=function(r){return new(r||t)(d.\u0275\u0275directiveInject(Qe.x),d.\u0275\u0275directiveInject(y.QS),d.\u0275\u0275directiveInject(Lt.y0),d.\u0275\u0275directiveInject(kp.o),d.\u0275\u0275directiveInject(qt.vZ),d.\u0275\u0275directiveInject(Ot.o),d.\u0275\u0275directiveInject(Xn),d.\u0275\u0275directiveInject(d.ChangeDetectorRef),d.\u0275\u0275directiveInject(_r),d.\u0275\u0275directiveInject(ra),d.\u0275\u0275directiveInject(Ho.S,8),d.\u0275\u0275directiveInject(Pr.Gb,8),d.\u0275\u0275directiveInject(Vo,8),d.\u0275\u0275directiveInject(Bp.U,8))},t.\u0275cmp=d.\u0275\u0275defineComponent({type:t,selectors:[["manage-dataset"]],viewQuery:function(r,i){var s;(1&r&&d.\u0275\u0275viewQuery(sv,5),2&r)&&(d.\u0275\u0275queryRefresh(s=d.\u0275\u0275loadQuery())&&(i.datasetNameFieldRef=s.first))},features:[d.\u0275\u0275ProvidersFeature([_r,Zn.XI]),d.\u0275\u0275InheritDefinitionFeature],decls:7,vars:4,consts:[["class","loading",4,"ngIf","ngIfElse"],["formComponent",""],["workspaceInfo",""],[1,"loading"],["size","extra-large","labelPosition","below"],["localize","Loading_Schema"],["class","manage-dataset-form",3,"formGroup","ngStyle",4,"ngIf"],[1,"manage-dataset-form",3,"formGroup","ngStyle"],["class","message-banner",3,"viewModel","hideBanner","buttonClicked",4,"ngIf"],["class","creation-details",4,"ngIf"],[1,"manage-dataset-message"],["target","_blank",3,"href","external"],[1,"search-box"],[1,"pbi-focus-outline",3,"placeholderText","isDisabled","currentInputValue","autocomplete","value"],["searchBox",""],[4,"ngIf","ngIfElse"],["schemaFilterMenu",""],["data-test-id","manage-dataset-refresh-button","tri-button","","appearance","subtle","class","icon-button",3,"disabled","triTooltipDisabled","triTooltip","click",4,"ngIf"],["schemaView",""],[1,"message-banner",3,"viewModel","hideBanner","buttonClicked"],[1,"creation-details"],["tri-textfield","","class","creation-input-container",4,"ngIf"],["class","creation-input-container",4,"ngIf"],["tri-textfield","",1,"creation-input-container"],["localize","DirectLake_SemanticModel_NameTitle",1,"title"],["required","","formControlName","datasetNameField",1,"name-input",3,"placeholder","maxlength"],["datasetNameField",""],[1,"creation-input-container"],[1,"workspace-picker-header"],["localize","Workspace",1,"title"],["name","info_20_regular",1,"info-icon",3,"triTooltip"],[3,"disabled","currentWorkspaceObjectId","forceDisableMyWorkspace","capacityFilter","infoIconData","workspaceSelected"],["workspacePicker",""],["tri-button","","appearance","subtle",1,"icon-button",3,"disabled","triTooltipDisabled","triTooltip","click"],["originElement",""],["name","SearchFilter_20",1,"filterIcon"],[1,"filter-menu",3,"click"],[3,"isDisabled","triTooltipDisabled","triTooltip","filters","useTridentUIStyle","includeIconOnly","ariaLabel","filterChange"],["data-test-id","manage-dataset-refresh-button","tri-button","","appearance","subtle",1,"icon-button",3,"disabled","triTooltipDisabled","triTooltip","click"],["name","arrow_sync_20_regular"],["formControlName","selectAll",1,"select-all",3,"label","disabled"],[1,"line-divider"],["formArrayName","checkboxes"],[1,"list"],["class","item",4,"ngFor","ngForOf"],[1,"item"],["class","checkbox","triTooltipPosition","after",3,"triTooltipDisabled","triTooltip",4,"ngIf"],["triTooltipPosition","after",1,"checkbox",3,"triTooltipDisabled","triTooltip"],[3,"formControlName","disabled","ariaLabel"],[1,"checkboxIcon",3,"name","sprite"],[1,"schema-view"],[1,"select-all",3,"label","checked","indeterminate","disabled","onChange"],[1,"schema-tree",3,"tree","search","checkMode","filter","options","onNodeCheck"],["target","_blank","href","https://go.microsoft.com/fwlink/?linkid=2159767",3,"external"]],template:function(r,i){if(1&r&&(d.\u0275\u0275elementStart(0,"template-dialog"),d.\u0275\u0275template(1,ov,3,0,"div",0),d.\u0275\u0275pipe(2,"async"),d.\u0275\u0275template(3,_v,1,1,"ng-template",null,1,d.\u0275\u0275templateRefExtractor),d.\u0275\u0275template(5,Sv,6,7,"ng-template",null,2,d.\u0275\u0275templateRefExtractor),d.\u0275\u0275elementEnd()),2&r){var s=d.\u0275\u0275reference(4);d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",d.\u0275\u0275pipeBind1(2,2,i.isDialogLevelSpinnerDisplayed$))("ngIfElse",s)}},dependencies:[h.NgForOf,h.NgIf,h.NgStyle,Qo.J,qp.X,Wo.A,Lp.v,Ko.m,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.nD,y.sg,y.u,y.CE,Fp.Z,Up.v,Hp.U,Vp.D,Qp.M,Wp.r,rv,nv.d,iv.u,h.AsyncPipe,Or.F],styles:['[_nghost-%COMP%]{--fieldHeight: 28px;--iconSize: 20px;--iconMargin: 8px}[_nghost-%COMP%]     .pbi-dialog-body{height:100%}[_nghost-%COMP%]     .glyph-mini{font-size:20px}[_nghost-%COMP%]   .schema-view[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   tri-filter-menu[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   tri-filter-menu[_ngcontent-%COMP%]     .tri-filter-menu-trigger-button{border:0;padding:0;margin:0;height:20px}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport{contain:content}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree{padding:0 0 68px;height:100%;overflow:auto}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree cdk-tree-node{height:40px;max-width:400px}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree cdk-tree-node pbi-tree-node{--colorForegroundDisabled: var(--colorNeutralForegroundDisabled);line-height:40px;height:40px}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree cdk-tree-node pbi-tree-node pbi-checkbox{padding:0 4px;margin-right:8px}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree cdk-tree-node pbi-tree-node pbi-checkbox .pbi-checkbox label .pbi-checkbox-checkbox{height:16px;width:16px}[_nghost-%COMP%]   .schema-tree[_ngcontent-%COMP%]     cdk-tree cdk-tree-node pbi-tree-node pbi-highlight{font-size:var(--md-font-size, 14px);overflow:inherit}[_nghost-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);color:var(--fluent-theme-neutral-primary-hover-color, #232322);margin-bottom:4px}[_nghost-%COMP%]   .manage-dataset-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:inherit;overflow-x:hidden}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]   .creation-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]   .creation-input-container[_ngcontent-%COMP%]   .name-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]   .workspace-picker-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;margin-top:14px}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]   .workspace-picker-header[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:5px;width:16px;height:16px}[_nghost-%COMP%]   .creation-details[_ngcontent-%COMP%]   pbi-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:var(--fieldHeight)}[_nghost-%COMP%]   .manage-dataset-message[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);display:inline;margin-right:4px;margin-bottom:13px;margin-top:0}[_nghost-%COMP%]   .search-box[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   tri-search-box[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   tri-search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:var(--fieldHeight)}[_nghost-%COMP%]   .action-button[_ngcontent-%COMP%]{padding:0;border:none;background-color:transparent}[_nghost-%COMP%]   .icon-button[_ngcontent-%COMP%]{padding:0 4px;margin-left:var(--iconMargin)}[_nghost-%COMP%]   .action-button[_ngcontent-%COMP%]:focus{padding:0;border:none}[_nghost-%COMP%]   .select-all[_ngcontent-%COMP%]{margin-top:17px;margin-left:1em}[_nghost-%COMP%]   .line-divider[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{overflow-y:scroll;margin-left:1em;margin-bottom:20px}[_nghost-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-bottom:16px}[_nghost-%COMP%]   .filterIcon[_ngcontent-%COMP%], [_nghost-%COMP%]   .checkboxIcon[_ngcontent-%COMP%]{height:var(--iconSize);width:var(--iconSize)}[_nghost-%COMP%]   .checkboxIcon[_ngcontent-%COMP%]{margin-left:var(--iconMargin);margin-right:var(--iconMargin)}[_nghost-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]{display:block;font-size:12px;margin-bottom:10px;overflow:visible}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .message-banner-text-container{width:100%}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .message-banner-text-container .message-banner-text{display:inline-block}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .message-banner-text-container button{background-color:var(--fluent-theme-white-color, #FFF);margin-top:8px;height:24px;float:right}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .pbi-glyph-exit{flex:0 0 auto;display:flex;background-color:transparent;border:none;outline:none;color:var(--gray-140, #484644);padding:0}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .pbi-glyph-exit:hover{background:none}[_nghost-%COMP%]   message-banner[_ngcontent-%COMP%]     .pbi-glyph-exit:focus{outline:none}'],changeDetection:0}),t}(Fo.w),Ye=function(e){return e[e.ShowOnlyTables=1]="ShowOnlyTables",e[e.ShowOnlyViews=2]="ShowOnlyViews",e}({}),Pv=function(){function e(t,a){this.templateDialogPayload=t,this.datamartManageDatasetService=a}return e.prototype.ngOnInit=function(){this.datamartManageDatasetService.initialize(this.templateDialogPayload.input)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275directiveInject(Qe.x),d.\u0275\u0275directiveInject(oa))},e.\u0275cmp=d.\u0275\u0275defineComponent({type:e,selectors:[["datamart-manage-dataset-host"]],features:[d.\u0275\u0275ProvidersFeature([Qe.x,{provide:oa,useClass:oa},{provide:ra,useExisting:oa}])],decls:1,vars:0,template:function(a,r){1&a&&d.\u0275\u0275element(0,"manage-dataset")},dependencies:[Tr],encapsulation:2}),e}(),Cv=g(68082),Ov=g(8898),Tv=g(79226),wv=function(){function e(t){this.httpService=t,this.baseUrl="powerbi/databases/v201606"}return e.prototype.createSeeThroughModel=function(t){var a="".concat(this.baseUrl,"/createSeeThroughModel");return this.httpService.post(a,t).pipe((0,X.U)(function(r){return r.data}))},e.prototype.deleteDataset=function(t,a){var r;return r=a?"v1.0/myorg/groups/".concat(a,"/datasets/").concat(t):"v1.0/myorg/datasets/".concat(t),this.httpService.delete(r)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(ko.O))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Rv=g(81213),dt=function(){function e(t,a,r,i,s,c,u,m,p,v,b){this.datamartHttpService=t,this.databaseHttpService=a,this.errorService=r,this.localizationService=i,this.telemetryService=s,this.store=c,this.actions$=u,this.dataModelService=m,this.eventAggregationService=p,this.userInfo=v,this.standardizedEventsService=b,this.featureName="SeeThroughModeling",this.select="views",this.didAutoRetryUpdateTables=!1}return e.prototype.initialize=function(t){this.datasetDetails=t},Object.defineProperty(e.prototype,"settings",{get:function(){return this.datasetDetails.settings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"datamartObjectId",{get:function(){return this.datasetDetails.datamartId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this.datasetDetails.settings.command},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){switch(this.datasetDetails.datamartType){case 2:return"Lakehouse";case 4:return"Warehouse";case 1:return"Datamart"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"datamartTypeName",{get:function(){switch(this.datasetDetails.datamartType){case 2:return this.localizationService.get("ArtifactKind_Lakehouse");case 4:return this.localizationService.get("ArtifactKind_Warehouse");case 1:return this.localizationService.get("ArtifactKind_Datamart")}},enumerable:!1,configurable:!0}),e.prototype.getDatamartUserPermissions=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var t,a,r;return(0,o.__generator)(this,function(s){switch(s.label){case 0:t=this.telemetryService.startEvent(fp,{source:this.source,command:this.command,workspaceObjectId:this.datasetDetails.groupId,datamartObjectId:this.datasetDetails.datamartId}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.datamartHttpService.getDatamartPermissions({userObjectId:this.userInfo.uoid},this.datasetDetails.datamartId,this.datasetDetails.datamartType).toPromise()];case 2:return a=s.sent(),this.resolveEvent(t),[2,a];case 3:return r=s.sent(),L.fF.assertValue(r,"error has to be defined"),this.rejectEvent(r,t),[3,4];case 4:return[2]}})})},e.prototype.updateTables=function(t,a){var r,i,s;return(0,o.__awaiter)(this,void 0,void 0,function(){var u,m,p,v,b,E,D;return(0,o.__generator)(this,function(O){switch(O.label){case 0:return[4,this.updateDatamartVersion()];case 1:return O.sent(),[4,this.lockDatamart()];case 2:O.sent(),u={datamartVersion:null!==(r=this.datamartVersion)&&void 0!==r?r:1,executionMode:"Full",commands:[{$type:"AddRemoveTablesToBiModelCommand",tableNamesToAdd:t,tableNamesToRemove:a,datasetId:this.datasetDetails.datasetId}]},m=this.telemetryService.startEvent(hp,{source:this.source,command:this.command,didAutoRetry:this.didAutoRetryUpdateTables,workspaceObjectId:this.datasetDetails.groupId,datasetObjectId:this.datasetDetails.datasetId,datamartObjectId:this.datasetDetails.datamartId}),O.label=3;case 3:return O.trys.push([3,6,,11]),[4,this.datamartHttpService.addRemoveTablesFromBI(u,this.datasetDetails.datamartId,this.datasetDetails.datamartType).toPromise()];case 4:return p=O.sent(),[4,this.datamartHttpService.waitForBatchProcessToComplete(this.datasetDetails.datamartId,p,this.datasetDetails.datamartType).toPromise()];case 5:return O.sent(),[3,11];case 6:return v=O.sent(),L.fF.assertValue(v,"error has to be defined"),b=v,"DatamartVersionMismatch"!==(null===(i=b?.error)||void 0===i?void 0:i.code)||this.didAutoRetryUpdateTables?[3,8]:(m.cancel(!0),this.didAutoRetryUpdateTables=!0,[4,this.updateTables(t,a)]);case 7:return O.sent(),this.didAutoRetryUpdateTables=!1,[2];case 8:return"OperationCanceled"!==(null===(s=b?.error)||void 0===s?void 0:s.code)?[3,10]:[4,this.getTables(!0,!1,!0)];case 9:if((E=O.sent())&&(!_.isEmpty(E.tables)||!_.isEmpty(E.views)))return m.cancel(!0),[2];O.label=10;case 10:throw this.rejectEvent(b,m),500===b?.status&&(D=this.localizationService.get("AddRemoveTables_Error"),this.showErrorDialog(b,"AddRemoveTablesFromBIError",D)),v;case 11:return this.resolveEvent(m),"Edit"===this.command&&this.eventAggregationService.publish("LoadClientDataModelEvent",{refreshModel:!0}),[2]}})})},e.prototype.getTables=function(t,a,r){var i,s,c,u,m,p,v,b,E,D,O,A,C;return(0,o.__awaiter)(this,void 0,void 0,function(){var I,P,M,F,Z,je,ut,Re,wt,Zo,wr,Xv=this;return(0,o.__generator)(this,function(Be){switch(Be.label){case 0:if(!t&&this.tablesAndViews)return a&&4===this.datasetDetails.datamartType&&(this.tablesAndViews.models?this.parseModels(this.tablesAndViews.models):!(null===(i=this.datasetDetails.warehouseSchemaDefinition)||void 0===i)&&i.skipStore&&(this.parseModels(null===(s=this.datasetDetails.warehouseSchemaDefinition)||void 0===s?void 0:s.models),this.tablesAndViews=(0,o.__assign)((0,o.__assign)({},this.tablesAndViews),{datamartType:this.datasetDetails.datamartType,isWarehousePrimary:null===(c=this.datasetDetails.warehouseSchemaDefinition)||void 0===c?void 0:c.isWarehousePrimary,skipStore:null===(u=this.datasetDetails.warehouseSchemaDefinition)||void 0===u?void 0:u.skipStore}))),[2,this.tablesAndViews];if(!(t&&null!==(m=this.datasetDetails.warehouseSchemaDefinition)&&void 0!==m&&m.skipStore||4!==this.datasetDetails.datamartType))return[3,9];I=this.telemetryService.startEvent(gp,{source:this.source,command:this.command,workspaceObjectId:this.datasetDetails.groupId,datasetObjectId:this.datasetDetails.datasetId,datamartObjectId:this.datasetDetails.datamartId}),P=void 0,Be.label=1;case 1:return Be.trys.push([1,7,,8]),"Edit"===this.command||r?[4,this.datamartHttpService.getDatamartSchema(this.datasetDetails.datamartId,this.datasetDetails.datamartType,void 0,this.select,this.datasetDetails.datasetId).toPromise()]:[3,3];case 2:return P=Be.sent(),[3,5];case 3:return[4,this.datamartHttpService.getDatamartSchema(this.datasetDetails.datamartId,this.datasetDetails.datamartType,void 0,this.select).toPromise()];case 4:P=Be.sent(),Be.label=5;case 5:return[4,this.datamartHttpService.waitForBatchProcessToComplete(this.datasetDetails.datamartId,P,this.datasetDetails.datamartType).toPromise()];case 6:return P=Be.sent(),[3,8];case 7:throw M=Be.sent(),L.fF.assertValue(M,"error has to be defined"),this.rejectEvent(F=M,I),Z=this.localizationService.format("DirectLake_GetSchema_Error",this.datamartTypeName),this.showErrorDialog(F,"GetTablesFromDatamartSchemaError",Z),M;case 8:return this.resolveEvent(I),this.datamartVersion=P.datamartVersion,je=_.first(P.operationInformation),L.fF.assertValue(je,"operationInfo has to be defined"),ut=je.progressDetail.databaseDefinition,Re=this.dataModelService.getDataModel(),this.tablesAndViews={tables:ct.parseDatabaseTables(ut,Re,this.command),views:ct.parseDatabaseViews(ut,Re,this.command),isWarehousePrimary:!0,skipStore:!0},a&&(wt={tablesTitle:this.localizationService.get("Tables"),viewsTitle:this.localizationService.get("Views_Title")},this.tablesAndViews.models=ct.convertTableViewsToFieldListModels(this.tablesAndViews,this.datasetDetails,this.datamartVersion,wt)),[2,this.tablesAndViews];case 9:return a&&4===this.datasetDetails.datamartType?!t&&null!==(p=this.tablesAndViews)&&void 0!==p&&p.models?(this.parseModels(this.tablesAndViews.models),[3,13]):[3,10]:[3,17];case 10:return null!==(v=this.datasetDetails.warehouseSchemaDefinition)&&void 0!==v&&v.skipStore?[3,12]:[4,this.store.select(Gn).pipe((0,B.q)(1),(0,X.U)(function(Rr){return Xv.parseModels(Rr)})).toPromise()];case 11:return Be.sent(),[3,13];case 12:!t&&!(null===(b=this.datasetDetails.warehouseSchemaDefinition)||void 0===b)&&b.skipStore&&(this.parseModels(null===(E=this.datasetDetails.warehouseSchemaDefinition)||void 0===E?void 0:E.models),this.tablesAndViews=(0,o.__assign)((0,o.__assign)({},this.tablesAndViews),{datamartType:this.datasetDetails.datamartType,isWarehousePrimary:null===(D=this.datasetDetails.warehouseSchemaDefinition)||void 0===D?void 0:D.isWarehousePrimary,skipStore:null===(O=this.datasetDetails.warehouseSchemaDefinition)||void 0===O?void 0:O.skipStore})),Be.label=13;case 13:return Zo=this,null!==(A=this.datasetDetails.warehouseSchemaDefinition)&&void 0!==A&&A.skipStore?(wr=null===(C=this.datasetDetails.warehouseSchemaDefinition)||void 0===C?void 0:C.datamartVersion,[3,16]):[3,14];case 14:return[4,this.store.select(sm).pipe((0,B.q)(1),(0,X.U)(function(Rr){return Rr})).toPromise()];case 15:wr=Be.sent(),Be.label=16;case 16:return Zo.datamartVersion=wr,[2,this.tablesAndViews];case 17:return[2]}})})},e.prototype.createReportIfNeeded=function(){},e.prototype.createDataset=function(t,a,r,i){return(0,o.__awaiter)(this,void 0,void 0,function(){var s,c,u,m,p,v,b,E;return(0,o.__generator)(this,function(D){switch(D.label){case 0:s={datamartId:this.datasetDetails.datamartId,datasetName:t,folderObjectId:a,sensitivityLabelId:i},c=this.telemetryService.startEvent(bp,{source:this.source,command:this.command,workspaceObjectId:a,datamartObjectId:this.datasetDetails.datamartId,datasetName:t}),D.label=1;case 1:return D.trys.push([1,3,,4]),[4,this.databaseHttpService.createSeeThroughModel(s).toPromise()];case 2:return u=D.sent(),[3,4];case 3:throw m=D.sent(),L.fF.assertValue(m,"error has to be defined"),p=m,v=this.localizationService.get("Create_DirectLakeModel_Failed"),this.showErrorDialog(p,"CreateSeeThroughModelError",v),m;case 4:this.resolveEvent(c),b=u.datasetUrl.split("/"),this.datasetDetails.datasetId=b[b.length-2],D.label=5;case 5:return D.trys.push([5,7,,9]),[4,this.updateTables(r,[])];case 6:return D.sent(),[3,9];case 7:return E=D.sent(),[4,this.databaseHttpService.deleteDataset(this.datasetDetails.datasetId,a).toPromise()];case 8:throw D.sent(),E;case 9:return[2,u.datasetUrl]}})})},e.prototype.refreshSchema=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var t,a,r,i,s,c;return(0,o.__generator)(this,function(u){switch(u.label){case 0:t=this.telemetryService.startEvent(mp,{source:this.source,command:this.command,workspaceObjectId:this.datasetDetails.groupId,datamartObjectId:this.datasetDetails.datamartId}),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.datamartHttpService.refreshMetadata(this.datasetDetails.datamartId,this.datamartVersion,this.datasetDetails.datamartType,!0).toPromise()];case 2:return a=u.sent(),[4,this.datamartHttpService.waitForBatchProcessToComplete(this.datasetDetails.datamartId,a,this.datasetDetails.datamartType).toPromise()];case 3:return a=u.sent(),[3,5];case 4:throw r=u.sent(),L.fF.assertValue(r,"error has to be defined"),this.rejectEvent(i=r,t),s=this.localizationService.format("DirectLake_RefreshSchema_Error",this.datamartTypeName),this.showErrorDialog(i,"RefreshSchemaError",s),r;case 5:return this.resolveEvent(t),this.datamartVersion=a.datamartVersion,this.actions$&&4===this.datasetDetails.datamartType&&!this.datasetDetails.warehouseSchemaDefinition.skipStore?[4,this.actions$.pipe((0,Tt.l4)(Xr),(0,B.q)(1),(0,X.U)(function(m){return m})).toPromise()]:[3,7];case 6:c=u.sent(),this.datamartVersion=c.schema.datamartVersion,u.label=7;case 7:return[2]}})})},e.prototype.updateDatamartVersion=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var t,a,r;return(0,o.__generator)(this,function(s){switch(s.label){case 0:t=this.telemetryService.startEvent(pp,{source:this.source,command:this.command,workspaceObjectId:this.datasetDetails.groupId,datamartObjectId:this.datasetDetails.datamartId}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.datamartHttpService.getDatamartVersion(this.datasetDetails.datamartId,this.datasetDetails.datamartType).toPromise()];case 2:return a=s.sent(),[3,4];case 3:return r=s.sent(),L.fF.assertValue(r,"error has to be defined"),this.rejectEvent(r,t),[2];case 4:return this.resolveEvent(t),this.datamartVersion=Number(a.value),[2]}})})},e.prototype.lockDatamart=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var t,a,r;return(0,o.__generator)(this,function(s){switch(s.label){case 0:t=this.telemetryService.startEvent(vp,{source:this.source,command:this.command,workspaceObjectId:this.datasetDetails.groupId,datamartObjectId:this.datasetDetails.datamartId}),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this.datamartHttpService.acquireDatamartLease(this.datasetDetails.datamartId,this.datasetDetails.datamartType,this.datamartVersion).toPromise()];case 2:return a=s.sent(),[4,this.datamartHttpService.waitForBatchProcessToComplete(this.datasetDetails.datamartId,a,this.datasetDetails.datamartType).toPromise()];case 3:return s.sent(),[3,5];case 4:return r=s.sent(),L.fF.assertValue(r,"error has to be defined"),this.rejectEvent(r,t),[2];case 5:return this.resolveEvent(t),[2]}})})},e.prototype.overrideMissingTablesErrorMessage=function(t){var a,r,i,s,c=null===(a=t.error)||void 0===a?void 0:a.code;L.fF.assert(function(){return"TablesMissingInDatamartDatasetException"===c},"error code has to be TablesMissingInDatamartDatasetException");var u=null===(s=null===(i=null===(r=t.error)||void 0===r?void 0:r["pbi.error"])||void 0===i?void 0:i.parameters)||void 0===s?void 0:s.ErrorMessage;if(!u)return"";var p=u.matchAll(/<ccon>(\w[\w\s]*)<\/ccon>/g),v=Array.from(p,function(b){return b[1]}).join(", ");return v?this.localizationService.format("MissingSpecificTables_ErrorMessage",v):this.localizationService.get("SemanticModel_TablePathNotFound_Error")},e.prototype.showErrorDialog=function(t,a,r){var i,s,c,u,m,p,v,b,E,D,O;switch(null===(i=t.error)||void 0===i?void 0:i.code){case"PathNotFound":O=this.localizationService.get("SemanticModel_TablePathNotFound_Error");break;case"TablesMissingInDatamartDatasetException":O=this.overrideMissingTablesErrorMessage(t);break;default:var A=this.localizationService.get("DirectLake_Invalid_DataSource_Reference");(O=null===(u=null===(c=null===(s=t.error)||void 0===s?void 0:s["pbi.error"])||void 0===c?void 0:c.parameters)||void 0===u?void 0:u.ErrorMessage)?O.includes(A)&&(O=this.localizationService.get("DirectLake_MultipleDataSource_Error")):O=null===(E=null===(b=null===(v=null===(p=null===(m=t.error)||void 0===m?void 0:m["pbi.error"])||void 0===p?void 0:p.details)||void 0===v?void 0:v[0])||void 0===b?void 0:b.detail)||void 0===E?void 0:E.value}this.errorService.error(O,a,{title:r,requestId:t.responseRequestId,statusCode:t.status.toString(),errorDetails:null===(D=t.error)||void 0===D?void 0:D.message})},e.prototype.parseModels=function(t){var a=this,r=_.cloneDeep(t);Object.entries(r.tables).forEach(function(i){r.tables[i[0]]=(0,o.__assign)((0,o.__assign)({},i[1]),{isBiObject:"Create"!==a.command&&i[1].isBiObject})}),Object.entries(r.views).forEach(function(i){r.views[i[0]]=(0,o.__assign)((0,o.__assign)({},i[1]),{isBiObject:"Create"!==a.command&&i[1].isBiObject})}),this.tablesAndViews=(0,o.__assign)((0,o.__assign)({},this.tablesAndViews),{models:r})},e.prototype.resolveEvent=function(t){t.resolve(),this.logStandardizedEvent(t.event)},e.prototype.rejectEvent=function(t,a){var r;"DatamartVersionMismatch"===(null===(r=t.error)||void 0===r?void 0:r.code)&&t.error["pbi.error"]&&(t.error["pbi.error"].exceptionCulprit=1);var i=(0,Sr.GB)(t.error,t.status);a.reject(i),this.logStandardizedEvent(a.event)},e.prototype.logStandardizedEvent=function(t){this.standardizedEventsService&&this.standardizedEventsService.logEvent(t,[this.featureName],!0,t.info)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Ir),d.\u0275\u0275inject(wv),d.\u0275\u0275inject(Rv.T),d.\u0275\u0275inject(Ot.o),d.\u0275\u0275inject(Lt.y0),d.\u0275\u0275inject(n.yh),d.\u0275\u0275inject(Tt.eX),d.\u0275\u0275inject(Cv.n),d.\u0275\u0275inject(Ov.x),d.\u0275\u0275inject(Tv.M),d.\u0275\u0275inject(Ho.S,8))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),Mv=function(){function e(t,a){this.templateDialogPayload=t,this.manageDatasetService=a}return e.prototype.ngOnInit=function(){this.manageDatasetService.initialize(this.templateDialogPayload.input)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275directiveInject(Qe.x),d.\u0275\u0275directiveInject(dt))},e.\u0275cmp=d.\u0275\u0275defineComponent({type:e,selectors:[["manage-dataset-host"]],features:[d.\u0275\u0275ProvidersFeature([Qe.x,{provide:dt,useClass:dt},{provide:ra,useExisting:dt}])],decls:1,vars:0,template:function(a,r){1&a&&d.\u0275\u0275element(0,"manage-dataset")},dependencies:[Tr],encapsulation:2}),e}(),Av=g(58938),Nv=function(){function e(t,a,r){this.dialogService=t,this.featureSwitchService=a,this.localizationService=r,document.manageDatasetDialogService=this}return e.prototype.showManageDatasetDialog=function(t){var a="DatamartManageDatasetComponentId",r="60vh",i=(0,o.__assign)((0,o.__assign)({},t),{settings:{command:"Edit",allowRemovalOfAllTables:!0,isFromManageDefaultDataset:!0}});this.featureSwitchService.featureSwitches.newManageDatasetForDatamartUI&&(a="DatamartManageDatasetHostComponentId",r="60vh");var c={title:this.localizationService.get("Datamart_Manage_Default_Semantic_Model_Title"),okButtonText:this.localizationService.get("Confirm"),dontCloseOnDefaultActions:!0,cancelButtonText:this.localizationService.get("Cancel_ButtonText"),spinnerText:"DialogFooter_OKActionWorkingOnIt",input:i,hideClose:!0};this.dialogService.showTemplateDialog(a,c,{width:"60vh",maxWidth:"60vh",maxHeight:"60vh",height:r})},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Av.x),d.\u0275\u0275inject(qt.vZ),d.\u0275\u0275inject(Ot.o))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),Xo=function(){function e(t,a){this.telemetryService=t,this.datamartHttpService=a}return e.prototype.initialize=function(t){this.tablesAndViews=t},e.prototype.updateTables=function(t,a){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(s){switch(s.label){case 0:return[4,this.addOrRemoveTablesFromBI(t,a,this.tablesAndViews.datamartVersion,this.tablesAndViews.datamartObjectId,this.tablesAndViews.datamartType)];case 1:return s.sent(),[2]}})})},e.prototype.cancelDatamartBatch=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(t){return[2,this.datamartHttpService.cancelDatamartBatch(this.tablesAndViews.datamartObjectId,this.batchId,this.tablesAndViews.datamartType).pipe((0,X.U)(function(a){return a.state})).toPromise()]})})},e.prototype.addOrRemoveTablesFromBI=function(t,a,r,i,s){return(0,o.__awaiter)(this,void 0,void 0,function(){var c,p=this;return(0,o.__generator)(this,function(v){switch(v.label){case 0:return c=this.telemetryService.startActivity(null,ci),[4,this.datamartHttpService.addRemoveTablesFromBI({datamartVersion:r??1,executionMode:"Full",commands:[{$type:"AddRemoveTablesToBiModelCommand",tableNamesToAdd:t,tableNamesToRemove:a??[]}]},i,s).pipe((0,xe.zg)(function(b){return p.batchId=b.batchId,p.datamartHttpService.waitForBatchProcessToComplete(i,b,s).pipe((0,X.U)(function(){c.resolve()}))}),(0,na.K)(function(b){throw c.reject((0,Sr.GB)(b.error,b.status)),L.fF.assertValue(b.error,"error.error has to be defined"),b})).toPromise()];case 1:return v.sent(),[2]}})})},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Lt.y0),d.\u0275\u0275inject(Ir))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),xv=g(24326);function jv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"message-banner",9),d.\u0275\u0275listener("hideBanner",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext();return d.\u0275\u0275resetView(s.closeBanner())}),d.\u0275\u0275elementEnd()}if(2&e){var r=d.\u0275\u0275nextContext();d.\u0275\u0275property("viewModel",r.errorMessageBannerModel)}}function Bv(e,t){1&e&&d.\u0275\u0275element(0,"pbi-spinner",10)}function kv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"span",11),d.\u0275\u0275element(1,"pbi-office-icon",12),d.\u0275\u0275text(2),d.\u0275\u0275elementEnd()),2&e){var a=t.$implicit;d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(a.name)}}function qv(e,t){if(1&e&&(d.\u0275\u0275elementStart(0,"span",11),d.\u0275\u0275element(1,"pbi-office-icon",13),d.\u0275\u0275text(2),d.\u0275\u0275elementEnd()),2&e){var a=t.$implicit;d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate(a.name)}}function Lv(e,t){if(1&e){var a=d.\u0275\u0275getCurrentView();d.\u0275\u0275elementStart(0,"div",14)(1,"button",15),d.\u0275\u0275listener("click",function(){d.\u0275\u0275restoreView(a);var s=d.\u0275\u0275nextContext();return d.\u0275\u0275resetView(s.onManageDefaultDataset())}),d.\u0275\u0275text(2),d.\u0275\u0275pipe(3,"localize"),d.\u0275\u0275elementEnd()()}if(2&e){var r=d.\u0275\u0275nextContext();d.\u0275\u0275advance(1),d.\u0275\u0275property("disabled",r.isManageDatasetButtonDisabled),d.\u0275\u0275advance(1),d.\u0275\u0275textInterpolate(d.\u0275\u0275pipeBind1(3,2,"Datamart_Manage_Default_Power_BI_Semantic_Model_Title"))}}var Fv=function(e){function t(a,r,i,s){var c=e.call(this)||this;return c.templateDialogPayload=a,c.localizationService=r,c.telemetryService=i,c.autoUpdateDatasetService=s,c.tables=[],c.views=[],c.isCloseActive=!1,c.isFromNewReport=!1,c.isManageDatasetButtonDisabled=!1,c.objectsToAdd=[],c}return(0,o.__extends)(t,e),t.prototype.ngOnInit=function(){var a=this;this.templateDialogPayload.onOkButtonClick=function(){return a.onOk()},this.templateDialogPayload.onCancelButtonClick=function(){return(0,o.__awaiter)(a,void 0,void 0,function(){return(0,o.__generator)(this,function(r){return[2,this.onCancel()]})})},this.autoUpdateDatasetService.initialize(this.templateDialogPayload.input),this.tables=this.templateDialogPayload.input.tables,this.views=this.templateDialogPayload.input.views,this.isFromNewReport=this.templateDialogPayload.input.isFromNewReport,this.templateDialogPayload.input.tables.concat(this.templateDialogPayload.input.views).forEach(function(r){r.isBiObject||a.objectsToAdd.push(r.uniqueName)}),this.isFromNewReport||this.autoAddTables(),this.dialogContextText=this.getDialogContentText(),this.templateDialogPayload.spinnerDisplay$.pipe((0,Je.R)(this.onDestroy$)).subscribe(function(r){r&&(a.errorMessageBannerModel=void 0),a.templateDialogPayload.setOkButtonState(r)})},t.prototype.getDialogContentText=function(){var a=[];return 0===this.tables.length+this.views.length?(a.push(this.localizationService.get("Tables")),a.push(this.localizationService.get("Views"))):(this.tables.length&&a.push(this.localizationService.get("Tables")),this.views.length&&a.push(this.localizationService.get("Views"))),this.localizationService.format(this.isFromNewReport?"Datamart_New_Report_Use_All_Data_Semantic_Model":"Datamart_Auto_Update_Dataset_Info",[this.tables.length+this.views.length,a.join(a.length>1?" "+this.localizationService.get("ConditionalFormattingDialog_RuleBased_ConditionSeparator")+" ":"")])},t.prototype.onOk=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a;return(0,o.__generator)(this,function(r){switch(r.label){case 0:return this.isCloseActive?(this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled"}),[2]):this.isFromNewReport?(this.templateDialogPayload.setSpinnerDisplay(!0),this.autoAddTables(),this.isManageDatasetButtonDisabled=!0,this.templateDialogPayload.toggleCancelButton(!0),[3,3]):[3,1];case 1:return this.templateDialogPayload.setSpinnerDisplay(!0),this.telemetryService.logEvent(Sp),a=this,[4,this.autoUpdateDatasetService.cancelDatamartBatch()];case 2:a.batchCancellationState=r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onCancel=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,this.templateDialogPayload.hideCancelButton$.pipe((0,B.q)(1)).toPromise()];case 1:return r.sent()||this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled"}),[2]}})})},t.prototype.closeBanner=function(){this.errorMessageBannerModel=void 0},t.prototype.onManageDefaultDataset=function(){this.telemetryService.logEvent(yp),this.templateDialogPayload.closeDialogFromConsumer({status:"Cancelled",openManageDataset:!0})},t.prototype.autoAddTables=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){var a,r;return(0,o.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.autoUpdateDatasetService.updateTables(this.objectsToAdd,[])];case 1:return i.sent(),a=(0,o.__assign)((0,o.__assign)({},a={status:"Succeeded"}),{diagramLayoutChange:{initialTablesState:[],modelObjectsToAdd:this.objectsToAdd,modelObjectsToRemove:[]},toastNotification:"AlreadyConcluded"===this.batchCancellationState||"NotFound"===this.batchCancellationState||"NotCancellable"===this.batchCancellationState?"AutoUpdateCancelErrorToast":"AutoUpdateSuccessToast"}),this.templateDialogPayload.closeDialogFromConsumer(a),[3,3];case 2:return r=i.sent(),"SuccessfullyMarked"===this.batchCancellationState&&"OperationCanceled"===r.error.code?(this.templateDialogPayload.setSpinnerDisplay(!1),this.templateDialogPayload.closeDialogFromConsumer({status:"Failed",error:r,toastNotification:"AutoUpdateCancelSuccessToast"})):(this.isCloseActive=!0,this.isManageDatasetButtonDisabled=!1,this.showErrorMessageBanner(r)),[3,3];case 3:return this.telemetryService.logEvent(this.isFromNewReport?_p:Dp,{objectsToAdd:this.objectsToAdd}),[2]}})})},t.prototype.showErrorMessageBanner=function(a){var r,i,s,c,u,m,p;this.templateDialogPayload.setSpinnerDisplay(!1),this.templateDialogPayload.setOkButtonText(this.localizationService.get("Close")),L.fF.assertValue(a.error,"error.error has to be defined");var v="";switch(null===(r=a.error)||void 0===r?void 0:r.code){case"DatamartVersionMismatch":v=this.localizationService.get("Datamart_Manage_Default_Dataset_TablesMissingInDatamartDatasetException");break;case"ColumnCountExceedsMaxLimitException":v=this.localizationService.format("Datamart_Auto_Update_Dataset_ColumnCountExceedsMaxLimitException","<Customer><Stores><Inventory>");break;case"OverallColumnCountExceedsMaxLimitException":v=this.localizationService.get("Datamart_Auto_Update_Dataset_OverallColumnCountExceedsMaxLimitException");break;default:(null===(c=null===(s=null===(i=a.error)||void 0===i?void 0:i["pbi.error"])||void 0===s?void 0:s.parameters)||void 0===c?void 0:c.HttpStatusCode)===500..toString()?this.templateDialogPayload.closeDialogFromConsumer({status:"Failed",error:a}):v=null===(p=null===(m=null===(u=a.error)||void 0===u?void 0:u["pbi.error"])||void 0===m?void 0:m.parameters)||void 0===p?void 0:p.ErrorMessage}this.errorMessageBannerModel={bannerType:1,iconName:"pbi-glyph-error",message:v,allowDismiss:!0}},t.\u0275fac=function(r){return new(r||t)(d.\u0275\u0275directiveInject(Qe.x),d.\u0275\u0275directiveInject(Ot.o),d.\u0275\u0275directiveInject(Lt.y0),d.\u0275\u0275directiveInject(Xo))},t.\u0275cmp=d.\u0275\u0275defineComponent({type:t,selectors:[["auto-update-dataset"]],features:[d.\u0275\u0275ProvidersFeature([Qe.x]),d.\u0275\u0275InheritDefinitionFeature],decls:13,vars:6,consts:[[1,"container"],["class","message-banner",3,"viewModel","hideBanner",4,"ngIf"],[1,"sub-header"],["class","pbi-spinner-small",4,"ngIf"],["tabindex","0",1,"tableViews"],[1,"tables"],["class","item",4,"ngFor","ngForOf"],[1,"views"],["footer-left-content","",4,"ngIf"],[1,"message-banner",3,"viewModel","hideBanner"],[1,"pbi-spinner-small"],[1,"item"],["name","DatamartTable_16"],["name","DatamartView_16"],["footer-left-content",""],[1,"pbi-link-button",3,"disabled","click"]],template:function(r,i){1&r&&(d.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0),d.\u0275\u0275template(2,jv,1,1,"message-banner",1),d.\u0275\u0275elementStart(3,"span",2),d.\u0275\u0275template(4,Bv,1,0,"pbi-spinner",3),d.\u0275\u0275elementStart(5,"span"),d.\u0275\u0275text(6),d.\u0275\u0275elementEnd()(),d.\u0275\u0275elementStart(7,"div",4)(8,"div",5),d.\u0275\u0275template(9,kv,3,1,"span",6),d.\u0275\u0275elementEnd(),d.\u0275\u0275elementStart(10,"div",7),d.\u0275\u0275template(11,qv,3,1,"span",6),d.\u0275\u0275elementEnd()()(),d.\u0275\u0275template(12,Lv,4,4,"div",8),d.\u0275\u0275elementEnd()),2&r&&(d.\u0275\u0275advance(2),d.\u0275\u0275property("ngIf",i.errorMessageBannerModel),d.\u0275\u0275advance(2),d.\u0275\u0275property("ngIf",!i.isCloseActive&&!i.isFromNewReport),d.\u0275\u0275advance(2),d.\u0275\u0275textInterpolate1(" ",i.dialogContextText," "),d.\u0275\u0275advance(3),d.\u0275\u0275property("ngForOf",i.tables),d.\u0275\u0275advance(2),d.\u0275\u0275property("ngForOf",i.views),d.\u0275\u0275advance(1),d.\u0275\u0275property("ngIf",i.isFromNewReport))},dependencies:[h.NgForOf,h.NgIf,Qo.J,Wo.A,Ko.m,xv.k,Or.F],styles:["dialog-body[_ngcontent-%COMP%]{display:flex}.item[_ngcontent-%COMP%]{margin-bottom:8px}pbi-office-icon[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;margin-right:8px;margin-left:8px}pbi-spinner[_ngcontent-%COMP%]{padding-right:10px;padding-top:5px}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:36vh;overflow:hidden}.tableViews[_ngcontent-%COMP%]{overflow:auto}.tables[_ngcontent-%COMP%], .views[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:1em;margin-right:1em}.sub-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1em}"],changeDetection:0}),t}(Fo.w),Uv=g(54485),Hv=[{componentIdentifier:"ManageDatasetHostComponentId",componentType:Mv},{componentIdentifier:"DatamartManageDatasetHostComponentId",componentType:Pv},{componentIdentifier:"AutoUpdateDatasetComponentId",componentType:Fv}],Vv=function(){function e(t){g.e("datamart").then(g.bind(g,76291)).then(function(a){t.registerIcons(a.iconSpriteSheet.sprite)})}return e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Uv.u))},e.\u0275mod=d.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=d.\u0275\u0275defineInjector({providers:[dt,Nv,Xo],imports:[h.CommonModule,j.c.withManifest(Hv),V.v,ae.x,ue.V,w.m,Y.b,y.UX,se.e,fe.g,re.w,ip.m,op.b,cp.d,dp.T6,np.B,rp,sp.nU,z.J,ep]}),e}(),Qv=g(40228),Wv=g(39119),Kv=function(){function e(t){this.hostService=t.getHostService("tablePickerDesktopHostService")}return e.prototype.getDirectLakeTablesAsync=function(t){return this.hostService.getDirectLakeTables(t)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Wv.j))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),zv=function(){function e(t,a){this.localizationService=t,this.tablePickerService=a}return Object.defineProperty(e.prototype,"datamartObjectId",{get:function(){return this.datasetDetails.datamartId},enumerable:!1,configurable:!0}),e.prototype.initialize=function(t){this.datasetDetails=t},Object.defineProperty(e.prototype,"settings",{get:function(){return this.datasetDetails.settings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){switch(this.datasetDetails.datamartType){case 2:return"Lakehouse";case 4:return"Warehouse";case 1:return"Datamart"}},enumerable:!1,configurable:!0}),e.prototype.getTables=function(t,a){return(0,o.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,o.__generator)(this,function(s){switch(s.label){case 0:return[4,this.tablePickerService.getDirectLakeTablesAsync(this.datasetDetails.datamartId)];case 1:return(r=s.sent()).tables=ct.filterTables(r.tables),r.views=ct.filterViews(r.views),a&&(i={tablesTitle:this.localizationService.get("Tables"),viewsTitle:this.localizationService.get("Views_Title")},r=(0,o.__assign)((0,o.__assign)({},r),{isWarehousePrimary:!0,skipStore:!0,models:ct.convertTableViewsToFieldListModels(r,this.datasetDetails,r.datamartVersion,i)})),[2,r]}})})},e.prototype.updateTables=function(t,a){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(r){return[2]})})},e.prototype.createReportIfNeeded=function(){},e.prototype.createDataset=function(t,a,r){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(i){return[2,""]})})},e.prototype.refreshSchema=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(t){return[2]})})},e.prototype.getDatamartUserPermissions=function(){return(0,o.__awaiter)(this,void 0,void 0,function(){return(0,o.__generator)(this,function(t){return[2]})})},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275inject(Ot.o),d.\u0275\u0275inject(Kv))},e.\u0275prov=d.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),Gv=function(){function e(t,a){this.templateDialogPayload=t,this.manageDatasetService=a}return e.prototype.ngOnInit=function(){this.manageDatasetService.initialize(this.templateDialogPayload.input)},e.\u0275fac=function(a){return new(a||e)(d.\u0275\u0275directiveInject(Qe.x),d.\u0275\u0275directiveInject(dt))},e.\u0275cmp=d.\u0275\u0275defineComponent({type:e,selectors:[["desktop-manage-dataset-dialog"]],features:[d.\u0275\u0275ProvidersFeature([Qe.x,{provide:dt,useClass:zv},{provide:ra,useExisting:dt}])],decls:1,vars:0,template:function(a,r){1&a&&d.\u0275\u0275element(0,"manage-dataset")},dependencies:[Tr],encapsulation:2}),e}(),$v=function(){function e(){}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=d.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=d.\u0275\u0275defineInjector({providers:[Qe.x],imports:[h.CommonModule,y.u5,y.UX,Vv,j.c.withManifest([{componentIdentifier:Qv.V,componentType:Gv}]),V.v]}),e}()},19533:function(We,be,g){g.d(be,{C:function(){return V}});var V=(0,g(85732).P1)(function(fe){return fe.router},function(j){return j&&j.state})},22743:function(We,be,g){g.d(be,{y:function(){return re}});var h=g(63271),V=function(B,o){return void 0===o&&(o=24),B?.isMyWorkspace?"c_my_workspace_".concat(o):"c_group_workspace_".concat(o)},j=g(50423),fe=g(77476),se=g(74913);function ae(z,B){if(1&z&&j.\u0275\u0275element(0,"img",3),2&z){var o=j.\u0275\u0275nextContext();j.\u0275\u0275property("src",null==o.workspace?null:o.workspace.icon,j.\u0275\u0275sanitizeUrl),j.\u0275\u0275attribute("data-testid","workspace-header-logo-img")}}function ue(z,B){if(1&z&&j.\u0275\u0275element(0,"tri-svg-icon",5),2&z){var o=j.\u0275\u0275nextContext(2);j.\u0275\u0275styleProp("height",o.actualIconSizePx,"px")("width",o.actualIconSizePx,"px"),j.\u0275\u0275property("sprite",o.icon.sprite)("name",o.icon.name),j.\u0275\u0275attribute("data-testid","workspace-header-logo-default")}}function Y(z,B){1&z&&(j.\u0275\u0275elementContainerStart(0),j.\u0275\u0275template(1,ue,1,7,"tri-svg-icon",4),j.\u0275\u0275elementContainerEnd()),2&z&&(j.\u0275\u0275advance(1),j.\u0275\u0275property("ngSwitchCase",!1))}var w={20:16,24:20,32:28,64:48},re=function(){function z(B){this.isTrident=B,this.iconSizePx=20,this.hasBackground=!1,this.actualIconSizePx=null,this.icon=null}return z.prototype.ngOnChanges=function(){var B;this.isTrident?(this.hasBackground=!1,this.actualIconSizePx=this.iconSizePx,this.icon={sprite:"artifact-colored-icons",name:V(this.workspace,this.actualIconSizePx)}):(this.hasBackground=!0,this.actualIconSizePx=w[this.iconSizePx],this.icon=null!==(B=this.workspace)&&void 0!==B&&B.isMyWorkspace?{name:"person_".concat(this.actualIconSizePx,"_regular")}:{name:"people_community_".concat(this.actualIconSizePx,"_regular")})},z.\u0275fac=function(o){return new(o||z)(j.\u0275\u0275directiveInject(h.Y,8))},z.\u0275cmp=j.\u0275\u0275defineComponent({type:z,selectors:[["tri-workspace-icon"]],hostVars:2,hostBindings:function(o,n){2&o&&j.\u0275\u0275classProp("icon-background",n.hasBackground)},inputs:{workspace:"workspace",iconSizePx:"iconSizePx"},features:[j.\u0275\u0275NgOnChangesFeature],decls:3,vars:3,consts:[[3,"ngSwitch"],["class","tri-h-full tri-w-full","alt","",3,"src",4,"ngSwitchCase"],[4,"ngIf"],["alt","",1,"tri-h-full","tri-w-full",3,"src"],[3,"height","width","sprite","name",4,"ngSwitchCase"],[3,"sprite","name"]],template:function(o,n){1&o&&(j.\u0275\u0275elementContainerStart(0,0),j.\u0275\u0275template(1,ae,1,2,"img",1),j.\u0275\u0275template(2,Y,2,1,"ng-container",2),j.\u0275\u0275elementContainerEnd()),2&o&&(j.\u0275\u0275property("ngSwitch",!(null==n.workspace||!n.workspace.icon)),j.\u0275\u0275advance(1),j.\u0275\u0275property("ngSwitchCase",!0),j.\u0275\u0275advance(1),j.\u0275\u0275property("ngIf",n.icon&&n.actualIconSizePx))},dependencies:[fe.NgIf,fe.NgSwitch,fe.NgSwitchCase,se.M],styles:["[_nghost-%COMP%]{border-radius:var(--borderRadiusCircular);color:var(--colorNeutralForeground3);fill:var(--colorNeutralForeground3);align-items:center;display:flex;justify-content:center;flex:0 0 auto}.icon-background[_nghost-%COMP%]{background-color:var(--colorNeutralBackground6)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--borderRadiusCircular);object-fit:cover}"],changeDetection:0}),z}()}}]);